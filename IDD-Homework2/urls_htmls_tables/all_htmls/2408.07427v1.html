<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation</title>
<!--Generated on Wed Aug 14 09:59:31 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="sequential recommendation,  large language model" lang="en" name="keywords"/>
<base href="/html/2408.07427v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S1" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Our Method <span class="ltx_text ltx_font_smallcaps">MixRec</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS1" title="In 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2" title="In 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Adapt LLM for Sequential Recommendation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS1" title="In 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Item Representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS2" title="In 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>Semantic Alignment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS3" title="In 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.3 </span>Link Next Item</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS4" title="In 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.4 </span>Distinguish Hard Samples</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS5" title="In 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.5 </span>Recommendation Adapters</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3" title="In 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3.SSS1" title="In 2.3. Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Context Masking</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3.SSS2" title="In 2.3. Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>Collaborative Knowledge Injection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3.SSS3" title="In 2.3. Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.3 </span>Dynamic Adaptive Mixture-of-Experts</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS4" title="In 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Putting All Together</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS1" title="In 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS1.SSS1" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS1.SSS2" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS1.SSS3" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS1.SSS4" title="In 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.4 </span>Implementation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS2" title="In 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS3" title="In 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS4" title="In 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Effects of Using Different CF Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS5" title="In 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Effects of Context Masking</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS6" title="In 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Effects of Different Hyper-Parameters</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S4" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S4.SS1" title="In 4. Related Work ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Non-LLM-Based SRS</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S4.SS2" title="In 4. Related Work ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>LLM-Based SRS</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S4.SS3" title="In 4. Related Work ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>PEFT for LLM</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S5" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A1" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Generate Hard Samples</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A2" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Demonstration of Two Masking Mechanisms for Semantic Alignment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A3" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Attention Calculation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A4" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Demonstration of Serial Adapter and Parallel Adapter</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A5" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Bayesian Optimization with Reparameterization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A6" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Hyper-Parameters for Different Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A7" title="In Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Baselines</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\useunder</span>
<p class="ltx_p" id="p1.2"><span class="ltx_text ltx_ulem_uline" id="p1.2.1"></span><span class="ltx_ERROR undefined" id="p1.2.2">\ul</span>
</p>
</div>
<h1 class="ltx_title ltx_title_document">Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">CanYi Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:liucanyi01@stu.xmu.edu.cn">liucanyi01@stu.xmu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Key Laboratory of Multimedia Trusted Perception and Efficient Computing, Ministry of Education of China</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2">Xiamen University, Xiamen, Fujian, China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wei Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:liwei2002@stu.hit.edu.cn">liwei2002@stu.hit.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Faculty of Computing, Harbin Institute of Technology</span><span class="ltx_text ltx_affiliation_city" id="id4.2.id2">Harbin</span><span class="ltx_text ltx_affiliation_state" id="id5.3.id3">Heilongjiang</span><span class="ltx_text ltx_affiliation_country" id="id6.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Youchen (Victor) Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:vzhang996@g.ucla.edu">vzhang996@g.ucla.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">University of California, Los Angeles</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Los Angeles</span><span class="ltx_text ltx_affiliation_state" id="id9.3.id3">California</span><span class="ltx_text ltx_affiliation_country" id="id10.4.id4">United States</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hui Li, Rongrong Ji
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:hui,%20rrji@xmu.edu.cn">hui, rrji@xmu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">Key Laboratory of Multimedia Trusted Perception and Efficient Computing, Ministry of Education of China</span><span class="ltx_text ltx_affiliation_country" id="id12.2.id2">Xiamen University, Xiamen, Fujian, China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id13.id1">Sequential recommender system (SRS) predicts the next items that users may prefer based on user historical interaction sequences. Inspired by the rise of large language models (LLMs) in various AI applications, there is a surge of work on LLM-based SRS. Despite their attractive performance, existing LLM-based SRS still exhibit some limitations, including neglecting intra-item relations, ignoring long-term collaborative knowledge and using inflexible architecture designs for adaption. To alleviate these issues, we propose an LLM-based SRS named <span class="ltx_text ltx_font_smallcaps" id="id13.id1.1">MixRec</span>. Built on top of coarse-grained adaption for capturing inter-item relations, <span class="ltx_text ltx_font_smallcaps" id="id13.id1.2">MixRec</span> is further enhanced with (1) context masking that models intra-item relations to help LLM better understand token and item semantics in the context of SRS, (2) collaborative knowledge injection that helps LLM incorporate long-term collaborative knowledge, and (3) a dynamic adaptive mixture-of-experts design that can flexibly choose expert architectures based on Bayesian optimization to better incorporate different sequential information. Extensive experiments demonstrate that <span class="ltx_text ltx_font_smallcaps" id="id13.id1.3">MixRec</span> can effectively handle sequential recommendation in a dynamic and adaptive manner.</p>
</div>
<div class="ltx_keywords">sequential recommendation, large language model
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Sequential recommender system (SRS) suggests items that may interest users by modeling user historical interaction sequences.
Aiming at helping users find items more efficiently and online service providers better promote items, SRS has been applied in a wide variety of online applications including but not limited to online shopping (e.g., Amazon), music listening (e.g., Spotify) and news reading (e.g., Yahoo News) <cite class="ltx_cite ltx_citemacro_citep">(Fang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib9" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Due to the pivotal role of SRS, there has been a tremendous amount of work on sequential recommendation in the last decades <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib49" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib50" title="">2022</a>; Quadrana et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib40" title="">2018</a>)</cite>.
In particular, deep learning techniques have greatly boosted the prosperous development of SRS <cite class="ltx_cite ltx_citemacro_citep">(Fang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib9" title="">2020</a>)</cite>.
Nevertheless, deep learning-based SRS still faces various challenges.
One representative issue is that, due to model scale and data size <cite class="ltx_cite ltx_citemacro_citep">(Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib8" title="">2024</a>)</cite>, the understanding of deep learning-based SRS is limited to the context of SRS (e.g., the descriptions of items provided by the online service), making it difficult for them to think like humans with broad world knowledge.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Thanks to the rise of large language models (LLMs) <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib59" title="">2023</a>)</cite>, the aforementioned issue can be alleviated by introducing LLMs into SRS.
Firstly, sequential recommendation data shares some similarities with natural language text in that they are both sequential and represented by individual items/tokens.
It is natural to consider modeling sequential recommendation in a way similar to language modeling and leverage LLMs to capture complex sequential item relations.
Moreover, items in contemporary SRS are typically accompanied by textual side information (e.g., item titles, attributes and descriptions) that can be better understood by LLMs with world knowledge beyond the context of SRS.
Therefore, there is a surge of work on applying LLMs in SRS <cite class="ltx_cite ltx_citemacro_citep">(Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib8" title="">2024</a>; Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib24" title="">2024</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib34" title="">2023</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib32" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Despite the promise of LLM-based SRS, existing works still exhibit some limitations:</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="509" id="S1.F1.g1" src="x1.png" width="665"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Overview of <span class="ltx_text ltx_font_smallcaps" id="S1.F1.2.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S1.F1.2.1.m1.1"><semantics id="S1.F1.2.1.m1.1b"><msub id="S1.F1.2.1.m1.1.1" xref="S1.F1.2.1.m1.1.1.cmml"><mi id="S1.F1.2.1.m1.1.1b" xref="S1.F1.2.1.m1.1.1.cmml"></mi><mtext id="S1.F1.2.1.m1.1.1.1" xref="S1.F1.2.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.F1.2.1.m1.1c"><apply id="S1.F1.2.1.m1.1.1.cmml" xref="S1.F1.2.1.m1.1.1"><ci id="S1.F1.2.1.m1.1.1.1a.cmml" xref="S1.F1.2.1.m1.1.1.1"><mtext id="S1.F1.2.1.m1.1.1.1.cmml" mathsize="70%" xref="S1.F1.2.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.1.m1.1d">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.2.1.m1.1e">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span>. The figure uses the architecture of the standard Transformer layer while the actual design for “Add &amp; Nrom” varies according to detailed LLM.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">P1: Neglect Intra-Item Relations</span>: Sequential relations are under-explored, resulting in sub-optimal performance. Most LLM-based SRS follows the traditional SRS paradigm that captures <em class="ltx_emph ltx_font_italic" id="S1.p5.1.2">inter-item</em> relation in user historical interaction sequences (i.e., item level), neglecting that the minimal modeling granularity in LLM-based SRS is a token in item textual data. Hence, existing methods are coarse-grained and overlook the <em class="ltx_emph ltx_font_italic" id="S1.p5.1.3">intra-item</em> relations (i.e., relations of tokens in an item’s textual data).</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">P2: Ignore Long-Term Collaborative Knowledge</span>: Previous LLM-based SRS focuses on sequential item information in order to fit the sequential modeling nature of LLMs. However, they neglect long-term collaborative knowledge (i.e., user/item representations that can be captured in traditional collaborative filtering (CF) methods). Although user preferences and item properties can be extracted from historical interaction sequences, it is well acknowledged that LLM is not good at modeling long-sequence inputs <cite class="ltx_cite ltx_citemacro_citep">(Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib25" title="">2024</a>)</cite> and cannot model such long-term collaborative knowledge well.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><span class="ltx_text ltx_font_bold" id="S1.p7.1.1">P3: Inflexible Adaption</span>: To reduce the computation cost, most LLM-based SRS opts for parameter-efficient fine-tuning (PEFT) <cite class="ltx_cite ltx_citemacro_citep">(Han et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib13" title="">2024</a>)</cite> to adapt general LLMs for sequential recommendation by fine-tuning only a small amount of parameters. Inserting small adapters is one representative PEFT approach for LLM-based SRS <cite class="ltx_cite ltx_citemacro_citep">(Fu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib10" title="">2024</a>)</cite>. However, the design of adapters is typically pre-defined, leaving the adaption inflexible on different data.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">To address the above issues, we propose <span class="ltx_text ltx_font_smallcaps" id="S1.p8.1.1">MixRec</span>, an LLM-based SRS that can incorporate intra-item information and user-side collaborative knowledge into LLM-based sequential recommendation with dynamic adaptive mixture-of-experts (DAMoE) architecture.
The contributions of this work are summarised as follows:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We design several coarse-grained adaption tasks, including semantic alignment, linking next item and distinguishing hard samples, to adapt LLM for sequential recommendation. With the proposed coarse-grained adaption tasks, <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i1.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.1.m1.1"><semantics id="S1.I1.i1.p1.1.1.m1.1a"><msub id="S1.I1.i1.p1.1.1.m1.1.1" xref="S1.I1.i1.p1.1.1.m1.1.1.cmml"><mi id="S1.I1.i1.p1.1.1.m1.1.1a" xref="S1.I1.i1.p1.1.1.m1.1.1.cmml"></mi><mtext id="S1.I1.i1.p1.1.1.m1.1.1.1" xref="S1.I1.i1.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.1.m1.1b"><apply id="S1.I1.i1.p1.1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.1.m1.1.1"><ci id="S1.I1.i1.p1.1.1.m1.1.1.1a.cmml" xref="S1.I1.i1.p1.1.1.m1.1.1.1"><mtext id="S1.I1.i1.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S1.I1.i1.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> which uses the standard adapter design for LLM-based SRS and is the basic version of <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i1.p1.1.2">MixRec</span>, can capture coarse-grained inter-item relations for sequential recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">To overcome <span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">P1</span>, we propose context masking that captures relations of tokens within the textual information of an item. Context masking is used together with causal masking, the standard attention mechanism of LLM, as two “experts” in the mixture-of-experts (MoE) architecture to help LLM better understand token and item semantics in the context of SRS.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">To address <span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">P2</span>, we design collaborative knowledge injection that jointly trains a small CF model and LLM-based SRS. The learned user/item representations from the CF model are injected into attention computation so that LLM-based SRS can benefit from long-term collaborative knowledge.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(4)</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">To solve <span class="ltx_text ltx_font_bold" id="S1.I1.i4.p1.1.1">P3</span>, we leverage Bayesian optimization with reparameterization to search binary, discrete parameters for deciding the suitable architecture of DAMoE, bringing flexible designs to LLM-based SRS.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(5)</span>
<div class="ltx_para" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.1">Based on <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i5.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S1.I1.i5.p1.1.1.m1.1"><semantics id="S1.I1.i5.p1.1.1.m1.1a"><msub id="S1.I1.i5.p1.1.1.m1.1.1" xref="S1.I1.i5.p1.1.1.m1.1.1.cmml"><mi id="S1.I1.i5.p1.1.1.m1.1.1a" xref="S1.I1.i5.p1.1.1.m1.1.1.cmml"></mi><mtext id="S1.I1.i5.p1.1.1.m1.1.1.1" xref="S1.I1.i5.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S1.I1.i5.p1.1.1.m1.1b"><apply id="S1.I1.i5.p1.1.1.m1.1.1.cmml" xref="S1.I1.i5.p1.1.1.m1.1.1"><ci id="S1.I1.i5.p1.1.1.m1.1.1.1a.cmml" xref="S1.I1.i5.p1.1.1.m1.1.1.1"><mtext id="S1.I1.i5.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S1.I1.i5.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i5.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i5.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> and our designed techniques in (2), (3) and (4), we propose a new LLM-based SRS <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i5.p1.1.2">MixRec</span> for enhancing LLM-based sequential recommendation beyond modeling inter-item relations. We conduct extensive experiments and the results demonstrate that <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i5.p1.1.3">MixRec</span> can effectively handle sequential recommendation in a dynamic and adaptive manner.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Our Method <span class="ltx_text ltx_font_smallcaps" id="S2.1.1">MixRec</span>
</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Overview</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.4">The basic version of <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.4.5">MixRec</span>, which is called <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.1.m1.1"><semantics id="S2.SS1.p1.1.1.m1.1a"><msub id="S2.SS1.p1.1.1.m1.1.1" xref="S2.SS1.p1.1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.1.m1.1.1a" xref="S2.SS1.p1.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS1.p1.1.1.m1.1.1.1" xref="S2.SS1.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.1.m1.1b"><apply id="S2.SS1.p1.1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.1.m1.1.1"><ci id="S2.SS1.p1.1.1.m1.1.1.1a.cmml" xref="S2.SS1.p1.1.1.m1.1.1.1"><mtext id="S2.SS1.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS1.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> in the following, consists of an LLM and an item projection layer.
We adopt the standard design for adapters <cite class="ltx_cite ltx_citemacro_citep">(Fu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib10" title="">2024</a>)</cite> in <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.2.2">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.2.m1.1"><semantics id="S2.SS1.p1.2.2.m1.1a"><msub id="S2.SS1.p1.2.2.m1.1.1" xref="S2.SS1.p1.2.2.m1.1.1.cmml"><mi id="S2.SS1.p1.2.2.m1.1.1a" xref="S2.SS1.p1.2.2.m1.1.1.cmml"></mi><mtext id="S2.SS1.p1.2.2.m1.1.1.1" xref="S2.SS1.p1.2.2.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.2.m1.1b"><apply id="S2.SS1.p1.2.2.m1.1.1.cmml" xref="S2.SS1.p1.2.2.m1.1.1"><ci id="S2.SS1.p1.2.2.m1.1.1.1a.cmml" xref="S2.SS1.p1.2.2.m1.1.1.1"><mtext id="S2.SS1.p1.2.2.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS1.p1.2.2.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.2.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.2.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span>.
As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.3.3">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.3.m1.1"><semantics id="S2.SS1.p1.3.3.m1.1a"><msub id="S2.SS1.p1.3.3.m1.1.1" xref="S2.SS1.p1.3.3.m1.1.1.cmml"><mi id="S2.SS1.p1.3.3.m1.1.1a" xref="S2.SS1.p1.3.3.m1.1.1.cmml"></mi><mtext id="S2.SS1.p1.3.3.m1.1.1.1" xref="S2.SS1.p1.3.3.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.3.m1.1b"><apply id="S2.SS1.p1.3.3.m1.1.1.cmml" xref="S2.SS1.p1.3.3.m1.1.1"><ci id="S2.SS1.p1.3.3.m1.1.1.1a.cmml" xref="S2.SS1.p1.3.3.m1.1.1.1"><mtext id="S2.SS1.p1.3.3.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS1.p1.3.3.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.3.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.3.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> has two adapter blocks inserted into each LLM layer for PEFT, and an item projection layer for mapping the LLM space to the item space.
We design various coarse-grained adaption tasks that capture inter-item relations to endow <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p1.4.4">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.4.m1.1"><semantics id="S2.SS1.p1.4.4.m1.1a"><msub id="S2.SS1.p1.4.4.m1.1.1" xref="S2.SS1.p1.4.4.m1.1.1.cmml"><mi id="S2.SS1.p1.4.4.m1.1.1a" xref="S2.SS1.p1.4.4.m1.1.1.cmml"></mi><mtext id="S2.SS1.p1.4.4.m1.1.1.1" xref="S2.SS1.p1.4.4.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.4.m1.1b"><apply id="S2.SS1.p1.4.4.m1.1.1.cmml" xref="S2.SS1.p1.4.4.m1.1.1"><ci id="S2.SS1.p1.4.4.m1.1.1.1a.cmml" xref="S2.SS1.p1.4.4.m1.1.1.1"><mtext id="S2.SS1.p1.4.4.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS1.p1.4.4.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.4.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.4.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> with the ability to adapt LLM for sequential recommendation (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2" title="2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2</span></a>).</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Based on <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p2.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS1.p2.1.1.m1.1"><semantics id="S2.SS1.p2.1.1.m1.1a"><msub id="S2.SS1.p2.1.1.m1.1.1" xref="S2.SS1.p2.1.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.1.m1.1.1a" xref="S2.SS1.p2.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS1.p2.1.1.m1.1.1.1" xref="S2.SS1.p2.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.1.m1.1b"><apply id="S2.SS1.p2.1.1.m1.1.1.cmml" xref="S2.SS1.p2.1.1.m1.1.1"><ci id="S2.SS1.p2.1.1.m1.1.1.1a.cmml" xref="S2.SS1.p2.1.1.m1.1.1.1"><mtext id="S2.SS1.p2.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS1.p2.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span>, we enhance <span class="ltx_text ltx_font_smallcaps" id="S2.SS1.p2.1.2">MixRec</span> with context masking, collaborative knowledge injection and a dynamic adaptive mixture-of-expert design (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3" title="2.3. Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.3</span></a>) to further incorporate intra-item and long-term collaborative knowledge in a <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.1.3">dynamic</em> and <em class="ltx_emph ltx_font_italic" id="S2.SS1.p2.1.4">adaptive</em> manner.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Adapt LLM for Sequential Recommendation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">We first propose several coarse-grained adaption tasks to help <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.1.m1.1"><semantics id="S2.SS2.p1.1.1.m1.1a"><msub id="S2.SS2.p1.1.1.m1.1.1" xref="S2.SS2.p1.1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.1.m1.1.1a" xref="S2.SS2.p1.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS2.p1.1.1.m1.1.1.1" xref="S2.SS2.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.1.m1.1b"><apply id="S2.SS2.p1.1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.1.m1.1.1"><ci id="S2.SS2.p1.1.1.m1.1.1.1a.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1"><mtext id="S2.SS2.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS2.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> capture inter-item relations and adapt to sequential recommendation.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="239" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Adapt LLM for Sequential Recommendation (<span class="ltx_text ltx_font_smallcaps" id="S2.F2.10.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.F2.10.1.m1.1"><semantics id="S2.F2.10.1.m1.1b"><msub id="S2.F2.10.1.m1.1.1" xref="S2.F2.10.1.m1.1.1.cmml"><mi id="S2.F2.10.1.m1.1.1b" xref="S2.F2.10.1.m1.1.1.cmml"></mi><mtext id="S2.F2.10.1.m1.1.1.1" xref="S2.F2.10.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.10.1.m1.1c"><apply id="S2.F2.10.1.m1.1.1.cmml" xref="S2.F2.10.1.m1.1.1"><ci id="S2.F2.10.1.m1.1.1.1a.cmml" xref="S2.F2.10.1.m1.1.1.1"><mtext id="S2.F2.10.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.F2.10.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.1.m1.1d">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.10.1.m1.1e">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span>): (1) <math alttext="\mathbf{h}_{*}^{\textbf{Prompt}}" class="ltx_Math" display="inline" id="S2.F2.11.m1.1"><semantics id="S2.F2.11.m1.1b"><msubsup id="S2.F2.11.m1.1.1" xref="S2.F2.11.m1.1.1.cmml"><mi id="S2.F2.11.m1.1.1.2.2" xref="S2.F2.11.m1.1.1.2.2.cmml">𝐡</mi><mo id="S2.F2.11.m1.1.1.2.3" xref="S2.F2.11.m1.1.1.2.3.cmml">∗</mo><mtext class="ltx_mathvariant_bold" id="S2.F2.11.m1.1.1.3" xref="S2.F2.11.m1.1.1.3a.cmml">Prompt</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.11.m1.1c"><apply id="S2.F2.11.m1.1.1.cmml" xref="S2.F2.11.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.11.m1.1.1.1.cmml" xref="S2.F2.11.m1.1.1">superscript</csymbol><apply id="S2.F2.11.m1.1.1.2.cmml" xref="S2.F2.11.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.11.m1.1.1.2.1.cmml" xref="S2.F2.11.m1.1.1">subscript</csymbol><ci id="S2.F2.11.m1.1.1.2.2.cmml" xref="S2.F2.11.m1.1.1.2.2">𝐡</ci><times id="S2.F2.11.m1.1.1.2.3.cmml" xref="S2.F2.11.m1.1.1.2.3"></times></apply><ci id="S2.F2.11.m1.1.1.3a.cmml" xref="S2.F2.11.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S2.F2.11.m1.1.1.3.cmml" mathsize="70%" xref="S2.F2.11.m1.1.1.3">Prompt</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.11.m1.1d">\mathbf{h}_{*}^{\textbf{Prompt}}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.11.m1.1e">bold_h start_POSTSUBSCRIPT ∗ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT Prompt end_POSTSUPERSCRIPT</annotation></semantics></math> indicates the hidden state for a token in the prompt. (2) <math alttext="\mathbf{h}_{j,*}" class="ltx_Math" display="inline" id="S2.F2.12.m2.2"><semantics id="S2.F2.12.m2.2b"><msub id="S2.F2.12.m2.2.3" xref="S2.F2.12.m2.2.3.cmml"><mi id="S2.F2.12.m2.2.3.2" xref="S2.F2.12.m2.2.3.2.cmml">𝐡</mi><mrow id="S2.F2.12.m2.2.2.2.4" xref="S2.F2.12.m2.2.2.2.3.cmml"><mi id="S2.F2.12.m2.1.1.1.1" xref="S2.F2.12.m2.1.1.1.1.cmml">j</mi><mo id="S2.F2.12.m2.2.2.2.4.1" rspace="0em" xref="S2.F2.12.m2.2.2.2.3.cmml">,</mo><mo id="S2.F2.12.m2.2.2.2.2" lspace="0em" xref="S2.F2.12.m2.2.2.2.2.cmml">∗</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.F2.12.m2.2c"><apply id="S2.F2.12.m2.2.3.cmml" xref="S2.F2.12.m2.2.3"><csymbol cd="ambiguous" id="S2.F2.12.m2.2.3.1.cmml" xref="S2.F2.12.m2.2.3">subscript</csymbol><ci id="S2.F2.12.m2.2.3.2.cmml" xref="S2.F2.12.m2.2.3.2">𝐡</ci><list id="S2.F2.12.m2.2.2.2.3.cmml" xref="S2.F2.12.m2.2.2.2.4"><ci id="S2.F2.12.m2.1.1.1.1.cmml" xref="S2.F2.12.m2.1.1.1.1">𝑗</ci><times id="S2.F2.12.m2.2.2.2.2.cmml" xref="S2.F2.12.m2.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.12.m2.2d">\mathbf{h}_{j,*}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.12.m2.2e">bold_h start_POSTSUBSCRIPT italic_j , ∗ end_POSTSUBSCRIPT</annotation></semantics></math> is the hidden state for a token in the item “sentence” of item <math alttext="j" class="ltx_Math" display="inline" id="S2.F2.13.m3.1"><semantics id="S2.F2.13.m3.1b"><mi id="S2.F2.13.m3.1.1" xref="S2.F2.13.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.F2.13.m3.1c"><ci id="S2.F2.13.m3.1.1.cmml" xref="S2.F2.13.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.13.m3.1d">j</annotation><annotation encoding="application/x-llamapun" id="S2.F2.13.m3.1e">italic_j</annotation></semantics></math>. (3) <math alttext="\mathbf{h}_{j}^{\textbf{ALIGN}}" class="ltx_Math" display="inline" id="S2.F2.14.m4.1"><semantics id="S2.F2.14.m4.1b"><msubsup id="S2.F2.14.m4.1.1" xref="S2.F2.14.m4.1.1.cmml"><mi id="S2.F2.14.m4.1.1.2.2" xref="S2.F2.14.m4.1.1.2.2.cmml">𝐡</mi><mi id="S2.F2.14.m4.1.1.2.3" xref="S2.F2.14.m4.1.1.2.3.cmml">j</mi><mtext class="ltx_mathvariant_bold" id="S2.F2.14.m4.1.1.3" xref="S2.F2.14.m4.1.1.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.14.m4.1c"><apply id="S2.F2.14.m4.1.1.cmml" xref="S2.F2.14.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.14.m4.1.1.1.cmml" xref="S2.F2.14.m4.1.1">superscript</csymbol><apply id="S2.F2.14.m4.1.1.2.cmml" xref="S2.F2.14.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.14.m4.1.1.2.1.cmml" xref="S2.F2.14.m4.1.1">subscript</csymbol><ci id="S2.F2.14.m4.1.1.2.2.cmml" xref="S2.F2.14.m4.1.1.2.2">𝐡</ci><ci id="S2.F2.14.m4.1.1.2.3.cmml" xref="S2.F2.14.m4.1.1.2.3">𝑗</ci></apply><ci id="S2.F2.14.m4.1.1.3a.cmml" xref="S2.F2.14.m4.1.1.3"><mtext class="ltx_mathvariant_bold" id="S2.F2.14.m4.1.1.3.cmml" mathsize="70%" xref="S2.F2.14.m4.1.1.3">ALIGN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.14.m4.1d">\mathbf{h}_{j}^{\textbf{ALIGN}}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.14.m4.1e">bold_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden state for [ALIGN] of item <math alttext="j" class="ltx_Math" display="inline" id="S2.F2.15.m5.1"><semantics id="S2.F2.15.m5.1b"><mi id="S2.F2.15.m5.1.1" xref="S2.F2.15.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.F2.15.m5.1c"><ci id="S2.F2.15.m5.1.1.cmml" xref="S2.F2.15.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.15.m5.1d">j</annotation><annotation encoding="application/x-llamapun" id="S2.F2.15.m5.1e">italic_j</annotation></semantics></math>. (4) <math alttext="\mathbf{h}_{u,j}^{\textbf{SEQ}}" class="ltx_Math" display="inline" id="S2.F2.16.m6.2"><semantics id="S2.F2.16.m6.2b"><msubsup id="S2.F2.16.m6.2.3" xref="S2.F2.16.m6.2.3.cmml"><mi id="S2.F2.16.m6.2.3.2.2" xref="S2.F2.16.m6.2.3.2.2.cmml">𝐡</mi><mrow id="S2.F2.16.m6.2.2.2.4" xref="S2.F2.16.m6.2.2.2.3.cmml"><mi id="S2.F2.16.m6.1.1.1.1" xref="S2.F2.16.m6.1.1.1.1.cmml">u</mi><mo id="S2.F2.16.m6.2.2.2.4.1" xref="S2.F2.16.m6.2.2.2.3.cmml">,</mo><mi id="S2.F2.16.m6.2.2.2.2" xref="S2.F2.16.m6.2.2.2.2.cmml">j</mi></mrow><mtext class="ltx_mathvariant_bold" id="S2.F2.16.m6.2.3.3" xref="S2.F2.16.m6.2.3.3a.cmml">SEQ</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.16.m6.2c"><apply id="S2.F2.16.m6.2.3.cmml" xref="S2.F2.16.m6.2.3"><csymbol cd="ambiguous" id="S2.F2.16.m6.2.3.1.cmml" xref="S2.F2.16.m6.2.3">superscript</csymbol><apply id="S2.F2.16.m6.2.3.2.cmml" xref="S2.F2.16.m6.2.3"><csymbol cd="ambiguous" id="S2.F2.16.m6.2.3.2.1.cmml" xref="S2.F2.16.m6.2.3">subscript</csymbol><ci id="S2.F2.16.m6.2.3.2.2.cmml" xref="S2.F2.16.m6.2.3.2.2">𝐡</ci><list id="S2.F2.16.m6.2.2.2.3.cmml" xref="S2.F2.16.m6.2.2.2.4"><ci id="S2.F2.16.m6.1.1.1.1.cmml" xref="S2.F2.16.m6.1.1.1.1">𝑢</ci><ci id="S2.F2.16.m6.2.2.2.2.cmml" xref="S2.F2.16.m6.2.2.2.2">𝑗</ci></list></apply><ci id="S2.F2.16.m6.2.3.3a.cmml" xref="S2.F2.16.m6.2.3.3"><mtext class="ltx_mathvariant_bold" id="S2.F2.16.m6.2.3.3.cmml" mathsize="70%" xref="S2.F2.16.m6.2.3.3">SEQ</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.16.m6.2d">\mathbf{h}_{u,j}^{\textbf{SEQ}}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.16.m6.2e">bold_h start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden state for [SEQ] of item <math alttext="j" class="ltx_Math" display="inline" id="S2.F2.17.m7.1"><semantics id="S2.F2.17.m7.1b"><mi id="S2.F2.17.m7.1.1" xref="S2.F2.17.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.F2.17.m7.1c"><ci id="S2.F2.17.m7.1.1.cmml" xref="S2.F2.17.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.17.m7.1d">j</annotation><annotation encoding="application/x-llamapun" id="S2.F2.17.m7.1e">italic_j</annotation></semantics></math> in user <math alttext="u" class="ltx_Math" display="inline" id="S2.F2.18.m8.1"><semantics id="S2.F2.18.m8.1b"><mi id="S2.F2.18.m8.1.1" xref="S2.F2.18.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.F2.18.m8.1c"><ci id="S2.F2.18.m8.1.1.cmml" xref="S2.F2.18.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.18.m8.1d">u</annotation><annotation encoding="application/x-llamapun" id="S2.F2.18.m8.1e">italic_u</annotation></semantics></math>’s historical interaction sequence.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1. </span>Item Representation</h4>
<div class="ltx_para" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.7">For each item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.1.m1.1"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mi id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.1d">italic_i</annotation></semantics></math>, we have its corresponding attribute dictionary <math alttext="{Dic}_{i}=\{k,v\}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.2.m2.2"><semantics id="S2.SS2.SSS1.p1.2.m2.2a"><mrow id="S2.SS2.SSS1.p1.2.m2.2.3" xref="S2.SS2.SSS1.p1.2.m2.2.3.cmml"><mrow id="S2.SS2.SSS1.p1.2.m2.2.3.2" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.2.3.2.2" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.2.cmml">D</mi><mo id="S2.SS2.SSS1.p1.2.m2.2.3.2.1" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.1.cmml">⁢</mo><mi id="S2.SS2.SSS1.p1.2.m2.2.3.2.3" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.3.cmml">i</mi><mo id="S2.SS2.SSS1.p1.2.m2.2.3.2.1a" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.1.cmml">⁢</mo><msub id="S2.SS2.SSS1.p1.2.m2.2.3.2.4" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.4.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.2.3.2.4.2" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.4.2.cmml">c</mi><mi id="S2.SS2.SSS1.p1.2.m2.2.3.2.4.3" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.4.3.cmml">i</mi></msub></mrow><mo id="S2.SS2.SSS1.p1.2.m2.2.3.1" xref="S2.SS2.SSS1.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S2.SS2.SSS1.p1.2.m2.2.3.3.2" xref="S2.SS2.SSS1.p1.2.m2.2.3.3.1.cmml"><mo id="S2.SS2.SSS1.p1.2.m2.2.3.3.2.1" stretchy="false" xref="S2.SS2.SSS1.p1.2.m2.2.3.3.1.cmml">{</mo><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">k</mi><mo id="S2.SS2.SSS1.p1.2.m2.2.3.3.2.2" xref="S2.SS2.SSS1.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S2.SS2.SSS1.p1.2.m2.2.2" xref="S2.SS2.SSS1.p1.2.m2.2.2.cmml">v</mi><mo id="S2.SS2.SSS1.p1.2.m2.2.3.3.2.3" stretchy="false" xref="S2.SS2.SSS1.p1.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.2b"><apply id="S2.SS2.SSS1.p1.2.m2.2.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3"><eq id="S2.SS2.SSS1.p1.2.m2.2.3.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.1"></eq><apply id="S2.SS2.SSS1.p1.2.m2.2.3.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2"><times id="S2.SS2.SSS1.p1.2.m2.2.3.2.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.1"></times><ci id="S2.SS2.SSS1.p1.2.m2.2.3.2.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.2">𝐷</ci><ci id="S2.SS2.SSS1.p1.2.m2.2.3.2.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.3">𝑖</ci><apply id="S2.SS2.SSS1.p1.2.m2.2.3.2.4.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.4"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m2.2.3.2.4.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.4">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m2.2.3.2.4.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.4.2">𝑐</ci><ci id="S2.SS2.SSS1.p1.2.m2.2.3.2.4.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.2.4.3">𝑖</ci></apply></apply><set id="S2.SS2.SSS1.p1.2.m2.2.3.3.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.3.3.2"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝑘</ci><ci id="S2.SS2.SSS1.p1.2.m2.2.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.2.2">𝑣</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.2c">{Dic}_{i}=\{k,v\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m2.2d">italic_D italic_i italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { italic_k , italic_v }</annotation></semantics></math>, where <math alttext="k" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.3.m3.1"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><mi id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><ci id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.3.m3.1d">italic_k</annotation></semantics></math> and <math alttext="v" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.4.m4.1"><semantics id="S2.SS2.SSS1.p1.4.m4.1a"><mi id="S2.SS2.SSS1.p1.4.m4.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.1b"><ci id="S2.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.1c">v</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.4.m4.1d">italic_v</annotation></semantics></math> consist of words.
Following RecFormer <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib29" title="">2023b</a>)</cite>, we flatten the dictionary into an item “sentence”: <math alttext="T_{i}=\{k_{1},v_{1},\dots,k_{g},v_{g}\}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.5.m5.5"><semantics id="S2.SS2.SSS1.p1.5.m5.5a"><mrow id="S2.SS2.SSS1.p1.5.m5.5.5" xref="S2.SS2.SSS1.p1.5.m5.5.5.cmml"><msub id="S2.SS2.SSS1.p1.5.m5.5.5.6" xref="S2.SS2.SSS1.p1.5.m5.5.5.6.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.5.5.6.2" xref="S2.SS2.SSS1.p1.5.m5.5.5.6.2.cmml">T</mi><mi id="S2.SS2.SSS1.p1.5.m5.5.5.6.3" xref="S2.SS2.SSS1.p1.5.m5.5.5.6.3.cmml">i</mi></msub><mo id="S2.SS2.SSS1.p1.5.m5.5.5.5" xref="S2.SS2.SSS1.p1.5.m5.5.5.5.cmml">=</mo><mrow id="S2.SS2.SSS1.p1.5.m5.5.5.4.4" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml"><mo id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.5" stretchy="false" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml">{</mo><msub id="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1" xref="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.2" xref="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.2.cmml">k</mi><mn id="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.3" xref="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.6" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml">,</mo><msub id="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2" xref="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.2" xref="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.2.cmml">v</mi><mn id="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.3" xref="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.7" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml">,</mo><mi id="S2.SS2.SSS1.p1.5.m5.1.1" mathvariant="normal" xref="S2.SS2.SSS1.p1.5.m5.1.1.cmml">…</mi><mo id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.8" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml">,</mo><msub id="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3" xref="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.2" xref="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.2.cmml">k</mi><mi id="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.3" xref="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.3.cmml">g</mi></msub><mo id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.9" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml">,</mo><msub id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.2" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.2.cmml">v</mi><mi id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.3" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.3.cmml">g</mi></msub><mo id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.10" stretchy="false" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m5.5b"><apply id="S2.SS2.SSS1.p1.5.m5.5.5.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5"><eq id="S2.SS2.SSS1.p1.5.m5.5.5.5.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.5"></eq><apply id="S2.SS2.SSS1.p1.5.m5.5.5.6.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.6"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.5.5.6.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.6">subscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.5.5.6.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.6.2">𝑇</ci><ci id="S2.SS2.SSS1.p1.5.m5.5.5.6.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.6.3">𝑖</ci></apply><set id="S2.SS2.SSS1.p1.5.m5.5.5.4.5.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4"><apply id="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.2">𝑘</ci><cn id="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS1.p1.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.2">𝑣</ci><cn id="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.SSS1.p1.5.m5.3.3.2.2.2.3">1</cn></apply><ci id="S2.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1">…</ci><apply id="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.2">𝑘</ci><ci id="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.4.4.3.3.3.3">𝑔</ci></apply><apply id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4">subscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.2">𝑣</ci><ci id="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.5.5.4.4.4.3">𝑔</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m5.5c">T_{i}=\{k_{1},v_{1},\dots,k_{g},v_{g}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.5.m5.5d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_k start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT }</annotation></semantics></math> as the item representation for <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.6.m6.1"><semantics id="S2.SS2.SSS1.p1.6.m6.1a"><mi id="S2.SS2.SSS1.p1.6.m6.1.1" xref="S2.SS2.SSS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.6.m6.1b"><ci id="S2.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.6.m6.1d">italic_i</annotation></semantics></math> where <math alttext="g" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.7.m7.1"><semantics id="S2.SS2.SSS1.p1.7.m7.1a"><mi id="S2.SS2.SSS1.p1.7.m7.1.1" xref="S2.SS2.SSS1.p1.7.m7.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.7.m7.1b"><ci id="S2.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.7.m7.1c">g</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.7.m7.1d">italic_g</annotation></semantics></math> is the number of key-value pairs.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2. </span>Semantic Alignment</h4>
<div class="ltx_para" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.1">Items are typically represented by IDs (e.g., “X2112”) in SRS.
However, these item IDs are rare in the training corpora of LLM.
Hence, given the recommendation context, it is difficult for LLM to understand item IDs.
To enhance the understanding of LLM on item IDs, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.F2" title="Figure 2 ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(a), we conduct semantic alignment between a special token <math alttext="\left[\text{ALIGN}\right]" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.1.m1.1"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><mrow id="S2.SS2.SSS2.p1.1.m1.1.2.2" xref="S2.SS2.SSS2.p1.1.m1.1.2.1.cmml"><mo id="S2.SS2.SSS2.p1.1.m1.1.2.2.1" xref="S2.SS2.SSS2.p1.1.m1.1.2.1.1.cmml">[</mo><mtext id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1a.cmml">ALIGN</mtext><mo id="S2.SS2.SSS2.p1.1.m1.1.2.2.2" xref="S2.SS2.SSS2.p1.1.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.2.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.2.2"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.1.m1.1.2.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS2.SSS2.p1.1.m1.1.1a.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><mtext id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">ALIGN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">\left[\text{ALIGN}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">[ ALIGN ]</annotation></semantics></math> and the corresponding item ID.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p2">
<p class="ltx_p" id="S2.SS2.SSS2.p2.8">Specially, for an item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.1.m1.1"><semantics id="S2.SS2.SSS2.p2.1.m1.1a"><mi id="S2.SS2.SSS2.p2.1.m1.1.1" xref="S2.SS2.SSS2.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.1.m1.1b"><ci id="S2.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.1.m1.1d">italic_i</annotation></semantics></math>, we concatenate a prompt, the item “sentence”, and a special token <math alttext="\left[\text{ALIGN}\right]" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.2.m2.1"><semantics id="S2.SS2.SSS2.p2.2.m2.1a"><mrow id="S2.SS2.SSS2.p2.2.m2.1.2.2" xref="S2.SS2.SSS2.p2.2.m2.1.2.1.cmml"><mo id="S2.SS2.SSS2.p2.2.m2.1.2.2.1" xref="S2.SS2.SSS2.p2.2.m2.1.2.1.1.cmml">[</mo><mtext id="S2.SS2.SSS2.p2.2.m2.1.1" xref="S2.SS2.SSS2.p2.2.m2.1.1a.cmml">ALIGN</mtext><mo id="S2.SS2.SSS2.p2.2.m2.1.2.2.2" xref="S2.SS2.SSS2.p2.2.m2.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.2.m2.1b"><apply id="S2.SS2.SSS2.p2.2.m2.1.2.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.2.2"><csymbol cd="latexml" id="S2.SS2.SSS2.p2.2.m2.1.2.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS2.SSS2.p2.2.m2.1.1a.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1"><mtext id="S2.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1">ALIGN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.2.m2.1c">\left[\text{ALIGN}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.2.m2.1d">[ ALIGN ]</annotation></semantics></math>, and feed {Prompt, <math alttext="T_{i}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.3.m3.1"><semantics id="S2.SS2.SSS2.p2.3.m3.1a"><msub id="S2.SS2.SSS2.p2.3.m3.1.1" xref="S2.SS2.SSS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.SSS2.p2.3.m3.1.1.2" xref="S2.SS2.SSS2.p2.3.m3.1.1.2.cmml">T</mi><mi id="S2.SS2.SSS2.p2.3.m3.1.1.3" xref="S2.SS2.SSS2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.3.m3.1b"><apply id="S2.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1.2">𝑇</ci><ci id="S2.SS2.SSS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.3.m3.1c">T_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.3.m3.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\left[\text{ALIGN}\right]" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.4.m4.1"><semantics id="S2.SS2.SSS2.p2.4.m4.1a"><mrow id="S2.SS2.SSS2.p2.4.m4.1.2.2" xref="S2.SS2.SSS2.p2.4.m4.1.2.1.cmml"><mo id="S2.SS2.SSS2.p2.4.m4.1.2.2.1" xref="S2.SS2.SSS2.p2.4.m4.1.2.1.1.cmml">[</mo><mtext id="S2.SS2.SSS2.p2.4.m4.1.1" xref="S2.SS2.SSS2.p2.4.m4.1.1a.cmml">ALIGN</mtext><mo id="S2.SS2.SSS2.p2.4.m4.1.2.2.2" xref="S2.SS2.SSS2.p2.4.m4.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.4.m4.1b"><apply id="S2.SS2.SSS2.p2.4.m4.1.2.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.2.2"><csymbol cd="latexml" id="S2.SS2.SSS2.p2.4.m4.1.2.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS2.SSS2.p2.4.m4.1.1a.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1"><mtext id="S2.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1">ALIGN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.4.m4.1c">\left[\text{ALIGN}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.4.m4.1d">[ ALIGN ]</annotation></semantics></math>} to LLM.
Here, we use the prompt:“Give the ID of the item described by:…”.
Then, we adopt an item projection layer (a single-layer feedforward network) to convert <math alttext="\mathbf{h}^{\text{ALIGN}}_{i}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.5.m5.1"><semantics id="S2.SS2.SSS2.p2.5.m5.1a"><msubsup id="S2.SS2.SSS2.p2.5.m5.1.1" xref="S2.SS2.SSS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.SSS2.p2.5.m5.1.1.2.2" xref="S2.SS2.SSS2.p2.5.m5.1.1.2.2.cmml">𝐡</mi><mi id="S2.SS2.SSS2.p2.5.m5.1.1.3" xref="S2.SS2.SSS2.p2.5.m5.1.1.3.cmml">i</mi><mtext id="S2.SS2.SSS2.p2.5.m5.1.1.2.3" xref="S2.SS2.SSS2.p2.5.m5.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.5.m5.1b"><apply id="S2.SS2.SSS2.p2.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1">subscript</csymbol><apply id="S2.SS2.SSS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.5.m5.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p2.5.m5.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS2.p2.5.m5.1.1.2.3a.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1.2.3"><mtext id="S2.SS2.SSS2.p2.5.m5.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS2.p2.5.m5.1.1.2.3">ALIGN</mtext></ci></apply><ci id="S2.SS2.SSS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.SSS2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.5.m5.1c">\mathbf{h}^{\text{ALIGN}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.5.m5.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the hidden state corresponds to <math alttext="\left[\text{ALIGN}\right]" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.6.m6.1"><semantics id="S2.SS2.SSS2.p2.6.m6.1a"><mrow id="S2.SS2.SSS2.p2.6.m6.1.2.2" xref="S2.SS2.SSS2.p2.6.m6.1.2.1.cmml"><mo id="S2.SS2.SSS2.p2.6.m6.1.2.2.1" xref="S2.SS2.SSS2.p2.6.m6.1.2.1.1.cmml">[</mo><mtext id="S2.SS2.SSS2.p2.6.m6.1.1" xref="S2.SS2.SSS2.p2.6.m6.1.1a.cmml">ALIGN</mtext><mo id="S2.SS2.SSS2.p2.6.m6.1.2.2.2" xref="S2.SS2.SSS2.p2.6.m6.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.6.m6.1b"><apply id="S2.SS2.SSS2.p2.6.m6.1.2.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.2"><csymbol cd="latexml" id="S2.SS2.SSS2.p2.6.m6.1.2.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS2.SSS2.p2.6.m6.1.1a.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1"><mtext id="S2.SS2.SSS2.p2.6.m6.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m6.1.1">ALIGN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.6.m6.1c">\left[\text{ALIGN}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.6.m6.1d">[ ALIGN ]</annotation></semantics></math> from the last layer in LLM, to the item probability distribution.
<math alttext="\mathbf{h}^{\text{ALIGN}}_{i}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.7.m7.1"><semantics id="S2.SS2.SSS2.p2.7.m7.1a"><msubsup id="S2.SS2.SSS2.p2.7.m7.1.1" xref="S2.SS2.SSS2.p2.7.m7.1.1.cmml"><mi id="S2.SS2.SSS2.p2.7.m7.1.1.2.2" xref="S2.SS2.SSS2.p2.7.m7.1.1.2.2.cmml">𝐡</mi><mi id="S2.SS2.SSS2.p2.7.m7.1.1.3" xref="S2.SS2.SSS2.p2.7.m7.1.1.3.cmml">i</mi><mtext id="S2.SS2.SSS2.p2.7.m7.1.1.2.3" xref="S2.SS2.SSS2.p2.7.m7.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.7.m7.1b"><apply id="S2.SS2.SSS2.p2.7.m7.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.7.m7.1.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1">subscript</csymbol><apply id="S2.SS2.SSS2.p2.7.m7.1.1.2.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.7.m7.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p2.7.m7.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS2.p2.7.m7.1.1.2.3a.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1.2.3"><mtext id="S2.SS2.SSS2.p2.7.m7.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS2.p2.7.m7.1.1.2.3">ALIGN</mtext></ci></apply><ci id="S2.SS2.SSS2.p2.7.m7.1.1.3.cmml" xref="S2.SS2.SSS2.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.7.m7.1c">\mathbf{h}^{\text{ALIGN}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.7.m7.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is regarded as the learned representation of <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.8.m8.1"><semantics id="S2.SS2.SSS2.p2.8.m8.1a"><mi id="S2.SS2.SSS2.p2.8.m8.1.1" xref="S2.SS2.SSS2.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.8.m8.1b"><ci id="S2.SS2.SSS2.p2.8.m8.1.1.cmml" xref="S2.SS2.SSS2.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.8.m8.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.8.m8.1d">italic_i</annotation></semantics></math>, similar to using the representation of a special token [CLS] to represent a sentence when using a pre-trained model in the text classification task <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib7" title="">2019</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib35" title="">2019a</a>)</cite>.
During optimization, we use cross-entropy loss between the item probability distributions and actual item IDs to align hidden states and corresponding item IDs:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\hat{\mathbf{y}}_{i}=\text{Softmax}(\textbf{W}_{\text{item}}\cdot\mathbf%
{h}^{\text{ALIGN}}_{i}+\textbf{b}_{\text{item}}),\,\,\mathcal{L}_{\text{align}%
}=-\sum_{i}y_{i}\log\hat{\mathbf{y}}_{i}" class="ltx_Math" display="block" id="S2.Ex1.m1.2"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.2" xref="S2.Ex1.m1.2.2.3.cmml"><mrow id="S2.Ex1.m1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.cmml"><msub id="S2.Ex1.m1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.3.cmml"><mover accent="true" id="S2.Ex1.m1.1.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.3.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.3.2.2" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.3.2.2.cmml">𝐲</mi><mo id="S2.Ex1.m1.1.1.1.1.3.2.1" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.Ex1.m1.1.1.1.1.3.3" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.Ex1.m1.1.1.1.1.2" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.cmml"><mtext id="S2.Ex1.m1.1.1.1.1.1.3" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.3a.cmml">Softmax</mtext><mo id="S2.Ex1.m1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2a.cmml">W</mtext><mtext id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3a.cmml">item</mtext></msub><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msubsup id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.2" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">𝐡</mi><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi><mtext id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.3" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.3a.cmml">ALIGN</mtext></msubsup></mrow><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2a.cmml">b</mtext><mtext id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3a.cmml">item</mtext></msub></mrow><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.2.2.2.3" mathsize="90%" rspace="0.497em" xref="S2.Ex1.m1.2.2.3a.cmml">,</mo><mrow id="S2.Ex1.m1.2.2.2.2" xref="S2.Ex1.m1.2.2.2.2.cmml"><msub id="S2.Ex1.m1.2.2.2.2.2" xref="S2.Ex1.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.2.2.2.2" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.2.2.cmml">ℒ</mi><mtext id="S2.Ex1.m1.2.2.2.2.2.3" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.2.3a.cmml">align</mtext></msub><mo id="S2.Ex1.m1.2.2.2.2.1" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.1.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.2.2.3" xref="S2.Ex1.m1.2.2.2.2.3.cmml"><mo id="S2.Ex1.m1.2.2.2.2.3a" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.cmml">−</mo><mrow id="S2.Ex1.m1.2.2.2.2.3.2" xref="S2.Ex1.m1.2.2.2.2.3.2.cmml"><munder id="S2.Ex1.m1.2.2.2.2.3.2.1" xref="S2.Ex1.m1.2.2.2.2.3.2.1.cmml"><mo id="S2.Ex1.m1.2.2.2.2.3.2.1.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.Ex1.m1.2.2.2.2.3.2.1.2.cmml">∑</mo><mi id="S2.Ex1.m1.2.2.2.2.3.2.1.3" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.2.1.3.cmml">i</mi></munder><mrow id="S2.Ex1.m1.2.2.2.2.3.2.2" xref="S2.Ex1.m1.2.2.2.2.3.2.2.cmml"><msub id="S2.Ex1.m1.2.2.2.2.3.2.2.2" xref="S2.Ex1.m1.2.2.2.2.3.2.2.2.cmml"><mi id="S2.Ex1.m1.2.2.2.2.3.2.2.2.2" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.2.2.2.2.cmml">y</mi><mi id="S2.Ex1.m1.2.2.2.2.3.2.2.2.3" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.2.2.2.3.cmml">i</mi></msub><mo id="S2.Ex1.m1.2.2.2.2.3.2.2.1" lspace="0.167em" xref="S2.Ex1.m1.2.2.2.2.3.2.2.1.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.2.2.3.2.2.3" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.cmml"><mi id="S2.Ex1.m1.2.2.2.2.3.2.2.3.1" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.1.cmml">log</mi><mo id="S2.Ex1.m1.2.2.2.2.3.2.2.3a" lspace="0.167em" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.cmml">⁡</mo><msub id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.cmml"><mover accent="true" id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.cmml"><mi id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.2" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.2.cmml">𝐲</mi><mo id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.1" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.1.cmml">^</mo></mover><mi id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.3" mathsize="90%" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.3a.cmml" xref="S2.Ex1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.Ex1.m1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1"><eq id="S2.Ex1.m1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.2"></eq><apply id="S2.Ex1.m1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.Ex1.m1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2"><ci id="S2.Ex1.m1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.1">^</ci><ci id="S2.Ex1.m1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.3.2.2">𝐲</ci></apply><ci id="S2.Ex1.m1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1"><times id="S2.Ex1.m1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2"></times><ci id="S2.Ex1.m1.1.1.1.1.1.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3"><mtext id="S2.Ex1.m1.1.1.1.1.1.3.cmml" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.3">Softmax</mtext></ci><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1"><plus id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2"><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.1">⋅</ci><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.2">W</mtext></ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3"><mtext id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="63%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.2.3">item</mtext></ci></apply><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.2">𝐡</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.3"><mtext id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" mathsize="63%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.2.3">ALIGN</mtext></ci></apply><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2a.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2.cmml" mathsize="90%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.2">b</mtext></ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3"><mtext id="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="63%" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.3.3">item</mtext></ci></apply></apply></apply></apply><apply id="S2.Ex1.m1.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2"><eq id="S2.Ex1.m1.2.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.1"></eq><apply id="S2.Ex1.m1.2.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.2.2">ℒ</ci><ci id="S2.Ex1.m1.2.2.2.2.2.3a.cmml" xref="S2.Ex1.m1.2.2.2.2.2.3"><mtext id="S2.Ex1.m1.2.2.2.2.2.3.cmml" mathsize="63%" xref="S2.Ex1.m1.2.2.2.2.2.3">align</mtext></ci></apply><apply id="S2.Ex1.m1.2.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.2.3"><minus id="S2.Ex1.m1.2.2.2.2.3.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3"></minus><apply id="S2.Ex1.m1.2.2.2.2.3.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2"><apply id="S2.Ex1.m1.2.2.2.2.3.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.3.2.1.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.1">subscript</csymbol><sum id="S2.Ex1.m1.2.2.2.2.3.2.1.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.1.2"></sum><ci id="S2.Ex1.m1.2.2.2.2.3.2.1.3.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.1.3">𝑖</ci></apply><apply id="S2.Ex1.m1.2.2.2.2.3.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2"><times id="S2.Ex1.m1.2.2.2.2.3.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.1"></times><apply id="S2.Ex1.m1.2.2.2.2.3.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.3.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.2.2.3.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.2.2">𝑦</ci><ci id="S2.Ex1.m1.2.2.2.2.3.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.2.3">𝑖</ci></apply><apply id="S2.Ex1.m1.2.2.2.2.3.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3"><log id="S2.Ex1.m1.2.2.2.2.3.2.2.3.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.1"></log><apply id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2">subscript</csymbol><apply id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2"><ci id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.1">^</ci><ci id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.2.2">𝐲</ci></apply><ci id="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.3.cmml" xref="S2.Ex1.m1.2.2.2.2.3.2.2.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">\small\hat{\mathbf{y}}_{i}=\text{Softmax}(\textbf{W}_{\text{item}}\cdot\mathbf%
{h}^{\text{ALIGN}}_{i}+\textbf{b}_{\text{item}}),\,\,\mathcal{L}_{\text{align}%
}=-\sum_{i}y_{i}\log\hat{\mathbf{y}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.2d">over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Softmax ( W start_POSTSUBSCRIPT item end_POSTSUBSCRIPT ⋅ bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + b start_POSTSUBSCRIPT item end_POSTSUBSCRIPT ) , caligraphic_L start_POSTSUBSCRIPT align end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p2.12">where <math alttext="\textbf{W}_{\text{item}}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.9.m1.1"><semantics id="S2.SS2.SSS2.p2.9.m1.1a"><msub id="S2.SS2.SSS2.p2.9.m1.1.1" xref="S2.SS2.SSS2.p2.9.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.SSS2.p2.9.m1.1.1.2" xref="S2.SS2.SSS2.p2.9.m1.1.1.2a.cmml">W</mtext><mtext id="S2.SS2.SSS2.p2.9.m1.1.1.3" xref="S2.SS2.SSS2.p2.9.m1.1.1.3a.cmml">item</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.9.m1.1b"><apply id="S2.SS2.SSS2.p2.9.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.9.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.9.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.9.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.9.m1.1.1.2a.cmml" xref="S2.SS2.SSS2.p2.9.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.SSS2.p2.9.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.9.m1.1.1.2">W</mtext></ci><ci id="S2.SS2.SSS2.p2.9.m1.1.1.3a.cmml" xref="S2.SS2.SSS2.p2.9.m1.1.1.3"><mtext id="S2.SS2.SSS2.p2.9.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS2.SSS2.p2.9.m1.1.1.3">item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.9.m1.1c">\textbf{W}_{\text{item}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.9.m1.1d">W start_POSTSUBSCRIPT item end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{b}_{\text{item}}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.10.m2.1"><semantics id="S2.SS2.SSS2.p2.10.m2.1a"><msub id="S2.SS2.SSS2.p2.10.m2.1.1" xref="S2.SS2.SSS2.p2.10.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.SSS2.p2.10.m2.1.1.2" xref="S2.SS2.SSS2.p2.10.m2.1.1.2a.cmml">b</mtext><mtext id="S2.SS2.SSS2.p2.10.m2.1.1.3" xref="S2.SS2.SSS2.p2.10.m2.1.1.3a.cmml">item</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.10.m2.1b"><apply id="S2.SS2.SSS2.p2.10.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.10.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.10.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.10.m2.1.1.2a.cmml" xref="S2.SS2.SSS2.p2.10.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.SSS2.p2.10.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.10.m2.1.1.2">b</mtext></ci><ci id="S2.SS2.SSS2.p2.10.m2.1.1.3a.cmml" xref="S2.SS2.SSS2.p2.10.m2.1.1.3"><mtext id="S2.SS2.SSS2.p2.10.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS2.SSS2.p2.10.m2.1.1.3">item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.10.m2.1c">\textbf{b}_{\text{item}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.10.m2.1d">b start_POSTSUBSCRIPT item end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters, and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.11.m3.1"><semantics id="S2.SS2.SSS2.p2.11.m3.1a"><msub id="S2.SS2.SSS2.p2.11.m3.1.1" xref="S2.SS2.SSS2.p2.11.m3.1.1.cmml"><mi id="S2.SS2.SSS2.p2.11.m3.1.1.2" xref="S2.SS2.SSS2.p2.11.m3.1.1.2.cmml">y</mi><mi id="S2.SS2.SSS2.p2.11.m3.1.1.3" xref="S2.SS2.SSS2.p2.11.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.11.m3.1b"><apply id="S2.SS2.SSS2.p2.11.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.11.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.11.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p2.11.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.11.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p2.11.m3.1.1.2">𝑦</ci><ci id="S2.SS2.SSS2.p2.11.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p2.11.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.11.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.11.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the actual item ID of item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p2.12.m4.1"><semantics id="S2.SS2.SSS2.p2.12.m4.1a"><mi id="S2.SS2.SSS2.p2.12.m4.1.1" xref="S2.SS2.SSS2.p2.12.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.12.m4.1b"><ci id="S2.SS2.SSS2.p2.12.m4.1.1.cmml" xref="S2.SS2.SSS2.p2.12.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.12.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.12.m4.1d">italic_i</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS2.p3">
<p class="ltx_p" id="S2.SS2.SSS2.p3.1">Through semantic alignment, <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS2.p3.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p3.1.1.m1.1"><semantics id="S2.SS2.SSS2.p3.1.1.m1.1a"><msub id="S2.SS2.SSS2.p3.1.1.m1.1.1" xref="S2.SS2.SSS2.p3.1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p3.1.1.m1.1.1a" xref="S2.SS2.SSS2.p3.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS2.SSS2.p3.1.1.m1.1.1.1" xref="S2.SS2.SSS2.p3.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.1.1.m1.1b"><apply id="S2.SS2.SSS2.p3.1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.1.m1.1.1"><ci id="S2.SS2.SSS2.p3.1.1.m1.1.1.1a.cmml" xref="S2.SS2.SSS2.p3.1.1.m1.1.1.1"><mtext id="S2.SS2.SSS2.p3.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS2.SSS2.p3.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> can capture the relationship between item IDs and the recommendation context where item IDs appear, thereby gaining a better understanding of items.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.3. </span>Link Next Item</h4>
<div class="ltx_para" id="S2.SS2.SSS3.p1">
<p class="ltx_p" id="S2.SS2.SSS3.p1.5">We further endow LLM with the ability to predict next items.
Each item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.1.m1.1"><semantics id="S2.SS2.SSS3.p1.1.m1.1a"><mi id="S2.SS2.SSS3.p1.1.m1.1.1" xref="S2.SS2.SSS3.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.1.m1.1b"><ci id="S2.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.1.m1.1d">italic_i</annotation></semantics></math> in the historical interaction sequence <math alttext="S_{u}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.2.m2.1"><semantics id="S2.SS2.SSS3.p1.2.m2.1a"><msub id="S2.SS2.SSS3.p1.2.m2.1.1" xref="S2.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS3.p1.2.m2.1.1.2" xref="S2.SS2.SSS3.p1.2.m2.1.1.2.cmml">S</mi><mi id="S2.SS2.SSS3.p1.2.m2.1.1.3" xref="S2.SS2.SSS3.p1.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.2.m2.1b"><apply id="S2.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS3.p1.2.m2.1.1.2">𝑆</ci><ci id="S2.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS3.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.2.m2.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> of the user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.3.m3.1"><semantics id="S2.SS2.SSS3.p1.3.m3.1a"><mi id="S2.SS2.SSS3.p1.3.m3.1.1" xref="S2.SS2.SSS3.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.3.m3.1b"><ci id="S2.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS3.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.3.m3.1d">italic_u</annotation></semantics></math> can be denoted by its corresponding item “sentence”.
We append a special token <math alttext="\left[\text{SEQ}\right]" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.4.m4.1"><semantics id="S2.SS2.SSS3.p1.4.m4.1a"><mrow id="S2.SS2.SSS3.p1.4.m4.1.2.2" xref="S2.SS2.SSS3.p1.4.m4.1.2.1.cmml"><mo id="S2.SS2.SSS3.p1.4.m4.1.2.2.1" xref="S2.SS2.SSS3.p1.4.m4.1.2.1.1.cmml">[</mo><mtext id="S2.SS2.SSS3.p1.4.m4.1.1" xref="S2.SS2.SSS3.p1.4.m4.1.1a.cmml">SEQ</mtext><mo id="S2.SS2.SSS3.p1.4.m4.1.2.2.2" xref="S2.SS2.SSS3.p1.4.m4.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.4.m4.1b"><apply id="S2.SS2.SSS3.p1.4.m4.1.2.1.cmml" xref="S2.SS2.SSS3.p1.4.m4.1.2.2"><csymbol cd="latexml" id="S2.SS2.SSS3.p1.4.m4.1.2.1.1.cmml" xref="S2.SS2.SSS3.p1.4.m4.1.2.2.1">delimited-[]</csymbol><ci id="S2.SS2.SSS3.p1.4.m4.1.1a.cmml" xref="S2.SS2.SSS3.p1.4.m4.1.1"><mtext id="S2.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS3.p1.4.m4.1.1">SEQ</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.4.m4.1c">\left[\text{SEQ}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.4.m4.1d">[ SEQ ]</annotation></semantics></math> to the end of each item “sentence” to separate items and construct the sequential textual data for <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.5.m5.1"><semantics id="S2.SS2.SSS3.p1.5.m5.1a"><mi id="S2.SS2.SSS3.p1.5.m5.1.1" xref="S2.SS2.SSS3.p1.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.5.m5.1b"><ci id="S2.SS2.SSS3.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS3.p1.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.5.m5.1d">italic_u</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small X_{u}=\left\{T_{1},\left[\text{SEQ}\right],\dots,T_{j},\left[\text{SEQ}%
\right],\cdots,T_{n},\left[\text{SEQ}\right]\right\}," class="ltx_Math" display="block" id="S2.Ex2.m1.6"><semantics id="S2.Ex2.m1.6a"><mrow id="S2.Ex2.m1.6.6.1" xref="S2.Ex2.m1.6.6.1.1.cmml"><mrow id="S2.Ex2.m1.6.6.1.1" xref="S2.Ex2.m1.6.6.1.1.cmml"><msub id="S2.Ex2.m1.6.6.1.1.8" xref="S2.Ex2.m1.6.6.1.1.8.cmml"><mi id="S2.Ex2.m1.6.6.1.1.8.2" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.8.2.cmml">X</mi><mi id="S2.Ex2.m1.6.6.1.1.8.3" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.8.3.cmml">u</mi></msub><mo id="S2.Ex2.m1.6.6.1.1.7" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.7.cmml">=</mo><mrow id="S2.Ex2.m1.6.6.1.1.6.6" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml"><mo id="S2.Ex2.m1.6.6.1.1.6.6.7" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">{</mo><msub id="S2.Ex2.m1.6.6.1.1.1.1.1" xref="S2.Ex2.m1.6.6.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.6.6.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2.cmml">T</mi><mn id="S2.Ex2.m1.6.6.1.1.1.1.1.3" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.Ex2.m1.6.6.1.1.6.6.8" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">,</mo><mrow id="S2.Ex2.m1.6.6.1.1.2.2.2.2" xref="S2.Ex2.m1.6.6.1.1.2.2.2.1.cmml"><mo id="S2.Ex2.m1.6.6.1.1.2.2.2.2.1" xref="S2.Ex2.m1.6.6.1.1.2.2.2.1.1.cmml">[</mo><mtext id="S2.Ex2.m1.1.1" mathsize="90%" xref="S2.Ex2.m1.1.1a.cmml">SEQ</mtext><mo id="S2.Ex2.m1.6.6.1.1.2.2.2.2.2" xref="S2.Ex2.m1.6.6.1.1.2.2.2.1.1.cmml">]</mo></mrow><mo id="S2.Ex2.m1.6.6.1.1.6.6.9" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">,</mo><mi id="S2.Ex2.m1.4.4" mathsize="90%" mathvariant="normal" xref="S2.Ex2.m1.4.4.cmml">…</mi><mo id="S2.Ex2.m1.6.6.1.1.6.6.10" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">,</mo><msub id="S2.Ex2.m1.6.6.1.1.3.3.3" xref="S2.Ex2.m1.6.6.1.1.3.3.3.cmml"><mi id="S2.Ex2.m1.6.6.1.1.3.3.3.2" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.3.3.3.2.cmml">T</mi><mi id="S2.Ex2.m1.6.6.1.1.3.3.3.3" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3.cmml">j</mi></msub><mo id="S2.Ex2.m1.6.6.1.1.6.6.11" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">,</mo><mrow id="S2.Ex2.m1.6.6.1.1.4.4.4.2" xref="S2.Ex2.m1.6.6.1.1.4.4.4.1.cmml"><mo id="S2.Ex2.m1.6.6.1.1.4.4.4.2.1" xref="S2.Ex2.m1.6.6.1.1.4.4.4.1.1.cmml">[</mo><mtext id="S2.Ex2.m1.2.2" mathsize="90%" xref="S2.Ex2.m1.2.2a.cmml">SEQ</mtext><mo id="S2.Ex2.m1.6.6.1.1.4.4.4.2.2" xref="S2.Ex2.m1.6.6.1.1.4.4.4.1.1.cmml">]</mo></mrow><mo id="S2.Ex2.m1.6.6.1.1.6.6.12" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">,</mo><mi id="S2.Ex2.m1.5.5" mathsize="90%" mathvariant="normal" xref="S2.Ex2.m1.5.5.cmml">⋯</mi><mo id="S2.Ex2.m1.6.6.1.1.6.6.13" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">,</mo><msub id="S2.Ex2.m1.6.6.1.1.5.5.5" xref="S2.Ex2.m1.6.6.1.1.5.5.5.cmml"><mi id="S2.Ex2.m1.6.6.1.1.5.5.5.2" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.5.5.5.2.cmml">T</mi><mi id="S2.Ex2.m1.6.6.1.1.5.5.5.3" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.5.5.5.3.cmml">n</mi></msub><mo id="S2.Ex2.m1.6.6.1.1.6.6.14" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">,</mo><mrow id="S2.Ex2.m1.6.6.1.1.6.6.6.2" xref="S2.Ex2.m1.6.6.1.1.6.6.6.1.cmml"><mo id="S2.Ex2.m1.6.6.1.1.6.6.6.2.1" xref="S2.Ex2.m1.6.6.1.1.6.6.6.1.1.cmml">[</mo><mtext id="S2.Ex2.m1.3.3" mathsize="90%" xref="S2.Ex2.m1.3.3a.cmml">SEQ</mtext><mo id="S2.Ex2.m1.6.6.1.1.6.6.6.2.2" xref="S2.Ex2.m1.6.6.1.1.6.6.6.1.1.cmml">]</mo></mrow><mo id="S2.Ex2.m1.6.6.1.1.6.6.15" xref="S2.Ex2.m1.6.6.1.1.6.7.cmml">}</mo></mrow></mrow><mo id="S2.Ex2.m1.6.6.1.2" mathsize="90%" xref="S2.Ex2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.6b"><apply id="S2.Ex2.m1.6.6.1.1.cmml" xref="S2.Ex2.m1.6.6.1"><eq id="S2.Ex2.m1.6.6.1.1.7.cmml" xref="S2.Ex2.m1.6.6.1.1.7"></eq><apply id="S2.Ex2.m1.6.6.1.1.8.cmml" xref="S2.Ex2.m1.6.6.1.1.8"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.8.1.cmml" xref="S2.Ex2.m1.6.6.1.1.8">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.8.2.cmml" xref="S2.Ex2.m1.6.6.1.1.8.2">𝑋</ci><ci id="S2.Ex2.m1.6.6.1.1.8.3.cmml" xref="S2.Ex2.m1.6.6.1.1.8.3">𝑢</ci></apply><set id="S2.Ex2.m1.6.6.1.1.6.7.cmml" xref="S2.Ex2.m1.6.6.1.1.6.6"><apply id="S2.Ex2.m1.6.6.1.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.6.6.1.1.1.1.1.2">𝑇</ci><cn id="S2.Ex2.m1.6.6.1.1.1.1.1.3.cmml" type="integer" xref="S2.Ex2.m1.6.6.1.1.1.1.1.3">1</cn></apply><apply id="S2.Ex2.m1.6.6.1.1.2.2.2.1.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2"><csymbol cd="latexml" id="S2.Ex2.m1.6.6.1.1.2.2.2.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.2.2.2.2.1">delimited-[]</csymbol><ci id="S2.Ex2.m1.1.1a.cmml" xref="S2.Ex2.m1.1.1"><mtext id="S2.Ex2.m1.1.1.cmml" mathsize="90%" xref="S2.Ex2.m1.1.1">SEQ</mtext></ci></apply><ci id="S2.Ex2.m1.4.4.cmml" xref="S2.Ex2.m1.4.4">…</ci><apply id="S2.Ex2.m1.6.6.1.1.3.3.3.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.3.3.3.1.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.3.3.3.2.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.2">𝑇</ci><ci id="S2.Ex2.m1.6.6.1.1.3.3.3.3.cmml" xref="S2.Ex2.m1.6.6.1.1.3.3.3.3">𝑗</ci></apply><apply id="S2.Ex2.m1.6.6.1.1.4.4.4.1.cmml" xref="S2.Ex2.m1.6.6.1.1.4.4.4.2"><csymbol cd="latexml" id="S2.Ex2.m1.6.6.1.1.4.4.4.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.4.4.4.2.1">delimited-[]</csymbol><ci id="S2.Ex2.m1.2.2a.cmml" xref="S2.Ex2.m1.2.2"><mtext id="S2.Ex2.m1.2.2.cmml" mathsize="90%" xref="S2.Ex2.m1.2.2">SEQ</mtext></ci></apply><ci id="S2.Ex2.m1.5.5.cmml" xref="S2.Ex2.m1.5.5">⋯</ci><apply id="S2.Ex2.m1.6.6.1.1.5.5.5.cmml" xref="S2.Ex2.m1.6.6.1.1.5.5.5"><csymbol cd="ambiguous" id="S2.Ex2.m1.6.6.1.1.5.5.5.1.cmml" xref="S2.Ex2.m1.6.6.1.1.5.5.5">subscript</csymbol><ci id="S2.Ex2.m1.6.6.1.1.5.5.5.2.cmml" xref="S2.Ex2.m1.6.6.1.1.5.5.5.2">𝑇</ci><ci id="S2.Ex2.m1.6.6.1.1.5.5.5.3.cmml" xref="S2.Ex2.m1.6.6.1.1.5.5.5.3">𝑛</ci></apply><apply id="S2.Ex2.m1.6.6.1.1.6.6.6.1.cmml" xref="S2.Ex2.m1.6.6.1.1.6.6.6.2"><csymbol cd="latexml" id="S2.Ex2.m1.6.6.1.1.6.6.6.1.1.cmml" xref="S2.Ex2.m1.6.6.1.1.6.6.6.2.1">delimited-[]</csymbol><ci id="S2.Ex2.m1.3.3a.cmml" xref="S2.Ex2.m1.3.3"><mtext id="S2.Ex2.m1.3.3.cmml" mathsize="90%" xref="S2.Ex2.m1.3.3">SEQ</mtext></ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.6c">\small X_{u}=\left\{T_{1},\left[\text{SEQ}\right],\dots,T_{j},\left[\text{SEQ}%
\right],\cdots,T_{n},\left[\text{SEQ}\right]\right\},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.6d">italic_X start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , [ SEQ ] , … , italic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , [ SEQ ] , ⋯ , italic_T start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , [ SEQ ] } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS3.p1.7">where <math alttext="n" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.6.m1.1"><semantics id="S2.SS2.SSS3.p1.6.m1.1a"><mi id="S2.SS2.SSS3.p1.6.m1.1.1" xref="S2.SS2.SSS3.p1.6.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.6.m1.1b"><ci id="S2.SS2.SSS3.p1.6.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.6.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.6.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.6.m1.1d">italic_n</annotation></semantics></math> is the number of items in <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p1.7.m2.1"><semantics id="S2.SS2.SSS3.p1.7.m2.1a"><mi id="S2.SS2.SSS3.p1.7.m2.1.1" xref="S2.SS2.SSS3.p1.7.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.7.m2.1b"><ci id="S2.SS2.SSS3.p1.7.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.7.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.7.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p1.7.m2.1d">italic_u</annotation></semantics></math>’s historical interaction sequence.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS3.p2">
<p class="ltx_p" id="S2.SS2.SSS3.p2.4">As depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.F2" title="Figure 2 ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(b), <math alttext="X_{u}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p2.1.m1.1"><semantics id="S2.SS2.SSS3.p2.1.m1.1a"><msub id="S2.SS2.SSS3.p2.1.m1.1.1" xref="S2.SS2.SSS3.p2.1.m1.1.1.cmml"><mi id="S2.SS2.SSS3.p2.1.m1.1.1.2" xref="S2.SS2.SSS3.p2.1.m1.1.1.2.cmml">X</mi><mi id="S2.SS2.SSS3.p2.1.m1.1.1.3" xref="S2.SS2.SSS3.p2.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.1.m1.1b"><apply id="S2.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS3.p2.1.m1.1.1.2.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.2">𝑋</ci><ci id="S2.SS2.SSS3.p2.1.m1.1.1.3.cmml" xref="S2.SS2.SSS3.p2.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.1.m1.1c">X_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p2.1.m1.1d">italic_X start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is then fed into LLM and <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS3.p2.2.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p2.2.1.m1.1"><semantics id="S2.SS2.SSS3.p2.2.1.m1.1a"><msub id="S2.SS2.SSS3.p2.2.1.m1.1.1" xref="S2.SS2.SSS3.p2.2.1.m1.1.1.cmml"><mi id="S2.SS2.SSS3.p2.2.1.m1.1.1a" xref="S2.SS2.SSS3.p2.2.1.m1.1.1.cmml"></mi><mtext id="S2.SS2.SSS3.p2.2.1.m1.1.1.1" xref="S2.SS2.SSS3.p2.2.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.2.1.m1.1b"><apply id="S2.SS2.SSS3.p2.2.1.m1.1.1.cmml" xref="S2.SS2.SSS3.p2.2.1.m1.1.1"><ci id="S2.SS2.SSS3.p2.2.1.m1.1.1.1a.cmml" xref="S2.SS2.SSS3.p2.2.1.m1.1.1.1"><mtext id="S2.SS2.SSS3.p2.2.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS2.SSS3.p2.2.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.2.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p2.2.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> uses the item projection layer to map the hidden state <math alttext="\mathbf{h}^{\text{SEQ}}_{u,i}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p2.3.m2.2"><semantics id="S2.SS2.SSS3.p2.3.m2.2a"><msubsup id="S2.SS2.SSS3.p2.3.m2.2.3" xref="S2.SS2.SSS3.p2.3.m2.2.3.cmml"><mi id="S2.SS2.SSS3.p2.3.m2.2.3.2.2" xref="S2.SS2.SSS3.p2.3.m2.2.3.2.2.cmml">𝐡</mi><mrow id="S2.SS2.SSS3.p2.3.m2.2.2.2.4" xref="S2.SS2.SSS3.p2.3.m2.2.2.2.3.cmml"><mi id="S2.SS2.SSS3.p2.3.m2.1.1.1.1" xref="S2.SS2.SSS3.p2.3.m2.1.1.1.1.cmml">u</mi><mo id="S2.SS2.SSS3.p2.3.m2.2.2.2.4.1" xref="S2.SS2.SSS3.p2.3.m2.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS3.p2.3.m2.2.2.2.2" xref="S2.SS2.SSS3.p2.3.m2.2.2.2.2.cmml">i</mi></mrow><mtext id="S2.SS2.SSS3.p2.3.m2.2.3.2.3" xref="S2.SS2.SSS3.p2.3.m2.2.3.2.3a.cmml">SEQ</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.3.m2.2b"><apply id="S2.SS2.SSS3.p2.3.m2.2.3.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p2.3.m2.2.3.1.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.3">subscript</csymbol><apply id="S2.SS2.SSS3.p2.3.m2.2.3.2.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p2.3.m2.2.3.2.1.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.3">superscript</csymbol><ci id="S2.SS2.SSS3.p2.3.m2.2.3.2.2.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.3.2.2">𝐡</ci><ci id="S2.SS2.SSS3.p2.3.m2.2.3.2.3a.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.3.2.3"><mtext id="S2.SS2.SSS3.p2.3.m2.2.3.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS3.p2.3.m2.2.3.2.3">SEQ</mtext></ci></apply><list id="S2.SS2.SSS3.p2.3.m2.2.2.2.3.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.2.2.4"><ci id="S2.SS2.SSS3.p2.3.m2.1.1.1.1.cmml" xref="S2.SS2.SSS3.p2.3.m2.1.1.1.1">𝑢</ci><ci id="S2.SS2.SSS3.p2.3.m2.2.2.2.2.cmml" xref="S2.SS2.SSS3.p2.3.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.3.m2.2c">\mathbf{h}^{\text{SEQ}}_{u,i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p2.3.m2.2d">bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from the last LLM layer that corresponds to the current item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p2.4.m3.1"><semantics id="S2.SS2.SSS3.p2.4.m3.1a"><mi id="S2.SS2.SSS3.p2.4.m3.1.1" xref="S2.SS2.SSS3.p2.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.4.m3.1b"><ci id="S2.SS2.SSS3.p2.4.m3.1.1.cmml" xref="S2.SS2.SSS3.p2.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.4.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p2.4.m3.1d">italic_i</annotation></semantics></math> to the next item ID.
We use cross-entropy loss between predictions and actual next-item IDs during optimization:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\hat{\mathbf{z}}_{u,i+1}=\text{Softmax}(\textbf{W}_{\text{item}}\cdot%
\mathbf{h}^{\text{SEQ}}_{u,i}+\textbf{b}_{\text{item}}),\,\,\mathcal{L}_{\text%
{seq}}=-\sum_{u}\sum_{j=2}^{n}z_{u,j}\log\hat{\mathbf{z}}_{u,j}" class="ltx_Math" display="block" id="S2.Ex3.m1.10"><semantics id="S2.Ex3.m1.10a"><mrow id="S2.Ex3.m1.10.10.2" xref="S2.Ex3.m1.10.10.3.cmml"><mrow id="S2.Ex3.m1.9.9.1.1" xref="S2.Ex3.m1.9.9.1.1.cmml"><msub id="S2.Ex3.m1.9.9.1.1.3" xref="S2.Ex3.m1.9.9.1.1.3.cmml"><mover accent="true" id="S2.Ex3.m1.9.9.1.1.3.2" xref="S2.Ex3.m1.9.9.1.1.3.2.cmml"><mi id="S2.Ex3.m1.9.9.1.1.3.2.2" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.3.2.2.cmml">𝐳</mi><mo id="S2.Ex3.m1.9.9.1.1.3.2.1" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.3.2.1.cmml">^</mo></mover><mrow id="S2.Ex3.m1.2.2.2.2" xref="S2.Ex3.m1.2.2.2.3.cmml"><mi id="S2.Ex3.m1.1.1.1.1" mathsize="90%" xref="S2.Ex3.m1.1.1.1.1.cmml">u</mi><mo id="S2.Ex3.m1.2.2.2.2.2" mathsize="90%" xref="S2.Ex3.m1.2.2.2.3.cmml">,</mo><mrow id="S2.Ex3.m1.2.2.2.2.1" xref="S2.Ex3.m1.2.2.2.2.1.cmml"><mi id="S2.Ex3.m1.2.2.2.2.1.2" mathsize="90%" xref="S2.Ex3.m1.2.2.2.2.1.2.cmml">i</mi><mo id="S2.Ex3.m1.2.2.2.2.1.1" mathsize="90%" xref="S2.Ex3.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S2.Ex3.m1.2.2.2.2.1.3" mathsize="90%" xref="S2.Ex3.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.Ex3.m1.9.9.1.1.2" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.2.cmml">=</mo><mrow id="S2.Ex3.m1.9.9.1.1.1" xref="S2.Ex3.m1.9.9.1.1.1.cmml"><mtext id="S2.Ex3.m1.9.9.1.1.1.3" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.3a.cmml">Softmax</mtext><mo id="S2.Ex3.m1.9.9.1.1.1.2" xref="S2.Ex3.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex3.m1.9.9.1.1.1.1.1" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S2.Ex3.m1.9.9.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.9.9.1.1.1.1.1.1" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.cmml"><msub id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.2a.cmml">W</mtext><mtext id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.3a.cmml">item</mtext></msub><mo id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.1.cmml">⋅</mo><msubsup id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.2" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.2.cmml">𝐡</mi><mrow id="S2.Ex3.m1.4.4.2.4" xref="S2.Ex3.m1.4.4.2.3.cmml"><mi id="S2.Ex3.m1.3.3.1.1" mathsize="90%" xref="S2.Ex3.m1.3.3.1.1.cmml">u</mi><mo id="S2.Ex3.m1.4.4.2.4.1" mathsize="90%" xref="S2.Ex3.m1.4.4.2.3.cmml">,</mo><mi id="S2.Ex3.m1.4.4.2.2" mathsize="90%" xref="S2.Ex3.m1.4.4.2.2.cmml">i</mi></mrow><mtext id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.3" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.3a.cmml">SEQ</mtext></msubsup></mrow><mo id="S2.Ex3.m1.9.9.1.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.2" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.2a.cmml">b</mtext><mtext id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.3a.cmml">item</mtext></msub></mrow><mo id="S2.Ex3.m1.9.9.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex3.m1.10.10.2.3" mathsize="90%" rspace="0.497em" xref="S2.Ex3.m1.10.10.3a.cmml">,</mo><mrow id="S2.Ex3.m1.10.10.2.2" xref="S2.Ex3.m1.10.10.2.2.cmml"><msub id="S2.Ex3.m1.10.10.2.2.2" xref="S2.Ex3.m1.10.10.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex3.m1.10.10.2.2.2.2" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.2.2.cmml">ℒ</mi><mtext id="S2.Ex3.m1.10.10.2.2.2.3" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.2.3a.cmml">seq</mtext></msub><mo id="S2.Ex3.m1.10.10.2.2.1" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.1.cmml">=</mo><mrow id="S2.Ex3.m1.10.10.2.2.3" xref="S2.Ex3.m1.10.10.2.2.3.cmml"><mo id="S2.Ex3.m1.10.10.2.2.3a" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.cmml">−</mo><mrow id="S2.Ex3.m1.10.10.2.2.3.2" xref="S2.Ex3.m1.10.10.2.2.3.2.cmml"><munder id="S2.Ex3.m1.10.10.2.2.3.2.1" xref="S2.Ex3.m1.10.10.2.2.3.2.1.cmml"><mo id="S2.Ex3.m1.10.10.2.2.3.2.1.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" xref="S2.Ex3.m1.10.10.2.2.3.2.1.2.cmml">∑</mo><mi id="S2.Ex3.m1.10.10.2.2.3.2.1.3" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.1.3.cmml">u</mi></munder><mrow id="S2.Ex3.m1.10.10.2.2.3.2.2" xref="S2.Ex3.m1.10.10.2.2.3.2.2.cmml"><munderover id="S2.Ex3.m1.10.10.2.2.3.2.2.1" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.cmml"><mo id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.2.cmml">∑</mo><mrow id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.cmml"><mi id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.2" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.2.cmml">j</mi><mo id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.1" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.1.cmml">=</mo><mn id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.3" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.3.cmml">2</mn></mrow><mi id="S2.Ex3.m1.10.10.2.2.3.2.2.1.3" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.3.cmml">n</mi></munderover><mrow id="S2.Ex3.m1.10.10.2.2.3.2.2.2" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.cmml"><msub id="S2.Ex3.m1.10.10.2.2.3.2.2.2.2" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.2.cmml"><mi id="S2.Ex3.m1.10.10.2.2.3.2.2.2.2.2" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.2.2.cmml">z</mi><mrow id="S2.Ex3.m1.6.6.2.4" xref="S2.Ex3.m1.6.6.2.3.cmml"><mi id="S2.Ex3.m1.5.5.1.1" mathsize="90%" xref="S2.Ex3.m1.5.5.1.1.cmml">u</mi><mo id="S2.Ex3.m1.6.6.2.4.1" mathsize="90%" xref="S2.Ex3.m1.6.6.2.3.cmml">,</mo><mi id="S2.Ex3.m1.6.6.2.2" mathsize="90%" xref="S2.Ex3.m1.6.6.2.2.cmml">j</mi></mrow></msub><mo id="S2.Ex3.m1.10.10.2.2.3.2.2.2.1" lspace="0.167em" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.1.cmml">⁢</mo><mrow id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.cmml"><mi id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.1" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.1.cmml">log</mi><mo id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3a" lspace="0.167em" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.cmml">⁡</mo><msub id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.cmml"><mover accent="true" id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.cmml"><mi id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.2" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.2.cmml">𝐳</mi><mo id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.1" mathsize="90%" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.1.cmml">^</mo></mover><mrow id="S2.Ex3.m1.8.8.2.4" xref="S2.Ex3.m1.8.8.2.3.cmml"><mi id="S2.Ex3.m1.7.7.1.1" mathsize="90%" xref="S2.Ex3.m1.7.7.1.1.cmml">u</mi><mo id="S2.Ex3.m1.8.8.2.4.1" mathsize="90%" xref="S2.Ex3.m1.8.8.2.3.cmml">,</mo><mi id="S2.Ex3.m1.8.8.2.2" mathsize="90%" xref="S2.Ex3.m1.8.8.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.10b"><apply id="S2.Ex3.m1.10.10.3.cmml" xref="S2.Ex3.m1.10.10.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.3a.cmml" xref="S2.Ex3.m1.10.10.2.3">formulae-sequence</csymbol><apply id="S2.Ex3.m1.9.9.1.1.cmml" xref="S2.Ex3.m1.9.9.1.1"><eq id="S2.Ex3.m1.9.9.1.1.2.cmml" xref="S2.Ex3.m1.9.9.1.1.2"></eq><apply id="S2.Ex3.m1.9.9.1.1.3.cmml" xref="S2.Ex3.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.9.9.1.1.3.1.cmml" xref="S2.Ex3.m1.9.9.1.1.3">subscript</csymbol><apply id="S2.Ex3.m1.9.9.1.1.3.2.cmml" xref="S2.Ex3.m1.9.9.1.1.3.2"><ci id="S2.Ex3.m1.9.9.1.1.3.2.1.cmml" xref="S2.Ex3.m1.9.9.1.1.3.2.1">^</ci><ci id="S2.Ex3.m1.9.9.1.1.3.2.2.cmml" xref="S2.Ex3.m1.9.9.1.1.3.2.2">𝐳</ci></apply><list id="S2.Ex3.m1.2.2.2.3.cmml" xref="S2.Ex3.m1.2.2.2.2"><ci id="S2.Ex3.m1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1">𝑢</ci><apply id="S2.Ex3.m1.2.2.2.2.1.cmml" xref="S2.Ex3.m1.2.2.2.2.1"><plus id="S2.Ex3.m1.2.2.2.2.1.1.cmml" xref="S2.Ex3.m1.2.2.2.2.1.1"></plus><ci id="S2.Ex3.m1.2.2.2.2.1.2.cmml" xref="S2.Ex3.m1.2.2.2.2.1.2">𝑖</ci><cn id="S2.Ex3.m1.2.2.2.2.1.3.cmml" type="integer" xref="S2.Ex3.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S2.Ex3.m1.9.9.1.1.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1"><times id="S2.Ex3.m1.9.9.1.1.1.2.cmml" xref="S2.Ex3.m1.9.9.1.1.1.2"></times><ci id="S2.Ex3.m1.9.9.1.1.1.3a.cmml" xref="S2.Ex3.m1.9.9.1.1.1.3"><mtext id="S2.Ex3.m1.9.9.1.1.1.3.cmml" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.3">Softmax</mtext></ci><apply id="S2.Ex3.m1.9.9.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1"><plus id="S2.Ex3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.1"></plus><apply id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2"><ci id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.1">⋅</ci><apply id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.2a.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.2.cmml" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.2">W</mtext></ci><ci id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.3a.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.3"><mtext id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.3.cmml" mathsize="63%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.2.3">item</mtext></ci></apply><apply id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.2">𝐡</ci><ci id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.3a.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.3"><mtext id="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.3.cmml" mathsize="63%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.2.3.2.3">SEQ</mtext></ci></apply><list id="S2.Ex3.m1.4.4.2.3.cmml" xref="S2.Ex3.m1.4.4.2.4"><ci id="S2.Ex3.m1.3.3.1.1.cmml" xref="S2.Ex3.m1.3.3.1.1">𝑢</ci><ci id="S2.Ex3.m1.4.4.2.2.cmml" xref="S2.Ex3.m1.4.4.2.2">𝑖</ci></list></apply></apply><apply id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.2a.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.2.cmml" mathsize="90%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.2">b</mtext></ci><ci id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.3a.cmml" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.3"><mtext id="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.3.cmml" mathsize="63%" xref="S2.Ex3.m1.9.9.1.1.1.1.1.1.3.3">item</mtext></ci></apply></apply></apply></apply><apply id="S2.Ex3.m1.10.10.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2"><eq id="S2.Ex3.m1.10.10.2.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.1"></eq><apply id="S2.Ex3.m1.10.10.2.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.2.2.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.10.10.2.2.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.2.2">ℒ</ci><ci id="S2.Ex3.m1.10.10.2.2.2.3a.cmml" xref="S2.Ex3.m1.10.10.2.2.2.3"><mtext id="S2.Ex3.m1.10.10.2.2.2.3.cmml" mathsize="63%" xref="S2.Ex3.m1.10.10.2.2.2.3">seq</mtext></ci></apply><apply id="S2.Ex3.m1.10.10.2.2.3.cmml" xref="S2.Ex3.m1.10.10.2.2.3"><minus id="S2.Ex3.m1.10.10.2.2.3.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3"></minus><apply id="S2.Ex3.m1.10.10.2.2.3.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2"><apply id="S2.Ex3.m1.10.10.2.2.3.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.2.2.3.2.1.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.1">subscript</csymbol><sum id="S2.Ex3.m1.10.10.2.2.3.2.1.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.1.2"></sum><ci id="S2.Ex3.m1.10.10.2.2.3.2.1.3.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.1.3">𝑢</ci></apply><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2"><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.2.2.3.2.2.1.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1">superscript</csymbol><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1">subscript</csymbol><sum id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.2"></sum><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3"><eq id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.1"></eq><ci id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.2">𝑗</ci><cn id="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.3.cmml" type="integer" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.2.3.3">2</cn></apply></apply><ci id="S2.Ex3.m1.10.10.2.2.3.2.2.1.3.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.1.3">𝑛</ci></apply><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2"><times id="S2.Ex3.m1.10.10.2.2.3.2.2.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.1"></times><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.2.2.3.2.2.2.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.10.10.2.2.3.2.2.2.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.2.2">𝑧</ci><list id="S2.Ex3.m1.6.6.2.3.cmml" xref="S2.Ex3.m1.6.6.2.4"><ci id="S2.Ex3.m1.5.5.1.1.cmml" xref="S2.Ex3.m1.5.5.1.1">𝑢</ci><ci id="S2.Ex3.m1.6.6.2.2.cmml" xref="S2.Ex3.m1.6.6.2.2">𝑗</ci></list></apply><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3"><log id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.1"></log><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2">subscript</csymbol><apply id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2"><ci id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.1.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.1">^</ci><ci id="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.2.cmml" xref="S2.Ex3.m1.10.10.2.2.3.2.2.2.3.2.2.2">𝐳</ci></apply><list id="S2.Ex3.m1.8.8.2.3.cmml" xref="S2.Ex3.m1.8.8.2.4"><ci id="S2.Ex3.m1.7.7.1.1.cmml" xref="S2.Ex3.m1.7.7.1.1">𝑢</ci><ci id="S2.Ex3.m1.8.8.2.2.cmml" xref="S2.Ex3.m1.8.8.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.10c">\small\hat{\mathbf{z}}_{u,i+1}=\text{Softmax}(\textbf{W}_{\text{item}}\cdot%
\mathbf{h}^{\text{SEQ}}_{u,i}+\textbf{b}_{\text{item}}),\,\,\mathcal{L}_{\text%
{seq}}=-\sum_{u}\sum_{j=2}^{n}z_{u,j}\log\hat{\mathbf{z}}_{u,j}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.10d">over^ start_ARG bold_z end_ARG start_POSTSUBSCRIPT italic_u , italic_i + 1 end_POSTSUBSCRIPT = Softmax ( W start_POSTSUBSCRIPT item end_POSTSUBSCRIPT ⋅ bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_i end_POSTSUBSCRIPT + b start_POSTSUBSCRIPT item end_POSTSUBSCRIPT ) , caligraphic_L start_POSTSUBSCRIPT seq end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT roman_log over^ start_ARG bold_z end_ARG start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS3.p2.7">where <math alttext="z_{u,j}" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p2.5.m1.2"><semantics id="S2.SS2.SSS3.p2.5.m1.2a"><msub id="S2.SS2.SSS3.p2.5.m1.2.3" xref="S2.SS2.SSS3.p2.5.m1.2.3.cmml"><mi id="S2.SS2.SSS3.p2.5.m1.2.3.2" xref="S2.SS2.SSS3.p2.5.m1.2.3.2.cmml">z</mi><mrow id="S2.SS2.SSS3.p2.5.m1.2.2.2.4" xref="S2.SS2.SSS3.p2.5.m1.2.2.2.3.cmml"><mi id="S2.SS2.SSS3.p2.5.m1.1.1.1.1" xref="S2.SS2.SSS3.p2.5.m1.1.1.1.1.cmml">u</mi><mo id="S2.SS2.SSS3.p2.5.m1.2.2.2.4.1" xref="S2.SS2.SSS3.p2.5.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS3.p2.5.m1.2.2.2.2" xref="S2.SS2.SSS3.p2.5.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.5.m1.2b"><apply id="S2.SS2.SSS3.p2.5.m1.2.3.cmml" xref="S2.SS2.SSS3.p2.5.m1.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p2.5.m1.2.3.1.cmml" xref="S2.SS2.SSS3.p2.5.m1.2.3">subscript</csymbol><ci id="S2.SS2.SSS3.p2.5.m1.2.3.2.cmml" xref="S2.SS2.SSS3.p2.5.m1.2.3.2">𝑧</ci><list id="S2.SS2.SSS3.p2.5.m1.2.2.2.3.cmml" xref="S2.SS2.SSS3.p2.5.m1.2.2.2.4"><ci id="S2.SS2.SSS3.p2.5.m1.1.1.1.1.cmml" xref="S2.SS2.SSS3.p2.5.m1.1.1.1.1">𝑢</ci><ci id="S2.SS2.SSS3.p2.5.m1.2.2.2.2.cmml" xref="S2.SS2.SSS3.p2.5.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.5.m1.2c">z_{u,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p2.5.m1.2d">italic_z start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the actual ID of the <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p2.6.m2.1"><semantics id="S2.SS2.SSS3.p2.6.m2.1a"><mi id="S2.SS2.SSS3.p2.6.m2.1.1" xref="S2.SS2.SSS3.p2.6.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.6.m2.1b"><ci id="S2.SS2.SSS3.p2.6.m2.1.1.cmml" xref="S2.SS2.SSS3.p2.6.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.6.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p2.6.m2.1d">italic_j</annotation></semantics></math>-th item in <math alttext="u" class="ltx_Math" display="inline" id="S2.SS2.SSS3.p2.7.m3.1"><semantics id="S2.SS2.SSS3.p2.7.m3.1a"><mi id="S2.SS2.SSS3.p2.7.m3.1.1" xref="S2.SS2.SSS3.p2.7.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p2.7.m3.1b"><ci id="S2.SS2.SSS3.p2.7.m3.1.1.cmml" xref="S2.SS2.SSS3.p2.7.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p2.7.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS3.p2.7.m3.1d">italic_u</annotation></semantics></math>’s historical interaction sequence.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.4. </span>Distinguish Hard Samples</h4>
<div class="ltx_para" id="S2.SS2.SSS4.p1">
<p class="ltx_p" id="S2.SS2.SSS4.p1.6">LLM is trained over vast amounts of text data but it does not see much sequential recommendation data.
Hence, LLM faces difficulty in distinguishing items in the sequential recommendation task.
As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.F2" title="Figure 2 ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(c), we adopt contrastive learning to enhance the ability of <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS4.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.1.1.m1.1"><semantics id="S2.SS2.SSS4.p1.1.1.m1.1a"><msub id="S2.SS2.SSS4.p1.1.1.m1.1.1" xref="S2.SS2.SSS4.p1.1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS4.p1.1.1.m1.1.1a" xref="S2.SS2.SSS4.p1.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS2.SSS4.p1.1.1.m1.1.1.1" xref="S2.SS2.SSS4.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.1.1.m1.1b"><apply id="S2.SS2.SSS4.p1.1.1.m1.1.1.cmml" xref="S2.SS2.SSS4.p1.1.1.m1.1.1"><ci id="S2.SS2.SSS4.p1.1.1.m1.1.1.1a.cmml" xref="S2.SS2.SSS4.p1.1.1.m1.1.1.1"><mtext id="S2.SS2.SSS4.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS2.SSS4.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> to distinguish different items without requiring additional data.
Particularly, we focus on improving distinguishing <em class="ltx_emph ltx_font_italic" id="S2.SS2.SSS4.p1.6.2">hard samples</em>.
For an item <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.2.m1.1"><semantics id="S2.SS2.SSS4.p1.2.m1.1a"><mi id="S2.SS2.SSS4.p1.2.m1.1.1" xref="S2.SS2.SSS4.p1.2.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.2.m1.1b"><ci id="S2.SS2.SSS4.p1.2.m1.1.1.cmml" xref="S2.SS2.SSS4.p1.2.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.2.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.2.m1.1d">italic_j</annotation></semantics></math>, hard samples <math alttext="N_{j}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.3.m2.1"><semantics id="S2.SS2.SSS4.p1.3.m2.1a"><msub id="S2.SS2.SSS4.p1.3.m2.1.1" xref="S2.SS2.SSS4.p1.3.m2.1.1.cmml"><mi id="S2.SS2.SSS4.p1.3.m2.1.1.2" xref="S2.SS2.SSS4.p1.3.m2.1.1.2.cmml">N</mi><mi id="S2.SS2.SSS4.p1.3.m2.1.1.3" xref="S2.SS2.SSS4.p1.3.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.3.m2.1b"><apply id="S2.SS2.SSS4.p1.3.m2.1.1.cmml" xref="S2.SS2.SSS4.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p1.3.m2.1.1.1.cmml" xref="S2.SS2.SSS4.p1.3.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p1.3.m2.1.1.2.cmml" xref="S2.SS2.SSS4.p1.3.m2.1.1.2">𝑁</ci><ci id="S2.SS2.SSS4.p1.3.m2.1.1.3.cmml" xref="S2.SS2.SSS4.p1.3.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.3.m2.1c">N_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.3.m2.1d">italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are items similar to <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.4.m3.1"><semantics id="S2.SS2.SSS4.p1.4.m3.1a"><mi id="S2.SS2.SSS4.p1.4.m3.1.1" xref="S2.SS2.SSS4.p1.4.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.4.m3.1b"><ci id="S2.SS2.SSS4.p1.4.m3.1.1.cmml" xref="S2.SS2.SSS4.p1.4.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.4.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.4.m3.1d">italic_j</annotation></semantics></math>, but they do not co-occur with <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.5.m4.1"><semantics id="S2.SS2.SSS4.p1.5.m4.1a"><mi id="S2.SS2.SSS4.p1.5.m4.1.1" xref="S2.SS2.SSS4.p1.5.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.5.m4.1b"><ci id="S2.SS2.SSS4.p1.5.m4.1.1.cmml" xref="S2.SS2.SSS4.p1.5.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.5.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.5.m4.1d">italic_j</annotation></semantics></math> in any user historical interaction sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p1.6.m5.1"><semantics id="S2.SS2.SSS4.p1.6.m5.1a"><mi id="S2.SS2.SSS4.p1.6.m5.1.1" xref="S2.SS2.SSS4.p1.6.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.6.m5.1b"><ci id="S2.SS2.SSS4.p1.6.m5.1.1.cmml" xref="S2.SS2.SSS4.p1.6.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.6.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p1.6.m5.1d">italic_S</annotation></semantics></math>.
The details of generating hard samples are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A1" title="Appendix A Generate Hard Samples ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS4.p2">
<p class="ltx_p" id="S2.SS2.SSS4.p2.24">We randomly sample <math alttext="n_{s}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.1.m1.1"><semantics id="S2.SS2.SSS4.p2.1.m1.1a"><msub id="S2.SS2.SSS4.p2.1.m1.1.1" xref="S2.SS2.SSS4.p2.1.m1.1.1.cmml"><mi id="S2.SS2.SSS4.p2.1.m1.1.1.2" xref="S2.SS2.SSS4.p2.1.m1.1.1.2.cmml">n</mi><mi id="S2.SS2.SSS4.p2.1.m1.1.1.3" xref="S2.SS2.SSS4.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.1.m1.1b"><apply id="S2.SS2.SSS4.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS4.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p2.1.m1.1.1.2.cmml" xref="S2.SS2.SSS4.p2.1.m1.1.1.2">𝑛</ci><ci id="S2.SS2.SSS4.p2.1.m1.1.1.3.cmml" xref="S2.SS2.SSS4.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.1.m1.1c">n_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> items from each <math alttext="S" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.2.m2.1"><semantics id="S2.SS2.SSS4.p2.2.m2.1a"><mi id="S2.SS2.SSS4.p2.2.m2.1.1" xref="S2.SS2.SSS4.p2.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.2.m2.1b"><ci id="S2.SS2.SSS4.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS4.p2.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.2.m2.1d">italic_S</annotation></semantics></math>, excluding the item in the last position.
For a sampled item <math alttext="j\in S_{u}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.3.m3.1"><semantics id="S2.SS2.SSS4.p2.3.m3.1a"><mrow id="S2.SS2.SSS4.p2.3.m3.1.1" xref="S2.SS2.SSS4.p2.3.m3.1.1.cmml"><mi id="S2.SS2.SSS4.p2.3.m3.1.1.2" xref="S2.SS2.SSS4.p2.3.m3.1.1.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.3.m3.1.1.1" xref="S2.SS2.SSS4.p2.3.m3.1.1.1.cmml">∈</mo><msub id="S2.SS2.SSS4.p2.3.m3.1.1.3" xref="S2.SS2.SSS4.p2.3.m3.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.3.m3.1.1.3.2" xref="S2.SS2.SSS4.p2.3.m3.1.1.3.2.cmml">S</mi><mi id="S2.SS2.SSS4.p2.3.m3.1.1.3.3" xref="S2.SS2.SSS4.p2.3.m3.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.3.m3.1b"><apply id="S2.SS2.SSS4.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS4.p2.3.m3.1.1"><in id="S2.SS2.SSS4.p2.3.m3.1.1.1.cmml" xref="S2.SS2.SSS4.p2.3.m3.1.1.1"></in><ci id="S2.SS2.SSS4.p2.3.m3.1.1.2.cmml" xref="S2.SS2.SSS4.p2.3.m3.1.1.2">𝑗</ci><apply id="S2.SS2.SSS4.p2.3.m3.1.1.3.cmml" xref="S2.SS2.SSS4.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.3.m3.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS4.p2.3.m3.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.3.m3.1.1.3.2">𝑆</ci><ci id="S2.SS2.SSS4.p2.3.m3.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.3.m3.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.3.m3.1c">j\in S_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.3.m3.1d">italic_j ∈ italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS4.p2.4.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.4.1.m1.1"><semantics id="S2.SS2.SSS4.p2.4.1.m1.1a"><msub id="S2.SS2.SSS4.p2.4.1.m1.1.1" xref="S2.SS2.SSS4.p2.4.1.m1.1.1.cmml"><mi id="S2.SS2.SSS4.p2.4.1.m1.1.1a" xref="S2.SS2.SSS4.p2.4.1.m1.1.1.cmml"></mi><mtext id="S2.SS2.SSS4.p2.4.1.m1.1.1.1" xref="S2.SS2.SSS4.p2.4.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.4.1.m1.1b"><apply id="S2.SS2.SSS4.p2.4.1.m1.1.1.cmml" xref="S2.SS2.SSS4.p2.4.1.m1.1.1"><ci id="S2.SS2.SSS4.p2.4.1.m1.1.1.1a.cmml" xref="S2.SS2.SSS4.p2.4.1.m1.1.1.1"><mtext id="S2.SS2.SSS4.p2.4.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.4.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.4.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.4.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> treats its subsequent item <math alttext="j^{+}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.5.m4.1"><semantics id="S2.SS2.SSS4.p2.5.m4.1a"><msup id="S2.SS2.SSS4.p2.5.m4.1.1" xref="S2.SS2.SSS4.p2.5.m4.1.1.cmml"><mi id="S2.SS2.SSS4.p2.5.m4.1.1.2" xref="S2.SS2.SSS4.p2.5.m4.1.1.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.5.m4.1.1.3" xref="S2.SS2.SSS4.p2.5.m4.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.5.m4.1b"><apply id="S2.SS2.SSS4.p2.5.m4.1.1.cmml" xref="S2.SS2.SSS4.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.5.m4.1.1.1.cmml" xref="S2.SS2.SSS4.p2.5.m4.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.5.m4.1.1.2.cmml" xref="S2.SS2.SSS4.p2.5.m4.1.1.2">𝑗</ci><plus id="S2.SS2.SSS4.p2.5.m4.1.1.3.cmml" xref="S2.SS2.SSS4.p2.5.m4.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.5.m4.1c">j^{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.5.m4.1d">italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> in <math alttext="S_{u}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.6.m5.1"><semantics id="S2.SS2.SSS4.p2.6.m5.1a"><msub id="S2.SS2.SSS4.p2.6.m5.1.1" xref="S2.SS2.SSS4.p2.6.m5.1.1.cmml"><mi id="S2.SS2.SSS4.p2.6.m5.1.1.2" xref="S2.SS2.SSS4.p2.6.m5.1.1.2.cmml">S</mi><mi id="S2.SS2.SSS4.p2.6.m5.1.1.3" xref="S2.SS2.SSS4.p2.6.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.6.m5.1b"><apply id="S2.SS2.SSS4.p2.6.m5.1.1.cmml" xref="S2.SS2.SSS4.p2.6.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.6.m5.1.1.1.cmml" xref="S2.SS2.SSS4.p2.6.m5.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p2.6.m5.1.1.2.cmml" xref="S2.SS2.SSS4.p2.6.m5.1.1.2">𝑆</ci><ci id="S2.SS2.SSS4.p2.6.m5.1.1.3.cmml" xref="S2.SS2.SSS4.p2.6.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.6.m5.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.6.m5.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> as the positive item and randomly chooses <math alttext="n_{cl}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.7.m6.1"><semantics id="S2.SS2.SSS4.p2.7.m6.1a"><msub id="S2.SS2.SSS4.p2.7.m6.1.1" xref="S2.SS2.SSS4.p2.7.m6.1.1.cmml"><mi id="S2.SS2.SSS4.p2.7.m6.1.1.2" xref="S2.SS2.SSS4.p2.7.m6.1.1.2.cmml">n</mi><mrow id="S2.SS2.SSS4.p2.7.m6.1.1.3" xref="S2.SS2.SSS4.p2.7.m6.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.7.m6.1.1.3.2" xref="S2.SS2.SSS4.p2.7.m6.1.1.3.2.cmml">c</mi><mo id="S2.SS2.SSS4.p2.7.m6.1.1.3.1" xref="S2.SS2.SSS4.p2.7.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS4.p2.7.m6.1.1.3.3" xref="S2.SS2.SSS4.p2.7.m6.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.7.m6.1b"><apply id="S2.SS2.SSS4.p2.7.m6.1.1.cmml" xref="S2.SS2.SSS4.p2.7.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.7.m6.1.1.1.cmml" xref="S2.SS2.SSS4.p2.7.m6.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p2.7.m6.1.1.2.cmml" xref="S2.SS2.SSS4.p2.7.m6.1.1.2">𝑛</ci><apply id="S2.SS2.SSS4.p2.7.m6.1.1.3.cmml" xref="S2.SS2.SSS4.p2.7.m6.1.1.3"><times id="S2.SS2.SSS4.p2.7.m6.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.7.m6.1.1.3.1"></times><ci id="S2.SS2.SSS4.p2.7.m6.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.7.m6.1.1.3.2">𝑐</ci><ci id="S2.SS2.SSS4.p2.7.m6.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.7.m6.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.7.m6.1c">n_{cl}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.7.m6.1d">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT</annotation></semantics></math> items from <math alttext="N_{j^{+}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.8.m7.1"><semantics id="S2.SS2.SSS4.p2.8.m7.1a"><msub id="S2.SS2.SSS4.p2.8.m7.1.1" xref="S2.SS2.SSS4.p2.8.m7.1.1.cmml"><mi id="S2.SS2.SSS4.p2.8.m7.1.1.2" xref="S2.SS2.SSS4.p2.8.m7.1.1.2.cmml">N</mi><msup id="S2.SS2.SSS4.p2.8.m7.1.1.3" xref="S2.SS2.SSS4.p2.8.m7.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.8.m7.1.1.3.2" xref="S2.SS2.SSS4.p2.8.m7.1.1.3.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.8.m7.1.1.3.3" xref="S2.SS2.SSS4.p2.8.m7.1.1.3.3.cmml">+</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.8.m7.1b"><apply id="S2.SS2.SSS4.p2.8.m7.1.1.cmml" xref="S2.SS2.SSS4.p2.8.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.8.m7.1.1.1.cmml" xref="S2.SS2.SSS4.p2.8.m7.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p2.8.m7.1.1.2.cmml" xref="S2.SS2.SSS4.p2.8.m7.1.1.2">𝑁</ci><apply id="S2.SS2.SSS4.p2.8.m7.1.1.3.cmml" xref="S2.SS2.SSS4.p2.8.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.8.m7.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.8.m7.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.8.m7.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.8.m7.1.1.3.2">𝑗</ci><plus id="S2.SS2.SSS4.p2.8.m7.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.8.m7.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.8.m7.1c">N_{j^{+}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.8.m7.1d">italic_N start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> as the negative items <math alttext="j^{-}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.9.m8.1"><semantics id="S2.SS2.SSS4.p2.9.m8.1a"><msup id="S2.SS2.SSS4.p2.9.m8.1.1" xref="S2.SS2.SSS4.p2.9.m8.1.1.cmml"><mi id="S2.SS2.SSS4.p2.9.m8.1.1.2" xref="S2.SS2.SSS4.p2.9.m8.1.1.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.9.m8.1.1.3" xref="S2.SS2.SSS4.p2.9.m8.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.9.m8.1b"><apply id="S2.SS2.SSS4.p2.9.m8.1.1.cmml" xref="S2.SS2.SSS4.p2.9.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.9.m8.1.1.1.cmml" xref="S2.SS2.SSS4.p2.9.m8.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.9.m8.1.1.2.cmml" xref="S2.SS2.SSS4.p2.9.m8.1.1.2">𝑗</ci><minus id="S2.SS2.SSS4.p2.9.m8.1.1.3.cmml" xref="S2.SS2.SSS4.p2.9.m8.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.9.m8.1c">j^{-}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.9.m8.1d">italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> (all <math alttext="j^{-}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.10.m9.1"><semantics id="S2.SS2.SSS4.p2.10.m9.1a"><msup id="S2.SS2.SSS4.p2.10.m9.1.1" xref="S2.SS2.SSS4.p2.10.m9.1.1.cmml"><mi id="S2.SS2.SSS4.p2.10.m9.1.1.2" xref="S2.SS2.SSS4.p2.10.m9.1.1.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.10.m9.1.1.3" xref="S2.SS2.SSS4.p2.10.m9.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.10.m9.1b"><apply id="S2.SS2.SSS4.p2.10.m9.1.1.cmml" xref="S2.SS2.SSS4.p2.10.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.10.m9.1.1.1.cmml" xref="S2.SS2.SSS4.p2.10.m9.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.10.m9.1.1.2.cmml" xref="S2.SS2.SSS4.p2.10.m9.1.1.2">𝑗</ci><minus id="S2.SS2.SSS4.p2.10.m9.1.1.3.cmml" xref="S2.SS2.SSS4.p2.10.m9.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.10.m9.1c">j^{-}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.10.m9.1d">italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> forms the set <math alttext="J^{-}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.11.m10.1"><semantics id="S2.SS2.SSS4.p2.11.m10.1a"><msup id="S2.SS2.SSS4.p2.11.m10.1.1" xref="S2.SS2.SSS4.p2.11.m10.1.1.cmml"><mi id="S2.SS2.SSS4.p2.11.m10.1.1.2" xref="S2.SS2.SSS4.p2.11.m10.1.1.2.cmml">J</mi><mo id="S2.SS2.SSS4.p2.11.m10.1.1.3" xref="S2.SS2.SSS4.p2.11.m10.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.11.m10.1b"><apply id="S2.SS2.SSS4.p2.11.m10.1.1.cmml" xref="S2.SS2.SSS4.p2.11.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.11.m10.1.1.1.cmml" xref="S2.SS2.SSS4.p2.11.m10.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.11.m10.1.1.2.cmml" xref="S2.SS2.SSS4.p2.11.m10.1.1.2">𝐽</ci><minus id="S2.SS2.SSS4.p2.11.m10.1.1.3.cmml" xref="S2.SS2.SSS4.p2.11.m10.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.11.m10.1c">J^{-}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.11.m10.1d">italic_J start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>).
Recall that <math alttext="\mathbf{h}^{\text{SEQ}}_{u,j}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.12.m11.2"><semantics id="S2.SS2.SSS4.p2.12.m11.2a"><msubsup id="S2.SS2.SSS4.p2.12.m11.2.3" xref="S2.SS2.SSS4.p2.12.m11.2.3.cmml"><mi id="S2.SS2.SSS4.p2.12.m11.2.3.2.2" xref="S2.SS2.SSS4.p2.12.m11.2.3.2.2.cmml">𝐡</mi><mrow id="S2.SS2.SSS4.p2.12.m11.2.2.2.4" xref="S2.SS2.SSS4.p2.12.m11.2.2.2.3.cmml"><mi id="S2.SS2.SSS4.p2.12.m11.1.1.1.1" xref="S2.SS2.SSS4.p2.12.m11.1.1.1.1.cmml">u</mi><mo id="S2.SS2.SSS4.p2.12.m11.2.2.2.4.1" xref="S2.SS2.SSS4.p2.12.m11.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS4.p2.12.m11.2.2.2.2" xref="S2.SS2.SSS4.p2.12.m11.2.2.2.2.cmml">j</mi></mrow><mtext id="S2.SS2.SSS4.p2.12.m11.2.3.2.3" xref="S2.SS2.SSS4.p2.12.m11.2.3.2.3a.cmml">SEQ</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.12.m11.2b"><apply id="S2.SS2.SSS4.p2.12.m11.2.3.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.12.m11.2.3.1.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.3">subscript</csymbol><apply id="S2.SS2.SSS4.p2.12.m11.2.3.2.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.12.m11.2.3.2.1.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.12.m11.2.3.2.2.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.3.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.12.m11.2.3.2.3a.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.3.2.3"><mtext id="S2.SS2.SSS4.p2.12.m11.2.3.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.12.m11.2.3.2.3">SEQ</mtext></ci></apply><list id="S2.SS2.SSS4.p2.12.m11.2.2.2.3.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.2.2.4"><ci id="S2.SS2.SSS4.p2.12.m11.1.1.1.1.cmml" xref="S2.SS2.SSS4.p2.12.m11.1.1.1.1">𝑢</ci><ci id="S2.SS2.SSS4.p2.12.m11.2.2.2.2.cmml" xref="S2.SS2.SSS4.p2.12.m11.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.12.m11.2c">\mathbf{h}^{\text{SEQ}}_{u,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.12.m11.2d">bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is correlated with the next-item ID <math alttext="j^{+}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.13.m12.1"><semantics id="S2.SS2.SSS4.p2.13.m12.1a"><msup id="S2.SS2.SSS4.p2.13.m12.1.1" xref="S2.SS2.SSS4.p2.13.m12.1.1.cmml"><mi id="S2.SS2.SSS4.p2.13.m12.1.1.2" xref="S2.SS2.SSS4.p2.13.m12.1.1.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.13.m12.1.1.3" xref="S2.SS2.SSS4.p2.13.m12.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.13.m12.1b"><apply id="S2.SS2.SSS4.p2.13.m12.1.1.cmml" xref="S2.SS2.SSS4.p2.13.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.13.m12.1.1.1.cmml" xref="S2.SS2.SSS4.p2.13.m12.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.13.m12.1.1.2.cmml" xref="S2.SS2.SSS4.p2.13.m12.1.1.2">𝑗</ci><plus id="S2.SS2.SSS4.p2.13.m12.1.1.3.cmml" xref="S2.SS2.SSS4.p2.13.m12.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.13.m12.1c">j^{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.13.m12.1d">italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS3" title="2.2.3. Link Next Item ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>), while <math alttext="\mathbf{h}^{\text{ALIGN}}_{j^{+}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.14.m13.1"><semantics id="S2.SS2.SSS4.p2.14.m13.1a"><msubsup id="S2.SS2.SSS4.p2.14.m13.1.1" xref="S2.SS2.SSS4.p2.14.m13.1.1.cmml"><mi id="S2.SS2.SSS4.p2.14.m13.1.1.2.2" xref="S2.SS2.SSS4.p2.14.m13.1.1.2.2.cmml">𝐡</mi><msup id="S2.SS2.SSS4.p2.14.m13.1.1.3" xref="S2.SS2.SSS4.p2.14.m13.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.14.m13.1.1.3.2" xref="S2.SS2.SSS4.p2.14.m13.1.1.3.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.14.m13.1.1.3.3" xref="S2.SS2.SSS4.p2.14.m13.1.1.3.3.cmml">+</mo></msup><mtext id="S2.SS2.SSS4.p2.14.m13.1.1.2.3" xref="S2.SS2.SSS4.p2.14.m13.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.14.m13.1b"><apply id="S2.SS2.SSS4.p2.14.m13.1.1.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.14.m13.1.1.1.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1">subscript</csymbol><apply id="S2.SS2.SSS4.p2.14.m13.1.1.2.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.14.m13.1.1.2.1.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.14.m13.1.1.2.2.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.14.m13.1.1.2.3a.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1.2.3"><mtext id="S2.SS2.SSS4.p2.14.m13.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.14.m13.1.1.2.3">ALIGN</mtext></ci></apply><apply id="S2.SS2.SSS4.p2.14.m13.1.1.3.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.14.m13.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.14.m13.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1.3.2">𝑗</ci><plus id="S2.SS2.SSS4.p2.14.m13.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.14.m13.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.14.m13.1c">\mathbf{h}^{\text{ALIGN}}_{j^{+}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.14.m13.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}^{\text{ALIGN}}_{j^{-}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.15.m14.1"><semantics id="S2.SS2.SSS4.p2.15.m14.1a"><msubsup id="S2.SS2.SSS4.p2.15.m14.1.1" xref="S2.SS2.SSS4.p2.15.m14.1.1.cmml"><mi id="S2.SS2.SSS4.p2.15.m14.1.1.2.2" xref="S2.SS2.SSS4.p2.15.m14.1.1.2.2.cmml">𝐡</mi><msup id="S2.SS2.SSS4.p2.15.m14.1.1.3" xref="S2.SS2.SSS4.p2.15.m14.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.15.m14.1.1.3.2" xref="S2.SS2.SSS4.p2.15.m14.1.1.3.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.15.m14.1.1.3.3" xref="S2.SS2.SSS4.p2.15.m14.1.1.3.3.cmml">−</mo></msup><mtext id="S2.SS2.SSS4.p2.15.m14.1.1.2.3" xref="S2.SS2.SSS4.p2.15.m14.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.15.m14.1b"><apply id="S2.SS2.SSS4.p2.15.m14.1.1.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.15.m14.1.1.1.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1">subscript</csymbol><apply id="S2.SS2.SSS4.p2.15.m14.1.1.2.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.15.m14.1.1.2.1.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.15.m14.1.1.2.2.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.15.m14.1.1.2.3a.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1.2.3"><mtext id="S2.SS2.SSS4.p2.15.m14.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.15.m14.1.1.2.3">ALIGN</mtext></ci></apply><apply id="S2.SS2.SSS4.p2.15.m14.1.1.3.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.15.m14.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.15.m14.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1.3.2">𝑗</ci><minus id="S2.SS2.SSS4.p2.15.m14.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.15.m14.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.15.m14.1c">\mathbf{h}^{\text{ALIGN}}_{j^{-}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.15.m14.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are aligned with IDs of <math alttext="j^{+}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.16.m15.1"><semantics id="S2.SS2.SSS4.p2.16.m15.1a"><msup id="S2.SS2.SSS4.p2.16.m15.1.1" xref="S2.SS2.SSS4.p2.16.m15.1.1.cmml"><mi id="S2.SS2.SSS4.p2.16.m15.1.1.2" xref="S2.SS2.SSS4.p2.16.m15.1.1.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.16.m15.1.1.3" xref="S2.SS2.SSS4.p2.16.m15.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.16.m15.1b"><apply id="S2.SS2.SSS4.p2.16.m15.1.1.cmml" xref="S2.SS2.SSS4.p2.16.m15.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.16.m15.1.1.1.cmml" xref="S2.SS2.SSS4.p2.16.m15.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.16.m15.1.1.2.cmml" xref="S2.SS2.SSS4.p2.16.m15.1.1.2">𝑗</ci><plus id="S2.SS2.SSS4.p2.16.m15.1.1.3.cmml" xref="S2.SS2.SSS4.p2.16.m15.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.16.m15.1c">j^{+}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.16.m15.1d">italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="j^{-}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.17.m16.1"><semantics id="S2.SS2.SSS4.p2.17.m16.1a"><msup id="S2.SS2.SSS4.p2.17.m16.1.1" xref="S2.SS2.SSS4.p2.17.m16.1.1.cmml"><mi id="S2.SS2.SSS4.p2.17.m16.1.1.2" xref="S2.SS2.SSS4.p2.17.m16.1.1.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.17.m16.1.1.3" xref="S2.SS2.SSS4.p2.17.m16.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.17.m16.1b"><apply id="S2.SS2.SSS4.p2.17.m16.1.1.cmml" xref="S2.SS2.SSS4.p2.17.m16.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.17.m16.1.1.1.cmml" xref="S2.SS2.SSS4.p2.17.m16.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.17.m16.1.1.2.cmml" xref="S2.SS2.SSS4.p2.17.m16.1.1.2">𝑗</ci><minus id="S2.SS2.SSS4.p2.17.m16.1.1.3.cmml" xref="S2.SS2.SSS4.p2.17.m16.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.17.m16.1c">j^{-}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.17.m16.1d">italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS2" title="2.2.2. Semantic Alignment ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2.2</span></a>), respectively.
<span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS4.p2.18.2">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.18.2.m1.1"><semantics id="S2.SS2.SSS4.p2.18.2.m1.1a"><msub id="S2.SS2.SSS4.p2.18.2.m1.1.1" xref="S2.SS2.SSS4.p2.18.2.m1.1.1.cmml"><mi id="S2.SS2.SSS4.p2.18.2.m1.1.1a" xref="S2.SS2.SSS4.p2.18.2.m1.1.1.cmml"></mi><mtext id="S2.SS2.SSS4.p2.18.2.m1.1.1.1" xref="S2.SS2.SSS4.p2.18.2.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.18.2.m1.1b"><apply id="S2.SS2.SSS4.p2.18.2.m1.1.1.cmml" xref="S2.SS2.SSS4.p2.18.2.m1.1.1"><ci id="S2.SS2.SSS4.p2.18.2.m1.1.1.1a.cmml" xref="S2.SS2.SSS4.p2.18.2.m1.1.1.1"><mtext id="S2.SS2.SSS4.p2.18.2.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.18.2.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.18.2.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.18.2.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> conducts contrastive learning using InfoNCE loss <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib48" title="">2018</a>)</cite> among <math alttext="\mathbf{h}^{\text{SEQ}}_{u,j}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.19.m17.2"><semantics id="S2.SS2.SSS4.p2.19.m17.2a"><msubsup id="S2.SS2.SSS4.p2.19.m17.2.3" xref="S2.SS2.SSS4.p2.19.m17.2.3.cmml"><mi id="S2.SS2.SSS4.p2.19.m17.2.3.2.2" xref="S2.SS2.SSS4.p2.19.m17.2.3.2.2.cmml">𝐡</mi><mrow id="S2.SS2.SSS4.p2.19.m17.2.2.2.4" xref="S2.SS2.SSS4.p2.19.m17.2.2.2.3.cmml"><mi id="S2.SS2.SSS4.p2.19.m17.1.1.1.1" xref="S2.SS2.SSS4.p2.19.m17.1.1.1.1.cmml">u</mi><mo id="S2.SS2.SSS4.p2.19.m17.2.2.2.4.1" xref="S2.SS2.SSS4.p2.19.m17.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS4.p2.19.m17.2.2.2.2" xref="S2.SS2.SSS4.p2.19.m17.2.2.2.2.cmml">j</mi></mrow><mtext id="S2.SS2.SSS4.p2.19.m17.2.3.2.3" xref="S2.SS2.SSS4.p2.19.m17.2.3.2.3a.cmml">SEQ</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.19.m17.2b"><apply id="S2.SS2.SSS4.p2.19.m17.2.3.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.19.m17.2.3.1.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.3">subscript</csymbol><apply id="S2.SS2.SSS4.p2.19.m17.2.3.2.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.19.m17.2.3.2.1.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.19.m17.2.3.2.2.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.3.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.19.m17.2.3.2.3a.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.3.2.3"><mtext id="S2.SS2.SSS4.p2.19.m17.2.3.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.19.m17.2.3.2.3">SEQ</mtext></ci></apply><list id="S2.SS2.SSS4.p2.19.m17.2.2.2.3.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.2.2.4"><ci id="S2.SS2.SSS4.p2.19.m17.1.1.1.1.cmml" xref="S2.SS2.SSS4.p2.19.m17.1.1.1.1">𝑢</ci><ci id="S2.SS2.SSS4.p2.19.m17.2.2.2.2.cmml" xref="S2.SS2.SSS4.p2.19.m17.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.19.m17.2c">\mathbf{h}^{\text{SEQ}}_{u,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.19.m17.2d">bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{h}^{\text{ALIGN}}_{j^{+}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.20.m18.1"><semantics id="S2.SS2.SSS4.p2.20.m18.1a"><msubsup id="S2.SS2.SSS4.p2.20.m18.1.1" xref="S2.SS2.SSS4.p2.20.m18.1.1.cmml"><mi id="S2.SS2.SSS4.p2.20.m18.1.1.2.2" xref="S2.SS2.SSS4.p2.20.m18.1.1.2.2.cmml">𝐡</mi><msup id="S2.SS2.SSS4.p2.20.m18.1.1.3" xref="S2.SS2.SSS4.p2.20.m18.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.20.m18.1.1.3.2" xref="S2.SS2.SSS4.p2.20.m18.1.1.3.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.20.m18.1.1.3.3" xref="S2.SS2.SSS4.p2.20.m18.1.1.3.3.cmml">+</mo></msup><mtext id="S2.SS2.SSS4.p2.20.m18.1.1.2.3" xref="S2.SS2.SSS4.p2.20.m18.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.20.m18.1b"><apply id="S2.SS2.SSS4.p2.20.m18.1.1.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.20.m18.1.1.1.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1">subscript</csymbol><apply id="S2.SS2.SSS4.p2.20.m18.1.1.2.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.20.m18.1.1.2.1.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.20.m18.1.1.2.2.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.20.m18.1.1.2.3a.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1.2.3"><mtext id="S2.SS2.SSS4.p2.20.m18.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.20.m18.1.1.2.3">ALIGN</mtext></ci></apply><apply id="S2.SS2.SSS4.p2.20.m18.1.1.3.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.20.m18.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.20.m18.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1.3.2">𝑗</ci><plus id="S2.SS2.SSS4.p2.20.m18.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.20.m18.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.20.m18.1c">\mathbf{h}^{\text{ALIGN}}_{j^{+}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.20.m18.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}^{\text{ALIGN}}_{j^{-}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.21.m19.1"><semantics id="S2.SS2.SSS4.p2.21.m19.1a"><msubsup id="S2.SS2.SSS4.p2.21.m19.1.1" xref="S2.SS2.SSS4.p2.21.m19.1.1.cmml"><mi id="S2.SS2.SSS4.p2.21.m19.1.1.2.2" xref="S2.SS2.SSS4.p2.21.m19.1.1.2.2.cmml">𝐡</mi><msup id="S2.SS2.SSS4.p2.21.m19.1.1.3" xref="S2.SS2.SSS4.p2.21.m19.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.21.m19.1.1.3.2" xref="S2.SS2.SSS4.p2.21.m19.1.1.3.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.21.m19.1.1.3.3" xref="S2.SS2.SSS4.p2.21.m19.1.1.3.3.cmml">−</mo></msup><mtext id="S2.SS2.SSS4.p2.21.m19.1.1.2.3" xref="S2.SS2.SSS4.p2.21.m19.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.21.m19.1b"><apply id="S2.SS2.SSS4.p2.21.m19.1.1.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.21.m19.1.1.1.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1">subscript</csymbol><apply id="S2.SS2.SSS4.p2.21.m19.1.1.2.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.21.m19.1.1.2.1.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.21.m19.1.1.2.2.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.21.m19.1.1.2.3a.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1.2.3"><mtext id="S2.SS2.SSS4.p2.21.m19.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.21.m19.1.1.2.3">ALIGN</mtext></ci></apply><apply id="S2.SS2.SSS4.p2.21.m19.1.1.3.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.21.m19.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.21.m19.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1.3.2">𝑗</ci><minus id="S2.SS2.SSS4.p2.21.m19.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.21.m19.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.21.m19.1c">\mathbf{h}^{\text{ALIGN}}_{j^{-}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.21.m19.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to enhance its understanding of intrinsic differences of items: <math alttext="\mathbf{h}^{\text{SEQ}}_{u,j}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.22.m20.2"><semantics id="S2.SS2.SSS4.p2.22.m20.2a"><msubsup id="S2.SS2.SSS4.p2.22.m20.2.3" xref="S2.SS2.SSS4.p2.22.m20.2.3.cmml"><mi id="S2.SS2.SSS4.p2.22.m20.2.3.2.2" xref="S2.SS2.SSS4.p2.22.m20.2.3.2.2.cmml">𝐡</mi><mrow id="S2.SS2.SSS4.p2.22.m20.2.2.2.4" xref="S2.SS2.SSS4.p2.22.m20.2.2.2.3.cmml"><mi id="S2.SS2.SSS4.p2.22.m20.1.1.1.1" xref="S2.SS2.SSS4.p2.22.m20.1.1.1.1.cmml">u</mi><mo id="S2.SS2.SSS4.p2.22.m20.2.2.2.4.1" xref="S2.SS2.SSS4.p2.22.m20.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS4.p2.22.m20.2.2.2.2" xref="S2.SS2.SSS4.p2.22.m20.2.2.2.2.cmml">j</mi></mrow><mtext id="S2.SS2.SSS4.p2.22.m20.2.3.2.3" xref="S2.SS2.SSS4.p2.22.m20.2.3.2.3a.cmml">SEQ</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.22.m20.2b"><apply id="S2.SS2.SSS4.p2.22.m20.2.3.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.22.m20.2.3.1.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.3">subscript</csymbol><apply id="S2.SS2.SSS4.p2.22.m20.2.3.2.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.22.m20.2.3.2.1.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.22.m20.2.3.2.2.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.3.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.22.m20.2.3.2.3a.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.3.2.3"><mtext id="S2.SS2.SSS4.p2.22.m20.2.3.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.22.m20.2.3.2.3">SEQ</mtext></ci></apply><list id="S2.SS2.SSS4.p2.22.m20.2.2.2.3.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.2.2.4"><ci id="S2.SS2.SSS4.p2.22.m20.1.1.1.1.cmml" xref="S2.SS2.SSS4.p2.22.m20.1.1.1.1">𝑢</ci><ci id="S2.SS2.SSS4.p2.22.m20.2.2.2.2.cmml" xref="S2.SS2.SSS4.p2.22.m20.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.22.m20.2c">\mathbf{h}^{\text{SEQ}}_{u,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.22.m20.2d">bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is trained to be close to <math alttext="\mathbf{h}^{\text{ALIGN}}_{j^{+}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.23.m21.1"><semantics id="S2.SS2.SSS4.p2.23.m21.1a"><msubsup id="S2.SS2.SSS4.p2.23.m21.1.1" xref="S2.SS2.SSS4.p2.23.m21.1.1.cmml"><mi id="S2.SS2.SSS4.p2.23.m21.1.1.2.2" xref="S2.SS2.SSS4.p2.23.m21.1.1.2.2.cmml">𝐡</mi><msup id="S2.SS2.SSS4.p2.23.m21.1.1.3" xref="S2.SS2.SSS4.p2.23.m21.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.23.m21.1.1.3.2" xref="S2.SS2.SSS4.p2.23.m21.1.1.3.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.23.m21.1.1.3.3" xref="S2.SS2.SSS4.p2.23.m21.1.1.3.3.cmml">+</mo></msup><mtext id="S2.SS2.SSS4.p2.23.m21.1.1.2.3" xref="S2.SS2.SSS4.p2.23.m21.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.23.m21.1b"><apply id="S2.SS2.SSS4.p2.23.m21.1.1.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.23.m21.1.1.1.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1">subscript</csymbol><apply id="S2.SS2.SSS4.p2.23.m21.1.1.2.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.23.m21.1.1.2.1.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.23.m21.1.1.2.2.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.23.m21.1.1.2.3a.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1.2.3"><mtext id="S2.SS2.SSS4.p2.23.m21.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.23.m21.1.1.2.3">ALIGN</mtext></ci></apply><apply id="S2.SS2.SSS4.p2.23.m21.1.1.3.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.23.m21.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.23.m21.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1.3.2">𝑗</ci><plus id="S2.SS2.SSS4.p2.23.m21.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.23.m21.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.23.m21.1c">\mathbf{h}^{\text{ALIGN}}_{j^{+}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.23.m21.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and far away from <math alttext="\mathbf{h}^{\text{ALIGN}}_{j^{-}}" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.24.m22.1"><semantics id="S2.SS2.SSS4.p2.24.m22.1a"><msubsup id="S2.SS2.SSS4.p2.24.m22.1.1" xref="S2.SS2.SSS4.p2.24.m22.1.1.cmml"><mi id="S2.SS2.SSS4.p2.24.m22.1.1.2.2" xref="S2.SS2.SSS4.p2.24.m22.1.1.2.2.cmml">𝐡</mi><msup id="S2.SS2.SSS4.p2.24.m22.1.1.3" xref="S2.SS2.SSS4.p2.24.m22.1.1.3.cmml"><mi id="S2.SS2.SSS4.p2.24.m22.1.1.3.2" xref="S2.SS2.SSS4.p2.24.m22.1.1.3.2.cmml">j</mi><mo id="S2.SS2.SSS4.p2.24.m22.1.1.3.3" xref="S2.SS2.SSS4.p2.24.m22.1.1.3.3.cmml">−</mo></msup><mtext id="S2.SS2.SSS4.p2.24.m22.1.1.2.3" xref="S2.SS2.SSS4.p2.24.m22.1.1.2.3a.cmml">ALIGN</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.24.m22.1b"><apply id="S2.SS2.SSS4.p2.24.m22.1.1.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.24.m22.1.1.1.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1">subscript</csymbol><apply id="S2.SS2.SSS4.p2.24.m22.1.1.2.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.24.m22.1.1.2.1.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1">superscript</csymbol><ci id="S2.SS2.SSS4.p2.24.m22.1.1.2.2.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1.2.2">𝐡</ci><ci id="S2.SS2.SSS4.p2.24.m22.1.1.2.3a.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1.2.3"><mtext id="S2.SS2.SSS4.p2.24.m22.1.1.2.3.cmml" mathsize="70%" xref="S2.SS2.SSS4.p2.24.m22.1.1.2.3">ALIGN</mtext></ci></apply><apply id="S2.SS2.SSS4.p2.24.m22.1.1.3.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p2.24.m22.1.1.3.1.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS4.p2.24.m22.1.1.3.2.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1.3.2">𝑗</ci><minus id="S2.SS2.SSS4.p2.24.m22.1.1.3.3.cmml" xref="S2.SS2.SSS4.p2.24.m22.1.1.3.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.24.m22.1c">\mathbf{h}^{\text{ALIGN}}_{j^{-}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.24.m22.1d">bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.Ex4">
<tbody id="S2.Ex4X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle f(\mathbf{h},\mathbf{\mathbf{h}^{{}^{\prime}}})=exp\left(\text{%
sim}(\mathbf{h},\mathbf{\mathbf{h}^{{}^{\prime}}})/\tau\right)" class="ltx_Math" display="inline" id="S2.Ex4X.2.1.1.m1.4"><semantics id="S2.Ex4X.2.1.1.m1.4a"><mrow id="S2.Ex4X.2.1.1.m1.4.4" xref="S2.Ex4X.2.1.1.m1.4.4.cmml"><mrow id="S2.Ex4X.2.1.1.m1.3.3.1" xref="S2.Ex4X.2.1.1.m1.3.3.1.cmml"><mi id="S2.Ex4X.2.1.1.m1.3.3.1.3" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.3.3.1.3.cmml">f</mi><mo id="S2.Ex4X.2.1.1.m1.3.3.1.2" xref="S2.Ex4X.2.1.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.Ex4X.2.1.1.m1.3.3.1.1.1" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.2.cmml"><mo id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.2.cmml">(</mo><mi id="S2.Ex4X.2.1.1.m1.1.1" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.1.1.cmml">𝐡</mi><mo id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.3" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.2.cmml">,</mo><msup id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.cmml"><mi id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.2" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.2.cmml">𝐡</mi><msup id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3a" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3.cmml"></mi><mo id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3.1" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.4" maxsize="90%" minsize="90%" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex4X.2.1.1.m1.4.4.3" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.3.cmml">=</mo><mrow id="S2.Ex4X.2.1.1.m1.4.4.2" xref="S2.Ex4X.2.1.1.m1.4.4.2.cmml"><mi id="S2.Ex4X.2.1.1.m1.4.4.2.3" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.3.cmml">e</mi><mo id="S2.Ex4X.2.1.1.m1.4.4.2.2" xref="S2.Ex4X.2.1.1.m1.4.4.2.2.cmml">⁢</mo><mi id="S2.Ex4X.2.1.1.m1.4.4.2.4" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.4.cmml">x</mi><mo id="S2.Ex4X.2.1.1.m1.4.4.2.2a" xref="S2.Ex4X.2.1.1.m1.4.4.2.2.cmml">⁢</mo><mi id="S2.Ex4X.2.1.1.m1.4.4.2.5" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.5.cmml">p</mi><mo id="S2.Ex4X.2.1.1.m1.4.4.2.2b" xref="S2.Ex4X.2.1.1.m1.4.4.2.2.cmml">⁢</mo><mrow id="S2.Ex4X.2.1.1.m1.4.4.2.1.1" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.cmml"><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.2" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.cmml"><mrow id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.cmml"><mtext id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.3" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.3a.cmml">sim</mtext><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.2" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.2.cmml"><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.2.cmml">(</mo><mi id="S2.Ex4X.2.1.1.m1.2.2" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.2.2.cmml">𝐡</mi><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.3" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.2.cmml">,</mo><msup id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.2.cmml">𝐡</mi><msup id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3a" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3.cmml"></mi><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3.1" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3.1.cmml">′</mo></msup></msup><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.4" maxsize="90%" minsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.2" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.2.cmml">/</mo><mi id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.3" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.3.cmml">τ</mi></mrow><mo id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.3" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4X.2.1.1.m1.4b"><apply id="S2.Ex4X.2.1.1.m1.4.4.cmml" xref="S2.Ex4X.2.1.1.m1.4.4"><eq id="S2.Ex4X.2.1.1.m1.4.4.3.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.3"></eq><apply id="S2.Ex4X.2.1.1.m1.3.3.1.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1"><times id="S2.Ex4X.2.1.1.m1.3.3.1.2.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.2"></times><ci id="S2.Ex4X.2.1.1.m1.3.3.1.3.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.3">𝑓</ci><interval closure="open" id="S2.Ex4X.2.1.1.m1.3.3.1.1.2.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1"><ci id="S2.Ex4X.2.1.1.m1.1.1.cmml" xref="S2.Ex4X.2.1.1.m1.1.1">𝐡</ci><apply id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1">superscript</csymbol><ci id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.2">𝐡</ci><apply id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3"><ci id="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.Ex4X.2.1.1.m1.3.3.1.1.1.1.3.1">′</ci></apply></apply></interval></apply><apply id="S2.Ex4X.2.1.1.m1.4.4.2.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2"><times id="S2.Ex4X.2.1.1.m1.4.4.2.2.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.2"></times><ci id="S2.Ex4X.2.1.1.m1.4.4.2.3.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.3">𝑒</ci><ci id="S2.Ex4X.2.1.1.m1.4.4.2.4.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.4">𝑥</ci><ci id="S2.Ex4X.2.1.1.m1.4.4.2.5.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.5">𝑝</ci><apply id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1"><divide id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.2.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.2"></divide><apply id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1"><times id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.2.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.2"></times><ci id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.3a.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.3"><mtext id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.3.cmml" mathsize="90%" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.3">sim</mtext></ci><interval closure="open" id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1"><ci id="S2.Ex4X.2.1.1.m1.2.2.cmml" xref="S2.Ex4X.2.1.1.m1.2.2">𝐡</ci><apply id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.2">𝐡</ci><apply id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3"><ci id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.1.1.1.1.3.1">′</ci></apply></apply></interval></apply><ci id="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.3.cmml" xref="S2.Ex4X.2.1.1.m1.4.4.2.1.1.1.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4X.2.1.1.m1.4c">\displaystyle f(\mathbf{h},\mathbf{\mathbf{h}^{{}^{\prime}}})=exp\left(\text{%
sim}(\mathbf{h},\mathbf{\mathbf{h}^{{}^{\prime}}})/\tau\right)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4X.2.1.1.m1.4d">italic_f ( bold_h , bold_h start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ) = italic_e italic_x italic_p ( sim ( bold_h , bold_h start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ) / italic_τ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex4Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{cl}}=-\sum_{S_{u}}\sum_{j=1}^{n_{s}}" class="ltx_Math" display="inline" id="S2.Ex4Xa.2.1.1.m1.1"><semantics id="S2.Ex4Xa.2.1.1.m1.1a"><mrow id="S2.Ex4Xa.2.1.1.m1.1.1" xref="S2.Ex4Xa.2.1.1.m1.1.1.cmml"><msub id="S2.Ex4Xa.2.1.1.m1.1.1.2" xref="S2.Ex4Xa.2.1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex4Xa.2.1.1.m1.1.1.2.2" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S2.Ex4Xa.2.1.1.m1.1.1.2.3" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.2.3a.cmml">cl</mtext></msub><mo id="S2.Ex4Xa.2.1.1.m1.1.1.1" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.Ex4Xa.2.1.1.m1.1.1.3" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.cmml"><mo id="S2.Ex4Xa.2.1.1.m1.1.1.3a" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.cmml">−</mo><mrow id="S2.Ex4Xa.2.1.1.m1.1.1.3.2" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.cmml"><mstyle displaystyle="true" id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.cmml"><munder id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1a" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.cmml"><mo id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.2.cmml">∑</mo><msub id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.cmml"><mi id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.2" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.2.cmml">S</mi><mi id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.3" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.3.cmml">u</mi></msub></munder></mstyle><mstyle displaystyle="true" id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.cmml"><munderover id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2a" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.cmml"><mo id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.2.cmml">∑</mo><mrow id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.cmml"><mi id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.2" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.2.cmml">j</mi><mo id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.1" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.1.cmml">=</mo><mn id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.3" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.3.cmml">1</mn></mrow><msub id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.cmml"><mi id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.2" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.2.cmml">n</mi><mi id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.3" mathsize="90%" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.3.cmml">s</mi></msub></munderover></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4Xa.2.1.1.m1.1b"><apply id="S2.Ex4Xa.2.1.1.m1.1.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1"><eq id="S2.Ex4Xa.2.1.1.m1.1.1.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.1"></eq><apply id="S2.Ex4Xa.2.1.1.m1.1.1.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.2.1.1.m1.1.1.2.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S2.Ex4Xa.2.1.1.m1.1.1.2.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.2.2">ℒ</ci><ci id="S2.Ex4Xa.2.1.1.m1.1.1.2.3a.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.2.3"><mtext id="S2.Ex4Xa.2.1.1.m1.1.1.2.3.cmml" mathsize="63%" xref="S2.Ex4Xa.2.1.1.m1.1.1.2.3">cl</mtext></ci></apply><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3"><minus id="S2.Ex4Xa.2.1.1.m1.1.1.3.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3"></minus><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2"><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1">subscript</csymbol><sum id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.2"></sum><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3"><csymbol cd="ambiguous" id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3">subscript</csymbol><ci id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.2">𝑆</ci><ci id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.3.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.1.3.3">𝑢</ci></apply></apply><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2">superscript</csymbol><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2">subscript</csymbol><sum id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.2"></sum><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3"><eq id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.1"></eq><ci id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.2">𝑗</ci><cn id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.3.cmml" type="integer" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.2.3.3">1</cn></apply></apply><apply id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.1.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3">subscript</csymbol><ci id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.2.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.2">𝑛</ci><ci id="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.3.cmml" xref="S2.Ex4Xa.2.1.1.m1.1.1.3.2.2.3.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4Xa.2.1.1.m1.1c">\displaystyle\mathcal{L}_{\text{cl}}=-\sum_{S_{u}}\sum_{j=1}^{n_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4Xa.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT cl end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\log\frac{f(\mathbf{h}^{\text{SEQ}}_{u,j},\mathbf{h}^{\text{ALIGN%
}}_{j^{+}})}{f(\mathbf{h}^{\text{SEQ}}_{u,j},\mathbf{h}^{\text{ALIGN}}_{j^{+}}%
)+\sum_{j^{-}\in J^{-}}f(\mathbf{h}^{\text{SEQ}}_{u,j},\mathbf{h}^{\text{ALIGN%
}}_{j^{-}})}," class="ltx_Math" display="inline" id="S2.Ex4Xa.3.2.2.m1.13"><semantics id="S2.Ex4Xa.3.2.2.m1.13a"><mrow id="S2.Ex4Xa.3.2.2.m1.13.13.1" xref="S2.Ex4Xa.3.2.2.m1.13.13.1.1.cmml"><mrow id="S2.Ex4Xa.3.2.2.m1.13.13.1.1" xref="S2.Ex4Xa.3.2.2.m1.13.13.1.1.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.13.13.1.1.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.13.13.1.1.1.cmml">log</mi><mo id="S2.Ex4Xa.3.2.2.m1.13.13.1.1a" lspace="0.167em" xref="S2.Ex4Xa.3.2.2.m1.13.13.1.1.cmml">⁡</mo><mstyle displaystyle="true" id="S2.Ex4Xa.3.2.2.m1.12.12" xref="S2.Ex4Xa.3.2.2.m1.12.12.cmml"><mfrac id="S2.Ex4Xa.3.2.2.m1.12.12a" xref="S2.Ex4Xa.3.2.2.m1.12.12.cmml"><mrow id="S2.Ex4Xa.3.2.2.m1.4.4.4" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.4.4.4.6" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.6.cmml">f</mi><mo id="S2.Ex4Xa.3.2.2.m1.4.4.4.5" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.5.cmml">⁢</mo><mrow id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.3.cmml"><mo id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.3" maxsize="90%" minsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.3.cmml">(</mo><msubsup id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.2.cmml">𝐡</mi><mrow id="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.4" xref="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.3.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.1.1.1.1.1.1.cmml">u</mi><mo id="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.4.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mtext id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.3a.cmml">SEQ</mtext></msubsup><mo id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.4" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.3.cmml">,</mo><msubsup id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.2.cmml">𝐡</mi><msup id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.2.cmml">j</mi><mo id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.3.cmml">+</mo></msup><mtext id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.3a.cmml">ALIGN</mtext></msubsup><mo id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.5" maxsize="90%" minsize="90%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.3.cmml">)</mo></mrow></mrow><mrow id="S2.Ex4Xa.3.2.2.m1.12.12.12" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.cmml"><mrow id="S2.Ex4Xa.3.2.2.m1.10.10.10.6" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.4" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.4.cmml">f</mi><mo id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.3" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.3.cmml">⁢</mo><mrow id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.3.cmml"><mo id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.3" maxsize="90%" minsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.3.cmml">(</mo><msubsup id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.2.cmml">𝐡</mi><mrow id="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.4" xref="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.3.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.5.5.5.1.1.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.5.5.5.1.1.1.cmml">u</mi><mo id="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.4.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.3.cmml">,</mo><mi id="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.2.cmml">j</mi></mrow><mtext id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.3a.cmml">SEQ</mtext></msubsup><mo id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.4" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.3.cmml">,</mo><msubsup id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.2.cmml">𝐡</mi><msup id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.2.cmml">j</mi><mo id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.3.cmml">+</mo></msup><mtext id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.3a.cmml">ALIGN</mtext></msubsup><mo id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.5" maxsize="90%" minsize="90%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.9" mathsize="90%" rspace="0.055em" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.9.cmml">+</mo><mrow id="S2.Ex4Xa.3.2.2.m1.12.12.12.8" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.cmml"><msub id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.cmml"><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.2.cmml">∑</mo><mrow id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.cmml"><msup id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.2.cmml">j</mi><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.3.cmml">−</mo></msup><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.1.cmml">∈</mo><msup id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.2.cmml">J</mi><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.3.cmml">−</mo></msup></mrow></msub><mrow id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.4" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.4.cmml">f</mi><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.3" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.3.cmml">⁢</mo><mrow id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.3.cmml"><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.3" maxsize="90%" minsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.3.cmml">(</mo><msubsup id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.2.cmml">𝐡</mi><mrow id="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.4" xref="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.3.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.7.7.7.3.1.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.7.7.7.3.1.1.cmml">u</mi><mo id="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.4.1" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.3.cmml">,</mo><mi id="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.2.cmml">j</mi></mrow><mtext id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.3a.cmml">SEQ</mtext></msubsup><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.4" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.3.cmml">,</mo><msubsup id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.2.cmml">𝐡</mi><msup id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.cmml"><mi id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.2.cmml">j</mi><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.3.cmml">−</mo></msup><mtext id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.3" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.3a.cmml">ALIGN</mtext></msubsup><mo id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.5" maxsize="90%" minsize="90%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle></mrow><mo id="S2.Ex4Xa.3.2.2.m1.13.13.1.2" mathsize="90%" xref="S2.Ex4Xa.3.2.2.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4Xa.3.2.2.m1.13b"><apply id="S2.Ex4Xa.3.2.2.m1.13.13.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.13.13.1"><log id="S2.Ex4Xa.3.2.2.m1.13.13.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.13.13.1.1.1"></log><apply id="S2.Ex4Xa.3.2.2.m1.12.12.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12"><divide id="S2.Ex4Xa.3.2.2.m1.12.12.13.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12"></divide><apply id="S2.Ex4Xa.3.2.2.m1.4.4.4.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4"><times id="S2.Ex4Xa.3.2.2.m1.4.4.4.5.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.5"></times><ci id="S2.Ex4Xa.3.2.2.m1.4.4.4.6.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.6">𝑓</ci><interval closure="open" id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2"><apply id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1">subscript</csymbol><apply id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.2">𝐡</ci><ci id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.3a.cmml" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.3"><mtext id="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.3.cmml" mathsize="63%" xref="S2.Ex4Xa.3.2.2.m1.3.3.3.3.1.1.2.3">SEQ</mtext></ci></apply><list id="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.4"><ci id="S2.Ex4Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.1.1.1.1.1.1">𝑢</ci><ci id="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.2.2.2.2.2.2">𝑗</ci></list></apply><apply id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2">subscript</csymbol><apply id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.2">𝐡</ci><ci id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.3a.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.3"><mtext id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.3.cmml" mathsize="63%" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.2.3">ALIGN</mtext></ci></apply><apply id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.2">𝑗</ci><plus id="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.4.4.4.4.2.2.3.3"></plus></apply></apply></interval></apply><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12"><plus id="S2.Ex4Xa.3.2.2.m1.12.12.12.9.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.9"></plus><apply id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6"><times id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.3"></times><ci id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.4.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.4">𝑓</ci><interval closure="open" id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2"><apply id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1">subscript</csymbol><apply id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.2">𝐡</ci><ci id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.3a.cmml" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.3"><mtext id="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.3.cmml" mathsize="63%" xref="S2.Ex4Xa.3.2.2.m1.9.9.9.5.1.1.1.2.3">SEQ</mtext></ci></apply><list id="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.4"><ci id="S2.Ex4Xa.3.2.2.m1.5.5.5.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.5.5.5.1.1.1">𝑢</ci><ci id="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.6.6.6.2.2.2">𝑗</ci></list></apply><apply id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2">subscript</csymbol><apply id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.2">𝐡</ci><ci id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.3a.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.3"><mtext id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.3.cmml" mathsize="63%" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.2.3">ALIGN</mtext></ci></apply><apply id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.2">𝑗</ci><plus id="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.10.10.10.6.2.2.2.3.3"></plus></apply></apply></interval></apply><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8"><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3">subscript</csymbol><sum id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.2"></sum><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3"><in id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.1"></in><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.2">𝑗</ci><minus id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.2.3"></minus></apply><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.2">𝐽</ci><minus id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.3.3.3.3"></minus></apply></apply></apply><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2"><times id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.3"></times><ci id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.4.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.4">𝑓</ci><interval closure="open" id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2"><apply id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1">subscript</csymbol><apply id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.2">𝐡</ci><ci id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.3a.cmml" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.3"><mtext id="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.3.cmml" mathsize="63%" xref="S2.Ex4Xa.3.2.2.m1.11.11.11.7.1.1.1.1.2.3">SEQ</mtext></ci></apply><list id="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.4"><ci id="S2.Ex4Xa.3.2.2.m1.7.7.7.3.1.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.7.7.7.3.1.1">𝑢</ci><ci id="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.8.8.8.4.2.2">𝑗</ci></list></apply><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2">subscript</csymbol><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.2">𝐡</ci><ci id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.3a.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.3"><mtext id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.3.cmml" mathsize="63%" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.2.3">ALIGN</mtext></ci></apply><apply id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.1.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3">superscript</csymbol><ci id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.2.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.2">𝑗</ci><minus id="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.3.cmml" xref="S2.Ex4Xa.3.2.2.m1.12.12.12.8.2.2.2.2.3.3"></minus></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4Xa.3.2.2.m1.13c">\displaystyle\log\frac{f(\mathbf{h}^{\text{SEQ}}_{u,j},\mathbf{h}^{\text{ALIGN%
}}_{j^{+}})}{f(\mathbf{h}^{\text{SEQ}}_{u,j},\mathbf{h}^{\text{ALIGN}}_{j^{+}}%
)+\sum_{j^{-}\in J^{-}}f(\mathbf{h}^{\text{SEQ}}_{u,j},\mathbf{h}^{\text{ALIGN%
}}_{j^{-}})},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4Xa.3.2.2.m1.13d">roman_log divide start_ARG italic_f ( bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT , bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG italic_f ( bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT , bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ∈ italic_J start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_f ( bold_h start_POSTSUPERSCRIPT SEQ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u , italic_j end_POSTSUBSCRIPT , bold_h start_POSTSUPERSCRIPT ALIGN end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS4.p2.26">where <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.25.m1.1"><semantics id="S2.SS2.SSS4.p2.25.m1.1a"><mi id="S2.SS2.SSS4.p2.25.m1.1.1" xref="S2.SS2.SSS4.p2.25.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.25.m1.1b"><ci id="S2.SS2.SSS4.p2.25.m1.1.1.cmml" xref="S2.SS2.SSS4.p2.25.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.25.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.25.m1.1d">italic_τ</annotation></semantics></math> is the temperature parameter for scaling similarities and <math alttext="sim(\cdot)" class="ltx_Math" display="inline" id="S2.SS2.SSS4.p2.26.m2.1"><semantics id="S2.SS2.SSS4.p2.26.m2.1a"><mrow id="S2.SS2.SSS4.p2.26.m2.1.2" xref="S2.SS2.SSS4.p2.26.m2.1.2.cmml"><mi id="S2.SS2.SSS4.p2.26.m2.1.2.2" xref="S2.SS2.SSS4.p2.26.m2.1.2.2.cmml">s</mi><mo id="S2.SS2.SSS4.p2.26.m2.1.2.1" xref="S2.SS2.SSS4.p2.26.m2.1.2.1.cmml">⁢</mo><mi id="S2.SS2.SSS4.p2.26.m2.1.2.3" xref="S2.SS2.SSS4.p2.26.m2.1.2.3.cmml">i</mi><mo id="S2.SS2.SSS4.p2.26.m2.1.2.1a" xref="S2.SS2.SSS4.p2.26.m2.1.2.1.cmml">⁢</mo><mi id="S2.SS2.SSS4.p2.26.m2.1.2.4" xref="S2.SS2.SSS4.p2.26.m2.1.2.4.cmml">m</mi><mo id="S2.SS2.SSS4.p2.26.m2.1.2.1b" xref="S2.SS2.SSS4.p2.26.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS4.p2.26.m2.1.2.5.2" xref="S2.SS2.SSS4.p2.26.m2.1.2.cmml"><mo id="S2.SS2.SSS4.p2.26.m2.1.2.5.2.1" stretchy="false" xref="S2.SS2.SSS4.p2.26.m2.1.2.cmml">(</mo><mo id="S2.SS2.SSS4.p2.26.m2.1.1" lspace="0em" rspace="0em" xref="S2.SS2.SSS4.p2.26.m2.1.1.cmml">⋅</mo><mo id="S2.SS2.SSS4.p2.26.m2.1.2.5.2.2" stretchy="false" xref="S2.SS2.SSS4.p2.26.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p2.26.m2.1b"><apply id="S2.SS2.SSS4.p2.26.m2.1.2.cmml" xref="S2.SS2.SSS4.p2.26.m2.1.2"><times id="S2.SS2.SSS4.p2.26.m2.1.2.1.cmml" xref="S2.SS2.SSS4.p2.26.m2.1.2.1"></times><ci id="S2.SS2.SSS4.p2.26.m2.1.2.2.cmml" xref="S2.SS2.SSS4.p2.26.m2.1.2.2">𝑠</ci><ci id="S2.SS2.SSS4.p2.26.m2.1.2.3.cmml" xref="S2.SS2.SSS4.p2.26.m2.1.2.3">𝑖</ci><ci id="S2.SS2.SSS4.p2.26.m2.1.2.4.cmml" xref="S2.SS2.SSS4.p2.26.m2.1.2.4">𝑚</ci><ci id="S2.SS2.SSS4.p2.26.m2.1.1.cmml" xref="S2.SS2.SSS4.p2.26.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p2.26.m2.1c">sim(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS4.p2.26.m2.1d">italic_s italic_i italic_m ( ⋅ )</annotation></semantics></math> is the cosine similarity.</p>
</div>
<figure class="ltx_figure" id="S2.SS2.SSS4.2">
<div class="ltx_block" id="S2.SS2.SSS4.2.3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S2.F3" style="width:130.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="1291" id="S2.SS2.SSS4.1.1.g1" src="x3.png" width="829"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Two Masking Mechanisms.</figcaption>
</figure>
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S2.F4" style="width:290.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="595" id="S2.SS2.SSS4.2.2.g1" src="x4.png" width="830"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Overview of DAMoE.</figcaption>
</figure>
</div>
</figure>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.5. </span>Recommendation Adapters</h4>
<div class="ltx_para" id="S2.SS2.SSS5.p1">
<p class="ltx_p" id="S2.SS2.SSS5.p1.1">To reduce the computation overhead for fine-tuning <span class="ltx_text ltx_font_smallcaps" id="S2.SS2.SSS5.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS2.SSS5.p1.1.1.m1.1"><semantics id="S2.SS2.SSS5.p1.1.1.m1.1a"><msub id="S2.SS2.SSS5.p1.1.1.m1.1.1" xref="S2.SS2.SSS5.p1.1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS5.p1.1.1.m1.1.1a" xref="S2.SS2.SSS5.p1.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS2.SSS5.p1.1.1.m1.1.1.1" xref="S2.SS2.SSS5.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS5.p1.1.1.m1.1b"><apply id="S2.SS2.SSS5.p1.1.1.m1.1.1.cmml" xref="S2.SS2.SSS5.p1.1.1.m1.1.1"><ci id="S2.SS2.SSS5.p1.1.1.m1.1.1.1a.cmml" xref="S2.SS2.SSS5.p1.1.1.m1.1.1.1"><mtext id="S2.SS2.SSS5.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS2.SSS5.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS5.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS5.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span>, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, we keep the parameters of the feedforward network and the self-attention module in each LLM layer intact and fine-tune two injected recommendation adapters (a two-layer feedforward network) following the design of standard recommendation adapters <cite class="ltx_cite ltx_citemacro_citep">(Fu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib10" title="">2024</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\text{Adapter}(\mathbf{h})=\mathbf{W}_{2}\big{(}\mathbf{W}_{1}\cdot%
\mathbf{h}+\mathbf{b}_{1})+\mathbf{b}_{2}+\mathbf{h}," class="ltx_Math" display="block" id="S2.Ex5.m1.2"><semantics id="S2.Ex5.m1.2a"><mrow id="S2.Ex5.m1.2.2.1" xref="S2.Ex5.m1.2.2.1.1.cmml"><mrow id="S2.Ex5.m1.2.2.1.1" xref="S2.Ex5.m1.2.2.1.1.cmml"><mrow id="S2.Ex5.m1.2.2.1.1.3" xref="S2.Ex5.m1.2.2.1.1.3.cmml"><mtext id="S2.Ex5.m1.2.2.1.1.3.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.3.2a.cmml">Adapter</mtext><mo id="S2.Ex5.m1.2.2.1.1.3.1" xref="S2.Ex5.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex5.m1.2.2.1.1.3.3.2" xref="S2.Ex5.m1.2.2.1.1.3.cmml"><mo id="S2.Ex5.m1.2.2.1.1.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex5.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.Ex5.m1.1.1" mathsize="90%" xref="S2.Ex5.m1.1.1.cmml">𝐡</mi><mo id="S2.Ex5.m1.2.2.1.1.3.3.2.2" maxsize="90%" minsize="90%" xref="S2.Ex5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.2.2.1.1.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.Ex5.m1.2.2.1.1.1" xref="S2.Ex5.m1.2.2.1.1.1.cmml"><mrow id="S2.Ex5.m1.2.2.1.1.1.1" xref="S2.Ex5.m1.2.2.1.1.1.1.cmml"><msub id="S2.Ex5.m1.2.2.1.1.1.1.3" xref="S2.Ex5.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.Ex5.m1.2.2.1.1.1.1.3.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.3.2.cmml">𝐖</mi><mn id="S2.Ex5.m1.2.2.1.1.1.1.3.3" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S2.Ex5.m1.2.2.1.1.1.1.2" xref="S2.Ex5.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.1" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex5.m1.2.2.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mn id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.3" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">⋅</mo><mi id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">𝐡</mi></mrow><mo id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝐛</mi><mn id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S2.Ex5.m1.2.2.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.2.2.1.1.1.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.2.cmml">+</mo><msub id="S2.Ex5.m1.2.2.1.1.1.3" xref="S2.Ex5.m1.2.2.1.1.1.3.cmml"><mi id="S2.Ex5.m1.2.2.1.1.1.3.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.3.2.cmml">𝐛</mi><mn id="S2.Ex5.m1.2.2.1.1.1.3.3" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.3.3.cmml">2</mn></msub><mo id="S2.Ex5.m1.2.2.1.1.1.2a" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.2.cmml">+</mo><mi id="S2.Ex5.m1.2.2.1.1.1.4" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.1.4.cmml">𝐡</mi></mrow></mrow><mo id="S2.Ex5.m1.2.2.1.2" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.2b"><apply id="S2.Ex5.m1.2.2.1.1.cmml" xref="S2.Ex5.m1.2.2.1"><eq id="S2.Ex5.m1.2.2.1.1.2.cmml" xref="S2.Ex5.m1.2.2.1.1.2"></eq><apply id="S2.Ex5.m1.2.2.1.1.3.cmml" xref="S2.Ex5.m1.2.2.1.1.3"><times id="S2.Ex5.m1.2.2.1.1.3.1.cmml" xref="S2.Ex5.m1.2.2.1.1.3.1"></times><ci id="S2.Ex5.m1.2.2.1.1.3.2a.cmml" xref="S2.Ex5.m1.2.2.1.1.3.2"><mtext id="S2.Ex5.m1.2.2.1.1.3.2.cmml" mathsize="90%" xref="S2.Ex5.m1.2.2.1.1.3.2">Adapter</mtext></ci><ci id="S2.Ex5.m1.1.1.cmml" xref="S2.Ex5.m1.1.1">𝐡</ci></apply><apply id="S2.Ex5.m1.2.2.1.1.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1"><plus id="S2.Ex5.m1.2.2.1.1.1.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.2"></plus><apply id="S2.Ex5.m1.2.2.1.1.1.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1"><times id="S2.Ex5.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.2"></times><apply id="S2.Ex5.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex5.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.3.2">𝐖</ci><cn id="S2.Ex5.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S2.Ex5.m1.2.2.1.1.1.1.3.3">2</cn></apply><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1"><plus id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.1"></plus><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2"><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.1">⋅</ci><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝐖</ci><cn id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.2.3">1</cn></apply><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.2.3">𝐡</ci></apply><apply id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.2">𝐛</ci><cn id="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.Ex5.m1.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S2.Ex5.m1.2.2.1.1.1.3.cmml" xref="S2.Ex5.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex5.m1.2.2.1.1.1.3.1.cmml" xref="S2.Ex5.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.Ex5.m1.2.2.1.1.1.3.2.cmml" xref="S2.Ex5.m1.2.2.1.1.1.3.2">𝐛</ci><cn id="S2.Ex5.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="S2.Ex5.m1.2.2.1.1.1.3.3">2</cn></apply><ci id="S2.Ex5.m1.2.2.1.1.1.4.cmml" xref="S2.Ex5.m1.2.2.1.1.1.4">𝐡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.2c">\small\text{Adapter}(\mathbf{h})=\mathbf{W}_{2}\big{(}\mathbf{W}_{1}\cdot%
\mathbf{h}+\mathbf{b}_{1})+\mathbf{b}_{2}+\mathbf{h},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex5.m1.2d">Adapter ( bold_h ) = bold_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( bold_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋅ bold_h + bold_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) + bold_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + bold_h ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS5.p1.3">where <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S2.SS2.SSS5.p1.2.m1.1"><semantics id="S2.SS2.SSS5.p1.2.m1.1a"><mi id="S2.SS2.SSS5.p1.2.m1.1.1" xref="S2.SS2.SSS5.p1.2.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS5.p1.2.m1.1b"><ci id="S2.SS2.SSS5.p1.2.m1.1.1.cmml" xref="S2.SS2.SSS5.p1.2.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS5.p1.2.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS5.p1.2.m1.1d">bold_W</annotation></semantics></math> and <math alttext="\mathbf{b}" class="ltx_Math" display="inline" id="S2.SS2.SSS5.p1.3.m2.1"><semantics id="S2.SS2.SSS5.p1.3.m2.1a"><mi id="S2.SS2.SSS5.p1.3.m2.1.1" xref="S2.SS2.SSS5.p1.3.m2.1.1.cmml">𝐛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS5.p1.3.m2.1b"><ci id="S2.SS2.SSS5.p1.3.m2.1.1.cmml" xref="S2.SS2.SSS5.p1.3.m2.1.1">𝐛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS5.p1.3.m2.1c">\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS5.p1.3.m2.1d">bold_b</annotation></semantics></math> are learnable parameters.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In this section, we will illustrate how <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.p1.1.2">MixRec</span>, based on <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.1.m1.1"><semantics id="S2.SS3.p1.1.1.m1.1a"><msub id="S2.SS3.p1.1.1.m1.1.1" xref="S2.SS3.p1.1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.1.m1.1.1a" xref="S2.SS3.p1.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS3.p1.1.1.m1.1.1.1" xref="S2.SS3.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.1.m1.1b"><apply id="S2.SS3.p1.1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.1.m1.1.1"><ci id="S2.SS3.p1.1.1.m1.1.1.1a.cmml" xref="S2.SS3.p1.1.1.m1.1.1.1"><mtext id="S2.SS3.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS3.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span>, can capture intra-item relation and collaborative knowledge under the dynamic adaptive mixture-of-experts design.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1. </span>Context Masking</h4>
<div class="ltx_para" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.1">Coarse-grained adaption tasks only capture inter-item relations and do not emphasize on the relations between tokens within the same item (intra-item relations).
The reason is that standard decoder-only LLMs adopt causal masking <cite class="ltx_cite ltx_citemacro_citep">(Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib57" title="">2024</a>)</cite> to compute attention, where each token attends to prior and current tokens only, ignoring future tokens.
As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.F3" title="Figure 3 ‣ 2.2.4. Distinguish Hard Samples ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>(a), causal masking does not set boundaries to separate tokens from different items.
<span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS1.p1.1.1">MixRec</span> represents each item with multiple tokens (i.e., item “sentence”), and using causal masking only will fail to fully model token semantics in the item context.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS1.p2">
<p class="ltx_p" id="S2.SS3.SSS1.p2.10">We introduce context masking to address the above issue.
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.F3" title="Figure 3 ‣ 2.2.4. Distinguish Hard Samples ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> depicts context masking and causal masking for linking next item (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS3" title="2.2.3. Link Next Item ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>).
For semantic alignment (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS2" title="2.2.2. Semantic Alignment ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2.2</span></a>), the demonstration is provided in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A2" title="Appendix B Demonstration of Two Masking Mechanisms for Semantic Alignment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">B</span></a> of Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A2" title="Appendix B Demonstration of Two Masking Mechanisms for Semantic Alignment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">B</span></a>.
Context masking allows each token within an item “sentence” to attend only to other tokens within the same item (and collaborative representations introduced in the next section), disregarding tokens from other items.
It focuses on intra-item relations.
Mathematically, the definitions for causal masking and context masking are as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.Ex6">
<tbody id="S2.Ex6X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\textbf{MASK}_{\text{causal}}(i,j)" class="ltx_Math" display="inline" id="S2.Ex6X.2.1.1.m1.2"><semantics id="S2.Ex6X.2.1.1.m1.2a"><mrow id="S2.Ex6X.2.1.1.m1.2.3" xref="S2.Ex6X.2.1.1.m1.2.3.cmml"><msub id="S2.Ex6X.2.1.1.m1.2.3.2" xref="S2.Ex6X.2.1.1.m1.2.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex6X.2.1.1.m1.2.3.2.2" mathsize="90%" xref="S2.Ex6X.2.1.1.m1.2.3.2.2a.cmml">MASK</mtext><mtext id="S2.Ex6X.2.1.1.m1.2.3.2.3" mathsize="90%" xref="S2.Ex6X.2.1.1.m1.2.3.2.3a.cmml">causal</mtext></msub><mo id="S2.Ex6X.2.1.1.m1.2.3.1" xref="S2.Ex6X.2.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.Ex6X.2.1.1.m1.2.3.3.2" xref="S2.Ex6X.2.1.1.m1.2.3.3.1.cmml"><mo id="S2.Ex6X.2.1.1.m1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex6X.2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.Ex6X.2.1.1.m1.1.1" mathsize="90%" xref="S2.Ex6X.2.1.1.m1.1.1.cmml">i</mi><mo id="S2.Ex6X.2.1.1.m1.2.3.3.2.2" mathsize="90%" xref="S2.Ex6X.2.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.Ex6X.2.1.1.m1.2.2" mathsize="90%" xref="S2.Ex6X.2.1.1.m1.2.2.cmml">j</mi><mo id="S2.Ex6X.2.1.1.m1.2.3.3.2.3" maxsize="90%" minsize="90%" xref="S2.Ex6X.2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6X.2.1.1.m1.2b"><apply id="S2.Ex6X.2.1.1.m1.2.3.cmml" xref="S2.Ex6X.2.1.1.m1.2.3"><times id="S2.Ex6X.2.1.1.m1.2.3.1.cmml" xref="S2.Ex6X.2.1.1.m1.2.3.1"></times><apply id="S2.Ex6X.2.1.1.m1.2.3.2.cmml" xref="S2.Ex6X.2.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.Ex6X.2.1.1.m1.2.3.2.1.cmml" xref="S2.Ex6X.2.1.1.m1.2.3.2">subscript</csymbol><ci id="S2.Ex6X.2.1.1.m1.2.3.2.2a.cmml" xref="S2.Ex6X.2.1.1.m1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex6X.2.1.1.m1.2.3.2.2.cmml" mathsize="90%" xref="S2.Ex6X.2.1.1.m1.2.3.2.2">MASK</mtext></ci><ci id="S2.Ex6X.2.1.1.m1.2.3.2.3a.cmml" xref="S2.Ex6X.2.1.1.m1.2.3.2.3"><mtext id="S2.Ex6X.2.1.1.m1.2.3.2.3.cmml" mathsize="63%" xref="S2.Ex6X.2.1.1.m1.2.3.2.3">causal</mtext></ci></apply><interval closure="open" id="S2.Ex6X.2.1.1.m1.2.3.3.1.cmml" xref="S2.Ex6X.2.1.1.m1.2.3.3.2"><ci id="S2.Ex6X.2.1.1.m1.1.1.cmml" xref="S2.Ex6X.2.1.1.m1.1.1">𝑖</ci><ci id="S2.Ex6X.2.1.1.m1.2.2.cmml" xref="S2.Ex6X.2.1.1.m1.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6X.2.1.1.m1.2c">\displaystyle\textbf{MASK}_{\text{causal}}(i,j)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6X.2.1.1.m1.2d">MASK start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT ( italic_i , italic_j )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}\text{True},&amp;\text{if }i\leq j\text{ and }j\neq 1\\
\text{False},&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="inline" id="S2.Ex6X.3.2.2.m1.1"><semantics id="S2.Ex6X.3.2.2.m1.1a"><mrow id="S2.Ex6X.3.2.2.m1.1.1" xref="S2.Ex6X.3.2.2.m1.1.1.cmml"><mi id="S2.Ex6X.3.2.2.m1.1.1.2" xref="S2.Ex6X.3.2.2.m1.1.1.2.cmml"></mi><mo id="S2.Ex6X.3.2.2.m1.1.1.1" mathsize="90%" xref="S2.Ex6X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S2.Ex6.m1.4.4.4.4.4.4a" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mo id="S2.Ex6.m1.4.4.4.4.4.4a.5" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S2.Ex6.m1.4.4.4.4.4.4.4a" rowspacing="0pt" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mtr id="S2.Ex6.m1.4.4.4.4.4.4.4aa" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.4.4.4.4.4.4.4ab" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mrow id="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.3" xref="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.1a.cmml"><mtext id="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.1" mathsize="90%" xref="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.1.cmml">True</mtext><mo id="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.3.1" mathsize="90%" xref="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.1a.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.4.4.4.4.4.4.4ac" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mrow id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml"><mrow id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml"><mtext id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2a.cmml">if </mtext><mo id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.cmml">⁢</mo><mi id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.cmml">i</mi></mrow><mo id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.3" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.cmml">≤</mo><mrow id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml"><mi id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2.cmml">j</mi><mo id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml">⁢</mo><mtext id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3a.cmml"> and </mtext><mo id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1a" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml">⁢</mo><mi id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.cmml">j</mi></mrow><mo id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.5" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.5.cmml">≠</mo><mn id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.6" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.6.cmml">1</mn></mrow></mtd></mtr><mtr id="S2.Ex6.m1.4.4.4.4.4.4.4ad" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.4.4.4.4.4.4.4ae" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mrow id="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.3" xref="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.1a.cmml"><mtext id="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.1" mathsize="90%" xref="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.1.cmml">False</mtext><mo id="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.3.1" mathsize="90%" xref="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.1a.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.4.4.4.4.4.4.4af" xref="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml"><mtext id="S2.Ex6.m1.4.4.4.4.4.4.4.4.2.1.mf" mathsize="90%" xref="S2.Ex6.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6X.3.2.2.m1.1b"><apply id="S2.Ex6X.3.2.2.m1.1.1.cmml" xref="S2.Ex6X.3.2.2.m1.1.1"><eq id="S2.Ex6X.3.2.2.m1.1.1.1.cmml" xref="S2.Ex6X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S2.Ex6X.3.2.2.m1.1.1.2.cmml" xref="S2.Ex6X.3.2.2.m1.1.1.2">absent</csymbol><apply id="S2.Ex6X.3.2.2.m1.1.1.3.1.cmml" xref="S2.Ex6.m1.4.4.4.4.4.4a"><csymbol cd="latexml" id="S2.Ex6X.3.2.2.m1.1.1.3.1.1.cmml" xref="S2.Ex6.m1.4.4.4.4.4.4a.5">cases</csymbol><ci id="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.1a.cmml" xref="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.3"><mtext id="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.1.cmml" mathsize="90%" xref="S2.Ex6.m1.1.1.1.1.1.1.1.1.1.1.mf.1">True</mtext></ci><apply id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf"><and id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mfa.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf"></and><apply id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mfb.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf"><leq id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.3"></leq><apply id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2"><times id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1"></times><ci id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2a.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2"><mtext id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.cmml" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2">if </mtext></ci><ci id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3">𝑖</ci></apply><apply id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4"><times id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.1"></times><ci id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.2">𝑗</ci><ci id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3a.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3"><mtext id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3.cmml" mathsize="90%" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.3"> and </mtext></ci><ci id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.4">𝑗</ci></apply></apply><apply id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mfc.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf"><neq id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.5.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.5"></neq><share href="https://arxiv.org/html/2408.07427v1#S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.4.cmml" id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mfd.cmml" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf"></share><cn id="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.6.cmml" type="integer" xref="S2.Ex6.m1.2.2.2.2.2.2.2.2.2.1.mf.6">1</cn></apply></apply><ci id="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.1a.cmml" xref="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.3"><mtext id="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.1.cmml" mathsize="90%" xref="S2.Ex6.m1.3.3.3.3.3.3.3.3.1.1.mf.1">False</mtext></ci><ci id="S2.Ex6.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml" xref="S2.Ex6.m1.4.4.4.4.4.4.4.4.2.1.mf"><mtext id="S2.Ex6.m1.4.4.4.4.4.4.4.4.2.1.mf.cmml" mathsize="90%" xref="S2.Ex6.m1.4.4.4.4.4.4.4.4.2.1.mf">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6X.3.2.2.m1.1c">\displaystyle=\begin{cases}\text{True},&amp;\text{if }i\leq j\text{ and }j\neq 1\\
\text{False},&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6X.3.2.2.m1.1d">= { start_ROW start_CELL True , end_CELL start_CELL if italic_i ≤ italic_j and italic_j ≠ 1 end_CELL end_ROW start_ROW start_CELL False , end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex6Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\textbf{MASK}_{\text{context}}(i,j)" class="ltx_Math" display="inline" id="S2.Ex6Xa.2.1.1.m1.2"><semantics id="S2.Ex6Xa.2.1.1.m1.2a"><mrow id="S2.Ex6Xa.2.1.1.m1.2.3" xref="S2.Ex6Xa.2.1.1.m1.2.3.cmml"><msub id="S2.Ex6Xa.2.1.1.m1.2.3.2" xref="S2.Ex6Xa.2.1.1.m1.2.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex6Xa.2.1.1.m1.2.3.2.2" mathsize="90%" xref="S2.Ex6Xa.2.1.1.m1.2.3.2.2a.cmml">MASK</mtext><mtext id="S2.Ex6Xa.2.1.1.m1.2.3.2.3" mathsize="90%" xref="S2.Ex6Xa.2.1.1.m1.2.3.2.3a.cmml">context</mtext></msub><mo id="S2.Ex6Xa.2.1.1.m1.2.3.1" xref="S2.Ex6Xa.2.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.Ex6Xa.2.1.1.m1.2.3.3.2" xref="S2.Ex6Xa.2.1.1.m1.2.3.3.1.cmml"><mo id="S2.Ex6Xa.2.1.1.m1.2.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex6Xa.2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.Ex6Xa.2.1.1.m1.1.1" mathsize="90%" xref="S2.Ex6Xa.2.1.1.m1.1.1.cmml">i</mi><mo id="S2.Ex6Xa.2.1.1.m1.2.3.3.2.2" mathsize="90%" xref="S2.Ex6Xa.2.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.Ex6Xa.2.1.1.m1.2.2" mathsize="90%" xref="S2.Ex6Xa.2.1.1.m1.2.2.cmml">j</mi><mo id="S2.Ex6Xa.2.1.1.m1.2.3.3.2.3" maxsize="90%" minsize="90%" xref="S2.Ex6Xa.2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6Xa.2.1.1.m1.2b"><apply id="S2.Ex6Xa.2.1.1.m1.2.3.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.3"><times id="S2.Ex6Xa.2.1.1.m1.2.3.1.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.3.1"></times><apply id="S2.Ex6Xa.2.1.1.m1.2.3.2.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.Ex6Xa.2.1.1.m1.2.3.2.1.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.3.2">subscript</csymbol><ci id="S2.Ex6Xa.2.1.1.m1.2.3.2.2a.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex6Xa.2.1.1.m1.2.3.2.2.cmml" mathsize="90%" xref="S2.Ex6Xa.2.1.1.m1.2.3.2.2">MASK</mtext></ci><ci id="S2.Ex6Xa.2.1.1.m1.2.3.2.3a.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.3.2.3"><mtext id="S2.Ex6Xa.2.1.1.m1.2.3.2.3.cmml" mathsize="63%" xref="S2.Ex6Xa.2.1.1.m1.2.3.2.3">context</mtext></ci></apply><interval closure="open" id="S2.Ex6Xa.2.1.1.m1.2.3.3.1.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.3.3.2"><ci id="S2.Ex6Xa.2.1.1.m1.1.1.cmml" xref="S2.Ex6Xa.2.1.1.m1.1.1">𝑖</ci><ci id="S2.Ex6Xa.2.1.1.m1.2.2.cmml" xref="S2.Ex6Xa.2.1.1.m1.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6Xa.2.1.1.m1.2c">\displaystyle\textbf{MASK}_{\text{context}}(i,j)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6Xa.2.1.1.m1.2d">MASK start_POSTSUBSCRIPT context end_POSTSUBSCRIPT ( italic_i , italic_j )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}\text{True},&amp;\text{if }\text{SameItem}(i,j)\\
\text{False},&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="inline" id="S2.Ex6Xa.3.2.2.m1.1"><semantics id="S2.Ex6Xa.3.2.2.m1.1a"><mrow id="S2.Ex6Xa.3.2.2.m1.1.1" xref="S2.Ex6Xa.3.2.2.m1.1.1.cmml"><mi id="S2.Ex6Xa.3.2.2.m1.1.1.2" xref="S2.Ex6Xa.3.2.2.m1.1.1.2.cmml"></mi><mo id="S2.Ex6Xa.3.2.2.m1.1.1.1" mathsize="90%" xref="S2.Ex6Xa.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S2.Ex6.m1.8.8.8.4.4.4a" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mo id="S2.Ex6.m1.8.8.8.4.4.4a.5" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S2.Ex6.m1.8.8.8.4.4.4.4a" rowspacing="0pt" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mtr id="S2.Ex6.m1.8.8.8.4.4.4.4aa" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.8.8.8.4.4.4.4ab" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mrow id="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.3" xref="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.1a.cmml"><mtext id="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.1" mathsize="90%" xref="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.1.cmml">True</mtext><mo id="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.3.1" mathsize="90%" xref="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.1a.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.8.8.8.4.4.4.4ac" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mrow id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.cmml"><mrow id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4c.cmml"><mtext id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4a" mathsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4c.cmml">if </mtext><mtext id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4b" mathsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4c.cmml">SameItem</mtext></mrow><mo id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.3" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.3.cmml">⁢</mo><mrow id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.2" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.1.cmml"><mo id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.2.1" maxsize="90%" minsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.1.cmml">(</mo><mi id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.1" mathsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.1.cmml">i</mi><mo id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.2.2" mathsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.1.cmml">,</mo><mi id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.2" mathsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.2.cmml">j</mi><mo id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.2.3" maxsize="90%" minsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S2.Ex6.m1.8.8.8.4.4.4.4ad" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.8.8.8.4.4.4.4ae" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mrow id="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.3" xref="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.1a.cmml"><mtext id="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.1" mathsize="90%" xref="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.1.cmml">False</mtext><mo id="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.3.1" mathsize="90%" xref="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.1a.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex6.m1.8.8.8.4.4.4.4af" xref="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml"><mtext id="S2.Ex6.m1.8.8.8.4.4.4.4.4.2.1.mf" mathsize="90%" xref="S2.Ex6.m1.8.8.8.4.4.4.4.4.2.1.mfa.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6Xa.3.2.2.m1.1b"><apply id="S2.Ex6Xa.3.2.2.m1.1.1.cmml" xref="S2.Ex6Xa.3.2.2.m1.1.1"><eq id="S2.Ex6Xa.3.2.2.m1.1.1.1.cmml" xref="S2.Ex6Xa.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S2.Ex6Xa.3.2.2.m1.1.1.2.cmml" xref="S2.Ex6Xa.3.2.2.m1.1.1.2">absent</csymbol><apply id="S2.Ex6Xa.3.2.2.m1.1.1.3.1.cmml" xref="S2.Ex6.m1.8.8.8.4.4.4a"><csymbol cd="latexml" id="S2.Ex6Xa.3.2.2.m1.1.1.3.1.1.cmml" xref="S2.Ex6.m1.8.8.8.4.4.4a.5">cases</csymbol><ci id="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.1a.cmml" xref="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.3"><mtext id="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.1.cmml" mathsize="90%" xref="S2.Ex6.m1.5.5.5.1.1.1.1.1.1.1.mf.1">True</mtext></ci><apply id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.cmml" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf"><times id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.3.cmml" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.3"></times><ci id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4c.cmml" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4"><mrow id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4.cmml" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4"><mtext id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4a.cmml" mathsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4">if </mtext><mtext id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4b.cmml" mathsize="90%" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.4">SameItem</mtext></mrow></ci><interval closure="open" id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.1.cmml" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.5.2"><ci id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.1.cmml" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.1">𝑖</ci><ci id="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.2.cmml" xref="S2.Ex6.m1.6.6.6.2.2.2.2.2.2.1.mf.2">𝑗</ci></interval></apply><ci id="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.1a.cmml" xref="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.3"><mtext id="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.1.cmml" mathsize="90%" xref="S2.Ex6.m1.7.7.7.3.3.3.3.3.1.1.mf.1">False</mtext></ci><ci id="S2.Ex6.m1.8.8.8.4.4.4.4.4.2.1.mfa.cmml" xref="S2.Ex6.m1.8.8.8.4.4.4.4.4.2.1.mf"><mtext id="S2.Ex6.m1.8.8.8.4.4.4.4.4.2.1.mf.cmml" mathsize="90%" xref="S2.Ex6.m1.8.8.8.4.4.4.4.4.2.1.mf">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6Xa.3.2.2.m1.1c">\displaystyle=\begin{cases}\text{True},&amp;\text{if }\text{SameItem}(i,j)\\
\text{False},&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6Xa.3.2.2.m1.1d">= { start_ROW start_CELL True , end_CELL start_CELL if roman_SameItem ( italic_i , italic_j ) end_CELL end_ROW start_ROW start_CELL False , end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS1.p2.9">where <math alttext="\textbf{MASK}_{\text{causal}}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.1.m1.1"><semantics id="S2.SS3.SSS1.p2.1.m1.1a"><msub id="S2.SS3.SSS1.p2.1.m1.1.1" xref="S2.SS3.SSS1.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.1.1.2" xref="S2.SS3.SSS1.p2.1.m1.1.1.2a.cmml">MASK</mtext><mtext id="S2.SS3.SSS1.p2.1.m1.1.1.3" xref="S2.SS3.SSS1.p2.1.m1.1.1.3a.cmml">causal</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.1.m1.1b"><apply id="S2.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.1.1.2a.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.2">MASK</mtext></ci><ci id="S2.SS3.SSS1.p2.1.m1.1.1.3a.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1.3"><mtext id="S2.SS3.SSS1.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS1.p2.1.m1.1.1.3">causal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.1.m1.1c">\textbf{MASK}_{\text{causal}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.1.m1.1d">MASK start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{MASK}_{\text{context}}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.2.m2.1"><semantics id="S2.SS3.SSS1.p2.2.m2.1a"><msub id="S2.SS3.SSS1.p2.2.m2.1.1" xref="S2.SS3.SSS1.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.2.m2.1.1.2" xref="S2.SS3.SSS1.p2.2.m2.1.1.2a.cmml">MASK</mtext><mtext id="S2.SS3.SSS1.p2.2.m2.1.1.3" xref="S2.SS3.SSS1.p2.2.m2.1.1.3a.cmml">context</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.2.m2.1b"><apply id="S2.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p2.2.m2.1.1.2a.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1.2">MASK</mtext></ci><ci id="S2.SS3.SSS1.p2.2.m2.1.1.3a.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1.3"><mtext id="S2.SS3.SSS1.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS1.p2.2.m2.1.1.3">context</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.2.m2.1c">\textbf{MASK}_{\text{context}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.2.m2.1d">MASK start_POSTSUBSCRIPT context end_POSTSUBSCRIPT</annotation></semantics></math> are masking matrices of size <math alttext="m\times(m+1)" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.3.m3.1"><semantics id="S2.SS3.SSS1.p2.3.m3.1a"><mrow id="S2.SS3.SSS1.p2.3.m3.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S2.SS3.SSS1.p2.3.m3.1.1.3" xref="S2.SS3.SSS1.p2.3.m3.1.1.3.cmml">m</mi><mo id="S2.SS3.SSS1.p2.3.m3.1.1.2" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p2.3.m3.1.1.2.cmml">×</mo><mrow id="S2.SS3.SSS1.p2.3.m3.1.1.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.2" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.2.cmml">m</mi><mo id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.3" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.3.m3.1b"><apply id="S2.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1"><times id="S2.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.2"></times><ci id="S2.SS3.SSS1.p2.3.m3.1.1.3.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.3">𝑚</ci><apply id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1"><plus id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.1"></plus><ci id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.2">𝑚</ci><cn id="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.3.m3.1c">m\times(m+1)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.3.m3.1d">italic_m × ( italic_m + 1 )</annotation></semantics></math> and <math alttext="m" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.4.m4.1"><semantics id="S2.SS3.SSS1.p2.4.m4.1a"><mi id="S2.SS3.SSS1.p2.4.m4.1.1" xref="S2.SS3.SSS1.p2.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.4.m4.1b"><ci id="S2.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.4.m4.1d">italic_m</annotation></semantics></math> is the maximum number of tokens in an item “sentence’.
The function <math alttext="\text{SameItem}(i,j)" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.5.m5.2"><semantics id="S2.SS3.SSS1.p2.5.m5.2a"><mrow id="S2.SS3.SSS1.p2.5.m5.2.3" xref="S2.SS3.SSS1.p2.5.m5.2.3.cmml"><mtext id="S2.SS3.SSS1.p2.5.m5.2.3.2" xref="S2.SS3.SSS1.p2.5.m5.2.3.2a.cmml">SameItem</mtext><mo id="S2.SS3.SSS1.p2.5.m5.2.3.1" xref="S2.SS3.SSS1.p2.5.m5.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.SSS1.p2.5.m5.2.3.3.2" xref="S2.SS3.SSS1.p2.5.m5.2.3.3.1.cmml"><mo id="S2.SS3.SSS1.p2.5.m5.2.3.3.2.1" stretchy="false" xref="S2.SS3.SSS1.p2.5.m5.2.3.3.1.cmml">(</mo><mi id="S2.SS3.SSS1.p2.5.m5.1.1" xref="S2.SS3.SSS1.p2.5.m5.1.1.cmml">i</mi><mo id="S2.SS3.SSS1.p2.5.m5.2.3.3.2.2" xref="S2.SS3.SSS1.p2.5.m5.2.3.3.1.cmml">,</mo><mi id="S2.SS3.SSS1.p2.5.m5.2.2" xref="S2.SS3.SSS1.p2.5.m5.2.2.cmml">j</mi><mo id="S2.SS3.SSS1.p2.5.m5.2.3.3.2.3" stretchy="false" xref="S2.SS3.SSS1.p2.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.5.m5.2b"><apply id="S2.SS3.SSS1.p2.5.m5.2.3.cmml" xref="S2.SS3.SSS1.p2.5.m5.2.3"><times id="S2.SS3.SSS1.p2.5.m5.2.3.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.2.3.1"></times><ci id="S2.SS3.SSS1.p2.5.m5.2.3.2a.cmml" xref="S2.SS3.SSS1.p2.5.m5.2.3.2"><mtext id="S2.SS3.SSS1.p2.5.m5.2.3.2.cmml" xref="S2.SS3.SSS1.p2.5.m5.2.3.2">SameItem</mtext></ci><interval closure="open" id="S2.SS3.SSS1.p2.5.m5.2.3.3.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.2.3.3.2"><ci id="S2.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1">𝑖</ci><ci id="S2.SS3.SSS1.p2.5.m5.2.2.cmml" xref="S2.SS3.SSS1.p2.5.m5.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.5.m5.2c">\text{SameItem}(i,j)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.5.m5.2d">SameItem ( italic_i , italic_j )</annotation></semantics></math> returns <span class="ltx_text ltx_markedasmath" id="S2.SS3.SSS1.p2.9.1">True</span> if tokens <math alttext="i" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.7.m7.1"><semantics id="S2.SS3.SSS1.p2.7.m7.1a"><mi id="S2.SS3.SSS1.p2.7.m7.1.1" xref="S2.SS3.SSS1.p2.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.7.m7.1b"><ci id="S2.SS3.SSS1.p2.7.m7.1.1.cmml" xref="S2.SS3.SSS1.p2.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.7.m7.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.8.m8.1"><semantics id="S2.SS3.SSS1.p2.8.m8.1a"><mi id="S2.SS3.SSS1.p2.8.m8.1.1" xref="S2.SS3.SSS1.p2.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.8.m8.1b"><ci id="S2.SS3.SSS1.p2.8.m8.1.1.cmml" xref="S2.SS3.SSS1.p2.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.8.m8.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.8.m8.1d">italic_j</annotation></semantics></math> belong to the same item (or either of it is the collaborative representation), and <span class="ltx_text ltx_markedasmath" id="S2.SS3.SSS1.p2.9.2">False</span> otherwise.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2. </span>Collaborative Knowledge Injection</h4>
<div class="ltx_para" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.1">LLM serves as an effective sequential model in <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS2.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.1.1.m1.1"><semantics id="S2.SS3.SSS2.p1.1.1.m1.1a"><msub id="S2.SS3.SSS2.p1.1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p1.1.1.m1.1.1a" xref="S2.SS3.SSS2.p1.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS3.SSS2.p1.1.1.m1.1.1.1" xref="S2.SS3.SSS2.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.1.m1.1b"><apply id="S2.SS3.SSS2.p1.1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.1.m1.1.1"><ci id="S2.SS3.SSS2.p1.1.1.m1.1.1.1a.cmml" xref="S2.SS3.SSS2.p1.1.1.m1.1.1.1"><mtext id="S2.SS3.SSS2.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS3.SSS2.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span>.
However, the long-term user/item collaborative knowledge is beneficial to SRS <cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib27" title="">2024</a>)</cite> and LLM may not capture them well from long inputs.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p2">
<p class="ltx_p" id="S2.SS3.SSS2.p2.7">We conduct collaborative knowledge injection and incorporate user preferences and item properties learned from a CF model <math alttext="M_{cf}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.1.m1.1"><semantics id="S2.SS3.SSS2.p2.1.m1.1a"><msub id="S2.SS3.SSS2.p2.1.m1.1.1" xref="S2.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p2.1.m1.1.1.2" xref="S2.SS3.SSS2.p2.1.m1.1.1.2.cmml">M</mi><mrow id="S2.SS3.SSS2.p2.1.m1.1.1.3" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">c</mi><mo id="S2.SS3.SSS2.p2.1.m1.1.1.3.1" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.1.m1.1.1.3.3" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.3.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.1.m1.1b"><apply id="S2.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.2">𝑀</ci><apply id="S2.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.3"><times id="S2.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.1"></times><ci id="S2.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.2">𝑐</ci><ci id="S2.SS3.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.1.m1.1c">M_{cf}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_c italic_f end_POSTSUBSCRIPT</annotation></semantics></math> into the attention calculation of context masking, using them as cues to enhance <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS2.p2.7.1">MixRec</span>’s learning.
<math alttext="M_{cf}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.2.m2.1"><semantics id="S2.SS3.SSS2.p2.2.m2.1a"><msub id="S2.SS3.SSS2.p2.2.m2.1.1" xref="S2.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p2.2.m2.1.1.2" xref="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml">M</mi><mrow id="S2.SS3.SSS2.p2.2.m2.1.1.3" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S2.SS3.SSS2.p2.2.m2.1.1.3.2" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.2.cmml">c</mi><mo id="S2.SS3.SSS2.p2.2.m2.1.1.3.1" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.2.m2.1.1.3.3" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.3.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.2.m2.1b"><apply id="S2.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.2">𝑀</ci><apply id="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.3"><times id="S2.SS3.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.1"></times><ci id="S2.SS3.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.2">𝑐</ci><ci id="S2.SS3.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.2.m2.1c">M_{cf}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_c italic_f end_POSTSUBSCRIPT</annotation></semantics></math> can be any embedding-based recommendation model trained over user-item interaction matrix using standard loss function <math alttext="\mathcal{L}_{cf}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.3.m3.1"><semantics id="S2.SS3.SSS2.p2.3.m3.1a"><msub id="S2.SS3.SSS2.p2.3.m3.1.1" xref="S2.SS3.SSS2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS2.p2.3.m3.1.1.2" xref="S2.SS3.SSS2.p2.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S2.SS3.SSS2.p2.3.m3.1.1.3" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.cmml"><mi id="S2.SS3.SSS2.p2.3.m3.1.1.3.2" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.2.cmml">c</mi><mo id="S2.SS3.SSS2.p2.3.m3.1.1.3.1" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.3.m3.1.1.3.3" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.3.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.3.m3.1b"><apply id="S2.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.2">ℒ</ci><apply id="S2.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.3"><times id="S2.SS3.SSS2.p2.3.m3.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.1"></times><ci id="S2.SS3.SSS2.p2.3.m3.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.2">𝑐</ci><ci id="S2.SS3.SSS2.p2.3.m3.1.1.3.3.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.3.m3.1c">\mathcal{L}_{cf}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_f end_POSTSUBSCRIPT</annotation></semantics></math> (e.g., Bayesian Personalized Ranking) and it encodes each user <math alttext="u" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.4.m4.1"><semantics id="S2.SS3.SSS2.p2.4.m4.1a"><mi id="S2.SS3.SSS2.p2.4.m4.1.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.4.m4.1b"><ci id="S2.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.4.m4.1d">italic_u</annotation></semantics></math> and item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.5.m5.1"><semantics id="S2.SS3.SSS2.p2.5.m5.1a"><mi id="S2.SS3.SSS2.p2.5.m5.1.1" xref="S2.SS3.SSS2.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.5.m5.1b"><ci id="S2.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.5.m5.1d">italic_i</annotation></semantics></math> into the representations <math alttext="\mathbf{e}_{u}^{user}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.6.m6.1"><semantics id="S2.SS3.SSS2.p2.6.m6.1a"><msubsup id="S2.SS3.SSS2.p2.6.m6.1.1" xref="S2.SS3.SSS2.p2.6.m6.1.1.cmml"><mi id="S2.SS3.SSS2.p2.6.m6.1.1.2.2" xref="S2.SS3.SSS2.p2.6.m6.1.1.2.2.cmml">𝐞</mi><mi id="S2.SS3.SSS2.p2.6.m6.1.1.2.3" xref="S2.SS3.SSS2.p2.6.m6.1.1.2.3.cmml">u</mi><mrow id="S2.SS3.SSS2.p2.6.m6.1.1.3" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.cmml"><mi id="S2.SS3.SSS2.p2.6.m6.1.1.3.2" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.2.cmml">u</mi><mo id="S2.SS3.SSS2.p2.6.m6.1.1.3.1" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.6.m6.1.1.3.3" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.3.cmml">s</mi><mo id="S2.SS3.SSS2.p2.6.m6.1.1.3.1a" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.6.m6.1.1.3.4" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p2.6.m6.1.1.3.1b" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.6.m6.1.1.3.5" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.5.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.6.m6.1b"><apply id="S2.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.6.m6.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.6.m6.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.2.2">𝐞</ci><ci id="S2.SS3.SSS2.p2.6.m6.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.2.3">𝑢</ci></apply><apply id="S2.SS3.SSS2.p2.6.m6.1.1.3.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.3"><times id="S2.SS3.SSS2.p2.6.m6.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.1"></times><ci id="S2.SS3.SSS2.p2.6.m6.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.2">𝑢</ci><ci id="S2.SS3.SSS2.p2.6.m6.1.1.3.3.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.3">𝑠</ci><ci id="S2.SS3.SSS2.p2.6.m6.1.1.3.4.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p2.6.m6.1.1.3.5.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1.3.5">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.6.m6.1c">\mathbf{e}_{u}^{user}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.6.m6.1d">bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u italic_s italic_e italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{e}_{i}^{item}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.7.m7.1"><semantics id="S2.SS3.SSS2.p2.7.m7.1a"><msubsup id="S2.SS3.SSS2.p2.7.m7.1.1" xref="S2.SS3.SSS2.p2.7.m7.1.1.cmml"><mi id="S2.SS3.SSS2.p2.7.m7.1.1.2.2" xref="S2.SS3.SSS2.p2.7.m7.1.1.2.2.cmml">𝐞</mi><mi id="S2.SS3.SSS2.p2.7.m7.1.1.2.3" xref="S2.SS3.SSS2.p2.7.m7.1.1.2.3.cmml">i</mi><mrow id="S2.SS3.SSS2.p2.7.m7.1.1.3" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.cmml"><mi id="S2.SS3.SSS2.p2.7.m7.1.1.3.2" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.2.cmml">i</mi><mo id="S2.SS3.SSS2.p2.7.m7.1.1.3.1" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.7.m7.1.1.3.3" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.3.cmml">t</mi><mo id="S2.SS3.SSS2.p2.7.m7.1.1.3.1a" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.7.m7.1.1.3.4" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p2.7.m7.1.1.3.1b" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p2.7.m7.1.1.3.5" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.7.m7.1b"><apply id="S2.SS3.SSS2.p2.7.m7.1.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.7.m7.1.1.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p2.7.m7.1.1.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.7.m7.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.7.m7.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.2.2">𝐞</ci><ci id="S2.SS3.SSS2.p2.7.m7.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S2.SS3.SSS2.p2.7.m7.1.1.3.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.3"><times id="S2.SS3.SSS2.p2.7.m7.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.1"></times><ci id="S2.SS3.SSS2.p2.7.m7.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.2">𝑖</ci><ci id="S2.SS3.SSS2.p2.7.m7.1.1.3.3.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.3">𝑡</ci><ci id="S2.SS3.SSS2.p2.7.m7.1.1.3.4.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p2.7.m7.1.1.3.5.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1.3.5">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.7.m7.1c">\mathbf{e}_{i}^{item}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.7.m7.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p3">
<p class="ltx_p" id="S2.SS3.SSS2.p3.7"><span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS2.p3.7.1">MixRec</span> first uses a single-layer feedforward network to project <math alttext="\mathbf{e}_{u}^{user}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.1.m1.1"><semantics id="S2.SS3.SSS2.p3.1.m1.1a"><msubsup id="S2.SS3.SSS2.p3.1.m1.1.1" xref="S2.SS3.SSS2.p3.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p3.1.m1.1.1.2.2" xref="S2.SS3.SSS2.p3.1.m1.1.1.2.2.cmml">𝐞</mi><mi id="S2.SS3.SSS2.p3.1.m1.1.1.2.3" xref="S2.SS3.SSS2.p3.1.m1.1.1.2.3.cmml">u</mi><mrow id="S2.SS3.SSS2.p3.1.m1.1.1.3" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS2.p3.1.m1.1.1.3.2" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.2.cmml">u</mi><mo id="S2.SS3.SSS2.p3.1.m1.1.1.3.1" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.1.m1.1.1.3.3" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.3.cmml">s</mi><mo id="S2.SS3.SSS2.p3.1.m1.1.1.3.1a" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.1.m1.1.1.3.4" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p3.1.m1.1.1.3.1b" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.1.m1.1.1.3.5" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.5.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.1.m1.1b"><apply id="S2.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p3.1.m1.1.1.2.2.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.2.2">𝐞</ci><ci id="S2.SS3.SSS2.p3.1.m1.1.1.2.3.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.2.3">𝑢</ci></apply><apply id="S2.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.3"><times id="S2.SS3.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.1"></times><ci id="S2.SS3.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.2">𝑢</ci><ci id="S2.SS3.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.3">𝑠</ci><ci id="S2.SS3.SSS2.p3.1.m1.1.1.3.4.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p3.1.m1.1.1.3.5.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1.3.5">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.1.m1.1c">\mathbf{e}_{u}^{user}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.1.m1.1d">bold_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u italic_s italic_e italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{e}_{i}^{item}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.2.m2.1"><semantics id="S2.SS3.SSS2.p3.2.m2.1a"><msubsup id="S2.SS3.SSS2.p3.2.m2.1.1" xref="S2.SS3.SSS2.p3.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p3.2.m2.1.1.2.2" xref="S2.SS3.SSS2.p3.2.m2.1.1.2.2.cmml">𝐞</mi><mi id="S2.SS3.SSS2.p3.2.m2.1.1.2.3" xref="S2.SS3.SSS2.p3.2.m2.1.1.2.3.cmml">i</mi><mrow id="S2.SS3.SSS2.p3.2.m2.1.1.3" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.cmml"><mi id="S2.SS3.SSS2.p3.2.m2.1.1.3.2" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.2.cmml">i</mi><mo id="S2.SS3.SSS2.p3.2.m2.1.1.3.1" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.2.m2.1.1.3.3" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.3.cmml">t</mi><mo id="S2.SS3.SSS2.p3.2.m2.1.1.3.1a" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.2.m2.1.1.3.4" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p3.2.m2.1.1.3.1b" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.2.m2.1.1.3.5" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.2.m2.1b"><apply id="S2.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.2.m2.1.1.2.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p3.2.m2.1.1.2.2.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.2.2">𝐞</ci><ci id="S2.SS3.SSS2.p3.2.m2.1.1.2.3.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S2.SS3.SSS2.p3.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.3"><times id="S2.SS3.SSS2.p3.2.m2.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.1"></times><ci id="S2.SS3.SSS2.p3.2.m2.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.2">𝑖</ci><ci id="S2.SS3.SSS2.p3.2.m2.1.1.3.3.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.3">𝑡</ci><ci id="S2.SS3.SSS2.p3.2.m2.1.1.3.4.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p3.2.m2.1.1.3.5.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.5">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.2.m2.1c">\mathbf{e}_{i}^{item}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.2.m2.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> to new representation spaces <math alttext="\mathbf{h}^{user}_{u}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.3.m3.1"><semantics id="S2.SS3.SSS2.p3.3.m3.1a"><msubsup id="S2.SS3.SSS2.p3.3.m3.1.1" xref="S2.SS3.SSS2.p3.3.m3.1.1.cmml"><mi id="S2.SS3.SSS2.p3.3.m3.1.1.2.2" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.2.cmml">𝐡</mi><mi id="S2.SS3.SSS2.p3.3.m3.1.1.3" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.cmml">u</mi><mrow id="S2.SS3.SSS2.p3.3.m3.1.1.2.3" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.cmml"><mi id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.2" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.2.cmml">u</mi><mo id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.3" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.3.cmml">s</mi><mo id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1a" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.4" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1b" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.5" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.5.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.3.m3.1b"><apply id="S2.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p3.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.3.m3.1.1.2.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.3.m3.1.1.2.2.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.2">𝐡</ci><apply id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3"><times id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.1"></times><ci id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.2.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.2">𝑢</ci><ci id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.3.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.3">𝑠</ci><ci id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.4.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.5.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.5">𝑟</ci></apply></apply><ci id="S2.SS3.SSS2.p3.3.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.3.m3.1c">\mathbf{h}^{user}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.3.m3.1d">bold_h start_POSTSUPERSCRIPT italic_u italic_s italic_e italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}^{item}_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.4.m4.1"><semantics id="S2.SS3.SSS2.p3.4.m4.1a"><msubsup id="S2.SS3.SSS2.p3.4.m4.1.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p3.4.m4.1.1.2.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.2.cmml">𝐡</mi><mi id="S2.SS3.SSS2.p3.4.m4.1.1.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.cmml">i</mi><mrow id="S2.SS3.SSS2.p3.4.m4.1.1.2.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.cmml"><mi id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.2.cmml">i</mi><mo id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.3.cmml">t</mi><mo id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1a" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.4" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1b" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.5" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.4.m4.1b"><apply id="S2.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p3.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.4.m4.1.1.2.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.4.m4.1.1.2.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.2">𝐡</ci><apply id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3"><times id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.1"></times><ci id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.2">𝑖</ci><ci id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.3">𝑡</ci><ci id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.4.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p3.4.m4.1.1.2.3.5.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.3.5">𝑚</ci></apply></apply><ci id="S2.SS3.SSS2.p3.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.4.m4.1c">\mathbf{h}^{item}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.4.m4.1d">bold_h start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with the same dimension as LLM’s hidden state, respectively.
Then, we concatenate the projected collaborative representations <math alttext="\mathbf{h}^{user}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.5.m5.1"><semantics id="S2.SS3.SSS2.p3.5.m5.1a"><msup id="S2.SS3.SSS2.p3.5.m5.1.1" xref="S2.SS3.SSS2.p3.5.m5.1.1.cmml"><mi id="S2.SS3.SSS2.p3.5.m5.1.1.2" xref="S2.SS3.SSS2.p3.5.m5.1.1.2.cmml">𝐡</mi><mrow id="S2.SS3.SSS2.p3.5.m5.1.1.3" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.cmml"><mi id="S2.SS3.SSS2.p3.5.m5.1.1.3.2" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.2.cmml">u</mi><mo id="S2.SS3.SSS2.p3.5.m5.1.1.3.1" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.5.m5.1.1.3.3" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.3.cmml">s</mi><mo id="S2.SS3.SSS2.p3.5.m5.1.1.3.1a" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.5.m5.1.1.3.4" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p3.5.m5.1.1.3.1b" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.5.m5.1.1.3.5" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.5.cmml">r</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.5.m5.1b"><apply id="S2.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.5.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.5.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1.2">𝐡</ci><apply id="S2.SS3.SSS2.p3.5.m5.1.1.3.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1.3"><times id="S2.SS3.SSS2.p3.5.m5.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.1"></times><ci id="S2.SS3.SSS2.p3.5.m5.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.2">𝑢</ci><ci id="S2.SS3.SSS2.p3.5.m5.1.1.3.3.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.3">𝑠</ci><ci id="S2.SS3.SSS2.p3.5.m5.1.1.3.4.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p3.5.m5.1.1.3.5.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1.3.5">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.5.m5.1c">\mathbf{h}^{user}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.5.m5.1d">bold_h start_POSTSUPERSCRIPT italic_u italic_s italic_e italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{h}^{item}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.6.m6.1"><semantics id="S2.SS3.SSS2.p3.6.m6.1a"><msup id="S2.SS3.SSS2.p3.6.m6.1.1" xref="S2.SS3.SSS2.p3.6.m6.1.1.cmml"><mi id="S2.SS3.SSS2.p3.6.m6.1.1.2" xref="S2.SS3.SSS2.p3.6.m6.1.1.2.cmml">𝐡</mi><mrow id="S2.SS3.SSS2.p3.6.m6.1.1.3" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.cmml"><mi id="S2.SS3.SSS2.p3.6.m6.1.1.3.2" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.2.cmml">i</mi><mo id="S2.SS3.SSS2.p3.6.m6.1.1.3.1" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.6.m6.1.1.3.3" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.3.cmml">t</mi><mo id="S2.SS3.SSS2.p3.6.m6.1.1.3.1a" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.6.m6.1.1.3.4" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.4.cmml">e</mi><mo id="S2.SS3.SSS2.p3.6.m6.1.1.3.1b" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p3.6.m6.1.1.3.5" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.5.cmml">m</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.6.m6.1b"><apply id="S2.SS3.SSS2.p3.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.6.m6.1.1.1.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.6.m6.1.1.2.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.2">𝐡</ci><apply id="S2.SS3.SSS2.p3.6.m6.1.1.3.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.3"><times id="S2.SS3.SSS2.p3.6.m6.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.1"></times><ci id="S2.SS3.SSS2.p3.6.m6.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.2">𝑖</ci><ci id="S2.SS3.SSS2.p3.6.m6.1.1.3.3.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.3">𝑡</ci><ci id="S2.SS3.SSS2.p3.6.m6.1.1.3.4.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.4">𝑒</ci><ci id="S2.SS3.SSS2.p3.6.m6.1.1.3.5.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.5">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.6.m6.1c">\mathbf{h}^{item}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.6.m6.1d">bold_h start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> (i.e., <math alttext="\mathbf{c}^{k}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.7.m7.1"><semantics id="S2.SS3.SSS2.p3.7.m7.1a"><msup id="S2.SS3.SSS2.p3.7.m7.1.1" xref="S2.SS3.SSS2.p3.7.m7.1.1.cmml"><mi id="S2.SS3.SSS2.p3.7.m7.1.1.2" xref="S2.SS3.SSS2.p3.7.m7.1.1.2.cmml">𝐜</mi><mi id="S2.SS3.SSS2.p3.7.m7.1.1.3" xref="S2.SS3.SSS2.p3.7.m7.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.7.m7.1b"><apply id="S2.SS3.SSS2.p3.7.m7.1.1.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.7.m7.1.1.1.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.7.m7.1.1.2.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1.2">𝐜</ci><ci id="S2.SS3.SSS2.p3.7.m7.1.1.3.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.7.m7.1c">\mathbf{c}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.7.m7.1d">bold_c start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.F4" title="Figure 4 ‣ 2.2.4. Distinguish Hard Samples ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>) with hidden states of inputs to each LLM layer.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.3. </span>Dynamic Adaptive Mixture-of-Experts</h4>
<div class="ltx_para" id="S2.SS3.SSS3.p1">
<p class="ltx_p" id="S2.SS3.SSS3.p1.6">For the <math alttext="k" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.1.m1.1"><semantics id="S2.SS3.SSS3.p1.1.m1.1a"><mi id="S2.SS3.SSS3.p1.1.m1.1.1" xref="S2.SS3.SSS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.1.m1.1b"><ci id="S2.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.1.m1.1d">italic_k</annotation></semantics></math>-th layer in LLM, similar to the standard way to calculate causal masking, <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS3.p1.6.1">MixRec</span> derives two hidden states <math alttext="\mathbf{q}^{k}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.2.m2.1"><semantics id="S2.SS3.SSS3.p1.2.m2.1a"><msup id="S2.SS3.SSS3.p1.2.m2.1.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.SSS3.p1.2.m2.1.1.2" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml">𝐪</mi><mi id="S2.SS3.SSS3.p1.2.m2.1.1.3" xref="S2.SS3.SSS3.p1.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.2.m2.1b"><apply id="S2.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.2">𝐪</ci><ci id="S2.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.2.m2.1c">\mathbf{q}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.2.m2.1d">bold_q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{p}^{k}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.3.m3.1"><semantics id="S2.SS3.SSS3.p1.3.m3.1a"><msup id="S2.SS3.SSS3.p1.3.m3.1.1" xref="S2.SS3.SSS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.SSS3.p1.3.m3.1.1.2" xref="S2.SS3.SSS3.p1.3.m3.1.1.2.cmml">𝐩</mi><mi id="S2.SS3.SSS3.p1.3.m3.1.1.3" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.3.m3.1b"><apply id="S2.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.2">𝐩</ci><ci id="S2.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.3.m3.1c">\mathbf{p}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.3.m3.1d">bold_p start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> for the input <math alttext="\mathbf{h}^{k-1}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.4.m4.1"><semantics id="S2.SS3.SSS3.p1.4.m4.1a"><msup id="S2.SS3.SSS3.p1.4.m4.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml">𝐡</mi><mrow id="S2.SS3.SSS3.p1.4.m4.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.3.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.2.cmml">k</mi><mo id="S2.SS3.SSS3.p1.4.m4.1.1.3.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.1.cmml">−</mo><mn id="S2.SS3.SSS3.p1.4.m4.1.1.3.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.4.m4.1b"><apply id="S2.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.2">𝐡</ci><apply id="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3"><minus id="S2.SS3.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.1"></minus><ci id="S2.SS3.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.2">𝑘</ci><cn id="S2.SS3.SSS3.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.4.m4.1c">\mathbf{h}^{k-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.4.m4.1d">bold_h start_POSTSUPERSCRIPT italic_k - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> using causal masking <math alttext="\textbf{MASK}_{\text{causal}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.5.m5.1"><semantics id="S2.SS3.SSS3.p1.5.m5.1a"><msub id="S2.SS3.SSS3.p1.5.m5.1.1" xref="S2.SS3.SSS3.p1.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS3.p1.5.m5.1.1.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.2a.cmml">MASK</mtext><mtext id="S2.SS3.SSS3.p1.5.m5.1.1.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3a.cmml">causal</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.5.m5.1b"><apply id="S2.SS3.SSS3.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.5.m5.1.1.2a.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2">MASK</mtext></ci><ci id="S2.SS3.SSS3.p1.5.m5.1.1.3a.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3"><mtext id="S2.SS3.SSS3.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p1.5.m5.1.1.3">causal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.5.m5.1c">\textbf{MASK}_{\text{causal}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.5.m5.1d">MASK start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT</annotation></semantics></math> and context masking <math alttext="\textbf{MASK}_{\text{context}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.6.m6.1"><semantics id="S2.SS3.SSS3.p1.6.m6.1a"><msub id="S2.SS3.SSS3.p1.6.m6.1.1" xref="S2.SS3.SSS3.p1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS3.p1.6.m6.1.1.2" xref="S2.SS3.SSS3.p1.6.m6.1.1.2a.cmml">MASK</mtext><mtext id="S2.SS3.SSS3.p1.6.m6.1.1.3" xref="S2.SS3.SSS3.p1.6.m6.1.1.3a.cmml">context</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.6.m6.1b"><apply id="S2.SS3.SSS3.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.6.m6.1.1.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.6.m6.1.1.2a.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS3.p1.6.m6.1.1.2.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1.2">MASK</mtext></ci><ci id="S2.SS3.SSS3.p1.6.m6.1.1.3a.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1.3"><mtext id="S2.SS3.SSS3.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p1.6.m6.1.1.3">context</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.6.m6.1c">\textbf{MASK}_{\text{context}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.6.m6.1d">MASK start_POSTSUBSCRIPT context end_POSTSUBSCRIPT</annotation></semantics></math>, respectively:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.Ex7">
<tbody id="S2.Ex7X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{q}^{k}" class="ltx_Math" display="inline" id="S2.Ex7X.2.1.1.m1.1"><semantics id="S2.Ex7X.2.1.1.m1.1a"><msup id="S2.Ex7X.2.1.1.m1.1.1" xref="S2.Ex7X.2.1.1.m1.1.1.cmml"><mi id="S2.Ex7X.2.1.1.m1.1.1.2" mathsize="90%" xref="S2.Ex7X.2.1.1.m1.1.1.2.cmml">𝐪</mi><mi id="S2.Ex7X.2.1.1.m1.1.1.3" mathsize="90%" xref="S2.Ex7X.2.1.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.Ex7X.2.1.1.m1.1b"><apply id="S2.Ex7X.2.1.1.m1.1.1.cmml" xref="S2.Ex7X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex7X.2.1.1.m1.1.1.1.cmml" xref="S2.Ex7X.2.1.1.m1.1.1">superscript</csymbol><ci id="S2.Ex7X.2.1.1.m1.1.1.2.cmml" xref="S2.Ex7X.2.1.1.m1.1.1.2">𝐪</ci><ci id="S2.Ex7X.2.1.1.m1.1.1.3.cmml" xref="S2.Ex7X.2.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7X.2.1.1.m1.1c">\displaystyle\mathbf{q}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex7X.2.1.1.m1.1d">bold_q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Self-Attention}(\mathbf{h}^{k-1},\textbf{MASK}_{\text{%
causal}})" class="ltx_Math" display="inline" id="S2.Ex7X.3.2.2.m1.2"><semantics id="S2.Ex7X.3.2.2.m1.2a"><mrow id="S2.Ex7X.3.2.2.m1.2.2" xref="S2.Ex7X.3.2.2.m1.2.2.cmml"><mi id="S2.Ex7X.3.2.2.m1.2.2.4" xref="S2.Ex7X.3.2.2.m1.2.2.4.cmml"></mi><mo id="S2.Ex7X.3.2.2.m1.2.2.3" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.3.cmml">=</mo><mrow id="S2.Ex7X.3.2.2.m1.2.2.2" xref="S2.Ex7X.3.2.2.m1.2.2.2.cmml"><mtext id="S2.Ex7X.3.2.2.m1.2.2.2.4" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.4a.cmml">Self-Attention</mtext><mo id="S2.Ex7X.3.2.2.m1.2.2.2.3" xref="S2.Ex7X.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.Ex7X.3.2.2.m1.2.2.2.2.2" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.3.cmml"><mo id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.3" maxsize="90%" minsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.3.cmml">(</mo><msup id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.2.cmml">𝐡</mi><mrow id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.1" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.4" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.2" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.2a.cmml">MASK</mtext><mtext id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.3" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.3a.cmml">causal</mtext></msub><mo id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.5" maxsize="90%" minsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex7X.3.2.2.m1.2b"><apply id="S2.Ex7X.3.2.2.m1.2.2.cmml" xref="S2.Ex7X.3.2.2.m1.2.2"><eq id="S2.Ex7X.3.2.2.m1.2.2.3.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S2.Ex7X.3.2.2.m1.2.2.4.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.4">absent</csymbol><apply id="S2.Ex7X.3.2.2.m1.2.2.2.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2"><times id="S2.Ex7X.3.2.2.m1.2.2.2.3.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2.3"></times><ci id="S2.Ex7X.3.2.2.m1.2.2.2.4a.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2.4"><mtext id="S2.Ex7X.3.2.2.m1.2.2.2.4.cmml" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.4">Self-Attention</mtext></ci><interval closure="open" id="S2.Ex7X.3.2.2.m1.2.2.2.2.3.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2"><apply id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.2">𝐡</ci><apply id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3"><minus id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.1"></minus><ci id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.2">𝑘</ci><cn id="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.Ex7X.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.2a.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.2.cmml" mathsize="90%" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.2">MASK</mtext></ci><ci id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.3a.cmml" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.3"><mtext id="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.3.cmml" mathsize="63%" xref="S2.Ex7X.3.2.2.m1.2.2.2.2.2.2.3">causal</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7X.3.2.2.m1.2c">\displaystyle=\text{Self-Attention}(\mathbf{h}^{k-1},\textbf{MASK}_{\text{%
causal}})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex7X.3.2.2.m1.2d">= Self-Attention ( bold_h start_POSTSUPERSCRIPT italic_k - 1 end_POSTSUPERSCRIPT , MASK start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex7Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{p}^{k}" class="ltx_Math" display="inline" id="S2.Ex7Xa.2.1.1.m1.1"><semantics id="S2.Ex7Xa.2.1.1.m1.1a"><msup id="S2.Ex7Xa.2.1.1.m1.1.1" xref="S2.Ex7Xa.2.1.1.m1.1.1.cmml"><mi id="S2.Ex7Xa.2.1.1.m1.1.1.2" mathsize="90%" xref="S2.Ex7Xa.2.1.1.m1.1.1.2.cmml">𝐩</mi><mi id="S2.Ex7Xa.2.1.1.m1.1.1.3" mathsize="90%" xref="S2.Ex7Xa.2.1.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.Ex7Xa.2.1.1.m1.1b"><apply id="S2.Ex7Xa.2.1.1.m1.1.1.cmml" xref="S2.Ex7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex7Xa.2.1.1.m1.1.1.1.cmml" xref="S2.Ex7Xa.2.1.1.m1.1.1">superscript</csymbol><ci id="S2.Ex7Xa.2.1.1.m1.1.1.2.cmml" xref="S2.Ex7Xa.2.1.1.m1.1.1.2">𝐩</ci><ci id="S2.Ex7Xa.2.1.1.m1.1.1.3.cmml" xref="S2.Ex7Xa.2.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7Xa.2.1.1.m1.1c">\displaystyle\mathbf{p}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex7Xa.2.1.1.m1.1d">bold_p start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Self-Attention}(\mathbf{h}^{k-1},\textbf{MASK}_{\text{%
context}})" class="ltx_Math" display="inline" id="S2.Ex7Xa.3.2.2.m1.2"><semantics id="S2.Ex7Xa.3.2.2.m1.2a"><mrow id="S2.Ex7Xa.3.2.2.m1.2.2" xref="S2.Ex7Xa.3.2.2.m1.2.2.cmml"><mi id="S2.Ex7Xa.3.2.2.m1.2.2.4" xref="S2.Ex7Xa.3.2.2.m1.2.2.4.cmml"></mi><mo id="S2.Ex7Xa.3.2.2.m1.2.2.3" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.3.cmml">=</mo><mrow id="S2.Ex7Xa.3.2.2.m1.2.2.2" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.cmml"><mtext id="S2.Ex7Xa.3.2.2.m1.2.2.2.4" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.4a.cmml">Self-Attention</mtext><mo id="S2.Ex7Xa.3.2.2.m1.2.2.2.3" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.3.cmml"><mo id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.3" maxsize="90%" minsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.3.cmml">(</mo><msup id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">𝐡</mi><mrow id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.1" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.4" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.2" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.2a.cmml">MASK</mtext><mtext id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.3" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.3a.cmml">context</mtext></msub><mo id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.5" maxsize="90%" minsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex7Xa.3.2.2.m1.2b"><apply id="S2.Ex7Xa.3.2.2.m1.2.2.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2"><eq id="S2.Ex7Xa.3.2.2.m1.2.2.3.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S2.Ex7Xa.3.2.2.m1.2.2.4.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.4">absent</csymbol><apply id="S2.Ex7Xa.3.2.2.m1.2.2.2.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2"><times id="S2.Ex7Xa.3.2.2.m1.2.2.2.3.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.3"></times><ci id="S2.Ex7Xa.3.2.2.m1.2.2.2.4a.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.4"><mtext id="S2.Ex7Xa.3.2.2.m1.2.2.2.4.cmml" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.4">Self-Attention</mtext></ci><interval closure="open" id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.3.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2"><apply id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.2">𝐡</ci><apply id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3"><minus id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.1"></minus><ci id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝑘</ci><cn id="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.Ex7Xa.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.2a.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.2.cmml" mathsize="90%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.2">MASK</mtext></ci><ci id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.3a.cmml" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.3"><mtext id="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.3.cmml" mathsize="63%" xref="S2.Ex7Xa.3.2.2.m1.2.2.2.2.2.2.3">context</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex7Xa.3.2.2.m1.2c">\displaystyle=\text{Self-Attention}(\mathbf{h}^{k-1},\textbf{MASK}_{\text{%
context}})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex7Xa.3.2.2.m1.2d">= Self-Attention ( bold_h start_POSTSUPERSCRIPT italic_k - 1 end_POSTSUPERSCRIPT , MASK start_POSTSUBSCRIPT context end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p1.9">where <math alttext="\mathbf{h}^{k-1}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.7.m1.1"><semantics id="S2.SS3.SSS3.p1.7.m1.1a"><msup id="S2.SS3.SSS3.p1.7.m1.1.1" xref="S2.SS3.SSS3.p1.7.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.7.m1.1.1.2" xref="S2.SS3.SSS3.p1.7.m1.1.1.2.cmml">𝐡</mi><mrow id="S2.SS3.SSS3.p1.7.m1.1.1.3" xref="S2.SS3.SSS3.p1.7.m1.1.1.3.cmml"><mi id="S2.SS3.SSS3.p1.7.m1.1.1.3.2" xref="S2.SS3.SSS3.p1.7.m1.1.1.3.2.cmml">k</mi><mo id="S2.SS3.SSS3.p1.7.m1.1.1.3.1" xref="S2.SS3.SSS3.p1.7.m1.1.1.3.1.cmml">−</mo><mn id="S2.SS3.SSS3.p1.7.m1.1.1.3.3" xref="S2.SS3.SSS3.p1.7.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.7.m1.1b"><apply id="S2.SS3.SSS3.p1.7.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.7.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.7.m1.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.7.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.7.m1.1.1.2">𝐡</ci><apply id="S2.SS3.SSS3.p1.7.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p1.7.m1.1.1.3"><minus id="S2.SS3.SSS3.p1.7.m1.1.1.3.1.cmml" xref="S2.SS3.SSS3.p1.7.m1.1.1.3.1"></minus><ci id="S2.SS3.SSS3.p1.7.m1.1.1.3.2.cmml" xref="S2.SS3.SSS3.p1.7.m1.1.1.3.2">𝑘</ci><cn id="S2.SS3.SSS3.p1.7.m1.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.7.m1.1c">\mathbf{h}^{k-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.7.m1.1d">bold_h start_POSTSUPERSCRIPT italic_k - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is the hidden state of a token from the <math alttext="(k-1)" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.8.m2.1"><semantics id="S2.SS3.SSS3.p1.8.m2.1a"><mrow id="S2.SS3.SSS3.p1.8.m2.1.1.1" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.cmml"><mo id="S2.SS3.SSS3.p1.8.m2.1.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS3.p1.8.m2.1.1.1.1" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.8.m2.1.1.1.1.2" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.2.cmml">k</mi><mo id="S2.SS3.SSS3.p1.8.m2.1.1.1.1.1" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.1.cmml">−</mo><mn id="S2.SS3.SSS3.p1.8.m2.1.1.1.1.3" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS3.SSS3.p1.8.m2.1.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.8.m2.1b"><apply id="S2.SS3.SSS3.p1.8.m2.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.8.m2.1.1.1"><minus id="S2.SS3.SSS3.p1.8.m2.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.1"></minus><ci id="S2.SS3.SSS3.p1.8.m2.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.2">𝑘</ci><cn id="S2.SS3.SSS3.p1.8.m2.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.8.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.8.m2.1c">(k-1)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.8.m2.1d">( italic_k - 1 )</annotation></semantics></math>-th layer.
See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A3" title="Appendix C Attention Calculation ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">C</span></a> for the definition of <math alttext="\text{Self-Attention}(\mathbf{h},\textbf{MASK})" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.9.m3.2"><semantics id="S2.SS3.SSS3.p1.9.m3.2a"><mrow id="S2.SS3.SSS3.p1.9.m3.2.3" xref="S2.SS3.SSS3.p1.9.m3.2.3.cmml"><mtext id="S2.SS3.SSS3.p1.9.m3.2.3.2" xref="S2.SS3.SSS3.p1.9.m3.2.3.2a.cmml">Self-Attention</mtext><mo id="S2.SS3.SSS3.p1.9.m3.2.3.1" xref="S2.SS3.SSS3.p1.9.m3.2.3.1.cmml">⁢</mo><mrow id="S2.SS3.SSS3.p1.9.m3.2.3.3.2" xref="S2.SS3.SSS3.p1.9.m3.2.3.3.1.cmml"><mo id="S2.SS3.SSS3.p1.9.m3.2.3.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p1.9.m3.2.3.3.1.cmml">(</mo><mi id="S2.SS3.SSS3.p1.9.m3.1.1" xref="S2.SS3.SSS3.p1.9.m3.1.1.cmml">𝐡</mi><mo id="S2.SS3.SSS3.p1.9.m3.2.3.3.2.2" xref="S2.SS3.SSS3.p1.9.m3.2.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS3.p1.9.m3.2.2" xref="S2.SS3.SSS3.p1.9.m3.2.2a.cmml">MASK</mtext><mo id="S2.SS3.SSS3.p1.9.m3.2.3.3.2.3" stretchy="false" xref="S2.SS3.SSS3.p1.9.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.9.m3.2b"><apply id="S2.SS3.SSS3.p1.9.m3.2.3.cmml" xref="S2.SS3.SSS3.p1.9.m3.2.3"><times id="S2.SS3.SSS3.p1.9.m3.2.3.1.cmml" xref="S2.SS3.SSS3.p1.9.m3.2.3.1"></times><ci id="S2.SS3.SSS3.p1.9.m3.2.3.2a.cmml" xref="S2.SS3.SSS3.p1.9.m3.2.3.2"><mtext id="S2.SS3.SSS3.p1.9.m3.2.3.2.cmml" xref="S2.SS3.SSS3.p1.9.m3.2.3.2">Self-Attention</mtext></ci><interval closure="open" id="S2.SS3.SSS3.p1.9.m3.2.3.3.1.cmml" xref="S2.SS3.SSS3.p1.9.m3.2.3.3.2"><ci id="S2.SS3.SSS3.p1.9.m3.1.1.cmml" xref="S2.SS3.SSS3.p1.9.m3.1.1">𝐡</ci><ci id="S2.SS3.SSS3.p1.9.m3.2.2a.cmml" xref="S2.SS3.SSS3.p1.9.m3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS3.p1.9.m3.2.2.cmml" xref="S2.SS3.SSS3.p1.9.m3.2.2">MASK</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.9.m3.2c">\text{Self-Attention}(\mathbf{h},\textbf{MASK})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.9.m3.2d">Self-Attention ( bold_h , MASK )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p2">
<p class="ltx_p" id="S2.SS3.SSS3.p2.1">The next question is how to balance two masking mechanisms.
Inspired by mixture-of-experts (MoE) <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib3" title="">2024</a>)</cite>, we opt to design a dynamic adaptive MoE (DAMoE) to mix intra-item and inter-item information.
Different parts of DAMoE, which are also called “experts”, specialize in one sequential information.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p3">
<p class="ltx_p" id="S2.SS3.SSS3.p3.4">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.F4" title="Figure 4 ‣ 2.2.4. Distinguish Hard Samples ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> depicts DAMoE.
Original LLM layers in <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS3.p3.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.1.1.m1.1"><semantics id="S2.SS3.SSS3.p3.1.1.m1.1a"><msub id="S2.SS3.SSS3.p3.1.1.m1.1.1" xref="S2.SS3.SSS3.p3.1.1.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p3.1.1.m1.1.1a" xref="S2.SS3.SSS3.p3.1.1.m1.1.1.cmml"></mi><mtext id="S2.SS3.SSS3.p3.1.1.m1.1.1.1" xref="S2.SS3.SSS3.p3.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.1.1.m1.1b"><apply id="S2.SS3.SSS3.p3.1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p3.1.1.m1.1.1"><ci id="S2.SS3.SSS3.p3.1.1.m1.1.1.1a.cmml" xref="S2.SS3.SSS3.p3.1.1.m1.1.1.1"><mtext id="S2.SS3.SSS3.p3.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S2.SS3.SSS3.p3.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>) are replaced with DAMoE layers.
Each DAMoE layer consists of two “expert networks” <math alttext="\mathcal{F}_{\text{causal}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.2.m1.1"><semantics id="S2.SS3.SSS3.p3.2.m1.1a"><msub id="S2.SS3.SSS3.p3.2.m1.1.1" xref="S2.SS3.SSS3.p3.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p3.2.m1.1.1.2" xref="S2.SS3.SSS3.p3.2.m1.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p3.2.m1.1.1.3" xref="S2.SS3.SSS3.p3.2.m1.1.1.3a.cmml">causal</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.2.m1.1b"><apply id="S2.SS3.SSS3.p3.2.m1.1.1.cmml" xref="S2.SS3.SSS3.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.2.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p3.2.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p3.2.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p3.2.m1.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p3.2.m1.1.1.3a.cmml" xref="S2.SS3.SSS3.p3.2.m1.1.1.3"><mtext id="S2.SS3.SSS3.p3.2.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p3.2.m1.1.1.3">causal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.2.m1.1c">\mathcal{F}_{\text{causal}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.2.m1.1d">caligraphic_F start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{F}_{\text{context}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.3.m2.1"><semantics id="S2.SS3.SSS3.p3.3.m2.1a"><msub id="S2.SS3.SSS3.p3.3.m2.1.1" xref="S2.SS3.SSS3.p3.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p3.3.m2.1.1.2" xref="S2.SS3.SSS3.p3.3.m2.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p3.3.m2.1.1.3" xref="S2.SS3.SSS3.p3.3.m2.1.1.3a.cmml">context</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.3.m2.1b"><apply id="S2.SS3.SSS3.p3.3.m2.1.1.cmml" xref="S2.SS3.SSS3.p3.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p3.3.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p3.3.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p3.3.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p3.3.m2.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p3.3.m2.1.1.3a.cmml" xref="S2.SS3.SSS3.p3.3.m2.1.1.3"><mtext id="S2.SS3.SSS3.p3.3.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p3.3.m2.1.1.3">context</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.3.m2.1c">\mathcal{F}_{\text{context}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.3.m2.1d">caligraphic_F start_POSTSUBSCRIPT context end_POSTSUBSCRIPT</annotation></semantics></math>, a “gating network” <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p3.4.m3.1"><semantics id="S2.SS3.SSS3.p3.4.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p3.4.m3.1.1" xref="S2.SS3.SSS3.p3.4.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p3.4.m3.1b"><ci id="S2.SS3.SSS3.p3.4.m3.1.1.cmml" xref="S2.SS3.SSS3.p3.4.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p3.4.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p3.4.m3.1d">caligraphic_G</annotation></semantics></math>, and one recommendation adapter.
The key of DAMoE is the designs of the layer-wise dynamic selection of mixture of parameter-efficient experts (MoPE) and the gating network.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS3.p4">
<p class="ltx_p" id="S2.SS3.SSS3.p4.3"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS3.p4.3.1">Layer-Wise Dynamic Selection of MoPE.</span>
To reduce the computation demands,
we freeze feedforward networks and attention modules and only fine-tune the expert networks (<math alttext="\mathcal{F}_{\text{causal}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p4.1.m1.1"><semantics id="S2.SS3.SSS3.p4.1.m1.1a"><msub id="S2.SS3.SSS3.p4.1.m1.1.1" xref="S2.SS3.SSS3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p4.1.m1.1.1.2" xref="S2.SS3.SSS3.p4.1.m1.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p4.1.m1.1.1.3" xref="S2.SS3.SSS3.p4.1.m1.1.1.3a.cmml">causal</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p4.1.m1.1b"><apply id="S2.SS3.SSS3.p4.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p4.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p4.1.m1.1.1.3a.cmml" xref="S2.SS3.SSS3.p4.1.m1.1.1.3"><mtext id="S2.SS3.SSS3.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p4.1.m1.1.1.3">causal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p4.1.m1.1c">\mathcal{F}_{\text{causal}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p4.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{F}_{\text{context}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p4.2.m2.1"><semantics id="S2.SS3.SSS3.p4.2.m2.1a"><msub id="S2.SS3.SSS3.p4.2.m2.1.1" xref="S2.SS3.SSS3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p4.2.m2.1.1.2" xref="S2.SS3.SSS3.p4.2.m2.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p4.2.m2.1.1.3" xref="S2.SS3.SSS3.p4.2.m2.1.1.3a.cmml">context</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p4.2.m2.1b"><apply id="S2.SS3.SSS3.p4.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p4.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p4.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p4.2.m2.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p4.2.m2.1.1.3a.cmml" xref="S2.SS3.SSS3.p4.2.m2.1.1.3"><mtext id="S2.SS3.SSS3.p4.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p4.2.m2.1.1.3">context</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p4.2.m2.1c">\mathcal{F}_{\text{context}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p4.2.m2.1d">caligraphic_F start_POSTSUBSCRIPT context end_POSTSUBSCRIPT</annotation></semantics></math>) and the gating network (<math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p4.3.m3.1"><semantics id="S2.SS3.SSS3.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p4.3.m3.1.1" xref="S2.SS3.SSS3.p4.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p4.3.m3.1b"><ci id="S2.SS3.SSS3.p4.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p4.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p4.3.m3.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p4.3.m3.1d">caligraphic_G</annotation></semantics></math>).
This way, expert networks can also be viewed as adapters in PEFT.
Hence, in the following, the terms “adapter expert” and “expert network” are used interchangeably.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p5">
<p class="ltx_p" id="S2.SS3.SSS3.p5.2">There are various choices for the adapter.
Enforcing a unified design for MoE in all DAMoE layers is inflexible and will bring sub-optimal performance.
However, manually tuning the architecture of adapter experts is a time-consuming and human-intensive process.
Hence, we propose a dynamic selection method to automatically find the appropriate design of adapter experts for DAMoE.
In <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS3.p5.2.1">MixRec</span>, we focus on choosing between serial adapter and parallel adapter for <math alttext="\mathcal{F}_{\text{causal}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p5.1.m1.1"><semantics id="S2.SS3.SSS3.p5.1.m1.1a"><msub id="S2.SS3.SSS3.p5.1.m1.1.1" xref="S2.SS3.SSS3.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p5.1.m1.1.1.2" xref="S2.SS3.SSS3.p5.1.m1.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p5.1.m1.1.1.3" xref="S2.SS3.SSS3.p5.1.m1.1.1.3a.cmml">causal</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p5.1.m1.1b"><apply id="S2.SS3.SSS3.p5.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p5.1.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p5.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p5.1.m1.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p5.1.m1.1.1.3a.cmml" xref="S2.SS3.SSS3.p5.1.m1.1.1.3"><mtext id="S2.SS3.SSS3.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p5.1.m1.1.1.3">causal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p5.1.m1.1c">\mathcal{F}_{\text{causal}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p5.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{F}_{\text{context}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p5.2.m2.1"><semantics id="S2.SS3.SSS3.p5.2.m2.1a"><msub id="S2.SS3.SSS3.p5.2.m2.1.1" xref="S2.SS3.SSS3.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p5.2.m2.1.1.2" xref="S2.SS3.SSS3.p5.2.m2.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p5.2.m2.1.1.3" xref="S2.SS3.SSS3.p5.2.m2.1.1.3a.cmml">context</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p5.2.m2.1b"><apply id="S2.SS3.SSS3.p5.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p5.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p5.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p5.2.m2.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p5.2.m2.1.1.3a.cmml" xref="S2.SS3.SSS3.p5.2.m2.1.1.3"><mtext id="S2.SS3.SSS3.p5.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p5.2.m2.1.1.3">context</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p5.2.m2.1c">\mathcal{F}_{\text{context}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p5.2.m2.1d">caligraphic_F start_POSTSUBSCRIPT context end_POSTSUBSCRIPT</annotation></semantics></math> since they are most representative adapter designs <cite class="ltx_cite ltx_citemacro_citep">(Han et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib13" title="">2024</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A4.F14" title="Figure 14 ‣ Appendix D Demonstration of Serial Adapter and Parallel Adapter ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">14</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A4" title="Appendix D Demonstration of Serial Adapter and Parallel Adapter ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">D</span></a> provides visualization):</p>
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.1.1">Serial Adapter:</span> A two-layer feedforward network is positioned between the attention module and the gating network:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\text{Adapter}_{\text{Serial}}(\mathbf{h})=\text{Adapter}\big{(}\text{%
Self-Attention}(\mathbf{h},\textbf{MASK})\big{)}." class="ltx_Math" display="block" id="S2.Ex8.m1.4"><semantics id="S2.Ex8.m1.4a"><mrow id="S2.Ex8.m1.4.4.1" xref="S2.Ex8.m1.4.4.1.1.cmml"><mrow id="S2.Ex8.m1.4.4.1.1" xref="S2.Ex8.m1.4.4.1.1.cmml"><mrow id="S2.Ex8.m1.4.4.1.1.3" xref="S2.Ex8.m1.4.4.1.1.3.cmml"><msub id="S2.Ex8.m1.4.4.1.1.3.2" xref="S2.Ex8.m1.4.4.1.1.3.2.cmml"><mtext id="S2.Ex8.m1.4.4.1.1.3.2.2" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.3.2.2a.cmml">Adapter</mtext><mtext id="S2.Ex8.m1.4.4.1.1.3.2.3" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.3.2.3a.cmml">Serial</mtext></msub><mo id="S2.Ex8.m1.4.4.1.1.3.1" xref="S2.Ex8.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex8.m1.4.4.1.1.3.3.2" xref="S2.Ex8.m1.4.4.1.1.3.cmml"><mo id="S2.Ex8.m1.4.4.1.1.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex8.m1.4.4.1.1.3.cmml">(</mo><mi id="S2.Ex8.m1.1.1" mathsize="90%" xref="S2.Ex8.m1.1.1.cmml">𝐡</mi><mo id="S2.Ex8.m1.4.4.1.1.3.3.2.2" maxsize="90%" minsize="90%" xref="S2.Ex8.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex8.m1.4.4.1.1.2" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.Ex8.m1.4.4.1.1.1" xref="S2.Ex8.m1.4.4.1.1.1.cmml"><mtext id="S2.Ex8.m1.4.4.1.1.1.3" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.1.3a.cmml">Adapter</mtext><mo id="S2.Ex8.m1.4.4.1.1.1.2" xref="S2.Ex8.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex8.m1.4.4.1.1.1.1.1" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.Ex8.m1.4.4.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex8.m1.4.4.1.1.1.1.1.1" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.cmml"><mtext id="S2.Ex8.m1.4.4.1.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.2a.cmml">Self-Attention</mtext><mo id="S2.Ex8.m1.4.4.1.1.1.1.1.1.1" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.2" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mo id="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.Ex8.m1.2.2" mathsize="90%" xref="S2.Ex8.m1.2.2.cmml">𝐡</mi><mo id="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.2.2" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S2.Ex8.m1.3.3" mathsize="90%" xref="S2.Ex8.m1.3.3a.cmml">MASK</mtext><mo id="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.2.3" maxsize="90%" minsize="90%" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex8.m1.4.4.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex8.m1.4.4.1.2" lspace="0em" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex8.m1.4b"><apply id="S2.Ex8.m1.4.4.1.1.cmml" xref="S2.Ex8.m1.4.4.1"><eq id="S2.Ex8.m1.4.4.1.1.2.cmml" xref="S2.Ex8.m1.4.4.1.1.2"></eq><apply id="S2.Ex8.m1.4.4.1.1.3.cmml" xref="S2.Ex8.m1.4.4.1.1.3"><times id="S2.Ex8.m1.4.4.1.1.3.1.cmml" xref="S2.Ex8.m1.4.4.1.1.3.1"></times><apply id="S2.Ex8.m1.4.4.1.1.3.2.cmml" xref="S2.Ex8.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex8.m1.4.4.1.1.3.2.1.cmml" xref="S2.Ex8.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S2.Ex8.m1.4.4.1.1.3.2.2a.cmml" xref="S2.Ex8.m1.4.4.1.1.3.2.2"><mtext id="S2.Ex8.m1.4.4.1.1.3.2.2.cmml" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.3.2.2">Adapter</mtext></ci><ci id="S2.Ex8.m1.4.4.1.1.3.2.3a.cmml" xref="S2.Ex8.m1.4.4.1.1.3.2.3"><mtext id="S2.Ex8.m1.4.4.1.1.3.2.3.cmml" mathsize="63%" xref="S2.Ex8.m1.4.4.1.1.3.2.3">Serial</mtext></ci></apply><ci id="S2.Ex8.m1.1.1.cmml" xref="S2.Ex8.m1.1.1">𝐡</ci></apply><apply id="S2.Ex8.m1.4.4.1.1.1.cmml" xref="S2.Ex8.m1.4.4.1.1.1"><times id="S2.Ex8.m1.4.4.1.1.1.2.cmml" xref="S2.Ex8.m1.4.4.1.1.1.2"></times><ci id="S2.Ex8.m1.4.4.1.1.1.3a.cmml" xref="S2.Ex8.m1.4.4.1.1.1.3"><mtext id="S2.Ex8.m1.4.4.1.1.1.3.cmml" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.1.3">Adapter</mtext></ci><apply id="S2.Ex8.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.4.4.1.1.1.1.1"><times id="S2.Ex8.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S2.Ex8.m1.4.4.1.1.1.1.1.1.2a.cmml" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.2"><mtext id="S2.Ex8.m1.4.4.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.2">Self-Attention</mtext></ci><interval closure="open" id="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex8.m1.4.4.1.1.1.1.1.1.3.2"><ci id="S2.Ex8.m1.2.2.cmml" xref="S2.Ex8.m1.2.2">𝐡</ci><ci id="S2.Ex8.m1.3.3a.cmml" xref="S2.Ex8.m1.3.3"><mtext class="ltx_mathvariant_bold" id="S2.Ex8.m1.3.3.cmml" mathsize="90%" xref="S2.Ex8.m1.3.3">MASK</mtext></ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex8.m1.4c">\small\text{Adapter}_{\text{Serial}}(\mathbf{h})=\text{Adapter}\big{(}\text{%
Self-Attention}(\mathbf{h},\textbf{MASK})\big{)}.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex8.m1.4d">Adapter start_POSTSUBSCRIPT Serial end_POSTSUBSCRIPT ( bold_h ) = Adapter ( Self-Attention ( bold_h , MASK ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1">Parallel Adapter:</span> A two-layer feedforward network runs alongside the attention module, i.e., it reorganizes the adapter as a parallel side network:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\text{Adapter}_{\text{Parallel}}(\mathbf{h})=\Big{(}\text{Self-Attention%
}(\mathbf{h},\textbf{MASK})+\text{Adapter}(\mathbf{h})\Big{)}/2." class="ltx_Math" display="block" id="S2.Ex9.m1.5"><semantics id="S2.Ex9.m1.5a"><mrow id="S2.Ex9.m1.5.5.1" xref="S2.Ex9.m1.5.5.1.1.cmml"><mrow id="S2.Ex9.m1.5.5.1.1" xref="S2.Ex9.m1.5.5.1.1.cmml"><mrow id="S2.Ex9.m1.5.5.1.1.3" xref="S2.Ex9.m1.5.5.1.1.3.cmml"><msub id="S2.Ex9.m1.5.5.1.1.3.2" xref="S2.Ex9.m1.5.5.1.1.3.2.cmml"><mtext id="S2.Ex9.m1.5.5.1.1.3.2.2" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.3.2.2a.cmml">Adapter</mtext><mtext id="S2.Ex9.m1.5.5.1.1.3.2.3" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.3.2.3a.cmml">Parallel</mtext></msub><mo id="S2.Ex9.m1.5.5.1.1.3.1" xref="S2.Ex9.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex9.m1.5.5.1.1.3.3.2" xref="S2.Ex9.m1.5.5.1.1.3.cmml"><mo id="S2.Ex9.m1.5.5.1.1.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex9.m1.5.5.1.1.3.cmml">(</mo><mi id="S2.Ex9.m1.1.1" mathsize="90%" xref="S2.Ex9.m1.1.1.cmml">𝐡</mi><mo id="S2.Ex9.m1.5.5.1.1.3.3.2.2" maxsize="90%" minsize="90%" xref="S2.Ex9.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex9.m1.5.5.1.1.2" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.2.cmml">=</mo><mrow id="S2.Ex9.m1.5.5.1.1.1" xref="S2.Ex9.m1.5.5.1.1.1.cmml"><mrow id="S2.Ex9.m1.5.5.1.1.1.1.1" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex9.m1.5.5.1.1.1.1.1.1" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.cmml"><mtext id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.2" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.2a.cmml">Self-Attention</mtext><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.1" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.1.cmml"><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.Ex9.m1.2.2" mathsize="90%" xref="S2.Ex9.m1.2.2.cmml">𝐡</mi><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.2.2" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S2.Ex9.m1.3.3" mathsize="90%" xref="S2.Ex9.m1.3.3a.cmml">MASK</mtext><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.2.3" maxsize="90%" minsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.cmml"><mtext id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.2" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.2a.cmml">Adapter</mtext><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.1" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.3.2" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.cmml"><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.Ex9.m1.4.4" mathsize="90%" xref="S2.Ex9.m1.4.4.cmml">𝐡</mi><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.3.2.2" maxsize="90%" minsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex9.m1.5.5.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex9.m1.5.5.1.1.1.2" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S2.Ex9.m1.5.5.1.1.1.2.cmml">/</mo><mn id="S2.Ex9.m1.5.5.1.1.1.3" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.3.cmml">2</mn></mrow></mrow><mo id="S2.Ex9.m1.5.5.1.2" lspace="0em" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex9.m1.5b"><apply id="S2.Ex9.m1.5.5.1.1.cmml" xref="S2.Ex9.m1.5.5.1"><eq id="S2.Ex9.m1.5.5.1.1.2.cmml" xref="S2.Ex9.m1.5.5.1.1.2"></eq><apply id="S2.Ex9.m1.5.5.1.1.3.cmml" xref="S2.Ex9.m1.5.5.1.1.3"><times id="S2.Ex9.m1.5.5.1.1.3.1.cmml" xref="S2.Ex9.m1.5.5.1.1.3.1"></times><apply id="S2.Ex9.m1.5.5.1.1.3.2.cmml" xref="S2.Ex9.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex9.m1.5.5.1.1.3.2.1.cmml" xref="S2.Ex9.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S2.Ex9.m1.5.5.1.1.3.2.2a.cmml" xref="S2.Ex9.m1.5.5.1.1.3.2.2"><mtext id="S2.Ex9.m1.5.5.1.1.3.2.2.cmml" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.3.2.2">Adapter</mtext></ci><ci id="S2.Ex9.m1.5.5.1.1.3.2.3a.cmml" xref="S2.Ex9.m1.5.5.1.1.3.2.3"><mtext id="S2.Ex9.m1.5.5.1.1.3.2.3.cmml" mathsize="63%" xref="S2.Ex9.m1.5.5.1.1.3.2.3">Parallel</mtext></ci></apply><ci id="S2.Ex9.m1.1.1.cmml" xref="S2.Ex9.m1.1.1">𝐡</ci></apply><apply id="S2.Ex9.m1.5.5.1.1.1.cmml" xref="S2.Ex9.m1.5.5.1.1.1"><divide id="S2.Ex9.m1.5.5.1.1.1.2.cmml" xref="S2.Ex9.m1.5.5.1.1.1.2"></divide><apply id="S2.Ex9.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1"><plus id="S2.Ex9.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.1"></plus><apply id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2"><times id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.1"></times><ci id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.2a.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.2"><mtext id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.2.cmml" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.2">Self-Attention</mtext></ci><interval closure="open" id="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.2.3.2"><ci id="S2.Ex9.m1.2.2.cmml" xref="S2.Ex9.m1.2.2">𝐡</ci><ci id="S2.Ex9.m1.3.3a.cmml" xref="S2.Ex9.m1.3.3"><mtext class="ltx_mathvariant_bold" id="S2.Ex9.m1.3.3.cmml" mathsize="90%" xref="S2.Ex9.m1.3.3">MASK</mtext></ci></interval></apply><apply id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3"><times id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.1"></times><ci id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.2a.cmml" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.2"><mtext id="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.2.cmml" mathsize="90%" xref="S2.Ex9.m1.5.5.1.1.1.1.1.1.3.2">Adapter</mtext></ci><ci id="S2.Ex9.m1.4.4.cmml" xref="S2.Ex9.m1.4.4">𝐡</ci></apply></apply><cn id="S2.Ex9.m1.5.5.1.1.1.3.cmml" type="integer" xref="S2.Ex9.m1.5.5.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex9.m1.5c">\small\text{Adapter}_{\text{Parallel}}(\mathbf{h})=\Big{(}\text{Self-Attention%
}(\mathbf{h},\textbf{MASK})+\text{Adapter}(\mathbf{h})\Big{)}/2.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex9.m1.5d">Adapter start_POSTSUBSCRIPT Parallel end_POSTSUBSCRIPT ( bold_h ) = ( Self-Attention ( bold_h , MASK ) + Adapter ( bold_h ) ) / 2 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p6">
<p class="ltx_p" id="S2.SS3.SSS3.p6.8">In addition to expert networks <math alttext="\mathcal{F}_{\text{causal}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.1.m1.1"><semantics id="S2.SS3.SSS3.p6.1.m1.1a"><msub id="S2.SS3.SSS3.p6.1.m1.1.1" xref="S2.SS3.SSS3.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p6.1.m1.1.1.2" xref="S2.SS3.SSS3.p6.1.m1.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p6.1.m1.1.1.3" xref="S2.SS3.SSS3.p6.1.m1.1.1.3a.cmml">causal</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.1.m1.1b"><apply id="S2.SS3.SSS3.p6.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p6.1.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p6.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p6.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p6.1.m1.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p6.1.m1.1.1.3a.cmml" xref="S2.SS3.SSS3.p6.1.m1.1.1.3"><mtext id="S2.SS3.SSS3.p6.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p6.1.m1.1.1.3">causal</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.1.m1.1c">\mathcal{F}_{\text{causal}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT causal end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{F}_{\text{context}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.2.m2.1"><semantics id="S2.SS3.SSS3.p6.2.m2.1a"><msub id="S2.SS3.SSS3.p6.2.m2.1.1" xref="S2.SS3.SSS3.p6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p6.2.m2.1.1.2" xref="S2.SS3.SSS3.p6.2.m2.1.1.2.cmml">ℱ</mi><mtext id="S2.SS3.SSS3.p6.2.m2.1.1.3" xref="S2.SS3.SSS3.p6.2.m2.1.1.3a.cmml">context</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.2.m2.1b"><apply id="S2.SS3.SSS3.p6.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p6.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p6.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p6.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p6.2.m2.1.1.2">ℱ</ci><ci id="S2.SS3.SSS3.p6.2.m2.1.1.3a.cmml" xref="S2.SS3.SSS3.p6.2.m2.1.1.3"><mtext id="S2.SS3.SSS3.p6.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p6.2.m2.1.1.3">context</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.2.m2.1c">\mathcal{F}_{\text{context}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.2.m2.1d">caligraphic_F start_POSTSUBSCRIPT context end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text ltx_font_smallcaps" id="S2.SS3.SSS3.p6.8.1">MixRec</span> also searches the adapter architecture for the recommendation adapter.
In each part, either a serial adapter or a parallel adapter can be applied.
Given <math alttext="L" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.3.m3.1"><semantics id="S2.SS3.SSS3.p6.3.m3.1a"><mi id="S2.SS3.SSS3.p6.3.m3.1.1" xref="S2.SS3.SSS3.p6.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.3.m3.1b"><ci id="S2.SS3.SSS3.p6.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p6.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.3.m3.1d">italic_L</annotation></semantics></math> DAMoE layers, there are <math alttext="2^{3L}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.4.m4.1"><semantics id="S2.SS3.SSS3.p6.4.m4.1a"><msup id="S2.SS3.SSS3.p6.4.m4.1.1" xref="S2.SS3.SSS3.p6.4.m4.1.1.cmml"><mn id="S2.SS3.SSS3.p6.4.m4.1.1.2" xref="S2.SS3.SSS3.p6.4.m4.1.1.2.cmml">2</mn><mrow id="S2.SS3.SSS3.p6.4.m4.1.1.3" xref="S2.SS3.SSS3.p6.4.m4.1.1.3.cmml"><mn id="S2.SS3.SSS3.p6.4.m4.1.1.3.2" xref="S2.SS3.SSS3.p6.4.m4.1.1.3.2.cmml">3</mn><mo id="S2.SS3.SSS3.p6.4.m4.1.1.3.1" xref="S2.SS3.SSS3.p6.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS3.p6.4.m4.1.1.3.3" xref="S2.SS3.SSS3.p6.4.m4.1.1.3.3.cmml">L</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.4.m4.1b"><apply id="S2.SS3.SSS3.p6.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p6.4.m4.1.1.1.cmml" xref="S2.SS3.SSS3.p6.4.m4.1.1">superscript</csymbol><cn id="S2.SS3.SSS3.p6.4.m4.1.1.2.cmml" type="integer" xref="S2.SS3.SSS3.p6.4.m4.1.1.2">2</cn><apply id="S2.SS3.SSS3.p6.4.m4.1.1.3.cmml" xref="S2.SS3.SSS3.p6.4.m4.1.1.3"><times id="S2.SS3.SSS3.p6.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS3.p6.4.m4.1.1.3.1"></times><cn id="S2.SS3.SSS3.p6.4.m4.1.1.3.2.cmml" type="integer" xref="S2.SS3.SSS3.p6.4.m4.1.1.3.2">3</cn><ci id="S2.SS3.SSS3.p6.4.m4.1.1.3.3.cmml" xref="S2.SS3.SSS3.p6.4.m4.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.4.m4.1c">2^{3L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.4.m4.1d">2 start_POSTSUPERSCRIPT 3 italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> possible designs.
Hence, the search process for each DAMoE layer becomes tuning <math alttext="3L" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.5.m5.1"><semantics id="S2.SS3.SSS3.p6.5.m5.1a"><mrow id="S2.SS3.SSS3.p6.5.m5.1.1" xref="S2.SS3.SSS3.p6.5.m5.1.1.cmml"><mn id="S2.SS3.SSS3.p6.5.m5.1.1.2" xref="S2.SS3.SSS3.p6.5.m5.1.1.2.cmml">3</mn><mo id="S2.SS3.SSS3.p6.5.m5.1.1.1" xref="S2.SS3.SSS3.p6.5.m5.1.1.1.cmml">⁢</mo><mi id="S2.SS3.SSS3.p6.5.m5.1.1.3" xref="S2.SS3.SSS3.p6.5.m5.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.5.m5.1b"><apply id="S2.SS3.SSS3.p6.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p6.5.m5.1.1"><times id="S2.SS3.SSS3.p6.5.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p6.5.m5.1.1.1"></times><cn id="S2.SS3.SSS3.p6.5.m5.1.1.2.cmml" type="integer" xref="S2.SS3.SSS3.p6.5.m5.1.1.2">3</cn><ci id="S2.SS3.SSS3.p6.5.m5.1.1.3.cmml" xref="S2.SS3.SSS3.p6.5.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.5.m5.1c">3L</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.5.m5.1d">3 italic_L</annotation></semantics></math> binary, discrete parameters in the discrete space <math alttext="\text{\sout{$Z$}}=\text{\sout{$Z$}}^{(1)}\times\cdots\times\text{\sout{$Z$}}^{%
(3L)}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.6.m6.5"><semantics id="S2.SS3.SSS3.p6.6.m6.5a"><mrow id="S2.SS3.SSS3.p6.6.m6.5.6" xref="S2.SS3.SSS3.p6.6.m6.5.6.cmml"><mi class="ltx_ulem_sout" id="S2.SS3.SSS3.p6.6.m6.5.6.2" xref="S2.SS3.SSS3.p6.6.m6.5.6.2.cmml">Z</mi><mo id="S2.SS3.SSS3.p6.6.m6.5.6.1" xref="S2.SS3.SSS3.p6.6.m6.5.6.1.cmml">=</mo><mrow id="S2.SS3.SSS3.p6.6.m6.5.6.3" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.cmml"><msup id="S2.SS3.SSS3.p6.6.m6.5.6.3.2" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2.cmml"><mi class="ltx_ulem_sout" id="S2.SS3.SSS3.p6.6.m6.5.6.3.2.2" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2.2.cmml">Z</mi><mrow id="S2.SS3.SSS3.p6.6.m6.4.4.1.3" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2.cmml"><mo id="S2.SS3.SSS3.p6.6.m6.4.4.1.3.1" stretchy="false" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2.cmml">(</mo><mn id="S2.SS3.SSS3.p6.6.m6.4.4.1.1" xref="S2.SS3.SSS3.p6.6.m6.4.4.1.1.cmml">1</mn><mo id="S2.SS3.SSS3.p6.6.m6.4.4.1.3.2" stretchy="false" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2.cmml">)</mo></mrow></msup><mo id="S2.SS3.SSS3.p6.6.m6.5.6.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.1.cmml">×</mo><mi id="S2.SS3.SSS3.p6.6.m6.5.6.3.3" mathvariant="normal" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.3.cmml">⋯</mi><mo id="S2.SS3.SSS3.p6.6.m6.5.6.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.1.cmml">×</mo><msup id="S2.SS3.SSS3.p6.6.m6.5.6.3.4" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.4.cmml"><mi class="ltx_ulem_sout" id="S2.SS3.SSS3.p6.6.m6.5.6.3.4.2" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.4.2.cmml">Z</mi><mrow id="S2.SS3.SSS3.p6.6.m6.5.5.1.1" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.cmml"><mo id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.cmml"><mn id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.2" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.2.cmml">3</mn><mo id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.1" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.1.cmml">⁢</mo><mi id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.3" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.3.cmml">L</mi></mrow><mo id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.6.m6.5b"><apply id="S2.SS3.SSS3.p6.6.m6.5.6.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6"><eq id="S2.SS3.SSS3.p6.6.m6.5.6.1.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.1"></eq><ci id="S2.SS3.SSS3.p6.6.m6.5.6.2.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.2">𝑍</ci><apply id="S2.SS3.SSS3.p6.6.m6.5.6.3.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3"><times id="S2.SS3.SSS3.p6.6.m6.5.6.3.1.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.1"></times><apply id="S2.SS3.SSS3.p6.6.m6.5.6.3.2.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p6.6.m6.5.6.3.2.1.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2">superscript</csymbol><ci id="S2.SS3.SSS3.p6.6.m6.5.6.3.2.2.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.2.2">𝑍</ci><cn id="S2.SS3.SSS3.p6.6.m6.4.4.1.1.cmml" type="integer" xref="S2.SS3.SSS3.p6.6.m6.4.4.1.1">1</cn></apply><ci id="S2.SS3.SSS3.p6.6.m6.5.6.3.3.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.3">⋯</ci><apply id="S2.SS3.SSS3.p6.6.m6.5.6.3.4.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.4"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p6.6.m6.5.6.3.4.1.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.4">superscript</csymbol><ci id="S2.SS3.SSS3.p6.6.m6.5.6.3.4.2.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.6.3.4.2">𝑍</ci><apply id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1"><times id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.1.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.1"></times><cn id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.2.cmml" type="integer" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.2">3</cn><ci id="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.3.cmml" xref="S2.SS3.SSS3.p6.6.m6.5.5.1.1.1.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.6.m6.5c">\text{\sout{$Z$}}=\text{\sout{$Z$}}^{(1)}\times\cdots\times\text{\sout{$Z$}}^{%
(3L)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.6.m6.5d">italic_Z = italic_Z start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT × ⋯ × italic_Z start_POSTSUPERSCRIPT ( 3 italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math>.
In the following, we use <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.7.m7.1"><semantics id="S2.SS3.SSS3.p6.7.m7.1a"><mi id="S2.SS3.SSS3.p6.7.m7.1.1" xref="S2.SS3.SSS3.p6.7.m7.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.7.m7.1b"><ci id="S2.SS3.SSS3.p6.7.m7.1.1.cmml" xref="S2.SS3.SSS3.p6.7.m7.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.7.m7.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.7.m7.1d">bold_z</annotation></semantics></math> to denote the vector <math alttext="(z^{(1)},\cdots,z^{(3L)})" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p6.8.m8.5"><semantics id="S2.SS3.SSS3.p6.8.m8.5a"><mrow id="S2.SS3.SSS3.p6.8.m8.5.5.2" xref="S2.SS3.SSS3.p6.8.m8.5.5.3.cmml"><mo id="S2.SS3.SSS3.p6.8.m8.5.5.2.3" stretchy="false" xref="S2.SS3.SSS3.p6.8.m8.5.5.3.cmml">(</mo><msup id="S2.SS3.SSS3.p6.8.m8.4.4.1.1" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1.cmml"><mi id="S2.SS3.SSS3.p6.8.m8.4.4.1.1.2" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1.2.cmml">z</mi><mrow id="S2.SS3.SSS3.p6.8.m8.1.1.1.3" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1.cmml"><mo id="S2.SS3.SSS3.p6.8.m8.1.1.1.3.1" stretchy="false" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1.cmml">(</mo><mn id="S2.SS3.SSS3.p6.8.m8.1.1.1.1" xref="S2.SS3.SSS3.p6.8.m8.1.1.1.1.cmml">1</mn><mo id="S2.SS3.SSS3.p6.8.m8.1.1.1.3.2" stretchy="false" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS3.SSS3.p6.8.m8.5.5.2.4" xref="S2.SS3.SSS3.p6.8.m8.5.5.3.cmml">,</mo><mi id="S2.SS3.SSS3.p6.8.m8.3.3" mathvariant="normal" xref="S2.SS3.SSS3.p6.8.m8.3.3.cmml">⋯</mi><mo id="S2.SS3.SSS3.p6.8.m8.5.5.2.5" xref="S2.SS3.SSS3.p6.8.m8.5.5.3.cmml">,</mo><msup id="S2.SS3.SSS3.p6.8.m8.5.5.2.2" xref="S2.SS3.SSS3.p6.8.m8.5.5.2.2.cmml"><mi id="S2.SS3.SSS3.p6.8.m8.5.5.2.2.2" xref="S2.SS3.SSS3.p6.8.m8.5.5.2.2.2.cmml">z</mi><mrow id="S2.SS3.SSS3.p6.8.m8.2.2.1.1" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.cmml"><mo id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.cmml"><mn id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.2" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.2.cmml">3</mn><mo id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.1" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.1.cmml">⁢</mo><mi id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.3" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.3.cmml">L</mi></mrow><mo id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS3.SSS3.p6.8.m8.5.5.2.6" stretchy="false" xref="S2.SS3.SSS3.p6.8.m8.5.5.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p6.8.m8.5b"><vector id="S2.SS3.SSS3.p6.8.m8.5.5.3.cmml" xref="S2.SS3.SSS3.p6.8.m8.5.5.2"><apply id="S2.SS3.SSS3.p6.8.m8.4.4.1.1.cmml" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p6.8.m8.4.4.1.1.1.cmml" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p6.8.m8.4.4.1.1.2.cmml" xref="S2.SS3.SSS3.p6.8.m8.4.4.1.1.2">𝑧</ci><cn id="S2.SS3.SSS3.p6.8.m8.1.1.1.1.cmml" type="integer" xref="S2.SS3.SSS3.p6.8.m8.1.1.1.1">1</cn></apply><ci id="S2.SS3.SSS3.p6.8.m8.3.3.cmml" xref="S2.SS3.SSS3.p6.8.m8.3.3">⋯</ci><apply id="S2.SS3.SSS3.p6.8.m8.5.5.2.2.cmml" xref="S2.SS3.SSS3.p6.8.m8.5.5.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p6.8.m8.5.5.2.2.1.cmml" xref="S2.SS3.SSS3.p6.8.m8.5.5.2.2">superscript</csymbol><ci id="S2.SS3.SSS3.p6.8.m8.5.5.2.2.2.cmml" xref="S2.SS3.SSS3.p6.8.m8.5.5.2.2.2">𝑧</ci><apply id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.cmml" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1"><times id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.1"></times><cn id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.2.cmml" type="integer" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.2">3</cn><ci id="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.3.cmml" xref="S2.SS3.SSS3.p6.8.m8.2.2.1.1.1.3">𝐿</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p6.8.m8.5c">(z^{(1)},\cdots,z^{(3L)})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p6.8.m8.5d">( italic_z start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , ⋯ , italic_z start_POSTSUPERSCRIPT ( 3 italic_L ) end_POSTSUPERSCRIPT )</annotation></semantics></math> of which each element is a binary parameter.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p7">
<p class="ltx_p" id="S2.SS3.SSS3.p7.2">Bayesian optimization (BO) <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib51" title="">2023</a>)</cite> is a popular method for black-box optimization that can be applied in this search task.
BO uses a probabilistic surrogate model of the objective function <math alttext="f" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p7.1.m1.1"><semantics id="S2.SS3.SSS3.p7.1.m1.1a"><mi id="S2.SS3.SSS3.p7.1.m1.1.1" xref="S2.SS3.SSS3.p7.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p7.1.m1.1b"><ci id="S2.SS3.SSS3.p7.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p7.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p7.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p7.1.m1.1d">italic_f</annotation></semantics></math> (we use Mean Reciprocal Rank) and an acquisition function (AF) that provides utility values for evaluation during optimization.
The maximizer of AF is selected as the next design to evaluate.
We use the Gaussian process (GP) as the surrogate model.
AF <math alttext="\alpha(\bm{z})" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p7.2.m2.1"><semantics id="S2.SS3.SSS3.p7.2.m2.1a"><mrow id="S2.SS3.SSS3.p7.2.m2.1.2" xref="S2.SS3.SSS3.p7.2.m2.1.2.cmml"><mi id="S2.SS3.SSS3.p7.2.m2.1.2.2" xref="S2.SS3.SSS3.p7.2.m2.1.2.2.cmml">α</mi><mo id="S2.SS3.SSS3.p7.2.m2.1.2.1" xref="S2.SS3.SSS3.p7.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.SSS3.p7.2.m2.1.2.3.2" xref="S2.SS3.SSS3.p7.2.m2.1.2.cmml"><mo id="S2.SS3.SSS3.p7.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p7.2.m2.1.2.cmml">(</mo><mi id="S2.SS3.SSS3.p7.2.m2.1.1" xref="S2.SS3.SSS3.p7.2.m2.1.1.cmml">𝒛</mi><mo id="S2.SS3.SSS3.p7.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS3.p7.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p7.2.m2.1b"><apply id="S2.SS3.SSS3.p7.2.m2.1.2.cmml" xref="S2.SS3.SSS3.p7.2.m2.1.2"><times id="S2.SS3.SSS3.p7.2.m2.1.2.1.cmml" xref="S2.SS3.SSS3.p7.2.m2.1.2.1"></times><ci id="S2.SS3.SSS3.p7.2.m2.1.2.2.cmml" xref="S2.SS3.SSS3.p7.2.m2.1.2.2">𝛼</ci><ci id="S2.SS3.SSS3.p7.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p7.2.m2.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p7.2.m2.1c">\alpha(\bm{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p7.2.m2.1d">italic_α ( bold_italic_z )</annotation></semantics></math> uses the surrogate models’ posterior distribution to quantify the value of evaluating a new design.
As the inputs to BO are binary values in our case, optimizing AF is more difficult as gradient-based methods can not be directly applied.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p8">
<p class="ltx_p" id="S2.SS3.SSS3.p8.3">Following Daulton et al. <cite class="ltx_cite ltx_citemacro_citep">(Daulton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib6" title="">2022</a>)</cite>, we reparameterize the optimization problem by introducing a discrete probability distribution <math alttext="p(\bm{Z}|\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p8.1.m1.1"><semantics id="S2.SS3.SSS3.p8.1.m1.1a"><mrow id="S2.SS3.SSS3.p8.1.m1.1.1" xref="S2.SS3.SSS3.p8.1.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p8.1.m1.1.1.3" xref="S2.SS3.SSS3.p8.1.m1.1.1.3.cmml">p</mi><mo id="S2.SS3.SSS3.p8.1.m1.1.1.2" xref="S2.SS3.SSS3.p8.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.SSS3.p8.1.m1.1.1.1.1" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.2" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.2.cmml">𝒁</mi><mo fence="false" id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.1" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.3" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p8.1.m1.1b"><apply id="S2.SS3.SSS3.p8.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p8.1.m1.1.1"><times id="S2.SS3.SSS3.p8.1.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p8.1.m1.1.1.2"></times><ci id="S2.SS3.SSS3.p8.1.m1.1.1.3.cmml" xref="S2.SS3.SSS3.p8.1.m1.1.1.3">𝑝</ci><apply id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.2">𝒁</ci><ci id="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p8.1.m1.1.1.1.1.1.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p8.1.m1.1c">p(\bm{Z}|\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p8.1.m1.1d">italic_p ( bold_italic_Z | bold_italic_θ )</annotation></semantics></math> parameterized by continuous parameter vector <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p8.2.m2.1"><semantics id="S2.SS3.SSS3.p8.2.m2.1a"><mi id="S2.SS3.SSS3.p8.2.m2.1.1" xref="S2.SS3.SSS3.p8.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p8.2.m2.1b"><ci id="S2.SS3.SSS3.p8.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p8.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p8.2.m2.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p8.2.m2.1d">bold_italic_θ</annotation></semantics></math> over a random variable <math alttext="\bm{Z}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p8.3.m3.1"><semantics id="S2.SS3.SSS3.p8.3.m3.1a"><mi id="S2.SS3.SSS3.p8.3.m3.1.1" xref="S2.SS3.SSS3.p8.3.m3.1.1.cmml">𝒁</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p8.3.m3.1b"><ci id="S2.SS3.SSS3.p8.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p8.3.m3.1.1">𝒁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p8.3.m3.1c">\bm{Z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p8.3.m3.1d">bold_italic_Z</annotation></semantics></math> sampled from Bernoulli distribution.
Alg. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#alg1" title="Algorithm 1 ‣ Appendix E Bayesian Optimization with Reparameterization ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A5" title="Appendix E Bayesian Optimization with Reparameterization ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">E</span></a> illustrates Bayesian optimization with reparameterization.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS3.p9">
<p class="ltx_p" id="S2.SS3.SSS3.p9.7">Then, we can design the probabilistic objective (PO):</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathbb{E}_{\bm{Z}\sim p(\bm{Z}|{\bm{\theta}})}[\alpha(\bm{Z})]." class="ltx_Math" display="block" id="S2.Ex10.m1.3"><semantics id="S2.Ex10.m1.3a"><mrow id="S2.Ex10.m1.3.3.1" xref="S2.Ex10.m1.3.3.1.1.cmml"><mrow id="S2.Ex10.m1.3.3.1.1" xref="S2.Ex10.m1.3.3.1.1.cmml"><msub id="S2.Ex10.m1.3.3.1.1.3" xref="S2.Ex10.m1.3.3.1.1.3.cmml"><mi id="S2.Ex10.m1.3.3.1.1.3.2" mathsize="90%" xref="S2.Ex10.m1.3.3.1.1.3.2.cmml">𝔼</mi><mrow id="S2.Ex10.m1.1.1.1" xref="S2.Ex10.m1.1.1.1.cmml"><mi id="S2.Ex10.m1.1.1.1.3" mathsize="90%" xref="S2.Ex10.m1.1.1.1.3.cmml">𝒁</mi><mo id="S2.Ex10.m1.1.1.1.2" mathsize="90%" xref="S2.Ex10.m1.1.1.1.2.cmml">∼</mo><mrow id="S2.Ex10.m1.1.1.1.1" xref="S2.Ex10.m1.1.1.1.1.cmml"><mi id="S2.Ex10.m1.1.1.1.1.3" mathsize="90%" xref="S2.Ex10.m1.1.1.1.1.3.cmml">p</mi><mo id="S2.Ex10.m1.1.1.1.1.2" xref="S2.Ex10.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex10.m1.1.1.1.1.1.1" xref="S2.Ex10.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex10.m1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex10.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex10.m1.1.1.1.1.1.1.1" xref="S2.Ex10.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex10.m1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex10.m1.1.1.1.1.1.1.1.2.cmml">𝒁</mi><mo fence="false" id="S2.Ex10.m1.1.1.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex10.m1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S2.Ex10.m1.1.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.Ex10.m1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S2.Ex10.m1.3.3.1.1.2" xref="S2.Ex10.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S2.Ex10.m1.3.3.1.1.1.1" xref="S2.Ex10.m1.3.3.1.1.1.2.cmml"><mo id="S2.Ex10.m1.3.3.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex10.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex10.m1.3.3.1.1.1.1.1" xref="S2.Ex10.m1.3.3.1.1.1.1.1.cmml"><mi id="S2.Ex10.m1.3.3.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex10.m1.3.3.1.1.1.1.1.2.cmml">α</mi><mo id="S2.Ex10.m1.3.3.1.1.1.1.1.1" xref="S2.Ex10.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex10.m1.3.3.1.1.1.1.1.3.2" xref="S2.Ex10.m1.3.3.1.1.1.1.1.cmml"><mo id="S2.Ex10.m1.3.3.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex10.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex10.m1.2.2" mathsize="90%" xref="S2.Ex10.m1.2.2.cmml">𝒁</mi><mo id="S2.Ex10.m1.3.3.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="S2.Ex10.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex10.m1.3.3.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex10.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.Ex10.m1.3.3.1.2" lspace="0em" mathsize="90%" xref="S2.Ex10.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex10.m1.3b"><apply id="S2.Ex10.m1.3.3.1.1.cmml" xref="S2.Ex10.m1.3.3.1"><times id="S2.Ex10.m1.3.3.1.1.2.cmml" xref="S2.Ex10.m1.3.3.1.1.2"></times><apply id="S2.Ex10.m1.3.3.1.1.3.cmml" xref="S2.Ex10.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.Ex10.m1.3.3.1.1.3.1.cmml" xref="S2.Ex10.m1.3.3.1.1.3">subscript</csymbol><ci id="S2.Ex10.m1.3.3.1.1.3.2.cmml" xref="S2.Ex10.m1.3.3.1.1.3.2">𝔼</ci><apply id="S2.Ex10.m1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.1.1.1.2.cmml" xref="S2.Ex10.m1.1.1.1.2">similar-to</csymbol><ci id="S2.Ex10.m1.1.1.1.3.cmml" xref="S2.Ex10.m1.1.1.1.3">𝒁</ci><apply id="S2.Ex10.m1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1"><times id="S2.Ex10.m1.1.1.1.1.2.cmml" xref="S2.Ex10.m1.1.1.1.1.2"></times><ci id="S2.Ex10.m1.1.1.1.1.3.cmml" xref="S2.Ex10.m1.1.1.1.1.3">𝑝</ci><apply id="S2.Ex10.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex10.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.2">𝒁</ci><ci id="S2.Ex10.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex10.m1.1.1.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply><apply id="S2.Ex10.m1.3.3.1.1.1.2.cmml" xref="S2.Ex10.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.Ex10.m1.3.3.1.1.1.2.1.cmml" xref="S2.Ex10.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex10.m1.3.3.1.1.1.1.1.cmml" xref="S2.Ex10.m1.3.3.1.1.1.1.1"><times id="S2.Ex10.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.Ex10.m1.3.3.1.1.1.1.1.1"></times><ci id="S2.Ex10.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.Ex10.m1.3.3.1.1.1.1.1.2">𝛼</ci><ci id="S2.Ex10.m1.2.2.cmml" xref="S2.Ex10.m1.2.2">𝒁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex10.m1.3c">\small\mathbb{E}_{\bm{Z}\sim p(\bm{Z}|{\bm{\theta}})}[\alpha(\bm{Z})].</annotation><annotation encoding="application/x-llamapun" id="S2.Ex10.m1.3d">blackboard_E start_POSTSUBSCRIPT bold_italic_Z ∼ italic_p ( bold_italic_Z | bold_italic_θ ) end_POSTSUBSCRIPT [ italic_α ( bold_italic_Z ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p9.3">We can optimize <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p9.1.m1.1"><semantics id="S2.SS3.SSS3.p9.1.m1.1a"><mi id="S2.SS3.SSS3.p9.1.m1.1.1" xref="S2.SS3.SSS3.p9.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p9.1.m1.1b"><ci id="S2.SS3.SSS3.p9.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p9.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p9.1.m1.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p9.1.m1.1d">bold_italic_θ</annotation></semantics></math> over a continuous space to maximize PO.
Since <math alttext="p(\bm{Z}|\bm{\theta})" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p9.2.m2.1"><semantics id="S2.SS3.SSS3.p9.2.m2.1a"><mrow id="S2.SS3.SSS3.p9.2.m2.1.1" xref="S2.SS3.SSS3.p9.2.m2.1.1.cmml"><mi id="S2.SS3.SSS3.p9.2.m2.1.1.3" xref="S2.SS3.SSS3.p9.2.m2.1.1.3.cmml">p</mi><mo id="S2.SS3.SSS3.p9.2.m2.1.1.2" xref="S2.SS3.SSS3.p9.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.SSS3.p9.2.m2.1.1.1.1" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.2" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.2.cmml">𝒁</mi><mo fence="false" id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.1" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.3" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p9.2.m2.1b"><apply id="S2.SS3.SSS3.p9.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p9.2.m2.1.1"><times id="S2.SS3.SSS3.p9.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p9.2.m2.1.1.2"></times><ci id="S2.SS3.SSS3.p9.2.m2.1.1.3.cmml" xref="S2.SS3.SSS3.p9.2.m2.1.1.3">𝑝</ci><apply id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.2">𝒁</ci><ci id="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS3.p9.2.m2.1.1.1.1.1.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p9.2.m2.1c">p(\bm{Z}|\bm{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p9.2.m2.1d">italic_p ( bold_italic_Z | bold_italic_θ )</annotation></semantics></math> is a discrete distribution over the discrete space <span class="ltx_text ltx_markedasmath ltx_ulem_sout" id="S2.SS3.SSS3.p9.3.m3.1.1.1"><math alttext="Z" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1"><semantics id="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1a"><mi id="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1.1" xref="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1b"><ci id="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p9.3.m3.1.1.1.1.m1.1d">italic_Z</annotation></semantics></math></span>, AF is only evaluated for discrete designs and PO can be rewritten as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathbb{E}_{\bm{Z}\thicksim p(\bm{Z}|\bm{\theta})}[\alpha(\bm{Z})]=\sum_%
{\bm{z}\in\text{\sout{$Z$}}}p(\bm{z}|\bm{\theta})\alpha(\bm{z})." class="ltx_Math" display="block" id="S2.Ex11.m1.5"><semantics id="S2.Ex11.m1.5a"><mrow id="S2.Ex11.m1.5.5.1" xref="S2.Ex11.m1.5.5.1.1.cmml"><mrow id="S2.Ex11.m1.5.5.1.1" xref="S2.Ex11.m1.5.5.1.1.cmml"><mrow id="S2.Ex11.m1.5.5.1.1.1" xref="S2.Ex11.m1.5.5.1.1.1.cmml"><msub id="S2.Ex11.m1.5.5.1.1.1.3" xref="S2.Ex11.m1.5.5.1.1.1.3.cmml"><mi id="S2.Ex11.m1.5.5.1.1.1.3.2" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.Ex11.m1.2.2.1" xref="S2.Ex11.m1.2.2.1.cmml"><mi id="S2.Ex11.m1.2.2.1.3" mathsize="90%" xref="S2.Ex11.m1.2.2.1.3.cmml">𝒁</mi><mo id="S2.Ex11.m1.2.2.1.2" mathsize="90%" xref="S2.Ex11.m1.2.2.1.2.cmml">∼</mo><mrow id="S2.Ex11.m1.2.2.1.1" xref="S2.Ex11.m1.2.2.1.1.cmml"><mi id="S2.Ex11.m1.2.2.1.1.3" mathsize="90%" xref="S2.Ex11.m1.2.2.1.1.3.cmml">p</mi><mo id="S2.Ex11.m1.2.2.1.1.2" xref="S2.Ex11.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.2.2.1.1.1.1" xref="S2.Ex11.m1.2.2.1.1.1.1.1.cmml"><mo id="S2.Ex11.m1.2.2.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex11.m1.2.2.1.1.1.1.1" xref="S2.Ex11.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.Ex11.m1.2.2.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex11.m1.2.2.1.1.1.1.1.2.cmml">𝒁</mi><mo fence="false" id="S2.Ex11.m1.2.2.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex11.m1.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex11.m1.2.2.1.1.1.1.1.3" mathsize="90%" xref="S2.Ex11.m1.2.2.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.Ex11.m1.2.2.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S2.Ex11.m1.5.5.1.1.1.2" xref="S2.Ex11.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.5.5.1.1.1.1.1" xref="S2.Ex11.m1.5.5.1.1.1.1.2.cmml"><mo id="S2.Ex11.m1.5.5.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex11.m1.5.5.1.1.1.1.1.1" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.Ex11.m1.5.5.1.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.2.cmml">α</mi><mo id="S2.Ex11.m1.5.5.1.1.1.1.1.1.1" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex11.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.Ex11.m1.5.5.1.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex11.m1.3.3" mathsize="90%" xref="S2.Ex11.m1.3.3.cmml">𝒁</mi><mo id="S2.Ex11.m1.5.5.1.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex11.m1.5.5.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.Ex11.m1.5.5.1.1.3" mathsize="90%" rspace="0.111em" xref="S2.Ex11.m1.5.5.1.1.3.cmml">=</mo><mrow id="S2.Ex11.m1.5.5.1.1.2" xref="S2.Ex11.m1.5.5.1.1.2.cmml"><munder id="S2.Ex11.m1.5.5.1.1.2.2" xref="S2.Ex11.m1.5.5.1.1.2.2.cmml"><mo id="S2.Ex11.m1.5.5.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.Ex11.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S2.Ex11.m1.1.1.1" xref="S2.Ex11.m1.1.1.1.cmml"><mi id="S2.Ex11.m1.1.1.1.3" mathsize="90%" xref="S2.Ex11.m1.1.1.1.3.cmml">𝒛</mi><mo id="S2.Ex11.m1.1.1.1.2" mathsize="90%" xref="S2.Ex11.m1.1.1.1.2.cmml">∈</mo><mi class="ltx_ulem_sout" id="S2.Ex11.m1.1.1.1.4" mathsize="90%" xref="S2.Ex11.m1.1.1.1.4.cmml">Z</mi></mrow></munder><mrow id="S2.Ex11.m1.5.5.1.1.2.1" xref="S2.Ex11.m1.5.5.1.1.2.1.cmml"><mi id="S2.Ex11.m1.5.5.1.1.2.1.3" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.3.cmml">p</mi><mo id="S2.Ex11.m1.5.5.1.1.2.1.2" xref="S2.Ex11.m1.5.5.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.5.5.1.1.2.1.1.1" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.cmml"><mo id="S2.Ex11.m1.5.5.1.1.2.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.cmml"><mi id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.2" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.2.cmml">𝒛</mi><mo fence="false" id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.1" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.3" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.Ex11.m1.5.5.1.1.2.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex11.m1.5.5.1.1.2.1.2a" xref="S2.Ex11.m1.5.5.1.1.2.1.2.cmml">⁢</mo><mi id="S2.Ex11.m1.5.5.1.1.2.1.4" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.4.cmml">α</mi><mo id="S2.Ex11.m1.5.5.1.1.2.1.2b" xref="S2.Ex11.m1.5.5.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.Ex11.m1.5.5.1.1.2.1.5.2" xref="S2.Ex11.m1.5.5.1.1.2.1.cmml"><mo id="S2.Ex11.m1.5.5.1.1.2.1.5.2.1" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.cmml">(</mo><mi id="S2.Ex11.m1.4.4" mathsize="90%" xref="S2.Ex11.m1.4.4.cmml">𝒛</mi><mo id="S2.Ex11.m1.5.5.1.1.2.1.5.2.2" maxsize="90%" minsize="90%" xref="S2.Ex11.m1.5.5.1.1.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex11.m1.5.5.1.2" lspace="0em" mathsize="90%" xref="S2.Ex11.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex11.m1.5b"><apply id="S2.Ex11.m1.5.5.1.1.cmml" xref="S2.Ex11.m1.5.5.1"><eq id="S2.Ex11.m1.5.5.1.1.3.cmml" xref="S2.Ex11.m1.5.5.1.1.3"></eq><apply id="S2.Ex11.m1.5.5.1.1.1.cmml" xref="S2.Ex11.m1.5.5.1.1.1"><times id="S2.Ex11.m1.5.5.1.1.1.2.cmml" xref="S2.Ex11.m1.5.5.1.1.1.2"></times><apply id="S2.Ex11.m1.5.5.1.1.1.3.cmml" xref="S2.Ex11.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex11.m1.5.5.1.1.1.3.1.cmml" xref="S2.Ex11.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S2.Ex11.m1.5.5.1.1.1.3.2.cmml" xref="S2.Ex11.m1.5.5.1.1.1.3.2">𝔼</ci><apply id="S2.Ex11.m1.2.2.1.cmml" xref="S2.Ex11.m1.2.2.1"><ci id="S2.Ex11.m1.2.2.1.2.cmml" xref="S2.Ex11.m1.2.2.1.2">∼</ci><ci id="S2.Ex11.m1.2.2.1.3.cmml" xref="S2.Ex11.m1.2.2.1.3">𝒁</ci><apply id="S2.Ex11.m1.2.2.1.1.cmml" xref="S2.Ex11.m1.2.2.1.1"><times id="S2.Ex11.m1.2.2.1.1.2.cmml" xref="S2.Ex11.m1.2.2.1.1.2"></times><ci id="S2.Ex11.m1.2.2.1.1.3.cmml" xref="S2.Ex11.m1.2.2.1.1.3">𝑝</ci><apply id="S2.Ex11.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex11.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S2.Ex11.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex11.m1.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex11.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex11.m1.2.2.1.1.1.1.1.2">𝒁</ci><ci id="S2.Ex11.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex11.m1.2.2.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply><apply id="S2.Ex11.m1.5.5.1.1.1.1.2.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex11.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex11.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1"><times id="S2.Ex11.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.1"></times><ci id="S2.Ex11.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.Ex11.m1.5.5.1.1.1.1.1.1.2">𝛼</ci><ci id="S2.Ex11.m1.3.3.cmml" xref="S2.Ex11.m1.3.3">𝒁</ci></apply></apply></apply><apply id="S2.Ex11.m1.5.5.1.1.2.cmml" xref="S2.Ex11.m1.5.5.1.1.2"><apply id="S2.Ex11.m1.5.5.1.1.2.2.cmml" xref="S2.Ex11.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex11.m1.5.5.1.1.2.2.1.cmml" xref="S2.Ex11.m1.5.5.1.1.2.2">subscript</csymbol><sum id="S2.Ex11.m1.5.5.1.1.2.2.2.cmml" xref="S2.Ex11.m1.5.5.1.1.2.2.2"></sum><apply id="S2.Ex11.m1.1.1.1.cmml" xref="S2.Ex11.m1.1.1.1"><in id="S2.Ex11.m1.1.1.1.2.cmml" xref="S2.Ex11.m1.1.1.1.2"></in><ci id="S2.Ex11.m1.1.1.1.3.cmml" xref="S2.Ex11.m1.1.1.1.3">𝒛</ci><ci id="S2.Ex11.m1.1.1.1.4.cmml" xref="S2.Ex11.m1.1.1.1.4">𝑍</ci></apply></apply><apply id="S2.Ex11.m1.5.5.1.1.2.1.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1"><times id="S2.Ex11.m1.5.5.1.1.2.1.2.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1.2"></times><ci id="S2.Ex11.m1.5.5.1.1.2.1.3.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1.3">𝑝</ci><apply id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.2">𝒛</ci><ci id="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1.1.1.1.3">𝜽</ci></apply><ci id="S2.Ex11.m1.5.5.1.1.2.1.4.cmml" xref="S2.Ex11.m1.5.5.1.1.2.1.4">𝛼</ci><ci id="S2.Ex11.m1.4.4.cmml" xref="S2.Ex11.m1.4.4">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex11.m1.5c">\small\mathbb{E}_{\bm{Z}\thicksim p(\bm{Z}|\bm{\theta})}[\alpha(\bm{Z})]=\sum_%
{\bm{z}\in\text{\sout{$Z$}}}p(\bm{z}|\bm{\theta})\alpha(\bm{z}).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex11.m1.5d">blackboard_E start_POSTSUBSCRIPT bold_italic_Z ∼ italic_p ( bold_italic_Z | bold_italic_θ ) end_POSTSUBSCRIPT [ italic_α ( bold_italic_Z ) ] = ∑ start_POSTSUBSCRIPT bold_italic_z ∈ italic_Z end_POSTSUBSCRIPT italic_p ( bold_italic_z | bold_italic_θ ) italic_α ( bold_italic_z ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p9.6">Note that the above probabilistic objective is differentiable w.r.t. <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p9.4.m1.1"><semantics id="S2.SS3.SSS3.p9.4.m1.1a"><mi id="S2.SS3.SSS3.p9.4.m1.1.1" xref="S2.SS3.SSS3.p9.4.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p9.4.m1.1b"><ci id="S2.SS3.SSS3.p9.4.m1.1.1.cmml" xref="S2.SS3.SSS3.p9.4.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p9.4.m1.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p9.4.m1.1d">bold_italic_θ</annotation></semantics></math> and <math alttext="\alpha(\bm{z})" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p9.5.m2.1"><semantics id="S2.SS3.SSS3.p9.5.m2.1a"><mrow id="S2.SS3.SSS3.p9.5.m2.1.2" xref="S2.SS3.SSS3.p9.5.m2.1.2.cmml"><mi id="S2.SS3.SSS3.p9.5.m2.1.2.2" xref="S2.SS3.SSS3.p9.5.m2.1.2.2.cmml">α</mi><mo id="S2.SS3.SSS3.p9.5.m2.1.2.1" xref="S2.SS3.SSS3.p9.5.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.SSS3.p9.5.m2.1.2.3.2" xref="S2.SS3.SSS3.p9.5.m2.1.2.cmml"><mo id="S2.SS3.SSS3.p9.5.m2.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p9.5.m2.1.2.cmml">(</mo><mi id="S2.SS3.SSS3.p9.5.m2.1.1" xref="S2.SS3.SSS3.p9.5.m2.1.1.cmml">𝒛</mi><mo id="S2.SS3.SSS3.p9.5.m2.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS3.p9.5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p9.5.m2.1b"><apply id="S2.SS3.SSS3.p9.5.m2.1.2.cmml" xref="S2.SS3.SSS3.p9.5.m2.1.2"><times id="S2.SS3.SSS3.p9.5.m2.1.2.1.cmml" xref="S2.SS3.SSS3.p9.5.m2.1.2.1"></times><ci id="S2.SS3.SSS3.p9.5.m2.1.2.2.cmml" xref="S2.SS3.SSS3.p9.5.m2.1.2.2">𝛼</ci><ci id="S2.SS3.SSS3.p9.5.m2.1.1.cmml" xref="S2.SS3.SSS3.p9.5.m2.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p9.5.m2.1c">\alpha(\bm{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p9.5.m2.1d">italic_α ( bold_italic_z )</annotation></semantics></math> is not differentiable w.r.t. <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p9.6.m3.1"><semantics id="S2.SS3.SSS3.p9.6.m3.1a"><mi id="S2.SS3.SSS3.p9.6.m3.1.1" xref="S2.SS3.SSS3.p9.6.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p9.6.m3.1b"><ci id="S2.SS3.SSS3.p9.6.m3.1.1.cmml" xref="S2.SS3.SSS3.p9.6.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p9.6.m3.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p9.6.m3.1d">bold_italic_z</annotation></semantics></math>.
The gradient of PO can be obtained as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\nabla_{\bm{\theta}}\mathbb{E}_{\bm{Z}\sim p(\bm{Z}|\bm{\theta})}[\alpha%
(\bm{Z})]=\sum_{\bm{z}\in\text{\sout{$Z$}}}\alpha(\bm{z})\nabla_{\bm{\theta}}p%
(\bm{z}|\bm{\theta})." class="ltx_Math" display="block" id="S2.Ex12.m1.5"><semantics id="S2.Ex12.m1.5a"><mrow id="S2.Ex12.m1.5.5.1" xref="S2.Ex12.m1.5.5.1.1.cmml"><mrow id="S2.Ex12.m1.5.5.1.1" xref="S2.Ex12.m1.5.5.1.1.cmml"><mrow id="S2.Ex12.m1.5.5.1.1.1" xref="S2.Ex12.m1.5.5.1.1.1.cmml"><mrow id="S2.Ex12.m1.5.5.1.1.1.3" xref="S2.Ex12.m1.5.5.1.1.1.3.cmml"><msub id="S2.Ex12.m1.5.5.1.1.1.3.1" xref="S2.Ex12.m1.5.5.1.1.1.3.1.cmml"><mo id="S2.Ex12.m1.5.5.1.1.1.3.1.2" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.3.1.2.cmml">∇</mo><mi id="S2.Ex12.m1.5.5.1.1.1.3.1.3" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.3.1.3.cmml">𝜽</mi></msub><msub id="S2.Ex12.m1.5.5.1.1.1.3.2" xref="S2.Ex12.m1.5.5.1.1.1.3.2.cmml"><mi id="S2.Ex12.m1.5.5.1.1.1.3.2.2" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.3.2.2.cmml">𝔼</mi><mrow id="S2.Ex12.m1.2.2.1" xref="S2.Ex12.m1.2.2.1.cmml"><mi id="S2.Ex12.m1.2.2.1.3" mathsize="90%" xref="S2.Ex12.m1.2.2.1.3.cmml">𝒁</mi><mo id="S2.Ex12.m1.2.2.1.2" mathsize="90%" xref="S2.Ex12.m1.2.2.1.2.cmml">∼</mo><mrow id="S2.Ex12.m1.2.2.1.1" xref="S2.Ex12.m1.2.2.1.1.cmml"><mi id="S2.Ex12.m1.2.2.1.1.3" mathsize="90%" xref="S2.Ex12.m1.2.2.1.1.3.cmml">p</mi><mo id="S2.Ex12.m1.2.2.1.1.2" xref="S2.Ex12.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S2.Ex12.m1.2.2.1.1.1.1" xref="S2.Ex12.m1.2.2.1.1.1.1.1.cmml"><mo id="S2.Ex12.m1.2.2.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex12.m1.2.2.1.1.1.1.1" xref="S2.Ex12.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.Ex12.m1.2.2.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex12.m1.2.2.1.1.1.1.1.2.cmml">𝒁</mi><mo fence="false" id="S2.Ex12.m1.2.2.1.1.1.1.1.1" mathsize="90%" xref="S2.Ex12.m1.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex12.m1.2.2.1.1.1.1.1.3" mathsize="90%" xref="S2.Ex12.m1.2.2.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.Ex12.m1.2.2.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow><mo id="S2.Ex12.m1.5.5.1.1.1.2" xref="S2.Ex12.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex12.m1.5.5.1.1.1.1.1" xref="S2.Ex12.m1.5.5.1.1.1.1.2.cmml"><mo id="S2.Ex12.m1.5.5.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex12.m1.5.5.1.1.1.1.1.1" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.Ex12.m1.5.5.1.1.1.1.1.1.2" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.2.cmml">α</mi><mo id="S2.Ex12.m1.5.5.1.1.1.1.1.1.1" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex12.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.Ex12.m1.5.5.1.1.1.1.1.1.3.2.1" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex12.m1.3.3" mathsize="90%" xref="S2.Ex12.m1.3.3.cmml">𝒁</mi><mo id="S2.Ex12.m1.5.5.1.1.1.1.1.1.3.2.2" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex12.m1.5.5.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.Ex12.m1.5.5.1.1.3" mathsize="90%" rspace="0.111em" xref="S2.Ex12.m1.5.5.1.1.3.cmml">=</mo><mrow id="S2.Ex12.m1.5.5.1.1.2" xref="S2.Ex12.m1.5.5.1.1.2.cmml"><munder id="S2.Ex12.m1.5.5.1.1.2.2" xref="S2.Ex12.m1.5.5.1.1.2.2.cmml"><mo id="S2.Ex12.m1.5.5.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S2.Ex12.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S2.Ex12.m1.1.1.1" xref="S2.Ex12.m1.1.1.1.cmml"><mi id="S2.Ex12.m1.1.1.1.3" mathsize="90%" xref="S2.Ex12.m1.1.1.1.3.cmml">𝒛</mi><mo id="S2.Ex12.m1.1.1.1.2" mathsize="90%" xref="S2.Ex12.m1.1.1.1.2.cmml">∈</mo><mi class="ltx_ulem_sout" id="S2.Ex12.m1.1.1.1.4" mathsize="90%" xref="S2.Ex12.m1.1.1.1.4.cmml">Z</mi></mrow></munder><mrow id="S2.Ex12.m1.5.5.1.1.2.1" xref="S2.Ex12.m1.5.5.1.1.2.1.cmml"><mi id="S2.Ex12.m1.5.5.1.1.2.1.3" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.3.cmml">α</mi><mo id="S2.Ex12.m1.5.5.1.1.2.1.2" xref="S2.Ex12.m1.5.5.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.Ex12.m1.5.5.1.1.2.1.4.2" xref="S2.Ex12.m1.5.5.1.1.2.1.cmml"><mo id="S2.Ex12.m1.5.5.1.1.2.1.4.2.1" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.cmml">(</mo><mi id="S2.Ex12.m1.4.4" mathsize="90%" xref="S2.Ex12.m1.4.4.cmml">𝒛</mi><mo id="S2.Ex12.m1.5.5.1.1.2.1.4.2.2" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.cmml">)</mo></mrow><mo id="S2.Ex12.m1.5.5.1.1.2.1.2a" lspace="0.167em" xref="S2.Ex12.m1.5.5.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.Ex12.m1.5.5.1.1.2.1.5" xref="S2.Ex12.m1.5.5.1.1.2.1.5.cmml"><msub id="S2.Ex12.m1.5.5.1.1.2.1.5.1" xref="S2.Ex12.m1.5.5.1.1.2.1.5.1.cmml"><mo id="S2.Ex12.m1.5.5.1.1.2.1.5.1.2" mathsize="90%" rspace="0.167em" xref="S2.Ex12.m1.5.5.1.1.2.1.5.1.2.cmml">∇</mo><mi id="S2.Ex12.m1.5.5.1.1.2.1.5.1.3" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.5.1.3.cmml">𝜽</mi></msub><mi id="S2.Ex12.m1.5.5.1.1.2.1.5.2" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.5.2.cmml">p</mi></mrow><mo id="S2.Ex12.m1.5.5.1.1.2.1.2b" xref="S2.Ex12.m1.5.5.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.Ex12.m1.5.5.1.1.2.1.1.1" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.cmml"><mo id="S2.Ex12.m1.5.5.1.1.2.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.cmml"><mi id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.2" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.2.cmml">𝒛</mi><mo fence="false" id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.1" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.3" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S2.Ex12.m1.5.5.1.1.2.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex12.m1.5.5.1.2" lspace="0em" mathsize="90%" xref="S2.Ex12.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex12.m1.5b"><apply id="S2.Ex12.m1.5.5.1.1.cmml" xref="S2.Ex12.m1.5.5.1"><eq id="S2.Ex12.m1.5.5.1.1.3.cmml" xref="S2.Ex12.m1.5.5.1.1.3"></eq><apply id="S2.Ex12.m1.5.5.1.1.1.cmml" xref="S2.Ex12.m1.5.5.1.1.1"><times id="S2.Ex12.m1.5.5.1.1.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.1.2"></times><apply id="S2.Ex12.m1.5.5.1.1.1.3.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3"><apply id="S2.Ex12.m1.5.5.1.1.1.3.1.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.Ex12.m1.5.5.1.1.1.3.1.1.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3.1">subscript</csymbol><ci id="S2.Ex12.m1.5.5.1.1.1.3.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3.1.2">∇</ci><ci id="S2.Ex12.m1.5.5.1.1.1.3.1.3.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3.1.3">𝜽</ci></apply><apply id="S2.Ex12.m1.5.5.1.1.1.3.2.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex12.m1.5.5.1.1.1.3.2.1.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex12.m1.5.5.1.1.1.3.2.2.cmml" xref="S2.Ex12.m1.5.5.1.1.1.3.2.2">𝔼</ci><apply id="S2.Ex12.m1.2.2.1.cmml" xref="S2.Ex12.m1.2.2.1"><csymbol cd="latexml" id="S2.Ex12.m1.2.2.1.2.cmml" xref="S2.Ex12.m1.2.2.1.2">similar-to</csymbol><ci id="S2.Ex12.m1.2.2.1.3.cmml" xref="S2.Ex12.m1.2.2.1.3">𝒁</ci><apply id="S2.Ex12.m1.2.2.1.1.cmml" xref="S2.Ex12.m1.2.2.1.1"><times id="S2.Ex12.m1.2.2.1.1.2.cmml" xref="S2.Ex12.m1.2.2.1.1.2"></times><ci id="S2.Ex12.m1.2.2.1.1.3.cmml" xref="S2.Ex12.m1.2.2.1.1.3">𝑝</ci><apply id="S2.Ex12.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex12.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S2.Ex12.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex12.m1.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex12.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex12.m1.2.2.1.1.1.1.1.2">𝒁</ci><ci id="S2.Ex12.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex12.m1.2.2.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply></apply><apply id="S2.Ex12.m1.5.5.1.1.1.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex12.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.Ex12.m1.5.5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex12.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1"><times id="S2.Ex12.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.1"></times><ci id="S2.Ex12.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.1.1.1.1.2">𝛼</ci><ci id="S2.Ex12.m1.3.3.cmml" xref="S2.Ex12.m1.3.3">𝒁</ci></apply></apply></apply><apply id="S2.Ex12.m1.5.5.1.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.2"><apply id="S2.Ex12.m1.5.5.1.1.2.2.cmml" xref="S2.Ex12.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex12.m1.5.5.1.1.2.2.1.cmml" xref="S2.Ex12.m1.5.5.1.1.2.2">subscript</csymbol><sum id="S2.Ex12.m1.5.5.1.1.2.2.2.cmml" xref="S2.Ex12.m1.5.5.1.1.2.2.2"></sum><apply id="S2.Ex12.m1.1.1.1.cmml" xref="S2.Ex12.m1.1.1.1"><in id="S2.Ex12.m1.1.1.1.2.cmml" xref="S2.Ex12.m1.1.1.1.2"></in><ci id="S2.Ex12.m1.1.1.1.3.cmml" xref="S2.Ex12.m1.1.1.1.3">𝒛</ci><ci id="S2.Ex12.m1.1.1.1.4.cmml" xref="S2.Ex12.m1.1.1.1.4">𝑍</ci></apply></apply><apply id="S2.Ex12.m1.5.5.1.1.2.1.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1"><times id="S2.Ex12.m1.5.5.1.1.2.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.2"></times><ci id="S2.Ex12.m1.5.5.1.1.2.1.3.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.3">𝛼</ci><ci id="S2.Ex12.m1.4.4.cmml" xref="S2.Ex12.m1.4.4">𝒛</ci><apply id="S2.Ex12.m1.5.5.1.1.2.1.5.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.5"><apply id="S2.Ex12.m1.5.5.1.1.2.1.5.1.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.5.1"><csymbol cd="ambiguous" id="S2.Ex12.m1.5.5.1.1.2.1.5.1.1.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.5.1">subscript</csymbol><ci id="S2.Ex12.m1.5.5.1.1.2.1.5.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.5.1.2">∇</ci><ci id="S2.Ex12.m1.5.5.1.1.2.1.5.1.3.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.5.1.3">𝜽</ci></apply><ci id="S2.Ex12.m1.5.5.1.1.2.1.5.2.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.5.2">𝑝</ci></apply><apply id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.2">𝒛</ci><ci id="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="S2.Ex12.m1.5.5.1.1.2.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex12.m1.5c">\small\nabla_{\bm{\theta}}\mathbb{E}_{\bm{Z}\sim p(\bm{Z}|\bm{\theta})}[\alpha%
(\bm{Z})]=\sum_{\bm{z}\in\text{\sout{$Z$}}}\alpha(\bm{z})\nabla_{\bm{\theta}}p%
(\bm{z}|\bm{\theta}).</annotation><annotation encoding="application/x-llamapun" id="S2.Ex12.m1.5d">∇ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT bold_italic_Z ∼ italic_p ( bold_italic_Z | bold_italic_θ ) end_POSTSUBSCRIPT [ italic_α ( bold_italic_Z ) ] = ∑ start_POSTSUBSCRIPT bold_italic_z ∈ italic_Z end_POSTSUBSCRIPT italic_α ( bold_italic_z ) ∇ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT italic_p ( bold_italic_z | bold_italic_θ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p9.8">Therefore, gradient-based methods can be used to optimize the probabilistic objective (Line 4 in Alg. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#alg1" title="Algorithm 1 ‣ Appendix E Bayesian Optimization with Reparameterization ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> of Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A5" title="Appendix E Bayesian Optimization with Reparameterization ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">E</span></a>).
In practice, we use Monte Carlo sampling to estimate PO and its gradient to reduce the computation cost <cite class="ltx_cite ltx_citemacro_citep">(Daulton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib6" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS3.p10">
<p class="ltx_p" id="S2.SS3.SSS3.p10.4"><span class="ltx_text ltx_font_bold" id="S2.SS3.SSS3.p10.4.1">Gating Network.</span>
The goal of the gating network <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.1.m1.1"><semantics id="S2.SS3.SSS3.p10.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS3.p10.1.m1.1.1" xref="S2.SS3.SSS3.p10.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.1.m1.1b"><ci id="S2.SS3.SSS3.p10.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p10.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.1.m1.1d">caligraphic_G</annotation></semantics></math> is to direct the input to the appropriate expert.
To be precise, <math alttext="\mathbf{q}^{k}_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.2.m2.1"><semantics id="S2.SS3.SSS3.p10.2.m2.1a"><msubsup id="S2.SS3.SSS3.p10.2.m2.1.1" xref="S2.SS3.SSS3.p10.2.m2.1.1.cmml"><mi id="S2.SS3.SSS3.p10.2.m2.1.1.2.2" xref="S2.SS3.SSS3.p10.2.m2.1.1.2.2.cmml">𝐪</mi><mi id="S2.SS3.SSS3.p10.2.m2.1.1.3" xref="S2.SS3.SSS3.p10.2.m2.1.1.3.cmml">i</mi><mi id="S2.SS3.SSS3.p10.2.m2.1.1.2.3" xref="S2.SS3.SSS3.p10.2.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.2.m2.1b"><apply id="S2.SS3.SSS3.p10.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p10.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p10.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.2.m2.1.1.2.1.cmml" xref="S2.SS3.SSS3.p10.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p10.2.m2.1.1.2.2.cmml" xref="S2.SS3.SSS3.p10.2.m2.1.1.2.2">𝐪</ci><ci id="S2.SS3.SSS3.p10.2.m2.1.1.2.3.cmml" xref="S2.SS3.SSS3.p10.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S2.SS3.SSS3.p10.2.m2.1.1.3.cmml" xref="S2.SS3.SSS3.p10.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.2.m2.1c">\mathbf{q}^{k}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.2.m2.1d">bold_q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{p}^{k}_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.3.m3.1"><semantics id="S2.SS3.SSS3.p10.3.m3.1a"><msubsup id="S2.SS3.SSS3.p10.3.m3.1.1" xref="S2.SS3.SSS3.p10.3.m3.1.1.cmml"><mi id="S2.SS3.SSS3.p10.3.m3.1.1.2.2" xref="S2.SS3.SSS3.p10.3.m3.1.1.2.2.cmml">𝐩</mi><mi id="S2.SS3.SSS3.p10.3.m3.1.1.3" xref="S2.SS3.SSS3.p10.3.m3.1.1.3.cmml">i</mi><mi id="S2.SS3.SSS3.p10.3.m3.1.1.2.3" xref="S2.SS3.SSS3.p10.3.m3.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.3.m3.1b"><apply id="S2.SS3.SSS3.p10.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.3.m3.1.1.1.cmml" xref="S2.SS3.SSS3.p10.3.m3.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p10.3.m3.1.1.2.cmml" xref="S2.SS3.SSS3.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.3.m3.1.1.2.1.cmml" xref="S2.SS3.SSS3.p10.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p10.3.m3.1.1.2.2.cmml" xref="S2.SS3.SSS3.p10.3.m3.1.1.2.2">𝐩</ci><ci id="S2.SS3.SSS3.p10.3.m3.1.1.2.3.cmml" xref="S2.SS3.SSS3.p10.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S2.SS3.SSS3.p10.3.m3.1.1.3.cmml" xref="S2.SS3.SSS3.p10.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.3.m3.1c">\mathbf{p}^{k}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.3.m3.1d">bold_p start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.4.m4.1"><semantics id="S2.SS3.SSS3.p10.4.m4.1a"><mi id="S2.SS3.SSS3.p10.4.m4.1.1" xref="S2.SS3.SSS3.p10.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.4.m4.1b"><ci id="S2.SS3.SSS3.p10.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p10.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.4.m4.1d">italic_i</annotation></semantics></math>-th token are fused through the gate network:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{\beta}=\text{Softmax}\big{(}[\mathbf{q}^{k}_{i},\mathbf{p}^{k}_{i}]\mathbf%
{W}_{\text{gate}}+\mathbf{b}_{\text{gate}}\big{)},\,\,\,\,\mathbf{\tilde{h}}_{%
i}^{k}=\beta_{1}\cdot\mathbf{q}^{k}_{i}+\beta_{2}\cdot\mathbf{p}^{k}_{i}" class="ltx_Math" display="block" id="S2.Ex13.m1.2"><semantics id="S2.Ex13.m1.2a"><mrow id="S2.Ex13.m1.2.2.2" xref="S2.Ex13.m1.2.2.3.cmml"><mrow id="S2.Ex13.m1.1.1.1.1" xref="S2.Ex13.m1.1.1.1.1.cmml"><mi id="S2.Ex13.m1.1.1.1.1.3" xref="S2.Ex13.m1.1.1.1.1.3.cmml">𝜷</mi><mo id="S2.Ex13.m1.1.1.1.1.2" xref="S2.Ex13.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.Ex13.m1.1.1.1.1.1" xref="S2.Ex13.m1.1.1.1.1.1.cmml"><mtext id="S2.Ex13.m1.1.1.1.1.1.3" xref="S2.Ex13.m1.1.1.1.1.1.3a.cmml">Softmax</mtext><mo id="S2.Ex13.m1.1.1.1.1.1.2" xref="S2.Ex13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex13.m1.1.1.1.1.1.1.1" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex13.m1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex13.m1.1.1.1.1.1.1.1.1" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">[</mo><msubsup id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐪</mi><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">𝐩</mi><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">]</mo></mrow><mo id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.2" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.2.cmml">𝐖</mi><mtext id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.3a.cmml">gate</mtext></msub></mrow><mo id="S2.Ex13.m1.1.1.1.1.1.1.1.1.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.3.cmml">+</mo><msub id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.2" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.2.cmml">𝐛</mi><mtext id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.3" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.3a.cmml">gate</mtext></msub></mrow><mo id="S2.Ex13.m1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex13.m1.2.2.2.3" rspace="0.837em" xref="S2.Ex13.m1.2.2.3a.cmml">,</mo><mrow id="S2.Ex13.m1.2.2.2.2" xref="S2.Ex13.m1.2.2.2.2.cmml"><msubsup id="S2.Ex13.m1.2.2.2.2.2" xref="S2.Ex13.m1.2.2.2.2.2.cmml"><mover accent="true" id="S2.Ex13.m1.2.2.2.2.2.2.2" xref="S2.Ex13.m1.2.2.2.2.2.2.2.cmml"><mi id="S2.Ex13.m1.2.2.2.2.2.2.2.2" xref="S2.Ex13.m1.2.2.2.2.2.2.2.2.cmml">𝐡</mi><mo id="S2.Ex13.m1.2.2.2.2.2.2.2.1" xref="S2.Ex13.m1.2.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S2.Ex13.m1.2.2.2.2.2.2.3" xref="S2.Ex13.m1.2.2.2.2.2.2.3.cmml">i</mi><mi id="S2.Ex13.m1.2.2.2.2.2.3" xref="S2.Ex13.m1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S2.Ex13.m1.2.2.2.2.1" xref="S2.Ex13.m1.2.2.2.2.1.cmml">=</mo><mrow id="S2.Ex13.m1.2.2.2.2.3" xref="S2.Ex13.m1.2.2.2.2.3.cmml"><mrow id="S2.Ex13.m1.2.2.2.2.3.2" xref="S2.Ex13.m1.2.2.2.2.3.2.cmml"><msub id="S2.Ex13.m1.2.2.2.2.3.2.2" xref="S2.Ex13.m1.2.2.2.2.3.2.2.cmml"><mi id="S2.Ex13.m1.2.2.2.2.3.2.2.2" xref="S2.Ex13.m1.2.2.2.2.3.2.2.2.cmml">β</mi><mn id="S2.Ex13.m1.2.2.2.2.3.2.2.3" xref="S2.Ex13.m1.2.2.2.2.3.2.2.3.cmml">1</mn></msub><mo id="S2.Ex13.m1.2.2.2.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex13.m1.2.2.2.2.3.2.1.cmml">⋅</mo><msubsup id="S2.Ex13.m1.2.2.2.2.3.2.3" xref="S2.Ex13.m1.2.2.2.2.3.2.3.cmml"><mi id="S2.Ex13.m1.2.2.2.2.3.2.3.2.2" xref="S2.Ex13.m1.2.2.2.2.3.2.3.2.2.cmml">𝐪</mi><mi id="S2.Ex13.m1.2.2.2.2.3.2.3.3" xref="S2.Ex13.m1.2.2.2.2.3.2.3.3.cmml">i</mi><mi id="S2.Ex13.m1.2.2.2.2.3.2.3.2.3" xref="S2.Ex13.m1.2.2.2.2.3.2.3.2.3.cmml">k</mi></msubsup></mrow><mo id="S2.Ex13.m1.2.2.2.2.3.1" xref="S2.Ex13.m1.2.2.2.2.3.1.cmml">+</mo><mrow id="S2.Ex13.m1.2.2.2.2.3.3" xref="S2.Ex13.m1.2.2.2.2.3.3.cmml"><msub id="S2.Ex13.m1.2.2.2.2.3.3.2" xref="S2.Ex13.m1.2.2.2.2.3.3.2.cmml"><mi id="S2.Ex13.m1.2.2.2.2.3.3.2.2" xref="S2.Ex13.m1.2.2.2.2.3.3.2.2.cmml">β</mi><mn id="S2.Ex13.m1.2.2.2.2.3.3.2.3" xref="S2.Ex13.m1.2.2.2.2.3.3.2.3.cmml">2</mn></msub><mo id="S2.Ex13.m1.2.2.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.Ex13.m1.2.2.2.2.3.3.1.cmml">⋅</mo><msubsup id="S2.Ex13.m1.2.2.2.2.3.3.3" xref="S2.Ex13.m1.2.2.2.2.3.3.3.cmml"><mi id="S2.Ex13.m1.2.2.2.2.3.3.3.2.2" xref="S2.Ex13.m1.2.2.2.2.3.3.3.2.2.cmml">𝐩</mi><mi id="S2.Ex13.m1.2.2.2.2.3.3.3.3" xref="S2.Ex13.m1.2.2.2.2.3.3.3.3.cmml">i</mi><mi id="S2.Ex13.m1.2.2.2.2.3.3.3.2.3" xref="S2.Ex13.m1.2.2.2.2.3.3.3.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex13.m1.2b"><apply id="S2.Ex13.m1.2.2.3.cmml" xref="S2.Ex13.m1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.3a.cmml" xref="S2.Ex13.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.Ex13.m1.1.1.1.1.cmml" xref="S2.Ex13.m1.1.1.1.1"><eq id="S2.Ex13.m1.1.1.1.1.2.cmml" xref="S2.Ex13.m1.1.1.1.1.2"></eq><ci id="S2.Ex13.m1.1.1.1.1.3.cmml" xref="S2.Ex13.m1.1.1.1.1.3">𝜷</ci><apply id="S2.Ex13.m1.1.1.1.1.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1"><times id="S2.Ex13.m1.1.1.1.1.1.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.2"></times><ci id="S2.Ex13.m1.1.1.1.1.1.3a.cmml" xref="S2.Ex13.m1.1.1.1.1.1.3"><mtext id="S2.Ex13.m1.1.1.1.1.1.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.3">Softmax</mtext></ci><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1"><plus id="S2.Ex13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.3"></plus><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2"><times id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.3"></times><interval closure="closed" id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐪</ci><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">𝐩</ci><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.2">𝐖</ci><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.3a.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.3"><mtext id="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.3.cmml" mathsize="70%" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.2.4.3">gate</mtext></ci></apply></apply><apply id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.2">𝐛</ci><ci id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.3a.cmml" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.3"><mtext id="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S2.Ex13.m1.1.1.1.1.1.1.1.1.4.3">gate</mtext></ci></apply></apply></apply></apply><apply id="S2.Ex13.m1.2.2.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2"><eq id="S2.Ex13.m1.2.2.2.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.1"></eq><apply id="S2.Ex13.m1.2.2.2.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.Ex13.m1.2.2.2.2.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.2.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.2">subscript</csymbol><apply id="S2.Ex13.m1.2.2.2.2.2.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.2.2.2"><ci id="S2.Ex13.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.2.2.2.1">~</ci><ci id="S2.Ex13.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.2.2.2.2">𝐡</ci></apply><ci id="S2.Ex13.m1.2.2.2.2.2.2.3.cmml" xref="S2.Ex13.m1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.Ex13.m1.2.2.2.2.2.3.cmml" xref="S2.Ex13.m1.2.2.2.2.2.3">𝑘</ci></apply><apply id="S2.Ex13.m1.2.2.2.2.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3"><plus id="S2.Ex13.m1.2.2.2.2.3.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.1"></plus><apply id="S2.Ex13.m1.2.2.2.2.3.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2"><ci id="S2.Ex13.m1.2.2.2.2.3.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.1">⋅</ci><apply id="S2.Ex13.m1.2.2.2.2.3.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.3.2.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.2">subscript</csymbol><ci id="S2.Ex13.m1.2.2.2.2.3.2.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.2.2">𝛽</ci><cn id="S2.Ex13.m1.2.2.2.2.3.2.2.3.cmml" type="integer" xref="S2.Ex13.m1.2.2.2.2.3.2.2.3">1</cn></apply><apply id="S2.Ex13.m1.2.2.2.2.3.2.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.3.2.3.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.3">subscript</csymbol><apply id="S2.Ex13.m1.2.2.2.2.3.2.3.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.3.2.3.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.3">superscript</csymbol><ci id="S2.Ex13.m1.2.2.2.2.3.2.3.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.3.2.2">𝐪</ci><ci id="S2.Ex13.m1.2.2.2.2.3.2.3.2.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.3.2.3">𝑘</ci></apply><ci id="S2.Ex13.m1.2.2.2.2.3.2.3.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3.2.3.3">𝑖</ci></apply></apply><apply id="S2.Ex13.m1.2.2.2.2.3.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3"><ci id="S2.Ex13.m1.2.2.2.2.3.3.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.1">⋅</ci><apply id="S2.Ex13.m1.2.2.2.2.3.3.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.3.3.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.2">subscript</csymbol><ci id="S2.Ex13.m1.2.2.2.2.3.3.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.2.2">𝛽</ci><cn id="S2.Ex13.m1.2.2.2.2.3.3.2.3.cmml" type="integer" xref="S2.Ex13.m1.2.2.2.2.3.3.2.3">2</cn></apply><apply id="S2.Ex13.m1.2.2.2.2.3.3.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.3.3.3.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.3">subscript</csymbol><apply id="S2.Ex13.m1.2.2.2.2.3.3.3.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S2.Ex13.m1.2.2.2.2.3.3.3.2.1.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.3">superscript</csymbol><ci id="S2.Ex13.m1.2.2.2.2.3.3.3.2.2.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.3.2.2">𝐩</ci><ci id="S2.Ex13.m1.2.2.2.2.3.3.3.2.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.3.2.3">𝑘</ci></apply><ci id="S2.Ex13.m1.2.2.2.2.3.3.3.3.cmml" xref="S2.Ex13.m1.2.2.2.2.3.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex13.m1.2c">\bm{\beta}=\text{Softmax}\big{(}[\mathbf{q}^{k}_{i},\mathbf{p}^{k}_{i}]\mathbf%
{W}_{\text{gate}}+\mathbf{b}_{\text{gate}}\big{)},\,\,\,\,\mathbf{\tilde{h}}_{%
i}^{k}=\beta_{1}\cdot\mathbf{q}^{k}_{i}+\beta_{2}\cdot\mathbf{p}^{k}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex13.m1.2d">bold_italic_β = Softmax ( [ bold_q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_p start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] bold_W start_POSTSUBSCRIPT gate end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT gate end_POSTSUBSCRIPT ) , over~ start_ARG bold_h end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT = italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋅ bold_q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⋅ bold_p start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p10.13">where <math alttext="\mathbf{W}_{\text{gate}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.5.m1.1"><semantics id="S2.SS3.SSS3.p10.5.m1.1a"><msub id="S2.SS3.SSS3.p10.5.m1.1.1" xref="S2.SS3.SSS3.p10.5.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p10.5.m1.1.1.2" xref="S2.SS3.SSS3.p10.5.m1.1.1.2.cmml">𝐖</mi><mtext id="S2.SS3.SSS3.p10.5.m1.1.1.3" xref="S2.SS3.SSS3.p10.5.m1.1.1.3a.cmml">gate</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.5.m1.1b"><apply id="S2.SS3.SSS3.p10.5.m1.1.1.cmml" xref="S2.SS3.SSS3.p10.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.5.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p10.5.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p10.5.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p10.5.m1.1.1.2">𝐖</ci><ci id="S2.SS3.SSS3.p10.5.m1.1.1.3a.cmml" xref="S2.SS3.SSS3.p10.5.m1.1.1.3"><mtext id="S2.SS3.SSS3.p10.5.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p10.5.m1.1.1.3">gate</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.5.m1.1c">\mathbf{W}_{\text{gate}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.5.m1.1d">bold_W start_POSTSUBSCRIPT gate end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{b}_{\text{gate}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.6.m2.1"><semantics id="S2.SS3.SSS3.p10.6.m2.1a"><msub id="S2.SS3.SSS3.p10.6.m2.1.1" xref="S2.SS3.SSS3.p10.6.m2.1.1.cmml"><mi id="S2.SS3.SSS3.p10.6.m2.1.1.2" xref="S2.SS3.SSS3.p10.6.m2.1.1.2.cmml">𝐛</mi><mtext id="S2.SS3.SSS3.p10.6.m2.1.1.3" xref="S2.SS3.SSS3.p10.6.m2.1.1.3a.cmml">gate</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.6.m2.1b"><apply id="S2.SS3.SSS3.p10.6.m2.1.1.cmml" xref="S2.SS3.SSS3.p10.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.6.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p10.6.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p10.6.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p10.6.m2.1.1.2">𝐛</ci><ci id="S2.SS3.SSS3.p10.6.m2.1.1.3a.cmml" xref="S2.SS3.SSS3.p10.6.m2.1.1.3"><mtext id="S2.SS3.SSS3.p10.6.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS3.SSS3.p10.6.m2.1.1.3">gate</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.6.m2.1c">\mathbf{b}_{\text{gate}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.6.m2.1d">bold_b start_POSTSUBSCRIPT gate end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters.
<math alttext="\beta_{1}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.7.m3.1"><semantics id="S2.SS3.SSS3.p10.7.m3.1a"><msub id="S2.SS3.SSS3.p10.7.m3.1.1" xref="S2.SS3.SSS3.p10.7.m3.1.1.cmml"><mi id="S2.SS3.SSS3.p10.7.m3.1.1.2" xref="S2.SS3.SSS3.p10.7.m3.1.1.2.cmml">β</mi><mn id="S2.SS3.SSS3.p10.7.m3.1.1.3" xref="S2.SS3.SSS3.p10.7.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.7.m3.1b"><apply id="S2.SS3.SSS3.p10.7.m3.1.1.cmml" xref="S2.SS3.SSS3.p10.7.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.7.m3.1.1.1.cmml" xref="S2.SS3.SSS3.p10.7.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p10.7.m3.1.1.2.cmml" xref="S2.SS3.SSS3.p10.7.m3.1.1.2">𝛽</ci><cn id="S2.SS3.SSS3.p10.7.m3.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p10.7.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.7.m3.1c">\beta_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.7.m3.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\beta_{2}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.8.m4.1"><semantics id="S2.SS3.SSS3.p10.8.m4.1a"><msub id="S2.SS3.SSS3.p10.8.m4.1.1" xref="S2.SS3.SSS3.p10.8.m4.1.1.cmml"><mi id="S2.SS3.SSS3.p10.8.m4.1.1.2" xref="S2.SS3.SSS3.p10.8.m4.1.1.2.cmml">β</mi><mn id="S2.SS3.SSS3.p10.8.m4.1.1.3" xref="S2.SS3.SSS3.p10.8.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.8.m4.1b"><apply id="S2.SS3.SSS3.p10.8.m4.1.1.cmml" xref="S2.SS3.SSS3.p10.8.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.8.m4.1.1.1.cmml" xref="S2.SS3.SSS3.p10.8.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p10.8.m4.1.1.2.cmml" xref="S2.SS3.SSS3.p10.8.m4.1.1.2">𝛽</ci><cn id="S2.SS3.SSS3.p10.8.m4.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p10.8.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.8.m4.1c">\beta_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.8.m4.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are gating values in the first and second dimensions of <math alttext="\bm{\beta}\in\mathbb{R}^{2}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.9.m5.1"><semantics id="S2.SS3.SSS3.p10.9.m5.1a"><mrow id="S2.SS3.SSS3.p10.9.m5.1.1" xref="S2.SS3.SSS3.p10.9.m5.1.1.cmml"><mi id="S2.SS3.SSS3.p10.9.m5.1.1.2" xref="S2.SS3.SSS3.p10.9.m5.1.1.2.cmml">𝜷</mi><mo id="S2.SS3.SSS3.p10.9.m5.1.1.1" xref="S2.SS3.SSS3.p10.9.m5.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS3.p10.9.m5.1.1.3" xref="S2.SS3.SSS3.p10.9.m5.1.1.3.cmml"><mi id="S2.SS3.SSS3.p10.9.m5.1.1.3.2" xref="S2.SS3.SSS3.p10.9.m5.1.1.3.2.cmml">ℝ</mi><mn id="S2.SS3.SSS3.p10.9.m5.1.1.3.3" xref="S2.SS3.SSS3.p10.9.m5.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.9.m5.1b"><apply id="S2.SS3.SSS3.p10.9.m5.1.1.cmml" xref="S2.SS3.SSS3.p10.9.m5.1.1"><in id="S2.SS3.SSS3.p10.9.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p10.9.m5.1.1.1"></in><ci id="S2.SS3.SSS3.p10.9.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p10.9.m5.1.1.2">𝜷</ci><apply id="S2.SS3.SSS3.p10.9.m5.1.1.3.cmml" xref="S2.SS3.SSS3.p10.9.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.9.m5.1.1.3.1.cmml" xref="S2.SS3.SSS3.p10.9.m5.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS3.p10.9.m5.1.1.3.2.cmml" xref="S2.SS3.SSS3.p10.9.m5.1.1.3.2">ℝ</ci><cn id="S2.SS3.SSS3.p10.9.m5.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS3.p10.9.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.9.m5.1c">\bm{\beta}\in\mathbb{R}^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.9.m5.1d">bold_italic_β ∈ blackboard_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively.
<math alttext="[*,*]" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.10.m6.2"><semantics id="S2.SS3.SSS3.p10.10.m6.2a"><mrow id="S2.SS3.SSS3.p10.10.m6.2.3.2" xref="S2.SS3.SSS3.p10.10.m6.2.3.1.cmml"><mo id="S2.SS3.SSS3.p10.10.m6.2.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p10.10.m6.2.3.1.cmml">[</mo><mo id="S2.SS3.SSS3.p10.10.m6.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS3.p10.10.m6.1.1.cmml">∗</mo><mo id="S2.SS3.SSS3.p10.10.m6.2.3.2.2" rspace="0em" xref="S2.SS3.SSS3.p10.10.m6.2.3.1.cmml">,</mo><mo id="S2.SS3.SSS3.p10.10.m6.2.2" lspace="0em" rspace="0em" xref="S2.SS3.SSS3.p10.10.m6.2.2.cmml">∗</mo><mo id="S2.SS3.SSS3.p10.10.m6.2.3.2.3" stretchy="false" xref="S2.SS3.SSS3.p10.10.m6.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.10.m6.2b"><interval closure="closed" id="S2.SS3.SSS3.p10.10.m6.2.3.1.cmml" xref="S2.SS3.SSS3.p10.10.m6.2.3.2"><times id="S2.SS3.SSS3.p10.10.m6.1.1.cmml" xref="S2.SS3.SSS3.p10.10.m6.1.1"></times><times id="S2.SS3.SSS3.p10.10.m6.2.2.cmml" xref="S2.SS3.SSS3.p10.10.m6.2.2"></times></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.10.m6.2c">[*,*]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.10.m6.2d">[ ∗ , ∗ ]</annotation></semantics></math> indicates the concatenation operation.
<math alttext="\mathbf{\tilde{h}}_{i}^{k}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.11.m7.1"><semantics id="S2.SS3.SSS3.p10.11.m7.1a"><msubsup id="S2.SS3.SSS3.p10.11.m7.1.1" xref="S2.SS3.SSS3.p10.11.m7.1.1.cmml"><mover accent="true" id="S2.SS3.SSS3.p10.11.m7.1.1.2.2" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.2.cmml"><mi id="S2.SS3.SSS3.p10.11.m7.1.1.2.2.2" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.2.2.cmml">𝐡</mi><mo id="S2.SS3.SSS3.p10.11.m7.1.1.2.2.1" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.2.1.cmml">~</mo></mover><mi id="S2.SS3.SSS3.p10.11.m7.1.1.2.3" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.3.cmml">i</mi><mi id="S2.SS3.SSS3.p10.11.m7.1.1.3" xref="S2.SS3.SSS3.p10.11.m7.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.11.m7.1b"><apply id="S2.SS3.SSS3.p10.11.m7.1.1.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.11.m7.1.1.1.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1">superscript</csymbol><apply id="S2.SS3.SSS3.p10.11.m7.1.1.2.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.11.m7.1.1.2.1.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p10.11.m7.1.1.2.2.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.2"><ci id="S2.SS3.SSS3.p10.11.m7.1.1.2.2.1.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.2.1">~</ci><ci id="S2.SS3.SSS3.p10.11.m7.1.1.2.2.2.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.2.2">𝐡</ci></apply><ci id="S2.SS3.SSS3.p10.11.m7.1.1.2.3.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1.2.3">𝑖</ci></apply><ci id="S2.SS3.SSS3.p10.11.m7.1.1.3.cmml" xref="S2.SS3.SSS3.p10.11.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.11.m7.1c">\mathbf{\tilde{h}}_{i}^{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.11.m7.1d">over~ start_ARG bold_h end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> is passed to the recommendation adapter in <math alttext="k-" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.12.m8.1"><semantics id="S2.SS3.SSS3.p10.12.m8.1a"><mrow id="S2.SS3.SSS3.p10.12.m8.1.1" xref="S2.SS3.SSS3.p10.12.m8.1.1.cmml"><mi id="S2.SS3.SSS3.p10.12.m8.1.1.2" xref="S2.SS3.SSS3.p10.12.m8.1.1.2.cmml">k</mi><mo id="S2.SS3.SSS3.p10.12.m8.1.1.3" xref="S2.SS3.SSS3.p10.12.m8.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.12.m8.1b"><apply id="S2.SS3.SSS3.p10.12.m8.1.1.cmml" xref="S2.SS3.SSS3.p10.12.m8.1.1"><csymbol cd="latexml" id="S2.SS3.SSS3.p10.12.m8.1.1.1.cmml" xref="S2.SS3.SSS3.p10.12.m8.1.1">limit-from</csymbol><ci id="S2.SS3.SSS3.p10.12.m8.1.1.2.cmml" xref="S2.SS3.SSS3.p10.12.m8.1.1.2">𝑘</ci><minus id="S2.SS3.SSS3.p10.12.m8.1.1.3.cmml" xref="S2.SS3.SSS3.p10.12.m8.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.12.m8.1c">k-</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.12.m8.1d">italic_k -</annotation></semantics></math>th DAMoE layer to produce <math alttext="\mathbf{h}^{k}_{i}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p10.13.m9.1"><semantics id="S2.SS3.SSS3.p10.13.m9.1a"><msubsup id="S2.SS3.SSS3.p10.13.m9.1.1" xref="S2.SS3.SSS3.p10.13.m9.1.1.cmml"><mi id="S2.SS3.SSS3.p10.13.m9.1.1.2.2" xref="S2.SS3.SSS3.p10.13.m9.1.1.2.2.cmml">𝐡</mi><mi id="S2.SS3.SSS3.p10.13.m9.1.1.3" xref="S2.SS3.SSS3.p10.13.m9.1.1.3.cmml">i</mi><mi id="S2.SS3.SSS3.p10.13.m9.1.1.2.3" xref="S2.SS3.SSS3.p10.13.m9.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p10.13.m9.1b"><apply id="S2.SS3.SSS3.p10.13.m9.1.1.cmml" xref="S2.SS3.SSS3.p10.13.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.13.m9.1.1.1.cmml" xref="S2.SS3.SSS3.p10.13.m9.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p10.13.m9.1.1.2.cmml" xref="S2.SS3.SSS3.p10.13.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p10.13.m9.1.1.2.1.cmml" xref="S2.SS3.SSS3.p10.13.m9.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p10.13.m9.1.1.2.2.cmml" xref="S2.SS3.SSS3.p10.13.m9.1.1.2.2">𝐡</ci><ci id="S2.SS3.SSS3.p10.13.m9.1.1.2.3.cmml" xref="S2.SS3.SSS3.p10.13.m9.1.1.2.3">𝑘</ci></apply><ci id="S2.SS3.SSS3.p10.13.m9.1.1.3.cmml" xref="S2.SS3.SSS3.p10.13.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p10.13.m9.1c">\mathbf{h}^{k}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p10.13.m9.1d">bold_h start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4. </span>Putting All Together</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.4">The overall objective is the combination of several adaption task losses:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{\text{seq}}+\lambda_{1}\mathcal{L}_{\text{align}}+%
\lambda_{2}\mathcal{L}_{\text{cl}}+\lambda_{3}\mathcal{L}_{\text{cf}}," class="ltx_Math" display="block" id="S2.Ex14.m1.1"><semantics id="S2.Ex14.m1.1a"><mrow id="S2.Ex14.m1.1.1.1" xref="S2.Ex14.m1.1.1.1.1.cmml"><mrow id="S2.Ex14.m1.1.1.1.1" xref="S2.Ex14.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex14.m1.1.1.1.1.2" xref="S2.Ex14.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S2.Ex14.m1.1.1.1.1.1" xref="S2.Ex14.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.Ex14.m1.1.1.1.1.3" xref="S2.Ex14.m1.1.1.1.1.3.cmml"><msub id="S2.Ex14.m1.1.1.1.1.3.2" xref="S2.Ex14.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex14.m1.1.1.1.1.3.2.2" xref="S2.Ex14.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S2.Ex14.m1.1.1.1.1.3.2.3" xref="S2.Ex14.m1.1.1.1.1.3.2.3a.cmml">seq</mtext></msub><mo id="S2.Ex14.m1.1.1.1.1.3.1" xref="S2.Ex14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.Ex14.m1.1.1.1.1.3.3" xref="S2.Ex14.m1.1.1.1.1.3.3.cmml"><msub id="S2.Ex14.m1.1.1.1.1.3.3.2" xref="S2.Ex14.m1.1.1.1.1.3.3.2.cmml"><mi id="S2.Ex14.m1.1.1.1.1.3.3.2.2" xref="S2.Ex14.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mn id="S2.Ex14.m1.1.1.1.1.3.3.2.3" xref="S2.Ex14.m1.1.1.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S2.Ex14.m1.1.1.1.1.3.3.1" xref="S2.Ex14.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.Ex14.m1.1.1.1.1.3.3.3" xref="S2.Ex14.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex14.m1.1.1.1.1.3.3.3.2" xref="S2.Ex14.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S2.Ex14.m1.1.1.1.1.3.3.3.3" xref="S2.Ex14.m1.1.1.1.1.3.3.3.3a.cmml">align</mtext></msub></mrow><mo id="S2.Ex14.m1.1.1.1.1.3.1a" xref="S2.Ex14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.Ex14.m1.1.1.1.1.3.4" xref="S2.Ex14.m1.1.1.1.1.3.4.cmml"><msub id="S2.Ex14.m1.1.1.1.1.3.4.2" xref="S2.Ex14.m1.1.1.1.1.3.4.2.cmml"><mi id="S2.Ex14.m1.1.1.1.1.3.4.2.2" xref="S2.Ex14.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mn id="S2.Ex14.m1.1.1.1.1.3.4.2.3" xref="S2.Ex14.m1.1.1.1.1.3.4.2.3.cmml">2</mn></msub><mo id="S2.Ex14.m1.1.1.1.1.3.4.1" xref="S2.Ex14.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S2.Ex14.m1.1.1.1.1.3.4.3" xref="S2.Ex14.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex14.m1.1.1.1.1.3.4.3.2" xref="S2.Ex14.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mtext id="S2.Ex14.m1.1.1.1.1.3.4.3.3" xref="S2.Ex14.m1.1.1.1.1.3.4.3.3a.cmml">cl</mtext></msub></mrow><mo id="S2.Ex14.m1.1.1.1.1.3.1b" xref="S2.Ex14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.Ex14.m1.1.1.1.1.3.5" xref="S2.Ex14.m1.1.1.1.1.3.5.cmml"><msub id="S2.Ex14.m1.1.1.1.1.3.5.2" xref="S2.Ex14.m1.1.1.1.1.3.5.2.cmml"><mi id="S2.Ex14.m1.1.1.1.1.3.5.2.2" xref="S2.Ex14.m1.1.1.1.1.3.5.2.2.cmml">λ</mi><mn id="S2.Ex14.m1.1.1.1.1.3.5.2.3" xref="S2.Ex14.m1.1.1.1.1.3.5.2.3.cmml">3</mn></msub><mo id="S2.Ex14.m1.1.1.1.1.3.5.1" xref="S2.Ex14.m1.1.1.1.1.3.5.1.cmml">⁢</mo><msub id="S2.Ex14.m1.1.1.1.1.3.5.3" xref="S2.Ex14.m1.1.1.1.1.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex14.m1.1.1.1.1.3.5.3.2" xref="S2.Ex14.m1.1.1.1.1.3.5.3.2.cmml">ℒ</mi><mtext id="S2.Ex14.m1.1.1.1.1.3.5.3.3" xref="S2.Ex14.m1.1.1.1.1.3.5.3.3a.cmml">cf</mtext></msub></mrow></mrow></mrow><mo id="S2.Ex14.m1.1.1.1.2" xref="S2.Ex14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex14.m1.1b"><apply id="S2.Ex14.m1.1.1.1.1.cmml" xref="S2.Ex14.m1.1.1.1"><eq id="S2.Ex14.m1.1.1.1.1.1.cmml" xref="S2.Ex14.m1.1.1.1.1.1"></eq><ci id="S2.Ex14.m1.1.1.1.1.2.cmml" xref="S2.Ex14.m1.1.1.1.1.2">ℒ</ci><apply id="S2.Ex14.m1.1.1.1.1.3.cmml" xref="S2.Ex14.m1.1.1.1.1.3"><plus id="S2.Ex14.m1.1.1.1.1.3.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.1"></plus><apply id="S2.Ex14.m1.1.1.1.1.3.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex14.m1.1.1.1.1.3.2.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex14.m1.1.1.1.1.3.2.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S2.Ex14.m1.1.1.1.1.3.2.3a.cmml" xref="S2.Ex14.m1.1.1.1.1.3.2.3"><mtext id="S2.Ex14.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S2.Ex14.m1.1.1.1.1.3.2.3">seq</mtext></ci></apply><apply id="S2.Ex14.m1.1.1.1.1.3.3.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3"><times id="S2.Ex14.m1.1.1.1.1.3.3.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.1"></times><apply id="S2.Ex14.m1.1.1.1.1.3.3.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.Ex14.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.Ex14.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.2.2">𝜆</ci><cn id="S2.Ex14.m1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S2.Ex14.m1.1.1.1.1.3.3.2.3">1</cn></apply><apply id="S2.Ex14.m1.1.1.1.1.3.3.3.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.Ex14.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.Ex14.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S2.Ex14.m1.1.1.1.1.3.3.3.3a.cmml" xref="S2.Ex14.m1.1.1.1.1.3.3.3.3"><mtext id="S2.Ex14.m1.1.1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S2.Ex14.m1.1.1.1.1.3.3.3.3">align</mtext></ci></apply></apply><apply id="S2.Ex14.m1.1.1.1.1.3.4.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4"><times id="S2.Ex14.m1.1.1.1.1.3.4.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.1"></times><apply id="S2.Ex14.m1.1.1.1.1.3.4.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S2.Ex14.m1.1.1.1.1.3.4.2.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S2.Ex14.m1.1.1.1.1.3.4.2.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.2.2">𝜆</ci><cn id="S2.Ex14.m1.1.1.1.1.3.4.2.3.cmml" type="integer" xref="S2.Ex14.m1.1.1.1.1.3.4.2.3">2</cn></apply><apply id="S2.Ex14.m1.1.1.1.1.3.4.3.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.Ex14.m1.1.1.1.1.3.4.3.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S2.Ex14.m1.1.1.1.1.3.4.3.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S2.Ex14.m1.1.1.1.1.3.4.3.3a.cmml" xref="S2.Ex14.m1.1.1.1.1.3.4.3.3"><mtext id="S2.Ex14.m1.1.1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S2.Ex14.m1.1.1.1.1.3.4.3.3">cl</mtext></ci></apply></apply><apply id="S2.Ex14.m1.1.1.1.1.3.5.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5"><times id="S2.Ex14.m1.1.1.1.1.3.5.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.1"></times><apply id="S2.Ex14.m1.1.1.1.1.3.5.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.2"><csymbol cd="ambiguous" id="S2.Ex14.m1.1.1.1.1.3.5.2.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.2">subscript</csymbol><ci id="S2.Ex14.m1.1.1.1.1.3.5.2.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.2.2">𝜆</ci><cn id="S2.Ex14.m1.1.1.1.1.3.5.2.3.cmml" type="integer" xref="S2.Ex14.m1.1.1.1.1.3.5.2.3">3</cn></apply><apply id="S2.Ex14.m1.1.1.1.1.3.5.3.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="S2.Ex14.m1.1.1.1.1.3.5.3.1.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="S2.Ex14.m1.1.1.1.1.3.5.3.2.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.3.2">ℒ</ci><ci id="S2.Ex14.m1.1.1.1.1.3.5.3.3a.cmml" xref="S2.Ex14.m1.1.1.1.1.3.5.3.3"><mtext id="S2.Ex14.m1.1.1.1.1.3.5.3.3.cmml" mathsize="70%" xref="S2.Ex14.m1.1.1.1.1.3.5.3.3">cf</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex14.m1.1c">\mathcal{L}=\mathcal{L}_{\text{seq}}+\lambda_{1}\mathcal{L}_{\text{align}}+%
\lambda_{2}\mathcal{L}_{\text{cl}}+\lambda_{3}\mathcal{L}_{\text{cf}},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex14.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT seq end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT align end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT cl end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT cf end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p1.3">where <math alttext="\lambda_{1}" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><msub id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mi id="S2.SS4.p1.1.m1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.2.cmml">λ</mi><mn id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2">𝜆</ci><cn id="S2.SS4.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS4.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\lambda_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\lambda_{2}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><msub id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">λ</mi><mn id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝜆</ci><cn id="S2.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS4.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\lambda_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{3}" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><msub id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2" xref="S2.SS4.p1.3.m3.1.1.2.cmml">λ</mi><mn id="S2.SS4.p1.3.m3.1.1.3" xref="S2.SS4.p1.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2">𝜆</ci><cn id="S2.SS4.p1.3.m3.1.1.3.cmml" type="integer" xref="S2.SS4.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">\lambda_{3}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">italic_λ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> are task weights.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">The overall workflow of <span class="ltx_text ltx_font_smallcaps" id="S2.SS4.p2.1.1">MixRec</span> is as follows: First, we apply Bayesian optimization on a subset of the data (<math alttext="\text{Data}_{\text{BO}}" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><msub id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><mtext id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2a.cmml">Data</mtext><mtext id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3a.cmml">BO</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.2a.cmml" xref="S2.SS4.p2.1.m1.1.1.2"><mtext id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">Data</mtext></ci><ci id="S2.SS4.p2.1.m1.1.1.3a.cmml" xref="S2.SS4.p2.1.m1.1.1.3"><mtext id="S2.SS4.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS4.p2.1.m1.1.1.3">BO</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">\text{Data}_{\text{BO}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">Data start_POSTSUBSCRIPT BO end_POSTSUBSCRIPT</annotation></semantics></math>) to search the suitable structure of DAMoE.
Then, we train <span class="ltx_text ltx_font_smallcaps" id="S2.SS4.p2.1.2">MixRec</span> on the full dataset for sequential recommendation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Experiment</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Experimental Settings</h3>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span>Datasets</h4>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of the datasets after preprocessing. “Avg. Items” denotes the average number of items in sequences.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:238.1pt;height:97.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.2pt,5.4pt) scale(0.9,0.9) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1.1">Datasets</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.2.1">#Users</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.3.1">#Items</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.4.1">#Inter.</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.5.1">Avg. Items</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.1.1">Arts</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.2">56,083</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.3">22,685</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.4">364,356</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.5">8.50</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.1.1">Scientific</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.2">10,973</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.3">5,193</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.4">54,183</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.5">6.94</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.4.3.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.3.1.1">Instruments</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.2">27,518</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.3">10,535</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.4">171,108</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.5">8.22</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.1.5.4.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.5.4.1.1">Pantry</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.2">14,178</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.3">4,961</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.4">102,661</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.5">9.24</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.1.1.6.5.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.5.1.1">Games</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.5.2">55,126</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.5.3">17,277</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.5.4">356,954</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.6.5.5">8.48</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Performance comparison of different methods. The best performance is highlighted in bold, while the second-best performance is underlined. The last column indicates the improvements over the best baseline models. All improvements are significant at <math alttext="p&lt;0.01" class="ltx_Math" display="inline" id="S3.T2.2.m1.1"><semantics id="S3.T2.2.m1.1b"><mrow id="S3.T2.2.m1.1.1" xref="S3.T2.2.m1.1.1.cmml"><mi id="S3.T2.2.m1.1.1.2" xref="S3.T2.2.m1.1.1.2.cmml">p</mi><mo id="S3.T2.2.m1.1.1.1" xref="S3.T2.2.m1.1.1.1.cmml">&lt;</mo><mn id="S3.T2.2.m1.1.1.3" xref="S3.T2.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.2.m1.1c"><apply id="S3.T2.2.m1.1.1.cmml" xref="S3.T2.2.m1.1.1"><lt id="S3.T2.2.m1.1.1.1.cmml" xref="S3.T2.2.m1.1.1.1"></lt><ci id="S3.T2.2.m1.1.1.2.cmml" xref="S3.T2.2.m1.1.1.2">𝑝</ci><cn id="S3.T2.2.m1.1.1.3.cmml" type="float" xref="S3.T2.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.m1.1d">p&lt;0.01</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.m1.1e">italic_p &lt; 0.01</annotation></semantics></math> compared to the best baseline under the paired t-test.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T2.3" style="width:592.0pt;height:282.4pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-25.7pt,12.2pt) scale(0.92,0.92) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.3.1.1.1">
<td class="ltx_td ltx_border_tt" id="S3.T2.3.1.1.1.1"></td>
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S3.T2.3.1.1.1.2"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S3.T2.3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.1.1.3.1">Non-LLM-based SRS</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S3.T2.3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.1.1.4.1">LLM-based SRS</span></th>
<td class="ltx_td ltx_border_tt" id="S3.T2.3.1.1.1.5"></td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.3.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.3.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.2.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.3.1">GRU4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.4.1">SASRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.5"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.5.1">BERT4Rec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.6"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.6.1">FDSA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.7"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.7.1">P5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.8"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.8.1">UniSRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.9"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.9.1">RecFormer</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.10.1">LLMRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.3.1.2.2.11"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S3.T2.3.1.2.2.11.1">MixRec</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.3.1.2.2.12"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.2.2.12.1">Improv.</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.1" rowspan="3"><span class="ltx_text" id="S3.T2.3.1.3.3.1.1">Arts</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.2">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.3">0.1118</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.4">0.1236</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.5">0.0950</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.6">0.1254</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.7">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.3.3.7.1">\ul</span>0.1286</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.8">0.0694</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.9">0.1251</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.10">0.0792</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.11"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.3.3.11.1">0.1400</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.3.3.12">8.86%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.4.4">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.1">Recall@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.2">0.1365</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.3">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.4.4.3.1">\ul</span>0.1619</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.4">0.1255</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.5">0.1569</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.6">0.1482</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.7">0.1263</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.8">0.1580</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.9">0.1054</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.4.4.10.1">0.1767</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.4.4.11">9.15%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.5.5">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.1">MRR</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.2">0.1082</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.3">0.1164</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.4">0.0890</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.5">0.1198</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.6">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.5.5.6.1">\ul</span>0.1234</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.7">0.0566</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.8">0.1198</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.9">0.0744</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.5.5.10.1">0.1340</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.5.5.11">8.57%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.1" rowspan="3"><span class="ltx_text" id="S3.T2.3.1.6.6.1.1">Scientific</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.2">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.3">0.0799</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.4">0.1001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.5">0.0704</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.6">0.1018</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.7">0.1031</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.8">0.0656</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.9">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.6.6.9.1">\ul</span>0.1040</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.10">0.0520</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.11"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.6.6.11.1">0.1162</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.6.6.12">11.66%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.7.7">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.1">Recall@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.2">0.1048</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.3">0.1430</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.4">0.0995</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.5">0.1337</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.6">0.1257</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.7">0.1226</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.8">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.7.7.8.1">\ul</span>0.1468</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.9">0.0745</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.7.7.10.1">0.1529</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.7.7.11">4.15%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.8.8">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.1">MRR</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.2">0.0771</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.3">0.0919</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.4">0.0654</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.5">0.0962</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.6">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.8.8.6.1">\ul</span>0.0977</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.7">0.0535</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.8">0.0966</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.9">0.0495</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.8.8.10.1">0.1105</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.8.8.11">13.08%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.1" rowspan="3"><span class="ltx_text" id="S3.T2.3.1.9.9.1.1">Instruments</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.2">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.3">0.0797</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.4">0.0866</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.5">0.0703</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.6">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.9.9.6.1">\ul</span>0.0889</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.7">0.0847</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.8">0.0700</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.9">0.0821</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.10">0.0486</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.11"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.9.9.11.1">0.0966</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.9.9.12">8.61%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.10.10">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.1">Recall@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.2">0.1047</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.3">0.1175</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.4">0.0906</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.5">0.1157</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.6">0.1056</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.7">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.10.10.7.1">\ul</span>0.1210</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.8">0.1030</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.9">0.0689</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.10.10.10.1">0.1283</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.10.10.11">6.00%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.11.11">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.1">MRR</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.2">0.0768</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.3">0.0825</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.4">0.0682</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.5">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.11.11.5.1">\ul</span>0.0857</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.6">0.0801</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.7">0.0591</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.8">0.0803</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.9">0.0470</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.11.11.10.1">0.0927</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.11.11.11">8.20%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.12.12">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.1" rowspan="3"><span class="ltx_text" id="S3.T2.3.1.12.12.1.1">Pantry</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.2">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.3">0.0453</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.4">0.0570</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.5">0.0373</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.6">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.12.12.6.1">\ul</span>0.0618</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.7">0.0409</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.8">0.0345</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.9">0.0566</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.10">0.0251</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.11"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.12.12.11.1">0.0689</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.12.12.12">11.41%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.13.13">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.1">Recall@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.2">0.0673</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.3">0.0887</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.4">0.0552</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.5">0.0848</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.6">0.0529</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.7">0.0731</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.8">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.13.13.8.1">\ul</span>0.0888</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.9">0.0392</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.13.13.10.1">0.1036</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.13.13.11">16.70%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.14.14">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.1">MRR</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.2">0.0435</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.3">0.0524</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.4">0.0363</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.5">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.14.14.5.1">\ul</span>0.0597</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.6">0.0389</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.7">0.0278</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.8">0.0513</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.9">0.0251</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.14.14.10.1">0.0638</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.14.14.11">6.84%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.15.15">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.3.1.15.15.1" rowspan="3"><span class="ltx_text" id="S3.T2.3.1.15.15.1.1">Games</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.2">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.3">0.0743</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.4">0.0802</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.5">0.0604</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.6">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.15.15.6.1">\ul</span>0.0860</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.7">0.0568</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.8">0.0489</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.9">0.0675</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.10">0.0339</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.11"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.15.15.11.1">0.0895</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.15.15.12">4.05%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.16.16">
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.1">Recall@10</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.2">0.1142</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.3">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.16.16.3.1">\ul</span>0.1322</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.4">0.0914</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.5">0.1273</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.6">0.0729</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.7">0.1020</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.8">0.1027</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.9">0.0534</td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.16.16.10.1">0.1358</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.3.1.16.16.11">2.73%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.3.1.17.17">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.1">MRR</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.2">0.0697</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.3">0.0728</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.4">0.0576</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.5">
<span class="ltx_ERROR undefined" id="S3.T2.3.1.17.17.5.1">\ul</span>0.0810</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.6">0.0535</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.7">0.0399</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.8">0.0513</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.9">0.0325</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.10"><span class="ltx_text ltx_font_bold" id="S3.T2.3.1.17.17.10.1">0.0839</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.3.1.17.17.11">3.55%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.3">We use five sub-categories of Amazon datasets<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2" title="">https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2</a></span></span></span> in our experiments, including “Arts, Crafts, and Sewing” (Arts), “Industrial and Scientific” (Scientific), “Musical Instruments” (Instruments), “Prime Pantry” (Pantry) and “Video Games” (Games).
We filter items without titles and items with fewer than four interactions.
Tab. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.T1" title="Table 1 ‣ 3.1.1. Datasets ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> presents the statistics of the data.
We randomly selected <math alttext="b\%" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.1.m1.1"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mrow id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.1.1.2" xref="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml">b</mi><mo id="S3.SS1.SSS1.p1.1.m1.1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><apply id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.1">percent</csymbol><ci id="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.2">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">b\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.1.m1.1d">italic_b %</annotation></semantics></math> of the data as <math alttext="\text{Data}_{\text{BO}}" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.2.m2.1"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><msub id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml"><mtext id="S3.SS1.SSS1.p1.2.m2.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.2a.cmml">Data</mtext><mtext id="S3.SS1.SSS1.p1.2.m2.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.3a.cmml">BO</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.1.1.2a.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.2"><mtext id="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.2">Data</mtext></ci><ci id="S3.SS1.SSS1.p1.2.m2.1.1.3a.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3"><mtext id="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS1.p1.2.m2.1.1.3">BO</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">\text{Data}_{\text{BO}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.2.m2.1d">Data start_POSTSUBSCRIPT BO end_POSTSUBSCRIPT</annotation></semantics></math> for Bayesian optimization <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib33" title="">2019b</a>; Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib2" title="">2019</a>)</cite>.
<math alttext="b\%" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.3.m3.1"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><mrow id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml">b</mi><mo id="S3.SS1.SSS1.p1.3.m3.1.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.1">percent</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.2">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">b\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.3.m3.1d">italic_b %</annotation></semantics></math> for each dataset is listed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A6" title="Appendix F Hyper-Parameters for Different Datasets ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2. </span>Evaluation</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">We apply leave-one-out for evaluating SRS <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib26" title="">2018</a>)</cite>: the most recent item in the interaction sequence is used for testing, the second most recent item is for validation, and the remaining items are for training.
We adopt three popular evaluation metrics for SRS: Mean Reciprocal Rank (MRR), Recall@N, and Normalized Discounted Cumulative Gain (NDCG@N), where N is set to 10.
We rank the ground-truth item of each sequence among all items and report the average scores across all sequences on the test set.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3. </span>Baselines</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.2">We compare <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS3.p1.2.2">MixRec</span> with various baselines, including (1) None-LLM-based SRS:
GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib19" title="">2016</a>)</cite>, SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib26" title="">2018</a>)</cite>, BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib44" title="">2019</a>)</cite> and FDSA <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib58" title="">2019</a>)</cite>.
(2) LLM-based SRS: P5<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/jeykigung/P5" title="">https://github.com/jeykigung/P5</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib11" title="">2022</a>)</cite>, UniSRec<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/RUCAIBox/UniSRec" title="">https://github.com/RUCAIBox/UniSRec</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib20" title="">2022</a>)</cite>, RecFormer<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/JiachengLi1995/RecFormer" title="">https://github.com/JiachengLi1995/RecFormer</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib29" title="">2023b</a>)</cite> and LLMRec.
LLMRec removes adapter blocks from <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS3.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.1.1.m1.1"><semantics id="S3.SS1.SSS3.p1.1.1.m1.1a"><msub id="S3.SS1.SSS3.p1.1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS3.p1.1.1.m1.1.1a" xref="S3.SS1.SSS3.p1.1.1.m1.1.1.cmml"></mi><mtext id="S3.SS1.SSS3.p1.1.1.m1.1.1.1" xref="S3.SS1.SSS3.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.1.m1.1b"><apply id="S3.SS1.SSS3.p1.1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.1.m1.1.1"><ci id="S3.SS1.SSS3.p1.1.1.m1.1.1.1a.cmml" xref="S3.SS1.SSS3.p1.1.1.m1.1.1.1"><mtext id="S3.SS1.SSS3.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.SS1.SSS3.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>) and freezes LLM during fine-tuning.
It is optimized with <math alttext="\mathcal{L}_{\text{seq}}" class="ltx_Math" display="inline" id="S3.SS1.SSS3.p1.2.m1.1"><semantics id="S3.SS1.SSS3.p1.2.m1.1a"><msub id="S3.SS1.SSS3.p1.2.m1.1.1" xref="S3.SS1.SSS3.p1.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.2.m1.1.1.2" xref="S3.SS1.SSS3.p1.2.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS3.p1.2.m1.1.1.3" xref="S3.SS1.SSS3.p1.2.m1.1.1.3a.cmml">seq</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m1.1b"><apply id="S3.SS1.SSS3.p1.2.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.2.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.2.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p1.2.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS3.p1.2.m1.1.1.3a.cmml" xref="S3.SS1.SSS3.p1.2.m1.1.1.3"><mtext id="S3.SS1.SSS3.p1.2.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS3.p1.2.m1.1.1.3">seq</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m1.1c">\mathcal{L}_{\text{seq}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS3.p1.2.m1.1d">caligraphic_L start_POSTSUBSCRIPT seq end_POSTSUBSCRIPT</annotation></semantics></math> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS3" title="2.2.3. Link Next Item ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>).
The descriptions of baselines are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A7" title="Appendix G Baselines ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">G</span></a>.
For a fair comparison, we only consider methods that rank all items as baselines.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4. </span>Implementation</h4>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.1">We use RecBole<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/RUCAIBox/RecBole" title="">https://github.com/RUCAIBox/RecBole</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib54" title="">2023</a>)</cite> to implement GRU4Rec, SASRec, BERT4Rec and FDSA. For other methods, we use implementations provided by the authors.
We use the small version for P5.
Other parameters are set following default configurations.</p>
</div>
<div class="ltx_para" id="S3.SS1.SSS4.p2">
<p class="ltx_p" id="S3.SS1.SSS4.p2.9">We train <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS4.p2.9.2">MixRec</span> on a machine with four NVIDIA RTX 3090 GPUs using the AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib36" title="">2019</a>)</cite>.
We employ the pre-trained OPT-125M<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/facebook/opt-125m" title="">https://huggingface.co/facebook/opt-125m</a></span></span></span> as the backbone of <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS4.p2.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.1.1.m1.1"><semantics id="S3.SS1.SSS4.p2.1.1.m1.1a"><msub id="S3.SS1.SSS4.p2.1.1.m1.1.1" xref="S3.SS1.SSS4.p2.1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS4.p2.1.1.m1.1.1a" xref="S3.SS1.SSS4.p2.1.1.m1.1.1.cmml"></mi><mtext id="S3.SS1.SSS4.p2.1.1.m1.1.1.1" xref="S3.SS1.SSS4.p2.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.1.1.m1.1b"><apply id="S3.SS1.SSS4.p2.1.1.m1.1.1.cmml" xref="S3.SS1.SSS4.p2.1.1.m1.1.1"><ci id="S3.SS1.SSS4.p2.1.1.m1.1.1.1a.cmml" xref="S3.SS1.SSS4.p2.1.1.m1.1.1.1"><mtext id="S3.SS1.SSS4.p2.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.SS1.SSS4.p2.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> and <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS4.p2.9.3">MixRec</span>.
OPT-125M is one of the most widely used decoder-only models.
By default, we use Neural Collaborative Filtering (NCF) <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib18" title="">2017</a>)</cite> as CF model in <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.SSS4.p2.9.4">MixRec</span>.
In Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS4" title="3.4. Effects of Using Different CF Models ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3.4</span></a>, we will compare the results using different CF models.
We set the number of epochs to 40 and choose <math alttext="5\times 10^{-5}" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.2.m1.1"><semantics id="S3.SS1.SSS4.p2.2.m1.1a"><mrow id="S3.SS1.SSS4.p2.2.m1.1.1" xref="S3.SS1.SSS4.p2.2.m1.1.1.cmml"><mn id="S3.SS1.SSS4.p2.2.m1.1.1.2" xref="S3.SS1.SSS4.p2.2.m1.1.1.2.cmml">5</mn><mo id="S3.SS1.SSS4.p2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS4.p2.2.m1.1.1.1.cmml">×</mo><msup id="S3.SS1.SSS4.p2.2.m1.1.1.3" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.cmml"><mn id="S3.SS1.SSS4.p2.2.m1.1.1.3.2" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.2.cmml">10</mn><mrow id="S3.SS1.SSS4.p2.2.m1.1.1.3.3" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.3.cmml"><mo id="S3.SS1.SSS4.p2.2.m1.1.1.3.3a" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.3.cmml">−</mo><mn id="S3.SS1.SSS4.p2.2.m1.1.1.3.3.2" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.2.m1.1b"><apply id="S3.SS1.SSS4.p2.2.m1.1.1.cmml" xref="S3.SS1.SSS4.p2.2.m1.1.1"><times id="S3.SS1.SSS4.p2.2.m1.1.1.1.cmml" xref="S3.SS1.SSS4.p2.2.m1.1.1.1"></times><cn id="S3.SS1.SSS4.p2.2.m1.1.1.2.cmml" type="integer" xref="S3.SS1.SSS4.p2.2.m1.1.1.2">5</cn><apply id="S3.SS1.SSS4.p2.2.m1.1.1.3.cmml" xref="S3.SS1.SSS4.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.2.m1.1.1.3.1.cmml" xref="S3.SS1.SSS4.p2.2.m1.1.1.3">superscript</csymbol><cn id="S3.SS1.SSS4.p2.2.m1.1.1.3.2.cmml" type="integer" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.2">10</cn><apply id="S3.SS1.SSS4.p2.2.m1.1.1.3.3.cmml" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.3"><minus id="S3.SS1.SSS4.p2.2.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.3"></minus><cn id="S3.SS1.SSS4.p2.2.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.SSS4.p2.2.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.2.m1.1c">5\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.2.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> as the peak learning rate.
The warmup strategy adjusts the learning rate during training, with the warmup stage set to the first 6% of all iterations.
The maximum item “sentence” length is set to 30.
The bottleneck size of the adapter block is 64.
For contrastive learning (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS4" title="2.2.4. Distinguish Hard Samples ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2.4</span></a>), within a sequence, we select one item (<math alttext="n_{s}=1" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.3.m2.1"><semantics id="S3.SS1.SSS4.p2.3.m2.1a"><mrow id="S3.SS1.SSS4.p2.3.m2.1.1" xref="S3.SS1.SSS4.p2.3.m2.1.1.cmml"><msub id="S3.SS1.SSS4.p2.3.m2.1.1.2" xref="S3.SS1.SSS4.p2.3.m2.1.1.2.cmml"><mi id="S3.SS1.SSS4.p2.3.m2.1.1.2.2" xref="S3.SS1.SSS4.p2.3.m2.1.1.2.2.cmml">n</mi><mi id="S3.SS1.SSS4.p2.3.m2.1.1.2.3" xref="S3.SS1.SSS4.p2.3.m2.1.1.2.3.cmml">s</mi></msub><mo id="S3.SS1.SSS4.p2.3.m2.1.1.1" xref="S3.SS1.SSS4.p2.3.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.SSS4.p2.3.m2.1.1.3" xref="S3.SS1.SSS4.p2.3.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.3.m2.1b"><apply id="S3.SS1.SSS4.p2.3.m2.1.1.cmml" xref="S3.SS1.SSS4.p2.3.m2.1.1"><eq id="S3.SS1.SSS4.p2.3.m2.1.1.1.cmml" xref="S3.SS1.SSS4.p2.3.m2.1.1.1"></eq><apply id="S3.SS1.SSS4.p2.3.m2.1.1.2.cmml" xref="S3.SS1.SSS4.p2.3.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.3.m2.1.1.2.1.cmml" xref="S3.SS1.SSS4.p2.3.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS4.p2.3.m2.1.1.2.2.cmml" xref="S3.SS1.SSS4.p2.3.m2.1.1.2.2">𝑛</ci><ci id="S3.SS1.SSS4.p2.3.m2.1.1.2.3.cmml" xref="S3.SS1.SSS4.p2.3.m2.1.1.2.3">𝑠</ci></apply><cn id="S3.SS1.SSS4.p2.3.m2.1.1.3.cmml" type="integer" xref="S3.SS1.SSS4.p2.3.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.3.m2.1c">n_{s}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.3.m2.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = 1</annotation></semantics></math>) as the positive sample and choose five negative samples (<math alttext="n_{cl}=5" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.4.m3.1"><semantics id="S3.SS1.SSS4.p2.4.m3.1a"><mrow id="S3.SS1.SSS4.p2.4.m3.1.1" xref="S3.SS1.SSS4.p2.4.m3.1.1.cmml"><msub id="S3.SS1.SSS4.p2.4.m3.1.1.2" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.cmml"><mi id="S3.SS1.SSS4.p2.4.m3.1.1.2.2" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.2.cmml">n</mi><mrow id="S3.SS1.SSS4.p2.4.m3.1.1.2.3" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3.cmml"><mi id="S3.SS1.SSS4.p2.4.m3.1.1.2.3.2" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3.2.cmml">c</mi><mo id="S3.SS1.SSS4.p2.4.m3.1.1.2.3.1" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS4.p2.4.m3.1.1.2.3.3" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3.3.cmml">l</mi></mrow></msub><mo id="S3.SS1.SSS4.p2.4.m3.1.1.1" xref="S3.SS1.SSS4.p2.4.m3.1.1.1.cmml">=</mo><mn id="S3.SS1.SSS4.p2.4.m3.1.1.3" xref="S3.SS1.SSS4.p2.4.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.4.m3.1b"><apply id="S3.SS1.SSS4.p2.4.m3.1.1.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1"><eq id="S3.SS1.SSS4.p2.4.m3.1.1.1.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.1"></eq><apply id="S3.SS1.SSS4.p2.4.m3.1.1.2.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.4.m3.1.1.2.1.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS4.p2.4.m3.1.1.2.2.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.2">𝑛</ci><apply id="S3.SS1.SSS4.p2.4.m3.1.1.2.3.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3"><times id="S3.SS1.SSS4.p2.4.m3.1.1.2.3.1.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3.1"></times><ci id="S3.SS1.SSS4.p2.4.m3.1.1.2.3.2.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3.2">𝑐</ci><ci id="S3.SS1.SSS4.p2.4.m3.1.1.2.3.3.cmml" xref="S3.SS1.SSS4.p2.4.m3.1.1.2.3.3">𝑙</ci></apply></apply><cn id="S3.SS1.SSS4.p2.4.m3.1.1.3.cmml" type="integer" xref="S3.SS1.SSS4.p2.4.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.4.m3.1c">n_{cl}=5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.4.m3.1d">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT = 5</annotation></semantics></math>) for that item by default.
The temperature parameter <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.5.m4.1"><semantics id="S3.SS1.SSS4.p2.5.m4.1a"><mi id="S3.SS1.SSS4.p2.5.m4.1.1" xref="S3.SS1.SSS4.p2.5.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.5.m4.1b"><ci id="S3.SS1.SSS4.p2.5.m4.1.1.cmml" xref="S3.SS1.SSS4.p2.5.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.5.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.5.m4.1d">italic_τ</annotation></semantics></math> for contrastive learning is set to 1.0.
For Bayesian optimization (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3.SSS3" title="2.3.3. Dynamic Adaptive Mixture-of-Experts ‣ 2.3. Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.3.3</span></a>), we run 30 iterations to search for suitable structure of DAMoE.
By default, we replace every LLM layer with DAMoE layer (i.e., replacement frequency <math alttext="r=1" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.6.m5.1"><semantics id="S3.SS1.SSS4.p2.6.m5.1a"><mrow id="S3.SS1.SSS4.p2.6.m5.1.1" xref="S3.SS1.SSS4.p2.6.m5.1.1.cmml"><mi id="S3.SS1.SSS4.p2.6.m5.1.1.2" xref="S3.SS1.SSS4.p2.6.m5.1.1.2.cmml">r</mi><mo id="S3.SS1.SSS4.p2.6.m5.1.1.1" xref="S3.SS1.SSS4.p2.6.m5.1.1.1.cmml">=</mo><mn id="S3.SS1.SSS4.p2.6.m5.1.1.3" xref="S3.SS1.SSS4.p2.6.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.6.m5.1b"><apply id="S3.SS1.SSS4.p2.6.m5.1.1.cmml" xref="S3.SS1.SSS4.p2.6.m5.1.1"><eq id="S3.SS1.SSS4.p2.6.m5.1.1.1.cmml" xref="S3.SS1.SSS4.p2.6.m5.1.1.1"></eq><ci id="S3.SS1.SSS4.p2.6.m5.1.1.2.cmml" xref="S3.SS1.SSS4.p2.6.m5.1.1.2">𝑟</ci><cn id="S3.SS1.SSS4.p2.6.m5.1.1.3.cmml" type="integer" xref="S3.SS1.SSS4.p2.6.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.6.m5.1c">r=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.6.m5.1d">italic_r = 1</annotation></semantics></math>).
The impact of these parameters, including <math alttext="n_{s}" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.7.m6.1"><semantics id="S3.SS1.SSS4.p2.7.m6.1a"><msub id="S3.SS1.SSS4.p2.7.m6.1.1" xref="S3.SS1.SSS4.p2.7.m6.1.1.cmml"><mi id="S3.SS1.SSS4.p2.7.m6.1.1.2" xref="S3.SS1.SSS4.p2.7.m6.1.1.2.cmml">n</mi><mi id="S3.SS1.SSS4.p2.7.m6.1.1.3" xref="S3.SS1.SSS4.p2.7.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.7.m6.1b"><apply id="S3.SS1.SSS4.p2.7.m6.1.1.cmml" xref="S3.SS1.SSS4.p2.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.7.m6.1.1.1.cmml" xref="S3.SS1.SSS4.p2.7.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p2.7.m6.1.1.2.cmml" xref="S3.SS1.SSS4.p2.7.m6.1.1.2">𝑛</ci><ci id="S3.SS1.SSS4.p2.7.m6.1.1.3.cmml" xref="S3.SS1.SSS4.p2.7.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.7.m6.1c">n_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.7.m6.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="n_{cl}" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.8.m7.1"><semantics id="S3.SS1.SSS4.p2.8.m7.1a"><msub id="S3.SS1.SSS4.p2.8.m7.1.1" xref="S3.SS1.SSS4.p2.8.m7.1.1.cmml"><mi id="S3.SS1.SSS4.p2.8.m7.1.1.2" xref="S3.SS1.SSS4.p2.8.m7.1.1.2.cmml">n</mi><mrow id="S3.SS1.SSS4.p2.8.m7.1.1.3" xref="S3.SS1.SSS4.p2.8.m7.1.1.3.cmml"><mi id="S3.SS1.SSS4.p2.8.m7.1.1.3.2" xref="S3.SS1.SSS4.p2.8.m7.1.1.3.2.cmml">c</mi><mo id="S3.SS1.SSS4.p2.8.m7.1.1.3.1" xref="S3.SS1.SSS4.p2.8.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS4.p2.8.m7.1.1.3.3" xref="S3.SS1.SSS4.p2.8.m7.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.8.m7.1b"><apply id="S3.SS1.SSS4.p2.8.m7.1.1.cmml" xref="S3.SS1.SSS4.p2.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS4.p2.8.m7.1.1.1.cmml" xref="S3.SS1.SSS4.p2.8.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS4.p2.8.m7.1.1.2.cmml" xref="S3.SS1.SSS4.p2.8.m7.1.1.2">𝑛</ci><apply id="S3.SS1.SSS4.p2.8.m7.1.1.3.cmml" xref="S3.SS1.SSS4.p2.8.m7.1.1.3"><times id="S3.SS1.SSS4.p2.8.m7.1.1.3.1.cmml" xref="S3.SS1.SSS4.p2.8.m7.1.1.3.1"></times><ci id="S3.SS1.SSS4.p2.8.m7.1.1.3.2.cmml" xref="S3.SS1.SSS4.p2.8.m7.1.1.3.2">𝑐</ci><ci id="S3.SS1.SSS4.p2.8.m7.1.1.3.3.cmml" xref="S3.SS1.SSS4.p2.8.m7.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.8.m7.1c">n_{cl}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.8.m7.1d">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="r" class="ltx_Math" display="inline" id="S3.SS1.SSS4.p2.9.m8.1"><semantics id="S3.SS1.SSS4.p2.9.m8.1a"><mi id="S3.SS1.SSS4.p2.9.m8.1.1" xref="S3.SS1.SSS4.p2.9.m8.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS4.p2.9.m8.1b"><ci id="S3.SS1.SSS4.p2.9.m8.1.1.cmml" xref="S3.SS1.SSS4.p2.9.m8.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS4.p2.9.m8.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS4.p2.9.m8.1d">italic_r</annotation></semantics></math>, and the bottleneck size, is further analyzed in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.SS6" title="3.6. Effects of Different Hyper-Parameters ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3.6</span></a>.
We conduct a grid search to find the best hyper-parameters on different datasets and we report them in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A6.T3" title="Table 3 ‣ Appendix F Hyper-Parameters for Different Datasets ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> of Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A6" title="Appendix F Hyper-Parameters for Different Datasets ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F6.1" style="width:251.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="193" id="S3.F6.1.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Ablation study on three datasets.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F6.2" style="width:147.4pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="324" id="S3.F6.2.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Effects of different CF models.</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S3.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F8.1" style="width:130.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="503" id="S3.F8.1.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Effects of Using Frozen NCF or Jointly-Trained NCF on Arts.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F8.2" style="width:260.2pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="249" id="S3.F8.2.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span>Effects of Using Context Masking</figcaption>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Overall Performance</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Tab. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.T2" title="Table 2 ‣ 3.1.1. Datasets ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> reports the overall performance of all methods.
Based on the results, we have the following observations:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">Non-LLM-based methods SASRec and FDSA perform consistently well across different datasets. In some cases, their performance is close toe LLM-based methods P5 and RecFormer.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">BERT4Rec performs poorly on several datasets, which is consistent with the observation mentioned in <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib38" title="">2022</a>)</cite>. As mentioned by Petrov and Macdonald, it is easy for BERT4Rec to get underfitted <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib38" title="">2022</a>)</cite>, which may be the reason for its performance in our experiments.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1">LLM-based methods P5 and RecFormer perform similarly to some extent. They perform well on Arts and Scientific but do not exceed SASRec and FDSA on Instruments and Games. We speculate that the reason is that, in Instruments and Games datasets, user behaviors are more inclined toward instant interests and impulsive buying. P5 and RecFormer might not capture these short-term behavioral changes as effectively as traditional models.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1">UniSRec does not perform well in our experiments. The goal of UniSRec is to develop a universal sequential representation learning model across different RS. In our experiments, for a fair comparison, we train and test UniSRec on each dataset without pre-training over other datasets. Consequently, the performance of UniSRec is affected.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i5.p1">
<p class="ltx_p" id="S3.I1.i5.p1.3"><span class="ltx_text ltx_font_smallcaps" id="S3.I1.i5.p1.3.1">MixRec</span> achieves the best performance across all datasets on all three metrics. Compared to the best baselines, <span class="ltx_text ltx_font_smallcaps" id="S3.I1.i5.p1.3.2">MixRec</span> shows an average improvement of <math alttext="8.92\%" class="ltx_Math" display="inline" id="S3.I1.i5.p1.1.m1.1"><semantics id="S3.I1.i5.p1.1.m1.1a"><mrow id="S3.I1.i5.p1.1.m1.1.1" xref="S3.I1.i5.p1.1.m1.1.1.cmml"><mn id="S3.I1.i5.p1.1.m1.1.1.2" xref="S3.I1.i5.p1.1.m1.1.1.2.cmml">8.92</mn><mo id="S3.I1.i5.p1.1.m1.1.1.1" xref="S3.I1.i5.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i5.p1.1.m1.1b"><apply id="S3.I1.i5.p1.1.m1.1.1.cmml" xref="S3.I1.i5.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.I1.i5.p1.1.m1.1.1.1.cmml" xref="S3.I1.i5.p1.1.m1.1.1.1">percent</csymbol><cn id="S3.I1.i5.p1.1.m1.1.1.2.cmml" type="float" xref="S3.I1.i5.p1.1.m1.1.1.2">8.92</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i5.p1.1.m1.1c">8.92\%</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i5.p1.1.m1.1d">8.92 %</annotation></semantics></math> on NDCG@10, <math alttext="7.75\%" class="ltx_Math" display="inline" id="S3.I1.i5.p1.2.m2.1"><semantics id="S3.I1.i5.p1.2.m2.1a"><mrow id="S3.I1.i5.p1.2.m2.1.1" xref="S3.I1.i5.p1.2.m2.1.1.cmml"><mn id="S3.I1.i5.p1.2.m2.1.1.2" xref="S3.I1.i5.p1.2.m2.1.1.2.cmml">7.75</mn><mo id="S3.I1.i5.p1.2.m2.1.1.1" xref="S3.I1.i5.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i5.p1.2.m2.1b"><apply id="S3.I1.i5.p1.2.m2.1.1.cmml" xref="S3.I1.i5.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.I1.i5.p1.2.m2.1.1.1.cmml" xref="S3.I1.i5.p1.2.m2.1.1.1">percent</csymbol><cn id="S3.I1.i5.p1.2.m2.1.1.2.cmml" type="float" xref="S3.I1.i5.p1.2.m2.1.1.2">7.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i5.p1.2.m2.1c">7.75\%</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i5.p1.2.m2.1d">7.75 %</annotation></semantics></math> on Recall@10, and <math alttext="8.05\%" class="ltx_Math" display="inline" id="S3.I1.i5.p1.3.m3.1"><semantics id="S3.I1.i5.p1.3.m3.1a"><mrow id="S3.I1.i5.p1.3.m3.1.1" xref="S3.I1.i5.p1.3.m3.1.1.cmml"><mn id="S3.I1.i5.p1.3.m3.1.1.2" xref="S3.I1.i5.p1.3.m3.1.1.2.cmml">8.05</mn><mo id="S3.I1.i5.p1.3.m3.1.1.1" xref="S3.I1.i5.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i5.p1.3.m3.1b"><apply id="S3.I1.i5.p1.3.m3.1.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.I1.i5.p1.3.m3.1.1.1.cmml" xref="S3.I1.i5.p1.3.m3.1.1.1">percent</csymbol><cn id="S3.I1.i5.p1.3.m3.1.1.2.cmml" type="float" xref="S3.I1.i5.p1.3.m3.1.1.2">8.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i5.p1.3.m3.1c">8.05\%</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i5.p1.3.m3.1d">8.05 %</annotation></semantics></math> on MRR. The overall results demonstrate the effectiveness of <span class="ltx_text ltx_font_smallcaps" id="S3.I1.i5.p1.3.3">MixRec</span> for sequential recommendation.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Ablation Study</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F6" title="Figure 6 ‣ 3.1.4. Implementation ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, we compare <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.1.1">MixRec</span> and its two variations:</p>
<ol class="ltx_enumerate" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.2">Variation 1</span>: It is <span class="ltx_text ltx_font_smallcaps" id="S3.I2.i1.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.1.m1.1"><semantics id="S3.I2.i1.p1.1.1.m1.1a"><msub id="S3.I2.i1.p1.1.1.m1.1.1" xref="S3.I2.i1.p1.1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.1.m1.1.1a" xref="S3.I2.i1.p1.1.1.m1.1.1.cmml"></mi><mtext id="S3.I2.i1.p1.1.1.m1.1.1.1" xref="S3.I2.i1.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.1.m1.1b"><apply id="S3.I2.i1.p1.1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.1.m1.1.1"><ci id="S3.I2.i1.p1.1.1.m1.1.1.1a.cmml" xref="S3.I2.i1.p1.1.1.m1.1.1.1"><mtext id="S3.I2.i1.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="S3.I2.i1.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> tuned with coarse-grained adaption tasks illustrated in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2" title="2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.1">Variation 2</span>: It is <span class="ltx_text ltx_font_smallcaps" id="S3.I2.i2.p1.1.2">MixRec</span> tuned with coarse-grained adaption (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2" title="2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2</span></a>), context masking and collaborative filtering injection (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3" title="2.3. Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.3</span></a>) (i.e., remove Bayesian optimization from <span class="ltx_text ltx_font_smallcaps" id="S3.I2.i2.p1.1.3">MixRec</span>).</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Due to page limit, we only provide results of NDCG@10 and Recall@10 on Arts, Scientific and Pantry datasets.
From Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F6" title="Figure 6 ‣ 3.1.4. Implementation ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, we can observe that:</p>
<ul class="ltx_itemize" id="S3.I3">
<li class="ltx_item" id="S3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I3.i1.p1">
<p class="ltx_p" id="S3.I3.i1.p1.1">Variation 1 outperforms LLMRec in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.T2" title="Table 2 ‣ 3.1.1. Datasets ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, showing that injecting adapters into LLM and fine-tuning adapters with our proposed coarse-grained adaption tasks (semantic alignment and distinguishing hard samples) for sequential recommendation can improve the performance of LLM-based SRS.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I3.i2.p1">
<p class="ltx_p" id="S3.I3.i2.p1.1">Variation 2 exceeds variation 1 on Scientific and Pantry, but it lags behind variation 1 on Arts w.r.t. NDCG@10. The results show that including context masking and collaborative filtering injection can enhance the performance, but the improvement may be offset by the fixed MoE architecture.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I3.i3.p1">
<p class="ltx_p" id="S3.I3.i3.p1.1"><span class="ltx_text ltx_font_smallcaps" id="S3.I3.i3.p1.1.1">MixRec</span> surpasses all its variations for all cases. Particularly, on Arts where variation 2 falls behind variation 1, <span class="ltx_text ltx_font_smallcaps" id="S3.I3.i3.p1.1.2">MixRec</span> (i.e., enhance variation 2 with Bayesian optimization) exceeds variation 1, showing that using Bayesian optimization to dynamically search for the suitable DAMoE architecture indeed enhances the quality of sequential recommendation.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">Overall, we can conclude that each part in <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.1.1">MixRec</span> contributes to its performance on sequential recommendation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Effects of Using Different CF Models</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F6" title="Figure 6 ‣ 3.1.4. Implementation ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a> compares the performance of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.1.1">MixRec</span> using different CF models.
We apply two prevalent CF methods MF <cite class="ltx_cite ltx_citemacro_citep">(Koren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib28" title="">2009</a>)</cite> and NCF <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib18" title="">2017</a>)</cite>.
We can see that, using NCF generally brings better results than using MF, showing that introducing more sophisticated CF models can enhance <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.1.2">MixRec</span>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">By default, we jointly train CF model and <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.1.1">MixRec</span>.
We also investigate the performance of the case when the CF model is pre-trained and then frozen in collaborative information injection.
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F8" title="Figure 8 ‣ 3.1.4. Implementation ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a> reports the results on Arts when using frozen NCF and jointly-train NCF (i.e., default <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.1.2">MixRec</span>).
On Arts, NDCG@10 values for freezing CF model and default <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.1.3">MixRec</span> are 0.0967 and 0.1400, respectively.
The results show that jointly training CF model and <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.1.4">MixRec</span> can improve sequential recommendation.</p>
</div>
<figure class="ltx_figure" id="S3.SS4.2">
<div class="ltx_block" id="S3.SS4.2.3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S3.F9" style="width:312.2pt;"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="138" id="S3.SS4.1.1.g1" src="x9.png" width="830"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9. </span>Performance when varying <math alttext="{\lambda}_{1}" class="ltx_Math" display="inline" id="S3.F9.4.m1.1"><semantics id="S3.F9.4.m1.1b"><msub id="S3.F9.4.m1.1.1" xref="S3.F9.4.m1.1.1.cmml"><mi id="S3.F9.4.m1.1.1.2" xref="S3.F9.4.m1.1.1.2.cmml">λ</mi><mn id="S3.F9.4.m1.1.1.3" xref="S3.F9.4.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F9.4.m1.1c"><apply id="S3.F9.4.m1.1.1.cmml" xref="S3.F9.4.m1.1.1"><csymbol cd="ambiguous" id="S3.F9.4.m1.1.1.1.cmml" xref="S3.F9.4.m1.1.1">subscript</csymbol><ci id="S3.F9.4.m1.1.1.2.cmml" xref="S3.F9.4.m1.1.1.2">𝜆</ci><cn id="S3.F9.4.m1.1.1.3.cmml" type="integer" xref="S3.F9.4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F9.4.m1.1d">{\lambda}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F9.4.m1.1e">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\lambda}_{2}" class="ltx_Math" display="inline" id="S3.F9.5.m2.1"><semantics id="S3.F9.5.m2.1b"><msub id="S3.F9.5.m2.1.1" xref="S3.F9.5.m2.1.1.cmml"><mi id="S3.F9.5.m2.1.1.2" xref="S3.F9.5.m2.1.1.2.cmml">λ</mi><mn id="S3.F9.5.m2.1.1.3" xref="S3.F9.5.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F9.5.m2.1c"><apply id="S3.F9.5.m2.1.1.cmml" xref="S3.F9.5.m2.1.1"><csymbol cd="ambiguous" id="S3.F9.5.m2.1.1.1.cmml" xref="S3.F9.5.m2.1.1">subscript</csymbol><ci id="S3.F9.5.m2.1.1.2.cmml" xref="S3.F9.5.m2.1.1.2">𝜆</ci><cn id="S3.F9.5.m2.1.1.3.cmml" type="integer" xref="S3.F9.5.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F9.5.m2.1d">{\lambda}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.F9.5.m2.1e">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\lambda}_{3}" class="ltx_Math" display="inline" id="S3.F9.6.m3.1"><semantics id="S3.F9.6.m3.1b"><msub id="S3.F9.6.m3.1.1" xref="S3.F9.6.m3.1.1.cmml"><mi id="S3.F9.6.m3.1.1.2" xref="S3.F9.6.m3.1.1.2.cmml">λ</mi><mn id="S3.F9.6.m3.1.1.3" xref="S3.F9.6.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F9.6.m3.1c"><apply id="S3.F9.6.m3.1.1.cmml" xref="S3.F9.6.m3.1.1"><csymbol cd="ambiguous" id="S3.F9.6.m3.1.1.1.cmml" xref="S3.F9.6.m3.1.1">subscript</csymbol><ci id="S3.F9.6.m3.1.1.2.cmml" xref="S3.F9.6.m3.1.1.2">𝜆</ci><cn id="S3.F9.6.m3.1.1.3.cmml" type="integer" xref="S3.F9.6.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F9.6.m3.1d">{\lambda}_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.F9.6.m3.1e">italic_λ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>.
<br class="ltx_break"/></figcaption>
</figure>
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S3.F10" style="width:99.7pt;"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="430" id="S3.SS4.2.2.g1" src="x10.png" width="829"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10. </span>Performance when varying bottleneck size.</figcaption>
</figure>
</div>
</figure>
<figure class="ltx_figure" id="S3.SS4.4">
<div class="ltx_block" id="S3.SS4.4.3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S3.F11" style="width:290.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="197" id="S3.SS4.3.1.g1" src="x11.png" width="830"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 11. </span>Performance when varying <math alttext="n_{s}" class="ltx_Math" display="inline" id="S3.F11.3.m1.1"><semantics id="S3.F11.3.m1.1b"><msub id="S3.F11.3.m1.1.1" xref="S3.F11.3.m1.1.1.cmml"><mi id="S3.F11.3.m1.1.1.2" xref="S3.F11.3.m1.1.1.2.cmml">n</mi><mi id="S3.F11.3.m1.1.1.3" xref="S3.F11.3.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F11.3.m1.1c"><apply id="S3.F11.3.m1.1.1.cmml" xref="S3.F11.3.m1.1.1"><csymbol cd="ambiguous" id="S3.F11.3.m1.1.1.1.cmml" xref="S3.F11.3.m1.1.1">subscript</csymbol><ci id="S3.F11.3.m1.1.1.2.cmml" xref="S3.F11.3.m1.1.1.2">𝑛</ci><ci id="S3.F11.3.m1.1.1.3.cmml" xref="S3.F11.3.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F11.3.m1.1d">n_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.F11.3.m1.1e">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="n_{cl}" class="ltx_Math" display="inline" id="S3.F11.4.m2.1"><semantics id="S3.F11.4.m2.1b"><msub id="S3.F11.4.m2.1.1" xref="S3.F11.4.m2.1.1.cmml"><mi id="S3.F11.4.m2.1.1.2" xref="S3.F11.4.m2.1.1.2.cmml">n</mi><mrow id="S3.F11.4.m2.1.1.3" xref="S3.F11.4.m2.1.1.3.cmml"><mi id="S3.F11.4.m2.1.1.3.2" xref="S3.F11.4.m2.1.1.3.2.cmml">c</mi><mo id="S3.F11.4.m2.1.1.3.1" xref="S3.F11.4.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.F11.4.m2.1.1.3.3" xref="S3.F11.4.m2.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F11.4.m2.1c"><apply id="S3.F11.4.m2.1.1.cmml" xref="S3.F11.4.m2.1.1"><csymbol cd="ambiguous" id="S3.F11.4.m2.1.1.1.cmml" xref="S3.F11.4.m2.1.1">subscript</csymbol><ci id="S3.F11.4.m2.1.1.2.cmml" xref="S3.F11.4.m2.1.1.2">𝑛</ci><apply id="S3.F11.4.m2.1.1.3.cmml" xref="S3.F11.4.m2.1.1.3"><times id="S3.F11.4.m2.1.1.3.1.cmml" xref="S3.F11.4.m2.1.1.3.1"></times><ci id="S3.F11.4.m2.1.1.3.2.cmml" xref="S3.F11.4.m2.1.1.3.2">𝑐</ci><ci id="S3.F11.4.m2.1.1.3.3.cmml" xref="S3.F11.4.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F11.4.m2.1d">n_{cl}</annotation><annotation encoding="application/x-llamapun" id="S3.F11.4.m2.1e">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Darker color indicates higher values.</figcaption>
</figure>
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S3.F12" style="width:117.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="486" id="S3.SS4.4.2.g1" src="x12.png" width="830"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 12. </span>Performance when varying replacement frequency <math alttext="r" class="ltx_Math" display="inline" id="S3.F12.2.m1.1"><semantics id="S3.F12.2.m1.1b"><mi id="S3.F12.2.m1.1.1" xref="S3.F12.2.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.F12.2.m1.1c"><ci id="S3.F12.2.m1.1.1.cmml" xref="S3.F12.2.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F12.2.m1.1d">r</annotation><annotation encoding="application/x-llamapun" id="S3.F12.2.m1.1e">italic_r</annotation></semantics></math>.</figcaption>
</figure>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Effects of Context Masking</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">When introducing context masking, we use a method similar to MoE to integrate the hidden states from causal masking and context masking.
Since MoE introduces additional parameters, it is necessary to investigate whether the performance improvement solely comes from the increased parameters.
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F8" title="Figure 8 ‣ 3.1.4. Implementation ‣ 3.1. Experimental Settings ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a> compares the results of “MoE” where the hidden states from two adapter experts are computed using the same causal masking component and <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.p1.1.1">MixRec</span> on Arts and Pantry.
From the results, we can that the performance gain brought by <span class="ltx_text ltx_font_smallcaps" id="S3.SS5.p1.1.2">MixRec</span> is caused by causal masking instead of the increased model size.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6. </span>Effects of Different Hyper-Parameters</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">In this section, we investigate the effects of several hyper-parameters on <span class="ltx_text ltx_font_smallcaps" id="S3.SS6.p1.1.1">MixRec</span> and provide analysis based on Pantry:</p>
<ul class="ltx_itemize" id="S3.I4">
<li class="ltx_item" id="S3.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I4.i1.p1">
<p class="ltx_p" id="S3.I4.i1.p1.4"><span class="ltx_text ltx_font_bold" id="S3.I4.i1.p1.4.1">Task Weights</span>: Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F9" title="Figure 9 ‣ 3.4. Effects of Using Different CF Models ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a> shows the impact on <span class="ltx_text ltx_font_smallcaps" id="S3.I4.i1.p1.4.2">MixRec</span> when adjusting one <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.I4.i1.p1.1.m1.1"><semantics id="S3.I4.i1.p1.1.m1.1a"><mi id="S3.I4.i1.p1.1.m1.1.1" xref="S3.I4.i1.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.I4.i1.p1.1.m1.1b"><ci id="S3.I4.i1.p1.1.m1.1.1.cmml" xref="S3.I4.i1.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i1.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i1.p1.1.m1.1d">italic_λ</annotation></semantics></math> value while keeping the others fixed at 1. As depicted, the performance peaks around <math alttext="{\lambda}_{1}=1e-1" class="ltx_Math" display="inline" id="S3.I4.i1.p1.2.m2.1"><semantics id="S3.I4.i1.p1.2.m2.1a"><mrow id="S3.I4.i1.p1.2.m2.1.1" xref="S3.I4.i1.p1.2.m2.1.1.cmml"><msub id="S3.I4.i1.p1.2.m2.1.1.2" xref="S3.I4.i1.p1.2.m2.1.1.2.cmml"><mi id="S3.I4.i1.p1.2.m2.1.1.2.2" xref="S3.I4.i1.p1.2.m2.1.1.2.2.cmml">λ</mi><mn id="S3.I4.i1.p1.2.m2.1.1.2.3" xref="S3.I4.i1.p1.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S3.I4.i1.p1.2.m2.1.1.1" xref="S3.I4.i1.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S3.I4.i1.p1.2.m2.1.1.3" xref="S3.I4.i1.p1.2.m2.1.1.3.cmml"><mrow id="S3.I4.i1.p1.2.m2.1.1.3.2" xref="S3.I4.i1.p1.2.m2.1.1.3.2.cmml"><mn id="S3.I4.i1.p1.2.m2.1.1.3.2.2" xref="S3.I4.i1.p1.2.m2.1.1.3.2.2.cmml">1</mn><mo id="S3.I4.i1.p1.2.m2.1.1.3.2.1" xref="S3.I4.i1.p1.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S3.I4.i1.p1.2.m2.1.1.3.2.3" xref="S3.I4.i1.p1.2.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="S3.I4.i1.p1.2.m2.1.1.3.1" xref="S3.I4.i1.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.I4.i1.p1.2.m2.1.1.3.3" xref="S3.I4.i1.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I4.i1.p1.2.m2.1b"><apply id="S3.I4.i1.p1.2.m2.1.1.cmml" xref="S3.I4.i1.p1.2.m2.1.1"><eq id="S3.I4.i1.p1.2.m2.1.1.1.cmml" xref="S3.I4.i1.p1.2.m2.1.1.1"></eq><apply id="S3.I4.i1.p1.2.m2.1.1.2.cmml" xref="S3.I4.i1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.I4.i1.p1.2.m2.1.1.2.1.cmml" xref="S3.I4.i1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.I4.i1.p1.2.m2.1.1.2.2.cmml" xref="S3.I4.i1.p1.2.m2.1.1.2.2">𝜆</ci><cn id="S3.I4.i1.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S3.I4.i1.p1.2.m2.1.1.2.3">1</cn></apply><apply id="S3.I4.i1.p1.2.m2.1.1.3.cmml" xref="S3.I4.i1.p1.2.m2.1.1.3"><minus id="S3.I4.i1.p1.2.m2.1.1.3.1.cmml" xref="S3.I4.i1.p1.2.m2.1.1.3.1"></minus><apply id="S3.I4.i1.p1.2.m2.1.1.3.2.cmml" xref="S3.I4.i1.p1.2.m2.1.1.3.2"><times id="S3.I4.i1.p1.2.m2.1.1.3.2.1.cmml" xref="S3.I4.i1.p1.2.m2.1.1.3.2.1"></times><cn id="S3.I4.i1.p1.2.m2.1.1.3.2.2.cmml" type="integer" xref="S3.I4.i1.p1.2.m2.1.1.3.2.2">1</cn><ci id="S3.I4.i1.p1.2.m2.1.1.3.2.3.cmml" xref="S3.I4.i1.p1.2.m2.1.1.3.2.3">𝑒</ci></apply><cn id="S3.I4.i1.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S3.I4.i1.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i1.p1.2.m2.1c">{\lambda}_{1}=1e-1</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i1.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 1 italic_e - 1</annotation></semantics></math>, <math alttext="{\lambda}_{2}=1e-6" class="ltx_Math" display="inline" id="S3.I4.i1.p1.3.m3.1"><semantics id="S3.I4.i1.p1.3.m3.1a"><mrow id="S3.I4.i1.p1.3.m3.1.1" xref="S3.I4.i1.p1.3.m3.1.1.cmml"><msub id="S3.I4.i1.p1.3.m3.1.1.2" xref="S3.I4.i1.p1.3.m3.1.1.2.cmml"><mi id="S3.I4.i1.p1.3.m3.1.1.2.2" xref="S3.I4.i1.p1.3.m3.1.1.2.2.cmml">λ</mi><mn id="S3.I4.i1.p1.3.m3.1.1.2.3" xref="S3.I4.i1.p1.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S3.I4.i1.p1.3.m3.1.1.1" xref="S3.I4.i1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S3.I4.i1.p1.3.m3.1.1.3" xref="S3.I4.i1.p1.3.m3.1.1.3.cmml"><mrow id="S3.I4.i1.p1.3.m3.1.1.3.2" xref="S3.I4.i1.p1.3.m3.1.1.3.2.cmml"><mn id="S3.I4.i1.p1.3.m3.1.1.3.2.2" xref="S3.I4.i1.p1.3.m3.1.1.3.2.2.cmml">1</mn><mo id="S3.I4.i1.p1.3.m3.1.1.3.2.1" xref="S3.I4.i1.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.I4.i1.p1.3.m3.1.1.3.2.3" xref="S3.I4.i1.p1.3.m3.1.1.3.2.3.cmml">e</mi></mrow><mo id="S3.I4.i1.p1.3.m3.1.1.3.1" xref="S3.I4.i1.p1.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.I4.i1.p1.3.m3.1.1.3.3" xref="S3.I4.i1.p1.3.m3.1.1.3.3.cmml">6</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I4.i1.p1.3.m3.1b"><apply id="S3.I4.i1.p1.3.m3.1.1.cmml" xref="S3.I4.i1.p1.3.m3.1.1"><eq id="S3.I4.i1.p1.3.m3.1.1.1.cmml" xref="S3.I4.i1.p1.3.m3.1.1.1"></eq><apply id="S3.I4.i1.p1.3.m3.1.1.2.cmml" xref="S3.I4.i1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.I4.i1.p1.3.m3.1.1.2.1.cmml" xref="S3.I4.i1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.I4.i1.p1.3.m3.1.1.2.2.cmml" xref="S3.I4.i1.p1.3.m3.1.1.2.2">𝜆</ci><cn id="S3.I4.i1.p1.3.m3.1.1.2.3.cmml" type="integer" xref="S3.I4.i1.p1.3.m3.1.1.2.3">2</cn></apply><apply id="S3.I4.i1.p1.3.m3.1.1.3.cmml" xref="S3.I4.i1.p1.3.m3.1.1.3"><minus id="S3.I4.i1.p1.3.m3.1.1.3.1.cmml" xref="S3.I4.i1.p1.3.m3.1.1.3.1"></minus><apply id="S3.I4.i1.p1.3.m3.1.1.3.2.cmml" xref="S3.I4.i1.p1.3.m3.1.1.3.2"><times id="S3.I4.i1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.I4.i1.p1.3.m3.1.1.3.2.1"></times><cn id="S3.I4.i1.p1.3.m3.1.1.3.2.2.cmml" type="integer" xref="S3.I4.i1.p1.3.m3.1.1.3.2.2">1</cn><ci id="S3.I4.i1.p1.3.m3.1.1.3.2.3.cmml" xref="S3.I4.i1.p1.3.m3.1.1.3.2.3">𝑒</ci></apply><cn id="S3.I4.i1.p1.3.m3.1.1.3.3.cmml" type="integer" xref="S3.I4.i1.p1.3.m3.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i1.p1.3.m3.1c">{\lambda}_{2}=1e-6</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i1.p1.3.m3.1d">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 1 italic_e - 6</annotation></semantics></math> and <math alttext="{\lambda}_{3}=1e-2" class="ltx_Math" display="inline" id="S3.I4.i1.p1.4.m4.1"><semantics id="S3.I4.i1.p1.4.m4.1a"><mrow id="S3.I4.i1.p1.4.m4.1.1" xref="S3.I4.i1.p1.4.m4.1.1.cmml"><msub id="S3.I4.i1.p1.4.m4.1.1.2" xref="S3.I4.i1.p1.4.m4.1.1.2.cmml"><mi id="S3.I4.i1.p1.4.m4.1.1.2.2" xref="S3.I4.i1.p1.4.m4.1.1.2.2.cmml">λ</mi><mn id="S3.I4.i1.p1.4.m4.1.1.2.3" xref="S3.I4.i1.p1.4.m4.1.1.2.3.cmml">3</mn></msub><mo id="S3.I4.i1.p1.4.m4.1.1.1" xref="S3.I4.i1.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.I4.i1.p1.4.m4.1.1.3" xref="S3.I4.i1.p1.4.m4.1.1.3.cmml"><mrow id="S3.I4.i1.p1.4.m4.1.1.3.2" xref="S3.I4.i1.p1.4.m4.1.1.3.2.cmml"><mn id="S3.I4.i1.p1.4.m4.1.1.3.2.2" xref="S3.I4.i1.p1.4.m4.1.1.3.2.2.cmml">1</mn><mo id="S3.I4.i1.p1.4.m4.1.1.3.2.1" xref="S3.I4.i1.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S3.I4.i1.p1.4.m4.1.1.3.2.3" xref="S3.I4.i1.p1.4.m4.1.1.3.2.3.cmml">e</mi></mrow><mo id="S3.I4.i1.p1.4.m4.1.1.3.1" xref="S3.I4.i1.p1.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.I4.i1.p1.4.m4.1.1.3.3" xref="S3.I4.i1.p1.4.m4.1.1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I4.i1.p1.4.m4.1b"><apply id="S3.I4.i1.p1.4.m4.1.1.cmml" xref="S3.I4.i1.p1.4.m4.1.1"><eq id="S3.I4.i1.p1.4.m4.1.1.1.cmml" xref="S3.I4.i1.p1.4.m4.1.1.1"></eq><apply id="S3.I4.i1.p1.4.m4.1.1.2.cmml" xref="S3.I4.i1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.I4.i1.p1.4.m4.1.1.2.1.cmml" xref="S3.I4.i1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.I4.i1.p1.4.m4.1.1.2.2.cmml" xref="S3.I4.i1.p1.4.m4.1.1.2.2">𝜆</ci><cn id="S3.I4.i1.p1.4.m4.1.1.2.3.cmml" type="integer" xref="S3.I4.i1.p1.4.m4.1.1.2.3">3</cn></apply><apply id="S3.I4.i1.p1.4.m4.1.1.3.cmml" xref="S3.I4.i1.p1.4.m4.1.1.3"><minus id="S3.I4.i1.p1.4.m4.1.1.3.1.cmml" xref="S3.I4.i1.p1.4.m4.1.1.3.1"></minus><apply id="S3.I4.i1.p1.4.m4.1.1.3.2.cmml" xref="S3.I4.i1.p1.4.m4.1.1.3.2"><times id="S3.I4.i1.p1.4.m4.1.1.3.2.1.cmml" xref="S3.I4.i1.p1.4.m4.1.1.3.2.1"></times><cn id="S3.I4.i1.p1.4.m4.1.1.3.2.2.cmml" type="integer" xref="S3.I4.i1.p1.4.m4.1.1.3.2.2">1</cn><ci id="S3.I4.i1.p1.4.m4.1.1.3.2.3.cmml" xref="S3.I4.i1.p1.4.m4.1.1.3.2.3">𝑒</ci></apply><cn id="S3.I4.i1.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S3.I4.i1.p1.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i1.p1.4.m4.1c">{\lambda}_{3}=1e-2</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i1.p1.4.m4.1d">italic_λ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT = 1 italic_e - 2</annotation></semantics></math>. We can also clearly see the performance peak and the performance lines do not vibrate. In other words, it is not difficult to tune task weights for <span class="ltx_text ltx_font_smallcaps" id="S3.I4.i1.p1.4.3">MixRec</span>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I4.i2.p1">
<p class="ltx_p" id="S3.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I4.i2.p1.1.1">Bottleneck Size:</span>: As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F10" title="Figure 10 ‣ 3.4. Effects of Using Different CF Models ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a>, <span class="ltx_text ltx_font_smallcaps" id="S3.I4.i2.p1.1.2">MixRec</span> achieves the best performance when the bottleneck size is 64. Besides, the performance trend when varying bottleneck size is clear, showing that tuning bottleneck size is not difficult in practice.</p>
</div>
</li>
<li class="ltx_item" id="S3.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I4.i3.p1">
<p class="ltx_p" id="S3.I4.i3.p1.6"><span class="ltx_text ltx_font_bold" id="S3.I4.i3.p1.6.1">Sample Number:</span> Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F11" title="Figure 11 ‣ 3.4. Effects of Using Different CF Models ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">11</span></a> depicts the performance when using different values for <math alttext="n_{s}" class="ltx_Math" display="inline" id="S3.I4.i3.p1.1.m1.1"><semantics id="S3.I4.i3.p1.1.m1.1a"><msub id="S3.I4.i3.p1.1.m1.1.1" xref="S3.I4.i3.p1.1.m1.1.1.cmml"><mi id="S3.I4.i3.p1.1.m1.1.1.2" xref="S3.I4.i3.p1.1.m1.1.1.2.cmml">n</mi><mi id="S3.I4.i3.p1.1.m1.1.1.3" xref="S3.I4.i3.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I4.i3.p1.1.m1.1b"><apply id="S3.I4.i3.p1.1.m1.1.1.cmml" xref="S3.I4.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I4.i3.p1.1.m1.1.1.1.cmml" xref="S3.I4.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I4.i3.p1.1.m1.1.1.2.cmml" xref="S3.I4.i3.p1.1.m1.1.1.2">𝑛</ci><ci id="S3.I4.i3.p1.1.m1.1.1.3.cmml" xref="S3.I4.i3.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i3.p1.1.m1.1c">n_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i3.p1.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="n_{cl}" class="ltx_Math" display="inline" id="S3.I4.i3.p1.2.m2.1"><semantics id="S3.I4.i3.p1.2.m2.1a"><msub id="S3.I4.i3.p1.2.m2.1.1" xref="S3.I4.i3.p1.2.m2.1.1.cmml"><mi id="S3.I4.i3.p1.2.m2.1.1.2" xref="S3.I4.i3.p1.2.m2.1.1.2.cmml">n</mi><mrow id="S3.I4.i3.p1.2.m2.1.1.3" xref="S3.I4.i3.p1.2.m2.1.1.3.cmml"><mi id="S3.I4.i3.p1.2.m2.1.1.3.2" xref="S3.I4.i3.p1.2.m2.1.1.3.2.cmml">c</mi><mo id="S3.I4.i3.p1.2.m2.1.1.3.1" xref="S3.I4.i3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.I4.i3.p1.2.m2.1.1.3.3" xref="S3.I4.i3.p1.2.m2.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I4.i3.p1.2.m2.1b"><apply id="S3.I4.i3.p1.2.m2.1.1.cmml" xref="S3.I4.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I4.i3.p1.2.m2.1.1.1.cmml" xref="S3.I4.i3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I4.i3.p1.2.m2.1.1.2.cmml" xref="S3.I4.i3.p1.2.m2.1.1.2">𝑛</ci><apply id="S3.I4.i3.p1.2.m2.1.1.3.cmml" xref="S3.I4.i3.p1.2.m2.1.1.3"><times id="S3.I4.i3.p1.2.m2.1.1.3.1.cmml" xref="S3.I4.i3.p1.2.m2.1.1.3.1"></times><ci id="S3.I4.i3.p1.2.m2.1.1.3.2.cmml" xref="S3.I4.i3.p1.2.m2.1.1.3.2">𝑐</ci><ci id="S3.I4.i3.p1.2.m2.1.1.3.3.cmml" xref="S3.I4.i3.p1.2.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i3.p1.2.m2.1c">n_{cl}</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i3.p1.2.m2.1d">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. It can be observed that, as <math alttext="n_{s}" class="ltx_Math" display="inline" id="S3.I4.i3.p1.3.m3.1"><semantics id="S3.I4.i3.p1.3.m3.1a"><msub id="S3.I4.i3.p1.3.m3.1.1" xref="S3.I4.i3.p1.3.m3.1.1.cmml"><mi id="S3.I4.i3.p1.3.m3.1.1.2" xref="S3.I4.i3.p1.3.m3.1.1.2.cmml">n</mi><mi id="S3.I4.i3.p1.3.m3.1.1.3" xref="S3.I4.i3.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I4.i3.p1.3.m3.1b"><apply id="S3.I4.i3.p1.3.m3.1.1.cmml" xref="S3.I4.i3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.I4.i3.p1.3.m3.1.1.1.cmml" xref="S3.I4.i3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.I4.i3.p1.3.m3.1.1.2.cmml" xref="S3.I4.i3.p1.3.m3.1.1.2">𝑛</ci><ci id="S3.I4.i3.p1.3.m3.1.1.3.cmml" xref="S3.I4.i3.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i3.p1.3.m3.1c">n_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i3.p1.3.m3.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="n_{cl}" class="ltx_Math" display="inline" id="S3.I4.i3.p1.4.m4.1"><semantics id="S3.I4.i3.p1.4.m4.1a"><msub id="S3.I4.i3.p1.4.m4.1.1" xref="S3.I4.i3.p1.4.m4.1.1.cmml"><mi id="S3.I4.i3.p1.4.m4.1.1.2" xref="S3.I4.i3.p1.4.m4.1.1.2.cmml">n</mi><mrow id="S3.I4.i3.p1.4.m4.1.1.3" xref="S3.I4.i3.p1.4.m4.1.1.3.cmml"><mi id="S3.I4.i3.p1.4.m4.1.1.3.2" xref="S3.I4.i3.p1.4.m4.1.1.3.2.cmml">c</mi><mo id="S3.I4.i3.p1.4.m4.1.1.3.1" xref="S3.I4.i3.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.I4.i3.p1.4.m4.1.1.3.3" xref="S3.I4.i3.p1.4.m4.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I4.i3.p1.4.m4.1b"><apply id="S3.I4.i3.p1.4.m4.1.1.cmml" xref="S3.I4.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I4.i3.p1.4.m4.1.1.1.cmml" xref="S3.I4.i3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.I4.i3.p1.4.m4.1.1.2.cmml" xref="S3.I4.i3.p1.4.m4.1.1.2">𝑛</ci><apply id="S3.I4.i3.p1.4.m4.1.1.3.cmml" xref="S3.I4.i3.p1.4.m4.1.1.3"><times id="S3.I4.i3.p1.4.m4.1.1.3.1.cmml" xref="S3.I4.i3.p1.4.m4.1.1.3.1"></times><ci id="S3.I4.i3.p1.4.m4.1.1.3.2.cmml" xref="S3.I4.i3.p1.4.m4.1.1.3.2">𝑐</ci><ci id="S3.I4.i3.p1.4.m4.1.1.3.3.cmml" xref="S3.I4.i3.p1.4.m4.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i3.p1.4.m4.1c">n_{cl}</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i3.p1.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT</annotation></semantics></math> increase, the performance generally gets improves. To balance the performance and the computation cost, we set <math alttext="n_{s}=1" class="ltx_Math" display="inline" id="S3.I4.i3.p1.5.m5.1"><semantics id="S3.I4.i3.p1.5.m5.1a"><mrow id="S3.I4.i3.p1.5.m5.1.1" xref="S3.I4.i3.p1.5.m5.1.1.cmml"><msub id="S3.I4.i3.p1.5.m5.1.1.2" xref="S3.I4.i3.p1.5.m5.1.1.2.cmml"><mi id="S3.I4.i3.p1.5.m5.1.1.2.2" xref="S3.I4.i3.p1.5.m5.1.1.2.2.cmml">n</mi><mi id="S3.I4.i3.p1.5.m5.1.1.2.3" xref="S3.I4.i3.p1.5.m5.1.1.2.3.cmml">s</mi></msub><mo id="S3.I4.i3.p1.5.m5.1.1.1" xref="S3.I4.i3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.I4.i3.p1.5.m5.1.1.3" xref="S3.I4.i3.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I4.i3.p1.5.m5.1b"><apply id="S3.I4.i3.p1.5.m5.1.1.cmml" xref="S3.I4.i3.p1.5.m5.1.1"><eq id="S3.I4.i3.p1.5.m5.1.1.1.cmml" xref="S3.I4.i3.p1.5.m5.1.1.1"></eq><apply id="S3.I4.i3.p1.5.m5.1.1.2.cmml" xref="S3.I4.i3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.I4.i3.p1.5.m5.1.1.2.1.cmml" xref="S3.I4.i3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.I4.i3.p1.5.m5.1.1.2.2.cmml" xref="S3.I4.i3.p1.5.m5.1.1.2.2">𝑛</ci><ci id="S3.I4.i3.p1.5.m5.1.1.2.3.cmml" xref="S3.I4.i3.p1.5.m5.1.1.2.3">𝑠</ci></apply><cn id="S3.I4.i3.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.I4.i3.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i3.p1.5.m5.1c">n_{s}=1</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i3.p1.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = 1</annotation></semantics></math> and <math alttext="n_{cl}=5" class="ltx_Math" display="inline" id="S3.I4.i3.p1.6.m6.1"><semantics id="S3.I4.i3.p1.6.m6.1a"><mrow id="S3.I4.i3.p1.6.m6.1.1" xref="S3.I4.i3.p1.6.m6.1.1.cmml"><msub id="S3.I4.i3.p1.6.m6.1.1.2" xref="S3.I4.i3.p1.6.m6.1.1.2.cmml"><mi id="S3.I4.i3.p1.6.m6.1.1.2.2" xref="S3.I4.i3.p1.6.m6.1.1.2.2.cmml">n</mi><mrow id="S3.I4.i3.p1.6.m6.1.1.2.3" xref="S3.I4.i3.p1.6.m6.1.1.2.3.cmml"><mi id="S3.I4.i3.p1.6.m6.1.1.2.3.2" xref="S3.I4.i3.p1.6.m6.1.1.2.3.2.cmml">c</mi><mo id="S3.I4.i3.p1.6.m6.1.1.2.3.1" xref="S3.I4.i3.p1.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S3.I4.i3.p1.6.m6.1.1.2.3.3" xref="S3.I4.i3.p1.6.m6.1.1.2.3.3.cmml">l</mi></mrow></msub><mo id="S3.I4.i3.p1.6.m6.1.1.1" xref="S3.I4.i3.p1.6.m6.1.1.1.cmml">=</mo><mn id="S3.I4.i3.p1.6.m6.1.1.3" xref="S3.I4.i3.p1.6.m6.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I4.i3.p1.6.m6.1b"><apply id="S3.I4.i3.p1.6.m6.1.1.cmml" xref="S3.I4.i3.p1.6.m6.1.1"><eq id="S3.I4.i3.p1.6.m6.1.1.1.cmml" xref="S3.I4.i3.p1.6.m6.1.1.1"></eq><apply id="S3.I4.i3.p1.6.m6.1.1.2.cmml" xref="S3.I4.i3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.I4.i3.p1.6.m6.1.1.2.1.cmml" xref="S3.I4.i3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.I4.i3.p1.6.m6.1.1.2.2.cmml" xref="S3.I4.i3.p1.6.m6.1.1.2.2">𝑛</ci><apply id="S3.I4.i3.p1.6.m6.1.1.2.3.cmml" xref="S3.I4.i3.p1.6.m6.1.1.2.3"><times id="S3.I4.i3.p1.6.m6.1.1.2.3.1.cmml" xref="S3.I4.i3.p1.6.m6.1.1.2.3.1"></times><ci id="S3.I4.i3.p1.6.m6.1.1.2.3.2.cmml" xref="S3.I4.i3.p1.6.m6.1.1.2.3.2">𝑐</ci><ci id="S3.I4.i3.p1.6.m6.1.1.2.3.3.cmml" xref="S3.I4.i3.p1.6.m6.1.1.2.3.3">𝑙</ci></apply></apply><cn id="S3.I4.i3.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.I4.i3.p1.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i3.p1.6.m6.1c">n_{cl}=5</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i3.p1.6.m6.1d">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT = 5</annotation></semantics></math> by default.</p>
</div>
</li>
<li class="ltx_item" id="S3.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I4.i4.p1">
<p class="ltx_p" id="S3.I4.i4.p1.3"><span class="ltx_text ltx_font_bold" id="S3.I4.i4.p1.3.1">Frequency of Replacement:</span> By defualt, the replacement frequency <math alttext="r" class="ltx_Math" display="inline" id="S3.I4.i4.p1.1.m1.1"><semantics id="S3.I4.i4.p1.1.m1.1a"><mi id="S3.I4.i4.p1.1.m1.1.1" xref="S3.I4.i4.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.I4.i4.p1.1.m1.1b"><ci id="S3.I4.i4.p1.1.m1.1.1.cmml" xref="S3.I4.i4.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i4.p1.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i4.p1.1.m1.1d">italic_r</annotation></semantics></math> is set to 1. We also provide the performance when changing the replacement frequency in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F12" title="Figure 12 ‣ 3.4. Effects of Using Different CF Models ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">12</span></a>. In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S3.F12" title="Figure 12 ‣ 3.4. Effects of Using Different CF Models ‣ 3. Experiment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">12</span></a>, we report the performance of <span class="ltx_text ltx_font_smallcaps" id="S3.I4.i4.p1.3.2">MixRec</span> when <math alttext="r" class="ltx_Math" display="inline" id="S3.I4.i4.p1.2.m2.1"><semantics id="S3.I4.i4.p1.2.m2.1a"><mi id="S3.I4.i4.p1.2.m2.1.1" xref="S3.I4.i4.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.I4.i4.p1.2.m2.1b"><ci id="S3.I4.i4.p1.2.m2.1.1.cmml" xref="S3.I4.i4.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i4.p1.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i4.p1.2.m2.1d">italic_r</annotation></semantics></math> is set to 1, 2, 3, 4 and 6, respectively. For instance, <math alttext="r=2" class="ltx_Math" display="inline" id="S3.I4.i4.p1.3.m3.1"><semantics id="S3.I4.i4.p1.3.m3.1a"><mrow id="S3.I4.i4.p1.3.m3.1.1" xref="S3.I4.i4.p1.3.m3.1.1.cmml"><mi id="S3.I4.i4.p1.3.m3.1.1.2" xref="S3.I4.i4.p1.3.m3.1.1.2.cmml">r</mi><mo id="S3.I4.i4.p1.3.m3.1.1.1" xref="S3.I4.i4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.I4.i4.p1.3.m3.1.1.3" xref="S3.I4.i4.p1.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I4.i4.p1.3.m3.1b"><apply id="S3.I4.i4.p1.3.m3.1.1.cmml" xref="S3.I4.i4.p1.3.m3.1.1"><eq id="S3.I4.i4.p1.3.m3.1.1.1.cmml" xref="S3.I4.i4.p1.3.m3.1.1.1"></eq><ci id="S3.I4.i4.p1.3.m3.1.1.2.cmml" xref="S3.I4.i4.p1.3.m3.1.1.2">𝑟</ci><cn id="S3.I4.i4.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.I4.i4.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i4.p1.3.m3.1c">r=2</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i4.p1.3.m3.1d">italic_r = 2</annotation></semantics></math> indicates that we replace LLM layer with DAMoE layer every two layers. For unchanged layers, we use the original LLM layers and keep their parameters frozen. From the results, we can see that, as more LLM layers are replaced with DAMoE layers, the performance of <span class="ltx_text ltx_font_smallcaps" id="S3.I4.i4.p1.3.3">MixRec</span> increases, showing that our proposed DAMoE can effectively improve LLM-based sequential recommendation.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Related Work</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Non-LLM-Based SRS</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Traditional SRS typically applies sequential pattern mining <cite class="ltx_cite ltx_citemacro_citep">(Yap et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib56" title="">2012</a>)</cite>, Markov chains based methods <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib16" title="">2016</a>; He and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib17" title="">2016</a>)</cite>, and factorization based methods <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib43" title="">2010</a>; Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib4" title="">2013</a>)</cite>.
More recent works adopt deep learning techniques to boost the performance of sequential recommendation.
Researchers have explored RNNs <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib19" title="">2016</a>; Quadrana et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib41" title="">2017</a>)</cite>, CNNs <cite class="ltx_cite ltx_citemacro_citep">(Tuan and Phuong, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib47" title="">2017</a>; Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib46" title="">2018</a>)</cite>, GNNs <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib53" title="">2019</a>; Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib39" title="">2020</a>)</cite>, Transformer <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib26" title="">2018</a>; Ren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib42" title="">2020</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib44" title="">2019</a>)</cite> and many other prevalent deep learning techniques in sequential recommendation and find they can reduce the cost of manual feature engineering and better capture the comprehensive sequential relations <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib49" title="">2019</a>)</cite>.
Readers can refer to <cite class="ltx_cite ltx_citemacro_citep">(Fang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib9" title="">2020</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib49" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib50" title="">2022</a>; Quadrana et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib40" title="">2018</a>)</cite> for detailed survey of non-LLM-based SRS.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>LLM-Based SRS</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Emerging LLM-based SRS can be grouped into two paradigms: LLM-augmented SRS and LLM-centric SRS <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib23" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">LLM-augmented SRS adopts LLM as the feature extractor to obtain item features that are further fed to SRS.
Harte et al. <cite class="ltx_cite ltx_citemacro_citep">(Harte et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib14" title="">2023</a>)</cite> show that initializing BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib44" title="">2019</a>)</cite> with embeddings obtained from LLM can significantly improve sequential recommendation.
LRD <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib55" title="">2024</a>)</cite> is a LLM-based latent relation discovery framework.
It uses language knowledge to discover latent relations that can further enhance SRS.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">LLM-centric SRS leverages LLM as the SRS.
RecFormer <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib29" title="">2023b</a>)</cite> describes items using item “sentences”.
It is trained to understand the “sentence” sequence and retrieve the next “sentence” for making sequential recommendations.
E4SRec <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib30" title="">2023a</a>)</cite> takes ID sequences as inputs to LLM and ensures that the generated output falls within the candidate lists.
SAID <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib23" title="">2024</a>)</cite> uses LLM to learn semantically aligned item ID embeddings that can be integrated with downstream SRS.
LLM4ISR <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib45" title="">2024</a>)</cite>, armed with prompt initialization, optimization, and selection modules, enables LLM to make intent-driven session recommendations.
Re2LLM <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib52" title="">2024</a>)</cite> guides LLM with self-reflection and a lightweight retrieval agent, enabling LLM to focus on specialized knowledge essential for more accurate sequential recommendations effectively and efficiently.
Chu et al. <cite class="ltx_cite ltx_citemacro_citep">(Chu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib5" title="">2024</a>)</cite> propose three prompting strategies to exploit temporal information within historical interactions for LLM-based SRS.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>PEFT for LLM</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Existing PEFT can be categorized into four groups:
(1) Additive PEFT maintains the pre-trained LLM unchanged and introduces only a small number of trainable parameters that are strategically positioned within the model architecture.
Representative works include serial adapter <cite class="ltx_cite ltx_citemacro_citep">(Houlsby et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib21" title="">2019</a>)</cite>, parallel adapter <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib15" title="">2022</a>)</cite> and prefix-tuning <cite class="ltx_cite ltx_citemacro_citep">(Li and Liang, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib31" title="">2021</a>)</cite>.
(2) Selective PEFT fine-tunes a subset of LLM parameters to enhance performance over downstream tasks.
Diff pruning <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib12" title="">2021</a>)</cite> is a representative selective PEFT method.
(3) Reparameterized PEFT introduces additional low-rank trainable parameters during training, which are then integrated with the original LLM for inference.
LoRA (Low Rank Adaptation) <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib22" title="">2022</a>)</cite> is the most widely recognized reparameterized PEFT technique.
(4) Hybrid PEFT combines the advantages of diverse PEFT approaches <cite class="ltx_cite ltx_citemacro_citep">(Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib37" title="">2022</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we propose <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.1">MixRec</span> for enhancing LLM-based sequential recommendation.
Built on top of coarse-grained adaption, <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">MixRec</span> is further enhanced with context masking, collaborative knowledge injection and DAMoE so that it can effectively handle sequential recommendation.
In the future, we plan to try other PEFT methods in <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.3">MixRec</span> (e.g., selective PEFT) and improve their flexibility in <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.4">MixRec</span>.
Moreover, to understand the robustness of <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.5">MixRec</span>, we will investigate the impact of using LLMs with different sizes as the backbone in <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.6">MixRec</span>.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Han Cai, Ligeng Zhu, and Song Han. 2019.

</span>
<span class="ltx_bibblock">ProxylessNAS: Direct Neural Architecture Search on Target Task and Hardware. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">ICLR (Poster)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Weilin Cai, Juyong Jiang, Fan Wang, Jing Tang, Sunghun Kim, and Jiayi Huang. 2024.

</span>
<span class="ltx_bibblock">A Survey on Mixture of Experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">arXiv Preprint</em> (2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2407.06204" title="">https://arxiv.org/abs/2407.06204</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Chen Cheng, Haiqin Yang, Michael R. Lyu, and Irwin King. 2013.

</span>
<span class="ltx_bibblock">Where You Like to Go Next: Successive Point-of-Interest Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">IJCAI</em>. 2605–2611.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chu et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhendong Chu, Zichao Wang, Ruiyi Zhang, Yangfeng Ji, Hongning Wang, and Tong Sun. 2024.

</span>
<span class="ltx_bibblock">Improve Temporal Awareness of LLMs for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">arXiv Preprint</em> (2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2405.02778" title="">https://arxiv.org/abs/2405.02778</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Daulton et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Samuel Daulton, Xingchen Wan, David Eriksson, Maximilian Balandat, Michael A. Osborne, and Eytan Bakshy. 2022.

</span>
<span class="ltx_bibblock">Bayesian Optimization over Discrete and Mixed Spaces via Probabilistic Reparameterization. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">NAACL-HLT (1)</em>. 4171–4186.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Wenqi Fan, Zihuai Zhao, Jiatong Li, Yunqing Liu, Xiaowei Mei, Yiqi Wang, Jiliang Tang, and Qing Li. 2024.

</span>
<span class="ltx_bibblock">Recommender Systems in the Era of Large Language Models (LLMs).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">IEEE Trans. Knowl. Data Eng.</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Hui Fang, Danning Zhang, Yiheng Shu, and Guibing Guo. 2020.

</span>
<span class="ltx_bibblock">Deep Learning for Sequential Recommendation: Algorithms, Influential Factors, and Evaluations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">ACM Trans. Inf. Syst.</em> 39, 1 (2020), 10:1–10:42.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Junchen Fu, Fajie Yuan, Yu Song, Zheng Yuan, Mingyue Cheng, Shenghui Cheng, Jiaqi Zhang, Jie Wang, and Yunzhu Pan. 2024.

</span>
<span class="ltx_bibblock">Exploring Adapter-based Transfer Learning for Recommender Systems: Empirical Studies and Practical Insights. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">WSDM</em>. 208–217.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Recommendation as Language Processing (RLP): A Unified Pretrain, Personalized Prompt &amp; Predict Paradigm (P5). In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">RecSys</em>. 299–315.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Demi Guo, Alexander M. Rush, and Yoon Kim. 2021.

</span>
<span class="ltx_bibblock">Parameter-Efficient Transfer Learning with Diff Pruning. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">ACL/IJCNLP (1)</em>. 4884–4896.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zeyu Han, Chao Gao, Jinyang Liu, Jeff Zhang, and Sai Qian Zhang. 2024.

</span>
<span class="ltx_bibblock">Parameter-Efficient Fine-Tuning for Large Models: A Comprehensive Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv Preprint</em> (2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2403.14608" title="">https://arxiv.org/abs/2403.14608</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harte et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jesse Harte, Wouter Zorgdrager, Panos Louridas, Asterios Katsifodimos, Dietmar Jannach, and Marios Fragkoulis. 2023.

</span>
<span class="ltx_bibblock">Leveraging Large Language Models for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">RecSys</em>. 1096–1102.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Junxian He, Chunting Zhou, Xuezhe Ma, Taylor Berg-Kirkpatrick, and Graham Neubig. 2022.

</span>
<span class="ltx_bibblock">Towards a Unified View of Parameter-Efficient Transfer Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">ICLR</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/pdf?id=0RDcd5Axok" title="">https://openreview.net/pdf?id=0RDcd5Axok</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Ruining He, Chen Fang, Zhaowen Wang, and Julian J. McAuley. 2016.

</span>
<span class="ltx_bibblock">Vista: A Visually, Socially, and Temporally-aware Model for Artistic Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">RecSys</em>. 309–316.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
Ruining He and Julian J. McAuley. 2016.

</span>
<span class="ltx_bibblock">Fusing Similarity Models with Markov Chains for Sparse Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">ICDM</em>. 191–200.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Neural Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">WWW</em>. 173–182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2016.

</span>
<span class="ltx_bibblock">Session-based Recommendations with Recurrent Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">ICLR (Poster)</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/pdf?id=yoffK5KZSgQ" title="">https://openreview.net/pdf?id=yoffK5KZSgQ</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yupeng Hou, Shanlei Mu, Wayne Xin Zhao, Yaliang Li, Bolin Ding, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Towards Universal Sequence Representation Learning for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">KDD</em>. 585–593.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin de Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly. 2019.

</span>
<span class="ltx_bibblock">Parameter-Efficient Transfer Learning for NLP. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">ICML</em>, Vol. 97. 2790–2799.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2022.

</span>
<span class="ltx_bibblock">LoRA: Low-Rank Adaptation of Large Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">ICLR</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/pdf?id=nZeVKeeFYf9" title="">https://openreview.net/pdf?id=nZeVKeeFYf9</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jun Hu, Wenwen Xia, Xiaolu Zhang, Chilin Fu, Weichang Wu, Zhaoxin Huan, Ang Li, Zuoli Tang, and Jun Zhou. 2024.

</span>
<span class="ltx_bibblock">Enhancing Sequential Recommendation via LLM-based Semantic Embedding Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">WWW (Companion Volume)</em>. 103–111.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Chengkai Huang, Tong Yu, Kaige Xie, Shuai Zhang, Lina Yao, and Julian J. McAuley. 2024.

</span>
<span class="ltx_bibblock">Foundation Models for Recommender Systems: A Survey and New Perspectives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">arXiv Preprint</em> (2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.11143" title="">https://arxiv.org/abs/2402.11143</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Hongye Jin, Xiaotian Han, Jingfeng Yang, Zhimeng Jiang, Zirui Liu, Chia-Yuan Chang, Huiyuan Chen, and Xia Hu. 2024.

</span>
<span class="ltx_bibblock">LLM Maybe LongLM: Self-Extend LLM Context Window Without Tuning. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">ICML</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian J. McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-Attentive Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">ICDM</em>. 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Sein Kim, Hongseok Kang, Seungyoon Choi, Donghyun Kim, Min-Chul Yang, and Chanyoung Park. 2024.

</span>
<span class="ltx_bibblock">Large Language Models meet Collaborative Filtering: An Efficient All-round LLM-based Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">KDD</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koren et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Yehuda Koren, Robert M. Bell, and Chris Volinsky. 2009.

</span>
<span class="ltx_bibblock">Matrix Factorization Techniques for Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Computer</em> 42, 8 (2009), 30–37.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Jiacheng Li, Ming Wang, Jin Li, Jinmiao Fu, Xin Shen, Jingbo Shang, and Julian J. McAuley. 2023b.

</span>
<span class="ltx_bibblock">Text Is All You Need: Learning Language Representations for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">KDD</em>. 1258–1267.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xinhang Li, Chong Chen, Xiangyu Zhao, Yong Zhang, and Chunxiao Xing. 2023a.

</span>
<span class="ltx_bibblock">E4SRec: An Elegant Effective Efficient Extensible Solution of Large Language Models for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">arXiv Preprint</em> (2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.02443" title="">https://arxiv.org/abs/2312.02443</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang (2021)</span>
<span class="ltx_bibblock">
Xiang Lisa Li and Percy Liang. 2021.

</span>
<span class="ltx_bibblock">Prefix-Tuning: Optimizing Continuous Prompts for Generation. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">ACL/IJCNLP (1)</em>. 4582–4597.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jianghao Lin, Xinyi Dai, Yunjia Xi, Weiwen Liu, Bo Chen, Xiangyang Li, Chenxu Zhu, Huifeng Guo, Yong Yu, Ruiming Tang, and Weinan Zhang. 2024.

</span>
<span class="ltx_bibblock">How Can Recommender Systems Benefit from Large Language Models: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">ACM Trans. Inf. Syst.</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Hanxiao Liu, Karen Simonyan, and Yiming Yang. 2019b.

</span>
<span class="ltx_bibblock">DARTS: Differentiable Architecture Search. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">ICLR (Poster)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Peng Liu, Lemei Zhang, and Jon Atle Gulla. 2023.

</span>
<span class="ltx_bibblock">Pre-train, Prompt, and Recommendation: A Comprehensive Survey of Language Modeling Paradigm Adaptations in Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Trans. Assoc. Comput. Linguistics</em> 11 (2023), 1553–1571.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. 2019a.

</span>
<span class="ltx_bibblock">RoBERTa: A Robustly Optimized BERT Pretraining Approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">arXiv Preprint</em> (2019).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1907.11692" title="">https://arxiv.org/abs/1907.11692</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2019)</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter. 2019.

</span>
<span class="ltx_bibblock">Decoupled Weight Decay Regularization. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">ICLR (Poster)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yuning Mao, Lambert Mathias, Rui Hou, Amjad Almahairi, Hao Ma, Jiawei Han, Scott Yih, and Madian Khabsa. 2022.

</span>
<span class="ltx_bibblock">UniPELT: A Unified Framework for Parameter-Efficient Language Model Tuning. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">ACL (1)</em>. 6253–6264.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrov and Macdonald (2022)</span>
<span class="ltx_bibblock">
Aleksandr V. Petrov and Craig Macdonald. 2022.

</span>
<span class="ltx_bibblock">A Systematic Review and Replicability Study of BERT4Rec for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">RecSys</em>. 436–447.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ruihong Qiu, Zi Huang, Jingjing Li, and Hongzhi Yin. 2020.

</span>
<span class="ltx_bibblock">Exploiting Cross-session Information for Session-based Recommendation with Graph Neural Networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">ACM Trans. Inf. Syst.</em> 38, 3 (2020), 22:1–22:23.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Massimo Quadrana, Paolo Cremonesi, and Dietmar Jannach. 2018.

</span>
<span class="ltx_bibblock">Sequence-Aware Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">ACM Comput. Surv.</em> 51, 4 (2018), 66:1–66:36.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Massimo Quadrana, Alexandros Karatzoglou, Balázs Hidasi, and Paolo Cremonesi. 2017.

</span>
<span class="ltx_bibblock">Personalizing Session-based Recommendations with Hierarchical Recurrent Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">RecSys</em>. 130–137.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ruiyang Ren, Zhaoyang Liu, Yaliang Li, Wayne Xin Zhao, Hui Wang, Bolin Ding, and Ji-Rong Wen. 2020.

</span>
<span class="ltx_bibblock">Sequential Recommendation with Self-Attentive Multi-Adversarial Network. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">SIGIR</em>. 89–98.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, and Lars Schmidt-Thieme. 2010.

</span>
<span class="ltx_bibblock">Factorizing personalized Markov chains for next-basket recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">WWW</em>. 811–820.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential Recommendation with Bidirectional Encoder Representations from Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">CIKM</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhu Sun, Hongyang Liu, Xinghua Qu, Kaidong Feng, Yan Wang, and Yew Soon Ong. 2024.

</span>
<span class="ltx_bibblock">Large Language Models for Intent-Driven Session Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">SIGIR</em>. 324–334.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized Top-N Sequential Recommendation via Convolutional Sequence Embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">WSDM</em>. 565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tuan and Phuong (2017)</span>
<span class="ltx_bibblock">
Trinh Xuan Tuan and Tu Minh Phuong. 2017.

</span>
<span class="ltx_bibblock">3D Convolutional Networks for Session-based Recommendation with Content Features. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">RecSys</em>. 138–146.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Aäron van den Oord, Yazhe Li, and Oriol Vinyals. 2018.

</span>
<span class="ltx_bibblock">Representation Learning with Contrastive Predictive Coding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">arXiv Preprint</em> (2018).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1807.03748" title="">https://arxiv.org/abs/1807.03748</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shoujin Wang, Liang Hu, Yan Wang, Longbing Cao, Quan Z. Sheng, and Mehmet A. Orgun. 2019.

</span>
<span class="ltx_bibblock">Sequential Recommender Systems: Challenges, Progress and Prospects. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">IJCAI</em>. 6332–6338.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shoujin Wang, Qi Zhang, Liang Hu, Xiuzhen Zhang, Yan Wang, and Charu Aggarwal. 2022.

</span>
<span class="ltx_bibblock">Sequential/Session-based Recommendations: Challenges, Approaches, Applications and Opportunities. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">SIGIR</em>. 3425–3428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xilu Wang, Yaochu Jin, Sebastian Schmitt, and Markus Olhofer. 2023.

</span>
<span class="ltx_bibblock">Recent Advances in Bayesian Optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">ACM Comput. Surv.</em> 55, 13s (2023), 287:1–287:36.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Ziyan Wang, Yingpeng Du, Zhu Sun, Haoyan Chua, Kaidong Feng, Wenya Wang, and Jie Zhang. 2024.

</span>
<span class="ltx_bibblock">Re2LLM: Reflective Reinforcement Large Language Model for Session-based Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">arXiv Preprint</em> (2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2403.16427" title="">https://arxiv.org/abs/2403.16427</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shu Wu, Yuyuan Tang, Yanqiao Zhu, Liang Wang, Xing Xie, and Tieniu Tan. 2019.

</span>
<span class="ltx_bibblock">Session-Based Recommendation with Graph Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">AAAI</em>. 346–353.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Lanling Xu, Zhen Tian, Gaowei Zhang, Junjie Zhang, Lei Wang, Bowen Zheng, Yifan Li, Jiakai Tang, Zeyu Zhang, Yupeng Hou, Xingyu Pan, Wayne Xin Zhao, Xu Chen, and Ji-Rong Wen. 2023.

</span>
<span class="ltx_bibblock">Towards a More User-Friendly and Easy-to-Use Benchmark Library for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">SIGIR</em>. 2837–2847.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Shenghao Yang, Weizhi Ma, Peijie Sun, Qingyao Ai, Yiqun Liu, Mingchen Cai, and Min Zhang. 2024.

</span>
<span class="ltx_bibblock">Sequential Recommendation with Latent Relations based on Large Language Model. In <em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">SIGIR</em>. 335–344.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yap et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Ghim-Eng Yap, Xiaoli Li, and Philip S. Yu. 2012.

</span>
<span class="ltx_bibblock">Effective Next-Items Recommendation via Personalized Sequential Pattern Mining. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">DASFAA</em>, Vol. 7239. 48–64.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al<span class="ltx_text" id="bib.bib57.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Qingyu Yin, Xuzheng He, Xiang Zhuang, Yu Zhao, Jianhua Yao, Xiaoyu Shen, and Qiang Zhang. 2024.

</span>
<span class="ltx_bibblock">StableMask: Refining Causal Masking in Decoder-only Transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.3.1">arXiv Preprint</em> (2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.04779" title="">https://arxiv.org/abs/2402.04779</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib58.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Tingting Zhang, Pengpeng Zhao, Yanchi Liu, Victor S. Sheng, Jiajie Xu, Deqing Wang, Guanfeng Liu, and Xiaofang Zhou. 2019.

</span>
<span class="ltx_bibblock">Feature-level Deeper Self-Attention Network for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib58.3.1">IJCAI</em>. 4320–4326.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wayne Xin Zhao, Kun Zhou, Junyi Li, Tianyi Tang, Xiaolei Wang, Yupeng Hou, Yingqian Min, Beichen Zhang, Junjie Zhang, Zican Dong, Yifan Du, Chen Yang, Yushuo Chen, Zhipeng Chen, Jinhao Jiang, Ruiyang Ren, Yifan Li, Xinyu Tang, Zikang Liu, Peiyu Liu, Jian-Yun Nie, and Ji-Rong Wen. 2023.

</span>
<span class="ltx_bibblock">A Survey of Large Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">arXiv Preprint</em> (2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2303.18223" title="">https://arxiv.org/abs/2303.18223</a>
</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Generate Hard Samples</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.3">To construct hard samples, we adopt a pre-trained BERT model<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/google-bert/bert-base-uncased" title="">https://huggingface.co/google-bert/bert-base-uncased</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib7" title="">2019</a>)</cite> to encode item text embeddings and matrix factorization (MF) <cite class="ltx_cite ltx_citemacro_citep">(Koren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib28" title="">2009</a>)</cite> to produce item latent vectors.
First, we use the pre-trained BERT model to encode the item “sentence” of each item <math alttext="j" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_j</annotation></semantics></math> and use the average of representations of tokens in <math alttext="j" class="ltx_Math" display="inline" id="A1.p1.2.m2.1"><semantics id="A1.p1.2.m2.1a"><mi id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><ci id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">italic_j</annotation></semantics></math>’s item “sentence” as the item text embedding for <math alttext="j" class="ltx_Math" display="inline" id="A1.p1.3.m3.1"><semantics id="A1.p1.3.m3.1a"><mi id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><ci id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m3.1d">italic_j</annotation></semantics></math>.
Then, we perform matrix factorization <cite class="ltx_cite ltx_citemacro_citep">(Koren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib28" title="">2009</a>)</cite> over user-item interaction matrix to generate item latent vectors with the dimensionality of 1,000.</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.7">After that, for each item <math alttext="j" class="ltx_Math" display="inline" id="A1.p2.1.m1.1"><semantics id="A1.p2.1.m1.1a"><mi id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">italic_j</annotation></semantics></math>, we construct two similar item sets: one contains the top 0.5% most similar items to <math alttext="j" class="ltx_Math" display="inline" id="A1.p2.2.m2.1"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.1d">italic_j</annotation></semantics></math> w.r.t. L2 distance between item text embeddings, and the other contains the top 0.5% most similar items to <math alttext="j" class="ltx_Math" display="inline" id="A1.p2.3.m3.1"><semantics id="A1.p2.3.m3.1a"><mi id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><ci id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m3.1d">italic_j</annotation></semantics></math> w.r.t. L2 distance between item latent vectors.
The union of the two sets, excluding all items that co-occur with <math alttext="j" class="ltx_Math" display="inline" id="A1.p2.4.m4.1"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m4.1d">italic_j</annotation></semantics></math> in any user historical interaction sequence <math alttext="S" class="ltx_Math" display="inline" id="A1.p2.5.m5.1"><semantics id="A1.p2.5.m5.1a"><mi id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.1b"><ci id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.p2.5.m5.1d">italic_S</annotation></semantics></math>, is the hard item set <math alttext="N_{j}" class="ltx_Math" display="inline" id="A1.p2.6.m6.1"><semantics id="A1.p2.6.m6.1a"><msub id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">N</mi><mi id="A1.p2.6.m6.1.1.3" xref="A1.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1">subscript</csymbol><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝑁</ci><ci id="A1.p2.6.m6.1.1.3.cmml" xref="A1.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">N_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.6.m6.1d">italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="j" class="ltx_Math" display="inline" id="A1.p2.7.m7.1"><semantics id="A1.p2.7.m7.1a"><mi id="A1.p2.7.m7.1.1" xref="A1.p2.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.p2.7.m7.1b"><ci id="A1.p2.7.m7.1.1.cmml" xref="A1.p2.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.p2.7.m7.1d">italic_j</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Demonstration of Two Masking Mechanisms for Semantic Alignment</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A2" title="Appendix B Demonstration of Two Masking Mechanisms for Semantic Alignment ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">B</span></a> demonstrates the two masking mechanisms for semantic alignment.</p>
</div>
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="272" id="A2.1.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 13. </span>Two Masking Mechanisms for Semantic Alignment.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Attention Calculation</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.4">For the <math alttext="k" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mi id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><ci id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">italic_k</annotation></semantics></math>-th LLM layer, the hidden state <math alttext="h_{i}^{k}" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><msubsup id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml"><mi id="A3.p1.2.m2.1.1.2.2" xref="A3.p1.2.m2.1.1.2.2.cmml">h</mi><mi id="A3.p1.2.m2.1.1.2.3" xref="A3.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="A3.p1.2.m2.1.1.3" xref="A3.p1.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.1.1.cmml" xref="A3.p1.2.m2.1.1">superscript</csymbol><apply id="A3.p1.2.m2.1.1.2.cmml" xref="A3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.1.2.1.cmml" xref="A3.p1.2.m2.1.1">subscript</csymbol><ci id="A3.p1.2.m2.1.1.2.2.cmml" xref="A3.p1.2.m2.1.1.2.2">ℎ</ci><ci id="A3.p1.2.m2.1.1.2.3.cmml" xref="A3.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="A3.p1.2.m2.1.1.3.cmml" xref="A3.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">h_{i}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> of the <math alttext="i" class="ltx_Math" display="inline" id="A3.p1.3.m3.1"><semantics id="A3.p1.3.m3.1a"><mi id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><ci id="A3.p1.3.m3.1.1.cmml" xref="A3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m3.1d">italic_i</annotation></semantics></math>-th token is computed using causal masking and context masking (hidden states of all tokens are denoted by <math alttext="\mathbf{H}^{k}" class="ltx_Math" display="inline" id="A3.p1.4.m4.1"><semantics id="A3.p1.4.m4.1a"><msup id="A3.p1.4.m4.1.1" xref="A3.p1.4.m4.1.1.cmml"><mi id="A3.p1.4.m4.1.1.2" xref="A3.p1.4.m4.1.1.2.cmml">𝐇</mi><mi id="A3.p1.4.m4.1.1.3" xref="A3.p1.4.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A3.p1.4.m4.1b"><apply id="A3.p1.4.m4.1.1.cmml" xref="A3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p1.4.m4.1.1.1.cmml" xref="A3.p1.4.m4.1.1">superscript</csymbol><ci id="A3.p1.4.m4.1.1.2.cmml" xref="A3.p1.4.m4.1.1.2">𝐇</ci><ci id="A3.p1.4.m4.1.1.3.cmml" xref="A3.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.4.m4.1c">\mathbf{H}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.4.m4.1d">bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>). These two masking mechanisms facilitate the computation of attention with hidden states of other tokens, resulting in two distinct outputs.</p>
</div>
<div class="ltx_para" id="A3.p2">
<p class="ltx_p" id="A3.p2.3">Initially, we derive query matrix <math alttext="\mathbf{Q}^{k}" class="ltx_Math" display="inline" id="A3.p2.1.m1.1"><semantics id="A3.p2.1.m1.1a"><msup id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml"><mi id="A3.p2.1.m1.1.1.2" xref="A3.p2.1.m1.1.1.2.cmml">𝐐</mi><mi id="A3.p2.1.m1.1.1.3" xref="A3.p2.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.1.1.cmml" xref="A3.p2.1.m1.1.1">superscript</csymbol><ci id="A3.p2.1.m1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.2">𝐐</ci><ci id="A3.p2.1.m1.1.1.3.cmml" xref="A3.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">\mathbf{Q}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.1.m1.1d">bold_Q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, key matrix <math alttext="\mathbf{K}^{k}" class="ltx_Math" display="inline" id="A3.p2.2.m2.1"><semantics id="A3.p2.2.m2.1a"><msup id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml"><mi id="A3.p2.2.m2.1.1.2" xref="A3.p2.2.m2.1.1.2.cmml">𝐊</mi><mi id="A3.p2.2.m2.1.1.3" xref="A3.p2.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><apply id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p2.2.m2.1.1.1.cmml" xref="A3.p2.2.m2.1.1">superscript</csymbol><ci id="A3.p2.2.m2.1.1.2.cmml" xref="A3.p2.2.m2.1.1.2">𝐊</ci><ci id="A3.p2.2.m2.1.1.3.cmml" xref="A3.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">\mathbf{K}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.2.m2.1d">bold_K start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, and value matrix <math alttext="\mathbf{V}^{k}" class="ltx_Math" display="inline" id="A3.p2.3.m3.1"><semantics id="A3.p2.3.m3.1a"><msup id="A3.p2.3.m3.1.1" xref="A3.p2.3.m3.1.1.cmml"><mi id="A3.p2.3.m3.1.1.2" xref="A3.p2.3.m3.1.1.2.cmml">𝐕</mi><mi id="A3.p2.3.m3.1.1.3" xref="A3.p2.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.1b"><apply id="A3.p2.3.m3.1.1.cmml" xref="A3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.cmml" xref="A3.p2.3.m3.1.1">superscript</csymbol><ci id="A3.p2.3.m3.1.1.2.cmml" xref="A3.p2.3.m3.1.1.2">𝐕</ci><ci id="A3.p2.3.m3.1.1.3.cmml" xref="A3.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">\mathbf{V}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.3.m3.1d">bold_V start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> through linear transformations, formulated as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A3.Ex15">
<tbody id="A3.Ex15X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{Q}^{k}" class="ltx_Math" display="inline" id="A3.Ex15X.2.1.1.m1.1"><semantics id="A3.Ex15X.2.1.1.m1.1a"><msup id="A3.Ex15X.2.1.1.m1.1.1" xref="A3.Ex15X.2.1.1.m1.1.1.cmml"><mi id="A3.Ex15X.2.1.1.m1.1.1.2" mathsize="90%" xref="A3.Ex15X.2.1.1.m1.1.1.2.cmml">𝐐</mi><mi id="A3.Ex15X.2.1.1.m1.1.1.3" mathsize="90%" xref="A3.Ex15X.2.1.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A3.Ex15X.2.1.1.m1.1b"><apply id="A3.Ex15X.2.1.1.m1.1.1.cmml" xref="A3.Ex15X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.Ex15X.2.1.1.m1.1.1.1.cmml" xref="A3.Ex15X.2.1.1.m1.1.1">superscript</csymbol><ci id="A3.Ex15X.2.1.1.m1.1.1.2.cmml" xref="A3.Ex15X.2.1.1.m1.1.1.2">𝐐</ci><ci id="A3.Ex15X.2.1.1.m1.1.1.3.cmml" xref="A3.Ex15X.2.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15X.2.1.1.m1.1c">\displaystyle\mathbf{Q}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex15X.2.1.1.m1.1d">bold_Q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Linear}_{\mathbf{Q}^{k}}(\mathbf{H}^{k})=\mathbf{H}^{k}%
\mathbf{W}_{\mathbf{Q}^{k}}+\mathbf{b}_{\mathbf{Q}^{k}}" class="ltx_Math" display="inline" id="A3.Ex15X.3.2.2.m1.1"><semantics id="A3.Ex15X.3.2.2.m1.1a"><mrow id="A3.Ex15X.3.2.2.m1.1.1" xref="A3.Ex15X.3.2.2.m1.1.1.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.3" xref="A3.Ex15X.3.2.2.m1.1.1.3.cmml"></mi><mo id="A3.Ex15X.3.2.2.m1.1.1.4" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.4.cmml">=</mo><mrow id="A3.Ex15X.3.2.2.m1.1.1.1" xref="A3.Ex15X.3.2.2.m1.1.1.1.cmml"><msub id="A3.Ex15X.3.2.2.m1.1.1.1.3" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.cmml"><mtext id="A3.Ex15X.3.2.2.m1.1.1.1.3.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.2a.cmml">Linear</mtext><msup id="A3.Ex15X.3.2.2.m1.1.1.1.3.3" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.3.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.1.3.3.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.3.2.cmml">𝐐</mi><mi id="A3.Ex15X.3.2.2.m1.1.1.1.3.3.3" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.3.3.cmml">k</mi></msup></msub><mo id="A3.Ex15X.3.2.2.m1.1.1.1.2" xref="A3.Ex15X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex15X.3.2.2.m1.1.1.1.1.1" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><msup id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.2.cmml">𝐇</mi><mi id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.3" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex15X.3.2.2.m1.1.1.5" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.5.cmml">=</mo><mrow id="A3.Ex15X.3.2.2.m1.1.1.6" xref="A3.Ex15X.3.2.2.m1.1.1.6.cmml"><mrow id="A3.Ex15X.3.2.2.m1.1.1.6.2" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.cmml"><msup id="A3.Ex15X.3.2.2.m1.1.1.6.2.2" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.2.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.6.2.2.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.2.2.cmml">𝐇</mi><mi id="A3.Ex15X.3.2.2.m1.1.1.6.2.2.3" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.2.3.cmml">k</mi></msup><mo id="A3.Ex15X.3.2.2.m1.1.1.6.2.1" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.1.cmml">⁢</mo><msub id="A3.Ex15X.3.2.2.m1.1.1.6.2.3" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.2.cmml">𝐖</mi><msup id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.2.cmml">𝐐</mi><mi id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.3" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.3.cmml">k</mi></msup></msub></mrow><mo id="A3.Ex15X.3.2.2.m1.1.1.6.1" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.1.cmml">+</mo><msub id="A3.Ex15X.3.2.2.m1.1.1.6.3" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.6.3.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.2.cmml">𝐛</mi><msup id="A3.Ex15X.3.2.2.m1.1.1.6.3.3" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.3.cmml"><mi id="A3.Ex15X.3.2.2.m1.1.1.6.3.3.2" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.3.2.cmml">𝐐</mi><mi id="A3.Ex15X.3.2.2.m1.1.1.6.3.3.3" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.3.3.cmml">k</mi></msup></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex15X.3.2.2.m1.1b"><apply id="A3.Ex15X.3.2.2.m1.1.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1"><and id="A3.Ex15X.3.2.2.m1.1.1a.cmml" xref="A3.Ex15X.3.2.2.m1.1.1"></and><apply id="A3.Ex15X.3.2.2.m1.1.1b.cmml" xref="A3.Ex15X.3.2.2.m1.1.1"><eq id="A3.Ex15X.3.2.2.m1.1.1.4.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.4"></eq><csymbol cd="latexml" id="A3.Ex15X.3.2.2.m1.1.1.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.3">absent</csymbol><apply id="A3.Ex15X.3.2.2.m1.1.1.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1"><times id="A3.Ex15X.3.2.2.m1.1.1.1.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.2"></times><apply id="A3.Ex15X.3.2.2.m1.1.1.1.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.1.3.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.3">subscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.1.3.2a.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.2"><mtext id="A3.Ex15X.3.2.2.m1.1.1.1.3.2.cmml" mathsize="90%" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.2">Linear</mtext></ci><apply id="A3.Ex15X.3.2.2.m1.1.1.1.3.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.1.3.3.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.3">superscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.1.3.3.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.3.2">𝐐</ci><ci id="A3.Ex15X.3.2.2.m1.1.1.1.3.3.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.2">𝐇</ci><ci id="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="A3.Ex15X.3.2.2.m1.1.1c.cmml" xref="A3.Ex15X.3.2.2.m1.1.1"><eq id="A3.Ex15X.3.2.2.m1.1.1.5.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.5"></eq><share href="https://arxiv.org/html/2408.07427v1#A3.Ex15X.3.2.2.m1.1.1.1.cmml" id="A3.Ex15X.3.2.2.m1.1.1d.cmml" xref="A3.Ex15X.3.2.2.m1.1.1"></share><apply id="A3.Ex15X.3.2.2.m1.1.1.6.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6"><plus id="A3.Ex15X.3.2.2.m1.1.1.6.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.1"></plus><apply id="A3.Ex15X.3.2.2.m1.1.1.6.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2"><times id="A3.Ex15X.3.2.2.m1.1.1.6.2.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.1"></times><apply id="A3.Ex15X.3.2.2.m1.1.1.6.2.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.2"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.6.2.2.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.2">superscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.6.2.2.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.2.2">𝐇</ci><ci id="A3.Ex15X.3.2.2.m1.1.1.6.2.2.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.2.3">𝑘</ci></apply><apply id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3">subscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.2">𝐖</ci><apply id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3">superscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.2">𝐐</ci><ci id="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="A3.Ex15X.3.2.2.m1.1.1.6.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.3"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.6.3.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.3">subscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.6.3.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.2">𝐛</ci><apply id="A3.Ex15X.3.2.2.m1.1.1.6.3.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.3"><csymbol cd="ambiguous" id="A3.Ex15X.3.2.2.m1.1.1.6.3.3.1.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.3">superscript</csymbol><ci id="A3.Ex15X.3.2.2.m1.1.1.6.3.3.2.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.3.2">𝐐</ci><ci id="A3.Ex15X.3.2.2.m1.1.1.6.3.3.3.cmml" xref="A3.Ex15X.3.2.2.m1.1.1.6.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15X.3.2.2.m1.1c">\displaystyle=\text{Linear}_{\mathbf{Q}^{k}}(\mathbf{H}^{k})=\mathbf{H}^{k}%
\mathbf{W}_{\mathbf{Q}^{k}}+\mathbf{b}_{\mathbf{Q}^{k}}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex15X.3.2.2.m1.1d">= Linear start_POSTSUBSCRIPT bold_Q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ) = bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT bold_Q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT bold_Q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex15Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{K}^{k}" class="ltx_Math" display="inline" id="A3.Ex15Xa.2.1.1.m1.1"><semantics id="A3.Ex15Xa.2.1.1.m1.1a"><msup id="A3.Ex15Xa.2.1.1.m1.1.1" xref="A3.Ex15Xa.2.1.1.m1.1.1.cmml"><mi id="A3.Ex15Xa.2.1.1.m1.1.1.2" mathsize="90%" xref="A3.Ex15Xa.2.1.1.m1.1.1.2.cmml">𝐊</mi><mi id="A3.Ex15Xa.2.1.1.m1.1.1.3" mathsize="90%" xref="A3.Ex15Xa.2.1.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A3.Ex15Xa.2.1.1.m1.1b"><apply id="A3.Ex15Xa.2.1.1.m1.1.1.cmml" xref="A3.Ex15Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.Ex15Xa.2.1.1.m1.1.1.1.cmml" xref="A3.Ex15Xa.2.1.1.m1.1.1">superscript</csymbol><ci id="A3.Ex15Xa.2.1.1.m1.1.1.2.cmml" xref="A3.Ex15Xa.2.1.1.m1.1.1.2">𝐊</ci><ci id="A3.Ex15Xa.2.1.1.m1.1.1.3.cmml" xref="A3.Ex15Xa.2.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15Xa.2.1.1.m1.1c">\displaystyle\mathbf{K}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex15Xa.2.1.1.m1.1d">bold_K start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Linear}_{\mathbf{K}^{k}}(\mathbf{H}^{k})=\mathbf{H}^{k}%
\mathbf{W}_{\mathbf{K}^{k}}+\mathbf{b}_{\mathbf{K}^{k}}" class="ltx_Math" display="inline" id="A3.Ex15Xa.3.2.2.m1.1"><semantics id="A3.Ex15Xa.3.2.2.m1.1a"><mrow id="A3.Ex15Xa.3.2.2.m1.1.1" xref="A3.Ex15Xa.3.2.2.m1.1.1.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.3" xref="A3.Ex15Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="A3.Ex15Xa.3.2.2.m1.1.1.4" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.4.cmml">=</mo><mrow id="A3.Ex15Xa.3.2.2.m1.1.1.1" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.cmml"><msub id="A3.Ex15Xa.3.2.2.m1.1.1.1.3" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.cmml"><mtext id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.2a.cmml">Linear</mtext><msup id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.2.cmml">𝐊</mi><mi id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.3" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.3.cmml">k</mi></msup></msub><mo id="A3.Ex15Xa.3.2.2.m1.1.1.1.2" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><msup id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">𝐇</mi><mi id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.3" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex15Xa.3.2.2.m1.1.1.5" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.5.cmml">=</mo><mrow id="A3.Ex15Xa.3.2.2.m1.1.1.6" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.cmml"><mrow id="A3.Ex15Xa.3.2.2.m1.1.1.6.2" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.cmml"><msup id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.2.cmml">𝐇</mi><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.3" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.3.cmml">k</mi></msup><mo id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.1" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.1.cmml">⁢</mo><msub id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.2.cmml">𝐖</mi><msup id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.2.cmml">𝐊</mi><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.3" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.3.cmml">k</mi></msup></msub></mrow><mo id="A3.Ex15Xa.3.2.2.m1.1.1.6.1" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.1.cmml">+</mo><msub id="A3.Ex15Xa.3.2.2.m1.1.1.6.3" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.2.cmml">𝐛</mi><msup id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.cmml"><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.2" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.2.cmml">𝐊</mi><mi id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.3" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.3.cmml">k</mi></msup></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex15Xa.3.2.2.m1.1b"><apply id="A3.Ex15Xa.3.2.2.m1.1.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1"><and id="A3.Ex15Xa.3.2.2.m1.1.1a.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1"></and><apply id="A3.Ex15Xa.3.2.2.m1.1.1b.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1"><eq id="A3.Ex15Xa.3.2.2.m1.1.1.4.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.4"></eq><csymbol cd="latexml" id="A3.Ex15Xa.3.2.2.m1.1.1.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="A3.Ex15Xa.3.2.2.m1.1.1.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1"><times id="A3.Ex15Xa.3.2.2.m1.1.1.1.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.2"></times><apply id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3">subscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.2a.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.2"><mtext id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.2.cmml" mathsize="90%" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.2">Linear</mtext></ci><apply id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3">superscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.2">𝐊</ci><ci id="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.2">𝐇</ci><ci id="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="A3.Ex15Xa.3.2.2.m1.1.1c.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1"><eq id="A3.Ex15Xa.3.2.2.m1.1.1.5.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.5"></eq><share href="https://arxiv.org/html/2408.07427v1#A3.Ex15Xa.3.2.2.m1.1.1.1.cmml" id="A3.Ex15Xa.3.2.2.m1.1.1d.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1"></share><apply id="A3.Ex15Xa.3.2.2.m1.1.1.6.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6"><plus id="A3.Ex15Xa.3.2.2.m1.1.1.6.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.1"></plus><apply id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2"><times id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.1"></times><apply id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2">superscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.2">𝐇</ci><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.2.3">𝑘</ci></apply><apply id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3">subscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.2">𝐖</ci><apply id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3">superscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.2">𝐊</ci><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3">subscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.2">𝐛</ci><apply id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3"><csymbol cd="ambiguous" id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.1.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3">superscript</csymbol><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.2.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.2">𝐊</ci><ci id="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.3.cmml" xref="A3.Ex15Xa.3.2.2.m1.1.1.6.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15Xa.3.2.2.m1.1c">\displaystyle=\text{Linear}_{\mathbf{K}^{k}}(\mathbf{H}^{k})=\mathbf{H}^{k}%
\mathbf{W}_{\mathbf{K}^{k}}+\mathbf{b}_{\mathbf{K}^{k}}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex15Xa.3.2.2.m1.1d">= Linear start_POSTSUBSCRIPT bold_K start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ) = bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT bold_K start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT bold_K start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex15Xb"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{V}^{k}" class="ltx_Math" display="inline" id="A3.Ex15Xb.2.1.1.m1.1"><semantics id="A3.Ex15Xb.2.1.1.m1.1a"><msup id="A3.Ex15Xb.2.1.1.m1.1.1" xref="A3.Ex15Xb.2.1.1.m1.1.1.cmml"><mi id="A3.Ex15Xb.2.1.1.m1.1.1.2" mathsize="90%" xref="A3.Ex15Xb.2.1.1.m1.1.1.2.cmml">𝐕</mi><mi id="A3.Ex15Xb.2.1.1.m1.1.1.3" mathsize="90%" xref="A3.Ex15Xb.2.1.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="A3.Ex15Xb.2.1.1.m1.1b"><apply id="A3.Ex15Xb.2.1.1.m1.1.1.cmml" xref="A3.Ex15Xb.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.Ex15Xb.2.1.1.m1.1.1.1.cmml" xref="A3.Ex15Xb.2.1.1.m1.1.1">superscript</csymbol><ci id="A3.Ex15Xb.2.1.1.m1.1.1.2.cmml" xref="A3.Ex15Xb.2.1.1.m1.1.1.2">𝐕</ci><ci id="A3.Ex15Xb.2.1.1.m1.1.1.3.cmml" xref="A3.Ex15Xb.2.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15Xb.2.1.1.m1.1c">\displaystyle\mathbf{V}^{k}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex15Xb.2.1.1.m1.1d">bold_V start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Linear}_{V^{k}}(\mathbf{H}^{k})=\mathbf{H}^{k}\mathbf{W}_{%
\mathbf{V}^{k}}+\mathbf{b}_{\mathbf{V}^{k}}" class="ltx_Math" display="inline" id="A3.Ex15Xb.3.2.2.m1.1"><semantics id="A3.Ex15Xb.3.2.2.m1.1a"><mrow id="A3.Ex15Xb.3.2.2.m1.1.1" xref="A3.Ex15Xb.3.2.2.m1.1.1.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.3" xref="A3.Ex15Xb.3.2.2.m1.1.1.3.cmml"></mi><mo id="A3.Ex15Xb.3.2.2.m1.1.1.4" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.4.cmml">=</mo><mrow id="A3.Ex15Xb.3.2.2.m1.1.1.1" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.cmml"><msub id="A3.Ex15Xb.3.2.2.m1.1.1.1.3" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.cmml"><mtext id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.2a.cmml">Linear</mtext><msup id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.2.cmml">V</mi><mi id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.3" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.3.cmml">k</mi></msup></msub><mo id="A3.Ex15Xb.3.2.2.m1.1.1.1.2" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><msup id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml">𝐇</mi><mi id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.3" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.Ex15Xb.3.2.2.m1.1.1.5" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.5.cmml">=</mo><mrow id="A3.Ex15Xb.3.2.2.m1.1.1.6" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.cmml"><mrow id="A3.Ex15Xb.3.2.2.m1.1.1.6.2" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.cmml"><msup id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.2.cmml">𝐇</mi><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.3" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.3.cmml">k</mi></msup><mo id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.1" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.1.cmml">⁢</mo><msub id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.2.cmml">𝐖</mi><msup id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.2.cmml">𝐕</mi><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.3" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.3.cmml">k</mi></msup></msub></mrow><mo id="A3.Ex15Xb.3.2.2.m1.1.1.6.1" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.1.cmml">+</mo><msub id="A3.Ex15Xb.3.2.2.m1.1.1.6.3" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.2.cmml">𝐛</mi><msup id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.cmml"><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.2" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.2.cmml">𝐕</mi><mi id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.3" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.3.cmml">k</mi></msup></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex15Xb.3.2.2.m1.1b"><apply id="A3.Ex15Xb.3.2.2.m1.1.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1"><and id="A3.Ex15Xb.3.2.2.m1.1.1a.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1"></and><apply id="A3.Ex15Xb.3.2.2.m1.1.1b.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1"><eq id="A3.Ex15Xb.3.2.2.m1.1.1.4.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.4"></eq><csymbol cd="latexml" id="A3.Ex15Xb.3.2.2.m1.1.1.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.3">absent</csymbol><apply id="A3.Ex15Xb.3.2.2.m1.1.1.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1"><times id="A3.Ex15Xb.3.2.2.m1.1.1.1.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.2"></times><apply id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3">subscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.2a.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.2"><mtext id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.2.cmml" mathsize="90%" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.2">Linear</mtext></ci><apply id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3">superscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.2">𝑉</ci><ci id="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.2">𝐇</ci><ci id="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="A3.Ex15Xb.3.2.2.m1.1.1c.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1"><eq id="A3.Ex15Xb.3.2.2.m1.1.1.5.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.5"></eq><share href="https://arxiv.org/html/2408.07427v1#A3.Ex15Xb.3.2.2.m1.1.1.1.cmml" id="A3.Ex15Xb.3.2.2.m1.1.1d.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1"></share><apply id="A3.Ex15Xb.3.2.2.m1.1.1.6.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6"><plus id="A3.Ex15Xb.3.2.2.m1.1.1.6.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.1"></plus><apply id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2"><times id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.1"></times><apply id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2">superscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.2">𝐇</ci><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.2.3">𝑘</ci></apply><apply id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3">subscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.2">𝐖</ci><apply id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3">superscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.2">𝐕</ci><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3">subscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.2">𝐛</ci><apply id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3"><csymbol cd="ambiguous" id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.1.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3">superscript</csymbol><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.2.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.2">𝐕</ci><ci id="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.3.cmml" xref="A3.Ex15Xb.3.2.2.m1.1.1.6.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15Xb.3.2.2.m1.1c">\displaystyle=\text{Linear}_{V^{k}}(\mathbf{H}^{k})=\mathbf{H}^{k}\mathbf{W}_{%
\mathbf{V}^{k}}+\mathbf{b}_{\mathbf{V}^{k}}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex15Xb.3.2.2.m1.1d">= Linear start_POSTSUBSCRIPT italic_V start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ) = bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT bold_V start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT + bold_b start_POSTSUBSCRIPT bold_V start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p2.5">where <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="A3.p2.4.m1.1"><semantics id="A3.p2.4.m1.1a"><mi id="A3.p2.4.m1.1.1" xref="A3.p2.4.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="A3.p2.4.m1.1b"><ci id="A3.p2.4.m1.1.1.cmml" xref="A3.p2.4.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.4.m1.1d">bold_W</annotation></semantics></math> and <math alttext="\mathbf{b}" class="ltx_Math" display="inline" id="A3.p2.5.m2.1"><semantics id="A3.p2.5.m2.1a"><mi id="A3.p2.5.m2.1.1" xref="A3.p2.5.m2.1.1.cmml">𝐛</mi><annotation-xml encoding="MathML-Content" id="A3.p2.5.m2.1b"><ci id="A3.p2.5.m2.1.1.cmml" xref="A3.p2.5.m2.1.1">𝐛</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.5.m2.1c">\mathbf{b}</annotation><annotation encoding="application/x-llamapun" id="A3.p2.5.m2.1d">bold_b</annotation></semantics></math> are learnable weights.</p>
</div>
<div class="ltx_para" id="A3.p3">
<p class="ltx_p" id="A3.p3.7">Subsequently, the attention weights are computed using causal masking and context masking, and the outputs are:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A3.Ex16">
<tbody id="A3.Ex16X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Linear}(\mathbf{H})" class="ltx_Math" display="inline" id="A3.Ex16X.2.1.1.m1.1"><semantics id="A3.Ex16X.2.1.1.m1.1a"><mrow id="A3.Ex16X.2.1.1.m1.1.2" xref="A3.Ex16X.2.1.1.m1.1.2.cmml"><mtext id="A3.Ex16X.2.1.1.m1.1.2.2" mathsize="90%" xref="A3.Ex16X.2.1.1.m1.1.2.2a.cmml">Linear</mtext><mo id="A3.Ex16X.2.1.1.m1.1.2.1" xref="A3.Ex16X.2.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A3.Ex16X.2.1.1.m1.1.2.3.2" xref="A3.Ex16X.2.1.1.m1.1.2.cmml"><mo id="A3.Ex16X.2.1.1.m1.1.2.3.2.1" maxsize="90%" minsize="90%" xref="A3.Ex16X.2.1.1.m1.1.2.cmml">(</mo><mi id="A3.Ex16X.2.1.1.m1.1.1" mathsize="90%" xref="A3.Ex16X.2.1.1.m1.1.1.cmml">𝐇</mi><mo id="A3.Ex16X.2.1.1.m1.1.2.3.2.2" maxsize="90%" minsize="90%" xref="A3.Ex16X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex16X.2.1.1.m1.1b"><apply id="A3.Ex16X.2.1.1.m1.1.2.cmml" xref="A3.Ex16X.2.1.1.m1.1.2"><times id="A3.Ex16X.2.1.1.m1.1.2.1.cmml" xref="A3.Ex16X.2.1.1.m1.1.2.1"></times><ci id="A3.Ex16X.2.1.1.m1.1.2.2a.cmml" xref="A3.Ex16X.2.1.1.m1.1.2.2"><mtext id="A3.Ex16X.2.1.1.m1.1.2.2.cmml" mathsize="90%" xref="A3.Ex16X.2.1.1.m1.1.2.2">Linear</mtext></ci><ci id="A3.Ex16X.2.1.1.m1.1.1.cmml" xref="A3.Ex16X.2.1.1.m1.1.1">𝐇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex16X.2.1.1.m1.1c">\displaystyle\text{Linear}(\mathbf{H})</annotation><annotation encoding="application/x-llamapun" id="A3.Ex16X.2.1.1.m1.1d">Linear ( bold_H )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{W}_{\text{Linear}}\mathbf{H}+\mathbf{B}_{\text{Linear}}" class="ltx_Math" display="inline" id="A3.Ex16X.3.2.2.m1.1"><semantics id="A3.Ex16X.3.2.2.m1.1a"><mrow id="A3.Ex16X.3.2.2.m1.1.1" xref="A3.Ex16X.3.2.2.m1.1.1.cmml"><mi id="A3.Ex16X.3.2.2.m1.1.1.2" xref="A3.Ex16X.3.2.2.m1.1.1.2.cmml"></mi><mo id="A3.Ex16X.3.2.2.m1.1.1.1" mathsize="90%" xref="A3.Ex16X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="A3.Ex16X.3.2.2.m1.1.1.3" xref="A3.Ex16X.3.2.2.m1.1.1.3.cmml"><mrow id="A3.Ex16X.3.2.2.m1.1.1.3.2" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.cmml"><msub id="A3.Ex16X.3.2.2.m1.1.1.3.2.2" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2.cmml"><mi id="A3.Ex16X.3.2.2.m1.1.1.3.2.2.2" mathsize="90%" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2.2.cmml">𝐖</mi><mtext id="A3.Ex16X.3.2.2.m1.1.1.3.2.2.3" mathsize="90%" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2.3a.cmml">Linear</mtext></msub><mo id="A3.Ex16X.3.2.2.m1.1.1.3.2.1" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.1.cmml">⁢</mo><mi id="A3.Ex16X.3.2.2.m1.1.1.3.2.3" mathsize="90%" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.3.cmml">𝐇</mi></mrow><mo id="A3.Ex16X.3.2.2.m1.1.1.3.1" mathsize="90%" xref="A3.Ex16X.3.2.2.m1.1.1.3.1.cmml">+</mo><msub id="A3.Ex16X.3.2.2.m1.1.1.3.3" xref="A3.Ex16X.3.2.2.m1.1.1.3.3.cmml"><mi id="A3.Ex16X.3.2.2.m1.1.1.3.3.2" mathsize="90%" xref="A3.Ex16X.3.2.2.m1.1.1.3.3.2.cmml">𝐁</mi><mtext id="A3.Ex16X.3.2.2.m1.1.1.3.3.3" mathsize="90%" xref="A3.Ex16X.3.2.2.m1.1.1.3.3.3a.cmml">Linear</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex16X.3.2.2.m1.1b"><apply id="A3.Ex16X.3.2.2.m1.1.1.cmml" xref="A3.Ex16X.3.2.2.m1.1.1"><eq id="A3.Ex16X.3.2.2.m1.1.1.1.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="A3.Ex16X.3.2.2.m1.1.1.2.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.2">absent</csymbol><apply id="A3.Ex16X.3.2.2.m1.1.1.3.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3"><plus id="A3.Ex16X.3.2.2.m1.1.1.3.1.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.1"></plus><apply id="A3.Ex16X.3.2.2.m1.1.1.3.2.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.2"><times id="A3.Ex16X.3.2.2.m1.1.1.3.2.1.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.1"></times><apply id="A3.Ex16X.3.2.2.m1.1.1.3.2.2.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="A3.Ex16X.3.2.2.m1.1.1.3.2.2.1.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2">subscript</csymbol><ci id="A3.Ex16X.3.2.2.m1.1.1.3.2.2.2.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2.2">𝐖</ci><ci id="A3.Ex16X.3.2.2.m1.1.1.3.2.2.3a.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2.3"><mtext id="A3.Ex16X.3.2.2.m1.1.1.3.2.2.3.cmml" mathsize="63%" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.2.3">Linear</mtext></ci></apply><ci id="A3.Ex16X.3.2.2.m1.1.1.3.2.3.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.2.3">𝐇</ci></apply><apply id="A3.Ex16X.3.2.2.m1.1.1.3.3.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.3"><csymbol cd="ambiguous" id="A3.Ex16X.3.2.2.m1.1.1.3.3.1.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.3">subscript</csymbol><ci id="A3.Ex16X.3.2.2.m1.1.1.3.3.2.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.3.2">𝐁</ci><ci id="A3.Ex16X.3.2.2.m1.1.1.3.3.3a.cmml" xref="A3.Ex16X.3.2.2.m1.1.1.3.3.3"><mtext id="A3.Ex16X.3.2.2.m1.1.1.3.3.3.cmml" mathsize="63%" xref="A3.Ex16X.3.2.2.m1.1.1.3.3.3">Linear</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex16X.3.2.2.m1.1c">\displaystyle=\mathbf{W}_{\text{Linear}}\mathbf{H}+\mathbf{B}_{\text{Linear}}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex16X.3.2.2.m1.1d">= bold_W start_POSTSUBSCRIPT Linear end_POSTSUBSCRIPT bold_H + bold_B start_POSTSUBSCRIPT Linear end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex16Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Self-Attention}(\mathbf{H}^{k},\textbf{MASK})" class="ltx_Math" display="inline" id="A3.Ex16Xa.2.1.1.m1.2"><semantics id="A3.Ex16Xa.2.1.1.m1.2a"><mrow id="A3.Ex16Xa.2.1.1.m1.2.2" xref="A3.Ex16Xa.2.1.1.m1.2.2.cmml"><mtext id="A3.Ex16Xa.2.1.1.m1.2.2.3" mathsize="90%" xref="A3.Ex16Xa.2.1.1.m1.2.2.3a.cmml">Self-Attention</mtext><mo id="A3.Ex16Xa.2.1.1.m1.2.2.2" xref="A3.Ex16Xa.2.1.1.m1.2.2.2.cmml">⁢</mo><mrow id="A3.Ex16Xa.2.1.1.m1.2.2.1.1" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.2.cmml"><mo id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.2" maxsize="90%" minsize="90%" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.2.cmml">(</mo><msup id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.cmml"><mi id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.2" mathsize="90%" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.2.cmml">𝐇</mi><mi id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.3" mathsize="90%" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.3.cmml">k</mi></msup><mo id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.3" mathsize="90%" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.2.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="A3.Ex16Xa.2.1.1.m1.1.1" mathsize="90%" xref="A3.Ex16Xa.2.1.1.m1.1.1a.cmml">MASK</mtext><mo id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.4" maxsize="90%" minsize="90%" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex16Xa.2.1.1.m1.2b"><apply id="A3.Ex16Xa.2.1.1.m1.2.2.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2"><times id="A3.Ex16Xa.2.1.1.m1.2.2.2.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2.2"></times><ci id="A3.Ex16Xa.2.1.1.m1.2.2.3a.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2.3"><mtext id="A3.Ex16Xa.2.1.1.m1.2.2.3.cmml" mathsize="90%" xref="A3.Ex16Xa.2.1.1.m1.2.2.3">Self-Attention</mtext></ci><interval closure="open" id="A3.Ex16Xa.2.1.1.m1.2.2.1.2.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1"><apply id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.2">𝐇</ci><ci id="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.3.cmml" xref="A3.Ex16Xa.2.1.1.m1.2.2.1.1.1.3">𝑘</ci></apply><ci id="A3.Ex16Xa.2.1.1.m1.1.1a.cmml" xref="A3.Ex16Xa.2.1.1.m1.1.1"><mtext class="ltx_mathvariant_bold" id="A3.Ex16Xa.2.1.1.m1.1.1.cmml" mathsize="90%" xref="A3.Ex16Xa.2.1.1.m1.1.1">MASK</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex16Xa.2.1.1.m1.2c">\displaystyle\text{Self-Attention}(\mathbf{H}^{k},\textbf{MASK})</annotation><annotation encoding="application/x-llamapun" id="A3.Ex16Xa.2.1.1.m1.2d">Self-Attention ( bold_H start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT , MASK )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Linear}\Big{(}\text{Softmax}\left(\frac{\mathbf{Q}^{k}(%
\mathbf{K}^{k})^{T}}{\sqrt{d_{LLM}}}\odot\textbf{MASK}\right)\mathbf{V}^{k}%
\Big{)}" class="ltx_Math" display="inline" id="A3.Ex16Xa.3.2.2.m1.2"><semantics id="A3.Ex16Xa.3.2.2.m1.2a"><mrow id="A3.Ex16Xa.3.2.2.m1.2.2" xref="A3.Ex16Xa.3.2.2.m1.2.2.cmml"><mi id="A3.Ex16Xa.3.2.2.m1.2.2.3" xref="A3.Ex16Xa.3.2.2.m1.2.2.3.cmml"></mi><mo id="A3.Ex16Xa.3.2.2.m1.2.2.2" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="A3.Ex16Xa.3.2.2.m1.2.2.1" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.cmml"><mtext id="A3.Ex16Xa.3.2.2.m1.2.2.1.3" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.3a.cmml">Linear</mtext><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.2" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.2.cmml">⁢</mo><mrow id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.2" maxsize="160%" minsize="160%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><mtext id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.3" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.3a.cmml">Softmax</mtext><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.2" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A3.Ex16Xa.3.2.2.m1.1.1" xref="A3.Ex16Xa.3.2.2.m1.1.1.cmml"><mfrac id="A3.Ex16Xa.3.2.2.m1.1.1a" xref="A3.Ex16Xa.3.2.2.m1.1.1.cmml"><mrow id="A3.Ex16Xa.3.2.2.m1.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.cmml"><msup id="A3.Ex16Xa.3.2.2.m1.1.1.1.3" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.3.cmml"><mi id="A3.Ex16Xa.3.2.2.m1.1.1.1.3.2" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.3.2.cmml">𝐐</mi><mi id="A3.Ex16Xa.3.2.2.m1.1.1.1.3.3" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.3.3.cmml">k</mi></msup><mo id="A3.Ex16Xa.3.2.2.m1.1.1.1.2" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.2.cmml">⁢</mo><msup id="A3.Ex16Xa.3.2.2.m1.1.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mi id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.2" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">𝐊</mi><mi id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.3" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.3" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.3.cmml">T</mi></msup></mrow><msqrt id="A3.Ex16Xa.3.2.2.m1.1.1.3" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.cmml"><msub id="A3.Ex16Xa.3.2.2.m1.1.1.3.2" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.cmml"><mi id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.2" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.2.cmml">d</mi><mrow id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.cmml"><mi id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.2" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.2.cmml">L</mi><mo id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.1" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.3" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.3.cmml">L</mi><mo id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.1a" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.4" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.4.cmml">M</mi></mrow></msub></msqrt></mfrac></mstyle><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">⊙</mo><mtext class="ltx_mathvariant_bold" id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2a.cmml">MASK</mtext></mrow><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.2a" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">⁢</mo><msup id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.cmml"><mi id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.2" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.2.cmml">𝐕</mi><mi id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.3" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.3.cmml">k</mi></msup></mrow><mo id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.3" maxsize="160%" minsize="160%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex16Xa.3.2.2.m1.2b"><apply id="A3.Ex16Xa.3.2.2.m1.2.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2"><eq id="A3.Ex16Xa.3.2.2.m1.2.2.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="A3.Ex16Xa.3.2.2.m1.2.2.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.3">absent</csymbol><apply id="A3.Ex16Xa.3.2.2.m1.2.2.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1"><times id="A3.Ex16Xa.3.2.2.m1.2.2.1.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.2"></times><ci id="A3.Ex16Xa.3.2.2.m1.2.2.1.3a.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.3"><mtext id="A3.Ex16Xa.3.2.2.m1.2.2.1.3.cmml" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.3">Linear</mtext></ci><apply id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1"><times id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.2"></times><ci id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.3a.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.3"><mtext id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.3">Softmax</mtext></ci><apply id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="A3.Ex16Xa.3.2.2.m1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1"><divide id="A3.Ex16Xa.3.2.2.m1.1.1.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1"></divide><apply id="A3.Ex16Xa.3.2.2.m1.1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1"><times id="A3.Ex16Xa.3.2.2.m1.1.1.1.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.2"></times><apply id="A3.Ex16Xa.3.2.2.m1.1.1.1.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="A3.Ex16Xa.3.2.2.m1.1.1.1.3.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.3">superscript</csymbol><ci id="A3.Ex16Xa.3.2.2.m1.1.1.1.3.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.3.2">𝐐</ci><ci id="A3.Ex16Xa.3.2.2.m1.1.1.1.3.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.3.3">𝑘</ci></apply><apply id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1">superscript</csymbol><apply id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.2">𝐊</ci><ci id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><ci id="A3.Ex16Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="A3.Ex16Xa.3.2.2.m1.1.1.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3"><root id="A3.Ex16Xa.3.2.2.m1.1.1.3a.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3"></root><apply id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2">subscript</csymbol><ci id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.2">𝑑</ci><apply id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3"><times id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.1"></times><ci id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.2">𝐿</ci><ci id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.3">𝐿</ci><ci id="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.4.cmml" xref="A3.Ex16Xa.3.2.2.m1.1.1.3.2.3.4">𝑀</ci></apply></apply></apply></apply><ci id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2a.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" mathsize="90%" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">MASK</mtext></ci></apply><apply id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.1.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4">superscript</csymbol><ci id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.2.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.2">𝐕</ci><ci id="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.3.cmml" xref="A3.Ex16Xa.3.2.2.m1.2.2.1.1.1.1.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex16Xa.3.2.2.m1.2c">\displaystyle=\text{Linear}\Big{(}\text{Softmax}\left(\frac{\mathbf{Q}^{k}(%
\mathbf{K}^{k})^{T}}{\sqrt{d_{LLM}}}\odot\textbf{MASK}\right)\mathbf{V}^{k}%
\Big{)}</annotation><annotation encoding="application/x-llamapun" id="A3.Ex16Xa.3.2.2.m1.2d">= Linear ( Softmax ( divide start_ARG bold_Q start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( bold_K start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT end_ARG end_ARG ⊙ MASK ) bold_V start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A3.p3.6">where <math alttext="d_{LLM}" class="ltx_Math" display="inline" id="A3.p3.1.m1.1"><semantics id="A3.p3.1.m1.1a"><msub id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><mi id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml">d</mi><mrow id="A3.p3.1.m1.1.1.3" xref="A3.p3.1.m1.1.1.3.cmml"><mi id="A3.p3.1.m1.1.1.3.2" xref="A3.p3.1.m1.1.1.3.2.cmml">L</mi><mo id="A3.p3.1.m1.1.1.3.1" xref="A3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A3.p3.1.m1.1.1.3.3" xref="A3.p3.1.m1.1.1.3.3.cmml">L</mi><mo id="A3.p3.1.m1.1.1.3.1a" xref="A3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A3.p3.1.m1.1.1.3.4" xref="A3.p3.1.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1">subscript</csymbol><ci id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2">𝑑</ci><apply id="A3.p3.1.m1.1.1.3.cmml" xref="A3.p3.1.m1.1.1.3"><times id="A3.p3.1.m1.1.1.3.1.cmml" xref="A3.p3.1.m1.1.1.3.1"></times><ci id="A3.p3.1.m1.1.1.3.2.cmml" xref="A3.p3.1.m1.1.1.3.2">𝐿</ci><ci id="A3.p3.1.m1.1.1.3.3.cmml" xref="A3.p3.1.m1.1.1.3.3">𝐿</ci><ci id="A3.p3.1.m1.1.1.3.4.cmml" xref="A3.p3.1.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">d_{LLM}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT</annotation></semantics></math> is the dimensionality of hidden states, <math alttext="\odot" class="ltx_Math" display="inline" id="A3.p3.2.m2.1"><semantics id="A3.p3.2.m2.1a"><mo id="A3.p3.2.m2.1.1" xref="A3.p3.2.m2.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="A3.p3.2.m2.1b"><csymbol cd="latexml" id="A3.p3.2.m2.1.1.cmml" xref="A3.p3.2.m2.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="A3.p3.2.m2.1d">⊙</annotation></semantics></math> indicates element-wise product, and <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="A3.p3.3.m3.1"><semantics id="A3.p3.3.m3.1a"><mi id="A3.p3.3.m3.1.1" xref="A3.p3.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="A3.p3.3.m3.1b"><ci id="A3.p3.3.m3.1.1.cmml" xref="A3.p3.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.3.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.3.m3.1d">bold_W</annotation></semantics></math> and <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="A3.p3.4.m4.1"><semantics id="A3.p3.4.m4.1a"><mi id="A3.p3.4.m4.1.1" xref="A3.p3.4.m4.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="A3.p3.4.m4.1b"><ci id="A3.p3.4.m4.1.1.cmml" xref="A3.p3.4.m4.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.4.m4.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.4.m4.1d">bold_B</annotation></semantics></math> are learnable weights.
Note that, in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS3.SSS3" title="2.3.3. Dynamic Adaptive Mixture-of-Experts ‣ 2.3. Incorporate Intra-Item Relation and Long-Term Collaborative Knowledge ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.3.3</span></a>, we use <math alttext="\text{Self-Attention}(\mathbf{h},\textbf{MASK})" class="ltx_Math" display="inline" id="A3.p3.5.m5.2"><semantics id="A3.p3.5.m5.2a"><mrow id="A3.p3.5.m5.2.3" xref="A3.p3.5.m5.2.3.cmml"><mtext id="A3.p3.5.m5.2.3.2" xref="A3.p3.5.m5.2.3.2a.cmml">Self-Attention</mtext><mo id="A3.p3.5.m5.2.3.1" xref="A3.p3.5.m5.2.3.1.cmml">⁢</mo><mrow id="A3.p3.5.m5.2.3.3.2" xref="A3.p3.5.m5.2.3.3.1.cmml"><mo id="A3.p3.5.m5.2.3.3.2.1" stretchy="false" xref="A3.p3.5.m5.2.3.3.1.cmml">(</mo><mi id="A3.p3.5.m5.1.1" xref="A3.p3.5.m5.1.1.cmml">𝐡</mi><mo id="A3.p3.5.m5.2.3.3.2.2" xref="A3.p3.5.m5.2.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="A3.p3.5.m5.2.2" xref="A3.p3.5.m5.2.2a.cmml">MASK</mtext><mo id="A3.p3.5.m5.2.3.3.2.3" stretchy="false" xref="A3.p3.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.5.m5.2b"><apply id="A3.p3.5.m5.2.3.cmml" xref="A3.p3.5.m5.2.3"><times id="A3.p3.5.m5.2.3.1.cmml" xref="A3.p3.5.m5.2.3.1"></times><ci id="A3.p3.5.m5.2.3.2a.cmml" xref="A3.p3.5.m5.2.3.2"><mtext id="A3.p3.5.m5.2.3.2.cmml" xref="A3.p3.5.m5.2.3.2">Self-Attention</mtext></ci><interval closure="open" id="A3.p3.5.m5.2.3.3.1.cmml" xref="A3.p3.5.m5.2.3.3.2"><ci id="A3.p3.5.m5.1.1.cmml" xref="A3.p3.5.m5.1.1">𝐡</ci><ci id="A3.p3.5.m5.2.2a.cmml" xref="A3.p3.5.m5.2.2"><mtext class="ltx_mathvariant_bold" id="A3.p3.5.m5.2.2.cmml" xref="A3.p3.5.m5.2.2">MASK</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.5.m5.2c">\text{Self-Attention}(\mathbf{h},\textbf{MASK})</annotation><annotation encoding="application/x-llamapun" id="A3.p3.5.m5.2d">Self-Attention ( bold_h , MASK )</annotation></semantics></math> for illustration where <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="A3.p3.6.m6.1"><semantics id="A3.p3.6.m6.1a"><mi id="A3.p3.6.m6.1.1" xref="A3.p3.6.m6.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="A3.p3.6.m6.1b"><ci id="A3.p3.6.m6.1.1.cmml" xref="A3.p3.6.m6.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.6.m6.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="A3.p3.6.m6.1d">bold_h</annotation></semantics></math> is the hidden state of a token, but its definition is similar.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Demonstration of Serial Adapter and Parallel Adapter</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A4.F14" title="Figure 14 ‣ Appendix D Demonstration of Serial Adapter and Parallel Adapter ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">14</span></a> visualizes the designs of serial adapter and parallel adapter.</p>
</div>
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F14"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="385" id="A4.1.g1" src="x14.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 14. </span>Two Masking Mechanisms for Semantic Alignment.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Bayesian Optimization with Reparameterization</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">Alg. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#alg1" title="Algorithm 1 ‣ Appendix E Bayesian Optimization with Reparameterization ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates how <span class="ltx_text ltx_font_smallcaps" id="A5.p1.1.1">MixRec</span> adopts Bayesian optimization with reparameterization to search for suitable architecture for DAMoE.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> BO with Reparameterization</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>Input: objective <math alttext="f:\text{\sout{$Z$}}\to\mathbb{R}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.2" xref="alg1.l1.m1.1.2.cmml"><mi id="alg1.l1.m1.1.2.2" xref="alg1.l1.m1.1.2.2.cmml">f</mi><mo id="alg1.l1.m1.1.2.1" lspace="0.278em" rspace="0.278em" xref="alg1.l1.m1.1.2.1.cmml">:</mo><mrow id="alg1.l1.m1.1.2.3" xref="alg1.l1.m1.1.2.3.cmml"><mi class="ltx_ulem_sout" id="alg1.l1.m1.1.2.3.2" xref="alg1.l1.m1.1.2.3.2.cmml">Z</mi><mo id="alg1.l1.m1.1.2.3.1" stretchy="false" xref="alg1.l1.m1.1.2.3.1.cmml">→</mo><mi id="alg1.l1.m1.1.2.3.3" xref="alg1.l1.m1.1.2.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.2.cmml" xref="alg1.l1.m1.1.2"><ci id="alg1.l1.m1.1.2.1.cmml" xref="alg1.l1.m1.1.2.1">:</ci><ci id="alg1.l1.m1.1.2.2.cmml" xref="alg1.l1.m1.1.2.2">𝑓</ci><apply id="alg1.l1.m1.1.2.3.cmml" xref="alg1.l1.m1.1.2.3"><ci id="alg1.l1.m1.1.2.3.1.cmml" xref="alg1.l1.m1.1.2.3.1">→</ci><ci id="alg1.l1.m1.1.2.3.2.cmml" xref="alg1.l1.m1.1.2.3.2">𝑍</ci><ci id="alg1.l1.m1.1.2.3.3.cmml" xref="alg1.l1.m1.1.2.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">f:\text{\sout{$Z$}}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_f : italic_Z → blackboard_R</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>Initialize <math alttext="\mathcal{D}_{0}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">𝒟</mi><mn id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">0</mn></msub><mo id="alg1.l2.m1.1.1.1" stretchy="false" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mi id="alg1.l2.m1.1.1.3" mathvariant="normal" xref="alg1.l2.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝒟</ci><cn id="alg1.l2.m1.1.1.2.3.cmml" type="integer" xref="alg1.l2.m1.1.1.2.3">0</cn></apply><emptyset id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{D}_{0}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">caligraphic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← ∅</annotation></semantics></math>, <math alttext="\textbf{GP}_{0}\leftarrow\textbf{GP}(\textbf{0},k)" class="ltx_Math" display="inline" id="alg1.l2.m2.2"><semantics id="alg1.l2.m2.2a"><mrow id="alg1.l2.m2.2.3" xref="alg1.l2.m2.2.3.cmml"><msub id="alg1.l2.m2.2.3.2" xref="alg1.l2.m2.2.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l2.m2.2.3.2.2" xref="alg1.l2.m2.2.3.2.2a.cmml">GP</mtext><mn id="alg1.l2.m2.2.3.2.3" xref="alg1.l2.m2.2.3.2.3.cmml">0</mn></msub><mo id="alg1.l2.m2.2.3.1" stretchy="false" xref="alg1.l2.m2.2.3.1.cmml">←</mo><mrow id="alg1.l2.m2.2.3.3" xref="alg1.l2.m2.2.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l2.m2.2.3.3.2" xref="alg1.l2.m2.2.3.3.2a.cmml">GP</mtext><mo id="alg1.l2.m2.2.3.3.1" xref="alg1.l2.m2.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l2.m2.2.3.3.3.2" xref="alg1.l2.m2.2.3.3.3.1.cmml"><mo id="alg1.l2.m2.2.3.3.3.2.1" stretchy="false" xref="alg1.l2.m2.2.3.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1a.cmml">0</mtext><mo id="alg1.l2.m2.2.3.3.3.2.2" xref="alg1.l2.m2.2.3.3.3.1.cmml">,</mo><mi id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml">k</mi><mo id="alg1.l2.m2.2.3.3.3.2.3" stretchy="false" xref="alg1.l2.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.2b"><apply id="alg1.l2.m2.2.3.cmml" xref="alg1.l2.m2.2.3"><ci id="alg1.l2.m2.2.3.1.cmml" xref="alg1.l2.m2.2.3.1">←</ci><apply id="alg1.l2.m2.2.3.2.cmml" xref="alg1.l2.m2.2.3.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.3.2.1.cmml" xref="alg1.l2.m2.2.3.2">subscript</csymbol><ci id="alg1.l2.m2.2.3.2.2a.cmml" xref="alg1.l2.m2.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l2.m2.2.3.2.2.cmml" xref="alg1.l2.m2.2.3.2.2">GP</mtext></ci><cn id="alg1.l2.m2.2.3.2.3.cmml" type="integer" xref="alg1.l2.m2.2.3.2.3">0</cn></apply><apply id="alg1.l2.m2.2.3.3.cmml" xref="alg1.l2.m2.2.3.3"><times id="alg1.l2.m2.2.3.3.1.cmml" xref="alg1.l2.m2.2.3.3.1"></times><ci id="alg1.l2.m2.2.3.3.2a.cmml" xref="alg1.l2.m2.2.3.3.2"><mtext class="ltx_mathvariant_bold" id="alg1.l2.m2.2.3.3.2.cmml" xref="alg1.l2.m2.2.3.3.2">GP</mtext></ci><interval closure="open" id="alg1.l2.m2.2.3.3.3.1.cmml" xref="alg1.l2.m2.2.3.3.3.2"><ci id="alg1.l2.m2.1.1a.cmml" xref="alg1.l2.m2.1.1"><mtext class="ltx_mathvariant_bold" id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">0</mtext></ci><ci id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2">𝑘</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.2c">\textbf{GP}_{0}\leftarrow\textbf{GP}(\textbf{0},k)</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.2d">GP start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← GP ( 0 , italic_k )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2">for</span> <math alttext="n=1" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">n</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑛</ci><cn id="alg1.l3.m1.1.1.3.cmml" type="integer" xref="alg1.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">n=1</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_n = 1</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.3">to</span> <math alttext="N_{\text{iterations}}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><msub id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">N</mi><mtext id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3a.cmml">iterations</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝑁</ci><ci id="alg1.l3.m2.1.1.3a.cmml" xref="alg1.l3.m2.1.1.3"><mtext id="alg1.l3.m2.1.1.3.cmml" mathsize="70%" xref="alg1.l3.m2.1.1.3">iterations</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">N_{\text{iterations}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_N start_POSTSUBSCRIPT iterations end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l3.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>     <math alttext="(\bm{\theta}_{n})\leftarrow\arg\max_{(\bm{\theta})\in\Theta}\mathbb{E}_{\bm{Z}%
\sim p(\bm{Z}|\bm{\theta})}[\alpha(\bm{Z})]" class="ltx_Math" display="inline" id="alg1.l4.m1.5"><semantics id="alg1.l4.m1.5a"><mrow id="alg1.l4.m1.5.5" xref="alg1.l4.m1.5.5.cmml"><mrow id="alg1.l4.m1.4.4.1.1" xref="alg1.l4.m1.4.4.1.1.1.cmml"><mo id="alg1.l4.m1.4.4.1.1.2" stretchy="false" xref="alg1.l4.m1.4.4.1.1.1.cmml">(</mo><msub id="alg1.l4.m1.4.4.1.1.1" xref="alg1.l4.m1.4.4.1.1.1.cmml"><mi id="alg1.l4.m1.4.4.1.1.1.2" xref="alg1.l4.m1.4.4.1.1.1.2.cmml">𝜽</mi><mi id="alg1.l4.m1.4.4.1.1.1.3" xref="alg1.l4.m1.4.4.1.1.1.3.cmml">n</mi></msub><mo id="alg1.l4.m1.4.4.1.1.3" stretchy="false" xref="alg1.l4.m1.4.4.1.1.1.cmml">)</mo></mrow><mo id="alg1.l4.m1.5.5.3" stretchy="false" xref="alg1.l4.m1.5.5.3.cmml">←</mo><mrow id="alg1.l4.m1.5.5.2" xref="alg1.l4.m1.5.5.2.cmml"><mrow id="alg1.l4.m1.5.5.2.3" xref="alg1.l4.m1.5.5.2.3.cmml"><mi id="alg1.l4.m1.5.5.2.3.1" xref="alg1.l4.m1.5.5.2.3.1.cmml">arg</mi><mo id="alg1.l4.m1.5.5.2.3a" lspace="0.167em" xref="alg1.l4.m1.5.5.2.3.cmml">⁡</mo><mrow id="alg1.l4.m1.5.5.2.3.2" xref="alg1.l4.m1.5.5.2.3.2.cmml"><msub id="alg1.l4.m1.5.5.2.3.2.1" xref="alg1.l4.m1.5.5.2.3.2.1.cmml"><mi id="alg1.l4.m1.5.5.2.3.2.1.2" xref="alg1.l4.m1.5.5.2.3.2.1.2.cmml">max</mi><mrow id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.1.3.2" xref="alg1.l4.m1.1.1.1.cmml"><mo id="alg1.l4.m1.1.1.1.3.2.1" stretchy="false" xref="alg1.l4.m1.1.1.1.cmml">(</mo><mi id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">𝜽</mi><mo id="alg1.l4.m1.1.1.1.3.2.2" stretchy="false" xref="alg1.l4.m1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l4.m1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.cmml">∈</mo><mi id="alg1.l4.m1.1.1.1.4" mathvariant="normal" xref="alg1.l4.m1.1.1.1.4.cmml">Θ</mi></mrow></msub><mo id="alg1.l4.m1.5.5.2.3.2a" lspace="0.167em" xref="alg1.l4.m1.5.5.2.3.2.cmml">⁡</mo><msub id="alg1.l4.m1.5.5.2.3.2.2" xref="alg1.l4.m1.5.5.2.3.2.2.cmml"><mi id="alg1.l4.m1.5.5.2.3.2.2.2" xref="alg1.l4.m1.5.5.2.3.2.2.2.cmml">𝔼</mi><mrow id="alg1.l4.m1.2.2.1" xref="alg1.l4.m1.2.2.1.cmml"><mi id="alg1.l4.m1.2.2.1.3" xref="alg1.l4.m1.2.2.1.3.cmml">𝒁</mi><mo id="alg1.l4.m1.2.2.1.2" xref="alg1.l4.m1.2.2.1.2.cmml">∼</mo><mrow id="alg1.l4.m1.2.2.1.1" xref="alg1.l4.m1.2.2.1.1.cmml"><mi id="alg1.l4.m1.2.2.1.1.3" xref="alg1.l4.m1.2.2.1.1.3.cmml">p</mi><mo id="alg1.l4.m1.2.2.1.1.2" xref="alg1.l4.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.2.2.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.2.2.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.2.2.1.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.2.2.1.1.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.1.1.2.cmml">𝒁</mi><mo fence="false" id="alg1.l4.m1.2.2.1.1.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="alg1.l4.m1.2.2.1.1.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="alg1.l4.m1.2.2.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow></mrow><mo id="alg1.l4.m1.5.5.2.2" xref="alg1.l4.m1.5.5.2.2.cmml">⁢</mo><mrow id="alg1.l4.m1.5.5.2.1.1" xref="alg1.l4.m1.5.5.2.1.2.cmml"><mo id="alg1.l4.m1.5.5.2.1.1.2" stretchy="false" xref="alg1.l4.m1.5.5.2.1.2.1.cmml">[</mo><mrow id="alg1.l4.m1.5.5.2.1.1.1" xref="alg1.l4.m1.5.5.2.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.2.1.1.1.2" xref="alg1.l4.m1.5.5.2.1.1.1.2.cmml">α</mi><mo id="alg1.l4.m1.5.5.2.1.1.1.1" xref="alg1.l4.m1.5.5.2.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l4.m1.5.5.2.1.1.1.3.2" xref="alg1.l4.m1.5.5.2.1.1.1.cmml"><mo id="alg1.l4.m1.5.5.2.1.1.1.3.2.1" stretchy="false" xref="alg1.l4.m1.5.5.2.1.1.1.cmml">(</mo><mi id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">𝒁</mi><mo id="alg1.l4.m1.5.5.2.1.1.1.3.2.2" stretchy="false" xref="alg1.l4.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l4.m1.5.5.2.1.1.3" stretchy="false" xref="alg1.l4.m1.5.5.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.5b"><apply id="alg1.l4.m1.5.5.cmml" xref="alg1.l4.m1.5.5"><ci id="alg1.l4.m1.5.5.3.cmml" xref="alg1.l4.m1.5.5.3">←</ci><apply id="alg1.l4.m1.4.4.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.4.4.1.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1">subscript</csymbol><ci id="alg1.l4.m1.4.4.1.1.1.2.cmml" xref="alg1.l4.m1.4.4.1.1.1.2">𝜽</ci><ci id="alg1.l4.m1.4.4.1.1.1.3.cmml" xref="alg1.l4.m1.4.4.1.1.1.3">𝑛</ci></apply><apply id="alg1.l4.m1.5.5.2.cmml" xref="alg1.l4.m1.5.5.2"><times id="alg1.l4.m1.5.5.2.2.cmml" xref="alg1.l4.m1.5.5.2.2"></times><apply id="alg1.l4.m1.5.5.2.3.cmml" xref="alg1.l4.m1.5.5.2.3"><arg id="alg1.l4.m1.5.5.2.3.1.cmml" xref="alg1.l4.m1.5.5.2.3.1"></arg><apply id="alg1.l4.m1.5.5.2.3.2.cmml" xref="alg1.l4.m1.5.5.2.3.2"><apply id="alg1.l4.m1.5.5.2.3.2.1.cmml" xref="alg1.l4.m1.5.5.2.3.2.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.2.3.2.1.1.cmml" xref="alg1.l4.m1.5.5.2.3.2.1">subscript</csymbol><max id="alg1.l4.m1.5.5.2.3.2.1.2.cmml" xref="alg1.l4.m1.5.5.2.3.2.1.2"></max><apply id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"><in id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.2"></in><ci id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">𝜽</ci><ci id="alg1.l4.m1.1.1.1.4.cmml" xref="alg1.l4.m1.1.1.1.4">Θ</ci></apply></apply><apply id="alg1.l4.m1.5.5.2.3.2.2.cmml" xref="alg1.l4.m1.5.5.2.3.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.2.3.2.2.1.cmml" xref="alg1.l4.m1.5.5.2.3.2.2">subscript</csymbol><ci id="alg1.l4.m1.5.5.2.3.2.2.2.cmml" xref="alg1.l4.m1.5.5.2.3.2.2.2">𝔼</ci><apply id="alg1.l4.m1.2.2.1.cmml" xref="alg1.l4.m1.2.2.1"><csymbol cd="latexml" id="alg1.l4.m1.2.2.1.2.cmml" xref="alg1.l4.m1.2.2.1.2">similar-to</csymbol><ci id="alg1.l4.m1.2.2.1.3.cmml" xref="alg1.l4.m1.2.2.1.3">𝒁</ci><apply id="alg1.l4.m1.2.2.1.1.cmml" xref="alg1.l4.m1.2.2.1.1"><times id="alg1.l4.m1.2.2.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.2"></times><ci id="alg1.l4.m1.2.2.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.3">𝑝</ci><apply id="alg1.l4.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="alg1.l4.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="alg1.l4.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.2">𝒁</ci><ci id="alg1.l4.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply></apply></apply><apply id="alg1.l4.m1.5.5.2.1.2.cmml" xref="alg1.l4.m1.5.5.2.1.1"><csymbol cd="latexml" id="alg1.l4.m1.5.5.2.1.2.1.cmml" xref="alg1.l4.m1.5.5.2.1.1.2">delimited-[]</csymbol><apply id="alg1.l4.m1.5.5.2.1.1.1.cmml" xref="alg1.l4.m1.5.5.2.1.1.1"><times id="alg1.l4.m1.5.5.2.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.2.1.1.1.1"></times><ci id="alg1.l4.m1.5.5.2.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.2.1.1.1.2">𝛼</ci><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">𝒁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.5c">(\bm{\theta}_{n})\leftarrow\arg\max_{(\bm{\theta})\in\Theta}\mathbb{E}_{\bm{Z}%
\sim p(\bm{Z}|\bm{\theta})}[\alpha(\bm{Z})]</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.5d">( bold_italic_θ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) ← roman_arg roman_max start_POSTSUBSCRIPT ( bold_italic_θ ) ∈ roman_Θ end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT bold_italic_Z ∼ italic_p ( bold_italic_Z | bold_italic_θ ) end_POSTSUBSCRIPT [ italic_α ( bold_italic_Z ) ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     Sample <math alttext="\mathbf{z}_{n}\sim p(\bm{Z}|\bm{\theta}_{n})" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">𝐳</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">n</mi></msub><mo id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml">p</mi><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">𝒁</mi><mo fence="false" id="alg1.l5.m1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.3.2" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.cmml">𝜽</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.3.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.3.cmml">n</mi></msub></mrow><mo id="alg1.l5.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">similar-to</csymbol><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝐳</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑛</ci></apply><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">𝑝</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">𝒁</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.2">𝜽</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathbf{z}_{n}\sim p(\bm{Z}|\bm{\theta}_{n})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">bold_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∼ italic_p ( bold_italic_Z | bold_italic_θ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     Evaluate <math alttext="f(\mathbf{z}_{n})" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">f</mi><mo id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mo id="alg1.l6.m1.1.1.1.1.2" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.l6.m1.1.1.1.1.3" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><times id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"></times><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑓</ci><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">𝐳</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">f(\mathbf{z}_{n})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_f ( bold_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>     <math alttext="\mathcal{D}_{n}\leftarrow\mathcal{D}_{n-1}\cup\{(\bm{z}_{n},f(\bm{z}_{n}))\}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">𝒟</mi><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">n</mi></msub><mo id="alg1.l7.m1.1.1.2" stretchy="false" xref="alg1.l7.m1.1.1.2.cmml">←</mo><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><msub id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.3.2.cmml">𝒟</mi><mrow id="alg1.l7.m1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.3.3.cmml"><mi id="alg1.l7.m1.1.1.1.3.3.2" xref="alg1.l7.m1.1.1.1.3.3.2.cmml">n</mi><mo id="alg1.l7.m1.1.1.1.3.3.1" xref="alg1.l7.m1.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l7.m1.1.1.1.3.3.3" xref="alg1.l7.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">∪</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.2.cmml"><mo id="alg1.l7.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l7.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml"><mo id="alg1.l7.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l7.m1.1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="alg1.l7.m1.1.1.1.1.1.1.2.4" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">,</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.cmml">f</mi><mo id="alg1.l7.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.cmml"><mo id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.2.cmml">𝒛</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.3.cmml">n</mi></msub><mo id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l7.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l7.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">←</ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝒟</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑛</ci></apply><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><union id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></union><apply id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.3.2">𝒟</ci><apply id="alg1.l7.m1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.3.3"><minus id="alg1.l7.m1.1.1.1.3.3.1.cmml" xref="alg1.l7.m1.1.1.1.3.3.1"></minus><ci id="alg1.l7.m1.1.1.1.3.3.2.cmml" xref="alg1.l7.m1.1.1.1.3.3.2">𝑛</ci><cn id="alg1.l7.m1.1.1.1.3.3.3.cmml" type="integer" xref="alg1.l7.m1.1.1.1.3.3.3">1</cn></apply></apply><set id="alg1.l7.m1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1"><interval closure="open" id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2"><apply id="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.2">𝒛</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2"><times id="alg1.l7.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.2"></times><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3">𝑓</ci><apply id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.2">𝒛</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.1.1.1.3">𝑛</ci></apply></apply></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathcal{D}_{n}\leftarrow\mathcal{D}_{n-1}\cup\{(\bm{z}_{n},f(\bm{z}_{n}))\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ← caligraphic_D start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT ∪ { ( bold_italic_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , italic_f ( bold_italic_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     Update posterior <math alttext="\textbf{GP}_{n}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2a.cmml">GP</mtext><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2a.cmml" xref="alg1.l8.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">GP</mtext></ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\textbf{GP}_{n}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">GP start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> given <math alttext="\mathcal{D}_{n}" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><msub id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">𝒟</mi><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">𝒟</ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\mathcal{D}_{n}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l9.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.3">for</span>
</div>
</div>
</figure>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Hyper-Parameters for Different Datasets</h2>
<figure class="ltx_table" id="A6.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Hyper-Parameters for different datasets.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A6.T3.6" style="width:287.8pt;height:194.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-16.0pt,10.8pt) scale(0.9,0.9) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A6.T3.6.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T3.6.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A6.T3.6.6.7.1.1"><span class="ltx_text ltx_font_bold" id="A6.T3.6.6.7.1.1.1">Parameter</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T3.6.6.7.1.2">Arts</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T3.6.6.7.1.3">Scientific</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T3.6.6.7.1.4">Instruments</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T3.6.6.7.1.5">Pantry</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T3.6.6.7.1.6">Games</td>
</tr>
<tr class="ltx_tr" id="A6.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.1.1.1.1"><math alttext="n_{s}" class="ltx_Math" display="inline" id="A6.T3.1.1.1.1.m1.1"><semantics id="A6.T3.1.1.1.1.m1.1a"><msub id="A6.T3.1.1.1.1.m1.1.1" xref="A6.T3.1.1.1.1.m1.1.1.cmml"><mi id="A6.T3.1.1.1.1.m1.1.1.2" xref="A6.T3.1.1.1.1.m1.1.1.2.cmml">n</mi><mi id="A6.T3.1.1.1.1.m1.1.1.3" xref="A6.T3.1.1.1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A6.T3.1.1.1.1.m1.1b"><apply id="A6.T3.1.1.1.1.m1.1.1.cmml" xref="A6.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A6.T3.1.1.1.1.m1.1.1.1.cmml" xref="A6.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="A6.T3.1.1.1.1.m1.1.1.2.cmml" xref="A6.T3.1.1.1.1.m1.1.1.2">𝑛</ci><ci id="A6.T3.1.1.1.1.m1.1.1.3.cmml" xref="A6.T3.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T3.1.1.1.1.m1.1c">n_{s}</annotation><annotation encoding="application/x-llamapun" id="A6.T3.1.1.1.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="5" id="A6.T3.1.1.1.2">1</td>
</tr>
<tr class="ltx_tr" id="A6.T3.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.2.2.2.1"><math alttext="n_{cl}" class="ltx_Math" display="inline" id="A6.T3.2.2.2.1.m1.1"><semantics id="A6.T3.2.2.2.1.m1.1a"><msub id="A6.T3.2.2.2.1.m1.1.1" xref="A6.T3.2.2.2.1.m1.1.1.cmml"><mi id="A6.T3.2.2.2.1.m1.1.1.2" xref="A6.T3.2.2.2.1.m1.1.1.2.cmml">n</mi><mrow id="A6.T3.2.2.2.1.m1.1.1.3" xref="A6.T3.2.2.2.1.m1.1.1.3.cmml"><mi id="A6.T3.2.2.2.1.m1.1.1.3.2" xref="A6.T3.2.2.2.1.m1.1.1.3.2.cmml">c</mi><mo id="A6.T3.2.2.2.1.m1.1.1.3.1" xref="A6.T3.2.2.2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A6.T3.2.2.2.1.m1.1.1.3.3" xref="A6.T3.2.2.2.1.m1.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A6.T3.2.2.2.1.m1.1b"><apply id="A6.T3.2.2.2.1.m1.1.1.cmml" xref="A6.T3.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="A6.T3.2.2.2.1.m1.1.1.1.cmml" xref="A6.T3.2.2.2.1.m1.1.1">subscript</csymbol><ci id="A6.T3.2.2.2.1.m1.1.1.2.cmml" xref="A6.T3.2.2.2.1.m1.1.1.2">𝑛</ci><apply id="A6.T3.2.2.2.1.m1.1.1.3.cmml" xref="A6.T3.2.2.2.1.m1.1.1.3"><times id="A6.T3.2.2.2.1.m1.1.1.3.1.cmml" xref="A6.T3.2.2.2.1.m1.1.1.3.1"></times><ci id="A6.T3.2.2.2.1.m1.1.1.3.2.cmml" xref="A6.T3.2.2.2.1.m1.1.1.3.2">𝑐</ci><ci id="A6.T3.2.2.2.1.m1.1.1.3.3.cmml" xref="A6.T3.2.2.2.1.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T3.2.2.2.1.m1.1c">n_{cl}</annotation><annotation encoding="application/x-llamapun" id="A6.T3.2.2.2.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_c italic_l end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="5" id="A6.T3.2.2.2.2">5</td>
</tr>
<tr class="ltx_tr" id="A6.T3.6.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.6.6.8.2.1">Epochs</th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="5" id="A6.T3.6.6.8.2.2">40</td>
</tr>
<tr class="ltx_tr" id="A6.T3.6.6.9.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.6.6.9.3.1">Learning Rate</th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="5" id="A6.T3.6.6.9.3.2">5e-5</td>
</tr>
<tr class="ltx_tr" id="A6.T3.6.6.10.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.6.6.10.4.1">LR Scheduler</th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="5" id="A6.T3.6.6.10.4.2">Cosine Scheduler</td>
</tr>
<tr class="ltx_tr" id="A6.T3.6.6.11.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.6.6.11.5.1">Bottleneck Size</th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="5" id="A6.T3.6.6.11.5.2">64</td>
</tr>
<tr class="ltx_tr" id="A6.T3.6.6.12.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.6.6.12.6.1">Batch Size</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.6.6.12.6.2">5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.6.6.12.6.3">6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.6.6.12.6.4">7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.6.6.12.6.5">8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.6.6.12.6.6">8</td>
</tr>
<tr class="ltx_tr" id="A6.T3.3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.3.3.3.1"><math alttext="b\%" class="ltx_Math" display="inline" id="A6.T3.3.3.3.1.m1.1"><semantics id="A6.T3.3.3.3.1.m1.1a"><mrow id="A6.T3.3.3.3.1.m1.1.1" xref="A6.T3.3.3.3.1.m1.1.1.cmml"><mi id="A6.T3.3.3.3.1.m1.1.1.2" xref="A6.T3.3.3.3.1.m1.1.1.2.cmml">b</mi><mo id="A6.T3.3.3.3.1.m1.1.1.1" xref="A6.T3.3.3.3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.T3.3.3.3.1.m1.1b"><apply id="A6.T3.3.3.3.1.m1.1.1.cmml" xref="A6.T3.3.3.3.1.m1.1.1"><csymbol cd="latexml" id="A6.T3.3.3.3.1.m1.1.1.1.cmml" xref="A6.T3.3.3.3.1.m1.1.1.1">percent</csymbol><ci id="A6.T3.3.3.3.1.m1.1.1.2.cmml" xref="A6.T3.3.3.3.1.m1.1.1.2">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T3.3.3.3.1.m1.1c">b\%</annotation><annotation encoding="application/x-llamapun" id="A6.T3.3.3.3.1.m1.1d">italic_b %</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.3.3.3.2">0.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.3.3.3.3">0.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.3.3.3.4">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.3.3.3.5">0.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.3.3.3.6">0.06</td>
</tr>
<tr class="ltx_tr" id="A6.T3.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.4.4.4.1"><math alttext="{\lambda}_{1}" class="ltx_Math" display="inline" id="A6.T3.4.4.4.1.m1.1"><semantics id="A6.T3.4.4.4.1.m1.1a"><msub id="A6.T3.4.4.4.1.m1.1.1" xref="A6.T3.4.4.4.1.m1.1.1.cmml"><mi id="A6.T3.4.4.4.1.m1.1.1.2" xref="A6.T3.4.4.4.1.m1.1.1.2.cmml">λ</mi><mn id="A6.T3.4.4.4.1.m1.1.1.3" xref="A6.T3.4.4.4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A6.T3.4.4.4.1.m1.1b"><apply id="A6.T3.4.4.4.1.m1.1.1.cmml" xref="A6.T3.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="A6.T3.4.4.4.1.m1.1.1.1.cmml" xref="A6.T3.4.4.4.1.m1.1.1">subscript</csymbol><ci id="A6.T3.4.4.4.1.m1.1.1.2.cmml" xref="A6.T3.4.4.4.1.m1.1.1.2">𝜆</ci><cn id="A6.T3.4.4.4.1.m1.1.1.3.cmml" type="integer" xref="A6.T3.4.4.4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T3.4.4.4.1.m1.1c">{\lambda}_{1}</annotation><annotation encoding="application/x-llamapun" id="A6.T3.4.4.4.1.m1.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.4.4.4.2">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.4.4.4.3">0.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.4.4.4.4">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.4.4.4.5">0.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.4.4.4.6">0.05</td>
</tr>
<tr class="ltx_tr" id="A6.T3.5.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A6.T3.5.5.5.1"><math alttext="{\lambda}_{2}" class="ltx_Math" display="inline" id="A6.T3.5.5.5.1.m1.1"><semantics id="A6.T3.5.5.5.1.m1.1a"><msub id="A6.T3.5.5.5.1.m1.1.1" xref="A6.T3.5.5.5.1.m1.1.1.cmml"><mi id="A6.T3.5.5.5.1.m1.1.1.2" xref="A6.T3.5.5.5.1.m1.1.1.2.cmml">λ</mi><mn id="A6.T3.5.5.5.1.m1.1.1.3" xref="A6.T3.5.5.5.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A6.T3.5.5.5.1.m1.1b"><apply id="A6.T3.5.5.5.1.m1.1.1.cmml" xref="A6.T3.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="A6.T3.5.5.5.1.m1.1.1.1.cmml" xref="A6.T3.5.5.5.1.m1.1.1">subscript</csymbol><ci id="A6.T3.5.5.5.1.m1.1.1.2.cmml" xref="A6.T3.5.5.5.1.m1.1.1.2">𝜆</ci><cn id="A6.T3.5.5.5.1.m1.1.1.3.cmml" type="integer" xref="A6.T3.5.5.5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T3.5.5.5.1.m1.1c">{\lambda}_{2}</annotation><annotation encoding="application/x-llamapun" id="A6.T3.5.5.5.1.m1.1d">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.5.5.5.2">1e-6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.5.5.5.3">1e-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.5.5.5.4">1e-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.5.5.5.5">1e-6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T3.5.5.5.6">1e-3</td>
</tr>
<tr class="ltx_tr" id="A6.T3.6.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="A6.T3.6.6.6.1"><math alttext="{\lambda}_{3}" class="ltx_Math" display="inline" id="A6.T3.6.6.6.1.m1.1"><semantics id="A6.T3.6.6.6.1.m1.1a"><msub id="A6.T3.6.6.6.1.m1.1.1" xref="A6.T3.6.6.6.1.m1.1.1.cmml"><mi id="A6.T3.6.6.6.1.m1.1.1.2" xref="A6.T3.6.6.6.1.m1.1.1.2.cmml">λ</mi><mn id="A6.T3.6.6.6.1.m1.1.1.3" xref="A6.T3.6.6.6.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="A6.T3.6.6.6.1.m1.1b"><apply id="A6.T3.6.6.6.1.m1.1.1.cmml" xref="A6.T3.6.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="A6.T3.6.6.6.1.m1.1.1.1.cmml" xref="A6.T3.6.6.6.1.m1.1.1">subscript</csymbol><ci id="A6.T3.6.6.6.1.m1.1.1.2.cmml" xref="A6.T3.6.6.6.1.m1.1.1.2">𝜆</ci><cn id="A6.T3.6.6.6.1.m1.1.1.3.cmml" type="integer" xref="A6.T3.6.6.6.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T3.6.6.6.1.m1.1c">{\lambda}_{3}</annotation><annotation encoding="application/x-llamapun" id="A6.T3.6.6.6.1.m1.1d">italic_λ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T3.6.6.6.2">0.001</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T3.6.6.6.3">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T3.6.6.6.4">0.05</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T3.6.6.6.5">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T3.6.6.6.6">0.01</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="A6.p1">
<p class="ltx_p" id="A6.p1.1">We perform a grid search to find optimal hyper-parameters for <span class="ltx_text ltx_font_smallcaps" id="A6.p1.1.1">MixRec</span> on different datasets.
We report them in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#A6.T3" title="Table 3 ‣ Appendix F Hyper-Parameters for Different Datasets ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Baselines</h2>
<div class="ltx_para" id="A7.p1">
<p class="ltx_p" id="A7.p1.1">We use the following baselines in our experiments:</p>
</div>
<div class="ltx_para ltx_noindent" id="A7.p2">
<p class="ltx_p" id="A7.p2.1"><span class="ltx_text ltx_font_bold" id="A7.p2.1.1">(1) Traditional SRS:</span></p>
<ul class="ltx_itemize" id="A7.I1">
<li class="ltx_item" id="A7.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i1.p1">
<p class="ltx_p" id="A7.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A7.I1.i1.p1.1.1">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib19" title="">2016</a>)</cite> leverages gated recurrent units (GRU) to model user behavior sequences, effectively capturing historical interactions to construct comprehensive user profiles. Each user’s sequence is treated as a session.</p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i2.p1">
<p class="ltx_p" id="A7.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A7.I1.i2.p1.1.1">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib26" title="">2018</a>)</cite> employs a directional self-attention mechanism to process item embeddings sequentially, aggregating past user interactions to predict future interests.</p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i3.p1">
<p class="ltx_p" id="A7.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A7.I1.i3.p1.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib44" title="">2019</a>)</cite> utilizes a bidirectional self-attention model with a cloze task to model user behavior sequences.</p>
</div>
</li>
<li class="ltx_item" id="A7.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I1.i4.p1">
<p class="ltx_p" id="A7.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A7.I1.i4.p1.1.1">FDSA</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib58" title="">2019</a>)</cite> integrates two self-attention blocks that process both item-level and feature-level sequences, merging their outputs to enhance the accuracy of next-item predictions.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A7.p3">
<p class="ltx_p" id="A7.p3.1"><span class="ltx_text ltx_font_bold" id="A7.p3.1.1">(2) LLM-based SRS:</span></p>
<ul class="ltx_itemize" id="A7.I2">
<li class="ltx_item" id="A7.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I2.i1.p1">
<p class="ltx_p" id="A7.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A7.I2.i1.p1.1.1">P5<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote8.1.1.1">8</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://github.com/jeykigung/P5" title="">https://github.com/jeykigung/P5</a></span></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib11" title="">2022</a>)</cite> is a unified framework that transforms all recommendation data into natural language sequences, facilitating personalized recommendations.</p>
</div>
</li>
<li class="ltx_item" id="A7.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I2.i2.p1">
<p class="ltx_p" id="A7.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A7.I2.i2.p1.1.1">UniSRec<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote9.1.1.1">9</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://github.com/RUCAIBox/UniSRec" title="">https://github.com/RUCAIBox/UniSRec</a></span></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib20" title="">2022</a>)</cite> embeds item text using a lightweight architecture based on parametric whitening and an MoE-enhanced adaptor to learn universal item representations.</p>
</div>
</li>
<li class="ltx_item" id="A7.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I2.i3.p1">
<p class="ltx_p" id="A7.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A7.I2.i3.p1.1.1">RecFormer<span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote10.1.1.1">10</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://github.com/JiachengLi1995/RecFormer" title="">https://github.com/JiachengLi1995/RecFormer</a></span></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#bib.bib29" title="">2023b</a>)</cite> relies on an encoder-only architecture, learning user preferences and item features from natural language.</p>
</div>
</li>
<li class="ltx_item" id="A7.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A7.I2.i4.p1">
<p class="ltx_p" id="A7.I2.i4.p1.2"><span class="ltx_text ltx_font_bold" id="A7.I2.i4.p1.2.2">LLMRec</span>: It removes adapter blocks from <span class="ltx_text ltx_font_smallcaps" id="A7.I2.i4.p1.1.1">MixRec<math alttext="{}_{\text{base}}" class="ltx_Math" display="inline" id="A7.I2.i4.p1.1.1.m1.1"><semantics id="A7.I2.i4.p1.1.1.m1.1a"><msub id="A7.I2.i4.p1.1.1.m1.1.1" xref="A7.I2.i4.p1.1.1.m1.1.1.cmml"><mi id="A7.I2.i4.p1.1.1.m1.1.1a" xref="A7.I2.i4.p1.1.1.m1.1.1.cmml"></mi><mtext id="A7.I2.i4.p1.1.1.m1.1.1.1" xref="A7.I2.i4.p1.1.1.m1.1.1.1a.cmml">base</mtext></msub><annotation-xml encoding="MathML-Content" id="A7.I2.i4.p1.1.1.m1.1b"><apply id="A7.I2.i4.p1.1.1.m1.1.1.cmml" xref="A7.I2.i4.p1.1.1.m1.1.1"><ci id="A7.I2.i4.p1.1.1.m1.1.1.1a.cmml" xref="A7.I2.i4.p1.1.1.m1.1.1.1"><mtext id="A7.I2.i4.p1.1.1.m1.1.1.1.cmml" mathsize="70%" xref="A7.I2.i4.p1.1.1.m1.1.1.1">base</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.I2.i4.p1.1.1.m1.1c">{}_{\text{base}}</annotation><annotation encoding="application/x-llamapun" id="A7.I2.i4.p1.1.1.m1.1d">start_FLOATSUBSCRIPT base end_FLOATSUBSCRIPT</annotation></semantics></math></span> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>) and freezes LLM during fine-tuning.
It is optimized with <math alttext="\mathcal{L}_{\text{seq}}" class="ltx_Math" display="inline" id="A7.I2.i4.p1.2.m1.1"><semantics id="A7.I2.i4.p1.2.m1.1a"><msub id="A7.I2.i4.p1.2.m1.1.1" xref="A7.I2.i4.p1.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.I2.i4.p1.2.m1.1.1.2" xref="A7.I2.i4.p1.2.m1.1.1.2.cmml">ℒ</mi><mtext id="A7.I2.i4.p1.2.m1.1.1.3" xref="A7.I2.i4.p1.2.m1.1.1.3a.cmml">seq</mtext></msub><annotation-xml encoding="MathML-Content" id="A7.I2.i4.p1.2.m1.1b"><apply id="A7.I2.i4.p1.2.m1.1.1.cmml" xref="A7.I2.i4.p1.2.m1.1.1"><csymbol cd="ambiguous" id="A7.I2.i4.p1.2.m1.1.1.1.cmml" xref="A7.I2.i4.p1.2.m1.1.1">subscript</csymbol><ci id="A7.I2.i4.p1.2.m1.1.1.2.cmml" xref="A7.I2.i4.p1.2.m1.1.1.2">ℒ</ci><ci id="A7.I2.i4.p1.2.m1.1.1.3a.cmml" xref="A7.I2.i4.p1.2.m1.1.1.3"><mtext id="A7.I2.i4.p1.2.m1.1.1.3.cmml" mathsize="70%" xref="A7.I2.i4.p1.2.m1.1.1.3">seq</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.I2.i4.p1.2.m1.1c">\mathcal{L}_{\text{seq}}</annotation><annotation encoding="application/x-llamapun" id="A7.I2.i4.p1.2.m1.1d">caligraphic_L start_POSTSUBSCRIPT seq end_POSTSUBSCRIPT</annotation></semantics></math> (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.07427v1#S2.SS2.SSS3" title="2.2.3. Link Next Item ‣ 2.2. Adapt LLM for Sequential Recommendation ‣ 2. Our Method MixRec ‣ Beyond Inter-Item Relations: Dynamic Adaptive Mixture-of-Experts for LLM-Based Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>).</p>
</div>
</li>
</ul>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Aug 14 09:59:31 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
