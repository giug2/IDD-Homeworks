<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2312.02416] Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor</title><meta property="og:description" content="Federated learning encounters a critical challenge of data heterogeneity, adversely affecting the performance and convergence of the federated model. Various approaches have been proposed to address this issue, yet the…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2312.02416">

<!--Generated on Tue Feb 27 15:22:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jinqian Chen, Jihua Zhu 
<br class="ltx_break">Xi’an Jiaotong University 
<br class="ltx_break">Xi’an, China
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">chenjinqian@stu.xjtu.edu.cn, zhujh@xjtu.edu.cn</span> 
<br class="ltx_break">&amp;Qinghai Zheng 
<br class="ltx_break">Fuzhou University 
<br class="ltx_break">Fuzhou, China
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">zhengqinghai@fzu.edu.cn</span>
</span><span class="ltx_author_notes">Corresponding Author</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Federated learning encounters a critical challenge of data heterogeneity, adversely affecting the performance and convergence of the federated model. Various approaches have been proposed to address this issue, yet their effectiveness is still limited. Recent studies have revealed that the federated model suffers severe forgetting in local training, leading to global forgetting and performance degradation. Although the analysis provides valuable insights, a comprehensive understanding of the vulnerable classes and their impact factors is yet to be established. In this paper, we aim to bridge this gap by systematically analyzing the forgetting degree of each class during local training across different communication rounds. Our observations are: (1) Both missing and non-dominant classes suffer similar severe forgetting during local training, while dominant classes show improvement in performance. (2) When dynamically reducing the sample size of a dominant class, catastrophic forgetting occurs abruptly when the proportion of its samples is below a certain threshold, indicating that the local model struggles to leverage a few samples of a specific class effectively to prevent forgetting. Motivated by these findings, we propose a novel and straightforward algorithm called Federated Knowledge Anchor (FedKA). Assuming that all clients have a single shared sample for each class, the knowledge anchor is constructed before each local training stage by extracting shared samples for missing classes and randomly selecting one sample per class for non-dominant classes. The knowledge anchor is then utilized to correct the gradient of each mini-batch towards the direction of preserving the knowledge of the missing and non-dominant classes. Extensive experimental results demonstrate that our proposed FedKA achieves fast and stable convergence, significantly improving accuracy on popular benchmarks.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<p id="p1.2" class="ltx_p"><em id="p1.2.1" class="ltx_emph ltx_font_bold ltx_font_italic">K</em><span id="p1.2.2" class="ltx_text ltx_font_bold">eywords</span> Federated Learning  <math id="p1.1.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation></semantics></math>
Knowledge Preservation  <math id="p1.2.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation></semantics></math>
Data Heterogeneity</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Data serves as the foundation of artificial intelligence. Despite the pervasive influence of informatization across various domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, the availability of high-quality data remains limited. Such inadequacy may not necessarily stem from a natural scarcity, but rather from restricted access or collection due to security and privacy concerns. The isolation of data significantly impedes the real-world application of artificial intelligence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x1.png" id="S1.F1.sf1.g1" class="ltx_graphics ltx_img_square" width="138" height="138" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Class-wise test accuracy</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x2.png" id="S1.F1.sf2.g1" class="ltx_graphics ltx_img_square" width="138" height="138" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Global test accuracy</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Forgetting problem in federated learning on Non-IID data. Although class-wise accuracy remains consistent in IID settings, it can dramatically fluctuate when heterogeneous data is involved. This indicates that federated models suffer from forgetting on heterogeneous data, which hinders convergence and constrains aggregated model performance.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">To address these issues, McMahan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> introduced the concept of federated learning and developed the classic algorithm, FedAvg. Federated learning enables clients to train a model in a distributed manner without sharing their private data. In each communication round of FedAvg, the central server initially distributes the current global model to each client. Subsequently, each client trains the model using their local data for several epochs and uploads the updated parameter to the central server. The uploaded parameters are then aggregated through averaging to generate the global model for the next round. Federated learning is an efficient and privacy-preserving approach that has been successfully applied to various practical scenarios, such as smart city <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, smart health care <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, etc.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">However, as federated learning is increasingly adopted, several critical issues <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> have emerged, including the challenge of heterogeneity. Traditional deep learning methods assume that data is independent and identically distributed (IID), which ensures an upper bound on generalization error and provides a strong theoretical basis for machine learning. However, this assumption does not always hold in practical federated learning scenarios, as clients operate in diverse environments and possess heterogeneous data (also referred to as Non-IID data below) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Heterogeneous data in federated learning can be divided into several types: attribute skew, label skew, quantity skew, and their combinations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. Attribute skew refers to scenarios in which the data attributes differ among clients (e.g. clients possess text and clients possess image), which is always the research topic of vertical federated learning.
However, label skew focuses on differences in label distributions between clients (e.g. clients possess more cat samples and clients possess more tiger samples). Quantity skew refers to the imbalance of data sample numbers between clients, which always co-occurs with label skew. In this paper, we focus on the most common label skew in horizontal federated learning. As noted in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, heterogeneity significantly hinders model performance and leads to severe convergence problems.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Numerous methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> have been proposed to alleviate the impact of heterogeneous data in federated learning. However, these existing methods have not adequately addressed the issue. Studies have revealed that some methods that claim to be better than the baseline FedAvg actually perform worse in severe heterogeneous scenarios. Recently, Lee et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> provided a systematic analysis of federated learning on heterogeneous data from the perspective of forgetting. They found that clients are prone to forgetting the knowledge of out-local data, which results in forgetting in the global model. However, their study formulates forgetting from the perspective of in-local and out-local data, while the situation of class-wise forgetting remains unclear.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">In this paper, we present extensive experimental results demonstrating that catastrophic forgetting only affects missing classes and classes with a small number of samples, referred to as non-dominant classes. In contrast, the performance of dominant classes does not degrade and even improves during local training. By dynamically adjusting the number of samples of a specific class, we further illustrate that catastrophic forgetting of a particular class suddenly appears when the number of samples falls below a certain threshold. Our findings indicate that the local model cannot effectively utilize the few samples possessed by non-dominant classes to combat forgetting during training, leading to severe performance degradation similar to that observed in missing classes. Such catastrophic forgetting in missing and dominant classes impedes convergence and hinders the improvement of the federated model’s performance.</p>
</div>
<figure id="S1.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x3.png" id="S1.F2.sf1.g1" class="ltx_graphics ltx_img_square" width="138" height="138" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Data distribution visualization</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x4.png" id="S1.F2.sf2.g1" class="ltx_graphics ltx_img_square" width="138" height="138" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Forgetting degree of client 3</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Class-wise forgetting in local models: (a) Data distribution visualization of the heterogeneous Cifar10. (b) Forgetting degree of different classes in the local model of client 3. Dominant classes in client 3, namely class 2 and 8, exhibit a negative forgetting degree indicating performance improvement in local training. However, the other non-dominant and missing classes suffer severe forgetting in local training. </figcaption>
</figure>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">Motivated by the findings of catastrophic forgetting in missing and non-dominant classes, we propose a novel algorithm, Federated Knowledge Anchor (FedKA), to mitigate this issue in heterogeneous data. Specifically, we first construct a shared dataset containing only one shared sample per class. During each local training stage of a specific client, we use the shared sample to compensate for the missing classes. For each non-dominant class, we randomly select one sample from the possessed data. The two sample sets representing the missing classes and the non-dominant classes together form what we call "knowledge anchor". We further utilize the knowledge anchor in each mini-batch training to minimize the L2 distance between the discarded logits of the knowledge anchor predicted by the current global model and the updated local model. This encourages the model to preserve the knowledge of the missing and non-dominant classes. We conduct extensive experiments to demonstrate the effectiveness of our proposed FedKA. The experimental results demonstrate that FedKA achieves state-of-the-art performance with high accuracy, fast convergence, and stability.</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">In summary, our contributions are as follows:</p>
</div>
<div id="S1.p9" class="ltx_para ltx_noindent">
<p id="S1.p9.1" class="ltx_p">1. We provide a further analysis of catastrophic forgetting in federated learning, demonstrating that catastrophic forgetting only affects missing and non-dominant classes during local training, while the performance of dominant classes is improved. Furthermore, we show that the few samples of non-dominant classes possessed by the clients are not fully utilized to combat forgetting.</p>
</div>
<div id="S1.p10" class="ltx_para ltx_noindent">
<p id="S1.p10.1" class="ltx_p">2. We propose an efficient algorithm, called Federated Knowledge Anchor (FedKA), to address the heterogeneous issues regarding catastrophic forgetting. FedKA utilizes our proposed knowledge anchor to correct the direction of gradients in the mini-batch and mitigate catastrophic forgetting in non-dominant and missing classes.</p>
</div>
<div id="S1.p11" class="ltx_para ltx_noindent">
<p id="S1.p11.1" class="ltx_p">3. We conduct extensive experiments to evaluate our proposed algorithm. The results demonstrate that our FedKA achieves state-of-the-art accuracy, convergence, and robustness.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background and Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Setup</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.19" class="ltx_p">Consider a horizontal federated learning scenario with <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">N</annotation></semantics></math> clients in a <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">K</annotation></semantics></math>-class image classification problem. Each client <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">c</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑐</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">c_{i}</annotation></semantics></math> possesses its private dataset <math id="S2.SS1.p1.4.m4.4" class="ltx_Math" alttext="\mathcal{D}_{i}=\{(\boldsymbol{x}_{j},y_{j})\}_{j=1}^{n_{i}}=\{\mathcal{D}_{i}^{1},...,\mathcal{D}_{i}^{K}\}" display="inline"><semantics id="S2.SS1.p1.4.m4.4a"><mrow id="S2.SS1.p1.4.m4.4.4" xref="S2.SS1.p1.4.m4.4.4.cmml"><msub id="S2.SS1.p1.4.m4.4.4.5" xref="S2.SS1.p1.4.m4.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.4.4.5.2" xref="S2.SS1.p1.4.m4.4.4.5.2.cmml">𝒟</mi><mi id="S2.SS1.p1.4.m4.4.4.5.3" xref="S2.SS1.p1.4.m4.4.4.5.3.cmml">i</mi></msub><mo id="S2.SS1.p1.4.m4.4.4.6" xref="S2.SS1.p1.4.m4.4.4.6.cmml">=</mo><msubsup id="S2.SS1.p1.4.m4.2.2.1" xref="S2.SS1.p1.4.m4.2.2.1.cmml"><mrow id="S2.SS1.p1.4.m4.2.2.1.1.1.1" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.4" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.5" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.4.m4.2.2.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.3.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.3.2" xref="S2.SS1.p1.4.m4.2.2.1.1.3.2.cmml">j</mi><mo id="S2.SS1.p1.4.m4.2.2.1.1.3.1" xref="S2.SS1.p1.4.m4.2.2.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.4.m4.2.2.1.1.3.3" xref="S2.SS1.p1.4.m4.2.2.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS1.p1.4.m4.2.2.1.3" xref="S2.SS1.p1.4.m4.2.2.1.3.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.3.2" xref="S2.SS1.p1.4.m4.2.2.1.3.2.cmml">n</mi><mi id="S2.SS1.p1.4.m4.2.2.1.3.3" xref="S2.SS1.p1.4.m4.2.2.1.3.3.cmml">i</mi></msub></msubsup><mo id="S2.SS1.p1.4.m4.4.4.7" xref="S2.SS1.p1.4.m4.4.4.7.cmml">=</mo><mrow id="S2.SS1.p1.4.m4.4.4.3.2" xref="S2.SS1.p1.4.m4.4.4.3.3.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.4.4.3.2.3" xref="S2.SS1.p1.4.m4.4.4.3.3.cmml">{</mo><msubsup id="S2.SS1.p1.4.m4.3.3.2.1.1" xref="S2.SS1.p1.4.m4.3.3.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.3.3.2.1.1.2.2" xref="S2.SS1.p1.4.m4.3.3.2.1.1.2.2.cmml">𝒟</mi><mi id="S2.SS1.p1.4.m4.3.3.2.1.1.2.3" xref="S2.SS1.p1.4.m4.3.3.2.1.1.2.3.cmml">i</mi><mn id="S2.SS1.p1.4.m4.3.3.2.1.1.3" xref="S2.SS1.p1.4.m4.3.3.2.1.1.3.cmml">1</mn></msubsup><mo id="S2.SS1.p1.4.m4.4.4.3.2.4" xref="S2.SS1.p1.4.m4.4.4.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS1.p1.4.m4.4.4.3.2.5" xref="S2.SS1.p1.4.m4.4.4.3.3.cmml">,</mo><msubsup id="S2.SS1.p1.4.m4.4.4.3.2.2" xref="S2.SS1.p1.4.m4.4.4.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.4.4.3.2.2.2.2" xref="S2.SS1.p1.4.m4.4.4.3.2.2.2.2.cmml">𝒟</mi><mi id="S2.SS1.p1.4.m4.4.4.3.2.2.2.3" xref="S2.SS1.p1.4.m4.4.4.3.2.2.2.3.cmml">i</mi><mi id="S2.SS1.p1.4.m4.4.4.3.2.2.3" xref="S2.SS1.p1.4.m4.4.4.3.2.2.3.cmml">K</mi></msubsup><mo stretchy="false" id="S2.SS1.p1.4.m4.4.4.3.2.6" xref="S2.SS1.p1.4.m4.4.4.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.4b"><apply id="S2.SS1.p1.4.m4.4.4.cmml" xref="S2.SS1.p1.4.m4.4.4"><and id="S2.SS1.p1.4.m4.4.4a.cmml" xref="S2.SS1.p1.4.m4.4.4"></and><apply id="S2.SS1.p1.4.m4.4.4b.cmml" xref="S2.SS1.p1.4.m4.4.4"><eq id="S2.SS1.p1.4.m4.4.4.6.cmml" xref="S2.SS1.p1.4.m4.4.4.6"></eq><apply id="S2.SS1.p1.4.m4.4.4.5.cmml" xref="S2.SS1.p1.4.m4.4.4.5"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.5.1.cmml" xref="S2.SS1.p1.4.m4.4.4.5">subscript</csymbol><ci id="S2.SS1.p1.4.m4.4.4.5.2.cmml" xref="S2.SS1.p1.4.m4.4.4.5.2">𝒟</ci><ci id="S2.SS1.p1.4.m4.4.4.5.3.cmml" xref="S2.SS1.p1.4.m4.4.4.5.3">𝑖</ci></apply><apply id="S2.SS1.p1.4.m4.2.2.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1">superscript</csymbol><apply id="S2.SS1.p1.4.m4.2.2.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1">subscript</csymbol><set id="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1"><interval closure="open" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2"><apply id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="S2.SS1.p1.4.m4.2.2.1.1.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.3"><eq id="S2.SS1.p1.4.m4.2.2.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.3.1"></eq><ci id="S2.SS1.p1.4.m4.2.2.1.1.3.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.3.2">𝑗</ci><cn type="integer" id="S2.SS1.p1.4.m4.2.2.1.1.3.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.4.m4.2.2.1.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.3.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.3.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.3.2">𝑛</ci><ci id="S2.SS1.p1.4.m4.2.2.1.3.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.3.3">𝑖</ci></apply></apply></apply><apply id="S2.SS1.p1.4.m4.4.4c.cmml" xref="S2.SS1.p1.4.m4.4.4"><eq id="S2.SS1.p1.4.m4.4.4.7.cmml" xref="S2.SS1.p1.4.m4.4.4.7"></eq><share href="#S2.SS1.p1.4.m4.2.2.1.cmml" id="S2.SS1.p1.4.m4.4.4d.cmml" xref="S2.SS1.p1.4.m4.4.4"></share><set id="S2.SS1.p1.4.m4.4.4.3.3.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2"><apply id="S2.SS1.p1.4.m4.3.3.2.1.1.cmml" xref="S2.SS1.p1.4.m4.3.3.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.2.1.1.1.cmml" xref="S2.SS1.p1.4.m4.3.3.2.1.1">superscript</csymbol><apply id="S2.SS1.p1.4.m4.3.3.2.1.1.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.2.1.1.2.1.cmml" xref="S2.SS1.p1.4.m4.3.3.2.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.2.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.1.1.2.2">𝒟</ci><ci id="S2.SS1.p1.4.m4.3.3.2.1.1.2.3.cmml" xref="S2.SS1.p1.4.m4.3.3.2.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S2.SS1.p1.4.m4.3.3.2.1.1.3.cmml" xref="S2.SS1.p1.4.m4.3.3.2.1.1.3">1</cn></apply><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">…</ci><apply id="S2.SS1.p1.4.m4.4.4.3.2.2.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.3.2.2.1.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2.2">superscript</csymbol><apply id="S2.SS1.p1.4.m4.4.4.3.2.2.2.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.3.2.2.2.1.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.4.4.3.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2.2.2.2">𝒟</ci><ci id="S2.SS1.p1.4.m4.4.4.3.2.2.2.3.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.4.m4.4.4.3.2.2.3.cmml" xref="S2.SS1.p1.4.m4.4.4.3.2.2.3">𝐾</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.4c">\mathcal{D}_{i}=\{(\boldsymbol{x}_{j},y_{j})\}_{j=1}^{n_{i}}=\{\mathcal{D}_{i}^{1},...,\mathcal{D}_{i}^{K}\}</annotation></semantics></math>, where <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{k}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msubsup id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.1.1.2.2" xref="S2.SS1.p1.5.m5.1.1.2.2.cmml">𝒟</mi><mi id="S2.SS1.p1.5.m5.1.1.2.3" xref="S2.SS1.p1.5.m5.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">superscript</csymbol><apply id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.2.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2.2">𝒟</ci><ci id="S2.SS1.p1.5.m5.1.1.2.3.cmml" xref="S2.SS1.p1.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathcal{D}_{i}^{k}</annotation></semantics></math> is the client <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">i</annotation></semantics></math>’s sample set of class <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">k</annotation></semantics></math> and could be empty. The goal of the federated learning is to collaboratively train a model <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><msub id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">f</mi><mi id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2">𝑓</ci><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">f_{\boldsymbol{\theta}}</annotation></semantics></math> on the global dataset <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{D}=\mathcal{D}_{1}\cup...\cup\mathcal{D}_{N}" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mrow id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">𝒟</mi><mo id="S2.SS1.p1.9.m9.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml"><msub id="S2.SS1.p1.9.m9.1.1.3.2" xref="S2.SS1.p1.9.m9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.1.1.3.2.2" xref="S2.SS1.p1.9.m9.1.1.3.2.2.cmml">𝒟</mi><mn id="S2.SS1.p1.9.m9.1.1.3.2.3" xref="S2.SS1.p1.9.m9.1.1.3.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.9.m9.1.1.3.1" xref="S2.SS1.p1.9.m9.1.1.3.1.cmml">∪</mo><mi mathvariant="normal" id="S2.SS1.p1.9.m9.1.1.3.3" xref="S2.SS1.p1.9.m9.1.1.3.3.cmml">…</mi><mo id="S2.SS1.p1.9.m9.1.1.3.1a" xref="S2.SS1.p1.9.m9.1.1.3.1.cmml">∪</mo><msub id="S2.SS1.p1.9.m9.1.1.3.4" xref="S2.SS1.p1.9.m9.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.1.1.3.4.2" xref="S2.SS1.p1.9.m9.1.1.3.4.2.cmml">𝒟</mi><mi id="S2.SS1.p1.9.m9.1.1.3.4.3" xref="S2.SS1.p1.9.m9.1.1.3.4.3.cmml">N</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><eq id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1"></eq><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝒟</ci><apply id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3"><union id="S2.SS1.p1.9.m9.1.1.3.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1"></union><apply id="S2.SS1.p1.9.m9.1.1.3.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.3.2.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.3.2.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2.2">𝒟</ci><cn type="integer" id="S2.SS1.p1.9.m9.1.1.3.2.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2.3">1</cn></apply><ci id="S2.SS1.p1.9.m9.1.1.3.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.3">…</ci><apply id="S2.SS1.p1.9.m9.1.1.3.4.cmml" xref="S2.SS1.p1.9.m9.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.3.4.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.4">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.3.4.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.4.2">𝒟</ci><ci id="S2.SS1.p1.9.m9.1.1.3.4.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.4.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\mathcal{D}=\mathcal{D}_{1}\cup...\cup\mathcal{D}_{N}</annotation></semantics></math> without the leakage of private data in <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathcal{R}</annotation></semantics></math> communication rounds. At each communication round <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">r</annotation></semantics></math>, the server sends the current global model parameter <math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="{\boldsymbol{\theta}^{r}_{g}}" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><msubsup id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><mi id="S2.SS1.p1.12.m12.1.1.2.2" xref="S2.SS1.p1.12.m12.1.1.2.2.cmml">𝜽</mi><mi id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml">g</mi><mi id="S2.SS1.p1.12.m12.1.1.2.3" xref="S2.SS1.p1.12.m12.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">subscript</csymbol><apply id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.2.1.cmml" xref="S2.SS1.p1.12.m12.1.1">superscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.2.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2.2">𝜽</ci><ci id="S2.SS1.p1.12.m12.1.1.2.3.cmml" xref="S2.SS1.p1.12.m12.1.1.2.3">𝑟</ci></apply><ci id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">{\boldsymbol{\theta}^{r}_{g}}</annotation></semantics></math> to each participating client. After receiving the global parameters, the client <math id="S2.SS1.p1.13.m13.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S2.SS1.p1.13.m13.1a"><msub id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml"><mi id="S2.SS1.p1.13.m13.1.1.2" xref="S2.SS1.p1.13.m13.1.1.2.cmml">c</mi><mi id="S2.SS1.p1.13.m13.1.1.3" xref="S2.SS1.p1.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><apply id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.1.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S2.SS1.p1.13.m13.1.1.2.cmml" xref="S2.SS1.p1.13.m13.1.1.2">𝑐</ci><ci id="S2.SS1.p1.13.m13.1.1.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">c_{i}</annotation></semantics></math> trains this model <math id="S2.SS1.p1.14.m14.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta^{r}_{i}}}" display="inline"><semantics id="S2.SS1.p1.14.m14.1a"><msub id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml"><mi id="S2.SS1.p1.14.m14.1.1.2" xref="S2.SS1.p1.14.m14.1.1.2.cmml">f</mi><msubsup id="S2.SS1.p1.14.m14.1.1.3" xref="S2.SS1.p1.14.m14.1.1.3.cmml"><mi id="S2.SS1.p1.14.m14.1.1.3.2.2" xref="S2.SS1.p1.14.m14.1.1.3.2.2.cmml">𝜽</mi><mi id="S2.SS1.p1.14.m14.1.1.3.3" xref="S2.SS1.p1.14.m14.1.1.3.3.cmml">𝒊</mi><mi id="S2.SS1.p1.14.m14.1.1.3.2.3" xref="S2.SS1.p1.14.m14.1.1.3.2.3.cmml">𝒓</mi></msubsup></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.1b"><apply id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m14.1.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S2.SS1.p1.14.m14.1.1.2.cmml" xref="S2.SS1.p1.14.m14.1.1.2">𝑓</ci><apply id="S2.SS1.p1.14.m14.1.1.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m14.1.1.3.1.cmml" xref="S2.SS1.p1.14.m14.1.1.3">subscript</csymbol><apply id="S2.SS1.p1.14.m14.1.1.3.2.cmml" xref="S2.SS1.p1.14.m14.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m14.1.1.3.2.1.cmml" xref="S2.SS1.p1.14.m14.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.14.m14.1.1.3.2.2.cmml" xref="S2.SS1.p1.14.m14.1.1.3.2.2">𝜽</ci><ci id="S2.SS1.p1.14.m14.1.1.3.2.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3.2.3">𝒓</ci></apply><ci id="S2.SS1.p1.14.m14.1.1.3.3.cmml" xref="S2.SS1.p1.14.m14.1.1.3.3">𝒊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.1c">f_{\boldsymbol{\theta^{r}_{i}}}</annotation></semantics></math> using its private dataset <math id="S2.SS1.p1.15.m15.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S2.SS1.p1.15.m15.1a"><msub id="S2.SS1.p1.15.m15.1.1" xref="S2.SS1.p1.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.15.m15.1.1.2" xref="S2.SS1.p1.15.m15.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.15.m15.1.1.3" xref="S2.SS1.p1.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m15.1b"><apply id="S2.SS1.p1.15.m15.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m15.1.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S2.SS1.p1.15.m15.1.1.2.cmml" xref="S2.SS1.p1.15.m15.1.1.2">𝒟</ci><ci id="S2.SS1.p1.15.m15.1.1.3.cmml" xref="S2.SS1.p1.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m15.1c">\mathcal{D}_{i}</annotation></semantics></math> for <math id="S2.SS1.p1.16.m16.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.SS1.p1.16.m16.1a"><mi id="S2.SS1.p1.16.m16.1.1" xref="S2.SS1.p1.16.m16.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m16.1b"><ci id="S2.SS1.p1.16.m16.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m16.1c">E</annotation></semantics></math> epochs to get the updated local model parameter <math id="S2.SS1.p1.17.m17.1" class="ltx_Math" alttext="\boldsymbol{\theta}_{i}^{r}" display="inline"><semantics id="S2.SS1.p1.17.m17.1a"><msubsup id="S2.SS1.p1.17.m17.1.1" xref="S2.SS1.p1.17.m17.1.1.cmml"><mi id="S2.SS1.p1.17.m17.1.1.2.2" xref="S2.SS1.p1.17.m17.1.1.2.2.cmml">𝜽</mi><mi id="S2.SS1.p1.17.m17.1.1.2.3" xref="S2.SS1.p1.17.m17.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p1.17.m17.1.1.3" xref="S2.SS1.p1.17.m17.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m17.1b"><apply id="S2.SS1.p1.17.m17.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.17.m17.1.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1">superscript</csymbol><apply id="S2.SS1.p1.17.m17.1.1.2.cmml" xref="S2.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.17.m17.1.1.2.1.cmml" xref="S2.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S2.SS1.p1.17.m17.1.1.2.2.cmml" xref="S2.SS1.p1.17.m17.1.1.2.2">𝜽</ci><ci id="S2.SS1.p1.17.m17.1.1.2.3.cmml" xref="S2.SS1.p1.17.m17.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.17.m17.1.1.3.cmml" xref="S2.SS1.p1.17.m17.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m17.1c">\boldsymbol{\theta}_{i}^{r}</annotation></semantics></math>. The updated parameters are subsequently sent to the central server and aggregated to obtain the updated global model parameter <math id="S2.SS1.p1.18.m18.1" class="ltx_Math" alttext="\boldsymbol{\theta}^{r+1}_{g}" display="inline"><semantics id="S2.SS1.p1.18.m18.1a"><msubsup id="S2.SS1.p1.18.m18.1.1" xref="S2.SS1.p1.18.m18.1.1.cmml"><mi id="S2.SS1.p1.18.m18.1.1.2.2" xref="S2.SS1.p1.18.m18.1.1.2.2.cmml">𝜽</mi><mi id="S2.SS1.p1.18.m18.1.1.3" xref="S2.SS1.p1.18.m18.1.1.3.cmml">g</mi><mrow id="S2.SS1.p1.18.m18.1.1.2.3" xref="S2.SS1.p1.18.m18.1.1.2.3.cmml"><mi id="S2.SS1.p1.18.m18.1.1.2.3.2" xref="S2.SS1.p1.18.m18.1.1.2.3.2.cmml">r</mi><mo id="S2.SS1.p1.18.m18.1.1.2.3.1" xref="S2.SS1.p1.18.m18.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.18.m18.1.1.2.3.3" xref="S2.SS1.p1.18.m18.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m18.1b"><apply id="S2.SS1.p1.18.m18.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.1.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1">subscript</csymbol><apply id="S2.SS1.p1.18.m18.1.1.2.cmml" xref="S2.SS1.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.1.1.2.1.cmml" xref="S2.SS1.p1.18.m18.1.1">superscript</csymbol><ci id="S2.SS1.p1.18.m18.1.1.2.2.cmml" xref="S2.SS1.p1.18.m18.1.1.2.2">𝜽</ci><apply id="S2.SS1.p1.18.m18.1.1.2.3.cmml" xref="S2.SS1.p1.18.m18.1.1.2.3"><plus id="S2.SS1.p1.18.m18.1.1.2.3.1.cmml" xref="S2.SS1.p1.18.m18.1.1.2.3.1"></plus><ci id="S2.SS1.p1.18.m18.1.1.2.3.2.cmml" xref="S2.SS1.p1.18.m18.1.1.2.3.2">𝑟</ci><cn type="integer" id="S2.SS1.p1.18.m18.1.1.2.3.3.cmml" xref="S2.SS1.p1.18.m18.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.18.m18.1.1.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m18.1c">\boldsymbol{\theta}^{r+1}_{g}</annotation></semantics></math> for the next round. Note that the classification model <math id="S2.SS1.p1.19.m19.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}" display="inline"><semantics id="S2.SS1.p1.19.m19.1a"><msub id="S2.SS1.p1.19.m19.1.1" xref="S2.SS1.p1.19.m19.1.1.cmml"><mi id="S2.SS1.p1.19.m19.1.1.2" xref="S2.SS1.p1.19.m19.1.1.2.cmml">f</mi><mi id="S2.SS1.p1.19.m19.1.1.3" xref="S2.SS1.p1.19.m19.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.19.m19.1b"><apply id="S2.SS1.p1.19.m19.1.1.cmml" xref="S2.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m19.1.1.1.cmml" xref="S2.SS1.p1.19.m19.1.1">subscript</csymbol><ci id="S2.SS1.p1.19.m19.1.1.2.cmml" xref="S2.SS1.p1.19.m19.1.1.2">𝑓</ci><ci id="S2.SS1.p1.19.m19.1.1.3.cmml" xref="S2.SS1.p1.19.m19.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.19.m19.1c">f_{\boldsymbol{\theta}}</annotation></semantics></math> mentioned in this paper does not contain the final Softmax operation.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Related Work</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p"><span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_bold">Federated Learning (FL)</span> is a decentralized training paradigm for deep learning, allowing clients to train a model collaboratively without uploading their private data. The most commonly used algorithm for federated learning is FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. However, FedAvg suffers from severe performance degradation when dealing with heterogeneous data. To address this issue, numerous methods have been proposed from different perspectives <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. One of the most common strategies is client drift mitigation. The idea behind client drift is that the optimal solution for the objective function under local data may not be the optimal solution for global data. Some examples of these methods include FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, and FedDyn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, etc. Another set of methods focuses on the aggregation schema, including FedAvgM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, etc. FedAvgM uses momentum updates for gradient aggregation, while FedNova normalizes local updates before aggregation. Besides the aforementioned generic federated learning methods which aim to train a single model to generalize on all clients’ data, personalized federated learning is also a feasible solution to tackle the heterogeneity. The personalized federated learning allows each client to possess its own model and utilize the global aggregated information to assist its training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. SOTA personalized federated learning methods adopt various strategies to personalize their local model, including fine-tuning global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, splitting and personalizing the projection heads <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, personalized aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, additional personalized models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, etc. Though personalized federated models demonstrate great performance improvement in heterogeneous data, the generic performance and the generalization ability of these models are limited. Recent studies also reveal that several generic federated methods perform even worse than FedAvg on severe heterogeneous data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. All of these call for a better generic federated framework to tackle the heterogeneity problem.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p"><span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_bold">Forgetting in FL.</span> Catastrophic forgetting (CF) is a long-study question in continual learning but a novel perspective to address issues caused by the data heterogeneity in federated learning. CF in continual learning and CF in federated learning both refer to significant performance degradation in neural networks over time. However, they differ in several aspects. In continual learning, CF occurs at the task level due to the addition of new domains or tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. In federated learning, CF happens at the class level because of the label distribution shift when the global model is trained on clients’ data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Furthermore, CF in continual learning is monolithic, affecting the entire model, whereas, in federated learning, CF exists independently in each client, jointly influencing the global model during aggregation.
While the concept was first introduced in FedCurv <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, a comprehensive analysis of the relationship between forgetting and the impact of heterogeneous data was lacking until the introduction of FedNTD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. FedNTD highlights that clients tend to forget the knowledge of out-of-distribution data, leading to model forgetting and hindering performance on heterogeneous data. However, the analysis overlooks the influence of label distribution between classes on forgetting, particularly with regard to non-dominant and missing classes.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Forgetting on Non-dominant and Missing Classes.</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.2" class="ltx_p">To further investigate the differences in catastrophic forgetting among different classes and its influencing factors, we conduct extensive experiments on the Cifar10 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. We employ a four-layer convolutional neural network, referred to as t-CNN, as described in the Appendix. Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, we split the Cifar10 dataset into 10 heterogeneous clients using the Dirichlet distribution <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\textbf{Dir}(\alpha)" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.2" xref="S3.p1.1.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.p1.1.m1.1.2.2" xref="S3.p1.1.m1.1.2.2a.cmml">Dir</mtext><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.2.1" xref="S3.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.p1.1.m1.1.2.3.2" xref="S3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.p1.1.m1.1.2.3.2.1" xref="S3.p1.1.m1.1.2.cmml">(</mo><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">α</mi><mo stretchy="false" id="S3.p1.1.m1.1.2.3.2.2" xref="S3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.2.cmml" xref="S3.p1.1.m1.1.2"><times id="S3.p1.1.m1.1.2.1.cmml" xref="S3.p1.1.m1.1.2.1"></times><ci id="S3.p1.1.m1.1.2.2a.cmml" xref="S3.p1.1.m1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.p1.1.m1.1.2.2.cmml" xref="S3.p1.1.m1.1.2.2">Dir</mtext></ci><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\textbf{Dir}(\alpha)</annotation></semantics></math>, where we set <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">α</mi><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><eq id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></eq><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\alpha=0.1</annotation></semantics></math> to induce significant data heterogeneity. Each local training stage consisted of 10 epochs.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Class-wise Forgetting in Local Models</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.4" class="ltx_p">To investigate the classes most susceptible to catastrophic forgetting in heterogeneous data, we measure the class-wise forgetting degree for each local training stage of clients. The forgetting degree <math id="S3.SS1.p1.1.m1.2" class="ltx_Math" alttext="\tau_{i,r}^{k}" display="inline"><semantics id="S3.SS1.p1.1.m1.2a"><msubsup id="S3.SS1.p1.1.m1.2.3" xref="S3.SS1.p1.1.m1.2.3.cmml"><mi id="S3.SS1.p1.1.m1.2.3.2.2" xref="S3.SS1.p1.1.m1.2.3.2.2.cmml">τ</mi><mrow id="S3.SS1.p1.1.m1.2.2.2.4" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.1.m1.2.2.2.4.1" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.cmml">r</mi></mrow><mi id="S3.SS1.p1.1.m1.2.3.3" xref="S3.SS1.p1.1.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><apply id="S3.SS1.p1.1.m1.2.3.cmml" xref="S3.SS1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.3.1.cmml" xref="S3.SS1.p1.1.m1.2.3">superscript</csymbol><apply id="S3.SS1.p1.1.m1.2.3.2.cmml" xref="S3.SS1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.3.2.1.cmml" xref="S3.SS1.p1.1.m1.2.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.3.2.2.cmml" xref="S3.SS1.p1.1.m1.2.3.2.2">𝜏</ci><list id="S3.SS1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.4"><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2">𝑟</ci></list></apply><ci id="S3.SS1.p1.1.m1.2.3.3.cmml" xref="S3.SS1.p1.1.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">\tau_{i,r}^{k}</annotation></semantics></math> of class <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">k</annotation></semantics></math> for client <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">i</annotation></semantics></math> in communication round <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">r</annotation></semantics></math> is defined as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.8" class="ltx_Math" alttext="\tau_{i,r}^{k}=\frac{\textbf{acc}(\boldsymbol{\theta}^{r}_{g};k)-\textbf{acc}(\boldsymbol{\theta}_{i}^{r};k)}{\textbf{acc}(\boldsymbol{\theta}^{r}_{g};k)+\xi}" display="block"><semantics id="S3.E1.m1.8a"><mrow id="S3.E1.m1.8.9" xref="S3.E1.m1.8.9.cmml"><msubsup id="S3.E1.m1.8.9.2" xref="S3.E1.m1.8.9.2.cmml"><mi id="S3.E1.m1.8.9.2.2.2" xref="S3.E1.m1.8.9.2.2.2.cmml">τ</mi><mrow id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">i</mi><mo id="S3.E1.m1.2.2.2.4.1" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">r</mi></mrow><mi id="S3.E1.m1.8.9.2.3" xref="S3.E1.m1.8.9.2.3.cmml">k</mi></msubsup><mo id="S3.E1.m1.8.9.1" xref="S3.E1.m1.8.9.1.cmml">=</mo><mfrac id="S3.E1.m1.8.8" xref="S3.E1.m1.8.8.cmml"><mrow id="S3.E1.m1.6.6.4" xref="S3.E1.m1.6.6.4.cmml"><mrow id="S3.E1.m1.5.5.3.3" xref="S3.E1.m1.5.5.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.5.5.3.3.3" xref="S3.E1.m1.5.5.3.3.3a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.3.3.2" xref="S3.E1.m1.5.5.3.3.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.3.3.1.1" xref="S3.E1.m1.5.5.3.3.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.3.3.1.1.2" xref="S3.E1.m1.5.5.3.3.1.2.cmml">(</mo><msubsup id="S3.E1.m1.5.5.3.3.1.1.1" xref="S3.E1.m1.5.5.3.3.1.1.1.cmml"><mi id="S3.E1.m1.5.5.3.3.1.1.1.2.2" xref="S3.E1.m1.5.5.3.3.1.1.1.2.2.cmml">𝜽</mi><mi id="S3.E1.m1.5.5.3.3.1.1.1.3" xref="S3.E1.m1.5.5.3.3.1.1.1.3.cmml">g</mi><mi id="S3.E1.m1.5.5.3.3.1.1.1.2.3" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3.cmml">r</mi></msubsup><mo id="S3.E1.m1.5.5.3.3.1.1.3" xref="S3.E1.m1.5.5.3.3.1.2.cmml">;</mo><mi id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">k</mi><mo stretchy="false" id="S3.E1.m1.5.5.3.3.1.1.4" xref="S3.E1.m1.5.5.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.4.5" xref="S3.E1.m1.6.6.4.5.cmml">−</mo><mrow id="S3.E1.m1.6.6.4.4" xref="S3.E1.m1.6.6.4.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.6.6.4.4.3" xref="S3.E1.m1.6.6.4.4.3a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.4.4.2" xref="S3.E1.m1.6.6.4.4.2.cmml">​</mo><mrow id="S3.E1.m1.6.6.4.4.1.1" xref="S3.E1.m1.6.6.4.4.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.4.4.1.1.2" xref="S3.E1.m1.6.6.4.4.1.2.cmml">(</mo><msubsup id="S3.E1.m1.6.6.4.4.1.1.1" xref="S3.E1.m1.6.6.4.4.1.1.1.cmml"><mi id="S3.E1.m1.6.6.4.4.1.1.1.2.2" xref="S3.E1.m1.6.6.4.4.1.1.1.2.2.cmml">𝜽</mi><mi id="S3.E1.m1.6.6.4.4.1.1.1.2.3" xref="S3.E1.m1.6.6.4.4.1.1.1.2.3.cmml">i</mi><mi id="S3.E1.m1.6.6.4.4.1.1.1.3" xref="S3.E1.m1.6.6.4.4.1.1.1.3.cmml">r</mi></msubsup><mo id="S3.E1.m1.6.6.4.4.1.1.3" xref="S3.E1.m1.6.6.4.4.1.2.cmml">;</mo><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">k</mi><mo stretchy="false" id="S3.E1.m1.6.6.4.4.1.1.4" xref="S3.E1.m1.6.6.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E1.m1.8.8.6" xref="S3.E1.m1.8.8.6.cmml"><mrow id="S3.E1.m1.8.8.6.2" xref="S3.E1.m1.8.8.6.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.8.8.6.2.3" xref="S3.E1.m1.8.8.6.2.3a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.6.2.2" xref="S3.E1.m1.8.8.6.2.2.cmml">​</mo><mrow id="S3.E1.m1.8.8.6.2.1.1" xref="S3.E1.m1.8.8.6.2.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.6.2.1.1.2" xref="S3.E1.m1.8.8.6.2.1.2.cmml">(</mo><msubsup id="S3.E1.m1.8.8.6.2.1.1.1" xref="S3.E1.m1.8.8.6.2.1.1.1.cmml"><mi id="S3.E1.m1.8.8.6.2.1.1.1.2.2" xref="S3.E1.m1.8.8.6.2.1.1.1.2.2.cmml">𝜽</mi><mi id="S3.E1.m1.8.8.6.2.1.1.1.3" xref="S3.E1.m1.8.8.6.2.1.1.1.3.cmml">g</mi><mi id="S3.E1.m1.8.8.6.2.1.1.1.2.3" xref="S3.E1.m1.8.8.6.2.1.1.1.2.3.cmml">r</mi></msubsup><mo id="S3.E1.m1.8.8.6.2.1.1.3" xref="S3.E1.m1.8.8.6.2.1.2.cmml">;</mo><mi id="S3.E1.m1.7.7.5.1" xref="S3.E1.m1.7.7.5.1.cmml">k</mi><mo stretchy="false" id="S3.E1.m1.8.8.6.2.1.1.4" xref="S3.E1.m1.8.8.6.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.8.8.6.3" xref="S3.E1.m1.8.8.6.3.cmml">+</mo><mi id="S3.E1.m1.8.8.6.4" xref="S3.E1.m1.8.8.6.4.cmml">ξ</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.8b"><apply id="S3.E1.m1.8.9.cmml" xref="S3.E1.m1.8.9"><eq id="S3.E1.m1.8.9.1.cmml" xref="S3.E1.m1.8.9.1"></eq><apply id="S3.E1.m1.8.9.2.cmml" xref="S3.E1.m1.8.9.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.9.2.1.cmml" xref="S3.E1.m1.8.9.2">superscript</csymbol><apply id="S3.E1.m1.8.9.2.2.cmml" xref="S3.E1.m1.8.9.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.9.2.2.1.cmml" xref="S3.E1.m1.8.9.2">subscript</csymbol><ci id="S3.E1.m1.8.9.2.2.2.cmml" xref="S3.E1.m1.8.9.2.2.2">𝜏</ci><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑖</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑟</ci></list></apply><ci id="S3.E1.m1.8.9.2.3.cmml" xref="S3.E1.m1.8.9.2.3">𝑘</ci></apply><apply id="S3.E1.m1.8.8.cmml" xref="S3.E1.m1.8.8"><divide id="S3.E1.m1.8.8.7.cmml" xref="S3.E1.m1.8.8"></divide><apply id="S3.E1.m1.6.6.4.cmml" xref="S3.E1.m1.6.6.4"><minus id="S3.E1.m1.6.6.4.5.cmml" xref="S3.E1.m1.6.6.4.5"></minus><apply id="S3.E1.m1.5.5.3.3.cmml" xref="S3.E1.m1.5.5.3.3"><times id="S3.E1.m1.5.5.3.3.2.cmml" xref="S3.E1.m1.5.5.3.3.2"></times><ci id="S3.E1.m1.5.5.3.3.3a.cmml" xref="S3.E1.m1.5.5.3.3.3"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.5.5.3.3.3.cmml" xref="S3.E1.m1.5.5.3.3.3">acc</mtext></ci><list id="S3.E1.m1.5.5.3.3.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1"><apply id="S3.E1.m1.5.5.3.3.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1">subscript</csymbol><apply id="S3.E1.m1.5.5.3.3.1.1.1.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1">superscript</csymbol><ci id="S3.E1.m1.5.5.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.2">𝜽</ci><ci id="S3.E1.m1.5.5.3.3.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.2.3">𝑟</ci></apply><ci id="S3.E1.m1.5.5.3.3.1.1.1.3.cmml" xref="S3.E1.m1.5.5.3.3.1.1.1.3">𝑔</ci></apply><ci id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">𝑘</ci></list></apply><apply id="S3.E1.m1.6.6.4.4.cmml" xref="S3.E1.m1.6.6.4.4"><times id="S3.E1.m1.6.6.4.4.2.cmml" xref="S3.E1.m1.6.6.4.4.2"></times><ci id="S3.E1.m1.6.6.4.4.3a.cmml" xref="S3.E1.m1.6.6.4.4.3"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.6.6.4.4.3.cmml" xref="S3.E1.m1.6.6.4.4.3">acc</mtext></ci><list id="S3.E1.m1.6.6.4.4.1.2.cmml" xref="S3.E1.m1.6.6.4.4.1.1"><apply id="S3.E1.m1.6.6.4.4.1.1.1.cmml" xref="S3.E1.m1.6.6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.4.4.1.1.1.1.cmml" xref="S3.E1.m1.6.6.4.4.1.1.1">superscript</csymbol><apply id="S3.E1.m1.6.6.4.4.1.1.1.2.cmml" xref="S3.E1.m1.6.6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.4.4.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.4.4.1.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.4.4.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.4.4.1.1.1.2.2">𝜽</ci><ci id="S3.E1.m1.6.6.4.4.1.1.1.2.3.cmml" xref="S3.E1.m1.6.6.4.4.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E1.m1.6.6.4.4.1.1.1.3.cmml" xref="S3.E1.m1.6.6.4.4.1.1.1.3">𝑟</ci></apply><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝑘</ci></list></apply></apply><apply id="S3.E1.m1.8.8.6.cmml" xref="S3.E1.m1.8.8.6"><plus id="S3.E1.m1.8.8.6.3.cmml" xref="S3.E1.m1.8.8.6.3"></plus><apply id="S3.E1.m1.8.8.6.2.cmml" xref="S3.E1.m1.8.8.6.2"><times id="S3.E1.m1.8.8.6.2.2.cmml" xref="S3.E1.m1.8.8.6.2.2"></times><ci id="S3.E1.m1.8.8.6.2.3a.cmml" xref="S3.E1.m1.8.8.6.2.3"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.8.8.6.2.3.cmml" xref="S3.E1.m1.8.8.6.2.3">acc</mtext></ci><list id="S3.E1.m1.8.8.6.2.1.2.cmml" xref="S3.E1.m1.8.8.6.2.1.1"><apply id="S3.E1.m1.8.8.6.2.1.1.1.cmml" xref="S3.E1.m1.8.8.6.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.6.2.1.1.1.1.cmml" xref="S3.E1.m1.8.8.6.2.1.1.1">subscript</csymbol><apply id="S3.E1.m1.8.8.6.2.1.1.1.2.cmml" xref="S3.E1.m1.8.8.6.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.6.2.1.1.1.2.1.cmml" xref="S3.E1.m1.8.8.6.2.1.1.1">superscript</csymbol><ci id="S3.E1.m1.8.8.6.2.1.1.1.2.2.cmml" xref="S3.E1.m1.8.8.6.2.1.1.1.2.2">𝜽</ci><ci id="S3.E1.m1.8.8.6.2.1.1.1.2.3.cmml" xref="S3.E1.m1.8.8.6.2.1.1.1.2.3">𝑟</ci></apply><ci id="S3.E1.m1.8.8.6.2.1.1.1.3.cmml" xref="S3.E1.m1.8.8.6.2.1.1.1.3">𝑔</ci></apply><ci id="S3.E1.m1.7.7.5.1.cmml" xref="S3.E1.m1.7.7.5.1">𝑘</ci></list></apply><ci id="S3.E1.m1.8.8.6.4.cmml" xref="S3.E1.m1.8.8.6.4">𝜉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.8c">\tau_{i,r}^{k}=\frac{\textbf{acc}(\boldsymbol{\theta}^{r}_{g};k)-\textbf{acc}(\boldsymbol{\theta}_{i}^{r};k)}{\textbf{acc}(\boldsymbol{\theta}^{r}_{g};k)+\xi}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.18" class="ltx_p">, where <math id="S3.SS1.p1.5.m1.2" class="ltx_Math" alttext="\textbf{acc}(\boldsymbol{\theta};k)" display="inline"><semantics id="S3.SS1.p1.5.m1.2a"><mrow id="S3.SS1.p1.5.m1.2.3" xref="S3.SS1.p1.5.m1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.5.m1.2.3.2" xref="S3.SS1.p1.5.m1.2.3.2a.cmml">acc</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m1.2.3.1" xref="S3.SS1.p1.5.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.5.m1.2.3.3.2" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m1.2.3.3.2.1" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.5.m1.1.1" xref="S3.SS1.p1.5.m1.1.1.cmml">𝜽</mi><mo id="S3.SS1.p1.5.m1.2.3.3.2.2" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml">;</mo><mi id="S3.SS1.p1.5.m1.2.2" xref="S3.SS1.p1.5.m1.2.2.cmml">k</mi><mo stretchy="false" id="S3.SS1.p1.5.m1.2.3.3.2.3" xref="S3.SS1.p1.5.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m1.2b"><apply id="S3.SS1.p1.5.m1.2.3.cmml" xref="S3.SS1.p1.5.m1.2.3"><times id="S3.SS1.p1.5.m1.2.3.1.cmml" xref="S3.SS1.p1.5.m1.2.3.1"></times><ci id="S3.SS1.p1.5.m1.2.3.2a.cmml" xref="S3.SS1.p1.5.m1.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.5.m1.2.3.2.cmml" xref="S3.SS1.p1.5.m1.2.3.2">acc</mtext></ci><list id="S3.SS1.p1.5.m1.2.3.3.1.cmml" xref="S3.SS1.p1.5.m1.2.3.3.2"><ci id="S3.SS1.p1.5.m1.1.1.cmml" xref="S3.SS1.p1.5.m1.1.1">𝜽</ci><ci id="S3.SS1.p1.5.m1.2.2.cmml" xref="S3.SS1.p1.5.m1.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m1.2c">\textbf{acc}(\boldsymbol{\theta};k)</annotation></semantics></math> is the test accuracy of the model with parameter <math id="S3.SS1.p1.6.m2.1" class="ltx_Math" alttext="\boldsymbol{\theta}" display="inline"><semantics id="S3.SS1.p1.6.m2.1a"><mi id="S3.SS1.p1.6.m2.1.1" xref="S3.SS1.p1.6.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m2.1b"><ci id="S3.SS1.p1.6.m2.1.1.cmml" xref="S3.SS1.p1.6.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m2.1c">\boldsymbol{\theta}</annotation></semantics></math> on class <math id="S3.SS1.p1.7.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.7.m3.1a"><mi id="S3.SS1.p1.7.m3.1.1" xref="S3.SS1.p1.7.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m3.1b"><ci id="S3.SS1.p1.7.m3.1.1.cmml" xref="S3.SS1.p1.7.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m3.1c">k</annotation></semantics></math>, and <math id="S3.SS1.p1.8.m4.1" class="ltx_Math" alttext="\xi" display="inline"><semantics id="S3.SS1.p1.8.m4.1a"><mi id="S3.SS1.p1.8.m4.1.1" xref="S3.SS1.p1.8.m4.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m4.1b"><ci id="S3.SS1.p1.8.m4.1.1.cmml" xref="S3.SS1.p1.8.m4.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m4.1c">\xi</annotation></semantics></math> is a small positive constant to maintain numerical stability. The forgetting degree <math id="S3.SS1.p1.9.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p1.9.m5.1a"><mi id="S3.SS1.p1.9.m5.1.1" xref="S3.SS1.p1.9.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m5.1b"><ci id="S3.SS1.p1.9.m5.1.1.cmml" xref="S3.SS1.p1.9.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m5.1c">\tau</annotation></semantics></math> ranges from <math id="S3.SS1.p1.10.m6.1" class="ltx_Math" alttext="-\infty" display="inline"><semantics id="S3.SS1.p1.10.m6.1a"><mrow id="S3.SS1.p1.10.m6.1.1" xref="S3.SS1.p1.10.m6.1.1.cmml"><mo id="S3.SS1.p1.10.m6.1.1a" xref="S3.SS1.p1.10.m6.1.1.cmml">−</mo><mi mathvariant="normal" id="S3.SS1.p1.10.m6.1.1.2" xref="S3.SS1.p1.10.m6.1.1.2.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m6.1b"><apply id="S3.SS1.p1.10.m6.1.1.cmml" xref="S3.SS1.p1.10.m6.1.1"><minus id="S3.SS1.p1.10.m6.1.1.1.cmml" xref="S3.SS1.p1.10.m6.1.1"></minus><infinity id="S3.SS1.p1.10.m6.1.1.2.cmml" xref="S3.SS1.p1.10.m6.1.1.2"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m6.1c">-\infty</annotation></semantics></math> to <math id="S3.SS1.p1.11.m7.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS1.p1.11.m7.1a"><mn id="S3.SS1.p1.11.m7.1.1" xref="S3.SS1.p1.11.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m7.1b"><cn type="integer" id="S3.SS1.p1.11.m7.1.1.cmml" xref="S3.SS1.p1.11.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m7.1c">1</annotation></semantics></math>. A positive value of <math id="S3.SS1.p1.12.m8.2" class="ltx_Math" alttext="\tau_{i,r}^{k}" display="inline"><semantics id="S3.SS1.p1.12.m8.2a"><msubsup id="S3.SS1.p1.12.m8.2.3" xref="S3.SS1.p1.12.m8.2.3.cmml"><mi id="S3.SS1.p1.12.m8.2.3.2.2" xref="S3.SS1.p1.12.m8.2.3.2.2.cmml">τ</mi><mrow id="S3.SS1.p1.12.m8.2.2.2.4" xref="S3.SS1.p1.12.m8.2.2.2.3.cmml"><mi id="S3.SS1.p1.12.m8.1.1.1.1" xref="S3.SS1.p1.12.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.12.m8.2.2.2.4.1" xref="S3.SS1.p1.12.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.12.m8.2.2.2.2" xref="S3.SS1.p1.12.m8.2.2.2.2.cmml">r</mi></mrow><mi id="S3.SS1.p1.12.m8.2.3.3" xref="S3.SS1.p1.12.m8.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m8.2b"><apply id="S3.SS1.p1.12.m8.2.3.cmml" xref="S3.SS1.p1.12.m8.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m8.2.3.1.cmml" xref="S3.SS1.p1.12.m8.2.3">superscript</csymbol><apply id="S3.SS1.p1.12.m8.2.3.2.cmml" xref="S3.SS1.p1.12.m8.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m8.2.3.2.1.cmml" xref="S3.SS1.p1.12.m8.2.3">subscript</csymbol><ci id="S3.SS1.p1.12.m8.2.3.2.2.cmml" xref="S3.SS1.p1.12.m8.2.3.2.2">𝜏</ci><list id="S3.SS1.p1.12.m8.2.2.2.3.cmml" xref="S3.SS1.p1.12.m8.2.2.2.4"><ci id="S3.SS1.p1.12.m8.1.1.1.1.cmml" xref="S3.SS1.p1.12.m8.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.12.m8.2.2.2.2.cmml" xref="S3.SS1.p1.12.m8.2.2.2.2">𝑟</ci></list></apply><ci id="S3.SS1.p1.12.m8.2.3.3.cmml" xref="S3.SS1.p1.12.m8.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m8.2c">\tau_{i,r}^{k}</annotation></semantics></math> indicates that client <math id="S3.SS1.p1.13.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.13.m9.1a"><mi id="S3.SS1.p1.13.m9.1.1" xref="S3.SS1.p1.13.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m9.1b"><ci id="S3.SS1.p1.13.m9.1.1.cmml" xref="S3.SS1.p1.13.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m9.1c">i</annotation></semantics></math> has forgotten knowledge of class <math id="S3.SS1.p1.14.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.14.m10.1a"><mi id="S3.SS1.p1.14.m10.1.1" xref="S3.SS1.p1.14.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m10.1b"><ci id="S3.SS1.p1.14.m10.1.1.cmml" xref="S3.SS1.p1.14.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m10.1c">k</annotation></semantics></math> after local training in communication round <math id="S3.SS1.p1.15.m11.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS1.p1.15.m11.1a"><mi id="S3.SS1.p1.15.m11.1.1" xref="S3.SS1.p1.15.m11.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m11.1b"><ci id="S3.SS1.p1.15.m11.1.1.cmml" xref="S3.SS1.p1.15.m11.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m11.1c">r</annotation></semantics></math>, while a negative value indicates that the knowledge of class <math id="S3.SS1.p1.16.m12.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.16.m12.1a"><mi id="S3.SS1.p1.16.m12.1.1" xref="S3.SS1.p1.16.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m12.1b"><ci id="S3.SS1.p1.16.m12.1.1.cmml" xref="S3.SS1.p1.16.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m12.1c">k</annotation></semantics></math> has improved for client <math id="S3.SS1.p1.17.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.17.m13.1a"><mi id="S3.SS1.p1.17.m13.1.1" xref="S3.SS1.p1.17.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m13.1b"><ci id="S3.SS1.p1.17.m13.1.1.cmml" xref="S3.SS1.p1.17.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m13.1c">i</annotation></semantics></math>. The closer the value of <math id="S3.SS1.p1.18.m14.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p1.18.m14.1a"><mi id="S3.SS1.p1.18.m14.1.1" xref="S3.SS1.p1.18.m14.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m14.1b"><ci id="S3.SS1.p1.18.m14.1.1.cmml" xref="S3.SS1.p1.18.m14.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m14.1c">\tau</annotation></semantics></math> is to 1, the more severe the forgetting.</p>
</div>
<div id="Thmdefinition1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmdefinition1.1.1.1" class="ltx_text ltx_font_bold">Definition 1</span></span><span id="Thmdefinition1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmdefinition1.p1" class="ltx_para ltx_noindent">
<p id="Thmdefinition1.p1.9" class="ltx_p"><span id="Thmdefinition1.p1.9.9" class="ltx_text ltx_font_italic">Consider a local dataset <math id="Thmdefinition1.p1.1.1.m1.1" class="ltx_Math" alttext="\{(\boldsymbol{x}_{j},y_{j})\}_{j=1}^{n_{i}}" display="inline"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><msubsup id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml"><mrow id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.3" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.4" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.2" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.3" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.5" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="Thmdefinition1.p1.1.1.m1.1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3.cmml"><mi id="Thmdefinition1.p1.1.1.m1.1.1.1.3.2" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3.2.cmml">j</mi><mo id="Thmdefinition1.p1.1.1.m1.1.1.1.3.1" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="Thmdefinition1.p1.1.1.m1.1.1.1.3.3" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><msub id="Thmdefinition1.p1.1.1.m1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.cmml"><mi id="Thmdefinition1.p1.1.1.m1.1.1.3.2" xref="Thmdefinition1.p1.1.1.m1.1.1.3.2.cmml">n</mi><mi id="Thmdefinition1.p1.1.1.m1.1.1.3.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><apply id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1">superscript</csymbol><apply id="Thmdefinition1.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.1.1.m1.1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1">subscript</csymbol><set id="Thmdefinition1.p1.1.1.m1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1"><interval closure="open" id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2"><apply id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="Thmdefinition1.p1.1.1.m1.1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3"><eq id="Thmdefinition1.p1.1.1.m1.1.1.1.3.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3.1"></eq><ci id="Thmdefinition1.p1.1.1.m1.1.1.1.3.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3.2">𝑗</ci><cn type="integer" id="Thmdefinition1.p1.1.1.m1.1.1.1.3.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1.3.3">1</cn></apply></apply><apply id="Thmdefinition1.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Thmdefinition1.p1.1.1.m1.1.1.3.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3">subscript</csymbol><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.2">𝑛</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">\{(\boldsymbol{x}_{j},y_{j})\}_{j=1}^{n_{i}}</annotation></semantics></math> of client <math id="Thmdefinition1.p1.2.2.m2.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="Thmdefinition1.p1.2.2.m2.1a"><msub id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition1.p1.2.2.m2.1.1.2" xref="Thmdefinition1.p1.2.2.m2.1.1.2.cmml">c</mi><mi id="Thmdefinition1.p1.2.2.m2.1.1.3" xref="Thmdefinition1.p1.2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.1b"><apply id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.2">𝑐</ci><ci id="Thmdefinition1.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.1c">c_{i}</annotation></semantics></math> with <math id="Thmdefinition1.p1.3.3.m3.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="Thmdefinition1.p1.3.3.m3.1a"><msub id="Thmdefinition1.p1.3.3.m3.1.1" xref="Thmdefinition1.p1.3.3.m3.1.1.cmml"><mi id="Thmdefinition1.p1.3.3.m3.1.1.2" xref="Thmdefinition1.p1.3.3.m3.1.1.2.cmml">n</mi><mi id="Thmdefinition1.p1.3.3.m3.1.1.3" xref="Thmdefinition1.p1.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.m3.1b"><apply id="Thmdefinition1.p1.3.3.m3.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.3.3.m3.1.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.3.3.m3.1.1.2.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1.2">𝑛</ci><ci id="Thmdefinition1.p1.3.3.m3.1.1.3.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.m3.1c">n_{i}</annotation></semantics></math> data samples in a <math id="Thmdefinition1.p1.4.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Thmdefinition1.p1.4.4.m4.1a"><mi id="Thmdefinition1.p1.4.4.m4.1.1" xref="Thmdefinition1.p1.4.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.4.m4.1b"><ci id="Thmdefinition1.p1.4.4.m4.1.1.cmml" xref="Thmdefinition1.p1.4.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.4.m4.1c">K</annotation></semantics></math>-class classification problem. Given the certain threshold <math id="Thmdefinition1.p1.5.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="Thmdefinition1.p1.5.5.m5.1a"><mi id="Thmdefinition1.p1.5.5.m5.1.1" xref="Thmdefinition1.p1.5.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.5.5.m5.1b"><ci id="Thmdefinition1.p1.5.5.m5.1.1.cmml" xref="Thmdefinition1.p1.5.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.5.5.m5.1c">\gamma</annotation></semantics></math>, the missing classes <math id="Thmdefinition1.p1.6.6.m6.1" class="ltx_Math" alttext="C_{m}^{i}" display="inline"><semantics id="Thmdefinition1.p1.6.6.m6.1a"><msubsup id="Thmdefinition1.p1.6.6.m6.1.1" xref="Thmdefinition1.p1.6.6.m6.1.1.cmml"><mi id="Thmdefinition1.p1.6.6.m6.1.1.2.2" xref="Thmdefinition1.p1.6.6.m6.1.1.2.2.cmml">C</mi><mi id="Thmdefinition1.p1.6.6.m6.1.1.2.3" xref="Thmdefinition1.p1.6.6.m6.1.1.2.3.cmml">m</mi><mi id="Thmdefinition1.p1.6.6.m6.1.1.3" xref="Thmdefinition1.p1.6.6.m6.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.6.6.m6.1b"><apply id="Thmdefinition1.p1.6.6.m6.1.1.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.6.m6.1.1.1.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1">superscript</csymbol><apply id="Thmdefinition1.p1.6.6.m6.1.1.2.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.6.m6.1.1.2.1.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.6.6.m6.1.1.2.2.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1.2.2">𝐶</ci><ci id="Thmdefinition1.p1.6.6.m6.1.1.2.3.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1.2.3">𝑚</ci></apply><ci id="Thmdefinition1.p1.6.6.m6.1.1.3.cmml" xref="Thmdefinition1.p1.6.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.6.6.m6.1c">C_{m}^{i}</annotation></semantics></math>, non-dominant classes <math id="Thmdefinition1.p1.7.7.m7.1" class="ltx_Math" alttext="C_{n}^{i}" display="inline"><semantics id="Thmdefinition1.p1.7.7.m7.1a"><msubsup id="Thmdefinition1.p1.7.7.m7.1.1" xref="Thmdefinition1.p1.7.7.m7.1.1.cmml"><mi id="Thmdefinition1.p1.7.7.m7.1.1.2.2" xref="Thmdefinition1.p1.7.7.m7.1.1.2.2.cmml">C</mi><mi id="Thmdefinition1.p1.7.7.m7.1.1.2.3" xref="Thmdefinition1.p1.7.7.m7.1.1.2.3.cmml">n</mi><mi id="Thmdefinition1.p1.7.7.m7.1.1.3" xref="Thmdefinition1.p1.7.7.m7.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.7.7.m7.1b"><apply id="Thmdefinition1.p1.7.7.m7.1.1.cmml" xref="Thmdefinition1.p1.7.7.m7.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.7.7.m7.1.1.1.cmml" xref="Thmdefinition1.p1.7.7.m7.1.1">superscript</csymbol><apply id="Thmdefinition1.p1.7.7.m7.1.1.2.cmml" xref="Thmdefinition1.p1.7.7.m7.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.7.7.m7.1.1.2.1.cmml" xref="Thmdefinition1.p1.7.7.m7.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.7.7.m7.1.1.2.2.cmml" xref="Thmdefinition1.p1.7.7.m7.1.1.2.2">𝐶</ci><ci id="Thmdefinition1.p1.7.7.m7.1.1.2.3.cmml" xref="Thmdefinition1.p1.7.7.m7.1.1.2.3">𝑛</ci></apply><ci id="Thmdefinition1.p1.7.7.m7.1.1.3.cmml" xref="Thmdefinition1.p1.7.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.7.7.m7.1c">C_{n}^{i}</annotation></semantics></math>, dominant classes <math id="Thmdefinition1.p1.8.8.m8.1" class="ltx_Math" alttext="C_{d}^{i}" display="inline"><semantics id="Thmdefinition1.p1.8.8.m8.1a"><msubsup id="Thmdefinition1.p1.8.8.m8.1.1" xref="Thmdefinition1.p1.8.8.m8.1.1.cmml"><mi id="Thmdefinition1.p1.8.8.m8.1.1.2.2" xref="Thmdefinition1.p1.8.8.m8.1.1.2.2.cmml">C</mi><mi id="Thmdefinition1.p1.8.8.m8.1.1.2.3" xref="Thmdefinition1.p1.8.8.m8.1.1.2.3.cmml">d</mi><mi id="Thmdefinition1.p1.8.8.m8.1.1.3" xref="Thmdefinition1.p1.8.8.m8.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.8.8.m8.1b"><apply id="Thmdefinition1.p1.8.8.m8.1.1.cmml" xref="Thmdefinition1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.8.8.m8.1.1.1.cmml" xref="Thmdefinition1.p1.8.8.m8.1.1">superscript</csymbol><apply id="Thmdefinition1.p1.8.8.m8.1.1.2.cmml" xref="Thmdefinition1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.8.8.m8.1.1.2.1.cmml" xref="Thmdefinition1.p1.8.8.m8.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.8.8.m8.1.1.2.2.cmml" xref="Thmdefinition1.p1.8.8.m8.1.1.2.2">𝐶</ci><ci id="Thmdefinition1.p1.8.8.m8.1.1.2.3.cmml" xref="Thmdefinition1.p1.8.8.m8.1.1.2.3">𝑑</ci></apply><ci id="Thmdefinition1.p1.8.8.m8.1.1.3.cmml" xref="Thmdefinition1.p1.8.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.8.8.m8.1c">C_{d}^{i}</annotation></semantics></math> of client <math id="Thmdefinition1.p1.9.9.m9.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="Thmdefinition1.p1.9.9.m9.1a"><msub id="Thmdefinition1.p1.9.9.m9.1.1" xref="Thmdefinition1.p1.9.9.m9.1.1.cmml"><mi id="Thmdefinition1.p1.9.9.m9.1.1.2" xref="Thmdefinition1.p1.9.9.m9.1.1.2.cmml">c</mi><mi id="Thmdefinition1.p1.9.9.m9.1.1.3" xref="Thmdefinition1.p1.9.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.9.9.m9.1b"><apply id="Thmdefinition1.p1.9.9.m9.1.1.cmml" xref="Thmdefinition1.p1.9.9.m9.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.9.9.m9.1.1.1.cmml" xref="Thmdefinition1.p1.9.9.m9.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.9.9.m9.1.1.2.cmml" xref="Thmdefinition1.p1.9.9.m9.1.1.2">𝑐</ci><ci id="Thmdefinition1.p1.9.9.m9.1.1.3.cmml" xref="Thmdefinition1.p1.9.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.9.9.m9.1c">c_{i}</annotation></semantics></math> are:</span></p>
</div>
<div id="Thmdefinition1.p2" class="ltx_para ltx_noindent">
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.4" class="ltx_Math" alttext="C_{m}^{i}=\{k|\sum_{j=1}^{n_{i}}{\mathbb{I}(y_{j}=k)}=0,k&lt;K,k\in\mathbb{Z}\}" display="block"><semantics id="S3.Ex1.m1.4a"><mrow id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.4.4.cmml"><msubsup id="S3.Ex1.m1.4.4.3" xref="S3.Ex1.m1.4.4.3.cmml"><mi id="S3.Ex1.m1.4.4.3.2.2" xref="S3.Ex1.m1.4.4.3.2.2.cmml">C</mi><mi id="S3.Ex1.m1.4.4.3.2.3" xref="S3.Ex1.m1.4.4.3.2.3.cmml">m</mi><mi id="S3.Ex1.m1.4.4.3.3" xref="S3.Ex1.m1.4.4.3.3.cmml">i</mi></msubsup><mo id="S3.Ex1.m1.4.4.2" xref="S3.Ex1.m1.4.4.2.cmml">=</mo><mrow id="S3.Ex1.m1.4.4.1.1" xref="S3.Ex1.m1.4.4.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.4.4.1.1.2" xref="S3.Ex1.m1.4.4.1.2.1.cmml">{</mo><mi id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.4.4.1.1.3" xref="S3.Ex1.m1.4.4.1.2.1.cmml">|</mo><mrow id="S3.Ex1.m1.4.4.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.3.cmml"><mrow id="S3.Ex1.m1.4.4.1.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.4.4.1.1.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.cmml"><munderover id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.2.cmml">n</mi><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.3.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.4.4.1.1.1.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.1.1.2.cmml">=</mo><mn id="S3.Ex1.m1.4.4.1.1.1.1.1.3" xref="S3.Ex1.m1.4.4.1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S3.Ex1.m1.4.4.1.1.1.2.3" xref="S3.Ex1.m1.4.4.1.1.1.3a.cmml">,</mo><mrow id="S3.Ex1.m1.4.4.1.1.1.2.2.2" xref="S3.Ex1.m1.4.4.1.1.1.2.2.3.cmml"><mrow id="S3.Ex1.m1.4.4.1.1.1.2.2.1.1" xref="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.cmml"><mi id="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.2" xref="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.2.cmml">k</mi><mo id="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.1" xref="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.1.cmml">&lt;</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">K</mi></mrow><mo id="S3.Ex1.m1.4.4.1.1.1.2.2.2.3" xref="S3.Ex1.m1.4.4.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.Ex1.m1.4.4.1.1.1.2.2.2.2" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">k</mi><mo id="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.1" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.1.cmml">∈</mo><mi id="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.2" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.2.cmml">ℤ</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex1.m1.4.4.1.1.4" xref="S3.Ex1.m1.4.4.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.4b"><apply id="S3.Ex1.m1.4.4.cmml" xref="S3.Ex1.m1.4.4"><eq id="S3.Ex1.m1.4.4.2.cmml" xref="S3.Ex1.m1.4.4.2"></eq><apply id="S3.Ex1.m1.4.4.3.cmml" xref="S3.Ex1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.3.1.cmml" xref="S3.Ex1.m1.4.4.3">superscript</csymbol><apply id="S3.Ex1.m1.4.4.3.2.cmml" xref="S3.Ex1.m1.4.4.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.3.2.1.cmml" xref="S3.Ex1.m1.4.4.3">subscript</csymbol><ci id="S3.Ex1.m1.4.4.3.2.2.cmml" xref="S3.Ex1.m1.4.4.3.2.2">𝐶</ci><ci id="S3.Ex1.m1.4.4.3.2.3.cmml" xref="S3.Ex1.m1.4.4.3.2.3">𝑚</ci></apply><ci id="S3.Ex1.m1.4.4.3.3.cmml" xref="S3.Ex1.m1.4.4.3.3">𝑖</ci></apply><apply id="S3.Ex1.m1.4.4.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.4.4.1.2.1.cmml" xref="S3.Ex1.m1.4.4.1.1.2">conditional-set</csymbol><ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">𝑘</ci><apply id="S3.Ex1.m1.4.4.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.3a.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1"><eq id="S3.Ex1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.2"></eq><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1"><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3"><eq id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1"><times id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.3">𝕀</ci><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1"><eq id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><cn type="integer" id="S3.Ex1.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.1.1.3">0</cn></apply><apply id="S3.Ex1.m1.4.4.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.1.1.1.2.2.3a.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.1.1"><lt id="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.1"></lt><ci id="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.1.1.2">𝑘</ci><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝐾</ci></apply><apply id="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2.2"><in id="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.1"></in><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝑘</ci><ci id="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.4.4.1.1.1.2.2.2.2.2">ℤ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.4c">C_{m}^{i}=\{k|\sum_{j=1}^{n_{i}}{\mathbb{I}(y_{j}=k)}=0,k&lt;K,k\in\mathbb{Z}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.6" class="ltx_Math" alttext="C_{n}^{i}=\{k|0&lt;\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}{\mathbb{I}(y_{j}=k)}&lt;\gamma,k&lt;K,k\in\mathbb{Z}\}" display="block"><semantics id="S3.Ex2.m1.6a"><mrow id="S3.Ex2.m1.6.6" xref="S3.Ex2.m1.6.6.cmml"><msubsup id="S3.Ex2.m1.6.6.3" xref="S3.Ex2.m1.6.6.3.cmml"><mi id="S3.Ex2.m1.6.6.3.2.2" xref="S3.Ex2.m1.6.6.3.2.2.cmml">C</mi><mi id="S3.Ex2.m1.6.6.3.2.3" xref="S3.Ex2.m1.6.6.3.2.3.cmml">n</mi><mi id="S3.Ex2.m1.6.6.3.3" xref="S3.Ex2.m1.6.6.3.3.cmml">i</mi></msubsup><mo id="S3.Ex2.m1.6.6.2" xref="S3.Ex2.m1.6.6.2.cmml">=</mo><mrow id="S3.Ex2.m1.6.6.1.1" xref="S3.Ex2.m1.6.6.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m1.6.6.1.1.2" xref="S3.Ex2.m1.6.6.1.2.1.cmml">{</mo><mi id="S3.Ex2.m1.5.5" xref="S3.Ex2.m1.5.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.6.6.1.1.3" xref="S3.Ex2.m1.6.6.1.2.1.cmml">|</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.3.cmml"><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.cmml"><mn id="S3.Ex2.m1.6.6.1.1.1.1.1.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.3.cmml">0</mn><mo id="S3.Ex2.m1.6.6.1.1.1.1.1.4" xref="S3.Ex2.m1.6.6.1.1.1.1.1.4.cmml">&lt;</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.cmml"><mfrac id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.cmml"><mn id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.2.cmml">1</mn><msub id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.2.cmml">n</mi><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex2.m1.6.6.1.1.1.1.1.5" xref="S3.Ex2.m1.6.6.1.1.1.1.1.5.cmml">&lt;</mo><mi id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml">γ</mi></mrow><mo id="S3.Ex2.m1.6.6.1.1.1.2.3" xref="S3.Ex2.m1.6.6.1.1.1.3a.cmml">,</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.2.2.2" xref="S3.Ex2.m1.6.6.1.1.1.2.2.3.cmml"><mrow id="S3.Ex2.m1.6.6.1.1.1.2.2.1.1" xref="S3.Ex2.m1.6.6.1.1.1.2.2.1.1.cmml"><mi id="S3.Ex2.m1.4.4" xref="S3.Ex2.m1.4.4.cmml">k</mi><mo id="S3.Ex2.m1.6.6.1.1.1.2.2.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.2.2.1.1.1.cmml">&lt;</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">K</mi></mrow><mo id="S3.Ex2.m1.6.6.1.1.1.2.2.2.3" xref="S3.Ex2.m1.6.6.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.2.2.2.2" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml">k</mi><mo id="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.1" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.1.cmml">∈</mo><mi id="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.2" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.2.cmml">ℤ</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex2.m1.6.6.1.1.4" xref="S3.Ex2.m1.6.6.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.6b"><apply id="S3.Ex2.m1.6.6.cmml" xref="S3.Ex2.m1.6.6"><eq id="S3.Ex2.m1.6.6.2.cmml" xref="S3.Ex2.m1.6.6.2"></eq><apply id="S3.Ex2.m1.6.6.3.cmml" xref="S3.Ex2.m1.6.6.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.3.1.cmml" xref="S3.Ex2.m1.6.6.3">superscript</csymbol><apply id="S3.Ex2.m1.6.6.3.2.cmml" xref="S3.Ex2.m1.6.6.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.3.2.1.cmml" xref="S3.Ex2.m1.6.6.3">subscript</csymbol><ci id="S3.Ex2.m1.6.6.3.2.2.cmml" xref="S3.Ex2.m1.6.6.3.2.2">𝐶</ci><ci id="S3.Ex2.m1.6.6.3.2.3.cmml" xref="S3.Ex2.m1.6.6.3.2.3">𝑛</ci></apply><ci id="S3.Ex2.m1.6.6.3.3.cmml" xref="S3.Ex2.m1.6.6.3.3">𝑖</ci></apply><apply id="S3.Ex2.m1.6.6.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1"><csymbol cd="latexml" id="S3.Ex2.m1.6.6.1.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.2">conditional-set</csymbol><ci id="S3.Ex2.m1.5.5.cmml" xref="S3.Ex2.m1.5.5">𝑘</ci><apply id="S3.Ex2.m1.6.6.1.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.3a.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1"><and id="S3.Ex2.m1.6.6.1.1.1.1.1a.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1"></and><apply id="S3.Ex2.m1.6.6.1.1.1.1.1b.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1"><lt id="S3.Ex2.m1.6.6.1.1.1.1.1.4.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.4"></lt><cn type="integer" id="S3.Ex2.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.3">0</cn><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1"><times id="S3.Ex2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.2"></times><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3"><divide id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.2">1</cn><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1"><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3"><eq id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1"><times id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.3">𝕀</ci><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1"><eq id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply><apply id="S3.Ex2.m1.6.6.1.1.1.1.1c.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1"><lt id="S3.Ex2.m1.6.6.1.1.1.1.1.5.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.5"></lt><share href="#S3.Ex2.m1.6.6.1.1.1.1.1.1.cmml" id="S3.Ex2.m1.6.6.1.1.1.1.1d.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1"></share><ci id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3">𝛾</ci></apply></apply><apply id="S3.Ex2.m1.6.6.1.1.1.2.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.2.2.3a.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex2.m1.6.6.1.1.1.2.2.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.2.1.1"><lt id="S3.Ex2.m1.6.6.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.2.1.1.1"></lt><ci id="S3.Ex2.m1.4.4.cmml" xref="S3.Ex2.m1.4.4">𝑘</ci><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝐾</ci></apply><apply id="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2.2"><in id="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.1"></in><ci id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2">𝑘</ci><ci id="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.2.2.2.2.2">ℤ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.6c">C_{n}^{i}=\{k|0&lt;\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}{\mathbb{I}(y_{j}=k)}&lt;\gamma,k&lt;K,k\in\mathbb{Z}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table id="S3.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex3.m1.4" class="ltx_Math" alttext="C_{d}^{i}=\{k|\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}{\mathbb{I}(y_{j}=k)}\geq\gamma,k&lt;K,k\in\mathbb{Z}\}" display="block"><semantics id="S3.Ex3.m1.4a"><mrow id="S3.Ex3.m1.4.4" xref="S3.Ex3.m1.4.4.cmml"><msubsup id="S3.Ex3.m1.4.4.3" xref="S3.Ex3.m1.4.4.3.cmml"><mi id="S3.Ex3.m1.4.4.3.2.2" xref="S3.Ex3.m1.4.4.3.2.2.cmml">C</mi><mi id="S3.Ex3.m1.4.4.3.2.3" xref="S3.Ex3.m1.4.4.3.2.3.cmml">d</mi><mi id="S3.Ex3.m1.4.4.3.3" xref="S3.Ex3.m1.4.4.3.3.cmml">i</mi></msubsup><mo id="S3.Ex3.m1.4.4.2" xref="S3.Ex3.m1.4.4.2.cmml">=</mo><mrow id="S3.Ex3.m1.4.4.1.1" xref="S3.Ex3.m1.4.4.1.2.cmml"><mo stretchy="false" id="S3.Ex3.m1.4.4.1.1.2" xref="S3.Ex3.m1.4.4.1.2.1.cmml">{</mo><mi id="S3.Ex3.m1.3.3" xref="S3.Ex3.m1.3.3.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.4.4.1.1.3" xref="S3.Ex3.m1.4.4.1.2.1.cmml">|</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.3.cmml"><mrow id="S3.Ex3.m1.4.4.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.4.4.1.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.cmml"><mfrac id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.cmml"><mn id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.2.cmml">1</mn><msub id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.2.cmml">n</mi><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml">n</mi><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex3.m1.4.4.1.1.1.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.1.1.2.cmml">≥</mo><mi id="S3.Ex3.m1.4.4.1.1.1.1.1.3" xref="S3.Ex3.m1.4.4.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="S3.Ex3.m1.4.4.1.1.1.2.3" xref="S3.Ex3.m1.4.4.1.1.1.3a.cmml">,</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.2.2.2" xref="S3.Ex3.m1.4.4.1.1.1.2.2.3.cmml"><mrow id="S3.Ex3.m1.4.4.1.1.1.2.2.1.1" xref="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.cmml"><mi id="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.2" xref="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.2.cmml">k</mi><mo id="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.1" xref="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.1.cmml">&lt;</mo><mi id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml">K</mi></mrow><mo id="S3.Ex3.m1.4.4.1.1.1.2.2.2.3" xref="S3.Ex3.m1.4.4.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.Ex3.m1.4.4.1.1.1.2.2.2.2" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex3.m1.2.2" xref="S3.Ex3.m1.2.2.cmml">k</mi><mo id="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.1" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.1.cmml">∈</mo><mi id="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.2" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.2.cmml">ℤ</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex3.m1.4.4.1.1.4" xref="S3.Ex3.m1.4.4.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.4b"><apply id="S3.Ex3.m1.4.4.cmml" xref="S3.Ex3.m1.4.4"><eq id="S3.Ex3.m1.4.4.2.cmml" xref="S3.Ex3.m1.4.4.2"></eq><apply id="S3.Ex3.m1.4.4.3.cmml" xref="S3.Ex3.m1.4.4.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.3.1.cmml" xref="S3.Ex3.m1.4.4.3">superscript</csymbol><apply id="S3.Ex3.m1.4.4.3.2.cmml" xref="S3.Ex3.m1.4.4.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.3.2.1.cmml" xref="S3.Ex3.m1.4.4.3">subscript</csymbol><ci id="S3.Ex3.m1.4.4.3.2.2.cmml" xref="S3.Ex3.m1.4.4.3.2.2">𝐶</ci><ci id="S3.Ex3.m1.4.4.3.2.3.cmml" xref="S3.Ex3.m1.4.4.3.2.3">𝑑</ci></apply><ci id="S3.Ex3.m1.4.4.3.3.cmml" xref="S3.Ex3.m1.4.4.3.3">𝑖</ci></apply><apply id="S3.Ex3.m1.4.4.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.4.4.1.2.1.cmml" xref="S3.Ex3.m1.4.4.1.1.2">conditional-set</csymbol><ci id="S3.Ex3.m1.3.3.cmml" xref="S3.Ex3.m1.3.3">𝑘</ci><apply id="S3.Ex3.m1.4.4.1.1.1.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.3a.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1"><geq id="S3.Ex3.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.2"></geq><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1"><times id="S3.Ex3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.2"></times><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3"><divide id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.2">1</cn><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1"><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3"><eq id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.3">𝕀</ci><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1"><eq id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply><ci id="S3.Ex3.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.1.1.3">𝛾</ci></apply><apply id="S3.Ex3.m1.4.4.1.1.1.2.2.3.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.4.4.1.1.1.2.2.3a.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.1.1"><lt id="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.1"></lt><ci id="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.1.1.2">𝑘</ci><ci id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1">𝐾</ci></apply><apply id="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2.2"><in id="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.1"></in><ci id="S3.Ex3.m1.2.2.cmml" xref="S3.Ex3.m1.2.2">𝑘</ci><ci id="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex3.m1.4.4.1.1.1.2.2.2.2.2">ℤ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.4c">C_{d}^{i}=\{k|\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}{\mathbb{I}(y_{j}=k)}\geq\gamma,k&lt;K,k\in\mathbb{Z}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p">We train the t-CNN using FedAvg for 50 communication rounds and calculated the class-wise forgetting degree for each client across the communication rounds. To provide a more intuitive conclusion, we also visualize the data distribution. The results are presented in Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.5" class="ltx_p">Our findings suggest that the forgetting of each class is significantly influenced by the number of samples in that class. The forgetting degree <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\tau</annotation></semantics></math> of the non-dominant classes <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="k\in C_{n}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">k</mi><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">∈</mo><msub id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">C</mi><mi id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><in id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></in><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑘</ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">𝐶</ci><ci id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">k\in C_{n}</annotation></semantics></math> or the missing classes <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="k\in C_{m}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">k</mi><mo id="S3.SS1.p3.3.m3.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.cmml">∈</mo><msub id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.3.2.cmml">C</mi><mi id="S3.SS1.p3.3.m3.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><in id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1"></in><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑘</ci><apply id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.2">𝐶</ci><ci id="S3.SS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">k\in C_{m}</annotation></semantics></math> is always greater than 0 and close to 1, whereas the forgetting degree <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\tau</annotation></semantics></math> of the dominant classes <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="k\in C_{d}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mrow id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">k</mi><mo id="S3.SS1.p3.5.m5.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.cmml">∈</mo><msub id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.2" xref="S3.SS1.p3.5.m5.1.1.3.2.cmml">C</mi><mi id="S3.SS1.p3.5.m5.1.1.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.cmml">d</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><in id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1"></in><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">𝑘</ci><apply id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.2">𝐶</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">k\in C_{d}</annotation></semantics></math> is consistently negative. These observations suggest that the non-dominant or missing classes experience significant forgetting during local training, while dominant classes exhibit improvement in performance.</p>
</div>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x5.png" id="S3.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="161" height="161" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Reduction on the non-dominant class</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x6.png" id="S3.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="161" height="161" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Reduction on the dominant class</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Forgetting degrees of dominant and non-dominant classes under various label distributions. We dynamically discard several samples of the specified class to change its label distribution. In (a), we discard samples of class <math id="S3.F3.3.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.F3.3.m1.1b"><mn id="S3.F3.3.m1.1.1" xref="S3.F3.3.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.F3.3.m1.1c"><cn type="integer" id="S3.F3.3.m1.1.1.cmml" xref="S3.F3.3.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.m1.1d">1</annotation></semantics></math>, representing non-dominant classes, at communication rounds 50, 60, and 70, reducing the number of samples to 10, 5, and 0, respectively. In (b), we discard samples of class <math id="S3.F3.4.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.F3.4.m2.1b"><mn id="S3.F3.4.m2.1.1" xref="S3.F3.4.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.F3.4.m2.1c"><cn type="integer" id="S3.F3.4.m2.1.1.cmml" xref="S3.F3.4.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m2.1d">3</annotation></semantics></math>, representing dominant classes, after 50 communication rounds. The results demonstrate that reducing the number of samples has a trivial impact on the forgetting degree of non-dominant classes, indicating that clients cannot make full use of samples from these classes. However, reducing the number of samples from dominant classes significantly reduces the performance benefits obtained in local training, and catastrophic forgetting occurs when the number of samples falls below a certain threshold.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Forgetting under Various Label Distribution</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.2" class="ltx_p">After analyzing the above observation, we investigate how forgetting varies with different label distributions. One naive assumption is that the more samples a specific class has, the less severe the forgetting will be. However, the truth remains unclear. To validate this assumption, we adopt a strategy that dynamically reduces the sample number of a specific class <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">k</annotation></semantics></math> and observes the changes in its forgetting degree <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\tau^{k}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">τ</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝜏</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\tau^{k}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.17" class="ltx_p">We apply this strategy to class <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mn id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><cn type="integer" id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">1</annotation></semantics></math> and class <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><cn type="integer" id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">3</annotation></semantics></math> respectively on the client <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mn id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><cn type="integer" id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">0</cn></annotation-xml></semantics></math>, representing the sample number reduction on non-dominant and dominant classes. In our simulations, client <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mn id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><cn type="integer" id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">0</cn></annotation-xml></semantics></math> has nearly 5000 data samples, with the number of samples of class <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mn id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><cn type="integer" id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">3</annotation></semantics></math> close to <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><mn id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><cn type="integer" id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">1000</annotation></semantics></math>, while the number of samples of class <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><mn id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><cn type="integer" id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">1</annotation></semantics></math> is only about <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><mn id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><cn type="integer" id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">10</annotation></semantics></math>. For class <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><mn id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><cn type="integer" id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">3</annotation></semantics></math> representing dominant classes, we first train the federated model without any modification for 50 communication rounds to get a relatively stable state of the federated framework. After 50 communication rounds, we discard the data samples of class <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><mn id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><cn type="integer" id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">3</annotation></semantics></math>, which account for about <math id="S3.SS2.p2.11.m11.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S3.SS2.p2.11.m11.1a"><mrow id="S3.SS2.p2.11.m11.1.1" xref="S3.SS2.p2.11.m11.1.1.cmml"><mn id="S3.SS2.p2.11.m11.1.1.2" xref="S3.SS2.p2.11.m11.1.1.2.cmml">1</mn><mo id="S3.SS2.p2.11.m11.1.1.1" xref="S3.SS2.p2.11.m11.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.1b"><apply id="S3.SS2.p2.11.m11.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1"><csymbol cd="latexml" id="S3.SS2.p2.11.m11.1.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1.1">percent</csymbol><cn type="integer" id="S3.SS2.p2.11.m11.1.1.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.1c">1\%</annotation></semantics></math> of the total number of samples possessed by client <math id="S3.SS2.p2.12.m12.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p2.12.m12.1a"><mn id="S3.SS2.p2.12.m12.1.1" xref="S3.SS2.p2.12.m12.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m12.1b"><cn type="integer" id="S3.SS2.p2.12.m12.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1">0</cn></annotation-xml></semantics></math>, every ten rounds, so that the proportion of samples of class 3 in the total samples is gradually reduced from <math id="S3.SS2.p2.13.m13.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S3.SS2.p2.13.m13.1a"><mrow id="S3.SS2.p2.13.m13.1.1" xref="S3.SS2.p2.13.m13.1.1.cmml"><mn id="S3.SS2.p2.13.m13.1.1.2" xref="S3.SS2.p2.13.m13.1.1.2.cmml">20</mn><mo id="S3.SS2.p2.13.m13.1.1.1" xref="S3.SS2.p2.13.m13.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m13.1b"><apply id="S3.SS2.p2.13.m13.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1"><csymbol cd="latexml" id="S3.SS2.p2.13.m13.1.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1">percent</csymbol><cn type="integer" id="S3.SS2.p2.13.m13.1.1.2.cmml" xref="S3.SS2.p2.13.m13.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m13.1c">20\%</annotation></semantics></math> to <math id="S3.SS2.p2.14.m14.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S3.SS2.p2.14.m14.1a"><mrow id="S3.SS2.p2.14.m14.1.1" xref="S3.SS2.p2.14.m14.1.1.cmml"><mn id="S3.SS2.p2.14.m14.1.1.2" xref="S3.SS2.p2.14.m14.1.1.2.cmml">1</mn><mo id="S3.SS2.p2.14.m14.1.1.1" xref="S3.SS2.p2.14.m14.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m14.1b"><apply id="S3.SS2.p2.14.m14.1.1.cmml" xref="S3.SS2.p2.14.m14.1.1"><csymbol cd="latexml" id="S3.SS2.p2.14.m14.1.1.1.cmml" xref="S3.SS2.p2.14.m14.1.1.1">percent</csymbol><cn type="integer" id="S3.SS2.p2.14.m14.1.1.2.cmml" xref="S3.SS2.p2.14.m14.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m14.1c">1\%</annotation></semantics></math>. For the non-dominant class <math id="S3.SS2.p2.15.m15.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p2.15.m15.1a"><mn id="S3.SS2.p2.15.m15.1.1" xref="S3.SS2.p2.15.m15.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m15.1b"><cn type="integer" id="S3.SS2.p2.15.m15.1.1.cmml" xref="S3.SS2.p2.15.m15.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m15.1c">1</annotation></semantics></math>, we discard the sample number to <math id="S3.SS2.p2.16.m16.3" class="ltx_Math" alttext="10,5,0" display="inline"><semantics id="S3.SS2.p2.16.m16.3a"><mrow id="S3.SS2.p2.16.m16.3.4.2" xref="S3.SS2.p2.16.m16.3.4.1.cmml"><mn id="S3.SS2.p2.16.m16.1.1" xref="S3.SS2.p2.16.m16.1.1.cmml">10</mn><mo id="S3.SS2.p2.16.m16.3.4.2.1" xref="S3.SS2.p2.16.m16.3.4.1.cmml">,</mo><mn id="S3.SS2.p2.16.m16.2.2" xref="S3.SS2.p2.16.m16.2.2.cmml">5</mn><mo id="S3.SS2.p2.16.m16.3.4.2.2" xref="S3.SS2.p2.16.m16.3.4.1.cmml">,</mo><mn id="S3.SS2.p2.16.m16.3.3" xref="S3.SS2.p2.16.m16.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.16.m16.3b"><list id="S3.SS2.p2.16.m16.3.4.1.cmml" xref="S3.SS2.p2.16.m16.3.4.2"><cn type="integer" id="S3.SS2.p2.16.m16.1.1.cmml" xref="S3.SS2.p2.16.m16.1.1">10</cn><cn type="integer" id="S3.SS2.p2.16.m16.2.2.cmml" xref="S3.SS2.p2.16.m16.2.2">5</cn><cn type="integer" id="S3.SS2.p2.16.m16.3.3.cmml" xref="S3.SS2.p2.16.m16.3.3">0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.16.m16.3c">10,5,0</annotation></semantics></math> respectively at the communication round <math id="S3.SS2.p2.17.m17.3" class="ltx_Math" alttext="50,60,70" display="inline"><semantics id="S3.SS2.p2.17.m17.3a"><mrow id="S3.SS2.p2.17.m17.3.4.2" xref="S3.SS2.p2.17.m17.3.4.1.cmml"><mn id="S3.SS2.p2.17.m17.1.1" xref="S3.SS2.p2.17.m17.1.1.cmml">50</mn><mo id="S3.SS2.p2.17.m17.3.4.2.1" xref="S3.SS2.p2.17.m17.3.4.1.cmml">,</mo><mn id="S3.SS2.p2.17.m17.2.2" xref="S3.SS2.p2.17.m17.2.2.cmml">60</mn><mo id="S3.SS2.p2.17.m17.3.4.2.2" xref="S3.SS2.p2.17.m17.3.4.1.cmml">,</mo><mn id="S3.SS2.p2.17.m17.3.3" xref="S3.SS2.p2.17.m17.3.3.cmml">70</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.17.m17.3b"><list id="S3.SS2.p2.17.m17.3.4.1.cmml" xref="S3.SS2.p2.17.m17.3.4.2"><cn type="integer" id="S3.SS2.p2.17.m17.1.1.cmml" xref="S3.SS2.p2.17.m17.1.1">50</cn><cn type="integer" id="S3.SS2.p2.17.m17.2.2.cmml" xref="S3.SS2.p2.17.m17.2.2">60</cn><cn type="integer" id="S3.SS2.p2.17.m17.3.3.cmml" xref="S3.SS2.p2.17.m17.3.3">70</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.17.m17.3c">50,60,70</annotation></semantics></math>. We display the results in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.1 Class-wise Forgetting in Local Models ‣ 3 Forgetting on Non-dominant and Missing Classes. ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">Strikingly, the results indicate a sharp contrast in the effect of sample reduction on dominant and non-dominant classes. In the case of non-dominant classes, the forgetting rate slightly increases following the reduction in the 50th communication round but subsequently decreases to an even lower rate that is similar to the unmodified level. In contrast, for the dominant class, sample reduction leads to a significant decrease in knowledge acquisition during local training, resulting in a sharp increase in the forgetting rate. Furthermore, when the proportion of the dominant class is reduced to 5%, catastrophic forgetting suddenly occurs.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.1" class="ltx_p">Based on our findings, we conclude that local models in federated learning cannot adequately utilize limited samples to prevent forgetting, resulting in similar forgetting rates in non-dominant classes and catastrophic forgetting in dominant classes.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2312.02416/assets/x7.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="156" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The overall framework of Federated Knowledge Anchor (FedKA). FedKA mandates all clients to build a minimal shared dataset comprising one sample for each class before training. Then, in each local training stage of different communication rounds, clients construct their own knowledge anchors based on their data distribution. The knowledge anchor comprises one sample for each dominant and missing class and is utilized to adjust the mini-batch gradients in the direction of preserving knowledge on non-dominant and missing classes.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>FedKA: Federated Knowledge Anchor</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">In this section, we propose Federated Knowledge Anchor (FedKA). The core idea of FedKA is to utilize a minimal subset of the global data distribution as anchor points to force the local model to preserve the knowledge of non-dominant and missing classes. Through the construction and the utilization of the knowledge anchor, the local model can make full use of the few samples possessed by the non-dominant classes and mitigate the catastrophic forgetting caused by missing samples of specific classes.</p>
</div>
<div id="Thmdefinition2" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmdefinition2.1.1.1" class="ltx_text ltx_font_bold">Definition 2</span></span><span id="Thmdefinition2.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmdefinition2.p1" class="ltx_para ltx_noindent">
<p id="Thmdefinition2.p1.8" class="ltx_p"><span id="Thmdefinition2.p1.8.8" class="ltx_text ltx_font_italic">Consider a client <math id="Thmdefinition2.p1.1.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="Thmdefinition2.p1.1.1.m1.1a"><msub id="Thmdefinition2.p1.1.1.m1.1.1" xref="Thmdefinition2.p1.1.1.m1.1.1.cmml"><mi id="Thmdefinition2.p1.1.1.m1.1.1.2" xref="Thmdefinition2.p1.1.1.m1.1.1.2.cmml">c</mi><mi id="Thmdefinition2.p1.1.1.m1.1.1.3" xref="Thmdefinition2.p1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.1.1.m1.1b"><apply id="Thmdefinition2.p1.1.1.m1.1.1.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.2">𝑐</ci><ci id="Thmdefinition2.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition2.p1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.1.1.m1.1c">c_{i}</annotation></semantics></math> with its dominant, non-dominant, missing classes <math id="Thmdefinition2.p1.2.2.m2.1" class="ltx_Math" alttext="C_{d}^{i}" display="inline"><semantics id="Thmdefinition2.p1.2.2.m2.1a"><msubsup id="Thmdefinition2.p1.2.2.m2.1.1" xref="Thmdefinition2.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition2.p1.2.2.m2.1.1.2.2" xref="Thmdefinition2.p1.2.2.m2.1.1.2.2.cmml">C</mi><mi id="Thmdefinition2.p1.2.2.m2.1.1.2.3" xref="Thmdefinition2.p1.2.2.m2.1.1.2.3.cmml">d</mi><mi id="Thmdefinition2.p1.2.2.m2.1.1.3" xref="Thmdefinition2.p1.2.2.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.2.2.m2.1b"><apply id="Thmdefinition2.p1.2.2.m2.1.1.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1">superscript</csymbol><apply id="Thmdefinition2.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.2.2.m2.1.1.2.1.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.2.2.m2.1.1.2.2.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1.2.2">𝐶</ci><ci id="Thmdefinition2.p1.2.2.m2.1.1.2.3.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1.2.3">𝑑</ci></apply><ci id="Thmdefinition2.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition2.p1.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.2.2.m2.1c">C_{d}^{i}</annotation></semantics></math>, <math id="Thmdefinition2.p1.3.3.m3.1" class="ltx_Math" alttext="C_{n}^{i}" display="inline"><semantics id="Thmdefinition2.p1.3.3.m3.1a"><msubsup id="Thmdefinition2.p1.3.3.m3.1.1" xref="Thmdefinition2.p1.3.3.m3.1.1.cmml"><mi id="Thmdefinition2.p1.3.3.m3.1.1.2.2" xref="Thmdefinition2.p1.3.3.m3.1.1.2.2.cmml">C</mi><mi id="Thmdefinition2.p1.3.3.m3.1.1.2.3" xref="Thmdefinition2.p1.3.3.m3.1.1.2.3.cmml">n</mi><mi id="Thmdefinition2.p1.3.3.m3.1.1.3" xref="Thmdefinition2.p1.3.3.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.3.3.m3.1b"><apply id="Thmdefinition2.p1.3.3.m3.1.1.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.3.3.m3.1.1.1.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1">superscript</csymbol><apply id="Thmdefinition2.p1.3.3.m3.1.1.2.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.3.3.m3.1.1.2.1.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.3.3.m3.1.1.2.2.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.2.2">𝐶</ci><ci id="Thmdefinition2.p1.3.3.m3.1.1.2.3.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.2.3">𝑛</ci></apply><ci id="Thmdefinition2.p1.3.3.m3.1.1.3.cmml" xref="Thmdefinition2.p1.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.3.3.m3.1c">C_{n}^{i}</annotation></semantics></math> and <math id="Thmdefinition2.p1.4.4.m4.1" class="ltx_Math" alttext="C_{m}^{i}" display="inline"><semantics id="Thmdefinition2.p1.4.4.m4.1a"><msubsup id="Thmdefinition2.p1.4.4.m4.1.1" xref="Thmdefinition2.p1.4.4.m4.1.1.cmml"><mi id="Thmdefinition2.p1.4.4.m4.1.1.2.2" xref="Thmdefinition2.p1.4.4.m4.1.1.2.2.cmml">C</mi><mi id="Thmdefinition2.p1.4.4.m4.1.1.2.3" xref="Thmdefinition2.p1.4.4.m4.1.1.2.3.cmml">m</mi><mi id="Thmdefinition2.p1.4.4.m4.1.1.3" xref="Thmdefinition2.p1.4.4.m4.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.4.4.m4.1b"><apply id="Thmdefinition2.p1.4.4.m4.1.1.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.4.4.m4.1.1.1.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1">superscript</csymbol><apply id="Thmdefinition2.p1.4.4.m4.1.1.2.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.4.4.m4.1.1.2.1.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.4.4.m4.1.1.2.2.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1.2.2">𝐶</ci><ci id="Thmdefinition2.p1.4.4.m4.1.1.2.3.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1.2.3">𝑚</ci></apply><ci id="Thmdefinition2.p1.4.4.m4.1.1.3.cmml" xref="Thmdefinition2.p1.4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.4.4.m4.1c">C_{m}^{i}</annotation></semantics></math> in federated learning. Assume all clients share a minimal dataset <math id="Thmdefinition2.p1.5.5.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="Thmdefinition2.p1.5.5.m5.1a"><mi id="Thmdefinition2.p1.5.5.m5.1.1" xref="Thmdefinition2.p1.5.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.5.5.m5.1b"><ci id="Thmdefinition2.p1.5.5.m5.1.1.cmml" xref="Thmdefinition2.p1.5.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.5.5.m5.1c">S</annotation></semantics></math> which possesses one single sample per class for the <math id="Thmdefinition2.p1.6.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Thmdefinition2.p1.6.6.m6.1a"><mi id="Thmdefinition2.p1.6.6.m6.1.1" xref="Thmdefinition2.p1.6.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.6.6.m6.1b"><ci id="Thmdefinition2.p1.6.6.m6.1.1.cmml" xref="Thmdefinition2.p1.6.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.6.6.m6.1c">K</annotation></semantics></math>-class classification problem and <math id="Thmdefinition2.p1.7.7.m7.1" class="ltx_Math" alttext="|\mathcal{S}|=K" display="inline"><semantics id="Thmdefinition2.p1.7.7.m7.1a"><mrow id="Thmdefinition2.p1.7.7.m7.1.2" xref="Thmdefinition2.p1.7.7.m7.1.2.cmml"><mrow id="Thmdefinition2.p1.7.7.m7.1.2.2.2" xref="Thmdefinition2.p1.7.7.m7.1.2.2.1.cmml"><mo stretchy="false" id="Thmdefinition2.p1.7.7.m7.1.2.2.2.1" xref="Thmdefinition2.p1.7.7.m7.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Thmdefinition2.p1.7.7.m7.1.1" xref="Thmdefinition2.p1.7.7.m7.1.1.cmml">𝒮</mi><mo stretchy="false" id="Thmdefinition2.p1.7.7.m7.1.2.2.2.2" xref="Thmdefinition2.p1.7.7.m7.1.2.2.1.1.cmml">|</mo></mrow><mo id="Thmdefinition2.p1.7.7.m7.1.2.1" xref="Thmdefinition2.p1.7.7.m7.1.2.1.cmml">=</mo><mi id="Thmdefinition2.p1.7.7.m7.1.2.3" xref="Thmdefinition2.p1.7.7.m7.1.2.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.7.7.m7.1b"><apply id="Thmdefinition2.p1.7.7.m7.1.2.cmml" xref="Thmdefinition2.p1.7.7.m7.1.2"><eq id="Thmdefinition2.p1.7.7.m7.1.2.1.cmml" xref="Thmdefinition2.p1.7.7.m7.1.2.1"></eq><apply id="Thmdefinition2.p1.7.7.m7.1.2.2.1.cmml" xref="Thmdefinition2.p1.7.7.m7.1.2.2.2"><abs id="Thmdefinition2.p1.7.7.m7.1.2.2.1.1.cmml" xref="Thmdefinition2.p1.7.7.m7.1.2.2.2.1"></abs><ci id="Thmdefinition2.p1.7.7.m7.1.1.cmml" xref="Thmdefinition2.p1.7.7.m7.1.1">𝒮</ci></apply><ci id="Thmdefinition2.p1.7.7.m7.1.2.3.cmml" xref="Thmdefinition2.p1.7.7.m7.1.2.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.7.7.m7.1c">|\mathcal{S}|=K</annotation></semantics></math>. The knowledge anchor of client <math id="Thmdefinition2.p1.8.8.m8.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="Thmdefinition2.p1.8.8.m8.1a"><msub id="Thmdefinition2.p1.8.8.m8.1.1" xref="Thmdefinition2.p1.8.8.m8.1.1.cmml"><mi id="Thmdefinition2.p1.8.8.m8.1.1.2" xref="Thmdefinition2.p1.8.8.m8.1.1.2.cmml">c</mi><mi id="Thmdefinition2.p1.8.8.m8.1.1.3" xref="Thmdefinition2.p1.8.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition2.p1.8.8.m8.1b"><apply id="Thmdefinition2.p1.8.8.m8.1.1.cmml" xref="Thmdefinition2.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmdefinition2.p1.8.8.m8.1.1.1.cmml" xref="Thmdefinition2.p1.8.8.m8.1.1">subscript</csymbol><ci id="Thmdefinition2.p1.8.8.m8.1.1.2.cmml" xref="Thmdefinition2.p1.8.8.m8.1.1.2">𝑐</ci><ci id="Thmdefinition2.p1.8.8.m8.1.1.3.cmml" xref="Thmdefinition2.p1.8.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition2.p1.8.8.m8.1c">c_{i}</annotation></semantics></math> is:</span></p>
</div>
<div id="Thmdefinition2.p2" class="ltx_para">
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.4" class="ltx_Math" alttext="\mathcal{T}_{i}=\{\psi(k,\mathcal{D}_{i},\mathcal{S})|k\in C_{m}^{i}\cup C_{n}^{i}\}" display="block"><semantics id="S4.E2.m1.4a"><mrow id="S4.E2.m1.4.4" xref="S4.E2.m1.4.4.cmml"><msub id="S4.E2.m1.4.4.4" xref="S4.E2.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.4.4.4.2" xref="S4.E2.m1.4.4.4.2.cmml">𝒯</mi><mi id="S4.E2.m1.4.4.4.3" xref="S4.E2.m1.4.4.4.3.cmml">i</mi></msub><mo id="S4.E2.m1.4.4.3" xref="S4.E2.m1.4.4.3.cmml">=</mo><mrow id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.3.cmml"><mo stretchy="false" id="S4.E2.m1.4.4.2.2.3" xref="S4.E2.m1.4.4.2.3.1.cmml">{</mo><mrow id="S4.E2.m1.3.3.1.1.1" xref="S4.E2.m1.3.3.1.1.1.cmml"><mi id="S4.E2.m1.3.3.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.3.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.3.3.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E2.m1.3.3.1.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">k</mi><mo id="S4.E2.m1.3.3.1.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml">,</mo><msub id="S4.E2.m1.3.3.1.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.3.3.1.1.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.E2.m1.3.3.1.1.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E2.m1.3.3.1.1.1.1.1.4" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml">𝒮</mi><mo stretchy="false" id="S4.E2.m1.3.3.1.1.1.1.1.5" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.2.2.4" xref="S4.E2.m1.4.4.2.3.1.cmml">|</mo><mrow id="S4.E2.m1.4.4.2.2.2" xref="S4.E2.m1.4.4.2.2.2.cmml"><mi id="S4.E2.m1.4.4.2.2.2.2" xref="S4.E2.m1.4.4.2.2.2.2.cmml">k</mi><mo id="S4.E2.m1.4.4.2.2.2.1" xref="S4.E2.m1.4.4.2.2.2.1.cmml">∈</mo><mrow id="S4.E2.m1.4.4.2.2.2.3" xref="S4.E2.m1.4.4.2.2.2.3.cmml"><msubsup id="S4.E2.m1.4.4.2.2.2.3.2" xref="S4.E2.m1.4.4.2.2.2.3.2.cmml"><mi id="S4.E2.m1.4.4.2.2.2.3.2.2.2" xref="S4.E2.m1.4.4.2.2.2.3.2.2.2.cmml">C</mi><mi id="S4.E2.m1.4.4.2.2.2.3.2.2.3" xref="S4.E2.m1.4.4.2.2.2.3.2.2.3.cmml">m</mi><mi id="S4.E2.m1.4.4.2.2.2.3.2.3" xref="S4.E2.m1.4.4.2.2.2.3.2.3.cmml">i</mi></msubsup><mo id="S4.E2.m1.4.4.2.2.2.3.1" xref="S4.E2.m1.4.4.2.2.2.3.1.cmml">∪</mo><msubsup id="S4.E2.m1.4.4.2.2.2.3.3" xref="S4.E2.m1.4.4.2.2.2.3.3.cmml"><mi id="S4.E2.m1.4.4.2.2.2.3.3.2.2" xref="S4.E2.m1.4.4.2.2.2.3.3.2.2.cmml">C</mi><mi id="S4.E2.m1.4.4.2.2.2.3.3.2.3" xref="S4.E2.m1.4.4.2.2.2.3.3.2.3.cmml">n</mi><mi id="S4.E2.m1.4.4.2.2.2.3.3.3" xref="S4.E2.m1.4.4.2.2.2.3.3.3.cmml">i</mi></msubsup></mrow></mrow><mo stretchy="false" id="S4.E2.m1.4.4.2.2.5" xref="S4.E2.m1.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.4b"><apply id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4"><eq id="S4.E2.m1.4.4.3.cmml" xref="S4.E2.m1.4.4.3"></eq><apply id="S4.E2.m1.4.4.4.cmml" xref="S4.E2.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.4.1.cmml" xref="S4.E2.m1.4.4.4">subscript</csymbol><ci id="S4.E2.m1.4.4.4.2.cmml" xref="S4.E2.m1.4.4.4.2">𝒯</ci><ci id="S4.E2.m1.4.4.4.3.cmml" xref="S4.E2.m1.4.4.4.3">𝑖</ci></apply><apply id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.2"><csymbol cd="latexml" id="S4.E2.m1.4.4.2.3.1.cmml" xref="S4.E2.m1.4.4.2.2.3">conditional-set</csymbol><apply id="S4.E2.m1.3.3.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1"><times id="S4.E2.m1.3.3.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.2"></times><ci id="S4.E2.m1.3.3.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.3">𝜓</ci><vector id="S4.E2.m1.3.3.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1"><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝑘</ci><apply id="S4.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.2">𝒟</ci><ci id="S4.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2">𝒮</ci></vector></apply><apply id="S4.E2.m1.4.4.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2"><in id="S4.E2.m1.4.4.2.2.2.1.cmml" xref="S4.E2.m1.4.4.2.2.2.1"></in><ci id="S4.E2.m1.4.4.2.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.2">𝑘</ci><apply id="S4.E2.m1.4.4.2.2.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.3"><union id="S4.E2.m1.4.4.2.2.2.3.1.cmml" xref="S4.E2.m1.4.4.2.2.2.3.1"></union><apply id="S4.E2.m1.4.4.2.2.2.3.2.cmml" xref="S4.E2.m1.4.4.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.2.3.2.1.cmml" xref="S4.E2.m1.4.4.2.2.2.3.2">superscript</csymbol><apply id="S4.E2.m1.4.4.2.2.2.3.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.2.3.2.2.1.cmml" xref="S4.E2.m1.4.4.2.2.2.3.2">subscript</csymbol><ci id="S4.E2.m1.4.4.2.2.2.3.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.3.2.2.2">𝐶</ci><ci id="S4.E2.m1.4.4.2.2.2.3.2.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.3.2.2.3">𝑚</ci></apply><ci id="S4.E2.m1.4.4.2.2.2.3.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.3.2.3">𝑖</ci></apply><apply id="S4.E2.m1.4.4.2.2.2.3.3.cmml" xref="S4.E2.m1.4.4.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.2.3.3.1.cmml" xref="S4.E2.m1.4.4.2.2.2.3.3">superscript</csymbol><apply id="S4.E2.m1.4.4.2.2.2.3.3.2.cmml" xref="S4.E2.m1.4.4.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.2.3.3.2.1.cmml" xref="S4.E2.m1.4.4.2.2.2.3.3">subscript</csymbol><ci id="S4.E2.m1.4.4.2.2.2.3.3.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.3.3.2.2">𝐶</ci><ci id="S4.E2.m1.4.4.2.2.2.3.3.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.3.3.2.3">𝑛</ci></apply><ci id="S4.E2.m1.4.4.2.2.2.3.3.3.cmml" xref="S4.E2.m1.4.4.2.2.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.4c">\mathcal{T}_{i}=\{\psi(k,\mathcal{D}_{i},\mathcal{S})|k\in C_{m}^{i}\cup C_{n}^{i}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Thmdefinition2.p2.1" class="ltx_p"><span id="Thmdefinition2.p2.1.1" class="ltx_text ltx_font_italic">, where</span></p>
<table id="S4.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex4.m1.13" class="ltx_Math" alttext="\psi(k,\mathcal{D}_{i},\mathcal{S})=\left\{\begin{array}[]{lcl}(\boldsymbol{x},y)\sim D_{i}^{k}&amp;&{k\in C_{n}^{i}}\\
(\boldsymbol{x},y)\sim\{(\boldsymbol{x},y)|(\boldsymbol{x},y)\in\mathcal{S},y=k\}&amp;&{k\in C_{m}^{i}}\\
\end{array}\right." display="block"><semantics id="S4.Ex4.m1.13a"><mrow id="S4.Ex4.m1.13.13" xref="S4.Ex4.m1.13.13.cmml"><mrow id="S4.Ex4.m1.13.13.1" xref="S4.Ex4.m1.13.13.1.cmml"><mi id="S4.Ex4.m1.13.13.1.3" xref="S4.Ex4.m1.13.13.1.3.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.13.13.1.2" xref="S4.Ex4.m1.13.13.1.2.cmml">​</mo><mrow id="S4.Ex4.m1.13.13.1.1.1" xref="S4.Ex4.m1.13.13.1.1.2.cmml"><mo stretchy="false" id="S4.Ex4.m1.13.13.1.1.1.2" xref="S4.Ex4.m1.13.13.1.1.2.cmml">(</mo><mi id="S4.Ex4.m1.11.11" xref="S4.Ex4.m1.11.11.cmml">k</mi><mo id="S4.Ex4.m1.13.13.1.1.1.3" xref="S4.Ex4.m1.13.13.1.1.2.cmml">,</mo><msub id="S4.Ex4.m1.13.13.1.1.1.1" xref="S4.Ex4.m1.13.13.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m1.13.13.1.1.1.1.2" xref="S4.Ex4.m1.13.13.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.Ex4.m1.13.13.1.1.1.1.3" xref="S4.Ex4.m1.13.13.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex4.m1.13.13.1.1.1.4" xref="S4.Ex4.m1.13.13.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m1.12.12" xref="S4.Ex4.m1.12.12.cmml">𝒮</mi><mo stretchy="false" id="S4.Ex4.m1.13.13.1.1.1.5" xref="S4.Ex4.m1.13.13.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex4.m1.13.13.2" xref="S4.Ex4.m1.13.13.2.cmml">=</mo><mrow id="S4.Ex4.m1.13.13.3.2" xref="S4.Ex4.m1.13.13.3.1.cmml"><mo id="S4.Ex4.m1.13.13.3.2.1" xref="S4.Ex4.m1.13.13.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.Ex4.m1.10.10" xref="S4.Ex4.m1.10.10.cmml"><mtr id="S4.Ex4.m1.10.10a" xref="S4.Ex4.m1.10.10.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.Ex4.m1.10.10b" xref="S4.Ex4.m1.10.10.cmml"><mrow id="S4.Ex4.m1.2.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.2.cmml"><mrow id="S4.Ex4.m1.2.2.2.2.2.4.2" xref="S4.Ex4.m1.2.2.2.2.2.4.1.cmml"><mo stretchy="false" id="S4.Ex4.m1.2.2.2.2.2.4.2.1" xref="S4.Ex4.m1.2.2.2.2.2.4.1.cmml">(</mo><mi id="S4.Ex4.m1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.cmml">𝒙</mi><mo id="S4.Ex4.m1.2.2.2.2.2.4.2.2" xref="S4.Ex4.m1.2.2.2.2.2.4.1.cmml">,</mo><mi id="S4.Ex4.m1.2.2.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.Ex4.m1.2.2.2.2.2.4.2.3" xref="S4.Ex4.m1.2.2.2.2.2.4.1.cmml">)</mo></mrow><mo id="S4.Ex4.m1.2.2.2.2.2.3" xref="S4.Ex4.m1.2.2.2.2.2.3.cmml">∼</mo><msubsup id="S4.Ex4.m1.2.2.2.2.2.5" xref="S4.Ex4.m1.2.2.2.2.2.5.cmml"><mi id="S4.Ex4.m1.2.2.2.2.2.5.2.2" xref="S4.Ex4.m1.2.2.2.2.2.5.2.2.cmml">D</mi><mi id="S4.Ex4.m1.2.2.2.2.2.5.2.3" xref="S4.Ex4.m1.2.2.2.2.2.5.2.3.cmml">i</mi><mi id="S4.Ex4.m1.2.2.2.2.2.5.3" xref="S4.Ex4.m1.2.2.2.2.2.5.3.cmml">k</mi></msubsup></mrow></mtd><mtd id="S4.Ex4.m1.10.10c" xref="S4.Ex4.m1.10.10.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.Ex4.m1.10.10d" xref="S4.Ex4.m1.10.10.cmml"><mrow id="S4.Ex4.m1.2.2.2.4.1" xref="S4.Ex4.m1.2.2.2.4.1.cmml"><mi id="S4.Ex4.m1.2.2.2.4.1.2" xref="S4.Ex4.m1.2.2.2.4.1.2.cmml">k</mi><mo id="S4.Ex4.m1.2.2.2.4.1.1" xref="S4.Ex4.m1.2.2.2.4.1.1.cmml">∈</mo><msubsup id="S4.Ex4.m1.2.2.2.4.1.3" xref="S4.Ex4.m1.2.2.2.4.1.3.cmml"><mi id="S4.Ex4.m1.2.2.2.4.1.3.2.2" xref="S4.Ex4.m1.2.2.2.4.1.3.2.2.cmml">C</mi><mi id="S4.Ex4.m1.2.2.2.4.1.3.2.3" xref="S4.Ex4.m1.2.2.2.4.1.3.2.3.cmml">n</mi><mi id="S4.Ex4.m1.2.2.2.4.1.3.3" xref="S4.Ex4.m1.2.2.2.4.1.3.3.cmml">i</mi></msubsup></mrow></mtd></mtr><mtr id="S4.Ex4.m1.10.10e" xref="S4.Ex4.m1.10.10.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.Ex4.m1.10.10f" xref="S4.Ex4.m1.10.10.cmml"><mrow id="S4.Ex4.m1.10.10.10.8.8" xref="S4.Ex4.m1.10.10.10.8.8.cmml"><mrow id="S4.Ex4.m1.10.10.10.8.8.10.2" xref="S4.Ex4.m1.10.10.10.8.8.10.1.cmml"><mo stretchy="false" id="S4.Ex4.m1.10.10.10.8.8.10.2.1" xref="S4.Ex4.m1.10.10.10.8.8.10.1.cmml">(</mo><mi id="S4.Ex4.m1.3.3.3.1.1.1" xref="S4.Ex4.m1.3.3.3.1.1.1.cmml">𝒙</mi><mo id="S4.Ex4.m1.10.10.10.8.8.10.2.2" xref="S4.Ex4.m1.10.10.10.8.8.10.1.cmml">,</mo><mi id="S4.Ex4.m1.4.4.4.2.2.2" xref="S4.Ex4.m1.4.4.4.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.Ex4.m1.10.10.10.8.8.10.2.3" xref="S4.Ex4.m1.10.10.10.8.8.10.1.cmml">)</mo></mrow><mo id="S4.Ex4.m1.10.10.10.8.8.9" xref="S4.Ex4.m1.10.10.10.8.8.9.cmml">∼</mo><mrow id="S4.Ex4.m1.10.10.10.8.8.8.2" xref="S4.Ex4.m1.10.10.10.8.8.8.3.cmml"><mo stretchy="false" id="S4.Ex4.m1.10.10.10.8.8.8.2.3" xref="S4.Ex4.m1.10.10.10.8.8.8.3.1.cmml">{</mo><mrow id="S4.Ex4.m1.9.9.9.7.7.7.1.1.2" xref="S4.Ex4.m1.9.9.9.7.7.7.1.1.1.cmml"><mo stretchy="false" id="S4.Ex4.m1.9.9.9.7.7.7.1.1.2.1" xref="S4.Ex4.m1.9.9.9.7.7.7.1.1.1.cmml">(</mo><mi id="S4.Ex4.m1.5.5.5.3.3.3" xref="S4.Ex4.m1.5.5.5.3.3.3.cmml">𝒙</mi><mo id="S4.Ex4.m1.9.9.9.7.7.7.1.1.2.2" xref="S4.Ex4.m1.9.9.9.7.7.7.1.1.1.cmml">,</mo><mi id="S4.Ex4.m1.6.6.6.4.4.4" xref="S4.Ex4.m1.6.6.6.4.4.4.cmml">y</mi><mo stretchy="false" id="S4.Ex4.m1.9.9.9.7.7.7.1.1.2.3" xref="S4.Ex4.m1.9.9.9.7.7.7.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.10.10.10.8.8.8.2.4" xref="S4.Ex4.m1.10.10.10.8.8.8.3.1.cmml">|</mo><mrow id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.3.cmml"><mrow id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.cmml"><mrow id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.2" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.2.1" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.1.cmml">(</mo><mi id="S4.Ex4.m1.7.7.7.5.5.5" xref="S4.Ex4.m1.7.7.7.5.5.5.cmml">𝒙</mi><mo id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.2.2" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.1.cmml">,</mo><mi id="S4.Ex4.m1.8.8.8.6.6.6" xref="S4.Ex4.m1.8.8.8.6.6.6.cmml">y</mi><mo stretchy="false" id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.2.3" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.1.cmml">)</mo></mrow><mo id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.1" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.3" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.3.cmml">𝒮</mi></mrow><mo id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.3" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.3a.cmml">,</mo><mrow id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.cmml"><mi id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.2" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.2.cmml">y</mi><mo id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.1" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.1.cmml">=</mo><mi id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.3" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S4.Ex4.m1.10.10.10.8.8.8.2.5" xref="S4.Ex4.m1.10.10.10.8.8.8.3.1.cmml">}</mo></mrow></mrow></mtd><mtd id="S4.Ex4.m1.10.10g" xref="S4.Ex4.m1.10.10.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.Ex4.m1.10.10h" xref="S4.Ex4.m1.10.10.cmml"><mrow id="S4.Ex4.m1.10.10.10.10.1" xref="S4.Ex4.m1.10.10.10.10.1.cmml"><mi id="S4.Ex4.m1.10.10.10.10.1.2" xref="S4.Ex4.m1.10.10.10.10.1.2.cmml">k</mi><mo id="S4.Ex4.m1.10.10.10.10.1.1" xref="S4.Ex4.m1.10.10.10.10.1.1.cmml">∈</mo><msubsup id="S4.Ex4.m1.10.10.10.10.1.3" xref="S4.Ex4.m1.10.10.10.10.1.3.cmml"><mi id="S4.Ex4.m1.10.10.10.10.1.3.2.2" xref="S4.Ex4.m1.10.10.10.10.1.3.2.2.cmml">C</mi><mi id="S4.Ex4.m1.10.10.10.10.1.3.2.3" xref="S4.Ex4.m1.10.10.10.10.1.3.2.3.cmml">m</mi><mi id="S4.Ex4.m1.10.10.10.10.1.3.3" xref="S4.Ex4.m1.10.10.10.10.1.3.3.cmml">i</mi></msubsup></mrow></mtd></mtr></mtable><mi id="S4.Ex4.m1.13.13.3.2.2" xref="S4.Ex4.m1.13.13.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.13b"><apply id="S4.Ex4.m1.13.13.cmml" xref="S4.Ex4.m1.13.13"><eq id="S4.Ex4.m1.13.13.2.cmml" xref="S4.Ex4.m1.13.13.2"></eq><apply id="S4.Ex4.m1.13.13.1.cmml" xref="S4.Ex4.m1.13.13.1"><times id="S4.Ex4.m1.13.13.1.2.cmml" xref="S4.Ex4.m1.13.13.1.2"></times><ci id="S4.Ex4.m1.13.13.1.3.cmml" xref="S4.Ex4.m1.13.13.1.3">𝜓</ci><vector id="S4.Ex4.m1.13.13.1.1.2.cmml" xref="S4.Ex4.m1.13.13.1.1.1"><ci id="S4.Ex4.m1.11.11.cmml" xref="S4.Ex4.m1.11.11">𝑘</ci><apply id="S4.Ex4.m1.13.13.1.1.1.1.cmml" xref="S4.Ex4.m1.13.13.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.13.13.1.1.1.1.1.cmml" xref="S4.Ex4.m1.13.13.1.1.1.1">subscript</csymbol><ci id="S4.Ex4.m1.13.13.1.1.1.1.2.cmml" xref="S4.Ex4.m1.13.13.1.1.1.1.2">𝒟</ci><ci id="S4.Ex4.m1.13.13.1.1.1.1.3.cmml" xref="S4.Ex4.m1.13.13.1.1.1.1.3">𝑖</ci></apply><ci id="S4.Ex4.m1.12.12.cmml" xref="S4.Ex4.m1.12.12">𝒮</ci></vector></apply><apply id="S4.Ex4.m1.13.13.3.1.cmml" xref="S4.Ex4.m1.13.13.3.2"><csymbol cd="latexml" id="S4.Ex4.m1.13.13.3.1.1.cmml" xref="S4.Ex4.m1.13.13.3.2.1">cases</csymbol><matrix id="S4.Ex4.m1.10.10.cmml" xref="S4.Ex4.m1.10.10"><matrixrow id="S4.Ex4.m1.10.10a.cmml" xref="S4.Ex4.m1.10.10"><apply id="S4.Ex4.m1.2.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.2.2.2"><csymbol cd="latexml" id="S4.Ex4.m1.2.2.2.2.2.3.cmml" xref="S4.Ex4.m1.2.2.2.2.2.3">similar-to</csymbol><interval closure="open" id="S4.Ex4.m1.2.2.2.2.2.4.1.cmml" xref="S4.Ex4.m1.2.2.2.2.2.4.2"><ci id="S4.Ex4.m1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1">𝒙</ci><ci id="S4.Ex4.m1.2.2.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.2.2.2.2">𝑦</ci></interval><apply id="S4.Ex4.m1.2.2.2.2.2.5.cmml" xref="S4.Ex4.m1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.2.2.2.5.1.cmml" xref="S4.Ex4.m1.2.2.2.2.2.5">superscript</csymbol><apply id="S4.Ex4.m1.2.2.2.2.2.5.2.cmml" xref="S4.Ex4.m1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.2.2.2.5.2.1.cmml" xref="S4.Ex4.m1.2.2.2.2.2.5">subscript</csymbol><ci id="S4.Ex4.m1.2.2.2.2.2.5.2.2.cmml" xref="S4.Ex4.m1.2.2.2.2.2.5.2.2">𝐷</ci><ci id="S4.Ex4.m1.2.2.2.2.2.5.2.3.cmml" xref="S4.Ex4.m1.2.2.2.2.2.5.2.3">𝑖</ci></apply><ci id="S4.Ex4.m1.2.2.2.2.2.5.3.cmml" xref="S4.Ex4.m1.2.2.2.2.2.5.3">𝑘</ci></apply></apply><cerror id="S4.Ex4.m1.10.10b.cmml" xref="S4.Ex4.m1.10.10"><csymbol cd="ambiguous" id="S4.Ex4.m1.10.10c.cmml" xref="S4.Ex4.m1.10.10">missing-subexpression</csymbol></cerror><apply id="S4.Ex4.m1.2.2.2.4.1.cmml" xref="S4.Ex4.m1.2.2.2.4.1"><in id="S4.Ex4.m1.2.2.2.4.1.1.cmml" xref="S4.Ex4.m1.2.2.2.4.1.1"></in><ci id="S4.Ex4.m1.2.2.2.4.1.2.cmml" xref="S4.Ex4.m1.2.2.2.4.1.2">𝑘</ci><apply id="S4.Ex4.m1.2.2.2.4.1.3.cmml" xref="S4.Ex4.m1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.2.4.1.3.1.cmml" xref="S4.Ex4.m1.2.2.2.4.1.3">superscript</csymbol><apply id="S4.Ex4.m1.2.2.2.4.1.3.2.cmml" xref="S4.Ex4.m1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.2.4.1.3.2.1.cmml" xref="S4.Ex4.m1.2.2.2.4.1.3">subscript</csymbol><ci id="S4.Ex4.m1.2.2.2.4.1.3.2.2.cmml" xref="S4.Ex4.m1.2.2.2.4.1.3.2.2">𝐶</ci><ci id="S4.Ex4.m1.2.2.2.4.1.3.2.3.cmml" xref="S4.Ex4.m1.2.2.2.4.1.3.2.3">𝑛</ci></apply><ci id="S4.Ex4.m1.2.2.2.4.1.3.3.cmml" xref="S4.Ex4.m1.2.2.2.4.1.3.3">𝑖</ci></apply></apply></matrixrow><matrixrow id="S4.Ex4.m1.10.10d.cmml" xref="S4.Ex4.m1.10.10"><apply id="S4.Ex4.m1.10.10.10.8.8.cmml" xref="S4.Ex4.m1.10.10.10.8.8"><csymbol cd="latexml" id="S4.Ex4.m1.10.10.10.8.8.9.cmml" xref="S4.Ex4.m1.10.10.10.8.8.9">similar-to</csymbol><interval closure="open" id="S4.Ex4.m1.10.10.10.8.8.10.1.cmml" xref="S4.Ex4.m1.10.10.10.8.8.10.2"><ci id="S4.Ex4.m1.3.3.3.1.1.1.cmml" xref="S4.Ex4.m1.3.3.3.1.1.1">𝒙</ci><ci id="S4.Ex4.m1.4.4.4.2.2.2.cmml" xref="S4.Ex4.m1.4.4.4.2.2.2">𝑦</ci></interval><apply id="S4.Ex4.m1.10.10.10.8.8.8.3.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2"><csymbol cd="latexml" id="S4.Ex4.m1.10.10.10.8.8.8.3.1.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.3">conditional-set</csymbol><interval closure="open" id="S4.Ex4.m1.9.9.9.7.7.7.1.1.1.cmml" xref="S4.Ex4.m1.9.9.9.7.7.7.1.1.2"><ci id="S4.Ex4.m1.5.5.5.3.3.3.cmml" xref="S4.Ex4.m1.5.5.5.3.3.3">𝒙</ci><ci id="S4.Ex4.m1.6.6.6.4.4.4.cmml" xref="S4.Ex4.m1.6.6.6.4.4.4">𝑦</ci></interval><apply id="S4.Ex4.m1.10.10.10.8.8.8.2.2.3.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.10.10.10.8.8.8.2.2.3a.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.3">formulae-sequence</csymbol><apply id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1"><in id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.1.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.1"></in><interval closure="open" id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.1.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.2.2"><ci id="S4.Ex4.m1.7.7.7.5.5.5.cmml" xref="S4.Ex4.m1.7.7.7.5.5.5">𝒙</ci><ci id="S4.Ex4.m1.8.8.8.6.6.6.cmml" xref="S4.Ex4.m1.8.8.8.6.6.6">𝑦</ci></interval><ci id="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.3.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.1.1.3">𝒮</ci></apply><apply id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2"><eq id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.1.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.1"></eq><ci id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.2.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.2">𝑦</ci><ci id="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.3.cmml" xref="S4.Ex4.m1.10.10.10.8.8.8.2.2.2.2.3">𝑘</ci></apply></apply></apply></apply><cerror id="S4.Ex4.m1.10.10e.cmml" xref="S4.Ex4.m1.10.10"><csymbol cd="ambiguous" id="S4.Ex4.m1.10.10f.cmml" xref="S4.Ex4.m1.10.10">missing-subexpression</csymbol></cerror><apply id="S4.Ex4.m1.10.10.10.10.1.cmml" xref="S4.Ex4.m1.10.10.10.10.1"><in id="S4.Ex4.m1.10.10.10.10.1.1.cmml" xref="S4.Ex4.m1.10.10.10.10.1.1"></in><ci id="S4.Ex4.m1.10.10.10.10.1.2.cmml" xref="S4.Ex4.m1.10.10.10.10.1.2">𝑘</ci><apply id="S4.Ex4.m1.10.10.10.10.1.3.cmml" xref="S4.Ex4.m1.10.10.10.10.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.10.10.10.10.1.3.1.cmml" xref="S4.Ex4.m1.10.10.10.10.1.3">superscript</csymbol><apply id="S4.Ex4.m1.10.10.10.10.1.3.2.cmml" xref="S4.Ex4.m1.10.10.10.10.1.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.10.10.10.10.1.3.2.1.cmml" xref="S4.Ex4.m1.10.10.10.10.1.3">subscript</csymbol><ci id="S4.Ex4.m1.10.10.10.10.1.3.2.2.cmml" xref="S4.Ex4.m1.10.10.10.10.1.3.2.2">𝐶</ci><ci id="S4.Ex4.m1.10.10.10.10.1.3.2.3.cmml" xref="S4.Ex4.m1.10.10.10.10.1.3.2.3">𝑚</ci></apply><ci id="S4.Ex4.m1.10.10.10.10.1.3.3.cmml" xref="S4.Ex4.m1.10.10.10.10.1.3.3">𝑖</ci></apply></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.13c">\psi(k,\mathcal{D}_{i},\mathcal{S})=\left\{\begin{array}[]{lcl}(\boldsymbol{x},y)\sim D_{i}^{k}&amp;&amp;{k\in C_{n}^{i}}\\
(\boldsymbol{x},y)\sim\{(\boldsymbol{x},y)|(\boldsymbol{x},y)\in\mathcal{S},y=k\}&amp;&amp;{k\in C_{m}^{i}}\\
\end{array}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.3" class="ltx_p">Knowledge anchor <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{i}" display="inline"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">𝒯</mi><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝒯</ci><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\mathcal{T}_{i}</annotation></semantics></math> is the minimal sample subset that compensates for the missing classes and non-dominant classes in the client <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S4.p2.2.m2.1a"><msub id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">c</mi><mi id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝑐</ci><ci id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">c_{i}</annotation></semantics></math>. Note that <math id="S4.p2.3.m3.3" class="ltx_Math" alttext="|\mathcal{T}_{i}|=|C_{m}^{i}|+|C_{n}^{i}|" display="inline"><semantics id="S4.p2.3.m3.3a"><mrow id="S4.p2.3.m3.3.3" xref="S4.p2.3.m3.3.3.cmml"><mrow id="S4.p2.3.m3.1.1.1.1" xref="S4.p2.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S4.p2.3.m3.1.1.1.1.2" xref="S4.p2.3.m3.1.1.1.2.1.cmml">|</mo><msub id="S4.p2.3.m3.1.1.1.1.1" xref="S4.p2.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p2.3.m3.1.1.1.1.1.2" xref="S4.p2.3.m3.1.1.1.1.1.2.cmml">𝒯</mi><mi id="S4.p2.3.m3.1.1.1.1.1.3" xref="S4.p2.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.p2.3.m3.1.1.1.1.3" xref="S4.p2.3.m3.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.p2.3.m3.3.3.4" xref="S4.p2.3.m3.3.3.4.cmml">=</mo><mrow id="S4.p2.3.m3.3.3.3" xref="S4.p2.3.m3.3.3.3.cmml"><mrow id="S4.p2.3.m3.2.2.2.1.1" xref="S4.p2.3.m3.2.2.2.1.2.cmml"><mo stretchy="false" id="S4.p2.3.m3.2.2.2.1.1.2" xref="S4.p2.3.m3.2.2.2.1.2.1.cmml">|</mo><msubsup id="S4.p2.3.m3.2.2.2.1.1.1" xref="S4.p2.3.m3.2.2.2.1.1.1.cmml"><mi id="S4.p2.3.m3.2.2.2.1.1.1.2.2" xref="S4.p2.3.m3.2.2.2.1.1.1.2.2.cmml">C</mi><mi id="S4.p2.3.m3.2.2.2.1.1.1.2.3" xref="S4.p2.3.m3.2.2.2.1.1.1.2.3.cmml">m</mi><mi id="S4.p2.3.m3.2.2.2.1.1.1.3" xref="S4.p2.3.m3.2.2.2.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.p2.3.m3.2.2.2.1.1.3" xref="S4.p2.3.m3.2.2.2.1.2.1.cmml">|</mo></mrow><mo id="S4.p2.3.m3.3.3.3.3" xref="S4.p2.3.m3.3.3.3.3.cmml">+</mo><mrow id="S4.p2.3.m3.3.3.3.2.1" xref="S4.p2.3.m3.3.3.3.2.2.cmml"><mo stretchy="false" id="S4.p2.3.m3.3.3.3.2.1.2" xref="S4.p2.3.m3.3.3.3.2.2.1.cmml">|</mo><msubsup id="S4.p2.3.m3.3.3.3.2.1.1" xref="S4.p2.3.m3.3.3.3.2.1.1.cmml"><mi id="S4.p2.3.m3.3.3.3.2.1.1.2.2" xref="S4.p2.3.m3.3.3.3.2.1.1.2.2.cmml">C</mi><mi id="S4.p2.3.m3.3.3.3.2.1.1.2.3" xref="S4.p2.3.m3.3.3.3.2.1.1.2.3.cmml">n</mi><mi id="S4.p2.3.m3.3.3.3.2.1.1.3" xref="S4.p2.3.m3.3.3.3.2.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.p2.3.m3.3.3.3.2.1.3" xref="S4.p2.3.m3.3.3.3.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.3b"><apply id="S4.p2.3.m3.3.3.cmml" xref="S4.p2.3.m3.3.3"><eq id="S4.p2.3.m3.3.3.4.cmml" xref="S4.p2.3.m3.3.3.4"></eq><apply id="S4.p2.3.m3.1.1.1.2.cmml" xref="S4.p2.3.m3.1.1.1.1"><abs id="S4.p2.3.m3.1.1.1.2.1.cmml" xref="S4.p2.3.m3.1.1.1.1.2"></abs><apply id="S4.p2.3.m3.1.1.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.p2.3.m3.1.1.1.1.1.2">𝒯</ci><ci id="S4.p2.3.m3.1.1.1.1.1.3.cmml" xref="S4.p2.3.m3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.p2.3.m3.3.3.3.cmml" xref="S4.p2.3.m3.3.3.3"><plus id="S4.p2.3.m3.3.3.3.3.cmml" xref="S4.p2.3.m3.3.3.3.3"></plus><apply id="S4.p2.3.m3.2.2.2.1.2.cmml" xref="S4.p2.3.m3.2.2.2.1.1"><abs id="S4.p2.3.m3.2.2.2.1.2.1.cmml" xref="S4.p2.3.m3.2.2.2.1.1.2"></abs><apply id="S4.p2.3.m3.2.2.2.1.1.1.cmml" xref="S4.p2.3.m3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.2.2.2.1.1.1.1.cmml" xref="S4.p2.3.m3.2.2.2.1.1.1">superscript</csymbol><apply id="S4.p2.3.m3.2.2.2.1.1.1.2.cmml" xref="S4.p2.3.m3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.2.2.2.1.1.1.2.1.cmml" xref="S4.p2.3.m3.2.2.2.1.1.1">subscript</csymbol><ci id="S4.p2.3.m3.2.2.2.1.1.1.2.2.cmml" xref="S4.p2.3.m3.2.2.2.1.1.1.2.2">𝐶</ci><ci id="S4.p2.3.m3.2.2.2.1.1.1.2.3.cmml" xref="S4.p2.3.m3.2.2.2.1.1.1.2.3">𝑚</ci></apply><ci id="S4.p2.3.m3.2.2.2.1.1.1.3.cmml" xref="S4.p2.3.m3.2.2.2.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.p2.3.m3.3.3.3.2.2.cmml" xref="S4.p2.3.m3.3.3.3.2.1"><abs id="S4.p2.3.m3.3.3.3.2.2.1.cmml" xref="S4.p2.3.m3.3.3.3.2.1.2"></abs><apply id="S4.p2.3.m3.3.3.3.2.1.1.cmml" xref="S4.p2.3.m3.3.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.3.3.3.2.1.1.1.cmml" xref="S4.p2.3.m3.3.3.3.2.1.1">superscript</csymbol><apply id="S4.p2.3.m3.3.3.3.2.1.1.2.cmml" xref="S4.p2.3.m3.3.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.3.3.3.2.1.1.2.1.cmml" xref="S4.p2.3.m3.3.3.3.2.1.1">subscript</csymbol><ci id="S4.p2.3.m3.3.3.3.2.1.1.2.2.cmml" xref="S4.p2.3.m3.3.3.3.2.1.1.2.2">𝐶</ci><ci id="S4.p2.3.m3.3.3.3.2.1.1.2.3.cmml" xref="S4.p2.3.m3.3.3.3.2.1.1.2.3">𝑛</ci></apply><ci id="S4.p2.3.m3.3.3.3.2.1.1.3.cmml" xref="S4.p2.3.m3.3.3.3.2.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.3c">|\mathcal{T}_{i}|=|C_{m}^{i}|+|C_{n}^{i}|</annotation></semantics></math>.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.7" class="ltx_p">We now describe our method Federated Knowledge Anchor (FedKA). Before training, FedKA requires all clients to create a shared dataset <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">S</annotation></semantics></math> which contains only one sample for each class. Such an assumption does not violate the principles of privacy and is quite easy to satisfy as client number <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.p3.2.m2.1a"><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">N</annotation></semantics></math> is always greater than <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.p3.3.m3.1a"><mi id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><ci id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">K</annotation></semantics></math> in federated learning. For each communication round, every participating client <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S4.p3.4.m4.1a"><msub id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" xref="S4.p3.4.m4.1.1.2.cmml">c</mi><mi id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">𝑐</ci><ci id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">c_{i}</annotation></semantics></math> will first construct its knowledge anchor <math id="S4.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{T}_{i}^{r}" display="inline"><semantics id="S4.p3.5.m5.1a"><msubsup id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p3.5.m5.1.1.2.2" xref="S4.p3.5.m5.1.1.2.2.cmml">𝒯</mi><mi id="S4.p3.5.m5.1.1.2.3" xref="S4.p3.5.m5.1.1.2.3.cmml">i</mi><mi id="S4.p3.5.m5.1.1.3" xref="S4.p3.5.m5.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><apply id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p3.5.m5.1.1.1.cmml" xref="S4.p3.5.m5.1.1">superscript</csymbol><apply id="S4.p3.5.m5.1.1.2.cmml" xref="S4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p3.5.m5.1.1.2.1.cmml" xref="S4.p3.5.m5.1.1">subscript</csymbol><ci id="S4.p3.5.m5.1.1.2.2.cmml" xref="S4.p3.5.m5.1.1.2.2">𝒯</ci><ci id="S4.p3.5.m5.1.1.2.3.cmml" xref="S4.p3.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S4.p3.5.m5.1.1.3.cmml" xref="S4.p3.5.m5.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">\mathcal{T}_{i}^{r}</annotation></semantics></math>. Then the knowledge anchor <math id="S4.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{T}_{i}^{r}" display="inline"><semantics id="S4.p3.6.m6.1a"><msubsup id="S4.p3.6.m6.1.1" xref="S4.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p3.6.m6.1.1.2.2" xref="S4.p3.6.m6.1.1.2.2.cmml">𝒯</mi><mi id="S4.p3.6.m6.1.1.2.3" xref="S4.p3.6.m6.1.1.2.3.cmml">i</mi><mi id="S4.p3.6.m6.1.1.3" xref="S4.p3.6.m6.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p3.6.m6.1b"><apply id="S4.p3.6.m6.1.1.cmml" xref="S4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p3.6.m6.1.1.1.cmml" xref="S4.p3.6.m6.1.1">superscript</csymbol><apply id="S4.p3.6.m6.1.1.2.cmml" xref="S4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p3.6.m6.1.1.2.1.cmml" xref="S4.p3.6.m6.1.1">subscript</csymbol><ci id="S4.p3.6.m6.1.1.2.2.cmml" xref="S4.p3.6.m6.1.1.2.2">𝒯</ci><ci id="S4.p3.6.m6.1.1.2.3.cmml" xref="S4.p3.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S4.p3.6.m6.1.1.3.cmml" xref="S4.p3.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m6.1c">\mathcal{T}_{i}^{r}</annotation></semantics></math> is utilized to correct the local gradient of each mini-batch towards the direction of preserving the knowledge of the missing and non-dominant classes. Specifically, we borrow the Not-True-Distillation (NTD) idea from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and extend it to all non-dominant and missing classes. In each mini-batch update, we add an additional regularization term to minimize the L2 distance between the knowledge anchor’s logits (the last-layer outputs before the Softmax operation) of the current global model and the updated local model. Note that the logits represented for dominant classes are discarded. The loss function of client <math id="S4.p3.7.m7.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S4.p3.7.m7.1a"><msub id="S4.p3.7.m7.1.1" xref="S4.p3.7.m7.1.1.cmml"><mi id="S4.p3.7.m7.1.1.2" xref="S4.p3.7.m7.1.1.2.cmml">c</mi><mi id="S4.p3.7.m7.1.1.3" xref="S4.p3.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.7.m7.1b"><apply id="S4.p3.7.m7.1.1.cmml" xref="S4.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p3.7.m7.1.1.1.cmml" xref="S4.p3.7.m7.1.1">subscript</csymbol><ci id="S4.p3.7.m7.1.1.2.cmml" xref="S4.p3.7.m7.1.1.2">𝑐</ci><ci id="S4.p3.7.m7.1.1.3.cmml" xref="S4.p3.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m7.1c">c_{i}</annotation></semantics></math> in local training is:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.3" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{CE}+\beta\cdot\mathcal{L}_{KA}\left(\mathcal{T}_{i}^{r},f_{\boldsymbol{\theta}^{r}_{g}},f_{\boldsymbol{\theta}^{r}_{i}}\right)" display="block"><semantics id="S4.E3.m1.3a"><mrow id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.3.3.5" xref="S4.E3.m1.3.3.5.cmml">ℒ</mi><mo id="S4.E3.m1.3.3.4" xref="S4.E3.m1.3.3.4.cmml">=</mo><mrow id="S4.E3.m1.3.3.3" xref="S4.E3.m1.3.3.3.cmml"><msub id="S4.E3.m1.3.3.3.5" xref="S4.E3.m1.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.3.3.3.5.2" xref="S4.E3.m1.3.3.3.5.2.cmml">ℒ</mi><mrow id="S4.E3.m1.3.3.3.5.3" xref="S4.E3.m1.3.3.3.5.3.cmml"><mi id="S4.E3.m1.3.3.3.5.3.2" xref="S4.E3.m1.3.3.3.5.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.3.5.3.1" xref="S4.E3.m1.3.3.3.5.3.1.cmml">​</mo><mi id="S4.E3.m1.3.3.3.5.3.3" xref="S4.E3.m1.3.3.3.5.3.3.cmml">E</mi></mrow></msub><mo id="S4.E3.m1.3.3.3.4" xref="S4.E3.m1.3.3.3.4.cmml">+</mo><mrow id="S4.E3.m1.3.3.3.3" xref="S4.E3.m1.3.3.3.3.cmml"><mrow id="S4.E3.m1.3.3.3.3.5" xref="S4.E3.m1.3.3.3.3.5.cmml"><mi id="S4.E3.m1.3.3.3.3.5.2" xref="S4.E3.m1.3.3.3.3.5.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E3.m1.3.3.3.3.5.1" xref="S4.E3.m1.3.3.3.3.5.1.cmml">⋅</mo><msub id="S4.E3.m1.3.3.3.3.5.3" xref="S4.E3.m1.3.3.3.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.3.3.3.3.5.3.2" xref="S4.E3.m1.3.3.3.3.5.3.2.cmml">ℒ</mi><mrow id="S4.E3.m1.3.3.3.3.5.3.3" xref="S4.E3.m1.3.3.3.3.5.3.3.cmml"><mi id="S4.E3.m1.3.3.3.3.5.3.3.2" xref="S4.E3.m1.3.3.3.3.5.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.3.3.5.3.3.1" xref="S4.E3.m1.3.3.3.3.5.3.3.1.cmml">​</mo><mi id="S4.E3.m1.3.3.3.3.5.3.3.3" xref="S4.E3.m1.3.3.3.3.5.3.3.3.cmml">A</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.3.3.4" xref="S4.E3.m1.3.3.3.3.4.cmml">​</mo><mrow id="S4.E3.m1.3.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.4.cmml"><mo id="S4.E3.m1.3.3.3.3.3.3.4" xref="S4.E3.m1.3.3.3.3.3.4.cmml">(</mo><msubsup id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.2.2.cmml">𝒯</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S4.E3.m1.3.3.3.3.3.3.5" xref="S4.E3.m1.3.3.3.3.3.4.cmml">,</mo><msub id="S4.E3.m1.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.2.cmml">f</mi><msubsup id="S4.E3.m1.2.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.2.3.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.3.2.2.cmml">𝜽</mi><mi id="S4.E3.m1.2.2.2.2.2.2.2.3.3" xref="S4.E3.m1.2.2.2.2.2.2.2.3.3.cmml">g</mi><mi id="S4.E3.m1.2.2.2.2.2.2.2.3.2.3" xref="S4.E3.m1.2.2.2.2.2.2.2.3.2.3.cmml">r</mi></msubsup></msub><mo id="S4.E3.m1.3.3.3.3.3.3.6" xref="S4.E3.m1.3.3.3.3.3.4.cmml">,</mo><msub id="S4.E3.m1.3.3.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.3.3.cmml"><mi id="S4.E3.m1.3.3.3.3.3.3.3.2" xref="S4.E3.m1.3.3.3.3.3.3.3.2.cmml">f</mi><msubsup id="S4.E3.m1.3.3.3.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.3.3.3.cmml"><mi id="S4.E3.m1.3.3.3.3.3.3.3.3.2.2" xref="S4.E3.m1.3.3.3.3.3.3.3.3.2.2.cmml">𝜽</mi><mi id="S4.E3.m1.3.3.3.3.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.3.3.3.3.cmml">i</mi><mi id="S4.E3.m1.3.3.3.3.3.3.3.3.2.3" xref="S4.E3.m1.3.3.3.3.3.3.3.3.2.3.cmml">r</mi></msubsup></msub><mo id="S4.E3.m1.3.3.3.3.3.3.7" xref="S4.E3.m1.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.3b"><apply id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3"><eq id="S4.E3.m1.3.3.4.cmml" xref="S4.E3.m1.3.3.4"></eq><ci id="S4.E3.m1.3.3.5.cmml" xref="S4.E3.m1.3.3.5">ℒ</ci><apply id="S4.E3.m1.3.3.3.cmml" xref="S4.E3.m1.3.3.3"><plus id="S4.E3.m1.3.3.3.4.cmml" xref="S4.E3.m1.3.3.3.4"></plus><apply id="S4.E3.m1.3.3.3.5.cmml" xref="S4.E3.m1.3.3.3.5"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.5.1.cmml" xref="S4.E3.m1.3.3.3.5">subscript</csymbol><ci id="S4.E3.m1.3.3.3.5.2.cmml" xref="S4.E3.m1.3.3.3.5.2">ℒ</ci><apply id="S4.E3.m1.3.3.3.5.3.cmml" xref="S4.E3.m1.3.3.3.5.3"><times id="S4.E3.m1.3.3.3.5.3.1.cmml" xref="S4.E3.m1.3.3.3.5.3.1"></times><ci id="S4.E3.m1.3.3.3.5.3.2.cmml" xref="S4.E3.m1.3.3.3.5.3.2">𝐶</ci><ci id="S4.E3.m1.3.3.3.5.3.3.cmml" xref="S4.E3.m1.3.3.3.5.3.3">𝐸</ci></apply></apply><apply id="S4.E3.m1.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3"><times id="S4.E3.m1.3.3.3.3.4.cmml" xref="S4.E3.m1.3.3.3.3.4"></times><apply id="S4.E3.m1.3.3.3.3.5.cmml" xref="S4.E3.m1.3.3.3.3.5"><ci id="S4.E3.m1.3.3.3.3.5.1.cmml" xref="S4.E3.m1.3.3.3.3.5.1">⋅</ci><ci id="S4.E3.m1.3.3.3.3.5.2.cmml" xref="S4.E3.m1.3.3.3.3.5.2">𝛽</ci><apply id="S4.E3.m1.3.3.3.3.5.3.cmml" xref="S4.E3.m1.3.3.3.3.5.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.5.3.1.cmml" xref="S4.E3.m1.3.3.3.3.5.3">subscript</csymbol><ci id="S4.E3.m1.3.3.3.3.5.3.2.cmml" xref="S4.E3.m1.3.3.3.3.5.3.2">ℒ</ci><apply id="S4.E3.m1.3.3.3.3.5.3.3.cmml" xref="S4.E3.m1.3.3.3.3.5.3.3"><times id="S4.E3.m1.3.3.3.3.5.3.3.1.cmml" xref="S4.E3.m1.3.3.3.3.5.3.3.1"></times><ci id="S4.E3.m1.3.3.3.3.5.3.3.2.cmml" xref="S4.E3.m1.3.3.3.3.5.3.3.2">𝐾</ci><ci id="S4.E3.m1.3.3.3.3.5.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.5.3.3.3">𝐴</ci></apply></apply></apply><vector id="S4.E3.m1.3.3.3.3.3.4.cmml" xref="S4.E3.m1.3.3.3.3.3.3"><apply id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2.2">𝒯</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.3">𝑟</ci></apply><apply id="S4.E3.m1.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.2">𝑓</ci><apply id="S4.E3.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3">subscript</csymbol><apply id="S4.E3.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.2.3.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S4.E3.m1.2.2.2.2.2.2.2.3.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3.2.2">𝜽</ci><ci id="S4.E3.m1.2.2.2.2.2.2.2.3.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3.2.3">𝑟</ci></apply><ci id="S4.E3.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2.3.3">𝑔</ci></apply></apply><apply id="S4.E3.m1.3.3.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E3.m1.3.3.3.3.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.2">𝑓</ci><apply id="S4.E3.m1.3.3.3.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.3.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3">subscript</csymbol><apply id="S4.E3.m1.3.3.3.3.3.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.3.3.3.3.2.1.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3">superscript</csymbol><ci id="S4.E3.m1.3.3.3.3.3.3.3.3.2.2.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3.2.2">𝜽</ci><ci id="S4.E3.m1.3.3.3.3.3.3.3.3.2.3.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3.2.3">𝑟</ci></apply><ci id="S4.E3.m1.3.3.3.3.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3.3.3.3.3">𝑖</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.3c">\mathcal{L}=\mathcal{L}_{CE}+\beta\cdot\mathcal{L}_{KA}\left(\mathcal{T}_{i}^{r},f_{\boldsymbol{\theta}^{r}_{g}},f_{\boldsymbol{\theta}^{r}_{i}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.p3.11" class="ltx_p">, where</p>
<table id="S4.Ex5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex5.m1.5" class="ltx_Math" alttext="\mathcal{L}_{KA}\left(\mathcal{T}_{i}^{r},f_{\boldsymbol{\theta}^{r}_{g}},f_{\boldsymbol{\theta}^{r}_{i}}\right)=\frac{1}{\left|\mathcal{T}_{i}^{r}\right|}\left|\left|\Phi\left(f_{\boldsymbol{\theta}^{r}_{g}}\left(\mathcal{T}_{i}^{r}\right),C_{d}^{i}\right)-\Phi\left(f_{\boldsymbol{\theta}^{r}_{i}}\left(\mathcal{T}_{i}^{r}\right),C_{d}^{i}\right)\right|\right|^{2}" display="block"><semantics id="S4.Ex5.m1.5a"><mrow id="S4.Ex5.m1.5.5" xref="S4.Ex5.m1.5.5.cmml"><mrow id="S4.Ex5.m1.4.4.3" xref="S4.Ex5.m1.4.4.3.cmml"><msub id="S4.Ex5.m1.4.4.3.5" xref="S4.Ex5.m1.4.4.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.4.4.3.5.2" xref="S4.Ex5.m1.4.4.3.5.2.cmml">ℒ</mi><mrow id="S4.Ex5.m1.4.4.3.5.3" xref="S4.Ex5.m1.4.4.3.5.3.cmml"><mi id="S4.Ex5.m1.4.4.3.5.3.2" xref="S4.Ex5.m1.4.4.3.5.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.4.4.3.5.3.1" xref="S4.Ex5.m1.4.4.3.5.3.1.cmml">​</mo><mi id="S4.Ex5.m1.4.4.3.5.3.3" xref="S4.Ex5.m1.4.4.3.5.3.3.cmml">A</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.4.4.3.4" xref="S4.Ex5.m1.4.4.3.4.cmml">​</mo><mrow id="S4.Ex5.m1.4.4.3.3.3" xref="S4.Ex5.m1.4.4.3.3.4.cmml"><mo id="S4.Ex5.m1.4.4.3.3.3.4" xref="S4.Ex5.m1.4.4.3.3.4.cmml">(</mo><msubsup id="S4.Ex5.m1.2.2.1.1.1.1" xref="S4.Ex5.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.2.2.1.1.1.1.2.2" xref="S4.Ex5.m1.2.2.1.1.1.1.2.2.cmml">𝒯</mi><mi id="S4.Ex5.m1.2.2.1.1.1.1.2.3" xref="S4.Ex5.m1.2.2.1.1.1.1.2.3.cmml">i</mi><mi id="S4.Ex5.m1.2.2.1.1.1.1.3" xref="S4.Ex5.m1.2.2.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S4.Ex5.m1.4.4.3.3.3.5" xref="S4.Ex5.m1.4.4.3.3.4.cmml">,</mo><msub id="S4.Ex5.m1.3.3.2.2.2.2" xref="S4.Ex5.m1.3.3.2.2.2.2.cmml"><mi id="S4.Ex5.m1.3.3.2.2.2.2.2" xref="S4.Ex5.m1.3.3.2.2.2.2.2.cmml">f</mi><msubsup id="S4.Ex5.m1.3.3.2.2.2.2.3" xref="S4.Ex5.m1.3.3.2.2.2.2.3.cmml"><mi id="S4.Ex5.m1.3.3.2.2.2.2.3.2.2" xref="S4.Ex5.m1.3.3.2.2.2.2.3.2.2.cmml">𝜽</mi><mi id="S4.Ex5.m1.3.3.2.2.2.2.3.3" xref="S4.Ex5.m1.3.3.2.2.2.2.3.3.cmml">g</mi><mi id="S4.Ex5.m1.3.3.2.2.2.2.3.2.3" xref="S4.Ex5.m1.3.3.2.2.2.2.3.2.3.cmml">r</mi></msubsup></msub><mo id="S4.Ex5.m1.4.4.3.3.3.6" xref="S4.Ex5.m1.4.4.3.3.4.cmml">,</mo><msub id="S4.Ex5.m1.4.4.3.3.3.3" xref="S4.Ex5.m1.4.4.3.3.3.3.cmml"><mi id="S4.Ex5.m1.4.4.3.3.3.3.2" xref="S4.Ex5.m1.4.4.3.3.3.3.2.cmml">f</mi><msubsup id="S4.Ex5.m1.4.4.3.3.3.3.3" xref="S4.Ex5.m1.4.4.3.3.3.3.3.cmml"><mi id="S4.Ex5.m1.4.4.3.3.3.3.3.2.2" xref="S4.Ex5.m1.4.4.3.3.3.3.3.2.2.cmml">𝜽</mi><mi id="S4.Ex5.m1.4.4.3.3.3.3.3.3" xref="S4.Ex5.m1.4.4.3.3.3.3.3.3.cmml">i</mi><mi id="S4.Ex5.m1.4.4.3.3.3.3.3.2.3" xref="S4.Ex5.m1.4.4.3.3.3.3.3.2.3.cmml">r</mi></msubsup></msub><mo id="S4.Ex5.m1.4.4.3.3.3.7" xref="S4.Ex5.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.5.5.5" xref="S4.Ex5.m1.5.5.5.cmml">=</mo><mrow id="S4.Ex5.m1.5.5.4" xref="S4.Ex5.m1.5.5.4.cmml"><mfrac id="S4.Ex5.m1.1.1" xref="S4.Ex5.m1.1.1.cmml"><mn id="S4.Ex5.m1.1.1.3" xref="S4.Ex5.m1.1.1.3.cmml">1</mn><mrow id="S4.Ex5.m1.1.1.1.1" xref="S4.Ex5.m1.1.1.1.2.cmml"><mo id="S4.Ex5.m1.1.1.1.1.2" xref="S4.Ex5.m1.1.1.1.2.1.cmml">|</mo><msubsup id="S4.Ex5.m1.1.1.1.1.1" xref="S4.Ex5.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.1.1.1.1.1.2.2" xref="S4.Ex5.m1.1.1.1.1.1.2.2.cmml">𝒯</mi><mi id="S4.Ex5.m1.1.1.1.1.1.2.3" xref="S4.Ex5.m1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.Ex5.m1.1.1.1.1.1.3" xref="S4.Ex5.m1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S4.Ex5.m1.1.1.1.1.3" xref="S4.Ex5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.5.5.4.2" xref="S4.Ex5.m1.5.5.4.2.cmml">​</mo><msup id="S4.Ex5.m1.5.5.4.1" xref="S4.Ex5.m1.5.5.4.1.cmml"><mrow id="S4.Ex5.m1.5.5.4.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.2.cmml"><mo stretchy="false" id="S4.Ex5.m1.5.5.4.1.1.1.2" xref="S4.Ex5.m1.5.5.4.1.1.2.1.cmml">‖</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.1.1.cmml"><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.Ex5.m1.5.5.4.1.1.1.1.2.4" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.4.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.5.5.4.1.1.1.1.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.3.cmml"><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><msubsup id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝜽</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.3.cmml">g</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.3.cmml">r</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒯</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.4" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.cmml"><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.2.cmml">C</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.3.cmml">d</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.5" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.5" xref="S4.Ex5.m1.5.5.4.1.1.1.1.5.cmml">−</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.4" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S4.Ex5.m1.5.5.4.1.1.1.1.4.4" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.4.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.5.5.4.1.1.1.1.4.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.3.cmml">​</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.3.cmml"><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.3.cmml">(</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.cmml"><msub id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.cmml"><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.2.cmml">f</mi><msubsup id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.cmml"><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.2.cmml">𝜽</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.3.cmml">i</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.3.cmml">r</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.2.cmml">​</mo><mrow id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.cmml"><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml">𝒯</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.4" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.3.cmml">,</mo><msubsup id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.cmml"><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.2" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.2.cmml">C</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.3.cmml">d</mi><mi id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.3" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.5" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.Ex5.m1.5.5.4.1.1.1.3" xref="S4.Ex5.m1.5.5.4.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex5.m1.5.5.4.1.3" xref="S4.Ex5.m1.5.5.4.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex5.m1.5b"><apply id="S4.Ex5.m1.5.5.cmml" xref="S4.Ex5.m1.5.5"><eq id="S4.Ex5.m1.5.5.5.cmml" xref="S4.Ex5.m1.5.5.5"></eq><apply id="S4.Ex5.m1.4.4.3.cmml" xref="S4.Ex5.m1.4.4.3"><times id="S4.Ex5.m1.4.4.3.4.cmml" xref="S4.Ex5.m1.4.4.3.4"></times><apply id="S4.Ex5.m1.4.4.3.5.cmml" xref="S4.Ex5.m1.4.4.3.5"><csymbol cd="ambiguous" id="S4.Ex5.m1.4.4.3.5.1.cmml" xref="S4.Ex5.m1.4.4.3.5">subscript</csymbol><ci id="S4.Ex5.m1.4.4.3.5.2.cmml" xref="S4.Ex5.m1.4.4.3.5.2">ℒ</ci><apply id="S4.Ex5.m1.4.4.3.5.3.cmml" xref="S4.Ex5.m1.4.4.3.5.3"><times id="S4.Ex5.m1.4.4.3.5.3.1.cmml" xref="S4.Ex5.m1.4.4.3.5.3.1"></times><ci id="S4.Ex5.m1.4.4.3.5.3.2.cmml" xref="S4.Ex5.m1.4.4.3.5.3.2">𝐾</ci><ci id="S4.Ex5.m1.4.4.3.5.3.3.cmml" xref="S4.Ex5.m1.4.4.3.5.3.3">𝐴</ci></apply></apply><vector id="S4.Ex5.m1.4.4.3.3.4.cmml" xref="S4.Ex5.m1.4.4.3.3.3"><apply id="S4.Ex5.m1.2.2.1.1.1.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.2.2.1.1.1.1.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S4.Ex5.m1.2.2.1.1.1.1.2.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.Ex5.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.2.2">𝒯</ci><ci id="S4.Ex5.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.Ex5.m1.2.2.1.1.1.1.3.cmml" xref="S4.Ex5.m1.2.2.1.1.1.1.3">𝑟</ci></apply><apply id="S4.Ex5.m1.3.3.2.2.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.2.2.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S4.Ex5.m1.3.3.2.2.2.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.2">𝑓</ci><apply id="S4.Ex5.m1.3.3.2.2.2.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.2.2.3.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.3">subscript</csymbol><apply id="S4.Ex5.m1.3.3.2.2.2.2.3.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.3.3.2.2.2.2.3.2.1.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.3">superscript</csymbol><ci id="S4.Ex5.m1.3.3.2.2.2.2.3.2.2.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.3.2.2">𝜽</ci><ci id="S4.Ex5.m1.3.3.2.2.2.2.3.2.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.3.2.3">𝑟</ci></apply><ci id="S4.Ex5.m1.3.3.2.2.2.2.3.3.cmml" xref="S4.Ex5.m1.3.3.2.2.2.2.3.3">𝑔</ci></apply></apply><apply id="S4.Ex5.m1.4.4.3.3.3.3.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.4.4.3.3.3.3.1.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S4.Ex5.m1.4.4.3.3.3.3.2.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.2">𝑓</ci><apply id="S4.Ex5.m1.4.4.3.3.3.3.3.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.4.4.3.3.3.3.3.1.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.3">subscript</csymbol><apply id="S4.Ex5.m1.4.4.3.3.3.3.3.2.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.4.4.3.3.3.3.3.2.1.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.3">superscript</csymbol><ci id="S4.Ex5.m1.4.4.3.3.3.3.3.2.2.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.3.2.2">𝜽</ci><ci id="S4.Ex5.m1.4.4.3.3.3.3.3.2.3.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.3.2.3">𝑟</ci></apply><ci id="S4.Ex5.m1.4.4.3.3.3.3.3.3.cmml" xref="S4.Ex5.m1.4.4.3.3.3.3.3.3">𝑖</ci></apply></apply></vector></apply><apply id="S4.Ex5.m1.5.5.4.cmml" xref="S4.Ex5.m1.5.5.4"><times id="S4.Ex5.m1.5.5.4.2.cmml" xref="S4.Ex5.m1.5.5.4.2"></times><apply id="S4.Ex5.m1.1.1.cmml" xref="S4.Ex5.m1.1.1"><divide id="S4.Ex5.m1.1.1.2.cmml" xref="S4.Ex5.m1.1.1"></divide><cn type="integer" id="S4.Ex5.m1.1.1.3.cmml" xref="S4.Ex5.m1.1.1.3">1</cn><apply id="S4.Ex5.m1.1.1.1.2.cmml" xref="S4.Ex5.m1.1.1.1.1"><abs id="S4.Ex5.m1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.1.1.1.1.2"></abs><apply id="S4.Ex5.m1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex5.m1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex5.m1.1.1.1.1.1.2.2.cmml" xref="S4.Ex5.m1.1.1.1.1.1.2.2">𝒯</ci><ci id="S4.Ex5.m1.1.1.1.1.1.2.3.cmml" xref="S4.Ex5.m1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.Ex5.m1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.1.1.1.1.1.3">𝑟</ci></apply></apply></apply><apply id="S4.Ex5.m1.5.5.4.1.cmml" xref="S4.Ex5.m1.5.5.4.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.2.cmml" xref="S4.Ex5.m1.5.5.4.1">superscript</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1"><csymbol cd="latexml" id="S4.Ex5.m1.5.5.4.1.1.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.2">norm</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1"><minus id="S4.Ex5.m1.5.5.4.1.1.1.1.5.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.5"></minus><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2"><times id="S4.Ex5.m1.5.5.4.1.1.1.1.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.3"></times><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.2.4.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.4">Φ</ci><interval closure="open" id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2"><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1"><times id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.2"></times><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.2">𝜽</ci><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.2.3">𝑟</ci></apply><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.3.3.3">𝑔</ci></apply></apply><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒯</ci><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.2">𝐶</ci><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.2.3">𝑑</ci></apply><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.4.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4"><times id="S4.Ex5.m1.5.5.4.1.1.1.1.4.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.3"></times><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.4.4.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.4">Φ</ci><interval closure="open" id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2"><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1"><times id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.2"></times><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3">subscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.2">𝑓</ci><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3">subscript</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3">superscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.2">𝜽</ci><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.2.3">𝑟</ci></apply><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.2">𝒯</ci><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.3.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2">superscript</csymbol><apply id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.1.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.2.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.2">𝐶</ci><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.2.3">𝑑</ci></apply><ci id="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.3.cmml" xref="S4.Ex5.m1.5.5.4.1.1.1.1.4.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply><cn type="integer" id="S4.Ex5.m1.5.5.4.1.3.cmml" xref="S4.Ex5.m1.5.5.4.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex5.m1.5c">\mathcal{L}_{KA}\left(\mathcal{T}_{i}^{r},f_{\boldsymbol{\theta}^{r}_{g}},f_{\boldsymbol{\theta}^{r}_{i}}\right)=\frac{1}{\left|\mathcal{T}_{i}^{r}\right|}\left|\left|\Phi\left(f_{\boldsymbol{\theta}^{r}_{g}}\left(\mathcal{T}_{i}^{r}\right),C_{d}^{i}\right)-\Phi\left(f_{\boldsymbol{\theta}^{r}_{i}}\left(\mathcal{T}_{i}^{r}\right),C_{d}^{i}\right)\right|\right|^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.p3.10" class="ltx_p">and <math id="S4.p3.8.m1.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="S4.p3.8.m1.1a"><mi mathvariant="normal" id="S4.p3.8.m1.1.1" xref="S4.p3.8.m1.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="S4.p3.8.m1.1b"><ci id="S4.p3.8.m1.1.1.cmml" xref="S4.p3.8.m1.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m1.1c">\Phi</annotation></semantics></math> is the discarding function that discards all logits of dominant classes in <math id="S4.p3.9.m2.1" class="ltx_Math" alttext="C_{d}^{i}" display="inline"><semantics id="S4.p3.9.m2.1a"><msubsup id="S4.p3.9.m2.1.1" xref="S4.p3.9.m2.1.1.cmml"><mi id="S4.p3.9.m2.1.1.2.2" xref="S4.p3.9.m2.1.1.2.2.cmml">C</mi><mi id="S4.p3.9.m2.1.1.2.3" xref="S4.p3.9.m2.1.1.2.3.cmml">d</mi><mi id="S4.p3.9.m2.1.1.3" xref="S4.p3.9.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p3.9.m2.1b"><apply id="S4.p3.9.m2.1.1.cmml" xref="S4.p3.9.m2.1.1"><csymbol cd="ambiguous" id="S4.p3.9.m2.1.1.1.cmml" xref="S4.p3.9.m2.1.1">superscript</csymbol><apply id="S4.p3.9.m2.1.1.2.cmml" xref="S4.p3.9.m2.1.1"><csymbol cd="ambiguous" id="S4.p3.9.m2.1.1.2.1.cmml" xref="S4.p3.9.m2.1.1">subscript</csymbol><ci id="S4.p3.9.m2.1.1.2.2.cmml" xref="S4.p3.9.m2.1.1.2.2">𝐶</ci><ci id="S4.p3.9.m2.1.1.2.3.cmml" xref="S4.p3.9.m2.1.1.2.3">𝑑</ci></apply><ci id="S4.p3.9.m2.1.1.3.cmml" xref="S4.p3.9.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m2.1c">C_{d}^{i}</annotation></semantics></math>. In classification tasks with a large number of classes, the proportion between local samples in a mini-batch and the sample number in the knowledge anchor <math id="S4.p3.10.m3.1" class="ltx_Math" alttext="|\mathcal{T}_{i}|" display="inline"><semantics id="S4.p3.10.m3.1a"><mrow id="S4.p3.10.m3.1.1.1" xref="S4.p3.10.m3.1.1.2.cmml"><mo stretchy="false" id="S4.p3.10.m3.1.1.1.2" xref="S4.p3.10.m3.1.1.2.1.cmml">|</mo><msub id="S4.p3.10.m3.1.1.1.1" xref="S4.p3.10.m3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p3.10.m3.1.1.1.1.2" xref="S4.p3.10.m3.1.1.1.1.2.cmml">𝒯</mi><mi id="S4.p3.10.m3.1.1.1.1.3" xref="S4.p3.10.m3.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.p3.10.m3.1.1.1.3" xref="S4.p3.10.m3.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.10.m3.1b"><apply id="S4.p3.10.m3.1.1.2.cmml" xref="S4.p3.10.m3.1.1.1"><abs id="S4.p3.10.m3.1.1.2.1.cmml" xref="S4.p3.10.m3.1.1.1.2"></abs><apply id="S4.p3.10.m3.1.1.1.1.cmml" xref="S4.p3.10.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.p3.10.m3.1.1.1.1.1.cmml" xref="S4.p3.10.m3.1.1.1.1">subscript</csymbol><ci id="S4.p3.10.m3.1.1.1.1.2.cmml" xref="S4.p3.10.m3.1.1.1.1.2">𝒯</ci><ci id="S4.p3.10.m3.1.1.1.1.3.cmml" xref="S4.p3.10.m3.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.10.m3.1c">|\mathcal{T}_{i}|</annotation></semantics></math> may become imbalanced. To address this issue, we adopt a sampling strategy to obtain a down-sampled knowledge anchor with a limited number of samples for mini-batch local training. We provide the full FedKA algorithm in Algorithm 1.</p>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.1" class="ltx_p">The underlying concept behind Federated Knowledge Anchor is that local training benefits dominant classes, but leads to catastrophic forgetting in non-dominant and missing classes. We aim for the knowledge anchor to act as anchor points in local knowledge preservation, which can alleviate the convergence problem and improve the model performance of federated learning on heterogeneous data. Although this approach is intuitive, theoretical analysis of the knowledge anchor is still challenging, and we leave it as a topic for future research.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>The Setup</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p">In this section, we briefly introduce the experimental setup. Without the explicit declaration, we all conduct the experiments under the default setting mentioned below.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.2" class="ltx_p"><span id="S5.SS1.p2.2.1" class="ltx_text ltx_font_bold">Datasets.</span> We conduct experiments on Cifar10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, Cifar100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, and Tiny-ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, we utilize Dirichlet distribution <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="\text{Dir}(\alpha)" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mrow id="S5.SS1.p2.1.m1.1.2" xref="S5.SS1.p2.1.m1.1.2.cmml"><mtext id="S5.SS1.p2.1.m1.1.2.2" xref="S5.SS1.p2.1.m1.1.2.2a.cmml">Dir</mtext><mo lspace="0em" rspace="0em" id="S5.SS1.p2.1.m1.1.2.1" xref="S5.SS1.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S5.SS1.p2.1.m1.1.2.3.2" xref="S5.SS1.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S5.SS1.p2.1.m1.1.2.3.2.1" xref="S5.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">α</mi><mo stretchy="false" id="S5.SS1.p2.1.m1.1.2.3.2.2" xref="S5.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.2"><times id="S5.SS1.p2.1.m1.1.2.1.cmml" xref="S5.SS1.p2.1.m1.1.2.1"></times><ci id="S5.SS1.p2.1.m1.1.2.2a.cmml" xref="S5.SS1.p2.1.m1.1.2.2"><mtext id="S5.SS1.p2.1.m1.1.2.2.cmml" xref="S5.SS1.p2.1.m1.1.2.2">Dir</mtext></ci><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\text{Dir}(\alpha)</annotation></semantics></math> to generate Non-IID data among clients. The default <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">\alpha</annotation></semantics></math> is set to 0.1 to simulate a strict Non-IID scenario. Such low values tend to result in the SOTA methods performing even worse than baseline FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> as indicated in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. And the default client number is set to 10.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.1" class="ltx_p"><span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">Comparing Methods.</span> We compare our FedKA with SOTA methods to show its superior performance, including FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, FedDyn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and FedNTD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.11" class="ltx_p"><span id="S5.SS1.p4.11.1" class="ltx_text ltx_font_bold">Hyperparameters.</span> For fair comparison, all common hyperparameters are set to the same default value except for additional clarification. We set the communication rounds to 100 for Cifar10/Cifar100 and 20 for Tiny-ImageNet. The default local epoch number is set to 10. The batch size is set to 128, and the down-sampled number of the knowledge anchor is set to 10. For all methods involved in our experiments, we use the classic SGD optimizer with a learning rate of 0.01. The momentum of the SGD optimizer is set to 0.9, and the weight decay is set to 0.00001. All of these settings are common practice in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. To get the best performance of the comparing methods, we carefully tune the involved hyperparameters in each method. We choose the best <math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><mi id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><ci id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">\mu</annotation></semantics></math> in <math id="S5.SS1.p4.2.m2.4" class="ltx_Math" alttext="\{0.1,1,5,10\}" display="inline"><semantics id="S5.SS1.p4.2.m2.4a"><mrow id="S5.SS1.p4.2.m2.4.5.2" xref="S5.SS1.p4.2.m2.4.5.1.cmml"><mo stretchy="false" id="S5.SS1.p4.2.m2.4.5.2.1" xref="S5.SS1.p4.2.m2.4.5.1.cmml">{</mo><mn id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml">0.1</mn><mo id="S5.SS1.p4.2.m2.4.5.2.2" xref="S5.SS1.p4.2.m2.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.2.m2.2.2" xref="S5.SS1.p4.2.m2.2.2.cmml">1</mn><mo id="S5.SS1.p4.2.m2.4.5.2.3" xref="S5.SS1.p4.2.m2.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.2.m2.3.3" xref="S5.SS1.p4.2.m2.3.3.cmml">5</mn><mo id="S5.SS1.p4.2.m2.4.5.2.4" xref="S5.SS1.p4.2.m2.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.2.m2.4.4" xref="S5.SS1.p4.2.m2.4.4.cmml">10</mn><mo stretchy="false" id="S5.SS1.p4.2.m2.4.5.2.5" xref="S5.SS1.p4.2.m2.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.4b"><set id="S5.SS1.p4.2.m2.4.5.1.cmml" xref="S5.SS1.p4.2.m2.4.5.2"><cn type="float" id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">0.1</cn><cn type="integer" id="S5.SS1.p4.2.m2.2.2.cmml" xref="S5.SS1.p4.2.m2.2.2">1</cn><cn type="integer" id="S5.SS1.p4.2.m2.3.3.cmml" xref="S5.SS1.p4.2.m2.3.3">5</cn><cn type="integer" id="S5.SS1.p4.2.m2.4.4.cmml" xref="S5.SS1.p4.2.m2.4.4">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.4c">\{0.1,1,5,10\}</annotation></semantics></math> and set <math id="S5.SS1.p4.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S5.SS1.p4.3.m3.1a"><mi id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><ci id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">\tau</annotation></semantics></math> to 0.5 for MOON as suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, we choose best <math id="S5.SS1.p4.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS1.p4.4.m4.1a"><mi id="S5.SS1.p4.4.m4.1.1" xref="S5.SS1.p4.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.4.m4.1b"><ci id="S5.SS1.p4.4.m4.1.1.cmml" xref="S5.SS1.p4.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.4.m4.1c">\mu</annotation></semantics></math> from <math id="S5.SS1.p4.5.m5.4" class="ltx_Math" alttext="\{0.001,0.01,0.1,1\}" display="inline"><semantics id="S5.SS1.p4.5.m5.4a"><mrow id="S5.SS1.p4.5.m5.4.5.2" xref="S5.SS1.p4.5.m5.4.5.1.cmml"><mo stretchy="false" id="S5.SS1.p4.5.m5.4.5.2.1" xref="S5.SS1.p4.5.m5.4.5.1.cmml">{</mo><mn id="S5.SS1.p4.5.m5.1.1" xref="S5.SS1.p4.5.m5.1.1.cmml">0.001</mn><mo id="S5.SS1.p4.5.m5.4.5.2.2" xref="S5.SS1.p4.5.m5.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.5.m5.2.2" xref="S5.SS1.p4.5.m5.2.2.cmml">0.01</mn><mo id="S5.SS1.p4.5.m5.4.5.2.3" xref="S5.SS1.p4.5.m5.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.5.m5.3.3" xref="S5.SS1.p4.5.m5.3.3.cmml">0.1</mn><mo id="S5.SS1.p4.5.m5.4.5.2.4" xref="S5.SS1.p4.5.m5.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.5.m5.4.4" xref="S5.SS1.p4.5.m5.4.4.cmml">1</mn><mo stretchy="false" id="S5.SS1.p4.5.m5.4.5.2.5" xref="S5.SS1.p4.5.m5.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.5.m5.4b"><set id="S5.SS1.p4.5.m5.4.5.1.cmml" xref="S5.SS1.p4.5.m5.4.5.2"><cn type="float" id="S5.SS1.p4.5.m5.1.1.cmml" xref="S5.SS1.p4.5.m5.1.1">0.001</cn><cn type="float" id="S5.SS1.p4.5.m5.2.2.cmml" xref="S5.SS1.p4.5.m5.2.2">0.01</cn><cn type="float" id="S5.SS1.p4.5.m5.3.3.cmml" xref="S5.SS1.p4.5.m5.3.3">0.1</cn><cn type="integer" id="S5.SS1.p4.5.m5.4.4.cmml" xref="S5.SS1.p4.5.m5.4.4">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.5.m5.4c">\{0.001,0.01,0.1,1\}</annotation></semantics></math> for FedProx. For FedNTD, we also set <math id="S5.SS1.p4.6.m6.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S5.SS1.p4.6.m6.1a"><mrow id="S5.SS1.p4.6.m6.1.1" xref="S5.SS1.p4.6.m6.1.1.cmml"><mi id="S5.SS1.p4.6.m6.1.1.2" xref="S5.SS1.p4.6.m6.1.1.2.cmml">β</mi><mo id="S5.SS1.p4.6.m6.1.1.1" xref="S5.SS1.p4.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.p4.6.m6.1.1.3" xref="S5.SS1.p4.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.6.m6.1b"><apply id="S5.SS1.p4.6.m6.1.1.cmml" xref="S5.SS1.p4.6.m6.1.1"><eq id="S5.SS1.p4.6.m6.1.1.1.cmml" xref="S5.SS1.p4.6.m6.1.1.1"></eq><ci id="S5.SS1.p4.6.m6.1.1.2.cmml" xref="S5.SS1.p4.6.m6.1.1.2">𝛽</ci><cn type="integer" id="S5.SS1.p4.6.m6.1.1.3.cmml" xref="S5.SS1.p4.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.6.m6.1c">\beta=1</annotation></semantics></math> and <math id="S5.SS1.p4.7.m7.1" class="ltx_Math" alttext="\tau=1" display="inline"><semantics id="S5.SS1.p4.7.m7.1a"><mrow id="S5.SS1.p4.7.m7.1.1" xref="S5.SS1.p4.7.m7.1.1.cmml"><mi id="S5.SS1.p4.7.m7.1.1.2" xref="S5.SS1.p4.7.m7.1.1.2.cmml">τ</mi><mo id="S5.SS1.p4.7.m7.1.1.1" xref="S5.SS1.p4.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS1.p4.7.m7.1.1.3" xref="S5.SS1.p4.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.7.m7.1b"><apply id="S5.SS1.p4.7.m7.1.1.cmml" xref="S5.SS1.p4.7.m7.1.1"><eq id="S5.SS1.p4.7.m7.1.1.1.cmml" xref="S5.SS1.p4.7.m7.1.1.1"></eq><ci id="S5.SS1.p4.7.m7.1.1.2.cmml" xref="S5.SS1.p4.7.m7.1.1.2">𝜏</ci><cn type="integer" id="S5.SS1.p4.7.m7.1.1.3.cmml" xref="S5.SS1.p4.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.7.m7.1c">\tau=1</annotation></semantics></math> as instructed in its paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. The <math id="S5.SS1.p4.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.p4.8.m8.1a"><mi id="S5.SS1.p4.8.m8.1.1" xref="S5.SS1.p4.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.8.m8.1b"><ci id="S5.SS1.p4.8.m8.1.1.cmml" xref="S5.SS1.p4.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.8.m8.1c">\alpha</annotation></semantics></math> used in FedDyn is chosen from <math id="S5.SS1.p4.9.m9.4" class="ltx_Math" alttext="\{1,0.1,0.01,0.001\}" display="inline"><semantics id="S5.SS1.p4.9.m9.4a"><mrow id="S5.SS1.p4.9.m9.4.5.2" xref="S5.SS1.p4.9.m9.4.5.1.cmml"><mo stretchy="false" id="S5.SS1.p4.9.m9.4.5.2.1" xref="S5.SS1.p4.9.m9.4.5.1.cmml">{</mo><mn id="S5.SS1.p4.9.m9.1.1" xref="S5.SS1.p4.9.m9.1.1.cmml">1</mn><mo id="S5.SS1.p4.9.m9.4.5.2.2" xref="S5.SS1.p4.9.m9.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.9.m9.2.2" xref="S5.SS1.p4.9.m9.2.2.cmml">0.1</mn><mo id="S5.SS1.p4.9.m9.4.5.2.3" xref="S5.SS1.p4.9.m9.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.9.m9.3.3" xref="S5.SS1.p4.9.m9.3.3.cmml">0.01</mn><mo id="S5.SS1.p4.9.m9.4.5.2.4" xref="S5.SS1.p4.9.m9.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.9.m9.4.4" xref="S5.SS1.p4.9.m9.4.4.cmml">0.001</mn><mo stretchy="false" id="S5.SS1.p4.9.m9.4.5.2.5" xref="S5.SS1.p4.9.m9.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.9.m9.4b"><set id="S5.SS1.p4.9.m9.4.5.1.cmml" xref="S5.SS1.p4.9.m9.4.5.2"><cn type="integer" id="S5.SS1.p4.9.m9.1.1.cmml" xref="S5.SS1.p4.9.m9.1.1">1</cn><cn type="float" id="S5.SS1.p4.9.m9.2.2.cmml" xref="S5.SS1.p4.9.m9.2.2">0.1</cn><cn type="float" id="S5.SS1.p4.9.m9.3.3.cmml" xref="S5.SS1.p4.9.m9.3.3">0.01</cn><cn type="float" id="S5.SS1.p4.9.m9.4.4.cmml" xref="S5.SS1.p4.9.m9.4.4">0.001</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.9.m9.4c">\{1,0.1,0.01,0.001\}</annotation></semantics></math> as instructed in its paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. The <math id="S5.SS1.p4.10.m10.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.p4.10.m10.1a"><mi id="S5.SS1.p4.10.m10.1.1" xref="S5.SS1.p4.10.m10.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.10.m10.1b"><ci id="S5.SS1.p4.10.m10.1.1.cmml" xref="S5.SS1.p4.10.m10.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.10.m10.1c">\beta</annotation></semantics></math> used in proposed FedKA is chosen from <math id="S5.SS1.p4.11.m11.4" class="ltx_Math" alttext="\{0.5,0.1,0.01,0.001\}" display="inline"><semantics id="S5.SS1.p4.11.m11.4a"><mrow id="S5.SS1.p4.11.m11.4.5.2" xref="S5.SS1.p4.11.m11.4.5.1.cmml"><mo stretchy="false" id="S5.SS1.p4.11.m11.4.5.2.1" xref="S5.SS1.p4.11.m11.4.5.1.cmml">{</mo><mn id="S5.SS1.p4.11.m11.1.1" xref="S5.SS1.p4.11.m11.1.1.cmml">0.5</mn><mo id="S5.SS1.p4.11.m11.4.5.2.2" xref="S5.SS1.p4.11.m11.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.11.m11.2.2" xref="S5.SS1.p4.11.m11.2.2.cmml">0.1</mn><mo id="S5.SS1.p4.11.m11.4.5.2.3" xref="S5.SS1.p4.11.m11.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.11.m11.3.3" xref="S5.SS1.p4.11.m11.3.3.cmml">0.01</mn><mo id="S5.SS1.p4.11.m11.4.5.2.4" xref="S5.SS1.p4.11.m11.4.5.1.cmml">,</mo><mn id="S5.SS1.p4.11.m11.4.4" xref="S5.SS1.p4.11.m11.4.4.cmml">0.001</mn><mo stretchy="false" id="S5.SS1.p4.11.m11.4.5.2.5" xref="S5.SS1.p4.11.m11.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.11.m11.4b"><set id="S5.SS1.p4.11.m11.4.5.1.cmml" xref="S5.SS1.p4.11.m11.4.5.2"><cn type="float" id="S5.SS1.p4.11.m11.1.1.cmml" xref="S5.SS1.p4.11.m11.1.1">0.5</cn><cn type="float" id="S5.SS1.p4.11.m11.2.2.cmml" xref="S5.SS1.p4.11.m11.2.2">0.1</cn><cn type="float" id="S5.SS1.p4.11.m11.3.3.cmml" xref="S5.SS1.p4.11.m11.3.3">0.01</cn><cn type="float" id="S5.SS1.p4.11.m11.4.4.cmml" xref="S5.SS1.p4.11.m11.4.4">0.001</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.11.m11.4c">\{0.5,0.1,0.01,0.001\}</annotation></semantics></math>.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para ltx_noindent">
<p id="S5.SS1.p5.1" class="ltx_p"><span id="S5.SS1.p5.1.1" class="ltx_text ltx_font_bold">Models.</span> We conduct experiments on two networks of different scales. For Cifar10, we train the t-CNN. For Cifar100 and Tiny-ImageNet, we train ResNet-50 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> for comparison. We modify the output projector of ResNet-50 to get the expected dimension.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.27" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.27.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>

</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span id="algorithm1.8.8.1" class="ltx_text"><span id="algorithm1.8.8.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>client number <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">N</annotation></semantics></math>, client set <math id="algorithm1.2.2.m2.3" class="ltx_Math" alttext="\{c_{1},...,c_{N}\}" display="inline"><semantics id="algorithm1.2.2.m2.3a"><mrow id="algorithm1.2.2.m2.3.3.2" xref="algorithm1.2.2.m2.3.3.3.cmml"><mo stretchy="false" id="algorithm1.2.2.m2.3.3.2.3" xref="algorithm1.2.2.m2.3.3.3.cmml">{</mo><msub id="algorithm1.2.2.m2.2.2.1.1" xref="algorithm1.2.2.m2.2.2.1.1.cmml"><mi id="algorithm1.2.2.m2.2.2.1.1.2" xref="algorithm1.2.2.m2.2.2.1.1.2.cmml">c</mi><mn id="algorithm1.2.2.m2.2.2.1.1.3" xref="algorithm1.2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="algorithm1.2.2.m2.3.3.2.4" xref="algorithm1.2.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">…</mi><mo id="algorithm1.2.2.m2.3.3.2.5" xref="algorithm1.2.2.m2.3.3.3.cmml">,</mo><msub id="algorithm1.2.2.m2.3.3.2.2" xref="algorithm1.2.2.m2.3.3.2.2.cmml"><mi id="algorithm1.2.2.m2.3.3.2.2.2" xref="algorithm1.2.2.m2.3.3.2.2.2.cmml">c</mi><mi id="algorithm1.2.2.m2.3.3.2.2.3" xref="algorithm1.2.2.m2.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="algorithm1.2.2.m2.3.3.2.6" xref="algorithm1.2.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.3b"><set id="algorithm1.2.2.m2.3.3.3.cmml" xref="algorithm1.2.2.m2.3.3.2"><apply id="algorithm1.2.2.m2.2.2.1.1.cmml" xref="algorithm1.2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.2.2.1.1.1.cmml" xref="algorithm1.2.2.m2.2.2.1.1">subscript</csymbol><ci id="algorithm1.2.2.m2.2.2.1.1.2.cmml" xref="algorithm1.2.2.m2.2.2.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.2.2.m2.2.2.1.1.3.cmml" xref="algorithm1.2.2.m2.2.2.1.1.3">1</cn></apply><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">…</ci><apply id="algorithm1.2.2.m2.3.3.2.2.cmml" xref="algorithm1.2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.3.3.2.2.1.cmml" xref="algorithm1.2.2.m2.3.3.2.2">subscript</csymbol><ci id="algorithm1.2.2.m2.3.3.2.2.2.cmml" xref="algorithm1.2.2.m2.3.3.2.2.2">𝑐</ci><ci id="algorithm1.2.2.m2.3.3.2.2.3.cmml" xref="algorithm1.2.2.m2.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.3c">\{c_{1},...,c_{N}\}</annotation></semantics></math>, dataset <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="\mathcal{D}=\mathcal{D}_{1}\cup...\cup\mathcal{D}_{N}" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mrow id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.3.3.m3.1.1.2" xref="algorithm1.3.3.m3.1.1.2.cmml">𝒟</mi><mo id="algorithm1.3.3.m3.1.1.1" xref="algorithm1.3.3.m3.1.1.1.cmml">=</mo><mrow id="algorithm1.3.3.m3.1.1.3" xref="algorithm1.3.3.m3.1.1.3.cmml"><msub id="algorithm1.3.3.m3.1.1.3.2" xref="algorithm1.3.3.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.3.3.m3.1.1.3.2.2" xref="algorithm1.3.3.m3.1.1.3.2.2.cmml">𝒟</mi><mn id="algorithm1.3.3.m3.1.1.3.2.3" xref="algorithm1.3.3.m3.1.1.3.2.3.cmml">1</mn></msub><mo id="algorithm1.3.3.m3.1.1.3.1" xref="algorithm1.3.3.m3.1.1.3.1.cmml">∪</mo><mi mathvariant="normal" id="algorithm1.3.3.m3.1.1.3.3" xref="algorithm1.3.3.m3.1.1.3.3.cmml">…</mi><mo id="algorithm1.3.3.m3.1.1.3.1a" xref="algorithm1.3.3.m3.1.1.3.1.cmml">∪</mo><msub id="algorithm1.3.3.m3.1.1.3.4" xref="algorithm1.3.3.m3.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.3.3.m3.1.1.3.4.2" xref="algorithm1.3.3.m3.1.1.3.4.2.cmml">𝒟</mi><mi id="algorithm1.3.3.m3.1.1.3.4.3" xref="algorithm1.3.3.m3.1.1.3.4.3.cmml">N</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><apply id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1"><eq id="algorithm1.3.3.m3.1.1.1.cmml" xref="algorithm1.3.3.m3.1.1.1"></eq><ci id="algorithm1.3.3.m3.1.1.2.cmml" xref="algorithm1.3.3.m3.1.1.2">𝒟</ci><apply id="algorithm1.3.3.m3.1.1.3.cmml" xref="algorithm1.3.3.m3.1.1.3"><union id="algorithm1.3.3.m3.1.1.3.1.cmml" xref="algorithm1.3.3.m3.1.1.3.1"></union><apply id="algorithm1.3.3.m3.1.1.3.2.cmml" xref="algorithm1.3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.1.1.3.2.1.cmml" xref="algorithm1.3.3.m3.1.1.3.2">subscript</csymbol><ci id="algorithm1.3.3.m3.1.1.3.2.2.cmml" xref="algorithm1.3.3.m3.1.1.3.2.2">𝒟</ci><cn type="integer" id="algorithm1.3.3.m3.1.1.3.2.3.cmml" xref="algorithm1.3.3.m3.1.1.3.2.3">1</cn></apply><ci id="algorithm1.3.3.m3.1.1.3.3.cmml" xref="algorithm1.3.3.m3.1.1.3.3">…</ci><apply id="algorithm1.3.3.m3.1.1.3.4.cmml" xref="algorithm1.3.3.m3.1.1.3.4"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.1.1.3.4.1.cmml" xref="algorithm1.3.3.m3.1.1.3.4">subscript</csymbol><ci id="algorithm1.3.3.m3.1.1.3.4.2.cmml" xref="algorithm1.3.3.m3.1.1.3.4.2">𝒟</ci><ci id="algorithm1.3.3.m3.1.1.3.4.3.cmml" xref="algorithm1.3.3.m3.1.1.3.4.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">\mathcal{D}=\mathcal{D}_{1}\cup...\cup\mathcal{D}_{N}</annotation></semantics></math>, local epochs <math id="algorithm1.4.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm1.4.4.m4.1a"><mi id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><ci id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">E</annotation></semantics></math>, communication round <math id="algorithm1.5.5.m5.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="algorithm1.5.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><ci id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">\mathcal{R}</annotation></semantics></math>, limited knowledge anchor number <math id="algorithm1.6.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="algorithm1.6.6.m6.1a"><mi id="algorithm1.6.6.m6.1.1" xref="algorithm1.6.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m6.1b"><ci id="algorithm1.6.6.m6.1.1.cmml" xref="algorithm1.6.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m6.1c">\mu</annotation></semantics></math>, model <math id="algorithm1.7.7.m7.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}" display="inline"><semantics id="algorithm1.7.7.m7.1a"><msub id="algorithm1.7.7.m7.1.1" xref="algorithm1.7.7.m7.1.1.cmml"><mi id="algorithm1.7.7.m7.1.1.2" xref="algorithm1.7.7.m7.1.1.2.cmml">f</mi><mi id="algorithm1.7.7.m7.1.1.3" xref="algorithm1.7.7.m7.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m7.1b"><apply id="algorithm1.7.7.m7.1.1.cmml" xref="algorithm1.7.7.m7.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m7.1.1.1.cmml" xref="algorithm1.7.7.m7.1.1">subscript</csymbol><ci id="algorithm1.7.7.m7.1.1.2.cmml" xref="algorithm1.7.7.m7.1.1.2">𝑓</ci><ci id="algorithm1.7.7.m7.1.1.3.cmml" xref="algorithm1.7.7.m7.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m7.1c">f_{\boldsymbol{\theta}}</annotation></semantics></math>, loss weight <math id="algorithm1.8.8.m8.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="algorithm1.8.8.m8.1a"><mi id="algorithm1.8.8.m8.1.1" xref="algorithm1.8.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m8.1b"><ci id="algorithm1.8.8.m8.1.1.cmml" xref="algorithm1.8.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m8.1c">\beta</annotation></semantics></math>.
</div>
<div id="algorithm1.27.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>


</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>
<span id="algorithm1.9.9.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.9.9.1" class="ltx_emph ltx_font_italic">each client <math id="algorithm1.9.9.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="algorithm1.9.9.1.m1.1a"><msub id="algorithm1.9.9.1.m1.1.1" xref="algorithm1.9.9.1.m1.1.1.cmml"><mi id="algorithm1.9.9.1.m1.1.1.2" xref="algorithm1.9.9.1.m1.1.1.2.cmml">c</mi><mi id="algorithm1.9.9.1.m1.1.1.3" xref="algorithm1.9.9.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.m1.1b"><apply id="algorithm1.9.9.1.m1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.1.m1.1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1">subscript</csymbol><ci id="algorithm1.9.9.1.m1.1.1.2.cmml" xref="algorithm1.9.9.1.m1.1.1.2">𝑐</ci><ci id="algorithm1.9.9.1.m1.1.1.3.cmml" xref="algorithm1.9.9.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.m1.1c">c_{i}</annotation></semantics></math></em> <span id="algorithm1.9.9.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
calculate its dominant, non-dominant, missing classes <math id="algorithm1.10.10.m1.3" class="ltx_Math" alttext="C_{d}^{i},C_{n}^{i},C_{m}^{i}" display="inline"><semantics id="algorithm1.10.10.m1.3a"><mrow id="algorithm1.10.10.m1.3.3.3" xref="algorithm1.10.10.m1.3.3.4.cmml"><msubsup id="algorithm1.10.10.m1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.cmml"><mi id="algorithm1.10.10.m1.1.1.1.1.2.2" xref="algorithm1.10.10.m1.1.1.1.1.2.2.cmml">C</mi><mi id="algorithm1.10.10.m1.1.1.1.1.2.3" xref="algorithm1.10.10.m1.1.1.1.1.2.3.cmml">d</mi><mi id="algorithm1.10.10.m1.1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="algorithm1.10.10.m1.3.3.3.4" xref="algorithm1.10.10.m1.3.3.4.cmml">,</mo><msubsup id="algorithm1.10.10.m1.2.2.2.2" xref="algorithm1.10.10.m1.2.2.2.2.cmml"><mi id="algorithm1.10.10.m1.2.2.2.2.2.2" xref="algorithm1.10.10.m1.2.2.2.2.2.2.cmml">C</mi><mi id="algorithm1.10.10.m1.2.2.2.2.2.3" xref="algorithm1.10.10.m1.2.2.2.2.2.3.cmml">n</mi><mi id="algorithm1.10.10.m1.2.2.2.2.3" xref="algorithm1.10.10.m1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="algorithm1.10.10.m1.3.3.3.5" xref="algorithm1.10.10.m1.3.3.4.cmml">,</mo><msubsup id="algorithm1.10.10.m1.3.3.3.3" xref="algorithm1.10.10.m1.3.3.3.3.cmml"><mi id="algorithm1.10.10.m1.3.3.3.3.2.2" xref="algorithm1.10.10.m1.3.3.3.3.2.2.cmml">C</mi><mi id="algorithm1.10.10.m1.3.3.3.3.2.3" xref="algorithm1.10.10.m1.3.3.3.3.2.3.cmml">m</mi><mi id="algorithm1.10.10.m1.3.3.3.3.3" xref="algorithm1.10.10.m1.3.3.3.3.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.3b"><list id="algorithm1.10.10.m1.3.3.4.cmml" xref="algorithm1.10.10.m1.3.3.3"><apply id="algorithm1.10.10.m1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1">superscript</csymbol><apply id="algorithm1.10.10.m1.1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.1.2.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.1.1.2.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1.2.2">𝐶</ci><ci id="algorithm1.10.10.m1.1.1.1.1.2.3.cmml" xref="algorithm1.10.10.m1.1.1.1.1.2.3">𝑑</ci></apply><ci id="algorithm1.10.10.m1.1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.10.10.m1.2.2.2.2.cmml" xref="algorithm1.10.10.m1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.2.2.2.2.1.cmml" xref="algorithm1.10.10.m1.2.2.2.2">superscript</csymbol><apply id="algorithm1.10.10.m1.2.2.2.2.2.cmml" xref="algorithm1.10.10.m1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.2.2.2.2.2.1.cmml" xref="algorithm1.10.10.m1.2.2.2.2">subscript</csymbol><ci id="algorithm1.10.10.m1.2.2.2.2.2.2.cmml" xref="algorithm1.10.10.m1.2.2.2.2.2.2">𝐶</ci><ci id="algorithm1.10.10.m1.2.2.2.2.2.3.cmml" xref="algorithm1.10.10.m1.2.2.2.2.2.3">𝑛</ci></apply><ci id="algorithm1.10.10.m1.2.2.2.2.3.cmml" xref="algorithm1.10.10.m1.2.2.2.2.3">𝑖</ci></apply><apply id="algorithm1.10.10.m1.3.3.3.3.cmml" xref="algorithm1.10.10.m1.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.3.3.3.3.1.cmml" xref="algorithm1.10.10.m1.3.3.3.3">superscript</csymbol><apply id="algorithm1.10.10.m1.3.3.3.3.2.cmml" xref="algorithm1.10.10.m1.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.3.3.3.3.2.1.cmml" xref="algorithm1.10.10.m1.3.3.3.3">subscript</csymbol><ci id="algorithm1.10.10.m1.3.3.3.3.2.2.cmml" xref="algorithm1.10.10.m1.3.3.3.3.2.2">𝐶</ci><ci id="algorithm1.10.10.m1.3.3.3.3.2.3.cmml" xref="algorithm1.10.10.m1.3.3.3.3.2.3">𝑚</ci></apply><ci id="algorithm1.10.10.m1.3.3.3.3.3.cmml" xref="algorithm1.10.10.m1.3.3.3.3.3">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.3c">C_{d}^{i},C_{n}^{i},C_{m}^{i}</annotation></semantics></math>.

</div>
<div id="algorithm1.27.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span><span id="algorithm1.11.11.1" class="ltx_text ltx_font_bold">construct</span> minimal shared dataset <math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="algorithm1.11.11.m1.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><ci id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">\mathcal{S}</annotation></semantics></math>.

</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span id="algorithm1.12.12.1" class="ltx_text ltx_font_bold">Initialize</span> global model parameter. <math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="\boldsymbol{\theta}^{0}_{g}" display="inline"><semantics id="algorithm1.12.12.m1.1a"><msubsup id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><mi id="algorithm1.12.12.m1.1.1.2.2" xref="algorithm1.12.12.m1.1.1.2.2.cmml">𝜽</mi><mi id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml">g</mi><mn id="algorithm1.12.12.m1.1.1.2.3" xref="algorithm1.12.12.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1">subscript</csymbol><apply id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.2.1.cmml" xref="algorithm1.12.12.m1.1.1">superscript</csymbol><ci id="algorithm1.12.12.m1.1.1.2.2.cmml" xref="algorithm1.12.12.m1.1.1.2.2">𝜽</ci><cn type="integer" id="algorithm1.12.12.m1.1.1.2.3.cmml" xref="algorithm1.12.12.m1.1.1.2.3">0</cn></apply><ci id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">\boldsymbol{\theta}^{0}_{g}</annotation></semantics></math>

</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span><span id="algorithm1.13.13.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.13.13.1" class="ltx_emph ltx_font_italic">each communication round <math id="algorithm1.13.13.1.m1.3" class="ltx_Math" alttext="r=1,...,\mathcal{R}" display="inline"><semantics id="algorithm1.13.13.1.m1.3a"><mrow id="algorithm1.13.13.1.m1.3.4" xref="algorithm1.13.13.1.m1.3.4.cmml"><mi id="algorithm1.13.13.1.m1.3.4.2" xref="algorithm1.13.13.1.m1.3.4.2.cmml">r</mi><mo id="algorithm1.13.13.1.m1.3.4.1" xref="algorithm1.13.13.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm1.13.13.1.m1.3.4.3.2" xref="algorithm1.13.13.1.m1.3.4.3.1.cmml"><mn id="algorithm1.13.13.1.m1.1.1" xref="algorithm1.13.13.1.m1.1.1.cmml">1</mn><mo id="algorithm1.13.13.1.m1.3.4.3.2.1" xref="algorithm1.13.13.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.13.13.1.m1.2.2" xref="algorithm1.13.13.1.m1.2.2.cmml">…</mi><mo id="algorithm1.13.13.1.m1.3.4.3.2.2" xref="algorithm1.13.13.1.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.13.13.1.m1.3.3" xref="algorithm1.13.13.1.m1.3.3.cmml">ℛ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.1.m1.3b"><apply id="algorithm1.13.13.1.m1.3.4.cmml" xref="algorithm1.13.13.1.m1.3.4"><eq id="algorithm1.13.13.1.m1.3.4.1.cmml" xref="algorithm1.13.13.1.m1.3.4.1"></eq><ci id="algorithm1.13.13.1.m1.3.4.2.cmml" xref="algorithm1.13.13.1.m1.3.4.2">𝑟</ci><list id="algorithm1.13.13.1.m1.3.4.3.1.cmml" xref="algorithm1.13.13.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.13.13.1.m1.1.1.cmml" xref="algorithm1.13.13.1.m1.1.1">1</cn><ci id="algorithm1.13.13.1.m1.2.2.cmml" xref="algorithm1.13.13.1.m1.2.2">…</ci><ci id="algorithm1.13.13.1.m1.3.3.cmml" xref="algorithm1.13.13.1.m1.3.3">ℛ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.1.m1.3c">r=1,...,\mathcal{R}</annotation></semantics></math></em> <span id="algorithm1.13.13.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
sample the client set to get the participated client set <math id="algorithm1.14.14.m1.1" class="ltx_Math" alttext="\mathcal{P}^{r}" display="inline"><semantics id="algorithm1.14.14.m1.1a"><msup id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.14.14.m1.1.1.2" xref="algorithm1.14.14.m1.1.1.2.cmml">𝒫</mi><mi id="algorithm1.14.14.m1.1.1.3" xref="algorithm1.14.14.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1">superscript</csymbol><ci id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.2">𝒫</ci><ci id="algorithm1.14.14.m1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">\mathcal{P}^{r}</annotation></semantics></math>.

</div>
<div id="algorithm1.27.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   distribute the global model to each participated client:

</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="\boldsymbol{\theta}^{r-1}_{i}\leftarrow\boldsymbol{\theta}^{r}_{g}" display="inline"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><msubsup id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml"><mi id="algorithm1.15.15.m1.1.1.2.2.2" xref="algorithm1.15.15.m1.1.1.2.2.2.cmml">𝜽</mi><mi id="algorithm1.15.15.m1.1.1.2.3" xref="algorithm1.15.15.m1.1.1.2.3.cmml">i</mi><mrow id="algorithm1.15.15.m1.1.1.2.2.3" xref="algorithm1.15.15.m1.1.1.2.2.3.cmml"><mi id="algorithm1.15.15.m1.1.1.2.2.3.2" xref="algorithm1.15.15.m1.1.1.2.2.3.2.cmml">r</mi><mo id="algorithm1.15.15.m1.1.1.2.2.3.1" xref="algorithm1.15.15.m1.1.1.2.2.3.1.cmml">−</mo><mn id="algorithm1.15.15.m1.1.1.2.2.3.3" xref="algorithm1.15.15.m1.1.1.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="algorithm1.15.15.m1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.cmml">←</mo><msubsup id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml"><mi id="algorithm1.15.15.m1.1.1.3.2.2" xref="algorithm1.15.15.m1.1.1.3.2.2.cmml">𝜽</mi><mi id="algorithm1.15.15.m1.1.1.3.3" xref="algorithm1.15.15.m1.1.1.3.3.cmml">g</mi><mi id="algorithm1.15.15.m1.1.1.3.2.3" xref="algorithm1.15.15.m1.1.1.3.2.3.cmml">r</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><ci id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1">←</ci><apply id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.2.1.cmml" xref="algorithm1.15.15.m1.1.1.2">subscript</csymbol><apply id="algorithm1.15.15.m1.1.1.2.2.cmml" xref="algorithm1.15.15.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.2.2.1.cmml" xref="algorithm1.15.15.m1.1.1.2">superscript</csymbol><ci id="algorithm1.15.15.m1.1.1.2.2.2.cmml" xref="algorithm1.15.15.m1.1.1.2.2.2">𝜽</ci><apply id="algorithm1.15.15.m1.1.1.2.2.3.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3"><minus id="algorithm1.15.15.m1.1.1.2.2.3.1.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3.1"></minus><ci id="algorithm1.15.15.m1.1.1.2.2.3.2.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3.2">𝑟</ci><cn type="integer" id="algorithm1.15.15.m1.1.1.2.2.3.3.cmml" xref="algorithm1.15.15.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.15.15.m1.1.1.2.3.cmml" xref="algorithm1.15.15.m1.1.1.2.3">𝑖</ci></apply><apply id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.3.1.cmml" xref="algorithm1.15.15.m1.1.1.3">subscript</csymbol><apply id="algorithm1.15.15.m1.1.1.3.2.cmml" xref="algorithm1.15.15.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.3.2.1.cmml" xref="algorithm1.15.15.m1.1.1.3">superscript</csymbol><ci id="algorithm1.15.15.m1.1.1.3.2.2.cmml" xref="algorithm1.15.15.m1.1.1.3.2.2">𝜽</ci><ci id="algorithm1.15.15.m1.1.1.3.2.3.cmml" xref="algorithm1.15.15.m1.1.1.3.2.3">𝑟</ci></apply><ci id="algorithm1.15.15.m1.1.1.3.3.cmml" xref="algorithm1.15.15.m1.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">\boldsymbol{\theta}^{r-1}_{i}\leftarrow\boldsymbol{\theta}^{r}_{g}</annotation></semantics></math>

</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.17.17.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.17.17.2" class="ltx_emph ltx_font_italic">each client <math id="algorithm1.16.16.1.m1.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="algorithm1.16.16.1.m1.1a"><msub id="algorithm1.16.16.1.m1.1.1" xref="algorithm1.16.16.1.m1.1.1.cmml"><mi id="algorithm1.16.16.1.m1.1.1.2" xref="algorithm1.16.16.1.m1.1.1.2.cmml">c</mi><mi id="algorithm1.16.16.1.m1.1.1.3" xref="algorithm1.16.16.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.1.m1.1b"><apply id="algorithm1.16.16.1.m1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.1.m1.1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1">subscript</csymbol><ci id="algorithm1.16.16.1.m1.1.1.2.cmml" xref="algorithm1.16.16.1.m1.1.1.2">𝑐</ci><ci id="algorithm1.16.16.1.m1.1.1.3.cmml" xref="algorithm1.16.16.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.1.m1.1c">c_{i}</annotation></semantics></math> in <math id="algorithm1.17.17.2.m2.1" class="ltx_Math" alttext="\mathcal{P}^{r}" display="inline"><semantics id="algorithm1.17.17.2.m2.1a"><msup id="algorithm1.17.17.2.m2.1.1" xref="algorithm1.17.17.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.17.17.2.m2.1.1.2" xref="algorithm1.17.17.2.m2.1.1.2.cmml">𝒫</mi><mi id="algorithm1.17.17.2.m2.1.1.3" xref="algorithm1.17.17.2.m2.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.2.m2.1b"><apply id="algorithm1.17.17.2.m2.1.1.cmml" xref="algorithm1.17.17.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.2.m2.1.1.1.cmml" xref="algorithm1.17.17.2.m2.1.1">superscript</csymbol><ci id="algorithm1.17.17.2.m2.1.1.2.cmml" xref="algorithm1.17.17.2.m2.1.1.2">𝒫</ci><ci id="algorithm1.17.17.2.m2.1.1.3.cmml" xref="algorithm1.17.17.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.2.m2.1c">\mathcal{P}^{r}</annotation></semantics></math></em> <span id="algorithm1.17.17.4" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
construct its knowledge anchor <math id="algorithm1.18.18.m1.1" class="ltx_Math" alttext="\mathcal{T}_{i}^{r}" display="inline"><semantics id="algorithm1.18.18.m1.1a"><msubsup id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.18.18.m1.1.1.2.2" xref="algorithm1.18.18.m1.1.1.2.2.cmml">𝒯</mi><mi id="algorithm1.18.18.m1.1.1.2.3" xref="algorithm1.18.18.m1.1.1.2.3.cmml">i</mi><mi id="algorithm1.18.18.m1.1.1.3" xref="algorithm1.18.18.m1.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1">superscript</csymbol><apply id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.2.1.cmml" xref="algorithm1.18.18.m1.1.1">subscript</csymbol><ci id="algorithm1.18.18.m1.1.1.2.2.cmml" xref="algorithm1.18.18.m1.1.1.2.2">𝒯</ci><ci id="algorithm1.18.18.m1.1.1.2.3.cmml" xref="algorithm1.18.18.m1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.18.18.m1.1.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">\mathcal{T}_{i}^{r}</annotation></semantics></math> for this round using: <math id="algorithm1.19.19.m2.4" class="ltx_Math" alttext="\mathcal{T}_{i}^{r}=\{\psi(k,\mathcal{D}_{i},\mathcal{S})|k\in C_{m}^{i}\cup C_{n}^{i}\}" display="inline"><semantics id="algorithm1.19.19.m2.4a"><mrow id="algorithm1.19.19.m2.4.4" xref="algorithm1.19.19.m2.4.4.cmml"><msubsup id="algorithm1.19.19.m2.4.4.4" xref="algorithm1.19.19.m2.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.19.19.m2.4.4.4.2.2" xref="algorithm1.19.19.m2.4.4.4.2.2.cmml">𝒯</mi><mi id="algorithm1.19.19.m2.4.4.4.2.3" xref="algorithm1.19.19.m2.4.4.4.2.3.cmml">i</mi><mi id="algorithm1.19.19.m2.4.4.4.3" xref="algorithm1.19.19.m2.4.4.4.3.cmml">r</mi></msubsup><mo id="algorithm1.19.19.m2.4.4.3" xref="algorithm1.19.19.m2.4.4.3.cmml">=</mo><mrow id="algorithm1.19.19.m2.4.4.2.2" xref="algorithm1.19.19.m2.4.4.2.3.cmml"><mo stretchy="false" id="algorithm1.19.19.m2.4.4.2.2.3" xref="algorithm1.19.19.m2.4.4.2.3.1.cmml">{</mo><mrow id="algorithm1.19.19.m2.3.3.1.1.1" xref="algorithm1.19.19.m2.3.3.1.1.1.cmml"><mi id="algorithm1.19.19.m2.3.3.1.1.1.3" xref="algorithm1.19.19.m2.3.3.1.1.1.3.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m2.3.3.1.1.1.2" xref="algorithm1.19.19.m2.3.3.1.1.1.2.cmml">​</mo><mrow id="algorithm1.19.19.m2.3.3.1.1.1.1.1" xref="algorithm1.19.19.m2.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.19.19.m2.3.3.1.1.1.1.1.2" xref="algorithm1.19.19.m2.3.3.1.1.1.1.2.cmml">(</mo><mi id="algorithm1.19.19.m2.1.1" xref="algorithm1.19.19.m2.1.1.cmml">k</mi><mo id="algorithm1.19.19.m2.3.3.1.1.1.1.1.3" xref="algorithm1.19.19.m2.3.3.1.1.1.1.2.cmml">,</mo><msub id="algorithm1.19.19.m2.3.3.1.1.1.1.1.1" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.2" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.3" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.19.19.m2.3.3.1.1.1.1.1.4" xref="algorithm1.19.19.m2.3.3.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.19.19.m2.2.2" xref="algorithm1.19.19.m2.2.2.cmml">𝒮</mi><mo stretchy="false" id="algorithm1.19.19.m2.3.3.1.1.1.1.1.5" xref="algorithm1.19.19.m2.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m2.4.4.2.2.4" xref="algorithm1.19.19.m2.4.4.2.3.1.cmml">|</mo><mrow id="algorithm1.19.19.m2.4.4.2.2.2" xref="algorithm1.19.19.m2.4.4.2.2.2.cmml"><mi id="algorithm1.19.19.m2.4.4.2.2.2.2" xref="algorithm1.19.19.m2.4.4.2.2.2.2.cmml">k</mi><mo id="algorithm1.19.19.m2.4.4.2.2.2.1" xref="algorithm1.19.19.m2.4.4.2.2.2.1.cmml">∈</mo><mrow id="algorithm1.19.19.m2.4.4.2.2.2.3" xref="algorithm1.19.19.m2.4.4.2.2.2.3.cmml"><msubsup id="algorithm1.19.19.m2.4.4.2.2.2.3.2" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2.cmml"><mi id="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.2" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.2.cmml">C</mi><mi id="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.3" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.3.cmml">m</mi><mi id="algorithm1.19.19.m2.4.4.2.2.2.3.2.3" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2.3.cmml">i</mi></msubsup><mo id="algorithm1.19.19.m2.4.4.2.2.2.3.1" xref="algorithm1.19.19.m2.4.4.2.2.2.3.1.cmml">∪</mo><msubsup id="algorithm1.19.19.m2.4.4.2.2.2.3.3" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3.cmml"><mi id="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.2" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.2.cmml">C</mi><mi id="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.3" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.3.cmml">n</mi><mi id="algorithm1.19.19.m2.4.4.2.2.2.3.3.3" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3.3.cmml">i</mi></msubsup></mrow></mrow><mo stretchy="false" id="algorithm1.19.19.m2.4.4.2.2.5" xref="algorithm1.19.19.m2.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m2.4b"><apply id="algorithm1.19.19.m2.4.4.cmml" xref="algorithm1.19.19.m2.4.4"><eq id="algorithm1.19.19.m2.4.4.3.cmml" xref="algorithm1.19.19.m2.4.4.3"></eq><apply id="algorithm1.19.19.m2.4.4.4.cmml" xref="algorithm1.19.19.m2.4.4.4"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.4.4.4.1.cmml" xref="algorithm1.19.19.m2.4.4.4">superscript</csymbol><apply id="algorithm1.19.19.m2.4.4.4.2.cmml" xref="algorithm1.19.19.m2.4.4.4"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.4.4.4.2.1.cmml" xref="algorithm1.19.19.m2.4.4.4">subscript</csymbol><ci id="algorithm1.19.19.m2.4.4.4.2.2.cmml" xref="algorithm1.19.19.m2.4.4.4.2.2">𝒯</ci><ci id="algorithm1.19.19.m2.4.4.4.2.3.cmml" xref="algorithm1.19.19.m2.4.4.4.2.3">𝑖</ci></apply><ci id="algorithm1.19.19.m2.4.4.4.3.cmml" xref="algorithm1.19.19.m2.4.4.4.3">𝑟</ci></apply><apply id="algorithm1.19.19.m2.4.4.2.3.cmml" xref="algorithm1.19.19.m2.4.4.2.2"><csymbol cd="latexml" id="algorithm1.19.19.m2.4.4.2.3.1.cmml" xref="algorithm1.19.19.m2.4.4.2.2.3">conditional-set</csymbol><apply id="algorithm1.19.19.m2.3.3.1.1.1.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1"><times id="algorithm1.19.19.m2.3.3.1.1.1.2.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1.2"></times><ci id="algorithm1.19.19.m2.3.3.1.1.1.3.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1.3">𝜓</ci><vector id="algorithm1.19.19.m2.3.3.1.1.1.1.2.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1"><ci id="algorithm1.19.19.m2.1.1.cmml" xref="algorithm1.19.19.m2.1.1">𝑘</ci><apply id="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.1.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.2.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.2">𝒟</ci><ci id="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.3.cmml" xref="algorithm1.19.19.m2.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="algorithm1.19.19.m2.2.2.cmml" xref="algorithm1.19.19.m2.2.2">𝒮</ci></vector></apply><apply id="algorithm1.19.19.m2.4.4.2.2.2.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2"><in id="algorithm1.19.19.m2.4.4.2.2.2.1.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.1"></in><ci id="algorithm1.19.19.m2.4.4.2.2.2.2.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.2">𝑘</ci><apply id="algorithm1.19.19.m2.4.4.2.2.2.3.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3"><union id="algorithm1.19.19.m2.4.4.2.2.2.3.1.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.1"></union><apply id="algorithm1.19.19.m2.4.4.2.2.2.3.2.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.4.4.2.2.2.3.2.1.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2">superscript</csymbol><apply id="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.1.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2">subscript</csymbol><ci id="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.2.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.2">𝐶</ci><ci id="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.3.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2.2.3">𝑚</ci></apply><ci id="algorithm1.19.19.m2.4.4.2.2.2.3.2.3.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.2.3">𝑖</ci></apply><apply id="algorithm1.19.19.m2.4.4.2.2.2.3.3.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.4.4.2.2.2.3.3.1.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3">superscript</csymbol><apply id="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.1.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3">subscript</csymbol><ci id="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.2.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.2">𝐶</ci><ci id="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.3.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3.2.3">𝑛</ci></apply><ci id="algorithm1.19.19.m2.4.4.2.2.2.3.3.3.cmml" xref="algorithm1.19.19.m2.4.4.2.2.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m2.4c">\mathcal{T}_{i}^{r}=\{\psi(k,\mathcal{D}_{i},\mathcal{S})|k\in C_{m}^{i}\cup C_{n}^{i}\}</annotation></semantics></math>.

</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.20.20.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.20.20.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.20.20.1.m1.1" class="ltx_Math" alttext="|\mathcal{T}_{i}^{r}|&gt;\mu" display="inline"><semantics id="algorithm1.20.20.1.m1.1a"><mrow id="algorithm1.20.20.1.m1.1.1" xref="algorithm1.20.20.1.m1.1.1.cmml"><mrow id="algorithm1.20.20.1.m1.1.1.1.1" xref="algorithm1.20.20.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.20.20.1.m1.1.1.1.1.2" xref="algorithm1.20.20.1.m1.1.1.1.2.1.cmml">|</mo><msubsup id="algorithm1.20.20.1.m1.1.1.1.1.1" xref="algorithm1.20.20.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.20.20.1.m1.1.1.1.1.1.2.2" xref="algorithm1.20.20.1.m1.1.1.1.1.1.2.2.cmml">𝒯</mi><mi id="algorithm1.20.20.1.m1.1.1.1.1.1.2.3" xref="algorithm1.20.20.1.m1.1.1.1.1.1.2.3.cmml">i</mi><mi id="algorithm1.20.20.1.m1.1.1.1.1.1.3" xref="algorithm1.20.20.1.m1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo stretchy="false" id="algorithm1.20.20.1.m1.1.1.1.1.3" xref="algorithm1.20.20.1.m1.1.1.1.2.1.cmml">|</mo></mrow><mo id="algorithm1.20.20.1.m1.1.1.2" xref="algorithm1.20.20.1.m1.1.1.2.cmml">&gt;</mo><mi id="algorithm1.20.20.1.m1.1.1.3" xref="algorithm1.20.20.1.m1.1.1.3.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.1.m1.1b"><apply id="algorithm1.20.20.1.m1.1.1.cmml" xref="algorithm1.20.20.1.m1.1.1"><gt id="algorithm1.20.20.1.m1.1.1.2.cmml" xref="algorithm1.20.20.1.m1.1.1.2"></gt><apply id="algorithm1.20.20.1.m1.1.1.1.2.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1"><abs id="algorithm1.20.20.1.m1.1.1.1.2.1.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.2"></abs><apply id="algorithm1.20.20.1.m1.1.1.1.1.1.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.1.m1.1.1.1.1.1.1.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.20.20.1.m1.1.1.1.1.1.2.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.1.m1.1.1.1.1.1.2.1.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.20.20.1.m1.1.1.1.1.1.2.2.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.1.2.2">𝒯</ci><ci id="algorithm1.20.20.1.m1.1.1.1.1.1.2.3.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.20.20.1.m1.1.1.1.1.1.3.cmml" xref="algorithm1.20.20.1.m1.1.1.1.1.1.3">𝑟</ci></apply></apply><ci id="algorithm1.20.20.1.m1.1.1.3.cmml" xref="algorithm1.20.20.1.m1.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.1.m1.1c">|\mathcal{T}_{i}^{r}|&gt;\mu</annotation></semantics></math></em> <span id="algorithm1.20.20.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="algorithm1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Random discard <math id="algorithm1.21.21.m1.1" class="ltx_Math" alttext="|\mathcal{T}_{i}^{r}|-\mu" display="inline"><semantics id="algorithm1.21.21.m1.1a"><mrow id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><mrow id="algorithm1.21.21.m1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.21.21.m1.1.1.1.1.2" xref="algorithm1.21.21.m1.1.1.1.2.1.cmml">|</mo><msubsup id="algorithm1.21.21.m1.1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.21.21.m1.1.1.1.1.1.2.2" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2.cmml">𝒯</mi><mi id="algorithm1.21.21.m1.1.1.1.1.1.2.3" xref="algorithm1.21.21.m1.1.1.1.1.1.2.3.cmml">i</mi><mi id="algorithm1.21.21.m1.1.1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo stretchy="false" id="algorithm1.21.21.m1.1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.2.1.cmml">|</mo></mrow><mo id="algorithm1.21.21.m1.1.1.2" xref="algorithm1.21.21.m1.1.1.2.cmml">−</mo><mi id="algorithm1.21.21.m1.1.1.3" xref="algorithm1.21.21.m1.1.1.3.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><minus id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.2"></minus><apply id="algorithm1.21.21.m1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1"><abs id="algorithm1.21.21.m1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.2"></abs><apply id="algorithm1.21.21.m1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.21.21.m1.1.1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2">𝒯</ci><ci id="algorithm1.21.21.m1.1.1.1.1.1.2.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.21.21.m1.1.1.1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.3">𝑟</ci></apply></apply><ci id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">|\mathcal{T}_{i}^{r}|-\mu</annotation></semantics></math> samples in knowledge anchor.

</div>
<div id="algorithm1.27.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.22.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.22.22.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.22.22.1" class="ltx_emph ltx_font_italic">each local step <math id="algorithm1.22.22.1.m1.3" class="ltx_Math" alttext="e=1,...,E" display="inline"><semantics id="algorithm1.22.22.1.m1.3a"><mrow id="algorithm1.22.22.1.m1.3.4" xref="algorithm1.22.22.1.m1.3.4.cmml"><mi id="algorithm1.22.22.1.m1.3.4.2" xref="algorithm1.22.22.1.m1.3.4.2.cmml">e</mi><mo id="algorithm1.22.22.1.m1.3.4.1" xref="algorithm1.22.22.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm1.22.22.1.m1.3.4.3.2" xref="algorithm1.22.22.1.m1.3.4.3.1.cmml"><mn id="algorithm1.22.22.1.m1.1.1" xref="algorithm1.22.22.1.m1.1.1.cmml">1</mn><mo id="algorithm1.22.22.1.m1.3.4.3.2.1" xref="algorithm1.22.22.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.22.22.1.m1.2.2" xref="algorithm1.22.22.1.m1.2.2.cmml">…</mi><mo id="algorithm1.22.22.1.m1.3.4.3.2.2" xref="algorithm1.22.22.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.22.22.1.m1.3.3" xref="algorithm1.22.22.1.m1.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.1.m1.3b"><apply id="algorithm1.22.22.1.m1.3.4.cmml" xref="algorithm1.22.22.1.m1.3.4"><eq id="algorithm1.22.22.1.m1.3.4.1.cmml" xref="algorithm1.22.22.1.m1.3.4.1"></eq><ci id="algorithm1.22.22.1.m1.3.4.2.cmml" xref="algorithm1.22.22.1.m1.3.4.2">𝑒</ci><list id="algorithm1.22.22.1.m1.3.4.3.1.cmml" xref="algorithm1.22.22.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.22.22.1.m1.1.1.cmml" xref="algorithm1.22.22.1.m1.1.1">1</cn><ci id="algorithm1.22.22.1.m1.2.2.cmml" xref="algorithm1.22.22.1.m1.2.2">…</ci><ci id="algorithm1.22.22.1.m1.3.3.cmml" xref="algorithm1.22.22.1.m1.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.1.m1.3c">e=1,...,E</annotation></semantics></math></em> <span id="algorithm1.22.22.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.27.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.27.33.1" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.27.33.2" class="ltx_emph ltx_font_italic">each mini-batch B</em> <span id="algorithm1.27.33.3" class="ltx_text ltx_font_bold">do</span>
</div>
<div id="algorithm1.23.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.23.23.m1.3" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{CE}+\beta\cdot\mathcal{L}_{KA}(\mathcal{T}_{i}^{r},f_{\boldsymbol{\theta}^{r}_{g}},f_{\boldsymbol{\theta}^{r}_{i}})" display="inline"><semantics id="algorithm1.23.23.m1.3a"><mrow id="algorithm1.23.23.m1.3.3" xref="algorithm1.23.23.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.23.m1.3.3.5" xref="algorithm1.23.23.m1.3.3.5.cmml">ℒ</mi><mo id="algorithm1.23.23.m1.3.3.4" xref="algorithm1.23.23.m1.3.3.4.cmml">=</mo><mrow id="algorithm1.23.23.m1.3.3.3" xref="algorithm1.23.23.m1.3.3.3.cmml"><msub id="algorithm1.23.23.m1.3.3.3.5" xref="algorithm1.23.23.m1.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.23.m1.3.3.3.5.2" xref="algorithm1.23.23.m1.3.3.3.5.2.cmml">ℒ</mi><mrow id="algorithm1.23.23.m1.3.3.3.5.3" xref="algorithm1.23.23.m1.3.3.3.5.3.cmml"><mi id="algorithm1.23.23.m1.3.3.3.5.3.2" xref="algorithm1.23.23.m1.3.3.3.5.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="algorithm1.23.23.m1.3.3.3.5.3.1" xref="algorithm1.23.23.m1.3.3.3.5.3.1.cmml">​</mo><mi id="algorithm1.23.23.m1.3.3.3.5.3.3" xref="algorithm1.23.23.m1.3.3.3.5.3.3.cmml">E</mi></mrow></msub><mo id="algorithm1.23.23.m1.3.3.3.4" xref="algorithm1.23.23.m1.3.3.3.4.cmml">+</mo><mrow id="algorithm1.23.23.m1.3.3.3.3" xref="algorithm1.23.23.m1.3.3.3.3.cmml"><mrow id="algorithm1.23.23.m1.3.3.3.3.5" xref="algorithm1.23.23.m1.3.3.3.3.5.cmml"><mi id="algorithm1.23.23.m1.3.3.3.3.5.2" xref="algorithm1.23.23.m1.3.3.3.3.5.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.23.23.m1.3.3.3.3.5.1" xref="algorithm1.23.23.m1.3.3.3.3.5.1.cmml">⋅</mo><msub id="algorithm1.23.23.m1.3.3.3.3.5.3" xref="algorithm1.23.23.m1.3.3.3.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.23.m1.3.3.3.3.5.3.2" xref="algorithm1.23.23.m1.3.3.3.3.5.3.2.cmml">ℒ</mi><mrow id="algorithm1.23.23.m1.3.3.3.3.5.3.3" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3.cmml"><mi id="algorithm1.23.23.m1.3.3.3.3.5.3.3.2" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="algorithm1.23.23.m1.3.3.3.3.5.3.3.1" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3.1.cmml">​</mo><mi id="algorithm1.23.23.m1.3.3.3.3.5.3.3.3" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3.3.cmml">A</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="algorithm1.23.23.m1.3.3.3.3.4" xref="algorithm1.23.23.m1.3.3.3.3.4.cmml">​</mo><mrow id="algorithm1.23.23.m1.3.3.3.3.3.3" xref="algorithm1.23.23.m1.3.3.3.3.3.4.cmml"><mo stretchy="false" id="algorithm1.23.23.m1.3.3.3.3.3.3.4" xref="algorithm1.23.23.m1.3.3.3.3.3.4.cmml">(</mo><msubsup id="algorithm1.23.23.m1.1.1.1.1.1.1.1" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.2" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.2.cmml">𝒯</mi><mi id="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.3" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="algorithm1.23.23.m1.1.1.1.1.1.1.1.3" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1.3.cmml">r</mi></msubsup><mo id="algorithm1.23.23.m1.3.3.3.3.3.3.5" xref="algorithm1.23.23.m1.3.3.3.3.3.4.cmml">,</mo><msub id="algorithm1.23.23.m1.2.2.2.2.2.2.2" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.cmml"><mi id="algorithm1.23.23.m1.2.2.2.2.2.2.2.2" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.2.cmml">f</mi><msubsup id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.cmml"><mi id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.2" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.2.cmml">𝜽</mi><mi id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.3" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.3.cmml">g</mi><mi id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.3" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.3.cmml">r</mi></msubsup></msub><mo id="algorithm1.23.23.m1.3.3.3.3.3.3.6" xref="algorithm1.23.23.m1.3.3.3.3.3.4.cmml">,</mo><msub id="algorithm1.23.23.m1.3.3.3.3.3.3.3" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.cmml"><mi id="algorithm1.23.23.m1.3.3.3.3.3.3.3.2" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.2.cmml">f</mi><msubsup id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.cmml"><mi id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.2" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.2.cmml">𝜽</mi><mi id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.3" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.3.cmml">i</mi><mi id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.3" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.3.cmml">r</mi></msubsup></msub><mo stretchy="false" id="algorithm1.23.23.m1.3.3.3.3.3.3.7" xref="algorithm1.23.23.m1.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m1.3b"><apply id="algorithm1.23.23.m1.3.3.cmml" xref="algorithm1.23.23.m1.3.3"><eq id="algorithm1.23.23.m1.3.3.4.cmml" xref="algorithm1.23.23.m1.3.3.4"></eq><ci id="algorithm1.23.23.m1.3.3.5.cmml" xref="algorithm1.23.23.m1.3.3.5">ℒ</ci><apply id="algorithm1.23.23.m1.3.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3"><plus id="algorithm1.23.23.m1.3.3.3.4.cmml" xref="algorithm1.23.23.m1.3.3.3.4"></plus><apply id="algorithm1.23.23.m1.3.3.3.5.cmml" xref="algorithm1.23.23.m1.3.3.3.5"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.3.3.3.5.1.cmml" xref="algorithm1.23.23.m1.3.3.3.5">subscript</csymbol><ci id="algorithm1.23.23.m1.3.3.3.5.2.cmml" xref="algorithm1.23.23.m1.3.3.3.5.2">ℒ</ci><apply id="algorithm1.23.23.m1.3.3.3.5.3.cmml" xref="algorithm1.23.23.m1.3.3.3.5.3"><times id="algorithm1.23.23.m1.3.3.3.5.3.1.cmml" xref="algorithm1.23.23.m1.3.3.3.5.3.1"></times><ci id="algorithm1.23.23.m1.3.3.3.5.3.2.cmml" xref="algorithm1.23.23.m1.3.3.3.5.3.2">𝐶</ci><ci id="algorithm1.23.23.m1.3.3.3.5.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3.5.3.3">𝐸</ci></apply></apply><apply id="algorithm1.23.23.m1.3.3.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3"><times id="algorithm1.23.23.m1.3.3.3.3.4.cmml" xref="algorithm1.23.23.m1.3.3.3.3.4"></times><apply id="algorithm1.23.23.m1.3.3.3.3.5.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5"><ci id="algorithm1.23.23.m1.3.3.3.3.5.1.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.1">⋅</ci><ci id="algorithm1.23.23.m1.3.3.3.3.5.2.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.2">𝛽</ci><apply id="algorithm1.23.23.m1.3.3.3.3.5.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.3"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.3.3.3.3.5.3.1.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.3">subscript</csymbol><ci id="algorithm1.23.23.m1.3.3.3.3.5.3.2.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.3.2">ℒ</ci><apply id="algorithm1.23.23.m1.3.3.3.3.5.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3"><times id="algorithm1.23.23.m1.3.3.3.3.5.3.3.1.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3.1"></times><ci id="algorithm1.23.23.m1.3.3.3.3.5.3.3.2.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3.2">𝐾</ci><ci id="algorithm1.23.23.m1.3.3.3.3.5.3.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3.5.3.3.3">𝐴</ci></apply></apply></apply><vector id="algorithm1.23.23.m1.3.3.3.3.3.4.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3"><apply id="algorithm1.23.23.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.2">𝒯</ci><ci id="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.23.23.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.23.23.m1.1.1.1.1.1.1.1.3">𝑟</ci></apply><apply id="algorithm1.23.23.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.23.23.m1.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.2">𝑓</ci><apply id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.1.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3">subscript</csymbol><apply id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.1.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.2.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.2">𝜽</ci><ci id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.3.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.2.3">𝑟</ci></apply><ci id="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.3.cmml" xref="algorithm1.23.23.m1.2.2.2.2.2.2.2.3.3">𝑔</ci></apply></apply><apply id="algorithm1.23.23.m1.3.3.3.3.3.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.3.3.3.3.3.3.3.1.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="algorithm1.23.23.m1.3.3.3.3.3.3.3.2.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.2">𝑓</ci><apply id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.1.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3">subscript</csymbol><apply id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.1.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3">superscript</csymbol><ci id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.2.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.2">𝜽</ci><ci id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.2.3">𝑟</ci></apply><ci id="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.3.cmml" xref="algorithm1.23.23.m1.3.3.3.3.3.3.3.3.3">𝑖</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m1.3c">\mathcal{L}=\mathcal{L}_{CE}+\beta\cdot\mathcal{L}_{KA}(\mathcal{T}_{i}^{r},f_{\boldsymbol{\theta}^{r}_{g}},f_{\boldsymbol{\theta}^{r}_{i}})</annotation></semantics></math>

</div>
<div id="algorithm1.24.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math id="algorithm1.24.24.m1.1" class="ltx_Math" alttext="\boldsymbol{\theta}_{i}^{r}\leftarrow\boldsymbol{\theta}_{i}^{r}-\nabla\mathcal{L}" display="inline"><semantics id="algorithm1.24.24.m1.1a"><mrow id="algorithm1.24.24.m1.1.1" xref="algorithm1.24.24.m1.1.1.cmml"><msubsup id="algorithm1.24.24.m1.1.1.2" xref="algorithm1.24.24.m1.1.1.2.cmml"><mi id="algorithm1.24.24.m1.1.1.2.2.2" xref="algorithm1.24.24.m1.1.1.2.2.2.cmml">𝜽</mi><mi id="algorithm1.24.24.m1.1.1.2.2.3" xref="algorithm1.24.24.m1.1.1.2.2.3.cmml">i</mi><mi id="algorithm1.24.24.m1.1.1.2.3" xref="algorithm1.24.24.m1.1.1.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="algorithm1.24.24.m1.1.1.1" xref="algorithm1.24.24.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.24.24.m1.1.1.3" xref="algorithm1.24.24.m1.1.1.3.cmml"><msubsup id="algorithm1.24.24.m1.1.1.3.2" xref="algorithm1.24.24.m1.1.1.3.2.cmml"><mi id="algorithm1.24.24.m1.1.1.3.2.2.2" xref="algorithm1.24.24.m1.1.1.3.2.2.2.cmml">𝜽</mi><mi id="algorithm1.24.24.m1.1.1.3.2.2.3" xref="algorithm1.24.24.m1.1.1.3.2.2.3.cmml">i</mi><mi id="algorithm1.24.24.m1.1.1.3.2.3" xref="algorithm1.24.24.m1.1.1.3.2.3.cmml">r</mi></msubsup><mo id="algorithm1.24.24.m1.1.1.3.1" xref="algorithm1.24.24.m1.1.1.3.1.cmml">−</mo><mrow id="algorithm1.24.24.m1.1.1.3.3" xref="algorithm1.24.24.m1.1.1.3.3.cmml"><mo rspace="0.167em" id="algorithm1.24.24.m1.1.1.3.3.1" xref="algorithm1.24.24.m1.1.1.3.3.1.cmml">∇</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.24.24.m1.1.1.3.3.2" xref="algorithm1.24.24.m1.1.1.3.3.2.cmml">ℒ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m1.1b"><apply id="algorithm1.24.24.m1.1.1.cmml" xref="algorithm1.24.24.m1.1.1"><ci id="algorithm1.24.24.m1.1.1.1.cmml" xref="algorithm1.24.24.m1.1.1.1">←</ci><apply id="algorithm1.24.24.m1.1.1.2.cmml" xref="algorithm1.24.24.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.2.1.cmml" xref="algorithm1.24.24.m1.1.1.2">superscript</csymbol><apply id="algorithm1.24.24.m1.1.1.2.2.cmml" xref="algorithm1.24.24.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.2.2.1.cmml" xref="algorithm1.24.24.m1.1.1.2">subscript</csymbol><ci id="algorithm1.24.24.m1.1.1.2.2.2.cmml" xref="algorithm1.24.24.m1.1.1.2.2.2">𝜽</ci><ci id="algorithm1.24.24.m1.1.1.2.2.3.cmml" xref="algorithm1.24.24.m1.1.1.2.2.3">𝑖</ci></apply><ci id="algorithm1.24.24.m1.1.1.2.3.cmml" xref="algorithm1.24.24.m1.1.1.2.3">𝑟</ci></apply><apply id="algorithm1.24.24.m1.1.1.3.cmml" xref="algorithm1.24.24.m1.1.1.3"><minus id="algorithm1.24.24.m1.1.1.3.1.cmml" xref="algorithm1.24.24.m1.1.1.3.1"></minus><apply id="algorithm1.24.24.m1.1.1.3.2.cmml" xref="algorithm1.24.24.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.3.2.1.cmml" xref="algorithm1.24.24.m1.1.1.3.2">superscript</csymbol><apply id="algorithm1.24.24.m1.1.1.3.2.2.cmml" xref="algorithm1.24.24.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.3.2.2.1.cmml" xref="algorithm1.24.24.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.24.24.m1.1.1.3.2.2.2.cmml" xref="algorithm1.24.24.m1.1.1.3.2.2.2">𝜽</ci><ci id="algorithm1.24.24.m1.1.1.3.2.2.3.cmml" xref="algorithm1.24.24.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="algorithm1.24.24.m1.1.1.3.2.3.cmml" xref="algorithm1.24.24.m1.1.1.3.2.3">𝑟</ci></apply><apply id="algorithm1.24.24.m1.1.1.3.3.cmml" xref="algorithm1.24.24.m1.1.1.3.3"><ci id="algorithm1.24.24.m1.1.1.3.3.1.cmml" xref="algorithm1.24.24.m1.1.1.3.3.1">∇</ci><ci id="algorithm1.24.24.m1.1.1.3.3.2.cmml" xref="algorithm1.24.24.m1.1.1.3.3.2">ℒ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m1.1c">\boldsymbol{\theta}_{i}^{r}\leftarrow\boldsymbol{\theta}_{i}^{r}-\nabla\mathcal{L}</annotation></semantics></math>

</div>
<div id="algorithm1.27.34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.25.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   upload <math id="algorithm1.25.25.m1.1" class="ltx_Math" alttext="\boldsymbol{\theta}_{i}^{r}" display="inline"><semantics id="algorithm1.25.25.m1.1a"><msubsup id="algorithm1.25.25.m1.1.1" xref="algorithm1.25.25.m1.1.1.cmml"><mi id="algorithm1.25.25.m1.1.1.2.2" xref="algorithm1.25.25.m1.1.1.2.2.cmml">𝜽</mi><mi id="algorithm1.25.25.m1.1.1.2.3" xref="algorithm1.25.25.m1.1.1.2.3.cmml">i</mi><mi id="algorithm1.25.25.m1.1.1.3" xref="algorithm1.25.25.m1.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m1.1b"><apply id="algorithm1.25.25.m1.1.1.cmml" xref="algorithm1.25.25.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.1.cmml" xref="algorithm1.25.25.m1.1.1">superscript</csymbol><apply id="algorithm1.25.25.m1.1.1.2.cmml" xref="algorithm1.25.25.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m1.1.1.2.1.cmml" xref="algorithm1.25.25.m1.1.1">subscript</csymbol><ci id="algorithm1.25.25.m1.1.1.2.2.cmml" xref="algorithm1.25.25.m1.1.1.2.2">𝜽</ci><ci id="algorithm1.25.25.m1.1.1.2.3.cmml" xref="algorithm1.25.25.m1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.25.25.m1.1.1.3.cmml" xref="algorithm1.25.25.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m1.1c">\boldsymbol{\theta}_{i}^{r}</annotation></semantics></math> to server.

</div>
<div id="algorithm1.26.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   aggregate model parameters: <math id="algorithm1.26.26.m1.2" class="ltx_Math" alttext="\boldsymbol{\theta}^{r+1}_{g}\leftarrow\sum_{c_{i}\in\mathcal{P}^{r}}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\boldsymbol{\theta}_{i}^{r}" display="inline"><semantics id="algorithm1.26.26.m1.2a"><mrow id="algorithm1.26.26.m1.2.3" xref="algorithm1.26.26.m1.2.3.cmml"><msubsup id="algorithm1.26.26.m1.2.3.2" xref="algorithm1.26.26.m1.2.3.2.cmml"><mi id="algorithm1.26.26.m1.2.3.2.2.2" xref="algorithm1.26.26.m1.2.3.2.2.2.cmml">𝜽</mi><mi id="algorithm1.26.26.m1.2.3.2.3" xref="algorithm1.26.26.m1.2.3.2.3.cmml">g</mi><mrow id="algorithm1.26.26.m1.2.3.2.2.3" xref="algorithm1.26.26.m1.2.3.2.2.3.cmml"><mi id="algorithm1.26.26.m1.2.3.2.2.3.2" xref="algorithm1.26.26.m1.2.3.2.2.3.2.cmml">r</mi><mo id="algorithm1.26.26.m1.2.3.2.2.3.1" xref="algorithm1.26.26.m1.2.3.2.2.3.1.cmml">+</mo><mn id="algorithm1.26.26.m1.2.3.2.2.3.3" xref="algorithm1.26.26.m1.2.3.2.2.3.3.cmml">1</mn></mrow></msubsup><mo rspace="0.111em" stretchy="false" id="algorithm1.26.26.m1.2.3.1" xref="algorithm1.26.26.m1.2.3.1.cmml">←</mo><mrow id="algorithm1.26.26.m1.2.3.3" xref="algorithm1.26.26.m1.2.3.3.cmml"><msub id="algorithm1.26.26.m1.2.3.3.1" xref="algorithm1.26.26.m1.2.3.3.1.cmml"><mo id="algorithm1.26.26.m1.2.3.3.1.2" xref="algorithm1.26.26.m1.2.3.3.1.2.cmml">∑</mo><mrow id="algorithm1.26.26.m1.2.3.3.1.3" xref="algorithm1.26.26.m1.2.3.3.1.3.cmml"><msub id="algorithm1.26.26.m1.2.3.3.1.3.2" xref="algorithm1.26.26.m1.2.3.3.1.3.2.cmml"><mi id="algorithm1.26.26.m1.2.3.3.1.3.2.2" xref="algorithm1.26.26.m1.2.3.3.1.3.2.2.cmml">c</mi><mi id="algorithm1.26.26.m1.2.3.3.1.3.2.3" xref="algorithm1.26.26.m1.2.3.3.1.3.2.3.cmml">i</mi></msub><mo id="algorithm1.26.26.m1.2.3.3.1.3.1" xref="algorithm1.26.26.m1.2.3.3.1.3.1.cmml">∈</mo><msup id="algorithm1.26.26.m1.2.3.3.1.3.3" xref="algorithm1.26.26.m1.2.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.26.26.m1.2.3.3.1.3.3.2" xref="algorithm1.26.26.m1.2.3.3.1.3.3.2.cmml">𝒫</mi><mi id="algorithm1.26.26.m1.2.3.3.1.3.3.3" xref="algorithm1.26.26.m1.2.3.3.1.3.3.3.cmml">r</mi></msup></mrow></msub><mrow id="algorithm1.26.26.m1.2.3.3.2" xref="algorithm1.26.26.m1.2.3.3.2.cmml"><mfrac id="algorithm1.26.26.m1.2.2" xref="algorithm1.26.26.m1.2.2.cmml"><mrow id="algorithm1.26.26.m1.1.1.1.1" xref="algorithm1.26.26.m1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.26.26.m1.1.1.1.1.2" xref="algorithm1.26.26.m1.1.1.1.2.1.cmml">|</mo><msub id="algorithm1.26.26.m1.1.1.1.1.1" xref="algorithm1.26.26.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.26.26.m1.1.1.1.1.1.2" xref="algorithm1.26.26.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="algorithm1.26.26.m1.1.1.1.1.1.3" xref="algorithm1.26.26.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm1.26.26.m1.1.1.1.1.3" xref="algorithm1.26.26.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="algorithm1.26.26.m1.2.2.2.3" xref="algorithm1.26.26.m1.2.2.2.2.cmml"><mo stretchy="false" id="algorithm1.26.26.m1.2.2.2.3.1" xref="algorithm1.26.26.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.26.26.m1.2.2.2.1" xref="algorithm1.26.26.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="algorithm1.26.26.m1.2.2.2.3.2" xref="algorithm1.26.26.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m1.2.3.3.2.1" xref="algorithm1.26.26.m1.2.3.3.2.1.cmml">​</mo><msubsup id="algorithm1.26.26.m1.2.3.3.2.2" xref="algorithm1.26.26.m1.2.3.3.2.2.cmml"><mi id="algorithm1.26.26.m1.2.3.3.2.2.2.2" xref="algorithm1.26.26.m1.2.3.3.2.2.2.2.cmml">𝜽</mi><mi id="algorithm1.26.26.m1.2.3.3.2.2.2.3" xref="algorithm1.26.26.m1.2.3.3.2.2.2.3.cmml">i</mi><mi id="algorithm1.26.26.m1.2.3.3.2.2.3" xref="algorithm1.26.26.m1.2.3.3.2.2.3.cmml">r</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m1.2b"><apply id="algorithm1.26.26.m1.2.3.cmml" xref="algorithm1.26.26.m1.2.3"><ci id="algorithm1.26.26.m1.2.3.1.cmml" xref="algorithm1.26.26.m1.2.3.1">←</ci><apply id="algorithm1.26.26.m1.2.3.2.cmml" xref="algorithm1.26.26.m1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.2.3.2.1.cmml" xref="algorithm1.26.26.m1.2.3.2">subscript</csymbol><apply id="algorithm1.26.26.m1.2.3.2.2.cmml" xref="algorithm1.26.26.m1.2.3.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.2.3.2.2.1.cmml" xref="algorithm1.26.26.m1.2.3.2">superscript</csymbol><ci id="algorithm1.26.26.m1.2.3.2.2.2.cmml" xref="algorithm1.26.26.m1.2.3.2.2.2">𝜽</ci><apply id="algorithm1.26.26.m1.2.3.2.2.3.cmml" xref="algorithm1.26.26.m1.2.3.2.2.3"><plus id="algorithm1.26.26.m1.2.3.2.2.3.1.cmml" xref="algorithm1.26.26.m1.2.3.2.2.3.1"></plus><ci id="algorithm1.26.26.m1.2.3.2.2.3.2.cmml" xref="algorithm1.26.26.m1.2.3.2.2.3.2">𝑟</ci><cn type="integer" id="algorithm1.26.26.m1.2.3.2.2.3.3.cmml" xref="algorithm1.26.26.m1.2.3.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.26.26.m1.2.3.2.3.cmml" xref="algorithm1.26.26.m1.2.3.2.3">𝑔</ci></apply><apply id="algorithm1.26.26.m1.2.3.3.cmml" xref="algorithm1.26.26.m1.2.3.3"><apply id="algorithm1.26.26.m1.2.3.3.1.cmml" xref="algorithm1.26.26.m1.2.3.3.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.2.3.3.1.1.cmml" xref="algorithm1.26.26.m1.2.3.3.1">subscript</csymbol><sum id="algorithm1.26.26.m1.2.3.3.1.2.cmml" xref="algorithm1.26.26.m1.2.3.3.1.2"></sum><apply id="algorithm1.26.26.m1.2.3.3.1.3.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3"><in id="algorithm1.26.26.m1.2.3.3.1.3.1.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.1"></in><apply id="algorithm1.26.26.m1.2.3.3.1.3.2.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.2.3.3.1.3.2.1.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.2">subscript</csymbol><ci id="algorithm1.26.26.m1.2.3.3.1.3.2.2.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.2.2">𝑐</ci><ci id="algorithm1.26.26.m1.2.3.3.1.3.2.3.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.2.3">𝑖</ci></apply><apply id="algorithm1.26.26.m1.2.3.3.1.3.3.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.3"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.2.3.3.1.3.3.1.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.3">superscript</csymbol><ci id="algorithm1.26.26.m1.2.3.3.1.3.3.2.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.3.2">𝒫</ci><ci id="algorithm1.26.26.m1.2.3.3.1.3.3.3.cmml" xref="algorithm1.26.26.m1.2.3.3.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="algorithm1.26.26.m1.2.3.3.2.cmml" xref="algorithm1.26.26.m1.2.3.3.2"><times id="algorithm1.26.26.m1.2.3.3.2.1.cmml" xref="algorithm1.26.26.m1.2.3.3.2.1"></times><apply id="algorithm1.26.26.m1.2.2.cmml" xref="algorithm1.26.26.m1.2.2"><divide id="algorithm1.26.26.m1.2.2.3.cmml" xref="algorithm1.26.26.m1.2.2"></divide><apply id="algorithm1.26.26.m1.1.1.1.2.cmml" xref="algorithm1.26.26.m1.1.1.1.1"><abs id="algorithm1.26.26.m1.1.1.1.2.1.cmml" xref="algorithm1.26.26.m1.1.1.1.1.2"></abs><apply id="algorithm1.26.26.m1.1.1.1.1.1.cmml" xref="algorithm1.26.26.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.1.1.1.1.1.1.cmml" xref="algorithm1.26.26.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.26.26.m1.1.1.1.1.1.2.cmml" xref="algorithm1.26.26.m1.1.1.1.1.1.2">𝒟</ci><ci id="algorithm1.26.26.m1.1.1.1.1.1.3.cmml" xref="algorithm1.26.26.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="algorithm1.26.26.m1.2.2.2.2.cmml" xref="algorithm1.26.26.m1.2.2.2.3"><abs id="algorithm1.26.26.m1.2.2.2.2.1.cmml" xref="algorithm1.26.26.m1.2.2.2.3.1"></abs><ci id="algorithm1.26.26.m1.2.2.2.1.cmml" xref="algorithm1.26.26.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="algorithm1.26.26.m1.2.3.3.2.2.cmml" xref="algorithm1.26.26.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.2.3.3.2.2.1.cmml" xref="algorithm1.26.26.m1.2.3.3.2.2">superscript</csymbol><apply id="algorithm1.26.26.m1.2.3.3.2.2.2.cmml" xref="algorithm1.26.26.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.2.3.3.2.2.2.1.cmml" xref="algorithm1.26.26.m1.2.3.3.2.2">subscript</csymbol><ci id="algorithm1.26.26.m1.2.3.3.2.2.2.2.cmml" xref="algorithm1.26.26.m1.2.3.3.2.2.2.2">𝜽</ci><ci id="algorithm1.26.26.m1.2.3.3.2.2.2.3.cmml" xref="algorithm1.26.26.m1.2.3.3.2.2.2.3">𝑖</ci></apply><ci id="algorithm1.26.26.m1.2.3.3.2.2.3.cmml" xref="algorithm1.26.26.m1.2.3.3.2.2.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m1.2c">\boldsymbol{\theta}^{r+1}_{g}\leftarrow\sum_{c_{i}\in\mathcal{P}^{r}}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\boldsymbol{\theta}_{i}^{r}</annotation></semantics></math>

</div>
<div id="algorithm1.27.35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span>

</div>
<div id="algorithm1.27.27" class="ltx_listingline">
<span id="algorithm1.27.27.1" class="ltx_text"><span id="algorithm1.27.27.1.1" class="ltx_text ltx_font_bold">Output:</span> </span><math id="algorithm1.27.27.m1.1" class="ltx_Math" alttext="\boldsymbol{\theta}_{g}^{\mathcal{R}}" display="inline"><semantics id="algorithm1.27.27.m1.1a"><msubsup id="algorithm1.27.27.m1.1.1" xref="algorithm1.27.27.m1.1.1.cmml"><mi id="algorithm1.27.27.m1.1.1.2.2" xref="algorithm1.27.27.m1.1.1.2.2.cmml">𝜽</mi><mi id="algorithm1.27.27.m1.1.1.2.3" xref="algorithm1.27.27.m1.1.1.2.3.cmml">g</mi><mi class="ltx_font_mathcaligraphic" id="algorithm1.27.27.m1.1.1.3" xref="algorithm1.27.27.m1.1.1.3.cmml">ℛ</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m1.1b"><apply id="algorithm1.27.27.m1.1.1.cmml" xref="algorithm1.27.27.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.1.1.cmml" xref="algorithm1.27.27.m1.1.1">superscript</csymbol><apply id="algorithm1.27.27.m1.1.1.2.cmml" xref="algorithm1.27.27.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m1.1.1.2.1.cmml" xref="algorithm1.27.27.m1.1.1">subscript</csymbol><ci id="algorithm1.27.27.m1.1.1.2.2.cmml" xref="algorithm1.27.27.m1.1.1.2.2">𝜽</ci><ci id="algorithm1.27.27.m1.1.1.2.3.cmml" xref="algorithm1.27.27.m1.1.1.2.3">𝑔</ci></apply><ci id="algorithm1.27.27.m1.1.1.3.cmml" xref="algorithm1.27.27.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m1.1c">\boldsymbol{\theta}_{g}^{\mathcal{R}}</annotation></semantics></math>
</div>
<div id="algorithm1.27.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span>

</div>
<div id="algorithm1.27.37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span>

</div>
<div id="algorithm1.27.38" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.29.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Federated Knowledge Anchor</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x8.png" id="S5.F5.sf1.g1" class="ltx_graphics ltx_img_square" width="133" height="133" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Cifar10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x9.png" id="S5.F5.sf2.g1" class="ltx_graphics ltx_img_square" width="133" height="133" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Cifar100</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F5.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x10.png" id="S5.F5.sf3.g1" class="ltx_graphics ltx_img_square" width="133" height="133" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Tiny-ImageNet</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Test accuracy in different communication rounds. FedKA achieves fast and stable convergence with high performance.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Accuracy Comparison</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p">We compare the accuracy of the FedKA and other methods in Cifar10, Cifar100, and Tiny-ImageNet datasets with heterogeneous settings. For a fair comparison, we use the same default settings and carefully tune the corresponding hyperparameters in the aforementioned range to get the best performance. The results are displayed in Table <a href="#S5.T1" title="Table 1 ‣ 5.2 Accuracy Comparison ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Compared with other methods, we can observe that our FedKA achieves great performance on all three datasets. In the Cifar10 dataset, it outperforms the FedAvg by around 2% accuracy. In the Cifar100 dataset, it also outperforms other methods with around 3% accuracy on average while slightly lower than FedNTD. The results demonstrate that our proposed federated knowledge anchor can alleviate the impact of heterogeneous data and improves model performance.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Test accuracy of FedKA and other comparing methods on heterogeneous data.</figcaption>
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Cifar10</th>
<th id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Cifar100</th>
<th id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Tiny-ImageNet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.2.1" class="ltx_tr">
<td id="S5.T1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S5.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.598</td>
<td id="S5.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.267</td>
<td id="S5.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.108</td>
</tr>
<tr id="S5.T1.1.3.2" class="ltx_tr">
<td id="S5.T1.1.3.2.1" class="ltx_td ltx_align_center">FedProx</td>
<td id="S5.T1.1.3.2.2" class="ltx_td ltx_align_center">0.555</td>
<td id="S5.T1.1.3.2.3" class="ltx_td ltx_align_center">0.193</td>
<td id="S5.T1.1.3.2.4" class="ltx_td ltx_align_center">0.097</td>
</tr>
<tr id="S5.T1.1.4.3" class="ltx_tr">
<td id="S5.T1.1.4.3.1" class="ltx_td ltx_align_center">MOON</td>
<td id="S5.T1.1.4.3.2" class="ltx_td ltx_align_center">0.590</td>
<td id="S5.T1.1.4.3.3" class="ltx_td ltx_align_center">0.271</td>
<td id="S5.T1.1.4.3.4" class="ltx_td ltx_align_center">0.104</td>
</tr>
<tr id="S5.T1.1.5.4" class="ltx_tr">
<td id="S5.T1.1.5.4.1" class="ltx_td ltx_align_center">FedDyn</td>
<td id="S5.T1.1.5.4.2" class="ltx_td ltx_align_center">0.571</td>
<td id="S5.T1.1.5.4.3" class="ltx_td ltx_align_center">0.252</td>
<td id="S5.T1.1.5.4.4" class="ltx_td ltx_align_center">0.097</td>
</tr>
<tr id="S5.T1.1.6.5" class="ltx_tr">
<td id="S5.T1.1.6.5.1" class="ltx_td ltx_align_center">FedNTD</td>
<td id="S5.T1.1.6.5.2" class="ltx_td ltx_align_center">0.562</td>
<td id="S5.T1.1.6.5.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.5.3.1" class="ltx_text ltx_font_bold">0.299</span></td>
<td id="S5.T1.1.6.5.4" class="ltx_td ltx_align_center">0.111</td>
</tr>
<tr id="S5.T1.1.7.6" class="ltx_tr">
<td id="S5.T1.1.7.6.1" class="ltx_td ltx_align_center ltx_border_bb">FedKA</td>
<td id="S5.T1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.7.6.2.1" class="ltx_text ltx_font_bold">0.619</span></td>
<td id="S5.T1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb">0.293</td>
<td id="S5.T1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.7.6.4.1" class="ltx_text ltx_font_bold">0.117</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Communication Efficiency</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.1" class="ltx_p">We further compare the communication efficiency of our FedKA with other methods. Since the convergence of each method on Tiny-Imagenet is poor, we only conduct experiments on Cifar10 and Cifar100. We display the accuracy of federated model in each communication round during training in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1 The Setup ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. As can be seen, our FedKA converges significantly faster than all the remaining methods. In the Cifar10 dataset, FedNTD initially converges slightly faster than FedKA, but then it hits a bottleneck and fails to achieve higher model performance. However, compared with the other methods, FedKA is more communication-efficient. The accuracy achieved by FedKA at the 40th communication round requires about 100 communication rounds of other methods.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS3.p2.1" class="ltx_p">We further display the number of communication rounds required to achieve the accuracy of FedAvg for 100 communication rounds in Table <a href="#S5.T2" title="Table 2 ‣ 5.3 Communication Efficiency ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. As can be seen, FedKA significantly outperforms the remaining methods in terms of communication efficiency. On the heterogeneous Cifar10 dataset (<math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><eq id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></eq><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\alpha=0.1</annotation></semantics></math>), the accuracy of the other methods in training fails to exceed the baseline FedAvg. FedKA, on the other hand, achieves   2.3x speedup, taking only 43 rounds to achieve the performance that FedAvg takes 100 rounds to achieve. Similarly, on the Cifar100 dataset, FedKA also achieves the most significant speedup, achieving 2.7 times speedup. It takes only 36 rounds to achieve the performance of FedAvg for 100 rounds, which is significantly higher than the 2.2 times speedup of FedNTD.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Communication rounds required by different methods to achieve the accuracy achieved in 100 rounds of FedAvg. The speedup is calculated based on the FedAvg.</figcaption>
<table id="S5.T2.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.12.13.1" class="ltx_tr">
<th id="S5.T2.12.13.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="S5.T2.12.13.1.1.1" class="ltx_text">Method</span></th>
<th id="S5.T2.12.13.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Cifar10</th>
<th id="S5.T2.12.13.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Cifar100</th>
</tr>
<tr id="S5.T2.12.14.2" class="ltx_tr">
<th id="S5.T2.12.14.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">rounds</th>
<th id="S5.T2.12.14.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">speedup</th>
<th id="S5.T2.12.14.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">rounds</th>
<th id="S5.T2.12.14.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">speedup</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.12.15.1" class="ltx_tr">
<td id="S5.T2.12.15.1.1" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S5.T2.12.15.1.2" class="ltx_td ltx_align_center ltx_border_t">100</td>
<td id="S5.T2.12.15.1.3" class="ltx_td ltx_align_center ltx_border_t">1x</td>
<td id="S5.T2.12.15.1.4" class="ltx_td ltx_align_center ltx_border_t">100</td>
<td id="S5.T2.12.15.1.5" class="ltx_td ltx_align_center ltx_border_t">1x</td>
</tr>
<tr id="S5.T2.4.4" class="ltx_tr">
<td id="S5.T2.4.4.5" class="ltx_td ltx_align_center">FedProx</td>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center"><math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center"><math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mo id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><ci id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_align_center"><math id="S5.T2.3.3.3.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.3.3.3.m1.1a"><mo id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><ci id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.4.4.4" class="ltx_td ltx_align_center"><math id="S5.T2.4.4.4.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.4.4.4.m1.1a"><mo id="S5.T2.4.4.4.m1.1.1" xref="S5.T2.4.4.4.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.m1.1b"><ci id="S5.T2.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.m1.1c">\backslash</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.6.6" class="ltx_tr">
<td id="S5.T2.6.6.3" class="ltx_td ltx_align_center">MOON</td>
<td id="S5.T2.5.5.1" class="ltx_td ltx_align_center"><math id="S5.T2.5.5.1.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.5.5.1.m1.1a"><mo id="S5.T2.5.5.1.m1.1.1" xref="S5.T2.5.5.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.1.m1.1b"><ci id="S5.T2.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.1.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.6.6.2" class="ltx_td ltx_align_center"><math id="S5.T2.6.6.2.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.6.6.2.m1.1a"><mo id="S5.T2.6.6.2.m1.1.1" xref="S5.T2.6.6.2.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.2.m1.1b"><ci id="S5.T2.6.6.2.m1.1.1.cmml" xref="S5.T2.6.6.2.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.2.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.6.6.4" class="ltx_td ltx_align_center">89</td>
<td id="S5.T2.6.6.5" class="ltx_td ltx_align_center">1.1x</td>
</tr>
<tr id="S5.T2.10.10" class="ltx_tr">
<td id="S5.T2.10.10.5" class="ltx_td ltx_align_center">FedDyn</td>
<td id="S5.T2.7.7.1" class="ltx_td ltx_align_center"><math id="S5.T2.7.7.1.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.7.7.1.m1.1a"><mo id="S5.T2.7.7.1.m1.1.1" xref="S5.T2.7.7.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.1.m1.1b"><ci id="S5.T2.7.7.1.m1.1.1.cmml" xref="S5.T2.7.7.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.1.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.8.8.2" class="ltx_td ltx_align_center"><math id="S5.T2.8.8.2.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.8.8.2.m1.1a"><mo id="S5.T2.8.8.2.m1.1.1" xref="S5.T2.8.8.2.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.2.m1.1b"><ci id="S5.T2.8.8.2.m1.1.1.cmml" xref="S5.T2.8.8.2.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.2.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.9.9.3" class="ltx_td ltx_align_center"><math id="S5.T2.9.9.3.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.9.9.3.m1.1a"><mo id="S5.T2.9.9.3.m1.1.1" xref="S5.T2.9.9.3.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.3.m1.1b"><ci id="S5.T2.9.9.3.m1.1.1.cmml" xref="S5.T2.9.9.3.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.3.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.10.10.4" class="ltx_td ltx_align_center"><math id="S5.T2.10.10.4.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.10.10.4.m1.1a"><mo id="S5.T2.10.10.4.m1.1.1" xref="S5.T2.10.10.4.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.4.m1.1b"><ci id="S5.T2.10.10.4.m1.1.1.cmml" xref="S5.T2.10.10.4.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.4.m1.1c">\backslash</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.12.12" class="ltx_tr">
<td id="S5.T2.12.12.3" class="ltx_td ltx_align_center">FedNTD</td>
<td id="S5.T2.11.11.1" class="ltx_td ltx_align_center"><math id="S5.T2.11.11.1.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.11.11.1.m1.1a"><mo id="S5.T2.11.11.1.m1.1.1" xref="S5.T2.11.11.1.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.1.m1.1b"><ci id="S5.T2.11.11.1.m1.1.1.cmml" xref="S5.T2.11.11.1.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.1.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.12.12.2" class="ltx_td ltx_align_center"><math id="S5.T2.12.12.2.m1.1" class="ltx_Math" alttext="\backslash" display="inline"><semantics id="S5.T2.12.12.2.m1.1a"><mo id="S5.T2.12.12.2.m1.1.1" xref="S5.T2.12.12.2.m1.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.2.m1.1b"><ci id="S5.T2.12.12.2.m1.1.1.cmml" xref="S5.T2.12.12.2.m1.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.2.m1.1c">\backslash</annotation></semantics></math></td>
<td id="S5.T2.12.12.4" class="ltx_td ltx_align_center">45</td>
<td id="S5.T2.12.12.5" class="ltx_td ltx_align_center">2.2x</td>
</tr>
<tr id="S5.T2.12.16.2" class="ltx_tr">
<td id="S5.T2.12.16.2.1" class="ltx_td ltx_align_center ltx_border_bb">FedKA</td>
<td id="S5.T2.12.16.2.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.12.16.2.2.1" class="ltx_text ltx_font_bold">43</span></td>
<td id="S5.T2.12.16.2.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.12.16.2.3.1" class="ltx_text ltx_font_bold">2.3x</span></td>
<td id="S5.T2.12.16.2.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.12.16.2.4.1" class="ltx_text ltx_font_bold">36</span></td>
<td id="S5.T2.12.16.2.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.12.16.2.5.1" class="ltx_text ltx_font_bold">2.7x</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Robustness to Partial Participation</h3>

<div id="S5.SS4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS4.p1.1" class="ltx_p">As partial participation of clients is a common practice in the real scenario of federated learning, robustness to partial participation is also quite essential metric for federated learning algorithms. Its impact on heterogeneous data is particularly significant, which always leads to jitter in convergence and performance degradation.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para ltx_noindent">
<p id="S5.SS4.p2.1" class="ltx_p">Here we show the performance of different methods with various client participation ratios in Table <a href="#S5.T3" title="Table 3 ‣ 5.4 Robustness to Partial Participation ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. As demonstrated in the table, FedProx has the best performance when the sampling ratio is 0.2, while its accuracy is lower than the baseline FedAvg as the sampling ratio increases. FedKA shows great performance under various sampling ratios, far exceeding the performance of other algorithms, showing strong robustness to the partial participation of clients.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Test accuracy of different methods under partial participation strategy on heterogeneous Cifar10. We report the test accuracy under participation ratio: <math id="S5.T3.2.m1.3" class="ltx_Math" alttext="\{0.2,0.6,1.0\}" display="inline"><semantics id="S5.T3.2.m1.3b"><mrow id="S5.T3.2.m1.3.4.2" xref="S5.T3.2.m1.3.4.1.cmml"><mo stretchy="false" id="S5.T3.2.m1.3.4.2.1" xref="S5.T3.2.m1.3.4.1.cmml">{</mo><mn id="S5.T3.2.m1.1.1" xref="S5.T3.2.m1.1.1.cmml">0.2</mn><mo id="S5.T3.2.m1.3.4.2.2" xref="S5.T3.2.m1.3.4.1.cmml">,</mo><mn id="S5.T3.2.m1.2.2" xref="S5.T3.2.m1.2.2.cmml">0.6</mn><mo id="S5.T3.2.m1.3.4.2.3" xref="S5.T3.2.m1.3.4.1.cmml">,</mo><mn id="S5.T3.2.m1.3.3" xref="S5.T3.2.m1.3.3.cmml">1.0</mn><mo stretchy="false" id="S5.T3.2.m1.3.4.2.4" xref="S5.T3.2.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.3c"><set id="S5.T3.2.m1.3.4.1.cmml" xref="S5.T3.2.m1.3.4.2"><cn type="float" id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1">0.2</cn><cn type="float" id="S5.T3.2.m1.2.2.cmml" xref="S5.T3.2.m1.2.2">0.6</cn><cn type="float" id="S5.T3.2.m1.3.3.cmml" xref="S5.T3.2.m1.3.3">1.0</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.3d">\{0.2,0.6,1.0\}</annotation></semantics></math> to represent low, high, and full participation scenarios.</figcaption>
<table id="S5.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.3.1.1" class="ltx_tr">
<th id="S5.T3.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="S5.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">low: 0.2</th>
<th id="S5.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">high: 0.6</th>
<th id="S5.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">full: 1.0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.3.2.1" class="ltx_tr">
<td id="S5.T3.3.2.1.1" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S5.T3.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.384</td>
<td id="S5.T3.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.591</td>
<td id="S5.T3.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.598</td>
</tr>
<tr id="S5.T3.3.3.2" class="ltx_tr">
<td id="S5.T3.3.3.2.1" class="ltx_td ltx_align_center">FedProx</td>
<td id="S5.T3.3.3.2.2" class="ltx_td ltx_align_center">0.480</td>
<td id="S5.T3.3.3.2.3" class="ltx_td ltx_align_center">0.549</td>
<td id="S5.T3.3.3.2.4" class="ltx_td ltx_align_center">0.555</td>
</tr>
<tr id="S5.T3.3.4.3" class="ltx_tr">
<td id="S5.T3.3.4.3.1" class="ltx_td ltx_align_center">MOON</td>
<td id="S5.T3.3.4.3.2" class="ltx_td ltx_align_center">0.238</td>
<td id="S5.T3.3.4.3.3" class="ltx_td ltx_align_center">0.419</td>
<td id="S5.T3.3.4.3.4" class="ltx_td ltx_align_center">0.59</td>
</tr>
<tr id="S5.T3.3.5.4" class="ltx_tr">
<td id="S5.T3.3.5.4.1" class="ltx_td ltx_align_center">FedDyn</td>
<td id="S5.T3.3.5.4.2" class="ltx_td ltx_align_center"><span id="S5.T3.3.5.4.2.1" class="ltx_text ltx_font_bold">0.482</span></td>
<td id="S5.T3.3.5.4.3" class="ltx_td ltx_align_center">0.548</td>
<td id="S5.T3.3.5.4.4" class="ltx_td ltx_align_center">0.571</td>
</tr>
<tr id="S5.T3.3.6.5" class="ltx_tr">
<td id="S5.T3.3.6.5.1" class="ltx_td ltx_align_center">FedNTD</td>
<td id="S5.T3.3.6.5.2" class="ltx_td ltx_align_center">0.398</td>
<td id="S5.T3.3.6.5.3" class="ltx_td ltx_align_center">0.588</td>
<td id="S5.T3.3.6.5.4" class="ltx_td ltx_align_center">0.562</td>
</tr>
<tr id="S5.T3.3.7.6" class="ltx_tr">
<td id="S5.T3.3.7.6.1" class="ltx_td ltx_align_center ltx_border_bb">FedKA</td>
<td id="S5.T3.3.7.6.2" class="ltx_td ltx_align_center ltx_border_bb">0.458</td>
<td id="S5.T3.3.7.6.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.7.6.3.1" class="ltx_text ltx_font_bold">0.591</span></td>
<td id="S5.T3.3.7.6.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.3.7.6.4.1" class="ltx_text ltx_font_bold">0.619</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Robustness to Local Epochs</h3>

<div id="S5.SS5.p1" class="ltx_para ltx_noindent">
<p id="S5.SS5.p1.1" class="ltx_p">Due to the deviation between the optimal solutions of the objective function on the local dataset and the global dataset, the number of local epochs plays a crucial role in federated learning. The larger the number of local epochs, the greater the local drift becomes.</p>
</div>
<div id="S5.SS5.p2" class="ltx_para ltx_noindent">
<p id="S5.SS5.p2.1" class="ltx_p">We conduct experiments on the Cifar10 dataset with varying local epochs and present the results of different methods in Table <a href="#S5.T4" title="Table 4 ‣ 5.6 Robustness to Client Scalability ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The table shows that when the local epoch is small, the difference in performance between the algorithms is not significant. However, as the local epoch increases, the subsequent increase in local drift leads to performance degradation in the other algorithms. In contrast, FedKA maintains a robust performance with significantly higher test accuracy than the other algorithms.</p>
</div>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Robustness to Client Scalability</h3>

<div id="S5.SS6.p1" class="ltx_para ltx_noindent">
<p id="S5.SS6.p1.1" class="ltx_p">We also conduct experiments to validate the robustness of FedKA to the client scalability. We partition the heterogeneous Cifar10 dataset into 10, 20, 50, and 100 clients respectively. The experimental results are displayed in Table <a href="#S5.T5" title="Table 5 ‣ 5.6 Robustness to Client Scalability ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Experimental results demonstrate that our FedKA outperforms all other SOTA methods and is robust to client scalability.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x11.png" id="S5.F6.sf1.g1" class="ltx_graphics ltx_img_square" width="161" height="161" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Forgetting on non-dominant classes</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x12.png" id="S5.F6.sf2.g1" class="ltx_graphics ltx_img_square" width="161" height="161" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Accuracy on non-dominant classes</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Forgetting experiments on the non-dominant classes. The knowledge anchor can significantly alleviate the forgetting in non-dominant classes.</figcaption>
</figure>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Test accuracy of different methods under various local epoch numbers.</figcaption>
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<th id="S5.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">epoch: 1</th>
<th id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">epoch: 5</th>
<th id="S5.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">epoch: 10</th>
<th id="S5.T4.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">epoch: 20</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.1.2.1" class="ltx_tr">
<td id="S5.T4.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S5.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.569</td>
<td id="S5.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.614</td>
<td id="S5.T4.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.598</td>
<td id="S5.T4.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">0.601</td>
</tr>
<tr id="S5.T4.1.3.2" class="ltx_tr">
<td id="S5.T4.1.3.2.1" class="ltx_td ltx_align_center">FedProx</td>
<td id="S5.T4.1.3.2.2" class="ltx_td ltx_align_center">0.407</td>
<td id="S5.T4.1.3.2.3" class="ltx_td ltx_align_center">0.529</td>
<td id="S5.T4.1.3.2.4" class="ltx_td ltx_align_center">0.555</td>
<td id="S5.T4.1.3.2.5" class="ltx_td ltx_align_center">0.567</td>
</tr>
<tr id="S5.T4.1.4.3" class="ltx_tr">
<td id="S5.T4.1.4.3.1" class="ltx_td ltx_align_center">MOON</td>
<td id="S5.T4.1.4.3.2" class="ltx_td ltx_align_center">0.574</td>
<td id="S5.T4.1.4.3.3" class="ltx_td ltx_align_center">0.615</td>
<td id="S5.T4.1.4.3.4" class="ltx_td ltx_align_center">0.590</td>
<td id="S5.T4.1.4.3.5" class="ltx_td ltx_align_center">0.563</td>
</tr>
<tr id="S5.T4.1.5.4" class="ltx_tr">
<td id="S5.T4.1.5.4.1" class="ltx_td ltx_align_center">FedDyn</td>
<td id="S5.T4.1.5.4.2" class="ltx_td ltx_align_center">0.553</td>
<td id="S5.T4.1.5.4.3" class="ltx_td ltx_align_center">0.568</td>
<td id="S5.T4.1.5.4.4" class="ltx_td ltx_align_center">0.571</td>
<td id="S5.T4.1.5.4.5" class="ltx_td ltx_align_center">0.565</td>
</tr>
<tr id="S5.T4.1.6.5" class="ltx_tr">
<td id="S5.T4.1.6.5.1" class="ltx_td ltx_align_center">FedNTD</td>
<td id="S5.T4.1.6.5.2" class="ltx_td ltx_align_center">0.570</td>
<td id="S5.T4.1.6.5.3" class="ltx_td ltx_align_center">0.614</td>
<td id="S5.T4.1.6.5.4" class="ltx_td ltx_align_center">0.562</td>
<td id="S5.T4.1.6.5.5" class="ltx_td ltx_align_center">0.606</td>
</tr>
<tr id="S5.T4.1.7.6" class="ltx_tr">
<td id="S5.T4.1.7.6.1" class="ltx_td ltx_align_center ltx_border_bb">FedKA</td>
<td id="S5.T4.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.1.7.6.2.1" class="ltx_text ltx_font_bold">0.576</span></td>
<td id="S5.T4.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.1.7.6.3.1" class="ltx_text ltx_font_bold">0.617</span></td>
<td id="S5.T4.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.1.7.6.4.1" class="ltx_text ltx_font_bold">0.619</span></td>
<td id="S5.T4.1.7.6.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.1.7.6.5.1" class="ltx_text ltx_font_bold">0.613</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Test accuracy of different methods under various client numbers.</figcaption>
<table id="S5.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.1.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="S5.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Clients: 10</th>
<th id="S5.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Clients: 20</th>
<th id="S5.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Clients: 50</th>
<th id="S5.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Clients: 100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.1.2.1" class="ltx_tr">
<td id="S5.T5.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">FedAvg</td>
<td id="S5.T5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.598</td>
<td id="S5.T5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.585</td>
<td id="S5.T5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.591</td>
<td id="S5.T5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">0.571</td>
</tr>
<tr id="S5.T5.1.3.2" class="ltx_tr">
<td id="S5.T5.1.3.2.1" class="ltx_td ltx_align_center">FedProx</td>
<td id="S5.T5.1.3.2.2" class="ltx_td ltx_align_center">0.555</td>
<td id="S5.T5.1.3.2.3" class="ltx_td ltx_align_center">0.517</td>
<td id="S5.T5.1.3.2.4" class="ltx_td ltx_align_center">0.518</td>
<td id="S5.T5.1.3.2.5" class="ltx_td ltx_align_center">0.428</td>
</tr>
<tr id="S5.T5.1.4.3" class="ltx_tr">
<td id="S5.T5.1.4.3.1" class="ltx_td ltx_align_center">MOON</td>
<td id="S5.T5.1.4.3.2" class="ltx_td ltx_align_center">0.59</td>
<td id="S5.T5.1.4.3.3" class="ltx_td ltx_align_center">0.567</td>
<td id="S5.T5.1.4.3.4" class="ltx_td ltx_align_center">0.578</td>
<td id="S5.T5.1.4.3.5" class="ltx_td ltx_align_center">0.544</td>
</tr>
<tr id="S5.T5.1.5.4" class="ltx_tr">
<td id="S5.T5.1.5.4.1" class="ltx_td ltx_align_center">FedDyn</td>
<td id="S5.T5.1.5.4.2" class="ltx_td ltx_align_center">0.571</td>
<td id="S5.T5.1.5.4.3" class="ltx_td ltx_align_center">0.551</td>
<td id="S5.T5.1.5.4.4" class="ltx_td ltx_align_center">0.572</td>
<td id="S5.T5.1.5.4.5" class="ltx_td ltx_align_center">0.524</td>
</tr>
<tr id="S5.T5.1.6.5" class="ltx_tr">
<td id="S5.T5.1.6.5.1" class="ltx_td ltx_align_center">FedNTD</td>
<td id="S5.T5.1.6.5.2" class="ltx_td ltx_align_center">0.562</td>
<td id="S5.T5.1.6.5.3" class="ltx_td ltx_align_center">0.588</td>
<td id="S5.T5.1.6.5.4" class="ltx_td ltx_align_center">0.593</td>
<td id="S5.T5.1.6.5.5" class="ltx_td ltx_align_center">0.525</td>
</tr>
<tr id="S5.T5.1.7.6" class="ltx_tr">
<td id="S5.T5.1.7.6.1" class="ltx_td ltx_align_center ltx_border_bb">FedKA</td>
<td id="S5.T5.1.7.6.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T5.1.7.6.2.1" class="ltx_text ltx_font_bold">0.619</span></td>
<td id="S5.T5.1.7.6.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T5.1.7.6.3.1" class="ltx_text ltx_font_bold">0.601</span></td>
<td id="S5.T5.1.7.6.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T5.1.7.6.4.1" class="ltx_text ltx_font_bold">0.604</span></td>
<td id="S5.T5.1.7.6.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T5.1.7.6.5.1" class="ltx_text ltx_font_bold">0.573</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.7 </span>Ablation Study</h3>

<div id="S5.SS7.p1" class="ltx_para ltx_noindent">
<p id="S5.SS7.p1.1" class="ltx_p">Here we conduct ablation study to demonstrate the effectiveness of our knowledge anchor and its design choice.</p>
</div>
<div id="S5.SS7.p2" class="ltx_para ltx_noindent">
<p id="S5.SS7.p2.1" class="ltx_p"><span id="S5.SS7.p2.1.1" class="ltx_text ltx_font_bold">Forgetting Alleviation.</span> We conduct experiments to validate the efficiency of the knowledge anchor in knowledge preservation. The proposed forgetting degree serves as the evaluation metric, and we compare the forgetting degree and the local test accuracy of the same class with and without the knowledge anchor. Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.6 Robustness to Client Scalability ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> displays the forgetting degree curve and the local test accuracy of a specified non-dominant class. The figure illustrates that the forgetting degree of federated learning with knowledge anchor is generally lower than that of federated learning without knowledge anchor, and it is more stable. Additionally, the test accuracy of the federated learning algorithm with knowledge anchor is higher on non-dominant classes, which indicates more preserved knowledge in local training.</p>
</div>
<div id="S5.SS7.p3" class="ltx_para ltx_noindent">
<p id="S5.SS7.p3.1" class="ltx_p"><span id="S5.SS7.p3.1.1" class="ltx_text ltx_font_bold">Effectiveness of Knowledge Anchor.</span>
To demonstrate the effectiveness of the construction of knowledge anchor (KA), we perform experiments with different construction methods of knowledge anchors, e.g. without KA, KA with non-dominant classes only, KA with missing classes only, and FedKA. The results are displayed in the Table <a href="#S5.T6" title="Table 6 ‣ 5.7 Ablation Study ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Effectiveness of the knowledge anchor. KA (N) and KA (M) refer to the knowledge anchor with non-dominant classes only and dominant classes only respectively.</figcaption>
<table id="S5.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T6.1.1.1" class="ltx_tr">
<th id="S5.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Dataset</th>
<th id="S5.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Without KA</th>
<th id="S5.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">KA (N)</th>
<th id="S5.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">KA (M)</th>
<th id="S5.T6.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedKA</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T6.1.2.1" class="ltx_tr">
<td id="S5.T6.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">Cifar10</td>
<td id="S5.T6.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.598</td>
<td id="S5.T6.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.607</td>
<td id="S5.T6.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.615</td>
<td id="S5.T6.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.2.1.5.1" class="ltx_text ltx_font_bold">0.619</span></td>
</tr>
<tr id="S5.T6.1.3.2" class="ltx_tr">
<td id="S5.T6.1.3.2.1" class="ltx_td ltx_align_center">Cifar100</td>
<td id="S5.T6.1.3.2.2" class="ltx_td ltx_align_center">0.267</td>
<td id="S5.T6.1.3.2.3" class="ltx_td ltx_align_center">0.282</td>
<td id="S5.T6.1.3.2.4" class="ltx_td ltx_align_center">\</td>
<td id="S5.T6.1.3.2.5" class="ltx_td ltx_align_center"><span id="S5.T6.1.3.2.5.1" class="ltx_text ltx_font_bold">0.293</span></td>
</tr>
<tr id="S5.T6.1.4.3" class="ltx_tr">
<td id="S5.T6.1.4.3.1" class="ltx_td ltx_align_center ltx_border_bb">Tiny-ImageNet</td>
<td id="S5.T6.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">0.108</td>
<td id="S5.T6.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb">0.114</td>
<td id="S5.T6.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb">0.110</td>
<td id="S5.T6.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T6.1.4.3.5.1" class="ltx_text ltx_font_bold">0.117</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Performance of different sampling strategies in knowledge anchor construction. FedKA (R) refers to the random sampling strategy, FedKA (H) refers to the hard sample mining strategy, FedKA (P) refers to the proficient sample mining strategy.</figcaption>
<table id="S5.T7.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T7.1.1.1" class="ltx_tr">
<th id="S5.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Strategies</th>
<th id="S5.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Round 10</th>
<th id="S5.T7.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Round 30</th>
<th id="S5.T7.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Round 50</th>
<th id="S5.T7.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Round 100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T7.1.2.1" class="ltx_tr">
<td id="S5.T7.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">FedKA (R)</td>
<td id="S5.T7.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.513</td>
<td id="S5.T7.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.591</td>
<td id="S5.T7.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.601</td>
<td id="S5.T7.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">0.619</td>
</tr>
<tr id="S5.T7.1.3.2" class="ltx_tr">
<td id="S5.T7.1.3.2.1" class="ltx_td ltx_align_center">FedKA (H)</td>
<td id="S5.T7.1.3.2.2" class="ltx_td ltx_align_center">0.522</td>
<td id="S5.T7.1.3.2.3" class="ltx_td ltx_align_center">0.591</td>
<td id="S5.T7.1.3.2.4" class="ltx_td ltx_align_center">0.604</td>
<td id="S5.T7.1.3.2.5" class="ltx_td ltx_align_center">0.615</td>
</tr>
<tr id="S5.T7.1.4.3" class="ltx_tr">
<td id="S5.T7.1.4.3.1" class="ltx_td ltx_align_center ltx_border_bb">FedKA (P)</td>
<td id="S5.T7.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">0.523</td>
<td id="S5.T7.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb">0.590</td>
<td id="S5.T7.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb">0.604</td>
<td id="S5.T7.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb">0.616</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS7.p4" class="ltx_para ltx_noindent">
<p id="S5.SS7.p4.1" class="ltx_p"><span id="S5.SS7.p4.1.1" class="ltx_text ltx_font_bold">Knowledge Anchor Construction Strategy.</span> We also conduct experiments to investigate the influence of sample choosing in the construction of knowledge anchor. We adopt three sample choosing strategies for sampling from non-dominant classes: (1) hard sample mining, (2) proficient sample mining, and (3) random sample selection. The idea of hard sample mining is straightforward, i.e., preserving the knowledge of the hardest non-dominant samples to maximize knowledge preservation. Concretely, before local training, we calculate the sample loss for each non-dominant sample and select the sample with the largest loss as the representative sample for each class. The idea of proficient sample mining is different from hard sample mining. Concretely, the pattern of the hard sample may be false or even meaningless, which cannot represent the current knowledge of the non-dominant class. Conversely, we should use the most proficient sample to serve as the knowledge anchor to preserve the knowledge of non-dominant classes, i.e., the sample with the smallest loss. We adopt these three strategies and conduct experiments on Cifar10 with a heterogeneous setting. The results are displayed in Table <a href="#S5.T7" title="Table 7 ‣ 5.7 Ablation Study ‣ 5 Experiments ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. As demonstrated in the results, the influence of the sampling strategy is trivial, and we adopt the random sampling strategy for minimal computation cost.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">Federated learning suffers from forgetting on heterogeneous data. The class-wise forgetting of preserved knowledge happens after local training, leading to performance degradation and blocking the convergence of the federated model. In this paper, building on the previous analysis of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, we reveal that forgetting only occurs in non-dominant and missing classes. Moreover, we demonstrate that the reduction in samples of non-dominant classes has a trivial impact on forgetting in this class, while the reduction in samples of dominant classes significantly decreases its training benefit and may suddenly lead to catastrophic forgetting when the sample number decreases to a certain threshold. These observations illustrate that local clients struggle to utilize the few samples to combat forgetting in non-dominant classes, motivating us to propose our method, Federated Knowledge Anchor (FedKA). FedKA aims to utilize a minimal representative sample set as an anchor point in knowledge preservation. By minimizing the L2 distance between discarded logits of knowledge anchor outputted by the global model and the current training model, FedKA corrects the gradients towards the direction of preserving the knowledge of non-dominant and dominant classes. Through extensive experiments, we validate that FedKA significantly improves model performance and achieves fast and stable convergence in popular datasets.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jesse Levinson, Jake Askeland, Jan Becker, Jennifer Dolson, David Held, Soeren Kammel, J Zico Kolter, Dirk Langer, Oliver Pink, Vaughan Pratt, et al.

</span>
<span class="ltx_bibblock">Towards fully autonomous driving: Systems and algorithms.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">2011 IEEE intelligent vehicles symposium (IV)</span>, pages 163–168. IEEE, 2011.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Riccardo Miotto, Li Li, Brian A Kidd, and Joel T Dudley.

</span>
<span class="ltx_bibblock">Deep patient: an unsupervised representation to predict the future of patients from the electronic health records.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Scientific reports</span>, 6(1):1–10, 2016.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong.

</span>
<span class="ltx_bibblock">Federated machine learning: Concept and applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">ACM Transactions on Intelligent Systems and Technology (TIST)</span>, 10(2):1–19, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Yang Liu, Anbu Huang, Yun Luo, He Huang, Youzhi Liu, Yuanyuan Chen, Lican Feng, Tianjian Chen, Han Yu, and Qiang Yang.

</span>
<span class="ltx_bibblock">Fedvision: An online visual object detection platform powered by federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</span>, volume 34, pages 13172–13179, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Li Li, Yuxi Fan, Mike Tse, and Kuo-Yi Lin.

</span>
<span class="ltx_bibblock">A review of applications in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Computers &amp; Industrial Engineering</span>, 149:106854, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Dinh C Nguyen, Quoc-Viet Pham, Pubudu N Pathirana, Ming Ding, Aruna Seneviratne, Zihuai Lin, Octavia Dobre, and Won-Joo Hwang.

</span>
<span class="ltx_bibblock">Federated learning for smart healthcare: A survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">ACM Computing Surveys (CSUR)</span>, 55(3):1–37, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Ittai Dayan, Holger R Roth, Aoxiao Zhong, Ahmed Harouni, Amilcare Gentili, Anas Z Abidin, Andrew Liu, Anthony Beardsworth Costa, Bradford J Wood, Chien-Sung Tsai, et al.

</span>
<span class="ltx_bibblock">Federated learning for predicting clinical outcomes in patients with covid-19.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Nature medicine</span>, 27(10):1735–1743, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">IEEE signal processing magazine</span>, 37(3):50–60, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Eugene Bagdasaryan, Andreas Veit, Yiqing Hua, Deborah Estrin, and Vitaly Shmatikov.

</span>
<span class="ltx_bibblock">How to backdoor federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">International Conference on Artificial Intelligence and Statistics</span>, pages 2938–2948. PMLR, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Hangyu Zhu, Jinjin Xu, Shiqing Liu, and Yaochu Jin.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data: A survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Neurocomputing</span>, 465:371–390, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Qinbin Li, Yiqun Diao, Quan Chen, and Bingsheng He.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data silos: An experimental study.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">2022 IEEE 38th International Conference on Data Engineering (ICDE)</span>, pages 965–978. IEEE, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine learning and systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Qinbin Li, Bingsheng He, and Dawn Song.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span>, pages 10713–10722, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Gihun Lee, Minchan Jeong, Yongjin Shin, Sangmin Bae, and Se-Young Yun.

</span>
<span class="ltx_bibblock">Preservation of the global knowledge by not-true distillation in federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages 5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas Navarro, Matthew Mattina, Paul N. Whatmough, and Venkatesh Saligrama.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</span>, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for federated visual classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.06335</span>, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Jianyu Wang, Qinghua Liu, Hao Liang, Gauri Joshi, and H Vincent Poor.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous federated optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 33:7611–7623, 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi.

</span>
<span class="ltx_bibblock">Adaptive personalized federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2003.13461</span>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Alysa Ziying Tan, Han Yu, Lizhen Cui, and Qiang Yang.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Canh T Dinh, Nguyen Tran, and Josh Nguyen.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 33:21394–21405, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical guarantees: A model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 33:3557–3568, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages 2089–2099. PMLR, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Yutao Huang, Lingyang Chu, Zirui Zhou, Lanjun Wang, Jiangchuan Liu, Jian Pei, and Yong Zhang.

</span>
<span class="ltx_bibblock">Personalized cross-silo federated learning on non-iid data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</span>, volume 35, pages 7865–7873, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Michael Zhang, Karan Sapra, Sanja Fidler, Serena Yeung, and Jose M Alvarez.

</span>
<span class="ltx_bibblock">Personalized federated learning with first order model optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Jianqing Zhang, Yang Hua, Hao Wang, Tao Song, Zhengui Xue, Ruhui Ma, and Haibing Guan.

</span>
<span class="ltx_bibblock">Fedala: Adaptive local aggregation for personalized federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</span>, volume 37, pages 11237–11244, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages 6357–6368. PMLR, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Mi Luo, Fei Chen, Dapeng Hu, Yifan Zhang, Jian Liang, and Jiashi Feng.

</span>
<span class="ltx_bibblock">No fear of heterogeneity: Classifier calibration for federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 34:5972–5984, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Matthias De Lange, Rahaf Aljundi, Marc Masana, Sarah Parisot, Xu Jia, Aleš Leonardis, Gregory Slabaugh, and Tinne Tuytelaars.

</span>
<span class="ltx_bibblock">A continual learning survey: Defying forgetting in classification tasks.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">IEEE transactions on pattern analysis and machine intelligence</span>, 44(7):3366–3385, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Neta Shoham, Tomer Avidor, Aviv Keren, Nadav Israel, Daniel Benditkis, Liron Mor-Yosef, and Itai Zeitak.

</span>
<span class="ltx_bibblock">Overcoming forgetting in federated learning on non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1910.07796</span>, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Ya Le and Xuan Yang.

</span>
<span class="ltx_bibblock">Tiny imagenet visual recognition challenge.

</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">CS 231N</span>, 7(7):3, 2015.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</span>, pages 770–778, 2016.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Hong-You Chen and Wei-Lun Chao.

</span>
<span class="ltx_bibblock">On bridging generic and personalized federated learning for image classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Jian Xu, Xinyi Tong, and Shao-Lun Huang.

</span>
<span class="ltx_bibblock">Personalized federated learning with feature alignment and classifier collaboration.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">The Eleventh International Conference on Learning Representations</span>, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Lin Zhang, Li Shen, Liang Ding, Dacheng Tao, and Ling-Yu Duan.

</span>
<span class="ltx_bibblock">Fine-tuning global model via data-free knowledge distillation for non-iid federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span>, pages 10174–10183, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental Details</h2>

<figure id="A1.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x13.png" id="A1.F7.sf1.g1" class="ltx_graphics ltx_img_square" width="97" height="97" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><math id="A1.F7.sf1.2.m1.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="A1.F7.sf1.2.m1.1b"><mrow id="A1.F7.sf1.2.m1.1.1" xref="A1.F7.sf1.2.m1.1.1.cmml"><mi id="A1.F7.sf1.2.m1.1.1.2" xref="A1.F7.sf1.2.m1.1.1.2.cmml">α</mi><mo id="A1.F7.sf1.2.m1.1.1.1" xref="A1.F7.sf1.2.m1.1.1.1.cmml">=</mo><mn id="A1.F7.sf1.2.m1.1.1.3" xref="A1.F7.sf1.2.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F7.sf1.2.m1.1c"><apply id="A1.F7.sf1.2.m1.1.1.cmml" xref="A1.F7.sf1.2.m1.1.1"><eq id="A1.F7.sf1.2.m1.1.1.1.cmml" xref="A1.F7.sf1.2.m1.1.1.1"></eq><ci id="A1.F7.sf1.2.m1.1.1.2.cmml" xref="A1.F7.sf1.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F7.sf1.2.m1.1.1.3.cmml" xref="A1.F7.sf1.2.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.sf1.2.m1.1d">\alpha=0.05</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x14.png" id="A1.F7.sf2.g1" class="ltx_graphics ltx_img_square" width="97" height="97" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><math id="A1.F7.sf2.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F7.sf2.2.m1.1b"><mrow id="A1.F7.sf2.2.m1.1.1" xref="A1.F7.sf2.2.m1.1.1.cmml"><mi id="A1.F7.sf2.2.m1.1.1.2" xref="A1.F7.sf2.2.m1.1.1.2.cmml">α</mi><mo id="A1.F7.sf2.2.m1.1.1.1" xref="A1.F7.sf2.2.m1.1.1.1.cmml">=</mo><mn id="A1.F7.sf2.2.m1.1.1.3" xref="A1.F7.sf2.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F7.sf2.2.m1.1c"><apply id="A1.F7.sf2.2.m1.1.1.cmml" xref="A1.F7.sf2.2.m1.1.1"><eq id="A1.F7.sf2.2.m1.1.1.1.cmml" xref="A1.F7.sf2.2.m1.1.1.1"></eq><ci id="A1.F7.sf2.2.m1.1.1.2.cmml" xref="A1.F7.sf2.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F7.sf2.2.m1.1.1.3.cmml" xref="A1.F7.sf2.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.sf2.2.m1.1d">\alpha=0.1</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F7.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.02416/assets/x15.png" id="A1.F7.sf3.g1" class="ltx_graphics ltx_img_square" width="97" height="97" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><math id="A1.F7.sf3.2.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A1.F7.sf3.2.m1.1b"><mrow id="A1.F7.sf3.2.m1.1.1" xref="A1.F7.sf3.2.m1.1.1.cmml"><mi id="A1.F7.sf3.2.m1.1.1.2" xref="A1.F7.sf3.2.m1.1.1.2.cmml">α</mi><mo id="A1.F7.sf3.2.m1.1.1.1" xref="A1.F7.sf3.2.m1.1.1.1.cmml">=</mo><mn id="A1.F7.sf3.2.m1.1.1.3" xref="A1.F7.sf3.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F7.sf3.2.m1.1c"><apply id="A1.F7.sf3.2.m1.1.1.cmml" xref="A1.F7.sf3.2.m1.1.1"><eq id="A1.F7.sf3.2.m1.1.1.1.cmml" xref="A1.F7.sf3.2.m1.1.1.1"></eq><ci id="A1.F7.sf3.2.m1.1.1.2.cmml" xref="A1.F7.sf3.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F7.sf3.2.m1.1.1.3.cmml" xref="A1.F7.sf3.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.sf3.2.m1.1d">\alpha=0.5</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visualizations of data distribution with varying degrees of heterogeneity severity on the Cifar10 dataset.</figcaption>
</figure>
<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Network Architecture</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.p1.1" class="ltx_p">The t-CNN is a typical convolutional neural network. It consists of two convolutional layers with 32 and 64 filters, respectively, followed by ReLU activation functions and max-pooling operations. The kernel size of the max-pooling layer is 2. The output is then flattened and fed into a fully connected layer with 512 neurons followed by the ReLU activation. The final layer is also a linear layer with the number of neurons corresponding to the specified number of classes.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Robustness to Heterogeneity</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.3" class="ltx_p">We also conduct experiments to demonstrate the robustness of our FedKA to data heterogeneity. Concretely, we set the <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mi id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\alpha</annotation></semantics></math> of the Dirichlet distribution to <math id="A1.SS2.p1.2.m2.2" class="ltx_Math" alttext="0.05,0.1" display="inline"><semantics id="A1.SS2.p1.2.m2.2a"><mrow id="A1.SS2.p1.2.m2.2.3.2" xref="A1.SS2.p1.2.m2.2.3.1.cmml"><mn id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml">0.05</mn><mo id="A1.SS2.p1.2.m2.2.3.2.1" xref="A1.SS2.p1.2.m2.2.3.1.cmml">,</mo><mn id="A1.SS2.p1.2.m2.2.2" xref="A1.SS2.p1.2.m2.2.2.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.2b"><list id="A1.SS2.p1.2.m2.2.3.1.cmml" xref="A1.SS2.p1.2.m2.2.3.2"><cn type="float" id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">0.05</cn><cn type="float" id="A1.SS2.p1.2.m2.2.2.cmml" xref="A1.SS2.p1.2.m2.2.2">0.1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.2c">0.05,0.1</annotation></semantics></math>, and <math id="A1.SS2.p1.3.m3.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="A1.SS2.p1.3.m3.1a"><mn id="A1.SS2.p1.3.m3.1.1" xref="A1.SS2.p1.3.m3.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.3.m3.1b"><cn type="float" id="A1.SS2.p1.3.m3.1.1.cmml" xref="A1.SS2.p1.3.m3.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m3.1c">0.5</annotation></semantics></math> respectively, and generate client data with varying degrees of heterogeneity severity on the Cifar10 dataset. We visualize the data distributions in Fig. <a href="#A1.F7" title="Figure 7 ‣ Appendix A Experimental Details ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. We evaluate the performance of our FedKA and other SOTA methods. Experimental results are displayed in Table <a href="#A1.T8" title="Table 8 ‣ A.2 Robustness to Heterogeneity ‣ Appendix A Experimental Details ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. As demonstrated in the table, our method is robust to severe heterogeneity and outperforms other SOTA methods.</p>
</div>
<figure id="A1.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Test accuracy of different methods with varying degrees of data heterogeneity severity.</figcaption>
<table id="A1.T8.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T8.3.3" class="ltx_tr">
<th id="A1.T8.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</th>
<th id="A1.T8.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A1.T8.1.1.1.m1.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="A1.T8.1.1.1.m1.1a"><mrow id="A1.T8.1.1.1.m1.1.1" xref="A1.T8.1.1.1.m1.1.1.cmml"><mi id="A1.T8.1.1.1.m1.1.1.2" xref="A1.T8.1.1.1.m1.1.1.2.cmml">α</mi><mo id="A1.T8.1.1.1.m1.1.1.1" xref="A1.T8.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.T8.1.1.1.m1.1.1.3" xref="A1.T8.1.1.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T8.1.1.1.m1.1b"><apply id="A1.T8.1.1.1.m1.1.1.cmml" xref="A1.T8.1.1.1.m1.1.1"><eq id="A1.T8.1.1.1.m1.1.1.1.cmml" xref="A1.T8.1.1.1.m1.1.1.1"></eq><ci id="A1.T8.1.1.1.m1.1.1.2.cmml" xref="A1.T8.1.1.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.T8.1.1.1.m1.1.1.3.cmml" xref="A1.T8.1.1.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.1.1.1.m1.1c">\alpha=0.05</annotation></semantics></math></th>
<th id="A1.T8.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A1.T8.2.2.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.T8.2.2.2.m1.1a"><mrow id="A1.T8.2.2.2.m1.1.1" xref="A1.T8.2.2.2.m1.1.1.cmml"><mi id="A1.T8.2.2.2.m1.1.1.2" xref="A1.T8.2.2.2.m1.1.1.2.cmml">α</mi><mo id="A1.T8.2.2.2.m1.1.1.1" xref="A1.T8.2.2.2.m1.1.1.1.cmml">=</mo><mn id="A1.T8.2.2.2.m1.1.1.3" xref="A1.T8.2.2.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T8.2.2.2.m1.1b"><apply id="A1.T8.2.2.2.m1.1.1.cmml" xref="A1.T8.2.2.2.m1.1.1"><eq id="A1.T8.2.2.2.m1.1.1.1.cmml" xref="A1.T8.2.2.2.m1.1.1.1"></eq><ci id="A1.T8.2.2.2.m1.1.1.2.cmml" xref="A1.T8.2.2.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.T8.2.2.2.m1.1.1.3.cmml" xref="A1.T8.2.2.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.2.2.2.m1.1c">\alpha=0.1</annotation></semantics></math></th>
<th id="A1.T8.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A1.T8.3.3.3.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A1.T8.3.3.3.m1.1a"><mrow id="A1.T8.3.3.3.m1.1.1" xref="A1.T8.3.3.3.m1.1.1.cmml"><mi id="A1.T8.3.3.3.m1.1.1.2" xref="A1.T8.3.3.3.m1.1.1.2.cmml">α</mi><mo id="A1.T8.3.3.3.m1.1.1.1" xref="A1.T8.3.3.3.m1.1.1.1.cmml">=</mo><mn id="A1.T8.3.3.3.m1.1.1.3" xref="A1.T8.3.3.3.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T8.3.3.3.m1.1b"><apply id="A1.T8.3.3.3.m1.1.1.cmml" xref="A1.T8.3.3.3.m1.1.1"><eq id="A1.T8.3.3.3.m1.1.1.1.cmml" xref="A1.T8.3.3.3.m1.1.1.1"></eq><ci id="A1.T8.3.3.3.m1.1.1.2.cmml" xref="A1.T8.3.3.3.m1.1.1.2">𝛼</ci><cn type="float" id="A1.T8.3.3.3.m1.1.1.3.cmml" xref="A1.T8.3.3.3.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T8.3.3.3.m1.1c">\alpha=0.5</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T8.3.4.1" class="ltx_tr">
<th id="A1.T8.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<td id="A1.T8.3.4.1.2" class="ltx_td ltx_align_center ltx_border_t">0.578</td>
<td id="A1.T8.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t">0.598</td>
<td id="A1.T8.3.4.1.4" class="ltx_td ltx_align_center ltx_border_t">0.601</td>
</tr>
<tr id="A1.T8.3.5.2" class="ltx_tr">
<th id="A1.T8.3.5.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">FedProx</th>
<td id="A1.T8.3.5.2.2" class="ltx_td ltx_align_center">0.530</td>
<td id="A1.T8.3.5.2.3" class="ltx_td ltx_align_center">0.555</td>
<td id="A1.T8.3.5.2.4" class="ltx_td ltx_align_center">0.567</td>
</tr>
<tr id="A1.T8.3.6.3" class="ltx_tr">
<th id="A1.T8.3.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">MOON</th>
<td id="A1.T8.3.6.3.2" class="ltx_td ltx_align_center">0.551</td>
<td id="A1.T8.3.6.3.3" class="ltx_td ltx_align_center">0.590</td>
<td id="A1.T8.3.6.3.4" class="ltx_td ltx_align_center">0.563</td>
</tr>
<tr id="A1.T8.3.7.4" class="ltx_tr">
<th id="A1.T8.3.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">FedNTD</th>
<td id="A1.T8.3.7.4.2" class="ltx_td ltx_align_center">0.577</td>
<td id="A1.T8.3.7.4.3" class="ltx_td ltx_align_center">0.562</td>
<td id="A1.T8.3.7.4.4" class="ltx_td ltx_align_center">0.606</td>
</tr>
<tr id="A1.T8.3.8.5" class="ltx_tr">
<th id="A1.T8.3.8.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">FedKA</th>
<td id="A1.T8.3.8.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T8.3.8.5.2.1" class="ltx_text ltx_font_bold">0.582</span></td>
<td id="A1.T8.3.8.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T8.3.8.5.3.1" class="ltx_text ltx_font_bold">0.619</span></td>
<td id="A1.T8.3.8.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T8.3.8.5.4.1" class="ltx_text ltx_font_bold">0.613</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Generic Performance Comparison with Personalized Methods</h3>

<div id="A1.SS3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.p1.1" class="ltx_p">We also conduct experiments to compare the generic performance of our FedKA with other SOTA personalized federated learning methods, e.g. FedALA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, FedRoD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, FedFOMO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, and FedPAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, etc. Following the strategy of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, we measure the generic performance of these methods compared with our FedKA. The experimental results are displayed in Table <a href="#A1.T9" title="Table 9 ‣ A.3 Generic Performance Comparison with Personalized Methods ‣ Appendix A Experimental Details ‣ Towards Fast and Stable Federated Learning: Confronting Heterogeneity via Knowledge Anchor" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. The proposed FedKA exhibits stronger generalization performance with higher generic accuracy.</p>
</div>
<figure id="A1.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Generic performance compared with SOTA personalized federated methods.</figcaption>
<table id="A1.T9.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T9.1.1.1" class="ltx_tr">
<th id="A1.T9.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="A1.T9.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Cifar10</th>
<th id="A1.T9.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Cifar 100</th>
<th id="A1.T9.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Tiny-ImageNet</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T9.1.2.1" class="ltx_tr">
<td id="A1.T9.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">FedRoD</td>
<td id="A1.T9.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">0.540</td>
<td id="A1.T9.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.194</td>
<td id="A1.T9.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.079</td>
</tr>
<tr id="A1.T9.1.3.2" class="ltx_tr">
<td id="A1.T9.1.3.2.1" class="ltx_td ltx_align_center">FedFOMO</td>
<td id="A1.T9.1.3.2.2" class="ltx_td ltx_align_center">0.529</td>
<td id="A1.T9.1.3.2.3" class="ltx_td ltx_align_center">0.138</td>
<td id="A1.T9.1.3.2.4" class="ltx_td ltx_align_center">0.098</td>
</tr>
<tr id="A1.T9.1.4.3" class="ltx_tr">
<td id="A1.T9.1.4.3.1" class="ltx_td ltx_align_center">FedPAC</td>
<td id="A1.T9.1.4.3.2" class="ltx_td ltx_align_center">0.516</td>
<td id="A1.T9.1.4.3.3" class="ltx_td ltx_align_center">0.163</td>
<td id="A1.T9.1.4.3.4" class="ltx_td ltx_align_center">0.097</td>
</tr>
<tr id="A1.T9.1.5.4" class="ltx_tr">
<td id="A1.T9.1.5.4.1" class="ltx_td ltx_align_center">FedALA</td>
<td id="A1.T9.1.5.4.2" class="ltx_td ltx_align_center">0.545</td>
<td id="A1.T9.1.5.4.3" class="ltx_td ltx_align_center">0.205</td>
<td id="A1.T9.1.5.4.4" class="ltx_td ltx_align_center">0.097</td>
</tr>
<tr id="A1.T9.1.6.5" class="ltx_tr">
<td id="A1.T9.1.6.5.1" class="ltx_td ltx_align_center ltx_border_bb">FedKA</td>
<td id="A1.T9.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.1.6.5.2.1" class="ltx_text ltx_font_bold">0.619</span></td>
<td id="A1.T9.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.1.6.5.3.1" class="ltx_text ltx_font_bold">0.293</span></td>
<td id="A1.T9.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="A1.T9.1.6.5.4.1" class="ltx_text ltx_font_bold">0.117</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Discussion of Minimal Shared Dataset</h3>

<div id="A1.SS4.p1" class="ltx_para ltx_noindent">
<p id="A1.SS4.p1.6" class="ltx_p">In the proposed FedKA, we assume that all clients collaboratively share a minimal dataset that contains only one sample for one class. The number of samples in the minimal shared dataset is <math id="A1.SS4.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.SS4.p1.1.m1.1a"><mi id="A1.SS4.p1.1.m1.1.1" xref="A1.SS4.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.1b"><ci id="A1.SS4.p1.1.m1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.1c">K</annotation></semantics></math>. This assumption may raise the concern about suitability. However, such an assumption is easy to be satisfied.
Firstly, for a <math id="A1.SS4.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.SS4.p1.2.m2.1a"><mi id="A1.SS4.p1.2.m2.1.1" xref="A1.SS4.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m2.1b"><ci id="A1.SS4.p1.2.m2.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.2.m2.1c">K</annotation></semantics></math>-classification task, we just require <math id="A1.SS4.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.SS4.p1.3.m3.1a"><mi id="A1.SS4.p1.3.m3.1.1" xref="A1.SS4.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.3.m3.1b"><ci id="A1.SS4.p1.3.m3.1.1.cmml" xref="A1.SS4.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.3.m3.1c">K</annotation></semantics></math> samples, which is a negligible portion of the entire dataset (e.g., approximately <math id="A1.SS4.p1.4.m4.1" class="ltx_Math" alttext="\frac{1}{6000}" display="inline"><semantics id="A1.SS4.p1.4.m4.1a"><mfrac id="A1.SS4.p1.4.m4.1.1" xref="A1.SS4.p1.4.m4.1.1.cmml"><mn id="A1.SS4.p1.4.m4.1.1.2" xref="A1.SS4.p1.4.m4.1.1.2.cmml">1</mn><mn id="A1.SS4.p1.4.m4.1.1.3" xref="A1.SS4.p1.4.m4.1.1.3.cmml">6000</mn></mfrac><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.4.m4.1b"><apply id="A1.SS4.p1.4.m4.1.1.cmml" xref="A1.SS4.p1.4.m4.1.1"><divide id="A1.SS4.p1.4.m4.1.1.1.cmml" xref="A1.SS4.p1.4.m4.1.1"></divide><cn type="integer" id="A1.SS4.p1.4.m4.1.1.2.cmml" xref="A1.SS4.p1.4.m4.1.1.2">1</cn><cn type="integer" id="A1.SS4.p1.4.m4.1.1.3.cmml" xref="A1.SS4.p1.4.m4.1.1.3">6000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.4.m4.1c">\frac{1}{6000}</annotation></semantics></math> for Cifar10/100) and easy to be satisfied. Moreover, the number of clients <math id="A1.SS4.p1.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.SS4.p1.5.m5.1a"><mi id="A1.SS4.p1.5.m5.1.1" xref="A1.SS4.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.5.m5.1b"><ci id="A1.SS4.p1.5.m5.1.1.cmml" xref="A1.SS4.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.5.m5.1c">N</annotation></semantics></math> is usually greater than <math id="A1.SS4.p1.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.SS4.p1.6.m6.1a"><mi id="A1.SS4.p1.6.m6.1.1" xref="A1.SS4.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.6.m6.1b"><ci id="A1.SS4.p1.6.m6.1.1.cmml" xref="A1.SS4.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.6.m6.1c">K</annotation></semantics></math>, ensuring that only a few clients need to contribute one sample. Secondly, even in cases where real-world data is inaccessible, we can adopt generative approaches to generate representative pseudo-data, such as the FedFTG method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. The use of pseudo-data as knowledge anchors will also be explored further in our future work.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2312.02415" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2312.02416" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2312.02416">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2312.02416" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2312.02417" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 15:22:19 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
