<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Contrastive Learning on Medical Intents for Sequential Prescription Recommendation</title>
<!--Generated on Tue Aug 13 20:02:52 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Electronic Health Records,  Prescription Recommendation,  Contrastive Learning" lang="en" name="keywords"/>
<base href="/html/2408.10259v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S1" title="In Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2" title="In Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS1" title="In ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS2" title="In ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Methodology Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS3" title="In ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Temporal Paths Representation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS3.SSS1" title="In 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Visit-Level Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS3.SSS2" title="In 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>Cross-Visit Transformer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS4" title="In ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Contrasted Intents</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS5" title="In ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Aggregation and Prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS6" title="In ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.6 </span>Loss Function</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3" title="In Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS1" title="In valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS2" title="In valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS3" title="In valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS4" title="In valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS5" title="In valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Results and Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS5.SSS1" title="In 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.1 </span>RQ1. Performance Comparison with Baselines:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS5.SSS2" title="In 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.2 </span>RQ2. Ablation Studies:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS5.SSS3" title="In 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.3 </span>RQ3. Including Repetitive Prescriptions:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.SS5.SSS4" title="In 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5.4 </span>RQ4. Interpretability:</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S4" title="In Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S5" title="In Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Contrastive Learning on Medical Intents for Sequential Prescription Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Arya Hadizadeh Moghaddam
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:a.hadizadehm@ku.edu">a.hadizadehm@ku.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">University of Kansas</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Lawrence</span><span class="ltx_text ltx_affiliation_state" id="id3.3.id3">KS</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id4">USA</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mohsen Nayebi Kerdabadi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:mohsen.nayebi@ku.edu">mohsen.nayebi@ku.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">University of Kansas</span><span class="ltx_text ltx_affiliation_city" id="id6.2.id2">Lawrence</span><span class="ltx_text ltx_affiliation_state" id="id7.3.id3">KS</span><span class="ltx_text ltx_affiliation_country" id="id8.4.id4">USA</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mei Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:mei.liu@ufl.edu">mei.liu@ufl.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">University of Florida</span><span class="ltx_text ltx_affiliation_city" id="id10.2.id2">Gainesville</span><span class="ltx_text ltx_affiliation_state" id="id11.3.id3">FL</span><span class="ltx_text ltx_affiliation_country" id="id12.4.id4">USA</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zijun Yao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:zyao@ku.edu">zyao@ku.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">University of Kansas</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Lawrence</span><span class="ltx_text ltx_affiliation_state" id="id15.3.id3">KS</span><span class="ltx_text ltx_affiliation_country" id="id16.4.id4">USA</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">ABSTRACT.</h6>
<p class="ltx_p" id="id17.id1">Recent advancements in sequential modeling applied to Electronic Health Records (EHR) have greatly influenced prescription recommender systems.
While the recent literature on drug recommendation has shown promising performance, the study of discovering a diversity of coexisting temporal relationships at the level of medical codes over consecutive visits remains less explored. The goal of this study can be motivated from two perspectives. First, there is a need to develop a sophisticated sequential model capable of disentangling the complex relationships across sequential visits. Second, it is crucial to establish multiple and diverse health profiles for the same patient to ensure a comprehensive consideration of different medical intents in drug recommendation. To achieve this goal, we introduce Attentive Recommendation with Contrasted Intents (ARCI), a multi-level transformer-based method designed to capture the different but coexisting temporal paths across a shared sequence of visits. Specifically, we propose a novel intent-aware method with contrastive learning, that links specialized medical intents of the patients to the transformer heads for extracting distinct temporal paths associated with different health profiles. We conducted experiments on two real-world datasets for the prescription recommendation task using both ranking and classification metrics. Our results demonstrate that ARCI has outperformed the state-of-the-art prescription recommendation methods and is capable of providing interpretable insights for healthcare practitioners.</p>
</div>
<div class="ltx_keywords">Electronic Health Records, Prescription Recommendation, Contrastive Learning
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 33rd ACM International
Conference on Information and Knowledge Management; October 21–25,2024; Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 33rd ACM International Conference on
Information and Knowledge Management (CIKM ’24), October 21–25, 2024,
Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3679836</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Data mining</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Applied computing Health informatics</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:144%;">   ntroduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="122" id="S1.F1.g1" src="extracted/5788641/Figs/Figure_1_1.png" width="314"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">In EHR, a patient’s sequence of visits often involves more than one thread of prescribing drugs driven by different medical intents (e.g., influenza and ADHD). We use temporal paths to distinguish the distinct dependencies among medical codes associated with different intents.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, the abundance of Electronic Health Records (EHRs) has helped medical professionals enable a variety of data-driven applications for personalized healthcare analysis <cite class="ltx_cite ltx_citemacro_citep">(Ashton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib3" title="">2023</a>)</cite>. In particular, sequential prescription recommender systems have attracted a growing interest <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib46" title="">2023c</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib35" title="">2022</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib29" title="">2022</a>; Bhoi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib6" title="">2024</a>)</cite>, by supporting informed treatment decisions through the analysis of complex EHR data accumulated during the long history of individuals’ medical encounters.
Aiming at predicting the medication in the next visit, a personalized algorithm is needed to examine a multitude of medical features, including diagnosis, procedures, and prescription codes, while also capturing the intricate interactive relationships among them <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib40" title="">2021c</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">A notable challenge in building the sequential prescription recommendation arises from the multi-level structure of EHR features <cite class="ltx_cite ltx_citemacro_citep">(Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib11" title="">2020</a>; Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib43" title="">2023</a>)</cite>. In EHR data, each patient consists of a sequence of healthcare visits, and within each visit, there exists a bag of medical codes for various events. Therefore, a distinctive challenge of learning temporal patterns in a sequence of medical visits is to address the heterogeneity of code interdependencies that happen simultaneously. For example, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S1.F1" title="Figure 1 ‣ ntroduction ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, a patient’s healthcare history can facilitate two series of drug prescriptions, addressing different treatment goals.
As a result, we believe that a single sequence of visits in EHR can be disentangled into more than one unique thread of prescribing considerations. We name each specialized prescribing thread a “temporal path” across consecutive visits to distinguish different types of temporal relationships. Recognizing a set of diverse temporal paths is crucial for modeling multiple concurrent medical conditions that occur in the same patient.
However, existing sequential recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Ranjbar Kermany et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib25" title="">2022</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib36" title="">2019</a>)</cite>, such as the modeling of movie preferences, mostly study a homogeneous temporal relationship, where each “visit” only contains a single item at a time, making their capacity less suitable for the multi-level structure of EHR features.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">By extracting multiple dependencies over consecutive visits at the patient level, we propose to characterize temporal paths and link them to a set of distinct medical profiles (e.g., “influenza” and “ADHD” in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S1.F1" title="Figure 1 ‣ ntroduction ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>).
This specific design of having multiple distinct profiles in the same patient echoes a concept presented in the recent literature of recommender systems, known as “Intent-Aware” recommendation, which is capable of capturing diverse profiles of user preference simultaneously <cite class="ltx_cite ltx_citemacro_citep">(Koniew, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib18" title="">2020</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib44" title="">2023a</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib9" title="">2022</a>)</cite>. For example in e-commerce recommendation, a successful intent-aware algorithm can capture a user’s interest in both technology and car equipment, and by analyzing both specific interests, the system generates overall recommendations that are aligned with the user’s preferences in both areas. The concept of intent in recommender systems can also be applied to EHR systems for more generalized temporal relationship learning. However, it remains a less explored research direction in prescription recommendation. A significant challenge in using intents for prescription recommendations is to ensure that each intent is able to represent a separate temporal path, and it can be clearly distinguished from other intents to represent a specialized medical profile. To achieve this goal, developing a contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib8" title="">2020</a>; Khosla et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib16" title="">2020</a>)</cite> framework on such medical intents constitutes a feasible approach.
Contrastive learning is generally achieved by training an objective of contrasting positive pairs (similar samples) and negative pairs (dissimilar samples) to learn a discriminative representation.
In our case, by viewing every medical intent as an anchor, the framework will encourage the recommendation models to bring the extracted temporal paths closer to the corresponding intents, meanwhile, to push each medical intent apart from the other intents in the embedding space. In this way, every intent will be maximally diverse from each other, and the specialized temporal patterns will be extracted.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To this end, in this paper, we introduce <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">Attentive Recommendation with Contrasted Intents (ARCI)</em>, a personalized multi-level transformer-based approach designed to model simultaneous temporal paths over consecutive visits, and extract distinct medical intents for facilitating prescription recommendation with the following contributions:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">First, we introduce a multi-level transformer-based approach designed to extract multiple temporal paths associated with distinct medical intents, which captures both inter-visit and intra-visit medication dependencies for visit-level and cross-visit EHR representation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Second, we propose a novel contrastive learning approach to extract diverse medical intents for regularizing the multiple temporal paths of the same patients. Each intent is linked to a dedicated transformer attention-head offering two advantages: (1) each intent and corresponding temporal path represent a specialized type of patient profile; (2) all the intents will be distinct from each other and work collectively to achieve a comprehensive patient representation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Last, we validate ARCI on MIMIC-III <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib14" title="">2016</a>)</cite> and Acute Kidney Injury (AKI) <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib19" title="">2022</a>)</cite> datasets with comprehensive ranking and classification metrics on the quality of recommendations. The experimental results illustrate that the proposed method outperforms state-of-the-art recommendation approaches. Furthermore, we assess the interpretability of the proposed method to provide meaningful clinical insights for practitioners.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:144%;">   ethodology</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Problem Formulation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.12">In the EHR data, each patient is represented as a time sequence of visits, and in each visit, various prescribed medications are recorded. Formally, for a patient <math alttext="p" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_p</annotation></semantics></math>, there is a sequence of visit sorted by time from the earliest to the latest <math alttext="\mathbf{X}^{p}=\langle\mathbf{x}_{1},\mathbf{x}_{2},\ldots,\mathbf{x}_{T}\rangle" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.4"><semantics id="S2.SS1.p1.2.m2.4a"><mrow id="S2.SS1.p1.2.m2.4.4" xref="S2.SS1.p1.2.m2.4.4.cmml"><msup id="S2.SS1.p1.2.m2.4.4.5" xref="S2.SS1.p1.2.m2.4.4.5.cmml"><mi id="S2.SS1.p1.2.m2.4.4.5.2" xref="S2.SS1.p1.2.m2.4.4.5.2.cmml">𝐗</mi><mi id="S2.SS1.p1.2.m2.4.4.5.3" xref="S2.SS1.p1.2.m2.4.4.5.3.cmml">p</mi></msup><mo id="S2.SS1.p1.2.m2.4.4.4" xref="S2.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.4.4.3.3" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml"><mo id="S2.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">⟨</mo><msub id="S2.SS1.p1.2.m2.2.2.1.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.2.2.1.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml">𝐱</mi><mn id="S2.SS1.p1.2.m2.2.2.1.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.5" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.3.3.2.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml">𝐱</mi><mn id="S2.SS1.p1.2.m2.3.3.2.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.6" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S2.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.p1.2.m2.4.4.3.3.7" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.4.4.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.2" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml">𝐱</mi><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml">T</mi></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.4b"><apply id="S2.SS1.p1.2.m2.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4"><eq id="S2.SS1.p1.2.m2.4.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4.4"></eq><apply id="S2.SS1.p1.2.m2.4.4.5.cmml" xref="S2.SS1.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.4.4.5.1.cmml" xref="S2.SS1.p1.2.m2.4.4.5">superscript</csymbol><ci id="S2.SS1.p1.2.m2.4.4.5.2.cmml" xref="S2.SS1.p1.2.m2.4.4.5.2">𝐗</ci><ci id="S2.SS1.p1.2.m2.4.4.5.3.cmml" xref="S2.SS1.p1.2.m2.4.4.5.3">𝑝</ci></apply><list id="S2.SS1.p1.2.m2.4.4.3.4.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3"><apply id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2">𝐱</ci><cn id="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2">𝐱</ci><cn id="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">…</ci><apply id="S2.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2">𝐱</ci><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.4c">\mathbf{X}^{p}=\langle\mathbf{x}_{1},\mathbf{x}_{2},\ldots,\mathbf{x}_{T}\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.4d">bold_X start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT = ⟨ bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ⟩</annotation></semantics></math>, where <math alttext="T" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_T</annotation></semantics></math> represents his/her particular number of total visits<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We omit the superscript <math alttext="p" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">p</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">italic_p</annotation></semantics></math> for simplification when we explain for one patient.</span></span></span>.
In the sequence of visits, each visit <math alttext="\mathbf{x}_{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">𝐱</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝐱</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\mathbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is represented by <math alttext="\langle{m^{t}_{1}},{m^{t}_{2}},\dots,{m^{t}_{L_{t}}}\rangle" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.4"><semantics id="S2.SS1.p1.5.m5.4a"><mrow id="S2.SS1.p1.5.m5.4.4.3" xref="S2.SS1.p1.5.m5.4.4.4.cmml"><mo id="S2.SS1.p1.5.m5.4.4.3.4" stretchy="false" xref="S2.SS1.p1.5.m5.4.4.4.cmml">⟨</mo><msubsup id="S2.SS1.p1.5.m5.2.2.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.2.2" xref="S2.SS1.p1.5.m5.2.2.1.1.2.2.cmml">m</mi><mn id="S2.SS1.p1.5.m5.2.2.1.1.3" xref="S2.SS1.p1.5.m5.2.2.1.1.3.cmml">1</mn><mi id="S2.SS1.p1.5.m5.2.2.1.1.2.3" xref="S2.SS1.p1.5.m5.2.2.1.1.2.3.cmml">t</mi></msubsup><mo id="S2.SS1.p1.5.m5.4.4.3.5" xref="S2.SS1.p1.5.m5.4.4.4.cmml">,</mo><msubsup id="S2.SS1.p1.5.m5.3.3.2.2" xref="S2.SS1.p1.5.m5.3.3.2.2.cmml"><mi id="S2.SS1.p1.5.m5.3.3.2.2.2.2" xref="S2.SS1.p1.5.m5.3.3.2.2.2.2.cmml">m</mi><mn id="S2.SS1.p1.5.m5.3.3.2.2.3" xref="S2.SS1.p1.5.m5.3.3.2.2.3.cmml">2</mn><mi id="S2.SS1.p1.5.m5.3.3.2.2.2.3" xref="S2.SS1.p1.5.m5.3.3.2.2.2.3.cmml">t</mi></msubsup><mo id="S2.SS1.p1.5.m5.4.4.3.6" xref="S2.SS1.p1.5.m5.4.4.4.cmml">,</mo><mi id="S2.SS1.p1.5.m5.1.1" mathvariant="normal" xref="S2.SS1.p1.5.m5.1.1.cmml">…</mi><mo id="S2.SS1.p1.5.m5.4.4.3.7" xref="S2.SS1.p1.5.m5.4.4.4.cmml">,</mo><msubsup id="S2.SS1.p1.5.m5.4.4.3.3" xref="S2.SS1.p1.5.m5.4.4.3.3.cmml"><mi id="S2.SS1.p1.5.m5.4.4.3.3.2.2" xref="S2.SS1.p1.5.m5.4.4.3.3.2.2.cmml">m</mi><msub id="S2.SS1.p1.5.m5.4.4.3.3.3" xref="S2.SS1.p1.5.m5.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.5.m5.4.4.3.3.3.2" xref="S2.SS1.p1.5.m5.4.4.3.3.3.2.cmml">L</mi><mi id="S2.SS1.p1.5.m5.4.4.3.3.3.3" xref="S2.SS1.p1.5.m5.4.4.3.3.3.3.cmml">t</mi></msub><mi id="S2.SS1.p1.5.m5.4.4.3.3.2.3" xref="S2.SS1.p1.5.m5.4.4.3.3.2.3.cmml">t</mi></msubsup><mo id="S2.SS1.p1.5.m5.4.4.3.8" stretchy="false" xref="S2.SS1.p1.5.m5.4.4.4.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.4b"><list id="S2.SS1.p1.5.m5.4.4.4.cmml" xref="S2.SS1.p1.5.m5.4.4.3"><apply id="S2.SS1.p1.5.m5.2.2.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1">subscript</csymbol><apply id="S2.SS1.p1.5.m5.2.2.1.1.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.2.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1">superscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.2.2">𝑚</ci><ci id="S2.SS1.p1.5.m5.2.2.1.1.2.3.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.2.3">𝑡</ci></apply><cn id="S2.SS1.p1.5.m5.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.2.2.1.1.3">1</cn></apply><apply id="S2.SS1.p1.5.m5.3.3.2.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.3.3.2.2.1.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2">subscript</csymbol><apply id="S2.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2">superscript</csymbol><ci id="S2.SS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2.2">𝑚</ci><ci id="S2.SS1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2.3">𝑡</ci></apply><cn id="S2.SS1.p1.5.m5.3.3.2.2.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.3.3.2.2.3">2</cn></apply><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">…</ci><apply id="S2.SS1.p1.5.m5.4.4.3.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.3.3.1.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3">subscript</csymbol><apply id="S2.SS1.p1.5.m5.4.4.3.3.2.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.3.3.2.1.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3">superscript</csymbol><ci id="S2.SS1.p1.5.m5.4.4.3.3.2.2.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.2.2">𝑚</ci><ci id="S2.SS1.p1.5.m5.4.4.3.3.2.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.2.3">𝑡</ci></apply><apply id="S2.SS1.p1.5.m5.4.4.3.3.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3.2">𝐿</ci><ci id="S2.SS1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3.3">𝑡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.4c">\langle{m^{t}_{1}},{m^{t}_{2}},\dots,{m^{t}_{L_{t}}}\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.4d">⟨ italic_m start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_m start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_m start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⟩</annotation></semantics></math>, a dynamic set of medication where <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_t</annotation></semantics></math> indicates the specific visit and <math alttext="L_{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><msub id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">L</mi><mi id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">𝐿</ci><ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">L_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_L start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> shows the total number of medication prescribed at visit <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_t</annotation></semantics></math>.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S2.SS1.p1.12.1">Task: </span>Given the medication of sequential visits from <math alttext="\mathbf{x}_{1}" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.1"><semantics id="S2.SS1.p1.9.m9.1a"><msub id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">𝐱</mi><mn id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝐱</ci><cn id="S2.SS1.p1.9.m9.1.1.3.cmml" type="integer" xref="S2.SS1.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\mathbf{x}_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\mathbf{x}_{T}" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><msub id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">𝐱</mi><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝐱</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathbf{x}_{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">bold_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> belonging to a patient, the goal of recommendation model is to predict a distinct set of medication for the next-visit at <math alttext="T+1" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mrow id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml">T</mi><mo id="S2.SS1.p1.11.m11.1.1.1" xref="S2.SS1.p1.11.m11.1.1.1.cmml">+</mo><mn id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><plus id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1.1"></plus><ci id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2">𝑇</ci><cn id="S2.SS1.p1.11.m11.1.1.3.cmml" type="integer" xref="S2.SS1.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">T+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_T + 1</annotation></semantics></math>, denotes <math alttext="\langle{m^{T+1}_{1}},{m^{T+1}_{2}},\dots,{m^{T+1}_{L_{T+1}}}\rangle" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m12.4"><semantics id="S2.SS1.p1.12.m12.4a"><mrow id="S2.SS1.p1.12.m12.4.4.3" xref="S2.SS1.p1.12.m12.4.4.4.cmml"><mo id="S2.SS1.p1.12.m12.4.4.3.4" stretchy="false" xref="S2.SS1.p1.12.m12.4.4.4.cmml">⟨</mo><msubsup id="S2.SS1.p1.12.m12.2.2.1.1" xref="S2.SS1.p1.12.m12.2.2.1.1.cmml"><mi id="S2.SS1.p1.12.m12.2.2.1.1.2.2" xref="S2.SS1.p1.12.m12.2.2.1.1.2.2.cmml">m</mi><mn id="S2.SS1.p1.12.m12.2.2.1.1.3" xref="S2.SS1.p1.12.m12.2.2.1.1.3.cmml">1</mn><mrow id="S2.SS1.p1.12.m12.2.2.1.1.2.3" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3.cmml"><mi id="S2.SS1.p1.12.m12.2.2.1.1.2.3.2" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3.2.cmml">T</mi><mo id="S2.SS1.p1.12.m12.2.2.1.1.2.3.1" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.12.m12.2.2.1.1.2.3.3" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS1.p1.12.m12.4.4.3.5" xref="S2.SS1.p1.12.m12.4.4.4.cmml">,</mo><msubsup id="S2.SS1.p1.12.m12.3.3.2.2" xref="S2.SS1.p1.12.m12.3.3.2.2.cmml"><mi id="S2.SS1.p1.12.m12.3.3.2.2.2.2" xref="S2.SS1.p1.12.m12.3.3.2.2.2.2.cmml">m</mi><mn id="S2.SS1.p1.12.m12.3.3.2.2.3" xref="S2.SS1.p1.12.m12.3.3.2.2.3.cmml">2</mn><mrow id="S2.SS1.p1.12.m12.3.3.2.2.2.3" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3.cmml"><mi id="S2.SS1.p1.12.m12.3.3.2.2.2.3.2" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3.2.cmml">T</mi><mo id="S2.SS1.p1.12.m12.3.3.2.2.2.3.1" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.12.m12.3.3.2.2.2.3.3" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS1.p1.12.m12.4.4.3.6" xref="S2.SS1.p1.12.m12.4.4.4.cmml">,</mo><mi id="S2.SS1.p1.12.m12.1.1" mathvariant="normal" xref="S2.SS1.p1.12.m12.1.1.cmml">…</mi><mo id="S2.SS1.p1.12.m12.4.4.3.7" xref="S2.SS1.p1.12.m12.4.4.4.cmml">,</mo><msubsup id="S2.SS1.p1.12.m12.4.4.3.3" xref="S2.SS1.p1.12.m12.4.4.3.3.cmml"><mi id="S2.SS1.p1.12.m12.4.4.3.3.2.2" xref="S2.SS1.p1.12.m12.4.4.3.3.2.2.cmml">m</mi><msub id="S2.SS1.p1.12.m12.4.4.3.3.3" xref="S2.SS1.p1.12.m12.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.12.m12.4.4.3.3.3.2" xref="S2.SS1.p1.12.m12.4.4.3.3.3.2.cmml">L</mi><mrow id="S2.SS1.p1.12.m12.4.4.3.3.3.3" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3.cmml"><mi id="S2.SS1.p1.12.m12.4.4.3.3.3.3.2" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3.2.cmml">T</mi><mo id="S2.SS1.p1.12.m12.4.4.3.3.3.3.1" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3.1.cmml">+</mo><mn id="S2.SS1.p1.12.m12.4.4.3.3.3.3.3" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3.3.cmml">1</mn></mrow></msub><mrow id="S2.SS1.p1.12.m12.4.4.3.3.2.3" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3.cmml"><mi id="S2.SS1.p1.12.m12.4.4.3.3.2.3.2" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3.2.cmml">T</mi><mo id="S2.SS1.p1.12.m12.4.4.3.3.2.3.1" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.12.m12.4.4.3.3.2.3.3" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S2.SS1.p1.12.m12.4.4.3.8" stretchy="false" xref="S2.SS1.p1.12.m12.4.4.4.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.4b"><list id="S2.SS1.p1.12.m12.4.4.4.cmml" xref="S2.SS1.p1.12.m12.4.4.3"><apply id="S2.SS1.p1.12.m12.2.2.1.1.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.2.2.1.1.1.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1">subscript</csymbol><apply id="S2.SS1.p1.12.m12.2.2.1.1.2.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.2.2.1.1.2.1.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1">superscript</csymbol><ci id="S2.SS1.p1.12.m12.2.2.1.1.2.2.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.2.2">𝑚</ci><apply id="S2.SS1.p1.12.m12.2.2.1.1.2.3.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3"><plus id="S2.SS1.p1.12.m12.2.2.1.1.2.3.1.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3.1"></plus><ci id="S2.SS1.p1.12.m12.2.2.1.1.2.3.2.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3.2">𝑇</ci><cn id="S2.SS1.p1.12.m12.2.2.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.p1.12.m12.2.2.1.1.2.3.3">1</cn></apply></apply><cn id="S2.SS1.p1.12.m12.2.2.1.1.3.cmml" type="integer" xref="S2.SS1.p1.12.m12.2.2.1.1.3">1</cn></apply><apply id="S2.SS1.p1.12.m12.3.3.2.2.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.3.3.2.2.1.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2">subscript</csymbol><apply id="S2.SS1.p1.12.m12.3.3.2.2.2.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2">superscript</csymbol><ci id="S2.SS1.p1.12.m12.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2.2.2">𝑚</ci><apply id="S2.SS1.p1.12.m12.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3"><plus id="S2.SS1.p1.12.m12.3.3.2.2.2.3.1.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3.1"></plus><ci id="S2.SS1.p1.12.m12.3.3.2.2.2.3.2.cmml" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3.2">𝑇</ci><cn id="S2.SS1.p1.12.m12.3.3.2.2.2.3.3.cmml" type="integer" xref="S2.SS1.p1.12.m12.3.3.2.2.2.3.3">1</cn></apply></apply><cn id="S2.SS1.p1.12.m12.3.3.2.2.3.cmml" type="integer" xref="S2.SS1.p1.12.m12.3.3.2.2.3">2</cn></apply><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">…</ci><apply id="S2.SS1.p1.12.m12.4.4.3.3.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.4.4.3.3.1.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3">subscript</csymbol><apply id="S2.SS1.p1.12.m12.4.4.3.3.2.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.4.4.3.3.2.1.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3">superscript</csymbol><ci id="S2.SS1.p1.12.m12.4.4.3.3.2.2.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.2.2">𝑚</ci><apply id="S2.SS1.p1.12.m12.4.4.3.3.2.3.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3"><plus id="S2.SS1.p1.12.m12.4.4.3.3.2.3.1.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3.1"></plus><ci id="S2.SS1.p1.12.m12.4.4.3.3.2.3.2.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3.2">𝑇</ci><cn id="S2.SS1.p1.12.m12.4.4.3.3.2.3.3.cmml" type="integer" xref="S2.SS1.p1.12.m12.4.4.3.3.2.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.12.m12.4.4.3.3.3.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.12.m12.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.3.2">𝐿</ci><apply id="S2.SS1.p1.12.m12.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3"><plus id="S2.SS1.p1.12.m12.4.4.3.3.3.3.1.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3.1"></plus><ci id="S2.SS1.p1.12.m12.4.4.3.3.3.3.2.cmml" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3.2">𝑇</ci><cn id="S2.SS1.p1.12.m12.4.4.3.3.3.3.3.cmml" type="integer" xref="S2.SS1.p1.12.m12.4.4.3.3.3.3.3">1</cn></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.4c">\langle{m^{T+1}_{1}},{m^{T+1}_{2}},\dots,{m^{T+1}_{L_{T+1}}}\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.4d">⟨ italic_m start_POSTSUPERSCRIPT italic_T + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_m start_POSTSUPERSCRIPT italic_T + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_m start_POSTSUPERSCRIPT italic_T + 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_T + 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⟩</annotation></semantics></math>, haven’t been prescribed in earlier visits.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="260" id="S2.F2.g1" src="x1.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">In the ARCI framework, the sequence of visits is firstly processed within the Temporal Paths Representation module including the Visit-Level Transformer to extract intra-visit dependencies, and the Cross-Visit Transformer to generate temporal paths based on inter-visit codes dependency. Meanwhile, the input embeddings of each visit are passed through multiple linear layers to generate multiple medical intents, and a contrastive learning objective is further utilized to refine the attention heads in the Contrasted Intents module. Lastly, the output of the Temporal Paths Representation module and the intent representations are fed to a visit-instance attention mechanism inside the Aggregation and Prediction module.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Methodology Overview</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.F2" title="Figure 2 ‣ 2.1. Problem Formulation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, the proposed method consists of
(1) <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.1.1">Temporal Paths Representation</span>, utilizing multi-level self-attention modules to generate temporal paths for enhanced embedding learning.
(2) <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.1.2">Contrasted Intents</span>, diversifying temporal paths on the same patients by linking them with different medical intents in a contrastive learning framework.
(3) <span class="ltx_text ltx_font_bold" id="S2.SS2.p1.1.3">Aggregation and Prediction</span>, employing a visit-instance attention mechanism to prioritize visits for the final prescription prediction.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Temporal Paths Representation</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In this study, we adopt a multi-level transformer-based module specifically tailored for intra- and inter-visit representation.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1. </span>Visit-Level Transformer</h4>
<div class="ltx_para" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.18">The self-attention of Transformer plays an important role in capturing dependencies among healthcare features <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib42" title="">2023a</a>; Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib11" title="">2020</a>)</cite>, and we utilize it for dependency learning between medication codes.
Firstly, the sparse input of the prescriptions is converted to a dense representation with an embedding layer in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E1" title="In 2.3.1. Visit-Level Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\textbf{m}}_{i}^{t}=\text{Embed}(\textbf{m}_{i}^{t})" class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><msubsup id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><mover accent="true" id="S2.E1.m1.1.1.3.2.2" xref="S2.E1.m1.1.1.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.1.1.3.2.2.2" xref="S2.E1.m1.1.1.3.2.2.2a.cmml">m</mtext><mo id="S2.E1.m1.1.1.3.2.2.1" xref="S2.E1.m1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.1.1.3.2.3" xref="S2.E1.m1.1.1.3.2.3.cmml">i</mi><mi id="S2.E1.m1.1.1.3.3" xref="S2.E1.m1.1.1.3.3.cmml">t</mi></msubsup><mo id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><mtext id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3a.cmml">Embed</mtext><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.2.2a.cmml">m</mtext><mi id="S2.E1.m1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.E1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><eq id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"></eq><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3">superscript</csymbol><apply id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.3">subscript</csymbol><apply id="S2.E1.m1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.3.2.2"><ci id="S2.E1.m1.1.1.3.2.2.1.cmml" xref="S2.E1.m1.1.1.3.2.2.1">^</ci><ci id="S2.E1.m1.1.1.3.2.2.2a.cmml" xref="S2.E1.m1.1.1.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.1.1.3.2.2.2.cmml" xref="S2.E1.m1.1.1.3.2.2.2">m</mtext></ci></apply><ci id="S2.E1.m1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.3.3">𝑡</ci></apply><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.3"><mtext id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3">Embed</mtext></ci><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.2">m</mtext></ci><ci id="S2.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\hat{\textbf{m}}_{i}^{t}=\text{Embed}(\textbf{m}_{i}^{t})</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">over^ start_ARG m end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = Embed ( m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS1.p1.17">where <math alttext="\hat{\textbf{m}_{i}}^{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.1.m1.1"><semantics id="S2.SS3.SSS1.p1.1.m1.1a"><msup id="S2.SS3.SSS1.p1.1.m1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS3.SSS1.p1.1.m1.1.1.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml"><msub id="S2.SS3.SSS1.p1.1.m1.1.1.2.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.1.m1.1.1.2.2.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2.2a.cmml">m</mtext><mi id="S2.SS3.SSS1.p1.1.m1.1.1.2.2.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.SS3.SSS1.p1.1.m1.1.1.2.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS1.p1.1.m1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.1.m1.1b"><apply id="S2.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2"><ci id="S2.SS3.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.1">^</ci><apply id="S2.SS3.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.2.2.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.1.m1.1.1.2.2.2a.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.1.m1.1.1.2.2.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2.2">m</mtext></ci><ci id="S2.SS3.SSS1.p1.1.m1.1.1.2.2.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.2.3">𝑖</ci></apply></apply><ci id="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.1.m1.1c">\hat{\textbf{m}_{i}}^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.1.m1.1d">over^ start_ARG m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.2.m2.1"><semantics id="S2.SS3.SSS1.p1.2.m2.1a"><mrow id="S2.SS3.SSS1.p1.2.m2.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.cmml"><mi id="S2.SS3.SSS1.p1.2.m2.1.1.2" xref="S2.SS3.SSS1.p1.2.m2.1.1.2.cmml"></mi><mo id="S2.SS3.SSS1.p1.2.m2.1.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS1.p1.2.m2.1.1.3" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.2.m2.1.1.3.2" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS3.SSS1.p1.2.m2.1.1.3.3" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.2.m2.1b"><apply id="S2.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1"><in id="S2.SS3.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.2">absent</csymbol><apply id="S2.SS3.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S2.SS3.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.2.m2.1c">\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.2.m2.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the embedding of prescription <math alttext="i" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.3.m3.1"><semantics id="S2.SS3.SSS1.p1.3.m3.1a"><mi id="S2.SS3.SSS1.p1.3.m3.1.1" xref="S2.SS3.SSS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.3.m3.1b"><ci id="S2.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.3.m3.1d">italic_i</annotation></semantics></math> at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.4.m4.1"><semantics id="S2.SS3.SSS1.p1.4.m4.1a"><mi id="S2.SS3.SSS1.p1.4.m4.1.1" xref="S2.SS3.SSS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.4.m4.1b"><ci id="S2.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.4.m4.1d">italic_t</annotation></semantics></math>, <math alttext="d" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.5.m5.1"><semantics id="S2.SS3.SSS1.p1.5.m5.1a"><mi id="S2.SS3.SSS1.p1.5.m5.1.1" xref="S2.SS3.SSS1.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.5.m5.1b"><ci id="S2.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.5.m5.1d">italic_d</annotation></semantics></math> is the embedding size, and <math alttext="\textbf{P}_{t}=\langle{\hat{\textbf{m}}_{1}}^{t},{\hat{\textbf{m}}_{2}}^{t},..%
.,{\hat{\textbf{m}}_{L}}^{t}\rangle" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.6.m6.4"><semantics id="S2.SS3.SSS1.p1.6.m6.4a"><mrow id="S2.SS3.SSS1.p1.6.m6.4.4" xref="S2.SS3.SSS1.p1.6.m6.4.4.cmml"><msub id="S2.SS3.SSS1.p1.6.m6.4.4.5" xref="S2.SS3.SSS1.p1.6.m6.4.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.4.4.5.2" xref="S2.SS3.SSS1.p1.6.m6.4.4.5.2a.cmml">P</mtext><mi id="S2.SS3.SSS1.p1.6.m6.4.4.5.3" xref="S2.SS3.SSS1.p1.6.m6.4.4.5.3.cmml">t</mi></msub><mo id="S2.SS3.SSS1.p1.6.m6.4.4.4" xref="S2.SS3.SSS1.p1.6.m6.4.4.4.cmml">=</mo><mrow id="S2.SS3.SSS1.p1.6.m6.4.4.3.3" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.4.cmml"><mo id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.4" stretchy="false" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.4.cmml">⟨</mo><mmultiscripts id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.cmml"><mover accent="true" id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.2" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.2a.cmml">m</mtext><mo id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.1" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.3" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.3.cmml">1</mn><mrow id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1a" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.cmml"></mrow><mrow id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1b" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.cmml"></mrow><mi id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.3" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.3.cmml">t</mi></mmultiscripts><mo id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.5" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.4.cmml">,</mo><mmultiscripts id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.cmml"><mover accent="true" id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.2" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.2a.cmml">m</mtext><mo id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.1" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.3" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.3.cmml">2</mn><mrow id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2a" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.cmml"></mrow><mrow id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2b" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.cmml"></mrow><mi id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.3" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.3.cmml">t</mi></mmultiscripts><mo id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.6" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.4.cmml">,</mo><mi id="S2.SS3.SSS1.p1.6.m6.1.1" mathvariant="normal" xref="S2.SS3.SSS1.p1.6.m6.1.1.cmml">…</mi><mo id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.7" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.4.cmml">,</mo><mmultiscripts id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.cmml"><mover accent="true" id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.2" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.2a.cmml">m</mtext><mo id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.1" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.3" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.3.cmml">L</mi><mrow id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3a" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.cmml"></mrow><mrow id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3b" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.cmml"></mrow><mi id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.3" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.3.cmml">t</mi></mmultiscripts><mo id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.8" stretchy="false" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.4.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.6.m6.4b"><apply id="S2.SS3.SSS1.p1.6.m6.4.4.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4"><eq id="S2.SS3.SSS1.p1.6.m6.4.4.4.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.4"></eq><apply id="S2.SS3.SSS1.p1.6.m6.4.4.5.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.5"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.4.4.5.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.5">subscript</csymbol><ci id="S2.SS3.SSS1.p1.6.m6.4.4.5.2a.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.5.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.4.4.5.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.5.2">P</mtext></ci><ci id="S2.SS3.SSS1.p1.6.m6.4.4.5.3.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.5.3">𝑡</ci></apply><list id="S2.SS3.SSS1.p1.6.m6.4.4.3.4.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3"><apply id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1">superscript</csymbol><apply id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2"><ci id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.2a.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.2.2">m</mtext></ci></apply><cn id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.2.3">1</cn></apply><ci id="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.6.m6.2.2.1.1.1.3">𝑡</ci></apply><apply id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2">superscript</csymbol><apply id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2">subscript</csymbol><apply id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2"><ci id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.1">^</ci><ci id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.2a.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.2.2">m</mtext></ci></apply><cn id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.6.m6.3.3.2.2.2.3">𝑡</ci></apply><ci id="S2.SS3.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.1.1">…</ci><apply id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3">superscript</csymbol><apply id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3">subscript</csymbol><apply id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2"><ci id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.1">^</ci><ci id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.2a.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.2.2">m</mtext></ci></apply><ci id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.3.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.2.3">𝐿</ci></apply><ci id="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.3.cmml" xref="S2.SS3.SSS1.p1.6.m6.4.4.3.3.3.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.6.m6.4c">\textbf{P}_{t}=\langle{\hat{\textbf{m}}_{1}}^{t},{\hat{\textbf{m}}_{2}}^{t},..%
.,{\hat{\textbf{m}}_{L}}^{t}\rangle</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.6.m6.4d">P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ⟨ over^ start_ARG m end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , over^ start_ARG m end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , … , over^ start_ARG m end_ARG start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ⟩</annotation></semantics></math> <math alttext="\in\mathbb{R}^{B\times L_{B}\times d}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.7.m7.1"><semantics id="S2.SS3.SSS1.p1.7.m7.1a"><mrow id="S2.SS3.SSS1.p1.7.m7.1.1" xref="S2.SS3.SSS1.p1.7.m7.1.1.cmml"><mi id="S2.SS3.SSS1.p1.7.m7.1.1.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.2.cmml"></mi><mo id="S2.SS3.SSS1.p1.7.m7.1.1.1" xref="S2.SS3.SSS1.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS1.p1.7.m7.1.1.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS1.p1.7.m7.1.1.3.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.cmml"><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2.cmml">B</mi><mo id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1.cmml">×</mo><msub id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.cmml"><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.2.cmml">L</mi><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.3.cmml">B</mi></msub><mo id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.7.m7.1b"><apply id="S2.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1"><in id="S2.SS3.SSS1.p1.7.m7.1.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.SSS1.p1.7.m7.1.1.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.2">absent</csymbol><apply id="S2.SS3.SSS1.p1.7.m7.1.1.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.7.m7.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3"><times id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.1"></times><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.2">𝐵</ci><apply id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.2">𝐿</ci><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.3.3">𝐵</ci></apply><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.7.m7.1c">\in\mathbb{R}^{B\times L_{B}\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.7.m7.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\textbf{P}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.8.m8.1"><semantics id="S2.SS3.SSS1.p1.8.m8.1a"><msub id="S2.SS3.SSS1.p1.8.m8.1.1" xref="S2.SS3.SSS1.p1.8.m8.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.8.m8.1.1.2" xref="S2.SS3.SSS1.p1.8.m8.1.1.2a.cmml">P</mtext><mi id="S2.SS3.SSS1.p1.8.m8.1.1.3" xref="S2.SS3.SSS1.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.8.m8.1b"><apply id="S2.SS3.SSS1.p1.8.m8.1.1.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.8.m8.1.1.1.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.8.m8.1.1.2a.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.8.m8.1.1.2.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.2">P</mtext></ci><ci id="S2.SS3.SSS1.p1.8.m8.1.1.3.cmml" xref="S2.SS3.SSS1.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.8.m8.1c">\textbf{P}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.8.m8.1d">P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the embeddings of prescription codes inside a visit at time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.9.m9.1"><semantics id="S2.SS3.SSS1.p1.9.m9.1a"><mi id="S2.SS3.SSS1.p1.9.m9.1.1" xref="S2.SS3.SSS1.p1.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.9.m9.1b"><ci id="S2.SS3.SSS1.p1.9.m9.1.1.cmml" xref="S2.SS3.SSS1.p1.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.9.m9.1d">italic_t</annotation></semantics></math>, <math alttext="B" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.10.m10.1"><semantics id="S2.SS3.SSS1.p1.10.m10.1a"><mi id="S2.SS3.SSS1.p1.10.m10.1.1" xref="S2.SS3.SSS1.p1.10.m10.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.10.m10.1b"><ci id="S2.SS3.SSS1.p1.10.m10.1.1.cmml" xref="S2.SS3.SSS1.p1.10.m10.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.10.m10.1c">B</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.10.m10.1d">italic_B</annotation></semantics></math> is the batch size, <math alttext="L_{B}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.11.m11.1"><semantics id="S2.SS3.SSS1.p1.11.m11.1a"><msub id="S2.SS3.SSS1.p1.11.m11.1.1" xref="S2.SS3.SSS1.p1.11.m11.1.1.cmml"><mi id="S2.SS3.SSS1.p1.11.m11.1.1.2" xref="S2.SS3.SSS1.p1.11.m11.1.1.2.cmml">L</mi><mi id="S2.SS3.SSS1.p1.11.m11.1.1.3" xref="S2.SS3.SSS1.p1.11.m11.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.11.m11.1b"><apply id="S2.SS3.SSS1.p1.11.m11.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m11.1.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.11.m11.1.1.2.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.2">𝐿</ci><ci id="S2.SS3.SSS1.p1.11.m11.1.1.3.cmml" xref="S2.SS3.SSS1.p1.11.m11.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.11.m11.1c">L_{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.11.m11.1d">italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> is the maximum number of prescription codes within visits in the batch, and <math alttext="d" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.12.m12.1"><semantics id="S2.SS3.SSS1.p1.12.m12.1a"><mi id="S2.SS3.SSS1.p1.12.m12.1.1" xref="S2.SS3.SSS1.p1.12.m12.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.12.m12.1b"><ci id="S2.SS3.SSS1.p1.12.m12.1.1.cmml" xref="S2.SS3.SSS1.p1.12.m12.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.12.m12.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.12.m12.1d">italic_d</annotation></semantics></math> is the embedding size.
Next, the embeddings are fed into the self-attention encoder <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib31" title="">2017</a>)</cite>, which focuses on extracting dependencies between prescription codes within the same visits as shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E2" title="In 2.3.1. Visit-Level Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, where <math alttext="\textbf{E}^{j}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.13.m13.1"><semantics id="S2.SS3.SSS1.p1.13.m13.1a"><msubsup id="S2.SS3.SSS1.p1.13.m13.1.1" xref="S2.SS3.SSS1.p1.13.m13.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.13.m13.1.1.2.2" xref="S2.SS3.SSS1.p1.13.m13.1.1.2.2a.cmml">E</mtext><mi id="S2.SS3.SSS1.p1.13.m13.1.1.3" xref="S2.SS3.SSS1.p1.13.m13.1.1.3.cmml">t</mi><mi id="S2.SS3.SSS1.p1.13.m13.1.1.2.3" xref="S2.SS3.SSS1.p1.13.m13.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.13.m13.1b"><apply id="S2.SS3.SSS1.p1.13.m13.1.1.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.13.m13.1.1.1.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1">subscript</csymbol><apply id="S2.SS3.SSS1.p1.13.m13.1.1.2.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.13.m13.1.1.2.1.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1">superscript</csymbol><ci id="S2.SS3.SSS1.p1.13.m13.1.1.2.2a.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p1.13.m13.1.1.2.2.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1.2.2">E</mtext></ci><ci id="S2.SS3.SSS1.p1.13.m13.1.1.2.3.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS1.p1.13.m13.1.1.3.cmml" xref="S2.SS3.SSS1.p1.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.13.m13.1c">\textbf{E}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.13.m13.1d">E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\in\mathbb{R}^{B\times L_{B}\times d/J}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.14.m14.1"><semantics id="S2.SS3.SSS1.p1.14.m14.1a"><mrow id="S2.SS3.SSS1.p1.14.m14.1.1" xref="S2.SS3.SSS1.p1.14.m14.1.1.cmml"><mi id="S2.SS3.SSS1.p1.14.m14.1.1.2" xref="S2.SS3.SSS1.p1.14.m14.1.1.2.cmml"></mi><mo id="S2.SS3.SSS1.p1.14.m14.1.1.1" xref="S2.SS3.SSS1.p1.14.m14.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS1.p1.14.m14.1.1.3" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.14.m14.1.1.3.2" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS1.p1.14.m14.1.1.3.3" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.cmml"><mrow id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.cmml"><mi id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.2" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.2.cmml">B</mi><mo id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.1.cmml">×</mo><msub id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.cmml"><mi id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.2" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.2.cmml">L</mi><mi id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.3" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.3.cmml">B</mi></msub><mo id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.4" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.4.cmml">d</mi></mrow><mo id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.1" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.1.cmml">/</mo><mi id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.3" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.14.m14.1b"><apply id="S2.SS3.SSS1.p1.14.m14.1.1.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1"><in id="S2.SS3.SSS1.p1.14.m14.1.1.1.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.SSS1.p1.14.m14.1.1.2.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.2">absent</csymbol><apply id="S2.SS3.SSS1.p1.14.m14.1.1.3.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.14.m14.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS1.p1.14.m14.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3"><divide id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.1.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.1"></divide><apply id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2"><times id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.1.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.1"></times><ci id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.2.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.2">𝐵</ci><apply id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.1.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.2.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.2">𝐿</ci><ci id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.3.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.3.3">𝐵</ci></apply><ci id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.4.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.2.4">𝑑</ci></apply><ci id="S2.SS3.SSS1.p1.14.m14.1.1.3.3.3.cmml" xref="S2.SS3.SSS1.p1.14.m14.1.1.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.14.m14.1c">\in\mathbb{R}^{B\times L_{B}\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.14.m14.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math> represents the visit-level embedding at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.15.m15.1"><semantics id="S2.SS3.SSS1.p1.15.m15.1a"><mi id="S2.SS3.SSS1.p1.15.m15.1.1" xref="S2.SS3.SSS1.p1.15.m15.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.15.m15.1b"><ci id="S2.SS3.SSS1.p1.15.m15.1.1.cmml" xref="S2.SS3.SSS1.p1.15.m15.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.15.m15.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.15.m15.1d">italic_t</annotation></semantics></math> and in <math alttext="j" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.16.m16.1"><semantics id="S2.SS3.SSS1.p1.16.m16.1a"><mi id="S2.SS3.SSS1.p1.16.m16.1.1" xref="S2.SS3.SSS1.p1.16.m16.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.16.m16.1b"><ci id="S2.SS3.SSS1.p1.16.m16.1.1.cmml" xref="S2.SS3.SSS1.p1.16.m16.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.16.m16.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.16.m16.1d">italic_j</annotation></semantics></math>-th head where <math alttext="J" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.17.m17.1"><semantics id="S2.SS3.SSS1.p1.17.m17.1a"><mi id="S2.SS3.SSS1.p1.17.m17.1.1" xref="S2.SS3.SSS1.p1.17.m17.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.17.m17.1b"><ci id="S2.SS3.SSS1.p1.17.m17.1.1.cmml" xref="S2.SS3.SSS1.p1.17.m17.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.17.m17.1c">J</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.17.m17.1d">italic_J</annotation></semantics></math> equals to total number of heads.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{E}^{j}_{t}=\text{Self-Att}_{j}(\textbf{P}_{t})" class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msubsup id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.3.2.2" xref="S2.E2.m1.1.1.3.2.2a.cmml">E</mtext><mi id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">t</mi><mi id="S2.E2.m1.1.1.3.2.3" xref="S2.E2.m1.1.1.3.2.3.cmml">j</mi></msubsup><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml"><mtext id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.3.2a.cmml">Self-Att</mtext><mi id="S2.E2.m1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.3.3.cmml">j</mi></msub><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2a.cmml">P</mtext><mi id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></eq><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><apply id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.1.1.3.2.2a.cmml" xref="S2.E2.m1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.3.2.2">E</mtext></ci><ci id="S2.E2.m1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.3.2.3">𝑗</ci></apply><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">𝑡</ci></apply><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.3.2a.cmml" xref="S2.E2.m1.1.1.1.3.2"><mtext id="S2.E2.m1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.3.2">Self-Att</mtext></ci><ci id="S2.E2.m1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.3.3">𝑗</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2a.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">P</mtext></ci><ci id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\textbf{E}^{j}_{t}=\text{Self-Att}_{j}(\textbf{P}_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = Self-Att start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.SSS1.p2">
<p class="ltx_p" id="S2.SS3.SSS1.p2.2">Additionally, the sequence of the embeddings for a single patient for a specific head is <math alttext="{\textbf{E}^{j}}=\langle\textbf{E}^{j}_{1},\textbf{E}^{j}_{2},\dots,\textbf{E}%
^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times L_{B}\times d/J}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.1.m1.4"><semantics id="S2.SS3.SSS1.p2.1.m1.4a"><mrow id="S2.SS3.SSS1.p2.1.m1.4.4" xref="S2.SS3.SSS1.p2.1.m1.4.4.cmml"><msup id="S2.SS3.SSS1.p2.1.m1.4.4.5" xref="S2.SS3.SSS1.p2.1.m1.4.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.4.4.5.2" xref="S2.SS3.SSS1.p2.1.m1.4.4.5.2a.cmml">E</mtext><mi id="S2.SS3.SSS1.p2.1.m1.4.4.5.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.5.3.cmml">j</mi></msup><mo id="S2.SS3.SSS1.p2.1.m1.4.4.6" xref="S2.SS3.SSS1.p2.1.m1.4.4.6.cmml">=</mo><mrow id="S2.SS3.SSS1.p2.1.m1.4.4.3.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.4.cmml"><mo id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">⟨</mo><msubsup id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.2" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.2a.cmml">E</mtext><mn id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.3" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn><mi id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.3" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.5" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.2" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.2a.cmml">E</mtext><mn id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.3" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.3" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.6" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS3.SSS1.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS3.SSS1.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.7" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.2" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.2a.cmml">E</mtext><mi id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.3.cmml">T</mi><mi id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">⟩</mo></mrow><mo id="S2.SS3.SSS1.p2.1.m1.4.4.7" xref="S2.SS3.SSS1.p2.1.m1.4.4.7.cmml">∈</mo><msup id="S2.SS3.SSS1.p2.1.m1.4.4.8" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.cmml"><mi id="S2.SS3.SSS1.p2.1.m1.4.4.8.2" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS1.p2.1.m1.4.4.8.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.cmml"><mrow id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.cmml"><mi id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.2" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.2.cmml">B</mi><mo id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.3.cmml">T</mi><mo id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1.cmml">×</mo><msub id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.cmml"><mi id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.2" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.2.cmml">L</mi><mi id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.3.cmml">B</mi></msub><mo id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.5" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.5.cmml">d</mi></mrow><mo id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.1" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.1.cmml">/</mo><mi id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.3" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.1.m1.4b"><apply id="S2.SS3.SSS1.p2.1.m1.4.4.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4"><and id="S2.SS3.SSS1.p2.1.m1.4.4a.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4"></and><apply id="S2.SS3.SSS1.p2.1.m1.4.4b.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4"><eq id="S2.SS3.SSS1.p2.1.m1.4.4.6.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.6"></eq><apply id="S2.SS3.SSS1.p2.1.m1.4.4.5.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.5"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.4.4.5.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.5">superscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.4.4.5.2a.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.5.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.4.4.5.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.5.2">E</mtext></ci><ci id="S2.SS3.SSS1.p2.1.m1.4.4.5.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.5.3">𝑗</ci></apply><list id="S2.SS3.SSS1.p2.1.m1.4.4.3.4.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3"><apply id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.2a.cmml" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.2">E</mtext></ci><ci id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS1.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.2a.cmml" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.2">E</mtext></ci><ci id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS1.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1">…</ci><apply id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.2a.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.2">E</mtext></ci><ci id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.3.3.3.3">𝑇</ci></apply></list></apply><apply id="S2.SS3.SSS1.p2.1.m1.4.4c.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4"><in id="S2.SS3.SSS1.p2.1.m1.4.4.7.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.7"></in><share href="https://arxiv.org/html/2408.10259v1#S2.SS3.SSS1.p2.1.m1.4.4.3.cmml" id="S2.SS3.SSS1.p2.1.m1.4.4d.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4"></share><apply id="S2.SS3.SSS1.p2.1.m1.4.4.8.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.4.4.8.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8">superscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.4.4.8.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.2">ℝ</ci><apply id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3"><divide id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.1"></divide><apply id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2"><times id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.1"></times><ci id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.2">𝐵</ci><ci id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.3">𝑇</ci><apply id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4">subscript</csymbol><ci id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.2.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.2">𝐿</ci><ci id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.4.3">𝐵</ci></apply><ci id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.5.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.2.5">𝑑</ci></apply><ci id="S2.SS3.SSS1.p2.1.m1.4.4.8.3.3.cmml" xref="S2.SS3.SSS1.p2.1.m1.4.4.8.3.3">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.1.m1.4c">{\textbf{E}^{j}}=\langle\textbf{E}^{j}_{1},\textbf{E}^{j}_{2},\dots,\textbf{E}%
^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times L_{B}\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.1.m1.4d">E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT = ⟨ E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ⟩ ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_T × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="T" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p2.2.m2.1"><semantics id="S2.SS3.SSS1.p2.2.m2.1a"><mi id="S2.SS3.SSS1.p2.2.m2.1.1" xref="S2.SS3.SSS1.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.2.m2.1b"><ci id="S2.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p2.2.m2.1d">italic_T</annotation></semantics></math> is the total number of time steps.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2. </span>Cross-Visit Transformer</h4>
<div class="ltx_para" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.2">While the aforementioned approach enhances the prescription embedding within each single visit, it cannot fully address the cross-visit dependency learning between the codes in the consecutive time steps. Recognizing the significance of these dependencies is crucial for monitoring prescription changes over time and capturing the progression of specific conditions. Consequently, we propose a novel attention-based approach that is able to generate temporal paths over prescriptions in consecutive time steps, enabling the sharing of information between medical codes at consecutive time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.1.m1.1"><semantics id="S2.SS3.SSS2.p1.1.m1.1a"><mi id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.1b"><ci id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.1.m1.1d">italic_t</annotation></semantics></math> and <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.2.m2.1"><semantics id="S2.SS3.SSS2.p1.2.m2.1a"><mrow id="S2.SS3.SSS2.p1.2.m2.1.1" xref="S2.SS3.SSS2.p1.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p1.2.m2.1.1.2" xref="S2.SS3.SSS2.p1.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p1.2.m2.1.1.1" xref="S2.SS3.SSS2.p1.2.m2.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p1.2.m2.1.1.3" xref="S2.SS3.SSS2.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.2.m2.1b"><apply id="S2.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1"><plus id="S2.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1.1"></plus><ci id="S2.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.2.m2.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.2.m2.1d">italic_t + 1</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p2">
<p class="ltx_p" id="S2.SS3.SSS2.p2.18">Self-attention generates three matrices, known as Query, Key, and Value. The first two matrices, Query and Key, are employed to construct the attention relationships between two information entities. In our study, to capture temporal paths by extracting dependencies between consecutive time steps, we adopt a new Transformer encoder where the Query is obtained from time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.1.m1.1"><semantics id="S2.SS3.SSS2.p2.1.m1.1a"><mi id="S2.SS3.SSS2.p2.1.m1.1.1" xref="S2.SS3.SSS2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.1.m1.1b"><ci id="S2.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.1.m1.1d">italic_t</annotation></semantics></math>, while the Key is obtained from <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.2.m2.1"><semantics id="S2.SS3.SSS2.p2.2.m2.1a"><mrow id="S2.SS3.SSS2.p2.2.m2.1.1" xref="S2.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p2.2.m2.1.1.2" xref="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p2.2.m2.1.1.1" xref="S2.SS3.SSS2.p2.2.m2.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p2.2.m2.1.1.3" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.2.m2.1b"><apply id="S2.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1"><plus id="S2.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.1"></plus><ci id="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.2.m2.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.2.m2.1d">italic_t + 1</annotation></semantics></math> to reflect the effect of the outgoing attention and dependency from medications at <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.3.m3.1"><semantics id="S2.SS3.SSS2.p2.3.m3.1a"><mi id="S2.SS3.SSS2.p2.3.m3.1.1" xref="S2.SS3.SSS2.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.3.m3.1b"><ci id="S2.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.3.m3.1d">italic_t</annotation></semantics></math> to medications at <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.4.m4.1"><semantics id="S2.SS3.SSS2.p2.4.m4.1a"><mrow id="S2.SS3.SSS2.p2.4.m4.1.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p2.4.m4.1.1.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p2.4.m4.1.1.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p2.4.m4.1.1.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.4.m4.1b"><apply id="S2.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1"><plus id="S2.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.1"></plus><ci id="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.4.m4.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.4.m4.1d">italic_t + 1</annotation></semantics></math>. In the formulation, the output of the visit-level code embeddings <math alttext="\textbf{E}^{j}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.5.m5.1"><semantics id="S2.SS3.SSS2.p2.5.m5.1a"><msubsup id="S2.SS3.SSS2.p2.5.m5.1.1" xref="S2.SS3.SSS2.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.5.m5.1.1.2.2" xref="S2.SS3.SSS2.p2.5.m5.1.1.2.2a.cmml">E</mtext><mi id="S2.SS3.SSS2.p2.5.m5.1.1.3" xref="S2.SS3.SSS2.p2.5.m5.1.1.3.cmml">t</mi><mi id="S2.SS3.SSS2.p2.5.m5.1.1.2.3" xref="S2.SS3.SSS2.p2.5.m5.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.5.m5.1b"><apply id="S2.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.5.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.5.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.5.m5.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p2.5.m5.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.5.m5.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1.2.2">E</mtext></ci><ci id="S2.SS3.SSS2.p2.5.m5.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS2.p2.5.m5.1.1.3.cmml" xref="S2.SS3.SSS2.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.5.m5.1c">\textbf{E}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.5.m5.1d">E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> through each head <math alttext="j" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.6.m6.1"><semantics id="S2.SS3.SSS2.p2.6.m6.1a"><mi id="S2.SS3.SSS2.p2.6.m6.1.1" xref="S2.SS3.SSS2.p2.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.6.m6.1b"><ci id="S2.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p2.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.6.m6.1d">italic_j</annotation></semantics></math> is initially concatenated through <math alttext="[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.7.m7.3"><semantics id="S2.SS3.SSS2.p2.7.m7.3a"><mrow id="S2.SS3.SSS2.p2.7.m7.3.3.2" xref="S2.SS3.SSS2.p2.7.m7.3.3.3.cmml"><mo id="S2.SS3.SSS2.p2.7.m7.3.3.2.3" stretchy="false" xref="S2.SS3.SSS2.p2.7.m7.3.3.3.cmml">[</mo><msubsup id="S2.SS3.SSS2.p2.7.m7.2.2.1.1" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.2" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.2a.cmml">E</mtext><mi id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.3" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.3.cmml">t</mi><mn id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.3" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.3.cmml">1</mn></msubsup><mo id="S2.SS3.SSS2.p2.7.m7.3.3.2.4" xref="S2.SS3.SSS2.p2.7.m7.3.3.3.cmml">,</mo><mi id="S2.SS3.SSS2.p2.7.m7.1.1" mathvariant="normal" xref="S2.SS3.SSS2.p2.7.m7.1.1.cmml">…</mi><mo id="S2.SS3.SSS2.p2.7.m7.3.3.2.5" xref="S2.SS3.SSS2.p2.7.m7.3.3.3.cmml">,</mo><msubsup id="S2.SS3.SSS2.p2.7.m7.3.3.2.2" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.2" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.2a.cmml">E</mtext><mi id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.3" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.3.cmml">t</mi><mi id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.3" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.3.cmml">J</mi></msubsup><mo id="S2.SS3.SSS2.p2.7.m7.3.3.2.6" stretchy="false" xref="S2.SS3.SSS2.p2.7.m7.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.7.m7.3b"><list id="S2.SS3.SSS2.p2.7.m7.3.3.3.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2"><apply id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.2">E</mtext></ci><cn id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.3.cmml" type="integer" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.2.3">1</cn></apply><ci id="S2.SS3.SSS2.p2.7.m7.2.2.1.1.3.cmml" xref="S2.SS3.SSS2.p2.7.m7.2.2.1.1.3">𝑡</ci></apply><ci id="S2.SS3.SSS2.p2.7.m7.1.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.1.1">…</ci><apply id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2">subscript</csymbol><apply id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2">superscript</csymbol><ci id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.2a.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.2">E</mtext></ci><ci id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.3.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.2.3">𝐽</ci></apply><ci id="S2.SS3.SSS2.p2.7.m7.3.3.2.2.3.cmml" xref="S2.SS3.SSS2.p2.7.m7.3.3.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.7.m7.3c">[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.7.m7.3d">[ E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , … , E start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> <math alttext="\in\mathbb{R}^{B\times L_{B}\times d}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.8.m8.1"><semantics id="S2.SS3.SSS2.p2.8.m8.1a"><mrow id="S2.SS3.SSS2.p2.8.m8.1.1" xref="S2.SS3.SSS2.p2.8.m8.1.1.cmml"><mi id="S2.SS3.SSS2.p2.8.m8.1.1.2" xref="S2.SS3.SSS2.p2.8.m8.1.1.2.cmml"></mi><mo id="S2.SS3.SSS2.p2.8.m8.1.1.1" xref="S2.SS3.SSS2.p2.8.m8.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS2.p2.8.m8.1.1.3" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.cmml"><mi id="S2.SS3.SSS2.p2.8.m8.1.1.3.2" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p2.8.m8.1.1.3.3" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.cmml"><mi id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.2" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.2.cmml">B</mi><mo id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.1.cmml">×</mo><msub id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.cmml"><mi id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.2" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.2.cmml">L</mi><mi id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.3" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.3.cmml">B</mi></msub><mo id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.4" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.8.m8.1b"><apply id="S2.SS3.SSS2.p2.8.m8.1.1.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1"><in id="S2.SS3.SSS2.p2.8.m8.1.1.1.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.SSS2.p2.8.m8.1.1.2.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.2">absent</csymbol><apply id="S2.SS3.SSS2.p2.8.m8.1.1.3.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.8.m8.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS2.p2.8.m8.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3"><times id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.1.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.1"></times><ci id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.2.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.2">𝐵</ci><apply id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.1.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.2.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.2">𝐿</ci><ci id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.3.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.3.3">𝐵</ci></apply><ci id="S2.SS3.SSS2.p2.8.m8.1.1.3.3.4.cmml" xref="S2.SS3.SSS2.p2.8.m8.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.8.m8.1c">\in\mathbb{R}^{B\times L_{B}\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.8.m8.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, then the matrices <math alttext="\hat{\textbf{Q}}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.9.m9.1"><semantics id="S2.SS3.SSS2.p2.9.m9.1a"><msub id="S2.SS3.SSS2.p2.9.m9.1.1" xref="S2.SS3.SSS2.p2.9.m9.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p2.9.m9.1.1.2" xref="S2.SS3.SSS2.p2.9.m9.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.9.m9.1.1.2.2" xref="S2.SS3.SSS2.p2.9.m9.1.1.2.2a.cmml">Q</mtext><mo id="S2.SS3.SSS2.p2.9.m9.1.1.2.1" xref="S2.SS3.SSS2.p2.9.m9.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p2.9.m9.1.1.3" xref="S2.SS3.SSS2.p2.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.9.m9.1b"><apply id="S2.SS3.SSS2.p2.9.m9.1.1.cmml" xref="S2.SS3.SSS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.9.m9.1.1.1.cmml" xref="S2.SS3.SSS2.p2.9.m9.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.9.m9.1.1.2.cmml" xref="S2.SS3.SSS2.p2.9.m9.1.1.2"><ci id="S2.SS3.SSS2.p2.9.m9.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.9.m9.1.1.2.1">^</ci><ci id="S2.SS3.SSS2.p2.9.m9.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.9.m9.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.9.m9.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.9.m9.1.1.2.2">Q</mtext></ci></apply><ci id="S2.SS3.SSS2.p2.9.m9.1.1.3.cmml" xref="S2.SS3.SSS2.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.9.m9.1c">\hat{\textbf{Q}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.9.m9.1d">over^ start_ARG Q end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\hat{\textbf{K}}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.10.m10.1"><semantics id="S2.SS3.SSS2.p2.10.m10.1a"><msub id="S2.SS3.SSS2.p2.10.m10.1.1" xref="S2.SS3.SSS2.p2.10.m10.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p2.10.m10.1.1.2" xref="S2.SS3.SSS2.p2.10.m10.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.10.m10.1.1.2.2" xref="S2.SS3.SSS2.p2.10.m10.1.1.2.2a.cmml">K</mtext><mo id="S2.SS3.SSS2.p2.10.m10.1.1.2.1" xref="S2.SS3.SSS2.p2.10.m10.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p2.10.m10.1.1.3" xref="S2.SS3.SSS2.p2.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.10.m10.1b"><apply id="S2.SS3.SSS2.p2.10.m10.1.1.cmml" xref="S2.SS3.SSS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.10.m10.1.1.1.cmml" xref="S2.SS3.SSS2.p2.10.m10.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.10.m10.1.1.2.cmml" xref="S2.SS3.SSS2.p2.10.m10.1.1.2"><ci id="S2.SS3.SSS2.p2.10.m10.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.10.m10.1.1.2.1">^</ci><ci id="S2.SS3.SSS2.p2.10.m10.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.10.m10.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.10.m10.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.10.m10.1.1.2.2">K</mtext></ci></apply><ci id="S2.SS3.SSS2.p2.10.m10.1.1.3.cmml" xref="S2.SS3.SSS2.p2.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.10.m10.1c">\hat{\textbf{K}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.10.m10.1d">over^ start_ARG K end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\hat{\textbf{V}}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.11.m11.1"><semantics id="S2.SS3.SSS2.p2.11.m11.1a"><msub id="S2.SS3.SSS2.p2.11.m11.1.1" xref="S2.SS3.SSS2.p2.11.m11.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p2.11.m11.1.1.2" xref="S2.SS3.SSS2.p2.11.m11.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.11.m11.1.1.2.2" xref="S2.SS3.SSS2.p2.11.m11.1.1.2.2a.cmml">V</mtext><mo id="S2.SS3.SSS2.p2.11.m11.1.1.2.1" xref="S2.SS3.SSS2.p2.11.m11.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p2.11.m11.1.1.3" xref="S2.SS3.SSS2.p2.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.11.m11.1b"><apply id="S2.SS3.SSS2.p2.11.m11.1.1.cmml" xref="S2.SS3.SSS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.11.m11.1.1.1.cmml" xref="S2.SS3.SSS2.p2.11.m11.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.11.m11.1.1.2.cmml" xref="S2.SS3.SSS2.p2.11.m11.1.1.2"><ci id="S2.SS3.SSS2.p2.11.m11.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.11.m11.1.1.2.1">^</ci><ci id="S2.SS3.SSS2.p2.11.m11.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.11.m11.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.11.m11.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.11.m11.1.1.2.2">V</mtext></ci></apply><ci id="S2.SS3.SSS2.p2.11.m11.1.1.3.cmml" xref="S2.SS3.SSS2.p2.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.11.m11.1c">\hat{\textbf{V}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.11.m11.1d">over^ start_ARG V end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are derived using Equations <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E3" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E4" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E5" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, where <math alttext="\hat{\textbf{W}_{q}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.12.m12.1"><semantics id="S2.SS3.SSS2.p2.12.m12.1a"><mover accent="true" id="S2.SS3.SSS2.p2.12.m12.1.1" xref="S2.SS3.SSS2.p2.12.m12.1.1.cmml"><msub id="S2.SS3.SSS2.p2.12.m12.1.1.2" xref="S2.SS3.SSS2.p2.12.m12.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.12.m12.1.1.2.2" xref="S2.SS3.SSS2.p2.12.m12.1.1.2.2a.cmml">W</mtext><mi id="S2.SS3.SSS2.p2.12.m12.1.1.2.3" xref="S2.SS3.SSS2.p2.12.m12.1.1.2.3.cmml">q</mi></msub><mo id="S2.SS3.SSS2.p2.12.m12.1.1.1" xref="S2.SS3.SSS2.p2.12.m12.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.12.m12.1b"><apply id="S2.SS3.SSS2.p2.12.m12.1.1.cmml" xref="S2.SS3.SSS2.p2.12.m12.1.1"><ci id="S2.SS3.SSS2.p2.12.m12.1.1.1.cmml" xref="S2.SS3.SSS2.p2.12.m12.1.1.1">^</ci><apply id="S2.SS3.SSS2.p2.12.m12.1.1.2.cmml" xref="S2.SS3.SSS2.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.12.m12.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.12.m12.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS2.p2.12.m12.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.12.m12.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.12.m12.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.12.m12.1.1.2.2">W</mtext></ci><ci id="S2.SS3.SSS2.p2.12.m12.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.12.m12.1.1.2.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.12.m12.1c">\hat{\textbf{W}_{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.12.m12.1d">over^ start_ARG W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, <math alttext="\hat{\textbf{W}_{k}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.13.m13.1"><semantics id="S2.SS3.SSS2.p2.13.m13.1a"><mover accent="true" id="S2.SS3.SSS2.p2.13.m13.1.1" xref="S2.SS3.SSS2.p2.13.m13.1.1.cmml"><msub id="S2.SS3.SSS2.p2.13.m13.1.1.2" xref="S2.SS3.SSS2.p2.13.m13.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.13.m13.1.1.2.2" xref="S2.SS3.SSS2.p2.13.m13.1.1.2.2a.cmml">W</mtext><mi id="S2.SS3.SSS2.p2.13.m13.1.1.2.3" xref="S2.SS3.SSS2.p2.13.m13.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS3.SSS2.p2.13.m13.1.1.1" xref="S2.SS3.SSS2.p2.13.m13.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.13.m13.1b"><apply id="S2.SS3.SSS2.p2.13.m13.1.1.cmml" xref="S2.SS3.SSS2.p2.13.m13.1.1"><ci id="S2.SS3.SSS2.p2.13.m13.1.1.1.cmml" xref="S2.SS3.SSS2.p2.13.m13.1.1.1">^</ci><apply id="S2.SS3.SSS2.p2.13.m13.1.1.2.cmml" xref="S2.SS3.SSS2.p2.13.m13.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.13.m13.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.13.m13.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS2.p2.13.m13.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.13.m13.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.13.m13.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.13.m13.1.1.2.2">W</mtext></ci><ci id="S2.SS3.SSS2.p2.13.m13.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.13.m13.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.13.m13.1c">\hat{\textbf{W}_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.13.m13.1d">over^ start_ARG W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, and <math alttext="\hat{\textbf{W}_{v}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.14.m14.1"><semantics id="S2.SS3.SSS2.p2.14.m14.1a"><mover accent="true" id="S2.SS3.SSS2.p2.14.m14.1.1" xref="S2.SS3.SSS2.p2.14.m14.1.1.cmml"><msub id="S2.SS3.SSS2.p2.14.m14.1.1.2" xref="S2.SS3.SSS2.p2.14.m14.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.14.m14.1.1.2.2" xref="S2.SS3.SSS2.p2.14.m14.1.1.2.2a.cmml">W</mtext><mi id="S2.SS3.SSS2.p2.14.m14.1.1.2.3" xref="S2.SS3.SSS2.p2.14.m14.1.1.2.3.cmml">v</mi></msub><mo id="S2.SS3.SSS2.p2.14.m14.1.1.1" xref="S2.SS3.SSS2.p2.14.m14.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.14.m14.1b"><apply id="S2.SS3.SSS2.p2.14.m14.1.1.cmml" xref="S2.SS3.SSS2.p2.14.m14.1.1"><ci id="S2.SS3.SSS2.p2.14.m14.1.1.1.cmml" xref="S2.SS3.SSS2.p2.14.m14.1.1.1">^</ci><apply id="S2.SS3.SSS2.p2.14.m14.1.1.2.cmml" xref="S2.SS3.SSS2.p2.14.m14.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.14.m14.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.14.m14.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS2.p2.14.m14.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p2.14.m14.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.14.m14.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.14.m14.1.1.2.2">W</mtext></ci><ci id="S2.SS3.SSS2.p2.14.m14.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.14.m14.1.1.2.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.14.m14.1c">\hat{\textbf{W}_{v}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.14.m14.1d">over^ start_ARG W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> <math alttext="\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.15.m15.1"><semantics id="S2.SS3.SSS2.p2.15.m15.1a"><mrow id="S2.SS3.SSS2.p2.15.m15.1.1" xref="S2.SS3.SSS2.p2.15.m15.1.1.cmml"><mi id="S2.SS3.SSS2.p2.15.m15.1.1.2" xref="S2.SS3.SSS2.p2.15.m15.1.1.2.cmml"></mi><mo id="S2.SS3.SSS2.p2.15.m15.1.1.1" xref="S2.SS3.SSS2.p2.15.m15.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS2.p2.15.m15.1.1.3" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.cmml"><mi id="S2.SS3.SSS2.p2.15.m15.1.1.3.2" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p2.15.m15.1.1.3.3" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3.cmml"><mi id="S2.SS3.SSS2.p2.15.m15.1.1.3.3.2" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3.2.cmml">d</mi><mo id="S2.SS3.SSS2.p2.15.m15.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS2.p2.15.m15.1.1.3.3.3" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.15.m15.1b"><apply id="S2.SS3.SSS2.p2.15.m15.1.1.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1"><in id="S2.SS3.SSS2.p2.15.m15.1.1.1.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.SSS2.p2.15.m15.1.1.2.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.2">absent</csymbol><apply id="S2.SS3.SSS2.p2.15.m15.1.1.3.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.15.m15.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS2.p2.15.m15.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS2.p2.15.m15.1.1.3.3.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3"><times id="S2.SS3.SSS2.p2.15.m15.1.1.3.3.1.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3.1"></times><ci id="S2.SS3.SSS2.p2.15.m15.1.1.3.3.2.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3.2">𝑑</ci><ci id="S2.SS3.SSS2.p2.15.m15.1.1.3.3.3.cmml" xref="S2.SS3.SSS2.p2.15.m15.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.15.m15.1c">\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.15.m15.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable parameters. For the self-attention operation, the attention heads are produced as <math alttext="\hat{\textbf{K}}^{j}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.16.m16.1"><semantics id="S2.SS3.SSS2.p2.16.m16.1a"><msubsup id="S2.SS3.SSS2.p2.16.m16.1.1" xref="S2.SS3.SSS2.p2.16.m16.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p2.16.m16.1.1.2.2" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.16.m16.1.1.2.2.2" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.2.2a.cmml">K</mtext><mo id="S2.SS3.SSS2.p2.16.m16.1.1.2.2.1" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p2.16.m16.1.1.3" xref="S2.SS3.SSS2.p2.16.m16.1.1.3.cmml">t</mi><mi id="S2.SS3.SSS2.p2.16.m16.1.1.2.3" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.16.m16.1b"><apply id="S2.SS3.SSS2.p2.16.m16.1.1.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.16.m16.1.1.1.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.16.m16.1.1.2.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.16.m16.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p2.16.m16.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.2"><ci id="S2.SS3.SSS2.p2.16.m16.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p2.16.m16.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.16.m16.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.2.2">K</mtext></ci></apply><ci id="S2.SS3.SSS2.p2.16.m16.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS2.p2.16.m16.1.1.3.cmml" xref="S2.SS3.SSS2.p2.16.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.16.m16.1c">\hat{\textbf{K}}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.16.m16.1d">over^ start_ARG K end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\hat{\textbf{Q}}^{j}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.17.m17.1"><semantics id="S2.SS3.SSS2.p2.17.m17.1a"><msubsup id="S2.SS3.SSS2.p2.17.m17.1.1" xref="S2.SS3.SSS2.p2.17.m17.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p2.17.m17.1.1.2.2" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.17.m17.1.1.2.2.2" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.2.2a.cmml">Q</mtext><mo id="S2.SS3.SSS2.p2.17.m17.1.1.2.2.1" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p2.17.m17.1.1.3" xref="S2.SS3.SSS2.p2.17.m17.1.1.3.cmml">t</mi><mi id="S2.SS3.SSS2.p2.17.m17.1.1.2.3" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.17.m17.1b"><apply id="S2.SS3.SSS2.p2.17.m17.1.1.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.17.m17.1.1.1.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.17.m17.1.1.2.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.17.m17.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p2.17.m17.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.2"><ci id="S2.SS3.SSS2.p2.17.m17.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p2.17.m17.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.17.m17.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.2.2">Q</mtext></ci></apply><ci id="S2.SS3.SSS2.p2.17.m17.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS2.p2.17.m17.1.1.3.cmml" xref="S2.SS3.SSS2.p2.17.m17.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.17.m17.1c">\hat{\textbf{Q}}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.17.m17.1d">over^ start_ARG Q end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\hat{\textbf{V}}^{j}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.18.m18.1"><semantics id="S2.SS3.SSS2.p2.18.m18.1a"><msubsup id="S2.SS3.SSS2.p2.18.m18.1.1" xref="S2.SS3.SSS2.p2.18.m18.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p2.18.m18.1.1.2.2" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.18.m18.1.1.2.2.2" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.2.2a.cmml">V</mtext><mo id="S2.SS3.SSS2.p2.18.m18.1.1.2.2.1" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p2.18.m18.1.1.3" xref="S2.SS3.SSS2.p2.18.m18.1.1.3.cmml">t</mi><mi id="S2.SS3.SSS2.p2.18.m18.1.1.2.3" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.18.m18.1b"><apply id="S2.SS3.SSS2.p2.18.m18.1.1.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.18.m18.1.1.1.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.18.m18.1.1.2.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.18.m18.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p2.18.m18.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.2"><ci id="S2.SS3.SSS2.p2.18.m18.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p2.18.m18.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p2.18.m18.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.2.2">V</mtext></ci></apply><ci id="S2.SS3.SSS2.p2.18.m18.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS2.p2.18.m18.1.1.3.cmml" xref="S2.SS3.SSS2.p2.18.m18.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.18.m18.1c">\hat{\textbf{V}}^{j}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.18.m18.1d">over^ start_ARG V end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\textbf{Q}}_{t}=[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]\hat{\textbf{W%
}}_{q}" class="ltx_Math" display="block" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml"><msub id="S2.E3.m1.3.3.4" xref="S2.E3.m1.3.3.4.cmml"><mover accent="true" id="S2.E3.m1.3.3.4.2" xref="S2.E3.m1.3.3.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.3.3.4.2.2" xref="S2.E3.m1.3.3.4.2.2a.cmml">Q</mtext><mo id="S2.E3.m1.3.3.4.2.1" xref="S2.E3.m1.3.3.4.2.1.cmml">^</mo></mover><mi id="S2.E3.m1.3.3.4.3" xref="S2.E3.m1.3.3.4.3.cmml">t</mi></msub><mo id="S2.E3.m1.3.3.3" xref="S2.E3.m1.3.3.3.cmml">=</mo><mrow id="S2.E3.m1.3.3.2" xref="S2.E3.m1.3.3.2.cmml"><mrow id="S2.E3.m1.3.3.2.2.2" xref="S2.E3.m1.3.3.2.2.3.cmml"><mo id="S2.E3.m1.3.3.2.2.2.3" stretchy="false" xref="S2.E3.m1.3.3.2.2.3.cmml">[</mo><msubsup id="S2.E3.m1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.2.2.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.2.2a.cmml">E</mtext><mi id="S2.E3.m1.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.3.cmml">t</mi><mn id="S2.E3.m1.2.2.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S2.E3.m1.3.3.2.2.2.4" xref="S2.E3.m1.3.3.2.2.3.cmml">,</mo><mi id="S2.E3.m1.1.1" mathvariant="normal" xref="S2.E3.m1.1.1.cmml">…</mi><mo id="S2.E3.m1.3.3.2.2.2.5" xref="S2.E3.m1.3.3.2.2.3.cmml">,</mo><msubsup id="S2.E3.m1.3.3.2.2.2.2" xref="S2.E3.m1.3.3.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.3.3.2.2.2.2.2.2" xref="S2.E3.m1.3.3.2.2.2.2.2.2a.cmml">E</mtext><mi id="S2.E3.m1.3.3.2.2.2.2.3" xref="S2.E3.m1.3.3.2.2.2.2.3.cmml">t</mi><mi id="S2.E3.m1.3.3.2.2.2.2.2.3" xref="S2.E3.m1.3.3.2.2.2.2.2.3.cmml">J</mi></msubsup><mo id="S2.E3.m1.3.3.2.2.2.6" stretchy="false" xref="S2.E3.m1.3.3.2.2.3.cmml">]</mo></mrow><mo id="S2.E3.m1.3.3.2.3" xref="S2.E3.m1.3.3.2.3.cmml">⁢</mo><msub id="S2.E3.m1.3.3.2.4" xref="S2.E3.m1.3.3.2.4.cmml"><mover accent="true" id="S2.E3.m1.3.3.2.4.2" xref="S2.E3.m1.3.3.2.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.3.3.2.4.2.2" xref="S2.E3.m1.3.3.2.4.2.2a.cmml">W</mtext><mo id="S2.E3.m1.3.3.2.4.2.1" xref="S2.E3.m1.3.3.2.4.2.1.cmml">^</mo></mover><mi id="S2.E3.m1.3.3.2.4.3" xref="S2.E3.m1.3.3.2.4.3.cmml">q</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3"><eq id="S2.E3.m1.3.3.3.cmml" xref="S2.E3.m1.3.3.3"></eq><apply id="S2.E3.m1.3.3.4.cmml" xref="S2.E3.m1.3.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.4.1.cmml" xref="S2.E3.m1.3.3.4">subscript</csymbol><apply id="S2.E3.m1.3.3.4.2.cmml" xref="S2.E3.m1.3.3.4.2"><ci id="S2.E3.m1.3.3.4.2.1.cmml" xref="S2.E3.m1.3.3.4.2.1">^</ci><ci id="S2.E3.m1.3.3.4.2.2a.cmml" xref="S2.E3.m1.3.3.4.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.3.3.4.2.2.cmml" xref="S2.E3.m1.3.3.4.2.2">Q</mtext></ci></apply><ci id="S2.E3.m1.3.3.4.3.cmml" xref="S2.E3.m1.3.3.4.3">𝑡</ci></apply><apply id="S2.E3.m1.3.3.2.cmml" xref="S2.E3.m1.3.3.2"><times id="S2.E3.m1.3.3.2.3.cmml" xref="S2.E3.m1.3.3.2.3"></times><list id="S2.E3.m1.3.3.2.2.3.cmml" xref="S2.E3.m1.3.3.2.2.2"><apply id="S2.E3.m1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.2.2a.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.2">E</mtext></ci><cn id="S2.E3.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S2.E3.m1.2.2.1.1.1.1.2.3">1</cn></apply><ci id="S2.E3.m1.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">…</ci><apply id="S2.E3.m1.3.3.2.2.2.2.cmml" xref="S2.E3.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.2.2.2.2.1.cmml" xref="S2.E3.m1.3.3.2.2.2.2">subscript</csymbol><apply id="S2.E3.m1.3.3.2.2.2.2.2.cmml" xref="S2.E3.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.2.2.2.2.2.1.cmml" xref="S2.E3.m1.3.3.2.2.2.2">superscript</csymbol><ci id="S2.E3.m1.3.3.2.2.2.2.2.2a.cmml" xref="S2.E3.m1.3.3.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.E3.m1.3.3.2.2.2.2.2.2">E</mtext></ci><ci id="S2.E3.m1.3.3.2.2.2.2.2.3.cmml" xref="S2.E3.m1.3.3.2.2.2.2.2.3">𝐽</ci></apply><ci id="S2.E3.m1.3.3.2.2.2.2.3.cmml" xref="S2.E3.m1.3.3.2.2.2.2.3">𝑡</ci></apply></list><apply id="S2.E3.m1.3.3.2.4.cmml" xref="S2.E3.m1.3.3.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.2.4.1.cmml" xref="S2.E3.m1.3.3.2.4">subscript</csymbol><apply id="S2.E3.m1.3.3.2.4.2.cmml" xref="S2.E3.m1.3.3.2.4.2"><ci id="S2.E3.m1.3.3.2.4.2.1.cmml" xref="S2.E3.m1.3.3.2.4.2.1">^</ci><ci id="S2.E3.m1.3.3.2.4.2.2a.cmml" xref="S2.E3.m1.3.3.2.4.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.3.3.2.4.2.2.cmml" xref="S2.E3.m1.3.3.2.4.2.2">W</mtext></ci></apply><ci id="S2.E3.m1.3.3.2.4.3.cmml" xref="S2.E3.m1.3.3.2.4.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\hat{\textbf{Q}}_{t}=[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]\hat{\textbf{W%
}}_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">over^ start_ARG Q end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , … , E start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] over^ start_ARG W end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\textbf{K}}_{t}=[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]\hat{\textbf{W%
}}_{k}" class="ltx_Math" display="block" id="S2.E4.m1.3"><semantics id="S2.E4.m1.3a"><mrow id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml"><msub id="S2.E4.m1.3.3.4" xref="S2.E4.m1.3.3.4.cmml"><mover accent="true" id="S2.E4.m1.3.3.4.2" xref="S2.E4.m1.3.3.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.3.3.4.2.2" xref="S2.E4.m1.3.3.4.2.2a.cmml">K</mtext><mo id="S2.E4.m1.3.3.4.2.1" xref="S2.E4.m1.3.3.4.2.1.cmml">^</mo></mover><mi id="S2.E4.m1.3.3.4.3" xref="S2.E4.m1.3.3.4.3.cmml">t</mi></msub><mo id="S2.E4.m1.3.3.3" xref="S2.E4.m1.3.3.3.cmml">=</mo><mrow id="S2.E4.m1.3.3.2" xref="S2.E4.m1.3.3.2.cmml"><mrow id="S2.E4.m1.3.3.2.2.2" xref="S2.E4.m1.3.3.2.2.3.cmml"><mo id="S2.E4.m1.3.3.2.2.2.3" stretchy="false" xref="S2.E4.m1.3.3.2.2.3.cmml">[</mo><msubsup id="S2.E4.m1.2.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.1.1.2.2" xref="S2.E4.m1.2.2.1.1.1.1.2.2a.cmml">E</mtext><mi id="S2.E4.m1.2.2.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.3.cmml">t</mi><mn id="S2.E4.m1.2.2.1.1.1.1.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S2.E4.m1.3.3.2.2.2.4" xref="S2.E4.m1.3.3.2.2.3.cmml">,</mo><mi id="S2.E4.m1.1.1" mathvariant="normal" xref="S2.E4.m1.1.1.cmml">…</mi><mo id="S2.E4.m1.3.3.2.2.2.5" xref="S2.E4.m1.3.3.2.2.3.cmml">,</mo><msubsup id="S2.E4.m1.3.3.2.2.2.2" xref="S2.E4.m1.3.3.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.3.3.2.2.2.2.2.2" xref="S2.E4.m1.3.3.2.2.2.2.2.2a.cmml">E</mtext><mi id="S2.E4.m1.3.3.2.2.2.2.3" xref="S2.E4.m1.3.3.2.2.2.2.3.cmml">t</mi><mi id="S2.E4.m1.3.3.2.2.2.2.2.3" xref="S2.E4.m1.3.3.2.2.2.2.2.3.cmml">J</mi></msubsup><mo id="S2.E4.m1.3.3.2.2.2.6" stretchy="false" xref="S2.E4.m1.3.3.2.2.3.cmml">]</mo></mrow><mo id="S2.E4.m1.3.3.2.3" xref="S2.E4.m1.3.3.2.3.cmml">⁢</mo><msub id="S2.E4.m1.3.3.2.4" xref="S2.E4.m1.3.3.2.4.cmml"><mover accent="true" id="S2.E4.m1.3.3.2.4.2" xref="S2.E4.m1.3.3.2.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.3.3.2.4.2.2" xref="S2.E4.m1.3.3.2.4.2.2a.cmml">W</mtext><mo id="S2.E4.m1.3.3.2.4.2.1" xref="S2.E4.m1.3.3.2.4.2.1.cmml">^</mo></mover><mi id="S2.E4.m1.3.3.2.4.3" xref="S2.E4.m1.3.3.2.4.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.3b"><apply id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3"><eq id="S2.E4.m1.3.3.3.cmml" xref="S2.E4.m1.3.3.3"></eq><apply id="S2.E4.m1.3.3.4.cmml" xref="S2.E4.m1.3.3.4"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.4.1.cmml" xref="S2.E4.m1.3.3.4">subscript</csymbol><apply id="S2.E4.m1.3.3.4.2.cmml" xref="S2.E4.m1.3.3.4.2"><ci id="S2.E4.m1.3.3.4.2.1.cmml" xref="S2.E4.m1.3.3.4.2.1">^</ci><ci id="S2.E4.m1.3.3.4.2.2a.cmml" xref="S2.E4.m1.3.3.4.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.3.3.4.2.2.cmml" xref="S2.E4.m1.3.3.4.2.2">K</mtext></ci></apply><ci id="S2.E4.m1.3.3.4.3.cmml" xref="S2.E4.m1.3.3.4.3">𝑡</ci></apply><apply id="S2.E4.m1.3.3.2.cmml" xref="S2.E4.m1.3.3.2"><times id="S2.E4.m1.3.3.2.3.cmml" xref="S2.E4.m1.3.3.2.3"></times><list id="S2.E4.m1.3.3.2.2.3.cmml" xref="S2.E4.m1.3.3.2.2.2"><apply id="S2.E4.m1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1">subscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.2.2a.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2">E</mtext></ci><cn id="S2.E4.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.1.1.2.3">1</cn></apply><ci id="S2.E4.m1.2.2.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">…</ci><apply id="S2.E4.m1.3.3.2.2.2.2.cmml" xref="S2.E4.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.2.2.2.1.cmml" xref="S2.E4.m1.3.3.2.2.2.2">subscript</csymbol><apply id="S2.E4.m1.3.3.2.2.2.2.2.cmml" xref="S2.E4.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.2.2.2.2.1.cmml" xref="S2.E4.m1.3.3.2.2.2.2">superscript</csymbol><ci id="S2.E4.m1.3.3.2.2.2.2.2.2a.cmml" xref="S2.E4.m1.3.3.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.E4.m1.3.3.2.2.2.2.2.2">E</mtext></ci><ci id="S2.E4.m1.3.3.2.2.2.2.2.3.cmml" xref="S2.E4.m1.3.3.2.2.2.2.2.3">𝐽</ci></apply><ci id="S2.E4.m1.3.3.2.2.2.2.3.cmml" xref="S2.E4.m1.3.3.2.2.2.2.3">𝑡</ci></apply></list><apply id="S2.E4.m1.3.3.2.4.cmml" xref="S2.E4.m1.3.3.2.4"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.4.1.cmml" xref="S2.E4.m1.3.3.2.4">subscript</csymbol><apply id="S2.E4.m1.3.3.2.4.2.cmml" xref="S2.E4.m1.3.3.2.4.2"><ci id="S2.E4.m1.3.3.2.4.2.1.cmml" xref="S2.E4.m1.3.3.2.4.2.1">^</ci><ci id="S2.E4.m1.3.3.2.4.2.2a.cmml" xref="S2.E4.m1.3.3.2.4.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E4.m1.3.3.2.4.2.2.cmml" xref="S2.E4.m1.3.3.2.4.2.2">W</mtext></ci></apply><ci id="S2.E4.m1.3.3.2.4.3.cmml" xref="S2.E4.m1.3.3.2.4.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.3c">\hat{\textbf{K}}_{t}=[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]\hat{\textbf{W%
}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.3d">over^ start_ARG K end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , … , E start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] over^ start_ARG W end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\textbf{V}}_{t}=[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]\hat{\textbf{W%
}}_{v}" class="ltx_Math" display="block" id="S2.E5.m1.3"><semantics id="S2.E5.m1.3a"><mrow id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml"><msub id="S2.E5.m1.3.3.4" xref="S2.E5.m1.3.3.4.cmml"><mover accent="true" id="S2.E5.m1.3.3.4.2" xref="S2.E5.m1.3.3.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.3.3.4.2.2" xref="S2.E5.m1.3.3.4.2.2a.cmml">V</mtext><mo id="S2.E5.m1.3.3.4.2.1" xref="S2.E5.m1.3.3.4.2.1.cmml">^</mo></mover><mi id="S2.E5.m1.3.3.4.3" xref="S2.E5.m1.3.3.4.3.cmml">t</mi></msub><mo id="S2.E5.m1.3.3.3" xref="S2.E5.m1.3.3.3.cmml">=</mo><mrow id="S2.E5.m1.3.3.2" xref="S2.E5.m1.3.3.2.cmml"><mrow id="S2.E5.m1.3.3.2.2.2" xref="S2.E5.m1.3.3.2.2.3.cmml"><mo id="S2.E5.m1.3.3.2.2.2.3" stretchy="false" xref="S2.E5.m1.3.3.2.2.3.cmml">[</mo><msubsup id="S2.E5.m1.2.2.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.2.2.1.1.1.1.2.2" xref="S2.E5.m1.2.2.1.1.1.1.2.2a.cmml">E</mtext><mi id="S2.E5.m1.2.2.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.3.cmml">t</mi><mn id="S2.E5.m1.2.2.1.1.1.1.2.3" xref="S2.E5.m1.2.2.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S2.E5.m1.3.3.2.2.2.4" xref="S2.E5.m1.3.3.2.2.3.cmml">,</mo><mi id="S2.E5.m1.1.1" mathvariant="normal" xref="S2.E5.m1.1.1.cmml">…</mi><mo id="S2.E5.m1.3.3.2.2.2.5" xref="S2.E5.m1.3.3.2.2.3.cmml">,</mo><msubsup id="S2.E5.m1.3.3.2.2.2.2" xref="S2.E5.m1.3.3.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.3.3.2.2.2.2.2.2" xref="S2.E5.m1.3.3.2.2.2.2.2.2a.cmml">E</mtext><mi id="S2.E5.m1.3.3.2.2.2.2.3" xref="S2.E5.m1.3.3.2.2.2.2.3.cmml">t</mi><mi id="S2.E5.m1.3.3.2.2.2.2.2.3" xref="S2.E5.m1.3.3.2.2.2.2.2.3.cmml">J</mi></msubsup><mo id="S2.E5.m1.3.3.2.2.2.6" stretchy="false" xref="S2.E5.m1.3.3.2.2.3.cmml">]</mo></mrow><mo id="S2.E5.m1.3.3.2.3" xref="S2.E5.m1.3.3.2.3.cmml">⁢</mo><msub id="S2.E5.m1.3.3.2.4" xref="S2.E5.m1.3.3.2.4.cmml"><mover accent="true" id="S2.E5.m1.3.3.2.4.2" xref="S2.E5.m1.3.3.2.4.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.3.3.2.4.2.2" xref="S2.E5.m1.3.3.2.4.2.2a.cmml">W</mtext><mo id="S2.E5.m1.3.3.2.4.2.1" xref="S2.E5.m1.3.3.2.4.2.1.cmml">^</mo></mover><mi id="S2.E5.m1.3.3.2.4.3" xref="S2.E5.m1.3.3.2.4.3.cmml">v</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.3b"><apply id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3"><eq id="S2.E5.m1.3.3.3.cmml" xref="S2.E5.m1.3.3.3"></eq><apply id="S2.E5.m1.3.3.4.cmml" xref="S2.E5.m1.3.3.4"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.4.1.cmml" xref="S2.E5.m1.3.3.4">subscript</csymbol><apply id="S2.E5.m1.3.3.4.2.cmml" xref="S2.E5.m1.3.3.4.2"><ci id="S2.E5.m1.3.3.4.2.1.cmml" xref="S2.E5.m1.3.3.4.2.1">^</ci><ci id="S2.E5.m1.3.3.4.2.2a.cmml" xref="S2.E5.m1.3.3.4.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.3.3.4.2.2.cmml" xref="S2.E5.m1.3.3.4.2.2">V</mtext></ci></apply><ci id="S2.E5.m1.3.3.4.3.cmml" xref="S2.E5.m1.3.3.4.3">𝑡</ci></apply><apply id="S2.E5.m1.3.3.2.cmml" xref="S2.E5.m1.3.3.2"><times id="S2.E5.m1.3.3.2.3.cmml" xref="S2.E5.m1.3.3.2.3"></times><list id="S2.E5.m1.3.3.2.2.3.cmml" xref="S2.E5.m1.3.3.2.2.2"><apply id="S2.E5.m1.2.2.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1">subscript</csymbol><apply id="S2.E5.m1.2.2.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S2.E5.m1.2.2.1.1.1.1.2.2a.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2">E</mtext></ci><cn id="S2.E5.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S2.E5.m1.2.2.1.1.1.1.2.3">1</cn></apply><ci id="S2.E5.m1.2.2.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">…</ci><apply id="S2.E5.m1.3.3.2.2.2.2.cmml" xref="S2.E5.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.2.2.2.2.1.cmml" xref="S2.E5.m1.3.3.2.2.2.2">subscript</csymbol><apply id="S2.E5.m1.3.3.2.2.2.2.2.cmml" xref="S2.E5.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.2.2.2.2.2.1.cmml" xref="S2.E5.m1.3.3.2.2.2.2">superscript</csymbol><ci id="S2.E5.m1.3.3.2.2.2.2.2.2a.cmml" xref="S2.E5.m1.3.3.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.E5.m1.3.3.2.2.2.2.2.2">E</mtext></ci><ci id="S2.E5.m1.3.3.2.2.2.2.2.3.cmml" xref="S2.E5.m1.3.3.2.2.2.2.2.3">𝐽</ci></apply><ci id="S2.E5.m1.3.3.2.2.2.2.3.cmml" xref="S2.E5.m1.3.3.2.2.2.2.3">𝑡</ci></apply></list><apply id="S2.E5.m1.3.3.2.4.cmml" xref="S2.E5.m1.3.3.2.4"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.2.4.1.cmml" xref="S2.E5.m1.3.3.2.4">subscript</csymbol><apply id="S2.E5.m1.3.3.2.4.2.cmml" xref="S2.E5.m1.3.3.2.4.2"><ci id="S2.E5.m1.3.3.2.4.2.1.cmml" xref="S2.E5.m1.3.3.2.4.2.1">^</ci><ci id="S2.E5.m1.3.3.2.4.2.2a.cmml" xref="S2.E5.m1.3.3.2.4.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E5.m1.3.3.2.4.2.2.cmml" xref="S2.E5.m1.3.3.2.4.2.2">W</mtext></ci></apply><ci id="S2.E5.m1.3.3.2.4.3.cmml" xref="S2.E5.m1.3.3.2.4.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.3c">\hat{\textbf{V}}_{t}=[\textbf{E}^{1}_{t},...,\textbf{E}^{J}_{t}]\hat{\textbf{W%
}}_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.3d">over^ start_ARG V end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , … , E start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] over^ start_ARG W end_ARG start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p3">
<p class="ltx_p" id="S2.SS3.SSS2.p3.10">We aim to find the attention between the prescriptions of time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.1.m1.1"><semantics id="S2.SS3.SSS2.p3.1.m1.1a"><mi id="S2.SS3.SSS2.p3.1.m1.1.1" xref="S2.SS3.SSS2.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.1.m1.1b"><ci id="S2.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.1.m1.1d">italic_t</annotation></semantics></math> and <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.2.m2.1"><semantics id="S2.SS3.SSS2.p3.2.m2.1a"><mrow id="S2.SS3.SSS2.p3.2.m2.1.1" xref="S2.SS3.SSS2.p3.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p3.2.m2.1.1.2" xref="S2.SS3.SSS2.p3.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p3.2.m2.1.1.1" xref="S2.SS3.SSS2.p3.2.m2.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p3.2.m2.1.1.3" xref="S2.SS3.SSS2.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.2.m2.1b"><apply id="S2.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1"><plus id="S2.SS3.SSS2.p3.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.1"></plus><ci id="S2.SS3.SSS2.p3.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p3.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.2.m2.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.2.m2.1d">italic_t + 1</annotation></semantics></math>, as shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E6" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, where <math alttext="\textbf{Att}^{j}_{t+1}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.3.m3.1"><semantics id="S2.SS3.SSS2.p3.3.m3.1a"><msubsup id="S2.SS3.SSS2.p3.3.m3.1.1" xref="S2.SS3.SSS2.p3.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p3.3.m3.1.1.2.2" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.2a.cmml">Att</mtext><mrow id="S2.SS3.SSS2.p3.3.m3.1.1.3" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.cmml"><mi id="S2.SS3.SSS2.p3.3.m3.1.1.3.2" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.2.cmml">t</mi><mo id="S2.SS3.SSS2.p3.3.m3.1.1.3.1" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.1.cmml">+</mo><mn id="S2.SS3.SSS2.p3.3.m3.1.1.3.3" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS2.p3.3.m3.1.1.2.3" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.3.m3.1b"><apply id="S2.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p3.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.3.m3.1.1.2.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.3.m3.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p3.3.m3.1.1.2.2.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.2">Att</mtext></ci><ci id="S2.SS3.SSS2.p3.3.m3.1.1.2.3.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.2.3">𝑗</ci></apply><apply id="S2.SS3.SSS2.p3.3.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.3"><plus id="S2.SS3.SSS2.p3.3.m3.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.1"></plus><ci id="S2.SS3.SSS2.p3.3.m3.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.2">𝑡</ci><cn id="S2.SS3.SSS2.p3.3.m3.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS2.p3.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.3.m3.1c">\textbf{Att}^{j}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.3.m3.1d">Att start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\in\mathbb{R}^{B\times L_{B}\times L_{B}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.4.m4.1"><semantics id="S2.SS3.SSS2.p3.4.m4.1a"><mrow id="S2.SS3.SSS2.p3.4.m4.1.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p3.4.m4.1.1.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.cmml"></mi><mo id="S2.SS3.SSS2.p3.4.m4.1.1.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS2.p3.4.m4.1.1.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.cmml"><mi id="S2.SS3.SSS2.p3.4.m4.1.1.3.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p3.4.m4.1.1.3.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.cmml"><mi id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.2.cmml">B</mi><mo id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.cmml"><mi id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.2.cmml">L</mi><mi id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.3.cmml">B</mi></msub><mo id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.cmml"><mi id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.2.cmml">L</mi><mi id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.3.cmml">B</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.4.m4.1b"><apply id="S2.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1"><in id="S2.SS3.SSS2.p3.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.SSS2.p3.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2">absent</csymbol><apply id="S2.SS3.SSS2.p3.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS2.p3.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3"><times id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.1"></times><ci id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.2">𝐵</ci><apply id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.2">𝐿</ci><ci id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.3.3">𝐵</ci></apply><apply id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4">subscript</csymbol><ci id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.2">𝐿</ci><ci id="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.3.4.3">𝐵</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.4.m4.1c">\in\mathbb{R}^{B\times L_{B}\times L_{B}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.4.m4.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> represents the cross-visit attention between consecutive in head <math alttext="j" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.5.m5.1"><semantics id="S2.SS3.SSS2.p3.5.m5.1a"><mi id="S2.SS3.SSS2.p3.5.m5.1.1" xref="S2.SS3.SSS2.p3.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.5.m5.1b"><ci id="S2.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.5.m5.1d">italic_j</annotation></semantics></math>. The masking matrix <math alttext="\hat{M}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.6.m6.1"><semantics id="S2.SS3.SSS2.p3.6.m6.1a"><mover accent="true" id="S2.SS3.SSS2.p3.6.m6.1.1" xref="S2.SS3.SSS2.p3.6.m6.1.1.cmml"><mi id="S2.SS3.SSS2.p3.6.m6.1.1.2" xref="S2.SS3.SSS2.p3.6.m6.1.1.2.cmml">M</mi><mo id="S2.SS3.SSS2.p3.6.m6.1.1.1" xref="S2.SS3.SSS2.p3.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.6.m6.1b"><apply id="S2.SS3.SSS2.p3.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1"><ci id="S2.SS3.SSS2.p3.6.m6.1.1.1.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.1">^</ci><ci id="S2.SS3.SSS2.p3.6.m6.1.1.2.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.2">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.6.m6.1c">\hat{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.6.m6.1d">over^ start_ARG italic_M end_ARG</annotation></semantics></math> is based on the available prescription codes for the consecutive time steps as rows are associated with medications at <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.7.m7.1"><semantics id="S2.SS3.SSS2.p3.7.m7.1a"><mrow id="S2.SS3.SSS2.p3.7.m7.1.1" xref="S2.SS3.SSS2.p3.7.m7.1.1.cmml"><mi id="S2.SS3.SSS2.p3.7.m7.1.1.2" xref="S2.SS3.SSS2.p3.7.m7.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p3.7.m7.1.1.1" xref="S2.SS3.SSS2.p3.7.m7.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p3.7.m7.1.1.3" xref="S2.SS3.SSS2.p3.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.7.m7.1b"><apply id="S2.SS3.SSS2.p3.7.m7.1.1.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1"><plus id="S2.SS3.SSS2.p3.7.m7.1.1.1.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1.1"></plus><ci id="S2.SS3.SSS2.p3.7.m7.1.1.2.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p3.7.m7.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p3.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.7.m7.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.7.m7.1d">italic_t + 1</annotation></semantics></math> and columns at <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.8.m8.1"><semantics id="S2.SS3.SSS2.p3.8.m8.1a"><mi id="S2.SS3.SSS2.p3.8.m8.1.1" xref="S2.SS3.SSS2.p3.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.8.m8.1b"><ci id="S2.SS3.SSS2.p3.8.m8.1.1.cmml" xref="S2.SS3.SSS2.p3.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.8.m8.1d">italic_t</annotation></semantics></math>. The transpose function inside the <math alttext="\textbf{Att}^{j}_{t+1}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.9.m9.1"><semantics id="S2.SS3.SSS2.p3.9.m9.1a"><msubsup id="S2.SS3.SSS2.p3.9.m9.1.1" xref="S2.SS3.SSS2.p3.9.m9.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p3.9.m9.1.1.2.2" xref="S2.SS3.SSS2.p3.9.m9.1.1.2.2a.cmml">Att</mtext><mrow id="S2.SS3.SSS2.p3.9.m9.1.1.3" xref="S2.SS3.SSS2.p3.9.m9.1.1.3.cmml"><mi id="S2.SS3.SSS2.p3.9.m9.1.1.3.2" xref="S2.SS3.SSS2.p3.9.m9.1.1.3.2.cmml">t</mi><mo id="S2.SS3.SSS2.p3.9.m9.1.1.3.1" xref="S2.SS3.SSS2.p3.9.m9.1.1.3.1.cmml">+</mo><mn id="S2.SS3.SSS2.p3.9.m9.1.1.3.3" xref="S2.SS3.SSS2.p3.9.m9.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS2.p3.9.m9.1.1.2.3" xref="S2.SS3.SSS2.p3.9.m9.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.9.m9.1b"><apply id="S2.SS3.SSS2.p3.9.m9.1.1.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.9.m9.1.1.1.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p3.9.m9.1.1.2.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.9.m9.1.1.2.1.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1">superscript</csymbol><ci id="S2.SS3.SSS2.p3.9.m9.1.1.2.2a.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p3.9.m9.1.1.2.2.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1.2.2">Att</mtext></ci><ci id="S2.SS3.SSS2.p3.9.m9.1.1.2.3.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1.2.3">𝑗</ci></apply><apply id="S2.SS3.SSS2.p3.9.m9.1.1.3.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1.3"><plus id="S2.SS3.SSS2.p3.9.m9.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1.3.1"></plus><ci id="S2.SS3.SSS2.p3.9.m9.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.9.m9.1.1.3.2">𝑡</ci><cn id="S2.SS3.SSS2.p3.9.m9.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS2.p3.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.9.m9.1c">\textbf{Att}^{j}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.9.m9.1d">Att start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the attention directed towards the prescriptions at time step <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p3.10.m10.1"><semantics id="S2.SS3.SSS2.p3.10.m10.1a"><mrow id="S2.SS3.SSS2.p3.10.m10.1.1" xref="S2.SS3.SSS2.p3.10.m10.1.1.cmml"><mi id="S2.SS3.SSS2.p3.10.m10.1.1.2" xref="S2.SS3.SSS2.p3.10.m10.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p3.10.m10.1.1.1" xref="S2.SS3.SSS2.p3.10.m10.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p3.10.m10.1.1.3" xref="S2.SS3.SSS2.p3.10.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.10.m10.1b"><apply id="S2.SS3.SSS2.p3.10.m10.1.1.cmml" xref="S2.SS3.SSS2.p3.10.m10.1.1"><plus id="S2.SS3.SSS2.p3.10.m10.1.1.1.cmml" xref="S2.SS3.SSS2.p3.10.m10.1.1.1"></plus><ci id="S2.SS3.SSS2.p3.10.m10.1.1.2.cmml" xref="S2.SS3.SSS2.p3.10.m10.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p3.10.m10.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p3.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.10.m10.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p3.10.m10.1d">italic_t + 1</annotation></semantics></math>, and the sum of incoming attention for each prescription equals 1.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{Att}^{j}_{t+1}=\operatorname{softmax}((\frac{\hat{\textbf{Q}}^{j}_{t}(%
{\hat{\textbf{K}}^{j}}_{t+1})^{T}}{\sqrt{d/J}}+\hat{M})^{T})" class="ltx_Math" display="block" id="S2.E6.m1.3"><semantics id="S2.E6.m1.3a"><mrow id="S2.E6.m1.3.3" xref="S2.E6.m1.3.3.cmml"><msubsup id="S2.E6.m1.3.3.3" xref="S2.E6.m1.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E6.m1.3.3.3.2.2" xref="S2.E6.m1.3.3.3.2.2a.cmml">Att</mtext><mrow id="S2.E6.m1.3.3.3.3" xref="S2.E6.m1.3.3.3.3.cmml"><mi id="S2.E6.m1.3.3.3.3.2" xref="S2.E6.m1.3.3.3.3.2.cmml">t</mi><mo id="S2.E6.m1.3.3.3.3.1" xref="S2.E6.m1.3.3.3.3.1.cmml">+</mo><mn id="S2.E6.m1.3.3.3.3.3" xref="S2.E6.m1.3.3.3.3.3.cmml">1</mn></mrow><mi id="S2.E6.m1.3.3.3.2.3" xref="S2.E6.m1.3.3.3.2.3.cmml">j</mi></msubsup><mo id="S2.E6.m1.3.3.2" xref="S2.E6.m1.3.3.2.cmml">=</mo><mrow id="S2.E6.m1.3.3.1.1" xref="S2.E6.m1.3.3.1.2.cmml"><mi id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml">softmax</mi><mo id="S2.E6.m1.3.3.1.1a" xref="S2.E6.m1.3.3.1.2.cmml">⁡</mo><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.2.cmml"><mo id="S2.E6.m1.3.3.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.1.2.cmml">(</mo><msup id="S2.E6.m1.3.3.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mfrac id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.cmml"><msubsup id="S2.E6.m1.1.1.1.3" xref="S2.E6.m1.1.1.1.3.cmml"><mover accent="true" id="S2.E6.m1.1.1.1.3.2.2" xref="S2.E6.m1.1.1.1.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E6.m1.1.1.1.3.2.2.2" xref="S2.E6.m1.1.1.1.3.2.2.2a.cmml">Q</mtext><mo id="S2.E6.m1.1.1.1.3.2.2.1" xref="S2.E6.m1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S2.E6.m1.1.1.1.3.3" xref="S2.E6.m1.1.1.1.3.3.cmml">t</mi><mi id="S2.E6.m1.1.1.1.3.2.3" xref="S2.E6.m1.1.1.1.3.2.3.cmml">j</mi></msubsup><mo id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.2.cmml">⁢</mo><msup id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S2.E6.m1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E6.m1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.1.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E6.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E6.m1.1.1.1.1.1.1.1.2.2.2a.cmml">K</mtext><mo id="S2.E6.m1.1.1.1.1.1.1.1.2.2.1" xref="S2.E6.m1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.E6.m1.1.1.1.1.1.1.1a" xref="S2.E6.m1.1.1.1.1.1.1.1.cmml"></mrow><mi id="S2.E6.m1.1.1.1.1.1.1.1.2.3" xref="S2.E6.m1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S2.E6.m1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.3.2" xref="S2.E6.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.E6.m1.1.1.1.1.1.1.1.3.1" xref="S2.E6.m1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S2.E6.m1.1.1.1.1.1.1.1.3.3" xref="S2.E6.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.E6.m1.1.1.1.1.1.1.1b" xref="S2.E6.m1.1.1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="S2.E6.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.3.cmml">T</mi></msup></mrow><msqrt id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml"><mrow id="S2.E6.m1.1.1.3.2" xref="S2.E6.m1.1.1.3.2.cmml"><mi id="S2.E6.m1.1.1.3.2.2" xref="S2.E6.m1.1.1.3.2.2.cmml">d</mi><mo id="S2.E6.m1.1.1.3.2.1" xref="S2.E6.m1.1.1.3.2.1.cmml">/</mo><mi id="S2.E6.m1.1.1.3.2.3" xref="S2.E6.m1.1.1.3.2.3.cmml">J</mi></mrow></msqrt></mfrac><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">+</mo><mover accent="true" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">M</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover></mrow><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E6.m1.3.3.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.3.cmml">T</mi></msup><mo id="S2.E6.m1.3.3.1.1.1.3" stretchy="false" xref="S2.E6.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.3b"><apply id="S2.E6.m1.3.3.cmml" xref="S2.E6.m1.3.3"><eq id="S2.E6.m1.3.3.2.cmml" xref="S2.E6.m1.3.3.2"></eq><apply id="S2.E6.m1.3.3.3.cmml" xref="S2.E6.m1.3.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.3.1.cmml" xref="S2.E6.m1.3.3.3">subscript</csymbol><apply id="S2.E6.m1.3.3.3.2.cmml" xref="S2.E6.m1.3.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.3.2.1.cmml" xref="S2.E6.m1.3.3.3">superscript</csymbol><ci id="S2.E6.m1.3.3.3.2.2a.cmml" xref="S2.E6.m1.3.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E6.m1.3.3.3.2.2.cmml" xref="S2.E6.m1.3.3.3.2.2">Att</mtext></ci><ci id="S2.E6.m1.3.3.3.2.3.cmml" xref="S2.E6.m1.3.3.3.2.3">𝑗</ci></apply><apply id="S2.E6.m1.3.3.3.3.cmml" xref="S2.E6.m1.3.3.3.3"><plus id="S2.E6.m1.3.3.3.3.1.cmml" xref="S2.E6.m1.3.3.3.3.1"></plus><ci id="S2.E6.m1.3.3.3.3.2.cmml" xref="S2.E6.m1.3.3.3.3.2">𝑡</ci><cn id="S2.E6.m1.3.3.3.3.3.cmml" type="integer" xref="S2.E6.m1.3.3.3.3.3">1</cn></apply></apply><apply id="S2.E6.m1.3.3.1.2.cmml" xref="S2.E6.m1.3.3.1.1"><ci id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2">softmax</ci><apply id="S2.E6.m1.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1"><plus id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1"></plus><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><divide id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1"></divide><apply id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><times id="S2.E6.m1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.2"></times><apply id="S2.E6.m1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.1.3">subscript</csymbol><apply id="S2.E6.m1.1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.1.3">superscript</csymbol><apply id="S2.E6.m1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.1.3.2.2"><ci id="S2.E6.m1.1.1.1.3.2.2.1.cmml" xref="S2.E6.m1.1.1.1.3.2.2.1">^</ci><ci id="S2.E6.m1.1.1.1.3.2.2.2a.cmml" xref="S2.E6.m1.1.1.1.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E6.m1.1.1.1.3.2.2.2.cmml" xref="S2.E6.m1.1.1.1.3.2.2.2">Q</mtext></ci></apply><ci id="S2.E6.m1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S2.E6.m1.1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.1.3.3">𝑡</ci></apply><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1">superscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.2.2"><ci id="S2.E6.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E6.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.2.2.2">K</mtext></ci></apply><ci id="S2.E6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.3"><plus id="S2.E6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.3.1"></plus><ci id="S2.E6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S2.E6.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E6.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.E6.m1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3"><root id="S2.E6.m1.1.1.3a.cmml" xref="S2.E6.m1.1.1.3"></root><apply id="S2.E6.m1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.3.2"><divide id="S2.E6.m1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.3.2.1"></divide><ci id="S2.E6.m1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.3.2.2">𝑑</ci><ci id="S2.E6.m1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.3.2.3">𝐽</ci></apply></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2"><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2.2">𝑀</ci></apply></apply><ci id="S2.E6.m1.3.3.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.3c">\textbf{Att}^{j}_{t+1}=\operatorname{softmax}((\frac{\hat{\textbf{Q}}^{j}_{t}(%
{\hat{\textbf{K}}^{j}}_{t+1})^{T}}{\sqrt{d/J}}+\hat{M})^{T})</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.3d">Att start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = roman_softmax ( ( divide start_ARG over^ start_ARG Q end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over^ start_ARG K end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d / italic_J end_ARG end_ARG + over^ start_ARG italic_M end_ARG ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p4">
<p class="ltx_p" id="S2.SS3.SSS2.p4.8">Following the generation of temporal paths, the embedding of the prescriptions at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.1.m1.1"><semantics id="S2.SS3.SSS2.p4.1.m1.1a"><mi id="S2.SS3.SSS2.p4.1.m1.1.1" xref="S2.SS3.SSS2.p4.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.1.m1.1b"><ci id="S2.SS3.SSS2.p4.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p4.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.1.m1.1d">italic_t</annotation></semantics></math> is shared to <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.2.m2.1"><semantics id="S2.SS3.SSS2.p4.2.m2.1a"><mrow id="S2.SS3.SSS2.p4.2.m2.1.1" xref="S2.SS3.SSS2.p4.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p4.2.m2.1.1.2" xref="S2.SS3.SSS2.p4.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p4.2.m2.1.1.1" xref="S2.SS3.SSS2.p4.2.m2.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p4.2.m2.1.1.3" xref="S2.SS3.SSS2.p4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.2.m2.1b"><apply id="S2.SS3.SSS2.p4.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p4.2.m2.1.1"><plus id="S2.SS3.SSS2.p4.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p4.2.m2.1.1.1"></plus><ci id="S2.SS3.SSS2.p4.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p4.2.m2.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p4.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.2.m2.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.2.m2.1d">italic_t + 1</annotation></semantics></math> based on their cross-visit attention. Mathematically, based on Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E7" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a> the temporal embedding is extracted, where <math alttext="{\hat{\textbf{e}}^{j}}_{t+1}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.3.m3.1"><semantics id="S2.SS3.SSS2.p4.3.m3.1a"><mmultiscripts id="S2.SS3.SSS2.p4.3.m3.1.1" xref="S2.SS3.SSS2.p4.3.m3.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p4.3.m3.1.1.2.2" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.3.m3.1.1.2.2.2" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.2.2a.cmml">e</mtext><mo id="S2.SS3.SSS2.p4.3.m3.1.1.2.2.1" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS3.SSS2.p4.3.m3.1.1a" xref="S2.SS3.SSS2.p4.3.m3.1.1.cmml"></mrow><mi id="S2.SS3.SSS2.p4.3.m3.1.1.2.3" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.3.cmml">j</mi><mrow id="S2.SS3.SSS2.p4.3.m3.1.1.3" xref="S2.SS3.SSS2.p4.3.m3.1.1.3.cmml"><mi id="S2.SS3.SSS2.p4.3.m3.1.1.3.2" xref="S2.SS3.SSS2.p4.3.m3.1.1.3.2.cmml">t</mi><mo id="S2.SS3.SSS2.p4.3.m3.1.1.3.1" xref="S2.SS3.SSS2.p4.3.m3.1.1.3.1.cmml">+</mo><mn id="S2.SS3.SSS2.p4.3.m3.1.1.3.3" xref="S2.SS3.SSS2.p4.3.m3.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.SS3.SSS2.p4.3.m3.1.1b" xref="S2.SS3.SSS2.p4.3.m3.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.3.m3.1b"><apply id="S2.SS3.SSS2.p4.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p4.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.3.m3.1.1.2.1.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p4.3.m3.1.1.2.2.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.2"><ci id="S2.SS3.SSS2.p4.3.m3.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p4.3.m3.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.3.m3.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.2.2">e</mtext></ci></apply><ci id="S2.SS3.SSS2.p4.3.m3.1.1.2.3.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.2.3">𝑗</ci></apply><apply id="S2.SS3.SSS2.p4.3.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.3"><plus id="S2.SS3.SSS2.p4.3.m3.1.1.3.1.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.3.1"></plus><ci id="S2.SS3.SSS2.p4.3.m3.1.1.3.2.cmml" xref="S2.SS3.SSS2.p4.3.m3.1.1.3.2">𝑡</ci><cn id="S2.SS3.SSS2.p4.3.m3.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS2.p4.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.3.m3.1c">{\hat{\textbf{e}}^{j}}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.3.m3.1d">over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\in\mathbb{R}^{B\times L_{B}\times d/J}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.4.m4.1"><semantics id="S2.SS3.SSS2.p4.4.m4.1a"><mrow id="S2.SS3.SSS2.p4.4.m4.1.1" xref="S2.SS3.SSS2.p4.4.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p4.4.m4.1.1.2" xref="S2.SS3.SSS2.p4.4.m4.1.1.2.cmml"></mi><mo id="S2.SS3.SSS2.p4.4.m4.1.1.1" xref="S2.SS3.SSS2.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS3.SSS2.p4.4.m4.1.1.3" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.cmml"><mi id="S2.SS3.SSS2.p4.4.m4.1.1.3.2" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p4.4.m4.1.1.3.3" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.cmml"><mrow id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.cmml"><mi id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.2" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.2.cmml">B</mi><mo id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.1.cmml">×</mo><msub id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.cmml"><mi id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.2" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.2.cmml">L</mi><mi id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.3" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.3.cmml">B</mi></msub><mo id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.4" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.4.cmml">d</mi></mrow><mo id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.1" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.1.cmml">/</mo><mi id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.3" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.4.m4.1b"><apply id="S2.SS3.SSS2.p4.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1"><in id="S2.SS3.SSS2.p4.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.1"></in><csymbol cd="latexml" id="S2.SS3.SSS2.p4.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.2">absent</csymbol><apply id="S2.SS3.SSS2.p4.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS2.p4.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3"><divide id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.1.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.1"></divide><apply id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2"><times id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.1.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.1"></times><ci id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.2.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.2">𝐵</ci><apply id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.1.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3">subscript</csymbol><ci id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.2.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.2">𝐿</ci><ci id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.3.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.3.3">𝐵</ci></apply><ci id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.4.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.2.4">𝑑</ci></apply><ci id="S2.SS3.SSS2.p4.4.m4.1.1.3.3.3.cmml" xref="S2.SS3.SSS2.p4.4.m4.1.1.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.4.m4.1c">\in\mathbb{R}^{B\times L_{B}\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.4.m4.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>. This represents the output embedding of prescriptions at <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.5.m5.1"><semantics id="S2.SS3.SSS2.p4.5.m5.1a"><mrow id="S2.SS3.SSS2.p4.5.m5.1.1" xref="S2.SS3.SSS2.p4.5.m5.1.1.cmml"><mi id="S2.SS3.SSS2.p4.5.m5.1.1.2" xref="S2.SS3.SSS2.p4.5.m5.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p4.5.m5.1.1.1" xref="S2.SS3.SSS2.p4.5.m5.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p4.5.m5.1.1.3" xref="S2.SS3.SSS2.p4.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.5.m5.1b"><apply id="S2.SS3.SSS2.p4.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p4.5.m5.1.1"><plus id="S2.SS3.SSS2.p4.5.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p4.5.m5.1.1.1"></plus><ci id="S2.SS3.SSS2.p4.5.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p4.5.m5.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p4.5.m5.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.5.m5.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.5.m5.1d">italic_t + 1</annotation></semantics></math>, which is extracted from the embeddings and corresponding attentions for prescriptions at <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.6.m6.1"><semantics id="S2.SS3.SSS2.p4.6.m6.1a"><mi id="S2.SS3.SSS2.p4.6.m6.1.1" xref="S2.SS3.SSS2.p4.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.6.m6.1b"><ci id="S2.SS3.SSS2.p4.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p4.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.6.m6.1d">italic_t</annotation></semantics></math>.
The Cross-Visit Transformer embedding at head <math alttext="j" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.7.m7.1"><semantics id="S2.SS3.SSS2.p4.7.m7.1a"><mi id="S2.SS3.SSS2.p4.7.m7.1.1" xref="S2.SS3.SSS2.p4.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.7.m7.1b"><ci id="S2.SS3.SSS2.p4.7.m7.1.1.cmml" xref="S2.SS3.SSS2.p4.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.7.m7.1d">italic_j</annotation></semantics></math> related to temporal paths for all time steps equals to <math alttext="{\hat{\textbf{e}}^{j}}=\langle\hat{\textbf{e}}^{j}_{1},\hat{\textbf{e}}^{j}_{2%
},\dots,\hat{\textbf{e}}^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times L_{B}%
\times d/J}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.8.m8.4"><semantics id="S2.SS3.SSS2.p4.8.m8.4a"><mrow id="S2.SS3.SSS2.p4.8.m8.4.4" xref="S2.SS3.SSS2.p4.8.m8.4.4.cmml"><msup id="S2.SS3.SSS2.p4.8.m8.4.4.5" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.cmml"><mover accent="true" id="S2.SS3.SSS2.p4.8.m8.4.4.5.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.4.4.5.2.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.2.2a.cmml">e</mtext><mo id="S2.SS3.SSS2.p4.8.m8.4.4.5.2.1" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p4.8.m8.4.4.5.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.3.cmml">j</mi></msup><mo id="S2.SS3.SSS2.p4.8.m8.4.4.6" xref="S2.SS3.SSS2.p4.8.m8.4.4.6.cmml">=</mo><mrow id="S2.SS3.SSS2.p4.8.m8.4.4.3.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.4.cmml"><mo id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.4" stretchy="false" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.4.cmml">⟨</mo><msubsup id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.2" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.2a.cmml">e</mtext><mo id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.1" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.3" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.3.cmml">1</mn><mi id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.3" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.5" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.4.cmml">,</mo><msubsup id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.cmml"><mover accent="true" id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.2" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.2a.cmml">e</mtext><mo id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.1" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.3" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.3.cmml">2</mn><mi id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.3" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.6" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.4.cmml">,</mo><mi id="S2.SS3.SSS2.p4.8.m8.1.1" mathvariant="normal" xref="S2.SS3.SSS2.p4.8.m8.1.1.cmml">…</mi><mo id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.7" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.4.cmml">,</mo><msubsup id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.cmml"><mover accent="true" id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.2a.cmml">e</mtext><mo id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.1" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.3.cmml">T</mi><mi id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.8" stretchy="false" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.4.cmml">⟩</mo></mrow><mo id="S2.SS3.SSS2.p4.8.m8.4.4.7" xref="S2.SS3.SSS2.p4.8.m8.4.4.7.cmml">∈</mo><msup id="S2.SS3.SSS2.p4.8.m8.4.4.8" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.cmml"><mi id="S2.SS3.SSS2.p4.8.m8.4.4.8.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p4.8.m8.4.4.8.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.cmml"><mrow id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.cmml"><mi id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.2.cmml">B</mi><mo id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.3.cmml">T</mi><mo id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1.cmml">×</mo><msub id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.cmml"><mi id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.2" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.2.cmml">L</mi><mi id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.3.cmml">B</mi></msub><mo id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.5" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.5.cmml">d</mi></mrow><mo id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.1" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.1.cmml">/</mo><mi id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.3" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.8.m8.4b"><apply id="S2.SS3.SSS2.p4.8.m8.4.4.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4"><and id="S2.SS3.SSS2.p4.8.m8.4.4a.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4"></and><apply id="S2.SS3.SSS2.p4.8.m8.4.4b.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4"><eq id="S2.SS3.SSS2.p4.8.m8.4.4.6.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.6"></eq><apply id="S2.SS3.SSS2.p4.8.m8.4.4.5.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.5"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.4.4.5.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.5">superscript</csymbol><apply id="S2.SS3.SSS2.p4.8.m8.4.4.5.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.2"><ci id="S2.SS3.SSS2.p4.8.m8.4.4.5.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.2.1">^</ci><ci id="S2.SS3.SSS2.p4.8.m8.4.4.5.2.2a.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.4.4.5.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.2.2">e</mtext></ci></apply><ci id="S2.SS3.SSS2.p4.8.m8.4.4.5.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.5.3">𝑗</ci></apply><list id="S2.SS3.SSS2.p4.8.m8.4.4.3.4.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3"><apply id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2"><ci id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.2.2">e</mtext></ci></apply><ci id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p4.8.m8.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2">subscript</csymbol><apply id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2">superscript</csymbol><apply id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2"><ci id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.1">^</ci><ci id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.2a.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.2.2">e</mtext></ci></apply><ci id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS2.p4.8.m8.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS2.p4.8.m8.1.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.1.1">…</ci><apply id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3">subscript</csymbol><apply id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3">superscript</csymbol><apply id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2"><ci id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.1">^</ci><ci id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.2a.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.2.2">e</mtext></ci></apply><ci id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.3.3.3.3">𝑇</ci></apply></list></apply><apply id="S2.SS3.SSS2.p4.8.m8.4.4c.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4"><in id="S2.SS3.SSS2.p4.8.m8.4.4.7.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.7"></in><share href="https://arxiv.org/html/2408.10259v1#S2.SS3.SSS2.p4.8.m8.4.4.3.cmml" id="S2.SS3.SSS2.p4.8.m8.4.4d.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4"></share><apply id="S2.SS3.SSS2.p4.8.m8.4.4.8.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.4.4.8.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8">superscript</csymbol><ci id="S2.SS3.SSS2.p4.8.m8.4.4.8.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.2">ℝ</ci><apply id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3"><divide id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.1"></divide><apply id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2"><times id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.1"></times><ci id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.2">𝐵</ci><ci id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.3">𝑇</ci><apply id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.1.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4">subscript</csymbol><ci id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.2.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.2">𝐿</ci><ci id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.4.3">𝐵</ci></apply><ci id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.5.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.2.5">𝑑</ci></apply><ci id="S2.SS3.SSS2.p4.8.m8.4.4.8.3.3.cmml" xref="S2.SS3.SSS2.p4.8.m8.4.4.8.3.3">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.8.m8.4c">{\hat{\textbf{e}}^{j}}=\langle\hat{\textbf{e}}^{j}_{1},\hat{\textbf{e}}^{j}_{2%
},\dots,\hat{\textbf{e}}^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times L_{B}%
\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.8.m8.4d">over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT = ⟨ over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ⟩ ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_T × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\hat{\textbf{e}}^{j}}_{t+1}=\textbf{Att}^{j}_{t+1}{\hat{\textbf{V}}^{j}}_{t}" class="ltx_Math" display="block" id="S2.E7.m1.1"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml"><mmultiscripts id="S2.E7.m1.1.1.2" xref="S2.E7.m1.1.1.2.cmml"><mover accent="true" id="S2.E7.m1.1.1.2.2.2" xref="S2.E7.m1.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.1.1.2.2.2.2" xref="S2.E7.m1.1.1.2.2.2.2a.cmml">e</mtext><mo id="S2.E7.m1.1.1.2.2.2.1" xref="S2.E7.m1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S2.E7.m1.1.1.2a" xref="S2.E7.m1.1.1.2.cmml"></mrow><mi id="S2.E7.m1.1.1.2.2.3" xref="S2.E7.m1.1.1.2.2.3.cmml">j</mi><mrow id="S2.E7.m1.1.1.2.3" xref="S2.E7.m1.1.1.2.3.cmml"><mi id="S2.E7.m1.1.1.2.3.2" xref="S2.E7.m1.1.1.2.3.2.cmml">t</mi><mo id="S2.E7.m1.1.1.2.3.1" xref="S2.E7.m1.1.1.2.3.1.cmml">+</mo><mn id="S2.E7.m1.1.1.2.3.3" xref="S2.E7.m1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="S2.E7.m1.1.1.2b" xref="S2.E7.m1.1.1.2.cmml"></mrow></mmultiscripts><mo id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.cmml">=</mo><mrow id="S2.E7.m1.1.1.3" xref="S2.E7.m1.1.1.3.cmml"><msubsup id="S2.E7.m1.1.1.3.2" xref="S2.E7.m1.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.1.1.3.2.2.2" xref="S2.E7.m1.1.1.3.2.2.2a.cmml">Att</mtext><mrow id="S2.E7.m1.1.1.3.2.3" xref="S2.E7.m1.1.1.3.2.3.cmml"><mi id="S2.E7.m1.1.1.3.2.3.2" xref="S2.E7.m1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.E7.m1.1.1.3.2.3.1" xref="S2.E7.m1.1.1.3.2.3.1.cmml">+</mo><mn id="S2.E7.m1.1.1.3.2.3.3" xref="S2.E7.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E7.m1.1.1.3.2.2.3" xref="S2.E7.m1.1.1.3.2.2.3.cmml">j</mi></msubsup><mo id="S2.E7.m1.1.1.3.1" xref="S2.E7.m1.1.1.3.1.cmml">⁢</mo><mmultiscripts id="S2.E7.m1.1.1.3.3" xref="S2.E7.m1.1.1.3.3.cmml"><mover accent="true" id="S2.E7.m1.1.1.3.3.2.2" xref="S2.E7.m1.1.1.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.1.1.3.3.2.2.2" xref="S2.E7.m1.1.1.3.3.2.2.2a.cmml">V</mtext><mo id="S2.E7.m1.1.1.3.3.2.2.1" xref="S2.E7.m1.1.1.3.3.2.2.1.cmml">^</mo></mover><mrow id="S2.E7.m1.1.1.3.3a" xref="S2.E7.m1.1.1.3.3.cmml"></mrow><mi id="S2.E7.m1.1.1.3.3.2.3" xref="S2.E7.m1.1.1.3.3.2.3.cmml">j</mi><mi id="S2.E7.m1.1.1.3.3.3" xref="S2.E7.m1.1.1.3.3.3.cmml">t</mi><mrow id="S2.E7.m1.1.1.3.3b" xref="S2.E7.m1.1.1.3.3.cmml"></mrow></mmultiscripts></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><apply id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1"><eq id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"></eq><apply id="S2.E7.m1.1.1.2.cmml" xref="S2.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.2.1.cmml" xref="S2.E7.m1.1.1.2">subscript</csymbol><apply id="S2.E7.m1.1.1.2.2.cmml" xref="S2.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.2.2.1.cmml" xref="S2.E7.m1.1.1.2">superscript</csymbol><apply id="S2.E7.m1.1.1.2.2.2.cmml" xref="S2.E7.m1.1.1.2.2.2"><ci id="S2.E7.m1.1.1.2.2.2.1.cmml" xref="S2.E7.m1.1.1.2.2.2.1">^</ci><ci id="S2.E7.m1.1.1.2.2.2.2a.cmml" xref="S2.E7.m1.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.1.1.2.2.2.2.cmml" xref="S2.E7.m1.1.1.2.2.2.2">e</mtext></ci></apply><ci id="S2.E7.m1.1.1.2.2.3.cmml" xref="S2.E7.m1.1.1.2.2.3">𝑗</ci></apply><apply id="S2.E7.m1.1.1.2.3.cmml" xref="S2.E7.m1.1.1.2.3"><plus id="S2.E7.m1.1.1.2.3.1.cmml" xref="S2.E7.m1.1.1.2.3.1"></plus><ci id="S2.E7.m1.1.1.2.3.2.cmml" xref="S2.E7.m1.1.1.2.3.2">𝑡</ci><cn id="S2.E7.m1.1.1.2.3.3.cmml" type="integer" xref="S2.E7.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E7.m1.1.1.3.cmml" xref="S2.E7.m1.1.1.3"><times id="S2.E7.m1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.3.1"></times><apply id="S2.E7.m1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.2.1.cmml" xref="S2.E7.m1.1.1.3.2">subscript</csymbol><apply id="S2.E7.m1.1.1.3.2.2.cmml" xref="S2.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.2.2.1.cmml" xref="S2.E7.m1.1.1.3.2">superscript</csymbol><ci id="S2.E7.m1.1.1.3.2.2.2a.cmml" xref="S2.E7.m1.1.1.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.1.1.3.2.2.2.cmml" xref="S2.E7.m1.1.1.3.2.2.2">Att</mtext></ci><ci id="S2.E7.m1.1.1.3.2.2.3.cmml" xref="S2.E7.m1.1.1.3.2.2.3">𝑗</ci></apply><apply id="S2.E7.m1.1.1.3.2.3.cmml" xref="S2.E7.m1.1.1.3.2.3"><plus id="S2.E7.m1.1.1.3.2.3.1.cmml" xref="S2.E7.m1.1.1.3.2.3.1"></plus><ci id="S2.E7.m1.1.1.3.2.3.2.cmml" xref="S2.E7.m1.1.1.3.2.3.2">𝑡</ci><cn id="S2.E7.m1.1.1.3.2.3.3.cmml" type="integer" xref="S2.E7.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S2.E7.m1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.3.1.cmml" xref="S2.E7.m1.1.1.3.3">subscript</csymbol><apply id="S2.E7.m1.1.1.3.3.2.cmml" xref="S2.E7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.3.2.1.cmml" xref="S2.E7.m1.1.1.3.3">superscript</csymbol><apply id="S2.E7.m1.1.1.3.3.2.2.cmml" xref="S2.E7.m1.1.1.3.3.2.2"><ci id="S2.E7.m1.1.1.3.3.2.2.1.cmml" xref="S2.E7.m1.1.1.3.3.2.2.1">^</ci><ci id="S2.E7.m1.1.1.3.3.2.2.2a.cmml" xref="S2.E7.m1.1.1.3.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E7.m1.1.1.3.3.2.2.2.cmml" xref="S2.E7.m1.1.1.3.3.2.2.2">V</mtext></ci></apply><ci id="S2.E7.m1.1.1.3.3.2.3.cmml" xref="S2.E7.m1.1.1.3.3.2.3">𝑗</ci></apply><ci id="S2.E7.m1.1.1.3.3.3.cmml" xref="S2.E7.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">{\hat{\textbf{e}}^{j}}_{t+1}=\textbf{Att}^{j}_{t+1}{\hat{\textbf{V}}^{j}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.1d">over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = Att start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT over^ start_ARG V end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS2.p4.9">Notably, each head <math alttext="j" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p4.9.m1.1"><semantics id="S2.SS3.SSS2.p4.9.m1.1a"><mi id="S2.SS3.SSS2.p4.9.m1.1.1" xref="S2.SS3.SSS2.p4.9.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.9.m1.1b"><ci id="S2.SS3.SSS2.p4.9.m1.1.1.cmml" xref="S2.SS3.SSS2.p4.9.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.9.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p4.9.m1.1d">italic_j</annotation></semantics></math> generates a new set of temporal embeddings between the visits. These embeddings are subsequently used for medical intents in the contrastive learning approach (Section <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS4" title="2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">2.4</span></a>).</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p5">
<p class="ltx_p" id="S2.SS3.SSS2.p5.5">The extracted temporal path representation <math alttext="{\hat{\textbf{e}}^{j}}_{t+1}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p5.1.m1.1"><semantics id="S2.SS3.SSS2.p5.1.m1.1a"><mmultiscripts id="S2.SS3.SSS2.p5.1.m1.1.1" xref="S2.SS3.SSS2.p5.1.m1.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p5.1.m1.1.1.2.2" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p5.1.m1.1.1.2.2.2" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.2.2a.cmml">e</mtext><mo id="S2.SS3.SSS2.p5.1.m1.1.1.2.2.1" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS3.SSS2.p5.1.m1.1.1a" xref="S2.SS3.SSS2.p5.1.m1.1.1.cmml"></mrow><mi id="S2.SS3.SSS2.p5.1.m1.1.1.2.3" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.3.cmml">j</mi><mrow id="S2.SS3.SSS2.p5.1.m1.1.1.3" xref="S2.SS3.SSS2.p5.1.m1.1.1.3.cmml"><mi id="S2.SS3.SSS2.p5.1.m1.1.1.3.2" xref="S2.SS3.SSS2.p5.1.m1.1.1.3.2.cmml">t</mi><mo id="S2.SS3.SSS2.p5.1.m1.1.1.3.1" xref="S2.SS3.SSS2.p5.1.m1.1.1.3.1.cmml">+</mo><mn id="S2.SS3.SSS2.p5.1.m1.1.1.3.3" xref="S2.SS3.SSS2.p5.1.m1.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.SS3.SSS2.p5.1.m1.1.1b" xref="S2.SS3.SSS2.p5.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p5.1.m1.1b"><apply id="S2.SS3.SSS2.p5.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p5.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p5.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p5.1.m1.1.1.2.1.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p5.1.m1.1.1.2.2.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.2"><ci id="S2.SS3.SSS2.p5.1.m1.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p5.1.m1.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p5.1.m1.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.2.2">e</mtext></ci></apply><ci id="S2.SS3.SSS2.p5.1.m1.1.1.2.3.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.2.3">𝑗</ci></apply><apply id="S2.SS3.SSS2.p5.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.3"><plus id="S2.SS3.SSS2.p5.1.m1.1.1.3.1.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.3.1"></plus><ci id="S2.SS3.SSS2.p5.1.m1.1.1.3.2.cmml" xref="S2.SS3.SSS2.p5.1.m1.1.1.3.2">𝑡</ci><cn id="S2.SS3.SSS2.p5.1.m1.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS2.p5.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p5.1.m1.1c">{\hat{\textbf{e}}^{j}}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p5.1.m1.1d">over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> is then concatenated with visit-level representation <math alttext="{\hat{\textbf{V}}^{j}_{t+1}}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p5.2.m2.1"><semantics id="S2.SS3.SSS2.p5.2.m2.1a"><msubsup id="S2.SS3.SSS2.p5.2.m2.1.1" xref="S2.SS3.SSS2.p5.2.m2.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p5.2.m2.1.1.2.2" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p5.2.m2.1.1.2.2.2" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.2.2a.cmml">V</mtext><mo id="S2.SS3.SSS2.p5.2.m2.1.1.2.2.1" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS3.SSS2.p5.2.m2.1.1.3" xref="S2.SS3.SSS2.p5.2.m2.1.1.3.cmml"><mi id="S2.SS3.SSS2.p5.2.m2.1.1.3.2" xref="S2.SS3.SSS2.p5.2.m2.1.1.3.2.cmml">t</mi><mo id="S2.SS3.SSS2.p5.2.m2.1.1.3.1" xref="S2.SS3.SSS2.p5.2.m2.1.1.3.1.cmml">+</mo><mn id="S2.SS3.SSS2.p5.2.m2.1.1.3.3" xref="S2.SS3.SSS2.p5.2.m2.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS2.p5.2.m2.1.1.2.3" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p5.2.m2.1b"><apply id="S2.SS3.SSS2.p5.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p5.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p5.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p5.2.m2.1.1.2.1.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p5.2.m2.1.1.2.2.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.2"><ci id="S2.SS3.SSS2.p5.2.m2.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p5.2.m2.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p5.2.m2.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.2.2">V</mtext></ci></apply><ci id="S2.SS3.SSS2.p5.2.m2.1.1.2.3.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.2.3">𝑗</ci></apply><apply id="S2.SS3.SSS2.p5.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.3"><plus id="S2.SS3.SSS2.p5.2.m2.1.1.3.1.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.3.1"></plus><ci id="S2.SS3.SSS2.p5.2.m2.1.1.3.2.cmml" xref="S2.SS3.SSS2.p5.2.m2.1.1.3.2">𝑡</ci><cn id="S2.SS3.SSS2.p5.2.m2.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS2.p5.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p5.2.m2.1c">{\hat{\textbf{V}}^{j}_{t+1}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p5.2.m2.1d">over^ start_ARG V end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, to include both inter and intra-visit code dependencies. Following this concatenation, a linear layer is applied to derive the cross-visit embedding at <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p5.3.m3.1"><semantics id="S2.SS3.SSS2.p5.3.m3.1a"><mrow id="S2.SS3.SSS2.p5.3.m3.1.1" xref="S2.SS3.SSS2.p5.3.m3.1.1.cmml"><mi id="S2.SS3.SSS2.p5.3.m3.1.1.2" xref="S2.SS3.SSS2.p5.3.m3.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p5.3.m3.1.1.1" xref="S2.SS3.SSS2.p5.3.m3.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p5.3.m3.1.1.3" xref="S2.SS3.SSS2.p5.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p5.3.m3.1b"><apply id="S2.SS3.SSS2.p5.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p5.3.m3.1.1"><plus id="S2.SS3.SSS2.p5.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p5.3.m3.1.1.1"></plus><ci id="S2.SS3.SSS2.p5.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p5.3.m3.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p5.3.m3.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p5.3.m3.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p5.3.m3.1d">italic_t + 1</annotation></semantics></math>, as indicated in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E8" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>, where <math alttext="\textbf{W}_{T}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p5.4.m4.1"><semantics id="S2.SS3.SSS2.p5.4.m4.1a"><msub id="S2.SS3.SSS2.p5.4.m4.1.1" xref="S2.SS3.SSS2.p5.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p5.4.m4.1.1.2" xref="S2.SS3.SSS2.p5.4.m4.1.1.2a.cmml">W</mtext><mi id="S2.SS3.SSS2.p5.4.m4.1.1.3" xref="S2.SS3.SSS2.p5.4.m4.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p5.4.m4.1b"><apply id="S2.SS3.SSS2.p5.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p5.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p5.4.m4.1.1.2a.cmml" xref="S2.SS3.SSS2.p5.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p5.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p5.4.m4.1.1.2">W</mtext></ci><ci id="S2.SS3.SSS2.p5.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p5.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p5.4.m4.1c">\textbf{W}_{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p5.4.m4.1d">W start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\in\mathbb{R}^{(2d/J)\times(d/J)}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p5.5.m5.2"><semantics id="S2.SS3.SSS2.p5.5.m5.2a"><mrow id="S2.SS3.SSS2.p5.5.m5.2.3" xref="S2.SS3.SSS2.p5.5.m5.2.3.cmml"><mi id="S2.SS3.SSS2.p5.5.m5.2.3.2" xref="S2.SS3.SSS2.p5.5.m5.2.3.2.cmml"></mi><mo id="S2.SS3.SSS2.p5.5.m5.2.3.1" xref="S2.SS3.SSS2.p5.5.m5.2.3.1.cmml">∈</mo><msup id="S2.SS3.SSS2.p5.5.m5.2.3.3" xref="S2.SS3.SSS2.p5.5.m5.2.3.3.cmml"><mi id="S2.SS3.SSS2.p5.5.m5.2.3.3.2" xref="S2.SS3.SSS2.p5.5.m5.2.3.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p5.5.m5.2.2.2" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.cmml"><mrow id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.cmml"><mo id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.cmml"><mrow id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.cmml"><mn id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.2" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.2.cmml">2</mn><mo id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.1" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.3" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.3.cmml">d</mi></mrow><mo id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.1" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.1.cmml">/</mo><mi id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.3" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.3.cmml">J</mi></mrow><mo id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS3.SSS2.p5.5.m5.2.2.2.3" rspace="0.222em" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.3.cmml">×</mo><mrow id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.cmml"><mo id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.2" stretchy="false" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.cmml"><mi id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.2" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.2.cmml">d</mi><mo id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.1" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.1.cmml">/</mo><mi id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.3" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.3.cmml">J</mi></mrow><mo id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.3" stretchy="false" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p5.5.m5.2b"><apply id="S2.SS3.SSS2.p5.5.m5.2.3.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.3"><in id="S2.SS3.SSS2.p5.5.m5.2.3.1.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.3.1"></in><csymbol cd="latexml" id="S2.SS3.SSS2.p5.5.m5.2.3.2.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.3.2">absent</csymbol><apply id="S2.SS3.SSS2.p5.5.m5.2.3.3.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p5.5.m5.2.3.3.1.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.3.3">superscript</csymbol><ci id="S2.SS3.SSS2.p5.5.m5.2.3.3.2.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.3.3.2">ℝ</ci><apply id="S2.SS3.SSS2.p5.5.m5.2.2.2.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.2.2"><times id="S2.SS3.SSS2.p5.5.m5.2.2.2.3.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.3"></times><apply id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1"><divide id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.1"></divide><apply id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2"><times id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.1"></times><cn id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.2">2</cn><ci id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.2.3">𝑑</ci></apply><ci id="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS2.p5.5.m5.1.1.1.1.1.1.3">𝐽</ci></apply><apply id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1"><divide id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.1.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.1"></divide><ci id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.2.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.2">𝑑</ci><ci id="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.3.cmml" xref="S2.SS3.SSS2.p5.5.m5.2.2.2.2.1.1.3">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p5.5.m5.2c">\in\mathbb{R}^{(2d/J)\times(d/J)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p5.5.m5.2d">∈ blackboard_R start_POSTSUPERSCRIPT ( 2 italic_d / italic_J ) × ( italic_d / italic_J ) end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\hat{\textbf{E}}^{j}}_{t+1}=[{\hat{\textbf{e}}^{j}}_{t+1},{\hat{\textbf{V}}^{%
j}_{t+1}}]\textbf{W}_{T}" class="ltx_Math" display="block" id="S2.E8.m1.2"><semantics id="S2.E8.m1.2a"><mrow id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml"><mmultiscripts id="S2.E8.m1.2.2.4" xref="S2.E8.m1.2.2.4.cmml"><mover accent="true" id="S2.E8.m1.2.2.4.2.2" xref="S2.E8.m1.2.2.4.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.2.2.4.2.2.2" xref="S2.E8.m1.2.2.4.2.2.2a.cmml">E</mtext><mo id="S2.E8.m1.2.2.4.2.2.1" xref="S2.E8.m1.2.2.4.2.2.1.cmml">^</mo></mover><mrow id="S2.E8.m1.2.2.4a" xref="S2.E8.m1.2.2.4.cmml"></mrow><mi id="S2.E8.m1.2.2.4.2.3" xref="S2.E8.m1.2.2.4.2.3.cmml">j</mi><mrow id="S2.E8.m1.2.2.4.3" xref="S2.E8.m1.2.2.4.3.cmml"><mi id="S2.E8.m1.2.2.4.3.2" xref="S2.E8.m1.2.2.4.3.2.cmml">t</mi><mo id="S2.E8.m1.2.2.4.3.1" xref="S2.E8.m1.2.2.4.3.1.cmml">+</mo><mn id="S2.E8.m1.2.2.4.3.3" xref="S2.E8.m1.2.2.4.3.3.cmml">1</mn></mrow><mrow id="S2.E8.m1.2.2.4b" xref="S2.E8.m1.2.2.4.cmml"></mrow></mmultiscripts><mo id="S2.E8.m1.2.2.3" xref="S2.E8.m1.2.2.3.cmml">=</mo><mrow id="S2.E8.m1.2.2.2" xref="S2.E8.m1.2.2.2.cmml"><mrow id="S2.E8.m1.2.2.2.2.2" xref="S2.E8.m1.2.2.2.2.3.cmml"><mo id="S2.E8.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E8.m1.2.2.2.2.3.cmml">[</mo><mmultiscripts id="S2.E8.m1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E8.m1.1.1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.1.1.1.1.1.1.2.2.2" xref="S2.E8.m1.1.1.1.1.1.1.2.2.2a.cmml">e</mtext><mo id="S2.E8.m1.1.1.1.1.1.1.2.2.1" xref="S2.E8.m1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.E8.m1.1.1.1.1.1.1a" xref="S2.E8.m1.1.1.1.1.1.1.cmml"></mrow><mi id="S2.E8.m1.1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S2.E8.m1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.E8.m1.1.1.1.1.1.1.3.1" xref="S2.E8.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S2.E8.m1.1.1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.E8.m1.1.1.1.1.1.1b" xref="S2.E8.m1.1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo id="S2.E8.m1.2.2.2.2.2.4" xref="S2.E8.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E8.m1.2.2.2.2.2.2" xref="S2.E8.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.E8.m1.2.2.2.2.2.2.2.2" xref="S2.E8.m1.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.2.2.2.2.2.2.2.2.2" xref="S2.E8.m1.2.2.2.2.2.2.2.2.2a.cmml">V</mtext><mo id="S2.E8.m1.2.2.2.2.2.2.2.2.1" xref="S2.E8.m1.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S2.E8.m1.2.2.2.2.2.2.3" xref="S2.E8.m1.2.2.2.2.2.2.3.cmml"><mi id="S2.E8.m1.2.2.2.2.2.2.3.2" xref="S2.E8.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S2.E8.m1.2.2.2.2.2.2.3.1" xref="S2.E8.m1.2.2.2.2.2.2.3.1.cmml">+</mo><mn id="S2.E8.m1.2.2.2.2.2.2.3.3" xref="S2.E8.m1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E8.m1.2.2.2.2.2.2.2.3" xref="S2.E8.m1.2.2.2.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S2.E8.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E8.m1.2.2.2.2.3.cmml">]</mo></mrow><mo id="S2.E8.m1.2.2.2.3" xref="S2.E8.m1.2.2.2.3.cmml">⁢</mo><msub id="S2.E8.m1.2.2.2.4" xref="S2.E8.m1.2.2.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.2.2.2.4.2" xref="S2.E8.m1.2.2.2.4.2a.cmml">W</mtext><mi id="S2.E8.m1.2.2.2.4.3" xref="S2.E8.m1.2.2.2.4.3.cmml">T</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.2b"><apply id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2"><eq id="S2.E8.m1.2.2.3.cmml" xref="S2.E8.m1.2.2.3"></eq><apply id="S2.E8.m1.2.2.4.cmml" xref="S2.E8.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.4.1.cmml" xref="S2.E8.m1.2.2.4">subscript</csymbol><apply id="S2.E8.m1.2.2.4.2.cmml" xref="S2.E8.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.4.2.1.cmml" xref="S2.E8.m1.2.2.4">superscript</csymbol><apply id="S2.E8.m1.2.2.4.2.2.cmml" xref="S2.E8.m1.2.2.4.2.2"><ci id="S2.E8.m1.2.2.4.2.2.1.cmml" xref="S2.E8.m1.2.2.4.2.2.1">^</ci><ci id="S2.E8.m1.2.2.4.2.2.2a.cmml" xref="S2.E8.m1.2.2.4.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.2.2.4.2.2.2.cmml" xref="S2.E8.m1.2.2.4.2.2.2">E</mtext></ci></apply><ci id="S2.E8.m1.2.2.4.2.3.cmml" xref="S2.E8.m1.2.2.4.2.3">𝑗</ci></apply><apply id="S2.E8.m1.2.2.4.3.cmml" xref="S2.E8.m1.2.2.4.3"><plus id="S2.E8.m1.2.2.4.3.1.cmml" xref="S2.E8.m1.2.2.4.3.1"></plus><ci id="S2.E8.m1.2.2.4.3.2.cmml" xref="S2.E8.m1.2.2.4.3.2">𝑡</ci><cn id="S2.E8.m1.2.2.4.3.3.cmml" type="integer" xref="S2.E8.m1.2.2.4.3.3">1</cn></apply></apply><apply id="S2.E8.m1.2.2.2.cmml" xref="S2.E8.m1.2.2.2"><times id="S2.E8.m1.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.3"></times><interval closure="closed" id="S2.E8.m1.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2.2"><apply id="S2.E8.m1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2"><ci id="S2.E8.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S2.E8.m1.1.1.1.1.1.1.2.2.2a.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.2.2">e</mtext></ci></apply><ci id="S2.E8.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3"><plus id="S2.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.1"></plus><ci id="S2.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S2.E8.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E8.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E8.m1.2.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E8.m1.2.2.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E8.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.2"><ci id="S2.E8.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E8.m1.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.2.2">V</mtext></ci></apply><ci id="S2.E8.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S2.E8.m1.2.2.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2.2.2.3"><plus id="S2.E8.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E8.m1.2.2.2.2.2.2.3.1"></plus><ci id="S2.E8.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2.3.2">𝑡</ci><cn id="S2.E8.m1.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.E8.m1.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval><apply id="S2.E8.m1.2.2.2.4.cmml" xref="S2.E8.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.4.1.cmml" xref="S2.E8.m1.2.2.2.4">subscript</csymbol><ci id="S2.E8.m1.2.2.2.4.2a.cmml" xref="S2.E8.m1.2.2.2.4.2"><mtext class="ltx_mathvariant_bold" id="S2.E8.m1.2.2.2.4.2.cmml" xref="S2.E8.m1.2.2.2.4.2">W</mtext></ci><ci id="S2.E8.m1.2.2.2.4.3.cmml" xref="S2.E8.m1.2.2.2.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.2c">{\hat{\textbf{E}}^{j}}_{t+1}=[{\hat{\textbf{e}}^{j}}_{t+1},{\hat{\textbf{V}}^{%
j}_{t+1}}]\textbf{W}_{T}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.2d">over^ start_ARG E end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = [ over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , over^ start_ARG V end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ] W start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p6">
<p class="ltx_p" id="S2.SS3.SSS2.p6.4">For further clarification, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.F3" title="Figure 3 ‣ 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, the attention matrix depicted in the figure is based on Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E6" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, where the Query is from time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p6.1.m1.1"><semantics id="S2.SS3.SSS2.p6.1.m1.1a"><mi id="S2.SS3.SSS2.p6.1.m1.1.1" xref="S2.SS3.SSS2.p6.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p6.1.m1.1b"><ci id="S2.SS3.SSS2.p6.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p6.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p6.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p6.1.m1.1d">italic_t</annotation></semantics></math> and the Key from time step <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p6.2.m2.1"><semantics id="S2.SS3.SSS2.p6.2.m2.1a"><mrow id="S2.SS3.SSS2.p6.2.m2.1.1" xref="S2.SS3.SSS2.p6.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p6.2.m2.1.1.2" xref="S2.SS3.SSS2.p6.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p6.2.m2.1.1.1" xref="S2.SS3.SSS2.p6.2.m2.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p6.2.m2.1.1.3" xref="S2.SS3.SSS2.p6.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p6.2.m2.1b"><apply id="S2.SS3.SSS2.p6.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p6.2.m2.1.1"><plus id="S2.SS3.SSS2.p6.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p6.2.m2.1.1.1"></plus><ci id="S2.SS3.SSS2.p6.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p6.2.m2.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p6.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p6.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p6.2.m2.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p6.2.m2.1d">italic_t + 1</annotation></semantics></math>, originating from the Cross-Visit Transformer architecture (Equations <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E3" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E4" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E5" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>). Subsequently, as illustrated in the central part of the figure, the temporal embedding for each prescription at time step <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p6.3.m3.1"><semantics id="S2.SS3.SSS2.p6.3.m3.1a"><mrow id="S2.SS3.SSS2.p6.3.m3.1.1" xref="S2.SS3.SSS2.p6.3.m3.1.1.cmml"><mi id="S2.SS3.SSS2.p6.3.m3.1.1.2" xref="S2.SS3.SSS2.p6.3.m3.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p6.3.m3.1.1.1" xref="S2.SS3.SSS2.p6.3.m3.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p6.3.m3.1.1.3" xref="S2.SS3.SSS2.p6.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p6.3.m3.1b"><apply id="S2.SS3.SSS2.p6.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p6.3.m3.1.1"><plus id="S2.SS3.SSS2.p6.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p6.3.m3.1.1.1"></plus><ci id="S2.SS3.SSS2.p6.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p6.3.m3.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p6.3.m3.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p6.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p6.3.m3.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p6.3.m3.1d">italic_t + 1</annotation></semantics></math> is extracted (Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E7" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>), and these embeddings are then concatenated with the Value matrix from the Visit-Level Transformer output (denoted by the green box) to obtain the final embedding for prescriptions at <math alttext="t+1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p6.4.m4.1"><semantics id="S2.SS3.SSS2.p6.4.m4.1a"><mrow id="S2.SS3.SSS2.p6.4.m4.1.1" xref="S2.SS3.SSS2.p6.4.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p6.4.m4.1.1.2" xref="S2.SS3.SSS2.p6.4.m4.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p6.4.m4.1.1.1" xref="S2.SS3.SSS2.p6.4.m4.1.1.1.cmml">+</mo><mn id="S2.SS3.SSS2.p6.4.m4.1.1.3" xref="S2.SS3.SSS2.p6.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p6.4.m4.1b"><apply id="S2.SS3.SSS2.p6.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p6.4.m4.1.1"><plus id="S2.SS3.SSS2.p6.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p6.4.m4.1.1.1"></plus><ci id="S2.SS3.SSS2.p6.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p6.4.m4.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p6.4.m4.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p6.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p6.4.m4.1c">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p6.4.m4.1d">italic_t + 1</annotation></semantics></math>. (Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E8" title="In 2.3.2. Cross-Visit Transformer ‣ 2.3. Temporal Paths Representation ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>). The attention matrix and output of the Cross-Visit Transformer represent the temporal paths between inter-visit prescriptions based on consecutive visits.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSS2.p7">
<p class="ltx_p" id="S2.SS3.SSS2.p7.6">The embedding from all time steps for a batch of patients can be represented as <math alttext="{\hat{\textbf{E}}^{j}}=\langle\hat{\textbf{E}}^{j}_{1},\hat{\textbf{E}}^{j}_{2%
},\dots,\hat{\textbf{E}}^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times L_{B}%
\times d/J}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p7.1.m1.4"><semantics id="S2.SS3.SSS2.p7.1.m1.4a"><mrow id="S2.SS3.SSS2.p7.1.m1.4.4" xref="S2.SS3.SSS2.p7.1.m1.4.4.cmml"><msup id="S2.SS3.SSS2.p7.1.m1.4.4.5" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.cmml"><mover accent="true" id="S2.SS3.SSS2.p7.1.m1.4.4.5.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.4.4.5.2.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.2.2a.cmml">E</mtext><mo id="S2.SS3.SSS2.p7.1.m1.4.4.5.2.1" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p7.1.m1.4.4.5.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.3.cmml">j</mi></msup><mo id="S2.SS3.SSS2.p7.1.m1.4.4.6" xref="S2.SS3.SSS2.p7.1.m1.4.4.6.cmml">=</mo><mrow id="S2.SS3.SSS2.p7.1.m1.4.4.3.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.4.cmml"><mo id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.4.cmml">⟨</mo><msubsup id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.2" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.2a.cmml">E</mtext><mo id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.1" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.3" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.3.cmml">1</mn><mi id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.3" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.5" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.cmml"><mover accent="true" id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.2" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.2a.cmml">E</mtext><mo id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.1" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.3" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.3" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.6" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS3.SSS2.p7.1.m1.1.1" mathvariant="normal" xref="S2.SS3.SSS2.p7.1.m1.1.1.cmml">…</mi><mo id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.7" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.cmml"><mover accent="true" id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.2a.cmml">E</mtext><mo id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.1" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.3.cmml">T</mi><mi id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.4.cmml">⟩</mo></mrow><mo id="S2.SS3.SSS2.p7.1.m1.4.4.7" xref="S2.SS3.SSS2.p7.1.m1.4.4.7.cmml">∈</mo><msup id="S2.SS3.SSS2.p7.1.m1.4.4.8" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.cmml"><mi id="S2.SS3.SSS2.p7.1.m1.4.4.8.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p7.1.m1.4.4.8.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.cmml"><mrow id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.cmml"><mi id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.2.cmml">B</mi><mo id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.3.cmml">T</mi><mo id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1.cmml">×</mo><msub id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.cmml"><mi id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.2" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.2.cmml">L</mi><mi id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.3.cmml">B</mi></msub><mo id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1b" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.5" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.5.cmml">d</mi></mrow><mo id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.1" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.1.cmml">/</mo><mi id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.3" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p7.1.m1.4b"><apply id="S2.SS3.SSS2.p7.1.m1.4.4.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4"><and id="S2.SS3.SSS2.p7.1.m1.4.4a.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4"></and><apply id="S2.SS3.SSS2.p7.1.m1.4.4b.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4"><eq id="S2.SS3.SSS2.p7.1.m1.4.4.6.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.6"></eq><apply id="S2.SS3.SSS2.p7.1.m1.4.4.5.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.5"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.4.4.5.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.5">superscript</csymbol><apply id="S2.SS3.SSS2.p7.1.m1.4.4.5.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.2"><ci id="S2.SS3.SSS2.p7.1.m1.4.4.5.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.2.1">^</ci><ci id="S2.SS3.SSS2.p7.1.m1.4.4.5.2.2a.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.4.4.5.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.2.2">E</mtext></ci></apply><ci id="S2.SS3.SSS2.p7.1.m1.4.4.5.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.5.3">𝑗</ci></apply><list id="S2.SS3.SSS2.p7.1.m1.4.4.3.4.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3"><apply id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2"><ci id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.1">^</ci><ci id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.2a.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.2.2">E</mtext></ci></apply><ci id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p7.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2"><ci id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.1">^</ci><ci id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.2a.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.2.2">E</mtext></ci></apply><ci id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS2.p7.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS2.p7.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.1.1">…</ci><apply id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2"><ci id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.1">^</ci><ci id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.2a.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.2.2">E</mtext></ci></apply><ci id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.2.3">𝑗</ci></apply><ci id="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.3.3.3.3">𝑇</ci></apply></list></apply><apply id="S2.SS3.SSS2.p7.1.m1.4.4c.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4"><in id="S2.SS3.SSS2.p7.1.m1.4.4.7.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.7"></in><share href="https://arxiv.org/html/2408.10259v1#S2.SS3.SSS2.p7.1.m1.4.4.3.cmml" id="S2.SS3.SSS2.p7.1.m1.4.4d.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4"></share><apply id="S2.SS3.SSS2.p7.1.m1.4.4.8.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.4.4.8.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8">superscript</csymbol><ci id="S2.SS3.SSS2.p7.1.m1.4.4.8.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.2">ℝ</ci><apply id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3"><divide id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.1"></divide><apply id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2"><times id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.1"></times><ci id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.2">𝐵</ci><ci id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.3">𝑇</ci><apply id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.1.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4">subscript</csymbol><ci id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.2.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.2">𝐿</ci><ci id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.4.3">𝐵</ci></apply><ci id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.5.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.2.5">𝑑</ci></apply><ci id="S2.SS3.SSS2.p7.1.m1.4.4.8.3.3.cmml" xref="S2.SS3.SSS2.p7.1.m1.4.4.8.3.3">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p7.1.m1.4c">{\hat{\textbf{E}}^{j}}=\langle\hat{\textbf{E}}^{j}_{1},\hat{\textbf{E}}^{j}_{2%
},\dots,\hat{\textbf{E}}^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times L_{B}%
\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p7.1.m1.4d">over^ start_ARG E end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT = ⟨ over^ start_ARG E end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over^ start_ARG E end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , over^ start_ARG E end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ⟩ ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_T × italic_L start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>. For <math alttext="t=1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p7.2.m2.1"><semantics id="S2.SS3.SSS2.p7.2.m2.1a"><mrow id="S2.SS3.SSS2.p7.2.m2.1.1" xref="S2.SS3.SSS2.p7.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p7.2.m2.1.1.2" xref="S2.SS3.SSS2.p7.2.m2.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p7.2.m2.1.1.1" xref="S2.SS3.SSS2.p7.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS3.SSS2.p7.2.m2.1.1.3" xref="S2.SS3.SSS2.p7.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p7.2.m2.1b"><apply id="S2.SS3.SSS2.p7.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p7.2.m2.1.1"><eq id="S2.SS3.SSS2.p7.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p7.2.m2.1.1.1"></eq><ci id="S2.SS3.SSS2.p7.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p7.2.m2.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p7.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p7.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p7.2.m2.1c">t=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p7.2.m2.1d">italic_t = 1</annotation></semantics></math>, where incoming attention is absent, the Visit-Level Transformer output is utilized, and <math alttext="\hat{\textbf{E}}^{j}_{1}=\textbf{E}^{j}_{1}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p7.3.m3.1"><semantics id="S2.SS3.SSS2.p7.3.m3.1a"><mrow id="S2.SS3.SSS2.p7.3.m3.1.1" xref="S2.SS3.SSS2.p7.3.m3.1.1.cmml"><msubsup id="S2.SS3.SSS2.p7.3.m3.1.1.2" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.cmml"><mover accent="true" id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.2" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.2a.cmml">E</mtext><mo id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.1" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS2.p7.3.m3.1.1.2.3" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.3.cmml">1</mn><mi id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.3" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.3.cmml">j</mi></msubsup><mo id="S2.SS3.SSS2.p7.3.m3.1.1.1" xref="S2.SS3.SSS2.p7.3.m3.1.1.1.cmml">=</mo><msubsup id="S2.SS3.SSS2.p7.3.m3.1.1.3" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.3.m3.1.1.3.2.2" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.2.2a.cmml">E</mtext><mn id="S2.SS3.SSS2.p7.3.m3.1.1.3.3" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.3.cmml">1</mn><mi id="S2.SS3.SSS2.p7.3.m3.1.1.3.2.3" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.2.3.cmml">j</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p7.3.m3.1b"><apply id="S2.SS3.SSS2.p7.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1"><eq id="S2.SS3.SSS2.p7.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.1"></eq><apply id="S2.SS3.SSS2.p7.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.3.m3.1.1.2.1.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2">subscript</csymbol><apply id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2">superscript</csymbol><apply id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2"><ci id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.1.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.1">^</ci><ci id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.2a.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.2.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.2.2">E</mtext></ci></apply><ci id="S2.SS3.SSS2.p7.3.m3.1.1.2.2.3.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS2.p7.3.m3.1.1.2.3.cmml" type="integer" xref="S2.SS3.SSS2.p7.3.m3.1.1.2.3">1</cn></apply><apply id="S2.SS3.SSS2.p7.3.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.3.m3.1.1.3.1.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.3">subscript</csymbol><apply id="S2.SS3.SSS2.p7.3.m3.1.1.3.2.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p7.3.m3.1.1.3.2.1.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS3.SSS2.p7.3.m3.1.1.3.2.2a.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.SSS2.p7.3.m3.1.1.3.2.2.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.2.2">E</mtext></ci><ci id="S2.SS3.SSS2.p7.3.m3.1.1.3.2.3.cmml" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.2.3">𝑗</ci></apply><cn id="S2.SS3.SSS2.p7.3.m3.1.1.3.3.cmml" type="integer" xref="S2.SS3.SSS2.p7.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p7.3.m3.1c">\hat{\textbf{E}}^{j}_{1}=\textbf{E}^{j}_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p7.3.m3.1d">over^ start_ARG E end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. Notably, with this approach, the Cross-Visit Transformer at a given time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p7.4.m4.1"><semantics id="S2.SS3.SSS2.p7.4.m4.1a"><mi id="S2.SS3.SSS2.p7.4.m4.1.1" xref="S2.SS3.SSS2.p7.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p7.4.m4.1b"><ci id="S2.SS3.SSS2.p7.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p7.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p7.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p7.4.m4.1d">italic_t</annotation></semantics></math> takes into account the impact of prescription codes from <math alttext="t=1" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p7.5.m5.1"><semantics id="S2.SS3.SSS2.p7.5.m5.1a"><mrow id="S2.SS3.SSS2.p7.5.m5.1.1" xref="S2.SS3.SSS2.p7.5.m5.1.1.cmml"><mi id="S2.SS3.SSS2.p7.5.m5.1.1.2" xref="S2.SS3.SSS2.p7.5.m5.1.1.2.cmml">t</mi><mo id="S2.SS3.SSS2.p7.5.m5.1.1.1" xref="S2.SS3.SSS2.p7.5.m5.1.1.1.cmml">=</mo><mn id="S2.SS3.SSS2.p7.5.m5.1.1.3" xref="S2.SS3.SSS2.p7.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p7.5.m5.1b"><apply id="S2.SS3.SSS2.p7.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p7.5.m5.1.1"><eq id="S2.SS3.SSS2.p7.5.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p7.5.m5.1.1.1"></eq><ci id="S2.SS3.SSS2.p7.5.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p7.5.m5.1.1.2">𝑡</ci><cn id="S2.SS3.SSS2.p7.5.m5.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p7.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p7.5.m5.1c">t=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p7.5.m5.1d">italic_t = 1</annotation></semantics></math> to <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p7.6.m6.1"><semantics id="S2.SS3.SSS2.p7.6.m6.1a"><mi id="S2.SS3.SSS2.p7.6.m6.1.1" xref="S2.SS3.SSS2.p7.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p7.6.m6.1b"><ci id="S2.SS3.SSS2.p7.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p7.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p7.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p7.6.m6.1d">italic_t</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="129" id="S2.F3.g1" src="x2.png" width="463"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F3.6.3.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S2.F3.4.2" style="font-size:90%;">The Cross-Visit Transformer generates a temporal attention matrix, where prescription embeddings at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.F3.3.1.m1.1"><semantics id="S2.F3.3.1.m1.1b"><mi id="S2.F3.3.1.m1.1.1" xref="S2.F3.3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F3.3.1.m1.1c"><ci id="S2.F3.3.1.m1.1.1.cmml" xref="S2.F3.3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.3.1.m1.1d">t</annotation><annotation encoding="application/x-llamapun" id="S2.F3.3.1.m1.1e">italic_t</annotation></semantics></math> are multiplied by the attention matrix and shared with prescriptions at time step <math alttext="t+1" class="ltx_Math" display="inline" id="S2.F3.4.2.m2.1"><semantics id="S2.F3.4.2.m2.1b"><mrow id="S2.F3.4.2.m2.1.1" xref="S2.F3.4.2.m2.1.1.cmml"><mi id="S2.F3.4.2.m2.1.1.2" xref="S2.F3.4.2.m2.1.1.2.cmml">t</mi><mo id="S2.F3.4.2.m2.1.1.1" xref="S2.F3.4.2.m2.1.1.1.cmml">+</mo><mn id="S2.F3.4.2.m2.1.1.3" xref="S2.F3.4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.4.2.m2.1c"><apply id="S2.F3.4.2.m2.1.1.cmml" xref="S2.F3.4.2.m2.1.1"><plus id="S2.F3.4.2.m2.1.1.1.cmml" xref="S2.F3.4.2.m2.1.1.1"></plus><ci id="S2.F3.4.2.m2.1.1.2.cmml" xref="S2.F3.4.2.m2.1.1.2">𝑡</ci><cn id="S2.F3.4.2.m2.1.1.3.cmml" type="integer" xref="S2.F3.4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.4.2.m2.1d">t+1</annotation><annotation encoding="application/x-llamapun" id="S2.F3.4.2.m2.1e">italic_t + 1</annotation></semantics></math>. The figure illustrates the temporal attention generation for a single prescription.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4. </span>Contrasted Intents</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">We extracted multiple representations from attention heads in both Transformer encoders, capturing visit-level and cross-visit relationship embeddings shared among medications. Although this multi-head approach is capable of generating different temporal paths, a challenge still remains that the temporal paths associated with different attention heads are not necessarily distinct therefore may fail to represent a comprehensive range of medical intents. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S1.F1" title="Figure 1 ‣ ntroduction ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, the purposes of prescribing a series of drugs are different, and each of them is associated with a specific intent. To incorporate this concept, we link each Transformer head to a specific medical intent, ensuring that multiple heads represent different considerations of a patient’s health condition. Consequently, temporal paths become more medically meaningful. To achieve this, these intents and Transformer heads need to be distinct from each other to cover all the possible health profiles. Furthermore, non-distinct heads can also lead to overlapping embedding spaces, resulting in suboptimal model performance <cite class="ltx_cite ltx_citemacro_citep">(Michel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib22" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">Based on this motivation, a form of regularization is needed to address two key challenges: (1) ensuring the heads are distinct so the model covers the comprehensive medical aspects (such as diseases related to the heart and kidney as two different organ systems) of a complex health history, and (2) maintaining the semantics in representation, where each head is associated with a specialized medical aspect, utilizing multiple medical intents to identify medications for the recommendation.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.6">Inspired by the application of contrastive learning in intent-aware recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib9" title="">2022</a>; Zou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib47" title="">2022</a>)</cite> and the generalization advantage of having distinct heads <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib45" title="">2023b</a>)</cite>, we propose a novel approach for intent-aware prescription recommendation systems.
First,
we need to formulate the intents that can be extracted from a patient’s entire visits.
Our approach proposes to learn the intents in a computational way. Since each head is set to represent a unique intent, the number of intents equals to the number of heads. We will define <math alttext="J" class="ltx_Math" display="inline" id="S2.SS4.p3.1.m1.1"><semantics id="S2.SS4.p3.1.m1.1a"><mi id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><ci id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">italic_J</annotation></semantics></math> linear layer blocks, each outputs a general embedding based on the patient profile as an intent. The input of these linear layers is <math alttext="\hat{\textbf{P}}_{t}\in\mathbb{R}^{B\times d}" class="ltx_Math" display="inline" id="S2.SS4.p3.2.m2.1"><semantics id="S2.SS4.p3.2.m2.1a"><mrow id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml"><msub id="S2.SS4.p3.2.m2.1.1.2" xref="S2.SS4.p3.2.m2.1.1.2.cmml"><mover accent="true" id="S2.SS4.p3.2.m2.1.1.2.2" xref="S2.SS4.p3.2.m2.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.2.m2.1.1.2.2.2" xref="S2.SS4.p3.2.m2.1.1.2.2.2a.cmml">P</mtext><mo id="S2.SS4.p3.2.m2.1.1.2.2.1" xref="S2.SS4.p3.2.m2.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.SS4.p3.2.m2.1.1.2.3" xref="S2.SS4.p3.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S2.SS4.p3.2.m2.1.1.1" xref="S2.SS4.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS4.p3.2.m2.1.1.3" xref="S2.SS4.p3.2.m2.1.1.3.cmml"><mi id="S2.SS4.p3.2.m2.1.1.3.2" xref="S2.SS4.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p3.2.m2.1.1.3.3" xref="S2.SS4.p3.2.m2.1.1.3.3.cmml"><mi id="S2.SS4.p3.2.m2.1.1.3.3.2" xref="S2.SS4.p3.2.m2.1.1.3.3.2.cmml">B</mi><mo id="S2.SS4.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.p3.2.m2.1.1.3.3.3" xref="S2.SS4.p3.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><apply id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1"><in id="S2.SS4.p3.2.m2.1.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1.1"></in><apply id="S2.SS4.p3.2.m2.1.1.2.cmml" xref="S2.SS4.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p3.2.m2.1.1.2.1.cmml" xref="S2.SS4.p3.2.m2.1.1.2">subscript</csymbol><apply id="S2.SS4.p3.2.m2.1.1.2.2.cmml" xref="S2.SS4.p3.2.m2.1.1.2.2"><ci id="S2.SS4.p3.2.m2.1.1.2.2.1.cmml" xref="S2.SS4.p3.2.m2.1.1.2.2.1">^</ci><ci id="S2.SS4.p3.2.m2.1.1.2.2.2a.cmml" xref="S2.SS4.p3.2.m2.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.2.m2.1.1.2.2.2.cmml" xref="S2.SS4.p3.2.m2.1.1.2.2.2">P</mtext></ci></apply><ci id="S2.SS4.p3.2.m2.1.1.2.3.cmml" xref="S2.SS4.p3.2.m2.1.1.2.3">𝑡</ci></apply><apply id="S2.SS4.p3.2.m2.1.1.3.cmml" xref="S2.SS4.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p3.2.m2.1.1.3.1.cmml" xref="S2.SS4.p3.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS4.p3.2.m2.1.1.3.2.cmml" xref="S2.SS4.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS4.p3.2.m2.1.1.3.3.cmml" xref="S2.SS4.p3.2.m2.1.1.3.3"><times id="S2.SS4.p3.2.m2.1.1.3.3.1.cmml" xref="S2.SS4.p3.2.m2.1.1.3.3.1"></times><ci id="S2.SS4.p3.2.m2.1.1.3.3.2.cmml" xref="S2.SS4.p3.2.m2.1.1.3.3.2">𝐵</ci><ci id="S2.SS4.p3.2.m2.1.1.3.3.3.cmml" xref="S2.SS4.p3.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">\hat{\textbf{P}}_{t}\in\mathbb{R}^{B\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.2.m2.1d">over^ start_ARG P end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> which is the overall embedding obtained by summing up all the code embeddings in <math alttext="\textbf{P}_{t}" class="ltx_Math" display="inline" id="S2.SS4.p3.3.m3.1"><semantics id="S2.SS4.p3.3.m3.1a"><msub id="S2.SS4.p3.3.m3.1.1" xref="S2.SS4.p3.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.3.m3.1.1.2" xref="S2.SS4.p3.3.m3.1.1.2a.cmml">P</mtext><mi id="S2.SS4.p3.3.m3.1.1.3" xref="S2.SS4.p3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.3.m3.1b"><apply id="S2.SS4.p3.3.m3.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.3.m3.1.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p3.3.m3.1.1.2a.cmml" xref="S2.SS4.p3.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.3.m3.1.1.2.cmml" xref="S2.SS4.p3.3.m3.1.1.2">P</mtext></ci><ci id="S2.SS4.p3.3.m3.1.1.3.cmml" xref="S2.SS4.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.3.m3.1c">\textbf{P}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.3.m3.1d">P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The output, as shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E9" title="In 2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>, are intent representations where <math alttext="j\in\{1,2,...,J" class="ltx_math_unparsed" display="inline" id="S2.SS4.p3.4.m4.4"><semantics id="S2.SS4.p3.4.m4.4a"><mrow id="S2.SS4.p3.4.m4.4b"><mi id="S2.SS4.p3.4.m4.4.5">j</mi><mo id="S2.SS4.p3.4.m4.4.6">∈</mo><mrow id="S2.SS4.p3.4.m4.4.7"><mo id="S2.SS4.p3.4.m4.4.7.1" stretchy="false">{</mo><mn id="S2.SS4.p3.4.m4.1.1">1</mn><mo id="S2.SS4.p3.4.m4.4.7.2">,</mo><mn id="S2.SS4.p3.4.m4.2.2">2</mn><mo id="S2.SS4.p3.4.m4.4.7.3">,</mo><mi id="S2.SS4.p3.4.m4.3.3" mathvariant="normal">…</mi><mo id="S2.SS4.p3.4.m4.4.7.4">,</mo><mi id="S2.SS4.p3.4.m4.4.4">J</mi></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS4.p3.4.m4.4c">j\in\{1,2,...,J</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.4.m4.4d">italic_j ∈ { 1 , 2 , … , italic_J</annotation></semantics></math>}, and <math alttext="\textbf{W}^{j}_{I}\in\mathbb{R}^{d\times d/J}" class="ltx_Math" display="inline" id="S2.SS4.p3.5.m5.1"><semantics id="S2.SS4.p3.5.m5.1a"><mrow id="S2.SS4.p3.5.m5.1.1" xref="S2.SS4.p3.5.m5.1.1.cmml"><msubsup id="S2.SS4.p3.5.m5.1.1.2" xref="S2.SS4.p3.5.m5.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.5.m5.1.1.2.2.2" xref="S2.SS4.p3.5.m5.1.1.2.2.2a.cmml">W</mtext><mi id="S2.SS4.p3.5.m5.1.1.2.3" xref="S2.SS4.p3.5.m5.1.1.2.3.cmml">I</mi><mi id="S2.SS4.p3.5.m5.1.1.2.2.3" xref="S2.SS4.p3.5.m5.1.1.2.2.3.cmml">j</mi></msubsup><mo id="S2.SS4.p3.5.m5.1.1.1" xref="S2.SS4.p3.5.m5.1.1.1.cmml">∈</mo><msup id="S2.SS4.p3.5.m5.1.1.3" xref="S2.SS4.p3.5.m5.1.1.3.cmml"><mi id="S2.SS4.p3.5.m5.1.1.3.2" xref="S2.SS4.p3.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p3.5.m5.1.1.3.3" xref="S2.SS4.p3.5.m5.1.1.3.3.cmml"><mrow id="S2.SS4.p3.5.m5.1.1.3.3.2" xref="S2.SS4.p3.5.m5.1.1.3.3.2.cmml"><mi id="S2.SS4.p3.5.m5.1.1.3.3.2.2" xref="S2.SS4.p3.5.m5.1.1.3.3.2.2.cmml">d</mi><mo id="S2.SS4.p3.5.m5.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p3.5.m5.1.1.3.3.2.1.cmml">×</mo><mi id="S2.SS4.p3.5.m5.1.1.3.3.2.3" xref="S2.SS4.p3.5.m5.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="S2.SS4.p3.5.m5.1.1.3.3.1" xref="S2.SS4.p3.5.m5.1.1.3.3.1.cmml">/</mo><mi id="S2.SS4.p3.5.m5.1.1.3.3.3" xref="S2.SS4.p3.5.m5.1.1.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.5.m5.1b"><apply id="S2.SS4.p3.5.m5.1.1.cmml" xref="S2.SS4.p3.5.m5.1.1"><in id="S2.SS4.p3.5.m5.1.1.1.cmml" xref="S2.SS4.p3.5.m5.1.1.1"></in><apply id="S2.SS4.p3.5.m5.1.1.2.cmml" xref="S2.SS4.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p3.5.m5.1.1.2.1.cmml" xref="S2.SS4.p3.5.m5.1.1.2">subscript</csymbol><apply id="S2.SS4.p3.5.m5.1.1.2.2.cmml" xref="S2.SS4.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p3.5.m5.1.1.2.2.1.cmml" xref="S2.SS4.p3.5.m5.1.1.2">superscript</csymbol><ci id="S2.SS4.p3.5.m5.1.1.2.2.2a.cmml" xref="S2.SS4.p3.5.m5.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.5.m5.1.1.2.2.2.cmml" xref="S2.SS4.p3.5.m5.1.1.2.2.2">W</mtext></ci><ci id="S2.SS4.p3.5.m5.1.1.2.2.3.cmml" xref="S2.SS4.p3.5.m5.1.1.2.2.3">𝑗</ci></apply><ci id="S2.SS4.p3.5.m5.1.1.2.3.cmml" xref="S2.SS4.p3.5.m5.1.1.2.3">𝐼</ci></apply><apply id="S2.SS4.p3.5.m5.1.1.3.cmml" xref="S2.SS4.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p3.5.m5.1.1.3.1.cmml" xref="S2.SS4.p3.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS4.p3.5.m5.1.1.3.2.cmml" xref="S2.SS4.p3.5.m5.1.1.3.2">ℝ</ci><apply id="S2.SS4.p3.5.m5.1.1.3.3.cmml" xref="S2.SS4.p3.5.m5.1.1.3.3"><divide id="S2.SS4.p3.5.m5.1.1.3.3.1.cmml" xref="S2.SS4.p3.5.m5.1.1.3.3.1"></divide><apply id="S2.SS4.p3.5.m5.1.1.3.3.2.cmml" xref="S2.SS4.p3.5.m5.1.1.3.3.2"><times id="S2.SS4.p3.5.m5.1.1.3.3.2.1.cmml" xref="S2.SS4.p3.5.m5.1.1.3.3.2.1"></times><ci id="S2.SS4.p3.5.m5.1.1.3.3.2.2.cmml" xref="S2.SS4.p3.5.m5.1.1.3.3.2.2">𝑑</ci><ci id="S2.SS4.p3.5.m5.1.1.3.3.2.3.cmml" xref="S2.SS4.p3.5.m5.1.1.3.3.2.3">𝑑</ci></apply><ci id="S2.SS4.p3.5.m5.1.1.3.3.3.cmml" xref="S2.SS4.p3.5.m5.1.1.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.5.m5.1c">\textbf{W}^{j}_{I}\in\mathbb{R}^{d\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.5.m5.1d">W start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>. Every intent from all time steps for a single patient can be represented as <math alttext="{\textbf{Intent}^{j}}=\langle\textbf{Intent}^{j}_{1},\textbf{Intent}^{j}_{2},%
\dots,\textbf{Intent}^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times d/J}" class="ltx_Math" display="inline" id="S2.SS4.p3.6.m6.4"><semantics id="S2.SS4.p3.6.m6.4a"><mrow id="S2.SS4.p3.6.m6.4.4" xref="S2.SS4.p3.6.m6.4.4.cmml"><msup id="S2.SS4.p3.6.m6.4.4.5" xref="S2.SS4.p3.6.m6.4.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.4.4.5.2" xref="S2.SS4.p3.6.m6.4.4.5.2a.cmml">Intent</mtext><mi id="S2.SS4.p3.6.m6.4.4.5.3" xref="S2.SS4.p3.6.m6.4.4.5.3.cmml">j</mi></msup><mo id="S2.SS4.p3.6.m6.4.4.6" xref="S2.SS4.p3.6.m6.4.4.6.cmml">=</mo><mrow id="S2.SS4.p3.6.m6.4.4.3.3" xref="S2.SS4.p3.6.m6.4.4.3.4.cmml"><mo id="S2.SS4.p3.6.m6.4.4.3.3.4" stretchy="false" xref="S2.SS4.p3.6.m6.4.4.3.4.cmml">⟨</mo><msubsup id="S2.SS4.p3.6.m6.2.2.1.1.1" xref="S2.SS4.p3.6.m6.2.2.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.2.2.1.1.1.2.2" xref="S2.SS4.p3.6.m6.2.2.1.1.1.2.2a.cmml">Intent</mtext><mn id="S2.SS4.p3.6.m6.2.2.1.1.1.3" xref="S2.SS4.p3.6.m6.2.2.1.1.1.3.cmml">1</mn><mi id="S2.SS4.p3.6.m6.2.2.1.1.1.2.3" xref="S2.SS4.p3.6.m6.2.2.1.1.1.2.3.cmml">j</mi></msubsup><mo id="S2.SS4.p3.6.m6.4.4.3.3.5" xref="S2.SS4.p3.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S2.SS4.p3.6.m6.3.3.2.2.2" xref="S2.SS4.p3.6.m6.3.3.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.3.3.2.2.2.2.2" xref="S2.SS4.p3.6.m6.3.3.2.2.2.2.2a.cmml">Intent</mtext><mn id="S2.SS4.p3.6.m6.3.3.2.2.2.3" xref="S2.SS4.p3.6.m6.3.3.2.2.2.3.cmml">2</mn><mi id="S2.SS4.p3.6.m6.3.3.2.2.2.2.3" xref="S2.SS4.p3.6.m6.3.3.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S2.SS4.p3.6.m6.4.4.3.3.6" xref="S2.SS4.p3.6.m6.4.4.3.4.cmml">,</mo><mi id="S2.SS4.p3.6.m6.1.1" mathvariant="normal" xref="S2.SS4.p3.6.m6.1.1.cmml">…</mi><mo id="S2.SS4.p3.6.m6.4.4.3.3.7" xref="S2.SS4.p3.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S2.SS4.p3.6.m6.4.4.3.3.3" xref="S2.SS4.p3.6.m6.4.4.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.4.4.3.3.3.2.2" xref="S2.SS4.p3.6.m6.4.4.3.3.3.2.2a.cmml">Intent</mtext><mi id="S2.SS4.p3.6.m6.4.4.3.3.3.3" xref="S2.SS4.p3.6.m6.4.4.3.3.3.3.cmml">T</mi><mi id="S2.SS4.p3.6.m6.4.4.3.3.3.2.3" xref="S2.SS4.p3.6.m6.4.4.3.3.3.2.3.cmml">j</mi></msubsup><mo id="S2.SS4.p3.6.m6.4.4.3.3.8" stretchy="false" xref="S2.SS4.p3.6.m6.4.4.3.4.cmml">⟩</mo></mrow><mo id="S2.SS4.p3.6.m6.4.4.7" xref="S2.SS4.p3.6.m6.4.4.7.cmml">∈</mo><msup id="S2.SS4.p3.6.m6.4.4.8" xref="S2.SS4.p3.6.m6.4.4.8.cmml"><mi id="S2.SS4.p3.6.m6.4.4.8.2" xref="S2.SS4.p3.6.m6.4.4.8.2.cmml">ℝ</mi><mrow id="S2.SS4.p3.6.m6.4.4.8.3" xref="S2.SS4.p3.6.m6.4.4.8.3.cmml"><mrow id="S2.SS4.p3.6.m6.4.4.8.3.2" xref="S2.SS4.p3.6.m6.4.4.8.3.2.cmml"><mi id="S2.SS4.p3.6.m6.4.4.8.3.2.2" xref="S2.SS4.p3.6.m6.4.4.8.3.2.2.cmml">B</mi><mo id="S2.SS4.p3.6.m6.4.4.8.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p3.6.m6.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS4.p3.6.m6.4.4.8.3.2.3" xref="S2.SS4.p3.6.m6.4.4.8.3.2.3.cmml">T</mi><mo id="S2.SS4.p3.6.m6.4.4.8.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p3.6.m6.4.4.8.3.2.1.cmml">×</mo><mi id="S2.SS4.p3.6.m6.4.4.8.3.2.4" xref="S2.SS4.p3.6.m6.4.4.8.3.2.4.cmml">d</mi></mrow><mo id="S2.SS4.p3.6.m6.4.4.8.3.1" xref="S2.SS4.p3.6.m6.4.4.8.3.1.cmml">/</mo><mi id="S2.SS4.p3.6.m6.4.4.8.3.3" xref="S2.SS4.p3.6.m6.4.4.8.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.6.m6.4b"><apply id="S2.SS4.p3.6.m6.4.4.cmml" xref="S2.SS4.p3.6.m6.4.4"><and id="S2.SS4.p3.6.m6.4.4a.cmml" xref="S2.SS4.p3.6.m6.4.4"></and><apply id="S2.SS4.p3.6.m6.4.4b.cmml" xref="S2.SS4.p3.6.m6.4.4"><eq id="S2.SS4.p3.6.m6.4.4.6.cmml" xref="S2.SS4.p3.6.m6.4.4.6"></eq><apply id="S2.SS4.p3.6.m6.4.4.5.cmml" xref="S2.SS4.p3.6.m6.4.4.5"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.4.4.5.1.cmml" xref="S2.SS4.p3.6.m6.4.4.5">superscript</csymbol><ci id="S2.SS4.p3.6.m6.4.4.5.2a.cmml" xref="S2.SS4.p3.6.m6.4.4.5.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.4.4.5.2.cmml" xref="S2.SS4.p3.6.m6.4.4.5.2">Intent</mtext></ci><ci id="S2.SS4.p3.6.m6.4.4.5.3.cmml" xref="S2.SS4.p3.6.m6.4.4.5.3">𝑗</ci></apply><list id="S2.SS4.p3.6.m6.4.4.3.4.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3"><apply id="S2.SS4.p3.6.m6.2.2.1.1.1.cmml" xref="S2.SS4.p3.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS4.p3.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S2.SS4.p3.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS4.p3.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.2.2.1.1.1.2.1.cmml" xref="S2.SS4.p3.6.m6.2.2.1.1.1">superscript</csymbol><ci id="S2.SS4.p3.6.m6.2.2.1.1.1.2.2a.cmml" xref="S2.SS4.p3.6.m6.2.2.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.2.2.1.1.1.2.2.cmml" xref="S2.SS4.p3.6.m6.2.2.1.1.1.2.2">Intent</mtext></ci><ci id="S2.SS4.p3.6.m6.2.2.1.1.1.2.3.cmml" xref="S2.SS4.p3.6.m6.2.2.1.1.1.2.3">𝑗</ci></apply><cn id="S2.SS4.p3.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS4.p3.6.m6.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS4.p3.6.m6.3.3.2.2.2.cmml" xref="S2.SS4.p3.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.3.3.2.2.2.1.cmml" xref="S2.SS4.p3.6.m6.3.3.2.2.2">subscript</csymbol><apply id="S2.SS4.p3.6.m6.3.3.2.2.2.2.cmml" xref="S2.SS4.p3.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.3.3.2.2.2.2.1.cmml" xref="S2.SS4.p3.6.m6.3.3.2.2.2">superscript</csymbol><ci id="S2.SS4.p3.6.m6.3.3.2.2.2.2.2a.cmml" xref="S2.SS4.p3.6.m6.3.3.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.3.3.2.2.2.2.2.cmml" xref="S2.SS4.p3.6.m6.3.3.2.2.2.2.2">Intent</mtext></ci><ci id="S2.SS4.p3.6.m6.3.3.2.2.2.2.3.cmml" xref="S2.SS4.p3.6.m6.3.3.2.2.2.2.3">𝑗</ci></apply><cn id="S2.SS4.p3.6.m6.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS4.p3.6.m6.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS4.p3.6.m6.1.1.cmml" xref="S2.SS4.p3.6.m6.1.1">…</ci><apply id="S2.SS4.p3.6.m6.4.4.3.3.3.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.4.4.3.3.3.1.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3">subscript</csymbol><apply id="S2.SS4.p3.6.m6.4.4.3.3.3.2.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.4.4.3.3.3.2.1.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3">superscript</csymbol><ci id="S2.SS4.p3.6.m6.4.4.3.3.3.2.2a.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p3.6.m6.4.4.3.3.3.2.2.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3.2.2">Intent</mtext></ci><ci id="S2.SS4.p3.6.m6.4.4.3.3.3.2.3.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3.2.3">𝑗</ci></apply><ci id="S2.SS4.p3.6.m6.4.4.3.3.3.3.cmml" xref="S2.SS4.p3.6.m6.4.4.3.3.3.3">𝑇</ci></apply></list></apply><apply id="S2.SS4.p3.6.m6.4.4c.cmml" xref="S2.SS4.p3.6.m6.4.4"><in id="S2.SS4.p3.6.m6.4.4.7.cmml" xref="S2.SS4.p3.6.m6.4.4.7"></in><share href="https://arxiv.org/html/2408.10259v1#S2.SS4.p3.6.m6.4.4.3.cmml" id="S2.SS4.p3.6.m6.4.4d.cmml" xref="S2.SS4.p3.6.m6.4.4"></share><apply id="S2.SS4.p3.6.m6.4.4.8.cmml" xref="S2.SS4.p3.6.m6.4.4.8"><csymbol cd="ambiguous" id="S2.SS4.p3.6.m6.4.4.8.1.cmml" xref="S2.SS4.p3.6.m6.4.4.8">superscript</csymbol><ci id="S2.SS4.p3.6.m6.4.4.8.2.cmml" xref="S2.SS4.p3.6.m6.4.4.8.2">ℝ</ci><apply id="S2.SS4.p3.6.m6.4.4.8.3.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3"><divide id="S2.SS4.p3.6.m6.4.4.8.3.1.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3.1"></divide><apply id="S2.SS4.p3.6.m6.4.4.8.3.2.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3.2"><times id="S2.SS4.p3.6.m6.4.4.8.3.2.1.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3.2.1"></times><ci id="S2.SS4.p3.6.m6.4.4.8.3.2.2.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3.2.2">𝐵</ci><ci id="S2.SS4.p3.6.m6.4.4.8.3.2.3.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3.2.3">𝑇</ci><ci id="S2.SS4.p3.6.m6.4.4.8.3.2.4.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3.2.4">𝑑</ci></apply><ci id="S2.SS4.p3.6.m6.4.4.8.3.3.cmml" xref="S2.SS4.p3.6.m6.4.4.8.3.3">𝐽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.6.m6.4c">{\textbf{Intent}^{j}}=\langle\textbf{Intent}^{j}_{1},\textbf{Intent}^{j}_{2},%
\dots,\textbf{Intent}^{j}_{T}\rangle\in\mathbb{R}^{B\times T\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.6.m6.4d">Intent start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT = ⟨ Intent start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , Intent start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , Intent start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ⟩ ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_T × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\textbf{Intent}}^{j}_{t}=\hat{\textbf{P}}_{t}\textbf{W}^{j}_{I}" class="ltx_Math" display="block" id="S2.E9.m1.1"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.1" xref="S2.E9.m1.1.1.cmml"><msubsup id="S2.E9.m1.1.1.2" xref="S2.E9.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E9.m1.1.1.2.2.2" xref="S2.E9.m1.1.1.2.2.2a.cmml">Intent</mtext><mi id="S2.E9.m1.1.1.2.3" xref="S2.E9.m1.1.1.2.3.cmml">t</mi><mi id="S2.E9.m1.1.1.2.2.3" xref="S2.E9.m1.1.1.2.2.3.cmml">j</mi></msubsup><mo id="S2.E9.m1.1.1.1" xref="S2.E9.m1.1.1.1.cmml">=</mo><mrow id="S2.E9.m1.1.1.3" xref="S2.E9.m1.1.1.3.cmml"><msub id="S2.E9.m1.1.1.3.2" xref="S2.E9.m1.1.1.3.2.cmml"><mover accent="true" id="S2.E9.m1.1.1.3.2.2" xref="S2.E9.m1.1.1.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E9.m1.1.1.3.2.2.2" xref="S2.E9.m1.1.1.3.2.2.2a.cmml">P</mtext><mo id="S2.E9.m1.1.1.3.2.2.1" xref="S2.E9.m1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S2.E9.m1.1.1.3.2.3" xref="S2.E9.m1.1.1.3.2.3.cmml">t</mi></msub><mo id="S2.E9.m1.1.1.3.1" xref="S2.E9.m1.1.1.3.1.cmml">⁢</mo><msubsup id="S2.E9.m1.1.1.3.3" xref="S2.E9.m1.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E9.m1.1.1.3.3.2.2" xref="S2.E9.m1.1.1.3.3.2.2a.cmml">W</mtext><mi id="S2.E9.m1.1.1.3.3.3" xref="S2.E9.m1.1.1.3.3.3.cmml">I</mi><mi id="S2.E9.m1.1.1.3.3.2.3" xref="S2.E9.m1.1.1.3.3.2.3.cmml">j</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1"><eq id="S2.E9.m1.1.1.1.cmml" xref="S2.E9.m1.1.1.1"></eq><apply id="S2.E9.m1.1.1.2.cmml" xref="S2.E9.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.2.1.cmml" xref="S2.E9.m1.1.1.2">subscript</csymbol><apply id="S2.E9.m1.1.1.2.2.cmml" xref="S2.E9.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.2.2.1.cmml" xref="S2.E9.m1.1.1.2">superscript</csymbol><ci id="S2.E9.m1.1.1.2.2.2a.cmml" xref="S2.E9.m1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E9.m1.1.1.2.2.2.cmml" xref="S2.E9.m1.1.1.2.2.2">Intent</mtext></ci><ci id="S2.E9.m1.1.1.2.2.3.cmml" xref="S2.E9.m1.1.1.2.2.3">𝑗</ci></apply><ci id="S2.E9.m1.1.1.2.3.cmml" xref="S2.E9.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.E9.m1.1.1.3.cmml" xref="S2.E9.m1.1.1.3"><times id="S2.E9.m1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.3.1"></times><apply id="S2.E9.m1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.3.2.1.cmml" xref="S2.E9.m1.1.1.3.2">subscript</csymbol><apply id="S2.E9.m1.1.1.3.2.2.cmml" xref="S2.E9.m1.1.1.3.2.2"><ci id="S2.E9.m1.1.1.3.2.2.1.cmml" xref="S2.E9.m1.1.1.3.2.2.1">^</ci><ci id="S2.E9.m1.1.1.3.2.2.2a.cmml" xref="S2.E9.m1.1.1.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E9.m1.1.1.3.2.2.2.cmml" xref="S2.E9.m1.1.1.3.2.2.2">P</mtext></ci></apply><ci id="S2.E9.m1.1.1.3.2.3.cmml" xref="S2.E9.m1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E9.m1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.3.3.1.cmml" xref="S2.E9.m1.1.1.3.3">subscript</csymbol><apply id="S2.E9.m1.1.1.3.3.2.cmml" xref="S2.E9.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.3.3.2.1.cmml" xref="S2.E9.m1.1.1.3.3">superscript</csymbol><ci id="S2.E9.m1.1.1.3.3.2.2a.cmml" xref="S2.E9.m1.1.1.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E9.m1.1.1.3.3.2.2.cmml" xref="S2.E9.m1.1.1.3.3.2.2">W</mtext></ci><ci id="S2.E9.m1.1.1.3.3.2.3.cmml" xref="S2.E9.m1.1.1.3.3.2.3">𝑗</ci></apply><ci id="S2.E9.m1.1.1.3.3.3.cmml" xref="S2.E9.m1.1.1.3.3.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">{\textbf{Intent}}^{j}_{t}=\hat{\textbf{P}}_{t}\textbf{W}^{j}_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.1d">Intent start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = over^ start_ARG P end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT W start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.7">Visit-Level and Cross-Visit Transformers share the same head index to represent the same intents that will be distinct from others. We employ a contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib8" title="">2020</a>)</cite> framework. First, the prescription codes embedding for <math alttext="{\textbf{E}^{j}}" class="ltx_Math" display="inline" id="S2.SS4.p4.1.m1.1"><semantics id="S2.SS4.p4.1.m1.1a"><msup id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.1.m1.1.1.2" xref="S2.SS4.p4.1.m1.1.1.2a.cmml">E</mtext><mi id="S2.SS4.p4.1.m1.1.1.3" xref="S2.SS4.p4.1.m1.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><apply id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.1.m1.1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1">superscript</csymbol><ci id="S2.SS4.p4.1.m1.1.1.2a.cmml" xref="S2.SS4.p4.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.1.m1.1.1.2.cmml" xref="S2.SS4.p4.1.m1.1.1.2">E</mtext></ci><ci id="S2.SS4.p4.1.m1.1.1.3.cmml" xref="S2.SS4.p4.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">{\textbf{E}^{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.1d">E start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\hat{\textbf{e}}^{j}}" class="ltx_Math" display="inline" id="S2.SS4.p4.2.m2.1"><semantics id="S2.SS4.p4.2.m2.1a"><msup id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml"><mover accent="true" id="S2.SS4.p4.2.m2.1.1.2" xref="S2.SS4.p4.2.m2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.2.m2.1.1.2.2" xref="S2.SS4.p4.2.m2.1.1.2.2a.cmml">e</mtext><mo id="S2.SS4.p4.2.m2.1.1.2.1" xref="S2.SS4.p4.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS4.p4.2.m2.1.1.3" xref="S2.SS4.p4.2.m2.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.1b"><apply id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m2.1.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1">superscript</csymbol><apply id="S2.SS4.p4.2.m2.1.1.2.cmml" xref="S2.SS4.p4.2.m2.1.1.2"><ci id="S2.SS4.p4.2.m2.1.1.2.1.cmml" xref="S2.SS4.p4.2.m2.1.1.2.1">^</ci><ci id="S2.SS4.p4.2.m2.1.1.2.2a.cmml" xref="S2.SS4.p4.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.2.m2.1.1.2.2.cmml" xref="S2.SS4.p4.2.m2.1.1.2.2">e</mtext></ci></apply><ci id="S2.SS4.p4.2.m2.1.1.3.cmml" xref="S2.SS4.p4.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.1c">{\hat{\textbf{e}}^{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.2.m2.1d">over^ start_ARG e end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> are summed up over individual codes respectively, so that <math alttext="{\textbf{O}^{j}}" class="ltx_Math" display="inline" id="S2.SS4.p4.3.m3.1"><semantics id="S2.SS4.p4.3.m3.1a"><msup id="S2.SS4.p4.3.m3.1.1" xref="S2.SS4.p4.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.3.m3.1.1.2" xref="S2.SS4.p4.3.m3.1.1.2a.cmml">O</mtext><mi id="S2.SS4.p4.3.m3.1.1.3" xref="S2.SS4.p4.3.m3.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m3.1b"><apply id="S2.SS4.p4.3.m3.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.3.m3.1.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1">superscript</csymbol><ci id="S2.SS4.p4.3.m3.1.1.2a.cmml" xref="S2.SS4.p4.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.3.m3.1.1.2.cmml" xref="S2.SS4.p4.3.m3.1.1.2">O</mtext></ci><ci id="S2.SS4.p4.3.m3.1.1.3.cmml" xref="S2.SS4.p4.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m3.1c">{\textbf{O}^{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.3.m3.1d">O start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\hat{\textbf{O}}^{j}}" class="ltx_Math" display="inline" id="S2.SS4.p4.4.m4.1"><semantics id="S2.SS4.p4.4.m4.1a"><msup id="S2.SS4.p4.4.m4.1.1" xref="S2.SS4.p4.4.m4.1.1.cmml"><mover accent="true" id="S2.SS4.p4.4.m4.1.1.2" xref="S2.SS4.p4.4.m4.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.4.m4.1.1.2.2" xref="S2.SS4.p4.4.m4.1.1.2.2a.cmml">O</mtext><mo id="S2.SS4.p4.4.m4.1.1.2.1" xref="S2.SS4.p4.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS4.p4.4.m4.1.1.3" xref="S2.SS4.p4.4.m4.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m4.1b"><apply id="S2.SS4.p4.4.m4.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.4.m4.1.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1">superscript</csymbol><apply id="S2.SS4.p4.4.m4.1.1.2.cmml" xref="S2.SS4.p4.4.m4.1.1.2"><ci id="S2.SS4.p4.4.m4.1.1.2.1.cmml" xref="S2.SS4.p4.4.m4.1.1.2.1">^</ci><ci id="S2.SS4.p4.4.m4.1.1.2.2a.cmml" xref="S2.SS4.p4.4.m4.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.4.m4.1.1.2.2.cmml" xref="S2.SS4.p4.4.m4.1.1.2.2">O</mtext></ci></apply><ci id="S2.SS4.p4.4.m4.1.1.3.cmml" xref="S2.SS4.p4.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m4.1c">{\hat{\textbf{O}}^{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.4.m4.1d">over^ start_ARG O end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\in\mathbb{R}^{B\times T\times d/J}" class="ltx_Math" display="inline" id="S2.SS4.p4.5.m5.1"><semantics id="S2.SS4.p4.5.m5.1a"><mrow id="S2.SS4.p4.5.m5.1.1" xref="S2.SS4.p4.5.m5.1.1.cmml"><mi id="S2.SS4.p4.5.m5.1.1.2" xref="S2.SS4.p4.5.m5.1.1.2.cmml"></mi><mo id="S2.SS4.p4.5.m5.1.1.1" xref="S2.SS4.p4.5.m5.1.1.1.cmml">∈</mo><msup id="S2.SS4.p4.5.m5.1.1.3" xref="S2.SS4.p4.5.m5.1.1.3.cmml"><mi id="S2.SS4.p4.5.m5.1.1.3.2" xref="S2.SS4.p4.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p4.5.m5.1.1.3.3" xref="S2.SS4.p4.5.m5.1.1.3.3.cmml"><mrow id="S2.SS4.p4.5.m5.1.1.3.3.2" xref="S2.SS4.p4.5.m5.1.1.3.3.2.cmml"><mi id="S2.SS4.p4.5.m5.1.1.3.3.2.2" xref="S2.SS4.p4.5.m5.1.1.3.3.2.2.cmml">B</mi><mo id="S2.SS4.p4.5.m5.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p4.5.m5.1.1.3.3.2.1.cmml">×</mo><mi id="S2.SS4.p4.5.m5.1.1.3.3.2.3" xref="S2.SS4.p4.5.m5.1.1.3.3.2.3.cmml">T</mi><mo id="S2.SS4.p4.5.m5.1.1.3.3.2.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p4.5.m5.1.1.3.3.2.1.cmml">×</mo><mi id="S2.SS4.p4.5.m5.1.1.3.3.2.4" xref="S2.SS4.p4.5.m5.1.1.3.3.2.4.cmml">d</mi></mrow><mo id="S2.SS4.p4.5.m5.1.1.3.3.1" xref="S2.SS4.p4.5.m5.1.1.3.3.1.cmml">/</mo><mi id="S2.SS4.p4.5.m5.1.1.3.3.3" xref="S2.SS4.p4.5.m5.1.1.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.5.m5.1b"><apply id="S2.SS4.p4.5.m5.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1"><in id="S2.SS4.p4.5.m5.1.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1.1"></in><csymbol cd="latexml" id="S2.SS4.p4.5.m5.1.1.2.cmml" xref="S2.SS4.p4.5.m5.1.1.2">absent</csymbol><apply id="S2.SS4.p4.5.m5.1.1.3.cmml" xref="S2.SS4.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m5.1.1.3.1.cmml" xref="S2.SS4.p4.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS4.p4.5.m5.1.1.3.2.cmml" xref="S2.SS4.p4.5.m5.1.1.3.2">ℝ</ci><apply id="S2.SS4.p4.5.m5.1.1.3.3.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3"><divide id="S2.SS4.p4.5.m5.1.1.3.3.1.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3.1"></divide><apply id="S2.SS4.p4.5.m5.1.1.3.3.2.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3.2"><times id="S2.SS4.p4.5.m5.1.1.3.3.2.1.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3.2.1"></times><ci id="S2.SS4.p4.5.m5.1.1.3.3.2.2.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3.2.2">𝐵</ci><ci id="S2.SS4.p4.5.m5.1.1.3.3.2.3.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3.2.3">𝑇</ci><ci id="S2.SS4.p4.5.m5.1.1.3.3.2.4.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3.2.4">𝑑</ci></apply><ci id="S2.SS4.p4.5.m5.1.1.3.3.3.cmml" xref="S2.SS4.p4.5.m5.1.1.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.5.m5.1c">\in\mathbb{R}^{B\times T\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.5.m5.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_T × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math> are obtained. Second, the embeddings are transformed using a linear layer as indicated in Equations <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E10" title="In 2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E11" title="In 2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">11</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E12" title="In 2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">12</span></a>, where <math alttext="{\textbf{W}}_{CL}\in\mathbb{R}^{dT/J\times d/J}" class="ltx_Math" display="inline" id="S2.SS4.p4.6.m6.1"><semantics id="S2.SS4.p4.6.m6.1a"><mrow id="S2.SS4.p4.6.m6.1.1" xref="S2.SS4.p4.6.m6.1.1.cmml"><msub id="S2.SS4.p4.6.m6.1.1.2" xref="S2.SS4.p4.6.m6.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.6.m6.1.1.2.2" xref="S2.SS4.p4.6.m6.1.1.2.2a.cmml">W</mtext><mrow id="S2.SS4.p4.6.m6.1.1.2.3" xref="S2.SS4.p4.6.m6.1.1.2.3.cmml"><mi id="S2.SS4.p4.6.m6.1.1.2.3.2" xref="S2.SS4.p4.6.m6.1.1.2.3.2.cmml">C</mi><mo id="S2.SS4.p4.6.m6.1.1.2.3.1" xref="S2.SS4.p4.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS4.p4.6.m6.1.1.2.3.3" xref="S2.SS4.p4.6.m6.1.1.2.3.3.cmml">L</mi></mrow></msub><mo id="S2.SS4.p4.6.m6.1.1.1" xref="S2.SS4.p4.6.m6.1.1.1.cmml">∈</mo><msup id="S2.SS4.p4.6.m6.1.1.3" xref="S2.SS4.p4.6.m6.1.1.3.cmml"><mi id="S2.SS4.p4.6.m6.1.1.3.2" xref="S2.SS4.p4.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p4.6.m6.1.1.3.3" xref="S2.SS4.p4.6.m6.1.1.3.3.cmml"><mrow id="S2.SS4.p4.6.m6.1.1.3.3.2" xref="S2.SS4.p4.6.m6.1.1.3.3.2.cmml"><mrow id="S2.SS4.p4.6.m6.1.1.3.3.2.2" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.cmml"><mrow id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.cmml"><mi id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.2" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.2.cmml">d</mi><mo id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.1" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.1.cmml">⁢</mo><mi id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.3" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.3.cmml">T</mi></mrow><mo id="S2.SS4.p4.6.m6.1.1.3.3.2.2.1" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.1.cmml">/</mo><mi id="S2.SS4.p4.6.m6.1.1.3.3.2.2.3" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.3.cmml">J</mi></mrow><mo id="S2.SS4.p4.6.m6.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p4.6.m6.1.1.3.3.2.1.cmml">×</mo><mi id="S2.SS4.p4.6.m6.1.1.3.3.2.3" xref="S2.SS4.p4.6.m6.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="S2.SS4.p4.6.m6.1.1.3.3.1" xref="S2.SS4.p4.6.m6.1.1.3.3.1.cmml">/</mo><mi id="S2.SS4.p4.6.m6.1.1.3.3.3" xref="S2.SS4.p4.6.m6.1.1.3.3.3.cmml">J</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.6.m6.1b"><apply id="S2.SS4.p4.6.m6.1.1.cmml" xref="S2.SS4.p4.6.m6.1.1"><in id="S2.SS4.p4.6.m6.1.1.1.cmml" xref="S2.SS4.p4.6.m6.1.1.1"></in><apply id="S2.SS4.p4.6.m6.1.1.2.cmml" xref="S2.SS4.p4.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p4.6.m6.1.1.2.1.cmml" xref="S2.SS4.p4.6.m6.1.1.2">subscript</csymbol><ci id="S2.SS4.p4.6.m6.1.1.2.2a.cmml" xref="S2.SS4.p4.6.m6.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p4.6.m6.1.1.2.2.cmml" xref="S2.SS4.p4.6.m6.1.1.2.2">W</mtext></ci><apply id="S2.SS4.p4.6.m6.1.1.2.3.cmml" xref="S2.SS4.p4.6.m6.1.1.2.3"><times id="S2.SS4.p4.6.m6.1.1.2.3.1.cmml" xref="S2.SS4.p4.6.m6.1.1.2.3.1"></times><ci id="S2.SS4.p4.6.m6.1.1.2.3.2.cmml" xref="S2.SS4.p4.6.m6.1.1.2.3.2">𝐶</ci><ci id="S2.SS4.p4.6.m6.1.1.2.3.3.cmml" xref="S2.SS4.p4.6.m6.1.1.2.3.3">𝐿</ci></apply></apply><apply id="S2.SS4.p4.6.m6.1.1.3.cmml" xref="S2.SS4.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p4.6.m6.1.1.3.1.cmml" xref="S2.SS4.p4.6.m6.1.1.3">superscript</csymbol><ci id="S2.SS4.p4.6.m6.1.1.3.2.cmml" xref="S2.SS4.p4.6.m6.1.1.3.2">ℝ</ci><apply id="S2.SS4.p4.6.m6.1.1.3.3.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3"><divide id="S2.SS4.p4.6.m6.1.1.3.3.1.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.1"></divide><apply id="S2.SS4.p4.6.m6.1.1.3.3.2.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2"><times id="S2.SS4.p4.6.m6.1.1.3.3.2.1.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.1"></times><apply id="S2.SS4.p4.6.m6.1.1.3.3.2.2.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2"><divide id="S2.SS4.p4.6.m6.1.1.3.3.2.2.1.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.1"></divide><apply id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2"><times id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.1.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.1"></times><ci id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.2.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.2">𝑑</ci><ci id="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.3.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.2.3">𝑇</ci></apply><ci id="S2.SS4.p4.6.m6.1.1.3.3.2.2.3.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.2.3">𝐽</ci></apply><ci id="S2.SS4.p4.6.m6.1.1.3.3.2.3.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.2.3">𝑑</ci></apply><ci id="S2.SS4.p4.6.m6.1.1.3.3.3.cmml" xref="S2.SS4.p4.6.m6.1.1.3.3.3">𝐽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.6.m6.1c">{\textbf{W}}_{CL}\in\mathbb{R}^{dT/J\times d/J}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.6.m6.1d">W start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d italic_T / italic_J × italic_d / italic_J end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="M_{P}" class="ltx_Math" display="inline" id="S2.SS4.p4.7.m7.1"><semantics id="S2.SS4.p4.7.m7.1a"><msub id="S2.SS4.p4.7.m7.1.1" xref="S2.SS4.p4.7.m7.1.1.cmml"><mi id="S2.SS4.p4.7.m7.1.1.2" xref="S2.SS4.p4.7.m7.1.1.2.cmml">M</mi><mi id="S2.SS4.p4.7.m7.1.1.3" xref="S2.SS4.p4.7.m7.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.7.m7.1b"><apply id="S2.SS4.p4.7.m7.1.1.cmml" xref="S2.SS4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.1.1.1.cmml" xref="S2.SS4.p4.7.m7.1.1">subscript</csymbol><ci id="S2.SS4.p4.7.m7.1.1.2.cmml" xref="S2.SS4.p4.7.m7.1.1.2">𝑀</ci><ci id="S2.SS4.p4.7.m7.1.1.3.cmml" xref="S2.SS4.p4.7.m7.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.7.m7.1c">M_{P}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.7.m7.1d">italic_M start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math> is the mask to address variable number of visits.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx1">
<tbody id="S2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\textbf{Z}}^{j}_{I}" class="ltx_Math" display="inline" id="S2.E10.m1.1"><semantics id="S2.E10.m1.1a"><msubsup id="S2.E10.m1.1.1" xref="S2.E10.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E10.m1.1.1.2.2" xref="S2.E10.m1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E10.m1.1.1.3" xref="S2.E10.m1.1.1.3.cmml">I</mi><mi id="S2.E10.m1.1.1.2.3" xref="S2.E10.m1.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E10.m1.1b"><apply id="S2.E10.m1.1.1.cmml" xref="S2.E10.m1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.cmml" xref="S2.E10.m1.1.1">subscript</csymbol><apply id="S2.E10.m1.1.1.2.cmml" xref="S2.E10.m1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.2.1.cmml" xref="S2.E10.m1.1.1">superscript</csymbol><ci id="S2.E10.m1.1.1.2.2a.cmml" xref="S2.E10.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E10.m1.1.1.2.2.cmml" xref="S2.E10.m1.1.1.2.2">Z</mtext></ci><ci id="S2.E10.m1.1.1.2.3.cmml" xref="S2.E10.m1.1.1.2.3">𝑗</ci></apply><ci id="S2.E10.m1.1.1.3.cmml" xref="S2.E10.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.1c">\displaystyle{\textbf{Z}}^{j}_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.1d">Z start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=({\textbf{Intent}^{j}}+M_{P})\textbf{W}_{CL}" class="ltx_Math" display="inline" id="S2.E10.m2.1"><semantics id="S2.E10.m2.1a"><mrow id="S2.E10.m2.1.1" xref="S2.E10.m2.1.1.cmml"><mi id="S2.E10.m2.1.1.3" xref="S2.E10.m2.1.1.3.cmml"></mi><mo id="S2.E10.m2.1.1.2" xref="S2.E10.m2.1.1.2.cmml">=</mo><mrow id="S2.E10.m2.1.1.1" xref="S2.E10.m2.1.1.1.cmml"><mrow id="S2.E10.m2.1.1.1.1.1" xref="S2.E10.m2.1.1.1.1.1.1.cmml"><mo id="S2.E10.m2.1.1.1.1.1.2" stretchy="false" xref="S2.E10.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E10.m2.1.1.1.1.1.1" xref="S2.E10.m2.1.1.1.1.1.1.cmml"><msup id="S2.E10.m2.1.1.1.1.1.1.2" xref="S2.E10.m2.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E10.m2.1.1.1.1.1.1.2.2" xref="S2.E10.m2.1.1.1.1.1.1.2.2a.cmml">Intent</mtext><mi id="S2.E10.m2.1.1.1.1.1.1.2.3" xref="S2.E10.m2.1.1.1.1.1.1.2.3.cmml">j</mi></msup><mo id="S2.E10.m2.1.1.1.1.1.1.1" xref="S2.E10.m2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.E10.m2.1.1.1.1.1.1.3" xref="S2.E10.m2.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m2.1.1.1.1.1.1.3.2" xref="S2.E10.m2.1.1.1.1.1.1.3.2.cmml">M</mi><mi id="S2.E10.m2.1.1.1.1.1.1.3.3" xref="S2.E10.m2.1.1.1.1.1.1.3.3.cmml">P</mi></msub></mrow><mo id="S2.E10.m2.1.1.1.1.1.3" stretchy="false" xref="S2.E10.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E10.m2.1.1.1.2" xref="S2.E10.m2.1.1.1.2.cmml">⁢</mo><msub id="S2.E10.m2.1.1.1.3" xref="S2.E10.m2.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E10.m2.1.1.1.3.2" xref="S2.E10.m2.1.1.1.3.2a.cmml">W</mtext><mrow id="S2.E10.m2.1.1.1.3.3" xref="S2.E10.m2.1.1.1.3.3.cmml"><mi id="S2.E10.m2.1.1.1.3.3.2" xref="S2.E10.m2.1.1.1.3.3.2.cmml">C</mi><mo id="S2.E10.m2.1.1.1.3.3.1" xref="S2.E10.m2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E10.m2.1.1.1.3.3.3" xref="S2.E10.m2.1.1.1.3.3.3.cmml">L</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m2.1b"><apply id="S2.E10.m2.1.1.cmml" xref="S2.E10.m2.1.1"><eq id="S2.E10.m2.1.1.2.cmml" xref="S2.E10.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.E10.m2.1.1.3.cmml" xref="S2.E10.m2.1.1.3">absent</csymbol><apply id="S2.E10.m2.1.1.1.cmml" xref="S2.E10.m2.1.1.1"><times id="S2.E10.m2.1.1.1.2.cmml" xref="S2.E10.m2.1.1.1.2"></times><apply id="S2.E10.m2.1.1.1.1.1.1.cmml" xref="S2.E10.m2.1.1.1.1.1"><plus id="S2.E10.m2.1.1.1.1.1.1.1.cmml" xref="S2.E10.m2.1.1.1.1.1.1.1"></plus><apply id="S2.E10.m2.1.1.1.1.1.1.2.cmml" xref="S2.E10.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E10.m2.1.1.1.1.1.1.2.2a.cmml" xref="S2.E10.m2.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E10.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m2.1.1.1.1.1.1.2.2">Intent</mtext></ci><ci id="S2.E10.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.E10.m2.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E10.m2.1.1.1.1.1.1.3.cmml" xref="S2.E10.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m2.1.1.1.1.1.1.3.2">𝑀</ci><ci id="S2.E10.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m2.1.1.1.1.1.1.3.3">𝑃</ci></apply></apply><apply id="S2.E10.m2.1.1.1.3.cmml" xref="S2.E10.m2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m2.1.1.1.3.1.cmml" xref="S2.E10.m2.1.1.1.3">subscript</csymbol><ci id="S2.E10.m2.1.1.1.3.2a.cmml" xref="S2.E10.m2.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E10.m2.1.1.1.3.2.cmml" xref="S2.E10.m2.1.1.1.3.2">W</mtext></ci><apply id="S2.E10.m2.1.1.1.3.3.cmml" xref="S2.E10.m2.1.1.1.3.3"><times id="S2.E10.m2.1.1.1.3.3.1.cmml" xref="S2.E10.m2.1.1.1.3.3.1"></times><ci id="S2.E10.m2.1.1.1.3.3.2.cmml" xref="S2.E10.m2.1.1.1.3.3.2">𝐶</ci><ci id="S2.E10.m2.1.1.1.3.3.3.cmml" xref="S2.E10.m2.1.1.1.3.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m2.1c">\displaystyle=({\textbf{Intent}^{j}}+M_{P})\textbf{W}_{CL}</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m2.1d">= ( Intent start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT + italic_M start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) W start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{\textbf{Z}}^{j}_{O}" class="ltx_Math" display="inline" id="S2.E11.m1.1"><semantics id="S2.E11.m1.1a"><msubsup id="S2.E11.m1.1.1" xref="S2.E11.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E11.m1.1.1.2.2" xref="S2.E11.m1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E11.m1.1.1.3" xref="S2.E11.m1.1.1.3.cmml">O</mi><mi id="S2.E11.m1.1.1.2.3" xref="S2.E11.m1.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E11.m1.1b"><apply id="S2.E11.m1.1.1.cmml" xref="S2.E11.m1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.cmml" xref="S2.E11.m1.1.1">subscript</csymbol><apply id="S2.E11.m1.1.1.2.cmml" xref="S2.E11.m1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.2.1.cmml" xref="S2.E11.m1.1.1">superscript</csymbol><ci id="S2.E11.m1.1.1.2.2a.cmml" xref="S2.E11.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E11.m1.1.1.2.2.cmml" xref="S2.E11.m1.1.1.2.2">Z</mtext></ci><ci id="S2.E11.m1.1.1.2.3.cmml" xref="S2.E11.m1.1.1.2.3">𝑗</ci></apply><ci id="S2.E11.m1.1.1.3.cmml" xref="S2.E11.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.1c">\displaystyle{\textbf{Z}}^{j}_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.1d">Z start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=({\textbf{O}^{j}}+M_{P})\textbf{W}_{CL}" class="ltx_Math" display="inline" id="S2.E11.m2.1"><semantics id="S2.E11.m2.1a"><mrow id="S2.E11.m2.1.1" xref="S2.E11.m2.1.1.cmml"><mi id="S2.E11.m2.1.1.3" xref="S2.E11.m2.1.1.3.cmml"></mi><mo id="S2.E11.m2.1.1.2" xref="S2.E11.m2.1.1.2.cmml">=</mo><mrow id="S2.E11.m2.1.1.1" xref="S2.E11.m2.1.1.1.cmml"><mrow id="S2.E11.m2.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.cmml"><mo id="S2.E11.m2.1.1.1.1.1.2" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E11.m2.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.cmml"><msup id="S2.E11.m2.1.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E11.m2.1.1.1.1.1.1.2.2" xref="S2.E11.m2.1.1.1.1.1.1.2.2a.cmml">O</mtext><mi id="S2.E11.m2.1.1.1.1.1.1.2.3" xref="S2.E11.m2.1.1.1.1.1.1.2.3.cmml">j</mi></msup><mo id="S2.E11.m2.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.E11.m2.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.3.cmml"><mi id="S2.E11.m2.1.1.1.1.1.1.3.2" xref="S2.E11.m2.1.1.1.1.1.1.3.2.cmml">M</mi><mi id="S2.E11.m2.1.1.1.1.1.1.3.3" xref="S2.E11.m2.1.1.1.1.1.1.3.3.cmml">P</mi></msub></mrow><mo id="S2.E11.m2.1.1.1.1.1.3" stretchy="false" xref="S2.E11.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E11.m2.1.1.1.2" xref="S2.E11.m2.1.1.1.2.cmml">⁢</mo><msub id="S2.E11.m2.1.1.1.3" xref="S2.E11.m2.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E11.m2.1.1.1.3.2" xref="S2.E11.m2.1.1.1.3.2a.cmml">W</mtext><mrow id="S2.E11.m2.1.1.1.3.3" xref="S2.E11.m2.1.1.1.3.3.cmml"><mi id="S2.E11.m2.1.1.1.3.3.2" xref="S2.E11.m2.1.1.1.3.3.2.cmml">C</mi><mo id="S2.E11.m2.1.1.1.3.3.1" xref="S2.E11.m2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E11.m2.1.1.1.3.3.3" xref="S2.E11.m2.1.1.1.3.3.3.cmml">L</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m2.1b"><apply id="S2.E11.m2.1.1.cmml" xref="S2.E11.m2.1.1"><eq id="S2.E11.m2.1.1.2.cmml" xref="S2.E11.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.E11.m2.1.1.3.cmml" xref="S2.E11.m2.1.1.3">absent</csymbol><apply id="S2.E11.m2.1.1.1.cmml" xref="S2.E11.m2.1.1.1"><times id="S2.E11.m2.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.2"></times><apply id="S2.E11.m2.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1"><plus id="S2.E11.m2.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1"></plus><apply id="S2.E11.m2.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E11.m2.1.1.1.1.1.1.2.2a.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E11.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2.2">O</mtext></ci><ci id="S2.E11.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E11.m2.1.1.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E11.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.3.2">𝑀</ci><ci id="S2.E11.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.3.3">𝑃</ci></apply></apply><apply id="S2.E11.m2.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.3.1.cmml" xref="S2.E11.m2.1.1.1.3">subscript</csymbol><ci id="S2.E11.m2.1.1.1.3.2a.cmml" xref="S2.E11.m2.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E11.m2.1.1.1.3.2.cmml" xref="S2.E11.m2.1.1.1.3.2">W</mtext></ci><apply id="S2.E11.m2.1.1.1.3.3.cmml" xref="S2.E11.m2.1.1.1.3.3"><times id="S2.E11.m2.1.1.1.3.3.1.cmml" xref="S2.E11.m2.1.1.1.3.3.1"></times><ci id="S2.E11.m2.1.1.1.3.3.2.cmml" xref="S2.E11.m2.1.1.1.3.3.2">𝐶</ci><ci id="S2.E11.m2.1.1.1.3.3.3.cmml" xref="S2.E11.m2.1.1.1.3.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m2.1c">\displaystyle=({\textbf{O}^{j}}+M_{P})\textbf{W}_{CL}</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m2.1d">= ( O start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT + italic_M start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) W start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\textbf{Z}}^{j}_{O}" class="ltx_Math" display="inline" id="S2.E12.m1.1"><semantics id="S2.E12.m1.1a"><msubsup id="S2.E12.m1.1.1" xref="S2.E12.m1.1.1.cmml"><mover accent="true" id="S2.E12.m1.1.1.2.2" xref="S2.E12.m1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E12.m1.1.1.2.2.2" xref="S2.E12.m1.1.1.2.2.2a.cmml">Z</mtext><mo id="S2.E12.m1.1.1.2.2.1" xref="S2.E12.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.E12.m1.1.1.3" xref="S2.E12.m1.1.1.3.cmml">O</mi><mi id="S2.E12.m1.1.1.2.3" xref="S2.E12.m1.1.1.2.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E12.m1.1b"><apply id="S2.E12.m1.1.1.cmml" xref="S2.E12.m1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.cmml" xref="S2.E12.m1.1.1">subscript</csymbol><apply id="S2.E12.m1.1.1.2.cmml" xref="S2.E12.m1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.2.1.cmml" xref="S2.E12.m1.1.1">superscript</csymbol><apply id="S2.E12.m1.1.1.2.2.cmml" xref="S2.E12.m1.1.1.2.2"><ci id="S2.E12.m1.1.1.2.2.1.cmml" xref="S2.E12.m1.1.1.2.2.1">^</ci><ci id="S2.E12.m1.1.1.2.2.2a.cmml" xref="S2.E12.m1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E12.m1.1.1.2.2.2.cmml" xref="S2.E12.m1.1.1.2.2.2">Z</mtext></ci></apply><ci id="S2.E12.m1.1.1.2.3.cmml" xref="S2.E12.m1.1.1.2.3">𝑗</ci></apply><ci id="S2.E12.m1.1.1.3.cmml" xref="S2.E12.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.1c">\displaystyle\hat{\textbf{Z}}^{j}_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.1d">over^ start_ARG Z end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=({\hat{\textbf{O}}^{j}}+M_{P})\textbf{W}_{CL}" class="ltx_Math" display="inline" id="S2.E12.m2.1"><semantics id="S2.E12.m2.1a"><mrow id="S2.E12.m2.1.1" xref="S2.E12.m2.1.1.cmml"><mi id="S2.E12.m2.1.1.3" xref="S2.E12.m2.1.1.3.cmml"></mi><mo id="S2.E12.m2.1.1.2" xref="S2.E12.m2.1.1.2.cmml">=</mo><mrow id="S2.E12.m2.1.1.1" xref="S2.E12.m2.1.1.1.cmml"><mrow id="S2.E12.m2.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.cmml"><mo id="S2.E12.m2.1.1.1.1.1.2" stretchy="false" xref="S2.E12.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E12.m2.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.cmml"><msup id="S2.E12.m2.1.1.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S2.E12.m2.1.1.1.1.1.1.2.2" xref="S2.E12.m2.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E12.m2.1.1.1.1.1.1.2.2.2" xref="S2.E12.m2.1.1.1.1.1.1.2.2.2a.cmml">O</mtext><mo id="S2.E12.m2.1.1.1.1.1.1.2.2.1" xref="S2.E12.m2.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S2.E12.m2.1.1.1.1.1.1.2.3" xref="S2.E12.m2.1.1.1.1.1.1.2.3.cmml">j</mi></msup><mo id="S2.E12.m2.1.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.E12.m2.1.1.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.1.3.cmml"><mi id="S2.E12.m2.1.1.1.1.1.1.3.2" xref="S2.E12.m2.1.1.1.1.1.1.3.2.cmml">M</mi><mi id="S2.E12.m2.1.1.1.1.1.1.3.3" xref="S2.E12.m2.1.1.1.1.1.1.3.3.cmml">P</mi></msub></mrow><mo id="S2.E12.m2.1.1.1.1.1.3" stretchy="false" xref="S2.E12.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E12.m2.1.1.1.2" xref="S2.E12.m2.1.1.1.2.cmml">⁢</mo><msub id="S2.E12.m2.1.1.1.3" xref="S2.E12.m2.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E12.m2.1.1.1.3.2" xref="S2.E12.m2.1.1.1.3.2a.cmml">W</mtext><mrow id="S2.E12.m2.1.1.1.3.3" xref="S2.E12.m2.1.1.1.3.3.cmml"><mi id="S2.E12.m2.1.1.1.3.3.2" xref="S2.E12.m2.1.1.1.3.3.2.cmml">C</mi><mo id="S2.E12.m2.1.1.1.3.3.1" xref="S2.E12.m2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E12.m2.1.1.1.3.3.3" xref="S2.E12.m2.1.1.1.3.3.3.cmml">L</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m2.1b"><apply id="S2.E12.m2.1.1.cmml" xref="S2.E12.m2.1.1"><eq id="S2.E12.m2.1.1.2.cmml" xref="S2.E12.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.E12.m2.1.1.3.cmml" xref="S2.E12.m2.1.1.3">absent</csymbol><apply id="S2.E12.m2.1.1.1.cmml" xref="S2.E12.m2.1.1.1"><times id="S2.E12.m2.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.2"></times><apply id="S2.E12.m2.1.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1"><plus id="S2.E12.m2.1.1.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1"></plus><apply id="S2.E12.m2.1.1.1.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E12.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2.2"><ci id="S2.E12.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2.2.1">^</ci><ci id="S2.E12.m2.1.1.1.1.1.1.2.2.2a.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E12.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2.2.2">O</mtext></ci></apply><ci id="S2.E12.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E12.m2.1.1.1.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.3.2">𝑀</ci><ci id="S2.E12.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.3.3">𝑃</ci></apply></apply><apply id="S2.E12.m2.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.3.1.cmml" xref="S2.E12.m2.1.1.1.3">subscript</csymbol><ci id="S2.E12.m2.1.1.1.3.2a.cmml" xref="S2.E12.m2.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E12.m2.1.1.1.3.2.cmml" xref="S2.E12.m2.1.1.1.3.2">W</mtext></ci><apply id="S2.E12.m2.1.1.1.3.3.cmml" xref="S2.E12.m2.1.1.1.3.3"><times id="S2.E12.m2.1.1.1.3.3.1.cmml" xref="S2.E12.m2.1.1.1.3.3.1"></times><ci id="S2.E12.m2.1.1.1.3.3.2.cmml" xref="S2.E12.m2.1.1.1.3.3.2">𝐶</ci><ci id="S2.E12.m2.1.1.1.3.3.3.cmml" xref="S2.E12.m2.1.1.1.3.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m2.1c">\displaystyle=({\hat{\textbf{O}}^{j}}+M_{P})\textbf{W}_{CL}</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m2.1d">= ( over^ start_ARG O end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT + italic_M start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) W start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS4.p5">
<p class="ltx_p" id="S2.SS4.p5.2">For contrastive loss, each intent should be similar to a distinct transformer’s head while being contrasted with other heads. Consequently, positive pairs are the intents and heads with the same head index <math alttext="j" class="ltx_Math" display="inline" id="S2.SS4.p5.1.m1.1"><semantics id="S2.SS4.p5.1.m1.1a"><mi id="S2.SS4.p5.1.m1.1.1" xref="S2.SS4.p5.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.1.m1.1b"><ci id="S2.SS4.p5.1.m1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.1.m1.1d">italic_j</annotation></semantics></math>, while the heads and intents with different <math alttext="j" class="ltx_Math" display="inline" id="S2.SS4.p5.2.m2.1"><semantics id="S2.SS4.p5.2.m2.1a"><mi id="S2.SS4.p5.2.m2.1.1" xref="S2.SS4.p5.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.2.m2.1b"><ci id="S2.SS4.p5.2.m2.1.1.cmml" xref="S2.SS4.p5.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.2.m2.1d">italic_j</annotation></semantics></math> are considered negative pairs. Hence, the contrastive loss is computed according to Equations <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E13" title="In 2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E14" title="In 2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">14</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E15" title="In 2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">15</span></a> for both Transformers.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}^{i}_{CL}=-\log\frac{\overbrace{e^{\mathrm{s}\left({\textbf{Z}}^{i}%
_{I},{\textbf{Z}}^{i}_{O}\right)/\tau}}^{\text{Positive Pair}}}{\underbrace{e^%
{\mathrm{s}\left({\textbf{Z}}^{i}_{I},{\textbf{Z}}^{i}_{O}\right)/\tau}}_{%
\text{Positive Pair }}+\underbrace{\sum_{k\neq i}e^{\mathrm{s}\left({\textbf{Z%
}}^{i}_{I},{\textbf{Z}}^{k}_{O}\right)/\tau}}_{\text{Intent and Visit-Level}}+%
I^{i}}" class="ltx_Math" display="block" id="S2.E13.m1.6"><semantics id="S2.E13.m1.6a"><mrow id="S2.E13.m1.6.7" xref="S2.E13.m1.6.7.cmml"><msubsup id="S2.E13.m1.6.7.2" xref="S2.E13.m1.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E13.m1.6.7.2.2.2" xref="S2.E13.m1.6.7.2.2.2.cmml">ℒ</mi><mrow id="S2.E13.m1.6.7.2.3" xref="S2.E13.m1.6.7.2.3.cmml"><mi id="S2.E13.m1.6.7.2.3.2" xref="S2.E13.m1.6.7.2.3.2.cmml">C</mi><mo id="S2.E13.m1.6.7.2.3.1" xref="S2.E13.m1.6.7.2.3.1.cmml">⁢</mo><mi id="S2.E13.m1.6.7.2.3.3" xref="S2.E13.m1.6.7.2.3.3.cmml">L</mi></mrow><mi id="S2.E13.m1.6.7.2.2.3" xref="S2.E13.m1.6.7.2.2.3.cmml">i</mi></msubsup><mo id="S2.E13.m1.6.7.1" xref="S2.E13.m1.6.7.1.cmml">=</mo><mrow id="S2.E13.m1.6.7.3" xref="S2.E13.m1.6.7.3.cmml"><mo id="S2.E13.m1.6.7.3a" rspace="0.167em" xref="S2.E13.m1.6.7.3.cmml">−</mo><mrow id="S2.E13.m1.6.7.3.2" xref="S2.E13.m1.6.7.3.2.cmml"><mi id="S2.E13.m1.6.7.3.2.1" xref="S2.E13.m1.6.7.3.2.1.cmml">log</mi><mo id="S2.E13.m1.6.7.3.2a" lspace="0.167em" xref="S2.E13.m1.6.7.3.2.cmml">⁡</mo><mfrac id="S2.E13.m1.6.6" xref="S2.E13.m1.6.6.cmml"><mover id="S2.E13.m1.2.2.2" xref="S2.E13.m1.2.2.2.cmml"><mover accent="true" id="S2.E13.m1.2.2.2.2" xref="S2.E13.m1.2.2.2.2.cmml"><msup id="S2.E13.m1.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.cmml"><mi id="S2.E13.m1.2.2.2.2.2.4" xref="S2.E13.m1.2.2.2.2.2.4.cmml">e</mi><mrow id="S2.E13.m1.2.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.2.cmml"><mrow id="S2.E13.m1.2.2.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E13.m1.2.2.2.2.2.2.2.2.4" mathvariant="normal" xref="S2.E13.m1.2.2.2.2.2.2.2.2.4.cmml">s</mi><mo id="S2.E13.m1.2.2.2.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.3.cmml"><mo id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">I</mi><mi id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.4" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.2a.cmml">Z</mtext><mi id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.3.cmml">O</mi><mi id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.5" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.2.2.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.2.2.3.cmml">/</mo><mi id="S2.E13.m1.2.2.2.2.2.2.2.4" xref="S2.E13.m1.2.2.2.2.2.2.2.4.cmml">τ</mi></mrow></msup><mo id="S2.E13.m1.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.3.cmml">⏞</mo></mover><mtext id="S2.E13.m1.2.2.2.4" xref="S2.E13.m1.2.2.2.4a.cmml">Positive Pair</mtext></mover><mrow id="S2.E13.m1.6.6.6" xref="S2.E13.m1.6.6.6.cmml"><munder id="S2.E13.m1.6.6.6.6" xref="S2.E13.m1.6.6.6.6.cmml"><munder accentunder="true" id="S2.E13.m1.4.4.4.2" xref="S2.E13.m1.4.4.4.2.cmml"><msup id="S2.E13.m1.4.4.4.2.2" xref="S2.E13.m1.4.4.4.2.2.cmml"><mi id="S2.E13.m1.4.4.4.2.2.4" xref="S2.E13.m1.4.4.4.2.2.4.cmml">e</mi><mrow id="S2.E13.m1.4.4.4.2.2.2.2" xref="S2.E13.m1.4.4.4.2.2.2.2.cmml"><mrow id="S2.E13.m1.4.4.4.2.2.2.2.2" xref="S2.E13.m1.4.4.4.2.2.2.2.2.cmml"><mi id="S2.E13.m1.4.4.4.2.2.2.2.2.4" mathvariant="normal" xref="S2.E13.m1.4.4.4.2.2.2.2.2.4.cmml">s</mi><mo id="S2.E13.m1.4.4.4.2.2.2.2.2.3" xref="S2.E13.m1.4.4.4.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.3.cmml"><mo id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.3" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.2" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.3.cmml">I</mi><mi id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.3" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.4" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.2" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.2a.cmml">Z</mtext><mi id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.3" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.3.cmml">O</mi><mi id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.3" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.5" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.4.4.4.2.2.2.2.3" xref="S2.E13.m1.4.4.4.2.2.2.2.3.cmml">/</mo><mi id="S2.E13.m1.4.4.4.2.2.2.2.4" xref="S2.E13.m1.4.4.4.2.2.2.2.4.cmml">τ</mi></mrow></msup><mo id="S2.E13.m1.4.4.4.2.3" xref="S2.E13.m1.4.4.4.2.3.cmml">⏟</mo></munder><mtext id="S2.E13.m1.6.6.6.6.2" xref="S2.E13.m1.6.6.6.6.2a.cmml">Positive Pair </mtext></munder><mo id="S2.E13.m1.6.6.6.5" rspace="0.055em" xref="S2.E13.m1.6.6.6.5.cmml">+</mo><munder id="S2.E13.m1.6.6.6.7" xref="S2.E13.m1.6.6.6.7.cmml"><munder accentunder="true" id="S2.E13.m1.6.6.6.4" xref="S2.E13.m1.6.6.6.4.cmml"><mrow id="S2.E13.m1.6.6.6.4.2" xref="S2.E13.m1.6.6.6.4.2.cmml"><msub id="S2.E13.m1.6.6.6.4.2.3" xref="S2.E13.m1.6.6.6.4.2.3.cmml"><mo id="S2.E13.m1.6.6.6.4.2.3.2" movablelimits="false" xref="S2.E13.m1.6.6.6.4.2.3.2.cmml">∑</mo><mrow id="S2.E13.m1.6.6.6.4.2.3.3" xref="S2.E13.m1.6.6.6.4.2.3.3.cmml"><mi id="S2.E13.m1.6.6.6.4.2.3.3.2" xref="S2.E13.m1.6.6.6.4.2.3.3.2.cmml">k</mi><mo id="S2.E13.m1.6.6.6.4.2.3.3.1" xref="S2.E13.m1.6.6.6.4.2.3.3.1.cmml">≠</mo><mi id="S2.E13.m1.6.6.6.4.2.3.3.3" xref="S2.E13.m1.6.6.6.4.2.3.3.3.cmml">i</mi></mrow></msub><msup id="S2.E13.m1.6.6.6.4.2.4" xref="S2.E13.m1.6.6.6.4.2.4.cmml"><mi id="S2.E13.m1.6.6.6.4.2.4.2" xref="S2.E13.m1.6.6.6.4.2.4.2.cmml">e</mi><mrow id="S2.E13.m1.6.6.6.4.2.2.2" xref="S2.E13.m1.6.6.6.4.2.2.2.cmml"><mrow id="S2.E13.m1.6.6.6.4.2.2.2.2" xref="S2.E13.m1.6.6.6.4.2.2.2.2.cmml"><mi id="S2.E13.m1.6.6.6.4.2.2.2.2.4" mathvariant="normal" xref="S2.E13.m1.6.6.6.4.2.2.2.2.4.cmml">s</mi><mo id="S2.E13.m1.6.6.6.4.2.2.2.2.3" xref="S2.E13.m1.6.6.6.4.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.3.cmml"><mo id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.3" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.2" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.3" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml">I</mi><mi id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.3" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.4" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.2" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.2a.cmml">Z</mtext><mi id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.3" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.3.cmml">O</mi><mi id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.3" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.5" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.6.6.6.4.2.2.2.3" xref="S2.E13.m1.6.6.6.4.2.2.2.3.cmml">/</mo><mi id="S2.E13.m1.6.6.6.4.2.2.2.4" xref="S2.E13.m1.6.6.6.4.2.2.2.4.cmml">τ</mi></mrow></msup></mrow><mo id="S2.E13.m1.6.6.6.4.3" xref="S2.E13.m1.6.6.6.4.3.cmml">⏟</mo></munder><mtext id="S2.E13.m1.6.6.6.7.2" xref="S2.E13.m1.6.6.6.7.2a.cmml">Intent and Visit-Level</mtext></munder><mo id="S2.E13.m1.6.6.6.5a" xref="S2.E13.m1.6.6.6.5.cmml">+</mo><msup id="S2.E13.m1.6.6.6.8" xref="S2.E13.m1.6.6.6.8.cmml"><mi id="S2.E13.m1.6.6.6.8.2" xref="S2.E13.m1.6.6.6.8.2.cmml">I</mi><mi id="S2.E13.m1.6.6.6.8.3" xref="S2.E13.m1.6.6.6.8.3.cmml">i</mi></msup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.6b"><apply id="S2.E13.m1.6.7.cmml" xref="S2.E13.m1.6.7"><eq id="S2.E13.m1.6.7.1.cmml" xref="S2.E13.m1.6.7.1"></eq><apply id="S2.E13.m1.6.7.2.cmml" xref="S2.E13.m1.6.7.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.7.2.1.cmml" xref="S2.E13.m1.6.7.2">subscript</csymbol><apply id="S2.E13.m1.6.7.2.2.cmml" xref="S2.E13.m1.6.7.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.7.2.2.1.cmml" xref="S2.E13.m1.6.7.2">superscript</csymbol><ci id="S2.E13.m1.6.7.2.2.2.cmml" xref="S2.E13.m1.6.7.2.2.2">ℒ</ci><ci id="S2.E13.m1.6.7.2.2.3.cmml" xref="S2.E13.m1.6.7.2.2.3">𝑖</ci></apply><apply id="S2.E13.m1.6.7.2.3.cmml" xref="S2.E13.m1.6.7.2.3"><times id="S2.E13.m1.6.7.2.3.1.cmml" xref="S2.E13.m1.6.7.2.3.1"></times><ci id="S2.E13.m1.6.7.2.3.2.cmml" xref="S2.E13.m1.6.7.2.3.2">𝐶</ci><ci id="S2.E13.m1.6.7.2.3.3.cmml" xref="S2.E13.m1.6.7.2.3.3">𝐿</ci></apply></apply><apply id="S2.E13.m1.6.7.3.cmml" xref="S2.E13.m1.6.7.3"><minus id="S2.E13.m1.6.7.3.1.cmml" xref="S2.E13.m1.6.7.3"></minus><apply id="S2.E13.m1.6.7.3.2.cmml" xref="S2.E13.m1.6.7.3.2"><log id="S2.E13.m1.6.7.3.2.1.cmml" xref="S2.E13.m1.6.7.3.2.1"></log><apply id="S2.E13.m1.6.6.cmml" xref="S2.E13.m1.6.6"><divide id="S2.E13.m1.6.6.7.cmml" xref="S2.E13.m1.6.6"></divide><apply id="S2.E13.m1.2.2.2.cmml" xref="S2.E13.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2">superscript</csymbol><apply id="S2.E13.m1.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2"><ci id="S2.E13.m1.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.3">⏞</ci><apply id="S2.E13.m1.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2">superscript</csymbol><ci id="S2.E13.m1.2.2.2.2.2.4.cmml" xref="S2.E13.m1.2.2.2.2.2.4">𝑒</ci><apply id="S2.E13.m1.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2"><divide id="S2.E13.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.3"></divide><apply id="S2.E13.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2"><times id="S2.E13.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.3"></times><ci id="S2.E13.m1.2.2.2.2.2.2.2.2.4.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.4">s</ci><interval closure="open" id="S2.E13.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2"><apply id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">Z</mtext></ci><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.2">Z</mtext></ci><ci id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.2.2.3">𝑂</ci></apply></interval></apply><ci id="S2.E13.m1.2.2.2.2.2.2.2.4.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.4">𝜏</ci></apply></apply></apply><ci id="S2.E13.m1.2.2.2.4a.cmml" xref="S2.E13.m1.2.2.2.4"><mtext id="S2.E13.m1.2.2.2.4.cmml" mathsize="70%" xref="S2.E13.m1.2.2.2.4">Positive Pair</mtext></ci></apply><apply id="S2.E13.m1.6.6.6.cmml" xref="S2.E13.m1.6.6.6"><plus id="S2.E13.m1.6.6.6.5.cmml" xref="S2.E13.m1.6.6.6.5"></plus><apply id="S2.E13.m1.6.6.6.6.cmml" xref="S2.E13.m1.6.6.6.6"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.6.6.1.cmml" xref="S2.E13.m1.6.6.6.6">subscript</csymbol><apply id="S2.E13.m1.4.4.4.2.cmml" xref="S2.E13.m1.4.4.4.2"><ci id="S2.E13.m1.4.4.4.2.3.cmml" xref="S2.E13.m1.4.4.4.2.3">⏟</ci><apply id="S2.E13.m1.4.4.4.2.2.cmml" xref="S2.E13.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.4.4.4.2.2.3.cmml" xref="S2.E13.m1.4.4.4.2.2">superscript</csymbol><ci id="S2.E13.m1.4.4.4.2.2.4.cmml" xref="S2.E13.m1.4.4.4.2.2.4">𝑒</ci><apply id="S2.E13.m1.4.4.4.2.2.2.2.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2"><divide id="S2.E13.m1.4.4.4.2.2.2.2.3.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.3"></divide><apply id="S2.E13.m1.4.4.4.2.2.2.2.2.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2"><times id="S2.E13.m1.4.4.4.2.2.2.2.2.3.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.3"></times><ci id="S2.E13.m1.4.4.4.2.2.2.2.2.4.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.4">s</ci><interval closure="open" id="S2.E13.m1.4.4.4.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2"><apply id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.2">Z</mtext></ci><ci id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.3.3.3.1.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.2">Z</mtext></ci><ci id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.2.2.2.2.3">𝑂</ci></apply></interval></apply><ci id="S2.E13.m1.4.4.4.2.2.2.2.4.cmml" xref="S2.E13.m1.4.4.4.2.2.2.2.4">𝜏</ci></apply></apply></apply><ci id="S2.E13.m1.6.6.6.6.2a.cmml" xref="S2.E13.m1.6.6.6.6.2"><mtext id="S2.E13.m1.6.6.6.6.2.cmml" mathsize="70%" xref="S2.E13.m1.6.6.6.6.2">Positive Pair </mtext></ci></apply><apply id="S2.E13.m1.6.6.6.7.cmml" xref="S2.E13.m1.6.6.6.7"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.6.7.1.cmml" xref="S2.E13.m1.6.6.6.7">subscript</csymbol><apply id="S2.E13.m1.6.6.6.4.cmml" xref="S2.E13.m1.6.6.6.4"><ci id="S2.E13.m1.6.6.6.4.3.cmml" xref="S2.E13.m1.6.6.6.4.3">⏟</ci><apply id="S2.E13.m1.6.6.6.4.2.cmml" xref="S2.E13.m1.6.6.6.4.2"><apply id="S2.E13.m1.6.6.6.4.2.3.cmml" xref="S2.E13.m1.6.6.6.4.2.3"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.6.4.2.3.1.cmml" xref="S2.E13.m1.6.6.6.4.2.3">subscript</csymbol><sum id="S2.E13.m1.6.6.6.4.2.3.2.cmml" xref="S2.E13.m1.6.6.6.4.2.3.2"></sum><apply id="S2.E13.m1.6.6.6.4.2.3.3.cmml" xref="S2.E13.m1.6.6.6.4.2.3.3"><neq id="S2.E13.m1.6.6.6.4.2.3.3.1.cmml" xref="S2.E13.m1.6.6.6.4.2.3.3.1"></neq><ci id="S2.E13.m1.6.6.6.4.2.3.3.2.cmml" xref="S2.E13.m1.6.6.6.4.2.3.3.2">𝑘</ci><ci id="S2.E13.m1.6.6.6.4.2.3.3.3.cmml" xref="S2.E13.m1.6.6.6.4.2.3.3.3">𝑖</ci></apply></apply><apply id="S2.E13.m1.6.6.6.4.2.4.cmml" xref="S2.E13.m1.6.6.6.4.2.4"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.6.4.2.4.1.cmml" xref="S2.E13.m1.6.6.6.4.2.4">superscript</csymbol><ci id="S2.E13.m1.6.6.6.4.2.4.2.cmml" xref="S2.E13.m1.6.6.6.4.2.4.2">𝑒</ci><apply id="S2.E13.m1.6.6.6.4.2.2.2.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2"><divide id="S2.E13.m1.6.6.6.4.2.2.2.3.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.3"></divide><apply id="S2.E13.m1.6.6.6.4.2.2.2.2.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2"><times id="S2.E13.m1.6.6.6.4.2.2.2.2.3.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.3"></times><ci id="S2.E13.m1.6.6.6.4.2.2.2.2.4.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.4">s</ci><interval closure="open" id="S2.E13.m1.6.6.6.4.2.2.2.2.2.3.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2"><apply id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.2">Z</mtext></ci><ci id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.5.5.5.3.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.2">Z</mtext></ci><ci id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.2.2.2.2.3">𝑂</ci></apply></interval></apply><ci id="S2.E13.m1.6.6.6.4.2.2.2.4.cmml" xref="S2.E13.m1.6.6.6.4.2.2.2.4">𝜏</ci></apply></apply></apply></apply><ci id="S2.E13.m1.6.6.6.7.2a.cmml" xref="S2.E13.m1.6.6.6.7.2"><mtext id="S2.E13.m1.6.6.6.7.2.cmml" mathsize="70%" xref="S2.E13.m1.6.6.6.7.2">Intent and Visit-Level</mtext></ci></apply><apply id="S2.E13.m1.6.6.6.8.cmml" xref="S2.E13.m1.6.6.6.8"><csymbol cd="ambiguous" id="S2.E13.m1.6.6.6.8.1.cmml" xref="S2.E13.m1.6.6.6.8">superscript</csymbol><ci id="S2.E13.m1.6.6.6.8.2.cmml" xref="S2.E13.m1.6.6.6.8.2">𝐼</ci><ci id="S2.E13.m1.6.6.6.8.3.cmml" xref="S2.E13.m1.6.6.6.8.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.6c">\mathcal{L}^{i}_{CL}=-\log\frac{\overbrace{e^{\mathrm{s}\left({\textbf{Z}}^{i}%
_{I},{\textbf{Z}}^{i}_{O}\right)/\tau}}^{\text{Positive Pair}}}{\underbrace{e^%
{\mathrm{s}\left({\textbf{Z}}^{i}_{I},{\textbf{Z}}^{i}_{O}\right)/\tau}}_{%
\text{Positive Pair }}+\underbrace{\sum_{k\neq i}e^{\mathrm{s}\left({\textbf{Z%
}}^{i}_{I},{\textbf{Z}}^{k}_{O}\right)/\tau}}_{\text{Intent and Visit-Level}}+%
I^{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.6d">caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT = - roman_log divide start_ARG over⏞ start_ARG italic_e start_POSTSUPERSCRIPT roman_s ( Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_POSTSUPERSCRIPT Positive Pair end_POSTSUPERSCRIPT end_ARG start_ARG under⏟ start_ARG italic_e start_POSTSUPERSCRIPT roman_s ( Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Positive Pair end_POSTSUBSCRIPT + under⏟ start_ARG ∑ start_POSTSUBSCRIPT italic_k ≠ italic_i end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT roman_s ( Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , Z start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Intent and Visit-Level end_POSTSUBSCRIPT + italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathcal{L}}^{i}_{CL}=-\log\frac{\overbrace{e^{\mathrm{s}\left({\textbf{Z%
}}^{i}_{I},\hat{\textbf{Z}}^{i}_{O}\right)/\tau}}^{\text{Positive Pair}}}{%
\underbrace{e^{\mathrm{s}\left({\textbf{Z}}^{i}_{I},\hat{\textbf{Z}}^{i}_{O}%
\right)/\tau}}_{\text{Positive Pair}}+\underbrace{\sum_{k\neq i}e^{\mathrm{s}%
\left({\textbf{Z}}^{i}_{I},\hat{\textbf{Z}}^{k}_{O}\right)/\tau}}_{\text{%
Intent and Cross-Visit}}+I^{i}}" class="ltx_Math" display="block" id="S2.E14.m1.6"><semantics id="S2.E14.m1.6a"><mrow id="S2.E14.m1.6.7" xref="S2.E14.m1.6.7.cmml"><msubsup id="S2.E14.m1.6.7.2" xref="S2.E14.m1.6.7.2.cmml"><mover accent="true" id="S2.E14.m1.6.7.2.2.2" xref="S2.E14.m1.6.7.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E14.m1.6.7.2.2.2.2" xref="S2.E14.m1.6.7.2.2.2.2.cmml">ℒ</mi><mo id="S2.E14.m1.6.7.2.2.2.1" xref="S2.E14.m1.6.7.2.2.2.1.cmml">^</mo></mover><mrow id="S2.E14.m1.6.7.2.3" xref="S2.E14.m1.6.7.2.3.cmml"><mi id="S2.E14.m1.6.7.2.3.2" xref="S2.E14.m1.6.7.2.3.2.cmml">C</mi><mo id="S2.E14.m1.6.7.2.3.1" xref="S2.E14.m1.6.7.2.3.1.cmml">⁢</mo><mi id="S2.E14.m1.6.7.2.3.3" xref="S2.E14.m1.6.7.2.3.3.cmml">L</mi></mrow><mi id="S2.E14.m1.6.7.2.2.3" xref="S2.E14.m1.6.7.2.2.3.cmml">i</mi></msubsup><mo id="S2.E14.m1.6.7.1" xref="S2.E14.m1.6.7.1.cmml">=</mo><mrow id="S2.E14.m1.6.7.3" xref="S2.E14.m1.6.7.3.cmml"><mo id="S2.E14.m1.6.7.3a" rspace="0.167em" xref="S2.E14.m1.6.7.3.cmml">−</mo><mrow id="S2.E14.m1.6.7.3.2" xref="S2.E14.m1.6.7.3.2.cmml"><mi id="S2.E14.m1.6.7.3.2.1" xref="S2.E14.m1.6.7.3.2.1.cmml">log</mi><mo id="S2.E14.m1.6.7.3.2a" lspace="0.167em" xref="S2.E14.m1.6.7.3.2.cmml">⁡</mo><mfrac id="S2.E14.m1.6.6" xref="S2.E14.m1.6.6.cmml"><mover id="S2.E14.m1.2.2.2" xref="S2.E14.m1.2.2.2.cmml"><mover accent="true" id="S2.E14.m1.2.2.2.2" xref="S2.E14.m1.2.2.2.2.cmml"><msup id="S2.E14.m1.2.2.2.2.2" xref="S2.E14.m1.2.2.2.2.2.cmml"><mi id="S2.E14.m1.2.2.2.2.2.4" xref="S2.E14.m1.2.2.2.2.2.4.cmml">e</mi><mrow id="S2.E14.m1.2.2.2.2.2.2.2" xref="S2.E14.m1.2.2.2.2.2.2.2.cmml"><mrow id="S2.E14.m1.2.2.2.2.2.2.2.2" xref="S2.E14.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E14.m1.2.2.2.2.2.2.2.2.4" mathvariant="normal" xref="S2.E14.m1.2.2.2.2.2.2.2.2.4.cmml">s</mi><mo id="S2.E14.m1.2.2.2.2.2.2.2.2.3" xref="S2.E14.m1.2.2.2.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.3.cmml"><mo id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.3" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">I</mi><mi id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.4" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.2a.cmml">Z</mtext><mo id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.1" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.3" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.3.cmml">O</mi><mi id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.3" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.5" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E14.m1.2.2.2.2.2.2.2.3" xref="S2.E14.m1.2.2.2.2.2.2.2.3.cmml">/</mo><mi id="S2.E14.m1.2.2.2.2.2.2.2.4" xref="S2.E14.m1.2.2.2.2.2.2.2.4.cmml">τ</mi></mrow></msup><mo id="S2.E14.m1.2.2.2.2.3" xref="S2.E14.m1.2.2.2.2.3.cmml">⏞</mo></mover><mtext id="S2.E14.m1.2.2.2.4" xref="S2.E14.m1.2.2.2.4a.cmml">Positive Pair</mtext></mover><mrow id="S2.E14.m1.6.6.6" xref="S2.E14.m1.6.6.6.cmml"><munder id="S2.E14.m1.6.6.6.6" xref="S2.E14.m1.6.6.6.6.cmml"><munder accentunder="true" id="S2.E14.m1.4.4.4.2" xref="S2.E14.m1.4.4.4.2.cmml"><msup id="S2.E14.m1.4.4.4.2.2" xref="S2.E14.m1.4.4.4.2.2.cmml"><mi id="S2.E14.m1.4.4.4.2.2.4" xref="S2.E14.m1.4.4.4.2.2.4.cmml">e</mi><mrow id="S2.E14.m1.4.4.4.2.2.2.2" xref="S2.E14.m1.4.4.4.2.2.2.2.cmml"><mrow id="S2.E14.m1.4.4.4.2.2.2.2.2" xref="S2.E14.m1.4.4.4.2.2.2.2.2.cmml"><mi id="S2.E14.m1.4.4.4.2.2.2.2.2.4" mathvariant="normal" xref="S2.E14.m1.4.4.4.2.2.2.2.2.4.cmml">s</mi><mo id="S2.E14.m1.4.4.4.2.2.2.2.2.3" xref="S2.E14.m1.4.4.4.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.3.cmml"><mo id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.3" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.2" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.3.cmml">I</mi><mi id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.3" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.4" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.2a.cmml">Z</mtext><mo id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.1" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.3" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.3.cmml">O</mi><mi id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.3" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.5" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E14.m1.4.4.4.2.2.2.2.3" xref="S2.E14.m1.4.4.4.2.2.2.2.3.cmml">/</mo><mi id="S2.E14.m1.4.4.4.2.2.2.2.4" xref="S2.E14.m1.4.4.4.2.2.2.2.4.cmml">τ</mi></mrow></msup><mo id="S2.E14.m1.4.4.4.2.3" xref="S2.E14.m1.4.4.4.2.3.cmml">⏟</mo></munder><mtext id="S2.E14.m1.6.6.6.6.2" xref="S2.E14.m1.6.6.6.6.2a.cmml">Positive Pair</mtext></munder><mo id="S2.E14.m1.6.6.6.5" rspace="0.055em" xref="S2.E14.m1.6.6.6.5.cmml">+</mo><munder id="S2.E14.m1.6.6.6.7" xref="S2.E14.m1.6.6.6.7.cmml"><munder accentunder="true" id="S2.E14.m1.6.6.6.4" xref="S2.E14.m1.6.6.6.4.cmml"><mrow id="S2.E14.m1.6.6.6.4.2" xref="S2.E14.m1.6.6.6.4.2.cmml"><msub id="S2.E14.m1.6.6.6.4.2.3" xref="S2.E14.m1.6.6.6.4.2.3.cmml"><mo id="S2.E14.m1.6.6.6.4.2.3.2" movablelimits="false" xref="S2.E14.m1.6.6.6.4.2.3.2.cmml">∑</mo><mrow id="S2.E14.m1.6.6.6.4.2.3.3" xref="S2.E14.m1.6.6.6.4.2.3.3.cmml"><mi id="S2.E14.m1.6.6.6.4.2.3.3.2" xref="S2.E14.m1.6.6.6.4.2.3.3.2.cmml">k</mi><mo id="S2.E14.m1.6.6.6.4.2.3.3.1" xref="S2.E14.m1.6.6.6.4.2.3.3.1.cmml">≠</mo><mi id="S2.E14.m1.6.6.6.4.2.3.3.3" xref="S2.E14.m1.6.6.6.4.2.3.3.3.cmml">i</mi></mrow></msub><msup id="S2.E14.m1.6.6.6.4.2.4" xref="S2.E14.m1.6.6.6.4.2.4.cmml"><mi id="S2.E14.m1.6.6.6.4.2.4.2" xref="S2.E14.m1.6.6.6.4.2.4.2.cmml">e</mi><mrow id="S2.E14.m1.6.6.6.4.2.2.2" xref="S2.E14.m1.6.6.6.4.2.2.2.cmml"><mrow id="S2.E14.m1.6.6.6.4.2.2.2.2" xref="S2.E14.m1.6.6.6.4.2.2.2.2.cmml"><mi id="S2.E14.m1.6.6.6.4.2.2.2.2.4" mathvariant="normal" xref="S2.E14.m1.6.6.6.4.2.2.2.2.4.cmml">s</mi><mo id="S2.E14.m1.6.6.6.4.2.2.2.2.3" xref="S2.E14.m1.6.6.6.4.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.3.cmml"><mo id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.3" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.2" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.2a.cmml">Z</mtext><mi id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.3" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml">I</mi><mi id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.3" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.4" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.2" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.2a.cmml">Z</mtext><mo id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.1" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.3" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.3.cmml">O</mi><mi id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.3" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.5" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E14.m1.6.6.6.4.2.2.2.3" xref="S2.E14.m1.6.6.6.4.2.2.2.3.cmml">/</mo><mi id="S2.E14.m1.6.6.6.4.2.2.2.4" xref="S2.E14.m1.6.6.6.4.2.2.2.4.cmml">τ</mi></mrow></msup></mrow><mo id="S2.E14.m1.6.6.6.4.3" xref="S2.E14.m1.6.6.6.4.3.cmml">⏟</mo></munder><mtext id="S2.E14.m1.6.6.6.7.2" xref="S2.E14.m1.6.6.6.7.2a.cmml">Intent and Cross-Visit</mtext></munder><mo id="S2.E14.m1.6.6.6.5a" xref="S2.E14.m1.6.6.6.5.cmml">+</mo><msup id="S2.E14.m1.6.6.6.8" xref="S2.E14.m1.6.6.6.8.cmml"><mi id="S2.E14.m1.6.6.6.8.2" xref="S2.E14.m1.6.6.6.8.2.cmml">I</mi><mi id="S2.E14.m1.6.6.6.8.3" xref="S2.E14.m1.6.6.6.8.3.cmml">i</mi></msup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E14.m1.6b"><apply id="S2.E14.m1.6.7.cmml" xref="S2.E14.m1.6.7"><eq id="S2.E14.m1.6.7.1.cmml" xref="S2.E14.m1.6.7.1"></eq><apply id="S2.E14.m1.6.7.2.cmml" xref="S2.E14.m1.6.7.2"><csymbol cd="ambiguous" id="S2.E14.m1.6.7.2.1.cmml" xref="S2.E14.m1.6.7.2">subscript</csymbol><apply id="S2.E14.m1.6.7.2.2.cmml" xref="S2.E14.m1.6.7.2"><csymbol cd="ambiguous" id="S2.E14.m1.6.7.2.2.1.cmml" xref="S2.E14.m1.6.7.2">superscript</csymbol><apply id="S2.E14.m1.6.7.2.2.2.cmml" xref="S2.E14.m1.6.7.2.2.2"><ci id="S2.E14.m1.6.7.2.2.2.1.cmml" xref="S2.E14.m1.6.7.2.2.2.1">^</ci><ci id="S2.E14.m1.6.7.2.2.2.2.cmml" xref="S2.E14.m1.6.7.2.2.2.2">ℒ</ci></apply><ci id="S2.E14.m1.6.7.2.2.3.cmml" xref="S2.E14.m1.6.7.2.2.3">𝑖</ci></apply><apply id="S2.E14.m1.6.7.2.3.cmml" xref="S2.E14.m1.6.7.2.3"><times id="S2.E14.m1.6.7.2.3.1.cmml" xref="S2.E14.m1.6.7.2.3.1"></times><ci id="S2.E14.m1.6.7.2.3.2.cmml" xref="S2.E14.m1.6.7.2.3.2">𝐶</ci><ci id="S2.E14.m1.6.7.2.3.3.cmml" xref="S2.E14.m1.6.7.2.3.3">𝐿</ci></apply></apply><apply id="S2.E14.m1.6.7.3.cmml" xref="S2.E14.m1.6.7.3"><minus id="S2.E14.m1.6.7.3.1.cmml" xref="S2.E14.m1.6.7.3"></minus><apply id="S2.E14.m1.6.7.3.2.cmml" xref="S2.E14.m1.6.7.3.2"><log id="S2.E14.m1.6.7.3.2.1.cmml" xref="S2.E14.m1.6.7.3.2.1"></log><apply id="S2.E14.m1.6.6.cmml" xref="S2.E14.m1.6.6"><divide id="S2.E14.m1.6.6.7.cmml" xref="S2.E14.m1.6.6"></divide><apply id="S2.E14.m1.2.2.2.cmml" xref="S2.E14.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2">superscript</csymbol><apply id="S2.E14.m1.2.2.2.2.cmml" xref="S2.E14.m1.2.2.2.2"><ci id="S2.E14.m1.2.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2.2.3">⏞</ci><apply id="S2.E14.m1.2.2.2.2.2.cmml" xref="S2.E14.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2.2.2">superscript</csymbol><ci id="S2.E14.m1.2.2.2.2.2.4.cmml" xref="S2.E14.m1.2.2.2.2.2.4">𝑒</ci><apply id="S2.E14.m1.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2"><divide id="S2.E14.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.3"></divide><apply id="S2.E14.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2"><times id="S2.E14.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.3"></times><ci id="S2.E14.m1.2.2.2.2.2.2.2.2.4.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.4">s</ci><interval closure="open" id="S2.E14.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2"><apply id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">Z</mtext></ci><ci id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E14.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2"><ci id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.2">Z</mtext></ci></apply><ci id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.2.2.2.2.3">𝑂</ci></apply></interval></apply><ci id="S2.E14.m1.2.2.2.2.2.2.2.4.cmml" xref="S2.E14.m1.2.2.2.2.2.2.2.4">𝜏</ci></apply></apply></apply><ci id="S2.E14.m1.2.2.2.4a.cmml" xref="S2.E14.m1.2.2.2.4"><mtext id="S2.E14.m1.2.2.2.4.cmml" mathsize="70%" xref="S2.E14.m1.2.2.2.4">Positive Pair</mtext></ci></apply><apply id="S2.E14.m1.6.6.6.cmml" xref="S2.E14.m1.6.6.6"><plus id="S2.E14.m1.6.6.6.5.cmml" xref="S2.E14.m1.6.6.6.5"></plus><apply id="S2.E14.m1.6.6.6.6.cmml" xref="S2.E14.m1.6.6.6.6"><csymbol cd="ambiguous" id="S2.E14.m1.6.6.6.6.1.cmml" xref="S2.E14.m1.6.6.6.6">subscript</csymbol><apply id="S2.E14.m1.4.4.4.2.cmml" xref="S2.E14.m1.4.4.4.2"><ci id="S2.E14.m1.4.4.4.2.3.cmml" xref="S2.E14.m1.4.4.4.2.3">⏟</ci><apply id="S2.E14.m1.4.4.4.2.2.cmml" xref="S2.E14.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.4.4.4.2.2.3.cmml" xref="S2.E14.m1.4.4.4.2.2">superscript</csymbol><ci id="S2.E14.m1.4.4.4.2.2.4.cmml" xref="S2.E14.m1.4.4.4.2.2.4">𝑒</ci><apply id="S2.E14.m1.4.4.4.2.2.2.2.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2"><divide id="S2.E14.m1.4.4.4.2.2.2.2.3.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.3"></divide><apply id="S2.E14.m1.4.4.4.2.2.2.2.2.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2"><times id="S2.E14.m1.4.4.4.2.2.2.2.2.3.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.3"></times><ci id="S2.E14.m1.4.4.4.2.2.2.2.2.4.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.4">s</ci><interval closure="open" id="S2.E14.m1.4.4.4.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2"><apply id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.2">Z</mtext></ci><ci id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E14.m1.3.3.3.1.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2"><ci id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.2.2">Z</mtext></ci></apply><ci id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.2.2.2.2.3">𝑂</ci></apply></interval></apply><ci id="S2.E14.m1.4.4.4.2.2.2.2.4.cmml" xref="S2.E14.m1.4.4.4.2.2.2.2.4">𝜏</ci></apply></apply></apply><ci id="S2.E14.m1.6.6.6.6.2a.cmml" xref="S2.E14.m1.6.6.6.6.2"><mtext id="S2.E14.m1.6.6.6.6.2.cmml" mathsize="70%" xref="S2.E14.m1.6.6.6.6.2">Positive Pair</mtext></ci></apply><apply id="S2.E14.m1.6.6.6.7.cmml" xref="S2.E14.m1.6.6.6.7"><csymbol cd="ambiguous" id="S2.E14.m1.6.6.6.7.1.cmml" xref="S2.E14.m1.6.6.6.7">subscript</csymbol><apply id="S2.E14.m1.6.6.6.4.cmml" xref="S2.E14.m1.6.6.6.4"><ci id="S2.E14.m1.6.6.6.4.3.cmml" xref="S2.E14.m1.6.6.6.4.3">⏟</ci><apply id="S2.E14.m1.6.6.6.4.2.cmml" xref="S2.E14.m1.6.6.6.4.2"><apply id="S2.E14.m1.6.6.6.4.2.3.cmml" xref="S2.E14.m1.6.6.6.4.2.3"><csymbol cd="ambiguous" id="S2.E14.m1.6.6.6.4.2.3.1.cmml" xref="S2.E14.m1.6.6.6.4.2.3">subscript</csymbol><sum id="S2.E14.m1.6.6.6.4.2.3.2.cmml" xref="S2.E14.m1.6.6.6.4.2.3.2"></sum><apply id="S2.E14.m1.6.6.6.4.2.3.3.cmml" xref="S2.E14.m1.6.6.6.4.2.3.3"><neq id="S2.E14.m1.6.6.6.4.2.3.3.1.cmml" xref="S2.E14.m1.6.6.6.4.2.3.3.1"></neq><ci id="S2.E14.m1.6.6.6.4.2.3.3.2.cmml" xref="S2.E14.m1.6.6.6.4.2.3.3.2">𝑘</ci><ci id="S2.E14.m1.6.6.6.4.2.3.3.3.cmml" xref="S2.E14.m1.6.6.6.4.2.3.3.3">𝑖</ci></apply></apply><apply id="S2.E14.m1.6.6.6.4.2.4.cmml" xref="S2.E14.m1.6.6.6.4.2.4"><csymbol cd="ambiguous" id="S2.E14.m1.6.6.6.4.2.4.1.cmml" xref="S2.E14.m1.6.6.6.4.2.4">superscript</csymbol><ci id="S2.E14.m1.6.6.6.4.2.4.2.cmml" xref="S2.E14.m1.6.6.6.4.2.4.2">𝑒</ci><apply id="S2.E14.m1.6.6.6.4.2.2.2.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2"><divide id="S2.E14.m1.6.6.6.4.2.2.2.3.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.3"></divide><apply id="S2.E14.m1.6.6.6.4.2.2.2.2.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2"><times id="S2.E14.m1.6.6.6.4.2.2.2.2.3.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.3"></times><ci id="S2.E14.m1.6.6.6.4.2.2.2.2.4.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.4">s</ci><interval closure="open" id="S2.E14.m1.6.6.6.4.2.2.2.2.2.3.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2"><apply id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.2">Z</mtext></ci><ci id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E14.m1.5.5.5.3.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2"><ci id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.2.2">Z</mtext></ci></apply><ci id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.3.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.2.2.2.2.3">𝑂</ci></apply></interval></apply><ci id="S2.E14.m1.6.6.6.4.2.2.2.4.cmml" xref="S2.E14.m1.6.6.6.4.2.2.2.4">𝜏</ci></apply></apply></apply></apply><ci id="S2.E14.m1.6.6.6.7.2a.cmml" xref="S2.E14.m1.6.6.6.7.2"><mtext id="S2.E14.m1.6.6.6.7.2.cmml" mathsize="70%" xref="S2.E14.m1.6.6.6.7.2">Intent and Cross-Visit</mtext></ci></apply><apply id="S2.E14.m1.6.6.6.8.cmml" xref="S2.E14.m1.6.6.6.8"><csymbol cd="ambiguous" id="S2.E14.m1.6.6.6.8.1.cmml" xref="S2.E14.m1.6.6.6.8">superscript</csymbol><ci id="S2.E14.m1.6.6.6.8.2.cmml" xref="S2.E14.m1.6.6.6.8.2">𝐼</ci><ci id="S2.E14.m1.6.6.6.8.3.cmml" xref="S2.E14.m1.6.6.6.8.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E14.m1.6c">\hat{\mathcal{L}}^{i}_{CL}=-\log\frac{\overbrace{e^{\mathrm{s}\left({\textbf{Z%
}}^{i}_{I},\hat{\textbf{Z}}^{i}_{O}\right)/\tau}}^{\text{Positive Pair}}}{%
\underbrace{e^{\mathrm{s}\left({\textbf{Z}}^{i}_{I},\hat{\textbf{Z}}^{i}_{O}%
\right)/\tau}}_{\text{Positive Pair}}+\underbrace{\sum_{k\neq i}e^{\mathrm{s}%
\left({\textbf{Z}}^{i}_{I},\hat{\textbf{Z}}^{k}_{O}\right)/\tau}}_{\text{%
Intent and Cross-Visit}}+I^{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.E14.m1.6d">over^ start_ARG caligraphic_L end_ARG start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT = - roman_log divide start_ARG over⏞ start_ARG italic_e start_POSTSUPERSCRIPT roman_s ( Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , over^ start_ARG Z end_ARG start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_POSTSUPERSCRIPT Positive Pair end_POSTSUPERSCRIPT end_ARG start_ARG under⏟ start_ARG italic_e start_POSTSUPERSCRIPT roman_s ( Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , over^ start_ARG Z end_ARG start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Positive Pair end_POSTSUBSCRIPT + under⏟ start_ARG ∑ start_POSTSUBSCRIPT italic_k ≠ italic_i end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT roman_s ( Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , over^ start_ARG Z end_ARG start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT Intent and Cross-Visit end_POSTSUBSCRIPT + italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\mathcal{L}}_{I}=\sum^{J}_{i=1}{\mathcal{L}^{i}_{CL}}+{\hat{\mathcal{L%
}}^{i}_{CL}}" class="ltx_Math" display="block" id="S2.E15.m1.1"><semantics id="S2.E15.m1.1a"><mrow id="S2.E15.m1.1.1" xref="S2.E15.m1.1.1.cmml"><msub id="S2.E15.m1.1.1.2" xref="S2.E15.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.1.1.2.2" xref="S2.E15.m1.1.1.2.2.cmml">ℒ</mi><mi id="S2.E15.m1.1.1.2.3" xref="S2.E15.m1.1.1.2.3.cmml">I</mi></msub><mo id="S2.E15.m1.1.1.1" rspace="0.111em" xref="S2.E15.m1.1.1.1.cmml">=</mo><mrow id="S2.E15.m1.1.1.3" xref="S2.E15.m1.1.1.3.cmml"><mrow id="S2.E15.m1.1.1.3.2" xref="S2.E15.m1.1.1.3.2.cmml"><munderover id="S2.E15.m1.1.1.3.2.1" xref="S2.E15.m1.1.1.3.2.1.cmml"><mo id="S2.E15.m1.1.1.3.2.1.2.2" movablelimits="false" xref="S2.E15.m1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S2.E15.m1.1.1.3.2.1.3" xref="S2.E15.m1.1.1.3.2.1.3.cmml"><mi id="S2.E15.m1.1.1.3.2.1.3.2" xref="S2.E15.m1.1.1.3.2.1.3.2.cmml">i</mi><mo id="S2.E15.m1.1.1.3.2.1.3.1" xref="S2.E15.m1.1.1.3.2.1.3.1.cmml">=</mo><mn id="S2.E15.m1.1.1.3.2.1.3.3" xref="S2.E15.m1.1.1.3.2.1.3.3.cmml">1</mn></mrow><mi id="S2.E15.m1.1.1.3.2.1.2.3" xref="S2.E15.m1.1.1.3.2.1.2.3.cmml">J</mi></munderover><msubsup id="S2.E15.m1.1.1.3.2.2" xref="S2.E15.m1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.1.1.3.2.2.2.2" xref="S2.E15.m1.1.1.3.2.2.2.2.cmml">ℒ</mi><mrow id="S2.E15.m1.1.1.3.2.2.3" xref="S2.E15.m1.1.1.3.2.2.3.cmml"><mi id="S2.E15.m1.1.1.3.2.2.3.2" xref="S2.E15.m1.1.1.3.2.2.3.2.cmml">C</mi><mo id="S2.E15.m1.1.1.3.2.2.3.1" xref="S2.E15.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E15.m1.1.1.3.2.2.3.3" xref="S2.E15.m1.1.1.3.2.2.3.3.cmml">L</mi></mrow><mi id="S2.E15.m1.1.1.3.2.2.2.3" xref="S2.E15.m1.1.1.3.2.2.2.3.cmml">i</mi></msubsup></mrow><mo id="S2.E15.m1.1.1.3.1" xref="S2.E15.m1.1.1.3.1.cmml">+</mo><msubsup id="S2.E15.m1.1.1.3.3" xref="S2.E15.m1.1.1.3.3.cmml"><mover accent="true" id="S2.E15.m1.1.1.3.3.2.2" xref="S2.E15.m1.1.1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E15.m1.1.1.3.3.2.2.2" xref="S2.E15.m1.1.1.3.3.2.2.2.cmml">ℒ</mi><mo id="S2.E15.m1.1.1.3.3.2.2.1" xref="S2.E15.m1.1.1.3.3.2.2.1.cmml">^</mo></mover><mrow id="S2.E15.m1.1.1.3.3.3" xref="S2.E15.m1.1.1.3.3.3.cmml"><mi id="S2.E15.m1.1.1.3.3.3.2" xref="S2.E15.m1.1.1.3.3.3.2.cmml">C</mi><mo id="S2.E15.m1.1.1.3.3.3.1" xref="S2.E15.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S2.E15.m1.1.1.3.3.3.3" xref="S2.E15.m1.1.1.3.3.3.3.cmml">L</mi></mrow><mi id="S2.E15.m1.1.1.3.3.2.3" xref="S2.E15.m1.1.1.3.3.2.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E15.m1.1b"><apply id="S2.E15.m1.1.1.cmml" xref="S2.E15.m1.1.1"><eq id="S2.E15.m1.1.1.1.cmml" xref="S2.E15.m1.1.1.1"></eq><apply id="S2.E15.m1.1.1.2.cmml" xref="S2.E15.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.2.1.cmml" xref="S2.E15.m1.1.1.2">subscript</csymbol><ci id="S2.E15.m1.1.1.2.2.cmml" xref="S2.E15.m1.1.1.2.2">ℒ</ci><ci id="S2.E15.m1.1.1.2.3.cmml" xref="S2.E15.m1.1.1.2.3">𝐼</ci></apply><apply id="S2.E15.m1.1.1.3.cmml" xref="S2.E15.m1.1.1.3"><plus id="S2.E15.m1.1.1.3.1.cmml" xref="S2.E15.m1.1.1.3.1"></plus><apply id="S2.E15.m1.1.1.3.2.cmml" xref="S2.E15.m1.1.1.3.2"><apply id="S2.E15.m1.1.1.3.2.1.cmml" xref="S2.E15.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.3.2.1.1.cmml" xref="S2.E15.m1.1.1.3.2.1">subscript</csymbol><apply id="S2.E15.m1.1.1.3.2.1.2.cmml" xref="S2.E15.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.3.2.1.2.1.cmml" xref="S2.E15.m1.1.1.3.2.1">superscript</csymbol><sum id="S2.E15.m1.1.1.3.2.1.2.2.cmml" xref="S2.E15.m1.1.1.3.2.1.2.2"></sum><ci id="S2.E15.m1.1.1.3.2.1.2.3.cmml" xref="S2.E15.m1.1.1.3.2.1.2.3">𝐽</ci></apply><apply id="S2.E15.m1.1.1.3.2.1.3.cmml" xref="S2.E15.m1.1.1.3.2.1.3"><eq id="S2.E15.m1.1.1.3.2.1.3.1.cmml" xref="S2.E15.m1.1.1.3.2.1.3.1"></eq><ci id="S2.E15.m1.1.1.3.2.1.3.2.cmml" xref="S2.E15.m1.1.1.3.2.1.3.2">𝑖</ci><cn id="S2.E15.m1.1.1.3.2.1.3.3.cmml" type="integer" xref="S2.E15.m1.1.1.3.2.1.3.3">1</cn></apply></apply><apply id="S2.E15.m1.1.1.3.2.2.cmml" xref="S2.E15.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.3.2.2.1.cmml" xref="S2.E15.m1.1.1.3.2.2">subscript</csymbol><apply id="S2.E15.m1.1.1.3.2.2.2.cmml" xref="S2.E15.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.3.2.2.2.1.cmml" xref="S2.E15.m1.1.1.3.2.2">superscript</csymbol><ci id="S2.E15.m1.1.1.3.2.2.2.2.cmml" xref="S2.E15.m1.1.1.3.2.2.2.2">ℒ</ci><ci id="S2.E15.m1.1.1.3.2.2.2.3.cmml" xref="S2.E15.m1.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="S2.E15.m1.1.1.3.2.2.3.cmml" xref="S2.E15.m1.1.1.3.2.2.3"><times id="S2.E15.m1.1.1.3.2.2.3.1.cmml" xref="S2.E15.m1.1.1.3.2.2.3.1"></times><ci id="S2.E15.m1.1.1.3.2.2.3.2.cmml" xref="S2.E15.m1.1.1.3.2.2.3.2">𝐶</ci><ci id="S2.E15.m1.1.1.3.2.2.3.3.cmml" xref="S2.E15.m1.1.1.3.2.2.3.3">𝐿</ci></apply></apply></apply><apply id="S2.E15.m1.1.1.3.3.cmml" xref="S2.E15.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.3.3.1.cmml" xref="S2.E15.m1.1.1.3.3">subscript</csymbol><apply id="S2.E15.m1.1.1.3.3.2.cmml" xref="S2.E15.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E15.m1.1.1.3.3.2.1.cmml" xref="S2.E15.m1.1.1.3.3">superscript</csymbol><apply id="S2.E15.m1.1.1.3.3.2.2.cmml" xref="S2.E15.m1.1.1.3.3.2.2"><ci id="S2.E15.m1.1.1.3.3.2.2.1.cmml" xref="S2.E15.m1.1.1.3.3.2.2.1">^</ci><ci id="S2.E15.m1.1.1.3.3.2.2.2.cmml" xref="S2.E15.m1.1.1.3.3.2.2.2">ℒ</ci></apply><ci id="S2.E15.m1.1.1.3.3.2.3.cmml" xref="S2.E15.m1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S2.E15.m1.1.1.3.3.3.cmml" xref="S2.E15.m1.1.1.3.3.3"><times id="S2.E15.m1.1.1.3.3.3.1.cmml" xref="S2.E15.m1.1.1.3.3.3.1"></times><ci id="S2.E15.m1.1.1.3.3.3.2.cmml" xref="S2.E15.m1.1.1.3.3.3.2">𝐶</ci><ci id="S2.E15.m1.1.1.3.3.3.3.cmml" xref="S2.E15.m1.1.1.3.3.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E15.m1.1c">\mathbf{\mathcal{L}}_{I}=\sum^{J}_{i=1}{\mathcal{L}^{i}_{CL}}+{\hat{\mathcal{L%
}}^{i}_{CL}}</annotation><annotation encoding="application/x-llamapun" id="S2.E15.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT = ∑ start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT + over^ start_ARG caligraphic_L end_ARG start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p5.9">In these equations, <math alttext="I^{i}=\sum_{k\neq i}e^{\mathrm{s}\left(\textbf{Z}^{i}_{I},\textbf{Z}^{K}_{I}%
\right)/\tau}" class="ltx_Math" display="inline" id="S2.SS4.p5.3.m1.2"><semantics id="S2.SS4.p5.3.m1.2a"><mrow id="S2.SS4.p5.3.m1.2.3" xref="S2.SS4.p5.3.m1.2.3.cmml"><msup id="S2.SS4.p5.3.m1.2.3.2" xref="S2.SS4.p5.3.m1.2.3.2.cmml"><mi id="S2.SS4.p5.3.m1.2.3.2.2" xref="S2.SS4.p5.3.m1.2.3.2.2.cmml">I</mi><mi id="S2.SS4.p5.3.m1.2.3.2.3" xref="S2.SS4.p5.3.m1.2.3.2.3.cmml">i</mi></msup><mo id="S2.SS4.p5.3.m1.2.3.1" rspace="0.111em" xref="S2.SS4.p5.3.m1.2.3.1.cmml">=</mo><mrow id="S2.SS4.p5.3.m1.2.3.3" xref="S2.SS4.p5.3.m1.2.3.3.cmml"><msub id="S2.SS4.p5.3.m1.2.3.3.1" xref="S2.SS4.p5.3.m1.2.3.3.1.cmml"><mo id="S2.SS4.p5.3.m1.2.3.3.1.2" xref="S2.SS4.p5.3.m1.2.3.3.1.2.cmml">∑</mo><mrow id="S2.SS4.p5.3.m1.2.3.3.1.3" xref="S2.SS4.p5.3.m1.2.3.3.1.3.cmml"><mi id="S2.SS4.p5.3.m1.2.3.3.1.3.2" xref="S2.SS4.p5.3.m1.2.3.3.1.3.2.cmml">k</mi><mo id="S2.SS4.p5.3.m1.2.3.3.1.3.1" xref="S2.SS4.p5.3.m1.2.3.3.1.3.1.cmml">≠</mo><mi id="S2.SS4.p5.3.m1.2.3.3.1.3.3" xref="S2.SS4.p5.3.m1.2.3.3.1.3.3.cmml">i</mi></mrow></msub><msup id="S2.SS4.p5.3.m1.2.3.3.2" xref="S2.SS4.p5.3.m1.2.3.3.2.cmml"><mi id="S2.SS4.p5.3.m1.2.3.3.2.2" xref="S2.SS4.p5.3.m1.2.3.3.2.2.cmml">e</mi><mrow id="S2.SS4.p5.3.m1.2.2.2" xref="S2.SS4.p5.3.m1.2.2.2.cmml"><mrow id="S2.SS4.p5.3.m1.2.2.2.2" xref="S2.SS4.p5.3.m1.2.2.2.2.cmml"><mi id="S2.SS4.p5.3.m1.2.2.2.2.4" mathvariant="normal" xref="S2.SS4.p5.3.m1.2.2.2.2.4.cmml">s</mi><mo id="S2.SS4.p5.3.m1.2.2.2.2.3" xref="S2.SS4.p5.3.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.SS4.p5.3.m1.2.2.2.2.2.2" xref="S2.SS4.p5.3.m1.2.2.2.2.2.3.cmml"><mo id="S2.SS4.p5.3.m1.2.2.2.2.2.2.3" xref="S2.SS4.p5.3.m1.2.2.2.2.2.3.cmml">(</mo><msubsup id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.2" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.2a.cmml">Z</mtext><mi id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.3" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.3.cmml">I</mi><mi id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.3" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S2.SS4.p5.3.m1.2.2.2.2.2.2.4" xref="S2.SS4.p5.3.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.2" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.2a.cmml">Z</mtext><mi id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.3" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.3.cmml">I</mi><mi id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.3" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S2.SS4.p5.3.m1.2.2.2.2.2.2.5" xref="S2.SS4.p5.3.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS4.p5.3.m1.2.2.2.3" xref="S2.SS4.p5.3.m1.2.2.2.3.cmml">/</mo><mi id="S2.SS4.p5.3.m1.2.2.2.4" xref="S2.SS4.p5.3.m1.2.2.2.4.cmml">τ</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.3.m1.2b"><apply id="S2.SS4.p5.3.m1.2.3.cmml" xref="S2.SS4.p5.3.m1.2.3"><eq id="S2.SS4.p5.3.m1.2.3.1.cmml" xref="S2.SS4.p5.3.m1.2.3.1"></eq><apply id="S2.SS4.p5.3.m1.2.3.2.cmml" xref="S2.SS4.p5.3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS4.p5.3.m1.2.3.2.1.cmml" xref="S2.SS4.p5.3.m1.2.3.2">superscript</csymbol><ci id="S2.SS4.p5.3.m1.2.3.2.2.cmml" xref="S2.SS4.p5.3.m1.2.3.2.2">𝐼</ci><ci id="S2.SS4.p5.3.m1.2.3.2.3.cmml" xref="S2.SS4.p5.3.m1.2.3.2.3">𝑖</ci></apply><apply id="S2.SS4.p5.3.m1.2.3.3.cmml" xref="S2.SS4.p5.3.m1.2.3.3"><apply id="S2.SS4.p5.3.m1.2.3.3.1.cmml" xref="S2.SS4.p5.3.m1.2.3.3.1"><csymbol cd="ambiguous" id="S2.SS4.p5.3.m1.2.3.3.1.1.cmml" xref="S2.SS4.p5.3.m1.2.3.3.1">subscript</csymbol><sum id="S2.SS4.p5.3.m1.2.3.3.1.2.cmml" xref="S2.SS4.p5.3.m1.2.3.3.1.2"></sum><apply id="S2.SS4.p5.3.m1.2.3.3.1.3.cmml" xref="S2.SS4.p5.3.m1.2.3.3.1.3"><neq id="S2.SS4.p5.3.m1.2.3.3.1.3.1.cmml" xref="S2.SS4.p5.3.m1.2.3.3.1.3.1"></neq><ci id="S2.SS4.p5.3.m1.2.3.3.1.3.2.cmml" xref="S2.SS4.p5.3.m1.2.3.3.1.3.2">𝑘</ci><ci id="S2.SS4.p5.3.m1.2.3.3.1.3.3.cmml" xref="S2.SS4.p5.3.m1.2.3.3.1.3.3">𝑖</ci></apply></apply><apply id="S2.SS4.p5.3.m1.2.3.3.2.cmml" xref="S2.SS4.p5.3.m1.2.3.3.2"><csymbol cd="ambiguous" id="S2.SS4.p5.3.m1.2.3.3.2.1.cmml" xref="S2.SS4.p5.3.m1.2.3.3.2">superscript</csymbol><ci id="S2.SS4.p5.3.m1.2.3.3.2.2.cmml" xref="S2.SS4.p5.3.m1.2.3.3.2.2">𝑒</ci><apply id="S2.SS4.p5.3.m1.2.2.2.cmml" xref="S2.SS4.p5.3.m1.2.2.2"><divide id="S2.SS4.p5.3.m1.2.2.2.3.cmml" xref="S2.SS4.p5.3.m1.2.2.2.3"></divide><apply id="S2.SS4.p5.3.m1.2.2.2.2.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2"><times id="S2.SS4.p5.3.m1.2.2.2.2.3.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.3"></times><ci id="S2.SS4.p5.3.m1.2.2.2.2.4.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.4">s</ci><interval closure="open" id="S2.SS4.p5.3.m1.2.2.2.2.2.3.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2"><apply id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.2.cmml" mathsize="70%" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.2">Z</mtext></ci><ci id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p5.3.m1.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.2a.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.2">Z</mtext></ci><ci id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.2.3">𝐾</ci></apply><ci id="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.SS4.p5.3.m1.2.2.2.2.2.2.2.3">𝐼</ci></apply></interval></apply><ci id="S2.SS4.p5.3.m1.2.2.2.4.cmml" xref="S2.SS4.p5.3.m1.2.2.2.4">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.3.m1.2c">I^{i}=\sum_{k\neq i}e^{\mathrm{s}\left(\textbf{Z}^{i}_{I},\textbf{Z}^{K}_{I}%
\right)/\tau}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.3.m1.2d">italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_k ≠ italic_i end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT roman_s ( Z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT , Z start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ) / italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> considers the different intents as negative pairs, <math alttext="\mathbf{\mathrm{s}}" class="ltx_Math" display="inline" id="S2.SS4.p5.4.m2.1"><semantics id="S2.SS4.p5.4.m2.1a"><mi id="S2.SS4.p5.4.m2.1.1" mathvariant="normal" xref="S2.SS4.p5.4.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.4.m2.1b"><ci id="S2.SS4.p5.4.m2.1.1.cmml" xref="S2.SS4.p5.4.m2.1.1">s</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.4.m2.1c">\mathbf{\mathrm{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.4.m2.1d">roman_s</annotation></semantics></math> denotes the cosine similarity function, <math alttext="\tau" class="ltx_Math" display="inline" id="S2.SS4.p5.5.m3.1"><semantics id="S2.SS4.p5.5.m3.1a"><mi id="S2.SS4.p5.5.m3.1.1" xref="S2.SS4.p5.5.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.5.m3.1b"><ci id="S2.SS4.p5.5.m3.1.1.cmml" xref="S2.SS4.p5.5.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.5.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.5.m3.1d">italic_τ</annotation></semantics></math> shows the temperature value.
<math alttext="\mathcal{L}^{i}_{CL}" class="ltx_Math" display="inline" id="S2.SS4.p5.6.m4.1"><semantics id="S2.SS4.p5.6.m4.1a"><msubsup id="S2.SS4.p5.6.m4.1.1" xref="S2.SS4.p5.6.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.6.m4.1.1.2.2" xref="S2.SS4.p5.6.m4.1.1.2.2.cmml">ℒ</mi><mrow id="S2.SS4.p5.6.m4.1.1.3" xref="S2.SS4.p5.6.m4.1.1.3.cmml"><mi id="S2.SS4.p5.6.m4.1.1.3.2" xref="S2.SS4.p5.6.m4.1.1.3.2.cmml">C</mi><mo id="S2.SS4.p5.6.m4.1.1.3.1" xref="S2.SS4.p5.6.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p5.6.m4.1.1.3.3" xref="S2.SS4.p5.6.m4.1.1.3.3.cmml">L</mi></mrow><mi id="S2.SS4.p5.6.m4.1.1.2.3" xref="S2.SS4.p5.6.m4.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.6.m4.1b"><apply id="S2.SS4.p5.6.m4.1.1.cmml" xref="S2.SS4.p5.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.6.m4.1.1.1.cmml" xref="S2.SS4.p5.6.m4.1.1">subscript</csymbol><apply id="S2.SS4.p5.6.m4.1.1.2.cmml" xref="S2.SS4.p5.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.6.m4.1.1.2.1.cmml" xref="S2.SS4.p5.6.m4.1.1">superscript</csymbol><ci id="S2.SS4.p5.6.m4.1.1.2.2.cmml" xref="S2.SS4.p5.6.m4.1.1.2.2">ℒ</ci><ci id="S2.SS4.p5.6.m4.1.1.2.3.cmml" xref="S2.SS4.p5.6.m4.1.1.2.3">𝑖</ci></apply><apply id="S2.SS4.p5.6.m4.1.1.3.cmml" xref="S2.SS4.p5.6.m4.1.1.3"><times id="S2.SS4.p5.6.m4.1.1.3.1.cmml" xref="S2.SS4.p5.6.m4.1.1.3.1"></times><ci id="S2.SS4.p5.6.m4.1.1.3.2.cmml" xref="S2.SS4.p5.6.m4.1.1.3.2">𝐶</ci><ci id="S2.SS4.p5.6.m4.1.1.3.3.cmml" xref="S2.SS4.p5.6.m4.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.6.m4.1c">\mathcal{L}^{i}_{CL}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.6.m4.1d">caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math> indicates the contrastive learning loss for intent <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.p5.7.m5.1"><semantics id="S2.SS4.p5.7.m5.1a"><mi id="S2.SS4.p5.7.m5.1.1" xref="S2.SS4.p5.7.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.7.m5.1b"><ci id="S2.SS4.p5.7.m5.1.1.cmml" xref="S2.SS4.p5.7.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.7.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.7.m5.1d">italic_i</annotation></semantics></math> as the anchor and Visit-Level Transformer heads, while <math alttext="{\hat{\mathcal{L}}^{i}_{CL}}" class="ltx_Math" display="inline" id="S2.SS4.p5.8.m6.1"><semantics id="S2.SS4.p5.8.m6.1a"><msubsup id="S2.SS4.p5.8.m6.1.1" xref="S2.SS4.p5.8.m6.1.1.cmml"><mover accent="true" id="S2.SS4.p5.8.m6.1.1.2.2" xref="S2.SS4.p5.8.m6.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.8.m6.1.1.2.2.2" xref="S2.SS4.p5.8.m6.1.1.2.2.2.cmml">ℒ</mi><mo id="S2.SS4.p5.8.m6.1.1.2.2.1" xref="S2.SS4.p5.8.m6.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS4.p5.8.m6.1.1.3" xref="S2.SS4.p5.8.m6.1.1.3.cmml"><mi id="S2.SS4.p5.8.m6.1.1.3.2" xref="S2.SS4.p5.8.m6.1.1.3.2.cmml">C</mi><mo id="S2.SS4.p5.8.m6.1.1.3.1" xref="S2.SS4.p5.8.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS4.p5.8.m6.1.1.3.3" xref="S2.SS4.p5.8.m6.1.1.3.3.cmml">L</mi></mrow><mi id="S2.SS4.p5.8.m6.1.1.2.3" xref="S2.SS4.p5.8.m6.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.8.m6.1b"><apply id="S2.SS4.p5.8.m6.1.1.cmml" xref="S2.SS4.p5.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.8.m6.1.1.1.cmml" xref="S2.SS4.p5.8.m6.1.1">subscript</csymbol><apply id="S2.SS4.p5.8.m6.1.1.2.cmml" xref="S2.SS4.p5.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.8.m6.1.1.2.1.cmml" xref="S2.SS4.p5.8.m6.1.1">superscript</csymbol><apply id="S2.SS4.p5.8.m6.1.1.2.2.cmml" xref="S2.SS4.p5.8.m6.1.1.2.2"><ci id="S2.SS4.p5.8.m6.1.1.2.2.1.cmml" xref="S2.SS4.p5.8.m6.1.1.2.2.1">^</ci><ci id="S2.SS4.p5.8.m6.1.1.2.2.2.cmml" xref="S2.SS4.p5.8.m6.1.1.2.2.2">ℒ</ci></apply><ci id="S2.SS4.p5.8.m6.1.1.2.3.cmml" xref="S2.SS4.p5.8.m6.1.1.2.3">𝑖</ci></apply><apply id="S2.SS4.p5.8.m6.1.1.3.cmml" xref="S2.SS4.p5.8.m6.1.1.3"><times id="S2.SS4.p5.8.m6.1.1.3.1.cmml" xref="S2.SS4.p5.8.m6.1.1.3.1"></times><ci id="S2.SS4.p5.8.m6.1.1.3.2.cmml" xref="S2.SS4.p5.8.m6.1.1.3.2">𝐶</ci><ci id="S2.SS4.p5.8.m6.1.1.3.3.cmml" xref="S2.SS4.p5.8.m6.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.8.m6.1c">{\hat{\mathcal{L}}^{i}_{CL}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.8.m6.1d">over^ start_ARG caligraphic_L end_ARG start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math> represents the contrastive loss for the Cross-Visit Transformer heads. Finally, <math alttext="\mathcal{L}_{I}" class="ltx_Math" display="inline" id="S2.SS4.p5.9.m7.1"><semantics id="S2.SS4.p5.9.m7.1a"><msub id="S2.SS4.p5.9.m7.1.1" xref="S2.SS4.p5.9.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p5.9.m7.1.1.2" xref="S2.SS4.p5.9.m7.1.1.2.cmml">ℒ</mi><mi id="S2.SS4.p5.9.m7.1.1.3" xref="S2.SS4.p5.9.m7.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.9.m7.1b"><apply id="S2.SS4.p5.9.m7.1.1.cmml" xref="S2.SS4.p5.9.m7.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.9.m7.1.1.1.cmml" xref="S2.SS4.p5.9.m7.1.1">subscript</csymbol><ci id="S2.SS4.p5.9.m7.1.1.2.cmml" xref="S2.SS4.p5.9.m7.1.1.2">ℒ</ci><ci id="S2.SS4.p5.9.m7.1.1.3.cmml" xref="S2.SS4.p5.9.m7.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.9.m7.1c">\mathcal{L}_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p5.9.m7.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is the overall contrastive loss by having all intents as anchors.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5. </span>Aggregation and Prediction</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.4">The multi-level Transformers and intents enhance embeddings by integrating temporal and visit-level information, considering various medical aspects. Although these embeddings extract inter and intra-visit dependency among prescriptions, they do not explicitly identify which visit is more important compared to others. To identify the most crucial visits for both intents and patient embeddings, we leverage an interpretable visit-instance attention mechanism <cite class="ltx_cite ltx_citemacro_citep">(Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib10" title="">2016</a>)</cite>. Firstly, the matrices <math alttext="{\hat{\textbf{E}}^{j}}_{t}" class="ltx_Math" display="inline" id="S2.SS5.p1.1.m1.1"><semantics id="S2.SS5.p1.1.m1.1a"><mmultiscripts id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS5.p1.1.m1.1.1.2.2" xref="S2.SS5.p1.1.m1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p1.1.m1.1.1.2.2.2" xref="S2.SS5.p1.1.m1.1.1.2.2.2a.cmml">E</mtext><mo id="S2.SS5.p1.1.m1.1.1.2.2.1" xref="S2.SS5.p1.1.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS5.p1.1.m1.1.1a" xref="S2.SS5.p1.1.m1.1.1.cmml"></mrow><mi id="S2.SS5.p1.1.m1.1.1.2.3" xref="S2.SS5.p1.1.m1.1.1.2.3.cmml">j</mi><mi id="S2.SS5.p1.1.m1.1.1.3" xref="S2.SS5.p1.1.m1.1.1.3.cmml">t</mi><mrow id="S2.SS5.p1.1.m1.1.1b" xref="S2.SS5.p1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><apply id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1">subscript</csymbol><apply id="S2.SS5.p1.1.m1.1.1.2.cmml" xref="S2.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.1.1.2.1.cmml" xref="S2.SS5.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS5.p1.1.m1.1.1.2.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2.2"><ci id="S2.SS5.p1.1.m1.1.1.2.2.1.cmml" xref="S2.SS5.p1.1.m1.1.1.2.2.1">^</ci><ci id="S2.SS5.p1.1.m1.1.1.2.2.2a.cmml" xref="S2.SS5.p1.1.m1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p1.1.m1.1.1.2.2.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2.2.2">E</mtext></ci></apply><ci id="S2.SS5.p1.1.m1.1.1.2.3.cmml" xref="S2.SS5.p1.1.m1.1.1.2.3">𝑗</ci></apply><ci id="S2.SS5.p1.1.m1.1.1.3.cmml" xref="S2.SS5.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">{\hat{\textbf{E}}^{j}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.1.m1.1d">over^ start_ARG E end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, are concatenated based on their heads, and the representation of the codes are summed up to obtain <math alttext="\hat{\textbf{E}}_{t}" class="ltx_Math" display="inline" id="S2.SS5.p1.2.m2.1"><semantics id="S2.SS5.p1.2.m2.1a"><msub id="S2.SS5.p1.2.m2.1.1" xref="S2.SS5.p1.2.m2.1.1.cmml"><mover accent="true" id="S2.SS5.p1.2.m2.1.1.2" xref="S2.SS5.p1.2.m2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p1.2.m2.1.1.2.2" xref="S2.SS5.p1.2.m2.1.1.2.2a.cmml">E</mtext><mo id="S2.SS5.p1.2.m2.1.1.2.1" xref="S2.SS5.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS5.p1.2.m2.1.1.3" xref="S2.SS5.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m2.1b"><apply id="S2.SS5.p1.2.m2.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m2.1.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1">subscript</csymbol><apply id="S2.SS5.p1.2.m2.1.1.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2"><ci id="S2.SS5.p1.2.m2.1.1.2.1.cmml" xref="S2.SS5.p1.2.m2.1.1.2.1">^</ci><ci id="S2.SS5.p1.2.m2.1.1.2.2a.cmml" xref="S2.SS5.p1.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p1.2.m2.1.1.2.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2.2">E</mtext></ci></apply><ci id="S2.SS5.p1.2.m2.1.1.3.cmml" xref="S2.SS5.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m2.1c">\hat{\textbf{E}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.2.m2.1d">over^ start_ARG E end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\in\mathbb{R}^{B\times d}" class="ltx_Math" display="inline" id="S2.SS5.p1.3.m3.1"><semantics id="S2.SS5.p1.3.m3.1a"><mrow id="S2.SS5.p1.3.m3.1.1" xref="S2.SS5.p1.3.m3.1.1.cmml"><mi id="S2.SS5.p1.3.m3.1.1.2" xref="S2.SS5.p1.3.m3.1.1.2.cmml"></mi><mo id="S2.SS5.p1.3.m3.1.1.1" xref="S2.SS5.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS5.p1.3.m3.1.1.3" xref="S2.SS5.p1.3.m3.1.1.3.cmml"><mi id="S2.SS5.p1.3.m3.1.1.3.2" xref="S2.SS5.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS5.p1.3.m3.1.1.3.3" xref="S2.SS5.p1.3.m3.1.1.3.3.cmml"><mi id="S2.SS5.p1.3.m3.1.1.3.3.2" xref="S2.SS5.p1.3.m3.1.1.3.3.2.cmml">B</mi><mo id="S2.SS5.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S2.SS5.p1.3.m3.1.1.3.3.3" xref="S2.SS5.p1.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.3.m3.1b"><apply id="S2.SS5.p1.3.m3.1.1.cmml" xref="S2.SS5.p1.3.m3.1.1"><in id="S2.SS5.p1.3.m3.1.1.1.cmml" xref="S2.SS5.p1.3.m3.1.1.1"></in><csymbol cd="latexml" id="S2.SS5.p1.3.m3.1.1.2.cmml" xref="S2.SS5.p1.3.m3.1.1.2">absent</csymbol><apply id="S2.SS5.p1.3.m3.1.1.3.cmml" xref="S2.SS5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.1.1.3.1.cmml" xref="S2.SS5.p1.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS5.p1.3.m3.1.1.3.2.cmml" xref="S2.SS5.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S2.SS5.p1.3.m3.1.1.3.3.cmml" xref="S2.SS5.p1.3.m3.1.1.3.3"><times id="S2.SS5.p1.3.m3.1.1.3.3.1.cmml" xref="S2.SS5.p1.3.m3.1.1.3.3.1"></times><ci id="S2.SS5.p1.3.m3.1.1.3.3.2.cmml" xref="S2.SS5.p1.3.m3.1.1.3.3.2">𝐵</ci><ci id="S2.SS5.p1.3.m3.1.1.3.3.3.cmml" xref="S2.SS5.p1.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.3.m3.1c">\in\mathbb{R}^{B\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.3.m3.1d">∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Subsequently, <math alttext="\hat{\textbf{E}}_{t}" class="ltx_Math" display="inline" id="S2.SS5.p1.4.m4.1"><semantics id="S2.SS5.p1.4.m4.1a"><msub id="S2.SS5.p1.4.m4.1.1" xref="S2.SS5.p1.4.m4.1.1.cmml"><mover accent="true" id="S2.SS5.p1.4.m4.1.1.2" xref="S2.SS5.p1.4.m4.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p1.4.m4.1.1.2.2" xref="S2.SS5.p1.4.m4.1.1.2.2a.cmml">E</mtext><mo id="S2.SS5.p1.4.m4.1.1.2.1" xref="S2.SS5.p1.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS5.p1.4.m4.1.1.3" xref="S2.SS5.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.4.m4.1b"><apply id="S2.SS5.p1.4.m4.1.1.cmml" xref="S2.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.4.m4.1.1.1.cmml" xref="S2.SS5.p1.4.m4.1.1">subscript</csymbol><apply id="S2.SS5.p1.4.m4.1.1.2.cmml" xref="S2.SS5.p1.4.m4.1.1.2"><ci id="S2.SS5.p1.4.m4.1.1.2.1.cmml" xref="S2.SS5.p1.4.m4.1.1.2.1">^</ci><ci id="S2.SS5.p1.4.m4.1.1.2.2a.cmml" xref="S2.SS5.p1.4.m4.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p1.4.m4.1.1.2.2.cmml" xref="S2.SS5.p1.4.m4.1.1.2.2">E</mtext></ci></apply><ci id="S2.SS5.p1.4.m4.1.1.3.cmml" xref="S2.SS5.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.4.m4.1c">\hat{\textbf{E}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.4.m4.1d">over^ start_ARG E end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is fed into a GRU layer, indicated in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E16" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">16</span></a>. Following the GRU layer, attention is calculated, and the final embedding is obtained using Equations <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E17" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">17</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E18" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">18</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E19" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">19</span></a>.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{a}_{1},\bm{a}_{2},\ldots,\bm{a}_{T}=\operatorname{GRU}_{I}\left(\mathbf{%
\hat{E}}_{1},\mathbf{\hat{E}}_{2},\ldots,\mathbf{\hat{E}}_{T}\right)" class="ltx_Math" display="block" id="S2.E16.m1.9"><semantics id="S2.E16.m1.9a"><mrow id="S2.E16.m1.9.9" xref="S2.E16.m1.9.9.cmml"><mrow id="S2.E16.m1.5.5.3.3" xref="S2.E16.m1.5.5.3.4.cmml"><msub id="S2.E16.m1.3.3.1.1.1" xref="S2.E16.m1.3.3.1.1.1.cmml"><mi id="S2.E16.m1.3.3.1.1.1.2" xref="S2.E16.m1.3.3.1.1.1.2.cmml">𝒂</mi><mn id="S2.E16.m1.3.3.1.1.1.3" xref="S2.E16.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.E16.m1.5.5.3.3.4" xref="S2.E16.m1.5.5.3.4.cmml">,</mo><msub id="S2.E16.m1.4.4.2.2.2" xref="S2.E16.m1.4.4.2.2.2.cmml"><mi id="S2.E16.m1.4.4.2.2.2.2" xref="S2.E16.m1.4.4.2.2.2.2.cmml">𝒂</mi><mn id="S2.E16.m1.4.4.2.2.2.3" xref="S2.E16.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.E16.m1.5.5.3.3.5" xref="S2.E16.m1.5.5.3.4.cmml">,</mo><mi id="S2.E16.m1.2.2" mathvariant="normal" xref="S2.E16.m1.2.2.cmml">…</mi><mo id="S2.E16.m1.5.5.3.3.6" xref="S2.E16.m1.5.5.3.4.cmml">,</mo><msub id="S2.E16.m1.5.5.3.3.3" xref="S2.E16.m1.5.5.3.3.3.cmml"><mi id="S2.E16.m1.5.5.3.3.3.2" xref="S2.E16.m1.5.5.3.3.3.2.cmml">𝒂</mi><mi id="S2.E16.m1.5.5.3.3.3.3" xref="S2.E16.m1.5.5.3.3.3.3.cmml">T</mi></msub></mrow><mo id="S2.E16.m1.9.9.8" xref="S2.E16.m1.9.9.8.cmml">=</mo><mrow id="S2.E16.m1.9.9.7.4" xref="S2.E16.m1.9.9.7.5.cmml"><msub id="S2.E16.m1.6.6.4.1.1" xref="S2.E16.m1.6.6.4.1.1.cmml"><mi id="S2.E16.m1.6.6.4.1.1.2" xref="S2.E16.m1.6.6.4.1.1.2.cmml">GRU</mi><mi id="S2.E16.m1.6.6.4.1.1.3" xref="S2.E16.m1.6.6.4.1.1.3.cmml">I</mi></msub><mo id="S2.E16.m1.9.9.7.4a" xref="S2.E16.m1.9.9.7.5.cmml">⁡</mo><mrow id="S2.E16.m1.9.9.7.4.4" xref="S2.E16.m1.9.9.7.5.cmml"><mo id="S2.E16.m1.9.9.7.4.4.4" xref="S2.E16.m1.9.9.7.5.cmml">(</mo><msub id="S2.E16.m1.7.7.5.2.2.1" xref="S2.E16.m1.7.7.5.2.2.1.cmml"><mover accent="true" id="S2.E16.m1.7.7.5.2.2.1.2" xref="S2.E16.m1.7.7.5.2.2.1.2.cmml"><mi id="S2.E16.m1.7.7.5.2.2.1.2.2" xref="S2.E16.m1.7.7.5.2.2.1.2.2.cmml">𝐄</mi><mo id="S2.E16.m1.7.7.5.2.2.1.2.1" xref="S2.E16.m1.7.7.5.2.2.1.2.1.cmml">^</mo></mover><mn id="S2.E16.m1.7.7.5.2.2.1.3" xref="S2.E16.m1.7.7.5.2.2.1.3.cmml">1</mn></msub><mo id="S2.E16.m1.9.9.7.4.4.5" xref="S2.E16.m1.9.9.7.5.cmml">,</mo><msub id="S2.E16.m1.8.8.6.3.3.2" xref="S2.E16.m1.8.8.6.3.3.2.cmml"><mover accent="true" id="S2.E16.m1.8.8.6.3.3.2.2" xref="S2.E16.m1.8.8.6.3.3.2.2.cmml"><mi id="S2.E16.m1.8.8.6.3.3.2.2.2" xref="S2.E16.m1.8.8.6.3.3.2.2.2.cmml">𝐄</mi><mo id="S2.E16.m1.8.8.6.3.3.2.2.1" xref="S2.E16.m1.8.8.6.3.3.2.2.1.cmml">^</mo></mover><mn id="S2.E16.m1.8.8.6.3.3.2.3" xref="S2.E16.m1.8.8.6.3.3.2.3.cmml">2</mn></msub><mo id="S2.E16.m1.9.9.7.4.4.6" xref="S2.E16.m1.9.9.7.5.cmml">,</mo><mi id="S2.E16.m1.1.1" mathvariant="normal" xref="S2.E16.m1.1.1.cmml">…</mi><mo id="S2.E16.m1.9.9.7.4.4.7" xref="S2.E16.m1.9.9.7.5.cmml">,</mo><msub id="S2.E16.m1.9.9.7.4.4.3" xref="S2.E16.m1.9.9.7.4.4.3.cmml"><mover accent="true" id="S2.E16.m1.9.9.7.4.4.3.2" xref="S2.E16.m1.9.9.7.4.4.3.2.cmml"><mi id="S2.E16.m1.9.9.7.4.4.3.2.2" xref="S2.E16.m1.9.9.7.4.4.3.2.2.cmml">𝐄</mi><mo id="S2.E16.m1.9.9.7.4.4.3.2.1" xref="S2.E16.m1.9.9.7.4.4.3.2.1.cmml">^</mo></mover><mi id="S2.E16.m1.9.9.7.4.4.3.3" xref="S2.E16.m1.9.9.7.4.4.3.3.cmml">T</mi></msub><mo id="S2.E16.m1.9.9.7.4.4.8" xref="S2.E16.m1.9.9.7.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E16.m1.9b"><apply id="S2.E16.m1.9.9.cmml" xref="S2.E16.m1.9.9"><eq id="S2.E16.m1.9.9.8.cmml" xref="S2.E16.m1.9.9.8"></eq><list id="S2.E16.m1.5.5.3.4.cmml" xref="S2.E16.m1.5.5.3.3"><apply id="S2.E16.m1.3.3.1.1.1.cmml" xref="S2.E16.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.3.3.1.1.1.1.cmml" xref="S2.E16.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.E16.m1.3.3.1.1.1.2.cmml" xref="S2.E16.m1.3.3.1.1.1.2">𝒂</ci><cn id="S2.E16.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.E16.m1.3.3.1.1.1.3">1</cn></apply><apply id="S2.E16.m1.4.4.2.2.2.cmml" xref="S2.E16.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.E16.m1.4.4.2.2.2.1.cmml" xref="S2.E16.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.E16.m1.4.4.2.2.2.2.cmml" xref="S2.E16.m1.4.4.2.2.2.2">𝒂</ci><cn id="S2.E16.m1.4.4.2.2.2.3.cmml" type="integer" xref="S2.E16.m1.4.4.2.2.2.3">2</cn></apply><ci id="S2.E16.m1.2.2.cmml" xref="S2.E16.m1.2.2">…</ci><apply id="S2.E16.m1.5.5.3.3.3.cmml" xref="S2.E16.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.E16.m1.5.5.3.3.3.1.cmml" xref="S2.E16.m1.5.5.3.3.3">subscript</csymbol><ci id="S2.E16.m1.5.5.3.3.3.2.cmml" xref="S2.E16.m1.5.5.3.3.3.2">𝒂</ci><ci id="S2.E16.m1.5.5.3.3.3.3.cmml" xref="S2.E16.m1.5.5.3.3.3.3">𝑇</ci></apply></list><apply id="S2.E16.m1.9.9.7.5.cmml" xref="S2.E16.m1.9.9.7.4"><apply id="S2.E16.m1.6.6.4.1.1.cmml" xref="S2.E16.m1.6.6.4.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.6.6.4.1.1.1.cmml" xref="S2.E16.m1.6.6.4.1.1">subscript</csymbol><ci id="S2.E16.m1.6.6.4.1.1.2.cmml" xref="S2.E16.m1.6.6.4.1.1.2">GRU</ci><ci id="S2.E16.m1.6.6.4.1.1.3.cmml" xref="S2.E16.m1.6.6.4.1.1.3">𝐼</ci></apply><apply id="S2.E16.m1.7.7.5.2.2.1.cmml" xref="S2.E16.m1.7.7.5.2.2.1"><csymbol cd="ambiguous" id="S2.E16.m1.7.7.5.2.2.1.1.cmml" xref="S2.E16.m1.7.7.5.2.2.1">subscript</csymbol><apply id="S2.E16.m1.7.7.5.2.2.1.2.cmml" xref="S2.E16.m1.7.7.5.2.2.1.2"><ci id="S2.E16.m1.7.7.5.2.2.1.2.1.cmml" xref="S2.E16.m1.7.7.5.2.2.1.2.1">^</ci><ci id="S2.E16.m1.7.7.5.2.2.1.2.2.cmml" xref="S2.E16.m1.7.7.5.2.2.1.2.2">𝐄</ci></apply><cn id="S2.E16.m1.7.7.5.2.2.1.3.cmml" type="integer" xref="S2.E16.m1.7.7.5.2.2.1.3">1</cn></apply><apply id="S2.E16.m1.8.8.6.3.3.2.cmml" xref="S2.E16.m1.8.8.6.3.3.2"><csymbol cd="ambiguous" id="S2.E16.m1.8.8.6.3.3.2.1.cmml" xref="S2.E16.m1.8.8.6.3.3.2">subscript</csymbol><apply id="S2.E16.m1.8.8.6.3.3.2.2.cmml" xref="S2.E16.m1.8.8.6.3.3.2.2"><ci id="S2.E16.m1.8.8.6.3.3.2.2.1.cmml" xref="S2.E16.m1.8.8.6.3.3.2.2.1">^</ci><ci id="S2.E16.m1.8.8.6.3.3.2.2.2.cmml" xref="S2.E16.m1.8.8.6.3.3.2.2.2">𝐄</ci></apply><cn id="S2.E16.m1.8.8.6.3.3.2.3.cmml" type="integer" xref="S2.E16.m1.8.8.6.3.3.2.3">2</cn></apply><ci id="S2.E16.m1.1.1.cmml" xref="S2.E16.m1.1.1">…</ci><apply id="S2.E16.m1.9.9.7.4.4.3.cmml" xref="S2.E16.m1.9.9.7.4.4.3"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.7.4.4.3.1.cmml" xref="S2.E16.m1.9.9.7.4.4.3">subscript</csymbol><apply id="S2.E16.m1.9.9.7.4.4.3.2.cmml" xref="S2.E16.m1.9.9.7.4.4.3.2"><ci id="S2.E16.m1.9.9.7.4.4.3.2.1.cmml" xref="S2.E16.m1.9.9.7.4.4.3.2.1">^</ci><ci id="S2.E16.m1.9.9.7.4.4.3.2.2.cmml" xref="S2.E16.m1.9.9.7.4.4.3.2.2">𝐄</ci></apply><ci id="S2.E16.m1.9.9.7.4.4.3.3.cmml" xref="S2.E16.m1.9.9.7.4.4.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E16.m1.9c">\bm{a}_{1},\bm{a}_{2},\ldots,\bm{a}_{T}=\operatorname{GRU}_{I}\left(\mathbf{%
\hat{E}}_{1},\mathbf{\hat{E}}_{2},\ldots,\mathbf{\hat{E}}_{T}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E16.m1.9d">bold_italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_a start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT = roman_GRU start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ( over^ start_ARG bold_E end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over^ start_ARG bold_E end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , over^ start_ARG bold_E end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{e}_{i}}=\bm{a}_{i}\textbf{W}_{a}" class="ltx_Math" display="block" id="S2.E17.m1.1"><semantics id="S2.E17.m1.1a"><mrow id="S2.E17.m1.1.1" xref="S2.E17.m1.1.1.cmml"><msub id="S2.E17.m1.1.1.2" xref="S2.E17.m1.1.1.2.cmml"><mi id="S2.E17.m1.1.1.2.2" xref="S2.E17.m1.1.1.2.2.cmml">𝒆</mi><mi id="S2.E17.m1.1.1.2.3" xref="S2.E17.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E17.m1.1.1.1" xref="S2.E17.m1.1.1.1.cmml">=</mo><mrow id="S2.E17.m1.1.1.3" xref="S2.E17.m1.1.1.3.cmml"><msub id="S2.E17.m1.1.1.3.2" xref="S2.E17.m1.1.1.3.2.cmml"><mi id="S2.E17.m1.1.1.3.2.2" xref="S2.E17.m1.1.1.3.2.2.cmml">𝒂</mi><mi id="S2.E17.m1.1.1.3.2.3" xref="S2.E17.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="S2.E17.m1.1.1.3.1" xref="S2.E17.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.E17.m1.1.1.3.3" xref="S2.E17.m1.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E17.m1.1.1.3.3.2" xref="S2.E17.m1.1.1.3.3.2a.cmml">W</mtext><mi id="S2.E17.m1.1.1.3.3.3" xref="S2.E17.m1.1.1.3.3.3.cmml">a</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E17.m1.1b"><apply id="S2.E17.m1.1.1.cmml" xref="S2.E17.m1.1.1"><eq id="S2.E17.m1.1.1.1.cmml" xref="S2.E17.m1.1.1.1"></eq><apply id="S2.E17.m1.1.1.2.cmml" xref="S2.E17.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.2.1.cmml" xref="S2.E17.m1.1.1.2">subscript</csymbol><ci id="S2.E17.m1.1.1.2.2.cmml" xref="S2.E17.m1.1.1.2.2">𝒆</ci><ci id="S2.E17.m1.1.1.2.3.cmml" xref="S2.E17.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.E17.m1.1.1.3.cmml" xref="S2.E17.m1.1.1.3"><times id="S2.E17.m1.1.1.3.1.cmml" xref="S2.E17.m1.1.1.3.1"></times><apply id="S2.E17.m1.1.1.3.2.cmml" xref="S2.E17.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.3.2.1.cmml" xref="S2.E17.m1.1.1.3.2">subscript</csymbol><ci id="S2.E17.m1.1.1.3.2.2.cmml" xref="S2.E17.m1.1.1.3.2.2">𝒂</ci><ci id="S2.E17.m1.1.1.3.2.3.cmml" xref="S2.E17.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S2.E17.m1.1.1.3.3.cmml" xref="S2.E17.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.3.3.1.cmml" xref="S2.E17.m1.1.1.3.3">subscript</csymbol><ci id="S2.E17.m1.1.1.3.3.2a.cmml" xref="S2.E17.m1.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E17.m1.1.1.3.3.2.cmml" xref="S2.E17.m1.1.1.3.3.2">W</mtext></ci><ci id="S2.E17.m1.1.1.3.3.3.cmml" xref="S2.E17.m1.1.1.3.3.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E17.m1.1c">{\bm{e}_{i}}=\bm{a}_{i}\textbf{W}_{a}</annotation><annotation encoding="application/x-llamapun" id="S2.E17.m1.1d">bold_italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT W start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(18)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\alpha}_{1},\mathbf{\alpha}_{2},\ldots,\mathbf{\alpha}_{i}=%
\operatorname{Softmax}\left(\bm{e}_{1},\bm{e}_{2},\ldots,\bm{e}_{i}\right)" class="ltx_Math" display="block" id="S2.E18.m1.9"><semantics id="S2.E18.m1.9a"><mrow id="S2.E18.m1.9.9" xref="S2.E18.m1.9.9.cmml"><mrow id="S2.E18.m1.6.6.3.3" xref="S2.E18.m1.6.6.3.4.cmml"><msub id="S2.E18.m1.4.4.1.1.1" xref="S2.E18.m1.4.4.1.1.1.cmml"><mi id="S2.E18.m1.4.4.1.1.1.2" xref="S2.E18.m1.4.4.1.1.1.2.cmml">α</mi><mn id="S2.E18.m1.4.4.1.1.1.3" xref="S2.E18.m1.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S2.E18.m1.6.6.3.3.4" xref="S2.E18.m1.6.6.3.4.cmml">,</mo><msub id="S2.E18.m1.5.5.2.2.2" xref="S2.E18.m1.5.5.2.2.2.cmml"><mi id="S2.E18.m1.5.5.2.2.2.2" xref="S2.E18.m1.5.5.2.2.2.2.cmml">α</mi><mn id="S2.E18.m1.5.5.2.2.2.3" xref="S2.E18.m1.5.5.2.2.2.3.cmml">2</mn></msub><mo id="S2.E18.m1.6.6.3.3.5" xref="S2.E18.m1.6.6.3.4.cmml">,</mo><mi id="S2.E18.m1.3.3" mathvariant="normal" xref="S2.E18.m1.3.3.cmml">…</mi><mo id="S2.E18.m1.6.6.3.3.6" xref="S2.E18.m1.6.6.3.4.cmml">,</mo><msub id="S2.E18.m1.6.6.3.3.3" xref="S2.E18.m1.6.6.3.3.3.cmml"><mi id="S2.E18.m1.6.6.3.3.3.2" xref="S2.E18.m1.6.6.3.3.3.2.cmml">α</mi><mi id="S2.E18.m1.6.6.3.3.3.3" xref="S2.E18.m1.6.6.3.3.3.3.cmml">i</mi></msub></mrow><mo id="S2.E18.m1.9.9.7" xref="S2.E18.m1.9.9.7.cmml">=</mo><mrow id="S2.E18.m1.9.9.6.3" xref="S2.E18.m1.9.9.6.4.cmml"><mi id="S2.E18.m1.1.1" xref="S2.E18.m1.1.1.cmml">Softmax</mi><mo id="S2.E18.m1.9.9.6.3a" xref="S2.E18.m1.9.9.6.4.cmml">⁡</mo><mrow id="S2.E18.m1.9.9.6.3.3" xref="S2.E18.m1.9.9.6.4.cmml"><mo id="S2.E18.m1.9.9.6.3.3.4" xref="S2.E18.m1.9.9.6.4.cmml">(</mo><msub id="S2.E18.m1.7.7.4.1.1.1" xref="S2.E18.m1.7.7.4.1.1.1.cmml"><mi id="S2.E18.m1.7.7.4.1.1.1.2" xref="S2.E18.m1.7.7.4.1.1.1.2.cmml">𝒆</mi><mn id="S2.E18.m1.7.7.4.1.1.1.3" xref="S2.E18.m1.7.7.4.1.1.1.3.cmml">1</mn></msub><mo id="S2.E18.m1.9.9.6.3.3.5" xref="S2.E18.m1.9.9.6.4.cmml">,</mo><msub id="S2.E18.m1.8.8.5.2.2.2" xref="S2.E18.m1.8.8.5.2.2.2.cmml"><mi id="S2.E18.m1.8.8.5.2.2.2.2" xref="S2.E18.m1.8.8.5.2.2.2.2.cmml">𝒆</mi><mn id="S2.E18.m1.8.8.5.2.2.2.3" xref="S2.E18.m1.8.8.5.2.2.2.3.cmml">2</mn></msub><mo id="S2.E18.m1.9.9.6.3.3.6" xref="S2.E18.m1.9.9.6.4.cmml">,</mo><mi id="S2.E18.m1.2.2" mathvariant="normal" xref="S2.E18.m1.2.2.cmml">…</mi><mo id="S2.E18.m1.9.9.6.3.3.7" xref="S2.E18.m1.9.9.6.4.cmml">,</mo><msub id="S2.E18.m1.9.9.6.3.3.3" xref="S2.E18.m1.9.9.6.3.3.3.cmml"><mi id="S2.E18.m1.9.9.6.3.3.3.2" xref="S2.E18.m1.9.9.6.3.3.3.2.cmml">𝒆</mi><mi id="S2.E18.m1.9.9.6.3.3.3.3" xref="S2.E18.m1.9.9.6.3.3.3.3.cmml">i</mi></msub><mo id="S2.E18.m1.9.9.6.3.3.8" xref="S2.E18.m1.9.9.6.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E18.m1.9b"><apply id="S2.E18.m1.9.9.cmml" xref="S2.E18.m1.9.9"><eq id="S2.E18.m1.9.9.7.cmml" xref="S2.E18.m1.9.9.7"></eq><list id="S2.E18.m1.6.6.3.4.cmml" xref="S2.E18.m1.6.6.3.3"><apply id="S2.E18.m1.4.4.1.1.1.cmml" xref="S2.E18.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m1.4.4.1.1.1.1.cmml" xref="S2.E18.m1.4.4.1.1.1">subscript</csymbol><ci id="S2.E18.m1.4.4.1.1.1.2.cmml" xref="S2.E18.m1.4.4.1.1.1.2">𝛼</ci><cn id="S2.E18.m1.4.4.1.1.1.3.cmml" type="integer" xref="S2.E18.m1.4.4.1.1.1.3">1</cn></apply><apply id="S2.E18.m1.5.5.2.2.2.cmml" xref="S2.E18.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.E18.m1.5.5.2.2.2.1.cmml" xref="S2.E18.m1.5.5.2.2.2">subscript</csymbol><ci id="S2.E18.m1.5.5.2.2.2.2.cmml" xref="S2.E18.m1.5.5.2.2.2.2">𝛼</ci><cn id="S2.E18.m1.5.5.2.2.2.3.cmml" type="integer" xref="S2.E18.m1.5.5.2.2.2.3">2</cn></apply><ci id="S2.E18.m1.3.3.cmml" xref="S2.E18.m1.3.3">…</ci><apply id="S2.E18.m1.6.6.3.3.3.cmml" xref="S2.E18.m1.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.E18.m1.6.6.3.3.3.1.cmml" xref="S2.E18.m1.6.6.3.3.3">subscript</csymbol><ci id="S2.E18.m1.6.6.3.3.3.2.cmml" xref="S2.E18.m1.6.6.3.3.3.2">𝛼</ci><ci id="S2.E18.m1.6.6.3.3.3.3.cmml" xref="S2.E18.m1.6.6.3.3.3.3">𝑖</ci></apply></list><apply id="S2.E18.m1.9.9.6.4.cmml" xref="S2.E18.m1.9.9.6.3"><ci id="S2.E18.m1.1.1.cmml" xref="S2.E18.m1.1.1">Softmax</ci><apply id="S2.E18.m1.7.7.4.1.1.1.cmml" xref="S2.E18.m1.7.7.4.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m1.7.7.4.1.1.1.1.cmml" xref="S2.E18.m1.7.7.4.1.1.1">subscript</csymbol><ci id="S2.E18.m1.7.7.4.1.1.1.2.cmml" xref="S2.E18.m1.7.7.4.1.1.1.2">𝒆</ci><cn id="S2.E18.m1.7.7.4.1.1.1.3.cmml" type="integer" xref="S2.E18.m1.7.7.4.1.1.1.3">1</cn></apply><apply id="S2.E18.m1.8.8.5.2.2.2.cmml" xref="S2.E18.m1.8.8.5.2.2.2"><csymbol cd="ambiguous" id="S2.E18.m1.8.8.5.2.2.2.1.cmml" xref="S2.E18.m1.8.8.5.2.2.2">subscript</csymbol><ci id="S2.E18.m1.8.8.5.2.2.2.2.cmml" xref="S2.E18.m1.8.8.5.2.2.2.2">𝒆</ci><cn id="S2.E18.m1.8.8.5.2.2.2.3.cmml" type="integer" xref="S2.E18.m1.8.8.5.2.2.2.3">2</cn></apply><ci id="S2.E18.m1.2.2.cmml" xref="S2.E18.m1.2.2">…</ci><apply id="S2.E18.m1.9.9.6.3.3.3.cmml" xref="S2.E18.m1.9.9.6.3.3.3"><csymbol cd="ambiguous" id="S2.E18.m1.9.9.6.3.3.3.1.cmml" xref="S2.E18.m1.9.9.6.3.3.3">subscript</csymbol><ci id="S2.E18.m1.9.9.6.3.3.3.2.cmml" xref="S2.E18.m1.9.9.6.3.3.3.2">𝒆</ci><ci id="S2.E18.m1.9.9.6.3.3.3.3.cmml" xref="S2.E18.m1.9.9.6.3.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E18.m1.9c">\mathbf{\alpha}_{1},\mathbf{\alpha}_{2},\ldots,\mathbf{\alpha}_{i}=%
\operatorname{Softmax}\left(\bm{e}_{1},\bm{e}_{2},\ldots,\bm{e}_{i}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E18.m1.9d">italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_α start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_Softmax ( bold_italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(19)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{Y}_{P}=\sum_{i=1}^{T}{\alpha_{i}}\odot\mathbf{\hat{E}}_{i}" class="ltx_Math" display="block" id="S2.E19.m1.1"><semantics id="S2.E19.m1.1a"><mrow id="S2.E19.m1.1.1" xref="S2.E19.m1.1.1.cmml"><msub id="S2.E19.m1.1.1.2" xref="S2.E19.m1.1.1.2.cmml"><mi id="S2.E19.m1.1.1.2.2" xref="S2.E19.m1.1.1.2.2.cmml">𝒀</mi><mi id="S2.E19.m1.1.1.2.3" xref="S2.E19.m1.1.1.2.3.cmml">P</mi></msub><mo id="S2.E19.m1.1.1.1" rspace="0.111em" xref="S2.E19.m1.1.1.1.cmml">=</mo><mrow id="S2.E19.m1.1.1.3" xref="S2.E19.m1.1.1.3.cmml"><munderover id="S2.E19.m1.1.1.3.1" xref="S2.E19.m1.1.1.3.1.cmml"><mo id="S2.E19.m1.1.1.3.1.2.2" movablelimits="false" xref="S2.E19.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E19.m1.1.1.3.1.2.3" xref="S2.E19.m1.1.1.3.1.2.3.cmml"><mi id="S2.E19.m1.1.1.3.1.2.3.2" xref="S2.E19.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S2.E19.m1.1.1.3.1.2.3.1" xref="S2.E19.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E19.m1.1.1.3.1.2.3.3" xref="S2.E19.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E19.m1.1.1.3.1.3" xref="S2.E19.m1.1.1.3.1.3.cmml">T</mi></munderover><mrow id="S2.E19.m1.1.1.3.2" xref="S2.E19.m1.1.1.3.2.cmml"><msub id="S2.E19.m1.1.1.3.2.2" xref="S2.E19.m1.1.1.3.2.2.cmml"><mi id="S2.E19.m1.1.1.3.2.2.2" xref="S2.E19.m1.1.1.3.2.2.2.cmml">α</mi><mi id="S2.E19.m1.1.1.3.2.2.3" xref="S2.E19.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S2.E19.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E19.m1.1.1.3.2.1.cmml">⊙</mo><msub id="S2.E19.m1.1.1.3.2.3" xref="S2.E19.m1.1.1.3.2.3.cmml"><mover accent="true" id="S2.E19.m1.1.1.3.2.3.2" xref="S2.E19.m1.1.1.3.2.3.2.cmml"><mi id="S2.E19.m1.1.1.3.2.3.2.2" xref="S2.E19.m1.1.1.3.2.3.2.2.cmml">𝐄</mi><mo id="S2.E19.m1.1.1.3.2.3.2.1" xref="S2.E19.m1.1.1.3.2.3.2.1.cmml">^</mo></mover><mi id="S2.E19.m1.1.1.3.2.3.3" xref="S2.E19.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E19.m1.1b"><apply id="S2.E19.m1.1.1.cmml" xref="S2.E19.m1.1.1"><eq id="S2.E19.m1.1.1.1.cmml" xref="S2.E19.m1.1.1.1"></eq><apply id="S2.E19.m1.1.1.2.cmml" xref="S2.E19.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E19.m1.1.1.2.1.cmml" xref="S2.E19.m1.1.1.2">subscript</csymbol><ci id="S2.E19.m1.1.1.2.2.cmml" xref="S2.E19.m1.1.1.2.2">𝒀</ci><ci id="S2.E19.m1.1.1.2.3.cmml" xref="S2.E19.m1.1.1.2.3">𝑃</ci></apply><apply id="S2.E19.m1.1.1.3.cmml" xref="S2.E19.m1.1.1.3"><apply id="S2.E19.m1.1.1.3.1.cmml" xref="S2.E19.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E19.m1.1.1.3.1.1.cmml" xref="S2.E19.m1.1.1.3.1">superscript</csymbol><apply id="S2.E19.m1.1.1.3.1.2.cmml" xref="S2.E19.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E19.m1.1.1.3.1.2.1.cmml" xref="S2.E19.m1.1.1.3.1">subscript</csymbol><sum id="S2.E19.m1.1.1.3.1.2.2.cmml" xref="S2.E19.m1.1.1.3.1.2.2"></sum><apply id="S2.E19.m1.1.1.3.1.2.3.cmml" xref="S2.E19.m1.1.1.3.1.2.3"><eq id="S2.E19.m1.1.1.3.1.2.3.1.cmml" xref="S2.E19.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E19.m1.1.1.3.1.2.3.2.cmml" xref="S2.E19.m1.1.1.3.1.2.3.2">𝑖</ci><cn id="S2.E19.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E19.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E19.m1.1.1.3.1.3.cmml" xref="S2.E19.m1.1.1.3.1.3">𝑇</ci></apply><apply id="S2.E19.m1.1.1.3.2.cmml" xref="S2.E19.m1.1.1.3.2"><csymbol cd="latexml" id="S2.E19.m1.1.1.3.2.1.cmml" xref="S2.E19.m1.1.1.3.2.1">direct-product</csymbol><apply id="S2.E19.m1.1.1.3.2.2.cmml" xref="S2.E19.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E19.m1.1.1.3.2.2.1.cmml" xref="S2.E19.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E19.m1.1.1.3.2.2.2.cmml" xref="S2.E19.m1.1.1.3.2.2.2">𝛼</ci><ci id="S2.E19.m1.1.1.3.2.2.3.cmml" xref="S2.E19.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S2.E19.m1.1.1.3.2.3.cmml" xref="S2.E19.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E19.m1.1.1.3.2.3.1.cmml" xref="S2.E19.m1.1.1.3.2.3">subscript</csymbol><apply id="S2.E19.m1.1.1.3.2.3.2.cmml" xref="S2.E19.m1.1.1.3.2.3.2"><ci id="S2.E19.m1.1.1.3.2.3.2.1.cmml" xref="S2.E19.m1.1.1.3.2.3.2.1">^</ci><ci id="S2.E19.m1.1.1.3.2.3.2.2.cmml" xref="S2.E19.m1.1.1.3.2.3.2.2">𝐄</ci></apply><ci id="S2.E19.m1.1.1.3.2.3.3.cmml" xref="S2.E19.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E19.m1.1c">\bm{Y}_{P}=\sum_{i=1}^{T}{\alpha_{i}}\odot\mathbf{\hat{E}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.E19.m1.1d">bold_italic_Y start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊙ over^ start_ARG bold_E end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.4">A similar process is applied for intents shown in Equations <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E20" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">20</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E21" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">21</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E22" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">22</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E23" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">23</span></a>.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(20)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{b}_{1},\bm{b}_{2},\ldots,\bm{b}_{T}=\operatorname{GRU}_{\hat{I}}\left(%
\mathbf{\hat{Intent}}_{1},\mathbf{\hat{Intent}}_{2},\ldots,\mathbf{\hat{Intent%
}}_{T}\right)" class="ltx_Math" display="block" id="S2.E20.m1.9"><semantics id="S2.E20.m1.9a"><mrow id="S2.E20.m1.9.9" xref="S2.E20.m1.9.9.cmml"><mrow id="S2.E20.m1.5.5.3.3" xref="S2.E20.m1.5.5.3.4.cmml"><msub id="S2.E20.m1.3.3.1.1.1" xref="S2.E20.m1.3.3.1.1.1.cmml"><mi id="S2.E20.m1.3.3.1.1.1.2" xref="S2.E20.m1.3.3.1.1.1.2.cmml">𝒃</mi><mn id="S2.E20.m1.3.3.1.1.1.3" xref="S2.E20.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.E20.m1.5.5.3.3.4" xref="S2.E20.m1.5.5.3.4.cmml">,</mo><msub id="S2.E20.m1.4.4.2.2.2" xref="S2.E20.m1.4.4.2.2.2.cmml"><mi id="S2.E20.m1.4.4.2.2.2.2" xref="S2.E20.m1.4.4.2.2.2.2.cmml">𝒃</mi><mn id="S2.E20.m1.4.4.2.2.2.3" xref="S2.E20.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.E20.m1.5.5.3.3.5" xref="S2.E20.m1.5.5.3.4.cmml">,</mo><mi id="S2.E20.m1.2.2" mathvariant="normal" xref="S2.E20.m1.2.2.cmml">…</mi><mo id="S2.E20.m1.5.5.3.3.6" xref="S2.E20.m1.5.5.3.4.cmml">,</mo><msub id="S2.E20.m1.5.5.3.3.3" xref="S2.E20.m1.5.5.3.3.3.cmml"><mi id="S2.E20.m1.5.5.3.3.3.2" xref="S2.E20.m1.5.5.3.3.3.2.cmml">𝒃</mi><mi id="S2.E20.m1.5.5.3.3.3.3" xref="S2.E20.m1.5.5.3.3.3.3.cmml">T</mi></msub></mrow><mo id="S2.E20.m1.9.9.8" xref="S2.E20.m1.9.9.8.cmml">=</mo><mrow id="S2.E20.m1.9.9.7.4" xref="S2.E20.m1.9.9.7.5.cmml"><msub id="S2.E20.m1.6.6.4.1.1" xref="S2.E20.m1.6.6.4.1.1.cmml"><mi id="S2.E20.m1.6.6.4.1.1.2" xref="S2.E20.m1.6.6.4.1.1.2.cmml">GRU</mi><mover accent="true" id="S2.E20.m1.6.6.4.1.1.3" xref="S2.E20.m1.6.6.4.1.1.3.cmml"><mi id="S2.E20.m1.6.6.4.1.1.3.2" xref="S2.E20.m1.6.6.4.1.1.3.2.cmml">I</mi><mo id="S2.E20.m1.6.6.4.1.1.3.1" xref="S2.E20.m1.6.6.4.1.1.3.1.cmml">^</mo></mover></msub><mo id="S2.E20.m1.9.9.7.4a" xref="S2.E20.m1.9.9.7.5.cmml">⁡</mo><mrow id="S2.E20.m1.9.9.7.4.4" xref="S2.E20.m1.9.9.7.5.cmml"><mo id="S2.E20.m1.9.9.7.4.4.4" xref="S2.E20.m1.9.9.7.5.cmml">(</mo><msub id="S2.E20.m1.7.7.5.2.2.1" xref="S2.E20.m1.7.7.5.2.2.1.cmml"><mover accent="true" id="S2.E20.m1.7.7.5.2.2.1.2" xref="S2.E20.m1.7.7.5.2.2.1.2.cmml"><mi id="S2.E20.m1.7.7.5.2.2.1.2.2" xref="S2.E20.m1.7.7.5.2.2.1.2.2.cmml">𝐈𝐧𝐭𝐞𝐧𝐭</mi><mo id="S2.E20.m1.7.7.5.2.2.1.2.1" xref="S2.E20.m1.7.7.5.2.2.1.2.1.cmml">^</mo></mover><mn id="S2.E20.m1.7.7.5.2.2.1.3" xref="S2.E20.m1.7.7.5.2.2.1.3.cmml">1</mn></msub><mo id="S2.E20.m1.9.9.7.4.4.5" xref="S2.E20.m1.9.9.7.5.cmml">,</mo><msub id="S2.E20.m1.8.8.6.3.3.2" xref="S2.E20.m1.8.8.6.3.3.2.cmml"><mover accent="true" id="S2.E20.m1.8.8.6.3.3.2.2" xref="S2.E20.m1.8.8.6.3.3.2.2.cmml"><mi id="S2.E20.m1.8.8.6.3.3.2.2.2" xref="S2.E20.m1.8.8.6.3.3.2.2.2.cmml">𝐈𝐧𝐭𝐞𝐧𝐭</mi><mo id="S2.E20.m1.8.8.6.3.3.2.2.1" xref="S2.E20.m1.8.8.6.3.3.2.2.1.cmml">^</mo></mover><mn id="S2.E20.m1.8.8.6.3.3.2.3" xref="S2.E20.m1.8.8.6.3.3.2.3.cmml">2</mn></msub><mo id="S2.E20.m1.9.9.7.4.4.6" xref="S2.E20.m1.9.9.7.5.cmml">,</mo><mi id="S2.E20.m1.1.1" mathvariant="normal" xref="S2.E20.m1.1.1.cmml">…</mi><mo id="S2.E20.m1.9.9.7.4.4.7" xref="S2.E20.m1.9.9.7.5.cmml">,</mo><msub id="S2.E20.m1.9.9.7.4.4.3" xref="S2.E20.m1.9.9.7.4.4.3.cmml"><mover accent="true" id="S2.E20.m1.9.9.7.4.4.3.2" xref="S2.E20.m1.9.9.7.4.4.3.2.cmml"><mi id="S2.E20.m1.9.9.7.4.4.3.2.2" xref="S2.E20.m1.9.9.7.4.4.3.2.2.cmml">𝐈𝐧𝐭𝐞𝐧𝐭</mi><mo id="S2.E20.m1.9.9.7.4.4.3.2.1" xref="S2.E20.m1.9.9.7.4.4.3.2.1.cmml">^</mo></mover><mi id="S2.E20.m1.9.9.7.4.4.3.3" xref="S2.E20.m1.9.9.7.4.4.3.3.cmml">T</mi></msub><mo id="S2.E20.m1.9.9.7.4.4.8" xref="S2.E20.m1.9.9.7.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E20.m1.9b"><apply id="S2.E20.m1.9.9.cmml" xref="S2.E20.m1.9.9"><eq id="S2.E20.m1.9.9.8.cmml" xref="S2.E20.m1.9.9.8"></eq><list id="S2.E20.m1.5.5.3.4.cmml" xref="S2.E20.m1.5.5.3.3"><apply id="S2.E20.m1.3.3.1.1.1.cmml" xref="S2.E20.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E20.m1.3.3.1.1.1.1.cmml" xref="S2.E20.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.E20.m1.3.3.1.1.1.2.cmml" xref="S2.E20.m1.3.3.1.1.1.2">𝒃</ci><cn id="S2.E20.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.E20.m1.3.3.1.1.1.3">1</cn></apply><apply id="S2.E20.m1.4.4.2.2.2.cmml" xref="S2.E20.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.E20.m1.4.4.2.2.2.1.cmml" xref="S2.E20.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.E20.m1.4.4.2.2.2.2.cmml" xref="S2.E20.m1.4.4.2.2.2.2">𝒃</ci><cn id="S2.E20.m1.4.4.2.2.2.3.cmml" type="integer" xref="S2.E20.m1.4.4.2.2.2.3">2</cn></apply><ci id="S2.E20.m1.2.2.cmml" xref="S2.E20.m1.2.2">…</ci><apply id="S2.E20.m1.5.5.3.3.3.cmml" xref="S2.E20.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.E20.m1.5.5.3.3.3.1.cmml" xref="S2.E20.m1.5.5.3.3.3">subscript</csymbol><ci id="S2.E20.m1.5.5.3.3.3.2.cmml" xref="S2.E20.m1.5.5.3.3.3.2">𝒃</ci><ci id="S2.E20.m1.5.5.3.3.3.3.cmml" xref="S2.E20.m1.5.5.3.3.3.3">𝑇</ci></apply></list><apply id="S2.E20.m1.9.9.7.5.cmml" xref="S2.E20.m1.9.9.7.4"><apply id="S2.E20.m1.6.6.4.1.1.cmml" xref="S2.E20.m1.6.6.4.1.1"><csymbol cd="ambiguous" id="S2.E20.m1.6.6.4.1.1.1.cmml" xref="S2.E20.m1.6.6.4.1.1">subscript</csymbol><ci id="S2.E20.m1.6.6.4.1.1.2.cmml" xref="S2.E20.m1.6.6.4.1.1.2">GRU</ci><apply id="S2.E20.m1.6.6.4.1.1.3.cmml" xref="S2.E20.m1.6.6.4.1.1.3"><ci id="S2.E20.m1.6.6.4.1.1.3.1.cmml" xref="S2.E20.m1.6.6.4.1.1.3.1">^</ci><ci id="S2.E20.m1.6.6.4.1.1.3.2.cmml" xref="S2.E20.m1.6.6.4.1.1.3.2">𝐼</ci></apply></apply><apply id="S2.E20.m1.7.7.5.2.2.1.cmml" xref="S2.E20.m1.7.7.5.2.2.1"><csymbol cd="ambiguous" id="S2.E20.m1.7.7.5.2.2.1.1.cmml" xref="S2.E20.m1.7.7.5.2.2.1">subscript</csymbol><apply id="S2.E20.m1.7.7.5.2.2.1.2.cmml" xref="S2.E20.m1.7.7.5.2.2.1.2"><ci id="S2.E20.m1.7.7.5.2.2.1.2.1.cmml" xref="S2.E20.m1.7.7.5.2.2.1.2.1">^</ci><ci id="S2.E20.m1.7.7.5.2.2.1.2.2.cmml" xref="S2.E20.m1.7.7.5.2.2.1.2.2">𝐈𝐧𝐭𝐞𝐧𝐭</ci></apply><cn id="S2.E20.m1.7.7.5.2.2.1.3.cmml" type="integer" xref="S2.E20.m1.7.7.5.2.2.1.3">1</cn></apply><apply id="S2.E20.m1.8.8.6.3.3.2.cmml" xref="S2.E20.m1.8.8.6.3.3.2"><csymbol cd="ambiguous" id="S2.E20.m1.8.8.6.3.3.2.1.cmml" xref="S2.E20.m1.8.8.6.3.3.2">subscript</csymbol><apply id="S2.E20.m1.8.8.6.3.3.2.2.cmml" xref="S2.E20.m1.8.8.6.3.3.2.2"><ci id="S2.E20.m1.8.8.6.3.3.2.2.1.cmml" xref="S2.E20.m1.8.8.6.3.3.2.2.1">^</ci><ci id="S2.E20.m1.8.8.6.3.3.2.2.2.cmml" xref="S2.E20.m1.8.8.6.3.3.2.2.2">𝐈𝐧𝐭𝐞𝐧𝐭</ci></apply><cn id="S2.E20.m1.8.8.6.3.3.2.3.cmml" type="integer" xref="S2.E20.m1.8.8.6.3.3.2.3">2</cn></apply><ci id="S2.E20.m1.1.1.cmml" xref="S2.E20.m1.1.1">…</ci><apply id="S2.E20.m1.9.9.7.4.4.3.cmml" xref="S2.E20.m1.9.9.7.4.4.3"><csymbol cd="ambiguous" id="S2.E20.m1.9.9.7.4.4.3.1.cmml" xref="S2.E20.m1.9.9.7.4.4.3">subscript</csymbol><apply id="S2.E20.m1.9.9.7.4.4.3.2.cmml" xref="S2.E20.m1.9.9.7.4.4.3.2"><ci id="S2.E20.m1.9.9.7.4.4.3.2.1.cmml" xref="S2.E20.m1.9.9.7.4.4.3.2.1">^</ci><ci id="S2.E20.m1.9.9.7.4.4.3.2.2.cmml" xref="S2.E20.m1.9.9.7.4.4.3.2.2">𝐈𝐧𝐭𝐞𝐧𝐭</ci></apply><ci id="S2.E20.m1.9.9.7.4.4.3.3.cmml" xref="S2.E20.m1.9.9.7.4.4.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E20.m1.9c">\bm{b}_{1},\bm{b}_{2},\ldots,\bm{b}_{T}=\operatorname{GRU}_{\hat{I}}\left(%
\mathbf{\hat{Intent}}_{1},\mathbf{\hat{Intent}}_{2},\ldots,\mathbf{\hat{Intent%
}}_{T}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E20.m1.9d">bold_italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_b start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT = roman_GRU start_POSTSUBSCRIPT over^ start_ARG italic_I end_ARG end_POSTSUBSCRIPT ( over^ start_ARG bold_Intent end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over^ start_ARG bold_Intent end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , over^ start_ARG bold_Intent end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(21)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{q}_{i}}=\bm{b}_{i}\textbf{W}_{b}" class="ltx_Math" display="block" id="S2.E21.m1.1"><semantics id="S2.E21.m1.1a"><mrow id="S2.E21.m1.1.1" xref="S2.E21.m1.1.1.cmml"><msub id="S2.E21.m1.1.1.2" xref="S2.E21.m1.1.1.2.cmml"><mi id="S2.E21.m1.1.1.2.2" xref="S2.E21.m1.1.1.2.2.cmml">𝒒</mi><mi id="S2.E21.m1.1.1.2.3" xref="S2.E21.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E21.m1.1.1.1" xref="S2.E21.m1.1.1.1.cmml">=</mo><mrow id="S2.E21.m1.1.1.3" xref="S2.E21.m1.1.1.3.cmml"><msub id="S2.E21.m1.1.1.3.2" xref="S2.E21.m1.1.1.3.2.cmml"><mi id="S2.E21.m1.1.1.3.2.2" xref="S2.E21.m1.1.1.3.2.2.cmml">𝒃</mi><mi id="S2.E21.m1.1.1.3.2.3" xref="S2.E21.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="S2.E21.m1.1.1.3.1" xref="S2.E21.m1.1.1.3.1.cmml">⁢</mo><msub id="S2.E21.m1.1.1.3.3" xref="S2.E21.m1.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E21.m1.1.1.3.3.2" xref="S2.E21.m1.1.1.3.3.2a.cmml">W</mtext><mi id="S2.E21.m1.1.1.3.3.3" xref="S2.E21.m1.1.1.3.3.3.cmml">b</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E21.m1.1b"><apply id="S2.E21.m1.1.1.cmml" xref="S2.E21.m1.1.1"><eq id="S2.E21.m1.1.1.1.cmml" xref="S2.E21.m1.1.1.1"></eq><apply id="S2.E21.m1.1.1.2.cmml" xref="S2.E21.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E21.m1.1.1.2.1.cmml" xref="S2.E21.m1.1.1.2">subscript</csymbol><ci id="S2.E21.m1.1.1.2.2.cmml" xref="S2.E21.m1.1.1.2.2">𝒒</ci><ci id="S2.E21.m1.1.1.2.3.cmml" xref="S2.E21.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.E21.m1.1.1.3.cmml" xref="S2.E21.m1.1.1.3"><times id="S2.E21.m1.1.1.3.1.cmml" xref="S2.E21.m1.1.1.3.1"></times><apply id="S2.E21.m1.1.1.3.2.cmml" xref="S2.E21.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E21.m1.1.1.3.2.1.cmml" xref="S2.E21.m1.1.1.3.2">subscript</csymbol><ci id="S2.E21.m1.1.1.3.2.2.cmml" xref="S2.E21.m1.1.1.3.2.2">𝒃</ci><ci id="S2.E21.m1.1.1.3.2.3.cmml" xref="S2.E21.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S2.E21.m1.1.1.3.3.cmml" xref="S2.E21.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E21.m1.1.1.3.3.1.cmml" xref="S2.E21.m1.1.1.3.3">subscript</csymbol><ci id="S2.E21.m1.1.1.3.3.2a.cmml" xref="S2.E21.m1.1.1.3.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E21.m1.1.1.3.3.2.cmml" xref="S2.E21.m1.1.1.3.3.2">W</mtext></ci><ci id="S2.E21.m1.1.1.3.3.3.cmml" xref="S2.E21.m1.1.1.3.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E21.m1.1c">{\bm{q}_{i}}=\bm{b}_{i}\textbf{W}_{b}</annotation><annotation encoding="application/x-llamapun" id="S2.E21.m1.1d">bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = bold_italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT W start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E22">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(22)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\beta_{1}},\mathbf{\beta_{2}},\ldots,\mathbf{\beta_{i}}=\operatorname{%
Softmax}\left(\bm{q}_{1},\bm{q}_{2},\ldots,\bm{q}_{i}\right)" class="ltx_Math" display="block" id="S2.E22.m1.9"><semantics id="S2.E22.m1.9a"><mrow id="S2.E22.m1.9.9" xref="S2.E22.m1.9.9.cmml"><mrow id="S2.E22.m1.6.6.3.3" xref="S2.E22.m1.6.6.3.4.cmml"><msub id="S2.E22.m1.4.4.1.1.1" xref="S2.E22.m1.4.4.1.1.1.cmml"><mi id="S2.E22.m1.4.4.1.1.1.2" xref="S2.E22.m1.4.4.1.1.1.2.cmml">β</mi><mn id="S2.E22.m1.4.4.1.1.1.3" xref="S2.E22.m1.4.4.1.1.1.3.cmml">𝟏</mn></msub><mo id="S2.E22.m1.6.6.3.3.4" xref="S2.E22.m1.6.6.3.4.cmml">,</mo><msub id="S2.E22.m1.5.5.2.2.2" xref="S2.E22.m1.5.5.2.2.2.cmml"><mi id="S2.E22.m1.5.5.2.2.2.2" xref="S2.E22.m1.5.5.2.2.2.2.cmml">β</mi><mn id="S2.E22.m1.5.5.2.2.2.3" xref="S2.E22.m1.5.5.2.2.2.3.cmml">𝟐</mn></msub><mo id="S2.E22.m1.6.6.3.3.5" xref="S2.E22.m1.6.6.3.4.cmml">,</mo><mi id="S2.E22.m1.3.3" mathvariant="normal" xref="S2.E22.m1.3.3.cmml">…</mi><mo id="S2.E22.m1.6.6.3.3.6" xref="S2.E22.m1.6.6.3.4.cmml">,</mo><msub id="S2.E22.m1.6.6.3.3.3" xref="S2.E22.m1.6.6.3.3.3.cmml"><mi id="S2.E22.m1.6.6.3.3.3.2" xref="S2.E22.m1.6.6.3.3.3.2.cmml">β</mi><mi id="S2.E22.m1.6.6.3.3.3.3" xref="S2.E22.m1.6.6.3.3.3.3.cmml">𝐢</mi></msub></mrow><mo id="S2.E22.m1.9.9.7" xref="S2.E22.m1.9.9.7.cmml">=</mo><mrow id="S2.E22.m1.9.9.6.3" xref="S2.E22.m1.9.9.6.4.cmml"><mi id="S2.E22.m1.1.1" xref="S2.E22.m1.1.1.cmml">Softmax</mi><mo id="S2.E22.m1.9.9.6.3a" xref="S2.E22.m1.9.9.6.4.cmml">⁡</mo><mrow id="S2.E22.m1.9.9.6.3.3" xref="S2.E22.m1.9.9.6.4.cmml"><mo id="S2.E22.m1.9.9.6.3.3.4" xref="S2.E22.m1.9.9.6.4.cmml">(</mo><msub id="S2.E22.m1.7.7.4.1.1.1" xref="S2.E22.m1.7.7.4.1.1.1.cmml"><mi id="S2.E22.m1.7.7.4.1.1.1.2" xref="S2.E22.m1.7.7.4.1.1.1.2.cmml">𝒒</mi><mn id="S2.E22.m1.7.7.4.1.1.1.3" xref="S2.E22.m1.7.7.4.1.1.1.3.cmml">1</mn></msub><mo id="S2.E22.m1.9.9.6.3.3.5" xref="S2.E22.m1.9.9.6.4.cmml">,</mo><msub id="S2.E22.m1.8.8.5.2.2.2" xref="S2.E22.m1.8.8.5.2.2.2.cmml"><mi id="S2.E22.m1.8.8.5.2.2.2.2" xref="S2.E22.m1.8.8.5.2.2.2.2.cmml">𝒒</mi><mn id="S2.E22.m1.8.8.5.2.2.2.3" xref="S2.E22.m1.8.8.5.2.2.2.3.cmml">2</mn></msub><mo id="S2.E22.m1.9.9.6.3.3.6" xref="S2.E22.m1.9.9.6.4.cmml">,</mo><mi id="S2.E22.m1.2.2" mathvariant="normal" xref="S2.E22.m1.2.2.cmml">…</mi><mo id="S2.E22.m1.9.9.6.3.3.7" xref="S2.E22.m1.9.9.6.4.cmml">,</mo><msub id="S2.E22.m1.9.9.6.3.3.3" xref="S2.E22.m1.9.9.6.3.3.3.cmml"><mi id="S2.E22.m1.9.9.6.3.3.3.2" xref="S2.E22.m1.9.9.6.3.3.3.2.cmml">𝒒</mi><mi id="S2.E22.m1.9.9.6.3.3.3.3" xref="S2.E22.m1.9.9.6.3.3.3.3.cmml">i</mi></msub><mo id="S2.E22.m1.9.9.6.3.3.8" xref="S2.E22.m1.9.9.6.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E22.m1.9b"><apply id="S2.E22.m1.9.9.cmml" xref="S2.E22.m1.9.9"><eq id="S2.E22.m1.9.9.7.cmml" xref="S2.E22.m1.9.9.7"></eq><list id="S2.E22.m1.6.6.3.4.cmml" xref="S2.E22.m1.6.6.3.3"><apply id="S2.E22.m1.4.4.1.1.1.cmml" xref="S2.E22.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.E22.m1.4.4.1.1.1.1.cmml" xref="S2.E22.m1.4.4.1.1.1">subscript</csymbol><ci id="S2.E22.m1.4.4.1.1.1.2.cmml" xref="S2.E22.m1.4.4.1.1.1.2">𝛽</ci><cn id="S2.E22.m1.4.4.1.1.1.3.cmml" type="integer" xref="S2.E22.m1.4.4.1.1.1.3">1</cn></apply><apply id="S2.E22.m1.5.5.2.2.2.cmml" xref="S2.E22.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.E22.m1.5.5.2.2.2.1.cmml" xref="S2.E22.m1.5.5.2.2.2">subscript</csymbol><ci id="S2.E22.m1.5.5.2.2.2.2.cmml" xref="S2.E22.m1.5.5.2.2.2.2">𝛽</ci><cn id="S2.E22.m1.5.5.2.2.2.3.cmml" type="integer" xref="S2.E22.m1.5.5.2.2.2.3">2</cn></apply><ci id="S2.E22.m1.3.3.cmml" xref="S2.E22.m1.3.3">…</ci><apply id="S2.E22.m1.6.6.3.3.3.cmml" xref="S2.E22.m1.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.E22.m1.6.6.3.3.3.1.cmml" xref="S2.E22.m1.6.6.3.3.3">subscript</csymbol><ci id="S2.E22.m1.6.6.3.3.3.2.cmml" xref="S2.E22.m1.6.6.3.3.3.2">𝛽</ci><ci id="S2.E22.m1.6.6.3.3.3.3.cmml" xref="S2.E22.m1.6.6.3.3.3.3">𝐢</ci></apply></list><apply id="S2.E22.m1.9.9.6.4.cmml" xref="S2.E22.m1.9.9.6.3"><ci id="S2.E22.m1.1.1.cmml" xref="S2.E22.m1.1.1">Softmax</ci><apply id="S2.E22.m1.7.7.4.1.1.1.cmml" xref="S2.E22.m1.7.7.4.1.1.1"><csymbol cd="ambiguous" id="S2.E22.m1.7.7.4.1.1.1.1.cmml" xref="S2.E22.m1.7.7.4.1.1.1">subscript</csymbol><ci id="S2.E22.m1.7.7.4.1.1.1.2.cmml" xref="S2.E22.m1.7.7.4.1.1.1.2">𝒒</ci><cn id="S2.E22.m1.7.7.4.1.1.1.3.cmml" type="integer" xref="S2.E22.m1.7.7.4.1.1.1.3">1</cn></apply><apply id="S2.E22.m1.8.8.5.2.2.2.cmml" xref="S2.E22.m1.8.8.5.2.2.2"><csymbol cd="ambiguous" id="S2.E22.m1.8.8.5.2.2.2.1.cmml" xref="S2.E22.m1.8.8.5.2.2.2">subscript</csymbol><ci id="S2.E22.m1.8.8.5.2.2.2.2.cmml" xref="S2.E22.m1.8.8.5.2.2.2.2">𝒒</ci><cn id="S2.E22.m1.8.8.5.2.2.2.3.cmml" type="integer" xref="S2.E22.m1.8.8.5.2.2.2.3">2</cn></apply><ci id="S2.E22.m1.2.2.cmml" xref="S2.E22.m1.2.2">…</ci><apply id="S2.E22.m1.9.9.6.3.3.3.cmml" xref="S2.E22.m1.9.9.6.3.3.3"><csymbol cd="ambiguous" id="S2.E22.m1.9.9.6.3.3.3.1.cmml" xref="S2.E22.m1.9.9.6.3.3.3">subscript</csymbol><ci id="S2.E22.m1.9.9.6.3.3.3.2.cmml" xref="S2.E22.m1.9.9.6.3.3.3.2">𝒒</ci><ci id="S2.E22.m1.9.9.6.3.3.3.3.cmml" xref="S2.E22.m1.9.9.6.3.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E22.m1.9c">\mathbf{\beta_{1}},\mathbf{\beta_{2}},\ldots,\mathbf{\beta_{i}}=\operatorname{%
Softmax}\left(\bm{q}_{1},\bm{q}_{2},\ldots,\bm{q}_{i}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E22.m1.9d">italic_β start_POSTSUBSCRIPT bold_1 end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT bold_2 end_POSTSUBSCRIPT , … , italic_β start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT = roman_Softmax ( bold_italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(23)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{Y}_{I}=\sum_{i=1}^{T}{\beta_{i}}\odot\mathbf{Intent}_{i}" class="ltx_Math" display="block" id="S2.E23.m1.1"><semantics id="S2.E23.m1.1a"><mrow id="S2.E23.m1.1.1" xref="S2.E23.m1.1.1.cmml"><msub id="S2.E23.m1.1.1.2" xref="S2.E23.m1.1.1.2.cmml"><mi id="S2.E23.m1.1.1.2.2" xref="S2.E23.m1.1.1.2.2.cmml">𝒀</mi><mi id="S2.E23.m1.1.1.2.3" xref="S2.E23.m1.1.1.2.3.cmml">I</mi></msub><mo id="S2.E23.m1.1.1.1" rspace="0.111em" xref="S2.E23.m1.1.1.1.cmml">=</mo><mrow id="S2.E23.m1.1.1.3" xref="S2.E23.m1.1.1.3.cmml"><munderover id="S2.E23.m1.1.1.3.1" xref="S2.E23.m1.1.1.3.1.cmml"><mo id="S2.E23.m1.1.1.3.1.2.2" movablelimits="false" xref="S2.E23.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E23.m1.1.1.3.1.2.3" xref="S2.E23.m1.1.1.3.1.2.3.cmml"><mi id="S2.E23.m1.1.1.3.1.2.3.2" xref="S2.E23.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S2.E23.m1.1.1.3.1.2.3.1" xref="S2.E23.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E23.m1.1.1.3.1.2.3.3" xref="S2.E23.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E23.m1.1.1.3.1.3" xref="S2.E23.m1.1.1.3.1.3.cmml">T</mi></munderover><mrow id="S2.E23.m1.1.1.3.2" xref="S2.E23.m1.1.1.3.2.cmml"><msub id="S2.E23.m1.1.1.3.2.2" xref="S2.E23.m1.1.1.3.2.2.cmml"><mi id="S2.E23.m1.1.1.3.2.2.2" xref="S2.E23.m1.1.1.3.2.2.2.cmml">β</mi><mi id="S2.E23.m1.1.1.3.2.2.3" xref="S2.E23.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="S2.E23.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E23.m1.1.1.3.2.1.cmml">⊙</mo><msub id="S2.E23.m1.1.1.3.2.3" xref="S2.E23.m1.1.1.3.2.3.cmml"><mi id="S2.E23.m1.1.1.3.2.3.2" xref="S2.E23.m1.1.1.3.2.3.2.cmml">𝐈𝐧𝐭𝐞𝐧𝐭</mi><mi id="S2.E23.m1.1.1.3.2.3.3" xref="S2.E23.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E23.m1.1b"><apply id="S2.E23.m1.1.1.cmml" xref="S2.E23.m1.1.1"><eq id="S2.E23.m1.1.1.1.cmml" xref="S2.E23.m1.1.1.1"></eq><apply id="S2.E23.m1.1.1.2.cmml" xref="S2.E23.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E23.m1.1.1.2.1.cmml" xref="S2.E23.m1.1.1.2">subscript</csymbol><ci id="S2.E23.m1.1.1.2.2.cmml" xref="S2.E23.m1.1.1.2.2">𝒀</ci><ci id="S2.E23.m1.1.1.2.3.cmml" xref="S2.E23.m1.1.1.2.3">𝐼</ci></apply><apply id="S2.E23.m1.1.1.3.cmml" xref="S2.E23.m1.1.1.3"><apply id="S2.E23.m1.1.1.3.1.cmml" xref="S2.E23.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E23.m1.1.1.3.1.1.cmml" xref="S2.E23.m1.1.1.3.1">superscript</csymbol><apply id="S2.E23.m1.1.1.3.1.2.cmml" xref="S2.E23.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E23.m1.1.1.3.1.2.1.cmml" xref="S2.E23.m1.1.1.3.1">subscript</csymbol><sum id="S2.E23.m1.1.1.3.1.2.2.cmml" xref="S2.E23.m1.1.1.3.1.2.2"></sum><apply id="S2.E23.m1.1.1.3.1.2.3.cmml" xref="S2.E23.m1.1.1.3.1.2.3"><eq id="S2.E23.m1.1.1.3.1.2.3.1.cmml" xref="S2.E23.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E23.m1.1.1.3.1.2.3.2.cmml" xref="S2.E23.m1.1.1.3.1.2.3.2">𝑖</ci><cn id="S2.E23.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E23.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E23.m1.1.1.3.1.3.cmml" xref="S2.E23.m1.1.1.3.1.3">𝑇</ci></apply><apply id="S2.E23.m1.1.1.3.2.cmml" xref="S2.E23.m1.1.1.3.2"><csymbol cd="latexml" id="S2.E23.m1.1.1.3.2.1.cmml" xref="S2.E23.m1.1.1.3.2.1">direct-product</csymbol><apply id="S2.E23.m1.1.1.3.2.2.cmml" xref="S2.E23.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E23.m1.1.1.3.2.2.1.cmml" xref="S2.E23.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E23.m1.1.1.3.2.2.2.cmml" xref="S2.E23.m1.1.1.3.2.2.2">𝛽</ci><ci id="S2.E23.m1.1.1.3.2.2.3.cmml" xref="S2.E23.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S2.E23.m1.1.1.3.2.3.cmml" xref="S2.E23.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E23.m1.1.1.3.2.3.1.cmml" xref="S2.E23.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E23.m1.1.1.3.2.3.2.cmml" xref="S2.E23.m1.1.1.3.2.3.2">𝐈𝐧𝐭𝐞𝐧𝐭</ci><ci id="S2.E23.m1.1.1.3.2.3.3.cmml" xref="S2.E23.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E23.m1.1c">\bm{Y}_{I}=\sum_{i=1}^{T}{\beta_{i}}\odot\mathbf{Intent}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.E23.m1.1d">bold_italic_Y start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_β start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊙ bold_Intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p2.3">Finally, the method predicts the output using Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E24" title="In 2.5. Aggregation and Prediction ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">24</span></a>, where <math alttext="\textbf{W}_{IP}\in\mathbb{R}^{2d\times d}" class="ltx_Math" display="inline" id="S2.SS5.p2.1.m1.1"><semantics id="S2.SS5.p2.1.m1.1a"><mrow id="S2.SS5.p2.1.m1.1.1" xref="S2.SS5.p2.1.m1.1.1.cmml"><msub id="S2.SS5.p2.1.m1.1.1.2" xref="S2.SS5.p2.1.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p2.1.m1.1.1.2.2" xref="S2.SS5.p2.1.m1.1.1.2.2a.cmml">W</mtext><mrow id="S2.SS5.p2.1.m1.1.1.2.3" xref="S2.SS5.p2.1.m1.1.1.2.3.cmml"><mi id="S2.SS5.p2.1.m1.1.1.2.3.2" xref="S2.SS5.p2.1.m1.1.1.2.3.2.cmml">I</mi><mo id="S2.SS5.p2.1.m1.1.1.2.3.1" xref="S2.SS5.p2.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.1.1.2.3.3" xref="S2.SS5.p2.1.m1.1.1.2.3.3.cmml">P</mi></mrow></msub><mo id="S2.SS5.p2.1.m1.1.1.1" xref="S2.SS5.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS5.p2.1.m1.1.1.3" xref="S2.SS5.p2.1.m1.1.1.3.cmml"><mi id="S2.SS5.p2.1.m1.1.1.3.2" xref="S2.SS5.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS5.p2.1.m1.1.1.3.3" xref="S2.SS5.p2.1.m1.1.1.3.3.cmml"><mrow id="S2.SS5.p2.1.m1.1.1.3.3.2" xref="S2.SS5.p2.1.m1.1.1.3.3.2.cmml"><mn id="S2.SS5.p2.1.m1.1.1.3.3.2.2" xref="S2.SS5.p2.1.m1.1.1.3.3.2.2.cmml">2</mn><mo id="S2.SS5.p2.1.m1.1.1.3.3.2.1" xref="S2.SS5.p2.1.m1.1.1.3.3.2.1.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.1.1.3.3.2.3" xref="S2.SS5.p2.1.m1.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="S2.SS5.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS5.p2.1.m1.1.1.3.3.3" xref="S2.SS5.p2.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.1.m1.1b"><apply id="S2.SS5.p2.1.m1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1"><in id="S2.SS5.p2.1.m1.1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1.1"></in><apply id="S2.SS5.p2.1.m1.1.1.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.1.1.2.1.cmml" xref="S2.SS5.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS5.p2.1.m1.1.1.2.2a.cmml" xref="S2.SS5.p2.1.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p2.1.m1.1.1.2.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2.2">W</mtext></ci><apply id="S2.SS5.p2.1.m1.1.1.2.3.cmml" xref="S2.SS5.p2.1.m1.1.1.2.3"><times id="S2.SS5.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SS5.p2.1.m1.1.1.2.3.1"></times><ci id="S2.SS5.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2.3.2">𝐼</ci><ci id="S2.SS5.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SS5.p2.1.m1.1.1.2.3.3">𝑃</ci></apply></apply><apply id="S2.SS5.p2.1.m1.1.1.3.cmml" xref="S2.SS5.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.1.1.3.1.cmml" xref="S2.SS5.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS5.p2.1.m1.1.1.3.2.cmml" xref="S2.SS5.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S2.SS5.p2.1.m1.1.1.3.3.cmml" xref="S2.SS5.p2.1.m1.1.1.3.3"><times id="S2.SS5.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS5.p2.1.m1.1.1.3.3.1"></times><apply id="S2.SS5.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS5.p2.1.m1.1.1.3.3.2"><times id="S2.SS5.p2.1.m1.1.1.3.3.2.1.cmml" xref="S2.SS5.p2.1.m1.1.1.3.3.2.1"></times><cn id="S2.SS5.p2.1.m1.1.1.3.3.2.2.cmml" type="integer" xref="S2.SS5.p2.1.m1.1.1.3.3.2.2">2</cn><ci id="S2.SS5.p2.1.m1.1.1.3.3.2.3.cmml" xref="S2.SS5.p2.1.m1.1.1.3.3.2.3">𝑑</ci></apply><ci id="S2.SS5.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SS5.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.1.m1.1c">\textbf{W}_{IP}\in\mathbb{R}^{2d\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.1.m1.1d">W start_POSTSUBSCRIPT italic_I italic_P end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 2 italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\textbf{W}_{output}\in\mathbb{R}^{d\times H}" class="ltx_Math" display="inline" id="S2.SS5.p2.2.m2.1"><semantics id="S2.SS5.p2.2.m2.1a"><mrow id="S2.SS5.p2.2.m2.1.1" xref="S2.SS5.p2.2.m2.1.1.cmml"><msub id="S2.SS5.p2.2.m2.1.1.2" xref="S2.SS5.p2.2.m2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p2.2.m2.1.1.2.2" xref="S2.SS5.p2.2.m2.1.1.2.2a.cmml">W</mtext><mrow id="S2.SS5.p2.2.m2.1.1.2.3" xref="S2.SS5.p2.2.m2.1.1.2.3.cmml"><mi id="S2.SS5.p2.2.m2.1.1.2.3.2" xref="S2.SS5.p2.2.m2.1.1.2.3.2.cmml">o</mi><mo id="S2.SS5.p2.2.m2.1.1.2.3.1" xref="S2.SS5.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.2.m2.1.1.2.3.3" xref="S2.SS5.p2.2.m2.1.1.2.3.3.cmml">u</mi><mo id="S2.SS5.p2.2.m2.1.1.2.3.1a" xref="S2.SS5.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.2.m2.1.1.2.3.4" xref="S2.SS5.p2.2.m2.1.1.2.3.4.cmml">t</mi><mo id="S2.SS5.p2.2.m2.1.1.2.3.1b" xref="S2.SS5.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.2.m2.1.1.2.3.5" xref="S2.SS5.p2.2.m2.1.1.2.3.5.cmml">p</mi><mo id="S2.SS5.p2.2.m2.1.1.2.3.1c" xref="S2.SS5.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.2.m2.1.1.2.3.6" xref="S2.SS5.p2.2.m2.1.1.2.3.6.cmml">u</mi><mo id="S2.SS5.p2.2.m2.1.1.2.3.1d" xref="S2.SS5.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.2.m2.1.1.2.3.7" xref="S2.SS5.p2.2.m2.1.1.2.3.7.cmml">t</mi></mrow></msub><mo id="S2.SS5.p2.2.m2.1.1.1" xref="S2.SS5.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS5.p2.2.m2.1.1.3" xref="S2.SS5.p2.2.m2.1.1.3.cmml"><mi id="S2.SS5.p2.2.m2.1.1.3.2" xref="S2.SS5.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS5.p2.2.m2.1.1.3.3" xref="S2.SS5.p2.2.m2.1.1.3.3.cmml"><mi id="S2.SS5.p2.2.m2.1.1.3.3.2" xref="S2.SS5.p2.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S2.SS5.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS5.p2.2.m2.1.1.3.3.3" xref="S2.SS5.p2.2.m2.1.1.3.3.3.cmml">H</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.2.m2.1b"><apply id="S2.SS5.p2.2.m2.1.1.cmml" xref="S2.SS5.p2.2.m2.1.1"><in id="S2.SS5.p2.2.m2.1.1.1.cmml" xref="S2.SS5.p2.2.m2.1.1.1"></in><apply id="S2.SS5.p2.2.m2.1.1.2.cmml" xref="S2.SS5.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.1.1.2.1.cmml" xref="S2.SS5.p2.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS5.p2.2.m2.1.1.2.2a.cmml" xref="S2.SS5.p2.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS5.p2.2.m2.1.1.2.2.cmml" xref="S2.SS5.p2.2.m2.1.1.2.2">W</mtext></ci><apply id="S2.SS5.p2.2.m2.1.1.2.3.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3"><times id="S2.SS5.p2.2.m2.1.1.2.3.1.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3.1"></times><ci id="S2.SS5.p2.2.m2.1.1.2.3.2.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3.2">𝑜</ci><ci id="S2.SS5.p2.2.m2.1.1.2.3.3.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3.3">𝑢</ci><ci id="S2.SS5.p2.2.m2.1.1.2.3.4.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3.4">𝑡</ci><ci id="S2.SS5.p2.2.m2.1.1.2.3.5.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3.5">𝑝</ci><ci id="S2.SS5.p2.2.m2.1.1.2.3.6.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3.6">𝑢</ci><ci id="S2.SS5.p2.2.m2.1.1.2.3.7.cmml" xref="S2.SS5.p2.2.m2.1.1.2.3.7">𝑡</ci></apply></apply><apply id="S2.SS5.p2.2.m2.1.1.3.cmml" xref="S2.SS5.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.1.1.3.1.cmml" xref="S2.SS5.p2.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS5.p2.2.m2.1.1.3.2.cmml" xref="S2.SS5.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS5.p2.2.m2.1.1.3.3.cmml" xref="S2.SS5.p2.2.m2.1.1.3.3"><times id="S2.SS5.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS5.p2.2.m2.1.1.3.3.1"></times><ci id="S2.SS5.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS5.p2.2.m2.1.1.3.3.2">𝑑</ci><ci id="S2.SS5.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS5.p2.2.m2.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.2.m2.1c">\textbf{W}_{output}\in\mathbb{R}^{d\times H}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.2.m2.1d">W start_POSTSUBSCRIPT italic_o italic_u italic_t italic_p italic_u italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_H end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="H" class="ltx_Math" display="inline" id="S2.SS5.p2.3.m3.1"><semantics id="S2.SS5.p2.3.m3.1a"><mi id="S2.SS5.p2.3.m3.1.1" xref="S2.SS5.p2.3.m3.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.3.m3.1b"><ci id="S2.SS5.p2.3.m3.1.1.cmml" xref="S2.SS5.p2.3.m3.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.3.m3.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.3.m3.1d">italic_H</annotation></semantics></math> is the total number of drugs that are available.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E24">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(24)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\bm{y}}=([\bm{Y}_{P},\bm{Y}_{I}]\textbf{W}_{IP})\textbf{W}_{output}" class="ltx_Math" display="block" id="S2.E24.m1.1"><semantics id="S2.E24.m1.1a"><mrow id="S2.E24.m1.1.1" xref="S2.E24.m1.1.1.cmml"><mover accent="true" id="S2.E24.m1.1.1.3" xref="S2.E24.m1.1.1.3.cmml"><mi id="S2.E24.m1.1.1.3.2" xref="S2.E24.m1.1.1.3.2.cmml">𝒚</mi><mo id="S2.E24.m1.1.1.3.1" xref="S2.E24.m1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E24.m1.1.1.2" xref="S2.E24.m1.1.1.2.cmml">=</mo><mrow id="S2.E24.m1.1.1.1" xref="S2.E24.m1.1.1.1.cmml"><mrow id="S2.E24.m1.1.1.1.1.1" xref="S2.E24.m1.1.1.1.1.1.1.cmml"><mo id="S2.E24.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E24.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E24.m1.1.1.1.1.1.1" xref="S2.E24.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E24.m1.1.1.1.1.1.1.2.2" xref="S2.E24.m1.1.1.1.1.1.1.2.3.cmml"><mo id="S2.E24.m1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S2.E24.m1.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S2.E24.m1.1.1.1.1.1.1.1.1.1" xref="S2.E24.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E24.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E24.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒀</mi><mi id="S2.E24.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E24.m1.1.1.1.1.1.1.1.1.1.3.cmml">P</mi></msub><mo id="S2.E24.m1.1.1.1.1.1.1.2.2.4" xref="S2.E24.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E24.m1.1.1.1.1.1.1.2.2.2" xref="S2.E24.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E24.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E24.m1.1.1.1.1.1.1.2.2.2.2.cmml">𝒀</mi><mi id="S2.E24.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.E24.m1.1.1.1.1.1.1.2.2.2.3.cmml">I</mi></msub><mo id="S2.E24.m1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S2.E24.m1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow><mo id="S2.E24.m1.1.1.1.1.1.1.3" xref="S2.E24.m1.1.1.1.1.1.1.3.cmml">⁢</mo><msub id="S2.E24.m1.1.1.1.1.1.1.4" xref="S2.E24.m1.1.1.1.1.1.1.4.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E24.m1.1.1.1.1.1.1.4.2" xref="S2.E24.m1.1.1.1.1.1.1.4.2a.cmml">W</mtext><mrow id="S2.E24.m1.1.1.1.1.1.1.4.3" xref="S2.E24.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S2.E24.m1.1.1.1.1.1.1.4.3.2" xref="S2.E24.m1.1.1.1.1.1.1.4.3.2.cmml">I</mi><mo id="S2.E24.m1.1.1.1.1.1.1.4.3.1" xref="S2.E24.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.E24.m1.1.1.1.1.1.1.4.3.3" xref="S2.E24.m1.1.1.1.1.1.1.4.3.3.cmml">P</mi></mrow></msub></mrow><mo id="S2.E24.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E24.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E24.m1.1.1.1.2" xref="S2.E24.m1.1.1.1.2.cmml">⁢</mo><msub id="S2.E24.m1.1.1.1.3" xref="S2.E24.m1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E24.m1.1.1.1.3.2" xref="S2.E24.m1.1.1.1.3.2a.cmml">W</mtext><mrow id="S2.E24.m1.1.1.1.3.3" xref="S2.E24.m1.1.1.1.3.3.cmml"><mi id="S2.E24.m1.1.1.1.3.3.2" xref="S2.E24.m1.1.1.1.3.3.2.cmml">o</mi><mo id="S2.E24.m1.1.1.1.3.3.1" xref="S2.E24.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E24.m1.1.1.1.3.3.3" xref="S2.E24.m1.1.1.1.3.3.3.cmml">u</mi><mo id="S2.E24.m1.1.1.1.3.3.1a" xref="S2.E24.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E24.m1.1.1.1.3.3.4" xref="S2.E24.m1.1.1.1.3.3.4.cmml">t</mi><mo id="S2.E24.m1.1.1.1.3.3.1b" xref="S2.E24.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E24.m1.1.1.1.3.3.5" xref="S2.E24.m1.1.1.1.3.3.5.cmml">p</mi><mo id="S2.E24.m1.1.1.1.3.3.1c" xref="S2.E24.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E24.m1.1.1.1.3.3.6" xref="S2.E24.m1.1.1.1.3.3.6.cmml">u</mi><mo id="S2.E24.m1.1.1.1.3.3.1d" xref="S2.E24.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E24.m1.1.1.1.3.3.7" xref="S2.E24.m1.1.1.1.3.3.7.cmml">t</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E24.m1.1b"><apply id="S2.E24.m1.1.1.cmml" xref="S2.E24.m1.1.1"><eq id="S2.E24.m1.1.1.2.cmml" xref="S2.E24.m1.1.1.2"></eq><apply id="S2.E24.m1.1.1.3.cmml" xref="S2.E24.m1.1.1.3"><ci id="S2.E24.m1.1.1.3.1.cmml" xref="S2.E24.m1.1.1.3.1">^</ci><ci id="S2.E24.m1.1.1.3.2.cmml" xref="S2.E24.m1.1.1.3.2">𝒚</ci></apply><apply id="S2.E24.m1.1.1.1.cmml" xref="S2.E24.m1.1.1.1"><times id="S2.E24.m1.1.1.1.2.cmml" xref="S2.E24.m1.1.1.1.2"></times><apply id="S2.E24.m1.1.1.1.1.1.1.cmml" xref="S2.E24.m1.1.1.1.1.1"><times id="S2.E24.m1.1.1.1.1.1.1.3.cmml" xref="S2.E24.m1.1.1.1.1.1.1.3"></times><interval closure="closed" id="S2.E24.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E24.m1.1.1.1.1.1.1.2.2"><apply id="S2.E24.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E24.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E24.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E24.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E24.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E24.m1.1.1.1.1.1.1.1.1.1.2">𝒀</ci><ci id="S2.E24.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E24.m1.1.1.1.1.1.1.1.1.1.3">𝑃</ci></apply><apply id="S2.E24.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E24.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E24.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E24.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E24.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E24.m1.1.1.1.1.1.1.2.2.2.2">𝒀</ci><ci id="S2.E24.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E24.m1.1.1.1.1.1.1.2.2.2.3">𝐼</ci></apply></interval><apply id="S2.E24.m1.1.1.1.1.1.1.4.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E24.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E24.m1.1.1.1.1.1.1.4.2a.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4.2"><mtext class="ltx_mathvariant_bold" id="S2.E24.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4.2">W</mtext></ci><apply id="S2.E24.m1.1.1.1.1.1.1.4.3.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4.3"><times id="S2.E24.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4.3.1"></times><ci id="S2.E24.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4.3.2">𝐼</ci><ci id="S2.E24.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S2.E24.m1.1.1.1.1.1.1.4.3.3">𝑃</ci></apply></apply></apply><apply id="S2.E24.m1.1.1.1.3.cmml" xref="S2.E24.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E24.m1.1.1.1.3.1.cmml" xref="S2.E24.m1.1.1.1.3">subscript</csymbol><ci id="S2.E24.m1.1.1.1.3.2a.cmml" xref="S2.E24.m1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.E24.m1.1.1.1.3.2.cmml" xref="S2.E24.m1.1.1.1.3.2">W</mtext></ci><apply id="S2.E24.m1.1.1.1.3.3.cmml" xref="S2.E24.m1.1.1.1.3.3"><times id="S2.E24.m1.1.1.1.3.3.1.cmml" xref="S2.E24.m1.1.1.1.3.3.1"></times><ci id="S2.E24.m1.1.1.1.3.3.2.cmml" xref="S2.E24.m1.1.1.1.3.3.2">𝑜</ci><ci id="S2.E24.m1.1.1.1.3.3.3.cmml" xref="S2.E24.m1.1.1.1.3.3.3">𝑢</ci><ci id="S2.E24.m1.1.1.1.3.3.4.cmml" xref="S2.E24.m1.1.1.1.3.3.4">𝑡</ci><ci id="S2.E24.m1.1.1.1.3.3.5.cmml" xref="S2.E24.m1.1.1.1.3.3.5">𝑝</ci><ci id="S2.E24.m1.1.1.1.3.3.6.cmml" xref="S2.E24.m1.1.1.1.3.3.6">𝑢</ci><ci id="S2.E24.m1.1.1.1.3.3.7.cmml" xref="S2.E24.m1.1.1.1.3.3.7">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E24.m1.1c">\hat{\bm{y}}=([\bm{Y}_{P},\bm{Y}_{I}]\textbf{W}_{IP})\textbf{W}_{output}</annotation><annotation encoding="application/x-llamapun" id="S2.E24.m1.1d">over^ start_ARG bold_italic_y end_ARG = ( [ bold_italic_Y start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT , bold_italic_Y start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ] W start_POSTSUBSCRIPT italic_I italic_P end_POSTSUBSCRIPT ) W start_POSTSUBSCRIPT italic_o italic_u italic_t italic_p italic_u italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6. </span>Loss Function</h3>
<div class="ltx_para" id="S2.SS6.p1">
<p class="ltx_p" id="S2.SS6.p1.5">The proposed method aims to predict the last visit’s prescriptions based on the previous sequence, making it a multi-label classification task. In the training process, two types of loss functions are employed. Firstly, as indicated in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E25" title="In 2.6. Loss Function ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">25</span></a>, Binary Cross Entropy (BCE) is used to predict the probability of each drug,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E25">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(25)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{BCE}=-\sum_{i=1}^{H}\bm{y}_{(i)}\log\sigma\left(\hat{\bm{y}}_{(i)%
}\right)+\left(1-\bm{y}_{(i)}\right)\log\left(1-\sigma\left(\hat{\bm{y}}_{(i)}%
\right)\right)" class="ltx_Math" display="block" id="S2.E25.m1.8"><semantics id="S2.E25.m1.8a"><mrow id="S2.E25.m1.8.8" xref="S2.E25.m1.8.8.cmml"><msub id="S2.E25.m1.8.8.5" xref="S2.E25.m1.8.8.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E25.m1.8.8.5.2" xref="S2.E25.m1.8.8.5.2.cmml">ℒ</mi><mrow id="S2.E25.m1.8.8.5.3" xref="S2.E25.m1.8.8.5.3.cmml"><mi id="S2.E25.m1.8.8.5.3.2" xref="S2.E25.m1.8.8.5.3.2.cmml">B</mi><mo id="S2.E25.m1.8.8.5.3.1" xref="S2.E25.m1.8.8.5.3.1.cmml">⁢</mo><mi id="S2.E25.m1.8.8.5.3.3" xref="S2.E25.m1.8.8.5.3.3.cmml">C</mi><mo id="S2.E25.m1.8.8.5.3.1a" xref="S2.E25.m1.8.8.5.3.1.cmml">⁢</mo><mi id="S2.E25.m1.8.8.5.3.4" xref="S2.E25.m1.8.8.5.3.4.cmml">E</mi></mrow></msub><mo id="S2.E25.m1.8.8.4" xref="S2.E25.m1.8.8.4.cmml">=</mo><mrow id="S2.E25.m1.8.8.3" xref="S2.E25.m1.8.8.3.cmml"><mrow id="S2.E25.m1.6.6.1.1" xref="S2.E25.m1.6.6.1.1.cmml"><mo id="S2.E25.m1.6.6.1.1a" xref="S2.E25.m1.6.6.1.1.cmml">−</mo><mrow id="S2.E25.m1.6.6.1.1.1" xref="S2.E25.m1.6.6.1.1.1.cmml"><munderover id="S2.E25.m1.6.6.1.1.1.2" xref="S2.E25.m1.6.6.1.1.1.2.cmml"><mo id="S2.E25.m1.6.6.1.1.1.2.2.2" movablelimits="false" xref="S2.E25.m1.6.6.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E25.m1.6.6.1.1.1.2.2.3" xref="S2.E25.m1.6.6.1.1.1.2.2.3.cmml"><mi id="S2.E25.m1.6.6.1.1.1.2.2.3.2" xref="S2.E25.m1.6.6.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E25.m1.6.6.1.1.1.2.2.3.1" xref="S2.E25.m1.6.6.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E25.m1.6.6.1.1.1.2.2.3.3" xref="S2.E25.m1.6.6.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E25.m1.6.6.1.1.1.2.3" xref="S2.E25.m1.6.6.1.1.1.2.3.cmml">H</mi></munderover><mrow id="S2.E25.m1.6.6.1.1.1.1" xref="S2.E25.m1.6.6.1.1.1.1.cmml"><msub id="S2.E25.m1.6.6.1.1.1.1.3" xref="S2.E25.m1.6.6.1.1.1.1.3.cmml"><mi id="S2.E25.m1.6.6.1.1.1.1.3.2" xref="S2.E25.m1.6.6.1.1.1.1.3.2.cmml">𝒚</mi><mrow id="S2.E25.m1.1.1.1.3" xref="S2.E25.m1.6.6.1.1.1.1.3.cmml"><mo id="S2.E25.m1.1.1.1.3.1" stretchy="false" xref="S2.E25.m1.6.6.1.1.1.1.3.cmml">(</mo><mi id="S2.E25.m1.1.1.1.1" xref="S2.E25.m1.1.1.1.1.cmml">i</mi><mo id="S2.E25.m1.1.1.1.3.2" stretchy="false" xref="S2.E25.m1.6.6.1.1.1.1.3.cmml">)</mo></mrow></msub><mo id="S2.E25.m1.6.6.1.1.1.1.2" lspace="0.167em" xref="S2.E25.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E25.m1.6.6.1.1.1.1.4" xref="S2.E25.m1.6.6.1.1.1.1.4.cmml"><mi id="S2.E25.m1.6.6.1.1.1.1.4.1" xref="S2.E25.m1.6.6.1.1.1.1.4.1.cmml">log</mi><mo id="S2.E25.m1.6.6.1.1.1.1.4a" lspace="0.167em" xref="S2.E25.m1.6.6.1.1.1.1.4.cmml">⁡</mo><mi id="S2.E25.m1.6.6.1.1.1.1.4.2" xref="S2.E25.m1.6.6.1.1.1.1.4.2.cmml">σ</mi></mrow><mo id="S2.E25.m1.6.6.1.1.1.1.2a" xref="S2.E25.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E25.m1.6.6.1.1.1.1.1.1" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="S2.E25.m1.6.6.1.1.1.1.1.1.2" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E25.m1.6.6.1.1.1.1.1.1.1" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E25.m1.6.6.1.1.1.1.1.1.1.2" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo id="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.1" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E25.m1.2.2.1.3" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="S2.E25.m1.2.2.1.3.1" stretchy="false" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E25.m1.2.2.1.1" xref="S2.E25.m1.2.2.1.1.cmml">i</mi><mo id="S2.E25.m1.2.2.1.3.2" stretchy="false" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></msub><mo id="S2.E25.m1.6.6.1.1.1.1.1.1.3" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E25.m1.8.8.3.4" xref="S2.E25.m1.8.8.3.4.cmml">+</mo><mrow id="S2.E25.m1.8.8.3.3" xref="S2.E25.m1.8.8.3.3.cmml"><mrow id="S2.E25.m1.7.7.2.2.1.1" xref="S2.E25.m1.7.7.2.2.1.1.1.cmml"><mo id="S2.E25.m1.7.7.2.2.1.1.2" xref="S2.E25.m1.7.7.2.2.1.1.1.cmml">(</mo><mrow id="S2.E25.m1.7.7.2.2.1.1.1" xref="S2.E25.m1.7.7.2.2.1.1.1.cmml"><mn id="S2.E25.m1.7.7.2.2.1.1.1.2" xref="S2.E25.m1.7.7.2.2.1.1.1.2.cmml">1</mn><mo id="S2.E25.m1.7.7.2.2.1.1.1.1" xref="S2.E25.m1.7.7.2.2.1.1.1.1.cmml">−</mo><msub id="S2.E25.m1.7.7.2.2.1.1.1.3" xref="S2.E25.m1.7.7.2.2.1.1.1.3.cmml"><mi id="S2.E25.m1.7.7.2.2.1.1.1.3.2" xref="S2.E25.m1.7.7.2.2.1.1.1.3.2.cmml">𝒚</mi><mrow id="S2.E25.m1.3.3.1.3" xref="S2.E25.m1.7.7.2.2.1.1.1.3.cmml"><mo id="S2.E25.m1.3.3.1.3.1" stretchy="false" xref="S2.E25.m1.7.7.2.2.1.1.1.3.cmml">(</mo><mi id="S2.E25.m1.3.3.1.1" xref="S2.E25.m1.3.3.1.1.cmml">i</mi><mo id="S2.E25.m1.3.3.1.3.2" stretchy="false" xref="S2.E25.m1.7.7.2.2.1.1.1.3.cmml">)</mo></mrow></msub></mrow><mo id="S2.E25.m1.7.7.2.2.1.1.3" xref="S2.E25.m1.7.7.2.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E25.m1.8.8.3.3.3" lspace="0.167em" xref="S2.E25.m1.8.8.3.3.3.cmml">⁢</mo><mrow id="S2.E25.m1.8.8.3.3.2.1" xref="S2.E25.m1.8.8.3.3.2.2.cmml"><mi id="S2.E25.m1.5.5" xref="S2.E25.m1.5.5.cmml">log</mi><mo id="S2.E25.m1.8.8.3.3.2.1a" xref="S2.E25.m1.8.8.3.3.2.2.cmml">⁡</mo><mrow id="S2.E25.m1.8.8.3.3.2.1.1" xref="S2.E25.m1.8.8.3.3.2.2.cmml"><mo id="S2.E25.m1.8.8.3.3.2.1.1.2" xref="S2.E25.m1.8.8.3.3.2.2.cmml">(</mo><mrow id="S2.E25.m1.8.8.3.3.2.1.1.1" xref="S2.E25.m1.8.8.3.3.2.1.1.1.cmml"><mn id="S2.E25.m1.8.8.3.3.2.1.1.1.3" xref="S2.E25.m1.8.8.3.3.2.1.1.1.3.cmml">1</mn><mo id="S2.E25.m1.8.8.3.3.2.1.1.1.2" xref="S2.E25.m1.8.8.3.3.2.1.1.1.2.cmml">−</mo><mrow id="S2.E25.m1.8.8.3.3.2.1.1.1.1" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.cmml"><mi id="S2.E25.m1.8.8.3.3.2.1.1.1.1.3" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.3.cmml">σ</mi><mo id="S2.E25.m1.8.8.3.3.2.1.1.1.1.2" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.2" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.2" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.1" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E25.m1.4.4.1.3" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E25.m1.4.4.1.3.1" stretchy="false" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E25.m1.4.4.1.1" xref="S2.E25.m1.4.4.1.1.cmml">i</mi><mo id="S2.E25.m1.4.4.1.3.2" stretchy="false" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msub><mo id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.3" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E25.m1.8.8.3.3.2.1.1.3" xref="S2.E25.m1.8.8.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E25.m1.8b"><apply id="S2.E25.m1.8.8.cmml" xref="S2.E25.m1.8.8"><eq id="S2.E25.m1.8.8.4.cmml" xref="S2.E25.m1.8.8.4"></eq><apply id="S2.E25.m1.8.8.5.cmml" xref="S2.E25.m1.8.8.5"><csymbol cd="ambiguous" id="S2.E25.m1.8.8.5.1.cmml" xref="S2.E25.m1.8.8.5">subscript</csymbol><ci id="S2.E25.m1.8.8.5.2.cmml" xref="S2.E25.m1.8.8.5.2">ℒ</ci><apply id="S2.E25.m1.8.8.5.3.cmml" xref="S2.E25.m1.8.8.5.3"><times id="S2.E25.m1.8.8.5.3.1.cmml" xref="S2.E25.m1.8.8.5.3.1"></times><ci id="S2.E25.m1.8.8.5.3.2.cmml" xref="S2.E25.m1.8.8.5.3.2">𝐵</ci><ci id="S2.E25.m1.8.8.5.3.3.cmml" xref="S2.E25.m1.8.8.5.3.3">𝐶</ci><ci id="S2.E25.m1.8.8.5.3.4.cmml" xref="S2.E25.m1.8.8.5.3.4">𝐸</ci></apply></apply><apply id="S2.E25.m1.8.8.3.cmml" xref="S2.E25.m1.8.8.3"><plus id="S2.E25.m1.8.8.3.4.cmml" xref="S2.E25.m1.8.8.3.4"></plus><apply id="S2.E25.m1.6.6.1.1.cmml" xref="S2.E25.m1.6.6.1.1"><minus id="S2.E25.m1.6.6.1.1.2.cmml" xref="S2.E25.m1.6.6.1.1"></minus><apply id="S2.E25.m1.6.6.1.1.1.cmml" xref="S2.E25.m1.6.6.1.1.1"><apply id="S2.E25.m1.6.6.1.1.1.2.cmml" xref="S2.E25.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S2.E25.m1.6.6.1.1.1.2.1.cmml" xref="S2.E25.m1.6.6.1.1.1.2">superscript</csymbol><apply id="S2.E25.m1.6.6.1.1.1.2.2.cmml" xref="S2.E25.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S2.E25.m1.6.6.1.1.1.2.2.1.cmml" xref="S2.E25.m1.6.6.1.1.1.2">subscript</csymbol><sum id="S2.E25.m1.6.6.1.1.1.2.2.2.cmml" xref="S2.E25.m1.6.6.1.1.1.2.2.2"></sum><apply id="S2.E25.m1.6.6.1.1.1.2.2.3.cmml" xref="S2.E25.m1.6.6.1.1.1.2.2.3"><eq id="S2.E25.m1.6.6.1.1.1.2.2.3.1.cmml" xref="S2.E25.m1.6.6.1.1.1.2.2.3.1"></eq><ci id="S2.E25.m1.6.6.1.1.1.2.2.3.2.cmml" xref="S2.E25.m1.6.6.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E25.m1.6.6.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E25.m1.6.6.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E25.m1.6.6.1.1.1.2.3.cmml" xref="S2.E25.m1.6.6.1.1.1.2.3">𝐻</ci></apply><apply id="S2.E25.m1.6.6.1.1.1.1.cmml" xref="S2.E25.m1.6.6.1.1.1.1"><times id="S2.E25.m1.6.6.1.1.1.1.2.cmml" xref="S2.E25.m1.6.6.1.1.1.1.2"></times><apply id="S2.E25.m1.6.6.1.1.1.1.3.cmml" xref="S2.E25.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E25.m1.6.6.1.1.1.1.3.1.cmml" xref="S2.E25.m1.6.6.1.1.1.1.3">subscript</csymbol><ci id="S2.E25.m1.6.6.1.1.1.1.3.2.cmml" xref="S2.E25.m1.6.6.1.1.1.1.3.2">𝒚</ci><ci id="S2.E25.m1.1.1.1.1.cmml" xref="S2.E25.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.E25.m1.6.6.1.1.1.1.4.cmml" xref="S2.E25.m1.6.6.1.1.1.1.4"><log id="S2.E25.m1.6.6.1.1.1.1.4.1.cmml" xref="S2.E25.m1.6.6.1.1.1.1.4.1"></log><ci id="S2.E25.m1.6.6.1.1.1.1.4.2.cmml" xref="S2.E25.m1.6.6.1.1.1.1.4.2">𝜎</ci></apply><apply id="S2.E25.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E25.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E25.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E25.m1.6.6.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.2"><ci id="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E25.m1.6.6.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="S2.E25.m1.2.2.1.1.cmml" xref="S2.E25.m1.2.2.1.1">𝑖</ci></apply></apply></apply></apply><apply id="S2.E25.m1.8.8.3.3.cmml" xref="S2.E25.m1.8.8.3.3"><times id="S2.E25.m1.8.8.3.3.3.cmml" xref="S2.E25.m1.8.8.3.3.3"></times><apply id="S2.E25.m1.7.7.2.2.1.1.1.cmml" xref="S2.E25.m1.7.7.2.2.1.1"><minus id="S2.E25.m1.7.7.2.2.1.1.1.1.cmml" xref="S2.E25.m1.7.7.2.2.1.1.1.1"></minus><cn id="S2.E25.m1.7.7.2.2.1.1.1.2.cmml" type="integer" xref="S2.E25.m1.7.7.2.2.1.1.1.2">1</cn><apply id="S2.E25.m1.7.7.2.2.1.1.1.3.cmml" xref="S2.E25.m1.7.7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E25.m1.7.7.2.2.1.1.1.3.1.cmml" xref="S2.E25.m1.7.7.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E25.m1.7.7.2.2.1.1.1.3.2.cmml" xref="S2.E25.m1.7.7.2.2.1.1.1.3.2">𝒚</ci><ci id="S2.E25.m1.3.3.1.1.cmml" xref="S2.E25.m1.3.3.1.1">𝑖</ci></apply></apply><apply id="S2.E25.m1.8.8.3.3.2.2.cmml" xref="S2.E25.m1.8.8.3.3.2.1"><log id="S2.E25.m1.5.5.cmml" xref="S2.E25.m1.5.5"></log><apply id="S2.E25.m1.8.8.3.3.2.1.1.1.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1"><minus id="S2.E25.m1.8.8.3.3.2.1.1.1.2.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.2"></minus><cn id="S2.E25.m1.8.8.3.3.2.1.1.1.3.cmml" type="integer" xref="S2.E25.m1.8.8.3.3.2.1.1.1.3">1</cn><apply id="S2.E25.m1.8.8.3.3.2.1.1.1.1.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1"><times id="S2.E25.m1.8.8.3.3.2.1.1.1.1.2.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.2"></times><ci id="S2.E25.m1.8.8.3.3.2.1.1.1.1.3.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.3">𝜎</ci><apply id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2"><ci id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E25.m1.8.8.3.3.2.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="S2.E25.m1.4.4.1.1.cmml" xref="S2.E25.m1.4.4.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E25.m1.8c">\mathcal{L}_{BCE}=-\sum_{i=1}^{H}\bm{y}_{(i)}\log\sigma\left(\hat{\bm{y}}_{(i)%
}\right)+\left(1-\bm{y}_{(i)}\right)\log\left(1-\sigma\left(\hat{\bm{y}}_{(i)}%
\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E25.m1.8d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT bold_italic_y start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT roman_log italic_σ ( over^ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT ) + ( 1 - bold_italic_y start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT ) roman_log ( 1 - italic_σ ( over^ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS6.p1.4">where <math alttext="\bm{y}" class="ltx_Math" display="inline" id="S2.SS6.p1.1.m1.1"><semantics id="S2.SS6.p1.1.m1.1a"><mi id="S2.SS6.p1.1.m1.1.1" xref="S2.SS6.p1.1.m1.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.1.m1.1b"><ci id="S2.SS6.p1.1.m1.1.1.cmml" xref="S2.SS6.p1.1.m1.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.1.m1.1c">\bm{y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.1.m1.1d">bold_italic_y</annotation></semantics></math> corresponds to the true label, <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS6.p1.2.m2.1"><semantics id="S2.SS6.p1.2.m2.1a"><mi id="S2.SS6.p1.2.m2.1.1" xref="S2.SS6.p1.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.2.m2.1b"><ci id="S2.SS6.p1.2.m2.1.1.cmml" xref="S2.SS6.p1.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.2.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.2.m2.1d">italic_σ</annotation></semantics></math> refers to the Sigmoid function, and <math alttext="\hat{\bm{y}}_{(i)}" class="ltx_Math" display="inline" id="S2.SS6.p1.3.m3.1"><semantics id="S2.SS6.p1.3.m3.1a"><msub id="S2.SS6.p1.3.m3.1.2" xref="S2.SS6.p1.3.m3.1.2.cmml"><mover accent="true" id="S2.SS6.p1.3.m3.1.2.2" xref="S2.SS6.p1.3.m3.1.2.2.cmml"><mi id="S2.SS6.p1.3.m3.1.2.2.2" xref="S2.SS6.p1.3.m3.1.2.2.2.cmml">𝒚</mi><mo id="S2.SS6.p1.3.m3.1.2.2.1" xref="S2.SS6.p1.3.m3.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS6.p1.3.m3.1.1.1.3" xref="S2.SS6.p1.3.m3.1.2.cmml"><mo id="S2.SS6.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S2.SS6.p1.3.m3.1.2.cmml">(</mo><mi id="S2.SS6.p1.3.m3.1.1.1.1" xref="S2.SS6.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.SS6.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S2.SS6.p1.3.m3.1.2.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.3.m3.1b"><apply id="S2.SS6.p1.3.m3.1.2.cmml" xref="S2.SS6.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S2.SS6.p1.3.m3.1.2.1.cmml" xref="S2.SS6.p1.3.m3.1.2">subscript</csymbol><apply id="S2.SS6.p1.3.m3.1.2.2.cmml" xref="S2.SS6.p1.3.m3.1.2.2"><ci id="S2.SS6.p1.3.m3.1.2.2.1.cmml" xref="S2.SS6.p1.3.m3.1.2.2.1">^</ci><ci id="S2.SS6.p1.3.m3.1.2.2.2.cmml" xref="S2.SS6.p1.3.m3.1.2.2.2">𝒚</ci></apply><ci id="S2.SS6.p1.3.m3.1.1.1.1.cmml" xref="S2.SS6.p1.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.3.m3.1c">\hat{\bm{y}}_{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.3.m3.1d">over^ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT</annotation></semantics></math> refers to the prediction score for <math alttext="i^{th}" class="ltx_Math" display="inline" id="S2.SS6.p1.4.m4.1"><semantics id="S2.SS6.p1.4.m4.1a"><msup id="S2.SS6.p1.4.m4.1.1" xref="S2.SS6.p1.4.m4.1.1.cmml"><mi id="S2.SS6.p1.4.m4.1.1.2" xref="S2.SS6.p1.4.m4.1.1.2.cmml">i</mi><mrow id="S2.SS6.p1.4.m4.1.1.3" xref="S2.SS6.p1.4.m4.1.1.3.cmml"><mi id="S2.SS6.p1.4.m4.1.1.3.2" xref="S2.SS6.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S2.SS6.p1.4.m4.1.1.3.1" xref="S2.SS6.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p1.4.m4.1.1.3.3" xref="S2.SS6.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.4.m4.1b"><apply id="S2.SS6.p1.4.m4.1.1.cmml" xref="S2.SS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS6.p1.4.m4.1.1.1.cmml" xref="S2.SS6.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS6.p1.4.m4.1.1.2.cmml" xref="S2.SS6.p1.4.m4.1.1.2">𝑖</ci><apply id="S2.SS6.p1.4.m4.1.1.3.cmml" xref="S2.SS6.p1.4.m4.1.1.3"><times id="S2.SS6.p1.4.m4.1.1.3.1.cmml" xref="S2.SS6.p1.4.m4.1.1.3.1"></times><ci id="S2.SS6.p1.4.m4.1.1.3.2.cmml" xref="S2.SS6.p1.4.m4.1.1.3.2">𝑡</ci><ci id="S2.SS6.p1.4.m4.1.1.3.3.cmml" xref="S2.SS6.p1.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.4.m4.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.4.m4.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> drug.</p>
</div>
<div class="ltx_para" id="S2.SS6.p2">
<p class="ltx_p" id="S2.SS6.p2.1">Furthermore, for enhanced result robustness and to maintain a one-margin superiority of truth labels over others, we employ the Multi-Label Hinge Loss, as identified in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E26" title="In 2.6. Loss Function ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">26</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS6.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.E26">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(26)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{multi}=\sum_{i,j:{\bm{y}}_{(i)}=1,{\bm{y}}_{(j)}=0}\frac{\max%
\left(0,1-\left(\sigma(\hat{{\bm{y}}}_{(i)})-{\sigma({\hat{\bm{y}}}_{(j)})}%
\right)\right)}{|H|}" class="ltx_Math" display="block" id="S2.E26.m1.12"><semantics id="S2.E26.m1.12a"><mrow id="S2.E26.m1.12.13" xref="S2.E26.m1.12.13.cmml"><msub id="S2.E26.m1.12.13.2" xref="S2.E26.m1.12.13.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E26.m1.12.13.2.2" xref="S2.E26.m1.12.13.2.2.cmml">ℒ</mi><mrow id="S2.E26.m1.12.13.2.3" xref="S2.E26.m1.12.13.2.3.cmml"><mi id="S2.E26.m1.12.13.2.3.2" xref="S2.E26.m1.12.13.2.3.2.cmml">m</mi><mo id="S2.E26.m1.12.13.2.3.1" xref="S2.E26.m1.12.13.2.3.1.cmml">⁢</mo><mi id="S2.E26.m1.12.13.2.3.3" xref="S2.E26.m1.12.13.2.3.3.cmml">u</mi><mo id="S2.E26.m1.12.13.2.3.1a" xref="S2.E26.m1.12.13.2.3.1.cmml">⁢</mo><mi id="S2.E26.m1.12.13.2.3.4" xref="S2.E26.m1.12.13.2.3.4.cmml">l</mi><mo id="S2.E26.m1.12.13.2.3.1b" xref="S2.E26.m1.12.13.2.3.1.cmml">⁢</mo><mi id="S2.E26.m1.12.13.2.3.5" xref="S2.E26.m1.12.13.2.3.5.cmml">t</mi><mo id="S2.E26.m1.12.13.2.3.1c" xref="S2.E26.m1.12.13.2.3.1.cmml">⁢</mo><mi id="S2.E26.m1.12.13.2.3.6" xref="S2.E26.m1.12.13.2.3.6.cmml">i</mi></mrow></msub><mo id="S2.E26.m1.12.13.1" rspace="0.111em" xref="S2.E26.m1.12.13.1.cmml">=</mo><mrow id="S2.E26.m1.12.13.3" xref="S2.E26.m1.12.13.3.cmml"><munder id="S2.E26.m1.12.13.3.1" xref="S2.E26.m1.12.13.3.1.cmml"><mo id="S2.E26.m1.12.13.3.1.2" movablelimits="false" xref="S2.E26.m1.12.13.3.1.2.cmml">∑</mo><mrow id="S2.E26.m1.6.6.6" xref="S2.E26.m1.6.6.6.cmml"><mrow id="S2.E26.m1.6.6.6.8.2" xref="S2.E26.m1.6.6.6.8.1.cmml"><mi id="S2.E26.m1.3.3.3.3" xref="S2.E26.m1.3.3.3.3.cmml">i</mi><mo id="S2.E26.m1.6.6.6.8.2.1" xref="S2.E26.m1.6.6.6.8.1.cmml">,</mo><mi id="S2.E26.m1.4.4.4.4" xref="S2.E26.m1.4.4.4.4.cmml">j</mi></mrow><mo id="S2.E26.m1.6.6.6.7" lspace="0.278em" rspace="0.278em" xref="S2.E26.m1.6.6.6.7.cmml">:</mo><mrow id="S2.E26.m1.6.6.6.6.2" xref="S2.E26.m1.6.6.6.6.3.cmml"><mrow id="S2.E26.m1.5.5.5.5.1.1" xref="S2.E26.m1.5.5.5.5.1.1.cmml"><msub id="S2.E26.m1.5.5.5.5.1.1.2" xref="S2.E26.m1.5.5.5.5.1.1.2.cmml"><mi id="S2.E26.m1.5.5.5.5.1.1.2.2" xref="S2.E26.m1.5.5.5.5.1.1.2.2.cmml">𝒚</mi><mrow id="S2.E26.m1.1.1.1.1.1.3" xref="S2.E26.m1.5.5.5.5.1.1.2.cmml"><mo id="S2.E26.m1.1.1.1.1.1.3.1" stretchy="false" xref="S2.E26.m1.5.5.5.5.1.1.2.cmml">(</mo><mi id="S2.E26.m1.1.1.1.1.1.1" xref="S2.E26.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S2.E26.m1.1.1.1.1.1.3.2" stretchy="false" xref="S2.E26.m1.5.5.5.5.1.1.2.cmml">)</mo></mrow></msub><mo id="S2.E26.m1.5.5.5.5.1.1.1" xref="S2.E26.m1.5.5.5.5.1.1.1.cmml">=</mo><mn id="S2.E26.m1.5.5.5.5.1.1.3" xref="S2.E26.m1.5.5.5.5.1.1.3.cmml">1</mn></mrow><mo id="S2.E26.m1.6.6.6.6.2.3" xref="S2.E26.m1.6.6.6.6.3a.cmml">,</mo><mrow id="S2.E26.m1.6.6.6.6.2.2" xref="S2.E26.m1.6.6.6.6.2.2.cmml"><msub id="S2.E26.m1.6.6.6.6.2.2.2" xref="S2.E26.m1.6.6.6.6.2.2.2.cmml"><mi id="S2.E26.m1.6.6.6.6.2.2.2.2" xref="S2.E26.m1.6.6.6.6.2.2.2.2.cmml">𝒚</mi><mrow id="S2.E26.m1.2.2.2.2.1.3" xref="S2.E26.m1.6.6.6.6.2.2.2.cmml"><mo id="S2.E26.m1.2.2.2.2.1.3.1" stretchy="false" xref="S2.E26.m1.6.6.6.6.2.2.2.cmml">(</mo><mi id="S2.E26.m1.2.2.2.2.1.1" xref="S2.E26.m1.2.2.2.2.1.1.cmml">j</mi><mo id="S2.E26.m1.2.2.2.2.1.3.2" stretchy="false" xref="S2.E26.m1.6.6.6.6.2.2.2.cmml">)</mo></mrow></msub><mo id="S2.E26.m1.6.6.6.6.2.2.1" xref="S2.E26.m1.6.6.6.6.2.2.1.cmml">=</mo><mn id="S2.E26.m1.6.6.6.6.2.2.3" xref="S2.E26.m1.6.6.6.6.2.2.3.cmml">0</mn></mrow></mrow></mrow></munder><mfrac id="S2.E26.m1.12.12" xref="S2.E26.m1.12.12.cmml"><mrow id="S2.E26.m1.11.11.5.5" xref="S2.E26.m1.11.11.5.6.cmml"><mi id="S2.E26.m1.9.9.3.3" xref="S2.E26.m1.9.9.3.3.cmml">max</mi><mo id="S2.E26.m1.11.11.5.5a" xref="S2.E26.m1.11.11.5.6.cmml">⁡</mo><mrow id="S2.E26.m1.11.11.5.5.1" xref="S2.E26.m1.11.11.5.6.cmml"><mo id="S2.E26.m1.11.11.5.5.1.2" xref="S2.E26.m1.11.11.5.6.cmml">(</mo><mn id="S2.E26.m1.10.10.4.4" xref="S2.E26.m1.10.10.4.4.cmml">0</mn><mo id="S2.E26.m1.11.11.5.5.1.3" xref="S2.E26.m1.11.11.5.6.cmml">,</mo><mrow id="S2.E26.m1.11.11.5.5.1.1" xref="S2.E26.m1.11.11.5.5.1.1.cmml"><mn id="S2.E26.m1.11.11.5.5.1.1.3" xref="S2.E26.m1.11.11.5.5.1.1.3.cmml">1</mn><mo id="S2.E26.m1.11.11.5.5.1.1.2" xref="S2.E26.m1.11.11.5.5.1.1.2.cmml">−</mo><mrow id="S2.E26.m1.11.11.5.5.1.1.1.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.cmml"><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S2.E26.m1.11.11.5.5.1.1.1.1.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.cmml"><mrow id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.cmml"><mi id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.3" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E26.m1.7.7.1.1.1.3" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E26.m1.7.7.1.1.1.3.1" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E26.m1.7.7.1.1.1.1" xref="S2.E26.m1.7.7.1.1.1.1.cmml">i</mi><mo id="S2.E26.m1.7.7.1.1.1.3.2" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msub><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.3" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.cmml"><mi id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.3" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.3.cmml">σ</mi><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.2" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.2.cmml">𝒚</mi><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.1" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.E26.m1.8.8.2.2.1.3" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E26.m1.8.8.2.2.1.3.1" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml">(</mo><mi id="S2.E26.m1.8.8.2.2.1.1" xref="S2.E26.m1.8.8.2.2.1.1.cmml">j</mi><mo id="S2.E26.m1.8.8.2.2.1.3.2" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></msub><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E26.m1.11.11.5.5.1.1.1.1.3" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E26.m1.11.11.5.5.1.4" xref="S2.E26.m1.11.11.5.6.cmml">)</mo></mrow></mrow><mrow id="S2.E26.m1.12.12.6.3" xref="S2.E26.m1.12.12.6.2.cmml"><mo id="S2.E26.m1.12.12.6.3.1" stretchy="false" xref="S2.E26.m1.12.12.6.2.1.cmml">|</mo><mi id="S2.E26.m1.12.12.6.1" xref="S2.E26.m1.12.12.6.1.cmml">H</mi><mo id="S2.E26.m1.12.12.6.3.2" stretchy="false" xref="S2.E26.m1.12.12.6.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E26.m1.12b"><apply id="S2.E26.m1.12.13.cmml" xref="S2.E26.m1.12.13"><eq id="S2.E26.m1.12.13.1.cmml" xref="S2.E26.m1.12.13.1"></eq><apply id="S2.E26.m1.12.13.2.cmml" xref="S2.E26.m1.12.13.2"><csymbol cd="ambiguous" id="S2.E26.m1.12.13.2.1.cmml" xref="S2.E26.m1.12.13.2">subscript</csymbol><ci id="S2.E26.m1.12.13.2.2.cmml" xref="S2.E26.m1.12.13.2.2">ℒ</ci><apply id="S2.E26.m1.12.13.2.3.cmml" xref="S2.E26.m1.12.13.2.3"><times id="S2.E26.m1.12.13.2.3.1.cmml" xref="S2.E26.m1.12.13.2.3.1"></times><ci id="S2.E26.m1.12.13.2.3.2.cmml" xref="S2.E26.m1.12.13.2.3.2">𝑚</ci><ci id="S2.E26.m1.12.13.2.3.3.cmml" xref="S2.E26.m1.12.13.2.3.3">𝑢</ci><ci id="S2.E26.m1.12.13.2.3.4.cmml" xref="S2.E26.m1.12.13.2.3.4">𝑙</ci><ci id="S2.E26.m1.12.13.2.3.5.cmml" xref="S2.E26.m1.12.13.2.3.5">𝑡</ci><ci id="S2.E26.m1.12.13.2.3.6.cmml" xref="S2.E26.m1.12.13.2.3.6">𝑖</ci></apply></apply><apply id="S2.E26.m1.12.13.3.cmml" xref="S2.E26.m1.12.13.3"><apply id="S2.E26.m1.12.13.3.1.cmml" xref="S2.E26.m1.12.13.3.1"><csymbol cd="ambiguous" id="S2.E26.m1.12.13.3.1.1.cmml" xref="S2.E26.m1.12.13.3.1">subscript</csymbol><sum id="S2.E26.m1.12.13.3.1.2.cmml" xref="S2.E26.m1.12.13.3.1.2"></sum><apply id="S2.E26.m1.6.6.6.cmml" xref="S2.E26.m1.6.6.6"><ci id="S2.E26.m1.6.6.6.7.cmml" xref="S2.E26.m1.6.6.6.7">:</ci><list id="S2.E26.m1.6.6.6.8.1.cmml" xref="S2.E26.m1.6.6.6.8.2"><ci id="S2.E26.m1.3.3.3.3.cmml" xref="S2.E26.m1.3.3.3.3">𝑖</ci><ci id="S2.E26.m1.4.4.4.4.cmml" xref="S2.E26.m1.4.4.4.4">𝑗</ci></list><apply id="S2.E26.m1.6.6.6.6.3.cmml" xref="S2.E26.m1.6.6.6.6.2"><csymbol cd="ambiguous" id="S2.E26.m1.6.6.6.6.3a.cmml" xref="S2.E26.m1.6.6.6.6.2.3">formulae-sequence</csymbol><apply id="S2.E26.m1.5.5.5.5.1.1.cmml" xref="S2.E26.m1.5.5.5.5.1.1"><eq id="S2.E26.m1.5.5.5.5.1.1.1.cmml" xref="S2.E26.m1.5.5.5.5.1.1.1"></eq><apply id="S2.E26.m1.5.5.5.5.1.1.2.cmml" xref="S2.E26.m1.5.5.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E26.m1.5.5.5.5.1.1.2.1.cmml" xref="S2.E26.m1.5.5.5.5.1.1.2">subscript</csymbol><ci id="S2.E26.m1.5.5.5.5.1.1.2.2.cmml" xref="S2.E26.m1.5.5.5.5.1.1.2.2">𝒚</ci><ci id="S2.E26.m1.1.1.1.1.1.1.cmml" xref="S2.E26.m1.1.1.1.1.1.1">𝑖</ci></apply><cn id="S2.E26.m1.5.5.5.5.1.1.3.cmml" type="integer" xref="S2.E26.m1.5.5.5.5.1.1.3">1</cn></apply><apply id="S2.E26.m1.6.6.6.6.2.2.cmml" xref="S2.E26.m1.6.6.6.6.2.2"><eq id="S2.E26.m1.6.6.6.6.2.2.1.cmml" xref="S2.E26.m1.6.6.6.6.2.2.1"></eq><apply id="S2.E26.m1.6.6.6.6.2.2.2.cmml" xref="S2.E26.m1.6.6.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.E26.m1.6.6.6.6.2.2.2.1.cmml" xref="S2.E26.m1.6.6.6.6.2.2.2">subscript</csymbol><ci id="S2.E26.m1.6.6.6.6.2.2.2.2.cmml" xref="S2.E26.m1.6.6.6.6.2.2.2.2">𝒚</ci><ci id="S2.E26.m1.2.2.2.2.1.1.cmml" xref="S2.E26.m1.2.2.2.2.1.1">𝑗</ci></apply><cn id="S2.E26.m1.6.6.6.6.2.2.3.cmml" type="integer" xref="S2.E26.m1.6.6.6.6.2.2.3">0</cn></apply></apply></apply></apply><apply id="S2.E26.m1.12.12.cmml" xref="S2.E26.m1.12.12"><divide id="S2.E26.m1.12.12.7.cmml" xref="S2.E26.m1.12.12"></divide><apply id="S2.E26.m1.11.11.5.6.cmml" xref="S2.E26.m1.11.11.5.5"><max id="S2.E26.m1.9.9.3.3.cmml" xref="S2.E26.m1.9.9.3.3"></max><cn id="S2.E26.m1.10.10.4.4.cmml" type="integer" xref="S2.E26.m1.10.10.4.4">0</cn><apply id="S2.E26.m1.11.11.5.5.1.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1"><minus id="S2.E26.m1.11.11.5.5.1.1.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.2"></minus><cn id="S2.E26.m1.11.11.5.5.1.1.3.cmml" type="integer" xref="S2.E26.m1.11.11.5.5.1.1.3">1</cn><apply id="S2.E26.m1.11.11.5.5.1.1.1.1.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1"><minus id="S2.E26.m1.11.11.5.5.1.1.1.1.1.3.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.3"></minus><apply id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1"><times id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.2"></times><ci id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.3">𝜎</ci><apply id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2"><ci id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="S2.E26.m1.7.7.1.1.1.1.cmml" xref="S2.E26.m1.7.7.1.1.1.1">𝑖</ci></apply></apply><apply id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2"><times id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.2"></times><ci id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.3.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.3">𝜎</ci><apply id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1">subscript</csymbol><apply id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2"><ci id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.1">^</ci><ci id="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S2.E26.m1.11.11.5.5.1.1.1.1.1.2.1.1.1.2.2">𝒚</ci></apply><ci id="S2.E26.m1.8.8.2.2.1.1.cmml" xref="S2.E26.m1.8.8.2.2.1.1">𝑗</ci></apply></apply></apply></apply></apply><apply id="S2.E26.m1.12.12.6.2.cmml" xref="S2.E26.m1.12.12.6.3"><abs id="S2.E26.m1.12.12.6.2.1.cmml" xref="S2.E26.m1.12.12.6.3.1"></abs><ci id="S2.E26.m1.12.12.6.1.cmml" xref="S2.E26.m1.12.12.6.1">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E26.m1.12c">\mathcal{L}_{multi}=\sum_{i,j:{\bm{y}}_{(i)}=1,{\bm{y}}_{(j)}=0}\frac{\max%
\left(0,1-\left(\sigma(\hat{{\bm{y}}}_{(i)})-{\sigma({\hat{\bm{y}}}_{(j)})}%
\right)\right)}{|H|}</annotation><annotation encoding="application/x-llamapun" id="S2.E26.m1.12d">caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i , italic_j : bold_italic_y start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT = 1 , bold_italic_y start_POSTSUBSCRIPT ( italic_j ) end_POSTSUBSCRIPT = 0 end_POSTSUBSCRIPT divide start_ARG roman_max ( 0 , 1 - ( italic_σ ( over^ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_i ) end_POSTSUBSCRIPT ) - italic_σ ( over^ start_ARG bold_italic_y end_ARG start_POSTSUBSCRIPT ( italic_j ) end_POSTSUBSCRIPT ) ) ) end_ARG start_ARG | italic_H | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS6.p4">
<p class="ltx_p" id="S2.SS6.p4.5">Moreover, the contrastive loss <math alttext="{\mathcal{L}}_{I}" class="ltx_Math" display="inline" id="S2.SS6.p4.1.m1.1"><semantics id="S2.SS6.p4.1.m1.1a"><msub id="S2.SS6.p4.1.m1.1.1" xref="S2.SS6.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS6.p4.1.m1.1.1.2" xref="S2.SS6.p4.1.m1.1.1.2.cmml">ℒ</mi><mi id="S2.SS6.p4.1.m1.1.1.3" xref="S2.SS6.p4.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS6.p4.1.m1.1b"><apply id="S2.SS6.p4.1.m1.1.1.cmml" xref="S2.SS6.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS6.p4.1.m1.1.1.1.cmml" xref="S2.SS6.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS6.p4.1.m1.1.1.2.cmml" xref="S2.SS6.p4.1.m1.1.1.2">ℒ</ci><ci id="S2.SS6.p4.1.m1.1.1.3.cmml" xref="S2.SS6.p4.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p4.1.m1.1c">{\mathcal{L}}_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p4.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> calculated in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.SS4" title="2.4. Contrasted Intents ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">2.4</span></a> is added to <math alttext="\mathcal{L}_{BCE}" class="ltx_Math" display="inline" id="S2.SS6.p4.2.m2.1"><semantics id="S2.SS6.p4.2.m2.1a"><msub id="S2.SS6.p4.2.m2.1.1" xref="S2.SS6.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS6.p4.2.m2.1.1.2" xref="S2.SS6.p4.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S2.SS6.p4.2.m2.1.1.3" xref="S2.SS6.p4.2.m2.1.1.3.cmml"><mi id="S2.SS6.p4.2.m2.1.1.3.2" xref="S2.SS6.p4.2.m2.1.1.3.2.cmml">B</mi><mo id="S2.SS6.p4.2.m2.1.1.3.1" xref="S2.SS6.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p4.2.m2.1.1.3.3" xref="S2.SS6.p4.2.m2.1.1.3.3.cmml">C</mi><mo id="S2.SS6.p4.2.m2.1.1.3.1a" xref="S2.SS6.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p4.2.m2.1.1.3.4" xref="S2.SS6.p4.2.m2.1.1.3.4.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS6.p4.2.m2.1b"><apply id="S2.SS6.p4.2.m2.1.1.cmml" xref="S2.SS6.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS6.p4.2.m2.1.1.1.cmml" xref="S2.SS6.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS6.p4.2.m2.1.1.2.cmml" xref="S2.SS6.p4.2.m2.1.1.2">ℒ</ci><apply id="S2.SS6.p4.2.m2.1.1.3.cmml" xref="S2.SS6.p4.2.m2.1.1.3"><times id="S2.SS6.p4.2.m2.1.1.3.1.cmml" xref="S2.SS6.p4.2.m2.1.1.3.1"></times><ci id="S2.SS6.p4.2.m2.1.1.3.2.cmml" xref="S2.SS6.p4.2.m2.1.1.3.2">𝐵</ci><ci id="S2.SS6.p4.2.m2.1.1.3.3.cmml" xref="S2.SS6.p4.2.m2.1.1.3.3">𝐶</ci><ci id="S2.SS6.p4.2.m2.1.1.3.4.cmml" xref="S2.SS6.p4.2.m2.1.1.3.4">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p4.2.m2.1c">\mathcal{L}_{BCE}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p4.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{multi}" class="ltx_Math" display="inline" id="S2.SS6.p4.3.m3.1"><semantics id="S2.SS6.p4.3.m3.1a"><msub id="S2.SS6.p4.3.m3.1.1" xref="S2.SS6.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS6.p4.3.m3.1.1.2" xref="S2.SS6.p4.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S2.SS6.p4.3.m3.1.1.3" xref="S2.SS6.p4.3.m3.1.1.3.cmml"><mi id="S2.SS6.p4.3.m3.1.1.3.2" xref="S2.SS6.p4.3.m3.1.1.3.2.cmml">m</mi><mo id="S2.SS6.p4.3.m3.1.1.3.1" xref="S2.SS6.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p4.3.m3.1.1.3.3" xref="S2.SS6.p4.3.m3.1.1.3.3.cmml">u</mi><mo id="S2.SS6.p4.3.m3.1.1.3.1a" xref="S2.SS6.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p4.3.m3.1.1.3.4" xref="S2.SS6.p4.3.m3.1.1.3.4.cmml">l</mi><mo id="S2.SS6.p4.3.m3.1.1.3.1b" xref="S2.SS6.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p4.3.m3.1.1.3.5" xref="S2.SS6.p4.3.m3.1.1.3.5.cmml">t</mi><mo id="S2.SS6.p4.3.m3.1.1.3.1c" xref="S2.SS6.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS6.p4.3.m3.1.1.3.6" xref="S2.SS6.p4.3.m3.1.1.3.6.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS6.p4.3.m3.1b"><apply id="S2.SS6.p4.3.m3.1.1.cmml" xref="S2.SS6.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS6.p4.3.m3.1.1.1.cmml" xref="S2.SS6.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS6.p4.3.m3.1.1.2.cmml" xref="S2.SS6.p4.3.m3.1.1.2">ℒ</ci><apply id="S2.SS6.p4.3.m3.1.1.3.cmml" xref="S2.SS6.p4.3.m3.1.1.3"><times id="S2.SS6.p4.3.m3.1.1.3.1.cmml" xref="S2.SS6.p4.3.m3.1.1.3.1"></times><ci id="S2.SS6.p4.3.m3.1.1.3.2.cmml" xref="S2.SS6.p4.3.m3.1.1.3.2">𝑚</ci><ci id="S2.SS6.p4.3.m3.1.1.3.3.cmml" xref="S2.SS6.p4.3.m3.1.1.3.3">𝑢</ci><ci id="S2.SS6.p4.3.m3.1.1.3.4.cmml" xref="S2.SS6.p4.3.m3.1.1.3.4">𝑙</ci><ci id="S2.SS6.p4.3.m3.1.1.3.5.cmml" xref="S2.SS6.p4.3.m3.1.1.3.5">𝑡</ci><ci id="S2.SS6.p4.3.m3.1.1.3.6.cmml" xref="S2.SS6.p4.3.m3.1.1.3.6">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p4.3.m3.1c">\mathcal{L}_{multi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p4.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Therefore, the final loss is presented in Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S2.E27" title="In 2.6. Loss Function ‣ ethodology ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">27</span></a>, where the constants <math alttext="\gamma" class="ltx_Math" display="inline" id="S2.SS6.p4.4.m4.1"><semantics id="S2.SS6.p4.4.m4.1a"><mi id="S2.SS6.p4.4.m4.1.1" xref="S2.SS6.p4.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p4.4.m4.1b"><ci id="S2.SS6.p4.4.m4.1.1.cmml" xref="S2.SS6.p4.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p4.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p4.4.m4.1d">italic_γ</annotation></semantics></math> adapt the contrastive loss’s influence and <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS6.p4.5.m5.1"><semantics id="S2.SS6.p4.5.m5.1a"><mi id="S2.SS6.p4.5.m5.1.1" xref="S2.SS6.p4.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p4.5.m5.1b"><ci id="S2.SS6.p4.5.m5.1.1.cmml" xref="S2.SS6.p4.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p4.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p4.5.m5.1d">italic_λ</annotation></semantics></math> is for the multi-label hinge loss. In optimization, the Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib17" title="">2014</a>)</cite> is employed.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E27">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(27)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{BCE}+\gamma\mathcal{L}_{I}+\lambda\mathcal{L}_{multi}" class="ltx_Math" display="block" id="S2.E27.m1.1"><semantics id="S2.E27.m1.1a"><mrow id="S2.E27.m1.1.1" xref="S2.E27.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E27.m1.1.1.2" xref="S2.E27.m1.1.1.2.cmml">ℒ</mi><mo id="S2.E27.m1.1.1.1" xref="S2.E27.m1.1.1.1.cmml">=</mo><mrow id="S2.E27.m1.1.1.3" xref="S2.E27.m1.1.1.3.cmml"><msub id="S2.E27.m1.1.1.3.2" xref="S2.E27.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E27.m1.1.1.3.2.2" xref="S2.E27.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E27.m1.1.1.3.2.3" xref="S2.E27.m1.1.1.3.2.3.cmml"><mi id="S2.E27.m1.1.1.3.2.3.2" xref="S2.E27.m1.1.1.3.2.3.2.cmml">B</mi><mo id="S2.E27.m1.1.1.3.2.3.1" xref="S2.E27.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E27.m1.1.1.3.2.3.3" xref="S2.E27.m1.1.1.3.2.3.3.cmml">C</mi><mo id="S2.E27.m1.1.1.3.2.3.1a" xref="S2.E27.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E27.m1.1.1.3.2.3.4" xref="S2.E27.m1.1.1.3.2.3.4.cmml">E</mi></mrow></msub><mo id="S2.E27.m1.1.1.3.1" xref="S2.E27.m1.1.1.3.1.cmml">+</mo><mrow id="S2.E27.m1.1.1.3.3" xref="S2.E27.m1.1.1.3.3.cmml"><mi id="S2.E27.m1.1.1.3.3.2" xref="S2.E27.m1.1.1.3.3.2.cmml">γ</mi><mo id="S2.E27.m1.1.1.3.3.1" xref="S2.E27.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E27.m1.1.1.3.3.3" xref="S2.E27.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E27.m1.1.1.3.3.3.2" xref="S2.E27.m1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S2.E27.m1.1.1.3.3.3.3" xref="S2.E27.m1.1.1.3.3.3.3.cmml">I</mi></msub></mrow><mo id="S2.E27.m1.1.1.3.1a" xref="S2.E27.m1.1.1.3.1.cmml">+</mo><mrow id="S2.E27.m1.1.1.3.4" xref="S2.E27.m1.1.1.3.4.cmml"><mi id="S2.E27.m1.1.1.3.4.2" xref="S2.E27.m1.1.1.3.4.2.cmml">λ</mi><mo id="S2.E27.m1.1.1.3.4.1" xref="S2.E27.m1.1.1.3.4.1.cmml">⁢</mo><msub id="S2.E27.m1.1.1.3.4.3" xref="S2.E27.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E27.m1.1.1.3.4.3.2" xref="S2.E27.m1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S2.E27.m1.1.1.3.4.3.3" xref="S2.E27.m1.1.1.3.4.3.3.cmml"><mi id="S2.E27.m1.1.1.3.4.3.3.2" xref="S2.E27.m1.1.1.3.4.3.3.2.cmml">m</mi><mo id="S2.E27.m1.1.1.3.4.3.3.1" xref="S2.E27.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S2.E27.m1.1.1.3.4.3.3.3" xref="S2.E27.m1.1.1.3.4.3.3.3.cmml">u</mi><mo id="S2.E27.m1.1.1.3.4.3.3.1a" xref="S2.E27.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S2.E27.m1.1.1.3.4.3.3.4" xref="S2.E27.m1.1.1.3.4.3.3.4.cmml">l</mi><mo id="S2.E27.m1.1.1.3.4.3.3.1b" xref="S2.E27.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S2.E27.m1.1.1.3.4.3.3.5" xref="S2.E27.m1.1.1.3.4.3.3.5.cmml">t</mi><mo id="S2.E27.m1.1.1.3.4.3.3.1c" xref="S2.E27.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S2.E27.m1.1.1.3.4.3.3.6" xref="S2.E27.m1.1.1.3.4.3.3.6.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E27.m1.1b"><apply id="S2.E27.m1.1.1.cmml" xref="S2.E27.m1.1.1"><eq id="S2.E27.m1.1.1.1.cmml" xref="S2.E27.m1.1.1.1"></eq><ci id="S2.E27.m1.1.1.2.cmml" xref="S2.E27.m1.1.1.2">ℒ</ci><apply id="S2.E27.m1.1.1.3.cmml" xref="S2.E27.m1.1.1.3"><plus id="S2.E27.m1.1.1.3.1.cmml" xref="S2.E27.m1.1.1.3.1"></plus><apply id="S2.E27.m1.1.1.3.2.cmml" xref="S2.E27.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E27.m1.1.1.3.2.1.cmml" xref="S2.E27.m1.1.1.3.2">subscript</csymbol><ci id="S2.E27.m1.1.1.3.2.2.cmml" xref="S2.E27.m1.1.1.3.2.2">ℒ</ci><apply id="S2.E27.m1.1.1.3.2.3.cmml" xref="S2.E27.m1.1.1.3.2.3"><times id="S2.E27.m1.1.1.3.2.3.1.cmml" xref="S2.E27.m1.1.1.3.2.3.1"></times><ci id="S2.E27.m1.1.1.3.2.3.2.cmml" xref="S2.E27.m1.1.1.3.2.3.2">𝐵</ci><ci id="S2.E27.m1.1.1.3.2.3.3.cmml" xref="S2.E27.m1.1.1.3.2.3.3">𝐶</ci><ci id="S2.E27.m1.1.1.3.2.3.4.cmml" xref="S2.E27.m1.1.1.3.2.3.4">𝐸</ci></apply></apply><apply id="S2.E27.m1.1.1.3.3.cmml" xref="S2.E27.m1.1.1.3.3"><times id="S2.E27.m1.1.1.3.3.1.cmml" xref="S2.E27.m1.1.1.3.3.1"></times><ci id="S2.E27.m1.1.1.3.3.2.cmml" xref="S2.E27.m1.1.1.3.3.2">𝛾</ci><apply id="S2.E27.m1.1.1.3.3.3.cmml" xref="S2.E27.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E27.m1.1.1.3.3.3.1.cmml" xref="S2.E27.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.E27.m1.1.1.3.3.3.2.cmml" xref="S2.E27.m1.1.1.3.3.3.2">ℒ</ci><ci id="S2.E27.m1.1.1.3.3.3.3.cmml" xref="S2.E27.m1.1.1.3.3.3.3">𝐼</ci></apply></apply><apply id="S2.E27.m1.1.1.3.4.cmml" xref="S2.E27.m1.1.1.3.4"><times id="S2.E27.m1.1.1.3.4.1.cmml" xref="S2.E27.m1.1.1.3.4.1"></times><ci id="S2.E27.m1.1.1.3.4.2.cmml" xref="S2.E27.m1.1.1.3.4.2">𝜆</ci><apply id="S2.E27.m1.1.1.3.4.3.cmml" xref="S2.E27.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E27.m1.1.1.3.4.3.1.cmml" xref="S2.E27.m1.1.1.3.4.3">subscript</csymbol><ci id="S2.E27.m1.1.1.3.4.3.2.cmml" xref="S2.E27.m1.1.1.3.4.3.2">ℒ</ci><apply id="S2.E27.m1.1.1.3.4.3.3.cmml" xref="S2.E27.m1.1.1.3.4.3.3"><times id="S2.E27.m1.1.1.3.4.3.3.1.cmml" xref="S2.E27.m1.1.1.3.4.3.3.1"></times><ci id="S2.E27.m1.1.1.3.4.3.3.2.cmml" xref="S2.E27.m1.1.1.3.4.3.3.2">𝑚</ci><ci id="S2.E27.m1.1.1.3.4.3.3.3.cmml" xref="S2.E27.m1.1.1.3.4.3.3.3">𝑢</ci><ci id="S2.E27.m1.1.1.3.4.3.3.4.cmml" xref="S2.E27.m1.1.1.3.4.3.3.4">𝑙</ci><ci id="S2.E27.m1.1.1.3.4.3.3.5.cmml" xref="S2.E27.m1.1.1.3.4.3.3.5">𝑡</ci><ci id="S2.E27.m1.1.1.3.4.3.3.6.cmml" xref="S2.E27.m1.1.1.3.4.3.3.6">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E27.m1.1c">\mathcal{L}=\mathcal{L}_{BCE}+\gamma\mathcal{L}_{I}+\lambda\mathcal{L}_{multi}</annotation><annotation encoding="application/x-llamapun" id="S2.E27.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT italic_B italic_C italic_E end_POSTSUBSCRIPT + italic_γ caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT + italic_λ caligraphic_L start_POSTSUBSCRIPT italic_m italic_u italic_l italic_t italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:144%;">   valuation</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Datasets</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In this research, two real-world datasets are utilized for the prescription recommendation task:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2"><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mo id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.2.1">MIMIC-III:</span> MIMIC-III <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib14" title="">2016</a>)</cite> is an open-access database that includes health-related data linked to more than 40,000 patients who were admitted to critical care unit from 2001 to 2012. In this study, we concentrate on patients with more than one visit to suggest prescriptions for their latest visit. Our training approach involves using data from their maximum four most recent visits as input for the model, determined through experimentation.
<br class="ltx_break"/><math alttext="\bullet" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mo id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">∙</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.2.2">AKI:</span> The dataset on Acute Kidney Injury (AKI) <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib19" title="">2022</a>)</cite> contains healthcare data at the University of Kansas Medical Center (KUMC) from 2009 to 2021, and consists of over 135,000 hospitalized patients with the risk of having AKI. We include the three most recent visits for each patient where the two earlier visits are the input and the last one is the target visit for prescription recommendation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Experimental Setup</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.2">In this study, we mainly focus on recommending the prescription of the next visit (information up to visit at time <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_T</annotation></semantics></math> to predict target visit at <math alttext="T+1" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">T</mi><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><plus id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></plus><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑇</ci><cn id="S3.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">T+1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_T + 1</annotation></semantics></math>) which holds great utility for medical professionals. Therefore, we filtered out patients with only 1 visit. Generally, the AKI dataset encompasses a broader patient population by including non-ICU hospital admissions, therefore containing a significantly larger cohort.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">To reduce noise in our dataset, we employ Anatomical Therapeutic Chemical (ATC) level 3 categorization for prescriptions, and our approach involves considering only those prescriptions that are non-repetitive across all visits. Repetitive prescriptions are often necessary for chronic conditions like heart disease or diabetes, where patients may require medication for years or even decades. While these medications are proven to be effective and safe, continually recommending the same treatment at every visit doesn’t pose a significant challenge. Additionally, focusing solely on repetitive medication training may prioritize commonly used daily medications like painkillers and vitamins over less frequently prescribed but equally important drugs. This could limit the model’s ability to understand sophisticated prescription patterns. Hence, we remove repetitive prescriptions in our main experiments. Although our experiments primarily focused on non-repetitive prescriptions, we also conducted experiments with repetitive drugs for clarity and consistency with previous studies reports (Section 3.4.3).</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.10">For ARCI and baselines, we use a greedy search approach to find the best hyperparameters for a comprehensive evaluation. We randomly split the data into 80% for training and 20% for testing, and we repeat this approach 7 times and report the means and confidence intervals of results. The optimal configuration for the ARCI on MIMIC-III entails <math alttext="J" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_J</annotation></semantics></math> equals to 4, <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_τ</annotation></semantics></math> to 0.05, batch size to 128, <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_λ</annotation></semantics></math> to 0.05, <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_γ</annotation></semantics></math> to 0.2, and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_d</annotation></semantics></math> to 256. For AKI, <math alttext="J" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">J</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_J</annotation></semantics></math> set to 6, batch size to 128, <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_τ</annotation></semantics></math> to 0.05, <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_λ</annotation></semantics></math> to 0.05, <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><mi id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><ci id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">italic_γ</annotation></semantics></math> to 0.1, and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.1"><semantics id="S3.SS2.p3.10.m10.1a"><mi id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><ci id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.1d">italic_d</annotation></semantics></math> to 256.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">The statistics of the datasets are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T1" title="Table 1 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. In this project, the programming language is Python, and we utilize PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib24" title="">2019</a>)</cite> for the method architecture. Furthermore, ARCI is compatible with <span class="ltx_text ltx_font_italic" id="S3.SS2.p4.1.1">PyHealth</span> <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib37" title="">2023b</a>)</cite> framework, and we employ its baseline implementations. We release the project source code<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/aryahm1375/ARCI" title="">https://github.com/aryahm1375/ARCI</a>.</span></span></span> on GitHub.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.2.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S3.T1.3.2" style="font-size:90%;">Statistics of the datasets.</span></figcaption>
<p class="ltx_p ltx_align_center" id="S3.T1.4"><span class="ltx_text ltx_inline-block" id="S3.T1.4.1" style="font-size:90%;width:433.6pt;">
<span class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.4.1.1">
<span class="ltx_thead">
<span class="ltx_tr" id="S3.T1.4.1.1.1.1">
<span class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S3.T1.4.1.1.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.4.1.1.1.1.2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.4.1.1.1.1.2.1">MIMIC-III</span></span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.4.1.1.1.1.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.4.1.1.1.1.3.1">AKI</span></span></span>
<span class="ltx_tr" id="S3.T1.4.1.1.2.2">
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T1.4.1.1.2.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">Avg. # of drugs per visit</span>
<span class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.4.1.1.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">10.86</span>
<span class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.4.1.1.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">8.28</span></span>
</span>
<span class="ltx_tbody">
<span class="ltx_tr" id="S3.T1.4.1.1.3.1">
<span class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.1.1.3.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"># of target drugs</span>
<span class="ltx_td ltx_align_center" id="S3.T1.4.1.1.3.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">191</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.4.1.1.3.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">222</span></span>
<span class="ltx_tr" id="S3.T1.4.1.1.4.2">
<span class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.1.1.4.2.1" style="padding-left:4.0pt;padding-right:4.0pt;"># of target visits</span>
<span class="ltx_td ltx_align_center" id="S3.T1.4.1.1.4.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">10104</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.4.1.1.4.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">63940</span></span>
<span class="ltx_tr" id="S3.T1.4.1.1.5.3">
<span class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.1.1.5.3.1" style="padding-left:4.0pt;padding-right:4.0pt;"># of patients</span>
<span class="ltx_td ltx_align_center" id="S3.T1.4.1.1.5.3.2" style="padding-left:4.0pt;padding-right:4.0pt;">6442</span>
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.4.1.1.5.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">63940</span></span>
<span class="ltx_tr" id="S3.T1.4.1.1.6.4">
<span class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="S3.T1.4.1.1.6.4.1" style="padding-left:4.0pt;padding-right:4.0pt;">Avg. # of input visits</span>
<span class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.4.1.1.6.4.2" style="padding-left:4.0pt;padding-right:4.0pt;">2.52</span>
<span class="ltx_td ltx_nopad_r ltx_align_center ltx_border_b" id="S3.T1.4.1.1.6.4.3" style="padding-left:4.0pt;padding-right:4.0pt;">2</span></span>
</span>
</span>
</span><span class="ltx_text" id="S3.T1.4.2" style="font-size:90%;"></span></p>
</figure>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T2.60.1.1" style="font-size:113%;">Table 2</span>. </span><span class="ltx_text" id="S3.T2.61.2" style="font-size:113%;">Performance comparison on MIMIC-III based on ranking metrics (Hit@K and NDCG@K). The reported values include means and 95% confidence interval calculated from folds.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.56">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.5.5.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.5.5.6.1" style="font-size:80%;">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.1.1" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1" style="font-size:80%;">Hit &amp; NDCG@1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.1.1.1.1.m1.1"><semantics id="S3.T2.1.1.1.1.m1.1a"><mo id="S3.T2.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T2.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.m1.1b"><ci id="S3.T2.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.2.2" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.1" style="font-size:80%;">Hit@3<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.2.2.2.1.m1.1"><semantics id="S3.T2.2.2.2.1.m1.1a"><mo id="S3.T2.2.2.2.1.m1.1.1" stretchy="false" xref="S3.T2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.1.m1.1b"><ci id="S3.T2.2.2.2.1.m1.1.1.cmml" xref="S3.T2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.3.3" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.3.3.3.1" style="font-size:80%;">NDCG@3<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.3.3.3.1.m1.1"><semantics id="S3.T2.3.3.3.1.m1.1a"><mo id="S3.T2.3.3.3.1.m1.1.1" stretchy="false" xref="S3.T2.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.1.m1.1b"><ci id="S3.T2.3.3.3.1.m1.1.1.cmml" xref="S3.T2.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.3.3.3.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.4.4" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.4.4.4.1" style="font-size:80%;">Hit@5<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.4.4.4.1.m1.1"><semantics id="S3.T2.4.4.4.1.m1.1a"><mo id="S3.T2.4.4.4.1.m1.1.1" stretchy="false" xref="S3.T2.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.1.m1.1b"><ci id="S3.T2.4.4.4.1.m1.1.1.cmml" xref="S3.T2.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.4.4.4.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.5.5.5" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.5.5.5.1" style="font-size:80%;">NDCG@5<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T2.5.5.5.1.m1.1"><semantics id="S3.T2.5.5.5.1.m1.1a"><mo id="S3.T2.5.5.5.1.m1.1.1" stretchy="false" xref="S3.T2.5.5.5.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.5.1.m1.1b"><ci id="S3.T2.5.5.5.1.m1.1.1.cmml" xref="S3.T2.5.5.5.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.5.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T2.5.5.5.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.10.10.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.10.10.6.1" style="font-size:80%;">Dr. Agent</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.6.6.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.6.6.1.1" style="font-size:80%;">0.416 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.6.6.1.m1.1"><semantics id="S3.T2.6.6.1.m1.1a"><mo id="S3.T2.6.6.1.m1.1.1" mathsize="80%" xref="S3.T2.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.1.m1.1b"><csymbol cd="latexml" id="S3.T2.6.6.1.m1.1.1.cmml" xref="S3.T2.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.6.6.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.6.6.1.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.7.7.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.7.7.2.1" style="font-size:80%;">0.171 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.7.7.2.m1.1"><semantics id="S3.T2.7.7.2.m1.1a"><mo id="S3.T2.7.7.2.m1.1.1" mathsize="80%" xref="S3.T2.7.7.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.2.m1.1b"><csymbol cd="latexml" id="S3.T2.7.7.2.m1.1.1.cmml" xref="S3.T2.7.7.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.7.7.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.7.7.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.8.8.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.8.8.3.1" style="font-size:80%;">0.443 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.8.8.3.m1.1"><semantics id="S3.T2.8.8.3.m1.1a"><mo id="S3.T2.8.8.3.m1.1.1" mathsize="80%" xref="S3.T2.8.8.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.3.m1.1b"><csymbol cd="latexml" id="S3.T2.8.8.3.m1.1.1.cmml" xref="S3.T2.8.8.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.8.8.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.8.8.3.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.9.9.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.9.9.4.1" style="font-size:80%;">0.097 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.9.9.4.m1.1"><semantics id="S3.T2.9.9.4.m1.1a"><mo id="S3.T2.9.9.4.m1.1.1" mathsize="80%" xref="S3.T2.9.9.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.4.m1.1b"><csymbol cd="latexml" id="S3.T2.9.9.4.m1.1.1.cmml" xref="S3.T2.9.9.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.9.9.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.9.9.4.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.10.10.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.10.10.5.1" style="font-size:80%;">0.488 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.10.10.5.m1.1"><semantics id="S3.T2.10.10.5.m1.1a"><mo id="S3.T2.10.10.5.m1.1.1" mathsize="80%" xref="S3.T2.10.10.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.5.m1.1b"><csymbol cd="latexml" id="S3.T2.10.10.5.m1.1.1.cmml" xref="S3.T2.10.10.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.10.10.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.10.10.5.2" style="font-size:80%;"> 0.003</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.15.15.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.15.15.6.1" style="font-size:80%;">Retain</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.11.11.1" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.11.11.1.1" style="font-size:80%;">0.459 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.11.11.1.1.m1.1"><semantics id="S3.T2.11.11.1.1.m1.1a"><mo id="S3.T2.11.11.1.1.m1.1.1" xref="S3.T2.11.11.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.11.11.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.11.11.1.1.m1.1.1.cmml" xref="S3.T2.11.11.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.11.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.11.11.1.1.m1.1d">±</annotation></semantics></math> 0.009</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.12.12.2" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.12.12.2.1" style="font-size:80%;">0.194 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.12.12.2.1.m1.1"><semantics id="S3.T2.12.12.2.1.m1.1a"><mo id="S3.T2.12.12.2.1.m1.1.1" xref="S3.T2.12.12.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.12.12.2.1.m1.1b"><csymbol cd="latexml" id="S3.T2.12.12.2.1.m1.1.1.cmml" xref="S3.T2.12.12.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.12.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.12.12.2.1.m1.1d">±</annotation></semantics></math> 0.006</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.13.13.3" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.13.13.3.1" style="font-size:80%;">0.493 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.13.13.3.1.m1.1"><semantics id="S3.T2.13.13.3.1.m1.1a"><mo id="S3.T2.13.13.3.1.m1.1.1" xref="S3.T2.13.13.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.13.13.3.1.m1.1b"><csymbol cd="latexml" id="S3.T2.13.13.3.1.m1.1.1.cmml" xref="S3.T2.13.13.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.13.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.13.13.3.1.m1.1d">±</annotation></semantics></math> 0.006</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.14.14.4" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.14.14.4.1" style="font-size:80%;">0.112 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.14.14.4.1.m1.1"><semantics id="S3.T2.14.14.4.1.m1.1a"><mo id="S3.T2.14.14.4.1.m1.1.1" xref="S3.T2.14.14.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.14.14.4.1.m1.1b"><csymbol cd="latexml" id="S3.T2.14.14.4.1.m1.1.1.cmml" xref="S3.T2.14.14.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.14.14.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.14.14.4.1.m1.1d">±</annotation></semantics></math> 0.005</span></td>
<td class="ltx_td ltx_align_center" id="S3.T2.15.15.5" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.15.15.5.1" style="font-size:80%;">0.534 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.15.15.5.1.m1.1"><semantics id="S3.T2.15.15.5.1.m1.1a"><mo id="S3.T2.15.15.5.1.m1.1.1" xref="S3.T2.15.15.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.15.15.5.1.m1.1b"><csymbol cd="latexml" id="S3.T2.15.15.5.1.m1.1.1.cmml" xref="S3.T2.15.15.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.15.15.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.15.15.5.1.m1.1d">±</annotation></semantics></math> 0.005</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.20.20.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.20.20.6.1" style="font-size:80%;">Micron</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.16.16.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.16.16.1.1" style="font-size:80%;">0.333 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.16.16.1.m1.1"><semantics id="S3.T2.16.16.1.m1.1a"><mo id="S3.T2.16.16.1.m1.1.1" mathsize="80%" xref="S3.T2.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.16.16.1.m1.1b"><csymbol cd="latexml" id="S3.T2.16.16.1.m1.1.1.cmml" xref="S3.T2.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.16.16.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.16.16.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.16.16.1.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.17.17.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.17.17.2.1" style="font-size:80%;">0.123 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.17.17.2.m1.1"><semantics id="S3.T2.17.17.2.m1.1a"><mo id="S3.T2.17.17.2.m1.1.1" mathsize="80%" xref="S3.T2.17.17.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.17.17.2.m1.1b"><csymbol cd="latexml" id="S3.T2.17.17.2.m1.1.1.cmml" xref="S3.T2.17.17.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.17.17.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.17.17.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.17.17.2.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.18.18.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.18.18.3.1" style="font-size:80%;">0.365 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.18.18.3.m1.1"><semantics id="S3.T2.18.18.3.m1.1a"><mo id="S3.T2.18.18.3.m1.1.1" mathsize="80%" xref="S3.T2.18.18.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.18.18.3.m1.1b"><csymbol cd="latexml" id="S3.T2.18.18.3.m1.1.1.cmml" xref="S3.T2.18.18.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.18.18.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.18.18.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.18.18.3.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.19.19.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.19.19.4.1" style="font-size:80%;">0.062 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.19.19.4.m1.1"><semantics id="S3.T2.19.19.4.m1.1a"><mo id="S3.T2.19.19.4.m1.1.1" mathsize="80%" xref="S3.T2.19.19.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.19.19.4.m1.1b"><csymbol cd="latexml" id="S3.T2.19.19.4.m1.1.1.cmml" xref="S3.T2.19.19.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.19.19.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.19.19.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.19.19.4.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.20.20.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.20.20.5.1" style="font-size:80%;">0.410 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.20.20.5.m1.1"><semantics id="S3.T2.20.20.5.m1.1a"><mo id="S3.T2.20.20.5.m1.1.1" mathsize="80%" xref="S3.T2.20.20.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.20.20.5.m1.1b"><csymbol cd="latexml" id="S3.T2.20.20.5.m1.1.1.cmml" xref="S3.T2.20.20.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.20.20.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.20.20.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.20.20.5.2" style="font-size:80%;"> 0.004</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.25.25">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.25.25.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.25.25.6.1" style="font-size:80%;">SafeDrug</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.21.21.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.21.21.1.1" style="font-size:80%;">0.350 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.21.21.1.m1.1"><semantics id="S3.T2.21.21.1.m1.1a"><mo id="S3.T2.21.21.1.m1.1.1" mathsize="80%" xref="S3.T2.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.21.21.1.m1.1b"><csymbol cd="latexml" id="S3.T2.21.21.1.m1.1.1.cmml" xref="S3.T2.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.21.21.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.21.21.1.2" style="font-size:80%;"> 0.014</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.22.22.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.22.22.2.1" style="font-size:80%;">0.130 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.22.22.2.m1.1"><semantics id="S3.T2.22.22.2.m1.1a"><mo id="S3.T2.22.22.2.m1.1.1" mathsize="80%" xref="S3.T2.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.22.22.2.m1.1b"><csymbol cd="latexml" id="S3.T2.22.22.2.m1.1.1.cmml" xref="S3.T2.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.22.22.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.22.22.2.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.23.23.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.23.23.3.1" style="font-size:80%;">0.377 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.23.23.3.m1.1"><semantics id="S3.T2.23.23.3.m1.1a"><mo id="S3.T2.23.23.3.m1.1.1" mathsize="80%" xref="S3.T2.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.23.23.3.m1.1b"><csymbol cd="latexml" id="S3.T2.23.23.3.m1.1.1.cmml" xref="S3.T2.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.23.23.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.23.23.3.2" style="font-size:80%;"> 0.012</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.24.24.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.24.24.4.1" style="font-size:80%;">0.059 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.24.24.4.m1.1"><semantics id="S3.T2.24.24.4.m1.1a"><mo id="S3.T2.24.24.4.m1.1.1" mathsize="80%" xref="S3.T2.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.24.24.4.m1.1b"><csymbol cd="latexml" id="S3.T2.24.24.4.m1.1.1.cmml" xref="S3.T2.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.24.24.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.24.24.4.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.25.25.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.25.25.5.1" style="font-size:80%;">0.411 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.25.25.5.m1.1"><semantics id="S3.T2.25.25.5.m1.1a"><mo id="S3.T2.25.25.5.m1.1.1" mathsize="80%" xref="S3.T2.25.25.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.25.25.5.m1.1b"><csymbol cd="latexml" id="S3.T2.25.25.5.m1.1.1.cmml" xref="S3.T2.25.25.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.25.25.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.25.25.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.25.25.5.2" style="font-size:80%;"> 0.012</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.30.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.30.30.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.30.30.6.1" style="font-size:80%;">MoleRec</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.26.26.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.26.26.1.1" style="font-size:80%;">0.336 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.26.26.1.m1.1"><semantics id="S3.T2.26.26.1.m1.1a"><mo id="S3.T2.26.26.1.m1.1.1" mathsize="80%" xref="S3.T2.26.26.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.26.26.1.m1.1b"><csymbol cd="latexml" id="S3.T2.26.26.1.m1.1.1.cmml" xref="S3.T2.26.26.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.26.26.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.26.26.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.26.26.1.2" style="font-size:80%;"> 0.017</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.27.27.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.27.27.2.1" style="font-size:80%;">0.122 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.27.27.2.m1.1"><semantics id="S3.T2.27.27.2.m1.1a"><mo id="S3.T2.27.27.2.m1.1.1" mathsize="80%" xref="S3.T2.27.27.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.27.27.2.m1.1b"><csymbol cd="latexml" id="S3.T2.27.27.2.m1.1.1.cmml" xref="S3.T2.27.27.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.27.27.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.27.27.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.27.27.2.2" style="font-size:80%;"> 0.012</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.28.28.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.28.28.3.1" style="font-size:80%;">0.369 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.28.28.3.m1.1"><semantics id="S3.T2.28.28.3.m1.1a"><mo id="S3.T2.28.28.3.m1.1.1" mathsize="80%" xref="S3.T2.28.28.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.28.28.3.m1.1b"><csymbol cd="latexml" id="S3.T2.28.28.3.m1.1.1.cmml" xref="S3.T2.28.28.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.28.28.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.28.28.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.28.28.3.2" style="font-size:80%;"> 0.015</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.29.29.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.29.29.4.1" style="font-size:80%;">0.067 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.29.29.4.m1.1"><semantics id="S3.T2.29.29.4.m1.1a"><mo id="S3.T2.29.29.4.m1.1.1" mathsize="80%" xref="S3.T2.29.29.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.29.29.4.m1.1b"><csymbol cd="latexml" id="S3.T2.29.29.4.m1.1.1.cmml" xref="S3.T2.29.29.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.29.29.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.29.29.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.29.29.4.2" style="font-size:80%;"> 0.006</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.30.30.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.30.30.5.1" style="font-size:80%;">0.414 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.30.30.5.m1.1"><semantics id="S3.T2.30.30.5.m1.1a"><mo id="S3.T2.30.30.5.m1.1.1" mathsize="80%" xref="S3.T2.30.30.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.30.30.5.m1.1b"><csymbol cd="latexml" id="S3.T2.30.30.5.m1.1.1.cmml" xref="S3.T2.30.30.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.30.30.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.30.30.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.30.30.5.2" style="font-size:80%;"> 0.014</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.35.35">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.35.35.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.35.35.6.1" style="font-size:80%;">GAMENet</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.31.31.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.31.31.1.1" style="font-size:80%;">0.409 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.31.31.1.m1.1"><semantics id="S3.T2.31.31.1.m1.1a"><mo id="S3.T2.31.31.1.m1.1.1" mathsize="80%" xref="S3.T2.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.31.31.1.m1.1b"><csymbol cd="latexml" id="S3.T2.31.31.1.m1.1.1.cmml" xref="S3.T2.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.31.31.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.31.31.1.2" style="font-size:80%;"> 0.009</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.32.32.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.32.32.2.1" style="font-size:80%;">0.164 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.32.32.2.m1.1"><semantics id="S3.T2.32.32.2.m1.1a"><mo id="S3.T2.32.32.2.m1.1.1" mathsize="80%" xref="S3.T2.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.32.32.2.m1.1b"><csymbol cd="latexml" id="S3.T2.32.32.2.m1.1.1.cmml" xref="S3.T2.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.32.32.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.32.32.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.32.32.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.33.33.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.33.33.3.1" style="font-size:80%;">0.441 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.33.33.3.m1.1"><semantics id="S3.T2.33.33.3.m1.1a"><mo id="S3.T2.33.33.3.m1.1.1" mathsize="80%" xref="S3.T2.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.33.33.3.m1.1b"><csymbol cd="latexml" id="S3.T2.33.33.3.m1.1.1.cmml" xref="S3.T2.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.33.33.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.33.33.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.33.33.3.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.34.34.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.34.34.4.1" style="font-size:80%;">0.089 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.34.34.4.m1.1"><semantics id="S3.T2.34.34.4.m1.1a"><mo id="S3.T2.34.34.4.m1.1.1" mathsize="80%" xref="S3.T2.34.34.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.34.34.4.m1.1b"><csymbol cd="latexml" id="S3.T2.34.34.4.m1.1.1.cmml" xref="S3.T2.34.34.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.34.34.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.34.34.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.34.34.4.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.35.35.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.35.35.5.1" style="font-size:80%;">0.484 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.35.35.5.m1.1"><semantics id="S3.T2.35.35.5.m1.1a"><mo id="S3.T2.35.35.5.m1.1.1" mathsize="80%" xref="S3.T2.35.35.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.35.35.5.m1.1b"><csymbol cd="latexml" id="S3.T2.35.35.5.m1.1.1.cmml" xref="S3.T2.35.35.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.35.35.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.35.35.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.35.35.5.2" style="font-size:80%;"> 0.005</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.40.40">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.40.40.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.40.40.6.1" style="font-size:80%;">Transformer</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.36.36.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.36.36.1.1" style="font-size:80%;">0.416 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.36.36.1.m1.1"><semantics id="S3.T2.36.36.1.m1.1a"><mo id="S3.T2.36.36.1.m1.1.1" mathsize="80%" xref="S3.T2.36.36.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.36.36.1.m1.1b"><csymbol cd="latexml" id="S3.T2.36.36.1.m1.1.1.cmml" xref="S3.T2.36.36.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.36.36.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.36.36.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.36.36.1.2" style="font-size:80%;"> 0.010</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.37.37.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.37.37.2.1" style="font-size:80%;">0.172 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.37.37.2.m1.1"><semantics id="S3.T2.37.37.2.m1.1a"><mo id="S3.T2.37.37.2.m1.1.1" mathsize="80%" xref="S3.T2.37.37.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.37.37.2.m1.1b"><csymbol cd="latexml" id="S3.T2.37.37.2.m1.1.1.cmml" xref="S3.T2.37.37.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.37.37.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.37.37.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.37.37.2.2" style="font-size:80%;"> 0.009</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.38.38.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.38.38.3.1" style="font-size:80%;">0.448 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.38.38.3.m1.1"><semantics id="S3.T2.38.38.3.m1.1a"><mo id="S3.T2.38.38.3.m1.1.1" mathsize="80%" xref="S3.T2.38.38.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.38.38.3.m1.1b"><csymbol cd="latexml" id="S3.T2.38.38.3.m1.1.1.cmml" xref="S3.T2.38.38.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.38.38.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.38.38.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.38.38.3.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.39.39.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.39.39.4.1" style="font-size:80%;">0.099 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.39.39.4.m1.1"><semantics id="S3.T2.39.39.4.m1.1a"><mo id="S3.T2.39.39.4.m1.1.1" mathsize="80%" xref="S3.T2.39.39.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.39.39.4.m1.1b"><csymbol cd="latexml" id="S3.T2.39.39.4.m1.1.1.cmml" xref="S3.T2.39.39.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.39.39.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.39.39.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.39.39.4.2" style="font-size:80%;"> 0.006</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.40.40.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.40.40.5.1" style="font-size:80%;">0.493 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.40.40.5.m1.1"><semantics id="S3.T2.40.40.5.m1.1a"><mo id="S3.T2.40.40.5.m1.1.1" mathsize="80%" xref="S3.T2.40.40.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.40.40.5.m1.1b"><csymbol cd="latexml" id="S3.T2.40.40.5.m1.1.1.cmml" xref="S3.T2.40.40.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.40.40.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.40.40.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.40.40.5.2" style="font-size:80%;"> 0.007</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.45.45">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.45.45.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.45.45.6.1" style="font-size:80%;">ARCI w/o intent</span></th>
<td class="ltx_td ltx_align_center" id="S3.T2.41.41.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.41.41.1.1" style="font-size:80%;">0.462 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.41.41.1.m1.1"><semantics id="S3.T2.41.41.1.m1.1a"><mo id="S3.T2.41.41.1.m1.1.1" mathsize="80%" xref="S3.T2.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.41.41.1.m1.1b"><csymbol cd="latexml" id="S3.T2.41.41.1.m1.1.1.cmml" xref="S3.T2.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.41.41.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.41.41.1.2" style="font-size:80%;"> 0.011</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.42.42.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.42.42.2.1" style="font-size:80%;">0.196 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.42.42.2.m1.1"><semantics id="S3.T2.42.42.2.m1.1a"><mo id="S3.T2.42.42.2.m1.1.1" mathsize="80%" xref="S3.T2.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.42.42.2.m1.1b"><csymbol cd="latexml" id="S3.T2.42.42.2.m1.1.1.cmml" xref="S3.T2.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.42.42.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.42.42.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.43.43.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.43.43.3.1" style="font-size:80%;">0.489 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.43.43.3.m1.1"><semantics id="S3.T2.43.43.3.m1.1a"><mo id="S3.T2.43.43.3.m1.1.1" mathsize="80%" xref="S3.T2.43.43.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.43.43.3.m1.1b"><csymbol cd="latexml" id="S3.T2.43.43.3.m1.1.1.cmml" xref="S3.T2.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.43.43.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.43.43.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.43.43.3.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.44.44.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.44.44.4.1" style="font-size:80%;">0.117 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.44.44.4.m1.1"><semantics id="S3.T2.44.44.4.m1.1a"><mo id="S3.T2.44.44.4.m1.1.1" mathsize="80%" xref="S3.T2.44.44.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.44.44.4.m1.1b"><csymbol cd="latexml" id="S3.T2.44.44.4.m1.1.1.cmml" xref="S3.T2.44.44.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.44.44.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.44.44.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.44.44.4.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.45.45.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.45.45.5.1" style="font-size:80%;">0.532 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.45.45.5.m1.1"><semantics id="S3.T2.45.45.5.m1.1a"><mo id="S3.T2.45.45.5.m1.1.1" mathsize="80%" xref="S3.T2.45.45.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.45.45.5.m1.1b"><csymbol cd="latexml" id="S3.T2.45.45.5.m1.1.1.cmml" xref="S3.T2.45.45.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.45.45.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.45.45.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.45.45.5.2" style="font-size:80%;"> 0.004</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.51.51">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T2.46.46.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.46.46.1.1" style="font-size:80%;">ARCI w intent w/o</span><span class="ltx_text" id="S3.T2.46.46.1.2" style="font-size:80%;"> </span><math alttext="\mathbf{\mathcal{L}}_{I}" class="ltx_Math" display="inline" id="S3.T2.46.46.1.m1.1"><semantics id="S3.T2.46.46.1.m1.1a"><msub id="S3.T2.46.46.1.m1.1.1" xref="S3.T2.46.46.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T2.46.46.1.m1.1.1.2" mathsize="80%" xref="S3.T2.46.46.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.T2.46.46.1.m1.1.1.3" mathsize="80%" xref="S3.T2.46.46.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T2.46.46.1.m1.1b"><apply id="S3.T2.46.46.1.m1.1.1.cmml" xref="S3.T2.46.46.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.46.46.1.m1.1.1.1.cmml" xref="S3.T2.46.46.1.m1.1.1">subscript</csymbol><ci id="S3.T2.46.46.1.m1.1.1.2.cmml" xref="S3.T2.46.46.1.m1.1.1.2">ℒ</ci><ci id="S3.T2.46.46.1.m1.1.1.3.cmml" xref="S3.T2.46.46.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.46.46.1.m1.1c">\mathbf{\mathcal{L}}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.46.46.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S3.T2.47.47.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.47.47.2.1" style="font-size:80%;">0.475 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.47.47.2.m1.1"><semantics id="S3.T2.47.47.2.m1.1a"><mo id="S3.T2.47.47.2.m1.1.1" mathsize="80%" xref="S3.T2.47.47.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.47.47.2.m1.1b"><csymbol cd="latexml" id="S3.T2.47.47.2.m1.1.1.cmml" xref="S3.T2.47.47.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.47.47.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.47.47.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.47.47.2.2" style="font-size:80%;"> 0.010</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.48.48.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.48.48.3.1" style="font-size:80%;">0.192 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.48.48.3.m1.1"><semantics id="S3.T2.48.48.3.m1.1a"><mo id="S3.T2.48.48.3.m1.1.1" mathsize="80%" xref="S3.T2.48.48.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.48.48.3.m1.1b"><csymbol cd="latexml" id="S3.T2.48.48.3.m1.1.1.cmml" xref="S3.T2.48.48.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.48.48.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.48.48.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.48.48.3.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.49.49.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.49.49.4.1" style="font-size:80%;">0.495 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.49.49.4.m1.1"><semantics id="S3.T2.49.49.4.m1.1a"><mo id="S3.T2.49.49.4.m1.1.1" mathsize="80%" xref="S3.T2.49.49.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.49.49.4.m1.1b"><csymbol cd="latexml" id="S3.T2.49.49.4.m1.1.1.cmml" xref="S3.T2.49.49.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.49.49.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.49.49.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.49.49.4.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.50.50.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.50.50.5.1" style="font-size:80%;">0.113 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.50.50.5.m1.1"><semantics id="S3.T2.50.50.5.m1.1a"><mo id="S3.T2.50.50.5.m1.1.1" mathsize="80%" xref="S3.T2.50.50.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.50.50.5.m1.1b"><csymbol cd="latexml" id="S3.T2.50.50.5.m1.1.1.cmml" xref="S3.T2.50.50.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.50.50.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.50.50.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.50.50.5.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T2.51.51.6" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T2.51.51.6.1" style="font-size:80%;">0.538 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.51.51.6.m1.1"><semantics id="S3.T2.51.51.6.m1.1a"><mo id="S3.T2.51.51.6.m1.1.1" mathsize="80%" xref="S3.T2.51.51.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.51.51.6.m1.1b"><csymbol cd="latexml" id="S3.T2.51.51.6.m1.1.1.cmml" xref="S3.T2.51.51.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.51.51.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.51.51.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T2.51.51.6.2" style="font-size:80%;"> 0.006</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.56.56">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="S3.T2.56.56.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.56.56.6.1" style="font-size:80%;">ARCI</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.52.52.1" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.52.52.1.1" style="font-size:80%;">0.491 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.52.52.1.1.m1.1"><semantics id="S3.T2.52.52.1.1.m1.1a"><mo id="S3.T2.52.52.1.1.m1.1.1" xref="S3.T2.52.52.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.52.52.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.52.52.1.1.m1.1.1.cmml" xref="S3.T2.52.52.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.52.52.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.52.52.1.1.m1.1d">±</annotation></semantics></math> 0.011</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.53.53.2" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.53.53.2.1" style="font-size:80%;">0.209 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.53.53.2.1.m1.1"><semantics id="S3.T2.53.53.2.1.m1.1a"><mo id="S3.T2.53.53.2.1.m1.1.1" xref="S3.T2.53.53.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.53.53.2.1.m1.1b"><csymbol cd="latexml" id="S3.T2.53.53.2.1.m1.1.1.cmml" xref="S3.T2.53.53.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.53.53.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.53.53.2.1.m1.1d">±</annotation></semantics></math> 0.008</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.54.54.3" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.54.54.3.1" style="font-size:80%;">0.516 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.54.54.3.1.m1.1"><semantics id="S3.T2.54.54.3.1.m1.1a"><mo id="S3.T2.54.54.3.1.m1.1.1" xref="S3.T2.54.54.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.54.54.3.1.m1.1b"><csymbol cd="latexml" id="S3.T2.54.54.3.1.m1.1.1.cmml" xref="S3.T2.54.54.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.54.54.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.54.54.3.1.m1.1d">±</annotation></semantics></math> 0.008</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.55.55.4" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.55.55.4.1" style="font-size:80%;">0.121 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.55.55.4.1.m1.1"><semantics id="S3.T2.55.55.4.1.m1.1a"><mo id="S3.T2.55.55.4.1.m1.1.1" xref="S3.T2.55.55.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.55.55.4.1.m1.1b"><csymbol cd="latexml" id="S3.T2.55.55.4.1.m1.1.1.cmml" xref="S3.T2.55.55.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.55.55.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.55.55.4.1.m1.1d">±</annotation></semantics></math> 0.010</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.56.56.5" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.56.56.5.1" style="font-size:80%;">0.556 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T2.56.56.5.1.m1.1"><semantics id="S3.T2.56.56.5.1.m1.1a"><mo id="S3.T2.56.56.5.1.m1.1.1" xref="S3.T2.56.56.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.56.56.5.1.m1.1b"><csymbol cd="latexml" id="S3.T2.56.56.5.1.m1.1.1.cmml" xref="S3.T2.56.56.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.56.56.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.56.56.5.1.m1.1d">±</annotation></semantics></math> 0.006</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T3.60.1.1" style="font-size:113%;">Table 3</span>. </span><span class="ltx_text" id="S3.T3.61.2" style="font-size:113%;">Performance comparison on AKI based on ranking metrics (Hit@K and NDCG@K). The reported values include means and 95% confidence interval calculated from folds.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T3.56">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T3.5.5.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.5.5.6.1" style="font-size:80%;">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.1.1" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1" style="font-size:80%;">Hit&amp; NDCG@1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T3.1.1.1.1.m1.1"><semantics id="S3.T3.1.1.1.1.m1.1a"><mo id="S3.T3.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T3.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.1.m1.1b"><ci id="S3.T3.1.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.2.2" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.2.2.2.1" style="font-size:80%;">Hit@3<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T3.2.2.2.1.m1.1"><semantics id="S3.T3.2.2.2.1.m1.1a"><mo id="S3.T3.2.2.2.1.m1.1.1" stretchy="false" xref="S3.T3.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.1.m1.1b"><ci id="S3.T3.2.2.2.1.m1.1.1.cmml" xref="S3.T3.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.3.3.3" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.3.3.3.1" style="font-size:80%;">NDCG@3<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T3.3.3.3.1.m1.1"><semantics id="S3.T3.3.3.3.1.m1.1a"><mo id="S3.T3.3.3.3.1.m1.1.1" stretchy="false" xref="S3.T3.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.3.1.m1.1b"><ci id="S3.T3.3.3.3.1.m1.1.1.cmml" xref="S3.T3.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.3.3.3.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.4.4" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.4.4.4.1" style="font-size:80%;">Hit@5<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T3.4.4.4.1.m1.1"><semantics id="S3.T3.4.4.4.1.m1.1a"><mo id="S3.T3.4.4.4.1.m1.1.1" stretchy="false" xref="S3.T3.4.4.4.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.4.1.m1.1b"><ci id="S3.T3.4.4.4.1.m1.1.1.cmml" xref="S3.T3.4.4.4.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.4.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.4.4.4.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.5.5.5" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.5.5.5.1" style="font-size:80%;">NDCG@5<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T3.5.5.5.1.m1.1"><semantics id="S3.T3.5.5.5.1.m1.1a"><mo id="S3.T3.5.5.5.1.m1.1.1" stretchy="false" xref="S3.T3.5.5.5.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.5.1.m1.1b"><ci id="S3.T3.5.5.5.1.m1.1.1.cmml" xref="S3.T3.5.5.5.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.5.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T3.5.5.5.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T3.10.10.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.10.10.6.1" style="font-size:80%;">Dr. Agent</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.6.6.1" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.6.6.1.1" style="font-size:80%;">0.407 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.6.6.1.1.m1.1"><semantics id="S3.T3.6.6.1.1.m1.1a"><mo id="S3.T3.6.6.1.1.m1.1.1" xref="S3.T3.6.6.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.6.6.1.1.m1.1.1.cmml" xref="S3.T3.6.6.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.6.6.1.1.m1.1d">±</annotation></semantics></math> 0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.7.7.2" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.7.7.2.1" style="font-size:80%;">0.299 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.7.7.2.1.m1.1"><semantics id="S3.T3.7.7.2.1.m1.1a"><mo id="S3.T3.7.7.2.1.m1.1.1" xref="S3.T3.7.7.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.2.1.m1.1b"><csymbol cd="latexml" id="S3.T3.7.7.2.1.m1.1.1.cmml" xref="S3.T3.7.7.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.7.7.2.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.8.8.3" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.8.8.3.1" style="font-size:80%;">0.551 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.8.8.3.1.m1.1"><semantics id="S3.T3.8.8.3.1.m1.1a"><mo id="S3.T3.8.8.3.1.m1.1.1" xref="S3.T3.8.8.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.3.1.m1.1b"><csymbol cd="latexml" id="S3.T3.8.8.3.1.m1.1.1.cmml" xref="S3.T3.8.8.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.8.8.3.1.m1.1d">±</annotation></semantics></math> 0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.9.9.4" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.9.9.4.1" style="font-size:80%;">0.218 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.9.9.4.1.m1.1"><semantics id="S3.T3.9.9.4.1.m1.1a"><mo id="S3.T3.9.9.4.1.m1.1.1" xref="S3.T3.9.9.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.9.9.4.1.m1.1b"><csymbol cd="latexml" id="S3.T3.9.9.4.1.m1.1.1.cmml" xref="S3.T3.9.9.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.9.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.9.9.4.1.m1.1d">±</annotation></semantics></math> 0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.10.10.5" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.10.10.5.1" style="font-size:80%;">0.608 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.10.10.5.1.m1.1"><semantics id="S3.T3.10.10.5.1.m1.1a"><mo id="S3.T3.10.10.5.1.m1.1.1" xref="S3.T3.10.10.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.10.10.5.1.m1.1b"><csymbol cd="latexml" id="S3.T3.10.10.5.1.m1.1.1.cmml" xref="S3.T3.10.10.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.10.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.10.10.5.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T3.15.15.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.15.15.6.1" style="font-size:80%;">Retain</span></th>
<td class="ltx_td ltx_align_center" id="S3.T3.11.11.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.11.11.1.1" style="font-size:80%;">0.398 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.11.11.1.m1.1"><semantics id="S3.T3.11.11.1.m1.1a"><mo id="S3.T3.11.11.1.m1.1.1" mathsize="80%" xref="S3.T3.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.11.11.1.m1.1b"><csymbol cd="latexml" id="S3.T3.11.11.1.m1.1.1.cmml" xref="S3.T3.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.11.11.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.11.11.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.11.11.1.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.12.12.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.12.12.2.1" style="font-size:80%;">0.294 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.12.12.2.m1.1"><semantics id="S3.T3.12.12.2.m1.1a"><mo id="S3.T3.12.12.2.m1.1.1" mathsize="80%" xref="S3.T3.12.12.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.12.12.2.m1.1b"><csymbol cd="latexml" id="S3.T3.12.12.2.m1.1.1.cmml" xref="S3.T3.12.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.12.12.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.12.12.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.12.12.2.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.13.13.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.13.13.3.1" style="font-size:80%;">0.546 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.13.13.3.m1.1"><semantics id="S3.T3.13.13.3.m1.1a"><mo id="S3.T3.13.13.3.m1.1.1" mathsize="80%" xref="S3.T3.13.13.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.13.13.3.m1.1b"><csymbol cd="latexml" id="S3.T3.13.13.3.m1.1.1.cmml" xref="S3.T3.13.13.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.13.13.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.13.13.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.13.13.3.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.14.14.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.14.14.4.1" style="font-size:80%;">0.213 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.14.14.4.m1.1"><semantics id="S3.T3.14.14.4.m1.1a"><mo id="S3.T3.14.14.4.m1.1.1" mathsize="80%" xref="S3.T3.14.14.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.14.14.4.m1.1b"><csymbol cd="latexml" id="S3.T3.14.14.4.m1.1.1.cmml" xref="S3.T3.14.14.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.14.14.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.14.14.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.14.14.4.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.15.15.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.15.15.5.1" style="font-size:80%;">0.606 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.15.15.5.m1.1"><semantics id="S3.T3.15.15.5.m1.1a"><mo id="S3.T3.15.15.5.m1.1.1" mathsize="80%" xref="S3.T3.15.15.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.15.15.5.m1.1b"><csymbol cd="latexml" id="S3.T3.15.15.5.m1.1.1.cmml" xref="S3.T3.15.15.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.15.15.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.15.15.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.15.15.5.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T3.20.20.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.20.20.6.1" style="font-size:80%;">Micron</span></th>
<td class="ltx_td ltx_align_center" id="S3.T3.16.16.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.16.16.1.1" style="font-size:80%;">0.383 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.16.16.1.m1.1"><semantics id="S3.T3.16.16.1.m1.1a"><mo id="S3.T3.16.16.1.m1.1.1" mathsize="80%" xref="S3.T3.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.16.16.1.m1.1b"><csymbol cd="latexml" id="S3.T3.16.16.1.m1.1.1.cmml" xref="S3.T3.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.16.16.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.16.16.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.16.16.1.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.17.17.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.17.17.2.1" style="font-size:80%;">0.263 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.17.17.2.m1.1"><semantics id="S3.T3.17.17.2.m1.1a"><mo id="S3.T3.17.17.2.m1.1.1" mathsize="80%" xref="S3.T3.17.17.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.17.17.2.m1.1b"><csymbol cd="latexml" id="S3.T3.17.17.2.m1.1.1.cmml" xref="S3.T3.17.17.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.17.17.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.17.17.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.17.17.2.2" style="font-size:80%;"> 0.010</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.18.18.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.18.18.3.1" style="font-size:80%;">0.526 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.18.18.3.m1.1"><semantics id="S3.T3.18.18.3.m1.1a"><mo id="S3.T3.18.18.3.m1.1.1" mathsize="80%" xref="S3.T3.18.18.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.18.18.3.m1.1b"><csymbol cd="latexml" id="S3.T3.18.18.3.m1.1.1.cmml" xref="S3.T3.18.18.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.18.18.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.18.18.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.18.18.3.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.19.19.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.19.19.4.1" style="font-size:80%;">0.182 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.19.19.4.m1.1"><semantics id="S3.T3.19.19.4.m1.1a"><mo id="S3.T3.19.19.4.m1.1.1" mathsize="80%" xref="S3.T3.19.19.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.19.19.4.m1.1b"><csymbol cd="latexml" id="S3.T3.19.19.4.m1.1.1.cmml" xref="S3.T3.19.19.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.19.19.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.19.19.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.19.19.4.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.20.20.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.20.20.5.1" style="font-size:80%;">0.587 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.20.20.5.m1.1"><semantics id="S3.T3.20.20.5.m1.1a"><mo id="S3.T3.20.20.5.m1.1.1" mathsize="80%" xref="S3.T3.20.20.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.20.20.5.m1.1b"><csymbol cd="latexml" id="S3.T3.20.20.5.m1.1.1.cmml" xref="S3.T3.20.20.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.20.20.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.20.20.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.20.20.5.2" style="font-size:80%;"> 0.005</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.25.25">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T3.25.25.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.25.25.6.1" style="font-size:80%;">SafeDrug</span></th>
<td class="ltx_td ltx_align_center" id="S3.T3.21.21.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.21.21.1.1" style="font-size:80%;">0.396 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.21.21.1.m1.1"><semantics id="S3.T3.21.21.1.m1.1a"><mo id="S3.T3.21.21.1.m1.1.1" mathsize="80%" xref="S3.T3.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.21.21.1.m1.1b"><csymbol cd="latexml" id="S3.T3.21.21.1.m1.1.1.cmml" xref="S3.T3.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.21.21.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.21.21.1.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.22.22.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.22.22.2.1" style="font-size:80%;">0.277 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.22.22.2.m1.1"><semantics id="S3.T3.22.22.2.m1.1a"><mo id="S3.T3.22.22.2.m1.1.1" mathsize="80%" xref="S3.T3.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.22.22.2.m1.1b"><csymbol cd="latexml" id="S3.T3.22.22.2.m1.1.1.cmml" xref="S3.T3.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.22.22.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.22.22.2.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.23.23.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.23.23.3.1" style="font-size:80%;">0.535 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.23.23.3.m1.1"><semantics id="S3.T3.23.23.3.m1.1a"><mo id="S3.T3.23.23.3.m1.1.1" mathsize="80%" xref="S3.T3.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.23.23.3.m1.1b"><csymbol cd="latexml" id="S3.T3.23.23.3.m1.1.1.cmml" xref="S3.T3.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.23.23.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.23.23.3.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.24.24.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.24.24.4.1" style="font-size:80%;">0.198 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.24.24.4.m1.1"><semantics id="S3.T3.24.24.4.m1.1a"><mo id="S3.T3.24.24.4.m1.1.1" mathsize="80%" xref="S3.T3.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.24.24.4.m1.1b"><csymbol cd="latexml" id="S3.T3.24.24.4.m1.1.1.cmml" xref="S3.T3.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.24.24.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.24.24.4.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.25.25.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.25.25.5.1" style="font-size:80%;">0.590 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.25.25.5.m1.1"><semantics id="S3.T3.25.25.5.m1.1a"><mo id="S3.T3.25.25.5.m1.1.1" mathsize="80%" xref="S3.T3.25.25.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.25.25.5.m1.1b"><csymbol cd="latexml" id="S3.T3.25.25.5.m1.1.1.cmml" xref="S3.T3.25.25.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.25.25.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.25.25.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.25.25.5.2" style="font-size:80%;"> 0.005</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.30.30">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T3.30.30.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.30.30.6.1" style="font-size:80%;">MoleRec</span></th>
<td class="ltx_td ltx_align_center" id="S3.T3.26.26.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.26.26.1.1" style="font-size:80%;">0.380 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.26.26.1.m1.1"><semantics id="S3.T3.26.26.1.m1.1a"><mo id="S3.T3.26.26.1.m1.1.1" mathsize="80%" xref="S3.T3.26.26.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.26.26.1.m1.1b"><csymbol cd="latexml" id="S3.T3.26.26.1.m1.1.1.cmml" xref="S3.T3.26.26.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.26.26.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.26.26.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.26.26.1.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.27.27.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.27.27.2.1" style="font-size:80%;">0.261 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.27.27.2.m1.1"><semantics id="S3.T3.27.27.2.m1.1a"><mo id="S3.T3.27.27.2.m1.1.1" mathsize="80%" xref="S3.T3.27.27.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.27.27.2.m1.1b"><csymbol cd="latexml" id="S3.T3.27.27.2.m1.1.1.cmml" xref="S3.T3.27.27.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.27.27.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.27.27.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.27.27.2.2" style="font-size:80%;"> 0.010</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.28.28.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.28.28.3.1" style="font-size:80%;">0.525 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.28.28.3.m1.1"><semantics id="S3.T3.28.28.3.m1.1a"><mo id="S3.T3.28.28.3.m1.1.1" mathsize="80%" xref="S3.T3.28.28.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.28.28.3.m1.1b"><csymbol cd="latexml" id="S3.T3.28.28.3.m1.1.1.cmml" xref="S3.T3.28.28.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.28.28.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.28.28.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.28.28.3.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.29.29.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.29.29.4.1" style="font-size:80%;">0.183 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.29.29.4.m1.1"><semantics id="S3.T3.29.29.4.m1.1a"><mo id="S3.T3.29.29.4.m1.1.1" mathsize="80%" xref="S3.T3.29.29.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.29.29.4.m1.1b"><csymbol cd="latexml" id="S3.T3.29.29.4.m1.1.1.cmml" xref="S3.T3.29.29.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.29.29.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.29.29.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.29.29.4.2" style="font-size:80%;"> 0.006</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.30.30.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.30.30.5.1" style="font-size:80%;">0.587 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.30.30.5.m1.1"><semantics id="S3.T3.30.30.5.m1.1a"><mo id="S3.T3.30.30.5.m1.1.1" mathsize="80%" xref="S3.T3.30.30.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.30.30.5.m1.1b"><csymbol cd="latexml" id="S3.T3.30.30.5.m1.1.1.cmml" xref="S3.T3.30.30.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.30.30.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.30.30.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.30.30.5.2" style="font-size:80%;"> 0.006</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.35.35">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T3.35.35.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.35.35.6.1" style="font-size:80%;">GAMENet</span></th>
<td class="ltx_td ltx_align_center" id="S3.T3.31.31.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.31.31.1.1" style="font-size:80%;">0.394 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.31.31.1.m1.1"><semantics id="S3.T3.31.31.1.m1.1a"><mo id="S3.T3.31.31.1.m1.1.1" mathsize="80%" xref="S3.T3.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.31.31.1.m1.1b"><csymbol cd="latexml" id="S3.T3.31.31.1.m1.1.1.cmml" xref="S3.T3.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.31.31.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.31.31.1.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.32.32.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.32.32.2.1" style="font-size:80%;">0.274 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.32.32.2.m1.1"><semantics id="S3.T3.32.32.2.m1.1a"><mo id="S3.T3.32.32.2.m1.1.1" mathsize="80%" xref="S3.T3.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.32.32.2.m1.1b"><csymbol cd="latexml" id="S3.T3.32.32.2.m1.1.1.cmml" xref="S3.T3.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.32.32.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.32.32.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.32.32.2.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.33.33.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.33.33.3.1" style="font-size:80%;">0.536 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.33.33.3.m1.1"><semantics id="S3.T3.33.33.3.m1.1a"><mo id="S3.T3.33.33.3.m1.1.1" mathsize="80%" xref="S3.T3.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.33.33.3.m1.1b"><csymbol cd="latexml" id="S3.T3.33.33.3.m1.1.1.cmml" xref="S3.T3.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.33.33.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.33.33.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.33.33.3.2" style="font-size:80%;"> 0.006</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.34.34.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.34.34.4.1" style="font-size:80%;">0.192 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.34.34.4.m1.1"><semantics id="S3.T3.34.34.4.m1.1a"><mo id="S3.T3.34.34.4.m1.1.1" mathsize="80%" xref="S3.T3.34.34.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.34.34.4.m1.1b"><csymbol cd="latexml" id="S3.T3.34.34.4.m1.1.1.cmml" xref="S3.T3.34.34.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.34.34.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.34.34.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.34.34.4.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.35.35.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.35.35.5.1" style="font-size:80%;">0.593 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.35.35.5.m1.1"><semantics id="S3.T3.35.35.5.m1.1a"><mo id="S3.T3.35.35.5.m1.1.1" mathsize="80%" xref="S3.T3.35.35.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.35.35.5.m1.1b"><csymbol cd="latexml" id="S3.T3.35.35.5.m1.1.1.cmml" xref="S3.T3.35.35.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.35.35.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.35.35.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.35.35.5.2" style="font-size:80%;"> 0.005</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.40.40">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T3.40.40.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.40.40.6.1" style="font-size:80%;">Transformer</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.36.36.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.36.36.1.1" style="font-size:80%;">0.383 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.36.36.1.m1.1"><semantics id="S3.T3.36.36.1.m1.1a"><mo id="S3.T3.36.36.1.m1.1.1" mathsize="80%" xref="S3.T3.36.36.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.36.36.1.m1.1b"><csymbol cd="latexml" id="S3.T3.36.36.1.m1.1.1.cmml" xref="S3.T3.36.36.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.36.36.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.36.36.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.36.36.1.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.37.37.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.37.37.2.1" style="font-size:80%;">0.280 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.37.37.2.m1.1"><semantics id="S3.T3.37.37.2.m1.1a"><mo id="S3.T3.37.37.2.m1.1.1" mathsize="80%" xref="S3.T3.37.37.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.37.37.2.m1.1b"><csymbol cd="latexml" id="S3.T3.37.37.2.m1.1.1.cmml" xref="S3.T3.37.37.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.37.37.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.37.37.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.37.37.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.38.38.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.38.38.3.1" style="font-size:80%;">0.526 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.38.38.3.m1.1"><semantics id="S3.T3.38.38.3.m1.1a"><mo id="S3.T3.38.38.3.m1.1.1" mathsize="80%" xref="S3.T3.38.38.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.38.38.3.m1.1b"><csymbol cd="latexml" id="S3.T3.38.38.3.m1.1.1.cmml" xref="S3.T3.38.38.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.38.38.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.38.38.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.38.38.3.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.39.39.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.39.39.4.1" style="font-size:80%;">0.200 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.39.39.4.m1.1"><semantics id="S3.T3.39.39.4.m1.1a"><mo id="S3.T3.39.39.4.m1.1.1" mathsize="80%" xref="S3.T3.39.39.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.39.39.4.m1.1b"><csymbol cd="latexml" id="S3.T3.39.39.4.m1.1.1.cmml" xref="S3.T3.39.39.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.39.39.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.39.39.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.39.39.4.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.40.40.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.40.40.5.1" style="font-size:80%;">0.585 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.40.40.5.m1.1"><semantics id="S3.T3.40.40.5.m1.1a"><mo id="S3.T3.40.40.5.m1.1.1" mathsize="80%" xref="S3.T3.40.40.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.40.40.5.m1.1b"><csymbol cd="latexml" id="S3.T3.40.40.5.m1.1.1.cmml" xref="S3.T3.40.40.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.40.40.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.40.40.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.40.40.5.2" style="font-size:80%;"> 0.003</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.45.45">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T3.45.45.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.45.45.6.1" style="font-size:80%;">ARCI w/o intent</span></th>
<td class="ltx_td ltx_align_center" id="S3.T3.41.41.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.41.41.1.1" style="font-size:80%;">0.408 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.41.41.1.m1.1"><semantics id="S3.T3.41.41.1.m1.1a"><mo id="S3.T3.41.41.1.m1.1.1" mathsize="80%" xref="S3.T3.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.41.41.1.m1.1b"><csymbol cd="latexml" id="S3.T3.41.41.1.m1.1.1.cmml" xref="S3.T3.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.41.41.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.41.41.1.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.42.42.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.42.42.2.1" style="font-size:80%;">0.294 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.42.42.2.m1.1"><semantics id="S3.T3.42.42.2.m1.1a"><mo id="S3.T3.42.42.2.m1.1.1" mathsize="80%" xref="S3.T3.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.42.42.2.m1.1b"><csymbol cd="latexml" id="S3.T3.42.42.2.m1.1.1.cmml" xref="S3.T3.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.42.42.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.42.42.2.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.43.43.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.43.43.3.1" style="font-size:80%;">0.553 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.43.43.3.m1.1"><semantics id="S3.T3.43.43.3.m1.1a"><mo id="S3.T3.43.43.3.m1.1.1" mathsize="80%" xref="S3.T3.43.43.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.43.43.3.m1.1b"><csymbol cd="latexml" id="S3.T3.43.43.3.m1.1.1.cmml" xref="S3.T3.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.43.43.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.43.43.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.43.43.3.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.44.44.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.44.44.4.1" style="font-size:80%;">0.212 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.44.44.4.m1.1"><semantics id="S3.T3.44.44.4.m1.1a"><mo id="S3.T3.44.44.4.m1.1.1" mathsize="80%" xref="S3.T3.44.44.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.44.44.4.m1.1b"><csymbol cd="latexml" id="S3.T3.44.44.4.m1.1.1.cmml" xref="S3.T3.44.44.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.44.44.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.44.44.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.44.44.4.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.45.45.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.45.45.5.1" style="font-size:80%;">0.612 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.45.45.5.m1.1"><semantics id="S3.T3.45.45.5.m1.1a"><mo id="S3.T3.45.45.5.m1.1.1" mathsize="80%" xref="S3.T3.45.45.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.45.45.5.m1.1b"><csymbol cd="latexml" id="S3.T3.45.45.5.m1.1.1.cmml" xref="S3.T3.45.45.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.45.45.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.45.45.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.45.45.5.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.51.51">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T3.46.46.1" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text ltx_font_bold" id="S3.T3.46.46.1.1" style="font-size:80%;">ARCI w intent w/o</span><span class="ltx_text" id="S3.T3.46.46.1.2" style="font-size:80%;"> </span><math alttext="\mathbf{\mathcal{L}}_{I}" class="ltx_Math" display="inline" id="S3.T3.46.46.1.m1.1"><semantics id="S3.T3.46.46.1.m1.1a"><msub id="S3.T3.46.46.1.m1.1.1" xref="S3.T3.46.46.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T3.46.46.1.m1.1.1.2" mathsize="80%" xref="S3.T3.46.46.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.T3.46.46.1.m1.1.1.3" mathsize="80%" xref="S3.T3.46.46.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T3.46.46.1.m1.1b"><apply id="S3.T3.46.46.1.m1.1.1.cmml" xref="S3.T3.46.46.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T3.46.46.1.m1.1.1.1.cmml" xref="S3.T3.46.46.1.m1.1.1">subscript</csymbol><ci id="S3.T3.46.46.1.m1.1.1.2.cmml" xref="S3.T3.46.46.1.m1.1.1.2">ℒ</ci><ci id="S3.T3.46.46.1.m1.1.1.3.cmml" xref="S3.T3.46.46.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.46.46.1.m1.1c">\mathbf{\mathcal{L}}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.46.46.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S3.T3.47.47.2" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.47.47.2.1" style="font-size:80%;">0.412 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.47.47.2.m1.1"><semantics id="S3.T3.47.47.2.m1.1a"><mo id="S3.T3.47.47.2.m1.1.1" mathsize="80%" xref="S3.T3.47.47.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.47.47.2.m1.1b"><csymbol cd="latexml" id="S3.T3.47.47.2.m1.1.1.cmml" xref="S3.T3.47.47.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.47.47.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.47.47.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.47.47.2.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.48.48.3" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.48.48.3.1" style="font-size:80%;">0.303 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.48.48.3.m1.1"><semantics id="S3.T3.48.48.3.m1.1a"><mo id="S3.T3.48.48.3.m1.1.1" mathsize="80%" xref="S3.T3.48.48.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.48.48.3.m1.1b"><csymbol cd="latexml" id="S3.T3.48.48.3.m1.1.1.cmml" xref="S3.T3.48.48.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.48.48.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.48.48.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.48.48.3.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.49.49.4" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.49.49.4.1" style="font-size:80%;">0.560 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.49.49.4.m1.1"><semantics id="S3.T3.49.49.4.m1.1a"><mo id="S3.T3.49.49.4.m1.1.1" mathsize="80%" xref="S3.T3.49.49.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.49.49.4.m1.1b"><csymbol cd="latexml" id="S3.T3.49.49.4.m1.1.1.cmml" xref="S3.T3.49.49.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.49.49.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.49.49.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.49.49.4.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.50.50.5" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.50.50.5.1" style="font-size:80%;">0.220 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.50.50.5.m1.1"><semantics id="S3.T3.50.50.5.m1.1a"><mo id="S3.T3.50.50.5.m1.1.1" mathsize="80%" xref="S3.T3.50.50.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.50.50.5.m1.1b"><csymbol cd="latexml" id="S3.T3.50.50.5.m1.1.1.cmml" xref="S3.T3.50.50.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.50.50.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.50.50.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.50.50.5.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T3.51.51.6" style="padding-top:0.8pt;padding-bottom:0.8pt;">
<span class="ltx_text" id="S3.T3.51.51.6.1" style="font-size:80%;">0.622 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.51.51.6.m1.1"><semantics id="S3.T3.51.51.6.m1.1a"><mo id="S3.T3.51.51.6.m1.1.1" mathsize="80%" xref="S3.T3.51.51.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.51.51.6.m1.1b"><csymbol cd="latexml" id="S3.T3.51.51.6.m1.1.1.cmml" xref="S3.T3.51.51.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.51.51.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.51.51.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T3.51.51.6.2" style="font-size:80%;"> 0.003</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.56.56">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="S3.T3.56.56.6" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.56.56.6.1" style="font-size:80%;">ARCI</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.52.52.1" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.52.52.1.1" style="font-size:80%;">0.419 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.52.52.1.1.m1.1"><semantics id="S3.T3.52.52.1.1.m1.1a"><mo id="S3.T3.52.52.1.1.m1.1.1" xref="S3.T3.52.52.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.52.52.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.52.52.1.1.m1.1.1.cmml" xref="S3.T3.52.52.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.52.52.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.52.52.1.1.m1.1d">±</annotation></semantics></math> 0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.53.53.2" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.53.53.2.1" style="font-size:80%;">0.308 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.53.53.2.1.m1.1"><semantics id="S3.T3.53.53.2.1.m1.1a"><mo id="S3.T3.53.53.2.1.m1.1.1" xref="S3.T3.53.53.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.53.53.2.1.m1.1b"><csymbol cd="latexml" id="S3.T3.53.53.2.1.m1.1.1.cmml" xref="S3.T3.53.53.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.53.53.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.53.53.2.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.54.54.3" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.54.54.3.1" style="font-size:80%;">0.569 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.54.54.3.1.m1.1"><semantics id="S3.T3.54.54.3.1.m1.1a"><mo id="S3.T3.54.54.3.1.m1.1.1" xref="S3.T3.54.54.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.54.54.3.1.m1.1b"><csymbol cd="latexml" id="S3.T3.54.54.3.1.m1.1.1.cmml" xref="S3.T3.54.54.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.54.54.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.54.54.3.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.55.55.4" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.55.55.4.1" style="font-size:80%;">0.225 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.55.55.4.1.m1.1"><semantics id="S3.T3.55.55.4.1.m1.1a"><mo id="S3.T3.55.55.4.1.m1.1.1" xref="S3.T3.55.55.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.55.55.4.1.m1.1b"><csymbol cd="latexml" id="S3.T3.55.55.4.1.m1.1.1.cmml" xref="S3.T3.55.55.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.55.55.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.55.55.4.1.m1.1d">±</annotation></semantics></math> 0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.56.56.5" style="padding-top:0.8pt;padding-bottom:0.8pt;"><span class="ltx_text ltx_font_bold" id="S3.T3.56.56.5.1" style="font-size:80%;">0.631 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T3.56.56.5.1.m1.1"><semantics id="S3.T3.56.56.5.1.m1.1a"><mo id="S3.T3.56.56.5.1.m1.1.1" xref="S3.T3.56.56.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.56.56.5.1.m1.1b"><csymbol cd="latexml" id="S3.T3.56.56.5.1.m1.1.1.cmml" xref="S3.T3.56.56.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.56.56.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.56.56.5.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T4.93.1.1" style="font-size:113%;">Table 4</span>. </span><span class="ltx_text" id="S3.T4.94.2" style="font-size:113%;">Performance comparison on MIMIC-III and AKI based on classification metrics (PRAUC, F1 Score, and Jaccard) and drug safety metric (DDI). The reported values include means and 95% confidence interval calculated from folds.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T4.89">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.89.90.1">
<td class="ltx_td ltx_border_t" id="S3.T4.89.90.1.1" style="padding:0.8pt 2.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T4.89.90.1.2" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.89.90.1.2.1" style="font-size:80%;">MIMIC-III</span></td>
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="4" id="S3.T4.89.90.1.3" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.89.90.1.3.1" style="font-size:80%;">AKI</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.8.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.8.8.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.8.8.9.1" style="font-size:80%;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.1.1" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.1.1.1.1" style="font-size:80%;">PRAUC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T4.1.1.1.1.m1.1"><semantics id="S3.T4.1.1.1.1.m1.1a"><mo id="S3.T4.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T4.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T4.1.1.1.1.m1.1b"><ci id="S3.T4.1.1.1.1.m1.1.1.cmml" xref="S3.T4.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.2.2.2" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.2.2.2.1" style="font-size:80%;">F1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T4.2.2.2.1.m1.1"><semantics id="S3.T4.2.2.2.1.m1.1a"><mo id="S3.T4.2.2.2.1.m1.1.1" stretchy="false" xref="S3.T4.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T4.2.2.2.1.m1.1b"><ci id="S3.T4.2.2.2.1.m1.1.1.cmml" xref="S3.T4.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.3.3.3" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.3.3.3.1" style="font-size:80%;">Jaccard<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T4.3.3.3.1.m1.1"><semantics id="S3.T4.3.3.3.1.m1.1a"><mo id="S3.T4.3.3.3.1.m1.1.1" stretchy="false" xref="S3.T4.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T4.3.3.3.1.m1.1b"><ci id="S3.T4.3.3.3.1.m1.1.1.cmml" xref="S3.T4.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.3.3.3.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.4.4.4" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.4.4.4.1" style="font-size:80%;">DDI<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T4.4.4.4.1.m1.1"><semantics id="S3.T4.4.4.4.1.m1.1a"><mo id="S3.T4.4.4.4.1.m1.1.1" stretchy="false" xref="S3.T4.4.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T4.4.4.4.1.m1.1b"><ci id="S3.T4.4.4.4.1.m1.1.1.cmml" xref="S3.T4.4.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.4.4.4.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.4.4.4.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.5.5.5" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.5.5.5.1" style="font-size:80%;">PRAUC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T4.5.5.5.1.m1.1"><semantics id="S3.T4.5.5.5.1.m1.1a"><mo id="S3.T4.5.5.5.1.m1.1.1" stretchy="false" xref="S3.T4.5.5.5.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T4.5.5.5.1.m1.1b"><ci id="S3.T4.5.5.5.1.m1.1.1.cmml" xref="S3.T4.5.5.5.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.5.5.5.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.5.5.5.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.6.6.6" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.6.6.6.1" style="font-size:80%;">F1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T4.6.6.6.1.m1.1"><semantics id="S3.T4.6.6.6.1.m1.1a"><mo id="S3.T4.6.6.6.1.m1.1.1" stretchy="false" xref="S3.T4.6.6.6.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T4.6.6.6.1.m1.1b"><ci id="S3.T4.6.6.6.1.m1.1.1.cmml" xref="S3.T4.6.6.6.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.6.6.6.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.6.6.6.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.7.7.7" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.7.7.7.1" style="font-size:80%;">Jaccard<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T4.7.7.7.1.m1.1"><semantics id="S3.T4.7.7.7.1.m1.1a"><mo id="S3.T4.7.7.7.1.m1.1.1" stretchy="false" xref="S3.T4.7.7.7.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T4.7.7.7.1.m1.1b"><ci id="S3.T4.7.7.7.1.m1.1.1.cmml" xref="S3.T4.7.7.7.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.7.7.7.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.7.7.7.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T4.8.8.8" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.8.8.8.1" style="font-size:80%;">DDI<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T4.8.8.8.1.m1.1"><semantics id="S3.T4.8.8.8.1.m1.1a"><mo id="S3.T4.8.8.8.1.m1.1.1" stretchy="false" xref="S3.T4.8.8.8.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T4.8.8.8.1.m1.1b"><ci id="S3.T4.8.8.8.1.m1.1.1.cmml" xref="S3.T4.8.8.8.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.8.8.8.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T4.8.8.8.1.m1.1d">↓</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.16.16">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.16.16.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.16.16.9.1" style="font-size:80%;">Dr. Agent</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.9.9.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.9.9.1.1" style="font-size:80%;">0.324 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.9.9.1.m1.1"><semantics id="S3.T4.9.9.1.m1.1a"><mo id="S3.T4.9.9.1.m1.1.1" mathsize="80%" xref="S3.T4.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.9.9.1.m1.1b"><csymbol cd="latexml" id="S3.T4.9.9.1.m1.1.1.cmml" xref="S3.T4.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.9.9.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.9.9.1.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.10.10.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.10.10.2.1" style="font-size:80%;">0.212 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.10.10.2.m1.1"><semantics id="S3.T4.10.10.2.m1.1a"><mo id="S3.T4.10.10.2.m1.1.1" mathsize="80%" xref="S3.T4.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.10.10.2.m1.1b"><csymbol cd="latexml" id="S3.T4.10.10.2.m1.1.1.cmml" xref="S3.T4.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.10.10.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.10.10.2.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.11.11.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.11.11.3.1" style="font-size:80%;">0.137 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.11.11.3.m1.1"><semantics id="S3.T4.11.11.3.m1.1a"><mo id="S3.T4.11.11.3.m1.1.1" mathsize="80%" xref="S3.T4.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.11.11.3.m1.1b"><csymbol cd="latexml" id="S3.T4.11.11.3.m1.1.1.cmml" xref="S3.T4.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.11.11.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.11.11.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.11.11.3.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.12.12.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.12.12.4.1" style="font-size:80%;">0.047 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.12.12.4.m1.1"><semantics id="S3.T4.12.12.4.m1.1a"><mo id="S3.T4.12.12.4.m1.1.1" mathsize="80%" xref="S3.T4.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.12.12.4.m1.1b"><csymbol cd="latexml" id="S3.T4.12.12.4.m1.1.1.cmml" xref="S3.T4.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.12.12.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.12.12.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.12.12.4.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.13.13.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.13.13.5.1" style="font-size:80%;">0.350 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.13.13.5.m1.1"><semantics id="S3.T4.13.13.5.m1.1a"><mo id="S3.T4.13.13.5.m1.1.1" mathsize="80%" xref="S3.T4.13.13.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.13.13.5.m1.1b"><csymbol cd="latexml" id="S3.T4.13.13.5.m1.1.1.cmml" xref="S3.T4.13.13.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.13.13.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.13.13.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.13.13.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.14.14.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.14.14.6.1" style="font-size:80%;">0.251 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.14.14.6.m1.1"><semantics id="S3.T4.14.14.6.m1.1a"><mo id="S3.T4.14.14.6.m1.1.1" mathsize="80%" xref="S3.T4.14.14.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.14.14.6.m1.1b"><csymbol cd="latexml" id="S3.T4.14.14.6.m1.1.1.cmml" xref="S3.T4.14.14.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.14.14.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.14.14.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.14.14.6.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.15.15.7" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.15.15.7.1" style="font-size:80%;">0.168 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.15.15.7.1.m1.1"><semantics id="S3.T4.15.15.7.1.m1.1a"><mo id="S3.T4.15.15.7.1.m1.1.1" xref="S3.T4.15.15.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.15.15.7.1.m1.1b"><csymbol cd="latexml" id="S3.T4.15.15.7.1.m1.1.1.cmml" xref="S3.T4.15.15.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.15.15.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.15.15.7.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T4.16.16.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.16.16.8.1" style="font-size:80%;">0.074 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.16.16.8.m1.1"><semantics id="S3.T4.16.16.8.m1.1a"><mo id="S3.T4.16.16.8.m1.1.1" mathsize="80%" xref="S3.T4.16.16.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.16.16.8.m1.1b"><csymbol cd="latexml" id="S3.T4.16.16.8.m1.1.1.cmml" xref="S3.T4.16.16.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.16.16.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.16.16.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.16.16.8.2" style="font-size:80%;"> 0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.24.24">
<td class="ltx_td ltx_align_center" id="S3.T4.24.24.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.24.24.9.1" style="font-size:80%;">Retain</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.17.17.1" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.17.17.1.1" style="font-size:80%;">0.367 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.17.17.1.1.m1.1"><semantics id="S3.T4.17.17.1.1.m1.1a"><mo id="S3.T4.17.17.1.1.m1.1.1" xref="S3.T4.17.17.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.17.17.1.1.m1.1b"><csymbol cd="latexml" id="S3.T4.17.17.1.1.m1.1.1.cmml" xref="S3.T4.17.17.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.17.17.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.17.17.1.1.m1.1d">±</annotation></semantics></math> 0.004</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.18.18.2" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.18.18.2.1" style="font-size:80%;">0.263 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.18.18.2.1.m1.1"><semantics id="S3.T4.18.18.2.1.m1.1a"><mo id="S3.T4.18.18.2.1.m1.1.1" xref="S3.T4.18.18.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.18.18.2.1.m1.1b"><csymbol cd="latexml" id="S3.T4.18.18.2.1.m1.1.1.cmml" xref="S3.T4.18.18.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.18.18.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.18.18.2.1.m1.1d">±</annotation></semantics></math> 0.003</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.19.19.3" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.19.19.3.1" style="font-size:80%;">0.170 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.19.19.3.1.m1.1"><semantics id="S3.T4.19.19.3.1.m1.1a"><mo id="S3.T4.19.19.3.1.m1.1.1" xref="S3.T4.19.19.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.19.19.3.1.m1.1b"><csymbol cd="latexml" id="S3.T4.19.19.3.1.m1.1.1.cmml" xref="S3.T4.19.19.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.19.19.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.19.19.3.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.20.20.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.20.20.4.1" style="font-size:80%;">0.052 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.20.20.4.m1.1"><semantics id="S3.T4.20.20.4.m1.1a"><mo id="S3.T4.20.20.4.m1.1.1" mathsize="80%" xref="S3.T4.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.20.20.4.m1.1b"><csymbol cd="latexml" id="S3.T4.20.20.4.m1.1.1.cmml" xref="S3.T4.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.20.20.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.20.20.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.20.20.4.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.21.21.5" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.21.21.5.1" style="font-size:80%;">0.351 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.21.21.5.1.m1.1"><semantics id="S3.T4.21.21.5.1.m1.1a"><mo id="S3.T4.21.21.5.1.m1.1.1" xref="S3.T4.21.21.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.21.21.5.1.m1.1b"><csymbol cd="latexml" id="S3.T4.21.21.5.1.m1.1.1.cmml" xref="S3.T4.21.21.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.21.21.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.21.21.5.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.22.22.6" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.22.22.6.1" style="font-size:80%;">0.253 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.22.22.6.1.m1.1"><semantics id="S3.T4.22.22.6.1.m1.1a"><mo id="S3.T4.22.22.6.1.m1.1.1" xref="S3.T4.22.22.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.22.22.6.1.m1.1b"><csymbol cd="latexml" id="S3.T4.22.22.6.1.m1.1.1.cmml" xref="S3.T4.22.22.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.22.22.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.22.22.6.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.23.23.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.23.23.7.1" style="font-size:80%;">0.167 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.23.23.7.m1.1"><semantics id="S3.T4.23.23.7.m1.1a"><mo id="S3.T4.23.23.7.m1.1.1" mathsize="80%" xref="S3.T4.23.23.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.23.23.7.m1.1b"><csymbol cd="latexml" id="S3.T4.23.23.7.m1.1.1.cmml" xref="S3.T4.23.23.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.23.23.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.23.23.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.23.23.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T4.24.24.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.24.24.8.1" style="font-size:80%;">0.072 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.24.24.8.m1.1"><semantics id="S3.T4.24.24.8.m1.1a"><mo id="S3.T4.24.24.8.m1.1.1" mathsize="80%" xref="S3.T4.24.24.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.24.24.8.m1.1b"><csymbol cd="latexml" id="S3.T4.24.24.8.m1.1.1.cmml" xref="S3.T4.24.24.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.24.24.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.24.24.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.24.24.8.2" style="font-size:80%;"> 0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.32.32">
<td class="ltx_td ltx_align_center" id="S3.T4.32.32.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.32.32.9.1" style="font-size:80%;">Micron</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.25.25.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.25.25.1.1" style="font-size:80%;">0.273 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.25.25.1.m1.1"><semantics id="S3.T4.25.25.1.m1.1a"><mo id="S3.T4.25.25.1.m1.1.1" mathsize="80%" xref="S3.T4.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.25.25.1.m1.1b"><csymbol cd="latexml" id="S3.T4.25.25.1.m1.1.1.cmml" xref="S3.T4.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.25.25.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.25.25.1.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.26.26.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.26.26.2.1" style="font-size:80%;">0.228 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.26.26.2.m1.1"><semantics id="S3.T4.26.26.2.m1.1a"><mo id="S3.T4.26.26.2.m1.1.1" mathsize="80%" xref="S3.T4.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.26.26.2.m1.1b"><csymbol cd="latexml" id="S3.T4.26.26.2.m1.1.1.cmml" xref="S3.T4.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.26.26.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.26.26.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.27.27.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.27.27.3.1" style="font-size:80%;">0.143 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.27.27.3.m1.1"><semantics id="S3.T4.27.27.3.m1.1a"><mo id="S3.T4.27.27.3.m1.1.1" mathsize="80%" xref="S3.T4.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.27.27.3.m1.1b"><csymbol cd="latexml" id="S3.T4.27.27.3.m1.1.1.cmml" xref="S3.T4.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.27.27.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.27.27.3.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.28.28.4" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.28.28.4.1" style="font-size:80%;">0.047 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.28.28.4.1.m1.1"><semantics id="S3.T4.28.28.4.1.m1.1a"><mo id="S3.T4.28.28.4.1.m1.1.1" xref="S3.T4.28.28.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.28.28.4.1.m1.1b"><csymbol cd="latexml" id="S3.T4.28.28.4.1.m1.1.1.cmml" xref="S3.T4.28.28.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.28.28.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.28.28.4.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.29.29.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.29.29.5.1" style="font-size:80%;">0.329 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.29.29.5.m1.1"><semantics id="S3.T4.29.29.5.m1.1a"><mo id="S3.T4.29.29.5.m1.1.1" mathsize="80%" xref="S3.T4.29.29.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.29.29.5.m1.1b"><csymbol cd="latexml" id="S3.T4.29.29.5.m1.1.1.cmml" xref="S3.T4.29.29.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.29.29.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.29.29.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.29.29.5.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.30.30.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.30.30.6.1" style="font-size:80%;">0.229 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.30.30.6.m1.1"><semantics id="S3.T4.30.30.6.m1.1a"><mo id="S3.T4.30.30.6.m1.1.1" mathsize="80%" xref="S3.T4.30.30.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.30.30.6.m1.1b"><csymbol cd="latexml" id="S3.T4.30.30.6.m1.1.1.cmml" xref="S3.T4.30.30.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.30.30.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.30.30.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.30.30.6.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.31.31.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.31.31.7.1" style="font-size:80%;">0.146 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.31.31.7.m1.1"><semantics id="S3.T4.31.31.7.m1.1a"><mo id="S3.T4.31.31.7.m1.1.1" mathsize="80%" xref="S3.T4.31.31.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.31.31.7.m1.1b"><csymbol cd="latexml" id="S3.T4.31.31.7.m1.1.1.cmml" xref="S3.T4.31.31.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.31.31.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.31.31.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.31.31.7.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T4.32.32.8" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.32.32.8.1" style="font-size:80%;">0.055 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.32.32.8.1.m1.1"><semantics id="S3.T4.32.32.8.1.m1.1a"><mo id="S3.T4.32.32.8.1.m1.1.1" xref="S3.T4.32.32.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.32.32.8.1.m1.1b"><csymbol cd="latexml" id="S3.T4.32.32.8.1.m1.1.1.cmml" xref="S3.T4.32.32.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.32.32.8.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.32.32.8.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.40.40">
<td class="ltx_td ltx_align_center" id="S3.T4.40.40.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.40.40.9.1" style="font-size:80%;">SafeDrug</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.33.33.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.33.33.1.1" style="font-size:80%;">0.270 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.33.33.1.m1.1"><semantics id="S3.T4.33.33.1.m1.1a"><mo id="S3.T4.33.33.1.m1.1.1" mathsize="80%" xref="S3.T4.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.33.33.1.m1.1b"><csymbol cd="latexml" id="S3.T4.33.33.1.m1.1.1.cmml" xref="S3.T4.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.33.33.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.33.33.1.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.34.34.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.34.34.2.1" style="font-size:80%;">0.190 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.34.34.2.m1.1"><semantics id="S3.T4.34.34.2.m1.1a"><mo id="S3.T4.34.34.2.m1.1.1" mathsize="80%" xref="S3.T4.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.34.34.2.m1.1b"><csymbol cd="latexml" id="S3.T4.34.34.2.m1.1.1.cmml" xref="S3.T4.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.34.34.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.34.34.2.2" style="font-size:80%;"> 0.012</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.35.35.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.35.35.3.1" style="font-size:80%;">0.118 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.35.35.3.m1.1"><semantics id="S3.T4.35.35.3.m1.1a"><mo id="S3.T4.35.35.3.m1.1.1" mathsize="80%" xref="S3.T4.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.35.35.3.m1.1b"><csymbol cd="latexml" id="S3.T4.35.35.3.m1.1.1.cmml" xref="S3.T4.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.35.35.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.35.35.3.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.36.36.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.36.36.4.1" style="font-size:80%;">0.057 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.36.36.4.m1.1"><semantics id="S3.T4.36.36.4.m1.1a"><mo id="S3.T4.36.36.4.m1.1.1" mathsize="80%" xref="S3.T4.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.36.36.4.m1.1b"><csymbol cd="latexml" id="S3.T4.36.36.4.m1.1.1.cmml" xref="S3.T4.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.36.36.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.36.36.4.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.37.37.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.37.37.5.1" style="font-size:80%;">0.336 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.37.37.5.m1.1"><semantics id="S3.T4.37.37.5.m1.1a"><mo id="S3.T4.37.37.5.m1.1.1" mathsize="80%" xref="S3.T4.37.37.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.37.37.5.m1.1b"><csymbol cd="latexml" id="S3.T4.37.37.5.m1.1.1.cmml" xref="S3.T4.37.37.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.37.37.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.37.37.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.37.37.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.38.38.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.38.38.6.1" style="font-size:80%;">0.237 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.38.38.6.m1.1"><semantics id="S3.T4.38.38.6.m1.1a"><mo id="S3.T4.38.38.6.m1.1.1" mathsize="80%" xref="S3.T4.38.38.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.38.38.6.m1.1b"><csymbol cd="latexml" id="S3.T4.38.38.6.m1.1.1.cmml" xref="S3.T4.38.38.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.38.38.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.38.38.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.38.38.6.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.39.39.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.39.39.7.1" style="font-size:80%;">0.156 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.39.39.7.m1.1"><semantics id="S3.T4.39.39.7.m1.1a"><mo id="S3.T4.39.39.7.m1.1.1" mathsize="80%" xref="S3.T4.39.39.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.39.39.7.m1.1b"><csymbol cd="latexml" id="S3.T4.39.39.7.m1.1.1.cmml" xref="S3.T4.39.39.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.39.39.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.39.39.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.39.39.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T4.40.40.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.40.40.8.1" style="font-size:80%;">0.071 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.40.40.8.m1.1"><semantics id="S3.T4.40.40.8.m1.1a"><mo id="S3.T4.40.40.8.m1.1.1" mathsize="80%" xref="S3.T4.40.40.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.40.40.8.m1.1b"><csymbol cd="latexml" id="S3.T4.40.40.8.m1.1.1.cmml" xref="S3.T4.40.40.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.40.40.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.40.40.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.40.40.8.2" style="font-size:80%;"> 0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.48.48">
<td class="ltx_td ltx_align_center" id="S3.T4.48.48.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.48.48.9.1" style="font-size:80%;">MoleRec</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.41.41.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.41.41.1.1" style="font-size:80%;">0.275 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.41.41.1.m1.1"><semantics id="S3.T4.41.41.1.m1.1a"><mo id="S3.T4.41.41.1.m1.1.1" mathsize="80%" xref="S3.T4.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.41.41.1.m1.1b"><csymbol cd="latexml" id="S3.T4.41.41.1.m1.1.1.cmml" xref="S3.T4.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.41.41.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.41.41.1.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.42.42.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.42.42.2.1" style="font-size:80%;">0.228 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.42.42.2.m1.1"><semantics id="S3.T4.42.42.2.m1.1a"><mo id="S3.T4.42.42.2.m1.1.1" mathsize="80%" xref="S3.T4.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.42.42.2.m1.1b"><csymbol cd="latexml" id="S3.T4.42.42.2.m1.1.1.cmml" xref="S3.T4.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.42.42.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.42.42.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.43.43.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.43.43.3.1" style="font-size:80%;">0.143 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.43.43.3.m1.1"><semantics id="S3.T4.43.43.3.m1.1a"><mo id="S3.T4.43.43.3.m1.1.1" mathsize="80%" xref="S3.T4.43.43.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.43.43.3.m1.1b"><csymbol cd="latexml" id="S3.T4.43.43.3.m1.1.1.cmml" xref="S3.T4.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.43.43.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.43.43.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.43.43.3.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.44.44.4" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.44.44.4.1" style="font-size:80%;">0.046 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.44.44.4.1.m1.1"><semantics id="S3.T4.44.44.4.1.m1.1a"><mo id="S3.T4.44.44.4.1.m1.1.1" xref="S3.T4.44.44.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.44.44.4.1.m1.1b"><csymbol cd="latexml" id="S3.T4.44.44.4.1.m1.1.1.cmml" xref="S3.T4.44.44.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.44.44.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.44.44.4.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.45.45.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.45.45.5.1" style="font-size:80%;">0.328 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.45.45.5.m1.1"><semantics id="S3.T4.45.45.5.m1.1a"><mo id="S3.T4.45.45.5.m1.1.1" mathsize="80%" xref="S3.T4.45.45.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.45.45.5.m1.1b"><csymbol cd="latexml" id="S3.T4.45.45.5.m1.1.1.cmml" xref="S3.T4.45.45.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.45.45.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.45.45.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.45.45.5.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.46.46.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.46.46.6.1" style="font-size:80%;">0.230 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.46.46.6.m1.1"><semantics id="S3.T4.46.46.6.m1.1a"><mo id="S3.T4.46.46.6.m1.1.1" mathsize="80%" xref="S3.T4.46.46.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.46.46.6.m1.1b"><csymbol cd="latexml" id="S3.T4.46.46.6.m1.1.1.cmml" xref="S3.T4.46.46.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.46.46.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.46.46.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.46.46.6.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.47.47.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.47.47.7.1" style="font-size:80%;">0.146 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.47.47.7.m1.1"><semantics id="S3.T4.47.47.7.m1.1a"><mo id="S3.T4.47.47.7.m1.1.1" mathsize="80%" xref="S3.T4.47.47.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.47.47.7.m1.1b"><csymbol cd="latexml" id="S3.T4.47.47.7.m1.1.1.cmml" xref="S3.T4.47.47.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.47.47.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.47.47.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.47.47.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T4.48.48.8" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T4.48.48.8.1" style="font-size:80%;">0.057 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.48.48.8.1.m1.1"><semantics id="S3.T4.48.48.8.1.m1.1a"><mo id="S3.T4.48.48.8.1.m1.1.1" xref="S3.T4.48.48.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.48.48.8.1.m1.1b"><csymbol cd="latexml" id="S3.T4.48.48.8.1.m1.1.1.cmml" xref="S3.T4.48.48.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.48.48.8.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.48.48.8.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.56.56">
<td class="ltx_td ltx_align_center" id="S3.T4.56.56.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.56.56.9.1" style="font-size:80%;">GAMENet</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.49.49.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.49.49.1.1" style="font-size:80%;">0.319 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.49.49.1.m1.1"><semantics id="S3.T4.49.49.1.m1.1a"><mo id="S3.T4.49.49.1.m1.1.1" mathsize="80%" xref="S3.T4.49.49.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.49.49.1.m1.1b"><csymbol cd="latexml" id="S3.T4.49.49.1.m1.1.1.cmml" xref="S3.T4.49.49.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.49.49.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.49.49.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.49.49.1.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.50.50.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.50.50.2.1" style="font-size:80%;">0.239 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.50.50.2.m1.1"><semantics id="S3.T4.50.50.2.m1.1a"><mo id="S3.T4.50.50.2.m1.1.1" mathsize="80%" xref="S3.T4.50.50.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.50.50.2.m1.1b"><csymbol cd="latexml" id="S3.T4.50.50.2.m1.1.1.cmml" xref="S3.T4.50.50.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.50.50.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.50.50.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.50.50.2.2" style="font-size:80%;"> 0.008</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.51.51.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.51.51.3.1" style="font-size:80%;">0.153 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.51.51.3.m1.1"><semantics id="S3.T4.51.51.3.m1.1a"><mo id="S3.T4.51.51.3.m1.1.1" mathsize="80%" xref="S3.T4.51.51.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.51.51.3.m1.1b"><csymbol cd="latexml" id="S3.T4.51.51.3.m1.1.1.cmml" xref="S3.T4.51.51.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.51.51.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.51.51.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.51.51.3.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.52.52.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.52.52.4.1" style="font-size:80%;">0.054 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.52.52.4.m1.1"><semantics id="S3.T4.52.52.4.m1.1a"><mo id="S3.T4.52.52.4.m1.1.1" mathsize="80%" xref="S3.T4.52.52.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.52.52.4.m1.1b"><csymbol cd="latexml" id="S3.T4.52.52.4.m1.1.1.cmml" xref="S3.T4.52.52.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.52.52.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.52.52.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.52.52.4.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.53.53.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.53.53.5.1" style="font-size:80%;">0.345 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.53.53.5.m1.1"><semantics id="S3.T4.53.53.5.m1.1a"><mo id="S3.T4.53.53.5.m1.1.1" mathsize="80%" xref="S3.T4.53.53.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.53.53.5.m1.1b"><csymbol cd="latexml" id="S3.T4.53.53.5.m1.1.1.cmml" xref="S3.T4.53.53.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.53.53.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.53.53.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.53.53.5.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.54.54.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.54.54.6.1" style="font-size:80%;">0.251 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.54.54.6.m1.1"><semantics id="S3.T4.54.54.6.m1.1a"><mo id="S3.T4.54.54.6.m1.1.1" mathsize="80%" xref="S3.T4.54.54.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.54.54.6.m1.1b"><csymbol cd="latexml" id="S3.T4.54.54.6.m1.1.1.cmml" xref="S3.T4.54.54.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.54.54.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.54.54.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.54.54.6.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.55.55.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.55.55.7.1" style="font-size:80%;">0.164 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.55.55.7.m1.1"><semantics id="S3.T4.55.55.7.m1.1a"><mo id="S3.T4.55.55.7.m1.1.1" mathsize="80%" xref="S3.T4.55.55.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.55.55.7.m1.1b"><csymbol cd="latexml" id="S3.T4.55.55.7.m1.1.1.cmml" xref="S3.T4.55.55.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.55.55.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.55.55.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.55.55.7.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T4.56.56.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.56.56.8.1" style="font-size:80%;">0.070 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.56.56.8.m1.1"><semantics id="S3.T4.56.56.8.m1.1a"><mo id="S3.T4.56.56.8.m1.1.1" mathsize="80%" xref="S3.T4.56.56.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.56.56.8.m1.1b"><csymbol cd="latexml" id="S3.T4.56.56.8.m1.1.1.cmml" xref="S3.T4.56.56.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.56.56.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.56.56.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.56.56.8.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.64.64">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.64.64.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.64.64.9.1" style="font-size:80%;">Transformer</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.57.57.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.57.57.1.1" style="font-size:80%;">0.340 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.57.57.1.m1.1"><semantics id="S3.T4.57.57.1.m1.1a"><mo id="S3.T4.57.57.1.m1.1.1" mathsize="80%" xref="S3.T4.57.57.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.57.57.1.m1.1b"><csymbol cd="latexml" id="S3.T4.57.57.1.m1.1.1.cmml" xref="S3.T4.57.57.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.57.57.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.57.57.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.57.57.1.2" style="font-size:80%;"> 0.006</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.58.58.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.58.58.2.1" style="font-size:80%;">0.232 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.58.58.2.m1.1"><semantics id="S3.T4.58.58.2.m1.1a"><mo id="S3.T4.58.58.2.m1.1.1" mathsize="80%" xref="S3.T4.58.58.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.58.58.2.m1.1b"><csymbol cd="latexml" id="S3.T4.58.58.2.m1.1.1.cmml" xref="S3.T4.58.58.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.58.58.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.58.58.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.58.58.2.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.59.59.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.59.59.3.1" style="font-size:80%;">0.150 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.59.59.3.m1.1"><semantics id="S3.T4.59.59.3.m1.1a"><mo id="S3.T4.59.59.3.m1.1.1" mathsize="80%" xref="S3.T4.59.59.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.59.59.3.m1.1b"><csymbol cd="latexml" id="S3.T4.59.59.3.m1.1.1.cmml" xref="S3.T4.59.59.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.59.59.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.59.59.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.59.59.3.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T4.60.60.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.60.60.4.1" style="font-size:80%;">0.048 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.60.60.4.m1.1"><semantics id="S3.T4.60.60.4.m1.1a"><mo id="S3.T4.60.60.4.m1.1.1" mathsize="80%" xref="S3.T4.60.60.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.60.60.4.m1.1b"><csymbol cd="latexml" id="S3.T4.60.60.4.m1.1.1.cmml" xref="S3.T4.60.60.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.60.60.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.60.60.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.60.60.4.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.61.61.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.61.61.5.1" style="font-size:80%;">0.333 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.61.61.5.m1.1"><semantics id="S3.T4.61.61.5.m1.1a"><mo id="S3.T4.61.61.5.m1.1.1" mathsize="80%" xref="S3.T4.61.61.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.61.61.5.m1.1b"><csymbol cd="latexml" id="S3.T4.61.61.5.m1.1.1.cmml" xref="S3.T4.61.61.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.61.61.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.61.61.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.61.61.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.62.62.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.62.62.6.1" style="font-size:80%;">0.237 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.62.62.6.m1.1"><semantics id="S3.T4.62.62.6.m1.1a"><mo id="S3.T4.62.62.6.m1.1.1" mathsize="80%" xref="S3.T4.62.62.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.62.62.6.m1.1b"><csymbol cd="latexml" id="S3.T4.62.62.6.m1.1.1.cmml" xref="S3.T4.62.62.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.62.62.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.62.62.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.62.62.6.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.63.63.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.63.63.7.1" style="font-size:80%;">0.156 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.63.63.7.m1.1"><semantics id="S3.T4.63.63.7.m1.1a"><mo id="S3.T4.63.63.7.m1.1.1" mathsize="80%" xref="S3.T4.63.63.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.63.63.7.m1.1b"><csymbol cd="latexml" id="S3.T4.63.63.7.m1.1.1.cmml" xref="S3.T4.63.63.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.63.63.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.63.63.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.63.63.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T4.64.64.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.64.64.8.1" style="font-size:80%;">0.072 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.64.64.8.m1.1"><semantics id="S3.T4.64.64.8.m1.1a"><mo id="S3.T4.64.64.8.m1.1.1" mathsize="80%" xref="S3.T4.64.64.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.64.64.8.m1.1b"><csymbol cd="latexml" id="S3.T4.64.64.8.m1.1.1.cmml" xref="S3.T4.64.64.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.64.64.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.64.64.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.64.64.8.2" style="font-size:80%;"> 0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.72.72">
<td class="ltx_td ltx_align_center" id="S3.T4.72.72.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.72.72.9.1" style="font-size:80%;">ARCI w/o intent</span></td>
<td class="ltx_td ltx_align_center" id="S3.T4.65.65.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.65.65.1.1" style="font-size:80%;">0.352 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.65.65.1.m1.1"><semantics id="S3.T4.65.65.1.m1.1a"><mo id="S3.T4.65.65.1.m1.1.1" mathsize="80%" xref="S3.T4.65.65.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.65.65.1.m1.1b"><csymbol cd="latexml" id="S3.T4.65.65.1.m1.1.1.cmml" xref="S3.T4.65.65.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.65.65.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.65.65.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.65.65.1.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.66.66.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.66.66.2.1" style="font-size:80%;">0.273 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.66.66.2.m1.1"><semantics id="S3.T4.66.66.2.m1.1a"><mo id="S3.T4.66.66.2.m1.1.1" mathsize="80%" xref="S3.T4.66.66.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.66.66.2.m1.1b"><csymbol cd="latexml" id="S3.T4.66.66.2.m1.1.1.cmml" xref="S3.T4.66.66.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.66.66.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.66.66.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.66.66.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.67.67.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.67.67.3.1" style="font-size:80%;">0.175 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.67.67.3.m1.1"><semantics id="S3.T4.67.67.3.m1.1a"><mo id="S3.T4.67.67.3.m1.1.1" mathsize="80%" xref="S3.T4.67.67.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.67.67.3.m1.1b"><csymbol cd="latexml" id="S3.T4.67.67.3.m1.1.1.cmml" xref="S3.T4.67.67.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.67.67.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.67.67.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.67.67.3.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.68.68.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.68.68.4.1" style="font-size:80%;">0.058 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.68.68.4.m1.1"><semantics id="S3.T4.68.68.4.m1.1a"><mo id="S3.T4.68.68.4.m1.1.1" mathsize="80%" xref="S3.T4.68.68.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.68.68.4.m1.1b"><csymbol cd="latexml" id="S3.T4.68.68.4.m1.1.1.cmml" xref="S3.T4.68.68.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.68.68.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.68.68.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.68.68.4.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.69.69.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.69.69.5.1" style="font-size:80%;">0.354 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.69.69.5.m1.1"><semantics id="S3.T4.69.69.5.m1.1a"><mo id="S3.T4.69.69.5.m1.1.1" mathsize="80%" xref="S3.T4.69.69.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.69.69.5.m1.1b"><csymbol cd="latexml" id="S3.T4.69.69.5.m1.1.1.cmml" xref="S3.T4.69.69.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.69.69.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.69.69.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.69.69.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.70.70.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.70.70.6.1" style="font-size:80%;">0.268 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.70.70.6.m1.1"><semantics id="S3.T4.70.70.6.m1.1a"><mo id="S3.T4.70.70.6.m1.1.1" mathsize="80%" xref="S3.T4.70.70.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.70.70.6.m1.1b"><csymbol cd="latexml" id="S3.T4.70.70.6.m1.1.1.cmml" xref="S3.T4.70.70.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.70.70.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.70.70.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.70.70.6.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.71.71.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.71.71.7.1" style="font-size:80%;">0.180 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.71.71.7.m1.1"><semantics id="S3.T4.71.71.7.m1.1a"><mo id="S3.T4.71.71.7.m1.1.1" mathsize="80%" xref="S3.T4.71.71.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.71.71.7.m1.1b"><csymbol cd="latexml" id="S3.T4.71.71.7.m1.1.1.cmml" xref="S3.T4.71.71.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.71.71.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.71.71.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.71.71.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T4.72.72.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.72.72.8.1" style="font-size:80%;">0.074 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.72.72.8.m1.1"><semantics id="S3.T4.72.72.8.m1.1a"><mo id="S3.T4.72.72.8.m1.1.1" mathsize="80%" xref="S3.T4.72.72.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.72.72.8.m1.1b"><csymbol cd="latexml" id="S3.T4.72.72.8.m1.1.1.cmml" xref="S3.T4.72.72.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.72.72.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.72.72.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.72.72.8.2" style="font-size:80%;"> 0.003</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.81.81">
<td class="ltx_td ltx_align_center" id="S3.T4.73.73.1" style="padding:0.8pt 2.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T4.73.73.1.1" style="font-size:80%;">ARCI w intent w/o</span><span class="ltx_text" id="S3.T4.73.73.1.2" style="font-size:80%;"> </span><math alttext="\mathbf{\mathcal{L}}_{I}" class="ltx_Math" display="inline" id="S3.T4.73.73.1.m1.1"><semantics id="S3.T4.73.73.1.m1.1a"><msub id="S3.T4.73.73.1.m1.1.1" xref="S3.T4.73.73.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T4.73.73.1.m1.1.1.2" mathsize="80%" xref="S3.T4.73.73.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.T4.73.73.1.m1.1.1.3" mathsize="80%" xref="S3.T4.73.73.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T4.73.73.1.m1.1b"><apply id="S3.T4.73.73.1.m1.1.1.cmml" xref="S3.T4.73.73.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T4.73.73.1.m1.1.1.1.cmml" xref="S3.T4.73.73.1.m1.1.1">subscript</csymbol><ci id="S3.T4.73.73.1.m1.1.1.2.cmml" xref="S3.T4.73.73.1.m1.1.1.2">ℒ</ci><ci id="S3.T4.73.73.1.m1.1.1.3.cmml" xref="S3.T4.73.73.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.73.73.1.m1.1c">\mathbf{\mathcal{L}}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.T4.73.73.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.74.74.2" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.74.74.2.1" style="font-size:80%;">0.366 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.74.74.2.m1.1"><semantics id="S3.T4.74.74.2.m1.1a"><mo id="S3.T4.74.74.2.m1.1.1" mathsize="80%" xref="S3.T4.74.74.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.74.74.2.m1.1b"><csymbol cd="latexml" id="S3.T4.74.74.2.m1.1.1.cmml" xref="S3.T4.74.74.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.74.74.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.74.74.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.74.74.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.75.75.3" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.75.75.3.1" style="font-size:80%;">0.282 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.75.75.3.m1.1"><semantics id="S3.T4.75.75.3.m1.1a"><mo id="S3.T4.75.75.3.m1.1.1" mathsize="80%" xref="S3.T4.75.75.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.75.75.3.m1.1b"><csymbol cd="latexml" id="S3.T4.75.75.3.m1.1.1.cmml" xref="S3.T4.75.75.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.75.75.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.75.75.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.75.75.3.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.76.76.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.76.76.4.1" style="font-size:80%;">0.183 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.76.76.4.m1.1"><semantics id="S3.T4.76.76.4.m1.1a"><mo id="S3.T4.76.76.4.m1.1.1" mathsize="80%" xref="S3.T4.76.76.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.76.76.4.m1.1b"><csymbol cd="latexml" id="S3.T4.76.76.4.m1.1.1.cmml" xref="S3.T4.76.76.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.76.76.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.76.76.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.76.76.4.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T4.77.77.5" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.77.77.5.1" style="font-size:80%;">0.052 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.77.77.5.m1.1"><semantics id="S3.T4.77.77.5.m1.1a"><mo id="S3.T4.77.77.5.m1.1.1" mathsize="80%" xref="S3.T4.77.77.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.77.77.5.m1.1b"><csymbol cd="latexml" id="S3.T4.77.77.5.m1.1.1.cmml" xref="S3.T4.77.77.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.77.77.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.77.77.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.77.77.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.78.78.6" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.78.78.6.1" style="font-size:80%;">0.360 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.78.78.6.m1.1"><semantics id="S3.T4.78.78.6.m1.1a"><mo id="S3.T4.78.78.6.m1.1.1" mathsize="80%" xref="S3.T4.78.78.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.78.78.6.m1.1b"><csymbol cd="latexml" id="S3.T4.78.78.6.m1.1.1.cmml" xref="S3.T4.78.78.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.78.78.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.78.78.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.78.78.6.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.79.79.7" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.79.79.7.1" style="font-size:80%;">0.272 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.79.79.7.m1.1"><semantics id="S3.T4.79.79.7.m1.1a"><mo id="S3.T4.79.79.7.m1.1.1" mathsize="80%" xref="S3.T4.79.79.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.79.79.7.m1.1b"><csymbol cd="latexml" id="S3.T4.79.79.7.m1.1.1.cmml" xref="S3.T4.79.79.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.79.79.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.79.79.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.79.79.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T4.80.80.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.80.80.8.1" style="font-size:80%;">0.182 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.80.80.8.m1.1"><semantics id="S3.T4.80.80.8.m1.1a"><mo id="S3.T4.80.80.8.m1.1.1" mathsize="80%" xref="S3.T4.80.80.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.80.80.8.m1.1b"><csymbol cd="latexml" id="S3.T4.80.80.8.m1.1.1.cmml" xref="S3.T4.80.80.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.80.80.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.80.80.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.80.80.8.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T4.81.81.9" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.81.81.9.1" style="font-size:80%;">0.062 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.81.81.9.m1.1"><semantics id="S3.T4.81.81.9.m1.1a"><mo id="S3.T4.81.81.9.m1.1.1" mathsize="80%" xref="S3.T4.81.81.9.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.81.81.9.m1.1b"><csymbol cd="latexml" id="S3.T4.81.81.9.m1.1.1.cmml" xref="S3.T4.81.81.9.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.81.81.9.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.81.81.9.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.81.81.9.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T4.89.89">
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.89.89.9" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.89.89.9.1" style="font-size:80%;">ARCI</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.82.82.1" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.82.82.1.1" style="font-size:80%;">0.376 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.82.82.1.1.m1.1"><semantics id="S3.T4.82.82.1.1.m1.1a"><mo id="S3.T4.82.82.1.1.m1.1.1" xref="S3.T4.82.82.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.82.82.1.1.m1.1b"><csymbol cd="latexml" id="S3.T4.82.82.1.1.m1.1.1.cmml" xref="S3.T4.82.82.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.82.82.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.82.82.1.1.m1.1d">±</annotation></semantics></math> 0.004</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.83.83.2" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.83.83.2.1" style="font-size:80%;">0.299 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.83.83.2.1.m1.1"><semantics id="S3.T4.83.83.2.1.m1.1a"><mo id="S3.T4.83.83.2.1.m1.1.1" xref="S3.T4.83.83.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.83.83.2.1.m1.1b"><csymbol cd="latexml" id="S3.T4.83.83.2.1.m1.1.1.cmml" xref="S3.T4.83.83.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.83.83.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.83.83.2.1.m1.1d">±</annotation></semantics></math> 0.004</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.84.84.3" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.84.84.3.1" style="font-size:80%;">0.194 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.84.84.3.1.m1.1"><semantics id="S3.T4.84.84.3.1.m1.1a"><mo id="S3.T4.84.84.3.1.m1.1.1" xref="S3.T4.84.84.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.84.84.3.1.m1.1b"><csymbol cd="latexml" id="S3.T4.84.84.3.1.m1.1.1.cmml" xref="S3.T4.84.84.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.84.84.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.84.84.3.1.m1.1d">±</annotation></semantics></math> 0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T4.85.85.4" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.85.85.4.1" style="font-size:80%;">0.051 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.85.85.4.m1.1"><semantics id="S3.T4.85.85.4.m1.1a"><mo id="S3.T4.85.85.4.m1.1.1" mathsize="80%" xref="S3.T4.85.85.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.85.85.4.m1.1b"><csymbol cd="latexml" id="S3.T4.85.85.4.m1.1.1.cmml" xref="S3.T4.85.85.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.85.85.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.85.85.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.85.85.4.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.86.86.5" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.86.86.5.1" style="font-size:80%;">0.366 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.86.86.5.1.m1.1"><semantics id="S3.T4.86.86.5.1.m1.1a"><mo id="S3.T4.86.86.5.1.m1.1.1" xref="S3.T4.86.86.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.86.86.5.1.m1.1b"><csymbol cd="latexml" id="S3.T4.86.86.5.1.m1.1.1.cmml" xref="S3.T4.86.86.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.86.86.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.86.86.5.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.87.87.6" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.87.87.6.1" style="font-size:80%;">0.283 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.87.87.6.1.m1.1"><semantics id="S3.T4.87.87.6.1.m1.1a"><mo id="S3.T4.87.87.6.1.m1.1.1" xref="S3.T4.87.87.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.87.87.6.1.m1.1b"><csymbol cd="latexml" id="S3.T4.87.87.6.1.m1.1.1.cmml" xref="S3.T4.87.87.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.87.87.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.87.87.6.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T4.88.88.7" style="padding:0.8pt 2.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T4.88.88.7.1" style="font-size:80%;">0.190 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.88.88.7.1.m1.1"><semantics id="S3.T4.88.88.7.1.m1.1a"><mo id="S3.T4.88.88.7.1.m1.1.1" xref="S3.T4.88.88.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.88.88.7.1.m1.1b"><csymbol cd="latexml" id="S3.T4.88.88.7.1.m1.1.1.cmml" xref="S3.T4.88.88.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.88.88.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.88.88.7.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_b" id="S3.T4.89.89.8" style="padding:0.8pt 2.0pt;">
<span class="ltx_text" id="S3.T4.89.89.8.1" style="font-size:80%;">0.063 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T4.89.89.8.m1.1"><semantics id="S3.T4.89.89.8.m1.1a"><mo id="S3.T4.89.89.8.m1.1.1" mathsize="80%" xref="S3.T4.89.89.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T4.89.89.8.m1.1b"><csymbol cd="latexml" id="S3.T4.89.89.8.m1.1.1.cmml" xref="S3.T4.89.89.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T4.89.89.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T4.89.89.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T4.89.89.8.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Evaluation Metrics</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.17">In this research, we utilize both well-known classification and ranking metrics to evaluate ARCI comprehensively. For classification purposes, we employ PRAUC, F1, and Jaccard, metrics. To evaluate drug safety, we employ metrics based on drug-drug interaction (DDI) rates, and for ranking, we use Hit@K and NDCG@K with K being the rank. In the following, the formulations are presented:
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS3.p1.17.1">Jaccard</span> measures the similarity between two sets by calculating the ratio of the intersection to the union of ground truth, indicated by equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.E28" title="In 3.3. Evaluation Metrics ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">28</span></a>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E28">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(28)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{ Jaccard }=\frac{1}{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}1}\sum_{p}^{N}%
\sum_{t}^{\hat{T}_{p}}\frac{\left|y_{t}^{(p)}\cap\hat{Y}_{t}^{(p)}\right|}{%
\left|y_{t}^{(p)}\cup\hat{Y}_{t}^{(p)}\right|}" class="ltx_Math" display="block" id="S3.E28.m1.6"><semantics id="S3.E28.m1.6a"><mrow id="S3.E28.m1.6.7" xref="S3.E28.m1.6.7.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E28.m1.6.7.2" xref="S3.E28.m1.6.7.2a.cmml"> Jaccard </mtext><mo id="S3.E28.m1.6.7.1" xref="S3.E28.m1.6.7.1.cmml">=</mo><mrow id="S3.E28.m1.6.7.3" xref="S3.E28.m1.6.7.3.cmml"><mfrac id="S3.E28.m1.6.7.3.2" xref="S3.E28.m1.6.7.3.2.cmml"><mn id="S3.E28.m1.6.7.3.2.2" xref="S3.E28.m1.6.7.3.2.2.cmml">1</mn><mrow id="S3.E28.m1.6.7.3.2.3" xref="S3.E28.m1.6.7.3.2.3.cmml"><msubsup id="S3.E28.m1.6.7.3.2.3.1" xref="S3.E28.m1.6.7.3.2.3.1.cmml"><mo id="S3.E28.m1.6.7.3.2.3.1.2.2" xref="S3.E28.m1.6.7.3.2.3.1.2.2.cmml">∑</mo><mi id="S3.E28.m1.6.7.3.2.3.1.2.3" xref="S3.E28.m1.6.7.3.2.3.1.2.3.cmml">p</mi><mi id="S3.E28.m1.6.7.3.2.3.1.3" xref="S3.E28.m1.6.7.3.2.3.1.3.cmml">N</mi></msubsup><mrow id="S3.E28.m1.6.7.3.2.3.2" xref="S3.E28.m1.6.7.3.2.3.2.cmml"><msubsup id="S3.E28.m1.6.7.3.2.3.2.1" xref="S3.E28.m1.6.7.3.2.3.2.1.cmml"><mo id="S3.E28.m1.6.7.3.2.3.2.1.2.2" lspace="0.167em" xref="S3.E28.m1.6.7.3.2.3.2.1.2.2.cmml">∑</mo><mi id="S3.E28.m1.6.7.3.2.3.2.1.2.3" xref="S3.E28.m1.6.7.3.2.3.2.1.2.3.cmml">t</mi><msub id="S3.E28.m1.6.7.3.2.3.2.1.3" xref="S3.E28.m1.6.7.3.2.3.2.1.3.cmml"><mover accent="true" id="S3.E28.m1.6.7.3.2.3.2.1.3.2" xref="S3.E28.m1.6.7.3.2.3.2.1.3.2.cmml"><mi id="S3.E28.m1.6.7.3.2.3.2.1.3.2.2" xref="S3.E28.m1.6.7.3.2.3.2.1.3.2.2.cmml">T</mi><mo id="S3.E28.m1.6.7.3.2.3.2.1.3.2.1" xref="S3.E28.m1.6.7.3.2.3.2.1.3.2.1.cmml">^</mo></mover><mi id="S3.E28.m1.6.7.3.2.3.2.1.3.3" xref="S3.E28.m1.6.7.3.2.3.2.1.3.3.cmml">p</mi></msub></msubsup><mn id="S3.E28.m1.6.7.3.2.3.2.2" xref="S3.E28.m1.6.7.3.2.3.2.2.cmml">1</mn></mrow></mrow></mfrac><mo id="S3.E28.m1.6.7.3.1" xref="S3.E28.m1.6.7.3.1.cmml">⁢</mo><mrow id="S3.E28.m1.6.7.3.3" xref="S3.E28.m1.6.7.3.3.cmml"><munderover id="S3.E28.m1.6.7.3.3.1" xref="S3.E28.m1.6.7.3.3.1.cmml"><mo id="S3.E28.m1.6.7.3.3.1.2.2" movablelimits="false" rspace="0em" xref="S3.E28.m1.6.7.3.3.1.2.2.cmml">∑</mo><mi id="S3.E28.m1.6.7.3.3.1.2.3" xref="S3.E28.m1.6.7.3.3.1.2.3.cmml">p</mi><mi id="S3.E28.m1.6.7.3.3.1.3" xref="S3.E28.m1.6.7.3.3.1.3.cmml">N</mi></munderover><mrow id="S3.E28.m1.6.7.3.3.2" xref="S3.E28.m1.6.7.3.3.2.cmml"><munderover id="S3.E28.m1.6.7.3.3.2.1" xref="S3.E28.m1.6.7.3.3.2.1.cmml"><mo id="S3.E28.m1.6.7.3.3.2.1.2.2" movablelimits="false" xref="S3.E28.m1.6.7.3.3.2.1.2.2.cmml">∑</mo><mi id="S3.E28.m1.6.7.3.3.2.1.2.3" xref="S3.E28.m1.6.7.3.3.2.1.2.3.cmml">t</mi><msub id="S3.E28.m1.6.7.3.3.2.1.3" xref="S3.E28.m1.6.7.3.3.2.1.3.cmml"><mover accent="true" id="S3.E28.m1.6.7.3.3.2.1.3.2" xref="S3.E28.m1.6.7.3.3.2.1.3.2.cmml"><mi id="S3.E28.m1.6.7.3.3.2.1.3.2.2" xref="S3.E28.m1.6.7.3.3.2.1.3.2.2.cmml">T</mi><mo id="S3.E28.m1.6.7.3.3.2.1.3.2.1" xref="S3.E28.m1.6.7.3.3.2.1.3.2.1.cmml">^</mo></mover><mi id="S3.E28.m1.6.7.3.3.2.1.3.3" xref="S3.E28.m1.6.7.3.3.2.1.3.3.cmml">p</mi></msub></munderover><mfrac id="S3.E28.m1.6.6" xref="S3.E28.m1.6.6.cmml"><mrow id="S3.E28.m1.3.3.3.3" xref="S3.E28.m1.3.3.3.4.cmml"><mo id="S3.E28.m1.3.3.3.3.2" xref="S3.E28.m1.3.3.3.4.1.cmml">|</mo><mrow id="S3.E28.m1.3.3.3.3.1" xref="S3.E28.m1.3.3.3.3.1.cmml"><msubsup id="S3.E28.m1.3.3.3.3.1.2" xref="S3.E28.m1.3.3.3.3.1.2.cmml"><mi id="S3.E28.m1.3.3.3.3.1.2.2.2" xref="S3.E28.m1.3.3.3.3.1.2.2.2.cmml">y</mi><mi id="S3.E28.m1.3.3.3.3.1.2.2.3" xref="S3.E28.m1.3.3.3.3.1.2.2.3.cmml">t</mi><mrow id="S3.E28.m1.1.1.1.1.1.3" xref="S3.E28.m1.3.3.3.3.1.2.cmml"><mo id="S3.E28.m1.1.1.1.1.1.3.1" stretchy="false" xref="S3.E28.m1.3.3.3.3.1.2.cmml">(</mo><mi id="S3.E28.m1.1.1.1.1.1.1" xref="S3.E28.m1.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E28.m1.1.1.1.1.1.3.2" stretchy="false" xref="S3.E28.m1.3.3.3.3.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E28.m1.3.3.3.3.1.1" xref="S3.E28.m1.3.3.3.3.1.1.cmml">∩</mo><msubsup id="S3.E28.m1.3.3.3.3.1.3" xref="S3.E28.m1.3.3.3.3.1.3.cmml"><mover accent="true" id="S3.E28.m1.3.3.3.3.1.3.2.2" xref="S3.E28.m1.3.3.3.3.1.3.2.2.cmml"><mi id="S3.E28.m1.3.3.3.3.1.3.2.2.2" xref="S3.E28.m1.3.3.3.3.1.3.2.2.2.cmml">Y</mi><mo id="S3.E28.m1.3.3.3.3.1.3.2.2.1" xref="S3.E28.m1.3.3.3.3.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E28.m1.3.3.3.3.1.3.2.3" xref="S3.E28.m1.3.3.3.3.1.3.2.3.cmml">t</mi><mrow id="S3.E28.m1.2.2.2.2.1.3" xref="S3.E28.m1.3.3.3.3.1.3.cmml"><mo id="S3.E28.m1.2.2.2.2.1.3.1" stretchy="false" xref="S3.E28.m1.3.3.3.3.1.3.cmml">(</mo><mi id="S3.E28.m1.2.2.2.2.1.1" xref="S3.E28.m1.2.2.2.2.1.1.cmml">p</mi><mo id="S3.E28.m1.2.2.2.2.1.3.2" stretchy="false" xref="S3.E28.m1.3.3.3.3.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E28.m1.3.3.3.3.3" xref="S3.E28.m1.3.3.3.4.1.cmml">|</mo></mrow><mrow id="S3.E28.m1.6.6.6.3" xref="S3.E28.m1.6.6.6.4.cmml"><mo id="S3.E28.m1.6.6.6.3.2" xref="S3.E28.m1.6.6.6.4.1.cmml">|</mo><mrow id="S3.E28.m1.6.6.6.3.1" xref="S3.E28.m1.6.6.6.3.1.cmml"><msubsup id="S3.E28.m1.6.6.6.3.1.2" xref="S3.E28.m1.6.6.6.3.1.2.cmml"><mi id="S3.E28.m1.6.6.6.3.1.2.2.2" xref="S3.E28.m1.6.6.6.3.1.2.2.2.cmml">y</mi><mi id="S3.E28.m1.6.6.6.3.1.2.2.3" xref="S3.E28.m1.6.6.6.3.1.2.2.3.cmml">t</mi><mrow id="S3.E28.m1.4.4.4.1.1.3" xref="S3.E28.m1.6.6.6.3.1.2.cmml"><mo id="S3.E28.m1.4.4.4.1.1.3.1" stretchy="false" xref="S3.E28.m1.6.6.6.3.1.2.cmml">(</mo><mi id="S3.E28.m1.4.4.4.1.1.1" xref="S3.E28.m1.4.4.4.1.1.1.cmml">p</mi><mo id="S3.E28.m1.4.4.4.1.1.3.2" stretchy="false" xref="S3.E28.m1.6.6.6.3.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E28.m1.6.6.6.3.1.1" xref="S3.E28.m1.6.6.6.3.1.1.cmml">∪</mo><msubsup id="S3.E28.m1.6.6.6.3.1.3" xref="S3.E28.m1.6.6.6.3.1.3.cmml"><mover accent="true" id="S3.E28.m1.6.6.6.3.1.3.2.2" xref="S3.E28.m1.6.6.6.3.1.3.2.2.cmml"><mi id="S3.E28.m1.6.6.6.3.1.3.2.2.2" xref="S3.E28.m1.6.6.6.3.1.3.2.2.2.cmml">Y</mi><mo id="S3.E28.m1.6.6.6.3.1.3.2.2.1" xref="S3.E28.m1.6.6.6.3.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E28.m1.6.6.6.3.1.3.2.3" xref="S3.E28.m1.6.6.6.3.1.3.2.3.cmml">t</mi><mrow id="S3.E28.m1.5.5.5.2.1.3" xref="S3.E28.m1.6.6.6.3.1.3.cmml"><mo id="S3.E28.m1.5.5.5.2.1.3.1" stretchy="false" xref="S3.E28.m1.6.6.6.3.1.3.cmml">(</mo><mi id="S3.E28.m1.5.5.5.2.1.1" xref="S3.E28.m1.5.5.5.2.1.1.cmml">p</mi><mo id="S3.E28.m1.5.5.5.2.1.3.2" stretchy="false" xref="S3.E28.m1.6.6.6.3.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E28.m1.6.6.6.3.3" xref="S3.E28.m1.6.6.6.4.1.cmml">|</mo></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E28.m1.6b"><apply id="S3.E28.m1.6.7.cmml" xref="S3.E28.m1.6.7"><eq id="S3.E28.m1.6.7.1.cmml" xref="S3.E28.m1.6.7.1"></eq><ci id="S3.E28.m1.6.7.2a.cmml" xref="S3.E28.m1.6.7.2"><mtext class="ltx_mathvariant_bold" id="S3.E28.m1.6.7.2.cmml" xref="S3.E28.m1.6.7.2"> Jaccard </mtext></ci><apply id="S3.E28.m1.6.7.3.cmml" xref="S3.E28.m1.6.7.3"><times id="S3.E28.m1.6.7.3.1.cmml" xref="S3.E28.m1.6.7.3.1"></times><apply id="S3.E28.m1.6.7.3.2.cmml" xref="S3.E28.m1.6.7.3.2"><divide id="S3.E28.m1.6.7.3.2.1.cmml" xref="S3.E28.m1.6.7.3.2"></divide><cn id="S3.E28.m1.6.7.3.2.2.cmml" type="integer" xref="S3.E28.m1.6.7.3.2.2">1</cn><apply id="S3.E28.m1.6.7.3.2.3.cmml" xref="S3.E28.m1.6.7.3.2.3"><apply id="S3.E28.m1.6.7.3.2.3.1.cmml" xref="S3.E28.m1.6.7.3.2.3.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.2.3.1.1.cmml" xref="S3.E28.m1.6.7.3.2.3.1">superscript</csymbol><apply id="S3.E28.m1.6.7.3.2.3.1.2.cmml" xref="S3.E28.m1.6.7.3.2.3.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.2.3.1.2.1.cmml" xref="S3.E28.m1.6.7.3.2.3.1">subscript</csymbol><sum id="S3.E28.m1.6.7.3.2.3.1.2.2.cmml" xref="S3.E28.m1.6.7.3.2.3.1.2.2"></sum><ci id="S3.E28.m1.6.7.3.2.3.1.2.3.cmml" xref="S3.E28.m1.6.7.3.2.3.1.2.3">𝑝</ci></apply><ci id="S3.E28.m1.6.7.3.2.3.1.3.cmml" xref="S3.E28.m1.6.7.3.2.3.1.3">𝑁</ci></apply><apply id="S3.E28.m1.6.7.3.2.3.2.cmml" xref="S3.E28.m1.6.7.3.2.3.2"><apply id="S3.E28.m1.6.7.3.2.3.2.1.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.2.3.2.1.1.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1">superscript</csymbol><apply id="S3.E28.m1.6.7.3.2.3.2.1.2.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.2.3.2.1.2.1.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1">subscript</csymbol><sum id="S3.E28.m1.6.7.3.2.3.2.1.2.2.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.2.2"></sum><ci id="S3.E28.m1.6.7.3.2.3.2.1.2.3.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.2.3">𝑡</ci></apply><apply id="S3.E28.m1.6.7.3.2.3.2.1.3.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.3"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.2.3.2.1.3.1.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.3">subscript</csymbol><apply id="S3.E28.m1.6.7.3.2.3.2.1.3.2.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.3.2"><ci id="S3.E28.m1.6.7.3.2.3.2.1.3.2.1.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.3.2.1">^</ci><ci id="S3.E28.m1.6.7.3.2.3.2.1.3.2.2.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.3.2.2">𝑇</ci></apply><ci id="S3.E28.m1.6.7.3.2.3.2.1.3.3.cmml" xref="S3.E28.m1.6.7.3.2.3.2.1.3.3">𝑝</ci></apply></apply><cn id="S3.E28.m1.6.7.3.2.3.2.2.cmml" type="integer" xref="S3.E28.m1.6.7.3.2.3.2.2">1</cn></apply></apply></apply><apply id="S3.E28.m1.6.7.3.3.cmml" xref="S3.E28.m1.6.7.3.3"><apply id="S3.E28.m1.6.7.3.3.1.cmml" xref="S3.E28.m1.6.7.3.3.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.3.1.1.cmml" xref="S3.E28.m1.6.7.3.3.1">superscript</csymbol><apply id="S3.E28.m1.6.7.3.3.1.2.cmml" xref="S3.E28.m1.6.7.3.3.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.3.1.2.1.cmml" xref="S3.E28.m1.6.7.3.3.1">subscript</csymbol><sum id="S3.E28.m1.6.7.3.3.1.2.2.cmml" xref="S3.E28.m1.6.7.3.3.1.2.2"></sum><ci id="S3.E28.m1.6.7.3.3.1.2.3.cmml" xref="S3.E28.m1.6.7.3.3.1.2.3">𝑝</ci></apply><ci id="S3.E28.m1.6.7.3.3.1.3.cmml" xref="S3.E28.m1.6.7.3.3.1.3">𝑁</ci></apply><apply id="S3.E28.m1.6.7.3.3.2.cmml" xref="S3.E28.m1.6.7.3.3.2"><apply id="S3.E28.m1.6.7.3.3.2.1.cmml" xref="S3.E28.m1.6.7.3.3.2.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.3.2.1.1.cmml" xref="S3.E28.m1.6.7.3.3.2.1">superscript</csymbol><apply id="S3.E28.m1.6.7.3.3.2.1.2.cmml" xref="S3.E28.m1.6.7.3.3.2.1"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.3.2.1.2.1.cmml" xref="S3.E28.m1.6.7.3.3.2.1">subscript</csymbol><sum id="S3.E28.m1.6.7.3.3.2.1.2.2.cmml" xref="S3.E28.m1.6.7.3.3.2.1.2.2"></sum><ci id="S3.E28.m1.6.7.3.3.2.1.2.3.cmml" xref="S3.E28.m1.6.7.3.3.2.1.2.3">𝑡</ci></apply><apply id="S3.E28.m1.6.7.3.3.2.1.3.cmml" xref="S3.E28.m1.6.7.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E28.m1.6.7.3.3.2.1.3.1.cmml" xref="S3.E28.m1.6.7.3.3.2.1.3">subscript</csymbol><apply id="S3.E28.m1.6.7.3.3.2.1.3.2.cmml" xref="S3.E28.m1.6.7.3.3.2.1.3.2"><ci id="S3.E28.m1.6.7.3.3.2.1.3.2.1.cmml" xref="S3.E28.m1.6.7.3.3.2.1.3.2.1">^</ci><ci id="S3.E28.m1.6.7.3.3.2.1.3.2.2.cmml" xref="S3.E28.m1.6.7.3.3.2.1.3.2.2">𝑇</ci></apply><ci id="S3.E28.m1.6.7.3.3.2.1.3.3.cmml" xref="S3.E28.m1.6.7.3.3.2.1.3.3">𝑝</ci></apply></apply><apply id="S3.E28.m1.6.6.cmml" xref="S3.E28.m1.6.6"><divide id="S3.E28.m1.6.6.7.cmml" xref="S3.E28.m1.6.6"></divide><apply id="S3.E28.m1.3.3.3.4.cmml" xref="S3.E28.m1.3.3.3.3"><abs id="S3.E28.m1.3.3.3.4.1.cmml" xref="S3.E28.m1.3.3.3.3.2"></abs><apply id="S3.E28.m1.3.3.3.3.1.cmml" xref="S3.E28.m1.3.3.3.3.1"><intersect id="S3.E28.m1.3.3.3.3.1.1.cmml" xref="S3.E28.m1.3.3.3.3.1.1"></intersect><apply id="S3.E28.m1.3.3.3.3.1.2.cmml" xref="S3.E28.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E28.m1.3.3.3.3.1.2.1.cmml" xref="S3.E28.m1.3.3.3.3.1.2">superscript</csymbol><apply id="S3.E28.m1.3.3.3.3.1.2.2.cmml" xref="S3.E28.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E28.m1.3.3.3.3.1.2.2.1.cmml" xref="S3.E28.m1.3.3.3.3.1.2">subscript</csymbol><ci id="S3.E28.m1.3.3.3.3.1.2.2.2.cmml" xref="S3.E28.m1.3.3.3.3.1.2.2.2">𝑦</ci><ci id="S3.E28.m1.3.3.3.3.1.2.2.3.cmml" xref="S3.E28.m1.3.3.3.3.1.2.2.3">𝑡</ci></apply><ci id="S3.E28.m1.1.1.1.1.1.1.cmml" xref="S3.E28.m1.1.1.1.1.1.1">𝑝</ci></apply><apply id="S3.E28.m1.3.3.3.3.1.3.cmml" xref="S3.E28.m1.3.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E28.m1.3.3.3.3.1.3.1.cmml" xref="S3.E28.m1.3.3.3.3.1.3">superscript</csymbol><apply id="S3.E28.m1.3.3.3.3.1.3.2.cmml" xref="S3.E28.m1.3.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E28.m1.3.3.3.3.1.3.2.1.cmml" xref="S3.E28.m1.3.3.3.3.1.3">subscript</csymbol><apply id="S3.E28.m1.3.3.3.3.1.3.2.2.cmml" xref="S3.E28.m1.3.3.3.3.1.3.2.2"><ci id="S3.E28.m1.3.3.3.3.1.3.2.2.1.cmml" xref="S3.E28.m1.3.3.3.3.1.3.2.2.1">^</ci><ci id="S3.E28.m1.3.3.3.3.1.3.2.2.2.cmml" xref="S3.E28.m1.3.3.3.3.1.3.2.2.2">𝑌</ci></apply><ci id="S3.E28.m1.3.3.3.3.1.3.2.3.cmml" xref="S3.E28.m1.3.3.3.3.1.3.2.3">𝑡</ci></apply><ci id="S3.E28.m1.2.2.2.2.1.1.cmml" xref="S3.E28.m1.2.2.2.2.1.1">𝑝</ci></apply></apply></apply><apply id="S3.E28.m1.6.6.6.4.cmml" xref="S3.E28.m1.6.6.6.3"><abs id="S3.E28.m1.6.6.6.4.1.cmml" xref="S3.E28.m1.6.6.6.3.2"></abs><apply id="S3.E28.m1.6.6.6.3.1.cmml" xref="S3.E28.m1.6.6.6.3.1"><union id="S3.E28.m1.6.6.6.3.1.1.cmml" xref="S3.E28.m1.6.6.6.3.1.1"></union><apply id="S3.E28.m1.6.6.6.3.1.2.cmml" xref="S3.E28.m1.6.6.6.3.1.2"><csymbol cd="ambiguous" id="S3.E28.m1.6.6.6.3.1.2.1.cmml" xref="S3.E28.m1.6.6.6.3.1.2">superscript</csymbol><apply id="S3.E28.m1.6.6.6.3.1.2.2.cmml" xref="S3.E28.m1.6.6.6.3.1.2"><csymbol cd="ambiguous" id="S3.E28.m1.6.6.6.3.1.2.2.1.cmml" xref="S3.E28.m1.6.6.6.3.1.2">subscript</csymbol><ci id="S3.E28.m1.6.6.6.3.1.2.2.2.cmml" xref="S3.E28.m1.6.6.6.3.1.2.2.2">𝑦</ci><ci id="S3.E28.m1.6.6.6.3.1.2.2.3.cmml" xref="S3.E28.m1.6.6.6.3.1.2.2.3">𝑡</ci></apply><ci id="S3.E28.m1.4.4.4.1.1.1.cmml" xref="S3.E28.m1.4.4.4.1.1.1">𝑝</ci></apply><apply id="S3.E28.m1.6.6.6.3.1.3.cmml" xref="S3.E28.m1.6.6.6.3.1.3"><csymbol cd="ambiguous" id="S3.E28.m1.6.6.6.3.1.3.1.cmml" xref="S3.E28.m1.6.6.6.3.1.3">superscript</csymbol><apply id="S3.E28.m1.6.6.6.3.1.3.2.cmml" xref="S3.E28.m1.6.6.6.3.1.3"><csymbol cd="ambiguous" id="S3.E28.m1.6.6.6.3.1.3.2.1.cmml" xref="S3.E28.m1.6.6.6.3.1.3">subscript</csymbol><apply id="S3.E28.m1.6.6.6.3.1.3.2.2.cmml" xref="S3.E28.m1.6.6.6.3.1.3.2.2"><ci id="S3.E28.m1.6.6.6.3.1.3.2.2.1.cmml" xref="S3.E28.m1.6.6.6.3.1.3.2.2.1">^</ci><ci id="S3.E28.m1.6.6.6.3.1.3.2.2.2.cmml" xref="S3.E28.m1.6.6.6.3.1.3.2.2.2">𝑌</ci></apply><ci id="S3.E28.m1.6.6.6.3.1.3.2.3.cmml" xref="S3.E28.m1.6.6.6.3.1.3.2.3">𝑡</ci></apply><ci id="S3.E28.m1.5.5.5.2.1.1.cmml" xref="S3.E28.m1.5.5.5.2.1.1">𝑝</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E28.m1.6c">\textbf{ Jaccard }=\frac{1}{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}1}\sum_{p}^{N}%
\sum_{t}^{\hat{T}_{p}}\frac{\left|y_{t}^{(p)}\cap\hat{Y}_{t}^{(p)}\right|}{%
\left|y_{t}^{(p)}\cup\hat{Y}_{t}^{(p)}\right|}</annotation><annotation encoding="application/x-llamapun" id="S3.E28.m1.6d">Jaccard = divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT 1 end_ARG ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG | italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT ∩ over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT | end_ARG start_ARG | italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT ∪ over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.10">where, <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_N</annotation></semantics></math> equals to the total number of patients, <math alttext="\hat{T}_{p}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">T</mi><mo id="S3.SS3.p1.2.m2.1.1.2.1" xref="S3.SS3.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"><ci id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.1">^</ci><ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">𝑇</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\hat{T}_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> denotes the number of visits to predict for patient <math alttext="p" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_p</annotation></semantics></math>, <math alttext="{y}_{t}^{(p)}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msubsup id="S3.SS3.p1.4.m4.1.2" xref="S3.SS3.p1.4.m4.1.2.cmml"><mi id="S3.SS3.p1.4.m4.1.2.2.2" xref="S3.SS3.p1.4.m4.1.2.2.2.cmml">y</mi><mi id="S3.SS3.p1.4.m4.1.2.2.3" xref="S3.SS3.p1.4.m4.1.2.2.3.cmml">t</mi><mrow id="S3.SS3.p1.4.m4.1.1.1.3" xref="S3.SS3.p1.4.m4.1.2.cmml"><mo id="S3.SS3.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p1.4.m4.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.2.cmml" xref="S3.SS3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.2">superscript</csymbol><apply id="S3.SS3.p1.4.m4.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.2.2.1.cmml" xref="S3.SS3.p1.4.m4.1.2">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.2.2.2.cmml" xref="S3.SS3.p1.4.m4.1.2.2.2">𝑦</ci><ci id="S3.SS3.p1.4.m4.1.2.2.3.cmml" xref="S3.SS3.p1.4.m4.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">{y}_{t}^{(p)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT</annotation></semantics></math> to ground truth medications for patient <math alttext="p" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_p</annotation></semantics></math> at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_t</annotation></semantics></math>, and <math alttext="\hat{Y}_{t}^{(p)}=\{\hat{y}_{t}^{(p)}&gt;\theta\}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.3"><semantics id="S3.SS3.p1.7.m7.3a"><mrow id="S3.SS3.p1.7.m7.3.3" xref="S3.SS3.p1.7.m7.3.3.cmml"><msubsup id="S3.SS3.p1.7.m7.3.3.3" xref="S3.SS3.p1.7.m7.3.3.3.cmml"><mover accent="true" id="S3.SS3.p1.7.m7.3.3.3.2.2" xref="S3.SS3.p1.7.m7.3.3.3.2.2.cmml"><mi id="S3.SS3.p1.7.m7.3.3.3.2.2.2" xref="S3.SS3.p1.7.m7.3.3.3.2.2.2.cmml">Y</mi><mo id="S3.SS3.p1.7.m7.3.3.3.2.2.1" xref="S3.SS3.p1.7.m7.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.7.m7.3.3.3.2.3" xref="S3.SS3.p1.7.m7.3.3.3.2.3.cmml">t</mi><mrow id="S3.SS3.p1.7.m7.1.1.1.3" xref="S3.SS3.p1.7.m7.3.3.3.cmml"><mo id="S3.SS3.p1.7.m7.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.3.cmml">(</mo><mi id="S3.SS3.p1.7.m7.1.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p1.7.m7.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.7.m7.3.3.2" xref="S3.SS3.p1.7.m7.3.3.2.cmml">=</mo><mrow id="S3.SS3.p1.7.m7.3.3.1.1" xref="S3.SS3.p1.7.m7.3.3.1.2.cmml"><mo id="S3.SS3.p1.7.m7.3.3.1.1.2" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.1.2.cmml">{</mo><mrow id="S3.SS3.p1.7.m7.3.3.1.1.1" xref="S3.SS3.p1.7.m7.3.3.1.1.1.cmml"><msubsup id="S3.SS3.p1.7.m7.3.3.1.1.1.2" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.cmml"><mover accent="true" id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.cmml"><mi id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.2" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.2.cmml">y</mi><mo id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.1" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.3" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.3.cmml">t</mi><mrow id="S3.SS3.p1.7.m7.2.2.1.3" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.cmml"><mo id="S3.SS3.p1.7.m7.2.2.1.3.1" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p1.7.m7.2.2.1.1" xref="S3.SS3.p1.7.m7.2.2.1.1.cmml">p</mi><mo id="S3.SS3.p1.7.m7.2.2.1.3.2" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.7.m7.3.3.1.1.1.1" xref="S3.SS3.p1.7.m7.3.3.1.1.1.1.cmml">&gt;</mo><mi id="S3.SS3.p1.7.m7.3.3.1.1.1.3" xref="S3.SS3.p1.7.m7.3.3.1.1.1.3.cmml">θ</mi></mrow><mo id="S3.SS3.p1.7.m7.3.3.1.1.3" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.3b"><apply id="S3.SS3.p1.7.m7.3.3.cmml" xref="S3.SS3.p1.7.m7.3.3"><eq id="S3.SS3.p1.7.m7.3.3.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2"></eq><apply id="S3.SS3.p1.7.m7.3.3.3.cmml" xref="S3.SS3.p1.7.m7.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.3.3.3.1.cmml" xref="S3.SS3.p1.7.m7.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.7.m7.3.3.3.2.cmml" xref="S3.SS3.p1.7.m7.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.3.3.3.2.1.cmml" xref="S3.SS3.p1.7.m7.3.3.3">subscript</csymbol><apply id="S3.SS3.p1.7.m7.3.3.3.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.3.2.2"><ci id="S3.SS3.p1.7.m7.3.3.3.2.2.1.cmml" xref="S3.SS3.p1.7.m7.3.3.3.2.2.1">^</ci><ci id="S3.SS3.p1.7.m7.3.3.3.2.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.3.2.2.2">𝑌</ci></apply><ci id="S3.SS3.p1.7.m7.3.3.3.2.3.cmml" xref="S3.SS3.p1.7.m7.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.7.m7.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1">𝑝</ci></apply><set id="S3.SS3.p1.7.m7.3.3.1.2.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1"><apply id="S3.SS3.p1.7.m7.3.3.1.1.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1"><gt id="S3.SS3.p1.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.1"></gt><apply id="S3.SS3.p1.7.m7.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2">subscript</csymbol><apply id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2"><ci id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.1.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.1">^</ci><ci id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.2.2">𝑦</ci></apply><ci id="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.7.m7.2.2.1.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1">𝑝</ci></apply><ci id="S3.SS3.p1.7.m7.3.3.1.1.1.3.cmml" xref="S3.SS3.p1.7.m7.3.3.1.1.1.3">𝜃</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.3c">\hat{Y}_{t}^{(p)}=\{\hat{y}_{t}^{(p)}&gt;\theta\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.3d">over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT = { over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT &gt; italic_θ }</annotation></semantics></math> where <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">italic_θ</annotation></semantics></math> denotes a threshold, chosen through a greedy search approach from values from 0 to 1 with intervals of 0.1, relying on the performance metrics evaluated on the test dataset. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS3.p1.10.1">F1</span> score is derived from Precision and Recall, where <math alttext="Precision=|y_{t}^{(p)}\cap\hat{Y}_{t}^{(p)}|/|y_{t}^{(p)}|" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.5"><semantics id="S3.SS3.p1.9.m9.5a"><mrow id="S3.SS3.p1.9.m9.5.5" xref="S3.SS3.p1.9.m9.5.5.cmml"><mrow id="S3.SS3.p1.9.m9.5.5.4" xref="S3.SS3.p1.9.m9.5.5.4.cmml"><mi id="S3.SS3.p1.9.m9.5.5.4.2" xref="S3.SS3.p1.9.m9.5.5.4.2.cmml">P</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.3" xref="S3.SS3.p1.9.m9.5.5.4.3.cmml">r</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1a" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.4" xref="S3.SS3.p1.9.m9.5.5.4.4.cmml">e</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1b" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.5" xref="S3.SS3.p1.9.m9.5.5.4.5.cmml">c</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1c" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.6" xref="S3.SS3.p1.9.m9.5.5.4.6.cmml">i</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1d" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.7" xref="S3.SS3.p1.9.m9.5.5.4.7.cmml">s</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1e" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.8" xref="S3.SS3.p1.9.m9.5.5.4.8.cmml">i</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1f" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.9" xref="S3.SS3.p1.9.m9.5.5.4.9.cmml">o</mi><mo id="S3.SS3.p1.9.m9.5.5.4.1g" xref="S3.SS3.p1.9.m9.5.5.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.9.m9.5.5.4.10" xref="S3.SS3.p1.9.m9.5.5.4.10.cmml">n</mi></mrow><mo id="S3.SS3.p1.9.m9.5.5.3" xref="S3.SS3.p1.9.m9.5.5.3.cmml">=</mo><mrow id="S3.SS3.p1.9.m9.5.5.2" xref="S3.SS3.p1.9.m9.5.5.2.cmml"><mrow id="S3.SS3.p1.9.m9.4.4.1.1.1" xref="S3.SS3.p1.9.m9.4.4.1.1.2.cmml"><mo id="S3.SS3.p1.9.m9.4.4.1.1.1.2" stretchy="false" xref="S3.SS3.p1.9.m9.4.4.1.1.2.1.cmml">|</mo><mrow id="S3.SS3.p1.9.m9.4.4.1.1.1.1" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.2" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.3" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.3.cmml">t</mi><mrow id="S3.SS3.p1.9.m9.1.1.1.3" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.cmml"><mo id="S3.SS3.p1.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p1.9.m9.1.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p1.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.9.m9.4.4.1.1.1.1.1" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.1.cmml">∩</mo><msubsup id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.cmml"><mi id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.2" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.2.cmml">Y</mi><mo id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.1" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.3" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.3.cmml">t</mi><mrow id="S3.SS3.p1.9.m9.2.2.1.3" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.cmml"><mo id="S3.SS3.p1.9.m9.2.2.1.3.1" stretchy="false" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p1.9.m9.2.2.1.1" xref="S3.SS3.p1.9.m9.2.2.1.1.cmml">p</mi><mo id="S3.SS3.p1.9.m9.2.2.1.3.2" stretchy="false" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS3.p1.9.m9.4.4.1.1.1.3" stretchy="false" xref="S3.SS3.p1.9.m9.4.4.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.9.m9.5.5.2.3" xref="S3.SS3.p1.9.m9.5.5.2.3.cmml">/</mo><mrow id="S3.SS3.p1.9.m9.5.5.2.2.1" xref="S3.SS3.p1.9.m9.5.5.2.2.2.cmml"><mo id="S3.SS3.p1.9.m9.5.5.2.2.1.2" stretchy="false" xref="S3.SS3.p1.9.m9.5.5.2.2.2.1.cmml">|</mo><msubsup id="S3.SS3.p1.9.m9.5.5.2.2.1.1" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.cmml"><mi id="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.2" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.2.cmml">y</mi><mi id="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.3" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p1.9.m9.3.3.1.3" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.cmml"><mo id="S3.SS3.p1.9.m9.3.3.1.3.1" stretchy="false" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.cmml">(</mo><mi id="S3.SS3.p1.9.m9.3.3.1.1" xref="S3.SS3.p1.9.m9.3.3.1.1.cmml">p</mi><mo id="S3.SS3.p1.9.m9.3.3.1.3.2" stretchy="false" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.9.m9.5.5.2.2.1.3" stretchy="false" xref="S3.SS3.p1.9.m9.5.5.2.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.5b"><apply id="S3.SS3.p1.9.m9.5.5.cmml" xref="S3.SS3.p1.9.m9.5.5"><eq id="S3.SS3.p1.9.m9.5.5.3.cmml" xref="S3.SS3.p1.9.m9.5.5.3"></eq><apply id="S3.SS3.p1.9.m9.5.5.4.cmml" xref="S3.SS3.p1.9.m9.5.5.4"><times id="S3.SS3.p1.9.m9.5.5.4.1.cmml" xref="S3.SS3.p1.9.m9.5.5.4.1"></times><ci id="S3.SS3.p1.9.m9.5.5.4.2.cmml" xref="S3.SS3.p1.9.m9.5.5.4.2">𝑃</ci><ci id="S3.SS3.p1.9.m9.5.5.4.3.cmml" xref="S3.SS3.p1.9.m9.5.5.4.3">𝑟</ci><ci id="S3.SS3.p1.9.m9.5.5.4.4.cmml" xref="S3.SS3.p1.9.m9.5.5.4.4">𝑒</ci><ci id="S3.SS3.p1.9.m9.5.5.4.5.cmml" xref="S3.SS3.p1.9.m9.5.5.4.5">𝑐</ci><ci id="S3.SS3.p1.9.m9.5.5.4.6.cmml" xref="S3.SS3.p1.9.m9.5.5.4.6">𝑖</ci><ci id="S3.SS3.p1.9.m9.5.5.4.7.cmml" xref="S3.SS3.p1.9.m9.5.5.4.7">𝑠</ci><ci id="S3.SS3.p1.9.m9.5.5.4.8.cmml" xref="S3.SS3.p1.9.m9.5.5.4.8">𝑖</ci><ci id="S3.SS3.p1.9.m9.5.5.4.9.cmml" xref="S3.SS3.p1.9.m9.5.5.4.9">𝑜</ci><ci id="S3.SS3.p1.9.m9.5.5.4.10.cmml" xref="S3.SS3.p1.9.m9.5.5.4.10">𝑛</ci></apply><apply id="S3.SS3.p1.9.m9.5.5.2.cmml" xref="S3.SS3.p1.9.m9.5.5.2"><divide id="S3.SS3.p1.9.m9.5.5.2.3.cmml" xref="S3.SS3.p1.9.m9.5.5.2.3"></divide><apply id="S3.SS3.p1.9.m9.4.4.1.1.2.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1"><abs id="S3.SS3.p1.9.m9.4.4.1.1.2.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.2"></abs><apply id="S3.SS3.p1.9.m9.4.4.1.1.1.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1"><intersect id="S3.SS3.p1.9.m9.4.4.1.1.1.1.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.1"></intersect><apply id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.9.m9.1.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1.1">𝑝</ci></apply><apply id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3">superscript</csymbol><apply id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2"><ci id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.1.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.1">^</ci><ci id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.2.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.2.2">𝑌</ci></apply><ci id="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p1.9.m9.4.4.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.9.m9.2.2.1.1.cmml" xref="S3.SS3.p1.9.m9.2.2.1.1">𝑝</ci></apply></apply></apply><apply id="S3.SS3.p1.9.m9.5.5.2.2.2.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1"><abs id="S3.SS3.p1.9.m9.5.5.2.2.2.1.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1.2"></abs><apply id="S3.SS3.p1.9.m9.5.5.2.2.1.1.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.5.5.2.2.1.1.1.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1">superscript</csymbol><apply id="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.1.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.2.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.2">𝑦</ci><ci id="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.3.cmml" xref="S3.SS3.p1.9.m9.5.5.2.2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.9.m9.3.3.1.1.cmml" xref="S3.SS3.p1.9.m9.3.3.1.1">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.5c">Precision=|y_{t}^{(p)}\cap\hat{Y}_{t}^{(p)}|/|y_{t}^{(p)}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.5d">italic_P italic_r italic_e italic_c italic_i italic_s italic_i italic_o italic_n = | italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT ∩ over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT | / | italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT |</annotation></semantics></math> and <math alttext="Recall_{t}^{(p)}=|y_{t}^{(p)}\cap\hat{Y}_{t}^{(p)}|/|\hat{Y}_{t}^{(p)}|" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.6"><semantics id="S3.SS3.p1.10.m10.6a"><mrow id="S3.SS3.p1.10.m10.6.6" xref="S3.SS3.p1.10.m10.6.6.cmml"><mrow id="S3.SS3.p1.10.m10.6.6.4" xref="S3.SS3.p1.10.m10.6.6.4.cmml"><mi id="S3.SS3.p1.10.m10.6.6.4.2" xref="S3.SS3.p1.10.m10.6.6.4.2.cmml">R</mi><mo id="S3.SS3.p1.10.m10.6.6.4.1" xref="S3.SS3.p1.10.m10.6.6.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.10.m10.6.6.4.3" xref="S3.SS3.p1.10.m10.6.6.4.3.cmml">e</mi><mo id="S3.SS3.p1.10.m10.6.6.4.1a" xref="S3.SS3.p1.10.m10.6.6.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.10.m10.6.6.4.4" xref="S3.SS3.p1.10.m10.6.6.4.4.cmml">c</mi><mo id="S3.SS3.p1.10.m10.6.6.4.1b" xref="S3.SS3.p1.10.m10.6.6.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.10.m10.6.6.4.5" xref="S3.SS3.p1.10.m10.6.6.4.5.cmml">a</mi><mo id="S3.SS3.p1.10.m10.6.6.4.1c" xref="S3.SS3.p1.10.m10.6.6.4.1.cmml">⁢</mo><mi id="S3.SS3.p1.10.m10.6.6.4.6" xref="S3.SS3.p1.10.m10.6.6.4.6.cmml">l</mi><mo id="S3.SS3.p1.10.m10.6.6.4.1d" xref="S3.SS3.p1.10.m10.6.6.4.1.cmml">⁢</mo><msubsup id="S3.SS3.p1.10.m10.6.6.4.7" xref="S3.SS3.p1.10.m10.6.6.4.7.cmml"><mi id="S3.SS3.p1.10.m10.6.6.4.7.2.2" xref="S3.SS3.p1.10.m10.6.6.4.7.2.2.cmml">l</mi><mi id="S3.SS3.p1.10.m10.6.6.4.7.2.3" xref="S3.SS3.p1.10.m10.6.6.4.7.2.3.cmml">t</mi><mrow id="S3.SS3.p1.10.m10.1.1.1.3" xref="S3.SS3.p1.10.m10.6.6.4.7.cmml"><mo id="S3.SS3.p1.10.m10.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.10.m10.6.6.4.7.cmml">(</mo><mi id="S3.SS3.p1.10.m10.1.1.1.1" xref="S3.SS3.p1.10.m10.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p1.10.m10.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.10.m10.6.6.4.7.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS3.p1.10.m10.6.6.3" xref="S3.SS3.p1.10.m10.6.6.3.cmml">=</mo><mrow id="S3.SS3.p1.10.m10.6.6.2" xref="S3.SS3.p1.10.m10.6.6.2.cmml"><mrow id="S3.SS3.p1.10.m10.5.5.1.1.1" xref="S3.SS3.p1.10.m10.5.5.1.1.2.cmml"><mo id="S3.SS3.p1.10.m10.5.5.1.1.1.2" stretchy="false" xref="S3.SS3.p1.10.m10.5.5.1.1.2.1.cmml">|</mo><mrow id="S3.SS3.p1.10.m10.5.5.1.1.1.1" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.cmml"><msubsup id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.cmml"><mi id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.2" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.3" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.3.cmml">t</mi><mrow id="S3.SS3.p1.10.m10.2.2.1.3" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.cmml"><mo id="S3.SS3.p1.10.m10.2.2.1.3.1" stretchy="false" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p1.10.m10.2.2.1.1" xref="S3.SS3.p1.10.m10.2.2.1.1.cmml">p</mi><mo id="S3.SS3.p1.10.m10.2.2.1.3.2" stretchy="false" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.10.m10.5.5.1.1.1.1.1" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.1.cmml">∩</mo><msubsup id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.cmml"><mover accent="true" id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.cmml"><mi id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.2" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.2.cmml">Y</mi><mo id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.1" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.3" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.3.cmml">t</mi><mrow id="S3.SS3.p1.10.m10.3.3.1.3" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.cmml"><mo id="S3.SS3.p1.10.m10.3.3.1.3.1" stretchy="false" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p1.10.m10.3.3.1.1" xref="S3.SS3.p1.10.m10.3.3.1.1.cmml">p</mi><mo id="S3.SS3.p1.10.m10.3.3.1.3.2" stretchy="false" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS3.p1.10.m10.5.5.1.1.1.3" stretchy="false" xref="S3.SS3.p1.10.m10.5.5.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS3.p1.10.m10.6.6.2.3" xref="S3.SS3.p1.10.m10.6.6.2.3.cmml">/</mo><mrow id="S3.SS3.p1.10.m10.6.6.2.2.1" xref="S3.SS3.p1.10.m10.6.6.2.2.2.cmml"><mo id="S3.SS3.p1.10.m10.6.6.2.2.1.2" stretchy="false" xref="S3.SS3.p1.10.m10.6.6.2.2.2.1.cmml">|</mo><msubsup id="S3.SS3.p1.10.m10.6.6.2.2.1.1" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.cmml"><mover accent="true" id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.cmml"><mi id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.2" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.2.cmml">Y</mi><mo id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.1" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.3" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p1.10.m10.4.4.1.3" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.cmml"><mo id="S3.SS3.p1.10.m10.4.4.1.3.1" stretchy="false" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.cmml">(</mo><mi id="S3.SS3.p1.10.m10.4.4.1.1" xref="S3.SS3.p1.10.m10.4.4.1.1.cmml">p</mi><mo id="S3.SS3.p1.10.m10.4.4.1.3.2" stretchy="false" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p1.10.m10.6.6.2.2.1.3" stretchy="false" xref="S3.SS3.p1.10.m10.6.6.2.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.6b"><apply id="S3.SS3.p1.10.m10.6.6.cmml" xref="S3.SS3.p1.10.m10.6.6"><eq id="S3.SS3.p1.10.m10.6.6.3.cmml" xref="S3.SS3.p1.10.m10.6.6.3"></eq><apply id="S3.SS3.p1.10.m10.6.6.4.cmml" xref="S3.SS3.p1.10.m10.6.6.4"><times id="S3.SS3.p1.10.m10.6.6.4.1.cmml" xref="S3.SS3.p1.10.m10.6.6.4.1"></times><ci id="S3.SS3.p1.10.m10.6.6.4.2.cmml" xref="S3.SS3.p1.10.m10.6.6.4.2">𝑅</ci><ci id="S3.SS3.p1.10.m10.6.6.4.3.cmml" xref="S3.SS3.p1.10.m10.6.6.4.3">𝑒</ci><ci id="S3.SS3.p1.10.m10.6.6.4.4.cmml" xref="S3.SS3.p1.10.m10.6.6.4.4">𝑐</ci><ci id="S3.SS3.p1.10.m10.6.6.4.5.cmml" xref="S3.SS3.p1.10.m10.6.6.4.5">𝑎</ci><ci id="S3.SS3.p1.10.m10.6.6.4.6.cmml" xref="S3.SS3.p1.10.m10.6.6.4.6">𝑙</ci><apply id="S3.SS3.p1.10.m10.6.6.4.7.cmml" xref="S3.SS3.p1.10.m10.6.6.4.7"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.6.6.4.7.1.cmml" xref="S3.SS3.p1.10.m10.6.6.4.7">superscript</csymbol><apply id="S3.SS3.p1.10.m10.6.6.4.7.2.cmml" xref="S3.SS3.p1.10.m10.6.6.4.7"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.6.6.4.7.2.1.cmml" xref="S3.SS3.p1.10.m10.6.6.4.7">subscript</csymbol><ci id="S3.SS3.p1.10.m10.6.6.4.7.2.2.cmml" xref="S3.SS3.p1.10.m10.6.6.4.7.2.2">𝑙</ci><ci id="S3.SS3.p1.10.m10.6.6.4.7.2.3.cmml" xref="S3.SS3.p1.10.m10.6.6.4.7.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.10.m10.1.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1.1.1">𝑝</ci></apply></apply><apply id="S3.SS3.p1.10.m10.6.6.2.cmml" xref="S3.SS3.p1.10.m10.6.6.2"><divide id="S3.SS3.p1.10.m10.6.6.2.3.cmml" xref="S3.SS3.p1.10.m10.6.6.2.3"></divide><apply id="S3.SS3.p1.10.m10.5.5.1.1.2.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1"><abs id="S3.SS3.p1.10.m10.5.5.1.1.2.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.2"></abs><apply id="S3.SS3.p1.10.m10.5.5.1.1.1.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1"><intersect id="S3.SS3.p1.10.m10.5.5.1.1.1.1.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.1"></intersect><apply id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2">superscript</csymbol><apply id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.10.m10.2.2.1.1.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1">𝑝</ci></apply><apply id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3">superscript</csymbol><apply id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2"><ci id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.1.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.1">^</ci><ci id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.2.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.2.2">𝑌</ci></apply><ci id="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p1.10.m10.5.5.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.10.m10.3.3.1.1.cmml" xref="S3.SS3.p1.10.m10.3.3.1.1">𝑝</ci></apply></apply></apply><apply id="S3.SS3.p1.10.m10.6.6.2.2.2.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1"><abs id="S3.SS3.p1.10.m10.6.6.2.2.2.1.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.2"></abs><apply id="S3.SS3.p1.10.m10.6.6.2.2.1.1.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.6.6.2.2.1.1.1.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1">superscript</csymbol><apply id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.1.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1">subscript</csymbol><apply id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2"><ci id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.1.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.1">^</ci><ci id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.2.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.2.2">𝑌</ci></apply><ci id="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.3.cmml" xref="S3.SS3.p1.10.m10.6.6.2.2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p1.10.m10.4.4.1.1.cmml" xref="S3.SS3.p1.10.m10.4.4.1.1">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.6c">Recall_{t}^{(p)}=|y_{t}^{(p)}\cap\hat{Y}_{t}^{(p)}|/|\hat{Y}_{t}^{(p)}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.6d">italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT = | italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT ∩ over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT | / | over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT |</annotation></semantics></math>. The final score is obtained as indicated in equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.E29" title="In 3.3. Evaluation Metrics ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">29</span></a>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(29)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{F1}=\frac{1}{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}1}\sum_{p}^{N}\sum_{t}^%
{\hat{T}_{p}}\frac{2\times Precision_{t}^{(p)}\times Recall_{t}^{(p)}}{%
Precision_{t}^{(p)}+Recall_{t}^{(p)}}" class="ltx_Math" display="block" id="S3.E29.m1.4"><semantics id="S3.E29.m1.4a"><mrow id="S3.E29.m1.4.5" xref="S3.E29.m1.4.5.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E29.m1.4.5.2" xref="S3.E29.m1.4.5.2a.cmml">F1</mtext><mo id="S3.E29.m1.4.5.1" xref="S3.E29.m1.4.5.1.cmml">=</mo><mrow id="S3.E29.m1.4.5.3" xref="S3.E29.m1.4.5.3.cmml"><mfrac id="S3.E29.m1.4.5.3.2" xref="S3.E29.m1.4.5.3.2.cmml"><mn id="S3.E29.m1.4.5.3.2.2" xref="S3.E29.m1.4.5.3.2.2.cmml">1</mn><mrow id="S3.E29.m1.4.5.3.2.3" xref="S3.E29.m1.4.5.3.2.3.cmml"><msubsup id="S3.E29.m1.4.5.3.2.3.1" xref="S3.E29.m1.4.5.3.2.3.1.cmml"><mo id="S3.E29.m1.4.5.3.2.3.1.2.2" xref="S3.E29.m1.4.5.3.2.3.1.2.2.cmml">∑</mo><mi id="S3.E29.m1.4.5.3.2.3.1.2.3" xref="S3.E29.m1.4.5.3.2.3.1.2.3.cmml">p</mi><mi id="S3.E29.m1.4.5.3.2.3.1.3" xref="S3.E29.m1.4.5.3.2.3.1.3.cmml">N</mi></msubsup><mrow id="S3.E29.m1.4.5.3.2.3.2" xref="S3.E29.m1.4.5.3.2.3.2.cmml"><msubsup id="S3.E29.m1.4.5.3.2.3.2.1" xref="S3.E29.m1.4.5.3.2.3.2.1.cmml"><mo id="S3.E29.m1.4.5.3.2.3.2.1.2.2" lspace="0.167em" xref="S3.E29.m1.4.5.3.2.3.2.1.2.2.cmml">∑</mo><mi id="S3.E29.m1.4.5.3.2.3.2.1.2.3" xref="S3.E29.m1.4.5.3.2.3.2.1.2.3.cmml">t</mi><msub id="S3.E29.m1.4.5.3.2.3.2.1.3" xref="S3.E29.m1.4.5.3.2.3.2.1.3.cmml"><mover accent="true" id="S3.E29.m1.4.5.3.2.3.2.1.3.2" xref="S3.E29.m1.4.5.3.2.3.2.1.3.2.cmml"><mi id="S3.E29.m1.4.5.3.2.3.2.1.3.2.2" xref="S3.E29.m1.4.5.3.2.3.2.1.3.2.2.cmml">T</mi><mo id="S3.E29.m1.4.5.3.2.3.2.1.3.2.1" xref="S3.E29.m1.4.5.3.2.3.2.1.3.2.1.cmml">^</mo></mover><mi id="S3.E29.m1.4.5.3.2.3.2.1.3.3" xref="S3.E29.m1.4.5.3.2.3.2.1.3.3.cmml">p</mi></msub></msubsup><mn id="S3.E29.m1.4.5.3.2.3.2.2" xref="S3.E29.m1.4.5.3.2.3.2.2.cmml">1</mn></mrow></mrow></mfrac><mo id="S3.E29.m1.4.5.3.1" xref="S3.E29.m1.4.5.3.1.cmml">⁢</mo><mrow id="S3.E29.m1.4.5.3.3" xref="S3.E29.m1.4.5.3.3.cmml"><munderover id="S3.E29.m1.4.5.3.3.1" xref="S3.E29.m1.4.5.3.3.1.cmml"><mo id="S3.E29.m1.4.5.3.3.1.2.2" movablelimits="false" rspace="0em" xref="S3.E29.m1.4.5.3.3.1.2.2.cmml">∑</mo><mi id="S3.E29.m1.4.5.3.3.1.2.3" xref="S3.E29.m1.4.5.3.3.1.2.3.cmml">p</mi><mi id="S3.E29.m1.4.5.3.3.1.3" xref="S3.E29.m1.4.5.3.3.1.3.cmml">N</mi></munderover><mrow id="S3.E29.m1.4.5.3.3.2" xref="S3.E29.m1.4.5.3.3.2.cmml"><munderover id="S3.E29.m1.4.5.3.3.2.1" xref="S3.E29.m1.4.5.3.3.2.1.cmml"><mo id="S3.E29.m1.4.5.3.3.2.1.2.2" movablelimits="false" xref="S3.E29.m1.4.5.3.3.2.1.2.2.cmml">∑</mo><mi id="S3.E29.m1.4.5.3.3.2.1.2.3" xref="S3.E29.m1.4.5.3.3.2.1.2.3.cmml">t</mi><msub id="S3.E29.m1.4.5.3.3.2.1.3" xref="S3.E29.m1.4.5.3.3.2.1.3.cmml"><mover accent="true" id="S3.E29.m1.4.5.3.3.2.1.3.2" xref="S3.E29.m1.4.5.3.3.2.1.3.2.cmml"><mi id="S3.E29.m1.4.5.3.3.2.1.3.2.2" xref="S3.E29.m1.4.5.3.3.2.1.3.2.2.cmml">T</mi><mo id="S3.E29.m1.4.5.3.3.2.1.3.2.1" xref="S3.E29.m1.4.5.3.3.2.1.3.2.1.cmml">^</mo></mover><mi id="S3.E29.m1.4.5.3.3.2.1.3.3" xref="S3.E29.m1.4.5.3.3.2.1.3.3.cmml">p</mi></msub></munderover><mfrac id="S3.E29.m1.4.4" xref="S3.E29.m1.4.4.cmml"><mrow id="S3.E29.m1.2.2.2" xref="S3.E29.m1.2.2.2.cmml"><mrow id="S3.E29.m1.2.2.2.4" xref="S3.E29.m1.2.2.2.4.cmml"><mrow id="S3.E29.m1.2.2.2.4.2" xref="S3.E29.m1.2.2.2.4.2.cmml"><mrow id="S3.E29.m1.2.2.2.4.2.2" xref="S3.E29.m1.2.2.2.4.2.2.cmml"><mn id="S3.E29.m1.2.2.2.4.2.2.2" xref="S3.E29.m1.2.2.2.4.2.2.2.cmml">2</mn><mo id="S3.E29.m1.2.2.2.4.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E29.m1.2.2.2.4.2.2.1.cmml">×</mo><mi id="S3.E29.m1.2.2.2.4.2.2.3" xref="S3.E29.m1.2.2.2.4.2.2.3.cmml">P</mi></mrow><mo id="S3.E29.m1.2.2.2.4.2.1" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.4.2.3" xref="S3.E29.m1.2.2.2.4.2.3.cmml">r</mi><mo id="S3.E29.m1.2.2.2.4.2.1a" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.4.2.4" xref="S3.E29.m1.2.2.2.4.2.4.cmml">e</mi><mo id="S3.E29.m1.2.2.2.4.2.1b" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.4.2.5" xref="S3.E29.m1.2.2.2.4.2.5.cmml">c</mi><mo id="S3.E29.m1.2.2.2.4.2.1c" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.4.2.6" xref="S3.E29.m1.2.2.2.4.2.6.cmml">i</mi><mo id="S3.E29.m1.2.2.2.4.2.1d" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.4.2.7" xref="S3.E29.m1.2.2.2.4.2.7.cmml">s</mi><mo id="S3.E29.m1.2.2.2.4.2.1e" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.4.2.8" xref="S3.E29.m1.2.2.2.4.2.8.cmml">i</mi><mo id="S3.E29.m1.2.2.2.4.2.1f" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.4.2.9" xref="S3.E29.m1.2.2.2.4.2.9.cmml">o</mi><mo id="S3.E29.m1.2.2.2.4.2.1g" xref="S3.E29.m1.2.2.2.4.2.1.cmml">⁢</mo><msubsup id="S3.E29.m1.2.2.2.4.2.10" xref="S3.E29.m1.2.2.2.4.2.10.cmml"><mi id="S3.E29.m1.2.2.2.4.2.10.2.2" xref="S3.E29.m1.2.2.2.4.2.10.2.2.cmml">n</mi><mi id="S3.E29.m1.2.2.2.4.2.10.2.3" xref="S3.E29.m1.2.2.2.4.2.10.2.3.cmml">t</mi><mrow id="S3.E29.m1.1.1.1.1.1.3" xref="S3.E29.m1.2.2.2.4.2.10.cmml"><mo id="S3.E29.m1.1.1.1.1.1.3.1" stretchy="false" xref="S3.E29.m1.2.2.2.4.2.10.cmml">(</mo><mi id="S3.E29.m1.1.1.1.1.1.1" xref="S3.E29.m1.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E29.m1.1.1.1.1.1.3.2" stretchy="false" xref="S3.E29.m1.2.2.2.4.2.10.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E29.m1.2.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E29.m1.2.2.2.4.1.cmml">×</mo><mi id="S3.E29.m1.2.2.2.4.3" xref="S3.E29.m1.2.2.2.4.3.cmml">R</mi></mrow><mo id="S3.E29.m1.2.2.2.3" xref="S3.E29.m1.2.2.2.3.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.5" xref="S3.E29.m1.2.2.2.5.cmml">e</mi><mo id="S3.E29.m1.2.2.2.3a" xref="S3.E29.m1.2.2.2.3.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.6" xref="S3.E29.m1.2.2.2.6.cmml">c</mi><mo id="S3.E29.m1.2.2.2.3b" xref="S3.E29.m1.2.2.2.3.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.7" xref="S3.E29.m1.2.2.2.7.cmml">a</mi><mo id="S3.E29.m1.2.2.2.3c" xref="S3.E29.m1.2.2.2.3.cmml">⁢</mo><mi id="S3.E29.m1.2.2.2.8" xref="S3.E29.m1.2.2.2.8.cmml">l</mi><mo id="S3.E29.m1.2.2.2.3d" xref="S3.E29.m1.2.2.2.3.cmml">⁢</mo><msubsup id="S3.E29.m1.2.2.2.9" xref="S3.E29.m1.2.2.2.9.cmml"><mi id="S3.E29.m1.2.2.2.9.2.2" xref="S3.E29.m1.2.2.2.9.2.2.cmml">l</mi><mi id="S3.E29.m1.2.2.2.9.2.3" xref="S3.E29.m1.2.2.2.9.2.3.cmml">t</mi><mrow id="S3.E29.m1.2.2.2.2.1.3" xref="S3.E29.m1.2.2.2.9.cmml"><mo id="S3.E29.m1.2.2.2.2.1.3.1" stretchy="false" xref="S3.E29.m1.2.2.2.9.cmml">(</mo><mi id="S3.E29.m1.2.2.2.2.1.1" xref="S3.E29.m1.2.2.2.2.1.1.cmml">p</mi><mo id="S3.E29.m1.2.2.2.2.1.3.2" stretchy="false" xref="S3.E29.m1.2.2.2.9.cmml">)</mo></mrow></msubsup></mrow><mrow id="S3.E29.m1.4.4.4" xref="S3.E29.m1.4.4.4.cmml"><mrow id="S3.E29.m1.4.4.4.4" xref="S3.E29.m1.4.4.4.4.cmml"><mi id="S3.E29.m1.4.4.4.4.2" xref="S3.E29.m1.4.4.4.4.2.cmml">P</mi><mo id="S3.E29.m1.4.4.4.4.1" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.4.3" xref="S3.E29.m1.4.4.4.4.3.cmml">r</mi><mo id="S3.E29.m1.4.4.4.4.1a" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.4.4" xref="S3.E29.m1.4.4.4.4.4.cmml">e</mi><mo id="S3.E29.m1.4.4.4.4.1b" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.4.5" xref="S3.E29.m1.4.4.4.4.5.cmml">c</mi><mo id="S3.E29.m1.4.4.4.4.1c" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.4.6" xref="S3.E29.m1.4.4.4.4.6.cmml">i</mi><mo id="S3.E29.m1.4.4.4.4.1d" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.4.7" xref="S3.E29.m1.4.4.4.4.7.cmml">s</mi><mo id="S3.E29.m1.4.4.4.4.1e" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.4.8" xref="S3.E29.m1.4.4.4.4.8.cmml">i</mi><mo id="S3.E29.m1.4.4.4.4.1f" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.4.9" xref="S3.E29.m1.4.4.4.4.9.cmml">o</mi><mo id="S3.E29.m1.4.4.4.4.1g" xref="S3.E29.m1.4.4.4.4.1.cmml">⁢</mo><msubsup id="S3.E29.m1.4.4.4.4.10" xref="S3.E29.m1.4.4.4.4.10.cmml"><mi id="S3.E29.m1.4.4.4.4.10.2.2" xref="S3.E29.m1.4.4.4.4.10.2.2.cmml">n</mi><mi id="S3.E29.m1.4.4.4.4.10.2.3" xref="S3.E29.m1.4.4.4.4.10.2.3.cmml">t</mi><mrow id="S3.E29.m1.3.3.3.1.1.3" xref="S3.E29.m1.4.4.4.4.10.cmml"><mo id="S3.E29.m1.3.3.3.1.1.3.1" stretchy="false" xref="S3.E29.m1.4.4.4.4.10.cmml">(</mo><mi id="S3.E29.m1.3.3.3.1.1.1" xref="S3.E29.m1.3.3.3.1.1.1.cmml">p</mi><mo id="S3.E29.m1.3.3.3.1.1.3.2" stretchy="false" xref="S3.E29.m1.4.4.4.4.10.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E29.m1.4.4.4.3" xref="S3.E29.m1.4.4.4.3.cmml">+</mo><mrow id="S3.E29.m1.4.4.4.5" xref="S3.E29.m1.4.4.4.5.cmml"><mi id="S3.E29.m1.4.4.4.5.2" xref="S3.E29.m1.4.4.4.5.2.cmml">R</mi><mo id="S3.E29.m1.4.4.4.5.1" xref="S3.E29.m1.4.4.4.5.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.5.3" xref="S3.E29.m1.4.4.4.5.3.cmml">e</mi><mo id="S3.E29.m1.4.4.4.5.1a" xref="S3.E29.m1.4.4.4.5.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.5.4" xref="S3.E29.m1.4.4.4.5.4.cmml">c</mi><mo id="S3.E29.m1.4.4.4.5.1b" xref="S3.E29.m1.4.4.4.5.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.5.5" xref="S3.E29.m1.4.4.4.5.5.cmml">a</mi><mo id="S3.E29.m1.4.4.4.5.1c" xref="S3.E29.m1.4.4.4.5.1.cmml">⁢</mo><mi id="S3.E29.m1.4.4.4.5.6" xref="S3.E29.m1.4.4.4.5.6.cmml">l</mi><mo id="S3.E29.m1.4.4.4.5.1d" xref="S3.E29.m1.4.4.4.5.1.cmml">⁢</mo><msubsup id="S3.E29.m1.4.4.4.5.7" xref="S3.E29.m1.4.4.4.5.7.cmml"><mi id="S3.E29.m1.4.4.4.5.7.2.2" xref="S3.E29.m1.4.4.4.5.7.2.2.cmml">l</mi><mi id="S3.E29.m1.4.4.4.5.7.2.3" xref="S3.E29.m1.4.4.4.5.7.2.3.cmml">t</mi><mrow id="S3.E29.m1.4.4.4.2.1.3" xref="S3.E29.m1.4.4.4.5.7.cmml"><mo id="S3.E29.m1.4.4.4.2.1.3.1" stretchy="false" xref="S3.E29.m1.4.4.4.5.7.cmml">(</mo><mi id="S3.E29.m1.4.4.4.2.1.1" xref="S3.E29.m1.4.4.4.2.1.1.cmml">p</mi><mo id="S3.E29.m1.4.4.4.2.1.3.2" stretchy="false" xref="S3.E29.m1.4.4.4.5.7.cmml">)</mo></mrow></msubsup></mrow></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E29.m1.4b"><apply id="S3.E29.m1.4.5.cmml" xref="S3.E29.m1.4.5"><eq id="S3.E29.m1.4.5.1.cmml" xref="S3.E29.m1.4.5.1"></eq><ci id="S3.E29.m1.4.5.2a.cmml" xref="S3.E29.m1.4.5.2"><mtext class="ltx_mathvariant_bold" id="S3.E29.m1.4.5.2.cmml" xref="S3.E29.m1.4.5.2">F1</mtext></ci><apply id="S3.E29.m1.4.5.3.cmml" xref="S3.E29.m1.4.5.3"><times id="S3.E29.m1.4.5.3.1.cmml" xref="S3.E29.m1.4.5.3.1"></times><apply id="S3.E29.m1.4.5.3.2.cmml" xref="S3.E29.m1.4.5.3.2"><divide id="S3.E29.m1.4.5.3.2.1.cmml" xref="S3.E29.m1.4.5.3.2"></divide><cn id="S3.E29.m1.4.5.3.2.2.cmml" type="integer" xref="S3.E29.m1.4.5.3.2.2">1</cn><apply id="S3.E29.m1.4.5.3.2.3.cmml" xref="S3.E29.m1.4.5.3.2.3"><apply id="S3.E29.m1.4.5.3.2.3.1.cmml" xref="S3.E29.m1.4.5.3.2.3.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.2.3.1.1.cmml" xref="S3.E29.m1.4.5.3.2.3.1">superscript</csymbol><apply id="S3.E29.m1.4.5.3.2.3.1.2.cmml" xref="S3.E29.m1.4.5.3.2.3.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.2.3.1.2.1.cmml" xref="S3.E29.m1.4.5.3.2.3.1">subscript</csymbol><sum id="S3.E29.m1.4.5.3.2.3.1.2.2.cmml" xref="S3.E29.m1.4.5.3.2.3.1.2.2"></sum><ci id="S3.E29.m1.4.5.3.2.3.1.2.3.cmml" xref="S3.E29.m1.4.5.3.2.3.1.2.3">𝑝</ci></apply><ci id="S3.E29.m1.4.5.3.2.3.1.3.cmml" xref="S3.E29.m1.4.5.3.2.3.1.3">𝑁</ci></apply><apply id="S3.E29.m1.4.5.3.2.3.2.cmml" xref="S3.E29.m1.4.5.3.2.3.2"><apply id="S3.E29.m1.4.5.3.2.3.2.1.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.2.3.2.1.1.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1">superscript</csymbol><apply id="S3.E29.m1.4.5.3.2.3.2.1.2.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.2.3.2.1.2.1.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1">subscript</csymbol><sum id="S3.E29.m1.4.5.3.2.3.2.1.2.2.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.2.2"></sum><ci id="S3.E29.m1.4.5.3.2.3.2.1.2.3.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.2.3">𝑡</ci></apply><apply id="S3.E29.m1.4.5.3.2.3.2.1.3.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.3"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.2.3.2.1.3.1.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.3">subscript</csymbol><apply id="S3.E29.m1.4.5.3.2.3.2.1.3.2.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.3.2"><ci id="S3.E29.m1.4.5.3.2.3.2.1.3.2.1.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.3.2.1">^</ci><ci id="S3.E29.m1.4.5.3.2.3.2.1.3.2.2.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.3.2.2">𝑇</ci></apply><ci id="S3.E29.m1.4.5.3.2.3.2.1.3.3.cmml" xref="S3.E29.m1.4.5.3.2.3.2.1.3.3">𝑝</ci></apply></apply><cn id="S3.E29.m1.4.5.3.2.3.2.2.cmml" type="integer" xref="S3.E29.m1.4.5.3.2.3.2.2">1</cn></apply></apply></apply><apply id="S3.E29.m1.4.5.3.3.cmml" xref="S3.E29.m1.4.5.3.3"><apply id="S3.E29.m1.4.5.3.3.1.cmml" xref="S3.E29.m1.4.5.3.3.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.3.1.1.cmml" xref="S3.E29.m1.4.5.3.3.1">superscript</csymbol><apply id="S3.E29.m1.4.5.3.3.1.2.cmml" xref="S3.E29.m1.4.5.3.3.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.3.1.2.1.cmml" xref="S3.E29.m1.4.5.3.3.1">subscript</csymbol><sum id="S3.E29.m1.4.5.3.3.1.2.2.cmml" xref="S3.E29.m1.4.5.3.3.1.2.2"></sum><ci id="S3.E29.m1.4.5.3.3.1.2.3.cmml" xref="S3.E29.m1.4.5.3.3.1.2.3">𝑝</ci></apply><ci id="S3.E29.m1.4.5.3.3.1.3.cmml" xref="S3.E29.m1.4.5.3.3.1.3">𝑁</ci></apply><apply id="S3.E29.m1.4.5.3.3.2.cmml" xref="S3.E29.m1.4.5.3.3.2"><apply id="S3.E29.m1.4.5.3.3.2.1.cmml" xref="S3.E29.m1.4.5.3.3.2.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.3.2.1.1.cmml" xref="S3.E29.m1.4.5.3.3.2.1">superscript</csymbol><apply id="S3.E29.m1.4.5.3.3.2.1.2.cmml" xref="S3.E29.m1.4.5.3.3.2.1"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.3.2.1.2.1.cmml" xref="S3.E29.m1.4.5.3.3.2.1">subscript</csymbol><sum id="S3.E29.m1.4.5.3.3.2.1.2.2.cmml" xref="S3.E29.m1.4.5.3.3.2.1.2.2"></sum><ci id="S3.E29.m1.4.5.3.3.2.1.2.3.cmml" xref="S3.E29.m1.4.5.3.3.2.1.2.3">𝑡</ci></apply><apply id="S3.E29.m1.4.5.3.3.2.1.3.cmml" xref="S3.E29.m1.4.5.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E29.m1.4.5.3.3.2.1.3.1.cmml" xref="S3.E29.m1.4.5.3.3.2.1.3">subscript</csymbol><apply id="S3.E29.m1.4.5.3.3.2.1.3.2.cmml" xref="S3.E29.m1.4.5.3.3.2.1.3.2"><ci id="S3.E29.m1.4.5.3.3.2.1.3.2.1.cmml" xref="S3.E29.m1.4.5.3.3.2.1.3.2.1">^</ci><ci id="S3.E29.m1.4.5.3.3.2.1.3.2.2.cmml" xref="S3.E29.m1.4.5.3.3.2.1.3.2.2">𝑇</ci></apply><ci id="S3.E29.m1.4.5.3.3.2.1.3.3.cmml" xref="S3.E29.m1.4.5.3.3.2.1.3.3">𝑝</ci></apply></apply><apply id="S3.E29.m1.4.4.cmml" xref="S3.E29.m1.4.4"><divide id="S3.E29.m1.4.4.5.cmml" xref="S3.E29.m1.4.4"></divide><apply id="S3.E29.m1.2.2.2.cmml" xref="S3.E29.m1.2.2.2"><times id="S3.E29.m1.2.2.2.3.cmml" xref="S3.E29.m1.2.2.2.3"></times><apply id="S3.E29.m1.2.2.2.4.cmml" xref="S3.E29.m1.2.2.2.4"><times id="S3.E29.m1.2.2.2.4.1.cmml" xref="S3.E29.m1.2.2.2.4.1"></times><apply id="S3.E29.m1.2.2.2.4.2.cmml" xref="S3.E29.m1.2.2.2.4.2"><times id="S3.E29.m1.2.2.2.4.2.1.cmml" xref="S3.E29.m1.2.2.2.4.2.1"></times><apply id="S3.E29.m1.2.2.2.4.2.2.cmml" xref="S3.E29.m1.2.2.2.4.2.2"><times id="S3.E29.m1.2.2.2.4.2.2.1.cmml" xref="S3.E29.m1.2.2.2.4.2.2.1"></times><cn id="S3.E29.m1.2.2.2.4.2.2.2.cmml" type="integer" xref="S3.E29.m1.2.2.2.4.2.2.2">2</cn><ci id="S3.E29.m1.2.2.2.4.2.2.3.cmml" xref="S3.E29.m1.2.2.2.4.2.2.3">𝑃</ci></apply><ci id="S3.E29.m1.2.2.2.4.2.3.cmml" xref="S3.E29.m1.2.2.2.4.2.3">𝑟</ci><ci id="S3.E29.m1.2.2.2.4.2.4.cmml" xref="S3.E29.m1.2.2.2.4.2.4">𝑒</ci><ci id="S3.E29.m1.2.2.2.4.2.5.cmml" xref="S3.E29.m1.2.2.2.4.2.5">𝑐</ci><ci id="S3.E29.m1.2.2.2.4.2.6.cmml" xref="S3.E29.m1.2.2.2.4.2.6">𝑖</ci><ci id="S3.E29.m1.2.2.2.4.2.7.cmml" xref="S3.E29.m1.2.2.2.4.2.7">𝑠</ci><ci id="S3.E29.m1.2.2.2.4.2.8.cmml" xref="S3.E29.m1.2.2.2.4.2.8">𝑖</ci><ci id="S3.E29.m1.2.2.2.4.2.9.cmml" xref="S3.E29.m1.2.2.2.4.2.9">𝑜</ci><apply id="S3.E29.m1.2.2.2.4.2.10.cmml" xref="S3.E29.m1.2.2.2.4.2.10"><csymbol cd="ambiguous" id="S3.E29.m1.2.2.2.4.2.10.1.cmml" xref="S3.E29.m1.2.2.2.4.2.10">superscript</csymbol><apply id="S3.E29.m1.2.2.2.4.2.10.2.cmml" xref="S3.E29.m1.2.2.2.4.2.10"><csymbol cd="ambiguous" id="S3.E29.m1.2.2.2.4.2.10.2.1.cmml" xref="S3.E29.m1.2.2.2.4.2.10">subscript</csymbol><ci id="S3.E29.m1.2.2.2.4.2.10.2.2.cmml" xref="S3.E29.m1.2.2.2.4.2.10.2.2">𝑛</ci><ci id="S3.E29.m1.2.2.2.4.2.10.2.3.cmml" xref="S3.E29.m1.2.2.2.4.2.10.2.3">𝑡</ci></apply><ci id="S3.E29.m1.1.1.1.1.1.1.cmml" xref="S3.E29.m1.1.1.1.1.1.1">𝑝</ci></apply></apply><ci id="S3.E29.m1.2.2.2.4.3.cmml" xref="S3.E29.m1.2.2.2.4.3">𝑅</ci></apply><ci id="S3.E29.m1.2.2.2.5.cmml" xref="S3.E29.m1.2.2.2.5">𝑒</ci><ci id="S3.E29.m1.2.2.2.6.cmml" xref="S3.E29.m1.2.2.2.6">𝑐</ci><ci id="S3.E29.m1.2.2.2.7.cmml" xref="S3.E29.m1.2.2.2.7">𝑎</ci><ci id="S3.E29.m1.2.2.2.8.cmml" xref="S3.E29.m1.2.2.2.8">𝑙</ci><apply id="S3.E29.m1.2.2.2.9.cmml" xref="S3.E29.m1.2.2.2.9"><csymbol cd="ambiguous" id="S3.E29.m1.2.2.2.9.1.cmml" xref="S3.E29.m1.2.2.2.9">superscript</csymbol><apply id="S3.E29.m1.2.2.2.9.2.cmml" xref="S3.E29.m1.2.2.2.9"><csymbol cd="ambiguous" id="S3.E29.m1.2.2.2.9.2.1.cmml" xref="S3.E29.m1.2.2.2.9">subscript</csymbol><ci id="S3.E29.m1.2.2.2.9.2.2.cmml" xref="S3.E29.m1.2.2.2.9.2.2">𝑙</ci><ci id="S3.E29.m1.2.2.2.9.2.3.cmml" xref="S3.E29.m1.2.2.2.9.2.3">𝑡</ci></apply><ci id="S3.E29.m1.2.2.2.2.1.1.cmml" xref="S3.E29.m1.2.2.2.2.1.1">𝑝</ci></apply></apply><apply id="S3.E29.m1.4.4.4.cmml" xref="S3.E29.m1.4.4.4"><plus id="S3.E29.m1.4.4.4.3.cmml" xref="S3.E29.m1.4.4.4.3"></plus><apply id="S3.E29.m1.4.4.4.4.cmml" xref="S3.E29.m1.4.4.4.4"><times id="S3.E29.m1.4.4.4.4.1.cmml" xref="S3.E29.m1.4.4.4.4.1"></times><ci id="S3.E29.m1.4.4.4.4.2.cmml" xref="S3.E29.m1.4.4.4.4.2">𝑃</ci><ci id="S3.E29.m1.4.4.4.4.3.cmml" xref="S3.E29.m1.4.4.4.4.3">𝑟</ci><ci id="S3.E29.m1.4.4.4.4.4.cmml" xref="S3.E29.m1.4.4.4.4.4">𝑒</ci><ci id="S3.E29.m1.4.4.4.4.5.cmml" xref="S3.E29.m1.4.4.4.4.5">𝑐</ci><ci id="S3.E29.m1.4.4.4.4.6.cmml" xref="S3.E29.m1.4.4.4.4.6">𝑖</ci><ci id="S3.E29.m1.4.4.4.4.7.cmml" xref="S3.E29.m1.4.4.4.4.7">𝑠</ci><ci id="S3.E29.m1.4.4.4.4.8.cmml" xref="S3.E29.m1.4.4.4.4.8">𝑖</ci><ci id="S3.E29.m1.4.4.4.4.9.cmml" xref="S3.E29.m1.4.4.4.4.9">𝑜</ci><apply id="S3.E29.m1.4.4.4.4.10.cmml" xref="S3.E29.m1.4.4.4.4.10"><csymbol cd="ambiguous" id="S3.E29.m1.4.4.4.4.10.1.cmml" xref="S3.E29.m1.4.4.4.4.10">superscript</csymbol><apply id="S3.E29.m1.4.4.4.4.10.2.cmml" xref="S3.E29.m1.4.4.4.4.10"><csymbol cd="ambiguous" id="S3.E29.m1.4.4.4.4.10.2.1.cmml" xref="S3.E29.m1.4.4.4.4.10">subscript</csymbol><ci id="S3.E29.m1.4.4.4.4.10.2.2.cmml" xref="S3.E29.m1.4.4.4.4.10.2.2">𝑛</ci><ci id="S3.E29.m1.4.4.4.4.10.2.3.cmml" xref="S3.E29.m1.4.4.4.4.10.2.3">𝑡</ci></apply><ci id="S3.E29.m1.3.3.3.1.1.1.cmml" xref="S3.E29.m1.3.3.3.1.1.1">𝑝</ci></apply></apply><apply id="S3.E29.m1.4.4.4.5.cmml" xref="S3.E29.m1.4.4.4.5"><times id="S3.E29.m1.4.4.4.5.1.cmml" xref="S3.E29.m1.4.4.4.5.1"></times><ci id="S3.E29.m1.4.4.4.5.2.cmml" xref="S3.E29.m1.4.4.4.5.2">𝑅</ci><ci id="S3.E29.m1.4.4.4.5.3.cmml" xref="S3.E29.m1.4.4.4.5.3">𝑒</ci><ci id="S3.E29.m1.4.4.4.5.4.cmml" xref="S3.E29.m1.4.4.4.5.4">𝑐</ci><ci id="S3.E29.m1.4.4.4.5.5.cmml" xref="S3.E29.m1.4.4.4.5.5">𝑎</ci><ci id="S3.E29.m1.4.4.4.5.6.cmml" xref="S3.E29.m1.4.4.4.5.6">𝑙</ci><apply id="S3.E29.m1.4.4.4.5.7.cmml" xref="S3.E29.m1.4.4.4.5.7"><csymbol cd="ambiguous" id="S3.E29.m1.4.4.4.5.7.1.cmml" xref="S3.E29.m1.4.4.4.5.7">superscript</csymbol><apply id="S3.E29.m1.4.4.4.5.7.2.cmml" xref="S3.E29.m1.4.4.4.5.7"><csymbol cd="ambiguous" id="S3.E29.m1.4.4.4.5.7.2.1.cmml" xref="S3.E29.m1.4.4.4.5.7">subscript</csymbol><ci id="S3.E29.m1.4.4.4.5.7.2.2.cmml" xref="S3.E29.m1.4.4.4.5.7.2.2">𝑙</ci><ci id="S3.E29.m1.4.4.4.5.7.2.3.cmml" xref="S3.E29.m1.4.4.4.5.7.2.3">𝑡</ci></apply><ci id="S3.E29.m1.4.4.4.2.1.1.cmml" xref="S3.E29.m1.4.4.4.2.1.1">𝑝</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E29.m1.4c">\textbf{F1}=\frac{1}{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}1}\sum_{p}^{N}\sum_{t}^%
{\hat{T}_{p}}\frac{2\times Precision_{t}^{(p)}\times Recall_{t}^{(p)}}{%
Precision_{t}^{(p)}+Recall_{t}^{(p)}}</annotation><annotation encoding="application/x-llamapun" id="S3.E29.m1.4d">F1 = divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT 1 end_ARG ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG 2 × italic_P italic_r italic_e italic_c italic_i italic_s italic_i italic_o italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT × italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_P italic_r italic_e italic_c italic_i italic_s italic_i italic_o italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT + italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.13"><span class="ltx_text ltx_font_bold" id="S3.SS3.p1.13.1">PRAUC</span> quantifies the performance of a classification model by measuring the area under the precision-recall curve. The formulation of PRAUC is indicated in equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.E30" title="In 3.3. Evaluation Metrics ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">30</span></a>, wherein <math alttext="\operatorname{PRAUC}_{t}^{(p)}=\sum_{l=1}^{|\mathcal{H}|}\operatorname{%
Precision}(l)_{t}^{(p)}\Delta\operatorname{Recall}(l)_{t}^{(p)}" class="ltx_math_unparsed" display="inline" id="S3.SS3.p1.11.m1.6"><semantics id="S3.SS3.p1.11.m1.6a"><mrow id="S3.SS3.p1.11.m1.6b"><msubsup id="S3.SS3.p1.11.m1.6.7"><mi id="S3.SS3.p1.11.m1.6.7.2.2">PRAUC</mi><mi id="S3.SS3.p1.11.m1.6.7.2.3">t</mi><mrow id="S3.SS3.p1.11.m1.1.1.1.3"><mo id="S3.SS3.p1.11.m1.1.1.1.3.1" stretchy="false">(</mo><mi id="S3.SS3.p1.11.m1.1.1.1.1">p</mi><mo id="S3.SS3.p1.11.m1.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S3.SS3.p1.11.m1.6.8" rspace="0.111em">=</mo><msubsup id="S3.SS3.p1.11.m1.6.9"><mo id="S3.SS3.p1.11.m1.6.9.2.2">∑</mo><mrow id="S3.SS3.p1.11.m1.6.9.2.3"><mi id="S3.SS3.p1.11.m1.6.9.2.3.2">l</mi><mo id="S3.SS3.p1.11.m1.6.9.2.3.1">=</mo><mn id="S3.SS3.p1.11.m1.6.9.2.3.3">1</mn></mrow><mrow id="S3.SS3.p1.11.m1.2.2.1.3"><mo id="S3.SS3.p1.11.m1.2.2.1.3.1" stretchy="false">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.11.m1.2.2.1.1">ℋ</mi><mo id="S3.SS3.p1.11.m1.2.2.1.3.2" stretchy="false">|</mo></mrow></msubsup><mi id="S3.SS3.p1.11.m1.5.5">Precision</mi><msubsup id="S3.SS3.p1.11.m1.6.10"><mrow id="S3.SS3.p1.11.m1.6.10.2.2"><mo id="S3.SS3.p1.11.m1.6.10.2.2.1" stretchy="false">(</mo><mi id="S3.SS3.p1.11.m1.6.6">l</mi><mo id="S3.SS3.p1.11.m1.6.10.2.2.2" stretchy="false">)</mo></mrow><mi id="S3.SS3.p1.11.m1.6.10.2.3">t</mi><mrow id="S3.SS3.p1.11.m1.3.3.1.3"><mo id="S3.SS3.p1.11.m1.3.3.1.3.1" stretchy="false">(</mo><mi id="S3.SS3.p1.11.m1.3.3.1.1">p</mi><mo id="S3.SS3.p1.11.m1.3.3.1.3.2" stretchy="false">)</mo></mrow></msubsup><mi id="S3.SS3.p1.11.m1.6.11" mathvariant="normal">Δ</mi><mi id="S3.SS3.p1.11.m1.6.12">Recall</mi><msubsup id="S3.SS3.p1.11.m1.6.13"><mrow id="S3.SS3.p1.11.m1.6.13.2.2"><mo id="S3.SS3.p1.11.m1.6.13.2.2.1" stretchy="false">(</mo><mi id="S3.SS3.p1.11.m1.6.13.2.2.2">l</mi><mo id="S3.SS3.p1.11.m1.6.13.2.2.3" stretchy="false">)</mo></mrow><mi id="S3.SS3.p1.11.m1.6.13.2.3">t</mi><mrow id="S3.SS3.p1.11.m1.4.4.1.3"><mo id="S3.SS3.p1.11.m1.4.4.1.3.1" stretchy="false">(</mo><mi id="S3.SS3.p1.11.m1.4.4.1.1">p</mi><mo id="S3.SS3.p1.11.m1.4.4.1.3.2" stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m1.6c">\operatorname{PRAUC}_{t}^{(p)}=\sum_{l=1}^{|\mathcal{H}|}\operatorname{%
Precision}(l)_{t}^{(p)}\Delta\operatorname{Recall}(l)_{t}^{(p)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m1.6d">roman_PRAUC start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_H | end_POSTSUPERSCRIPT roman_Precision ( italic_l ) start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT roman_Δ roman_Recall ( italic_l ) start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\Delta\operatorname{Recall}(l)_{t}^{(p)}=\operatorname{Recall}(l)_{t}^{(p)}\\
-\hskip 2.0pt\operatorname{Recall}(l-1)_{t}^{(p)}" class="ltx_math_unparsed" display="inline" id="S3.SS3.p1.12.m2.5"><semantics id="S3.SS3.p1.12.m2.5a"><mrow id="S3.SS3.p1.12.m2.5b"><mi id="S3.SS3.p1.12.m2.5.6" mathvariant="normal">Δ</mi><mi id="S3.SS3.p1.12.m2.4.4">Recall</mi><msubsup id="S3.SS3.p1.12.m2.5.7"><mrow id="S3.SS3.p1.12.m2.5.7.2.2"><mo id="S3.SS3.p1.12.m2.5.7.2.2.1" stretchy="false">(</mo><mi id="S3.SS3.p1.12.m2.5.5">l</mi><mo id="S3.SS3.p1.12.m2.5.7.2.2.2" stretchy="false">)</mo></mrow><mi id="S3.SS3.p1.12.m2.5.7.2.3">t</mi><mrow id="S3.SS3.p1.12.m2.1.1.1.3"><mo id="S3.SS3.p1.12.m2.1.1.1.3.1" stretchy="false">(</mo><mi id="S3.SS3.p1.12.m2.1.1.1.1">p</mi><mo id="S3.SS3.p1.12.m2.1.1.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S3.SS3.p1.12.m2.5.8">=</mo><mi id="S3.SS3.p1.12.m2.5.9">Recall</mi><msubsup id="S3.SS3.p1.12.m2.5.10"><mrow id="S3.SS3.p1.12.m2.5.10.2.2"><mo id="S3.SS3.p1.12.m2.5.10.2.2.1" stretchy="false">(</mo><mi id="S3.SS3.p1.12.m2.5.10.2.2.2">l</mi><mo id="S3.SS3.p1.12.m2.5.10.2.2.3" stretchy="false">)</mo></mrow><mi id="S3.SS3.p1.12.m2.5.10.2.3">t</mi><mrow id="S3.SS3.p1.12.m2.2.2.1.3"><mo id="S3.SS3.p1.12.m2.2.2.1.3.1" stretchy="false">(</mo><mi id="S3.SS3.p1.12.m2.2.2.1.1">p</mi><mo id="S3.SS3.p1.12.m2.2.2.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S3.SS3.p1.12.m2.5.11" rspace="0.422em">−</mo><mi id="S3.SS3.p1.12.m2.5.12">Recall</mi><msubsup id="S3.SS3.p1.12.m2.5.13"><mrow id="S3.SS3.p1.12.m2.5.13.2.2"><mo id="S3.SS3.p1.12.m2.5.13.2.2.1" stretchy="false">(</mo><mi id="S3.SS3.p1.12.m2.5.13.2.2.2">l</mi><mo id="S3.SS3.p1.12.m2.5.13.2.2.3">−</mo><mn id="S3.SS3.p1.12.m2.5.13.2.2.4">1</mn><mo id="S3.SS3.p1.12.m2.5.13.2.2.5" stretchy="false">)</mo></mrow><mi id="S3.SS3.p1.12.m2.5.13.2.3">t</mi><mrow id="S3.SS3.p1.12.m2.3.3.1.3"><mo id="S3.SS3.p1.12.m2.3.3.1.3.1" stretchy="false">(</mo><mi id="S3.SS3.p1.12.m2.3.3.1.1">p</mi><mo id="S3.SS3.p1.12.m2.3.3.1.3.2" stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m2.5c">\Delta\operatorname{Recall}(l)_{t}^{(p)}=\operatorname{Recall}(l)_{t}^{(p)}\\
-\hskip 2.0pt\operatorname{Recall}(l-1)_{t}^{(p)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m2.5d">roman_Δ roman_Recall ( italic_l ) start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT = roman_Recall ( italic_l ) start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT - roman_Recall ( italic_l - 1 ) start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m3.1"><semantics id="S3.SS3.p1.13.m3.1a"><mi id="S3.SS3.p1.13.m3.1.1" xref="S3.SS3.p1.13.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m3.1b"><ci id="S3.SS3.p1.13.m3.1.1.cmml" xref="S3.SS3.p1.13.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m3.1d">italic_l</annotation></semantics></math> is the rank of the sequence of the retrieved prescription.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E30">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(30)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{\textbf{PRAUC}}=\frac{1}{\Sigma_{p}^{N}\Sigma_{t}^{\hat{T}_{p}}1%
}\sum_{k}^{N}\sum_{t}^{\hat{T}_{p}}\operatorname{PRAUC}_{t}^{(p)}" class="ltx_Math" display="block" id="S3.E30.m1.1"><semantics id="S3.E30.m1.1a"><mrow id="S3.E30.m1.1.2" xref="S3.E30.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E30.m1.1.2.2" xref="S3.E30.m1.1.2.2a.cmml">PRAUC</mtext><mo id="S3.E30.m1.1.2.1" xref="S3.E30.m1.1.2.1.cmml">=</mo><mrow id="S3.E30.m1.1.2.3" xref="S3.E30.m1.1.2.3.cmml"><mfrac id="S3.E30.m1.1.2.3.2" xref="S3.E30.m1.1.2.3.2.cmml"><mn id="S3.E30.m1.1.2.3.2.2" xref="S3.E30.m1.1.2.3.2.2.cmml">1</mn><mrow id="S3.E30.m1.1.2.3.2.3" xref="S3.E30.m1.1.2.3.2.3.cmml"><msubsup id="S3.E30.m1.1.2.3.2.3.2" xref="S3.E30.m1.1.2.3.2.3.2.cmml"><mi id="S3.E30.m1.1.2.3.2.3.2.2.2" mathvariant="normal" xref="S3.E30.m1.1.2.3.2.3.2.2.2.cmml">Σ</mi><mi id="S3.E30.m1.1.2.3.2.3.2.2.3" xref="S3.E30.m1.1.2.3.2.3.2.2.3.cmml">p</mi><mi id="S3.E30.m1.1.2.3.2.3.2.3" xref="S3.E30.m1.1.2.3.2.3.2.3.cmml">N</mi></msubsup><mo id="S3.E30.m1.1.2.3.2.3.1" xref="S3.E30.m1.1.2.3.2.3.1.cmml">⁢</mo><msubsup id="S3.E30.m1.1.2.3.2.3.3" xref="S3.E30.m1.1.2.3.2.3.3.cmml"><mi id="S3.E30.m1.1.2.3.2.3.3.2.2" mathvariant="normal" xref="S3.E30.m1.1.2.3.2.3.3.2.2.cmml">Σ</mi><mi id="S3.E30.m1.1.2.3.2.3.3.2.3" xref="S3.E30.m1.1.2.3.2.3.3.2.3.cmml">t</mi><msub id="S3.E30.m1.1.2.3.2.3.3.3" xref="S3.E30.m1.1.2.3.2.3.3.3.cmml"><mover accent="true" id="S3.E30.m1.1.2.3.2.3.3.3.2" xref="S3.E30.m1.1.2.3.2.3.3.3.2.cmml"><mi id="S3.E30.m1.1.2.3.2.3.3.3.2.2" xref="S3.E30.m1.1.2.3.2.3.3.3.2.2.cmml">T</mi><mo id="S3.E30.m1.1.2.3.2.3.3.3.2.1" xref="S3.E30.m1.1.2.3.2.3.3.3.2.1.cmml">^</mo></mover><mi id="S3.E30.m1.1.2.3.2.3.3.3.3" xref="S3.E30.m1.1.2.3.2.3.3.3.3.cmml">p</mi></msub></msubsup><mo id="S3.E30.m1.1.2.3.2.3.1a" xref="S3.E30.m1.1.2.3.2.3.1.cmml">⁢</mo><mn id="S3.E30.m1.1.2.3.2.3.4" xref="S3.E30.m1.1.2.3.2.3.4.cmml">1</mn></mrow></mfrac><mo id="S3.E30.m1.1.2.3.1" xref="S3.E30.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.E30.m1.1.2.3.3" xref="S3.E30.m1.1.2.3.3.cmml"><munderover id="S3.E30.m1.1.2.3.3.1" xref="S3.E30.m1.1.2.3.3.1.cmml"><mo id="S3.E30.m1.1.2.3.3.1.2.2" movablelimits="false" rspace="0em" xref="S3.E30.m1.1.2.3.3.1.2.2.cmml">∑</mo><mi id="S3.E30.m1.1.2.3.3.1.2.3" xref="S3.E30.m1.1.2.3.3.1.2.3.cmml">k</mi><mi id="S3.E30.m1.1.2.3.3.1.3" xref="S3.E30.m1.1.2.3.3.1.3.cmml">N</mi></munderover><mrow id="S3.E30.m1.1.2.3.3.2" xref="S3.E30.m1.1.2.3.3.2.cmml"><munderover id="S3.E30.m1.1.2.3.3.2.1" xref="S3.E30.m1.1.2.3.3.2.1.cmml"><mo id="S3.E30.m1.1.2.3.3.2.1.2.2" movablelimits="false" xref="S3.E30.m1.1.2.3.3.2.1.2.2.cmml">∑</mo><mi id="S3.E30.m1.1.2.3.3.2.1.2.3" xref="S3.E30.m1.1.2.3.3.2.1.2.3.cmml">t</mi><msub id="S3.E30.m1.1.2.3.3.2.1.3" xref="S3.E30.m1.1.2.3.3.2.1.3.cmml"><mover accent="true" id="S3.E30.m1.1.2.3.3.2.1.3.2" xref="S3.E30.m1.1.2.3.3.2.1.3.2.cmml"><mi id="S3.E30.m1.1.2.3.3.2.1.3.2.2" xref="S3.E30.m1.1.2.3.3.2.1.3.2.2.cmml">T</mi><mo id="S3.E30.m1.1.2.3.3.2.1.3.2.1" xref="S3.E30.m1.1.2.3.3.2.1.3.2.1.cmml">^</mo></mover><mi id="S3.E30.m1.1.2.3.3.2.1.3.3" xref="S3.E30.m1.1.2.3.3.2.1.3.3.cmml">p</mi></msub></munderover><msubsup id="S3.E30.m1.1.2.3.3.2.2" xref="S3.E30.m1.1.2.3.3.2.2.cmml"><mi id="S3.E30.m1.1.2.3.3.2.2.2.2" xref="S3.E30.m1.1.2.3.3.2.2.2.2.cmml">PRAUC</mi><mi id="S3.E30.m1.1.2.3.3.2.2.2.3" xref="S3.E30.m1.1.2.3.3.2.2.2.3.cmml">t</mi><mrow id="S3.E30.m1.1.1.1.3" xref="S3.E30.m1.1.2.3.3.2.2.cmml"><mo id="S3.E30.m1.1.1.1.3.1" stretchy="false" xref="S3.E30.m1.1.2.3.3.2.2.cmml">(</mo><mi id="S3.E30.m1.1.1.1.1" xref="S3.E30.m1.1.1.1.1.cmml">p</mi><mo id="S3.E30.m1.1.1.1.3.2" stretchy="false" xref="S3.E30.m1.1.2.3.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E30.m1.1b"><apply id="S3.E30.m1.1.2.cmml" xref="S3.E30.m1.1.2"><eq id="S3.E30.m1.1.2.1.cmml" xref="S3.E30.m1.1.2.1"></eq><ci id="S3.E30.m1.1.2.2a.cmml" xref="S3.E30.m1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E30.m1.1.2.2.cmml" xref="S3.E30.m1.1.2.2">PRAUC</mtext></ci><apply id="S3.E30.m1.1.2.3.cmml" xref="S3.E30.m1.1.2.3"><times id="S3.E30.m1.1.2.3.1.cmml" xref="S3.E30.m1.1.2.3.1"></times><apply id="S3.E30.m1.1.2.3.2.cmml" xref="S3.E30.m1.1.2.3.2"><divide id="S3.E30.m1.1.2.3.2.1.cmml" xref="S3.E30.m1.1.2.3.2"></divide><cn id="S3.E30.m1.1.2.3.2.2.cmml" type="integer" xref="S3.E30.m1.1.2.3.2.2">1</cn><apply id="S3.E30.m1.1.2.3.2.3.cmml" xref="S3.E30.m1.1.2.3.2.3"><times id="S3.E30.m1.1.2.3.2.3.1.cmml" xref="S3.E30.m1.1.2.3.2.3.1"></times><apply id="S3.E30.m1.1.2.3.2.3.2.cmml" xref="S3.E30.m1.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.2.3.2.1.cmml" xref="S3.E30.m1.1.2.3.2.3.2">superscript</csymbol><apply id="S3.E30.m1.1.2.3.2.3.2.2.cmml" xref="S3.E30.m1.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.2.3.2.2.1.cmml" xref="S3.E30.m1.1.2.3.2.3.2">subscript</csymbol><ci id="S3.E30.m1.1.2.3.2.3.2.2.2.cmml" xref="S3.E30.m1.1.2.3.2.3.2.2.2">Σ</ci><ci id="S3.E30.m1.1.2.3.2.3.2.2.3.cmml" xref="S3.E30.m1.1.2.3.2.3.2.2.3">𝑝</ci></apply><ci id="S3.E30.m1.1.2.3.2.3.2.3.cmml" xref="S3.E30.m1.1.2.3.2.3.2.3">𝑁</ci></apply><apply id="S3.E30.m1.1.2.3.2.3.3.cmml" xref="S3.E30.m1.1.2.3.2.3.3"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.2.3.3.1.cmml" xref="S3.E30.m1.1.2.3.2.3.3">superscript</csymbol><apply id="S3.E30.m1.1.2.3.2.3.3.2.cmml" xref="S3.E30.m1.1.2.3.2.3.3"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.2.3.3.2.1.cmml" xref="S3.E30.m1.1.2.3.2.3.3">subscript</csymbol><ci id="S3.E30.m1.1.2.3.2.3.3.2.2.cmml" xref="S3.E30.m1.1.2.3.2.3.3.2.2">Σ</ci><ci id="S3.E30.m1.1.2.3.2.3.3.2.3.cmml" xref="S3.E30.m1.1.2.3.2.3.3.2.3">𝑡</ci></apply><apply id="S3.E30.m1.1.2.3.2.3.3.3.cmml" xref="S3.E30.m1.1.2.3.2.3.3.3"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.2.3.3.3.1.cmml" xref="S3.E30.m1.1.2.3.2.3.3.3">subscript</csymbol><apply id="S3.E30.m1.1.2.3.2.3.3.3.2.cmml" xref="S3.E30.m1.1.2.3.2.3.3.3.2"><ci id="S3.E30.m1.1.2.3.2.3.3.3.2.1.cmml" xref="S3.E30.m1.1.2.3.2.3.3.3.2.1">^</ci><ci id="S3.E30.m1.1.2.3.2.3.3.3.2.2.cmml" xref="S3.E30.m1.1.2.3.2.3.3.3.2.2">𝑇</ci></apply><ci id="S3.E30.m1.1.2.3.2.3.3.3.3.cmml" xref="S3.E30.m1.1.2.3.2.3.3.3.3">𝑝</ci></apply></apply><cn id="S3.E30.m1.1.2.3.2.3.4.cmml" type="integer" xref="S3.E30.m1.1.2.3.2.3.4">1</cn></apply></apply><apply id="S3.E30.m1.1.2.3.3.cmml" xref="S3.E30.m1.1.2.3.3"><apply id="S3.E30.m1.1.2.3.3.1.cmml" xref="S3.E30.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.3.1.1.cmml" xref="S3.E30.m1.1.2.3.3.1">superscript</csymbol><apply id="S3.E30.m1.1.2.3.3.1.2.cmml" xref="S3.E30.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.3.1.2.1.cmml" xref="S3.E30.m1.1.2.3.3.1">subscript</csymbol><sum id="S3.E30.m1.1.2.3.3.1.2.2.cmml" xref="S3.E30.m1.1.2.3.3.1.2.2"></sum><ci id="S3.E30.m1.1.2.3.3.1.2.3.cmml" xref="S3.E30.m1.1.2.3.3.1.2.3">𝑘</ci></apply><ci id="S3.E30.m1.1.2.3.3.1.3.cmml" xref="S3.E30.m1.1.2.3.3.1.3">𝑁</ci></apply><apply id="S3.E30.m1.1.2.3.3.2.cmml" xref="S3.E30.m1.1.2.3.3.2"><apply id="S3.E30.m1.1.2.3.3.2.1.cmml" xref="S3.E30.m1.1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.3.2.1.1.cmml" xref="S3.E30.m1.1.2.3.3.2.1">superscript</csymbol><apply id="S3.E30.m1.1.2.3.3.2.1.2.cmml" xref="S3.E30.m1.1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.3.2.1.2.1.cmml" xref="S3.E30.m1.1.2.3.3.2.1">subscript</csymbol><sum id="S3.E30.m1.1.2.3.3.2.1.2.2.cmml" xref="S3.E30.m1.1.2.3.3.2.1.2.2"></sum><ci id="S3.E30.m1.1.2.3.3.2.1.2.3.cmml" xref="S3.E30.m1.1.2.3.3.2.1.2.3">𝑡</ci></apply><apply id="S3.E30.m1.1.2.3.3.2.1.3.cmml" xref="S3.E30.m1.1.2.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.3.2.1.3.1.cmml" xref="S3.E30.m1.1.2.3.3.2.1.3">subscript</csymbol><apply id="S3.E30.m1.1.2.3.3.2.1.3.2.cmml" xref="S3.E30.m1.1.2.3.3.2.1.3.2"><ci id="S3.E30.m1.1.2.3.3.2.1.3.2.1.cmml" xref="S3.E30.m1.1.2.3.3.2.1.3.2.1">^</ci><ci id="S3.E30.m1.1.2.3.3.2.1.3.2.2.cmml" xref="S3.E30.m1.1.2.3.3.2.1.3.2.2">𝑇</ci></apply><ci id="S3.E30.m1.1.2.3.3.2.1.3.3.cmml" xref="S3.E30.m1.1.2.3.3.2.1.3.3">𝑝</ci></apply></apply><apply id="S3.E30.m1.1.2.3.3.2.2.cmml" xref="S3.E30.m1.1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.3.2.2.1.cmml" xref="S3.E30.m1.1.2.3.3.2.2">superscript</csymbol><apply id="S3.E30.m1.1.2.3.3.2.2.2.cmml" xref="S3.E30.m1.1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E30.m1.1.2.3.3.2.2.2.1.cmml" xref="S3.E30.m1.1.2.3.3.2.2">subscript</csymbol><ci id="S3.E30.m1.1.2.3.3.2.2.2.2.cmml" xref="S3.E30.m1.1.2.3.3.2.2.2.2">PRAUC</ci><ci id="S3.E30.m1.1.2.3.3.2.2.2.3.cmml" xref="S3.E30.m1.1.2.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.E30.m1.1.1.1.1.cmml" xref="S3.E30.m1.1.1.1.1">𝑝</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E30.m1.1c">\operatorname{\textbf{PRAUC}}=\frac{1}{\Sigma_{p}^{N}\Sigma_{t}^{\hat{T}_{p}}1%
}\sum_{k}^{N}\sum_{t}^{\hat{T}_{p}}\operatorname{PRAUC}_{t}^{(p)}</annotation><annotation encoding="application/x-llamapun" id="S3.E30.m1.1d">PRAUC = divide start_ARG 1 end_ARG start_ARG roman_Σ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_Σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT 1 end_ARG ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT roman_PRAUC start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.16"><span class="ltx_text ltx_font_bold" id="S3.SS3.p1.16.1">DDI </span>rate measures medication safety by calculating the rate at which predicted prescriptions interact with each other <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib27" title="">2019</a>)</cite>, indicated in equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.E31" title="In 3.3. Evaluation Metrics ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">31</span></a>, where <math alttext="u_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m1.1"><semantics id="S3.SS3.p1.14.m1.1a"><msub id="S3.SS3.p1.14.m1.1.1" xref="S3.SS3.p1.14.m1.1.1.cmml"><mi id="S3.SS3.p1.14.m1.1.1.2" xref="S3.SS3.p1.14.m1.1.1.2.cmml">u</mi><mi id="S3.SS3.p1.14.m1.1.1.3" xref="S3.SS3.p1.14.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m1.1b"><apply id="S3.SS3.p1.14.m1.1.1.cmml" xref="S3.SS3.p1.14.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m1.1.1.1.cmml" xref="S3.SS3.p1.14.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m1.1.1.2.cmml" xref="S3.SS3.p1.14.m1.1.1.2">𝑢</ci><ci id="S3.SS3.p1.14.m1.1.1.3.cmml" xref="S3.SS3.p1.14.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m1.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m1.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> equals to the <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS3.p1.15.m2.1"><semantics id="S3.SS3.p1.15.m2.1a"><msup id="S3.SS3.p1.15.m2.1.1" xref="S3.SS3.p1.15.m2.1.1.cmml"><mi id="S3.SS3.p1.15.m2.1.1.2" xref="S3.SS3.p1.15.m2.1.1.2.cmml">i</mi><mrow id="S3.SS3.p1.15.m2.1.1.3" xref="S3.SS3.p1.15.m2.1.1.3.cmml"><mi id="S3.SS3.p1.15.m2.1.1.3.2" xref="S3.SS3.p1.15.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p1.15.m2.1.1.3.1" xref="S3.SS3.p1.15.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.15.m2.1.1.3.3" xref="S3.SS3.p1.15.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m2.1b"><apply id="S3.SS3.p1.15.m2.1.1.cmml" xref="S3.SS3.p1.15.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m2.1.1.1.cmml" xref="S3.SS3.p1.15.m2.1.1">superscript</csymbol><ci id="S3.SS3.p1.15.m2.1.1.2.cmml" xref="S3.SS3.p1.15.m2.1.1.2">𝑖</ci><apply id="S3.SS3.p1.15.m2.1.1.3.cmml" xref="S3.SS3.p1.15.m2.1.1.3"><times id="S3.SS3.p1.15.m2.1.1.3.1.cmml" xref="S3.SS3.p1.15.m2.1.1.3.1"></times><ci id="S3.SS3.p1.15.m2.1.1.3.2.cmml" xref="S3.SS3.p1.15.m2.1.1.3.2">𝑡</ci><ci id="S3.SS3.p1.15.m2.1.1.3.3.cmml" xref="S3.SS3.p1.15.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m2.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.15.m2.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> prescriptions prediction output, and <math alttext="\mathcal{G}_{d}" class="ltx_Math" display="inline" id="S3.SS3.p1.16.m3.1"><semantics id="S3.SS3.p1.16.m3.1a"><msub id="S3.SS3.p1.16.m3.1.1" xref="S3.SS3.p1.16.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.16.m3.1.1.2" xref="S3.SS3.p1.16.m3.1.1.2.cmml">𝒢</mi><mi id="S3.SS3.p1.16.m3.1.1.3" xref="S3.SS3.p1.16.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m3.1b"><apply id="S3.SS3.p1.16.m3.1.1.cmml" xref="S3.SS3.p1.16.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.16.m3.1.1.1.cmml" xref="S3.SS3.p1.16.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.16.m3.1.1.2.cmml" xref="S3.SS3.p1.16.m3.1.1.2">𝒢</ci><ci id="S3.SS3.p1.16.m3.1.1.3.cmml" xref="S3.SS3.p1.16.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m3.1c">\mathcal{G}_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.16.m3.1d">caligraphic_G start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is the DDI graph.
<br class="ltx_break"/></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E31">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(31)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{DDI }=\frac{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}\sum_{i,j}\left|\left\{%
\left(u_{i},u_{j}\right)\in\hat{Y}_{t}^{(p)}\mid\left(u_{i},u_{j}\right)\in%
\mathcal{G}_{d}\right\}\right|}{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}\sum_{i,j}1}" class="ltx_Math" display="block" id="S3.E31.m1.6"><semantics id="S3.E31.m1.6a"><mrow id="S3.E31.m1.6.7" xref="S3.E31.m1.6.7.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E31.m1.6.7.2" xref="S3.E31.m1.6.7.2a.cmml">DDI </mtext><mo id="S3.E31.m1.6.7.1" xref="S3.E31.m1.6.7.1.cmml">=</mo><mfrac id="S3.E31.m1.6.6" xref="S3.E31.m1.6.6.cmml"><mrow id="S3.E31.m1.4.4.4" xref="S3.E31.m1.4.4.4.cmml"><msubsup id="S3.E31.m1.4.4.4.5" xref="S3.E31.m1.4.4.4.5.cmml"><mo id="S3.E31.m1.4.4.4.5.2.2" xref="S3.E31.m1.4.4.4.5.2.2.cmml">∑</mo><mi id="S3.E31.m1.4.4.4.5.2.3" xref="S3.E31.m1.4.4.4.5.2.3.cmml">p</mi><mi id="S3.E31.m1.4.4.4.5.3" xref="S3.E31.m1.4.4.4.5.3.cmml">N</mi></msubsup><mrow id="S3.E31.m1.4.4.4.4" xref="S3.E31.m1.4.4.4.4.cmml"><msubsup id="S3.E31.m1.4.4.4.4.2" xref="S3.E31.m1.4.4.4.4.2.cmml"><mo id="S3.E31.m1.4.4.4.4.2.2.2" lspace="0.167em" rspace="0em" xref="S3.E31.m1.4.4.4.4.2.2.2.cmml">∑</mo><mi id="S3.E31.m1.4.4.4.4.2.2.3" xref="S3.E31.m1.4.4.4.4.2.2.3.cmml">t</mi><msub id="S3.E31.m1.4.4.4.4.2.3" xref="S3.E31.m1.4.4.4.4.2.3.cmml"><mover accent="true" id="S3.E31.m1.4.4.4.4.2.3.2" xref="S3.E31.m1.4.4.4.4.2.3.2.cmml"><mi id="S3.E31.m1.4.4.4.4.2.3.2.2" xref="S3.E31.m1.4.4.4.4.2.3.2.2.cmml">T</mi><mo id="S3.E31.m1.4.4.4.4.2.3.2.1" xref="S3.E31.m1.4.4.4.4.2.3.2.1.cmml">^</mo></mover><mi id="S3.E31.m1.4.4.4.4.2.3.3" xref="S3.E31.m1.4.4.4.4.2.3.3.cmml">p</mi></msub></msubsup><mrow id="S3.E31.m1.4.4.4.4.1" xref="S3.E31.m1.4.4.4.4.1.cmml"><msub id="S3.E31.m1.4.4.4.4.1.2" xref="S3.E31.m1.4.4.4.4.1.2.cmml"><mo id="S3.E31.m1.4.4.4.4.1.2.2" rspace="0em" xref="S3.E31.m1.4.4.4.4.1.2.2.cmml">∑</mo><mrow id="S3.E31.m1.2.2.2.2.2.4" xref="S3.E31.m1.2.2.2.2.2.3.cmml"><mi id="S3.E31.m1.1.1.1.1.1.1" xref="S3.E31.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E31.m1.2.2.2.2.2.4.1" xref="S3.E31.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E31.m1.2.2.2.2.2.2" xref="S3.E31.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mrow id="S3.E31.m1.4.4.4.4.1.1.1" xref="S3.E31.m1.4.4.4.4.1.1.2.cmml"><mo id="S3.E31.m1.4.4.4.4.1.1.1.2" xref="S3.E31.m1.4.4.4.4.1.1.2.1.cmml">|</mo><mrow id="S3.E31.m1.4.4.4.4.1.1.1.1.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.3.cmml"><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.2.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.3.1.cmml">{</mo><mrow id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.cmml"><mrow id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.4" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.2.cmml">u</mi><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.5" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.3.cmml">)</mo></mrow><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.3.cmml">∈</mo><msubsup id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.cmml"><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.2.cmml">Y</mi><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.1" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.1.cmml">^</mo></mover><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.3.cmml">t</mi><mrow id="S3.E31.m1.3.3.3.3.1.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.cmml"><mo id="S3.E31.m1.3.3.3.3.1.3.1" stretchy="false" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.cmml">(</mo><mi id="S3.E31.m1.3.3.3.3.1.1" xref="S3.E31.m1.3.3.3.3.1.1.cmml">p</mi><mo id="S3.E31.m1.3.3.3.3.1.3.2" stretchy="false" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo fence="true" id="S3.E31.m1.4.4.4.4.1.1.1.1.2.4" lspace="0em" rspace="0em" xref="S3.E31.m1.4.4.4.4.1.1.1.1.3.1.cmml">∣</mo><mrow id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.cmml"><mrow id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.cmml"><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.2.cmml">u</mi><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.4" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.2.cmml">u</mi><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.5" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.3.cmml">∈</mo><msub id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.2" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.2.cmml">𝒢</mi><mi id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.3" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.3.cmml">d</mi></msub></mrow><mo id="S3.E31.m1.4.4.4.4.1.1.1.1.2.5" xref="S3.E31.m1.4.4.4.4.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S3.E31.m1.4.4.4.4.1.1.1.3" xref="S3.E31.m1.4.4.4.4.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><mrow id="S3.E31.m1.6.6.6" xref="S3.E31.m1.6.6.6.cmml"><msubsup id="S3.E31.m1.6.6.6.3" xref="S3.E31.m1.6.6.6.3.cmml"><mo id="S3.E31.m1.6.6.6.3.2.2" xref="S3.E31.m1.6.6.6.3.2.2.cmml">∑</mo><mi id="S3.E31.m1.6.6.6.3.2.3" xref="S3.E31.m1.6.6.6.3.2.3.cmml">p</mi><mi id="S3.E31.m1.6.6.6.3.3" xref="S3.E31.m1.6.6.6.3.3.cmml">N</mi></msubsup><mrow id="S3.E31.m1.6.6.6.4" xref="S3.E31.m1.6.6.6.4.cmml"><msubsup id="S3.E31.m1.6.6.6.4.1" xref="S3.E31.m1.6.6.6.4.1.cmml"><mo id="S3.E31.m1.6.6.6.4.1.2.2" lspace="0.167em" rspace="0em" xref="S3.E31.m1.6.6.6.4.1.2.2.cmml">∑</mo><mi id="S3.E31.m1.6.6.6.4.1.2.3" xref="S3.E31.m1.6.6.6.4.1.2.3.cmml">t</mi><msub id="S3.E31.m1.6.6.6.4.1.3" xref="S3.E31.m1.6.6.6.4.1.3.cmml"><mover accent="true" id="S3.E31.m1.6.6.6.4.1.3.2" xref="S3.E31.m1.6.6.6.4.1.3.2.cmml"><mi id="S3.E31.m1.6.6.6.4.1.3.2.2" xref="S3.E31.m1.6.6.6.4.1.3.2.2.cmml">T</mi><mo id="S3.E31.m1.6.6.6.4.1.3.2.1" xref="S3.E31.m1.6.6.6.4.1.3.2.1.cmml">^</mo></mover><mi id="S3.E31.m1.6.6.6.4.1.3.3" xref="S3.E31.m1.6.6.6.4.1.3.3.cmml">p</mi></msub></msubsup><mrow id="S3.E31.m1.6.6.6.4.2" xref="S3.E31.m1.6.6.6.4.2.cmml"><msub id="S3.E31.m1.6.6.6.4.2.1" xref="S3.E31.m1.6.6.6.4.2.1.cmml"><mo id="S3.E31.m1.6.6.6.4.2.1.2" xref="S3.E31.m1.6.6.6.4.2.1.2.cmml">∑</mo><mrow id="S3.E31.m1.6.6.6.2.2.4" xref="S3.E31.m1.6.6.6.2.2.3.cmml"><mi id="S3.E31.m1.5.5.5.1.1.1" xref="S3.E31.m1.5.5.5.1.1.1.cmml">i</mi><mo id="S3.E31.m1.6.6.6.2.2.4.1" xref="S3.E31.m1.6.6.6.2.2.3.cmml">,</mo><mi id="S3.E31.m1.6.6.6.2.2.2" xref="S3.E31.m1.6.6.6.2.2.2.cmml">j</mi></mrow></msub><mn id="S3.E31.m1.6.6.6.4.2.2" xref="S3.E31.m1.6.6.6.4.2.2.cmml">1</mn></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E31.m1.6b"><apply id="S3.E31.m1.6.7.cmml" xref="S3.E31.m1.6.7"><eq id="S3.E31.m1.6.7.1.cmml" xref="S3.E31.m1.6.7.1"></eq><ci id="S3.E31.m1.6.7.2a.cmml" xref="S3.E31.m1.6.7.2"><mtext class="ltx_mathvariant_bold" id="S3.E31.m1.6.7.2.cmml" xref="S3.E31.m1.6.7.2">DDI </mtext></ci><apply id="S3.E31.m1.6.6.cmml" xref="S3.E31.m1.6.6"><divide id="S3.E31.m1.6.6.7.cmml" xref="S3.E31.m1.6.6"></divide><apply id="S3.E31.m1.4.4.4.cmml" xref="S3.E31.m1.4.4.4"><apply id="S3.E31.m1.4.4.4.5.cmml" xref="S3.E31.m1.4.4.4.5"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.5.1.cmml" xref="S3.E31.m1.4.4.4.5">superscript</csymbol><apply id="S3.E31.m1.4.4.4.5.2.cmml" xref="S3.E31.m1.4.4.4.5"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.5.2.1.cmml" xref="S3.E31.m1.4.4.4.5">subscript</csymbol><sum id="S3.E31.m1.4.4.4.5.2.2.cmml" xref="S3.E31.m1.4.4.4.5.2.2"></sum><ci id="S3.E31.m1.4.4.4.5.2.3.cmml" xref="S3.E31.m1.4.4.4.5.2.3">𝑝</ci></apply><ci id="S3.E31.m1.4.4.4.5.3.cmml" xref="S3.E31.m1.4.4.4.5.3">𝑁</ci></apply><apply id="S3.E31.m1.4.4.4.4.cmml" xref="S3.E31.m1.4.4.4.4"><apply id="S3.E31.m1.4.4.4.4.2.cmml" xref="S3.E31.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.2.1.cmml" xref="S3.E31.m1.4.4.4.4.2">superscript</csymbol><apply id="S3.E31.m1.4.4.4.4.2.2.cmml" xref="S3.E31.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.2.2.1.cmml" xref="S3.E31.m1.4.4.4.4.2">subscript</csymbol><sum id="S3.E31.m1.4.4.4.4.2.2.2.cmml" xref="S3.E31.m1.4.4.4.4.2.2.2"></sum><ci id="S3.E31.m1.4.4.4.4.2.2.3.cmml" xref="S3.E31.m1.4.4.4.4.2.2.3">𝑡</ci></apply><apply id="S3.E31.m1.4.4.4.4.2.3.cmml" xref="S3.E31.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.2.3.1.cmml" xref="S3.E31.m1.4.4.4.4.2.3">subscript</csymbol><apply id="S3.E31.m1.4.4.4.4.2.3.2.cmml" xref="S3.E31.m1.4.4.4.4.2.3.2"><ci id="S3.E31.m1.4.4.4.4.2.3.2.1.cmml" xref="S3.E31.m1.4.4.4.4.2.3.2.1">^</ci><ci id="S3.E31.m1.4.4.4.4.2.3.2.2.cmml" xref="S3.E31.m1.4.4.4.4.2.3.2.2">𝑇</ci></apply><ci id="S3.E31.m1.4.4.4.4.2.3.3.cmml" xref="S3.E31.m1.4.4.4.4.2.3.3">𝑝</ci></apply></apply><apply id="S3.E31.m1.4.4.4.4.1.cmml" xref="S3.E31.m1.4.4.4.4.1"><apply id="S3.E31.m1.4.4.4.4.1.2.cmml" xref="S3.E31.m1.4.4.4.4.1.2"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.2.1.cmml" xref="S3.E31.m1.4.4.4.4.1.2">subscript</csymbol><sum id="S3.E31.m1.4.4.4.4.1.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.2.2"></sum><list id="S3.E31.m1.2.2.2.2.2.3.cmml" xref="S3.E31.m1.2.2.2.2.2.4"><ci id="S3.E31.m1.1.1.1.1.1.1.cmml" xref="S3.E31.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E31.m1.2.2.2.2.2.2.cmml" xref="S3.E31.m1.2.2.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E31.m1.4.4.4.4.1.1.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1"><abs id="S3.E31.m1.4.4.4.4.1.1.2.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.2"></abs><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2"><csymbol cd="latexml" id="S3.E31.m1.4.4.4.4.1.1.1.1.3.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.3">conditional-set</csymbol><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1"><in id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.3"></in><interval closure="open" id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2"><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.2">𝑢</ci><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.2">𝑢</ci><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4">subscript</csymbol><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2"><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.1">^</ci><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.2.2">𝑌</ci></apply><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.1.1.4.2.3">𝑡</ci></apply><ci id="S3.E31.m1.3.3.3.3.1.1.cmml" xref="S3.E31.m1.3.3.3.3.1.1">𝑝</ci></apply></apply><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2"><in id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.3"></in><interval closure="open" id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2"><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.2">𝑢</ci><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.2">𝑢</ci><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.2.2.2.3">𝑗</ci></apply></interval><apply id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.1.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4">subscript</csymbol><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.2.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.2">𝒢</ci><ci id="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.3.cmml" xref="S3.E31.m1.4.4.4.4.1.1.1.1.2.2.4.3">𝑑</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E31.m1.6.6.6.cmml" xref="S3.E31.m1.6.6.6"><apply id="S3.E31.m1.6.6.6.3.cmml" xref="S3.E31.m1.6.6.6.3"><csymbol cd="ambiguous" id="S3.E31.m1.6.6.6.3.1.cmml" xref="S3.E31.m1.6.6.6.3">superscript</csymbol><apply id="S3.E31.m1.6.6.6.3.2.cmml" xref="S3.E31.m1.6.6.6.3"><csymbol cd="ambiguous" id="S3.E31.m1.6.6.6.3.2.1.cmml" xref="S3.E31.m1.6.6.6.3">subscript</csymbol><sum id="S3.E31.m1.6.6.6.3.2.2.cmml" xref="S3.E31.m1.6.6.6.3.2.2"></sum><ci id="S3.E31.m1.6.6.6.3.2.3.cmml" xref="S3.E31.m1.6.6.6.3.2.3">𝑝</ci></apply><ci id="S3.E31.m1.6.6.6.3.3.cmml" xref="S3.E31.m1.6.6.6.3.3">𝑁</ci></apply><apply id="S3.E31.m1.6.6.6.4.cmml" xref="S3.E31.m1.6.6.6.4"><apply id="S3.E31.m1.6.6.6.4.1.cmml" xref="S3.E31.m1.6.6.6.4.1"><csymbol cd="ambiguous" id="S3.E31.m1.6.6.6.4.1.1.cmml" xref="S3.E31.m1.6.6.6.4.1">superscript</csymbol><apply id="S3.E31.m1.6.6.6.4.1.2.cmml" xref="S3.E31.m1.6.6.6.4.1"><csymbol cd="ambiguous" id="S3.E31.m1.6.6.6.4.1.2.1.cmml" xref="S3.E31.m1.6.6.6.4.1">subscript</csymbol><sum id="S3.E31.m1.6.6.6.4.1.2.2.cmml" xref="S3.E31.m1.6.6.6.4.1.2.2"></sum><ci id="S3.E31.m1.6.6.6.4.1.2.3.cmml" xref="S3.E31.m1.6.6.6.4.1.2.3">𝑡</ci></apply><apply id="S3.E31.m1.6.6.6.4.1.3.cmml" xref="S3.E31.m1.6.6.6.4.1.3"><csymbol cd="ambiguous" id="S3.E31.m1.6.6.6.4.1.3.1.cmml" xref="S3.E31.m1.6.6.6.4.1.3">subscript</csymbol><apply id="S3.E31.m1.6.6.6.4.1.3.2.cmml" xref="S3.E31.m1.6.6.6.4.1.3.2"><ci id="S3.E31.m1.6.6.6.4.1.3.2.1.cmml" xref="S3.E31.m1.6.6.6.4.1.3.2.1">^</ci><ci id="S3.E31.m1.6.6.6.4.1.3.2.2.cmml" xref="S3.E31.m1.6.6.6.4.1.3.2.2">𝑇</ci></apply><ci id="S3.E31.m1.6.6.6.4.1.3.3.cmml" xref="S3.E31.m1.6.6.6.4.1.3.3">𝑝</ci></apply></apply><apply id="S3.E31.m1.6.6.6.4.2.cmml" xref="S3.E31.m1.6.6.6.4.2"><apply id="S3.E31.m1.6.6.6.4.2.1.cmml" xref="S3.E31.m1.6.6.6.4.2.1"><csymbol cd="ambiguous" id="S3.E31.m1.6.6.6.4.2.1.1.cmml" xref="S3.E31.m1.6.6.6.4.2.1">subscript</csymbol><sum id="S3.E31.m1.6.6.6.4.2.1.2.cmml" xref="S3.E31.m1.6.6.6.4.2.1.2"></sum><list id="S3.E31.m1.6.6.6.2.2.3.cmml" xref="S3.E31.m1.6.6.6.2.2.4"><ci id="S3.E31.m1.5.5.5.1.1.1.cmml" xref="S3.E31.m1.5.5.5.1.1.1">𝑖</ci><ci id="S3.E31.m1.6.6.6.2.2.2.cmml" xref="S3.E31.m1.6.6.6.2.2.2">𝑗</ci></list></apply><cn id="S3.E31.m1.6.6.6.4.2.2.cmml" type="integer" xref="S3.E31.m1.6.6.6.4.2.2">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E31.m1.6c">\textbf{DDI }=\frac{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}\sum_{i,j}\left|\left\{%
\left(u_{i},u_{j}\right)\in\hat{Y}_{t}^{(p)}\mid\left(u_{i},u_{j}\right)\in%
\mathcal{G}_{d}\right\}\right|}{\sum_{p}^{N}\sum_{t}^{\hat{T}_{p}}\sum_{i,j}1}</annotation><annotation encoding="application/x-llamapun" id="S3.E31.m1.6d">DDI = divide start_ARG ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT | { ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT ∣ ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_G start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT } | end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT 1 end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.5">We also utilize the ranking evaluation to discuss the method’s performance in different ranks, and how the model is reliable. Notably, for all of the metrics if the specific rank is <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_k</annotation></semantics></math> we only consider inputs with target visits that have more than <math alttext="k-1" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">k</mi><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">−</mo><mn id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><minus id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></minus><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑘</ci><cn id="S3.SS3.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">k-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_k - 1</annotation></semantics></math> prescriptions. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.5.1">Hit@k</span> equals the hit rate of top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_k</annotation></semantics></math> ranked prescriptions which all of them appear in the ground truth drugs, as indicated in equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.E32" title="In 3.3. Evaluation Metrics ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">32</span></a> where <math alttext="Ranked(\hat{y}_{t}^{(p)},k)" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.3"><semantics id="S3.SS3.p2.4.m4.3a"><mrow id="S3.SS3.p2.4.m4.3.3" xref="S3.SS3.p2.4.m4.3.3.cmml"><mi id="S3.SS3.p2.4.m4.3.3.3" xref="S3.SS3.p2.4.m4.3.3.3.cmml">R</mi><mo id="S3.SS3.p2.4.m4.3.3.2" xref="S3.SS3.p2.4.m4.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.3.3.4" xref="S3.SS3.p2.4.m4.3.3.4.cmml">a</mi><mo id="S3.SS3.p2.4.m4.3.3.2a" xref="S3.SS3.p2.4.m4.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.3.3.5" xref="S3.SS3.p2.4.m4.3.3.5.cmml">n</mi><mo id="S3.SS3.p2.4.m4.3.3.2b" xref="S3.SS3.p2.4.m4.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.3.3.6" xref="S3.SS3.p2.4.m4.3.3.6.cmml">k</mi><mo id="S3.SS3.p2.4.m4.3.3.2c" xref="S3.SS3.p2.4.m4.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.3.3.7" xref="S3.SS3.p2.4.m4.3.3.7.cmml">e</mi><mo id="S3.SS3.p2.4.m4.3.3.2d" xref="S3.SS3.p2.4.m4.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.3.3.8" xref="S3.SS3.p2.4.m4.3.3.8.cmml">d</mi><mo id="S3.SS3.p2.4.m4.3.3.2e" xref="S3.SS3.p2.4.m4.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.3.3.1.1" xref="S3.SS3.p2.4.m4.3.3.1.2.cmml"><mo id="S3.SS3.p2.4.m4.3.3.1.1.2" stretchy="false" xref="S3.SS3.p2.4.m4.3.3.1.2.cmml">(</mo><msubsup id="S3.SS3.p2.4.m4.3.3.1.1.1" xref="S3.SS3.p2.4.m4.3.3.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.4.m4.3.3.1.1.1.2.2" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.cmml"><mi id="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.2" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.2.cmml">y</mi><mo id="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.1" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.4.m4.3.3.1.1.1.2.3" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p2.4.m4.1.1.1.3" xref="S3.SS3.p2.4.m4.3.3.1.1.1.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.4.m4.3.3.1.1.1.cmml">(</mo><mi id="S3.SS3.p2.4.m4.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p2.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.4.m4.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.4.m4.3.3.1.1.3" xref="S3.SS3.p2.4.m4.3.3.1.2.cmml">,</mo><mi id="S3.SS3.p2.4.m4.2.2" xref="S3.SS3.p2.4.m4.2.2.cmml">k</mi><mo id="S3.SS3.p2.4.m4.3.3.1.1.4" stretchy="false" xref="S3.SS3.p2.4.m4.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.3b"><apply id="S3.SS3.p2.4.m4.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3"><times id="S3.SS3.p2.4.m4.3.3.2.cmml" xref="S3.SS3.p2.4.m4.3.3.2"></times><ci id="S3.SS3.p2.4.m4.3.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3.3">𝑅</ci><ci id="S3.SS3.p2.4.m4.3.3.4.cmml" xref="S3.SS3.p2.4.m4.3.3.4">𝑎</ci><ci id="S3.SS3.p2.4.m4.3.3.5.cmml" xref="S3.SS3.p2.4.m4.3.3.5">𝑛</ci><ci id="S3.SS3.p2.4.m4.3.3.6.cmml" xref="S3.SS3.p2.4.m4.3.3.6">𝑘</ci><ci id="S3.SS3.p2.4.m4.3.3.7.cmml" xref="S3.SS3.p2.4.m4.3.3.7">𝑒</ci><ci id="S3.SS3.p2.4.m4.3.3.8.cmml" xref="S3.SS3.p2.4.m4.3.3.8">𝑑</ci><interval closure="open" id="S3.SS3.p2.4.m4.3.3.1.2.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1"><apply id="S3.SS3.p2.4.m4.3.3.1.1.1.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.2"><ci id="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.2.2">𝑦</ci></apply><ci id="S3.SS3.p2.4.m4.3.3.1.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.3.3.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1">𝑝</ci></apply><ci id="S3.SS3.p2.4.m4.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.3c">Ranked(\hat{y}_{t}^{(p)},k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.3d">italic_R italic_a italic_n italic_k italic_e italic_d ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT , italic_k )</annotation></semantics></math> equals to top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_k</annotation></semantics></math> ranked prescription based on their prediction score.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E32">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(32)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\textbf{Hit@k}=\frac{1}{\Sigma_{p}^{N}\Sigma_{t}^{\hat{T}_{p}}1}\sum_{p}%
^{N}\sum_{t}^{\hat{T}_{p}}\omega_{t}^{(p)};\quad\omega_{t}^{(P)}=\left\{\begin%
{array}[]{l}1:Ranked(\hat{y}_{t}^{(p)},k)\subset y_{t}^{(p)}\\
0:\text{otherwise }\end{array}\right." class="ltx_Math" display="block" id="S3.E32.m1.8"><semantics id="S3.E32.m1.8a"><mrow id="S3.E32.m1.8.8.2" xref="S3.E32.m1.8.8.3.cmml"><mrow id="S3.E32.m1.7.7.1.1" xref="S3.E32.m1.7.7.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E32.m1.7.7.1.1.2" mathsize="90%" xref="S3.E32.m1.7.7.1.1.2a.cmml">Hit@k</mtext><mo id="S3.E32.m1.7.7.1.1.1" mathsize="90%" xref="S3.E32.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E32.m1.7.7.1.1.3" xref="S3.E32.m1.7.7.1.1.3.cmml"><mfrac id="S3.E32.m1.7.7.1.1.3.2" xref="S3.E32.m1.7.7.1.1.3.2.cmml"><mn id="S3.E32.m1.7.7.1.1.3.2.2" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.2.cmml">1</mn><mrow id="S3.E32.m1.7.7.1.1.3.2.3" xref="S3.E32.m1.7.7.1.1.3.2.3.cmml"><msubsup id="S3.E32.m1.7.7.1.1.3.2.3.2" xref="S3.E32.m1.7.7.1.1.3.2.3.2.cmml"><mi id="S3.E32.m1.7.7.1.1.3.2.3.2.2.2" mathsize="90%" mathvariant="normal" xref="S3.E32.m1.7.7.1.1.3.2.3.2.2.2.cmml">Σ</mi><mi id="S3.E32.m1.7.7.1.1.3.2.3.2.2.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.3.2.2.3.cmml">p</mi><mi id="S3.E32.m1.7.7.1.1.3.2.3.2.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.3.2.3.cmml">N</mi></msubsup><mo id="S3.E32.m1.7.7.1.1.3.2.3.1" xref="S3.E32.m1.7.7.1.1.3.2.3.1.cmml">⁢</mo><msubsup id="S3.E32.m1.7.7.1.1.3.2.3.3" xref="S3.E32.m1.7.7.1.1.3.2.3.3.cmml"><mi id="S3.E32.m1.7.7.1.1.3.2.3.3.2.2" mathsize="90%" mathvariant="normal" xref="S3.E32.m1.7.7.1.1.3.2.3.3.2.2.cmml">Σ</mi><mi id="S3.E32.m1.7.7.1.1.3.2.3.3.2.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.3.3.2.3.cmml">t</mi><msub id="S3.E32.m1.7.7.1.1.3.2.3.3.3" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.cmml"><mover accent="true" id="S3.E32.m1.7.7.1.1.3.2.3.3.3.2" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.cmml"><mi id="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.2" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.2.cmml">T</mi><mo id="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.1" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.1.cmml">^</mo></mover><mi id="S3.E32.m1.7.7.1.1.3.2.3.3.3.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.3.cmml">p</mi></msub></msubsup><mo id="S3.E32.m1.7.7.1.1.3.2.3.1a" xref="S3.E32.m1.7.7.1.1.3.2.3.1.cmml">⁢</mo><mn id="S3.E32.m1.7.7.1.1.3.2.3.4" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.2.3.4.cmml">1</mn></mrow></mfrac><mo id="S3.E32.m1.7.7.1.1.3.1" xref="S3.E32.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S3.E32.m1.7.7.1.1.3.3" xref="S3.E32.m1.7.7.1.1.3.3.cmml"><munderover id="S3.E32.m1.7.7.1.1.3.3.1" xref="S3.E32.m1.7.7.1.1.3.3.1.cmml"><mo id="S3.E32.m1.7.7.1.1.3.3.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" xref="S3.E32.m1.7.7.1.1.3.3.1.2.2.cmml">∑</mo><mi id="S3.E32.m1.7.7.1.1.3.3.1.2.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.1.2.3.cmml">p</mi><mi id="S3.E32.m1.7.7.1.1.3.3.1.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.1.3.cmml">N</mi></munderover><mrow id="S3.E32.m1.7.7.1.1.3.3.2" xref="S3.E32.m1.7.7.1.1.3.3.2.cmml"><munderover id="S3.E32.m1.7.7.1.1.3.3.2.1" xref="S3.E32.m1.7.7.1.1.3.3.2.1.cmml"><mo id="S3.E32.m1.7.7.1.1.3.3.2.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S3.E32.m1.7.7.1.1.3.3.2.1.2.2.cmml">∑</mo><mi id="S3.E32.m1.7.7.1.1.3.3.2.1.2.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.1.2.3.cmml">t</mi><msub id="S3.E32.m1.7.7.1.1.3.3.2.1.3" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.cmml"><mover accent="true" id="S3.E32.m1.7.7.1.1.3.3.2.1.3.2" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.cmml"><mi id="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.2" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.2.cmml">T</mi><mo id="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.1" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.1.cmml">^</mo></mover><mi id="S3.E32.m1.7.7.1.1.3.3.2.1.3.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.3.cmml">p</mi></msub></munderover><msubsup id="S3.E32.m1.7.7.1.1.3.3.2.2" xref="S3.E32.m1.7.7.1.1.3.3.2.2.cmml"><mi id="S3.E32.m1.7.7.1.1.3.3.2.2.2.2" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.2.2.2.cmml">ω</mi><mi id="S3.E32.m1.7.7.1.1.3.3.2.2.2.3" mathsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.2.2.3.cmml">t</mi><mrow id="S3.E32.m1.1.1.1.3" xref="S3.E32.m1.7.7.1.1.3.3.2.2.cmml"><mo id="S3.E32.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.2.cmml">(</mo><mi id="S3.E32.m1.1.1.1.1" mathsize="90%" xref="S3.E32.m1.1.1.1.1.cmml">p</mi><mo id="S3.E32.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="S3.E32.m1.7.7.1.1.3.3.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><mo id="S3.E32.m1.8.8.2.3" mathsize="90%" rspace="1.067em" xref="S3.E32.m1.8.8.3a.cmml">;</mo><mrow id="S3.E32.m1.8.8.2.2" xref="S3.E32.m1.8.8.2.2.cmml"><msubsup id="S3.E32.m1.8.8.2.2.2" xref="S3.E32.m1.8.8.2.2.2.cmml"><mi id="S3.E32.m1.8.8.2.2.2.2.2" mathsize="90%" xref="S3.E32.m1.8.8.2.2.2.2.2.cmml">ω</mi><mi id="S3.E32.m1.8.8.2.2.2.2.3" mathsize="90%" xref="S3.E32.m1.8.8.2.2.2.2.3.cmml">t</mi><mrow id="S3.E32.m1.2.2.1.3" xref="S3.E32.m1.8.8.2.2.2.cmml"><mo id="S3.E32.m1.2.2.1.3.1" maxsize="90%" minsize="90%" xref="S3.E32.m1.8.8.2.2.2.cmml">(</mo><mi id="S3.E32.m1.2.2.1.1" mathsize="90%" xref="S3.E32.m1.2.2.1.1.cmml">P</mi><mo id="S3.E32.m1.2.2.1.3.2" maxsize="90%" minsize="90%" xref="S3.E32.m1.8.8.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E32.m1.8.8.2.2.1" mathsize="90%" xref="S3.E32.m1.8.8.2.2.1.cmml">=</mo><mrow id="S3.E32.m1.8.8.2.2.3.2" xref="S3.E32.m1.8.8.2.2.3.1.cmml"><mo id="S3.E32.m1.8.8.2.2.3.2.1" xref="S3.E32.m1.8.8.2.2.3.1.1.cmml">{</mo><mtable displaystyle="true" id="S3.E32.m1.6.6" rowspacing="0pt" xref="S3.E32.m1.6.6.cmml"><mtr id="S3.E32.m1.6.6a" xref="S3.E32.m1.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E32.m1.6.6b" xref="S3.E32.m1.6.6.cmml"><mrow id="S3.E32.m1.6.6.4.4.4" xref="S3.E32.m1.6.6.4.4.4.cmml"><mn id="S3.E32.m1.6.6.4.4.4.6" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.6.cmml">1</mn><mo id="S3.E32.m1.6.6.4.4.4.5" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="S3.E32.m1.6.6.4.4.4.5.cmml">:</mo><mrow id="S3.E32.m1.6.6.4.4.4.4" xref="S3.E32.m1.6.6.4.4.4.4.cmml"><mrow id="S3.E32.m1.6.6.4.4.4.4.1" xref="S3.E32.m1.6.6.4.4.4.4.1.cmml"><mi id="S3.E32.m1.6.6.4.4.4.4.1.3" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.3.cmml">R</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.2" xref="S3.E32.m1.6.6.4.4.4.4.1.2.cmml">⁢</mo><mi id="S3.E32.m1.6.6.4.4.4.4.1.4" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.4.cmml">a</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.2a" xref="S3.E32.m1.6.6.4.4.4.4.1.2.cmml">⁢</mo><mi id="S3.E32.m1.6.6.4.4.4.4.1.5" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.5.cmml">n</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.2b" xref="S3.E32.m1.6.6.4.4.4.4.1.2.cmml">⁢</mo><mi id="S3.E32.m1.6.6.4.4.4.4.1.6" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.6.cmml">k</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.2c" xref="S3.E32.m1.6.6.4.4.4.4.1.2.cmml">⁢</mo><mi id="S3.E32.m1.6.6.4.4.4.4.1.7" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.7.cmml">e</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.2d" xref="S3.E32.m1.6.6.4.4.4.4.1.2.cmml">⁢</mo><mi id="S3.E32.m1.6.6.4.4.4.4.1.8" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.8.cmml">d</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.2e" xref="S3.E32.m1.6.6.4.4.4.4.1.2.cmml">⁢</mo><mrow id="S3.E32.m1.6.6.4.4.4.4.1.1.1" xref="S3.E32.m1.6.6.4.4.4.4.1.1.2.cmml"><mo id="S3.E32.m1.6.6.4.4.4.4.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.2.cmml">(</mo><msubsup id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.cmml"><mover accent="true" id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.cmml"><mi id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.2" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.1" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.3" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.E32.m1.3.3.1.1.1.1.1.3" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.cmml"><mo id="S3.E32.m1.3.3.1.1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.cmml">(</mo><mi id="S3.E32.m1.3.3.1.1.1.1.1.1" mathsize="90%" xref="S3.E32.m1.3.3.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E32.m1.3.3.1.1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E32.m1.6.6.4.4.4.4.1.1.1.3" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.2.cmml">,</mo><mi id="S3.E32.m1.5.5.3.3.3.3" mathsize="90%" xref="S3.E32.m1.5.5.3.3.3.3.cmml">k</mi><mo id="S3.E32.m1.6.6.4.4.4.4.1.1.1.4" maxsize="90%" minsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E32.m1.6.6.4.4.4.4.2" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.2.cmml">⊂</mo><msubsup id="S3.E32.m1.6.6.4.4.4.4.3" xref="S3.E32.m1.6.6.4.4.4.4.3.cmml"><mi id="S3.E32.m1.6.6.4.4.4.4.3.2.2" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.3.2.2.cmml">y</mi><mi id="S3.E32.m1.6.6.4.4.4.4.3.2.3" mathsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.3.2.3.cmml">t</mi><mrow id="S3.E32.m1.4.4.2.2.2.2.1.3" xref="S3.E32.m1.6.6.4.4.4.4.3.cmml"><mo id="S3.E32.m1.4.4.2.2.2.2.1.3.1" maxsize="90%" minsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.3.cmml">(</mo><mi id="S3.E32.m1.4.4.2.2.2.2.1.1" mathsize="90%" xref="S3.E32.m1.4.4.2.2.2.2.1.1.cmml">p</mi><mo id="S3.E32.m1.4.4.2.2.2.2.1.3.2" maxsize="90%" minsize="90%" xref="S3.E32.m1.6.6.4.4.4.4.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mtd></mtr><mtr id="S3.E32.m1.6.6c" xref="S3.E32.m1.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E32.m1.6.6d" xref="S3.E32.m1.6.6.cmml"><mrow id="S3.E32.m1.6.6.5.1.1" xref="S3.E32.m1.6.6.5.1.1.cmml"><mn id="S3.E32.m1.6.6.5.1.1.2" mathsize="90%" xref="S3.E32.m1.6.6.5.1.1.2.cmml">0</mn><mo id="S3.E32.m1.6.6.5.1.1.1" lspace="0.278em" mathsize="90%" rspace="0.278em" xref="S3.E32.m1.6.6.5.1.1.1.cmml">:</mo><mtext id="S3.E32.m1.6.6.5.1.1.3" mathsize="90%" xref="S3.E32.m1.6.6.5.1.1.3a.cmml">otherwise </mtext></mrow></mtd></mtr></mtable><mi id="S3.E32.m1.8.8.2.2.3.2.2" xref="S3.E32.m1.8.8.2.2.3.1.1.cmml"></mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E32.m1.8b"><apply id="S3.E32.m1.8.8.3.cmml" xref="S3.E32.m1.8.8.2"><csymbol cd="ambiguous" id="S3.E32.m1.8.8.3a.cmml" xref="S3.E32.m1.8.8.2.3">formulae-sequence</csymbol><apply id="S3.E32.m1.7.7.1.1.cmml" xref="S3.E32.m1.7.7.1.1"><eq id="S3.E32.m1.7.7.1.1.1.cmml" xref="S3.E32.m1.7.7.1.1.1"></eq><ci id="S3.E32.m1.7.7.1.1.2a.cmml" xref="S3.E32.m1.7.7.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E32.m1.7.7.1.1.2.cmml" mathsize="90%" xref="S3.E32.m1.7.7.1.1.2">Hit@k</mtext></ci><apply id="S3.E32.m1.7.7.1.1.3.cmml" xref="S3.E32.m1.7.7.1.1.3"><times id="S3.E32.m1.7.7.1.1.3.1.cmml" xref="S3.E32.m1.7.7.1.1.3.1"></times><apply id="S3.E32.m1.7.7.1.1.3.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2"><divide id="S3.E32.m1.7.7.1.1.3.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2"></divide><cn id="S3.E32.m1.7.7.1.1.3.2.2.cmml" type="integer" xref="S3.E32.m1.7.7.1.1.3.2.2">1</cn><apply id="S3.E32.m1.7.7.1.1.3.2.3.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3"><times id="S3.E32.m1.7.7.1.1.3.2.3.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.1"></times><apply id="S3.E32.m1.7.7.1.1.3.2.3.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.2.3.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.2">superscript</csymbol><apply id="S3.E32.m1.7.7.1.1.3.2.3.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.2.3.2.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.2">subscript</csymbol><ci id="S3.E32.m1.7.7.1.1.3.2.3.2.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.2.2.2">Σ</ci><ci id="S3.E32.m1.7.7.1.1.3.2.3.2.2.3.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.2.2.3">𝑝</ci></apply><ci id="S3.E32.m1.7.7.1.1.3.2.3.2.3.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.2.3">𝑁</ci></apply><apply id="S3.E32.m1.7.7.1.1.3.2.3.3.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.2.3.3.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3">superscript</csymbol><apply id="S3.E32.m1.7.7.1.1.3.2.3.3.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.2.3.3.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3">subscript</csymbol><ci id="S3.E32.m1.7.7.1.1.3.2.3.3.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.2.2">Σ</ci><ci id="S3.E32.m1.7.7.1.1.3.2.3.3.2.3.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.2.3">𝑡</ci></apply><apply id="S3.E32.m1.7.7.1.1.3.2.3.3.3.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.2.3.3.3.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3">subscript</csymbol><apply id="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.2"><ci id="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.1">^</ci><ci id="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.2.2">𝑇</ci></apply><ci id="S3.E32.m1.7.7.1.1.3.2.3.3.3.3.cmml" xref="S3.E32.m1.7.7.1.1.3.2.3.3.3.3">𝑝</ci></apply></apply><cn id="S3.E32.m1.7.7.1.1.3.2.3.4.cmml" type="integer" xref="S3.E32.m1.7.7.1.1.3.2.3.4">1</cn></apply></apply><apply id="S3.E32.m1.7.7.1.1.3.3.cmml" xref="S3.E32.m1.7.7.1.1.3.3"><apply id="S3.E32.m1.7.7.1.1.3.3.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.3.1.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.1">superscript</csymbol><apply id="S3.E32.m1.7.7.1.1.3.3.1.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.3.1.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.1">subscript</csymbol><sum id="S3.E32.m1.7.7.1.1.3.3.1.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.1.2.2"></sum><ci id="S3.E32.m1.7.7.1.1.3.3.1.2.3.cmml" xref="S3.E32.m1.7.7.1.1.3.3.1.2.3">𝑝</ci></apply><ci id="S3.E32.m1.7.7.1.1.3.3.1.3.cmml" xref="S3.E32.m1.7.7.1.1.3.3.1.3">𝑁</ci></apply><apply id="S3.E32.m1.7.7.1.1.3.3.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2"><apply id="S3.E32.m1.7.7.1.1.3.3.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.3.2.1.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1">superscript</csymbol><apply id="S3.E32.m1.7.7.1.1.3.3.2.1.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.3.2.1.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1">subscript</csymbol><sum id="S3.E32.m1.7.7.1.1.3.3.2.1.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.2.2"></sum><ci id="S3.E32.m1.7.7.1.1.3.3.2.1.2.3.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.2.3">𝑡</ci></apply><apply id="S3.E32.m1.7.7.1.1.3.3.2.1.3.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.3.2.1.3.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3">subscript</csymbol><apply id="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.2"><ci id="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.1">^</ci><ci id="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.2.2">𝑇</ci></apply><ci id="S3.E32.m1.7.7.1.1.3.3.2.1.3.3.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.1.3.3">𝑝</ci></apply></apply><apply id="S3.E32.m1.7.7.1.1.3.3.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.3.2.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.2">superscript</csymbol><apply id="S3.E32.m1.7.7.1.1.3.3.2.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E32.m1.7.7.1.1.3.3.2.2.2.1.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E32.m1.7.7.1.1.3.3.2.2.2.2.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.2.2.2">𝜔</ci><ci id="S3.E32.m1.7.7.1.1.3.3.2.2.2.3.cmml" xref="S3.E32.m1.7.7.1.1.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.E32.m1.1.1.1.1.cmml" xref="S3.E32.m1.1.1.1.1">𝑝</ci></apply></apply></apply></apply></apply><apply id="S3.E32.m1.8.8.2.2.cmml" xref="S3.E32.m1.8.8.2.2"><eq id="S3.E32.m1.8.8.2.2.1.cmml" xref="S3.E32.m1.8.8.2.2.1"></eq><apply id="S3.E32.m1.8.8.2.2.2.cmml" xref="S3.E32.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.E32.m1.8.8.2.2.2.1.cmml" xref="S3.E32.m1.8.8.2.2.2">superscript</csymbol><apply id="S3.E32.m1.8.8.2.2.2.2.cmml" xref="S3.E32.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.E32.m1.8.8.2.2.2.2.1.cmml" xref="S3.E32.m1.8.8.2.2.2">subscript</csymbol><ci id="S3.E32.m1.8.8.2.2.2.2.2.cmml" xref="S3.E32.m1.8.8.2.2.2.2.2">𝜔</ci><ci id="S3.E32.m1.8.8.2.2.2.2.3.cmml" xref="S3.E32.m1.8.8.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E32.m1.2.2.1.1.cmml" xref="S3.E32.m1.2.2.1.1">𝑃</ci></apply><apply id="S3.E32.m1.8.8.2.2.3.1.cmml" xref="S3.E32.m1.8.8.2.2.3.2"><csymbol cd="latexml" id="S3.E32.m1.8.8.2.2.3.1.1.cmml" xref="S3.E32.m1.8.8.2.2.3.2.1">cases</csymbol><matrix id="S3.E32.m1.6.6.cmml" xref="S3.E32.m1.6.6"><matrixrow id="S3.E32.m1.6.6a.cmml" xref="S3.E32.m1.6.6"><apply id="S3.E32.m1.6.6.4.4.4.cmml" xref="S3.E32.m1.6.6.4.4.4"><ci id="S3.E32.m1.6.6.4.4.4.5.cmml" xref="S3.E32.m1.6.6.4.4.4.5">:</ci><cn id="S3.E32.m1.6.6.4.4.4.6.cmml" type="integer" xref="S3.E32.m1.6.6.4.4.4.6">1</cn><apply id="S3.E32.m1.6.6.4.4.4.4.cmml" xref="S3.E32.m1.6.6.4.4.4.4"><subset id="S3.E32.m1.6.6.4.4.4.4.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.2"></subset><apply id="S3.E32.m1.6.6.4.4.4.4.1.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1"><times id="S3.E32.m1.6.6.4.4.4.4.1.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.2"></times><ci id="S3.E32.m1.6.6.4.4.4.4.1.3.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.3">𝑅</ci><ci id="S3.E32.m1.6.6.4.4.4.4.1.4.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.4">𝑎</ci><ci id="S3.E32.m1.6.6.4.4.4.4.1.5.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.5">𝑛</ci><ci id="S3.E32.m1.6.6.4.4.4.4.1.6.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.6">𝑘</ci><ci id="S3.E32.m1.6.6.4.4.4.4.1.7.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.7">𝑒</ci><ci id="S3.E32.m1.6.6.4.4.4.4.1.8.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.8">𝑑</ci><interval closure="open" id="S3.E32.m1.6.6.4.4.4.4.1.1.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1"><apply id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.1.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1">superscript</csymbol><apply id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.1.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1">subscript</csymbol><apply id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2"><ci id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.1.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.1">^</ci><ci id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.3.cmml" xref="S3.E32.m1.6.6.4.4.4.4.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E32.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E32.m1.3.3.1.1.1.1.1.1">𝑝</ci></apply><ci id="S3.E32.m1.5.5.3.3.3.3.cmml" xref="S3.E32.m1.5.5.3.3.3.3">𝑘</ci></interval></apply><apply id="S3.E32.m1.6.6.4.4.4.4.3.cmml" xref="S3.E32.m1.6.6.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.E32.m1.6.6.4.4.4.4.3.1.cmml" xref="S3.E32.m1.6.6.4.4.4.4.3">superscript</csymbol><apply id="S3.E32.m1.6.6.4.4.4.4.3.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.E32.m1.6.6.4.4.4.4.3.2.1.cmml" xref="S3.E32.m1.6.6.4.4.4.4.3">subscript</csymbol><ci id="S3.E32.m1.6.6.4.4.4.4.3.2.2.cmml" xref="S3.E32.m1.6.6.4.4.4.4.3.2.2">𝑦</ci><ci id="S3.E32.m1.6.6.4.4.4.4.3.2.3.cmml" xref="S3.E32.m1.6.6.4.4.4.4.3.2.3">𝑡</ci></apply><ci id="S3.E32.m1.4.4.2.2.2.2.1.1.cmml" xref="S3.E32.m1.4.4.2.2.2.2.1.1">𝑝</ci></apply></apply></apply></matrixrow><matrixrow id="S3.E32.m1.6.6b.cmml" xref="S3.E32.m1.6.6"><apply id="S3.E32.m1.6.6.5.1.1.cmml" xref="S3.E32.m1.6.6.5.1.1"><ci id="S3.E32.m1.6.6.5.1.1.1.cmml" xref="S3.E32.m1.6.6.5.1.1.1">:</ci><cn id="S3.E32.m1.6.6.5.1.1.2.cmml" type="integer" xref="S3.E32.m1.6.6.5.1.1.2">0</cn><ci id="S3.E32.m1.6.6.5.1.1.3a.cmml" xref="S3.E32.m1.6.6.5.1.1.3"><mtext id="S3.E32.m1.6.6.5.1.1.3.cmml" mathsize="90%" xref="S3.E32.m1.6.6.5.1.1.3">otherwise </mtext></ci></apply></matrixrow></matrix></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E32.m1.8c">\small\textbf{Hit@k}=\frac{1}{\Sigma_{p}^{N}\Sigma_{t}^{\hat{T}_{p}}1}\sum_{p}%
^{N}\sum_{t}^{\hat{T}_{p}}\omega_{t}^{(p)};\quad\omega_{t}^{(P)}=\left\{\begin%
{array}[]{l}1:Ranked(\hat{y}_{t}^{(p)},k)\subset y_{t}^{(p)}\\
0:\text{otherwise }\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.E32.m1.8d">Hit@k = divide start_ARG 1 end_ARG start_ARG roman_Σ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_Σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT 1 end_ARG ∑ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_ω start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT ; italic_ω start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_P ) end_POSTSUPERSCRIPT = { start_ARRAY start_ROW start_CELL 1 : italic_R italic_a italic_n italic_k italic_e italic_d ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT , italic_k ) ⊂ italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL 0 : otherwise end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.9"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.9.1">NDCG@k</span> is a commonly used metric for ranking the performance of recommendation systems. The formulation is shown in equation <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.E33" title="In 3.3. Evaluation Metrics ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">33</span></a> , where in <math alttext="DCG^{(p)}_{t}@k=\sum_{i=1}^{k}Rank(\sigma(\hat{y}_{t}^{(p)}),k)_{i}/\log_{2}(i%
+1)" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m1.6"><semantics id="S3.SS3.p2.6.m1.6a"><mrow id="S3.SS3.p2.6.m1.6.6" xref="S3.SS3.p2.6.m1.6.6.cmml"><mrow id="S3.SS3.p2.6.m1.6.6.5" xref="S3.SS3.p2.6.m1.6.6.5.cmml"><mi id="S3.SS3.p2.6.m1.6.6.5.2" xref="S3.SS3.p2.6.m1.6.6.5.2.cmml">D</mi><mo id="S3.SS3.p2.6.m1.6.6.5.1" xref="S3.SS3.p2.6.m1.6.6.5.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m1.6.6.5.3" xref="S3.SS3.p2.6.m1.6.6.5.3.cmml">C</mi><mo id="S3.SS3.p2.6.m1.6.6.5.1a" xref="S3.SS3.p2.6.m1.6.6.5.1.cmml">⁢</mo><msubsup id="S3.SS3.p2.6.m1.6.6.5.4" xref="S3.SS3.p2.6.m1.6.6.5.4.cmml"><mi id="S3.SS3.p2.6.m1.6.6.5.4.2.2" xref="S3.SS3.p2.6.m1.6.6.5.4.2.2.cmml">G</mi><mi id="S3.SS3.p2.6.m1.6.6.5.4.3" xref="S3.SS3.p2.6.m1.6.6.5.4.3.cmml">t</mi><mrow id="S3.SS3.p2.6.m1.1.1.1.3" xref="S3.SS3.p2.6.m1.6.6.5.4.cmml"><mo id="S3.SS3.p2.6.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.6.m1.6.6.5.4.cmml">(</mo><mi id="S3.SS3.p2.6.m1.1.1.1.1" xref="S3.SS3.p2.6.m1.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p2.6.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.6.m1.6.6.5.4.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.6.m1.6.6.5.1b" xref="S3.SS3.p2.6.m1.6.6.5.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m1.6.6.5.5" mathvariant="normal" xref="S3.SS3.p2.6.m1.6.6.5.5.cmml">@</mi><mo id="S3.SS3.p2.6.m1.6.6.5.1c" xref="S3.SS3.p2.6.m1.6.6.5.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m1.6.6.5.6" xref="S3.SS3.p2.6.m1.6.6.5.6.cmml">k</mi></mrow><mo id="S3.SS3.p2.6.m1.6.6.4" rspace="0.111em" xref="S3.SS3.p2.6.m1.6.6.4.cmml">=</mo><mrow id="S3.SS3.p2.6.m1.6.6.3" xref="S3.SS3.p2.6.m1.6.6.3.cmml"><msubsup id="S3.SS3.p2.6.m1.6.6.3.4" xref="S3.SS3.p2.6.m1.6.6.3.4.cmml"><mo id="S3.SS3.p2.6.m1.6.6.3.4.2.2" xref="S3.SS3.p2.6.m1.6.6.3.4.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.6.m1.6.6.3.4.2.3" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3.cmml"><mi id="S3.SS3.p2.6.m1.6.6.3.4.2.3.2" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3.2.cmml">i</mi><mo id="S3.SS3.p2.6.m1.6.6.3.4.2.3.1" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.6.m1.6.6.3.4.2.3.3" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.6.m1.6.6.3.4.3" xref="S3.SS3.p2.6.m1.6.6.3.4.3.cmml">k</mi></msubsup><mrow id="S3.SS3.p2.6.m1.6.6.3.3" xref="S3.SS3.p2.6.m1.6.6.3.3.cmml"><mrow id="S3.SS3.p2.6.m1.4.4.1.1.1" xref="S3.SS3.p2.6.m1.4.4.1.1.1.cmml"><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.3" xref="S3.SS3.p2.6.m1.4.4.1.1.1.3.cmml">R</mi><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.2" xref="S3.SS3.p2.6.m1.4.4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.4" xref="S3.SS3.p2.6.m1.4.4.1.1.1.4.cmml">a</mi><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.2a" xref="S3.SS3.p2.6.m1.4.4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.5" xref="S3.SS3.p2.6.m1.4.4.1.1.1.5.cmml">n</mi><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.2b" xref="S3.SS3.p2.6.m1.4.4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.6" xref="S3.SS3.p2.6.m1.4.4.1.1.1.6.cmml">k</mi><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.2c" xref="S3.SS3.p2.6.m1.4.4.1.1.1.2.cmml">⁢</mo><msub id="S3.SS3.p2.6.m1.4.4.1.1.1.1" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.cmml"><mrow id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p2.6.m1.2.2.1.3" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.6.m1.2.2.1.3.1" stretchy="false" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.p2.6.m1.2.2.1.1" xref="S3.SS3.p2.6.m1.2.2.1.1.cmml">p</mi><mo id="S3.SS3.p2.6.m1.2.2.1.3.2" stretchy="false" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.3" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mi id="S3.SS3.p2.6.m1.3.3" xref="S3.SS3.p2.6.m1.3.3.cmml">k</mi><mo id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.4" stretchy="false" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow><mi id="S3.SS3.p2.6.m1.4.4.1.1.1.1.3" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.p2.6.m1.6.6.3.3.4" xref="S3.SS3.p2.6.m1.6.6.3.3.4.cmml">/</mo><mrow id="S3.SS3.p2.6.m1.6.6.3.3.3.2" xref="S3.SS3.p2.6.m1.6.6.3.3.3.3.cmml"><msub id="S3.SS3.p2.6.m1.5.5.2.2.2.1.1" xref="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.cmml"><mi id="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.2" xref="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.2.cmml">log</mi><mn id="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.3" xref="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.3.cmml">2</mn></msub><mo id="S3.SS3.p2.6.m1.6.6.3.3.3.2a" xref="S3.SS3.p2.6.m1.6.6.3.3.3.3.cmml">⁡</mo><mrow id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2" xref="S3.SS3.p2.6.m1.6.6.3.3.3.3.cmml"><mo id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.2" stretchy="false" xref="S3.SS3.p2.6.m1.6.6.3.3.3.3.cmml">(</mo><mrow id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.cmml"><mi id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.2" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.2.cmml">i</mi><mo id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.1" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.1.cmml">+</mo><mn id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.3" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.3" stretchy="false" xref="S3.SS3.p2.6.m1.6.6.3.3.3.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m1.6b"><apply id="S3.SS3.p2.6.m1.6.6.cmml" xref="S3.SS3.p2.6.m1.6.6"><eq id="S3.SS3.p2.6.m1.6.6.4.cmml" xref="S3.SS3.p2.6.m1.6.6.4"></eq><apply id="S3.SS3.p2.6.m1.6.6.5.cmml" xref="S3.SS3.p2.6.m1.6.6.5"><times id="S3.SS3.p2.6.m1.6.6.5.1.cmml" xref="S3.SS3.p2.6.m1.6.6.5.1"></times><ci id="S3.SS3.p2.6.m1.6.6.5.2.cmml" xref="S3.SS3.p2.6.m1.6.6.5.2">𝐷</ci><ci id="S3.SS3.p2.6.m1.6.6.5.3.cmml" xref="S3.SS3.p2.6.m1.6.6.5.3">𝐶</ci><apply id="S3.SS3.p2.6.m1.6.6.5.4.cmml" xref="S3.SS3.p2.6.m1.6.6.5.4"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.6.6.5.4.1.cmml" xref="S3.SS3.p2.6.m1.6.6.5.4">subscript</csymbol><apply id="S3.SS3.p2.6.m1.6.6.5.4.2.cmml" xref="S3.SS3.p2.6.m1.6.6.5.4"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.6.6.5.4.2.1.cmml" xref="S3.SS3.p2.6.m1.6.6.5.4">superscript</csymbol><ci id="S3.SS3.p2.6.m1.6.6.5.4.2.2.cmml" xref="S3.SS3.p2.6.m1.6.6.5.4.2.2">𝐺</ci><ci id="S3.SS3.p2.6.m1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.1.1.1.1">𝑝</ci></apply><ci id="S3.SS3.p2.6.m1.6.6.5.4.3.cmml" xref="S3.SS3.p2.6.m1.6.6.5.4.3">𝑡</ci></apply><ci id="S3.SS3.p2.6.m1.6.6.5.5.cmml" xref="S3.SS3.p2.6.m1.6.6.5.5">@</ci><ci id="S3.SS3.p2.6.m1.6.6.5.6.cmml" xref="S3.SS3.p2.6.m1.6.6.5.6">𝑘</ci></apply><apply id="S3.SS3.p2.6.m1.6.6.3.cmml" xref="S3.SS3.p2.6.m1.6.6.3"><apply id="S3.SS3.p2.6.m1.6.6.3.4.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.6.6.3.4.1.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4">superscript</csymbol><apply id="S3.SS3.p2.6.m1.6.6.3.4.2.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.6.6.3.4.2.1.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4">subscript</csymbol><sum id="S3.SS3.p2.6.m1.6.6.3.4.2.2.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4.2.2"></sum><apply id="S3.SS3.p2.6.m1.6.6.3.4.2.3.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3"><eq id="S3.SS3.p2.6.m1.6.6.3.4.2.3.1.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3.1"></eq><ci id="S3.SS3.p2.6.m1.6.6.3.4.2.3.2.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3.2">𝑖</ci><cn id="S3.SS3.p2.6.m1.6.6.3.4.2.3.3.cmml" type="integer" xref="S3.SS3.p2.6.m1.6.6.3.4.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.6.m1.6.6.3.4.3.cmml" xref="S3.SS3.p2.6.m1.6.6.3.4.3">𝑘</ci></apply><apply id="S3.SS3.p2.6.m1.6.6.3.3.cmml" xref="S3.SS3.p2.6.m1.6.6.3.3"><divide id="S3.SS3.p2.6.m1.6.6.3.3.4.cmml" xref="S3.SS3.p2.6.m1.6.6.3.3.4"></divide><apply id="S3.SS3.p2.6.m1.4.4.1.1.1.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1"><times id="S3.SS3.p2.6.m1.4.4.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.2"></times><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.3">𝑅</ci><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.4.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.4">𝑎</ci><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.5.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.5">𝑛</ci><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.6.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.6">𝑘</ci><apply id="S3.SS3.p2.6.m1.4.4.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.4.4.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1">subscript</csymbol><interval closure="open" id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1"><apply id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1"><times id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.6.m1.2.2.1.1.cmml" xref="S3.SS3.p2.6.m1.2.2.1.1">𝑝</ci></apply></apply><ci id="S3.SS3.p2.6.m1.3.3.cmml" xref="S3.SS3.p2.6.m1.3.3">𝑘</ci></interval><ci id="S3.SS3.p2.6.m1.4.4.1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m1.4.4.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS3.p2.6.m1.6.6.3.3.3.3.cmml" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2"><apply id="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.cmml" xref="S3.SS3.p2.6.m1.5.5.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.6.m1.5.5.2.2.2.1.1">subscript</csymbol><log id="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.2.cmml" xref="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.2"></log><cn id="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.p2.6.m1.5.5.2.2.2.1.1.3">2</cn></apply><apply id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.cmml" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1"><plus id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.1.cmml" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.1"></plus><ci id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.2.cmml" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.2">𝑖</ci><cn id="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.3.cmml" type="integer" xref="S3.SS3.p2.6.m1.6.6.3.3.3.2.2.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m1.6c">DCG^{(p)}_{t}@k=\sum_{i=1}^{k}Rank(\sigma(\hat{y}_{t}^{(p)}),k)_{i}/\log_{2}(i%
+1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m1.6d">italic_D italic_C italic_G start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT @ italic_k = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_R italic_a italic_n italic_k ( italic_σ ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT ) , italic_k ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT / roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_i + 1 )</annotation></semantics></math>, <math alttext="IDCG^{(p)}_{t}@k=\sum_{i=1}^{k}Rank(y_{t}^{(p)},k)_{i}/\log_{2}(i+1)" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m2.6"><semantics id="S3.SS3.p2.7.m2.6a"><mrow id="S3.SS3.p2.7.m2.6.6" xref="S3.SS3.p2.7.m2.6.6.cmml"><mrow id="S3.SS3.p2.7.m2.6.6.5" xref="S3.SS3.p2.7.m2.6.6.5.cmml"><mi id="S3.SS3.p2.7.m2.6.6.5.2" xref="S3.SS3.p2.7.m2.6.6.5.2.cmml">I</mi><mo id="S3.SS3.p2.7.m2.6.6.5.1" xref="S3.SS3.p2.7.m2.6.6.5.1.cmml">⁢</mo><mi id="S3.SS3.p2.7.m2.6.6.5.3" xref="S3.SS3.p2.7.m2.6.6.5.3.cmml">D</mi><mo id="S3.SS3.p2.7.m2.6.6.5.1a" xref="S3.SS3.p2.7.m2.6.6.5.1.cmml">⁢</mo><mi id="S3.SS3.p2.7.m2.6.6.5.4" xref="S3.SS3.p2.7.m2.6.6.5.4.cmml">C</mi><mo id="S3.SS3.p2.7.m2.6.6.5.1b" xref="S3.SS3.p2.7.m2.6.6.5.1.cmml">⁢</mo><msubsup id="S3.SS3.p2.7.m2.6.6.5.5" xref="S3.SS3.p2.7.m2.6.6.5.5.cmml"><mi id="S3.SS3.p2.7.m2.6.6.5.5.2.2" xref="S3.SS3.p2.7.m2.6.6.5.5.2.2.cmml">G</mi><mi id="S3.SS3.p2.7.m2.6.6.5.5.3" xref="S3.SS3.p2.7.m2.6.6.5.5.3.cmml">t</mi><mrow id="S3.SS3.p2.7.m2.1.1.1.3" xref="S3.SS3.p2.7.m2.6.6.5.5.cmml"><mo id="S3.SS3.p2.7.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.7.m2.6.6.5.5.cmml">(</mo><mi id="S3.SS3.p2.7.m2.1.1.1.1" xref="S3.SS3.p2.7.m2.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p2.7.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.7.m2.6.6.5.5.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.7.m2.6.6.5.1c" xref="S3.SS3.p2.7.m2.6.6.5.1.cmml">⁢</mo><mi id="S3.SS3.p2.7.m2.6.6.5.6" mathvariant="normal" xref="S3.SS3.p2.7.m2.6.6.5.6.cmml">@</mi><mo id="S3.SS3.p2.7.m2.6.6.5.1d" xref="S3.SS3.p2.7.m2.6.6.5.1.cmml">⁢</mo><mi id="S3.SS3.p2.7.m2.6.6.5.7" xref="S3.SS3.p2.7.m2.6.6.5.7.cmml">k</mi></mrow><mo id="S3.SS3.p2.7.m2.6.6.4" rspace="0.111em" xref="S3.SS3.p2.7.m2.6.6.4.cmml">=</mo><mrow id="S3.SS3.p2.7.m2.6.6.3" xref="S3.SS3.p2.7.m2.6.6.3.cmml"><msubsup id="S3.SS3.p2.7.m2.6.6.3.4" xref="S3.SS3.p2.7.m2.6.6.3.4.cmml"><mo id="S3.SS3.p2.7.m2.6.6.3.4.2.2" xref="S3.SS3.p2.7.m2.6.6.3.4.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.7.m2.6.6.3.4.2.3" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3.cmml"><mi id="S3.SS3.p2.7.m2.6.6.3.4.2.3.2" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3.2.cmml">i</mi><mo id="S3.SS3.p2.7.m2.6.6.3.4.2.3.1" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.7.m2.6.6.3.4.2.3.3" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.7.m2.6.6.3.4.3" xref="S3.SS3.p2.7.m2.6.6.3.4.3.cmml">k</mi></msubsup><mrow id="S3.SS3.p2.7.m2.6.6.3.3" xref="S3.SS3.p2.7.m2.6.6.3.3.cmml"><mrow id="S3.SS3.p2.7.m2.4.4.1.1.1" xref="S3.SS3.p2.7.m2.4.4.1.1.1.cmml"><mi id="S3.SS3.p2.7.m2.4.4.1.1.1.3" xref="S3.SS3.p2.7.m2.4.4.1.1.1.3.cmml">R</mi><mo id="S3.SS3.p2.7.m2.4.4.1.1.1.2" xref="S3.SS3.p2.7.m2.4.4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.p2.7.m2.4.4.1.1.1.4" xref="S3.SS3.p2.7.m2.4.4.1.1.1.4.cmml">a</mi><mo id="S3.SS3.p2.7.m2.4.4.1.1.1.2a" xref="S3.SS3.p2.7.m2.4.4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.p2.7.m2.4.4.1.1.1.5" xref="S3.SS3.p2.7.m2.4.4.1.1.1.5.cmml">n</mi><mo id="S3.SS3.p2.7.m2.4.4.1.1.1.2b" xref="S3.SS3.p2.7.m2.4.4.1.1.1.2.cmml">⁢</mo><mi id="S3.SS3.p2.7.m2.4.4.1.1.1.6" xref="S3.SS3.p2.7.m2.4.4.1.1.1.6.cmml">k</mi><mo id="S3.SS3.p2.7.m2.4.4.1.1.1.2c" xref="S3.SS3.p2.7.m2.4.4.1.1.1.2.cmml">⁢</mo><msub id="S3.SS3.p2.7.m2.4.4.1.1.1.1" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.cmml"><mrow id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p2.7.m2.2.2.1.3" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.7.m2.2.2.1.3.1" stretchy="false" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS3.p2.7.m2.2.2.1.1" xref="S3.SS3.p2.7.m2.2.2.1.1.cmml">p</mi><mo id="S3.SS3.p2.7.m2.2.2.1.3.2" stretchy="false" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.3" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.2.cmml">,</mo><mi id="S3.SS3.p2.7.m2.3.3" xref="S3.SS3.p2.7.m2.3.3.cmml">k</mi><mo id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.4" stretchy="false" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.2.cmml">)</mo></mrow><mi id="S3.SS3.p2.7.m2.4.4.1.1.1.1.3" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.p2.7.m2.6.6.3.3.4" xref="S3.SS3.p2.7.m2.6.6.3.3.4.cmml">/</mo><mrow id="S3.SS3.p2.7.m2.6.6.3.3.3.2" xref="S3.SS3.p2.7.m2.6.6.3.3.3.3.cmml"><msub id="S3.SS3.p2.7.m2.5.5.2.2.2.1.1" xref="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.cmml"><mi id="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.2" xref="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.2.cmml">log</mi><mn id="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.3" xref="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.3.cmml">2</mn></msub><mo id="S3.SS3.p2.7.m2.6.6.3.3.3.2a" xref="S3.SS3.p2.7.m2.6.6.3.3.3.3.cmml">⁡</mo><mrow id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2" xref="S3.SS3.p2.7.m2.6.6.3.3.3.3.cmml"><mo id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.2" stretchy="false" xref="S3.SS3.p2.7.m2.6.6.3.3.3.3.cmml">(</mo><mrow id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.cmml"><mi id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.2" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.2.cmml">i</mi><mo id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.1" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.1.cmml">+</mo><mn id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.3" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.3" stretchy="false" xref="S3.SS3.p2.7.m2.6.6.3.3.3.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m2.6b"><apply id="S3.SS3.p2.7.m2.6.6.cmml" xref="S3.SS3.p2.7.m2.6.6"><eq id="S3.SS3.p2.7.m2.6.6.4.cmml" xref="S3.SS3.p2.7.m2.6.6.4"></eq><apply id="S3.SS3.p2.7.m2.6.6.5.cmml" xref="S3.SS3.p2.7.m2.6.6.5"><times id="S3.SS3.p2.7.m2.6.6.5.1.cmml" xref="S3.SS3.p2.7.m2.6.6.5.1"></times><ci id="S3.SS3.p2.7.m2.6.6.5.2.cmml" xref="S3.SS3.p2.7.m2.6.6.5.2">𝐼</ci><ci id="S3.SS3.p2.7.m2.6.6.5.3.cmml" xref="S3.SS3.p2.7.m2.6.6.5.3">𝐷</ci><ci id="S3.SS3.p2.7.m2.6.6.5.4.cmml" xref="S3.SS3.p2.7.m2.6.6.5.4">𝐶</ci><apply id="S3.SS3.p2.7.m2.6.6.5.5.cmml" xref="S3.SS3.p2.7.m2.6.6.5.5"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.6.6.5.5.1.cmml" xref="S3.SS3.p2.7.m2.6.6.5.5">subscript</csymbol><apply id="S3.SS3.p2.7.m2.6.6.5.5.2.cmml" xref="S3.SS3.p2.7.m2.6.6.5.5"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.6.6.5.5.2.1.cmml" xref="S3.SS3.p2.7.m2.6.6.5.5">superscript</csymbol><ci id="S3.SS3.p2.7.m2.6.6.5.5.2.2.cmml" xref="S3.SS3.p2.7.m2.6.6.5.5.2.2">𝐺</ci><ci id="S3.SS3.p2.7.m2.1.1.1.1.cmml" xref="S3.SS3.p2.7.m2.1.1.1.1">𝑝</ci></apply><ci id="S3.SS3.p2.7.m2.6.6.5.5.3.cmml" xref="S3.SS3.p2.7.m2.6.6.5.5.3">𝑡</ci></apply><ci id="S3.SS3.p2.7.m2.6.6.5.6.cmml" xref="S3.SS3.p2.7.m2.6.6.5.6">@</ci><ci id="S3.SS3.p2.7.m2.6.6.5.7.cmml" xref="S3.SS3.p2.7.m2.6.6.5.7">𝑘</ci></apply><apply id="S3.SS3.p2.7.m2.6.6.3.cmml" xref="S3.SS3.p2.7.m2.6.6.3"><apply id="S3.SS3.p2.7.m2.6.6.3.4.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.6.6.3.4.1.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4">superscript</csymbol><apply id="S3.SS3.p2.7.m2.6.6.3.4.2.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.6.6.3.4.2.1.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4">subscript</csymbol><sum id="S3.SS3.p2.7.m2.6.6.3.4.2.2.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4.2.2"></sum><apply id="S3.SS3.p2.7.m2.6.6.3.4.2.3.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3"><eq id="S3.SS3.p2.7.m2.6.6.3.4.2.3.1.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3.1"></eq><ci id="S3.SS3.p2.7.m2.6.6.3.4.2.3.2.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3.2">𝑖</ci><cn id="S3.SS3.p2.7.m2.6.6.3.4.2.3.3.cmml" type="integer" xref="S3.SS3.p2.7.m2.6.6.3.4.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.7.m2.6.6.3.4.3.cmml" xref="S3.SS3.p2.7.m2.6.6.3.4.3">𝑘</ci></apply><apply id="S3.SS3.p2.7.m2.6.6.3.3.cmml" xref="S3.SS3.p2.7.m2.6.6.3.3"><divide id="S3.SS3.p2.7.m2.6.6.3.3.4.cmml" xref="S3.SS3.p2.7.m2.6.6.3.3.4"></divide><apply id="S3.SS3.p2.7.m2.4.4.1.1.1.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1"><times id="S3.SS3.p2.7.m2.4.4.1.1.1.2.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.2"></times><ci id="S3.SS3.p2.7.m2.4.4.1.1.1.3.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.3">𝑅</ci><ci id="S3.SS3.p2.7.m2.4.4.1.1.1.4.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.4">𝑎</ci><ci id="S3.SS3.p2.7.m2.4.4.1.1.1.5.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.5">𝑛</ci><ci id="S3.SS3.p2.7.m2.4.4.1.1.1.6.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.6">𝑘</ci><apply id="S3.SS3.p2.7.m2.4.4.1.1.1.1.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.4.4.1.1.1.1.2.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1">subscript</csymbol><interval closure="open" id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1"><apply id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.7.m2.2.2.1.1.cmml" xref="S3.SS3.p2.7.m2.2.2.1.1">𝑝</ci></apply><ci id="S3.SS3.p2.7.m2.3.3.cmml" xref="S3.SS3.p2.7.m2.3.3">𝑘</ci></interval><ci id="S3.SS3.p2.7.m2.4.4.1.1.1.1.3.cmml" xref="S3.SS3.p2.7.m2.4.4.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS3.p2.7.m2.6.6.3.3.3.3.cmml" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2"><apply id="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.cmml" xref="S3.SS3.p2.7.m2.5.5.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.7.m2.5.5.2.2.2.1.1">subscript</csymbol><log id="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.2.cmml" xref="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.2"></log><cn id="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.p2.7.m2.5.5.2.2.2.1.1.3">2</cn></apply><apply id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.cmml" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1"><plus id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.1.cmml" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.1"></plus><ci id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.2.cmml" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.2">𝑖</ci><cn id="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.3.cmml" type="integer" xref="S3.SS3.p2.7.m2.6.6.3.3.3.2.2.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m2.6c">IDCG^{(p)}_{t}@k=\sum_{i=1}^{k}Rank(y_{t}^{(p)},k)_{i}/\log_{2}(i+1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m2.6d">italic_I italic_D italic_C italic_G start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT @ italic_k = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_R italic_a italic_n italic_k ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT , italic_k ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT / roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_i + 1 )</annotation></semantics></math> and <math alttext="Rank(y_{t}^{(p)},k)" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m3.3"><semantics id="S3.SS3.p2.8.m3.3a"><mrow id="S3.SS3.p2.8.m3.3.3" xref="S3.SS3.p2.8.m3.3.3.cmml"><mi id="S3.SS3.p2.8.m3.3.3.3" xref="S3.SS3.p2.8.m3.3.3.3.cmml">R</mi><mo id="S3.SS3.p2.8.m3.3.3.2" xref="S3.SS3.p2.8.m3.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.8.m3.3.3.4" xref="S3.SS3.p2.8.m3.3.3.4.cmml">a</mi><mo id="S3.SS3.p2.8.m3.3.3.2a" xref="S3.SS3.p2.8.m3.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.8.m3.3.3.5" xref="S3.SS3.p2.8.m3.3.3.5.cmml">n</mi><mo id="S3.SS3.p2.8.m3.3.3.2b" xref="S3.SS3.p2.8.m3.3.3.2.cmml">⁢</mo><mi id="S3.SS3.p2.8.m3.3.3.6" xref="S3.SS3.p2.8.m3.3.3.6.cmml">k</mi><mo id="S3.SS3.p2.8.m3.3.3.2c" xref="S3.SS3.p2.8.m3.3.3.2.cmml">⁢</mo><mrow id="S3.SS3.p2.8.m3.3.3.1.1" xref="S3.SS3.p2.8.m3.3.3.1.2.cmml"><mo id="S3.SS3.p2.8.m3.3.3.1.1.2" stretchy="false" xref="S3.SS3.p2.8.m3.3.3.1.2.cmml">(</mo><msubsup id="S3.SS3.p2.8.m3.3.3.1.1.1" xref="S3.SS3.p2.8.m3.3.3.1.1.1.cmml"><mi id="S3.SS3.p2.8.m3.3.3.1.1.1.2.2" xref="S3.SS3.p2.8.m3.3.3.1.1.1.2.2.cmml">y</mi><mi id="S3.SS3.p2.8.m3.3.3.1.1.1.2.3" xref="S3.SS3.p2.8.m3.3.3.1.1.1.2.3.cmml">t</mi><mrow id="S3.SS3.p2.8.m3.1.1.1.3" xref="S3.SS3.p2.8.m3.3.3.1.1.1.cmml"><mo id="S3.SS3.p2.8.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.8.m3.3.3.1.1.1.cmml">(</mo><mi id="S3.SS3.p2.8.m3.1.1.1.1" xref="S3.SS3.p2.8.m3.1.1.1.1.cmml">p</mi><mo id="S3.SS3.p2.8.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.8.m3.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.SS3.p2.8.m3.3.3.1.1.3" xref="S3.SS3.p2.8.m3.3.3.1.2.cmml">,</mo><mi id="S3.SS3.p2.8.m3.2.2" xref="S3.SS3.p2.8.m3.2.2.cmml">k</mi><mo id="S3.SS3.p2.8.m3.3.3.1.1.4" stretchy="false" xref="S3.SS3.p2.8.m3.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m3.3b"><apply id="S3.SS3.p2.8.m3.3.3.cmml" xref="S3.SS3.p2.8.m3.3.3"><times id="S3.SS3.p2.8.m3.3.3.2.cmml" xref="S3.SS3.p2.8.m3.3.3.2"></times><ci id="S3.SS3.p2.8.m3.3.3.3.cmml" xref="S3.SS3.p2.8.m3.3.3.3">𝑅</ci><ci id="S3.SS3.p2.8.m3.3.3.4.cmml" xref="S3.SS3.p2.8.m3.3.3.4">𝑎</ci><ci id="S3.SS3.p2.8.m3.3.3.5.cmml" xref="S3.SS3.p2.8.m3.3.3.5">𝑛</ci><ci id="S3.SS3.p2.8.m3.3.3.6.cmml" xref="S3.SS3.p2.8.m3.3.3.6">𝑘</ci><interval closure="open" id="S3.SS3.p2.8.m3.3.3.1.2.cmml" xref="S3.SS3.p2.8.m3.3.3.1.1"><apply id="S3.SS3.p2.8.m3.3.3.1.1.1.cmml" xref="S3.SS3.p2.8.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m3.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.8.m3.3.3.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.8.m3.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.8.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m3.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p2.8.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m3.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p2.8.m3.3.3.1.1.1.2.2">𝑦</ci><ci id="S3.SS3.p2.8.m3.3.3.1.1.1.2.3.cmml" xref="S3.SS3.p2.8.m3.3.3.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.8.m3.1.1.1.1.cmml" xref="S3.SS3.p2.8.m3.1.1.1.1">𝑝</ci></apply><ci id="S3.SS3.p2.8.m3.2.2.cmml" xref="S3.SS3.p2.8.m3.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m3.3c">Rank(y_{t}^{(p)},k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m3.3d">italic_R italic_a italic_n italic_k ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT , italic_k )</annotation></semantics></math> equals to score of the prescription at rank <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m4.1"><semantics id="S3.SS3.p2.9.m4.1a"><mi id="S3.SS3.p2.9.m4.1.1" xref="S3.SS3.p2.9.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m4.1b"><ci id="S3.SS3.p2.9.m4.1.1.cmml" xref="S3.SS3.p2.9.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m4.1d">italic_k</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E33">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(33)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{NDCG}@K=\frac{1}{\Sigma_{p}^{N}\Sigma_{t}^{\hat{T}_{p}}1}\frac{DCG^{(p%
)}_{t}@K}{IDCG^{(p)}_{t}@K}" class="ltx_Math" display="block" id="S3.E33.m1.2"><semantics id="S3.E33.m1.2a"><mrow id="S3.E33.m1.2.3" xref="S3.E33.m1.2.3.cmml"><mrow id="S3.E33.m1.2.3.2" xref="S3.E33.m1.2.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E33.m1.2.3.2.2" xref="S3.E33.m1.2.3.2.2a.cmml">NDCG</mtext><mo id="S3.E33.m1.2.3.2.1" xref="S3.E33.m1.2.3.2.1.cmml">⁢</mo><mi id="S3.E33.m1.2.3.2.3" mathvariant="normal" xref="S3.E33.m1.2.3.2.3.cmml">@</mi><mo id="S3.E33.m1.2.3.2.1a" xref="S3.E33.m1.2.3.2.1.cmml">⁢</mo><mi id="S3.E33.m1.2.3.2.4" xref="S3.E33.m1.2.3.2.4.cmml">K</mi></mrow><mo id="S3.E33.m1.2.3.1" xref="S3.E33.m1.2.3.1.cmml">=</mo><mrow id="S3.E33.m1.2.3.3" xref="S3.E33.m1.2.3.3.cmml"><mfrac id="S3.E33.m1.2.3.3.2" xref="S3.E33.m1.2.3.3.2.cmml"><mn id="S3.E33.m1.2.3.3.2.2" xref="S3.E33.m1.2.3.3.2.2.cmml">1</mn><mrow id="S3.E33.m1.2.3.3.2.3" xref="S3.E33.m1.2.3.3.2.3.cmml"><msubsup id="S3.E33.m1.2.3.3.2.3.2" xref="S3.E33.m1.2.3.3.2.3.2.cmml"><mi id="S3.E33.m1.2.3.3.2.3.2.2.2" mathvariant="normal" xref="S3.E33.m1.2.3.3.2.3.2.2.2.cmml">Σ</mi><mi id="S3.E33.m1.2.3.3.2.3.2.2.3" xref="S3.E33.m1.2.3.3.2.3.2.2.3.cmml">p</mi><mi id="S3.E33.m1.2.3.3.2.3.2.3" xref="S3.E33.m1.2.3.3.2.3.2.3.cmml">N</mi></msubsup><mo id="S3.E33.m1.2.3.3.2.3.1" xref="S3.E33.m1.2.3.3.2.3.1.cmml">⁢</mo><msubsup id="S3.E33.m1.2.3.3.2.3.3" xref="S3.E33.m1.2.3.3.2.3.3.cmml"><mi id="S3.E33.m1.2.3.3.2.3.3.2.2" mathvariant="normal" xref="S3.E33.m1.2.3.3.2.3.3.2.2.cmml">Σ</mi><mi id="S3.E33.m1.2.3.3.2.3.3.2.3" xref="S3.E33.m1.2.3.3.2.3.3.2.3.cmml">t</mi><msub id="S3.E33.m1.2.3.3.2.3.3.3" xref="S3.E33.m1.2.3.3.2.3.3.3.cmml"><mover accent="true" id="S3.E33.m1.2.3.3.2.3.3.3.2" xref="S3.E33.m1.2.3.3.2.3.3.3.2.cmml"><mi id="S3.E33.m1.2.3.3.2.3.3.3.2.2" xref="S3.E33.m1.2.3.3.2.3.3.3.2.2.cmml">T</mi><mo id="S3.E33.m1.2.3.3.2.3.3.3.2.1" xref="S3.E33.m1.2.3.3.2.3.3.3.2.1.cmml">^</mo></mover><mi id="S3.E33.m1.2.3.3.2.3.3.3.3" xref="S3.E33.m1.2.3.3.2.3.3.3.3.cmml">p</mi></msub></msubsup><mo id="S3.E33.m1.2.3.3.2.3.1a" xref="S3.E33.m1.2.3.3.2.3.1.cmml">⁢</mo><mn id="S3.E33.m1.2.3.3.2.3.4" xref="S3.E33.m1.2.3.3.2.3.4.cmml">1</mn></mrow></mfrac><mo id="S3.E33.m1.2.3.3.1" xref="S3.E33.m1.2.3.3.1.cmml">⁢</mo><mfrac id="S3.E33.m1.2.2" xref="S3.E33.m1.2.2.cmml"><mrow id="S3.E33.m1.1.1.1" xref="S3.E33.m1.1.1.1.cmml"><mi id="S3.E33.m1.1.1.1.3" xref="S3.E33.m1.1.1.1.3.cmml">D</mi><mo id="S3.E33.m1.1.1.1.2" xref="S3.E33.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.E33.m1.1.1.1.4" xref="S3.E33.m1.1.1.1.4.cmml">C</mi><mo id="S3.E33.m1.1.1.1.2a" xref="S3.E33.m1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E33.m1.1.1.1.5" xref="S3.E33.m1.1.1.1.5.cmml"><mi id="S3.E33.m1.1.1.1.5.2.2" xref="S3.E33.m1.1.1.1.5.2.2.cmml">G</mi><mi id="S3.E33.m1.1.1.1.5.3" xref="S3.E33.m1.1.1.1.5.3.cmml">t</mi><mrow id="S3.E33.m1.1.1.1.1.1.3" xref="S3.E33.m1.1.1.1.5.cmml"><mo id="S3.E33.m1.1.1.1.1.1.3.1" stretchy="false" xref="S3.E33.m1.1.1.1.5.cmml">(</mo><mi id="S3.E33.m1.1.1.1.1.1.1" xref="S3.E33.m1.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E33.m1.1.1.1.1.1.3.2" stretchy="false" xref="S3.E33.m1.1.1.1.5.cmml">)</mo></mrow></msubsup><mo id="S3.E33.m1.1.1.1.2b" xref="S3.E33.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.E33.m1.1.1.1.6" mathvariant="normal" xref="S3.E33.m1.1.1.1.6.cmml">@</mi><mo id="S3.E33.m1.1.1.1.2c" xref="S3.E33.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.E33.m1.1.1.1.7" xref="S3.E33.m1.1.1.1.7.cmml">K</mi></mrow><mrow id="S3.E33.m1.2.2.2" xref="S3.E33.m1.2.2.2.cmml"><mi id="S3.E33.m1.2.2.2.3" xref="S3.E33.m1.2.2.2.3.cmml">I</mi><mo id="S3.E33.m1.2.2.2.2" xref="S3.E33.m1.2.2.2.2.cmml">⁢</mo><mi id="S3.E33.m1.2.2.2.4" xref="S3.E33.m1.2.2.2.4.cmml">D</mi><mo id="S3.E33.m1.2.2.2.2a" xref="S3.E33.m1.2.2.2.2.cmml">⁢</mo><mi id="S3.E33.m1.2.2.2.5" xref="S3.E33.m1.2.2.2.5.cmml">C</mi><mo id="S3.E33.m1.2.2.2.2b" xref="S3.E33.m1.2.2.2.2.cmml">⁢</mo><msubsup id="S3.E33.m1.2.2.2.6" xref="S3.E33.m1.2.2.2.6.cmml"><mi id="S3.E33.m1.2.2.2.6.2.2" xref="S3.E33.m1.2.2.2.6.2.2.cmml">G</mi><mi id="S3.E33.m1.2.2.2.6.3" xref="S3.E33.m1.2.2.2.6.3.cmml">t</mi><mrow id="S3.E33.m1.2.2.2.1.1.3" xref="S3.E33.m1.2.2.2.6.cmml"><mo id="S3.E33.m1.2.2.2.1.1.3.1" stretchy="false" xref="S3.E33.m1.2.2.2.6.cmml">(</mo><mi id="S3.E33.m1.2.2.2.1.1.1" xref="S3.E33.m1.2.2.2.1.1.1.cmml">p</mi><mo id="S3.E33.m1.2.2.2.1.1.3.2" stretchy="false" xref="S3.E33.m1.2.2.2.6.cmml">)</mo></mrow></msubsup><mo id="S3.E33.m1.2.2.2.2c" xref="S3.E33.m1.2.2.2.2.cmml">⁢</mo><mi id="S3.E33.m1.2.2.2.7" mathvariant="normal" xref="S3.E33.m1.2.2.2.7.cmml">@</mi><mo id="S3.E33.m1.2.2.2.2d" xref="S3.E33.m1.2.2.2.2.cmml">⁢</mo><mi id="S3.E33.m1.2.2.2.8" xref="S3.E33.m1.2.2.2.8.cmml">K</mi></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E33.m1.2b"><apply id="S3.E33.m1.2.3.cmml" xref="S3.E33.m1.2.3"><eq id="S3.E33.m1.2.3.1.cmml" xref="S3.E33.m1.2.3.1"></eq><apply id="S3.E33.m1.2.3.2.cmml" xref="S3.E33.m1.2.3.2"><times id="S3.E33.m1.2.3.2.1.cmml" xref="S3.E33.m1.2.3.2.1"></times><ci id="S3.E33.m1.2.3.2.2a.cmml" xref="S3.E33.m1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E33.m1.2.3.2.2.cmml" xref="S3.E33.m1.2.3.2.2">NDCG</mtext></ci><ci id="S3.E33.m1.2.3.2.3.cmml" xref="S3.E33.m1.2.3.2.3">@</ci><ci id="S3.E33.m1.2.3.2.4.cmml" xref="S3.E33.m1.2.3.2.4">𝐾</ci></apply><apply id="S3.E33.m1.2.3.3.cmml" xref="S3.E33.m1.2.3.3"><times id="S3.E33.m1.2.3.3.1.cmml" xref="S3.E33.m1.2.3.3.1"></times><apply id="S3.E33.m1.2.3.3.2.cmml" xref="S3.E33.m1.2.3.3.2"><divide id="S3.E33.m1.2.3.3.2.1.cmml" xref="S3.E33.m1.2.3.3.2"></divide><cn id="S3.E33.m1.2.3.3.2.2.cmml" type="integer" xref="S3.E33.m1.2.3.3.2.2">1</cn><apply id="S3.E33.m1.2.3.3.2.3.cmml" xref="S3.E33.m1.2.3.3.2.3"><times id="S3.E33.m1.2.3.3.2.3.1.cmml" xref="S3.E33.m1.2.3.3.2.3.1"></times><apply id="S3.E33.m1.2.3.3.2.3.2.cmml" xref="S3.E33.m1.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E33.m1.2.3.3.2.3.2.1.cmml" xref="S3.E33.m1.2.3.3.2.3.2">superscript</csymbol><apply id="S3.E33.m1.2.3.3.2.3.2.2.cmml" xref="S3.E33.m1.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E33.m1.2.3.3.2.3.2.2.1.cmml" xref="S3.E33.m1.2.3.3.2.3.2">subscript</csymbol><ci id="S3.E33.m1.2.3.3.2.3.2.2.2.cmml" xref="S3.E33.m1.2.3.3.2.3.2.2.2">Σ</ci><ci id="S3.E33.m1.2.3.3.2.3.2.2.3.cmml" xref="S3.E33.m1.2.3.3.2.3.2.2.3">𝑝</ci></apply><ci id="S3.E33.m1.2.3.3.2.3.2.3.cmml" xref="S3.E33.m1.2.3.3.2.3.2.3">𝑁</ci></apply><apply id="S3.E33.m1.2.3.3.2.3.3.cmml" xref="S3.E33.m1.2.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.E33.m1.2.3.3.2.3.3.1.cmml" xref="S3.E33.m1.2.3.3.2.3.3">superscript</csymbol><apply id="S3.E33.m1.2.3.3.2.3.3.2.cmml" xref="S3.E33.m1.2.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.E33.m1.2.3.3.2.3.3.2.1.cmml" xref="S3.E33.m1.2.3.3.2.3.3">subscript</csymbol><ci id="S3.E33.m1.2.3.3.2.3.3.2.2.cmml" xref="S3.E33.m1.2.3.3.2.3.3.2.2">Σ</ci><ci id="S3.E33.m1.2.3.3.2.3.3.2.3.cmml" xref="S3.E33.m1.2.3.3.2.3.3.2.3">𝑡</ci></apply><apply id="S3.E33.m1.2.3.3.2.3.3.3.cmml" xref="S3.E33.m1.2.3.3.2.3.3.3"><csymbol cd="ambiguous" id="S3.E33.m1.2.3.3.2.3.3.3.1.cmml" xref="S3.E33.m1.2.3.3.2.3.3.3">subscript</csymbol><apply id="S3.E33.m1.2.3.3.2.3.3.3.2.cmml" xref="S3.E33.m1.2.3.3.2.3.3.3.2"><ci id="S3.E33.m1.2.3.3.2.3.3.3.2.1.cmml" xref="S3.E33.m1.2.3.3.2.3.3.3.2.1">^</ci><ci id="S3.E33.m1.2.3.3.2.3.3.3.2.2.cmml" xref="S3.E33.m1.2.3.3.2.3.3.3.2.2">𝑇</ci></apply><ci id="S3.E33.m1.2.3.3.2.3.3.3.3.cmml" xref="S3.E33.m1.2.3.3.2.3.3.3.3">𝑝</ci></apply></apply><cn id="S3.E33.m1.2.3.3.2.3.4.cmml" type="integer" xref="S3.E33.m1.2.3.3.2.3.4">1</cn></apply></apply><apply id="S3.E33.m1.2.2.cmml" xref="S3.E33.m1.2.2"><divide id="S3.E33.m1.2.2.3.cmml" xref="S3.E33.m1.2.2"></divide><apply id="S3.E33.m1.1.1.1.cmml" xref="S3.E33.m1.1.1.1"><times id="S3.E33.m1.1.1.1.2.cmml" xref="S3.E33.m1.1.1.1.2"></times><ci id="S3.E33.m1.1.1.1.3.cmml" xref="S3.E33.m1.1.1.1.3">𝐷</ci><ci id="S3.E33.m1.1.1.1.4.cmml" xref="S3.E33.m1.1.1.1.4">𝐶</ci><apply id="S3.E33.m1.1.1.1.5.cmml" xref="S3.E33.m1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E33.m1.1.1.1.5.1.cmml" xref="S3.E33.m1.1.1.1.5">subscript</csymbol><apply id="S3.E33.m1.1.1.1.5.2.cmml" xref="S3.E33.m1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E33.m1.1.1.1.5.2.1.cmml" xref="S3.E33.m1.1.1.1.5">superscript</csymbol><ci id="S3.E33.m1.1.1.1.5.2.2.cmml" xref="S3.E33.m1.1.1.1.5.2.2">𝐺</ci><ci id="S3.E33.m1.1.1.1.1.1.1.cmml" xref="S3.E33.m1.1.1.1.1.1.1">𝑝</ci></apply><ci id="S3.E33.m1.1.1.1.5.3.cmml" xref="S3.E33.m1.1.1.1.5.3">𝑡</ci></apply><ci id="S3.E33.m1.1.1.1.6.cmml" xref="S3.E33.m1.1.1.1.6">@</ci><ci id="S3.E33.m1.1.1.1.7.cmml" xref="S3.E33.m1.1.1.1.7">𝐾</ci></apply><apply id="S3.E33.m1.2.2.2.cmml" xref="S3.E33.m1.2.2.2"><times id="S3.E33.m1.2.2.2.2.cmml" xref="S3.E33.m1.2.2.2.2"></times><ci id="S3.E33.m1.2.2.2.3.cmml" xref="S3.E33.m1.2.2.2.3">𝐼</ci><ci id="S3.E33.m1.2.2.2.4.cmml" xref="S3.E33.m1.2.2.2.4">𝐷</ci><ci id="S3.E33.m1.2.2.2.5.cmml" xref="S3.E33.m1.2.2.2.5">𝐶</ci><apply id="S3.E33.m1.2.2.2.6.cmml" xref="S3.E33.m1.2.2.2.6"><csymbol cd="ambiguous" id="S3.E33.m1.2.2.2.6.1.cmml" xref="S3.E33.m1.2.2.2.6">subscript</csymbol><apply id="S3.E33.m1.2.2.2.6.2.cmml" xref="S3.E33.m1.2.2.2.6"><csymbol cd="ambiguous" id="S3.E33.m1.2.2.2.6.2.1.cmml" xref="S3.E33.m1.2.2.2.6">superscript</csymbol><ci id="S3.E33.m1.2.2.2.6.2.2.cmml" xref="S3.E33.m1.2.2.2.6.2.2">𝐺</ci><ci id="S3.E33.m1.2.2.2.1.1.1.cmml" xref="S3.E33.m1.2.2.2.1.1.1">𝑝</ci></apply><ci id="S3.E33.m1.2.2.2.6.3.cmml" xref="S3.E33.m1.2.2.2.6.3">𝑡</ci></apply><ci id="S3.E33.m1.2.2.2.7.cmml" xref="S3.E33.m1.2.2.2.7">@</ci><ci id="S3.E33.m1.2.2.2.8.cmml" xref="S3.E33.m1.2.2.2.8">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E33.m1.2c">\textbf{NDCG}@K=\frac{1}{\Sigma_{p}^{N}\Sigma_{t}^{\hat{T}_{p}}1}\frac{DCG^{(p%
)}_{t}@K}{IDCG^{(p)}_{t}@K}</annotation><annotation encoding="application/x-llamapun" id="S3.E33.m1.2d">NDCG @ italic_K = divide start_ARG 1 end_ARG start_ARG roman_Σ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_Σ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_T end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT 1 end_ARG divide start_ARG italic_D italic_C italic_G start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT @ italic_K end_ARG start_ARG italic_I italic_D italic_C italic_G start_POSTSUPERSCRIPT ( italic_p ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT @ italic_K end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Baselines</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">We utilize the state-of-the-art healthcare predictive methods and prescription recommendation systems as baselines: (1) <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.1">Dr. Agent</span> <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib12" title="">2020</a>)</cite> utilizes RNN with dual policy gradient agents and a dynamic skip connection for adaptive focus on pertinent information. (2) <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.2">Retain</span> <cite class="ltx_cite ltx_citemacro_citep">(Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib10" title="">2016</a>)</cite> incorporates a dual-RNN network to capture the interpretable influence of the visits and medical features for the prediction tasks. (3) <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.3">Transformer’s Encoder</span> <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib31" title="">2017</a>)</cite>, our research utilizes the transformer’s self-attention for both Visit-Level and Cross-Visit Transformers representations and it is one of the most important baselines to compare our method with. (4) <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.4">Micron</span> <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib38" title="">2021a</a>)</cite> a drug recommendation model using residual recurrent neural networks to update changes in patient health (5) <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.5">SafeDrug</span> <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib40" title="">2021c</a>)</cite> utilizes a global message passing neural network to encode the functionality of prescriptions molecules with considering the DDI to recommend safe prescriptions (6) <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.6">MoleRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib41" title="">2023c</a>)</cite> a structure-aware encoding method that contains hierarchical architecture aimed at modeling interactions with considering DDI. (7) <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.7">GAMENet</span> <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib27" title="">2019</a>)</cite> employs a memory module and graph neural networks to incorporate the knowledge graph of drug-drug interactions, while representing longitudinal patient records as the query.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Results and Discussion</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">We conducted experiments on ARCI to address the following research questions:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">RQ1</span> What is the performance of ARCI compared to other state-of-the-art healthcare predictive methods and prescription recommendation systems?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">RQ2</span> How differently do various components of ARCI contribute to the output results?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">RQ3</span> How does the ARCI perform in the recommendation task with accounting for repetitive prescriptions?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.1.1">RQ4</span> How does the proposed method take into account interpretability?</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="442" id="S3.F4.sf1.g1" src="extracted/5788641/Figs/figure_4_MIMIC.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F4.sf1.3.2" style="font-size:90%;">MIMIC-III</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="438" id="S3.F4.sf2.g1" src="extracted/5788641/Figs/figure_4_AKI.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F4.sf2.3.2" style="font-size:90%;">AKI</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">t-SNE of the heads and intents. For better illustration, only the means of the intents’ representations are shown as crosses. The figure depicts how different heads are successfully clustered into different groups that are aligned with their associated intents.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="344" id="S3.F5.sf1.g1" src="extracted/5788641/Figs/Figure_5_MIMIC.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F5.sf1.3.2" style="font-size:90%;">MIMIC-III</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="345" id="S3.F5.sf2.g1" src="extracted/5788641/Figs/Figure_5_AKI.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F5.sf2.3.2" style="font-size:90%;">AKI</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.4.2.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S3.F5.2.1" style="font-size:90%;">The effect of varying numbers of heads and intents on the PRAUC Metric with and without <math alttext="\mathcal{L}_{I}" class="ltx_Math" display="inline" id="S3.F5.2.1.m1.1"><semantics id="S3.F5.2.1.m1.1b"><msub id="S3.F5.2.1.m1.1.1" xref="S3.F5.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F5.2.1.m1.1.1.2" xref="S3.F5.2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.F5.2.1.m1.1.1.3" xref="S3.F5.2.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F5.2.1.m1.1c"><apply id="S3.F5.2.1.m1.1.1.cmml" xref="S3.F5.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F5.2.1.m1.1.1.1.cmml" xref="S3.F5.2.1.m1.1.1">subscript</csymbol><ci id="S3.F5.2.1.m1.1.1.2.cmml" xref="S3.F5.2.1.m1.1.1.2">ℒ</ci><ci id="S3.F5.2.1.m1.1.1.3.cmml" xref="S3.F5.2.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.1.m1.1d">\mathcal{L}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.F5.2.1.m1.1e">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> on the MIMIC-III and AKI datasets.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="479" id="S3.F6.sf1.g1" src="extracted/5788641/Figs/loss_mimic.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F6.sf1.3.2" style="font-size:90%;">MIMIC-III</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="478" id="S3.F6.sf2.g1" src="extracted/5788641/Figs/loss_aki.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F6.sf2.3.2" style="font-size:90%;">AKI</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.2.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S3.F6.3.2" style="font-size:90%;">The impact of removing various loss functions on the PRAUC metric for the MIMIC-III and AKI datasets.</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T5.74.1.1" style="font-size:90%;">Table 5</span>. </span><span class="ltx_text" id="S3.T5.75.2" style="font-size:90%;">Performance comparison on MIMIC-III and AKI based on classification metrics and DDI including repetitive prescriptions. The reported values include means and 95% confidence interval calculated from folds.</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T5.72">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.72.73.1">
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S3.T5.72.73.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4" id="S3.T5.72.73.1.2"><span class="ltx_text ltx_font_bold" id="S3.T5.72.73.1.2.1" style="font-size:80%;">MIMIC-III</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_t" colspan="4" id="S3.T5.72.73.1.3"><span class="ltx_text ltx_font_bold" id="S3.T5.72.73.1.3.1" style="font-size:80%;">AKI</span></th>
</tr>
<tr class="ltx_tr" id="S3.T5.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.8.8.9"><span class="ltx_text ltx_font_bold" id="S3.T5.8.8.9.1" style="font-size:80%;">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T5.1.1.1.1" style="font-size:80%;">PRAUC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.1.1.1.1.m1.1"><semantics id="S3.T5.1.1.1.1.m1.1a"><mo id="S3.T5.1.1.1.1.m1.1.1" stretchy="false" xref="S3.T5.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T5.1.1.1.1.m1.1b"><ci id="S3.T5.1.1.1.1.m1.1.1.cmml" xref="S3.T5.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T5.2.2.2.1" style="font-size:80%;">F1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.2.2.2.1.m1.1"><semantics id="S3.T5.2.2.2.1.m1.1a"><mo id="S3.T5.2.2.2.1.m1.1.1" stretchy="false" xref="S3.T5.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T5.2.2.2.1.m1.1b"><ci id="S3.T5.2.2.2.1.m1.1.1.cmml" xref="S3.T5.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.3.3.3"><span class="ltx_text ltx_font_bold" id="S3.T5.3.3.3.1" style="font-size:80%;">Jaccard<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.3.3.3.1.m1.1"><semantics id="S3.T5.3.3.3.1.m1.1a"><mo id="S3.T5.3.3.3.1.m1.1.1" stretchy="false" xref="S3.T5.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T5.3.3.3.1.m1.1b"><ci id="S3.T5.3.3.3.1.m1.1.1.cmml" xref="S3.T5.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.3.3.3.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T5.4.4.4"><span class="ltx_text ltx_font_bold" id="S3.T5.4.4.4.1" style="font-size:80%;">DDI<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T5.4.4.4.1.m1.1"><semantics id="S3.T5.4.4.4.1.m1.1a"><mo id="S3.T5.4.4.4.1.m1.1.1" stretchy="false" xref="S3.T5.4.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T5.4.4.4.1.m1.1b"><ci id="S3.T5.4.4.4.1.m1.1.1.cmml" xref="S3.T5.4.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.4.4.4.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.4.4.4.1.m1.1d">↓</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.5.5.5"><span class="ltx_text ltx_font_bold" id="S3.T5.5.5.5.1" style="font-size:80%;">PRAUC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.5.5.5.1.m1.1"><semantics id="S3.T5.5.5.5.1.m1.1a"><mo id="S3.T5.5.5.5.1.m1.1.1" stretchy="false" xref="S3.T5.5.5.5.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T5.5.5.5.1.m1.1b"><ci id="S3.T5.5.5.5.1.m1.1.1.cmml" xref="S3.T5.5.5.5.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.5.5.5.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.5.5.5.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.6.6.6"><span class="ltx_text ltx_font_bold" id="S3.T5.6.6.6.1" style="font-size:80%;">F1<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.6.6.6.1.m1.1"><semantics id="S3.T5.6.6.6.1.m1.1a"><mo id="S3.T5.6.6.6.1.m1.1.1" stretchy="false" xref="S3.T5.6.6.6.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T5.6.6.6.1.m1.1b"><ci id="S3.T5.6.6.6.1.m1.1.1.cmml" xref="S3.T5.6.6.6.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.6.6.6.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.6.6.6.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.7.7.7"><span class="ltx_text ltx_font_bold" id="S3.T5.7.7.7.1" style="font-size:80%;">Jaccard<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T5.7.7.7.1.m1.1"><semantics id="S3.T5.7.7.7.1.m1.1a"><mo id="S3.T5.7.7.7.1.m1.1.1" stretchy="false" xref="S3.T5.7.7.7.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T5.7.7.7.1.m1.1b"><ci id="S3.T5.7.7.7.1.m1.1.1.cmml" xref="S3.T5.7.7.7.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.7.7.7.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.7.7.7.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T5.8.8.8"><span class="ltx_text ltx_font_bold" id="S3.T5.8.8.8.1" style="font-size:80%;">DDI<math alttext="\downarrow" class="ltx_Math" display="inline" id="S3.T5.8.8.8.1.m1.1"><semantics id="S3.T5.8.8.8.1.m1.1a"><mo id="S3.T5.8.8.8.1.m1.1.1" stretchy="false" xref="S3.T5.8.8.8.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S3.T5.8.8.8.1.m1.1b"><ci id="S3.T5.8.8.8.1.m1.1.1.cmml" xref="S3.T5.8.8.8.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.8.8.8.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S3.T5.8.8.8.1.m1.1d">↓</annotation></semantics></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.16.16">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.16.16.9"><span class="ltx_text ltx_font_bold" id="S3.T5.16.16.9.1" style="font-size:80%;">Dr. Agent</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.9.9.1">
<span class="ltx_text" id="S3.T5.9.9.1.1" style="font-size:80%;">0.688 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.9.9.1.m1.1"><semantics id="S3.T5.9.9.1.m1.1a"><mo id="S3.T5.9.9.1.m1.1.1" mathsize="80%" xref="S3.T5.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.9.9.1.m1.1b"><csymbol cd="latexml" id="S3.T5.9.9.1.m1.1.1.cmml" xref="S3.T5.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.9.9.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.9.9.1.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.10.10.2">
<span class="ltx_text" id="S3.T5.10.10.2.1" style="font-size:80%;">0.565 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.10.10.2.m1.1"><semantics id="S3.T5.10.10.2.m1.1a"><mo id="S3.T5.10.10.2.m1.1.1" mathsize="80%" xref="S3.T5.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.10.10.2.m1.1b"><csymbol cd="latexml" id="S3.T5.10.10.2.m1.1.1.cmml" xref="S3.T5.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.10.10.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.10.10.2.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.11.11.3">
<span class="ltx_text" id="S3.T5.11.11.3.1" style="font-size:80%;">0.405 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.11.11.3.m1.1"><semantics id="S3.T5.11.11.3.m1.1a"><mo id="S3.T5.11.11.3.m1.1.1" mathsize="80%" xref="S3.T5.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.11.11.3.m1.1b"><csymbol cd="latexml" id="S3.T5.11.11.3.m1.1.1.cmml" xref="S3.T5.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.11.11.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.11.11.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.11.11.3.2" style="font-size:80%;"> 0.007</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T5.12.12.4">
<span class="ltx_text" id="S3.T5.12.12.4.1" style="font-size:80%;">0.079 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.12.12.4.m1.1"><semantics id="S3.T5.12.12.4.m1.1a"><mo id="S3.T5.12.12.4.m1.1.1" mathsize="80%" xref="S3.T5.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.12.12.4.m1.1b"><csymbol cd="latexml" id="S3.T5.12.12.4.m1.1.1.cmml" xref="S3.T5.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.12.12.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.12.12.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.12.12.4.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.13.13.5">
<span class="ltx_text" id="S3.T5.13.13.5.1" style="font-size:80%;">0.432 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.13.13.5.m1.1"><semantics id="S3.T5.13.13.5.m1.1a"><mo id="S3.T5.13.13.5.m1.1.1" mathsize="80%" xref="S3.T5.13.13.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.13.13.5.m1.1b"><csymbol cd="latexml" id="S3.T5.13.13.5.m1.1.1.cmml" xref="S3.T5.13.13.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.13.13.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.13.13.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.13.13.5.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.14.14.6">
<span class="ltx_text" id="S3.T5.14.14.6.1" style="font-size:80%;">0.315 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.14.14.6.m1.1"><semantics id="S3.T5.14.14.6.m1.1a"><mo id="S3.T5.14.14.6.m1.1.1" mathsize="80%" xref="S3.T5.14.14.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.14.14.6.m1.1b"><csymbol cd="latexml" id="S3.T5.14.14.6.m1.1.1.cmml" xref="S3.T5.14.14.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.14.14.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.14.14.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.14.14.6.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.15.15.7">
<span class="ltx_text" id="S3.T5.15.15.7.1" style="font-size:80%;">0.214 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.15.15.7.m1.1"><semantics id="S3.T5.15.15.7.m1.1a"><mo id="S3.T5.15.15.7.m1.1.1" mathsize="80%" xref="S3.T5.15.15.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.15.15.7.m1.1b"><csymbol cd="latexml" id="S3.T5.15.15.7.m1.1.1.cmml" xref="S3.T5.15.15.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.15.15.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.15.15.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.15.15.7.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T5.16.16.8">
<span class="ltx_text" id="S3.T5.16.16.8.1" style="font-size:80%;">0.082 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.16.16.8.m1.1"><semantics id="S3.T5.16.16.8.m1.1a"><mo id="S3.T5.16.16.8.m1.1.1" mathsize="80%" xref="S3.T5.16.16.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.16.16.8.m1.1b"><csymbol cd="latexml" id="S3.T5.16.16.8.m1.1.1.cmml" xref="S3.T5.16.16.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.16.16.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.16.16.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.16.16.8.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T5.24.24">
<td class="ltx_td ltx_align_center" id="S3.T5.24.24.9"><span class="ltx_text ltx_font_bold" id="S3.T5.24.24.9.1" style="font-size:80%;">Retain</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.17.17.1">
<span class="ltx_text" id="S3.T5.17.17.1.1" style="font-size:80%;">0.686 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.17.17.1.m1.1"><semantics id="S3.T5.17.17.1.m1.1a"><mo id="S3.T5.17.17.1.m1.1.1" mathsize="80%" xref="S3.T5.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.17.17.1.m1.1b"><csymbol cd="latexml" id="S3.T5.17.17.1.m1.1.1.cmml" xref="S3.T5.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.17.17.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.17.17.1.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.18.18.2">
<span class="ltx_text" id="S3.T5.18.18.2.1" style="font-size:80%;">0.565 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.18.18.2.m1.1"><semantics id="S3.T5.18.18.2.m1.1a"><mo id="S3.T5.18.18.2.m1.1.1" mathsize="80%" xref="S3.T5.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.18.18.2.m1.1b"><csymbol cd="latexml" id="S3.T5.18.18.2.m1.1.1.cmml" xref="S3.T5.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.18.18.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.18.18.2.2" style="font-size:80%;"> 0.004</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.19.19.3">
<span class="ltx_text" id="S3.T5.19.19.3.1" style="font-size:80%;">0.406 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.19.19.3.m1.1"><semantics id="S3.T5.19.19.3.m1.1a"><mo id="S3.T5.19.19.3.m1.1.1" mathsize="80%" xref="S3.T5.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.19.19.3.m1.1b"><csymbol cd="latexml" id="S3.T5.19.19.3.m1.1.1.cmml" xref="S3.T5.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.19.19.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.19.19.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.19.19.3.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.20.20.4">
<span class="ltx_text" id="S3.T5.20.20.4.1" style="font-size:80%;">0.082 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.20.20.4.m1.1"><semantics id="S3.T5.20.20.4.m1.1a"><mo id="S3.T5.20.20.4.m1.1.1" mathsize="80%" xref="S3.T5.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.20.20.4.m1.1b"><csymbol cd="latexml" id="S3.T5.20.20.4.m1.1.1.cmml" xref="S3.T5.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.20.20.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.20.20.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.20.20.4.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.21.21.5">
<span class="ltx_text" id="S3.T5.21.21.5.1" style="font-size:80%;">0.449 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.21.21.5.m1.1"><semantics id="S3.T5.21.21.5.m1.1a"><mo id="S3.T5.21.21.5.m1.1.1" mathsize="80%" xref="S3.T5.21.21.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.21.21.5.m1.1b"><csymbol cd="latexml" id="S3.T5.21.21.5.m1.1.1.cmml" xref="S3.T5.21.21.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.21.21.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.21.21.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.21.21.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.22.22.6">
<span class="ltx_text" id="S3.T5.22.22.6.1" style="font-size:80%;">0.321 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.22.22.6.m1.1"><semantics id="S3.T5.22.22.6.m1.1a"><mo id="S3.T5.22.22.6.m1.1.1" mathsize="80%" xref="S3.T5.22.22.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.22.22.6.m1.1b"><csymbol cd="latexml" id="S3.T5.22.22.6.m1.1.1.cmml" xref="S3.T5.22.22.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.22.22.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.22.22.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.22.22.6.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.23.23.7">
<span class="ltx_text" id="S3.T5.23.23.7.1" style="font-size:80%;">0.219 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.23.23.7.m1.1"><semantics id="S3.T5.23.23.7.m1.1a"><mo id="S3.T5.23.23.7.m1.1.1" mathsize="80%" xref="S3.T5.23.23.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.23.23.7.m1.1b"><csymbol cd="latexml" id="S3.T5.23.23.7.m1.1.1.cmml" xref="S3.T5.23.23.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.23.23.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.23.23.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.23.23.7.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T5.24.24.8">
<span class="ltx_text" id="S3.T5.24.24.8.1" style="font-size:80%;">0.083 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.24.24.8.m1.1"><semantics id="S3.T5.24.24.8.m1.1a"><mo id="S3.T5.24.24.8.m1.1.1" mathsize="80%" xref="S3.T5.24.24.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.24.24.8.m1.1b"><csymbol cd="latexml" id="S3.T5.24.24.8.m1.1.1.cmml" xref="S3.T5.24.24.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.24.24.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.24.24.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.24.24.8.2" style="font-size:80%;"> 0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T5.32.32">
<td class="ltx_td ltx_align_center" id="S3.T5.32.32.9"><span class="ltx_text ltx_font_bold" id="S3.T5.32.32.9.1" style="font-size:80%;">Micron</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.25.25.1">
<span class="ltx_text" id="S3.T5.25.25.1.1" style="font-size:80%;">0.686 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.25.25.1.m1.1"><semantics id="S3.T5.25.25.1.m1.1a"><mo id="S3.T5.25.25.1.m1.1.1" mathsize="80%" xref="S3.T5.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.25.25.1.m1.1b"><csymbol cd="latexml" id="S3.T5.25.25.1.m1.1.1.cmml" xref="S3.T5.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.25.25.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.25.25.1.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.26.26.2">
<span class="ltx_text" id="S3.T5.26.26.2.1" style="font-size:80%;">0.566 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.26.26.2.m1.1"><semantics id="S3.T5.26.26.2.m1.1a"><mo id="S3.T5.26.26.2.m1.1.1" mathsize="80%" xref="S3.T5.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.26.26.2.m1.1b"><csymbol cd="latexml" id="S3.T5.26.26.2.m1.1.1.cmml" xref="S3.T5.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.26.26.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.26.26.2.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.27.27.3">
<span class="ltx_text" id="S3.T5.27.27.3.1" style="font-size:80%;">0.406 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.27.27.3.m1.1"><semantics id="S3.T5.27.27.3.m1.1a"><mo id="S3.T5.27.27.3.m1.1.1" mathsize="80%" xref="S3.T5.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.27.27.3.m1.1b"><csymbol cd="latexml" id="S3.T5.27.27.3.m1.1.1.cmml" xref="S3.T5.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.27.27.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.27.27.3.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.28.28.4"><span class="ltx_text ltx_font_bold" id="S3.T5.28.28.4.1" style="font-size:80%;">0.069 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.28.28.4.1.m1.1"><semantics id="S3.T5.28.28.4.1.m1.1a"><mo id="S3.T5.28.28.4.1.m1.1.1" xref="S3.T5.28.28.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.28.28.4.1.m1.1b"><csymbol cd="latexml" id="S3.T5.28.28.4.1.m1.1.1.cmml" xref="S3.T5.28.28.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.28.28.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.28.28.4.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.29.29.5">
<span class="ltx_text" id="S3.T5.29.29.5.1" style="font-size:80%;">0.433 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.29.29.5.m1.1"><semantics id="S3.T5.29.29.5.m1.1a"><mo id="S3.T5.29.29.5.m1.1.1" mathsize="80%" xref="S3.T5.29.29.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.29.29.5.m1.1b"><csymbol cd="latexml" id="S3.T5.29.29.5.m1.1.1.cmml" xref="S3.T5.29.29.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.29.29.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.29.29.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.29.29.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.30.30.6">
<span class="ltx_text" id="S3.T5.30.30.6.1" style="font-size:80%;">0.331 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.30.30.6.m1.1"><semantics id="S3.T5.30.30.6.m1.1a"><mo id="S3.T5.30.30.6.m1.1.1" mathsize="80%" xref="S3.T5.30.30.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.30.30.6.m1.1b"><csymbol cd="latexml" id="S3.T5.30.30.6.m1.1.1.cmml" xref="S3.T5.30.30.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.30.30.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.30.30.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.30.30.6.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.31.31.7">
<span class="ltx_text" id="S3.T5.31.31.7.1" style="font-size:80%;">0.229 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.31.31.7.m1.1"><semantics id="S3.T5.31.31.7.m1.1a"><mo id="S3.T5.31.31.7.m1.1.1" mathsize="80%" xref="S3.T5.31.31.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.31.31.7.m1.1b"><csymbol cd="latexml" id="S3.T5.31.31.7.m1.1.1.cmml" xref="S3.T5.31.31.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.31.31.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.31.31.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.31.31.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T5.32.32.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.32.32.8.1" style="font-size:80%;">0.071 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.32.32.8.1.m1.1"><semantics id="S3.T5.32.32.8.1.m1.1a"><mo id="S3.T5.32.32.8.1.m1.1.1" xref="S3.T5.32.32.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.32.32.8.1.m1.1b"><csymbol cd="latexml" id="S3.T5.32.32.8.1.m1.1.1.cmml" xref="S3.T5.32.32.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.32.32.8.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.32.32.8.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.40.40">
<td class="ltx_td ltx_align_center" id="S3.T5.40.40.9"><span class="ltx_text ltx_font_bold" id="S3.T5.40.40.9.1" style="font-size:80%;">SafeDrug</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.33.33.1">
<span class="ltx_text" id="S3.T5.33.33.1.1" style="font-size:80%;">0.711 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.33.33.1.m1.1"><semantics id="S3.T5.33.33.1.m1.1a"><mo id="S3.T5.33.33.1.m1.1.1" mathsize="80%" xref="S3.T5.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.33.33.1.m1.1b"><csymbol cd="latexml" id="S3.T5.33.33.1.m1.1.1.cmml" xref="S3.T5.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.33.33.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.33.33.1.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.34.34.2">
<span class="ltx_text" id="S3.T5.34.34.2.1" style="font-size:80%;">0.590 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.34.34.2.m1.1"><semantics id="S3.T5.34.34.2.m1.1a"><mo id="S3.T5.34.34.2.m1.1.1" mathsize="80%" xref="S3.T5.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.34.34.2.m1.1b"><csymbol cd="latexml" id="S3.T5.34.34.2.m1.1.1.cmml" xref="S3.T5.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.34.34.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.34.34.2.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.35.35.3">
<span class="ltx_text" id="S3.T5.35.35.3.1" style="font-size:80%;">0.428 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.35.35.3.m1.1"><semantics id="S3.T5.35.35.3.m1.1a"><mo id="S3.T5.35.35.3.m1.1.1" mathsize="80%" xref="S3.T5.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.35.35.3.m1.1b"><csymbol cd="latexml" id="S3.T5.35.35.3.m1.1.1.cmml" xref="S3.T5.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.35.35.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.35.35.3.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.36.36.4">
<span class="ltx_text" id="S3.T5.36.36.4.1" style="font-size:80%;">0.074 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.36.36.4.m1.1"><semantics id="S3.T5.36.36.4.m1.1a"><mo id="S3.T5.36.36.4.m1.1.1" mathsize="80%" xref="S3.T5.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.36.36.4.m1.1b"><csymbol cd="latexml" id="S3.T5.36.36.4.m1.1.1.cmml" xref="S3.T5.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.36.36.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.36.36.4.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.37.37.5">
<span class="ltx_text" id="S3.T5.37.37.5.1" style="font-size:80%;">0.450 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.37.37.5.m1.1"><semantics id="S3.T5.37.37.5.m1.1a"><mo id="S3.T5.37.37.5.m1.1.1" mathsize="80%" xref="S3.T5.37.37.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.37.37.5.m1.1b"><csymbol cd="latexml" id="S3.T5.37.37.5.m1.1.1.cmml" xref="S3.T5.37.37.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.37.37.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.37.37.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.37.37.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.38.38.6">
<span class="ltx_text" id="S3.T5.38.38.6.1" style="font-size:80%;">0.326 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.38.38.6.m1.1"><semantics id="S3.T5.38.38.6.m1.1a"><mo id="S3.T5.38.38.6.m1.1.1" mathsize="80%" xref="S3.T5.38.38.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.38.38.6.m1.1b"><csymbol cd="latexml" id="S3.T5.38.38.6.m1.1.1.cmml" xref="S3.T5.38.38.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.38.38.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.38.38.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.38.38.6.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.39.39.7">
<span class="ltx_text" id="S3.T5.39.39.7.1" style="font-size:80%;">0.222 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.39.39.7.m1.1"><semantics id="S3.T5.39.39.7.m1.1a"><mo id="S3.T5.39.39.7.m1.1.1" mathsize="80%" xref="S3.T5.39.39.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.39.39.7.m1.1b"><csymbol cd="latexml" id="S3.T5.39.39.7.m1.1.1.cmml" xref="S3.T5.39.39.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.39.39.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.39.39.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.39.39.7.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T5.40.40.8">
<span class="ltx_text" id="S3.T5.40.40.8.1" style="font-size:80%;">0.075 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.40.40.8.m1.1"><semantics id="S3.T5.40.40.8.m1.1a"><mo id="S3.T5.40.40.8.m1.1.1" mathsize="80%" xref="S3.T5.40.40.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.40.40.8.m1.1b"><csymbol cd="latexml" id="S3.T5.40.40.8.m1.1.1.cmml" xref="S3.T5.40.40.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.40.40.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.40.40.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.40.40.8.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T5.48.48">
<td class="ltx_td ltx_align_center" id="S3.T5.48.48.9"><span class="ltx_text ltx_font_bold" id="S3.T5.48.48.9.1" style="font-size:80%;">MoleRec</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.41.41.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.41.41.1.1" style="font-size:80%;">0.714 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.41.41.1.1.m1.1"><semantics id="S3.T5.41.41.1.1.m1.1a"><mo id="S3.T5.41.41.1.1.m1.1.1" xref="S3.T5.41.41.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.41.41.1.1.m1.1b"><csymbol cd="latexml" id="S3.T5.41.41.1.1.m1.1.1.cmml" xref="S3.T5.41.41.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.41.41.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.41.41.1.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.42.42.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.42.42.2.1" style="font-size:80%;">0.595 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.42.42.2.1.m1.1"><semantics id="S3.T5.42.42.2.1.m1.1a"><mo id="S3.T5.42.42.2.1.m1.1.1" xref="S3.T5.42.42.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.42.42.2.1.m1.1b"><csymbol cd="latexml" id="S3.T5.42.42.2.1.m1.1.1.cmml" xref="S3.T5.42.42.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.42.42.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.42.42.2.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.43.43.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.43.43.3.1" style="font-size:80%;">0.435 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.43.43.3.1.m1.1"><semantics id="S3.T5.43.43.3.1.m1.1a"><mo id="S3.T5.43.43.3.1.m1.1.1" xref="S3.T5.43.43.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.43.43.3.1.m1.1b"><csymbol cd="latexml" id="S3.T5.43.43.3.1.m1.1.1.cmml" xref="S3.T5.43.43.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.43.43.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.43.43.3.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.44.44.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.44.44.4.1" style="font-size:80%;">0.070 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.44.44.4.1.m1.1"><semantics id="S3.T5.44.44.4.1.m1.1a"><mo id="S3.T5.44.44.4.1.m1.1.1" xref="S3.T5.44.44.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.44.44.4.1.m1.1b"><csymbol cd="latexml" id="S3.T5.44.44.4.1.m1.1.1.cmml" xref="S3.T5.44.44.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.44.44.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.44.44.4.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.45.45.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.45.45.5.1" style="font-size:80%;">0.453 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.45.45.5.1.m1.1"><semantics id="S3.T5.45.45.5.1.m1.1a"><mo id="S3.T5.45.45.5.1.m1.1.1" xref="S3.T5.45.45.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.45.45.5.1.m1.1b"><csymbol cd="latexml" id="S3.T5.45.45.5.1.m1.1.1.cmml" xref="S3.T5.45.45.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.45.45.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.45.45.5.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.46.46.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.46.46.6.1" style="font-size:80%;">0.332 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.46.46.6.1.m1.1"><semantics id="S3.T5.46.46.6.1.m1.1a"><mo id="S3.T5.46.46.6.1.m1.1.1" xref="S3.T5.46.46.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.46.46.6.1.m1.1b"><csymbol cd="latexml" id="S3.T5.46.46.6.1.m1.1.1.cmml" xref="S3.T5.46.46.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.46.46.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.46.46.6.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.47.47.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T5.47.47.7.1" style="font-size:80%;">0.231 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.47.47.7.1.m1.1"><semantics id="S3.T5.47.47.7.1.m1.1a"><mo id="S3.T5.47.47.7.1.m1.1.1" xref="S3.T5.47.47.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.47.47.7.1.m1.1b"><csymbol cd="latexml" id="S3.T5.47.47.7.1.m1.1.1.cmml" xref="S3.T5.47.47.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.47.47.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.47.47.7.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T5.48.48.8"><span class="ltx_text ltx_font_bold" id="S3.T5.48.48.8.1" style="font-size:80%;">0.068 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.48.48.8.1.m1.1"><semantics id="S3.T5.48.48.8.1.m1.1a"><mo id="S3.T5.48.48.8.1.m1.1.1" xref="S3.T5.48.48.8.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.48.48.8.1.m1.1b"><csymbol cd="latexml" id="S3.T5.48.48.8.1.m1.1.1.cmml" xref="S3.T5.48.48.8.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.48.48.8.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.48.48.8.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.56.56">
<td class="ltx_td ltx_align_center" id="S3.T5.56.56.9"><span class="ltx_text ltx_font_bold" id="S3.T5.56.56.9.1" style="font-size:80%;">GAMENet</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.49.49.1">
<span class="ltx_text" id="S3.T5.49.49.1.1" style="font-size:80%;">0.706 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.49.49.1.m1.1"><semantics id="S3.T5.49.49.1.m1.1a"><mo id="S3.T5.49.49.1.m1.1.1" mathsize="80%" xref="S3.T5.49.49.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.49.49.1.m1.1b"><csymbol cd="latexml" id="S3.T5.49.49.1.m1.1.1.cmml" xref="S3.T5.49.49.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.49.49.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.49.49.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.49.49.1.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.50.50.2">
<span class="ltx_text" id="S3.T5.50.50.2.1" style="font-size:80%;">0.580 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.50.50.2.m1.1"><semantics id="S3.T5.50.50.2.m1.1a"><mo id="S3.T5.50.50.2.m1.1.1" mathsize="80%" xref="S3.T5.50.50.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.50.50.2.m1.1b"><csymbol cd="latexml" id="S3.T5.50.50.2.m1.1.1.cmml" xref="S3.T5.50.50.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.50.50.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.50.50.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.50.50.2.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.51.51.3">
<span class="ltx_text" id="S3.T5.51.51.3.1" style="font-size:80%;">0.419 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.51.51.3.m1.1"><semantics id="S3.T5.51.51.3.m1.1a"><mo id="S3.T5.51.51.3.m1.1.1" mathsize="80%" xref="S3.T5.51.51.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.51.51.3.m1.1b"><csymbol cd="latexml" id="S3.T5.51.51.3.m1.1.1.cmml" xref="S3.T5.51.51.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.51.51.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.51.51.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.51.51.3.2" style="font-size:80%;"> 0.005</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.52.52.4">
<span class="ltx_text" id="S3.T5.52.52.4.1" style="font-size:80%;">0.078 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.52.52.4.m1.1"><semantics id="S3.T5.52.52.4.m1.1a"><mo id="S3.T5.52.52.4.m1.1.1" mathsize="80%" xref="S3.T5.52.52.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.52.52.4.m1.1b"><csymbol cd="latexml" id="S3.T5.52.52.4.m1.1.1.cmml" xref="S3.T5.52.52.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.52.52.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.52.52.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.52.52.4.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.53.53.5">
<span class="ltx_text" id="S3.T5.53.53.5.1" style="font-size:80%;">0.451 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.53.53.5.m1.1"><semantics id="S3.T5.53.53.5.m1.1a"><mo id="S3.T5.53.53.5.m1.1.1" mathsize="80%" xref="S3.T5.53.53.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.53.53.5.m1.1b"><csymbol cd="latexml" id="S3.T5.53.53.5.m1.1.1.cmml" xref="S3.T5.53.53.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.53.53.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.53.53.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.53.53.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.54.54.6">
<span class="ltx_text" id="S3.T5.54.54.6.1" style="font-size:80%;">0.328 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.54.54.6.m1.1"><semantics id="S3.T5.54.54.6.m1.1a"><mo id="S3.T5.54.54.6.m1.1.1" mathsize="80%" xref="S3.T5.54.54.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.54.54.6.m1.1b"><csymbol cd="latexml" id="S3.T5.54.54.6.m1.1.1.cmml" xref="S3.T5.54.54.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.54.54.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.54.54.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.54.54.6.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.55.55.7">
<span class="ltx_text" id="S3.T5.55.55.7.1" style="font-size:80%;">0.230</span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.55.55.7.m1.1"><semantics id="S3.T5.55.55.7.m1.1a"><mo id="S3.T5.55.55.7.m1.1.1" mathsize="80%" xref="S3.T5.55.55.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.55.55.7.m1.1b"><csymbol cd="latexml" id="S3.T5.55.55.7.m1.1.1.cmml" xref="S3.T5.55.55.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.55.55.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.55.55.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.55.55.7.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T5.56.56.8">
<span class="ltx_text" id="S3.T5.56.56.8.1" style="font-size:80%;">0.076 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.56.56.8.m1.1"><semantics id="S3.T5.56.56.8.m1.1a"><mo id="S3.T5.56.56.8.m1.1.1" mathsize="80%" xref="S3.T5.56.56.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.56.56.8.m1.1b"><csymbol cd="latexml" id="S3.T5.56.56.8.m1.1.1.cmml" xref="S3.T5.56.56.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.56.56.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.56.56.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.56.56.8.2" style="font-size:80%;"> 0.001</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T5.64.64">
<td class="ltx_td ltx_align_center" id="S3.T5.64.64.9"><span class="ltx_text ltx_font_bold" id="S3.T5.64.64.9.1" style="font-size:80%;">Transformer</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.57.57.1">
<span class="ltx_text" id="S3.T5.57.57.1.1" style="font-size:80%;">0.713 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.57.57.1.m1.1"><semantics id="S3.T5.57.57.1.m1.1a"><mo id="S3.T5.57.57.1.m1.1.1" mathsize="80%" xref="S3.T5.57.57.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.57.57.1.m1.1b"><csymbol cd="latexml" id="S3.T5.57.57.1.m1.1.1.cmml" xref="S3.T5.57.57.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.57.57.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.57.57.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.57.57.1.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.58.58.2">
<span class="ltx_text" id="S3.T5.58.58.2.1" style="font-size:80%;">0.591 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.58.58.2.m1.1"><semantics id="S3.T5.58.58.2.m1.1a"><mo id="S3.T5.58.58.2.m1.1.1" mathsize="80%" xref="S3.T5.58.58.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.58.58.2.m1.1b"><csymbol cd="latexml" id="S3.T5.58.58.2.m1.1.1.cmml" xref="S3.T5.58.58.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.58.58.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.58.58.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.58.58.2.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.59.59.3">
<span class="ltx_text" id="S3.T5.59.59.3.1" style="font-size:80%;">0.430 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.59.59.3.m1.1"><semantics id="S3.T5.59.59.3.m1.1a"><mo id="S3.T5.59.59.3.m1.1.1" mathsize="80%" xref="S3.T5.59.59.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.59.59.3.m1.1b"><csymbol cd="latexml" id="S3.T5.59.59.3.m1.1.1.cmml" xref="S3.T5.59.59.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.59.59.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.59.59.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.59.59.3.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T5.60.60.4">
<span class="ltx_text" id="S3.T5.60.60.4.1" style="font-size:80%;">0.079 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.60.60.4.m1.1"><semantics id="S3.T5.60.60.4.m1.1a"><mo id="S3.T5.60.60.4.m1.1.1" mathsize="80%" xref="S3.T5.60.60.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.60.60.4.m1.1b"><csymbol cd="latexml" id="S3.T5.60.60.4.m1.1.1.cmml" xref="S3.T5.60.60.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.60.60.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.60.60.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.60.60.4.2" style="font-size:80%;"> 0.003</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.61.61.5">
<span class="ltx_text" id="S3.T5.61.61.5.1" style="font-size:80%;">0.439 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.61.61.5.m1.1"><semantics id="S3.T5.61.61.5.m1.1a"><mo id="S3.T5.61.61.5.m1.1.1" mathsize="80%" xref="S3.T5.61.61.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.61.61.5.m1.1b"><csymbol cd="latexml" id="S3.T5.61.61.5.m1.1.1.cmml" xref="S3.T5.61.61.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.61.61.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.61.61.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.61.61.5.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.62.62.6">
<span class="ltx_text" id="S3.T5.62.62.6.1" style="font-size:80%;">0.313 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.62.62.6.m1.1"><semantics id="S3.T5.62.62.6.m1.1a"><mo id="S3.T5.62.62.6.m1.1.1" mathsize="80%" xref="S3.T5.62.62.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.62.62.6.m1.1b"><csymbol cd="latexml" id="S3.T5.62.62.6.m1.1.1.cmml" xref="S3.T5.62.62.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.62.62.6.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.62.62.6.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.62.62.6.2" style="font-size:80%;"> 0.002</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T5.63.63.7">
<span class="ltx_text" id="S3.T5.63.63.7.1" style="font-size:80%;">0.213 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.63.63.7.m1.1"><semantics id="S3.T5.63.63.7.m1.1a"><mo id="S3.T5.63.63.7.m1.1.1" mathsize="80%" xref="S3.T5.63.63.7.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.63.63.7.m1.1b"><csymbol cd="latexml" id="S3.T5.63.63.7.m1.1.1.cmml" xref="S3.T5.63.63.7.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.63.63.7.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.63.63.7.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.63.63.7.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T5.64.64.8">
<span class="ltx_text" id="S3.T5.64.64.8.1" style="font-size:80%;">0.078 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.64.64.8.m1.1"><semantics id="S3.T5.64.64.8.m1.1a"><mo id="S3.T5.64.64.8.m1.1.1" mathsize="80%" xref="S3.T5.64.64.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.64.64.8.m1.1b"><csymbol cd="latexml" id="S3.T5.64.64.8.m1.1.1.cmml" xref="S3.T5.64.64.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.64.64.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.64.64.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.64.64.8.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T5.72.72">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.72.72.9"><span class="ltx_text ltx_font_bold" id="S3.T5.72.72.9.1" style="font-size:80%;">ARCI</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.65.65.1"><span class="ltx_text ltx_font_bold" id="S3.T5.65.65.1.1" style="font-size:80%;">0.727 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.65.65.1.1.m1.1"><semantics id="S3.T5.65.65.1.1.m1.1a"><mo id="S3.T5.65.65.1.1.m1.1.1" xref="S3.T5.65.65.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.65.65.1.1.m1.1b"><csymbol cd="latexml" id="S3.T5.65.65.1.1.m1.1.1.cmml" xref="S3.T5.65.65.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.65.65.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.65.65.1.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.66.66.2"><span class="ltx_text ltx_font_bold" id="S3.T5.66.66.2.1" style="font-size:80%;">0.606 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.66.66.2.1.m1.1"><semantics id="S3.T5.66.66.2.1.m1.1a"><mo id="S3.T5.66.66.2.1.m1.1.1" xref="S3.T5.66.66.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.66.66.2.1.m1.1b"><csymbol cd="latexml" id="S3.T5.66.66.2.1.m1.1.1.cmml" xref="S3.T5.66.66.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.66.66.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.66.66.2.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.67.67.3"><span class="ltx_text ltx_font_bold" id="S3.T5.67.67.3.1" style="font-size:80%;">0.446 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.67.67.3.1.m1.1"><semantics id="S3.T5.67.67.3.1.m1.1a"><mo id="S3.T5.67.67.3.1.m1.1.1" xref="S3.T5.67.67.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.67.67.3.1.m1.1b"><csymbol cd="latexml" id="S3.T5.67.67.3.1.m1.1.1.cmml" xref="S3.T5.67.67.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.67.67.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.67.67.3.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T5.68.68.4">
<span class="ltx_text" id="S3.T5.68.68.4.1" style="font-size:80%;">0.073 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.68.68.4.m1.1"><semantics id="S3.T5.68.68.4.m1.1a"><mo id="S3.T5.68.68.4.m1.1.1" mathsize="80%" xref="S3.T5.68.68.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.68.68.4.m1.1b"><csymbol cd="latexml" id="S3.T5.68.68.4.m1.1.1.cmml" xref="S3.T5.68.68.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.68.68.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.68.68.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.68.68.4.2" style="font-size:80%;"> 0.001</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.69.69.5"><span class="ltx_text ltx_font_bold" id="S3.T5.69.69.5.1" style="font-size:80%;">0.472 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.69.69.5.1.m1.1"><semantics id="S3.T5.69.69.5.1.m1.1a"><mo id="S3.T5.69.69.5.1.m1.1.1" xref="S3.T5.69.69.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.69.69.5.1.m1.1b"><csymbol cd="latexml" id="S3.T5.69.69.5.1.m1.1.1.cmml" xref="S3.T5.69.69.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.69.69.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.69.69.5.1.m1.1d">±</annotation></semantics></math> 0.001</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.70.70.6"><span class="ltx_text ltx_font_bold" id="S3.T5.70.70.6.1" style="font-size:80%;">0.341 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.70.70.6.1.m1.1"><semantics id="S3.T5.70.70.6.1.m1.1a"><mo id="S3.T5.70.70.6.1.m1.1.1" xref="S3.T5.70.70.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.70.70.6.1.m1.1b"><csymbol cd="latexml" id="S3.T5.70.70.6.1.m1.1.1.cmml" xref="S3.T5.70.70.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.70.70.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.70.70.6.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.71.71.7"><span class="ltx_text ltx_font_bold" id="S3.T5.71.71.7.1" style="font-size:80%;">0.241 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.71.71.7.1.m1.1"><semantics id="S3.T5.71.71.7.1.m1.1a"><mo id="S3.T5.71.71.7.1.m1.1.1" xref="S3.T5.71.71.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.71.71.7.1.m1.1b"><csymbol cd="latexml" id="S3.T5.71.71.7.1.m1.1.1.cmml" xref="S3.T5.71.71.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.71.71.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.71.71.7.1.m1.1d">±</annotation></semantics></math> 0.002</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" id="S3.T5.72.72.8">
<span class="ltx_text" id="S3.T5.72.72.8.1" style="font-size:80%;">0.075 </span><math alttext="\pm" class="ltx_Math" display="inline" id="S3.T5.72.72.8.m1.1"><semantics id="S3.T5.72.72.8.m1.1a"><mo id="S3.T5.72.72.8.m1.1.1" mathsize="80%" xref="S3.T5.72.72.8.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T5.72.72.8.m1.1b"><csymbol cd="latexml" id="S3.T5.72.72.8.m1.1.1.cmml" xref="S3.T5.72.72.8.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.72.72.8.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T5.72.72.8.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T5.72.72.8.2" style="font-size:80%;"> 0.002</span>
</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsubsection" id="S3.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.1. </span>RQ1. Performance Comparison with Baselines:</h4>
<div class="ltx_para" id="S3.SS5.SSS1.p1">
<p class="ltx_p" id="S3.SS5.SSS1.p1.1">Tables <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T2" title="Table 2 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T3" title="Table 3 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> provides the comparison between baselines and ARCI based on the ranking metrics for MIMIC-III and AKI datasets. The results highlight superior performance of ARCI across all metrics, particularly demonstrating an advantage over one of the best-performing baselines, Retain, in the top rank. While Retain employs an RNN-based methodology for using both code-level and visit-level feature learning, the observed marginal difference suggests that temporal paths with contrasting patterns are more effective for temporal learning compared to interpretable RNNs. The enhancement made by ARCI compared to prescription recommendation systems, namely SafeDrug <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib40" title="">2021c</a>)</cite>, MoleRec <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib41" title="">2023c</a>)</cite>, GAMENet <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib27" title="">2019</a>)</cite>, and Micron <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib39" title="">2021b</a>)</cite>, demonstrating that the interdependency between medical codes across consecutive time steps results in more informative embeddings for future visit prediction.</p>
</div>
<div class="ltx_para" id="S3.SS5.SSS1.p2">
<p class="ltx_p" id="S3.SS5.SSS1.p2.1">Furthermore, we conducted experiments based on classification metrics, as outlined in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T4" title="Table 4 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. The results show the improved performance of our proposed method over all baselines in terms of the classification metrics.
MoleRec, SafeDrug, GAMENet, and Micron use DDI loss <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib27" title="">2019</a>)</cite> as part of their method. In contrast, our training process excludes this loss, with our primary focus on comprehensive embedding learning. Although Micron and MoleRec have better DDI rates compared to ARCI (0.5% for MIMIC-III and 0.8% for AKI), the marginal differences between the models in terms of PRAUC (10.1% for MIMIC-III and 3.7% for AKI) suggest that ARCI remains an effective prescription recommender.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.2. </span>RQ2. Ablation Studies:</h4>
<div class="ltx_para" id="S3.SS5.SSS2.p1">
<p class="ltx_p" id="S3.SS5.SSS2.p1.6">In the ablation studies, we investigate the impact of omitting each submodule on the overall performance. We include the Transformer’s encoder in the ablation analysis, as ARCI is built upon the Transformer architecture. ARCI has two main principal contributions: (1) Extracting temporal paths using the Cross-Visit Transformer, and (2) proposing the Contrasted Intent module for linking temporal paths and dependencies with distinct health profiles and capturing diverse embeddings. Results in Tables <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T2" title="Table 2 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T3" title="Table 3 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T4" title="Table 4 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> indicate adding Cross-Visit Transformer (ARCI w/o intent) enhances Transformer’s performance, showing the effectiveness of temporal paths compared to treating features as a bag-of-codes. Another observation is adding linear layers (ARCI w intent w/o <math alttext="\mathbf{\mathcal{L}}_{I}" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.1.m1.1"><semantics id="S3.SS5.SSS2.p1.1.m1.1a"><msub id="S3.SS5.SSS2.p1.1.m1.1.1" xref="S3.SS5.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.SSS2.p1.1.m1.1.1.2" xref="S3.SS5.SSS2.p1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS5.SSS2.p1.1.m1.1.1.3" xref="S3.SS5.SSS2.p1.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.1.m1.1b"><apply id="S3.SS5.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1.2">ℒ</ci><ci id="S3.SS5.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS5.SSS2.p1.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.1.m1.1c">\mathbf{\mathcal{L}}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>) as intents without any contrastive loss is beneficial, showing that incorporating general patient health information, even without any regularization, has a positive impact. Finally, based on the results and margins we can assume that <math alttext="\mathbf{\mathcal{L}}_{I}" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.2.m2.1"><semantics id="S3.SS5.SSS2.p1.2.m2.1a"><msub id="S3.SS5.SSS2.p1.2.m2.1.1" xref="S3.SS5.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.SSS2.p1.2.m2.1.1.2" xref="S3.SS5.SSS2.p1.2.m2.1.1.2.cmml">ℒ</mi><mi id="S3.SS5.SSS2.p1.2.m2.1.1.3" xref="S3.SS5.SSS2.p1.2.m2.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.2.m2.1b"><apply id="S3.SS5.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS5.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS5.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS5.SSS2.p1.2.m2.1.1.2">ℒ</ci><ci id="S3.SS5.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS5.SSS2.p1.2.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.2.m2.1c">\mathbf{\mathcal{L}}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is effective in achieving more general embeddings, a conclusion supported by Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.F4" title="Figure 4 ‣ 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. In this figure, the head representations from both datasets are considerably clustered into distinct groups. Additionally, the mean of the intents’ representations is close to their associated groups different from each other, showing the influence of <math alttext="\mathbf{\mathcal{L}}_{I}" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.3.m3.1"><semantics id="S3.SS5.SSS2.p1.3.m3.1a"><msub id="S3.SS5.SSS2.p1.3.m3.1.1" xref="S3.SS5.SSS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.SSS2.p1.3.m3.1.1.2" xref="S3.SS5.SSS2.p1.3.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS5.SSS2.p1.3.m3.1.1.3" xref="S3.SS5.SSS2.p1.3.m3.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.3.m3.1b"><apply id="S3.SS5.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS5.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS5.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS5.SSS2.p1.3.m3.1.1.2">ℒ</ci><ci id="S3.SS5.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS5.SSS2.p1.3.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.3.m3.1c">\mathbf{\mathcal{L}}_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> in generalization.
Furthermore, we explored the impact of varying the number of heads in the output results extracted from MIMIC-III. As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.F5" title="Figure 5 ‣ 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, the maximum effect of <math alttext="\mathbf{\mathcal{L}}{I}" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.4.m4.1"><semantics id="S3.SS5.SSS2.p1.4.m4.1a"><mrow id="S3.SS5.SSS2.p1.4.m4.1.1" xref="S3.SS5.SSS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.SSS2.p1.4.m4.1.1.2" xref="S3.SS5.SSS2.p1.4.m4.1.1.2.cmml">ℒ</mi><mo id="S3.SS5.SSS2.p1.4.m4.1.1.1" xref="S3.SS5.SSS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS5.SSS2.p1.4.m4.1.1.3" xref="S3.SS5.SSS2.p1.4.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.4.m4.1b"><apply id="S3.SS5.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS5.SSS2.p1.4.m4.1.1"><times id="S3.SS5.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS5.SSS2.p1.4.m4.1.1.1"></times><ci id="S3.SS5.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS5.SSS2.p1.4.m4.1.1.2">ℒ</ci><ci id="S3.SS5.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS5.SSS2.p1.4.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.4.m4.1c">\mathbf{\mathcal{L}}{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.4.m4.1d">caligraphic_L italic_I</annotation></semantics></math> occurs when <math alttext="J=4" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.5.m5.1"><semantics id="S3.SS5.SSS2.p1.5.m5.1a"><mrow id="S3.SS5.SSS2.p1.5.m5.1.1" xref="S3.SS5.SSS2.p1.5.m5.1.1.cmml"><mi id="S3.SS5.SSS2.p1.5.m5.1.1.2" xref="S3.SS5.SSS2.p1.5.m5.1.1.2.cmml">J</mi><mo id="S3.SS5.SSS2.p1.5.m5.1.1.1" xref="S3.SS5.SSS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS5.SSS2.p1.5.m5.1.1.3" xref="S3.SS5.SSS2.p1.5.m5.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.5.m5.1b"><apply id="S3.SS5.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS5.SSS2.p1.5.m5.1.1"><eq id="S3.SS5.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS5.SSS2.p1.5.m5.1.1.1"></eq><ci id="S3.SS5.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS5.SSS2.p1.5.m5.1.1.2">𝐽</ci><cn id="S3.SS5.SSS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS5.SSS2.p1.5.m5.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.5.m5.1c">J=4</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.5.m5.1d">italic_J = 4</annotation></semantics></math> for MIMIC and <math alttext="J=6" class="ltx_Math" display="inline" id="S3.SS5.SSS2.p1.6.m6.1"><semantics id="S3.SS5.SSS2.p1.6.m6.1a"><mrow id="S3.SS5.SSS2.p1.6.m6.1.1" xref="S3.SS5.SSS2.p1.6.m6.1.1.cmml"><mi id="S3.SS5.SSS2.p1.6.m6.1.1.2" xref="S3.SS5.SSS2.p1.6.m6.1.1.2.cmml">J</mi><mo id="S3.SS5.SSS2.p1.6.m6.1.1.1" xref="S3.SS5.SSS2.p1.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS5.SSS2.p1.6.m6.1.1.3" xref="S3.SS5.SSS2.p1.6.m6.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS2.p1.6.m6.1b"><apply id="S3.SS5.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS5.SSS2.p1.6.m6.1.1"><eq id="S3.SS5.SSS2.p1.6.m6.1.1.1.cmml" xref="S3.SS5.SSS2.p1.6.m6.1.1.1"></eq><ci id="S3.SS5.SSS2.p1.6.m6.1.1.2.cmml" xref="S3.SS5.SSS2.p1.6.m6.1.1.2">𝐽</ci><cn id="S3.SS5.SSS2.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS5.SSS2.p1.6.m6.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS2.p1.6.m6.1c">J=6</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS2.p1.6.m6.1d">italic_J = 6</annotation></semantics></math> for AKI because the optimal number of intents depends on the variability of medical conditions, linked to the number of patients which suggests that AKI has a higher variability in AKI with a higher J value. For ARCI, we combined three different loss functions for evaluation, and the impact of the contrastive loss has been examined. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.F6" title="Figure 6 ‣ 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, we evaluate the effects of the BCE and Hinge losses. As shown in the figure, BCE is the most effective for the multi-label classification task, while the Hinge loss provides a smaller performance improvement.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.3. </span>RQ3. Including Repetitive Prescriptions:</h4>
<div class="ltx_para" id="S3.SS5.SSS3.p1">
<p class="ltx_p" id="S3.SS5.SSS3.p1.1">To have more consistency with the previous model’s results in the literature as they include repetitive prescriptions and to have a comprehensive assessment, we extended our experiments to include repetitive prescriptions. As shown in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:repetitive</span>, ARCI has outperformed the baselines for both datasets across various classification metrics. Specifically, the best-performing baseline is the MoleRec model for the MIMIC-III and AKI datasets, which differs from the results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.T4" title="Table 4 ‣ 3.2. Experimental Setup ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. These findings suggest that the Retain model, which includes non-repetitive prescriptions, can outperform state-of-the-art prescription recommenders. However, for repetitive drugs, state-of-the-art models are more effective. The comparisons between ARCI, Retain, MoleRec, and SafeDrug in Tables <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:repetitive</span> illustrate that the intent-aware recommender with a multi-level Transformer architecture is effective for reliable prescription recommendations in the two aforementioned settings.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS5.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.5.4. </span>RQ4. Interpretability:</h4>
<div class="ltx_para" id="S3.SS5.SSS4.p1">
<p class="ltx_p" id="S3.SS5.SSS4.p1.1">The Cross-Visit Transformer employs an attention matrix to capture temporal paths between two consecutive time steps. In addition to cross-visit attention, the aggregation and prediction layer contains an interpretable visit attention mechanism through recurrent neural networks, showing the influence of each visit on the output prediction. To demonstrate the interpretability of the proposed method, we select one patient from the MIMIC-III dataset and illustrate the attention values for four different intents. As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#S3.F7" title="Figure 7 ‣ 3.5.4. RQ4. Interpretability: ‣ 3.5. Results and Discussion ‣ valuation ‣ Contrastive Learning on Medical Intents for Sequential Prescription Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>, each prescription is connected to another one with a temporal path, and the intensity of the colors reflects the connections’ strength.</p>
</div>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="458" id="S3.F7.sf1.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf1.3.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_ERROR undefined" id="S3.F7.sf1.4.2">\nth</span><span class="ltx_text" id="S3.F7.sf1.5.3" style="font-size:90%;">1 Intent Temporal Path</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="458" id="S3.F7.sf2.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf2.3.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_ERROR undefined" id="S3.F7.sf2.4.2">\nth</span><span class="ltx_text" id="S3.F7.sf2.5.3" style="font-size:90%;">2 Intent Temporal Path</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="458" id="S3.F7.sf3.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf3.3.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_ERROR undefined" id="S3.F7.sf3.4.2">\nth</span><span class="ltx_text" id="S3.F7.sf3.5.3" style="font-size:90%;">3 Intent Temporal Path</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="458" id="S3.F7.sf4.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.sf4.3.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_ERROR undefined" id="S3.F7.sf4.4.2">\nth</span><span class="ltx_text" id="S3.F7.sf4.5.3" style="font-size:90%;">4 Intent Temporal Path</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F7.2.1.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S3.F7.3.2" style="font-size:90%;">Illustration of the attention values and temporal paths generated by the proposed method, using a sample patient from the MIMIC-III dataset. The highlight behind each visit shows the visit-instance attention.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS5.SSS4.p2">
<p class="ltx_p" id="S3.SS5.SSS4.p2.6">In the first intent, the sequence of dependencies A04A <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS5.SSS4.p2.1.m1.1"><semantics id="S3.SS5.SSS4.p2.1.m1.1a"><mo id="S3.SS5.SSS4.p2.1.m1.1.1" stretchy="false" xref="S3.SS5.SSS4.p2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS4.p2.1.m1.1b"><ci id="S3.SS5.SSS4.p2.1.m1.1.1.cmml" xref="S3.SS5.SSS4.p2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS4.p2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS4.p2.1.m1.1d">→</annotation></semantics></math> P01A <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS5.SSS4.p2.2.m2.1"><semantics id="S3.SS5.SSS4.p2.2.m2.1a"><mo id="S3.SS5.SSS4.p2.2.m2.1.1" stretchy="false" xref="S3.SS5.SSS4.p2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS4.p2.2.m2.1b"><ci id="S3.SS5.SSS4.p2.2.m2.1.1.cmml" xref="S3.SS5.SSS4.p2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS4.p2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS4.p2.2.m2.1d">→</annotation></semantics></math> R05C <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS5.SSS4.p2.3.m3.1"><semantics id="S3.SS5.SSS4.p2.3.m3.1a"><mo id="S3.SS5.SSS4.p2.3.m3.1.1" stretchy="false" xref="S3.SS5.SSS4.p2.3.m3.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS4.p2.3.m3.1b"><ci id="S3.SS5.SSS4.p2.3.m3.1.1.cmml" xref="S3.SS5.SSS4.p2.3.m3.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS4.p2.3.m3.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS4.p2.3.m3.1d">→</annotation></semantics></math> R02A is one of the influential relations. According to the medical literature, A04A (antiemetics) is associated with P01A (Agents against protozoal diseases) <cite class="ltx_cite ltx_citemacro_citep">(Athavale et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib4" title="">2020</a>)</cite>, and R05C (cough suppressants) correlates with R02A (throat preparations)<cite class="ltx_cite ltx_citemacro_citep">(Sultana et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib28" title="">2016</a>)</cite>. In addition to temporal paths, the visit-instance attention mechanism highlights the significance of the first two visits compared to the latter ones due to The strong correlation between N05A (antipsychotics) N05C (hypnotics and sedatives) <cite class="ltx_cite ltx_citemacro_citep">(Charney et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib7" title="">2006</a>)</cite>, as well as B03A (iron preparations) with B05B (I.V. solutions) <cite class="ltx_cite ltx_citemacro_citep">(Auerbach et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib5" title="">2008</a>)</cite>.
For the second intent, one of the important dependencies is A04A <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS5.SSS4.p2.4.m4.1"><semantics id="S3.SS5.SSS4.p2.4.m4.1a"><mo id="S3.SS5.SSS4.p2.4.m4.1.1" stretchy="false" xref="S3.SS5.SSS4.p2.4.m4.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS4.p2.4.m4.1b"><ci id="S3.SS5.SSS4.p2.4.m4.1.1.cmml" xref="S3.SS5.SSS4.p2.4.m4.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS4.p2.4.m4.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS4.p2.4.m4.1d">→</annotation></semantics></math> B03A <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS5.SSS4.p2.5.m5.1"><semantics id="S3.SS5.SSS4.p2.5.m5.1a"><mo id="S3.SS5.SSS4.p2.5.m5.1.1" stretchy="false" xref="S3.SS5.SSS4.p2.5.m5.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS4.p2.5.m5.1b"><ci id="S3.SS5.SSS4.p2.5.m5.1.1.cmml" xref="S3.SS5.SSS4.p2.5.m5.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS4.p2.5.m5.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS4.p2.5.m5.1d">→</annotation></semantics></math> B02B <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S3.SS5.SSS4.p2.6.m6.1"><semantics id="S3.SS5.SSS4.p2.6.m6.1a"><mo id="S3.SS5.SSS4.p2.6.m6.1.1" stretchy="false" xref="S3.SS5.SSS4.p2.6.m6.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S3.SS5.SSS4.p2.6.m6.1b"><ci id="S3.SS5.SSS4.p2.6.m6.1.1.cmml" xref="S3.SS5.SSS4.p2.6.m6.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.SSS4.p2.6.m6.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.SSS4.p2.6.m6.1d">→</annotation></semantics></math> M01A, and previous studies support associations between B03A (iron preparations) and M01A (antiinflammatory and antirheumatic) <cite class="ltx_cite ltx_citemacro_citep">(Harshman and Shea, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib13" title="">2016</a>)</cite>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:144%;">   elated Work</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Medication Recommendation:</span> Since past years with the emergence of Deep Learning models <cite class="ltx_cite ltx_citemacro_citep">(Ajami et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib2" title="">2023</a>; Nayebi Kerdabadi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib23" title="">2023</a>)</cite>, numerous longitudinal methodologies have been developed to improve the embeddings derived from Electronic Health Records (EHR) for various applications, including prescription recommendation systems. Noteworthy early works include Dr. Agent <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib12" title="">2020</a>)</cite> wherein an RNN network employs a policy gradient for adaptive learning, and RETAIN <cite class="ltx_cite ltx_citemacro_citep">(Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib10" title="">2016</a>)</cite> which contains a dual-RNN network to embed multi-level attention mechanism for both medical codes and visits. The main drawback of these early methodologies is that they were not explicitly developed for the prescription recommendation. Enhancing safety and optimizing integration is achievable through a comprehensive understanding of drug-drug interactions (DDI). GAMENet addresses this issue <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib27" title="">2019</a>)</cite>, which uses a graph-based network to employ DDI as a loss function and evaluation metric. Other approaches like SafeDrug <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib40" title="">2021c</a>)</cite> focus on global message passing for recommending prescriptions based on DDI and molecular structures. MICRON <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib39" title="">2021b</a>)</cite> uses a residual neural network to update patient health histories and MoleRec <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib41" title="">2023c</a>)</cite> focuses on safety and performance improvement in drug recommendations by considering molecular structures.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.p1.1.2">User Intent and Sequential Recommendation:</span>
Sequential recommender systems utilize the user’s past behavior sequence in the recommendation process <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib15" title="">2018</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib32" title="">2023a</a>)</cite>. Earlier approaches often modeled temporal transformations using Markov Chains. For instance, FPMC <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib26" title="">2010</a>)</cite> combined Markov Chains and Matrix Factorization to recommend items based on user interests. With the advent of Deep Learning, a new generation of sequential recommenders has emerged. For example, ASReP <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib20" title="">2021</a>)</cite> contributes to the data sparsity problem by using a pre-trained Transformer-based method to augment the short sequences.
In addition to sequential recommendation systems, intent-aware systems have been developed to capture users’ multiple intentions for enhanced recommendations <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib21" title="">2020</a>; Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib34" title="">2021</a>)</cite>. For instance, Atten-Mixer <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib44" title="">2023a</a>)</cite> considers both concept-view and instance-view for items using the Transformer architecture, and ASLI <cite class="ltx_cite ltx_citemacro_citep">(Tanjim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib30" title="">2020</a>)</cite> extracts users’ multiple intents using a temporal convolutional network for predicting the next item in a sequence. Additionally, contrastive learning has been utilized for distinct intent learning in user preferences <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib33" title="">2023b</a>)</cite>. For instance, ICL <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10259v1#bib.bib9" title="">2022</a>)</cite> employs a latent variable that represents the distribution of users and their intent through clustering and contrastive learning.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:144%;">   onclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This paper presents <em class="ltx_emph ltx_font_italic" id="S5.p1.1.1">Attentive Recommendation with Contrasted Intents (ARCI)</em>, a prescription recommendation system with two primary contributions. Firstly, we propose a multi-level transformer-based model designed to extract visit-level and cross-visit dependencies to formulate temporal paths between medical codes. Second, we introduced a novel contrastive learning-based approach for transformers’ heads linked to different intents as specialized health profiles to handle a variety of dependency types and achieve more comprehensive embedding learning. ARCI outperforms the state-of-the-art healthcare models for prescription recommendations on two real-world datasets, while providing interpretable insights into the decision-making process of clinical practitioners.


</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">REFERENCES</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ajami et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hanieh Ajami, Mahsa Kargar
Nigjeh, and Scott E Umbaugh.
2023.

</span>
<span class="ltx_bibblock">Unsupervised white matter lesion identification in
multiple sclerosis (MS) using MRI segmentation and pattern classification: a
novel approach with CVIPtools. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Applications of
Digital Image Processing XLVI</em>, Vol. 12674. SPIE,
282–287.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ashton et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
James J Ashton, Aneurin
Young, Mark J Johnson, and R Mark
Beattie. 2023.

</span>
<span class="ltx_bibblock">Using machine learning to impact on long-term
clinical care: principles, challenges, and practicalities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Pediatric Research</em> 93,
2 (2023), 324–333.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Athavale et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Akshay Athavale, Tegan
Athavale, and Darren M Roberts.
2020.

</span>
<span class="ltx_bibblock">Antiemetic drugs: what to prescribe and when.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Australian Prescriber</em> 43,
2 (2020), 49.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Auerbach et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2008)</span>
<span class="ltx_bibblock">
Michael Auerbach, Dan
Coyne, and Harold Ballard.
2008.

</span>
<span class="ltx_bibblock">Intravenous iron: from anathema to standard of
care.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">American journal of hematology</em>
83, 7 (2008),
580–588.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhoi et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Suman Bhoi, Mong Li Lee,
Wynne Hsu, and Ngiap Chuan Tan.
2024.

</span>
<span class="ltx_bibblock">REFINE: A Fine-Grained Medication Recommendation
System Using Deep Learning and Personalized Drug Interaction Modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Advances in Neural Information Processing
Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Charney et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2006)</span>
<span class="ltx_bibblock">
Dennis S Charney, S John
Mihic, and R Adron Harris.
2006.

</span>
<span class="ltx_bibblock">Hypnotics and sedatives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">The Pharmacologic Basis of Therapeutics. 11th
ed. Brunton LL, Lazo JS, Parker KL (Eds). New York, McGraw-Hill</em>
(2006), 401–427.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ting Chen, Simon
Kornblith, Mohammad Norouzi, and
Geoffrey Hinton. 2020.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of
visual representations. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">International
conference on machine learning</em>. PMLR, 1597–1607.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yongjun Chen, Zhiwei Liu,
Jia Li, Julian McAuley, and
Caiming Xiong. 2022.

</span>
<span class="ltx_bibblock">Intent contrastive learning for sequential
recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the ACM Web
Conference 2022</em>. 2172–2182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Edward Choi, Mohammad Taha
Bahadori, Jimeng Sun, Joshua Kulas,
Andy Schuetz, and Walter Stewart.
2016.

</span>
<span class="ltx_bibblock">Retain: An interpretable predictive model for
healthcare using reverse time attention mechanism.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Advances in neural information processing
systems</em> 29 (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Edward Choi, Zhen Xu,
Yujia Li, Michael Dusenberry,
Gerardo Flores, Emily Xue, and
Andrew Dai. 2020.

</span>
<span class="ltx_bibblock">Learning the graphical structure of electronic
health records with graph convolutional transformer. In
<em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the AAAI conference on artificial
intelligence</em>, Vol. 34. 606–613.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Junyi Gao, Cao Xiao,
Lucas M Glass, and Jimeng Sun.
2020.

</span>
<span class="ltx_bibblock">Dr. Agent: Clinical predictive model via mimicked
second opinions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Journal of the American Medical Informatics
Association</em> 27, 7
(2020), 1084–1091.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harshman and Shea (2016)</span>
<span class="ltx_bibblock">
Stephanie G Harshman and
M Kyla Shea. 2016.

</span>
<span class="ltx_bibblock">The role of vitamin K in chronic aging diseases:
inflammation, cardiovascular disease, and osteoarthritis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Current nutrition reports</em>
5 (2016), 90–98.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Alistair EW Johnson, Tom J
Pollard, Lu Shen, Li-wei H Lehman,
Mengling Feng, Mohammad Ghassemi,
Benjamin Moody, Peter Szolovits,
Leo Anthony Celi, and Roger G Mark.
2016.

</span>
<span class="ltx_bibblock">MIMIC-III, a freely accessible critical care
database.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Scientific data</em> 3,
1 (2016), 1–9.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and
Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">2018 IEEE international conference on data mining
(ICDM)</em>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khosla et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Prannay Khosla, Piotr
Teterwak, Chen Wang, Aaron Sarna,
Yonglong Tian, Phillip Isola,
Aaron Maschinot, Ce Liu, and
Dilip Krishnan. 2020.

</span>
<span class="ltx_bibblock">Supervised contrastive learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Advances in neural information processing
systems</em> 33 (2020),
18661–18673.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma and
Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1412.6980</em>
(2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koniew (2020)</span>
<span class="ltx_bibblock">
Marek Koniew.
2020.

</span>
<span class="ltx_bibblock">Classification of the User’s Intent Detection in
Ecommerce systems-Survey and Recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">International Journal of Information
Engineering &amp; Electronic Business</em> 12,
6 (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kang Liu, Xiangzhou
Zhang, Weiqi Chen, SL Alan,
John A Kellum, Michael E Matheny,
Steven Q Simpson, Yong Hu, and
Mei Liu. 2022.

</span>
<span class="ltx_bibblock">Development and validation of a personalized model
with transfer learning for acute kidney injury risk estimation using
electronic health records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">JAMA Network Open</em> 5,
7 (2022),
e2219776–e2219776.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhiwei Liu, Ziwei Fan,
Yu Wang, and Philip S Yu.
2021.

</span>
<span class="ltx_bibblock">Augmenting sequential recommendation with
pseudo-prior items via reversely pre-training transformer. In
<em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 44th international ACM SIGIR
conference on Research and development in information retrieval</em>.
1608–1612.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Zhiwei Liu, Xiaohan Li,
Ziwei Fan, Stephen Guo,
Kannan Achan, and S Yu Philip.
2020.

</span>
<span class="ltx_bibblock">Basket recommendation with multi-intent translation
graph neural network. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">2020 IEEE International
Conference on Big Data (Big Data)</em>. IEEE, 728–737.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Michel et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Paul Michel, Omer Levy,
and Graham Neubig. 2019.

</span>
<span class="ltx_bibblock">Are sixteen heads really better than one?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Advances in neural information processing
systems</em> 32 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nayebi Kerdabadi et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Mohsen Nayebi Kerdabadi,
Arya Hadizadeh Moghaddam, Bin Liu,
Mei Liu, and Zijun Yao.
2023.

</span>
<span class="ltx_bibblock">Contrastive learning of temporal distinctiveness
for survival analysis in electronic health records. In
<em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 32nd ACM International
Conference on Information and Knowledge Management</em>.
1897–1906.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross,
Francisco Massa, Adam Lerer,
James Bradbury, Gregory Chanan,
Trevor Killeen, Zeming Lin,
Natalia Gimelshein, Luca Antiga,
et al<span class="ltx_text" id="bib.bib24.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep
learning library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.4.1">Advances in neural information processing
systems</em> 32 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ranjbar Kermany et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Naime Ranjbar Kermany,
Jian Yang, Jia Wu, and
Luiz Pizzato. 2022.

</span>
<span class="ltx_bibblock">Fair-srs: a fair session-based recommendation
system. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the Fifteenth ACM
International Conference on Web Search and Data Mining</em>.
1601–1604.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph
Freudenthaler, and Lars Schmidt-Thieme.
2010.

</span>
<span class="ltx_bibblock">Factorizing personalized Markov chains for
next-basket recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the
19th International Conference on World Wide Web</em> (Raleigh, North Carolina,
USA) <em class="ltx_emph ltx_font_italic" id="bib.bib26.4.2">(WWW ’10)</em>. Association for
Computing Machinery, New York, NY, USA,
811–820.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1772690.1772773" title="">https://doi.org/10.1145/1772690.1772773</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Junyuan Shang, Cao Xiao,
Tengfei Ma, Hongyan Li, and
Jimeng Sun. 2019.

</span>
<span class="ltx_bibblock">Gamenet: Graph augmented memory networks for
recommending medication combination. In
<em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">proceedings of the AAAI Conference on Artificial
Intelligence</em>, Vol. 33. 1126–1133.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sultana et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Shahnaz Sultana, Andleeb
Khan, Mohammed M Safhi, and Hassan A
Alhazmi. 2016.

</span>
<span class="ltx_bibblock">Cough suppressant herbal drugs: A review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Int. J. Pharm. Sci. Invent</em>
5, 5 (2016),
15–28.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Hongda Sun, Shufang Xie,
Shuqi Li, Yuhan Chen,
Ji-Rong Wen, and Rui Yan.
2022.

</span>
<span class="ltx_bibblock">Debiased, Longitudinal and Coordinated Drug
Recommendation through Multi-Visit Clinic Records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Advances in Neural Information Processing
Systems</em> 35 (2022),
27837–27849.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tanjim et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Md Mehrab Tanjim, Congzhe
Su, Ethan Benjamin, Diane Hu,
Liangjie Hong, and Julian McAuley.
2020.

</span>
<span class="ltx_bibblock">Attentive sequential models of latent intent for
next item recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Proceedings of The
Web Conference 2020</em>. 2528–2534.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam
Shazeer, Niki Parmar, Jakob Uszkoreit,
Llion Jones, Aidan N Gomez,
Łukasz Kaiser, and Illia
Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Advances in neural information processing
systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Chenyang Wang, Weizhi Ma,
Chong Chen, Min Zhang,
Yiqun Liu, and Shaoping Ma.
2023a.

</span>
<span class="ltx_bibblock">Sequential recommendation with multiple contrast
signals.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">ACM Transactions on Information Systems</em>
41, 1 (2023),
1–27.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Yuling Wang, Xiao Wang,
Xiangzhou Huang, Yanhua Yu,
Haoyang Li, Mengdi Zhang,
Zirui Guo, and Wei Wu.
2023b.

</span>
<span class="ltx_bibblock">Intent-aware recommendation via disentangled graph
contrastive learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 32th
international joint conference on artificial intelligence</em>.
2343–2351.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yinwei Wei, Xiang Wang,
Xiangnan He, Liqiang Nie,
Yong Rui, and Tat-Seng Chua.
2021.

</span>
<span class="ltx_bibblock">Hierarchical user intent graph network for
multimedia recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">IEEE Transactions on Multimedia</em>
24 (2021), 2701–2712.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Rui Wu, Zhaopeng Qiu,
Jiacheng Jiang, Guilin Qi, and
Xian Wu. 2022.

</span>
<span class="ltx_bibblock">Conditional generation net for medication
recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proceedings of the ACM Web
Conference 2022</em>. 935–945.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shu Wu, Yuyuan Tang,
Yanqiao Zhu, Liang Wang,
Xing Xie, and Tieniu Tan.
2019.

</span>
<span class="ltx_bibblock">Session-based recommendation with graph neural
networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the AAAI conference on
artificial intelligence</em>, Vol. 33.
346–353.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Chaoqi Yang, Zhenbang Wu,
Patrick Jiang, Zhen Lin,
Junyi Gao, Benjamin Danek, and
Jimeng Sun. 2023b.

</span>
<span class="ltx_bibblock">PyHealth: A Deep Learning Toolkit for Healthcare
Predictive Modeling. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Proceedings of the 27th
ACM SIGKDD International Conference on Knowledge Discovery and Data Mining
(KDD) 2023</em>.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/sunlabuiuc/PyHealth" title="">https://github.com/sunlabuiuc/PyHealth</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Chaoqi Yang, Cao Xiao,
Lucas Glass, and Jimeng Sun.
2021a.

</span>
<span class="ltx_bibblock">Change matters: Medication change prediction with
recurrent residual networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">arXiv preprint arXiv:2105.01876</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Chaoqi Yang, Cao Xiao,
Lucas Glass, and Jimeng Sun.
2021b.

</span>
<span class="ltx_bibblock">Change matters: Medication change prediction with
recurrent residual networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">arXiv preprint arXiv:2105.01876</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2021c)</span>
<span class="ltx_bibblock">
Chaoqi Yang, Cao Xiao,
Fenglong Ma, Lucas Glass, and
Jimeng Sun. 2021c.

</span>
<span class="ltx_bibblock">Safedrug: Dual molecular graph encoders for
recommending effective and safe drug combinations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">arXiv preprint arXiv:2105.02711</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Nianzu Yang, Kaipeng
Zeng, Qitian Wu, and Junchi Yan.
2023c.

</span>
<span class="ltx_bibblock">Molerec: Combinatorial drug recommendation with
substructure-aware molecular representation learning. In
<em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the ACM Web Conference 2023</em>.
4075–4085.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Zhichao Yang, Avijit
Mitra, Weisong Liu, Dan Berlowitz, and
Hong Yu. 2023a.

</span>
<span class="ltx_bibblock">TransformEHR: transformer-based encoder-decoder
generative model to enhance prediction of disease outcomes using electronic
health records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Nature Communications</em> 14,
1 (2023), 7857.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zijun Yao, Bin Liu,
Fei Wang, Daby Sow, and
Ying Li. 2023.

</span>
<span class="ltx_bibblock">Ontology-aware prescription recommendation in
treatment pathways using multi-evidence healthcare data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">ACM Transactions on Information Systems</em>
41, 4 (2023),
1–29.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Peiyan Zhang, Jiayan Guo,
Chaozhuo Li, Yueqi Xie,
Jae Boum Kim, Yan Zhang,
Xing Xie, Haohan Wang, and
Sunghun Kim. 2023a.

</span>
<span class="ltx_bibblock">Efficiently leveraging multi-level user intent for
session-based recommendation via atten-mixer network. In
<em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the Sixteenth ACM International
Conference on Web Search and Data Mining</em>. 168–176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Yipeng Zhang, Xin Wang,
Hong Chen, and Wenwu Zhu.
2023b.

</span>
<span class="ltx_bibblock">Adaptive disentangled transformer for sequential
recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Proceedings of the 29th ACM
SIGKDD Conference on Knowledge Discovery and Data Mining</em>.
3434–3445.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Yingying Zhang, Xian Wu,
Quan Fang, Shengsheng Qian, and
Changsheng Xu. 2023c.

</span>
<span class="ltx_bibblock">Knowledge-enhanced attributed multi-task learning
for medicine recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">ACM Transactions on Information Systems</em>
41, 1 (2023),
1–24.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ding Zou, Wei Wei,
Xian-Ling Mao, Ziyang Wang,
Minghui Qiu, Feida Zhu, and
Xin Cao. 2022.

</span>
<span class="ltx_bibblock">Multi-level cross-view contrastive learning for
knowledge-aware recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proceedings
of the 45th International ACM SIGIR Conference on Research and Development in
Information Retrieval</em>. 1358–1368.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Aug 13 20:02:52 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
