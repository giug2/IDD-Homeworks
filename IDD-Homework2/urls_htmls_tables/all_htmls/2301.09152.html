<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2301.09152] Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data</title><meta property="og:description" content="To tackle the global climate challenge, it urgently needs to develop a collaborative platform for comprehensive weather forecasting on large-scale meteorological data. Despite urgency, heterogeneous meteorological sens…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2301.09152">

<!--Generated on Fri Mar  1 06:03:51 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Prompt Federated Learning for Weather Forecasting: 
<br class="ltx_break">Toward Foundation Models on Meteorological Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Shengchao Chen

</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guodong Long
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tao Shen&amp;Jing Jiang
Australian Artificial Intelligence Institute, FEIT, University of Technology Sydney
<br class="ltx_break">shengchao.chen.uts@gmail.com,
{guodong.long, tao.shen, jing.jiang}@uts.edu.au
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">To tackle the global climate challenge, it urgently needs to develop a collaborative platform for comprehensive weather forecasting on large-scale meteorological data. Despite urgency, heterogeneous meteorological sensors across countries and regions, inevitably causing multivariate heterogeneity and data exposure, become the main barrier. This paper develops a foundation model across regions capable of understanding complex meteorological data and providing weather forecasting. To relieve the data exposure concern across regions, a novel federated learning approach has been proposed to collaboratively learn a brand-new spatio-temporal Transformer-based foundation model across participants with heterogeneous meteorological data. Moreover, a novel prompt learning mechanism has been adopted to satisfy low-resourced sensors’ communication and computational constraints. The effectiveness of the proposed method has been demonstrated on classical weather forecasting tasks using three meteorological datasets with multivariate time series.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Climate change will significantly impact all regions; however, the specific effects will vary <cite class="ltx_cite ltx_citemacro_cite">Kjellstrom <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2016</a>)</cite>. Increasing global temperatures and melting ice will lead to alterations in sea levels, ocean currents, weather patterns, and cloud cover <cite class="ltx_cite ltx_citemacro_cite">Hagemann <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2013</a>)</cite>. To effectively tackle the challenge of global climate change, the implementation of a large-scale collaborative data-sharing platform is essential. Although this work is labor-intensive and demands a multitude of skilled experts, the utilization of machine learning techniques can enhance efficiency in addressing this problem. Nonetheless, the machine learning domain faces a challenge when attempting to employ a centralized uniform model to serve all regions due to their heterogeneity. An effective solution involves pre-training a foundational model using extensive weather data and enabling each region to fine-tune the model using a relatively small data to enhance its ability to capture local weather patterns.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2301.09152/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="180" height="140" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.2.1" class="ltx_text" style="font-size:90%;">Our <span id="S1.F1.2.1.1" class="ltx_text ltx_font_italic">MetePFL</span> for weather forecasting. i) pre-trained FM initializes the local FM; ii) local FM trains using local data; iii) the server aggregates and transmits local prompts’ parameters.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Weather forecasting is a fundamental analytical task aimed at modeling the dynamic changes of weather on both a global and regional scale. Multi-sensor weather forecasting serves as a critical tool in mitigating the loss of human lives and property by providing early warnings for extreme weather events resulting from global climate change <cite class="ltx_cite ltx_citemacro_cite">Chattopadhyay <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>. The objective of this approach is to capture potential correlations between multiple meteorological factors and the tendency of weather variations in order to gain a comprehensive understanding of specific regions. Unlike conventional time-series data, weather time-series data in meteorology are gathered from sensing devices distributed across diverse geographical locations <cite class="ltx_cite ltx_citemacro_cite">Campbell and
Diebold (<a href="#bib.bib4" title="" class="ltx_ref">2005</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">One-step forecasting <cite class="ltx_cite ltx_citemacro_cite">Chen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite>, empowered by recent advancements in deep learning, have garnered considerable attention due to their high efficiency. However, the performance of these strategies is hindered by the non-stationary nature of weather changes. This limitation arises from their reliance on fixed patterns derived from prior knowledge. To address this issue and capture temporal information, other studies <cite class="ltx_cite ltx_citemacro_cite">Karevan and
Suykens (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>); Alléon <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite> suggest formulating the tasks as auto-regression problems. These studies utilize preceding time step variables to predict variables at the subsequent time step <cite class="ltx_cite ltx_citemacro_cite">Chen and Lai (<a href="#bib.bib6" title="" class="ltx_ref">2011</a>)</cite>. This technique is commonly implemented using RNN or Transformer models. The choice of these models is based on their superior performance in time series analysis <cite class="ltx_cite ltx_citemacro_cite">Shi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib34" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">However, previous works focus on using an uniform model to serve all regions regardless of heterogeneity. In contrast, foundation model (FM) represents a novel service architecture that aims to pre-train a large model with extensive data. Subsequently, this model can be fine-tuned for specific tasks using relevant data, such as weather forecasting in a particular region. The FM has the capability to capture common knowledge shared among multiple tasks or participants. Further refinements can then enhance its alignment with the specific requirements of a given task. The FM has demonstrated remarkable success in Natural Language Processing (NLP), exemplified by ChatGPT <cite class="ltx_cite ltx_citemacro_cite">Schulman <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite>. Notably, recent progress in foundation models has been observed across diverse domains, including ViT <cite class="ltx_cite ltx_citemacro_cite">Xu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib42" title="" class="ltx_ref">2022</a>)</cite>, BERT <cite class="ltx_cite ltx_citemacro_cite">Yates <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib43" title="" class="ltx_ref">2021</a>)</cite>, and CLIP <cite class="ltx_cite ltx_citemacro_cite">Radford <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In contrast to existing FMs, training a FM on weather forecasting tasks must tackle the following challenges. First, sharing raw data across countries/regions will not be easy. Second, transmitting and processing the continuously collected data is a challenge for low-resourced sensors or devices. Third, real-time forecasting is critically important.
In summary, we need a solution to tackle data security, communication, and computation efficiency issues and provide on-device decisions independently.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">This paper will design a novel machine-learning approach to train foundation models on weather forecasting tasks. The model will be capable of understanding and constructing the complex spatiotemporal relationship of meteorological data to provide reliable analysis support on weather forecasting and global climate challenges.
Specifically, we propose a novel <span id="S1.p6.1.1" class="ltx_text ltx_font_bold">Mete</span>orological <span id="S1.p6.1.2" class="ltx_text ltx_font_bold">P</span>rompt <span id="S1.p6.1.3" class="ltx_text ltx_font_bold">F</span>ederated <span id="S1.p6.1.4" class="ltx_text ltx_font_bold">L</span>earning (<span id="S1.p6.1.5" class="ltx_text ltx_font_italic">MetePFL</span>) approach to collaboratively learn a Transformer-based foundation model (FM) across devices with multivariate time-series data (see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The <span id="S1.p6.1.6" class="ltx_text ltx_font_italic">MetePFL</span> only considers the model parameters exchange among devices rather than direct data sharing. Considering the low-resourced sensors’ communication efficiency constraint, a brand-new prompt learning mechanism is introduced upon a pre-trained FM to comprehensively explore the correlation among weather-related variables while computing a few parameters.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Three weather forecasting datasets based on multivariate time series with multiple meteorological factors, i.e., precipitation, temperature, upstream, are leveraged to verify the effectiveness of <span id="S1.p7.1.1" class="ltx_text ltx_font_italic">MetePFL</span>.
The main contributions of this work are summarized in four-fold:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">This is the first work to explore a foundation model-based solution to enhance weather forecasting tasks towards a global scale.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">The proposed prompt federated learning approach is a novel mechanism to collaboratively learns a foundation model for the applications with many satellite sites or stations across regions.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">A spatio-temporal prompt learning mechanism has been designed to efficiently tackle multivariable time series.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Experiments on three real datasets have demonstrated the effectiveness and superior of our proposed solution. It is worth noting that we obtain excellent performance with only 2.38<math id="S1.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S1.I1.i4.p1.1.m1.1a"><mo id="S1.I1.i4.p1.1.m1.1.1" xref="S1.I1.i4.p1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S1.I1.i4.p1.1.m1.1b"><csymbol cd="latexml" id="S1.I1.i4.p1.1.m1.1.1.cmml" xref="S1.I1.i4.p1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i4.p1.1.m1.1c">\%</annotation></semantics></math> of the model’s parameters trained.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Weather Forecasting.</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Weather forecasting plays a crucial role in the global climate analysis system. Conventional forecasting methods utilize numerical weather prediction (NWP) models, which incorporate physical constraints to simulate weather phenomena <cite class="ltx_cite ltx_citemacro_cite">Bauer <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2015</a>)</cite>. However, with the emergence of data-driven approaches, weather forecasting has shifted towards approaches driven by data, such as ARIMA <cite class="ltx_cite ltx_citemacro_cite">Chen and Lai (<a href="#bib.bib6" title="" class="ltx_ref">2011</a>)</cite>, SVM <cite class="ltx_cite ltx_citemacro_cite">Sapankevych and
Sankar (<a href="#bib.bib32" title="" class="ltx_ref">2009</a>)</cite>, and NNs <cite class="ltx_cite ltx_citemacro_cite">Voyant <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib39" title="" class="ltx_ref">2012</a>)</cite>. While these basic models exhibit potential, they encounter difficulties in comprehending nonlinear temporal dynamics. Deep Learning methods, especially models based on Recurrent Neural Networks (RNNs), have exhibited promising outcomes in weather forecasting <cite class="ltx_cite ltx_citemacro_cite">Shi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib34" title="" class="ltx_ref">2015</a>)</cite>. Recently, Transformers have demonstrated superior performance compared to RNN-based models in time series analysis <cite class="ltx_cite ltx_citemacro_cite">Bojesomo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>, thereby gaining popularity for weather-related tasks <cite class="ltx_cite ltx_citemacro_cite">Chen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite>. However, these models neglect the data exposure concerns when utilizing multi-sensor data for real-world tasks and modeling spatio-temporal correlations.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Foundation Model.</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">A fully supervised learning paradigm needs a large scale of data. The foundation model provides a practical solution for scenario-specific tasks, aiming to pre-train a model using extensive prior knowledge. The FM has widespread applications in NLP <cite class="ltx_cite ltx_citemacro_cite">Yates <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib43" title="" class="ltx_ref">2021</a>); Schulman <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite> and CV <cite class="ltx_cite ltx_citemacro_cite">Xu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib42" title="" class="ltx_ref">2022</a>); Radford <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>, providing an effective cross-task learning strategy. For example, ChatGPT <cite class="ltx_cite ltx_citemacro_cite">Schulman <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite> can be used as a baseline model for researchers to fine-tune it to achieve more accurate responses for downstream tasks.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Federated Learning.</h4>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">Federated learning (FL) is a new learning paradigm to embody the collaborative training of models without requiring data exposure from each participant (e.g., meteorological sensors) <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib29" title="" class="ltx_ref">2017</a>); Long <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib26" title="" class="ltx_ref">2021</a>, <a href="#bib.bib25" title="" class="ltx_ref">2020</a>); Jiang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>. Vanilla FL suffer from the heterogeneity of data and devices. Personalized FL aims to solve the problem by multiple techniques <cite class="ltx_cite ltx_citemacro_cite">Tan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib36" title="" class="ltx_ref">2022a</a>); Chen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2022a</a>); Wang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib40" title="" class="ltx_ref">2022</a>); Ma <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib28" title="" class="ltx_ref">2022</a>); Tan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib35" title="" class="ltx_ref">2021</a>); Zhang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib46" title="" class="ltx_ref">2023</a>); Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2023</a>); Long <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib27" title="" class="ltx_ref">2023</a>); Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib21" title="" class="ltx_ref">2019</a>, <a href="#bib.bib22" title="" class="ltx_ref">2020</a>); Gao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite> via training better personalized model for each client. However, these methods are not suitable for weather forecasting due to all parameters must be considered during communication so that hinder the real-time forecasting. pre-train-based strategy can mitigate the problem <cite class="ltx_cite ltx_citemacro_cite">Tan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib37" title="" class="ltx_ref">2022b</a>)</cite> but can not explore the spatio-temporal correlations. Different from the above methods, this paper focuses on establishing a high-efficiency FL approach that provides analytical support to across-regional weather forecasting systems with heterogeneous meteorological data.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Prompt Learning.</h4>

<div id="S2.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px4.p1.1" class="ltx_p">Prompt learning as a lightweight mechanism is widely used in NLP <cite class="ltx_cite ltx_citemacro_cite">Li and Liang (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>); Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>, which requires fewer parameters and is more adaptive than fine-tuned pre-trained models by represented by several prompt tuning strategies in different applications <cite class="ltx_cite ltx_citemacro_cite">Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib48" title="" class="ltx_ref">2022a</a>)</cite>.
Different from language data, understanding multidimensional correlation among multivariate data in the weather forecasting task is critical. However, the key point is often ignored by the federated prompt learning method <cite class="ltx_cite ltx_citemacro_cite">Guo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2022</a>)</cite>.
The paper introduces a novel prompt mechanism within the FL framework based on pre-trained FM to explore the temporal dynamics and the potential correlation among clients while computing only a few parameters.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Formulation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.7" class="ltx_p">Given <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">N</annotation></semantics></math> clients that possess individual local private datasets <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">D</annotation></semantics></math>, each client has a multivariate time series denoted as <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="{\bm{X}}_{i}\in\mathbb{R}^{m\times n}" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><msub id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml"><mi id="S3.p1.3.m3.1.1.2.2" xref="S3.p1.3.m3.1.1.2.2.cmml">𝑿</mi><mi id="S3.p1.3.m3.1.1.2.3" xref="S3.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.3.m3.1.1.1" xref="S3.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mi id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml"><mi id="S3.p1.3.m3.1.1.3.3.2" xref="S3.p1.3.m3.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.3.m3.1.1.3.3.1" xref="S3.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.3.m3.1.1.3.3.3" xref="S3.p1.3.m3.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><in id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1"></in><apply id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.2.1.cmml" xref="S3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.2.cmml" xref="S3.p1.3.m3.1.1.2.2">𝑿</ci><ci id="S3.p1.3.m3.1.1.2.3.cmml" xref="S3.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3"><times id="S3.p1.3.m3.1.1.3.3.1.cmml" xref="S3.p1.3.m3.1.1.3.3.1"></times><ci id="S3.p1.3.m3.1.1.3.3.2.cmml" xref="S3.p1.3.m3.1.1.3.3.2">𝑚</ci><ci id="S3.p1.3.m3.1.1.3.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">{\bm{X}}_{i}\in\mathbb{R}^{m\times n}</annotation></semantics></math>. In this notation, each sample at a specific time step <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">t</annotation></semantics></math> is represented as <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="{\bm{x}}_{t}\in\mathbb{R}^{1\times n}" display="inline"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><msub id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml"><mi id="S3.p1.5.m5.1.1.2.2" xref="S3.p1.5.m5.1.1.2.2.cmml">𝒙</mi><mi id="S3.p1.5.m5.1.1.2.3" xref="S3.p1.5.m5.1.1.2.3.cmml">t</mi></msub><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml"><mi id="S3.p1.5.m5.1.1.3.2" xref="S3.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.5.m5.1.1.3.3" xref="S3.p1.5.m5.1.1.3.3.cmml"><mn id="S3.p1.5.m5.1.1.3.3.2" xref="S3.p1.5.m5.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.p1.5.m5.1.1.3.3.1" xref="S3.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.5.m5.1.1.3.3.3" xref="S3.p1.5.m5.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><in id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></in><apply id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.2.1.cmml" xref="S3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.2.cmml" xref="S3.p1.5.m5.1.1.2.2">𝒙</ci><ci id="S3.p1.5.m5.1.1.2.3.cmml" xref="S3.p1.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.p1.5.m5.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.p1.5.m5.1.1.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3"><times id="S3.p1.5.m5.1.1.3.3.1.cmml" xref="S3.p1.5.m5.1.1.3.3.1"></times><cn type="integer" id="S3.p1.5.m5.1.1.3.3.2.cmml" xref="S3.p1.5.m5.1.1.3.3.2">1</cn><ci id="S3.p1.5.m5.1.1.3.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">{\bm{x}}_{t}\in\mathbb{R}^{1\times n}</annotation></semantics></math>. Weather forecasting using multivariate time series can be defined as the process of utilizing historical values of all variables for a duration of <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">P</annotation></semantics></math> periods to predict the values of a specific variable in the future over <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">Q</annotation></semantics></math> periods, can be defined below:
<span id="S3.p1.7.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\left[{\bm{x}}_{t-P},{\bm{x}}_{t-P+1},\cdots,{\bm{x}}_{t}\right]\stackrel{{\scriptstyle f}}{{\longrightarrow}}\left[{\bm{x}}_{t+1}^{\prime},{\bm{x}}_{t+2}^{\prime},\cdots,{\bm{x}}_{t+Q}^{\prime}\right]," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.4.cmml"><mo id="S3.E1.m1.3.3.1.1.3.3.4" xref="S3.E1.m1.3.3.1.1.3.4.cmml">[</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.3.1.cmml">−</mo><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.3.cmml">P</mi></mrow></msub><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.3.3.5" xref="S3.E1.m1.3.3.1.1.3.4.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml">𝒙</mi><mrow id="S3.E1.m1.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.2.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.3.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.2.cmml">t</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.3.2.1" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.1.cmml">−</mo><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.3.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.3.cmml">P</mi></mrow><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.3.1" xref="S3.E1.m1.3.3.1.1.2.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.3.3.6" xref="S3.E1.m1.3.3.1.1.3.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">⋯</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.3.3.7" xref="S3.E1.m1.3.3.1.1.3.4.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.3.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.3.2.cmml">𝒙</mi><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.3.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.3.cmml">t</mi></msub><mo id="S3.E1.m1.3.3.1.1.3.3.8" xref="S3.E1.m1.3.3.1.1.3.4.cmml">]</mo></mrow><mover id="S3.E1.m1.3.3.1.1.7" xref="S3.E1.m1.3.3.1.1.7.cmml"><mo mathsize="90%" stretchy="false" id="S3.E1.m1.3.3.1.1.7.2" xref="S3.E1.m1.3.3.1.1.7.2.cmml">⟶</mo><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.7.3" xref="S3.E1.m1.3.3.1.1.7.3.cmml">f</mi></mover><mrow id="S3.E1.m1.3.3.1.1.6.3" xref="S3.E1.m1.3.3.1.1.6.4.cmml"><mo id="S3.E1.m1.3.3.1.1.6.3.4" xref="S3.E1.m1.3.3.1.1.6.4.cmml">[</mo><msubsup id="S3.E1.m1.3.3.1.1.4.1.1" xref="S3.E1.m1.3.3.1.1.4.1.1.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.4.1.1.2.2" xref="S3.E1.m1.3.3.1.1.4.1.1.2.2.cmml">𝒙</mi><mrow id="S3.E1.m1.3.3.1.1.4.1.1.2.3" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.4.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.4.1.1.2.3.1" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3.1.cmml">+</mo><mn mathsize="90%" id="S3.E1.m1.3.3.1.1.4.1.1.2.3.3" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3.3.cmml">1</mn></mrow><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.4.1.1.3" xref="S3.E1.m1.3.3.1.1.4.1.1.3.cmml">′</mo></msubsup><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.5" xref="S3.E1.m1.3.3.1.1.6.4.cmml">,</mo><msubsup id="S3.E1.m1.3.3.1.1.5.2.2" xref="S3.E1.m1.3.3.1.1.5.2.2.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.5.2.2.2.2" xref="S3.E1.m1.3.3.1.1.5.2.2.2.2.cmml">𝒙</mi><mrow id="S3.E1.m1.3.3.1.1.5.2.2.2.3" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.5.2.2.2.3.2" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.5.2.2.2.3.1" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="S3.E1.m1.3.3.1.1.5.2.2.2.3.3" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3.3.cmml">2</mn></mrow><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.5.2.2.3" xref="S3.E1.m1.3.3.1.1.5.2.2.3.cmml">′</mo></msubsup><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.6" xref="S3.E1.m1.3.3.1.1.6.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">⋯</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.7" xref="S3.E1.m1.3.3.1.1.6.4.cmml">,</mo><msubsup id="S3.E1.m1.3.3.1.1.6.3.3" xref="S3.E1.m1.3.3.1.1.6.3.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.3.2.2" xref="S3.E1.m1.3.3.1.1.6.3.3.2.2.cmml">𝒙</mi><mrow id="S3.E1.m1.3.3.1.1.6.3.3.2.3" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.3.2.3.2" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.3.2.3.1" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3.1.cmml">+</mo><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.3.2.3.3" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3.3.cmml">Q</mi></mrow><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.6.3.3.3" xref="S3.E1.m1.3.3.1.1.6.3.3.3.cmml">′</mo></msubsup><mo id="S3.E1.m1.3.3.1.1.6.3.8" xref="S3.E1.m1.3.3.1.1.6.4.cmml">]</mo></mrow></mrow><mo mathsize="90%" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><apply id="S3.E1.m1.3.3.1.1.7.cmml" xref="S3.E1.m1.3.3.1.1.7"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.7.1.cmml" xref="S3.E1.m1.3.3.1.1.7">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.7.2.cmml" xref="S3.E1.m1.3.3.1.1.7.2">⟶</ci><ci id="S3.E1.m1.3.3.1.1.7.3.cmml" xref="S3.E1.m1.3.3.1.1.7.3">𝑓</ci></apply><list id="S3.E1.m1.3.3.1.1.3.4.cmml" xref="S3.E1.m1.3.3.1.1.3.3"><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2">𝒙</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3"><minus id="S3.E1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.1"></minus><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2">𝑡</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.3">𝑃</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2">𝒙</ci><apply id="S3.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3"><plus id="S3.E1.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.1"></plus><apply id="S3.E1.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2"><minus id="S3.E1.m1.3.3.1.1.2.2.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.1"></minus><ci id="S3.E1.m1.3.3.1.1.2.2.2.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.2">𝑡</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.3">𝑃</ci></apply><cn type="integer" id="S3.E1.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">⋯</ci><apply id="S3.E1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.2">𝒙</ci><ci id="S3.E1.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3">𝑡</ci></apply></list><list id="S3.E1.m1.3.3.1.1.6.4.cmml" xref="S3.E1.m1.3.3.1.1.6.3"><apply id="S3.E1.m1.3.3.1.1.4.1.1.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.4.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.4.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1.2.2">𝒙</ci><apply id="S3.E1.m1.3.3.1.1.4.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3"><plus id="S3.E1.m1.3.3.1.1.4.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3.1"></plus><ci id="S3.E1.m1.3.3.1.1.4.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.4.1.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.3.3.1.1.4.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.4.1.1.3">′</ci></apply><apply id="S3.E1.m1.3.3.1.1.5.2.2.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.5.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.5.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.5.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.5.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2.2.2">𝒙</ci><apply id="S3.E1.m1.3.3.1.1.5.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3"><plus id="S3.E1.m1.3.3.1.1.5.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3.1"></plus><ci id="S3.E1.m1.3.3.1.1.5.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.5.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2.2.3.3">2</cn></apply></apply><ci id="S3.E1.m1.3.3.1.1.5.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.5.2.2.3">′</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">⋯</ci><apply id="S3.E1.m1.3.3.1.1.6.3.3.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.6.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.6.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.6.3.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.6.3.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3.2.2">𝒙</ci><apply id="S3.E1.m1.3.3.1.1.6.3.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3"><plus id="S3.E1.m1.3.3.1.1.6.3.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3.1"></plus><ci id="S3.E1.m1.3.3.1.1.6.3.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3.2">𝑡</ci><ci id="S3.E1.m1.3.3.1.1.6.3.3.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3.2.3.3">𝑄</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.6.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.6.3.3.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\left[{\bm{x}}_{t-P},{\bm{x}}_{t-P+1},\cdots,{\bm{x}}_{t}\right]\stackrel{{\scriptstyle f}}{{\longrightarrow}}\left[{\bm{x}}_{t+1}^{\prime},{\bm{x}}_{t+2}^{\prime},\cdots,{\bm{x}}_{t+Q}^{\prime}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.11" class="ltx_p">where <math id="S3.p1.8.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.p1.8.m1.1a"><mi id="S3.p1.8.m1.1.1" xref="S3.p1.8.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m1.1b"><ci id="S3.p1.8.m1.1.1.cmml" xref="S3.p1.8.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m1.1c">f</annotation></semantics></math> is a learning system, and <math id="S3.p1.9.m2.1" class="ltx_Math" alttext="{\bm{x}}_{t}^{\prime}\in\mathbb{R}^{1\times 1}" display="inline"><semantics id="S3.p1.9.m2.1a"><mrow id="S3.p1.9.m2.1.1" xref="S3.p1.9.m2.1.1.cmml"><msubsup id="S3.p1.9.m2.1.1.2" xref="S3.p1.9.m2.1.1.2.cmml"><mi id="S3.p1.9.m2.1.1.2.2.2" xref="S3.p1.9.m2.1.1.2.2.2.cmml">𝒙</mi><mi id="S3.p1.9.m2.1.1.2.2.3" xref="S3.p1.9.m2.1.1.2.2.3.cmml">t</mi><mo id="S3.p1.9.m2.1.1.2.3" xref="S3.p1.9.m2.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.p1.9.m2.1.1.1" xref="S3.p1.9.m2.1.1.1.cmml">∈</mo><msup id="S3.p1.9.m2.1.1.3" xref="S3.p1.9.m2.1.1.3.cmml"><mi id="S3.p1.9.m2.1.1.3.2" xref="S3.p1.9.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.9.m2.1.1.3.3" xref="S3.p1.9.m2.1.1.3.3.cmml"><mn id="S3.p1.9.m2.1.1.3.3.2" xref="S3.p1.9.m2.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.p1.9.m2.1.1.3.3.1" xref="S3.p1.9.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.p1.9.m2.1.1.3.3.3" xref="S3.p1.9.m2.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m2.1b"><apply id="S3.p1.9.m2.1.1.cmml" xref="S3.p1.9.m2.1.1"><in id="S3.p1.9.m2.1.1.1.cmml" xref="S3.p1.9.m2.1.1.1"></in><apply id="S3.p1.9.m2.1.1.2.cmml" xref="S3.p1.9.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p1.9.m2.1.1.2.1.cmml" xref="S3.p1.9.m2.1.1.2">superscript</csymbol><apply id="S3.p1.9.m2.1.1.2.2.cmml" xref="S3.p1.9.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p1.9.m2.1.1.2.2.1.cmml" xref="S3.p1.9.m2.1.1.2">subscript</csymbol><ci id="S3.p1.9.m2.1.1.2.2.2.cmml" xref="S3.p1.9.m2.1.1.2.2.2">𝒙</ci><ci id="S3.p1.9.m2.1.1.2.2.3.cmml" xref="S3.p1.9.m2.1.1.2.2.3">𝑡</ci></apply><ci id="S3.p1.9.m2.1.1.2.3.cmml" xref="S3.p1.9.m2.1.1.2.3">′</ci></apply><apply id="S3.p1.9.m2.1.1.3.cmml" xref="S3.p1.9.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p1.9.m2.1.1.3.1.cmml" xref="S3.p1.9.m2.1.1.3">superscript</csymbol><ci id="S3.p1.9.m2.1.1.3.2.cmml" xref="S3.p1.9.m2.1.1.3.2">ℝ</ci><apply id="S3.p1.9.m2.1.1.3.3.cmml" xref="S3.p1.9.m2.1.1.3.3"><times id="S3.p1.9.m2.1.1.3.3.1.cmml" xref="S3.p1.9.m2.1.1.3.3.1"></times><cn type="integer" id="S3.p1.9.m2.1.1.3.3.2.cmml" xref="S3.p1.9.m2.1.1.3.3.2">1</cn><cn type="integer" id="S3.p1.9.m2.1.1.3.3.3.cmml" xref="S3.p1.9.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m2.1c">{\bm{x}}_{t}^{\prime}\in\mathbb{R}^{1\times 1}</annotation></semantics></math> is the value of the variable to be forecasting at the <math id="S3.p1.10.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.10.m3.1a"><mi id="S3.p1.10.m3.1.1" xref="S3.p1.10.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m3.1b"><ci id="S3.p1.10.m3.1.1.cmml" xref="S3.p1.10.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m3.1c">t</annotation></semantics></math>-th time step.
Valida FL system aims to minimize the average loss of the global model <math id="S3.p1.11.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.p1.11.m4.1a"><mi id="S3.p1.11.m4.1.1" xref="S3.p1.11.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.p1.11.m4.1b"><ci id="S3.p1.11.m4.1.1.cmml" xref="S3.p1.11.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m4.1c">w</annotation></semantics></math> on all clients’ local dataset:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.6" class="ltx_Math" alttext="F(w)\text{:}=\mathop{\arg\min}\limits_{w_{1},w_{2},...,w_{N}}\sum_{k=1}^{N}\frac{n_{k}}{n}F_{k}(w_{k})," display="block"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.3" xref="S3.E2.m1.6.6.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.3.2" xref="S3.E2.m1.6.6.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.3.1" xref="S3.E2.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.3.3.2" xref="S3.E2.m1.6.6.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.3.3.2.1" xref="S3.E2.m1.6.6.1.1.3.cmml">(</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">w</mi><mo stretchy="false" id="S3.E2.m1.6.6.1.1.3.3.2.2" xref="S3.E2.m1.6.6.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.3.1a" xref="S3.E2.m1.6.6.1.1.3.1.cmml">​</mo><mtext id="S3.E2.m1.6.6.1.1.3.4" xref="S3.E2.m1.6.6.1.1.3.4a.cmml">:</mtext></mrow><mo id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><munder id="S3.E2.m1.6.6.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.2.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.2.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.2.2.1" xref="S3.E2.m1.6.6.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E2.m1.6.6.1.1.1.2.2a" xref="S3.E2.m1.6.6.1.1.1.2.2.cmml">⁡</mo><mi id="S3.E2.m1.6.6.1.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.E2.m1.4.4.4.4" xref="S3.E2.m1.4.4.4.5.cmml"><msub id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.1.2.cmml">w</mi><mn id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.4.4.4.4.4" xref="S3.E2.m1.4.4.4.5.cmml">,</mo><msub id="S3.E2.m1.3.3.3.3.2" xref="S3.E2.m1.3.3.3.3.2.cmml"><mi id="S3.E2.m1.3.3.3.3.2.2" xref="S3.E2.m1.3.3.3.3.2.2.cmml">w</mi><mn id="S3.E2.m1.3.3.3.3.2.3" xref="S3.E2.m1.3.3.3.3.2.3.cmml">2</mn></msub><mo id="S3.E2.m1.4.4.4.4.5" xref="S3.E2.m1.4.4.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">…</mi><mo id="S3.E2.m1.4.4.4.4.6" xref="S3.E2.m1.4.4.4.5.cmml">,</mo><msub id="S3.E2.m1.4.4.4.4.3" xref="S3.E2.m1.4.4.4.4.3.cmml"><mi id="S3.E2.m1.4.4.4.4.3.2" xref="S3.E2.m1.4.4.4.4.3.2.cmml">w</mi><mi id="S3.E2.m1.4.4.4.4.3.3" xref="S3.E2.m1.4.4.4.4.3.3.cmml">N</mi></msub></mrow></munder><mrow id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml"><munderover id="S3.E2.m1.6.6.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.6.6.1.1.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.2.2.3.2" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.6.6.1.1.1.1.2.2.3.1" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.6.6.1.1.1.1.2.2.3.3" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.6.6.1.1.1.1.2.3" xref="S3.E2.m1.6.6.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.6.6.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.cmml"><mfrac id="S3.E2.m1.6.6.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.6.6.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.3.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2.2.cmml">n</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.3.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2.3.cmml">k</mi></msub><mi id="S3.E2.m1.6.6.1.1.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E2.m1.6.6.1.1.1.1.1.4" xref="S3.E2.m1.6.6.1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.4.2" xref="S3.E2.m1.6.6.1.1.1.1.1.4.2.cmml">F</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.4.3" xref="S3.E2.m1.6.6.1.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.1.1.1.1.1.2a" xref="S3.E2.m1.6.6.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2"></eq><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.3"><times id="S3.E2.m1.6.6.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.1"></times><ci id="S3.E2.m1.6.6.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2">𝐹</ci><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑤</ci><ci id="S3.E2.m1.6.6.1.1.3.4a.cmml" xref="S3.E2.m1.6.6.1.1.3.4"><mtext id="S3.E2.m1.6.6.1.1.3.4.cmml" xref="S3.E2.m1.6.6.1.1.3.4">:</mtext></ci></apply><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2">subscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2"><arg id="S3.E2.m1.6.6.1.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2.1"></arg><min id="S3.E2.m1.6.6.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2.2.2"></min></apply><list id="S3.E2.m1.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.4"><apply id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.2">𝑤</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.3">1</cn></apply><apply id="S3.E2.m1.3.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.2.1.cmml" xref="S3.E2.m1.3.3.3.3.2">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.2.2.cmml" xref="S3.E2.m1.3.3.3.3.2.2">𝑤</ci><cn type="integer" id="S3.E2.m1.3.3.3.3.2.3.cmml" xref="S3.E2.m1.3.3.3.3.2.3">2</cn></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">…</ci><apply id="S3.E2.m1.4.4.4.4.3.cmml" xref="S3.E2.m1.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.3.1.cmml" xref="S3.E2.m1.4.4.4.4.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.3.2.cmml" xref="S3.E2.m1.4.4.4.4.3.2">𝑤</ci><ci id="S3.E2.m1.4.4.4.4.3.3.cmml" xref="S3.E2.m1.4.4.4.4.3.3">𝑁</ci></apply></list></apply><apply id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.6.6.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3"><eq id="S3.E2.m1.6.6.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.6.6.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.6.6.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3"><divide id="S3.E2.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3"></divide><apply id="S3.E2.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2.2">𝑛</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E2.m1.6.6.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.4.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.4.2">𝐹</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.4.3">𝑘</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">F(w)\text{:}=\mathop{\arg\min}\limits_{w_{1},w_{2},...,w_{N}}\sum_{k=1}^{N}\frac{n_{k}}{n}F_{k}(w_{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.16" class="ltx_p">where <math id="S3.p1.12.m1.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.p1.12.m1.1a"><msub id="S3.p1.12.m1.1.1" xref="S3.p1.12.m1.1.1.cmml"><mi id="S3.p1.12.m1.1.1.2" xref="S3.p1.12.m1.1.1.2.cmml">n</mi><mi id="S3.p1.12.m1.1.1.3" xref="S3.p1.12.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.12.m1.1b"><apply id="S3.p1.12.m1.1.1.cmml" xref="S3.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.12.m1.1.1.1.cmml" xref="S3.p1.12.m1.1.1">subscript</csymbol><ci id="S3.p1.12.m1.1.1.2.cmml" xref="S3.p1.12.m1.1.1.2">𝑛</ci><ci id="S3.p1.12.m1.1.1.3.cmml" xref="S3.p1.12.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m1.1c">n_{k}</annotation></semantics></math> is the number of samples hold by the <math id="S3.p1.13.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.13.m2.1a"><mi id="S3.p1.13.m2.1.1" xref="S3.p1.13.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m2.1b"><ci id="S3.p1.13.m2.1.1.cmml" xref="S3.p1.13.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m2.1c">k</annotation></semantics></math>-th client. <math id="S3.p1.14.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.p1.14.m3.1a"><mi id="S3.p1.14.m3.1.1" xref="S3.p1.14.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p1.14.m3.1b"><ci id="S3.p1.14.m3.1.1.cmml" xref="S3.p1.14.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m3.1c">n</annotation></semantics></math> is the number of samples held by all clients. <math id="S3.p1.15.m4.1" class="ltx_Math" alttext="F_{k}(w_{k})" display="inline"><semantics id="S3.p1.15.m4.1a"><mrow id="S3.p1.15.m4.1.1" xref="S3.p1.15.m4.1.1.cmml"><msub id="S3.p1.15.m4.1.1.3" xref="S3.p1.15.m4.1.1.3.cmml"><mi id="S3.p1.15.m4.1.1.3.2" xref="S3.p1.15.m4.1.1.3.2.cmml">F</mi><mi id="S3.p1.15.m4.1.1.3.3" xref="S3.p1.15.m4.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.15.m4.1.1.2" xref="S3.p1.15.m4.1.1.2.cmml">​</mo><mrow id="S3.p1.15.m4.1.1.1.1" xref="S3.p1.15.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.15.m4.1.1.1.1.2" xref="S3.p1.15.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.p1.15.m4.1.1.1.1.1" xref="S3.p1.15.m4.1.1.1.1.1.cmml"><mi id="S3.p1.15.m4.1.1.1.1.1.2" xref="S3.p1.15.m4.1.1.1.1.1.2.cmml">w</mi><mi id="S3.p1.15.m4.1.1.1.1.1.3" xref="S3.p1.15.m4.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.p1.15.m4.1.1.1.1.3" xref="S3.p1.15.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.15.m4.1b"><apply id="S3.p1.15.m4.1.1.cmml" xref="S3.p1.15.m4.1.1"><times id="S3.p1.15.m4.1.1.2.cmml" xref="S3.p1.15.m4.1.1.2"></times><apply id="S3.p1.15.m4.1.1.3.cmml" xref="S3.p1.15.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p1.15.m4.1.1.3.1.cmml" xref="S3.p1.15.m4.1.1.3">subscript</csymbol><ci id="S3.p1.15.m4.1.1.3.2.cmml" xref="S3.p1.15.m4.1.1.3.2">𝐹</ci><ci id="S3.p1.15.m4.1.1.3.3.cmml" xref="S3.p1.15.m4.1.1.3.3">𝑘</ci></apply><apply id="S3.p1.15.m4.1.1.1.1.1.cmml" xref="S3.p1.15.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.15.m4.1.1.1.1.1.1.cmml" xref="S3.p1.15.m4.1.1.1.1">subscript</csymbol><ci id="S3.p1.15.m4.1.1.1.1.1.2.cmml" xref="S3.p1.15.m4.1.1.1.1.1.2">𝑤</ci><ci id="S3.p1.15.m4.1.1.1.1.1.3.cmml" xref="S3.p1.15.m4.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m4.1c">F_{k}(w_{k})</annotation></semantics></math> denotes the local objective function of <math id="S3.p1.16.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p1.16.m5.1a"><mi id="S3.p1.16.m5.1.1" xref="S3.p1.16.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p1.16.m5.1b"><ci id="S3.p1.16.m5.1.1.cmml" xref="S3.p1.16.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m5.1c">k</annotation></semantics></math>-th client.
The distinguishing factor is that each client possesses a unique pattern, and sensors are deployed in specific locations, resulting in a statistically heterogeneous environment. To address this challenge, PFL is typically modeled as a bi-level optimization problem.</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.8" class="ltx_Math" alttext="\displaystyle F(v;w)\text{:}=\mathop{\arg\min}\limits_{\{w_{1},w_{2},...,w_{N}\},\{v_{1},v_{2},...,v_{N}\}}\sum_{k=1}^{N}G_{k}(v_{k},w)," display="inline"><semantics id="S3.Ex1.m1.8a"><mrow id="S3.Ex1.m1.8.8.1" xref="S3.Ex1.m1.8.8.1.1.cmml"><mrow id="S3.Ex1.m1.8.8.1.1" xref="S3.Ex1.m1.8.8.1.1.cmml"><mrow id="S3.Ex1.m1.8.8.1.1.3" xref="S3.Ex1.m1.8.8.1.1.3.cmml"><mi id="S3.Ex1.m1.8.8.1.1.3.2" xref="S3.Ex1.m1.8.8.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.8.8.1.1.3.1" xref="S3.Ex1.m1.8.8.1.1.3.1.cmml">​</mo><mrow id="S3.Ex1.m1.8.8.1.1.3.3.2" xref="S3.Ex1.m1.8.8.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.8.8.1.1.3.3.2.1" xref="S3.Ex1.m1.8.8.1.1.3.3.1.cmml">(</mo><mi id="S3.Ex1.m1.5.5" xref="S3.Ex1.m1.5.5.cmml">v</mi><mo id="S3.Ex1.m1.8.8.1.1.3.3.2.2" xref="S3.Ex1.m1.8.8.1.1.3.3.1.cmml">;</mo><mi id="S3.Ex1.m1.6.6" xref="S3.Ex1.m1.6.6.cmml">w</mi><mo stretchy="false" id="S3.Ex1.m1.8.8.1.1.3.3.2.3" xref="S3.Ex1.m1.8.8.1.1.3.3.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.8.8.1.1.3.1a" xref="S3.Ex1.m1.8.8.1.1.3.1.cmml">​</mo><mtext id="S3.Ex1.m1.8.8.1.1.3.4" xref="S3.Ex1.m1.8.8.1.1.3.4a.cmml">:</mtext></mrow><mo id="S3.Ex1.m1.8.8.1.1.2" xref="S3.Ex1.m1.8.8.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.8.8.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.cmml"><munder id="S3.Ex1.m1.8.8.1.1.1.2" xref="S3.Ex1.m1.8.8.1.1.1.2.cmml"><mrow id="S3.Ex1.m1.8.8.1.1.1.2.2" xref="S3.Ex1.m1.8.8.1.1.1.2.2.cmml"><mi id="S3.Ex1.m1.8.8.1.1.1.2.2.1" xref="S3.Ex1.m1.8.8.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.Ex1.m1.8.8.1.1.1.2.2a" xref="S3.Ex1.m1.8.8.1.1.1.2.2.cmml">⁡</mo><mi id="S3.Ex1.m1.8.8.1.1.1.2.2.2" xref="S3.Ex1.m1.8.8.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.Ex1.m1.4.4.4.4" xref="S3.Ex1.m1.4.4.4.5.cmml"><mrow id="S3.Ex1.m1.3.3.3.3.1.3" xref="S3.Ex1.m1.3.3.3.3.1.4.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.3.3.1.3.4" xref="S3.Ex1.m1.3.3.3.3.1.4.cmml">{</mo><msub id="S3.Ex1.m1.3.3.3.3.1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.2" xref="S3.Ex1.m1.3.3.3.3.1.1.1.2.cmml">w</mi><mn id="S3.Ex1.m1.3.3.3.3.1.1.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.3.3.3.3.1.3.5" xref="S3.Ex1.m1.3.3.3.3.1.4.cmml">,</mo><msub id="S3.Ex1.m1.3.3.3.3.1.2.2" xref="S3.Ex1.m1.3.3.3.3.1.2.2.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.2.2.2" xref="S3.Ex1.m1.3.3.3.3.1.2.2.2.cmml">w</mi><mn id="S3.Ex1.m1.3.3.3.3.1.2.2.3" xref="S3.Ex1.m1.3.3.3.3.1.2.2.3.cmml">2</mn></msub><mo id="S3.Ex1.m1.3.3.3.3.1.3.6" xref="S3.Ex1.m1.3.3.3.3.1.4.cmml">,</mo><mi mathvariant="normal" id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml">…</mi><mo id="S3.Ex1.m1.3.3.3.3.1.3.7" xref="S3.Ex1.m1.3.3.3.3.1.4.cmml">,</mo><msub id="S3.Ex1.m1.3.3.3.3.1.3.3" xref="S3.Ex1.m1.3.3.3.3.1.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.3.3.2" xref="S3.Ex1.m1.3.3.3.3.1.3.3.2.cmml">w</mi><mi id="S3.Ex1.m1.3.3.3.3.1.3.3.3" xref="S3.Ex1.m1.3.3.3.3.1.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.Ex1.m1.3.3.3.3.1.3.8" xref="S3.Ex1.m1.3.3.3.3.1.4.cmml">}</mo></mrow><mo id="S3.Ex1.m1.4.4.4.4.3" xref="S3.Ex1.m1.4.4.4.5.cmml">,</mo><mrow id="S3.Ex1.m1.4.4.4.4.2.3" xref="S3.Ex1.m1.4.4.4.4.2.4.cmml"><mo stretchy="false" id="S3.Ex1.m1.4.4.4.4.2.3.4" xref="S3.Ex1.m1.4.4.4.4.2.4.cmml">{</mo><msub id="S3.Ex1.m1.4.4.4.4.2.1.1" xref="S3.Ex1.m1.4.4.4.4.2.1.1.cmml"><mi id="S3.Ex1.m1.4.4.4.4.2.1.1.2" xref="S3.Ex1.m1.4.4.4.4.2.1.1.2.cmml">v</mi><mn id="S3.Ex1.m1.4.4.4.4.2.1.1.3" xref="S3.Ex1.m1.4.4.4.4.2.1.1.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.4.4.4.4.2.3.5" xref="S3.Ex1.m1.4.4.4.4.2.4.cmml">,</mo><msub id="S3.Ex1.m1.4.4.4.4.2.2.2" xref="S3.Ex1.m1.4.4.4.4.2.2.2.cmml"><mi id="S3.Ex1.m1.4.4.4.4.2.2.2.2" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2.cmml">v</mi><mn id="S3.Ex1.m1.4.4.4.4.2.2.2.3" xref="S3.Ex1.m1.4.4.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.Ex1.m1.4.4.4.4.2.3.6" xref="S3.Ex1.m1.4.4.4.4.2.4.cmml">,</mo><mi mathvariant="normal" id="S3.Ex1.m1.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.cmml">…</mi><mo id="S3.Ex1.m1.4.4.4.4.2.3.7" xref="S3.Ex1.m1.4.4.4.4.2.4.cmml">,</mo><msub id="S3.Ex1.m1.4.4.4.4.2.3.3" xref="S3.Ex1.m1.4.4.4.4.2.3.3.cmml"><mi id="S3.Ex1.m1.4.4.4.4.2.3.3.2" xref="S3.Ex1.m1.4.4.4.4.2.3.3.2.cmml">v</mi><mi id="S3.Ex1.m1.4.4.4.4.2.3.3.3" xref="S3.Ex1.m1.4.4.4.4.2.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.Ex1.m1.4.4.4.4.2.3.8" xref="S3.Ex1.m1.4.4.4.4.2.4.cmml">}</mo></mrow></mrow></munder><mrow id="S3.Ex1.m1.8.8.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m1.8.8.1.1.1.1.2" xref="S3.Ex1.m1.8.8.1.1.1.1.2.cmml"><munderover id="S3.Ex1.m1.8.8.1.1.1.1.2a" xref="S3.Ex1.m1.8.8.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m1.8.8.1.1.1.1.2.2.2" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.2" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.1" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.3" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.8.8.1.1.1.1.2.3" xref="S3.Ex1.m1.8.8.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.Ex1.m1.8.8.1.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.8.8.1.1.1.1.1.3" xref="S3.Ex1.m1.8.8.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.8.8.1.1.1.1.1.3.2" xref="S3.Ex1.m1.8.8.1.1.1.1.1.3.2.cmml">G</mi><mi id="S3.Ex1.m1.8.8.1.1.1.1.1.3.3" xref="S3.Ex1.m1.8.8.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.8.8.1.1.1.1.1.2" xref="S3.Ex1.m1.8.8.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex1.m1.7.7" xref="S3.Ex1.m1.7.7.cmml">w</mi><mo stretchy="false" id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m1.8.8.1.2" xref="S3.Ex1.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.8b"><apply id="S3.Ex1.m1.8.8.1.1.cmml" xref="S3.Ex1.m1.8.8.1"><eq id="S3.Ex1.m1.8.8.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.2"></eq><apply id="S3.Ex1.m1.8.8.1.1.3.cmml" xref="S3.Ex1.m1.8.8.1.1.3"><times id="S3.Ex1.m1.8.8.1.1.3.1.cmml" xref="S3.Ex1.m1.8.8.1.1.3.1"></times><ci id="S3.Ex1.m1.8.8.1.1.3.2.cmml" xref="S3.Ex1.m1.8.8.1.1.3.2">𝐹</ci><list id="S3.Ex1.m1.8.8.1.1.3.3.1.cmml" xref="S3.Ex1.m1.8.8.1.1.3.3.2"><ci id="S3.Ex1.m1.5.5.cmml" xref="S3.Ex1.m1.5.5">𝑣</ci><ci id="S3.Ex1.m1.6.6.cmml" xref="S3.Ex1.m1.6.6">𝑤</ci></list><ci id="S3.Ex1.m1.8.8.1.1.3.4a.cmml" xref="S3.Ex1.m1.8.8.1.1.3.4"><mtext id="S3.Ex1.m1.8.8.1.1.3.4.cmml" xref="S3.Ex1.m1.8.8.1.1.3.4">:</mtext></ci></apply><apply id="S3.Ex1.m1.8.8.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1"><apply id="S3.Ex1.m1.8.8.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.1.2.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.2">subscript</csymbol><apply id="S3.Ex1.m1.8.8.1.1.1.2.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.2.2"><arg id="S3.Ex1.m1.8.8.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.2.2.1"></arg><min id="S3.Ex1.m1.8.8.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.2.2.2"></min></apply><list id="S3.Ex1.m1.4.4.4.5.cmml" xref="S3.Ex1.m1.4.4.4.4"><set id="S3.Ex1.m1.3.3.3.3.1.4.cmml" xref="S3.Ex1.m1.3.3.3.3.1.3"><apply id="S3.Ex1.m1.3.3.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.2">𝑤</ci><cn type="integer" id="S3.Ex1.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.3">1</cn></apply><apply id="S3.Ex1.m1.3.3.3.3.1.2.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.2.2.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.2.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.3.1.2.2.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.2.2.2">𝑤</ci><cn type="integer" id="S3.Ex1.m1.3.3.3.3.1.2.2.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.2.2.3">2</cn></apply><ci id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">…</ci><apply id="S3.Ex1.m1.3.3.3.3.1.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.3.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.3.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.3.1.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.3.3.2">𝑤</ci><ci id="S3.Ex1.m1.3.3.3.3.1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.3.3.3">𝑁</ci></apply></set><set id="S3.Ex1.m1.4.4.4.4.2.4.cmml" xref="S3.Ex1.m1.4.4.4.4.2.3"><apply id="S3.Ex1.m1.4.4.4.4.2.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.4.4.2.1.1.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.1">subscript</csymbol><ci id="S3.Ex1.m1.4.4.4.4.2.1.1.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.1.2">𝑣</ci><cn type="integer" id="S3.Ex1.m1.4.4.4.4.2.1.1.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1.1.3">1</cn></apply><apply id="S3.Ex1.m1.4.4.4.4.2.2.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2.2.2">𝑣</ci><cn type="integer" id="S3.Ex1.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.2.2.3">2</cn></apply><ci id="S3.Ex1.m1.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2">…</ci><apply id="S3.Ex1.m1.4.4.4.4.2.3.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.4.4.2.3.3.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.3.3">subscript</csymbol><ci id="S3.Ex1.m1.4.4.4.4.2.3.3.2.cmml" xref="S3.Ex1.m1.4.4.4.4.2.3.3.2">𝑣</ci><ci id="S3.Ex1.m1.4.4.4.4.2.3.3.3.cmml" xref="S3.Ex1.m1.4.4.4.4.2.3.3.3">𝑁</ci></apply></set></list></apply><apply id="S3.Ex1.m1.8.8.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1"><apply id="S3.Ex1.m1.8.8.1.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1.m1.8.8.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1.m1.8.8.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.2"></sum><apply id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3"><eq id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.8.8.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.Ex1.m1.8.8.1.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1"><times id="S3.Ex1.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.2"></times><apply id="S3.Ex1.m1.8.8.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.3.2">𝐺</ci><ci id="S3.Ex1.m1.8.8.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.3.3">𝑘</ci></apply><interval closure="open" id="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1"><apply id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><ci id="S3.Ex1.m1.7.7.cmml" xref="S3.Ex1.m1.7.7">𝑤</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.8c">\displaystyle F(v;w)\text{:}=\mathop{\arg\min}\limits_{\{w_{1},w_{2},...,w_{N}\},\{v_{1},v_{2},...,v_{N}\}}\sum_{k=1}^{N}G_{k}(v_{k},w),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_math_unparsed" alttext="\displaystyle i.e.\quad G_{k}(v_{k},w)=\frac{n_{k}}{n}F_{k}(v_{k})+\lambda R(v_{k},w)," display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2b"><mi id="S3.E3.m1.1.1">i</mi><mo lspace="0em" rspace="0.167em" id="S3.E3.m1.2.3">.</mo><mi id="S3.E3.m1.2.2">e</mi><mo lspace="0em" id="S3.E3.m1.2.4">.</mo><mspace width="1.167em" id="S3.E3.m1.2.5"></mspace><msub id="S3.E3.m1.2.6"><mi id="S3.E3.m1.2.6.2">G</mi><mi id="S3.E3.m1.2.6.3">k</mi></msub><mrow id="S3.E3.m1.2.7"><mo stretchy="false" id="S3.E3.m1.2.7.1">(</mo><msub id="S3.E3.m1.2.7.2"><mi id="S3.E3.m1.2.7.2.2">v</mi><mi id="S3.E3.m1.2.7.2.3">k</mi></msub><mo id="S3.E3.m1.2.7.3">,</mo><mi id="S3.E3.m1.2.7.4">w</mi><mo stretchy="false" id="S3.E3.m1.2.7.5">)</mo></mrow><mo id="S3.E3.m1.2.8">=</mo><mstyle displaystyle="true" id="S3.E3.m1.2.9"><mfrac id="S3.E3.m1.2.9a"><msub id="S3.E3.m1.2.9.2"><mi id="S3.E3.m1.2.9.2.2">n</mi><mi id="S3.E3.m1.2.9.2.3">k</mi></msub><mi id="S3.E3.m1.2.9.3">n</mi></mfrac></mstyle><msub id="S3.E3.m1.2.10"><mi id="S3.E3.m1.2.10.2">F</mi><mi id="S3.E3.m1.2.10.3">k</mi></msub><mrow id="S3.E3.m1.2.11"><mo stretchy="false" id="S3.E3.m1.2.11.1">(</mo><msub id="S3.E3.m1.2.11.2"><mi id="S3.E3.m1.2.11.2.2">v</mi><mi id="S3.E3.m1.2.11.2.3">k</mi></msub><mo stretchy="false" id="S3.E3.m1.2.11.3">)</mo></mrow><mo id="S3.E3.m1.2.12">+</mo><mi id="S3.E3.m1.2.13">λ</mi><mi id="S3.E3.m1.2.14">R</mi><mrow id="S3.E3.m1.2.15"><mo stretchy="false" id="S3.E3.m1.2.15.1">(</mo><msub id="S3.E3.m1.2.15.2"><mi id="S3.E3.m1.2.15.2.2">v</mi><mi id="S3.E3.m1.2.15.2.3">k</mi></msub><mo id="S3.E3.m1.2.15.3">,</mo><mi id="S3.E3.m1.2.15.4">w</mi><mo stretchy="false" id="S3.E3.m1.2.15.5">)</mo></mrow><mo id="S3.E3.m1.2.16">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle i.e.\quad G_{k}(v_{k},w)=\frac{n_{k}}{n}F_{k}(v_{k})+\lambda R(v_{k},w),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.19" class="ltx_p">where each client hold a personalized model parameterized by <math id="S3.p1.17.m1.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.p1.17.m1.1a"><msub id="S3.p1.17.m1.1.1" xref="S3.p1.17.m1.1.1.cmml"><mi id="S3.p1.17.m1.1.1.2" xref="S3.p1.17.m1.1.1.2.cmml">v</mi><mi id="S3.p1.17.m1.1.1.3" xref="S3.p1.17.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.17.m1.1b"><apply id="S3.p1.17.m1.1.1.cmml" xref="S3.p1.17.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.17.m1.1.1.1.cmml" xref="S3.p1.17.m1.1.1">subscript</csymbol><ci id="S3.p1.17.m1.1.1.2.cmml" xref="S3.p1.17.m1.1.1.2">𝑣</ci><ci id="S3.p1.17.m1.1.1.3.cmml" xref="S3.p1.17.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m1.1c">v_{i}</annotation></semantics></math>, <math id="S3.p1.18.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.p1.18.m2.1a"><mi id="S3.p1.18.m2.1.1" xref="S3.p1.18.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.p1.18.m2.1b"><ci id="S3.p1.18.m2.1.1.cmml" xref="S3.p1.18.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m2.1c">w</annotation></semantics></math> denotes the global model. <math id="S3.p1.19.m3.1" class="ltx_Math" alttext="R(\cdot)" display="inline"><semantics id="S3.p1.19.m3.1a"><mrow id="S3.p1.19.m3.1.2" xref="S3.p1.19.m3.1.2.cmml"><mi id="S3.p1.19.m3.1.2.2" xref="S3.p1.19.m3.1.2.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.p1.19.m3.1.2.1" xref="S3.p1.19.m3.1.2.1.cmml">​</mo><mrow id="S3.p1.19.m3.1.2.3.2" xref="S3.p1.19.m3.1.2.cmml"><mo stretchy="false" id="S3.p1.19.m3.1.2.3.2.1" xref="S3.p1.19.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p1.19.m3.1.1" xref="S3.p1.19.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p1.19.m3.1.2.3.2.2" xref="S3.p1.19.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.19.m3.1b"><apply id="S3.p1.19.m3.1.2.cmml" xref="S3.p1.19.m3.1.2"><times id="S3.p1.19.m3.1.2.1.cmml" xref="S3.p1.19.m3.1.2.1"></times><ci id="S3.p1.19.m3.1.2.2.cmml" xref="S3.p1.19.m3.1.2.2">𝑅</ci><ci id="S3.p1.19.m3.1.1.cmml" xref="S3.p1.19.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m3.1c">R(\cdot)</annotation></semantics></math> is the regularization term to control model update, via avoiding the local model updating be far away to the optimal global model.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Meteorological Prompt Federated Learning</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The framework of <span id="S4.p1.1.1" class="ltx_text ltx_font_italic">MetePFL</span> is depicted in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. In contrast to conventional Federated Learning (FL) where random global parameters are broadcasted to each client, <span id="S4.p1.1.2" class="ltx_text ltx_font_italic">MetePFL</span> employs a fixed FM, thereby reducing computation costs and improving performance without requiring extensive backpropagation. During each round, only the prompt parameters of the clients are taken into consideration. The <span id="S4.p1.1.3" class="ltx_text ltx_font_italic">MetePFL</span> framework consists of the Spatial-Temporal Prompt (STP) and the optimization process.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Spatial-Temporal Prompt</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The Spatial-Temporal Prompt (STP) shown in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 Spatial-Temporal Prompt ‣ 4 Meteorological Prompt Federated Learning ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> can be divided into Temporal prompt learning (TPL) and Spatial prompt learning (SPL).</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2301.09152/assets/FigofSTP.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="275" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Schematic of Spatial-Temporal Prompt Learning.</figcaption>
</figure>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Temporal prompt learning (TPL).</h4>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">To effectively understand the temporal dynamics under multivariate interactions, we use a multi-step incremental learning mechanism for learning the prompt parameters along the time dimension. The TPL comprise four phases, is shown in Figure <a href="#S4.F3" title="Figure 3 ‣ Temporal prompt learning (TPL). ‣ 4.1 Spatial-Temporal Prompt ‣ 4 Meteorological Prompt Federated Learning ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S4.SS1.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p2.8" class="ltx_p">Given a time-series <math id="S4.SS1.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="{\bm{X}}\in\mathbb{R}^{m\times n}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.1.m1.1a"><mrow id="S4.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml">𝑿</mi><mo id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1"><in id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.1"></in><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.2">𝑚</ci><ci id="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.1.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.1.m1.1c">{\bm{X}}\in\mathbb{R}^{m\times n}</annotation></semantics></math>, the <math id="S4.SS1.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.2.m2.1c">m</annotation></semantics></math> and <math id="S4.SS1.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.3.m3.1c">n</annotation></semantics></math> represent the number of time steps and variables, respectively. Define a initial step <math id="S4.SS1.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.4.m4.1a"><mi id="S4.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.4.m4.1b"><ci id="S4.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.4.m4.1c">l</annotation></semantics></math>, the four temporal prompt format: (1) initial prompt <math id="S4.SS1.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="\hat{{\bm{P}}}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.5.m5.1a"><mover accent="true" id="S4.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml">𝑷</mi><mo id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.1" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1"><ci id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.1">^</ci><ci id="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.5.m5.1.1.2">𝑷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.5.m5.1c">\hat{{\bm{P}}}</annotation></semantics></math>; (2) Temporal prompt-I: <math id="S4.SS1.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="{\bm{P}}_{1}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.6.m6.1a"><msub id="S4.SS1.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml">𝑷</mi><mn id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.6.m6.1b"><apply id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.2">𝑷</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.6.m6.1c">{\bm{P}}_{1}</annotation></semantics></math>; (3) Temporal prompt-II: <math id="S4.SS1.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="{\bm{P}}_{2}\in\mathbb{R}^{2l\times n}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.7.m7.1a"><mrow id="S4.SS1.SSS0.Px1.p2.7.m7.1.1" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml"><msub id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.2.cmml">𝑷</mi><mn id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.1" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.cmml"><mrow id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.cmml"><mn id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.2" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.1" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.3.cmml">l</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.7.m7.1b"><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1"><in id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.1"></in><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.2">𝑷</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.2.3">2</cn></apply><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.1"></times><apply id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2"><times id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.1"></times><cn type="integer" id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.2">2</cn><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.2.3">𝑙</ci></apply><ci id="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.7.m7.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.7.m7.1c">{\bm{P}}_{2}\in\mathbb{R}^{2l\times n}</annotation></semantics></math>; (4) Temporal prompt-III: <math id="S4.SS1.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="{\bm{P}}_{3}\in\mathbb{R}^{2l\times n}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p2.8.m8.1a"><mrow id="S4.SS1.SSS0.Px1.p2.8.m8.1.1" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml"><msub id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.2" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.2.cmml">𝑷</mi><mn id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.3" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.3.cmml">3</mn></msub><mo id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.1" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.2" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.cmml"><mrow id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.cmml"><mn id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.2" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.1" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.3" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.3.cmml">l</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p2.8.m8.1b"><apply id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1"><in id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.1"></in><apply id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.2">𝑷</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.2.3">3</cn></apply><apply id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.1"></times><apply id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2"><times id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.1"></times><cn type="integer" id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.2">2</cn><ci id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.3.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.2.3">𝑙</ci></apply><ci id="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p2.8.m8.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p2.8.m8.1c">{\bm{P}}_{3}\in\mathbb{R}^{2l\times n}</annotation></semantics></math>.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2301.09152/assets/x2.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The learning strategy of Temporal Prompt Learning, which consists of four different learning phases.</figcaption>
</figure>
<div id="S4.SS1.SSS0.Px1.p3" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p3.6" class="ltx_p">The first <math id="S4.SS1.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.1.m1.1c">p</annotation></semantics></math> steps are fixed as <math id="S4.SS1.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="Seq\in\mathbb{R}^{p\times n}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.2.m2.1a"><mrow id="S4.SS1.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.cmml"><mrow id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.2" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.1" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.3" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.1a" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.4" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.4.cmml">q</mi></mrow><mo id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.2" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.cmml"><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.2.cmml">p</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1"><in id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.1"></in><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2"><times id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.1"></times><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.2">𝑆</ci><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.3">𝑒</ci><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.4.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.2.4">𝑞</ci></apply><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.1"></times><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.2">𝑝</ci><ci id="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p3.2.m2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.2.m2.1c">Seq\in\mathbb{R}^{p\times n}</annotation></semantics></math>. In addition, the data within the <math id="S4.SS1.SSS0.Px1.p3.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.3.m3.1a"><mi id="S4.SS1.SSS0.Px1.p3.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.3.m3.1b"><ci id="S4.SS1.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.3.m3.1c">p</annotation></semantics></math> to <math id="S4.SS1.SSS0.Px1.p3.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.4.m4.1a"><mi id="S4.SS1.SSS0.Px1.p3.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.4.m4.1b"><ci id="S4.SS1.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.4.m4.1c">k</annotation></semantics></math> steps are spliced with the <math id="S4.SS1.SSS0.Px1.p3.5.m5.1" class="ltx_Math" alttext="\hat{{\bm{P}}}\in\mathbb{R}^{(k-p+l)\times n}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.5.m5.1a"><mrow id="S4.SS1.SSS0.Px1.p3.5.m5.1.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.cmml"><mover accent="true" id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.2.cmml">𝑷</mi><mo id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.1" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.1.cmml">^</mo></mover><mo id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.1" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.1" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.1.cmml">−</mo><mi id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.3.cmml">p</mi></mrow><mo id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.3.cmml">l</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.2.cmml">×</mo><mi id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2"><in id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.1"></in><apply id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2"><ci id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.1">^</ci><ci id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.2.2">𝑷</ci></apply><apply id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.2.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1"><times id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.2"></times><apply id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1"><plus id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.1"></plus><apply id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2"><minus id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.1"></minus><ci id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.2">𝑘</ci><ci id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.5.m5.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.5.m5.1c">\hat{{\bm{P}}}\in\mathbb{R}^{(k-p+l)\times n}</annotation></semantics></math> to generate <math id="S4.SS1.SSS0.Px1.p3.6.m6.1" class="ltx_Math" alttext="{\bm{P}}_{1}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.6.m6.1a"><msub id="S4.SS1.SSS0.Px1.p3.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p3.6.m6.1.1.2" xref="S4.SS1.SSS0.Px1.p3.6.m6.1.1.2.cmml">𝑷</mi><mn id="S4.SS1.SSS0.Px1.p3.6.m6.1.1.3" xref="S4.SS1.SSS0.Px1.p3.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.6.m6.1b"><apply id="S4.SS1.SSS0.Px1.p3.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.6.m6.1.1.2">𝑷</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.6.m6.1c">{\bm{P}}_{1}</annotation></semantics></math> by</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.7" class="ltx_math_unparsed" alttext="\|{\bm{X}}^{(p\sim k)},\hat{{\bm{P}}_{T}}\|\rightarrow{\bm{P}}_{T,1},{\bm{P}}_{T,1}\in\mathbb{R}^{(2k-2p+l)\times n}," display="block"><semantics id="S4.E4.m1.7a"><mrow id="S4.E4.m1.7b"><mo rspace="0.167em" id="S4.E4.m1.7.8">∥</mo><msup id="S4.E4.m1.7.9"><mi id="S4.E4.m1.7.9.2">𝑿</mi><mrow id="S4.E4.m1.1.1.1.1"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.2">(</mo><mrow id="S4.E4.m1.1.1.1.1.1"><mi id="S4.E4.m1.1.1.1.1.1.2">p</mi><mo id="S4.E4.m1.1.1.1.1.1.1">∼</mo><mi id="S4.E4.m1.1.1.1.1.1.3">k</mi></mrow><mo stretchy="false" id="S4.E4.m1.1.1.1.1.3">)</mo></mrow></msup><mo id="S4.E4.m1.7.10">,</mo><mover accent="true" id="S4.E4.m1.7.7"><msub id="S4.E4.m1.7.7.2"><mi id="S4.E4.m1.7.7.2.2">𝑷</mi><mi id="S4.E4.m1.7.7.2.3">T</mi></msub><mo id="S4.E4.m1.7.7.1">^</mo></mover><mo lspace="0em" rspace="0.0835em" id="S4.E4.m1.7.11">∥</mo><mo lspace="0.0835em" stretchy="false" id="S4.E4.m1.7.12">→</mo><msub id="S4.E4.m1.7.13"><mi id="S4.E4.m1.7.13.2">𝑷</mi><mrow id="S4.E4.m1.3.3.2.4"><mi id="S4.E4.m1.2.2.1.1">T</mi><mo id="S4.E4.m1.3.3.2.4.1">,</mo><mn id="S4.E4.m1.3.3.2.2">1</mn></mrow></msub><mo id="S4.E4.m1.7.14">,</mo><msub id="S4.E4.m1.7.15"><mi id="S4.E4.m1.7.15.2">𝑷</mi><mrow id="S4.E4.m1.5.5.2.4"><mi id="S4.E4.m1.4.4.1.1">T</mi><mo id="S4.E4.m1.5.5.2.4.1">,</mo><mn id="S4.E4.m1.5.5.2.2">1</mn></mrow></msub><mo id="S4.E4.m1.7.16">∈</mo><msup id="S4.E4.m1.7.17"><mi id="S4.E4.m1.7.17.2">ℝ</mi><mrow id="S4.E4.m1.6.6.1"><mrow id="S4.E4.m1.6.6.1.1.1"><mo stretchy="false" id="S4.E4.m1.6.6.1.1.1.2">(</mo><mrow id="S4.E4.m1.6.6.1.1.1.1"><mrow id="S4.E4.m1.6.6.1.1.1.1.2"><mrow id="S4.E4.m1.6.6.1.1.1.1.2.2"><mn id="S4.E4.m1.6.6.1.1.1.1.2.2.2">2</mn><mo lspace="0em" rspace="0em" id="S4.E4.m1.6.6.1.1.1.1.2.2.1">​</mo><mi id="S4.E4.m1.6.6.1.1.1.1.2.2.3">k</mi></mrow><mo id="S4.E4.m1.6.6.1.1.1.1.2.1">−</mo><mrow id="S4.E4.m1.6.6.1.1.1.1.2.3"><mn id="S4.E4.m1.6.6.1.1.1.1.2.3.2">2</mn><mo lspace="0em" rspace="0em" id="S4.E4.m1.6.6.1.1.1.1.2.3.1">​</mo><mi id="S4.E4.m1.6.6.1.1.1.1.2.3.3">p</mi></mrow></mrow><mo id="S4.E4.m1.6.6.1.1.1.1.1">+</mo><mi id="S4.E4.m1.6.6.1.1.1.1.3">l</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.E4.m1.6.6.1.1.1.3">)</mo></mrow><mo rspace="0.222em" id="S4.E4.m1.6.6.1.2">×</mo><mi id="S4.E4.m1.6.6.1.3">n</mi></mrow></msup><mo id="S4.E4.m1.7.18">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E4.m1.7c">\|{\bm{X}}^{(p\sim k)},\hat{{\bm{P}}_{T}}\|\rightarrow{\bm{P}}_{T,1},{\bm{P}}_{T,1}\in\mathbb{R}^{(2k-2p+l)\times n},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS0.Px1.p3.11" class="ltx_p">where <math id="S4.SS1.SSS0.Px1.p3.7.m1.1" class="ltx_math_unparsed" alttext="\|\|" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.7.m1.1a"><mrow id="S4.SS1.SSS0.Px1.p3.7.m1.1b"><mo rspace="0.0835em" id="S4.SS1.SSS0.Px1.p3.7.m1.1.1">∥</mo><mo lspace="0.0835em" id="S4.SS1.SSS0.Px1.p3.7.m1.1.2">∥</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.7.m1.1c">\|\|</annotation></semantics></math> denote the <span id="S4.SS1.SSS0.Px1.p3.11.1" class="ltx_text ltx_font_italic">concat</span> operation.
To enhance the accuracy of forecasting performance, we adopt a two-stage objective in the initial learning phase: ”<math id="S4.SS1.SSS0.Px1.p3.8.m2.3" class="ltx_Math" alttext="{\bm{X}}^{(0\sim p)}\stackrel{{\scriptstyle 1}}{{\longrightarrow}}{\bm{X}}^{(0\sim k)}\stackrel{{\scriptstyle 2}}{{\longrightarrow}}{\bm{X}}^{(0\sim k+l)}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.8.m2.3a"><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.3.4" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.cmml"><msup id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.1.cmml">∼</mo><mi id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><mover id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.2.cmml">⟶</mo><mn id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.3.cmml">1</mn></mover><msup id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.cmml"><mi id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.1.cmml">∼</mo><mi id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.cmml">)</mo></mrow></msup><mover id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.2.cmml">⟶</mo><mn id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.3.cmml">2</mn></mover><msup id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6.cmml"><mi id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.3.cmml">l</mi></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.3" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.8.m2.3b"><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4"><and id="S4.SS1.SSS0.Px1.p3.8.m2.3.4a.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4"></and><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4b.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4"><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.2">⟶</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.3.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.3.3">1</cn></apply><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.2.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.2">0</cn><ci id="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.1.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.2">0</cn><ci id="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.2.2.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4c.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4"><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.2">⟶</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.3.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.5.3">2</cn></apply><share href="#S4.SS1.SSS0.Px1.p3.8.m2.3.4.4.cmml" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4d.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4"></share><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.4.6.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.2">0</cn><apply id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.2">𝑘</ci><ci id="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p3.8.m2.3.3.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.8.m2.3c">{\bm{X}}^{(0\sim p)}\stackrel{{\scriptstyle 1}}{{\longrightarrow}}{\bm{X}}^{(0\sim k)}\stackrel{{\scriptstyle 2}}{{\longrightarrow}}{\bm{X}}^{(0\sim k+l)}</annotation></semantics></math>”. During this phase, we encourage the FM to enhance prompt parameters associated with prior knowledge in <math id="S4.SS1.SSS0.Px1.p3.9.m3.1" class="ltx_Math" alttext="{\bm{X}}^{(p\sim k)}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.9.m3.1a"><msup id="S4.SS1.SSS0.Px1.p3.9.m3.1.2" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.9.m3.1.2.2" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.2.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.2.cmml">p</mi><mo id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.1.cmml">∼</mo><mi id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.9.m3.1b"><apply id="S4.SS1.SSS0.Px1.p3.9.m3.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.9.m3.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.9.m3.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.2.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.1">similar-to</csymbol><ci id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.2">𝑝</ci><ci id="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.9.m3.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.9.m3.1c">{\bm{X}}^{(p\sim k)}</annotation></semantics></math> in order to establish a foundation for the subsequent stage. In the next stage, the FM learns the remaining <math id="S4.SS1.SSS0.Px1.p3.10.m4.2" class="ltx_Math" alttext="{\bm{P}}_{T,1}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.10.m4.2a"><msub id="S4.SS1.SSS0.Px1.p3.10.m4.2.3" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p3.10.m4.2.3.2" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.3.2.cmml">𝑷</mi><mrow id="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.4" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p3.10.m4.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.10.m4.1.1.1.1.cmml">T</mi><mo id="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.4.1" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.3.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.2" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.10.m4.2b"><apply id="S4.SS1.SSS0.Px1.p3.10.m4.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.10.m4.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.10.m4.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.3.2">𝑷</ci><list id="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.4"><ci id="S4.SS1.SSS0.Px1.p3.10.m4.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.10.m4.1.1.1.1">𝑇</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.10.m4.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.10.m4.2c">{\bm{P}}_{T,1}</annotation></semantics></math> parameters in <math id="S4.SS1.SSS0.Px1.p3.11.m5.1" class="ltx_Math" alttext="{\bm{X}}^{(k\sim k+l)}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.11.m5.1a"><msup id="S4.SS1.SSS0.Px1.p3.11.m5.1.2" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.11.m5.1.2.2" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.2.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.3.cmml">l</mi></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.11.m5.1b"><apply id="S4.SS1.SSS0.Px1.p3.11.m5.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p3.11.m5.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p3.11.m5.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.2.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.1">similar-to</csymbol><ci id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.2">𝑘</ci><apply id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.2">𝑘</ci><ci id="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p3.11.m5.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.11.m5.1c">{\bm{X}}^{(k\sim k+l)}</annotation></semantics></math>. This approach enables the FM to develop a comprehensive understanding of the relationships among variables across different time periods, rather than establishing rigid back-and-forth associations. The formulation of the initial learning phase is:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.4" class="ltx_Math" alttext="{\bm{R}}_{1}=\operatorname*{FM}([Seq,embed({\bm{P}}_{T,1})])," display="block"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml"><msub id="S4.E5.m1.4.4.1.1.3" xref="S4.E5.m1.4.4.1.1.3.cmml"><mi id="S4.E5.m1.4.4.1.1.3.2" xref="S4.E5.m1.4.4.1.1.3.2.cmml">𝑹</mi><mn id="S4.E5.m1.4.4.1.1.3.3" xref="S4.E5.m1.4.4.1.1.3.3.cmml">1</mn></msub><mo rspace="0.1389em" id="S4.E5.m1.4.4.1.1.2" xref="S4.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.4.4.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.2.cmml"><mo lspace="0.1389em" rspace="0em" id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">FM</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.3.cmml">[</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1a" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.4.cmml">q</mi></mrow><mo id="S4.E5.m1.4.4.1.1.1.1.1.1.2.4" xref="S4.E5.m1.4.4.1.1.1.1.1.1.3.cmml">,</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">​</mo><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.4" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2a" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">​</mo><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.5" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2b" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">​</mo><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.6" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2c" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">​</mo><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.7" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.7.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2d" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">​</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2.cmml">𝑷</mi><mrow id="S4.E5.m1.2.2.2.4" xref="S4.E5.m1.2.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">T</mi><mo id="S4.E5.m1.2.2.2.4.1" xref="S4.E5.m1.2.2.2.3.cmml">,</mo><mn id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.5" xref="S4.E5.m1.4.4.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S4.E5.m1.4.4.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1"><eq id="S4.E5.m1.4.4.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2"></eq><apply id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.3">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2">𝑹</ci><cn type="integer" id="S4.E5.m1.4.4.1.1.3.3.cmml" xref="S4.E5.m1.4.4.1.1.3.3">1</cn></apply><apply id="S4.E5.m1.4.4.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1"><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">FM</ci><interval closure="closed" id="S4.E5.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2"><apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.4">𝑞</ci></apply><apply id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2"><times id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.2"></times><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.3">𝑒</ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.4.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.4">𝑚</ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.5.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.5">𝑏</ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.6.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.6">𝑒</ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.7.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.7">𝑑</ci><apply id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.2.2.1.1.1.2">𝑷</ci><list id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.4"><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝑇</ci><cn type="integer" id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2">1</cn></list></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">{\bm{R}}_{1}=\operatorname*{FM}([Seq,embed({\bm{P}}_{T,1})]),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS0.Px1.p3.13" class="ltx_p">where the <math id="S4.SS1.SSS0.Px1.p3.12.m1.1" class="ltx_Math" alttext="embed(x)" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.12.m1.1a"><mrow id="S4.SS1.SSS0.Px1.p3.12.m1.1.2" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.2" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.3" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1a" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.4" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1b" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.5" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1c" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.6" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1d" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.7.2" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.7.2.1" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.cmml">(</mo><mi id="S4.SS1.SSS0.Px1.p3.12.m1.1.1" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.7.2.2" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.12.m1.1b"><apply id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2"><times id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.1"></times><ci id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.2">𝑒</ci><ci id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.3">𝑚</ci><ci id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.4.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.4">𝑏</ci><ci id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.5.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.5">𝑒</ci><ci id="S4.SS1.SSS0.Px1.p3.12.m1.1.2.6.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.2.6">𝑑</ci><ci id="S4.SS1.SSS0.Px1.p3.12.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.12.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.12.m1.1c">embed(x)</annotation></semantics></math> represents the learnable position encoder, and the <math id="S4.SS1.SSS0.Px1.p3.13.m2.1" class="ltx_Math" alttext="\operatorname*{FM}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p3.13.m2.1a"><mo id="S4.SS1.SSS0.Px1.p3.13.m2.1.1" xref="S4.SS1.SSS0.Px1.p3.13.m2.1.1.cmml">FM</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p3.13.m2.1b"><ci id="S4.SS1.SSS0.Px1.p3.13.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p3.13.m2.1.1">FM</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p3.13.m2.1c">\operatorname*{FM}</annotation></semantics></math> is the pre-trained foundation model.</p>
</div>
<div id="S4.SS1.SSS0.Px1.p4" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p4.6" class="ltx_p">Splicing discrete prompts to form a complete series is challenging because their parameters cannot match the FM simultaneously. To establish the relationship between two prompts, a dual-correct strategy is adopted in the second learning phase. This strategy encourages the FM to correct <math id="S4.SS1.SSS0.Px1.p4.1.m1.2" class="ltx_Math" alttext="{\bm{P}}_{T,1}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.1.m1.2a"><msub id="S4.SS1.SSS0.Px1.p4.1.m1.2.3" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.2.3.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.3.2.cmml">𝑷</mi><mrow id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.4" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml">T</mi><mo id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.4.1" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.1.m1.2b"><apply id="S4.SS1.SSS0.Px1.p4.1.m1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.1.m1.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.1.m1.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.3.2">𝑷</ci><list id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.4"><ci id="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.1.1.1.1">𝑇</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.1.m1.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.1.m1.2c">{\bm{P}}_{T,1}</annotation></semantics></math> based on the previous <math id="S4.SS1.SSS0.Px1.p4.2.m2.2" class="ltx_Math" alttext="{\bm{P}}_{T,1}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.2.m2.2a"><msub id="S4.SS1.SSS0.Px1.p4.2.m2.2.3" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.2.m2.2.3.2" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.3.2.cmml">𝑷</mi><mrow id="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.4" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.2.m2.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1.1.1.cmml">T</mi><mo id="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.4.1" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.3.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.2.m2.2b"><apply id="S4.SS1.SSS0.Px1.p4.2.m2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.2.m2.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.2.m2.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.3.2">𝑷</ci><list id="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.4"><ci id="S4.SS1.SSS0.Px1.p4.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.1.1.1.1">𝑇</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.2.m2.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.2.m2.2c">{\bm{P}}_{T,1}</annotation></semantics></math> while learning <math id="S4.SS1.SSS0.Px1.p4.3.m3.2" class="ltx_Math" alttext="{\bm{P}}_{T,2}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.3.m3.2a"><msub id="S4.SS1.SSS0.Px1.p4.3.m3.2.3" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.3.m3.2.3.2" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.3.2.cmml">𝑷</mi><mrow id="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.4" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.3.m3.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1.1.1.cmml">T</mi><mo id="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.4.1" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.3.cmml">,</mo><mn id="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.2" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.2.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.3.m3.2b"><apply id="S4.SS1.SSS0.Px1.p4.3.m3.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.3.m3.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.3.m3.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.3.2">𝑷</ci><list id="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.4"><ci id="S4.SS1.SSS0.Px1.p4.3.m3.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.1.1.1.1">𝑇</ci><cn type="integer" id="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.3.m3.2.2.2.2">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.3.m3.2c">{\bm{P}}_{T,2}</annotation></semantics></math>. The objectives of the second learning phase are ”<math id="S4.SS1.SSS0.Px1.p4.4.m4.2" class="ltx_Math" alttext="{\bm{X}}^{(0\sim k+l)}\longrightarrow{\bm{X}}^{(0\sim k+3l)}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.4.m4.2a"><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.2.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.cmml"><msup id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.3.cmml">l</mi></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.1.cmml">⟶</mo><msup id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.1.cmml">+</mo><mrow id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.cmml"><mn id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.3.cmml">l</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.3" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.4.m4.2b"><apply id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3"><ci id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.1">⟶</ci><apply id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.2.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.2">0</cn><apply id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.2">𝑘</ci><ci id="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.3.3.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.2">0</cn><apply id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.2">𝑘</ci><apply id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.2">3</cn><ci id="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.4.m4.2.2.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.4.m4.2c">{\bm{X}}^{(0\sim k+l)}\longrightarrow{\bm{X}}^{(0\sim k+3l)}</annotation></semantics></math>.” This process can be formulated as mapping the input data from <math id="S4.SS1.SSS0.Px1.p4.5.m5.1" class="ltx_Math" alttext="{\bm{X}}^{(0\sim k+l)}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.5.m5.1a"><msup id="S4.SS1.SSS0.Px1.p4.5.m5.1.2" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p4.5.m5.1.2.2" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.2.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.1.cmml">+</mo><mi id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.3.cmml">l</mi></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p4.5.m5.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.5.m5.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.5.m5.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.2.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.2">0</cn><apply id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.2">𝑘</ci><ci id="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.5.m5.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.5.m5.1c">{\bm{X}}^{(0\sim k+l)}</annotation></semantics></math> to <math id="S4.SS1.SSS0.Px1.p4.6.m6.1" class="ltx_Math" alttext="{\bm{X}}^{(0\sim k+3l)}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p4.6.m6.1a"><msup id="S4.SS1.SSS0.Px1.p4.6.m6.1.2" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p4.6.m6.1.2.2" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.2.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.cmml"><mn id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.3.cmml">l</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p4.6.m6.1b"><apply id="S4.SS1.SSS0.Px1.p4.6.m6.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p4.6.m6.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p4.6.m6.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.2.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.2">0</cn><apply id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.2">𝑘</ci><apply id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.2">3</cn><ci id="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p4.6.m6.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p4.6.m6.1c">{\bm{X}}^{(0\sim k+3l)}</annotation></semantics></math> during the second phase.
<span id="S4.SS1.SSS0.Px1.p4.6.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6.m1.8" class="ltx_math_unparsed" alttext="\displaystyle\|{\bm{P}}_{T,1},{\bm{P}}_{T,2}\|\rightarrow{\bm{P}}_{T,2},{\bm{P}}_{T,2}\in\mathbb{R}^{3l\times n}," display="inline"><semantics id="S4.E6.m1.8a"><mrow id="S4.E6.m1.8b"><mo mathsize="90%" rspace="0.167em" id="S4.E6.m1.8.9">∥</mo><msub id="S4.E6.m1.8.10"><mi mathsize="90%" id="S4.E6.m1.8.10.2">𝑷</mi><mrow id="S4.E6.m1.2.2.2.4"><mi mathsize="90%" id="S4.E6.m1.1.1.1.1">T</mi><mo mathsize="90%" id="S4.E6.m1.2.2.2.4.1">,</mo><mn mathsize="90%" id="S4.E6.m1.2.2.2.2">1</mn></mrow></msub><mo mathsize="90%" id="S4.E6.m1.8.11">,</mo><msub id="S4.E6.m1.8.12"><mi mathsize="90%" id="S4.E6.m1.8.12.2">𝑷</mi><mrow id="S4.E6.m1.4.4.2.4"><mi mathsize="90%" id="S4.E6.m1.3.3.1.1">T</mi><mo mathsize="90%" id="S4.E6.m1.4.4.2.4.1">,</mo><mn mathsize="90%" id="S4.E6.m1.4.4.2.2">2</mn></mrow></msub><mo lspace="0em" mathsize="90%" rspace="0.0835em" id="S4.E6.m1.8.13">∥</mo><mo lspace="0.0835em" mathsize="90%" stretchy="false" id="S4.E6.m1.8.14">→</mo><msub id="S4.E6.m1.8.15"><mi mathsize="90%" id="S4.E6.m1.8.15.2">𝑷</mi><mrow id="S4.E6.m1.6.6.2.4"><mi mathsize="90%" id="S4.E6.m1.5.5.1.1">T</mi><mo mathsize="90%" id="S4.E6.m1.6.6.2.4.1">,</mo><mn mathsize="90%" id="S4.E6.m1.6.6.2.2">2</mn></mrow></msub><mo mathsize="90%" id="S4.E6.m1.8.16">,</mo><msub id="S4.E6.m1.8.17"><mi mathsize="90%" id="S4.E6.m1.8.17.2">𝑷</mi><mrow id="S4.E6.m1.8.8.2.4"><mi mathsize="90%" id="S4.E6.m1.7.7.1.1">T</mi><mo mathsize="90%" id="S4.E6.m1.8.8.2.4.1">,</mo><mn mathsize="90%" id="S4.E6.m1.8.8.2.2">2</mn></mrow></msub><mo mathsize="90%" id="S4.E6.m1.8.18">∈</mo><msup id="S4.E6.m1.8.19"><mi mathsize="90%" id="S4.E6.m1.8.19.2">ℝ</mi><mrow id="S4.E6.m1.8.19.3"><mrow id="S4.E6.m1.8.19.3.2"><mn mathsize="90%" id="S4.E6.m1.8.19.3.2.2">3</mn><mo lspace="0em" rspace="0em" id="S4.E6.m1.8.19.3.2.1">​</mo><mi mathsize="90%" id="S4.E6.m1.8.19.3.2.3">l</mi></mrow><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S4.E6.m1.8.19.3.1">×</mo><mi mathsize="90%" id="S4.E6.m1.8.19.3.3">n</mi></mrow></msup><mo mathsize="90%" id="S4.E6.m1.8.20">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E6.m1.8c">\displaystyle\|{\bm{P}}_{T,1},{\bm{P}}_{T,2}\|\rightarrow{\bm{P}}_{T,2},{\bm{P}}_{T,2}\in\mathbb{R}^{3l\times n},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex2.m1.2" class="ltx_math_unparsed" alttext="\displaystyle{\bm{R}}_{2}=\operatorname*{FM}(\|Seq_{2},{\bm{R}}^{p/2\sim p}_{1},embed({\bm{R}}^{p\sim p+l}_{1}),embed({\bm{P}}_{T,2})\|)." display="inline"><semantics id="S4.Ex2.m1.2a"><mrow id="S4.Ex2.m1.2b"><msub id="S4.Ex2.m1.2.3"><mi mathsize="90%" id="S4.Ex2.m1.2.3.2">𝑹</mi><mn mathsize="90%" id="S4.Ex2.m1.2.3.3">2</mn></msub><mo mathsize="90%" rspace="0.1389em" id="S4.Ex2.m1.2.4">=</mo><mo lspace="0.1389em" mathsize="90%" rspace="0em" id="S4.Ex2.m1.2.5">FM</mo><mrow id="S4.Ex2.m1.2.6"><mo maxsize="90%" minsize="90%" id="S4.Ex2.m1.2.6.1">(</mo><mo lspace="0em" mathsize="90%" rspace="0.167em" id="S4.Ex2.m1.2.6.2">∥</mo><mi mathsize="90%" id="S4.Ex2.m1.2.6.3">S</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.4">e</mi><msub id="S4.Ex2.m1.2.6.5"><mi mathsize="90%" id="S4.Ex2.m1.2.6.5.2">q</mi><mn mathsize="90%" id="S4.Ex2.m1.2.6.5.3">2</mn></msub><mo mathsize="90%" id="S4.Ex2.m1.2.6.6">,</mo><msubsup id="S4.Ex2.m1.2.6.7"><mi mathsize="90%" id="S4.Ex2.m1.2.6.7.2.2">𝑹</mi><mn mathsize="90%" id="S4.Ex2.m1.2.6.7.3">1</mn><mrow id="S4.Ex2.m1.2.6.7.2.3"><mrow id="S4.Ex2.m1.2.6.7.2.3.2"><mi mathsize="90%" id="S4.Ex2.m1.2.6.7.2.3.2.2">p</mi><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S4.Ex2.m1.2.6.7.2.3.2.1">/</mo><mn mathsize="90%" id="S4.Ex2.m1.2.6.7.2.3.2.3">2</mn></mrow><mo mathsize="90%" id="S4.Ex2.m1.2.6.7.2.3.1">∼</mo><mi mathsize="90%" id="S4.Ex2.m1.2.6.7.2.3.3">p</mi></mrow></msubsup><mo mathsize="90%" id="S4.Ex2.m1.2.6.8">,</mo><mi mathsize="90%" id="S4.Ex2.m1.2.6.9">e</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.10">m</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.11">b</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.12">e</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.13">d</mi><mrow id="S4.Ex2.m1.2.6.14"><mo maxsize="90%" minsize="90%" id="S4.Ex2.m1.2.6.14.1">(</mo><msubsup id="S4.Ex2.m1.2.6.14.2"><mi mathsize="90%" id="S4.Ex2.m1.2.6.14.2.2.2">𝑹</mi><mn mathsize="90%" id="S4.Ex2.m1.2.6.14.2.3">1</mn><mrow id="S4.Ex2.m1.2.6.14.2.2.3"><mi mathsize="90%" id="S4.Ex2.m1.2.6.14.2.2.3.2">p</mi><mo mathsize="90%" id="S4.Ex2.m1.2.6.14.2.2.3.1">∼</mo><mrow id="S4.Ex2.m1.2.6.14.2.2.3.3"><mi mathsize="90%" id="S4.Ex2.m1.2.6.14.2.2.3.3.2">p</mi><mo mathsize="90%" id="S4.Ex2.m1.2.6.14.2.2.3.3.1">+</mo><mi mathsize="90%" id="S4.Ex2.m1.2.6.14.2.2.3.3.3">l</mi></mrow></mrow></msubsup><mo maxsize="90%" minsize="90%" id="S4.Ex2.m1.2.6.14.3">)</mo></mrow><mo mathsize="90%" id="S4.Ex2.m1.2.6.15">,</mo><mi mathsize="90%" id="S4.Ex2.m1.2.6.16">e</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.17">m</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.18">b</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.19">e</mi><mi mathsize="90%" id="S4.Ex2.m1.2.6.20">d</mi><mrow id="S4.Ex2.m1.2.6.21"><mo maxsize="90%" minsize="90%" id="S4.Ex2.m1.2.6.21.1">(</mo><msub id="S4.Ex2.m1.2.6.21.2"><mi mathsize="90%" id="S4.Ex2.m1.2.6.21.2.2">𝑷</mi><mrow id="S4.Ex2.m1.2.2.2.4"><mi mathsize="90%" id="S4.Ex2.m1.1.1.1.1">T</mi><mo mathsize="90%" id="S4.Ex2.m1.2.2.2.4.1">,</mo><mn mathsize="90%" id="S4.Ex2.m1.2.2.2.2">2</mn></mrow></msub><mo maxsize="90%" minsize="90%" id="S4.Ex2.m1.2.6.21.3">)</mo></mrow><mo lspace="0em" mathsize="90%" rspace="0.167em" id="S4.Ex2.m1.2.6.22">∥</mo><mo maxsize="90%" minsize="90%" id="S4.Ex2.m1.2.6.23">)</mo></mrow><mo lspace="0em" mathsize="90%" id="S4.Ex2.m1.2.7">.</mo></mrow><annotation encoding="application/x-tex" id="S4.Ex2.m1.2c">\displaystyle{\bm{R}}_{2}=\operatorname*{FM}(\|Seq_{2},{\bm{R}}^{p/2\sim p}_{1},embed({\bm{R}}^{p\sim p+l}_{1}),embed({\bm{P}}_{T,2})\|).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.SSS0.Px1.p5" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p5.1" class="ltx_p">The objective of the third learning phase can be expressed as “<math id="S4.SS1.SSS0.Px1.p5.1.m1.2" class="ltx_Math" alttext="{\bm{X}}^{(0\sim k+3l)}\longrightarrow{\bm{X}}^{(0\sim k+5l)}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p5.1.m1.2a"><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.2.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.cmml"><msup id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2.cmml"><mi id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.cmml"><mn id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.3.cmml">l</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.1.cmml">⟶</mo><msup id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3.cmml"><mi id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3.2.cmml">𝑿</mi><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.1.cmml">∼</mo><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.1.cmml">+</mo><mrow id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.cmml"><mn id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.2" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.1" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.3.cmml">l</mi></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.3" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p5.1.m1.2b"><apply id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3"><ci id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.1">⟶</ci><apply id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.2.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.2">0</cn><apply id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.2">𝑘</ci><apply id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.2">3</cn><ci id="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply><apply id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.3.3.2">𝑿</ci><apply id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.1">similar-to</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.2">0</cn><apply id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3"><plus id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.1"></plus><ci id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.2">𝑘</ci><apply id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3"><times id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.1"></times><cn type="integer" id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.2">5</cn><ci id="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px1.p5.1.m1.2.2.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p5.1.m1.2c">{\bm{X}}^{(0\sim k+3l)}\longrightarrow{\bm{X}}^{(0\sim k+5l)}</annotation></semantics></math>”, for further correcting these previously learned prompts to improving the continuity of several prompts and providing smooth transitions between them. The third learning phase can be formulated as:
<span id="S4.SS1.SSS0.Px1.p5.1.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E7.m1.8" class="ltx_math_unparsed" alttext="\displaystyle\|{\bm{P}}_{T,2},{\bm{P}}_{T,3}\|\rightarrow{\bm{P}}_{T,3},{\bm{P}}_{T,3}\in\mathbb{R}^{4l\times n}," display="inline"><semantics id="S4.E7.m1.8a"><mrow id="S4.E7.m1.8b"><mo mathsize="90%" rspace="0.167em" id="S4.E7.m1.8.9">∥</mo><msub id="S4.E7.m1.8.10"><mi mathsize="90%" id="S4.E7.m1.8.10.2">𝑷</mi><mrow id="S4.E7.m1.2.2.2.4"><mi mathsize="90%" id="S4.E7.m1.1.1.1.1">T</mi><mo mathsize="90%" id="S4.E7.m1.2.2.2.4.1">,</mo><mn mathsize="90%" id="S4.E7.m1.2.2.2.2">2</mn></mrow></msub><mo mathsize="90%" id="S4.E7.m1.8.11">,</mo><msub id="S4.E7.m1.8.12"><mi mathsize="90%" id="S4.E7.m1.8.12.2">𝑷</mi><mrow id="S4.E7.m1.4.4.2.4"><mi mathsize="90%" id="S4.E7.m1.3.3.1.1">T</mi><mo mathsize="90%" id="S4.E7.m1.4.4.2.4.1">,</mo><mn mathsize="90%" id="S4.E7.m1.4.4.2.2">3</mn></mrow></msub><mo lspace="0em" mathsize="90%" rspace="0.0835em" id="S4.E7.m1.8.13">∥</mo><mo lspace="0.0835em" mathsize="90%" stretchy="false" id="S4.E7.m1.8.14">→</mo><msub id="S4.E7.m1.8.15"><mi mathsize="90%" id="S4.E7.m1.8.15.2">𝑷</mi><mrow id="S4.E7.m1.6.6.2.4"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1">T</mi><mo mathsize="90%" id="S4.E7.m1.6.6.2.4.1">,</mo><mn mathsize="90%" id="S4.E7.m1.6.6.2.2">3</mn></mrow></msub><mo mathsize="90%" id="S4.E7.m1.8.16">,</mo><msub id="S4.E7.m1.8.17"><mi mathsize="90%" id="S4.E7.m1.8.17.2">𝑷</mi><mrow id="S4.E7.m1.8.8.2.4"><mi mathsize="90%" id="S4.E7.m1.7.7.1.1">T</mi><mo mathsize="90%" id="S4.E7.m1.8.8.2.4.1">,</mo><mn mathsize="90%" id="S4.E7.m1.8.8.2.2">3</mn></mrow></msub><mo mathsize="90%" id="S4.E7.m1.8.18">∈</mo><msup id="S4.E7.m1.8.19"><mi mathsize="90%" id="S4.E7.m1.8.19.2">ℝ</mi><mrow id="S4.E7.m1.8.19.3"><mrow id="S4.E7.m1.8.19.3.2"><mn mathsize="90%" id="S4.E7.m1.8.19.3.2.2">4</mn><mo lspace="0em" rspace="0em" id="S4.E7.m1.8.19.3.2.1">​</mo><mi mathsize="90%" id="S4.E7.m1.8.19.3.2.3">l</mi></mrow><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S4.E7.m1.8.19.3.1">×</mo><mi mathsize="90%" id="S4.E7.m1.8.19.3.3">n</mi></mrow></msup><mo mathsize="90%" id="S4.E7.m1.8.20">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E7.m1.8c">\displaystyle\|{\bm{P}}_{T,2},{\bm{P}}_{T,3}\|\rightarrow{\bm{P}}_{T,3},{\bm{P}}_{T,3}\in\mathbb{R}^{4l\times n},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex3.m1.5" class="ltx_math_unparsed" alttext="\displaystyle{\bm{R}}_{3}=\operatorname*{FM}(\|Seq_{3},\hat{{\bm{P}}}*{\bm{R}}^{p\sim(p+l)}_{2},embed({\bm{P}}_{T,2}),embed({\bm{P}}_{T,3})\|)." display="inline"><semantics id="S4.Ex3.m1.5a"><mrow id="S4.Ex3.m1.5b"><msub id="S4.Ex3.m1.5.6"><mi mathsize="90%" id="S4.Ex3.m1.5.6.2">𝑹</mi><mn mathsize="90%" id="S4.Ex3.m1.5.6.3">3</mn></msub><mo mathsize="90%" rspace="0.1389em" id="S4.Ex3.m1.5.7">=</mo><mo lspace="0.1389em" mathsize="90%" rspace="0em" id="S4.Ex3.m1.5.8">FM</mo><mrow id="S4.Ex3.m1.5.9"><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.5.9.1">(</mo><mo lspace="0em" mathsize="90%" rspace="0.167em" id="S4.Ex3.m1.5.9.2">∥</mo><mi mathsize="90%" id="S4.Ex3.m1.5.9.3">S</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.4">e</mi><msub id="S4.Ex3.m1.5.9.5"><mi mathsize="90%" id="S4.Ex3.m1.5.9.5.2">q</mi><mn mathsize="90%" id="S4.Ex3.m1.5.9.5.3">3</mn></msub><mo mathsize="90%" id="S4.Ex3.m1.5.9.6">,</mo><mover accent="true" id="S4.Ex3.m1.5.9.7"><mi mathsize="90%" id="S4.Ex3.m1.5.9.7.2">𝑷</mi><mo mathsize="90%" id="S4.Ex3.m1.5.9.7.1">^</mo></mover><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S4.Ex3.m1.5.9.8">∗</mo><msubsup id="S4.Ex3.m1.5.9.9"><mi mathsize="90%" id="S4.Ex3.m1.5.9.9.2.2">𝑹</mi><mn mathsize="90%" id="S4.Ex3.m1.5.9.9.3">2</mn><mrow id="S4.Ex3.m1.1.1.1"><mi mathsize="90%" id="S4.Ex3.m1.1.1.1.3">p</mi><mo mathsize="90%" id="S4.Ex3.m1.1.1.1.2">∼</mo><mrow id="S4.Ex3.m1.1.1.1.1.1"><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.1.1.1.1.1.2">(</mo><mrow id="S4.Ex3.m1.1.1.1.1.1.1"><mi mathsize="90%" id="S4.Ex3.m1.1.1.1.1.1.1.2">p</mi><mo mathsize="90%" id="S4.Ex3.m1.1.1.1.1.1.1.1">+</mo><mi mathsize="90%" id="S4.Ex3.m1.1.1.1.1.1.1.3">l</mi></mrow><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.1.1.1.1.1.3">)</mo></mrow></mrow></msubsup><mo mathsize="90%" id="S4.Ex3.m1.5.9.10">,</mo><mi mathsize="90%" id="S4.Ex3.m1.5.9.11">e</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.12">m</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.13">b</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.14">e</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.15">d</mi><mrow id="S4.Ex3.m1.5.9.16"><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.5.9.16.1">(</mo><msub id="S4.Ex3.m1.5.9.16.2"><mi mathsize="90%" id="S4.Ex3.m1.5.9.16.2.2">𝑷</mi><mrow id="S4.Ex3.m1.3.3.2.4"><mi mathsize="90%" id="S4.Ex3.m1.2.2.1.1">T</mi><mo mathsize="90%" id="S4.Ex3.m1.3.3.2.4.1">,</mo><mn mathsize="90%" id="S4.Ex3.m1.3.3.2.2">2</mn></mrow></msub><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.5.9.16.3">)</mo></mrow><mo mathsize="90%" id="S4.Ex3.m1.5.9.17">,</mo><mi mathsize="90%" id="S4.Ex3.m1.5.9.18">e</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.19">m</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.20">b</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.21">e</mi><mi mathsize="90%" id="S4.Ex3.m1.5.9.22">d</mi><mrow id="S4.Ex3.m1.5.9.23"><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.5.9.23.1">(</mo><msub id="S4.Ex3.m1.5.9.23.2"><mi mathsize="90%" id="S4.Ex3.m1.5.9.23.2.2">𝑷</mi><mrow id="S4.Ex3.m1.5.5.2.4"><mi mathsize="90%" id="S4.Ex3.m1.4.4.1.1">T</mi><mo mathsize="90%" id="S4.Ex3.m1.5.5.2.4.1">,</mo><mn mathsize="90%" id="S4.Ex3.m1.5.5.2.2">3</mn></mrow></msub><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.5.9.23.3">)</mo></mrow><mo lspace="0em" mathsize="90%" rspace="0.167em" id="S4.Ex3.m1.5.9.24">∥</mo><mo maxsize="90%" minsize="90%" id="S4.Ex3.m1.5.9.25">)</mo></mrow><mo lspace="0em" mathsize="90%" id="S4.Ex3.m1.5.10">.</mo></mrow><annotation encoding="application/x-tex" id="S4.Ex3.m1.5c">\displaystyle{\bm{R}}_{3}=\operatorname*{FM}(\|Seq_{3},\hat{{\bm{P}}}*{\bm{R}}^{p\sim(p+l)}_{2},embed({\bm{P}}_{T,2}),embed({\bm{P}}_{T,3})\|).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS1.SSS0.Px1.p6" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p6.1" class="ltx_p">To prevent the prompt parameters from being overly biased toward expressing short-term over long-term dependence, the final stage of learning intends to uniformly adjust these parameters. The corresponding values from the three previous learning phases are concatenated along the time dimension and then multiplied by the uniform prompt <math id="S4.SS1.SSS0.Px1.p6.1.m1.2" class="ltx_Math" alttext="{\bm{P}}_{T,w}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p6.1.m1.2a"><msub id="S4.SS1.SSS0.Px1.p6.1.m1.2.3" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p6.1.m1.2.3.2" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.3.2.cmml">𝑷</mi><mrow id="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.4" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.SSS0.Px1.p6.1.m1.1.1.1.1" xref="S4.SS1.SSS0.Px1.p6.1.m1.1.1.1.1.cmml">T</mi><mo id="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.4.1" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.2" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.2.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p6.1.m1.2b"><apply id="S4.SS1.SSS0.Px1.p6.1.m1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p6.1.m1.2.3.1.cmml" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p6.1.m1.2.3.2.cmml" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.3.2">𝑷</ci><list id="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.4"><ci id="S4.SS1.SSS0.Px1.p6.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p6.1.m1.1.1.1.1">𝑇</ci><ci id="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS0.Px1.p6.1.m1.2.2.2.2">𝑤</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p6.1.m1.2c">{\bm{P}}_{T,w}</annotation></semantics></math>. The final learning can be expressed as follows.</p>
<table id="S6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex4.m1.8" class="ltx_math_unparsed" alttext="\displaystyle\|{\bm{P}}_{T,1},{\bm{P}}_{T,2},{\bm{P}}_{T,3}\|\rightarrow{\bm{P}}_{T,w}," display="inline"><semantics id="S4.Ex4.m1.8a"><mrow id="S4.Ex4.m1.8b"><mo rspace="0.167em" id="S4.Ex4.m1.8.9">∥</mo><msub id="S4.Ex4.m1.8.10"><mi id="S4.Ex4.m1.8.10.2">𝑷</mi><mrow id="S4.Ex4.m1.2.2.2.4"><mi id="S4.Ex4.m1.1.1.1.1">T</mi><mo id="S4.Ex4.m1.2.2.2.4.1">,</mo><mn id="S4.Ex4.m1.2.2.2.2">1</mn></mrow></msub><mo id="S4.Ex4.m1.8.11">,</mo><msub id="S4.Ex4.m1.8.12"><mi id="S4.Ex4.m1.8.12.2">𝑷</mi><mrow id="S4.Ex4.m1.4.4.2.4"><mi id="S4.Ex4.m1.3.3.1.1">T</mi><mo id="S4.Ex4.m1.4.4.2.4.1">,</mo><mn id="S4.Ex4.m1.4.4.2.2">2</mn></mrow></msub><mo id="S4.Ex4.m1.8.13">,</mo><msub id="S4.Ex4.m1.8.14"><mi id="S4.Ex4.m1.8.14.2">𝑷</mi><mrow id="S4.Ex4.m1.6.6.2.4"><mi id="S4.Ex4.m1.5.5.1.1">T</mi><mo id="S4.Ex4.m1.6.6.2.4.1">,</mo><mn id="S4.Ex4.m1.6.6.2.2">3</mn></mrow></msub><mo lspace="0em" rspace="0.0835em" id="S4.Ex4.m1.8.15">∥</mo><mo lspace="0.0835em" stretchy="false" id="S4.Ex4.m1.8.16">→</mo><msub id="S4.Ex4.m1.8.17"><mi id="S4.Ex4.m1.8.17.2">𝑷</mi><mrow id="S4.Ex4.m1.8.8.2.4"><mi id="S4.Ex4.m1.7.7.1.1">T</mi><mo id="S4.Ex4.m1.8.8.2.4.1">,</mo><mi id="S4.Ex4.m1.8.8.2.2">w</mi></mrow></msub><mo id="S4.Ex4.m1.8.18">,</mo></mrow><annotation encoding="application/x-tex" id="S4.Ex4.m1.8c">\displaystyle\|{\bm{P}}_{T,1},{\bm{P}}_{T,2},{\bm{P}}_{T,3}\|\rightarrow{\bm{P}}_{T,w},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E8.m1.14" class="ltx_math_unparsed" alttext="\displaystyle\|{\bm{P}}_{T,1}+{\bm{P}}_{T,2}+{\bm{P}}_{T,3},{\bm{P}}_{T,2}+{\bm{P}}_{T,3},{\bm{P}}_{T,3}\|\rightarrow\hat{{\bm{P}}_{T,w}}," display="inline"><semantics id="S4.E8.m1.14a"><mrow id="S4.E8.m1.14b"><mo rspace="0.167em" id="S4.E8.m1.14.15">∥</mo><msub id="S4.E8.m1.14.16"><mi id="S4.E8.m1.14.16.2">𝑷</mi><mrow id="S4.E8.m1.2.2.2.4"><mi id="S4.E8.m1.1.1.1.1">T</mi><mo id="S4.E8.m1.2.2.2.4.1">,</mo><mn id="S4.E8.m1.2.2.2.2">1</mn></mrow></msub><mo id="S4.E8.m1.14.17">+</mo><msub id="S4.E8.m1.14.18"><mi id="S4.E8.m1.14.18.2">𝑷</mi><mrow id="S4.E8.m1.4.4.2.4"><mi id="S4.E8.m1.3.3.1.1">T</mi><mo id="S4.E8.m1.4.4.2.4.1">,</mo><mn id="S4.E8.m1.4.4.2.2">2</mn></mrow></msub><mo id="S4.E8.m1.14.19">+</mo><msub id="S4.E8.m1.14.20"><mi id="S4.E8.m1.14.20.2">𝑷</mi><mrow id="S4.E8.m1.6.6.2.4"><mi id="S4.E8.m1.5.5.1.1">T</mi><mo id="S4.E8.m1.6.6.2.4.1">,</mo><mn id="S4.E8.m1.6.6.2.2">3</mn></mrow></msub><mo id="S4.E8.m1.14.21">,</mo><msub id="S4.E8.m1.14.22"><mi id="S4.E8.m1.14.22.2">𝑷</mi><mrow id="S4.E8.m1.8.8.2.4"><mi id="S4.E8.m1.7.7.1.1">T</mi><mo id="S4.E8.m1.8.8.2.4.1">,</mo><mn id="S4.E8.m1.8.8.2.2">2</mn></mrow></msub><mo id="S4.E8.m1.14.23">+</mo><msub id="S4.E8.m1.14.24"><mi id="S4.E8.m1.14.24.2">𝑷</mi><mrow id="S4.E8.m1.10.10.2.4"><mi id="S4.E8.m1.9.9.1.1">T</mi><mo id="S4.E8.m1.10.10.2.4.1">,</mo><mn id="S4.E8.m1.10.10.2.2">3</mn></mrow></msub><mo id="S4.E8.m1.14.25">,</mo><msub id="S4.E8.m1.14.26"><mi id="S4.E8.m1.14.26.2">𝑷</mi><mrow id="S4.E8.m1.12.12.2.4"><mi id="S4.E8.m1.11.11.1.1">T</mi><mo id="S4.E8.m1.12.12.2.4.1">,</mo><mn id="S4.E8.m1.12.12.2.2">3</mn></mrow></msub><mo lspace="0em" rspace="0.0835em" id="S4.E8.m1.14.27">∥</mo><mo lspace="0.0835em" stretchy="false" id="S4.E8.m1.14.28">→</mo><mover accent="true" id="S4.E8.m1.14.14"><msub id="S4.E8.m1.14.14.2"><mi id="S4.E8.m1.14.14.2.4">𝑷</mi><mrow id="S4.E8.m1.14.14.2.2.2.4"><mi id="S4.E8.m1.13.13.1.1.1.1">T</mi><mo id="S4.E8.m1.14.14.2.2.2.4.1">,</mo><mi id="S4.E8.m1.14.14.2.2.2.2">w</mi></mrow></msub><mo id="S4.E8.m1.14.14.3">^</mo></mover><mo id="S4.E8.m1.14.29">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E8.m1.14c">\displaystyle\|{\bm{P}}_{T,1}+{\bm{P}}_{T,2}+{\bm{P}}_{T,3},{\bm{P}}_{T,2}+{\bm{P}}_{T,3},{\bm{P}}_{T,3}\|\rightarrow\hat{{\bm{P}}_{T,w}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S4.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex5.m1.4" class="ltx_math_unparsed" alttext="\displaystyle{\bm{R}}_{T}=\operatorname*{FM}(\|Seq,\frac{1}{m-k}\sum_{i=k}^{m}[tanh(\hat{{\bm{P}}_{T,w}})*{\bm{P}}_{T,w}]\|)." display="inline"><semantics id="S4.Ex5.m1.4a"><mrow id="S4.Ex5.m1.4b"><msub id="S4.Ex5.m1.4.5"><mi id="S4.Ex5.m1.4.5.2">𝑹</mi><mi id="S4.Ex5.m1.4.5.3">T</mi></msub><mo rspace="0.1389em" id="S4.Ex5.m1.4.6">=</mo><mo lspace="0.1389em" rspace="0em" id="S4.Ex5.m1.4.7">FM</mo><mrow id="S4.Ex5.m1.4.8"><mo stretchy="false" id="S4.Ex5.m1.4.8.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.Ex5.m1.4.8.2">∥</mo><mi id="S4.Ex5.m1.4.8.3">S</mi><mi id="S4.Ex5.m1.4.8.4">e</mi><mi id="S4.Ex5.m1.4.8.5">q</mi><mo id="S4.Ex5.m1.4.8.6">,</mo><mstyle displaystyle="true" id="S4.Ex5.m1.4.8.7"><mfrac id="S4.Ex5.m1.4.8.7a"><mn id="S4.Ex5.m1.4.8.7.2">1</mn><mrow id="S4.Ex5.m1.4.8.7.3"><mi id="S4.Ex5.m1.4.8.7.3.2">m</mi><mo id="S4.Ex5.m1.4.8.7.3.1">−</mo><mi id="S4.Ex5.m1.4.8.7.3.3">k</mi></mrow></mfrac></mstyle><mstyle displaystyle="true" id="S4.Ex5.m1.4.8.8"><munderover id="S4.Ex5.m1.4.8.8a"><mo movablelimits="false" id="S4.Ex5.m1.4.8.8.2.2">∑</mo><mrow id="S4.Ex5.m1.4.8.8.2.3"><mi id="S4.Ex5.m1.4.8.8.2.3.2">i</mi><mo id="S4.Ex5.m1.4.8.8.2.3.1">=</mo><mi id="S4.Ex5.m1.4.8.8.2.3.3">k</mi></mrow><mi id="S4.Ex5.m1.4.8.8.3">m</mi></munderover></mstyle><mrow id="S4.Ex5.m1.4.8.9"><mo stretchy="false" id="S4.Ex5.m1.4.8.9.1">[</mo><mi id="S4.Ex5.m1.4.8.9.2">t</mi><mi id="S4.Ex5.m1.4.8.9.3">a</mi><mi id="S4.Ex5.m1.4.8.9.4">n</mi><mi id="S4.Ex5.m1.4.8.9.5">h</mi><mrow id="S4.Ex5.m1.4.8.9.6"><mo stretchy="false" id="S4.Ex5.m1.4.8.9.6.1">(</mo><mover accent="true" id="S4.Ex5.m1.2.2"><msub id="S4.Ex5.m1.2.2.2"><mi id="S4.Ex5.m1.2.2.2.4">𝑷</mi><mrow id="S4.Ex5.m1.2.2.2.2.2.4"><mi id="S4.Ex5.m1.1.1.1.1.1.1">T</mi><mo id="S4.Ex5.m1.2.2.2.2.2.4.1">,</mo><mi id="S4.Ex5.m1.2.2.2.2.2.2">w</mi></mrow></msub><mo id="S4.Ex5.m1.2.2.3">^</mo></mover><mo rspace="0.055em" stretchy="false" id="S4.Ex5.m1.4.8.9.6.2">)</mo></mrow><mo rspace="0.222em" id="S4.Ex5.m1.4.8.9.7">∗</mo><msub id="S4.Ex5.m1.4.8.9.8"><mi id="S4.Ex5.m1.4.8.9.8.2">𝑷</mi><mrow id="S4.Ex5.m1.4.4.2.4"><mi id="S4.Ex5.m1.3.3.1.1">T</mi><mo id="S4.Ex5.m1.4.4.2.4.1">,</mo><mi id="S4.Ex5.m1.4.4.2.2">w</mi></mrow></msub><mo stretchy="false" id="S4.Ex5.m1.4.8.9.9">]</mo></mrow><mo lspace="0em" rspace="0.167em" id="S4.Ex5.m1.4.8.10">∥</mo><mo stretchy="false" id="S4.Ex5.m1.4.8.11">)</mo></mrow><mo lspace="0em" id="S4.Ex5.m1.4.9">.</mo></mrow><annotation encoding="application/x-tex" id="S4.Ex5.m1.4c">\displaystyle{\bm{R}}_{T}=\operatorname*{FM}(\|Seq,\frac{1}{m-k}\sum_{i=k}^{m}[tanh(\hat{{\bm{P}}_{T,w}})*{\bm{P}}_{T,w}]\|).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Spatial Prompt Learning (SPL).</h4>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.1" class="ltx_p">We regard multiple meteorological factors within a specific space. This enables the establishment of correlations between these factors from a spatial perspective on the local client. The SPL are shown in Figure <a href="#S4.F4" title="Figure 4 ‣ Spatial Prompt Learning (SPL). ‣ 4.1 Spatial-Temporal Prompt ‣ 4 Meteorological Prompt Federated Learning ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2301.09152/assets/FigofSPL.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="124" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The learning strategy of Spatial Prompt Learning, the empty is a location in data where variables need forecasting.</figcaption>
</figure>
<div id="S4.SS1.SSS0.Px2.p2" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p2.6" class="ltx_p">The trainable parameters that serve as spatial prompts can be represented as <math id="S4.SS1.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{P_{S}}\in\mathbb{R}^{(m-k)\times 1}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.1.m1.1a"><mrow id="S4.SS1.SSS0.Px2.p2.1.m1.1.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.cmml"><msub id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.2.cmml">𝐏</mi><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.3" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.3.cmml">𝐒</mi></msub><mo id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.2.cmml">×</mo><mn id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2"><in id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.1"></in><apply id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.2">𝐏</ci><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.2.3">𝐒</ci></apply><apply id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.2.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1"><times id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.2"></times><apply id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1"><minus id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.1"></minus><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.3">𝑘</ci></apply><cn type="integer" id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.1.m1.1c">\mathbf{P_{S}}\in\mathbb{R}^{(m-k)\times 1}</annotation></semantics></math>, where <math id="S4.SS1.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="m-k" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.2.m2.1a"><mrow id="S4.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.1" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.1.cmml">−</mo><mi id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.2.m2.1b"><apply id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1"><minus id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.1"></minus><ci id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.2.m2.1c">m-k</annotation></semantics></math> represents the length of the forecasting period. Prior to the initial learning phase, the first <math id="S4.SS1.SSS0.Px2.p2.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px2.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p2.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.3.m3.1c">p</annotation></semantics></math> hours of the data are considered fixed and denoted as <math id="S4.SS1.SSS0.Px2.p2.4.m4.1" class="ltx_Math" alttext="Seq\in\mathbb{R}^{k\times n}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.4.m4.1a"><mrow id="S4.SS1.SSS0.Px2.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.cmml"><mrow id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.2" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.1" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.3" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.1a" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.4" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.4.cmml">q</mi></mrow><mo id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.2" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.2" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.1" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.3" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.4.m4.1b"><apply id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1"><in id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.1"></in><apply id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2"><times id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.1"></times><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.2">𝑆</ci><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.3">𝑒</ci><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.4.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.2.4">𝑞</ci></apply><apply id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3"><times id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.1"></times><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.2">𝑘</ci><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.4.m4.1c">Seq\in\mathbb{R}^{k\times n}</annotation></semantics></math>. Subsequently, <math id="S4.SS1.SSS0.Px2.p2.5.m5.1" class="ltx_Math" alttext="Seq" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.5.m5.1a"><mrow id="S4.SS1.SSS0.Px2.p2.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.2" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.3" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1a" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.4" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.4.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.5.m5.1b"><apply id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1"><times id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.1"></times><ci id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.2">𝑆</ci><ci id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.3">𝑒</ci><ci id="S4.SS1.SSS0.Px2.p2.5.m5.1.1.4.cmml" xref="S4.SS1.SSS0.Px2.p2.5.m5.1.1.4">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.5.m5.1c">Seq</annotation></semantics></math> are combined with the initial spatial prompts along the temporal dimension, and any gaps in the spatial dimension are filled with zero-valued parameters, resulting in <math id="S4.SS1.SSS0.Px2.p2.6.m6.2" class="ltx_Math" alttext="\hat{\mathbf{P_{S}}}\in\mathbb{R}^{(m-k)\times(n-1)}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p2.6.m6.2a"><mrow id="S4.SS1.SSS0.Px2.p2.6.m6.2.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.cmml"><mover accent="true" id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.cmml"><msub id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.cmml"><mi id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.2.cmml">𝐏</mi><mi id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.3.cmml">𝐒</mi></msub><mo id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.1.cmml">^</mo></mover><mo id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.1.cmml">∈</mo><msup id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3.cmml"><mi id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.cmml"><mrow id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.2.cmml">m</mi><mo id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.3.cmml">×</mo><mrow id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.2" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.2.cmml">n</mi><mo id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.1" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.1.cmml">−</mo><mn id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.3" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.6.m6.2b"><apply id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3"><in id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.1"></in><apply id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2"><ci id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.1">^</ci><apply id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.2">𝐏</ci><ci id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.2.2.3">𝐒</ci></apply></apply><apply id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3.2.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.3.3.2">ℝ</ci><apply id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2"><times id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.3"></times><apply id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1"><minus id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.1"></minus><ci id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.2">𝑚</ci><ci id="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1"><minus id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.1"></minus><ci id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.2">𝑛</ci><cn type="integer" id="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.6.m6.2.2.2.2.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.6.m6.2c">\hat{\mathbf{P_{S}}}\in\mathbb{R}^{(m-k)\times(n-1)}</annotation></semantics></math>. The first learning phase comprises:</p>
<table id="S4.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E9X.2.1.1.m1.3" class="ltx_math_unparsed" alttext="\displaystyle\|{\bm{P}}_{S},\hat{{\bm{P}}_{S}}\|\rightarrow{\bm{P}}_{S,1}," display="inline"><semantics id="S4.E9X.2.1.1.m1.3a"><mrow id="S4.E9X.2.1.1.m1.3b"><mo rspace="0.167em" id="S4.E9X.2.1.1.m1.3.4">∥</mo><msub id="S4.E9X.2.1.1.m1.3.5"><mi id="S4.E9X.2.1.1.m1.3.5.2">𝑷</mi><mi id="S4.E9X.2.1.1.m1.3.5.3">S</mi></msub><mo id="S4.E9X.2.1.1.m1.3.6">,</mo><mover accent="true" id="S4.E9X.2.1.1.m1.3.3"><msub id="S4.E9X.2.1.1.m1.3.3.2"><mi id="S4.E9X.2.1.1.m1.3.3.2.2">𝑷</mi><mi id="S4.E9X.2.1.1.m1.3.3.2.3">S</mi></msub><mo id="S4.E9X.2.1.1.m1.3.3.1">^</mo></mover><mo lspace="0em" rspace="0.0835em" id="S4.E9X.2.1.1.m1.3.7">∥</mo><mo lspace="0.0835em" stretchy="false" id="S4.E9X.2.1.1.m1.3.8">→</mo><msub id="S4.E9X.2.1.1.m1.3.9"><mi id="S4.E9X.2.1.1.m1.3.9.2">𝑷</mi><mrow id="S4.E9X.2.1.1.m1.2.2.2.4"><mi id="S4.E9X.2.1.1.m1.1.1.1.1">S</mi><mo id="S4.E9X.2.1.1.m1.2.2.2.4.1">,</mo><mn id="S4.E9X.2.1.1.m1.2.2.2.2">1</mn></mrow></msub><mo id="S4.E9X.2.1.1.m1.3.10">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E9X.2.1.1.m1.3c">\displaystyle\|{\bm{P}}_{S},\hat{{\bm{P}}_{S}}\|\rightarrow{\bm{P}}_{S,1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr id="S4.E9Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E9Xa.2.1.1.m1.4" class="ltx_math_unparsed" alttext="\displaystyle{\bm{P}}^{\prime}_{S,1}={\bm{P}}_{S,1}*\operatorname*{FM}(\|Seq,{\bm{S}}_{1}\|)." display="inline"><semantics id="S4.E9Xa.2.1.1.m1.4a"><mrow id="S4.E9Xa.2.1.1.m1.4b"><msubsup id="S4.E9Xa.2.1.1.m1.4.5"><mi id="S4.E9Xa.2.1.1.m1.4.5.2.2">𝑷</mi><mrow id="S4.E9Xa.2.1.1.m1.2.2.2.4"><mi id="S4.E9Xa.2.1.1.m1.1.1.1.1">S</mi><mo id="S4.E9Xa.2.1.1.m1.2.2.2.4.1">,</mo><mn id="S4.E9Xa.2.1.1.m1.2.2.2.2">1</mn></mrow><mo id="S4.E9Xa.2.1.1.m1.4.5.2.3">′</mo></msubsup><mo id="S4.E9Xa.2.1.1.m1.4.6">=</mo><msub id="S4.E9Xa.2.1.1.m1.4.7"><mi id="S4.E9Xa.2.1.1.m1.4.7.2">𝑷</mi><mrow id="S4.E9Xa.2.1.1.m1.4.4.2.4"><mi id="S4.E9Xa.2.1.1.m1.3.3.1.1">S</mi><mo id="S4.E9Xa.2.1.1.m1.4.4.2.4.1">,</mo><mn id="S4.E9Xa.2.1.1.m1.4.4.2.2">1</mn></mrow></msub><mo lspace="0.222em" id="S4.E9Xa.2.1.1.m1.4.8">∗</mo><mo lspace="0.055em" rspace="0em" id="S4.E9Xa.2.1.1.m1.4.9">FM</mo><mrow id="S4.E9Xa.2.1.1.m1.4.10"><mo stretchy="false" id="S4.E9Xa.2.1.1.m1.4.10.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.E9Xa.2.1.1.m1.4.10.2">∥</mo><mi id="S4.E9Xa.2.1.1.m1.4.10.3">S</mi><mi id="S4.E9Xa.2.1.1.m1.4.10.4">e</mi><mi id="S4.E9Xa.2.1.1.m1.4.10.5">q</mi><mo id="S4.E9Xa.2.1.1.m1.4.10.6">,</mo><msub id="S4.E9Xa.2.1.1.m1.4.10.7"><mi id="S4.E9Xa.2.1.1.m1.4.10.7.2">𝑺</mi><mn id="S4.E9Xa.2.1.1.m1.4.10.7.3">1</mn></msub><mo lspace="0em" rspace="0.167em" id="S4.E9Xa.2.1.1.m1.4.10.8">∥</mo><mo stretchy="false" id="S4.E9Xa.2.1.1.m1.4.10.9">)</mo></mrow><mo lspace="0em" id="S4.E9Xa.2.1.1.m1.4.11">.</mo></mrow><annotation encoding="application/x-tex" id="S4.E9Xa.2.1.1.m1.4c">\displaystyle{\bm{P}}^{\prime}_{S,1}={\bm{P}}_{S,1}*\operatorname*{FM}(\|Seq,{\bm{S}}_{1}\|).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS1.SSS0.Px2.p3" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p3.2" class="ltx_p">In learning spatial prompts for the <math id="S4.SS1.SSS0.Px2.p3.1.m1.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.1.m1.1a"><msup id="S4.SS1.SSS0.Px2.p3.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.2.cmml">i</mi><mrow id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.2" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.1" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.3" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.2">𝑖</ci><apply id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3"><times id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p3.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.1.m1.1c">i^{th}</annotation></semantics></math> variable, the <math id="S4.SS1.SSS0.Px2.p3.2.m2.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p3.2.m2.1a"><msup id="S4.SS1.SSS0.Px2.p3.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.2" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml">i</mi><mrow id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.2" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.1" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.3" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p3.2.m2.1b"><apply id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.2">𝑖</ci><apply id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3"><times id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.1"></times><ci id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.2">𝑡</ci><ci id="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS0.Px2.p3.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p3.2.m2.1c">i^{th}</annotation></semantics></math> learning phase of SPL can be formulated as follow:</p>
<table id="S4.E10" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E10X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E10X.2.1.1.m1.7" class="ltx_math_unparsed" alttext="\displaystyle\|{\bm{P}}^{\prime}_{S,i-1},\hat{{\bm{P}}_{S}}\in\mathbb{R}^{(m-k)\times(n-i)}\|\rightarrow{\bm{P}}_{S,i}," display="inline"><semantics id="S4.E10X.2.1.1.m1.7a"><mrow id="S4.E10X.2.1.1.m1.7b"><mo rspace="0.167em" id="S4.E10X.2.1.1.m1.7.8">∥</mo><msubsup id="S4.E10X.2.1.1.m1.7.9"><mi id="S4.E10X.2.1.1.m1.7.9.2.2">𝑷</mi><mrow id="S4.E10X.2.1.1.m1.2.2.2.2"><mi id="S4.E10X.2.1.1.m1.1.1.1.1">S</mi><mo id="S4.E10X.2.1.1.m1.2.2.2.2.2">,</mo><mrow id="S4.E10X.2.1.1.m1.2.2.2.2.1"><mi id="S4.E10X.2.1.1.m1.2.2.2.2.1.2">i</mi><mo id="S4.E10X.2.1.1.m1.2.2.2.2.1.1">−</mo><mn id="S4.E10X.2.1.1.m1.2.2.2.2.1.3">1</mn></mrow></mrow><mo id="S4.E10X.2.1.1.m1.7.9.2.3">′</mo></msubsup><mo id="S4.E10X.2.1.1.m1.7.10">,</mo><mover accent="true" id="S4.E10X.2.1.1.m1.7.7"><msub id="S4.E10X.2.1.1.m1.7.7.2"><mi id="S4.E10X.2.1.1.m1.7.7.2.2">𝑷</mi><mi id="S4.E10X.2.1.1.m1.7.7.2.3">S</mi></msub><mo id="S4.E10X.2.1.1.m1.7.7.1">^</mo></mover><mo id="S4.E10X.2.1.1.m1.7.11">∈</mo><msup id="S4.E10X.2.1.1.m1.7.12"><mi id="S4.E10X.2.1.1.m1.7.12.2">ℝ</mi><mrow id="S4.E10X.2.1.1.m1.4.4.2"><mrow id="S4.E10X.2.1.1.m1.3.3.1.1.1"><mo stretchy="false" id="S4.E10X.2.1.1.m1.3.3.1.1.1.2">(</mo><mrow id="S4.E10X.2.1.1.m1.3.3.1.1.1.1"><mi id="S4.E10X.2.1.1.m1.3.3.1.1.1.1.2">m</mi><mo id="S4.E10X.2.1.1.m1.3.3.1.1.1.1.1">−</mo><mi id="S4.E10X.2.1.1.m1.3.3.1.1.1.1.3">k</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.E10X.2.1.1.m1.3.3.1.1.1.3">)</mo></mrow><mo rspace="0.222em" id="S4.E10X.2.1.1.m1.4.4.2.3">×</mo><mrow id="S4.E10X.2.1.1.m1.4.4.2.2.1"><mo stretchy="false" id="S4.E10X.2.1.1.m1.4.4.2.2.1.2">(</mo><mrow id="S4.E10X.2.1.1.m1.4.4.2.2.1.1"><mi id="S4.E10X.2.1.1.m1.4.4.2.2.1.1.2">n</mi><mo id="S4.E10X.2.1.1.m1.4.4.2.2.1.1.1">−</mo><mi id="S4.E10X.2.1.1.m1.4.4.2.2.1.1.3">i</mi></mrow><mo stretchy="false" id="S4.E10X.2.1.1.m1.4.4.2.2.1.3">)</mo></mrow></mrow></msup><mo lspace="0em" rspace="0.0835em" id="S4.E10X.2.1.1.m1.7.13">∥</mo><mo lspace="0.0835em" stretchy="false" id="S4.E10X.2.1.1.m1.7.14">→</mo><msub id="S4.E10X.2.1.1.m1.7.15"><mi id="S4.E10X.2.1.1.m1.7.15.2">𝑷</mi><mrow id="S4.E10X.2.1.1.m1.6.6.2.4"><mi id="S4.E10X.2.1.1.m1.5.5.1.1">S</mi><mo id="S4.E10X.2.1.1.m1.6.6.2.4.1">,</mo><mi id="S4.E10X.2.1.1.m1.6.6.2.2">i</mi></mrow></msub><mo id="S4.E10X.2.1.1.m1.7.16">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E10X.2.1.1.m1.7c">\displaystyle\|{\bm{P}}^{\prime}_{S,i-1},\hat{{\bm{P}}_{S}}\in\mathbb{R}^{(m-k)\times(n-i)}\|\rightarrow{\bm{P}}_{S,i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
<tr id="S4.E10Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E10Xa.2.1.1.m1.6" class="ltx_math_unparsed" alttext="\displaystyle{\bm{P}}^{\prime}_{S,i}={\bm{P}}_{S,i}*\operatorname*{FM}(\|Seq,{\bm{P}}_{S,i}\|)." display="inline"><semantics id="S4.E10Xa.2.1.1.m1.6a"><mrow id="S4.E10Xa.2.1.1.m1.6b"><msubsup id="S4.E10Xa.2.1.1.m1.6.7"><mi id="S4.E10Xa.2.1.1.m1.6.7.2.2">𝑷</mi><mrow id="S4.E10Xa.2.1.1.m1.2.2.2.4"><mi id="S4.E10Xa.2.1.1.m1.1.1.1.1">S</mi><mo id="S4.E10Xa.2.1.1.m1.2.2.2.4.1">,</mo><mi id="S4.E10Xa.2.1.1.m1.2.2.2.2">i</mi></mrow><mo id="S4.E10Xa.2.1.1.m1.6.7.2.3">′</mo></msubsup><mo id="S4.E10Xa.2.1.1.m1.6.8">=</mo><msub id="S4.E10Xa.2.1.1.m1.6.9"><mi id="S4.E10Xa.2.1.1.m1.6.9.2">𝑷</mi><mrow id="S4.E10Xa.2.1.1.m1.4.4.2.4"><mi id="S4.E10Xa.2.1.1.m1.3.3.1.1">S</mi><mo id="S4.E10Xa.2.1.1.m1.4.4.2.4.1">,</mo><mi id="S4.E10Xa.2.1.1.m1.4.4.2.2">i</mi></mrow></msub><mo lspace="0.222em" id="S4.E10Xa.2.1.1.m1.6.10">∗</mo><mo lspace="0.055em" rspace="0em" id="S4.E10Xa.2.1.1.m1.6.11">FM</mo><mrow id="S4.E10Xa.2.1.1.m1.6.12"><mo stretchy="false" id="S4.E10Xa.2.1.1.m1.6.12.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.E10Xa.2.1.1.m1.6.12.2">∥</mo><mi id="S4.E10Xa.2.1.1.m1.6.12.3">S</mi><mi id="S4.E10Xa.2.1.1.m1.6.12.4">e</mi><mi id="S4.E10Xa.2.1.1.m1.6.12.5">q</mi><mo id="S4.E10Xa.2.1.1.m1.6.12.6">,</mo><msub id="S4.E10Xa.2.1.1.m1.6.12.7"><mi id="S4.E10Xa.2.1.1.m1.6.12.7.2">𝑷</mi><mrow id="S4.E10Xa.2.1.1.m1.6.6.2.4"><mi id="S4.E10Xa.2.1.1.m1.5.5.1.1">S</mi><mo id="S4.E10Xa.2.1.1.m1.6.6.2.4.1">,</mo><mi id="S4.E10Xa.2.1.1.m1.6.6.2.2">i</mi></mrow></msub><mo lspace="0em" rspace="0.167em" id="S4.E10Xa.2.1.1.m1.6.12.8">∥</mo><mo stretchy="false" id="S4.E10Xa.2.1.1.m1.6.12.9">)</mo></mrow><mo lspace="0em" id="S4.E10Xa.2.1.1.m1.6.13">.</mo></mrow><annotation encoding="application/x-tex" id="S4.E10Xa.2.1.1.m1.6c">\displaystyle{\bm{P}}^{\prime}_{S,i}={\bm{P}}_{S,i}*\operatorname*{FM}(\|Seq,{\bm{P}}_{S,i}\|).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.SSS0.Px2.p3.3" class="ltx_p">One advantage of SPL over auto-regression is its continuous correction of learned prompt parameters from the previous iteration. This correction utilizes all the previously predicted values, leading to improved forecast accuracy. Moreover, SPL improves the model’s perception of correlations among multiple variables by considering adjacent variables together. Through multiple iterations of regression, SPL enhances the model’s ability to account for these spatial correlations.</p>
</div>
<div id="S4.SS1.SSS0.Px2.p4" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p4.1" class="ltx_p">To prevent isolating the TPL and SPL effects within the STP, we combine the result of TPL and SPL empirically using a Gate operation. The output of the STP is formulated as <math id="S4.SS1.SSS0.Px2.p4.1.m1.1" class="ltx_Math" alttext="{\bm{R}}=[(1-sigmoid({\bm{R}}_{S}))*tanh({\bm{R}}_{T})]*{\bm{W}}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p4.1.m1.1a"><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3.cmml">𝑹</mi><mo id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml">=</mo><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.5" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2b" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.6" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2c" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.7" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2d" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.8" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2e" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.9" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2f" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑹</mi><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">S</mi></msub><mo stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.2.cmml">∗</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.3.cmml">t</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.4" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3a" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.5" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3b" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.6" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3c" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.cmml">(</mo><msub id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.2.cmml">𝑹</mi><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.3.cmml">T</mi></msub><mo stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mo rspace="0.222em" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.2" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.2.cmml">∗</mo><mi id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.3" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.3.cmml">𝑾</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p4.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1"><eq id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.2"></eq><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.3">𝑹</ci><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1"><times id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.2"></times><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1"><times id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.3"></times><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1"><times id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1"><minus id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.2"></minus><cn type="integer" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.3">1</cn><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.4">𝑖</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.5">𝑔</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.6">𝑚</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.7.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.7">𝑜</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.8.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.8">𝑖</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.9.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.9">𝑑</ci><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑹</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑆</ci></apply></apply></apply><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.4.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.4">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.5.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.5">𝑛</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.6.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.6">ℎ</ci><apply id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.2">𝑹</ci><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.1.1.1.2.1.1.3">𝑇</ci></apply></apply></apply><ci id="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p4.1.m1.1.1.1.3">𝑾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p4.1.m1.1c">{\bm{R}}=[(1-sigmoid({\bm{R}}_{S}))*tanh({\bm{R}}_{T})]*{\bm{W}}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Optimization of <span id="S4.SS2.1.1" class="ltx_text ltx_font_italic">MetePFL</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.17" class="ltx_p">The optimization objective of <span id="S4.SS2.p1.17.1" class="ltx_text ltx_font_italic">MetePFL</span> is can formulated below according to the Eq. (3).
<span id="S4.SS2.p1.17.2" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E11.m1.2" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,min}_{{\bm{P}}}\sum_{k=1}^{N}\frac{n_{k}}{n}[F_{k}(\{{\bm{P}}_{k}\})+\lambda R(\{{\bm{P}}_{k}\},\{{\bm{P}}^{g}\})]+\tau{\mathcal{G}}({\bm{A}})" display="inline"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><mrow id="S4.E11.m1.2.2.1" xref="S4.E11.m1.2.2.1.cmml"><munder id="S4.E11.m1.2.2.1.3" xref="S4.E11.m1.2.2.1.3.cmml"><mrow id="S4.E11.m1.2.2.1.3.2" xref="S4.E11.m1.2.2.1.3.2.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.3.2.2" xref="S4.E11.m1.2.2.1.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.E11.m1.2.2.1.3.2.1" xref="S4.E11.m1.2.2.1.3.2.1.cmml">​</mo><mi mathsize="90%" id="S4.E11.m1.2.2.1.3.2.3" xref="S4.E11.m1.2.2.1.3.2.3.cmml">min</mi></mrow><mi mathsize="90%" id="S4.E11.m1.2.2.1.3.3" xref="S4.E11.m1.2.2.1.3.3.cmml">𝑷</mi></munder><mo lspace="0.167em" rspace="0em" id="S4.E11.m1.2.2.1.2" xref="S4.E11.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E11.m1.2.2.1.1" xref="S4.E11.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.E11.m1.2.2.1.1.2" xref="S4.E11.m1.2.2.1.1.2.cmml"><munderover id="S4.E11.m1.2.2.1.1.2a" xref="S4.E11.m1.2.2.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S4.E11.m1.2.2.1.1.2.2.2" xref="S4.E11.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E11.m1.2.2.1.1.2.2.3" xref="S4.E11.m1.2.2.1.1.2.2.3.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.2.2.3.2" xref="S4.E11.m1.2.2.1.1.2.2.3.2.cmml">k</mi><mo mathsize="90%" id="S4.E11.m1.2.2.1.1.2.2.3.1" xref="S4.E11.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S4.E11.m1.2.2.1.1.2.2.3.3" xref="S4.E11.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.2.3" xref="S4.E11.m1.2.2.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E11.m1.2.2.1.1.1" xref="S4.E11.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E11.m1.2.2.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.3.cmml"><mfrac id="S4.E11.m1.2.2.1.1.1.3a" xref="S4.E11.m1.2.2.1.1.1.3.cmml"><msub id="S4.E11.m1.2.2.1.1.1.3.2" xref="S4.E11.m1.2.2.1.1.1.3.2.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.3.2.2" xref="S4.E11.m1.2.2.1.1.1.3.2.2.cmml">n</mi><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.3.2.3" xref="S4.E11.m1.2.2.1.1.1.3.2.3.cmml">k</mi></msub><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.3.3" xref="S4.E11.m1.2.2.1.1.1.3.3.cmml">n</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S4.E11.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">F</mi><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.4" xref="S4.E11.m1.2.2.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.4" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.3.cmml">​</mo><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.5" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.3a" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.3.cmml">​</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">(</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml">{</mo><msub id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml">}</mo></mrow><mo mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.4" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">,</mo><mrow id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.2.cmml">{</mo><msup id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.2" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.3.cmml">g</mi></msup><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.3" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.2.cmml">}</mo></mrow><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.5" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.1.1.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml">+</mo><mrow id="S4.E11.m1.2.2.3" xref="S4.E11.m1.2.2.3.cmml"><mi mathsize="90%" id="S4.E11.m1.2.2.3.2" xref="S4.E11.m1.2.2.3.2.cmml">τ</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.3.1" xref="S4.E11.m1.2.2.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E11.m1.2.2.3.3" xref="S4.E11.m1.2.2.3.3.cmml">𝒢</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.3.1a" xref="S4.E11.m1.2.2.3.1.cmml">​</mo><mrow id="S4.E11.m1.2.2.3.4.2" xref="S4.E11.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.3.4.2.1" xref="S4.E11.m1.2.2.3.cmml">(</mo><mi mathsize="90%" id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml">𝑨</mi><mo maxsize="90%" minsize="90%" id="S4.E11.m1.2.2.3.4.2.2" xref="S4.E11.m1.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.2b"><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2"><plus id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"></plus><apply id="S4.E11.m1.2.2.1.cmml" xref="S4.E11.m1.2.2.1"><times id="S4.E11.m1.2.2.1.2.cmml" xref="S4.E11.m1.2.2.1.2"></times><apply id="S4.E11.m1.2.2.1.3.cmml" xref="S4.E11.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.3.1.cmml" xref="S4.E11.m1.2.2.1.3">subscript</csymbol><apply id="S4.E11.m1.2.2.1.3.2.cmml" xref="S4.E11.m1.2.2.1.3.2"><times id="S4.E11.m1.2.2.1.3.2.1.cmml" xref="S4.E11.m1.2.2.1.3.2.1"></times><ci id="S4.E11.m1.2.2.1.3.2.2.cmml" xref="S4.E11.m1.2.2.1.3.2.2">arg</ci><ci id="S4.E11.m1.2.2.1.3.2.3.cmml" xref="S4.E11.m1.2.2.1.3.2.3">min</ci></apply><ci id="S4.E11.m1.2.2.1.3.3.cmml" xref="S4.E11.m1.2.2.1.3.3">𝑷</ci></apply><apply id="S4.E11.m1.2.2.1.1.cmml" xref="S4.E11.m1.2.2.1.1"><apply id="S4.E11.m1.2.2.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.2.1.cmml" xref="S4.E11.m1.2.2.1.1.2">superscript</csymbol><apply id="S4.E11.m1.2.2.1.1.2.2.cmml" xref="S4.E11.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.2.2.1.cmml" xref="S4.E11.m1.2.2.1.1.2">subscript</csymbol><sum id="S4.E11.m1.2.2.1.1.2.2.2.cmml" xref="S4.E11.m1.2.2.1.1.2.2.2"></sum><apply id="S4.E11.m1.2.2.1.1.2.2.3.cmml" xref="S4.E11.m1.2.2.1.1.2.2.3"><eq id="S4.E11.m1.2.2.1.1.2.2.3.1.cmml" xref="S4.E11.m1.2.2.1.1.2.2.3.1"></eq><ci id="S4.E11.m1.2.2.1.1.2.2.3.2.cmml" xref="S4.E11.m1.2.2.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S4.E11.m1.2.2.1.1.2.2.3.3.cmml" xref="S4.E11.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E11.m1.2.2.1.1.2.3.cmml" xref="S4.E11.m1.2.2.1.1.2.3">𝑁</ci></apply><apply id="S4.E11.m1.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1"><times id="S4.E11.m1.2.2.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.2"></times><apply id="S4.E11.m1.2.2.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.3"><divide id="S4.E11.m1.2.2.1.1.1.3.1.cmml" xref="S4.E11.m1.2.2.1.1.1.3"></divide><apply id="S4.E11.m1.2.2.1.1.1.3.2.cmml" xref="S4.E11.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.3.2.1.cmml" xref="S4.E11.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.3.2.2.cmml" xref="S4.E11.m1.2.2.1.1.1.3.2.2">𝑛</ci><ci id="S4.E11.m1.2.2.1.1.1.3.2.3.cmml" xref="S4.E11.m1.2.2.1.1.1.3.2.3">𝑘</ci></apply><ci id="S4.E11.m1.2.2.1.1.1.3.3.cmml" xref="S4.E11.m1.2.2.1.1.1.3.3">𝑛</ci></apply><apply id="S4.E11.m1.2.2.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E11.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1"><plus id="S4.E11.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.4"></plus><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1"><times id="S4.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.2">𝐹</ci><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.3.3">𝑘</ci></apply><set id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑷</ci><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></set></apply><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3"><times id="S4.E11.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.3"></times><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.3.4.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.4">𝜆</ci><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.3.5.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.5">𝑅</ci><interval closure="open" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2"><set id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1"><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.2">𝑷</ci><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.1.3">𝑘</ci></apply></set><set id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1"><apply id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1">superscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.2">𝑷</ci><ci id="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.1.1.1.3.2.2.2.1.1.3">𝑔</ci></apply></set></interval></apply></apply></apply></apply></apply></apply><apply id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2.3"><times id="S4.E11.m1.2.2.3.1.cmml" xref="S4.E11.m1.2.2.3.1"></times><ci id="S4.E11.m1.2.2.3.2.cmml" xref="S4.E11.m1.2.2.3.2">𝜏</ci><ci id="S4.E11.m1.2.2.3.3.cmml" xref="S4.E11.m1.2.2.3.3">𝒢</ci><ci id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1">𝑨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.2c">\displaystyle\operatorname*{arg\,min}_{{\bm{P}}}\sum_{k=1}^{N}\frac{n_{k}}{n}[F_{k}(\{{\bm{P}}_{k}\})+\lambda R(\{{\bm{P}}_{k}\},\{{\bm{P}}^{g}\})]+\tau{\mathcal{G}}({\bm{A}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.8" class="ltx_p">where <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\{{\bm{P}}_{k}\}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">{</mo><msub id="S4.SS2.p1.1.m1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.1.m1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><set id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1"><apply id="S4.SS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2">𝑷</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\{{\bm{P}}_{k}\}</annotation></semantics></math> is prompts including <math id="S4.SS2.p1.2.m2.2" class="ltx_Math" alttext="{\bm{P}}_{S},{\bm{P}}_{T}" display="inline"><semantics id="S4.SS2.p1.2.m2.2a"><mrow id="S4.SS2.p1.2.m2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.3.cmml"><msub id="S4.SS2.p1.2.m2.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1.2" xref="S4.SS2.p1.2.m2.1.1.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.2.m2.1.1.1.1.3" xref="S4.SS2.p1.2.m2.1.1.1.1.3.cmml">S</mi></msub><mo id="S4.SS2.p1.2.m2.2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.3.cmml">,</mo><msub id="S4.SS2.p1.2.m2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.2.2.cmml">𝑷</mi><mi id="S4.SS2.p1.2.m2.2.2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.2.2.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.2b"><list id="S4.SS2.p1.2.m2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2"><apply id="S4.SS2.p1.2.m2.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2">𝑷</ci><ci id="S4.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3">𝑆</ci></apply><apply id="S4.SS2.p1.2.m2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.2.2.2.2.1.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.2.m2.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.2">𝑷</ci><ci id="S4.SS2.p1.2.m2.2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.2.2.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.2c">{\bm{P}}_{S},{\bm{P}}_{T}</annotation></semantics></math>, <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\{{\bm{P}}^{g}\}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">{</mo><msup id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.3.m3.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.cmml">g</mi></msup><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><set id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1"><apply id="S4.SS2.p1.3.m3.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2">𝑷</ci><ci id="S4.SS2.p1.3.m3.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3">𝑔</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\{{\bm{P}}^{g}\}</annotation></semantics></math> is the global prompt parameters, <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="{\mathcal{G}}({\bm{A}})" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.1.2.2" xref="S4.SS2.p1.4.m4.1.2.2.cmml">𝒢</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.2.1" xref="S4.SS2.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.4.m4.1.2.3.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.2.1" xref="S4.SS2.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">𝑨</mi><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.2.2" xref="S4.SS2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.2.cmml" xref="S4.SS2.p1.4.m4.1.2"><times id="S4.SS2.p1.4.m4.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2.1"></times><ci id="S4.SS2.p1.4.m4.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2">𝒢</ci><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">{\mathcal{G}}({\bm{A}})</annotation></semantics></math> is a regularization term used to represent the correlation among client according the adjacent matrix <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="{\bm{A}}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">𝑨</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">{\bm{A}}</annotation></semantics></math>. specifically, the term <math id="S4.SS2.p1.6.m6.5" class="ltx_Math" alttext="F_{k}(\{{\bm{P}}\})+\lambda R(\{{\bm{P}}\},\{{\bm{P}}^{g}\})" display="inline"><semantics id="S4.SS2.p1.6.m6.5a"><mrow id="S4.SS2.p1.6.m6.5.5" xref="S4.SS2.p1.6.m6.5.5.cmml"><mrow id="S4.SS2.p1.6.m6.3.3.1" xref="S4.SS2.p1.6.m6.3.3.1.cmml"><msub id="S4.SS2.p1.6.m6.3.3.1.3" xref="S4.SS2.p1.6.m6.3.3.1.3.cmml"><mi id="S4.SS2.p1.6.m6.3.3.1.3.2" xref="S4.SS2.p1.6.m6.3.3.1.3.2.cmml">F</mi><mi id="S4.SS2.p1.6.m6.3.3.1.3.3" xref="S4.SS2.p1.6.m6.3.3.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m6.3.3.1.2" xref="S4.SS2.p1.6.m6.3.3.1.2.cmml">​</mo><mrow id="S4.SS2.p1.6.m6.3.3.1.1.1" xref="S4.SS2.p1.6.m6.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.3.3.1.1.1.2" xref="S4.SS2.p1.6.m6.3.3.1.cmml">(</mo><mrow id="S4.SS2.p1.6.m6.3.3.1.1.1.1.2" xref="S4.SS2.p1.6.m6.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.3.3.1.1.1.1.2.1" xref="S4.SS2.p1.6.m6.3.3.1.1.1.1.1.cmml">{</mo><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">𝑷</mi><mo stretchy="false" id="S4.SS2.p1.6.m6.3.3.1.1.1.1.2.2" xref="S4.SS2.p1.6.m6.3.3.1.1.1.1.1.cmml">}</mo></mrow><mo stretchy="false" id="S4.SS2.p1.6.m6.3.3.1.1.1.3" xref="S4.SS2.p1.6.m6.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.6.m6.5.5.4" xref="S4.SS2.p1.6.m6.5.5.4.cmml">+</mo><mrow id="S4.SS2.p1.6.m6.5.5.3" xref="S4.SS2.p1.6.m6.5.5.3.cmml"><mi id="S4.SS2.p1.6.m6.5.5.3.4" xref="S4.SS2.p1.6.m6.5.5.3.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m6.5.5.3.3" xref="S4.SS2.p1.6.m6.5.5.3.3.cmml">​</mo><mi id="S4.SS2.p1.6.m6.5.5.3.5" xref="S4.SS2.p1.6.m6.5.5.3.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m6.5.5.3.3a" xref="S4.SS2.p1.6.m6.5.5.3.3.cmml">​</mo><mrow id="S4.SS2.p1.6.m6.5.5.3.2.2" xref="S4.SS2.p1.6.m6.5.5.3.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.5.5.3.2.2.3" xref="S4.SS2.p1.6.m6.5.5.3.2.3.cmml">(</mo><mrow id="S4.SS2.p1.6.m6.4.4.2.1.1.1.2" xref="S4.SS2.p1.6.m6.4.4.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.4.4.2.1.1.1.2.1" xref="S4.SS2.p1.6.m6.4.4.2.1.1.1.1.cmml">{</mo><mi id="S4.SS2.p1.6.m6.2.2" xref="S4.SS2.p1.6.m6.2.2.cmml">𝑷</mi><mo stretchy="false" id="S4.SS2.p1.6.m6.4.4.2.1.1.1.2.2" xref="S4.SS2.p1.6.m6.4.4.2.1.1.1.1.cmml">}</mo></mrow><mo id="S4.SS2.p1.6.m6.5.5.3.2.2.4" xref="S4.SS2.p1.6.m6.5.5.3.2.3.cmml">,</mo><mrow id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.2" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.2.cmml">{</mo><msup id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.cmml"><mi id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.2" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.3" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.3.cmml">g</mi></msup><mo stretchy="false" id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.3" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.2.cmml">}</mo></mrow><mo stretchy="false" id="S4.SS2.p1.6.m6.5.5.3.2.2.5" xref="S4.SS2.p1.6.m6.5.5.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.5b"><apply id="S4.SS2.p1.6.m6.5.5.cmml" xref="S4.SS2.p1.6.m6.5.5"><plus id="S4.SS2.p1.6.m6.5.5.4.cmml" xref="S4.SS2.p1.6.m6.5.5.4"></plus><apply id="S4.SS2.p1.6.m6.3.3.1.cmml" xref="S4.SS2.p1.6.m6.3.3.1"><times id="S4.SS2.p1.6.m6.3.3.1.2.cmml" xref="S4.SS2.p1.6.m6.3.3.1.2"></times><apply id="S4.SS2.p1.6.m6.3.3.1.3.cmml" xref="S4.SS2.p1.6.m6.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.3.3.1.3.1.cmml" xref="S4.SS2.p1.6.m6.3.3.1.3">subscript</csymbol><ci id="S4.SS2.p1.6.m6.3.3.1.3.2.cmml" xref="S4.SS2.p1.6.m6.3.3.1.3.2">𝐹</ci><ci id="S4.SS2.p1.6.m6.3.3.1.3.3.cmml" xref="S4.SS2.p1.6.m6.3.3.1.3.3">𝑘</ci></apply><set id="S4.SS2.p1.6.m6.3.3.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.3.3.1.1.1.1.2"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝑷</ci></set></apply><apply id="S4.SS2.p1.6.m6.5.5.3.cmml" xref="S4.SS2.p1.6.m6.5.5.3"><times id="S4.SS2.p1.6.m6.5.5.3.3.cmml" xref="S4.SS2.p1.6.m6.5.5.3.3"></times><ci id="S4.SS2.p1.6.m6.5.5.3.4.cmml" xref="S4.SS2.p1.6.m6.5.5.3.4">𝜆</ci><ci id="S4.SS2.p1.6.m6.5.5.3.5.cmml" xref="S4.SS2.p1.6.m6.5.5.3.5">𝑅</ci><interval closure="open" id="S4.SS2.p1.6.m6.5.5.3.2.3.cmml" xref="S4.SS2.p1.6.m6.5.5.3.2.2"><set id="S4.SS2.p1.6.m6.4.4.2.1.1.1.1.cmml" xref="S4.SS2.p1.6.m6.4.4.2.1.1.1.2"><ci id="S4.SS2.p1.6.m6.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2">𝑷</ci></set><set id="S4.SS2.p1.6.m6.5.5.3.2.2.2.2.cmml" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1"><apply id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.cmml" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1">superscript</csymbol><ci id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.2.cmml" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.2">𝑷</ci><ci id="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.3.cmml" xref="S4.SS2.p1.6.m6.5.5.3.2.2.2.1.1.3">𝑔</ci></apply></set></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.5c">F_{k}(\{{\bm{P}}\})+\lambda R(\{{\bm{P}}\},\{{\bm{P}}^{g}\})</annotation></semantics></math> can be formulated as <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="{\mathcal{L}}_{k}={\mathcal{L}}_{\text{MSE}}+\lambda\|\{{\bm{P}}_{k}\}-\{{\bm{P}}^{g}\}\|_{2}^{2}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><msub id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.7.m7.1.1.3.2" xref="S4.SS2.p1.7.m7.1.1.3.2.cmml">ℒ</mi><mi id="S4.SS2.p1.7.m7.1.1.3.3" xref="S4.SS2.p1.7.m7.1.1.3.3.cmml">k</mi></msub><mo id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">=</mo><mrow id="S4.SS2.p1.7.m7.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.cmml"><msub id="S4.SS2.p1.7.m7.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.7.m7.1.1.1.3.2" xref="S4.SS2.p1.7.m7.1.1.1.3.2.cmml">ℒ</mi><mtext id="S4.SS2.p1.7.m7.1.1.1.3.3" xref="S4.SS2.p1.7.m7.1.1.1.3.3a.cmml">MSE</mtext></msub><mo id="S4.SS2.p1.7.m7.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.2.cmml">+</mo><mrow id="S4.SS2.p1.7.m7.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m7.1.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.2.cmml">​</mo><msubsup id="S4.SS2.p1.7.m7.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.cmml"><mrow id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.2.cmml">{</mo><msup id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml">g</mi></msup><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.2.cmml">}</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.p1.7.m7.1.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.3.cmml">2</mn><mn id="S4.SS2.p1.7.m7.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><eq id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2"></eq><apply id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS2.p1.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.3.2.cmml" xref="S4.SS2.p1.7.m7.1.1.3.2">ℒ</ci><ci id="S4.SS2.p1.7.m7.1.1.3.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3.3">𝑘</ci></apply><apply id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1"><plus id="S4.SS2.p1.7.m7.1.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.2"></plus><apply id="S4.SS2.p1.7.m7.1.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.3.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.1.3.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.3.2">ℒ</ci><ci id="S4.SS2.p1.7.m7.1.1.1.3.3a.cmml" xref="S4.SS2.p1.7.m7.1.1.1.3.3"><mtext mathsize="70%" id="S4.SS2.p1.7.m7.1.1.1.3.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.3.3">MSE</mtext></ci></apply><apply id="S4.SS2.p1.7.m7.1.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1"><times id="S4.SS2.p1.7.m7.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.2"></times><ci id="S4.SS2.p1.7.m7.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.3">𝜆</ci><apply id="S4.SS2.p1.7.m7.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1">subscript</csymbol><apply id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1"><minus id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.3"></minus><set id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1"><apply id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑷</ci><ci id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><set id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1"><apply id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1">superscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.2">𝑷</ci><ci id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.1.1.2.1.1.3">𝑔</ci></apply></set></apply></apply><cn type="integer" id="S4.SS2.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S4.SS2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">{\mathcal{L}}_{k}={\mathcal{L}}_{\text{MSE}}+\lambda\|\{{\bm{P}}_{k}\}-\{{\bm{P}}^{g}\}\|_{2}^{2}</annotation></semantics></math>. The optimization objective on <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">i</annotation></semantics></math>-th client as:</p>
<table id="S4.E12" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E12X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E12X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,min}_{{\bm{A}}}\sum_{k=1}^{N}\lambda R(\{{\bm{P}}_{k}\},\{{\bm{P}}^{g}\})+\tau{\mathcal{G}}({\bm{A}})," display="inline"><semantics id="S4.E12X.2.1.1.m1.2a"><mrow id="S4.E12X.2.1.1.m1.2.2.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S4.E12X.2.1.1.m1.2.2.1.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.cmml"><munder id="S4.E12X.2.1.1.m1.2.2.1.1.2.4" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.cmml"><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.cmml"><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.1.cmml">​</mo><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.3.cmml">min</mi></mrow><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.3.cmml">𝑨</mi></munder><mo lspace="0.167em" rspace="0em" id="S4.E12X.2.1.1.m1.2.2.1.1.2.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.2.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.cmml"><munderover id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3a" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.cmml"><mo movablelimits="false" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.cmml"><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.2.cmml">k</mi><mo id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.4" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.5" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.3a" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑷</mi><mi id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.4" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">,</mo><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.2.cmml">{</mo><msup id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml"><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.2.cmml">𝑷</mi><mi id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.3.cmml">g</mi></msup><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.2.cmml">}</mo></mrow><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.5" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E12X.2.1.1.m1.2.2.1.1.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.3.cmml">+</mo><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.4" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.cmml"><mi id="S4.E12X.2.1.1.m1.2.2.1.1.4.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.2.cmml">τ</mi><mo lspace="0em" rspace="0em" id="S4.E12X.2.1.1.m1.2.2.1.1.4.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.E12X.2.1.1.m1.2.2.1.1.4.3" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.3.cmml">𝒢</mi><mo lspace="0em" rspace="0em" id="S4.E12X.2.1.1.m1.2.2.1.1.4.1a" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.1.cmml">​</mo><mrow id="S4.E12X.2.1.1.m1.2.2.1.1.4.4.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.cmml"><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.4.4.2.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.cmml">(</mo><mi id="S4.E12X.2.1.1.m1.1.1" xref="S4.E12X.2.1.1.m1.1.1.cmml">𝑨</mi><mo stretchy="false" id="S4.E12X.2.1.1.m1.2.2.1.1.4.4.2.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12X.2.1.1.m1.2.2.1.2" xref="S4.E12X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12X.2.1.1.m1.2b"><apply id="S4.E12X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1"><plus id="S4.E12X.2.1.1.m1.2.2.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.3"></plus><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2"><times id="S4.E12X.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.3"></times><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4">subscript</csymbol><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2"><times id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.1"></times><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.2">arg</ci><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.2.3">min</ci></apply><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.4.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.4.3">𝑨</ci></apply><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2"><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3">superscript</csymbol><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3">subscript</csymbol><sum id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.2"></sum><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3"><eq id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.1"></eq><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.2">𝑘</ci><cn type="integer" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.3.3">𝑁</ci></apply><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2"><times id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.3"></times><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.4.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.4">𝜆</ci><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.5.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.5">𝑅</ci><interval closure="open" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2"><set id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"><apply id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑷</ci><ci id="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><set id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1"><apply id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1">superscript</csymbol><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.2">𝑷</ci><ci id="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.2.2.2.2.2.2.1.1.3">𝑔</ci></apply></set></interval></apply></apply></apply><apply id="S4.E12X.2.1.1.m1.2.2.1.1.4.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.4"><times id="S4.E12X.2.1.1.m1.2.2.1.1.4.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.1"></times><ci id="S4.E12X.2.1.1.m1.2.2.1.1.4.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.2">𝜏</ci><ci id="S4.E12X.2.1.1.m1.2.2.1.1.4.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1.4.3">𝒢</ci><ci id="S4.E12X.2.1.1.m1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1">𝑨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12X.2.1.1.m1.2c">\displaystyle\operatorname*{arg\,min}_{{\bm{A}}}\sum_{k=1}^{N}\lambda R(\{{\bm{P}}_{k}\},\{{\bm{P}}^{g}\})+\tau{\mathcal{G}}({\bm{A}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
<tr id="S4.E12Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E12Xa.2.1.1.m1.5" class="ltx_math_unparsed" alttext="\displaystyle s.t.\quad{\bm{P}}^{s}\in\operatorname*{arg\,min}_{\{{\bm{P}}_{k}\}}{\bm{A}}_{j,i}S(\{{\bm{P}}_{j}\},\{{\bm{P}}_{i}\})," display="inline"><semantics id="S4.E12Xa.2.1.1.m1.5a"><mrow id="S4.E12Xa.2.1.1.m1.5b"><mi id="S4.E12Xa.2.1.1.m1.4.4">s</mi><mo lspace="0em" rspace="0.167em" id="S4.E12Xa.2.1.1.m1.5.6">.</mo><mi id="S4.E12Xa.2.1.1.m1.5.5">t</mi><mo lspace="0em" id="S4.E12Xa.2.1.1.m1.5.7">.</mo><mspace width="1.167em" id="S4.E12Xa.2.1.1.m1.5.8"></mspace><msup id="S4.E12Xa.2.1.1.m1.5.9"><mi id="S4.E12Xa.2.1.1.m1.5.9.2">𝑷</mi><mi id="S4.E12Xa.2.1.1.m1.5.9.3">s</mi></msup><mo id="S4.E12Xa.2.1.1.m1.5.10">∈</mo><munder id="S4.E12Xa.2.1.1.m1.5.11"><mrow id="S4.E12Xa.2.1.1.m1.5.11.2"><mi id="S4.E12Xa.2.1.1.m1.5.11.2.2">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.E12Xa.2.1.1.m1.5.11.2.1">​</mo><mi id="S4.E12Xa.2.1.1.m1.5.11.2.3">min</mi></mrow><mrow id="S4.E12Xa.2.1.1.m1.1.1.1.1"><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.1.1.1.1.2">{</mo><msub id="S4.E12Xa.2.1.1.m1.1.1.1.1.1"><mi id="S4.E12Xa.2.1.1.m1.1.1.1.1.1.2">𝑷</mi><mi id="S4.E12Xa.2.1.1.m1.1.1.1.1.1.3">k</mi></msub><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.1.1.1.1.3">}</mo></mrow></munder><msub id="S4.E12Xa.2.1.1.m1.5.12"><mi id="S4.E12Xa.2.1.1.m1.5.12.2">𝑨</mi><mrow id="S4.E12Xa.2.1.1.m1.3.3.2.4"><mi id="S4.E12Xa.2.1.1.m1.2.2.1.1">j</mi><mo id="S4.E12Xa.2.1.1.m1.3.3.2.4.1">,</mo><mi id="S4.E12Xa.2.1.1.m1.3.3.2.2">i</mi></mrow></msub><mi id="S4.E12Xa.2.1.1.m1.5.13">S</mi><mrow id="S4.E12Xa.2.1.1.m1.5.14"><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.5.14.1">(</mo><mrow id="S4.E12Xa.2.1.1.m1.5.14.2"><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.5.14.2.1">{</mo><msub id="S4.E12Xa.2.1.1.m1.5.14.2.2"><mi id="S4.E12Xa.2.1.1.m1.5.14.2.2.2">𝑷</mi><mi id="S4.E12Xa.2.1.1.m1.5.14.2.2.3">j</mi></msub><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.5.14.2.3">}</mo></mrow><mo id="S4.E12Xa.2.1.1.m1.5.14.3">,</mo><mrow id="S4.E12Xa.2.1.1.m1.5.14.4"><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.5.14.4.1">{</mo><msub id="S4.E12Xa.2.1.1.m1.5.14.4.2"><mi id="S4.E12Xa.2.1.1.m1.5.14.4.2.2">𝑷</mi><mi id="S4.E12Xa.2.1.1.m1.5.14.4.2.3">i</mi></msub><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.5.14.4.3">}</mo></mrow><mo stretchy="false" id="S4.E12Xa.2.1.1.m1.5.14.5">)</mo></mrow><mo id="S4.E12Xa.2.1.1.m1.5.15">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E12Xa.2.1.1.m1.5c">\displaystyle s.t.\quad{\bm{P}}^{s}\in\operatorname*{arg\,min}_{\{{\bm{P}}_{k}\}}{\bm{A}}_{j,i}S(\{{\bm{P}}_{j}\},\{{\bm{P}}_{i}\}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S4.E12Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E12Xb.2.1.1.m1.2" class="ltx_math_unparsed" alttext="\displaystyle i.e.\quad{\bm{P}}^{g}=G(\{{\bm{P}}^{s}_{1}\},\{{\bm{P}}^{s}_{2}\},...,\{{\bm{P}}^{s}_{N}\})," display="inline"><semantics id="S4.E12Xb.2.1.1.m1.2a"><mrow id="S4.E12Xb.2.1.1.m1.2b"><mi id="S4.E12Xb.2.1.1.m1.1.1">i</mi><mo lspace="0em" rspace="0.167em" id="S4.E12Xb.2.1.1.m1.2.3">.</mo><mi id="S4.E12Xb.2.1.1.m1.2.2">e</mi><mo lspace="0em" id="S4.E12Xb.2.1.1.m1.2.4">.</mo><mspace width="1.167em" id="S4.E12Xb.2.1.1.m1.2.5"></mspace><msup id="S4.E12Xb.2.1.1.m1.2.6"><mi id="S4.E12Xb.2.1.1.m1.2.6.2">𝑷</mi><mi id="S4.E12Xb.2.1.1.m1.2.6.3">g</mi></msup><mo id="S4.E12Xb.2.1.1.m1.2.7">=</mo><mi id="S4.E12Xb.2.1.1.m1.2.8">G</mi><mrow id="S4.E12Xb.2.1.1.m1.2.9"><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.1">(</mo><mrow id="S4.E12Xb.2.1.1.m1.2.9.2"><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.2.1">{</mo><msubsup id="S4.E12Xb.2.1.1.m1.2.9.2.2"><mi id="S4.E12Xb.2.1.1.m1.2.9.2.2.2.2">𝑷</mi><mn id="S4.E12Xb.2.1.1.m1.2.9.2.2.3">1</mn><mi id="S4.E12Xb.2.1.1.m1.2.9.2.2.2.3">s</mi></msubsup><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.2.3">}</mo></mrow><mo id="S4.E12Xb.2.1.1.m1.2.9.3">,</mo><mrow id="S4.E12Xb.2.1.1.m1.2.9.4"><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.4.1">{</mo><msubsup id="S4.E12Xb.2.1.1.m1.2.9.4.2"><mi id="S4.E12Xb.2.1.1.m1.2.9.4.2.2.2">𝑷</mi><mn id="S4.E12Xb.2.1.1.m1.2.9.4.2.3">2</mn><mi id="S4.E12Xb.2.1.1.m1.2.9.4.2.2.3">s</mi></msubsup><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.4.3">}</mo></mrow><mo id="S4.E12Xb.2.1.1.m1.2.9.5">,</mo><mi mathvariant="normal" id="S4.E12Xb.2.1.1.m1.2.9.6">…</mi><mo id="S4.E12Xb.2.1.1.m1.2.9.7">,</mo><mrow id="S4.E12Xb.2.1.1.m1.2.9.8"><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.8.1">{</mo><msubsup id="S4.E12Xb.2.1.1.m1.2.9.8.2"><mi id="S4.E12Xb.2.1.1.m1.2.9.8.2.2.2">𝑷</mi><mi id="S4.E12Xb.2.1.1.m1.2.9.8.2.3">N</mi><mi id="S4.E12Xb.2.1.1.m1.2.9.8.2.2.3">s</mi></msubsup><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.8.3">}</mo></mrow><mo stretchy="false" id="S4.E12Xb.2.1.1.m1.2.9.9">)</mo></mrow><mo id="S4.E12Xb.2.1.1.m1.2.10">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E12Xb.2.1.1.m1.2c">\displaystyle i.e.\quad{\bm{P}}^{g}=G(\{{\bm{P}}^{s}_{1}\},\{{\bm{P}}^{s}_{2}\},...,\{{\bm{P}}^{s}_{N}\}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS2.p1.16" class="ltx_p">where the <math id="S4.SS2.p1.9.m1.2" class="ltx_Math" alttext="{\bm{A}}\in\{0,1\}" display="inline"><semantics id="S4.SS2.p1.9.m1.2a"><mrow id="S4.SS2.p1.9.m1.2.3" xref="S4.SS2.p1.9.m1.2.3.cmml"><mi id="S4.SS2.p1.9.m1.2.3.2" xref="S4.SS2.p1.9.m1.2.3.2.cmml">𝑨</mi><mo id="S4.SS2.p1.9.m1.2.3.1" xref="S4.SS2.p1.9.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS2.p1.9.m1.2.3.3.2" xref="S4.SS2.p1.9.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m1.2.3.3.2.1" xref="S4.SS2.p1.9.m1.2.3.3.1.cmml">{</mo><mn id="S4.SS2.p1.9.m1.1.1" xref="S4.SS2.p1.9.m1.1.1.cmml">0</mn><mo id="S4.SS2.p1.9.m1.2.3.3.2.2" xref="S4.SS2.p1.9.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p1.9.m1.2.2" xref="S4.SS2.p1.9.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS2.p1.9.m1.2.3.3.2.3" xref="S4.SS2.p1.9.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m1.2b"><apply id="S4.SS2.p1.9.m1.2.3.cmml" xref="S4.SS2.p1.9.m1.2.3"><in id="S4.SS2.p1.9.m1.2.3.1.cmml" xref="S4.SS2.p1.9.m1.2.3.1"></in><ci id="S4.SS2.p1.9.m1.2.3.2.cmml" xref="S4.SS2.p1.9.m1.2.3.2">𝑨</ci><set id="S4.SS2.p1.9.m1.2.3.3.1.cmml" xref="S4.SS2.p1.9.m1.2.3.3.2"><cn type="integer" id="S4.SS2.p1.9.m1.1.1.cmml" xref="S4.SS2.p1.9.m1.1.1">0</cn><cn type="integer" id="S4.SS2.p1.9.m1.2.2.cmml" xref="S4.SS2.p1.9.m1.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m1.2c">{\bm{A}}\in\{0,1\}</annotation></semantics></math>, <math id="S4.SS2.p1.10.m2.2" class="ltx_Math" alttext="S(\{{\bm{P}}_{j}\},\{{\bm{P}}_{i}\})" display="inline"><semantics id="S4.SS2.p1.10.m2.2a"><mrow id="S4.SS2.p1.10.m2.2.2" xref="S4.SS2.p1.10.m2.2.2.cmml"><mi id="S4.SS2.p1.10.m2.2.2.4" xref="S4.SS2.p1.10.m2.2.2.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.10.m2.2.2.3" xref="S4.SS2.p1.10.m2.2.2.3.cmml">​</mo><mrow id="S4.SS2.p1.10.m2.2.2.2.2" xref="S4.SS2.p1.10.m2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.10.m2.2.2.2.2.3" xref="S4.SS2.p1.10.m2.2.2.2.3.cmml">(</mo><mrow id="S4.SS2.p1.10.m2.1.1.1.1.1.1" xref="S4.SS2.p1.10.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.10.m2.1.1.1.1.1.1.2" xref="S4.SS2.p1.10.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS2.p1.10.m2.1.1.1.1.1.1.1" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS2.p1.10.m2.1.1.1.1.1.1.3" xref="S4.SS2.p1.10.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S4.SS2.p1.10.m2.2.2.2.2.4" xref="S4.SS2.p1.10.m2.2.2.2.3.cmml">,</mo><mrow id="S4.SS2.p1.10.m2.2.2.2.2.2.1" xref="S4.SS2.p1.10.m2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.10.m2.2.2.2.2.2.1.2" xref="S4.SS2.p1.10.m2.2.2.2.2.2.2.cmml">{</mo><msub id="S4.SS2.p1.10.m2.2.2.2.2.2.1.1" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.cmml"><mi id="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.2" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.2.cmml">𝑷</mi><mi id="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.3" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p1.10.m2.2.2.2.2.2.1.3" xref="S4.SS2.p1.10.m2.2.2.2.2.2.2.cmml">}</mo></mrow><mo stretchy="false" id="S4.SS2.p1.10.m2.2.2.2.2.5" xref="S4.SS2.p1.10.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m2.2b"><apply id="S4.SS2.p1.10.m2.2.2.cmml" xref="S4.SS2.p1.10.m2.2.2"><times id="S4.SS2.p1.10.m2.2.2.3.cmml" xref="S4.SS2.p1.10.m2.2.2.3"></times><ci id="S4.SS2.p1.10.m2.2.2.4.cmml" xref="S4.SS2.p1.10.m2.2.2.4">𝑆</ci><interval closure="open" id="S4.SS2.p1.10.m2.2.2.2.3.cmml" xref="S4.SS2.p1.10.m2.2.2.2.2"><set id="S4.SS2.p1.10.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1"><apply id="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.2">𝑷</ci><ci id="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.10.m2.1.1.1.1.1.1.1.3">𝑗</ci></apply></set><set id="S4.SS2.p1.10.m2.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1"><apply id="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.cmml" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.2.cmml" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.2">𝑷</ci><ci id="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.3.cmml" xref="S4.SS2.p1.10.m2.2.2.2.2.2.1.1.3">𝑖</ci></apply></set></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m2.2c">S(\{{\bm{P}}_{j}\},\{{\bm{P}}_{i}\})</annotation></semantics></math> is the similarity of prompt parameters of client <math id="S4.SS2.p1.11.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.11.m3.1a"><mi id="S4.SS2.p1.11.m3.1.1" xref="S4.SS2.p1.11.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m3.1b"><ci id="S4.SS2.p1.11.m3.1.1.cmml" xref="S4.SS2.p1.11.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m3.1c">i</annotation></semantics></math> and client <math id="S4.SS2.p1.12.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p1.12.m4.1a"><mi id="S4.SS2.p1.12.m4.1.1" xref="S4.SS2.p1.12.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m4.1b"><ci id="S4.SS2.p1.12.m4.1.1.cmml" xref="S4.SS2.p1.12.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m4.1c">j</annotation></semantics></math> measured by cosine or distance, <math id="S4.SS2.p1.13.m5.1" class="ltx_Math" alttext="G(\cdot)" display="inline"><semantics id="S4.SS2.p1.13.m5.1a"><mrow id="S4.SS2.p1.13.m5.1.2" xref="S4.SS2.p1.13.m5.1.2.cmml"><mi id="S4.SS2.p1.13.m5.1.2.2" xref="S4.SS2.p1.13.m5.1.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.13.m5.1.2.1" xref="S4.SS2.p1.13.m5.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.13.m5.1.2.3.2" xref="S4.SS2.p1.13.m5.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.13.m5.1.2.3.2.1" xref="S4.SS2.p1.13.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.13.m5.1.1" xref="S4.SS2.p1.13.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.13.m5.1.2.3.2.2" xref="S4.SS2.p1.13.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m5.1b"><apply id="S4.SS2.p1.13.m5.1.2.cmml" xref="S4.SS2.p1.13.m5.1.2"><times id="S4.SS2.p1.13.m5.1.2.1.cmml" xref="S4.SS2.p1.13.m5.1.2.1"></times><ci id="S4.SS2.p1.13.m5.1.2.2.cmml" xref="S4.SS2.p1.13.m5.1.2.2">𝐺</ci><ci id="S4.SS2.p1.13.m5.1.1.cmml" xref="S4.SS2.p1.13.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m5.1c">G(\cdot)</annotation></semantics></math> is the average operation. During the optimization of <span id="S4.SS2.p1.16.1" class="ltx_text ltx_font_italic">MetePFL</span>, each client update their model via solving the local objective function as <math id="S4.SS2.p1.14.m6.1" class="ltx_Math" alttext="{\mathcal{L}}_{k}" display="inline"><semantics id="S4.SS2.p1.14.m6.1a"><msub id="S4.SS2.p1.14.m6.1.1" xref="S4.SS2.p1.14.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.14.m6.1.1.2" xref="S4.SS2.p1.14.m6.1.1.2.cmml">ℒ</mi><mi id="S4.SS2.p1.14.m6.1.1.3" xref="S4.SS2.p1.14.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m6.1b"><apply id="S4.SS2.p1.14.m6.1.1.cmml" xref="S4.SS2.p1.14.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.14.m6.1.1.1.cmml" xref="S4.SS2.p1.14.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.14.m6.1.1.2.cmml" xref="S4.SS2.p1.14.m6.1.1.2">ℒ</ci><ci id="S4.SS2.p1.14.m6.1.1.3.cmml" xref="S4.SS2.p1.14.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m6.1c">{\mathcal{L}}_{k}</annotation></semantics></math> after them receive the fixed foundation model at first. Then each client upload their prompts <math id="S4.SS2.p1.15.m7.1" class="ltx_Math" alttext="{\bm{P}}" display="inline"><semantics id="S4.SS2.p1.15.m7.1a"><mi id="S4.SS2.p1.15.m7.1.1" xref="S4.SS2.p1.15.m7.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m7.1b"><ci id="S4.SS2.p1.15.m7.1.1.cmml" xref="S4.SS2.p1.15.m7.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m7.1c">{\bm{P}}</annotation></semantics></math> rather than complete model to the server that conduct graph-based aggregation, which significantly reduce the communication overhead while exploring the potential correlations among clients. The aggregation including two steps: Graph Attention Network (GAT) <cite class="ltx_cite ltx_citemacro_cite">Veličković <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite>-based graph structure learning that explore the dynamic correlations among clients and Graph Convolution Network (GCN) <cite class="ltx_cite ltx_citemacro_cite">Kipf and Welling (<a href="#bib.bib18" title="" class="ltx_ref">2016</a>)</cite> that utilized to parameters reconstruction using learned adjacent matrix <math id="S4.SS2.p1.16.m8.1" class="ltx_Math" alttext="{\bm{A}}" display="inline"><semantics id="S4.SS2.p1.16.m8.1a"><mi id="S4.SS2.p1.16.m8.1.1" xref="S4.SS2.p1.16.m8.1.1.cmml">𝑨</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.16.m8.1b"><ci id="S4.SS2.p1.16.m8.1.1.cmml" xref="S4.SS2.p1.16.m8.1.1">𝑨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.16.m8.1c">{\bm{A}}</annotation></semantics></math> and the prompt parameters uploaded by clients. The GCN automatically updates the parameters of each node by aggregating the models of its neighbors in the graph.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.5.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.6.2" class="ltx_text ltx_font_italic">MetePFL</span> algorithm.</figcaption>
<div id="alg1.7" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathbf{Initialized}" display="inline"><semantics id="alg1.l1.m1.1a"><mi mathsize="90%" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝐈𝐧𝐢𝐭𝐢𝐚𝐥𝐢𝐳𝐞𝐝</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐈𝐧𝐢𝐭𝐢𝐚𝐥𝐢𝐳𝐞𝐝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathbf{Initialized}</annotation></semantics></math><span id="alg1.l1.2" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l1.m2.1" class="ltx_Math" alttext="{\bm{P}}_{T}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑷</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">{\bm{P}}_{T}</annotation></semantics></math><span id="alg1.l1.3" class="ltx_text" style="font-size:90%;">, </span><math id="alg1.l1.m3.1" class="ltx_Math" alttext="{\bm{P}}_{S}" display="inline"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑷</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">{\bm{P}}_{S}</annotation></semantics></math><span id="alg1.l1.4" class="ltx_text" style="font-size:90%;">.
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span id="alg1.l2.1" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="\mathbf{for}" display="inline"><semantics id="alg1.l2.m1.1a"><mi mathsize="90%" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">𝐟𝐨𝐫</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝐟𝐨𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathbf{for}</annotation></semantics></math><span id="alg1.l2.2" class="ltx_text" style="font-size:90%;"> each communication round </span><math id="alg1.l2.m2.5" class="ltx_Math" alttext="t=0,1,2,\cdots,T" display="inline"><semantics id="alg1.l2.m2.5a"><mrow id="alg1.l2.m2.5.6" xref="alg1.l2.m2.5.6.cmml"><mi mathsize="90%" id="alg1.l2.m2.5.6.2" xref="alg1.l2.m2.5.6.2.cmml">t</mi><mo mathsize="90%" id="alg1.l2.m2.5.6.1" xref="alg1.l2.m2.5.6.1.cmml">=</mo><mrow id="alg1.l2.m2.5.6.3.2" xref="alg1.l2.m2.5.6.3.1.cmml"><mn mathsize="90%" id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">0</mn><mo mathsize="90%" id="alg1.l2.m2.5.6.3.2.1" xref="alg1.l2.m2.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml">1</mn><mo mathsize="90%" id="alg1.l2.m2.5.6.3.2.2" xref="alg1.l2.m2.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l2.m2.3.3" xref="alg1.l2.m2.3.3.cmml">2</mn><mo mathsize="90%" id="alg1.l2.m2.5.6.3.2.3" xref="alg1.l2.m2.5.6.3.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l2.m2.4.4" xref="alg1.l2.m2.4.4.cmml">⋯</mi><mo mathsize="90%" id="alg1.l2.m2.5.6.3.2.4" xref="alg1.l2.m2.5.6.3.1.cmml">,</mo><mi mathsize="90%" id="alg1.l2.m2.5.5" xref="alg1.l2.m2.5.5.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.5b"><apply id="alg1.l2.m2.5.6.cmml" xref="alg1.l2.m2.5.6"><eq id="alg1.l2.m2.5.6.1.cmml" xref="alg1.l2.m2.5.6.1"></eq><ci id="alg1.l2.m2.5.6.2.cmml" xref="alg1.l2.m2.5.6.2">𝑡</ci><list id="alg1.l2.m2.5.6.3.1.cmml" xref="alg1.l2.m2.5.6.3.2"><cn type="integer" id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">0</cn><cn type="integer" id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2">1</cn><cn type="integer" id="alg1.l2.m2.3.3.cmml" xref="alg1.l2.m2.3.3">2</cn><ci id="alg1.l2.m2.4.4.cmml" xref="alg1.l2.m2.4.4">⋯</ci><ci id="alg1.l2.m2.5.5.cmml" xref="alg1.l2.m2.5.5">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.5c">t=0,1,2,\cdots,T</annotation></semantics></math><span id="alg1.l2.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l2.m3.1" class="ltx_Math" alttext="\mathbf{do}" display="inline"><semantics id="alg1.l2.m3.1a"><mi mathsize="90%" id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">𝐝𝐨</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">𝐝𝐨</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\mathbf{do}</annotation></semantics></math><span id="alg1.l2.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span id="alg1.l3.1" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.l3.2" class="ltx_text ltx_font_bold ltx_font_italic" style="font-size:90%;">Local model initialize:</span><span id="alg1.l3.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span id="alg1.l4.1" class="ltx_text" style="font-size:90%;">   </span><math id="alg1.l4.m1.1" class="ltx_Math" alttext="\mathbf{for}" display="inline"><semantics id="alg1.l4.m1.1a"><mi mathsize="90%" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">𝐟𝐨𝐫</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝐟𝐨𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathbf{for}</annotation></semantics></math><span id="alg1.l4.2" class="ltx_text" style="font-size:90%;"> each client </span><math id="alg1.l4.m2.5" class="ltx_Math" alttext="i=0,1,2,...,N" display="inline"><semantics id="alg1.l4.m2.5a"><mrow id="alg1.l4.m2.5.6" xref="alg1.l4.m2.5.6.cmml"><mi mathsize="90%" id="alg1.l4.m2.5.6.2" xref="alg1.l4.m2.5.6.2.cmml">i</mi><mo mathsize="90%" id="alg1.l4.m2.5.6.1" xref="alg1.l4.m2.5.6.1.cmml">=</mo><mrow id="alg1.l4.m2.5.6.3.2" xref="alg1.l4.m2.5.6.3.1.cmml"><mn mathsize="90%" id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">0</mn><mo mathsize="90%" id="alg1.l4.m2.5.6.3.2.1" xref="alg1.l4.m2.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l4.m2.2.2" xref="alg1.l4.m2.2.2.cmml">1</mn><mo mathsize="90%" id="alg1.l4.m2.5.6.3.2.2" xref="alg1.l4.m2.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l4.m2.3.3" xref="alg1.l4.m2.3.3.cmml">2</mn><mo mathsize="90%" id="alg1.l4.m2.5.6.3.2.3" xref="alg1.l4.m2.5.6.3.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l4.m2.4.4" xref="alg1.l4.m2.4.4.cmml">…</mi><mo mathsize="90%" id="alg1.l4.m2.5.6.3.2.4" xref="alg1.l4.m2.5.6.3.1.cmml">,</mo><mi mathsize="90%" id="alg1.l4.m2.5.5" xref="alg1.l4.m2.5.5.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.5b"><apply id="alg1.l4.m2.5.6.cmml" xref="alg1.l4.m2.5.6"><eq id="alg1.l4.m2.5.6.1.cmml" xref="alg1.l4.m2.5.6.1"></eq><ci id="alg1.l4.m2.5.6.2.cmml" xref="alg1.l4.m2.5.6.2">𝑖</ci><list id="alg1.l4.m2.5.6.3.1.cmml" xref="alg1.l4.m2.5.6.3.2"><cn type="integer" id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">0</cn><cn type="integer" id="alg1.l4.m2.2.2.cmml" xref="alg1.l4.m2.2.2">1</cn><cn type="integer" id="alg1.l4.m2.3.3.cmml" xref="alg1.l4.m2.3.3">2</cn><ci id="alg1.l4.m2.4.4.cmml" xref="alg1.l4.m2.4.4">…</ci><ci id="alg1.l4.m2.5.5.cmml" xref="alg1.l4.m2.5.5">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.5c">i=0,1,2,...,N</annotation></semantics></math><span id="alg1.l4.3" class="ltx_text" style="font-size:90%;"> in parallel </span><math id="alg1.l4.m3.1" class="ltx_Math" alttext="\mathbf{do}" display="inline"><semantics id="alg1.l4.m3.1a"><mi mathsize="90%" id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml">𝐝𝐨</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><ci id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1">𝐝𝐨</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">\mathbf{do}</annotation></semantics></math><span id="alg1.l4.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span id="alg1.l5.1" class="ltx_text" style="font-size:90%;">    </span><math id="alg1.l5.m1.2" class="ltx_Math" alttext="0\leftarrow{\bm{P}}_{T},{\bm{P}}_{S}" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><mn mathsize="90%" id="alg1.l5.m1.2.2.4" xref="alg1.l5.m1.2.2.4.cmml">0</mn><mo mathsize="90%" stretchy="false" id="alg1.l5.m1.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">←</mo><mrow id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.3.cmml"><msub id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.3.cmml">T</mi></msub><mo mathsize="90%" id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l5.m1.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l5.m1.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">S</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><ci id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3">←</ci><cn type="integer" id="alg1.l5.m1.2.2.4.cmml" xref="alg1.l5.m1.2.2.4">0</cn><list id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.2">𝑷</ci><ci id="alg1.l5.m1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.3">𝑇</ci></apply><apply id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2">𝑷</ci><ci id="alg1.l5.m1.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.3">𝑆</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">0\leftarrow{\bm{P}}_{T},{\bm{P}}_{S}</annotation></semantics></math><span id="alg1.l5.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span id="alg1.l6.1" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.l6.2" class="ltx_text ltx_font_bold ltx_font_italic" style="font-size:90%;">Local model update:</span><span id="alg1.l6.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span id="alg1.l7.1" class="ltx_text" style="font-size:90%;">   </span><math id="alg1.l7.m1.1" class="ltx_Math" alttext="\mathbf{for}" display="inline"><semantics id="alg1.l7.m1.1a"><mi mathsize="90%" id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">𝐟𝐨𝐫</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝐟𝐨𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathbf{for}</annotation></semantics></math><span id="alg1.l7.2" class="ltx_text" style="font-size:90%;"> each client </span><math id="alg1.l7.m2.5" class="ltx_Math" alttext="i=0,1,2,\cdots,N" display="inline"><semantics id="alg1.l7.m2.5a"><mrow id="alg1.l7.m2.5.6" xref="alg1.l7.m2.5.6.cmml"><mi mathsize="90%" id="alg1.l7.m2.5.6.2" xref="alg1.l7.m2.5.6.2.cmml">i</mi><mo mathsize="90%" id="alg1.l7.m2.5.6.1" xref="alg1.l7.m2.5.6.1.cmml">=</mo><mrow id="alg1.l7.m2.5.6.3.2" xref="alg1.l7.m2.5.6.3.1.cmml"><mn mathsize="90%" id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">0</mn><mo mathsize="90%" id="alg1.l7.m2.5.6.3.2.1" xref="alg1.l7.m2.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l7.m2.2.2" xref="alg1.l7.m2.2.2.cmml">1</mn><mo mathsize="90%" id="alg1.l7.m2.5.6.3.2.2" xref="alg1.l7.m2.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l7.m2.3.3" xref="alg1.l7.m2.3.3.cmml">2</mn><mo mathsize="90%" id="alg1.l7.m2.5.6.3.2.3" xref="alg1.l7.m2.5.6.3.1.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l7.m2.4.4" xref="alg1.l7.m2.4.4.cmml">⋯</mi><mo mathsize="90%" id="alg1.l7.m2.5.6.3.2.4" xref="alg1.l7.m2.5.6.3.1.cmml">,</mo><mi mathsize="90%" id="alg1.l7.m2.5.5" xref="alg1.l7.m2.5.5.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.5b"><apply id="alg1.l7.m2.5.6.cmml" xref="alg1.l7.m2.5.6"><eq id="alg1.l7.m2.5.6.1.cmml" xref="alg1.l7.m2.5.6.1"></eq><ci id="alg1.l7.m2.5.6.2.cmml" xref="alg1.l7.m2.5.6.2">𝑖</ci><list id="alg1.l7.m2.5.6.3.1.cmml" xref="alg1.l7.m2.5.6.3.2"><cn type="integer" id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">0</cn><cn type="integer" id="alg1.l7.m2.2.2.cmml" xref="alg1.l7.m2.2.2">1</cn><cn type="integer" id="alg1.l7.m2.3.3.cmml" xref="alg1.l7.m2.3.3">2</cn><ci id="alg1.l7.m2.4.4.cmml" xref="alg1.l7.m2.4.4">⋯</ci><ci id="alg1.l7.m2.5.5.cmml" xref="alg1.l7.m2.5.5">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.5c">i=0,1,2,\cdots,N</annotation></semantics></math><span id="alg1.l7.3" class="ltx_text" style="font-size:90%;"> in parallel </span><math id="alg1.l7.m3.1" class="ltx_Math" alttext="\mathbf{do}" display="inline"><semantics id="alg1.l7.m3.1a"><mi mathsize="90%" id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml">𝐝𝐨</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><ci id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1">𝐝𝐨</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">\mathbf{do}</annotation></semantics></math><span id="alg1.l7.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span id="alg1.l8.1" class="ltx_text" style="font-size:90%;">    Update </span><math id="alg1.l8.m1.1" class="ltx_Math" alttext="{\bm{P}}_{T}" display="inline"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑷</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">{\bm{P}}_{T}</annotation></semantics></math><span id="alg1.l8.2" class="ltx_text" style="font-size:90%;">, </span><math id="alg1.l8.m2.1" class="ltx_Math" alttext="{\bm{P}}_{S}" display="inline"><semantics id="alg1.l8.m2.1a"><msub id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">𝑷</ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">{\bm{P}}_{S}</annotation></semantics></math><span id="alg1.l8.3" class="ltx_text" style="font-size:90%;"> for </span><math id="alg1.l8.m3.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg1.l8.m3.1a"><mi mathsize="90%" id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><ci id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">e</annotation></semantics></math><span id="alg1.l8.4" class="ltx_text" style="font-size:90%;"> local steps:
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span id="alg1.l9.1" class="ltx_text" style="font-size:90%;">    Train </span><math id="alg1.l9.m1.1" class="ltx_Math" alttext="{\bm{P}}_{T}" display="inline"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑷</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">{\bm{P}}_{T}</annotation></semantics></math><span id="alg1.l9.2" class="ltx_text" style="font-size:90%;">, </span><math id="alg1.l9.m2.1" class="ltx_Math" alttext="{\bm{P}}_{S}" display="inline"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑷</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">{\bm{P}}_{S}</annotation></semantics></math><span id="alg1.l9.3" class="ltx_text" style="font-size:90%;"> with loss function </span><math id="alg1.l9.m3.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="alg1.l9.m3.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><ci id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">\mathcal{L}</annotation></semantics></math><span id="alg1.l9.4" class="ltx_text" style="font-size:90%;"> in Eq.(11)
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span id="alg1.l10.1" class="ltx_text" style="font-size:90%;">   </span><math id="alg1.l10.m1.1" class="ltx_Math" alttext="\mathbf{end}" display="inline"><semantics id="alg1.l10.m1.1a"><mi mathsize="90%" id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">𝐞𝐧𝐝</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝐞𝐧𝐝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathbf{end}</annotation></semantics></math><span id="alg1.l10.2" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l10.m2.1" class="ltx_Math" alttext="\mathbf{for}" display="inline"><semantics id="alg1.l10.m2.1a"><mi mathsize="90%" id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">𝐟𝐨𝐫</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝐟𝐨𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\mathbf{for}</annotation></semantics></math><span id="alg1.l10.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span id="alg1.l11.1" class="ltx_text" style="font-size:90%;">  Each selected client sends </span><math id="alg1.l11.m1.1" class="ltx_Math" alttext="{\bm{P}}_{T}" display="inline"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑷</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">{\bm{P}}_{T}</annotation></semantics></math><span id="alg1.l11.2" class="ltx_text" style="font-size:90%;">, </span><math id="alg1.l11.m2.1" class="ltx_Math" alttext="{\bm{P}}_{S}" display="inline"><semantics id="alg1.l11.m2.1a"><msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑷</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">{\bm{P}}_{S}</annotation></semantics></math><span id="alg1.l11.3" class="ltx_text" style="font-size:90%;"> to the server
</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span id="alg1.l12.1" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l12.2" class="ltx_text ltx_font_bold ltx_font_italic" style="font-size:90%;">Aggregation:</span><span id="alg1.l12.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span id="alg1.l13.1" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l13.m1.4" class="ltx_Math" alttext="{\bm{A}}\leftarrow GraphGenerator(\{{\bm{P}}_{1}\},\{{\bm{P}}_{2}\},\cdots,\{{\bm{P}}_{N}\})" display="inline"><semantics id="alg1.l13.m1.4a"><mrow id="alg1.l13.m1.4.4" xref="alg1.l13.m1.4.4.cmml"><mi mathsize="90%" id="alg1.l13.m1.4.4.5" xref="alg1.l13.m1.4.4.5.cmml">𝑨</mi><mo mathsize="90%" stretchy="false" id="alg1.l13.m1.4.4.4" xref="alg1.l13.m1.4.4.4.cmml">←</mo><mrow id="alg1.l13.m1.4.4.3" xref="alg1.l13.m1.4.4.3.cmml"><mi mathsize="90%" id="alg1.l13.m1.4.4.3.5" xref="alg1.l13.m1.4.4.3.5.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.6" xref="alg1.l13.m1.4.4.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4a" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.7" xref="alg1.l13.m1.4.4.3.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4b" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.8" xref="alg1.l13.m1.4.4.3.8.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4c" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.9" xref="alg1.l13.m1.4.4.3.9.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4d" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.10" xref="alg1.l13.m1.4.4.3.10.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4e" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.11" xref="alg1.l13.m1.4.4.3.11.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4f" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.12" xref="alg1.l13.m1.4.4.3.12.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4g" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.13" xref="alg1.l13.m1.4.4.3.13.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4h" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.14" xref="alg1.l13.m1.4.4.3.14.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4i" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.15" xref="alg1.l13.m1.4.4.3.15.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4j" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.16" xref="alg1.l13.m1.4.4.3.16.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4k" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.17" xref="alg1.l13.m1.4.4.3.17.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4l" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mi mathsize="90%" id="alg1.l13.m1.4.4.3.18" xref="alg1.l13.m1.4.4.3.18.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.4.4.3.4m" xref="alg1.l13.m1.4.4.3.4.cmml">​</mo><mrow id="alg1.l13.m1.4.4.3.3.3" xref="alg1.l13.m1.4.4.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.4.4.3.3.3.4" xref="alg1.l13.m1.4.4.3.3.4.cmml">(</mo><mrow id="alg1.l13.m1.2.2.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.2.2.1.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.1.2.cmml">{</mo><msub id="alg1.l13.m1.2.2.1.1.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l13.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.2.cmml">𝑷</mi><mn mathsize="90%" id="alg1.l13.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.2.2.1.1.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.1.1.2.cmml">}</mo></mrow><mo mathsize="90%" id="alg1.l13.m1.4.4.3.3.3.5" xref="alg1.l13.m1.4.4.3.3.4.cmml">,</mo><mrow id="alg1.l13.m1.3.3.2.2.2.2.1" xref="alg1.l13.m1.3.3.2.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.3.3.2.2.2.2.1.2" xref="alg1.l13.m1.3.3.2.2.2.2.2.cmml">{</mo><msub id="alg1.l13.m1.3.3.2.2.2.2.1.1" xref="alg1.l13.m1.3.3.2.2.2.2.1.1.cmml"><mi mathsize="90%" id="alg1.l13.m1.3.3.2.2.2.2.1.1.2" xref="alg1.l13.m1.3.3.2.2.2.2.1.1.2.cmml">𝑷</mi><mn mathsize="90%" id="alg1.l13.m1.3.3.2.2.2.2.1.1.3" xref="alg1.l13.m1.3.3.2.2.2.2.1.1.3.cmml">2</mn></msub><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.3.3.2.2.2.2.1.3" xref="alg1.l13.m1.3.3.2.2.2.2.2.cmml">}</mo></mrow><mo mathsize="90%" id="alg1.l13.m1.4.4.3.3.3.6" xref="alg1.l13.m1.4.4.3.3.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">⋯</mi><mo mathsize="90%" id="alg1.l13.m1.4.4.3.3.3.7" xref="alg1.l13.m1.4.4.3.3.4.cmml">,</mo><mrow id="alg1.l13.m1.4.4.3.3.3.3.1" xref="alg1.l13.m1.4.4.3.3.3.3.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.4.4.3.3.3.3.1.2" xref="alg1.l13.m1.4.4.3.3.3.3.2.cmml">{</mo><msub id="alg1.l13.m1.4.4.3.3.3.3.1.1" xref="alg1.l13.m1.4.4.3.3.3.3.1.1.cmml"><mi mathsize="90%" id="alg1.l13.m1.4.4.3.3.3.3.1.1.2" xref="alg1.l13.m1.4.4.3.3.3.3.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l13.m1.4.4.3.3.3.3.1.1.3" xref="alg1.l13.m1.4.4.3.3.3.3.1.1.3.cmml">N</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.4.4.3.3.3.3.1.3" xref="alg1.l13.m1.4.4.3.3.3.3.2.cmml">}</mo></mrow><mo maxsize="90%" minsize="90%" id="alg1.l13.m1.4.4.3.3.3.8" xref="alg1.l13.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.4b"><apply id="alg1.l13.m1.4.4.cmml" xref="alg1.l13.m1.4.4"><ci id="alg1.l13.m1.4.4.4.cmml" xref="alg1.l13.m1.4.4.4">←</ci><ci id="alg1.l13.m1.4.4.5.cmml" xref="alg1.l13.m1.4.4.5">𝑨</ci><apply id="alg1.l13.m1.4.4.3.cmml" xref="alg1.l13.m1.4.4.3"><times id="alg1.l13.m1.4.4.3.4.cmml" xref="alg1.l13.m1.4.4.3.4"></times><ci id="alg1.l13.m1.4.4.3.5.cmml" xref="alg1.l13.m1.4.4.3.5">𝐺</ci><ci id="alg1.l13.m1.4.4.3.6.cmml" xref="alg1.l13.m1.4.4.3.6">𝑟</ci><ci id="alg1.l13.m1.4.4.3.7.cmml" xref="alg1.l13.m1.4.4.3.7">𝑎</ci><ci id="alg1.l13.m1.4.4.3.8.cmml" xref="alg1.l13.m1.4.4.3.8">𝑝</ci><ci id="alg1.l13.m1.4.4.3.9.cmml" xref="alg1.l13.m1.4.4.3.9">ℎ</ci><ci id="alg1.l13.m1.4.4.3.10.cmml" xref="alg1.l13.m1.4.4.3.10">𝐺</ci><ci id="alg1.l13.m1.4.4.3.11.cmml" xref="alg1.l13.m1.4.4.3.11">𝑒</ci><ci id="alg1.l13.m1.4.4.3.12.cmml" xref="alg1.l13.m1.4.4.3.12">𝑛</ci><ci id="alg1.l13.m1.4.4.3.13.cmml" xref="alg1.l13.m1.4.4.3.13">𝑒</ci><ci id="alg1.l13.m1.4.4.3.14.cmml" xref="alg1.l13.m1.4.4.3.14">𝑟</ci><ci id="alg1.l13.m1.4.4.3.15.cmml" xref="alg1.l13.m1.4.4.3.15">𝑎</ci><ci id="alg1.l13.m1.4.4.3.16.cmml" xref="alg1.l13.m1.4.4.3.16">𝑡</ci><ci id="alg1.l13.m1.4.4.3.17.cmml" xref="alg1.l13.m1.4.4.3.17">𝑜</ci><ci id="alg1.l13.m1.4.4.3.18.cmml" xref="alg1.l13.m1.4.4.3.18">𝑟</ci><vector id="alg1.l13.m1.4.4.3.3.4.cmml" xref="alg1.l13.m1.4.4.3.3.3"><set id="alg1.l13.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1"><apply id="alg1.l13.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.2">𝑷</ci><cn type="integer" id="alg1.l13.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.1.1.3">1</cn></apply></set><set id="alg1.l13.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.1"><apply id="alg1.l13.m1.3.3.2.2.2.2.1.1.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.2.2.2.2.1.1.1.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.1.1">subscript</csymbol><ci id="alg1.l13.m1.3.3.2.2.2.2.1.1.2.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.1.1.2">𝑷</ci><cn type="integer" id="alg1.l13.m1.3.3.2.2.2.2.1.1.3.cmml" xref="alg1.l13.m1.3.3.2.2.2.2.1.1.3">2</cn></apply></set><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">⋯</ci><set id="alg1.l13.m1.4.4.3.3.3.3.2.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.1"><apply id="alg1.l13.m1.4.4.3.3.3.3.1.1.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.4.4.3.3.3.3.1.1.1.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.1.1">subscript</csymbol><ci id="alg1.l13.m1.4.4.3.3.3.3.1.1.2.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.1.1.2">𝑷</ci><ci id="alg1.l13.m1.4.4.3.3.3.3.1.1.3.cmml" xref="alg1.l13.m1.4.4.3.3.3.3.1.1.3">𝑁</ci></apply></set></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.4c">{\bm{A}}\leftarrow GraphGenerator(\{{\bm{P}}_{1}\},\{{\bm{P}}_{2}\},\cdots,\{{\bm{P}}_{N}\})</annotation></semantics></math><span id="alg1.l13.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span id="alg1.l14.1" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l14.m1.1" class="ltx_Math" alttext="{\bm{A}}^{\prime}\leftarrow GAT({\bm{A}})" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.2" xref="alg1.l14.m1.1.2.cmml"><msup id="alg1.l14.m1.1.2.2" xref="alg1.l14.m1.1.2.2.cmml"><mi mathsize="90%" id="alg1.l14.m1.1.2.2.2" xref="alg1.l14.m1.1.2.2.2.cmml">𝑨</mi><mo mathsize="90%" id="alg1.l14.m1.1.2.2.3" xref="alg1.l14.m1.1.2.2.3.cmml">′</mo></msup><mo mathsize="90%" stretchy="false" id="alg1.l14.m1.1.2.1" xref="alg1.l14.m1.1.2.1.cmml">←</mo><mrow id="alg1.l14.m1.1.2.3" xref="alg1.l14.m1.1.2.3.cmml"><mi mathsize="90%" id="alg1.l14.m1.1.2.3.2" xref="alg1.l14.m1.1.2.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.2.3.1" xref="alg1.l14.m1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.l14.m1.1.2.3.3" xref="alg1.l14.m1.1.2.3.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.2.3.1a" xref="alg1.l14.m1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.l14.m1.1.2.3.4" xref="alg1.l14.m1.1.2.3.4.cmml">T</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.2.3.1b" xref="alg1.l14.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l14.m1.1.2.3.5.2" xref="alg1.l14.m1.1.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l14.m1.1.2.3.5.2.1" xref="alg1.l14.m1.1.2.3.cmml">(</mo><mi mathsize="90%" id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">𝑨</mi><mo maxsize="90%" minsize="90%" id="alg1.l14.m1.1.2.3.5.2.2" xref="alg1.l14.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.2.cmml" xref="alg1.l14.m1.1.2"><ci id="alg1.l14.m1.1.2.1.cmml" xref="alg1.l14.m1.1.2.1">←</ci><apply id="alg1.l14.m1.1.2.2.cmml" xref="alg1.l14.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.2.2.1.cmml" xref="alg1.l14.m1.1.2.2">superscript</csymbol><ci id="alg1.l14.m1.1.2.2.2.cmml" xref="alg1.l14.m1.1.2.2.2">𝑨</ci><ci id="alg1.l14.m1.1.2.2.3.cmml" xref="alg1.l14.m1.1.2.2.3">′</ci></apply><apply id="alg1.l14.m1.1.2.3.cmml" xref="alg1.l14.m1.1.2.3"><times id="alg1.l14.m1.1.2.3.1.cmml" xref="alg1.l14.m1.1.2.3.1"></times><ci id="alg1.l14.m1.1.2.3.2.cmml" xref="alg1.l14.m1.1.2.3.2">𝐺</ci><ci id="alg1.l14.m1.1.2.3.3.cmml" xref="alg1.l14.m1.1.2.3.3">𝐴</ci><ci id="alg1.l14.m1.1.2.3.4.cmml" xref="alg1.l14.m1.1.2.3.4">𝑇</ci><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">{\bm{A}}^{\prime}\leftarrow GAT({\bm{A}})</annotation></semantics></math><span id="alg1.l14.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span id="alg1.l15.1" class="ltx_text" style="font-size:90%;">  Update </span><math id="alg1.l15.m1.1" class="ltx_Math" alttext="{\bm{P}}" display="inline"><semantics id="alg1.l15.m1.1a"><mi mathsize="90%" id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">{\bm{P}}</annotation></semantics></math><span id="alg1.l15.2" class="ltx_text" style="font-size:90%;"> for </span><math id="alg1.l15.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg1.l15.m2.1a"><mi mathsize="90%" id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><ci id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">r</annotation></semantics></math><span id="alg1.l15.3" class="ltx_text" style="font-size:90%;"> steps </span><math id="alg1.l15.m3.2" class="ltx_Math" alttext="GCN({\bm{A}}^{\prime},\{{\bm{P}}_{i}\}^{N}_{i=1})" display="inline"><semantics id="alg1.l15.m3.2a"><mrow id="alg1.l15.m3.2.2" xref="alg1.l15.m3.2.2.cmml"><mi mathsize="90%" id="alg1.l15.m3.2.2.4" xref="alg1.l15.m3.2.2.4.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m3.2.2.3" xref="alg1.l15.m3.2.2.3.cmml">​</mo><mi mathsize="90%" id="alg1.l15.m3.2.2.5" xref="alg1.l15.m3.2.2.5.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m3.2.2.3a" xref="alg1.l15.m3.2.2.3.cmml">​</mo><mi mathsize="90%" id="alg1.l15.m3.2.2.6" xref="alg1.l15.m3.2.2.6.cmml">N</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m3.2.2.3b" xref="alg1.l15.m3.2.2.3.cmml">​</mo><mrow id="alg1.l15.m3.2.2.2.2" xref="alg1.l15.m3.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l15.m3.2.2.2.2.3" xref="alg1.l15.m3.2.2.2.3.cmml">(</mo><msup id="alg1.l15.m3.1.1.1.1.1" xref="alg1.l15.m3.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l15.m3.1.1.1.1.1.2" xref="alg1.l15.m3.1.1.1.1.1.2.cmml">𝑨</mi><mo mathsize="90%" id="alg1.l15.m3.1.1.1.1.1.3" xref="alg1.l15.m3.1.1.1.1.1.3.cmml">′</mo></msup><mo mathsize="90%" id="alg1.l15.m3.2.2.2.2.4" xref="alg1.l15.m3.2.2.2.3.cmml">,</mo><msubsup id="alg1.l15.m3.2.2.2.2.2" xref="alg1.l15.m3.2.2.2.2.2.cmml"><mrow id="alg1.l15.m3.2.2.2.2.2.1.1.1" xref="alg1.l15.m3.2.2.2.2.2.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l15.m3.2.2.2.2.2.1.1.1.2" xref="alg1.l15.m3.2.2.2.2.2.1.1.2.cmml">{</mo><msub id="alg1.l15.m3.2.2.2.2.2.1.1.1.1" xref="alg1.l15.m3.2.2.2.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l15.m3.2.2.2.2.2.1.1.1.1.2" xref="alg1.l15.m3.2.2.2.2.2.1.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l15.m3.2.2.2.2.2.1.1.1.1.3" xref="alg1.l15.m3.2.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l15.m3.2.2.2.2.2.1.1.1.3" xref="alg1.l15.m3.2.2.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l15.m3.2.2.2.2.2.3" xref="alg1.l15.m3.2.2.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l15.m3.2.2.2.2.2.3.2" xref="alg1.l15.m3.2.2.2.2.2.3.2.cmml">i</mi><mo mathsize="90%" id="alg1.l15.m3.2.2.2.2.2.3.1" xref="alg1.l15.m3.2.2.2.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.l15.m3.2.2.2.2.2.3.3" xref="alg1.l15.m3.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l15.m3.2.2.2.2.2.1.3" xref="alg1.l15.m3.2.2.2.2.2.1.3.cmml">N</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l15.m3.2.2.2.2.5" xref="alg1.l15.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m3.2b"><apply id="alg1.l15.m3.2.2.cmml" xref="alg1.l15.m3.2.2"><times id="alg1.l15.m3.2.2.3.cmml" xref="alg1.l15.m3.2.2.3"></times><ci id="alg1.l15.m3.2.2.4.cmml" xref="alg1.l15.m3.2.2.4">𝐺</ci><ci id="alg1.l15.m3.2.2.5.cmml" xref="alg1.l15.m3.2.2.5">𝐶</ci><ci id="alg1.l15.m3.2.2.6.cmml" xref="alg1.l15.m3.2.2.6">𝑁</ci><interval closure="open" id="alg1.l15.m3.2.2.2.3.cmml" xref="alg1.l15.m3.2.2.2.2"><apply id="alg1.l15.m3.1.1.1.1.1.cmml" xref="alg1.l15.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m3.1.1.1.1.1.1.cmml" xref="alg1.l15.m3.1.1.1.1.1">superscript</csymbol><ci id="alg1.l15.m3.1.1.1.1.1.2.cmml" xref="alg1.l15.m3.1.1.1.1.1.2">𝑨</ci><ci id="alg1.l15.m3.1.1.1.1.1.3.cmml" xref="alg1.l15.m3.1.1.1.1.1.3">′</ci></apply><apply id="alg1.l15.m3.2.2.2.2.2.cmml" xref="alg1.l15.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m3.2.2.2.2.2.2.cmml" xref="alg1.l15.m3.2.2.2.2.2">subscript</csymbol><apply id="alg1.l15.m3.2.2.2.2.2.1.cmml" xref="alg1.l15.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m3.2.2.2.2.2.1.2.cmml" xref="alg1.l15.m3.2.2.2.2.2">superscript</csymbol><set id="alg1.l15.m3.2.2.2.2.2.1.1.2.cmml" xref="alg1.l15.m3.2.2.2.2.2.1.1.1"><apply id="alg1.l15.m3.2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l15.m3.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m3.2.2.2.2.2.1.1.1.1.1.cmml" xref="alg1.l15.m3.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m3.2.2.2.2.2.1.1.1.1.2.cmml" xref="alg1.l15.m3.2.2.2.2.2.1.1.1.1.2">𝑷</ci><ci id="alg1.l15.m3.2.2.2.2.2.1.1.1.1.3.cmml" xref="alg1.l15.m3.2.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></set><ci id="alg1.l15.m3.2.2.2.2.2.1.3.cmml" xref="alg1.l15.m3.2.2.2.2.2.1.3">𝑁</ci></apply><apply id="alg1.l15.m3.2.2.2.2.2.3.cmml" xref="alg1.l15.m3.2.2.2.2.2.3"><eq id="alg1.l15.m3.2.2.2.2.2.3.1.cmml" xref="alg1.l15.m3.2.2.2.2.2.3.1"></eq><ci id="alg1.l15.m3.2.2.2.2.2.3.2.cmml" xref="alg1.l15.m3.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="alg1.l15.m3.2.2.2.2.2.3.3.cmml" xref="alg1.l15.m3.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m3.2c">GCN({\bm{A}}^{\prime},\{{\bm{P}}_{i}\}^{N}_{i=1})</annotation></semantics></math><span id="alg1.l15.4" class="ltx_text" style="font-size:90%;">:
</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span id="alg1.l16.1" class="ltx_text" style="font-size:90%;">   </span><math id="alg1.l16.m1.2" class="ltx_Math" alttext="\{{\bm{P}}_{i}^{s}\}^{N}_{i=1}={\bm{A}}^{\prime}\{{\bm{P}}_{i}\}^{N}_{i=1}" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml"><msubsup id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l16.m1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.2.cmml">{</mo><msubsup id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l16.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l16.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.l16.m1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l16.m1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.cmml">i</mi><mo mathsize="90%" id="alg1.l16.m1.1.1.1.3.1" xref="alg1.l16.m1.1.1.1.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.l16.m1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l16.m1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.3.cmml">N</mi></msubsup><mo mathsize="90%" id="alg1.l16.m1.2.2.3" xref="alg1.l16.m1.2.2.3.cmml">=</mo><mrow id="alg1.l16.m1.2.2.2" xref="alg1.l16.m1.2.2.2.cmml"><msup id="alg1.l16.m1.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.l16.m1.2.2.2.3.2" xref="alg1.l16.m1.2.2.2.3.2.cmml">𝑨</mi><mo mathsize="90%" id="alg1.l16.m1.2.2.2.3.3" xref="alg1.l16.m1.2.2.2.3.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.cmml">​</mo><msubsup id="alg1.l16.m1.2.2.2.1" xref="alg1.l16.m1.2.2.2.1.cmml"><mrow id="alg1.l16.m1.2.2.2.1.1.1.1" xref="alg1.l16.m1.2.2.2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l16.m1.2.2.2.1.1.1.1.2" xref="alg1.l16.m1.2.2.2.1.1.1.2.cmml">{</mo><msub id="alg1.l16.m1.2.2.2.1.1.1.1.1" xref="alg1.l16.m1.2.2.2.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l16.m1.2.2.2.1.1.1.1.1.2" xref="alg1.l16.m1.2.2.2.1.1.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l16.m1.2.2.2.1.1.1.1.1.3" xref="alg1.l16.m1.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l16.m1.2.2.2.1.1.1.1.3" xref="alg1.l16.m1.2.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l16.m1.2.2.2.1.3" xref="alg1.l16.m1.2.2.2.1.3.cmml"><mi mathsize="90%" id="alg1.l16.m1.2.2.2.1.3.2" xref="alg1.l16.m1.2.2.2.1.3.2.cmml">i</mi><mo mathsize="90%" id="alg1.l16.m1.2.2.2.1.3.1" xref="alg1.l16.m1.2.2.2.1.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.l16.m1.2.2.2.1.3.3" xref="alg1.l16.m1.2.2.2.1.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l16.m1.2.2.2.1.1.3" xref="alg1.l16.m1.2.2.2.1.1.3.cmml">N</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2"><eq id="alg1.l16.m1.2.2.3.cmml" xref="alg1.l16.m1.2.2.3"></eq><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1">subscript</csymbol><apply id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1">superscript</csymbol><set id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1"><apply id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.2">𝑷</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="alg1.l16.m1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.3">𝑁</ci></apply><apply id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3"><eq id="alg1.l16.m1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3.1"></eq><ci id="alg1.l16.m1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l16.m1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l16.m1.2.2.2.cmml" xref="alg1.l16.m1.2.2.2"><times id="alg1.l16.m1.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2"></times><apply id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.3.1.cmml" xref="alg1.l16.m1.2.2.2.3">superscript</csymbol><ci id="alg1.l16.m1.2.2.2.3.2.cmml" xref="alg1.l16.m1.2.2.2.3.2">𝑨</ci><ci id="alg1.l16.m1.2.2.2.3.3.cmml" xref="alg1.l16.m1.2.2.2.3.3">′</ci></apply><apply id="alg1.l16.m1.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.1.2.cmml" xref="alg1.l16.m1.2.2.2.1">subscript</csymbol><apply id="alg1.l16.m1.2.2.2.1.1.cmml" xref="alg1.l16.m1.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.1.1.2.cmml" xref="alg1.l16.m1.2.2.2.1">superscript</csymbol><set id="alg1.l16.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.2.1.1.1.1"><apply id="alg1.l16.m1.2.2.2.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.2.2.2.1.1.1.1.1.2">𝑷</ci><ci id="alg1.l16.m1.2.2.2.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="alg1.l16.m1.2.2.2.1.1.3.cmml" xref="alg1.l16.m1.2.2.2.1.1.3">𝑁</ci></apply><apply id="alg1.l16.m1.2.2.2.1.3.cmml" xref="alg1.l16.m1.2.2.2.1.3"><eq id="alg1.l16.m1.2.2.2.1.3.1.cmml" xref="alg1.l16.m1.2.2.2.1.3.1"></eq><ci id="alg1.l16.m1.2.2.2.1.3.2.cmml" xref="alg1.l16.m1.2.2.2.1.3.2">𝑖</ci><cn type="integer" id="alg1.l16.m1.2.2.2.1.3.3.cmml" xref="alg1.l16.m1.2.2.2.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">\{{\bm{P}}_{i}^{s}\}^{N}_{i=1}={\bm{A}}^{\prime}\{{\bm{P}}_{i}\}^{N}_{i=1}</annotation></semantics></math><span id="alg1.l16.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span id="alg1.l17.1" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l17.m1.4" class="ltx_Math" alttext="\{{\bm{P}}_{i}^{s}\}^{N}_{i=1}=\alpha\{{\bm{P}}_{i}^{s}\}^{N}_{i=1}+(1-\alpha)\{{\bm{P}}_{i}\}^{N}_{i=1}" display="inline"><semantics id="alg1.l17.m1.4a"><mrow id="alg1.l17.m1.4.4" xref="alg1.l17.m1.4.4.cmml"><msubsup id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.2.cmml">{</mo><msubsup id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l17.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l17.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.l17.m1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.3.2.cmml">i</mi><mo mathsize="90%" id="alg1.l17.m1.1.1.1.3.1" xref="alg1.l17.m1.1.1.1.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.l17.m1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l17.m1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.3.cmml">N</mi></msubsup><mo mathsize="90%" id="alg1.l17.m1.4.4.5" xref="alg1.l17.m1.4.4.5.cmml">=</mo><mrow id="alg1.l17.m1.4.4.4" xref="alg1.l17.m1.4.4.4.cmml"><mrow id="alg1.l17.m1.2.2.2.1" xref="alg1.l17.m1.2.2.2.1.cmml"><mi mathsize="90%" id="alg1.l17.m1.2.2.2.1.3" xref="alg1.l17.m1.2.2.2.1.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.2.2.2.1.2" xref="alg1.l17.m1.2.2.2.1.2.cmml">​</mo><msubsup id="alg1.l17.m1.2.2.2.1.1" xref="alg1.l17.m1.2.2.2.1.1.cmml"><mrow id="alg1.l17.m1.2.2.2.1.1.1.1.1" xref="alg1.l17.m1.2.2.2.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.2.2.2.1.1.1.1.1.2" xref="alg1.l17.m1.2.2.2.1.1.1.1.2.cmml">{</mo><msubsup id="alg1.l17.m1.2.2.2.1.1.1.1.1.1" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.3" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.3" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.2.2.2.1.1.1.1.1.3" xref="alg1.l17.m1.2.2.2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l17.m1.2.2.2.1.1.3" xref="alg1.l17.m1.2.2.2.1.1.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.2.2.2.1.1.3.2" xref="alg1.l17.m1.2.2.2.1.1.3.2.cmml">i</mi><mo mathsize="90%" id="alg1.l17.m1.2.2.2.1.1.3.1" xref="alg1.l17.m1.2.2.2.1.1.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.l17.m1.2.2.2.1.1.3.3" xref="alg1.l17.m1.2.2.2.1.1.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l17.m1.2.2.2.1.1.1.3" xref="alg1.l17.m1.2.2.2.1.1.1.3.cmml">N</mi></msubsup></mrow><mo mathsize="90%" id="alg1.l17.m1.4.4.4.4" xref="alg1.l17.m1.4.4.4.4.cmml">+</mo><mrow id="alg1.l17.m1.4.4.4.3" xref="alg1.l17.m1.4.4.4.3.cmml"><mrow id="alg1.l17.m1.3.3.3.2.1.1" xref="alg1.l17.m1.3.3.3.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.3.3.3.2.1.1.2" xref="alg1.l17.m1.3.3.3.2.1.1.1.cmml">(</mo><mrow id="alg1.l17.m1.3.3.3.2.1.1.1" xref="alg1.l17.m1.3.3.3.2.1.1.1.cmml"><mn mathsize="90%" id="alg1.l17.m1.3.3.3.2.1.1.1.2" xref="alg1.l17.m1.3.3.3.2.1.1.1.2.cmml">1</mn><mo mathsize="90%" id="alg1.l17.m1.3.3.3.2.1.1.1.1" xref="alg1.l17.m1.3.3.3.2.1.1.1.1.cmml">−</mo><mi mathsize="90%" id="alg1.l17.m1.3.3.3.2.1.1.1.3" xref="alg1.l17.m1.3.3.3.2.1.1.1.3.cmml">α</mi></mrow><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.3.3.3.2.1.1.3" xref="alg1.l17.m1.3.3.3.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l17.m1.4.4.4.3.3" xref="alg1.l17.m1.4.4.4.3.3.cmml">​</mo><msubsup id="alg1.l17.m1.4.4.4.3.2" xref="alg1.l17.m1.4.4.4.3.2.cmml"><mrow id="alg1.l17.m1.4.4.4.3.2.1.1.1" xref="alg1.l17.m1.4.4.4.3.2.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.4.4.4.3.2.1.1.1.2" xref="alg1.l17.m1.4.4.4.3.2.1.1.2.cmml">{</mo><msub id="alg1.l17.m1.4.4.4.3.2.1.1.1.1" xref="alg1.l17.m1.4.4.4.3.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l17.m1.4.4.4.3.2.1.1.1.1.2" xref="alg1.l17.m1.4.4.4.3.2.1.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l17.m1.4.4.4.3.2.1.1.1.1.3" xref="alg1.l17.m1.4.4.4.3.2.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l17.m1.4.4.4.3.2.1.1.1.3" xref="alg1.l17.m1.4.4.4.3.2.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l17.m1.4.4.4.3.2.3" xref="alg1.l17.m1.4.4.4.3.2.3.cmml"><mi mathsize="90%" id="alg1.l17.m1.4.4.4.3.2.3.2" xref="alg1.l17.m1.4.4.4.3.2.3.2.cmml">i</mi><mo mathsize="90%" id="alg1.l17.m1.4.4.4.3.2.3.1" xref="alg1.l17.m1.4.4.4.3.2.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.l17.m1.4.4.4.3.2.3.3" xref="alg1.l17.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l17.m1.4.4.4.3.2.1.3" xref="alg1.l17.m1.4.4.4.3.2.1.3.cmml">N</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.4b"><apply id="alg1.l17.m1.4.4.cmml" xref="alg1.l17.m1.4.4"><eq id="alg1.l17.m1.4.4.5.cmml" xref="alg1.l17.m1.4.4.5"></eq><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1">subscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1">superscript</csymbol><set id="alg1.l17.m1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1"><apply id="alg1.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.2">𝑷</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="alg1.l17.m1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.3">𝑁</ci></apply><apply id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3"><eq id="alg1.l17.m1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3.1"></eq><ci id="alg1.l17.m1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l17.m1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l17.m1.4.4.4.cmml" xref="alg1.l17.m1.4.4.4"><plus id="alg1.l17.m1.4.4.4.4.cmml" xref="alg1.l17.m1.4.4.4.4"></plus><apply id="alg1.l17.m1.2.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.1"><times id="alg1.l17.m1.2.2.2.1.2.cmml" xref="alg1.l17.m1.2.2.2.1.2"></times><ci id="alg1.l17.m1.2.2.2.1.3.cmml" xref="alg1.l17.m1.2.2.2.1.3">𝛼</ci><apply id="alg1.l17.m1.2.2.2.1.1.cmml" xref="alg1.l17.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.1.1.2.cmml" xref="alg1.l17.m1.2.2.2.1.1">subscript</csymbol><apply id="alg1.l17.m1.2.2.2.1.1.1.cmml" xref="alg1.l17.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l17.m1.2.2.2.1.1">superscript</csymbol><set id="alg1.l17.m1.2.2.2.1.1.1.1.2.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1"><apply id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.2">𝑷</ci><ci id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l17.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></set><ci id="alg1.l17.m1.2.2.2.1.1.1.3.cmml" xref="alg1.l17.m1.2.2.2.1.1.1.3">𝑁</ci></apply><apply id="alg1.l17.m1.2.2.2.1.1.3.cmml" xref="alg1.l17.m1.2.2.2.1.1.3"><eq id="alg1.l17.m1.2.2.2.1.1.3.1.cmml" xref="alg1.l17.m1.2.2.2.1.1.3.1"></eq><ci id="alg1.l17.m1.2.2.2.1.1.3.2.cmml" xref="alg1.l17.m1.2.2.2.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l17.m1.2.2.2.1.1.3.3.cmml" xref="alg1.l17.m1.2.2.2.1.1.3.3">1</cn></apply></apply></apply><apply id="alg1.l17.m1.4.4.4.3.cmml" xref="alg1.l17.m1.4.4.4.3"><times id="alg1.l17.m1.4.4.4.3.3.cmml" xref="alg1.l17.m1.4.4.4.3.3"></times><apply id="alg1.l17.m1.3.3.3.2.1.1.1.cmml" xref="alg1.l17.m1.3.3.3.2.1.1"><minus id="alg1.l17.m1.3.3.3.2.1.1.1.1.cmml" xref="alg1.l17.m1.3.3.3.2.1.1.1.1"></minus><cn type="integer" id="alg1.l17.m1.3.3.3.2.1.1.1.2.cmml" xref="alg1.l17.m1.3.3.3.2.1.1.1.2">1</cn><ci id="alg1.l17.m1.3.3.3.2.1.1.1.3.cmml" xref="alg1.l17.m1.3.3.3.2.1.1.1.3">𝛼</ci></apply><apply id="alg1.l17.m1.4.4.4.3.2.cmml" xref="alg1.l17.m1.4.4.4.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.4.3.2.2.cmml" xref="alg1.l17.m1.4.4.4.3.2">subscript</csymbol><apply id="alg1.l17.m1.4.4.4.3.2.1.cmml" xref="alg1.l17.m1.4.4.4.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.4.3.2.1.2.cmml" xref="alg1.l17.m1.4.4.4.3.2">superscript</csymbol><set id="alg1.l17.m1.4.4.4.3.2.1.1.2.cmml" xref="alg1.l17.m1.4.4.4.3.2.1.1.1"><apply id="alg1.l17.m1.4.4.4.3.2.1.1.1.1.cmml" xref="alg1.l17.m1.4.4.4.3.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.4.3.2.1.1.1.1.1.cmml" xref="alg1.l17.m1.4.4.4.3.2.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.4.4.4.3.2.1.1.1.1.2.cmml" xref="alg1.l17.m1.4.4.4.3.2.1.1.1.1.2">𝑷</ci><ci id="alg1.l17.m1.4.4.4.3.2.1.1.1.1.3.cmml" xref="alg1.l17.m1.4.4.4.3.2.1.1.1.1.3">𝑖</ci></apply></set><ci id="alg1.l17.m1.4.4.4.3.2.1.3.cmml" xref="alg1.l17.m1.4.4.4.3.2.1.3">𝑁</ci></apply><apply id="alg1.l17.m1.4.4.4.3.2.3.cmml" xref="alg1.l17.m1.4.4.4.3.2.3"><eq id="alg1.l17.m1.4.4.4.3.2.3.1.cmml" xref="alg1.l17.m1.4.4.4.3.2.3.1"></eq><ci id="alg1.l17.m1.4.4.4.3.2.3.2.cmml" xref="alg1.l17.m1.4.4.4.3.2.3.2">𝑖</ci><cn type="integer" id="alg1.l17.m1.4.4.4.3.2.3.3.cmml" xref="alg1.l17.m1.4.4.4.3.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.4c">\{{\bm{P}}_{i}^{s}\}^{N}_{i=1}=\alpha\{{\bm{P}}_{i}^{s}\}^{N}_{i=1}+(1-\alpha)\{{\bm{P}}_{i}\}^{N}_{i=1}</annotation></semantics></math><span id="alg1.l17.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span id="alg1.l18.1" class="ltx_text" style="font-size:90%;">  Get Global Prompts </span><math id="alg1.l18.m1.5" class="ltx_Math" alttext="\{{\bm{P}}^{g}\}\leftarrow G(\{{\bm{P}}_{1}^{s}\},\{{\bm{P}}_{2}^{s}\},...,\{{\bm{P}}_{N}^{s}\})" display="inline"><semantics id="alg1.l18.m1.5a"><mrow id="alg1.l18.m1.5.5" xref="alg1.l18.m1.5.5.cmml"><mrow id="alg1.l18.m1.2.2.1.1" xref="alg1.l18.m1.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.2.2.1.1.2" xref="alg1.l18.m1.2.2.1.2.cmml">{</mo><msup id="alg1.l18.m1.2.2.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg1.l18.m1.2.2.1.1.1.2" xref="alg1.l18.m1.2.2.1.1.1.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l18.m1.2.2.1.1.1.3" xref="alg1.l18.m1.2.2.1.1.1.3.cmml">g</mi></msup><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.2.2.1.1.3" xref="alg1.l18.m1.2.2.1.2.cmml">}</mo></mrow><mo mathsize="90%" stretchy="false" id="alg1.l18.m1.5.5.5" xref="alg1.l18.m1.5.5.5.cmml">←</mo><mrow id="alg1.l18.m1.5.5.4" xref="alg1.l18.m1.5.5.4.cmml"><mi mathsize="90%" id="alg1.l18.m1.5.5.4.5" xref="alg1.l18.m1.5.5.4.5.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.5.5.4.4" xref="alg1.l18.m1.5.5.4.4.cmml">​</mo><mrow id="alg1.l18.m1.5.5.4.3.3" xref="alg1.l18.m1.5.5.4.3.4.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.5.5.4.3.3.4" xref="alg1.l18.m1.5.5.4.3.4.cmml">(</mo><mrow id="alg1.l18.m1.3.3.2.1.1.1.1" xref="alg1.l18.m1.3.3.2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.3.3.2.1.1.1.1.2" xref="alg1.l18.m1.3.3.2.1.1.1.2.cmml">{</mo><msubsup id="alg1.l18.m1.3.3.2.1.1.1.1.1" xref="alg1.l18.m1.3.3.2.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l18.m1.3.3.2.1.1.1.1.1.2.2" xref="alg1.l18.m1.3.3.2.1.1.1.1.1.2.2.cmml">𝑷</mi><mn mathsize="90%" id="alg1.l18.m1.3.3.2.1.1.1.1.1.2.3" xref="alg1.l18.m1.3.3.2.1.1.1.1.1.2.3.cmml">1</mn><mi mathsize="90%" id="alg1.l18.m1.3.3.2.1.1.1.1.1.3" xref="alg1.l18.m1.3.3.2.1.1.1.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.3.3.2.1.1.1.1.3" xref="alg1.l18.m1.3.3.2.1.1.1.2.cmml">}</mo></mrow><mo mathsize="90%" id="alg1.l18.m1.5.5.4.3.3.5" xref="alg1.l18.m1.5.5.4.3.4.cmml">,</mo><mrow id="alg1.l18.m1.4.4.3.2.2.2.1" xref="alg1.l18.m1.4.4.3.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.4.4.3.2.2.2.1.2" xref="alg1.l18.m1.4.4.3.2.2.2.2.cmml">{</mo><msubsup id="alg1.l18.m1.4.4.3.2.2.2.1.1" xref="alg1.l18.m1.4.4.3.2.2.2.1.1.cmml"><mi mathsize="90%" id="alg1.l18.m1.4.4.3.2.2.2.1.1.2.2" xref="alg1.l18.m1.4.4.3.2.2.2.1.1.2.2.cmml">𝑷</mi><mn mathsize="90%" id="alg1.l18.m1.4.4.3.2.2.2.1.1.2.3" xref="alg1.l18.m1.4.4.3.2.2.2.1.1.2.3.cmml">2</mn><mi mathsize="90%" id="alg1.l18.m1.4.4.3.2.2.2.1.1.3" xref="alg1.l18.m1.4.4.3.2.2.2.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.4.4.3.2.2.2.1.3" xref="alg1.l18.m1.4.4.3.2.2.2.2.cmml">}</mo></mrow><mo mathsize="90%" id="alg1.l18.m1.5.5.4.3.3.6" xref="alg1.l18.m1.5.5.4.3.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">…</mi><mo mathsize="90%" id="alg1.l18.m1.5.5.4.3.3.7" xref="alg1.l18.m1.5.5.4.3.4.cmml">,</mo><mrow id="alg1.l18.m1.5.5.4.3.3.3.1" xref="alg1.l18.m1.5.5.4.3.3.3.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.5.5.4.3.3.3.1.2" xref="alg1.l18.m1.5.5.4.3.3.3.2.cmml">{</mo><msubsup id="alg1.l18.m1.5.5.4.3.3.3.1.1" xref="alg1.l18.m1.5.5.4.3.3.3.1.1.cmml"><mi mathsize="90%" id="alg1.l18.m1.5.5.4.3.3.3.1.1.2.2" xref="alg1.l18.m1.5.5.4.3.3.3.1.1.2.2.cmml">𝑷</mi><mi mathsize="90%" id="alg1.l18.m1.5.5.4.3.3.3.1.1.2.3" xref="alg1.l18.m1.5.5.4.3.3.3.1.1.2.3.cmml">N</mi><mi mathsize="90%" id="alg1.l18.m1.5.5.4.3.3.3.1.1.3" xref="alg1.l18.m1.5.5.4.3.3.3.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.5.5.4.3.3.3.1.3" xref="alg1.l18.m1.5.5.4.3.3.3.2.cmml">}</mo></mrow><mo maxsize="90%" minsize="90%" id="alg1.l18.m1.5.5.4.3.3.8" xref="alg1.l18.m1.5.5.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.5b"><apply id="alg1.l18.m1.5.5.cmml" xref="alg1.l18.m1.5.5"><ci id="alg1.l18.m1.5.5.5.cmml" xref="alg1.l18.m1.5.5.5">←</ci><set id="alg1.l18.m1.2.2.1.2.cmml" xref="alg1.l18.m1.2.2.1.1"><apply id="alg1.l18.m1.2.2.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l18.m1.2.2.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.2">𝑷</ci><ci id="alg1.l18.m1.2.2.1.1.1.3.cmml" xref="alg1.l18.m1.2.2.1.1.1.3">𝑔</ci></apply></set><apply id="alg1.l18.m1.5.5.4.cmml" xref="alg1.l18.m1.5.5.4"><times id="alg1.l18.m1.5.5.4.4.cmml" xref="alg1.l18.m1.5.5.4.4"></times><ci id="alg1.l18.m1.5.5.4.5.cmml" xref="alg1.l18.m1.5.5.4.5">𝐺</ci><vector id="alg1.l18.m1.5.5.4.3.4.cmml" xref="alg1.l18.m1.5.5.4.3.3"><set id="alg1.l18.m1.3.3.2.1.1.1.2.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1"><apply id="alg1.l18.m1.3.3.2.1.1.1.1.1.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.3.3.2.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1.1">superscript</csymbol><apply id="alg1.l18.m1.3.3.2.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.3.3.2.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.3.3.2.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1.1.2.2">𝑷</ci><cn type="integer" id="alg1.l18.m1.3.3.2.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1.1.2.3">1</cn></apply><ci id="alg1.l18.m1.3.3.2.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.3.3.2.1.1.1.1.1.3">𝑠</ci></apply></set><set id="alg1.l18.m1.4.4.3.2.2.2.2.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1"><apply id="alg1.l18.m1.4.4.3.2.2.2.1.1.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.4.4.3.2.2.2.1.1.1.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1.1">superscript</csymbol><apply id="alg1.l18.m1.4.4.3.2.2.2.1.1.2.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.4.4.3.2.2.2.1.1.2.1.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1.1">subscript</csymbol><ci id="alg1.l18.m1.4.4.3.2.2.2.1.1.2.2.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1.1.2.2">𝑷</ci><cn type="integer" id="alg1.l18.m1.4.4.3.2.2.2.1.1.2.3.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1.1.2.3">2</cn></apply><ci id="alg1.l18.m1.4.4.3.2.2.2.1.1.3.cmml" xref="alg1.l18.m1.4.4.3.2.2.2.1.1.3">𝑠</ci></apply></set><ci id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">…</ci><set id="alg1.l18.m1.5.5.4.3.3.3.2.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1"><apply id="alg1.l18.m1.5.5.4.3.3.3.1.1.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.5.5.4.3.3.3.1.1.1.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1.1">superscript</csymbol><apply id="alg1.l18.m1.5.5.4.3.3.3.1.1.2.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.5.5.4.3.3.3.1.1.2.1.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1.1">subscript</csymbol><ci id="alg1.l18.m1.5.5.4.3.3.3.1.1.2.2.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1.1.2.2">𝑷</ci><ci id="alg1.l18.m1.5.5.4.3.3.3.1.1.2.3.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1.1.2.3">𝑁</ci></apply><ci id="alg1.l18.m1.5.5.4.3.3.3.1.1.3.cmml" xref="alg1.l18.m1.5.5.4.3.3.3.1.1.3">𝑠</ci></apply></set></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.5c">\{{\bm{P}}^{g}\}\leftarrow G(\{{\bm{P}}_{1}^{s}\},\{{\bm{P}}_{2}^{s}\},...,\{{\bm{P}}_{N}^{s}\})</annotation></semantics></math><span id="alg1.l18.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span id="alg1.l19.1" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l19.m1.1" class="ltx_Math" alttext="\mathbf{end}" display="inline"><semantics id="alg1.l19.m1.1a"><mi mathsize="90%" id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">𝐞𝐧𝐝</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">𝐞𝐧𝐝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\mathbf{end}</annotation></semantics></math><span id="alg1.l19.2" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l19.m2.1" class="ltx_Math" alttext="\mathbf{for}" display="inline"><semantics id="alg1.l19.m2.1a"><mi mathsize="90%" id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml">𝐟𝐨𝐫</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><ci id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1">𝐟𝐨𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">\mathbf{for}</annotation></semantics></math><span id="alg1.l19.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">We compare our <span id="S5.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_italic">MetePFL</span> with STGCN <cite class="ltx_cite ltx_citemacro_cite">Yu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib44" title="" class="ltx_ref">2017</a>)</cite>, LSTM <cite class="ltx_cite ltx_citemacro_cite">Graves (<a href="#bib.bib11" title="" class="ltx_ref">2012</a>)</cite>, ConvLSTM <cite class="ltx_cite ltx_citemacro_cite">Shi <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib34" title="" class="ltx_ref">2015</a>)</cite>, Transformer <cite class="ltx_cite ltx_citemacro_cite">Zerveas <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite>, Informer <cite class="ltx_cite ltx_citemacro_cite">Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib47" title="" class="ltx_ref">2021</a>)</cite>, Autoformer <cite class="ltx_cite ltx_citemacro_cite">Wu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib41" title="" class="ltx_ref">2021</a>)</cite>, and Fedformer <cite class="ltx_cite ltx_citemacro_cite">Zhou <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib49" title="" class="ltx_ref">2022b</a>)</cite>. The LSTM-based models have four layers. The Transformer consists of an eight-layer Encoder, while the Informer, Autoformer, and FEDformer consist of two encoders and a decoder. The Transforme models are trained by data-centric and FL setting, respectively.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Datasets.</h4>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px2.p1.1" class="ltx_p">We compiled three multivariate time series datasets from NASA<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://disc.gsfc.nasa.gov/</span></span></span>, Average Precipitation (AvePRE), Surface Temperature (SurTEMP), and Surface Upstream (SurUPS) collected by 88, 525, and 238 devices, respectively. All three datasets cover the hour-by-hour variability of 12 different weather-related meteorological variables.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Experimental Setups.</h4>

<div id="S5.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px3.p1.13" class="ltx_p">Models’ input and output dimensions are <math id="S5.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.1.m1.1c">\mathcal{C}</annotation></semantics></math> = 12 and <math id="S5.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.2.m2.1b"><ci id="S5.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.2.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.2.m2.1c">\mathcal{C}</annotation></semantics></math> = 1, respectively. The dataset is split into training, validation, and testing in a 6:2:2 ratio. For pre-training, we use <math id="S5.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="2/3" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.3.m3.1a"><mrow id="S5.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mn id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">2</mn><mo id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml">/</mo><mn id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1"><divide id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.1"></divide><cn type="integer" id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.2">2</cn><cn type="integer" id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.3.m3.1c">2/3</annotation></semantics></math> of the training set (i.e., <math id="S5.SS0.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.4.m4.1a"><mrow id="S5.SS0.SSS0.Px3.p1.4.m4.1.1" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1.cmml"><mn id="S5.SS0.SSS0.Px3.p1.4.m4.1.1.2" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1.2.cmml">50</mn><mo id="S5.SS0.SSS0.Px3.p1.4.m4.1.1.1" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.4.m4.1b"><apply id="S5.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1"><csymbol cd="latexml" id="S5.SS0.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S5.SS0.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.4.m4.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.4.m4.1c">50\%</annotation></semantics></math> of the entire dataset) for training and <math id="S5.SS0.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="1/6" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.5.m5.1a"><mrow id="S5.SS0.SSS0.Px3.p1.5.m5.1.1" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.cmml"><mn id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2.cmml">1</mn><mo id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1.cmml">/</mo><mn id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.5.m5.1b"><apply id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1"><divide id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.1"></divide><cn type="integer" id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.2">1</cn><cn type="integer" id="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml" xref="S5.SS0.SSS0.Px3.p1.5.m5.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.5.m5.1c">1/6</annotation></semantics></math> as the validation set (i.e., <math id="S5.SS0.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.6.m6.1a"><mrow id="S5.SS0.SSS0.Px3.p1.6.m6.1.1" xref="S5.SS0.SSS0.Px3.p1.6.m6.1.1.cmml"><mn id="S5.SS0.SSS0.Px3.p1.6.m6.1.1.2" xref="S5.SS0.SSS0.Px3.p1.6.m6.1.1.2.cmml">10</mn><mo id="S5.SS0.SSS0.Px3.p1.6.m6.1.1.1" xref="S5.SS0.SSS0.Px3.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.6.m6.1b"><apply id="S5.SS0.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.6.m6.1.1"><csymbol cd="latexml" id="S5.SS0.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.6.m6.1.1.1">percent</csymbol><cn type="integer" id="S5.SS0.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.6.m6.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.6.m6.1c">10\%</annotation></semantics></math> of the complete dataset) based on the above partition, following the pre-training strategy from Zerveas et al. <cite class="ltx_cite ltx_citemacro_cite">Zerveas <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite>. For fine-tuning and prompt learning, the last <math id="S5.SS0.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="1/6" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.7.m7.1a"><mrow id="S5.SS0.SSS0.Px3.p1.7.m7.1.1" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1.cmml"><mn id="S5.SS0.SSS0.Px3.p1.7.m7.1.1.2" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1.2.cmml">1</mn><mo id="S5.SS0.SSS0.Px3.p1.7.m7.1.1.1" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1.1.cmml">/</mo><mn id="S5.SS0.SSS0.Px3.p1.7.m7.1.1.3" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.7.m7.1b"><apply id="S5.SS0.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1"><divide id="S5.SS0.SSS0.Px3.p1.7.m7.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1.1"></divide><cn type="integer" id="S5.SS0.SSS0.Px3.p1.7.m7.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1.2">1</cn><cn type="integer" id="S5.SS0.SSS0.Px3.p1.7.m7.1.1.3.cmml" xref="S5.SS0.SSS0.Px3.p1.7.m7.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.7.m7.1c">1/6</annotation></semantics></math> of the training set is used for training, while the validation and test sets remain unchanged. In the federated training process, we set <math id="S5.SS0.SSS0.Px3.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.8.m8.1a"><mi id="S5.SS0.SSS0.Px3.p1.8.m8.1.1" xref="S5.SS0.SSS0.Px3.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.8.m8.1b"><ci id="S5.SS0.SSS0.Px3.p1.8.m8.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.8.m8.1c">k</annotation></semantics></math> to control the number of clients participating in training per round, and we use <math id="S5.SS0.SSS0.Px3.p1.9.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.9.m9.1a"><mi id="S5.SS0.SSS0.Px3.p1.9.m9.1.1" xref="S5.SS0.SSS0.Px3.p1.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.9.m9.1b"><ci id="S5.SS0.SSS0.Px3.p1.9.m9.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.9.m9.1c">k</annotation></semantics></math> = 0.1 and <math id="S5.SS0.SSS0.Px3.p1.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.10.m10.1a"><mi id="S5.SS0.SSS0.Px3.p1.10.m10.1.1" xref="S5.SS0.SSS0.Px3.p1.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.10.m10.1b"><ci id="S5.SS0.SSS0.Px3.p1.10.m10.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.10.m10.1c">k</annotation></semantics></math> = 0.2 in the experiments. The forecasting uses 12 time steps in history (<math id="S5.SS0.SSS0.Px3.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS0.SSS0.Px3.p1.11.m11.1.1" xref="S5.SS0.SSS0.Px3.p1.11.m11.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.11.m11.1b"><ci id="S5.SS0.SSS0.Px3.p1.11.m11.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.11.m11.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.11.m11.1c">\mathcal{P}</annotation></semantics></math>=12, i.e., the past twelve hours) to predict 15 time steps in the future (<math id="S5.SS0.SSS0.Px3.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS0.SSS0.Px3.p1.12.m12.1.1" xref="S5.SS0.SSS0.Px3.p1.12.m12.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.12.m12.1b"><ci id="S5.SS0.SSS0.Px3.p1.12.m12.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.12.m12.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.12.m12.1c">\mathcal{Q}</annotation></semantics></math>=15, i.e., fifty hours in the future) with a time window length of 27 h. We set <math id="S5.SS0.SSS0.Px3.p1.13.m13.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.13.m13.1a"><mi id="S5.SS0.SSS0.Px3.p1.13.m13.1.1" xref="S5.SS0.SSS0.Px3.p1.13.m13.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.13.m13.1b"><ci id="S5.SS0.SSS0.Px3.p1.13.m13.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.13.m13.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.13.m13.1c">l</annotation></semantics></math> to 3, considering the validity time and trigger threshold of weather events.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<div id="S5.T1.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:224.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-111.4pt,67.8pt) scale(0.623154884200736,0.623154884200736) ;">
<table id="S5.T1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T1.3.1.1" class="ltx_tr">
<td id="S5.T1.3.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T1.3.1.1.1.1" class="ltx_text">Model</span></td>
<td id="S5.T1.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T1.3.1.1.2.1" class="ltx_text">Temproal Encoding</span></td>
<td id="S5.T1.3.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">AvePRE</td>
<td id="S5.T1.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">SurTEMP</td>
<td id="S5.T1.3.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">SurUPS</td>
</tr>
<tr id="S5.T1.3.1.2" class="ltx_tr">
<td id="S5.T1.3.1.2.1" class="ltx_td ltx_align_center">MAE</td>
<td id="S5.T1.3.1.2.2" class="ltx_td ltx_align_center">RMSE</td>
<td id="S5.T1.3.1.2.3" class="ltx_td ltx_align_center">MAE</td>
<td id="S5.T1.3.1.2.4" class="ltx_td ltx_align_center">RMSE</td>
<td id="S5.T1.3.1.2.5" class="ltx_td ltx_align_center">MAE</td>
<td id="S5.T1.3.1.2.6" class="ltx_td ltx_align_center">RMSE</td>
</tr>
<tr id="S5.T1.3.1.3" class="ltx_tr">
<td id="S5.T1.3.1.3.1" class="ltx_td ltx_align_center ltx_border_t">STGCN</td>
<td id="S5.T1.3.1.3.2" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="S5.T1.3.1.3.3" class="ltx_td ltx_align_center ltx_border_t">0.331</td>
<td id="S5.T1.3.1.3.4" class="ltx_td ltx_align_center ltx_border_t">0.815</td>
<td id="S5.T1.3.1.3.5" class="ltx_td ltx_align_center ltx_border_t">0.196</td>
<td id="S5.T1.3.1.3.6" class="ltx_td ltx_align_center ltx_border_t">0.257</td>
<td id="S5.T1.3.1.3.7" class="ltx_td ltx_align_center ltx_border_t">0.298</td>
<td id="S5.T1.3.1.3.8" class="ltx_td ltx_align_center ltx_border_t">0.399</td>
</tr>
<tr id="S5.T1.3.1.4" class="ltx_tr">
<td id="S5.T1.3.1.4.1" class="ltx_td ltx_align_center">ConvLSTM</td>
<td id="S5.T1.3.1.4.2" class="ltx_td ltx_align_center">None</td>
<td id="S5.T1.3.1.4.3" class="ltx_td ltx_align_center">0.305</td>
<td id="S5.T1.3.1.4.4" class="ltx_td ltx_align_center">0.730</td>
<td id="S5.T1.3.1.4.5" class="ltx_td ltx_align_center">0.198</td>
<td id="S5.T1.3.1.4.6" class="ltx_td ltx_align_center">0.266</td>
<td id="S5.T1.3.1.4.7" class="ltx_td ltx_align_center">0.311</td>
<td id="S5.T1.3.1.4.8" class="ltx_td ltx_align_center">0.416</td>
</tr>
<tr id="S5.T1.3.1.5" class="ltx_tr">
<td id="S5.T1.3.1.5.1" class="ltx_td ltx_align_center">LSTM</td>
<td id="S5.T1.3.1.5.2" class="ltx_td ltx_align_center">None</td>
<td id="S5.T1.3.1.5.3" class="ltx_td ltx_align_center">0.326</td>
<td id="S5.T1.3.1.5.4" class="ltx_td ltx_align_center">0.781</td>
<td id="S5.T1.3.1.5.5" class="ltx_td ltx_align_center">0.212</td>
<td id="S5.T1.3.1.5.6" class="ltx_td ltx_align_center">0.274</td>
<td id="S5.T1.3.1.5.7" class="ltx_td ltx_align_center">0.335</td>
<td id="S5.T1.3.1.5.8" class="ltx_td ltx_align_center">0.431</td>
</tr>
<tr id="S5.T1.3.1.6" class="ltx_tr">
<td id="S5.T1.3.1.6.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S5.T1.3.1.6.1.1" class="ltx_text">Transformer</span></td>
<td id="S5.T1.3.1.6.2" class="ltx_td ltx_align_center ltx_border_t">Learnable</td>
<td id="S5.T1.3.1.6.3" class="ltx_td ltx_align_center ltx_border_t">0.301</td>
<td id="S5.T1.3.1.6.4" class="ltx_td ltx_align_center ltx_border_t">0.714</td>
<td id="S5.T1.3.1.6.5" class="ltx_td ltx_align_center ltx_border_t">0.236</td>
<td id="S5.T1.3.1.6.6" class="ltx_td ltx_align_center ltx_border_t">0.313</td>
<td id="S5.T1.3.1.6.7" class="ltx_td ltx_align_center ltx_border_t">0.369</td>
<td id="S5.T1.3.1.6.8" class="ltx_td ltx_align_center ltx_border_t">0.475</td>
</tr>
<tr id="S5.T1.3.1.7" class="ltx_tr">
<td id="S5.T1.3.1.7.1" class="ltx_td ltx_align_center">Fixed</td>
<td id="S5.T1.3.1.7.2" class="ltx_td ltx_align_center">0.332</td>
<td id="S5.T1.3.1.7.3" class="ltx_td ltx_align_center">0.744</td>
<td id="S5.T1.3.1.7.4" class="ltx_td ltx_align_center">0.239</td>
<td id="S5.T1.3.1.7.5" class="ltx_td ltx_align_center">0.320</td>
<td id="S5.T1.3.1.7.6" class="ltx_td ltx_align_center">0.351</td>
<td id="S5.T1.3.1.7.7" class="ltx_td ltx_align_center">0.449</td>
</tr>
<tr id="S5.T1.3.1.8" class="ltx_tr">
<td id="S5.T1.3.1.8.1" class="ltx_td ltx_align_center" rowspan="2"><span id="S5.T1.3.1.8.1.1" class="ltx_text">FEDformer</span></td>
<td id="S5.T1.3.1.8.2" class="ltx_td ltx_align_center">Learnable</td>
<td id="S5.T1.3.1.8.3" class="ltx_td ltx_align_center">0.239</td>
<td id="S5.T1.3.1.8.4" class="ltx_td ltx_align_center">0.547</td>
<td id="S5.T1.3.1.8.5" class="ltx_td ltx_align_center">0.165</td>
<td id="S5.T1.3.1.8.6" class="ltx_td ltx_align_center">0.214</td>
<td id="S5.T1.3.1.8.7" class="ltx_td ltx_align_center">0.205</td>
<td id="S5.T1.3.1.8.8" class="ltx_td ltx_align_center">0.271</td>
</tr>
<tr id="S5.T1.3.1.9" class="ltx_tr">
<td id="S5.T1.3.1.9.1" class="ltx_td ltx_align_center">Fixed</td>
<td id="S5.T1.3.1.9.2" class="ltx_td ltx_align_center">0.248</td>
<td id="S5.T1.3.1.9.3" class="ltx_td ltx_align_center">0.564</td>
<td id="S5.T1.3.1.9.4" class="ltx_td ltx_align_center">0.165</td>
<td id="S5.T1.3.1.9.5" class="ltx_td ltx_align_center">0.216</td>
<td id="S5.T1.3.1.9.6" class="ltx_td ltx_align_center">0.201</td>
<td id="S5.T1.3.1.9.7" class="ltx_td ltx_align_center">0.264</td>
</tr>
<tr id="S5.T1.3.1.10" class="ltx_tr">
<td id="S5.T1.3.1.10.1" class="ltx_td ltx_align_center" rowspan="2"><span id="S5.T1.3.1.10.1.1" class="ltx_text">Autoformer</span></td>
<td id="S5.T1.3.1.10.2" class="ltx_td ltx_align_center">Learnable</td>
<td id="S5.T1.3.1.10.3" class="ltx_td ltx_align_center">0.271</td>
<td id="S5.T1.3.1.10.4" class="ltx_td ltx_align_center">0.589</td>
<td id="S5.T1.3.1.10.5" class="ltx_td ltx_align_center">0.167</td>
<td id="S5.T1.3.1.10.6" class="ltx_td ltx_align_center">0.235</td>
<td id="S5.T1.3.1.10.7" class="ltx_td ltx_align_center">0.201</td>
<td id="S5.T1.3.1.10.8" class="ltx_td ltx_align_center">0.265</td>
</tr>
<tr id="S5.T1.3.1.11" class="ltx_tr">
<td id="S5.T1.3.1.11.1" class="ltx_td ltx_align_center">Fixed</td>
<td id="S5.T1.3.1.11.2" class="ltx_td ltx_align_center">0.269</td>
<td id="S5.T1.3.1.11.3" class="ltx_td ltx_align_center">0.590</td>
<td id="S5.T1.3.1.11.4" class="ltx_td ltx_align_center">0.176</td>
<td id="S5.T1.3.1.11.5" class="ltx_td ltx_align_center">0.228</td>
<td id="S5.T1.3.1.11.6" class="ltx_td ltx_align_center">0.212</td>
<td id="S5.T1.3.1.11.7" class="ltx_td ltx_align_center">0.279</td>
</tr>
<tr id="S5.T1.3.1.12" class="ltx_tr">
<td id="S5.T1.3.1.12.1" class="ltx_td ltx_align_center" rowspan="2"><span id="S5.T1.3.1.12.1.1" class="ltx_text">Informer</span></td>
<td id="S5.T1.3.1.12.2" class="ltx_td ltx_align_center">Learnable</td>
<td id="S5.T1.3.1.12.3" class="ltx_td ltx_align_center">0.213</td>
<td id="S5.T1.3.1.12.4" class="ltx_td ltx_align_center">0.543</td>
<td id="S5.T1.3.1.12.5" class="ltx_td ltx_align_center">0.191</td>
<td id="S5.T1.3.1.12.6" class="ltx_td ltx_align_center">0.245</td>
<td id="S5.T1.3.1.12.7" class="ltx_td ltx_align_center">0.251</td>
<td id="S5.T1.3.1.12.8" class="ltx_td ltx_align_center">0.330</td>
</tr>
<tr id="S5.T1.3.1.13" class="ltx_tr">
<td id="S5.T1.3.1.13.1" class="ltx_td ltx_align_center">Fixed</td>
<td id="S5.T1.3.1.13.2" class="ltx_td ltx_align_center">0.216</td>
<td id="S5.T1.3.1.13.3" class="ltx_td ltx_align_center">0.547</td>
<td id="S5.T1.3.1.13.4" class="ltx_td ltx_align_center">0.193</td>
<td id="S5.T1.3.1.13.5" class="ltx_td ltx_align_center">0.251</td>
<td id="S5.T1.3.1.13.6" class="ltx_td ltx_align_center">0.240</td>
<td id="S5.T1.3.1.13.7" class="ltx_td ltx_align_center">0.311</td>
</tr>
<tr id="S5.T1.3.1.14" class="ltx_tr">
<td id="S5.T1.3.1.14.1" class="ltx_td ltx_align_center ltx_border_t">Fed-Transformer</td>
<td id="S5.T1.3.1.14.2" class="ltx_td ltx_align_center ltx_border_t">Learnable</td>
<td id="S5.T1.3.1.14.3" class="ltx_td ltx_align_center ltx_border_t">0.454/0.402</td>
<td id="S5.T1.3.1.14.4" class="ltx_td ltx_align_center ltx_border_t">0.927/0.892</td>
<td id="S5.T1.3.1.14.5" class="ltx_td ltx_align_center ltx_border_t">0.780/0.684</td>
<td id="S5.T1.3.1.14.6" class="ltx_td ltx_align_center ltx_border_t">0.910/0.793</td>
<td id="S5.T1.3.1.14.7" class="ltx_td ltx_align_center ltx_border_t">0.621/0.522</td>
<td id="S5.T1.3.1.14.8" class="ltx_td ltx_align_center ltx_border_t">0.769/0.640</td>
</tr>
<tr id="S5.T1.3.1.15" class="ltx_tr">
<td id="S5.T1.3.1.15.1" class="ltx_td ltx_align_center">Fed-FEDformer</td>
<td id="S5.T1.3.1.15.2" class="ltx_td ltx_align_center">Learnable</td>
<td id="S5.T1.3.1.15.3" class="ltx_td ltx_align_center">0.397/0.372</td>
<td id="S5.T1.3.1.15.4" class="ltx_td ltx_align_center">0.791/0.726</td>
<td id="S5.T1.3.1.15.5" class="ltx_td ltx_align_center">0.684/0.530</td>
<td id="S5.T1.3.1.15.6" class="ltx_td ltx_align_center">0.822/0.680</td>
<td id="S5.T1.3.1.15.7" class="ltx_td ltx_align_center">0.612/0.512</td>
<td id="S5.T1.3.1.15.8" class="ltx_td ltx_align_center">0.754/0.647</td>
</tr>
<tr id="S5.T1.3.1.16" class="ltx_tr">
<td id="S5.T1.3.1.16.1" class="ltx_td ltx_align_center">Fed-Autoformer</td>
<td id="S5.T1.3.1.16.2" class="ltx_td ltx_align_center">Learnable</td>
<td id="S5.T1.3.1.16.3" class="ltx_td ltx_align_center">0.425/<span id="S5.T1.3.1.16.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.349</span>
</td>
<td id="S5.T1.3.1.16.4" class="ltx_td ltx_align_center">
<span id="S5.T1.3.1.16.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.784</span>/<span id="S5.T1.3.1.16.4.2" class="ltx_text ltx_framed ltx_framed_underline">0.724</span>
</td>
<td id="S5.T1.3.1.16.5" class="ltx_td ltx_align_center">0.742/0.627</td>
<td id="S5.T1.3.1.16.6" class="ltx_td ltx_align_center">0.924/0.765</td>
<td id="S5.T1.3.1.16.7" class="ltx_td ltx_align_center">
<span id="S5.T1.3.1.16.7.1" class="ltx_text ltx_framed ltx_framed_underline">0.578</span>/<span id="S5.T1.3.1.16.7.2" class="ltx_text ltx_framed ltx_framed_underline">0.503</span>
</td>
<td id="S5.T1.3.1.16.8" class="ltx_td ltx_align_center">
<span id="S5.T1.3.1.16.8.1" class="ltx_text ltx_framed ltx_framed_underline">0.715</span>/<span id="S5.T1.3.1.16.8.2" class="ltx_text ltx_framed ltx_framed_underline">0.602</span>
</td>
</tr>
<tr id="S5.T1.3.1.17" class="ltx_tr">
<td id="S5.T1.3.1.17.1" class="ltx_td ltx_align_center">Fed-Informer</td>
<td id="S5.T1.3.1.17.2" class="ltx_td ltx_align_center">Learnable</td>
<td id="S5.T1.3.1.17.3" class="ltx_td ltx_align_center">
<span id="S5.T1.3.1.17.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.385</span>/0.361</td>
<td id="S5.T1.3.1.17.4" class="ltx_td ltx_align_center">0.865/0.768</td>
<td id="S5.T1.3.1.17.5" class="ltx_td ltx_align_center">
<span id="S5.T1.3.1.17.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.647</span>/<span id="S5.T1.3.1.17.5.2" class="ltx_text ltx_framed ltx_framed_underline">0.513</span>
</td>
<td id="S5.T1.3.1.17.6" class="ltx_td ltx_align_center">
<span id="S5.T1.3.1.17.6.1" class="ltx_text ltx_framed ltx_framed_underline">0.790</span>/<span id="S5.T1.3.1.17.6.2" class="ltx_text ltx_framed ltx_framed_underline">0.656</span>
</td>
<td id="S5.T1.3.1.17.7" class="ltx_td ltx_align_center">0.605/0.543</td>
<td id="S5.T1.3.1.17.8" class="ltx_td ltx_align_center">0.737/0.724</td>
</tr>
<tr id="S5.T1.3.1.18" class="ltx_tr">
<td id="S5.T1.3.1.18.1" class="ltx_td ltx_align_center ltx_border_t">PromptFL-Transformer</td>
<td id="S5.T1.3.1.18.2" class="ltx_td ltx_align_center ltx_border_t">Learnable</td>
<td id="S5.T1.3.1.18.3" class="ltx_td ltx_align_center ltx_border_t">0.427/0.389</td>
<td id="S5.T1.3.1.18.4" class="ltx_td ltx_align_center ltx_border_t">0.828/0.786</td>
<td id="S5.T1.3.1.18.5" class="ltx_td ltx_align_center ltx_border_t">0.683/0.612</td>
<td id="S5.T1.3.1.18.6" class="ltx_td ltx_align_center ltx_border_t">0.824/0.741</td>
<td id="S5.T1.3.1.18.7" class="ltx_td ltx_align_center ltx_border_t">0.603/0.519</td>
<td id="S5.T1.3.1.18.8" class="ltx_td ltx_align_center ltx_border_t">0.766/0.641</td>
</tr>
<tr id="S5.T1.3.1.19" class="ltx_tr">
<td id="S5.T1.3.1.19.1" class="ltx_td ltx_align_center">
<span id="S5.T1.3.1.19.1.1" class="ltx_text ltx_font_italic">MetePFL</span>*</td>
<td id="S5.T1.3.1.19.2" class="ltx_td ltx_align_center">Learnable</td>
<td id="S5.T1.3.1.19.3" class="ltx_td ltx_align_center">0.389/0.376</td>
<td id="S5.T1.3.1.19.4" class="ltx_td ltx_align_center">0.631/0.626</td>
<td id="S5.T1.3.1.19.5" class="ltx_td ltx_align_center">0.592/0.522</td>
<td id="S5.T1.3.1.19.6" class="ltx_td ltx_align_center">0.611/0.597</td>
<td id="S5.T1.3.1.19.7" class="ltx_td ltx_align_center">0.584/0.485</td>
<td id="S5.T1.3.1.19.8" class="ltx_td ltx_align_center">0.721/0.610</td>
</tr>
<tr id="S5.T1.3.1.20" class="ltx_tr">
<td id="S5.T1.3.1.20.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.3.1.20.1.1" class="ltx_text ltx_font_italic">MetePFL</span></td>
<td id="S5.T1.3.1.20.2" class="ltx_td ltx_align_center ltx_border_bb">Learnable</td>
<td id="S5.T1.3.1.20.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.3.1.20.3.1" class="ltx_text ltx_font_bold">0.378</span>/<span id="S5.T1.3.1.20.3.2" class="ltx_text ltx_font_bold">0.342</span>
</td>
<td id="S5.T1.3.1.20.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.3.1.20.4.1" class="ltx_text ltx_font_bold">0.628</span>/<span id="S5.T1.3.1.20.4.2" class="ltx_text ltx_font_bold">0.605</span>
</td>
<td id="S5.T1.3.1.20.5" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.3.1.20.5.1" class="ltx_text ltx_font_bold">0.556</span>/<span id="S5.T1.3.1.20.5.2" class="ltx_text ltx_font_bold">0.542</span>
</td>
<td id="S5.T1.3.1.20.6" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.3.1.20.6.1" class="ltx_text ltx_font_bold">0.601</span>/<span id="S5.T1.3.1.20.6.2" class="ltx_text ltx_font_bold">0.569</span>
</td>
<td id="S5.T1.3.1.20.7" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.3.1.20.7.1" class="ltx_text ltx_font_bold">0.521</span>/<span id="S5.T1.3.1.20.7.2" class="ltx_text ltx_font_bold">0.460</span>
</td>
<td id="S5.T1.3.1.20.8" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.3.1.20.8.1" class="ltx_text ltx_font_bold">0.642</span>/<span id="S5.T1.3.1.20.8.2" class="ltx_text ltx_font_bold">0.589</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance comparison of <span id="S5.T1.7.1" class="ltx_text ltx_font_italic">MetePFL</span> with baselines, the first eight models are trained from scratch using full parameters. Fed-Transformer refers to training the Transformer model from scratch in a federated learning (FL) setting, the last two models employ FL-based prompt learning methods with a pre-trained Transformer as the FM, the symbol <math id="S5.T1.2.m1.1" class="ltx_Math" alttext="*" display="inline"><semantics id="S5.T1.2.m1.1b"><mo id="S5.T1.2.m1.1.1" xref="S5.T1.2.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.m1.1c"><times id="S5.T1.2.m1.1.1.cmml" xref="S5.T1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.m1.1d">*</annotation></semantics></math> indicates a FedAvg-based implementation, <span id="S5.T1.8.2" class="ltx_text ltx_framed ltx_framed_underline">underline</span> means the optimal in FL full parameters training, <span id="S5.T1.9.3" class="ltx_text ltx_font_bold">Bold</span> means the optimal in FL prompt learning strategy.</figcaption>
</figure>
<div id="S5.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="S5.SS0.SSS0.Px3.p2.2" class="ltx_p">All models were trained on an NVIDIA Tesla V100 GPU using an initial learning rate of <math id="S5.SS0.SSS0.Px3.p2.1.m1.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="S5.SS0.SSS0.Px3.p2.1.m1.1a"><mrow id="S5.SS0.SSS0.Px3.p2.1.m1.1.1" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.cmml"><mn id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.2" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.1" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.1.cmml">​</mo><msup id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.cmml"><mi id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.2" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.2.cmml">e</mi><mrow id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.cmml"><mo id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3a" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p2.1.m1.1b"><apply id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1"><times id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.1"></times><cn type="integer" id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.2">1</cn><apply id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.1.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.2.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.2">𝑒</ci><apply id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3"><minus id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2.cmml" xref="S5.SS0.SSS0.Px3.p2.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p2.1.m1.1c">1e^{-3}</annotation></semantics></math> and a batch size of 128, ADAM <cite class="ltx_cite ltx_citemacro_cite">Kingma and Ba (<a href="#bib.bib17" title="" class="ltx_ref">2014</a>)</cite> as the optimizer. The algorithm used in the FL of the Transformer-based network is FedAvg. The communication round was set to 20, <math id="S5.SS0.SSS0.Px3.p2.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.SS0.SSS0.Px3.p2.2.m2.1a"><mrow id="S5.SS0.SSS0.Px3.p2.2.m2.1.1" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1.cmml"><mi id="S5.SS0.SSS0.Px3.p2.2.m2.1.1.2" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS0.SSS0.Px3.p2.2.m2.1.1.1" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS0.SSS0.Px3.p2.2.m2.1.1.3" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p2.2.m2.1b"><apply id="S5.SS0.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1"><eq id="S5.SS0.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1.1"></eq><ci id="S5.SS0.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1.2">𝛼</ci><cn type="float" id="S5.SS0.SSS0.Px3.p2.2.m2.1.1.3.cmml" xref="S5.SS0.SSS0.Px3.p2.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p2.2.m2.1c">\alpha=0.5</annotation></semantics></math>, and the early stopping strategy was applied. Mean absolute error (MAE) and root mean absolute error (RMSE) as evaluation metrics. The code is avaliable at <a target="_blank" href="https://github.com/shengchaochen82/MetePFL" title="" class="ltx_ref ltx_url ltx_font_typewriter ltx_font_italic">https://github.com/shengchaochen82/MetePFL</a>.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:124.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-101.6pt,36.6pt) scale(0.630498078034706,0.630498078034706) ;">
<table id="S5.T2.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T2.5.1.1" class="ltx_tr">
<td id="S5.T2.5.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T2.5.1.1.1.1" class="ltx_text">FM</span></td>
<td id="S5.T2.5.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T2.5.1.1.2.1" class="ltx_text">Algorithm</span></td>
<td id="S5.T2.5.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">AvePRE</td>
<td id="S5.T2.5.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">SurTEMP</td>
<td id="S5.T2.5.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">SurUPS</td>
</tr>
<tr id="S5.T2.5.1.2" class="ltx_tr">
<td id="S5.T2.5.1.2.1" class="ltx_td ltx_align_center ltx_border_t">MAE</td>
<td id="S5.T2.5.1.2.2" class="ltx_td ltx_align_center ltx_border_t">RMSE</td>
<td id="S5.T2.5.1.2.3" class="ltx_td ltx_align_center ltx_border_t">MAE</td>
<td id="S5.T2.5.1.2.4" class="ltx_td ltx_align_center ltx_border_t">RMSE</td>
<td id="S5.T2.5.1.2.5" class="ltx_td ltx_align_center ltx_border_t">MAE</td>
<td id="S5.T2.5.1.2.6" class="ltx_td ltx_align_center ltx_border_t">RMSE</td>
</tr>
<tr id="S5.T2.5.1.3" class="ltx_tr">
<td id="S5.T2.5.1.3.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="4"><span id="S5.T2.5.1.3.1.1" class="ltx_text">Transformer*</span></td>
<td id="S5.T2.5.1.3.2" class="ltx_td ltx_align_center ltx_border_t">FedAtt</td>
<td id="S5.T2.5.1.3.3" class="ltx_td ltx_align_center ltx_border_t">0.507/0.467</td>
<td id="S5.T2.5.1.3.4" class="ltx_td ltx_align_center ltx_border_t">0.836/0.823</td>
<td id="S5.T2.5.1.3.5" class="ltx_td ltx_align_center ltx_border_t">0.978/0.947</td>
<td id="S5.T2.5.1.3.6" class="ltx_td ltx_align_center ltx_border_t">1.279/1.186</td>
<td id="S5.T2.5.1.3.7" class="ltx_td ltx_align_center ltx_border_t">0.705/0.686</td>
<td id="S5.T2.5.1.3.8" class="ltx_td ltx_align_center ltx_border_t">0.828/0.820</td>
</tr>
<tr id="S5.T2.5.1.4" class="ltx_tr">
<td id="S5.T2.5.1.4.1" class="ltx_td ltx_align_center">FedProx</td>
<td id="S5.T2.5.1.4.2" class="ltx_td ltx_align_center">0.567/0.531</td>
<td id="S5.T2.5.1.4.3" class="ltx_td ltx_align_center">0.845/0.827</td>
<td id="S5.T2.5.1.4.4" class="ltx_td ltx_align_center">0.922/0.901</td>
<td id="S5.T2.5.1.4.5" class="ltx_td ltx_align_center">1.141/1.102</td>
<td id="S5.T2.5.1.4.6" class="ltx_td ltx_align_center">0.688/0.672</td>
<td id="S5.T2.5.1.4.7" class="ltx_td ltx_align_center">0.814/0.810</td>
</tr>
<tr id="S5.T2.5.1.5" class="ltx_tr">
<td id="S5.T2.5.1.5.1" class="ltx_td ltx_align_center">Scaffold</td>
<td id="S5.T2.5.1.5.2" class="ltx_td ltx_align_center">0.567/0.536</td>
<td id="S5.T2.5.1.5.3" class="ltx_td ltx_align_center">0.833/0.811</td>
<td id="S5.T2.5.1.5.4" class="ltx_td ltx_align_center">0.930/0.899</td>
<td id="S5.T2.5.1.5.5" class="ltx_td ltx_align_center">1.232/1.200</td>
<td id="S5.T2.5.1.5.6" class="ltx_td ltx_align_center">0.697/0.676</td>
<td id="S5.T2.5.1.5.7" class="ltx_td ltx_align_center">0.817/0.808</td>
</tr>
<tr id="S5.T2.5.1.6" class="ltx_tr">
<td id="S5.T2.5.1.6.1" class="ltx_td ltx_align_center">FedAvg</td>
<td id="S5.T2.5.1.6.2" class="ltx_td ltx_align_center">0.611/0.591</td>
<td id="S5.T2.5.1.6.3" class="ltx_td ltx_align_center">0.823/0.810</td>
<td id="S5.T2.5.1.6.4" class="ltx_td ltx_align_center">0.998/0.896</td>
<td id="S5.T2.5.1.6.5" class="ltx_td ltx_align_center">1.118/1.115</td>
<td id="S5.T2.5.1.6.6" class="ltx_td ltx_align_center">0.706/0.699</td>
<td id="S5.T2.5.1.6.7" class="ltx_td ltx_align_center">0.832/0.821</td>
</tr>
<tr id="S5.T2.5.1.7" class="ltx_tr">
<td id="S5.T2.5.1.7.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="5"><span id="S5.T2.5.1.7.1.1" class="ltx_text">Transformer</span></td>
<td id="S5.T2.5.1.7.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T2.5.1.7.2.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedAtt)</td>
<td id="S5.T2.5.1.7.3" class="ltx_td ltx_align_center ltx_border_t">0.383/0.357</td>
<td id="S5.T2.5.1.7.4" class="ltx_td ltx_align_center ltx_border_t">0.735/0.618</td>
<td id="S5.T2.5.1.7.5" class="ltx_td ltx_align_center ltx_border_t">0.576/<span id="S5.T2.5.1.7.5.1" class="ltx_text ltx_font_bold">0.520</span>
</td>
<td id="S5.T2.5.1.7.6" class="ltx_td ltx_align_center ltx_border_t">0.603/0.575</td>
<td id="S5.T2.5.1.7.7" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T2.5.1.7.7.1" class="ltx_text ltx_font_bold">0.511</span>/0.482</td>
<td id="S5.T2.5.1.7.8" class="ltx_td ltx_align_center ltx_border_t">0.642/0.610</td>
</tr>
<tr id="S5.T2.5.1.8" class="ltx_tr">
<td id="S5.T2.5.1.8.1" class="ltx_td ltx_align_center">
<span id="S5.T2.5.1.8.1.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedProx)</td>
<td id="S5.T2.5.1.8.2" class="ltx_td ltx_align_center">0.399/0.385</td>
<td id="S5.T2.5.1.8.3" class="ltx_td ltx_align_center">0.691/0.633</td>
<td id="S5.T2.5.1.8.4" class="ltx_td ltx_align_center">0.564/0.542</td>
<td id="S5.T2.5.1.8.5" class="ltx_td ltx_align_center">0.686/0.667</td>
<td id="S5.T2.5.1.8.6" class="ltx_td ltx_align_center">0.556/0.512</td>
<td id="S5.T2.5.1.8.7" class="ltx_td ltx_align_center">0.702/0.651</td>
</tr>
<tr id="S5.T2.5.1.9" class="ltx_tr">
<td id="S5.T2.5.1.9.1" class="ltx_td ltx_align_center">
<span id="S5.T2.5.1.9.1.1" class="ltx_text ltx_font_italic">MetePFL</span> (Scaffold)</td>
<td id="S5.T2.5.1.9.2" class="ltx_td ltx_align_center">0.385/0.353</td>
<td id="S5.T2.5.1.9.3" class="ltx_td ltx_align_center">0.755/0.627</td>
<td id="S5.T2.5.1.9.4" class="ltx_td ltx_align_center">0.602/0.531</td>
<td id="S5.T2.5.1.9.5" class="ltx_td ltx_align_center">0.727/0.600</td>
<td id="S5.T2.5.1.9.6" class="ltx_td ltx_align_center">0.560/0.512</td>
<td id="S5.T2.5.1.9.7" class="ltx_td ltx_align_center">0.719/0.645</td>
</tr>
<tr id="S5.T2.5.1.10" class="ltx_tr">
<td id="S5.T2.5.1.10.1" class="ltx_td ltx_align_center">
<span id="S5.T2.5.1.10.1.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedAvg)</td>
<td id="S5.T2.5.1.10.2" class="ltx_td ltx_align_center">0.389/0.376</td>
<td id="S5.T2.5.1.10.3" class="ltx_td ltx_align_center">0.631/0.626</td>
<td id="S5.T2.5.1.10.4" class="ltx_td ltx_align_center">0.592/0.522</td>
<td id="S5.T2.5.1.10.5" class="ltx_td ltx_align_center">0.611/0.597</td>
<td id="S5.T2.5.1.10.6" class="ltx_td ltx_align_center">0.584/0.485</td>
<td id="S5.T2.5.1.10.7" class="ltx_td ltx_align_center">0.721/0.610</td>
</tr>
<tr id="S5.T2.5.1.11" class="ltx_tr">
<td id="S5.T2.5.1.11.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.5.1.11.1.1" class="ltx_text ltx_font_italic">MetePFL</span></td>
<td id="S5.T2.5.1.11.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.5.1.11.2.1" class="ltx_text ltx_font_bold">0.378</span>/<span id="S5.T2.5.1.11.2.2" class="ltx_text ltx_font_bold">0.342</span>
</td>
<td id="S5.T2.5.1.11.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.5.1.11.3.1" class="ltx_text ltx_font_bold">0.628</span>/<span id="S5.T2.5.1.11.3.2" class="ltx_text ltx_font_bold">0.605</span>
</td>
<td id="S5.T2.5.1.11.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.5.1.11.4.1" class="ltx_text ltx_font_bold">0.556</span>/0.542</td>
<td id="S5.T2.5.1.11.5" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.5.1.11.5.1" class="ltx_text ltx_font_bold">0.601</span>/<span id="S5.T2.5.1.11.5.2" class="ltx_text ltx_font_bold">0.569</span>
</td>
<td id="S5.T2.5.1.11.6" class="ltx_td ltx_align_center ltx_border_bb">0.521/<span id="S5.T2.5.1.11.6.1" class="ltx_text ltx_font_bold">0.460</span>
</td>
<td id="S5.T2.5.1.11.7" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.5.1.11.7.1" class="ltx_text ltx_font_bold">0.642</span>/<span id="S5.T2.5.1.11.7.2" class="ltx_text ltx_font_bold">0.589</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance comparison between fine-tuned Transformer and <span id="S5.T2.9.1" class="ltx_text ltx_font_italic">MetePFL</span> with different FL algorithm, <math id="S5.T2.3.m1.1" class="ltx_Math" alttext="*" display="inline"><semantics id="S5.T2.3.m1.1b"><mo id="S5.T2.3.m1.1.1" xref="S5.T2.3.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.m1.1c"><times id="S5.T2.3.m1.1.1.cmml" xref="S5.T2.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.m1.1d">*</annotation></semantics></math> implying that the model applies fine-tuning strategy, the <span id="S5.T2.10.2" class="ltx_text ltx_font_italic">MetePFL</span> (<math id="S5.T2.4.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="S5.T2.4.m2.1b"><mo id="S5.T2.4.m2.1.1" xref="S5.T2.4.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.m2.1c"><ci id="S5.T2.4.m2.1.1.cmml" xref="S5.T2.4.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.m2.1d">\cdot</annotation></semantics></math>) means that the implementation based on other FL algorithm, <span id="S5.T2.11.3" class="ltx_text ltx_font_bold">Bold</span> means the optimal results.</figcaption>
</figure>
</section>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Overall Comparison</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">Table <a href="#S5.T1" title="Table 1 ‣ Experimental Setups. ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> presents a performance comparison between our <span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_italic">MetePFL</span> and baselines. Results indicate the superiority of the Transformer-based model over the LSTM-based model and STGCN when trained centrally across all three datasets. However, when utilized as a FM within the FL framework, the performance of the Transformer-based model is diminished compared to the trained FM. This reduction can be attributed to the heterogeneity of weather data collected from multiple sensors. Notably, while the Transformer may be less effective than other similar models in centralized training, it demonstrates a significant performance advantage over Fed-FEDformer, Fed-Autoformer, and Fed-Informer when employed as an FM within the <span id="S5.SS1.p1.1.2" class="ltx_text ltx_font_italic">MetePFL</span>. This observation suggests that STP enhances the Transformer’s capability to comprehend spatiotemporal data. Furthermore, our reliable FM and aggregation algorithms (Transformer and FedAvg) surpass PromptFL <cite class="ltx_cite ltx_citemacro_cite">Guo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2022</a>)</cite>. This outcome provides additional validation of the effectiveness and superiority of our proposed <span id="S5.SS1.p1.1.3" class="ltx_text ltx_font_italic">MetePFL</span>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">To evaluate the effectiveness and superiority of <span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_italic">MetePFL</span> over fine-tuning, we implement different <span id="S5.SS1.p2.1.2" class="ltx_text ltx_font_italic">MetePFL</span> version based on four popular FL algoirthms: FedAtt <cite class="ltx_cite ltx_citemacro_cite">Jiang <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">Sahu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>, Scaffold <cite class="ltx_cite ltx_citemacro_cite">Karimireddy <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>, and FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>. We maintained the prompt setting and compared the results against fine-tuning. The results are presented in Table <a href="#S5.T2" title="Table 2 ‣ Experimental Setups. ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Our experiments reveal the following findings: (1) <span id="S5.SS1.p2.1.3" class="ltx_text ltx_font_italic">MetePFL</span> outperforms the fine-tuning method, highlighting the sensitivity of spatiotemporal data correlation to the STP approach; (2) the graph-based aggregation used in <span id="S5.SS1.p2.1.4" class="ltx_text ltx_font_italic">MetePFL</span> surpasses other algorithms, indicating its effectiveness in mitigating the negative impact of Non-IID on performance.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<div id="S5.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:151.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-99.6pt,41.1pt) scale(0.649065034340191,0.649065034340191) ;">
<table id="S5.T3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<td id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">Model</td>
<td id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Strategy</td>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">AvePRE</td>
<td id="S5.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">SurTEMP</td>
<td id="S5.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">SurUPS</td>
</tr>
<tr id="S5.T3.1.1.2" class="ltx_tr">
<td id="S5.T3.1.1.2.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="6"><span id="S5.T3.1.1.2.1.1" class="ltx_text">Fed-Informer</span></td>
<td id="S5.T3.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">Fine-tuning (FedAvg)</td>
<td id="S5.T3.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">0.397/0.391</td>
<td id="S5.T3.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">0.776/0.759</td>
<td id="S5.T3.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">0.734/0.713</td>
<td id="S5.T3.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">0.874/0.864</td>
<td id="S5.T3.1.1.2.7" class="ltx_td ltx_align_center ltx_border_t">0.669/0.631</td>
<td id="S5.T3.1.1.2.8" class="ltx_td ltx_align_center ltx_border_t">0.824/0.781</td>
</tr>
<tr id="S5.T3.1.1.3" class="ltx_tr">
<td id="S5.T3.1.1.3.1" class="ltx_td ltx_align_center">Fine-tuning (FedAtt)</td>
<td id="S5.T3.1.1.3.2" class="ltx_td ltx_align_center">0.403/0.378</td>
<td id="S5.T3.1.1.3.3" class="ltx_td ltx_align_center">0.780/0.724</td>
<td id="S5.T3.1.1.3.4" class="ltx_td ltx_align_center">0.950/0.899</td>
<td id="S5.T3.1.1.3.5" class="ltx_td ltx_align_center">1.057/1.00</td>
<td id="S5.T3.1.1.3.6" class="ltx_td ltx_align_center">0.686/0.675</td>
<td id="S5.T3.1.1.3.7" class="ltx_td ltx_align_center">0.807/0.793</td>
</tr>
<tr id="S5.T3.1.1.4" class="ltx_tr">
<td id="S5.T3.1.1.4.1" class="ltx_td ltx_align_center ltx_border_t">PromptFL</td>
<td id="S5.T3.1.1.4.2" class="ltx_td ltx_align_center ltx_border_t">0.407/0.361</td>
<td id="S5.T3.1.1.4.3" class="ltx_td ltx_align_center ltx_border_t">0.742/0.727</td>
<td id="S5.T3.1.1.4.4" class="ltx_td ltx_align_center ltx_border_t">0.722/0.700</td>
<td id="S5.T3.1.1.4.5" class="ltx_td ltx_align_center ltx_border_t">0.867/0.832</td>
<td id="S5.T3.1.1.4.6" class="ltx_td ltx_align_center ltx_border_t">0.671/0.658</td>
<td id="S5.T3.1.1.4.7" class="ltx_td ltx_align_center ltx_border_t">0.786/0.753</td>
</tr>
<tr id="S5.T3.1.1.5" class="ltx_tr">
<td id="S5.T3.1.1.5.1" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.5.1.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedAvg)</td>
<td id="S5.T3.1.1.5.2" class="ltx_td ltx_align_center">0.382/<span id="S5.T3.1.1.5.2.1" class="ltx_text ltx_font_bold">0.357</span>
</td>
<td id="S5.T3.1.1.5.3" class="ltx_td ltx_align_center">0.631/0.618</td>
<td id="S5.T3.1.1.5.4" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.5.4.1" class="ltx_text ltx_font_bold">0.701</span>/0.692</td>
<td id="S5.T3.1.1.5.5" class="ltx_td ltx_align_center">0.840/0.812</td>
<td id="S5.T3.1.1.5.6" class="ltx_td ltx_align_center">0.698/0.650</td>
<td id="S5.T3.1.1.5.7" class="ltx_td ltx_align_center">0.796/<span id="S5.T3.1.1.5.7.1" class="ltx_text ltx_font_bold">0.725</span>
</td>
</tr>
<tr id="S5.T3.1.1.6" class="ltx_tr">
<td id="S5.T3.1.1.6.1" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.6.1.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedAtt)</td>
<td id="S5.T3.1.1.6.2" class="ltx_td ltx_align_center">0.392/0.387</td>
<td id="S5.T3.1.1.6.3" class="ltx_td ltx_align_center">0.776/0.758</td>
<td id="S5.T3.1.1.6.4" class="ltx_td ltx_align_center">0.754/0.696</td>
<td id="S5.T3.1.1.6.5" class="ltx_td ltx_align_center">0.905/0.839</td>
<td id="S5.T3.1.1.6.6" class="ltx_td ltx_align_center">0.669/<span id="S5.T3.1.1.6.6.1" class="ltx_text ltx_font_bold">0.644</span>
</td>
<td id="S5.T3.1.1.6.7" class="ltx_td ltx_align_center">0.772/0.738</td>
</tr>
<tr id="S5.T3.1.1.7" class="ltx_tr">
<td id="S5.T3.1.1.7.1" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.7.1.1" class="ltx_text ltx_font_italic">MetePFL</span></td>
<td id="S5.T3.1.1.7.2" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.7.2.1" class="ltx_text ltx_font_bold">0.363</span>/0.358</td>
<td id="S5.T3.1.1.7.3" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.7.3.1" class="ltx_text ltx_font_bold">0.630</span>/<span id="S5.T3.1.1.7.3.2" class="ltx_text ltx_font_bold">0.601</span>
</td>
<td id="S5.T3.1.1.7.4" class="ltx_td ltx_align_center">0.713/<span id="S5.T3.1.1.7.4.1" class="ltx_text ltx_font_bold">0.677</span>
</td>
<td id="S5.T3.1.1.7.5" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.7.5.1" class="ltx_text ltx_font_bold">0.838</span>/<span id="S5.T3.1.1.7.5.2" class="ltx_text ltx_font_bold">0.800</span>
</td>
<td id="S5.T3.1.1.7.6" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.7.6.1" class="ltx_text ltx_font_bold">0.652</span>/<span id="S5.T3.1.1.7.6.2" class="ltx_text ltx_font_bold">0.644</span>
</td>
<td id="S5.T3.1.1.7.7" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.7.7.1" class="ltx_text ltx_font_bold">0.755</span>/0.739</td>
</tr>
<tr id="S5.T3.1.1.8" class="ltx_tr">
<td id="S5.T3.1.1.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="6"><span id="S5.T3.1.1.8.1.1" class="ltx_text">Fed-Autoformer</span></td>
<td id="S5.T3.1.1.8.2" class="ltx_td ltx_align_center ltx_border_t">Fine-tuning (FedAvg)</td>
<td id="S5.T3.1.1.8.3" class="ltx_td ltx_align_center ltx_border_t">0.378/0.373</td>
<td id="S5.T3.1.1.8.4" class="ltx_td ltx_align_center ltx_border_t">0.761/0.758</td>
<td id="S5.T3.1.1.8.5" class="ltx_td ltx_align_center ltx_border_t">0.693/0.682</td>
<td id="S5.T3.1.1.8.6" class="ltx_td ltx_align_center ltx_border_t">0.848/0.834</td>
<td id="S5.T3.1.1.8.7" class="ltx_td ltx_align_center ltx_border_t">0.610/0.523</td>
<td id="S5.T3.1.1.8.8" class="ltx_td ltx_align_center ltx_border_t">0.767/0.721</td>
</tr>
<tr id="S5.T3.1.1.9" class="ltx_tr">
<td id="S5.T3.1.1.9.1" class="ltx_td ltx_align_center">Fine-tuning (FedAtt)</td>
<td id="S5.T3.1.1.9.2" class="ltx_td ltx_align_center">0.372/0.355</td>
<td id="S5.T3.1.1.9.3" class="ltx_td ltx_align_center">0.761/0.754</td>
<td id="S5.T3.1.1.9.4" class="ltx_td ltx_align_center">0.706/0.683</td>
<td id="S5.T3.1.1.9.5" class="ltx_td ltx_align_center">0.848/0.839</td>
<td id="S5.T3.1.1.9.6" class="ltx_td ltx_align_center">0.598/0.551</td>
<td id="S5.T3.1.1.9.7" class="ltx_td ltx_align_center">0.742/0.698</td>
</tr>
<tr id="S5.T3.1.1.10" class="ltx_tr">
<td id="S5.T3.1.1.10.1" class="ltx_td ltx_align_center ltx_border_t">PromptFL</td>
<td id="S5.T3.1.1.10.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T3.1.1.10.2.1" class="ltx_text ltx_font_bold">0.355</span>/0.348</td>
<td id="S5.T3.1.1.10.3" class="ltx_td ltx_align_center ltx_border_t">0.759/0.753</td>
<td id="S5.T3.1.1.10.4" class="ltx_td ltx_align_center ltx_border_t">0.672/0.659</td>
<td id="S5.T3.1.1.10.5" class="ltx_td ltx_align_center ltx_border_t">0.826/0.807</td>
<td id="S5.T3.1.1.10.6" class="ltx_td ltx_align_center ltx_border_t">0.584/0.543</td>
<td id="S5.T3.1.1.10.7" class="ltx_td ltx_align_center ltx_border_t">0.724/0.678</td>
</tr>
<tr id="S5.T3.1.1.11" class="ltx_tr">
<td id="S5.T3.1.1.11.1" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.11.1.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedAvg)</td>
<td id="S5.T3.1.1.11.2" class="ltx_td ltx_align_center">0.364/0.348</td>
<td id="S5.T3.1.1.11.3" class="ltx_td ltx_align_center">0.780/0.731</td>
<td id="S5.T3.1.1.11.4" class="ltx_td ltx_align_center">0.674/<span id="S5.T3.1.1.11.4.1" class="ltx_text ltx_font_bold">0.630</span>
</td>
<td id="S5.T3.1.1.11.5" class="ltx_td ltx_align_center">0.820/0.781</td>
<td id="S5.T3.1.1.11.6" class="ltx_td ltx_align_center">0.564/0.520</td>
<td id="S5.T3.1.1.11.7" class="ltx_td ltx_align_center">0.736/0.656</td>
</tr>
<tr id="S5.T3.1.1.12" class="ltx_tr">
<td id="S5.T3.1.1.12.1" class="ltx_td ltx_align_center">
<span id="S5.T3.1.1.12.1.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedAtt)</td>
<td id="S5.T3.1.1.12.2" class="ltx_td ltx_align_center">0.372/0.341</td>
<td id="S5.T3.1.1.12.3" class="ltx_td ltx_align_center">0.762/0.754</td>
<td id="S5.T3.1.1.12.4" class="ltx_td ltx_align_center">0.689/0.641</td>
<td id="S5.T3.1.1.12.5" class="ltx_td ltx_align_center">0.824/0.766</td>
<td id="S5.T3.1.1.12.6" class="ltx_td ltx_align_center">0.549/0.525</td>
<td id="S5.T3.1.1.12.7" class="ltx_td ltx_align_center">0.717/0.650</td>
</tr>
<tr id="S5.T3.1.1.13" class="ltx_tr">
<td id="S5.T3.1.1.13.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.1.1.13.1.1" class="ltx_text ltx_font_italic">MetePFL</span></td>
<td id="S5.T3.1.1.13.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.1.1.13.2.1" class="ltx_text ltx_font_bold">0.355</span>/<span id="S5.T3.1.1.13.2.2" class="ltx_text ltx_font_bold">0.334</span>
</td>
<td id="S5.T3.1.1.13.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.1.1.13.3.1" class="ltx_text ltx_font_bold">0.750</span>/<span id="S5.T3.1.1.13.3.2" class="ltx_text ltx_font_bold">0.719</span>
</td>
<td id="S5.T3.1.1.13.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.1.1.13.4.1" class="ltx_text ltx_font_bold">0.666</span>/<span id="S5.T3.1.1.13.4.2" class="ltx_text ltx_font_bold">0.630</span>
</td>
<td id="S5.T3.1.1.13.5" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.1.1.13.5.1" class="ltx_text ltx_font_bold">0.814</span>/<span id="S5.T3.1.1.13.5.2" class="ltx_text ltx_font_bold">0.750</span>
</td>
<td id="S5.T3.1.1.13.6" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.1.1.13.6.1" class="ltx_text ltx_font_bold">0.547</span>/<span id="S5.T3.1.1.13.6.2" class="ltx_text ltx_font_bold">0.516</span>
</td>
<td id="S5.T3.1.1.13.7" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.1.1.13.7.1" class="ltx_text ltx_font_bold">0.712</span>/<span id="S5.T3.1.1.13.7.2" class="ltx_text ltx_font_bold">0.649</span>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance comparison of pre-trained Fed-Informer and Fed-Autoformer with different learning strategies, <span id="S5.T3.5.1" class="ltx_text ltx_font_italic">MetePFL</span> (FedAvg) and <span id="S5.T3.6.2" class="ltx_text ltx_font_italic">MetePFL</span> (FedAtt) implies the FedAvg- and FedAtt-based implementations, respectively, <span id="S5.T3.7.3" class="ltx_text ltx_font_bold">Bold</span> means the optimal performance.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Framework Applicability</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">To determine the applicability of <span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_italic">MetePFL</span>, we replaced its FM with pre-trained Informer and Autoformer using the same pre-training strategy. Additionally, we used fine-tuning and PromptFL as reference strategies based on FedAvg and FedAtt. The comparison results as shown in Table <a href="#S5.T3" title="Table 3 ‣ 5.1 Overall Comparison ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Our proposed <span id="S5.SS2.p1.1.2" class="ltx_text ltx_font_italic">MetePFL</span> remains valid for other Transformer-based FMs and significantly outperforms fine-tuning and PromptFL. By comparing the performance of <span id="S5.SS2.p1.1.3" class="ltx_text ltx_font_italic">MetePFL</span> under different FL algorithm, we demonstrate the effectiveness of the graph-based aggregation once again.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Parameter Utilization</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.6" class="ltx_p">Table <a href="#S5.T4" title="Table 4 ‣ 5.3 Parameter Utilization ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> compares parameter utilization for different federated prompt learning strategies. PromptFL and <span id="S5.SS3.p1.6.1" class="ltx_text ltx_font_italic">MetePFL</span> are significantly more advantageous than regular training (train from scratch) and fine-tuning, with parameter utilization of 2.22<math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mo id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><csymbol cd="latexml" id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\%</annotation></semantics></math> and 2.38<math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mo id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><csymbol cd="latexml" id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\%</annotation></semantics></math>, respectively - nearly 28<math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mo id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><csymbol cd="latexml" id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\%</annotation></semantics></math> lower than fine-tuning. While PromptFL is better than <span id="S5.SS3.p1.6.2" class="ltx_text ltx_font_italic">MetePFL</span> in parameter utilization (-0.16<math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mo id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><csymbol cd="latexml" id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">\%</annotation></semantics></math>), it performs nearly 20<math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mo id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><csymbol cd="latexml" id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">\%</annotation></semantics></math> worse than <span id="S5.SS3.p1.6.3" class="ltx_text ltx_font_italic">MetePFL</span> (see Table <a href="#S5.T1" title="Table 1 ‣ Experimental Setups. ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Despite considering only 2.38<math id="S5.SS3.p1.6.m6.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.SS3.p1.6.m6.1a"><mo id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.1b"><csymbol cd="latexml" id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.1c">\%</annotation></semantics></math> parameters, <span id="S5.SS3.p1.6.4" class="ltx_text ltx_font_italic">MetePFL</span> achieves excellent performance and significantly improves inter-device communication efficiency.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<div id="S5.T4.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:212.5pt;height:46.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-97.7pt,21.6pt) scale(0.521022267684412,0.521022267684412) ;">
<table id="S5.T4.7.7" class="ltx_tabular ltx_align_middle">
<tr id="S5.T4.3.3.3" class="ltx_tr">
<td id="S5.T4.3.3.3.4" class="ltx_td ltx_align_center ltx_border_tt">Strategy</td>
<td id="S5.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">
<math id="S5.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\#" display="inline"><semantics id="S5.T4.1.1.1.1.m1.1a"><mi mathvariant="normal" id="S5.T4.1.1.1.1.m1.1.1" xref="S5.T4.1.1.1.1.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.1.m1.1b"><ci id="S5.T4.1.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.1.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.1.m1.1c">\#</annotation></semantics></math> of Total Param</td>
<td id="S5.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt">
<math id="S5.T4.2.2.2.2.m1.1" class="ltx_Math" alttext="\#" display="inline"><semantics id="S5.T4.2.2.2.2.m1.1a"><mi mathvariant="normal" id="S5.T4.2.2.2.2.m1.1.1" xref="S5.T4.2.2.2.2.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.2.m1.1b"><ci id="S5.T4.2.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.2.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.2.m1.1c">\#</annotation></semantics></math> of Training Param</td>
<td id="S5.T4.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt">
<math id="S5.T4.3.3.3.3.m1.1" class="ltx_Math" alttext="\#" display="inline"><semantics id="S5.T4.3.3.3.3.m1.1a"><mi mathvariant="normal" id="S5.T4.3.3.3.3.m1.1.1" xref="S5.T4.3.3.3.3.m1.1.1.cmml">#</mi><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.3.m1.1b"><ci id="S5.T4.3.3.3.3.m1.1.1.cmml" xref="S5.T4.3.3.3.3.m1.1.1">#</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.3.m1.1c">\#</annotation></semantics></math> of Participation Param</td>
</tr>
<tr id="S5.T4.4.4.4" class="ltx_tr">
<td id="S5.T4.4.4.4.2" class="ltx_td ltx_align_center ltx_border_t">FL-Regular</td>
<td id="S5.T4.4.4.4.3" class="ltx_td ltx_align_center ltx_border_t">3,229,857</td>
<td id="S5.T4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t">3,229,857</td>
<td id="S5.T4.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t">100<math id="S5.T4.4.4.4.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T4.4.4.4.1.m1.1a"><mo id="S5.T4.4.4.4.1.m1.1.1" xref="S5.T4.4.4.4.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S5.T4.4.4.4.1.m1.1.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.4.1.m1.1c">\%</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T4.5.5.5" class="ltx_tr">
<td id="S5.T4.5.5.5.2" class="ltx_td ltx_align_center">FL-Fine Tuning</td>
<td id="S5.T4.5.5.5.3" class="ltx_td ltx_align_center">3,288,886</td>
<td id="S5.T4.5.5.5.4" class="ltx_td ltx_align_center">109,854</td>
<td id="S5.T4.5.5.5.1" class="ltx_td ltx_align_center">30.37<math id="S5.T4.5.5.5.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T4.5.5.5.1.m1.1a"><mo id="S5.T4.5.5.5.1.m1.1.1" xref="S5.T4.5.5.5.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.5.1.m1.1b"><csymbol cd="latexml" id="S5.T4.5.5.5.1.m1.1.1.cmml" xref="S5.T4.5.5.5.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.5.1.m1.1c">\%</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T4.6.6.6" class="ltx_tr">
<td id="S5.T4.6.6.6.2" class="ltx_td ltx_align_center">PromptFL</td>
<td id="S5.T4.6.6.6.3" class="ltx_td ltx_align_center">3,250,867</td>
<td id="S5.T4.6.6.6.4" class="ltx_td ltx_align_center">71,835</td>
<td id="S5.T4.6.6.6.1" class="ltx_td ltx_align_center">2.22<math id="S5.T4.6.6.6.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T4.6.6.6.1.m1.1a"><mo id="S5.T4.6.6.6.1.m1.1.1" xref="S5.T4.6.6.6.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.6.1.m1.1b"><csymbol cd="latexml" id="S5.T4.6.6.6.1.m1.1.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.6.1.m1.1c">\%</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T4.7.7.7" class="ltx_tr">
<td id="S5.T4.7.7.7.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T4.7.7.7.2.1" class="ltx_text ltx_font_italic">MetePFL</span> (Ours)</td>
<td id="S5.T4.7.7.7.3" class="ltx_td ltx_align_center ltx_border_bb">3,258,547</td>
<td id="S5.T4.7.7.7.4" class="ltx_td ltx_align_center ltx_border_bb">77,595</td>
<td id="S5.T4.7.7.7.1" class="ltx_td ltx_align_center ltx_border_bb">2.38<math id="S5.T4.7.7.7.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T4.7.7.7.1.m1.1a"><mo id="S5.T4.7.7.7.1.m1.1.1" xref="S5.T4.7.7.7.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T4.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T4.7.7.7.1.m1.1.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.7.7.1.m1.1c">\%</annotation></semantics></math>
</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of parameter utilization of <span id="S5.T4.9.1" class="ltx_text ltx_font_italic">MetePFL</span>.</figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation Study</h3>

<figure id="S5.T5" class="ltx_table">
<div id="S5.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:195.1pt;height:76pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-41.0pt,16.0pt) scale(0.703936801902298,0.703936801902298) ;">
<table id="S5.T5.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T5.1.1.1" class="ltx_tr">
<td id="S5.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">Model</td>
<td id="S5.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Strategy</td>
<td id="S5.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">MAE</td>
<td id="S5.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">RMSE</td>
</tr>
<tr id="S5.T5.1.1.2" class="ltx_tr">
<td id="S5.T5.1.1.2.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="4"><span id="S5.T5.1.1.2.1.1" class="ltx_text">Encoder-only</span></td>
<td id="S5.T5.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">Train from scratch</td>
<td id="S5.T5.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">0.332</td>
<td id="S5.T5.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">0.744</td>
</tr>
<tr id="S5.T5.1.1.3" class="ltx_tr">
<td id="S5.T5.1.1.3.1" class="ltx_td ltx_align_center">Train from scratch &amp; STP</td>
<td id="S5.T5.1.1.3.2" class="ltx_td ltx_align_center">0.300</td>
<td id="S5.T5.1.1.3.3" class="ltx_td ltx_align_center">0.689</td>
</tr>
<tr id="S5.T5.1.1.4" class="ltx_tr">
<td id="S5.T5.1.1.4.1" class="ltx_td ltx_align_center">Pre-train</td>
<td id="S5.T5.1.1.4.2" class="ltx_td ltx_align_center">0.295</td>
<td id="S5.T5.1.1.4.3" class="ltx_td ltx_align_center">0.668</td>
</tr>
<tr id="S5.T5.1.1.5" class="ltx_tr">
<td id="S5.T5.1.1.5.1" class="ltx_td ltx_align_center">Pre-train &amp; STP</td>
<td id="S5.T5.1.1.5.2" class="ltx_td ltx_align_center">0.267</td>
<td id="S5.T5.1.1.5.3" class="ltx_td ltx_align_center">0.571</td>
</tr>
<tr id="S5.T5.1.1.6" class="ltx_tr">
<td id="S5.T5.1.1.6.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Decoder-only</td>
<td id="S5.T5.1.1.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Train from scratch</td>
<td id="S5.T5.1.1.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.304</td>
<td id="S5.T5.1.1.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.724</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span><span id="S5.T5.3.1" class="ltx_text" style="font-size:90%;">Comparison of Encoder/Decoder-only Transformer under different strategies in general scenarios based on AvePRE.</span></figcaption>
</figure>
<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">To evaluate the effectiveness of STP, we conducted ablation studies under general scenarios rather than under the FL framework. The results are presented in Table <a href="#S5.T5" title="Table 5 ‣ 5.4 Ablation Study ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The Encoder-only and Decoder-only Transformer underwent pre-training with one-step forecasting and auto-regressive mechanisms similar to previous experiments. The Encoder-only Transformer trained with STP outperformed the Decoder-only Transformer, indicating the superior learning mechanism of the proposed STP over conventional auto-regression. Moreover, the performance gap between the pre-trained Encoder with and without STP confirms the efficacy of the proposed STP in general scenarios.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<div id="S5.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:138.8pt;height:73.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-33.1pt,17.4pt) scale(0.676930683348138,0.676930683348138) ;">
<table id="S5.T6.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T6.1.1.1" class="ltx_tr">
<td id="S5.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">TPL</td>
<td id="S5.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">SPL</td>
<td id="S5.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Gate</td>
<td id="S5.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">PE</td>
<td id="S5.T6.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">MAE</td>
<td id="S5.T6.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">RMSE</td>
</tr>
<tr id="S5.T6.1.1.2" class="ltx_tr">
<td id="S5.T6.1.1.2.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.2.1.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.2.2.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.2.3.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.2.4.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">0.301</td>
<td id="S5.T6.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">0.608</td>
</tr>
<tr id="S5.T6.1.1.3" class="ltx_tr">
<td id="S5.T6.1.1.3.1" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.3.1.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.3.2" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.3.2.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.3.3" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.3.3.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.3.4" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.3.4.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.3.5" class="ltx_td ltx_align_center">0.267</td>
<td id="S5.T6.1.1.3.6" class="ltx_td ltx_align_center">0.571</td>
</tr>
<tr id="S5.T6.1.1.4" class="ltx_tr">
<td id="S5.T6.1.1.4.1" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.4.1.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.4.2" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.4.2.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.4.3" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.4.3.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.4.4" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.4.4.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.4.5" class="ltx_td ltx_align_center">0.284</td>
<td id="S5.T6.1.1.4.6" class="ltx_td ltx_align_center">0.580</td>
</tr>
<tr id="S5.T6.1.1.5" class="ltx_tr">
<td id="S5.T6.1.1.5.1" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.5.1.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.5.2" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.5.2.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.5.3" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.5.3.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.5.4" class="ltx_td ltx_align_center"><span id="S5.T6.1.1.5.4.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.5.5" class="ltx_td ltx_align_center">0.299</td>
<td id="S5.T6.1.1.5.6" class="ltx_td ltx_align_center">0.613</td>
</tr>
<tr id="S5.T6.1.1.6" class="ltx_tr">
<td id="S5.T6.1.1.6.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T6.1.1.6.1.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.6.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T6.1.1.6.2.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.6.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T6.1.1.6.3.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T6.1.1.6.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T6.1.1.6.4.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T6.1.1.6.5" class="ltx_td ltx_align_center ltx_border_bb">0.284</td>
<td id="S5.T6.1.1.6.6" class="ltx_td ltx_align_center ltx_border_bb">0.617</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation results of the proposed STP in Encoder-only Transformer based on the AvePRE in general scenarios.</figcaption>
</figure>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">The effectiveness of SPL, Gate, and their advantage over position-aware embedding (PE) was verified using the Encoder-only Transformer. The results are presented in Table <a href="#S5.T6" title="Table 6 ‣ 5.4 Ablation Study ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. SPL demonstrates a greater improvement compared to PE. Additionally, SPL enhances the model’s performance, while the model without Gate experiences a significant decline. TPL does not perform as effectively as desired in generic scenarios. Consequently, we conducted ablation experiments in the FL setting, as shown in Table <a href="#S5.T7" title="Table 7 ‣ 5.4 Ablation Study ‣ 5 Experiments ‣ Prompt Federated Learning for Weather Forecasting: Toward Foundation Models on Meteorological Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. The results indicate that both TPL and SPL enhance the model’s forecasting performance. In conclusion, the effectiveness of the Gate operation is demonstrated, and both TPL and SPL can improve the model’s performance in the FL setting.</p>
</div>
<figure id="S5.T7" class="ltx_table">
<table id="S5.T7.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T7.1.1" class="ltx_tr">
<td id="S5.T7.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">TPL</td>
<td id="S5.T7.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">SPL</td>
<td id="S5.T7.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Gate</td>
<td id="S5.T7.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">MAE</td>
<td id="S5.T7.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">RMSE</td>
</tr>
<tr id="S5.T7.1.2" class="ltx_tr">
<td id="S5.T7.1.2.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T7.1.2.1.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T7.1.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T7.1.2.2.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T7.1.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T7.1.2.3.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T7.1.2.4" class="ltx_td ltx_align_center ltx_border_t">0.378</td>
<td id="S5.T7.1.2.5" class="ltx_td ltx_align_center ltx_border_t">0.628</td>
</tr>
<tr id="S5.T7.1.3" class="ltx_tr">
<td id="S5.T7.1.3.1" class="ltx_td ltx_align_center"><span id="S5.T7.1.3.1.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T7.1.3.2" class="ltx_td ltx_align_center"><span id="S5.T7.1.3.2.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T7.1.3.3" class="ltx_td ltx_align_center"><span id="S5.T7.1.3.3.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T7.1.3.4" class="ltx_td ltx_align_center">0.407</td>
<td id="S5.T7.1.3.5" class="ltx_td ltx_align_center">0.722</td>
</tr>
<tr id="S5.T7.1.4" class="ltx_tr">
<td id="S5.T7.1.4.1" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T7.1.4.1.1" class="ltx_text ltx_font_italic">w</span></td>
<td id="S5.T7.1.4.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T7.1.4.2.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T7.1.4.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T7.1.4.3.1" class="ltx_text ltx_font_italic">w/o</span></td>
<td id="S5.T7.1.4.4" class="ltx_td ltx_align_center ltx_border_bb">0.415</td>
<td id="S5.T7.1.4.5" class="ltx_td ltx_align_center ltx_border_bb">0.740</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Ablations on FL setting. </figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This paper proposes a novel machine learning approach to train foundation models for weather forecasting tasks, capable of capturing the spatiotemporal relationships of meteorological data based on multivariate time series. To enhance the performance while keeping data secure and reducing communication overhead, we introduce a prompt learning mechanism based on the fixed foundation model within the FL framework. Additionally, we utilize a graph-based approach to mitigate the impact of data heterogeneity on model effectiveness. Extensive experiments on three real-world weather datasets confirm the effectiveness of our proposed method.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alléon <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Antoine Alléon, Grégoire Jauvion, Boris Quennehen, and David Lissmyr.

</span>
<span class="ltx_bibblock">Plumenet: Large-scale air quality forecasting using a convolutional
lstm network.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2006.09204</span>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bauer <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2015]</span>
<span class="ltx_bibblock">
Peter Bauer, Alan Thorpe, and Gilbert Brunet.

</span>
<span class="ltx_bibblock">The quiet revolution of numerical weather prediction.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">Nature</span>, 525(7567):47–55, 2015.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bojesomo <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Alabi Bojesomo, Hasan Al-Marzouqi, Panos Liatsis, Gao Cong, and Maya Ramanath.

</span>
<span class="ltx_bibblock">Spatiotemporal swin-transformer network for short time weather
forecasting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">CIKM Workshops</span>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Campbell and
Diebold [2005]</span>
<span class="ltx_bibblock">
Sean D Campbell and Francis X Diebold.

</span>
<span class="ltx_bibblock">Weather forecasting for weather derivatives.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Journal of the American Statistical Association</span>,
100(469):6–16, 2005.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chattopadhyay <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Ashesh Chattopadhyay, Ebrahim Nabizadeh, and Pedram Hassanzadeh.

</span>
<span class="ltx_bibblock">Analog forecasting of extreme-causing weather patterns using deep
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">Journal of Advances in Modeling Earth Systems</span>,
12(2):e2019MS001958, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Lai [2011]</span>
<span class="ltx_bibblock">
Ling Chen and Xu Lai.

</span>
<span class="ltx_bibblock">Comparison between arima and ann models used in short-term wind speed
forecasting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">2011 Asia-Pacific Power and Energy Engineering Conference</span>,
pages 1–4. IEEE, 2011.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022a]</span>
<span class="ltx_bibblock">
Fengwen Chen, Guodong Long, Zonghan Wu, Tianyi Zhou, and Jing Jiang.

</span>
<span class="ltx_bibblock">Personalized federated learning with graph.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2203.00829</span>, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022b]</span>
<span class="ltx_bibblock">
Shengchao Chen, Ting Shu, Huan Zhao, Qilin Wan, Jincan Huang, and Cailing Li.

</span>
<span class="ltx_bibblock">Dynamic multiscale fusion generative adversarial network for radar
image extrapolation.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Geoscience and Remote Sensing</span>, 60:1–11,
2022.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen <span id="bib.bib9.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2023]</span>
<span class="ltx_bibblock">
Shengchao Chen, Ting Shu, Huan Zhao, Guo Zhong, and Xunlai Chen.

</span>
<span class="ltx_bibblock">Tempee: Temporal-spatial parallel transformer for radar echo
extrapolation beyond auto-regression.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2304.14131</span>, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Liang Gao, Huazhu Fu, Li Li, Yingwen Chen, Ming Xu, and Cheng-Zhong Xu.

</span>
<span class="ltx_bibblock">Feddc: Federated learning with non-iid data via local drift
decoupling and correction.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 10112–10121, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves [2012]</span>
<span class="ltx_bibblock">
Alex Graves.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Supervised sequence labelling with recurrent neural networks</span>,
pages 37–45, 2012.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo <span id="bib.bib12.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Tao Guo, Song Guo, Junxiao Wang, and Wenchao Xu.

</span>
<span class="ltx_bibblock">Promptfl: Let federated participants cooperatively learn prompts
instead of models–federated learning in age of foundation model.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2208.11625</span>, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hagemann <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2013]</span>
<span class="ltx_bibblock">
Stefan Hagemann, Cui Chen, Douglas B Clark, Sonja Folwell, Simon N Gosling,
Ingjerd Haddeland, Naota Hanasaki, Jens Heinke, Fulco Ludwig, Frank Voss,
et al.

</span>
<span class="ltx_bibblock">Climate change impact on available water resources obtained using
multiple global climate and hydrology models.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">Earth System Dynamics</span>, 4(1):129–144, 2013.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Jing Jiang, Shaoxiong Ji, and Guodong Long.

</span>
<span class="ltx_bibblock">Decentralized knowledge acquisition for mobile internet applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">World Wide Web</span>, 23(5):2653–2669, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karevan and
Suykens [2020]</span>
<span class="ltx_bibblock">
Zahra Karevan and Johan AK Suykens.

</span>
<span class="ltx_bibblock">Transductive lstm for time-series prediction: An application to
weather forecasting.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Neural Networks</span>, 125:1–9, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba [2014]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1412.6980</span>, 2014.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kipf and Welling [2016]</span>
<span class="ltx_bibblock">
Thomas N Kipf and Max Welling.

</span>
<span class="ltx_bibblock">Semi-supervised classification with graph convolutional networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1609.02907</span>, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kjellstrom <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
Tord Kjellstrom, David Briggs, Chris Freyberg, Bruno Lemke, Matthias Otto, and
Olivia Hyatt.

</span>
<span class="ltx_bibblock">Heat, human performance, and occupational health: a key issue for the
assessment of global climate change impacts.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">Annual review of public health</span>, 37:97–112, 2016.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang [2021]</span>
<span class="ltx_bibblock">
Xiang Lisa Li and Percy Liang.

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2101.00190</span>, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib21.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1907.02189</span>, 2019.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib22.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic">Proceedings of Machine Learning and Systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib23.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2023]</span>
<span class="ltx_bibblock">
Zhiwei Li, Guodong Long, and Tianyi Zhou.

</span>
<span class="ltx_bibblock">Federated recommendation with additive personalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2301.09109</span>, 2023.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib24.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Xiao Liu, Yanan Zheng, Zhengxiao Du, Ming Ding, Yujie Qian, Zhilin Yang, and
Jie Tang.

</span>
<span class="ltx_bibblock">Gpt understands, too.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2103.10385</span>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long <span id="bib.bib25.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Guodong Long, Yue Tan, Jing Jiang, and Chengqi Zhang.

</span>
<span class="ltx_bibblock">Federated learning for open banking.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">Federated Learning: Privacy and Incentive</span>, pages 240–254.
Springer, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long <span id="bib.bib26.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Guodong Long, Tao Shen, Yue Tan, Leah Gerrard, Allison Clarke, and Jing Jiang.

</span>
<span class="ltx_bibblock">Federated learning for privacy-preserving open innovation future on
digital health.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.3.1" class="ltx_text ltx_font_italic">Humanity Driven AI: Productivity, Well-being, Sustainability
and Partnership</span>, pages 113–133. Springer, 2021.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long <span id="bib.bib27.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2023]</span>
<span class="ltx_bibblock">
Guodong Long, Ming Xie, Tao Shen, Tianyi Zhou, Xianzhi Wang, and Jing Jiang.

</span>
<span class="ltx_bibblock">Multi-center federated learning: clients clustering for better
personalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text ltx_font_italic">World Wide Web</span>, 26(1):481–500, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma <span id="bib.bib28.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Jie Ma, Guodong Long, Tianyi Zhou, Jing Jiang, and Chengqi Zhang.

</span>
<span class="ltx_bibblock">On the convergence of clustered federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2202.06187</span>, 2022.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan <span id="bib.bib29.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.3.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford <span id="bib.bib30.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language
supervision.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.3.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
8748–8763. PMLR, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sahu <span id="bib.bib31.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Anit Kumar Sahu, Tian Li, Maziar Sanjabi, Manzil Zaheer, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">On the convergence of federated optimization in heterogeneous
networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.06127</span>, 3:3, 2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sapankevych and
Sankar [2009]</span>
<span class="ltx_bibblock">
Nicholas I Sapankevych and Ravi Sankar.

</span>
<span class="ltx_bibblock">Time series prediction using support vector machines: a survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">IEEE computational intelligence magazine</span>, 4(2):24–38, 2009.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman <span id="bib.bib33.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
J Schulman, B Zoph, C Kim, J Hilton, J Menick, J Weng, JFC Uribe, L Fedus,
L Metz, M Pokorny, et al.

</span>
<span class="ltx_bibblock">Chatgpt: Optimizing language models for dialogue, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi <span id="bib.bib34.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2015]</span>
<span class="ltx_bibblock">
Xingjian Shi, Zhourong Chen, Hao Wang, Dit-Yan Yeung, Wai-Kin Wong, and
Wang-chun Woo.

</span>
<span class="ltx_bibblock">Convolutional lstm network: A machine learning approach for
precipitation nowcasting.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 28, 2015.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan <span id="bib.bib35.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Yue Tan, Guodong Long, Lu Liu, Tianyi Zhou, Qinghua Lu, Jing Jiang, and Chengqi
Zhang.

</span>
<span class="ltx_bibblock">Fedproto: Federated prototype learning over heterogeneous devices.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2105.00243</span>, 3, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan <span id="bib.bib36.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022a]</span>
<span class="ltx_bibblock">
Yue Tan, Yixin Liu, Guodong Long, Jing Jiang, Qinghua Lu, and Chengqi Zhang.

</span>
<span class="ltx_bibblock">Federated learning on non-iid graphs via structural knowledge
sharing.

</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2211.13009</span>, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan <span id="bib.bib37.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022b]</span>
<span class="ltx_bibblock">
Yue Tan, Guodong Long, Jie Ma, Lu Liu, Tianyi Zhou, and Jing Jiang.

</span>
<span class="ltx_bibblock">Federated learning from pre-trained models: A contrastive learning
approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2209.10083</span>, 2022.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veličković <span id="bib.bib38.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero,
Pietro Lio, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Graph attention networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1710.10903</span>, 2017.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Voyant <span id="bib.bib39.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2012]</span>
<span class="ltx_bibblock">
Cyril Voyant, Marc Muselli, Christophe Paoli, and Marie-Laure Nivet.

</span>
<span class="ltx_bibblock">Numerical weather prediction (nwp) and hybrid arma/ann model to
predict global radiation.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text ltx_font_italic">Energy</span>, 39(1):341–355, 2012.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang <span id="bib.bib40.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Zhuowei Wang, Tianyi Zhou, Guodong Long, Bo Han, and Jing Jiang.

</span>
<span class="ltx_bibblock">Fednoil: a simple two-level sampling method for federated learning
with noisy labels.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2205.10110</span>, 2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu <span id="bib.bib41.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Haixu Wu, Jiehui Xu, Jianmin Wang, and Mingsheng Long.

</span>
<span class="ltx_bibblock">Autoformer: Decomposition transformers with auto-correlation for
long-term series forecasting.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
34:22419–22430, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu <span id="bib.bib42.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Yufei Xu, Jing Zhang, Qiming Zhang, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Vitpose+: Vision transformer foundation model for generic body pose
estimation.

</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2212.04246</span>, 2022.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yates <span id="bib.bib43.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Andrew Yates, Rodrigo Nogueira, and Jimmy Lin.

</span>
<span class="ltx_bibblock">Pretrained transformers for text ranking: Bert and beyond.

</span>
<span class="ltx_bibblock">In <span id="bib.bib43.3.1" class="ltx_text ltx_font_italic">Proceedings of the 14th ACM International Conference on Web
Search and Data Mining</span>, pages 1154–1156, 2021.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu <span id="bib.bib44.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Bing Yu, Haoteng Yin, and Zhanxing Zhu.

</span>
<span class="ltx_bibblock">Spatio-temporal graph convolutional networks: A deep learning
framework for traffic forecasting.

</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1709.04875</span>, 2017.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zerveas <span id="bib.bib45.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
George Zerveas, Srideepika Jayaraman, Dhaval Patel, Anuradha Bhamidipaty, and
Carsten Eickhoff.

</span>
<span class="ltx_bibblock">A transformer-based framework for multivariate time series
representation learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib45.3.1" class="ltx_text ltx_font_italic">Proceedings of the 27th ACM SIGKDD Conference on Knowledge
Discovery &amp; Data Mining</span>, pages 2114–2124, 2021.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang <span id="bib.bib46.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2023]</span>
<span class="ltx_bibblock">
Chunxu Zhang, Guodong Long, Tianyi Zhou, Peng Yan, Zijian Zhang, Chengqi Zhang,
and Bo Yang.

</span>
<span class="ltx_bibblock">Dual personalization on federated recommendation.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2301.08143</span>, 2023.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib47.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Haoyi Zhou, Shanghang Zhang, Jieqi Peng, Shuai Zhang, Jianxin Li, Hui Xiong,
and Wancai Zhang.

</span>
<span class="ltx_bibblock">Informer: Beyond efficient transformer for long sequence time-series
forecasting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib47.3.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 35, pages 11106–11115, 2021.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib48.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022a]</span>
<span class="ltx_bibblock">
Kaiyang Zhou, Jingkang Yang, Chen Change Loy, and Ziwei Liu.

</span>
<span class="ltx_bibblock">Learning to prompt for vision-language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text ltx_font_italic">International Journal of Computer Vision</span>, 130(9):2337–2348,
2022.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib49.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022b]</span>
<span class="ltx_bibblock">
Tian Zhou, Ziqing Ma, Qingsong Wen, Xue Wang, Liang Sun, and Rong Jin.

</span>
<span class="ltx_bibblock">Fedformer: Frequency enhanced decomposed transformer for long-term
series forecasting.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2201.12740</span>, 2022.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2301.09151" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2301.09152" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2301.09152">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2301.09152" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2301.09153" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 06:03:51 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
