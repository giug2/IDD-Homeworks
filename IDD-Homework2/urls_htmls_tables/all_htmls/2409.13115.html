<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.13115] Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion</title><meta property="og:description" content="The field of medical diagnostics has witnessed a transformative convergence of artificial intelligence (AI) and healthcare data, offering promising avenues for enhancing patient care and disease comprehension. However,…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.13115">

<!--Generated on Sun Oct  6 01:57:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Areej Alsaafin<sup id="id6.2.id1" class="ltx_sup">†</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Abubakr Shafique<sup id="id7.2.id1" class="ltx_sup">†</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Saghir Alfasly<sup id="id8.2.id1" class="ltx_sup">†</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">H.R.Tizhoosh<sup id="id9.3.id1" class="ltx_sup">†</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup id="id10.4.id1" class="ltx_sup">†</sup> KIMIA Lab, Dept. of Artificial Intelligence &amp; Informatics, 
<br class="ltx_break">Mayo Clinic, Rochester, MN, USA
</span>
<span class="ltx_contact ltx_role_affiliation">* Corresponding author: <em id="id11.5.id1" class="ltx_emph ltx_font_italic">tizhoosh.hamid@mayo.edu</em>
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p">The field of medical diagnostics has witnessed a transformative convergence of artificial intelligence (AI) and healthcare data, offering promising avenues for enhancing patient care and disease comprehension. However, this integration of multimodal data, specifically histopathology whole slide images (WSIs) and genetic sequencing data, presents unique challenges due to modality disparities and the need for scalable computational solutions. This paper addresses the scarcity of multimodal solutions, primarily centered around unimodal data solutions, thus limiting the realization of the rich insights that can be derived from integrating images and genomic data. Here, we introduce MarbliX “Multimodal Association and Retrieval with Binary Latent Indexed matriX,” an innovative multimodal framework that integrates histopathology images with immunogenomic sequencing data, encapsulating them into a concise binary patient code, referred to as “monogram.” This binary representation facilitates the establishment of a comprehensive archive, enabling clinicians to match similar cases. The experimental results demonstrate the potential of MarbliX to empower healthcare professionals with in-depth insights, leading to more precise diagnoses, reduced variability, and expanded personalized treatment options, particularly in the context of cancer.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The traditional diagnosis of cancer primarily relies on the microscopic examination of tissue slides. However, over recent decades, the diagnostic process has undergone a transformation with the integration of molecular tests. This evolution has led to more precise grading and prognosis for cancer patients. While molecular assays have made remarkable strides in various aspects, the intricate task of assessing tissue morphology still falls within the realm of skilled pathologists. The landscape of cancer diagnosis is currently experiencing a rapid shift, largely driven by the advent of digital pathology. Machine learning techniques have the potential to revolutionize the clinical workflow. While traditional approaches may focus solely on morphological features in histopathology whole slide images (WSIs) when studying tumors in a given sample case, recent advancements in machine learning techniques have expanded our ability to extract valuable insights from complex molecular data. Generally, relying solely on morphological features to understand cancer may provide an incomplete picture. However, with the advent of deep learning, researchers have gained the ability to delve deeper into the molecular and genetic aspects of cancer. For instance, deep learning models can analyze extensive biological sequence databases, uncovering intricate patterns and associations that might have been overlooked using conventional methods.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In the domain of cancer immunogenomics, the adaptive immune system has demonstrated its remarkable ability to detect tumor antigens at an early stage, initiating a defense against cancer cells <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. This immune response involves the proliferation of tumor antigen-specific T lymphocytes (T cells) and B lymphocytes (B cells), which play pivotal roles in the fight against cancer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Similarities found in both T cell receptor (TCR) and B cell receptor (BCR) sequences, which are protein complexes located on the surface of T cells and B cells, signify shared antigen specificity among receptors, offering a promising avenue for the discovery of novel therapeutic targets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. The quantifiable measures of the adaptive immune system’s diversity, as provided by immunogenomic data, contribute to the improved categorization of patients who would derive optimal benefits from specific treatments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. This addresses the prevalent observation that patients sharing the same clinical diagnosis or symptoms often respond differently to identical treatments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The analysis of immune cell sequencing data holds promise in predicting the effectiveness of treatments on specific cancerous cells, thereby curbing costs and enhancing the sustainability and efficiency of healthcare systems<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Recent research underscores the capacity of deep neural networks to glean meaningful insights from complex immunogenomic data patterns. This encompasses tasks such as outcome prediction or clustering of TCR and BCR sequences to uncover their underlying similarities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2409.13115/assets/marblix.jpg" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="509" height="698" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Diagram illustrating MarbliX framework for multimodal data fusion. MarbliX integrates histopathology images and immunogenomic data into a concise binary patient code coined as “monogram.” The workflow encompasses unimodal transformation, multimodal latent association, and the generation of the monogram representation.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The integration of diverse data streams derived from various sources provides pathologists and clinicians with a holistic perspective on cancer’s complex manifestations. Each modality illuminates unique facets of tumor biology, collectively offering crucial insights into a patient’s prognosis and treatment options. However, the inherently high-dimensional nature of some of most of the clinical data modalities poses a formidable challenge for manual interpretation, making it arduous for clinicians to extract meaningful information from these multimodal biomedical datasets in order to guide treatment decisions and estimate prognosis. Patient heterogeneity further underscores the need for personalized tumor characterization to optimize treatment strategies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Leveraging machine learning and deep learning tools to uncover hidden patterns within multimodal data is pivotal in constructing robust models capable of more accurately gauging tumor aggressiveness and predicting treatment outcomes. Despite the availability of multimodal data, their integration into a cohesive computerized framework remains rare; most current automated solutions are tailored to a single data modality. This underscores the untapped potential for harnessing the synergy of diverse data sources in cancer diagnosis and treatment planning.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we introduce a novel multimodal framework known as Multimodal Association and Retrieval with Binary Latent Indexed matriX (MarbliX). The absence of any pre-existing multimodal AI solutions that incorporate both histopathology and immunogenomic data serves as a compelling incentive to introduce MarbliX to unveiling the underlying latent correlations between these complex yet informative modalities. MarbliX (<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is an innovative framework harnesses the capabilities of deep learning to merge histopathology whole slide images (WSIs) with immune cell sequencing data, condensing them into a concise binary patient code referred to as “monogram.” This compact binary representation encapsulates the intricate patterns found within extensive multimodal data files, encompassing both histopathology images and genomic data. Moreover, MarbliX serves as an efficient similarity search tool for establishing a comprehensive “monogram”-based archive. It enables the matching and retrieval of similar cases to a given query case, thus empowering clinicians and pathologists with an in-depth comprehension of cases. Current search solutions for histopathology entirely focus on whole slides images and their patches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.This facilitates more precise and timely diagnoses, reduces variability in assessments, and augments personalized treatment options.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Results</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">MarbliX framework is designed with the purpose of fusing the subtle morphological characteristics found in histopathology images with the intricate immune response patterns within immune cell sequencing profiles. The underlying rationale for this choice is deeply rooted in the profound clinical implications of these modalities. Histopathology data, with its potentials to unveil the subtleties of tissue structures, and immune cell sequencing data, capable of unraveling the molecular nuances of immune responses.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">MarbliX was implemented and evaluated using datasets obtained from The Cancer Genome Atlas (TCGA), which included histopathology images and genomic data. Specifically, cases from two primary sites, <span id="S2.p2.1.1" class="ltx_text ltx_font_bold">lung</span> and <span id="S2.p2.1.2" class="ltx_text ltx_font_bold">kidney</span>, were sourced from TCGA. Only cases featuring both WSI and genomic profiles were considered. This resulted in a dataset comprising 535 lung adenocarcinoma (LUAD) cases and 510 lung squamous cell carcinoma (LUSC) cases for the lung primary site. For the kidney primary site, the dataset consisted of three classes: 508 kidney renal clear cell carcinoma (KIRC) cases, 248 kidney renal papillary cell carcinoma (KIRP) cases, and 38 kidney chromophobe (KICH) cases. MarbliX was evaluated using 5-fold cross validation for lung dataset while 2-fold cross validation was used to evaluate kidney dataset due to the limited number of cases in the KICH subtype as enough cases from every subtype is needed for meaningful training.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2409.13115/assets/x1.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="447" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S2.F2.5.1" class="ltx_text ltx_font_bold">a</span>-<span id="S2.F2.6.2" class="ltx_text ltx_font_bold">b</span> Analysis of reconstructed features from multimodal association learning through hybrid autoencoders trained using histopathology images and immunogenomic data of lung and kidney datasets. The violin plot illustrates the distribution of cosine similarity values between the original and reconstructed embeddings by the hybrid autoencoders, with the dashed line indicating the median. The accompanying bar plot provide a comprehensive overview of the mean squared error (MSE) across all original embeddings and their corresponding reconstructed counterparts. <span id="S2.F2.7.3" class="ltx_text ltx_font_bold">c</span> The triplet loss during the training of MarbliX to learn a multimodal patient code referred to as “monogram,” of cases within each of lung and kidney datasets. <span id="S2.F2.8.4" class="ltx_text ltx_font_bold">d</span> A heatmap illustrating the distinctions in the generated monogram representations among cases with various subtypes of lung and kidney cancers. The dissimilarity is expressed as the XOR of each monogram with every other monogram in the datasets.</figcaption>
</figure>
<section id="S2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">MarbliX Training Evaluation</h3>

<div id="S2.SSx1.p1" class="ltx_para">
<p id="S2.SSx1.p1.1" class="ltx_p">Different experiments were conducted to evaluate the quality of the patient representation. An experiment was performed to analyze the quality of the multimodal latent association applied through the hybrid autoencoders to map histopathology features to immunogenomic features, and vice versa. As shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the cosine similarity was calculated between every histopathology and immunogenomic embedding extracted by the pretrained model with the reconstructed histopathology and immunogenomic, respectively, embeddings by the trained hybrid autoencoders. The violin plots in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> show the distribution of the cosine similarities between the original embedding and the reconstructed embedding of every case in the test sets of (a) lung dataset and (b) kidney dataset. The median cosine similarities of 0.95 for lung histopathology and 0.91 for kidney histopathology indicate a strong overall resemblance between the original and reconstructed embeddings, suggesting effective feature retention. Similarly, in the immunogenomic distribution, with median cosine similarities of 0.93 for lung and 0.94 for kidney, the model maintains a high degree of similarity on average during the reconstruction process. The tightly packed quartiles in both lung and kidney histopathology plots imply consistent performance across the majority of cases. However, the wider spread in the upper quartile of the immunogenomic kidney plot suggests challenges in accurately reconstructing complex patterns, potentially attributed to the limited representation of the KICH subtype in the training set. This limitation may lead to deviations in reconstructions when confronted with new, less familiar patterns in the test set.</p>
</div>
<div id="S2.SSx1.p2" class="ltx_para">
<p id="S2.SSx1.p2.1" class="ltx_p">In Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the accompanying bar plot provides a quantitative assessment of the reconstruction quality by illustrating the average mean squared error (MSE) between the original embeddings and their reconstructed counterparts for both lung and kidney datasets. Remarkably, the MSE values exhibit consistency across both histopathology and immunogenomics reconstructions, ranging between 0.020 and 0.030 for both datasets. The MSE values indicate that the model performs well in minimizing the squared differences between the original and reconstructed embeddings, reaffirming the reliability of the reconstruction process for both histopathological and immunogenomic features in the lung and kidney datasets.</p>
</div>
<div id="S2.SSx1.p3" class="ltx_para">
<p id="S2.SSx1.p3.1" class="ltx_p">The training curves shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (c) provide an overview of the learning curves of the final MarbliX models trained on triplet loss, aiming to learn monogram representations for lung and kidney cases. The curves represent the evolution of the loss function over training epochs for each model. Initially, both models exhibit a sharp decrease in the loss, indicative of effective learning and convergence tendency. However, as the epochs progress, subtle differences emerge. The model trained on the kidney dataset demonstrates a slightly more gradual decline in the loss compared to its lung counterpart. This might suggest that the kidney dataset poses greater complexity or variability, requiring the model to adapt more cautiously.</p>
</div>
<div id="S2.SSx1.p4" class="ltx_para">
<p id="S2.SSx1.p4.1" class="ltx_p">The binary monograms generated by MarbliX were analyzed to assess both inter and intra-dissimilarity between the representations. To address the limited number of KICH cases, a set of 19 random cases was selected from the test set of each subtype. Quantifying the dissimilarity between matrices involved performing a bitwise XOR operation to identify differing bits between any two matrices. The resulting heatmap, displaying calculated dissimilarities, is presented in <a href="#S2.F2" title="Figure 2 ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (d). Notably, the heatmap’s diagonal reflects the smallest dissimilarity, indicating that MarbliX generates similar representations for patients with shared diagnoses. However, intra-dissimilarity among patient representations within LUAD, LUSC, and KIRC was observed to be lower compared to the intra-dissimilarity within KIRP and KICH. This can be attributed to the limited number of cases in the latter two subtypes, leading to constrained coverage of subtype features during the training process. Furthermore, the heatmap illustrates that KIRP and KICH shows a lower degree of dissimilarity in their representations than the dissimilarity observed between either of them and KIRC. This could stem from more common patterns between KIRP and KICH or, alternatively, the limited available cases belonging to KIRP and KICH during training. The dissimilarity between lung monograms (LUAD and LUSC) was smaller than the dissimilarity between lung monograms and kidney monograms (KIRC, KIRP, and KICH). Similarly, the dissimilarity between representations of kidney cases was smaller than the dissimilarity between kidney and lung cases. Additionally, the dissimilarity between representations of kidney subtypes was higher than the dissimilarity between representations of lung subtypes.</p>
</div>
<figure id="S2.F3" class="ltx_figure"><img src="/html/2409.13115/assets/x2.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="260" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The t-SNE map depicting the distribution of modalities within a high-dimensional space. The visual representation showcases embeddings post-PCA transformation, specifically retaining the initial 64 components. The maps shows the relationship between cancer subtypes within lung (first row) and kidney (second row) datasets. The distributions of uni-modal embeddings are presented in (a) and (e) for the image modality, while (b) and (f) illustrate the immunogenomics modality. Maps (c) and (g) show the distribution of real-value monogram representations, while (d) and (h) display binary monograms, both generated by MarbliX.</figcaption>
</figure>
</section>
<section id="S2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">MarbliX Generates Discriminative Patient Representations</h3>

<div id="S2.SSx2.p1" class="ltx_para">
<p id="S2.SSx2.p1.1" class="ltx_p">In assessing the efficacy of MarbliX in generating high quality multimodal patient representations, an experiment was conducted, comparing them to unimodal representations derived from histopathology and immunogenomics data. PCA transformation was applied to extract the top 64 components from each embedding in the lung and kidney test sets, using folds not employed during training. These components were then projected into a high-dimensional space, forming the t-SNE maps presented in Figure <a href="#S2.F3" title="Figure 3 ‣ MarbliX Training Evaluation ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The maps provide comprehensive insights into feature properties, highlighting distinctions among various subtype classes. In Figure <a href="#S2.F3" title="Figure 3 ‣ MarbliX Training Evaluation ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (a), lung histopathology image embeddings of LUAD and LUSC are intermixed, lacking a clear discriminative pattern. Figure <a href="#S2.F3" title="Figure 3 ‣ MarbliX Training Evaluation ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (b) demonstrates a more discriminative pattern in immunogenomic embeddings, although some LUSC features intertwine with LUAD features. Merging histopathology and immunogenomics features into a monogram using MarbliX enhances distribution in Figure <a href="#S2.F3" title="Figure 3 ‣ MarbliX Training Evaluation ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (c) and (d), showcasing real and binary features. Notably, the t-SNE maps reveal improved separation of LUAD and LUSC, particularly using binary monogram representations. Transitioning to kidney maps, Figure <a href="#S2.F3" title="Figure 3 ‣ MarbliX Training Evaluation ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (e) shows two well-separated clusters of mixed cased from the three kidney subtypes in the histopathology t-SNE map. Analysis reveals that this separation is influenced by different hospitals, indicating the dominance of WSI technical properties in the embeddings. Immunogenomic t-SNE map (Figure <a href="#S2.F3" title="Figure 3 ‣ MarbliX Training Evaluation ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (f)) exhibits a more meaningful distribution than histopathology, with KIRC being the most discriminated class due to the available number of cases during training compared to KIRP and KICH. Despite this, MarbliX application refines the distribution of patient representations (Figure <a href="#S2.F3" title="Figure 3 ‣ MarbliX Training Evaluation ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (g) and (h)), creating distinct groups for the three kidney cancer subtypes, highlighting the ability of MarbliX to derive compact yet discriminative representations from diverse modalities.</p>
</div>
</section>
<section id="S2.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Efficient Multimodal Similarity Search</h3>

<figure id="S2.F4" class="ltx_figure"><img src="/html/2409.13115/assets/multimodal_search.jpeg" id="S2.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="491" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The pipeline for utilizing MarbliX in a multimodal pathology search, aiming to identify similar cases to a given query case—exemplified here with a liver cancer patient. The process begins with specimen collection for histopathology staining and genomics analysis. In the second stage, the tissue slide is digitized, and RNA sequencing is conducted to obtain the patient’s whole slide image and genomics profile, respectively. In the third stage, following unimodal transformations of the histopathology image and genomics profile, MarbliX integrates the two modalities into a binary multimodal representation, referred to as “monogram”. The final stage involves a multimodal search using the generated monogram as a query to identify the top n (in this case, n=3) similar matrices in the archive. The search is performed through Hamming distance comparison. The retrieved matrices can be utilized to identify the similar patients’ medical information, including histopathology images, genomics data, treatment history, and risk stratification.</figcaption>
</figure>
<div id="S2.SSx3.p1" class="ltx_para">
<p id="S2.SSx3.p1.2" class="ltx_p">MarbliX demonstrated its primary utility through the application of the <em id="S2.SSx3.p1.2.1" class="ltx_emph ltx_font_italic">monogram</em> representation for conducting efficient multimodal search and retrieval (Figure <a href="#S2.F4" title="Figure 4 ‣ Efficient Multimodal Similarity Search ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The <em id="S2.SSx3.p1.2.2" class="ltx_emph ltx_font_italic">monogram</em>, a condensed representation, integrates diverse features extracted from multimodal data, thereby streamlining the process of multimodal search and retrieval. MarbliX was employed to fuse each patient’s histopathology image and immunogenomic data into a monogram. To assess MarbliX’s performance, “leave-one-out” validation was performed, utilizing monograms generated by MarbliX for cases in the test folds of lung and kidney datasets. Cases in the test folds were not part of the training set. The evaluation involved searching for similar cases within the monograms archive, treating each case as a query case by excluding it from the search process. The <em id="S2.SSx3.p1.2.3" class="ltx_emph ltx_font_italic">majority vote</em> criterion was applied for top-3 (MV@3), top-5 (MV@5), and top-10 (MV@10) retrievals, requiring at least <math id="S2.SSx3.p1.1.m1.1" class="ltx_Math" alttext="n/2+1" display="inline"><semantics id="S2.SSx3.p1.1.m1.1a"><mrow id="S2.SSx3.p1.1.m1.1.1" xref="S2.SSx3.p1.1.m1.1.1.cmml"><mrow id="S2.SSx3.p1.1.m1.1.1.2" xref="S2.SSx3.p1.1.m1.1.1.2.cmml"><mi id="S2.SSx3.p1.1.m1.1.1.2.2" xref="S2.SSx3.p1.1.m1.1.1.2.2.cmml">n</mi><mo id="S2.SSx3.p1.1.m1.1.1.2.1" xref="S2.SSx3.p1.1.m1.1.1.2.1.cmml">/</mo><mn id="S2.SSx3.p1.1.m1.1.1.2.3" xref="S2.SSx3.p1.1.m1.1.1.2.3.cmml">2</mn></mrow><mo id="S2.SSx3.p1.1.m1.1.1.1" xref="S2.SSx3.p1.1.m1.1.1.1.cmml">+</mo><mn id="S2.SSx3.p1.1.m1.1.1.3" xref="S2.SSx3.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.1.m1.1b"><apply id="S2.SSx3.p1.1.m1.1.1.cmml" xref="S2.SSx3.p1.1.m1.1.1"><plus id="S2.SSx3.p1.1.m1.1.1.1.cmml" xref="S2.SSx3.p1.1.m1.1.1.1"></plus><apply id="S2.SSx3.p1.1.m1.1.1.2.cmml" xref="S2.SSx3.p1.1.m1.1.1.2"><divide id="S2.SSx3.p1.1.m1.1.1.2.1.cmml" xref="S2.SSx3.p1.1.m1.1.1.2.1"></divide><ci id="S2.SSx3.p1.1.m1.1.1.2.2.cmml" xref="S2.SSx3.p1.1.m1.1.1.2.2">𝑛</ci><cn type="integer" id="S2.SSx3.p1.1.m1.1.1.2.3.cmml" xref="S2.SSx3.p1.1.m1.1.1.2.3">2</cn></apply><cn type="integer" id="S2.SSx3.p1.1.m1.1.1.3.cmml" xref="S2.SSx3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.1.m1.1c">n/2+1</annotation></semantics></math> of the top-<math id="S2.SSx3.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SSx3.p1.2.m2.1a"><mi id="S2.SSx3.p1.2.m2.1.1" xref="S2.SSx3.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SSx3.p1.2.m2.1b"><ci id="S2.SSx3.p1.2.m2.1.1.cmml" xref="S2.SSx3.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx3.p1.2.m2.1c">n</annotation></semantics></math> retrieved cases to belong to the same diagnosis class as the query case.</p>
</div>
<div id="S2.SSx3.p2" class="ltx_para">
<p id="S2.SSx3.p2.1" class="ltx_p">Figure <a href="#S2.F5" title="Figure 5 ‣ Efficient Multimodal Similarity Search ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> presents the mean and standard deviation of macro average F1-score and accuracy for the test folds. The results of MarbliX representations, real and binary monograms are compared against unimodal representations of histopathology and immunogenomics. Analyzing the lung dataset results in Figure <a href="#S2.F5" title="Figure 5 ‣ Efficient Multimodal Similarity Search ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (a and c), multimodal search using monogram yields more accurate and similar retrieved cases compared to unimodal searches. MarbliX consistently achieves performance between 85% and 89% across all criteria from top-1 to MV@10, surpassing the 69%-71% and 73%-76% ranges of histopathology and immunogenomics, respectively. The integration of distinctive patterns from both modalities into a compact multimodal representation notably enhances the quality of retrieved cases. Analyzing the performance on the kidney dataset shown in Figure <a href="#S2.F5" title="Figure 5 ‣ Efficient Multimodal Similarity Search ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (b and d), MarbliX representation also outperforms unimodal representations. The best performance was achieved using real monograms, with F1-score ranging between 80% and 83%, and accuracy between 87% and 90%. However, employing binary monograms results in a slight decrease in the F1-score range (78%-82%). Immunogenomic representations outperform histopathology representations in terms of F-score (70%-76% vs. 60%-70%), while accuracy remains comparable. Notably, all kidney representations exhibit lower macro average F1-score values compared to accuracy values, reflecting dataset imbalance.</p>
</div>
<div id="S2.SSx3.p3" class="ltx_para">
<p id="S2.SSx3.p3.1" class="ltx_p">In Figure <a href="#S2.F5" title="Figure 5 ‣ Efficient Multimodal Similarity Search ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, the precision and recall results are illustrated for the same search evaluation on the lung and kidney datasets. The mean precision and mean recall of the folds are represented with the diamond shape, while the standard deviation of each mean value is shown as a horizontal bar. As shown in the figure, MarbliX representation maintains more stable results across the folds (different test sets) compared to the unimodal representations. This is evident from the generally shorter standard deviation bars for both lung and kidney results, indicating a more consistent performance. Furthermore, MarbliX maintains higher precision and recall compared to both lung histopathology and immunogenomic representations. For the kidney dataset, although the histopathology representation achieved the highest precision when a top-5 and top-10 majority vote was applied (90%-91%), it also achieved the lowest recall for the same measures (56%-59%). Binary MarbliX representation resulted in approximately the same recall as immunogenomics over the top-1 measure but demonstrated higher precision. Overall, MarbliX consistently maintained precision and recall above 78% for top-1, MV@3, MV@5, and MV@10 measures.</p>
</div>
<div id="S2.SSx3.p4" class="ltx_para">
<p id="S2.SSx3.p4.1" class="ltx_p">In summary, MarbliX demonstrates robust performance in multimodal search and matching, leveraging monograms to fuse histopathology and immunogenomic data effectively. Overall, MarbliX maintained more accurate and stable performance compared to unimodal representations.</p>
</div>
<figure id="S2.F5" class="ltx_figure"><img src="/html/2409.13115/assets/x3.png" id="S2.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="521" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S2.F5.5.1" class="ltx_text ltx_font_bold">a</span>-<span id="S2.F5.6.2" class="ltx_text ltx_font_bold">d</span> Comparative analysis of multimodal search performance - MarbliX versus unimodal representations of histopathology images and immunogenomic data. Mean and standard deviation of macro average F1-score and accuracy for lung and kidney test folds. Leave-one-out and majority vote criteria are applied to retrieve top-1, MV@3, MV@5, and MV@10 for cases in the test folds. <span id="S2.F5.7.3" class="ltx_text ltx_font_bold">e</span>-<span id="S2.F5.8.4" class="ltx_text ltx_font_bold">h</span> Multimodal search performance of real and binary MarbliX representations compared to unimodal representations of histopathology images and immunogenomic data. Diamond-shaped points represent the mean of macro-average precision and recall for lung and kidney test folds. Horizontal bars denote the standard deviation range. Leave-one-out and majority vote (MV) criteria are applied to retrieve top-1, MV@3, MV@5, and MV@10 for cases in the test folds.</figcaption>
</figure>
</section>
<section id="S2.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">MarbliX Monogram Binary Representation Analysis</h3>

<div id="S2.SSx4.p1" class="ltx_para">
<p id="S2.SSx4.p1.1" class="ltx_p">The primary goal of MarbliX is to generate multimodal <em id="S2.SSx4.p1.1.1" class="ltx_emph ltx_font_italic">monogram</em> representations that are similar for patients with similar characteristics and distinct for those with different attributes. In this study, similarity is defined based on a shared diagnosis, specifically the commonality of cancer subtypes. Figure <a href="#S2.F6" title="Figure 6 ‣ MarbliX Monogram Binary Representation Analysis ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates MarbliX’s efficacy in achieving this objective. The figure presents four LUAD monograms and four LUSC monograms generated for randomly selected samples from each class (refer to Figure<a href="#S2.F2" title="Figure 2 ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (d) for a quantified monogram difference). It is evident that matrices from patients with the same subtype exhibit a consistent pattern (intra-similarity).</p>
</div>
<div id="S2.SSx4.p2" class="ltx_para">
<p id="S2.SSx4.p2.2" class="ltx_p">To highlight this intra-similarity and inter-dissimilarity, the figure displays the result of applying bitwise XOR on each LUAD matrix with every other matrix within the LUAD set. The same process was applied to the LUSC set, resulting in <math id="S2.SSx4.p2.1.m1.1" class="ltx_Math" alttext="\{\text{LUSC}_{set}-\text{LUSC}_{set}\}" display="inline"><semantics id="S2.SSx4.p2.1.m1.1a"><mrow id="S2.SSx4.p2.1.m1.1.1.1" xref="S2.SSx4.p2.1.m1.1.1.2.cmml"><mo stretchy="false" id="S2.SSx4.p2.1.m1.1.1.1.2" xref="S2.SSx4.p2.1.m1.1.1.2.cmml">{</mo><mrow id="S2.SSx4.p2.1.m1.1.1.1.1" xref="S2.SSx4.p2.1.m1.1.1.1.1.cmml"><msub id="S2.SSx4.p2.1.m1.1.1.1.1.2" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.cmml"><mtext id="S2.SSx4.p2.1.m1.1.1.1.1.2.2" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.2a.cmml">LUSC</mtext><mrow id="S2.SSx4.p2.1.m1.1.1.1.1.2.3" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.cmml"><mi id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.2" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.1" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.3" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.1a" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.4" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.SSx4.p2.1.m1.1.1.1.1.1" xref="S2.SSx4.p2.1.m1.1.1.1.1.1.cmml">−</mo><msub id="S2.SSx4.p2.1.m1.1.1.1.1.3" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.cmml"><mtext id="S2.SSx4.p2.1.m1.1.1.1.1.3.2" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.2a.cmml">LUSC</mtext><mrow id="S2.SSx4.p2.1.m1.1.1.1.1.3.3" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.cmml"><mi id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.2" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.1" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.3" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.1a" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.4" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.SSx4.p2.1.m1.1.1.1.3" xref="S2.SSx4.p2.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx4.p2.1.m1.1b"><set id="S2.SSx4.p2.1.m1.1.1.2.cmml" xref="S2.SSx4.p2.1.m1.1.1.1"><apply id="S2.SSx4.p2.1.m1.1.1.1.1.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1"><minus id="S2.SSx4.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.1"></minus><apply id="S2.SSx4.p2.1.m1.1.1.1.1.2.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SSx4.p2.1.m1.1.1.1.1.2.1.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.SSx4.p2.1.m1.1.1.1.1.2.2a.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.2"><mtext id="S2.SSx4.p2.1.m1.1.1.1.1.2.2.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.2">LUSC</mtext></ci><apply id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3"><times id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.1.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.1"></times><ci id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.2.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.2">𝑠</ci><ci id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.3.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.SSx4.p2.1.m1.1.1.1.1.2.3.4.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.SSx4.p2.1.m1.1.1.1.1.3.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SSx4.p2.1.m1.1.1.1.1.3.1.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.SSx4.p2.1.m1.1.1.1.1.3.2a.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.2"><mtext id="S2.SSx4.p2.1.m1.1.1.1.1.3.2.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.2">LUSC</mtext></ci><apply id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3"><times id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.1"></times><ci id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.2">𝑠</ci><ci id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.SSx4.p2.1.m1.1.1.1.1.3.3.4.cmml" xref="S2.SSx4.p2.1.m1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx4.p2.1.m1.1c">\{\text{LUSC}_{set}-\text{LUSC}_{set}\}</annotation></semantics></math>. Additionally, the set of LUAD was XORed with the set of LUSC to identify the differences between each LUAD matrix and every LUSC matrix in the sets. Yellow pixels represent values turning from 0 to 1, while purple indicates the shift from 1 to 0. This color scheme is particularly informative when analyzing the results of <math id="S2.SSx4.p2.2.m2.1" class="ltx_Math" alttext="\{\text{LUAD}_{set}-\text{LUSC}_{set}\}" display="inline"><semantics id="S2.SSx4.p2.2.m2.1a"><mrow id="S2.SSx4.p2.2.m2.1.1.1" xref="S2.SSx4.p2.2.m2.1.1.2.cmml"><mo stretchy="false" id="S2.SSx4.p2.2.m2.1.1.1.2" xref="S2.SSx4.p2.2.m2.1.1.2.cmml">{</mo><mrow id="S2.SSx4.p2.2.m2.1.1.1.1" xref="S2.SSx4.p2.2.m2.1.1.1.1.cmml"><msub id="S2.SSx4.p2.2.m2.1.1.1.1.2" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.cmml"><mtext id="S2.SSx4.p2.2.m2.1.1.1.1.2.2" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.2a.cmml">LUAD</mtext><mrow id="S2.SSx4.p2.2.m2.1.1.1.1.2.3" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.cmml"><mi id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.2" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.1" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.3" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.1a" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.4" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.SSx4.p2.2.m2.1.1.1.1.1" xref="S2.SSx4.p2.2.m2.1.1.1.1.1.cmml">−</mo><msub id="S2.SSx4.p2.2.m2.1.1.1.1.3" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.cmml"><mtext id="S2.SSx4.p2.2.m2.1.1.1.1.3.2" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.2a.cmml">LUSC</mtext><mrow id="S2.SSx4.p2.2.m2.1.1.1.1.3.3" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.cmml"><mi id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.2" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.1" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.3" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.1a" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.4" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.SSx4.p2.2.m2.1.1.1.3" xref="S2.SSx4.p2.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx4.p2.2.m2.1b"><set id="S2.SSx4.p2.2.m2.1.1.2.cmml" xref="S2.SSx4.p2.2.m2.1.1.1"><apply id="S2.SSx4.p2.2.m2.1.1.1.1.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1"><minus id="S2.SSx4.p2.2.m2.1.1.1.1.1.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.1"></minus><apply id="S2.SSx4.p2.2.m2.1.1.1.1.2.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SSx4.p2.2.m2.1.1.1.1.2.1.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2">subscript</csymbol><ci id="S2.SSx4.p2.2.m2.1.1.1.1.2.2a.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.2"><mtext id="S2.SSx4.p2.2.m2.1.1.1.1.2.2.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.2">LUAD</mtext></ci><apply id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3"><times id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.1.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.1"></times><ci id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.2.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.2">𝑠</ci><ci id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.3.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.SSx4.p2.2.m2.1.1.1.1.2.3.4.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.SSx4.p2.2.m2.1.1.1.1.3.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SSx4.p2.2.m2.1.1.1.1.3.1.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3">subscript</csymbol><ci id="S2.SSx4.p2.2.m2.1.1.1.1.3.2a.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.2"><mtext id="S2.SSx4.p2.2.m2.1.1.1.1.3.2.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.2">LUSC</mtext></ci><apply id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3"><times id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.1.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.1"></times><ci id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.2.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.2">𝑠</ci><ci id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.3.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.SSx4.p2.2.m2.1.1.1.1.3.3.4.cmml" xref="S2.SSx4.p2.2.m2.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx4.p2.2.m2.1c">\{\text{LUAD}_{set}-\text{LUSC}_{set}\}</annotation></semantics></math>, where yellow pixels signify features present in LUAD matrices but absent in LUSC matrices, and purple denotes features present in LUSC matrices but absent in LUAD matrices.</p>
</div>
<div id="S2.SSx4.p3" class="ltx_para">
<p id="S2.SSx4.p3.1" class="ltx_p">As shown in Figure <a href="#S2.F6" title="Figure 6 ‣ MarbliX Monogram Binary Representation Analysis ‣ 2 Results ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, the dissimilarity within LUAD or LUSC matrices is notably lower than the dissimilarity resulting from XORing the two sets. This is evident from the greater number of white empty areas in the intra-XOR results, as opposed to the more densely colored squares in the <math id="S2.SSx4.p3.1.m1.1" class="ltx_Math" alttext="\{\text{LUAD}_{set}-\text{LUSC}_{set}\}" display="inline"><semantics id="S2.SSx4.p3.1.m1.1a"><mrow id="S2.SSx4.p3.1.m1.1.1.1" xref="S2.SSx4.p3.1.m1.1.1.2.cmml"><mo stretchy="false" id="S2.SSx4.p3.1.m1.1.1.1.2" xref="S2.SSx4.p3.1.m1.1.1.2.cmml">{</mo><mrow id="S2.SSx4.p3.1.m1.1.1.1.1" xref="S2.SSx4.p3.1.m1.1.1.1.1.cmml"><msub id="S2.SSx4.p3.1.m1.1.1.1.1.2" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.cmml"><mtext id="S2.SSx4.p3.1.m1.1.1.1.1.2.2" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.2a.cmml">LUAD</mtext><mrow id="S2.SSx4.p3.1.m1.1.1.1.1.2.3" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.cmml"><mi id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.2" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.1" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.3" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.1a" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.4" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.SSx4.p3.1.m1.1.1.1.1.1" xref="S2.SSx4.p3.1.m1.1.1.1.1.1.cmml">−</mo><msub id="S2.SSx4.p3.1.m1.1.1.1.1.3" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.cmml"><mtext id="S2.SSx4.p3.1.m1.1.1.1.1.3.2" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.2a.cmml">LUSC</mtext><mrow id="S2.SSx4.p3.1.m1.1.1.1.1.3.3" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.cmml"><mi id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.2" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.1" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.3" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.1a" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.4" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.SSx4.p3.1.m1.1.1.1.3" xref="S2.SSx4.p3.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SSx4.p3.1.m1.1b"><set id="S2.SSx4.p3.1.m1.1.1.2.cmml" xref="S2.SSx4.p3.1.m1.1.1.1"><apply id="S2.SSx4.p3.1.m1.1.1.1.1.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1"><minus id="S2.SSx4.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.1"></minus><apply id="S2.SSx4.p3.1.m1.1.1.1.1.2.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SSx4.p3.1.m1.1.1.1.1.2.1.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.SSx4.p3.1.m1.1.1.1.1.2.2a.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.2"><mtext id="S2.SSx4.p3.1.m1.1.1.1.1.2.2.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.2">LUAD</mtext></ci><apply id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3"><times id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.1.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.1"></times><ci id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.2.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.2">𝑠</ci><ci id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.3.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.SSx4.p3.1.m1.1.1.1.1.2.3.4.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.SSx4.p3.1.m1.1.1.1.1.3.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SSx4.p3.1.m1.1.1.1.1.3.1.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.SSx4.p3.1.m1.1.1.1.1.3.2a.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.2"><mtext id="S2.SSx4.p3.1.m1.1.1.1.1.3.2.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.2">LUSC</mtext></ci><apply id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3"><times id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.1.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.1"></times><ci id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.2.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.2">𝑠</ci><ci id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.3.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.SSx4.p3.1.m1.1.1.1.1.3.3.4.cmml" xref="S2.SSx4.p3.1.m1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SSx4.p3.1.m1.1c">\{\text{LUAD}_{set}-\text{LUSC}_{set}\}</annotation></semantics></math> difference.</p>
</div>
<figure id="S2.F6" class="ltx_figure"><img src="/html/2409.13115/assets/lung_matrices.jpeg" id="S2.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="494" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Monogram representations generated using MarbliX, for randomly selected patients with Lung Adenocarcinoma (LUAD) and Lung Squamous Cell Carcinoma (LUSC). The figure presents matrix bitwise XOR results: the left side illustrates <math id="S2.F6.5.m1.1" class="ltx_Math" alttext="\{\text{LUAD}_{set}\oplus\text{LUAD}_{set}\}" display="inline"><semantics id="S2.F6.5.m1.1b"><mrow id="S2.F6.5.m1.1.1.1" xref="S2.F6.5.m1.1.1.2.cmml"><mo stretchy="false" id="S2.F6.5.m1.1.1.1.2" xref="S2.F6.5.m1.1.1.2.cmml">{</mo><mrow id="S2.F6.5.m1.1.1.1.1" xref="S2.F6.5.m1.1.1.1.1.cmml"><msub id="S2.F6.5.m1.1.1.1.1.2" xref="S2.F6.5.m1.1.1.1.1.2.cmml"><mtext id="S2.F6.5.m1.1.1.1.1.2.2" xref="S2.F6.5.m1.1.1.1.1.2.2a.cmml">LUAD</mtext><mrow id="S2.F6.5.m1.1.1.1.1.2.3" xref="S2.F6.5.m1.1.1.1.1.2.3.cmml"><mi id="S2.F6.5.m1.1.1.1.1.2.3.2" xref="S2.F6.5.m1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.5.m1.1.1.1.1.2.3.1" xref="S2.F6.5.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.5.m1.1.1.1.1.2.3.3" xref="S2.F6.5.m1.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.5.m1.1.1.1.1.2.3.1b" xref="S2.F6.5.m1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.5.m1.1.1.1.1.2.3.4" xref="S2.F6.5.m1.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.F6.5.m1.1.1.1.1.1" xref="S2.F6.5.m1.1.1.1.1.1.cmml">⊕</mo><msub id="S2.F6.5.m1.1.1.1.1.3" xref="S2.F6.5.m1.1.1.1.1.3.cmml"><mtext id="S2.F6.5.m1.1.1.1.1.3.2" xref="S2.F6.5.m1.1.1.1.1.3.2a.cmml">LUAD</mtext><mrow id="S2.F6.5.m1.1.1.1.1.3.3" xref="S2.F6.5.m1.1.1.1.1.3.3.cmml"><mi id="S2.F6.5.m1.1.1.1.1.3.3.2" xref="S2.F6.5.m1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.5.m1.1.1.1.1.3.3.1" xref="S2.F6.5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.5.m1.1.1.1.1.3.3.3" xref="S2.F6.5.m1.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.5.m1.1.1.1.1.3.3.1b" xref="S2.F6.5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.5.m1.1.1.1.1.3.3.4" xref="S2.F6.5.m1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.F6.5.m1.1.1.1.3" xref="S2.F6.5.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F6.5.m1.1c"><set id="S2.F6.5.m1.1.1.2.cmml" xref="S2.F6.5.m1.1.1.1"><apply id="S2.F6.5.m1.1.1.1.1.cmml" xref="S2.F6.5.m1.1.1.1.1"><csymbol cd="latexml" id="S2.F6.5.m1.1.1.1.1.1.cmml" xref="S2.F6.5.m1.1.1.1.1.1">direct-sum</csymbol><apply id="S2.F6.5.m1.1.1.1.1.2.cmml" xref="S2.F6.5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.F6.5.m1.1.1.1.1.2.1.cmml" xref="S2.F6.5.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.F6.5.m1.1.1.1.1.2.2a.cmml" xref="S2.F6.5.m1.1.1.1.1.2.2"><mtext id="S2.F6.5.m1.1.1.1.1.2.2.cmml" xref="S2.F6.5.m1.1.1.1.1.2.2">LUAD</mtext></ci><apply id="S2.F6.5.m1.1.1.1.1.2.3.cmml" xref="S2.F6.5.m1.1.1.1.1.2.3"><times id="S2.F6.5.m1.1.1.1.1.2.3.1.cmml" xref="S2.F6.5.m1.1.1.1.1.2.3.1"></times><ci id="S2.F6.5.m1.1.1.1.1.2.3.2.cmml" xref="S2.F6.5.m1.1.1.1.1.2.3.2">𝑠</ci><ci id="S2.F6.5.m1.1.1.1.1.2.3.3.cmml" xref="S2.F6.5.m1.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.F6.5.m1.1.1.1.1.2.3.4.cmml" xref="S2.F6.5.m1.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.F6.5.m1.1.1.1.1.3.cmml" xref="S2.F6.5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.F6.5.m1.1.1.1.1.3.1.cmml" xref="S2.F6.5.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.F6.5.m1.1.1.1.1.3.2a.cmml" xref="S2.F6.5.m1.1.1.1.1.3.2"><mtext id="S2.F6.5.m1.1.1.1.1.3.2.cmml" xref="S2.F6.5.m1.1.1.1.1.3.2">LUAD</mtext></ci><apply id="S2.F6.5.m1.1.1.1.1.3.3.cmml" xref="S2.F6.5.m1.1.1.1.1.3.3"><times id="S2.F6.5.m1.1.1.1.1.3.3.1.cmml" xref="S2.F6.5.m1.1.1.1.1.3.3.1"></times><ci id="S2.F6.5.m1.1.1.1.1.3.3.2.cmml" xref="S2.F6.5.m1.1.1.1.1.3.3.2">𝑠</ci><ci id="S2.F6.5.m1.1.1.1.1.3.3.3.cmml" xref="S2.F6.5.m1.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.F6.5.m1.1.1.1.1.3.3.4.cmml" xref="S2.F6.5.m1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F6.5.m1.1d">\{\text{LUAD}_{set}\oplus\text{LUAD}_{set}\}</annotation></semantics></math>, the right side <math id="S2.F6.6.m2.1" class="ltx_Math" alttext="\{\text{LUSC}_{set}\oplus\text{LUSC}_{set}\}" display="inline"><semantics id="S2.F6.6.m2.1b"><mrow id="S2.F6.6.m2.1.1.1" xref="S2.F6.6.m2.1.1.2.cmml"><mo stretchy="false" id="S2.F6.6.m2.1.1.1.2" xref="S2.F6.6.m2.1.1.2.cmml">{</mo><mrow id="S2.F6.6.m2.1.1.1.1" xref="S2.F6.6.m2.1.1.1.1.cmml"><msub id="S2.F6.6.m2.1.1.1.1.2" xref="S2.F6.6.m2.1.1.1.1.2.cmml"><mtext id="S2.F6.6.m2.1.1.1.1.2.2" xref="S2.F6.6.m2.1.1.1.1.2.2a.cmml">LUSC</mtext><mrow id="S2.F6.6.m2.1.1.1.1.2.3" xref="S2.F6.6.m2.1.1.1.1.2.3.cmml"><mi id="S2.F6.6.m2.1.1.1.1.2.3.2" xref="S2.F6.6.m2.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.6.m2.1.1.1.1.2.3.1" xref="S2.F6.6.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.6.m2.1.1.1.1.2.3.3" xref="S2.F6.6.m2.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.6.m2.1.1.1.1.2.3.1b" xref="S2.F6.6.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.6.m2.1.1.1.1.2.3.4" xref="S2.F6.6.m2.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.F6.6.m2.1.1.1.1.1" xref="S2.F6.6.m2.1.1.1.1.1.cmml">⊕</mo><msub id="S2.F6.6.m2.1.1.1.1.3" xref="S2.F6.6.m2.1.1.1.1.3.cmml"><mtext id="S2.F6.6.m2.1.1.1.1.3.2" xref="S2.F6.6.m2.1.1.1.1.3.2a.cmml">LUSC</mtext><mrow id="S2.F6.6.m2.1.1.1.1.3.3" xref="S2.F6.6.m2.1.1.1.1.3.3.cmml"><mi id="S2.F6.6.m2.1.1.1.1.3.3.2" xref="S2.F6.6.m2.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.6.m2.1.1.1.1.3.3.1" xref="S2.F6.6.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.6.m2.1.1.1.1.3.3.3" xref="S2.F6.6.m2.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.6.m2.1.1.1.1.3.3.1b" xref="S2.F6.6.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.6.m2.1.1.1.1.3.3.4" xref="S2.F6.6.m2.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.F6.6.m2.1.1.1.3" xref="S2.F6.6.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F6.6.m2.1c"><set id="S2.F6.6.m2.1.1.2.cmml" xref="S2.F6.6.m2.1.1.1"><apply id="S2.F6.6.m2.1.1.1.1.cmml" xref="S2.F6.6.m2.1.1.1.1"><csymbol cd="latexml" id="S2.F6.6.m2.1.1.1.1.1.cmml" xref="S2.F6.6.m2.1.1.1.1.1">direct-sum</csymbol><apply id="S2.F6.6.m2.1.1.1.1.2.cmml" xref="S2.F6.6.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.F6.6.m2.1.1.1.1.2.1.cmml" xref="S2.F6.6.m2.1.1.1.1.2">subscript</csymbol><ci id="S2.F6.6.m2.1.1.1.1.2.2a.cmml" xref="S2.F6.6.m2.1.1.1.1.2.2"><mtext id="S2.F6.6.m2.1.1.1.1.2.2.cmml" xref="S2.F6.6.m2.1.1.1.1.2.2">LUSC</mtext></ci><apply id="S2.F6.6.m2.1.1.1.1.2.3.cmml" xref="S2.F6.6.m2.1.1.1.1.2.3"><times id="S2.F6.6.m2.1.1.1.1.2.3.1.cmml" xref="S2.F6.6.m2.1.1.1.1.2.3.1"></times><ci id="S2.F6.6.m2.1.1.1.1.2.3.2.cmml" xref="S2.F6.6.m2.1.1.1.1.2.3.2">𝑠</ci><ci id="S2.F6.6.m2.1.1.1.1.2.3.3.cmml" xref="S2.F6.6.m2.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.F6.6.m2.1.1.1.1.2.3.4.cmml" xref="S2.F6.6.m2.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.F6.6.m2.1.1.1.1.3.cmml" xref="S2.F6.6.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.F6.6.m2.1.1.1.1.3.1.cmml" xref="S2.F6.6.m2.1.1.1.1.3">subscript</csymbol><ci id="S2.F6.6.m2.1.1.1.1.3.2a.cmml" xref="S2.F6.6.m2.1.1.1.1.3.2"><mtext id="S2.F6.6.m2.1.1.1.1.3.2.cmml" xref="S2.F6.6.m2.1.1.1.1.3.2">LUSC</mtext></ci><apply id="S2.F6.6.m2.1.1.1.1.3.3.cmml" xref="S2.F6.6.m2.1.1.1.1.3.3"><times id="S2.F6.6.m2.1.1.1.1.3.3.1.cmml" xref="S2.F6.6.m2.1.1.1.1.3.3.1"></times><ci id="S2.F6.6.m2.1.1.1.1.3.3.2.cmml" xref="S2.F6.6.m2.1.1.1.1.3.3.2">𝑠</ci><ci id="S2.F6.6.m2.1.1.1.1.3.3.3.cmml" xref="S2.F6.6.m2.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.F6.6.m2.1.1.1.1.3.3.4.cmml" xref="S2.F6.6.m2.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F6.6.m2.1d">\{\text{LUSC}_{set}\oplus\text{LUSC}_{set}\}</annotation></semantics></math>, and the middle <math id="S2.F6.7.m3.1" class="ltx_Math" alttext="\{\text{LUAD}_{set}\oplus\text{LUSC}_{set}\}" display="inline"><semantics id="S2.F6.7.m3.1b"><mrow id="S2.F6.7.m3.1.1.1" xref="S2.F6.7.m3.1.1.2.cmml"><mo stretchy="false" id="S2.F6.7.m3.1.1.1.2" xref="S2.F6.7.m3.1.1.2.cmml">{</mo><mrow id="S2.F6.7.m3.1.1.1.1" xref="S2.F6.7.m3.1.1.1.1.cmml"><msub id="S2.F6.7.m3.1.1.1.1.2" xref="S2.F6.7.m3.1.1.1.1.2.cmml"><mtext id="S2.F6.7.m3.1.1.1.1.2.2" xref="S2.F6.7.m3.1.1.1.1.2.2a.cmml">LUAD</mtext><mrow id="S2.F6.7.m3.1.1.1.1.2.3" xref="S2.F6.7.m3.1.1.1.1.2.3.cmml"><mi id="S2.F6.7.m3.1.1.1.1.2.3.2" xref="S2.F6.7.m3.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.7.m3.1.1.1.1.2.3.1" xref="S2.F6.7.m3.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.7.m3.1.1.1.1.2.3.3" xref="S2.F6.7.m3.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.7.m3.1.1.1.1.2.3.1b" xref="S2.F6.7.m3.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.7.m3.1.1.1.1.2.3.4" xref="S2.F6.7.m3.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.F6.7.m3.1.1.1.1.1" xref="S2.F6.7.m3.1.1.1.1.1.cmml">⊕</mo><msub id="S2.F6.7.m3.1.1.1.1.3" xref="S2.F6.7.m3.1.1.1.1.3.cmml"><mtext id="S2.F6.7.m3.1.1.1.1.3.2" xref="S2.F6.7.m3.1.1.1.1.3.2a.cmml">LUSC</mtext><mrow id="S2.F6.7.m3.1.1.1.1.3.3" xref="S2.F6.7.m3.1.1.1.1.3.3.cmml"><mi id="S2.F6.7.m3.1.1.1.1.3.3.2" xref="S2.F6.7.m3.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.7.m3.1.1.1.1.3.3.1" xref="S2.F6.7.m3.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.7.m3.1.1.1.1.3.3.3" xref="S2.F6.7.m3.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.7.m3.1.1.1.1.3.3.1b" xref="S2.F6.7.m3.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.7.m3.1.1.1.1.3.3.4" xref="S2.F6.7.m3.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.F6.7.m3.1.1.1.3" xref="S2.F6.7.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F6.7.m3.1c"><set id="S2.F6.7.m3.1.1.2.cmml" xref="S2.F6.7.m3.1.1.1"><apply id="S2.F6.7.m3.1.1.1.1.cmml" xref="S2.F6.7.m3.1.1.1.1"><csymbol cd="latexml" id="S2.F6.7.m3.1.1.1.1.1.cmml" xref="S2.F6.7.m3.1.1.1.1.1">direct-sum</csymbol><apply id="S2.F6.7.m3.1.1.1.1.2.cmml" xref="S2.F6.7.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.F6.7.m3.1.1.1.1.2.1.cmml" xref="S2.F6.7.m3.1.1.1.1.2">subscript</csymbol><ci id="S2.F6.7.m3.1.1.1.1.2.2a.cmml" xref="S2.F6.7.m3.1.1.1.1.2.2"><mtext id="S2.F6.7.m3.1.1.1.1.2.2.cmml" xref="S2.F6.7.m3.1.1.1.1.2.2">LUAD</mtext></ci><apply id="S2.F6.7.m3.1.1.1.1.2.3.cmml" xref="S2.F6.7.m3.1.1.1.1.2.3"><times id="S2.F6.7.m3.1.1.1.1.2.3.1.cmml" xref="S2.F6.7.m3.1.1.1.1.2.3.1"></times><ci id="S2.F6.7.m3.1.1.1.1.2.3.2.cmml" xref="S2.F6.7.m3.1.1.1.1.2.3.2">𝑠</ci><ci id="S2.F6.7.m3.1.1.1.1.2.3.3.cmml" xref="S2.F6.7.m3.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.F6.7.m3.1.1.1.1.2.3.4.cmml" xref="S2.F6.7.m3.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.F6.7.m3.1.1.1.1.3.cmml" xref="S2.F6.7.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.F6.7.m3.1.1.1.1.3.1.cmml" xref="S2.F6.7.m3.1.1.1.1.3">subscript</csymbol><ci id="S2.F6.7.m3.1.1.1.1.3.2a.cmml" xref="S2.F6.7.m3.1.1.1.1.3.2"><mtext id="S2.F6.7.m3.1.1.1.1.3.2.cmml" xref="S2.F6.7.m3.1.1.1.1.3.2">LUSC</mtext></ci><apply id="S2.F6.7.m3.1.1.1.1.3.3.cmml" xref="S2.F6.7.m3.1.1.1.1.3.3"><times id="S2.F6.7.m3.1.1.1.1.3.3.1.cmml" xref="S2.F6.7.m3.1.1.1.1.3.3.1"></times><ci id="S2.F6.7.m3.1.1.1.1.3.3.2.cmml" xref="S2.F6.7.m3.1.1.1.1.3.3.2">𝑠</ci><ci id="S2.F6.7.m3.1.1.1.1.3.3.3.cmml" xref="S2.F6.7.m3.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.F6.7.m3.1.1.1.1.3.3.4.cmml" xref="S2.F6.7.m3.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F6.7.m3.1d">\{\text{LUAD}_{set}\oplus\text{LUSC}_{set}\}</annotation></semantics></math>. Yellow pixels highlight features transitioning from 0 to 1, while purple pixels indicate the shift from 1 to 0. This color scheme serves to distinguish the presence or absence of features. In the context of <math id="S2.F6.8.m4.1" class="ltx_Math" alttext="\{\text{LUAD}_{set}\oplus\text{LUSC}_{set}\}" display="inline"><semantics id="S2.F6.8.m4.1b"><mrow id="S2.F6.8.m4.1.1.1" xref="S2.F6.8.m4.1.1.2.cmml"><mo stretchy="false" id="S2.F6.8.m4.1.1.1.2" xref="S2.F6.8.m4.1.1.2.cmml">{</mo><mrow id="S2.F6.8.m4.1.1.1.1" xref="S2.F6.8.m4.1.1.1.1.cmml"><msub id="S2.F6.8.m4.1.1.1.1.2" xref="S2.F6.8.m4.1.1.1.1.2.cmml"><mtext id="S2.F6.8.m4.1.1.1.1.2.2" xref="S2.F6.8.m4.1.1.1.1.2.2a.cmml">LUAD</mtext><mrow id="S2.F6.8.m4.1.1.1.1.2.3" xref="S2.F6.8.m4.1.1.1.1.2.3.cmml"><mi id="S2.F6.8.m4.1.1.1.1.2.3.2" xref="S2.F6.8.m4.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.8.m4.1.1.1.1.2.3.1" xref="S2.F6.8.m4.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.8.m4.1.1.1.1.2.3.3" xref="S2.F6.8.m4.1.1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.8.m4.1.1.1.1.2.3.1b" xref="S2.F6.8.m4.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.F6.8.m4.1.1.1.1.2.3.4" xref="S2.F6.8.m4.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S2.F6.8.m4.1.1.1.1.1" xref="S2.F6.8.m4.1.1.1.1.1.cmml">⊕</mo><msub id="S2.F6.8.m4.1.1.1.1.3" xref="S2.F6.8.m4.1.1.1.1.3.cmml"><mtext id="S2.F6.8.m4.1.1.1.1.3.2" xref="S2.F6.8.m4.1.1.1.1.3.2a.cmml">LUSC</mtext><mrow id="S2.F6.8.m4.1.1.1.1.3.3" xref="S2.F6.8.m4.1.1.1.1.3.3.cmml"><mi id="S2.F6.8.m4.1.1.1.1.3.3.2" xref="S2.F6.8.m4.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.F6.8.m4.1.1.1.1.3.3.1" xref="S2.F6.8.m4.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.8.m4.1.1.1.1.3.3.3" xref="S2.F6.8.m4.1.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.F6.8.m4.1.1.1.1.3.3.1b" xref="S2.F6.8.m4.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.F6.8.m4.1.1.1.1.3.3.4" xref="S2.F6.8.m4.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.F6.8.m4.1.1.1.3" xref="S2.F6.8.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F6.8.m4.1c"><set id="S2.F6.8.m4.1.1.2.cmml" xref="S2.F6.8.m4.1.1.1"><apply id="S2.F6.8.m4.1.1.1.1.cmml" xref="S2.F6.8.m4.1.1.1.1"><csymbol cd="latexml" id="S2.F6.8.m4.1.1.1.1.1.cmml" xref="S2.F6.8.m4.1.1.1.1.1">direct-sum</csymbol><apply id="S2.F6.8.m4.1.1.1.1.2.cmml" xref="S2.F6.8.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.F6.8.m4.1.1.1.1.2.1.cmml" xref="S2.F6.8.m4.1.1.1.1.2">subscript</csymbol><ci id="S2.F6.8.m4.1.1.1.1.2.2a.cmml" xref="S2.F6.8.m4.1.1.1.1.2.2"><mtext id="S2.F6.8.m4.1.1.1.1.2.2.cmml" xref="S2.F6.8.m4.1.1.1.1.2.2">LUAD</mtext></ci><apply id="S2.F6.8.m4.1.1.1.1.2.3.cmml" xref="S2.F6.8.m4.1.1.1.1.2.3"><times id="S2.F6.8.m4.1.1.1.1.2.3.1.cmml" xref="S2.F6.8.m4.1.1.1.1.2.3.1"></times><ci id="S2.F6.8.m4.1.1.1.1.2.3.2.cmml" xref="S2.F6.8.m4.1.1.1.1.2.3.2">𝑠</ci><ci id="S2.F6.8.m4.1.1.1.1.2.3.3.cmml" xref="S2.F6.8.m4.1.1.1.1.2.3.3">𝑒</ci><ci id="S2.F6.8.m4.1.1.1.1.2.3.4.cmml" xref="S2.F6.8.m4.1.1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S2.F6.8.m4.1.1.1.1.3.cmml" xref="S2.F6.8.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.F6.8.m4.1.1.1.1.3.1.cmml" xref="S2.F6.8.m4.1.1.1.1.3">subscript</csymbol><ci id="S2.F6.8.m4.1.1.1.1.3.2a.cmml" xref="S2.F6.8.m4.1.1.1.1.3.2"><mtext id="S2.F6.8.m4.1.1.1.1.3.2.cmml" xref="S2.F6.8.m4.1.1.1.1.3.2">LUSC</mtext></ci><apply id="S2.F6.8.m4.1.1.1.1.3.3.cmml" xref="S2.F6.8.m4.1.1.1.1.3.3"><times id="S2.F6.8.m4.1.1.1.1.3.3.1.cmml" xref="S2.F6.8.m4.1.1.1.1.3.3.1"></times><ci id="S2.F6.8.m4.1.1.1.1.3.3.2.cmml" xref="S2.F6.8.m4.1.1.1.1.3.3.2">𝑠</ci><ci id="S2.F6.8.m4.1.1.1.1.3.3.3.cmml" xref="S2.F6.8.m4.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.F6.8.m4.1.1.1.1.3.3.4.cmml" xref="S2.F6.8.m4.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F6.8.m4.1d">\{\text{LUAD}_{set}\oplus\text{LUSC}_{set}\}</annotation></semantics></math>, yellow pixels signify features unique to LUAD matrices, absent in LUSC, and purple pixels denote features specific to LUSC matrices, absent in LUAD.</figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Discussion</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The motivation for this research work stems from the significant challenges and unexplored opportunities that arise due to the conspicuous scarcity of multimodal solutions adept at merging histopathology images with genetic sequencing data in general, and with immunogenomic data in particular. Furthermore, as far as knowledge extends, the fusion of histopathology images with immunogenomic data remains an untapped area. By fusing these data modalities within the MarbliX framework, the objective is to effectively bridge critical research gaps and contribute to a more comprehensive understanding of cancer cases, while also unlocking new avenues for potential research in this domain. The work at hand brings forth four substantial contributions to the burgeoning field of multimodal research.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">First and foremost, MarbliX introduces a novel approach that condenses diverse data modalities into a concise representation, referred to as <em id="S3.p2.1.1" class="ltx_emph ltx_font_italic">monogram</em>. This innovative concept enables the generation of <em id="S3.p2.1.2" class="ltx_emph ltx_font_italic">monogram</em> for each individual patient, serving as a tangible representation of their multimodal data. This representation encapsulates the intricate patterns unearthed from various data sources, thereby affording each patient a highly informative imprint or signature. This approach empowers researchers and medical practitioners to extract rich insights from a patient’s multimodal clinical data, facilitating personalized and data-driven healthcare.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">The second contribution of MarbliX lies in its ability to create a binary barcode of multimodal patient data, which often comprises voluminous files like histopathology whole slide images (WSIs) and genetic sequencing data. This compactness holds profound implications for time efficiency, computational complexity, and storage requirements. Employing <em id="S3.p3.1.1" class="ltx_emph ltx_font_italic">monograms</em> in diverse downstream tasks such as search and retrieval not only streamlines these operations but also unlocks a powerful tool that can handle data in varying formats, sizes, complexities, and sources.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Furthermore, the third significant contribution of MarbliX is its backbone independence, a feature that distinguishes it as a versatile multimodal AI framework. The capability to map different modalities within a latent space not only contributes to the model’s training efficiency but also enables the extraction of associated patterns from data modalities originating from diverse sources within the medical field. This adaptability is paramount for addressing the heterogeneous nature of medical data.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.1" class="ltx_p">Lastly, but no less important, MarbliX serves as a valuable asset in facilitating multimodal search, a crucial task in medical research and diagnosis. With the ability to construct a monogram-indexed archives, MarbliX empowers practitioners with an interactive tool to multimodal search for cases similar to a given query. This process involves generating a monogram for the query case and then scouring the archive to retrieve the most analogous monograms that share similar patterns with the query. This feature enhances the discoverability of relevant cases and expedites the decision-making process in healthcare.</p>
</div>
<div id="S3.p6" class="ltx_para">
<p id="S3.p6.1" class="ltx_p">The evaluation of MarbliX has demonstrated its remarkable success in capturing multimodal patient representations by integrating histopathology images and immunogenomic data to generate <em id="S3.p6.1.1" class="ltx_emph ltx_font_italic">monogram</em> representations. These monograms serve as condensed binary representations of patients’ multimodal features, achieved through unimodal processing and transformation, multimodal latent association by training hybrid autoencoders, and self-supervised training with triplet loss. The assessment of patient representation demonstrated the efficacy of MarbliX in capturing distinctive features from both histopathology and immunogenomics modalities.</p>
</div>
<div id="S3.p7" class="ltx_para">
<p id="S3.p7.1" class="ltx_p">The similarity analysis of generated monograms showed intra-similarity for patients with the same primary diagnosis and inter-dissimilarity between those with different primary diagnoses. Both visual and statistical analyses underscored MarbliX’s capability to generate meaningful compact binary barcodes, effectively discriminating between patients with distinct primary diagnoses. Furthermore, the evaluation of MarbliX in multimodal search and retrieval demonstrated its superiority over unimodal representations. Monograms consistently resulted in accurate and similar retrieved cases across various criteria, highlighting the model’s capability in capturing informative patterns from both histopathology and immunogenomic data. The t-SNE maps provided visual insights into MarbliX’s ability to create discriminative representations, notably enhancing the separation of cancer subtypes.</p>
</div>
<div id="S3.p8" class="ltx_para">
<p id="S3.p8.1" class="ltx_p">In summary, MarbliX has effectively achieved its objectives by generating informative multimodal monograms that capture and represent the complex features of patients with different cancer subtypes. Beyond demonstrating its robustness in patient representation through multimodal search, MarbliX emerges as a versatile framework with applications extending beyond search and retrieval. Its capability to efficiently integrate and encapsulate distinct data modalities, each inherently possessing large sizes and complexity, into a compact binary matrix is remarkable. This resulting binary matrix serves as a powerful bridge between different modalities, with each entry encoding whether specific features from one modality align with or correspond to certain features in the other. The binary nature of the representations simplifies storage requirements and computational complexity needed for various applications. Multimodal data fusion through MarbliX paves the way for more informed and data-driven decision-making in complex biomedical analyses.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methods</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This section describes the details of MarbliX’s design and the intricate process involved in generating a unique <em id="S4.p1.1.1" class="ltx_emph ltx_font_italic">monogram</em> representation. An overview of MarbliX is illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The design of MarbliX involves three main phases: unimodal transformation, multimodal latent association, and monogram representation. The details of every phase is described below.</p>
</div>
<section id="S4.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Unimodal Transformation</h4>

<div id="S4.SS0.SSSx1.p1" class="ltx_para">
<p id="S4.SS0.SSSx1.p1.3" class="ltx_p">The integration of histopathology images and immune cell sequencing data into a shared computational framework requires an alignment step to transform them into a common format. This enables joint manipulation and integration within a unified model. Hence, as a first stage, each modality, is processed and transformed into a single feature vector or embedding. For simplicity, in the context of the notation <math id="S4.SS0.SSSx1.p1.1.m1.2" class="ltx_Math" alttext="(\textbf{{I}},S)" display="inline"><semantics id="S4.SS0.SSSx1.p1.1.m1.2a"><mrow id="S4.SS0.SSSx1.p1.1.m1.2.3.2" xref="S4.SS0.SSSx1.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx1.p1.1.m1.2.3.2.1" xref="S4.SS0.SSSx1.p1.1.m1.2.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p1.1.m1.1.1" xref="S4.SS0.SSSx1.p1.1.m1.1.1a.cmml">I</mtext><mo id="S4.SS0.SSSx1.p1.1.m1.2.3.2.2" xref="S4.SS0.SSSx1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS0.SSSx1.p1.1.m1.2.2" xref="S4.SS0.SSSx1.p1.1.m1.2.2.cmml">S</mi><mo stretchy="false" id="S4.SS0.SSSx1.p1.1.m1.2.3.2.3" xref="S4.SS0.SSSx1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p1.1.m1.2b"><interval closure="open" id="S4.SS0.SSSx1.p1.1.m1.2.3.1.cmml" xref="S4.SS0.SSSx1.p1.1.m1.2.3.2"><ci id="S4.SS0.SSSx1.p1.1.m1.1.1a.cmml" xref="S4.SS0.SSSx1.p1.1.m1.1.1"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p1.1.m1.1.1.cmml" xref="S4.SS0.SSSx1.p1.1.m1.1.1">I</mtext></ci><ci id="S4.SS0.SSSx1.p1.1.m1.2.2.cmml" xref="S4.SS0.SSSx1.p1.1.m1.2.2">𝑆</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p1.1.m1.2c">(\textbf{{I}},S)</annotation></semantics></math>, <span id="S4.SS0.SSSx1.p1.3.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">I</span> represents the histopathology image, while <math id="S4.SS0.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS0.SSSx1.p1.3.m3.1a"><mi id="S4.SS0.SSSx1.p1.3.m3.1.1" xref="S4.SS0.SSSx1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p1.3.m3.1b"><ci id="S4.SS0.SSSx1.p1.3.m3.1.1.cmml" xref="S4.SS0.SSSx1.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p1.3.m3.1c">S</annotation></semantics></math> represents the immunogenomic data (a set of immune cell sequences) of a given case.</p>
</div>
<div id="S4.SS0.SSSx1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSSx1.p2.8" class="ltx_p"><span id="S4.SS0.SSSx1.p2.8.1" class="ltx_text ltx_font_bold">Image processing</span>: to represent the WSIs, <span id="S4.SS0.SSSx1.p2.8.2" class="ltx_text" style="color:#0000FF;">SPLICE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></span> was employed to select representative patches, forming a <em id="S4.SS0.SSSx1.p2.8.3" class="ltx_emph ltx_font_italic">collage</em> for image <span id="S4.SS0.SSSx1.p2.8.4" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">I</span> after segmenting the tissue region from the background using Otsu thresholding. This collage is a condensed representation, composed of a select set of representative patches extracted from <span id="S4.SS0.SSSx1.p2.8.5" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">I</span>, capturing the crucial tissue characteristics that define the image. The <em id="S4.SS0.SSSx1.p2.8.6" class="ltx_emph ltx_font_italic">collage</em> was generated by setting the similarity threshold to the 30th percentile, striking a balance between performance and computational/storage requirements. Once the <em id="S4.SS0.SSSx1.p2.8.7" class="ltx_emph ltx_font_italic">collage</em> is generated for <span id="S4.SS0.SSSx1.p2.8.8" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">I</span>, the next step involves extracting deep features from the individual patches that compose the <em id="S4.SS0.SSSx1.p2.8.9" class="ltx_emph ltx_font_italic">collage</em>. This process is achieved by leveraging a pre-trained deep neural network <math id="S4.SS0.SSSx1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{F}" display="inline"><semantics id="S4.SS0.SSSx1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx1.p2.4.m4.1.1" xref="S4.SS0.SSSx1.p2.4.m4.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p2.4.m4.1b"><ci id="S4.SS0.SSSx1.p2.4.m4.1.1.cmml" xref="S4.SS0.SSSx1.p2.4.m4.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p2.4.m4.1c">\mathcal{F}</annotation></semantics></math>, here we used DINO ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, which possesses the ability to extract patterns and meaningful information within these patches. As a result of this indexing, a feature vector <math id="S4.SS0.SSSx1.p2.5.m5.1" class="ltx_Math" alttext="\textbf{{f}}_{i}" display="inline"><semantics id="S4.SS0.SSSx1.p2.5.m5.1a"><msub id="S4.SS0.SSSx1.p2.5.m5.1.1" xref="S4.SS0.SSSx1.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.5.m5.1.1.2" xref="S4.SS0.SSSx1.p2.5.m5.1.1.2a.cmml">f</mtext><mi id="S4.SS0.SSSx1.p2.5.m5.1.1.3" xref="S4.SS0.SSSx1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p2.5.m5.1b"><apply id="S4.SS0.SSSx1.p2.5.m5.1.1.cmml" xref="S4.SS0.SSSx1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p2.5.m5.1.1.1.cmml" xref="S4.SS0.SSSx1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS0.SSSx1.p2.5.m5.1.1.2a.cmml" xref="S4.SS0.SSSx1.p2.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.5.m5.1.1.2.cmml" xref="S4.SS0.SSSx1.p2.5.m5.1.1.2">f</mtext></ci><ci id="S4.SS0.SSSx1.p2.5.m5.1.1.3.cmml" xref="S4.SS0.SSSx1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p2.5.m5.1c">\textbf{{f}}_{i}</annotation></semantics></math> of patch <math id="S4.SS0.SSSx1.p2.6.m6.1" class="ltx_Math" alttext="\textbf{{P}}_{i}" display="inline"><semantics id="S4.SS0.SSSx1.p2.6.m6.1a"><msub id="S4.SS0.SSSx1.p2.6.m6.1.1" xref="S4.SS0.SSSx1.p2.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.6.m6.1.1.2" xref="S4.SS0.SSSx1.p2.6.m6.1.1.2a.cmml">P</mtext><mi id="S4.SS0.SSSx1.p2.6.m6.1.1.3" xref="S4.SS0.SSSx1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p2.6.m6.1b"><apply id="S4.SS0.SSSx1.p2.6.m6.1.1.cmml" xref="S4.SS0.SSSx1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p2.6.m6.1.1.1.cmml" xref="S4.SS0.SSSx1.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS0.SSSx1.p2.6.m6.1.1.2a.cmml" xref="S4.SS0.SSSx1.p2.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.6.m6.1.1.2.cmml" xref="S4.SS0.SSSx1.p2.6.m6.1.1.2">P</mtext></ci><ci id="S4.SS0.SSSx1.p2.6.m6.1.1.3.cmml" xref="S4.SS0.SSSx1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p2.6.m6.1c">\textbf{{P}}_{i}</annotation></semantics></math> within the collage is generated by applying <math id="S4.SS0.SSSx1.p2.7.m7.1" class="ltx_Math" alttext="\textbf{{f}}_{i}=\mathcal{F}(\textbf{{P}}_{i})" display="inline"><semantics id="S4.SS0.SSSx1.p2.7.m7.1a"><mrow id="S4.SS0.SSSx1.p2.7.m7.1.1" xref="S4.SS0.SSSx1.p2.7.m7.1.1.cmml"><msub id="S4.SS0.SSSx1.p2.7.m7.1.1.3" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.7.m7.1.1.3.2" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3.2a.cmml">f</mtext><mi id="S4.SS0.SSSx1.p2.7.m7.1.1.3.3" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS0.SSSx1.p2.7.m7.1.1.2" xref="S4.SS0.SSSx1.p2.7.m7.1.1.2.cmml">=</mo><mrow id="S4.SS0.SSSx1.p2.7.m7.1.1.1" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx1.p2.7.m7.1.1.1.3" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx1.p2.7.m7.1.1.1.2" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.2.cmml">​</mo><mrow id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.2" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.2" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.2a.cmml">P</mtext><mi id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.3" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.3" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p2.7.m7.1b"><apply id="S4.SS0.SSSx1.p2.7.m7.1.1.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1"><eq id="S4.SS0.SSSx1.p2.7.m7.1.1.2.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.2"></eq><apply id="S4.SS0.SSSx1.p2.7.m7.1.1.3.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p2.7.m7.1.1.3.1.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS0.SSSx1.p2.7.m7.1.1.3.2a.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.7.m7.1.1.3.2.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3.2">f</mtext></ci><ci id="S4.SS0.SSSx1.p2.7.m7.1.1.3.3.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.3.3">𝑖</ci></apply><apply id="S4.SS0.SSSx1.p2.7.m7.1.1.1.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1"><times id="S4.SS0.SSSx1.p2.7.m7.1.1.1.2.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.2"></times><ci id="S4.SS0.SSSx1.p2.7.m7.1.1.1.3.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.3">ℱ</ci><apply id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.2a.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.2.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.2">P</mtext></ci><ci id="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.3.cmml" xref="S4.SS0.SSSx1.p2.7.m7.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p2.7.m7.1c">\textbf{{f}}_{i}=\mathcal{F}(\textbf{{P}}_{i})</annotation></semantics></math>, where <math id="S4.SS0.SSSx1.p2.8.m8.1" class="ltx_Math" alttext="\textbf{{f}}_{i}\in\mathbb{R}^{l\times 1}" display="inline"><semantics id="S4.SS0.SSSx1.p2.8.m8.1a"><mrow id="S4.SS0.SSSx1.p2.8.m8.1.1" xref="S4.SS0.SSSx1.p2.8.m8.1.1.cmml"><msub id="S4.SS0.SSSx1.p2.8.m8.1.1.2" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.8.m8.1.1.2.2" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2.2a.cmml">f</mtext><mi id="S4.SS0.SSSx1.p2.8.m8.1.1.2.3" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS0.SSSx1.p2.8.m8.1.1.1" xref="S4.SS0.SSSx1.p2.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS0.SSSx1.p2.8.m8.1.1.3" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.cmml"><mi id="S4.SS0.SSSx1.p2.8.m8.1.1.3.2" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.cmml"><mi id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.2" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.1" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.1.cmml">×</mo><mn id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.3" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p2.8.m8.1b"><apply id="S4.SS0.SSSx1.p2.8.m8.1.1.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1"><in id="S4.SS0.SSSx1.p2.8.m8.1.1.1.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.1"></in><apply id="S4.SS0.SSSx1.p2.8.m8.1.1.2.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p2.8.m8.1.1.2.1.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS0.SSSx1.p2.8.m8.1.1.2.2a.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p2.8.m8.1.1.2.2.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2.2">f</mtext></ci><ci id="S4.SS0.SSSx1.p2.8.m8.1.1.2.3.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.2.3">𝑖</ci></apply><apply id="S4.SS0.SSSx1.p2.8.m8.1.1.3.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p2.8.m8.1.1.3.1.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS0.SSSx1.p2.8.m8.1.1.3.2.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.2">ℝ</ci><apply id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3"><times id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.1.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.1"></times><ci id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.2.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.3.cmml" xref="S4.SS0.SSSx1.p2.8.m8.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p2.8.m8.1c">\textbf{{f}}_{i}\in\mathbb{R}^{l\times 1}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS0.SSSx1.p3" class="ltx_para">
<p id="S4.SS0.SSSx1.p3.3" class="ltx_p">To craft an all-encompassing feature vector that encapsulates the entirety of image <span id="S4.SS0.SSSx1.p3.3.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">I</span> and effectively represents its rich content, a widely adopted practice involves computing the average of the patch-level feature vectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, resulting in a single feature vector <math id="S4.SS0.SSSx1.p3.2.m2.1" class="ltx_Math" alttext="\textbf{{f}}\in\mathbb{R}^{l\times 1}" display="inline"><semantics id="S4.SS0.SSSx1.p3.2.m2.1a"><mrow id="S4.SS0.SSSx1.p3.2.m2.1.1" xref="S4.SS0.SSSx1.p3.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p3.2.m2.1.1.2" xref="S4.SS0.SSSx1.p3.2.m2.1.1.2a.cmml">f</mtext><mo id="S4.SS0.SSSx1.p3.2.m2.1.1.1" xref="S4.SS0.SSSx1.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS0.SSSx1.p3.2.m2.1.1.3" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.cmml"><mi id="S4.SS0.SSSx1.p3.2.m2.1.1.3.2" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.cmml"><mi id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.2" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.1" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.3" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p3.2.m2.1b"><apply id="S4.SS0.SSSx1.p3.2.m2.1.1.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1"><in id="S4.SS0.SSSx1.p3.2.m2.1.1.1.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.1"></in><ci id="S4.SS0.SSSx1.p3.2.m2.1.1.2a.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p3.2.m2.1.1.2.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.2">f</mtext></ci><apply id="S4.SS0.SSSx1.p3.2.m2.1.1.3.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS0.SSSx1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3"><times id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.1"></times><ci id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS0.SSSx1.p3.2.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p3.2.m2.1c">\textbf{{f}}\in\mathbb{R}^{l\times 1}</annotation></semantics></math> that serves as a holistic representation of the entire image <span id="S4.SS0.SSSx1.p3.3.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">I</span>. As we used DINO ViT, this resulted in a 768-dimensional embedding for the entire WSI.</p>
</div>
<div id="S4.SS0.SSSx1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSSx1.p4.6" class="ltx_p"><span id="S4.SS0.SSSx1.p4.6.1" class="ltx_text ltx_font_bold">Sequencing data processing</span>: for the immunogenomic data, raw RNA-seq files from TCGA were utilized to reconstruct the immune repertoire of every patient. TRUST4 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> was employed to obtain the TCR and BCR sequences of each patient from their RNA-seq profiles. Rare sequences and artifacts were filtered out by excluding those that were not common to a sufficient proportion of patients within each subtype class. Through experimentation, for the lung dataset, sequences that were not common to at least 30% of the patients within the subtype class were excluded, while a lower threshold of 15% was applied to kidney cases due to the limited number of samples. Before we encode the sequencing data into a dense vector, we applied <span id="S4.SS0.SSSx1.p4.6.2" class="ltx_text" style="color:#0000FF;">Seqwash <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite></span> method to preprocess the sequencing profiles and prepare them for feature extraction. Seqwash is a “harmonization” approach tailored to genetic sequencing data and serves as a crucial preprocessing step, aimed at preparing these sequences for analysis using deep models designed for textual data by overcoming the impact of the variability among patients in terms of sequence lengths and unregulated sequence orders. Therefore, Seqwash was used to unify the patient profiles by aligning them into a standardized representation before proceeding with deep feature extraction. The ultimate goal is to create a single, coherent embedding that encapsulates vital information while negating the effects of varying sequence orders within each patient’s profile. Applying Seqwash on sequencing profile <math id="S4.SS0.SSSx1.p4.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS0.SSSx1.p4.1.m1.1a"><mi id="S4.SS0.SSSx1.p4.1.m1.1.1" xref="S4.SS0.SSSx1.p4.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p4.1.m1.1b"><ci id="S4.SS0.SSSx1.p4.1.m1.1.1.cmml" xref="S4.SS0.SSSx1.p4.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p4.1.m1.1c">S</annotation></semantics></math> results in a harmonized set <math id="S4.SS0.SSSx1.p4.2.m2.1" class="ltx_Math" alttext="S_{h}" display="inline"><semantics id="S4.SS0.SSSx1.p4.2.m2.1a"><msub id="S4.SS0.SSSx1.p4.2.m2.1.1" xref="S4.SS0.SSSx1.p4.2.m2.1.1.cmml"><mi id="S4.SS0.SSSx1.p4.2.m2.1.1.2" xref="S4.SS0.SSSx1.p4.2.m2.1.1.2.cmml">S</mi><mi id="S4.SS0.SSSx1.p4.2.m2.1.1.3" xref="S4.SS0.SSSx1.p4.2.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p4.2.m2.1b"><apply id="S4.SS0.SSSx1.p4.2.m2.1.1.cmml" xref="S4.SS0.SSSx1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p4.2.m2.1.1.1.cmml" xref="S4.SS0.SSSx1.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS0.SSSx1.p4.2.m2.1.1.2.cmml" xref="S4.SS0.SSSx1.p4.2.m2.1.1.2">𝑆</ci><ci id="S4.SS0.SSSx1.p4.2.m2.1.1.3.cmml" xref="S4.SS0.SSSx1.p4.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p4.2.m2.1c">S_{h}</annotation></semantics></math>. A pre-trained deep learning model <math id="S4.SS0.SSSx1.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S4.SS0.SSSx1.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx1.p4.3.m3.1.1" xref="S4.SS0.SSSx1.p4.3.m3.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p4.3.m3.1b"><ci id="S4.SS0.SSSx1.p4.3.m3.1.1.cmml" xref="S4.SS0.SSSx1.p4.3.m3.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p4.3.m3.1c">\mathcal{G}</annotation></semantics></math> is then employed to distill features from the sequences by applying <math id="S4.SS0.SSSx1.p4.4.m4.1" class="ltx_Math" alttext="\textbf{{g}}=\mathcal{G}(S_{h})" display="inline"><semantics id="S4.SS0.SSSx1.p4.4.m4.1a"><mrow id="S4.SS0.SSSx1.p4.4.m4.1.1" xref="S4.SS0.SSSx1.p4.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p4.4.m4.1.1.3" xref="S4.SS0.SSSx1.p4.4.m4.1.1.3a.cmml">g</mtext><mo id="S4.SS0.SSSx1.p4.4.m4.1.1.2" xref="S4.SS0.SSSx1.p4.4.m4.1.1.2.cmml">=</mo><mrow id="S4.SS0.SSSx1.p4.4.m4.1.1.1" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx1.p4.4.m4.1.1.1.3" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.3.cmml">𝒢</mi><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx1.p4.4.m4.1.1.1.2" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.2.cmml">​</mo><mrow id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.2" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.cmml"><mi id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.2" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.2.cmml">S</mi><mi id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.3" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.3" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p4.4.m4.1b"><apply id="S4.SS0.SSSx1.p4.4.m4.1.1.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1"><eq id="S4.SS0.SSSx1.p4.4.m4.1.1.2.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.2"></eq><ci id="S4.SS0.SSSx1.p4.4.m4.1.1.3a.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.3"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p4.4.m4.1.1.3.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.3">g</mtext></ci><apply id="S4.SS0.SSSx1.p4.4.m4.1.1.1.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1"><times id="S4.SS0.SSSx1.p4.4.m4.1.1.1.2.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.2"></times><ci id="S4.SS0.SSSx1.p4.4.m4.1.1.1.3.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.3">𝒢</ci><apply id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.2">𝑆</ci><ci id="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS0.SSSx1.p4.4.m4.1.1.1.1.1.1.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p4.4.m4.1c">\textbf{{g}}=\mathcal{G}(S_{h})</annotation></semantics></math>, where <math id="S4.SS0.SSSx1.p4.5.m5.1" class="ltx_Math" alttext="\textbf{{g}}\in\mathbb{R}^{l\times 1}" display="inline"><semantics id="S4.SS0.SSSx1.p4.5.m5.1a"><mrow id="S4.SS0.SSSx1.p4.5.m5.1.1" xref="S4.SS0.SSSx1.p4.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p4.5.m5.1.1.2" xref="S4.SS0.SSSx1.p4.5.m5.1.1.2a.cmml">g</mtext><mo id="S4.SS0.SSSx1.p4.5.m5.1.1.1" xref="S4.SS0.SSSx1.p4.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS0.SSSx1.p4.5.m5.1.1.3" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.cmml"><mi id="S4.SS0.SSSx1.p4.5.m5.1.1.3.2" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.cmml"><mi id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.2" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.1" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.1.cmml">×</mo><mn id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.3" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p4.5.m5.1b"><apply id="S4.SS0.SSSx1.p4.5.m5.1.1.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1"><in id="S4.SS0.SSSx1.p4.5.m5.1.1.1.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.1"></in><ci id="S4.SS0.SSSx1.p4.5.m5.1.1.2a.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx1.p4.5.m5.1.1.2.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.2">g</mtext></ci><apply id="S4.SS0.SSSx1.p4.5.m5.1.1.3.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p4.5.m5.1.1.3.1.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS0.SSSx1.p4.5.m5.1.1.3.2.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3"><times id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.1.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.1"></times><ci id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.2.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.3.cmml" xref="S4.SS0.SSSx1.p4.5.m5.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p4.5.m5.1c">\textbf{{g}}\in\mathbb{R}^{l\times 1}</annotation></semantics></math> represents a feature vector extracted from the harmonized sequences set <math id="S4.SS0.SSSx1.p4.6.m6.1" class="ltx_Math" alttext="S_{h}" display="inline"><semantics id="S4.SS0.SSSx1.p4.6.m6.1a"><msub id="S4.SS0.SSSx1.p4.6.m6.1.1" xref="S4.SS0.SSSx1.p4.6.m6.1.1.cmml"><mi id="S4.SS0.SSSx1.p4.6.m6.1.1.2" xref="S4.SS0.SSSx1.p4.6.m6.1.1.2.cmml">S</mi><mi id="S4.SS0.SSSx1.p4.6.m6.1.1.3" xref="S4.SS0.SSSx1.p4.6.m6.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx1.p4.6.m6.1b"><apply id="S4.SS0.SSSx1.p4.6.m6.1.1.cmml" xref="S4.SS0.SSSx1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx1.p4.6.m6.1.1.1.cmml" xref="S4.SS0.SSSx1.p4.6.m6.1.1">subscript</csymbol><ci id="S4.SS0.SSSx1.p4.6.m6.1.1.2.cmml" xref="S4.SS0.SSSx1.p4.6.m6.1.1.2">𝑆</ci><ci id="S4.SS0.SSSx1.p4.6.m6.1.1.3.cmml" xref="S4.SS0.SSSx1.p4.6.m6.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx1.p4.6.m6.1c">S_{h}</annotation></semantics></math>. Here, we employed BERT which resulted in a 768-dimensional embedding.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Multimodal Latent Association</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span> Histopathology image embedding <span id="alg1.l2.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">f</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span> Immune cell sequence profile embedding <span id="alg1.l3.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">g</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text ltx_font_bold">Training Stage:</span> 

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span> Initialize <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\mathcal{A}_{I}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">𝒜</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝒜</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathcal{A}_{I}</annotation></semantics></math> (Autoencoder for Histopathology):

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">while</span> not converged <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  Forward pass: <math id="alg1.l7.m1.3" class="ltx_Math" alttext="\textbf{{f}}\rightarrow\mathcal{E}_{I}(\textbf{{f}})\rightarrow\mathcal{D}_{I}(\mathcal{E}_{I}(\textbf{{f}}))" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.3.3.3" xref="alg1.l7.m1.3.3.3a.cmml">f</mtext><mo stretchy="false" id="alg1.l7.m1.3.3.4" xref="alg1.l7.m1.3.3.4.cmml">→</mo><mrow id="alg1.l7.m1.3.3.5" xref="alg1.l7.m1.3.3.5.cmml"><msub id="alg1.l7.m1.3.3.5.2" xref="alg1.l7.m1.3.3.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.3.3.5.2.2" xref="alg1.l7.m1.3.3.5.2.2.cmml">ℰ</mi><mi id="alg1.l7.m1.3.3.5.2.3" xref="alg1.l7.m1.3.3.5.2.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.3.5.1" xref="alg1.l7.m1.3.3.5.1.cmml">​</mo><mrow id="alg1.l7.m1.3.3.5.3.2" xref="alg1.l7.m1.1.1a.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.5.3.2.1" xref="alg1.l7.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">f</mtext><mo stretchy="false" id="alg1.l7.m1.3.3.5.3.2.2" xref="alg1.l7.m1.1.1a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l7.m1.3.3.6" xref="alg1.l7.m1.3.3.6.cmml">→</mo><mrow id="alg1.l7.m1.3.3.1" xref="alg1.l7.m1.3.3.1.cmml"><msub id="alg1.l7.m1.3.3.1.3" xref="alg1.l7.m1.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.3.3.1.3.2" xref="alg1.l7.m1.3.3.1.3.2.cmml">𝒟</mi><mi id="alg1.l7.m1.3.3.1.3.3" xref="alg1.l7.m1.3.3.1.3.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.3.1.2" xref="alg1.l7.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l7.m1.3.3.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.1.1.1.2" xref="alg1.l7.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.3.3.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l7.m1.3.3.1.1.1.1.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.3.3.1.1.1.1.2.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.cmml">ℰ</mi><mi id="alg1.l7.m1.3.3.1.1.1.1.2.3" xref="alg1.l7.m1.3.3.1.1.1.1.2.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.3.1.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l7.m1.3.3.1.1.1.1.3.2" xref="alg1.l7.m1.2.2a.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.1.1.1.1.3.2.1" xref="alg1.l7.m1.2.2a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">f</mtext><mo stretchy="false" id="alg1.l7.m1.3.3.1.1.1.1.3.2.2" xref="alg1.l7.m1.2.2a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l7.m1.3.3.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3"><and id="alg1.l7.m1.3.3a.cmml" xref="alg1.l7.m1.3.3"></and><apply id="alg1.l7.m1.3.3b.cmml" xref="alg1.l7.m1.3.3"><ci id="alg1.l7.m1.3.3.4.cmml" xref="alg1.l7.m1.3.3.4">→</ci><ci id="alg1.l7.m1.3.3.3a.cmml" xref="alg1.l7.m1.3.3.3"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.3.3.3.cmml" xref="alg1.l7.m1.3.3.3">f</mtext></ci><apply id="alg1.l7.m1.3.3.5.cmml" xref="alg1.l7.m1.3.3.5"><times id="alg1.l7.m1.3.3.5.1.cmml" xref="alg1.l7.m1.3.3.5.1"></times><apply id="alg1.l7.m1.3.3.5.2.cmml" xref="alg1.l7.m1.3.3.5.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.5.2.1.cmml" xref="alg1.l7.m1.3.3.5.2">subscript</csymbol><ci id="alg1.l7.m1.3.3.5.2.2.cmml" xref="alg1.l7.m1.3.3.5.2.2">ℰ</ci><ci id="alg1.l7.m1.3.3.5.2.3.cmml" xref="alg1.l7.m1.3.3.5.2.3">𝐼</ci></apply><ci id="alg1.l7.m1.1.1a.cmml" xref="alg1.l7.m1.3.3.5.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">f</mtext></ci></apply></apply><apply id="alg1.l7.m1.3.3c.cmml" xref="alg1.l7.m1.3.3"><ci id="alg1.l7.m1.3.3.6.cmml" xref="alg1.l7.m1.3.3.6">→</ci><share href="#alg1.l7.m1.3.3.5.cmml" id="alg1.l7.m1.3.3d.cmml" xref="alg1.l7.m1.3.3"></share><apply id="alg1.l7.m1.3.3.1.cmml" xref="alg1.l7.m1.3.3.1"><times id="alg1.l7.m1.3.3.1.2.cmml" xref="alg1.l7.m1.3.3.1.2"></times><apply id="alg1.l7.m1.3.3.1.3.cmml" xref="alg1.l7.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.1.3.1.cmml" xref="alg1.l7.m1.3.3.1.3">subscript</csymbol><ci id="alg1.l7.m1.3.3.1.3.2.cmml" xref="alg1.l7.m1.3.3.1.3.2">𝒟</ci><ci id="alg1.l7.m1.3.3.1.3.3.cmml" xref="alg1.l7.m1.3.3.1.3.3">𝐼</ci></apply><apply id="alg1.l7.m1.3.3.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1"><times id="alg1.l7.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.1"></times><apply id="alg1.l7.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2.2">ℰ</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2.3">𝐼</ci></apply><ci id="alg1.l7.m1.2.2a.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">f</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">\textbf{{f}}\rightarrow\mathcal{E}_{I}(\textbf{{f}})\rightarrow\mathcal{D}_{I}(\mathcal{E}_{I}(\textbf{{f}}))</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>  Compute loss: <math id="alg1.l8.m1.3" class="ltx_Math" alttext="l_{I}=\text{MSE}(\textbf{{g}},\mathcal{D}_{I}(\mathcal{E}_{I}(\textbf{{f}})))" display="inline"><semantics id="alg1.l8.m1.3a"><mrow id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml"><msub id="alg1.l8.m1.3.3.3" xref="alg1.l8.m1.3.3.3.cmml"><mi id="alg1.l8.m1.3.3.3.2" xref="alg1.l8.m1.3.3.3.2.cmml">l</mi><mi id="alg1.l8.m1.3.3.3.3" xref="alg1.l8.m1.3.3.3.3.cmml">I</mi></msub><mo id="alg1.l8.m1.3.3.2" xref="alg1.l8.m1.3.3.2.cmml">=</mo><mrow id="alg1.l8.m1.3.3.1" xref="alg1.l8.m1.3.3.1.cmml"><mtext id="alg1.l8.m1.3.3.1.3" xref="alg1.l8.m1.3.3.1.3a.cmml">MSE</mtext><mo lspace="0em" rspace="0em" id="alg1.l8.m1.3.3.1.2" xref="alg1.l8.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l8.m1.3.3.1.1.1" xref="alg1.l8.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.3.3.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.2.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2a.cmml">g</mtext><mo id="alg1.l8.m1.3.3.1.1.1.3" xref="alg1.l8.m1.3.3.1.1.2.cmml">,</mo><mrow id="alg1.l8.m1.3.3.1.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l8.m1.3.3.1.1.1.1.3" xref="alg1.l8.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.3.3.1.1.1.1.3.2" xref="alg1.l8.m1.3.3.1.1.1.1.3.2.cmml">𝒟</mi><mi id="alg1.l8.m1.3.3.1.1.1.1.3.3" xref="alg1.l8.m1.3.3.1.1.1.1.3.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.3.3.1.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l8.m1.3.3.1.1.1.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">ℰ</mi><mi id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.3" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1a.cmml"><mo stretchy="false" id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="alg1.l8.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">f</mtext><mo stretchy="false" id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="alg1.l8.m1.1.1a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l8.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l8.m1.3.3.1.1.1.4" xref="alg1.l8.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.3b"><apply id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3"><eq id="alg1.l8.m1.3.3.2.cmml" xref="alg1.l8.m1.3.3.2"></eq><apply id="alg1.l8.m1.3.3.3.cmml" xref="alg1.l8.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.3.1.cmml" xref="alg1.l8.m1.3.3.3">subscript</csymbol><ci id="alg1.l8.m1.3.3.3.2.cmml" xref="alg1.l8.m1.3.3.3.2">𝑙</ci><ci id="alg1.l8.m1.3.3.3.3.cmml" xref="alg1.l8.m1.3.3.3.3">𝐼</ci></apply><apply id="alg1.l8.m1.3.3.1.cmml" xref="alg1.l8.m1.3.3.1"><times id="alg1.l8.m1.3.3.1.2.cmml" xref="alg1.l8.m1.3.3.1.2"></times><ci id="alg1.l8.m1.3.3.1.3a.cmml" xref="alg1.l8.m1.3.3.1.3"><mtext id="alg1.l8.m1.3.3.1.3.cmml" xref="alg1.l8.m1.3.3.1.3">MSE</mtext></ci><interval closure="open" id="alg1.l8.m1.3.3.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1"><ci id="alg1.l8.m1.2.2a.cmml" xref="alg1.l8.m1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">g</mtext></ci><apply id="alg1.l8.m1.3.3.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1"><times id="alg1.l8.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.2"></times><apply id="alg1.l8.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.3.2">𝒟</ci><ci id="alg1.l8.m1.3.3.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.3.3">𝐼</ci></apply><apply id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1"><times id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.1"></times><apply id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.2">ℰ</ci><ci id="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.2.3">𝐼</ci></apply><ci id="alg1.l8.m1.1.1a.cmml" xref="alg1.l8.m1.3.3.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">f</mtext></ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.3c">l_{I}=\text{MSE}(\textbf{{g}},\mathcal{D}_{I}(\mathcal{E}_{I}(\textbf{{f}})))</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  Backpropagate and update weights 

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span> Initialize <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\mathcal{A}_{S}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">𝒜</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝒜</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathcal{A}_{S}</annotation></semantics></math> (Autoencoder for Immune Cell Sequences): 

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">while</span> not converged <span id="alg1.l11.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  Forward pass: <math id="alg1.l12.m1.3" class="ltx_Math" alttext="\textbf{{g}}\rightarrow\mathcal{E}_{S}(\textbf{{g}})\rightarrow\mathcal{D}_{S}(\mathcal{E}_{S}(\textbf{{g}}))" display="inline"><semantics id="alg1.l12.m1.3a"><mrow id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l12.m1.3.3.3" xref="alg1.l12.m1.3.3.3a.cmml">g</mtext><mo stretchy="false" id="alg1.l12.m1.3.3.4" xref="alg1.l12.m1.3.3.4.cmml">→</mo><mrow id="alg1.l12.m1.3.3.5" xref="alg1.l12.m1.3.3.5.cmml"><msub id="alg1.l12.m1.3.3.5.2" xref="alg1.l12.m1.3.3.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.3.3.5.2.2" xref="alg1.l12.m1.3.3.5.2.2.cmml">ℰ</mi><mi id="alg1.l12.m1.3.3.5.2.3" xref="alg1.l12.m1.3.3.5.2.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l12.m1.3.3.5.1" xref="alg1.l12.m1.3.3.5.1.cmml">​</mo><mrow id="alg1.l12.m1.3.3.5.3.2" xref="alg1.l12.m1.1.1a.cmml"><mo stretchy="false" id="alg1.l12.m1.3.3.5.3.2.1" xref="alg1.l12.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">g</mtext><mo stretchy="false" id="alg1.l12.m1.3.3.5.3.2.2" xref="alg1.l12.m1.1.1a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l12.m1.3.3.6" xref="alg1.l12.m1.3.3.6.cmml">→</mo><mrow id="alg1.l12.m1.3.3.1" xref="alg1.l12.m1.3.3.1.cmml"><msub id="alg1.l12.m1.3.3.1.3" xref="alg1.l12.m1.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.3.3.1.3.2" xref="alg1.l12.m1.3.3.1.3.2.cmml">𝒟</mi><mi id="alg1.l12.m1.3.3.1.3.3" xref="alg1.l12.m1.3.3.1.3.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l12.m1.3.3.1.2" xref="alg1.l12.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l12.m1.3.3.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l12.m1.3.3.1.1.1.2" xref="alg1.l12.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="alg1.l12.m1.3.3.1.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l12.m1.3.3.1.1.1.1.2" xref="alg1.l12.m1.3.3.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.3.3.1.1.1.1.2.2" xref="alg1.l12.m1.3.3.1.1.1.1.2.2.cmml">ℰ</mi><mi id="alg1.l12.m1.3.3.1.1.1.1.2.3" xref="alg1.l12.m1.3.3.1.1.1.1.2.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l12.m1.3.3.1.1.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l12.m1.3.3.1.1.1.1.3.2" xref="alg1.l12.m1.2.2a.cmml"><mo stretchy="false" id="alg1.l12.m1.3.3.1.1.1.1.3.2.1" xref="alg1.l12.m1.2.2a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml">g</mtext><mo stretchy="false" id="alg1.l12.m1.3.3.1.1.1.1.3.2.2" xref="alg1.l12.m1.2.2a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l12.m1.3.3.1.1.1.3" xref="alg1.l12.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.3b"><apply id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3"><and id="alg1.l12.m1.3.3a.cmml" xref="alg1.l12.m1.3.3"></and><apply id="alg1.l12.m1.3.3b.cmml" xref="alg1.l12.m1.3.3"><ci id="alg1.l12.m1.3.3.4.cmml" xref="alg1.l12.m1.3.3.4">→</ci><ci id="alg1.l12.m1.3.3.3a.cmml" xref="alg1.l12.m1.3.3.3"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l12.m1.3.3.3.cmml" xref="alg1.l12.m1.3.3.3">g</mtext></ci><apply id="alg1.l12.m1.3.3.5.cmml" xref="alg1.l12.m1.3.3.5"><times id="alg1.l12.m1.3.3.5.1.cmml" xref="alg1.l12.m1.3.3.5.1"></times><apply id="alg1.l12.m1.3.3.5.2.cmml" xref="alg1.l12.m1.3.3.5.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.5.2.1.cmml" xref="alg1.l12.m1.3.3.5.2">subscript</csymbol><ci id="alg1.l12.m1.3.3.5.2.2.cmml" xref="alg1.l12.m1.3.3.5.2.2">ℰ</ci><ci id="alg1.l12.m1.3.3.5.2.3.cmml" xref="alg1.l12.m1.3.3.5.2.3">𝑆</ci></apply><ci id="alg1.l12.m1.1.1a.cmml" xref="alg1.l12.m1.3.3.5.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">g</mtext></ci></apply></apply><apply id="alg1.l12.m1.3.3c.cmml" xref="alg1.l12.m1.3.3"><ci id="alg1.l12.m1.3.3.6.cmml" xref="alg1.l12.m1.3.3.6">→</ci><share href="#alg1.l12.m1.3.3.5.cmml" id="alg1.l12.m1.3.3d.cmml" xref="alg1.l12.m1.3.3"></share><apply id="alg1.l12.m1.3.3.1.cmml" xref="alg1.l12.m1.3.3.1"><times id="alg1.l12.m1.3.3.1.2.cmml" xref="alg1.l12.m1.3.3.1.2"></times><apply id="alg1.l12.m1.3.3.1.3.cmml" xref="alg1.l12.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.1.3.1.cmml" xref="alg1.l12.m1.3.3.1.3">subscript</csymbol><ci id="alg1.l12.m1.3.3.1.3.2.cmml" xref="alg1.l12.m1.3.3.1.3.2">𝒟</ci><ci id="alg1.l12.m1.3.3.1.3.3.cmml" xref="alg1.l12.m1.3.3.1.3.3">𝑆</ci></apply><apply id="alg1.l12.m1.3.3.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1"><times id="alg1.l12.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.1"></times><apply id="alg1.l12.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.2.2">ℰ</ci><ci id="alg1.l12.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.2.3">𝑆</ci></apply><ci id="alg1.l12.m1.2.2a.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2">g</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.3c">\textbf{{g}}\rightarrow\mathcal{E}_{S}(\textbf{{g}})\rightarrow\mathcal{D}_{S}(\mathcal{E}_{S}(\textbf{{g}}))</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>  Compute loss: <math id="alg1.l13.m1.3" class="ltx_Math" alttext="l_{S}=\text{MSE}(\textbf{{f}},\mathcal{D}_{S}(\mathcal{E}_{S}(\textbf{{g}})))" display="inline"><semantics id="alg1.l13.m1.3a"><mrow id="alg1.l13.m1.3.3" xref="alg1.l13.m1.3.3.cmml"><msub id="alg1.l13.m1.3.3.3" xref="alg1.l13.m1.3.3.3.cmml"><mi id="alg1.l13.m1.3.3.3.2" xref="alg1.l13.m1.3.3.3.2.cmml">l</mi><mi id="alg1.l13.m1.3.3.3.3" xref="alg1.l13.m1.3.3.3.3.cmml">S</mi></msub><mo id="alg1.l13.m1.3.3.2" xref="alg1.l13.m1.3.3.2.cmml">=</mo><mrow id="alg1.l13.m1.3.3.1" xref="alg1.l13.m1.3.3.1.cmml"><mtext id="alg1.l13.m1.3.3.1.3" xref="alg1.l13.m1.3.3.1.3a.cmml">MSE</mtext><mo lspace="0em" rspace="0em" id="alg1.l13.m1.3.3.1.2" xref="alg1.l13.m1.3.3.1.2.cmml">​</mo><mrow id="alg1.l13.m1.3.3.1.1.1" xref="alg1.l13.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.l13.m1.3.3.1.1.1.2" xref="alg1.l13.m1.3.3.1.1.2.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2a.cmml">f</mtext><mo id="alg1.l13.m1.3.3.1.1.1.3" xref="alg1.l13.m1.3.3.1.1.2.cmml">,</mo><mrow id="alg1.l13.m1.3.3.1.1.1.1" xref="alg1.l13.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l13.m1.3.3.1.1.1.1.3" xref="alg1.l13.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.3.3.1.1.1.1.3.2" xref="alg1.l13.m1.3.3.1.1.1.1.3.2.cmml">𝒟</mi><mi id="alg1.l13.m1.3.3.1.1.1.1.3.3" xref="alg1.l13.m1.3.3.1.1.1.1.3.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l13.m1.3.3.1.1.1.1.2" xref="alg1.l13.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l13.m1.3.3.1.1.1.1.1.1" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l13.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.2" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">ℰ</mi><mi id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.3" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.1" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1a.cmml"><mo stretchy="false" id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="alg1.l13.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">g</mtext><mo stretchy="false" id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="alg1.l13.m1.1.1a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l13.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l13.m1.3.3.1.1.1.4" xref="alg1.l13.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.3b"><apply id="alg1.l13.m1.3.3.cmml" xref="alg1.l13.m1.3.3"><eq id="alg1.l13.m1.3.3.2.cmml" xref="alg1.l13.m1.3.3.2"></eq><apply id="alg1.l13.m1.3.3.3.cmml" xref="alg1.l13.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.3.1.cmml" xref="alg1.l13.m1.3.3.3">subscript</csymbol><ci id="alg1.l13.m1.3.3.3.2.cmml" xref="alg1.l13.m1.3.3.3.2">𝑙</ci><ci id="alg1.l13.m1.3.3.3.3.cmml" xref="alg1.l13.m1.3.3.3.3">𝑆</ci></apply><apply id="alg1.l13.m1.3.3.1.cmml" xref="alg1.l13.m1.3.3.1"><times id="alg1.l13.m1.3.3.1.2.cmml" xref="alg1.l13.m1.3.3.1.2"></times><ci id="alg1.l13.m1.3.3.1.3a.cmml" xref="alg1.l13.m1.3.3.1.3"><mtext id="alg1.l13.m1.3.3.1.3.cmml" xref="alg1.l13.m1.3.3.1.3">MSE</mtext></ci><interval closure="open" id="alg1.l13.m1.3.3.1.1.2.cmml" xref="alg1.l13.m1.3.3.1.1.1"><ci id="alg1.l13.m1.2.2a.cmml" xref="alg1.l13.m1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2">f</mtext></ci><apply id="alg1.l13.m1.3.3.1.1.1.1.cmml" xref="alg1.l13.m1.3.3.1.1.1.1"><times id="alg1.l13.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.2"></times><apply id="alg1.l13.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.3.2">𝒟</ci><ci id="alg1.l13.m1.3.3.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.3.3">𝑆</ci></apply><apply id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.1.1"><times id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.1"></times><apply id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.2">ℰ</ci><ci id="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.2.3">𝑆</ci></apply><ci id="alg1.l13.m1.1.1a.cmml" xref="alg1.l13.m1.3.3.1.1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">g</mtext></ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.3c">l_{S}=\text{MSE}(\textbf{{f}},\mathcal{D}_{S}(\mathcal{E}_{S}(\textbf{{g}})))</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  Backpropagate and update weights 

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg1.l15.2" class="ltx_text ltx_font_bold">Latent Representation:</span> 

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span> Encode using the encoder of <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\mathcal{A}_{I}" display="inline"><semantics id="alg1.l16.m1.1a"><msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">𝒜</mi><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">𝒜</ci><ci id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\mathcal{A}_{I}</annotation></semantics></math>:

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>  <math id="alg1.l17.m1.1" class="ltx_Math" alttext="\textbf{{u}}\leftarrow\mathcal{E}_{I}(\textbf{{f}})" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.2" xref="alg1.l17.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l17.m1.1.2.2" xref="alg1.l17.m1.1.2.2a.cmml">u</mtext><mo stretchy="false" id="alg1.l17.m1.1.2.1" xref="alg1.l17.m1.1.2.1.cmml">←</mo><mrow id="alg1.l17.m1.1.2.3" xref="alg1.l17.m1.1.2.3.cmml"><msub id="alg1.l17.m1.1.2.3.2" xref="alg1.l17.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.1.2.3.2.2" xref="alg1.l17.m1.1.2.3.2.2.cmml">ℰ</mi><mi id="alg1.l17.m1.1.2.3.2.3" xref="alg1.l17.m1.1.2.3.2.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.2.3.1" xref="alg1.l17.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l17.m1.1.2.3.3.2" xref="alg1.l17.m1.1.1a.cmml"><mo stretchy="false" id="alg1.l17.m1.1.2.3.3.2.1" xref="alg1.l17.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">f</mtext><mo stretchy="false" id="alg1.l17.m1.1.2.3.3.2.2" xref="alg1.l17.m1.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.2.cmml" xref="alg1.l17.m1.1.2"><ci id="alg1.l17.m1.1.2.1.cmml" xref="alg1.l17.m1.1.2.1">←</ci><ci id="alg1.l17.m1.1.2.2a.cmml" xref="alg1.l17.m1.1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l17.m1.1.2.2.cmml" xref="alg1.l17.m1.1.2.2">u</mtext></ci><apply id="alg1.l17.m1.1.2.3.cmml" xref="alg1.l17.m1.1.2.3"><times id="alg1.l17.m1.1.2.3.1.cmml" xref="alg1.l17.m1.1.2.3.1"></times><apply id="alg1.l17.m1.1.2.3.2.cmml" xref="alg1.l17.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.2.3.2.1.cmml" xref="alg1.l17.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l17.m1.1.2.3.2.2.cmml" xref="alg1.l17.m1.1.2.3.2.2">ℰ</ci><ci id="alg1.l17.m1.1.2.3.2.3.cmml" xref="alg1.l17.m1.1.2.3.2.3">𝐼</ci></apply><ci id="alg1.l17.m1.1.1a.cmml" xref="alg1.l17.m1.1.2.3.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">f</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\textbf{{u}}\leftarrow\mathcal{E}_{I}(\textbf{{f}})</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span> Encode using the encoder of <math id="alg1.l18.m1.1" class="ltx_Math" alttext="\mathcal{A}_{S}" display="inline"><semantics id="alg1.l18.m1.1a"><msub id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml">𝒜</mi><mi id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2">𝒜</ci><ci id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\mathcal{A}_{S}</annotation></semantics></math>:

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>  <math id="alg1.l19.m1.1" class="ltx_Math" alttext="\textbf{{v}}\leftarrow\mathcal{E}_{S}(\textbf{{g}})" display="inline"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.2" xref="alg1.l19.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l19.m1.1.2.2" xref="alg1.l19.m1.1.2.2a.cmml">v</mtext><mo stretchy="false" id="alg1.l19.m1.1.2.1" xref="alg1.l19.m1.1.2.1.cmml">←</mo><mrow id="alg1.l19.m1.1.2.3" xref="alg1.l19.m1.1.2.3.cmml"><msub id="alg1.l19.m1.1.2.3.2" xref="alg1.l19.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l19.m1.1.2.3.2.2" xref="alg1.l19.m1.1.2.3.2.2.cmml">ℰ</mi><mi id="alg1.l19.m1.1.2.3.2.3" xref="alg1.l19.m1.1.2.3.2.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l19.m1.1.2.3.1" xref="alg1.l19.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l19.m1.1.2.3.3.2" xref="alg1.l19.m1.1.1a.cmml"><mo stretchy="false" id="alg1.l19.m1.1.2.3.3.2.1" xref="alg1.l19.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">g</mtext><mo stretchy="false" id="alg1.l19.m1.1.2.3.3.2.2" xref="alg1.l19.m1.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.2.cmml" xref="alg1.l19.m1.1.2"><ci id="alg1.l19.m1.1.2.1.cmml" xref="alg1.l19.m1.1.2.1">←</ci><ci id="alg1.l19.m1.1.2.2a.cmml" xref="alg1.l19.m1.1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l19.m1.1.2.2.cmml" xref="alg1.l19.m1.1.2.2">v</mtext></ci><apply id="alg1.l19.m1.1.2.3.cmml" xref="alg1.l19.m1.1.2.3"><times id="alg1.l19.m1.1.2.3.1.cmml" xref="alg1.l19.m1.1.2.3.1"></times><apply id="alg1.l19.m1.1.2.3.2.cmml" xref="alg1.l19.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.2.3.2.1.cmml" xref="alg1.l19.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l19.m1.1.2.3.2.2.cmml" xref="alg1.l19.m1.1.2.3.2.2">ℰ</ci><ci id="alg1.l19.m1.1.2.3.2.3.cmml" xref="alg1.l19.m1.1.2.3.2.3">𝑆</ci></apply><ci id="alg1.l19.m1.1.1a.cmml" xref="alg1.l19.m1.1.2.3.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">g</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\textbf{{v}}\leftarrow\mathcal{E}_{S}(\textbf{{g}})</annotation></semantics></math>

</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span><span id="alg1.l20.2" class="ltx_text ltx_font_bold">return</span> <span id="alg1.l20.3" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span>, <span id="alg1.l20.4" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span> 

</div>
</div>
</figure>
</section>
<section id="S4.SS0.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Multimodal Latent Association</h4>

<div id="S4.SS0.SSSx2.p1" class="ltx_para">
<p id="S4.SS0.SSSx2.p1.4" class="ltx_p">Following the transformation of each modality, histopathology image <span id="S4.SS0.SSSx2.p1.4.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">I</span> into embedding <span id="S4.SS0.SSSx2.p1.4.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">f</span> and immune cell sequence profile <math id="S4.SS0.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS0.SSSx2.p1.3.m3.1a"><mi id="S4.SS0.SSSx2.p1.3.m3.1.1" xref="S4.SS0.SSSx2.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p1.3.m3.1b"><ci id="S4.SS0.SSSx2.p1.3.m3.1.1.cmml" xref="S4.SS0.SSSx2.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p1.3.m3.1c">S</annotation></semantics></math> into embedding <span id="S4.SS0.SSSx2.p1.4.3" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">g</span>, the association between these embeddings is learned. However, as these embeddings come from different models, they have different ranges. Therefore, min-max rescaling was performed to bring the embeddings to a common scale before learning the association between them. After normalization, association learning was performed by projecting the two embeddings into a shared latent space. In this shared space, the embeddings from both modalities coalesce to form a concise patient representation. This step addresses the issue of non-relevant features that may exist in the uni-modal data obtained from a pretrained network. By merging these embeddings into an encoded representation, we want to extract and consolidate the pertinent features from each modality, enhancing their combined synergy and informative value in subsequent analyses.</p>
</div>
<div id="S4.SS0.SSSx2.p2" class="ltx_para">
<p id="S4.SS0.SSSx2.p2.1" class="ltx_p">To accomplish this, as shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, two deep neural networks with an encoder-decoder (autoencoder) architecture are employed, each tailored to emphasize the salient features from its corresponding modality while suppressing extraneous information. This step addresses the issue of non-relevant features that may exist in the uni-modal data obtained from a pretrained network. By merging these embeddings into an encoded representation, we want to extract and consolidate the pertinent features from each modality, enhancing their combined synergy and informative value in subsequent analyses. This is achieved by training the two hybrid models to generate an encoded latent representation, highlighting the relevant features. Specifically, each autoencoder model is designed to take one modality and reconstruct the other, resulting in a latent representation that embodies the dominant features of its respective modality.</p>
</div>
<div id="S4.SS0.SSSx2.p3" class="ltx_para">
<p id="S4.SS0.SSSx2.p3.5" class="ltx_p">In the first stage (illustrated in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Lines <a href="#alg1.l4" title="In Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>-<a href="#alg1.l9" title="In Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>), an autoencoder denoted as <math id="S4.SS0.SSSx2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{A}_{I}" display="inline"><semantics id="S4.SS0.SSSx2.p3.1.m1.1a"><msub id="S4.SS0.SSSx2.p3.1.m1.1.1" xref="S4.SS0.SSSx2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p3.1.m1.1.1.2" xref="S4.SS0.SSSx2.p3.1.m1.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p3.1.m1.1.1.3" xref="S4.SS0.SSSx2.p3.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p3.1.m1.1b"><apply id="S4.SS0.SSSx2.p3.1.m1.1.1.cmml" xref="S4.SS0.SSSx2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p3.1.m1.1.1.1.cmml" xref="S4.SS0.SSSx2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p3.1.m1.1.1.2.cmml" xref="S4.SS0.SSSx2.p3.1.m1.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p3.1.m1.1.1.3.cmml" xref="S4.SS0.SSSx2.p3.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p3.1.m1.1c">\mathcal{A}_{I}</annotation></semantics></math> is designed, where it takes the histopathology image embedding <span id="S4.SS0.SSSx2.p3.5.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">f</span> as input, and reconstructs the immune cell sequence profile embedding <span id="S4.SS0.SSSx2.p3.5.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">g</span>. During training, <math id="S4.SS0.SSSx2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{A}_{I}" display="inline"><semantics id="S4.SS0.SSSx2.p3.4.m4.1a"><msub id="S4.SS0.SSSx2.p3.4.m4.1.1" xref="S4.SS0.SSSx2.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p3.4.m4.1.1.2" xref="S4.SS0.SSSx2.p3.4.m4.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p3.4.m4.1.1.3" xref="S4.SS0.SSSx2.p3.4.m4.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p3.4.m4.1b"><apply id="S4.SS0.SSSx2.p3.4.m4.1.1.cmml" xref="S4.SS0.SSSx2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p3.4.m4.1.1.1.cmml" xref="S4.SS0.SSSx2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p3.4.m4.1.1.2.cmml" xref="S4.SS0.SSSx2.p3.4.m4.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p3.4.m4.1.1.3.cmml" xref="S4.SS0.SSSx2.p3.4.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p3.4.m4.1c">\mathcal{A}_{I}</annotation></semantics></math> learns to focus on critical features present in histopathology images that offer insights into immune cell sequence patterns. These features are encapsulated within the bottleneck layer, situated just before the first decoder layer of model <math id="S4.SS0.SSSx2.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{A}_{I}" display="inline"><semantics id="S4.SS0.SSSx2.p3.5.m5.1a"><msub id="S4.SS0.SSSx2.p3.5.m5.1.1" xref="S4.SS0.SSSx2.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p3.5.m5.1.1.2" xref="S4.SS0.SSSx2.p3.5.m5.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p3.5.m5.1.1.3" xref="S4.SS0.SSSx2.p3.5.m5.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p3.5.m5.1b"><apply id="S4.SS0.SSSx2.p3.5.m5.1.1.cmml" xref="S4.SS0.SSSx2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p3.5.m5.1.1.1.cmml" xref="S4.SS0.SSSx2.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p3.5.m5.1.1.2.cmml" xref="S4.SS0.SSSx2.p3.5.m5.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p3.5.m5.1.1.3.cmml" xref="S4.SS0.SSSx2.p3.5.m5.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p3.5.m5.1c">\mathcal{A}_{I}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS0.SSSx2.p4" class="ltx_para">
<p id="S4.SS0.SSSx2.p4.4" class="ltx_p">Conversely, in the second stage (described in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Lines <a href="#alg1.l10" title="In Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>-<a href="#alg1.l14" title="In Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>), another autoencoder, denoted as <math id="S4.SS0.SSSx2.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{A}_{S}" display="inline"><semantics id="S4.SS0.SSSx2.p4.1.m1.1a"><msub id="S4.SS0.SSSx2.p4.1.m1.1.1" xref="S4.SS0.SSSx2.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p4.1.m1.1.1.2" xref="S4.SS0.SSSx2.p4.1.m1.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p4.1.m1.1.1.3" xref="S4.SS0.SSSx2.p4.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p4.1.m1.1b"><apply id="S4.SS0.SSSx2.p4.1.m1.1.1.cmml" xref="S4.SS0.SSSx2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p4.1.m1.1.1.1.cmml" xref="S4.SS0.SSSx2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p4.1.m1.1.1.2.cmml" xref="S4.SS0.SSSx2.p4.1.m1.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p4.1.m1.1.1.3.cmml" xref="S4.SS0.SSSx2.p4.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p4.1.m1.1c">\mathcal{A}_{S}</annotation></semantics></math>, is employed, which takes the immune cell sequence profile embedding <span id="S4.SS0.SSSx2.p4.4.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">g</span> as input and reconstructs the histopathology image embedding <span id="S4.SS0.SSSx2.p4.4.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">f</span>. This design empowers the model to emphasize essential characteristics inherent to immune cell sequence data that are relevant to the histopathological context, also embedded within the bottleneck layer of model <math id="S4.SS0.SSSx2.p4.4.m4.1" class="ltx_Math" alttext="\mathcal{A}_{S}" display="inline"><semantics id="S4.SS0.SSSx2.p4.4.m4.1a"><msub id="S4.SS0.SSSx2.p4.4.m4.1.1" xref="S4.SS0.SSSx2.p4.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p4.4.m4.1.1.2" xref="S4.SS0.SSSx2.p4.4.m4.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p4.4.m4.1.1.3" xref="S4.SS0.SSSx2.p4.4.m4.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p4.4.m4.1b"><apply id="S4.SS0.SSSx2.p4.4.m4.1.1.cmml" xref="S4.SS0.SSSx2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p4.4.m4.1.1.1.cmml" xref="S4.SS0.SSSx2.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p4.4.m4.1.1.2.cmml" xref="S4.SS0.SSSx2.p4.4.m4.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p4.4.m4.1.1.3.cmml" xref="S4.SS0.SSSx2.p4.4.m4.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p4.4.m4.1c">\mathcal{A}_{S}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS0.SSSx2.p5" class="ltx_para">
<p id="S4.SS0.SSSx2.p5.4" class="ltx_p">Both hybrid autoencoders <math id="S4.SS0.SSSx2.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{A}_{I}" display="inline"><semantics id="S4.SS0.SSSx2.p5.1.m1.1a"><msub id="S4.SS0.SSSx2.p5.1.m1.1.1" xref="S4.SS0.SSSx2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p5.1.m1.1.1.2" xref="S4.SS0.SSSx2.p5.1.m1.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p5.1.m1.1.1.3" xref="S4.SS0.SSSx2.p5.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p5.1.m1.1b"><apply id="S4.SS0.SSSx2.p5.1.m1.1.1.cmml" xref="S4.SS0.SSSx2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p5.1.m1.1.1.1.cmml" xref="S4.SS0.SSSx2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p5.1.m1.1.1.2.cmml" xref="S4.SS0.SSSx2.p5.1.m1.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p5.1.m1.1.1.3.cmml" xref="S4.SS0.SSSx2.p5.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p5.1.m1.1c">\mathcal{A}_{I}</annotation></semantics></math> and <math id="S4.SS0.SSSx2.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{A}_{S}" display="inline"><semantics id="S4.SS0.SSSx2.p5.2.m2.1a"><msub id="S4.SS0.SSSx2.p5.2.m2.1.1" xref="S4.SS0.SSSx2.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p5.2.m2.1.1.2" xref="S4.SS0.SSSx2.p5.2.m2.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p5.2.m2.1.1.3" xref="S4.SS0.SSSx2.p5.2.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p5.2.m2.1b"><apply id="S4.SS0.SSSx2.p5.2.m2.1.1.cmml" xref="S4.SS0.SSSx2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p5.2.m2.1.1.1.cmml" xref="S4.SS0.SSSx2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p5.2.m2.1.1.2.cmml" xref="S4.SS0.SSSx2.p5.2.m2.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p5.2.m2.1.1.3.cmml" xref="S4.SS0.SSSx2.p5.2.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p5.2.m2.1c">\mathcal{A}_{S}</annotation></semantics></math> comprised an encoder with two dense layers of size 512 and 256, followed by a bottleneck layer of size 128, and finally, a decoder with two dense layers of size 256 and 512. All autoencoders were trained using the Adam optimizer and mean square error (MSE) as the loss function. The image-genomics autoencoder was trained for 150 epochs with a learning rate of <math id="S4.SS0.SSSx2.p5.3.m3.1" class="ltx_Math" alttext="1\times 10^{-5}" display="inline"><semantics id="S4.SS0.SSSx2.p5.3.m3.1a"><mrow id="S4.SS0.SSSx2.p5.3.m3.1.1" xref="S4.SS0.SSSx2.p5.3.m3.1.1.cmml"><mn id="S4.SS0.SSSx2.p5.3.m3.1.1.2" xref="S4.SS0.SSSx2.p5.3.m3.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx2.p5.3.m3.1.1.1" xref="S4.SS0.SSSx2.p5.3.m3.1.1.1.cmml">×</mo><msup id="S4.SS0.SSSx2.p5.3.m3.1.1.3" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.cmml"><mn id="S4.SS0.SSSx2.p5.3.m3.1.1.3.2" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.2.cmml">10</mn><mrow id="S4.SS0.SSSx2.p5.3.m3.1.1.3.3" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.cmml"><mo id="S4.SS0.SSSx2.p5.3.m3.1.1.3.3a" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.2" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p5.3.m3.1b"><apply id="S4.SS0.SSSx2.p5.3.m3.1.1.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1"><times id="S4.SS0.SSSx2.p5.3.m3.1.1.1.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.1"></times><cn type="integer" id="S4.SS0.SSSx2.p5.3.m3.1.1.2.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.2">1</cn><apply id="S4.SS0.SSSx2.p5.3.m3.1.1.3.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p5.3.m3.1.1.3.1.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS0.SSSx2.p5.3.m3.1.1.3.2.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.2">10</cn><apply id="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.3"><minus id="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.1.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.3"></minus><cn type="integer" id="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.2.cmml" xref="S4.SS0.SSSx2.p5.3.m3.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p5.3.m3.1c">1\times 10^{-5}</annotation></semantics></math>, while the genomics-image autoencoder was trained for 50 epochs with a learning rate of <math id="S4.SS0.SSSx2.p5.4.m4.1" class="ltx_Math" alttext="1\times 10^{-4}" display="inline"><semantics id="S4.SS0.SSSx2.p5.4.m4.1a"><mrow id="S4.SS0.SSSx2.p5.4.m4.1.1" xref="S4.SS0.SSSx2.p5.4.m4.1.1.cmml"><mn id="S4.SS0.SSSx2.p5.4.m4.1.1.2" xref="S4.SS0.SSSx2.p5.4.m4.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx2.p5.4.m4.1.1.1" xref="S4.SS0.SSSx2.p5.4.m4.1.1.1.cmml">×</mo><msup id="S4.SS0.SSSx2.p5.4.m4.1.1.3" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.cmml"><mn id="S4.SS0.SSSx2.p5.4.m4.1.1.3.2" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS0.SSSx2.p5.4.m4.1.1.3.3" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.cmml"><mo id="S4.SS0.SSSx2.p5.4.m4.1.1.3.3a" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.2" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p5.4.m4.1b"><apply id="S4.SS0.SSSx2.p5.4.m4.1.1.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1"><times id="S4.SS0.SSSx2.p5.4.m4.1.1.1.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.1"></times><cn type="integer" id="S4.SS0.SSSx2.p5.4.m4.1.1.2.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.2">1</cn><apply id="S4.SS0.SSSx2.p5.4.m4.1.1.3.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p5.4.m4.1.1.3.1.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS0.SSSx2.p5.4.m4.1.1.3.2.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.2">10</cn><apply id="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.3"><minus id="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.1.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.3"></minus><cn type="integer" id="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.2.cmml" xref="S4.SS0.SSSx2.p5.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p5.4.m4.1c">1\times 10^{-4}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS0.SSSx2.p6" class="ltx_para">
<p id="S4.SS0.SSSx2.p6.8" class="ltx_p">Following the training of <math id="S4.SS0.SSSx2.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{A}_{I}" display="inline"><semantics id="S4.SS0.SSSx2.p6.1.m1.1a"><msub id="S4.SS0.SSSx2.p6.1.m1.1.1" xref="S4.SS0.SSSx2.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p6.1.m1.1.1.2" xref="S4.SS0.SSSx2.p6.1.m1.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p6.1.m1.1.1.3" xref="S4.SS0.SSSx2.p6.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p6.1.m1.1b"><apply id="S4.SS0.SSSx2.p6.1.m1.1.1.cmml" xref="S4.SS0.SSSx2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p6.1.m1.1.1.1.cmml" xref="S4.SS0.SSSx2.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p6.1.m1.1.1.2.cmml" xref="S4.SS0.SSSx2.p6.1.m1.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p6.1.m1.1.1.3.cmml" xref="S4.SS0.SSSx2.p6.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p6.1.m1.1c">\mathcal{A}_{I}</annotation></semantics></math> and <math id="S4.SS0.SSSx2.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{A}_{S}" display="inline"><semantics id="S4.SS0.SSSx2.p6.2.m2.1a"><msub id="S4.SS0.SSSx2.p6.2.m2.1.1" xref="S4.SS0.SSSx2.p6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p6.2.m2.1.1.2" xref="S4.SS0.SSSx2.p6.2.m2.1.1.2.cmml">𝒜</mi><mi id="S4.SS0.SSSx2.p6.2.m2.1.1.3" xref="S4.SS0.SSSx2.p6.2.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p6.2.m2.1b"><apply id="S4.SS0.SSSx2.p6.2.m2.1.1.cmml" xref="S4.SS0.SSSx2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p6.2.m2.1.1.1.cmml" xref="S4.SS0.SSSx2.p6.2.m2.1.1">subscript</csymbol><ci id="S4.SS0.SSSx2.p6.2.m2.1.1.2.cmml" xref="S4.SS0.SSSx2.p6.2.m2.1.1.2">𝒜</ci><ci id="S4.SS0.SSSx2.p6.2.m2.1.1.3.cmml" xref="S4.SS0.SSSx2.p6.2.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p6.2.m2.1c">\mathcal{A}_{S}</annotation></semantics></math>, the encoder from each hybrid autoencoder is employed to generate an encoded latent for each sample, resulting in two encoded vectors: image features-enriched latent and genomic features-enriched latent (Algorithm <a href="#alg1" title="Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Lines <a href="#alg1.l15" title="In Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>-<a href="#alg1.l20" title="In Algorithm 1 ‣ Unimodal Transformation ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">20</span></a>). For instance, <span id="S4.SS0.SSSx2.p6.8.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span>, characterized by a strong emphasis on histopathological features, is derived through the application of <math id="S4.SS0.SSSx2.p6.4.m4.1" class="ltx_Math" alttext="\textbf{{u}}=\mathcal{E}_{I}(\textbf{{f}})" display="inline"><semantics id="S4.SS0.SSSx2.p6.4.m4.1a"><mrow id="S4.SS0.SSSx2.p6.4.m4.1.2" xref="S4.SS0.SSSx2.p6.4.m4.1.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.4.m4.1.2.2" xref="S4.SS0.SSSx2.p6.4.m4.1.2.2a.cmml">u</mtext><mo id="S4.SS0.SSSx2.p6.4.m4.1.2.1" xref="S4.SS0.SSSx2.p6.4.m4.1.2.1.cmml">=</mo><mrow id="S4.SS0.SSSx2.p6.4.m4.1.2.3" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.cmml"><msub id="S4.SS0.SSSx2.p6.4.m4.1.2.3.2" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.2" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.2.cmml">ℰ</mi><mi id="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.3" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.3.cmml">I</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx2.p6.4.m4.1.2.3.1" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.1.cmml">​</mo><mrow id="S4.SS0.SSSx2.p6.4.m4.1.2.3.3.2" xref="S4.SS0.SSSx2.p6.4.m4.1.1a.cmml"><mo stretchy="false" id="S4.SS0.SSSx2.p6.4.m4.1.2.3.3.2.1" xref="S4.SS0.SSSx2.p6.4.m4.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.4.m4.1.1" xref="S4.SS0.SSSx2.p6.4.m4.1.1.cmml">f</mtext><mo stretchy="false" id="S4.SS0.SSSx2.p6.4.m4.1.2.3.3.2.2" xref="S4.SS0.SSSx2.p6.4.m4.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p6.4.m4.1b"><apply id="S4.SS0.SSSx2.p6.4.m4.1.2.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2"><eq id="S4.SS0.SSSx2.p6.4.m4.1.2.1.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.1"></eq><ci id="S4.SS0.SSSx2.p6.4.m4.1.2.2a.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.4.m4.1.2.2.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.2">u</mtext></ci><apply id="S4.SS0.SSSx2.p6.4.m4.1.2.3.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3"><times id="S4.SS0.SSSx2.p6.4.m4.1.2.3.1.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.1"></times><apply id="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.1.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.2">subscript</csymbol><ci id="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.2.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.2">ℰ</ci><ci id="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.3.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.2.3">𝐼</ci></apply><ci id="S4.SS0.SSSx2.p6.4.m4.1.1a.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.2.3.3.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.4.m4.1.1.cmml" xref="S4.SS0.SSSx2.p6.4.m4.1.1">f</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p6.4.m4.1c">\textbf{{u}}=\mathcal{E}_{I}(\textbf{{f}})</annotation></semantics></math>, where <math id="S4.SS0.SSSx2.p6.5.m5.1" class="ltx_Math" alttext="\textbf{{u}}\in\mathbb{R}^{l\times 1}" display="inline"><semantics id="S4.SS0.SSSx2.p6.5.m5.1a"><mrow id="S4.SS0.SSSx2.p6.5.m5.1.1" xref="S4.SS0.SSSx2.p6.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.5.m5.1.1.2" xref="S4.SS0.SSSx2.p6.5.m5.1.1.2a.cmml">u</mtext><mo id="S4.SS0.SSSx2.p6.5.m5.1.1.1" xref="S4.SS0.SSSx2.p6.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS0.SSSx2.p6.5.m5.1.1.3" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.cmml"><mi id="S4.SS0.SSSx2.p6.5.m5.1.1.3.2" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.cmml"><mi id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.2" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.1" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.1.cmml">×</mo><mn id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.3" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p6.5.m5.1b"><apply id="S4.SS0.SSSx2.p6.5.m5.1.1.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1"><in id="S4.SS0.SSSx2.p6.5.m5.1.1.1.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.1"></in><ci id="S4.SS0.SSSx2.p6.5.m5.1.1.2a.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.5.m5.1.1.2.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.2">u</mtext></ci><apply id="S4.SS0.SSSx2.p6.5.m5.1.1.3.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p6.5.m5.1.1.3.1.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS0.SSSx2.p6.5.m5.1.1.3.2.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3"><times id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.1.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.1"></times><ci id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.2.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.3.cmml" xref="S4.SS0.SSSx2.p6.5.m5.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p6.5.m5.1c">\textbf{{u}}\in\mathbb{R}^{l\times 1}</annotation></semantics></math>. Likewise, <span id="S4.SS0.SSSx2.p6.8.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span>, accentuating immune cell characteristics, is derived as <math id="S4.SS0.SSSx2.p6.7.m7.1" class="ltx_Math" alttext="\textbf{{v}}=\mathcal{E}_{S}(\textbf{{g}})" display="inline"><semantics id="S4.SS0.SSSx2.p6.7.m7.1a"><mrow id="S4.SS0.SSSx2.p6.7.m7.1.2" xref="S4.SS0.SSSx2.p6.7.m7.1.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.7.m7.1.2.2" xref="S4.SS0.SSSx2.p6.7.m7.1.2.2a.cmml">v</mtext><mo id="S4.SS0.SSSx2.p6.7.m7.1.2.1" xref="S4.SS0.SSSx2.p6.7.m7.1.2.1.cmml">=</mo><mrow id="S4.SS0.SSSx2.p6.7.m7.1.2.3" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.cmml"><msub id="S4.SS0.SSSx2.p6.7.m7.1.2.3.2" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.2" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.2.cmml">ℰ</mi><mi id="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.3" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx2.p6.7.m7.1.2.3.1" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.1.cmml">​</mo><mrow id="S4.SS0.SSSx2.p6.7.m7.1.2.3.3.2" xref="S4.SS0.SSSx2.p6.7.m7.1.1a.cmml"><mo stretchy="false" id="S4.SS0.SSSx2.p6.7.m7.1.2.3.3.2.1" xref="S4.SS0.SSSx2.p6.7.m7.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.7.m7.1.1" xref="S4.SS0.SSSx2.p6.7.m7.1.1.cmml">g</mtext><mo stretchy="false" id="S4.SS0.SSSx2.p6.7.m7.1.2.3.3.2.2" xref="S4.SS0.SSSx2.p6.7.m7.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p6.7.m7.1b"><apply id="S4.SS0.SSSx2.p6.7.m7.1.2.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2"><eq id="S4.SS0.SSSx2.p6.7.m7.1.2.1.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.1"></eq><ci id="S4.SS0.SSSx2.p6.7.m7.1.2.2a.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.7.m7.1.2.2.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.2">v</mtext></ci><apply id="S4.SS0.SSSx2.p6.7.m7.1.2.3.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3"><times id="S4.SS0.SSSx2.p6.7.m7.1.2.3.1.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.1"></times><apply id="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.1.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.2">subscript</csymbol><ci id="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.2.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.2">ℰ</ci><ci id="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.3.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.2.3">𝑆</ci></apply><ci id="S4.SS0.SSSx2.p6.7.m7.1.1a.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.2.3.3.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.7.m7.1.1.cmml" xref="S4.SS0.SSSx2.p6.7.m7.1.1">g</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p6.7.m7.1c">\textbf{{v}}=\mathcal{E}_{S}(\textbf{{g}})</annotation></semantics></math>, where <math id="S4.SS0.SSSx2.p6.8.m8.1" class="ltx_Math" alttext="\textbf{{v}}\in\mathbb{R}^{l\times 1}" display="inline"><semantics id="S4.SS0.SSSx2.p6.8.m8.1a"><mrow id="S4.SS0.SSSx2.p6.8.m8.1.1" xref="S4.SS0.SSSx2.p6.8.m8.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.8.m8.1.1.2" xref="S4.SS0.SSSx2.p6.8.m8.1.1.2a.cmml">v</mtext><mo id="S4.SS0.SSSx2.p6.8.m8.1.1.1" xref="S4.SS0.SSSx2.p6.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS0.SSSx2.p6.8.m8.1.1.3" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.cmml"><mi id="S4.SS0.SSSx2.p6.8.m8.1.1.3.2" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.cmml"><mi id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.2" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.2.cmml">l</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.1" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.1.cmml">×</mo><mn id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.3" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx2.p6.8.m8.1b"><apply id="S4.SS0.SSSx2.p6.8.m8.1.1.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1"><in id="S4.SS0.SSSx2.p6.8.m8.1.1.1.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.1"></in><ci id="S4.SS0.SSSx2.p6.8.m8.1.1.2a.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx2.p6.8.m8.1.1.2.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.2">v</mtext></ci><apply id="S4.SS0.SSSx2.p6.8.m8.1.1.3.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx2.p6.8.m8.1.1.3.1.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS0.SSSx2.p6.8.m8.1.1.3.2.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.2">ℝ</ci><apply id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3"><times id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.1.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.1"></times><ci id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.2.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.3.cmml" xref="S4.SS0.SSSx2.p6.8.m8.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx2.p6.8.m8.1c">\textbf{{v}}\in\mathbb{R}^{l\times 1}</annotation></semantics></math>. The resulting compact representation (size 128) not only reduces dimensionality but also encapsulates critical aspects of both modalities. This representation serves as a powerful encoding of joint information extracted from histopathology images and immune cell sequences, facilitating profound integration in the subsequent phase.</p>
</div>
</section>
<section id="S4.SS0.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">MarbliX Monogram</h4>

<div id="S4.SS0.SSSx3.p1" class="ltx_para">
<p id="S4.SS0.SSSx3.p1.4" class="ltx_p">After generating the two latent representations <span id="S4.SS0.SSSx3.p1.4.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span> and <span id="S4.SS0.SSSx3.p1.4.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span>, the next crucial step within the MarbliX framework is the projection and indexing of these representations into a 2D binary matrix, referred to as “monogram.” This matrix serves as an effective representation for capturing the intricate relationships and correlations that exist between the two modalities. The process of learning the <em id="S4.SS0.SSSx3.p1.4.3" class="ltx_emph ltx_font_italic">monogram</em> representation is the core of the MarbliX framework, enabling a comprehensive exploration of the joint information encoded within <span id="S4.SS0.SSSx3.p1.4.4" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span> and <span id="S4.SS0.SSSx3.p1.4.5" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span>.</p>
</div>
<div id="S4.SS0.SSSx3.p2" class="ltx_para">
<p id="S4.SS0.SSSx3.p2.1" class="ltx_p">To accomplish this task, a deep neural network, denoted as <math id="S4.SS0.SSSx3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S4.SS0.SSSx3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx3.p2.1.m1.1.1" xref="S4.SS0.SSSx3.p2.1.m1.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p2.1.m1.1b"><ci id="S4.SS0.SSSx3.p2.1.m1.1.1.cmml" xref="S4.SS0.SSSx3.p2.1.m1.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p2.1.m1.1c">\mathcal{Q}</annotation></semantics></math>, is designed to uncover the correlations between histopathology and immunogenomic features based on diagnosis. This process aims to unveil the underlying structure that interlinks histopathological characteristics with immune cell behavior among cases within the same diagnostic class. In other words, the model is engineered to capture the commonality in multimodal relationships among cases that share similar diagnoses, embedding these features within their respective <em id="S4.SS0.SSSx3.p2.1.1" class="ltx_emph ltx_font_italic">monograms</em>. Simultaneously, it strives to discern the distinctions between cases of different diagnostic classes and accentuate these disparities within their corresponding monograms. This is achieved by employing self-supervised training using triplet loss to minimize the distance between patients with the same primary diagnosis and maximize the distance between patients with different primary diagnoses.</p>
</div>
<div id="S4.SS0.SSSx3.p3" class="ltx_para">
<p id="S4.SS0.SSSx3.p3.7" class="ltx_p">As described in Algorithm <a href="#alg2" title="Algorithm 2 ‣ MarbliX Monogram ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, The <math id="S4.SS0.SSSx3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S4.SS0.SSSx3.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx3.p3.1.m1.1.1" xref="S4.SS0.SSSx3.p3.1.m1.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p3.1.m1.1b"><ci id="S4.SS0.SSSx3.p3.1.m1.1.1.cmml" xref="S4.SS0.SSSx3.p3.1.m1.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p3.1.m1.1c">\mathcal{Q}</annotation></semantics></math> model comprises three branches with shared weights, each taking a pair of latent representations, <span id="S4.SS0.SSSx3.p3.7.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span> and <span id="S4.SS0.SSSx3.p3.7.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span>. Thus, the model is provided with triplet pairs as input <math id="S4.SS0.SSSx3.p3.4.m4.5" class="ltx_Math" alttext="\mathcal{Q}(\{\textbf{{u}},\textbf{{v}}\},\{\textbf{{u}}^{+},\textbf{{v}}^{+}\},\{\textbf{{u}}^{-},\textbf{{v}}^{-}\})" display="inline"><semantics id="S4.SS0.SSSx3.p3.4.m4.5a"><mrow id="S4.SS0.SSSx3.p3.4.m4.5.5" xref="S4.SS0.SSSx3.p3.4.m4.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx3.p3.4.m4.5.5.5" xref="S4.SS0.SSSx3.p3.4.m4.5.5.5.cmml">𝒬</mi><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx3.p3.4.m4.5.5.4" xref="S4.SS0.SSSx3.p3.4.m4.5.5.4.cmml">​</mo><mrow id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.4.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.4" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.4.cmml">(</mo><mrow id="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.2" xref="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.2.1" xref="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.1.cmml">{</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.1.1" xref="S4.SS0.SSSx3.p3.4.m4.1.1a.cmml">u</mtext><mo id="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.2.2" xref="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.2.2" xref="S4.SS0.SSSx3.p3.4.m4.2.2a.cmml">v</mtext><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.2.3" xref="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.1.cmml">}</mo></mrow><mo id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.5" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.4.cmml">,</mo><mrow id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.3" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.3.cmml">{</mo><msup id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.2" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.2a.cmml">u</mtext><mo id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.3" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.3.cmml">+</mo></msup><mo id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.4" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.3.cmml">,</mo><msup id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.2" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.2a.cmml">v</mtext><mo id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.3" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.3.cmml">+</mo></msup><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.5" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.3.cmml">}</mo></mrow><mo id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.6" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.4.cmml">,</mo><mrow id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.3.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.3" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.3.cmml">{</mo><msup id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.2" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.2a.cmml">u</mtext><mo id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.3" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.3.cmml">−</mo></msup><mo id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.4" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.3.cmml">,</mo><msup id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.2" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.2a.cmml">v</mtext><mo id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.3" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.3.cmml">−</mo></msup><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.5" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.3.cmml">}</mo></mrow><mo stretchy="false" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.7" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p3.4.m4.5b"><apply id="S4.SS0.SSSx3.p3.4.m4.5.5.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5"><times id="S4.SS0.SSSx3.p3.4.m4.5.5.4.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.4"></times><ci id="S4.SS0.SSSx3.p3.4.m4.5.5.5.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.5">𝒬</ci><vector id="S4.SS0.SSSx3.p3.4.m4.5.5.3.4.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3"><set id="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.3.3.1.1.1.2"><ci id="S4.SS0.SSSx3.p3.4.m4.1.1a.cmml" xref="S4.SS0.SSSx3.p3.4.m4.1.1"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.1.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.1.1">u</mtext></ci><ci id="S4.SS0.SSSx3.p3.4.m4.2.2a.cmml" xref="S4.SS0.SSSx3.p3.4.m4.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.2.2.cmml" xref="S4.SS0.SSSx3.p3.4.m4.2.2">v</mtext></ci></set><set id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.3.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2"><apply id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.2a.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.2.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.2">u</mtext></ci><plus id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.3.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.1.1.3"></plus></apply><apply id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.2a.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.2.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.2">v</mtext></ci><plus id="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.3.cmml" xref="S4.SS0.SSSx3.p3.4.m4.4.4.2.2.2.2.2.3"></plus></apply></set><set id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.3.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2"><apply id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.2a.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.2.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.2">u</mtext></ci><minus id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.3.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.1.1.3"></minus></apply><apply id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.1.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.2a.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.2.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.2">v</mtext></ci><minus id="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.3.cmml" xref="S4.SS0.SSSx3.p3.4.m4.5.5.3.3.3.2.2.3"></minus></apply></set></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p3.4.m4.5c">\mathcal{Q}(\{\textbf{{u}},\textbf{{v}}\},\{\textbf{{u}}^{+},\textbf{{v}}^{+}\},\{\textbf{{u}}^{-},\textbf{{v}}^{-}\})</annotation></semantics></math>, consisting of an anchor pair <math id="S4.SS0.SSSx3.p3.5.m5.2" class="ltx_Math" alttext="(\textbf{{u}},\textbf{{v}})" display="inline"><semantics id="S4.SS0.SSSx3.p3.5.m5.2a"><mrow id="S4.SS0.SSSx3.p3.5.m5.2.3.2" xref="S4.SS0.SSSx3.p3.5.m5.2.3.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p3.5.m5.2.3.2.1" xref="S4.SS0.SSSx3.p3.5.m5.2.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.5.m5.1.1" xref="S4.SS0.SSSx3.p3.5.m5.1.1a.cmml">u</mtext><mo id="S4.SS0.SSSx3.p3.5.m5.2.3.2.2" xref="S4.SS0.SSSx3.p3.5.m5.2.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.5.m5.2.2" xref="S4.SS0.SSSx3.p3.5.m5.2.2a.cmml">v</mtext><mo stretchy="false" id="S4.SS0.SSSx3.p3.5.m5.2.3.2.3" xref="S4.SS0.SSSx3.p3.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p3.5.m5.2b"><interval closure="open" id="S4.SS0.SSSx3.p3.5.m5.2.3.1.cmml" xref="S4.SS0.SSSx3.p3.5.m5.2.3.2"><ci id="S4.SS0.SSSx3.p3.5.m5.1.1a.cmml" xref="S4.SS0.SSSx3.p3.5.m5.1.1"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.5.m5.1.1.cmml" xref="S4.SS0.SSSx3.p3.5.m5.1.1">u</mtext></ci><ci id="S4.SS0.SSSx3.p3.5.m5.2.2a.cmml" xref="S4.SS0.SSSx3.p3.5.m5.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.5.m5.2.2.cmml" xref="S4.SS0.SSSx3.p3.5.m5.2.2">v</mtext></ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p3.5.m5.2c">(\textbf{{u}},\textbf{{v}})</annotation></semantics></math>, a positive pair <math id="S4.SS0.SSSx3.p3.6.m6.2" class="ltx_Math" alttext="(\textbf{{u}}^{+},\textbf{{v}}^{+})" display="inline"><semantics id="S4.SS0.SSSx3.p3.6.m6.2a"><mrow id="S4.SS0.SSSx3.p3.6.m6.2.2.2" xref="S4.SS0.SSSx3.p3.6.m6.2.2.3.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p3.6.m6.2.2.2.3" xref="S4.SS0.SSSx3.p3.6.m6.2.2.3.cmml">(</mo><msup id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.2" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.2a.cmml">u</mtext><mo id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.3" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.3.cmml">+</mo></msup><mo id="S4.SS0.SSSx3.p3.6.m6.2.2.2.4" xref="S4.SS0.SSSx3.p3.6.m6.2.2.3.cmml">,</mo><msup id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.2" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.2a.cmml">v</mtext><mo id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.3" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.3.cmml">+</mo></msup><mo stretchy="false" id="S4.SS0.SSSx3.p3.6.m6.2.2.2.5" xref="S4.SS0.SSSx3.p3.6.m6.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p3.6.m6.2b"><interval closure="open" id="S4.SS0.SSSx3.p3.6.m6.2.2.3.cmml" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2"><apply id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.cmml" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.1.cmml" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.2a.cmml" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.2.cmml" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.2">u</mtext></ci><plus id="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.3.cmml" xref="S4.SS0.SSSx3.p3.6.m6.1.1.1.1.3"></plus></apply><apply id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.cmml" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.1.cmml" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.2a.cmml" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.2.cmml" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.2">v</mtext></ci><plus id="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.3.cmml" xref="S4.SS0.SSSx3.p3.6.m6.2.2.2.2.3"></plus></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p3.6.m6.2c">(\textbf{{u}}^{+},\textbf{{v}}^{+})</annotation></semantics></math>, and a negative pair <math id="S4.SS0.SSSx3.p3.7.m7.2" class="ltx_Math" alttext="(\textbf{{u}}^{-},\textbf{{v}}^{-})" display="inline"><semantics id="S4.SS0.SSSx3.p3.7.m7.2a"><mrow id="S4.SS0.SSSx3.p3.7.m7.2.2.2" xref="S4.SS0.SSSx3.p3.7.m7.2.2.3.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p3.7.m7.2.2.2.3" xref="S4.SS0.SSSx3.p3.7.m7.2.2.3.cmml">(</mo><msup id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.2" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.2a.cmml">u</mtext><mo id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.3" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.3.cmml">−</mo></msup><mo id="S4.SS0.SSSx3.p3.7.m7.2.2.2.4" xref="S4.SS0.SSSx3.p3.7.m7.2.2.3.cmml">,</mo><msup id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.2" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.2a.cmml">v</mtext><mo id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.3" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.3.cmml">−</mo></msup><mo stretchy="false" id="S4.SS0.SSSx3.p3.7.m7.2.2.2.5" xref="S4.SS0.SSSx3.p3.7.m7.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p3.7.m7.2b"><interval closure="open" id="S4.SS0.SSSx3.p3.7.m7.2.2.3.cmml" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2"><apply id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.cmml" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.1.cmml" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.2a.cmml" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.2.cmml" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.2">u</mtext></ci><minus id="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.3.cmml" xref="S4.SS0.SSSx3.p3.7.m7.1.1.1.1.3"></minus></apply><apply id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.cmml" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.1.cmml" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2">superscript</csymbol><ci id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.2a.cmml" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.2.cmml" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.2">v</mtext></ci><minus id="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.3.cmml" xref="S4.SS0.SSSx3.p3.7.m7.2.2.2.2.3"></minus></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p3.7.m7.2c">(\textbf{{u}}^{-},\textbf{{v}}^{-})</annotation></semantics></math>. The anchor case serves as the reference for which the model endeavors to generate a representative monogram. The positive case shares the same diagnosis as the anchor, reinforcing common features. In contrast, the negative case differs in diagnosis from the anchor, shedding light on the discrepancies between diagnostic classes. The positive and negative samples were selected for each anchor sample by calculating pairwise Euclidean distances and identifying the farthest positive sample and the closest negative sample for each anchor. This approach was implemented to ensure robust training by introducing hard triplets to the model, guiding toward learning the similarities between samples belonging to the same class, despite eventual dissimilarity between them. Analogously, this approach guides the model to generate different representations for cases that share common features in their data but belong to different classes.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Learning Multimodal Monogram Representation</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg2.l1.2" class="ltx_text ltx_font_bold">Input:</span>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span> <span id="alg2.l2.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span>: image latent representation

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span> <span id="alg2.l3.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span>: sequencing latent representation

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg2.l4.2" class="ltx_text ltx_font_bold">Training Stage:</span>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span> Initialize <math id="alg2.l5.m1.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="alg2.l5.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\mathcal{Q}</annotation></semantics></math> model with three branches <math id="alg2.l5.m2.1" class="ltx_Math" alttext="\mathcal{T}_{1}" display="inline"><semantics id="alg2.l5.m2.1a"><msub id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">𝒯</mi><mn id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1">subscript</csymbol><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝒯</ci><cn type="integer" id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\mathcal{T}_{1}</annotation></semantics></math>, <math id="alg2.l5.m3.1" class="ltx_Math" alttext="\mathcal{T}_{2}" display="inline"><semantics id="alg2.l5.m3.1a"><msub id="alg2.l5.m3.1.1" xref="alg2.l5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m3.1.1.2" xref="alg2.l5.m3.1.1.2.cmml">𝒯</mi><mn id="alg2.l5.m3.1.1.3" xref="alg2.l5.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m3.1b"><apply id="alg2.l5.m3.1.1.cmml" xref="alg2.l5.m3.1.1"><csymbol cd="ambiguous" id="alg2.l5.m3.1.1.1.cmml" xref="alg2.l5.m3.1.1">subscript</csymbol><ci id="alg2.l5.m3.1.1.2.cmml" xref="alg2.l5.m3.1.1.2">𝒯</ci><cn type="integer" id="alg2.l5.m3.1.1.3.cmml" xref="alg2.l5.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m3.1c">\mathcal{T}_{2}</annotation></semantics></math>, <math id="alg2.l5.m4.1" class="ltx_Math" alttext="\mathcal{T}_{3}" display="inline"><semantics id="alg2.l5.m4.1a"><msub id="alg2.l5.m4.1.1" xref="alg2.l5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m4.1.1.2" xref="alg2.l5.m4.1.1.2.cmml">𝒯</mi><mn id="alg2.l5.m4.1.1.3" xref="alg2.l5.m4.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m4.1b"><apply id="alg2.l5.m4.1.1.cmml" xref="alg2.l5.m4.1.1"><csymbol cd="ambiguous" id="alg2.l5.m4.1.1.1.cmml" xref="alg2.l5.m4.1.1">subscript</csymbol><ci id="alg2.l5.m4.1.1.2.cmml" xref="alg2.l5.m4.1.1.2">𝒯</ci><cn type="integer" id="alg2.l5.m4.1.1.3.cmml" xref="alg2.l5.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m4.1c">\mathcal{T}_{3}</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span> <math id="alg2.l6.m1.1" class="ltx_Math" alttext="\mathcal{T}_{1}" display="inline"><semantics id="alg2.l6.m1.1a"><msub id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">𝒯</mi><mn id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">𝒯</ci><cn type="integer" id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\mathcal{T}_{1}</annotation></semantics></math>, <math id="alg2.l6.m2.1" class="ltx_Math" alttext="\mathcal{T}_{2}" display="inline"><semantics id="alg2.l6.m2.1a"><msub id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2.cmml">𝒯</mi><mn id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1">subscript</csymbol><ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">𝒯</ci><cn type="integer" id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\mathcal{T}_{2}</annotation></semantics></math>, <math id="alg2.l6.m3.1" class="ltx_Math" alttext="\mathcal{T}_{3}\leftarrow\text{shared weights}" display="inline"><semantics id="alg2.l6.m3.1a"><mrow id="alg2.l6.m3.1.1" xref="alg2.l6.m3.1.1.cmml"><msub id="alg2.l6.m3.1.1.2" xref="alg2.l6.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m3.1.1.2.2" xref="alg2.l6.m3.1.1.2.2.cmml">𝒯</mi><mn id="alg2.l6.m3.1.1.2.3" xref="alg2.l6.m3.1.1.2.3.cmml">3</mn></msub><mo stretchy="false" id="alg2.l6.m3.1.1.1" xref="alg2.l6.m3.1.1.1.cmml">←</mo><mtext id="alg2.l6.m3.1.1.3" xref="alg2.l6.m3.1.1.3a.cmml">shared weights</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><apply id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1"><ci id="alg2.l6.m3.1.1.1.cmml" xref="alg2.l6.m3.1.1.1">←</ci><apply id="alg2.l6.m3.1.1.2.cmml" xref="alg2.l6.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m3.1.1.2.1.cmml" xref="alg2.l6.m3.1.1.2">subscript</csymbol><ci id="alg2.l6.m3.1.1.2.2.cmml" xref="alg2.l6.m3.1.1.2.2">𝒯</ci><cn type="integer" id="alg2.l6.m3.1.1.2.3.cmml" xref="alg2.l6.m3.1.1.2.3">3</cn></apply><ci id="alg2.l6.m3.1.1.3a.cmml" xref="alg2.l6.m3.1.1.3"><mtext id="alg2.l6.m3.1.1.3.cmml" xref="alg2.l6.m3.1.1.3">shared weights</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">\mathcal{T}_{3}\leftarrow\text{shared weights}</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span> <span id="alg2.l7.2" class="ltx_text ltx_font_bold">for each triplet</span> <math id="alg2.l7.m1.2" class="ltx_Math" alttext="\mathcal{T}_{1}(\textbf{{u}},\textbf{{v}})" display="inline"><semantics id="alg2.l7.m1.2a"><mrow id="alg2.l7.m1.2.3" xref="alg2.l7.m1.2.3.cmml"><msub id="alg2.l7.m1.2.3.2" xref="alg2.l7.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.2.3.2.2" xref="alg2.l7.m1.2.3.2.2.cmml">𝒯</mi><mn id="alg2.l7.m1.2.3.2.3" xref="alg2.l7.m1.2.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.3.1" xref="alg2.l7.m1.2.3.1.cmml">​</mo><mrow id="alg2.l7.m1.2.3.3.2" xref="alg2.l7.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg2.l7.m1.2.3.3.2.1" xref="alg2.l7.m1.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1a.cmml">u</mtext><mo id="alg2.l7.m1.2.3.3.2.2" xref="alg2.l7.m1.2.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m1.2.2" xref="alg2.l7.m1.2.2a.cmml">v</mtext><mo stretchy="false" id="alg2.l7.m1.2.3.3.2.3" xref="alg2.l7.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.2b"><apply id="alg2.l7.m1.2.3.cmml" xref="alg2.l7.m1.2.3"><times id="alg2.l7.m1.2.3.1.cmml" xref="alg2.l7.m1.2.3.1"></times><apply id="alg2.l7.m1.2.3.2.cmml" xref="alg2.l7.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l7.m1.2.3.2.1.cmml" xref="alg2.l7.m1.2.3.2">subscript</csymbol><ci id="alg2.l7.m1.2.3.2.2.cmml" xref="alg2.l7.m1.2.3.2.2">𝒯</ci><cn type="integer" id="alg2.l7.m1.2.3.2.3.cmml" xref="alg2.l7.m1.2.3.2.3">1</cn></apply><interval closure="open" id="alg2.l7.m1.2.3.3.1.cmml" xref="alg2.l7.m1.2.3.3.2"><ci id="alg2.l7.m1.1.1a.cmml" xref="alg2.l7.m1.1.1"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">u</mtext></ci><ci id="alg2.l7.m1.2.2a.cmml" xref="alg2.l7.m1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m1.2.2.cmml" xref="alg2.l7.m1.2.2">v</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.2c">\mathcal{T}_{1}(\textbf{{u}},\textbf{{v}})</annotation></semantics></math>, <math id="alg2.l7.m2.2" class="ltx_Math" alttext="\mathcal{T}_{2}(\textbf{{u}}^{+},\textbf{{v}}^{+})" display="inline"><semantics id="alg2.l7.m2.2a"><mrow id="alg2.l7.m2.2.2" xref="alg2.l7.m2.2.2.cmml"><msub id="alg2.l7.m2.2.2.4" xref="alg2.l7.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m2.2.2.4.2" xref="alg2.l7.m2.2.2.4.2.cmml">𝒯</mi><mn id="alg2.l7.m2.2.2.4.3" xref="alg2.l7.m2.2.2.4.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m2.2.2.3" xref="alg2.l7.m2.2.2.3.cmml">​</mo><mrow id="alg2.l7.m2.2.2.2.2" xref="alg2.l7.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l7.m2.2.2.2.2.3" xref="alg2.l7.m2.2.2.2.3.cmml">(</mo><msup id="alg2.l7.m2.1.1.1.1.1" xref="alg2.l7.m2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m2.1.1.1.1.1.2" xref="alg2.l7.m2.1.1.1.1.1.2a.cmml">u</mtext><mo id="alg2.l7.m2.1.1.1.1.1.3" xref="alg2.l7.m2.1.1.1.1.1.3.cmml">+</mo></msup><mo id="alg2.l7.m2.2.2.2.2.4" xref="alg2.l7.m2.2.2.2.3.cmml">,</mo><msup id="alg2.l7.m2.2.2.2.2.2" xref="alg2.l7.m2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m2.2.2.2.2.2.2" xref="alg2.l7.m2.2.2.2.2.2.2a.cmml">v</mtext><mo id="alg2.l7.m2.2.2.2.2.2.3" xref="alg2.l7.m2.2.2.2.2.2.3.cmml">+</mo></msup><mo stretchy="false" id="alg2.l7.m2.2.2.2.2.5" xref="alg2.l7.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.2b"><apply id="alg2.l7.m2.2.2.cmml" xref="alg2.l7.m2.2.2"><times id="alg2.l7.m2.2.2.3.cmml" xref="alg2.l7.m2.2.2.3"></times><apply id="alg2.l7.m2.2.2.4.cmml" xref="alg2.l7.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.l7.m2.2.2.4.1.cmml" xref="alg2.l7.m2.2.2.4">subscript</csymbol><ci id="alg2.l7.m2.2.2.4.2.cmml" xref="alg2.l7.m2.2.2.4.2">𝒯</ci><cn type="integer" id="alg2.l7.m2.2.2.4.3.cmml" xref="alg2.l7.m2.2.2.4.3">2</cn></apply><interval closure="open" id="alg2.l7.m2.2.2.2.3.cmml" xref="alg2.l7.m2.2.2.2.2"><apply id="alg2.l7.m2.1.1.1.1.1.cmml" xref="alg2.l7.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.1.1.1.1.cmml" xref="alg2.l7.m2.1.1.1.1.1">superscript</csymbol><ci id="alg2.l7.m2.1.1.1.1.1.2a.cmml" xref="alg2.l7.m2.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m2.1.1.1.1.1.2.cmml" xref="alg2.l7.m2.1.1.1.1.1.2">u</mtext></ci><plus id="alg2.l7.m2.1.1.1.1.1.3.cmml" xref="alg2.l7.m2.1.1.1.1.1.3"></plus></apply><apply id="alg2.l7.m2.2.2.2.2.2.cmml" xref="alg2.l7.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l7.m2.2.2.2.2.2.1.cmml" xref="alg2.l7.m2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l7.m2.2.2.2.2.2.2a.cmml" xref="alg2.l7.m2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m2.2.2.2.2.2.2.cmml" xref="alg2.l7.m2.2.2.2.2.2.2">v</mtext></ci><plus id="alg2.l7.m2.2.2.2.2.2.3.cmml" xref="alg2.l7.m2.2.2.2.2.2.3"></plus></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.2c">\mathcal{T}_{2}(\textbf{{u}}^{+},\textbf{{v}}^{+})</annotation></semantics></math>, <math id="alg2.l7.m3.2" class="ltx_Math" alttext="\mathcal{T}_{3}(\textbf{{u}}^{-},\textbf{{v}}^{-})" display="inline"><semantics id="alg2.l7.m3.2a"><mrow id="alg2.l7.m3.2.2" xref="alg2.l7.m3.2.2.cmml"><msub id="alg2.l7.m3.2.2.4" xref="alg2.l7.m3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m3.2.2.4.2" xref="alg2.l7.m3.2.2.4.2.cmml">𝒯</mi><mn id="alg2.l7.m3.2.2.4.3" xref="alg2.l7.m3.2.2.4.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m3.2.2.3" xref="alg2.l7.m3.2.2.3.cmml">​</mo><mrow id="alg2.l7.m3.2.2.2.2" xref="alg2.l7.m3.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l7.m3.2.2.2.2.3" xref="alg2.l7.m3.2.2.2.3.cmml">(</mo><msup id="alg2.l7.m3.1.1.1.1.1" xref="alg2.l7.m3.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m3.1.1.1.1.1.2" xref="alg2.l7.m3.1.1.1.1.1.2a.cmml">u</mtext><mo id="alg2.l7.m3.1.1.1.1.1.3" xref="alg2.l7.m3.1.1.1.1.1.3.cmml">−</mo></msup><mo id="alg2.l7.m3.2.2.2.2.4" xref="alg2.l7.m3.2.2.2.3.cmml">,</mo><msup id="alg2.l7.m3.2.2.2.2.2" xref="alg2.l7.m3.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m3.2.2.2.2.2.2" xref="alg2.l7.m3.2.2.2.2.2.2a.cmml">v</mtext><mo id="alg2.l7.m3.2.2.2.2.2.3" xref="alg2.l7.m3.2.2.2.2.2.3.cmml">−</mo></msup><mo stretchy="false" id="alg2.l7.m3.2.2.2.2.5" xref="alg2.l7.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m3.2b"><apply id="alg2.l7.m3.2.2.cmml" xref="alg2.l7.m3.2.2"><times id="alg2.l7.m3.2.2.3.cmml" xref="alg2.l7.m3.2.2.3"></times><apply id="alg2.l7.m3.2.2.4.cmml" xref="alg2.l7.m3.2.2.4"><csymbol cd="ambiguous" id="alg2.l7.m3.2.2.4.1.cmml" xref="alg2.l7.m3.2.2.4">subscript</csymbol><ci id="alg2.l7.m3.2.2.4.2.cmml" xref="alg2.l7.m3.2.2.4.2">𝒯</ci><cn type="integer" id="alg2.l7.m3.2.2.4.3.cmml" xref="alg2.l7.m3.2.2.4.3">3</cn></apply><interval closure="open" id="alg2.l7.m3.2.2.2.3.cmml" xref="alg2.l7.m3.2.2.2.2"><apply id="alg2.l7.m3.1.1.1.1.1.cmml" xref="alg2.l7.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m3.1.1.1.1.1.1.cmml" xref="alg2.l7.m3.1.1.1.1.1">superscript</csymbol><ci id="alg2.l7.m3.1.1.1.1.1.2a.cmml" xref="alg2.l7.m3.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m3.1.1.1.1.1.2.cmml" xref="alg2.l7.m3.1.1.1.1.1.2">u</mtext></ci><minus id="alg2.l7.m3.1.1.1.1.1.3.cmml" xref="alg2.l7.m3.1.1.1.1.1.3"></minus></apply><apply id="alg2.l7.m3.2.2.2.2.2.cmml" xref="alg2.l7.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l7.m3.2.2.2.2.2.1.cmml" xref="alg2.l7.m3.2.2.2.2.2">superscript</csymbol><ci id="alg2.l7.m3.2.2.2.2.2.2a.cmml" xref="alg2.l7.m3.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l7.m3.2.2.2.2.2.2.cmml" xref="alg2.l7.m3.2.2.2.2.2.2">v</mtext></ci><minus id="alg2.l7.m3.2.2.2.2.2.3.cmml" xref="alg2.l7.m3.2.2.2.2.2.3"></minus></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m3.2c">\mathcal{T}_{3}(\textbf{{u}}^{-},\textbf{{v}}^{-})</annotation></semantics></math> <span id="alg2.l7.3" class="ltx_text ltx_font_bold">do</span>:

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>  <math id="alg2.l8.m1.1" class="ltx_Math" alttext="M\leftarrow\textbf{{u}}\otimes\textbf{{v}}" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">M</mi><mo stretchy="false" id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">←</mo><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2a.cmml">u</mtext><mo lspace="0.222em" rspace="0.222em" id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml">⊗</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l8.m1.1.1.3.3" xref="alg2.l8.m1.1.1.3.3a.cmml">v</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">←</ci><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝑀</ci><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><csymbol cd="latexml" id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1">tensor-product</csymbol><ci id="alg2.l8.m1.1.1.3.2a.cmml" xref="alg2.l8.m1.1.1.3.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2">u</mtext></ci><ci id="alg2.l8.m1.1.1.3.3a.cmml" xref="alg2.l8.m1.1.1.3.3"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l8.m1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.3.3">v</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">M\leftarrow\textbf{{u}}\otimes\textbf{{v}}</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <math id="alg2.l9.m1.1" class="ltx_Math" alttext="\bar{M}\leftarrow\mathcal{T}(M)\leftarrow M" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.2" xref="alg2.l9.m1.1.2.cmml"><mover accent="true" id="alg2.l9.m1.1.2.2" xref="alg2.l9.m1.1.2.2.cmml"><mi id="alg2.l9.m1.1.2.2.2" xref="alg2.l9.m1.1.2.2.2.cmml">M</mi><mo id="alg2.l9.m1.1.2.2.1" xref="alg2.l9.m1.1.2.2.1.cmml">¯</mo></mover><mo stretchy="false" id="alg2.l9.m1.1.2.3" xref="alg2.l9.m1.1.2.3.cmml">←</mo><mrow id="alg2.l9.m1.1.2.4" xref="alg2.l9.m1.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.2.4.2" xref="alg2.l9.m1.1.2.4.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.1.2.4.1" xref="alg2.l9.m1.1.2.4.1.cmml">​</mo><mrow id="alg2.l9.m1.1.2.4.3.2" xref="alg2.l9.m1.1.2.4.cmml"><mo stretchy="false" id="alg2.l9.m1.1.2.4.3.2.1" xref="alg2.l9.m1.1.2.4.cmml">(</mo><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">M</mi><mo stretchy="false" id="alg2.l9.m1.1.2.4.3.2.2" xref="alg2.l9.m1.1.2.4.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l9.m1.1.2.5" xref="alg2.l9.m1.1.2.5.cmml">←</mo><mi id="alg2.l9.m1.1.2.6" xref="alg2.l9.m1.1.2.6.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.2.cmml" xref="alg2.l9.m1.1.2"><and id="alg2.l9.m1.1.2a.cmml" xref="alg2.l9.m1.1.2"></and><apply id="alg2.l9.m1.1.2b.cmml" xref="alg2.l9.m1.1.2"><ci id="alg2.l9.m1.1.2.3.cmml" xref="alg2.l9.m1.1.2.3">←</ci><apply id="alg2.l9.m1.1.2.2.cmml" xref="alg2.l9.m1.1.2.2"><ci id="alg2.l9.m1.1.2.2.1.cmml" xref="alg2.l9.m1.1.2.2.1">¯</ci><ci id="alg2.l9.m1.1.2.2.2.cmml" xref="alg2.l9.m1.1.2.2.2">𝑀</ci></apply><apply id="alg2.l9.m1.1.2.4.cmml" xref="alg2.l9.m1.1.2.4"><times id="alg2.l9.m1.1.2.4.1.cmml" xref="alg2.l9.m1.1.2.4.1"></times><ci id="alg2.l9.m1.1.2.4.2.cmml" xref="alg2.l9.m1.1.2.4.2">𝒯</ci><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝑀</ci></apply></apply><apply id="alg2.l9.m1.1.2c.cmml" xref="alg2.l9.m1.1.2"><ci id="alg2.l9.m1.1.2.5.cmml" xref="alg2.l9.m1.1.2.5">←</ci><share href="#alg2.l9.m1.1.2.4.cmml" id="alg2.l9.m1.1.2d.cmml" xref="alg2.l9.m1.1.2"></share><ci id="alg2.l9.m1.1.2.6.cmml" xref="alg2.l9.m1.1.2.6">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\bar{M}\leftarrow\mathcal{T}(M)\leftarrow M</annotation></semantics></math>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <math id="alg2.l10.m1.1" class="ltx_Math" alttext="\bar{M}_{\text{binary}}\leftarrow\{\textbf{if }w&gt;0.5\textbf{ then }1\textbf{ else }0\textbf{ for each }w\textbf{ in }\bar{M}\}" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><msub id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"><mover accent="true" id="alg2.l10.m1.1.1.3.2" xref="alg2.l10.m1.1.1.3.2.cmml"><mi id="alg2.l10.m1.1.1.3.2.2" xref="alg2.l10.m1.1.1.3.2.2.cmml">M</mi><mo id="alg2.l10.m1.1.1.3.2.1" xref="alg2.l10.m1.1.1.3.2.1.cmml">¯</mo></mover><mtext id="alg2.l10.m1.1.1.3.3" xref="alg2.l10.m1.1.1.3.3a.cmml">binary</mtext></msub><mo stretchy="false" id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">←</mo><mrow id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l10.m1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.2.cmml">{</mo><mrow id="alg2.l10.m1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.cmml"><mrow id="alg2.l10.m1.1.1.1.1.1.2" xref="alg2.l10.m1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.2.2" xref="alg2.l10.m1.1.1.1.1.1.2.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.2.1" xref="alg2.l10.m1.1.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.1.1.1.2.3" xref="alg2.l10.m1.1.1.1.1.1.2.3.cmml">w</mi></mrow><mo id="alg2.l10.m1.1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.1.cmml">&gt;</mo><mrow id="alg2.l10.m1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.1.3.cmml"><mn id="alg2.l10.m1.1.1.1.1.1.3.2" xref="alg2.l10.m1.1.1.1.1.1.3.2.cmml">0.5</mn><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.3" xref="alg2.l10.m1.1.1.1.1.1.3.3a.cmml"> then </mtext><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1a" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mn id="alg2.l10.m1.1.1.1.1.1.3.4" xref="alg2.l10.m1.1.1.1.1.1.3.4.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1b" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.5" xref="alg2.l10.m1.1.1.1.1.1.3.5a.cmml"> else </mtext><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1c" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mn id="alg2.l10.m1.1.1.1.1.1.3.6" xref="alg2.l10.m1.1.1.1.1.1.3.6.cmml">0</mn><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1d" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.7" xref="alg2.l10.m1.1.1.1.1.1.3.7a.cmml"> for each </mtext><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1e" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l10.m1.1.1.1.1.1.3.8" xref="alg2.l10.m1.1.1.1.1.1.3.8.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1f" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.9" xref="alg2.l10.m1.1.1.1.1.1.3.9a.cmml"> in </mtext><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.1.1.1.3.1g" xref="alg2.l10.m1.1.1.1.1.1.3.1.cmml">​</mo><mover accent="true" id="alg2.l10.m1.1.1.1.1.1.3.10" xref="alg2.l10.m1.1.1.1.1.1.3.10.cmml"><mi id="alg2.l10.m1.1.1.1.1.1.3.10.2" xref="alg2.l10.m1.1.1.1.1.1.3.10.2.cmml">M</mi><mo id="alg2.l10.m1.1.1.1.1.1.3.10.1" xref="alg2.l10.m1.1.1.1.1.1.3.10.1.cmml">¯</mo></mover></mrow></mrow><mo stretchy="false" id="alg2.l10.m1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">←</ci><apply id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.3">subscript</csymbol><apply id="alg2.l10.m1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.3.2"><ci id="alg2.l10.m1.1.1.3.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.1">¯</ci><ci id="alg2.l10.m1.1.1.3.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2">𝑀</ci></apply><ci id="alg2.l10.m1.1.1.3.3a.cmml" xref="alg2.l10.m1.1.1.3.3"><mtext mathsize="70%" id="alg2.l10.m1.1.1.3.3.cmml" xref="alg2.l10.m1.1.1.3.3">binary</mtext></ci></apply><set id="alg2.l10.m1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.1"><apply id="alg2.l10.m1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1"><gt id="alg2.l10.m1.1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.1"></gt><apply id="alg2.l10.m1.1.1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.2"><times id="alg2.l10.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.2.1"></times><ci id="alg2.l10.m1.1.1.1.1.1.2.2a.cmml" xref="alg2.l10.m1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.2.2">if </mtext></ci><ci id="alg2.l10.m1.1.1.1.1.1.2.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.2.3">𝑤</ci></apply><apply id="alg2.l10.m1.1.1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.3"><times id="alg2.l10.m1.1.1.1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.1"></times><cn type="float" id="alg2.l10.m1.1.1.1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.2">0.5</cn><ci id="alg2.l10.m1.1.1.1.1.1.3.3a.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.3"><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.3"> then </mtext></ci><cn type="integer" id="alg2.l10.m1.1.1.1.1.1.3.4.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.4">1</cn><ci id="alg2.l10.m1.1.1.1.1.1.3.5a.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.5"><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.5.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.5"> else </mtext></ci><cn type="integer" id="alg2.l10.m1.1.1.1.1.1.3.6.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.6">0</cn><ci id="alg2.l10.m1.1.1.1.1.1.3.7a.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.7"><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.7.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.7"> for each </mtext></ci><ci id="alg2.l10.m1.1.1.1.1.1.3.8.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.8">𝑤</ci><ci id="alg2.l10.m1.1.1.1.1.1.3.9a.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.9"><mtext class="ltx_mathvariant_bold" id="alg2.l10.m1.1.1.1.1.1.3.9.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.9"> in </mtext></ci><apply id="alg2.l10.m1.1.1.1.1.1.3.10.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.10"><ci id="alg2.l10.m1.1.1.1.1.1.3.10.1.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.10.1">¯</ci><ci id="alg2.l10.m1.1.1.1.1.1.3.10.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.3.10.2">𝑀</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\bar{M}_{\text{binary}}\leftarrow\{\textbf{if }w&gt;0.5\textbf{ then }1\textbf{ else }0\textbf{ for each }w\textbf{ in }\bar{M}\}</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span> Calculate triplet loss: 

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <math id="alg2.l12.m1.4" class="ltx_Math" alttext="d(\textbf{{a}},\textbf{{p}})\leftarrow\text{distance}(\bar{M},\bar{M}^{+})" display="inline"><semantics id="alg2.l12.m1.4a"><mrow id="alg2.l12.m1.4.4" xref="alg2.l12.m1.4.4.cmml"><mrow id="alg2.l12.m1.4.4.3" xref="alg2.l12.m1.4.4.3.cmml"><mi id="alg2.l12.m1.4.4.3.2" xref="alg2.l12.m1.4.4.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.4.4.3.1" xref="alg2.l12.m1.4.4.3.1.cmml">​</mo><mrow id="alg2.l12.m1.4.4.3.3.2" xref="alg2.l12.m1.4.4.3.3.1.cmml"><mo stretchy="false" id="alg2.l12.m1.4.4.3.3.2.1" xref="alg2.l12.m1.4.4.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1a.cmml">a</mtext><mo id="alg2.l12.m1.4.4.3.3.2.2" xref="alg2.l12.m1.4.4.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l12.m1.2.2" xref="alg2.l12.m1.2.2a.cmml">p</mtext><mo stretchy="false" id="alg2.l12.m1.4.4.3.3.2.3" xref="alg2.l12.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l12.m1.4.4.2" xref="alg2.l12.m1.4.4.2.cmml">←</mo><mrow id="alg2.l12.m1.4.4.1" xref="alg2.l12.m1.4.4.1.cmml"><mtext id="alg2.l12.m1.4.4.1.3" xref="alg2.l12.m1.4.4.1.3a.cmml">distance</mtext><mo lspace="0em" rspace="0em" id="alg2.l12.m1.4.4.1.2" xref="alg2.l12.m1.4.4.1.2.cmml">​</mo><mrow id="alg2.l12.m1.4.4.1.1.1" xref="alg2.l12.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="alg2.l12.m1.4.4.1.1.1.2" xref="alg2.l12.m1.4.4.1.1.2.cmml">(</mo><mover accent="true" id="alg2.l12.m1.3.3" xref="alg2.l12.m1.3.3.cmml"><mi id="alg2.l12.m1.3.3.2" xref="alg2.l12.m1.3.3.2.cmml">M</mi><mo id="alg2.l12.m1.3.3.1" xref="alg2.l12.m1.3.3.1.cmml">¯</mo></mover><mo id="alg2.l12.m1.4.4.1.1.1.3" xref="alg2.l12.m1.4.4.1.1.2.cmml">,</mo><msup id="alg2.l12.m1.4.4.1.1.1.1" xref="alg2.l12.m1.4.4.1.1.1.1.cmml"><mover accent="true" id="alg2.l12.m1.4.4.1.1.1.1.2" xref="alg2.l12.m1.4.4.1.1.1.1.2.cmml"><mi id="alg2.l12.m1.4.4.1.1.1.1.2.2" xref="alg2.l12.m1.4.4.1.1.1.1.2.2.cmml">M</mi><mo id="alg2.l12.m1.4.4.1.1.1.1.2.1" xref="alg2.l12.m1.4.4.1.1.1.1.2.1.cmml">¯</mo></mover><mo id="alg2.l12.m1.4.4.1.1.1.1.3" xref="alg2.l12.m1.4.4.1.1.1.1.3.cmml">+</mo></msup><mo stretchy="false" id="alg2.l12.m1.4.4.1.1.1.4" xref="alg2.l12.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.4b"><apply id="alg2.l12.m1.4.4.cmml" xref="alg2.l12.m1.4.4"><ci id="alg2.l12.m1.4.4.2.cmml" xref="alg2.l12.m1.4.4.2">←</ci><apply id="alg2.l12.m1.4.4.3.cmml" xref="alg2.l12.m1.4.4.3"><times id="alg2.l12.m1.4.4.3.1.cmml" xref="alg2.l12.m1.4.4.3.1"></times><ci id="alg2.l12.m1.4.4.3.2.cmml" xref="alg2.l12.m1.4.4.3.2">𝑑</ci><interval closure="open" id="alg2.l12.m1.4.4.3.3.1.cmml" xref="alg2.l12.m1.4.4.3.3.2"><ci id="alg2.l12.m1.1.1a.cmml" xref="alg2.l12.m1.1.1"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">a</mtext></ci><ci id="alg2.l12.m1.2.2a.cmml" xref="alg2.l12.m1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l12.m1.2.2.cmml" xref="alg2.l12.m1.2.2">p</mtext></ci></interval></apply><apply id="alg2.l12.m1.4.4.1.cmml" xref="alg2.l12.m1.4.4.1"><times id="alg2.l12.m1.4.4.1.2.cmml" xref="alg2.l12.m1.4.4.1.2"></times><ci id="alg2.l12.m1.4.4.1.3a.cmml" xref="alg2.l12.m1.4.4.1.3"><mtext id="alg2.l12.m1.4.4.1.3.cmml" xref="alg2.l12.m1.4.4.1.3">distance</mtext></ci><interval closure="open" id="alg2.l12.m1.4.4.1.1.2.cmml" xref="alg2.l12.m1.4.4.1.1.1"><apply id="alg2.l12.m1.3.3.cmml" xref="alg2.l12.m1.3.3"><ci id="alg2.l12.m1.3.3.1.cmml" xref="alg2.l12.m1.3.3.1">¯</ci><ci id="alg2.l12.m1.3.3.2.cmml" xref="alg2.l12.m1.3.3.2">𝑀</ci></apply><apply id="alg2.l12.m1.4.4.1.1.1.1.cmml" xref="alg2.l12.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l12.m1.4.4.1.1.1.1">superscript</csymbol><apply id="alg2.l12.m1.4.4.1.1.1.1.2.cmml" xref="alg2.l12.m1.4.4.1.1.1.1.2"><ci id="alg2.l12.m1.4.4.1.1.1.1.2.1.cmml" xref="alg2.l12.m1.4.4.1.1.1.1.2.1">¯</ci><ci id="alg2.l12.m1.4.4.1.1.1.1.2.2.cmml" xref="alg2.l12.m1.4.4.1.1.1.1.2.2">𝑀</ci></apply><plus id="alg2.l12.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l12.m1.4.4.1.1.1.1.3"></plus></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.4c">d(\textbf{{a}},\textbf{{p}})\leftarrow\text{distance}(\bar{M},\bar{M}^{+})</annotation></semantics></math>

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>  <math id="alg2.l13.m1.4" class="ltx_Math" alttext="d(\textbf{{a}},\textbf{{n}})\leftarrow\text{distance}(\bar{M},\bar{M}^{-})" display="inline"><semantics id="alg2.l13.m1.4a"><mrow id="alg2.l13.m1.4.4" xref="alg2.l13.m1.4.4.cmml"><mrow id="alg2.l13.m1.4.4.3" xref="alg2.l13.m1.4.4.3.cmml"><mi id="alg2.l13.m1.4.4.3.2" xref="alg2.l13.m1.4.4.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.4.4.3.1" xref="alg2.l13.m1.4.4.3.1.cmml">​</mo><mrow id="alg2.l13.m1.4.4.3.3.2" xref="alg2.l13.m1.4.4.3.3.1.cmml"><mo stretchy="false" id="alg2.l13.m1.4.4.3.3.2.1" xref="alg2.l13.m1.4.4.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1a.cmml">a</mtext><mo id="alg2.l13.m1.4.4.3.3.2.2" xref="alg2.l13.m1.4.4.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2a.cmml">n</mtext><mo stretchy="false" id="alg2.l13.m1.4.4.3.3.2.3" xref="alg2.l13.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l13.m1.4.4.2" xref="alg2.l13.m1.4.4.2.cmml">←</mo><mrow id="alg2.l13.m1.4.4.1" xref="alg2.l13.m1.4.4.1.cmml"><mtext id="alg2.l13.m1.4.4.1.3" xref="alg2.l13.m1.4.4.1.3a.cmml">distance</mtext><mo lspace="0em" rspace="0em" id="alg2.l13.m1.4.4.1.2" xref="alg2.l13.m1.4.4.1.2.cmml">​</mo><mrow id="alg2.l13.m1.4.4.1.1.1" xref="alg2.l13.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="alg2.l13.m1.4.4.1.1.1.2" xref="alg2.l13.m1.4.4.1.1.2.cmml">(</mo><mover accent="true" id="alg2.l13.m1.3.3" xref="alg2.l13.m1.3.3.cmml"><mi id="alg2.l13.m1.3.3.2" xref="alg2.l13.m1.3.3.2.cmml">M</mi><mo id="alg2.l13.m1.3.3.1" xref="alg2.l13.m1.3.3.1.cmml">¯</mo></mover><mo id="alg2.l13.m1.4.4.1.1.1.3" xref="alg2.l13.m1.4.4.1.1.2.cmml">,</mo><msup id="alg2.l13.m1.4.4.1.1.1.1" xref="alg2.l13.m1.4.4.1.1.1.1.cmml"><mover accent="true" id="alg2.l13.m1.4.4.1.1.1.1.2" xref="alg2.l13.m1.4.4.1.1.1.1.2.cmml"><mi id="alg2.l13.m1.4.4.1.1.1.1.2.2" xref="alg2.l13.m1.4.4.1.1.1.1.2.2.cmml">M</mi><mo id="alg2.l13.m1.4.4.1.1.1.1.2.1" xref="alg2.l13.m1.4.4.1.1.1.1.2.1.cmml">¯</mo></mover><mo id="alg2.l13.m1.4.4.1.1.1.1.3" xref="alg2.l13.m1.4.4.1.1.1.1.3.cmml">−</mo></msup><mo stretchy="false" id="alg2.l13.m1.4.4.1.1.1.4" xref="alg2.l13.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.4b"><apply id="alg2.l13.m1.4.4.cmml" xref="alg2.l13.m1.4.4"><ci id="alg2.l13.m1.4.4.2.cmml" xref="alg2.l13.m1.4.4.2">←</ci><apply id="alg2.l13.m1.4.4.3.cmml" xref="alg2.l13.m1.4.4.3"><times id="alg2.l13.m1.4.4.3.1.cmml" xref="alg2.l13.m1.4.4.3.1"></times><ci id="alg2.l13.m1.4.4.3.2.cmml" xref="alg2.l13.m1.4.4.3.2">𝑑</ci><interval closure="open" id="alg2.l13.m1.4.4.3.3.1.cmml" xref="alg2.l13.m1.4.4.3.3.2"><ci id="alg2.l13.m1.1.1a.cmml" xref="alg2.l13.m1.1.1"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">a</mtext></ci><ci id="alg2.l13.m1.2.2a.cmml" xref="alg2.l13.m1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2">n</mtext></ci></interval></apply><apply id="alg2.l13.m1.4.4.1.cmml" xref="alg2.l13.m1.4.4.1"><times id="alg2.l13.m1.4.4.1.2.cmml" xref="alg2.l13.m1.4.4.1.2"></times><ci id="alg2.l13.m1.4.4.1.3a.cmml" xref="alg2.l13.m1.4.4.1.3"><mtext id="alg2.l13.m1.4.4.1.3.cmml" xref="alg2.l13.m1.4.4.1.3">distance</mtext></ci><interval closure="open" id="alg2.l13.m1.4.4.1.1.2.cmml" xref="alg2.l13.m1.4.4.1.1.1"><apply id="alg2.l13.m1.3.3.cmml" xref="alg2.l13.m1.3.3"><ci id="alg2.l13.m1.3.3.1.cmml" xref="alg2.l13.m1.3.3.1">¯</ci><ci id="alg2.l13.m1.3.3.2.cmml" xref="alg2.l13.m1.3.3.2">𝑀</ci></apply><apply id="alg2.l13.m1.4.4.1.1.1.1.cmml" xref="alg2.l13.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l13.m1.4.4.1.1.1.1">superscript</csymbol><apply id="alg2.l13.m1.4.4.1.1.1.1.2.cmml" xref="alg2.l13.m1.4.4.1.1.1.1.2"><ci id="alg2.l13.m1.4.4.1.1.1.1.2.1.cmml" xref="alg2.l13.m1.4.4.1.1.1.1.2.1">¯</ci><ci id="alg2.l13.m1.4.4.1.1.1.1.2.2.cmml" xref="alg2.l13.m1.4.4.1.1.1.1.2.2">𝑀</ci></apply><minus id="alg2.l13.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l13.m1.4.4.1.1.1.1.3"></minus></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.4c">d(\textbf{{a}},\textbf{{n}})\leftarrow\text{distance}(\bar{M},\bar{M}^{-})</annotation></semantics></math>

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  <math id="alg2.l14.m1.7" class="ltx_Math" alttext="\mathcal{L}_{\text{triplet}}\leftarrow\max\{(d(\textbf{{a}},\textbf{{p}})-d(\textbf{{a}},\textbf{{n}}))+\alpha,0\}" display="inline"><semantics id="alg2.l14.m1.7a"><mrow id="alg2.l14.m1.7.7" xref="alg2.l14.m1.7.7.cmml"><msub id="alg2.l14.m1.7.7.3" xref="alg2.l14.m1.7.7.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l14.m1.7.7.3.2" xref="alg2.l14.m1.7.7.3.2.cmml">ℒ</mi><mtext id="alg2.l14.m1.7.7.3.3" xref="alg2.l14.m1.7.7.3.3a.cmml">triplet</mtext></msub><mo stretchy="false" id="alg2.l14.m1.7.7.2" xref="alg2.l14.m1.7.7.2.cmml">←</mo><mrow id="alg2.l14.m1.7.7.1.1" xref="alg2.l14.m1.7.7.1.2.cmml"><mi id="alg2.l14.m1.5.5" xref="alg2.l14.m1.5.5.cmml">max</mi><mo id="alg2.l14.m1.7.7.1.1a" xref="alg2.l14.m1.7.7.1.2.cmml">⁡</mo><mrow id="alg2.l14.m1.7.7.1.1.1" xref="alg2.l14.m1.7.7.1.2.cmml"><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.2" xref="alg2.l14.m1.7.7.1.2.cmml">{</mo><mrow id="alg2.l14.m1.7.7.1.1.1.1" xref="alg2.l14.m1.7.7.1.1.1.1.cmml"><mrow id="alg2.l14.m1.7.7.1.1.1.1.1.1" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.1.1.1.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l14.m1.7.7.1.1.1.1.1.1.1" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.1" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.1.cmml"><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.2.1" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1a.cmml">a</mtext><mo id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.2.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.2.2" xref="alg2.l14.m1.2.2a.cmml">p</mtext><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.2.3" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.1" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.1" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.2.1" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.3.3" xref="alg2.l14.m1.3.3a.cmml">a</mtext><mo id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.2.2" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.4.4" xref="alg2.l14.m1.4.4a.cmml">n</mtext><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.2.3" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.1.1.1.3" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l14.m1.7.7.1.1.1.1.2" xref="alg2.l14.m1.7.7.1.1.1.1.2.cmml">+</mo><mi id="alg2.l14.m1.7.7.1.1.1.1.3" xref="alg2.l14.m1.7.7.1.1.1.1.3.cmml">α</mi></mrow><mo id="alg2.l14.m1.7.7.1.1.1.3" xref="alg2.l14.m1.7.7.1.2.cmml">,</mo><mn id="alg2.l14.m1.6.6" xref="alg2.l14.m1.6.6.cmml">0</mn><mo stretchy="false" id="alg2.l14.m1.7.7.1.1.1.4" xref="alg2.l14.m1.7.7.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.7b"><apply id="alg2.l14.m1.7.7.cmml" xref="alg2.l14.m1.7.7"><ci id="alg2.l14.m1.7.7.2.cmml" xref="alg2.l14.m1.7.7.2">←</ci><apply id="alg2.l14.m1.7.7.3.cmml" xref="alg2.l14.m1.7.7.3"><csymbol cd="ambiguous" id="alg2.l14.m1.7.7.3.1.cmml" xref="alg2.l14.m1.7.7.3">subscript</csymbol><ci id="alg2.l14.m1.7.7.3.2.cmml" xref="alg2.l14.m1.7.7.3.2">ℒ</ci><ci id="alg2.l14.m1.7.7.3.3a.cmml" xref="alg2.l14.m1.7.7.3.3"><mtext mathsize="70%" id="alg2.l14.m1.7.7.3.3.cmml" xref="alg2.l14.m1.7.7.3.3">triplet</mtext></ci></apply><apply id="alg2.l14.m1.7.7.1.2.cmml" xref="alg2.l14.m1.7.7.1.1"><max id="alg2.l14.m1.5.5.cmml" xref="alg2.l14.m1.5.5"></max><apply id="alg2.l14.m1.7.7.1.1.1.1.cmml" xref="alg2.l14.m1.7.7.1.1.1.1"><plus id="alg2.l14.m1.7.7.1.1.1.1.2.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.2"></plus><apply id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1"><minus id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.1"></minus><apply id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2"><times id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.1"></times><ci id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.2">𝑑</ci><interval closure="open" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.2.3.2"><ci id="alg2.l14.m1.1.1a.cmml" xref="alg2.l14.m1.1.1"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">a</mtext></ci><ci id="alg2.l14.m1.2.2a.cmml" xref="alg2.l14.m1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.2.2.cmml" xref="alg2.l14.m1.2.2">p</mtext></ci></interval></apply><apply id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3"><times id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.1"></times><ci id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.2">𝑑</ci><interval closure="open" id="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.1.1.1.3.3.2"><ci id="alg2.l14.m1.3.3a.cmml" xref="alg2.l14.m1.3.3"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.3.3.cmml" xref="alg2.l14.m1.3.3">a</mtext></ci><ci id="alg2.l14.m1.4.4a.cmml" xref="alg2.l14.m1.4.4"><mtext class="ltx_mathvariant_bold-italic" id="alg2.l14.m1.4.4.cmml" xref="alg2.l14.m1.4.4">n</mtext></ci></interval></apply></apply><ci id="alg2.l14.m1.7.7.1.1.1.1.3.cmml" xref="alg2.l14.m1.7.7.1.1.1.1.3">𝛼</ci></apply><cn type="integer" id="alg2.l14.m1.6.6.cmml" xref="alg2.l14.m1.6.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.7c">\mathcal{L}_{\text{triplet}}\leftarrow\max\{(d(\textbf{{a}},\textbf{{p}})-d(\textbf{{a}},\textbf{{n}}))+\alpha,0\}</annotation></semantics></math>

</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span> <math id="alg2.l15.m1.1" class="ltx_Math" alttext="\mathcal{T}_{1}" display="inline"><semantics id="alg2.l15.m1.1a"><msub id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">𝒯</mi><mn id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1">subscript</csymbol><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝒯</ci><cn type="integer" id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">\mathcal{T}_{1}</annotation></semantics></math>, <math id="alg2.l15.m2.1" class="ltx_Math" alttext="\mathcal{T}_{2}" display="inline"><semantics id="alg2.l15.m2.1a"><msub id="alg2.l15.m2.1.1" xref="alg2.l15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l15.m2.1.1.2" xref="alg2.l15.m2.1.1.2.cmml">𝒯</mi><mn id="alg2.l15.m2.1.1.3" xref="alg2.l15.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l15.m2.1b"><apply id="alg2.l15.m2.1.1.cmml" xref="alg2.l15.m2.1.1"><csymbol cd="ambiguous" id="alg2.l15.m2.1.1.1.cmml" xref="alg2.l15.m2.1.1">subscript</csymbol><ci id="alg2.l15.m2.1.1.2.cmml" xref="alg2.l15.m2.1.1.2">𝒯</ci><cn type="integer" id="alg2.l15.m2.1.1.3.cmml" xref="alg2.l15.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m2.1c">\mathcal{T}_{2}</annotation></semantics></math>, <math id="alg2.l15.m3.1" class="ltx_Math" alttext="\mathcal{T}_{3}\leftarrow" display="inline"><semantics id="alg2.l15.m3.1a"><mrow id="alg2.l15.m3.1.1" xref="alg2.l15.m3.1.1.cmml"><msub id="alg2.l15.m3.1.1.2" xref="alg2.l15.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l15.m3.1.1.2.2" xref="alg2.l15.m3.1.1.2.2.cmml">𝒯</mi><mn id="alg2.l15.m3.1.1.2.3" xref="alg2.l15.m3.1.1.2.3.cmml">3</mn></msub><mo stretchy="false" id="alg2.l15.m3.1.1.1" xref="alg2.l15.m3.1.1.1.cmml">←</mo><mi id="alg2.l15.m3.1.1.3" xref="alg2.l15.m3.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m3.1b"><apply id="alg2.l15.m3.1.1.cmml" xref="alg2.l15.m3.1.1"><ci id="alg2.l15.m3.1.1.1.cmml" xref="alg2.l15.m3.1.1.1">←</ci><apply id="alg2.l15.m3.1.1.2.cmml" xref="alg2.l15.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l15.m3.1.1.2.1.cmml" xref="alg2.l15.m3.1.1.2">subscript</csymbol><ci id="alg2.l15.m3.1.1.2.2.cmml" xref="alg2.l15.m3.1.1.2.2">𝒯</ci><cn type="integer" id="alg2.l15.m3.1.1.2.3.cmml" xref="alg2.l15.m3.1.1.2.3">3</cn></apply><csymbol cd="latexml" id="alg2.l15.m3.1.1.3.cmml" xref="alg2.l15.m3.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m3.1c">\mathcal{T}_{3}\leftarrow</annotation></semantics></math> update weights using gradient descent 

</div>
</div>
</figure>
<div id="S4.SS0.SSSx3.p4" class="ltx_para">
<p id="S4.SS0.SSSx3.p4.3" class="ltx_p">Within each branch (Algorithm <a href="#alg2" title="Algorithm 2 ‣ MarbliX Monogram ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Lines <a href="#alg2.l11" title="In Algorithm 2 ‣ MarbliX Monogram ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>-<a href="#alg2.l15" title="In Algorithm 2 ‣ MarbliX Monogram ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>), the pair of <span id="S4.SS0.SSSx3.p4.3.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span> and <span id="S4.SS0.SSSx3.p4.3.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span> is projected into a matrix through the computation of the outer product between their respective layers. This tensor is then flattened and passed through three consecutive dense layers of size 1024, 256, and 64 to learn the deep multimodal relationship. The last layer of the model has a binary branch that generates a binary representation of the last layer. This is crucial as it enables the generation of compact binary representations, highly efficient for subsequent indexing and storage. As the tanh function results in values within the range of <math id="S4.SS0.SSSx3.p4.3.m3.2" class="ltx_Math" alttext="[-1,1]" display="inline"><semantics id="S4.SS0.SSSx3.p4.3.m3.2a"><mrow id="S4.SS0.SSSx3.p4.3.m3.2.2.1" xref="S4.SS0.SSSx3.p4.3.m3.2.2.2.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p4.3.m3.2.2.1.2" xref="S4.SS0.SSSx3.p4.3.m3.2.2.2.cmml">[</mo><mrow id="S4.SS0.SSSx3.p4.3.m3.2.2.1.1" xref="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.cmml"><mo id="S4.SS0.SSSx3.p4.3.m3.2.2.1.1a" xref="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.cmml">−</mo><mn id="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.2" xref="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.2.cmml">1</mn></mrow><mo id="S4.SS0.SSSx3.p4.3.m3.2.2.1.3" xref="S4.SS0.SSSx3.p4.3.m3.2.2.2.cmml">,</mo><mn id="S4.SS0.SSSx3.p4.3.m3.1.1" xref="S4.SS0.SSSx3.p4.3.m3.1.1.cmml">1</mn><mo stretchy="false" id="S4.SS0.SSSx3.p4.3.m3.2.2.1.4" xref="S4.SS0.SSSx3.p4.3.m3.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p4.3.m3.2b"><interval closure="closed" id="S4.SS0.SSSx3.p4.3.m3.2.2.2.cmml" xref="S4.SS0.SSSx3.p4.3.m3.2.2.1"><apply id="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.cmml" xref="S4.SS0.SSSx3.p4.3.m3.2.2.1.1"><minus id="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.1.cmml" xref="S4.SS0.SSSx3.p4.3.m3.2.2.1.1"></minus><cn type="integer" id="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.2.cmml" xref="S4.SS0.SSSx3.p4.3.m3.2.2.1.1.2">1</cn></apply><cn type="integer" id="S4.SS0.SSSx3.p4.3.m3.1.1.cmml" xref="S4.SS0.SSSx3.p4.3.m3.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p4.3.m3.2c">[-1,1]</annotation></semantics></math>, the binary dense layer sets positive values to 1 and negative values to 0.</p>
</div>
<div id="S4.SS0.SSSx3.p5" class="ltx_para">
<p id="S4.SS0.SSSx3.p5.1" class="ltx_p">The triplet loss function (Equation <a href="#S4.E1" title="In MarbliX Monogram ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) calculates the distances between the anchor’s predicted matrix and both the positive and negative matrices.</p>
</div>
<div id="S4.SS0.SSSx3.p6" class="ltx_para">
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E1.m1.10" class="ltx_Math" alttext="\mathcal{L}_{\text{triplet}}(\textbf{{a}},\textbf{{p}},\textbf{{n}})=\max\{d(\textbf{{a}},\textbf{{p}})-d(\textbf{{a}},\textbf{{n}})+\alpha,0\}" display="block"><semantics id="S4.E1.m1.10a"><mrow id="S4.E1.m1.10.10" xref="S4.E1.m1.10.10.cmml"><mrow id="S4.E1.m1.10.10.3" xref="S4.E1.m1.10.10.3.cmml"><msub id="S4.E1.m1.10.10.3.2" xref="S4.E1.m1.10.10.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.10.10.3.2.2" xref="S4.E1.m1.10.10.3.2.2.cmml">ℒ</mi><mtext id="S4.E1.m1.10.10.3.2.3" xref="S4.E1.m1.10.10.3.2.3a.cmml">triplet</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.10.10.3.1" xref="S4.E1.m1.10.10.3.1.cmml">​</mo><mrow id="S4.E1.m1.10.10.3.3.2" xref="S4.E1.m1.10.10.3.3.1.cmml"><mo stretchy="false" id="S4.E1.m1.10.10.3.3.2.1" xref="S4.E1.m1.10.10.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1a.cmml">a</mtext><mo id="S4.E1.m1.10.10.3.3.2.2" xref="S4.E1.m1.10.10.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2a.cmml">p</mtext><mo id="S4.E1.m1.10.10.3.3.2.3" xref="S4.E1.m1.10.10.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3a.cmml">n</mtext><mo stretchy="false" id="S4.E1.m1.10.10.3.3.2.4" xref="S4.E1.m1.10.10.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.10.10.2" xref="S4.E1.m1.10.10.2.cmml">=</mo><mrow id="S4.E1.m1.10.10.1.1" xref="S4.E1.m1.10.10.1.2.cmml"><mi id="S4.E1.m1.8.8" xref="S4.E1.m1.8.8.cmml">max</mi><mo id="S4.E1.m1.10.10.1.1a" xref="S4.E1.m1.10.10.1.2.cmml">⁡</mo><mrow id="S4.E1.m1.10.10.1.1.1" xref="S4.E1.m1.10.10.1.2.cmml"><mo stretchy="false" id="S4.E1.m1.10.10.1.1.1.2" xref="S4.E1.m1.10.10.1.2.cmml">{</mo><mrow id="S4.E1.m1.10.10.1.1.1.1" xref="S4.E1.m1.10.10.1.1.1.1.cmml"><mrow id="S4.E1.m1.10.10.1.1.1.1.2" xref="S4.E1.m1.10.10.1.1.1.1.2.cmml"><mrow id="S4.E1.m1.10.10.1.1.1.1.2.2" xref="S4.E1.m1.10.10.1.1.1.1.2.2.cmml"><mi id="S4.E1.m1.10.10.1.1.1.1.2.2.2" xref="S4.E1.m1.10.10.1.1.1.1.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.10.10.1.1.1.1.2.2.1" xref="S4.E1.m1.10.10.1.1.1.1.2.2.1.cmml">​</mo><mrow id="S4.E1.m1.10.10.1.1.1.1.2.2.3.2" xref="S4.E1.m1.10.10.1.1.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S4.E1.m1.10.10.1.1.1.1.2.2.3.2.1" xref="S4.E1.m1.10.10.1.1.1.1.2.2.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4a.cmml">a</mtext><mo id="S4.E1.m1.10.10.1.1.1.1.2.2.3.2.2" xref="S4.E1.m1.10.10.1.1.1.1.2.2.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.5.5" xref="S4.E1.m1.5.5a.cmml">p</mtext><mo stretchy="false" id="S4.E1.m1.10.10.1.1.1.1.2.2.3.2.3" xref="S4.E1.m1.10.10.1.1.1.1.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.10.10.1.1.1.1.2.1" xref="S4.E1.m1.10.10.1.1.1.1.2.1.cmml">−</mo><mrow id="S4.E1.m1.10.10.1.1.1.1.2.3" xref="S4.E1.m1.10.10.1.1.1.1.2.3.cmml"><mi id="S4.E1.m1.10.10.1.1.1.1.2.3.2" xref="S4.E1.m1.10.10.1.1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.10.10.1.1.1.1.2.3.1" xref="S4.E1.m1.10.10.1.1.1.1.2.3.1.cmml">​</mo><mrow id="S4.E1.m1.10.10.1.1.1.1.2.3.3.2" xref="S4.E1.m1.10.10.1.1.1.1.2.3.3.1.cmml"><mo stretchy="false" id="S4.E1.m1.10.10.1.1.1.1.2.3.3.2.1" xref="S4.E1.m1.10.10.1.1.1.1.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.6.6" xref="S4.E1.m1.6.6a.cmml">a</mtext><mo id="S4.E1.m1.10.10.1.1.1.1.2.3.3.2.2" xref="S4.E1.m1.10.10.1.1.1.1.2.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.7.7" xref="S4.E1.m1.7.7a.cmml">n</mtext><mo stretchy="false" id="S4.E1.m1.10.10.1.1.1.1.2.3.3.2.3" xref="S4.E1.m1.10.10.1.1.1.1.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E1.m1.10.10.1.1.1.1.1" xref="S4.E1.m1.10.10.1.1.1.1.1.cmml">+</mo><mi id="S4.E1.m1.10.10.1.1.1.1.3" xref="S4.E1.m1.10.10.1.1.1.1.3.cmml">α</mi></mrow><mo id="S4.E1.m1.10.10.1.1.1.3" xref="S4.E1.m1.10.10.1.2.cmml">,</mo><mn id="S4.E1.m1.9.9" xref="S4.E1.m1.9.9.cmml">0</mn><mo stretchy="false" id="S4.E1.m1.10.10.1.1.1.4" xref="S4.E1.m1.10.10.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.10b"><apply id="S4.E1.m1.10.10.cmml" xref="S4.E1.m1.10.10"><eq id="S4.E1.m1.10.10.2.cmml" xref="S4.E1.m1.10.10.2"></eq><apply id="S4.E1.m1.10.10.3.cmml" xref="S4.E1.m1.10.10.3"><times id="S4.E1.m1.10.10.3.1.cmml" xref="S4.E1.m1.10.10.3.1"></times><apply id="S4.E1.m1.10.10.3.2.cmml" xref="S4.E1.m1.10.10.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.10.10.3.2.1.cmml" xref="S4.E1.m1.10.10.3.2">subscript</csymbol><ci id="S4.E1.m1.10.10.3.2.2.cmml" xref="S4.E1.m1.10.10.3.2.2">ℒ</ci><ci id="S4.E1.m1.10.10.3.2.3a.cmml" xref="S4.E1.m1.10.10.3.2.3"><mtext mathsize="70%" id="S4.E1.m1.10.10.3.2.3.cmml" xref="S4.E1.m1.10.10.3.2.3">triplet</mtext></ci></apply><vector id="S4.E1.m1.10.10.3.3.1.cmml" xref="S4.E1.m1.10.10.3.3.2"><ci id="S4.E1.m1.1.1a.cmml" xref="S4.E1.m1.1.1"><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">a</mtext></ci><ci id="S4.E1.m1.2.2a.cmml" xref="S4.E1.m1.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">p</mtext></ci><ci id="S4.E1.m1.3.3a.cmml" xref="S4.E1.m1.3.3"><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">n</mtext></ci></vector></apply><apply id="S4.E1.m1.10.10.1.2.cmml" xref="S4.E1.m1.10.10.1.1"><max id="S4.E1.m1.8.8.cmml" xref="S4.E1.m1.8.8"></max><apply id="S4.E1.m1.10.10.1.1.1.1.cmml" xref="S4.E1.m1.10.10.1.1.1.1"><plus id="S4.E1.m1.10.10.1.1.1.1.1.cmml" xref="S4.E1.m1.10.10.1.1.1.1.1"></plus><apply id="S4.E1.m1.10.10.1.1.1.1.2.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2"><minus id="S4.E1.m1.10.10.1.1.1.1.2.1.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.1"></minus><apply id="S4.E1.m1.10.10.1.1.1.1.2.2.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.2"><times id="S4.E1.m1.10.10.1.1.1.1.2.2.1.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.2.1"></times><ci id="S4.E1.m1.10.10.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.2.2">𝑑</ci><interval closure="open" id="S4.E1.m1.10.10.1.1.1.1.2.2.3.1.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.2.3.2"><ci id="S4.E1.m1.4.4a.cmml" xref="S4.E1.m1.4.4"><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">a</mtext></ci><ci id="S4.E1.m1.5.5a.cmml" xref="S4.E1.m1.5.5"><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5">p</mtext></ci></interval></apply><apply id="S4.E1.m1.10.10.1.1.1.1.2.3.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.3"><times id="S4.E1.m1.10.10.1.1.1.1.2.3.1.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.3.1"></times><ci id="S4.E1.m1.10.10.1.1.1.1.2.3.2.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.3.2">𝑑</ci><interval closure="open" id="S4.E1.m1.10.10.1.1.1.1.2.3.3.1.cmml" xref="S4.E1.m1.10.10.1.1.1.1.2.3.3.2"><ci id="S4.E1.m1.6.6a.cmml" xref="S4.E1.m1.6.6"><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6">a</mtext></ci><ci id="S4.E1.m1.7.7a.cmml" xref="S4.E1.m1.7.7"><mtext class="ltx_mathvariant_bold-italic" id="S4.E1.m1.7.7.cmml" xref="S4.E1.m1.7.7">n</mtext></ci></interval></apply></apply><ci id="S4.E1.m1.10.10.1.1.1.1.3.cmml" xref="S4.E1.m1.10.10.1.1.1.1.3">𝛼</ci></apply><cn type="integer" id="S4.E1.m1.9.9.cmml" xref="S4.E1.m1.9.9">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.10c">\mathcal{L}_{\text{triplet}}(\textbf{{a}},\textbf{{p}},\textbf{{n}})=\max\{d(\textbf{{a}},\textbf{{p}})-d(\textbf{{a}},\textbf{{n}})+\alpha,0\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS0.SSSx3.p7" class="ltx_para">
<p id="S4.SS0.SSSx3.p7.6" class="ltx_p">In Equation <a href="#S4.E1" title="In MarbliX Monogram ‣ 4 Methods ‣ Personalized 2D Binary Patient Codes of Tissue Images and Immunogenomic Data Through Multimodal Self-Supervised Fusion" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <span id="S4.SS0.SSSx3.p7.6.1" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">a</span> represents the anchor case, <span id="S4.SS0.SSSx3.p7.6.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">p</span> signifies a positive case (sharing the same diagnosis as the anchor), and <span id="S4.SS0.SSSx3.p7.6.3" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">n</span> denotes a negative case (with a different diagnosis from the anchor). <math id="S4.SS0.SSSx3.p7.4.m4.2" class="ltx_Math" alttext="d(\textbf{{a}},\textbf{{p}})" display="inline"><semantics id="S4.SS0.SSSx3.p7.4.m4.2a"><mrow id="S4.SS0.SSSx3.p7.4.m4.2.3" xref="S4.SS0.SSSx3.p7.4.m4.2.3.cmml"><mi id="S4.SS0.SSSx3.p7.4.m4.2.3.2" xref="S4.SS0.SSSx3.p7.4.m4.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx3.p7.4.m4.2.3.1" xref="S4.SS0.SSSx3.p7.4.m4.2.3.1.cmml">​</mo><mrow id="S4.SS0.SSSx3.p7.4.m4.2.3.3.2" xref="S4.SS0.SSSx3.p7.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p7.4.m4.2.3.3.2.1" xref="S4.SS0.SSSx3.p7.4.m4.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.4.m4.1.1" xref="S4.SS0.SSSx3.p7.4.m4.1.1a.cmml">a</mtext><mo id="S4.SS0.SSSx3.p7.4.m4.2.3.3.2.2" xref="S4.SS0.SSSx3.p7.4.m4.2.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.4.m4.2.2" xref="S4.SS0.SSSx3.p7.4.m4.2.2a.cmml">p</mtext><mo stretchy="false" id="S4.SS0.SSSx3.p7.4.m4.2.3.3.2.3" xref="S4.SS0.SSSx3.p7.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p7.4.m4.2b"><apply id="S4.SS0.SSSx3.p7.4.m4.2.3.cmml" xref="S4.SS0.SSSx3.p7.4.m4.2.3"><times id="S4.SS0.SSSx3.p7.4.m4.2.3.1.cmml" xref="S4.SS0.SSSx3.p7.4.m4.2.3.1"></times><ci id="S4.SS0.SSSx3.p7.4.m4.2.3.2.cmml" xref="S4.SS0.SSSx3.p7.4.m4.2.3.2">𝑑</ci><interval closure="open" id="S4.SS0.SSSx3.p7.4.m4.2.3.3.1.cmml" xref="S4.SS0.SSSx3.p7.4.m4.2.3.3.2"><ci id="S4.SS0.SSSx3.p7.4.m4.1.1a.cmml" xref="S4.SS0.SSSx3.p7.4.m4.1.1"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.4.m4.1.1.cmml" xref="S4.SS0.SSSx3.p7.4.m4.1.1">a</mtext></ci><ci id="S4.SS0.SSSx3.p7.4.m4.2.2a.cmml" xref="S4.SS0.SSSx3.p7.4.m4.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.4.m4.2.2.cmml" xref="S4.SS0.SSSx3.p7.4.m4.2.2">p</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p7.4.m4.2c">d(\textbf{{a}},\textbf{{p}})</annotation></semantics></math> calculates the distance between the anchor and positive case matrices, while <math id="S4.SS0.SSSx3.p7.5.m5.2" class="ltx_Math" alttext="d(\textbf{{a}},\textbf{{n}})" display="inline"><semantics id="S4.SS0.SSSx3.p7.5.m5.2a"><mrow id="S4.SS0.SSSx3.p7.5.m5.2.3" xref="S4.SS0.SSSx3.p7.5.m5.2.3.cmml"><mi id="S4.SS0.SSSx3.p7.5.m5.2.3.2" xref="S4.SS0.SSSx3.p7.5.m5.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx3.p7.5.m5.2.3.1" xref="S4.SS0.SSSx3.p7.5.m5.2.3.1.cmml">​</mo><mrow id="S4.SS0.SSSx3.p7.5.m5.2.3.3.2" xref="S4.SS0.SSSx3.p7.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p7.5.m5.2.3.3.2.1" xref="S4.SS0.SSSx3.p7.5.m5.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.5.m5.1.1" xref="S4.SS0.SSSx3.p7.5.m5.1.1a.cmml">a</mtext><mo id="S4.SS0.SSSx3.p7.5.m5.2.3.3.2.2" xref="S4.SS0.SSSx3.p7.5.m5.2.3.3.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.5.m5.2.2" xref="S4.SS0.SSSx3.p7.5.m5.2.2a.cmml">n</mtext><mo stretchy="false" id="S4.SS0.SSSx3.p7.5.m5.2.3.3.2.3" xref="S4.SS0.SSSx3.p7.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p7.5.m5.2b"><apply id="S4.SS0.SSSx3.p7.5.m5.2.3.cmml" xref="S4.SS0.SSSx3.p7.5.m5.2.3"><times id="S4.SS0.SSSx3.p7.5.m5.2.3.1.cmml" xref="S4.SS0.SSSx3.p7.5.m5.2.3.1"></times><ci id="S4.SS0.SSSx3.p7.5.m5.2.3.2.cmml" xref="S4.SS0.SSSx3.p7.5.m5.2.3.2">𝑑</ci><interval closure="open" id="S4.SS0.SSSx3.p7.5.m5.2.3.3.1.cmml" xref="S4.SS0.SSSx3.p7.5.m5.2.3.3.2"><ci id="S4.SS0.SSSx3.p7.5.m5.1.1a.cmml" xref="S4.SS0.SSSx3.p7.5.m5.1.1"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.5.m5.1.1.cmml" xref="S4.SS0.SSSx3.p7.5.m5.1.1">a</mtext></ci><ci id="S4.SS0.SSSx3.p7.5.m5.2.2a.cmml" xref="S4.SS0.SSSx3.p7.5.m5.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p7.5.m5.2.2.cmml" xref="S4.SS0.SSSx3.p7.5.m5.2.2">n</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p7.5.m5.2c">d(\textbf{{a}},\textbf{{n}})</annotation></semantics></math> computes the distance between the anchor and negative case matrices. The margin parameter <math id="S4.SS0.SSSx3.p7.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS0.SSSx3.p7.6.m6.1a"><mi id="S4.SS0.SSSx3.p7.6.m6.1.1" xref="S4.SS0.SSSx3.p7.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p7.6.m6.1b"><ci id="S4.SS0.SSSx3.p7.6.m6.1.1.cmml" xref="S4.SS0.SSSx3.p7.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p7.6.m6.1c">\alpha</annotation></semantics></math> ensures a minimum separation between the positive and negative cases.</p>
</div>
<div id="S4.SS0.SSSx3.p8" class="ltx_para">
<p id="S4.SS0.SSSx3.p8.8" class="ltx_p">Model <math id="S4.SS0.SSSx3.p8.1.m1.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S4.SS0.SSSx3.p8.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx3.p8.1.m1.1.1" xref="S4.SS0.SSSx3.p8.1.m1.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p8.1.m1.1b"><ci id="S4.SS0.SSSx3.p8.1.m1.1.1.cmml" xref="S4.SS0.SSSx3.p8.1.m1.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p8.1.m1.1c">\mathcal{Q}</annotation></semantics></math> was trained for 150 epochs using the <em id="S4.SS0.SSSx3.p8.8.1" class="ltx_emph ltx_font_italic">tanh</em> activation function and Adam optimizer with a learning rate of <math id="S4.SS0.SSSx3.p8.2.m2.1" class="ltx_Math" alttext="1\times 10^{-5}" display="inline"><semantics id="S4.SS0.SSSx3.p8.2.m2.1a"><mrow id="S4.SS0.SSSx3.p8.2.m2.1.1" xref="S4.SS0.SSSx3.p8.2.m2.1.1.cmml"><mn id="S4.SS0.SSSx3.p8.2.m2.1.1.2" xref="S4.SS0.SSSx3.p8.2.m2.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx3.p8.2.m2.1.1.1" xref="S4.SS0.SSSx3.p8.2.m2.1.1.1.cmml">×</mo><msup id="S4.SS0.SSSx3.p8.2.m2.1.1.3" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.cmml"><mn id="S4.SS0.SSSx3.p8.2.m2.1.1.3.2" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS0.SSSx3.p8.2.m2.1.1.3.3" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.cmml"><mo id="S4.SS0.SSSx3.p8.2.m2.1.1.3.3a" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.2" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p8.2.m2.1b"><apply id="S4.SS0.SSSx3.p8.2.m2.1.1.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1"><times id="S4.SS0.SSSx3.p8.2.m2.1.1.1.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.1"></times><cn type="integer" id="S4.SS0.SSSx3.p8.2.m2.1.1.2.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.2">1</cn><apply id="S4.SS0.SSSx3.p8.2.m2.1.1.3.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p8.2.m2.1.1.3.1.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS0.SSSx3.p8.2.m2.1.1.3.2.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.2">10</cn><apply id="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.3"><minus id="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.1.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.3"></minus><cn type="integer" id="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.2.cmml" xref="S4.SS0.SSSx3.p8.2.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p8.2.m2.1c">1\times 10^{-5}</annotation></semantics></math>. After training the <math id="S4.SS0.SSSx3.p8.3.m3.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S4.SS0.SSSx3.p8.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx3.p8.3.m3.1.1" xref="S4.SS0.SSSx3.p8.3.m3.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p8.3.m3.1b"><ci id="S4.SS0.SSSx3.p8.3.m3.1.1.cmml" xref="S4.SS0.SSSx3.p8.3.m3.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p8.3.m3.1c">\mathcal{Q}</annotation></semantics></math> model, it was utilized to generate binary monogram representations for new cases. This was done by applying <math id="S4.SS0.SSSx3.p8.4.m4.3" class="ltx_Math" alttext="\text{monogram}=\mathcal{Q}(\{\textbf{{u}},\textbf{{v}}\})" display="inline"><semantics id="S4.SS0.SSSx3.p8.4.m4.3a"><mrow id="S4.SS0.SSSx3.p8.4.m4.3.3" xref="S4.SS0.SSSx3.p8.4.m4.3.3.cmml"><mtext id="S4.SS0.SSSx3.p8.4.m4.3.3.3" xref="S4.SS0.SSSx3.p8.4.m4.3.3.3a.cmml">monogram</mtext><mo id="S4.SS0.SSSx3.p8.4.m4.3.3.2" xref="S4.SS0.SSSx3.p8.4.m4.3.3.2.cmml">=</mo><mrow id="S4.SS0.SSSx3.p8.4.m4.3.3.1" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSSx3.p8.4.m4.3.3.1.3" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.3.cmml">𝒬</mi><mo lspace="0em" rspace="0em" id="S4.SS0.SSSx3.p8.4.m4.3.3.1.2" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.2.cmml">​</mo><mrow id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.2" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.cmml">(</mo><mrow id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.2" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.2.1" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.1.cmml">{</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p8.4.m4.1.1" xref="S4.SS0.SSSx3.p8.4.m4.1.1a.cmml">u</mtext><mo id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.2.2" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.1.cmml">,</mo><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p8.4.m4.2.2" xref="S4.SS0.SSSx3.p8.4.m4.2.2a.cmml">v</mtext><mo stretchy="false" id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.2.3" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.1.cmml">}</mo></mrow><mo stretchy="false" id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.3" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p8.4.m4.3b"><apply id="S4.SS0.SSSx3.p8.4.m4.3.3.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3"><eq id="S4.SS0.SSSx3.p8.4.m4.3.3.2.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3.2"></eq><ci id="S4.SS0.SSSx3.p8.4.m4.3.3.3a.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3.3"><mtext id="S4.SS0.SSSx3.p8.4.m4.3.3.3.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3.3">monogram</mtext></ci><apply id="S4.SS0.SSSx3.p8.4.m4.3.3.1.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1"><times id="S4.SS0.SSSx3.p8.4.m4.3.3.1.2.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.2"></times><ci id="S4.SS0.SSSx3.p8.4.m4.3.3.1.3.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.3">𝒬</ci><set id="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.1.cmml" xref="S4.SS0.SSSx3.p8.4.m4.3.3.1.1.1.1.2"><ci id="S4.SS0.SSSx3.p8.4.m4.1.1a.cmml" xref="S4.SS0.SSSx3.p8.4.m4.1.1"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p8.4.m4.1.1.cmml" xref="S4.SS0.SSSx3.p8.4.m4.1.1">u</mtext></ci><ci id="S4.SS0.SSSx3.p8.4.m4.2.2a.cmml" xref="S4.SS0.SSSx3.p8.4.m4.2.2"><mtext class="ltx_mathvariant_bold-italic" id="S4.SS0.SSSx3.p8.4.m4.2.2.cmml" xref="S4.SS0.SSSx3.p8.4.m4.2.2">v</mtext></ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p8.4.m4.3c">\text{monogram}=\mathcal{Q}(\{\textbf{{u}},\textbf{{v}}\})</annotation></semantics></math>, where monogram represents an <math id="S4.SS0.SSSx3.p8.5.m5.1" class="ltx_Math" alttext="8\times 8" display="inline"><semantics id="S4.SS0.SSSx3.p8.5.m5.1a"><mrow id="S4.SS0.SSSx3.p8.5.m5.1.1" xref="S4.SS0.SSSx3.p8.5.m5.1.1.cmml"><mn id="S4.SS0.SSSx3.p8.5.m5.1.1.2" xref="S4.SS0.SSSx3.p8.5.m5.1.1.2.cmml">8</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx3.p8.5.m5.1.1.1" xref="S4.SS0.SSSx3.p8.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS0.SSSx3.p8.5.m5.1.1.3" xref="S4.SS0.SSSx3.p8.5.m5.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p8.5.m5.1b"><apply id="S4.SS0.SSSx3.p8.5.m5.1.1.cmml" xref="S4.SS0.SSSx3.p8.5.m5.1.1"><times id="S4.SS0.SSSx3.p8.5.m5.1.1.1.cmml" xref="S4.SS0.SSSx3.p8.5.m5.1.1.1"></times><cn type="integer" id="S4.SS0.SSSx3.p8.5.m5.1.1.2.cmml" xref="S4.SS0.SSSx3.p8.5.m5.1.1.2">8</cn><cn type="integer" id="S4.SS0.SSSx3.p8.5.m5.1.1.3.cmml" xref="S4.SS0.SSSx3.p8.5.m5.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p8.5.m5.1c">8\times 8</annotation></semantics></math> binary matrix (with encoding capability to cover <math id="S4.SS0.SSSx3.p8.6.m6.1" class="ltx_Math" alttext="2^{64}=1.8\times 10^{19}" display="inline"><semantics id="S4.SS0.SSSx3.p8.6.m6.1a"><mrow id="S4.SS0.SSSx3.p8.6.m6.1.1" xref="S4.SS0.SSSx3.p8.6.m6.1.1.cmml"><msup id="S4.SS0.SSSx3.p8.6.m6.1.1.2" xref="S4.SS0.SSSx3.p8.6.m6.1.1.2.cmml"><mn id="S4.SS0.SSSx3.p8.6.m6.1.1.2.2" xref="S4.SS0.SSSx3.p8.6.m6.1.1.2.2.cmml">2</mn><mn id="S4.SS0.SSSx3.p8.6.m6.1.1.2.3" xref="S4.SS0.SSSx3.p8.6.m6.1.1.2.3.cmml">64</mn></msup><mo id="S4.SS0.SSSx3.p8.6.m6.1.1.1" xref="S4.SS0.SSSx3.p8.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS0.SSSx3.p8.6.m6.1.1.3" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.cmml"><mn id="S4.SS0.SSSx3.p8.6.m6.1.1.3.2" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.2.cmml">1.8</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS0.SSSx3.p8.6.m6.1.1.3.1" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.1.cmml">×</mo><msup id="S4.SS0.SSSx3.p8.6.m6.1.1.3.3" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.cmml"><mn id="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.2" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.2.cmml">10</mn><mn id="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.3" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.3.cmml">19</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSSx3.p8.6.m6.1b"><apply id="S4.SS0.SSSx3.p8.6.m6.1.1.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1"><eq id="S4.SS0.SSSx3.p8.6.m6.1.1.1.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.1"></eq><apply id="S4.SS0.SSSx3.p8.6.m6.1.1.2.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p8.6.m6.1.1.2.1.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.2">superscript</csymbol><cn type="integer" id="S4.SS0.SSSx3.p8.6.m6.1.1.2.2.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.2.2">2</cn><cn type="integer" id="S4.SS0.SSSx3.p8.6.m6.1.1.2.3.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.2.3">64</cn></apply><apply id="S4.SS0.SSSx3.p8.6.m6.1.1.3.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3"><times id="S4.SS0.SSSx3.p8.6.m6.1.1.3.1.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.1"></times><cn type="float" id="S4.SS0.SSSx3.p8.6.m6.1.1.3.2.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.2">1.8</cn><apply id="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.1.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.3">superscript</csymbol><cn type="integer" id="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.2.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.2">10</cn><cn type="integer" id="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.3.cmml" xref="S4.SS0.SSSx3.p8.6.m6.1.1.3.3.3">19</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSSx3.p8.6.m6.1c">2^{64}=1.8\times 10^{19}</annotation></semantics></math> combinations) derived from the latent representations <span id="S4.SS0.SSSx3.p8.8.2" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">u</span> and <span id="S4.SS0.SSSx3.p8.8.3" class="ltx_text ltx_markedasmath ltx_font_bold ltx_font_italic">v</span> of the histopathology image and immune cell sequences, respectively.</p>
</div>
</section>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Competing Interests</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">The Authors declare no Competing Financial.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Data Availability</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p">The data used in this work is publicly available in The Cancer Genome Atlas (TCGA) (URL: https://portal.gdc.cancer.gov/).</p>
</div>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Author Contributions</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.1" class="ltx_p">AA implemented the approach, run all experiments and wrote the first draft of the paper. AS and SA contributed to implementation and experiments. HRT conceptually designed the approach, supervised the implementation and experiments, and wrote and rewrote large parts of the paper.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.1.1" class="ltx_bibitem">
<span class="ltx_bibblock"><span id="bib.1.1.1.1" class="ltx_ERROR undefined">\bibcommenthead</span>
</span>
</li>
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gun et al. [2019]</span>
<span class="ltx_bibblock">
Gun, S.Y.,
Lee, S.W.L.,
Sieow, J.L.,
Wong, S.C.:
Targeting immune cells for cancer therapy.
Redox biology
<span id="bib.bib1.1.1" class="ltx_text ltx_font_bold">25</span>,
101174
(2019)


</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beausang et al. [2017]</span>
<span class="ltx_bibblock">
Beausang, J.F.,
Wheeler, A.J.,
Chan, N.H.,
Hanft, V.R.,
Dirbas, F.M.,
Jeffrey, S.S.,
Quake, S.R.:
T cell receptor sequencing of early-stage breast cancer tumors identifies altered clonal structure of the t cell repertoire.
Proceedings of the National Academy of Sciences
<span id="bib.bib2.1.1" class="ltx_text ltx_font_bold">114</span>(48),
10409–10417
(2017)


</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pogorelyy et al. [2018]</span>
<span class="ltx_bibblock">
Pogorelyy, M.V.,
Fedorova, A.D.,
McLaren, J.E.,
Ladell, K.,
Bagaev, D.V.,
Eliseev, A.V.,
Mikelov, A.I.,
Koneva, A.E.,
Zvyagin, I.V.,
Price, D.A., <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">et al.</span>:
Exploring the pre-immune landscape of antigen-specific t cells.
Genome medicine
<span id="bib.bib3.2.2" class="ltx_text ltx_font_bold">10</span>(1),
1–14
(2018)


</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sidhom et al. [2021]</span>
<span class="ltx_bibblock">
Sidhom, J.-W.,
Larman, H.B.,
Pardoll, D.M.,
Baras, A.S.:
Deeptcr is a deep learning framework for revealing sequence concepts within t-cell repertoires.
Nature communications
<span id="bib.bib4.1.1" class="ltx_text ltx_font_bold">12</span>(1),
1–12
(2021)


</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Medzhitov and Janeway Jr [1997]</span>
<span class="ltx_bibblock">
Medzhitov, R.,
Janeway Jr, C.A.:
Innate immunity: impact on the adaptive immune response.
Current opinion in immunology
<span id="bib.bib5.1.1" class="ltx_text ltx_font_bold">9</span>(1),
4–9
(1997)


</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jung and Alt [2004]</span>
<span class="ltx_bibblock">
Jung, D.,
Alt, F.W.:
Unraveling v (d) j recombination: insights into gene regulation.
Cell
<span id="bib.bib6.1.1" class="ltx_text ltx_font_bold">116</span>(2),
299–311
(2004)


</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fridman et al. [2012]</span>
<span class="ltx_bibblock">
Fridman, W.H.,
Sautès-Fridman, C.,
Galon, J., <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">et al.</span>:
The immune contexture in human tumours: impact on clinical outcome.
Nature Reviews Cancer
<span id="bib.bib7.2.2" class="ltx_text ltx_font_bold">12</span>(4),
298–306
(2012)


</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leone and Powell [2020]</span>
<span class="ltx_bibblock">
Leone, R.D.,
Powell, J.D.:
Metabolism of immune cells in cancer.
Nature reviews cancer
<span id="bib.bib8.1.1" class="ltx_text ltx_font_bold">20</span>(9),
516–531
(2020)


</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alsaafin et al. [2023]</span>
<span class="ltx_bibblock">
Alsaafin, A.,
Babaie, M.,
Tizhoosh, H.:
Deep modality association learning using histopathology images and immune cell sequencing data.
In: Medical Imaging 2023: Digital and Computational Pathology,
vol. 12471,
pp. 354–361
(2023).
SPIE


</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beshnova et al. [2020]</span>
<span class="ltx_bibblock">
Beshnova, D.,
Ye, J.,
Onabolu, O.,
Moon, B.,
Zheng, W.,
Fu, Y.-X.,
Brugarolas, J.,
Lea, J.,
Li, B.:
De novo prediction of cancer-associated t cell receptors for noninvasive cancer detection.
Science translational medicine
<span id="bib.bib10.1.1" class="ltx_text ltx_font_bold">12</span>(557)
(2020)


</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Burger and Wiestner [2018]</span>
<span class="ltx_bibblock">
Burger, J.A.,
Wiestner, A.:
Targeting b cell receptor signalling in cancer: preclinical and clinical advances.
Nature Reviews Cancer
<span id="bib.bib11.1.1" class="ltx_text ltx_font_bold">18</span>(3),
148–167
(2018)


</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fischer et al. [2020]</span>
<span class="ltx_bibblock">
Fischer, D.S.,
Wu, Y.,
Schubert, B.,
Theis, F.J.:
Predicting antigen specificity of single t cells based on tcr cdr 3 regions.
Molecular systems biology
<span id="bib.bib12.1.1" class="ltx_text ltx_font_bold">16</span>(8),
9416
(2020)


</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alizadeh et al. [2015]</span>
<span class="ltx_bibblock">
Alizadeh, A.A.,
Aranda, V.,
Bardelli, A.,
Blanpain, C.,
Bock, C.,
Borowski, C.,
Caldas, C.,
Califano, A.,
Doherty, M.,
Elsner, M., <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">et al.</span>:
Toward understanding and exploiting tumor heterogeneity.
Nature medicine
<span id="bib.bib13.2.2" class="ltx_text ltx_font_bold">21</span>(8),
846–853
(2015)


</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalra et al. [2020]</span>
<span class="ltx_bibblock">
Kalra, S.,
Tizhoosh, H.R.,
Choi, C.,
Shah, S.,
Diamandis, P.,
Campbell, C.J.,
Pantanowitz, L.:
Yottixel–an image search engine for large archives of histopathology whole slide images.
Medical Image Analysis
<span id="bib.bib14.1.1" class="ltx_text ltx_font_bold">65</span>,
101757
(2020)


</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lahr et al. [2024]</span>
<span class="ltx_bibblock">
Lahr, I.,
Alfasly, S.,
Nejat, P.,
Khan, J.,
Kottom, L.,
Kumbhar, V.,
Alsaafin, A.,
Shafique, A.,
Hemati, S.,
Alabtah, G.,
Comfere, N.,
Murphree, D.,
Mangold, A.,
Yasir, S.,
Meroueh, C.,
Boardman, L.,
Shah, V.H.,
Garcia, J.J.,
Tizhoosh, H.R.:
Analysis and validation of image search engines in histopathology.
IEEE Reviews in Biomedical Engineering,
1–19
(2024)
<a target="_blank" href="https://doi.org/10.1109/RBME.2024.3425769" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/RBME.2024.3425769</a>


</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tizhoosh and Pantanowitz [2024]</span>
<span class="ltx_bibblock">
Tizhoosh, H.R.,
Pantanowitz, L.:
On image search in histopathology.
Journal of Pathology Informatics,
100375
(2024)


</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alsaafin et al. [2024]</span>
<span class="ltx_bibblock">
Alsaafin, A.,
Nejat, P.,
Shafique, A.,
Khan, J.,
Alfasly, S.,
Alabtah, G.,
Tizhoosh, H.R.:
Splice: Streamlining digital pathology image processing.
The American journal of pathology
(2024)


</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caron et al. [2021]</span>
<span class="ltx_bibblock">
Caron, M.,
Touvron, H.,
Misra, I.,
Jégou, H.,
Mairal, J.,
Bojanowski, P.,
Joulin, A.:
Emerging properties in self-supervised vision transformers.
In: Proceedings of the IEEE/CVF International Conference on Computer Vision,
pp. 9650–9660
(2021)


</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vale-Silva and Rohr [2021]</span>
<span class="ltx_bibblock">
Vale-Silva, L.A.,
Rohr, K.:
Long-term cancer survival prediction using multimodal deep learning.
Scientific Reports
<span id="bib.bib19.1.1" class="ltx_text ltx_font_bold">11</span>(1),
1–12
(2021)


</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. [2021]</span>
<span class="ltx_bibblock">
Song, L.,
Cohen, D.,
Ouyang, Z.,
Cao, Y.,
Hu, X.,
Liu, X.S.:
Trust4: immune repertoire reconstruction from bulk and single-cell rna-seq data.
Nature Methods
<span id="bib.bib20.1.1" class="ltx_text ltx_font_bold">18</span>(6),
627–630
(2021)


</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alsaafin and Tizhoosh [2024]</span>
<span class="ltx_bibblock">
Alsaafin, A.,
Tizhoosh, H.R.:
Harmonizing immune cell sequences for computational analysis with large language models.
Biology Methods and Protocols,
055
(2024)


</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.13114" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.13115" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.13115">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.13115" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.13116" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Oct  6 01:57:53 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
