<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.04207] 1 Introduction</title><meta property="og:description" content="Federated Learning (FL) is a practical approach to train deep learning models collaboratively across user-end devices, protecting user privacy by retaining raw data on-device. In FL, participating user-end devices are …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1 Introduction">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="1 Introduction">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.04207">

<!--Generated on Fri Apr  5 18:00:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">marginparsep has been altered.
<br class="ltx_break">topmargin has been altered.
<br class="ltx_break">marginparwidth has been altered.
<br class="ltx_break">marginparpush has been altered.
<br class="ltx_break"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">The page layout violates the ICML style.</span>
Please do not change the page layout, or include packages like geometry,
savetrees, or fullpage, which change it for you.
We’re not able to reliably undo arbitrary changes to the style. Please remove
the offending package(s), or layout-changing commands and try again.</p>
</div>
<div id="p3" class="ltx_para ltx_align_center">
<p id="p3.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div id="p4" class="ltx_para ltx_align_center">
<p id="p4.1" class="ltx_p"><span id="p4.1.1" class="ltx_text ltx_font_smallcaps">HeteroSwitch: Characterizing and Taming System-Induced Data Heterogeneity in Federated Learning</span></p>
</div>
<div id="p5" class="ltx_para ltx_align_center">
<p id="p5.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span></p>
</div>
<div id="p6" class="ltx_para">
<p id="p6.1" class="ltx_p ltx_align_center"><span id="p6.1.1" class="ltx_text ltx_font_bold">Gyudong Kim</span> <sup id="p6.1.2" class="ltx_sup">1 </sup> 
<span id="p6.1.3" class="ltx_text ltx_font_bold">Mehdi Ghasemi</span> <sup id="p6.1.4" class="ltx_sup">2 </sup> 
<span id="p6.1.5" class="ltx_text ltx_font_bold">Soroush Heidari</span> <sup id="p6.1.6" class="ltx_sup">2 </sup> 
<span id="p6.1.7" class="ltx_text ltx_font_bold">Seungryong Kim</span> <sup id="p6.1.8" class="ltx_sup">1 </sup> 
<span id="p6.1.9" class="ltx_text ltx_font_bold">Young Geun Kim</span> <sup id="p6.1.10" class="ltx_sup">1 </sup> 
<span id="p6.1.11" class="ltx_text ltx_font_bold">Sarma Vrudhula</span> <sup id="p6.1.12" class="ltx_sup">2 </sup> 
<span id="p6.1.13" class="ltx_text ltx_font_bold">Carole-Jean Wu</span> <sup id="p6.1.14" class="ltx_sup">3 </sup></p>
</div>
<div id="p7" class="ltx_para ltx_noindent">
<br class="ltx_break">
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated Learning (FL) is a practical approach to train deep learning models collaboratively across user-end devices, protecting user privacy by retaining raw data on-device. In FL, participating user-end devices are highly fragmented in terms of hardware and software configurations. Such fragmentation introduces a new type of data heterogeneity in FL, namely <span id="id1.id1.1" class="ltx_text ltx_font_italic">system-induced data heterogeneity</span>, as each device generates distinct data depending on its hardware and software configurations. In this paper, we first characterize the impact of system-induced data heterogeneity on FL model performance. We collect a dataset using heterogeneous devices with variations across vendors and performance tiers. By using this dataset, we demonstrate that <span id="id1.id1.2" class="ltx_text ltx_font_italic">system-induced data heterogeneity</span> negatively impacts accuracy, and deteriorates fairness and domain generalization problems in FL. To address these challenges, we propose HeteroSwitch, which adaptively adopts generalization techniques (i.e., ISP transformation and SWAD) depending on the level of bias caused by varying HW and SW configurations. In our evaluation with a realistic FL dataset (FLAIR), HeteroSwitch reduces the variance of averaged precision by 6.3% across device types.</p>
</div>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span>
<sup id="footnotex1.2" class="ltx_sup">1</sup>Korea University.
<sup id="footnotex1.3" class="ltx_sup">2</sup>Arizona State University.
<sup id="footnotex1.4" class="ltx_sup">3</sup>Meta. Work done while at ASU.
Correspondence to: Young Geun Kim &lt;younggeun_kim@korea.ac.kr&gt;.
 
<br class="ltx_break">
<span id="footnotex1.1" class="ltx_text ltx_font_italic">Proceedings of the
<math id="footnotex1.1.m1.1" class="ltx_Math" alttext="\mathit{5}^{th}" display="inline"><semantics id="footnotex1.1.m1.1b"><msup id="footnotex1.1.m1.1.1" xref="footnotex1.1.m1.1.1.cmml"><mn class="ltx_mathvariant_italic" mathvariant="italic" id="footnotex1.1.m1.1.1.2" xref="footnotex1.1.m1.1.1.2.cmml">5</mn><mrow id="footnotex1.1.m1.1.1.3" xref="footnotex1.1.m1.1.1.3.cmml"><mi id="footnotex1.1.m1.1.1.3.2" xref="footnotex1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="footnotex1.1.m1.1.1.3.1" xref="footnotex1.1.m1.1.1.3.1.cmml">​</mo><mi id="footnotex1.1.m1.1.1.3.3" xref="footnotex1.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="footnotex1.1.m1.1c"><apply id="footnotex1.1.m1.1.1.cmml" xref="footnotex1.1.m1.1.1"><csymbol cd="ambiguous" id="footnotex1.1.m1.1.1.1.cmml" xref="footnotex1.1.m1.1.1">superscript</csymbol><cn type="integer" id="footnotex1.1.m1.1.1.2.cmml" xref="footnotex1.1.m1.1.1.2">5</cn><apply id="footnotex1.1.m1.1.1.3.cmml" xref="footnotex1.1.m1.1.1.3"><times id="footnotex1.1.m1.1.1.3.1.cmml" xref="footnotex1.1.m1.1.1.3.1"></times><ci id="footnotex1.1.m1.1.1.3.2.cmml" xref="footnotex1.1.m1.1.1.3.2">𝑡</ci><ci id="footnotex1.1.m1.1.1.3.3.cmml" xref="footnotex1.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnotex1.1.m1.1d">\mathit{5}^{th}</annotation></semantics></math> MLSys Conference</span>,
Santa Clara, CA, USA, 2024.
Copyright 2024 by the author(s).</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) enables mobile devices to collaboratively train a shared machine learning (ML) model while keeping all the raw data on device <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib40" title="" class="ltx_ref">2017</a>); Kairouz et al. (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. As only the model gradients are shared with the cloud servers for updating the shared global model, FL has been considered as a practical way to prevent the privacy leakage <cite class="ltx_cite ltx_citemacro_cite">Kairouz et al. (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>); Huba et al. (<a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>. Although FL has gained much attention in various applications, such as computer vision <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite>, voice recognition <cite class="ltx_cite ltx_citemacro_cite">Guliani et al. (<a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>, health monitoring <cite class="ltx_cite ltx_citemacro_cite">Brisimi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>, and recommender system <cite class="ltx_cite ltx_citemacro_cite">Hejazinia et al. (<a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite>, the following key challenges make FL deployment less practical: high degree of system and data heterogeneity causing unstable and degraded performance of the global model <cite class="ltx_cite ltx_citemacro_cite">Kim &amp; Wu (<a href="#bib.bib27" title="" class="ltx_ref">2021</a>); Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p"><span id="S1.p2.1.1" class="ltx_text ltx_font_bold">Data heterogeneity:</span> In FL, the size and distributions of training data can be significantly heterogeneous depending on the geographical locations, cultural backgrounds, personal habits, and device usage patterns of participating users <cite class="ltx_cite ltx_citemacro_cite">Kairouz et al. (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. For example, in a handwriting recognition scenario, users who write the same words exhibit differences in stroke width and slant. Such data heterogeneity can lead to imbalanced and biased model updates <cite class="ltx_cite ltx_citemacro_cite">Wu &amp; Wang (<a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite>, eventually degrading the overall model performance <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib58" title="" class="ltx_ref">2018</a>)</cite> or resulting in disparate accuracy across devices <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>. Thus, many prior works have tried to mitigate the data heterogeneity by adopting a regularization method to local models <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, sharing a small amount of public data across local clients <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib58" title="" class="ltx_ref">2018</a>); Mansour et al. (<a href="#bib.bib39" title="" class="ltx_ref">2020</a>)</cite>, or employing weighted averaging for model aggregation <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/fig1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="568" height="460" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>End-to-end ISP pipeline for a vision DNN. Devices generate <span id="S1.F1.3.1" class="ltx_text ltx_font_italic">heterogeneous data</span> due to the <span id="S1.F1.4.2" class="ltx_text ltx_font_italic">SW and HW variations</span>, degrading model performance significantly.The accuracy of Homogeneous Client is obtained when FL devices are the same type, whereas Heterogeneous Client is obtained with different devices types.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p"><span id="S1.p3.1.1" class="ltx_text ltx_font_bold">System-induced data heterogeneity:</span> In FL, the hardware of client devices can also be highly diverse: there are more than ten thousand devices with different SoCs, sensors, and software systems in the market <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib54" title="" class="ltx_ref">2019</a>); Kim &amp; Wu (<a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>. Such system heterogeneity introduces a new type of data heterogeneity, namely <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">system-induced data heterogeneity</span>, in FL. For example, in case of vision tasks, heterogeneous sensor hardware can produce noticeably different training data (i.e., images) even for the same scene or object, due to the respective attributes such as focal length, aperture, and other variables (see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). The difference across the training data can get even more severe due to the fragmented image signal processing (ISP) algorithms employed onto the devices. This new type of data heterogeneity eventually contributes to bias across the local models, resulting in significant model performance degradation (by 23.5%, on average, as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Despite the significant impact, system-induced data heterogeneity has been overlooked in FL research. Most prior works have primarily focused on label distribution skew, where a non-IID dataset is formed by partitioning a flat existing dataset based on the labels <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2020</a>); Zhao et al. (<a href="#bib.bib58" title="" class="ltx_ref">2018</a>); Mansour et al. (<a href="#bib.bib39" title="" class="ltx_ref">2020</a>); Li et al. (<a href="#bib.bib32" title="" class="ltx_ref">2019</a>); McMahan et al. (<a href="#bib.bib40" title="" class="ltx_ref">2017</a>); Karimireddy et al. (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>. Hence, they cannot consider the characterization of cross-client heterogeneity which should be inherently included in the real-world FL datasets while significantly degrading the model performance.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Furthermore, such system-induced data heterogeneity deteriorates two notable problems in FL: fairness and domain generalization. In FL, fairness involves ensuring that the global-model fairly represents the learning from all devices and is not biased towards any particular device or group of devices <cite class="ltx_cite ltx_citemacro_cite">Pessach &amp; Shmueli (<a href="#bib.bib43" title="" class="ltx_ref">2022</a>); Maeng et al. (<a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite>. Domain generalization (DG), meanwhile, involves designing machine learning models that can generalize well to new, unseen domains <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a href="#bib.bib53" title="" class="ltx_ref">2022</a>)</cite>. In the context of FL, the domain can be a particular type of devices, each displaying unique characteristics due to system-induced data heterogeneity.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">In this paper, we first characterize the impact of system-induced data heterogeneity for FL. We collect a vision dataset using a collection of devices of heterogeneous hardware<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The dataset will be open-sourced upon the acceptance to encourage further research in this domain.</span></span></span>. By using the collected dataset, we analyze the variations and inconsistencies in the global model that arise due to system-induced data heterogeneity originated from hardware (HW) (i.e., sensors) and software (i.e., ISP algorithms) heterogeneity. We also investigate fairness and domain generalization implications which can stem from system-induced data heterogeneity in realistic FL environments. Based on the characterization results, we propose HeteroSwitch — a selective generalization method that combine the ISP transformation and SWAD — which counteracts the effects of system-induced data heterogeneity in FL. Compared with the baseline, HeteroSwitch reduces the variance of accuracy across device types by 79.5%, while improving the worst out-of-distribution (OOD) accuracy by 5.8%.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p"><span id="S1.p7.1.1" class="ltx_text ltx_font_bold">Key Contributions:</span>
We summarize the main contributions of this work as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We create a new dataset that takes into account client devices of heterogeneous hardware to independently identify the impact of system-induced data heterogeneity. We attempt to discern the most influential factors contributing to system-induced data heterogeneity in FL models during the data generation process, and examine the impact of <span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">system-induced heterogeneity</span> on the FL model.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We investigate the fairness and domain generalization implications which can be deteriorated by system-induced data heterogeneity.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Based on the analysis, we propose HeteroSwitch. By switching the use of generalization techniques in an FL environment where each device possesses heterogeneous data, HeteroSwitch effectively mitigates the model performance degradation caused by system-induced data heterogeneity.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">Federated Learning (FL) provides a privacy-preserving alternative to conventional machine learning, allowing for collaborative model training across various devices while keeping the data locally stored <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>. Given N local client devices, a server first initializes a global deep learning model and its global parameters by specifying the number of local training epochs E, the local training minibatch size B, and the number of participant devices K. (B, E, K) is determined by FL-based services <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>. In each training round, the server selects <span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_italic">K</span> devices from the total <span id="S2.SS1.p1.1.2" class="ltx_text ltx_font_italic">N</span> devices. The global model is then broadcast to the selected devices. Each selected device locally trains the model using its data samples with the batch size <span id="S2.SS1.p1.1.3" class="ltx_text ltx_font_italic">B</span> over <span id="S2.SS1.p1.1.4" class="ltx_text ltx_font_italic">E</span> epochs. Once training is completed, the devices send the model gradients back to the server. The server averages these gradients to update the global model. This process is repeated until the desired accuracy is achieved.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>ISP Pipeline</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">In FL, images collected by each client are used for local-model training. Each device produces different images depending on a wide range of hardware and software. Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> depicts the process from image capturing to the formation of a tensor to be used by the training of a DNN or for inference. (1) At the beginning, the image sensor records the light signal as RAW data based on its properties like focal length, aperture, pixel size, and resolution. (2) After that, a series of image signal processing (ISP) stages (i.e., from Demosaic to Compress in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) are applied to the RAW data to produce a human visible image <cite class="ltx_cite ltx_citemacro_cite">Buckler et al. (<a href="#bib.bib3" title="" class="ltx_ref">2017</a>); Hansen et al. (<a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>.
The ISP stages include:</p>
<ul id="S2.I1" class="ltx_itemize">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.1" class="ltx_p"><span id="S2.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Demosaicing</span> converts RAW data into a color image.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.1" class="ltx_p"><span id="S2.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Denoising</span> removes noise from the image.</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p id="S2.I1.i3.p1.1" class="ltx_p"><span id="S2.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Color transformation</span> (i.e., White Balance adjustments) corrects the colors in the image to make them natural <cite class="ltx_cite ltx_citemacro_cite">Wyszecki &amp; Stiles (<a href="#bib.bib56" title="" class="ltx_ref">2000</a>)</cite>.</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i4.p1" class="ltx_para">
<p id="S2.I1.i4.p1.1" class="ltx_p"><span id="S2.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Color transformation</span> (Gamut mapping) converts the colors of the image to a standard gamut.</p>
</div>
</li>
<li id="S2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i5.p1" class="ltx_para">
<p id="S2.I1.i5.p1.1" class="ltx_p"><span id="S2.I1.i5.p1.1.1" class="ltx_text ltx_font_bold">Tone transformation</span> adjusts the brightness and contrast of the image.</p>
</div>
</li>
<li id="S2.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i6.p1" class="ltx_para">
<p id="S2.I1.i6.p1.1" class="ltx_p"><span id="S2.I1.i6.p1.1.1" class="ltx_text ltx_font_bold">Image compression</span> reduces file size while attempting to maintain image quality.</p>
</div>
</li>
</ul>
<p id="S2.SS2.p1.2" class="ltx_p">(3) Finally, the images are transformed to a tensor to be used by model training or inference.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p">In FL, the heterogeneous combination of sensors and ISP algorithms from the large collection of client devices cause system-induced data heterogeneity.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>System-induced Data Heterogeneity in FL</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">This section characterizes the impact of system-induced data heterogeneity on FL. We create a novel image dataset by collecting images using a collection of representative devices of different system hardware characteristics (Section <a href="#S3.SS1" title="3.1 Dataset Creation ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). By using the dataset, we analyze how system-induced data heterogeneity introduces bias on the global model in FL (Section <a href="#S3.SS2" title="3.2 Data Heterogeneity across Device type ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>). We also attempt to discern the most influential factors contributing to system-induced data heterogeneity during the data generation process (Section <a href="#S3.F2" title="Figure 2 ‣ 3.3 Deeper Look at Heterogeneity: HW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#S3.T3" title="Table 3 ‣ 3.4 Deeper Look at Heterogeneity: SW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Mobile devices used in dataset creation, categorized by performance tiers and vendors. (N%) indicates the market share of respective device. H, M, and L represents high-end, mid-end, and low-end devices, respectively.</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S3.T1.1.1.1.1.1" class="ltx_text">Level</span></th>
<th id="S3.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">Vendor</th>
</tr>
<tr id="S3.T1.1.2.2" class="ltx_tr">
<th id="S3.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Samsung</th>
<th id="S3.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">LG</th>
<th id="S3.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Google</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.3.1" class="ltx_tr">
<th id="S3.T1.1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">H</th>
<td id="S3.T1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">GalaxyS22 (12%)</td>
<td id="S3.T1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">VELVET (2%)</td>
<td id="S3.T1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Pixel5 (1%)</td>
</tr>
<tr id="S3.T1.1.4.2" class="ltx_tr">
<th id="S3.T1.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">M</th>
<td id="S3.T1.1.4.2.2" class="ltx_td ltx_align_center">GalaxyS9 (27%)</td>
<td id="S3.T1.1.4.2.3" class="ltx_td ltx_align_center">G7 (5%)</td>
<td id="S3.T1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">Pixel2 (3%)</td>
</tr>
<tr id="S3.T1.1.5.3" class="ltx_tr">
<th id="S3.T1.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">L</th>
<td id="S3.T1.1.5.3.2" class="ltx_td ltx_align_center ltx_border_b">GalaxyS6 (38%)</td>
<td id="S3.T1.1.5.3.3" class="ltx_td ltx_align_center ltx_border_b">G4 (8%)</td>
<td id="S3.T1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Nexus5X (4%)</td>
</tr>
</tbody>
</table>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Dataset Creation</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">To isolate and examine the impact of system-induced data heterogeneity on FL, we create a custom dataset by using a total of nine smartphones (Table <a href="#S3.T1" title="Table 1 ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). We select three smartphones from each of the three different vendors — Samsung, LG, and Google, representing high-end (H), mid-end (M), and low-end (L) categories with at least two-year gaps between their release dates <cite class="ltx_cite ltx_citemacro_cite">Kim &amp; Wu (<a href="#bib.bib26" title="" class="ltx_ref">2020</a>; <a href="#bib.bib27" title="" class="ltx_ref">2021</a>); Wu et al. (<a href="#bib.bib54" title="" class="ltx_ref">2019</a>)</cite> — by introducing variations across vendors and performance tiers, we emulate a realistic device composition for FL and assess how device heterogeneity contributes to system-induced data heterogeneity.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p">Each device is fixed with tripod, and used to capture images displayed on a monitor in a dark room — to isolate the impact of system-induced data heterogeneity and to prevent a potential introduction of the other types of feature distribution skew, we controlled other external factors (e.g., lighting, position, and object being photographed) that may affect the captured images <cite class="ltx_cite ltx_citemacro_cite">Cidon et al. (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>); Zhang et al. (<a href="#bib.bib57" title="" class="ltx_ref">2016</a>)</cite>. For the images, we use 12 non-overlapping ImageNet <cite class="ltx_cite ltx_citemacro_cite">Deng et al. (<a href="#bib.bib11" title="" class="ltx_ref">2009</a>)</cite> classes from 12 higher-level categories for the images displayed: Chihuahua, Altar, Cock, Abaya, Ambulance, Loggerhead, Timber Wolf, Tiger Beetle, Accordion, French Loaf, Barber Chair, and Orangutan.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.1" class="ltx_p">This dataset is compact, yet sufficiently challenging to learn with a higher number of labels and larger image sizes compared to datasets used in previous FL works <cite class="ltx_cite ltx_citemacro_cite">LeCun (<a href="#bib.bib31" title="" class="ltx_ref">1998</a>); Krizhevsky et al. (<a href="#bib.bib28" title="" class="ltx_ref">2009</a>); Cohen et al. (<a href="#bib.bib8" title="" class="ltx_ref">2017</a>); Scheuerman et al. (<a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>. To separate the impact of hardware (HW) and software (SW) differences, we collected both RAW data (i.e. unprocessed and uncompressed data directly obtained from the image sensor without employing the ISP algorithms) and images processed by the default camera application of each device.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Model quality degradation in model when deployed to various device types, compared to the training device type.</figcaption>
<br class="ltx_break">
<table id="S3.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.1.1.1" class="ltx_tr">
<th id="S3.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S3.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Train on</span></th>
<td id="S3.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="9"><span id="S3.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Test on (Model Quality Degradation)</span></td>
<td id="S3.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="S3.T2.1.1.1.3.1" class="ltx_text">
<span id="S3.T2.1.1.1.3.1.1" class="ltx_tabular ltx_align_middle">
<span id="S3.T2.1.1.1.3.1.1.1" class="ltx_tr">
<span id="S3.T2.1.1.1.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T2.1.1.1.3.1.1.1.1.1" class="ltx_text ltx_font_bold">Mean</span></span></span>
<span id="S3.T2.1.1.1.3.1.1.2" class="ltx_tr">
<span id="S3.T2.1.1.1.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S3.T2.1.1.1.3.1.1.2.1.1" class="ltx_text ltx_font_bold">Others</span></span></span>
</span></span></td>
</tr>
<tr id="S3.T2.1.2.2" class="ltx_tr">
<td id="S3.T2.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">Pixel5</td>
<td id="S3.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Pixel2</td>
<td id="S3.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">Nexus5X</td>
<td id="S3.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">VELVET</td>
<td id="S3.T2.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">G7</td>
<td id="S3.T2.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">G4</td>
<td id="S3.T2.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">S22</td>
<td id="S3.T2.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t">S9</td>
<td id="S3.T2.1.2.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">S6</td>
</tr>
<tr id="S3.T2.1.3.3" class="ltx_tr">
<th id="S3.T2.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Pixel5</th>
<td id="S3.T2.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.1.3.3.2.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">5.7%</td>
<td id="S3.T2.1.3.3.4" class="ltx_td ltx_align_center ltx_border_t">21.3%</td>
<td id="S3.T2.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t">10.0%</td>
<td id="S3.T2.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t">20.0%</td>
<td id="S3.T2.1.3.3.7" class="ltx_td ltx_align_center ltx_border_t">21.2%</td>
<td id="S3.T2.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t">22.4%</td>
<td id="S3.T2.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t">12.9%</td>
<td id="S3.T2.1.3.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24.6%</td>
<td id="S3.T2.1.3.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">17.3%</td>
</tr>
<tr id="S3.T2.1.4.4" class="ltx_tr">
<th id="S3.T2.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Pixel2</th>
<td id="S3.T2.1.4.4.2" class="ltx_td ltx_align_center">1.0%</td>
<td id="S3.T2.1.4.4.3" class="ltx_td ltx_align_center"><span id="S3.T2.1.4.4.3.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.4.4.4" class="ltx_td ltx_align_center">11.4%</td>
<td id="S3.T2.1.4.4.5" class="ltx_td ltx_align_center">5.2%</td>
<td id="S3.T2.1.4.4.6" class="ltx_td ltx_align_center">11.8%</td>
<td id="S3.T2.1.4.4.7" class="ltx_td ltx_align_center">14.1%</td>
<td id="S3.T2.1.4.4.8" class="ltx_td ltx_align_center">19.0%</td>
<td id="S3.T2.1.4.4.9" class="ltx_td ltx_align_center">10.5%</td>
<td id="S3.T2.1.4.4.10" class="ltx_td ltx_align_center ltx_border_r">15.3%</td>
<td id="S3.T2.1.4.4.11" class="ltx_td ltx_align_center ltx_border_r">11.0%</td>
</tr>
<tr id="S3.T2.1.5.5" class="ltx_tr">
<th id="S3.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Nexus5X</th>
<td id="S3.T2.1.5.5.2" class="ltx_td ltx_align_center">28.1%</td>
<td id="S3.T2.1.5.5.3" class="ltx_td ltx_align_center">19.6%</td>
<td id="S3.T2.1.5.5.4" class="ltx_td ltx_align_center"><span id="S3.T2.1.5.5.4.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.5.5.5" class="ltx_td ltx_align_center">24.9%</td>
<td id="S3.T2.1.5.5.6" class="ltx_td ltx_align_center">6.7%</td>
<td id="S3.T2.1.5.5.7" class="ltx_td ltx_align_center">33.9%</td>
<td id="S3.T2.1.5.5.8" class="ltx_td ltx_align_center">43.0%</td>
<td id="S3.T2.1.5.5.9" class="ltx_td ltx_align_center">20.2%</td>
<td id="S3.T2.1.5.5.10" class="ltx_td ltx_align_center ltx_border_r">19.8%</td>
<td id="S3.T2.1.5.5.11" class="ltx_td ltx_align_center ltx_border_r">24.5%</td>
</tr>
<tr id="S3.T2.1.6.6" class="ltx_tr">
<th id="S3.T2.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">VELVET</th>
<td id="S3.T2.1.6.6.2" class="ltx_td ltx_align_center">9.4%</td>
<td id="S3.T2.1.6.6.3" class="ltx_td ltx_align_center">10.8%</td>
<td id="S3.T2.1.6.6.4" class="ltx_td ltx_align_center">15.6%</td>
<td id="S3.T2.1.6.6.5" class="ltx_td ltx_align_center"><span id="S3.T2.1.6.6.5.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.6.6.6" class="ltx_td ltx_align_center">11.0%</td>
<td id="S3.T2.1.6.6.7" class="ltx_td ltx_align_center">11.9%</td>
<td id="S3.T2.1.6.6.8" class="ltx_td ltx_align_center">20.6%</td>
<td id="S3.T2.1.6.6.9" class="ltx_td ltx_align_center">4.3%</td>
<td id="S3.T2.1.6.6.10" class="ltx_td ltx_align_center ltx_border_r">18.7%</td>
<td id="S3.T2.1.6.6.11" class="ltx_td ltx_align_center ltx_border_r">12.8%</td>
</tr>
<tr id="S3.T2.1.7.7" class="ltx_tr">
<th id="S3.T2.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">G7</th>
<td id="S3.T2.1.7.7.2" class="ltx_td ltx_align_center">32.7%</td>
<td id="S3.T2.1.7.7.3" class="ltx_td ltx_align_center">21.3%</td>
<td id="S3.T2.1.7.7.4" class="ltx_td ltx_align_center">12.5%</td>
<td id="S3.T2.1.7.7.5" class="ltx_td ltx_align_center">17.7%</td>
<td id="S3.T2.1.7.7.6" class="ltx_td ltx_align_center"><span id="S3.T2.1.7.7.6.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.7.7.7" class="ltx_td ltx_align_center">19.1%</td>
<td id="S3.T2.1.7.7.8" class="ltx_td ltx_align_center">42.7%</td>
<td id="S3.T2.1.7.7.9" class="ltx_td ltx_align_center">11.6%</td>
<td id="S3.T2.1.7.7.10" class="ltx_td ltx_align_center ltx_border_r">17.9%</td>
<td id="S3.T2.1.7.7.11" class="ltx_td ltx_align_center ltx_border_r">21.9%</td>
</tr>
<tr id="S3.T2.1.8.8" class="ltx_tr">
<th id="S3.T2.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">G4</th>
<td id="S3.T2.1.8.8.2" class="ltx_td ltx_align_center">14.0%</td>
<td id="S3.T2.1.8.8.3" class="ltx_td ltx_align_center">17.3%</td>
<td id="S3.T2.1.8.8.4" class="ltx_td ltx_align_center">16.7%</td>
<td id="S3.T2.1.8.8.5" class="ltx_td ltx_align_center">13.5%</td>
<td id="S3.T2.1.8.8.6" class="ltx_td ltx_align_center">15.8%</td>
<td id="S3.T2.1.8.8.7" class="ltx_td ltx_align_center"><span id="S3.T2.1.8.8.7.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.8.8.8" class="ltx_td ltx_align_center">26.8%</td>
<td id="S3.T2.1.8.8.9" class="ltx_td ltx_align_center">12.0%</td>
<td id="S3.T2.1.8.8.10" class="ltx_td ltx_align_center ltx_border_r">13.6%</td>
<td id="S3.T2.1.8.8.11" class="ltx_td ltx_align_center ltx_border_r">16.2%</td>
</tr>
<tr id="S3.T2.1.9.9" class="ltx_tr">
<th id="S3.T2.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">S22</th>
<td id="S3.T2.1.9.9.2" class="ltx_td ltx_align_center">25.8%</td>
<td id="S3.T2.1.9.9.3" class="ltx_td ltx_align_center">21.4%</td>
<td id="S3.T2.1.9.9.4" class="ltx_td ltx_align_center">25.9%</td>
<td id="S3.T2.1.9.9.5" class="ltx_td ltx_align_center">18.4%</td>
<td id="S3.T2.1.9.9.6" class="ltx_td ltx_align_center">20.5%</td>
<td id="S3.T2.1.9.9.7" class="ltx_td ltx_align_center">26.4%</td>
<td id="S3.T2.1.9.9.8" class="ltx_td ltx_align_center"><span id="S3.T2.1.9.9.8.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.9.9.9" class="ltx_td ltx_align_center">21.9%</td>
<td id="S3.T2.1.9.9.10" class="ltx_td ltx_align_center ltx_border_r">35.8%</td>
<td id="S3.T2.1.9.9.11" class="ltx_td ltx_align_center ltx_border_r">24.5%</td>
</tr>
<tr id="S3.T2.1.10.10" class="ltx_tr">
<th id="S3.T2.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">S9</th>
<td id="S3.T2.1.10.10.2" class="ltx_td ltx_align_center">29.6%</td>
<td id="S3.T2.1.10.10.3" class="ltx_td ltx_align_center">25.5%</td>
<td id="S3.T2.1.10.10.4" class="ltx_td ltx_align_center">14.7%</td>
<td id="S3.T2.1.10.10.5" class="ltx_td ltx_align_center">10.6%</td>
<td id="S3.T2.1.10.10.6" class="ltx_td ltx_align_center">11.1%</td>
<td id="S3.T2.1.10.10.7" class="ltx_td ltx_align_center">29.4%</td>
<td id="S3.T2.1.10.10.8" class="ltx_td ltx_align_center">50.7%</td>
<td id="S3.T2.1.10.10.9" class="ltx_td ltx_align_center"><span id="S3.T2.1.10.10.9.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.10.10.10" class="ltx_td ltx_align_center ltx_border_r">16.4%</td>
<td id="S3.T2.1.10.10.11" class="ltx_td ltx_align_center ltx_border_r">23.5%</td>
</tr>
<tr id="S3.T2.1.11.11" class="ltx_tr">
<th id="S3.T2.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">S6</th>
<td id="S3.T2.1.11.11.2" class="ltx_td ltx_align_center">29.2%</td>
<td id="S3.T2.1.11.11.3" class="ltx_td ltx_align_center">24.9%</td>
<td id="S3.T2.1.11.11.4" class="ltx_td ltx_align_center">15.5%</td>
<td id="S3.T2.1.11.11.5" class="ltx_td ltx_align_center">24.7%</td>
<td id="S3.T2.1.11.11.6" class="ltx_td ltx_align_center">9.8%</td>
<td id="S3.T2.1.11.11.7" class="ltx_td ltx_align_center">17.2%</td>
<td id="S3.T2.1.11.11.8" class="ltx_td ltx_align_center">43.7%</td>
<td id="S3.T2.1.11.11.9" class="ltx_td ltx_align_center">17.2%</td>
<td id="S3.T2.1.11.11.10" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.1.11.11.10.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T2.1.11.11.11" class="ltx_td ltx_align_center ltx_border_r">22.8%</td>
</tr>
<tr id="S3.T2.1.12.12" class="ltx_tr">
<th id="S3.T2.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="S3.T2.1.12.12.1.1" class="ltx_text ltx_font_bold">Mean Others</span></th>
<td id="S3.T2.1.12.12.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">21.2%</td>
<td id="S3.T2.1.12.12.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">18.3%</td>
<td id="S3.T2.1.12.12.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">16.7%</td>
<td id="S3.T2.1.12.12.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">15.6%</td>
<td id="S3.T2.1.12.12.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">13.3%</td>
<td id="S3.T2.1.12.12.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">21.7%</td>
<td id="S3.T2.1.12.12.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">33.6%</td>
<td id="S3.T2.1.12.12.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">13.8%</td>
<td id="S3.T2.1.12.12.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">20.3%</td>
<td id="S3.T2.1.12.12.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">19.4%</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Data Heterogeneity across Device type</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">In FL, system-induced data heterogeneity can create significant bias across different device types. Table <a href="#S3.T2" title="Table 2 ‣ 3.1 Dataset Creation ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows quality degradation of the global model across various device types, compared to when the model is tested on the same device type it was trained on. The quality of the model is measured by its accuracy on each deployed device. Each row represents the device type used by the clients for training the global model, while each column shows the device type used for testing the trained global model. The Mean Others of each device refers to the average model quality degradation on all devices except the device itself — the degradation indicates how easily the model is affected by <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_italic">system-induced heterogeneity</span> alone. The highest accuracy is always achieved when the model is tested on the same device type it was trained on, and there is an observable drop (1.0% <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mo id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\sim</annotation></semantics></math> 50.7%) in accuracy when the model is tested on the others.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p">In Table <a href="#S3.T2" title="Table 2 ‣ 3.1 Dataset Creation ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the model quality degradation depends on the device type. For example, when the model trained on a G7 is tested on Pixel5, the accuracy degrades by 32.7% — the accuracy degrades by 20.0% for the reverse case. This is because the two devices are using significantly different hardware (i.e., camera sensors) and software (i.e., ISP algorithms). On the other hand, Pixel 5 and Pixel 2, which have the smallest differences in HW and SW, show the least model quality degradation when tested on each other (5.7% and 1.0%, respectively). These results demonstrate the unique feature of the <span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_italic">system-induced heterogeneity</span> which depends on the heterogeneous sensor hardware and ISP algorithms.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">To better understand the system-induced data heterogeneity effect, we further investigate its two primary sources in the next subsection: 1) HW (i.e., lens and sensor) variations and 2) SW (i.e., ISP algorithm) variations.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Deeper Look at Heterogeneity: HW</h3>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/fig2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="217" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Model quality degradation in model when deployed to various device types using RAW data.</figcaption>
</figure>
<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.1" class="ltx_p">In this subsection, we further investigate the impact of HW variations on the data and the trained model performance. To focus on the impact of HW, especially the type of sensors used, we exclude the impact of SW by training the model with RAW data (i.e. unprocessed and uncompressed data directly obtained from the image sensor without employing the ISP algorithms).</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.1" class="ltx_p">The image sensor heterogeneity is a significant source of the data discrepancy. Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.3 Deeper Look at Heterogeneity: HW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> represents the model quality degradation on each target device, when the model is trained with RAW data of the other devices. The x-axis represents the target device, while the y-axis represents the model quality degradation and the error bars indicate the minimum and maximum deviations across the trained devices. Compared to the results obtained using post-processed images (i.e., the last row in Table <a href="#S3.T2" title="Table 2 ‣ 3.1 Dataset Creation ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), the degradation is more significant, averaging between 31.74% and 56.41%, when we use RAW data. This result implies that this severe heterogeneity among RAW data files should be carefully handled in FL.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Deeper Look at Heterogeneity: SW</h3>

<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>ISP algorithms applied to each stage. ’<span id="S3.T3.2.1" class="ltx_text ltx_font_bold">-</span>’ means we omit this stage.</figcaption>
<br class="ltx_break">
<table id="S3.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.3.1.1" class="ltx_tr">
<th id="S3.T3.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S3.T3.3.1.1.1.1" class="ltx_text ltx_font_bold">ISP stage</span></th>
<th id="S3.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.3.1.1.2.1" class="ltx_text ltx_font_bold">Baseline</span></th>
<th id="S3.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.3.1.1.3.1" class="ltx_text ltx_font_bold">Option 1</span></th>
<th id="S3.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S3.T3.3.1.1.4.1" class="ltx_text ltx_font_bold">Option 2</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.3.2.1" class="ltx_tr">
<th id="S3.T3.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Denoising</th>
<td id="S3.T3.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t">
<table id="S3.T3.3.2.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.2.1.2.1.1" class="ltx_tr">
<td id="S3.T3.3.2.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">FBDD</td>
</tr>
<tr id="S3.T3.3.2.1.2.1.2" class="ltx_tr">
<td id="S3.T3.3.2.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Gozdz (<a href="#bib.bib15" title="" class="ltx_ref">2010</a>)</cite>
</td>
</tr>
</table>
</td>
<td id="S3.T3.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.2.1.3.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T3.3.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<table id="S3.T3.3.2.1.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.2.1.4.1.1" class="ltx_tr">
<td id="S3.T3.3.2.1.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Wavelet-bayesShrink</td>
</tr>
<tr id="S3.T3.3.2.1.4.1.2" class="ltx_tr">
<td id="S3.T3.3.2.1.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Chipman et al. (<a href="#bib.bib6" title="" class="ltx_ref">1997</a>)</cite>
</td>
</tr>
</table>
</td>
</tr>
<tr id="S3.T3.3.3.2" class="ltx_tr">
<th id="S3.T3.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Demosaicing</th>
<td id="S3.T3.3.3.2.2" class="ltx_td ltx_align_center">
<table id="S3.T3.3.3.2.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.3.2.2.1.1" class="ltx_tr">
<td id="S3.T3.3.3.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">PPG</td>
</tr>
<tr id="S3.T3.3.3.2.2.1.2" class="ltx_tr">
<td id="S3.T3.3.3.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Lin (<a href="#bib.bib35" title="" class="ltx_ref">2003</a>)</cite>
</td>
</tr>
</table>
</td>
<td id="S3.T3.3.3.2.3" class="ltx_td ltx_align_center">
<table id="S3.T3.3.3.2.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.3.2.3.1.1" class="ltx_tr">
<td id="S3.T3.3.3.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Pixel binning</td>
</tr>
<tr id="S3.T3.3.3.2.3.1.2" class="ltx_tr">
<td id="S3.T3.3.3.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib4" title="" class="ltx_ref">Cannistra </a></cite>
</td>
</tr>
</table>
</td>
<td id="S3.T3.3.3.2.4" class="ltx_td ltx_align_center ltx_border_r">
<table id="S3.T3.3.3.2.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.3.2.4.1.1" class="ltx_tr">
<td id="S3.T3.3.3.2.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">AHD</td>
</tr>
<tr id="S3.T3.3.3.2.4.1.2" class="ltx_tr">
<td id="S3.T3.3.3.2.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Hirakawa &amp; Parks (<a href="#bib.bib19" title="" class="ltx_ref">2005</a>)</cite>
</td>
</tr>
</table>
</td>
</tr>
<tr id="S3.T3.3.4.3" class="ltx_tr">
<th id="S3.T3.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Color transformation</th>
<td id="S3.T3.3.4.3.2" class="ltx_td ltx_align_center">
<table id="S3.T3.3.4.3.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.4.3.2.1.1" class="ltx_tr">
<td id="S3.T3.3.4.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Gray world</td>
</tr>
<tr id="S3.T3.3.4.3.2.1.2" class="ltx_tr">
<td id="S3.T3.3.4.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Ebner (<a href="#bib.bib14" title="" class="ltx_ref">2007</a>)</cite>
</td>
</tr>
</table>
</td>
<td id="S3.T3.3.4.3.3" class="ltx_td ltx_align_center"><span id="S3.T3.3.4.3.3.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T3.3.4.3.4" class="ltx_td ltx_align_center ltx_border_r">
<table id="S3.T3.3.4.3.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.4.3.4.1.1" class="ltx_tr">
<td id="S3.T3.3.4.3.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">White patch</td>
</tr>
<tr id="S3.T3.3.4.3.4.1.2" class="ltx_tr">
<td id="S3.T3.3.4.3.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Ebner (<a href="#bib.bib14" title="" class="ltx_ref">2007</a>)</cite>
</td>
</tr>
</table>
</td>
</tr>
<tr id="S3.T3.3.5.4" class="ltx_tr">
<th id="S3.T3.3.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Gamut mapping</th>
<td id="S3.T3.3.5.4.2" class="ltx_td ltx_align_center">srgb</td>
<td id="S3.T3.3.5.4.3" class="ltx_td ltx_align_center"><span id="S3.T3.3.5.4.3.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T3.3.5.4.4" class="ltx_td ltx_align_center ltx_border_r">Prophoto</td>
</tr>
<tr id="S3.T3.3.6.5" class="ltx_tr">
<th id="S3.T3.3.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Tone transformation</th>
<td id="S3.T3.3.6.5.2" class="ltx_td ltx_align_center">
<table id="S3.T3.3.6.5.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.6.5.2.1.1" class="ltx_tr">
<td id="S3.T3.3.6.5.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">srgb gamma correction</td>
</tr>
<tr id="S3.T3.3.6.5.2.1.2" class="ltx_tr">
<td id="S3.T3.3.6.5.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Stokes (<a href="#bib.bib52" title="" class="ltx_ref">1996</a>)</cite>
</td>
</tr>
</table>
</td>
<td id="S3.T3.3.6.5.3" class="ltx_td ltx_align_center"><span id="S3.T3.3.6.5.3.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T3.3.6.5.4" class="ltx_td ltx_align_center ltx_border_r">
<table id="S3.T3.3.6.5.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.6.5.4.1.1" class="ltx_tr">
<td id="S3.T3.3.6.5.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">srgb gamma correction</td>
</tr>
<tr id="S3.T3.3.6.5.4.1.2" class="ltx_tr">
<td id="S3.T3.3.6.5.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">+tone Equalization</td>
</tr>
</table>
</td>
</tr>
<tr id="S3.T3.3.7.6" class="ltx_tr">
<th id="S3.T3.3.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">Image compression</th>
<td id="S3.T3.3.7.6.2" class="ltx_td ltx_align_center ltx_border_b">
<table id="S3.T3.3.7.6.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.7.6.2.1.1" class="ltx_tr">
<td id="S3.T3.3.7.6.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">JPEG (Quality=85)</td>
</tr>
<tr id="S3.T3.3.7.6.2.1.2" class="ltx_tr">
<td id="S3.T3.3.7.6.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Cidon et al. (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>
</td>
</tr>
</table>
</td>
<td id="S3.T3.3.7.6.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S3.T3.3.7.6.3.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="S3.T3.3.7.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">
<table id="S3.T3.3.7.6.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T3.3.7.6.4.1.1" class="ltx_tr">
<td id="S3.T3.3.7.6.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">JPEG(Quality=50)</td>
</tr>
<tr id="S3.T3.3.7.6.4.1.2" class="ltx_tr">
<td id="S3.T3.3.7.6.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"> <cite class="ltx_cite ltx_citemacro_cite">Cidon et al. (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>
</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.1" class="ltx_p">ISP algorithms are applied to RAW data to produce human visible images <cite class="ltx_cite ltx_citemacro_cite">Hansen et al. (<a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>. To quantify the contributions of the ISP algorithm variations on system-induced data heterogeneity, we divide the ISP process into six primary stages, from demosaicing to compression, creating distinct images at each stage <cite class="ltx_cite ltx_citemacro_cite">Buckler et al. (<a href="#bib.bib3" title="" class="ltx_ref">2017</a>)</cite>. Table <a href="#S3.T3" title="Table 3 ‣ 3.4 Deeper Look at Heterogeneity: SW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> lists the algorithms used at each stage. The impact of each stage on model accuracy is assessed by either omitting a specific stage or applying another algorithm for each stage<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>In case of demosaicing, which is a prerequisite for subsequent stages, we use two different methods rather than omitting this stage.</span></span></span> — we train the global model using data processed by the Baseline column in Table <a href="#S3.T3" title="Table 3 ‣ 3.4 Deeper Look at Heterogeneity: SW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, and test the model while adopting either Option 1 or Option 2 for each stage.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/fig3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="259" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Model quality degradation in model when tested with adjustment of ISP algorithms at every stage.</figcaption>
</figure>
<div id="S3.SS4.p2" class="ltx_para ltx_noindent">
<p id="S3.SS4.p2.1" class="ltx_p">Although the ISP algorithms are known to reduce the HW variations <cite class="ltx_cite ltx_citemacro_cite">Ebner (<a href="#bib.bib14" title="" class="ltx_ref">2007</a>); Morovič (<a href="#bib.bib42" title="" class="ltx_ref">2008</a>)</cite>, variations in certain ISP methods still introduce unmanageable heterogeneity in images that have a detrimental impact on model performance.Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.4 Deeper Look at Heterogeneity: SW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> depicts the model quality degradation due to the various ISP algorithms. The x-axis represents the stage omitted (or modified) from the baseline. As shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.4 Deeper Look at Heterogeneity: SW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the model quality degrades when we omit (or modify) each stage of the ISP algorithms. Notably, omitting or modifying the color and tone transformation algorithms result in significant declines in model quality, regardless of the device type — the accuracy is degraded by 56.0% and 49.2% when we exclude Color (specifically, White Balancing) and Tone transformation from ISP stages, respectively, which is even more severe compared to that we observe in RAW data. This result implies that each stage of ISP algorithms, especially the color and tone transformation stages, significantly contributes to system-induced data heterogeneity and thus there is a demand for new solutions to tackle ISP heterogeneity across the devices in FL.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Fairness and Domain Generalization Issues</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">In a real-world FL environment, a global model is trained with a number of client devices. Considering our observations in Section <a href="#S3.SS2" title="3.2 Data Heterogeneity across Device type ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, the diverse types of client devices can contribute differently to the global model due to their unique data characteristics stemming from HW (Section <a href="#S3.F2" title="Figure 2 ‣ 3.3 Deeper Look at Heterogeneity: HW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) and SW variations (Section <a href="#S3.T3" title="Table 3 ‣ 3.4 Deeper Look at Heterogeneity: SW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). As a result, certain characteristics affected by system heterogeneity can make the global model learn a bias towards those characteristics. This potential issue can be interpreted through the lens of two well-established fields in machine learning: fairness and domain generalization.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Fairness</h3>

<figure id="S4.F4" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/fig4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="215" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Model quality degradation over the highest accuracy achieved by dominant devices, Galaxy S9 &amp; S6, showing the bias in the global model towards dominant devices. The participant devices used for training followed the ratio specified in Table <a href="#S3.T1" title="Table 1 ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</figcaption>
</figure>
<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">In FL, the number of client devices is not always same for all device types. This uneven distribution makes the fairness problems<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>In the realm of FL, fairness ensures the global model performs adequately across all participating devices, rather than being skewed towards a certain type or group of devices.</span></span></span> in FL <cite class="ltx_cite ltx_citemacro_cite">Mohri et al. (<a href="#bib.bib41" title="" class="ltx_ref">2019</a>); Maeng et al. (<a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite>. For example, if a majority of training data comes from a particular group of devices with the similar HW and SW configurations, the global model may become more tailored towards those devices, degrading accuracy for the rest of the devices. To quantify the fairness problem in a realistic manner, we allocate device types of clients according to the vendor market share <cite class="ltx_cite ltx_citemacro_cite">StatCounter (<a href="#bib.bib51" title="" class="ltx_ref">2022</a>)</cite> (summarized in Table <a href="#S3.T1" title="Table 1 ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and system performance distribution <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib54" title="" class="ltx_ref">2019</a>)</cite>. Note, in our analysis, we refer the device types with the highest percentage of participation as the dominant devices (i.e., Galaxy S9 and S6 in Table <a href="#S3.T1" title="Table 1 ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) — these can be seen as a privileged group in the context of fairness, benefiting from biases in the global model <cite class="ltx_cite ltx_citemacro_cite">Pessach &amp; Shmueli (<a href="#bib.bib43" title="" class="ltx_ref">2022</a>)</cite>. To assess the fairness of FL across various device types, we compute the model quality degradation on each remaining device compared to the accuracy on the dominant devices.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p">Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.1 Fairness ‣ 4 Fairness and Domain Generalization Issues" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the model quality degradation for each device compared to the dominant devices — the x-axis represents the device type the model is deployed. As shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.1 Fairness ‣ 4 Fairness and Domain Generalization Issues" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the accuracy on the 7 less dominant devices is 3.2% to 16.9% lower than that on the dominant devices. This implies that the global model has a bias toward the HW specification and SW algorithms of the dominant devices. On the other hand, although Galaxy S22 is the third most used for training, deploying the model to it yields the lowest accuracy among the devices. This also implies that a higher participation rate does not always guarantee a high accuracy, meaning that there exist the system features, such as the advanced ISP algorithms, which can smooth out (or deteriorate) the bias impact.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Domain Generalization</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">In the context of FL, deploying the model to a new, unseen device type is closely related to the concept of domain generalization (DG) <span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Given that more than 500 new smartphones are released every year <cite class="ltx_cite ltx_citemacro_cite">Arena Com, Ltd. (<a href="#bib.bib1" title="" class="ltx_ref">2022</a>)</cite>, it is common to see unseen devices for FL-based services.</span></span></span>. This concept involves designing ML models that can effectively generalize to new, unseen domains <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a href="#bib.bib53" title="" class="ltx_ref">2022</a>)</cite>, such as unique device types. In FL, domains can be characterized by system-induced data heterogeneity, where each device exhibits distinct features. To emulate the DG problem in FL, we consider each device as an unseen domain — note we analyze the ability of the model to generalize across different device types by training the global model with all other devices and subsequently testing it on the selected unseen device.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/fig5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="218" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Model quality degradation when a device type is excluded from training, illustrating the complex relationship of DG and accuracy with various device types in FL.</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p">Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.2 Domain Generalization ‣ 4 Fairness and Domain Generalization Issues" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the model quality degradation of global model accuracy when the device is excluded from training, compared to when all device types equally participate in FL (this practical is widely used in DG <cite class="ltx_cite ltx_citemacro_cite">Dou et al. (<a href="#bib.bib13" title="" class="ltx_ref">2019</a>); Segu et al. (<a href="#bib.bib47" title="" class="ltx_ref">2023</a>)</cite>). The x-axis represents the device type that was excluded from training, while the y-axis shows the model quality degradation on the excluded (i.e., unseen) device. In DG, it is typically expected that a domain excluded from training would show lower accuracy, since the global model lacks exposure to its specific characteristics <cite class="ltx_cite ltx_citemacro_cite">Dou et al. (<a href="#bib.bib13" title="" class="ltx_ref">2019</a>); Segu et al. (<a href="#bib.bib47" title="" class="ltx_ref">2023</a>)</cite>. Interestingly, excluding a device from training does not consistently affect accuracy. For example, the accuracy for S9 drops when it is not part of the training. Conversely, devices like S6 and VELVET exhibit increased accuracy, even though they were excluded from training. This inconsistent result demonstrates system-induced data heterogeneity can deteriorate the complexity of DG in FL.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p">Our observations highlight the importance of considering system-induced data heterogeneity and its potential impact on fairness and DG in FL. There is a need for a careful strategy that ensures stable performance of global model for various device types.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Proposed Design: HeteroSwitch</h2>

<figure id="S5.F6" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/fig6.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="639" height="206" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Overall Design of HeteroSwitch</figcaption>
</figure>
<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.2" class="ltx_p">As we observe in Section <a href="#S4" title="4 Fairness and Domain Generalization Issues" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, system-induced data heterogeneity causes significant accuracy degradation of the deployed DNNs on the typical device types. To mitigate the problem, we propose HeteroSwitch — a selective generalization technique. Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the overview of HeteroSwitch. As shown in Fig. <a href="#S5.F6" title="Figure 6 ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, HerteroSwitch incrementally applies generalization techniques to the clients that have biased data due to system-induced data heterogeneity. For each round, HeteroSwitch measures the amount of bias in the data of participating clients, by comparing their initial loss <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="L_{init}" display="inline"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">L</mi><mrow id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml"><mi id="S5.p1.1.m1.1.1.3.2" xref="S5.p1.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.1.3.1" xref="S5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.p1.1.m1.1.1.3.3" xref="S5.p1.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.1.3.1a" xref="S5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.p1.1.m1.1.1.3.4" xref="S5.p1.1.m1.1.1.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.1.3.1b" xref="S5.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.p1.1.m1.1.1.3.5" xref="S5.p1.1.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝐿</ci><apply id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3"><times id="S5.p1.1.m1.1.1.3.1.cmml" xref="S5.p1.1.m1.1.1.3.1"></times><ci id="S5.p1.1.m1.1.1.3.2.cmml" xref="S5.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S5.p1.1.m1.1.1.3.3.cmml" xref="S5.p1.1.m1.1.1.3.3">𝑛</ci><ci id="S5.p1.1.m1.1.1.3.4.cmml" xref="S5.p1.1.m1.1.1.3.4">𝑖</ci><ci id="S5.p1.1.m1.1.1.3.5.cmml" xref="S5.p1.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">L_{init}</annotation></semantics></math> with the Exponential Moving Average (EMA) of the aggregated loss <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="L_{EMA}" display="inline"><semantics id="S5.p1.2.m2.1a"><msub id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">L</mi><mrow id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml"><mi id="S5.p1.2.m2.1.1.3.2" xref="S5.p1.2.m2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.p1.2.m2.1.1.3.1" xref="S5.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.p1.2.m2.1.1.3.3" xref="S5.p1.2.m2.1.1.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.p1.2.m2.1.1.3.1a" xref="S5.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.p1.2.m2.1.1.3.4" xref="S5.p1.2.m2.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">subscript</csymbol><ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">𝐿</ci><apply id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3"><times id="S5.p1.2.m2.1.1.3.1.cmml" xref="S5.p1.2.m2.1.1.3.1"></times><ci id="S5.p1.2.m2.1.1.3.2.cmml" xref="S5.p1.2.m2.1.1.3.2">𝐸</ci><ci id="S5.p1.2.m2.1.1.3.3.cmml" xref="S5.p1.2.m2.1.1.3.3">𝑀</ci><ci id="S5.p1.2.m2.1.1.3.4.cmml" xref="S5.p1.2.m2.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">L_{EMA}</annotation></semantics></math>.(Section <a href="#S5.SS1" title="5.1 Bias Measurement ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>). Based on the measured bias, HeteroSwitch determines whether it applies the generalization techniques to the client data or not (Section <a href="#S5.SS2" title="5.2 Generalization Techniques ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>). The algorithm detail is explained in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.11.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> ClientUpdate of HeteroSwitch</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.9" class="ltx_p ltx_figure_panel"><span id="alg1.9.2" class="ltx_text ltx_font_bold">Input</span>: Model Parameters <math id="alg1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">W</annotation></semantics></math>, Client’s Dataset <math id="alg1.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">D</annotation></semantics></math>, EMA of Aggregated Loss <math id="alg1.3.m3.1" class="ltx_Math" alttext="L_{EMA}" display="inline"><semantics id="alg1.3.m3.1a"><msub id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml"><mi id="alg1.3.m3.1.1.2" xref="alg1.3.m3.1.1.2.cmml">L</mi><mrow id="alg1.3.m3.1.1.3" xref="alg1.3.m3.1.1.3.cmml"><mi id="alg1.3.m3.1.1.3.2" xref="alg1.3.m3.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.3.m3.1.1.3.1" xref="alg1.3.m3.1.1.3.1.cmml">​</mo><mi id="alg1.3.m3.1.1.3.3" xref="alg1.3.m3.1.1.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.3.m3.1.1.3.1a" xref="alg1.3.m3.1.1.3.1.cmml">​</mo><mi id="alg1.3.m3.1.1.3.4" xref="alg1.3.m3.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><apply id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.1.1.1.cmml" xref="alg1.3.m3.1.1">subscript</csymbol><ci id="alg1.3.m3.1.1.2.cmml" xref="alg1.3.m3.1.1.2">𝐿</ci><apply id="alg1.3.m3.1.1.3.cmml" xref="alg1.3.m3.1.1.3"><times id="alg1.3.m3.1.1.3.1.cmml" xref="alg1.3.m3.1.1.3.1"></times><ci id="alg1.3.m3.1.1.3.2.cmml" xref="alg1.3.m3.1.1.3.2">𝐸</ci><ci id="alg1.3.m3.1.1.3.3.cmml" xref="alg1.3.m3.1.1.3.3">𝑀</ci><ci id="alg1.3.m3.1.1.3.4.cmml" xref="alg1.3.m3.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">L_{EMA}</annotation></semantics></math>(eq. <a href="#S5.E1" title="In 5.1 Bias Measurement ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>)
<br class="ltx_break"><span id="alg1.9.3" class="ltx_text ltx_font_bold">Parameter</span>: Learning Rate <math id="alg1.4.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.4.m4.1a"><mi id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">\eta</annotation></semantics></math>, # of Epochs <math id="alg1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.5.m5.1a"><mi id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">E</annotation></semantics></math>, Batch Size <math id="alg1.6.m6.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.6.m6.1a"><mi id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">B</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.9.4" class="ltx_text ltx_font_bold">Output</span>: Updated Model Parameters <math id="alg1.7.m7.1" class="ltx_Math" alttext="W_{return}" display="inline"><semantics id="alg1.7.m7.1a"><msub id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml"><mi id="alg1.7.m7.1.1.2" xref="alg1.7.m7.1.1.2.cmml">W</mi><mrow id="alg1.7.m7.1.1.3" xref="alg1.7.m7.1.1.3.cmml"><mi id="alg1.7.m7.1.1.3.2" xref="alg1.7.m7.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.3.1" xref="alg1.7.m7.1.1.3.1.cmml">​</mo><mi id="alg1.7.m7.1.1.3.3" xref="alg1.7.m7.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.3.1a" xref="alg1.7.m7.1.1.3.1.cmml">​</mo><mi id="alg1.7.m7.1.1.3.4" xref="alg1.7.m7.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.3.1b" xref="alg1.7.m7.1.1.3.1.cmml">​</mo><mi id="alg1.7.m7.1.1.3.5" xref="alg1.7.m7.1.1.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.3.1c" xref="alg1.7.m7.1.1.3.1.cmml">​</mo><mi id="alg1.7.m7.1.1.3.6" xref="alg1.7.m7.1.1.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.3.1d" xref="alg1.7.m7.1.1.3.1.cmml">​</mo><mi id="alg1.7.m7.1.1.3.7" xref="alg1.7.m7.1.1.3.7.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1"><csymbol cd="ambiguous" id="alg1.7.m7.1.1.1.cmml" xref="alg1.7.m7.1.1">subscript</csymbol><ci id="alg1.7.m7.1.1.2.cmml" xref="alg1.7.m7.1.1.2">𝑊</ci><apply id="alg1.7.m7.1.1.3.cmml" xref="alg1.7.m7.1.1.3"><times id="alg1.7.m7.1.1.3.1.cmml" xref="alg1.7.m7.1.1.3.1"></times><ci id="alg1.7.m7.1.1.3.2.cmml" xref="alg1.7.m7.1.1.3.2">𝑟</ci><ci id="alg1.7.m7.1.1.3.3.cmml" xref="alg1.7.m7.1.1.3.3">𝑒</ci><ci id="alg1.7.m7.1.1.3.4.cmml" xref="alg1.7.m7.1.1.3.4">𝑡</ci><ci id="alg1.7.m7.1.1.3.5.cmml" xref="alg1.7.m7.1.1.3.5">𝑢</ci><ci id="alg1.7.m7.1.1.3.6.cmml" xref="alg1.7.m7.1.1.3.6">𝑟</ci><ci id="alg1.7.m7.1.1.3.7.cmml" xref="alg1.7.m7.1.1.3.7">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">W_{return}</annotation></semantics></math>, Train Loss <math id="alg1.8.m8.1" class="ltx_Math" alttext="L_{train}" display="inline"><semantics id="alg1.8.m8.1a"><msub id="alg1.8.m8.1.1" xref="alg1.8.m8.1.1.cmml"><mi id="alg1.8.m8.1.1.2" xref="alg1.8.m8.1.1.2.cmml">L</mi><mrow id="alg1.8.m8.1.1.3" xref="alg1.8.m8.1.1.3.cmml"><mi id="alg1.8.m8.1.1.3.2" xref="alg1.8.m8.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.8.m8.1.1.3.1" xref="alg1.8.m8.1.1.3.1.cmml">​</mo><mi id="alg1.8.m8.1.1.3.3" xref="alg1.8.m8.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.8.m8.1.1.3.1a" xref="alg1.8.m8.1.1.3.1.cmml">​</mo><mi id="alg1.8.m8.1.1.3.4" xref="alg1.8.m8.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.8.m8.1.1.3.1b" xref="alg1.8.m8.1.1.3.1.cmml">​</mo><mi id="alg1.8.m8.1.1.3.5" xref="alg1.8.m8.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.8.m8.1.1.3.1c" xref="alg1.8.m8.1.1.3.1.cmml">​</mo><mi id="alg1.8.m8.1.1.3.6" xref="alg1.8.m8.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.8.m8.1b"><apply id="alg1.8.m8.1.1.cmml" xref="alg1.8.m8.1.1"><csymbol cd="ambiguous" id="alg1.8.m8.1.1.1.cmml" xref="alg1.8.m8.1.1">subscript</csymbol><ci id="alg1.8.m8.1.1.2.cmml" xref="alg1.8.m8.1.1.2">𝐿</ci><apply id="alg1.8.m8.1.1.3.cmml" xref="alg1.8.m8.1.1.3"><times id="alg1.8.m8.1.1.3.1.cmml" xref="alg1.8.m8.1.1.3.1"></times><ci id="alg1.8.m8.1.1.3.2.cmml" xref="alg1.8.m8.1.1.3.2">𝑡</ci><ci id="alg1.8.m8.1.1.3.3.cmml" xref="alg1.8.m8.1.1.3.3">𝑟</ci><ci id="alg1.8.m8.1.1.3.4.cmml" xref="alg1.8.m8.1.1.3.4">𝑎</ci><ci id="alg1.8.m8.1.1.3.5.cmml" xref="alg1.8.m8.1.1.3.5">𝑖</ci><ci id="alg1.8.m8.1.1.3.6.cmml" xref="alg1.8.m8.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m8.1c">L_{train}</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.9.1" class="ltx_text ltx_font_bold">ClientUpdate(<math id="alg1.9.1.m1.2" class="ltx_Math" alttext="W,L_{EMA}" display="inline"><semantics id="alg1.9.1.m1.2a"><mrow id="alg1.9.1.m1.2.2.1" xref="alg1.9.1.m1.2.2.2.cmml"><mi id="alg1.9.1.m1.1.1" xref="alg1.9.1.m1.1.1.cmml">W</mi><mo id="alg1.9.1.m1.2.2.1.2" xref="alg1.9.1.m1.2.2.2.cmml">,</mo><msub id="alg1.9.1.m1.2.2.1.1" xref="alg1.9.1.m1.2.2.1.1.cmml"><mi id="alg1.9.1.m1.2.2.1.1.2" xref="alg1.9.1.m1.2.2.1.1.2.cmml">L</mi><mrow id="alg1.9.1.m1.2.2.1.1.3" xref="alg1.9.1.m1.2.2.1.1.3.cmml"><mi id="alg1.9.1.m1.2.2.1.1.3.2" xref="alg1.9.1.m1.2.2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.9.1.m1.2.2.1.1.3.1" xref="alg1.9.1.m1.2.2.1.1.3.1.cmml">​</mo><mi id="alg1.9.1.m1.2.2.1.1.3.3" xref="alg1.9.1.m1.2.2.1.1.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.9.1.m1.2.2.1.1.3.1a" xref="alg1.9.1.m1.2.2.1.1.3.1.cmml">​</mo><mi id="alg1.9.1.m1.2.2.1.1.3.4" xref="alg1.9.1.m1.2.2.1.1.3.4.cmml">A</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.1.m1.2b"><list id="alg1.9.1.m1.2.2.2.cmml" xref="alg1.9.1.m1.2.2.1"><ci id="alg1.9.1.m1.1.1.cmml" xref="alg1.9.1.m1.1.1">𝑊</ci><apply id="alg1.9.1.m1.2.2.1.1.cmml" xref="alg1.9.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.9.1.m1.2.2.1.1.1.cmml" xref="alg1.9.1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.9.1.m1.2.2.1.1.2.cmml" xref="alg1.9.1.m1.2.2.1.1.2">𝐿</ci><apply id="alg1.9.1.m1.2.2.1.1.3.cmml" xref="alg1.9.1.m1.2.2.1.1.3"><times id="alg1.9.1.m1.2.2.1.1.3.1.cmml" xref="alg1.9.1.m1.2.2.1.1.3.1"></times><ci id="alg1.9.1.m1.2.2.1.1.3.2.cmml" xref="alg1.9.1.m1.2.2.1.1.3.2">𝐸</ci><ci id="alg1.9.1.m1.2.2.1.1.3.3.cmml" xref="alg1.9.1.m1.2.2.1.1.3.3">𝑀</ci><ci id="alg1.9.1.m1.2.2.1.1.3.4.cmml" xref="alg1.9.1.m1.2.2.1.1.3.4">𝐴</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.1.m1.2c">W,L_{EMA}</annotation></semantics></math>):</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.12" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg1.l1.m1.2" class="ltx_Math" alttext="Switch_{1},Switch_{2}=False" display="inline"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml"><mrow id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.3.cmml"><mrow id="alg1.l1.m1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.3.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1.1.1.1a" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.1.1.1.4" xref="alg1.l1.m1.1.1.1.1.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1.1.1.1b" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.1.1.1.5" xref="alg1.l1.m1.1.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1.1.1.1c" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.1.1.1.6" xref="alg1.l1.m1.1.1.1.1.1.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1.1.1.1d" xref="alg1.l1.m1.1.1.1.1.1.1.cmml">​</mo><msub id="alg1.l1.m1.1.1.1.1.1.7" xref="alg1.l1.m1.1.1.1.1.1.7.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.7.2" xref="alg1.l1.m1.1.1.1.1.1.7.2.cmml">h</mi><mn id="alg1.l1.m1.1.1.1.1.1.7.3" xref="alg1.l1.m1.1.1.1.1.1.7.3.cmml">1</mn></msub></mrow><mo id="alg1.l1.m1.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l1.m1.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.2.2.2.1" xref="alg1.l1.m1.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.3.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.2.2.2.1a" xref="alg1.l1.m1.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.2.2.2.1b" xref="alg1.l1.m1.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.2.2.2.5" xref="alg1.l1.m1.2.2.2.2.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.2.2.2.1c" xref="alg1.l1.m1.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.2.2.2.6" xref="alg1.l1.m1.2.2.2.2.2.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.2.2.2.1d" xref="alg1.l1.m1.2.2.2.2.2.1.cmml">​</mo><msub id="alg1.l1.m1.2.2.2.2.2.7" xref="alg1.l1.m1.2.2.2.2.2.7.cmml"><mi id="alg1.l1.m1.2.2.2.2.2.7.2" xref="alg1.l1.m1.2.2.2.2.2.7.2.cmml">h</mi><mn id="alg1.l1.m1.2.2.2.2.2.7.3" xref="alg1.l1.m1.2.2.2.2.2.7.3.cmml">2</mn></msub></mrow></mrow><mo id="alg1.l1.m1.2.2.3" xref="alg1.l1.m1.2.2.3.cmml">=</mo><mrow id="alg1.l1.m1.2.2.4" xref="alg1.l1.m1.2.2.4.cmml"><mi id="alg1.l1.m1.2.2.4.2" xref="alg1.l1.m1.2.2.4.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.4.1" xref="alg1.l1.m1.2.2.4.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.4.3" xref="alg1.l1.m1.2.2.4.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.4.1a" xref="alg1.l1.m1.2.2.4.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.4.4" xref="alg1.l1.m1.2.2.4.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.4.1b" xref="alg1.l1.m1.2.2.4.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.4.5" xref="alg1.l1.m1.2.2.4.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.4.1c" xref="alg1.l1.m1.2.2.4.1.cmml">​</mo><mi id="alg1.l1.m1.2.2.4.6" xref="alg1.l1.m1.2.2.4.6.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2"><eq id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2.3"></eq><list id="alg1.l1.m1.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2"><apply id="alg1.l1.m1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1"><times id="alg1.l1.m1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1"></times><ci id="alg1.l1.m1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.2">𝑆</ci><ci id="alg1.l1.m1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.3">𝑤</ci><ci id="alg1.l1.m1.1.1.1.1.1.4.cmml" xref="alg1.l1.m1.1.1.1.1.1.4">𝑖</ci><ci id="alg1.l1.m1.1.1.1.1.1.5.cmml" xref="alg1.l1.m1.1.1.1.1.1.5">𝑡</ci><ci id="alg1.l1.m1.1.1.1.1.1.6.cmml" xref="alg1.l1.m1.1.1.1.1.1.6">𝑐</ci><apply id="alg1.l1.m1.1.1.1.1.1.7.cmml" xref="alg1.l1.m1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.7.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.7">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.7.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.7.2">ℎ</ci><cn type="integer" id="alg1.l1.m1.1.1.1.1.1.7.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.7.3">1</cn></apply></apply><apply id="alg1.l1.m1.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2"><times id="alg1.l1.m1.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.1"></times><ci id="alg1.l1.m1.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2">𝑆</ci><ci id="alg1.l1.m1.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.3">𝑤</ci><ci id="alg1.l1.m1.2.2.2.2.2.4.cmml" xref="alg1.l1.m1.2.2.2.2.2.4">𝑖</ci><ci id="alg1.l1.m1.2.2.2.2.2.5.cmml" xref="alg1.l1.m1.2.2.2.2.2.5">𝑡</ci><ci id="alg1.l1.m1.2.2.2.2.2.6.cmml" xref="alg1.l1.m1.2.2.2.2.2.6">𝑐</ci><apply id="alg1.l1.m1.2.2.2.2.2.7.cmml" xref="alg1.l1.m1.2.2.2.2.2.7"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.7.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.7">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.7.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.7.2">ℎ</ci><cn type="integer" id="alg1.l1.m1.2.2.2.2.2.7.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.7.3">2</cn></apply></apply></list><apply id="alg1.l1.m1.2.2.4.cmml" xref="alg1.l1.m1.2.2.4"><times id="alg1.l1.m1.2.2.4.1.cmml" xref="alg1.l1.m1.2.2.4.1"></times><ci id="alg1.l1.m1.2.2.4.2.cmml" xref="alg1.l1.m1.2.2.4.2">𝐹</ci><ci id="alg1.l1.m1.2.2.4.3.cmml" xref="alg1.l1.m1.2.2.4.3">𝑎</ci><ci id="alg1.l1.m1.2.2.4.4.cmml" xref="alg1.l1.m1.2.2.4.4">𝑙</ci><ci id="alg1.l1.m1.2.2.4.5.cmml" xref="alg1.l1.m1.2.2.4.5">𝑠</ci><ci id="alg1.l1.m1.2.2.4.6.cmml" xref="alg1.l1.m1.2.2.4.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">Switch_{1},Switch_{2}=False</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  Calculate <math id="alg1.l2.m1.1" class="ltx_Math" alttext="L_{init}=L" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">L</mi><mrow id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml"><mi id="alg1.l2.m1.1.1.2.3.2" xref="alg1.l2.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.2.3.1" xref="alg1.l2.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.2.3.3" xref="alg1.l2.m1.1.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.2.3.1a" xref="alg1.l2.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.2.3.4" xref="alg1.l2.m1.1.1.2.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.1.1.2.3.1b" xref="alg1.l2.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l2.m1.1.1.2.3.5" xref="alg1.l2.m1.1.1.2.3.5.cmml">t</mi></mrow></msub><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝐿</ci><apply id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3"><times id="alg1.l2.m1.1.1.2.3.1.cmml" xref="alg1.l2.m1.1.1.2.3.1"></times><ci id="alg1.l2.m1.1.1.2.3.2.cmml" xref="alg1.l2.m1.1.1.2.3.2">𝑖</ci><ci id="alg1.l2.m1.1.1.2.3.3.cmml" xref="alg1.l2.m1.1.1.2.3.3">𝑛</ci><ci id="alg1.l2.m1.1.1.2.3.4.cmml" xref="alg1.l2.m1.1.1.2.3.4">𝑖</ci><ci id="alg1.l2.m1.1.1.2.3.5.cmml" xref="alg1.l2.m1.1.1.2.3.5">𝑡</ci></apply></apply><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">L_{init}=L</annotation></semantics></math>(<math id="alg1.l2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">D</annotation></semantics></math>, <math id="alg1.l2.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="alg1.l2.m3.1a"><mi id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">W</annotation></semantics></math>)

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <span id="alg1.l3.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="L_{init}&lt;L_{EMA}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">L</mi><mrow id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml"><mi id="alg1.l3.m1.1.1.2.3.2" xref="alg1.l3.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.2.3.1" xref="alg1.l3.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.2.3.3" xref="alg1.l3.m1.1.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.2.3.1a" xref="alg1.l3.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.2.3.4" xref="alg1.l3.m1.1.1.2.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.2.3.1b" xref="alg1.l3.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.2.3.5" xref="alg1.l3.m1.1.1.2.3.5.cmml">t</mi></mrow></msub><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">&lt;</mo><msub id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">L</mi><mrow id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml"><mi id="alg1.l3.m1.1.1.3.3.2" xref="alg1.l3.m1.1.1.3.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.3.1" xref="alg1.l3.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.3.3.3" xref="alg1.l3.m1.1.1.3.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m1.1.1.3.3.1a" xref="alg1.l3.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l3.m1.1.1.3.3.4" xref="alg1.l3.m1.1.1.3.3.4.cmml">A</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><lt id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></lt><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝐿</ci><apply id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3"><times id="alg1.l3.m1.1.1.2.3.1.cmml" xref="alg1.l3.m1.1.1.2.3.1"></times><ci id="alg1.l3.m1.1.1.2.3.2.cmml" xref="alg1.l3.m1.1.1.2.3.2">𝑖</ci><ci id="alg1.l3.m1.1.1.2.3.3.cmml" xref="alg1.l3.m1.1.1.2.3.3">𝑛</ci><ci id="alg1.l3.m1.1.1.2.3.4.cmml" xref="alg1.l3.m1.1.1.2.3.4">𝑖</ci><ci id="alg1.l3.m1.1.1.2.3.5.cmml" xref="alg1.l3.m1.1.1.2.3.5">𝑡</ci></apply></apply><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝐿</ci><apply id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3"><times id="alg1.l3.m1.1.1.3.3.1.cmml" xref="alg1.l3.m1.1.1.3.3.1"></times><ci id="alg1.l3.m1.1.1.3.3.2.cmml" xref="alg1.l3.m1.1.1.3.3.2">𝐸</ci><ci id="alg1.l3.m1.1.1.3.3.3.cmml" xref="alg1.l3.m1.1.1.3.3.3">𝑀</ci><ci id="alg1.l3.m1.1.1.3.3.4.cmml" xref="alg1.l3.m1.1.1.3.3.4">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">L_{init}&lt;L_{EMA}</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math id="alg1.l4.m1.1" class="ltx_Math" alttext="Switch_{1}=True" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1a" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.4" xref="alg1.l4.m1.1.1.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1b" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.5" xref="alg1.l4.m1.1.1.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1c" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.6" xref="alg1.l4.m1.1.1.2.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1d" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l4.m1.1.1.2.7" xref="alg1.l4.m1.1.1.2.7.cmml"><mi id="alg1.l4.m1.1.1.2.7.2" xref="alg1.l4.m1.1.1.2.7.2.cmml">h</mi><mn id="alg1.l4.m1.1.1.2.7.3" xref="alg1.l4.m1.1.1.2.7.3.cmml">1</mn></msub></mrow><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.4" xref="alg1.l4.m1.1.1.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.1b" xref="alg1.l4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.5" xref="alg1.l4.m1.1.1.3.5.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><times id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2.1"></times><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑆</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑤</ci><ci id="alg1.l4.m1.1.1.2.4.cmml" xref="alg1.l4.m1.1.1.2.4">𝑖</ci><ci id="alg1.l4.m1.1.1.2.5.cmml" xref="alg1.l4.m1.1.1.2.5">𝑡</ci><ci id="alg1.l4.m1.1.1.2.6.cmml" xref="alg1.l4.m1.1.1.2.6">𝑐</ci><apply id="alg1.l4.m1.1.1.2.7.cmml" xref="alg1.l4.m1.1.1.2.7"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.7.1.cmml" xref="alg1.l4.m1.1.1.2.7">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.7.2.cmml" xref="alg1.l4.m1.1.1.2.7.2">ℎ</ci><cn type="integer" id="alg1.l4.m1.1.1.2.7.3.cmml" xref="alg1.l4.m1.1.1.2.7.3">1</cn></apply></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝑇</ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑟</ci><ci id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4">𝑢</ci><ci id="alg1.l4.m1.1.1.3.5.cmml" xref="alg1.l4.m1.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">Switch_{1}=True</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <span id="alg1.l5.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>  <span id="alg1.l6.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l6.m1.1" class="ltx_math_unparsed" alttext="Switch_{1}==True" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1b"><mi id="alg1.l6.m1.1.1">S</mi><mi id="alg1.l6.m1.1.2">w</mi><mi id="alg1.l6.m1.1.3">i</mi><mi id="alg1.l6.m1.1.4">t</mi><mi id="alg1.l6.m1.1.5">c</mi><msub id="alg1.l6.m1.1.6"><mi id="alg1.l6.m1.1.6.2">h</mi><mn id="alg1.l6.m1.1.6.3">1</mn></msub><mo rspace="0em" id="alg1.l6.m1.1.7">=</mo><mo lspace="0em" id="alg1.l6.m1.1.8">=</mo><mi id="alg1.l6.m1.1.9">T</mi><mi id="alg1.l6.m1.1.10">r</mi><mi id="alg1.l6.m1.1.11">u</mi><mi id="alg1.l6.m1.1.12">e</mi></mrow><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">Switch_{1}==True</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span id="alg1.l7.1" class="ltx_text ltx_font_italic">Random Transformation on <math id="alg1.l7.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg1.l7.1.m1.1a"><mi id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">D</annotation></semantics></math>(eq. <a href="#S5.E2" title="In 5.2 Generalization Techniques ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, eq. <a href="#S5.E3" title="In 5.2 Generalization Techniques ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)</span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>  <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>  <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\beta\leftarrow" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">β</mi><mo stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝛽</ci><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\beta\leftarrow</annotation></semantics></math> (split <math id="alg1.l9.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="alg1.l9.m2.1a"><mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">D</annotation></semantics></math> into batches of size <math id="alg1.l9.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l9.m3.1a"><mi id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><ci id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">B</annotation></semantics></math>)

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>  Initialize <math id="alg1.l10.m1.1" class="ltx_Math" alttext="W_{SWA}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">W</mi><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.3.1a" xref="alg1.l10.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.3.4" xref="alg1.l10.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑊</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑆</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑊</ci><ci id="alg1.l10.m1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">W_{SWA}</annotation></semantics></math> as copy of <math id="alg1.l10.m2.1" class="ltx_Math" alttext="W" display="inline"><semantics id="alg1.l10.m2.1a"><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">W</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  Initialize batch index <math id="alg1.l11.m1.1" class="ltx_Math" alttext="Idx_{b}=0" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mrow id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.2.1" xref="alg1.l11.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.2.1a" xref="alg1.l11.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l11.m1.1.1.2.4" xref="alg1.l11.m1.1.1.2.4.cmml"><mi id="alg1.l11.m1.1.1.2.4.2" xref="alg1.l11.m1.1.1.2.4.2.cmml">x</mi><mi id="alg1.l11.m1.1.1.2.4.3" xref="alg1.l11.m1.1.1.2.4.3.cmml">b</mi></msub></mrow><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">=</mo><mn id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><eq id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></eq><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2"><times id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.2.1"></times><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝐼</ci><ci id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">𝑑</ci><apply id="alg1.l11.m1.1.1.2.4.cmml" xref="alg1.l11.m1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.4.1.cmml" xref="alg1.l11.m1.1.1.2.4">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.4.2.cmml" xref="alg1.l11.m1.1.1.2.4.2">𝑥</ci><ci id="alg1.l11.m1.1.1.2.4.3.cmml" xref="alg1.l11.m1.1.1.2.4.3">𝑏</ci></apply></apply><cn type="integer" id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">Idx_{b}=0</annotation></semantics></math>, Train Loss <math id="alg1.l11.m2.1" class="ltx_Math" alttext="L_{train}=0" display="inline"><semantics id="alg1.l11.m2.1a"><mrow id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><msub id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml"><mi id="alg1.l11.m2.1.1.2.2" xref="alg1.l11.m2.1.1.2.2.cmml">L</mi><mrow id="alg1.l11.m2.1.1.2.3" xref="alg1.l11.m2.1.1.2.3.cmml"><mi id="alg1.l11.m2.1.1.2.3.2" xref="alg1.l11.m2.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m2.1.1.2.3.1" xref="alg1.l11.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l11.m2.1.1.2.3.3" xref="alg1.l11.m2.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m2.1.1.2.3.1a" xref="alg1.l11.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l11.m2.1.1.2.3.4" xref="alg1.l11.m2.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m2.1.1.2.3.1b" xref="alg1.l11.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l11.m2.1.1.2.3.5" xref="alg1.l11.m2.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m2.1.1.2.3.1c" xref="alg1.l11.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l11.m2.1.1.2.3.6" xref="alg1.l11.m2.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="alg1.l11.m2.1.1.1" xref="alg1.l11.m2.1.1.1.cmml">=</mo><mn id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><eq id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1.1"></eq><apply id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.2.1.cmml" xref="alg1.l11.m2.1.1.2">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.2.cmml" xref="alg1.l11.m2.1.1.2.2">𝐿</ci><apply id="alg1.l11.m2.1.1.2.3.cmml" xref="alg1.l11.m2.1.1.2.3"><times id="alg1.l11.m2.1.1.2.3.1.cmml" xref="alg1.l11.m2.1.1.2.3.1"></times><ci id="alg1.l11.m2.1.1.2.3.2.cmml" xref="alg1.l11.m2.1.1.2.3.2">𝑡</ci><ci id="alg1.l11.m2.1.1.2.3.3.cmml" xref="alg1.l11.m2.1.1.2.3.3">𝑟</ci><ci id="alg1.l11.m2.1.1.2.3.4.cmml" xref="alg1.l11.m2.1.1.2.3.4">𝑎</ci><ci id="alg1.l11.m2.1.1.2.3.5.cmml" xref="alg1.l11.m2.1.1.2.3.5">𝑖</ci><ci id="alg1.l11.m2.1.1.2.3.6.cmml" xref="alg1.l11.m2.1.1.2.3.6">𝑛</ci></apply></apply><cn type="integer" id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">L_{train}=0</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>  <span id="alg1.l12.1" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg1.l12.m1.1" class="ltx_Math" alttext="e=1" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">e</mi><mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">=</mo><mn id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><eq id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></eq><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑒</ci><cn type="integer" id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">e=1</annotation></semantics></math> to <math id="alg1.l12.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l12.m2.1a"><mi id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">E</annotation></semantics></math> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l13.m1.1" class="ltx_Math" alttext="b\in\beta" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">b</mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">∈</mo><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><in id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></in><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑏</ci><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">b\in\beta</annotation></semantics></math> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>        <math id="alg1.l14.m1.2" class="ltx_Math" alttext="L_{train}\leftarrow\frac{L(b,W)*Idx_{b}+W}{Idx_{b}+1}" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.3" xref="alg1.l14.m1.2.3.cmml"><msub id="alg1.l14.m1.2.3.2" xref="alg1.l14.m1.2.3.2.cmml"><mi id="alg1.l14.m1.2.3.2.2" xref="alg1.l14.m1.2.3.2.2.cmml">L</mi><mrow id="alg1.l14.m1.2.3.2.3" xref="alg1.l14.m1.2.3.2.3.cmml"><mi id="alg1.l14.m1.2.3.2.3.2" xref="alg1.l14.m1.2.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.3.2.3.1" xref="alg1.l14.m1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l14.m1.2.3.2.3.3" xref="alg1.l14.m1.2.3.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.3.2.3.1a" xref="alg1.l14.m1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l14.m1.2.3.2.3.4" xref="alg1.l14.m1.2.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.3.2.3.1b" xref="alg1.l14.m1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l14.m1.2.3.2.3.5" xref="alg1.l14.m1.2.3.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.3.2.3.1c" xref="alg1.l14.m1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l14.m1.2.3.2.3.6" xref="alg1.l14.m1.2.3.2.3.6.cmml">n</mi></mrow></msub><mo stretchy="false" id="alg1.l14.m1.2.3.1" xref="alg1.l14.m1.2.3.1.cmml">←</mo><mfrac id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml"><mrow id="alg1.l14.m1.2.2.2" xref="alg1.l14.m1.2.2.2.cmml"><mrow id="alg1.l14.m1.2.2.2.4" xref="alg1.l14.m1.2.2.2.4.cmml"><mrow id="alg1.l14.m1.2.2.2.4.2" xref="alg1.l14.m1.2.2.2.4.2.cmml"><mrow id="alg1.l14.m1.2.2.2.4.2.2" xref="alg1.l14.m1.2.2.2.4.2.2.cmml"><mi id="alg1.l14.m1.2.2.2.4.2.2.2" xref="alg1.l14.m1.2.2.2.4.2.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.2.4.2.2.1" xref="alg1.l14.m1.2.2.2.4.2.2.1.cmml">​</mo><mrow id="alg1.l14.m1.2.2.2.4.2.2.3.2" xref="alg1.l14.m1.2.2.2.4.2.2.3.1.cmml"><mo stretchy="false" id="alg1.l14.m1.2.2.2.4.2.2.3.2.1" xref="alg1.l14.m1.2.2.2.4.2.2.3.1.cmml">(</mo><mi id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml">b</mi><mo id="alg1.l14.m1.2.2.2.4.2.2.3.2.2" xref="alg1.l14.m1.2.2.2.4.2.2.3.1.cmml">,</mo><mi id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.cmml">W</mi><mo rspace="0.055em" stretchy="false" id="alg1.l14.m1.2.2.2.4.2.2.3.2.3" xref="alg1.l14.m1.2.2.2.4.2.2.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="alg1.l14.m1.2.2.2.4.2.1" xref="alg1.l14.m1.2.2.2.4.2.1.cmml">∗</mo><mi id="alg1.l14.m1.2.2.2.4.2.3" xref="alg1.l14.m1.2.2.2.4.2.3.cmml">I</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.2.4.1" xref="alg1.l14.m1.2.2.2.4.1.cmml">​</mo><mi id="alg1.l14.m1.2.2.2.4.3" xref="alg1.l14.m1.2.2.2.4.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.2.4.1a" xref="alg1.l14.m1.2.2.2.4.1.cmml">​</mo><msub id="alg1.l14.m1.2.2.2.4.4" xref="alg1.l14.m1.2.2.2.4.4.cmml"><mi id="alg1.l14.m1.2.2.2.4.4.2" xref="alg1.l14.m1.2.2.2.4.4.2.cmml">x</mi><mi id="alg1.l14.m1.2.2.2.4.4.3" xref="alg1.l14.m1.2.2.2.4.4.3.cmml">b</mi></msub></mrow><mo id="alg1.l14.m1.2.2.2.3" xref="alg1.l14.m1.2.2.2.3.cmml">+</mo><mi id="alg1.l14.m1.2.2.2.5" xref="alg1.l14.m1.2.2.2.5.cmml">W</mi></mrow><mrow id="alg1.l14.m1.2.2.4" xref="alg1.l14.m1.2.2.4.cmml"><mrow id="alg1.l14.m1.2.2.4.2" xref="alg1.l14.m1.2.2.4.2.cmml"><mi id="alg1.l14.m1.2.2.4.2.2" xref="alg1.l14.m1.2.2.4.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.4.2.1" xref="alg1.l14.m1.2.2.4.2.1.cmml">​</mo><mi id="alg1.l14.m1.2.2.4.2.3" xref="alg1.l14.m1.2.2.4.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.4.2.1a" xref="alg1.l14.m1.2.2.4.2.1.cmml">​</mo><msub id="alg1.l14.m1.2.2.4.2.4" xref="alg1.l14.m1.2.2.4.2.4.cmml"><mi id="alg1.l14.m1.2.2.4.2.4.2" xref="alg1.l14.m1.2.2.4.2.4.2.cmml">x</mi><mi id="alg1.l14.m1.2.2.4.2.4.3" xref="alg1.l14.m1.2.2.4.2.4.3.cmml">b</mi></msub></mrow><mo id="alg1.l14.m1.2.2.4.1" xref="alg1.l14.m1.2.2.4.1.cmml">+</mo><mn id="alg1.l14.m1.2.2.4.3" xref="alg1.l14.m1.2.2.4.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.3.cmml" xref="alg1.l14.m1.2.3"><ci id="alg1.l14.m1.2.3.1.cmml" xref="alg1.l14.m1.2.3.1">←</ci><apply id="alg1.l14.m1.2.3.2.cmml" xref="alg1.l14.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.2.1.cmml" xref="alg1.l14.m1.2.3.2">subscript</csymbol><ci id="alg1.l14.m1.2.3.2.2.cmml" xref="alg1.l14.m1.2.3.2.2">𝐿</ci><apply id="alg1.l14.m1.2.3.2.3.cmml" xref="alg1.l14.m1.2.3.2.3"><times id="alg1.l14.m1.2.3.2.3.1.cmml" xref="alg1.l14.m1.2.3.2.3.1"></times><ci id="alg1.l14.m1.2.3.2.3.2.cmml" xref="alg1.l14.m1.2.3.2.3.2">𝑡</ci><ci id="alg1.l14.m1.2.3.2.3.3.cmml" xref="alg1.l14.m1.2.3.2.3.3">𝑟</ci><ci id="alg1.l14.m1.2.3.2.3.4.cmml" xref="alg1.l14.m1.2.3.2.3.4">𝑎</ci><ci id="alg1.l14.m1.2.3.2.3.5.cmml" xref="alg1.l14.m1.2.3.2.3.5">𝑖</ci><ci id="alg1.l14.m1.2.3.2.3.6.cmml" xref="alg1.l14.m1.2.3.2.3.6">𝑛</ci></apply></apply><apply id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2"><divide id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2"></divide><apply id="alg1.l14.m1.2.2.2.cmml" xref="alg1.l14.m1.2.2.2"><plus id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.3"></plus><apply id="alg1.l14.m1.2.2.2.4.cmml" xref="alg1.l14.m1.2.2.2.4"><times id="alg1.l14.m1.2.2.2.4.1.cmml" xref="alg1.l14.m1.2.2.2.4.1"></times><apply id="alg1.l14.m1.2.2.2.4.2.cmml" xref="alg1.l14.m1.2.2.2.4.2"><times id="alg1.l14.m1.2.2.2.4.2.1.cmml" xref="alg1.l14.m1.2.2.2.4.2.1"></times><apply id="alg1.l14.m1.2.2.2.4.2.2.cmml" xref="alg1.l14.m1.2.2.2.4.2.2"><times id="alg1.l14.m1.2.2.2.4.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.4.2.2.1"></times><ci id="alg1.l14.m1.2.2.2.4.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.4.2.2.2">𝐿</ci><interval closure="open" id="alg1.l14.m1.2.2.2.4.2.2.3.1.cmml" xref="alg1.l14.m1.2.2.2.4.2.2.3.2"><ci id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">𝑏</ci><ci id="alg1.l14.m1.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2">𝑊</ci></interval></apply><ci id="alg1.l14.m1.2.2.2.4.2.3.cmml" xref="alg1.l14.m1.2.2.2.4.2.3">𝐼</ci></apply><ci id="alg1.l14.m1.2.2.2.4.3.cmml" xref="alg1.l14.m1.2.2.2.4.3">𝑑</ci><apply id="alg1.l14.m1.2.2.2.4.4.cmml" xref="alg1.l14.m1.2.2.2.4.4"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.4.4.1.cmml" xref="alg1.l14.m1.2.2.2.4.4">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.4.4.2.cmml" xref="alg1.l14.m1.2.2.2.4.4.2">𝑥</ci><ci id="alg1.l14.m1.2.2.2.4.4.3.cmml" xref="alg1.l14.m1.2.2.2.4.4.3">𝑏</ci></apply></apply><ci id="alg1.l14.m1.2.2.2.5.cmml" xref="alg1.l14.m1.2.2.2.5">𝑊</ci></apply><apply id="alg1.l14.m1.2.2.4.cmml" xref="alg1.l14.m1.2.2.4"><plus id="alg1.l14.m1.2.2.4.1.cmml" xref="alg1.l14.m1.2.2.4.1"></plus><apply id="alg1.l14.m1.2.2.4.2.cmml" xref="alg1.l14.m1.2.2.4.2"><times id="alg1.l14.m1.2.2.4.2.1.cmml" xref="alg1.l14.m1.2.2.4.2.1"></times><ci id="alg1.l14.m1.2.2.4.2.2.cmml" xref="alg1.l14.m1.2.2.4.2.2">𝐼</ci><ci id="alg1.l14.m1.2.2.4.2.3.cmml" xref="alg1.l14.m1.2.2.4.2.3">𝑑</ci><apply id="alg1.l14.m1.2.2.4.2.4.cmml" xref="alg1.l14.m1.2.2.4.2.4"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.4.2.4.1.cmml" xref="alg1.l14.m1.2.2.4.2.4">subscript</csymbol><ci id="alg1.l14.m1.2.2.4.2.4.2.cmml" xref="alg1.l14.m1.2.2.4.2.4.2">𝑥</ci><ci id="alg1.l14.m1.2.2.4.2.4.3.cmml" xref="alg1.l14.m1.2.2.4.2.4.3">𝑏</ci></apply></apply><cn type="integer" id="alg1.l14.m1.2.2.4.3.cmml" xref="alg1.l14.m1.2.2.4.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">L_{train}\leftarrow\frac{L(b,W)*Idx_{b}+W}{Idx_{b}+1}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math id="alg1.l15.m1.2" class="ltx_Math" alttext="W\leftarrow W-\eta\nabla L(b,W)" display="inline"><semantics id="alg1.l15.m1.2a"><mrow id="alg1.l15.m1.2.3" xref="alg1.l15.m1.2.3.cmml"><mi id="alg1.l15.m1.2.3.2" xref="alg1.l15.m1.2.3.2.cmml">W</mi><mo stretchy="false" id="alg1.l15.m1.2.3.1" xref="alg1.l15.m1.2.3.1.cmml">←</mo><mrow id="alg1.l15.m1.2.3.3" xref="alg1.l15.m1.2.3.3.cmml"><mi id="alg1.l15.m1.2.3.3.2" xref="alg1.l15.m1.2.3.3.2.cmml">W</mi><mo id="alg1.l15.m1.2.3.3.1" xref="alg1.l15.m1.2.3.3.1.cmml">−</mo><mrow id="alg1.l15.m1.2.3.3.3" xref="alg1.l15.m1.2.3.3.3.cmml"><mi id="alg1.l15.m1.2.3.3.3.2" xref="alg1.l15.m1.2.3.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l15.m1.2.3.3.3.1" xref="alg1.l15.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l15.m1.2.3.3.3.3" xref="alg1.l15.m1.2.3.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l15.m1.2.3.3.3.3.1" xref="alg1.l15.m1.2.3.3.3.3.1.cmml">∇</mo><mi id="alg1.l15.m1.2.3.3.3.3.2" xref="alg1.l15.m1.2.3.3.3.3.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l15.m1.2.3.3.3.1a" xref="alg1.l15.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l15.m1.2.3.3.3.4.2" xref="alg1.l15.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg1.l15.m1.2.3.3.3.4.2.1" xref="alg1.l15.m1.2.3.3.3.4.1.cmml">(</mo><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">b</mi><mo id="alg1.l15.m1.2.3.3.3.4.2.2" xref="alg1.l15.m1.2.3.3.3.4.1.cmml">,</mo><mi id="alg1.l15.m1.2.2" xref="alg1.l15.m1.2.2.cmml">W</mi><mo stretchy="false" id="alg1.l15.m1.2.3.3.3.4.2.3" xref="alg1.l15.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.2b"><apply id="alg1.l15.m1.2.3.cmml" xref="alg1.l15.m1.2.3"><ci id="alg1.l15.m1.2.3.1.cmml" xref="alg1.l15.m1.2.3.1">←</ci><ci id="alg1.l15.m1.2.3.2.cmml" xref="alg1.l15.m1.2.3.2">𝑊</ci><apply id="alg1.l15.m1.2.3.3.cmml" xref="alg1.l15.m1.2.3.3"><minus id="alg1.l15.m1.2.3.3.1.cmml" xref="alg1.l15.m1.2.3.3.1"></minus><ci id="alg1.l15.m1.2.3.3.2.cmml" xref="alg1.l15.m1.2.3.3.2">𝑊</ci><apply id="alg1.l15.m1.2.3.3.3.cmml" xref="alg1.l15.m1.2.3.3.3"><times id="alg1.l15.m1.2.3.3.3.1.cmml" xref="alg1.l15.m1.2.3.3.3.1"></times><ci id="alg1.l15.m1.2.3.3.3.2.cmml" xref="alg1.l15.m1.2.3.3.3.2">𝜂</ci><apply id="alg1.l15.m1.2.3.3.3.3.cmml" xref="alg1.l15.m1.2.3.3.3.3"><ci id="alg1.l15.m1.2.3.3.3.3.1.cmml" xref="alg1.l15.m1.2.3.3.3.3.1">∇</ci><ci id="alg1.l15.m1.2.3.3.3.3.2.cmml" xref="alg1.l15.m1.2.3.3.3.3.2">𝐿</ci></apply><interval closure="open" id="alg1.l15.m1.2.3.3.3.4.1.cmml" xref="alg1.l15.m1.2.3.3.3.4.2"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑏</ci><ci id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2">𝑊</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.2c">W\leftarrow W-\eta\nabla L(b,W)</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>        <span id="alg1.l16.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l16.m1.1" class="ltx_math_unparsed" alttext="Switch_{1}==True" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1b"><mi id="alg1.l16.m1.1.1">S</mi><mi id="alg1.l16.m1.1.2">w</mi><mi id="alg1.l16.m1.1.3">i</mi><mi id="alg1.l16.m1.1.4">t</mi><mi id="alg1.l16.m1.1.5">c</mi><msub id="alg1.l16.m1.1.6"><mi id="alg1.l16.m1.1.6.2">h</mi><mn id="alg1.l16.m1.1.6.3">1</mn></msub><mo rspace="0em" id="alg1.l16.m1.1.7">=</mo><mo lspace="0em" id="alg1.l16.m1.1.8">=</mo><mi id="alg1.l16.m1.1.9">T</mi><mi id="alg1.l16.m1.1.10">r</mi><mi id="alg1.l16.m1.1.11">u</mi><mi id="alg1.l16.m1.1.12">e</mi></mrow><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">Switch_{1}==True</annotation></semantics></math> <span id="alg1.l16.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>           <math id="alg1.l17.m1.1" class="ltx_Math" alttext="W_{SWA}\leftarrow\frac{W_{SWA}*Idx_{b}+W}{Idx_{b}+1}" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msub id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml"><mi id="alg1.l17.m1.1.1.2.2" xref="alg1.l17.m1.1.1.2.2.cmml">W</mi><mrow id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml"><mi id="alg1.l17.m1.1.1.2.3.2" xref="alg1.l17.m1.1.1.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.2.3.1" xref="alg1.l17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l17.m1.1.1.2.3.3" xref="alg1.l17.m1.1.1.2.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.2.3.1a" xref="alg1.l17.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l17.m1.1.1.2.3.4" xref="alg1.l17.m1.1.1.2.3.4.cmml">A</mi></mrow></msub><mo stretchy="false" id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">←</mo><mfrac id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mrow id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml"><mrow id="alg1.l17.m1.1.1.3.2.2" xref="alg1.l17.m1.1.1.3.2.2.cmml"><mrow id="alg1.l17.m1.1.1.3.2.2.2" xref="alg1.l17.m1.1.1.3.2.2.2.cmml"><msub id="alg1.l17.m1.1.1.3.2.2.2.2" xref="alg1.l17.m1.1.1.3.2.2.2.2.cmml"><mi id="alg1.l17.m1.1.1.3.2.2.2.2.2" xref="alg1.l17.m1.1.1.3.2.2.2.2.2.cmml">W</mi><mrow id="alg1.l17.m1.1.1.3.2.2.2.2.3" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.cmml"><mi id="alg1.l17.m1.1.1.3.2.2.2.2.3.2" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.3.2.2.2.2.3.1" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l17.m1.1.1.3.2.2.2.2.3.3" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.3.2.2.2.2.3.1a" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l17.m1.1.1.3.2.2.2.2.3.4" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.4.cmml">A</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l17.m1.1.1.3.2.2.2.1" xref="alg1.l17.m1.1.1.3.2.2.2.1.cmml">∗</mo><mi id="alg1.l17.m1.1.1.3.2.2.2.3" xref="alg1.l17.m1.1.1.3.2.2.2.3.cmml">I</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.3.2.2.1" xref="alg1.l17.m1.1.1.3.2.2.1.cmml">​</mo><mi id="alg1.l17.m1.1.1.3.2.2.3" xref="alg1.l17.m1.1.1.3.2.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.3.2.2.1a" xref="alg1.l17.m1.1.1.3.2.2.1.cmml">​</mo><msub id="alg1.l17.m1.1.1.3.2.2.4" xref="alg1.l17.m1.1.1.3.2.2.4.cmml"><mi id="alg1.l17.m1.1.1.3.2.2.4.2" xref="alg1.l17.m1.1.1.3.2.2.4.2.cmml">x</mi><mi id="alg1.l17.m1.1.1.3.2.2.4.3" xref="alg1.l17.m1.1.1.3.2.2.4.3.cmml">b</mi></msub></mrow><mo id="alg1.l17.m1.1.1.3.2.1" xref="alg1.l17.m1.1.1.3.2.1.cmml">+</mo><mi id="alg1.l17.m1.1.1.3.2.3" xref="alg1.l17.m1.1.1.3.2.3.cmml">W</mi></mrow><mrow id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml"><mrow id="alg1.l17.m1.1.1.3.3.2" xref="alg1.l17.m1.1.1.3.3.2.cmml"><mi id="alg1.l17.m1.1.1.3.3.2.2" xref="alg1.l17.m1.1.1.3.3.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.3.3.2.1" xref="alg1.l17.m1.1.1.3.3.2.1.cmml">​</mo><mi id="alg1.l17.m1.1.1.3.3.2.3" xref="alg1.l17.m1.1.1.3.3.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.3.3.2.1a" xref="alg1.l17.m1.1.1.3.3.2.1.cmml">​</mo><msub id="alg1.l17.m1.1.1.3.3.2.4" xref="alg1.l17.m1.1.1.3.3.2.4.cmml"><mi id="alg1.l17.m1.1.1.3.3.2.4.2" xref="alg1.l17.m1.1.1.3.3.2.4.2.cmml">x</mi><mi id="alg1.l17.m1.1.1.3.3.2.4.3" xref="alg1.l17.m1.1.1.3.3.2.4.3.cmml">b</mi></msub></mrow><mo id="alg1.l17.m1.1.1.3.3.1" xref="alg1.l17.m1.1.1.3.3.1.cmml">+</mo><mn id="alg1.l17.m1.1.1.3.3.3" xref="alg1.l17.m1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><ci id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1">←</ci><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.2">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2.2">𝑊</ci><apply id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3"><times id="alg1.l17.m1.1.1.2.3.1.cmml" xref="alg1.l17.m1.1.1.2.3.1"></times><ci id="alg1.l17.m1.1.1.2.3.2.cmml" xref="alg1.l17.m1.1.1.2.3.2">𝑆</ci><ci id="alg1.l17.m1.1.1.2.3.3.cmml" xref="alg1.l17.m1.1.1.2.3.3">𝑊</ci><ci id="alg1.l17.m1.1.1.2.3.4.cmml" xref="alg1.l17.m1.1.1.2.3.4">𝐴</ci></apply></apply><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><divide id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3"></divide><apply id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2"><plus id="alg1.l17.m1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.3.2.1"></plus><apply id="alg1.l17.m1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2"><times id="alg1.l17.m1.1.1.3.2.2.1.cmml" xref="alg1.l17.m1.1.1.3.2.2.1"></times><apply id="alg1.l17.m1.1.1.3.2.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2.2"><times id="alg1.l17.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.1"></times><apply id="alg1.l17.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.2.2.2.1.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.2.2.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2.2">𝑊</ci><apply id="alg1.l17.m1.1.1.3.2.2.2.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2.3"><times id="alg1.l17.m1.1.1.3.2.2.2.2.3.1.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.1"></times><ci id="alg1.l17.m1.1.1.3.2.2.2.2.3.2.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.2">𝑆</ci><ci id="alg1.l17.m1.1.1.3.2.2.2.2.3.3.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.3">𝑊</ci><ci id="alg1.l17.m1.1.1.3.2.2.2.2.3.4.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.2.3.4">𝐴</ci></apply></apply><ci id="alg1.l17.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.2.2.3">𝐼</ci></apply><ci id="alg1.l17.m1.1.1.3.2.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.2.3">𝑑</ci><apply id="alg1.l17.m1.1.1.3.2.2.4.cmml" xref="alg1.l17.m1.1.1.3.2.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.2.4.1.cmml" xref="alg1.l17.m1.1.1.3.2.2.4">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.2.4.2.cmml" xref="alg1.l17.m1.1.1.3.2.2.4.2">𝑥</ci><ci id="alg1.l17.m1.1.1.3.2.2.4.3.cmml" xref="alg1.l17.m1.1.1.3.2.2.4.3">𝑏</ci></apply></apply><ci id="alg1.l17.m1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.3">𝑊</ci></apply><apply id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3"><plus id="alg1.l17.m1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3.1"></plus><apply id="alg1.l17.m1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.2"><times id="alg1.l17.m1.1.1.3.3.2.1.cmml" xref="alg1.l17.m1.1.1.3.3.2.1"></times><ci id="alg1.l17.m1.1.1.3.3.2.2.cmml" xref="alg1.l17.m1.1.1.3.3.2.2">𝐼</ci><ci id="alg1.l17.m1.1.1.3.3.2.3.cmml" xref="alg1.l17.m1.1.1.3.3.2.3">𝑑</ci><apply id="alg1.l17.m1.1.1.3.3.2.4.cmml" xref="alg1.l17.m1.1.1.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.3.2.4.1.cmml" xref="alg1.l17.m1.1.1.3.3.2.4">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.3.2.4.2.cmml" xref="alg1.l17.m1.1.1.3.3.2.4.2">𝑥</ci><ci id="alg1.l17.m1.1.1.3.3.2.4.3.cmml" xref="alg1.l17.m1.1.1.3.3.2.4.3">𝑏</ci></apply></apply><cn type="integer" id="alg1.l17.m1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">W_{SWA}\leftarrow\frac{W_{SWA}*Idx_{b}+W}{Idx_{b}+1}</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>        <span id="alg1.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>        <math id="alg1.l19.m1.1" class="ltx_Math" alttext="Idx_{b}\leftarrow Idx_{b}+1" display="inline"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><mrow id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml"><mi id="alg1.l19.m1.1.1.2.2" xref="alg1.l19.m1.1.1.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.1.1.2.1" xref="alg1.l19.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l19.m1.1.1.2.3" xref="alg1.l19.m1.1.1.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.1.1.2.1a" xref="alg1.l19.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l19.m1.1.1.2.4" xref="alg1.l19.m1.1.1.2.4.cmml"><mi id="alg1.l19.m1.1.1.2.4.2" xref="alg1.l19.m1.1.1.2.4.2.cmml">x</mi><mi id="alg1.l19.m1.1.1.2.4.3" xref="alg1.l19.m1.1.1.2.4.3.cmml">b</mi></msub></mrow><mo stretchy="false" id="alg1.l19.m1.1.1.1" xref="alg1.l19.m1.1.1.1.cmml">←</mo><mrow id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml"><mrow id="alg1.l19.m1.1.1.3.2" xref="alg1.l19.m1.1.1.3.2.cmml"><mi id="alg1.l19.m1.1.1.3.2.2" xref="alg1.l19.m1.1.1.3.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.1.1.3.2.1" xref="alg1.l19.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.l19.m1.1.1.3.2.3" xref="alg1.l19.m1.1.1.3.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l19.m1.1.1.3.2.1a" xref="alg1.l19.m1.1.1.3.2.1.cmml">​</mo><msub id="alg1.l19.m1.1.1.3.2.4" xref="alg1.l19.m1.1.1.3.2.4.cmml"><mi id="alg1.l19.m1.1.1.3.2.4.2" xref="alg1.l19.m1.1.1.3.2.4.2.cmml">x</mi><mi id="alg1.l19.m1.1.1.3.2.4.3" xref="alg1.l19.m1.1.1.3.2.4.3.cmml">b</mi></msub></mrow><mo id="alg1.l19.m1.1.1.3.1" xref="alg1.l19.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l19.m1.1.1.3.3" xref="alg1.l19.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><ci id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1">←</ci><apply id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2"><times id="alg1.l19.m1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.2.1"></times><ci id="alg1.l19.m1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.2.2">𝐼</ci><ci id="alg1.l19.m1.1.1.2.3.cmml" xref="alg1.l19.m1.1.1.2.3">𝑑</ci><apply id="alg1.l19.m1.1.1.2.4.cmml" xref="alg1.l19.m1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.2.4.1.cmml" xref="alg1.l19.m1.1.1.2.4">subscript</csymbol><ci id="alg1.l19.m1.1.1.2.4.2.cmml" xref="alg1.l19.m1.1.1.2.4.2">𝑥</ci><ci id="alg1.l19.m1.1.1.2.4.3.cmml" xref="alg1.l19.m1.1.1.2.4.3">𝑏</ci></apply></apply><apply id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3"><plus id="alg1.l19.m1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.3.1"></plus><apply id="alg1.l19.m1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.3.2"><times id="alg1.l19.m1.1.1.3.2.1.cmml" xref="alg1.l19.m1.1.1.3.2.1"></times><ci id="alg1.l19.m1.1.1.3.2.2.cmml" xref="alg1.l19.m1.1.1.3.2.2">𝐼</ci><ci id="alg1.l19.m1.1.1.3.2.3.cmml" xref="alg1.l19.m1.1.1.3.2.3">𝑑</ci><apply id="alg1.l19.m1.1.1.3.2.4.cmml" xref="alg1.l19.m1.1.1.3.2.4"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.2.4.1.cmml" xref="alg1.l19.m1.1.1.3.2.4">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.2.4.2.cmml" xref="alg1.l19.m1.1.1.3.2.4.2">𝑥</ci><ci id="alg1.l19.m1.1.1.3.2.4.3.cmml" xref="alg1.l19.m1.1.1.3.2.4.3">𝑏</ci></apply></apply><cn type="integer" id="alg1.l19.m1.1.1.3.3.cmml" xref="alg1.l19.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">Idx_{b}\leftarrow Idx_{b}+1</annotation></semantics></math>

</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>     <span id="alg1.l20.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l20.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>  <span id="alg1.l21.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l21.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>  <span id="alg1.l22.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l22.m1.1" class="ltx_math_unparsed" alttext="Switch_{1}==True" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1b"><mi id="alg1.l22.m1.1.1">S</mi><mi id="alg1.l22.m1.1.2">w</mi><mi id="alg1.l22.m1.1.3">i</mi><mi id="alg1.l22.m1.1.4">t</mi><mi id="alg1.l22.m1.1.5">c</mi><msub id="alg1.l22.m1.1.6"><mi id="alg1.l22.m1.1.6.2">h</mi><mn id="alg1.l22.m1.1.6.3">1</mn></msub><mo rspace="0em" id="alg1.l22.m1.1.7">=</mo><mo lspace="0em" id="alg1.l22.m1.1.8">=</mo><mi id="alg1.l22.m1.1.9">T</mi><mi id="alg1.l22.m1.1.10">r</mi><mi id="alg1.l22.m1.1.11">u</mi><mi id="alg1.l22.m1.1.12">e</mi></mrow><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">Switch_{1}==True</annotation></semantics></math> <span id="alg1.l22.2" class="ltx_text"> and </span> <math id="alg1.l22.m2.1" class="ltx_Math" alttext="L_{train}&lt;L_{EMA}" display="inline"><semantics id="alg1.l22.m2.1a"><mrow id="alg1.l22.m2.1.1" xref="alg1.l22.m2.1.1.cmml"><msub id="alg1.l22.m2.1.1.2" xref="alg1.l22.m2.1.1.2.cmml"><mi id="alg1.l22.m2.1.1.2.2" xref="alg1.l22.m2.1.1.2.2.cmml">L</mi><mrow id="alg1.l22.m2.1.1.2.3" xref="alg1.l22.m2.1.1.2.3.cmml"><mi id="alg1.l22.m2.1.1.2.3.2" xref="alg1.l22.m2.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m2.1.1.2.3.1" xref="alg1.l22.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l22.m2.1.1.2.3.3" xref="alg1.l22.m2.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m2.1.1.2.3.1a" xref="alg1.l22.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l22.m2.1.1.2.3.4" xref="alg1.l22.m2.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m2.1.1.2.3.1b" xref="alg1.l22.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l22.m2.1.1.2.3.5" xref="alg1.l22.m2.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m2.1.1.2.3.1c" xref="alg1.l22.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l22.m2.1.1.2.3.6" xref="alg1.l22.m2.1.1.2.3.6.cmml">n</mi></mrow></msub><mo id="alg1.l22.m2.1.1.1" xref="alg1.l22.m2.1.1.1.cmml">&lt;</mo><msub id="alg1.l22.m2.1.1.3" xref="alg1.l22.m2.1.1.3.cmml"><mi id="alg1.l22.m2.1.1.3.2" xref="alg1.l22.m2.1.1.3.2.cmml">L</mi><mrow id="alg1.l22.m2.1.1.3.3" xref="alg1.l22.m2.1.1.3.3.cmml"><mi id="alg1.l22.m2.1.1.3.3.2" xref="alg1.l22.m2.1.1.3.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m2.1.1.3.3.1" xref="alg1.l22.m2.1.1.3.3.1.cmml">​</mo><mi id="alg1.l22.m2.1.1.3.3.3" xref="alg1.l22.m2.1.1.3.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m2.1.1.3.3.1a" xref="alg1.l22.m2.1.1.3.3.1.cmml">​</mo><mi id="alg1.l22.m2.1.1.3.3.4" xref="alg1.l22.m2.1.1.3.3.4.cmml">A</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m2.1b"><apply id="alg1.l22.m2.1.1.cmml" xref="alg1.l22.m2.1.1"><lt id="alg1.l22.m2.1.1.1.cmml" xref="alg1.l22.m2.1.1.1"></lt><apply id="alg1.l22.m2.1.1.2.cmml" xref="alg1.l22.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l22.m2.1.1.2.1.cmml" xref="alg1.l22.m2.1.1.2">subscript</csymbol><ci id="alg1.l22.m2.1.1.2.2.cmml" xref="alg1.l22.m2.1.1.2.2">𝐿</ci><apply id="alg1.l22.m2.1.1.2.3.cmml" xref="alg1.l22.m2.1.1.2.3"><times id="alg1.l22.m2.1.1.2.3.1.cmml" xref="alg1.l22.m2.1.1.2.3.1"></times><ci id="alg1.l22.m2.1.1.2.3.2.cmml" xref="alg1.l22.m2.1.1.2.3.2">𝑡</ci><ci id="alg1.l22.m2.1.1.2.3.3.cmml" xref="alg1.l22.m2.1.1.2.3.3">𝑟</ci><ci id="alg1.l22.m2.1.1.2.3.4.cmml" xref="alg1.l22.m2.1.1.2.3.4">𝑎</ci><ci id="alg1.l22.m2.1.1.2.3.5.cmml" xref="alg1.l22.m2.1.1.2.3.5">𝑖</ci><ci id="alg1.l22.m2.1.1.2.3.6.cmml" xref="alg1.l22.m2.1.1.2.3.6">𝑛</ci></apply></apply><apply id="alg1.l22.m2.1.1.3.cmml" xref="alg1.l22.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l22.m2.1.1.3.1.cmml" xref="alg1.l22.m2.1.1.3">subscript</csymbol><ci id="alg1.l22.m2.1.1.3.2.cmml" xref="alg1.l22.m2.1.1.3.2">𝐿</ci><apply id="alg1.l22.m2.1.1.3.3.cmml" xref="alg1.l22.m2.1.1.3.3"><times id="alg1.l22.m2.1.1.3.3.1.cmml" xref="alg1.l22.m2.1.1.3.3.1"></times><ci id="alg1.l22.m2.1.1.3.3.2.cmml" xref="alg1.l22.m2.1.1.3.3.2">𝐸</ci><ci id="alg1.l22.m2.1.1.3.3.3.cmml" xref="alg1.l22.m2.1.1.3.3.3">𝑀</ci><ci id="alg1.l22.m2.1.1.3.3.4.cmml" xref="alg1.l22.m2.1.1.3.3.4">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m2.1c">L_{train}&lt;L_{EMA}</annotation></semantics></math>  <span id="alg1.l22.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>     <math id="alg1.l23.m1.1" class="ltx_Math" alttext="Switch_{2}=True" display="inline"><semantics id="alg1.l23.m1.1a"><mrow id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><mrow id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml"><mi id="alg1.l23.m1.1.1.2.2" xref="alg1.l23.m1.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.2.1" xref="alg1.l23.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l23.m1.1.1.2.3" xref="alg1.l23.m1.1.1.2.3.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.2.1a" xref="alg1.l23.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l23.m1.1.1.2.4" xref="alg1.l23.m1.1.1.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.2.1b" xref="alg1.l23.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l23.m1.1.1.2.5" xref="alg1.l23.m1.1.1.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.2.1c" xref="alg1.l23.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l23.m1.1.1.2.6" xref="alg1.l23.m1.1.1.2.6.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.2.1d" xref="alg1.l23.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l23.m1.1.1.2.7" xref="alg1.l23.m1.1.1.2.7.cmml"><mi id="alg1.l23.m1.1.1.2.7.2" xref="alg1.l23.m1.1.1.2.7.2.cmml">h</mi><mn id="alg1.l23.m1.1.1.2.7.3" xref="alg1.l23.m1.1.1.2.7.3.cmml">2</mn></msub></mrow><mo id="alg1.l23.m1.1.1.1" xref="alg1.l23.m1.1.1.1.cmml">=</mo><mrow id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml"><mi id="alg1.l23.m1.1.1.3.2" xref="alg1.l23.m1.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.3.1" xref="alg1.l23.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l23.m1.1.1.3.3" xref="alg1.l23.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.3.1a" xref="alg1.l23.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l23.m1.1.1.3.4" xref="alg1.l23.m1.1.1.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l23.m1.1.1.3.1b" xref="alg1.l23.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l23.m1.1.1.3.5" xref="alg1.l23.m1.1.1.3.5.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><eq id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1"></eq><apply id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2"><times id="alg1.l23.m1.1.1.2.1.cmml" xref="alg1.l23.m1.1.1.2.1"></times><ci id="alg1.l23.m1.1.1.2.2.cmml" xref="alg1.l23.m1.1.1.2.2">𝑆</ci><ci id="alg1.l23.m1.1.1.2.3.cmml" xref="alg1.l23.m1.1.1.2.3">𝑤</ci><ci id="alg1.l23.m1.1.1.2.4.cmml" xref="alg1.l23.m1.1.1.2.4">𝑖</ci><ci id="alg1.l23.m1.1.1.2.5.cmml" xref="alg1.l23.m1.1.1.2.5">𝑡</ci><ci id="alg1.l23.m1.1.1.2.6.cmml" xref="alg1.l23.m1.1.1.2.6">𝑐</ci><apply id="alg1.l23.m1.1.1.2.7.cmml" xref="alg1.l23.m1.1.1.2.7"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.2.7.1.cmml" xref="alg1.l23.m1.1.1.2.7">subscript</csymbol><ci id="alg1.l23.m1.1.1.2.7.2.cmml" xref="alg1.l23.m1.1.1.2.7.2">ℎ</ci><cn type="integer" id="alg1.l23.m1.1.1.2.7.3.cmml" xref="alg1.l23.m1.1.1.2.7.3">2</cn></apply></apply><apply id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3"><times id="alg1.l23.m1.1.1.3.1.cmml" xref="alg1.l23.m1.1.1.3.1"></times><ci id="alg1.l23.m1.1.1.3.2.cmml" xref="alg1.l23.m1.1.1.3.2">𝑇</ci><ci id="alg1.l23.m1.1.1.3.3.cmml" xref="alg1.l23.m1.1.1.3.3">𝑟</ci><ci id="alg1.l23.m1.1.1.3.4.cmml" xref="alg1.l23.m1.1.1.3.4">𝑢</ci><ci id="alg1.l23.m1.1.1.3.5.cmml" xref="alg1.l23.m1.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">Switch_{2}=True</annotation></semantics></math>

</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>  <span id="alg1.l24.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l24.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>  <span id="alg1.l25.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l25.m1.1" class="ltx_math_unparsed" alttext="Switch_{2}==True" display="inline"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1b"><mi id="alg1.l25.m1.1.1">S</mi><mi id="alg1.l25.m1.1.2">w</mi><mi id="alg1.l25.m1.1.3">i</mi><mi id="alg1.l25.m1.1.4">t</mi><mi id="alg1.l25.m1.1.5">c</mi><msub id="alg1.l25.m1.1.6"><mi id="alg1.l25.m1.1.6.2">h</mi><mn id="alg1.l25.m1.1.6.3">2</mn></msub><mo rspace="0em" id="alg1.l25.m1.1.7">=</mo><mo lspace="0em" id="alg1.l25.m1.1.8">=</mo><mi id="alg1.l25.m1.1.9">T</mi><mi id="alg1.l25.m1.1.10">r</mi><mi id="alg1.l25.m1.1.11">u</mi><mi id="alg1.l25.m1.1.12">e</mi></mrow><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">Switch_{2}==True</annotation></semantics></math> <span id="alg1.l25.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>     <math id="alg1.l26.m1.1" class="ltx_Math" alttext="W_{return}=W_{SWA}" display="inline"><semantics id="alg1.l26.m1.1a"><mrow id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml"><msub id="alg1.l26.m1.1.1.2" xref="alg1.l26.m1.1.1.2.cmml"><mi id="alg1.l26.m1.1.1.2.2" xref="alg1.l26.m1.1.1.2.2.cmml">W</mi><mrow id="alg1.l26.m1.1.1.2.3" xref="alg1.l26.m1.1.1.2.3.cmml"><mi id="alg1.l26.m1.1.1.2.3.2" xref="alg1.l26.m1.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.1.2.3.1" xref="alg1.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l26.m1.1.1.2.3.3" xref="alg1.l26.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.1.2.3.1a" xref="alg1.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l26.m1.1.1.2.3.4" xref="alg1.l26.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.1.2.3.1b" xref="alg1.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l26.m1.1.1.2.3.5" xref="alg1.l26.m1.1.1.2.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.1.2.3.1c" xref="alg1.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l26.m1.1.1.2.3.6" xref="alg1.l26.m1.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.1.2.3.1d" xref="alg1.l26.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l26.m1.1.1.2.3.7" xref="alg1.l26.m1.1.1.2.3.7.cmml">n</mi></mrow></msub><mo id="alg1.l26.m1.1.1.1" xref="alg1.l26.m1.1.1.1.cmml">=</mo><msub id="alg1.l26.m1.1.1.3" xref="alg1.l26.m1.1.1.3.cmml"><mi id="alg1.l26.m1.1.1.3.2" xref="alg1.l26.m1.1.1.3.2.cmml">W</mi><mrow id="alg1.l26.m1.1.1.3.3" xref="alg1.l26.m1.1.1.3.3.cmml"><mi id="alg1.l26.m1.1.1.3.3.2" xref="alg1.l26.m1.1.1.3.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.1.3.3.1" xref="alg1.l26.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l26.m1.1.1.3.3.3" xref="alg1.l26.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.1.3.3.1a" xref="alg1.l26.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l26.m1.1.1.3.3.4" xref="alg1.l26.m1.1.1.3.3.4.cmml">A</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><apply id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1"><eq id="alg1.l26.m1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1"></eq><apply id="alg1.l26.m1.1.1.2.cmml" xref="alg1.l26.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.2.1.cmml" xref="alg1.l26.m1.1.1.2">subscript</csymbol><ci id="alg1.l26.m1.1.1.2.2.cmml" xref="alg1.l26.m1.1.1.2.2">𝑊</ci><apply id="alg1.l26.m1.1.1.2.3.cmml" xref="alg1.l26.m1.1.1.2.3"><times id="alg1.l26.m1.1.1.2.3.1.cmml" xref="alg1.l26.m1.1.1.2.3.1"></times><ci id="alg1.l26.m1.1.1.2.3.2.cmml" xref="alg1.l26.m1.1.1.2.3.2">𝑟</ci><ci id="alg1.l26.m1.1.1.2.3.3.cmml" xref="alg1.l26.m1.1.1.2.3.3">𝑒</ci><ci id="alg1.l26.m1.1.1.2.3.4.cmml" xref="alg1.l26.m1.1.1.2.3.4">𝑡</ci><ci id="alg1.l26.m1.1.1.2.3.5.cmml" xref="alg1.l26.m1.1.1.2.3.5">𝑢</ci><ci id="alg1.l26.m1.1.1.2.3.6.cmml" xref="alg1.l26.m1.1.1.2.3.6">𝑟</ci><ci id="alg1.l26.m1.1.1.2.3.7.cmml" xref="alg1.l26.m1.1.1.2.3.7">𝑛</ci></apply></apply><apply id="alg1.l26.m1.1.1.3.cmml" xref="alg1.l26.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.3.1.cmml" xref="alg1.l26.m1.1.1.3">subscript</csymbol><ci id="alg1.l26.m1.1.1.3.2.cmml" xref="alg1.l26.m1.1.1.3.2">𝑊</ci><apply id="alg1.l26.m1.1.1.3.3.cmml" xref="alg1.l26.m1.1.1.3.3"><times id="alg1.l26.m1.1.1.3.3.1.cmml" xref="alg1.l26.m1.1.1.3.3.1"></times><ci id="alg1.l26.m1.1.1.3.3.2.cmml" xref="alg1.l26.m1.1.1.3.3.2">𝑆</ci><ci id="alg1.l26.m1.1.1.3.3.3.cmml" xref="alg1.l26.m1.1.1.3.3.3">𝑊</ci><ci id="alg1.l26.m1.1.1.3.3.4.cmml" xref="alg1.l26.m1.1.1.3.3.4">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">W_{return}=W_{SWA}</annotation></semantics></math>

</div>
<div id="alg1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27:</span>  <span id="alg1.l27.1" class="ltx_text ltx_font_bold">else</span>


</div>
<div id="alg1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28:</span>     <math id="alg1.l28.m1.1" class="ltx_Math" alttext="W_{return}=W" display="inline"><semantics id="alg1.l28.m1.1a"><mrow id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml"><msub id="alg1.l28.m1.1.1.2" xref="alg1.l28.m1.1.1.2.cmml"><mi id="alg1.l28.m1.1.1.2.2" xref="alg1.l28.m1.1.1.2.2.cmml">W</mi><mrow id="alg1.l28.m1.1.1.2.3" xref="alg1.l28.m1.1.1.2.3.cmml"><mi id="alg1.l28.m1.1.1.2.3.2" xref="alg1.l28.m1.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l28.m1.1.1.2.3.1" xref="alg1.l28.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l28.m1.1.1.2.3.3" xref="alg1.l28.m1.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l28.m1.1.1.2.3.1a" xref="alg1.l28.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l28.m1.1.1.2.3.4" xref="alg1.l28.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l28.m1.1.1.2.3.1b" xref="alg1.l28.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l28.m1.1.1.2.3.5" xref="alg1.l28.m1.1.1.2.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l28.m1.1.1.2.3.1c" xref="alg1.l28.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l28.m1.1.1.2.3.6" xref="alg1.l28.m1.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l28.m1.1.1.2.3.1d" xref="alg1.l28.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l28.m1.1.1.2.3.7" xref="alg1.l28.m1.1.1.2.3.7.cmml">n</mi></mrow></msub><mo id="alg1.l28.m1.1.1.1" xref="alg1.l28.m1.1.1.1.cmml">=</mo><mi id="alg1.l28.m1.1.1.3" xref="alg1.l28.m1.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.1b"><apply id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1"><eq id="alg1.l28.m1.1.1.1.cmml" xref="alg1.l28.m1.1.1.1"></eq><apply id="alg1.l28.m1.1.1.2.cmml" xref="alg1.l28.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l28.m1.1.1.2.1.cmml" xref="alg1.l28.m1.1.1.2">subscript</csymbol><ci id="alg1.l28.m1.1.1.2.2.cmml" xref="alg1.l28.m1.1.1.2.2">𝑊</ci><apply id="alg1.l28.m1.1.1.2.3.cmml" xref="alg1.l28.m1.1.1.2.3"><times id="alg1.l28.m1.1.1.2.3.1.cmml" xref="alg1.l28.m1.1.1.2.3.1"></times><ci id="alg1.l28.m1.1.1.2.3.2.cmml" xref="alg1.l28.m1.1.1.2.3.2">𝑟</ci><ci id="alg1.l28.m1.1.1.2.3.3.cmml" xref="alg1.l28.m1.1.1.2.3.3">𝑒</ci><ci id="alg1.l28.m1.1.1.2.3.4.cmml" xref="alg1.l28.m1.1.1.2.3.4">𝑡</ci><ci id="alg1.l28.m1.1.1.2.3.5.cmml" xref="alg1.l28.m1.1.1.2.3.5">𝑢</ci><ci id="alg1.l28.m1.1.1.2.3.6.cmml" xref="alg1.l28.m1.1.1.2.3.6">𝑟</ci><ci id="alg1.l28.m1.1.1.2.3.7.cmml" xref="alg1.l28.m1.1.1.2.3.7">𝑛</ci></apply></apply><ci id="alg1.l28.m1.1.1.3.cmml" xref="alg1.l28.m1.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.1c">W_{return}=W</annotation></semantics></math>

</div>
<div id="alg1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29:</span>  <span id="alg1.l29.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l29.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30:</span>  return <math id="alg1.l30.m1.1" class="ltx_Math" alttext="W_{return}" display="inline"><semantics id="alg1.l30.m1.1a"><msub id="alg1.l30.m1.1.1" xref="alg1.l30.m1.1.1.cmml"><mi id="alg1.l30.m1.1.1.2" xref="alg1.l30.m1.1.1.2.cmml">W</mi><mrow id="alg1.l30.m1.1.1.3" xref="alg1.l30.m1.1.1.3.cmml"><mi id="alg1.l30.m1.1.1.3.2" xref="alg1.l30.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m1.1.1.3.1" xref="alg1.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m1.1.1.3.3" xref="alg1.l30.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m1.1.1.3.1a" xref="alg1.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m1.1.1.3.4" xref="alg1.l30.m1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m1.1.1.3.1b" xref="alg1.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m1.1.1.3.5" xref="alg1.l30.m1.1.1.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m1.1.1.3.1c" xref="alg1.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m1.1.1.3.6" xref="alg1.l30.m1.1.1.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m1.1.1.3.1d" xref="alg1.l30.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m1.1.1.3.7" xref="alg1.l30.m1.1.1.3.7.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l30.m1.1b"><apply id="alg1.l30.m1.1.1.cmml" xref="alg1.l30.m1.1.1"><csymbol cd="ambiguous" id="alg1.l30.m1.1.1.1.cmml" xref="alg1.l30.m1.1.1">subscript</csymbol><ci id="alg1.l30.m1.1.1.2.cmml" xref="alg1.l30.m1.1.1.2">𝑊</ci><apply id="alg1.l30.m1.1.1.3.cmml" xref="alg1.l30.m1.1.1.3"><times id="alg1.l30.m1.1.1.3.1.cmml" xref="alg1.l30.m1.1.1.3.1"></times><ci id="alg1.l30.m1.1.1.3.2.cmml" xref="alg1.l30.m1.1.1.3.2">𝑟</ci><ci id="alg1.l30.m1.1.1.3.3.cmml" xref="alg1.l30.m1.1.1.3.3">𝑒</ci><ci id="alg1.l30.m1.1.1.3.4.cmml" xref="alg1.l30.m1.1.1.3.4">𝑡</ci><ci id="alg1.l30.m1.1.1.3.5.cmml" xref="alg1.l30.m1.1.1.3.5">𝑢</ci><ci id="alg1.l30.m1.1.1.3.6.cmml" xref="alg1.l30.m1.1.1.3.6">𝑟</ci><ci id="alg1.l30.m1.1.1.3.7.cmml" xref="alg1.l30.m1.1.1.3.7">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m1.1c">W_{return}</annotation></semantics></math>, <math id="alg1.l30.m2.1" class="ltx_Math" alttext="L_{train}" display="inline"><semantics id="alg1.l30.m2.1a"><msub id="alg1.l30.m2.1.1" xref="alg1.l30.m2.1.1.cmml"><mi id="alg1.l30.m2.1.1.2" xref="alg1.l30.m2.1.1.2.cmml">L</mi><mrow id="alg1.l30.m2.1.1.3" xref="alg1.l30.m2.1.1.3.cmml"><mi id="alg1.l30.m2.1.1.3.2" xref="alg1.l30.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m2.1.1.3.1" xref="alg1.l30.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m2.1.1.3.3" xref="alg1.l30.m2.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m2.1.1.3.1a" xref="alg1.l30.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m2.1.1.3.4" xref="alg1.l30.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m2.1.1.3.1b" xref="alg1.l30.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m2.1.1.3.5" xref="alg1.l30.m2.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l30.m2.1.1.3.1c" xref="alg1.l30.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l30.m2.1.1.3.6" xref="alg1.l30.m2.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l30.m2.1b"><apply id="alg1.l30.m2.1.1.cmml" xref="alg1.l30.m2.1.1"><csymbol cd="ambiguous" id="alg1.l30.m2.1.1.1.cmml" xref="alg1.l30.m2.1.1">subscript</csymbol><ci id="alg1.l30.m2.1.1.2.cmml" xref="alg1.l30.m2.1.1.2">𝐿</ci><apply id="alg1.l30.m2.1.1.3.cmml" xref="alg1.l30.m2.1.1.3"><times id="alg1.l30.m2.1.1.3.1.cmml" xref="alg1.l30.m2.1.1.3.1"></times><ci id="alg1.l30.m2.1.1.3.2.cmml" xref="alg1.l30.m2.1.1.3.2">𝑡</ci><ci id="alg1.l30.m2.1.1.3.3.cmml" xref="alg1.l30.m2.1.1.3.3">𝑟</ci><ci id="alg1.l30.m2.1.1.3.4.cmml" xref="alg1.l30.m2.1.1.3.4">𝑎</ci><ci id="alg1.l30.m2.1.1.3.5.cmml" xref="alg1.l30.m2.1.1.3.5">𝑖</ci><ci id="alg1.l30.m2.1.1.3.6.cmml" xref="alg1.l30.m2.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m2.1c">L_{train}</annotation></semantics></math> to server

</div>
</div>
</div>
</div>
</figure>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Bias Measurement</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p">In the context of FL, every client has a unique dataset — <span id="S5.SS1.p1.1.2" class="ltx_text ltx_font_italic">each data differently contributes to the global model</span>. Moreover, The dynamic nature of FL causes the datasets used for training not to remain constant every round <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>. With this constraint, applying a ”one-size-fits-all” approach may not yield the best results. For example, applying the same level of generalization technique to all clients could negatively affect the learning process for those using less common device types, leading to unnecessary performance degradation for them. To mitigate these effects, HeteroSwitch selectively employs the generalization techniques to the data of participating clients based on the training loss. We use the Exponential Moving Average (EMA) loss from previous communication rounds or the validation loss as the criteria for switching the generalization techniques on the client side.
<br class="ltx_break"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">EMA of Previous Train Loss <math id="S5.SS1.p1.1.1.m1.1" class="ltx_Math" alttext="L_{EMA}" display="inline"><semantics id="S5.SS1.p1.1.1.m1.1a"><msub id="S5.SS1.p1.1.1.m1.1.1" xref="S5.SS1.p1.1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.1.m1.1.1.2" xref="S5.SS1.p1.1.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS1.p1.1.1.m1.1.1.3" xref="S5.SS1.p1.1.1.m1.1.1.3.cmml"><mi id="S5.SS1.p1.1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.1.m1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.1.1.m1.1.1.3.1" xref="S5.SS1.p1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p1.1.1.m1.1.1.3.3" xref="S5.SS1.p1.1.1.m1.1.1.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.1.1.m1.1.1.3.1a" xref="S5.SS1.p1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS1.p1.1.1.m1.1.1.3.4" xref="S5.SS1.p1.1.1.m1.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.1.m1.1b"><apply id="S5.SS1.p1.1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.1.m1.1.1.2">𝐿</ci><apply id="S5.SS1.p1.1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.1.m1.1.1.3"><times id="S5.SS1.p1.1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.1.m1.1.1.3.1"></times><ci id="S5.SS1.p1.1.1.m1.1.1.3.2.cmml" xref="S5.SS1.p1.1.1.m1.1.1.3.2">𝐸</ci><ci id="S5.SS1.p1.1.1.m1.1.1.3.3.cmml" xref="S5.SS1.p1.1.1.m1.1.1.3.3">𝑀</ci><ci id="S5.SS1.p1.1.1.m1.1.1.3.4.cmml" xref="S5.SS1.p1.1.1.m1.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.1.m1.1c">L_{EMA}</annotation></semantics></math>: </span></p>
<table id="S5.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S5.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E1X.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle L_{EMA,t+1}\leftarrow\alpha*L_{cur}+(1-\alpha)*L_{EMA,t}" display="inline"><semantics id="S5.E1X.2.1.1.m1.5a"><mrow id="S5.E1X.2.1.1.m1.5.5" xref="S5.E1X.2.1.1.m1.5.5.cmml"><msub id="S5.E1X.2.1.1.m1.5.5.3" xref="S5.E1X.2.1.1.m1.5.5.3.cmml"><mi id="S5.E1X.2.1.1.m1.5.5.3.2" xref="S5.E1X.2.1.1.m1.5.5.3.2.cmml">L</mi><mrow id="S5.E1X.2.1.1.m1.2.2.2.2" xref="S5.E1X.2.1.1.m1.2.2.2.3.cmml"><mrow id="S5.E1X.2.1.1.m1.1.1.1.1.1" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S5.E1X.2.1.1.m1.1.1.1.1.1.2" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.E1X.2.1.1.m1.1.1.1.1.1.1" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S5.E1X.2.1.1.m1.1.1.1.1.1.3" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.E1X.2.1.1.m1.1.1.1.1.1.1a" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S5.E1X.2.1.1.m1.1.1.1.1.1.4" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.4.cmml">A</mi></mrow><mo id="S5.E1X.2.1.1.m1.2.2.2.2.3" xref="S5.E1X.2.1.1.m1.2.2.2.3.cmml">,</mo><mrow id="S5.E1X.2.1.1.m1.2.2.2.2.2" xref="S5.E1X.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S5.E1X.2.1.1.m1.2.2.2.2.2.2" xref="S5.E1X.2.1.1.m1.2.2.2.2.2.2.cmml">t</mi><mo id="S5.E1X.2.1.1.m1.2.2.2.2.2.1" xref="S5.E1X.2.1.1.m1.2.2.2.2.2.1.cmml">+</mo><mn id="S5.E1X.2.1.1.m1.2.2.2.2.2.3" xref="S5.E1X.2.1.1.m1.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="S5.E1X.2.1.1.m1.5.5.2" xref="S5.E1X.2.1.1.m1.5.5.2.cmml">←</mo><mrow id="S5.E1X.2.1.1.m1.5.5.1" xref="S5.E1X.2.1.1.m1.5.5.1.cmml"><mrow id="S5.E1X.2.1.1.m1.5.5.1.3" xref="S5.E1X.2.1.1.m1.5.5.1.3.cmml"><mi id="S5.E1X.2.1.1.m1.5.5.1.3.2" xref="S5.E1X.2.1.1.m1.5.5.1.3.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S5.E1X.2.1.1.m1.5.5.1.3.1" xref="S5.E1X.2.1.1.m1.5.5.1.3.1.cmml">∗</mo><msub id="S5.E1X.2.1.1.m1.5.5.1.3.3" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.cmml"><mi id="S5.E1X.2.1.1.m1.5.5.1.3.3.2" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.2.cmml">L</mi><mrow id="S5.E1X.2.1.1.m1.5.5.1.3.3.3" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.cmml"><mi id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.2" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.1" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.3" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.1a" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.1.cmml">​</mo><mi id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.4" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.4.cmml">r</mi></mrow></msub></mrow><mo id="S5.E1X.2.1.1.m1.5.5.1.2" xref="S5.E1X.2.1.1.m1.5.5.1.2.cmml">+</mo><mrow id="S5.E1X.2.1.1.m1.5.5.1.1" xref="S5.E1X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S5.E1X.2.1.1.m1.5.5.1.1.1.1" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.2" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.cmml"><mn id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.2" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.2.cmml">1</mn><mo id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.1" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml">−</mo><mi id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.3" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.3.cmml">α</mi></mrow><mo rspace="0.055em" stretchy="false" id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.3" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S5.E1X.2.1.1.m1.5.5.1.1.2" xref="S5.E1X.2.1.1.m1.5.5.1.1.2.cmml">∗</mo><msub id="S5.E1X.2.1.1.m1.5.5.1.1.3" xref="S5.E1X.2.1.1.m1.5.5.1.1.3.cmml"><mi id="S5.E1X.2.1.1.m1.5.5.1.1.3.2" xref="S5.E1X.2.1.1.m1.5.5.1.1.3.2.cmml">L</mi><mrow id="S5.E1X.2.1.1.m1.4.4.2.2" xref="S5.E1X.2.1.1.m1.4.4.2.3.cmml"><mrow id="S5.E1X.2.1.1.m1.4.4.2.2.1" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.cmml"><mi id="S5.E1X.2.1.1.m1.4.4.2.2.1.2" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.E1X.2.1.1.m1.4.4.2.2.1.1" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S5.E1X.2.1.1.m1.4.4.2.2.1.3" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S5.E1X.2.1.1.m1.4.4.2.2.1.1a" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S5.E1X.2.1.1.m1.4.4.2.2.1.4" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.4.cmml">A</mi></mrow><mo id="S5.E1X.2.1.1.m1.4.4.2.2.2" xref="S5.E1X.2.1.1.m1.4.4.2.3.cmml">,</mo><mi id="S5.E1X.2.1.1.m1.3.3.1.1" xref="S5.E1X.2.1.1.m1.3.3.1.1.cmml">t</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E1X.2.1.1.m1.5b"><apply id="S5.E1X.2.1.1.m1.5.5.cmml" xref="S5.E1X.2.1.1.m1.5.5"><ci id="S5.E1X.2.1.1.m1.5.5.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.2">←</ci><apply id="S5.E1X.2.1.1.m1.5.5.3.cmml" xref="S5.E1X.2.1.1.m1.5.5.3"><csymbol cd="ambiguous" id="S5.E1X.2.1.1.m1.5.5.3.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.3">subscript</csymbol><ci id="S5.E1X.2.1.1.m1.5.5.3.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.3.2">𝐿</ci><list id="S5.E1X.2.1.1.m1.2.2.2.3.cmml" xref="S5.E1X.2.1.1.m1.2.2.2.2"><apply id="S5.E1X.2.1.1.m1.1.1.1.1.1.cmml" xref="S5.E1X.2.1.1.m1.1.1.1.1.1"><times id="S5.E1X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.1"></times><ci id="S5.E1X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.2">𝐸</ci><ci id="S5.E1X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.3">𝑀</ci><ci id="S5.E1X.2.1.1.m1.1.1.1.1.1.4.cmml" xref="S5.E1X.2.1.1.m1.1.1.1.1.1.4">𝐴</ci></apply><apply id="S5.E1X.2.1.1.m1.2.2.2.2.2.cmml" xref="S5.E1X.2.1.1.m1.2.2.2.2.2"><plus id="S5.E1X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S5.E1X.2.1.1.m1.2.2.2.2.2.1"></plus><ci id="S5.E1X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S5.E1X.2.1.1.m1.2.2.2.2.2.2">𝑡</ci><cn type="integer" id="S5.E1X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S5.E1X.2.1.1.m1.2.2.2.2.2.3">1</cn></apply></list></apply><apply id="S5.E1X.2.1.1.m1.5.5.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1"><plus id="S5.E1X.2.1.1.m1.5.5.1.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.2"></plus><apply id="S5.E1X.2.1.1.m1.5.5.1.3.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3"><times id="S5.E1X.2.1.1.m1.5.5.1.3.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.1"></times><ci id="S5.E1X.2.1.1.m1.5.5.1.3.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.2">𝛼</ci><apply id="S5.E1X.2.1.1.m1.5.5.1.3.3.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="S5.E1X.2.1.1.m1.5.5.1.3.3.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3">subscript</csymbol><ci id="S5.E1X.2.1.1.m1.5.5.1.3.3.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.2">𝐿</ci><apply id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3"><times id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.1"></times><ci id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.2">𝑐</ci><ci id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.3.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.3">𝑢</ci><ci id="S5.E1X.2.1.1.m1.5.5.1.3.3.3.4.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.3.3.3.4">𝑟</ci></apply></apply></apply><apply id="S5.E1X.2.1.1.m1.5.5.1.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1"><times id="S5.E1X.2.1.1.m1.5.5.1.1.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.2"></times><apply id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1"><minus id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.1"></minus><cn type="integer" id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.2">1</cn><ci id="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.3.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.1.1.1.3">𝛼</ci></apply><apply id="S5.E1X.2.1.1.m1.5.5.1.1.3.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S5.E1X.2.1.1.m1.5.5.1.1.3.1.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.3">subscript</csymbol><ci id="S5.E1X.2.1.1.m1.5.5.1.1.3.2.cmml" xref="S5.E1X.2.1.1.m1.5.5.1.1.3.2">𝐿</ci><list id="S5.E1X.2.1.1.m1.4.4.2.3.cmml" xref="S5.E1X.2.1.1.m1.4.4.2.2"><apply id="S5.E1X.2.1.1.m1.4.4.2.2.1.cmml" xref="S5.E1X.2.1.1.m1.4.4.2.2.1"><times id="S5.E1X.2.1.1.m1.4.4.2.2.1.1.cmml" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.1"></times><ci id="S5.E1X.2.1.1.m1.4.4.2.2.1.2.cmml" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.2">𝐸</ci><ci id="S5.E1X.2.1.1.m1.4.4.2.2.1.3.cmml" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.3">𝑀</ci><ci id="S5.E1X.2.1.1.m1.4.4.2.2.1.4.cmml" xref="S5.E1X.2.1.1.m1.4.4.2.2.1.4">𝐴</ci></apply><ci id="S5.E1X.2.1.1.m1.3.3.1.1.cmml" xref="S5.E1X.2.1.1.m1.3.3.1.1">𝑡</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E1X.2.1.1.m1.5c">\displaystyle L_{EMA,t+1}\leftarrow\alpha*L_{cur}+(1-\alpha)*L_{EMA,t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p">If the test loss on dataset of a client before updating the local model is lower than the aggregated training loss calculated during the previous round, the dataset is considered to have a potential bias. This indicates that the characteristics of the dataset are already learned by the global model.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Generalization Techniques</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p">Fairness and DG share similar objectives, as discussed in <cite class="ltx_cite ltx_citemacro_cite">Creager et al. (<a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>. To solve the fairness problem, it is important to elevate the accuracy of devices that underperform. On the other hand, the domain generalization problem seeks to improve the accuracy for unseen devices. In essence, if consistent accuracy is achieved across all devices, regardless of their presence during training, it may be sufficient to address both fairness and DG problems. To achieve this, we propose a two-pronged method focusing on the dataset diversification and the model generalization. The method is used on the client-side during the training, adapting to system-induced data heterogeneity.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Dataset Diversification with ISP Adjustment: </span>
Given heterogeneity across the data from different device types, we propose to expand the diversity of the data via <span id="S5.SS2.p2.1.2" class="ltx_text ltx_font_italic">random transformation</span> — such transformation, including geometric, color adjustments, and random erasing, does not change the inherent label or meaning of the image, encouraging the model to learn from more varied range of data <cite class="ltx_cite ltx_citemacro_cite">Shorten &amp; Khoshgoftaar (<a href="#bib.bib49" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.1" class="ltx_p">Motivated by our observations in Section <a href="#S3.T3" title="Table 3 ‣ 3.4 Deeper Look at Heterogeneity: SW ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, which highlighted the need for addressing Tone and Color (especially White Balance <cite class="ltx_cite ltx_citemacro_cite">Wyszecki &amp; Stiles (<a href="#bib.bib56" title="" class="ltx_ref">2000</a>)</cite>) variations, we suggest introducing random White Balance and tone transformations (via random gamma application <cite class="ltx_cite ltx_citemacro_cite">Wyszecki &amp; Stiles (<a href="#bib.bib56" title="" class="ltx_ref">2000</a>)</cite>) to the dataset of each client.
<br class="ltx_break"><span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold">Random WB:</span></p>
<table id="S5.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S5.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E2X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{With $r_{1},r_{2},r_{3}\sim U(1-degree,1+degree)$}," display="inline"><semantics id="S5.E2X.2.1.1.m1.1a"><mrow id="S5.E2X.2.1.1.m1.1.1.2" xref="S5.E2.m1.1.1.1.1.1.1.1ab.cmml"><mrow id="S5.E2.m1.1.1.1.1.1.1.1a" xref="S5.E2.m1.1.1.1.1.1.1.1ab.cmml"><mtext id="S5.E2.m1.1.1.1.1.1.1.1aa" xref="S5.E2.m1.1.1.1.1.1.1.1aa.cmml">With </mtext><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.cmml"><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.cmml"><msub id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.cmml"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.2.cmml">r</mi><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.4" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.cmml">,</mo><msub id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.cmml"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.cmml">r</mi><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.5" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.cmml">,</mo><msub id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.cmml"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.2.cmml">r</mi><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.3.cmml">3</mn></msub></mrow><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.6" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.6.cmml">∼</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.cmml"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.4" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.4.cmml">U</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.3.cmml">​</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.cmml"><mo stretchy="false" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.cmml">(</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.cmml"><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.2.cmml">1</mn><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.1" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.1.cmml">−</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.cmml"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1a" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.4" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1b" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.5" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1c" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.6" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1d" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.7" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.7.cmml">e</mi></mrow></mrow><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.4" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.cmml">,</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.cmml"><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.2.cmml">1</mn><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.1" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.1.cmml">+</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.cmml"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.2" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.3" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1a" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.4" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1b" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.5" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1c" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.6" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1d" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1.cmml">​</mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.7" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.7.cmml">e</mi></mrow></mrow><mo stretchy="false" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.5" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E2X.2.1.1.m1.1.1.2.1" xref="S5.E2.m1.1.1.1.1.1.1.1ab.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E2X.2.1.1.m1.1b"><ci id="S5.E2.m1.1.1.1.1.1.1.1ab.cmml" xref="S5.E2X.2.1.1.m1.1.1.2"><mrow id="S5.E2.m1.1.1.1.1.1.1.1a.cmml" xref="S5.E2X.2.1.1.m1.1.1.2"><mtext id="S5.E2.m1.1.1.1.1.1.1.1aa.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1aa">With </mtext><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5"><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3"><msub id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.2">r</mi><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.3">1</mn></msub><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.4.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3">,</mo><msub id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2">r</mi><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.3">2</mn></msub><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.5.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3">,</mo><msub id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.2">r</mi><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.3.3.3.3.3.3">3</mn></msub></mrow><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.6.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.6">∼</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.4.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.4">U</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.3" lspace='0px' rspace='0px'></mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2"><mo stretchy="false" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2">(</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1"><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.2">1</mn><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.1.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.1">−</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.2">d</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.3">e</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1a.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.4.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.4">g</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1b.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.5.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.5">r</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1c.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.6.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.6">e</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1d.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.7.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.4.4.4.1.1.1.3.7">e</mi></mrow></mrow><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.4.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2">,</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2"><mn id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.2">1</mn><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.1.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.1">+</mo><mrow id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3"><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.2.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.2">d</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.3.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.3">e</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1a.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.4.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.4">g</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1b.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.5.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.5">r</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1c.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.6.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.6">e</mi><mo id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1d.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.7.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.2.3.7">e</mi></mrow></mrow><mo stretchy="false" id="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2.5.cmml" xref="S5.E2.m1.1.1.1.1.1.1.1.m1.mf.5.5.5.2.2">)</mo></mrow></mrow></mrow></mrow></ci></annotation-xml><annotation encoding="application/x-tex" id="S5.E2X.2.1.1.m1.1c">\displaystyle\text{With $r_{1},r_{2},r_{3}\sim U(1-degree,1+degree)$},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S5.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E2Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\begin{bmatrix}R\\
G\\
B\end{bmatrix}_{out}=\begin{bmatrix}r_{1}&amp;0&amp;0\\
0&amp;r_{2}&amp;0\\
0&amp;0&amp;r_{3}\end{bmatrix}\begin{bmatrix}R\\
G\\
B\end{bmatrix}_{in}" display="inline"><semantics id="S5.E2Xa.2.1.1.m1.1a"><mrow id="S5.E2Xa.2.1.1.m1.1.1" xref="S5.E2Xa.2.1.1.m1.1.1.cmml"><msub id="S5.E2Xa.2.1.1.m1.1.1.2" xref="S5.E2Xa.2.1.1.m1.1.1.2.cmml"><mrow id="S5.E2.m1.2.2.2.1.1.1a.3" xref="S5.E2.m1.2.2.2.1.1.1a.2.cmml"><mo id="S5.E2.m1.2.2.2.1.1.1a.3.1" xref="S5.E2.m1.2.2.2.1.1.1a.2.1.cmml">[</mo><mtable rowspacing="0pt" id="S5.E2.m1.2.2.2.1.1.1.1.1.mf" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml"><mtr id="S5.E2.m1.2.2.2.1.1.1.1.1.mfa" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml"><mtd id="S5.E2.m1.2.2.2.1.1.1.1.1.mfb" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml"><mi id="S5.E2.m1.2.2.2.1.1.1.1.1.mf.1.1.1" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.1.1.1.cmml">R</mi></mtd></mtr><mtr id="S5.E2.m1.2.2.2.1.1.1.1.1.mfc" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml"><mtd id="S5.E2.m1.2.2.2.1.1.1.1.1.mfd" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml"><mi id="S5.E2.m1.2.2.2.1.1.1.1.1.mf.2.1.1" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.2.1.1.cmml">G</mi></mtd></mtr><mtr id="S5.E2.m1.2.2.2.1.1.1.1.1.mfe" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml"><mtd id="S5.E2.m1.2.2.2.1.1.1.1.1.mff" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml"><mi id="S5.E2.m1.2.2.2.1.1.1.1.1.mf.3.1.1" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.3.1.1.cmml">B</mi></mtd></mtr></mtable><mo id="S5.E2.m1.2.2.2.1.1.1a.3.2" xref="S5.E2.m1.2.2.2.1.1.1a.2.1.cmml">]</mo></mrow><mrow id="S5.E2Xa.2.1.1.m1.1.1.2.2" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.cmml"><mi id="S5.E2Xa.2.1.1.m1.1.1.2.2.2" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E2Xa.2.1.1.m1.1.1.2.2.1" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S5.E2Xa.2.1.1.m1.1.1.2.2.3" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.E2Xa.2.1.1.m1.1.1.2.2.1a" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S5.E2Xa.2.1.1.m1.1.1.2.2.4" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.4.cmml">t</mi></mrow></msub><mo id="S5.E2Xa.2.1.1.m1.1.1.1" xref="S5.E2Xa.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S5.E2Xa.2.1.1.m1.1.1.3" xref="S5.E2Xa.2.1.1.m1.1.1.3.cmml"><mrow id="S5.E2.m1.3.3.3.2.2.2a.3" xref="S5.E2.m1.3.3.3.2.2.2a.2.cmml"><mo id="S5.E2.m1.3.3.3.2.2.2a.3.1" xref="S5.E2.m1.3.3.3.2.2.2a.2.1.cmml">[</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mtr id="S5.E2.m1.3.3.3.2.2.2.1.1.mfa" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfb" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><msub id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.cmml"><mi id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.2" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.2.cmml">r</mi><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.3" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.3.cmml">1</mn></msub></mtd><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfc" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.2.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.2.1.cmml">0</mn></mtd><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfd" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.3.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.3.1.cmml">0</mn></mtd></mtr><mtr id="S5.E2.m1.3.3.3.2.2.2.1.1.mfe" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mff" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.1.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.1.1.cmml">0</mn></mtd><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfg" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><msub id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.cmml"><mi id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.2" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.2.cmml">r</mi><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.3" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.3.cmml">2</mn></msub></mtd><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfh" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.3.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.3.1.cmml">0</mn></mtd></mtr><mtr id="S5.E2.m1.3.3.3.2.2.2.1.1.mfi" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfj" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.1.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.1.1.cmml">0</mn></mtd><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfk" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.2.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.2.1.cmml">0</mn></mtd><mtd id="S5.E2.m1.3.3.3.2.2.2.1.1.mfl" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml"><msub id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.cmml"><mi id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.2" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.2.cmml">r</mi><mn id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.3" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.3.cmml">3</mn></msub></mtd></mtr></mtable><mo id="S5.E2.m1.3.3.3.2.2.2a.3.2" xref="S5.E2.m1.3.3.3.2.2.2a.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S5.E2Xa.2.1.1.m1.1.1.3.1" xref="S5.E2Xa.2.1.1.m1.1.1.3.1.cmml">​</mo><msub id="S5.E2Xa.2.1.1.m1.1.1.3.2" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.cmml"><mrow id="S5.E2.m1.4.4.4.3.3.3a.3" xref="S5.E2.m1.4.4.4.3.3.3a.2.cmml"><mo id="S5.E2.m1.4.4.4.3.3.3a.3.1" xref="S5.E2.m1.4.4.4.3.3.3a.2.1.cmml">[</mo><mtable rowspacing="0pt" id="S5.E2.m1.4.4.4.3.3.3.1.1.mf" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml"><mtr id="S5.E2.m1.4.4.4.3.3.3.1.1.mfa" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml"><mtd id="S5.E2.m1.4.4.4.3.3.3.1.1.mfb" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml"><mi id="S5.E2.m1.4.4.4.3.3.3.1.1.mf.1.1.1" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.1.1.1.cmml">R</mi></mtd></mtr><mtr id="S5.E2.m1.4.4.4.3.3.3.1.1.mfc" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml"><mtd id="S5.E2.m1.4.4.4.3.3.3.1.1.mfd" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml"><mi id="S5.E2.m1.4.4.4.3.3.3.1.1.mf.2.1.1" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.2.1.1.cmml">G</mi></mtd></mtr><mtr id="S5.E2.m1.4.4.4.3.3.3.1.1.mfe" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml"><mtd id="S5.E2.m1.4.4.4.3.3.3.1.1.mff" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml"><mi id="S5.E2.m1.4.4.4.3.3.3.1.1.mf.3.1.1" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.3.1.1.cmml">B</mi></mtd></mtr></mtable><mo id="S5.E2.m1.4.4.4.3.3.3a.3.2" xref="S5.E2.m1.4.4.4.3.3.3a.2.1.cmml">]</mo></mrow><mrow id="S5.E2Xa.2.1.1.m1.1.1.3.2.2" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2.cmml"><mi id="S5.E2Xa.2.1.1.m1.1.1.3.2.2.2" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.E2Xa.2.1.1.m1.1.1.3.2.2.1" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2.1.cmml">​</mo><mi id="S5.E2Xa.2.1.1.m1.1.1.3.2.2.3" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2.3.cmml">n</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E2Xa.2.1.1.m1.1b"><apply id="S5.E2Xa.2.1.1.m1.1.1.cmml" xref="S5.E2Xa.2.1.1.m1.1.1"><eq id="S5.E2Xa.2.1.1.m1.1.1.1.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.1"></eq><apply id="S5.E2Xa.2.1.1.m1.1.1.2.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.E2Xa.2.1.1.m1.1.1.2.1.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.2">subscript</csymbol><apply id="S5.E2.m1.2.2.2.1.1.1a.2.cmml" xref="S5.E2.m1.2.2.2.1.1.1a.3"><csymbol cd="latexml" id="S5.E2.m1.2.2.2.1.1.1a.2.1.cmml" xref="S5.E2.m1.2.2.2.1.1.1a.3.1">matrix</csymbol><matrix id="S5.E2.m1.2.2.2.1.1.1.1.1.mf.cmml" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf"><matrixrow id="S5.E2.m1.2.2.2.1.1.1.1.1.mfa.cmml" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf"><ci id="S5.E2.m1.2.2.2.1.1.1.1.1.mf.1.1.1.cmml" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.1.1.1">𝑅</ci></matrixrow><matrixrow id="S5.E2.m1.2.2.2.1.1.1.1.1.mfb.cmml" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf"><ci id="S5.E2.m1.2.2.2.1.1.1.1.1.mf.2.1.1.cmml" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.2.1.1">𝐺</ci></matrixrow><matrixrow id="S5.E2.m1.2.2.2.1.1.1.1.1.mfc.cmml" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf"><ci id="S5.E2.m1.2.2.2.1.1.1.1.1.mf.3.1.1.cmml" xref="S5.E2.m1.2.2.2.1.1.1.1.1.mf.3.1.1">𝐵</ci></matrixrow></matrix></apply><apply id="S5.E2Xa.2.1.1.m1.1.1.2.2.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.2.2"><times id="S5.E2Xa.2.1.1.m1.1.1.2.2.1.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.1"></times><ci id="S5.E2Xa.2.1.1.m1.1.1.2.2.2.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.2">𝑜</ci><ci id="S5.E2Xa.2.1.1.m1.1.1.2.2.3.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.3">𝑢</ci><ci id="S5.E2Xa.2.1.1.m1.1.1.2.2.4.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.2.2.4">𝑡</ci></apply></apply><apply id="S5.E2Xa.2.1.1.m1.1.1.3.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3"><times id="S5.E2Xa.2.1.1.m1.1.1.3.1.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3.1"></times><apply id="S5.E2.m1.3.3.3.2.2.2a.2.cmml" xref="S5.E2.m1.3.3.3.2.2.2a.3"><csymbol cd="latexml" id="S5.E2.m1.3.3.3.2.2.2a.2.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2a.3.1">matrix</csymbol><matrix id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf"><matrixrow id="S5.E2.m1.3.3.3.2.2.2.1.1.mfa.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf"><apply id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1"><csymbol cd="ambiguous" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1">subscript</csymbol><ci id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.2.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.2">𝑟</ci><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.3.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.1.1.3">1</cn></apply><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.2.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.2.1">0</cn><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.3.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.1.3.1">0</cn></matrixrow><matrixrow id="S5.E2.m1.3.3.3.2.2.2.1.1.mfb.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf"><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.1.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.1.1">0</cn><apply id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1"><csymbol cd="ambiguous" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1">subscript</csymbol><ci id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.2.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.2">𝑟</ci><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.3.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.2.1.3">2</cn></apply><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.3.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.2.3.1">0</cn></matrixrow><matrixrow id="S5.E2.m1.3.3.3.2.2.2.1.1.mfc.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf"><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.1.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.1.1">0</cn><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.2.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.2.1">0</cn><apply id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1"><csymbol cd="ambiguous" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.1.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1">subscript</csymbol><ci id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.2.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.2">𝑟</ci><cn type="integer" id="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.3.cmml" xref="S5.E2.m1.3.3.3.2.2.2.1.1.mf.3.3.1.3">3</cn></apply></matrixrow></matrix></apply><apply id="S5.E2Xa.2.1.1.m1.1.1.3.2.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S5.E2Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3.2">subscript</csymbol><apply id="S5.E2.m1.4.4.4.3.3.3a.2.cmml" xref="S5.E2.m1.4.4.4.3.3.3a.3"><csymbol cd="latexml" id="S5.E2.m1.4.4.4.3.3.3a.2.1.cmml" xref="S5.E2.m1.4.4.4.3.3.3a.3.1">matrix</csymbol><matrix id="S5.E2.m1.4.4.4.3.3.3.1.1.mf.cmml" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf"><matrixrow id="S5.E2.m1.4.4.4.3.3.3.1.1.mfa.cmml" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf"><ci id="S5.E2.m1.4.4.4.3.3.3.1.1.mf.1.1.1.cmml" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.1.1.1">𝑅</ci></matrixrow><matrixrow id="S5.E2.m1.4.4.4.3.3.3.1.1.mfb.cmml" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf"><ci id="S5.E2.m1.4.4.4.3.3.3.1.1.mf.2.1.1.cmml" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.2.1.1">𝐺</ci></matrixrow><matrixrow id="S5.E2.m1.4.4.4.3.3.3.1.1.mfc.cmml" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf"><ci id="S5.E2.m1.4.4.4.3.3.3.1.1.mf.3.1.1.cmml" xref="S5.E2.m1.4.4.4.3.3.3.1.1.mf.3.1.1">𝐵</ci></matrixrow></matrix></apply><apply id="S5.E2Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2"><times id="S5.E2Xa.2.1.1.m1.1.1.3.2.2.1.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2.1"></times><ci id="S5.E2Xa.2.1.1.m1.1.1.3.2.2.2.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2.2">𝑖</ci><ci id="S5.E2Xa.2.1.1.m1.1.1.3.2.2.3.cmml" xref="S5.E2Xa.2.1.1.m1.1.1.3.2.2.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E2Xa.2.1.1.m1.1c">\displaystyle\begin{bmatrix}R\\
G\\
B\end{bmatrix}_{out}=\begin{bmatrix}r_{1}&amp;0&amp;0\\
0&amp;r_{2}&amp;0\\
0&amp;0&amp;r_{3}\end{bmatrix}\begin{bmatrix}R\\
G\\
B\end{bmatrix}_{in}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S5.SS2.p3.2" class="ltx_p"><span id="S5.SS2.p3.2.1" class="ltx_text ltx_font_bold">Random Gamma:</span></p>
<table id="S5.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S5.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E3X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{With $\gamma\sim U(1-degree,1+degree)$}," display="inline"><semantics id="S5.E3X.2.1.1.m1.1a"><mrow id="S5.E3X.2.1.1.m1.1.1.2" xref="S5.E3.m1.1.1.1.1.1.1.1ab.cmml"><mrow id="S5.E3.m1.1.1.1.1.1.1.1a" xref="S5.E3.m1.1.1.1.1.1.1.1ab.cmml"><mtext id="S5.E3.m1.1.1.1.1.1.1.1aa" xref="S5.E3.m1.1.1.1.1.1.1.1aa.cmml">With </mtext><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.cmml"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.4" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.4.cmml">γ</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.3" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.3.cmml">∼</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.cmml"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.4" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.4.cmml">U</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.3" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.3.cmml">​</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.cmml"><mo stretchy="false" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.3" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.cmml">(</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.cmml"><mn id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.cmml"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.3" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1a" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.4" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1b" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.5" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1c" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.6" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1d" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.7" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.7.cmml">e</mi></mrow></mrow><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.4" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.cmml">,</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.cmml"><mn id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.2.cmml">1</mn><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.1" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.1.cmml">+</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.cmml"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.2" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.3" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1a" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.4" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1b" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.5" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1c" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.6" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1d" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.7" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.7.cmml">e</mi></mrow></mrow><mo stretchy="false" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.5" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E3X.2.1.1.m1.1.1.2.1" xref="S5.E3.m1.1.1.1.1.1.1.1ab.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E3X.2.1.1.m1.1b"><ci id="S5.E3.m1.1.1.1.1.1.1.1ab.cmml" xref="S5.E3X.2.1.1.m1.1.1.2"><mrow id="S5.E3.m1.1.1.1.1.1.1.1a.cmml" xref="S5.E3X.2.1.1.m1.1.1.2"><mtext id="S5.E3.m1.1.1.1.1.1.1.1aa.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1aa">With </mtext><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.4.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.4">γ</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.3">∼</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.4.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.4">U</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.3" lspace='0px' rspace='0px'></mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2"><mo stretchy="false" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2">(</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1"><mn id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.2">1</mn><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.1">−</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.2">d</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.3">e</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1a.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.4.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.4">g</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1b.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.5.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.5">r</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1c.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.6.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.6">e</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1d.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.7.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.1.1.1.1.1.1.3.7">e</mi></mrow></mrow><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.4.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2">,</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2"><mn id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.2">1</mn><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.1">+</mo><mrow id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3"><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.2.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.2">d</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.3.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.3">e</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1a.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.4.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.4">g</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1b.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.5.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.5">r</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1c.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.6.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.6">e</mi><mo id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1d.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.1" lspace='0px' rspace='0px'></mo><mi id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.7.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.2.3.7">e</mi></mrow></mrow><mo stretchy="false" id="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2.5.cmml" xref="S5.E3.m1.1.1.1.1.1.1.1.m1.mf.2.2.2.2.2">)</mo></mrow></mrow></mrow></mrow></ci></annotation-xml><annotation encoding="application/x-tex" id="S5.E3X.2.1.1.m1.1c">\displaystyle\text{With $\gamma\sim U(1-degree,1+degree)$},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S5.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S5.E3Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{Img}_{out}=\text{Img}_{in}^{\gamma}" display="inline"><semantics id="S5.E3Xa.2.1.1.m1.1a"><mrow id="S5.E3Xa.2.1.1.m1.1.1" xref="S5.E3Xa.2.1.1.m1.1.1.cmml"><msub id="S5.E3Xa.2.1.1.m1.1.1.2" xref="S5.E3Xa.2.1.1.m1.1.1.2.cmml"><mtext id="S5.E3Xa.2.1.1.m1.1.1.2.2" xref="S5.E3Xa.2.1.1.m1.1.1.2.2a.cmml">Img</mtext><mrow id="S5.E3Xa.2.1.1.m1.1.1.2.3" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.cmml"><mi id="S5.E3Xa.2.1.1.m1.1.1.2.3.2" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E3Xa.2.1.1.m1.1.1.2.3.1" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.E3Xa.2.1.1.m1.1.1.2.3.3" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.E3Xa.2.1.1.m1.1.1.2.3.1a" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.E3Xa.2.1.1.m1.1.1.2.3.4" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S5.E3Xa.2.1.1.m1.1.1.1" xref="S5.E3Xa.2.1.1.m1.1.1.1.cmml">=</mo><msubsup id="S5.E3Xa.2.1.1.m1.1.1.3" xref="S5.E3Xa.2.1.1.m1.1.1.3.cmml"><mtext id="S5.E3Xa.2.1.1.m1.1.1.3.2.2" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.2a.cmml">Img</mtext><mrow id="S5.E3Xa.2.1.1.m1.1.1.3.2.3" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3.cmml"><mi id="S5.E3Xa.2.1.1.m1.1.1.3.2.3.2" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.E3Xa.2.1.1.m1.1.1.3.2.3.1" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S5.E3Xa.2.1.1.m1.1.1.3.2.3.3" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3.3.cmml">n</mi></mrow><mi id="S5.E3Xa.2.1.1.m1.1.1.3.3" xref="S5.E3Xa.2.1.1.m1.1.1.3.3.cmml">γ</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.E3Xa.2.1.1.m1.1b"><apply id="S5.E3Xa.2.1.1.m1.1.1.cmml" xref="S5.E3Xa.2.1.1.m1.1.1"><eq id="S5.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.1"></eq><apply id="S5.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.E3Xa.2.1.1.m1.1.1.2.1.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S5.E3Xa.2.1.1.m1.1.1.2.2a.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2.2"><mtext id="S5.E3Xa.2.1.1.m1.1.1.2.2.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2.2">Img</mtext></ci><apply id="S5.E3Xa.2.1.1.m1.1.1.2.3.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2.3"><times id="S5.E3Xa.2.1.1.m1.1.1.2.3.1.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.1"></times><ci id="S5.E3Xa.2.1.1.m1.1.1.2.3.2.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.2">𝑜</ci><ci id="S5.E3Xa.2.1.1.m1.1.1.2.3.3.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.3">𝑢</ci><ci id="S5.E3Xa.2.1.1.m1.1.1.2.3.4.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S5.E3Xa.2.1.1.m1.1.1.3.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.E3Xa.2.1.1.m1.1.1.3.1.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3">superscript</csymbol><apply id="S5.E3Xa.2.1.1.m1.1.1.3.2.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.E3Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S5.E3Xa.2.1.1.m1.1.1.3.2.2a.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.2"><mtext id="S5.E3Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.2">Img</mtext></ci><apply id="S5.E3Xa.2.1.1.m1.1.1.3.2.3.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3"><times id="S5.E3Xa.2.1.1.m1.1.1.3.2.3.1.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3.1"></times><ci id="S5.E3Xa.2.1.1.m1.1.1.3.2.3.2.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3.2">𝑖</ci><ci id="S5.E3Xa.2.1.1.m1.1.1.3.2.3.3.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3.2.3.3">𝑛</ci></apply></apply><ci id="S5.E3Xa.2.1.1.m1.1.1.3.3.cmml" xref="S5.E3Xa.2.1.1.m1.1.1.3.3">𝛾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E3Xa.2.1.1.m1.1c">\displaystyle\text{Img}_{out}=\text{Img}_{in}^{\gamma}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.1" class="ltx_p">However, data diversification does not necessarily need to be applied to every data. Given distinct ISP methods employed by each device, some data may pass through ISP stages that are not learned by the global model. To make the global model learn diverse characteristics of the ISP stages, we do not employ the data diversification in such a case.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para ltx_noindent">
<p id="S5.SS2.p5.1" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Model Generalization through SWAD: </span>
Even with data diversification that accounts for ISP adjustments, biases may still arise to the global model due to extreme differences between devices. We employ a weight averaging method <cite class="ltx_cite ltx_citemacro_cite">Izmailov et al. (<a href="#bib.bib23" title="" class="ltx_ref">2018</a>); Cha et al. (<a href="#bib.bib5" title="" class="ltx_ref">2021</a>)</cite> for further generalization. Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.2 Generalization Techniques ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a><span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>For this experiment, we use the original 12-class ImageNet dataset that we utilized for dataset creation (Section <a href="#S3.SS1" title="3.1 Dataset Creation ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). In each training scenario, we train the model for 10 epochs, applying a random data transformation at a low degree (degree=0.3). After training, we measure the accuracy on the original dataset. Then, we compare this accuracy with the accuracies on the transformed datasets (degrees ranging from 0.3 to 0.9) to assess the robustness of the model.</span></span></span> shows the comparative robustness of two different weight averaging methods, Stochastic Weight Averaging Densely (SWAD) <cite class="ltx_cite ltx_citemacro_cite">Cha et al. (<a href="#bib.bib5" title="" class="ltx_ref">2021</a>)</cite> and conventional SWA <cite class="ltx_cite ltx_citemacro_cite">Izmailov et al. (<a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite>, for three training scenarios: applying only data random transformation, applying SWAD with transformation, and applying conventional SWA with transformation. The x-axis shows different random transformation methods.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/fig7.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="225" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Comparison of Model Quality Degradation for different training methods and transformations</figcaption>
</figure>
<div id="S5.SS2.p6" class="ltx_para ltx_noindent">
<p id="S5.SS2.p6.1" class="ltx_p">Utilizing diverse data transformations with SWAD considerably enhances the model robustness. As depicted in Figure <a href="#S5.F7" title="Figure 7 ‣ 5.2 Generalization Techniques ‣ 5 Proposed Design: HeteroSwitch" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, SWAD with data transformations consistently exhibits superior robustness across all transformations. This is highlighted by observed improvements in metrics for Affine, Gaussian noise, WB, and Gamma by 14.0%, 0.4%, 14.6%, and 3.26%, respectively, over models trained only with transformations. The application of SWA also provides better resilience against the Affine transformation, showing a 12.0% improvement over models using only transformations without weight averaging. However, transformations with SWA shows increased vulnerability to transformations such as Gaussian noise, WB, and Gamma, resulting in greater quality degradation. Consequently, SWAD shows better generalization performance compared to SWA.</p>
</div>
<div id="S5.SS2.p7" class="ltx_para ltx_noindent">
<p id="S5.SS2.p7.1" class="ltx_p">SWA averages the model weights per every epoch while SWAD averages the model weights per every batch which is coarser than epoch. Hence, the integration of SWAD with random transformation, designed to average out significant variability with fewer samples <cite class="ltx_cite ltx_citemacro_cite">Dekking et al. (<a href="#bib.bib10" title="" class="ltx_ref">2005</a>)</cite>, enables DNN models to have enhanced adaptability to both geometric (e.g., Affine) and appearance-based (e.g., WB &amp; Gamma) variations during training.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Evaluation Results and Analysis</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">To assess the effectiveness of HeteroSwitch, we evaluate its impact on both fairness and domain generalization in FL by using the test accuracy of the global model <cite class="ltx_cite ltx_citemacro_cite">Shi et al. (<a href="#bib.bib48" title="" class="ltx_ref">2023</a>)</cite> on each deployed device type. For fairness, we measure the average variance of accuracy across devices — the portion of participation of each device type follows the market share summarized in Table. <a href="#S3.T1" title="Table 1 ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. For DG, we use the worst-case accuracy across devices as the metric to ensure a minimum required performance across all devices <cite class="ltx_cite ltx_citemacro_cite">Sagawa et al. (<a href="#bib.bib45" title="" class="ltx_ref">2019</a>); Krueger et al. (<a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.5" class="ltx_p">We configure FL experiments with total devices <math id="S6.p2.1.m1.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S6.p2.1.m1.1a"><mrow id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml"><mi id="S6.p2.1.m1.1.1.2" xref="S6.p2.1.m1.1.1.2.cmml">N</mi><mo id="S6.p2.1.m1.1.1.1" xref="S6.p2.1.m1.1.1.1.cmml">=</mo><mn id="S6.p2.1.m1.1.1.3" xref="S6.p2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><apply id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1"><eq id="S6.p2.1.m1.1.1.1.cmml" xref="S6.p2.1.m1.1.1.1"></eq><ci id="S6.p2.1.m1.1.1.2.cmml" xref="S6.p2.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S6.p2.1.m1.1.1.3.cmml" xref="S6.p2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">N=100</annotation></semantics></math>, minibatch size <math id="S6.p2.2.m2.1" class="ltx_Math" alttext="B=10" display="inline"><semantics id="S6.p2.2.m2.1a"><mrow id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml"><mi id="S6.p2.2.m2.1.1.2" xref="S6.p2.2.m2.1.1.2.cmml">B</mi><mo id="S6.p2.2.m2.1.1.1" xref="S6.p2.2.m2.1.1.1.cmml">=</mo><mn id="S6.p2.2.m2.1.1.3" xref="S6.p2.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.1b"><apply id="S6.p2.2.m2.1.1.cmml" xref="S6.p2.2.m2.1.1"><eq id="S6.p2.2.m2.1.1.1.cmml" xref="S6.p2.2.m2.1.1.1"></eq><ci id="S6.p2.2.m2.1.1.2.cmml" xref="S6.p2.2.m2.1.1.2">𝐵</ci><cn type="integer" id="S6.p2.2.m2.1.1.3.cmml" xref="S6.p2.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.1c">B=10</annotation></semantics></math>, selected devices for training for each round <math id="S6.p2.3.m3.1" class="ltx_Math" alttext="K=20" display="inline"><semantics id="S6.p2.3.m3.1a"><mrow id="S6.p2.3.m3.1.1" xref="S6.p2.3.m3.1.1.cmml"><mi id="S6.p2.3.m3.1.1.2" xref="S6.p2.3.m3.1.1.2.cmml">K</mi><mo id="S6.p2.3.m3.1.1.1" xref="S6.p2.3.m3.1.1.1.cmml">=</mo><mn id="S6.p2.3.m3.1.1.3" xref="S6.p2.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.3.m3.1b"><apply id="S6.p2.3.m3.1.1.cmml" xref="S6.p2.3.m3.1.1"><eq id="S6.p2.3.m3.1.1.1.cmml" xref="S6.p2.3.m3.1.1.1"></eq><ci id="S6.p2.3.m3.1.1.2.cmml" xref="S6.p2.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S6.p2.3.m3.1.1.3.cmml" xref="S6.p2.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.3.m3.1c">K=20</annotation></semantics></math>, local epoch <math id="S6.p2.4.m4.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S6.p2.4.m4.1a"><mrow id="S6.p2.4.m4.1.1" xref="S6.p2.4.m4.1.1.cmml"><mi id="S6.p2.4.m4.1.1.2" xref="S6.p2.4.m4.1.1.2.cmml">E</mi><mo id="S6.p2.4.m4.1.1.1" xref="S6.p2.4.m4.1.1.1.cmml">=</mo><mn id="S6.p2.4.m4.1.1.3" xref="S6.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.4.m4.1b"><apply id="S6.p2.4.m4.1.1.cmml" xref="S6.p2.4.m4.1.1"><eq id="S6.p2.4.m4.1.1.1.cmml" xref="S6.p2.4.m4.1.1.1"></eq><ci id="S6.p2.4.m4.1.1.2.cmml" xref="S6.p2.4.m4.1.1.2">𝐸</ci><cn type="integer" id="S6.p2.4.m4.1.1.3.cmml" xref="S6.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.4.m4.1c">E=1</annotation></semantics></math>, and number of communication rounds <math id="S6.p2.5.m5.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S6.p2.5.m5.1a"><mrow id="S6.p2.5.m5.1.1" xref="S6.p2.5.m5.1.1.cmml"><mi id="S6.p2.5.m5.1.1.2" xref="S6.p2.5.m5.1.1.2.cmml">T</mi><mo id="S6.p2.5.m5.1.1.1" xref="S6.p2.5.m5.1.1.1.cmml">=</mo><mn id="S6.p2.5.m5.1.1.3" xref="S6.p2.5.m5.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.5.m5.1b"><apply id="S6.p2.5.m5.1.1.cmml" xref="S6.p2.5.m5.1.1"><eq id="S6.p2.5.m5.1.1.1.cmml" xref="S6.p2.5.m5.1.1.1"></eq><ci id="S6.p2.5.m5.1.1.2.cmml" xref="S6.p2.5.m5.1.1.2">𝑇</ci><cn type="integer" id="S6.p2.5.m5.1.1.3.cmml" xref="S6.p2.5.m5.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.5.m5.1c">T=1000</annotation></semantics></math>. For a DNN model, we use MobileNetv3-small, which is widely used in mobile execution environments <cite class="ltx_cite ltx_citemacro_cite">Howard et al. (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>); Qian et al. (<a href="#bib.bib44" title="" class="ltx_ref">2021</a>)</cite>. We implement HeteroSwitch using PyTorch, and compare it with a baseline method, FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>, and prior works for data heterogeneity: q-FedAvg <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, and Scaffold <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S6.p3" class="ltx_para ltx_noindent">
<p id="S6.p3.1" class="ltx_p">We also evaluate HeteroSwitch with a realistic FL dataset, Flair <cite class="ltx_cite ltx_citemacro_cite">Song et al. (<a href="#bib.bib50" title="" class="ltx_ref">2022</a>)</cite> — this dataset includes images collected by real end-users with more than one thousand device types. Since Flair targets multi-label classification, we compare the averaged-precision across device types and variance of HeteroSwtich with a baseline of FedAvg and prior works (i.e., q-FedAvg and FedProx).</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>HeteroSwitch Evaluation</h3>

<figure id="S6.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Evaluation of HeteroSwitch on fairness and DG</figcaption>
<br class="ltx_break">
<table id="S6.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T4.1.1.1" class="ltx_tr">
<th id="S6.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S6.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S6.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T4.1.1.1.2.1" class="ltx_text ltx_font_bold">DG</span></th>
<td id="S6.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2"><span id="S6.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">Fairness</span></td>
</tr>
<tr id="S6.T4.1.2.2" class="ltx_tr">
<th id="S6.T4.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">
<table id="S6.T4.1.2.2.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S6.T4.1.2.2.1.1.1" class="ltx_tr">
<td id="S6.T4.1.2.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Acc (%)</td>
</tr>
<tr id="S6.T4.1.2.2.1.1.2" class="ltx_tr">
<td id="S6.T4.1.2.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(worst case)</td>
</tr>
</table>
</th>
<td id="S6.T4.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Variance</td>
<td id="S6.T4.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<table id="S6.T4.1.2.2.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S6.T4.1.2.2.3.1.1" class="ltx_tr">
<td id="S6.T4.1.2.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Acc (%)</td>
</tr>
<tr id="S6.T4.1.2.2.3.1.2" class="ltx_tr">
<td id="S6.T4.1.2.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(average)</td>
</tr>
</table>
</td>
</tr>
<tr id="S6.T4.1.3.3" class="ltx_tr">
<th id="S6.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Baseline</th>
<th id="S6.T4.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">61.17</th>
<td id="S6.T4.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t">8.63</td>
<td id="S6.T4.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.01</td>
</tr>
<tr id="S6.T4.1.4.4" class="ltx_tr">
<th id="S6.T4.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">ISP Transformation</th>
<th id="S6.T4.1.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">63.83</th>
<td id="S6.T4.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t">2.58</td>
<td id="S6.T4.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.81</td>
</tr>
<tr id="S6.T4.1.5.5" class="ltx_tr">
<th id="S6.T4.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">+ SWAD</th>
<th id="S6.T4.1.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">64.50</th>
<td id="S6.T4.1.5.5.3" class="ltx_td ltx_align_center">2.74</td>
<td id="S6.T4.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">66.29</td>
</tr>
<tr id="S6.T4.1.6.6" class="ltx_tr">
<th id="S6.T4.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">HeteroSwitch</th>
<th id="S6.T4.1.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S6.T4.1.6.6.2.1" class="ltx_text ltx_font_bold">64.71</span></th>
<td id="S6.T4.1.6.6.3" class="ltx_td ltx_align_center"><span id="S6.T4.1.6.6.3.1" class="ltx_text ltx_font_bold">1.77</span></td>
<td id="S6.T4.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S6.T4.1.6.6.4.1" class="ltx_text ltx_font_bold">67.38</span></td>
</tr>
<tr id="S6.T4.1.7.7" class="ltx_tr">
<th id="S6.T4.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">q-FedAvg</th>
<th id="S6.T4.1.7.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">59.38</th>
<td id="S6.T4.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t">5.40</td>
<td id="S6.T4.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.95</td>
</tr>
<tr id="S6.T4.1.8.8" class="ltx_tr">
<th id="S6.T4.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">FedProx</th>
<th id="S6.T4.1.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">61.50</th>
<td id="S6.T4.1.8.8.3" class="ltx_td ltx_align_center">8.43</td>
<td id="S6.T4.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r">65.16</td>
</tr>
<tr id="S6.T4.1.9.9" class="ltx_tr">
<th id="S6.T4.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">Scaffold</th>
<th id="S6.T4.1.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">57.50</th>
<td id="S6.T4.1.9.9.3" class="ltx_td ltx_align_center ltx_border_b">7.53</td>
<td id="S6.T4.1.9.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">66.18</td>
</tr>
</tbody>
</table>
</figure>
<div id="S6.SS1.p1" class="ltx_para ltx_noindent">
<p id="S6.SS1.p1.1" class="ltx_p">HeteroSwitch shows a significant variance and accuracy improvement in both fairness and DG as depicted in Table <a href="#S6.T4" title="Table 4 ‣ 6.1 HeteroSwitch Evaluation ‣ 6 Evaluation Results and Analysis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Notably, the use of our proposed generalization methods - ISP (WB&amp;Tone) transformation and SWA per every update - in a incremental manner leads to the improvement compared to the one-fits-all counterparts. As the ISP transformation adds further diversity into the dataset, it reduces the 4.4% higher worst-case accuracy over the baseline, handling the DG problem with <span id="S6.SS1.p1.1.1" class="ltx_text ltx_font_italic">system-induced heterogeneity</span>. It also mitigates the difference between learned device types due to ISP, improving variance and average accuracy by 68.2% and 4.4%, respectively. per-batch SWA further improves the worst-case accuracy by 1.0% showing better generalization capability — it is designed for stronger generalization technique by averaging updates with different ISP transformation. However, this degrades the variance and average accuracy by 6.2% and 0.8%, respectively, compared to ISP transformation alone. This is because a one-size-fits-all excessive generalization can cause the unnecessary performance degradation for marginalized devices during training.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para ltx_noindent">
<p id="S6.SS1.p2.1" class="ltx_p">HeteroSwitch overcomes this limitation by selectively applying the generalization techniques based on the loss comparison with the previous training rounds. As a result, it shows the highest worst-case accuracy, i.e., 5.8% over the baseline, demonstrating the highest generalization capability. HeteroSwitch also demonstrates its ability to handle marginalized devices, showing the best variance and average accuracy (79.5% and 5.3% over the baseline, respectively).</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Comparison with Prior Works</h3>

<div id="S6.SS2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS2.p1.1" class="ltx_p">We compare HeteroSwitch with three prominent FL prior works: q-FedAvg <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, and Scaffold <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib25" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS2.p2.1" class="ltx_p"><span id="S6.SS2.p2.1.1" class="ltx_text ltx_font_bold">q-FedAvg</span> aims to minimize the accuracy variance among clients owing to data heterogeneity, by assigning weights to each client dataset based on the loss. However, q-FedAvg does not consider system-induced data heterogeneity across different device types in FL. As a result, although q-FedAvg improves the variance and average accuracy by 37.4% and 1.5%, respectively, over the baseline, it fails to generalize to unseen device type with 2.9% decrease in worst-case accuracy.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para ltx_noindent">
<p id="S6.SS2.p3.1" class="ltx_p"><span id="S6.SS2.p3.1.1" class="ltx_text ltx_font_bold">FedProx</span> mitigates data heterogeneity in FL by adjusting the magnitude of local updates with an additional L2 regularization. Similar to q-FedAvg, this method does not focus on system-induced data heterogeneity. Therefore, although FedProx improves the worst-case accuracy, variance and average accuracy by 0.5%, 2.3%, and 1.8%, respectively, over the baseline, it shows lower performance compared to HeteroSwitch.</p>
</div>
<div id="S6.SS2.p4" class="ltx_para ltx_noindent">
<p id="S6.SS2.p4.1" class="ltx_p"><span id="S6.SS2.p4.1.1" class="ltx_text ltx_font_bold">Scaffold</span>, which employs client control variates, to adjust global update directions, addresses non-IID data variance. Still, it faces a similar challenge to q-FedAvg in generalizing to unseen devices, with a 6.0% drop in worst-case accuracy.</p>
</div>
<div id="S6.SS2.p5" class="ltx_para ltx_noindent">
<p id="S6.SS2.p5.1" class="ltx_p"><span id="S6.SS2.p5.1.1" class="ltx_text ltx_font_bold">HeteroSwitch</span>, which is designed to effectively handle system-induced data heterogeneity, shows better variance, average accuracy, and worst-case accuracy, compared to all the above methods. This distinction highlights the unique contribution of HeteroSwitch in addressing heterogeneous device environments of FL, providing a more balanced and generalized solution.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Effectiveness to DNN Models</h3>

<figure id="S6.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Evaluation of HeteroSwitch with different Model architectures</figcaption>
<br class="ltx_break">
<table id="S6.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T5.1.1.1" class="ltx_tr">
<th id="S6.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="3"><span id="S6.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Models</span></th>
<th id="S6.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" colspan="3"><span id="S6.T5.1.1.1.2.1" class="ltx_text ltx_font_bold">FedAvg</span></th>
<th id="S6.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3"><span id="S6.T5.1.1.1.3.1" class="ltx_text ltx_font_bold">HeteroSwitch</span></th>
</tr>
<tr id="S6.T5.1.2.2" class="ltx_tr">
<th id="S6.T5.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t"><span id="S6.T5.1.2.2.1.1" class="ltx_text ltx_font_bold">DG</span></th>
<th id="S6.T5.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2"><span id="S6.T5.1.2.2.2.1" class="ltx_text ltx_font_bold">Fairness</span></th>
<th id="S6.T5.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S6.T5.1.2.2.3.1" class="ltx_text ltx_font_bold">DG</span></th>
<th id="S6.T5.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2"><span id="S6.T5.1.2.2.4.1" class="ltx_text ltx_font_bold">Fairness</span></th>
</tr>
<tr id="S6.T5.1.3.3" class="ltx_tr">
<th id="S6.T5.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">
<table id="S6.T5.1.3.3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S6.T5.1.3.3.1.1.1" class="ltx_tr">
<td id="S6.T5.1.3.3.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Acc (%)</td>
</tr>
<tr id="S6.T5.1.3.3.1.1.2" class="ltx_tr">
<td id="S6.T5.1.3.3.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(worst case)</td>
</tr>
</table>
</th>
<th id="S6.T5.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Variance</th>
<th id="S6.T5.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S6.T5.1.3.3.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S6.T5.1.3.3.3.1.1" class="ltx_tr">
<td id="S6.T5.1.3.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Acc (%)</td>
</tr>
<tr id="S6.T5.1.3.3.3.1.2" class="ltx_tr">
<td id="S6.T5.1.3.3.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(average)</td>
</tr>
</table>
</th>
<th id="S6.T5.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S6.T5.1.3.3.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S6.T5.1.3.3.4.1.1" class="ltx_tr">
<td id="S6.T5.1.3.3.4.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Acc (%)</td>
</tr>
<tr id="S6.T5.1.3.3.4.1.2" class="ltx_tr">
<td id="S6.T5.1.3.3.4.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(worst case)</td>
</tr>
</table>
</th>
<th id="S6.T5.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Variance</th>
<th id="S6.T5.1.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<table id="S6.T5.1.3.3.6.1" class="ltx_tabular ltx_align_middle">
<tr id="S6.T5.1.3.3.6.1.1" class="ltx_tr">
<td id="S6.T5.1.3.3.6.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Acc (%)</td>
</tr>
<tr id="S6.T5.1.3.3.6.1.2" class="ltx_tr">
<td id="S6.T5.1.3.3.6.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">(average)</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T5.1.4.1" class="ltx_tr">
<th id="S6.T5.1.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">MobileNetV3-small</th>
<th id="S6.T5.1.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">61.17</th>
<td id="S6.T5.1.4.1.3" class="ltx_td ltx_align_center ltx_border_t">8.63</td>
<td id="S6.T5.1.4.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.01</td>
<td id="S6.T5.1.4.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">64.71</td>
<td id="S6.T5.1.4.1.6" class="ltx_td ltx_align_center ltx_border_t">1.77</td>
<td id="S6.T5.1.4.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67.38</td>
</tr>
<tr id="S6.T5.1.5.2" class="ltx_tr">
<th id="S6.T5.1.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">Shufflenet_v2_x0_5</th>
<th id="S6.T5.1.5.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">62.21</th>
<td id="S6.T5.1.5.2.3" class="ltx_td ltx_align_center">10.92</td>
<td id="S6.T5.1.5.2.4" class="ltx_td ltx_align_center ltx_border_r">67.09</td>
<td id="S6.T5.1.5.2.5" class="ltx_td ltx_align_center ltx_border_r">62.67</td>
<td id="S6.T5.1.5.2.6" class="ltx_td ltx_align_center">4.24</td>
<td id="S6.T5.1.5.2.7" class="ltx_td ltx_align_center ltx_border_r">64.76</td>
</tr>
<tr id="S6.T5.1.6.3" class="ltx_tr">
<th id="S6.T5.1.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">Squeezenet1_1</th>
<th id="S6.T5.1.6.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">8.75</th>
<td id="S6.T5.1.6.3.3" class="ltx_td ltx_align_center ltx_border_b">0.00</td>
<td id="S6.T5.1.6.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">8.33</td>
<td id="S6.T5.1.6.3.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">16.13</td>
<td id="S6.T5.1.6.3.6" class="ltx_td ltx_align_center ltx_border_b">1.70</td>
<td id="S6.T5.1.6.3.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">31.86</td>
</tr>
</tbody>
</table>
</figure>
<div id="S6.SS3.p1" class="ltx_para ltx_noindent">
<p id="S6.SS3.p1.1" class="ltx_p">In the previous section, we primarily used MobileNetv3-small, which is widely used in mobile execution environment <cite class="ltx_cite ltx_citemacro_cite">Howard et al. (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>); Qian et al. (<a href="#bib.bib44" title="" class="ltx_ref">2021</a>)</cite>. Here, we conduct additional experiments with ShuffleNet <cite class="ltx_cite ltx_citemacro_cite">Ma et al. (<a href="#bib.bib37" title="" class="ltx_ref">2018</a>)</cite> and SqueezeNet <cite class="ltx_cite ltx_citemacro_cite">Iandola et al. (<a href="#bib.bib22" title="" class="ltx_ref">2016</a>)</cite>, which are also mobile friendly light-weight models. Table <a href="#S6.T5" title="Table 5 ‣ 6.3 Effectiveness to DNN Models ‣ 6 Evaluation Results and Analysis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the worst-case accuracy for DG and the variance and average accuracy for fairness with various models. As shown in Table <a href="#S6.T5" title="Table 5 ‣ 6.3 Effectiveness to DNN Models ‣ 6 Evaluation Results and Analysis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, HeteroSwitch always shows better worst-case accuracy compared to FedAvg, demonstrating its robustness to domain generalization problem. Although ShuffleNet exhibits a decline in average accuracy with HeteroSwitch, it shows improvement in variance. Conversely, SqueezeNet, which initially fails to learn with FedAvg, showing performance equivalent to random guessing, experiences a dramatic increase in accuracy with HeteroSwitch. These results suggest that, with some adjustments, Shufflenet could work even better with our method if the observed effects are not inherent to the model structure. In short, HeteroSwitch can be used to a variety of mobile-friendly models dealing with the problems caused by system-induced data heterogeneity.</p>
</div>
</section>
<section id="S6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Impact on Realistic FL Dataset</h3>

<figure id="S6.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Evaluation of HeteroSwitch with Flair</figcaption>
<br class="ltx_break">
<table id="S6.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T6.1.1.1" class="ltx_tr">
<th id="S6.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S6.T6.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S6.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S6.T6.1.1.1.2.1" class="ltx_text ltx_font_bold">Averaged Precision (%)</span></th>
<th id="S6.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="S6.T6.1.1.1.3.1" class="ltx_text ltx_font_bold">Variance</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T6.1.2.1" class="ltx_tr">
<th id="S6.T6.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Baseline</th>
<td id="S6.T6.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">47.72</td>
<td id="S6.T6.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">265.79</td>
</tr>
<tr id="S6.T6.1.3.2" class="ltx_tr">
<th id="S6.T6.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">HeteroSwitch</th>
<td id="S6.T6.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S6.T6.1.3.2.2.1" class="ltx_text ltx_font_bold">47.80</span></td>
<td id="S6.T6.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S6.T6.1.3.2.3.1" class="ltx_text ltx_font_bold">249.02</span></td>
</tr>
<tr id="S6.T6.1.4.3" class="ltx_tr">
<th id="S6.T6.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">q-FedAvg</th>
<td id="S6.T6.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">47.25</td>
<td id="S6.T6.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r">257.32</td>
</tr>
<tr id="S6.T6.1.5.4" class="ltx_tr">
<th id="S6.T6.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">FedProx</th>
<td id="S6.T6.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">47.07</td>
<td id="S6.T6.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">313.67</td>
</tr>
</tbody>
</table>
</figure>
<div id="S6.SS4.p1" class="ltx_para ltx_noindent">
<p id="S6.SS4.p1.1" class="ltx_p">We evaluate HeteroSwitch with a realistic FL dataset, Flair <cite class="ltx_cite ltx_citemacro_cite">Song et al. (<a href="#bib.bib50" title="" class="ltx_ref">2022</a>)</cite>. The distribution of averaged precision (AP) across device types is shown in Table <a href="#S6.T6" title="Table 6 ‣ 6.4 Impact on Realistic FL Dataset ‣ 6 Evaluation Results and Analysis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Because of the increased complexity of system-induced data heterogeneity, FedAvg exhibits a diverse AP distribution across device types.</p>
</div>
<div id="S6.SS4.p2" class="ltx_para ltx_noindent">
<p id="S6.SS4.p2.1" class="ltx_p">As the problem becomes more complex, q-FedAvg and FedProx fail to handle the high variance properly. q-FedAvg reduces variance by 3.2% at the expense of averaged precision compared to the baseline. FedProx performs worse with a 1.4% decline in averaged precision and an 18% increase in variance compared to the baseline, indicating its insufficiency to address the problem. In contrast, HeteroSwitch reduces the variance by 6.3% improving the averaged precision by 0.2%. This indicates that HeteroSwitch still mitigates system-induced data heterogeneity even in the presence of more diverse device types in the wild.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Related Work</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.1" class="ltx_p"><span id="S7.p1.1.1" class="ltx_text ltx_font_bold">System Heterogeneity in ML:</span>
In Centralized Training, several research have shown that neural networks can be vulnerable to system heterogeneity. — e.g., they may suffer quality distortions like blurring and noise <cite class="ltx_cite ltx_citemacro_cite">Dodge &amp; Karam (<a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite>, be affected by simulated camera parameters such as pixel size and exposure <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib36" title="" class="ltx_ref">2020</a>)</cite> or display unstable inference with different devices if trained with ImageNet <cite class="ltx_cite ltx_citemacro_cite">Cidon et al. (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>. However, no previous work has thoroughly explored which specific steps within the signal processing process introduce biases into the ML training using real devices. Moreover, we are the first to highlight the potential challenges this could pose within a FL context, where a variety of devices can participate.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p id="S7.p2.1" class="ltx_p"><span id="S7.p2.1.1" class="ltx_text ltx_font_bold">Data Heterogeneity in FL:</span>
Federated Learning, with an increased number of clients, inherently produces diverse data, reflecting variations in class distribution, participant geography, culture, and device usage patterns <cite class="ltx_cite ltx_citemacro_cite">Kairouz et al. (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>, leading to data heterogeneity. Prior works have tried to mitigate this by adopting a regularization method to local models <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>, sharing a small amount of public data across local clients <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib58" title="" class="ltx_ref">2018</a>); Mansour et al. (<a href="#bib.bib39" title="" class="ltx_ref">2020</a>)</cite>, or employing weighted averaging for model aggregation <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib32" title="" class="ltx_ref">2019</a>)</cite>. To the best of our knowledge, our work is the first to analyze the problems caused by system-induced data heterogeneity in FL where a range of device types can participate in the learning process and propose a solution that addresses the aforementioned challenges while still preserving the principle of data privacy in FL.</p>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>

<div id="S8.p1" class="ltx_para ltx_noindent">
<p id="S8.p1.1" class="ltx_p">In this paper, we first introduce <span id="S8.p1.1.1" class="ltx_text ltx_font_italic">system-induced data heterogeneity</span> in FL. By using the dataset that we created, we show that system-induced data heterogeneity can negatively affect the accuracy of FL models. We also demonstrate the fairness and domain generalization problems which can stem from system-induced data heterogeneity in realistic execution scenarios of FL. To mitigate system-induced data heterogeneity, we propose HeteroSwitch, a selective generalization technique based on the ISP transformation and SWAD. Our evaluation results demonstrate that HeteroSwitch reduces the variance of accuracy by 79.5% and improves the worst out-of-distribution (OOD) accuracy by 5.8%, compared to the baseline. We believe our work will pave the path forward by enabling future work on system-induced data heterogeneity in a variety of realistic FL execution environment for a practical deployment of FL.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arena Com, Ltd. (2022)</span>
<span class="ltx_bibblock">
Arena Com, Ltd.

</span>
<span class="ltx_bibblock">Gsmarena.

</span>
<span class="ltx_bibblock"><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://www.gsmarena.com/</span>, 2022.

</span>
<span class="ltx_bibblock">Accessed: 2023-07-11.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brisimi et al. (2018)</span>
<span class="ltx_bibblock">
Brisimi, T. S., Chen, R., Mela, T., Olshevsky, A., Paschalidis, I. C., and Shi, W.

</span>
<span class="ltx_bibblock">Federated learning of predictive models from federated electronic health records.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International journal of medical informatics</em>, 112:59–67, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Buckler et al. (2017)</span>
<span class="ltx_bibblock">
Buckler, M., Jayasuriya, S., and Sampson, A.

</span>
<span class="ltx_bibblock">Reconfiguring the imaging pipeline for computer vision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference on Computer Vision</em>, pp.  975–984, 2017.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(4)</span>
<span class="ltx_bibblock">
Cannistra, S.

</span>
<span class="ltx_bibblock">Pixel binning.

</span>
<span class="ltx_bibblock"><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://www.starrywonders.com/binning.html</span>.

</span>
<span class="ltx_bibblock">Accessed: 2023-08-06.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cha et al. (2021)</span>
<span class="ltx_bibblock">
Cha, J., Chun, S., Lee, K., Cho, H.-C., Park, S., Lee, Y., and Park, S.

</span>
<span class="ltx_bibblock">Swad: Domain generalization by seeking flat minima.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34:22405–22418, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chipman et al. (1997)</span>
<span class="ltx_bibblock">
Chipman, H. A., Kolaczyk, E. D., and McCulloch, R. E.

</span>
<span class="ltx_bibblock">Adaptive bayesian wavelet shrinkage.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Journal of the American Statistical Association</em>, 92(440):1413–1421, 1997.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cidon et al. (2021)</span>
<span class="ltx_bibblock">
Cidon, E., Pergament, E., Asgar, Z., Cidon, A., and Katti, S.

</span>
<span class="ltx_bibblock">Characterizing and taming model instability across edge devices.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 3:624–636, 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et al. (2017)</span>
<span class="ltx_bibblock">
Cohen, G., Afshar, S., Tapson, J., and Van Schaik, A.

</span>
<span class="ltx_bibblock">Emnist: Extending mnist to handwritten letters.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">2017 international joint conference on neural networks (IJCNN)</em>, pp.  2921–2926. IEEE, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Creager et al. (2021)</span>
<span class="ltx_bibblock">
Creager, E., Jacobsen, J.-H., and Zemel, R.

</span>
<span class="ltx_bibblock">Environment inference for invariant learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  2189–2200. PMLR, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dekking et al. (2005)</span>
<span class="ltx_bibblock">
Dekking, F. M., Kraaikamp, C., Lopuhaä, H. P., and Meester, L. E.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">A Modern Introduction to Probability and Statistics: Understanding why and how</em>, volume 488.

</span>
<span class="ltx_bibblock">Springer, 2005.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2009)</span>
<span class="ltx_bibblock">
Deng, J., Dong, W., Socher, R., Li, L.-J., Li, K., and Fei-Fei, L.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">2009 IEEE conference on computer vision and pattern recognition</em>, pp.  248–255. Ieee, 2009.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dodge &amp; Karam (2016)</span>
<span class="ltx_bibblock">
Dodge, S. and Karam, L.

</span>
<span class="ltx_bibblock">Understanding how image quality affects deep neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">2016 eighth international conference on quality of multimedia experience (QoMEX)</em>, pp.  1–6. IEEE, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dou et al. (2019)</span>
<span class="ltx_bibblock">
Dou, Q., Coelho de Castro, D., Kamnitsas, K., and Glocker, B.

</span>
<span class="ltx_bibblock">Domain generalization via model-agnostic learning of semantic features.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ebner (2007)</span>
<span class="ltx_bibblock">
Ebner, M.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Color constancy</em>, volume 7.

</span>
<span class="ltx_bibblock">John Wiley &amp; Sons, 2007.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gozdz (2010)</span>
<span class="ltx_bibblock">
Gozdz, J.

</span>
<span class="ltx_bibblock">Fbdd denoising.

</span>
<span class="ltx_bibblock"><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://valelab4.ucsf.edu/svn/"#"micromanager2/trunk/DeviceAdapters/"#"TetheredCam/LibRaw/internal/dcb_demosaicing.c</span>, 2010.

</span>
<span class="ltx_bibblock">Accessed: 2023-08-06.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guliani et al. (2021)</span>
<span class="ltx_bibblock">
Guliani, D., Beaufays, F., and Motta, G.

</span>
<span class="ltx_bibblock">Training speech recognition models with federated learning: A quality/cost framework.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ICASSP 2021-2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>, pp.  3080–3084. IEEE, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hansen et al. (2021)</span>
<span class="ltx_bibblock">
Hansen, P., Vilkin, A., Krustalev, Y., Imber, J., Talagala, D., Hanwell, D., Mattina, M., and Whatmough, P. N.

</span>
<span class="ltx_bibblock">Isp4ml: The role of image signal processing in efficient deep learning vision systems.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">2020 25th International Conference on Pattern Recognition (ICPR)</em>, pp.  2438–2445. IEEE, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hejazinia et al. (2022)</span>
<span class="ltx_bibblock">
Hejazinia, M., Huba, D., Leontiadis, I., Maeng, K., Malek, M., Melis, L., Mironov, I., Nasr, M., Wang, K., and Wu, C.-J.

</span>
<span class="ltx_bibblock">Fel: High capacity learning for recommendation and ranking via federated ensemble learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.03852</em>, 2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hirakawa &amp; Parks (2005)</span>
<span class="ltx_bibblock">
Hirakawa, K. and Parks, T. W.

</span>
<span class="ltx_bibblock">Adaptive homogeneity-directed demosaicing algorithm.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Ieee transactions on image processing</em>, 14(3):360–369, 2005.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Howard et al. (2019)</span>
<span class="ltx_bibblock">
Howard, A., Sandler, M., Chu, G., Chen, L.-C., Chen, B., Tan, M., Wang, W., Zhu, Y., Pang, R., Vasudevan, V., et al.

</span>
<span class="ltx_bibblock">Searching for mobilenetv3.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF international conference on computer vision</em>, pp.  1314–1324, 2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huba et al. (2022)</span>
<span class="ltx_bibblock">
Huba, D., Nguyen, J., Malik, K., Zhu, R., Rabbat, M., Yousefpour, A., Wu, C.-J., Zhan, H., Ustinov, P., Srinivas, H., et al.

</span>
<span class="ltx_bibblock">Papaya: Practical, private, and scalable federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 4:814–832, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Iandola et al. (2016)</span>
<span class="ltx_bibblock">
Iandola, F. N., Han, S., Moskewicz, M. W., Ashraf, K., Dally, W. J., and Keutzer, K.

</span>
<span class="ltx_bibblock">Squeezenet: Alexnet-level accuracy with 50x fewer parameters and¡ 0.5 mb model size.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1602.07360</em>, 2016.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izmailov et al. (2018)</span>
<span class="ltx_bibblock">
Izmailov, P., Podoprikhin, D., Garipov, T., Vetrov, D., and Wilson, A. G.

</span>
<span class="ltx_bibblock">Averaging weights leads to wider optima and better generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1803.05407</em>, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N., Bonawitz, K., Charles, Z., Cormode, G., Cummings, R., et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>, 14(1–2):1–210, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P., Kale, S., Mohri, M., Reddi, S., Stich, S., and Suresh, A. T.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim &amp; Wu (2020)</span>
<span class="ltx_bibblock">
Kim, Y. G. and Wu, C.-J.

</span>
<span class="ltx_bibblock">Autoscale: Energy efficiency optimization for stochastic edge inference using reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">2020 53rd Annual IEEE/ACM International Symposium on Microarchitecture (MICRO)</em>, pp.  1082–1096. IEEE, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim &amp; Wu (2021)</span>
<span class="ltx_bibblock">
Kim, Y. G. and Wu, C.-J.

</span>
<span class="ltx_bibblock">Autofl: Enabling heterogeneity-aware energy efficient federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">MICRO-54: 54th Annual IEEE/ACM International Symposium on Microarchitecture</em>, pp.  183–198, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krueger et al. (2021)</span>
<span class="ltx_bibblock">
Krueger, D., Caballero, E., Jacobsen, J.-H., Zhang, A., Binas, J., Zhang, D., Le Priol, R., and Courville, A.

</span>
<span class="ltx_bibblock">Out-of-distribution generalization via risk extrapolation (rex).

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  5815–5826. PMLR, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Langley (2000)</span>
<span class="ltx_bibblock">
Langley, P.

</span>
<span class="ltx_bibblock">Crafting papers on machine learning.

</span>
<span class="ltx_bibblock">In Langley, P. (ed.), <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 17th International Conference on Machine Learning (ICML 2000)</em>, pp.  1207–1216, Stanford, CA, 2000. Morgan Kaufmann.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun (1998)</span>
<span class="ltx_bibblock">
LeCun, Y.

</span>
<span class="ltx_bibblock">The mnist database of handwritten digits.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">http://yann. lecun. com/exdb/mnist/</em>, 1998.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Li, T., Sanjabi, M., Beirami, A., and Smith, V.

</span>
<span class="ltx_bibblock">Fair resource allocation in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1905.10497</em>, 2019.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Li, Z., Xu, X., Cao, X., Liu, W., Zhang, Y., Chen, D., and Dai, H.

</span>
<span class="ltx_bibblock">Integrated cnn and federated learning for covid-19 detection on chest x-ray images.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">IEEE/ACM Transactions on Computational Biology and Bioinformatics</em>, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin (2003)</span>
<span class="ltx_bibblock">
Lin, C.-k.

</span>
<span class="ltx_bibblock">Pixel grouping for color filter array demosaicing, 2003.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Liu, Z., Lian, T., Farrell, J., and Wandell, B. A.

</span>
<span class="ltx_bibblock">Neural network generalization: The impact of camera parameters.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, 8:10443–10454, 2020.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2018)</span>
<span class="ltx_bibblock">
Ma, N., Zhang, X., Zheng, H.-T., and Sun, J.

</span>
<span class="ltx_bibblock">Shufflenet v2: Practical guidelines for efficient cnn architecture design.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European conference on computer vision (ECCV)</em>, pp.  116–131, 2018.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maeng et al. (2022)</span>
<span class="ltx_bibblock">
Maeng, K., Lu, H., Melis, L., Nguyen, J., Rabbat, M., and Wu, C.-J.

</span>
<span class="ltx_bibblock">Towards fair federated recommendation learning: Characterizing the inter-dependence of system and data heterogeneity.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 16th ACM Conference on Recommender Systems</em>, pp.  156–167, 2022.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mansour et al. (2020)</span>
<span class="ltx_bibblock">
Mansour, Y., Mohri, M., Ro, J., and Suresh, A. T.

</span>
<span class="ltx_bibblock">Three approaches for personalization with applications to federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri et al. (2019)</span>
<span class="ltx_bibblock">
Mohri, M., Sivek, G., and Suresh, A. T.

</span>
<span class="ltx_bibblock">Agnostic federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  4615–4625. PMLR, 2019.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Morovič (2008)</span>
<span class="ltx_bibblock">
Morovič, J.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Color gamut mapping</em>.

</span>
<span class="ltx_bibblock">John Wiley &amp; Sons, 2008.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pessach &amp; Shmueli (2022)</span>
<span class="ltx_bibblock">
Pessach, D. and Shmueli, E.

</span>
<span class="ltx_bibblock">A review on fairness in machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys (CSUR)</em>, 55(3):1–44, 2022.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qian et al. (2021)</span>
<span class="ltx_bibblock">
Qian, S., Ning, C., and Hu, Y.

</span>
<span class="ltx_bibblock">Mobilenetv3 for image classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">2021 IEEE 2nd International Conference on Big Data, Artificial Intelligence and Internet of Things Engineering (ICBAIE)</em>, pp.  490–497, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/ICBAIE52039.2021.9389905</span>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sagawa et al. (2019)</span>
<span class="ltx_bibblock">
Sagawa, S., Koh, P. W., Hashimoto, T. B., and Liang, P.

</span>
<span class="ltx_bibblock">Distributionally robust neural networks for group shifts: On the importance of regularization for worst-case generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.08731</em>, 2019.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scheuerman et al. (2021)</span>
<span class="ltx_bibblock">
Scheuerman, M. K., Hanna, A., and Denton, E.

</span>
<span class="ltx_bibblock">Do datasets have politics? disciplinary values in computer vision dataset development.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ACM on Human-Computer Interaction</em>, 5(CSCW2):1–37, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Segu et al. (2023)</span>
<span class="ltx_bibblock">
Segu, M., Tonioni, A., and Tombari, F.

</span>
<span class="ltx_bibblock">Batch normalization embeddings for deep domain generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Pattern Recognition</em>, 135:109115, 2023.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2023)</span>
<span class="ltx_bibblock">
Shi, Y., Yu, H., and Leung, C.

</span>
<span class="ltx_bibblock">Towards fairness-aware federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>, 2023.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shorten &amp; Khoshgoftaar (2019)</span>
<span class="ltx_bibblock">
Shorten, C. and Khoshgoftaar, T. M.

</span>
<span class="ltx_bibblock">A survey on image data augmentation for deep learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Journal of big data</em>, 6(1):1–48, 2019.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2022)</span>
<span class="ltx_bibblock">
Song, C., Granqvist, F., and Talwar, K.

</span>
<span class="ltx_bibblock">Flair: Federated learning annotated image repository.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:37792–37805, 2022.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">StatCounter (2022)</span>
<span class="ltx_bibblock">
StatCounter.

</span>
<span class="ltx_bibblock">Mobile vendor market share.

</span>
<span class="ltx_bibblock"><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://gs.statcounter.com/vendor-market-share/mobile/united-states-of-america/2021</span>, 2022.

</span>
<span class="ltx_bibblock">Accessed: 2023-07-11.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stokes (1996)</span>
<span class="ltx_bibblock">
Stokes, M.

</span>
<span class="ltx_bibblock">A standard default color space for the internet-srgb.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">http://www. w3. org/Graphics/Color/sRGB. html</em>, 1996.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Wang, J., Lan, C., Liu, C., Ouyang, Y., Qin, T., Lu, W., Chen, Y., Zeng, W., and Yu, P.

</span>
<span class="ltx_bibblock">Generalizing to unseen domains: A survey on domain generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Knowledge and Data Engineering</em>, 2022.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2019)</span>
<span class="ltx_bibblock">
Wu, C.-J., Brooks, D., Chen, K., Chen, D., Choudhury, S., Dukhan, M., Hazelwood, K., Isaac, E., Jia, Y., Jia, B., et al.

</span>
<span class="ltx_bibblock">Machine learning at facebook: Understanding inference at the edge.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">2019 IEEE international symposium on high performance computer architecture (HPCA)</em>, pp.  331–344. IEEE, 2019.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu &amp; Wang (2022)</span>
<span class="ltx_bibblock">
Wu, H. and Wang, P.

</span>
<span class="ltx_bibblock">Node selection toward faster convergence for federated learning on non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Network Science and Engineering</em>, 9(5):3099–3111, 2022.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wyszecki &amp; Stiles (2000)</span>
<span class="ltx_bibblock">
Wyszecki, G. and Stiles, W. S.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Color science: concepts and methods, quantitative data and formulae</em>, volume 40.

</span>
<span class="ltx_bibblock">John wiley &amp; sons, 2000.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2016)</span>
<span class="ltx_bibblock">
Zhang, H., Li, L., Qiao, K., Wang, L., Yan, B., Li, L., and Hu, G.

</span>
<span class="ltx_bibblock">Image prediction for limited-angle tomography via deep learning with convolutional neural network.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1607.08707</em>, 2016.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Zhao, Y., Li, M., Lai, L., Suda, N., Civin, D., and Chandra, V.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental Details</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Hardware &amp; Software</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.p1.1" class="ltx_p">We implement FL with PyTorch and TensorFlow, and emulate it with our dataset and Flair, respectively, on our servers. <span id="A1.SS1.p1.1.1" class="ltx_text ltx_font_bold">The following is the experimental environment used for our dataset
(Section <a href="#S3.SS1" title="3.1 Dataset Creation ‣ 3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). </span></p>
</div>
<div id="A1.SS1.p2" class="ltx_para ltx_noindent">
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">GPU/CPU models: No GPU, Intel(R) Xeon(R) Silver 4210R CPU @ 2.40GHz</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p">Amount of memory: 128GiB</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p">Operating system: Ubuntu 20.04.5</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.1" class="ltx_p">Version of PyTorch: 1.12.0</p>
</div>
</li>
</ul>
</div>
<div id="A1.SS1.p3" class="ltx_para ltx_noindent">
<p id="A1.SS1.p3.1" class="ltx_p"><span id="A1.SS1.p3.1.1" class="ltx_text ltx_font_bold">The following is the experimental environment used for the Flair <cite class="ltx_cite ltx_citemacro_cite">Song et al. (<a href="#bib.bib50" title="" class="ltx_ref">2022</a>)</cite>.</span></p>
</div>
<div id="A1.SS1.p4" class="ltx_para ltx_noindent">
<ul id="A1.I2" class="ltx_itemize">
<li id="A1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i1.p1" class="ltx_para">
<p id="A1.I2.i1.p1.1" class="ltx_p">GPU/CPU models: NVIDIA Tesla V100 GPU, Intel(R) Xeon(R) Gold 5218 CPU @ 2.30GHz</p>
</div>
</li>
<li id="A1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i2.p1" class="ltx_para">
<p id="A1.I2.i2.p1.1" class="ltx_p">Amount of memory: 128GiB</p>
</div>
</li>
<li id="A1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i3.p1" class="ltx_para">
<p id="A1.I2.i3.p1.1" class="ltx_p">Operating system: Ubuntu 20.04.3</p>
</div>
</li>
<li id="A1.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i4.p1" class="ltx_para">
<p id="A1.I2.i4.p1.1" class="ltx_p">Version of TensorFlow: 2.9.0</p>
</div>
</li>
<li id="A1.I2.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I2.i5.p1" class="ltx_para">
<p id="A1.I2.i5.p1.1" class="ltx_p">Version of TensorFlow-Federated: 0.20.0</p>
</div>
</li>
</ul>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>FL Parameters</h3>

<div id="A1.SS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.p1.1" class="ltx_p">We set the hyperparameters of FL based on the sensitivity analysis.<span id="A1.SS2.p1.1.1" class="ltx_text ltx_font_bold"> The hyperparameters that we test are summarized as follows:</span></p>
<ul id="A1.I3" class="ltx_itemize">
<li id="A1.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I3.i1.p1" class="ltx_para">
<p id="A1.I3.i1.p1.1" class="ltx_p">learning rate <math id="A1.I3.i1.p1.1.m1.3" class="ltx_Math" alttext="\eta\in\{0.001,0.01,0.1\}" display="inline"><semantics id="A1.I3.i1.p1.1.m1.3a"><mrow id="A1.I3.i1.p1.1.m1.3.4" xref="A1.I3.i1.p1.1.m1.3.4.cmml"><mi id="A1.I3.i1.p1.1.m1.3.4.2" xref="A1.I3.i1.p1.1.m1.3.4.2.cmml">η</mi><mo id="A1.I3.i1.p1.1.m1.3.4.1" xref="A1.I3.i1.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="A1.I3.i1.p1.1.m1.3.4.3.2" xref="A1.I3.i1.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A1.I3.i1.p1.1.m1.3.4.3.2.1" xref="A1.I3.i1.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="A1.I3.i1.p1.1.m1.1.1" xref="A1.I3.i1.p1.1.m1.1.1.cmml">0.001</mn><mo id="A1.I3.i1.p1.1.m1.3.4.3.2.2" xref="A1.I3.i1.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i1.p1.1.m1.2.2" xref="A1.I3.i1.p1.1.m1.2.2.cmml">0.01</mn><mo id="A1.I3.i1.p1.1.m1.3.4.3.2.3" xref="A1.I3.i1.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i1.p1.1.m1.3.3" xref="A1.I3.i1.p1.1.m1.3.3.cmml">0.1</mn><mo stretchy="false" id="A1.I3.i1.p1.1.m1.3.4.3.2.4" xref="A1.I3.i1.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I3.i1.p1.1.m1.3b"><apply id="A1.I3.i1.p1.1.m1.3.4.cmml" xref="A1.I3.i1.p1.1.m1.3.4"><in id="A1.I3.i1.p1.1.m1.3.4.1.cmml" xref="A1.I3.i1.p1.1.m1.3.4.1"></in><ci id="A1.I3.i1.p1.1.m1.3.4.2.cmml" xref="A1.I3.i1.p1.1.m1.3.4.2">𝜂</ci><set id="A1.I3.i1.p1.1.m1.3.4.3.1.cmml" xref="A1.I3.i1.p1.1.m1.3.4.3.2"><cn type="float" id="A1.I3.i1.p1.1.m1.1.1.cmml" xref="A1.I3.i1.p1.1.m1.1.1">0.001</cn><cn type="float" id="A1.I3.i1.p1.1.m1.2.2.cmml" xref="A1.I3.i1.p1.1.m1.2.2">0.01</cn><cn type="float" id="A1.I3.i1.p1.1.m1.3.3.cmml" xref="A1.I3.i1.p1.1.m1.3.3">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I3.i1.p1.1.m1.3c">\eta\in\{0.001,0.01,0.1\}</annotation></semantics></math></p>
</div>
</li>
<li id="A1.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I3.i2.p1" class="ltx_para">
<p id="A1.I3.i2.p1.1" class="ltx_p">Minibatch size <math id="A1.I3.i2.p1.1.m1.3" class="ltx_Math" alttext="B\in\{1,10,20\}" display="inline"><semantics id="A1.I3.i2.p1.1.m1.3a"><mrow id="A1.I3.i2.p1.1.m1.3.4" xref="A1.I3.i2.p1.1.m1.3.4.cmml"><mi id="A1.I3.i2.p1.1.m1.3.4.2" xref="A1.I3.i2.p1.1.m1.3.4.2.cmml">B</mi><mo id="A1.I3.i2.p1.1.m1.3.4.1" xref="A1.I3.i2.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="A1.I3.i2.p1.1.m1.3.4.3.2" xref="A1.I3.i2.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A1.I3.i2.p1.1.m1.3.4.3.2.1" xref="A1.I3.i2.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="A1.I3.i2.p1.1.m1.1.1" xref="A1.I3.i2.p1.1.m1.1.1.cmml">1</mn><mo id="A1.I3.i2.p1.1.m1.3.4.3.2.2" xref="A1.I3.i2.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i2.p1.1.m1.2.2" xref="A1.I3.i2.p1.1.m1.2.2.cmml">10</mn><mo id="A1.I3.i2.p1.1.m1.3.4.3.2.3" xref="A1.I3.i2.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i2.p1.1.m1.3.3" xref="A1.I3.i2.p1.1.m1.3.3.cmml">20</mn><mo stretchy="false" id="A1.I3.i2.p1.1.m1.3.4.3.2.4" xref="A1.I3.i2.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I3.i2.p1.1.m1.3b"><apply id="A1.I3.i2.p1.1.m1.3.4.cmml" xref="A1.I3.i2.p1.1.m1.3.4"><in id="A1.I3.i2.p1.1.m1.3.4.1.cmml" xref="A1.I3.i2.p1.1.m1.3.4.1"></in><ci id="A1.I3.i2.p1.1.m1.3.4.2.cmml" xref="A1.I3.i2.p1.1.m1.3.4.2">𝐵</ci><set id="A1.I3.i2.p1.1.m1.3.4.3.1.cmml" xref="A1.I3.i2.p1.1.m1.3.4.3.2"><cn type="integer" id="A1.I3.i2.p1.1.m1.1.1.cmml" xref="A1.I3.i2.p1.1.m1.1.1">1</cn><cn type="integer" id="A1.I3.i2.p1.1.m1.2.2.cmml" xref="A1.I3.i2.p1.1.m1.2.2">10</cn><cn type="integer" id="A1.I3.i2.p1.1.m1.3.3.cmml" xref="A1.I3.i2.p1.1.m1.3.3">20</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I3.i2.p1.1.m1.3c">B\in\{1,10,20\}</annotation></semantics></math></p>
</div>
</li>
<li id="A1.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I3.i3.p1" class="ltx_para">
<p id="A1.I3.i3.p1.1" class="ltx_p">Local epochs <math id="A1.I3.i3.p1.1.m1.3" class="ltx_Math" alttext="E\in\{1,3,5\}" display="inline"><semantics id="A1.I3.i3.p1.1.m1.3a"><mrow id="A1.I3.i3.p1.1.m1.3.4" xref="A1.I3.i3.p1.1.m1.3.4.cmml"><mi id="A1.I3.i3.p1.1.m1.3.4.2" xref="A1.I3.i3.p1.1.m1.3.4.2.cmml">E</mi><mo id="A1.I3.i3.p1.1.m1.3.4.1" xref="A1.I3.i3.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="A1.I3.i3.p1.1.m1.3.4.3.2" xref="A1.I3.i3.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A1.I3.i3.p1.1.m1.3.4.3.2.1" xref="A1.I3.i3.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="A1.I3.i3.p1.1.m1.1.1" xref="A1.I3.i3.p1.1.m1.1.1.cmml">1</mn><mo id="A1.I3.i3.p1.1.m1.3.4.3.2.2" xref="A1.I3.i3.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i3.p1.1.m1.2.2" xref="A1.I3.i3.p1.1.m1.2.2.cmml">3</mn><mo id="A1.I3.i3.p1.1.m1.3.4.3.2.3" xref="A1.I3.i3.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i3.p1.1.m1.3.3" xref="A1.I3.i3.p1.1.m1.3.3.cmml">5</mn><mo stretchy="false" id="A1.I3.i3.p1.1.m1.3.4.3.2.4" xref="A1.I3.i3.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I3.i3.p1.1.m1.3b"><apply id="A1.I3.i3.p1.1.m1.3.4.cmml" xref="A1.I3.i3.p1.1.m1.3.4"><in id="A1.I3.i3.p1.1.m1.3.4.1.cmml" xref="A1.I3.i3.p1.1.m1.3.4.1"></in><ci id="A1.I3.i3.p1.1.m1.3.4.2.cmml" xref="A1.I3.i3.p1.1.m1.3.4.2">𝐸</ci><set id="A1.I3.i3.p1.1.m1.3.4.3.1.cmml" xref="A1.I3.i3.p1.1.m1.3.4.3.2"><cn type="integer" id="A1.I3.i3.p1.1.m1.1.1.cmml" xref="A1.I3.i3.p1.1.m1.1.1">1</cn><cn type="integer" id="A1.I3.i3.p1.1.m1.2.2.cmml" xref="A1.I3.i3.p1.1.m1.2.2">3</cn><cn type="integer" id="A1.I3.i3.p1.1.m1.3.3.cmml" xref="A1.I3.i3.p1.1.m1.3.3">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I3.i3.p1.1.m1.3c">E\in\{1,3,5\}</annotation></semantics></math></p>
</div>
</li>
<li id="A1.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I3.i4.p1" class="ltx_para">
<p id="A1.I3.i4.p1.1" class="ltx_p">Number of communication rounds <math id="A1.I3.i4.p1.1.m1.3" class="ltx_Math" alttext="T\in\{100,500,1000\}" display="inline"><semantics id="A1.I3.i4.p1.1.m1.3a"><mrow id="A1.I3.i4.p1.1.m1.3.4" xref="A1.I3.i4.p1.1.m1.3.4.cmml"><mi id="A1.I3.i4.p1.1.m1.3.4.2" xref="A1.I3.i4.p1.1.m1.3.4.2.cmml">T</mi><mo id="A1.I3.i4.p1.1.m1.3.4.1" xref="A1.I3.i4.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="A1.I3.i4.p1.1.m1.3.4.3.2" xref="A1.I3.i4.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A1.I3.i4.p1.1.m1.3.4.3.2.1" xref="A1.I3.i4.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="A1.I3.i4.p1.1.m1.1.1" xref="A1.I3.i4.p1.1.m1.1.1.cmml">100</mn><mo id="A1.I3.i4.p1.1.m1.3.4.3.2.2" xref="A1.I3.i4.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i4.p1.1.m1.2.2" xref="A1.I3.i4.p1.1.m1.2.2.cmml">500</mn><mo id="A1.I3.i4.p1.1.m1.3.4.3.2.3" xref="A1.I3.i4.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.I3.i4.p1.1.m1.3.3" xref="A1.I3.i4.p1.1.m1.3.3.cmml">1000</mn><mo stretchy="false" id="A1.I3.i4.p1.1.m1.3.4.3.2.4" xref="A1.I3.i4.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I3.i4.p1.1.m1.3b"><apply id="A1.I3.i4.p1.1.m1.3.4.cmml" xref="A1.I3.i4.p1.1.m1.3.4"><in id="A1.I3.i4.p1.1.m1.3.4.1.cmml" xref="A1.I3.i4.p1.1.m1.3.4.1"></in><ci id="A1.I3.i4.p1.1.m1.3.4.2.cmml" xref="A1.I3.i4.p1.1.m1.3.4.2">𝑇</ci><set id="A1.I3.i4.p1.1.m1.3.4.3.1.cmml" xref="A1.I3.i4.p1.1.m1.3.4.3.2"><cn type="integer" id="A1.I3.i4.p1.1.m1.1.1.cmml" xref="A1.I3.i4.p1.1.m1.1.1">100</cn><cn type="integer" id="A1.I3.i4.p1.1.m1.2.2.cmml" xref="A1.I3.i4.p1.1.m1.2.2">500</cn><cn type="integer" id="A1.I3.i4.p1.1.m1.3.3.cmml" xref="A1.I3.i4.p1.1.m1.3.3">1000</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I3.i4.p1.1.m1.3c">T\in\{100,500,1000\}</annotation></semantics></math></p>
</div>
</li>
</ul>
<p id="A1.SS2.p1.2" class="ltx_p">Fig. <a href="#A1.F8" title="Figure 8 ‣ A.2 FL Parameters ‣ Appendix A Experimental Details" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows the sensitivity analysis result on the learning rate, minibatch size, local epoch, and number communication rounds. Based on results presented in Fig. <a href="#A1.F8" title="Figure 8 ‣ A.2 FL Parameters ‣ Appendix A Experimental Details" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we select 0.1, 10, 1, and 1000 for the learning rate, minibatch size, local epoch, and the number of communication rounds, respectively, for the rest of our experiments (i.e., characterization and evaluation in Section <a href="#S3" title="3 System-induced Data Heterogeneity in FL" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="#S6" title="6 Evaluation Results and Analysis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, respectively).</p>
</div>
<figure id="A1.F8" class="ltx_figure"><img src="/html/2403.04207/assets/Figures/Ap1.png" id="A1.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="606" height="246" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Selection of Learning Rate, Minibatch Size, Local Epoch, and Communication Rounds</figcaption>
</figure>
<div id="A1.SS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.p2.1" class="ltx_p">For a fair comparison with q-FedAvg and FedProx, we also configure the hyperparameters of q-FedAvg and FedProx based on the sensitivity analysis. <span id="A1.SS2.p2.1.1" class="ltx_text ltx_font_bold">Below are the hyperparameter grids that we searched on for previous works(Section  <a href="#S6.SS2" title="6.2 Comparison with Prior Works ‣ 6 Evaluation Results and Analysis" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>).</span></p>
</div>
<div id="A1.SS2.p3" class="ltx_para ltx_noindent">
<ul id="A1.I4" class="ltx_itemize">
<li id="A1.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I4.i1.p1" class="ltx_para">
<p id="A1.I4.i1.p1.1" class="ltx_p">q-FedAvg <math id="A1.I4.i1.p1.1.m1.6" class="ltx_Math" alttext="q\in\{1e-6,1e-5,1e-4,1e-3,1e-2,1e-1\}" display="inline"><semantics id="A1.I4.i1.p1.1.m1.6a"><mrow id="A1.I4.i1.p1.1.m1.6.6" xref="A1.I4.i1.p1.1.m1.6.6.cmml"><mi id="A1.I4.i1.p1.1.m1.6.6.8" xref="A1.I4.i1.p1.1.m1.6.6.8.cmml">q</mi><mo id="A1.I4.i1.p1.1.m1.6.6.7" xref="A1.I4.i1.p1.1.m1.6.6.7.cmml">∈</mo><mrow id="A1.I4.i1.p1.1.m1.6.6.6.6" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml"><mo stretchy="false" id="A1.I4.i1.p1.1.m1.6.6.6.6.7" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml">{</mo><mrow id="A1.I4.i1.p1.1.m1.1.1.1.1.1" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.cmml"><mrow id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.cmml"><mn id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.2" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.1" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.1.cmml">​</mo><mi id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.3" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.I4.i1.p1.1.m1.1.1.1.1.1.1" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.1.cmml">−</mo><mn id="A1.I4.i1.p1.1.m1.1.1.1.1.1.3" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.3.cmml">6</mn></mrow><mo id="A1.I4.i1.p1.1.m1.6.6.6.6.8" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml">,</mo><mrow id="A1.I4.i1.p1.1.m1.2.2.2.2.2" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.cmml"><mrow id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.cmml"><mn id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.2" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.1" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.3" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.3.cmml">e</mi></mrow><mo id="A1.I4.i1.p1.1.m1.2.2.2.2.2.1" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.1.cmml">−</mo><mn id="A1.I4.i1.p1.1.m1.2.2.2.2.2.3" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.3.cmml">5</mn></mrow><mo id="A1.I4.i1.p1.1.m1.6.6.6.6.9" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml">,</mo><mrow id="A1.I4.i1.p1.1.m1.3.3.3.3.3" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.cmml"><mrow id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.cmml"><mn id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.2" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.1" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.1.cmml">​</mo><mi id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.3" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.3.cmml">e</mi></mrow><mo id="A1.I4.i1.p1.1.m1.3.3.3.3.3.1" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.1.cmml">−</mo><mn id="A1.I4.i1.p1.1.m1.3.3.3.3.3.3" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.3.cmml">4</mn></mrow><mo id="A1.I4.i1.p1.1.m1.6.6.6.6.10" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml">,</mo><mrow id="A1.I4.i1.p1.1.m1.4.4.4.4.4" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.cmml"><mrow id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.cmml"><mn id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.2" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.1" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.1.cmml">​</mo><mi id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.3" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.3.cmml">e</mi></mrow><mo id="A1.I4.i1.p1.1.m1.4.4.4.4.4.1" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.1.cmml">−</mo><mn id="A1.I4.i1.p1.1.m1.4.4.4.4.4.3" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.3.cmml">3</mn></mrow><mo id="A1.I4.i1.p1.1.m1.6.6.6.6.11" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml">,</mo><mrow id="A1.I4.i1.p1.1.m1.5.5.5.5.5" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.cmml"><mrow id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.cmml"><mn id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.2" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.1" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.1.cmml">​</mo><mi id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.3" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.3.cmml">e</mi></mrow><mo id="A1.I4.i1.p1.1.m1.5.5.5.5.5.1" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.1.cmml">−</mo><mn id="A1.I4.i1.p1.1.m1.5.5.5.5.5.3" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.3.cmml">2</mn></mrow><mo id="A1.I4.i1.p1.1.m1.6.6.6.6.12" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml">,</mo><mrow id="A1.I4.i1.p1.1.m1.6.6.6.6.6" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.cmml"><mrow id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.cmml"><mn id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.2" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.1" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.1.cmml">​</mo><mi id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.3" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.3.cmml">e</mi></mrow><mo id="A1.I4.i1.p1.1.m1.6.6.6.6.6.1" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.1.cmml">−</mo><mn id="A1.I4.i1.p1.1.m1.6.6.6.6.6.3" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.3.cmml">1</mn></mrow><mo stretchy="false" id="A1.I4.i1.p1.1.m1.6.6.6.6.13" xref="A1.I4.i1.p1.1.m1.6.6.6.7.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I4.i1.p1.1.m1.6b"><apply id="A1.I4.i1.p1.1.m1.6.6.cmml" xref="A1.I4.i1.p1.1.m1.6.6"><in id="A1.I4.i1.p1.1.m1.6.6.7.cmml" xref="A1.I4.i1.p1.1.m1.6.6.7"></in><ci id="A1.I4.i1.p1.1.m1.6.6.8.cmml" xref="A1.I4.i1.p1.1.m1.6.6.8">𝑞</ci><set id="A1.I4.i1.p1.1.m1.6.6.6.7.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6"><apply id="A1.I4.i1.p1.1.m1.1.1.1.1.1.cmml" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1"><minus id="A1.I4.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.1"></minus><apply id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2"><times id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.1"></times><cn type="integer" id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.2">1</cn><ci id="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.I4.i1.p1.1.m1.1.1.1.1.1.3">6</cn></apply><apply id="A1.I4.i1.p1.1.m1.2.2.2.2.2.cmml" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2"><minus id="A1.I4.i1.p1.1.m1.2.2.2.2.2.1.cmml" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.1"></minus><apply id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.cmml" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2"><times id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.1"></times><cn type="integer" id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.2">1</cn><ci id="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i1.p1.1.m1.2.2.2.2.2.3.cmml" xref="A1.I4.i1.p1.1.m1.2.2.2.2.2.3">5</cn></apply><apply id="A1.I4.i1.p1.1.m1.3.3.3.3.3.cmml" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3"><minus id="A1.I4.i1.p1.1.m1.3.3.3.3.3.1.cmml" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.1"></minus><apply id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.cmml" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2"><times id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.1.cmml" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.1"></times><cn type="integer" id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.2.cmml" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.2">1</cn><ci id="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.3.cmml" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i1.p1.1.m1.3.3.3.3.3.3.cmml" xref="A1.I4.i1.p1.1.m1.3.3.3.3.3.3">4</cn></apply><apply id="A1.I4.i1.p1.1.m1.4.4.4.4.4.cmml" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4"><minus id="A1.I4.i1.p1.1.m1.4.4.4.4.4.1.cmml" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.1"></minus><apply id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.cmml" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2"><times id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.1.cmml" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.1"></times><cn type="integer" id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.2.cmml" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.2">1</cn><ci id="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.3.cmml" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i1.p1.1.m1.4.4.4.4.4.3.cmml" xref="A1.I4.i1.p1.1.m1.4.4.4.4.4.3">3</cn></apply><apply id="A1.I4.i1.p1.1.m1.5.5.5.5.5.cmml" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5"><minus id="A1.I4.i1.p1.1.m1.5.5.5.5.5.1.cmml" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.1"></minus><apply id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.cmml" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2"><times id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.1.cmml" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.1"></times><cn type="integer" id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.2.cmml" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.2">1</cn><ci id="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.3.cmml" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i1.p1.1.m1.5.5.5.5.5.3.cmml" xref="A1.I4.i1.p1.1.m1.5.5.5.5.5.3">2</cn></apply><apply id="A1.I4.i1.p1.1.m1.6.6.6.6.6.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6"><minus id="A1.I4.i1.p1.1.m1.6.6.6.6.6.1.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.1"></minus><apply id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2"><times id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.1.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.1"></times><cn type="integer" id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.2.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.2">1</cn><ci id="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.3.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i1.p1.1.m1.6.6.6.6.6.3.cmml" xref="A1.I4.i1.p1.1.m1.6.6.6.6.6.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I4.i1.p1.1.m1.6c">q\in\{1e-6,1e-5,1e-4,1e-3,1e-2,1e-1\}</annotation></semantics></math></p>
</div>
</li>
<li id="A1.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I4.i2.p1" class="ltx_para">
<p id="A1.I4.i2.p1.1" class="ltx_p">FedProx <math id="A1.I4.i2.p1.1.m1.5" class="ltx_Math" alttext="\mu\in\{1e-5,1e-4,1e-3,1e-2,1e-1\}" display="inline"><semantics id="A1.I4.i2.p1.1.m1.5a"><mrow id="A1.I4.i2.p1.1.m1.5.5" xref="A1.I4.i2.p1.1.m1.5.5.cmml"><mi id="A1.I4.i2.p1.1.m1.5.5.7" xref="A1.I4.i2.p1.1.m1.5.5.7.cmml">μ</mi><mo id="A1.I4.i2.p1.1.m1.5.5.6" xref="A1.I4.i2.p1.1.m1.5.5.6.cmml">∈</mo><mrow id="A1.I4.i2.p1.1.m1.5.5.5.5" xref="A1.I4.i2.p1.1.m1.5.5.5.6.cmml"><mo stretchy="false" id="A1.I4.i2.p1.1.m1.5.5.5.5.6" xref="A1.I4.i2.p1.1.m1.5.5.5.6.cmml">{</mo><mrow id="A1.I4.i2.p1.1.m1.1.1.1.1.1" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.cmml"><mrow id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.cmml"><mn id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.2" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.1" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.1.cmml">​</mo><mi id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.3" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.I4.i2.p1.1.m1.1.1.1.1.1.1" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.1.cmml">−</mo><mn id="A1.I4.i2.p1.1.m1.1.1.1.1.1.3" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.3.cmml">5</mn></mrow><mo id="A1.I4.i2.p1.1.m1.5.5.5.5.7" xref="A1.I4.i2.p1.1.m1.5.5.5.6.cmml">,</mo><mrow id="A1.I4.i2.p1.1.m1.2.2.2.2.2" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.cmml"><mrow id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.cmml"><mn id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.2" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.1" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.3" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.3.cmml">e</mi></mrow><mo id="A1.I4.i2.p1.1.m1.2.2.2.2.2.1" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.1.cmml">−</mo><mn id="A1.I4.i2.p1.1.m1.2.2.2.2.2.3" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.3.cmml">4</mn></mrow><mo id="A1.I4.i2.p1.1.m1.5.5.5.5.8" xref="A1.I4.i2.p1.1.m1.5.5.5.6.cmml">,</mo><mrow id="A1.I4.i2.p1.1.m1.3.3.3.3.3" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.cmml"><mrow id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.cmml"><mn id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.2" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.1" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.1.cmml">​</mo><mi id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.3" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.3.cmml">e</mi></mrow><mo id="A1.I4.i2.p1.1.m1.3.3.3.3.3.1" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.1.cmml">−</mo><mn id="A1.I4.i2.p1.1.m1.3.3.3.3.3.3" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.3.cmml">3</mn></mrow><mo id="A1.I4.i2.p1.1.m1.5.5.5.5.9" xref="A1.I4.i2.p1.1.m1.5.5.5.6.cmml">,</mo><mrow id="A1.I4.i2.p1.1.m1.4.4.4.4.4" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.cmml"><mrow id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.cmml"><mn id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.2" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.1" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.1.cmml">​</mo><mi id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.3" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.3.cmml">e</mi></mrow><mo id="A1.I4.i2.p1.1.m1.4.4.4.4.4.1" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.1.cmml">−</mo><mn id="A1.I4.i2.p1.1.m1.4.4.4.4.4.3" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.3.cmml">2</mn></mrow><mo id="A1.I4.i2.p1.1.m1.5.5.5.5.10" xref="A1.I4.i2.p1.1.m1.5.5.5.6.cmml">,</mo><mrow id="A1.I4.i2.p1.1.m1.5.5.5.5.5" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.cmml"><mrow id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.cmml"><mn id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.2" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.1" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.1.cmml">​</mo><mi id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.3" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.3.cmml">e</mi></mrow><mo id="A1.I4.i2.p1.1.m1.5.5.5.5.5.1" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.1.cmml">−</mo><mn id="A1.I4.i2.p1.1.m1.5.5.5.5.5.3" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.3.cmml">1</mn></mrow><mo stretchy="false" id="A1.I4.i2.p1.1.m1.5.5.5.5.11" xref="A1.I4.i2.p1.1.m1.5.5.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I4.i2.p1.1.m1.5b"><apply id="A1.I4.i2.p1.1.m1.5.5.cmml" xref="A1.I4.i2.p1.1.m1.5.5"><in id="A1.I4.i2.p1.1.m1.5.5.6.cmml" xref="A1.I4.i2.p1.1.m1.5.5.6"></in><ci id="A1.I4.i2.p1.1.m1.5.5.7.cmml" xref="A1.I4.i2.p1.1.m1.5.5.7">𝜇</ci><set id="A1.I4.i2.p1.1.m1.5.5.5.6.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5"><apply id="A1.I4.i2.p1.1.m1.1.1.1.1.1.cmml" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1"><minus id="A1.I4.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.1"></minus><apply id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2"><times id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.1"></times><cn type="integer" id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.2">1</cn><ci id="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.I4.i2.p1.1.m1.1.1.1.1.1.3">5</cn></apply><apply id="A1.I4.i2.p1.1.m1.2.2.2.2.2.cmml" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2"><minus id="A1.I4.i2.p1.1.m1.2.2.2.2.2.1.cmml" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.1"></minus><apply id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.cmml" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2"><times id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.1"></times><cn type="integer" id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.2">1</cn><ci id="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i2.p1.1.m1.2.2.2.2.2.3.cmml" xref="A1.I4.i2.p1.1.m1.2.2.2.2.2.3">4</cn></apply><apply id="A1.I4.i2.p1.1.m1.3.3.3.3.3.cmml" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3"><minus id="A1.I4.i2.p1.1.m1.3.3.3.3.3.1.cmml" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.1"></minus><apply id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.cmml" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2"><times id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.1.cmml" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.1"></times><cn type="integer" id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.2.cmml" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.2">1</cn><ci id="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.3.cmml" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i2.p1.1.m1.3.3.3.3.3.3.cmml" xref="A1.I4.i2.p1.1.m1.3.3.3.3.3.3">3</cn></apply><apply id="A1.I4.i2.p1.1.m1.4.4.4.4.4.cmml" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4"><minus id="A1.I4.i2.p1.1.m1.4.4.4.4.4.1.cmml" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.1"></minus><apply id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.cmml" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2"><times id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.1.cmml" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.1"></times><cn type="integer" id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.2.cmml" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.2">1</cn><ci id="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.3.cmml" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i2.p1.1.m1.4.4.4.4.4.3.cmml" xref="A1.I4.i2.p1.1.m1.4.4.4.4.4.3">2</cn></apply><apply id="A1.I4.i2.p1.1.m1.5.5.5.5.5.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5"><minus id="A1.I4.i2.p1.1.m1.5.5.5.5.5.1.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.1"></minus><apply id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2"><times id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.1.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.1"></times><cn type="integer" id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.2.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.2">1</cn><ci id="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.3.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.2.3">𝑒</ci></apply><cn type="integer" id="A1.I4.i2.p1.1.m1.5.5.5.5.5.3.cmml" xref="A1.I4.i2.p1.1.m1.5.5.5.5.5.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I4.i2.p1.1.m1.5c">\mu\in\{1e-5,1e-4,1e-3,1e-2,1e-1\}</annotation></semantics></math></p>
</div>
</li>
</ul>
</div>
<div id="A1.SS2.p4" class="ltx_para ltx_noindent">
<p id="A1.SS2.p4.2" class="ltx_p">we use <math id="A1.SS2.p4.1.m1.1" class="ltx_Math" alttext="q=1e-6" display="inline"><semantics id="A1.SS2.p4.1.m1.1a"><mrow id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">q</mi><mo id="A1.SS2.p4.1.m1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.cmml">=</mo><mrow id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml"><mrow id="A1.SS2.p4.1.m1.1.1.3.2" xref="A1.SS2.p4.1.m1.1.1.3.2.cmml"><mn id="A1.SS2.p4.1.m1.1.1.3.2.2" xref="A1.SS2.p4.1.m1.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.SS2.p4.1.m1.1.1.3.2.1" xref="A1.SS2.p4.1.m1.1.1.3.2.1.cmml">​</mo><mi id="A1.SS2.p4.1.m1.1.1.3.2.3" xref="A1.SS2.p4.1.m1.1.1.3.2.3.cmml">e</mi></mrow><mo id="A1.SS2.p4.1.m1.1.1.3.1" xref="A1.SS2.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="A1.SS2.p4.1.m1.1.1.3.3" xref="A1.SS2.p4.1.m1.1.1.3.3.cmml">6</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><eq id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1"></eq><ci id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">𝑞</ci><apply id="A1.SS2.p4.1.m1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3"><minus id="A1.SS2.p4.1.m1.1.1.3.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3.1"></minus><apply id="A1.SS2.p4.1.m1.1.1.3.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2"><times id="A1.SS2.p4.1.m1.1.1.3.2.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.1"></times><cn type="integer" id="A1.SS2.p4.1.m1.1.1.3.2.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.2">1</cn><ci id="A1.SS2.p4.1.m1.1.1.3.2.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.SS2.p4.1.m1.1.1.3.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">q=1e-6</annotation></semantics></math> and <math id="A1.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mu=1e-1" display="inline"><semantics id="A1.SS2.p4.2.m2.1a"><mrow id="A1.SS2.p4.2.m2.1.1" xref="A1.SS2.p4.2.m2.1.1.cmml"><mi id="A1.SS2.p4.2.m2.1.1.2" xref="A1.SS2.p4.2.m2.1.1.2.cmml">μ</mi><mo id="A1.SS2.p4.2.m2.1.1.1" xref="A1.SS2.p4.2.m2.1.1.1.cmml">=</mo><mrow id="A1.SS2.p4.2.m2.1.1.3" xref="A1.SS2.p4.2.m2.1.1.3.cmml"><mrow id="A1.SS2.p4.2.m2.1.1.3.2" xref="A1.SS2.p4.2.m2.1.1.3.2.cmml"><mn id="A1.SS2.p4.2.m2.1.1.3.2.2" xref="A1.SS2.p4.2.m2.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.SS2.p4.2.m2.1.1.3.2.1" xref="A1.SS2.p4.2.m2.1.1.3.2.1.cmml">​</mo><mi id="A1.SS2.p4.2.m2.1.1.3.2.3" xref="A1.SS2.p4.2.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="A1.SS2.p4.2.m2.1.1.3.1" xref="A1.SS2.p4.2.m2.1.1.3.1.cmml">−</mo><mn id="A1.SS2.p4.2.m2.1.1.3.3" xref="A1.SS2.p4.2.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.1b"><apply id="A1.SS2.p4.2.m2.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1"><eq id="A1.SS2.p4.2.m2.1.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1.1"></eq><ci id="A1.SS2.p4.2.m2.1.1.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2">𝜇</ci><apply id="A1.SS2.p4.2.m2.1.1.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3"><minus id="A1.SS2.p4.2.m2.1.1.3.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3.1"></minus><apply id="A1.SS2.p4.2.m2.1.1.3.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2"><times id="A1.SS2.p4.2.m2.1.1.3.2.1.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.1"></times><cn type="integer" id="A1.SS2.p4.2.m2.1.1.3.2.2.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.2">1</cn><ci id="A1.SS2.p4.2.m2.1.1.3.2.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.SS2.p4.2.m2.1.1.3.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.1c">\mu=1e-1</annotation></semantics></math>, for q-FedAvg, and FedProx, respectively.</p>
</div>
<div id="A1.SS2.p5" class="ltx_para ltx_noindent">
<p id="A1.SS2.p5.1" class="ltx_p"><span id="A1.SS2.p5.1.1" class="ltx_text ltx_font_bold">Below are the hyperparameter grids that we searched on for HeteroSwitch</span></p>
<ul id="A1.I5" class="ltx_itemize">
<li id="A1.I5.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I5.i1.p1" class="ltx_para">
<p id="A1.I5.i1.p1.1" class="ltx_p">Random WB <math id="A1.I5.i1.p1.1.m1.5" class="ltx_Math" alttext="degree\in\{0.001,0.01,0.1,0.5,0.9\}" display="inline"><semantics id="A1.I5.i1.p1.1.m1.5a"><mrow id="A1.I5.i1.p1.1.m1.5.6" xref="A1.I5.i1.p1.1.m1.5.6.cmml"><mrow id="A1.I5.i1.p1.1.m1.5.6.2" xref="A1.I5.i1.p1.1.m1.5.6.2.cmml"><mi id="A1.I5.i1.p1.1.m1.5.6.2.2" xref="A1.I5.i1.p1.1.m1.5.6.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.I5.i1.p1.1.m1.5.6.2.1" xref="A1.I5.i1.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i1.p1.1.m1.5.6.2.3" xref="A1.I5.i1.p1.1.m1.5.6.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.I5.i1.p1.1.m1.5.6.2.1a" xref="A1.I5.i1.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i1.p1.1.m1.5.6.2.4" xref="A1.I5.i1.p1.1.m1.5.6.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.I5.i1.p1.1.m1.5.6.2.1b" xref="A1.I5.i1.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i1.p1.1.m1.5.6.2.5" xref="A1.I5.i1.p1.1.m1.5.6.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.I5.i1.p1.1.m1.5.6.2.1c" xref="A1.I5.i1.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i1.p1.1.m1.5.6.2.6" xref="A1.I5.i1.p1.1.m1.5.6.2.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.I5.i1.p1.1.m1.5.6.2.1d" xref="A1.I5.i1.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i1.p1.1.m1.5.6.2.7" xref="A1.I5.i1.p1.1.m1.5.6.2.7.cmml">e</mi></mrow><mo id="A1.I5.i1.p1.1.m1.5.6.1" xref="A1.I5.i1.p1.1.m1.5.6.1.cmml">∈</mo><mrow id="A1.I5.i1.p1.1.m1.5.6.3.2" xref="A1.I5.i1.p1.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="A1.I5.i1.p1.1.m1.5.6.3.2.1" xref="A1.I5.i1.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="A1.I5.i1.p1.1.m1.1.1" xref="A1.I5.i1.p1.1.m1.1.1.cmml">0.001</mn><mo id="A1.I5.i1.p1.1.m1.5.6.3.2.2" xref="A1.I5.i1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i1.p1.1.m1.2.2" xref="A1.I5.i1.p1.1.m1.2.2.cmml">0.01</mn><mo id="A1.I5.i1.p1.1.m1.5.6.3.2.3" xref="A1.I5.i1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i1.p1.1.m1.3.3" xref="A1.I5.i1.p1.1.m1.3.3.cmml">0.1</mn><mo id="A1.I5.i1.p1.1.m1.5.6.3.2.4" xref="A1.I5.i1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i1.p1.1.m1.4.4" xref="A1.I5.i1.p1.1.m1.4.4.cmml">0.5</mn><mo id="A1.I5.i1.p1.1.m1.5.6.3.2.5" xref="A1.I5.i1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i1.p1.1.m1.5.5" xref="A1.I5.i1.p1.1.m1.5.5.cmml">0.9</mn><mo stretchy="false" id="A1.I5.i1.p1.1.m1.5.6.3.2.6" xref="A1.I5.i1.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I5.i1.p1.1.m1.5b"><apply id="A1.I5.i1.p1.1.m1.5.6.cmml" xref="A1.I5.i1.p1.1.m1.5.6"><in id="A1.I5.i1.p1.1.m1.5.6.1.cmml" xref="A1.I5.i1.p1.1.m1.5.6.1"></in><apply id="A1.I5.i1.p1.1.m1.5.6.2.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2"><times id="A1.I5.i1.p1.1.m1.5.6.2.1.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2.1"></times><ci id="A1.I5.i1.p1.1.m1.5.6.2.2.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2.2">𝑑</ci><ci id="A1.I5.i1.p1.1.m1.5.6.2.3.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2.3">𝑒</ci><ci id="A1.I5.i1.p1.1.m1.5.6.2.4.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2.4">𝑔</ci><ci id="A1.I5.i1.p1.1.m1.5.6.2.5.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2.5">𝑟</ci><ci id="A1.I5.i1.p1.1.m1.5.6.2.6.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2.6">𝑒</ci><ci id="A1.I5.i1.p1.1.m1.5.6.2.7.cmml" xref="A1.I5.i1.p1.1.m1.5.6.2.7">𝑒</ci></apply><set id="A1.I5.i1.p1.1.m1.5.6.3.1.cmml" xref="A1.I5.i1.p1.1.m1.5.6.3.2"><cn type="float" id="A1.I5.i1.p1.1.m1.1.1.cmml" xref="A1.I5.i1.p1.1.m1.1.1">0.001</cn><cn type="float" id="A1.I5.i1.p1.1.m1.2.2.cmml" xref="A1.I5.i1.p1.1.m1.2.2">0.01</cn><cn type="float" id="A1.I5.i1.p1.1.m1.3.3.cmml" xref="A1.I5.i1.p1.1.m1.3.3">0.1</cn><cn type="float" id="A1.I5.i1.p1.1.m1.4.4.cmml" xref="A1.I5.i1.p1.1.m1.4.4">0.5</cn><cn type="float" id="A1.I5.i1.p1.1.m1.5.5.cmml" xref="A1.I5.i1.p1.1.m1.5.5">0.9</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I5.i1.p1.1.m1.5c">degree\in\{0.001,0.01,0.1,0.5,0.9\}</annotation></semantics></math></p>
</div>
</li>
<li id="A1.I5.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I5.i2.p1" class="ltx_para">
<p id="A1.I5.i2.p1.1" class="ltx_p">Random Gamma <math id="A1.I5.i2.p1.1.m1.5" class="ltx_Math" alttext="degree\in\{0.1,0.3,0.5,0.7,0.9\}" display="inline"><semantics id="A1.I5.i2.p1.1.m1.5a"><mrow id="A1.I5.i2.p1.1.m1.5.6" xref="A1.I5.i2.p1.1.m1.5.6.cmml"><mrow id="A1.I5.i2.p1.1.m1.5.6.2" xref="A1.I5.i2.p1.1.m1.5.6.2.cmml"><mi id="A1.I5.i2.p1.1.m1.5.6.2.2" xref="A1.I5.i2.p1.1.m1.5.6.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.I5.i2.p1.1.m1.5.6.2.1" xref="A1.I5.i2.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i2.p1.1.m1.5.6.2.3" xref="A1.I5.i2.p1.1.m1.5.6.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.I5.i2.p1.1.m1.5.6.2.1a" xref="A1.I5.i2.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i2.p1.1.m1.5.6.2.4" xref="A1.I5.i2.p1.1.m1.5.6.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.I5.i2.p1.1.m1.5.6.2.1b" xref="A1.I5.i2.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i2.p1.1.m1.5.6.2.5" xref="A1.I5.i2.p1.1.m1.5.6.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.I5.i2.p1.1.m1.5.6.2.1c" xref="A1.I5.i2.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i2.p1.1.m1.5.6.2.6" xref="A1.I5.i2.p1.1.m1.5.6.2.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.I5.i2.p1.1.m1.5.6.2.1d" xref="A1.I5.i2.p1.1.m1.5.6.2.1.cmml">​</mo><mi id="A1.I5.i2.p1.1.m1.5.6.2.7" xref="A1.I5.i2.p1.1.m1.5.6.2.7.cmml">e</mi></mrow><mo id="A1.I5.i2.p1.1.m1.5.6.1" xref="A1.I5.i2.p1.1.m1.5.6.1.cmml">∈</mo><mrow id="A1.I5.i2.p1.1.m1.5.6.3.2" xref="A1.I5.i2.p1.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="A1.I5.i2.p1.1.m1.5.6.3.2.1" xref="A1.I5.i2.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="A1.I5.i2.p1.1.m1.1.1" xref="A1.I5.i2.p1.1.m1.1.1.cmml">0.1</mn><mo id="A1.I5.i2.p1.1.m1.5.6.3.2.2" xref="A1.I5.i2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i2.p1.1.m1.2.2" xref="A1.I5.i2.p1.1.m1.2.2.cmml">0.3</mn><mo id="A1.I5.i2.p1.1.m1.5.6.3.2.3" xref="A1.I5.i2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i2.p1.1.m1.3.3" xref="A1.I5.i2.p1.1.m1.3.3.cmml">0.5</mn><mo id="A1.I5.i2.p1.1.m1.5.6.3.2.4" xref="A1.I5.i2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i2.p1.1.m1.4.4" xref="A1.I5.i2.p1.1.m1.4.4.cmml">0.7</mn><mo id="A1.I5.i2.p1.1.m1.5.6.3.2.5" xref="A1.I5.i2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="A1.I5.i2.p1.1.m1.5.5" xref="A1.I5.i2.p1.1.m1.5.5.cmml">0.9</mn><mo stretchy="false" id="A1.I5.i2.p1.1.m1.5.6.3.2.6" xref="A1.I5.i2.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I5.i2.p1.1.m1.5b"><apply id="A1.I5.i2.p1.1.m1.5.6.cmml" xref="A1.I5.i2.p1.1.m1.5.6"><in id="A1.I5.i2.p1.1.m1.5.6.1.cmml" xref="A1.I5.i2.p1.1.m1.5.6.1"></in><apply id="A1.I5.i2.p1.1.m1.5.6.2.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2"><times id="A1.I5.i2.p1.1.m1.5.6.2.1.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2.1"></times><ci id="A1.I5.i2.p1.1.m1.5.6.2.2.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2.2">𝑑</ci><ci id="A1.I5.i2.p1.1.m1.5.6.2.3.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2.3">𝑒</ci><ci id="A1.I5.i2.p1.1.m1.5.6.2.4.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2.4">𝑔</ci><ci id="A1.I5.i2.p1.1.m1.5.6.2.5.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2.5">𝑟</ci><ci id="A1.I5.i2.p1.1.m1.5.6.2.6.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2.6">𝑒</ci><ci id="A1.I5.i2.p1.1.m1.5.6.2.7.cmml" xref="A1.I5.i2.p1.1.m1.5.6.2.7">𝑒</ci></apply><set id="A1.I5.i2.p1.1.m1.5.6.3.1.cmml" xref="A1.I5.i2.p1.1.m1.5.6.3.2"><cn type="float" id="A1.I5.i2.p1.1.m1.1.1.cmml" xref="A1.I5.i2.p1.1.m1.1.1">0.1</cn><cn type="float" id="A1.I5.i2.p1.1.m1.2.2.cmml" xref="A1.I5.i2.p1.1.m1.2.2">0.3</cn><cn type="float" id="A1.I5.i2.p1.1.m1.3.3.cmml" xref="A1.I5.i2.p1.1.m1.3.3">0.5</cn><cn type="float" id="A1.I5.i2.p1.1.m1.4.4.cmml" xref="A1.I5.i2.p1.1.m1.4.4">0.7</cn><cn type="float" id="A1.I5.i2.p1.1.m1.5.5.cmml" xref="A1.I5.i2.p1.1.m1.5.5">0.9</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I5.i2.p1.1.m1.5c">degree\in\{0.1,0.3,0.5,0.7,0.9\}</annotation></semantics></math></p>
</div>
</li>
</ul>
</div>
<div id="A1.SS2.p6" class="ltx_para ltx_noindent">
<p id="A1.SS2.p6.4" class="ltx_p">We set the smoothing factor for Exponential Moving Average <math id="A1.SS2.p6.1.m1.1" class="ltx_Math" alttext="\alpha=0.9" display="inline"><semantics id="A1.SS2.p6.1.m1.1a"><mrow id="A1.SS2.p6.1.m1.1.1" xref="A1.SS2.p6.1.m1.1.1.cmml"><mi id="A1.SS2.p6.1.m1.1.1.2" xref="A1.SS2.p6.1.m1.1.1.2.cmml">α</mi><mo id="A1.SS2.p6.1.m1.1.1.1" xref="A1.SS2.p6.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS2.p6.1.m1.1.1.3" xref="A1.SS2.p6.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.1.m1.1b"><apply id="A1.SS2.p6.1.m1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1"><eq id="A1.SS2.p6.1.m1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1.1"></eq><ci id="A1.SS2.p6.1.m1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.SS2.p6.1.m1.1.1.3.cmml" xref="A1.SS2.p6.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.1.m1.1c">\alpha=0.9</annotation></semantics></math> for <math id="A1.SS2.p6.2.m2.1" class="ltx_Math" alttext="L_{EMA}" display="inline"><semantics id="A1.SS2.p6.2.m2.1a"><msub id="A1.SS2.p6.2.m2.1.1" xref="A1.SS2.p6.2.m2.1.1.cmml"><mi id="A1.SS2.p6.2.m2.1.1.2" xref="A1.SS2.p6.2.m2.1.1.2.cmml">L</mi><mrow id="A1.SS2.p6.2.m2.1.1.3" xref="A1.SS2.p6.2.m2.1.1.3.cmml"><mi id="A1.SS2.p6.2.m2.1.1.3.2" xref="A1.SS2.p6.2.m2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.2.m2.1.1.3.1" xref="A1.SS2.p6.2.m2.1.1.3.1.cmml">​</mo><mi id="A1.SS2.p6.2.m2.1.1.3.3" xref="A1.SS2.p6.2.m2.1.1.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.2.m2.1.1.3.1a" xref="A1.SS2.p6.2.m2.1.1.3.1.cmml">​</mo><mi id="A1.SS2.p6.2.m2.1.1.3.4" xref="A1.SS2.p6.2.m2.1.1.3.4.cmml">A</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.2.m2.1b"><apply id="A1.SS2.p6.2.m2.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.2.m2.1.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p6.2.m2.1.1.2.cmml" xref="A1.SS2.p6.2.m2.1.1.2">𝐿</ci><apply id="A1.SS2.p6.2.m2.1.1.3.cmml" xref="A1.SS2.p6.2.m2.1.1.3"><times id="A1.SS2.p6.2.m2.1.1.3.1.cmml" xref="A1.SS2.p6.2.m2.1.1.3.1"></times><ci id="A1.SS2.p6.2.m2.1.1.3.2.cmml" xref="A1.SS2.p6.2.m2.1.1.3.2">𝐸</ci><ci id="A1.SS2.p6.2.m2.1.1.3.3.cmml" xref="A1.SS2.p6.2.m2.1.1.3.3">𝑀</ci><ci id="A1.SS2.p6.2.m2.1.1.3.4.cmml" xref="A1.SS2.p6.2.m2.1.1.3.4">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.2.m2.1c">L_{EMA}</annotation></semantics></math>, Random WB <math id="A1.SS2.p6.3.m3.1" class="ltx_Math" alttext="degree=0.001" display="inline"><semantics id="A1.SS2.p6.3.m3.1a"><mrow id="A1.SS2.p6.3.m3.1.1" xref="A1.SS2.p6.3.m3.1.1.cmml"><mrow id="A1.SS2.p6.3.m3.1.1.2" xref="A1.SS2.p6.3.m3.1.1.2.cmml"><mi id="A1.SS2.p6.3.m3.1.1.2.2" xref="A1.SS2.p6.3.m3.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.1.1.2.1" xref="A1.SS2.p6.3.m3.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.3.m3.1.1.2.3" xref="A1.SS2.p6.3.m3.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.1.1.2.1a" xref="A1.SS2.p6.3.m3.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.3.m3.1.1.2.4" xref="A1.SS2.p6.3.m3.1.1.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.1.1.2.1b" xref="A1.SS2.p6.3.m3.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.3.m3.1.1.2.5" xref="A1.SS2.p6.3.m3.1.1.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.1.1.2.1c" xref="A1.SS2.p6.3.m3.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.3.m3.1.1.2.6" xref="A1.SS2.p6.3.m3.1.1.2.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.1.1.2.1d" xref="A1.SS2.p6.3.m3.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.3.m3.1.1.2.7" xref="A1.SS2.p6.3.m3.1.1.2.7.cmml">e</mi></mrow><mo id="A1.SS2.p6.3.m3.1.1.1" xref="A1.SS2.p6.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS2.p6.3.m3.1.1.3" xref="A1.SS2.p6.3.m3.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.3.m3.1b"><apply id="A1.SS2.p6.3.m3.1.1.cmml" xref="A1.SS2.p6.3.m3.1.1"><eq id="A1.SS2.p6.3.m3.1.1.1.cmml" xref="A1.SS2.p6.3.m3.1.1.1"></eq><apply id="A1.SS2.p6.3.m3.1.1.2.cmml" xref="A1.SS2.p6.3.m3.1.1.2"><times id="A1.SS2.p6.3.m3.1.1.2.1.cmml" xref="A1.SS2.p6.3.m3.1.1.2.1"></times><ci id="A1.SS2.p6.3.m3.1.1.2.2.cmml" xref="A1.SS2.p6.3.m3.1.1.2.2">𝑑</ci><ci id="A1.SS2.p6.3.m3.1.1.2.3.cmml" xref="A1.SS2.p6.3.m3.1.1.2.3">𝑒</ci><ci id="A1.SS2.p6.3.m3.1.1.2.4.cmml" xref="A1.SS2.p6.3.m3.1.1.2.4">𝑔</ci><ci id="A1.SS2.p6.3.m3.1.1.2.5.cmml" xref="A1.SS2.p6.3.m3.1.1.2.5">𝑟</ci><ci id="A1.SS2.p6.3.m3.1.1.2.6.cmml" xref="A1.SS2.p6.3.m3.1.1.2.6">𝑒</ci><ci id="A1.SS2.p6.3.m3.1.1.2.7.cmml" xref="A1.SS2.p6.3.m3.1.1.2.7">𝑒</ci></apply><cn type="float" id="A1.SS2.p6.3.m3.1.1.3.cmml" xref="A1.SS2.p6.3.m3.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.3.m3.1c">degree=0.001</annotation></semantics></math> and Random Gamma <math id="A1.SS2.p6.4.m4.1" class="ltx_Math" alttext="degree=0.9" display="inline"><semantics id="A1.SS2.p6.4.m4.1a"><mrow id="A1.SS2.p6.4.m4.1.1" xref="A1.SS2.p6.4.m4.1.1.cmml"><mrow id="A1.SS2.p6.4.m4.1.1.2" xref="A1.SS2.p6.4.m4.1.1.2.cmml"><mi id="A1.SS2.p6.4.m4.1.1.2.2" xref="A1.SS2.p6.4.m4.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.4.m4.1.1.2.1" xref="A1.SS2.p6.4.m4.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.4.m4.1.1.2.3" xref="A1.SS2.p6.4.m4.1.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.4.m4.1.1.2.1a" xref="A1.SS2.p6.4.m4.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.4.m4.1.1.2.4" xref="A1.SS2.p6.4.m4.1.1.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.4.m4.1.1.2.1b" xref="A1.SS2.p6.4.m4.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.4.m4.1.1.2.5" xref="A1.SS2.p6.4.m4.1.1.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.4.m4.1.1.2.1c" xref="A1.SS2.p6.4.m4.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.4.m4.1.1.2.6" xref="A1.SS2.p6.4.m4.1.1.2.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.4.m4.1.1.2.1d" xref="A1.SS2.p6.4.m4.1.1.2.1.cmml">​</mo><mi id="A1.SS2.p6.4.m4.1.1.2.7" xref="A1.SS2.p6.4.m4.1.1.2.7.cmml">e</mi></mrow><mo id="A1.SS2.p6.4.m4.1.1.1" xref="A1.SS2.p6.4.m4.1.1.1.cmml">=</mo><mn id="A1.SS2.p6.4.m4.1.1.3" xref="A1.SS2.p6.4.m4.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.4.m4.1b"><apply id="A1.SS2.p6.4.m4.1.1.cmml" xref="A1.SS2.p6.4.m4.1.1"><eq id="A1.SS2.p6.4.m4.1.1.1.cmml" xref="A1.SS2.p6.4.m4.1.1.1"></eq><apply id="A1.SS2.p6.4.m4.1.1.2.cmml" xref="A1.SS2.p6.4.m4.1.1.2"><times id="A1.SS2.p6.4.m4.1.1.2.1.cmml" xref="A1.SS2.p6.4.m4.1.1.2.1"></times><ci id="A1.SS2.p6.4.m4.1.1.2.2.cmml" xref="A1.SS2.p6.4.m4.1.1.2.2">𝑑</ci><ci id="A1.SS2.p6.4.m4.1.1.2.3.cmml" xref="A1.SS2.p6.4.m4.1.1.2.3">𝑒</ci><ci id="A1.SS2.p6.4.m4.1.1.2.4.cmml" xref="A1.SS2.p6.4.m4.1.1.2.4">𝑔</ci><ci id="A1.SS2.p6.4.m4.1.1.2.5.cmml" xref="A1.SS2.p6.4.m4.1.1.2.5">𝑟</ci><ci id="A1.SS2.p6.4.m4.1.1.2.6.cmml" xref="A1.SS2.p6.4.m4.1.1.2.6">𝑒</ci><ci id="A1.SS2.p6.4.m4.1.1.2.7.cmml" xref="A1.SS2.p6.4.m4.1.1.2.7">𝑒</ci></apply><cn type="float" id="A1.SS2.p6.4.m4.1.1.3.cmml" xref="A1.SS2.p6.4.m4.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.4.m4.1c">degree=0.9</annotation></semantics></math>.</p>
</div>
<div id="A1.SS2.p7" class="ltx_para ltx_noindent">
<p id="A1.SS2.p7.1" class="ltx_p"></p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.04206" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.04207" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.04207">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.04207" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.04208" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 18:00:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
