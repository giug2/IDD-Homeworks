<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information</title>
<!--Generated on Sun Jun  2 04:22:30 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.00615v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S1" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S2" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related works</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S3" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Dataset</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S3.SS1" title="In 3 Dataset ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Dataset preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S3.SS2" title="In 3 Dataset ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Dataset description</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S3.SS3" title="In 3 Dataset ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Side information</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S4" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Baseline selection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S5" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Baseline implementation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S5.SS1" title="In 5 Baseline implementation ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>RepeatNet</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S5.SS2" title="In 5 Baseline implementation ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Session-based Recommendation with Graph Neural Networks (SR-GNN)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Algorithm description</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6.SS1" title="In 6 Algorithm description ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>General framework to incorporate side information</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6.SS1.SSS1" title="In 6.1 General framework to incorporate side information ‣ 6 Algorithm description ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.1 </span>Side information encoder of RepeatNet</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6.SS1.SSS2" title="In 6.1 General framework to incorporate side information ‣ 6 Algorithm description ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.2 </span>Side information encoder of SR-GNN</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6.SS2" title="In 6 Algorithm description ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Attention loss</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Experimental result</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS1" title="In 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Experiment setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS2" title="In 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Evaluation metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS3" title="In 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3 </span>Evaluating the effect of incorporating side information</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS3.SSS1" title="In 7.3 Evaluating the effect of incorporating side information ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3.1 </span>Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS3.SSS2" title="In 7.3 Evaluating the effect of incorporating side information ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3.2 </span>Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS4" title="In 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4 </span>Evaluating the effect of attention loss</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS4.SSS1" title="In 7.4 Evaluating the effect of attention loss ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4.1 </span>Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS4.SSS2" title="In 7.4 Evaluating the effect of attention loss ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4.2 </span>Analysis</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S8" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S8.SS0.SSS0.Px1" title="In 8 Conclusion ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title">Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S8.SS0.SSS0.Px2" title="In 8 Conclusion ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title">Code</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1" title="In Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1" title="In Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>RepeatNet Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1.SSS1" title="In A.1 RepeatNet Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.1 </span>Session encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1.SSS2" title="In A.1 RepeatNet Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.2 </span>Repeat-or-explore mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1.SSS3" title="In A.1 RepeatNet Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.3 </span>Repeat mode decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1.SSS4" title="In A.1 RepeatNet Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.4 </span>Explore mode decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1.SSS5" title="In A.1 RepeatNet Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1.5 </span>Repeat-explore loss</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2" title="In Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>SR-GNN Architecture</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2.SSS1" title="In A.2 SR-GNN Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Construct session graphs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2.SSS2" title="In A.2 SR-GNN Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.2 </span>Learn item embeddings of session graphs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2.SSS3" title="In A.2 SR-GNN Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.3 </span>Generate session embeddings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2.SSS4" title="In A.2 SR-GNN Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.4 </span>Make recommendations</span></a></li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Making Recommender Systems More Knowledgeable:
A Framework to Incorporate Side Information</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yukun Jiang 
<br class="ltx_break"/>Language Technologies Institute
<br class="ltx_break"/>Carnegie Mellon University 
<br class="ltx_break"/>Pittsburgh, PA 15213 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.1.id1">yukunj@cs.cmu.edu</span>
<br class="ltx_break"/>&amp;Leo Guo
<br class="ltx_break"/>Language Technologies Institute
<br class="ltx_break"/>Carnegie Mellon University
<br class="ltx_break"/>Pittsburgh, PA 15213 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id3.2.id2">jiongtig@cs.cmu.edu 
<br class="ltx_break"/></span>&amp;Xinyi Chen 
<br class="ltx_break"/>Language Technologies Institute 
<br class="ltx_break"/>Carnegie Mellon University
<br class="ltx_break"/>Pittsburgh, PA 15213 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.3.id3">xinyic@cs.cmu.edu</span>
<br class="ltx_break"/>&amp;Jing Xi Liu 
<br class="ltx_break"/>Language Technologies Institute 
<br class="ltx_break"/>Carnegie Mellon University 
<br class="ltx_break"/>Pittsburgh, PA 15213 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id5.4.id4">jingxil@cs.cmu.edu</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.1">Session-based recommender systems typically focus on using only the triplet <math alttext="(user\_id,timestamp,item\_id)" class="ltx_Math" display="inline" id="id1.1.m1.3"><semantics id="id1.1.m1.3a"><mrow id="id1.1.m1.3.3.3" xref="id1.1.m1.3.3.4.cmml"><mo id="id1.1.m1.3.3.3.4" stretchy="false" xref="id1.1.m1.3.3.4.cmml">(</mo><mrow id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml"><mi id="id1.1.m1.1.1.1.1.2" xref="id1.1.m1.1.1.1.1.2.cmml">u</mi><mo id="id1.1.m1.1.1.1.1.1" xref="id1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="id1.1.m1.1.1.1.1.3" xref="id1.1.m1.1.1.1.1.3.cmml">s</mi><mo id="id1.1.m1.1.1.1.1.1a" xref="id1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="id1.1.m1.1.1.1.1.4" xref="id1.1.m1.1.1.1.1.4.cmml">e</mi><mo id="id1.1.m1.1.1.1.1.1b" xref="id1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="id1.1.m1.1.1.1.1.5" xref="id1.1.m1.1.1.1.1.5.cmml">r</mi><mo id="id1.1.m1.1.1.1.1.1c" xref="id1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="id1.1.m1.1.1.1.1.6" mathvariant="normal" xref="id1.1.m1.1.1.1.1.6.cmml">_</mi><mo id="id1.1.m1.1.1.1.1.1d" xref="id1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="id1.1.m1.1.1.1.1.7" xref="id1.1.m1.1.1.1.1.7.cmml">i</mi><mo id="id1.1.m1.1.1.1.1.1e" xref="id1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="id1.1.m1.1.1.1.1.8" xref="id1.1.m1.1.1.1.1.8.cmml">d</mi></mrow><mo id="id1.1.m1.3.3.3.5" xref="id1.1.m1.3.3.4.cmml">,</mo><mrow id="id1.1.m1.2.2.2.2" xref="id1.1.m1.2.2.2.2.cmml"><mi id="id1.1.m1.2.2.2.2.2" xref="id1.1.m1.2.2.2.2.2.cmml">t</mi><mo id="id1.1.m1.2.2.2.2.1" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.3" xref="id1.1.m1.2.2.2.2.3.cmml">i</mi><mo id="id1.1.m1.2.2.2.2.1a" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.4" xref="id1.1.m1.2.2.2.2.4.cmml">m</mi><mo id="id1.1.m1.2.2.2.2.1b" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.5" xref="id1.1.m1.2.2.2.2.5.cmml">e</mi><mo id="id1.1.m1.2.2.2.2.1c" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.6" xref="id1.1.m1.2.2.2.2.6.cmml">s</mi><mo id="id1.1.m1.2.2.2.2.1d" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.7" xref="id1.1.m1.2.2.2.2.7.cmml">t</mi><mo id="id1.1.m1.2.2.2.2.1e" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.8" xref="id1.1.m1.2.2.2.2.8.cmml">a</mi><mo id="id1.1.m1.2.2.2.2.1f" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.9" xref="id1.1.m1.2.2.2.2.9.cmml">m</mi><mo id="id1.1.m1.2.2.2.2.1g" xref="id1.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="id1.1.m1.2.2.2.2.10" xref="id1.1.m1.2.2.2.2.10.cmml">p</mi></mrow><mo id="id1.1.m1.3.3.3.6" xref="id1.1.m1.3.3.4.cmml">,</mo><mrow id="id1.1.m1.3.3.3.3" xref="id1.1.m1.3.3.3.3.cmml"><mi id="id1.1.m1.3.3.3.3.2" xref="id1.1.m1.3.3.3.3.2.cmml">i</mi><mo id="id1.1.m1.3.3.3.3.1" xref="id1.1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="id1.1.m1.3.3.3.3.3" xref="id1.1.m1.3.3.3.3.3.cmml">t</mi><mo id="id1.1.m1.3.3.3.3.1a" xref="id1.1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="id1.1.m1.3.3.3.3.4" xref="id1.1.m1.3.3.3.3.4.cmml">e</mi><mo id="id1.1.m1.3.3.3.3.1b" xref="id1.1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="id1.1.m1.3.3.3.3.5" xref="id1.1.m1.3.3.3.3.5.cmml">m</mi><mo id="id1.1.m1.3.3.3.3.1c" xref="id1.1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="id1.1.m1.3.3.3.3.6" mathvariant="normal" xref="id1.1.m1.3.3.3.3.6.cmml">_</mi><mo id="id1.1.m1.3.3.3.3.1d" xref="id1.1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="id1.1.m1.3.3.3.3.7" xref="id1.1.m1.3.3.3.3.7.cmml">i</mi><mo id="id1.1.m1.3.3.3.3.1e" xref="id1.1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="id1.1.m1.3.3.3.3.8" xref="id1.1.m1.3.3.3.3.8.cmml">d</mi></mrow><mo id="id1.1.m1.3.3.3.7" stretchy="false" xref="id1.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="id1.1.m1.3b"><vector id="id1.1.m1.3.3.4.cmml" xref="id1.1.m1.3.3.3"><apply id="id1.1.m1.1.1.1.1.cmml" xref="id1.1.m1.1.1.1.1"><times id="id1.1.m1.1.1.1.1.1.cmml" xref="id1.1.m1.1.1.1.1.1"></times><ci id="id1.1.m1.1.1.1.1.2.cmml" xref="id1.1.m1.1.1.1.1.2">𝑢</ci><ci id="id1.1.m1.1.1.1.1.3.cmml" xref="id1.1.m1.1.1.1.1.3">𝑠</ci><ci id="id1.1.m1.1.1.1.1.4.cmml" xref="id1.1.m1.1.1.1.1.4">𝑒</ci><ci id="id1.1.m1.1.1.1.1.5.cmml" xref="id1.1.m1.1.1.1.1.5">𝑟</ci><ci id="id1.1.m1.1.1.1.1.6.cmml" xref="id1.1.m1.1.1.1.1.6">_</ci><ci id="id1.1.m1.1.1.1.1.7.cmml" xref="id1.1.m1.1.1.1.1.7">𝑖</ci><ci id="id1.1.m1.1.1.1.1.8.cmml" xref="id1.1.m1.1.1.1.1.8">𝑑</ci></apply><apply id="id1.1.m1.2.2.2.2.cmml" xref="id1.1.m1.2.2.2.2"><times id="id1.1.m1.2.2.2.2.1.cmml" xref="id1.1.m1.2.2.2.2.1"></times><ci id="id1.1.m1.2.2.2.2.2.cmml" xref="id1.1.m1.2.2.2.2.2">𝑡</ci><ci id="id1.1.m1.2.2.2.2.3.cmml" xref="id1.1.m1.2.2.2.2.3">𝑖</ci><ci id="id1.1.m1.2.2.2.2.4.cmml" xref="id1.1.m1.2.2.2.2.4">𝑚</ci><ci id="id1.1.m1.2.2.2.2.5.cmml" xref="id1.1.m1.2.2.2.2.5">𝑒</ci><ci id="id1.1.m1.2.2.2.2.6.cmml" xref="id1.1.m1.2.2.2.2.6">𝑠</ci><ci id="id1.1.m1.2.2.2.2.7.cmml" xref="id1.1.m1.2.2.2.2.7">𝑡</ci><ci id="id1.1.m1.2.2.2.2.8.cmml" xref="id1.1.m1.2.2.2.2.8">𝑎</ci><ci id="id1.1.m1.2.2.2.2.9.cmml" xref="id1.1.m1.2.2.2.2.9">𝑚</ci><ci id="id1.1.m1.2.2.2.2.10.cmml" xref="id1.1.m1.2.2.2.2.10">𝑝</ci></apply><apply id="id1.1.m1.3.3.3.3.cmml" xref="id1.1.m1.3.3.3.3"><times id="id1.1.m1.3.3.3.3.1.cmml" xref="id1.1.m1.3.3.3.3.1"></times><ci id="id1.1.m1.3.3.3.3.2.cmml" xref="id1.1.m1.3.3.3.3.2">𝑖</ci><ci id="id1.1.m1.3.3.3.3.3.cmml" xref="id1.1.m1.3.3.3.3.3">𝑡</ci><ci id="id1.1.m1.3.3.3.3.4.cmml" xref="id1.1.m1.3.3.3.3.4">𝑒</ci><ci id="id1.1.m1.3.3.3.3.5.cmml" xref="id1.1.m1.3.3.3.3.5">𝑚</ci><ci id="id1.1.m1.3.3.3.3.6.cmml" xref="id1.1.m1.3.3.3.3.6">_</ci><ci id="id1.1.m1.3.3.3.3.7.cmml" xref="id1.1.m1.3.3.3.3.7">𝑖</ci><ci id="id1.1.m1.3.3.3.3.8.cmml" xref="id1.1.m1.3.3.3.3.8">𝑑</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.3c">(user\_id,timestamp,item\_id)</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.3d">( italic_u italic_s italic_e italic_r _ italic_i italic_d , italic_t italic_i italic_m italic_e italic_s italic_t italic_a italic_m italic_p , italic_i italic_t italic_e italic_m _ italic_i italic_d )</annotation></semantics></math> to make predictions of users’ next actions. In this paper, we aim to utilize side information to help recommender systems catch patterns and signals otherwise undetectable. Specifically, we propose a general framework for incorporating item-specific side information into the recommender system to enhance its performance without much modification on the original model architecture. Experimental results on several models and datasets prove that with side information, our recommender system outperforms state-of-the-art models by a considerable margin and converges much faster. Additionally, we propose a new type of loss to regularize the attention mechanism used by recommender systems and evaluate its influence on model performance. Furthermore, through analysis, we put forward a few insights on potential further improvements.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The recommender system (RS) has been one of the most successful and profitable AI applications in today’s business. Due to the rapidly increasing flow of information online, companies are capable of making timely and suitable recommendations to their customers, in eager hope of facilitating the deal.
</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, training an accurate recommender system is not an easy task. Literature often finds that, for various reasons, traditional statistical machine learning models like K-Nearest Neighbor (KNN) could outperform deep learning-based models, even if the latter is dominating other fields like computer vision and natural language processing. Some conjecture that it is because people do not fully utilize side information when building the model. In this project, we aim to explore a deep neural network approach to incorporate side information into recommender systems to make them more knowledgeable.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Current methods such as MK-MSR proposed by <cite class="ltx_cite ltx_citemacro_citet">Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib2" title="">2020</a>)</cite> use item attributes, or item knowledge, to obtain side information for modeling the transition pattern between related segments. However, they did not provide any generic approach that could apply to different recommender tasks. This paper aims to establish a general framework that can be adopted by existing models to improve model performance. Experimental results on several models and datasets prove that with side information, our recommender system outperforms state-of-the-art models by a considerable margin and converges much faster. Additionally, we propose a new type of loss to regularize the attention mechanism used by recommender systems and evaluate its influence on models’ performance.
</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The main contributions of this paper can be summarized as the following:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Demonstrate the effectiveness and usefulness of side information in the context of session-based recommender system</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Provide a general framework for incorporating side information into common existing session-based recommender systems</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Exemplify how model performance can be further improved without too much modification on its architecture</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related works</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Traditional recommender systems such as content-based RS and collaborative filtering-based RS often integrate the entire user history to understand each user’s long-term interests in entities. Newer models using the idea of session-based RS with time-sensitive contexts bring more attention to users’ short-term preferences. <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib4" title="">2021</a>)</cite> provided a comprehensive overview of the history and state-of-the-art approaches in session-based recommender systems (SBRS). They distinguished current challenges of SBRS, including recognizing arbitrary interactions within timely sessions, as well as effectively understanding the cascaded long-term sequential correlations that diminish progressively through time. This paper also elucidates inter-session dependencies that span long-range sessions.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">For session-based systems, there has been an abundance of novel attempts in neural network based design. <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> introduced a new neural recommendation architecture called RepeatNet, which exploits the fact that in many scenarios, an item is repeatedly consumed by a user over time. They made the neural network aware of such repeated consumption by a “repeat-or-explore” mechanism built upon a regular recurrent neural network (RNN) recommender system.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Another example is the session-based recommendation with graph neural networks (SR-GNN) proposed by <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib5" title="">2019</a>)</cite>. SR-GNN aims to generate precise item embeddings while taking complex transitions of items into account, where sessions will be modeled as graph structures and items will be modeled as nodes, allowing automatic extraction of features with respect to node connections. SR-GNN presents another method for combining the short-term interests and long-term preferences of users. The model does not assume any distinct latent representation of users, instead, it uses embedding of items in each session to compute short-term and long-term session interests. To combat the inconsistent information priority for each session, a soft-attention mechanism is used to prioritize different interests when calculating the embedding vector representing long-term interest of the session. It then uses session embedding containing long-term interest and short-term interest to generate recommendations.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Side information has also been explored in previous research. In the paper of <cite class="ltx_cite ltx_citemacro_citet">Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib2" title="">2020</a>)</cite>, they made attempts to utilize side information as users’ operation, such as reading the comments and adding items to the cart. They incorporated this item knowledge into a multi-task learning paradigm, jointly modeling items and users’ micro-behaviors. They defined each micro-behavior as a combination of items and their corresponding operation. By constructing the embedding for both users’ and items’ side information, their recommender system achieved a remarkable performance boost.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Dataset</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Our experiments are based on four main datasets: an e-commerce transaction dataset Diginetica, a user-based music history dataset Last.FM, a movie rating dataset MovieLens, and a grocery store transaction dataset Ta Feng.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Dataset preprocessing</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We apply the following preprocessing steps on each of the datasets to generate train and test sets for further experiments. The specific choice of values are mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S3.SS2" title="3.2 Dataset description ‣ 3 Dataset ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.ix1.p1">
<p class="ltx_p" id="S3.I1.ix1.p1.1">We choose the training target, e.g. item ID, of which we analyze the patterns and make predictions. We also select the side information, e.g. category or subclass ID, which we utilize to improve our model performance.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.ix2.p1">
<p class="ltx_p" id="S3.I1.ix2.p1.1">We split data into user-based sessions. The session length varies for different datasets. If the dataset is tested in our baseline models, we follow the same choice of session length. Data within a session spans less than a set duration, e.g. 8 hours or 2 weeks, which varies in different datasets. In addition, we filter out sessions with lengths smaller than 2. We further split sessions if they are longer than the session length.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I1.ix3.p1">
<p class="ltx_p" id="S3.I1.ix3.p1.1">We shuffle the dataset and split the session dataset into train and test sets.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S3.I1.ix4.p1">
<p class="ltx_p" id="S3.I1.ix4.p1.6">For a session like <math alttext="[x_{1},x_{2},x_{3},\dots,x_{n}]" class="ltx_Math" display="inline" id="S3.I1.ix4.p1.1.m1.5"><semantics id="S3.I1.ix4.p1.1.m1.5a"><mrow id="S3.I1.ix4.p1.1.m1.5.5.4" xref="S3.I1.ix4.p1.1.m1.5.5.5.cmml"><mo id="S3.I1.ix4.p1.1.m1.5.5.4.5" stretchy="false" xref="S3.I1.ix4.p1.1.m1.5.5.5.cmml">[</mo><msub id="S3.I1.ix4.p1.1.m1.2.2.1.1" xref="S3.I1.ix4.p1.1.m1.2.2.1.1.cmml"><mi id="S3.I1.ix4.p1.1.m1.2.2.1.1.2" xref="S3.I1.ix4.p1.1.m1.2.2.1.1.2.cmml">x</mi><mn id="S3.I1.ix4.p1.1.m1.2.2.1.1.3" xref="S3.I1.ix4.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.I1.ix4.p1.1.m1.5.5.4.6" xref="S3.I1.ix4.p1.1.m1.5.5.5.cmml">,</mo><msub id="S3.I1.ix4.p1.1.m1.3.3.2.2" xref="S3.I1.ix4.p1.1.m1.3.3.2.2.cmml"><mi id="S3.I1.ix4.p1.1.m1.3.3.2.2.2" xref="S3.I1.ix4.p1.1.m1.3.3.2.2.2.cmml">x</mi><mn id="S3.I1.ix4.p1.1.m1.3.3.2.2.3" xref="S3.I1.ix4.p1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.I1.ix4.p1.1.m1.5.5.4.7" xref="S3.I1.ix4.p1.1.m1.5.5.5.cmml">,</mo><msub id="S3.I1.ix4.p1.1.m1.4.4.3.3" xref="S3.I1.ix4.p1.1.m1.4.4.3.3.cmml"><mi id="S3.I1.ix4.p1.1.m1.4.4.3.3.2" xref="S3.I1.ix4.p1.1.m1.4.4.3.3.2.cmml">x</mi><mn id="S3.I1.ix4.p1.1.m1.4.4.3.3.3" xref="S3.I1.ix4.p1.1.m1.4.4.3.3.3.cmml">3</mn></msub><mo id="S3.I1.ix4.p1.1.m1.5.5.4.8" xref="S3.I1.ix4.p1.1.m1.5.5.5.cmml">,</mo><mi id="S3.I1.ix4.p1.1.m1.1.1" mathvariant="normal" xref="S3.I1.ix4.p1.1.m1.1.1.cmml">…</mi><mo id="S3.I1.ix4.p1.1.m1.5.5.4.9" xref="S3.I1.ix4.p1.1.m1.5.5.5.cmml">,</mo><msub id="S3.I1.ix4.p1.1.m1.5.5.4.4" xref="S3.I1.ix4.p1.1.m1.5.5.4.4.cmml"><mi id="S3.I1.ix4.p1.1.m1.5.5.4.4.2" xref="S3.I1.ix4.p1.1.m1.5.5.4.4.2.cmml">x</mi><mi id="S3.I1.ix4.p1.1.m1.5.5.4.4.3" xref="S3.I1.ix4.p1.1.m1.5.5.4.4.3.cmml">n</mi></msub><mo id="S3.I1.ix4.p1.1.m1.5.5.4.10" stretchy="false" xref="S3.I1.ix4.p1.1.m1.5.5.5.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix4.p1.1.m1.5b"><list id="S3.I1.ix4.p1.1.m1.5.5.5.cmml" xref="S3.I1.ix4.p1.1.m1.5.5.4"><apply id="S3.I1.ix4.p1.1.m1.2.2.1.1.cmml" xref="S3.I1.ix4.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.1.m1.2.2.1.1.1.cmml" xref="S3.I1.ix4.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.I1.ix4.p1.1.m1.2.2.1.1.2.cmml" xref="S3.I1.ix4.p1.1.m1.2.2.1.1.2">𝑥</ci><cn id="S3.I1.ix4.p1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S3.I1.ix4.p1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.I1.ix4.p1.1.m1.3.3.2.2.cmml" xref="S3.I1.ix4.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.1.m1.3.3.2.2.1.cmml" xref="S3.I1.ix4.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.I1.ix4.p1.1.m1.3.3.2.2.2.cmml" xref="S3.I1.ix4.p1.1.m1.3.3.2.2.2">𝑥</ci><cn id="S3.I1.ix4.p1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S3.I1.ix4.p1.1.m1.3.3.2.2.3">2</cn></apply><apply id="S3.I1.ix4.p1.1.m1.4.4.3.3.cmml" xref="S3.I1.ix4.p1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.1.m1.4.4.3.3.1.cmml" xref="S3.I1.ix4.p1.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.I1.ix4.p1.1.m1.4.4.3.3.2.cmml" xref="S3.I1.ix4.p1.1.m1.4.4.3.3.2">𝑥</ci><cn id="S3.I1.ix4.p1.1.m1.4.4.3.3.3.cmml" type="integer" xref="S3.I1.ix4.p1.1.m1.4.4.3.3.3">3</cn></apply><ci id="S3.I1.ix4.p1.1.m1.1.1.cmml" xref="S3.I1.ix4.p1.1.m1.1.1">…</ci><apply id="S3.I1.ix4.p1.1.m1.5.5.4.4.cmml" xref="S3.I1.ix4.p1.1.m1.5.5.4.4"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.1.m1.5.5.4.4.1.cmml" xref="S3.I1.ix4.p1.1.m1.5.5.4.4">subscript</csymbol><ci id="S3.I1.ix4.p1.1.m1.5.5.4.4.2.cmml" xref="S3.I1.ix4.p1.1.m1.5.5.4.4.2">𝑥</ci><ci id="S3.I1.ix4.p1.1.m1.5.5.4.4.3.cmml" xref="S3.I1.ix4.p1.1.m1.5.5.4.4.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix4.p1.1.m1.5c">[x_{1},x_{2},x_{3},\dots,x_{n}]</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix4.p1.1.m1.5d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math>, we generate it into <math alttext="n-1" class="ltx_Math" display="inline" id="S3.I1.ix4.p1.2.m2.1"><semantics id="S3.I1.ix4.p1.2.m2.1a"><mrow id="S3.I1.ix4.p1.2.m2.1.1" xref="S3.I1.ix4.p1.2.m2.1.1.cmml"><mi id="S3.I1.ix4.p1.2.m2.1.1.2" xref="S3.I1.ix4.p1.2.m2.1.1.2.cmml">n</mi><mo id="S3.I1.ix4.p1.2.m2.1.1.1" xref="S3.I1.ix4.p1.2.m2.1.1.1.cmml">−</mo><mn id="S3.I1.ix4.p1.2.m2.1.1.3" xref="S3.I1.ix4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix4.p1.2.m2.1b"><apply id="S3.I1.ix4.p1.2.m2.1.1.cmml" xref="S3.I1.ix4.p1.2.m2.1.1"><minus id="S3.I1.ix4.p1.2.m2.1.1.1.cmml" xref="S3.I1.ix4.p1.2.m2.1.1.1"></minus><ci id="S3.I1.ix4.p1.2.m2.1.1.2.cmml" xref="S3.I1.ix4.p1.2.m2.1.1.2">𝑛</ci><cn id="S3.I1.ix4.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.I1.ix4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix4.p1.2.m2.1c">n-1</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix4.p1.2.m2.1d">italic_n - 1</annotation></semantics></math> lines of data, having <math alttext="[x_{1},x_{2},\dots,x_{i},0,0,\dots,0]" class="ltx_Math" display="inline" id="S3.I1.ix4.p1.3.m3.8"><semantics id="S3.I1.ix4.p1.3.m3.8a"><mrow id="S3.I1.ix4.p1.3.m3.8.8.3" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml"><mo id="S3.I1.ix4.p1.3.m3.8.8.3.4" stretchy="false" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">[</mo><msub id="S3.I1.ix4.p1.3.m3.6.6.1.1" xref="S3.I1.ix4.p1.3.m3.6.6.1.1.cmml"><mi id="S3.I1.ix4.p1.3.m3.6.6.1.1.2" xref="S3.I1.ix4.p1.3.m3.6.6.1.1.2.cmml">x</mi><mn id="S3.I1.ix4.p1.3.m3.6.6.1.1.3" xref="S3.I1.ix4.p1.3.m3.6.6.1.1.3.cmml">1</mn></msub><mo id="S3.I1.ix4.p1.3.m3.8.8.3.5" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">,</mo><msub id="S3.I1.ix4.p1.3.m3.7.7.2.2" xref="S3.I1.ix4.p1.3.m3.7.7.2.2.cmml"><mi id="S3.I1.ix4.p1.3.m3.7.7.2.2.2" xref="S3.I1.ix4.p1.3.m3.7.7.2.2.2.cmml">x</mi><mn id="S3.I1.ix4.p1.3.m3.7.7.2.2.3" xref="S3.I1.ix4.p1.3.m3.7.7.2.2.3.cmml">2</mn></msub><mo id="S3.I1.ix4.p1.3.m3.8.8.3.6" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">,</mo><mi id="S3.I1.ix4.p1.3.m3.1.1" mathvariant="normal" xref="S3.I1.ix4.p1.3.m3.1.1.cmml">…</mi><mo id="S3.I1.ix4.p1.3.m3.8.8.3.7" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">,</mo><msub id="S3.I1.ix4.p1.3.m3.8.8.3.3" xref="S3.I1.ix4.p1.3.m3.8.8.3.3.cmml"><mi id="S3.I1.ix4.p1.3.m3.8.8.3.3.2" xref="S3.I1.ix4.p1.3.m3.8.8.3.3.2.cmml">x</mi><mi id="S3.I1.ix4.p1.3.m3.8.8.3.3.3" xref="S3.I1.ix4.p1.3.m3.8.8.3.3.3.cmml">i</mi></msub><mo id="S3.I1.ix4.p1.3.m3.8.8.3.8" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">,</mo><mn id="S3.I1.ix4.p1.3.m3.2.2" xref="S3.I1.ix4.p1.3.m3.2.2.cmml">0</mn><mo id="S3.I1.ix4.p1.3.m3.8.8.3.9" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">,</mo><mn id="S3.I1.ix4.p1.3.m3.3.3" xref="S3.I1.ix4.p1.3.m3.3.3.cmml">0</mn><mo id="S3.I1.ix4.p1.3.m3.8.8.3.10" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">,</mo><mi id="S3.I1.ix4.p1.3.m3.4.4" mathvariant="normal" xref="S3.I1.ix4.p1.3.m3.4.4.cmml">…</mi><mo id="S3.I1.ix4.p1.3.m3.8.8.3.11" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">,</mo><mn id="S3.I1.ix4.p1.3.m3.5.5" xref="S3.I1.ix4.p1.3.m3.5.5.cmml">0</mn><mo id="S3.I1.ix4.p1.3.m3.8.8.3.12" stretchy="false" xref="S3.I1.ix4.p1.3.m3.8.8.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix4.p1.3.m3.8b"><list id="S3.I1.ix4.p1.3.m3.8.8.4.cmml" xref="S3.I1.ix4.p1.3.m3.8.8.3"><apply id="S3.I1.ix4.p1.3.m3.6.6.1.1.cmml" xref="S3.I1.ix4.p1.3.m3.6.6.1.1"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.3.m3.6.6.1.1.1.cmml" xref="S3.I1.ix4.p1.3.m3.6.6.1.1">subscript</csymbol><ci id="S3.I1.ix4.p1.3.m3.6.6.1.1.2.cmml" xref="S3.I1.ix4.p1.3.m3.6.6.1.1.2">𝑥</ci><cn id="S3.I1.ix4.p1.3.m3.6.6.1.1.3.cmml" type="integer" xref="S3.I1.ix4.p1.3.m3.6.6.1.1.3">1</cn></apply><apply id="S3.I1.ix4.p1.3.m3.7.7.2.2.cmml" xref="S3.I1.ix4.p1.3.m3.7.7.2.2"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.3.m3.7.7.2.2.1.cmml" xref="S3.I1.ix4.p1.3.m3.7.7.2.2">subscript</csymbol><ci id="S3.I1.ix4.p1.3.m3.7.7.2.2.2.cmml" xref="S3.I1.ix4.p1.3.m3.7.7.2.2.2">𝑥</ci><cn id="S3.I1.ix4.p1.3.m3.7.7.2.2.3.cmml" type="integer" xref="S3.I1.ix4.p1.3.m3.7.7.2.2.3">2</cn></apply><ci id="S3.I1.ix4.p1.3.m3.1.1.cmml" xref="S3.I1.ix4.p1.3.m3.1.1">…</ci><apply id="S3.I1.ix4.p1.3.m3.8.8.3.3.cmml" xref="S3.I1.ix4.p1.3.m3.8.8.3.3"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.3.m3.8.8.3.3.1.cmml" xref="S3.I1.ix4.p1.3.m3.8.8.3.3">subscript</csymbol><ci id="S3.I1.ix4.p1.3.m3.8.8.3.3.2.cmml" xref="S3.I1.ix4.p1.3.m3.8.8.3.3.2">𝑥</ci><ci id="S3.I1.ix4.p1.3.m3.8.8.3.3.3.cmml" xref="S3.I1.ix4.p1.3.m3.8.8.3.3.3">𝑖</ci></apply><cn id="S3.I1.ix4.p1.3.m3.2.2.cmml" type="integer" xref="S3.I1.ix4.p1.3.m3.2.2">0</cn><cn id="S3.I1.ix4.p1.3.m3.3.3.cmml" type="integer" xref="S3.I1.ix4.p1.3.m3.3.3">0</cn><ci id="S3.I1.ix4.p1.3.m3.4.4.cmml" xref="S3.I1.ix4.p1.3.m3.4.4">…</ci><cn id="S3.I1.ix4.p1.3.m3.5.5.cmml" type="integer" xref="S3.I1.ix4.p1.3.m3.5.5">0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix4.p1.3.m3.8c">[x_{1},x_{2},\dots,x_{i},0,0,\dots,0]</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix4.p1.3.m3.8d">[ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , 0 , 0 , … , 0 ]</annotation></semantics></math> being the input and <math alttext="[x_{i+1}]" class="ltx_Math" display="inline" id="S3.I1.ix4.p1.4.m4.1"><semantics id="S3.I1.ix4.p1.4.m4.1a"><mrow id="S3.I1.ix4.p1.4.m4.1.1.1" xref="S3.I1.ix4.p1.4.m4.1.1.2.cmml"><mo id="S3.I1.ix4.p1.4.m4.1.1.1.2" stretchy="false" xref="S3.I1.ix4.p1.4.m4.1.1.2.1.cmml">[</mo><msub id="S3.I1.ix4.p1.4.m4.1.1.1.1" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.cmml"><mi id="S3.I1.ix4.p1.4.m4.1.1.1.1.2" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.2.cmml">x</mi><mrow id="S3.I1.ix4.p1.4.m4.1.1.1.1.3" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3.cmml"><mi id="S3.I1.ix4.p1.4.m4.1.1.1.1.3.2" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3.2.cmml">i</mi><mo id="S3.I1.ix4.p1.4.m4.1.1.1.1.3.1" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3.1.cmml">+</mo><mn id="S3.I1.ix4.p1.4.m4.1.1.1.1.3.3" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.I1.ix4.p1.4.m4.1.1.1.3" stretchy="false" xref="S3.I1.ix4.p1.4.m4.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix4.p1.4.m4.1b"><apply id="S3.I1.ix4.p1.4.m4.1.1.2.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1"><csymbol cd="latexml" id="S3.I1.ix4.p1.4.m4.1.1.2.1.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1.2">delimited-[]</csymbol><apply id="S3.I1.ix4.p1.4.m4.1.1.1.1.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.I1.ix4.p1.4.m4.1.1.1.1.1.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.I1.ix4.p1.4.m4.1.1.1.1.2.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.2">𝑥</ci><apply id="S3.I1.ix4.p1.4.m4.1.1.1.1.3.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3"><plus id="S3.I1.ix4.p1.4.m4.1.1.1.1.3.1.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3.1"></plus><ci id="S3.I1.ix4.p1.4.m4.1.1.1.1.3.2.cmml" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3.2">𝑖</ci><cn id="S3.I1.ix4.p1.4.m4.1.1.1.1.3.3.cmml" type="integer" xref="S3.I1.ix4.p1.4.m4.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix4.p1.4.m4.1c">[x_{i+1}]</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix4.p1.4.m4.1d">[ italic_x start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> being the target output, for <math alttext="i\in\{1,\dots,n-1\}" class="ltx_Math" display="inline" id="S3.I1.ix4.p1.5.m5.3"><semantics id="S3.I1.ix4.p1.5.m5.3a"><mrow id="S3.I1.ix4.p1.5.m5.3.3" xref="S3.I1.ix4.p1.5.m5.3.3.cmml"><mi id="S3.I1.ix4.p1.5.m5.3.3.3" xref="S3.I1.ix4.p1.5.m5.3.3.3.cmml">i</mi><mo id="S3.I1.ix4.p1.5.m5.3.3.2" xref="S3.I1.ix4.p1.5.m5.3.3.2.cmml">∈</mo><mrow id="S3.I1.ix4.p1.5.m5.3.3.1.1" xref="S3.I1.ix4.p1.5.m5.3.3.1.2.cmml"><mo id="S3.I1.ix4.p1.5.m5.3.3.1.1.2" stretchy="false" xref="S3.I1.ix4.p1.5.m5.3.3.1.2.cmml">{</mo><mn id="S3.I1.ix4.p1.5.m5.1.1" xref="S3.I1.ix4.p1.5.m5.1.1.cmml">1</mn><mo id="S3.I1.ix4.p1.5.m5.3.3.1.1.3" xref="S3.I1.ix4.p1.5.m5.3.3.1.2.cmml">,</mo><mi id="S3.I1.ix4.p1.5.m5.2.2" mathvariant="normal" xref="S3.I1.ix4.p1.5.m5.2.2.cmml">…</mi><mo id="S3.I1.ix4.p1.5.m5.3.3.1.1.4" xref="S3.I1.ix4.p1.5.m5.3.3.1.2.cmml">,</mo><mrow id="S3.I1.ix4.p1.5.m5.3.3.1.1.1" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.I1.ix4.p1.5.m5.3.3.1.1.1.2" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1.2.cmml">n</mi><mo id="S3.I1.ix4.p1.5.m5.3.3.1.1.1.1" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1.1.cmml">−</mo><mn id="S3.I1.ix4.p1.5.m5.3.3.1.1.1.3" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.I1.ix4.p1.5.m5.3.3.1.1.5" stretchy="false" xref="S3.I1.ix4.p1.5.m5.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.ix4.p1.5.m5.3b"><apply id="S3.I1.ix4.p1.5.m5.3.3.cmml" xref="S3.I1.ix4.p1.5.m5.3.3"><in id="S3.I1.ix4.p1.5.m5.3.3.2.cmml" xref="S3.I1.ix4.p1.5.m5.3.3.2"></in><ci id="S3.I1.ix4.p1.5.m5.3.3.3.cmml" xref="S3.I1.ix4.p1.5.m5.3.3.3">𝑖</ci><set id="S3.I1.ix4.p1.5.m5.3.3.1.2.cmml" xref="S3.I1.ix4.p1.5.m5.3.3.1.1"><cn id="S3.I1.ix4.p1.5.m5.1.1.cmml" type="integer" xref="S3.I1.ix4.p1.5.m5.1.1">1</cn><ci id="S3.I1.ix4.p1.5.m5.2.2.cmml" xref="S3.I1.ix4.p1.5.m5.2.2">…</ci><apply id="S3.I1.ix4.p1.5.m5.3.3.1.1.1.cmml" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1"><minus id="S3.I1.ix4.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1.1"></minus><ci id="S3.I1.ix4.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1.2">𝑛</ci><cn id="S3.I1.ix4.p1.5.m5.3.3.1.1.1.3.cmml" type="integer" xref="S3.I1.ix4.p1.5.m5.3.3.1.1.1.3">1</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix4.p1.5.m5.3c">i\in\{1,\dots,n-1\}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix4.p1.5.m5.3d">italic_i ∈ { 1 , … , italic_n - 1 }</annotation></semantics></math>. The length of each input is the predefined session length, and we pad zeros after the <math alttext="i" class="ltx_Math" display="inline" id="S3.I1.ix4.p1.6.m6.1"><semantics id="S3.I1.ix4.p1.6.m6.1a"><mi id="S3.I1.ix4.p1.6.m6.1.1" xref="S3.I1.ix4.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.I1.ix4.p1.6.m6.1b"><ci id="S3.I1.ix4.p1.6.m6.1.1.cmml" xref="S3.I1.ix4.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.ix4.p1.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.I1.ix4.p1.6.m6.1d">italic_i</annotation></semantics></math>-th item. That is to say, the data are generated in the way that given the preceding information within a session, we aim to predict the next item in that session.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S3.I1.ix5.p1">
<p class="ltx_p" id="S3.I1.ix5.p1.1">To utilize the side information, we create a mapping of item ID to its side information, e.g. category ID. For each line of the train/test data, we substitute the original item ID into its side information, e.g. category ID, to obtain a complementary dataset.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Dataset description</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.1">Diginetica<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://competitions.codalab.org/competitions/11161#learn_the_details-data2" title="">https://competitions.codalab.org/competitions/11161#learn_the_details-data2</a></span></span></span></span> This dataset contains user session data extracted from an e-commerce search engine logs that can be used to build session-based recommender systems. We use the same script as that of RepeatNet to preprocess Diginetica in order to replicate the baseline results. In addition to the preprocessing steps mentioned above, we also filter out items that appear less than 5 times. <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> evaluated RepeatNet’s performance on this dataset. However, the RepeatNet model only used basic information like timestamp and product ID to make predictions. We incorporate side information like the category of the product to improve the performance of RepeatNet.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Last.FM<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="http://ocelma.net/MusicRecommendationDataset/lastfm-360K.html" title="">http://ocelma.net/MusicRecommendationDataset/lastfm-360K.html</a></span></span></span></span> This dataset contains &lt;user, timestamp, artist, song&gt; tuples collected from Last.FM API, which represents the whole listening habits of nearly 1,000 users. For the preprocessing, we select artist ID as the training target and set the session length to be 50, while the session duration is 8 hours. <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> evaluated RepeatNet’s performance on this dataset. This dataset is only used for baseline since it does not contain enough side information.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">MovieLens<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote3.1.1.1">3</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://grouplens.org/datasets/movielens/" title="">https://grouplens.org/datasets/movielens/</a></span></span></span></span> This dataset is a popular movie rating dataset, and the commonly used features are user ID, item ID, timestamp, and rating. For the preprocessing, we select movie ID as the training target and set the session length to be 50, while the session duration is one day. In addition to the preprocessing steps mentioned above, we also filter out items that appear less than 5 times. The MovieLens dataset also contains features like genres of movies, which can be used to train embeddings for movies. We believe such embeddings can be informative and are able to boost the performance of recommender system models.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.1.1">Ta Feng<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote4.1.1.1">4</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://www.kaggle.com/chiranjivdas09/ta-feng-grocery-dataset" title="">https://www.kaggle.com/chiranjivdas09/ta-feng-grocery-dataset</a></span></span></span></span> This dataset contains transaction data from a Chinese grocery store. Ta Feng includes features such as transaction_date, customer_id, product_id, product_subclass, etc. For the preprocessing, we select product ID as the training target and set the session length to be 40, while the session duration is 2 weeks. For Ta Feng, we use product subclass as side information to improve the performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Side information</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The choice of side information is highly relevant to the effectiveness of the extended model. As most recommender system related datasets contain very few extra information other than item ID, timestamp, and user ID, the most common and accessible side information is often tags or subclass information. In this paper, we only experimented with side information being categorical values, and they represent the higher subclass or category of the targets.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Baseline selection</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We plan to extend the aforementioned deep learning model, the RepeatNet <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite>, and incorporate side information into the current recommender system settings. Therefore, we select RepeatNet as one of our baseline models. We performed modification on the preprocessing part of the original RepeatNet provided by <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> and run the experiments to replicate the results presented in the paper and compare its performance to our extended model.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">In addition to RepeatNet, we also apply the side information framework to the session-based recommendation with graph neural networks (SR-GNN) proposed by <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib5" title="">2019</a>)</cite> and select SR-GNN as one of our baseline models. The reason is that SR-GNN used Graph Neural Network as encoder, and we want to confirm that our proposed framework works well on various kinds of architecture.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Baseline implementation</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We run experiments on the four selected datasets using both RepeatNet and SR-GNN.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>RepeatNet</h3>
<figure class="ltx_figure" id="S5.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="217" id="S5.F1.g1" src="extracted/5637323/RepeatNet.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>RepeatNet model. This picture is taken from the RepeatNet paper. <math alttext="\forall j\in\{1,\cdots,t\},i_{j}" class="ltx_Math" display="inline" id="S5.F1.5.m1.5"><semantics id="S5.F1.5.m1.5b"><mrow id="S5.F1.5.m1.5.5" xref="S5.F1.5.m1.5.5.cmml"><mrow id="S5.F1.5.m1.5.5.4" xref="S5.F1.5.m1.5.5.4.cmml"><mo id="S5.F1.5.m1.5.5.4.1" rspace="0.167em" xref="S5.F1.5.m1.5.5.4.1.cmml">∀</mo><mi id="S5.F1.5.m1.5.5.4.2" xref="S5.F1.5.m1.5.5.4.2.cmml">j</mi></mrow><mo id="S5.F1.5.m1.5.5.3" xref="S5.F1.5.m1.5.5.3.cmml">∈</mo><mrow id="S5.F1.5.m1.5.5.2.2" xref="S5.F1.5.m1.5.5.2.3.cmml"><mrow id="S5.F1.5.m1.4.4.1.1.1.2" xref="S5.F1.5.m1.4.4.1.1.1.1.cmml"><mo id="S5.F1.5.m1.4.4.1.1.1.2.1" stretchy="false" xref="S5.F1.5.m1.4.4.1.1.1.1.cmml">{</mo><mn id="S5.F1.5.m1.1.1" xref="S5.F1.5.m1.1.1.cmml">1</mn><mo id="S5.F1.5.m1.4.4.1.1.1.2.2" xref="S5.F1.5.m1.4.4.1.1.1.1.cmml">,</mo><mi id="S5.F1.5.m1.2.2" mathvariant="normal" xref="S5.F1.5.m1.2.2.cmml">⋯</mi><mo id="S5.F1.5.m1.4.4.1.1.1.2.3" xref="S5.F1.5.m1.4.4.1.1.1.1.cmml">,</mo><mi id="S5.F1.5.m1.3.3" xref="S5.F1.5.m1.3.3.cmml">t</mi><mo id="S5.F1.5.m1.4.4.1.1.1.2.4" stretchy="false" xref="S5.F1.5.m1.4.4.1.1.1.1.cmml">}</mo></mrow><mo id="S5.F1.5.m1.5.5.2.2.3" xref="S5.F1.5.m1.5.5.2.3.cmml">,</mo><msub id="S5.F1.5.m1.5.5.2.2.2" xref="S5.F1.5.m1.5.5.2.2.2.cmml"><mi id="S5.F1.5.m1.5.5.2.2.2.2" xref="S5.F1.5.m1.5.5.2.2.2.2.cmml">i</mi><mi id="S5.F1.5.m1.5.5.2.2.2.3" xref="S5.F1.5.m1.5.5.2.2.2.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.F1.5.m1.5c"><apply id="S5.F1.5.m1.5.5.cmml" xref="S5.F1.5.m1.5.5"><in id="S5.F1.5.m1.5.5.3.cmml" xref="S5.F1.5.m1.5.5.3"></in><apply id="S5.F1.5.m1.5.5.4.cmml" xref="S5.F1.5.m1.5.5.4"><csymbol cd="latexml" id="S5.F1.5.m1.5.5.4.1.cmml" xref="S5.F1.5.m1.5.5.4.1">for-all</csymbol><ci id="S5.F1.5.m1.5.5.4.2.cmml" xref="S5.F1.5.m1.5.5.4.2">𝑗</ci></apply><list id="S5.F1.5.m1.5.5.2.3.cmml" xref="S5.F1.5.m1.5.5.2.2"><set id="S5.F1.5.m1.4.4.1.1.1.1.cmml" xref="S5.F1.5.m1.4.4.1.1.1.2"><cn id="S5.F1.5.m1.1.1.cmml" type="integer" xref="S5.F1.5.m1.1.1">1</cn><ci id="S5.F1.5.m1.2.2.cmml" xref="S5.F1.5.m1.2.2">⋯</ci><ci id="S5.F1.5.m1.3.3.cmml" xref="S5.F1.5.m1.3.3">𝑡</ci></set><apply id="S5.F1.5.m1.5.5.2.2.2.cmml" xref="S5.F1.5.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S5.F1.5.m1.5.5.2.2.2.1.cmml" xref="S5.F1.5.m1.5.5.2.2.2">subscript</csymbol><ci id="S5.F1.5.m1.5.5.2.2.2.2.cmml" xref="S5.F1.5.m1.5.5.2.2.2.2">𝑖</ci><ci id="S5.F1.5.m1.5.5.2.2.2.3.cmml" xref="S5.F1.5.m1.5.5.2.2.2.3">𝑗</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.5.m1.5d">\forall j\in\{1,\cdots,t\},i_{j}</annotation><annotation encoding="application/x-llamapun" id="S5.F1.5.m1.5e">∀ italic_j ∈ { 1 , ⋯ , italic_t } , italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the item at timestamp <math alttext="j" class="ltx_Math" display="inline" id="S5.F1.6.m2.1"><semantics id="S5.F1.6.m2.1b"><mi id="S5.F1.6.m2.1.1" xref="S5.F1.6.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.F1.6.m2.1c"><ci id="S5.F1.6.m2.1.1.cmml" xref="S5.F1.6.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.6.m2.1d">j</annotation><annotation encoding="application/x-llamapun" id="S5.F1.6.m2.1e">italic_j</annotation></semantics></math>, and <math alttext="h_{j}" class="ltx_Math" display="inline" id="S5.F1.7.m3.1"><semantics id="S5.F1.7.m3.1b"><msub id="S5.F1.7.m3.1.1" xref="S5.F1.7.m3.1.1.cmml"><mi id="S5.F1.7.m3.1.1.2" xref="S5.F1.7.m3.1.1.2.cmml">h</mi><mi id="S5.F1.7.m3.1.1.3" xref="S5.F1.7.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F1.7.m3.1c"><apply id="S5.F1.7.m3.1.1.cmml" xref="S5.F1.7.m3.1.1"><csymbol cd="ambiguous" id="S5.F1.7.m3.1.1.1.cmml" xref="S5.F1.7.m3.1.1">subscript</csymbol><ci id="S5.F1.7.m3.1.1.2.cmml" xref="S5.F1.7.m3.1.1.2">ℎ</ci><ci id="S5.F1.7.m3.1.1.3.cmml" xref="S5.F1.7.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.7.m3.1d">h_{j}</annotation><annotation encoding="application/x-llamapun" id="S5.F1.7.m3.1e">italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the embedding vector of <math alttext="i_{j}" class="ltx_Math" display="inline" id="S5.F1.8.m4.1"><semantics id="S5.F1.8.m4.1b"><msub id="S5.F1.8.m4.1.1" xref="S5.F1.8.m4.1.1.cmml"><mi id="S5.F1.8.m4.1.1.2" xref="S5.F1.8.m4.1.1.2.cmml">i</mi><mi id="S5.F1.8.m4.1.1.3" xref="S5.F1.8.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F1.8.m4.1c"><apply id="S5.F1.8.m4.1.1.cmml" xref="S5.F1.8.m4.1.1"><csymbol cd="ambiguous" id="S5.F1.8.m4.1.1.1.cmml" xref="S5.F1.8.m4.1.1">subscript</csymbol><ci id="S5.F1.8.m4.1.1.2.cmml" xref="S5.F1.8.m4.1.1.2">𝑖</ci><ci id="S5.F1.8.m4.1.1.3.cmml" xref="S5.F1.8.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F1.8.m4.1d">i_{j}</annotation><annotation encoding="application/x-llamapun" id="S5.F1.8.m4.1e">italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> extracted from a GRU that handles items</figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Among the four datasets, Diginetica and Last.FM are tested by <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> in the RepeatNet paper. Explanations on the original structure of RepeatNet can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1" title="A.1 RepeatNet Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">A.1</span></a>. A detailed model description of the extended RepeatNet is presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6.F3" title="Figure 3 ‣ 6.1.1 Side information encoder of RepeatNet ‣ 6.1 General framework to incorporate side information ‣ 6 Algorithm description ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">3</span></a>. We did not simply implement the original RepeatNet architecture. Instead, we modified RepeatNet’s explore mode decoder such that the score of each item is computed from the dot product between the item embedding and the vector representing the entire session. In that way, we will be able to incorporate side information when calculating score for each item in our experiments evaluating the effectiveness of side information. As a starting point, we are able to replicate and verify the result of RepeatNet on Last.FM. This means that our modification doesn’t negatively influence RepeatNet’s behavior. We did not try to replicate the result of RepeatNet on Diginetica, since <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> used an incorrect method to preprocess Diginetica, as they did not sort items in each session according to timestamp. The result is shown below in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S5.T1" title="Table 1 ‣ 5.1 RepeatNet ‣ 5 Baseline implementation ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.1.1.1.1">Dataset: Last.FM</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.2.1">RepeatNet (original)</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.3.1">RepeatNet (replicate)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.2.1.1.1">Recall@10</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T1.1.2.1.2">24.18</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T1.1.2.1.3">24.27</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.3.2.1.1">Recall@20</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T1.1.3.2.2">32.38</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T1.1.3.2.3">32.41</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.1.4.3.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.3.1.1">Mrr@10</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T1.1.4.3.2">11.46</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T1.1.4.3.3">11.80</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.1.5.4.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.5.4.1.1">Mrr@20</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.1.5.4.2">12.03</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.1.5.4.3">12.36</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>RepeatNet Replication Result</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Session-based Recommendation with Graph Neural Networks (SR-GNN)</h3>
<figure class="ltx_figure" id="S5.F2">
<p class="ltx_p ltx_align_center" id="S5.F2.1"><span class="ltx_text ltx_inline-block" id="S5.F2.1.1" style="width:433.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="197" id="S5.F2.1.1.g1" src="extracted/5637323/SRGNN.png" width="658"/></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>SR-GNN model. This picture is a modification of the original SR-GNN paper. <math alttext="v" class="ltx_Math" display="inline" id="S5.F2.5.m1.1"><semantics id="S5.F2.5.m1.1b"><mi id="S5.F2.5.m1.1.1" xref="S5.F2.5.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S5.F2.5.m1.1c"><ci id="S5.F2.5.m1.1.1.cmml" xref="S5.F2.5.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.5.m1.1d">v</annotation><annotation encoding="application/x-llamapun" id="S5.F2.5.m1.1e">italic_v</annotation></semantics></math>’s represent items in a session and <math alttext="h" class="ltx_Math" display="inline" id="S5.F2.6.m2.1"><semantics id="S5.F2.6.m2.1b"><mi id="S5.F2.6.m2.1.1" xref="S5.F2.6.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S5.F2.6.m2.1c"><ci id="S5.F2.6.m2.1.1.cmml" xref="S5.F2.6.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.6.m2.1d">h</annotation><annotation encoding="application/x-llamapun" id="S5.F2.6.m2.1e">italic_h</annotation></semantics></math>’s represents the embedding vectors of <math alttext="v" class="ltx_Math" display="inline" id="S5.F2.7.m3.1"><semantics id="S5.F2.7.m3.1b"><mi id="S5.F2.7.m3.1.1" xref="S5.F2.7.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S5.F2.7.m3.1c"><ci id="S5.F2.7.m3.1.1.cmml" xref="S5.F2.7.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.7.m3.1d">v</annotation><annotation encoding="application/x-llamapun" id="S5.F2.7.m3.1e">italic_v</annotation></semantics></math>’s extracted from a Graph Neural Network that handles items</figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Explanations on the original structure of SR-GNN can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2" title="A.2 SR-GNN Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">A.2</span></a>. A detailed model description of the extended SR-GNN is presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6.F4" title="Figure 4 ‣ 6.1.2 Side information encoder of SR-GNN ‣ 6.1 General framework to incorporate side information ‣ 6 Algorithm description ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">4</span></a>. Diginetica is tested by <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib5" title="">2019</a>)</cite> in the SR-GNN paper. We are able to replicate the result of SR-GNN on Diginetica, and the result is shown below in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S5.T2" title="Table 2 ‣ 5.2 Session-based Recommendation with Graph Neural Networks (SR-GNN) ‣ 5 Baseline implementation ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.1.1.1">Dataset: Diginetica</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.2.1">SR-GNN (original)</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.3.1">SR-GNN (replicate)</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.2.1.1.1">Recall@20</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.2.1.2">50.73</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.2.1.3">50.54</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.1.1">MRR@20</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.1.3.2.2">17.59</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.1.3.2.3">17.48</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>SR-GNN Replication Result</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Algorithm description</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this section, we propose a method that supports side information incorporation built upon RepeatNet <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> and SR-GNN <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib5" title="">2019</a>)</cite>. A brief summary of the idea and architecture of RepeatNet and SR-GNN is given in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS1" title="A.1 RepeatNet Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">A.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2" title="A.2 SR-GNN Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">A.2</span></a>. Additionally, we believe that the attention mechanism of existing architectures can be further regularized, so we also propose an additional loss term to regularize the attention.</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>General framework to incorporate side information</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">The basic RepeatNet architecture and SR-GNN architecture do not provide a way to incorporate side information of items in each session, which can be useful and provide additional repeating patterns that may boost the performance of the model, even when the items in each session do not repeat. For example, each movie in the MovieLens dataset has genre information, even though people may not watch a film twice within a period of time, they may tend to focus on movies in the same genre within a fixed period of time.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.4">Thus, given an available session <math alttext="I_{S}=\{i_{1},i_{2},\cdots,i_{j},\cdots,i_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.p2.1.m1.6"><semantics id="S6.SS1.p2.1.m1.6a"><mrow id="S6.SS1.p2.1.m1.6.6" xref="S6.SS1.p2.1.m1.6.6.cmml"><msub id="S6.SS1.p2.1.m1.6.6.6" xref="S6.SS1.p2.1.m1.6.6.6.cmml"><mi id="S6.SS1.p2.1.m1.6.6.6.2" xref="S6.SS1.p2.1.m1.6.6.6.2.cmml">I</mi><mi id="S6.SS1.p2.1.m1.6.6.6.3" xref="S6.SS1.p2.1.m1.6.6.6.3.cmml">S</mi></msub><mo id="S6.SS1.p2.1.m1.6.6.5" xref="S6.SS1.p2.1.m1.6.6.5.cmml">=</mo><mrow id="S6.SS1.p2.1.m1.6.6.4.4" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml"><mo id="S6.SS1.p2.1.m1.6.6.4.4.5" stretchy="false" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml">{</mo><msub id="S6.SS1.p2.1.m1.3.3.1.1.1" xref="S6.SS1.p2.1.m1.3.3.1.1.1.cmml"><mi id="S6.SS1.p2.1.m1.3.3.1.1.1.2" xref="S6.SS1.p2.1.m1.3.3.1.1.1.2.cmml">i</mi><mn id="S6.SS1.p2.1.m1.3.3.1.1.1.3" xref="S6.SS1.p2.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.p2.1.m1.6.6.4.4.6" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml">,</mo><msub id="S6.SS1.p2.1.m1.4.4.2.2.2" xref="S6.SS1.p2.1.m1.4.4.2.2.2.cmml"><mi id="S6.SS1.p2.1.m1.4.4.2.2.2.2" xref="S6.SS1.p2.1.m1.4.4.2.2.2.2.cmml">i</mi><mn id="S6.SS1.p2.1.m1.4.4.2.2.2.3" xref="S6.SS1.p2.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.p2.1.m1.6.6.4.4.7" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml">,</mo><mi id="S6.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S6.SS1.p2.1.m1.1.1.cmml">⋯</mi><mo id="S6.SS1.p2.1.m1.6.6.4.4.8" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml">,</mo><msub id="S6.SS1.p2.1.m1.5.5.3.3.3" xref="S6.SS1.p2.1.m1.5.5.3.3.3.cmml"><mi id="S6.SS1.p2.1.m1.5.5.3.3.3.2" xref="S6.SS1.p2.1.m1.5.5.3.3.3.2.cmml">i</mi><mi id="S6.SS1.p2.1.m1.5.5.3.3.3.3" xref="S6.SS1.p2.1.m1.5.5.3.3.3.3.cmml">j</mi></msub><mo id="S6.SS1.p2.1.m1.6.6.4.4.9" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml">,</mo><mi id="S6.SS1.p2.1.m1.2.2" mathvariant="normal" xref="S6.SS1.p2.1.m1.2.2.cmml">⋯</mi><mo id="S6.SS1.p2.1.m1.6.6.4.4.10" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml">,</mo><msub id="S6.SS1.p2.1.m1.6.6.4.4.4" xref="S6.SS1.p2.1.m1.6.6.4.4.4.cmml"><mi id="S6.SS1.p2.1.m1.6.6.4.4.4.2" xref="S6.SS1.p2.1.m1.6.6.4.4.4.2.cmml">i</mi><mi id="S6.SS1.p2.1.m1.6.6.4.4.4.3" xref="S6.SS1.p2.1.m1.6.6.4.4.4.3.cmml">t</mi></msub><mo id="S6.SS1.p2.1.m1.6.6.4.4.11" stretchy="false" xref="S6.SS1.p2.1.m1.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.6b"><apply id="S6.SS1.p2.1.m1.6.6.cmml" xref="S6.SS1.p2.1.m1.6.6"><eq id="S6.SS1.p2.1.m1.6.6.5.cmml" xref="S6.SS1.p2.1.m1.6.6.5"></eq><apply id="S6.SS1.p2.1.m1.6.6.6.cmml" xref="S6.SS1.p2.1.m1.6.6.6"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.6.6.6.1.cmml" xref="S6.SS1.p2.1.m1.6.6.6">subscript</csymbol><ci id="S6.SS1.p2.1.m1.6.6.6.2.cmml" xref="S6.SS1.p2.1.m1.6.6.6.2">𝐼</ci><ci id="S6.SS1.p2.1.m1.6.6.6.3.cmml" xref="S6.SS1.p2.1.m1.6.6.6.3">𝑆</ci></apply><set id="S6.SS1.p2.1.m1.6.6.4.5.cmml" xref="S6.SS1.p2.1.m1.6.6.4.4"><apply id="S6.SS1.p2.1.m1.3.3.1.1.1.cmml" xref="S6.SS1.p2.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.3.3.1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S6.SS1.p2.1.m1.3.3.1.1.1.2.cmml" xref="S6.SS1.p2.1.m1.3.3.1.1.1.2">𝑖</ci><cn id="S6.SS1.p2.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S6.SS1.p2.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S6.SS1.p2.1.m1.4.4.2.2.2.cmml" xref="S6.SS1.p2.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.4.4.2.2.2.1.cmml" xref="S6.SS1.p2.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S6.SS1.p2.1.m1.4.4.2.2.2.2.cmml" xref="S6.SS1.p2.1.m1.4.4.2.2.2.2">𝑖</ci><cn id="S6.SS1.p2.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S6.SS1.p2.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1">⋯</ci><apply id="S6.SS1.p2.1.m1.5.5.3.3.3.cmml" xref="S6.SS1.p2.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.5.5.3.3.3.1.cmml" xref="S6.SS1.p2.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S6.SS1.p2.1.m1.5.5.3.3.3.2.cmml" xref="S6.SS1.p2.1.m1.5.5.3.3.3.2">𝑖</ci><ci id="S6.SS1.p2.1.m1.5.5.3.3.3.3.cmml" xref="S6.SS1.p2.1.m1.5.5.3.3.3.3">𝑗</ci></apply><ci id="S6.SS1.p2.1.m1.2.2.cmml" xref="S6.SS1.p2.1.m1.2.2">⋯</ci><apply id="S6.SS1.p2.1.m1.6.6.4.4.4.cmml" xref="S6.SS1.p2.1.m1.6.6.4.4.4"><csymbol cd="ambiguous" id="S6.SS1.p2.1.m1.6.6.4.4.4.1.cmml" xref="S6.SS1.p2.1.m1.6.6.4.4.4">subscript</csymbol><ci id="S6.SS1.p2.1.m1.6.6.4.4.4.2.cmml" xref="S6.SS1.p2.1.m1.6.6.4.4.4.2">𝑖</ci><ci id="S6.SS1.p2.1.m1.6.6.4.4.4.3.cmml" xref="S6.SS1.p2.1.m1.6.6.4.4.4.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.6c">I_{S}=\{i_{1},i_{2},\cdots,i_{j},\cdots,i_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.1.m1.6d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>, we focus on its corresponding side information <math alttext="Side_{S}=\{s_{1},s_{2},\cdots,s_{j},\cdots,s_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.p2.2.m2.6"><semantics id="S6.SS1.p2.2.m2.6a"><mrow id="S6.SS1.p2.2.m2.6.6" xref="S6.SS1.p2.2.m2.6.6.cmml"><mrow id="S6.SS1.p2.2.m2.6.6.6" xref="S6.SS1.p2.2.m2.6.6.6.cmml"><mi id="S6.SS1.p2.2.m2.6.6.6.2" xref="S6.SS1.p2.2.m2.6.6.6.2.cmml">S</mi><mo id="S6.SS1.p2.2.m2.6.6.6.1" xref="S6.SS1.p2.2.m2.6.6.6.1.cmml">⁢</mo><mi id="S6.SS1.p2.2.m2.6.6.6.3" xref="S6.SS1.p2.2.m2.6.6.6.3.cmml">i</mi><mo id="S6.SS1.p2.2.m2.6.6.6.1a" xref="S6.SS1.p2.2.m2.6.6.6.1.cmml">⁢</mo><mi id="S6.SS1.p2.2.m2.6.6.6.4" xref="S6.SS1.p2.2.m2.6.6.6.4.cmml">d</mi><mo id="S6.SS1.p2.2.m2.6.6.6.1b" xref="S6.SS1.p2.2.m2.6.6.6.1.cmml">⁢</mo><msub id="S6.SS1.p2.2.m2.6.6.6.5" xref="S6.SS1.p2.2.m2.6.6.6.5.cmml"><mi id="S6.SS1.p2.2.m2.6.6.6.5.2" xref="S6.SS1.p2.2.m2.6.6.6.5.2.cmml">e</mi><mi id="S6.SS1.p2.2.m2.6.6.6.5.3" xref="S6.SS1.p2.2.m2.6.6.6.5.3.cmml">S</mi></msub></mrow><mo id="S6.SS1.p2.2.m2.6.6.5" xref="S6.SS1.p2.2.m2.6.6.5.cmml">=</mo><mrow id="S6.SS1.p2.2.m2.6.6.4.4" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml"><mo id="S6.SS1.p2.2.m2.6.6.4.4.5" stretchy="false" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml">{</mo><msub id="S6.SS1.p2.2.m2.3.3.1.1.1" xref="S6.SS1.p2.2.m2.3.3.1.1.1.cmml"><mi id="S6.SS1.p2.2.m2.3.3.1.1.1.2" xref="S6.SS1.p2.2.m2.3.3.1.1.1.2.cmml">s</mi><mn id="S6.SS1.p2.2.m2.3.3.1.1.1.3" xref="S6.SS1.p2.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.p2.2.m2.6.6.4.4.6" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml">,</mo><msub id="S6.SS1.p2.2.m2.4.4.2.2.2" xref="S6.SS1.p2.2.m2.4.4.2.2.2.cmml"><mi id="S6.SS1.p2.2.m2.4.4.2.2.2.2" xref="S6.SS1.p2.2.m2.4.4.2.2.2.2.cmml">s</mi><mn id="S6.SS1.p2.2.m2.4.4.2.2.2.3" xref="S6.SS1.p2.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.p2.2.m2.6.6.4.4.7" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml">,</mo><mi id="S6.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S6.SS1.p2.2.m2.1.1.cmml">⋯</mi><mo id="S6.SS1.p2.2.m2.6.6.4.4.8" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml">,</mo><msub id="S6.SS1.p2.2.m2.5.5.3.3.3" xref="S6.SS1.p2.2.m2.5.5.3.3.3.cmml"><mi id="S6.SS1.p2.2.m2.5.5.3.3.3.2" xref="S6.SS1.p2.2.m2.5.5.3.3.3.2.cmml">s</mi><mi id="S6.SS1.p2.2.m2.5.5.3.3.3.3" xref="S6.SS1.p2.2.m2.5.5.3.3.3.3.cmml">j</mi></msub><mo id="S6.SS1.p2.2.m2.6.6.4.4.9" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml">,</mo><mi id="S6.SS1.p2.2.m2.2.2" mathvariant="normal" xref="S6.SS1.p2.2.m2.2.2.cmml">⋯</mi><mo id="S6.SS1.p2.2.m2.6.6.4.4.10" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml">,</mo><msub id="S6.SS1.p2.2.m2.6.6.4.4.4" xref="S6.SS1.p2.2.m2.6.6.4.4.4.cmml"><mi id="S6.SS1.p2.2.m2.6.6.4.4.4.2" xref="S6.SS1.p2.2.m2.6.6.4.4.4.2.cmml">s</mi><mi id="S6.SS1.p2.2.m2.6.6.4.4.4.3" xref="S6.SS1.p2.2.m2.6.6.4.4.4.3.cmml">t</mi></msub><mo id="S6.SS1.p2.2.m2.6.6.4.4.11" stretchy="false" xref="S6.SS1.p2.2.m2.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.6b"><apply id="S6.SS1.p2.2.m2.6.6.cmml" xref="S6.SS1.p2.2.m2.6.6"><eq id="S6.SS1.p2.2.m2.6.6.5.cmml" xref="S6.SS1.p2.2.m2.6.6.5"></eq><apply id="S6.SS1.p2.2.m2.6.6.6.cmml" xref="S6.SS1.p2.2.m2.6.6.6"><times id="S6.SS1.p2.2.m2.6.6.6.1.cmml" xref="S6.SS1.p2.2.m2.6.6.6.1"></times><ci id="S6.SS1.p2.2.m2.6.6.6.2.cmml" xref="S6.SS1.p2.2.m2.6.6.6.2">𝑆</ci><ci id="S6.SS1.p2.2.m2.6.6.6.3.cmml" xref="S6.SS1.p2.2.m2.6.6.6.3">𝑖</ci><ci id="S6.SS1.p2.2.m2.6.6.6.4.cmml" xref="S6.SS1.p2.2.m2.6.6.6.4">𝑑</ci><apply id="S6.SS1.p2.2.m2.6.6.6.5.cmml" xref="S6.SS1.p2.2.m2.6.6.6.5"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.6.6.6.5.1.cmml" xref="S6.SS1.p2.2.m2.6.6.6.5">subscript</csymbol><ci id="S6.SS1.p2.2.m2.6.6.6.5.2.cmml" xref="S6.SS1.p2.2.m2.6.6.6.5.2">𝑒</ci><ci id="S6.SS1.p2.2.m2.6.6.6.5.3.cmml" xref="S6.SS1.p2.2.m2.6.6.6.5.3">𝑆</ci></apply></apply><set id="S6.SS1.p2.2.m2.6.6.4.5.cmml" xref="S6.SS1.p2.2.m2.6.6.4.4"><apply id="S6.SS1.p2.2.m2.3.3.1.1.1.cmml" xref="S6.SS1.p2.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.3.3.1.1.1.1.cmml" xref="S6.SS1.p2.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S6.SS1.p2.2.m2.3.3.1.1.1.2.cmml" xref="S6.SS1.p2.2.m2.3.3.1.1.1.2">𝑠</ci><cn id="S6.SS1.p2.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S6.SS1.p2.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S6.SS1.p2.2.m2.4.4.2.2.2.cmml" xref="S6.SS1.p2.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.4.4.2.2.2.1.cmml" xref="S6.SS1.p2.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S6.SS1.p2.2.m2.4.4.2.2.2.2.cmml" xref="S6.SS1.p2.2.m2.4.4.2.2.2.2">𝑠</ci><cn id="S6.SS1.p2.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S6.SS1.p2.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S6.SS1.p2.2.m2.1.1.cmml" xref="S6.SS1.p2.2.m2.1.1">⋯</ci><apply id="S6.SS1.p2.2.m2.5.5.3.3.3.cmml" xref="S6.SS1.p2.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.5.5.3.3.3.1.cmml" xref="S6.SS1.p2.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S6.SS1.p2.2.m2.5.5.3.3.3.2.cmml" xref="S6.SS1.p2.2.m2.5.5.3.3.3.2">𝑠</ci><ci id="S6.SS1.p2.2.m2.5.5.3.3.3.3.cmml" xref="S6.SS1.p2.2.m2.5.5.3.3.3.3">𝑗</ci></apply><ci id="S6.SS1.p2.2.m2.2.2.cmml" xref="S6.SS1.p2.2.m2.2.2">⋯</ci><apply id="S6.SS1.p2.2.m2.6.6.4.4.4.cmml" xref="S6.SS1.p2.2.m2.6.6.4.4.4"><csymbol cd="ambiguous" id="S6.SS1.p2.2.m2.6.6.4.4.4.1.cmml" xref="S6.SS1.p2.2.m2.6.6.4.4.4">subscript</csymbol><ci id="S6.SS1.p2.2.m2.6.6.4.4.4.2.cmml" xref="S6.SS1.p2.2.m2.6.6.4.4.4.2">𝑠</ci><ci id="S6.SS1.p2.2.m2.6.6.4.4.4.3.cmml" xref="S6.SS1.p2.2.m2.6.6.4.4.4.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.6c">Side_{S}=\{s_{1},s_{2},\cdots,s_{j},\cdots,s_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.2.m2.6d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , ⋯ , italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> that has the same length as <math alttext="I_{S}" class="ltx_Math" display="inline" id="S6.SS1.p2.3.m3.1"><semantics id="S6.SS1.p2.3.m3.1a"><msub id="S6.SS1.p2.3.m3.1.1" xref="S6.SS1.p2.3.m3.1.1.cmml"><mi id="S6.SS1.p2.3.m3.1.1.2" xref="S6.SS1.p2.3.m3.1.1.2.cmml">I</mi><mi id="S6.SS1.p2.3.m3.1.1.3" xref="S6.SS1.p2.3.m3.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.3.m3.1b"><apply id="S6.SS1.p2.3.m3.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS1.p2.3.m3.1.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS1.p2.3.m3.1.1.2.cmml" xref="S6.SS1.p2.3.m3.1.1.2">𝐼</ci><ci id="S6.SS1.p2.3.m3.1.1.3.cmml" xref="S6.SS1.p2.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.3.m3.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.3.m3.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> provided by the dataset, and incorporate such side information into the model. Note that we only consider <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.p2.4.1">categorical</span> variables, such as genres of a movie in the MovieLens dataset and the category of the item in the Diginetica dataset when encoding side information.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">As mentioned, we propose a general framework to incorporate and encode side information into any existing session-based recommender system that uses a deep neural network architecture. The most straightforward way to achieve our goal is to directly utilize the encoder of any model we want to modify that encodes items in each session. Our method can be expressed as follows:</p>
<ol class="ltx_enumerate" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1">Make a copy of the item encoder that encodes items in each session to encode side information of items in each session.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1">Concatenate the item embedding produced by the item encoder with the corresponding side information embedding produced by the side information encoder. At each timestamp, we will concatenate the item embedding with the side information embedding at the same timestamp.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1">Replace the item embedding with the concatenated embedding in remaining parts of the network.</p>
</div>
</li>
</ol>
</div>
<section class="ltx_subsubsection" id="S6.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.1 </span>Side information encoder of RepeatNet</h4>
<figure class="ltx_figure" id="S6.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="230" id="S6.F3.g1" src="extracted/5637323/RepeatNetWSide.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>RepeatNet model with side information. <math alttext="\forall j\in\{1,\cdots,t\},s_{j}" class="ltx_Math" display="inline" id="S6.F3.7.m1.5"><semantics id="S6.F3.7.m1.5b"><mrow id="S6.F3.7.m1.5.5" xref="S6.F3.7.m1.5.5.cmml"><mrow id="S6.F3.7.m1.5.5.4" xref="S6.F3.7.m1.5.5.4.cmml"><mo id="S6.F3.7.m1.5.5.4.1" rspace="0.167em" xref="S6.F3.7.m1.5.5.4.1.cmml">∀</mo><mi id="S6.F3.7.m1.5.5.4.2" xref="S6.F3.7.m1.5.5.4.2.cmml">j</mi></mrow><mo id="S6.F3.7.m1.5.5.3" xref="S6.F3.7.m1.5.5.3.cmml">∈</mo><mrow id="S6.F3.7.m1.5.5.2.2" xref="S6.F3.7.m1.5.5.2.3.cmml"><mrow id="S6.F3.7.m1.4.4.1.1.1.2" xref="S6.F3.7.m1.4.4.1.1.1.1.cmml"><mo id="S6.F3.7.m1.4.4.1.1.1.2.1" stretchy="false" xref="S6.F3.7.m1.4.4.1.1.1.1.cmml">{</mo><mn id="S6.F3.7.m1.1.1" xref="S6.F3.7.m1.1.1.cmml">1</mn><mo id="S6.F3.7.m1.4.4.1.1.1.2.2" xref="S6.F3.7.m1.4.4.1.1.1.1.cmml">,</mo><mi id="S6.F3.7.m1.2.2" mathvariant="normal" xref="S6.F3.7.m1.2.2.cmml">⋯</mi><mo id="S6.F3.7.m1.4.4.1.1.1.2.3" xref="S6.F3.7.m1.4.4.1.1.1.1.cmml">,</mo><mi id="S6.F3.7.m1.3.3" xref="S6.F3.7.m1.3.3.cmml">t</mi><mo id="S6.F3.7.m1.4.4.1.1.1.2.4" stretchy="false" xref="S6.F3.7.m1.4.4.1.1.1.1.cmml">}</mo></mrow><mo id="S6.F3.7.m1.5.5.2.2.3" xref="S6.F3.7.m1.5.5.2.3.cmml">,</mo><msub id="S6.F3.7.m1.5.5.2.2.2" xref="S6.F3.7.m1.5.5.2.2.2.cmml"><mi id="S6.F3.7.m1.5.5.2.2.2.2" xref="S6.F3.7.m1.5.5.2.2.2.2.cmml">s</mi><mi id="S6.F3.7.m1.5.5.2.2.2.3" xref="S6.F3.7.m1.5.5.2.2.2.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.F3.7.m1.5c"><apply id="S6.F3.7.m1.5.5.cmml" xref="S6.F3.7.m1.5.5"><in id="S6.F3.7.m1.5.5.3.cmml" xref="S6.F3.7.m1.5.5.3"></in><apply id="S6.F3.7.m1.5.5.4.cmml" xref="S6.F3.7.m1.5.5.4"><csymbol cd="latexml" id="S6.F3.7.m1.5.5.4.1.cmml" xref="S6.F3.7.m1.5.5.4.1">for-all</csymbol><ci id="S6.F3.7.m1.5.5.4.2.cmml" xref="S6.F3.7.m1.5.5.4.2">𝑗</ci></apply><list id="S6.F3.7.m1.5.5.2.3.cmml" xref="S6.F3.7.m1.5.5.2.2"><set id="S6.F3.7.m1.4.4.1.1.1.1.cmml" xref="S6.F3.7.m1.4.4.1.1.1.2"><cn id="S6.F3.7.m1.1.1.cmml" type="integer" xref="S6.F3.7.m1.1.1">1</cn><ci id="S6.F3.7.m1.2.2.cmml" xref="S6.F3.7.m1.2.2">⋯</ci><ci id="S6.F3.7.m1.3.3.cmml" xref="S6.F3.7.m1.3.3">𝑡</ci></set><apply id="S6.F3.7.m1.5.5.2.2.2.cmml" xref="S6.F3.7.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S6.F3.7.m1.5.5.2.2.2.1.cmml" xref="S6.F3.7.m1.5.5.2.2.2">subscript</csymbol><ci id="S6.F3.7.m1.5.5.2.2.2.2.cmml" xref="S6.F3.7.m1.5.5.2.2.2.2">𝑠</ci><ci id="S6.F3.7.m1.5.5.2.2.2.3.cmml" xref="S6.F3.7.m1.5.5.2.2.2.3">𝑗</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.7.m1.5d">\forall j\in\{1,\cdots,t\},s_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.F3.7.m1.5e">∀ italic_j ∈ { 1 , ⋯ , italic_t } , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the side information at timestamp <math alttext="j" class="ltx_Math" display="inline" id="S6.F3.8.m2.1"><semantics id="S6.F3.8.m2.1b"><mi id="S6.F3.8.m2.1.1" xref="S6.F3.8.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S6.F3.8.m2.1c"><ci id="S6.F3.8.m2.1.1.cmml" xref="S6.F3.8.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.8.m2.1d">j</annotation><annotation encoding="application/x-llamapun" id="S6.F3.8.m2.1e">italic_j</annotation></semantics></math>, and <math alttext="h^{\prime}_{j}" class="ltx_Math" display="inline" id="S6.F3.9.m3.1"><semantics id="S6.F3.9.m3.1b"><msubsup id="S6.F3.9.m3.1.1" xref="S6.F3.9.m3.1.1.cmml"><mi id="S6.F3.9.m3.1.1.2.2" xref="S6.F3.9.m3.1.1.2.2.cmml">h</mi><mi id="S6.F3.9.m3.1.1.3" xref="S6.F3.9.m3.1.1.3.cmml">j</mi><mo id="S6.F3.9.m3.1.1.2.3" xref="S6.F3.9.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S6.F3.9.m3.1c"><apply id="S6.F3.9.m3.1.1.cmml" xref="S6.F3.9.m3.1.1"><csymbol cd="ambiguous" id="S6.F3.9.m3.1.1.1.cmml" xref="S6.F3.9.m3.1.1">subscript</csymbol><apply id="S6.F3.9.m3.1.1.2.cmml" xref="S6.F3.9.m3.1.1"><csymbol cd="ambiguous" id="S6.F3.9.m3.1.1.2.1.cmml" xref="S6.F3.9.m3.1.1">superscript</csymbol><ci id="S6.F3.9.m3.1.1.2.2.cmml" xref="S6.F3.9.m3.1.1.2.2">ℎ</ci><ci id="S6.F3.9.m3.1.1.2.3.cmml" xref="S6.F3.9.m3.1.1.2.3">′</ci></apply><ci id="S6.F3.9.m3.1.1.3.cmml" xref="S6.F3.9.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.9.m3.1d">h^{\prime}_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.F3.9.m3.1e">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the embedding vector of <math alttext="s_{j}" class="ltx_Math" display="inline" id="S6.F3.10.m4.1"><semantics id="S6.F3.10.m4.1b"><msub id="S6.F3.10.m4.1.1" xref="S6.F3.10.m4.1.1.cmml"><mi id="S6.F3.10.m4.1.1.2" xref="S6.F3.10.m4.1.1.2.cmml">s</mi><mi id="S6.F3.10.m4.1.1.3" xref="S6.F3.10.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F3.10.m4.1c"><apply id="S6.F3.10.m4.1.1.cmml" xref="S6.F3.10.m4.1.1"><csymbol cd="ambiguous" id="S6.F3.10.m4.1.1.1.cmml" xref="S6.F3.10.m4.1.1">subscript</csymbol><ci id="S6.F3.10.m4.1.1.2.cmml" xref="S6.F3.10.m4.1.1.2">𝑠</ci><ci id="S6.F3.10.m4.1.1.3.cmml" xref="S6.F3.10.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.10.m4.1d">s_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.F3.10.m4.1e">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> extracted from a separate GRU that handles side information. The model would concatenate <math alttext="h_{j}" class="ltx_Math" display="inline" id="S6.F3.11.m5.1"><semantics id="S6.F3.11.m5.1b"><msub id="S6.F3.11.m5.1.1" xref="S6.F3.11.m5.1.1.cmml"><mi id="S6.F3.11.m5.1.1.2" xref="S6.F3.11.m5.1.1.2.cmml">h</mi><mi id="S6.F3.11.m5.1.1.3" xref="S6.F3.11.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F3.11.m5.1c"><apply id="S6.F3.11.m5.1.1.cmml" xref="S6.F3.11.m5.1.1"><csymbol cd="ambiguous" id="S6.F3.11.m5.1.1.1.cmml" xref="S6.F3.11.m5.1.1">subscript</csymbol><ci id="S6.F3.11.m5.1.1.2.cmml" xref="S6.F3.11.m5.1.1.2">ℎ</ci><ci id="S6.F3.11.m5.1.1.3.cmml" xref="S6.F3.11.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.11.m5.1d">h_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.F3.11.m5.1e">italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="h^{\prime}_{j}" class="ltx_Math" display="inline" id="S6.F3.12.m6.1"><semantics id="S6.F3.12.m6.1b"><msubsup id="S6.F3.12.m6.1.1" xref="S6.F3.12.m6.1.1.cmml"><mi id="S6.F3.12.m6.1.1.2.2" xref="S6.F3.12.m6.1.1.2.2.cmml">h</mi><mi id="S6.F3.12.m6.1.1.3" xref="S6.F3.12.m6.1.1.3.cmml">j</mi><mo id="S6.F3.12.m6.1.1.2.3" xref="S6.F3.12.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S6.F3.12.m6.1c"><apply id="S6.F3.12.m6.1.1.cmml" xref="S6.F3.12.m6.1.1"><csymbol cd="ambiguous" id="S6.F3.12.m6.1.1.1.cmml" xref="S6.F3.12.m6.1.1">subscript</csymbol><apply id="S6.F3.12.m6.1.1.2.cmml" xref="S6.F3.12.m6.1.1"><csymbol cd="ambiguous" id="S6.F3.12.m6.1.1.2.1.cmml" xref="S6.F3.12.m6.1.1">superscript</csymbol><ci id="S6.F3.12.m6.1.1.2.2.cmml" xref="S6.F3.12.m6.1.1.2.2">ℎ</ci><ci id="S6.F3.12.m6.1.1.2.3.cmml" xref="S6.F3.12.m6.1.1.2.3">′</ci></apply><ci id="S6.F3.12.m6.1.1.3.cmml" xref="S6.F3.12.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.12.m6.1d">h^{\prime}_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.F3.12.m6.1e">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and the concatenated vector would be used by the remaining parts of the model</figcaption>
</figure>
<div class="ltx_para" id="S6.SS1.SSS1.p1">
<p class="ltx_p" id="S6.SS1.SSS1.p1.1">In RepeatNet, a Gated Recurrent Unit (GRU) is used to encode session <math alttext="I_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p1.1.m1.1"><semantics id="S6.SS1.SSS1.p1.1.m1.1a"><msub id="S6.SS1.SSS1.p1.1.m1.1.1" xref="S6.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S6.SS1.SSS1.p1.1.m1.1.1.2" xref="S6.SS1.SSS1.p1.1.m1.1.1.2.cmml">I</mi><mi id="S6.SS1.SSS1.p1.1.m1.1.1.3" xref="S6.SS1.SSS1.p1.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p1.1.m1.1b"><apply id="S6.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.2">𝐼</ci><ci id="S6.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S6.SS1.SSS1.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p1.1.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p1.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> containing items. Specifically, the GRU works as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S6.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle z^{i}_{r}" class="ltx_Math" display="inline" id="S6.E1.m1.1"><semantics id="S6.E1.m1.1a"><msubsup id="S6.E1.m1.1.1" xref="S6.E1.m1.1.1.cmml"><mi id="S6.E1.m1.1.1.2.2" xref="S6.E1.m1.1.1.2.2.cmml">z</mi><mi id="S6.E1.m1.1.1.3" xref="S6.E1.m1.1.1.3.cmml">r</mi><mi id="S6.E1.m1.1.1.2.3" xref="S6.E1.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E1.m1.1b"><apply id="S6.E1.m1.1.1.cmml" xref="S6.E1.m1.1.1"><csymbol cd="ambiguous" id="S6.E1.m1.1.1.1.cmml" xref="S6.E1.m1.1.1">subscript</csymbol><apply id="S6.E1.m1.1.1.2.cmml" xref="S6.E1.m1.1.1"><csymbol cd="ambiguous" id="S6.E1.m1.1.1.2.1.cmml" xref="S6.E1.m1.1.1">superscript</csymbol><ci id="S6.E1.m1.1.1.2.2.cmml" xref="S6.E1.m1.1.1.2.2">𝑧</ci><ci id="S6.E1.m1.1.1.2.3.cmml" xref="S6.E1.m1.1.1.2.3">𝑖</ci></apply><ci id="S6.E1.m1.1.1.3.cmml" xref="S6.E1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E1.m1.1c">\displaystyle z^{i}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E1.m1.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W^{i}_{z}[emb(i_{r}),h^{i}_{r-1}])" class="ltx_Math" display="inline" id="S6.E1.m2.1"><semantics id="S6.E1.m2.1a"><mrow id="S6.E1.m2.1.1" xref="S6.E1.m2.1.1.cmml"><mi id="S6.E1.m2.1.1.3" xref="S6.E1.m2.1.1.3.cmml"></mi><mo id="S6.E1.m2.1.1.2" xref="S6.E1.m2.1.1.2.cmml">=</mo><mrow id="S6.E1.m2.1.1.1" xref="S6.E1.m2.1.1.1.cmml"><mi id="S6.E1.m2.1.1.1.3" xref="S6.E1.m2.1.1.1.3.cmml">σ</mi><mo id="S6.E1.m2.1.1.1.2" xref="S6.E1.m2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E1.m2.1.1.1.1.1" xref="S6.E1.m2.1.1.1.1.1.1.cmml"><mo id="S6.E1.m2.1.1.1.1.1.2" stretchy="false" xref="S6.E1.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E1.m2.1.1.1.1.1.1" xref="S6.E1.m2.1.1.1.1.1.1.cmml"><msubsup id="S6.E1.m2.1.1.1.1.1.1.4" xref="S6.E1.m2.1.1.1.1.1.1.4.cmml"><mi id="S6.E1.m2.1.1.1.1.1.1.4.2.2" xref="S6.E1.m2.1.1.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E1.m2.1.1.1.1.1.1.4.3" xref="S6.E1.m2.1.1.1.1.1.1.4.3.cmml">z</mi><mi id="S6.E1.m2.1.1.1.1.1.1.4.2.3" xref="S6.E1.m2.1.1.1.1.1.1.4.2.3.cmml">i</mi></msubsup><mo id="S6.E1.m2.1.1.1.1.1.1.3" xref="S6.E1.m2.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E1.m2.1.1.1.1.1.1.2.2" xref="S6.E1.m2.1.1.1.1.1.1.2.3.cmml"><mo id="S6.E1.m2.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S6.E1.m2.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E1.m2.1.1.1.1.1.1.1.1.1" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E1.m2.1.1.1.1.1.1.1.1.1.3" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S6.E1.m2.1.1.1.1.1.1.1.1.1.2" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E1.m2.1.1.1.1.1.1.1.1.1.4" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="S6.E1.m2.1.1.1.1.1.1.1.1.1.2a" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E1.m2.1.1.1.1.1.1.1.1.1.5" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="S6.E1.m2.1.1.1.1.1.1.1.1.1.2b" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.E1.m2.1.1.1.1.1.1.2.2.4" xref="S6.E1.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S6.E1.m2.1.1.1.1.1.1.2.2.2" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.2" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.2" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.1" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.3" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.3" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S6.E1.m2.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S6.E1.m2.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E1.m2.1.1.1.1.1.3" stretchy="false" xref="S6.E1.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E1.m2.1b"><apply id="S6.E1.m2.1.1.cmml" xref="S6.E1.m2.1.1"><eq id="S6.E1.m2.1.1.2.cmml" xref="S6.E1.m2.1.1.2"></eq><csymbol cd="latexml" id="S6.E1.m2.1.1.3.cmml" xref="S6.E1.m2.1.1.3">absent</csymbol><apply id="S6.E1.m2.1.1.1.cmml" xref="S6.E1.m2.1.1.1"><times id="S6.E1.m2.1.1.1.2.cmml" xref="S6.E1.m2.1.1.1.2"></times><ci id="S6.E1.m2.1.1.1.3.cmml" xref="S6.E1.m2.1.1.1.3">𝜎</ci><apply id="S6.E1.m2.1.1.1.1.1.1.cmml" xref="S6.E1.m2.1.1.1.1.1"><times id="S6.E1.m2.1.1.1.1.1.1.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.3"></times><apply id="S6.E1.m2.1.1.1.1.1.1.4.cmml" xref="S6.E1.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E1.m2.1.1.1.1.1.1.4.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.4">subscript</csymbol><apply id="S6.E1.m2.1.1.1.1.1.1.4.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E1.m2.1.1.1.1.1.1.4.2.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.4">superscript</csymbol><ci id="S6.E1.m2.1.1.1.1.1.1.4.2.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E1.m2.1.1.1.1.1.1.4.2.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S6.E1.m2.1.1.1.1.1.1.4.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.4.3">𝑧</ci></apply><interval closure="closed" id="S6.E1.m2.1.1.1.1.1.1.2.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2"><apply id="S6.E1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1"><times id="S6.E1.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.2"></times><ci id="S6.E1.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S6.E1.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.4">𝑚</ci><ci id="S6.E1.m2.1.1.1.1.1.1.1.1.1.5.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.5">𝑏</ci><apply id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S6.E1.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E1.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3"><minus id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S6.E1.m2.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E1.m2.1c">\displaystyle=\sigma(W^{i}_{z}[emb(i_{r}),h^{i}_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E1.m2.1d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S6.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r^{i}_{r}" class="ltx_Math" display="inline" id="S6.E2.m1.1"><semantics id="S6.E2.m1.1a"><msubsup id="S6.E2.m1.1.1" xref="S6.E2.m1.1.1.cmml"><mi id="S6.E2.m1.1.1.2.2" xref="S6.E2.m1.1.1.2.2.cmml">r</mi><mi id="S6.E2.m1.1.1.3" xref="S6.E2.m1.1.1.3.cmml">r</mi><mi id="S6.E2.m1.1.1.2.3" xref="S6.E2.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E2.m1.1b"><apply id="S6.E2.m1.1.1.cmml" xref="S6.E2.m1.1.1"><csymbol cd="ambiguous" id="S6.E2.m1.1.1.1.cmml" xref="S6.E2.m1.1.1">subscript</csymbol><apply id="S6.E2.m1.1.1.2.cmml" xref="S6.E2.m1.1.1"><csymbol cd="ambiguous" id="S6.E2.m1.1.1.2.1.cmml" xref="S6.E2.m1.1.1">superscript</csymbol><ci id="S6.E2.m1.1.1.2.2.cmml" xref="S6.E2.m1.1.1.2.2">𝑟</ci><ci id="S6.E2.m1.1.1.2.3.cmml" xref="S6.E2.m1.1.1.2.3">𝑖</ci></apply><ci id="S6.E2.m1.1.1.3.cmml" xref="S6.E2.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E2.m1.1c">\displaystyle r^{i}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E2.m1.1d">italic_r start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W^{i}_{r}[emb(i_{r}),h^{i}_{r-1}])" class="ltx_Math" display="inline" id="S6.E2.m2.1"><semantics id="S6.E2.m2.1a"><mrow id="S6.E2.m2.1.1" xref="S6.E2.m2.1.1.cmml"><mi id="S6.E2.m2.1.1.3" xref="S6.E2.m2.1.1.3.cmml"></mi><mo id="S6.E2.m2.1.1.2" xref="S6.E2.m2.1.1.2.cmml">=</mo><mrow id="S6.E2.m2.1.1.1" xref="S6.E2.m2.1.1.1.cmml"><mi id="S6.E2.m2.1.1.1.3" xref="S6.E2.m2.1.1.1.3.cmml">σ</mi><mo id="S6.E2.m2.1.1.1.2" xref="S6.E2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E2.m2.1.1.1.1.1" xref="S6.E2.m2.1.1.1.1.1.1.cmml"><mo id="S6.E2.m2.1.1.1.1.1.2" stretchy="false" xref="S6.E2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E2.m2.1.1.1.1.1.1" xref="S6.E2.m2.1.1.1.1.1.1.cmml"><msubsup id="S6.E2.m2.1.1.1.1.1.1.4" xref="S6.E2.m2.1.1.1.1.1.1.4.cmml"><mi id="S6.E2.m2.1.1.1.1.1.1.4.2.2" xref="S6.E2.m2.1.1.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E2.m2.1.1.1.1.1.1.4.3" xref="S6.E2.m2.1.1.1.1.1.1.4.3.cmml">r</mi><mi id="S6.E2.m2.1.1.1.1.1.1.4.2.3" xref="S6.E2.m2.1.1.1.1.1.1.4.2.3.cmml">i</mi></msubsup><mo id="S6.E2.m2.1.1.1.1.1.1.3" xref="S6.E2.m2.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E2.m2.1.1.1.1.1.1.2.2" xref="S6.E2.m2.1.1.1.1.1.1.2.3.cmml"><mo id="S6.E2.m2.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S6.E2.m2.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E2.m2.1.1.1.1.1.1.1.1.1" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E2.m2.1.1.1.1.1.1.1.1.1.3" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S6.E2.m2.1.1.1.1.1.1.1.1.1.2" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E2.m2.1.1.1.1.1.1.1.1.1.4" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="S6.E2.m2.1.1.1.1.1.1.1.1.1.2a" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E2.m2.1.1.1.1.1.1.1.1.1.5" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="S6.E2.m2.1.1.1.1.1.1.1.1.1.2b" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.E2.m2.1.1.1.1.1.1.2.2.4" xref="S6.E2.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S6.E2.m2.1.1.1.1.1.1.2.2.2" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.2" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.2" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.1" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.3" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.3" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S6.E2.m2.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S6.E2.m2.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E2.m2.1.1.1.1.1.3" stretchy="false" xref="S6.E2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E2.m2.1b"><apply id="S6.E2.m2.1.1.cmml" xref="S6.E2.m2.1.1"><eq id="S6.E2.m2.1.1.2.cmml" xref="S6.E2.m2.1.1.2"></eq><csymbol cd="latexml" id="S6.E2.m2.1.1.3.cmml" xref="S6.E2.m2.1.1.3">absent</csymbol><apply id="S6.E2.m2.1.1.1.cmml" xref="S6.E2.m2.1.1.1"><times id="S6.E2.m2.1.1.1.2.cmml" xref="S6.E2.m2.1.1.1.2"></times><ci id="S6.E2.m2.1.1.1.3.cmml" xref="S6.E2.m2.1.1.1.3">𝜎</ci><apply id="S6.E2.m2.1.1.1.1.1.1.cmml" xref="S6.E2.m2.1.1.1.1.1"><times id="S6.E2.m2.1.1.1.1.1.1.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.3"></times><apply id="S6.E2.m2.1.1.1.1.1.1.4.cmml" xref="S6.E2.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E2.m2.1.1.1.1.1.1.4.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.4">subscript</csymbol><apply id="S6.E2.m2.1.1.1.1.1.1.4.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E2.m2.1.1.1.1.1.1.4.2.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.4">superscript</csymbol><ci id="S6.E2.m2.1.1.1.1.1.1.4.2.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E2.m2.1.1.1.1.1.1.4.2.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S6.E2.m2.1.1.1.1.1.1.4.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.4.3">𝑟</ci></apply><interval closure="closed" id="S6.E2.m2.1.1.1.1.1.1.2.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2"><apply id="S6.E2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1"><times id="S6.E2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.2"></times><ci id="S6.E2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S6.E2.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.4">𝑚</ci><ci id="S6.E2.m2.1.1.1.1.1.1.1.1.1.5.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.5">𝑏</ci><apply id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S6.E2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E2.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3"><minus id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S6.E2.m2.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E2.m2.1c">\displaystyle=\sigma(W^{i}_{r}[emb(i_{r}),h^{i}_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E2.m2.1d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S6.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{h^{i}_{r}}" class="ltx_Math" display="inline" id="S6.E3.m1.1"><semantics id="S6.E3.m1.1a"><mover accent="true" id="S6.E3.m1.1.1" xref="S6.E3.m1.1.1.cmml"><msubsup id="S6.E3.m1.1.1.2" xref="S6.E3.m1.1.1.2.cmml"><mi id="S6.E3.m1.1.1.2.2.2" xref="S6.E3.m1.1.1.2.2.2.cmml">h</mi><mi id="S6.E3.m1.1.1.2.3" xref="S6.E3.m1.1.1.2.3.cmml">r</mi><mi id="S6.E3.m1.1.1.2.2.3" xref="S6.E3.m1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S6.E3.m1.1.1.1" xref="S6.E3.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.E3.m1.1b"><apply id="S6.E3.m1.1.1.cmml" xref="S6.E3.m1.1.1"><ci id="S6.E3.m1.1.1.1.cmml" xref="S6.E3.m1.1.1.1">~</ci><apply id="S6.E3.m1.1.1.2.cmml" xref="S6.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S6.E3.m1.1.1.2.1.cmml" xref="S6.E3.m1.1.1.2">subscript</csymbol><apply id="S6.E3.m1.1.1.2.2.cmml" xref="S6.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S6.E3.m1.1.1.2.2.1.cmml" xref="S6.E3.m1.1.1.2">superscript</csymbol><ci id="S6.E3.m1.1.1.2.2.2.cmml" xref="S6.E3.m1.1.1.2.2.2">ℎ</ci><ci id="S6.E3.m1.1.1.2.2.3.cmml" xref="S6.E3.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S6.E3.m1.1.1.2.3.cmml" xref="S6.E3.m1.1.1.2.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E3.m1.1c">\displaystyle\tilde{h^{i}_{r}}</annotation><annotation encoding="application/x-llamapun" id="S6.E3.m1.1d">over~ start_ARG italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\tanh(W^{i}_{h}[emb(i_{r}),r^{i}_{r}\odot h^{i}_{r-1}])" class="ltx_Math" display="inline" id="S6.E3.m2.2"><semantics id="S6.E3.m2.2a"><mrow id="S6.E3.m2.2.2" xref="S6.E3.m2.2.2.cmml"><mi id="S6.E3.m2.2.2.3" xref="S6.E3.m2.2.2.3.cmml"></mi><mo id="S6.E3.m2.2.2.2" xref="S6.E3.m2.2.2.2.cmml">=</mo><mrow id="S6.E3.m2.2.2.1.1" xref="S6.E3.m2.2.2.1.2.cmml"><mi id="S6.E3.m2.1.1" xref="S6.E3.m2.1.1.cmml">tanh</mi><mo id="S6.E3.m2.2.2.1.1a" xref="S6.E3.m2.2.2.1.2.cmml">⁡</mo><mrow id="S6.E3.m2.2.2.1.1.1" xref="S6.E3.m2.2.2.1.2.cmml"><mo id="S6.E3.m2.2.2.1.1.1.2" stretchy="false" xref="S6.E3.m2.2.2.1.2.cmml">(</mo><mrow id="S6.E3.m2.2.2.1.1.1.1" xref="S6.E3.m2.2.2.1.1.1.1.cmml"><msubsup id="S6.E3.m2.2.2.1.1.1.1.4" xref="S6.E3.m2.2.2.1.1.1.1.4.cmml"><mi id="S6.E3.m2.2.2.1.1.1.1.4.2.2" xref="S6.E3.m2.2.2.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E3.m2.2.2.1.1.1.1.4.3" xref="S6.E3.m2.2.2.1.1.1.1.4.3.cmml">h</mi><mi id="S6.E3.m2.2.2.1.1.1.1.4.2.3" xref="S6.E3.m2.2.2.1.1.1.1.4.2.3.cmml">i</mi></msubsup><mo id="S6.E3.m2.2.2.1.1.1.1.3" xref="S6.E3.m2.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E3.m2.2.2.1.1.1.1.2.2" xref="S6.E3.m2.2.2.1.1.1.1.2.3.cmml"><mo id="S6.E3.m2.2.2.1.1.1.1.2.2.3" stretchy="false" xref="S6.E3.m2.2.2.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E3.m2.2.2.1.1.1.1.1.1.1" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S6.E3.m2.2.2.1.1.1.1.1.1.1.3" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S6.E3.m2.2.2.1.1.1.1.1.1.1.2" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E3.m2.2.2.1.1.1.1.1.1.1.4" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="S6.E3.m2.2.2.1.1.1.1.1.1.1.2a" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E3.m2.2.2.1.1.1.1.1.1.1.5" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="S6.E3.m2.2.2.1.1.1.1.1.1.1.2b" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.E3.m2.2.2.1.1.1.1.2.2.4" xref="S6.E3.m2.2.2.1.1.1.1.2.3.cmml">,</mo><mrow id="S6.E3.m2.2.2.1.1.1.1.2.2.2" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.cmml"><msubsup id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.2" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.2.cmml">r</mi><mi id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.3" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.3.cmml">r</mi><mi id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.3" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S6.E3.m2.2.2.1.1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.1.cmml">⊙</mo><msubsup id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.2" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.2.cmml">h</mi><mrow id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.cmml"><mi id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.2" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml">r</mi><mo id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.1" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.3" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow><mi id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.3" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.3.cmml">i</mi></msubsup></mrow><mo id="S6.E3.m2.2.2.1.1.1.1.2.2.5" stretchy="false" xref="S6.E3.m2.2.2.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E3.m2.2.2.1.1.1.3" stretchy="false" xref="S6.E3.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E3.m2.2b"><apply id="S6.E3.m2.2.2.cmml" xref="S6.E3.m2.2.2"><eq id="S6.E3.m2.2.2.2.cmml" xref="S6.E3.m2.2.2.2"></eq><csymbol cd="latexml" id="S6.E3.m2.2.2.3.cmml" xref="S6.E3.m2.2.2.3">absent</csymbol><apply id="S6.E3.m2.2.2.1.2.cmml" xref="S6.E3.m2.2.2.1.1"><tanh id="S6.E3.m2.1.1.cmml" xref="S6.E3.m2.1.1"></tanh><apply id="S6.E3.m2.2.2.1.1.1.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1"><times id="S6.E3.m2.2.2.1.1.1.1.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.3"></times><apply id="S6.E3.m2.2.2.1.1.1.1.4.cmml" xref="S6.E3.m2.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E3.m2.2.2.1.1.1.1.4.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.4">subscript</csymbol><apply id="S6.E3.m2.2.2.1.1.1.1.4.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E3.m2.2.2.1.1.1.1.4.2.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.4">superscript</csymbol><ci id="S6.E3.m2.2.2.1.1.1.1.4.2.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E3.m2.2.2.1.1.1.1.4.2.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S6.E3.m2.2.2.1.1.1.1.4.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.4.3">ℎ</ci></apply><interval closure="closed" id="S6.E3.m2.2.2.1.1.1.1.2.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2"><apply id="S6.E3.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1"><times id="S6.E3.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.2"></times><ci id="S6.E3.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S6.E3.m2.2.2.1.1.1.1.1.1.1.4.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.4">𝑚</ci><ci id="S6.E3.m2.2.2.1.1.1.1.1.1.1.5.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.5">𝑏</ci><apply id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S6.E3.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S6.E3.m2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.1">direct-product</csymbol><apply id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.2">𝑟</ci><ci id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.2.3">𝑟</ci></apply><apply id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3">subscript</csymbol><apply id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3">superscript</csymbol><ci id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.2">ℎ</ci><ci id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.2.3">𝑖</ci></apply><apply id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3"><minus id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.1"></minus><ci id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.2">𝑟</ci><cn id="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S6.E3.m2.2.2.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E3.m2.2c">\displaystyle=\tanh(W^{i}_{h}[emb(i_{r}),r^{i}_{r}\odot h^{i}_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E3.m2.2d">= roman_tanh ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_r start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S6.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h^{i}_{r}" class="ltx_Math" display="inline" id="S6.E4.m1.1"><semantics id="S6.E4.m1.1a"><msubsup id="S6.E4.m1.1.1" xref="S6.E4.m1.1.1.cmml"><mi id="S6.E4.m1.1.1.2.2" xref="S6.E4.m1.1.1.2.2.cmml">h</mi><mi id="S6.E4.m1.1.1.3" xref="S6.E4.m1.1.1.3.cmml">r</mi><mi id="S6.E4.m1.1.1.2.3" xref="S6.E4.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E4.m1.1b"><apply id="S6.E4.m1.1.1.cmml" xref="S6.E4.m1.1.1"><csymbol cd="ambiguous" id="S6.E4.m1.1.1.1.cmml" xref="S6.E4.m1.1.1">subscript</csymbol><apply id="S6.E4.m1.1.1.2.cmml" xref="S6.E4.m1.1.1"><csymbol cd="ambiguous" id="S6.E4.m1.1.1.2.1.cmml" xref="S6.E4.m1.1.1">superscript</csymbol><ci id="S6.E4.m1.1.1.2.2.cmml" xref="S6.E4.m1.1.1.2.2">ℎ</ci><ci id="S6.E4.m1.1.1.2.3.cmml" xref="S6.E4.m1.1.1.2.3">𝑖</ci></apply><ci id="S6.E4.m1.1.1.3.cmml" xref="S6.E4.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E4.m1.1c">\displaystyle h^{i}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E4.m1.1d">italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(1-z^{i}_{r})\odot h^{i}_{r-1}+z^{i}_{r}\odot\tilde{h^{i}_{r}}" class="ltx_Math" display="inline" id="S6.E4.m2.1"><semantics id="S6.E4.m2.1a"><mrow id="S6.E4.m2.1.1" xref="S6.E4.m2.1.1.cmml"><mi id="S6.E4.m2.1.1.3" xref="S6.E4.m2.1.1.3.cmml"></mi><mo id="S6.E4.m2.1.1.2" xref="S6.E4.m2.1.1.2.cmml">=</mo><mrow id="S6.E4.m2.1.1.1" xref="S6.E4.m2.1.1.1.cmml"><mrow id="S6.E4.m2.1.1.1.1" xref="S6.E4.m2.1.1.1.1.cmml"><mrow id="S6.E4.m2.1.1.1.1.1.1" xref="S6.E4.m2.1.1.1.1.1.1.1.cmml"><mo id="S6.E4.m2.1.1.1.1.1.1.2" stretchy="false" xref="S6.E4.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E4.m2.1.1.1.1.1.1.1" xref="S6.E4.m2.1.1.1.1.1.1.1.cmml"><mn id="S6.E4.m2.1.1.1.1.1.1.1.2" xref="S6.E4.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S6.E4.m2.1.1.1.1.1.1.1.1" xref="S6.E4.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S6.E4.m2.1.1.1.1.1.1.1.3" xref="S6.E4.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S6.E4.m2.1.1.1.1.1.1.1.3.2.2" xref="S6.E4.m2.1.1.1.1.1.1.1.3.2.2.cmml">z</mi><mi id="S6.E4.m2.1.1.1.1.1.1.1.3.3" xref="S6.E4.m2.1.1.1.1.1.1.1.3.3.cmml">r</mi><mi id="S6.E4.m2.1.1.1.1.1.1.1.3.2.3" xref="S6.E4.m2.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msubsup></mrow><mo id="S6.E4.m2.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S6.E4.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S6.E4.m2.1.1.1.1.2" rspace="0.222em" xref="S6.E4.m2.1.1.1.1.2.cmml">⊙</mo><msubsup id="S6.E4.m2.1.1.1.1.3" xref="S6.E4.m2.1.1.1.1.3.cmml"><mi id="S6.E4.m2.1.1.1.1.3.2.2" xref="S6.E4.m2.1.1.1.1.3.2.2.cmml">h</mi><mrow id="S6.E4.m2.1.1.1.1.3.3" xref="S6.E4.m2.1.1.1.1.3.3.cmml"><mi id="S6.E4.m2.1.1.1.1.3.3.2" xref="S6.E4.m2.1.1.1.1.3.3.2.cmml">r</mi><mo id="S6.E4.m2.1.1.1.1.3.3.1" xref="S6.E4.m2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S6.E4.m2.1.1.1.1.3.3.3" xref="S6.E4.m2.1.1.1.1.3.3.3.cmml">1</mn></mrow><mi id="S6.E4.m2.1.1.1.1.3.2.3" xref="S6.E4.m2.1.1.1.1.3.2.3.cmml">i</mi></msubsup></mrow><mo id="S6.E4.m2.1.1.1.2" xref="S6.E4.m2.1.1.1.2.cmml">+</mo><mrow id="S6.E4.m2.1.1.1.3" xref="S6.E4.m2.1.1.1.3.cmml"><msubsup id="S6.E4.m2.1.1.1.3.2" xref="S6.E4.m2.1.1.1.3.2.cmml"><mi id="S6.E4.m2.1.1.1.3.2.2.2" xref="S6.E4.m2.1.1.1.3.2.2.2.cmml">z</mi><mi id="S6.E4.m2.1.1.1.3.2.3" xref="S6.E4.m2.1.1.1.3.2.3.cmml">r</mi><mi id="S6.E4.m2.1.1.1.3.2.2.3" xref="S6.E4.m2.1.1.1.3.2.2.3.cmml">i</mi></msubsup><mo id="S6.E4.m2.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.E4.m2.1.1.1.3.1.cmml">⊙</mo><mover accent="true" id="S6.E4.m2.1.1.1.3.3" xref="S6.E4.m2.1.1.1.3.3.cmml"><msubsup id="S6.E4.m2.1.1.1.3.3.2" xref="S6.E4.m2.1.1.1.3.3.2.cmml"><mi id="S6.E4.m2.1.1.1.3.3.2.2.2" xref="S6.E4.m2.1.1.1.3.3.2.2.2.cmml">h</mi><mi id="S6.E4.m2.1.1.1.3.3.2.3" xref="S6.E4.m2.1.1.1.3.3.2.3.cmml">r</mi><mi id="S6.E4.m2.1.1.1.3.3.2.2.3" xref="S6.E4.m2.1.1.1.3.3.2.2.3.cmml">i</mi></msubsup><mo id="S6.E4.m2.1.1.1.3.3.1" xref="S6.E4.m2.1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E4.m2.1b"><apply id="S6.E4.m2.1.1.cmml" xref="S6.E4.m2.1.1"><eq id="S6.E4.m2.1.1.2.cmml" xref="S6.E4.m2.1.1.2"></eq><csymbol cd="latexml" id="S6.E4.m2.1.1.3.cmml" xref="S6.E4.m2.1.1.3">absent</csymbol><apply id="S6.E4.m2.1.1.1.cmml" xref="S6.E4.m2.1.1.1"><plus id="S6.E4.m2.1.1.1.2.cmml" xref="S6.E4.m2.1.1.1.2"></plus><apply id="S6.E4.m2.1.1.1.1.cmml" xref="S6.E4.m2.1.1.1.1"><csymbol cd="latexml" id="S6.E4.m2.1.1.1.1.2.cmml" xref="S6.E4.m2.1.1.1.1.2">direct-product</csymbol><apply id="S6.E4.m2.1.1.1.1.1.1.1.cmml" xref="S6.E4.m2.1.1.1.1.1.1"><minus id="S6.E4.m2.1.1.1.1.1.1.1.1.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.1"></minus><cn id="S6.E4.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S6.E4.m2.1.1.1.1.1.1.1.2">1</cn><apply id="S6.E4.m2.1.1.1.1.1.1.1.3.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S6.E4.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S6.E4.m2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.3.2.2">𝑧</ci><ci id="S6.E4.m2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S6.E4.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S6.E4.m2.1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><apply id="S6.E4.m2.1.1.1.1.3.cmml" xref="S6.E4.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.1.3.1.cmml" xref="S6.E4.m2.1.1.1.1.3">subscript</csymbol><apply id="S6.E4.m2.1.1.1.1.3.2.cmml" xref="S6.E4.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.1.3.2.1.cmml" xref="S6.E4.m2.1.1.1.1.3">superscript</csymbol><ci id="S6.E4.m2.1.1.1.1.3.2.2.cmml" xref="S6.E4.m2.1.1.1.1.3.2.2">ℎ</ci><ci id="S6.E4.m2.1.1.1.1.3.2.3.cmml" xref="S6.E4.m2.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S6.E4.m2.1.1.1.1.3.3.cmml" xref="S6.E4.m2.1.1.1.1.3.3"><minus id="S6.E4.m2.1.1.1.1.3.3.1.cmml" xref="S6.E4.m2.1.1.1.1.3.3.1"></minus><ci id="S6.E4.m2.1.1.1.1.3.3.2.cmml" xref="S6.E4.m2.1.1.1.1.3.3.2">𝑟</ci><cn id="S6.E4.m2.1.1.1.1.3.3.3.cmml" type="integer" xref="S6.E4.m2.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S6.E4.m2.1.1.1.3.cmml" xref="S6.E4.m2.1.1.1.3"><csymbol cd="latexml" id="S6.E4.m2.1.1.1.3.1.cmml" xref="S6.E4.m2.1.1.1.3.1">direct-product</csymbol><apply id="S6.E4.m2.1.1.1.3.2.cmml" xref="S6.E4.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.3.2.1.cmml" xref="S6.E4.m2.1.1.1.3.2">subscript</csymbol><apply id="S6.E4.m2.1.1.1.3.2.2.cmml" xref="S6.E4.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.3.2.2.1.cmml" xref="S6.E4.m2.1.1.1.3.2">superscript</csymbol><ci id="S6.E4.m2.1.1.1.3.2.2.2.cmml" xref="S6.E4.m2.1.1.1.3.2.2.2">𝑧</ci><ci id="S6.E4.m2.1.1.1.3.2.2.3.cmml" xref="S6.E4.m2.1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S6.E4.m2.1.1.1.3.2.3.cmml" xref="S6.E4.m2.1.1.1.3.2.3">𝑟</ci></apply><apply id="S6.E4.m2.1.1.1.3.3.cmml" xref="S6.E4.m2.1.1.1.3.3"><ci id="S6.E4.m2.1.1.1.3.3.1.cmml" xref="S6.E4.m2.1.1.1.3.3.1">~</ci><apply id="S6.E4.m2.1.1.1.3.3.2.cmml" xref="S6.E4.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.3.3.2.1.cmml" xref="S6.E4.m2.1.1.1.3.3.2">subscript</csymbol><apply id="S6.E4.m2.1.1.1.3.3.2.2.cmml" xref="S6.E4.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S6.E4.m2.1.1.1.3.3.2.2.1.cmml" xref="S6.E4.m2.1.1.1.3.3.2">superscript</csymbol><ci id="S6.E4.m2.1.1.1.3.3.2.2.2.cmml" xref="S6.E4.m2.1.1.1.3.3.2.2.2">ℎ</ci><ci id="S6.E4.m2.1.1.1.3.3.2.2.3.cmml" xref="S6.E4.m2.1.1.1.3.3.2.2.3">𝑖</ci></apply><ci id="S6.E4.m2.1.1.1.3.3.2.3.cmml" xref="S6.E4.m2.1.1.1.3.3.2.3">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E4.m2.1c">\displaystyle=(1-z^{i}_{r})\odot h^{i}_{r-1}+z^{i}_{r}\odot\tilde{h^{i}_{r}}</annotation><annotation encoding="application/x-llamapun" id="S6.E4.m2.1d">= ( 1 - italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ⊙ italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT + italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ over~ start_ARG italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S6.SS1.SSS1.p2">
<p class="ltx_p" id="S6.SS1.SSS1.p2.4">where <math alttext="W^{i}_{z},W^{i}_{r},W^{i}_{h}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p2.1.m1.3"><semantics id="S6.SS1.SSS1.p2.1.m1.3a"><mrow id="S6.SS1.SSS1.p2.1.m1.3.3.3" xref="S6.SS1.SSS1.p2.1.m1.3.3.4.cmml"><msubsup id="S6.SS1.SSS1.p2.1.m1.1.1.1.1" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1.cmml"><mi id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.2" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.2.cmml">W</mi><mi id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.3" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1.3.cmml">z</mi><mi id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.3" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S6.SS1.SSS1.p2.1.m1.3.3.3.4" xref="S6.SS1.SSS1.p2.1.m1.3.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS1.p2.1.m1.2.2.2.2" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2.cmml"><mi id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.2" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.3" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2.3.cmml">r</mi><mi id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.3" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S6.SS1.SSS1.p2.1.m1.3.3.3.5" xref="S6.SS1.SSS1.p2.1.m1.3.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS1.p2.1.m1.3.3.3.3" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3.cmml"><mi id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.2" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.2.cmml">W</mi><mi id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.3" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3.3.cmml">h</mi><mi id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.3" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p2.1.m1.3b"><list id="S6.SS1.SSS1.p2.1.m1.3.3.4.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3"><apply id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.cmml" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1">subscript</csymbol><apply id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.cmml" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.1.cmml" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.2.cmml" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.2">𝑊</ci><ci id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.3.cmml" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S6.SS1.SSS1.p2.1.m1.1.1.1.1.3.cmml" xref="S6.SS1.SSS1.p2.1.m1.1.1.1.1.3">𝑧</ci></apply><apply id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.cmml" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.1.cmml" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2">subscript</csymbol><apply id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.cmml" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2">superscript</csymbol><ci id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.2">𝑊</ci><ci id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S6.SS1.SSS1.p2.1.m1.2.2.2.2.3.cmml" xref="S6.SS1.SSS1.p2.1.m1.2.2.2.2.3">𝑟</ci></apply><apply id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.1.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3">subscript</csymbol><apply id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.1.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3">superscript</csymbol><ci id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.2.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.2">𝑊</ci><ci id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.3.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3.2.3">𝑖</ci></apply><ci id="S6.SS1.SSS1.p2.1.m1.3.3.3.3.3.cmml" xref="S6.SS1.SSS1.p2.1.m1.3.3.3.3.3">ℎ</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p2.1.m1.3c">W^{i}_{z},W^{i}_{r},W^{i}_{h}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p2.1.m1.3d">italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT , italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="emb(i_{r})" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p2.2.m2.1"><semantics id="S6.SS1.SSS1.p2.2.m2.1a"><mrow id="S6.SS1.SSS1.p2.2.m2.1.1" xref="S6.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S6.SS1.SSS1.p2.2.m2.1.1.3" xref="S6.SS1.SSS1.p2.2.m2.1.1.3.cmml">e</mi><mo id="S6.SS1.SSS1.p2.2.m2.1.1.2" xref="S6.SS1.SSS1.p2.2.m2.1.1.2.cmml">⁢</mo><mi id="S6.SS1.SSS1.p2.2.m2.1.1.4" xref="S6.SS1.SSS1.p2.2.m2.1.1.4.cmml">m</mi><mo id="S6.SS1.SSS1.p2.2.m2.1.1.2a" xref="S6.SS1.SSS1.p2.2.m2.1.1.2.cmml">⁢</mo><mi id="S6.SS1.SSS1.p2.2.m2.1.1.5" xref="S6.SS1.SSS1.p2.2.m2.1.1.5.cmml">b</mi><mo id="S6.SS1.SSS1.p2.2.m2.1.1.2b" xref="S6.SS1.SSS1.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.SSS1.p2.2.m2.1.1.1.1" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.2" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.2.cmml">i</mi><mi id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.3" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p2.2.m2.1b"><apply id="S6.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1"><times id="S6.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.2"></times><ci id="S6.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.3">𝑒</ci><ci id="S6.SS1.SSS1.p2.2.m2.1.1.4.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.4">𝑚</ci><ci id="S6.SS1.SSS1.p2.2.m2.1.1.5.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.5">𝑏</ci><apply id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.2">𝑖</ci><ci id="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S6.SS1.SSS1.p2.2.m2.1.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p2.2.m2.1c">emb(i_{r})</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p2.2.m2.1d">italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT )</annotation></semantics></math> are learnable parameters. After this GRU session encoder, a raw available session <math alttext="I_{S}=\{i_{1},i_{2},\cdots,i_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p2.3.m3.4"><semantics id="S6.SS1.SSS1.p2.3.m3.4a"><mrow id="S6.SS1.SSS1.p2.3.m3.4.4" xref="S6.SS1.SSS1.p2.3.m3.4.4.cmml"><msub id="S6.SS1.SSS1.p2.3.m3.4.4.5" xref="S6.SS1.SSS1.p2.3.m3.4.4.5.cmml"><mi id="S6.SS1.SSS1.p2.3.m3.4.4.5.2" xref="S6.SS1.SSS1.p2.3.m3.4.4.5.2.cmml">I</mi><mi id="S6.SS1.SSS1.p2.3.m3.4.4.5.3" xref="S6.SS1.SSS1.p2.3.m3.4.4.5.3.cmml">S</mi></msub><mo id="S6.SS1.SSS1.p2.3.m3.4.4.4" xref="S6.SS1.SSS1.p2.3.m3.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS1.p2.3.m3.4.4.3.3" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.4.cmml"><mo id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.4.cmml">{</mo><msub id="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1" xref="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.2" xref="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.2.cmml">i</mi><mn id="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.3" xref="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.5" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2" xref="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.2" xref="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.2.cmml">i</mi><mn id="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.3" xref="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.6" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS1.p2.3.m3.1.1" mathvariant="normal" xref="S6.SS1.SSS1.p2.3.m3.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.7" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.2" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.2.cmml">i</mi><mi id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.3" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p2.3.m3.4b"><apply id="S6.SS1.SSS1.p2.3.m3.4.4.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4"><eq id="S6.SS1.SSS1.p2.3.m3.4.4.4.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.4"></eq><apply id="S6.SS1.SSS1.p2.3.m3.4.4.5.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.5"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.3.m3.4.4.5.1.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.5">subscript</csymbol><ci id="S6.SS1.SSS1.p2.3.m3.4.4.5.2.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.5.2">𝐼</ci><ci id="S6.SS1.SSS1.p2.3.m3.4.4.5.3.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.5.3">𝑆</ci></apply><set id="S6.SS1.SSS1.p2.3.m3.4.4.3.4.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3"><apply id="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.cmml" xref="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.2">𝑖</ci><cn id="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS1.p2.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.cmml" xref="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.2">𝑖</ci><cn id="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS1.p2.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S6.SS1.SSS1.p2.3.m3.1.1">⋯</ci><apply id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.2">𝑖</ci><ci id="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS1.p2.3.m3.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p2.3.m3.4c">I_{S}=\{i_{1},i_{2},\cdots,i_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p2.3.m3.4d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> is encoded into <math alttext="\{h_{1},h_{2},\cdots,h_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p2.4.m4.4"><semantics id="S6.SS1.SSS1.p2.4.m4.4a"><mrow id="S6.SS1.SSS1.p2.4.m4.4.4.3" xref="S6.SS1.SSS1.p2.4.m4.4.4.4.cmml"><mo id="S6.SS1.SSS1.p2.4.m4.4.4.3.4" stretchy="false" xref="S6.SS1.SSS1.p2.4.m4.4.4.4.cmml">{</mo><msub id="S6.SS1.SSS1.p2.4.m4.2.2.1.1" xref="S6.SS1.SSS1.p2.4.m4.2.2.1.1.cmml"><mi id="S6.SS1.SSS1.p2.4.m4.2.2.1.1.2" xref="S6.SS1.SSS1.p2.4.m4.2.2.1.1.2.cmml">h</mi><mn id="S6.SS1.SSS1.p2.4.m4.2.2.1.1.3" xref="S6.SS1.SSS1.p2.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS1.p2.4.m4.4.4.3.5" xref="S6.SS1.SSS1.p2.4.m4.4.4.4.cmml">,</mo><msub id="S6.SS1.SSS1.p2.4.m4.3.3.2.2" xref="S6.SS1.SSS1.p2.4.m4.3.3.2.2.cmml"><mi id="S6.SS1.SSS1.p2.4.m4.3.3.2.2.2" xref="S6.SS1.SSS1.p2.4.m4.3.3.2.2.2.cmml">h</mi><mn id="S6.SS1.SSS1.p2.4.m4.3.3.2.2.3" xref="S6.SS1.SSS1.p2.4.m4.3.3.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS1.p2.4.m4.4.4.3.6" xref="S6.SS1.SSS1.p2.4.m4.4.4.4.cmml">,</mo><mi id="S6.SS1.SSS1.p2.4.m4.1.1" mathvariant="normal" xref="S6.SS1.SSS1.p2.4.m4.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS1.p2.4.m4.4.4.3.7" xref="S6.SS1.SSS1.p2.4.m4.4.4.4.cmml">,</mo><msub id="S6.SS1.SSS1.p2.4.m4.4.4.3.3" xref="S6.SS1.SSS1.p2.4.m4.4.4.3.3.cmml"><mi id="S6.SS1.SSS1.p2.4.m4.4.4.3.3.2" xref="S6.SS1.SSS1.p2.4.m4.4.4.3.3.2.cmml">h</mi><mi id="S6.SS1.SSS1.p2.4.m4.4.4.3.3.3" xref="S6.SS1.SSS1.p2.4.m4.4.4.3.3.3.cmml">t</mi></msub><mo id="S6.SS1.SSS1.p2.4.m4.4.4.3.8" stretchy="false" xref="S6.SS1.SSS1.p2.4.m4.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p2.4.m4.4b"><set id="S6.SS1.SSS1.p2.4.m4.4.4.4.cmml" xref="S6.SS1.SSS1.p2.4.m4.4.4.3"><apply id="S6.SS1.SSS1.p2.4.m4.2.2.1.1.cmml" xref="S6.SS1.SSS1.p2.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.4.m4.2.2.1.1.1.cmml" xref="S6.SS1.SSS1.p2.4.m4.2.2.1.1">subscript</csymbol><ci id="S6.SS1.SSS1.p2.4.m4.2.2.1.1.2.cmml" xref="S6.SS1.SSS1.p2.4.m4.2.2.1.1.2">ℎ</ci><cn id="S6.SS1.SSS1.p2.4.m4.2.2.1.1.3.cmml" type="integer" xref="S6.SS1.SSS1.p2.4.m4.2.2.1.1.3">1</cn></apply><apply id="S6.SS1.SSS1.p2.4.m4.3.3.2.2.cmml" xref="S6.SS1.SSS1.p2.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.4.m4.3.3.2.2.1.cmml" xref="S6.SS1.SSS1.p2.4.m4.3.3.2.2">subscript</csymbol><ci id="S6.SS1.SSS1.p2.4.m4.3.3.2.2.2.cmml" xref="S6.SS1.SSS1.p2.4.m4.3.3.2.2.2">ℎ</ci><cn id="S6.SS1.SSS1.p2.4.m4.3.3.2.2.3.cmml" type="integer" xref="S6.SS1.SSS1.p2.4.m4.3.3.2.2.3">2</cn></apply><ci id="S6.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S6.SS1.SSS1.p2.4.m4.1.1">⋯</ci><apply id="S6.SS1.SSS1.p2.4.m4.4.4.3.3.cmml" xref="S6.SS1.SSS1.p2.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p2.4.m4.4.4.3.3.1.cmml" xref="S6.SS1.SSS1.p2.4.m4.4.4.3.3">subscript</csymbol><ci id="S6.SS1.SSS1.p2.4.m4.4.4.3.3.2.cmml" xref="S6.SS1.SSS1.p2.4.m4.4.4.3.3.2">ℎ</ci><ci id="S6.SS1.SSS1.p2.4.m4.4.4.3.3.3.cmml" xref="S6.SS1.SSS1.p2.4.m4.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p2.4.m4.4c">\{h_{1},h_{2},\cdots,h_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p2.4.m4.4d">{ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S6.SS1.SSS1.p3">
<p class="ltx_p" id="S6.SS1.SSS1.p3.8">Same as how RepeatNet encodes each session, we will use a GRU to encode side information <math alttext="Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p3.1.m1.1"><semantics id="S6.SS1.SSS1.p3.1.m1.1a"><mrow id="S6.SS1.SSS1.p3.1.m1.1.1" xref="S6.SS1.SSS1.p3.1.m1.1.1.cmml"><mi id="S6.SS1.SSS1.p3.1.m1.1.1.2" xref="S6.SS1.SSS1.p3.1.m1.1.1.2.cmml">S</mi><mo id="S6.SS1.SSS1.p3.1.m1.1.1.1" xref="S6.SS1.SSS1.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.1.m1.1.1.3" xref="S6.SS1.SSS1.p3.1.m1.1.1.3.cmml">i</mi><mo id="S6.SS1.SSS1.p3.1.m1.1.1.1a" xref="S6.SS1.SSS1.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.1.m1.1.1.4" xref="S6.SS1.SSS1.p3.1.m1.1.1.4.cmml">d</mi><mo id="S6.SS1.SSS1.p3.1.m1.1.1.1b" xref="S6.SS1.SSS1.p3.1.m1.1.1.1.cmml">⁢</mo><msub id="S6.SS1.SSS1.p3.1.m1.1.1.5" xref="S6.SS1.SSS1.p3.1.m1.1.1.5.cmml"><mi id="S6.SS1.SSS1.p3.1.m1.1.1.5.2" xref="S6.SS1.SSS1.p3.1.m1.1.1.5.2.cmml">e</mi><mi id="S6.SS1.SSS1.p3.1.m1.1.1.5.3" xref="S6.SS1.SSS1.p3.1.m1.1.1.5.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p3.1.m1.1b"><apply id="S6.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1"><times id="S6.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.1"></times><ci id="S6.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.2">𝑆</ci><ci id="S6.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.3">𝑖</ci><ci id="S6.SS1.SSS1.p3.1.m1.1.1.4.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.4">𝑑</ci><apply id="S6.SS1.SSS1.p3.1.m1.1.1.5.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.5"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p3.1.m1.1.1.5.1.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.5">subscript</csymbol><ci id="S6.SS1.SSS1.p3.1.m1.1.1.5.2.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.5.2">𝑒</ci><ci id="S6.SS1.SSS1.p3.1.m1.1.1.5.3.cmml" xref="S6.SS1.SSS1.p3.1.m1.1.1.5.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p3.1.m1.1c">Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p3.1.m1.1d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p3.2.m2.1"><semantics id="S6.SS1.SSS1.p3.2.m2.1a"><mrow id="S6.SS1.SSS1.p3.2.m2.1.1" xref="S6.SS1.SSS1.p3.2.m2.1.1.cmml"><mi id="S6.SS1.SSS1.p3.2.m2.1.1.2" xref="S6.SS1.SSS1.p3.2.m2.1.1.2.cmml">S</mi><mo id="S6.SS1.SSS1.p3.2.m2.1.1.1" xref="S6.SS1.SSS1.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.2.m2.1.1.3" xref="S6.SS1.SSS1.p3.2.m2.1.1.3.cmml">i</mi><mo id="S6.SS1.SSS1.p3.2.m2.1.1.1a" xref="S6.SS1.SSS1.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.2.m2.1.1.4" xref="S6.SS1.SSS1.p3.2.m2.1.1.4.cmml">d</mi><mo id="S6.SS1.SSS1.p3.2.m2.1.1.1b" xref="S6.SS1.SSS1.p3.2.m2.1.1.1.cmml">⁢</mo><msub id="S6.SS1.SSS1.p3.2.m2.1.1.5" xref="S6.SS1.SSS1.p3.2.m2.1.1.5.cmml"><mi id="S6.SS1.SSS1.p3.2.m2.1.1.5.2" xref="S6.SS1.SSS1.p3.2.m2.1.1.5.2.cmml">e</mi><mi id="S6.SS1.SSS1.p3.2.m2.1.1.5.3" xref="S6.SS1.SSS1.p3.2.m2.1.1.5.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p3.2.m2.1b"><apply id="S6.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1"><times id="S6.SS1.SSS1.p3.2.m2.1.1.1.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.1"></times><ci id="S6.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.2">𝑆</ci><ci id="S6.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.3">𝑖</ci><ci id="S6.SS1.SSS1.p3.2.m2.1.1.4.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.4">𝑑</ci><apply id="S6.SS1.SSS1.p3.2.m2.1.1.5.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.5"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p3.2.m2.1.1.5.1.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.5">subscript</csymbol><ci id="S6.SS1.SSS1.p3.2.m2.1.1.5.2.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.5.2">𝑒</ci><ci id="S6.SS1.SSS1.p3.2.m2.1.1.5.3.cmml" xref="S6.SS1.SSS1.p3.2.m2.1.1.5.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p3.2.m2.1c">Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p3.2.m2.1d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> can be either a set of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS1.p3.8.1">integers</span> or a set of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS1.p3.8.2">set of integers</span>. If <math alttext="s_{j}\in Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p3.5.m5.1"><semantics id="S6.SS1.SSS1.p3.5.m5.1a"><mrow id="S6.SS1.SSS1.p3.5.m5.1.1" xref="S6.SS1.SSS1.p3.5.m5.1.1.cmml"><msub id="S6.SS1.SSS1.p3.5.m5.1.1.2" xref="S6.SS1.SSS1.p3.5.m5.1.1.2.cmml"><mi id="S6.SS1.SSS1.p3.5.m5.1.1.2.2" xref="S6.SS1.SSS1.p3.5.m5.1.1.2.2.cmml">s</mi><mi id="S6.SS1.SSS1.p3.5.m5.1.1.2.3" xref="S6.SS1.SSS1.p3.5.m5.1.1.2.3.cmml">j</mi></msub><mo id="S6.SS1.SSS1.p3.5.m5.1.1.1" xref="S6.SS1.SSS1.p3.5.m5.1.1.1.cmml">∈</mo><mrow id="S6.SS1.SSS1.p3.5.m5.1.1.3" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.cmml"><mi id="S6.SS1.SSS1.p3.5.m5.1.1.3.2" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.2.cmml">S</mi><mo id="S6.SS1.SSS1.p3.5.m5.1.1.3.1" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.5.m5.1.1.3.3" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.3.cmml">i</mi><mo id="S6.SS1.SSS1.p3.5.m5.1.1.3.1a" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.5.m5.1.1.3.4" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.4.cmml">d</mi><mo id="S6.SS1.SSS1.p3.5.m5.1.1.3.1b" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.1.cmml">⁢</mo><msub id="S6.SS1.SSS1.p3.5.m5.1.1.3.5" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.5.cmml"><mi id="S6.SS1.SSS1.p3.5.m5.1.1.3.5.2" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.5.2.cmml">e</mi><mi id="S6.SS1.SSS1.p3.5.m5.1.1.3.5.3" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.5.3.cmml">S</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p3.5.m5.1b"><apply id="S6.SS1.SSS1.p3.5.m5.1.1.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1"><in id="S6.SS1.SSS1.p3.5.m5.1.1.1.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.1"></in><apply id="S6.SS1.SSS1.p3.5.m5.1.1.2.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p3.5.m5.1.1.2.1.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS1.p3.5.m5.1.1.2.2.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.2.2">𝑠</ci><ci id="S6.SS1.SSS1.p3.5.m5.1.1.2.3.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.2.3">𝑗</ci></apply><apply id="S6.SS1.SSS1.p3.5.m5.1.1.3.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3"><times id="S6.SS1.SSS1.p3.5.m5.1.1.3.1.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.1"></times><ci id="S6.SS1.SSS1.p3.5.m5.1.1.3.2.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.2">𝑆</ci><ci id="S6.SS1.SSS1.p3.5.m5.1.1.3.3.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.3">𝑖</ci><ci id="S6.SS1.SSS1.p3.5.m5.1.1.3.4.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.4">𝑑</ci><apply id="S6.SS1.SSS1.p3.5.m5.1.1.3.5.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.5"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p3.5.m5.1.1.3.5.1.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.5">subscript</csymbol><ci id="S6.SS1.SSS1.p3.5.m5.1.1.3.5.2.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.5.2">𝑒</ci><ci id="S6.SS1.SSS1.p3.5.m5.1.1.3.5.3.cmml" xref="S6.SS1.SSS1.p3.5.m5.1.1.3.5.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p3.5.m5.1c">s_{j}\in Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p3.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> is an integer, then it corresponds to <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS1.p3.8.3">one</span> category of the categorical variable, such as the category of the item; if <math alttext="s_{j}\in Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p3.7.m7.1"><semantics id="S6.SS1.SSS1.p3.7.m7.1a"><mrow id="S6.SS1.SSS1.p3.7.m7.1.1" xref="S6.SS1.SSS1.p3.7.m7.1.1.cmml"><msub id="S6.SS1.SSS1.p3.7.m7.1.1.2" xref="S6.SS1.SSS1.p3.7.m7.1.1.2.cmml"><mi id="S6.SS1.SSS1.p3.7.m7.1.1.2.2" xref="S6.SS1.SSS1.p3.7.m7.1.1.2.2.cmml">s</mi><mi id="S6.SS1.SSS1.p3.7.m7.1.1.2.3" xref="S6.SS1.SSS1.p3.7.m7.1.1.2.3.cmml">j</mi></msub><mo id="S6.SS1.SSS1.p3.7.m7.1.1.1" xref="S6.SS1.SSS1.p3.7.m7.1.1.1.cmml">∈</mo><mrow id="S6.SS1.SSS1.p3.7.m7.1.1.3" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.cmml"><mi id="S6.SS1.SSS1.p3.7.m7.1.1.3.2" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.2.cmml">S</mi><mo id="S6.SS1.SSS1.p3.7.m7.1.1.3.1" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.7.m7.1.1.3.3" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.3.cmml">i</mi><mo id="S6.SS1.SSS1.p3.7.m7.1.1.3.1a" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p3.7.m7.1.1.3.4" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.4.cmml">d</mi><mo id="S6.SS1.SSS1.p3.7.m7.1.1.3.1b" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><msub id="S6.SS1.SSS1.p3.7.m7.1.1.3.5" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.5.cmml"><mi id="S6.SS1.SSS1.p3.7.m7.1.1.3.5.2" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.5.2.cmml">e</mi><mi id="S6.SS1.SSS1.p3.7.m7.1.1.3.5.3" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.5.3.cmml">S</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p3.7.m7.1b"><apply id="S6.SS1.SSS1.p3.7.m7.1.1.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1"><in id="S6.SS1.SSS1.p3.7.m7.1.1.1.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.1"></in><apply id="S6.SS1.SSS1.p3.7.m7.1.1.2.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p3.7.m7.1.1.2.1.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS1.p3.7.m7.1.1.2.2.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.2.2">𝑠</ci><ci id="S6.SS1.SSS1.p3.7.m7.1.1.2.3.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.2.3">𝑗</ci></apply><apply id="S6.SS1.SSS1.p3.7.m7.1.1.3.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3"><times id="S6.SS1.SSS1.p3.7.m7.1.1.3.1.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.1"></times><ci id="S6.SS1.SSS1.p3.7.m7.1.1.3.2.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.2">𝑆</ci><ci id="S6.SS1.SSS1.p3.7.m7.1.1.3.3.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.3">𝑖</ci><ci id="S6.SS1.SSS1.p3.7.m7.1.1.3.4.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.4">𝑑</ci><apply id="S6.SS1.SSS1.p3.7.m7.1.1.3.5.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.5"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p3.7.m7.1.1.3.5.1.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.5">subscript</csymbol><ci id="S6.SS1.SSS1.p3.7.m7.1.1.3.5.2.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.5.2">𝑒</ci><ci id="S6.SS1.SSS1.p3.7.m7.1.1.3.5.3.cmml" xref="S6.SS1.SSS1.p3.7.m7.1.1.3.5.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p3.7.m7.1c">s_{j}\in Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p3.7.m7.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> is a set of integer, then it corresponds to <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS1.p3.8.4">multiple</span> categories of the categorical variable, such as the various genres a movie belong to. We will handle these two cases differently.</p>
</div>
<div class="ltx_para" id="S6.SS1.SSS1.p4">
<p class="ltx_p" id="S6.SS1.SSS1.p4.2"><math alttext="\textbf{Case 1: }Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p4.1.m1.1"><semantics id="S6.SS1.SSS1.p4.1.m1.1a"><mrow id="S6.SS1.SSS1.p4.1.m1.1.1" xref="S6.SS1.SSS1.p4.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S6.SS1.SSS1.p4.1.m1.1.1.2" xref="S6.SS1.SSS1.p4.1.m1.1.1.2a.cmml">Case 1: </mtext><mo id="S6.SS1.SSS1.p4.1.m1.1.1.1" xref="S6.SS1.SSS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p4.1.m1.1.1.3" xref="S6.SS1.SSS1.p4.1.m1.1.1.3.cmml">S</mi><mo id="S6.SS1.SSS1.p4.1.m1.1.1.1a" xref="S6.SS1.SSS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p4.1.m1.1.1.4" xref="S6.SS1.SSS1.p4.1.m1.1.1.4.cmml">i</mi><mo id="S6.SS1.SSS1.p4.1.m1.1.1.1b" xref="S6.SS1.SSS1.p4.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p4.1.m1.1.1.5" xref="S6.SS1.SSS1.p4.1.m1.1.1.5.cmml">d</mi><mo id="S6.SS1.SSS1.p4.1.m1.1.1.1c" xref="S6.SS1.SSS1.p4.1.m1.1.1.1.cmml">⁢</mo><msub id="S6.SS1.SSS1.p4.1.m1.1.1.6" xref="S6.SS1.SSS1.p4.1.m1.1.1.6.cmml"><mi id="S6.SS1.SSS1.p4.1.m1.1.1.6.2" xref="S6.SS1.SSS1.p4.1.m1.1.1.6.2.cmml">e</mi><mi id="S6.SS1.SSS1.p4.1.m1.1.1.6.3" xref="S6.SS1.SSS1.p4.1.m1.1.1.6.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p4.1.m1.1b"><apply id="S6.SS1.SSS1.p4.1.m1.1.1.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1"><times id="S6.SS1.SSS1.p4.1.m1.1.1.1.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.1"></times><ci id="S6.SS1.SSS1.p4.1.m1.1.1.2a.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S6.SS1.SSS1.p4.1.m1.1.1.2.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.2">Case 1: </mtext></ci><ci id="S6.SS1.SSS1.p4.1.m1.1.1.3.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.3">𝑆</ci><ci id="S6.SS1.SSS1.p4.1.m1.1.1.4.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.4">𝑖</ci><ci id="S6.SS1.SSS1.p4.1.m1.1.1.5.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.5">𝑑</ci><apply id="S6.SS1.SSS1.p4.1.m1.1.1.6.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.6"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p4.1.m1.1.1.6.1.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.6">subscript</csymbol><ci id="S6.SS1.SSS1.p4.1.m1.1.1.6.2.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.6.2">𝑒</ci><ci id="S6.SS1.SSS1.p4.1.m1.1.1.6.3.cmml" xref="S6.SS1.SSS1.p4.1.m1.1.1.6.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p4.1.m1.1c">\textbf{Case 1: }Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p4.1.m1.1d">Case 1: italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> is a set of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS1.p4.2.1">integers</span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S6.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle z^{s}_{r}" class="ltx_Math" display="inline" id="S6.E5.m1.1"><semantics id="S6.E5.m1.1a"><msubsup id="S6.E5.m1.1.1" xref="S6.E5.m1.1.1.cmml"><mi id="S6.E5.m1.1.1.2.2" xref="S6.E5.m1.1.1.2.2.cmml">z</mi><mi id="S6.E5.m1.1.1.3" xref="S6.E5.m1.1.1.3.cmml">r</mi><mi id="S6.E5.m1.1.1.2.3" xref="S6.E5.m1.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E5.m1.1b"><apply id="S6.E5.m1.1.1.cmml" xref="S6.E5.m1.1.1"><csymbol cd="ambiguous" id="S6.E5.m1.1.1.1.cmml" xref="S6.E5.m1.1.1">subscript</csymbol><apply id="S6.E5.m1.1.1.2.cmml" xref="S6.E5.m1.1.1"><csymbol cd="ambiguous" id="S6.E5.m1.1.1.2.1.cmml" xref="S6.E5.m1.1.1">superscript</csymbol><ci id="S6.E5.m1.1.1.2.2.cmml" xref="S6.E5.m1.1.1.2.2">𝑧</ci><ci id="S6.E5.m1.1.1.2.3.cmml" xref="S6.E5.m1.1.1.2.3">𝑠</ci></apply><ci id="S6.E5.m1.1.1.3.cmml" xref="S6.E5.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E5.m1.1c">\displaystyle z^{s}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E5.m1.1d">italic_z start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W^{s}_{z}[emb(s_{r}),h^{s}_{r-1}])" class="ltx_Math" display="inline" id="S6.E5.m2.1"><semantics id="S6.E5.m2.1a"><mrow id="S6.E5.m2.1.1" xref="S6.E5.m2.1.1.cmml"><mi id="S6.E5.m2.1.1.3" xref="S6.E5.m2.1.1.3.cmml"></mi><mo id="S6.E5.m2.1.1.2" xref="S6.E5.m2.1.1.2.cmml">=</mo><mrow id="S6.E5.m2.1.1.1" xref="S6.E5.m2.1.1.1.cmml"><mi id="S6.E5.m2.1.1.1.3" xref="S6.E5.m2.1.1.1.3.cmml">σ</mi><mo id="S6.E5.m2.1.1.1.2" xref="S6.E5.m2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E5.m2.1.1.1.1.1" xref="S6.E5.m2.1.1.1.1.1.1.cmml"><mo id="S6.E5.m2.1.1.1.1.1.2" stretchy="false" xref="S6.E5.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E5.m2.1.1.1.1.1.1" xref="S6.E5.m2.1.1.1.1.1.1.cmml"><msubsup id="S6.E5.m2.1.1.1.1.1.1.4" xref="S6.E5.m2.1.1.1.1.1.1.4.cmml"><mi id="S6.E5.m2.1.1.1.1.1.1.4.2.2" xref="S6.E5.m2.1.1.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E5.m2.1.1.1.1.1.1.4.3" xref="S6.E5.m2.1.1.1.1.1.1.4.3.cmml">z</mi><mi id="S6.E5.m2.1.1.1.1.1.1.4.2.3" xref="S6.E5.m2.1.1.1.1.1.1.4.2.3.cmml">s</mi></msubsup><mo id="S6.E5.m2.1.1.1.1.1.1.3" xref="S6.E5.m2.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E5.m2.1.1.1.1.1.1.2.2" xref="S6.E5.m2.1.1.1.1.1.1.2.3.cmml"><mo id="S6.E5.m2.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S6.E5.m2.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E5.m2.1.1.1.1.1.1.1.1.1" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E5.m2.1.1.1.1.1.1.1.1.1.3" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S6.E5.m2.1.1.1.1.1.1.1.1.1.2" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E5.m2.1.1.1.1.1.1.1.1.1.4" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="S6.E5.m2.1.1.1.1.1.1.1.1.1.2a" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E5.m2.1.1.1.1.1.1.1.1.1.5" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="S6.E5.m2.1.1.1.1.1.1.1.1.1.2b" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.E5.m2.1.1.1.1.1.1.2.2.4" xref="S6.E5.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S6.E5.m2.1.1.1.1.1.1.2.2.2" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.2" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.2" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.1" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.3" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.3" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.E5.m2.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S6.E5.m2.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E5.m2.1.1.1.1.1.3" stretchy="false" xref="S6.E5.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E5.m2.1b"><apply id="S6.E5.m2.1.1.cmml" xref="S6.E5.m2.1.1"><eq id="S6.E5.m2.1.1.2.cmml" xref="S6.E5.m2.1.1.2"></eq><csymbol cd="latexml" id="S6.E5.m2.1.1.3.cmml" xref="S6.E5.m2.1.1.3">absent</csymbol><apply id="S6.E5.m2.1.1.1.cmml" xref="S6.E5.m2.1.1.1"><times id="S6.E5.m2.1.1.1.2.cmml" xref="S6.E5.m2.1.1.1.2"></times><ci id="S6.E5.m2.1.1.1.3.cmml" xref="S6.E5.m2.1.1.1.3">𝜎</ci><apply id="S6.E5.m2.1.1.1.1.1.1.cmml" xref="S6.E5.m2.1.1.1.1.1"><times id="S6.E5.m2.1.1.1.1.1.1.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.3"></times><apply id="S6.E5.m2.1.1.1.1.1.1.4.cmml" xref="S6.E5.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E5.m2.1.1.1.1.1.1.4.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.4">subscript</csymbol><apply id="S6.E5.m2.1.1.1.1.1.1.4.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E5.m2.1.1.1.1.1.1.4.2.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.4">superscript</csymbol><ci id="S6.E5.m2.1.1.1.1.1.1.4.2.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E5.m2.1.1.1.1.1.1.4.2.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.4.2.3">𝑠</ci></apply><ci id="S6.E5.m2.1.1.1.1.1.1.4.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.4.3">𝑧</ci></apply><interval closure="closed" id="S6.E5.m2.1.1.1.1.1.1.2.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2"><apply id="S6.E5.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1"><times id="S6.E5.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.2"></times><ci id="S6.E5.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S6.E5.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.4">𝑚</ci><ci id="S6.E5.m2.1.1.1.1.1.1.1.1.1.5.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.5">𝑏</ci><apply id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S6.E5.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E5.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><apply id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3"><minus id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S6.E5.m2.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E5.m2.1c">\displaystyle=\sigma(W^{s}_{z}[emb(s_{r}),h^{s}_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E5.m2.1d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S6.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r^{s}_{r}" class="ltx_Math" display="inline" id="S6.E6.m1.1"><semantics id="S6.E6.m1.1a"><msubsup id="S6.E6.m1.1.1" xref="S6.E6.m1.1.1.cmml"><mi id="S6.E6.m1.1.1.2.2" xref="S6.E6.m1.1.1.2.2.cmml">r</mi><mi id="S6.E6.m1.1.1.3" xref="S6.E6.m1.1.1.3.cmml">r</mi><mi id="S6.E6.m1.1.1.2.3" xref="S6.E6.m1.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E6.m1.1b"><apply id="S6.E6.m1.1.1.cmml" xref="S6.E6.m1.1.1"><csymbol cd="ambiguous" id="S6.E6.m1.1.1.1.cmml" xref="S6.E6.m1.1.1">subscript</csymbol><apply id="S6.E6.m1.1.1.2.cmml" xref="S6.E6.m1.1.1"><csymbol cd="ambiguous" id="S6.E6.m1.1.1.2.1.cmml" xref="S6.E6.m1.1.1">superscript</csymbol><ci id="S6.E6.m1.1.1.2.2.cmml" xref="S6.E6.m1.1.1.2.2">𝑟</ci><ci id="S6.E6.m1.1.1.2.3.cmml" xref="S6.E6.m1.1.1.2.3">𝑠</ci></apply><ci id="S6.E6.m1.1.1.3.cmml" xref="S6.E6.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E6.m1.1c">\displaystyle r^{s}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E6.m1.1d">italic_r start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W^{s}_{r}[emb(s_{r}),h^{s}_{r-1}])" class="ltx_Math" display="inline" id="S6.E6.m2.1"><semantics id="S6.E6.m2.1a"><mrow id="S6.E6.m2.1.1" xref="S6.E6.m2.1.1.cmml"><mi id="S6.E6.m2.1.1.3" xref="S6.E6.m2.1.1.3.cmml"></mi><mo id="S6.E6.m2.1.1.2" xref="S6.E6.m2.1.1.2.cmml">=</mo><mrow id="S6.E6.m2.1.1.1" xref="S6.E6.m2.1.1.1.cmml"><mi id="S6.E6.m2.1.1.1.3" xref="S6.E6.m2.1.1.1.3.cmml">σ</mi><mo id="S6.E6.m2.1.1.1.2" xref="S6.E6.m2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E6.m2.1.1.1.1.1" xref="S6.E6.m2.1.1.1.1.1.1.cmml"><mo id="S6.E6.m2.1.1.1.1.1.2" stretchy="false" xref="S6.E6.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E6.m2.1.1.1.1.1.1" xref="S6.E6.m2.1.1.1.1.1.1.cmml"><msubsup id="S6.E6.m2.1.1.1.1.1.1.4" xref="S6.E6.m2.1.1.1.1.1.1.4.cmml"><mi id="S6.E6.m2.1.1.1.1.1.1.4.2.2" xref="S6.E6.m2.1.1.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E6.m2.1.1.1.1.1.1.4.3" xref="S6.E6.m2.1.1.1.1.1.1.4.3.cmml">r</mi><mi id="S6.E6.m2.1.1.1.1.1.1.4.2.3" xref="S6.E6.m2.1.1.1.1.1.1.4.2.3.cmml">s</mi></msubsup><mo id="S6.E6.m2.1.1.1.1.1.1.3" xref="S6.E6.m2.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E6.m2.1.1.1.1.1.1.2.2" xref="S6.E6.m2.1.1.1.1.1.1.2.3.cmml"><mo id="S6.E6.m2.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S6.E6.m2.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E6.m2.1.1.1.1.1.1.1.1.1" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E6.m2.1.1.1.1.1.1.1.1.1.3" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S6.E6.m2.1.1.1.1.1.1.1.1.1.2" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E6.m2.1.1.1.1.1.1.1.1.1.4" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="S6.E6.m2.1.1.1.1.1.1.1.1.1.2a" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E6.m2.1.1.1.1.1.1.1.1.1.5" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="S6.E6.m2.1.1.1.1.1.1.1.1.1.2b" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.E6.m2.1.1.1.1.1.1.2.2.4" xref="S6.E6.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S6.E6.m2.1.1.1.1.1.1.2.2.2" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.2" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.2" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.1" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.3" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.3" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.E6.m2.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S6.E6.m2.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E6.m2.1.1.1.1.1.3" stretchy="false" xref="S6.E6.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E6.m2.1b"><apply id="S6.E6.m2.1.1.cmml" xref="S6.E6.m2.1.1"><eq id="S6.E6.m2.1.1.2.cmml" xref="S6.E6.m2.1.1.2"></eq><csymbol cd="latexml" id="S6.E6.m2.1.1.3.cmml" xref="S6.E6.m2.1.1.3">absent</csymbol><apply id="S6.E6.m2.1.1.1.cmml" xref="S6.E6.m2.1.1.1"><times id="S6.E6.m2.1.1.1.2.cmml" xref="S6.E6.m2.1.1.1.2"></times><ci id="S6.E6.m2.1.1.1.3.cmml" xref="S6.E6.m2.1.1.1.3">𝜎</ci><apply id="S6.E6.m2.1.1.1.1.1.1.cmml" xref="S6.E6.m2.1.1.1.1.1"><times id="S6.E6.m2.1.1.1.1.1.1.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.3"></times><apply id="S6.E6.m2.1.1.1.1.1.1.4.cmml" xref="S6.E6.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E6.m2.1.1.1.1.1.1.4.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.4">subscript</csymbol><apply id="S6.E6.m2.1.1.1.1.1.1.4.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E6.m2.1.1.1.1.1.1.4.2.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.4">superscript</csymbol><ci id="S6.E6.m2.1.1.1.1.1.1.4.2.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E6.m2.1.1.1.1.1.1.4.2.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.4.2.3">𝑠</ci></apply><ci id="S6.E6.m2.1.1.1.1.1.1.4.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.4.3">𝑟</ci></apply><interval closure="closed" id="S6.E6.m2.1.1.1.1.1.1.2.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2"><apply id="S6.E6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1"><times id="S6.E6.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.2"></times><ci id="S6.E6.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S6.E6.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.4">𝑚</ci><ci id="S6.E6.m2.1.1.1.1.1.1.1.1.1.5.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.5">𝑏</ci><apply id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S6.E6.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E6.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><apply id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3"><minus id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S6.E6.m2.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E6.m2.1c">\displaystyle=\sigma(W^{s}_{r}[emb(s_{r}),h^{s}_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E6.m2.1d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S6.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{h^{s}_{r}}" class="ltx_Math" display="inline" id="S6.E7.m1.1"><semantics id="S6.E7.m1.1a"><mover accent="true" id="S6.E7.m1.1.1" xref="S6.E7.m1.1.1.cmml"><msubsup id="S6.E7.m1.1.1.2" xref="S6.E7.m1.1.1.2.cmml"><mi id="S6.E7.m1.1.1.2.2.2" xref="S6.E7.m1.1.1.2.2.2.cmml">h</mi><mi id="S6.E7.m1.1.1.2.3" xref="S6.E7.m1.1.1.2.3.cmml">r</mi><mi id="S6.E7.m1.1.1.2.2.3" xref="S6.E7.m1.1.1.2.2.3.cmml">s</mi></msubsup><mo id="S6.E7.m1.1.1.1" xref="S6.E7.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.E7.m1.1b"><apply id="S6.E7.m1.1.1.cmml" xref="S6.E7.m1.1.1"><ci id="S6.E7.m1.1.1.1.cmml" xref="S6.E7.m1.1.1.1">~</ci><apply id="S6.E7.m1.1.1.2.cmml" xref="S6.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S6.E7.m1.1.1.2.1.cmml" xref="S6.E7.m1.1.1.2">subscript</csymbol><apply id="S6.E7.m1.1.1.2.2.cmml" xref="S6.E7.m1.1.1.2"><csymbol cd="ambiguous" id="S6.E7.m1.1.1.2.2.1.cmml" xref="S6.E7.m1.1.1.2">superscript</csymbol><ci id="S6.E7.m1.1.1.2.2.2.cmml" xref="S6.E7.m1.1.1.2.2.2">ℎ</ci><ci id="S6.E7.m1.1.1.2.2.3.cmml" xref="S6.E7.m1.1.1.2.2.3">𝑠</ci></apply><ci id="S6.E7.m1.1.1.2.3.cmml" xref="S6.E7.m1.1.1.2.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E7.m1.1c">\displaystyle\tilde{h^{s}_{r}}</annotation><annotation encoding="application/x-llamapun" id="S6.E7.m1.1d">over~ start_ARG italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\tanh(W^{s}_{h}[emb(s_{r}),r^{s}_{r}\odot h^{s}_{r-1}])" class="ltx_Math" display="inline" id="S6.E7.m2.2"><semantics id="S6.E7.m2.2a"><mrow id="S6.E7.m2.2.2" xref="S6.E7.m2.2.2.cmml"><mi id="S6.E7.m2.2.2.3" xref="S6.E7.m2.2.2.3.cmml"></mi><mo id="S6.E7.m2.2.2.2" xref="S6.E7.m2.2.2.2.cmml">=</mo><mrow id="S6.E7.m2.2.2.1.1" xref="S6.E7.m2.2.2.1.2.cmml"><mi id="S6.E7.m2.1.1" xref="S6.E7.m2.1.1.cmml">tanh</mi><mo id="S6.E7.m2.2.2.1.1a" xref="S6.E7.m2.2.2.1.2.cmml">⁡</mo><mrow id="S6.E7.m2.2.2.1.1.1" xref="S6.E7.m2.2.2.1.2.cmml"><mo id="S6.E7.m2.2.2.1.1.1.2" stretchy="false" xref="S6.E7.m2.2.2.1.2.cmml">(</mo><mrow id="S6.E7.m2.2.2.1.1.1.1" xref="S6.E7.m2.2.2.1.1.1.1.cmml"><msubsup id="S6.E7.m2.2.2.1.1.1.1.4" xref="S6.E7.m2.2.2.1.1.1.1.4.cmml"><mi id="S6.E7.m2.2.2.1.1.1.1.4.2.2" xref="S6.E7.m2.2.2.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E7.m2.2.2.1.1.1.1.4.3" xref="S6.E7.m2.2.2.1.1.1.1.4.3.cmml">h</mi><mi id="S6.E7.m2.2.2.1.1.1.1.4.2.3" xref="S6.E7.m2.2.2.1.1.1.1.4.2.3.cmml">s</mi></msubsup><mo id="S6.E7.m2.2.2.1.1.1.1.3" xref="S6.E7.m2.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E7.m2.2.2.1.1.1.1.2.2" xref="S6.E7.m2.2.2.1.1.1.1.2.3.cmml"><mo id="S6.E7.m2.2.2.1.1.1.1.2.2.3" stretchy="false" xref="S6.E7.m2.2.2.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E7.m2.2.2.1.1.1.1.1.1.1" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S6.E7.m2.2.2.1.1.1.1.1.1.1.3" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S6.E7.m2.2.2.1.1.1.1.1.1.1.2" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E7.m2.2.2.1.1.1.1.1.1.1.4" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="S6.E7.m2.2.2.1.1.1.1.1.1.1.2a" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S6.E7.m2.2.2.1.1.1.1.1.1.1.5" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="S6.E7.m2.2.2.1.1.1.1.1.1.1.2b" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.E7.m2.2.2.1.1.1.1.2.2.4" xref="S6.E7.m2.2.2.1.1.1.1.2.3.cmml">,</mo><mrow id="S6.E7.m2.2.2.1.1.1.1.2.2.2" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.cmml"><msubsup id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.2" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.2.cmml">r</mi><mi id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.3" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.3.cmml">r</mi><mi id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.3" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.E7.m2.2.2.1.1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.1.cmml">⊙</mo><msubsup id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.2" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.2.cmml">h</mi><mrow id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.cmml"><mi id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.2" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml">r</mi><mo id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.1" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.3" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow><mi id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.3" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.3.cmml">s</mi></msubsup></mrow><mo id="S6.E7.m2.2.2.1.1.1.1.2.2.5" stretchy="false" xref="S6.E7.m2.2.2.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E7.m2.2.2.1.1.1.3" stretchy="false" xref="S6.E7.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E7.m2.2b"><apply id="S6.E7.m2.2.2.cmml" xref="S6.E7.m2.2.2"><eq id="S6.E7.m2.2.2.2.cmml" xref="S6.E7.m2.2.2.2"></eq><csymbol cd="latexml" id="S6.E7.m2.2.2.3.cmml" xref="S6.E7.m2.2.2.3">absent</csymbol><apply id="S6.E7.m2.2.2.1.2.cmml" xref="S6.E7.m2.2.2.1.1"><tanh id="S6.E7.m2.1.1.cmml" xref="S6.E7.m2.1.1"></tanh><apply id="S6.E7.m2.2.2.1.1.1.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1"><times id="S6.E7.m2.2.2.1.1.1.1.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.3"></times><apply id="S6.E7.m2.2.2.1.1.1.1.4.cmml" xref="S6.E7.m2.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E7.m2.2.2.1.1.1.1.4.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.4">subscript</csymbol><apply id="S6.E7.m2.2.2.1.1.1.1.4.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E7.m2.2.2.1.1.1.1.4.2.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.4">superscript</csymbol><ci id="S6.E7.m2.2.2.1.1.1.1.4.2.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E7.m2.2.2.1.1.1.1.4.2.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.4.2.3">𝑠</ci></apply><ci id="S6.E7.m2.2.2.1.1.1.1.4.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.4.3">ℎ</ci></apply><interval closure="closed" id="S6.E7.m2.2.2.1.1.1.1.2.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2"><apply id="S6.E7.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1"><times id="S6.E7.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.2"></times><ci id="S6.E7.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S6.E7.m2.2.2.1.1.1.1.1.1.1.4.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.4">𝑚</ci><ci id="S6.E7.m2.2.2.1.1.1.1.1.1.1.5.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.5">𝑏</ci><apply id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="S6.E7.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S6.E7.m2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.1">direct-product</csymbol><apply id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.2">𝑟</ci><ci id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.2.3">𝑠</ci></apply><ci id="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.2.3">𝑟</ci></apply><apply id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3">subscript</csymbol><apply id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3">superscript</csymbol><ci id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.2">ℎ</ci><ci id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.2.3">𝑠</ci></apply><apply id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3"><minus id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.1"></minus><ci id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.2">𝑟</ci><cn id="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S6.E7.m2.2.2.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E7.m2.2c">\displaystyle=\tanh(W^{s}_{h}[emb(s_{r}),r^{s}_{r}\odot h^{s}_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E7.m2.2d">= roman_tanh ( italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_r start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S6.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h^{s}_{r}" class="ltx_Math" display="inline" id="S6.E8.m1.1"><semantics id="S6.E8.m1.1a"><msubsup id="S6.E8.m1.1.1" xref="S6.E8.m1.1.1.cmml"><mi id="S6.E8.m1.1.1.2.2" xref="S6.E8.m1.1.1.2.2.cmml">h</mi><mi id="S6.E8.m1.1.1.3" xref="S6.E8.m1.1.1.3.cmml">r</mi><mi id="S6.E8.m1.1.1.2.3" xref="S6.E8.m1.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E8.m1.1b"><apply id="S6.E8.m1.1.1.cmml" xref="S6.E8.m1.1.1"><csymbol cd="ambiguous" id="S6.E8.m1.1.1.1.cmml" xref="S6.E8.m1.1.1">subscript</csymbol><apply id="S6.E8.m1.1.1.2.cmml" xref="S6.E8.m1.1.1"><csymbol cd="ambiguous" id="S6.E8.m1.1.1.2.1.cmml" xref="S6.E8.m1.1.1">superscript</csymbol><ci id="S6.E8.m1.1.1.2.2.cmml" xref="S6.E8.m1.1.1.2.2">ℎ</ci><ci id="S6.E8.m1.1.1.2.3.cmml" xref="S6.E8.m1.1.1.2.3">𝑠</ci></apply><ci id="S6.E8.m1.1.1.3.cmml" xref="S6.E8.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E8.m1.1c">\displaystyle h^{s}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E8.m1.1d">italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(1-z^{s}_{r})\odot h^{s}_{r-1}+z^{s}_{r}\odot\tilde{h^{s}_{r}}" class="ltx_Math" display="inline" id="S6.E8.m2.1"><semantics id="S6.E8.m2.1a"><mrow id="S6.E8.m2.1.1" xref="S6.E8.m2.1.1.cmml"><mi id="S6.E8.m2.1.1.3" xref="S6.E8.m2.1.1.3.cmml"></mi><mo id="S6.E8.m2.1.1.2" xref="S6.E8.m2.1.1.2.cmml">=</mo><mrow id="S6.E8.m2.1.1.1" xref="S6.E8.m2.1.1.1.cmml"><mrow id="S6.E8.m2.1.1.1.1" xref="S6.E8.m2.1.1.1.1.cmml"><mrow id="S6.E8.m2.1.1.1.1.1.1" xref="S6.E8.m2.1.1.1.1.1.1.1.cmml"><mo id="S6.E8.m2.1.1.1.1.1.1.2" stretchy="false" xref="S6.E8.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E8.m2.1.1.1.1.1.1.1" xref="S6.E8.m2.1.1.1.1.1.1.1.cmml"><mn id="S6.E8.m2.1.1.1.1.1.1.1.2" xref="S6.E8.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S6.E8.m2.1.1.1.1.1.1.1.1" xref="S6.E8.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S6.E8.m2.1.1.1.1.1.1.1.3" xref="S6.E8.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S6.E8.m2.1.1.1.1.1.1.1.3.2.2" xref="S6.E8.m2.1.1.1.1.1.1.1.3.2.2.cmml">z</mi><mi id="S6.E8.m2.1.1.1.1.1.1.1.3.3" xref="S6.E8.m2.1.1.1.1.1.1.1.3.3.cmml">r</mi><mi id="S6.E8.m2.1.1.1.1.1.1.1.3.2.3" xref="S6.E8.m2.1.1.1.1.1.1.1.3.2.3.cmml">s</mi></msubsup></mrow><mo id="S6.E8.m2.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S6.E8.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S6.E8.m2.1.1.1.1.2" rspace="0.222em" xref="S6.E8.m2.1.1.1.1.2.cmml">⊙</mo><msubsup id="S6.E8.m2.1.1.1.1.3" xref="S6.E8.m2.1.1.1.1.3.cmml"><mi id="S6.E8.m2.1.1.1.1.3.2.2" xref="S6.E8.m2.1.1.1.1.3.2.2.cmml">h</mi><mrow id="S6.E8.m2.1.1.1.1.3.3" xref="S6.E8.m2.1.1.1.1.3.3.cmml"><mi id="S6.E8.m2.1.1.1.1.3.3.2" xref="S6.E8.m2.1.1.1.1.3.3.2.cmml">r</mi><mo id="S6.E8.m2.1.1.1.1.3.3.1" xref="S6.E8.m2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S6.E8.m2.1.1.1.1.3.3.3" xref="S6.E8.m2.1.1.1.1.3.3.3.cmml">1</mn></mrow><mi id="S6.E8.m2.1.1.1.1.3.2.3" xref="S6.E8.m2.1.1.1.1.3.2.3.cmml">s</mi></msubsup></mrow><mo id="S6.E8.m2.1.1.1.2" xref="S6.E8.m2.1.1.1.2.cmml">+</mo><mrow id="S6.E8.m2.1.1.1.3" xref="S6.E8.m2.1.1.1.3.cmml"><msubsup id="S6.E8.m2.1.1.1.3.2" xref="S6.E8.m2.1.1.1.3.2.cmml"><mi id="S6.E8.m2.1.1.1.3.2.2.2" xref="S6.E8.m2.1.1.1.3.2.2.2.cmml">z</mi><mi id="S6.E8.m2.1.1.1.3.2.3" xref="S6.E8.m2.1.1.1.3.2.3.cmml">r</mi><mi id="S6.E8.m2.1.1.1.3.2.2.3" xref="S6.E8.m2.1.1.1.3.2.2.3.cmml">s</mi></msubsup><mo id="S6.E8.m2.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.E8.m2.1.1.1.3.1.cmml">⊙</mo><mover accent="true" id="S6.E8.m2.1.1.1.3.3" xref="S6.E8.m2.1.1.1.3.3.cmml"><msubsup id="S6.E8.m2.1.1.1.3.3.2" xref="S6.E8.m2.1.1.1.3.3.2.cmml"><mi id="S6.E8.m2.1.1.1.3.3.2.2.2" xref="S6.E8.m2.1.1.1.3.3.2.2.2.cmml">h</mi><mi id="S6.E8.m2.1.1.1.3.3.2.3" xref="S6.E8.m2.1.1.1.3.3.2.3.cmml">r</mi><mi id="S6.E8.m2.1.1.1.3.3.2.2.3" xref="S6.E8.m2.1.1.1.3.3.2.2.3.cmml">s</mi></msubsup><mo id="S6.E8.m2.1.1.1.3.3.1" xref="S6.E8.m2.1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E8.m2.1b"><apply id="S6.E8.m2.1.1.cmml" xref="S6.E8.m2.1.1"><eq id="S6.E8.m2.1.1.2.cmml" xref="S6.E8.m2.1.1.2"></eq><csymbol cd="latexml" id="S6.E8.m2.1.1.3.cmml" xref="S6.E8.m2.1.1.3">absent</csymbol><apply id="S6.E8.m2.1.1.1.cmml" xref="S6.E8.m2.1.1.1"><plus id="S6.E8.m2.1.1.1.2.cmml" xref="S6.E8.m2.1.1.1.2"></plus><apply id="S6.E8.m2.1.1.1.1.cmml" xref="S6.E8.m2.1.1.1.1"><csymbol cd="latexml" id="S6.E8.m2.1.1.1.1.2.cmml" xref="S6.E8.m2.1.1.1.1.2">direct-product</csymbol><apply id="S6.E8.m2.1.1.1.1.1.1.1.cmml" xref="S6.E8.m2.1.1.1.1.1.1"><minus id="S6.E8.m2.1.1.1.1.1.1.1.1.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.1"></minus><cn id="S6.E8.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S6.E8.m2.1.1.1.1.1.1.1.2">1</cn><apply id="S6.E8.m2.1.1.1.1.1.1.1.3.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S6.E8.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S6.E8.m2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.3.2.2">𝑧</ci><ci id="S6.E8.m2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.3.2.3">𝑠</ci></apply><ci id="S6.E8.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S6.E8.m2.1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><apply id="S6.E8.m2.1.1.1.1.3.cmml" xref="S6.E8.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.1.3.1.cmml" xref="S6.E8.m2.1.1.1.1.3">subscript</csymbol><apply id="S6.E8.m2.1.1.1.1.3.2.cmml" xref="S6.E8.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.1.3.2.1.cmml" xref="S6.E8.m2.1.1.1.1.3">superscript</csymbol><ci id="S6.E8.m2.1.1.1.1.3.2.2.cmml" xref="S6.E8.m2.1.1.1.1.3.2.2">ℎ</ci><ci id="S6.E8.m2.1.1.1.1.3.2.3.cmml" xref="S6.E8.m2.1.1.1.1.3.2.3">𝑠</ci></apply><apply id="S6.E8.m2.1.1.1.1.3.3.cmml" xref="S6.E8.m2.1.1.1.1.3.3"><minus id="S6.E8.m2.1.1.1.1.3.3.1.cmml" xref="S6.E8.m2.1.1.1.1.3.3.1"></minus><ci id="S6.E8.m2.1.1.1.1.3.3.2.cmml" xref="S6.E8.m2.1.1.1.1.3.3.2">𝑟</ci><cn id="S6.E8.m2.1.1.1.1.3.3.3.cmml" type="integer" xref="S6.E8.m2.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S6.E8.m2.1.1.1.3.cmml" xref="S6.E8.m2.1.1.1.3"><csymbol cd="latexml" id="S6.E8.m2.1.1.1.3.1.cmml" xref="S6.E8.m2.1.1.1.3.1">direct-product</csymbol><apply id="S6.E8.m2.1.1.1.3.2.cmml" xref="S6.E8.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.3.2.1.cmml" xref="S6.E8.m2.1.1.1.3.2">subscript</csymbol><apply id="S6.E8.m2.1.1.1.3.2.2.cmml" xref="S6.E8.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.3.2.2.1.cmml" xref="S6.E8.m2.1.1.1.3.2">superscript</csymbol><ci id="S6.E8.m2.1.1.1.3.2.2.2.cmml" xref="S6.E8.m2.1.1.1.3.2.2.2">𝑧</ci><ci id="S6.E8.m2.1.1.1.3.2.2.3.cmml" xref="S6.E8.m2.1.1.1.3.2.2.3">𝑠</ci></apply><ci id="S6.E8.m2.1.1.1.3.2.3.cmml" xref="S6.E8.m2.1.1.1.3.2.3">𝑟</ci></apply><apply id="S6.E8.m2.1.1.1.3.3.cmml" xref="S6.E8.m2.1.1.1.3.3"><ci id="S6.E8.m2.1.1.1.3.3.1.cmml" xref="S6.E8.m2.1.1.1.3.3.1">~</ci><apply id="S6.E8.m2.1.1.1.3.3.2.cmml" xref="S6.E8.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.3.3.2.1.cmml" xref="S6.E8.m2.1.1.1.3.3.2">subscript</csymbol><apply id="S6.E8.m2.1.1.1.3.3.2.2.cmml" xref="S6.E8.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S6.E8.m2.1.1.1.3.3.2.2.1.cmml" xref="S6.E8.m2.1.1.1.3.3.2">superscript</csymbol><ci id="S6.E8.m2.1.1.1.3.3.2.2.2.cmml" xref="S6.E8.m2.1.1.1.3.3.2.2.2">ℎ</ci><ci id="S6.E8.m2.1.1.1.3.3.2.2.3.cmml" xref="S6.E8.m2.1.1.1.3.3.2.2.3">𝑠</ci></apply><ci id="S6.E8.m2.1.1.1.3.3.2.3.cmml" xref="S6.E8.m2.1.1.1.3.3.2.3">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E8.m2.1c">\displaystyle=(1-z^{s}_{r})\odot h^{s}_{r-1}+z^{s}_{r}\odot\tilde{h^{s}_{r}}</annotation><annotation encoding="application/x-llamapun" id="S6.E8.m2.1d">= ( 1 - italic_z start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ⊙ italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT + italic_z start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ over~ start_ARG italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S6.SS1.SSS1.p5">
<p class="ltx_p" id="S6.SS1.SSS1.p5.2"><math alttext="\textbf{Case 2: }Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p5.1.m1.1"><semantics id="S6.SS1.SSS1.p5.1.m1.1a"><mrow id="S6.SS1.SSS1.p5.1.m1.1.1" xref="S6.SS1.SSS1.p5.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S6.SS1.SSS1.p5.1.m1.1.1.2" xref="S6.SS1.SSS1.p5.1.m1.1.1.2a.cmml">Case 2: </mtext><mo id="S6.SS1.SSS1.p5.1.m1.1.1.1" xref="S6.SS1.SSS1.p5.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p5.1.m1.1.1.3" xref="S6.SS1.SSS1.p5.1.m1.1.1.3.cmml">S</mi><mo id="S6.SS1.SSS1.p5.1.m1.1.1.1a" xref="S6.SS1.SSS1.p5.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p5.1.m1.1.1.4" xref="S6.SS1.SSS1.p5.1.m1.1.1.4.cmml">i</mi><mo id="S6.SS1.SSS1.p5.1.m1.1.1.1b" xref="S6.SS1.SSS1.p5.1.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p5.1.m1.1.1.5" xref="S6.SS1.SSS1.p5.1.m1.1.1.5.cmml">d</mi><mo id="S6.SS1.SSS1.p5.1.m1.1.1.1c" xref="S6.SS1.SSS1.p5.1.m1.1.1.1.cmml">⁢</mo><msub id="S6.SS1.SSS1.p5.1.m1.1.1.6" xref="S6.SS1.SSS1.p5.1.m1.1.1.6.cmml"><mi id="S6.SS1.SSS1.p5.1.m1.1.1.6.2" xref="S6.SS1.SSS1.p5.1.m1.1.1.6.2.cmml">e</mi><mi id="S6.SS1.SSS1.p5.1.m1.1.1.6.3" xref="S6.SS1.SSS1.p5.1.m1.1.1.6.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p5.1.m1.1b"><apply id="S6.SS1.SSS1.p5.1.m1.1.1.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1"><times id="S6.SS1.SSS1.p5.1.m1.1.1.1.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.1"></times><ci id="S6.SS1.SSS1.p5.1.m1.1.1.2a.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S6.SS1.SSS1.p5.1.m1.1.1.2.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.2">Case 2: </mtext></ci><ci id="S6.SS1.SSS1.p5.1.m1.1.1.3.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.3">𝑆</ci><ci id="S6.SS1.SSS1.p5.1.m1.1.1.4.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.4">𝑖</ci><ci id="S6.SS1.SSS1.p5.1.m1.1.1.5.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.5">𝑑</ci><apply id="S6.SS1.SSS1.p5.1.m1.1.1.6.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.6"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p5.1.m1.1.1.6.1.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.6">subscript</csymbol><ci id="S6.SS1.SSS1.p5.1.m1.1.1.6.2.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.6.2">𝑒</ci><ci id="S6.SS1.SSS1.p5.1.m1.1.1.6.3.cmml" xref="S6.SS1.SSS1.p5.1.m1.1.1.6.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p5.1.m1.1c">\textbf{Case 2: }Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p5.1.m1.1d">Case 2: italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> is a set of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS1.p5.2.1">set of integers</span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S6.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle z^{s}_{r}" class="ltx_Math" display="inline" id="S6.E9.m1.1"><semantics id="S6.E9.m1.1a"><msubsup id="S6.E9.m1.1.1" xref="S6.E9.m1.1.1.cmml"><mi id="S6.E9.m1.1.1.2.2" xref="S6.E9.m1.1.1.2.2.cmml">z</mi><mi id="S6.E9.m1.1.1.3" xref="S6.E9.m1.1.1.3.cmml">r</mi><mi id="S6.E9.m1.1.1.2.3" xref="S6.E9.m1.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E9.m1.1b"><apply id="S6.E9.m1.1.1.cmml" xref="S6.E9.m1.1.1"><csymbol cd="ambiguous" id="S6.E9.m1.1.1.1.cmml" xref="S6.E9.m1.1.1">subscript</csymbol><apply id="S6.E9.m1.1.1.2.cmml" xref="S6.E9.m1.1.1"><csymbol cd="ambiguous" id="S6.E9.m1.1.1.2.1.cmml" xref="S6.E9.m1.1.1">superscript</csymbol><ci id="S6.E9.m1.1.1.2.2.cmml" xref="S6.E9.m1.1.1.2.2">𝑧</ci><ci id="S6.E9.m1.1.1.2.3.cmml" xref="S6.E9.m1.1.1.2.3">𝑠</ci></apply><ci id="S6.E9.m1.1.1.3.cmml" xref="S6.E9.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E9.m1.1c">\displaystyle z^{s}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E9.m1.1d">italic_z start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W^{s}_{z}[\sum_{c\in s_{r}}\frac{emb(c)}{|s_{r}|},h^{s}_{%
r-1}])" class="ltx_Math" display="inline" id="S6.E9.m2.3"><semantics id="S6.E9.m2.3a"><mrow id="S6.E9.m2.3.3" xref="S6.E9.m2.3.3.cmml"><mi id="S6.E9.m2.3.3.3" xref="S6.E9.m2.3.3.3.cmml"></mi><mo id="S6.E9.m2.3.3.2" xref="S6.E9.m2.3.3.2.cmml">=</mo><mrow id="S6.E9.m2.3.3.1" xref="S6.E9.m2.3.3.1.cmml"><mi id="S6.E9.m2.3.3.1.3" xref="S6.E9.m2.3.3.1.3.cmml">σ</mi><mo id="S6.E9.m2.3.3.1.2" xref="S6.E9.m2.3.3.1.2.cmml">⁢</mo><mrow id="S6.E9.m2.3.3.1.1.1" xref="S6.E9.m2.3.3.1.1.1.1.cmml"><mo id="S6.E9.m2.3.3.1.1.1.2" stretchy="false" xref="S6.E9.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S6.E9.m2.3.3.1.1.1.1" xref="S6.E9.m2.3.3.1.1.1.1.cmml"><msubsup id="S6.E9.m2.3.3.1.1.1.1.4" xref="S6.E9.m2.3.3.1.1.1.1.4.cmml"><mi id="S6.E9.m2.3.3.1.1.1.1.4.2.2" xref="S6.E9.m2.3.3.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E9.m2.3.3.1.1.1.1.4.3" xref="S6.E9.m2.3.3.1.1.1.1.4.3.cmml">z</mi><mi id="S6.E9.m2.3.3.1.1.1.1.4.2.3" xref="S6.E9.m2.3.3.1.1.1.1.4.2.3.cmml">s</mi></msubsup><mo id="S6.E9.m2.3.3.1.1.1.1.3" xref="S6.E9.m2.3.3.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E9.m2.3.3.1.1.1.1.2.2" xref="S6.E9.m2.3.3.1.1.1.1.2.3.cmml"><mo id="S6.E9.m2.3.3.1.1.1.1.2.2.3" stretchy="false" xref="S6.E9.m2.3.3.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E9.m2.3.3.1.1.1.1.1.1.1" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml"><munder id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1a" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.2" movablelimits="false" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.2" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.1" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mi id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow></munder></mstyle><mstyle displaystyle="true" id="S6.E9.m2.2.2" xref="S6.E9.m2.2.2.cmml"><mfrac id="S6.E9.m2.2.2a" xref="S6.E9.m2.2.2.cmml"><mrow id="S6.E9.m2.1.1.1" xref="S6.E9.m2.1.1.1.cmml"><mi id="S6.E9.m2.1.1.1.3" xref="S6.E9.m2.1.1.1.3.cmml">e</mi><mo id="S6.E9.m2.1.1.1.2" xref="S6.E9.m2.1.1.1.2.cmml">⁢</mo><mi id="S6.E9.m2.1.1.1.4" xref="S6.E9.m2.1.1.1.4.cmml">m</mi><mo id="S6.E9.m2.1.1.1.2a" xref="S6.E9.m2.1.1.1.2.cmml">⁢</mo><mi id="S6.E9.m2.1.1.1.5" xref="S6.E9.m2.1.1.1.5.cmml">b</mi><mo id="S6.E9.m2.1.1.1.2b" xref="S6.E9.m2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E9.m2.1.1.1.6.2" xref="S6.E9.m2.1.1.1.cmml"><mo id="S6.E9.m2.1.1.1.6.2.1" stretchy="false" xref="S6.E9.m2.1.1.1.cmml">(</mo><mi id="S6.E9.m2.1.1.1.1" xref="S6.E9.m2.1.1.1.1.cmml">c</mi><mo id="S6.E9.m2.1.1.1.6.2.2" stretchy="false" xref="S6.E9.m2.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S6.E9.m2.2.2.2.1" xref="S6.E9.m2.2.2.2.2.cmml"><mo id="S6.E9.m2.2.2.2.1.2" stretchy="false" xref="S6.E9.m2.2.2.2.2.1.cmml">|</mo><msub id="S6.E9.m2.2.2.2.1.1" xref="S6.E9.m2.2.2.2.1.1.cmml"><mi id="S6.E9.m2.2.2.2.1.1.2" xref="S6.E9.m2.2.2.2.1.1.2.cmml">s</mi><mi id="S6.E9.m2.2.2.2.1.1.3" xref="S6.E9.m2.2.2.2.1.1.3.cmml">r</mi></msub><mo id="S6.E9.m2.2.2.2.1.3" stretchy="false" xref="S6.E9.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S6.E9.m2.3.3.1.1.1.1.2.2.4" xref="S6.E9.m2.3.3.1.1.1.1.2.3.cmml">,</mo><msubsup id="S6.E9.m2.3.3.1.1.1.1.2.2.2" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.cmml"><mi id="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.2" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.2" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.1" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.3" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.3" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.E9.m2.3.3.1.1.1.1.2.2.5" stretchy="false" xref="S6.E9.m2.3.3.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E9.m2.3.3.1.1.1.3" stretchy="false" xref="S6.E9.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E9.m2.3b"><apply id="S6.E9.m2.3.3.cmml" xref="S6.E9.m2.3.3"><eq id="S6.E9.m2.3.3.2.cmml" xref="S6.E9.m2.3.3.2"></eq><csymbol cd="latexml" id="S6.E9.m2.3.3.3.cmml" xref="S6.E9.m2.3.3.3">absent</csymbol><apply id="S6.E9.m2.3.3.1.cmml" xref="S6.E9.m2.3.3.1"><times id="S6.E9.m2.3.3.1.2.cmml" xref="S6.E9.m2.3.3.1.2"></times><ci id="S6.E9.m2.3.3.1.3.cmml" xref="S6.E9.m2.3.3.1.3">𝜎</ci><apply id="S6.E9.m2.3.3.1.1.1.1.cmml" xref="S6.E9.m2.3.3.1.1.1"><times id="S6.E9.m2.3.3.1.1.1.1.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.3"></times><apply id="S6.E9.m2.3.3.1.1.1.1.4.cmml" xref="S6.E9.m2.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E9.m2.3.3.1.1.1.1.4.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.4">subscript</csymbol><apply id="S6.E9.m2.3.3.1.1.1.1.4.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E9.m2.3.3.1.1.1.1.4.2.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.4">superscript</csymbol><ci id="S6.E9.m2.3.3.1.1.1.1.4.2.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E9.m2.3.3.1.1.1.1.4.2.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.4.2.3">𝑠</ci></apply><ci id="S6.E9.m2.3.3.1.1.1.1.4.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.4.3">𝑧</ci></apply><interval closure="closed" id="S6.E9.m2.3.3.1.1.1.1.2.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2"><apply id="S6.E9.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1"><apply id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.2"></sum><apply id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3"><in id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.1"></in><ci id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.2">𝑐</ci><apply id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S6.E9.m2.2.2.cmml" xref="S6.E9.m2.2.2"><divide id="S6.E9.m2.2.2.3.cmml" xref="S6.E9.m2.2.2"></divide><apply id="S6.E9.m2.1.1.1.cmml" xref="S6.E9.m2.1.1.1"><times id="S6.E9.m2.1.1.1.2.cmml" xref="S6.E9.m2.1.1.1.2"></times><ci id="S6.E9.m2.1.1.1.3.cmml" xref="S6.E9.m2.1.1.1.3">𝑒</ci><ci id="S6.E9.m2.1.1.1.4.cmml" xref="S6.E9.m2.1.1.1.4">𝑚</ci><ci id="S6.E9.m2.1.1.1.5.cmml" xref="S6.E9.m2.1.1.1.5">𝑏</ci><ci id="S6.E9.m2.1.1.1.1.cmml" xref="S6.E9.m2.1.1.1.1">𝑐</ci></apply><apply id="S6.E9.m2.2.2.2.2.cmml" xref="S6.E9.m2.2.2.2.1"><abs id="S6.E9.m2.2.2.2.2.1.cmml" xref="S6.E9.m2.2.2.2.1.2"></abs><apply id="S6.E9.m2.2.2.2.1.1.cmml" xref="S6.E9.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S6.E9.m2.2.2.2.1.1.1.cmml" xref="S6.E9.m2.2.2.2.1.1">subscript</csymbol><ci id="S6.E9.m2.2.2.2.1.1.2.cmml" xref="S6.E9.m2.2.2.2.1.1.2">𝑠</ci><ci id="S6.E9.m2.2.2.2.1.1.3.cmml" xref="S6.E9.m2.2.2.2.1.1.3">𝑟</ci></apply></apply></apply></apply><apply id="S6.E9.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E9.m2.3.3.1.1.1.1.2.2.2.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2">subscript</csymbol><apply id="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2">superscript</csymbol><ci id="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><apply id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3"><minus id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.1"></minus><ci id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S6.E9.m2.3.3.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E9.m2.3c">\displaystyle=\sigma(W^{s}_{z}[\sum_{c\in s_{r}}\frac{emb(c)}{|s_{r}|},h^{s}_{%
r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E9.m2.3d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_c ∈ italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG italic_e italic_m italic_b ( italic_c ) end_ARG start_ARG | italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT | end_ARG , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S6.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r^{s}_{r}" class="ltx_Math" display="inline" id="S6.E10.m1.1"><semantics id="S6.E10.m1.1a"><msubsup id="S6.E10.m1.1.1" xref="S6.E10.m1.1.1.cmml"><mi id="S6.E10.m1.1.1.2.2" xref="S6.E10.m1.1.1.2.2.cmml">r</mi><mi id="S6.E10.m1.1.1.3" xref="S6.E10.m1.1.1.3.cmml">r</mi><mi id="S6.E10.m1.1.1.2.3" xref="S6.E10.m1.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E10.m1.1b"><apply id="S6.E10.m1.1.1.cmml" xref="S6.E10.m1.1.1"><csymbol cd="ambiguous" id="S6.E10.m1.1.1.1.cmml" xref="S6.E10.m1.1.1">subscript</csymbol><apply id="S6.E10.m1.1.1.2.cmml" xref="S6.E10.m1.1.1"><csymbol cd="ambiguous" id="S6.E10.m1.1.1.2.1.cmml" xref="S6.E10.m1.1.1">superscript</csymbol><ci id="S6.E10.m1.1.1.2.2.cmml" xref="S6.E10.m1.1.1.2.2">𝑟</ci><ci id="S6.E10.m1.1.1.2.3.cmml" xref="S6.E10.m1.1.1.2.3">𝑠</ci></apply><ci id="S6.E10.m1.1.1.3.cmml" xref="S6.E10.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E10.m1.1c">\displaystyle r^{s}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E10.m1.1d">italic_r start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W^{s}_{r}[\sum_{c\in s_{r}}\frac{emb(c)}{|s_{r}|},h^{s}_{%
r-1}])" class="ltx_Math" display="inline" id="S6.E10.m2.3"><semantics id="S6.E10.m2.3a"><mrow id="S6.E10.m2.3.3" xref="S6.E10.m2.3.3.cmml"><mi id="S6.E10.m2.3.3.3" xref="S6.E10.m2.3.3.3.cmml"></mi><mo id="S6.E10.m2.3.3.2" xref="S6.E10.m2.3.3.2.cmml">=</mo><mrow id="S6.E10.m2.3.3.1" xref="S6.E10.m2.3.3.1.cmml"><mi id="S6.E10.m2.3.3.1.3" xref="S6.E10.m2.3.3.1.3.cmml">σ</mi><mo id="S6.E10.m2.3.3.1.2" xref="S6.E10.m2.3.3.1.2.cmml">⁢</mo><mrow id="S6.E10.m2.3.3.1.1.1" xref="S6.E10.m2.3.3.1.1.1.1.cmml"><mo id="S6.E10.m2.3.3.1.1.1.2" stretchy="false" xref="S6.E10.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S6.E10.m2.3.3.1.1.1.1" xref="S6.E10.m2.3.3.1.1.1.1.cmml"><msubsup id="S6.E10.m2.3.3.1.1.1.1.4" xref="S6.E10.m2.3.3.1.1.1.1.4.cmml"><mi id="S6.E10.m2.3.3.1.1.1.1.4.2.2" xref="S6.E10.m2.3.3.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E10.m2.3.3.1.1.1.1.4.3" xref="S6.E10.m2.3.3.1.1.1.1.4.3.cmml">r</mi><mi id="S6.E10.m2.3.3.1.1.1.1.4.2.3" xref="S6.E10.m2.3.3.1.1.1.1.4.2.3.cmml">s</mi></msubsup><mo id="S6.E10.m2.3.3.1.1.1.1.3" xref="S6.E10.m2.3.3.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E10.m2.3.3.1.1.1.1.2.2" xref="S6.E10.m2.3.3.1.1.1.1.2.3.cmml"><mo id="S6.E10.m2.3.3.1.1.1.1.2.2.3" stretchy="false" xref="S6.E10.m2.3.3.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E10.m2.3.3.1.1.1.1.1.1.1" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml"><munder id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1a" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.2" movablelimits="false" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.1" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mi id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow></munder></mstyle><mstyle displaystyle="true" id="S6.E10.m2.2.2" xref="S6.E10.m2.2.2.cmml"><mfrac id="S6.E10.m2.2.2a" xref="S6.E10.m2.2.2.cmml"><mrow id="S6.E10.m2.1.1.1" xref="S6.E10.m2.1.1.1.cmml"><mi id="S6.E10.m2.1.1.1.3" xref="S6.E10.m2.1.1.1.3.cmml">e</mi><mo id="S6.E10.m2.1.1.1.2" xref="S6.E10.m2.1.1.1.2.cmml">⁢</mo><mi id="S6.E10.m2.1.1.1.4" xref="S6.E10.m2.1.1.1.4.cmml">m</mi><mo id="S6.E10.m2.1.1.1.2a" xref="S6.E10.m2.1.1.1.2.cmml">⁢</mo><mi id="S6.E10.m2.1.1.1.5" xref="S6.E10.m2.1.1.1.5.cmml">b</mi><mo id="S6.E10.m2.1.1.1.2b" xref="S6.E10.m2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E10.m2.1.1.1.6.2" xref="S6.E10.m2.1.1.1.cmml"><mo id="S6.E10.m2.1.1.1.6.2.1" stretchy="false" xref="S6.E10.m2.1.1.1.cmml">(</mo><mi id="S6.E10.m2.1.1.1.1" xref="S6.E10.m2.1.1.1.1.cmml">c</mi><mo id="S6.E10.m2.1.1.1.6.2.2" stretchy="false" xref="S6.E10.m2.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S6.E10.m2.2.2.2.1" xref="S6.E10.m2.2.2.2.2.cmml"><mo id="S6.E10.m2.2.2.2.1.2" stretchy="false" xref="S6.E10.m2.2.2.2.2.1.cmml">|</mo><msub id="S6.E10.m2.2.2.2.1.1" xref="S6.E10.m2.2.2.2.1.1.cmml"><mi id="S6.E10.m2.2.2.2.1.1.2" xref="S6.E10.m2.2.2.2.1.1.2.cmml">s</mi><mi id="S6.E10.m2.2.2.2.1.1.3" xref="S6.E10.m2.2.2.2.1.1.3.cmml">r</mi></msub><mo id="S6.E10.m2.2.2.2.1.3" stretchy="false" xref="S6.E10.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S6.E10.m2.3.3.1.1.1.1.2.2.4" xref="S6.E10.m2.3.3.1.1.1.1.2.3.cmml">,</mo><msubsup id="S6.E10.m2.3.3.1.1.1.1.2.2.2" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.cmml"><mi id="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.2" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.2.cmml">h</mi><mrow id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.2" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.1" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.3" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.3" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.E10.m2.3.3.1.1.1.1.2.2.5" stretchy="false" xref="S6.E10.m2.3.3.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E10.m2.3.3.1.1.1.3" stretchy="false" xref="S6.E10.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E10.m2.3b"><apply id="S6.E10.m2.3.3.cmml" xref="S6.E10.m2.3.3"><eq id="S6.E10.m2.3.3.2.cmml" xref="S6.E10.m2.3.3.2"></eq><csymbol cd="latexml" id="S6.E10.m2.3.3.3.cmml" xref="S6.E10.m2.3.3.3">absent</csymbol><apply id="S6.E10.m2.3.3.1.cmml" xref="S6.E10.m2.3.3.1"><times id="S6.E10.m2.3.3.1.2.cmml" xref="S6.E10.m2.3.3.1.2"></times><ci id="S6.E10.m2.3.3.1.3.cmml" xref="S6.E10.m2.3.3.1.3">𝜎</ci><apply id="S6.E10.m2.3.3.1.1.1.1.cmml" xref="S6.E10.m2.3.3.1.1.1"><times id="S6.E10.m2.3.3.1.1.1.1.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.3"></times><apply id="S6.E10.m2.3.3.1.1.1.1.4.cmml" xref="S6.E10.m2.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E10.m2.3.3.1.1.1.1.4.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.4">subscript</csymbol><apply id="S6.E10.m2.3.3.1.1.1.1.4.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E10.m2.3.3.1.1.1.1.4.2.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.4">superscript</csymbol><ci id="S6.E10.m2.3.3.1.1.1.1.4.2.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E10.m2.3.3.1.1.1.1.4.2.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.4.2.3">𝑠</ci></apply><ci id="S6.E10.m2.3.3.1.1.1.1.4.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.4.3">𝑟</ci></apply><interval closure="closed" id="S6.E10.m2.3.3.1.1.1.1.2.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2"><apply id="S6.E10.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1"><apply id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.2"></sum><apply id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3"><in id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.1"></in><ci id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.2">𝑐</ci><apply id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S6.E10.m2.2.2.cmml" xref="S6.E10.m2.2.2"><divide id="S6.E10.m2.2.2.3.cmml" xref="S6.E10.m2.2.2"></divide><apply id="S6.E10.m2.1.1.1.cmml" xref="S6.E10.m2.1.1.1"><times id="S6.E10.m2.1.1.1.2.cmml" xref="S6.E10.m2.1.1.1.2"></times><ci id="S6.E10.m2.1.1.1.3.cmml" xref="S6.E10.m2.1.1.1.3">𝑒</ci><ci id="S6.E10.m2.1.1.1.4.cmml" xref="S6.E10.m2.1.1.1.4">𝑚</ci><ci id="S6.E10.m2.1.1.1.5.cmml" xref="S6.E10.m2.1.1.1.5">𝑏</ci><ci id="S6.E10.m2.1.1.1.1.cmml" xref="S6.E10.m2.1.1.1.1">𝑐</ci></apply><apply id="S6.E10.m2.2.2.2.2.cmml" xref="S6.E10.m2.2.2.2.1"><abs id="S6.E10.m2.2.2.2.2.1.cmml" xref="S6.E10.m2.2.2.2.1.2"></abs><apply id="S6.E10.m2.2.2.2.1.1.cmml" xref="S6.E10.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S6.E10.m2.2.2.2.1.1.1.cmml" xref="S6.E10.m2.2.2.2.1.1">subscript</csymbol><ci id="S6.E10.m2.2.2.2.1.1.2.cmml" xref="S6.E10.m2.2.2.2.1.1.2">𝑠</ci><ci id="S6.E10.m2.2.2.2.1.1.3.cmml" xref="S6.E10.m2.2.2.2.1.1.3">𝑟</ci></apply></apply></apply></apply><apply id="S6.E10.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E10.m2.3.3.1.1.1.1.2.2.2.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2">subscript</csymbol><apply id="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2">superscript</csymbol><ci id="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.2">ℎ</ci><ci id="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><apply id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3"><minus id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.1"></minus><ci id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S6.E10.m2.3.3.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E10.m2.3c">\displaystyle=\sigma(W^{s}_{r}[\sum_{c\in s_{r}}\frac{emb(c)}{|s_{r}|},h^{s}_{%
r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E10.m2.3d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_c ∈ italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG italic_e italic_m italic_b ( italic_c ) end_ARG start_ARG | italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT | end_ARG , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S6.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{h^{s}_{r}}" class="ltx_Math" display="inline" id="S6.E11.m1.1"><semantics id="S6.E11.m1.1a"><mover accent="true" id="S6.E11.m1.1.1" xref="S6.E11.m1.1.1.cmml"><msubsup id="S6.E11.m1.1.1.2" xref="S6.E11.m1.1.1.2.cmml"><mi id="S6.E11.m1.1.1.2.2.2" xref="S6.E11.m1.1.1.2.2.2.cmml">h</mi><mi id="S6.E11.m1.1.1.2.3" xref="S6.E11.m1.1.1.2.3.cmml">r</mi><mi id="S6.E11.m1.1.1.2.2.3" xref="S6.E11.m1.1.1.2.2.3.cmml">s</mi></msubsup><mo id="S6.E11.m1.1.1.1" xref="S6.E11.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S6.E11.m1.1b"><apply id="S6.E11.m1.1.1.cmml" xref="S6.E11.m1.1.1"><ci id="S6.E11.m1.1.1.1.cmml" xref="S6.E11.m1.1.1.1">~</ci><apply id="S6.E11.m1.1.1.2.cmml" xref="S6.E11.m1.1.1.2"><csymbol cd="ambiguous" id="S6.E11.m1.1.1.2.1.cmml" xref="S6.E11.m1.1.1.2">subscript</csymbol><apply id="S6.E11.m1.1.1.2.2.cmml" xref="S6.E11.m1.1.1.2"><csymbol cd="ambiguous" id="S6.E11.m1.1.1.2.2.1.cmml" xref="S6.E11.m1.1.1.2">superscript</csymbol><ci id="S6.E11.m1.1.1.2.2.2.cmml" xref="S6.E11.m1.1.1.2.2.2">ℎ</ci><ci id="S6.E11.m1.1.1.2.2.3.cmml" xref="S6.E11.m1.1.1.2.2.3">𝑠</ci></apply><ci id="S6.E11.m1.1.1.2.3.cmml" xref="S6.E11.m1.1.1.2.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E11.m1.1c">\displaystyle\tilde{h^{s}_{r}}</annotation><annotation encoding="application/x-llamapun" id="S6.E11.m1.1d">over~ start_ARG italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\tanh(W^{s}_{h}[\sum_{c\in s_{r}}\frac{emb(c)}{|s_{r}|},r^{s}_{r%
}\odot h^{s}_{r-1}])" class="ltx_Math" display="inline" id="S6.E11.m2.4"><semantics id="S6.E11.m2.4a"><mrow id="S6.E11.m2.4.4" xref="S6.E11.m2.4.4.cmml"><mi id="S6.E11.m2.4.4.3" xref="S6.E11.m2.4.4.3.cmml"></mi><mo id="S6.E11.m2.4.4.2" xref="S6.E11.m2.4.4.2.cmml">=</mo><mrow id="S6.E11.m2.4.4.1.1" xref="S6.E11.m2.4.4.1.2.cmml"><mi id="S6.E11.m2.3.3" xref="S6.E11.m2.3.3.cmml">tanh</mi><mo id="S6.E11.m2.4.4.1.1a" xref="S6.E11.m2.4.4.1.2.cmml">⁡</mo><mrow id="S6.E11.m2.4.4.1.1.1" xref="S6.E11.m2.4.4.1.2.cmml"><mo id="S6.E11.m2.4.4.1.1.1.2" stretchy="false" xref="S6.E11.m2.4.4.1.2.cmml">(</mo><mrow id="S6.E11.m2.4.4.1.1.1.1" xref="S6.E11.m2.4.4.1.1.1.1.cmml"><msubsup id="S6.E11.m2.4.4.1.1.1.1.4" xref="S6.E11.m2.4.4.1.1.1.1.4.cmml"><mi id="S6.E11.m2.4.4.1.1.1.1.4.2.2" xref="S6.E11.m2.4.4.1.1.1.1.4.2.2.cmml">W</mi><mi id="S6.E11.m2.4.4.1.1.1.1.4.3" xref="S6.E11.m2.4.4.1.1.1.1.4.3.cmml">h</mi><mi id="S6.E11.m2.4.4.1.1.1.1.4.2.3" xref="S6.E11.m2.4.4.1.1.1.1.4.2.3.cmml">s</mi></msubsup><mo id="S6.E11.m2.4.4.1.1.1.1.3" xref="S6.E11.m2.4.4.1.1.1.1.3.cmml">⁢</mo><mrow id="S6.E11.m2.4.4.1.1.1.1.2.2" xref="S6.E11.m2.4.4.1.1.1.1.2.3.cmml"><mo id="S6.E11.m2.4.4.1.1.1.1.2.2.3" stretchy="false" xref="S6.E11.m2.4.4.1.1.1.1.2.3.cmml">[</mo><mrow id="S6.E11.m2.4.4.1.1.1.1.1.1.1" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.cmml"><munder id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1a" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.2" movablelimits="false" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.2" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.2.cmml">c</mi><mo id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.1" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.2" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mi id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.3" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow></munder></mstyle><mstyle displaystyle="true" id="S6.E11.m2.2.2" xref="S6.E11.m2.2.2.cmml"><mfrac id="S6.E11.m2.2.2a" xref="S6.E11.m2.2.2.cmml"><mrow id="S6.E11.m2.1.1.1" xref="S6.E11.m2.1.1.1.cmml"><mi id="S6.E11.m2.1.1.1.3" xref="S6.E11.m2.1.1.1.3.cmml">e</mi><mo id="S6.E11.m2.1.1.1.2" xref="S6.E11.m2.1.1.1.2.cmml">⁢</mo><mi id="S6.E11.m2.1.1.1.4" xref="S6.E11.m2.1.1.1.4.cmml">m</mi><mo id="S6.E11.m2.1.1.1.2a" xref="S6.E11.m2.1.1.1.2.cmml">⁢</mo><mi id="S6.E11.m2.1.1.1.5" xref="S6.E11.m2.1.1.1.5.cmml">b</mi><mo id="S6.E11.m2.1.1.1.2b" xref="S6.E11.m2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E11.m2.1.1.1.6.2" xref="S6.E11.m2.1.1.1.cmml"><mo id="S6.E11.m2.1.1.1.6.2.1" stretchy="false" xref="S6.E11.m2.1.1.1.cmml">(</mo><mi id="S6.E11.m2.1.1.1.1" xref="S6.E11.m2.1.1.1.1.cmml">c</mi><mo id="S6.E11.m2.1.1.1.6.2.2" stretchy="false" xref="S6.E11.m2.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S6.E11.m2.2.2.2.1" xref="S6.E11.m2.2.2.2.2.cmml"><mo id="S6.E11.m2.2.2.2.1.2" stretchy="false" xref="S6.E11.m2.2.2.2.2.1.cmml">|</mo><msub id="S6.E11.m2.2.2.2.1.1" xref="S6.E11.m2.2.2.2.1.1.cmml"><mi id="S6.E11.m2.2.2.2.1.1.2" xref="S6.E11.m2.2.2.2.1.1.2.cmml">s</mi><mi id="S6.E11.m2.2.2.2.1.1.3" xref="S6.E11.m2.2.2.2.1.1.3.cmml">r</mi></msub><mo id="S6.E11.m2.2.2.2.1.3" stretchy="false" xref="S6.E11.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo id="S6.E11.m2.4.4.1.1.1.1.2.2.4" xref="S6.E11.m2.4.4.1.1.1.1.2.3.cmml">,</mo><mrow id="S6.E11.m2.4.4.1.1.1.1.2.2.2" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.cmml"><msubsup id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.cmml"><mi id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.2" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.2.cmml">r</mi><mi id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.3" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.3.cmml">r</mi><mi id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.3" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.E11.m2.4.4.1.1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.1.cmml">⊙</mo><msubsup id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.cmml"><mi id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.2" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.2.cmml">h</mi><mrow id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.cmml"><mi id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.2" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.2.cmml">r</mi><mo id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.1" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.3" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow><mi id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.3" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.3.cmml">s</mi></msubsup></mrow><mo id="S6.E11.m2.4.4.1.1.1.1.2.2.5" stretchy="false" xref="S6.E11.m2.4.4.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S6.E11.m2.4.4.1.1.1.3" stretchy="false" xref="S6.E11.m2.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E11.m2.4b"><apply id="S6.E11.m2.4.4.cmml" xref="S6.E11.m2.4.4"><eq id="S6.E11.m2.4.4.2.cmml" xref="S6.E11.m2.4.4.2"></eq><csymbol cd="latexml" id="S6.E11.m2.4.4.3.cmml" xref="S6.E11.m2.4.4.3">absent</csymbol><apply id="S6.E11.m2.4.4.1.2.cmml" xref="S6.E11.m2.4.4.1.1"><tanh id="S6.E11.m2.3.3.cmml" xref="S6.E11.m2.3.3"></tanh><apply id="S6.E11.m2.4.4.1.1.1.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1"><times id="S6.E11.m2.4.4.1.1.1.1.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.3"></times><apply id="S6.E11.m2.4.4.1.1.1.1.4.cmml" xref="S6.E11.m2.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.4.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.4">subscript</csymbol><apply id="S6.E11.m2.4.4.1.1.1.1.4.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.4.2.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.4">superscript</csymbol><ci id="S6.E11.m2.4.4.1.1.1.1.4.2.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.4.2.2">𝑊</ci><ci id="S6.E11.m2.4.4.1.1.1.1.4.2.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.4.2.3">𝑠</ci></apply><ci id="S6.E11.m2.4.4.1.1.1.1.4.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.4.3">ℎ</ci></apply><interval closure="closed" id="S6.E11.m2.4.4.1.1.1.1.2.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2"><apply id="S6.E11.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1"><apply id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.2"></sum><apply id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3"><in id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.1"></in><ci id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.2">𝑐</ci><apply id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S6.E11.m2.2.2.cmml" xref="S6.E11.m2.2.2"><divide id="S6.E11.m2.2.2.3.cmml" xref="S6.E11.m2.2.2"></divide><apply id="S6.E11.m2.1.1.1.cmml" xref="S6.E11.m2.1.1.1"><times id="S6.E11.m2.1.1.1.2.cmml" xref="S6.E11.m2.1.1.1.2"></times><ci id="S6.E11.m2.1.1.1.3.cmml" xref="S6.E11.m2.1.1.1.3">𝑒</ci><ci id="S6.E11.m2.1.1.1.4.cmml" xref="S6.E11.m2.1.1.1.4">𝑚</ci><ci id="S6.E11.m2.1.1.1.5.cmml" xref="S6.E11.m2.1.1.1.5">𝑏</ci><ci id="S6.E11.m2.1.1.1.1.cmml" xref="S6.E11.m2.1.1.1.1">𝑐</ci></apply><apply id="S6.E11.m2.2.2.2.2.cmml" xref="S6.E11.m2.2.2.2.1"><abs id="S6.E11.m2.2.2.2.2.1.cmml" xref="S6.E11.m2.2.2.2.1.2"></abs><apply id="S6.E11.m2.2.2.2.1.1.cmml" xref="S6.E11.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S6.E11.m2.2.2.2.1.1.1.cmml" xref="S6.E11.m2.2.2.2.1.1">subscript</csymbol><ci id="S6.E11.m2.2.2.2.1.1.2.cmml" xref="S6.E11.m2.2.2.2.1.1.2">𝑠</ci><ci id="S6.E11.m2.2.2.2.1.1.3.cmml" xref="S6.E11.m2.2.2.2.1.1.3">𝑟</ci></apply></apply></apply></apply><apply id="S6.E11.m2.4.4.1.1.1.1.2.2.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S6.E11.m2.4.4.1.1.1.1.2.2.2.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.1">direct-product</csymbol><apply id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.2">𝑟</ci><ci id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.2.3">𝑠</ci></apply><ci id="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.2.3">𝑟</ci></apply><apply id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3">subscript</csymbol><apply id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3">superscript</csymbol><ci id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.2">ℎ</ci><ci id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.2.3">𝑠</ci></apply><apply id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3"><minus id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.1.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.1"></minus><ci id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.2.cmml" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.2">𝑟</ci><cn id="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S6.E11.m2.4.4.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E11.m2.4c">\displaystyle=\tanh(W^{s}_{h}[\sum_{c\in s_{r}}\frac{emb(c)}{|s_{r}|},r^{s}_{r%
}\odot h^{s}_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="S6.E11.m2.4d">= roman_tanh ( italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_c ∈ italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG italic_e italic_m italic_b ( italic_c ) end_ARG start_ARG | italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT | end_ARG , italic_r start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="S6.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h^{s}_{r}" class="ltx_Math" display="inline" id="S6.E12.m1.1"><semantics id="S6.E12.m1.1a"><msubsup id="S6.E12.m1.1.1" xref="S6.E12.m1.1.1.cmml"><mi id="S6.E12.m1.1.1.2.2" xref="S6.E12.m1.1.1.2.2.cmml">h</mi><mi id="S6.E12.m1.1.1.3" xref="S6.E12.m1.1.1.3.cmml">r</mi><mi id="S6.E12.m1.1.1.2.3" xref="S6.E12.m1.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.E12.m1.1b"><apply id="S6.E12.m1.1.1.cmml" xref="S6.E12.m1.1.1"><csymbol cd="ambiguous" id="S6.E12.m1.1.1.1.cmml" xref="S6.E12.m1.1.1">subscript</csymbol><apply id="S6.E12.m1.1.1.2.cmml" xref="S6.E12.m1.1.1"><csymbol cd="ambiguous" id="S6.E12.m1.1.1.2.1.cmml" xref="S6.E12.m1.1.1">superscript</csymbol><ci id="S6.E12.m1.1.1.2.2.cmml" xref="S6.E12.m1.1.1.2.2">ℎ</ci><ci id="S6.E12.m1.1.1.2.3.cmml" xref="S6.E12.m1.1.1.2.3">𝑠</ci></apply><ci id="S6.E12.m1.1.1.3.cmml" xref="S6.E12.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E12.m1.1c">\displaystyle h^{s}_{r}</annotation><annotation encoding="application/x-llamapun" id="S6.E12.m1.1d">italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(1-z^{s}_{r})\odot h^{s}_{r-1}+z^{s}_{r}\odot\tilde{h^{s}_{r}}" class="ltx_Math" display="inline" id="S6.E12.m2.1"><semantics id="S6.E12.m2.1a"><mrow id="S6.E12.m2.1.1" xref="S6.E12.m2.1.1.cmml"><mi id="S6.E12.m2.1.1.3" xref="S6.E12.m2.1.1.3.cmml"></mi><mo id="S6.E12.m2.1.1.2" xref="S6.E12.m2.1.1.2.cmml">=</mo><mrow id="S6.E12.m2.1.1.1" xref="S6.E12.m2.1.1.1.cmml"><mrow id="S6.E12.m2.1.1.1.1" xref="S6.E12.m2.1.1.1.1.cmml"><mrow id="S6.E12.m2.1.1.1.1.1.1" xref="S6.E12.m2.1.1.1.1.1.1.1.cmml"><mo id="S6.E12.m2.1.1.1.1.1.1.2" stretchy="false" xref="S6.E12.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E12.m2.1.1.1.1.1.1.1" xref="S6.E12.m2.1.1.1.1.1.1.1.cmml"><mn id="S6.E12.m2.1.1.1.1.1.1.1.2" xref="S6.E12.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S6.E12.m2.1.1.1.1.1.1.1.1" xref="S6.E12.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S6.E12.m2.1.1.1.1.1.1.1.3" xref="S6.E12.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S6.E12.m2.1.1.1.1.1.1.1.3.2.2" xref="S6.E12.m2.1.1.1.1.1.1.1.3.2.2.cmml">z</mi><mi id="S6.E12.m2.1.1.1.1.1.1.1.3.3" xref="S6.E12.m2.1.1.1.1.1.1.1.3.3.cmml">r</mi><mi id="S6.E12.m2.1.1.1.1.1.1.1.3.2.3" xref="S6.E12.m2.1.1.1.1.1.1.1.3.2.3.cmml">s</mi></msubsup></mrow><mo id="S6.E12.m2.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S6.E12.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S6.E12.m2.1.1.1.1.2" rspace="0.222em" xref="S6.E12.m2.1.1.1.1.2.cmml">⊙</mo><msubsup id="S6.E12.m2.1.1.1.1.3" xref="S6.E12.m2.1.1.1.1.3.cmml"><mi id="S6.E12.m2.1.1.1.1.3.2.2" xref="S6.E12.m2.1.1.1.1.3.2.2.cmml">h</mi><mrow id="S6.E12.m2.1.1.1.1.3.3" xref="S6.E12.m2.1.1.1.1.3.3.cmml"><mi id="S6.E12.m2.1.1.1.1.3.3.2" xref="S6.E12.m2.1.1.1.1.3.3.2.cmml">r</mi><mo id="S6.E12.m2.1.1.1.1.3.3.1" xref="S6.E12.m2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S6.E12.m2.1.1.1.1.3.3.3" xref="S6.E12.m2.1.1.1.1.3.3.3.cmml">1</mn></mrow><mi id="S6.E12.m2.1.1.1.1.3.2.3" xref="S6.E12.m2.1.1.1.1.3.2.3.cmml">s</mi></msubsup></mrow><mo id="S6.E12.m2.1.1.1.2" xref="S6.E12.m2.1.1.1.2.cmml">+</mo><mrow id="S6.E12.m2.1.1.1.3" xref="S6.E12.m2.1.1.1.3.cmml"><msubsup id="S6.E12.m2.1.1.1.3.2" xref="S6.E12.m2.1.1.1.3.2.cmml"><mi id="S6.E12.m2.1.1.1.3.2.2.2" xref="S6.E12.m2.1.1.1.3.2.2.2.cmml">z</mi><mi id="S6.E12.m2.1.1.1.3.2.3" xref="S6.E12.m2.1.1.1.3.2.3.cmml">r</mi><mi id="S6.E12.m2.1.1.1.3.2.2.3" xref="S6.E12.m2.1.1.1.3.2.2.3.cmml">s</mi></msubsup><mo id="S6.E12.m2.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.E12.m2.1.1.1.3.1.cmml">⊙</mo><mover accent="true" id="S6.E12.m2.1.1.1.3.3" xref="S6.E12.m2.1.1.1.3.3.cmml"><msubsup id="S6.E12.m2.1.1.1.3.3.2" xref="S6.E12.m2.1.1.1.3.3.2.cmml"><mi id="S6.E12.m2.1.1.1.3.3.2.2.2" xref="S6.E12.m2.1.1.1.3.3.2.2.2.cmml">h</mi><mi id="S6.E12.m2.1.1.1.3.3.2.3" xref="S6.E12.m2.1.1.1.3.3.2.3.cmml">r</mi><mi id="S6.E12.m2.1.1.1.3.3.2.2.3" xref="S6.E12.m2.1.1.1.3.3.2.2.3.cmml">s</mi></msubsup><mo id="S6.E12.m2.1.1.1.3.3.1" xref="S6.E12.m2.1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E12.m2.1b"><apply id="S6.E12.m2.1.1.cmml" xref="S6.E12.m2.1.1"><eq id="S6.E12.m2.1.1.2.cmml" xref="S6.E12.m2.1.1.2"></eq><csymbol cd="latexml" id="S6.E12.m2.1.1.3.cmml" xref="S6.E12.m2.1.1.3">absent</csymbol><apply id="S6.E12.m2.1.1.1.cmml" xref="S6.E12.m2.1.1.1"><plus id="S6.E12.m2.1.1.1.2.cmml" xref="S6.E12.m2.1.1.1.2"></plus><apply id="S6.E12.m2.1.1.1.1.cmml" xref="S6.E12.m2.1.1.1.1"><csymbol cd="latexml" id="S6.E12.m2.1.1.1.1.2.cmml" xref="S6.E12.m2.1.1.1.1.2">direct-product</csymbol><apply id="S6.E12.m2.1.1.1.1.1.1.1.cmml" xref="S6.E12.m2.1.1.1.1.1.1"><minus id="S6.E12.m2.1.1.1.1.1.1.1.1.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.1"></minus><cn id="S6.E12.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S6.E12.m2.1.1.1.1.1.1.1.2">1</cn><apply id="S6.E12.m2.1.1.1.1.1.1.1.3.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S6.E12.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S6.E12.m2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.3.2.2">𝑧</ci><ci id="S6.E12.m2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.3.2.3">𝑠</ci></apply><ci id="S6.E12.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S6.E12.m2.1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><apply id="S6.E12.m2.1.1.1.1.3.cmml" xref="S6.E12.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.1.3.1.cmml" xref="S6.E12.m2.1.1.1.1.3">subscript</csymbol><apply id="S6.E12.m2.1.1.1.1.3.2.cmml" xref="S6.E12.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.1.3.2.1.cmml" xref="S6.E12.m2.1.1.1.1.3">superscript</csymbol><ci id="S6.E12.m2.1.1.1.1.3.2.2.cmml" xref="S6.E12.m2.1.1.1.1.3.2.2">ℎ</ci><ci id="S6.E12.m2.1.1.1.1.3.2.3.cmml" xref="S6.E12.m2.1.1.1.1.3.2.3">𝑠</ci></apply><apply id="S6.E12.m2.1.1.1.1.3.3.cmml" xref="S6.E12.m2.1.1.1.1.3.3"><minus id="S6.E12.m2.1.1.1.1.3.3.1.cmml" xref="S6.E12.m2.1.1.1.1.3.3.1"></minus><ci id="S6.E12.m2.1.1.1.1.3.3.2.cmml" xref="S6.E12.m2.1.1.1.1.3.3.2">𝑟</ci><cn id="S6.E12.m2.1.1.1.1.3.3.3.cmml" type="integer" xref="S6.E12.m2.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S6.E12.m2.1.1.1.3.cmml" xref="S6.E12.m2.1.1.1.3"><csymbol cd="latexml" id="S6.E12.m2.1.1.1.3.1.cmml" xref="S6.E12.m2.1.1.1.3.1">direct-product</csymbol><apply id="S6.E12.m2.1.1.1.3.2.cmml" xref="S6.E12.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.3.2.1.cmml" xref="S6.E12.m2.1.1.1.3.2">subscript</csymbol><apply id="S6.E12.m2.1.1.1.3.2.2.cmml" xref="S6.E12.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.3.2.2.1.cmml" xref="S6.E12.m2.1.1.1.3.2">superscript</csymbol><ci id="S6.E12.m2.1.1.1.3.2.2.2.cmml" xref="S6.E12.m2.1.1.1.3.2.2.2">𝑧</ci><ci id="S6.E12.m2.1.1.1.3.2.2.3.cmml" xref="S6.E12.m2.1.1.1.3.2.2.3">𝑠</ci></apply><ci id="S6.E12.m2.1.1.1.3.2.3.cmml" xref="S6.E12.m2.1.1.1.3.2.3">𝑟</ci></apply><apply id="S6.E12.m2.1.1.1.3.3.cmml" xref="S6.E12.m2.1.1.1.3.3"><ci id="S6.E12.m2.1.1.1.3.3.1.cmml" xref="S6.E12.m2.1.1.1.3.3.1">~</ci><apply id="S6.E12.m2.1.1.1.3.3.2.cmml" xref="S6.E12.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.3.3.2.1.cmml" xref="S6.E12.m2.1.1.1.3.3.2">subscript</csymbol><apply id="S6.E12.m2.1.1.1.3.3.2.2.cmml" xref="S6.E12.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S6.E12.m2.1.1.1.3.3.2.2.1.cmml" xref="S6.E12.m2.1.1.1.3.3.2">superscript</csymbol><ci id="S6.E12.m2.1.1.1.3.3.2.2.2.cmml" xref="S6.E12.m2.1.1.1.3.3.2.2.2">ℎ</ci><ci id="S6.E12.m2.1.1.1.3.3.2.2.3.cmml" xref="S6.E12.m2.1.1.1.3.3.2.2.3">𝑠</ci></apply><ci id="S6.E12.m2.1.1.1.3.3.2.3.cmml" xref="S6.E12.m2.1.1.1.3.3.2.3">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E12.m2.1c">\displaystyle=(1-z^{s}_{r})\odot h^{s}_{r-1}+z^{s}_{r}\odot\tilde{h^{s}_{r}}</annotation><annotation encoding="application/x-llamapun" id="S6.E12.m2.1d">= ( 1 - italic_z start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ⊙ italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT + italic_z start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ over~ start_ARG italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S6.SS1.SSS1.p6">
<p class="ltx_p" id="S6.SS1.SSS1.p6.4">where <math alttext="W^{s}_{z},W^{s}_{r},W^{s}_{h},emb(s_{r})" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p6.1.m1.4"><semantics id="S6.SS1.SSS1.p6.1.m1.4a"><mrow id="S6.SS1.SSS1.p6.1.m1.4.4.4" xref="S6.SS1.SSS1.p6.1.m1.4.4.5.cmml"><msubsup id="S6.SS1.SSS1.p6.1.m1.1.1.1.1" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1.cmml"><mi id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.2" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.2.cmml">W</mi><mi id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.3" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1.3.cmml">z</mi><mi id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.3" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.5" xref="S6.SS1.SSS1.p6.1.m1.4.4.5.cmml">,</mo><msubsup id="S6.SS1.SSS1.p6.1.m1.2.2.2.2" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2.cmml"><mi id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.2" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.2.cmml">W</mi><mi id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.3" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2.3.cmml">r</mi><mi id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.3" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.6" xref="S6.SS1.SSS1.p6.1.m1.4.4.5.cmml">,</mo><msubsup id="S6.SS1.SSS1.p6.1.m1.3.3.3.3" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3.cmml"><mi id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.2" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.2.cmml">W</mi><mi id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.3" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3.3.cmml">h</mi><mi id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.3" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.7" xref="S6.SS1.SSS1.p6.1.m1.4.4.5.cmml">,</mo><mrow id="S6.SS1.SSS1.p6.1.m1.4.4.4.4" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.cmml"><mi id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.3" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.3.cmml">e</mi><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2.cmml">⁢</mo><mi id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.4" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.4.cmml">m</mi><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2a" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2.cmml">⁢</mo><mi id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.5" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.5.cmml">b</mi><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2b" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2.cmml">⁢</mo><mrow id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.cmml"><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.2" stretchy="false" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.cmml">(</mo><msub id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.cmml"><mi id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.2" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.2.cmml">s</mi><mi id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.3" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.3.cmml">r</mi></msub><mo id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.3" stretchy="false" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p6.1.m1.4b"><list id="S6.SS1.SSS1.p6.1.m1.4.4.5.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4"><apply id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1">subscript</csymbol><apply id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1">superscript</csymbol><ci id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.2">𝑊</ci><ci id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS1.p6.1.m1.1.1.1.1.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.1.1.1.1.3">𝑧</ci></apply><apply id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2">subscript</csymbol><apply id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2">superscript</csymbol><ci id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.2">𝑊</ci><ci id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS1.p6.1.m1.2.2.2.2.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.2.2.2.2.3">𝑟</ci></apply><apply id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3">subscript</csymbol><apply id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3">superscript</csymbol><ci id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.2">𝑊</ci><ci id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS1.p6.1.m1.3.3.3.3.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.3.3.3.3.3">ℎ</ci></apply><apply id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4"><times id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.2"></times><ci id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.3">𝑒</ci><ci id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.4.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.4">𝑚</ci><ci id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.5.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.5">𝑏</ci><apply id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.1.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1">subscript</csymbol><ci id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.2.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.2">𝑠</ci><ci id="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.3.cmml" xref="S6.SS1.SSS1.p6.1.m1.4.4.4.4.1.1.1.3">𝑟</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p6.1.m1.4c">W^{s}_{z},W^{s}_{r},W^{s}_{h},emb(s_{r})</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p6.1.m1.4d">italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT , italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_W start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT , italic_e italic_m italic_b ( italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT )</annotation></semantics></math> in case 1, and <math alttext="emb(c)" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p6.2.m2.1"><semantics id="S6.SS1.SSS1.p6.2.m2.1a"><mrow id="S6.SS1.SSS1.p6.2.m2.1.2" xref="S6.SS1.SSS1.p6.2.m2.1.2.cmml"><mi id="S6.SS1.SSS1.p6.2.m2.1.2.2" xref="S6.SS1.SSS1.p6.2.m2.1.2.2.cmml">e</mi><mo id="S6.SS1.SSS1.p6.2.m2.1.2.1" xref="S6.SS1.SSS1.p6.2.m2.1.2.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p6.2.m2.1.2.3" xref="S6.SS1.SSS1.p6.2.m2.1.2.3.cmml">m</mi><mo id="S6.SS1.SSS1.p6.2.m2.1.2.1a" xref="S6.SS1.SSS1.p6.2.m2.1.2.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p6.2.m2.1.2.4" xref="S6.SS1.SSS1.p6.2.m2.1.2.4.cmml">b</mi><mo id="S6.SS1.SSS1.p6.2.m2.1.2.1b" xref="S6.SS1.SSS1.p6.2.m2.1.2.1.cmml">⁢</mo><mrow id="S6.SS1.SSS1.p6.2.m2.1.2.5.2" xref="S6.SS1.SSS1.p6.2.m2.1.2.cmml"><mo id="S6.SS1.SSS1.p6.2.m2.1.2.5.2.1" stretchy="false" xref="S6.SS1.SSS1.p6.2.m2.1.2.cmml">(</mo><mi id="S6.SS1.SSS1.p6.2.m2.1.1" xref="S6.SS1.SSS1.p6.2.m2.1.1.cmml">c</mi><mo id="S6.SS1.SSS1.p6.2.m2.1.2.5.2.2" stretchy="false" xref="S6.SS1.SSS1.p6.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p6.2.m2.1b"><apply id="S6.SS1.SSS1.p6.2.m2.1.2.cmml" xref="S6.SS1.SSS1.p6.2.m2.1.2"><times id="S6.SS1.SSS1.p6.2.m2.1.2.1.cmml" xref="S6.SS1.SSS1.p6.2.m2.1.2.1"></times><ci id="S6.SS1.SSS1.p6.2.m2.1.2.2.cmml" xref="S6.SS1.SSS1.p6.2.m2.1.2.2">𝑒</ci><ci id="S6.SS1.SSS1.p6.2.m2.1.2.3.cmml" xref="S6.SS1.SSS1.p6.2.m2.1.2.3">𝑚</ci><ci id="S6.SS1.SSS1.p6.2.m2.1.2.4.cmml" xref="S6.SS1.SSS1.p6.2.m2.1.2.4">𝑏</ci><ci id="S6.SS1.SSS1.p6.2.m2.1.1.cmml" xref="S6.SS1.SSS1.p6.2.m2.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p6.2.m2.1c">emb(c)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p6.2.m2.1d">italic_e italic_m italic_b ( italic_c )</annotation></semantics></math> in case 2 are learnable parameters. After this GRU side information encoder, the raw side information <math alttext="Side_{S}=\{s_{1},s_{2},\cdots,s_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p6.3.m3.4"><semantics id="S6.SS1.SSS1.p6.3.m3.4a"><mrow id="S6.SS1.SSS1.p6.3.m3.4.4" xref="S6.SS1.SSS1.p6.3.m3.4.4.cmml"><mrow id="S6.SS1.SSS1.p6.3.m3.4.4.5" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.cmml"><mi id="S6.SS1.SSS1.p6.3.m3.4.4.5.2" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.2.cmml">S</mi><mo id="S6.SS1.SSS1.p6.3.m3.4.4.5.1" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p6.3.m3.4.4.5.3" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.3.cmml">i</mi><mo id="S6.SS1.SSS1.p6.3.m3.4.4.5.1a" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.1.cmml">⁢</mo><mi id="S6.SS1.SSS1.p6.3.m3.4.4.5.4" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.4.cmml">d</mi><mo id="S6.SS1.SSS1.p6.3.m3.4.4.5.1b" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.1.cmml">⁢</mo><msub id="S6.SS1.SSS1.p6.3.m3.4.4.5.5" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.5.cmml"><mi id="S6.SS1.SSS1.p6.3.m3.4.4.5.5.2" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.5.2.cmml">e</mi><mi id="S6.SS1.SSS1.p6.3.m3.4.4.5.5.3" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.5.3.cmml">S</mi></msub></mrow><mo id="S6.SS1.SSS1.p6.3.m3.4.4.4" xref="S6.SS1.SSS1.p6.3.m3.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS1.p6.3.m3.4.4.3.3" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.4.cmml"><mo id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.4.cmml">{</mo><msub id="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1" xref="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.2" xref="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.2.cmml">s</mi><mn id="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.3" xref="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.5" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2" xref="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.2" xref="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.2.cmml">s</mi><mn id="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.3" xref="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.6" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS1.p6.3.m3.1.1" mathvariant="normal" xref="S6.SS1.SSS1.p6.3.m3.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.7" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.2" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.2.cmml">s</mi><mi id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.3" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p6.3.m3.4b"><apply id="S6.SS1.SSS1.p6.3.m3.4.4.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4"><eq id="S6.SS1.SSS1.p6.3.m3.4.4.4.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.4"></eq><apply id="S6.SS1.SSS1.p6.3.m3.4.4.5.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5"><times id="S6.SS1.SSS1.p6.3.m3.4.4.5.1.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.1"></times><ci id="S6.SS1.SSS1.p6.3.m3.4.4.5.2.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.2">𝑆</ci><ci id="S6.SS1.SSS1.p6.3.m3.4.4.5.3.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.3">𝑖</ci><ci id="S6.SS1.SSS1.p6.3.m3.4.4.5.4.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.4">𝑑</ci><apply id="S6.SS1.SSS1.p6.3.m3.4.4.5.5.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.5"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.3.m3.4.4.5.5.1.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.5">subscript</csymbol><ci id="S6.SS1.SSS1.p6.3.m3.4.4.5.5.2.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.5.2">𝑒</ci><ci id="S6.SS1.SSS1.p6.3.m3.4.4.5.5.3.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.5.5.3">𝑆</ci></apply></apply><set id="S6.SS1.SSS1.p6.3.m3.4.4.3.4.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3"><apply id="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.cmml" xref="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.2">𝑠</ci><cn id="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS1.p6.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.cmml" xref="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.2">𝑠</ci><cn id="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS1.p6.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS1.p6.3.m3.1.1.cmml" xref="S6.SS1.SSS1.p6.3.m3.1.1">⋯</ci><apply id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.2">𝑠</ci><ci id="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS1.p6.3.m3.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p6.3.m3.4c">Side_{S}=\{s_{1},s_{2},\cdots,s_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p6.3.m3.4d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> is encoded into <math alttext="h^{s}=\{h^{s}_{1},h^{s}_{2},\cdots,h^{s}_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS1.p6.4.m4.4"><semantics id="S6.SS1.SSS1.p6.4.m4.4a"><mrow id="S6.SS1.SSS1.p6.4.m4.4.4" xref="S6.SS1.SSS1.p6.4.m4.4.4.cmml"><msup id="S6.SS1.SSS1.p6.4.m4.4.4.5" xref="S6.SS1.SSS1.p6.4.m4.4.4.5.cmml"><mi id="S6.SS1.SSS1.p6.4.m4.4.4.5.2" xref="S6.SS1.SSS1.p6.4.m4.4.4.5.2.cmml">h</mi><mi id="S6.SS1.SSS1.p6.4.m4.4.4.5.3" xref="S6.SS1.SSS1.p6.4.m4.4.4.5.3.cmml">s</mi></msup><mo id="S6.SS1.SSS1.p6.4.m4.4.4.4" xref="S6.SS1.SSS1.p6.4.m4.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS1.p6.4.m4.4.4.3.3" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.4.cmml"><mo id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.4.cmml">{</mo><msubsup id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.2" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.2.cmml">h</mi><mn id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.3" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.3.cmml">1</mn><mi id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.3" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.5" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.2" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.2.cmml">h</mi><mn id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.3" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.3.cmml">2</mn><mi id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.3" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.6" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS1.p6.4.m4.1.1" mathvariant="normal" xref="S6.SS1.SSS1.p6.4.m4.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.7" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.2" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.2.cmml">h</mi><mi id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.3" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.3.cmml">t</mi><mi id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.3" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS1.p6.4.m4.4b"><apply id="S6.SS1.SSS1.p6.4.m4.4.4.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4"><eq id="S6.SS1.SSS1.p6.4.m4.4.4.4.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.4"></eq><apply id="S6.SS1.SSS1.p6.4.m4.4.4.5.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.5"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.4.m4.4.4.5.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.5">superscript</csymbol><ci id="S6.SS1.SSS1.p6.4.m4.4.4.5.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.5.2">ℎ</ci><ci id="S6.SS1.SSS1.p6.4.m4.4.4.5.3.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.5.3">𝑠</ci></apply><set id="S6.SS1.SSS1.p6.4.m4.4.4.3.4.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3"><apply id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1">subscript</csymbol><apply id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1">superscript</csymbol><ci id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.2">ℎ</ci><ci id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.3.cmml" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.2.3">𝑠</ci></apply><cn id="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS1.p6.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2">subscript</csymbol><apply id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2">superscript</csymbol><ci id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.2">ℎ</ci><ci id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.3.cmml" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.2.3">𝑠</ci></apply><cn id="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS1.p6.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS1.p6.4.m4.1.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.1.1">⋯</ci><apply id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3">subscript</csymbol><apply id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.1.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3">superscript</csymbol><ci id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.2.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.2">ℎ</ci><ci id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.3.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS1.p6.4.m4.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS1.p6.4.m4.4c">h^{s}=\{h^{s}_{1},h^{s}_{2},\cdots,h^{s}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS1.p6.4.m4.4d">italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT = { italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.2 </span>Side information encoder of SR-GNN</h4>
<figure class="ltx_figure" id="S6.F4">
<p class="ltx_p ltx_align_center" id="S6.F4.1"><span class="ltx_text ltx_inline-block" id="S6.F4.1.1" style="width:433.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="S6.F4.1.1.g1" src="extracted/5637323/SRGNNWSide.png" width="658"/></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>SR-GNN model with side information. <math alttext="s" class="ltx_Math" display="inline" id="S6.F4.7.m1.1"><semantics id="S6.F4.7.m1.1b"><mi id="S6.F4.7.m1.1.1" xref="S6.F4.7.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S6.F4.7.m1.1c"><ci id="S6.F4.7.m1.1.1.cmml" xref="S6.F4.7.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.7.m1.1d">s</annotation><annotation encoding="application/x-llamapun" id="S6.F4.7.m1.1e">italic_s</annotation></semantics></math>’s represent the side information in a session and <math alttext="h^{\prime}" class="ltx_Math" display="inline" id="S6.F4.8.m2.1"><semantics id="S6.F4.8.m2.1b"><msup id="S6.F4.8.m2.1.1" xref="S6.F4.8.m2.1.1.cmml"><mi id="S6.F4.8.m2.1.1.2" xref="S6.F4.8.m2.1.1.2.cmml">h</mi><mo id="S6.F4.8.m2.1.1.3" xref="S6.F4.8.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S6.F4.8.m2.1c"><apply id="S6.F4.8.m2.1.1.cmml" xref="S6.F4.8.m2.1.1"><csymbol cd="ambiguous" id="S6.F4.8.m2.1.1.1.cmml" xref="S6.F4.8.m2.1.1">superscript</csymbol><ci id="S6.F4.8.m2.1.1.2.cmml" xref="S6.F4.8.m2.1.1.2">ℎ</ci><ci id="S6.F4.8.m2.1.1.3.cmml" xref="S6.F4.8.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.8.m2.1d">h^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S6.F4.8.m2.1e">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>’s represents the embedding vectors of <math alttext="s" class="ltx_Math" display="inline" id="S6.F4.9.m3.1"><semantics id="S6.F4.9.m3.1b"><mi id="S6.F4.9.m3.1.1" xref="S6.F4.9.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S6.F4.9.m3.1c"><ci id="S6.F4.9.m3.1.1.cmml" xref="S6.F4.9.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.9.m3.1d">s</annotation><annotation encoding="application/x-llamapun" id="S6.F4.9.m3.1e">italic_s</annotation></semantics></math>’s extracted from a Graph Neural Network that handles side information. The model would concatenate <math alttext="h_{j}" class="ltx_Math" display="inline" id="S6.F4.10.m4.1"><semantics id="S6.F4.10.m4.1b"><msub id="S6.F4.10.m4.1.1" xref="S6.F4.10.m4.1.1.cmml"><mi id="S6.F4.10.m4.1.1.2" xref="S6.F4.10.m4.1.1.2.cmml">h</mi><mi id="S6.F4.10.m4.1.1.3" xref="S6.F4.10.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S6.F4.10.m4.1c"><apply id="S6.F4.10.m4.1.1.cmml" xref="S6.F4.10.m4.1.1"><csymbol cd="ambiguous" id="S6.F4.10.m4.1.1.1.cmml" xref="S6.F4.10.m4.1.1">subscript</csymbol><ci id="S6.F4.10.m4.1.1.2.cmml" xref="S6.F4.10.m4.1.1.2">ℎ</ci><ci id="S6.F4.10.m4.1.1.3.cmml" xref="S6.F4.10.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.10.m4.1d">h_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.F4.10.m4.1e">italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="h^{\prime}_{j}" class="ltx_Math" display="inline" id="S6.F4.11.m5.1"><semantics id="S6.F4.11.m5.1b"><msubsup id="S6.F4.11.m5.1.1" xref="S6.F4.11.m5.1.1.cmml"><mi id="S6.F4.11.m5.1.1.2.2" xref="S6.F4.11.m5.1.1.2.2.cmml">h</mi><mi id="S6.F4.11.m5.1.1.3" xref="S6.F4.11.m5.1.1.3.cmml">j</mi><mo id="S6.F4.11.m5.1.1.2.3" xref="S6.F4.11.m5.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S6.F4.11.m5.1c"><apply id="S6.F4.11.m5.1.1.cmml" xref="S6.F4.11.m5.1.1"><csymbol cd="ambiguous" id="S6.F4.11.m5.1.1.1.cmml" xref="S6.F4.11.m5.1.1">subscript</csymbol><apply id="S6.F4.11.m5.1.1.2.cmml" xref="S6.F4.11.m5.1.1"><csymbol cd="ambiguous" id="S6.F4.11.m5.1.1.2.1.cmml" xref="S6.F4.11.m5.1.1">superscript</csymbol><ci id="S6.F4.11.m5.1.1.2.2.cmml" xref="S6.F4.11.m5.1.1.2.2">ℎ</ci><ci id="S6.F4.11.m5.1.1.2.3.cmml" xref="S6.F4.11.m5.1.1.2.3">′</ci></apply><ci id="S6.F4.11.m5.1.1.3.cmml" xref="S6.F4.11.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.11.m5.1d">h^{\prime}_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.F4.11.m5.1e">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and the concatenated vector would be used by the remaining parts of the model</figcaption>
</figure>
<div class="ltx_para" id="S6.SS1.SSS2.p1">
<p class="ltx_p" id="S6.SS1.SSS2.p1.13">In SR-GNN, a Graph Neural Network (GNN) is used to encode session <math alttext="I_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.1.m1.1"><semantics id="S6.SS1.SSS2.p1.1.m1.1a"><msub id="S6.SS1.SSS2.p1.1.m1.1.1" xref="S6.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S6.SS1.SSS2.p1.1.m1.1.1.2" xref="S6.SS1.SSS2.p1.1.m1.1.1.2.cmml">I</mi><mi id="S6.SS1.SSS2.p1.1.m1.1.1.3" xref="S6.SS1.SSS2.p1.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.1.m1.1b"><apply id="S6.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S6.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S6.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S6.SS1.SSS2.p1.1.m1.1.1.2">𝐼</ci><ci id="S6.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S6.SS1.SSS2.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.1.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> containing items. A detailed description of how GNN works can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#A1.SS2" title="A.2 SR-GNN Architecture ‣ Appendix A Appendix ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">A.2</span></a>. After this GNN item encoder, a raw available session <math alttext="I_{S}=\{i_{1},i_{2},\cdots,i_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.2.m2.4"><semantics id="S6.SS1.SSS2.p1.2.m2.4a"><mrow id="S6.SS1.SSS2.p1.2.m2.4.4" xref="S6.SS1.SSS2.p1.2.m2.4.4.cmml"><msub id="S6.SS1.SSS2.p1.2.m2.4.4.5" xref="S6.SS1.SSS2.p1.2.m2.4.4.5.cmml"><mi id="S6.SS1.SSS2.p1.2.m2.4.4.5.2" xref="S6.SS1.SSS2.p1.2.m2.4.4.5.2.cmml">I</mi><mi id="S6.SS1.SSS2.p1.2.m2.4.4.5.3" xref="S6.SS1.SSS2.p1.2.m2.4.4.5.3.cmml">S</mi></msub><mo id="S6.SS1.SSS2.p1.2.m2.4.4.4" xref="S6.SS1.SSS2.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS2.p1.2.m2.4.4.3.3" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.4.cmml"><mo id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1" xref="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.2" xref="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.2.cmml">i</mi><mn id="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.3" xref="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.5" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2" xref="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.2" xref="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.2.cmml">i</mi><mn id="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.3" xref="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.6" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS2.p1.2.m2.1.1" mathvariant="normal" xref="S6.SS1.SSS2.p1.2.m2.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.7" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.2" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.2.cmml">i</mi><mi id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.3" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.2.m2.4b"><apply id="S6.SS1.SSS2.p1.2.m2.4.4.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4"><eq id="S6.SS1.SSS2.p1.2.m2.4.4.4.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.4"></eq><apply id="S6.SS1.SSS2.p1.2.m2.4.4.5.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.2.m2.4.4.5.1.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.5">subscript</csymbol><ci id="S6.SS1.SSS2.p1.2.m2.4.4.5.2.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.5.2">𝐼</ci><ci id="S6.SS1.SSS2.p1.2.m2.4.4.5.3.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.5.3">𝑆</ci></apply><set id="S6.SS1.SSS2.p1.2.m2.4.4.3.4.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3"><apply id="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.cmml" xref="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.2">𝑖</ci><cn id="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.cmml" xref="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.2">𝑖</ci><cn id="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S6.SS1.SSS2.p1.2.m2.1.1">⋯</ci><apply id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.2">𝑖</ci><ci id="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS2.p1.2.m2.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.2.m2.4c">I_{S}=\{i_{1},i_{2},\cdots,i_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.2.m2.4d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> is encoded into <math alttext="\{h_{1},h_{2},\cdots,h_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.3.m3.4"><semantics id="S6.SS1.SSS2.p1.3.m3.4a"><mrow id="S6.SS1.SSS2.p1.3.m3.4.4.3" xref="S6.SS1.SSS2.p1.3.m3.4.4.4.cmml"><mo id="S6.SS1.SSS2.p1.3.m3.4.4.3.4" stretchy="false" xref="S6.SS1.SSS2.p1.3.m3.4.4.4.cmml">{</mo><msub id="S6.SS1.SSS2.p1.3.m3.2.2.1.1" xref="S6.SS1.SSS2.p1.3.m3.2.2.1.1.cmml"><mi id="S6.SS1.SSS2.p1.3.m3.2.2.1.1.2" xref="S6.SS1.SSS2.p1.3.m3.2.2.1.1.2.cmml">h</mi><mn id="S6.SS1.SSS2.p1.3.m3.2.2.1.1.3" xref="S6.SS1.SSS2.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS2.p1.3.m3.4.4.3.5" xref="S6.SS1.SSS2.p1.3.m3.4.4.4.cmml">,</mo><msub id="S6.SS1.SSS2.p1.3.m3.3.3.2.2" xref="S6.SS1.SSS2.p1.3.m3.3.3.2.2.cmml"><mi id="S6.SS1.SSS2.p1.3.m3.3.3.2.2.2" xref="S6.SS1.SSS2.p1.3.m3.3.3.2.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p1.3.m3.3.3.2.2.3" xref="S6.SS1.SSS2.p1.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS2.p1.3.m3.4.4.3.6" xref="S6.SS1.SSS2.p1.3.m3.4.4.4.cmml">,</mo><mi id="S6.SS1.SSS2.p1.3.m3.1.1" mathvariant="normal" xref="S6.SS1.SSS2.p1.3.m3.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS2.p1.3.m3.4.4.3.7" xref="S6.SS1.SSS2.p1.3.m3.4.4.4.cmml">,</mo><msub id="S6.SS1.SSS2.p1.3.m3.4.4.3.3" xref="S6.SS1.SSS2.p1.3.m3.4.4.3.3.cmml"><mi id="S6.SS1.SSS2.p1.3.m3.4.4.3.3.2" xref="S6.SS1.SSS2.p1.3.m3.4.4.3.3.2.cmml">h</mi><mi id="S6.SS1.SSS2.p1.3.m3.4.4.3.3.3" xref="S6.SS1.SSS2.p1.3.m3.4.4.3.3.3.cmml">t</mi></msub><mo id="S6.SS1.SSS2.p1.3.m3.4.4.3.8" stretchy="false" xref="S6.SS1.SSS2.p1.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.3.m3.4b"><set id="S6.SS1.SSS2.p1.3.m3.4.4.4.cmml" xref="S6.SS1.SSS2.p1.3.m3.4.4.3"><apply id="S6.SS1.SSS2.p1.3.m3.2.2.1.1.cmml" xref="S6.SS1.SSS2.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.3.m3.2.2.1.1.1.cmml" xref="S6.SS1.SSS2.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S6.SS1.SSS2.p1.3.m3.2.2.1.1.2.cmml" xref="S6.SS1.SSS2.p1.3.m3.2.2.1.1.2">ℎ</ci><cn id="S6.SS1.SSS2.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S6.SS1.SSS2.p1.3.m3.3.3.2.2.cmml" xref="S6.SS1.SSS2.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.3.m3.3.3.2.2.1.cmml" xref="S6.SS1.SSS2.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S6.SS1.SSS2.p1.3.m3.3.3.2.2.2.cmml" xref="S6.SS1.SSS2.p1.3.m3.3.3.2.2.2">ℎ</ci><cn id="S6.SS1.SSS2.p1.3.m3.3.3.2.2.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.3.m3.3.3.2.2.3">2</cn></apply><ci id="S6.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S6.SS1.SSS2.p1.3.m3.1.1">⋯</ci><apply id="S6.SS1.SSS2.p1.3.m3.4.4.3.3.cmml" xref="S6.SS1.SSS2.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.3.m3.4.4.3.3.1.cmml" xref="S6.SS1.SSS2.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S6.SS1.SSS2.p1.3.m3.4.4.3.3.2.cmml" xref="S6.SS1.SSS2.p1.3.m3.4.4.3.3.2">ℎ</ci><ci id="S6.SS1.SSS2.p1.3.m3.4.4.3.3.3.cmml" xref="S6.SS1.SSS2.p1.3.m3.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.3.m3.4c">\{h_{1},h_{2},\cdots,h_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.3.m3.4d">{ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>. 
<br class="ltx_break"/>
<br class="ltx_break"/>Same as how SR-GNN encodes each session, we will use a GNN to encode side information <math alttext="Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.4.m4.1"><semantics id="S6.SS1.SSS2.p1.4.m4.1a"><mrow id="S6.SS1.SSS2.p1.4.m4.1.1" xref="S6.SS1.SSS2.p1.4.m4.1.1.cmml"><mi id="S6.SS1.SSS2.p1.4.m4.1.1.2" xref="S6.SS1.SSS2.p1.4.m4.1.1.2.cmml">S</mi><mo id="S6.SS1.SSS2.p1.4.m4.1.1.1" xref="S6.SS1.SSS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.4.m4.1.1.3" xref="S6.SS1.SSS2.p1.4.m4.1.1.3.cmml">i</mi><mo id="S6.SS1.SSS2.p1.4.m4.1.1.1a" xref="S6.SS1.SSS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.4.m4.1.1.4" xref="S6.SS1.SSS2.p1.4.m4.1.1.4.cmml">d</mi><mo id="S6.SS1.SSS2.p1.4.m4.1.1.1b" xref="S6.SS1.SSS2.p1.4.m4.1.1.1.cmml">⁢</mo><msub id="S6.SS1.SSS2.p1.4.m4.1.1.5" xref="S6.SS1.SSS2.p1.4.m4.1.1.5.cmml"><mi id="S6.SS1.SSS2.p1.4.m4.1.1.5.2" xref="S6.SS1.SSS2.p1.4.m4.1.1.5.2.cmml">e</mi><mi id="S6.SS1.SSS2.p1.4.m4.1.1.5.3" xref="S6.SS1.SSS2.p1.4.m4.1.1.5.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.4.m4.1b"><apply id="S6.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1"><times id="S6.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.1"></times><ci id="S6.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.2">𝑆</ci><ci id="S6.SS1.SSS2.p1.4.m4.1.1.3.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.3">𝑖</ci><ci id="S6.SS1.SSS2.p1.4.m4.1.1.4.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.4">𝑑</ci><apply id="S6.SS1.SSS2.p1.4.m4.1.1.5.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.4.m4.1.1.5.1.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.5">subscript</csymbol><ci id="S6.SS1.SSS2.p1.4.m4.1.1.5.2.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.5.2">𝑒</ci><ci id="S6.SS1.SSS2.p1.4.m4.1.1.5.3.cmml" xref="S6.SS1.SSS2.p1.4.m4.1.1.5.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.4.m4.1c">Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.4.m4.1d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>. However, <math alttext="Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.5.m5.1"><semantics id="S6.SS1.SSS2.p1.5.m5.1a"><mrow id="S6.SS1.SSS2.p1.5.m5.1.1" xref="S6.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S6.SS1.SSS2.p1.5.m5.1.1.2" xref="S6.SS1.SSS2.p1.5.m5.1.1.2.cmml">S</mi><mo id="S6.SS1.SSS2.p1.5.m5.1.1.1" xref="S6.SS1.SSS2.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.5.m5.1.1.3" xref="S6.SS1.SSS2.p1.5.m5.1.1.3.cmml">i</mi><mo id="S6.SS1.SSS2.p1.5.m5.1.1.1a" xref="S6.SS1.SSS2.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.5.m5.1.1.4" xref="S6.SS1.SSS2.p1.5.m5.1.1.4.cmml">d</mi><mo id="S6.SS1.SSS2.p1.5.m5.1.1.1b" xref="S6.SS1.SSS2.p1.5.m5.1.1.1.cmml">⁢</mo><msub id="S6.SS1.SSS2.p1.5.m5.1.1.5" xref="S6.SS1.SSS2.p1.5.m5.1.1.5.cmml"><mi id="S6.SS1.SSS2.p1.5.m5.1.1.5.2" xref="S6.SS1.SSS2.p1.5.m5.1.1.5.2.cmml">e</mi><mi id="S6.SS1.SSS2.p1.5.m5.1.1.5.3" xref="S6.SS1.SSS2.p1.5.m5.1.1.5.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.5.m5.1b"><apply id="S6.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1"><times id="S6.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.1"></times><ci id="S6.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.2">𝑆</ci><ci id="S6.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.3">𝑖</ci><ci id="S6.SS1.SSS2.p1.5.m5.1.1.4.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.4">𝑑</ci><apply id="S6.SS1.SSS2.p1.5.m5.1.1.5.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.5.m5.1.1.5.1.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.5">subscript</csymbol><ci id="S6.SS1.SSS2.p1.5.m5.1.1.5.2.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.5.2">𝑒</ci><ci id="S6.SS1.SSS2.p1.5.m5.1.1.5.3.cmml" xref="S6.SS1.SSS2.p1.5.m5.1.1.5.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.5.m5.1c">Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.5.m5.1d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> can only be a set of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS2.p1.13.1">integers</span> but not a set of <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS2.p1.13.2">set of integers</span>. This means that <math alttext="s_{j}\in Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.8.m8.1"><semantics id="S6.SS1.SSS2.p1.8.m8.1a"><mrow id="S6.SS1.SSS2.p1.8.m8.1.1" xref="S6.SS1.SSS2.p1.8.m8.1.1.cmml"><msub id="S6.SS1.SSS2.p1.8.m8.1.1.2" xref="S6.SS1.SSS2.p1.8.m8.1.1.2.cmml"><mi id="S6.SS1.SSS2.p1.8.m8.1.1.2.2" xref="S6.SS1.SSS2.p1.8.m8.1.1.2.2.cmml">s</mi><mi id="S6.SS1.SSS2.p1.8.m8.1.1.2.3" xref="S6.SS1.SSS2.p1.8.m8.1.1.2.3.cmml">j</mi></msub><mo id="S6.SS1.SSS2.p1.8.m8.1.1.1" xref="S6.SS1.SSS2.p1.8.m8.1.1.1.cmml">∈</mo><mrow id="S6.SS1.SSS2.p1.8.m8.1.1.3" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.cmml"><mi id="S6.SS1.SSS2.p1.8.m8.1.1.3.2" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.2.cmml">S</mi><mo id="S6.SS1.SSS2.p1.8.m8.1.1.3.1" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.8.m8.1.1.3.3" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.3.cmml">i</mi><mo id="S6.SS1.SSS2.p1.8.m8.1.1.3.1a" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.8.m8.1.1.3.4" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.4.cmml">d</mi><mo id="S6.SS1.SSS2.p1.8.m8.1.1.3.1b" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.1.cmml">⁢</mo><msub id="S6.SS1.SSS2.p1.8.m8.1.1.3.5" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.5.cmml"><mi id="S6.SS1.SSS2.p1.8.m8.1.1.3.5.2" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.5.2.cmml">e</mi><mi id="S6.SS1.SSS2.p1.8.m8.1.1.3.5.3" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.5.3.cmml">S</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.8.m8.1b"><apply id="S6.SS1.SSS2.p1.8.m8.1.1.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1"><in id="S6.SS1.SSS2.p1.8.m8.1.1.1.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.1"></in><apply id="S6.SS1.SSS2.p1.8.m8.1.1.2.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.8.m8.1.1.2.1.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p1.8.m8.1.1.2.2.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.2.2">𝑠</ci><ci id="S6.SS1.SSS2.p1.8.m8.1.1.2.3.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.2.3">𝑗</ci></apply><apply id="S6.SS1.SSS2.p1.8.m8.1.1.3.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3"><times id="S6.SS1.SSS2.p1.8.m8.1.1.3.1.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.1"></times><ci id="S6.SS1.SSS2.p1.8.m8.1.1.3.2.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.2">𝑆</ci><ci id="S6.SS1.SSS2.p1.8.m8.1.1.3.3.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.3">𝑖</ci><ci id="S6.SS1.SSS2.p1.8.m8.1.1.3.4.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.4">𝑑</ci><apply id="S6.SS1.SSS2.p1.8.m8.1.1.3.5.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.8.m8.1.1.3.5.1.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.5">subscript</csymbol><ci id="S6.SS1.SSS2.p1.8.m8.1.1.3.5.2.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.5.2">𝑒</ci><ci id="S6.SS1.SSS2.p1.8.m8.1.1.3.5.3.cmml" xref="S6.SS1.SSS2.p1.8.m8.1.1.3.5.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.8.m8.1c">s_{j}\in Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.8.m8.1d">italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> can only corresponds to <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS2.p1.13.3">one</span> category of the categorical variable, such as the only category of an item, rather than <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S6.SS1.SSS2.p1.13.4">multiple</span> categories of the categorical variable, such as the various genres of a movie. The reason is that GNN uses the edge between two nodes to represent transition between two items or two categories. However, it is hard for GNN to represents transition between two sets of categories since this cannot be simply represented as an edge between two nodes. Thus, we only focus on the case in which <math alttext="Side_{S}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.11.m11.1"><semantics id="S6.SS1.SSS2.p1.11.m11.1a"><mrow id="S6.SS1.SSS2.p1.11.m11.1.1" xref="S6.SS1.SSS2.p1.11.m11.1.1.cmml"><mi id="S6.SS1.SSS2.p1.11.m11.1.1.2" xref="S6.SS1.SSS2.p1.11.m11.1.1.2.cmml">S</mi><mo id="S6.SS1.SSS2.p1.11.m11.1.1.1" xref="S6.SS1.SSS2.p1.11.m11.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.11.m11.1.1.3" xref="S6.SS1.SSS2.p1.11.m11.1.1.3.cmml">i</mi><mo id="S6.SS1.SSS2.p1.11.m11.1.1.1a" xref="S6.SS1.SSS2.p1.11.m11.1.1.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.11.m11.1.1.4" xref="S6.SS1.SSS2.p1.11.m11.1.1.4.cmml">d</mi><mo id="S6.SS1.SSS2.p1.11.m11.1.1.1b" xref="S6.SS1.SSS2.p1.11.m11.1.1.1.cmml">⁢</mo><msub id="S6.SS1.SSS2.p1.11.m11.1.1.5" xref="S6.SS1.SSS2.p1.11.m11.1.1.5.cmml"><mi id="S6.SS1.SSS2.p1.11.m11.1.1.5.2" xref="S6.SS1.SSS2.p1.11.m11.1.1.5.2.cmml">e</mi><mi id="S6.SS1.SSS2.p1.11.m11.1.1.5.3" xref="S6.SS1.SSS2.p1.11.m11.1.1.5.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.11.m11.1b"><apply id="S6.SS1.SSS2.p1.11.m11.1.1.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1"><times id="S6.SS1.SSS2.p1.11.m11.1.1.1.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.1"></times><ci id="S6.SS1.SSS2.p1.11.m11.1.1.2.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.2">𝑆</ci><ci id="S6.SS1.SSS2.p1.11.m11.1.1.3.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.3">𝑖</ci><ci id="S6.SS1.SSS2.p1.11.m11.1.1.4.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.4">𝑑</ci><apply id="S6.SS1.SSS2.p1.11.m11.1.1.5.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.11.m11.1.1.5.1.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.5">subscript</csymbol><ci id="S6.SS1.SSS2.p1.11.m11.1.1.5.2.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.5.2">𝑒</ci><ci id="S6.SS1.SSS2.p1.11.m11.1.1.5.3.cmml" xref="S6.SS1.SSS2.p1.11.m11.1.1.5.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.11.m11.1c">Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.11.m11.1d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> is a set of integers when evaluating how incorporating side information influences the model’s behavior, and this means that we will only focus on Diginetica and TaFeng and ignore MovieLens.
<br class="ltx_break"/>
<br class="ltx_break"/>After the GNN side information encoder, the raw side information <math alttext="Side_{S}=\{s_{1},s_{2},\cdots,s_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.12.m12.4"><semantics id="S6.SS1.SSS2.p1.12.m12.4a"><mrow id="S6.SS1.SSS2.p1.12.m12.4.4" xref="S6.SS1.SSS2.p1.12.m12.4.4.cmml"><mrow id="S6.SS1.SSS2.p1.12.m12.4.4.5" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.cmml"><mi id="S6.SS1.SSS2.p1.12.m12.4.4.5.2" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.2.cmml">S</mi><mo id="S6.SS1.SSS2.p1.12.m12.4.4.5.1" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.12.m12.4.4.5.3" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.3.cmml">i</mi><mo id="S6.SS1.SSS2.p1.12.m12.4.4.5.1a" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.1.cmml">⁢</mo><mi id="S6.SS1.SSS2.p1.12.m12.4.4.5.4" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.4.cmml">d</mi><mo id="S6.SS1.SSS2.p1.12.m12.4.4.5.1b" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.1.cmml">⁢</mo><msub id="S6.SS1.SSS2.p1.12.m12.4.4.5.5" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.5.cmml"><mi id="S6.SS1.SSS2.p1.12.m12.4.4.5.5.2" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.5.2.cmml">e</mi><mi id="S6.SS1.SSS2.p1.12.m12.4.4.5.5.3" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.5.3.cmml">S</mi></msub></mrow><mo id="S6.SS1.SSS2.p1.12.m12.4.4.4" xref="S6.SS1.SSS2.p1.12.m12.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS2.p1.12.m12.4.4.3.3" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.4.cmml"><mo id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.4.cmml">{</mo><msub id="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1" xref="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.2" xref="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.2.cmml">s</mi><mn id="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.3" xref="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.5" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2" xref="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.2" xref="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.2.cmml">s</mi><mn id="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.3" xref="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.6" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS2.p1.12.m12.1.1" mathvariant="normal" xref="S6.SS1.SSS2.p1.12.m12.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.7" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.2" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.2.cmml">s</mi><mi id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.3" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.12.m12.4b"><apply id="S6.SS1.SSS2.p1.12.m12.4.4.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4"><eq id="S6.SS1.SSS2.p1.12.m12.4.4.4.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.4"></eq><apply id="S6.SS1.SSS2.p1.12.m12.4.4.5.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5"><times id="S6.SS1.SSS2.p1.12.m12.4.4.5.1.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.1"></times><ci id="S6.SS1.SSS2.p1.12.m12.4.4.5.2.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.2">𝑆</ci><ci id="S6.SS1.SSS2.p1.12.m12.4.4.5.3.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.3">𝑖</ci><ci id="S6.SS1.SSS2.p1.12.m12.4.4.5.4.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.4">𝑑</ci><apply id="S6.SS1.SSS2.p1.12.m12.4.4.5.5.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.12.m12.4.4.5.5.1.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.5">subscript</csymbol><ci id="S6.SS1.SSS2.p1.12.m12.4.4.5.5.2.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.5.2">𝑒</ci><ci id="S6.SS1.SSS2.p1.12.m12.4.4.5.5.3.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.5.5.3">𝑆</ci></apply></apply><set id="S6.SS1.SSS2.p1.12.m12.4.4.3.4.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3"><apply id="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.cmml" xref="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.2">𝑠</ci><cn id="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.12.m12.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.cmml" xref="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2">subscript</csymbol><ci id="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.2">𝑠</ci><cn id="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.12.m12.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS2.p1.12.m12.1.1.cmml" xref="S6.SS1.SSS2.p1.12.m12.1.1">⋯</ci><apply id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3">subscript</csymbol><ci id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.2">𝑠</ci><ci id="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS2.p1.12.m12.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.12.m12.4c">Side_{S}=\{s_{1},s_{2},\cdots,s_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.12.m12.4d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> is encoded into <math alttext="h^{s}=\{h^{s}_{1},h^{s}_{2},\cdots,h^{s}_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p1.13.m13.4"><semantics id="S6.SS1.SSS2.p1.13.m13.4a"><mrow id="S6.SS1.SSS2.p1.13.m13.4.4" xref="S6.SS1.SSS2.p1.13.m13.4.4.cmml"><msup id="S6.SS1.SSS2.p1.13.m13.4.4.5" xref="S6.SS1.SSS2.p1.13.m13.4.4.5.cmml"><mi id="S6.SS1.SSS2.p1.13.m13.4.4.5.2" xref="S6.SS1.SSS2.p1.13.m13.4.4.5.2.cmml">h</mi><mi id="S6.SS1.SSS2.p1.13.m13.4.4.5.3" xref="S6.SS1.SSS2.p1.13.m13.4.4.5.3.cmml">s</mi></msup><mo id="S6.SS1.SSS2.p1.13.m13.4.4.4" xref="S6.SS1.SSS2.p1.13.m13.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS2.p1.13.m13.4.4.3.3" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.4.cmml"><mo id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.4.cmml">{</mo><msubsup id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.2" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.3" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.3.cmml">1</mn><mi id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.3" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.5" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.2" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.3" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.3.cmml">2</mn><mi id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.3" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.6" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS2.p1.13.m13.1.1" mathvariant="normal" xref="S6.SS1.SSS2.p1.13.m13.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.7" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.2" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.2.cmml">h</mi><mi id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.3" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.3.cmml">t</mi><mi id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.3" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p1.13.m13.4b"><apply id="S6.SS1.SSS2.p1.13.m13.4.4.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4"><eq id="S6.SS1.SSS2.p1.13.m13.4.4.4.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.4"></eq><apply id="S6.SS1.SSS2.p1.13.m13.4.4.5.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.13.m13.4.4.5.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.5">superscript</csymbol><ci id="S6.SS1.SSS2.p1.13.m13.4.4.5.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.5.2">ℎ</ci><ci id="S6.SS1.SSS2.p1.13.m13.4.4.5.3.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.5.3">𝑠</ci></apply><set id="S6.SS1.SSS2.p1.13.m13.4.4.3.4.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3"><apply id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1">subscript</csymbol><apply id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1">superscript</csymbol><ci id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.3.cmml" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.2.3">𝑠</ci></apply><cn id="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.13.m13.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2">subscript</csymbol><apply id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2">superscript</csymbol><ci id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.3.cmml" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.2.3">𝑠</ci></apply><cn id="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS2.p1.13.m13.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS2.p1.13.m13.1.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.1.1">⋯</ci><apply id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3">subscript</csymbol><apply id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.1.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3">superscript</csymbol><ci id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.2.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.3.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS2.p1.13.m13.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p1.13.m13.4c">h^{s}=\{h^{s}_{1},h^{s}_{2},\cdots,h^{s}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p1.13.m13.4d">italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT = { italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S6.SS1.SSS2.p2">
<p class="ltx_p" id="S6.SS1.SSS2.p2.9">For both RepeatNet and SR-GNN, after obtaining <math alttext="h^{i}=\{h^{i}_{1},h^{i}_{2},\cdots,h^{i}_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.1.m1.4"><semantics id="S6.SS1.SSS2.p2.1.m1.4a"><mrow id="S6.SS1.SSS2.p2.1.m1.4.4" xref="S6.SS1.SSS2.p2.1.m1.4.4.cmml"><msup id="S6.SS1.SSS2.p2.1.m1.4.4.5" xref="S6.SS1.SSS2.p2.1.m1.4.4.5.cmml"><mi id="S6.SS1.SSS2.p2.1.m1.4.4.5.2" xref="S6.SS1.SSS2.p2.1.m1.4.4.5.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.1.m1.4.4.5.3" xref="S6.SS1.SSS2.p2.1.m1.4.4.5.3.cmml">i</mi></msup><mo id="S6.SS1.SSS2.p2.1.m1.4.4.4" xref="S6.SS1.SSS2.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS2.p2.1.m1.4.4.3.3" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.4.cmml"><mo id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.4.cmml">{</mo><msubsup id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.2" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.3" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.3.cmml">1</mn><mi id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.3" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.5" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.2" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.3" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.3.cmml">2</mn><mi id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.3" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.6" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS2.p2.1.m1.1.1" mathvariant="normal" xref="S6.SS1.SSS2.p2.1.m1.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.7" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.2" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.3" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.3.cmml">t</mi><mi id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.3" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.3.cmml">i</mi></msubsup><mo id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.1.m1.4b"><apply id="S6.SS1.SSS2.p2.1.m1.4.4.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4"><eq id="S6.SS1.SSS2.p2.1.m1.4.4.4.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.4"></eq><apply id="S6.SS1.SSS2.p2.1.m1.4.4.5.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.1.m1.4.4.5.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.5">superscript</csymbol><ci id="S6.SS1.SSS2.p2.1.m1.4.4.5.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.5.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.1.m1.4.4.5.3.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.5.3">𝑖</ci></apply><set id="S6.SS1.SSS2.p2.1.m1.4.4.3.4.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3"><apply id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.2.3">𝑖</ci></apply><cn id="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS2.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2">subscript</csymbol><apply id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2">superscript</csymbol><ci id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.2.3">𝑖</ci></apply><cn id="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS2.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.1.1">⋯</ci><apply id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3">subscript</csymbol><apply id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.1.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3">superscript</csymbol><ci id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.2.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.3.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.2.3">𝑖</ci></apply><ci id="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS2.p2.1.m1.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.1.m1.4c">h^{i}=\{h^{i}_{1},h^{i}_{2},\cdots,h^{i}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.1.m1.4d">italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = { italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="h^{s}=\{h^{s}_{1},h^{s}_{2},\cdots,h^{s}_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.2.m2.4"><semantics id="S6.SS1.SSS2.p2.2.m2.4a"><mrow id="S6.SS1.SSS2.p2.2.m2.4.4" xref="S6.SS1.SSS2.p2.2.m2.4.4.cmml"><msup id="S6.SS1.SSS2.p2.2.m2.4.4.5" xref="S6.SS1.SSS2.p2.2.m2.4.4.5.cmml"><mi id="S6.SS1.SSS2.p2.2.m2.4.4.5.2" xref="S6.SS1.SSS2.p2.2.m2.4.4.5.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.2.m2.4.4.5.3" xref="S6.SS1.SSS2.p2.2.m2.4.4.5.3.cmml">s</mi></msup><mo id="S6.SS1.SSS2.p2.2.m2.4.4.4" xref="S6.SS1.SSS2.p2.2.m2.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS2.p2.2.m2.4.4.3.3" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.4.cmml"><mo id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.4.cmml">{</mo><msubsup id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.2" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.3" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.3.cmml">1</mn><mi id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.3" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.5" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.2" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.3" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.3.cmml">2</mn><mi id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.3" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.6" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS2.p2.2.m2.1.1" mathvariant="normal" xref="S6.SS1.SSS2.p2.2.m2.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.7" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.2" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.3" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.3.cmml">t</mi><mi id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.3" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.3.cmml">s</mi></msubsup><mo id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.2.m2.4b"><apply id="S6.SS1.SSS2.p2.2.m2.4.4.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4"><eq id="S6.SS1.SSS2.p2.2.m2.4.4.4.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.4"></eq><apply id="S6.SS1.SSS2.p2.2.m2.4.4.5.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.5"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.2.m2.4.4.5.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.5">superscript</csymbol><ci id="S6.SS1.SSS2.p2.2.m2.4.4.5.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.5.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.2.m2.4.4.5.3.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.5.3">𝑠</ci></apply><set id="S6.SS1.SSS2.p2.2.m2.4.4.3.4.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3"><apply id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1">subscript</csymbol><apply id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.3.cmml" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.2.3">𝑠</ci></apply><cn id="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS2.p2.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2">subscript</csymbol><apply id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2">superscript</csymbol><ci id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.3.cmml" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.2.3">𝑠</ci></apply><cn id="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS2.p2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.1.1">⋯</ci><apply id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3">subscript</csymbol><apply id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.1.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3">superscript</csymbol><ci id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.2.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.3.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS2.p2.2.m2.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.2.m2.4c">h^{s}=\{h^{s}_{1},h^{s}_{2},\cdots,h^{s}_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.2.m2.4d">italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT = { italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>, we generate <math alttext="h=\{h_{1},h_{2},\cdots,h_{t}\}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.3.m3.4"><semantics id="S6.SS1.SSS2.p2.3.m3.4a"><mrow id="S6.SS1.SSS2.p2.3.m3.4.4" xref="S6.SS1.SSS2.p2.3.m3.4.4.cmml"><mi id="S6.SS1.SSS2.p2.3.m3.4.4.5" xref="S6.SS1.SSS2.p2.3.m3.4.4.5.cmml">h</mi><mo id="S6.SS1.SSS2.p2.3.m3.4.4.4" xref="S6.SS1.SSS2.p2.3.m3.4.4.4.cmml">=</mo><mrow id="S6.SS1.SSS2.p2.3.m3.4.4.3.3" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.4.cmml"><mo id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.4" stretchy="false" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.4.cmml">{</mo><msub id="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1" xref="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.cmml"><mi id="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.2" xref="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.2.cmml">h</mi><mn id="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.3" xref="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.5" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2" xref="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.cmml"><mi id="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.2" xref="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.2.cmml">h</mi><mn id="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.3" xref="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.6" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.4.cmml">,</mo><mi id="S6.SS1.SSS2.p2.3.m3.1.1" mathvariant="normal" xref="S6.SS1.SSS2.p2.3.m3.1.1.cmml">⋯</mi><mo id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.7" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.4.cmml">,</mo><msub id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.cmml"><mi id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.2" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.3" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.3.cmml">t</mi></msub><mo id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.8" stretchy="false" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.3.m3.4b"><apply id="S6.SS1.SSS2.p2.3.m3.4.4.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4"><eq id="S6.SS1.SSS2.p2.3.m3.4.4.4.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4.4"></eq><ci id="S6.SS1.SSS2.p2.3.m3.4.4.5.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4.5">ℎ</ci><set id="S6.SS1.SSS2.p2.3.m3.4.4.3.4.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3"><apply id="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.cmml" xref="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.2.cmml" xref="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.2">ℎ</ci><cn id="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S6.SS1.SSS2.p2.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.cmml" xref="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.1.cmml" xref="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.2.cmml" xref="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.2">ℎ</ci><cn id="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S6.SS1.SSS2.p2.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S6.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S6.SS1.SSS2.p2.3.m3.1.1">⋯</ci><apply id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.1.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.2.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.3.cmml" xref="S6.SS1.SSS2.p2.3.m3.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.3.m3.4c">h=\{h_{1},h_{2},\cdots,h_{t}\}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.3.m3.4d">italic_h = { italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> based on <math alttext="h^{s}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.4.m4.1"><semantics id="S6.SS1.SSS2.p2.4.m4.1a"><msup id="S6.SS1.SSS2.p2.4.m4.1.1" xref="S6.SS1.SSS2.p2.4.m4.1.1.cmml"><mi id="S6.SS1.SSS2.p2.4.m4.1.1.2" xref="S6.SS1.SSS2.p2.4.m4.1.1.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.4.m4.1.1.3" xref="S6.SS1.SSS2.p2.4.m4.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.4.m4.1b"><apply id="S6.SS1.SSS2.p2.4.m4.1.1.cmml" xref="S6.SS1.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.4.m4.1.1.1.cmml" xref="S6.SS1.SSS2.p2.4.m4.1.1">superscript</csymbol><ci id="S6.SS1.SSS2.p2.4.m4.1.1.2.cmml" xref="S6.SS1.SSS2.p2.4.m4.1.1.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.4.m4.1.1.3.cmml" xref="S6.SS1.SSS2.p2.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.4.m4.1c">h^{s}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.4.m4.1d">italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="h^{i}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.5.m5.1"><semantics id="S6.SS1.SSS2.p2.5.m5.1a"><msup id="S6.SS1.SSS2.p2.5.m5.1.1" xref="S6.SS1.SSS2.p2.5.m5.1.1.cmml"><mi id="S6.SS1.SSS2.p2.5.m5.1.1.2" xref="S6.SS1.SSS2.p2.5.m5.1.1.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.5.m5.1.1.3" xref="S6.SS1.SSS2.p2.5.m5.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.5.m5.1b"><apply id="S6.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S6.SS1.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.5.m5.1.1.1.cmml" xref="S6.SS1.SSS2.p2.5.m5.1.1">superscript</csymbol><ci id="S6.SS1.SSS2.p2.5.m5.1.1.2.cmml" xref="S6.SS1.SSS2.p2.5.m5.1.1.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.5.m5.1.1.3.cmml" xref="S6.SS1.SSS2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.5.m5.1c">h^{i}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.5.m5.1d">italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="h_{j}\in h" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.6.m6.1"><semantics id="S6.SS1.SSS2.p2.6.m6.1a"><mrow id="S6.SS1.SSS2.p2.6.m6.1.1" xref="S6.SS1.SSS2.p2.6.m6.1.1.cmml"><msub id="S6.SS1.SSS2.p2.6.m6.1.1.2" xref="S6.SS1.SSS2.p2.6.m6.1.1.2.cmml"><mi id="S6.SS1.SSS2.p2.6.m6.1.1.2.2" xref="S6.SS1.SSS2.p2.6.m6.1.1.2.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.6.m6.1.1.2.3" xref="S6.SS1.SSS2.p2.6.m6.1.1.2.3.cmml">j</mi></msub><mo id="S6.SS1.SSS2.p2.6.m6.1.1.1" xref="S6.SS1.SSS2.p2.6.m6.1.1.1.cmml">∈</mo><mi id="S6.SS1.SSS2.p2.6.m6.1.1.3" xref="S6.SS1.SSS2.p2.6.m6.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.6.m6.1b"><apply id="S6.SS1.SSS2.p2.6.m6.1.1.cmml" xref="S6.SS1.SSS2.p2.6.m6.1.1"><in id="S6.SS1.SSS2.p2.6.m6.1.1.1.cmml" xref="S6.SS1.SSS2.p2.6.m6.1.1.1"></in><apply id="S6.SS1.SSS2.p2.6.m6.1.1.2.cmml" xref="S6.SS1.SSS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.6.m6.1.1.2.1.cmml" xref="S6.SS1.SSS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S6.SS1.SSS2.p2.6.m6.1.1.2.2.cmml" xref="S6.SS1.SSS2.p2.6.m6.1.1.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.6.m6.1.1.2.3.cmml" xref="S6.SS1.SSS2.p2.6.m6.1.1.2.3">𝑗</ci></apply><ci id="S6.SS1.SSS2.p2.6.m6.1.1.3.cmml" xref="S6.SS1.SSS2.p2.6.m6.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.6.m6.1c">h_{j}\in h</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.6.m6.1d">italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_h</annotation></semantics></math> is obtained by concatenating <math alttext="h^{i}_{j}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.7.m7.1"><semantics id="S6.SS1.SSS2.p2.7.m7.1a"><msubsup id="S6.SS1.SSS2.p2.7.m7.1.1" xref="S6.SS1.SSS2.p2.7.m7.1.1.cmml"><mi id="S6.SS1.SSS2.p2.7.m7.1.1.2.2" xref="S6.SS1.SSS2.p2.7.m7.1.1.2.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.7.m7.1.1.3" xref="S6.SS1.SSS2.p2.7.m7.1.1.3.cmml">j</mi><mi id="S6.SS1.SSS2.p2.7.m7.1.1.2.3" xref="S6.SS1.SSS2.p2.7.m7.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.7.m7.1b"><apply id="S6.SS1.SSS2.p2.7.m7.1.1.cmml" xref="S6.SS1.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.7.m7.1.1.1.cmml" xref="S6.SS1.SSS2.p2.7.m7.1.1">subscript</csymbol><apply id="S6.SS1.SSS2.p2.7.m7.1.1.2.cmml" xref="S6.SS1.SSS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.7.m7.1.1.2.1.cmml" xref="S6.SS1.SSS2.p2.7.m7.1.1">superscript</csymbol><ci id="S6.SS1.SSS2.p2.7.m7.1.1.2.2.cmml" xref="S6.SS1.SSS2.p2.7.m7.1.1.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.7.m7.1.1.2.3.cmml" xref="S6.SS1.SSS2.p2.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S6.SS1.SSS2.p2.7.m7.1.1.3.cmml" xref="S6.SS1.SSS2.p2.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.7.m7.1c">h^{i}_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.7.m7.1d">italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h^{s}_{j}" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.8.m8.1"><semantics id="S6.SS1.SSS2.p2.8.m8.1a"><msubsup id="S6.SS1.SSS2.p2.8.m8.1.1" xref="S6.SS1.SSS2.p2.8.m8.1.1.cmml"><mi id="S6.SS1.SSS2.p2.8.m8.1.1.2.2" xref="S6.SS1.SSS2.p2.8.m8.1.1.2.2.cmml">h</mi><mi id="S6.SS1.SSS2.p2.8.m8.1.1.3" xref="S6.SS1.SSS2.p2.8.m8.1.1.3.cmml">j</mi><mi id="S6.SS1.SSS2.p2.8.m8.1.1.2.3" xref="S6.SS1.SSS2.p2.8.m8.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.8.m8.1b"><apply id="S6.SS1.SSS2.p2.8.m8.1.1.cmml" xref="S6.SS1.SSS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.8.m8.1.1.1.cmml" xref="S6.SS1.SSS2.p2.8.m8.1.1">subscript</csymbol><apply id="S6.SS1.SSS2.p2.8.m8.1.1.2.cmml" xref="S6.SS1.SSS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S6.SS1.SSS2.p2.8.m8.1.1.2.1.cmml" xref="S6.SS1.SSS2.p2.8.m8.1.1">superscript</csymbol><ci id="S6.SS1.SSS2.p2.8.m8.1.1.2.2.cmml" xref="S6.SS1.SSS2.p2.8.m8.1.1.2.2">ℎ</ci><ci id="S6.SS1.SSS2.p2.8.m8.1.1.2.3.cmml" xref="S6.SS1.SSS2.p2.8.m8.1.1.2.3">𝑠</ci></apply><ci id="S6.SS1.SSS2.p2.8.m8.1.1.3.cmml" xref="S6.SS1.SSS2.p2.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.8.m8.1c">h^{s}_{j}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.8.m8.1d">italic_h start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> together. We then use this new <math alttext="h" class="ltx_Math" display="inline" id="S6.SS1.SSS2.p2.9.m9.1"><semantics id="S6.SS1.SSS2.p2.9.m9.1a"><mi id="S6.SS1.SSS2.p2.9.m9.1.1" xref="S6.SS1.SSS2.p2.9.m9.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.SSS2.p2.9.m9.1b"><ci id="S6.SS1.SSS2.p2.9.m9.1.1.cmml" xref="S6.SS1.SSS2.p2.9.m9.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.SSS2.p2.9.m9.1c">h</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.SSS2.p2.9.m9.1d">italic_h</annotation></semantics></math> in remaining parts of the RepeatNet or SR-GNN.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Attention loss</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.6">Ideally, the model should pay more attention to an item in a session if that item is similar to the target item. We believe that we can use the attention mechanism more carefully when calculating the vector representing the entire session in both RepeatNet and SR-GNN. Thus, we here propose the attention loss for items as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
<tbody id="S6.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{\text{item attention}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}%
\sum_{I_{S}\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\sum_{t=1}^{r-1}\frac{%
\mathbbm{1}(i_{t}=i_{r})}{|\{j|i_{j}\in I_{S}[1:r-1],i_{j}=i_{r}\}|}\log(%
\alpha_{t})" class="ltx_math_unparsed" display="inline" id="S6.E13.m1.6"><semantics id="S6.E13.m1.6a"><mrow id="S6.E13.m1.6.6"><mrow id="S6.E13.m1.6.6.3"><msub id="S6.E13.m1.6.6.3.2"><mi id="S6.E13.m1.6.6.3.2.2">L</mi><mtext id="S6.E13.m1.6.6.3.2.3">item attention</mtext></msub><mo id="S6.E13.m1.6.6.3.1">⁢</mo><mrow id="S6.E13.m1.6.6.3.3.2"><mo id="S6.E13.m1.6.6.3.3.2.1" stretchy="false">(</mo><mi id="S6.E13.m1.4.4">θ</mi><mo id="S6.E13.m1.6.6.3.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S6.E13.m1.6.6.2">=</mo><mrow id="S6.E13.m1.6.6.1"><mo id="S6.E13.m1.6.6.1a">−</mo><mrow id="S6.E13.m1.6.6.1.1"><mstyle displaystyle="true" id="S6.E13.m1.1.1"><mfrac id="S6.E13.m1.1.1a"><mn id="S6.E13.m1.1.1.3">1</mn><mrow id="S6.E13.m1.1.1.1.1"><mo id="S6.E13.m1.1.1.1.1.2" stretchy="false">|</mo><msub id="S6.E13.m1.1.1.1.1.1"><mi id="S6.E13.m1.1.1.1.1.1.2">𝕀</mi><mi id="S6.E13.m1.1.1.1.1.1.3">𝕊</mi></msub><mo id="S6.E13.m1.1.1.1.1.3" stretchy="false">|</mo></mrow></mfrac></mstyle><mo id="S6.E13.m1.6.6.1.1.2">⁢</mo><mrow id="S6.E13.m1.6.6.1.1.1"><mstyle displaystyle="true" id="S6.E13.m1.6.6.1.1.1.2"><munder id="S6.E13.m1.6.6.1.1.1.2a"><mo id="S6.E13.m1.6.6.1.1.1.2.2" movablelimits="false">∑</mo><mrow id="S6.E13.m1.6.6.1.1.1.2.3"><msub id="S6.E13.m1.6.6.1.1.1.2.3.2"><mi id="S6.E13.m1.6.6.1.1.1.2.3.2.2">I</mi><mi id="S6.E13.m1.6.6.1.1.1.2.3.2.3">S</mi></msub><mo id="S6.E13.m1.6.6.1.1.1.2.3.1">∈</mo><msub id="S6.E13.m1.6.6.1.1.1.2.3.3"><mi id="S6.E13.m1.6.6.1.1.1.2.3.3.2">𝕀</mi><mi id="S6.E13.m1.6.6.1.1.1.2.3.3.3">𝕊</mi></msub></mrow></munder></mstyle><mrow id="S6.E13.m1.6.6.1.1.1.1"><mstyle displaystyle="true" id="S6.E13.m1.6.6.1.1.1.1.2"><munderover id="S6.E13.m1.6.6.1.1.1.1.2a"><mo id="S6.E13.m1.6.6.1.1.1.1.2.2.2" movablelimits="false">∑</mo><mrow id="S6.E13.m1.6.6.1.1.1.1.2.2.3"><mi id="S6.E13.m1.6.6.1.1.1.1.2.2.3.2">r</mi><mo id="S6.E13.m1.6.6.1.1.1.1.2.2.3.1">=</mo><mn id="S6.E13.m1.6.6.1.1.1.1.2.2.3.3">2</mn></mrow><mrow id="S6.E13.m1.2.2.1.1"><mo id="S6.E13.m1.2.2.1.1.2" stretchy="false">|</mo><msub id="S6.E13.m1.2.2.1.1.1"><mi id="S6.E13.m1.2.2.1.1.1.2">I</mi><mi id="S6.E13.m1.2.2.1.1.1.3">S</mi></msub><mo id="S6.E13.m1.2.2.1.1.3" stretchy="false">|</mo></mrow></munderover></mstyle><mrow id="S6.E13.m1.6.6.1.1.1.1.1"><mstyle displaystyle="true" id="S6.E13.m1.6.6.1.1.1.1.1.2"><munderover id="S6.E13.m1.6.6.1.1.1.1.1.2a"><mo id="S6.E13.m1.6.6.1.1.1.1.1.2.2.2" movablelimits="false">∑</mo><mrow id="S6.E13.m1.6.6.1.1.1.1.1.2.2.3"><mi id="S6.E13.m1.6.6.1.1.1.1.1.2.2.3.2">t</mi><mo id="S6.E13.m1.6.6.1.1.1.1.1.2.2.3.1">=</mo><mn id="S6.E13.m1.6.6.1.1.1.1.1.2.2.3.3">1</mn></mrow><mrow id="S6.E13.m1.6.6.1.1.1.1.1.2.3"><mi id="S6.E13.m1.6.6.1.1.1.1.1.2.3.2">r</mi><mo id="S6.E13.m1.6.6.1.1.1.1.1.2.3.1">−</mo><mn id="S6.E13.m1.6.6.1.1.1.1.1.2.3.3">1</mn></mrow></munderover></mstyle><mrow id="S6.E13.m1.6.6.1.1.1.1.1.1"><mstyle displaystyle="true" id="S6.E13.m1.3.3"><mfrac id="S6.E13.m1.3.3a"><mrow id="S6.E13.m1.3.3.1"><mn id="S6.E13.m1.3.3.1.3">𝟙</mn><mo id="S6.E13.m1.3.3.1.2">⁢</mo><mrow id="S6.E13.m1.3.3.1.1.1"><mo id="S6.E13.m1.3.3.1.1.1.2" stretchy="false">(</mo><mrow id="S6.E13.m1.3.3.1.1.1.1"><msub id="S6.E13.m1.3.3.1.1.1.1.2"><mi id="S6.E13.m1.3.3.1.1.1.1.2.2">i</mi><mi id="S6.E13.m1.3.3.1.1.1.1.2.3">t</mi></msub><mo id="S6.E13.m1.3.3.1.1.1.1.1">=</mo><msub id="S6.E13.m1.3.3.1.1.1.1.3"><mi id="S6.E13.m1.3.3.1.1.1.1.3.2">i</mi><mi id="S6.E13.m1.3.3.1.1.1.1.3.3">r</mi></msub></mrow><mo id="S6.E13.m1.3.3.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S6.E13.m1.3.3.3"><mo fence="false" id="S6.E13.m1.3.3.3.1" rspace="0.167em" stretchy="false">|</mo><mrow id="S6.E13.m1.3.3.3.2"><mo id="S6.E13.m1.3.3.3.2.1" stretchy="false">{</mo><mi id="S6.E13.m1.3.3.3.2.2">j</mi><mo fence="false" id="S6.E13.m1.3.3.3.2.3" rspace="0.167em" stretchy="false">|</mo><msub id="S6.E13.m1.3.3.3.2.4"><mi id="S6.E13.m1.3.3.3.2.4.2">i</mi><mi id="S6.E13.m1.3.3.3.2.4.3">j</mi></msub><mo id="S6.E13.m1.3.3.3.2.5">∈</mo><msub id="S6.E13.m1.3.3.3.2.6"><mi id="S6.E13.m1.3.3.3.2.6.2">I</mi><mi id="S6.E13.m1.3.3.3.2.6.3">S</mi></msub><mrow id="S6.E13.m1.3.3.3.2.7"><mo id="S6.E13.m1.3.3.3.2.7.1" stretchy="false">[</mo><mn id="S6.E13.m1.3.3.3.2.7.2">1</mn><mo id="S6.E13.m1.3.3.3.2.7.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S6.E13.m1.3.3.3.2.7.4">r</mi><mo id="S6.E13.m1.3.3.3.2.7.5">−</mo><mn id="S6.E13.m1.3.3.3.2.7.6">1</mn><mo id="S6.E13.m1.3.3.3.2.7.7" stretchy="false">]</mo></mrow><mo id="S6.E13.m1.3.3.3.2.8">,</mo><msub id="S6.E13.m1.3.3.3.2.9"><mi id="S6.E13.m1.3.3.3.2.9.2">i</mi><mi id="S6.E13.m1.3.3.3.2.9.3">j</mi></msub><mo id="S6.E13.m1.3.3.3.2.10">=</mo><msub id="S6.E13.m1.3.3.3.2.11"><mi id="S6.E13.m1.3.3.3.2.11.2">i</mi><mi id="S6.E13.m1.3.3.3.2.11.3">r</mi></msub><mo id="S6.E13.m1.3.3.3.2.12" stretchy="false">}</mo></mrow><mo fence="false" id="S6.E13.m1.3.3.3.3" stretchy="false">|</mo></mrow></mfrac></mstyle><mo id="S6.E13.m1.6.6.1.1.1.1.1.1.2" lspace="0.167em">⁢</mo><mrow id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1"><mi id="S6.E13.m1.5.5">log</mi><mo id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1a">⁡</mo><mrow id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1.1"><mo id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1.1.2" stretchy="false">(</mo><msub id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1"><mi id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">α</mi><mi id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">t</mi></msub><mo id="S6.E13.m1.6.6.1.1.1.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S6.E13.m1.6b">\displaystyle L_{\text{item attention}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}%
\sum_{I_{S}\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\sum_{t=1}^{r-1}\frac{%
\mathbbm{1}(i_{t}=i_{r})}{|\{j|i_{j}\in I_{S}[1:r-1],i_{j}=i_{r}\}|}\log(%
\alpha_{t})</annotation><annotation encoding="application/x-llamapun" id="S6.E13.m1.6c">italic_L start_POSTSUBSCRIPT item attention end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG | blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ∈ blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_r = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_r - 1 end_POSTSUPERSCRIPT divide start_ARG blackboard_1 ( italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_ARG start_ARG | { italic_j | italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ 1 : italic_r - 1 ] , italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT } | end_ARG roman_log ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS2.p1.3">where <math alttext="\mathbb{I_{S}}" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><msub id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml"><mi id="S6.SS2.p1.1.m1.1.1.2" xref="S6.SS2.p1.1.m1.1.1.2.cmml">𝕀</mi><mi id="S6.SS2.p1.1.m1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.3.cmml">𝕊</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><apply id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.1.m1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS2.p1.1.m1.1.1.2.cmml" xref="S6.SS2.p1.1.m1.1.1.2">𝕀</ci><ci id="S6.SS2.p1.1.m1.1.1.3.cmml" xref="S6.SS2.p1.1.m1.1.1.3">𝕊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">\mathbb{I_{S}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT</annotation></semantics></math> represents the set containing all sessions and <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><msub id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml"><mi id="S6.SS2.p1.2.m2.1.1.2" xref="S6.SS2.p1.2.m2.1.1.2.cmml">α</mi><mi id="S6.SS2.p1.2.m2.1.1.3" xref="S6.SS2.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><apply id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.2.m2.1.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S6.SS2.p1.2.m2.1.1.2.cmml" xref="S6.SS2.p1.2.m2.1.1.2">𝛼</ci><ci id="S6.SS2.p1.2.m2.1.1.3.cmml" xref="S6.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the attention weight assigned to the item and side information pair at time step <math alttext="t" class="ltx_Math" display="inline" id="S6.SS2.p1.3.m3.1"><semantics id="S6.SS2.p1.3.m3.1a"><mi id="S6.SS2.p1.3.m3.1.1" xref="S6.SS2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.3.m3.1b"><ci id="S6.SS2.p1.3.m3.1.1.cmml" xref="S6.SS2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.3.m3.1d">italic_t</annotation></semantics></math>. This loss would encourage the attention weights assigned to items that are different from the target item to be 0 and encourage the attention to be uniformly distributed among items that are identical to the target item.
<br class="ltx_break"/>
<br class="ltx_break"/>Additionally, we calculate the attention loss for side information as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx5">
<tbody id="S6.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{\text{side attention}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}%
\sum_{I_{S}\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\sum_{t=1}^{r-1}\frac{%
\mathbbm{1}(s_{t}=s_{r})}{|\{j|s_{j}\in Side_{S}[1:r-1],s_{j}=s_{r}\}|}\log(%
\alpha_{t})" class="ltx_math_unparsed" display="inline" id="S6.E14.m1.6"><semantics id="S6.E14.m1.6a"><mrow id="S6.E14.m1.6.6"><mrow id="S6.E14.m1.6.6.3"><msub id="S6.E14.m1.6.6.3.2"><mi id="S6.E14.m1.6.6.3.2.2">L</mi><mtext id="S6.E14.m1.6.6.3.2.3">side attention</mtext></msub><mo id="S6.E14.m1.6.6.3.1">⁢</mo><mrow id="S6.E14.m1.6.6.3.3.2"><mo id="S6.E14.m1.6.6.3.3.2.1" stretchy="false">(</mo><mi id="S6.E14.m1.4.4">θ</mi><mo id="S6.E14.m1.6.6.3.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S6.E14.m1.6.6.2">=</mo><mrow id="S6.E14.m1.6.6.1"><mo id="S6.E14.m1.6.6.1a">−</mo><mrow id="S6.E14.m1.6.6.1.1"><mstyle displaystyle="true" id="S6.E14.m1.1.1"><mfrac id="S6.E14.m1.1.1a"><mn id="S6.E14.m1.1.1.3">1</mn><mrow id="S6.E14.m1.1.1.1.1"><mo id="S6.E14.m1.1.1.1.1.2" stretchy="false">|</mo><msub id="S6.E14.m1.1.1.1.1.1"><mi id="S6.E14.m1.1.1.1.1.1.2">𝕀</mi><mi id="S6.E14.m1.1.1.1.1.1.3">𝕊</mi></msub><mo id="S6.E14.m1.1.1.1.1.3" stretchy="false">|</mo></mrow></mfrac></mstyle><mo id="S6.E14.m1.6.6.1.1.2">⁢</mo><mrow id="S6.E14.m1.6.6.1.1.1"><mstyle displaystyle="true" id="S6.E14.m1.6.6.1.1.1.2"><munder id="S6.E14.m1.6.6.1.1.1.2a"><mo id="S6.E14.m1.6.6.1.1.1.2.2" movablelimits="false">∑</mo><mrow id="S6.E14.m1.6.6.1.1.1.2.3"><msub id="S6.E14.m1.6.6.1.1.1.2.3.2"><mi id="S6.E14.m1.6.6.1.1.1.2.3.2.2">I</mi><mi id="S6.E14.m1.6.6.1.1.1.2.3.2.3">S</mi></msub><mo id="S6.E14.m1.6.6.1.1.1.2.3.1">∈</mo><msub id="S6.E14.m1.6.6.1.1.1.2.3.3"><mi id="S6.E14.m1.6.6.1.1.1.2.3.3.2">𝕀</mi><mi id="S6.E14.m1.6.6.1.1.1.2.3.3.3">𝕊</mi></msub></mrow></munder></mstyle><mrow id="S6.E14.m1.6.6.1.1.1.1"><mstyle displaystyle="true" id="S6.E14.m1.6.6.1.1.1.1.2"><munderover id="S6.E14.m1.6.6.1.1.1.1.2a"><mo id="S6.E14.m1.6.6.1.1.1.1.2.2.2" movablelimits="false">∑</mo><mrow id="S6.E14.m1.6.6.1.1.1.1.2.2.3"><mi id="S6.E14.m1.6.6.1.1.1.1.2.2.3.2">r</mi><mo id="S6.E14.m1.6.6.1.1.1.1.2.2.3.1">=</mo><mn id="S6.E14.m1.6.6.1.1.1.1.2.2.3.3">2</mn></mrow><mrow id="S6.E14.m1.2.2.1.1"><mo id="S6.E14.m1.2.2.1.1.2" stretchy="false">|</mo><msub id="S6.E14.m1.2.2.1.1.1"><mi id="S6.E14.m1.2.2.1.1.1.2">I</mi><mi id="S6.E14.m1.2.2.1.1.1.3">S</mi></msub><mo id="S6.E14.m1.2.2.1.1.3" stretchy="false">|</mo></mrow></munderover></mstyle><mrow id="S6.E14.m1.6.6.1.1.1.1.1"><mstyle displaystyle="true" id="S6.E14.m1.6.6.1.1.1.1.1.2"><munderover id="S6.E14.m1.6.6.1.1.1.1.1.2a"><mo id="S6.E14.m1.6.6.1.1.1.1.1.2.2.2" movablelimits="false">∑</mo><mrow id="S6.E14.m1.6.6.1.1.1.1.1.2.2.3"><mi id="S6.E14.m1.6.6.1.1.1.1.1.2.2.3.2">t</mi><mo id="S6.E14.m1.6.6.1.1.1.1.1.2.2.3.1">=</mo><mn id="S6.E14.m1.6.6.1.1.1.1.1.2.2.3.3">1</mn></mrow><mrow id="S6.E14.m1.6.6.1.1.1.1.1.2.3"><mi id="S6.E14.m1.6.6.1.1.1.1.1.2.3.2">r</mi><mo id="S6.E14.m1.6.6.1.1.1.1.1.2.3.1">−</mo><mn id="S6.E14.m1.6.6.1.1.1.1.1.2.3.3">1</mn></mrow></munderover></mstyle><mrow id="S6.E14.m1.6.6.1.1.1.1.1.1"><mstyle displaystyle="true" id="S6.E14.m1.3.3"><mfrac id="S6.E14.m1.3.3a"><mrow id="S6.E14.m1.3.3.1"><mn id="S6.E14.m1.3.3.1.3">𝟙</mn><mo id="S6.E14.m1.3.3.1.2">⁢</mo><mrow id="S6.E14.m1.3.3.1.1.1"><mo id="S6.E14.m1.3.3.1.1.1.2" stretchy="false">(</mo><mrow id="S6.E14.m1.3.3.1.1.1.1"><msub id="S6.E14.m1.3.3.1.1.1.1.2"><mi id="S6.E14.m1.3.3.1.1.1.1.2.2">s</mi><mi id="S6.E14.m1.3.3.1.1.1.1.2.3">t</mi></msub><mo id="S6.E14.m1.3.3.1.1.1.1.1">=</mo><msub id="S6.E14.m1.3.3.1.1.1.1.3"><mi id="S6.E14.m1.3.3.1.1.1.1.3.2">s</mi><mi id="S6.E14.m1.3.3.1.1.1.1.3.3">r</mi></msub></mrow><mo id="S6.E14.m1.3.3.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S6.E14.m1.3.3.3"><mo fence="false" id="S6.E14.m1.3.3.3.1" rspace="0.167em" stretchy="false">|</mo><mrow id="S6.E14.m1.3.3.3.2"><mo id="S6.E14.m1.3.3.3.2.1" stretchy="false">{</mo><mi id="S6.E14.m1.3.3.3.2.2">j</mi><mo fence="false" id="S6.E14.m1.3.3.3.2.3" rspace="0.167em" stretchy="false">|</mo><msub id="S6.E14.m1.3.3.3.2.4"><mi id="S6.E14.m1.3.3.3.2.4.2">s</mi><mi id="S6.E14.m1.3.3.3.2.4.3">j</mi></msub><mo id="S6.E14.m1.3.3.3.2.5">∈</mo><mi id="S6.E14.m1.3.3.3.2.6">S</mi><mi id="S6.E14.m1.3.3.3.2.7">i</mi><mi id="S6.E14.m1.3.3.3.2.8">d</mi><msub id="S6.E14.m1.3.3.3.2.9"><mi id="S6.E14.m1.3.3.3.2.9.2">e</mi><mi id="S6.E14.m1.3.3.3.2.9.3">S</mi></msub><mrow id="S6.E14.m1.3.3.3.2.10"><mo id="S6.E14.m1.3.3.3.2.10.1" stretchy="false">[</mo><mn id="S6.E14.m1.3.3.3.2.10.2">1</mn><mo id="S6.E14.m1.3.3.3.2.10.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S6.E14.m1.3.3.3.2.10.4">r</mi><mo id="S6.E14.m1.3.3.3.2.10.5">−</mo><mn id="S6.E14.m1.3.3.3.2.10.6">1</mn><mo id="S6.E14.m1.3.3.3.2.10.7" stretchy="false">]</mo></mrow><mo id="S6.E14.m1.3.3.3.2.11">,</mo><msub id="S6.E14.m1.3.3.3.2.12"><mi id="S6.E14.m1.3.3.3.2.12.2">s</mi><mi id="S6.E14.m1.3.3.3.2.12.3">j</mi></msub><mo id="S6.E14.m1.3.3.3.2.13">=</mo><msub id="S6.E14.m1.3.3.3.2.14"><mi id="S6.E14.m1.3.3.3.2.14.2">s</mi><mi id="S6.E14.m1.3.3.3.2.14.3">r</mi></msub><mo id="S6.E14.m1.3.3.3.2.15" stretchy="false">}</mo></mrow><mo fence="false" id="S6.E14.m1.3.3.3.3" stretchy="false">|</mo></mrow></mfrac></mstyle><mo id="S6.E14.m1.6.6.1.1.1.1.1.1.2" lspace="0.167em">⁢</mo><mrow id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1"><mi id="S6.E14.m1.5.5">log</mi><mo id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1a">⁡</mo><mrow id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1.1"><mo id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1.1.2" stretchy="false">(</mo><msub id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1"><mi id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">α</mi><mi id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">t</mi></msub><mo id="S6.E14.m1.6.6.1.1.1.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S6.E14.m1.6b">\displaystyle L_{\text{side attention}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}%
\sum_{I_{S}\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\sum_{t=1}^{r-1}\frac{%
\mathbbm{1}(s_{t}=s_{r})}{|\{j|s_{j}\in Side_{S}[1:r-1],s_{j}=s_{r}\}|}\log(%
\alpha_{t})</annotation><annotation encoding="application/x-llamapun" id="S6.E14.m1.6c">italic_L start_POSTSUBSCRIPT side attention end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG | blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ∈ blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_r = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_r - 1 end_POSTSUPERSCRIPT divide start_ARG blackboard_1 ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_ARG start_ARG | { italic_j | italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ 1 : italic_r - 1 ] , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT } | end_ARG roman_log ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS2.p1.5">where <math alttext="Side_{S}" class="ltx_Math" display="inline" id="S6.SS2.p1.4.m1.1"><semantics id="S6.SS2.p1.4.m1.1a"><mrow id="S6.SS2.p1.4.m1.1.1" xref="S6.SS2.p1.4.m1.1.1.cmml"><mi id="S6.SS2.p1.4.m1.1.1.2" xref="S6.SS2.p1.4.m1.1.1.2.cmml">S</mi><mo id="S6.SS2.p1.4.m1.1.1.1" xref="S6.SS2.p1.4.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS2.p1.4.m1.1.1.3" xref="S6.SS2.p1.4.m1.1.1.3.cmml">i</mi><mo id="S6.SS2.p1.4.m1.1.1.1a" xref="S6.SS2.p1.4.m1.1.1.1.cmml">⁢</mo><mi id="S6.SS2.p1.4.m1.1.1.4" xref="S6.SS2.p1.4.m1.1.1.4.cmml">d</mi><mo id="S6.SS2.p1.4.m1.1.1.1b" xref="S6.SS2.p1.4.m1.1.1.1.cmml">⁢</mo><msub id="S6.SS2.p1.4.m1.1.1.5" xref="S6.SS2.p1.4.m1.1.1.5.cmml"><mi id="S6.SS2.p1.4.m1.1.1.5.2" xref="S6.SS2.p1.4.m1.1.1.5.2.cmml">e</mi><mi id="S6.SS2.p1.4.m1.1.1.5.3" xref="S6.SS2.p1.4.m1.1.1.5.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.4.m1.1b"><apply id="S6.SS2.p1.4.m1.1.1.cmml" xref="S6.SS2.p1.4.m1.1.1"><times id="S6.SS2.p1.4.m1.1.1.1.cmml" xref="S6.SS2.p1.4.m1.1.1.1"></times><ci id="S6.SS2.p1.4.m1.1.1.2.cmml" xref="S6.SS2.p1.4.m1.1.1.2">𝑆</ci><ci id="S6.SS2.p1.4.m1.1.1.3.cmml" xref="S6.SS2.p1.4.m1.1.1.3">𝑖</ci><ci id="S6.SS2.p1.4.m1.1.1.4.cmml" xref="S6.SS2.p1.4.m1.1.1.4">𝑑</ci><apply id="S6.SS2.p1.4.m1.1.1.5.cmml" xref="S6.SS2.p1.4.m1.1.1.5"><csymbol cd="ambiguous" id="S6.SS2.p1.4.m1.1.1.5.1.cmml" xref="S6.SS2.p1.4.m1.1.1.5">subscript</csymbol><ci id="S6.SS2.p1.4.m1.1.1.5.2.cmml" xref="S6.SS2.p1.4.m1.1.1.5.2">𝑒</ci><ci id="S6.SS2.p1.4.m1.1.1.5.3.cmml" xref="S6.SS2.p1.4.m1.1.1.5.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.4.m1.1c">Side_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.4.m1.1d">italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math> represents the side information corresponding to the session <math alttext="I_{S}" class="ltx_Math" display="inline" id="S6.SS2.p1.5.m2.1"><semantics id="S6.SS2.p1.5.m2.1a"><msub id="S6.SS2.p1.5.m2.1.1" xref="S6.SS2.p1.5.m2.1.1.cmml"><mi id="S6.SS2.p1.5.m2.1.1.2" xref="S6.SS2.p1.5.m2.1.1.2.cmml">I</mi><mi id="S6.SS2.p1.5.m2.1.1.3" xref="S6.SS2.p1.5.m2.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.5.m2.1b"><apply id="S6.SS2.p1.5.m2.1.1.cmml" xref="S6.SS2.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.5.m2.1.1.1.cmml" xref="S6.SS2.p1.5.m2.1.1">subscript</csymbol><ci id="S6.SS2.p1.5.m2.1.1.2.cmml" xref="S6.SS2.p1.5.m2.1.1.2">𝐼</ci><ci id="S6.SS2.p1.5.m2.1.1.3.cmml" xref="S6.SS2.p1.5.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.5.m2.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.5.m2.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>. The above loss encourages the model to pay more attention to an item in a session if that item and the target item share the same side information, and ignore items that do not share the same side information with the target item.
<br class="ltx_break"/>
<br class="ltx_break"/>We define:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx6">
<tbody id="S6.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{ItemTarget}(I_{S},t,r)=\frac{\mathbbm{1}(i_{t}=i_{r})}{|\{j%
|i_{j}\in I_{S}[1:r-1],i_{j}=i_{r}\}|}" class="ltx_math_unparsed" display="inline" id="S6.E15.m1.4"><semantics id="S6.E15.m1.4a"><mrow id="S6.E15.m1.4.4"><mrow id="S6.E15.m1.4.4.1"><mtext id="S6.E15.m1.4.4.1.3">ItemTarget</mtext><mo id="S6.E15.m1.4.4.1.2">⁢</mo><mrow id="S6.E15.m1.4.4.1.1.1"><mo id="S6.E15.m1.4.4.1.1.1.2" stretchy="false">(</mo><msub id="S6.E15.m1.4.4.1.1.1.1"><mi id="S6.E15.m1.4.4.1.1.1.1.2">I</mi><mi id="S6.E15.m1.4.4.1.1.1.1.3">S</mi></msub><mo id="S6.E15.m1.4.4.1.1.1.3">,</mo><mi id="S6.E15.m1.2.2">t</mi><mo id="S6.E15.m1.4.4.1.1.1.4">,</mo><mi id="S6.E15.m1.3.3">r</mi><mo id="S6.E15.m1.4.4.1.1.1.5" stretchy="false">)</mo></mrow></mrow><mo id="S6.E15.m1.4.4.2">=</mo><mstyle displaystyle="true" id="S6.E15.m1.1.1"><mfrac id="S6.E15.m1.1.1a"><mrow id="S6.E15.m1.1.1.1"><mn id="S6.E15.m1.1.1.1.3">𝟙</mn><mo id="S6.E15.m1.1.1.1.2">⁢</mo><mrow id="S6.E15.m1.1.1.1.1.1"><mo id="S6.E15.m1.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S6.E15.m1.1.1.1.1.1.1"><msub id="S6.E15.m1.1.1.1.1.1.1.2"><mi id="S6.E15.m1.1.1.1.1.1.1.2.2">i</mi><mi id="S6.E15.m1.1.1.1.1.1.1.2.3">t</mi></msub><mo id="S6.E15.m1.1.1.1.1.1.1.1">=</mo><msub id="S6.E15.m1.1.1.1.1.1.1.3"><mi id="S6.E15.m1.1.1.1.1.1.1.3.2">i</mi><mi id="S6.E15.m1.1.1.1.1.1.1.3.3">r</mi></msub></mrow><mo id="S6.E15.m1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S6.E15.m1.1.1.3"><mo fence="false" id="S6.E15.m1.1.1.3.1" rspace="0.167em" stretchy="false">|</mo><mrow id="S6.E15.m1.1.1.3.2"><mo id="S6.E15.m1.1.1.3.2.1" stretchy="false">{</mo><mi id="S6.E15.m1.1.1.3.2.2">j</mi><mo fence="false" id="S6.E15.m1.1.1.3.2.3" rspace="0.167em" stretchy="false">|</mo><msub id="S6.E15.m1.1.1.3.2.4"><mi id="S6.E15.m1.1.1.3.2.4.2">i</mi><mi id="S6.E15.m1.1.1.3.2.4.3">j</mi></msub><mo id="S6.E15.m1.1.1.3.2.5">∈</mo><msub id="S6.E15.m1.1.1.3.2.6"><mi id="S6.E15.m1.1.1.3.2.6.2">I</mi><mi id="S6.E15.m1.1.1.3.2.6.3">S</mi></msub><mrow id="S6.E15.m1.1.1.3.2.7"><mo id="S6.E15.m1.1.1.3.2.7.1" stretchy="false">[</mo><mn id="S6.E15.m1.1.1.3.2.7.2">1</mn><mo id="S6.E15.m1.1.1.3.2.7.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S6.E15.m1.1.1.3.2.7.4">r</mi><mo id="S6.E15.m1.1.1.3.2.7.5">−</mo><mn id="S6.E15.m1.1.1.3.2.7.6">1</mn><mo id="S6.E15.m1.1.1.3.2.7.7" stretchy="false">]</mo></mrow><mo id="S6.E15.m1.1.1.3.2.8">,</mo><msub id="S6.E15.m1.1.1.3.2.9"><mi id="S6.E15.m1.1.1.3.2.9.2">i</mi><mi id="S6.E15.m1.1.1.3.2.9.3">j</mi></msub><mo id="S6.E15.m1.1.1.3.2.10">=</mo><msub id="S6.E15.m1.1.1.3.2.11"><mi id="S6.E15.m1.1.1.3.2.11.2">i</mi><mi id="S6.E15.m1.1.1.3.2.11.3">r</mi></msub><mo id="S6.E15.m1.1.1.3.2.12" stretchy="false">}</mo></mrow><mo fence="false" id="S6.E15.m1.1.1.3.3" stretchy="false">|</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex" id="S6.E15.m1.4b">\displaystyle\text{ItemTarget}(I_{S},t,r)=\frac{\mathbbm{1}(i_{t}=i_{r})}{|\{j%
|i_{j}\in I_{S}[1:r-1],i_{j}=i_{r}\}|}</annotation><annotation encoding="application/x-llamapun" id="S6.E15.m1.4c">ItemTarget ( italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_t , italic_r ) = divide start_ARG blackboard_1 ( italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_ARG start_ARG | { italic_j | italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ 1 : italic_r - 1 ] , italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT } | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="S6.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{SideTarget}(Side_{S},t,r)=\frac{\mathbbm{1}(s_{t}=s_{r})}{|%
\{j|s_{j}\in Side_{S}[1:r-1],s_{j}=s_{r}\}|}" class="ltx_math_unparsed" display="inline" id="S6.E16.m1.4"><semantics id="S6.E16.m1.4a"><mrow id="S6.E16.m1.4.4"><mrow id="S6.E16.m1.4.4.1"><mtext id="S6.E16.m1.4.4.1.3">SideTarget</mtext><mo id="S6.E16.m1.4.4.1.2">⁢</mo><mrow id="S6.E16.m1.4.4.1.1.1"><mo id="S6.E16.m1.4.4.1.1.1.2" stretchy="false">(</mo><mrow id="S6.E16.m1.4.4.1.1.1.1"><mi id="S6.E16.m1.4.4.1.1.1.1.2">S</mi><mo id="S6.E16.m1.4.4.1.1.1.1.1">⁢</mo><mi id="S6.E16.m1.4.4.1.1.1.1.3">i</mi><mo id="S6.E16.m1.4.4.1.1.1.1.1a">⁢</mo><mi id="S6.E16.m1.4.4.1.1.1.1.4">d</mi><mo id="S6.E16.m1.4.4.1.1.1.1.1b">⁢</mo><msub id="S6.E16.m1.4.4.1.1.1.1.5"><mi id="S6.E16.m1.4.4.1.1.1.1.5.2">e</mi><mi id="S6.E16.m1.4.4.1.1.1.1.5.3">S</mi></msub></mrow><mo id="S6.E16.m1.4.4.1.1.1.3">,</mo><mi id="S6.E16.m1.2.2">t</mi><mo id="S6.E16.m1.4.4.1.1.1.4">,</mo><mi id="S6.E16.m1.3.3">r</mi><mo id="S6.E16.m1.4.4.1.1.1.5" stretchy="false">)</mo></mrow></mrow><mo id="S6.E16.m1.4.4.2">=</mo><mstyle displaystyle="true" id="S6.E16.m1.1.1"><mfrac id="S6.E16.m1.1.1a"><mrow id="S6.E16.m1.1.1.1"><mn id="S6.E16.m1.1.1.1.3">𝟙</mn><mo id="S6.E16.m1.1.1.1.2">⁢</mo><mrow id="S6.E16.m1.1.1.1.1.1"><mo id="S6.E16.m1.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S6.E16.m1.1.1.1.1.1.1"><msub id="S6.E16.m1.1.1.1.1.1.1.2"><mi id="S6.E16.m1.1.1.1.1.1.1.2.2">s</mi><mi id="S6.E16.m1.1.1.1.1.1.1.2.3">t</mi></msub><mo id="S6.E16.m1.1.1.1.1.1.1.1">=</mo><msub id="S6.E16.m1.1.1.1.1.1.1.3"><mi id="S6.E16.m1.1.1.1.1.1.1.3.2">s</mi><mi id="S6.E16.m1.1.1.1.1.1.1.3.3">r</mi></msub></mrow><mo id="S6.E16.m1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S6.E16.m1.1.1.3"><mo fence="false" id="S6.E16.m1.1.1.3.1" rspace="0.167em" stretchy="false">|</mo><mrow id="S6.E16.m1.1.1.3.2"><mo id="S6.E16.m1.1.1.3.2.1" stretchy="false">{</mo><mi id="S6.E16.m1.1.1.3.2.2">j</mi><mo fence="false" id="S6.E16.m1.1.1.3.2.3" rspace="0.167em" stretchy="false">|</mo><msub id="S6.E16.m1.1.1.3.2.4"><mi id="S6.E16.m1.1.1.3.2.4.2">s</mi><mi id="S6.E16.m1.1.1.3.2.4.3">j</mi></msub><mo id="S6.E16.m1.1.1.3.2.5">∈</mo><mi id="S6.E16.m1.1.1.3.2.6">S</mi><mi id="S6.E16.m1.1.1.3.2.7">i</mi><mi id="S6.E16.m1.1.1.3.2.8">d</mi><msub id="S6.E16.m1.1.1.3.2.9"><mi id="S6.E16.m1.1.1.3.2.9.2">e</mi><mi id="S6.E16.m1.1.1.3.2.9.3">S</mi></msub><mrow id="S6.E16.m1.1.1.3.2.10"><mo id="S6.E16.m1.1.1.3.2.10.1" stretchy="false">[</mo><mn id="S6.E16.m1.1.1.3.2.10.2">1</mn><mo id="S6.E16.m1.1.1.3.2.10.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S6.E16.m1.1.1.3.2.10.4">r</mi><mo id="S6.E16.m1.1.1.3.2.10.5">−</mo><mn id="S6.E16.m1.1.1.3.2.10.6">1</mn><mo id="S6.E16.m1.1.1.3.2.10.7" stretchy="false">]</mo></mrow><mo id="S6.E16.m1.1.1.3.2.11">,</mo><msub id="S6.E16.m1.1.1.3.2.12"><mi id="S6.E16.m1.1.1.3.2.12.2">s</mi><mi id="S6.E16.m1.1.1.3.2.12.3">j</mi></msub><mo id="S6.E16.m1.1.1.3.2.13">=</mo><msub id="S6.E16.m1.1.1.3.2.14"><mi id="S6.E16.m1.1.1.3.2.14.2">s</mi><mi id="S6.E16.m1.1.1.3.2.14.3">r</mi></msub><mo id="S6.E16.m1.1.1.3.2.15" stretchy="false">}</mo></mrow><mo fence="false" id="S6.E16.m1.1.1.3.3" stretchy="false">|</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex" id="S6.E16.m1.4b">\displaystyle\text{SideTarget}(Side_{S},t,r)=\frac{\mathbbm{1}(s_{t}=s_{r})}{|%
\{j|s_{j}\in Side_{S}[1:r-1],s_{j}=s_{r}\}|}</annotation><annotation encoding="application/x-llamapun" id="S6.E16.m1.4c">SideTarget ( italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_t , italic_r ) = divide start_ARG blackboard_1 ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_ARG start_ARG | { italic_j | italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ 1 : italic_r - 1 ] , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_s start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT } | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS2.p1.7">Then, the attention loss we incorporate into the loss term of the model would be:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx7">
<tbody id="S6.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{\text{attention}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}\sum_{I_%
{S}\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\sum_{t=1}^{r-1}\frac{\text{%
ItemTarget}(I_{S},t,r)+\text{SideTarget}(Side_{S},t,r)}{2}\log(\alpha_{t})" class="ltx_Math" display="inline" id="S6.E17.m1.11"><semantics id="S6.E17.m1.11a"><mrow id="S6.E17.m1.11.11" xref="S6.E17.m1.11.11.cmml"><mrow id="S6.E17.m1.11.11.3" xref="S6.E17.m1.11.11.3.cmml"><msub id="S6.E17.m1.11.11.3.2" xref="S6.E17.m1.11.11.3.2.cmml"><mi id="S6.E17.m1.11.11.3.2.2" xref="S6.E17.m1.11.11.3.2.2.cmml">L</mi><mtext id="S6.E17.m1.11.11.3.2.3" xref="S6.E17.m1.11.11.3.2.3a.cmml">attention</mtext></msub><mo id="S6.E17.m1.11.11.3.1" xref="S6.E17.m1.11.11.3.1.cmml">⁢</mo><mrow id="S6.E17.m1.11.11.3.3.2" xref="S6.E17.m1.11.11.3.cmml"><mo id="S6.E17.m1.11.11.3.3.2.1" stretchy="false" xref="S6.E17.m1.11.11.3.cmml">(</mo><mi id="S6.E17.m1.9.9" xref="S6.E17.m1.9.9.cmml">θ</mi><mo id="S6.E17.m1.11.11.3.3.2.2" stretchy="false" xref="S6.E17.m1.11.11.3.cmml">)</mo></mrow></mrow><mo id="S6.E17.m1.11.11.2" xref="S6.E17.m1.11.11.2.cmml">=</mo><mrow id="S6.E17.m1.11.11.1" xref="S6.E17.m1.11.11.1.cmml"><mo id="S6.E17.m1.11.11.1a" xref="S6.E17.m1.11.11.1.cmml">−</mo><mrow id="S6.E17.m1.11.11.1.1" xref="S6.E17.m1.11.11.1.1.cmml"><mstyle displaystyle="true" id="S6.E17.m1.1.1" xref="S6.E17.m1.1.1.cmml"><mfrac id="S6.E17.m1.1.1a" xref="S6.E17.m1.1.1.cmml"><mn id="S6.E17.m1.1.1.3" xref="S6.E17.m1.1.1.3.cmml">1</mn><mrow id="S6.E17.m1.1.1.1.1" xref="S6.E17.m1.1.1.1.2.cmml"><mo id="S6.E17.m1.1.1.1.1.2" stretchy="false" xref="S6.E17.m1.1.1.1.2.1.cmml">|</mo><msub id="S6.E17.m1.1.1.1.1.1" xref="S6.E17.m1.1.1.1.1.1.cmml"><mi id="S6.E17.m1.1.1.1.1.1.2" xref="S6.E17.m1.1.1.1.1.1.2.cmml">𝕀</mi><mi id="S6.E17.m1.1.1.1.1.1.3" xref="S6.E17.m1.1.1.1.1.1.3.cmml">𝕊</mi></msub><mo id="S6.E17.m1.1.1.1.1.3" stretchy="false" xref="S6.E17.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S6.E17.m1.11.11.1.1.2" xref="S6.E17.m1.11.11.1.1.2.cmml">⁢</mo><mrow id="S6.E17.m1.11.11.1.1.1" xref="S6.E17.m1.11.11.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E17.m1.11.11.1.1.1.2" xref="S6.E17.m1.11.11.1.1.1.2.cmml"><munder id="S6.E17.m1.11.11.1.1.1.2a" xref="S6.E17.m1.11.11.1.1.1.2.cmml"><mo id="S6.E17.m1.11.11.1.1.1.2.2" movablelimits="false" xref="S6.E17.m1.11.11.1.1.1.2.2.cmml">∑</mo><mrow id="S6.E17.m1.11.11.1.1.1.2.3" xref="S6.E17.m1.11.11.1.1.1.2.3.cmml"><msub id="S6.E17.m1.11.11.1.1.1.2.3.2" xref="S6.E17.m1.11.11.1.1.1.2.3.2.cmml"><mi id="S6.E17.m1.11.11.1.1.1.2.3.2.2" xref="S6.E17.m1.11.11.1.1.1.2.3.2.2.cmml">I</mi><mi id="S6.E17.m1.11.11.1.1.1.2.3.2.3" xref="S6.E17.m1.11.11.1.1.1.2.3.2.3.cmml">S</mi></msub><mo id="S6.E17.m1.11.11.1.1.1.2.3.1" xref="S6.E17.m1.11.11.1.1.1.2.3.1.cmml">∈</mo><msub id="S6.E17.m1.11.11.1.1.1.2.3.3" xref="S6.E17.m1.11.11.1.1.1.2.3.3.cmml"><mi id="S6.E17.m1.11.11.1.1.1.2.3.3.2" xref="S6.E17.m1.11.11.1.1.1.2.3.3.2.cmml">𝕀</mi><mi id="S6.E17.m1.11.11.1.1.1.2.3.3.3" xref="S6.E17.m1.11.11.1.1.1.2.3.3.3.cmml">𝕊</mi></msub></mrow></munder></mstyle><mrow id="S6.E17.m1.11.11.1.1.1.1" xref="S6.E17.m1.11.11.1.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E17.m1.11.11.1.1.1.1.2" xref="S6.E17.m1.11.11.1.1.1.1.2.cmml"><munderover id="S6.E17.m1.11.11.1.1.1.1.2a" xref="S6.E17.m1.11.11.1.1.1.1.2.cmml"><mo id="S6.E17.m1.11.11.1.1.1.1.2.2.2" movablelimits="false" xref="S6.E17.m1.11.11.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S6.E17.m1.11.11.1.1.1.1.2.2.3" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3.cmml"><mi id="S6.E17.m1.11.11.1.1.1.1.2.2.3.2" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3.2.cmml">r</mi><mo id="S6.E17.m1.11.11.1.1.1.1.2.2.3.1" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S6.E17.m1.11.11.1.1.1.1.2.2.3.3" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3.3.cmml">2</mn></mrow><mrow id="S6.E17.m1.2.2.1.1" xref="S6.E17.m1.2.2.1.2.cmml"><mo id="S6.E17.m1.2.2.1.1.2" stretchy="false" xref="S6.E17.m1.2.2.1.2.1.cmml">|</mo><msub id="S6.E17.m1.2.2.1.1.1" xref="S6.E17.m1.2.2.1.1.1.cmml"><mi id="S6.E17.m1.2.2.1.1.1.2" xref="S6.E17.m1.2.2.1.1.1.2.cmml">I</mi><mi id="S6.E17.m1.2.2.1.1.1.3" xref="S6.E17.m1.2.2.1.1.1.3.cmml">S</mi></msub><mo id="S6.E17.m1.2.2.1.1.3" stretchy="false" xref="S6.E17.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S6.E17.m1.11.11.1.1.1.1.1" xref="S6.E17.m1.11.11.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E17.m1.11.11.1.1.1.1.1.2" xref="S6.E17.m1.11.11.1.1.1.1.1.2.cmml"><munderover id="S6.E17.m1.11.11.1.1.1.1.1.2a" xref="S6.E17.m1.11.11.1.1.1.1.1.2.cmml"><mo id="S6.E17.m1.11.11.1.1.1.1.1.2.2.2" movablelimits="false" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.cmml"><mi id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.2" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.1" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.3" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S6.E17.m1.11.11.1.1.1.1.1.2.3" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3.cmml"><mi id="S6.E17.m1.11.11.1.1.1.1.1.2.3.2" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3.2.cmml">r</mi><mo id="S6.E17.m1.11.11.1.1.1.1.1.2.3.1" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S6.E17.m1.11.11.1.1.1.1.1.2.3.3" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S6.E17.m1.11.11.1.1.1.1.1.1" xref="S6.E17.m1.11.11.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S6.E17.m1.8.8" xref="S6.E17.m1.8.8.cmml"><mfrac id="S6.E17.m1.8.8a" xref="S6.E17.m1.8.8.cmml"><mrow id="S6.E17.m1.8.8.6" xref="S6.E17.m1.8.8.6.cmml"><mrow id="S6.E17.m1.7.7.5.5" xref="S6.E17.m1.7.7.5.5.cmml"><mtext id="S6.E17.m1.7.7.5.5.3" xref="S6.E17.m1.7.7.5.5.3a.cmml">ItemTarget</mtext><mo id="S6.E17.m1.7.7.5.5.2" xref="S6.E17.m1.7.7.5.5.2.cmml">⁢</mo><mrow id="S6.E17.m1.7.7.5.5.1.1" xref="S6.E17.m1.7.7.5.5.1.2.cmml"><mo id="S6.E17.m1.7.7.5.5.1.1.2" stretchy="false" xref="S6.E17.m1.7.7.5.5.1.2.cmml">(</mo><msub id="S6.E17.m1.7.7.5.5.1.1.1" xref="S6.E17.m1.7.7.5.5.1.1.1.cmml"><mi id="S6.E17.m1.7.7.5.5.1.1.1.2" xref="S6.E17.m1.7.7.5.5.1.1.1.2.cmml">I</mi><mi id="S6.E17.m1.7.7.5.5.1.1.1.3" xref="S6.E17.m1.7.7.5.5.1.1.1.3.cmml">S</mi></msub><mo id="S6.E17.m1.7.7.5.5.1.1.3" xref="S6.E17.m1.7.7.5.5.1.2.cmml">,</mo><mi id="S6.E17.m1.3.3.1.1" xref="S6.E17.m1.3.3.1.1.cmml">t</mi><mo id="S6.E17.m1.7.7.5.5.1.1.4" xref="S6.E17.m1.7.7.5.5.1.2.cmml">,</mo><mi id="S6.E17.m1.4.4.2.2" xref="S6.E17.m1.4.4.2.2.cmml">r</mi><mo id="S6.E17.m1.7.7.5.5.1.1.5" stretchy="false" xref="S6.E17.m1.7.7.5.5.1.2.cmml">)</mo></mrow></mrow><mo id="S6.E17.m1.8.8.6.7" xref="S6.E17.m1.8.8.6.7.cmml">+</mo><mrow id="S6.E17.m1.8.8.6.6" xref="S6.E17.m1.8.8.6.6.cmml"><mtext id="S6.E17.m1.8.8.6.6.3" xref="S6.E17.m1.8.8.6.6.3a.cmml">SideTarget</mtext><mo id="S6.E17.m1.8.8.6.6.2" xref="S6.E17.m1.8.8.6.6.2.cmml">⁢</mo><mrow id="S6.E17.m1.8.8.6.6.1.1" xref="S6.E17.m1.8.8.6.6.1.2.cmml"><mo id="S6.E17.m1.8.8.6.6.1.1.2" stretchy="false" xref="S6.E17.m1.8.8.6.6.1.2.cmml">(</mo><mrow id="S6.E17.m1.8.8.6.6.1.1.1" xref="S6.E17.m1.8.8.6.6.1.1.1.cmml"><mi id="S6.E17.m1.8.8.6.6.1.1.1.2" xref="S6.E17.m1.8.8.6.6.1.1.1.2.cmml">S</mi><mo id="S6.E17.m1.8.8.6.6.1.1.1.1" xref="S6.E17.m1.8.8.6.6.1.1.1.1.cmml">⁢</mo><mi id="S6.E17.m1.8.8.6.6.1.1.1.3" xref="S6.E17.m1.8.8.6.6.1.1.1.3.cmml">i</mi><mo id="S6.E17.m1.8.8.6.6.1.1.1.1a" xref="S6.E17.m1.8.8.6.6.1.1.1.1.cmml">⁢</mo><mi id="S6.E17.m1.8.8.6.6.1.1.1.4" xref="S6.E17.m1.8.8.6.6.1.1.1.4.cmml">d</mi><mo id="S6.E17.m1.8.8.6.6.1.1.1.1b" xref="S6.E17.m1.8.8.6.6.1.1.1.1.cmml">⁢</mo><msub id="S6.E17.m1.8.8.6.6.1.1.1.5" xref="S6.E17.m1.8.8.6.6.1.1.1.5.cmml"><mi id="S6.E17.m1.8.8.6.6.1.1.1.5.2" xref="S6.E17.m1.8.8.6.6.1.1.1.5.2.cmml">e</mi><mi id="S6.E17.m1.8.8.6.6.1.1.1.5.3" xref="S6.E17.m1.8.8.6.6.1.1.1.5.3.cmml">S</mi></msub></mrow><mo id="S6.E17.m1.8.8.6.6.1.1.3" xref="S6.E17.m1.8.8.6.6.1.2.cmml">,</mo><mi id="S6.E17.m1.5.5.3.3" xref="S6.E17.m1.5.5.3.3.cmml">t</mi><mo id="S6.E17.m1.8.8.6.6.1.1.4" xref="S6.E17.m1.8.8.6.6.1.2.cmml">,</mo><mi id="S6.E17.m1.6.6.4.4" xref="S6.E17.m1.6.6.4.4.cmml">r</mi><mo id="S6.E17.m1.8.8.6.6.1.1.5" stretchy="false" xref="S6.E17.m1.8.8.6.6.1.2.cmml">)</mo></mrow></mrow></mrow><mn id="S6.E17.m1.8.8.8" xref="S6.E17.m1.8.8.8.cmml">2</mn></mfrac></mstyle><mo id="S6.E17.m1.11.11.1.1.1.1.1.1.2" lspace="0.167em" xref="S6.E17.m1.11.11.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.2.cmml"><mi id="S6.E17.m1.10.10" xref="S6.E17.m1.10.10.cmml">log</mi><mo id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1a" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.2.cmml"><mo id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.2.cmml">α</mi><mi id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E17.m1.11b"><apply id="S6.E17.m1.11.11.cmml" xref="S6.E17.m1.11.11"><eq id="S6.E17.m1.11.11.2.cmml" xref="S6.E17.m1.11.11.2"></eq><apply id="S6.E17.m1.11.11.3.cmml" xref="S6.E17.m1.11.11.3"><times id="S6.E17.m1.11.11.3.1.cmml" xref="S6.E17.m1.11.11.3.1"></times><apply id="S6.E17.m1.11.11.3.2.cmml" xref="S6.E17.m1.11.11.3.2"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.3.2.1.cmml" xref="S6.E17.m1.11.11.3.2">subscript</csymbol><ci id="S6.E17.m1.11.11.3.2.2.cmml" xref="S6.E17.m1.11.11.3.2.2">𝐿</ci><ci id="S6.E17.m1.11.11.3.2.3a.cmml" xref="S6.E17.m1.11.11.3.2.3"><mtext id="S6.E17.m1.11.11.3.2.3.cmml" mathsize="70%" xref="S6.E17.m1.11.11.3.2.3">attention</mtext></ci></apply><ci id="S6.E17.m1.9.9.cmml" xref="S6.E17.m1.9.9">𝜃</ci></apply><apply id="S6.E17.m1.11.11.1.cmml" xref="S6.E17.m1.11.11.1"><minus id="S6.E17.m1.11.11.1.2.cmml" xref="S6.E17.m1.11.11.1"></minus><apply id="S6.E17.m1.11.11.1.1.cmml" xref="S6.E17.m1.11.11.1.1"><times id="S6.E17.m1.11.11.1.1.2.cmml" xref="S6.E17.m1.11.11.1.1.2"></times><apply id="S6.E17.m1.1.1.cmml" xref="S6.E17.m1.1.1"><divide id="S6.E17.m1.1.1.2.cmml" xref="S6.E17.m1.1.1"></divide><cn id="S6.E17.m1.1.1.3.cmml" type="integer" xref="S6.E17.m1.1.1.3">1</cn><apply id="S6.E17.m1.1.1.1.2.cmml" xref="S6.E17.m1.1.1.1.1"><abs id="S6.E17.m1.1.1.1.2.1.cmml" xref="S6.E17.m1.1.1.1.1.2"></abs><apply id="S6.E17.m1.1.1.1.1.1.cmml" xref="S6.E17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E17.m1.1.1.1.1.1.1.cmml" xref="S6.E17.m1.1.1.1.1.1">subscript</csymbol><ci id="S6.E17.m1.1.1.1.1.1.2.cmml" xref="S6.E17.m1.1.1.1.1.1.2">𝕀</ci><ci id="S6.E17.m1.1.1.1.1.1.3.cmml" xref="S6.E17.m1.1.1.1.1.1.3">𝕊</ci></apply></apply></apply><apply id="S6.E17.m1.11.11.1.1.1.cmml" xref="S6.E17.m1.11.11.1.1.1"><apply id="S6.E17.m1.11.11.1.1.1.2.cmml" xref="S6.E17.m1.11.11.1.1.1.2"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.2.1.cmml" xref="S6.E17.m1.11.11.1.1.1.2">subscript</csymbol><sum id="S6.E17.m1.11.11.1.1.1.2.2.cmml" xref="S6.E17.m1.11.11.1.1.1.2.2"></sum><apply id="S6.E17.m1.11.11.1.1.1.2.3.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3"><in id="S6.E17.m1.11.11.1.1.1.2.3.1.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.1"></in><apply id="S6.E17.m1.11.11.1.1.1.2.3.2.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.2.3.2.1.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.2">subscript</csymbol><ci id="S6.E17.m1.11.11.1.1.1.2.3.2.2.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.2.2">𝐼</ci><ci id="S6.E17.m1.11.11.1.1.1.2.3.2.3.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.2.3">𝑆</ci></apply><apply id="S6.E17.m1.11.11.1.1.1.2.3.3.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.2.3.3.1.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.3">subscript</csymbol><ci id="S6.E17.m1.11.11.1.1.1.2.3.3.2.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.3.2">𝕀</ci><ci id="S6.E17.m1.11.11.1.1.1.2.3.3.3.cmml" xref="S6.E17.m1.11.11.1.1.1.2.3.3.3">𝕊</ci></apply></apply></apply><apply id="S6.E17.m1.11.11.1.1.1.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1"><apply id="S6.E17.m1.11.11.1.1.1.1.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.1.2.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2">superscript</csymbol><apply id="S6.E17.m1.11.11.1.1.1.1.2.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.1.2.2.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2">subscript</csymbol><sum id="S6.E17.m1.11.11.1.1.1.1.2.2.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2.2.2"></sum><apply id="S6.E17.m1.11.11.1.1.1.1.2.2.3.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3"><eq id="S6.E17.m1.11.11.1.1.1.1.2.2.3.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3.1"></eq><ci id="S6.E17.m1.11.11.1.1.1.1.2.2.3.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3.2">𝑟</ci><cn id="S6.E17.m1.11.11.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S6.E17.m1.11.11.1.1.1.1.2.2.3.3">2</cn></apply></apply><apply id="S6.E17.m1.2.2.1.2.cmml" xref="S6.E17.m1.2.2.1.1"><abs id="S6.E17.m1.2.2.1.2.1.cmml" xref="S6.E17.m1.2.2.1.1.2"></abs><apply id="S6.E17.m1.2.2.1.1.1.cmml" xref="S6.E17.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.E17.m1.2.2.1.1.1.1.cmml" xref="S6.E17.m1.2.2.1.1.1">subscript</csymbol><ci id="S6.E17.m1.2.2.1.1.1.2.cmml" xref="S6.E17.m1.2.2.1.1.1.2">𝐼</ci><ci id="S6.E17.m1.2.2.1.1.1.3.cmml" xref="S6.E17.m1.2.2.1.1.1.3">𝑆</ci></apply></apply></apply><apply id="S6.E17.m1.11.11.1.1.1.1.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1"><apply id="S6.E17.m1.11.11.1.1.1.1.1.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.1.1.2.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2">superscript</csymbol><apply id="S6.E17.m1.11.11.1.1.1.1.1.2.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.1.1.2.2.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2">subscript</csymbol><sum id="S6.E17.m1.11.11.1.1.1.1.1.2.2.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.2"></sum><apply id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3"><eq id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.1"></eq><ci id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S6.E17.m1.11.11.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S6.E17.m1.11.11.1.1.1.1.1.2.3.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3"><minus id="S6.E17.m1.11.11.1.1.1.1.1.2.3.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3.1"></minus><ci id="S6.E17.m1.11.11.1.1.1.1.1.2.3.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3.2">𝑟</ci><cn id="S6.E17.m1.11.11.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S6.E17.m1.11.11.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S6.E17.m1.11.11.1.1.1.1.1.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.1"><times id="S6.E17.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.1.2"></times><apply id="S6.E17.m1.8.8.cmml" xref="S6.E17.m1.8.8"><divide id="S6.E17.m1.8.8.7.cmml" xref="S6.E17.m1.8.8"></divide><apply id="S6.E17.m1.8.8.6.cmml" xref="S6.E17.m1.8.8.6"><plus id="S6.E17.m1.8.8.6.7.cmml" xref="S6.E17.m1.8.8.6.7"></plus><apply id="S6.E17.m1.7.7.5.5.cmml" xref="S6.E17.m1.7.7.5.5"><times id="S6.E17.m1.7.7.5.5.2.cmml" xref="S6.E17.m1.7.7.5.5.2"></times><ci id="S6.E17.m1.7.7.5.5.3a.cmml" xref="S6.E17.m1.7.7.5.5.3"><mtext id="S6.E17.m1.7.7.5.5.3.cmml" xref="S6.E17.m1.7.7.5.5.3">ItemTarget</mtext></ci><vector id="S6.E17.m1.7.7.5.5.1.2.cmml" xref="S6.E17.m1.7.7.5.5.1.1"><apply id="S6.E17.m1.7.7.5.5.1.1.1.cmml" xref="S6.E17.m1.7.7.5.5.1.1.1"><csymbol cd="ambiguous" id="S6.E17.m1.7.7.5.5.1.1.1.1.cmml" xref="S6.E17.m1.7.7.5.5.1.1.1">subscript</csymbol><ci id="S6.E17.m1.7.7.5.5.1.1.1.2.cmml" xref="S6.E17.m1.7.7.5.5.1.1.1.2">𝐼</ci><ci id="S6.E17.m1.7.7.5.5.1.1.1.3.cmml" xref="S6.E17.m1.7.7.5.5.1.1.1.3">𝑆</ci></apply><ci id="S6.E17.m1.3.3.1.1.cmml" xref="S6.E17.m1.3.3.1.1">𝑡</ci><ci id="S6.E17.m1.4.4.2.2.cmml" xref="S6.E17.m1.4.4.2.2">𝑟</ci></vector></apply><apply id="S6.E17.m1.8.8.6.6.cmml" xref="S6.E17.m1.8.8.6.6"><times id="S6.E17.m1.8.8.6.6.2.cmml" xref="S6.E17.m1.8.8.6.6.2"></times><ci id="S6.E17.m1.8.8.6.6.3a.cmml" xref="S6.E17.m1.8.8.6.6.3"><mtext id="S6.E17.m1.8.8.6.6.3.cmml" xref="S6.E17.m1.8.8.6.6.3">SideTarget</mtext></ci><vector id="S6.E17.m1.8.8.6.6.1.2.cmml" xref="S6.E17.m1.8.8.6.6.1.1"><apply id="S6.E17.m1.8.8.6.6.1.1.1.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1"><times id="S6.E17.m1.8.8.6.6.1.1.1.1.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.1"></times><ci id="S6.E17.m1.8.8.6.6.1.1.1.2.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.2">𝑆</ci><ci id="S6.E17.m1.8.8.6.6.1.1.1.3.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.3">𝑖</ci><ci id="S6.E17.m1.8.8.6.6.1.1.1.4.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.4">𝑑</ci><apply id="S6.E17.m1.8.8.6.6.1.1.1.5.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.5"><csymbol cd="ambiguous" id="S6.E17.m1.8.8.6.6.1.1.1.5.1.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.5">subscript</csymbol><ci id="S6.E17.m1.8.8.6.6.1.1.1.5.2.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.5.2">𝑒</ci><ci id="S6.E17.m1.8.8.6.6.1.1.1.5.3.cmml" xref="S6.E17.m1.8.8.6.6.1.1.1.5.3">𝑆</ci></apply></apply><ci id="S6.E17.m1.5.5.3.3.cmml" xref="S6.E17.m1.5.5.3.3">𝑡</ci><ci id="S6.E17.m1.6.6.4.4.cmml" xref="S6.E17.m1.6.6.4.4">𝑟</ci></vector></apply></apply><cn id="S6.E17.m1.8.8.8.cmml" type="integer" xref="S6.E17.m1.8.8.8">2</cn></apply><apply id="S6.E17.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1"><log id="S6.E17.m1.10.10.cmml" xref="S6.E17.m1.10.10"></log><apply id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.2">𝛼</ci><ci id="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E17.m1.11.11.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E17.m1.11c">\displaystyle L_{\text{attention}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}\sum_{I_%
{S}\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\sum_{t=1}^{r-1}\frac{\text{%
ItemTarget}(I_{S},t,r)+\text{SideTarget}(Side_{S},t,r)}{2}\log(\alpha_{t})</annotation><annotation encoding="application/x-llamapun" id="S6.E17.m1.11d">italic_L start_POSTSUBSCRIPT attention end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG | blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ∈ blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_r = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_r - 1 end_POSTSUPERSCRIPT divide start_ARG ItemTarget ( italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_t , italic_r ) + SideTarget ( italic_S italic_i italic_d italic_e start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_t , italic_r ) end_ARG start_ARG 2 end_ARG roman_log ( italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS2.p1.8">The attention loss defined above encourages the model to pay more attention to an item in a session if that item is identical to the target item, or if that item shares the same side information with the target item.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Experimental result</h2>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Experiment setup</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">To achieve fair and comparable experimental results, we follow the model hyperparameter settings as described in the models’ original paper (RepeatNet <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib3" title="">2019</a>)</cite> and SR-GNN <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib5" title="">2019</a>)</cite>).</p>
</div>
<div class="ltx_para" id="S7.SS1.p2">
<p class="ltx_p" id="S7.SS1.p2.8">Specifically, for RepeatNet, we set item embedding size <math alttext="s_{\texttt{item\_embedding}}=100" class="ltx_Math" display="inline" id="S7.SS1.p2.1.m1.1"><semantics id="S7.SS1.p2.1.m1.1a"><mrow id="S7.SS1.p2.1.m1.1.1" xref="S7.SS1.p2.1.m1.1.1.cmml"><msub id="S7.SS1.p2.1.m1.1.1.2" xref="S7.SS1.p2.1.m1.1.1.2.cmml"><mi id="S7.SS1.p2.1.m1.1.1.2.2" xref="S7.SS1.p2.1.m1.1.1.2.2.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p2.1.m1.1.1.2.3" xref="S7.SS1.p2.1.m1.1.1.2.3a.cmml">item_embedding</mtext></msub><mo id="S7.SS1.p2.1.m1.1.1.1" xref="S7.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS1.p2.1.m1.1.1.3" xref="S7.SS1.p2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.1.m1.1b"><apply id="S7.SS1.p2.1.m1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1"><eq id="S7.SS1.p2.1.m1.1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1.1"></eq><apply id="S7.SS1.p2.1.m1.1.1.2.cmml" xref="S7.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.1.m1.1.1.2.1.cmml" xref="S7.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS1.p2.1.m1.1.1.2.2.cmml" xref="S7.SS1.p2.1.m1.1.1.2.2">𝑠</ci><ci id="S7.SS1.p2.1.m1.1.1.2.3a.cmml" xref="S7.SS1.p2.1.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p2.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S7.SS1.p2.1.m1.1.1.2.3">item_embedding</mtext></ci></apply><cn id="S7.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="S7.SS1.p2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.1.m1.1c">s_{\texttt{item\_embedding}}=100</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT item_embedding end_POSTSUBSCRIPT = 100</annotation></semantics></math>, side embedding size <math alttext="s_{\texttt{side\_embedding}}=100" class="ltx_Math" display="inline" id="S7.SS1.p2.2.m2.1"><semantics id="S7.SS1.p2.2.m2.1a"><mrow id="S7.SS1.p2.2.m2.1.1" xref="S7.SS1.p2.2.m2.1.1.cmml"><msub id="S7.SS1.p2.2.m2.1.1.2" xref="S7.SS1.p2.2.m2.1.1.2.cmml"><mi id="S7.SS1.p2.2.m2.1.1.2.2" xref="S7.SS1.p2.2.m2.1.1.2.2.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p2.2.m2.1.1.2.3" xref="S7.SS1.p2.2.m2.1.1.2.3a.cmml">side_embedding</mtext></msub><mo id="S7.SS1.p2.2.m2.1.1.1" xref="S7.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS1.p2.2.m2.1.1.3" xref="S7.SS1.p2.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.2.m2.1b"><apply id="S7.SS1.p2.2.m2.1.1.cmml" xref="S7.SS1.p2.2.m2.1.1"><eq id="S7.SS1.p2.2.m2.1.1.1.cmml" xref="S7.SS1.p2.2.m2.1.1.1"></eq><apply id="S7.SS1.p2.2.m2.1.1.2.cmml" xref="S7.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.2.m2.1.1.2.1.cmml" xref="S7.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S7.SS1.p2.2.m2.1.1.2.2.cmml" xref="S7.SS1.p2.2.m2.1.1.2.2">𝑠</ci><ci id="S7.SS1.p2.2.m2.1.1.2.3a.cmml" xref="S7.SS1.p2.2.m2.1.1.2.3"><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p2.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S7.SS1.p2.2.m2.1.1.2.3">side_embedding</mtext></ci></apply><cn id="S7.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S7.SS1.p2.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.2.m2.1c">s_{\texttt{side\_embedding}}=100</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.2.m2.1d">italic_s start_POSTSUBSCRIPT side_embedding end_POSTSUBSCRIPT = 100</annotation></semantics></math>, hidden size <math alttext="s_{\texttt{hidden}}=100" class="ltx_Math" display="inline" id="S7.SS1.p2.3.m3.1"><semantics id="S7.SS1.p2.3.m3.1a"><mrow id="S7.SS1.p2.3.m3.1.1" xref="S7.SS1.p2.3.m3.1.1.cmml"><msub id="S7.SS1.p2.3.m3.1.1.2" xref="S7.SS1.p2.3.m3.1.1.2.cmml"><mi id="S7.SS1.p2.3.m3.1.1.2.2" xref="S7.SS1.p2.3.m3.1.1.2.2.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p2.3.m3.1.1.2.3" xref="S7.SS1.p2.3.m3.1.1.2.3a.cmml">hidden</mtext></msub><mo id="S7.SS1.p2.3.m3.1.1.1" xref="S7.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S7.SS1.p2.3.m3.1.1.3" xref="S7.SS1.p2.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.3.m3.1b"><apply id="S7.SS1.p2.3.m3.1.1.cmml" xref="S7.SS1.p2.3.m3.1.1"><eq id="S7.SS1.p2.3.m3.1.1.1.cmml" xref="S7.SS1.p2.3.m3.1.1.1"></eq><apply id="S7.SS1.p2.3.m3.1.1.2.cmml" xref="S7.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.3.m3.1.1.2.1.cmml" xref="S7.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S7.SS1.p2.3.m3.1.1.2.2.cmml" xref="S7.SS1.p2.3.m3.1.1.2.2">𝑠</ci><ci id="S7.SS1.p2.3.m3.1.1.2.3a.cmml" xref="S7.SS1.p2.3.m3.1.1.2.3"><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p2.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S7.SS1.p2.3.m3.1.1.2.3">hidden</mtext></ci></apply><cn id="S7.SS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S7.SS1.p2.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.3.m3.1c">s_{\texttt{hidden}}=100</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.3.m3.1d">italic_s start_POSTSUBSCRIPT hidden end_POSTSUBSCRIPT = 100</annotation></semantics></math>, and the item vocab size and side vocab size vary by dataset. We use a batch size of <math alttext="128" class="ltx_Math" display="inline" id="S7.SS1.p2.4.m4.1"><semantics id="S7.SS1.p2.4.m4.1a"><mn id="S7.SS1.p2.4.m4.1.1" xref="S7.SS1.p2.4.m4.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.4.m4.1b"><cn id="S7.SS1.p2.4.m4.1.1.cmml" type="integer" xref="S7.SS1.p2.4.m4.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.4.m4.1c">128</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.4.m4.1d">128</annotation></semantics></math> and an Adam optimizer with initial learning rate <math alttext="lr=1e-3" class="ltx_Math" display="inline" id="S7.SS1.p2.5.m5.1"><semantics id="S7.SS1.p2.5.m5.1a"><mrow id="S7.SS1.p2.5.m5.1.1" xref="S7.SS1.p2.5.m5.1.1.cmml"><mrow id="S7.SS1.p2.5.m5.1.1.2" xref="S7.SS1.p2.5.m5.1.1.2.cmml"><mi id="S7.SS1.p2.5.m5.1.1.2.2" xref="S7.SS1.p2.5.m5.1.1.2.2.cmml">l</mi><mo id="S7.SS1.p2.5.m5.1.1.2.1" xref="S7.SS1.p2.5.m5.1.1.2.1.cmml">⁢</mo><mi id="S7.SS1.p2.5.m5.1.1.2.3" xref="S7.SS1.p2.5.m5.1.1.2.3.cmml">r</mi></mrow><mo id="S7.SS1.p2.5.m5.1.1.1" xref="S7.SS1.p2.5.m5.1.1.1.cmml">=</mo><mrow id="S7.SS1.p2.5.m5.1.1.3" xref="S7.SS1.p2.5.m5.1.1.3.cmml"><mrow id="S7.SS1.p2.5.m5.1.1.3.2" xref="S7.SS1.p2.5.m5.1.1.3.2.cmml"><mn id="S7.SS1.p2.5.m5.1.1.3.2.2" xref="S7.SS1.p2.5.m5.1.1.3.2.2.cmml">1</mn><mo id="S7.SS1.p2.5.m5.1.1.3.2.1" xref="S7.SS1.p2.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S7.SS1.p2.5.m5.1.1.3.2.3" xref="S7.SS1.p2.5.m5.1.1.3.2.3.cmml">e</mi></mrow><mo id="S7.SS1.p2.5.m5.1.1.3.1" xref="S7.SS1.p2.5.m5.1.1.3.1.cmml">−</mo><mn id="S7.SS1.p2.5.m5.1.1.3.3" xref="S7.SS1.p2.5.m5.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.5.m5.1b"><apply id="S7.SS1.p2.5.m5.1.1.cmml" xref="S7.SS1.p2.5.m5.1.1"><eq id="S7.SS1.p2.5.m5.1.1.1.cmml" xref="S7.SS1.p2.5.m5.1.1.1"></eq><apply id="S7.SS1.p2.5.m5.1.1.2.cmml" xref="S7.SS1.p2.5.m5.1.1.2"><times id="S7.SS1.p2.5.m5.1.1.2.1.cmml" xref="S7.SS1.p2.5.m5.1.1.2.1"></times><ci id="S7.SS1.p2.5.m5.1.1.2.2.cmml" xref="S7.SS1.p2.5.m5.1.1.2.2">𝑙</ci><ci id="S7.SS1.p2.5.m5.1.1.2.3.cmml" xref="S7.SS1.p2.5.m5.1.1.2.3">𝑟</ci></apply><apply id="S7.SS1.p2.5.m5.1.1.3.cmml" xref="S7.SS1.p2.5.m5.1.1.3"><minus id="S7.SS1.p2.5.m5.1.1.3.1.cmml" xref="S7.SS1.p2.5.m5.1.1.3.1"></minus><apply id="S7.SS1.p2.5.m5.1.1.3.2.cmml" xref="S7.SS1.p2.5.m5.1.1.3.2"><times id="S7.SS1.p2.5.m5.1.1.3.2.1.cmml" xref="S7.SS1.p2.5.m5.1.1.3.2.1"></times><cn id="S7.SS1.p2.5.m5.1.1.3.2.2.cmml" type="integer" xref="S7.SS1.p2.5.m5.1.1.3.2.2">1</cn><ci id="S7.SS1.p2.5.m5.1.1.3.2.3.cmml" xref="S7.SS1.p2.5.m5.1.1.3.2.3">𝑒</ci></apply><cn id="S7.SS1.p2.5.m5.1.1.3.3.cmml" type="integer" xref="S7.SS1.p2.5.m5.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.5.m5.1c">lr=1e-3</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.5.m5.1d">italic_l italic_r = 1 italic_e - 3</annotation></semantics></math>, <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S7.SS1.p2.6.m6.1"><semantics id="S7.SS1.p2.6.m6.1a"><mrow id="S7.SS1.p2.6.m6.1.1" xref="S7.SS1.p2.6.m6.1.1.cmml"><msub id="S7.SS1.p2.6.m6.1.1.2" xref="S7.SS1.p2.6.m6.1.1.2.cmml"><mi id="S7.SS1.p2.6.m6.1.1.2.2" xref="S7.SS1.p2.6.m6.1.1.2.2.cmml">β</mi><mn id="S7.SS1.p2.6.m6.1.1.2.3" xref="S7.SS1.p2.6.m6.1.1.2.3.cmml">1</mn></msub><mo id="S7.SS1.p2.6.m6.1.1.1" xref="S7.SS1.p2.6.m6.1.1.1.cmml">=</mo><mn id="S7.SS1.p2.6.m6.1.1.3" xref="S7.SS1.p2.6.m6.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.6.m6.1b"><apply id="S7.SS1.p2.6.m6.1.1.cmml" xref="S7.SS1.p2.6.m6.1.1"><eq id="S7.SS1.p2.6.m6.1.1.1.cmml" xref="S7.SS1.p2.6.m6.1.1.1"></eq><apply id="S7.SS1.p2.6.m6.1.1.2.cmml" xref="S7.SS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.6.m6.1.1.2.1.cmml" xref="S7.SS1.p2.6.m6.1.1.2">subscript</csymbol><ci id="S7.SS1.p2.6.m6.1.1.2.2.cmml" xref="S7.SS1.p2.6.m6.1.1.2.2">𝛽</ci><cn id="S7.SS1.p2.6.m6.1.1.2.3.cmml" type="integer" xref="S7.SS1.p2.6.m6.1.1.2.3">1</cn></apply><cn id="S7.SS1.p2.6.m6.1.1.3.cmml" type="float" xref="S7.SS1.p2.6.m6.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.6.m6.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.6.m6.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.999" class="ltx_Math" display="inline" id="S7.SS1.p2.7.m7.1"><semantics id="S7.SS1.p2.7.m7.1a"><mrow id="S7.SS1.p2.7.m7.1.1" xref="S7.SS1.p2.7.m7.1.1.cmml"><msub id="S7.SS1.p2.7.m7.1.1.2" xref="S7.SS1.p2.7.m7.1.1.2.cmml"><mi id="S7.SS1.p2.7.m7.1.1.2.2" xref="S7.SS1.p2.7.m7.1.1.2.2.cmml">β</mi><mn id="S7.SS1.p2.7.m7.1.1.2.3" xref="S7.SS1.p2.7.m7.1.1.2.3.cmml">2</mn></msub><mo id="S7.SS1.p2.7.m7.1.1.1" xref="S7.SS1.p2.7.m7.1.1.1.cmml">=</mo><mn id="S7.SS1.p2.7.m7.1.1.3" xref="S7.SS1.p2.7.m7.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.7.m7.1b"><apply id="S7.SS1.p2.7.m7.1.1.cmml" xref="S7.SS1.p2.7.m7.1.1"><eq id="S7.SS1.p2.7.m7.1.1.1.cmml" xref="S7.SS1.p2.7.m7.1.1.1"></eq><apply id="S7.SS1.p2.7.m7.1.1.2.cmml" xref="S7.SS1.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p2.7.m7.1.1.2.1.cmml" xref="S7.SS1.p2.7.m7.1.1.2">subscript</csymbol><ci id="S7.SS1.p2.7.m7.1.1.2.2.cmml" xref="S7.SS1.p2.7.m7.1.1.2.2">𝛽</ci><cn id="S7.SS1.p2.7.m7.1.1.2.3.cmml" type="integer" xref="S7.SS1.p2.7.m7.1.1.2.3">2</cn></apply><cn id="S7.SS1.p2.7.m7.1.1.3.cmml" type="float" xref="S7.SS1.p2.7.m7.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.7.m7.1c">\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.7.m7.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math> and the learning rate halves every <math alttext="5" class="ltx_Math" display="inline" id="S7.SS1.p2.8.m8.1"><semantics id="S7.SS1.p2.8.m8.1a"><mn id="S7.SS1.p2.8.m8.1.1" xref="S7.SS1.p2.8.m8.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.8.m8.1b"><cn id="S7.SS1.p2.8.m8.1.1.cmml" type="integer" xref="S7.SS1.p2.8.m8.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.8.m8.1c">5</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.8.m8.1d">5</annotation></semantics></math> epochs.</p>
</div>
<div class="ltx_para" id="S7.SS1.p3">
<p class="ltx_p" id="S7.SS1.p3.9">For SR-GNN, we set we set item embedding size <math alttext="s_{\texttt{item\_embedding}}=100" class="ltx_Math" display="inline" id="S7.SS1.p3.1.m1.1"><semantics id="S7.SS1.p3.1.m1.1a"><mrow id="S7.SS1.p3.1.m1.1.1" xref="S7.SS1.p3.1.m1.1.1.cmml"><msub id="S7.SS1.p3.1.m1.1.1.2" xref="S7.SS1.p3.1.m1.1.1.2.cmml"><mi id="S7.SS1.p3.1.m1.1.1.2.2" xref="S7.SS1.p3.1.m1.1.1.2.2.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p3.1.m1.1.1.2.3" xref="S7.SS1.p3.1.m1.1.1.2.3a.cmml">item_embedding</mtext></msub><mo id="S7.SS1.p3.1.m1.1.1.1" xref="S7.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS1.p3.1.m1.1.1.3" xref="S7.SS1.p3.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.1.m1.1b"><apply id="S7.SS1.p3.1.m1.1.1.cmml" xref="S7.SS1.p3.1.m1.1.1"><eq id="S7.SS1.p3.1.m1.1.1.1.cmml" xref="S7.SS1.p3.1.m1.1.1.1"></eq><apply id="S7.SS1.p3.1.m1.1.1.2.cmml" xref="S7.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p3.1.m1.1.1.2.1.cmml" xref="S7.SS1.p3.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS1.p3.1.m1.1.1.2.2.cmml" xref="S7.SS1.p3.1.m1.1.1.2.2">𝑠</ci><ci id="S7.SS1.p3.1.m1.1.1.2.3a.cmml" xref="S7.SS1.p3.1.m1.1.1.2.3"><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S7.SS1.p3.1.m1.1.1.2.3">item_embedding</mtext></ci></apply><cn id="S7.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S7.SS1.p3.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.1.m1.1c">s_{\texttt{item\_embedding}}=100</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.1.m1.1d">italic_s start_POSTSUBSCRIPT item_embedding end_POSTSUBSCRIPT = 100</annotation></semantics></math>, side embedding size <math alttext="s_{\texttt{side\_embedding}}=100" class="ltx_Math" display="inline" id="S7.SS1.p3.2.m2.1"><semantics id="S7.SS1.p3.2.m2.1a"><mrow id="S7.SS1.p3.2.m2.1.1" xref="S7.SS1.p3.2.m2.1.1.cmml"><msub id="S7.SS1.p3.2.m2.1.1.2" xref="S7.SS1.p3.2.m2.1.1.2.cmml"><mi id="S7.SS1.p3.2.m2.1.1.2.2" xref="S7.SS1.p3.2.m2.1.1.2.2.cmml">s</mi><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p3.2.m2.1.1.2.3" xref="S7.SS1.p3.2.m2.1.1.2.3a.cmml">side_embedding</mtext></msub><mo id="S7.SS1.p3.2.m2.1.1.1" xref="S7.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS1.p3.2.m2.1.1.3" xref="S7.SS1.p3.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.2.m2.1b"><apply id="S7.SS1.p3.2.m2.1.1.cmml" xref="S7.SS1.p3.2.m2.1.1"><eq id="S7.SS1.p3.2.m2.1.1.1.cmml" xref="S7.SS1.p3.2.m2.1.1.1"></eq><apply id="S7.SS1.p3.2.m2.1.1.2.cmml" xref="S7.SS1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p3.2.m2.1.1.2.1.cmml" xref="S7.SS1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S7.SS1.p3.2.m2.1.1.2.2.cmml" xref="S7.SS1.p3.2.m2.1.1.2.2">𝑠</ci><ci id="S7.SS1.p3.2.m2.1.1.2.3a.cmml" xref="S7.SS1.p3.2.m2.1.1.2.3"><mtext class="ltx_mathvariant_monospace" id="S7.SS1.p3.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S7.SS1.p3.2.m2.1.1.2.3">side_embedding</mtext></ci></apply><cn id="S7.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="S7.SS1.p3.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.2.m2.1c">s_{\texttt{side\_embedding}}=100</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.2.m2.1d">italic_s start_POSTSUBSCRIPT side_embedding end_POSTSUBSCRIPT = 100</annotation></semantics></math>, and the item vocab size and side vocab size vary by dataset. We use a batch size of <math alttext="100" class="ltx_Math" display="inline" id="S7.SS1.p3.3.m3.1"><semantics id="S7.SS1.p3.3.m3.1a"><mn id="S7.SS1.p3.3.m3.1.1" xref="S7.SS1.p3.3.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.3.m3.1b"><cn id="S7.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S7.SS1.p3.3.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.3.m3.1c">100</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.3.m3.1d">100</annotation></semantics></math> and an Adam optimizer with initial learning rate <math alttext="lr=1e-3" class="ltx_Math" display="inline" id="S7.SS1.p3.4.m4.1"><semantics id="S7.SS1.p3.4.m4.1a"><mrow id="S7.SS1.p3.4.m4.1.1" xref="S7.SS1.p3.4.m4.1.1.cmml"><mrow id="S7.SS1.p3.4.m4.1.1.2" xref="S7.SS1.p3.4.m4.1.1.2.cmml"><mi id="S7.SS1.p3.4.m4.1.1.2.2" xref="S7.SS1.p3.4.m4.1.1.2.2.cmml">l</mi><mo id="S7.SS1.p3.4.m4.1.1.2.1" xref="S7.SS1.p3.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S7.SS1.p3.4.m4.1.1.2.3" xref="S7.SS1.p3.4.m4.1.1.2.3.cmml">r</mi></mrow><mo id="S7.SS1.p3.4.m4.1.1.1" xref="S7.SS1.p3.4.m4.1.1.1.cmml">=</mo><mrow id="S7.SS1.p3.4.m4.1.1.3" xref="S7.SS1.p3.4.m4.1.1.3.cmml"><mrow id="S7.SS1.p3.4.m4.1.1.3.2" xref="S7.SS1.p3.4.m4.1.1.3.2.cmml"><mn id="S7.SS1.p3.4.m4.1.1.3.2.2" xref="S7.SS1.p3.4.m4.1.1.3.2.2.cmml">1</mn><mo id="S7.SS1.p3.4.m4.1.1.3.2.1" xref="S7.SS1.p3.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S7.SS1.p3.4.m4.1.1.3.2.3" xref="S7.SS1.p3.4.m4.1.1.3.2.3.cmml">e</mi></mrow><mo id="S7.SS1.p3.4.m4.1.1.3.1" xref="S7.SS1.p3.4.m4.1.1.3.1.cmml">−</mo><mn id="S7.SS1.p3.4.m4.1.1.3.3" xref="S7.SS1.p3.4.m4.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.4.m4.1b"><apply id="S7.SS1.p3.4.m4.1.1.cmml" xref="S7.SS1.p3.4.m4.1.1"><eq id="S7.SS1.p3.4.m4.1.1.1.cmml" xref="S7.SS1.p3.4.m4.1.1.1"></eq><apply id="S7.SS1.p3.4.m4.1.1.2.cmml" xref="S7.SS1.p3.4.m4.1.1.2"><times id="S7.SS1.p3.4.m4.1.1.2.1.cmml" xref="S7.SS1.p3.4.m4.1.1.2.1"></times><ci id="S7.SS1.p3.4.m4.1.1.2.2.cmml" xref="S7.SS1.p3.4.m4.1.1.2.2">𝑙</ci><ci id="S7.SS1.p3.4.m4.1.1.2.3.cmml" xref="S7.SS1.p3.4.m4.1.1.2.3">𝑟</ci></apply><apply id="S7.SS1.p3.4.m4.1.1.3.cmml" xref="S7.SS1.p3.4.m4.1.1.3"><minus id="S7.SS1.p3.4.m4.1.1.3.1.cmml" xref="S7.SS1.p3.4.m4.1.1.3.1"></minus><apply id="S7.SS1.p3.4.m4.1.1.3.2.cmml" xref="S7.SS1.p3.4.m4.1.1.3.2"><times id="S7.SS1.p3.4.m4.1.1.3.2.1.cmml" xref="S7.SS1.p3.4.m4.1.1.3.2.1"></times><cn id="S7.SS1.p3.4.m4.1.1.3.2.2.cmml" type="integer" xref="S7.SS1.p3.4.m4.1.1.3.2.2">1</cn><ci id="S7.SS1.p3.4.m4.1.1.3.2.3.cmml" xref="S7.SS1.p3.4.m4.1.1.3.2.3">𝑒</ci></apply><cn id="S7.SS1.p3.4.m4.1.1.3.3.cmml" type="integer" xref="S7.SS1.p3.4.m4.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.4.m4.1c">lr=1e-3</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.4.m4.1d">italic_l italic_r = 1 italic_e - 3</annotation></semantics></math>, <math alttext="\beta_{1}=0.9" class="ltx_Math" display="inline" id="S7.SS1.p3.5.m5.1"><semantics id="S7.SS1.p3.5.m5.1a"><mrow id="S7.SS1.p3.5.m5.1.1" xref="S7.SS1.p3.5.m5.1.1.cmml"><msub id="S7.SS1.p3.5.m5.1.1.2" xref="S7.SS1.p3.5.m5.1.1.2.cmml"><mi id="S7.SS1.p3.5.m5.1.1.2.2" xref="S7.SS1.p3.5.m5.1.1.2.2.cmml">β</mi><mn id="S7.SS1.p3.5.m5.1.1.2.3" xref="S7.SS1.p3.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="S7.SS1.p3.5.m5.1.1.1" xref="S7.SS1.p3.5.m5.1.1.1.cmml">=</mo><mn id="S7.SS1.p3.5.m5.1.1.3" xref="S7.SS1.p3.5.m5.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.5.m5.1b"><apply id="S7.SS1.p3.5.m5.1.1.cmml" xref="S7.SS1.p3.5.m5.1.1"><eq id="S7.SS1.p3.5.m5.1.1.1.cmml" xref="S7.SS1.p3.5.m5.1.1.1"></eq><apply id="S7.SS1.p3.5.m5.1.1.2.cmml" xref="S7.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p3.5.m5.1.1.2.1.cmml" xref="S7.SS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="S7.SS1.p3.5.m5.1.1.2.2.cmml" xref="S7.SS1.p3.5.m5.1.1.2.2">𝛽</ci><cn id="S7.SS1.p3.5.m5.1.1.2.3.cmml" type="integer" xref="S7.SS1.p3.5.m5.1.1.2.3">1</cn></apply><cn id="S7.SS1.p3.5.m5.1.1.3.cmml" type="float" xref="S7.SS1.p3.5.m5.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.5.m5.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.5.m5.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math>, <math alttext="\beta_{2}=0.999" class="ltx_Math" display="inline" id="S7.SS1.p3.6.m6.1"><semantics id="S7.SS1.p3.6.m6.1a"><mrow id="S7.SS1.p3.6.m6.1.1" xref="S7.SS1.p3.6.m6.1.1.cmml"><msub id="S7.SS1.p3.6.m6.1.1.2" xref="S7.SS1.p3.6.m6.1.1.2.cmml"><mi id="S7.SS1.p3.6.m6.1.1.2.2" xref="S7.SS1.p3.6.m6.1.1.2.2.cmml">β</mi><mn id="S7.SS1.p3.6.m6.1.1.2.3" xref="S7.SS1.p3.6.m6.1.1.2.3.cmml">2</mn></msub><mo id="S7.SS1.p3.6.m6.1.1.1" xref="S7.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S7.SS1.p3.6.m6.1.1.3" xref="S7.SS1.p3.6.m6.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.6.m6.1b"><apply id="S7.SS1.p3.6.m6.1.1.cmml" xref="S7.SS1.p3.6.m6.1.1"><eq id="S7.SS1.p3.6.m6.1.1.1.cmml" xref="S7.SS1.p3.6.m6.1.1.1"></eq><apply id="S7.SS1.p3.6.m6.1.1.2.cmml" xref="S7.SS1.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S7.SS1.p3.6.m6.1.1.2.1.cmml" xref="S7.SS1.p3.6.m6.1.1.2">subscript</csymbol><ci id="S7.SS1.p3.6.m6.1.1.2.2.cmml" xref="S7.SS1.p3.6.m6.1.1.2.2">𝛽</ci><cn id="S7.SS1.p3.6.m6.1.1.2.3.cmml" type="integer" xref="S7.SS1.p3.6.m6.1.1.2.3">2</cn></apply><cn id="S7.SS1.p3.6.m6.1.1.3.cmml" type="float" xref="S7.SS1.p3.6.m6.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.6.m6.1c">\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.6.m6.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math>, weight on <math alttext="L_{2}" class="ltx_Math" display="inline" id="S7.SS1.p3.7.m7.1"><semantics id="S7.SS1.p3.7.m7.1a"><msub id="S7.SS1.p3.7.m7.1.1" xref="S7.SS1.p3.7.m7.1.1.cmml"><mi id="S7.SS1.p3.7.m7.1.1.2" xref="S7.SS1.p3.7.m7.1.1.2.cmml">L</mi><mn id="S7.SS1.p3.7.m7.1.1.3" xref="S7.SS1.p3.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.7.m7.1b"><apply id="S7.SS1.p3.7.m7.1.1.cmml" xref="S7.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S7.SS1.p3.7.m7.1.1.1.cmml" xref="S7.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S7.SS1.p3.7.m7.1.1.2.cmml" xref="S7.SS1.p3.7.m7.1.1.2">𝐿</ci><cn id="S7.SS1.p3.7.m7.1.1.3.cmml" type="integer" xref="S7.SS1.p3.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.7.m7.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.7.m7.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> penalty being <math alttext="1e-5" class="ltx_Math" display="inline" id="S7.SS1.p3.8.m8.1"><semantics id="S7.SS1.p3.8.m8.1a"><mrow id="S7.SS1.p3.8.m8.1.1" xref="S7.SS1.p3.8.m8.1.1.cmml"><mrow id="S7.SS1.p3.8.m8.1.1.2" xref="S7.SS1.p3.8.m8.1.1.2.cmml"><mn id="S7.SS1.p3.8.m8.1.1.2.2" xref="S7.SS1.p3.8.m8.1.1.2.2.cmml">1</mn><mo id="S7.SS1.p3.8.m8.1.1.2.1" xref="S7.SS1.p3.8.m8.1.1.2.1.cmml">⁢</mo><mi id="S7.SS1.p3.8.m8.1.1.2.3" xref="S7.SS1.p3.8.m8.1.1.2.3.cmml">e</mi></mrow><mo id="S7.SS1.p3.8.m8.1.1.1" xref="S7.SS1.p3.8.m8.1.1.1.cmml">−</mo><mn id="S7.SS1.p3.8.m8.1.1.3" xref="S7.SS1.p3.8.m8.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.8.m8.1b"><apply id="S7.SS1.p3.8.m8.1.1.cmml" xref="S7.SS1.p3.8.m8.1.1"><minus id="S7.SS1.p3.8.m8.1.1.1.cmml" xref="S7.SS1.p3.8.m8.1.1.1"></minus><apply id="S7.SS1.p3.8.m8.1.1.2.cmml" xref="S7.SS1.p3.8.m8.1.1.2"><times id="S7.SS1.p3.8.m8.1.1.2.1.cmml" xref="S7.SS1.p3.8.m8.1.1.2.1"></times><cn id="S7.SS1.p3.8.m8.1.1.2.2.cmml" type="integer" xref="S7.SS1.p3.8.m8.1.1.2.2">1</cn><ci id="S7.SS1.p3.8.m8.1.1.2.3.cmml" xref="S7.SS1.p3.8.m8.1.1.2.3">𝑒</ci></apply><cn id="S7.SS1.p3.8.m8.1.1.3.cmml" type="integer" xref="S7.SS1.p3.8.m8.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.8.m8.1c">1e-5</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.8.m8.1d">1 italic_e - 5</annotation></semantics></math> and the learning rate halves every <math alttext="3" class="ltx_Math" display="inline" id="S7.SS1.p3.9.m9.1"><semantics id="S7.SS1.p3.9.m9.1a"><mn id="S7.SS1.p3.9.m9.1.1" xref="S7.SS1.p3.9.m9.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S7.SS1.p3.9.m9.1b"><cn id="S7.SS1.p3.9.m9.1.1.cmml" type="integer" xref="S7.SS1.p3.9.m9.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p3.9.m9.1c">3</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p3.9.m9.1d">3</annotation></semantics></math> epochs with early stopping mechanism.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Evaluation metrics</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.1">We mainly use Recall and MRR as our evaluation metrics. We calculate MRR@20 and Recall@20, the percentage of true answer ranking in the top 20 of our predictions. And MRR is the mean reciprocal rank calculated by <math alttext="\text{MRR}=\frac{1}{N}\sum_{i=1}^{N}\frac{1}{\text{rank}_{i}}" class="ltx_Math" display="inline" id="S7.SS2.p1.1.m1.1"><semantics id="S7.SS2.p1.1.m1.1a"><mrow id="S7.SS2.p1.1.m1.1.1" xref="S7.SS2.p1.1.m1.1.1.cmml"><mtext id="S7.SS2.p1.1.m1.1.1.2" xref="S7.SS2.p1.1.m1.1.1.2a.cmml">MRR</mtext><mo id="S7.SS2.p1.1.m1.1.1.1" xref="S7.SS2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S7.SS2.p1.1.m1.1.1.3" xref="S7.SS2.p1.1.m1.1.1.3.cmml"><mfrac id="S7.SS2.p1.1.m1.1.1.3.2" xref="S7.SS2.p1.1.m1.1.1.3.2.cmml"><mn id="S7.SS2.p1.1.m1.1.1.3.2.2" xref="S7.SS2.p1.1.m1.1.1.3.2.2.cmml">1</mn><mi id="S7.SS2.p1.1.m1.1.1.3.2.3" xref="S7.SS2.p1.1.m1.1.1.3.2.3.cmml">N</mi></mfrac><mo id="S7.SS2.p1.1.m1.1.1.3.1" xref="S7.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mrow id="S7.SS2.p1.1.m1.1.1.3.3" xref="S7.SS2.p1.1.m1.1.1.3.3.cmml"><msubsup id="S7.SS2.p1.1.m1.1.1.3.3.1" xref="S7.SS2.p1.1.m1.1.1.3.3.1.cmml"><mo id="S7.SS2.p1.1.m1.1.1.3.3.1.2.2" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.cmml"><mi id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.2" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.1" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.3" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S7.SS2.p1.1.m1.1.1.3.3.1.3" xref="S7.SS2.p1.1.m1.1.1.3.3.1.3.cmml">N</mi></msubsup><mfrac id="S7.SS2.p1.1.m1.1.1.3.3.2" xref="S7.SS2.p1.1.m1.1.1.3.3.2.cmml"><mn id="S7.SS2.p1.1.m1.1.1.3.3.2.2" xref="S7.SS2.p1.1.m1.1.1.3.3.2.2.cmml">1</mn><msub id="S7.SS2.p1.1.m1.1.1.3.3.2.3" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3.cmml"><mtext id="S7.SS2.p1.1.m1.1.1.3.3.2.3.2" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3.2a.cmml">rank</mtext><mi id="S7.SS2.p1.1.m1.1.1.3.3.2.3.3" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3.3.cmml">i</mi></msub></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.1.m1.1b"><apply id="S7.SS2.p1.1.m1.1.1.cmml" xref="S7.SS2.p1.1.m1.1.1"><eq id="S7.SS2.p1.1.m1.1.1.1.cmml" xref="S7.SS2.p1.1.m1.1.1.1"></eq><ci id="S7.SS2.p1.1.m1.1.1.2a.cmml" xref="S7.SS2.p1.1.m1.1.1.2"><mtext id="S7.SS2.p1.1.m1.1.1.2.cmml" xref="S7.SS2.p1.1.m1.1.1.2">MRR</mtext></ci><apply id="S7.SS2.p1.1.m1.1.1.3.cmml" xref="S7.SS2.p1.1.m1.1.1.3"><times id="S7.SS2.p1.1.m1.1.1.3.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.1"></times><apply id="S7.SS2.p1.1.m1.1.1.3.2.cmml" xref="S7.SS2.p1.1.m1.1.1.3.2"><divide id="S7.SS2.p1.1.m1.1.1.3.2.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.2"></divide><cn id="S7.SS2.p1.1.m1.1.1.3.2.2.cmml" type="integer" xref="S7.SS2.p1.1.m1.1.1.3.2.2">1</cn><ci id="S7.SS2.p1.1.m1.1.1.3.2.3.cmml" xref="S7.SS2.p1.1.m1.1.1.3.2.3">𝑁</ci></apply><apply id="S7.SS2.p1.1.m1.1.1.3.3.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3"><apply id="S7.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S7.SS2.p1.1.m1.1.1.3.3.1.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1">superscript</csymbol><apply id="S7.SS2.p1.1.m1.1.1.3.3.1.2.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S7.SS2.p1.1.m1.1.1.3.3.1.2.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S7.SS2.p1.1.m1.1.1.3.3.1.2.2.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.2"></sum><apply id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3"><eq id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.1"></eq><ci id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.2.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S7.SS2.p1.1.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S7.SS2.p1.1.m1.1.1.3.3.1.3.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.1.3">𝑁</ci></apply><apply id="S7.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.2"><divide id="S7.SS2.p1.1.m1.1.1.3.3.2.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.2"></divide><cn id="S7.SS2.p1.1.m1.1.1.3.3.2.2.cmml" type="integer" xref="S7.SS2.p1.1.m1.1.1.3.3.2.2">1</cn><apply id="S7.SS2.p1.1.m1.1.1.3.3.2.3.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S7.SS2.p1.1.m1.1.1.3.3.2.3.1.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S7.SS2.p1.1.m1.1.1.3.3.2.3.2a.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3.2"><mtext id="S7.SS2.p1.1.m1.1.1.3.3.2.3.2.cmml" mathsize="70%" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3.2">rank</mtext></ci><ci id="S7.SS2.p1.1.m1.1.1.3.3.2.3.3.cmml" xref="S7.SS2.p1.1.m1.1.1.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.1.m1.1c">\text{MRR}=\frac{1}{N}\sum_{i=1}^{N}\frac{1}{\text{rank}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.1.m1.1d">MRR = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG rank start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. The reciprocal rank is set to 0 if it lies beyond top 20 for MRR@20.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3 </span>Evaluating the effect of incorporating side information</h3>
<section class="ltx_subsubsection" id="S7.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.3.1 </span>Performance</h4>
<div class="ltx_para" id="S7.SS3.SSS1.p1">
<p class="ltx_p" id="S7.SS3.SSS1.p1.1">We summarize our main experimental statistics as below. In addition to Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.T3" title="Table 3 ‣ 7.3.1 Performance ‣ 7.3 Evaluating the effect of incorporating side information ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">3</span></a> representing the best results achieved on each dataset in terms of both metrics, we also provide a visualization of the learning process for RepeatNet in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.F5" title="Figure 5 ‣ 7.3.1 Performance ‣ 7.3 Evaluating the effect of incorporating side information ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">5</span></a>. We will get into detailed analysis in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.SS3.SSS2" title="7.3.2 Analysis ‣ 7.3 Evaluating the effect of incorporating side information ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">7.3.2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S7.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S7.F5.sf1.g1" src="extracted/5637323/RepeatNet_TaFeng.png" width="299"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>TaFeng</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S7.F5.sf2.g1" src="extracted/5637323/RepeatNet_Digi.png" width="299"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Diginetica</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F5.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="200" id="S7.F5.sf3.g1" src="extracted/5637323/RepeatNet_Moive.png" width="299"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>MovieLens</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>RepeatNet Performance 
<br class="ltx_break"/>Maximum highlighted </figcaption>
</figure>
<figure class="ltx_table" id="S7.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S7.T3.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4" id="S7.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S7.T3.1.1.1.2.1">TaFeng</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4" id="S7.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S7.T3.1.1.1.3.1">Diginetica</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S7.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S7.T3.1.1.1.4.1">MovieLens</span></th>
</tr>
<tr class="ltx_tr" id="S7.T3.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S7.T3.1.2.2.1">Model</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S7.T3.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S7.T3.1.2.2.2.1">RepeatNet</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S7.T3.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S7.T3.1.2.2.3.1">SR-GNN</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S7.T3.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S7.T3.1.2.2.4.1">RepeatNet</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S7.T3.1.2.2.5"><span class="ltx_text ltx_font_bold" id="S7.T3.1.2.2.5.1">SR-GNN</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S7.T3.1.2.2.6"><span class="ltx_text ltx_font_bold" id="S7.T3.1.2.2.6.1">RepeatNet</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T3.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S7.T3.1.3.1.1">Metrics</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.2">
<table class="ltx_tabular ltx_align_middle" id="S7.T3.1.3.1.2.1">
<tr class="ltx_tr" id="S7.T3.1.3.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.2.1.1.1">no</td>
</tr>
<tr class="ltx_tr" id="S7.T3.1.3.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.2.1.2.1">side</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.3">side</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.4">
<table class="ltx_tabular ltx_align_middle" id="S7.T3.1.3.1.4.1">
<tr class="ltx_tr" id="S7.T3.1.3.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.4.1.1.1">no</td>
</tr>
<tr class="ltx_tr" id="S7.T3.1.3.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.4.1.2.1">side</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.5">side</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.6">
<table class="ltx_tabular ltx_align_middle" id="S7.T3.1.3.1.6.1">
<tr class="ltx_tr" id="S7.T3.1.3.1.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.6.1.1.1">no</td>
</tr>
<tr class="ltx_tr" id="S7.T3.1.3.1.6.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.6.1.2.1">side</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.7">side</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.8">
<table class="ltx_tabular ltx_align_middle" id="S7.T3.1.3.1.8.1">
<tr class="ltx_tr" id="S7.T3.1.3.1.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.8.1.1.1">no</td>
</tr>
<tr class="ltx_tr" id="S7.T3.1.3.1.8.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.8.1.2.1">side</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.9">side</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.10">
<table class="ltx_tabular ltx_align_middle" id="S7.T3.1.3.1.10.1">
<tr class="ltx_tr" id="S7.T3.1.3.1.10.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.10.1.1.1">no</td>
</tr>
<tr class="ltx_tr" id="S7.T3.1.3.1.10.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S7.T3.1.3.1.10.1.2.1">side</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.3.1.11">side</td>
</tr>
<tr class="ltx_tr" id="S7.T3.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S7.T3.1.4.2.1"><span class="ltx_text ltx_font_bold" id="S7.T3.1.4.2.1.1">Recall@20</span></th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.2">10.17</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.3"><span class="ltx_text ltx_font_bold" id="S7.T3.1.4.2.3.1">11.09</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.4">9.49</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.5"><span class="ltx_text ltx_font_bold" id="S7.T3.1.4.2.5.1">10.42</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.6">52.33</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.7"><span class="ltx_text ltx_font_bold" id="S7.T3.1.4.2.7.1">53.39</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.8">50.54</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.9"><span class="ltx_text ltx_font_bold" id="S7.T3.1.4.2.9.1">52.14</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.10">14.77</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T3.1.4.2.11"><span class="ltx_text ltx_font_bold" id="S7.T3.1.4.2.11.1">15.40</span></td>
</tr>
<tr class="ltx_tr" id="S7.T3.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S7.T3.1.5.3.1"><span class="ltx_text ltx_font_bold" id="S7.T3.1.5.3.1.1">MRR@20</span></th>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.2">3.37</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.3"><span class="ltx_text ltx_font_bold" id="S7.T3.1.5.3.3.1">3.68</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.4">3.01</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.5"><span class="ltx_text ltx_font_bold" id="S7.T3.1.5.3.5.1">3.21</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.6">18.27</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S7.T3.1.5.3.7.1">18.95</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.8">17.48</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.9"><span class="ltx_text ltx_font_bold" id="S7.T3.1.5.3.9.1">17.64</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.10">4.25</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T3.1.5.3.11"><span class="ltx_text ltx_font_bold" id="S7.T3.1.5.3.11.1">4.62</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>performance metrics</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S7.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.3.2 </span>Analysis</h4>
<div class="ltx_para" id="S7.SS3.SSS2.p1">
<p class="ltx_p" id="S7.SS3.SSS2.p1.1">From Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.T3" title="Table 3 ‣ 7.3.1 Performance ‣ 7.3 Evaluating the effect of incorporating side information ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">3</span></a>, we could observe that with side information incorporated, the model performance improves on all metrics by a considerable margin. This applies to all datasets and models we experimented, which exemplifies the universality of our framework for incorporating side information into neural network based recommender system. It is also worth noting that we achieved the state-of-the-art performance on Diginetica dataset. The previous state-of-the-art performance on Diginetica was achieved by NISER+ <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al., <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib1" title="">2021</a>)</cite>, and the reported performance was 18.72 in terms of MRR@20 and 53.39 in terms of Recall@20.</p>
</div>
<div class="ltx_para" id="S7.SS3.SSS2.p2">
<p class="ltx_p" id="S7.SS3.SSS2.p2.1">Additionally, we notice from the learning process plots that, with side information, RepeatNet converges better and faster if the side information framework is applied. SR-GNN also converges faster and better: without side information, SR-GNN converges in three epochs; with side information, SR-GNN is able to converge in two epochs. This spells a dramatic difference of resources and time invested for real life industry-scale applications.</p>
</div>
<figure class="ltx_table" id="S7.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S7.T4.1.1.1.1">Dataset: Diginetica</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S7.T4.1.1.1.2.1">SR-GNN</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S7.T4.1.1.1.3.1">SR-GNN</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S7.T4.1.1.1.4.1">SR-GNN</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S7.T4.1.1.1.5.1">RepeatNet</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S7.T4.1.1.1.6.1">RepeatNet</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.1.1.7"><span class="ltx_text ltx_font_bold" id="S7.T4.1.1.1.7.1">RepeatNet</span></th>
</tr>
<tr class="ltx_tr" id="S7.T4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" id="S7.T4.1.2.2.1">Embedding Size</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.2.2.2">100</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.2.2.3">200</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.2.2.4">100</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.2.2.5">100</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.2.2.6">200</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T4.1.2.2.7">100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T4.1.3.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S7.T4.1.3.1.1">Side information</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.3.1.2">Without</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.3.1.3">Without</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.3.1.4">With</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.3.1.5">Without</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.3.1.6">Without</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.3.1.7">With</td>
</tr>
<tr class="ltx_tr" id="S7.T4.1.4.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S7.T4.1.4.2.1"><span class="ltx_text ltx_font_bold" id="S7.T4.1.4.2.1.1">Recall@20</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.4.2.2">50.54</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.4.2.3">49.39</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.4.2.4"><span class="ltx_text ltx_font_bold" id="S7.T4.1.4.2.4.1">52.14</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.4.2.5">52.33</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.4.2.6">52.00</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S7.T4.1.4.2.7"><span class="ltx_text ltx_font_bold" id="S7.T4.1.4.2.7.1">53.39</span></td>
</tr>
<tr class="ltx_tr" id="S7.T4.1.5.3">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S7.T4.1.5.3.1"><span class="ltx_text ltx_font_bold" id="S7.T4.1.5.3.1.1">MRR@20</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T4.1.5.3.2">17.48</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T4.1.5.3.3">16.78</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T4.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S7.T4.1.5.3.4.1">17.64</span></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T4.1.5.3.5">18.27</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T4.1.5.3.6">18.00</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S7.T4.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S7.T4.1.5.3.7.1">18.95</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Effect of model’s size</figcaption>
</figure>
<div class="ltx_para" id="S7.SS3.SSS2.p3">
<p class="ltx_p" id="S7.SS3.SSS2.p3.1">To confirm that the performance improvement is not resulting from simply increasing the sizes of models, we doubled the size of embedding vectors for both SR-GNN and RepeatNet. This manipulation allows the model without side information to have a same size compared with the model that has a side information encoder. We evaluated the enlarged models on Diginetica dataset, and compared those enlarged models with models with side information encoder. The result is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.T4" title="Table 4 ‣ 7.3.2 Analysis ‣ 7.3 Evaluating the effect of incorporating side information ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">4</span></a>. From the table, we can see that increasing the size of model doesn’t lead to performance gain, which suggests that our success is not resulting from simply increasing the number of parameters.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S7.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4 </span>Evaluating the effect of attention loss</h3>
<section class="ltx_subsubsection" id="S7.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.4.1 </span>Performance</h4>
<div class="ltx_para" id="S7.SS4.SSS1.p1">
<p class="ltx_p" id="S7.SS4.SSS1.p1.1">We experimented with the effectiveness of attention loss by testing SR-GNN model on TaFeng dataset. In particular, we incorporated and tested the attention loss proposed in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S6.SS2" title="6.2 Attention loss ‣ 6 Algorithm description ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">6.2</span></a> with various weights. The result is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.F6" title="Figure 6 ‣ 7.4.1 Performance ‣ 7.4 Evaluating the effect of attention loss ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure class="ltx_figure" id="S7.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="218" id="S7.F6.g1" src="extracted/5637323/attentionloss.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Effect of attention loss</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S7.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.4.2 </span>Analysis</h4>
<div class="ltx_para" id="S7.SS4.SSS2.p1">
<p class="ltx_p" id="S7.SS4.SSS2.p1.1">From Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#S7.F6" title="Figure 6 ‣ 7.4.1 Performance ‣ 7.4 Evaluating the effect of attention loss ‣ 7 Experimental result ‣ Making Recommender Systems More Knowledgeable: A Framework to Incorporate Side Information"><span class="ltx_text ltx_ref_tag">6</span></a> we can see that both metrics become worse as we increase the weight of attention loss. This means that the attention loss is not able to boost the performance of the recommender system. We still believe that the model should pay more attention to an item in a session if that item is identical to the target item or that item shares the same side information with the target item. However, our proposed attention loss fails to improve model performance, and we hypothesize that the reason behind is that it is hard to set the correct target for attention used in attention loss, as there is no convincing theory guiding us to set the target.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">In this paper, we present a general framework to incorporate side information into session-based recommender systems using neural network architectures. Our experiments based on RepeatNet and SR-GNN using the Diginetica, MovieLens, and Ta Feng datasets confirm that the use of side information can be easily applied to deep neural network models of various architectures and help boost their performance. Not only does our method achieve better results than prior approaches, including some state-of-the-art models, it also shortens the time taken to converge.</p>
</div>
<section class="ltx_paragraph" id="S8.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Limitations</h5>
<div class="ltx_para" id="S8.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S8.SS0.SSS0.Px1.p1.1">There are mainly two limitations of this work. Firstly, the method is only targeting general deep neural networks but may not be applicable to other models like KNN-based models. In addition, the performance of incorporating side information into existing models is highly dependent on the variety and quality of the side information. Secondly, under SR-GNN, the item to side information relationship can only be one-to-one. For example, if the genre of a movie is used as side information, but each movie has multiple genres, SR-GNN is not able to utilize all information except for using only one of them. We believe that these limitations can be insights that lead to promising future directions.</p>
</div>
</section>
<section class="ltx_paragraph" id="S8.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Code</h5>
<div class="ltx_para" id="S8.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S8.SS0.SSS0.Px2.p1.1">To facilitate reproducibility of our results, we share the code for our experiments at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/YukunJ/11785-Final-Project-Team15" title="">https://github.com/YukunJ/11785-Final-Project-Team15</a>.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. [2021]</span>
<span class="ltx_bibblock">
Priyanka Gupta, Diksha Garg, Pankaj Malhotra, Lovekesh Vig, and Gautam Shroff.

</span>
<span class="ltx_bibblock">Niser: Normalized item and session representations to handle
popularity bias, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et al. [2020]</span>
<span class="ltx_bibblock">
Wenjing Meng, Deqing Yang, and Yanghua Xiao.

</span>
<span class="ltx_bibblock">Incorporating user micro-behaviors and item knowledge into multi-task
learning for session-based recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 43rd International ACM SIGIR Conference on
Research and Development in Information Retrieval</em>, Jul 2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3397271.3401098</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1145/3397271.3401098" title="">http://dx.doi.org/10.1145/3397271.3401098</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. [2019]</span>
<span class="ltx_bibblock">
Pengjie Ren, Zhumin Chen, Jing Li, Zhaochun Ren, Jun Ma, and Maarten Rijke.

</span>
<span class="ltx_bibblock">Repeatnet: A repeat aware neural recommendation machine for
session-based recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
33:4806–4813, 07 2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1609/aaai.v33i01.33014806</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2021]</span>
<span class="ltx_bibblock">
Shoujin Wang, Longbing Cao, Yan Wang, Quan Z. Sheng, Mehmet Orgun, and Defu
Lian.

</span>
<span class="ltx_bibblock">A survey on session-based recommender systems, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2019]</span>
<span class="ltx_bibblock">
Shu Wu, Yuyuan Tang, Yanqiao Zhu, Liang Wang, Xing Xie, and Tieniu Tan.

</span>
<span class="ltx_bibblock">Session-based recommendation with graph neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>,
33:346–353, Jul 2019.

</span>
<span class="ltx_bibblock">ISSN 2159-5399.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1609/aaai.v33i01.3301346</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1609/aaai.v33i01.3301346" title="">http://dx.doi.org/10.1609/aaai.v33i01.3301346</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>RepeatNet Architecture</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.6">Given an available session <math alttext="I_{S}=\{i_{1},i_{2},\cdots,i_{j},\cdots,i_{t}\}" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.6"><semantics id="A1.SS1.p1.1.m1.6a"><mrow id="A1.SS1.p1.1.m1.6.6" xref="A1.SS1.p1.1.m1.6.6.cmml"><msub id="A1.SS1.p1.1.m1.6.6.6" xref="A1.SS1.p1.1.m1.6.6.6.cmml"><mi id="A1.SS1.p1.1.m1.6.6.6.2" xref="A1.SS1.p1.1.m1.6.6.6.2.cmml">I</mi><mi id="A1.SS1.p1.1.m1.6.6.6.3" xref="A1.SS1.p1.1.m1.6.6.6.3.cmml">S</mi></msub><mo id="A1.SS1.p1.1.m1.6.6.5" xref="A1.SS1.p1.1.m1.6.6.5.cmml">=</mo><mrow id="A1.SS1.p1.1.m1.6.6.4.4" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml"><mo id="A1.SS1.p1.1.m1.6.6.4.4.5" stretchy="false" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml">{</mo><msub id="A1.SS1.p1.1.m1.3.3.1.1.1" xref="A1.SS1.p1.1.m1.3.3.1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.3.3.1.1.1.2" xref="A1.SS1.p1.1.m1.3.3.1.1.1.2.cmml">i</mi><mn id="A1.SS1.p1.1.m1.3.3.1.1.1.3" xref="A1.SS1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS1.p1.1.m1.6.6.4.4.6" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml">,</mo><msub id="A1.SS1.p1.1.m1.4.4.2.2.2" xref="A1.SS1.p1.1.m1.4.4.2.2.2.cmml"><mi id="A1.SS1.p1.1.m1.4.4.2.2.2.2" xref="A1.SS1.p1.1.m1.4.4.2.2.2.2.cmml">i</mi><mn id="A1.SS1.p1.1.m1.4.4.2.2.2.3" xref="A1.SS1.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="A1.SS1.p1.1.m1.6.6.4.4.7" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml">,</mo><mi id="A1.SS1.p1.1.m1.1.1" mathvariant="normal" xref="A1.SS1.p1.1.m1.1.1.cmml">⋯</mi><mo id="A1.SS1.p1.1.m1.6.6.4.4.8" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml">,</mo><msub id="A1.SS1.p1.1.m1.5.5.3.3.3" xref="A1.SS1.p1.1.m1.5.5.3.3.3.cmml"><mi id="A1.SS1.p1.1.m1.5.5.3.3.3.2" xref="A1.SS1.p1.1.m1.5.5.3.3.3.2.cmml">i</mi><mi id="A1.SS1.p1.1.m1.5.5.3.3.3.3" xref="A1.SS1.p1.1.m1.5.5.3.3.3.3.cmml">j</mi></msub><mo id="A1.SS1.p1.1.m1.6.6.4.4.9" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml">,</mo><mi id="A1.SS1.p1.1.m1.2.2" mathvariant="normal" xref="A1.SS1.p1.1.m1.2.2.cmml">⋯</mi><mo id="A1.SS1.p1.1.m1.6.6.4.4.10" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml">,</mo><msub id="A1.SS1.p1.1.m1.6.6.4.4.4" xref="A1.SS1.p1.1.m1.6.6.4.4.4.cmml"><mi id="A1.SS1.p1.1.m1.6.6.4.4.4.2" xref="A1.SS1.p1.1.m1.6.6.4.4.4.2.cmml">i</mi><mi id="A1.SS1.p1.1.m1.6.6.4.4.4.3" xref="A1.SS1.p1.1.m1.6.6.4.4.4.3.cmml">t</mi></msub><mo id="A1.SS1.p1.1.m1.6.6.4.4.11" stretchy="false" xref="A1.SS1.p1.1.m1.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.6b"><apply id="A1.SS1.p1.1.m1.6.6.cmml" xref="A1.SS1.p1.1.m1.6.6"><eq id="A1.SS1.p1.1.m1.6.6.5.cmml" xref="A1.SS1.p1.1.m1.6.6.5"></eq><apply id="A1.SS1.p1.1.m1.6.6.6.cmml" xref="A1.SS1.p1.1.m1.6.6.6"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.6.6.6.1.cmml" xref="A1.SS1.p1.1.m1.6.6.6">subscript</csymbol><ci id="A1.SS1.p1.1.m1.6.6.6.2.cmml" xref="A1.SS1.p1.1.m1.6.6.6.2">𝐼</ci><ci id="A1.SS1.p1.1.m1.6.6.6.3.cmml" xref="A1.SS1.p1.1.m1.6.6.6.3">𝑆</ci></apply><set id="A1.SS1.p1.1.m1.6.6.4.5.cmml" xref="A1.SS1.p1.1.m1.6.6.4.4"><apply id="A1.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="A1.SS1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.3.3.1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.3.3.1.1.1.2">𝑖</ci><cn id="A1.SS1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="A1.SS1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="A1.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="A1.SS1.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.4.4.2.2.2.1.cmml" xref="A1.SS1.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="A1.SS1.p1.1.m1.4.4.2.2.2.2.cmml" xref="A1.SS1.p1.1.m1.4.4.2.2.2.2">𝑖</ci><cn id="A1.SS1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="A1.SS1.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">⋯</ci><apply id="A1.SS1.p1.1.m1.5.5.3.3.3.cmml" xref="A1.SS1.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.5.5.3.3.3.1.cmml" xref="A1.SS1.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="A1.SS1.p1.1.m1.5.5.3.3.3.2.cmml" xref="A1.SS1.p1.1.m1.5.5.3.3.3.2">𝑖</ci><ci id="A1.SS1.p1.1.m1.5.5.3.3.3.3.cmml" xref="A1.SS1.p1.1.m1.5.5.3.3.3.3">𝑗</ci></apply><ci id="A1.SS1.p1.1.m1.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2">⋯</ci><apply id="A1.SS1.p1.1.m1.6.6.4.4.4.cmml" xref="A1.SS1.p1.1.m1.6.6.4.4.4"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.6.6.4.4.4.1.cmml" xref="A1.SS1.p1.1.m1.6.6.4.4.4">subscript</csymbol><ci id="A1.SS1.p1.1.m1.6.6.4.4.4.2.cmml" xref="A1.SS1.p1.1.m1.6.6.4.4.4.2">𝑖</ci><ci id="A1.SS1.p1.1.m1.6.6.4.4.4.3.cmml" xref="A1.SS1.p1.1.m1.6.6.4.4.4.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.6c">I_{S}=\{i_{1},i_{2},\cdots,i_{j},\cdots,i_{t}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.6d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> where <math alttext="i_{j}" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><msub id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><mi id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml">i</mi><mi id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2">𝑖</ci><ci id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">i_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> refers to the <math alttext="j" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m3.1"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.1d">italic_j</annotation></semantics></math>-th action (purchasing, browsing, etc.), any session-based recommender system aims to predict the next action through a probabilistic interpretation <math alttext="\mathbf{P}(i_{t+1}|I_{S})" class="ltx_Math" display="inline" id="A1.SS1.p1.4.m4.1"><semantics id="A1.SS1.p1.4.m4.1a"><mrow id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml"><mi id="A1.SS1.p1.4.m4.1.1.3" xref="A1.SS1.p1.4.m4.1.1.3.cmml">𝐏</mi><mo id="A1.SS1.p1.4.m4.1.1.2" xref="A1.SS1.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p1.4.m4.1.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.1.1.cmml"><mo id="A1.SS1.p1.4.m4.1.1.1.1.2" stretchy="false" xref="A1.SS1.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p1.4.m4.1.1.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.1.1.cmml"><msub id="A1.SS1.p1.4.m4.1.1.1.1.1.2" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.cmml"><mi id="A1.SS1.p1.4.m4.1.1.1.1.1.2.2" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.2.cmml">i</mi><mrow id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.cmml"><mi id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.2" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.1" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.3" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.SS1.p1.4.m4.1.1.1.1.1.1" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="A1.SS1.p1.4.m4.1.1.1.1.1.3" xref="A1.SS1.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="A1.SS1.p1.4.m4.1.1.1.1.1.3.2" xref="A1.SS1.p1.4.m4.1.1.1.1.1.3.2.cmml">I</mi><mi id="A1.SS1.p1.4.m4.1.1.1.1.1.3.3" xref="A1.SS1.p1.4.m4.1.1.1.1.1.3.3.cmml">S</mi></msub></mrow><mo id="A1.SS1.p1.4.m4.1.1.1.1.3" stretchy="false" xref="A1.SS1.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><apply id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1"><times id="A1.SS1.p1.4.m4.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.2"></times><ci id="A1.SS1.p1.4.m4.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.3">𝐏</ci><apply id="A1.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.2">𝑖</ci><apply id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3"><plus id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.1"></plus><ci id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.SS1.p1.4.m4.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.SS1.p1.4.m4.1.1.1.1.1.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="A1.SS1.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.3.2">𝐼</ci><ci id="A1.SS1.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="A1.SS1.p1.4.m4.1.1.1.1.1.3.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">\mathbf{P}(i_{t+1}|I_{S})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">bold_P ( italic_i start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT )</annotation></semantics></math>. The RepeatNet utilizes the insights that people tend to repeat their action along the timeline, and design two modes of people’s next action: Exploration(<math alttext="e" class="ltx_Math" display="inline" id="A1.SS1.p1.5.m5.1"><semantics id="A1.SS1.p1.5.m5.1a"><mi id="A1.SS1.p1.5.m5.1.1" xref="A1.SS1.p1.5.m5.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m5.1b"><ci id="A1.SS1.p1.5.m5.1.1.cmml" xref="A1.SS1.p1.5.m5.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m5.1c">e</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.5.m5.1d">italic_e</annotation></semantics></math>) or Repeat(<math alttext="r" class="ltx_Math" display="inline" id="A1.SS1.p1.6.m6.1"><semantics id="A1.SS1.p1.6.m6.1a"><mi id="A1.SS1.p1.6.m6.1.1" xref="A1.SS1.p1.6.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m6.1b"><ci id="A1.SS1.p1.6.m6.1.1.cmml" xref="A1.SS1.p1.6.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.6.m6.1d">italic_r</annotation></semantics></math>). Mathematically, it is written</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx8">
<tbody id="A1.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{P}(i_{t+1}|I_{S})" class="ltx_Math" display="inline" id="A1.E18.m1.1"><semantics id="A1.E18.m1.1a"><mrow id="A1.E18.m1.1.1" xref="A1.E18.m1.1.1.cmml"><mi id="A1.E18.m1.1.1.3" xref="A1.E18.m1.1.1.3.cmml">𝐏</mi><mo id="A1.E18.m1.1.1.2" xref="A1.E18.m1.1.1.2.cmml">⁢</mo><mrow id="A1.E18.m1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.cmml"><mo id="A1.E18.m1.1.1.1.1.2" stretchy="false" xref="A1.E18.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.cmml"><msub id="A1.E18.m1.1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.1.2.cmml"><mi id="A1.E18.m1.1.1.1.1.1.2.2" xref="A1.E18.m1.1.1.1.1.1.2.2.cmml">i</mi><mrow id="A1.E18.m1.1.1.1.1.1.2.3" xref="A1.E18.m1.1.1.1.1.1.2.3.cmml"><mi id="A1.E18.m1.1.1.1.1.1.2.3.2" xref="A1.E18.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.E18.m1.1.1.1.1.1.2.3.1" xref="A1.E18.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A1.E18.m1.1.1.1.1.1.2.3.3" xref="A1.E18.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.E18.m1.1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.1.cmml">|</mo><msub id="A1.E18.m1.1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.1.3.cmml"><mi id="A1.E18.m1.1.1.1.1.1.3.2" xref="A1.E18.m1.1.1.1.1.1.3.2.cmml">I</mi><mi id="A1.E18.m1.1.1.1.1.1.3.3" xref="A1.E18.m1.1.1.1.1.1.3.3.cmml">S</mi></msub></mrow><mo id="A1.E18.m1.1.1.1.1.3" stretchy="false" xref="A1.E18.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.1b"><apply id="A1.E18.m1.1.1.cmml" xref="A1.E18.m1.1.1"><times id="A1.E18.m1.1.1.2.cmml" xref="A1.E18.m1.1.1.2"></times><ci id="A1.E18.m1.1.1.3.cmml" xref="A1.E18.m1.1.1.3">𝐏</ci><apply id="A1.E18.m1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m1.1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E18.m1.1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.1.2.2">𝑖</ci><apply id="A1.E18.m1.1.1.1.1.1.2.3.cmml" xref="A1.E18.m1.1.1.1.1.1.2.3"><plus id="A1.E18.m1.1.1.1.1.1.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.2.3.1"></plus><ci id="A1.E18.m1.1.1.1.1.1.2.3.2.cmml" xref="A1.E18.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A1.E18.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E18.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.E18.m1.1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.1.3.2.cmml" xref="A1.E18.m1.1.1.1.1.1.3.2">𝐼</ci><ci id="A1.E18.m1.1.1.1.1.1.3.3.cmml" xref="A1.E18.m1.1.1.1.1.1.3.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.1c">\displaystyle\mathbf{P}(i_{t+1}|I_{S})</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.1d">bold_P ( italic_i start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{P}(i_{t+1}|I_{S},e)\mathbf{P}(e|I_{S})+\mathbf{P}(i_{t+1%
}|I_{S},r)\mathbf{P}(r|I_{S})" class="ltx_Math" display="inline" id="A1.E18.m2.6"><semantics id="A1.E18.m2.6a"><mrow id="A1.E18.m2.6.6" xref="A1.E18.m2.6.6.cmml"><mi id="A1.E18.m2.6.6.6" xref="A1.E18.m2.6.6.6.cmml"></mi><mo id="A1.E18.m2.6.6.5" xref="A1.E18.m2.6.6.5.cmml">=</mo><mrow id="A1.E18.m2.6.6.4" xref="A1.E18.m2.6.6.4.cmml"><mrow id="A1.E18.m2.4.4.2.2" xref="A1.E18.m2.4.4.2.2.cmml"><mi id="A1.E18.m2.4.4.2.2.4" xref="A1.E18.m2.4.4.2.2.4.cmml">𝐏</mi><mo id="A1.E18.m2.4.4.2.2.3" xref="A1.E18.m2.4.4.2.2.3.cmml">⁢</mo><mrow id="A1.E18.m2.3.3.1.1.1.1" xref="A1.E18.m2.3.3.1.1.1.1.1.cmml"><mo id="A1.E18.m2.3.3.1.1.1.1.2" stretchy="false" xref="A1.E18.m2.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.E18.m2.3.3.1.1.1.1.1" xref="A1.E18.m2.3.3.1.1.1.1.1.cmml"><msub id="A1.E18.m2.3.3.1.1.1.1.1.3" xref="A1.E18.m2.3.3.1.1.1.1.1.3.cmml"><mi id="A1.E18.m2.3.3.1.1.1.1.1.3.2" xref="A1.E18.m2.3.3.1.1.1.1.1.3.2.cmml">i</mi><mrow id="A1.E18.m2.3.3.1.1.1.1.1.3.3" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3.cmml"><mi id="A1.E18.m2.3.3.1.1.1.1.1.3.3.2" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A1.E18.m2.3.3.1.1.1.1.1.3.3.1" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="A1.E18.m2.3.3.1.1.1.1.1.3.3.3" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.E18.m2.3.3.1.1.1.1.1.2" xref="A1.E18.m2.3.3.1.1.1.1.1.2.cmml">|</mo><mrow id="A1.E18.m2.3.3.1.1.1.1.1.1.1" xref="A1.E18.m2.3.3.1.1.1.1.1.1.2.cmml"><msub id="A1.E18.m2.3.3.1.1.1.1.1.1.1.1" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.2" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">I</mi><mi id="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.3" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="A1.E18.m2.3.3.1.1.1.1.1.1.1.2" xref="A1.E18.m2.3.3.1.1.1.1.1.1.2.cmml">,</mo><mi id="A1.E18.m2.1.1" xref="A1.E18.m2.1.1.cmml">e</mi></mrow></mrow><mo id="A1.E18.m2.3.3.1.1.1.1.3" stretchy="false" xref="A1.E18.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E18.m2.4.4.2.2.3a" xref="A1.E18.m2.4.4.2.2.3.cmml">⁢</mo><mi id="A1.E18.m2.4.4.2.2.5" xref="A1.E18.m2.4.4.2.2.5.cmml">𝐏</mi><mo id="A1.E18.m2.4.4.2.2.3b" xref="A1.E18.m2.4.4.2.2.3.cmml">⁢</mo><mrow id="A1.E18.m2.4.4.2.2.2.1" xref="A1.E18.m2.4.4.2.2.2.1.1.cmml"><mo id="A1.E18.m2.4.4.2.2.2.1.2" stretchy="false" xref="A1.E18.m2.4.4.2.2.2.1.1.cmml">(</mo><mrow id="A1.E18.m2.4.4.2.2.2.1.1" xref="A1.E18.m2.4.4.2.2.2.1.1.cmml"><mi id="A1.E18.m2.4.4.2.2.2.1.1.2" xref="A1.E18.m2.4.4.2.2.2.1.1.2.cmml">e</mi><mo fence="false" id="A1.E18.m2.4.4.2.2.2.1.1.1" xref="A1.E18.m2.4.4.2.2.2.1.1.1.cmml">|</mo><msub id="A1.E18.m2.4.4.2.2.2.1.1.3" xref="A1.E18.m2.4.4.2.2.2.1.1.3.cmml"><mi id="A1.E18.m2.4.4.2.2.2.1.1.3.2" xref="A1.E18.m2.4.4.2.2.2.1.1.3.2.cmml">I</mi><mi id="A1.E18.m2.4.4.2.2.2.1.1.3.3" xref="A1.E18.m2.4.4.2.2.2.1.1.3.3.cmml">S</mi></msub></mrow><mo id="A1.E18.m2.4.4.2.2.2.1.3" stretchy="false" xref="A1.E18.m2.4.4.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E18.m2.6.6.4.5" xref="A1.E18.m2.6.6.4.5.cmml">+</mo><mrow id="A1.E18.m2.6.6.4.4" xref="A1.E18.m2.6.6.4.4.cmml"><mi id="A1.E18.m2.6.6.4.4.4" xref="A1.E18.m2.6.6.4.4.4.cmml">𝐏</mi><mo id="A1.E18.m2.6.6.4.4.3" xref="A1.E18.m2.6.6.4.4.3.cmml">⁢</mo><mrow id="A1.E18.m2.5.5.3.3.1.1" xref="A1.E18.m2.5.5.3.3.1.1.1.cmml"><mo id="A1.E18.m2.5.5.3.3.1.1.2" stretchy="false" xref="A1.E18.m2.5.5.3.3.1.1.1.cmml">(</mo><mrow id="A1.E18.m2.5.5.3.3.1.1.1" xref="A1.E18.m2.5.5.3.3.1.1.1.cmml"><msub id="A1.E18.m2.5.5.3.3.1.1.1.3" xref="A1.E18.m2.5.5.3.3.1.1.1.3.cmml"><mi id="A1.E18.m2.5.5.3.3.1.1.1.3.2" xref="A1.E18.m2.5.5.3.3.1.1.1.3.2.cmml">i</mi><mrow id="A1.E18.m2.5.5.3.3.1.1.1.3.3" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3.cmml"><mi id="A1.E18.m2.5.5.3.3.1.1.1.3.3.2" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3.2.cmml">t</mi><mo id="A1.E18.m2.5.5.3.3.1.1.1.3.3.1" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3.1.cmml">+</mo><mn id="A1.E18.m2.5.5.3.3.1.1.1.3.3.3" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.E18.m2.5.5.3.3.1.1.1.2" xref="A1.E18.m2.5.5.3.3.1.1.1.2.cmml">|</mo><mrow id="A1.E18.m2.5.5.3.3.1.1.1.1.1" xref="A1.E18.m2.5.5.3.3.1.1.1.1.2.cmml"><msub id="A1.E18.m2.5.5.3.3.1.1.1.1.1.1" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.cmml"><mi id="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.2" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.2.cmml">I</mi><mi id="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.3" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="A1.E18.m2.5.5.3.3.1.1.1.1.1.2" xref="A1.E18.m2.5.5.3.3.1.1.1.1.2.cmml">,</mo><mi id="A1.E18.m2.2.2" xref="A1.E18.m2.2.2.cmml">r</mi></mrow></mrow><mo id="A1.E18.m2.5.5.3.3.1.1.3" stretchy="false" xref="A1.E18.m2.5.5.3.3.1.1.1.cmml">)</mo></mrow><mo id="A1.E18.m2.6.6.4.4.3a" xref="A1.E18.m2.6.6.4.4.3.cmml">⁢</mo><mi id="A1.E18.m2.6.6.4.4.5" xref="A1.E18.m2.6.6.4.4.5.cmml">𝐏</mi><mo id="A1.E18.m2.6.6.4.4.3b" xref="A1.E18.m2.6.6.4.4.3.cmml">⁢</mo><mrow id="A1.E18.m2.6.6.4.4.2.1" xref="A1.E18.m2.6.6.4.4.2.1.1.cmml"><mo id="A1.E18.m2.6.6.4.4.2.1.2" stretchy="false" xref="A1.E18.m2.6.6.4.4.2.1.1.cmml">(</mo><mrow id="A1.E18.m2.6.6.4.4.2.1.1" xref="A1.E18.m2.6.6.4.4.2.1.1.cmml"><mi id="A1.E18.m2.6.6.4.4.2.1.1.2" xref="A1.E18.m2.6.6.4.4.2.1.1.2.cmml">r</mi><mo fence="false" id="A1.E18.m2.6.6.4.4.2.1.1.1" xref="A1.E18.m2.6.6.4.4.2.1.1.1.cmml">|</mo><msub id="A1.E18.m2.6.6.4.4.2.1.1.3" xref="A1.E18.m2.6.6.4.4.2.1.1.3.cmml"><mi id="A1.E18.m2.6.6.4.4.2.1.1.3.2" xref="A1.E18.m2.6.6.4.4.2.1.1.3.2.cmml">I</mi><mi id="A1.E18.m2.6.6.4.4.2.1.1.3.3" xref="A1.E18.m2.6.6.4.4.2.1.1.3.3.cmml">S</mi></msub></mrow><mo id="A1.E18.m2.6.6.4.4.2.1.3" stretchy="false" xref="A1.E18.m2.6.6.4.4.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m2.6b"><apply id="A1.E18.m2.6.6.cmml" xref="A1.E18.m2.6.6"><eq id="A1.E18.m2.6.6.5.cmml" xref="A1.E18.m2.6.6.5"></eq><csymbol cd="latexml" id="A1.E18.m2.6.6.6.cmml" xref="A1.E18.m2.6.6.6">absent</csymbol><apply id="A1.E18.m2.6.6.4.cmml" xref="A1.E18.m2.6.6.4"><plus id="A1.E18.m2.6.6.4.5.cmml" xref="A1.E18.m2.6.6.4.5"></plus><apply id="A1.E18.m2.4.4.2.2.cmml" xref="A1.E18.m2.4.4.2.2"><times id="A1.E18.m2.4.4.2.2.3.cmml" xref="A1.E18.m2.4.4.2.2.3"></times><ci id="A1.E18.m2.4.4.2.2.4.cmml" xref="A1.E18.m2.4.4.2.2.4">𝐏</ci><apply id="A1.E18.m2.3.3.1.1.1.1.1.cmml" xref="A1.E18.m2.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.E18.m2.3.3.1.1.1.1.1.2.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.2">conditional</csymbol><apply id="A1.E18.m2.3.3.1.1.1.1.1.3.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m2.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E18.m2.3.3.1.1.1.1.1.3.2.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.3.2">𝑖</ci><apply id="A1.E18.m2.3.3.1.1.1.1.1.3.3.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3"><plus id="A1.E18.m2.3.3.1.1.1.1.1.3.3.1.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3.1"></plus><ci id="A1.E18.m2.3.3.1.1.1.1.1.3.3.2.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A1.E18.m2.3.3.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E18.m2.3.3.1.1.1.1.1.3.3.3">1</cn></apply></apply><list id="A1.E18.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1"><apply id="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.2">𝐼</ci><ci id="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E18.m2.3.3.1.1.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="A1.E18.m2.1.1.cmml" xref="A1.E18.m2.1.1">𝑒</ci></list></apply><ci id="A1.E18.m2.4.4.2.2.5.cmml" xref="A1.E18.m2.4.4.2.2.5">𝐏</ci><apply id="A1.E18.m2.4.4.2.2.2.1.1.cmml" xref="A1.E18.m2.4.4.2.2.2.1"><csymbol cd="latexml" id="A1.E18.m2.4.4.2.2.2.1.1.1.cmml" xref="A1.E18.m2.4.4.2.2.2.1.1.1">conditional</csymbol><ci id="A1.E18.m2.4.4.2.2.2.1.1.2.cmml" xref="A1.E18.m2.4.4.2.2.2.1.1.2">𝑒</ci><apply id="A1.E18.m2.4.4.2.2.2.1.1.3.cmml" xref="A1.E18.m2.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m2.4.4.2.2.2.1.1.3.1.cmml" xref="A1.E18.m2.4.4.2.2.2.1.1.3">subscript</csymbol><ci id="A1.E18.m2.4.4.2.2.2.1.1.3.2.cmml" xref="A1.E18.m2.4.4.2.2.2.1.1.3.2">𝐼</ci><ci id="A1.E18.m2.4.4.2.2.2.1.1.3.3.cmml" xref="A1.E18.m2.4.4.2.2.2.1.1.3.3">𝑆</ci></apply></apply></apply><apply id="A1.E18.m2.6.6.4.4.cmml" xref="A1.E18.m2.6.6.4.4"><times id="A1.E18.m2.6.6.4.4.3.cmml" xref="A1.E18.m2.6.6.4.4.3"></times><ci id="A1.E18.m2.6.6.4.4.4.cmml" xref="A1.E18.m2.6.6.4.4.4">𝐏</ci><apply id="A1.E18.m2.5.5.3.3.1.1.1.cmml" xref="A1.E18.m2.5.5.3.3.1.1"><csymbol cd="latexml" id="A1.E18.m2.5.5.3.3.1.1.1.2.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.2">conditional</csymbol><apply id="A1.E18.m2.5.5.3.3.1.1.1.3.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m2.5.5.3.3.1.1.1.3.1.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E18.m2.5.5.3.3.1.1.1.3.2.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.3.2">𝑖</ci><apply id="A1.E18.m2.5.5.3.3.1.1.1.3.3.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3"><plus id="A1.E18.m2.5.5.3.3.1.1.1.3.3.1.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3.1"></plus><ci id="A1.E18.m2.5.5.3.3.1.1.1.3.3.2.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3.2">𝑡</ci><cn id="A1.E18.m2.5.5.3.3.1.1.1.3.3.3.cmml" type="integer" xref="A1.E18.m2.5.5.3.3.1.1.1.3.3.3">1</cn></apply></apply><list id="A1.E18.m2.5.5.3.3.1.1.1.1.2.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1"><apply id="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.2">𝐼</ci><ci id="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E18.m2.5.5.3.3.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="A1.E18.m2.2.2.cmml" xref="A1.E18.m2.2.2">𝑟</ci></list></apply><ci id="A1.E18.m2.6.6.4.4.5.cmml" xref="A1.E18.m2.6.6.4.4.5">𝐏</ci><apply id="A1.E18.m2.6.6.4.4.2.1.1.cmml" xref="A1.E18.m2.6.6.4.4.2.1"><csymbol cd="latexml" id="A1.E18.m2.6.6.4.4.2.1.1.1.cmml" xref="A1.E18.m2.6.6.4.4.2.1.1.1">conditional</csymbol><ci id="A1.E18.m2.6.6.4.4.2.1.1.2.cmml" xref="A1.E18.m2.6.6.4.4.2.1.1.2">𝑟</ci><apply id="A1.E18.m2.6.6.4.4.2.1.1.3.cmml" xref="A1.E18.m2.6.6.4.4.2.1.1.3"><csymbol cd="ambiguous" id="A1.E18.m2.6.6.4.4.2.1.1.3.1.cmml" xref="A1.E18.m2.6.6.4.4.2.1.1.3">subscript</csymbol><ci id="A1.E18.m2.6.6.4.4.2.1.1.3.2.cmml" xref="A1.E18.m2.6.6.4.4.2.1.1.3.2">𝐼</ci><ci id="A1.E18.m2.6.6.4.4.2.1.1.3.3.cmml" xref="A1.E18.m2.6.6.4.4.2.1.1.3.3">𝑆</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m2.6c">\displaystyle=\mathbf{P}(i_{t+1}|I_{S},e)\mathbf{P}(e|I_{S})+\mathbf{P}(i_{t+1%
}|I_{S},r)\mathbf{P}(r|I_{S})</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m2.6d">= bold_P ( italic_i start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_e ) bold_P ( italic_e | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ) + bold_P ( italic_i start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_r ) bold_P ( italic_r | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">To be able to compute each probabilistic component of the above equation, they designed an attention-based recurrent neural network architecture, mainly in four units, and modified objective function:</p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1">Session encoder</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">Repeat-or-explore mechanism</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">Repeat mode decoder</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.1">Explore mode decoder</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i5.p1">
<p class="ltx_p" id="A1.I1.i5.p1.1">Repeat-explore loss</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsubsection" id="A1.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.1 </span>Session encoder</h4>
<div class="ltx_para" id="A1.SS1.SSS1.p1">
<p class="ltx_p" id="A1.SS1.SSS1.p1.1">A Gated Recurrent Unit (<span class="ltx_text ltx_font_bold" id="A1.SS1.SSS1.p1.1.1">GRU</span>) is used to encode the session <math alttext="I_{S}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p1.1.m1.1"><semantics id="A1.SS1.SSS1.p1.1.m1.1a"><msub id="A1.SS1.SSS1.p1.1.m1.1.1" xref="A1.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.SSS1.p1.1.m1.1.1.2" xref="A1.SS1.SSS1.p1.1.m1.1.1.2.cmml">I</mi><mi id="A1.SS1.SSS1.p1.1.m1.1.1.3" xref="A1.SS1.SSS1.p1.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p1.1.m1.1b"><apply id="A1.SS1.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.2">𝐼</ci><ci id="A1.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.SSS1.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p1.1.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p1.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, the GRU works as follows:</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS1.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx9">
<tbody id="A1.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle z_{r}" class="ltx_Math" display="inline" id="A1.E19.m1.1"><semantics id="A1.E19.m1.1a"><msub id="A1.E19.m1.1.1" xref="A1.E19.m1.1.1.cmml"><mi id="A1.E19.m1.1.1.2" xref="A1.E19.m1.1.1.2.cmml">z</mi><mi id="A1.E19.m1.1.1.3" xref="A1.E19.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.E19.m1.1b"><apply id="A1.E19.m1.1.1.cmml" xref="A1.E19.m1.1.1"><csymbol cd="ambiguous" id="A1.E19.m1.1.1.1.cmml" xref="A1.E19.m1.1.1">subscript</csymbol><ci id="A1.E19.m1.1.1.2.cmml" xref="A1.E19.m1.1.1.2">𝑧</ci><ci id="A1.E19.m1.1.1.3.cmml" xref="A1.E19.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m1.1c">\displaystyle z_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E19.m1.1d">italic_z start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W_{z}[emb(i_{r}),h_{r-1}])" class="ltx_Math" display="inline" id="A1.E19.m2.1"><semantics id="A1.E19.m2.1a"><mrow id="A1.E19.m2.1.1" xref="A1.E19.m2.1.1.cmml"><mi id="A1.E19.m2.1.1.3" xref="A1.E19.m2.1.1.3.cmml"></mi><mo id="A1.E19.m2.1.1.2" xref="A1.E19.m2.1.1.2.cmml">=</mo><mrow id="A1.E19.m2.1.1.1" xref="A1.E19.m2.1.1.1.cmml"><mi id="A1.E19.m2.1.1.1.3" xref="A1.E19.m2.1.1.1.3.cmml">σ</mi><mo id="A1.E19.m2.1.1.1.2" xref="A1.E19.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m2.1.1.1.1.1" xref="A1.E19.m2.1.1.1.1.1.1.cmml"><mo id="A1.E19.m2.1.1.1.1.1.2" stretchy="false" xref="A1.E19.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E19.m2.1.1.1.1.1.1" xref="A1.E19.m2.1.1.1.1.1.1.cmml"><msub id="A1.E19.m2.1.1.1.1.1.1.4" xref="A1.E19.m2.1.1.1.1.1.1.4.cmml"><mi id="A1.E19.m2.1.1.1.1.1.1.4.2" xref="A1.E19.m2.1.1.1.1.1.1.4.2.cmml">W</mi><mi id="A1.E19.m2.1.1.1.1.1.1.4.3" xref="A1.E19.m2.1.1.1.1.1.1.4.3.cmml">z</mi></msub><mo id="A1.E19.m2.1.1.1.1.1.1.3" xref="A1.E19.m2.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.E19.m2.1.1.1.1.1.1.2.2" xref="A1.E19.m2.1.1.1.1.1.1.2.3.cmml"><mo id="A1.E19.m2.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.E19.m2.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="A1.E19.m2.1.1.1.1.1.1.1.1.1" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E19.m2.1.1.1.1.1.1.1.1.1.3" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="A1.E19.m2.1.1.1.1.1.1.1.1.1.2" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E19.m2.1.1.1.1.1.1.1.1.1.4" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="A1.E19.m2.1.1.1.1.1.1.1.1.1.2a" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E19.m2.1.1.1.1.1.1.1.1.1.5" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="A1.E19.m2.1.1.1.1.1.1.1.1.1.2b" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E19.m2.1.1.1.1.1.1.2.2.4" xref="A1.E19.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A1.E19.m2.1.1.1.1.1.1.2.2.2" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E19.m2.1.1.1.1.1.1.2.2.2.2" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.2.cmml">h</mi><mrow id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.2" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.1" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.3" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.E19.m2.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.E19.m2.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E19.m2.1.1.1.1.1.3" stretchy="false" xref="A1.E19.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E19.m2.1b"><apply id="A1.E19.m2.1.1.cmml" xref="A1.E19.m2.1.1"><eq id="A1.E19.m2.1.1.2.cmml" xref="A1.E19.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.E19.m2.1.1.3.cmml" xref="A1.E19.m2.1.1.3">absent</csymbol><apply id="A1.E19.m2.1.1.1.cmml" xref="A1.E19.m2.1.1.1"><times id="A1.E19.m2.1.1.1.2.cmml" xref="A1.E19.m2.1.1.1.2"></times><ci id="A1.E19.m2.1.1.1.3.cmml" xref="A1.E19.m2.1.1.1.3">𝜎</ci><apply id="A1.E19.m2.1.1.1.1.1.1.cmml" xref="A1.E19.m2.1.1.1.1.1"><times id="A1.E19.m2.1.1.1.1.1.1.3.cmml" xref="A1.E19.m2.1.1.1.1.1.1.3"></times><apply id="A1.E19.m2.1.1.1.1.1.1.4.cmml" xref="A1.E19.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E19.m2.1.1.1.1.1.1.4.1.cmml" xref="A1.E19.m2.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E19.m2.1.1.1.1.1.1.4.2.cmml" xref="A1.E19.m2.1.1.1.1.1.1.4.2">𝑊</ci><ci id="A1.E19.m2.1.1.1.1.1.1.4.3.cmml" xref="A1.E19.m2.1.1.1.1.1.1.4.3">𝑧</ci></apply><interval closure="closed" id="A1.E19.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.E19.m2.1.1.1.1.1.1.2.2"><apply id="A1.E19.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1"><times id="A1.E19.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E19.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="A1.E19.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.4">𝑚</ci><ci id="A1.E19.m2.1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.5">𝑏</ci><apply id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E19.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="A1.E19.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E19.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E19.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.2">ℎ</ci><apply id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3"><minus id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="A1.E19.m2.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E19.m2.1c">\displaystyle=\sigma(W_{z}[emb(i_{r}),h_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="A1.E19.m2.1d">= italic_σ ( italic_W start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_h start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
<tbody id="A1.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r_{r}" class="ltx_Math" display="inline" id="A1.E20.m1.1"><semantics id="A1.E20.m1.1a"><msub id="A1.E20.m1.1.1" xref="A1.E20.m1.1.1.cmml"><mi id="A1.E20.m1.1.1.2" xref="A1.E20.m1.1.1.2.cmml">r</mi><mi id="A1.E20.m1.1.1.3" xref="A1.E20.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.E20.m1.1b"><apply id="A1.E20.m1.1.1.cmml" xref="A1.E20.m1.1.1"><csymbol cd="ambiguous" id="A1.E20.m1.1.1.1.cmml" xref="A1.E20.m1.1.1">subscript</csymbol><ci id="A1.E20.m1.1.1.2.cmml" xref="A1.E20.m1.1.1.2">𝑟</ci><ci id="A1.E20.m1.1.1.3.cmml" xref="A1.E20.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E20.m1.1c">\displaystyle r_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E20.m1.1d">italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W_{r}[emb(i_{r}),h_{r-1}])" class="ltx_Math" display="inline" id="A1.E20.m2.1"><semantics id="A1.E20.m2.1a"><mrow id="A1.E20.m2.1.1" xref="A1.E20.m2.1.1.cmml"><mi id="A1.E20.m2.1.1.3" xref="A1.E20.m2.1.1.3.cmml"></mi><mo id="A1.E20.m2.1.1.2" xref="A1.E20.m2.1.1.2.cmml">=</mo><mrow id="A1.E20.m2.1.1.1" xref="A1.E20.m2.1.1.1.cmml"><mi id="A1.E20.m2.1.1.1.3" xref="A1.E20.m2.1.1.1.3.cmml">σ</mi><mo id="A1.E20.m2.1.1.1.2" xref="A1.E20.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E20.m2.1.1.1.1.1" xref="A1.E20.m2.1.1.1.1.1.1.cmml"><mo id="A1.E20.m2.1.1.1.1.1.2" stretchy="false" xref="A1.E20.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E20.m2.1.1.1.1.1.1" xref="A1.E20.m2.1.1.1.1.1.1.cmml"><msub id="A1.E20.m2.1.1.1.1.1.1.4" xref="A1.E20.m2.1.1.1.1.1.1.4.cmml"><mi id="A1.E20.m2.1.1.1.1.1.1.4.2" xref="A1.E20.m2.1.1.1.1.1.1.4.2.cmml">W</mi><mi id="A1.E20.m2.1.1.1.1.1.1.4.3" xref="A1.E20.m2.1.1.1.1.1.1.4.3.cmml">r</mi></msub><mo id="A1.E20.m2.1.1.1.1.1.1.3" xref="A1.E20.m2.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.E20.m2.1.1.1.1.1.1.2.2" xref="A1.E20.m2.1.1.1.1.1.1.2.3.cmml"><mo id="A1.E20.m2.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.E20.m2.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="A1.E20.m2.1.1.1.1.1.1.1.1.1" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E20.m2.1.1.1.1.1.1.1.1.1.3" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="A1.E20.m2.1.1.1.1.1.1.1.1.1.2" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E20.m2.1.1.1.1.1.1.1.1.1.4" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="A1.E20.m2.1.1.1.1.1.1.1.1.1.2a" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E20.m2.1.1.1.1.1.1.1.1.1.5" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="A1.E20.m2.1.1.1.1.1.1.1.1.1.2b" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E20.m2.1.1.1.1.1.1.2.2.4" xref="A1.E20.m2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A1.E20.m2.1.1.1.1.1.1.2.2.2" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E20.m2.1.1.1.1.1.1.2.2.2.2" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.2.cmml">h</mi><mrow id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.2" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.1" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.3" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.E20.m2.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.E20.m2.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E20.m2.1.1.1.1.1.3" stretchy="false" xref="A1.E20.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E20.m2.1b"><apply id="A1.E20.m2.1.1.cmml" xref="A1.E20.m2.1.1"><eq id="A1.E20.m2.1.1.2.cmml" xref="A1.E20.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.E20.m2.1.1.3.cmml" xref="A1.E20.m2.1.1.3">absent</csymbol><apply id="A1.E20.m2.1.1.1.cmml" xref="A1.E20.m2.1.1.1"><times id="A1.E20.m2.1.1.1.2.cmml" xref="A1.E20.m2.1.1.1.2"></times><ci id="A1.E20.m2.1.1.1.3.cmml" xref="A1.E20.m2.1.1.1.3">𝜎</ci><apply id="A1.E20.m2.1.1.1.1.1.1.cmml" xref="A1.E20.m2.1.1.1.1.1"><times id="A1.E20.m2.1.1.1.1.1.1.3.cmml" xref="A1.E20.m2.1.1.1.1.1.1.3"></times><apply id="A1.E20.m2.1.1.1.1.1.1.4.cmml" xref="A1.E20.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E20.m2.1.1.1.1.1.1.4.1.cmml" xref="A1.E20.m2.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E20.m2.1.1.1.1.1.1.4.2.cmml" xref="A1.E20.m2.1.1.1.1.1.1.4.2">𝑊</ci><ci id="A1.E20.m2.1.1.1.1.1.1.4.3.cmml" xref="A1.E20.m2.1.1.1.1.1.1.4.3">𝑟</ci></apply><interval closure="closed" id="A1.E20.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.E20.m2.1.1.1.1.1.1.2.2"><apply id="A1.E20.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1"><times id="A1.E20.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.2"></times><ci id="A1.E20.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="A1.E20.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.4">𝑚</ci><ci id="A1.E20.m2.1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.5">𝑏</ci><apply id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E20.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="A1.E20.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E20.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A1.E20.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.2">ℎ</ci><apply id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3"><minus id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.2">𝑟</ci><cn id="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="A1.E20.m2.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E20.m2.1c">\displaystyle=\sigma(W_{r}[emb(i_{r}),h_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="A1.E20.m2.1d">= italic_σ ( italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_h start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="A1.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{h_{r}}" class="ltx_Math" display="inline" id="A1.E21.m1.1"><semantics id="A1.E21.m1.1a"><mover accent="true" id="A1.E21.m1.1.1" xref="A1.E21.m1.1.1.cmml"><msub id="A1.E21.m1.1.1.2" xref="A1.E21.m1.1.1.2.cmml"><mi id="A1.E21.m1.1.1.2.2" xref="A1.E21.m1.1.1.2.2.cmml">h</mi><mi id="A1.E21.m1.1.1.2.3" xref="A1.E21.m1.1.1.2.3.cmml">r</mi></msub><mo id="A1.E21.m1.1.1.1" xref="A1.E21.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.E21.m1.1b"><apply id="A1.E21.m1.1.1.cmml" xref="A1.E21.m1.1.1"><ci id="A1.E21.m1.1.1.1.cmml" xref="A1.E21.m1.1.1.1">~</ci><apply id="A1.E21.m1.1.1.2.cmml" xref="A1.E21.m1.1.1.2"><csymbol cd="ambiguous" id="A1.E21.m1.1.1.2.1.cmml" xref="A1.E21.m1.1.1.2">subscript</csymbol><ci id="A1.E21.m1.1.1.2.2.cmml" xref="A1.E21.m1.1.1.2.2">ℎ</ci><ci id="A1.E21.m1.1.1.2.3.cmml" xref="A1.E21.m1.1.1.2.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E21.m1.1c">\displaystyle\tilde{h_{r}}</annotation><annotation encoding="application/x-llamapun" id="A1.E21.m1.1d">over~ start_ARG italic_h start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\tanh(W_{h}[emb(i_{r}),r_{r}\odot h_{r-1}])" class="ltx_Math" display="inline" id="A1.E21.m2.2"><semantics id="A1.E21.m2.2a"><mrow id="A1.E21.m2.2.2" xref="A1.E21.m2.2.2.cmml"><mi id="A1.E21.m2.2.2.3" xref="A1.E21.m2.2.2.3.cmml"></mi><mo id="A1.E21.m2.2.2.2" xref="A1.E21.m2.2.2.2.cmml">=</mo><mrow id="A1.E21.m2.2.2.1.1" xref="A1.E21.m2.2.2.1.2.cmml"><mi id="A1.E21.m2.1.1" xref="A1.E21.m2.1.1.cmml">tanh</mi><mo id="A1.E21.m2.2.2.1.1a" xref="A1.E21.m2.2.2.1.2.cmml">⁡</mo><mrow id="A1.E21.m2.2.2.1.1.1" xref="A1.E21.m2.2.2.1.2.cmml"><mo id="A1.E21.m2.2.2.1.1.1.2" stretchy="false" xref="A1.E21.m2.2.2.1.2.cmml">(</mo><mrow id="A1.E21.m2.2.2.1.1.1.1" xref="A1.E21.m2.2.2.1.1.1.1.cmml"><msub id="A1.E21.m2.2.2.1.1.1.1.4" xref="A1.E21.m2.2.2.1.1.1.1.4.cmml"><mi id="A1.E21.m2.2.2.1.1.1.1.4.2" xref="A1.E21.m2.2.2.1.1.1.1.4.2.cmml">W</mi><mi id="A1.E21.m2.2.2.1.1.1.1.4.3" xref="A1.E21.m2.2.2.1.1.1.1.4.3.cmml">h</mi></msub><mo id="A1.E21.m2.2.2.1.1.1.1.3" xref="A1.E21.m2.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.E21.m2.2.2.1.1.1.1.2.2" xref="A1.E21.m2.2.2.1.1.1.1.2.3.cmml"><mo id="A1.E21.m2.2.2.1.1.1.1.2.2.3" stretchy="false" xref="A1.E21.m2.2.2.1.1.1.1.2.3.cmml">[</mo><mrow id="A1.E21.m2.2.2.1.1.1.1.1.1.1" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="A1.E21.m2.2.2.1.1.1.1.1.1.1.3" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="A1.E21.m2.2.2.1.1.1.1.1.1.1.2" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E21.m2.2.2.1.1.1.1.1.1.1.4" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.4.cmml">m</mi><mo id="A1.E21.m2.2.2.1.1.1.1.1.1.1.2a" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E21.m2.2.2.1.1.1.1.1.1.1.5" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.5.cmml">b</mi><mo id="A1.E21.m2.2.2.1.1.1.1.1.1.1.2b" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mi id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E21.m2.2.2.1.1.1.1.2.2.4" xref="A1.E21.m2.2.2.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.E21.m2.2.2.1.1.1.1.2.2.2" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.cmml"><msub id="A1.E21.m2.2.2.1.1.1.1.2.2.2.2" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.2" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.2.cmml">r</mi><mi id="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.3" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.3.cmml">r</mi></msub><mo id="A1.E21.m2.2.2.1.1.1.1.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.1.cmml">⊙</mo><msub id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.cmml"><mi id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.2" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.2.cmml">h</mi><mrow id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.cmml"><mi id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.2" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml">r</mi><mo id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.1" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.3" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.E21.m2.2.2.1.1.1.1.2.2.5" stretchy="false" xref="A1.E21.m2.2.2.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="A1.E21.m2.2.2.1.1.1.3" stretchy="false" xref="A1.E21.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E21.m2.2b"><apply id="A1.E21.m2.2.2.cmml" xref="A1.E21.m2.2.2"><eq id="A1.E21.m2.2.2.2.cmml" xref="A1.E21.m2.2.2.2"></eq><csymbol cd="latexml" id="A1.E21.m2.2.2.3.cmml" xref="A1.E21.m2.2.2.3">absent</csymbol><apply id="A1.E21.m2.2.2.1.2.cmml" xref="A1.E21.m2.2.2.1.1"><tanh id="A1.E21.m2.1.1.cmml" xref="A1.E21.m2.1.1"></tanh><apply id="A1.E21.m2.2.2.1.1.1.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1"><times id="A1.E21.m2.2.2.1.1.1.1.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.3"></times><apply id="A1.E21.m2.2.2.1.1.1.1.4.cmml" xref="A1.E21.m2.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E21.m2.2.2.1.1.1.1.4.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.4">subscript</csymbol><ci id="A1.E21.m2.2.2.1.1.1.1.4.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.4.2">𝑊</ci><ci id="A1.E21.m2.2.2.1.1.1.1.4.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.4.3">ℎ</ci></apply><interval closure="closed" id="A1.E21.m2.2.2.1.1.1.1.2.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2"><apply id="A1.E21.m2.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1"><times id="A1.E21.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.2"></times><ci id="A1.E21.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.3">𝑒</ci><ci id="A1.E21.m2.2.2.1.1.1.1.1.1.1.4.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.4">𝑚</ci><ci id="A1.E21.m2.2.2.1.1.1.1.1.1.1.5.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.5">𝑏</ci><apply id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="A1.E21.m2.2.2.1.1.1.1.2.2.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2"><csymbol cd="latexml" id="A1.E21.m2.2.2.1.1.1.1.2.2.2.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.1">direct-product</csymbol><apply id="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.2">𝑟</ci><ci id="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.2.3">𝑟</ci></apply><apply id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.2">ℎ</ci><apply id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3"><minus id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.1"></minus><ci id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.2">𝑟</ci><cn id="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="A1.E21.m2.2.2.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E21.m2.2c">\displaystyle=\tanh(W_{h}[emb(i_{r}),r_{r}\odot h_{r-1}])</annotation><annotation encoding="application/x-llamapun" id="A1.E21.m2.2d">= roman_tanh ( italic_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT [ italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) , italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ italic_h start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
<tbody id="A1.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h_{r}" class="ltx_Math" display="inline" id="A1.E22.m1.1"><semantics id="A1.E22.m1.1a"><msub id="A1.E22.m1.1.1" xref="A1.E22.m1.1.1.cmml"><mi id="A1.E22.m1.1.1.2" xref="A1.E22.m1.1.1.2.cmml">h</mi><mi id="A1.E22.m1.1.1.3" xref="A1.E22.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.E22.m1.1b"><apply id="A1.E22.m1.1.1.cmml" xref="A1.E22.m1.1.1"><csymbol cd="ambiguous" id="A1.E22.m1.1.1.1.cmml" xref="A1.E22.m1.1.1">subscript</csymbol><ci id="A1.E22.m1.1.1.2.cmml" xref="A1.E22.m1.1.1.2">ℎ</ci><ci id="A1.E22.m1.1.1.3.cmml" xref="A1.E22.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E22.m1.1c">\displaystyle h_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E22.m1.1d">italic_h start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(1-z_{r})\odot h_{r-1}+z_{r}\odot\tilde{h_{r}}" class="ltx_Math" display="inline" id="A1.E22.m2.1"><semantics id="A1.E22.m2.1a"><mrow id="A1.E22.m2.1.1" xref="A1.E22.m2.1.1.cmml"><mi id="A1.E22.m2.1.1.3" xref="A1.E22.m2.1.1.3.cmml"></mi><mo id="A1.E22.m2.1.1.2" xref="A1.E22.m2.1.1.2.cmml">=</mo><mrow id="A1.E22.m2.1.1.1" xref="A1.E22.m2.1.1.1.cmml"><mrow id="A1.E22.m2.1.1.1.1" xref="A1.E22.m2.1.1.1.1.cmml"><mrow id="A1.E22.m2.1.1.1.1.1.1" xref="A1.E22.m2.1.1.1.1.1.1.1.cmml"><mo id="A1.E22.m2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E22.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E22.m2.1.1.1.1.1.1.1" xref="A1.E22.m2.1.1.1.1.1.1.1.cmml"><mn id="A1.E22.m2.1.1.1.1.1.1.1.2" xref="A1.E22.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E22.m2.1.1.1.1.1.1.1.1" xref="A1.E22.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A1.E22.m2.1.1.1.1.1.1.1.3" xref="A1.E22.m2.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E22.m2.1.1.1.1.1.1.1.3.2" xref="A1.E22.m2.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi id="A1.E22.m2.1.1.1.1.1.1.1.3.3" xref="A1.E22.m2.1.1.1.1.1.1.1.3.3.cmml">r</mi></msub></mrow><mo id="A1.E22.m2.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E22.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E22.m2.1.1.1.1.2" rspace="0.222em" xref="A1.E22.m2.1.1.1.1.2.cmml">⊙</mo><msub id="A1.E22.m2.1.1.1.1.3" xref="A1.E22.m2.1.1.1.1.3.cmml"><mi id="A1.E22.m2.1.1.1.1.3.2" xref="A1.E22.m2.1.1.1.1.3.2.cmml">h</mi><mrow id="A1.E22.m2.1.1.1.1.3.3" xref="A1.E22.m2.1.1.1.1.3.3.cmml"><mi id="A1.E22.m2.1.1.1.1.3.3.2" xref="A1.E22.m2.1.1.1.1.3.3.2.cmml">r</mi><mo id="A1.E22.m2.1.1.1.1.3.3.1" xref="A1.E22.m2.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.E22.m2.1.1.1.1.3.3.3" xref="A1.E22.m2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="A1.E22.m2.1.1.1.2" xref="A1.E22.m2.1.1.1.2.cmml">+</mo><mrow id="A1.E22.m2.1.1.1.3" xref="A1.E22.m2.1.1.1.3.cmml"><msub id="A1.E22.m2.1.1.1.3.2" xref="A1.E22.m2.1.1.1.3.2.cmml"><mi id="A1.E22.m2.1.1.1.3.2.2" xref="A1.E22.m2.1.1.1.3.2.2.cmml">z</mi><mi id="A1.E22.m2.1.1.1.3.2.3" xref="A1.E22.m2.1.1.1.3.2.3.cmml">r</mi></msub><mo id="A1.E22.m2.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E22.m2.1.1.1.3.1.cmml">⊙</mo><mover accent="true" id="A1.E22.m2.1.1.1.3.3" xref="A1.E22.m2.1.1.1.3.3.cmml"><msub id="A1.E22.m2.1.1.1.3.3.2" xref="A1.E22.m2.1.1.1.3.3.2.cmml"><mi id="A1.E22.m2.1.1.1.3.3.2.2" xref="A1.E22.m2.1.1.1.3.3.2.2.cmml">h</mi><mi id="A1.E22.m2.1.1.1.3.3.2.3" xref="A1.E22.m2.1.1.1.3.3.2.3.cmml">r</mi></msub><mo id="A1.E22.m2.1.1.1.3.3.1" xref="A1.E22.m2.1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E22.m2.1b"><apply id="A1.E22.m2.1.1.cmml" xref="A1.E22.m2.1.1"><eq id="A1.E22.m2.1.1.2.cmml" xref="A1.E22.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.E22.m2.1.1.3.cmml" xref="A1.E22.m2.1.1.3">absent</csymbol><apply id="A1.E22.m2.1.1.1.cmml" xref="A1.E22.m2.1.1.1"><plus id="A1.E22.m2.1.1.1.2.cmml" xref="A1.E22.m2.1.1.1.2"></plus><apply id="A1.E22.m2.1.1.1.1.cmml" xref="A1.E22.m2.1.1.1.1"><csymbol cd="latexml" id="A1.E22.m2.1.1.1.1.2.cmml" xref="A1.E22.m2.1.1.1.1.2">direct-product</csymbol><apply id="A1.E22.m2.1.1.1.1.1.1.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1"><minus id="A1.E22.m2.1.1.1.1.1.1.1.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.1"></minus><cn id="A1.E22.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E22.m2.1.1.1.1.1.1.1.2">1</cn><apply id="A1.E22.m2.1.1.1.1.1.1.1.3.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E22.m2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E22.m2.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="A1.E22.m2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E22.m2.1.1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><apply id="A1.E22.m2.1.1.1.1.3.cmml" xref="A1.E22.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E22.m2.1.1.1.1.3.1.cmml" xref="A1.E22.m2.1.1.1.1.3">subscript</csymbol><ci id="A1.E22.m2.1.1.1.1.3.2.cmml" xref="A1.E22.m2.1.1.1.1.3.2">ℎ</ci><apply id="A1.E22.m2.1.1.1.1.3.3.cmml" xref="A1.E22.m2.1.1.1.1.3.3"><minus id="A1.E22.m2.1.1.1.1.3.3.1.cmml" xref="A1.E22.m2.1.1.1.1.3.3.1"></minus><ci id="A1.E22.m2.1.1.1.1.3.3.2.cmml" xref="A1.E22.m2.1.1.1.1.3.3.2">𝑟</ci><cn id="A1.E22.m2.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E22.m2.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A1.E22.m2.1.1.1.3.cmml" xref="A1.E22.m2.1.1.1.3"><csymbol cd="latexml" id="A1.E22.m2.1.1.1.3.1.cmml" xref="A1.E22.m2.1.1.1.3.1">direct-product</csymbol><apply id="A1.E22.m2.1.1.1.3.2.cmml" xref="A1.E22.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E22.m2.1.1.1.3.2.1.cmml" xref="A1.E22.m2.1.1.1.3.2">subscript</csymbol><ci id="A1.E22.m2.1.1.1.3.2.2.cmml" xref="A1.E22.m2.1.1.1.3.2.2">𝑧</ci><ci id="A1.E22.m2.1.1.1.3.2.3.cmml" xref="A1.E22.m2.1.1.1.3.2.3">𝑟</ci></apply><apply id="A1.E22.m2.1.1.1.3.3.cmml" xref="A1.E22.m2.1.1.1.3.3"><ci id="A1.E22.m2.1.1.1.3.3.1.cmml" xref="A1.E22.m2.1.1.1.3.3.1">~</ci><apply id="A1.E22.m2.1.1.1.3.3.2.cmml" xref="A1.E22.m2.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A1.E22.m2.1.1.1.3.3.2.1.cmml" xref="A1.E22.m2.1.1.1.3.3.2">subscript</csymbol><ci id="A1.E22.m2.1.1.1.3.3.2.2.cmml" xref="A1.E22.m2.1.1.1.3.3.2.2">ℎ</ci><ci id="A1.E22.m2.1.1.1.3.3.2.3.cmml" xref="A1.E22.m2.1.1.1.3.3.2.3">𝑟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E22.m2.1c">\displaystyle=(1-z_{r})\odot h_{r-1}+z_{r}\odot\tilde{h_{r}}</annotation><annotation encoding="application/x-llamapun" id="A1.E22.m2.1d">= ( 1 - italic_z start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ⊙ italic_h start_POSTSUBSCRIPT italic_r - 1 end_POSTSUBSCRIPT + italic_z start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⊙ over~ start_ARG italic_h start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.SSS1.p3">
<p class="ltx_p" id="A1.SS1.SSS1.p3.4">where <math alttext="W_{z},W_{r},W_{h}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p3.1.m1.3"><semantics id="A1.SS1.SSS1.p3.1.m1.3a"><mrow id="A1.SS1.SSS1.p3.1.m1.3.3.3" xref="A1.SS1.SSS1.p3.1.m1.3.3.4.cmml"><msub id="A1.SS1.SSS1.p3.1.m1.1.1.1.1" xref="A1.SS1.SSS1.p3.1.m1.1.1.1.1.cmml"><mi id="A1.SS1.SSS1.p3.1.m1.1.1.1.1.2" xref="A1.SS1.SSS1.p3.1.m1.1.1.1.1.2.cmml">W</mi><mi id="A1.SS1.SSS1.p3.1.m1.1.1.1.1.3" xref="A1.SS1.SSS1.p3.1.m1.1.1.1.1.3.cmml">z</mi></msub><mo id="A1.SS1.SSS1.p3.1.m1.3.3.3.4" xref="A1.SS1.SSS1.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS1.p3.1.m1.2.2.2.2" xref="A1.SS1.SSS1.p3.1.m1.2.2.2.2.cmml"><mi id="A1.SS1.SSS1.p3.1.m1.2.2.2.2.2" xref="A1.SS1.SSS1.p3.1.m1.2.2.2.2.2.cmml">W</mi><mi id="A1.SS1.SSS1.p3.1.m1.2.2.2.2.3" xref="A1.SS1.SSS1.p3.1.m1.2.2.2.2.3.cmml">r</mi></msub><mo id="A1.SS1.SSS1.p3.1.m1.3.3.3.5" xref="A1.SS1.SSS1.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS1.p3.1.m1.3.3.3.3" xref="A1.SS1.SSS1.p3.1.m1.3.3.3.3.cmml"><mi id="A1.SS1.SSS1.p3.1.m1.3.3.3.3.2" xref="A1.SS1.SSS1.p3.1.m1.3.3.3.3.2.cmml">W</mi><mi id="A1.SS1.SSS1.p3.1.m1.3.3.3.3.3" xref="A1.SS1.SSS1.p3.1.m1.3.3.3.3.3.cmml">h</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p3.1.m1.3b"><list id="A1.SS1.SSS1.p3.1.m1.3.3.4.cmml" xref="A1.SS1.SSS1.p3.1.m1.3.3.3"><apply id="A1.SS1.SSS1.p3.1.m1.1.1.1.1.cmml" xref="A1.SS1.SSS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.SSS1.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS1.p3.1.m1.1.1.1.1.2.cmml" xref="A1.SS1.SSS1.p3.1.m1.1.1.1.1.2">𝑊</ci><ci id="A1.SS1.SSS1.p3.1.m1.1.1.1.1.3.cmml" xref="A1.SS1.SSS1.p3.1.m1.1.1.1.1.3">𝑧</ci></apply><apply id="A1.SS1.SSS1.p3.1.m1.2.2.2.2.cmml" xref="A1.SS1.SSS1.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.1.m1.2.2.2.2.1.cmml" xref="A1.SS1.SSS1.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS1.p3.1.m1.2.2.2.2.2.cmml" xref="A1.SS1.SSS1.p3.1.m1.2.2.2.2.2">𝑊</ci><ci id="A1.SS1.SSS1.p3.1.m1.2.2.2.2.3.cmml" xref="A1.SS1.SSS1.p3.1.m1.2.2.2.2.3">𝑟</ci></apply><apply id="A1.SS1.SSS1.p3.1.m1.3.3.3.3.cmml" xref="A1.SS1.SSS1.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.1.m1.3.3.3.3.1.cmml" xref="A1.SS1.SSS1.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="A1.SS1.SSS1.p3.1.m1.3.3.3.3.2.cmml" xref="A1.SS1.SSS1.p3.1.m1.3.3.3.3.2">𝑊</ci><ci id="A1.SS1.SSS1.p3.1.m1.3.3.3.3.3.cmml" xref="A1.SS1.SSS1.p3.1.m1.3.3.3.3.3">ℎ</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p3.1.m1.3c">W_{z},W_{r},W_{h}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p3.1.m1.3d">italic_W start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="emb(i_{r})" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p3.2.m2.1"><semantics id="A1.SS1.SSS1.p3.2.m2.1a"><mrow id="A1.SS1.SSS1.p3.2.m2.1.1" xref="A1.SS1.SSS1.p3.2.m2.1.1.cmml"><mi id="A1.SS1.SSS1.p3.2.m2.1.1.3" xref="A1.SS1.SSS1.p3.2.m2.1.1.3.cmml">e</mi><mo id="A1.SS1.SSS1.p3.2.m2.1.1.2" xref="A1.SS1.SSS1.p3.2.m2.1.1.2.cmml">⁢</mo><mi id="A1.SS1.SSS1.p3.2.m2.1.1.4" xref="A1.SS1.SSS1.p3.2.m2.1.1.4.cmml">m</mi><mo id="A1.SS1.SSS1.p3.2.m2.1.1.2a" xref="A1.SS1.SSS1.p3.2.m2.1.1.2.cmml">⁢</mo><mi id="A1.SS1.SSS1.p3.2.m2.1.1.5" xref="A1.SS1.SSS1.p3.2.m2.1.1.5.cmml">b</mi><mo id="A1.SS1.SSS1.p3.2.m2.1.1.2b" xref="A1.SS1.SSS1.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.SSS1.p3.2.m2.1.1.1.1" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.cmml"><mo id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.cmml">(</mo><msub id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.2" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.cmml">i</mi><mi id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.3" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.cmml">r</mi></msub><mo id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p3.2.m2.1b"><apply id="A1.SS1.SSS1.p3.2.m2.1.1.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1"><times id="A1.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.2"></times><ci id="A1.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.3">𝑒</ci><ci id="A1.SS1.SSS1.p3.2.m2.1.1.4.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.4">𝑚</ci><ci id="A1.SS1.SSS1.p3.2.m2.1.1.5.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.5">𝑏</ci><apply id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.2">𝑖</ci><ci id="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS1.p3.2.m2.1.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p3.2.m2.1c">emb(i_{r})</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p3.2.m2.1d">italic_e italic_m italic_b ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT )</annotation></semantics></math> are learnable parameters. After this GRU session encoder, a raw available session <math alttext="I_{S}=\{i_{1},i_{2},\cdots,i_{t}\}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p3.3.m3.4"><semantics id="A1.SS1.SSS1.p3.3.m3.4a"><mrow id="A1.SS1.SSS1.p3.3.m3.4.4" xref="A1.SS1.SSS1.p3.3.m3.4.4.cmml"><msub id="A1.SS1.SSS1.p3.3.m3.4.4.5" xref="A1.SS1.SSS1.p3.3.m3.4.4.5.cmml"><mi id="A1.SS1.SSS1.p3.3.m3.4.4.5.2" xref="A1.SS1.SSS1.p3.3.m3.4.4.5.2.cmml">I</mi><mi id="A1.SS1.SSS1.p3.3.m3.4.4.5.3" xref="A1.SS1.SSS1.p3.3.m3.4.4.5.3.cmml">S</mi></msub><mo id="A1.SS1.SSS1.p3.3.m3.4.4.4" xref="A1.SS1.SSS1.p3.3.m3.4.4.4.cmml">=</mo><mrow id="A1.SS1.SSS1.p3.3.m3.4.4.3.3" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.4.cmml"><mo id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.4" stretchy="false" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.4.cmml">{</mo><msub id="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1" xref="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.cmml"><mi id="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.2" xref="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.2.cmml">i</mi><mn id="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.3" xref="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.5" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.4.cmml">,</mo><msub id="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2" xref="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.cmml"><mi id="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.2" xref="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.2.cmml">i</mi><mn id="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.3" xref="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.6" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.4.cmml">,</mo><mi id="A1.SS1.SSS1.p3.3.m3.1.1" mathvariant="normal" xref="A1.SS1.SSS1.p3.3.m3.1.1.cmml">⋯</mi><mo id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.7" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.4.cmml">,</mo><msub id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.cmml"><mi id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.2" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.2.cmml">i</mi><mi id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.3" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.3.cmml">t</mi></msub><mo id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.8" stretchy="false" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p3.3.m3.4b"><apply id="A1.SS1.SSS1.p3.3.m3.4.4.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4"><eq id="A1.SS1.SSS1.p3.3.m3.4.4.4.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.4"></eq><apply id="A1.SS1.SSS1.p3.3.m3.4.4.5.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.5"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.3.m3.4.4.5.1.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.5">subscript</csymbol><ci id="A1.SS1.SSS1.p3.3.m3.4.4.5.2.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.5.2">𝐼</ci><ci id="A1.SS1.SSS1.p3.3.m3.4.4.5.3.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.5.3">𝑆</ci></apply><set id="A1.SS1.SSS1.p3.3.m3.4.4.3.4.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3"><apply id="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.cmml" xref="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.1.cmml" xref="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.2.cmml" xref="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.2">𝑖</ci><cn id="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="A1.SS1.SSS1.p3.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.cmml" xref="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.1.cmml" xref="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.2.cmml" xref="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.2">𝑖</ci><cn id="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="A1.SS1.SSS1.p3.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="A1.SS1.SSS1.p3.3.m3.1.1.cmml" xref="A1.SS1.SSS1.p3.3.m3.1.1">⋯</ci><apply id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.1.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3">subscript</csymbol><ci id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.2.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.2">𝑖</ci><ci id="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.3.cmml" xref="A1.SS1.SSS1.p3.3.m3.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p3.3.m3.4c">I_{S}=\{i_{1},i_{2},\cdots,i_{t}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p3.3.m3.4d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = { italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math> is encoded into <math alttext="\{h_{1},h_{2},\cdots,h_{t}\}" class="ltx_Math" display="inline" id="A1.SS1.SSS1.p3.4.m4.4"><semantics id="A1.SS1.SSS1.p3.4.m4.4a"><mrow id="A1.SS1.SSS1.p3.4.m4.4.4.3" xref="A1.SS1.SSS1.p3.4.m4.4.4.4.cmml"><mo id="A1.SS1.SSS1.p3.4.m4.4.4.3.4" stretchy="false" xref="A1.SS1.SSS1.p3.4.m4.4.4.4.cmml">{</mo><msub id="A1.SS1.SSS1.p3.4.m4.2.2.1.1" xref="A1.SS1.SSS1.p3.4.m4.2.2.1.1.cmml"><mi id="A1.SS1.SSS1.p3.4.m4.2.2.1.1.2" xref="A1.SS1.SSS1.p3.4.m4.2.2.1.1.2.cmml">h</mi><mn id="A1.SS1.SSS1.p3.4.m4.2.2.1.1.3" xref="A1.SS1.SSS1.p3.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="A1.SS1.SSS1.p3.4.m4.4.4.3.5" xref="A1.SS1.SSS1.p3.4.m4.4.4.4.cmml">,</mo><msub id="A1.SS1.SSS1.p3.4.m4.3.3.2.2" xref="A1.SS1.SSS1.p3.4.m4.3.3.2.2.cmml"><mi id="A1.SS1.SSS1.p3.4.m4.3.3.2.2.2" xref="A1.SS1.SSS1.p3.4.m4.3.3.2.2.2.cmml">h</mi><mn id="A1.SS1.SSS1.p3.4.m4.3.3.2.2.3" xref="A1.SS1.SSS1.p3.4.m4.3.3.2.2.3.cmml">2</mn></msub><mo id="A1.SS1.SSS1.p3.4.m4.4.4.3.6" xref="A1.SS1.SSS1.p3.4.m4.4.4.4.cmml">,</mo><mi id="A1.SS1.SSS1.p3.4.m4.1.1" mathvariant="normal" xref="A1.SS1.SSS1.p3.4.m4.1.1.cmml">⋯</mi><mo id="A1.SS1.SSS1.p3.4.m4.4.4.3.7" xref="A1.SS1.SSS1.p3.4.m4.4.4.4.cmml">,</mo><msub id="A1.SS1.SSS1.p3.4.m4.4.4.3.3" xref="A1.SS1.SSS1.p3.4.m4.4.4.3.3.cmml"><mi id="A1.SS1.SSS1.p3.4.m4.4.4.3.3.2" xref="A1.SS1.SSS1.p3.4.m4.4.4.3.3.2.cmml">h</mi><mi id="A1.SS1.SSS1.p3.4.m4.4.4.3.3.3" xref="A1.SS1.SSS1.p3.4.m4.4.4.3.3.3.cmml">t</mi></msub><mo id="A1.SS1.SSS1.p3.4.m4.4.4.3.8" stretchy="false" xref="A1.SS1.SSS1.p3.4.m4.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS1.p3.4.m4.4b"><set id="A1.SS1.SSS1.p3.4.m4.4.4.4.cmml" xref="A1.SS1.SSS1.p3.4.m4.4.4.3"><apply id="A1.SS1.SSS1.p3.4.m4.2.2.1.1.cmml" xref="A1.SS1.SSS1.p3.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.4.m4.2.2.1.1.1.cmml" xref="A1.SS1.SSS1.p3.4.m4.2.2.1.1">subscript</csymbol><ci id="A1.SS1.SSS1.p3.4.m4.2.2.1.1.2.cmml" xref="A1.SS1.SSS1.p3.4.m4.2.2.1.1.2">ℎ</ci><cn id="A1.SS1.SSS1.p3.4.m4.2.2.1.1.3.cmml" type="integer" xref="A1.SS1.SSS1.p3.4.m4.2.2.1.1.3">1</cn></apply><apply id="A1.SS1.SSS1.p3.4.m4.3.3.2.2.cmml" xref="A1.SS1.SSS1.p3.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.4.m4.3.3.2.2.1.cmml" xref="A1.SS1.SSS1.p3.4.m4.3.3.2.2">subscript</csymbol><ci id="A1.SS1.SSS1.p3.4.m4.3.3.2.2.2.cmml" xref="A1.SS1.SSS1.p3.4.m4.3.3.2.2.2">ℎ</ci><cn id="A1.SS1.SSS1.p3.4.m4.3.3.2.2.3.cmml" type="integer" xref="A1.SS1.SSS1.p3.4.m4.3.3.2.2.3">2</cn></apply><ci id="A1.SS1.SSS1.p3.4.m4.1.1.cmml" xref="A1.SS1.SSS1.p3.4.m4.1.1">⋯</ci><apply id="A1.SS1.SSS1.p3.4.m4.4.4.3.3.cmml" xref="A1.SS1.SSS1.p3.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS1.p3.4.m4.4.4.3.3.1.cmml" xref="A1.SS1.SSS1.p3.4.m4.4.4.3.3">subscript</csymbol><ci id="A1.SS1.SSS1.p3.4.m4.4.4.3.3.2.cmml" xref="A1.SS1.SSS1.p3.4.m4.4.4.3.3.2">ℎ</ci><ci id="A1.SS1.SSS1.p3.4.m4.4.4.3.3.3.cmml" xref="A1.SS1.SSS1.p3.4.m4.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS1.p3.4.m4.4c">\{h_{1},h_{2},\cdots,h_{t}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS1.p3.4.m4.4d">{ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.2 </span>Repeat-or-explore mechanism</h4>
<div class="ltx_para" id="A1.SS1.SSS2.p1">
<p class="ltx_p" id="A1.SS1.SSS2.p1.2">The next problem is to produce a binary probability of repeat mode and explore mode. To that end, they adopt the attention technique using the last hidden state <math alttext="h_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.1.m1.1"><semantics id="A1.SS1.SSS2.p1.1.m1.1a"><msub id="A1.SS1.SSS2.p1.1.m1.1.1" xref="A1.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="A1.SS1.SSS2.p1.1.m1.1.1.2" xref="A1.SS1.SSS2.p1.1.m1.1.1.2.cmml">h</mi><mi id="A1.SS1.SSS2.p1.1.m1.1.1.3" xref="A1.SS1.SSS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.1.m1.1b"><apply id="A1.SS1.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1.2">ℎ</ci><ci id="A1.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="A1.SS1.SSS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.1.m1.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with each individual hidden state <math alttext="h_{r}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p1.2.m2.1"><semantics id="A1.SS1.SSS2.p1.2.m2.1a"><msub id="A1.SS1.SSS2.p1.2.m2.1.1" xref="A1.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="A1.SS1.SSS2.p1.2.m2.1.1.2" xref="A1.SS1.SSS2.p1.2.m2.1.1.2.cmml">h</mi><mi id="A1.SS1.SSS2.p1.2.m2.1.1.3" xref="A1.SS1.SSS2.p1.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p1.2.m2.1b"><apply id="A1.SS1.SSS2.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1.2">ℎ</ci><ci id="A1.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="A1.SS1.SSS2.p1.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p1.2.m2.1c">h_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p1.2.m2.1d">italic_h start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>. Mathematically, it is</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS2.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx10">
<tbody id="A1.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e^{re}_{r}" class="ltx_Math" display="inline" id="A1.E23.m1.1"><semantics id="A1.E23.m1.1a"><msubsup id="A1.E23.m1.1.1" xref="A1.E23.m1.1.1.cmml"><mi id="A1.E23.m1.1.1.2.2" xref="A1.E23.m1.1.1.2.2.cmml">e</mi><mi id="A1.E23.m1.1.1.3" xref="A1.E23.m1.1.1.3.cmml">r</mi><mrow id="A1.E23.m1.1.1.2.3" xref="A1.E23.m1.1.1.2.3.cmml"><mi id="A1.E23.m1.1.1.2.3.2" xref="A1.E23.m1.1.1.2.3.2.cmml">r</mi><mo id="A1.E23.m1.1.1.2.3.1" xref="A1.E23.m1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E23.m1.1.1.2.3.3" xref="A1.E23.m1.1.1.2.3.3.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.E23.m1.1b"><apply id="A1.E23.m1.1.1.cmml" xref="A1.E23.m1.1.1"><csymbol cd="ambiguous" id="A1.E23.m1.1.1.1.cmml" xref="A1.E23.m1.1.1">subscript</csymbol><apply id="A1.E23.m1.1.1.2.cmml" xref="A1.E23.m1.1.1"><csymbol cd="ambiguous" id="A1.E23.m1.1.1.2.1.cmml" xref="A1.E23.m1.1.1">superscript</csymbol><ci id="A1.E23.m1.1.1.2.2.cmml" xref="A1.E23.m1.1.1.2.2">𝑒</ci><apply id="A1.E23.m1.1.1.2.3.cmml" xref="A1.E23.m1.1.1.2.3"><times id="A1.E23.m1.1.1.2.3.1.cmml" xref="A1.E23.m1.1.1.2.3.1"></times><ci id="A1.E23.m1.1.1.2.3.2.cmml" xref="A1.E23.m1.1.1.2.3.2">𝑟</ci><ci id="A1.E23.m1.1.1.2.3.3.cmml" xref="A1.E23.m1.1.1.2.3.3">𝑒</ci></apply></apply><ci id="A1.E23.m1.1.1.3.cmml" xref="A1.E23.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E23.m1.1c">\displaystyle e^{re}_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E23.m1.1d">italic_e start_POSTSUPERSCRIPT italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=v_{re}\tanh(W_{re}h_{t}+U_{re}h_{r})" class="ltx_Math" display="inline" id="A1.E23.m2.2"><semantics id="A1.E23.m2.2a"><mrow id="A1.E23.m2.2.2" xref="A1.E23.m2.2.2.cmml"><mi id="A1.E23.m2.2.2.3" xref="A1.E23.m2.2.2.3.cmml"></mi><mo id="A1.E23.m2.2.2.2" xref="A1.E23.m2.2.2.2.cmml">=</mo><mrow id="A1.E23.m2.2.2.1" xref="A1.E23.m2.2.2.1.cmml"><msub id="A1.E23.m2.2.2.1.3" xref="A1.E23.m2.2.2.1.3.cmml"><mi id="A1.E23.m2.2.2.1.3.2" xref="A1.E23.m2.2.2.1.3.2.cmml">v</mi><mrow id="A1.E23.m2.2.2.1.3.3" xref="A1.E23.m2.2.2.1.3.3.cmml"><mi id="A1.E23.m2.2.2.1.3.3.2" xref="A1.E23.m2.2.2.1.3.3.2.cmml">r</mi><mo id="A1.E23.m2.2.2.1.3.3.1" xref="A1.E23.m2.2.2.1.3.3.1.cmml">⁢</mo><mi id="A1.E23.m2.2.2.1.3.3.3" xref="A1.E23.m2.2.2.1.3.3.3.cmml">e</mi></mrow></msub><mo id="A1.E23.m2.2.2.1.2" lspace="0.167em" xref="A1.E23.m2.2.2.1.2.cmml">⁢</mo><mrow id="A1.E23.m2.2.2.1.1.1" xref="A1.E23.m2.2.2.1.1.2.cmml"><mi id="A1.E23.m2.1.1" xref="A1.E23.m2.1.1.cmml">tanh</mi><mo id="A1.E23.m2.2.2.1.1.1a" xref="A1.E23.m2.2.2.1.1.2.cmml">⁡</mo><mrow id="A1.E23.m2.2.2.1.1.1.1" xref="A1.E23.m2.2.2.1.1.2.cmml"><mo id="A1.E23.m2.2.2.1.1.1.1.2" stretchy="false" xref="A1.E23.m2.2.2.1.1.2.cmml">(</mo><mrow id="A1.E23.m2.2.2.1.1.1.1.1" xref="A1.E23.m2.2.2.1.1.1.1.1.cmml"><mrow id="A1.E23.m2.2.2.1.1.1.1.1.2" xref="A1.E23.m2.2.2.1.1.1.1.1.2.cmml"><msub id="A1.E23.m2.2.2.1.1.1.1.1.2.2" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.cmml"><mi id="A1.E23.m2.2.2.1.1.1.1.1.2.2.2" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.2.cmml">W</mi><mrow id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.2" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.2.cmml">r</mi><mo id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.1" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.3" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.3.cmml">e</mi></mrow></msub><mo id="A1.E23.m2.2.2.1.1.1.1.1.2.1" xref="A1.E23.m2.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.E23.m2.2.2.1.1.1.1.1.2.3" xref="A1.E23.m2.2.2.1.1.1.1.1.2.3.cmml"><mi id="A1.E23.m2.2.2.1.1.1.1.1.2.3.2" xref="A1.E23.m2.2.2.1.1.1.1.1.2.3.2.cmml">h</mi><mi id="A1.E23.m2.2.2.1.1.1.1.1.2.3.3" xref="A1.E23.m2.2.2.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="A1.E23.m2.2.2.1.1.1.1.1.1" xref="A1.E23.m2.2.2.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E23.m2.2.2.1.1.1.1.1.3" xref="A1.E23.m2.2.2.1.1.1.1.1.3.cmml"><msub id="A1.E23.m2.2.2.1.1.1.1.1.3.2" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.cmml"><mi id="A1.E23.m2.2.2.1.1.1.1.1.3.2.2" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.2.cmml">U</mi><mrow id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.2" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.2.cmml">r</mi><mo id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.1" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.3" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.3.cmml">e</mi></mrow></msub><mo id="A1.E23.m2.2.2.1.1.1.1.1.3.1" xref="A1.E23.m2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.E23.m2.2.2.1.1.1.1.1.3.3" xref="A1.E23.m2.2.2.1.1.1.1.1.3.3.cmml"><mi id="A1.E23.m2.2.2.1.1.1.1.1.3.3.2" xref="A1.E23.m2.2.2.1.1.1.1.1.3.3.2.cmml">h</mi><mi id="A1.E23.m2.2.2.1.1.1.1.1.3.3.3" xref="A1.E23.m2.2.2.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow></mrow><mo id="A1.E23.m2.2.2.1.1.1.1.3" stretchy="false" xref="A1.E23.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E23.m2.2b"><apply id="A1.E23.m2.2.2.cmml" xref="A1.E23.m2.2.2"><eq id="A1.E23.m2.2.2.2.cmml" xref="A1.E23.m2.2.2.2"></eq><csymbol cd="latexml" id="A1.E23.m2.2.2.3.cmml" xref="A1.E23.m2.2.2.3">absent</csymbol><apply id="A1.E23.m2.2.2.1.cmml" xref="A1.E23.m2.2.2.1"><times id="A1.E23.m2.2.2.1.2.cmml" xref="A1.E23.m2.2.2.1.2"></times><apply id="A1.E23.m2.2.2.1.3.cmml" xref="A1.E23.m2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E23.m2.2.2.1.3.1.cmml" xref="A1.E23.m2.2.2.1.3">subscript</csymbol><ci id="A1.E23.m2.2.2.1.3.2.cmml" xref="A1.E23.m2.2.2.1.3.2">𝑣</ci><apply id="A1.E23.m2.2.2.1.3.3.cmml" xref="A1.E23.m2.2.2.1.3.3"><times id="A1.E23.m2.2.2.1.3.3.1.cmml" xref="A1.E23.m2.2.2.1.3.3.1"></times><ci id="A1.E23.m2.2.2.1.3.3.2.cmml" xref="A1.E23.m2.2.2.1.3.3.2">𝑟</ci><ci id="A1.E23.m2.2.2.1.3.3.3.cmml" xref="A1.E23.m2.2.2.1.3.3.3">𝑒</ci></apply></apply><apply id="A1.E23.m2.2.2.1.1.2.cmml" xref="A1.E23.m2.2.2.1.1.1"><tanh id="A1.E23.m2.1.1.cmml" xref="A1.E23.m2.1.1"></tanh><apply id="A1.E23.m2.2.2.1.1.1.1.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1"><plus id="A1.E23.m2.2.2.1.1.1.1.1.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.1"></plus><apply id="A1.E23.m2.2.2.1.1.1.1.1.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2"><times id="A1.E23.m2.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.1"></times><apply id="A1.E23.m2.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E23.m2.2.2.1.1.1.1.1.2.2.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E23.m2.2.2.1.1.1.1.1.2.2.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.2">𝑊</ci><apply id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3"><times id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.1"></times><ci id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.2">𝑟</ci><ci id="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.2.3.3">𝑒</ci></apply></apply><apply id="A1.E23.m2.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E23.m2.2.2.1.1.1.1.1.2.3.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E23.m2.2.2.1.1.1.1.1.2.3.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.3.2">ℎ</ci><ci id="A1.E23.m2.2.2.1.1.1.1.1.2.3.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="A1.E23.m2.2.2.1.1.1.1.1.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3"><times id="A1.E23.m2.2.2.1.1.1.1.1.3.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.1"></times><apply id="A1.E23.m2.2.2.1.1.1.1.1.3.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E23.m2.2.2.1.1.1.1.1.3.2.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E23.m2.2.2.1.1.1.1.1.3.2.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.2">𝑈</ci><apply id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3"><times id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.1"></times><ci id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.2">𝑟</ci><ci id="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="A1.E23.m2.2.2.1.1.1.1.1.3.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E23.m2.2.2.1.1.1.1.1.3.3.1.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E23.m2.2.2.1.1.1.1.1.3.3.2.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.3.2">ℎ</ci><ci id="A1.E23.m2.2.2.1.1.1.1.1.3.3.3.cmml" xref="A1.E23.m2.2.2.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E23.m2.2c">\displaystyle=v_{re}\tanh(W_{re}h_{t}+U_{re}h_{r})</annotation><annotation encoding="application/x-llamapun" id="A1.E23.m2.2d">= italic_v start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT roman_tanh ( italic_W start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_U start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
<tbody id="A1.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha^{re}_{r}" class="ltx_Math" display="inline" id="A1.E24.m1.1"><semantics id="A1.E24.m1.1a"><msubsup id="A1.E24.m1.1.1" xref="A1.E24.m1.1.1.cmml"><mi id="A1.E24.m1.1.1.2.2" xref="A1.E24.m1.1.1.2.2.cmml">α</mi><mi id="A1.E24.m1.1.1.3" xref="A1.E24.m1.1.1.3.cmml">r</mi><mrow id="A1.E24.m1.1.1.2.3" xref="A1.E24.m1.1.1.2.3.cmml"><mi id="A1.E24.m1.1.1.2.3.2" xref="A1.E24.m1.1.1.2.3.2.cmml">r</mi><mo id="A1.E24.m1.1.1.2.3.1" xref="A1.E24.m1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E24.m1.1.1.2.3.3" xref="A1.E24.m1.1.1.2.3.3.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.E24.m1.1b"><apply id="A1.E24.m1.1.1.cmml" xref="A1.E24.m1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.cmml" xref="A1.E24.m1.1.1">subscript</csymbol><apply id="A1.E24.m1.1.1.2.cmml" xref="A1.E24.m1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.2.1.cmml" xref="A1.E24.m1.1.1">superscript</csymbol><ci id="A1.E24.m1.1.1.2.2.cmml" xref="A1.E24.m1.1.1.2.2">𝛼</ci><apply id="A1.E24.m1.1.1.2.3.cmml" xref="A1.E24.m1.1.1.2.3"><times id="A1.E24.m1.1.1.2.3.1.cmml" xref="A1.E24.m1.1.1.2.3.1"></times><ci id="A1.E24.m1.1.1.2.3.2.cmml" xref="A1.E24.m1.1.1.2.3.2">𝑟</ci><ci id="A1.E24.m1.1.1.2.3.3.cmml" xref="A1.E24.m1.1.1.2.3.3">𝑒</ci></apply></apply><ci id="A1.E24.m1.1.1.3.cmml" xref="A1.E24.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E24.m1.1c">\displaystyle\alpha^{re}_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E24.m1.1d">italic_α start_POSTSUPERSCRIPT italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\exp(e^{re}_{r})}{\sum_{i}\exp(e^{re}_{i})}" class="ltx_Math" display="inline" id="A1.E24.m2.4"><semantics id="A1.E24.m2.4a"><mrow id="A1.E24.m2.4.5" xref="A1.E24.m2.4.5.cmml"><mi id="A1.E24.m2.4.5.2" xref="A1.E24.m2.4.5.2.cmml"></mi><mo id="A1.E24.m2.4.5.1" xref="A1.E24.m2.4.5.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E24.m2.4.4" xref="A1.E24.m2.4.4.cmml"><mfrac id="A1.E24.m2.4.4a" xref="A1.E24.m2.4.4.cmml"><mrow id="A1.E24.m2.2.2.2.2" xref="A1.E24.m2.2.2.2.3.cmml"><mi id="A1.E24.m2.1.1.1.1" xref="A1.E24.m2.1.1.1.1.cmml">exp</mi><mo id="A1.E24.m2.2.2.2.2a" xref="A1.E24.m2.2.2.2.3.cmml">⁡</mo><mrow id="A1.E24.m2.2.2.2.2.1" xref="A1.E24.m2.2.2.2.3.cmml"><mo id="A1.E24.m2.2.2.2.2.1.2" stretchy="false" xref="A1.E24.m2.2.2.2.3.cmml">(</mo><msubsup id="A1.E24.m2.2.2.2.2.1.1" xref="A1.E24.m2.2.2.2.2.1.1.cmml"><mi id="A1.E24.m2.2.2.2.2.1.1.2.2" xref="A1.E24.m2.2.2.2.2.1.1.2.2.cmml">e</mi><mi id="A1.E24.m2.2.2.2.2.1.1.3" xref="A1.E24.m2.2.2.2.2.1.1.3.cmml">r</mi><mrow id="A1.E24.m2.2.2.2.2.1.1.2.3" xref="A1.E24.m2.2.2.2.2.1.1.2.3.cmml"><mi id="A1.E24.m2.2.2.2.2.1.1.2.3.2" xref="A1.E24.m2.2.2.2.2.1.1.2.3.2.cmml">r</mi><mo id="A1.E24.m2.2.2.2.2.1.1.2.3.1" xref="A1.E24.m2.2.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E24.m2.2.2.2.2.1.1.2.3.3" xref="A1.E24.m2.2.2.2.2.1.1.2.3.3.cmml">e</mi></mrow></msubsup><mo id="A1.E24.m2.2.2.2.2.1.3" stretchy="false" xref="A1.E24.m2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E24.m2.4.4.4" xref="A1.E24.m2.4.4.4.cmml"><msub id="A1.E24.m2.4.4.4.3" xref="A1.E24.m2.4.4.4.3.cmml"><mo id="A1.E24.m2.4.4.4.3.2" xref="A1.E24.m2.4.4.4.3.2.cmml">∑</mo><mi id="A1.E24.m2.4.4.4.3.3" xref="A1.E24.m2.4.4.4.3.3.cmml">i</mi></msub><mrow id="A1.E24.m2.4.4.4.2.1" xref="A1.E24.m2.4.4.4.2.2.cmml"><mi id="A1.E24.m2.3.3.3.1" xref="A1.E24.m2.3.3.3.1.cmml">exp</mi><mo id="A1.E24.m2.4.4.4.2.1a" xref="A1.E24.m2.4.4.4.2.2.cmml">⁡</mo><mrow id="A1.E24.m2.4.4.4.2.1.1" xref="A1.E24.m2.4.4.4.2.2.cmml"><mo id="A1.E24.m2.4.4.4.2.1.1.2" stretchy="false" xref="A1.E24.m2.4.4.4.2.2.cmml">(</mo><msubsup id="A1.E24.m2.4.4.4.2.1.1.1" xref="A1.E24.m2.4.4.4.2.1.1.1.cmml"><mi id="A1.E24.m2.4.4.4.2.1.1.1.2.2" xref="A1.E24.m2.4.4.4.2.1.1.1.2.2.cmml">e</mi><mi id="A1.E24.m2.4.4.4.2.1.1.1.3" xref="A1.E24.m2.4.4.4.2.1.1.1.3.cmml">i</mi><mrow id="A1.E24.m2.4.4.4.2.1.1.1.2.3" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3.cmml"><mi id="A1.E24.m2.4.4.4.2.1.1.1.2.3.2" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3.2.cmml">r</mi><mo id="A1.E24.m2.4.4.4.2.1.1.1.2.3.1" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E24.m2.4.4.4.2.1.1.1.2.3.3" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3.3.cmml">e</mi></mrow></msubsup><mo id="A1.E24.m2.4.4.4.2.1.1.3" stretchy="false" xref="A1.E24.m2.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E24.m2.4b"><apply id="A1.E24.m2.4.5.cmml" xref="A1.E24.m2.4.5"><eq id="A1.E24.m2.4.5.1.cmml" xref="A1.E24.m2.4.5.1"></eq><csymbol cd="latexml" id="A1.E24.m2.4.5.2.cmml" xref="A1.E24.m2.4.5.2">absent</csymbol><apply id="A1.E24.m2.4.4.cmml" xref="A1.E24.m2.4.4"><divide id="A1.E24.m2.4.4.5.cmml" xref="A1.E24.m2.4.4"></divide><apply id="A1.E24.m2.2.2.2.3.cmml" xref="A1.E24.m2.2.2.2.2"><exp id="A1.E24.m2.1.1.1.1.cmml" xref="A1.E24.m2.1.1.1.1"></exp><apply id="A1.E24.m2.2.2.2.2.1.1.cmml" xref="A1.E24.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E24.m2.2.2.2.2.1.1.1.cmml" xref="A1.E24.m2.2.2.2.2.1.1">subscript</csymbol><apply id="A1.E24.m2.2.2.2.2.1.1.2.cmml" xref="A1.E24.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E24.m2.2.2.2.2.1.1.2.1.cmml" xref="A1.E24.m2.2.2.2.2.1.1">superscript</csymbol><ci id="A1.E24.m2.2.2.2.2.1.1.2.2.cmml" xref="A1.E24.m2.2.2.2.2.1.1.2.2">𝑒</ci><apply id="A1.E24.m2.2.2.2.2.1.1.2.3.cmml" xref="A1.E24.m2.2.2.2.2.1.1.2.3"><times id="A1.E24.m2.2.2.2.2.1.1.2.3.1.cmml" xref="A1.E24.m2.2.2.2.2.1.1.2.3.1"></times><ci id="A1.E24.m2.2.2.2.2.1.1.2.3.2.cmml" xref="A1.E24.m2.2.2.2.2.1.1.2.3.2">𝑟</ci><ci id="A1.E24.m2.2.2.2.2.1.1.2.3.3.cmml" xref="A1.E24.m2.2.2.2.2.1.1.2.3.3">𝑒</ci></apply></apply><ci id="A1.E24.m2.2.2.2.2.1.1.3.cmml" xref="A1.E24.m2.2.2.2.2.1.1.3">𝑟</ci></apply></apply><apply id="A1.E24.m2.4.4.4.cmml" xref="A1.E24.m2.4.4.4"><apply id="A1.E24.m2.4.4.4.3.cmml" xref="A1.E24.m2.4.4.4.3"><csymbol cd="ambiguous" id="A1.E24.m2.4.4.4.3.1.cmml" xref="A1.E24.m2.4.4.4.3">subscript</csymbol><sum id="A1.E24.m2.4.4.4.3.2.cmml" xref="A1.E24.m2.4.4.4.3.2"></sum><ci id="A1.E24.m2.4.4.4.3.3.cmml" xref="A1.E24.m2.4.4.4.3.3">𝑖</ci></apply><apply id="A1.E24.m2.4.4.4.2.2.cmml" xref="A1.E24.m2.4.4.4.2.1"><exp id="A1.E24.m2.3.3.3.1.cmml" xref="A1.E24.m2.3.3.3.1"></exp><apply id="A1.E24.m2.4.4.4.2.1.1.1.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m2.4.4.4.2.1.1.1.1.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1">subscript</csymbol><apply id="A1.E24.m2.4.4.4.2.1.1.1.2.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m2.4.4.4.2.1.1.1.2.1.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1">superscript</csymbol><ci id="A1.E24.m2.4.4.4.2.1.1.1.2.2.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1.2.2">𝑒</ci><apply id="A1.E24.m2.4.4.4.2.1.1.1.2.3.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3"><times id="A1.E24.m2.4.4.4.2.1.1.1.2.3.1.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3.1"></times><ci id="A1.E24.m2.4.4.4.2.1.1.1.2.3.2.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3.2">𝑟</ci><ci id="A1.E24.m2.4.4.4.2.1.1.1.2.3.3.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1.2.3.3">𝑒</ci></apply></apply><ci id="A1.E24.m2.4.4.4.2.1.1.1.3.cmml" xref="A1.E24.m2.4.4.4.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E24.m2.4c">\displaystyle=\frac{\exp(e^{re}_{r})}{\sum_{i}\exp(e^{re}_{i})}</annotation><annotation encoding="application/x-llamapun" id="A1.E24.m2.4d">= divide start_ARG roman_exp ( italic_e start_POSTSUPERSCRIPT italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( italic_e start_POSTSUPERSCRIPT italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
<tbody id="A1.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle c_{\text{session}}" class="ltx_Math" display="inline" id="A1.E25.m1.1"><semantics id="A1.E25.m1.1a"><msub id="A1.E25.m1.1.1" xref="A1.E25.m1.1.1.cmml"><mi id="A1.E25.m1.1.1.2" xref="A1.E25.m1.1.1.2.cmml">c</mi><mtext id="A1.E25.m1.1.1.3" xref="A1.E25.m1.1.1.3a.cmml">session</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.E25.m1.1b"><apply id="A1.E25.m1.1.1.cmml" xref="A1.E25.m1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.1.1.1.cmml" xref="A1.E25.m1.1.1">subscript</csymbol><ci id="A1.E25.m1.1.1.2.cmml" xref="A1.E25.m1.1.1.2">𝑐</ci><ci id="A1.E25.m1.1.1.3a.cmml" xref="A1.E25.m1.1.1.3"><mtext id="A1.E25.m1.1.1.3.cmml" mathsize="70%" xref="A1.E25.m1.1.1.3">session</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E25.m1.1c">\displaystyle c_{\text{session}}</annotation><annotation encoding="application/x-llamapun" id="A1.E25.m1.1d">italic_c start_POSTSUBSCRIPT session end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i}\alpha^{re}_{i}h_{i}" class="ltx_Math" display="inline" id="A1.E25.m2.1"><semantics id="A1.E25.m2.1a"><mrow id="A1.E25.m2.1.1" xref="A1.E25.m2.1.1.cmml"><mi id="A1.E25.m2.1.1.2" xref="A1.E25.m2.1.1.2.cmml"></mi><mo id="A1.E25.m2.1.1.1" xref="A1.E25.m2.1.1.1.cmml">=</mo><mrow id="A1.E25.m2.1.1.3" xref="A1.E25.m2.1.1.3.cmml"><mstyle displaystyle="true" id="A1.E25.m2.1.1.3.1" xref="A1.E25.m2.1.1.3.1.cmml"><munder id="A1.E25.m2.1.1.3.1a" xref="A1.E25.m2.1.1.3.1.cmml"><mo id="A1.E25.m2.1.1.3.1.2" movablelimits="false" xref="A1.E25.m2.1.1.3.1.2.cmml">∑</mo><mi id="A1.E25.m2.1.1.3.1.3" xref="A1.E25.m2.1.1.3.1.3.cmml">i</mi></munder></mstyle><mrow id="A1.E25.m2.1.1.3.2" xref="A1.E25.m2.1.1.3.2.cmml"><msubsup id="A1.E25.m2.1.1.3.2.2" xref="A1.E25.m2.1.1.3.2.2.cmml"><mi id="A1.E25.m2.1.1.3.2.2.2.2" xref="A1.E25.m2.1.1.3.2.2.2.2.cmml">α</mi><mi id="A1.E25.m2.1.1.3.2.2.3" xref="A1.E25.m2.1.1.3.2.2.3.cmml">i</mi><mrow id="A1.E25.m2.1.1.3.2.2.2.3" xref="A1.E25.m2.1.1.3.2.2.2.3.cmml"><mi id="A1.E25.m2.1.1.3.2.2.2.3.2" xref="A1.E25.m2.1.1.3.2.2.2.3.2.cmml">r</mi><mo id="A1.E25.m2.1.1.3.2.2.2.3.1" xref="A1.E25.m2.1.1.3.2.2.2.3.1.cmml">⁢</mo><mi id="A1.E25.m2.1.1.3.2.2.2.3.3" xref="A1.E25.m2.1.1.3.2.2.2.3.3.cmml">e</mi></mrow></msubsup><mo id="A1.E25.m2.1.1.3.2.1" xref="A1.E25.m2.1.1.3.2.1.cmml">⁢</mo><msub id="A1.E25.m2.1.1.3.2.3" xref="A1.E25.m2.1.1.3.2.3.cmml"><mi id="A1.E25.m2.1.1.3.2.3.2" xref="A1.E25.m2.1.1.3.2.3.2.cmml">h</mi><mi id="A1.E25.m2.1.1.3.2.3.3" xref="A1.E25.m2.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E25.m2.1b"><apply id="A1.E25.m2.1.1.cmml" xref="A1.E25.m2.1.1"><eq id="A1.E25.m2.1.1.1.cmml" xref="A1.E25.m2.1.1.1"></eq><csymbol cd="latexml" id="A1.E25.m2.1.1.2.cmml" xref="A1.E25.m2.1.1.2">absent</csymbol><apply id="A1.E25.m2.1.1.3.cmml" xref="A1.E25.m2.1.1.3"><apply id="A1.E25.m2.1.1.3.1.cmml" xref="A1.E25.m2.1.1.3.1"><csymbol cd="ambiguous" id="A1.E25.m2.1.1.3.1.1.cmml" xref="A1.E25.m2.1.1.3.1">subscript</csymbol><sum id="A1.E25.m2.1.1.3.1.2.cmml" xref="A1.E25.m2.1.1.3.1.2"></sum><ci id="A1.E25.m2.1.1.3.1.3.cmml" xref="A1.E25.m2.1.1.3.1.3">𝑖</ci></apply><apply id="A1.E25.m2.1.1.3.2.cmml" xref="A1.E25.m2.1.1.3.2"><times id="A1.E25.m2.1.1.3.2.1.cmml" xref="A1.E25.m2.1.1.3.2.1"></times><apply id="A1.E25.m2.1.1.3.2.2.cmml" xref="A1.E25.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E25.m2.1.1.3.2.2.1.cmml" xref="A1.E25.m2.1.1.3.2.2">subscript</csymbol><apply id="A1.E25.m2.1.1.3.2.2.2.cmml" xref="A1.E25.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E25.m2.1.1.3.2.2.2.1.cmml" xref="A1.E25.m2.1.1.3.2.2">superscript</csymbol><ci id="A1.E25.m2.1.1.3.2.2.2.2.cmml" xref="A1.E25.m2.1.1.3.2.2.2.2">𝛼</ci><apply id="A1.E25.m2.1.1.3.2.2.2.3.cmml" xref="A1.E25.m2.1.1.3.2.2.2.3"><times id="A1.E25.m2.1.1.3.2.2.2.3.1.cmml" xref="A1.E25.m2.1.1.3.2.2.2.3.1"></times><ci id="A1.E25.m2.1.1.3.2.2.2.3.2.cmml" xref="A1.E25.m2.1.1.3.2.2.2.3.2">𝑟</ci><ci id="A1.E25.m2.1.1.3.2.2.2.3.3.cmml" xref="A1.E25.m2.1.1.3.2.2.2.3.3">𝑒</ci></apply></apply><ci id="A1.E25.m2.1.1.3.2.2.3.cmml" xref="A1.E25.m2.1.1.3.2.2.3">𝑖</ci></apply><apply id="A1.E25.m2.1.1.3.2.3.cmml" xref="A1.E25.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E25.m2.1.1.3.2.3.1.cmml" xref="A1.E25.m2.1.1.3.2.3">subscript</csymbol><ci id="A1.E25.m2.1.1.3.2.3.2.cmml" xref="A1.E25.m2.1.1.3.2.3.2">ℎ</ci><ci id="A1.E25.m2.1.1.3.2.3.3.cmml" xref="A1.E25.m2.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E25.m2.1c">\displaystyle=\sum_{i}\alpha^{re}_{i}h_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.E25.m2.1d">= ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT italic_r italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.SSS2.p3">
<p class="ltx_p" id="A1.SS1.SSS2.p3.2">where <math alttext="v_{re},W_{re},U_{re}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.1.m1.3"><semantics id="A1.SS1.SSS2.p3.1.m1.3a"><mrow id="A1.SS1.SSS2.p3.1.m1.3.3.3" xref="A1.SS1.SSS2.p3.1.m1.3.3.4.cmml"><msub id="A1.SS1.SSS2.p3.1.m1.1.1.1.1" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.cmml"><mi id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.2" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.2.cmml">v</mi><mrow id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.cmml"><mi id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.2" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.2.cmml">r</mi><mo id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.1" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.3" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.3.cmml">e</mi></mrow></msub><mo id="A1.SS1.SSS2.p3.1.m1.3.3.3.4" xref="A1.SS1.SSS2.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS2.p3.1.m1.2.2.2.2" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.cmml"><mi id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.2" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.2.cmml">W</mi><mrow id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.cmml"><mi id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.2" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.2.cmml">r</mi><mo id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.1" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.3" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.3.cmml">e</mi></mrow></msub><mo id="A1.SS1.SSS2.p3.1.m1.3.3.3.5" xref="A1.SS1.SSS2.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS2.p3.1.m1.3.3.3.3" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.cmml"><mi id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.2" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.2.cmml">U</mi><mrow id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.cmml"><mi id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.2" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.2.cmml">r</mi><mo id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.1" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.1.cmml">⁢</mo><mi id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.3" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.3.cmml">e</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.1.m1.3b"><list id="A1.SS1.SSS2.p3.1.m1.3.3.4.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3"><apply id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.2">𝑣</ci><apply id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3"><times id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.1"></times><ci id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.2">𝑟</ci><ci id="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.1.1.1.1.3.3">𝑒</ci></apply></apply><apply id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.2">𝑊</ci><apply id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3"><times id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.1"></times><ci id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.2">𝑟</ci><ci id="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.2.2.2.2.3.3">𝑒</ci></apply></apply><apply id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.2">𝑈</ci><apply id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3"><times id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.1.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.1"></times><ci id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.2.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.2">𝑟</ci><ci id="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.3.cmml" xref="A1.SS1.SSS2.p3.1.m1.3.3.3.3.3.3">𝑒</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.1.m1.3c">v_{re},W_{re},U_{re}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.1.m1.3d">italic_v start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_r italic_e end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters and <math alttext="c_{\text{session}}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p3.2.m2.1"><semantics id="A1.SS1.SSS2.p3.2.m2.1a"><msub id="A1.SS1.SSS2.p3.2.m2.1.1" xref="A1.SS1.SSS2.p3.2.m2.1.1.cmml"><mi id="A1.SS1.SSS2.p3.2.m2.1.1.2" xref="A1.SS1.SSS2.p3.2.m2.1.1.2.cmml">c</mi><mtext id="A1.SS1.SSS2.p3.2.m2.1.1.3" xref="A1.SS1.SSS2.p3.2.m2.1.1.3a.cmml">session</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p3.2.m2.1b"><apply id="A1.SS1.SSS2.p3.2.m2.1.1.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p3.2.m2.1.1.1.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p3.2.m2.1.1.2.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1.2">𝑐</ci><ci id="A1.SS1.SSS2.p3.2.m2.1.1.3a.cmml" xref="A1.SS1.SSS2.p3.2.m2.1.1.3"><mtext id="A1.SS1.SSS2.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p3.2.m2.1.1.3">session</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p3.2.m2.1c">c_{\text{session}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p3.2.m2.1d">italic_c start_POSTSUBSCRIPT session end_POSTSUBSCRIPT</annotation></semantics></math> is the final repeat-or-explore attention vector they attain. The final step is to transform this attention vector is a binary probability through</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS2.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx11">
<tbody id="A1.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle[\mathbf{P}(r|I_{S}),\mathbf{P}(e|I_{s})]=\text{softmax}(W_{\text%
{T}}c_{\text{session}})" class="ltx_Math" display="inline" id="A1.E26.m1.3"><semantics id="A1.E26.m1.3a"><mrow id="A1.E26.m1.3.3" xref="A1.E26.m1.3.3.cmml"><mrow id="A1.E26.m1.2.2.2.2" xref="A1.E26.m1.2.2.2.3.cmml"><mo id="A1.E26.m1.2.2.2.2.3" stretchy="false" xref="A1.E26.m1.2.2.2.3.cmml">[</mo><mrow id="A1.E26.m1.1.1.1.1.1" xref="A1.E26.m1.1.1.1.1.1.cmml"><mi id="A1.E26.m1.1.1.1.1.1.3" xref="A1.E26.m1.1.1.1.1.1.3.cmml">𝐏</mi><mo id="A1.E26.m1.1.1.1.1.1.2" xref="A1.E26.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E26.m1.1.1.1.1.1.1.1" xref="A1.E26.m1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E26.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E26.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E26.m1.1.1.1.1.1.1.1.1" xref="A1.E26.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E26.m1.1.1.1.1.1.1.1.1.2" xref="A1.E26.m1.1.1.1.1.1.1.1.1.2.cmml">r</mi><mo fence="false" id="A1.E26.m1.1.1.1.1.1.1.1.1.1" xref="A1.E26.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A1.E26.m1.1.1.1.1.1.1.1.1.3" xref="A1.E26.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E26.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E26.m1.1.1.1.1.1.1.1.1.3.2.cmml">I</mi><mi id="A1.E26.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E26.m1.1.1.1.1.1.1.1.1.3.3.cmml">S</mi></msub></mrow><mo id="A1.E26.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E26.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E26.m1.2.2.2.2.4" xref="A1.E26.m1.2.2.2.3.cmml">,</mo><mrow id="A1.E26.m1.2.2.2.2.2" xref="A1.E26.m1.2.2.2.2.2.cmml"><mi id="A1.E26.m1.2.2.2.2.2.3" xref="A1.E26.m1.2.2.2.2.2.3.cmml">𝐏</mi><mo id="A1.E26.m1.2.2.2.2.2.2" xref="A1.E26.m1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="A1.E26.m1.2.2.2.2.2.1.1" xref="A1.E26.m1.2.2.2.2.2.1.1.1.cmml"><mo id="A1.E26.m1.2.2.2.2.2.1.1.2" stretchy="false" xref="A1.E26.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.E26.m1.2.2.2.2.2.1.1.1" xref="A1.E26.m1.2.2.2.2.2.1.1.1.cmml"><mi id="A1.E26.m1.2.2.2.2.2.1.1.1.2" xref="A1.E26.m1.2.2.2.2.2.1.1.1.2.cmml">e</mi><mo fence="false" id="A1.E26.m1.2.2.2.2.2.1.1.1.1" xref="A1.E26.m1.2.2.2.2.2.1.1.1.1.cmml">|</mo><msub id="A1.E26.m1.2.2.2.2.2.1.1.1.3" xref="A1.E26.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="A1.E26.m1.2.2.2.2.2.1.1.1.3.2" xref="A1.E26.m1.2.2.2.2.2.1.1.1.3.2.cmml">I</mi><mi id="A1.E26.m1.2.2.2.2.2.1.1.1.3.3" xref="A1.E26.m1.2.2.2.2.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="A1.E26.m1.2.2.2.2.2.1.1.3" stretchy="false" xref="A1.E26.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E26.m1.2.2.2.2.5" stretchy="false" xref="A1.E26.m1.2.2.2.3.cmml">]</mo></mrow><mo id="A1.E26.m1.3.3.4" xref="A1.E26.m1.3.3.4.cmml">=</mo><mrow id="A1.E26.m1.3.3.3" xref="A1.E26.m1.3.3.3.cmml"><mtext id="A1.E26.m1.3.3.3.3" xref="A1.E26.m1.3.3.3.3a.cmml">softmax</mtext><mo id="A1.E26.m1.3.3.3.2" xref="A1.E26.m1.3.3.3.2.cmml">⁢</mo><mrow id="A1.E26.m1.3.3.3.1.1" xref="A1.E26.m1.3.3.3.1.1.1.cmml"><mo id="A1.E26.m1.3.3.3.1.1.2" stretchy="false" xref="A1.E26.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="A1.E26.m1.3.3.3.1.1.1" xref="A1.E26.m1.3.3.3.1.1.1.cmml"><msub id="A1.E26.m1.3.3.3.1.1.1.2" xref="A1.E26.m1.3.3.3.1.1.1.2.cmml"><mi id="A1.E26.m1.3.3.3.1.1.1.2.2" xref="A1.E26.m1.3.3.3.1.1.1.2.2.cmml">W</mi><mtext id="A1.E26.m1.3.3.3.1.1.1.2.3" xref="A1.E26.m1.3.3.3.1.1.1.2.3a.cmml">T</mtext></msub><mo id="A1.E26.m1.3.3.3.1.1.1.1" xref="A1.E26.m1.3.3.3.1.1.1.1.cmml">⁢</mo><msub id="A1.E26.m1.3.3.3.1.1.1.3" xref="A1.E26.m1.3.3.3.1.1.1.3.cmml"><mi id="A1.E26.m1.3.3.3.1.1.1.3.2" xref="A1.E26.m1.3.3.3.1.1.1.3.2.cmml">c</mi><mtext id="A1.E26.m1.3.3.3.1.1.1.3.3" xref="A1.E26.m1.3.3.3.1.1.1.3.3a.cmml">session</mtext></msub></mrow><mo id="A1.E26.m1.3.3.3.1.1.3" stretchy="false" xref="A1.E26.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E26.m1.3b"><apply id="A1.E26.m1.3.3.cmml" xref="A1.E26.m1.3.3"><eq id="A1.E26.m1.3.3.4.cmml" xref="A1.E26.m1.3.3.4"></eq><interval closure="closed" id="A1.E26.m1.2.2.2.3.cmml" xref="A1.E26.m1.2.2.2.2"><apply id="A1.E26.m1.1.1.1.1.1.cmml" xref="A1.E26.m1.1.1.1.1.1"><times id="A1.E26.m1.1.1.1.1.1.2.cmml" xref="A1.E26.m1.1.1.1.1.1.2"></times><ci id="A1.E26.m1.1.1.1.1.1.3.cmml" xref="A1.E26.m1.1.1.1.1.1.3">𝐏</ci><apply id="A1.E26.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E26.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E26.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A1.E26.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E26.m1.1.1.1.1.1.1.1.1.2">𝑟</ci><apply id="A1.E26.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E26.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E26.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E26.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E26.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E26.m1.1.1.1.1.1.1.1.1.3.2">𝐼</ci><ci id="A1.E26.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E26.m1.1.1.1.1.1.1.1.1.3.3">𝑆</ci></apply></apply></apply><apply id="A1.E26.m1.2.2.2.2.2.cmml" xref="A1.E26.m1.2.2.2.2.2"><times id="A1.E26.m1.2.2.2.2.2.2.cmml" xref="A1.E26.m1.2.2.2.2.2.2"></times><ci id="A1.E26.m1.2.2.2.2.2.3.cmml" xref="A1.E26.m1.2.2.2.2.2.3">𝐏</ci><apply id="A1.E26.m1.2.2.2.2.2.1.1.1.cmml" xref="A1.E26.m1.2.2.2.2.2.1.1"><csymbol cd="latexml" id="A1.E26.m1.2.2.2.2.2.1.1.1.1.cmml" xref="A1.E26.m1.2.2.2.2.2.1.1.1.1">conditional</csymbol><ci id="A1.E26.m1.2.2.2.2.2.1.1.1.2.cmml" xref="A1.E26.m1.2.2.2.2.2.1.1.1.2">𝑒</ci><apply id="A1.E26.m1.2.2.2.2.2.1.1.1.3.cmml" xref="A1.E26.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E26.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="A1.E26.m1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="A1.E26.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="A1.E26.m1.2.2.2.2.2.1.1.1.3.2">𝐼</ci><ci id="A1.E26.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="A1.E26.m1.2.2.2.2.2.1.1.1.3.3">𝑠</ci></apply></apply></apply></interval><apply id="A1.E26.m1.3.3.3.cmml" xref="A1.E26.m1.3.3.3"><times id="A1.E26.m1.3.3.3.2.cmml" xref="A1.E26.m1.3.3.3.2"></times><ci id="A1.E26.m1.3.3.3.3a.cmml" xref="A1.E26.m1.3.3.3.3"><mtext id="A1.E26.m1.3.3.3.3.cmml" xref="A1.E26.m1.3.3.3.3">softmax</mtext></ci><apply id="A1.E26.m1.3.3.3.1.1.1.cmml" xref="A1.E26.m1.3.3.3.1.1"><times id="A1.E26.m1.3.3.3.1.1.1.1.cmml" xref="A1.E26.m1.3.3.3.1.1.1.1"></times><apply id="A1.E26.m1.3.3.3.1.1.1.2.cmml" xref="A1.E26.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="A1.E26.m1.3.3.3.1.1.1.2.1.cmml" xref="A1.E26.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="A1.E26.m1.3.3.3.1.1.1.2.2.cmml" xref="A1.E26.m1.3.3.3.1.1.1.2.2">𝑊</ci><ci id="A1.E26.m1.3.3.3.1.1.1.2.3a.cmml" xref="A1.E26.m1.3.3.3.1.1.1.2.3"><mtext id="A1.E26.m1.3.3.3.1.1.1.2.3.cmml" mathsize="70%" xref="A1.E26.m1.3.3.3.1.1.1.2.3">T</mtext></ci></apply><apply id="A1.E26.m1.3.3.3.1.1.1.3.cmml" xref="A1.E26.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A1.E26.m1.3.3.3.1.1.1.3.1.cmml" xref="A1.E26.m1.3.3.3.1.1.1.3">subscript</csymbol><ci id="A1.E26.m1.3.3.3.1.1.1.3.2.cmml" xref="A1.E26.m1.3.3.3.1.1.1.3.2">𝑐</ci><ci id="A1.E26.m1.3.3.3.1.1.1.3.3a.cmml" xref="A1.E26.m1.3.3.3.1.1.1.3.3"><mtext id="A1.E26.m1.3.3.3.1.1.1.3.3.cmml" mathsize="70%" xref="A1.E26.m1.3.3.3.1.1.1.3.3">session</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E26.m1.3c">\displaystyle[\mathbf{P}(r|I_{S}),\mathbf{P}(e|I_{s})]=\text{softmax}(W_{\text%
{T}}c_{\text{session}})</annotation><annotation encoding="application/x-llamapun" id="A1.E26.m1.3d">[ bold_P ( italic_r | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ) , bold_P ( italic_e | italic_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ] = softmax ( italic_W start_POSTSUBSCRIPT T end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT session end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.SSS2.p5">
<p class="ltx_p" id="A1.SS1.SSS2.p5.1">where again <math alttext="W_{\text{T}}" class="ltx_Math" display="inline" id="A1.SS1.SSS2.p5.1.m1.1"><semantics id="A1.SS1.SSS2.p5.1.m1.1a"><msub id="A1.SS1.SSS2.p5.1.m1.1.1" xref="A1.SS1.SSS2.p5.1.m1.1.1.cmml"><mi id="A1.SS1.SSS2.p5.1.m1.1.1.2" xref="A1.SS1.SSS2.p5.1.m1.1.1.2.cmml">W</mi><mtext id="A1.SS1.SSS2.p5.1.m1.1.1.3" xref="A1.SS1.SSS2.p5.1.m1.1.1.3a.cmml">T</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS2.p5.1.m1.1b"><apply id="A1.SS1.SSS2.p5.1.m1.1.1.cmml" xref="A1.SS1.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS2.p5.1.m1.1.1.1.cmml" xref="A1.SS1.SSS2.p5.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.SSS2.p5.1.m1.1.1.2.cmml" xref="A1.SS1.SSS2.p5.1.m1.1.1.2">𝑊</ci><ci id="A1.SS1.SSS2.p5.1.m1.1.1.3a.cmml" xref="A1.SS1.SSS2.p5.1.m1.1.1.3"><mtext id="A1.SS1.SSS2.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS1.SSS2.p5.1.m1.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS2.p5.1.m1.1c">W_{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS2.p5.1.m1.1d">italic_W start_POSTSUBSCRIPT T end_POSTSUBSCRIPT</annotation></semantics></math> is again a learnable matrix parameter.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.3 </span>Repeat mode decoder</h4>
<div class="ltx_para" id="A1.SS1.SSS3.p1">
<p class="ltx_p" id="A1.SS1.SSS3.p1.1">The repeat mode decoder essentially computes the probability <math alttext="\mathbf{P}(i_{t+1}|I_{S},r)" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p1.1.m1.2"><semantics id="A1.SS1.SSS3.p1.1.m1.2a"><mrow id="A1.SS1.SSS3.p1.1.m1.2.2" xref="A1.SS1.SSS3.p1.1.m1.2.2.cmml"><mi id="A1.SS1.SSS3.p1.1.m1.2.2.3" xref="A1.SS1.SSS3.p1.1.m1.2.2.3.cmml">𝐏</mi><mo id="A1.SS1.SSS3.p1.1.m1.2.2.2" xref="A1.SS1.SSS3.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="A1.SS1.SSS3.p1.1.m1.2.2.1.1" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.cmml"><mo id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.2" stretchy="false" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.cmml"><msub id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.cmml"><mi id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.2" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.2.cmml">i</mi><mrow id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.cmml"><mi id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.2" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.2.cmml">t</mi><mo id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.1" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.3" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.2" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.2.cmml"><msub id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.2" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml">I</mi><mi id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.3" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.2" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="A1.SS1.SSS3.p1.1.m1.1.1" xref="A1.SS1.SSS3.p1.1.m1.1.1.cmml">r</mi></mrow></mrow><mo id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.3" stretchy="false" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p1.1.m1.2b"><apply id="A1.SS1.SSS3.p1.1.m1.2.2.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2"><times id="A1.SS1.SSS3.p1.1.m1.2.2.2.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.2"></times><ci id="A1.SS1.SSS3.p1.1.m1.2.2.3.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.3">𝐏</ci><apply id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1"><csymbol cd="latexml" id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.2">conditional</csymbol><apply id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.2.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.2">𝑖</ci><apply id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3"><plus id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.1.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.1"></plus><ci id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.2.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.2">𝑡</ci><cn id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><list id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1"><apply id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.2">𝐼</ci><ci id="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS3.p1.1.m1.2.2.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="A1.SS1.SSS3.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS3.p1.1.m1.1.1">𝑟</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p1.1.m1.2c">\mathbf{P}(i_{t+1}|I_{S},r)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p1.1.m1.2d">bold_P ( italic_i start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_r )</annotation></semantics></math> for any action/item on condition that such an action/item has already appeared in the available session. Mathematically, it is computed using attention mechanism as follows:</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS3.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx12">
<tbody id="A1.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e^{r}_{r}" class="ltx_Math" display="inline" id="A1.E27.m1.1"><semantics id="A1.E27.m1.1a"><msubsup id="A1.E27.m1.1.1" xref="A1.E27.m1.1.1.cmml"><mi id="A1.E27.m1.1.1.2.2" xref="A1.E27.m1.1.1.2.2.cmml">e</mi><mi id="A1.E27.m1.1.1.3" xref="A1.E27.m1.1.1.3.cmml">r</mi><mi id="A1.E27.m1.1.1.2.3" xref="A1.E27.m1.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E27.m1.1b"><apply id="A1.E27.m1.1.1.cmml" xref="A1.E27.m1.1.1"><csymbol cd="ambiguous" id="A1.E27.m1.1.1.1.cmml" xref="A1.E27.m1.1.1">subscript</csymbol><apply id="A1.E27.m1.1.1.2.cmml" xref="A1.E27.m1.1.1"><csymbol cd="ambiguous" id="A1.E27.m1.1.1.2.1.cmml" xref="A1.E27.m1.1.1">superscript</csymbol><ci id="A1.E27.m1.1.1.2.2.cmml" xref="A1.E27.m1.1.1.2.2">𝑒</ci><ci id="A1.E27.m1.1.1.2.3.cmml" xref="A1.E27.m1.1.1.2.3">𝑟</ci></apply><ci id="A1.E27.m1.1.1.3.cmml" xref="A1.E27.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E27.m1.1c">\displaystyle e^{r}_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E27.m1.1d">italic_e start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=v_{r}^{T}\tanh(W_{r}h_{t}+U_{r}h_{r})" class="ltx_Math" display="inline" id="A1.E27.m2.2"><semantics id="A1.E27.m2.2a"><mrow id="A1.E27.m2.2.2" xref="A1.E27.m2.2.2.cmml"><mi id="A1.E27.m2.2.2.3" xref="A1.E27.m2.2.2.3.cmml"></mi><mo id="A1.E27.m2.2.2.2" xref="A1.E27.m2.2.2.2.cmml">=</mo><mrow id="A1.E27.m2.2.2.1" xref="A1.E27.m2.2.2.1.cmml"><msubsup id="A1.E27.m2.2.2.1.3" xref="A1.E27.m2.2.2.1.3.cmml"><mi id="A1.E27.m2.2.2.1.3.2.2" xref="A1.E27.m2.2.2.1.3.2.2.cmml">v</mi><mi id="A1.E27.m2.2.2.1.3.2.3" xref="A1.E27.m2.2.2.1.3.2.3.cmml">r</mi><mi id="A1.E27.m2.2.2.1.3.3" xref="A1.E27.m2.2.2.1.3.3.cmml">T</mi></msubsup><mo id="A1.E27.m2.2.2.1.2" lspace="0.167em" xref="A1.E27.m2.2.2.1.2.cmml">⁢</mo><mrow id="A1.E27.m2.2.2.1.1.1" xref="A1.E27.m2.2.2.1.1.2.cmml"><mi id="A1.E27.m2.1.1" xref="A1.E27.m2.1.1.cmml">tanh</mi><mo id="A1.E27.m2.2.2.1.1.1a" xref="A1.E27.m2.2.2.1.1.2.cmml">⁡</mo><mrow id="A1.E27.m2.2.2.1.1.1.1" xref="A1.E27.m2.2.2.1.1.2.cmml"><mo id="A1.E27.m2.2.2.1.1.1.1.2" stretchy="false" xref="A1.E27.m2.2.2.1.1.2.cmml">(</mo><mrow id="A1.E27.m2.2.2.1.1.1.1.1" xref="A1.E27.m2.2.2.1.1.1.1.1.cmml"><mrow id="A1.E27.m2.2.2.1.1.1.1.1.2" xref="A1.E27.m2.2.2.1.1.1.1.1.2.cmml"><msub id="A1.E27.m2.2.2.1.1.1.1.1.2.2" xref="A1.E27.m2.2.2.1.1.1.1.1.2.2.cmml"><mi id="A1.E27.m2.2.2.1.1.1.1.1.2.2.2" xref="A1.E27.m2.2.2.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="A1.E27.m2.2.2.1.1.1.1.1.2.2.3" xref="A1.E27.m2.2.2.1.1.1.1.1.2.2.3.cmml">r</mi></msub><mo id="A1.E27.m2.2.2.1.1.1.1.1.2.1" xref="A1.E27.m2.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.E27.m2.2.2.1.1.1.1.1.2.3" xref="A1.E27.m2.2.2.1.1.1.1.1.2.3.cmml"><mi id="A1.E27.m2.2.2.1.1.1.1.1.2.3.2" xref="A1.E27.m2.2.2.1.1.1.1.1.2.3.2.cmml">h</mi><mi id="A1.E27.m2.2.2.1.1.1.1.1.2.3.3" xref="A1.E27.m2.2.2.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="A1.E27.m2.2.2.1.1.1.1.1.1" xref="A1.E27.m2.2.2.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E27.m2.2.2.1.1.1.1.1.3" xref="A1.E27.m2.2.2.1.1.1.1.1.3.cmml"><msub id="A1.E27.m2.2.2.1.1.1.1.1.3.2" xref="A1.E27.m2.2.2.1.1.1.1.1.3.2.cmml"><mi id="A1.E27.m2.2.2.1.1.1.1.1.3.2.2" xref="A1.E27.m2.2.2.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="A1.E27.m2.2.2.1.1.1.1.1.3.2.3" xref="A1.E27.m2.2.2.1.1.1.1.1.3.2.3.cmml">r</mi></msub><mo id="A1.E27.m2.2.2.1.1.1.1.1.3.1" xref="A1.E27.m2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.E27.m2.2.2.1.1.1.1.1.3.3" xref="A1.E27.m2.2.2.1.1.1.1.1.3.3.cmml"><mi id="A1.E27.m2.2.2.1.1.1.1.1.3.3.2" xref="A1.E27.m2.2.2.1.1.1.1.1.3.3.2.cmml">h</mi><mi id="A1.E27.m2.2.2.1.1.1.1.1.3.3.3" xref="A1.E27.m2.2.2.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow></mrow><mo id="A1.E27.m2.2.2.1.1.1.1.3" stretchy="false" xref="A1.E27.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E27.m2.2b"><apply id="A1.E27.m2.2.2.cmml" xref="A1.E27.m2.2.2"><eq id="A1.E27.m2.2.2.2.cmml" xref="A1.E27.m2.2.2.2"></eq><csymbol cd="latexml" id="A1.E27.m2.2.2.3.cmml" xref="A1.E27.m2.2.2.3">absent</csymbol><apply id="A1.E27.m2.2.2.1.cmml" xref="A1.E27.m2.2.2.1"><times id="A1.E27.m2.2.2.1.2.cmml" xref="A1.E27.m2.2.2.1.2"></times><apply id="A1.E27.m2.2.2.1.3.cmml" xref="A1.E27.m2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E27.m2.2.2.1.3.1.cmml" xref="A1.E27.m2.2.2.1.3">superscript</csymbol><apply id="A1.E27.m2.2.2.1.3.2.cmml" xref="A1.E27.m2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E27.m2.2.2.1.3.2.1.cmml" xref="A1.E27.m2.2.2.1.3">subscript</csymbol><ci id="A1.E27.m2.2.2.1.3.2.2.cmml" xref="A1.E27.m2.2.2.1.3.2.2">𝑣</ci><ci id="A1.E27.m2.2.2.1.3.2.3.cmml" xref="A1.E27.m2.2.2.1.3.2.3">𝑟</ci></apply><ci id="A1.E27.m2.2.2.1.3.3.cmml" xref="A1.E27.m2.2.2.1.3.3">𝑇</ci></apply><apply id="A1.E27.m2.2.2.1.1.2.cmml" xref="A1.E27.m2.2.2.1.1.1"><tanh id="A1.E27.m2.1.1.cmml" xref="A1.E27.m2.1.1"></tanh><apply id="A1.E27.m2.2.2.1.1.1.1.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1"><plus id="A1.E27.m2.2.2.1.1.1.1.1.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.1"></plus><apply id="A1.E27.m2.2.2.1.1.1.1.1.2.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2"><times id="A1.E27.m2.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.1"></times><apply id="A1.E27.m2.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E27.m2.2.2.1.1.1.1.1.2.2.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E27.m2.2.2.1.1.1.1.1.2.2.2.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.2.2">𝑊</ci><ci id="A1.E27.m2.2.2.1.1.1.1.1.2.2.3.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.2.3">𝑟</ci></apply><apply id="A1.E27.m2.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E27.m2.2.2.1.1.1.1.1.2.3.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E27.m2.2.2.1.1.1.1.1.2.3.2.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.3.2">ℎ</ci><ci id="A1.E27.m2.2.2.1.1.1.1.1.2.3.3.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="A1.E27.m2.2.2.1.1.1.1.1.3.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3"><times id="A1.E27.m2.2.2.1.1.1.1.1.3.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.1"></times><apply id="A1.E27.m2.2.2.1.1.1.1.1.3.2.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E27.m2.2.2.1.1.1.1.1.3.2.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E27.m2.2.2.1.1.1.1.1.3.2.2.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.2.2">𝑈</ci><ci id="A1.E27.m2.2.2.1.1.1.1.1.3.2.3.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.2.3">𝑟</ci></apply><apply id="A1.E27.m2.2.2.1.1.1.1.1.3.3.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E27.m2.2.2.1.1.1.1.1.3.3.1.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E27.m2.2.2.1.1.1.1.1.3.3.2.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.3.2">ℎ</ci><ci id="A1.E27.m2.2.2.1.1.1.1.1.3.3.3.cmml" xref="A1.E27.m2.2.2.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E27.m2.2c">\displaystyle=v_{r}^{T}\tanh(W_{r}h_{t}+U_{r}h_{r})</annotation><annotation encoding="application/x-llamapun" id="A1.E27.m2.2d">= italic_v start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_tanh ( italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
<tbody id="A1.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{P}(i|I_{S},r)" class="ltx_Math" display="inline" id="A1.E28.m1.2"><semantics id="A1.E28.m1.2a"><mrow id="A1.E28.m1.2.2" xref="A1.E28.m1.2.2.cmml"><mi id="A1.E28.m1.2.2.3" xref="A1.E28.m1.2.2.3.cmml">𝐏</mi><mo id="A1.E28.m1.2.2.2" xref="A1.E28.m1.2.2.2.cmml">⁢</mo><mrow id="A1.E28.m1.2.2.1.1" xref="A1.E28.m1.2.2.1.1.1.cmml"><mo id="A1.E28.m1.2.2.1.1.2" stretchy="false" xref="A1.E28.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.E28.m1.2.2.1.1.1" xref="A1.E28.m1.2.2.1.1.1.cmml"><mi id="A1.E28.m1.2.2.1.1.1.3" xref="A1.E28.m1.2.2.1.1.1.3.cmml">i</mi><mo fence="false" id="A1.E28.m1.2.2.1.1.1.2" xref="A1.E28.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="A1.E28.m1.2.2.1.1.1.1.1" xref="A1.E28.m1.2.2.1.1.1.1.2.cmml"><msub id="A1.E28.m1.2.2.1.1.1.1.1.1" xref="A1.E28.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E28.m1.2.2.1.1.1.1.1.1.2" xref="A1.E28.m1.2.2.1.1.1.1.1.1.2.cmml">I</mi><mi id="A1.E28.m1.2.2.1.1.1.1.1.1.3" xref="A1.E28.m1.2.2.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="A1.E28.m1.2.2.1.1.1.1.1.2" xref="A1.E28.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="A1.E28.m1.1.1" xref="A1.E28.m1.1.1.cmml">r</mi></mrow></mrow><mo id="A1.E28.m1.2.2.1.1.3" stretchy="false" xref="A1.E28.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E28.m1.2b"><apply id="A1.E28.m1.2.2.cmml" xref="A1.E28.m1.2.2"><times id="A1.E28.m1.2.2.2.cmml" xref="A1.E28.m1.2.2.2"></times><ci id="A1.E28.m1.2.2.3.cmml" xref="A1.E28.m1.2.2.3">𝐏</ci><apply id="A1.E28.m1.2.2.1.1.1.cmml" xref="A1.E28.m1.2.2.1.1"><csymbol cd="latexml" id="A1.E28.m1.2.2.1.1.1.2.cmml" xref="A1.E28.m1.2.2.1.1.1.2">conditional</csymbol><ci id="A1.E28.m1.2.2.1.1.1.3.cmml" xref="A1.E28.m1.2.2.1.1.1.3">𝑖</ci><list id="A1.E28.m1.2.2.1.1.1.1.2.cmml" xref="A1.E28.m1.2.2.1.1.1.1.1"><apply id="A1.E28.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E28.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E28.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E28.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E28.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E28.m1.2.2.1.1.1.1.1.1.2">𝐼</ci><ci id="A1.E28.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E28.m1.2.2.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="A1.E28.m1.1.1.cmml" xref="A1.E28.m1.1.1">𝑟</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E28.m1.2c">\displaystyle\mathbf{P}(i|I_{S},r)</annotation><annotation encoding="application/x-llamapun" id="A1.E28.m1.2d">bold_P ( italic_i | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_r )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}\frac{\sum_{i}\exp(e^{r}_{i})}{\sum_{t}\exp(e^{r}_{%
t})},\text{if }i\in I_{S}\\
0,\text{if }i\notin I_{S}\end{cases}" class="ltx_Math" display="inline" id="A1.E28.m2.2"><semantics id="A1.E28.m2.2a"><mrow id="A1.E28.m2.2.3" xref="A1.E28.m2.2.3.cmml"><mi id="A1.E28.m2.2.3.2" xref="A1.E28.m2.2.3.2.cmml"></mi><mo id="A1.E28.m2.2.3.1" xref="A1.E28.m2.2.3.1.cmml">=</mo><mrow id="A1.E28.m2.2.2a" xref="A1.E28.m2.2.3.3.1.cmml"><mo id="A1.E28.m2.2.2a.3" xref="A1.E28.m2.2.3.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="A1.E28.m2.2.2.2a" rowspacing="0pt" xref="A1.E28.m2.2.3.3.1.cmml"><mtr id="A1.E28.m2.2.2.2aa" xref="A1.E28.m2.2.3.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E28.m2.2.2.2ab" xref="A1.E28.m2.2.3.3.1.cmml"><mrow id="A1.E28.m2.1.1.1.1.1.1" xref="A1.E28.m2.1.1.1.1.1.1.cmml"><mrow id="A1.E28.m2.1.1.1.1.1.1.5.1" xref="A1.E28.m2.1.1.1.1.1.1.5.2.cmml"><mfrac id="A1.E28.m2.1.1.1.1.1.1.4" xref="A1.E28.m2.1.1.1.1.1.1.4.cmml"><mrow id="A1.E28.m2.1.1.1.1.1.1.2.2" xref="A1.E28.m2.1.1.1.1.1.1.2.2.cmml"><mstyle displaystyle="false" id="A1.E28.m2.1.1.1.1.1.1.2.2.3" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3.cmml"><msub id="A1.E28.m2.1.1.1.1.1.1.2.2.3a" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3.cmml"><mo id="A1.E28.m2.1.1.1.1.1.1.2.2.3.2" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3.2.cmml">∑</mo><mi id="A1.E28.m2.1.1.1.1.1.1.2.2.3.3" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3.3.cmml">i</mi></msub></mstyle><mrow id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E28.m2.1.1.1.1.1.1.1.1.1" xref="A1.E28.m2.1.1.1.1.1.1.1.1.1.cmml">exp</mi><mo id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1a" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.2.cmml">⁡</mo><mrow id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><msubsup id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">e</mi><mi id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">i</mi><mi id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.3" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml">r</mi></msubsup><mo id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.E28.m2.1.1.1.1.1.1.4.4" xref="A1.E28.m2.1.1.1.1.1.1.4.4.cmml"><mstyle displaystyle="false" id="A1.E28.m2.1.1.1.1.1.1.4.4.3" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3.cmml"><msub id="A1.E28.m2.1.1.1.1.1.1.4.4.3a" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3.cmml"><mo id="A1.E28.m2.1.1.1.1.1.1.4.4.3.2" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3.2.cmml">∑</mo><mi id="A1.E28.m2.1.1.1.1.1.1.4.4.3.3" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3.3.cmml">t</mi></msub></mstyle><mrow id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.2.cmml"><mi id="A1.E28.m2.1.1.1.1.1.1.3.3.1" xref="A1.E28.m2.1.1.1.1.1.1.3.3.1.cmml">exp</mi><mo id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1a" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.2.cmml">⁡</mo><mrow id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.2.cmml"><mo id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.2" stretchy="false" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.2.cmml">(</mo><msubsup id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.cmml"><mi id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.2" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.2.cmml">e</mi><mi id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.3" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.3.cmml">t</mi><mi id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.3" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.3.cmml">r</mi></msubsup><mo id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.3" stretchy="false" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="A1.E28.m2.1.1.1.1.1.1.5.1.2" xref="A1.E28.m2.1.1.1.1.1.1.5.2.cmml">,</mo><mrow id="A1.E28.m2.1.1.1.1.1.1.5.1.1" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.cmml"><mtext id="A1.E28.m2.1.1.1.1.1.1.5.1.1.2" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.2a.cmml">if </mtext><mo id="A1.E28.m2.1.1.1.1.1.1.5.1.1.1" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.1.cmml">⁢</mo><mi id="A1.E28.m2.1.1.1.1.1.1.5.1.1.3" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.3.cmml">i</mi></mrow></mrow><mo id="A1.E28.m2.1.1.1.1.1.1.6" xref="A1.E28.m2.1.1.1.1.1.1.6.cmml">∈</mo><msub id="A1.E28.m2.1.1.1.1.1.1.7" xref="A1.E28.m2.1.1.1.1.1.1.7.cmml"><mi id="A1.E28.m2.1.1.1.1.1.1.7.2" xref="A1.E28.m2.1.1.1.1.1.1.7.2.cmml">I</mi><mi id="A1.E28.m2.1.1.1.1.1.1.7.3" xref="A1.E28.m2.1.1.1.1.1.1.7.3.cmml">S</mi></msub></mrow></mtd><mtd id="A1.E28.m2.2.2.2ac" xref="A1.E28.m2.2.3.3.1.1.cmml"></mtd></mtr><mtr id="A1.E28.m2.2.2.2ad" xref="A1.E28.m2.2.3.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E28.m2.2.2.2ae" xref="A1.E28.m2.2.3.3.1.cmml"><mrow id="A1.E28.m2.2.2.2.2.1.1" xref="A1.E28.m2.2.2.2.2.1.1.cmml"><mrow id="A1.E28.m2.2.2.2.2.1.1.2.1" xref="A1.E28.m2.2.2.2.2.1.1.2.2.cmml"><mn id="A1.E28.m2.2.2.2.2.1.1.1" xref="A1.E28.m2.2.2.2.2.1.1.1.cmml">0</mn><mo id="A1.E28.m2.2.2.2.2.1.1.2.1.2" xref="A1.E28.m2.2.2.2.2.1.1.2.2.cmml">,</mo><mrow id="A1.E28.m2.2.2.2.2.1.1.2.1.1" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.cmml"><mtext id="A1.E28.m2.2.2.2.2.1.1.2.1.1.2" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.2a.cmml">if </mtext><mo id="A1.E28.m2.2.2.2.2.1.1.2.1.1.1" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.1.cmml">⁢</mo><mi id="A1.E28.m2.2.2.2.2.1.1.2.1.1.3" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.3.cmml">i</mi></mrow></mrow><mo id="A1.E28.m2.2.2.2.2.1.1.3" xref="A1.E28.m2.2.2.2.2.1.1.3.cmml">∉</mo><msub id="A1.E28.m2.2.2.2.2.1.1.4" xref="A1.E28.m2.2.2.2.2.1.1.4.cmml"><mi id="A1.E28.m2.2.2.2.2.1.1.4.2" xref="A1.E28.m2.2.2.2.2.1.1.4.2.cmml">I</mi><mi id="A1.E28.m2.2.2.2.2.1.1.4.3" xref="A1.E28.m2.2.2.2.2.1.1.4.3.cmml">S</mi></msub></mrow></mtd><mtd id="A1.E28.m2.2.2.2af" xref="A1.E28.m2.2.3.3.1.1.cmml"></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E28.m2.2b"><apply id="A1.E28.m2.2.3.cmml" xref="A1.E28.m2.2.3"><eq id="A1.E28.m2.2.3.1.cmml" xref="A1.E28.m2.2.3.1"></eq><csymbol cd="latexml" id="A1.E28.m2.2.3.2.cmml" xref="A1.E28.m2.2.3.2">absent</csymbol><apply id="A1.E28.m2.2.3.3.1.cmml" xref="A1.E28.m2.2.2a"><csymbol cd="latexml" id="A1.E28.m2.2.3.3.1.1.cmml" xref="A1.E28.m2.2.2a.3">cases</csymbol><apply id="A1.E28.m2.1.1.1.1.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1"><in id="A1.E28.m2.1.1.1.1.1.1.6.cmml" xref="A1.E28.m2.1.1.1.1.1.1.6"></in><list id="A1.E28.m2.1.1.1.1.1.1.5.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.5.1"><apply id="A1.E28.m2.1.1.1.1.1.1.4.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4"><divide id="A1.E28.m2.1.1.1.1.1.1.4.5.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4"></divide><apply id="A1.E28.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2"><apply id="A1.E28.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A1.E28.m2.1.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3">subscript</csymbol><sum id="A1.E28.m2.1.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3.2"></sum><ci id="A1.E28.m2.1.1.1.1.1.1.2.2.3.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.3.3">𝑖</ci></apply><apply id="A1.E28.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1"><exp id="A1.E28.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.1.1.1"></exp><apply id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1">subscript</csymbol><apply id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1">superscript</csymbol><ci id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝑒</ci><ci id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.2.3">𝑟</ci></apply><ci id="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="A1.E28.m2.1.1.1.1.1.1.4.4.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4"><apply id="A1.E28.m2.1.1.1.1.1.1.4.4.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3"><csymbol cd="ambiguous" id="A1.E28.m2.1.1.1.1.1.1.4.4.3.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3">subscript</csymbol><sum id="A1.E28.m2.1.1.1.1.1.1.4.4.3.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3.2"></sum><ci id="A1.E28.m2.1.1.1.1.1.1.4.4.3.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.3.3">𝑡</ci></apply><apply id="A1.E28.m2.1.1.1.1.1.1.4.4.2.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1"><exp id="A1.E28.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.3.3.1"></exp><apply id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1">subscript</csymbol><apply id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1">superscript</csymbol><ci id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.2">𝑒</ci><ci id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.2.3">𝑟</ci></apply><ci id="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.4.4.2.1.1.1.3">𝑡</ci></apply></apply></apply></apply><apply id="A1.E28.m2.1.1.1.1.1.1.5.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1"><times id="A1.E28.m2.1.1.1.1.1.1.5.1.1.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.1"></times><ci id="A1.E28.m2.1.1.1.1.1.1.5.1.1.2a.cmml" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.2"><mtext id="A1.E28.m2.1.1.1.1.1.1.5.1.1.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.2">if </mtext></ci><ci id="A1.E28.m2.1.1.1.1.1.1.5.1.1.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.5.1.1.3">𝑖</ci></apply></list><apply id="A1.E28.m2.1.1.1.1.1.1.7.cmml" xref="A1.E28.m2.1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="A1.E28.m2.1.1.1.1.1.1.7.1.cmml" xref="A1.E28.m2.1.1.1.1.1.1.7">subscript</csymbol><ci id="A1.E28.m2.1.1.1.1.1.1.7.2.cmml" xref="A1.E28.m2.1.1.1.1.1.1.7.2">𝐼</ci><ci id="A1.E28.m2.1.1.1.1.1.1.7.3.cmml" xref="A1.E28.m2.1.1.1.1.1.1.7.3">𝑆</ci></apply></apply><ci id="A1.E28.m2.2.3.3.1.3a.cmml" xref="A1.E28.m2.2.2a"><mtext class="ltx_mathvariant_italic" id="A1.E28.m2.2.3.3.1.3.cmml" xref="A1.E28.m2.2.2a.3">otherwise</mtext></ci><apply id="A1.E28.m2.2.2.2.2.1.1.cmml" xref="A1.E28.m2.2.2.2.2.1.1"><notin id="A1.E28.m2.2.2.2.2.1.1.3.cmml" xref="A1.E28.m2.2.2.2.2.1.1.3"></notin><list id="A1.E28.m2.2.2.2.2.1.1.2.2.cmml" xref="A1.E28.m2.2.2.2.2.1.1.2.1"><cn id="A1.E28.m2.2.2.2.2.1.1.1.cmml" type="integer" xref="A1.E28.m2.2.2.2.2.1.1.1">0</cn><apply id="A1.E28.m2.2.2.2.2.1.1.2.1.1.cmml" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1"><times id="A1.E28.m2.2.2.2.2.1.1.2.1.1.1.cmml" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.1"></times><ci id="A1.E28.m2.2.2.2.2.1.1.2.1.1.2a.cmml" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.2"><mtext id="A1.E28.m2.2.2.2.2.1.1.2.1.1.2.cmml" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.2">if </mtext></ci><ci id="A1.E28.m2.2.2.2.2.1.1.2.1.1.3.cmml" xref="A1.E28.m2.2.2.2.2.1.1.2.1.1.3">𝑖</ci></apply></list><apply id="A1.E28.m2.2.2.2.2.1.1.4.cmml" xref="A1.E28.m2.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E28.m2.2.2.2.2.1.1.4.1.cmml" xref="A1.E28.m2.2.2.2.2.1.1.4">subscript</csymbol><ci id="A1.E28.m2.2.2.2.2.1.1.4.2.cmml" xref="A1.E28.m2.2.2.2.2.1.1.4.2">𝐼</ci><ci id="A1.E28.m2.2.2.2.2.1.1.4.3.cmml" xref="A1.E28.m2.2.2.2.2.1.1.4.3">𝑆</ci></apply></apply><ci id="A1.E28.m2.2.3.3.1.5a.cmml" xref="A1.E28.m2.2.2a"><mtext class="ltx_mathvariant_italic" id="A1.E28.m2.2.3.3.1.5.cmml" xref="A1.E28.m2.2.2a.3">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E28.m2.2c">\displaystyle=\begin{cases}\frac{\sum_{i}\exp(e^{r}_{i})}{\sum_{t}\exp(e^{r}_{%
t})},\text{if }i\in I_{S}\\
0,\text{if }i\notin I_{S}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="A1.E28.m2.2d">= { start_ROW start_CELL divide start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_exp ( italic_e start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT roman_exp ( italic_e start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG , if italic_i ∈ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL 0 , if italic_i ∉ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_CELL start_CELL end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.SSS3.p3">
<p class="ltx_p" id="A1.SS1.SSS3.p3.3">where <math alttext="v_{r},W_{r},U_{r}" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p3.1.m1.3"><semantics id="A1.SS1.SSS3.p3.1.m1.3a"><mrow id="A1.SS1.SSS3.p3.1.m1.3.3.3" xref="A1.SS1.SSS3.p3.1.m1.3.3.4.cmml"><msub id="A1.SS1.SSS3.p3.1.m1.1.1.1.1" xref="A1.SS1.SSS3.p3.1.m1.1.1.1.1.cmml"><mi id="A1.SS1.SSS3.p3.1.m1.1.1.1.1.2" xref="A1.SS1.SSS3.p3.1.m1.1.1.1.1.2.cmml">v</mi><mi id="A1.SS1.SSS3.p3.1.m1.1.1.1.1.3" xref="A1.SS1.SSS3.p3.1.m1.1.1.1.1.3.cmml">r</mi></msub><mo id="A1.SS1.SSS3.p3.1.m1.3.3.3.4" xref="A1.SS1.SSS3.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS3.p3.1.m1.2.2.2.2" xref="A1.SS1.SSS3.p3.1.m1.2.2.2.2.cmml"><mi id="A1.SS1.SSS3.p3.1.m1.2.2.2.2.2" xref="A1.SS1.SSS3.p3.1.m1.2.2.2.2.2.cmml">W</mi><mi id="A1.SS1.SSS3.p3.1.m1.2.2.2.2.3" xref="A1.SS1.SSS3.p3.1.m1.2.2.2.2.3.cmml">r</mi></msub><mo id="A1.SS1.SSS3.p3.1.m1.3.3.3.5" xref="A1.SS1.SSS3.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS3.p3.1.m1.3.3.3.3" xref="A1.SS1.SSS3.p3.1.m1.3.3.3.3.cmml"><mi id="A1.SS1.SSS3.p3.1.m1.3.3.3.3.2" xref="A1.SS1.SSS3.p3.1.m1.3.3.3.3.2.cmml">U</mi><mi id="A1.SS1.SSS3.p3.1.m1.3.3.3.3.3" xref="A1.SS1.SSS3.p3.1.m1.3.3.3.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p3.1.m1.3b"><list id="A1.SS1.SSS3.p3.1.m1.3.3.4.cmml" xref="A1.SS1.SSS3.p3.1.m1.3.3.3"><apply id="A1.SS1.SSS3.p3.1.m1.1.1.1.1.cmml" xref="A1.SS1.SSS3.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS3.p3.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.SSS3.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS3.p3.1.m1.1.1.1.1.2.cmml" xref="A1.SS1.SSS3.p3.1.m1.1.1.1.1.2">𝑣</ci><ci id="A1.SS1.SSS3.p3.1.m1.1.1.1.1.3.cmml" xref="A1.SS1.SSS3.p3.1.m1.1.1.1.1.3">𝑟</ci></apply><apply id="A1.SS1.SSS3.p3.1.m1.2.2.2.2.cmml" xref="A1.SS1.SSS3.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS3.p3.1.m1.2.2.2.2.1.cmml" xref="A1.SS1.SSS3.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS3.p3.1.m1.2.2.2.2.2.cmml" xref="A1.SS1.SSS3.p3.1.m1.2.2.2.2.2">𝑊</ci><ci id="A1.SS1.SSS3.p3.1.m1.2.2.2.2.3.cmml" xref="A1.SS1.SSS3.p3.1.m1.2.2.2.2.3">𝑟</ci></apply><apply id="A1.SS1.SSS3.p3.1.m1.3.3.3.3.cmml" xref="A1.SS1.SSS3.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS3.p3.1.m1.3.3.3.3.1.cmml" xref="A1.SS1.SSS3.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="A1.SS1.SSS3.p3.1.m1.3.3.3.3.2.cmml" xref="A1.SS1.SSS3.p3.1.m1.3.3.3.3.2">𝑈</ci><ci id="A1.SS1.SSS3.p3.1.m1.3.3.3.3.3.cmml" xref="A1.SS1.SSS3.p3.1.m1.3.3.3.3.3">𝑟</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p3.1.m1.3c">v_{r},W_{r},U_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p3.1.m1.3d">italic_v start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters. Notice that the summation in the numerator is because an item <math alttext="i" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p3.2.m2.1"><semantics id="A1.SS1.SSS3.p3.2.m2.1a"><mi id="A1.SS1.SSS3.p3.2.m2.1.1" xref="A1.SS1.SSS3.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p3.2.m2.1b"><ci id="A1.SS1.SSS3.p3.2.m2.1.1.cmml" xref="A1.SS1.SSS3.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p3.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p3.2.m2.1d">italic_i</annotation></semantics></math> might already repeat multiple times in the available session <math alttext="I_{S}" class="ltx_Math" display="inline" id="A1.SS1.SSS3.p3.3.m3.1"><semantics id="A1.SS1.SSS3.p3.3.m3.1a"><msub id="A1.SS1.SSS3.p3.3.m3.1.1" xref="A1.SS1.SSS3.p3.3.m3.1.1.cmml"><mi id="A1.SS1.SSS3.p3.3.m3.1.1.2" xref="A1.SS1.SSS3.p3.3.m3.1.1.2.cmml">I</mi><mi id="A1.SS1.SSS3.p3.3.m3.1.1.3" xref="A1.SS1.SSS3.p3.3.m3.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS3.p3.3.m3.1b"><apply id="A1.SS1.SSS3.p3.3.m3.1.1.cmml" xref="A1.SS1.SSS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS3.p3.3.m3.1.1.1.cmml" xref="A1.SS1.SSS3.p3.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.SSS3.p3.3.m3.1.1.2.cmml" xref="A1.SS1.SSS3.p3.3.m3.1.1.2">𝐼</ci><ci id="A1.SS1.SSS3.p3.3.m3.1.1.3.cmml" xref="A1.SS1.SSS3.p3.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS3.p3.3.m3.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS3.p3.3.m3.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.4 </span>Explore mode decoder</h4>
<div class="ltx_para" id="A1.SS1.SSS4.p1">
<p class="ltx_p" id="A1.SS1.SSS4.p1.1">The explore mode decoder computes the probability of selecting next action/item <math alttext="i" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p1.1.m1.1"><semantics id="A1.SS1.SSS4.p1.1.m1.1a"><mi id="A1.SS1.SSS4.p1.1.m1.1.1" xref="A1.SS1.SSS4.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p1.1.m1.1b"><ci id="A1.SS1.SSS4.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS4.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p1.1.m1.1d">italic_i</annotation></semantics></math> that’s not in the current available session so far. To capture user’s interest in this session, firstly they compute the item-level attention:</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS4.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx13">
<tbody id="A1.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e^{e}_{r}" class="ltx_Math" display="inline" id="A1.E30.m1.1"><semantics id="A1.E30.m1.1a"><msubsup id="A1.E30.m1.1.1" xref="A1.E30.m1.1.1.cmml"><mi id="A1.E30.m1.1.1.2.2" xref="A1.E30.m1.1.1.2.2.cmml">e</mi><mi id="A1.E30.m1.1.1.3" xref="A1.E30.m1.1.1.3.cmml">r</mi><mi id="A1.E30.m1.1.1.2.3" xref="A1.E30.m1.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E30.m1.1b"><apply id="A1.E30.m1.1.1.cmml" xref="A1.E30.m1.1.1"><csymbol cd="ambiguous" id="A1.E30.m1.1.1.1.cmml" xref="A1.E30.m1.1.1">subscript</csymbol><apply id="A1.E30.m1.1.1.2.cmml" xref="A1.E30.m1.1.1"><csymbol cd="ambiguous" id="A1.E30.m1.1.1.2.1.cmml" xref="A1.E30.m1.1.1">superscript</csymbol><ci id="A1.E30.m1.1.1.2.2.cmml" xref="A1.E30.m1.1.1.2.2">𝑒</ci><ci id="A1.E30.m1.1.1.2.3.cmml" xref="A1.E30.m1.1.1.2.3">𝑒</ci></apply><ci id="A1.E30.m1.1.1.3.cmml" xref="A1.E30.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E30.m1.1c">\displaystyle e^{e}_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E30.m1.1d">italic_e start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=v_{e}^{T}\tanh(W_{e}h_{t}+U_{e}h_{r})" class="ltx_Math" display="inline" id="A1.E30.m2.2"><semantics id="A1.E30.m2.2a"><mrow id="A1.E30.m2.2.2" xref="A1.E30.m2.2.2.cmml"><mi id="A1.E30.m2.2.2.3" xref="A1.E30.m2.2.2.3.cmml"></mi><mo id="A1.E30.m2.2.2.2" xref="A1.E30.m2.2.2.2.cmml">=</mo><mrow id="A1.E30.m2.2.2.1" xref="A1.E30.m2.2.2.1.cmml"><msubsup id="A1.E30.m2.2.2.1.3" xref="A1.E30.m2.2.2.1.3.cmml"><mi id="A1.E30.m2.2.2.1.3.2.2" xref="A1.E30.m2.2.2.1.3.2.2.cmml">v</mi><mi id="A1.E30.m2.2.2.1.3.2.3" xref="A1.E30.m2.2.2.1.3.2.3.cmml">e</mi><mi id="A1.E30.m2.2.2.1.3.3" xref="A1.E30.m2.2.2.1.3.3.cmml">T</mi></msubsup><mo id="A1.E30.m2.2.2.1.2" lspace="0.167em" xref="A1.E30.m2.2.2.1.2.cmml">⁢</mo><mrow id="A1.E30.m2.2.2.1.1.1" xref="A1.E30.m2.2.2.1.1.2.cmml"><mi id="A1.E30.m2.1.1" xref="A1.E30.m2.1.1.cmml">tanh</mi><mo id="A1.E30.m2.2.2.1.1.1a" xref="A1.E30.m2.2.2.1.1.2.cmml">⁡</mo><mrow id="A1.E30.m2.2.2.1.1.1.1" xref="A1.E30.m2.2.2.1.1.2.cmml"><mo id="A1.E30.m2.2.2.1.1.1.1.2" stretchy="false" xref="A1.E30.m2.2.2.1.1.2.cmml">(</mo><mrow id="A1.E30.m2.2.2.1.1.1.1.1" xref="A1.E30.m2.2.2.1.1.1.1.1.cmml"><mrow id="A1.E30.m2.2.2.1.1.1.1.1.2" xref="A1.E30.m2.2.2.1.1.1.1.1.2.cmml"><msub id="A1.E30.m2.2.2.1.1.1.1.1.2.2" xref="A1.E30.m2.2.2.1.1.1.1.1.2.2.cmml"><mi id="A1.E30.m2.2.2.1.1.1.1.1.2.2.2" xref="A1.E30.m2.2.2.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="A1.E30.m2.2.2.1.1.1.1.1.2.2.3" xref="A1.E30.m2.2.2.1.1.1.1.1.2.2.3.cmml">e</mi></msub><mo id="A1.E30.m2.2.2.1.1.1.1.1.2.1" xref="A1.E30.m2.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.E30.m2.2.2.1.1.1.1.1.2.3" xref="A1.E30.m2.2.2.1.1.1.1.1.2.3.cmml"><mi id="A1.E30.m2.2.2.1.1.1.1.1.2.3.2" xref="A1.E30.m2.2.2.1.1.1.1.1.2.3.2.cmml">h</mi><mi id="A1.E30.m2.2.2.1.1.1.1.1.2.3.3" xref="A1.E30.m2.2.2.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="A1.E30.m2.2.2.1.1.1.1.1.1" xref="A1.E30.m2.2.2.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E30.m2.2.2.1.1.1.1.1.3" xref="A1.E30.m2.2.2.1.1.1.1.1.3.cmml"><msub id="A1.E30.m2.2.2.1.1.1.1.1.3.2" xref="A1.E30.m2.2.2.1.1.1.1.1.3.2.cmml"><mi id="A1.E30.m2.2.2.1.1.1.1.1.3.2.2" xref="A1.E30.m2.2.2.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="A1.E30.m2.2.2.1.1.1.1.1.3.2.3" xref="A1.E30.m2.2.2.1.1.1.1.1.3.2.3.cmml">e</mi></msub><mo id="A1.E30.m2.2.2.1.1.1.1.1.3.1" xref="A1.E30.m2.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.E30.m2.2.2.1.1.1.1.1.3.3" xref="A1.E30.m2.2.2.1.1.1.1.1.3.3.cmml"><mi id="A1.E30.m2.2.2.1.1.1.1.1.3.3.2" xref="A1.E30.m2.2.2.1.1.1.1.1.3.3.2.cmml">h</mi><mi id="A1.E30.m2.2.2.1.1.1.1.1.3.3.3" xref="A1.E30.m2.2.2.1.1.1.1.1.3.3.3.cmml">r</mi></msub></mrow></mrow><mo id="A1.E30.m2.2.2.1.1.1.1.3" stretchy="false" xref="A1.E30.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E30.m2.2b"><apply id="A1.E30.m2.2.2.cmml" xref="A1.E30.m2.2.2"><eq id="A1.E30.m2.2.2.2.cmml" xref="A1.E30.m2.2.2.2"></eq><csymbol cd="latexml" id="A1.E30.m2.2.2.3.cmml" xref="A1.E30.m2.2.2.3">absent</csymbol><apply id="A1.E30.m2.2.2.1.cmml" xref="A1.E30.m2.2.2.1"><times id="A1.E30.m2.2.2.1.2.cmml" xref="A1.E30.m2.2.2.1.2"></times><apply id="A1.E30.m2.2.2.1.3.cmml" xref="A1.E30.m2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E30.m2.2.2.1.3.1.cmml" xref="A1.E30.m2.2.2.1.3">superscript</csymbol><apply id="A1.E30.m2.2.2.1.3.2.cmml" xref="A1.E30.m2.2.2.1.3"><csymbol cd="ambiguous" id="A1.E30.m2.2.2.1.3.2.1.cmml" xref="A1.E30.m2.2.2.1.3">subscript</csymbol><ci id="A1.E30.m2.2.2.1.3.2.2.cmml" xref="A1.E30.m2.2.2.1.3.2.2">𝑣</ci><ci id="A1.E30.m2.2.2.1.3.2.3.cmml" xref="A1.E30.m2.2.2.1.3.2.3">𝑒</ci></apply><ci id="A1.E30.m2.2.2.1.3.3.cmml" xref="A1.E30.m2.2.2.1.3.3">𝑇</ci></apply><apply id="A1.E30.m2.2.2.1.1.2.cmml" xref="A1.E30.m2.2.2.1.1.1"><tanh id="A1.E30.m2.1.1.cmml" xref="A1.E30.m2.1.1"></tanh><apply id="A1.E30.m2.2.2.1.1.1.1.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1"><plus id="A1.E30.m2.2.2.1.1.1.1.1.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.1"></plus><apply id="A1.E30.m2.2.2.1.1.1.1.1.2.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2"><times id="A1.E30.m2.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.1"></times><apply id="A1.E30.m2.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E30.m2.2.2.1.1.1.1.1.2.2.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E30.m2.2.2.1.1.1.1.1.2.2.2.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.2.2">𝑊</ci><ci id="A1.E30.m2.2.2.1.1.1.1.1.2.2.3.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.2.3">𝑒</ci></apply><apply id="A1.E30.m2.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E30.m2.2.2.1.1.1.1.1.2.3.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E30.m2.2.2.1.1.1.1.1.2.3.2.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.3.2">ℎ</ci><ci id="A1.E30.m2.2.2.1.1.1.1.1.2.3.3.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="A1.E30.m2.2.2.1.1.1.1.1.3.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3"><times id="A1.E30.m2.2.2.1.1.1.1.1.3.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.1"></times><apply id="A1.E30.m2.2.2.1.1.1.1.1.3.2.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E30.m2.2.2.1.1.1.1.1.3.2.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E30.m2.2.2.1.1.1.1.1.3.2.2.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.2.2">𝑈</ci><ci id="A1.E30.m2.2.2.1.1.1.1.1.3.2.3.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.2.3">𝑒</ci></apply><apply id="A1.E30.m2.2.2.1.1.1.1.1.3.3.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E30.m2.2.2.1.1.1.1.1.3.3.1.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E30.m2.2.2.1.1.1.1.1.3.3.2.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.3.2">ℎ</ci><ci id="A1.E30.m2.2.2.1.1.1.1.1.3.3.3.cmml" xref="A1.E30.m2.2.2.1.1.1.1.1.3.3.3">𝑟</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E30.m2.2c">\displaystyle=v_{e}^{T}\tanh(W_{e}h_{t}+U_{e}h_{r})</annotation><annotation encoding="application/x-llamapun" id="A1.E30.m2.2d">= italic_v start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_tanh ( italic_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_U start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
<tbody id="A1.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha^{e}_{r}" class="ltx_Math" display="inline" id="A1.E31.m1.1"><semantics id="A1.E31.m1.1a"><msubsup id="A1.E31.m1.1.1" xref="A1.E31.m1.1.1.cmml"><mi id="A1.E31.m1.1.1.2.2" xref="A1.E31.m1.1.1.2.2.cmml">α</mi><mi id="A1.E31.m1.1.1.3" xref="A1.E31.m1.1.1.3.cmml">r</mi><mi id="A1.E31.m1.1.1.2.3" xref="A1.E31.m1.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E31.m1.1b"><apply id="A1.E31.m1.1.1.cmml" xref="A1.E31.m1.1.1"><csymbol cd="ambiguous" id="A1.E31.m1.1.1.1.cmml" xref="A1.E31.m1.1.1">subscript</csymbol><apply id="A1.E31.m1.1.1.2.cmml" xref="A1.E31.m1.1.1"><csymbol cd="ambiguous" id="A1.E31.m1.1.1.2.1.cmml" xref="A1.E31.m1.1.1">superscript</csymbol><ci id="A1.E31.m1.1.1.2.2.cmml" xref="A1.E31.m1.1.1.2.2">𝛼</ci><ci id="A1.E31.m1.1.1.2.3.cmml" xref="A1.E31.m1.1.1.2.3">𝑒</ci></apply><ci id="A1.E31.m1.1.1.3.cmml" xref="A1.E31.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E31.m1.1c">\displaystyle\alpha^{e}_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.E31.m1.1d">italic_α start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\exp(e^{e}_{r})}{\sum_{t}\exp(e^{e}_{t})}" class="ltx_Math" display="inline" id="A1.E31.m2.4"><semantics id="A1.E31.m2.4a"><mrow id="A1.E31.m2.4.5" xref="A1.E31.m2.4.5.cmml"><mi id="A1.E31.m2.4.5.2" xref="A1.E31.m2.4.5.2.cmml"></mi><mo id="A1.E31.m2.4.5.1" xref="A1.E31.m2.4.5.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E31.m2.4.4" xref="A1.E31.m2.4.4.cmml"><mfrac id="A1.E31.m2.4.4a" xref="A1.E31.m2.4.4.cmml"><mrow id="A1.E31.m2.2.2.2.2" xref="A1.E31.m2.2.2.2.3.cmml"><mi id="A1.E31.m2.1.1.1.1" xref="A1.E31.m2.1.1.1.1.cmml">exp</mi><mo id="A1.E31.m2.2.2.2.2a" xref="A1.E31.m2.2.2.2.3.cmml">⁡</mo><mrow id="A1.E31.m2.2.2.2.2.1" xref="A1.E31.m2.2.2.2.3.cmml"><mo id="A1.E31.m2.2.2.2.2.1.2" stretchy="false" xref="A1.E31.m2.2.2.2.3.cmml">(</mo><msubsup id="A1.E31.m2.2.2.2.2.1.1" xref="A1.E31.m2.2.2.2.2.1.1.cmml"><mi id="A1.E31.m2.2.2.2.2.1.1.2.2" xref="A1.E31.m2.2.2.2.2.1.1.2.2.cmml">e</mi><mi id="A1.E31.m2.2.2.2.2.1.1.3" xref="A1.E31.m2.2.2.2.2.1.1.3.cmml">r</mi><mi id="A1.E31.m2.2.2.2.2.1.1.2.3" xref="A1.E31.m2.2.2.2.2.1.1.2.3.cmml">e</mi></msubsup><mo id="A1.E31.m2.2.2.2.2.1.3" stretchy="false" xref="A1.E31.m2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A1.E31.m2.4.4.4" xref="A1.E31.m2.4.4.4.cmml"><msub id="A1.E31.m2.4.4.4.3" xref="A1.E31.m2.4.4.4.3.cmml"><mo id="A1.E31.m2.4.4.4.3.2" xref="A1.E31.m2.4.4.4.3.2.cmml">∑</mo><mi id="A1.E31.m2.4.4.4.3.3" xref="A1.E31.m2.4.4.4.3.3.cmml">t</mi></msub><mrow id="A1.E31.m2.4.4.4.2.1" xref="A1.E31.m2.4.4.4.2.2.cmml"><mi id="A1.E31.m2.3.3.3.1" xref="A1.E31.m2.3.3.3.1.cmml">exp</mi><mo id="A1.E31.m2.4.4.4.2.1a" xref="A1.E31.m2.4.4.4.2.2.cmml">⁡</mo><mrow id="A1.E31.m2.4.4.4.2.1.1" xref="A1.E31.m2.4.4.4.2.2.cmml"><mo id="A1.E31.m2.4.4.4.2.1.1.2" stretchy="false" xref="A1.E31.m2.4.4.4.2.2.cmml">(</mo><msubsup id="A1.E31.m2.4.4.4.2.1.1.1" xref="A1.E31.m2.4.4.4.2.1.1.1.cmml"><mi id="A1.E31.m2.4.4.4.2.1.1.1.2.2" xref="A1.E31.m2.4.4.4.2.1.1.1.2.2.cmml">e</mi><mi id="A1.E31.m2.4.4.4.2.1.1.1.3" xref="A1.E31.m2.4.4.4.2.1.1.1.3.cmml">t</mi><mi id="A1.E31.m2.4.4.4.2.1.1.1.2.3" xref="A1.E31.m2.4.4.4.2.1.1.1.2.3.cmml">e</mi></msubsup><mo id="A1.E31.m2.4.4.4.2.1.1.3" stretchy="false" xref="A1.E31.m2.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E31.m2.4b"><apply id="A1.E31.m2.4.5.cmml" xref="A1.E31.m2.4.5"><eq id="A1.E31.m2.4.5.1.cmml" xref="A1.E31.m2.4.5.1"></eq><csymbol cd="latexml" id="A1.E31.m2.4.5.2.cmml" xref="A1.E31.m2.4.5.2">absent</csymbol><apply id="A1.E31.m2.4.4.cmml" xref="A1.E31.m2.4.4"><divide id="A1.E31.m2.4.4.5.cmml" xref="A1.E31.m2.4.4"></divide><apply id="A1.E31.m2.2.2.2.3.cmml" xref="A1.E31.m2.2.2.2.2"><exp id="A1.E31.m2.1.1.1.1.cmml" xref="A1.E31.m2.1.1.1.1"></exp><apply id="A1.E31.m2.2.2.2.2.1.1.cmml" xref="A1.E31.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E31.m2.2.2.2.2.1.1.1.cmml" xref="A1.E31.m2.2.2.2.2.1.1">subscript</csymbol><apply id="A1.E31.m2.2.2.2.2.1.1.2.cmml" xref="A1.E31.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A1.E31.m2.2.2.2.2.1.1.2.1.cmml" xref="A1.E31.m2.2.2.2.2.1.1">superscript</csymbol><ci id="A1.E31.m2.2.2.2.2.1.1.2.2.cmml" xref="A1.E31.m2.2.2.2.2.1.1.2.2">𝑒</ci><ci id="A1.E31.m2.2.2.2.2.1.1.2.3.cmml" xref="A1.E31.m2.2.2.2.2.1.1.2.3">𝑒</ci></apply><ci id="A1.E31.m2.2.2.2.2.1.1.3.cmml" xref="A1.E31.m2.2.2.2.2.1.1.3">𝑟</ci></apply></apply><apply id="A1.E31.m2.4.4.4.cmml" xref="A1.E31.m2.4.4.4"><apply id="A1.E31.m2.4.4.4.3.cmml" xref="A1.E31.m2.4.4.4.3"><csymbol cd="ambiguous" id="A1.E31.m2.4.4.4.3.1.cmml" xref="A1.E31.m2.4.4.4.3">subscript</csymbol><sum id="A1.E31.m2.4.4.4.3.2.cmml" xref="A1.E31.m2.4.4.4.3.2"></sum><ci id="A1.E31.m2.4.4.4.3.3.cmml" xref="A1.E31.m2.4.4.4.3.3">𝑡</ci></apply><apply id="A1.E31.m2.4.4.4.2.2.cmml" xref="A1.E31.m2.4.4.4.2.1"><exp id="A1.E31.m2.3.3.3.1.cmml" xref="A1.E31.m2.3.3.3.1"></exp><apply id="A1.E31.m2.4.4.4.2.1.1.1.cmml" xref="A1.E31.m2.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A1.E31.m2.4.4.4.2.1.1.1.1.cmml" xref="A1.E31.m2.4.4.4.2.1.1.1">subscript</csymbol><apply id="A1.E31.m2.4.4.4.2.1.1.1.2.cmml" xref="A1.E31.m2.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="A1.E31.m2.4.4.4.2.1.1.1.2.1.cmml" xref="A1.E31.m2.4.4.4.2.1.1.1">superscript</csymbol><ci id="A1.E31.m2.4.4.4.2.1.1.1.2.2.cmml" xref="A1.E31.m2.4.4.4.2.1.1.1.2.2">𝑒</ci><ci id="A1.E31.m2.4.4.4.2.1.1.1.2.3.cmml" xref="A1.E31.m2.4.4.4.2.1.1.1.2.3">𝑒</ci></apply><ci id="A1.E31.m2.4.4.4.2.1.1.1.3.cmml" xref="A1.E31.m2.4.4.4.2.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E31.m2.4c">\displaystyle=\frac{\exp(e^{e}_{r})}{\sum_{t}\exp(e^{e}_{t})}</annotation><annotation encoding="application/x-llamapun" id="A1.E31.m2.4d">= divide start_ARG roman_exp ( italic_e start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT roman_exp ( italic_e start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
<tbody id="A1.E32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle c^{e}_{\text{session}}" class="ltx_Math" display="inline" id="A1.E32.m1.1"><semantics id="A1.E32.m1.1a"><msubsup id="A1.E32.m1.1.1" xref="A1.E32.m1.1.1.cmml"><mi id="A1.E32.m1.1.1.2.2" xref="A1.E32.m1.1.1.2.2.cmml">c</mi><mtext id="A1.E32.m1.1.1.3" xref="A1.E32.m1.1.1.3a.cmml">session</mtext><mi id="A1.E32.m1.1.1.2.3" xref="A1.E32.m1.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E32.m1.1b"><apply id="A1.E32.m1.1.1.cmml" xref="A1.E32.m1.1.1"><csymbol cd="ambiguous" id="A1.E32.m1.1.1.1.cmml" xref="A1.E32.m1.1.1">subscript</csymbol><apply id="A1.E32.m1.1.1.2.cmml" xref="A1.E32.m1.1.1"><csymbol cd="ambiguous" id="A1.E32.m1.1.1.2.1.cmml" xref="A1.E32.m1.1.1">superscript</csymbol><ci id="A1.E32.m1.1.1.2.2.cmml" xref="A1.E32.m1.1.1.2.2">𝑐</ci><ci id="A1.E32.m1.1.1.2.3.cmml" xref="A1.E32.m1.1.1.2.3">𝑒</ci></apply><ci id="A1.E32.m1.1.1.3a.cmml" xref="A1.E32.m1.1.1.3"><mtext id="A1.E32.m1.1.1.3.cmml" mathsize="70%" xref="A1.E32.m1.1.1.3">session</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E32.m1.1c">\displaystyle c^{e}_{\text{session}}</annotation><annotation encoding="application/x-llamapun" id="A1.E32.m1.1d">italic_c start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT session end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{t}\alpha^{e}_{t}h_{t}" class="ltx_Math" display="inline" id="A1.E32.m2.1"><semantics id="A1.E32.m2.1a"><mrow id="A1.E32.m2.1.1" xref="A1.E32.m2.1.1.cmml"><mi id="A1.E32.m2.1.1.2" xref="A1.E32.m2.1.1.2.cmml"></mi><mo id="A1.E32.m2.1.1.1" xref="A1.E32.m2.1.1.1.cmml">=</mo><mrow id="A1.E32.m2.1.1.3" xref="A1.E32.m2.1.1.3.cmml"><mstyle displaystyle="true" id="A1.E32.m2.1.1.3.1" xref="A1.E32.m2.1.1.3.1.cmml"><munder id="A1.E32.m2.1.1.3.1a" xref="A1.E32.m2.1.1.3.1.cmml"><mo id="A1.E32.m2.1.1.3.1.2" movablelimits="false" xref="A1.E32.m2.1.1.3.1.2.cmml">∑</mo><mi id="A1.E32.m2.1.1.3.1.3" xref="A1.E32.m2.1.1.3.1.3.cmml">t</mi></munder></mstyle><mrow id="A1.E32.m2.1.1.3.2" xref="A1.E32.m2.1.1.3.2.cmml"><msubsup id="A1.E32.m2.1.1.3.2.2" xref="A1.E32.m2.1.1.3.2.2.cmml"><mi id="A1.E32.m2.1.1.3.2.2.2.2" xref="A1.E32.m2.1.1.3.2.2.2.2.cmml">α</mi><mi id="A1.E32.m2.1.1.3.2.2.3" xref="A1.E32.m2.1.1.3.2.2.3.cmml">t</mi><mi id="A1.E32.m2.1.1.3.2.2.2.3" xref="A1.E32.m2.1.1.3.2.2.2.3.cmml">e</mi></msubsup><mo id="A1.E32.m2.1.1.3.2.1" xref="A1.E32.m2.1.1.3.2.1.cmml">⁢</mo><msub id="A1.E32.m2.1.1.3.2.3" xref="A1.E32.m2.1.1.3.2.3.cmml"><mi id="A1.E32.m2.1.1.3.2.3.2" xref="A1.E32.m2.1.1.3.2.3.2.cmml">h</mi><mi id="A1.E32.m2.1.1.3.2.3.3" xref="A1.E32.m2.1.1.3.2.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E32.m2.1b"><apply id="A1.E32.m2.1.1.cmml" xref="A1.E32.m2.1.1"><eq id="A1.E32.m2.1.1.1.cmml" xref="A1.E32.m2.1.1.1"></eq><csymbol cd="latexml" id="A1.E32.m2.1.1.2.cmml" xref="A1.E32.m2.1.1.2">absent</csymbol><apply id="A1.E32.m2.1.1.3.cmml" xref="A1.E32.m2.1.1.3"><apply id="A1.E32.m2.1.1.3.1.cmml" xref="A1.E32.m2.1.1.3.1"><csymbol cd="ambiguous" id="A1.E32.m2.1.1.3.1.1.cmml" xref="A1.E32.m2.1.1.3.1">subscript</csymbol><sum id="A1.E32.m2.1.1.3.1.2.cmml" xref="A1.E32.m2.1.1.3.1.2"></sum><ci id="A1.E32.m2.1.1.3.1.3.cmml" xref="A1.E32.m2.1.1.3.1.3">𝑡</ci></apply><apply id="A1.E32.m2.1.1.3.2.cmml" xref="A1.E32.m2.1.1.3.2"><times id="A1.E32.m2.1.1.3.2.1.cmml" xref="A1.E32.m2.1.1.3.2.1"></times><apply id="A1.E32.m2.1.1.3.2.2.cmml" xref="A1.E32.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E32.m2.1.1.3.2.2.1.cmml" xref="A1.E32.m2.1.1.3.2.2">subscript</csymbol><apply id="A1.E32.m2.1.1.3.2.2.2.cmml" xref="A1.E32.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E32.m2.1.1.3.2.2.2.1.cmml" xref="A1.E32.m2.1.1.3.2.2">superscript</csymbol><ci id="A1.E32.m2.1.1.3.2.2.2.2.cmml" xref="A1.E32.m2.1.1.3.2.2.2.2">𝛼</ci><ci id="A1.E32.m2.1.1.3.2.2.2.3.cmml" xref="A1.E32.m2.1.1.3.2.2.2.3">𝑒</ci></apply><ci id="A1.E32.m2.1.1.3.2.2.3.cmml" xref="A1.E32.m2.1.1.3.2.2.3">𝑡</ci></apply><apply id="A1.E32.m2.1.1.3.2.3.cmml" xref="A1.E32.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E32.m2.1.1.3.2.3.1.cmml" xref="A1.E32.m2.1.1.3.2.3">subscript</csymbol><ci id="A1.E32.m2.1.1.3.2.3.2.cmml" xref="A1.E32.m2.1.1.3.2.3.2">ℎ</ci><ci id="A1.E32.m2.1.1.3.2.3.3.cmml" xref="A1.E32.m2.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E32.m2.1c">\displaystyle=\sum_{t}\alpha^{e}_{t}h_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.E32.m2.1d">= ∑ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.SSS4.p3">
<p class="ltx_p" id="A1.SS1.SSS4.p3.4">where again <math alttext="v_{e},W_{e},U_{e}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.1.m1.3"><semantics id="A1.SS1.SSS4.p3.1.m1.3a"><mrow id="A1.SS1.SSS4.p3.1.m1.3.3.3" xref="A1.SS1.SSS4.p3.1.m1.3.3.4.cmml"><msub id="A1.SS1.SSS4.p3.1.m1.1.1.1.1" xref="A1.SS1.SSS4.p3.1.m1.1.1.1.1.cmml"><mi id="A1.SS1.SSS4.p3.1.m1.1.1.1.1.2" xref="A1.SS1.SSS4.p3.1.m1.1.1.1.1.2.cmml">v</mi><mi id="A1.SS1.SSS4.p3.1.m1.1.1.1.1.3" xref="A1.SS1.SSS4.p3.1.m1.1.1.1.1.3.cmml">e</mi></msub><mo id="A1.SS1.SSS4.p3.1.m1.3.3.3.4" xref="A1.SS1.SSS4.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS4.p3.1.m1.2.2.2.2" xref="A1.SS1.SSS4.p3.1.m1.2.2.2.2.cmml"><mi id="A1.SS1.SSS4.p3.1.m1.2.2.2.2.2" xref="A1.SS1.SSS4.p3.1.m1.2.2.2.2.2.cmml">W</mi><mi id="A1.SS1.SSS4.p3.1.m1.2.2.2.2.3" xref="A1.SS1.SSS4.p3.1.m1.2.2.2.2.3.cmml">e</mi></msub><mo id="A1.SS1.SSS4.p3.1.m1.3.3.3.5" xref="A1.SS1.SSS4.p3.1.m1.3.3.4.cmml">,</mo><msub id="A1.SS1.SSS4.p3.1.m1.3.3.3.3" xref="A1.SS1.SSS4.p3.1.m1.3.3.3.3.cmml"><mi id="A1.SS1.SSS4.p3.1.m1.3.3.3.3.2" xref="A1.SS1.SSS4.p3.1.m1.3.3.3.3.2.cmml">U</mi><mi id="A1.SS1.SSS4.p3.1.m1.3.3.3.3.3" xref="A1.SS1.SSS4.p3.1.m1.3.3.3.3.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.1.m1.3b"><list id="A1.SS1.SSS4.p3.1.m1.3.3.4.cmml" xref="A1.SS1.SSS4.p3.1.m1.3.3.3"><apply id="A1.SS1.SSS4.p3.1.m1.1.1.1.1.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.1.m1.1.1.1.1.2.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1.1.1.2">𝑣</ci><ci id="A1.SS1.SSS4.p3.1.m1.1.1.1.1.3.cmml" xref="A1.SS1.SSS4.p3.1.m1.1.1.1.1.3">𝑒</ci></apply><apply id="A1.SS1.SSS4.p3.1.m1.2.2.2.2.cmml" xref="A1.SS1.SSS4.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.1.m1.2.2.2.2.1.cmml" xref="A1.SS1.SSS4.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.SS1.SSS4.p3.1.m1.2.2.2.2.2.cmml" xref="A1.SS1.SSS4.p3.1.m1.2.2.2.2.2">𝑊</ci><ci id="A1.SS1.SSS4.p3.1.m1.2.2.2.2.3.cmml" xref="A1.SS1.SSS4.p3.1.m1.2.2.2.2.3">𝑒</ci></apply><apply id="A1.SS1.SSS4.p3.1.m1.3.3.3.3.cmml" xref="A1.SS1.SSS4.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.1.m1.3.3.3.3.1.cmml" xref="A1.SS1.SSS4.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="A1.SS1.SSS4.p3.1.m1.3.3.3.3.2.cmml" xref="A1.SS1.SSS4.p3.1.m1.3.3.3.3.2">𝑈</ci><ci id="A1.SS1.SSS4.p3.1.m1.3.3.3.3.3.cmml" xref="A1.SS1.SSS4.p3.1.m1.3.3.3.3.3">𝑒</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.1.m1.3c">v_{e},W_{e},U_{e}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.1.m1.3d">italic_v start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_U start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters. Then they concatenate the last hidden state <math alttext="h_{t}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.2.m2.1"><semantics id="A1.SS1.SSS4.p3.2.m2.1a"><msub id="A1.SS1.SSS4.p3.2.m2.1.1" xref="A1.SS1.SSS4.p3.2.m2.1.1.cmml"><mi id="A1.SS1.SSS4.p3.2.m2.1.1.2" xref="A1.SS1.SSS4.p3.2.m2.1.1.2.cmml">h</mi><mi id="A1.SS1.SSS4.p3.2.m2.1.1.3" xref="A1.SS1.SSS4.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.2.m2.1b"><apply id="A1.SS1.SSS4.p3.2.m2.1.1.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.2.m2.1.1.1.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.2.m2.1.1.2.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1.2">ℎ</ci><ci id="A1.SS1.SSS4.p3.2.m2.1.1.3.cmml" xref="A1.SS1.SSS4.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.2.m2.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.2.m2.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with the attention vector <math alttext="c^{e}_{\text{session}}" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.3.m3.1"><semantics id="A1.SS1.SSS4.p3.3.m3.1a"><msubsup id="A1.SS1.SSS4.p3.3.m3.1.1" xref="A1.SS1.SSS4.p3.3.m3.1.1.cmml"><mi id="A1.SS1.SSS4.p3.3.m3.1.1.2.2" xref="A1.SS1.SSS4.p3.3.m3.1.1.2.2.cmml">c</mi><mtext id="A1.SS1.SSS4.p3.3.m3.1.1.3" xref="A1.SS1.SSS4.p3.3.m3.1.1.3a.cmml">session</mtext><mi id="A1.SS1.SSS4.p3.3.m3.1.1.2.3" xref="A1.SS1.SSS4.p3.3.m3.1.1.2.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.3.m3.1b"><apply id="A1.SS1.SSS4.p3.3.m3.1.1.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.3.m3.1.1.1.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1">subscript</csymbol><apply id="A1.SS1.SSS4.p3.3.m3.1.1.2.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.3.m3.1.1.2.1.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1">superscript</csymbol><ci id="A1.SS1.SSS4.p3.3.m3.1.1.2.2.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1.2.2">𝑐</ci><ci id="A1.SS1.SSS4.p3.3.m3.1.1.2.3.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1.2.3">𝑒</ci></apply><ci id="A1.SS1.SSS4.p3.3.m3.1.1.3a.cmml" xref="A1.SS1.SSS4.p3.3.m3.1.1.3"><mtext id="A1.SS1.SSS4.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="A1.SS1.SSS4.p3.3.m3.1.1.3">session</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.3.m3.1c">c^{e}_{\text{session}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.3.m3.1d">italic_c start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT session end_POSTSUBSCRIPT</annotation></semantics></math> into <math alttext="c_{I_{S}}=[h_{t},c^{e}_{\text{session}}]" class="ltx_Math" display="inline" id="A1.SS1.SSS4.p3.4.m4.2"><semantics id="A1.SS1.SSS4.p3.4.m4.2a"><mrow id="A1.SS1.SSS4.p3.4.m4.2.2" xref="A1.SS1.SSS4.p3.4.m4.2.2.cmml"><msub id="A1.SS1.SSS4.p3.4.m4.2.2.4" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.cmml"><mi id="A1.SS1.SSS4.p3.4.m4.2.2.4.2" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.2.cmml">c</mi><msub id="A1.SS1.SSS4.p3.4.m4.2.2.4.3" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.3.cmml"><mi id="A1.SS1.SSS4.p3.4.m4.2.2.4.3.2" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.3.2.cmml">I</mi><mi id="A1.SS1.SSS4.p3.4.m4.2.2.4.3.3" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.3.3.cmml">S</mi></msub></msub><mo id="A1.SS1.SSS4.p3.4.m4.2.2.3" xref="A1.SS1.SSS4.p3.4.m4.2.2.3.cmml">=</mo><mrow id="A1.SS1.SSS4.p3.4.m4.2.2.2.2" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.3.cmml"><mo id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.3" stretchy="false" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.3.cmml">[</mo><msub id="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1" xref="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.cmml"><mi id="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.2" xref="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.2.cmml">h</mi><mi id="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.3" xref="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.4" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.3.cmml">,</mo><msubsup id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.cmml"><mi id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.2" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.2.cmml">c</mi><mtext id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.3" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.3a.cmml">session</mtext><mi id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.3" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.3.cmml">e</mi></msubsup><mo id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.5" stretchy="false" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS4.p3.4.m4.2b"><apply id="A1.SS1.SSS4.p3.4.m4.2.2.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2"><eq id="A1.SS1.SSS4.p3.4.m4.2.2.3.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.3"></eq><apply id="A1.SS1.SSS4.p3.4.m4.2.2.4.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.4"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.4.m4.2.2.4.1.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.4">subscript</csymbol><ci id="A1.SS1.SSS4.p3.4.m4.2.2.4.2.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.2">𝑐</ci><apply id="A1.SS1.SSS4.p3.4.m4.2.2.4.3.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.3"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.4.m4.2.2.4.3.1.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.3">subscript</csymbol><ci id="A1.SS1.SSS4.p3.4.m4.2.2.4.3.2.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.3.2">𝐼</ci><ci id="A1.SS1.SSS4.p3.4.m4.2.2.4.3.3.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.4.3.3">𝑆</ci></apply></apply><interval closure="closed" id="A1.SS1.SSS4.p3.4.m4.2.2.2.3.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2"><apply id="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.cmml" xref="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.2">ℎ</ci><ci id="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS4.p3.4.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.1.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2">subscript</csymbol><apply id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.1.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2">superscript</csymbol><ci id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.2.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.2">𝑐</ci><ci id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.3.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.2.3">𝑒</ci></apply><ci id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.3a.cmml" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.3"><mtext id="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.3.cmml" mathsize="70%" xref="A1.SS1.SSS4.p3.4.m4.2.2.2.2.2.3">session</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS4.p3.4.m4.2c">c_{I_{S}}=[h_{t},c^{e}_{\text{session}}]</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS4.p3.4.m4.2d">italic_c start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_POSTSUBSCRIPT = [ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT session end_POSTSUBSCRIPT ]</annotation></semantics></math>. Finally they use this to compute the explore probability as follows:</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS4.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx14">
<tbody id="A1.E33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f_{i}" class="ltx_Math" display="inline" id="A1.E33.m1.1"><semantics id="A1.E33.m1.1a"><msub id="A1.E33.m1.1.1" xref="A1.E33.m1.1.1.cmml"><mi id="A1.E33.m1.1.1.2" xref="A1.E33.m1.1.1.2.cmml">f</mi><mi id="A1.E33.m1.1.1.3" xref="A1.E33.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.E33.m1.1b"><apply id="A1.E33.m1.1.1.cmml" xref="A1.E33.m1.1.1"><csymbol cd="ambiguous" id="A1.E33.m1.1.1.1.cmml" xref="A1.E33.m1.1.1">subscript</csymbol><ci id="A1.E33.m1.1.1.2.cmml" xref="A1.E33.m1.1.1.2">𝑓</ci><ci id="A1.E33.m1.1.1.3.cmml" xref="A1.E33.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E33.m1.1c">\displaystyle f_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.E33.m1.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\begin{cases}-\infty,\text{if }i\in I_{S}\\
V_{e}c_{I_{S}},\text{if }i\not\in I_{S}\end{cases}" class="ltx_Math" display="inline" id="A1.E33.m2.2"><semantics id="A1.E33.m2.2a"><mrow id="A1.E33.m2.2.3" xref="A1.E33.m2.2.3.cmml"><mi id="A1.E33.m2.2.3.2" xref="A1.E33.m2.2.3.2.cmml"></mi><mo id="A1.E33.m2.2.3.1" xref="A1.E33.m2.2.3.1.cmml">=</mo><mrow id="A1.E33.m2.2.2a" xref="A1.E33.m2.2.3.3.1.cmml"><mo id="A1.E33.m2.2.2a.3" xref="A1.E33.m2.2.3.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="A1.E33.m2.2.2.2a" rowspacing="0pt" xref="A1.E33.m2.2.3.3.1.cmml"><mtr id="A1.E33.m2.2.2.2aa" xref="A1.E33.m2.2.3.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E33.m2.2.2.2ab" xref="A1.E33.m2.2.3.3.1.cmml"><mrow id="A1.E33.m2.1.1.1.1.1.1" xref="A1.E33.m2.1.1.1.1.1.1.cmml"><mrow id="A1.E33.m2.1.1.1.1.1.1.2.2" xref="A1.E33.m2.1.1.1.1.1.1.2.3.cmml"><mrow id="A1.E33.m2.1.1.1.1.1.1.1.1.1" xref="A1.E33.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E33.m2.1.1.1.1.1.1.1.1.1a" xref="A1.E33.m2.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.E33.m2.1.1.1.1.1.1.1.1.1.2" mathvariant="normal" xref="A1.E33.m2.1.1.1.1.1.1.1.1.1.2.cmml">∞</mi></mrow><mo id="A1.E33.m2.1.1.1.1.1.1.2.2.3" xref="A1.E33.m2.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="A1.E33.m2.1.1.1.1.1.1.2.2.2" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.cmml"><mtext id="A1.E33.m2.1.1.1.1.1.1.2.2.2.2" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.2a.cmml">if </mtext><mo id="A1.E33.m2.1.1.1.1.1.1.2.2.2.1" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="A1.E33.m2.1.1.1.1.1.1.2.2.2.3" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></mrow></mrow><mo id="A1.E33.m2.1.1.1.1.1.1.3" xref="A1.E33.m2.1.1.1.1.1.1.3.cmml">∈</mo><msub id="A1.E33.m2.1.1.1.1.1.1.4" xref="A1.E33.m2.1.1.1.1.1.1.4.cmml"><mi id="A1.E33.m2.1.1.1.1.1.1.4.2" xref="A1.E33.m2.1.1.1.1.1.1.4.2.cmml">I</mi><mi id="A1.E33.m2.1.1.1.1.1.1.4.3" xref="A1.E33.m2.1.1.1.1.1.1.4.3.cmml">S</mi></msub></mrow></mtd><mtd id="A1.E33.m2.2.2.2ac" xref="A1.E33.m2.2.3.3.1.1.cmml"></mtd></mtr><mtr id="A1.E33.m2.2.2.2ad" xref="A1.E33.m2.2.3.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E33.m2.2.2.2ae" xref="A1.E33.m2.2.3.3.1.cmml"><mrow id="A1.E33.m2.2.2.2.2.1.1" xref="A1.E33.m2.2.2.2.2.1.1.cmml"><mrow id="A1.E33.m2.2.2.2.2.1.1.2.2" xref="A1.E33.m2.2.2.2.2.1.1.2.3.cmml"><mrow id="A1.E33.m2.2.2.2.2.1.1.1.1.1" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.cmml"><msub id="A1.E33.m2.2.2.2.2.1.1.1.1.1.2" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.cmml"><mi id="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.2" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.2.cmml">V</mi><mi id="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.3" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.3.cmml">e</mi></msub><mo id="A1.E33.m2.2.2.2.2.1.1.1.1.1.1" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.1.cmml">⁢</mo><msub id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.cmml"><mi id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.2" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.2.cmml">c</mi><msub id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.cmml"><mi id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.2" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.2.cmml">I</mi><mi id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.3" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.3.cmml">S</mi></msub></msub></mrow><mo id="A1.E33.m2.2.2.2.2.1.1.2.2.3" xref="A1.E33.m2.2.2.2.2.1.1.2.3.cmml">,</mo><mrow id="A1.E33.m2.2.2.2.2.1.1.2.2.2" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.cmml"><mtext id="A1.E33.m2.2.2.2.2.1.1.2.2.2.2" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.2a.cmml">if </mtext><mo id="A1.E33.m2.2.2.2.2.1.1.2.2.2.1" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.1.cmml">⁢</mo><mi id="A1.E33.m2.2.2.2.2.1.1.2.2.2.3" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.3.cmml">i</mi></mrow></mrow><mo id="A1.E33.m2.2.2.2.2.1.1.3" xref="A1.E33.m2.2.2.2.2.1.1.3.cmml">∉</mo><msub id="A1.E33.m2.2.2.2.2.1.1.4" xref="A1.E33.m2.2.2.2.2.1.1.4.cmml"><mi id="A1.E33.m2.2.2.2.2.1.1.4.2" xref="A1.E33.m2.2.2.2.2.1.1.4.2.cmml">I</mi><mi id="A1.E33.m2.2.2.2.2.1.1.4.3" xref="A1.E33.m2.2.2.2.2.1.1.4.3.cmml">S</mi></msub></mrow></mtd><mtd id="A1.E33.m2.2.2.2af" xref="A1.E33.m2.2.3.3.1.1.cmml"></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E33.m2.2b"><apply id="A1.E33.m2.2.3.cmml" xref="A1.E33.m2.2.3"><eq id="A1.E33.m2.2.3.1.cmml" xref="A1.E33.m2.2.3.1"></eq><csymbol cd="latexml" id="A1.E33.m2.2.3.2.cmml" xref="A1.E33.m2.2.3.2">absent</csymbol><apply id="A1.E33.m2.2.3.3.1.cmml" xref="A1.E33.m2.2.2a"><csymbol cd="latexml" id="A1.E33.m2.2.3.3.1.1.cmml" xref="A1.E33.m2.2.2a.3">cases</csymbol><apply id="A1.E33.m2.1.1.1.1.1.1.cmml" xref="A1.E33.m2.1.1.1.1.1.1"><in id="A1.E33.m2.1.1.1.1.1.1.3.cmml" xref="A1.E33.m2.1.1.1.1.1.1.3"></in><list id="A1.E33.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.E33.m2.1.1.1.1.1.1.2.2"><apply id="A1.E33.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E33.m2.1.1.1.1.1.1.1.1.1"><minus id="A1.E33.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E33.m2.1.1.1.1.1.1.1.1.1"></minus><infinity id="A1.E33.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E33.m2.1.1.1.1.1.1.1.1.1.2"></infinity></apply><apply id="A1.E33.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2"><times id="A1.E33.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.1"></times><ci id="A1.E33.m2.1.1.1.1.1.1.2.2.2.2a.cmml" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.2"><mtext id="A1.E33.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.2">if </mtext></ci><ci id="A1.E33.m2.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.E33.m2.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list><apply id="A1.E33.m2.1.1.1.1.1.1.4.cmml" xref="A1.E33.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E33.m2.1.1.1.1.1.1.4.1.cmml" xref="A1.E33.m2.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E33.m2.1.1.1.1.1.1.4.2.cmml" xref="A1.E33.m2.1.1.1.1.1.1.4.2">𝐼</ci><ci id="A1.E33.m2.1.1.1.1.1.1.4.3.cmml" xref="A1.E33.m2.1.1.1.1.1.1.4.3">𝑆</ci></apply></apply><ci id="A1.E33.m2.2.3.3.1.3a.cmml" xref="A1.E33.m2.2.2a"><mtext class="ltx_mathvariant_italic" id="A1.E33.m2.2.3.3.1.3.cmml" xref="A1.E33.m2.2.2a.3">otherwise</mtext></ci><apply id="A1.E33.m2.2.2.2.2.1.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1"><notin id="A1.E33.m2.2.2.2.2.1.1.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.3"></notin><list id="A1.E33.m2.2.2.2.2.1.1.2.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.2.2"><apply id="A1.E33.m2.2.2.2.2.1.1.1.1.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1"><times id="A1.E33.m2.2.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.1"></times><apply id="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.2">𝑉</ci><ci id="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.2.3">𝑒</ci></apply><apply id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.2.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.2">𝑐</ci><apply id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.2.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.2">𝐼</ci><ci id="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.1.1.1.3.3.3">𝑆</ci></apply></apply></apply><apply id="A1.E33.m2.2.2.2.2.1.1.2.2.2.cmml" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2"><times id="A1.E33.m2.2.2.2.2.1.1.2.2.2.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.1"></times><ci id="A1.E33.m2.2.2.2.2.1.1.2.2.2.2a.cmml" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.2"><mtext id="A1.E33.m2.2.2.2.2.1.1.2.2.2.2.cmml" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.2">if </mtext></ci><ci id="A1.E33.m2.2.2.2.2.1.1.2.2.2.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.2.2.2.3">𝑖</ci></apply></list><apply id="A1.E33.m2.2.2.2.2.1.1.4.cmml" xref="A1.E33.m2.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="A1.E33.m2.2.2.2.2.1.1.4.1.cmml" xref="A1.E33.m2.2.2.2.2.1.1.4">subscript</csymbol><ci id="A1.E33.m2.2.2.2.2.1.1.4.2.cmml" xref="A1.E33.m2.2.2.2.2.1.1.4.2">𝐼</ci><ci id="A1.E33.m2.2.2.2.2.1.1.4.3.cmml" xref="A1.E33.m2.2.2.2.2.1.1.4.3">𝑆</ci></apply></apply><ci id="A1.E33.m2.2.3.3.1.5a.cmml" xref="A1.E33.m2.2.2a"><mtext class="ltx_mathvariant_italic" id="A1.E33.m2.2.3.3.1.5.cmml" xref="A1.E33.m2.2.2a.3">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E33.m2.2c">\displaystyle=\begin{cases}-\infty,\text{if }i\in I_{S}\\
V_{e}c_{I_{S}},\text{if }i\not\in I_{S}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="A1.E33.m2.2d">= { start_ROW start_CELL - ∞ , if italic_i ∈ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_CELL start_CELL end_CELL end_ROW start_ROW start_CELL italic_V start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_POSTSUBSCRIPT , if italic_i ∉ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_CELL start_CELL end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td>
</tr></tbody>
<tbody id="A1.E34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{P}(i|I_{S},e)" class="ltx_Math" display="inline" id="A1.E34.m1.2"><semantics id="A1.E34.m1.2a"><mrow id="A1.E34.m1.2.2" xref="A1.E34.m1.2.2.cmml"><mi id="A1.E34.m1.2.2.3" xref="A1.E34.m1.2.2.3.cmml">𝐏</mi><mo id="A1.E34.m1.2.2.2" xref="A1.E34.m1.2.2.2.cmml">⁢</mo><mrow id="A1.E34.m1.2.2.1.1" xref="A1.E34.m1.2.2.1.1.1.cmml"><mo id="A1.E34.m1.2.2.1.1.2" stretchy="false" xref="A1.E34.m1.2.2.1.1.1.cmml">(</mo><mrow id="A1.E34.m1.2.2.1.1.1" xref="A1.E34.m1.2.2.1.1.1.cmml"><mi id="A1.E34.m1.2.2.1.1.1.3" xref="A1.E34.m1.2.2.1.1.1.3.cmml">i</mi><mo fence="false" id="A1.E34.m1.2.2.1.1.1.2" xref="A1.E34.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="A1.E34.m1.2.2.1.1.1.1.1" xref="A1.E34.m1.2.2.1.1.1.1.2.cmml"><msub id="A1.E34.m1.2.2.1.1.1.1.1.1" xref="A1.E34.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A1.E34.m1.2.2.1.1.1.1.1.1.2" xref="A1.E34.m1.2.2.1.1.1.1.1.1.2.cmml">I</mi><mi id="A1.E34.m1.2.2.1.1.1.1.1.1.3" xref="A1.E34.m1.2.2.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="A1.E34.m1.2.2.1.1.1.1.1.2" xref="A1.E34.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="A1.E34.m1.1.1" xref="A1.E34.m1.1.1.cmml">e</mi></mrow></mrow><mo id="A1.E34.m1.2.2.1.1.3" stretchy="false" xref="A1.E34.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E34.m1.2b"><apply id="A1.E34.m1.2.2.cmml" xref="A1.E34.m1.2.2"><times id="A1.E34.m1.2.2.2.cmml" xref="A1.E34.m1.2.2.2"></times><ci id="A1.E34.m1.2.2.3.cmml" xref="A1.E34.m1.2.2.3">𝐏</ci><apply id="A1.E34.m1.2.2.1.1.1.cmml" xref="A1.E34.m1.2.2.1.1"><csymbol cd="latexml" id="A1.E34.m1.2.2.1.1.1.2.cmml" xref="A1.E34.m1.2.2.1.1.1.2">conditional</csymbol><ci id="A1.E34.m1.2.2.1.1.1.3.cmml" xref="A1.E34.m1.2.2.1.1.1.3">𝑖</ci><list id="A1.E34.m1.2.2.1.1.1.1.2.cmml" xref="A1.E34.m1.2.2.1.1.1.1.1"><apply id="A1.E34.m1.2.2.1.1.1.1.1.1.cmml" xref="A1.E34.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E34.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E34.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E34.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E34.m1.2.2.1.1.1.1.1.1.2">𝐼</ci><ci id="A1.E34.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E34.m1.2.2.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="A1.E34.m1.1.1.cmml" xref="A1.E34.m1.1.1">𝑒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E34.m1.2c">\displaystyle\mathbf{P}(i|I_{S},e)</annotation><annotation encoding="application/x-llamapun" id="A1.E34.m1.2d">bold_P ( italic_i | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT , italic_e )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{softmax}(f_{i})" class="ltx_Math" display="inline" id="A1.E34.m2.1"><semantics id="A1.E34.m2.1a"><mrow id="A1.E34.m2.1.1" xref="A1.E34.m2.1.1.cmml"><mi id="A1.E34.m2.1.1.3" xref="A1.E34.m2.1.1.3.cmml"></mi><mo id="A1.E34.m2.1.1.2" xref="A1.E34.m2.1.1.2.cmml">=</mo><mrow id="A1.E34.m2.1.1.1" xref="A1.E34.m2.1.1.1.cmml"><mtext id="A1.E34.m2.1.1.1.3" xref="A1.E34.m2.1.1.1.3a.cmml">softmax</mtext><mo id="A1.E34.m2.1.1.1.2" xref="A1.E34.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E34.m2.1.1.1.1.1" xref="A1.E34.m2.1.1.1.1.1.1.cmml"><mo id="A1.E34.m2.1.1.1.1.1.2" stretchy="false" xref="A1.E34.m2.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E34.m2.1.1.1.1.1.1" xref="A1.E34.m2.1.1.1.1.1.1.cmml"><mi id="A1.E34.m2.1.1.1.1.1.1.2" xref="A1.E34.m2.1.1.1.1.1.1.2.cmml">f</mi><mi id="A1.E34.m2.1.1.1.1.1.1.3" xref="A1.E34.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E34.m2.1.1.1.1.1.3" stretchy="false" xref="A1.E34.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E34.m2.1b"><apply id="A1.E34.m2.1.1.cmml" xref="A1.E34.m2.1.1"><eq id="A1.E34.m2.1.1.2.cmml" xref="A1.E34.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.E34.m2.1.1.3.cmml" xref="A1.E34.m2.1.1.3">absent</csymbol><apply id="A1.E34.m2.1.1.1.cmml" xref="A1.E34.m2.1.1.1"><times id="A1.E34.m2.1.1.1.2.cmml" xref="A1.E34.m2.1.1.1.2"></times><ci id="A1.E34.m2.1.1.1.3a.cmml" xref="A1.E34.m2.1.1.1.3"><mtext id="A1.E34.m2.1.1.1.3.cmml" xref="A1.E34.m2.1.1.1.3">softmax</mtext></ci><apply id="A1.E34.m2.1.1.1.1.1.1.cmml" xref="A1.E34.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E34.m2.1.1.1.1.1.1.1.cmml" xref="A1.E34.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.E34.m2.1.1.1.1.1.1.2.cmml" xref="A1.E34.m2.1.1.1.1.1.1.2">𝑓</ci><ci id="A1.E34.m2.1.1.1.1.1.1.3.cmml" xref="A1.E34.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E34.m2.1c">\displaystyle=\text{softmax}(f_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.E34.m2.1d">= softmax ( italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS1.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.1.5 </span>Repeat-explore loss</h4>
<div class="ltx_para" id="A1.SS1.SSS5.p1">
<p class="ltx_p" id="A1.SS1.SSS5.p1.1">In training the RepeatNet, the team not only uses the normal negative log-likelihood loss function but also adds an explore-repeat loss to facilitate the learning of when to switch the explore mode or repeat mode. Mathematically, we define the negative log-likelihood loss as</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS5.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx15">
<tbody id="A1.E35"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{\text{normal}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}\sum_{I_{S}%
\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\log(\mathbf{P}(i_{r}|I_{S}[:r-1]))" class="ltx_math_unparsed" display="inline" id="A1.E35.m1.3"><semantics id="A1.E35.m1.3a"><mrow id="A1.E35.m1.3b"><msub id="A1.E35.m1.3.4"><mi id="A1.E35.m1.3.4.2">L</mi><mtext id="A1.E35.m1.3.4.3">normal</mtext></msub><mrow id="A1.E35.m1.3.5"><mo id="A1.E35.m1.3.5.1" stretchy="false">(</mo><mi id="A1.E35.m1.3.3">θ</mi><mo id="A1.E35.m1.3.5.2" stretchy="false">)</mo></mrow><mo id="A1.E35.m1.3.6" rspace="0em">=</mo><mo id="A1.E35.m1.3.7" lspace="0em">−</mo><mstyle displaystyle="true" id="A1.E35.m1.1.1"><mfrac id="A1.E35.m1.1.1a"><mn id="A1.E35.m1.1.1.3">1</mn><mrow id="A1.E35.m1.1.1.1.1"><mo id="A1.E35.m1.1.1.1.1.2" stretchy="false">|</mo><msub id="A1.E35.m1.1.1.1.1.1"><mi id="A1.E35.m1.1.1.1.1.1.2">𝕀</mi><mi id="A1.E35.m1.1.1.1.1.1.3">𝕊</mi></msub><mo id="A1.E35.m1.1.1.1.1.3" stretchy="false">|</mo></mrow></mfrac></mstyle><mstyle displaystyle="true" id="A1.E35.m1.3.8"><munder id="A1.E35.m1.3.8a"><mo id="A1.E35.m1.3.8.2" movablelimits="false">∑</mo><mrow id="A1.E35.m1.3.8.3"><msub id="A1.E35.m1.3.8.3.2"><mi id="A1.E35.m1.3.8.3.2.2">I</mi><mi id="A1.E35.m1.3.8.3.2.3">S</mi></msub><mo id="A1.E35.m1.3.8.3.1">∈</mo><msub id="A1.E35.m1.3.8.3.3"><mi id="A1.E35.m1.3.8.3.3.2">𝕀</mi><mi id="A1.E35.m1.3.8.3.3.3">𝕊</mi></msub></mrow></munder></mstyle><mstyle displaystyle="true" id="A1.E35.m1.3.9"><munderover id="A1.E35.m1.3.9a"><mo id="A1.E35.m1.3.9.2.2" movablelimits="false">∑</mo><mrow id="A1.E35.m1.3.9.2.3"><mi id="A1.E35.m1.3.9.2.3.2">r</mi><mo id="A1.E35.m1.3.9.2.3.1">=</mo><mn id="A1.E35.m1.3.9.2.3.3">2</mn></mrow><mrow id="A1.E35.m1.2.2.1.1"><mo id="A1.E35.m1.2.2.1.1.2" stretchy="false">|</mo><msub id="A1.E35.m1.2.2.1.1.1"><mi id="A1.E35.m1.2.2.1.1.1.2">I</mi><mi id="A1.E35.m1.2.2.1.1.1.3">S</mi></msub><mo id="A1.E35.m1.2.2.1.1.3" stretchy="false">|</mo></mrow></munderover></mstyle><mi id="A1.E35.m1.3.10">log</mi><mrow id="A1.E35.m1.3.11"><mo id="A1.E35.m1.3.11.1" stretchy="false">(</mo><mi id="A1.E35.m1.3.11.2">𝐏</mi><mrow id="A1.E35.m1.3.11.3"><mo id="A1.E35.m1.3.11.3.1" stretchy="false">(</mo><msub id="A1.E35.m1.3.11.3.2"><mi id="A1.E35.m1.3.11.3.2.2">i</mi><mi id="A1.E35.m1.3.11.3.2.3">r</mi></msub><mo fence="false" id="A1.E35.m1.3.11.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E35.m1.3.11.3.4"><mi id="A1.E35.m1.3.11.3.4.2">I</mi><mi id="A1.E35.m1.3.11.3.4.3">S</mi></msub><mrow id="A1.E35.m1.3.11.3.5"><mo id="A1.E35.m1.3.11.3.5.1" stretchy="false">[</mo><mo id="A1.E35.m1.3.11.3.5.2" rspace="0.278em">:</mo><mi id="A1.E35.m1.3.11.3.5.3">r</mi><mo id="A1.E35.m1.3.11.3.5.4">−</mo><mn id="A1.E35.m1.3.11.3.5.5">1</mn><mo id="A1.E35.m1.3.11.3.5.6" stretchy="false">]</mo></mrow><mo id="A1.E35.m1.3.11.3.6" stretchy="false">)</mo></mrow><mo id="A1.E35.m1.3.11.4" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E35.m1.3c">\displaystyle L_{\text{normal}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}\sum_{I_{S}%
\in\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\log(\mathbf{P}(i_{r}|I_{S}[:r-1]))</annotation><annotation encoding="application/x-llamapun" id="A1.E35.m1.3d">italic_L start_POSTSUBSCRIPT normal end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG | blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ∈ blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_r = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT roman_log ( bold_P ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ : italic_r - 1 ] ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(35)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.SSS5.p3">
<p class="ltx_p" id="A1.SS1.SSS5.p3.3">where <math alttext="I_{S}[:r-1]" class="ltx_math_unparsed" display="inline" id="A1.SS1.SSS5.p3.1.m1.1"><semantics id="A1.SS1.SSS5.p3.1.m1.1a"><mrow id="A1.SS1.SSS5.p3.1.m1.1b"><msub id="A1.SS1.SSS5.p3.1.m1.1.1"><mi id="A1.SS1.SSS5.p3.1.m1.1.1.2">I</mi><mi id="A1.SS1.SSS5.p3.1.m1.1.1.3">S</mi></msub><mrow id="A1.SS1.SSS5.p3.1.m1.1.2"><mo id="A1.SS1.SSS5.p3.1.m1.1.2.1" stretchy="false">[</mo><mo id="A1.SS1.SSS5.p3.1.m1.1.2.2" rspace="0.278em">:</mo><mi id="A1.SS1.SSS5.p3.1.m1.1.2.3">r</mi><mo id="A1.SS1.SSS5.p3.1.m1.1.2.4">−</mo><mn id="A1.SS1.SSS5.p3.1.m1.1.2.5">1</mn><mo id="A1.SS1.SSS5.p3.1.m1.1.2.6" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p3.1.m1.1c">I_{S}[:r-1]</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p3.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ : italic_r - 1 ]</annotation></semantics></math> represents the first <math alttext="r-1" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p3.2.m2.1"><semantics id="A1.SS1.SSS5.p3.2.m2.1a"><mrow id="A1.SS1.SSS5.p3.2.m2.1.1" xref="A1.SS1.SSS5.p3.2.m2.1.1.cmml"><mi id="A1.SS1.SSS5.p3.2.m2.1.1.2" xref="A1.SS1.SSS5.p3.2.m2.1.1.2.cmml">r</mi><mo id="A1.SS1.SSS5.p3.2.m2.1.1.1" xref="A1.SS1.SSS5.p3.2.m2.1.1.1.cmml">−</mo><mn id="A1.SS1.SSS5.p3.2.m2.1.1.3" xref="A1.SS1.SSS5.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p3.2.m2.1b"><apply id="A1.SS1.SSS5.p3.2.m2.1.1.cmml" xref="A1.SS1.SSS5.p3.2.m2.1.1"><minus id="A1.SS1.SSS5.p3.2.m2.1.1.1.cmml" xref="A1.SS1.SSS5.p3.2.m2.1.1.1"></minus><ci id="A1.SS1.SSS5.p3.2.m2.1.1.2.cmml" xref="A1.SS1.SSS5.p3.2.m2.1.1.2">𝑟</ci><cn id="A1.SS1.SSS5.p3.2.m2.1.1.3.cmml" type="integer" xref="A1.SS1.SSS5.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p3.2.m2.1c">r-1</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p3.2.m2.1d">italic_r - 1</annotation></semantics></math> items of session <math alttext="I_{S}" class="ltx_Math" display="inline" id="A1.SS1.SSS5.p3.3.m3.1"><semantics id="A1.SS1.SSS5.p3.3.m3.1a"><msub id="A1.SS1.SSS5.p3.3.m3.1.1" xref="A1.SS1.SSS5.p3.3.m3.1.1.cmml"><mi id="A1.SS1.SSS5.p3.3.m3.1.1.2" xref="A1.SS1.SSS5.p3.3.m3.1.1.2.cmml">I</mi><mi id="A1.SS1.SSS5.p3.3.m3.1.1.3" xref="A1.SS1.SSS5.p3.3.m3.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS5.p3.3.m3.1b"><apply id="A1.SS1.SSS5.p3.3.m3.1.1.cmml" xref="A1.SS1.SSS5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS5.p3.3.m3.1.1.1.cmml" xref="A1.SS1.SSS5.p3.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.SSS5.p3.3.m3.1.1.2.cmml" xref="A1.SS1.SSS5.p3.3.m3.1.1.2">𝐼</ci><ci id="A1.SS1.SSS5.p3.3.m3.1.1.3.cmml" xref="A1.SS1.SSS5.p3.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS5.p3.3.m3.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.SSS5.p3.3.m3.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>, and the repeat-explore loss as</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS5.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx16">
<tbody id="A1.E36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{\text{r-e}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}\sum_{I_{S}\in%
\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\mathbbm{1}(i_{r}\in I_{S}[:r-1])\log(%
\mathbf{P}(r|I_{S}[:r-1]))+\mathbbm{1}(i_{r}\not\in I_{S}[:r-1])\log(\mathbf{P%
}(e|I_{S}[:r-1]))" class="ltx_math_unparsed" display="inline" id="A1.E36.m1.3"><semantics id="A1.E36.m1.3a"><mrow id="A1.E36.m1.3b"><msub id="A1.E36.m1.3.4"><mi id="A1.E36.m1.3.4.2">L</mi><mtext id="A1.E36.m1.3.4.3">r-e</mtext></msub><mrow id="A1.E36.m1.3.5"><mo id="A1.E36.m1.3.5.1" stretchy="false">(</mo><mi id="A1.E36.m1.3.3">θ</mi><mo id="A1.E36.m1.3.5.2" stretchy="false">)</mo></mrow><mo id="A1.E36.m1.3.6" rspace="0em">=</mo><mo id="A1.E36.m1.3.7" lspace="0em">−</mo><mstyle displaystyle="true" id="A1.E36.m1.1.1"><mfrac id="A1.E36.m1.1.1a"><mn id="A1.E36.m1.1.1.3">1</mn><mrow id="A1.E36.m1.1.1.1.1"><mo id="A1.E36.m1.1.1.1.1.2" stretchy="false">|</mo><msub id="A1.E36.m1.1.1.1.1.1"><mi id="A1.E36.m1.1.1.1.1.1.2">𝕀</mi><mi id="A1.E36.m1.1.1.1.1.1.3">𝕊</mi></msub><mo id="A1.E36.m1.1.1.1.1.3" stretchy="false">|</mo></mrow></mfrac></mstyle><mstyle displaystyle="true" id="A1.E36.m1.3.8"><munder id="A1.E36.m1.3.8a"><mo id="A1.E36.m1.3.8.2" movablelimits="false">∑</mo><mrow id="A1.E36.m1.3.8.3"><msub id="A1.E36.m1.3.8.3.2"><mi id="A1.E36.m1.3.8.3.2.2">I</mi><mi id="A1.E36.m1.3.8.3.2.3">S</mi></msub><mo id="A1.E36.m1.3.8.3.1">∈</mo><msub id="A1.E36.m1.3.8.3.3"><mi id="A1.E36.m1.3.8.3.3.2">𝕀</mi><mi id="A1.E36.m1.3.8.3.3.3">𝕊</mi></msub></mrow></munder></mstyle><mstyle displaystyle="true" id="A1.E36.m1.3.9"><munderover id="A1.E36.m1.3.9a"><mo id="A1.E36.m1.3.9.2.2" movablelimits="false">∑</mo><mrow id="A1.E36.m1.3.9.2.3"><mi id="A1.E36.m1.3.9.2.3.2">r</mi><mo id="A1.E36.m1.3.9.2.3.1">=</mo><mn id="A1.E36.m1.3.9.2.3.3">2</mn></mrow><mrow id="A1.E36.m1.2.2.1.1"><mo id="A1.E36.m1.2.2.1.1.2" stretchy="false">|</mo><msub id="A1.E36.m1.2.2.1.1.1"><mi id="A1.E36.m1.2.2.1.1.1.2">I</mi><mi id="A1.E36.m1.2.2.1.1.1.3">S</mi></msub><mo id="A1.E36.m1.2.2.1.1.3" stretchy="false">|</mo></mrow></munderover></mstyle><mn id="A1.E36.m1.3.10">𝟙</mn><mrow id="A1.E36.m1.3.11"><mo id="A1.E36.m1.3.11.1" stretchy="false">(</mo><msub id="A1.E36.m1.3.11.2"><mi id="A1.E36.m1.3.11.2.2">i</mi><mi id="A1.E36.m1.3.11.2.3">r</mi></msub><mo id="A1.E36.m1.3.11.3">∈</mo><msub id="A1.E36.m1.3.11.4"><mi id="A1.E36.m1.3.11.4.2">I</mi><mi id="A1.E36.m1.3.11.4.3">S</mi></msub><mrow id="A1.E36.m1.3.11.5"><mo id="A1.E36.m1.3.11.5.1" stretchy="false">[</mo><mo id="A1.E36.m1.3.11.5.2" rspace="0.278em">:</mo><mi id="A1.E36.m1.3.11.5.3">r</mi><mo id="A1.E36.m1.3.11.5.4">−</mo><mn id="A1.E36.m1.3.11.5.5">1</mn><mo id="A1.E36.m1.3.11.5.6" stretchy="false">]</mo></mrow><mo id="A1.E36.m1.3.11.6" rspace="0.167em" stretchy="false">)</mo></mrow><mi id="A1.E36.m1.3.12">log</mi><mrow id="A1.E36.m1.3.13"><mo id="A1.E36.m1.3.13.1" stretchy="false">(</mo><mi id="A1.E36.m1.3.13.2">𝐏</mi><mrow id="A1.E36.m1.3.13.3"><mo id="A1.E36.m1.3.13.3.1" stretchy="false">(</mo><mi id="A1.E36.m1.3.13.3.2">r</mi><mo fence="false" id="A1.E36.m1.3.13.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E36.m1.3.13.3.4"><mi id="A1.E36.m1.3.13.3.4.2">I</mi><mi id="A1.E36.m1.3.13.3.4.3">S</mi></msub><mrow id="A1.E36.m1.3.13.3.5"><mo id="A1.E36.m1.3.13.3.5.1" stretchy="false">[</mo><mo id="A1.E36.m1.3.13.3.5.2" rspace="0.278em">:</mo><mi id="A1.E36.m1.3.13.3.5.3">r</mi><mo id="A1.E36.m1.3.13.3.5.4">−</mo><mn id="A1.E36.m1.3.13.3.5.5">1</mn><mo id="A1.E36.m1.3.13.3.5.6" stretchy="false">]</mo></mrow><mo id="A1.E36.m1.3.13.3.6" stretchy="false">)</mo></mrow><mo id="A1.E36.m1.3.13.4" stretchy="false">)</mo></mrow><mo id="A1.E36.m1.3.14">+</mo><mn id="A1.E36.m1.3.15">𝟙</mn><mrow id="A1.E36.m1.3.16"><mo id="A1.E36.m1.3.16.1" stretchy="false">(</mo><msub id="A1.E36.m1.3.16.2"><mi id="A1.E36.m1.3.16.2.2">i</mi><mi id="A1.E36.m1.3.16.2.3">r</mi></msub><mo id="A1.E36.m1.3.16.3">∉</mo><msub id="A1.E36.m1.3.16.4"><mi id="A1.E36.m1.3.16.4.2">I</mi><mi id="A1.E36.m1.3.16.4.3">S</mi></msub><mrow id="A1.E36.m1.3.16.5"><mo id="A1.E36.m1.3.16.5.1" stretchy="false">[</mo><mo id="A1.E36.m1.3.16.5.2" rspace="0.278em">:</mo><mi id="A1.E36.m1.3.16.5.3">r</mi><mo id="A1.E36.m1.3.16.5.4">−</mo><mn id="A1.E36.m1.3.16.5.5">1</mn><mo id="A1.E36.m1.3.16.5.6" stretchy="false">]</mo></mrow><mo id="A1.E36.m1.3.16.6" rspace="0.167em" stretchy="false">)</mo></mrow><mi id="A1.E36.m1.3.17">log</mi><mrow id="A1.E36.m1.3.18"><mo id="A1.E36.m1.3.18.1" stretchy="false">(</mo><mi id="A1.E36.m1.3.18.2">𝐏</mi><mrow id="A1.E36.m1.3.18.3"><mo id="A1.E36.m1.3.18.3.1" stretchy="false">(</mo><mi id="A1.E36.m1.3.18.3.2">e</mi><mo fence="false" id="A1.E36.m1.3.18.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E36.m1.3.18.3.4"><mi id="A1.E36.m1.3.18.3.4.2">I</mi><mi id="A1.E36.m1.3.18.3.4.3">S</mi></msub><mrow id="A1.E36.m1.3.18.3.5"><mo id="A1.E36.m1.3.18.3.5.1" stretchy="false">[</mo><mo id="A1.E36.m1.3.18.3.5.2" rspace="0.278em">:</mo><mi id="A1.E36.m1.3.18.3.5.3">r</mi><mo id="A1.E36.m1.3.18.3.5.4">−</mo><mn id="A1.E36.m1.3.18.3.5.5">1</mn><mo id="A1.E36.m1.3.18.3.5.6" stretchy="false">]</mo></mrow><mo id="A1.E36.m1.3.18.3.6" stretchy="false">)</mo></mrow><mo id="A1.E36.m1.3.18.4" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E36.m1.3c">\displaystyle L_{\text{r-e}}(\theta)=-\frac{1}{|\mathbb{I_{S}}|}\sum_{I_{S}\in%
\mathbb{I_{S}}}\sum_{r=2}^{|I_{S}|}\mathbbm{1}(i_{r}\in I_{S}[:r-1])\log(%
\mathbf{P}(r|I_{S}[:r-1]))+\mathbbm{1}(i_{r}\not\in I_{S}[:r-1])\log(\mathbf{P%
}(e|I_{S}[:r-1]))</annotation><annotation encoding="application/x-llamapun" id="A1.E36.m1.3d">italic_L start_POSTSUBSCRIPT r-e end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG | blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT ∈ blackboard_I start_POSTSUBSCRIPT blackboard_S end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_r = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT blackboard_1 ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∈ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ : italic_r - 1 ] ) roman_log ( bold_P ( italic_r | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ : italic_r - 1 ] ) ) + blackboard_1 ( italic_i start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∉ italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ : italic_r - 1 ] ) roman_log ( bold_P ( italic_e | italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT [ : italic_r - 1 ] ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(36)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.SSS5.p4.1">and the final loss function objective is defined as</p>
</div>
<div class="ltx_para" id="A1.SS1.SSS5.p5">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx17">
<tbody id="A1.E37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L(\theta)=L_{\text{normal}}(\theta)+L_{\text{r-e}}(\theta)" class="ltx_Math" display="inline" id="A1.E37.m1.3"><semantics id="A1.E37.m1.3a"><mrow id="A1.E37.m1.3.4" xref="A1.E37.m1.3.4.cmml"><mrow id="A1.E37.m1.3.4.2" xref="A1.E37.m1.3.4.2.cmml"><mi id="A1.E37.m1.3.4.2.2" xref="A1.E37.m1.3.4.2.2.cmml">L</mi><mo id="A1.E37.m1.3.4.2.1" xref="A1.E37.m1.3.4.2.1.cmml">⁢</mo><mrow id="A1.E37.m1.3.4.2.3.2" xref="A1.E37.m1.3.4.2.cmml"><mo id="A1.E37.m1.3.4.2.3.2.1" stretchy="false" xref="A1.E37.m1.3.4.2.cmml">(</mo><mi id="A1.E37.m1.1.1" xref="A1.E37.m1.1.1.cmml">θ</mi><mo id="A1.E37.m1.3.4.2.3.2.2" stretchy="false" xref="A1.E37.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="A1.E37.m1.3.4.1" xref="A1.E37.m1.3.4.1.cmml">=</mo><mrow id="A1.E37.m1.3.4.3" xref="A1.E37.m1.3.4.3.cmml"><mrow id="A1.E37.m1.3.4.3.2" xref="A1.E37.m1.3.4.3.2.cmml"><msub id="A1.E37.m1.3.4.3.2.2" xref="A1.E37.m1.3.4.3.2.2.cmml"><mi id="A1.E37.m1.3.4.3.2.2.2" xref="A1.E37.m1.3.4.3.2.2.2.cmml">L</mi><mtext id="A1.E37.m1.3.4.3.2.2.3" xref="A1.E37.m1.3.4.3.2.2.3a.cmml">normal</mtext></msub><mo id="A1.E37.m1.3.4.3.2.1" xref="A1.E37.m1.3.4.3.2.1.cmml">⁢</mo><mrow id="A1.E37.m1.3.4.3.2.3.2" xref="A1.E37.m1.3.4.3.2.cmml"><mo id="A1.E37.m1.3.4.3.2.3.2.1" stretchy="false" xref="A1.E37.m1.3.4.3.2.cmml">(</mo><mi id="A1.E37.m1.2.2" xref="A1.E37.m1.2.2.cmml">θ</mi><mo id="A1.E37.m1.3.4.3.2.3.2.2" stretchy="false" xref="A1.E37.m1.3.4.3.2.cmml">)</mo></mrow></mrow><mo id="A1.E37.m1.3.4.3.1" xref="A1.E37.m1.3.4.3.1.cmml">+</mo><mrow id="A1.E37.m1.3.4.3.3" xref="A1.E37.m1.3.4.3.3.cmml"><msub id="A1.E37.m1.3.4.3.3.2" xref="A1.E37.m1.3.4.3.3.2.cmml"><mi id="A1.E37.m1.3.4.3.3.2.2" xref="A1.E37.m1.3.4.3.3.2.2.cmml">L</mi><mtext id="A1.E37.m1.3.4.3.3.2.3" xref="A1.E37.m1.3.4.3.3.2.3a.cmml">r-e</mtext></msub><mo id="A1.E37.m1.3.4.3.3.1" xref="A1.E37.m1.3.4.3.3.1.cmml">⁢</mo><mrow id="A1.E37.m1.3.4.3.3.3.2" xref="A1.E37.m1.3.4.3.3.cmml"><mo id="A1.E37.m1.3.4.3.3.3.2.1" stretchy="false" xref="A1.E37.m1.3.4.3.3.cmml">(</mo><mi id="A1.E37.m1.3.3" xref="A1.E37.m1.3.3.cmml">θ</mi><mo id="A1.E37.m1.3.4.3.3.3.2.2" stretchy="false" xref="A1.E37.m1.3.4.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E37.m1.3b"><apply id="A1.E37.m1.3.4.cmml" xref="A1.E37.m1.3.4"><eq id="A1.E37.m1.3.4.1.cmml" xref="A1.E37.m1.3.4.1"></eq><apply id="A1.E37.m1.3.4.2.cmml" xref="A1.E37.m1.3.4.2"><times id="A1.E37.m1.3.4.2.1.cmml" xref="A1.E37.m1.3.4.2.1"></times><ci id="A1.E37.m1.3.4.2.2.cmml" xref="A1.E37.m1.3.4.2.2">𝐿</ci><ci id="A1.E37.m1.1.1.cmml" xref="A1.E37.m1.1.1">𝜃</ci></apply><apply id="A1.E37.m1.3.4.3.cmml" xref="A1.E37.m1.3.4.3"><plus id="A1.E37.m1.3.4.3.1.cmml" xref="A1.E37.m1.3.4.3.1"></plus><apply id="A1.E37.m1.3.4.3.2.cmml" xref="A1.E37.m1.3.4.3.2"><times id="A1.E37.m1.3.4.3.2.1.cmml" xref="A1.E37.m1.3.4.3.2.1"></times><apply id="A1.E37.m1.3.4.3.2.2.cmml" xref="A1.E37.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="A1.E37.m1.3.4.3.2.2.1.cmml" xref="A1.E37.m1.3.4.3.2.2">subscript</csymbol><ci id="A1.E37.m1.3.4.3.2.2.2.cmml" xref="A1.E37.m1.3.4.3.2.2.2">𝐿</ci><ci id="A1.E37.m1.3.4.3.2.2.3a.cmml" xref="A1.E37.m1.3.4.3.2.2.3"><mtext id="A1.E37.m1.3.4.3.2.2.3.cmml" mathsize="70%" xref="A1.E37.m1.3.4.3.2.2.3">normal</mtext></ci></apply><ci id="A1.E37.m1.2.2.cmml" xref="A1.E37.m1.2.2">𝜃</ci></apply><apply id="A1.E37.m1.3.4.3.3.cmml" xref="A1.E37.m1.3.4.3.3"><times id="A1.E37.m1.3.4.3.3.1.cmml" xref="A1.E37.m1.3.4.3.3.1"></times><apply id="A1.E37.m1.3.4.3.3.2.cmml" xref="A1.E37.m1.3.4.3.3.2"><csymbol cd="ambiguous" id="A1.E37.m1.3.4.3.3.2.1.cmml" xref="A1.E37.m1.3.4.3.3.2">subscript</csymbol><ci id="A1.E37.m1.3.4.3.3.2.2.cmml" xref="A1.E37.m1.3.4.3.3.2.2">𝐿</ci><ci id="A1.E37.m1.3.4.3.3.2.3a.cmml" xref="A1.E37.m1.3.4.3.3.2.3"><mtext id="A1.E37.m1.3.4.3.3.2.3.cmml" mathsize="70%" xref="A1.E37.m1.3.4.3.3.2.3">r-e</mtext></ci></apply><ci id="A1.E37.m1.3.3.cmml" xref="A1.E37.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E37.m1.3c">\displaystyle L(\theta)=L_{\text{normal}}(\theta)+L_{\text{r-e}}(\theta)</annotation><annotation encoding="application/x-llamapun" id="A1.E37.m1.3d">italic_L ( italic_θ ) = italic_L start_POSTSUBSCRIPT normal end_POSTSUBSCRIPT ( italic_θ ) + italic_L start_POSTSUBSCRIPT r-e end_POSTSUBSCRIPT ( italic_θ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(37)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>SR-GNN Architecture</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">For SR-GNN, we follow the implementation of <cite class="ltx_cite ltx_citemacro_cite">Wu et al. [<a class="ltx_ref" href="https://arxiv.org/html/2406.00615v1#bib.bib5" title="">2019</a>]</cite>. SR-GNN aims to generate precise item embeddings while taking complex transitions of items into account, where sessions will be modeled as graph structures and items will be modeled as nodes, allowing automatic extraction of features with respect to node connections. The model uses an attention network to represent each session’s long-term interest, and each session is represented as the combination of long-term interest and current interest. It then uses session embeddings created from latent vectors of items to generate recommendations. Their design can be summarized into 4 components:</p>
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i1.p1">
<p class="ltx_p" id="A1.I2.i1.p1.1">Construct session graphs</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i2.p1">
<p class="ltx_p" id="A1.I2.i2.p1.1">Learn item embeddings of session graphs</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i3.p1">
<p class="ltx_p" id="A1.I2.i3.p1.1">Generate session embeddings</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I2.i4.p1">
<p class="ltx_p" id="A1.I2.i4.p1.1">Make recommendations</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Construct session graphs</h4>
<div class="ltx_para" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.7">SR-GNN uses a directed graph <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.1.m1.1"><semantics id="A1.SS2.SSS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p1.1.m1.1.1" xref="A1.SS2.SSS1.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.1.m1.1b"><ci id="A1.SS2.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS1.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.1.m1.1d">caligraphic_G</annotation></semantics></math> to model each session, where items are represented as nodes of the graph. User interactions as click or purchases are represented as edges, where edge <math alttext="(\mathcal{V}_{s,i-1},\mathcal{V}_{s,i})\in\mathcal{G}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.2.m2.6"><semantics id="A1.SS2.SSS1.p1.2.m2.6a"><mrow id="A1.SS2.SSS1.p1.2.m2.6.6" xref="A1.SS2.SSS1.p1.2.m2.6.6.cmml"><mrow id="A1.SS2.SSS1.p1.2.m2.6.6.2.2" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.3.cmml"><mo id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.3" stretchy="false" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.3.cmml">(</mo><msub id="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1" xref="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1.2" xref="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1.2.cmml">𝒱</mi><mrow id="A1.SS2.SSS1.p1.2.m2.2.2.2.2" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.3.cmml"><mi id="A1.SS2.SSS1.p1.2.m2.1.1.1.1" xref="A1.SS2.SSS1.p1.2.m2.1.1.1.1.cmml">s</mi><mo id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.2" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.3.cmml">,</mo><mrow id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.cmml"><mi id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.2" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.cmml">i</mi><mo id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.1" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.1.cmml">−</mo><mn id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.3" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.4" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.3.cmml">,</mo><msub id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2.2" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2.2.cmml">𝒱</mi><mrow id="A1.SS2.SSS1.p1.2.m2.4.4.2.4" xref="A1.SS2.SSS1.p1.2.m2.4.4.2.3.cmml"><mi id="A1.SS2.SSS1.p1.2.m2.3.3.1.1" xref="A1.SS2.SSS1.p1.2.m2.3.3.1.1.cmml">s</mi><mo id="A1.SS2.SSS1.p1.2.m2.4.4.2.4.1" xref="A1.SS2.SSS1.p1.2.m2.4.4.2.3.cmml">,</mo><mi id="A1.SS2.SSS1.p1.2.m2.4.4.2.2" xref="A1.SS2.SSS1.p1.2.m2.4.4.2.2.cmml">i</mi></mrow></msub><mo id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.5" stretchy="false" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.3.cmml">)</mo></mrow><mo id="A1.SS2.SSS1.p1.2.m2.6.6.3" xref="A1.SS2.SSS1.p1.2.m2.6.6.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p1.2.m2.6.6.4" xref="A1.SS2.SSS1.p1.2.m2.6.6.4.cmml">𝒢</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.2.m2.6b"><apply id="A1.SS2.SSS1.p1.2.m2.6.6.cmml" xref="A1.SS2.SSS1.p1.2.m2.6.6"><in id="A1.SS2.SSS1.p1.2.m2.6.6.3.cmml" xref="A1.SS2.SSS1.p1.2.m2.6.6.3"></in><interval closure="open" id="A1.SS2.SSS1.p1.2.m2.6.6.2.3.cmml" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.2"><apply id="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.5.5.1.1.1.2">𝒱</ci><list id="A1.SS2.SSS1.p1.2.m2.2.2.2.3.cmml" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2"><ci id="A1.SS2.SSS1.p1.2.m2.1.1.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.1.1.1.1">𝑠</ci><apply id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1"><minus id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.1"></minus><ci id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.2">𝑖</ci><cn id="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.3.cmml" type="integer" xref="A1.SS2.SSS1.p1.2.m2.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2">subscript</csymbol><ci id="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.6.6.2.2.2.2">𝒱</ci><list id="A1.SS2.SSS1.p1.2.m2.4.4.2.3.cmml" xref="A1.SS2.SSS1.p1.2.m2.4.4.2.4"><ci id="A1.SS2.SSS1.p1.2.m2.3.3.1.1.cmml" xref="A1.SS2.SSS1.p1.2.m2.3.3.1.1">𝑠</ci><ci id="A1.SS2.SSS1.p1.2.m2.4.4.2.2.cmml" xref="A1.SS2.SSS1.p1.2.m2.4.4.2.2">𝑖</ci></list></apply></interval><ci id="A1.SS2.SSS1.p1.2.m2.6.6.4.cmml" xref="A1.SS2.SSS1.p1.2.m2.6.6.4">𝒢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.2.m2.6c">(\mathcal{V}_{s,i-1},\mathcal{V}_{s,i})\in\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.2.m2.6d">( caligraphic_V start_POSTSUBSCRIPT italic_s , italic_i - 1 end_POSTSUBSCRIPT , caligraphic_V start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT ) ∈ caligraphic_G</annotation></semantics></math> <math alttext="\mathcal{E}_{s}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.3.m3.1"><semantics id="A1.SS2.SSS1.p1.3.m3.1a"><msub id="A1.SS2.SSS1.p1.3.m3.1.1" xref="A1.SS2.SSS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS1.p1.3.m3.1.1.2" xref="A1.SS2.SSS1.p1.3.m3.1.1.2.cmml">ℰ</mi><mi id="A1.SS2.SSS1.p1.3.m3.1.1.3" xref="A1.SS2.SSS1.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.3.m3.1b"><apply id="A1.SS2.SSS1.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1.2">ℰ</ci><ci id="A1.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="A1.SS2.SSS1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.3.m3.1c">\mathcal{E}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.3.m3.1d">caligraphic_E start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>
means the user clicked item <math alttext="i-1" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.4.m4.1"><semantics id="A1.SS2.SSS1.p1.4.m4.1a"><mrow id="A1.SS2.SSS1.p1.4.m4.1.1" xref="A1.SS2.SSS1.p1.4.m4.1.1.cmml"><mi id="A1.SS2.SSS1.p1.4.m4.1.1.2" xref="A1.SS2.SSS1.p1.4.m4.1.1.2.cmml">i</mi><mo id="A1.SS2.SSS1.p1.4.m4.1.1.1" xref="A1.SS2.SSS1.p1.4.m4.1.1.1.cmml">−</mo><mn id="A1.SS2.SSS1.p1.4.m4.1.1.3" xref="A1.SS2.SSS1.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.4.m4.1b"><apply id="A1.SS2.SSS1.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1"><minus id="A1.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1.1"></minus><ci id="A1.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="A1.SS2.SSS1.p1.4.m4.1.1.2">𝑖</ci><cn id="A1.SS2.SSS1.p1.4.m4.1.1.3.cmml" type="integer" xref="A1.SS2.SSS1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.4.m4.1c">i-1</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.4.m4.1d">italic_i - 1</annotation></semantics></math> before item <math alttext="i" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.5.m5.1"><semantics id="A1.SS2.SSS1.p1.5.m5.1a"><mi id="A1.SS2.SSS1.p1.5.m5.1.1" xref="A1.SS2.SSS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.5.m5.1b"><ci id="A1.SS2.SSS1.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.5.m5.1d">italic_i</annotation></semantics></math> in the current session <math alttext="s" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.6.m6.1"><semantics id="A1.SS2.SSS1.p1.6.m6.1a"><mi id="A1.SS2.SSS1.p1.6.m6.1.1" xref="A1.SS2.SSS1.p1.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.6.m6.1b"><ci id="A1.SS2.SSS1.p1.6.m6.1.1.cmml" xref="A1.SS2.SSS1.p1.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.6.m6.1c">s</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.6.m6.1d">italic_s</annotation></semantics></math>, such that the transitions of items can be captured by the model. The model normalized the weights of the edges to account for repetitions of items. The weight is calculated by <math alttext="\displaystyle\frac{\textrm{number occurrence of edge}}{\textrm{out degree of %
edge\textquoteright s start node}}" class="ltx_Math" display="inline" id="A1.SS2.SSS1.p1.7.m7.1"><semantics id="A1.SS2.SSS1.p1.7.m7.1a"><mstyle displaystyle="true" id="A1.SS2.SSS1.p1.7.m7.1.1" xref="A1.SS2.SSS1.p1.7.m7.1.1.cmml"><mfrac id="A1.SS2.SSS1.p1.7.m7.1.1a" xref="A1.SS2.SSS1.p1.7.m7.1.1.cmml"><mtext id="A1.SS2.SSS1.p1.7.m7.1.1.2" xref="A1.SS2.SSS1.p1.7.m7.1.1.2a.cmml">number occurrence of edge</mtext><mtext id="A1.SS2.SSS1.p1.7.m7.1.1.3" xref="A1.SS2.SSS1.p1.7.m7.1.1.3a.cmml">out degree of edge’s start node</mtext></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS1.p1.7.m7.1b"><apply id="A1.SS2.SSS1.p1.7.m7.1.1.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1"><divide id="A1.SS2.SSS1.p1.7.m7.1.1.1.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1"></divide><ci id="A1.SS2.SSS1.p1.7.m7.1.1.2a.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.2"><mtext id="A1.SS2.SSS1.p1.7.m7.1.1.2.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.2">number occurrence of edge</mtext></ci><ci id="A1.SS2.SSS1.p1.7.m7.1.1.3a.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.3"><mtext id="A1.SS2.SSS1.p1.7.m7.1.1.3.cmml" xref="A1.SS2.SSS1.p1.7.m7.1.1.3">out degree of edge’s start node</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS1.p1.7.m7.1c">\displaystyle\frac{\textrm{number occurrence of edge}}{\textrm{out degree of %
edge\textquoteright s start node}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS1.p1.7.m7.1d">divide start_ARG number occurrence of edge end_ARG start_ARG out degree of edge’s start node end_ARG</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.2 </span>Learn item embeddings of session graphs</h4>
<div class="ltx_para" id="A1.SS2.SSS2.p1">
<p class="ltx_p" id="A1.SS2.SSS2.p1.11">Each item <math alttext="v\in V" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.1.m1.1"><semantics id="A1.SS2.SSS2.p1.1.m1.1a"><mrow id="A1.SS2.SSS2.p1.1.m1.1.1" xref="A1.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.SSS2.p1.1.m1.1.1.2" xref="A1.SS2.SSS2.p1.1.m1.1.1.2.cmml">v</mi><mo id="A1.SS2.SSS2.p1.1.m1.1.1.1" xref="A1.SS2.SSS2.p1.1.m1.1.1.1.cmml">∈</mo><mi id="A1.SS2.SSS2.p1.1.m1.1.1.3" xref="A1.SS2.SSS2.p1.1.m1.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.1.m1.1b"><apply id="A1.SS2.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1"><in id="A1.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.1"></in><ci id="A1.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.2">𝑣</ci><ci id="A1.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.SSS2.p1.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.1.m1.1c">v\in V</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.1.m1.1d">italic_v ∈ italic_V</annotation></semantics></math> is embedded into a unified space and the node vector <math alttext="\mathbf{v}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.2.m2.1"><semantics id="A1.SS2.SSS2.p1.2.m2.1a"><mrow id="A1.SS2.SSS2.p1.2.m2.1.1" xref="A1.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="A1.SS2.SSS2.p1.2.m2.1.1.2" xref="A1.SS2.SSS2.p1.2.m2.1.1.2.cmml">𝐯</mi><mo id="A1.SS2.SSS2.p1.2.m2.1.1.1" xref="A1.SS2.SSS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="A1.SS2.SSS2.p1.2.m2.1.1.3" xref="A1.SS2.SSS2.p1.2.m2.1.1.3.cmml"><mi id="A1.SS2.SSS2.p1.2.m2.1.1.3.2" xref="A1.SS2.SSS2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="A1.SS2.SSS2.p1.2.m2.1.1.3.3" xref="A1.SS2.SSS2.p1.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.2.m2.1b"><apply id="A1.SS2.SSS2.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1"><in id="A1.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1.1"></in><ci id="A1.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1.2">𝐯</ci><apply id="A1.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.2.m2.1.1.3.1.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.SS2.SSS2.p1.2.m2.1.1.3.2.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1.3.2">ℝ</ci><ci id="A1.SS2.SSS2.p1.2.m2.1.1.3.3.cmml" xref="A1.SS2.SSS2.p1.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.2.m2.1c">\mathbf{v}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.2.m2.1d">bold_v ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> represents the latent vector of item <math alttext="v" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.3.m3.1"><semantics id="A1.SS2.SSS2.p1.3.m3.1a"><mi id="A1.SS2.SSS2.p1.3.m3.1.1" xref="A1.SS2.SSS2.p1.3.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.3.m3.1b"><ci id="A1.SS2.SSS2.p1.3.m3.1.1.cmml" xref="A1.SS2.SSS2.p1.3.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.3.m3.1c">v</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.3.m3.1d">italic_v</annotation></semantics></math> learned through graph neural networks.
For graph <math alttext="\mathcal{G}_{s}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.4.m4.1"><semantics id="A1.SS2.SSS2.p1.4.m4.1a"><msub id="A1.SS2.SSS2.p1.4.m4.1.1" xref="A1.SS2.SSS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS2.p1.4.m4.1.1.2" xref="A1.SS2.SSS2.p1.4.m4.1.1.2.cmml">𝒢</mi><mi id="A1.SS2.SSS2.p1.4.m4.1.1.3" xref="A1.SS2.SSS2.p1.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.4.m4.1b"><apply id="A1.SS2.SSS2.p1.4.m4.1.1.cmml" xref="A1.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="A1.SS2.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="A1.SS2.SSS2.p1.4.m4.1.1.2">𝒢</ci><ci id="A1.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="A1.SS2.SSS2.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.4.m4.1c">\mathcal{G}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.4.m4.1d">caligraphic_G start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> corresponding to session <math alttext="I_{S}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.5.m5.1"><semantics id="A1.SS2.SSS2.p1.5.m5.1a"><msub id="A1.SS2.SSS2.p1.5.m5.1.1" xref="A1.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="A1.SS2.SSS2.p1.5.m5.1.1.2" xref="A1.SS2.SSS2.p1.5.m5.1.1.2.cmml">I</mi><mi id="A1.SS2.SSS2.p1.5.m5.1.1.3" xref="A1.SS2.SSS2.p1.5.m5.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.5.m5.1b"><apply id="A1.SS2.SSS2.p1.5.m5.1.1.cmml" xref="A1.SS2.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="A1.SS2.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="A1.SS2.SSS2.p1.5.m5.1.1.2">𝐼</ci><ci id="A1.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="A1.SS2.SSS2.p1.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.5.m5.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.5.m5.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>, the weight connections of incoming and outgoing edges are represented by matrices <math alttext="A^{(out)}_{s}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.6.m6.1"><semantics id="A1.SS2.SSS2.p1.6.m6.1a"><msubsup id="A1.SS2.SSS2.p1.6.m6.1.2" xref="A1.SS2.SSS2.p1.6.m6.1.2.cmml"><mi id="A1.SS2.SSS2.p1.6.m6.1.2.2.2" xref="A1.SS2.SSS2.p1.6.m6.1.2.2.2.cmml">A</mi><mi id="A1.SS2.SSS2.p1.6.m6.1.2.3" xref="A1.SS2.SSS2.p1.6.m6.1.2.3.cmml">s</mi><mrow id="A1.SS2.SSS2.p1.6.m6.1.1.1.1" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.2" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.2.cmml">o</mi><mo id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.1" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.3" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.3.cmml">u</mi><mo id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.1a" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.4" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.4.cmml">t</mi></mrow><mo id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.6.m6.1b"><apply id="A1.SS2.SSS2.p1.6.m6.1.2.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.6.m6.1.2.1.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.2">subscript</csymbol><apply id="A1.SS2.SSS2.p1.6.m6.1.2.2.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.6.m6.1.2.2.1.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.2">superscript</csymbol><ci id="A1.SS2.SSS2.p1.6.m6.1.2.2.2.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.2.2.2">𝐴</ci><apply id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1"><times id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.1"></times><ci id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.2">𝑜</ci><ci id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.3">𝑢</ci><ci id="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.4.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.1.1.1.1.4">𝑡</ci></apply></apply><ci id="A1.SS2.SSS2.p1.6.m6.1.2.3.cmml" xref="A1.SS2.SSS2.p1.6.m6.1.2.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.6.m6.1c">A^{(out)}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.6.m6.1d">italic_A start_POSTSUPERSCRIPT ( italic_o italic_u italic_t ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="A^{(in)}_{s}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.7.m7.1"><semantics id="A1.SS2.SSS2.p1.7.m7.1a"><msubsup id="A1.SS2.SSS2.p1.7.m7.1.2" xref="A1.SS2.SSS2.p1.7.m7.1.2.cmml"><mi id="A1.SS2.SSS2.p1.7.m7.1.2.2.2" xref="A1.SS2.SSS2.p1.7.m7.1.2.2.2.cmml">A</mi><mi id="A1.SS2.SSS2.p1.7.m7.1.2.3" xref="A1.SS2.SSS2.p1.7.m7.1.2.3.cmml">s</mi><mrow id="A1.SS2.SSS2.p1.7.m7.1.1.1.1" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.cmml"><mo id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.2" stretchy="false" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.2" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.2.cmml">i</mi><mo id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.1" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.3" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.3" stretchy="false" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.7.m7.1b"><apply id="A1.SS2.SSS2.p1.7.m7.1.2.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.7.m7.1.2.1.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.2">subscript</csymbol><apply id="A1.SS2.SSS2.p1.7.m7.1.2.2.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.2"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.7.m7.1.2.2.1.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.2">superscript</csymbol><ci id="A1.SS2.SSS2.p1.7.m7.1.2.2.2.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.2.2.2">𝐴</ci><apply id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1"><times id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.1"></times><ci id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.2">𝑖</ci><ci id="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.3.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.1.1.1.1.3">𝑛</ci></apply></apply><ci id="A1.SS2.SSS2.p1.7.m7.1.2.3.cmml" xref="A1.SS2.SSS2.p1.7.m7.1.2.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.7.m7.1c">A^{(in)}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.7.m7.1d">italic_A start_POSTSUPERSCRIPT ( italic_i italic_n ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="A_{s}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.8.m8.1"><semantics id="A1.SS2.SSS2.p1.8.m8.1a"><msub id="A1.SS2.SSS2.p1.8.m8.1.1" xref="A1.SS2.SSS2.p1.8.m8.1.1.cmml"><mi id="A1.SS2.SSS2.p1.8.m8.1.1.2" xref="A1.SS2.SSS2.p1.8.m8.1.1.2.cmml">A</mi><mi id="A1.SS2.SSS2.p1.8.m8.1.1.3" xref="A1.SS2.SSS2.p1.8.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.8.m8.1b"><apply id="A1.SS2.SSS2.p1.8.m8.1.1.cmml" xref="A1.SS2.SSS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.8.m8.1.1.1.cmml" xref="A1.SS2.SSS2.p1.8.m8.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p1.8.m8.1.1.2.cmml" xref="A1.SS2.SSS2.p1.8.m8.1.1.2">𝐴</ci><ci id="A1.SS2.SSS2.p1.8.m8.1.1.3.cmml" xref="A1.SS2.SSS2.p1.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.8.m8.1c">A_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.8.m8.1d">italic_A start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> being the concatenation of these matrices in each session. 
<br class="ltx_break"/>
<br class="ltx_break"/>For the node <math alttext="v_{s,i}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.9.m9.2"><semantics id="A1.SS2.SSS2.p1.9.m9.2a"><msub id="A1.SS2.SSS2.p1.9.m9.2.3" xref="A1.SS2.SSS2.p1.9.m9.2.3.cmml"><mi id="A1.SS2.SSS2.p1.9.m9.2.3.2" xref="A1.SS2.SSS2.p1.9.m9.2.3.2.cmml">v</mi><mrow id="A1.SS2.SSS2.p1.9.m9.2.2.2.4" xref="A1.SS2.SSS2.p1.9.m9.2.2.2.3.cmml"><mi id="A1.SS2.SSS2.p1.9.m9.1.1.1.1" xref="A1.SS2.SSS2.p1.9.m9.1.1.1.1.cmml">s</mi><mo id="A1.SS2.SSS2.p1.9.m9.2.2.2.4.1" xref="A1.SS2.SSS2.p1.9.m9.2.2.2.3.cmml">,</mo><mi id="A1.SS2.SSS2.p1.9.m9.2.2.2.2" xref="A1.SS2.SSS2.p1.9.m9.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.9.m9.2b"><apply id="A1.SS2.SSS2.p1.9.m9.2.3.cmml" xref="A1.SS2.SSS2.p1.9.m9.2.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.9.m9.2.3.1.cmml" xref="A1.SS2.SSS2.p1.9.m9.2.3">subscript</csymbol><ci id="A1.SS2.SSS2.p1.9.m9.2.3.2.cmml" xref="A1.SS2.SSS2.p1.9.m9.2.3.2">𝑣</ci><list id="A1.SS2.SSS2.p1.9.m9.2.2.2.3.cmml" xref="A1.SS2.SSS2.p1.9.m9.2.2.2.4"><ci id="A1.SS2.SSS2.p1.9.m9.1.1.1.1.cmml" xref="A1.SS2.SSS2.p1.9.m9.1.1.1.1">𝑠</ci><ci id="A1.SS2.SSS2.p1.9.m9.2.2.2.2.cmml" xref="A1.SS2.SSS2.p1.9.m9.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.9.m9.2c">v_{s,i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.9.m9.2d">italic_v start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of graph <math alttext="\mathcal{G}_{s}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.10.m10.1"><semantics id="A1.SS2.SSS2.p1.10.m10.1a"><msub id="A1.SS2.SSS2.p1.10.m10.1.1" xref="A1.SS2.SSS2.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.SSS2.p1.10.m10.1.1.2" xref="A1.SS2.SSS2.p1.10.m10.1.1.2.cmml">𝒢</mi><mi id="A1.SS2.SSS2.p1.10.m10.1.1.3" xref="A1.SS2.SSS2.p1.10.m10.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.10.m10.1b"><apply id="A1.SS2.SSS2.p1.10.m10.1.1.cmml" xref="A1.SS2.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.10.m10.1.1.1.cmml" xref="A1.SS2.SSS2.p1.10.m10.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p1.10.m10.1.1.2.cmml" xref="A1.SS2.SSS2.p1.10.m10.1.1.2">𝒢</ci><ci id="A1.SS2.SSS2.p1.10.m10.1.1.3.cmml" xref="A1.SS2.SSS2.p1.10.m10.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.10.m10.1c">\mathcal{G}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.10.m10.1d">caligraphic_G start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> corresponding to session <math alttext="I_{S}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p1.11.m11.1"><semantics id="A1.SS2.SSS2.p1.11.m11.1a"><msub id="A1.SS2.SSS2.p1.11.m11.1.1" xref="A1.SS2.SSS2.p1.11.m11.1.1.cmml"><mi id="A1.SS2.SSS2.p1.11.m11.1.1.2" xref="A1.SS2.SSS2.p1.11.m11.1.1.2.cmml">I</mi><mi id="A1.SS2.SSS2.p1.11.m11.1.1.3" xref="A1.SS2.SSS2.p1.11.m11.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p1.11.m11.1b"><apply id="A1.SS2.SSS2.p1.11.m11.1.1.cmml" xref="A1.SS2.SSS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p1.11.m11.1.1.1.cmml" xref="A1.SS2.SSS2.p1.11.m11.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p1.11.m11.1.1.2.cmml" xref="A1.SS2.SSS2.p1.11.m11.1.1.2">𝐼</ci><ci id="A1.SS2.SSS2.p1.11.m11.1.1.3.cmml" xref="A1.SS2.SSS2.p1.11.m11.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p1.11.m11.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p1.11.m11.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math>, the update functions are given as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx18">
<tbody id="A1.E38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle a^{t}_{s,i}" class="ltx_Math" display="inline" id="A1.E38.m1.2"><semantics id="A1.E38.m1.2a"><msubsup id="A1.E38.m1.2.3" xref="A1.E38.m1.2.3.cmml"><mi id="A1.E38.m1.2.3.2.2" xref="A1.E38.m1.2.3.2.2.cmml">a</mi><mrow id="A1.E38.m1.2.2.2.4" xref="A1.E38.m1.2.2.2.3.cmml"><mi id="A1.E38.m1.1.1.1.1" xref="A1.E38.m1.1.1.1.1.cmml">s</mi><mo id="A1.E38.m1.2.2.2.4.1" xref="A1.E38.m1.2.2.2.3.cmml">,</mo><mi id="A1.E38.m1.2.2.2.2" xref="A1.E38.m1.2.2.2.2.cmml">i</mi></mrow><mi id="A1.E38.m1.2.3.2.3" xref="A1.E38.m1.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E38.m1.2b"><apply id="A1.E38.m1.2.3.cmml" xref="A1.E38.m1.2.3"><csymbol cd="ambiguous" id="A1.E38.m1.2.3.1.cmml" xref="A1.E38.m1.2.3">subscript</csymbol><apply id="A1.E38.m1.2.3.2.cmml" xref="A1.E38.m1.2.3"><csymbol cd="ambiguous" id="A1.E38.m1.2.3.2.1.cmml" xref="A1.E38.m1.2.3">superscript</csymbol><ci id="A1.E38.m1.2.3.2.2.cmml" xref="A1.E38.m1.2.3.2.2">𝑎</ci><ci id="A1.E38.m1.2.3.2.3.cmml" xref="A1.E38.m1.2.3.2.3">𝑡</ci></apply><list id="A1.E38.m1.2.2.2.3.cmml" xref="A1.E38.m1.2.2.2.4"><ci id="A1.E38.m1.1.1.1.1.cmml" xref="A1.E38.m1.1.1.1.1">𝑠</ci><ci id="A1.E38.m1.2.2.2.2.cmml" xref="A1.E38.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E38.m1.2c">\displaystyle a^{t}_{s,i}</annotation><annotation encoding="application/x-llamapun" id="A1.E38.m1.2d">italic_a start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=A_{s,i:}[\mathbf{v}^{t-1}_{1},...,\mathbf{v}^{t-1}_{n}]^{T}H+b" class="ltx_Math" display="inline" id="A1.E38.m2.5"><semantics id="A1.E38.m2.5a"><mrow id="A1.E38.m2.5.5" xref="A1.E38.m2.5.5.cmml"><mi id="A1.E38.m2.5.5.4" xref="A1.E38.m2.5.5.4.cmml"></mi><mo id="A1.E38.m2.5.5.3" xref="A1.E38.m2.5.5.3.cmml">=</mo><mrow id="A1.E38.m2.5.5.2" xref="A1.E38.m2.5.5.2.cmml"><mrow id="A1.E38.m2.5.5.2.2" xref="A1.E38.m2.5.5.2.2.cmml"><msub id="A1.E38.m2.5.5.2.2.4" xref="A1.E38.m2.5.5.2.2.4.cmml"><mi id="A1.E38.m2.5.5.2.2.4.2" xref="A1.E38.m2.5.5.2.2.4.2.cmml">A</mi><mrow id="A1.E38.m2.2.2.2" xref="A1.E38.m2.2.2.2.cmml"><mrow id="A1.E38.m2.2.2.2.4.2" xref="A1.E38.m2.2.2.2.4.1.cmml"><mi id="A1.E38.m2.1.1.1.1" xref="A1.E38.m2.1.1.1.1.cmml">s</mi><mo id="A1.E38.m2.2.2.2.4.2.1" xref="A1.E38.m2.2.2.2.4.1.cmml">,</mo><mi id="A1.E38.m2.2.2.2.2" xref="A1.E38.m2.2.2.2.2.cmml">i</mi></mrow><mo id="A1.E38.m2.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="A1.E38.m2.2.2.2.3.cmml">:</mo><mi id="A1.E38.m2.2.2.2.5" xref="A1.E38.m2.2.2.2.5.cmml"></mi></mrow></msub><mo id="A1.E38.m2.5.5.2.2.3" xref="A1.E38.m2.5.5.2.2.3.cmml">⁢</mo><msup id="A1.E38.m2.5.5.2.2.2" xref="A1.E38.m2.5.5.2.2.2.cmml"><mrow id="A1.E38.m2.5.5.2.2.2.2.2" xref="A1.E38.m2.5.5.2.2.2.2.3.cmml"><mo id="A1.E38.m2.5.5.2.2.2.2.2.3" stretchy="false" xref="A1.E38.m2.5.5.2.2.2.2.3.cmml">[</mo><msubsup id="A1.E38.m2.4.4.1.1.1.1.1.1" xref="A1.E38.m2.4.4.1.1.1.1.1.1.cmml"><mi id="A1.E38.m2.4.4.1.1.1.1.1.1.2.2" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.2.cmml">𝐯</mi><mn id="A1.E38.m2.4.4.1.1.1.1.1.1.3" xref="A1.E38.m2.4.4.1.1.1.1.1.1.3.cmml">1</mn><mrow id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.2" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.1" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.3" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A1.E38.m2.5.5.2.2.2.2.2.4" xref="A1.E38.m2.5.5.2.2.2.2.3.cmml">,</mo><mi id="A1.E38.m2.3.3" mathvariant="normal" xref="A1.E38.m2.3.3.cmml">…</mi><mo id="A1.E38.m2.5.5.2.2.2.2.2.5" xref="A1.E38.m2.5.5.2.2.2.2.3.cmml">,</mo><msubsup id="A1.E38.m2.5.5.2.2.2.2.2.2" xref="A1.E38.m2.5.5.2.2.2.2.2.2.cmml"><mi id="A1.E38.m2.5.5.2.2.2.2.2.2.2.2" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.2.cmml">𝐯</mi><mi id="A1.E38.m2.5.5.2.2.2.2.2.2.3" xref="A1.E38.m2.5.5.2.2.2.2.2.2.3.cmml">n</mi><mrow id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.cmml"><mi id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.2" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.1" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.3" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A1.E38.m2.5.5.2.2.2.2.2.6" stretchy="false" xref="A1.E38.m2.5.5.2.2.2.2.3.cmml">]</mo></mrow><mi id="A1.E38.m2.5.5.2.2.2.4" xref="A1.E38.m2.5.5.2.2.2.4.cmml">T</mi></msup><mo id="A1.E38.m2.5.5.2.2.3a" xref="A1.E38.m2.5.5.2.2.3.cmml">⁢</mo><mi id="A1.E38.m2.5.5.2.2.5" xref="A1.E38.m2.5.5.2.2.5.cmml">H</mi></mrow><mo id="A1.E38.m2.5.5.2.3" xref="A1.E38.m2.5.5.2.3.cmml">+</mo><mi id="A1.E38.m2.5.5.2.4" xref="A1.E38.m2.5.5.2.4.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E38.m2.5b"><apply id="A1.E38.m2.5.5.cmml" xref="A1.E38.m2.5.5"><eq id="A1.E38.m2.5.5.3.cmml" xref="A1.E38.m2.5.5.3"></eq><csymbol cd="latexml" id="A1.E38.m2.5.5.4.cmml" xref="A1.E38.m2.5.5.4">absent</csymbol><apply id="A1.E38.m2.5.5.2.cmml" xref="A1.E38.m2.5.5.2"><plus id="A1.E38.m2.5.5.2.3.cmml" xref="A1.E38.m2.5.5.2.3"></plus><apply id="A1.E38.m2.5.5.2.2.cmml" xref="A1.E38.m2.5.5.2.2"><times id="A1.E38.m2.5.5.2.2.3.cmml" xref="A1.E38.m2.5.5.2.2.3"></times><apply id="A1.E38.m2.5.5.2.2.4.cmml" xref="A1.E38.m2.5.5.2.2.4"><csymbol cd="ambiguous" id="A1.E38.m2.5.5.2.2.4.1.cmml" xref="A1.E38.m2.5.5.2.2.4">subscript</csymbol><ci id="A1.E38.m2.5.5.2.2.4.2.cmml" xref="A1.E38.m2.5.5.2.2.4.2">𝐴</ci><apply id="A1.E38.m2.2.2.2.cmml" xref="A1.E38.m2.2.2.2"><ci id="A1.E38.m2.2.2.2.3.cmml" xref="A1.E38.m2.2.2.2.3">:</ci><list id="A1.E38.m2.2.2.2.4.1.cmml" xref="A1.E38.m2.2.2.2.4.2"><ci id="A1.E38.m2.1.1.1.1.cmml" xref="A1.E38.m2.1.1.1.1">𝑠</ci><ci id="A1.E38.m2.2.2.2.2.cmml" xref="A1.E38.m2.2.2.2.2">𝑖</ci></list><csymbol cd="latexml" id="A1.E38.m2.2.2.2.5.cmml" xref="A1.E38.m2.2.2.2.5">absent</csymbol></apply></apply><apply id="A1.E38.m2.5.5.2.2.2.cmml" xref="A1.E38.m2.5.5.2.2.2"><csymbol cd="ambiguous" id="A1.E38.m2.5.5.2.2.2.3.cmml" xref="A1.E38.m2.5.5.2.2.2">superscript</csymbol><list id="A1.E38.m2.5.5.2.2.2.2.3.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2"><apply id="A1.E38.m2.4.4.1.1.1.1.1.1.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E38.m2.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E38.m2.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E38.m2.4.4.1.1.1.1.1.1.2.1.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E38.m2.4.4.1.1.1.1.1.1.2.2.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.2">𝐯</ci><apply id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3"><minus id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.1"></minus><ci id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.2">𝑡</ci><cn id="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="A1.E38.m2.4.4.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><cn id="A1.E38.m2.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E38.m2.4.4.1.1.1.1.1.1.3">1</cn></apply><ci id="A1.E38.m2.3.3.cmml" xref="A1.E38.m2.3.3">…</ci><apply id="A1.E38.m2.5.5.2.2.2.2.2.2.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E38.m2.5.5.2.2.2.2.2.2.1.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2">subscript</csymbol><apply id="A1.E38.m2.5.5.2.2.2.2.2.2.2.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E38.m2.5.5.2.2.2.2.2.2.2.1.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2">superscript</csymbol><ci id="A1.E38.m2.5.5.2.2.2.2.2.2.2.2.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.2">𝐯</ci><apply id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3"><minus id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.1.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.1"></minus><ci id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.2.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.2">𝑡</ci><cn id="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="A1.E38.m2.5.5.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="A1.E38.m2.5.5.2.2.2.2.2.2.3.cmml" xref="A1.E38.m2.5.5.2.2.2.2.2.2.3">𝑛</ci></apply></list><ci id="A1.E38.m2.5.5.2.2.2.4.cmml" xref="A1.E38.m2.5.5.2.2.2.4">𝑇</ci></apply><ci id="A1.E38.m2.5.5.2.2.5.cmml" xref="A1.E38.m2.5.5.2.2.5">𝐻</ci></apply><ci id="A1.E38.m2.5.5.2.4.cmml" xref="A1.E38.m2.5.5.2.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E38.m2.5c">\displaystyle=A_{s,i:}[\mathbf{v}^{t-1}_{1},...,\mathbf{v}^{t-1}_{n}]^{T}H+b</annotation><annotation encoding="application/x-llamapun" id="A1.E38.m2.5d">= italic_A start_POSTSUBSCRIPT italic_s , italic_i : end_POSTSUBSCRIPT [ bold_v start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_v start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_H + italic_b</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(38)</span></td>
</tr></tbody>
<tbody id="A1.E39"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle z^{t}_{s,i}" class="ltx_Math" display="inline" id="A1.E39.m1.2"><semantics id="A1.E39.m1.2a"><msubsup id="A1.E39.m1.2.3" xref="A1.E39.m1.2.3.cmml"><mi id="A1.E39.m1.2.3.2.2" xref="A1.E39.m1.2.3.2.2.cmml">z</mi><mrow id="A1.E39.m1.2.2.2.4" xref="A1.E39.m1.2.2.2.3.cmml"><mi id="A1.E39.m1.1.1.1.1" xref="A1.E39.m1.1.1.1.1.cmml">s</mi><mo id="A1.E39.m1.2.2.2.4.1" xref="A1.E39.m1.2.2.2.3.cmml">,</mo><mi id="A1.E39.m1.2.2.2.2" xref="A1.E39.m1.2.2.2.2.cmml">i</mi></mrow><mi id="A1.E39.m1.2.3.2.3" xref="A1.E39.m1.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E39.m1.2b"><apply id="A1.E39.m1.2.3.cmml" xref="A1.E39.m1.2.3"><csymbol cd="ambiguous" id="A1.E39.m1.2.3.1.cmml" xref="A1.E39.m1.2.3">subscript</csymbol><apply id="A1.E39.m1.2.3.2.cmml" xref="A1.E39.m1.2.3"><csymbol cd="ambiguous" id="A1.E39.m1.2.3.2.1.cmml" xref="A1.E39.m1.2.3">superscript</csymbol><ci id="A1.E39.m1.2.3.2.2.cmml" xref="A1.E39.m1.2.3.2.2">𝑧</ci><ci id="A1.E39.m1.2.3.2.3.cmml" xref="A1.E39.m1.2.3.2.3">𝑡</ci></apply><list id="A1.E39.m1.2.2.2.3.cmml" xref="A1.E39.m1.2.2.2.4"><ci id="A1.E39.m1.1.1.1.1.cmml" xref="A1.E39.m1.1.1.1.1">𝑠</ci><ci id="A1.E39.m1.2.2.2.2.cmml" xref="A1.E39.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E39.m1.2c">\displaystyle z^{t}_{s,i}</annotation><annotation encoding="application/x-llamapun" id="A1.E39.m1.2d">italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W_{z}a^{t}_{s,i}+U_{z}\mathbf{v}^{t-1}_{i})" class="ltx_Math" display="inline" id="A1.E39.m2.3"><semantics id="A1.E39.m2.3a"><mrow id="A1.E39.m2.3.3" xref="A1.E39.m2.3.3.cmml"><mi id="A1.E39.m2.3.3.3" xref="A1.E39.m2.3.3.3.cmml"></mi><mo id="A1.E39.m2.3.3.2" xref="A1.E39.m2.3.3.2.cmml">=</mo><mrow id="A1.E39.m2.3.3.1" xref="A1.E39.m2.3.3.1.cmml"><mi id="A1.E39.m2.3.3.1.3" xref="A1.E39.m2.3.3.1.3.cmml">σ</mi><mo id="A1.E39.m2.3.3.1.2" xref="A1.E39.m2.3.3.1.2.cmml">⁢</mo><mrow id="A1.E39.m2.3.3.1.1.1" xref="A1.E39.m2.3.3.1.1.1.1.cmml"><mo id="A1.E39.m2.3.3.1.1.1.2" stretchy="false" xref="A1.E39.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.E39.m2.3.3.1.1.1.1" xref="A1.E39.m2.3.3.1.1.1.1.cmml"><mrow id="A1.E39.m2.3.3.1.1.1.1.2" xref="A1.E39.m2.3.3.1.1.1.1.2.cmml"><msub id="A1.E39.m2.3.3.1.1.1.1.2.2" xref="A1.E39.m2.3.3.1.1.1.1.2.2.cmml"><mi id="A1.E39.m2.3.3.1.1.1.1.2.2.2" xref="A1.E39.m2.3.3.1.1.1.1.2.2.2.cmml">W</mi><mi id="A1.E39.m2.3.3.1.1.1.1.2.2.3" xref="A1.E39.m2.3.3.1.1.1.1.2.2.3.cmml">z</mi></msub><mo id="A1.E39.m2.3.3.1.1.1.1.2.1" xref="A1.E39.m2.3.3.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="A1.E39.m2.3.3.1.1.1.1.2.3" xref="A1.E39.m2.3.3.1.1.1.1.2.3.cmml"><mi id="A1.E39.m2.3.3.1.1.1.1.2.3.2.2" xref="A1.E39.m2.3.3.1.1.1.1.2.3.2.2.cmml">a</mi><mrow id="A1.E39.m2.2.2.2.4" xref="A1.E39.m2.2.2.2.3.cmml"><mi id="A1.E39.m2.1.1.1.1" xref="A1.E39.m2.1.1.1.1.cmml">s</mi><mo id="A1.E39.m2.2.2.2.4.1" xref="A1.E39.m2.2.2.2.3.cmml">,</mo><mi id="A1.E39.m2.2.2.2.2" xref="A1.E39.m2.2.2.2.2.cmml">i</mi></mrow><mi id="A1.E39.m2.3.3.1.1.1.1.2.3.2.3" xref="A1.E39.m2.3.3.1.1.1.1.2.3.2.3.cmml">t</mi></msubsup></mrow><mo id="A1.E39.m2.3.3.1.1.1.1.1" xref="A1.E39.m2.3.3.1.1.1.1.1.cmml">+</mo><mrow id="A1.E39.m2.3.3.1.1.1.1.3" xref="A1.E39.m2.3.3.1.1.1.1.3.cmml"><msub id="A1.E39.m2.3.3.1.1.1.1.3.2" xref="A1.E39.m2.3.3.1.1.1.1.3.2.cmml"><mi id="A1.E39.m2.3.3.1.1.1.1.3.2.2" xref="A1.E39.m2.3.3.1.1.1.1.3.2.2.cmml">U</mi><mi id="A1.E39.m2.3.3.1.1.1.1.3.2.3" xref="A1.E39.m2.3.3.1.1.1.1.3.2.3.cmml">z</mi></msub><mo id="A1.E39.m2.3.3.1.1.1.1.3.1" xref="A1.E39.m2.3.3.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="A1.E39.m2.3.3.1.1.1.1.3.3" xref="A1.E39.m2.3.3.1.1.1.1.3.3.cmml"><mi id="A1.E39.m2.3.3.1.1.1.1.3.3.2.2" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.2.cmml">𝐯</mi><mi id="A1.E39.m2.3.3.1.1.1.1.3.3.3" xref="A1.E39.m2.3.3.1.1.1.1.3.3.3.cmml">i</mi><mrow id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.cmml"><mi id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.2" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.2.cmml">t</mi><mo id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.1" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.1.cmml">−</mo><mn id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.3" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo id="A1.E39.m2.3.3.1.1.1.3" stretchy="false" xref="A1.E39.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E39.m2.3b"><apply id="A1.E39.m2.3.3.cmml" xref="A1.E39.m2.3.3"><eq id="A1.E39.m2.3.3.2.cmml" xref="A1.E39.m2.3.3.2"></eq><csymbol cd="latexml" id="A1.E39.m2.3.3.3.cmml" xref="A1.E39.m2.3.3.3">absent</csymbol><apply id="A1.E39.m2.3.3.1.cmml" xref="A1.E39.m2.3.3.1"><times id="A1.E39.m2.3.3.1.2.cmml" xref="A1.E39.m2.3.3.1.2"></times><ci id="A1.E39.m2.3.3.1.3.cmml" xref="A1.E39.m2.3.3.1.3">𝜎</ci><apply id="A1.E39.m2.3.3.1.1.1.1.cmml" xref="A1.E39.m2.3.3.1.1.1"><plus id="A1.E39.m2.3.3.1.1.1.1.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.1"></plus><apply id="A1.E39.m2.3.3.1.1.1.1.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2"><times id="A1.E39.m2.3.3.1.1.1.1.2.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.1"></times><apply id="A1.E39.m2.3.3.1.1.1.1.2.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E39.m2.3.3.1.1.1.1.2.2.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E39.m2.3.3.1.1.1.1.2.2.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.2.2">𝑊</ci><ci id="A1.E39.m2.3.3.1.1.1.1.2.2.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.2.3">𝑧</ci></apply><apply id="A1.E39.m2.3.3.1.1.1.1.2.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E39.m2.3.3.1.1.1.1.2.3.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.3">subscript</csymbol><apply id="A1.E39.m2.3.3.1.1.1.1.2.3.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E39.m2.3.3.1.1.1.1.2.3.2.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.3">superscript</csymbol><ci id="A1.E39.m2.3.3.1.1.1.1.2.3.2.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.3.2.2">𝑎</ci><ci id="A1.E39.m2.3.3.1.1.1.1.2.3.2.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.2.3.2.3">𝑡</ci></apply><list id="A1.E39.m2.2.2.2.3.cmml" xref="A1.E39.m2.2.2.2.4"><ci id="A1.E39.m2.1.1.1.1.cmml" xref="A1.E39.m2.1.1.1.1">𝑠</ci><ci id="A1.E39.m2.2.2.2.2.cmml" xref="A1.E39.m2.2.2.2.2">𝑖</ci></list></apply></apply><apply id="A1.E39.m2.3.3.1.1.1.1.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3"><times id="A1.E39.m2.3.3.1.1.1.1.3.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.1"></times><apply id="A1.E39.m2.3.3.1.1.1.1.3.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E39.m2.3.3.1.1.1.1.3.2.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E39.m2.3.3.1.1.1.1.3.2.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.2.2">𝑈</ci><ci id="A1.E39.m2.3.3.1.1.1.1.3.2.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.2.3">𝑧</ci></apply><apply id="A1.E39.m2.3.3.1.1.1.1.3.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E39.m2.3.3.1.1.1.1.3.3.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3">subscript</csymbol><apply id="A1.E39.m2.3.3.1.1.1.1.3.3.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E39.m2.3.3.1.1.1.1.3.3.2.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3">superscript</csymbol><ci id="A1.E39.m2.3.3.1.1.1.1.3.3.2.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.2">𝐯</ci><apply id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3"><minus id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.1.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.1"></minus><ci id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.2.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.2">𝑡</ci><cn id="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.3.cmml" type="integer" xref="A1.E39.m2.3.3.1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="A1.E39.m2.3.3.1.1.1.1.3.3.3.cmml" xref="A1.E39.m2.3.3.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E39.m2.3c">\displaystyle=\sigma(W_{z}a^{t}_{s,i}+U_{z}\mathbf{v}^{t-1}_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.E39.m2.3d">= italic_σ ( italic_W start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_a start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT + italic_U start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT bold_v start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(39)</span></td>
</tr></tbody>
<tbody id="A1.E40"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r^{t}_{s,i}" class="ltx_Math" display="inline" id="A1.E40.m1.2"><semantics id="A1.E40.m1.2a"><msubsup id="A1.E40.m1.2.3" xref="A1.E40.m1.2.3.cmml"><mi id="A1.E40.m1.2.3.2.2" xref="A1.E40.m1.2.3.2.2.cmml">r</mi><mrow id="A1.E40.m1.2.2.2.4" xref="A1.E40.m1.2.2.2.3.cmml"><mi id="A1.E40.m1.1.1.1.1" xref="A1.E40.m1.1.1.1.1.cmml">s</mi><mo id="A1.E40.m1.2.2.2.4.1" xref="A1.E40.m1.2.2.2.3.cmml">,</mo><mi id="A1.E40.m1.2.2.2.2" xref="A1.E40.m1.2.2.2.2.cmml">i</mi></mrow><mi id="A1.E40.m1.2.3.2.3" xref="A1.E40.m1.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E40.m1.2b"><apply id="A1.E40.m1.2.3.cmml" xref="A1.E40.m1.2.3"><csymbol cd="ambiguous" id="A1.E40.m1.2.3.1.cmml" xref="A1.E40.m1.2.3">subscript</csymbol><apply id="A1.E40.m1.2.3.2.cmml" xref="A1.E40.m1.2.3"><csymbol cd="ambiguous" id="A1.E40.m1.2.3.2.1.cmml" xref="A1.E40.m1.2.3">superscript</csymbol><ci id="A1.E40.m1.2.3.2.2.cmml" xref="A1.E40.m1.2.3.2.2">𝑟</ci><ci id="A1.E40.m1.2.3.2.3.cmml" xref="A1.E40.m1.2.3.2.3">𝑡</ci></apply><list id="A1.E40.m1.2.2.2.3.cmml" xref="A1.E40.m1.2.2.2.4"><ci id="A1.E40.m1.1.1.1.1.cmml" xref="A1.E40.m1.1.1.1.1">𝑠</ci><ci id="A1.E40.m1.2.2.2.2.cmml" xref="A1.E40.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E40.m1.2c">\displaystyle r^{t}_{s,i}</annotation><annotation encoding="application/x-llamapun" id="A1.E40.m1.2d">italic_r start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma(W_{r}a^{t}_{s,i}+U_{r}\mathbf{v}^{t-1}_{i})" class="ltx_Math" display="inline" id="A1.E40.m2.3"><semantics id="A1.E40.m2.3a"><mrow id="A1.E40.m2.3.3" xref="A1.E40.m2.3.3.cmml"><mi id="A1.E40.m2.3.3.3" xref="A1.E40.m2.3.3.3.cmml"></mi><mo id="A1.E40.m2.3.3.2" xref="A1.E40.m2.3.3.2.cmml">=</mo><mrow id="A1.E40.m2.3.3.1" xref="A1.E40.m2.3.3.1.cmml"><mi id="A1.E40.m2.3.3.1.3" xref="A1.E40.m2.3.3.1.3.cmml">σ</mi><mo id="A1.E40.m2.3.3.1.2" xref="A1.E40.m2.3.3.1.2.cmml">⁢</mo><mrow id="A1.E40.m2.3.3.1.1.1" xref="A1.E40.m2.3.3.1.1.1.1.cmml"><mo id="A1.E40.m2.3.3.1.1.1.2" stretchy="false" xref="A1.E40.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.E40.m2.3.3.1.1.1.1" xref="A1.E40.m2.3.3.1.1.1.1.cmml"><mrow id="A1.E40.m2.3.3.1.1.1.1.2" xref="A1.E40.m2.3.3.1.1.1.1.2.cmml"><msub id="A1.E40.m2.3.3.1.1.1.1.2.2" xref="A1.E40.m2.3.3.1.1.1.1.2.2.cmml"><mi id="A1.E40.m2.3.3.1.1.1.1.2.2.2" xref="A1.E40.m2.3.3.1.1.1.1.2.2.2.cmml">W</mi><mi id="A1.E40.m2.3.3.1.1.1.1.2.2.3" xref="A1.E40.m2.3.3.1.1.1.1.2.2.3.cmml">r</mi></msub><mo id="A1.E40.m2.3.3.1.1.1.1.2.1" xref="A1.E40.m2.3.3.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="A1.E40.m2.3.3.1.1.1.1.2.3" xref="A1.E40.m2.3.3.1.1.1.1.2.3.cmml"><mi id="A1.E40.m2.3.3.1.1.1.1.2.3.2.2" xref="A1.E40.m2.3.3.1.1.1.1.2.3.2.2.cmml">a</mi><mrow id="A1.E40.m2.2.2.2.4" xref="A1.E40.m2.2.2.2.3.cmml"><mi id="A1.E40.m2.1.1.1.1" xref="A1.E40.m2.1.1.1.1.cmml">s</mi><mo id="A1.E40.m2.2.2.2.4.1" xref="A1.E40.m2.2.2.2.3.cmml">,</mo><mi id="A1.E40.m2.2.2.2.2" xref="A1.E40.m2.2.2.2.2.cmml">i</mi></mrow><mi id="A1.E40.m2.3.3.1.1.1.1.2.3.2.3" xref="A1.E40.m2.3.3.1.1.1.1.2.3.2.3.cmml">t</mi></msubsup></mrow><mo id="A1.E40.m2.3.3.1.1.1.1.1" xref="A1.E40.m2.3.3.1.1.1.1.1.cmml">+</mo><mrow id="A1.E40.m2.3.3.1.1.1.1.3" xref="A1.E40.m2.3.3.1.1.1.1.3.cmml"><msub id="A1.E40.m2.3.3.1.1.1.1.3.2" xref="A1.E40.m2.3.3.1.1.1.1.3.2.cmml"><mi id="A1.E40.m2.3.3.1.1.1.1.3.2.2" xref="A1.E40.m2.3.3.1.1.1.1.3.2.2.cmml">U</mi><mi id="A1.E40.m2.3.3.1.1.1.1.3.2.3" xref="A1.E40.m2.3.3.1.1.1.1.3.2.3.cmml">r</mi></msub><mo id="A1.E40.m2.3.3.1.1.1.1.3.1" xref="A1.E40.m2.3.3.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="A1.E40.m2.3.3.1.1.1.1.3.3" xref="A1.E40.m2.3.3.1.1.1.1.3.3.cmml"><mi id="A1.E40.m2.3.3.1.1.1.1.3.3.2.2" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.2.cmml">𝐯</mi><mi id="A1.E40.m2.3.3.1.1.1.1.3.3.3" xref="A1.E40.m2.3.3.1.1.1.1.3.3.3.cmml">i</mi><mrow id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.cmml"><mi id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.2" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.2.cmml">t</mi><mo id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.1" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.1.cmml">−</mo><mn id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.3" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo id="A1.E40.m2.3.3.1.1.1.3" stretchy="false" xref="A1.E40.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E40.m2.3b"><apply id="A1.E40.m2.3.3.cmml" xref="A1.E40.m2.3.3"><eq id="A1.E40.m2.3.3.2.cmml" xref="A1.E40.m2.3.3.2"></eq><csymbol cd="latexml" id="A1.E40.m2.3.3.3.cmml" xref="A1.E40.m2.3.3.3">absent</csymbol><apply id="A1.E40.m2.3.3.1.cmml" xref="A1.E40.m2.3.3.1"><times id="A1.E40.m2.3.3.1.2.cmml" xref="A1.E40.m2.3.3.1.2"></times><ci id="A1.E40.m2.3.3.1.3.cmml" xref="A1.E40.m2.3.3.1.3">𝜎</ci><apply id="A1.E40.m2.3.3.1.1.1.1.cmml" xref="A1.E40.m2.3.3.1.1.1"><plus id="A1.E40.m2.3.3.1.1.1.1.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.1"></plus><apply id="A1.E40.m2.3.3.1.1.1.1.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2"><times id="A1.E40.m2.3.3.1.1.1.1.2.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.1"></times><apply id="A1.E40.m2.3.3.1.1.1.1.2.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E40.m2.3.3.1.1.1.1.2.2.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E40.m2.3.3.1.1.1.1.2.2.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.2.2">𝑊</ci><ci id="A1.E40.m2.3.3.1.1.1.1.2.2.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.2.3">𝑟</ci></apply><apply id="A1.E40.m2.3.3.1.1.1.1.2.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E40.m2.3.3.1.1.1.1.2.3.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.3">subscript</csymbol><apply id="A1.E40.m2.3.3.1.1.1.1.2.3.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E40.m2.3.3.1.1.1.1.2.3.2.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.3">superscript</csymbol><ci id="A1.E40.m2.3.3.1.1.1.1.2.3.2.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.3.2.2">𝑎</ci><ci id="A1.E40.m2.3.3.1.1.1.1.2.3.2.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.2.3.2.3">𝑡</ci></apply><list id="A1.E40.m2.2.2.2.3.cmml" xref="A1.E40.m2.2.2.2.4"><ci id="A1.E40.m2.1.1.1.1.cmml" xref="A1.E40.m2.1.1.1.1">𝑠</ci><ci id="A1.E40.m2.2.2.2.2.cmml" xref="A1.E40.m2.2.2.2.2">𝑖</ci></list></apply></apply><apply id="A1.E40.m2.3.3.1.1.1.1.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3"><times id="A1.E40.m2.3.3.1.1.1.1.3.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.1"></times><apply id="A1.E40.m2.3.3.1.1.1.1.3.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E40.m2.3.3.1.1.1.1.3.2.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E40.m2.3.3.1.1.1.1.3.2.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.2.2">𝑈</ci><ci id="A1.E40.m2.3.3.1.1.1.1.3.2.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.2.3">𝑟</ci></apply><apply id="A1.E40.m2.3.3.1.1.1.1.3.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E40.m2.3.3.1.1.1.1.3.3.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3">subscript</csymbol><apply id="A1.E40.m2.3.3.1.1.1.1.3.3.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E40.m2.3.3.1.1.1.1.3.3.2.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3">superscript</csymbol><ci id="A1.E40.m2.3.3.1.1.1.1.3.3.2.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.2">𝐯</ci><apply id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3"><minus id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.1.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.1"></minus><ci id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.2.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.2">𝑡</ci><cn id="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.3.cmml" type="integer" xref="A1.E40.m2.3.3.1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="A1.E40.m2.3.3.1.1.1.1.3.3.3.cmml" xref="A1.E40.m2.3.3.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E40.m2.3c">\displaystyle=\sigma(W_{r}a^{t}_{s,i}+U_{r}\mathbf{v}^{t-1}_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.E40.m2.3d">= italic_σ ( italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_a start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT + italic_U start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT bold_v start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(40)</span></td>
</tr></tbody>
<tbody id="A1.E41"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{\mathbf{v}^{t}_{i}}" class="ltx_Math" display="inline" id="A1.E41.m1.1"><semantics id="A1.E41.m1.1a"><mover accent="true" id="A1.E41.m1.1.1" xref="A1.E41.m1.1.1.cmml"><msubsup id="A1.E41.m1.1.1.2" xref="A1.E41.m1.1.1.2.cmml"><mi id="A1.E41.m1.1.1.2.2.2" xref="A1.E41.m1.1.1.2.2.2.cmml">𝐯</mi><mi id="A1.E41.m1.1.1.2.3" xref="A1.E41.m1.1.1.2.3.cmml">i</mi><mi id="A1.E41.m1.1.1.2.2.3" xref="A1.E41.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo id="A1.E41.m1.1.1.1" xref="A1.E41.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.E41.m1.1b"><apply id="A1.E41.m1.1.1.cmml" xref="A1.E41.m1.1.1"><ci id="A1.E41.m1.1.1.1.cmml" xref="A1.E41.m1.1.1.1">~</ci><apply id="A1.E41.m1.1.1.2.cmml" xref="A1.E41.m1.1.1.2"><csymbol cd="ambiguous" id="A1.E41.m1.1.1.2.1.cmml" xref="A1.E41.m1.1.1.2">subscript</csymbol><apply id="A1.E41.m1.1.1.2.2.cmml" xref="A1.E41.m1.1.1.2"><csymbol cd="ambiguous" id="A1.E41.m1.1.1.2.2.1.cmml" xref="A1.E41.m1.1.1.2">superscript</csymbol><ci id="A1.E41.m1.1.1.2.2.2.cmml" xref="A1.E41.m1.1.1.2.2.2">𝐯</ci><ci id="A1.E41.m1.1.1.2.2.3.cmml" xref="A1.E41.m1.1.1.2.2.3">𝑡</ci></apply><ci id="A1.E41.m1.1.1.2.3.cmml" xref="A1.E41.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E41.m1.1c">\displaystyle\tilde{\mathbf{v}^{t}_{i}}</annotation><annotation encoding="application/x-llamapun" id="A1.E41.m1.1d">over~ start_ARG bold_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=tanh(W_{o}a^{t}_{s,i}+U_{o}(r^{t}_{s,i}\odot\mathbf{v}^{t-1}_{i}))" class="ltx_Math" display="inline" id="A1.E41.m2.5"><semantics id="A1.E41.m2.5a"><mrow id="A1.E41.m2.5.5" xref="A1.E41.m2.5.5.cmml"><mi id="A1.E41.m2.5.5.3" xref="A1.E41.m2.5.5.3.cmml"></mi><mo id="A1.E41.m2.5.5.2" xref="A1.E41.m2.5.5.2.cmml">=</mo><mrow id="A1.E41.m2.5.5.1" xref="A1.E41.m2.5.5.1.cmml"><mi id="A1.E41.m2.5.5.1.3" xref="A1.E41.m2.5.5.1.3.cmml">t</mi><mo id="A1.E41.m2.5.5.1.2" xref="A1.E41.m2.5.5.1.2.cmml">⁢</mo><mi id="A1.E41.m2.5.5.1.4" xref="A1.E41.m2.5.5.1.4.cmml">a</mi><mo id="A1.E41.m2.5.5.1.2a" xref="A1.E41.m2.5.5.1.2.cmml">⁢</mo><mi id="A1.E41.m2.5.5.1.5" xref="A1.E41.m2.5.5.1.5.cmml">n</mi><mo id="A1.E41.m2.5.5.1.2b" xref="A1.E41.m2.5.5.1.2.cmml">⁢</mo><mi id="A1.E41.m2.5.5.1.6" xref="A1.E41.m2.5.5.1.6.cmml">h</mi><mo id="A1.E41.m2.5.5.1.2c" xref="A1.E41.m2.5.5.1.2.cmml">⁢</mo><mrow id="A1.E41.m2.5.5.1.1.1" xref="A1.E41.m2.5.5.1.1.1.1.cmml"><mo id="A1.E41.m2.5.5.1.1.1.2" stretchy="false" xref="A1.E41.m2.5.5.1.1.1.1.cmml">(</mo><mrow id="A1.E41.m2.5.5.1.1.1.1" xref="A1.E41.m2.5.5.1.1.1.1.cmml"><mrow id="A1.E41.m2.5.5.1.1.1.1.3" xref="A1.E41.m2.5.5.1.1.1.1.3.cmml"><msub id="A1.E41.m2.5.5.1.1.1.1.3.2" xref="A1.E41.m2.5.5.1.1.1.1.3.2.cmml"><mi id="A1.E41.m2.5.5.1.1.1.1.3.2.2" xref="A1.E41.m2.5.5.1.1.1.1.3.2.2.cmml">W</mi><mi id="A1.E41.m2.5.5.1.1.1.1.3.2.3" xref="A1.E41.m2.5.5.1.1.1.1.3.2.3.cmml">o</mi></msub><mo id="A1.E41.m2.5.5.1.1.1.1.3.1" xref="A1.E41.m2.5.5.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="A1.E41.m2.5.5.1.1.1.1.3.3" xref="A1.E41.m2.5.5.1.1.1.1.3.3.cmml"><mi id="A1.E41.m2.5.5.1.1.1.1.3.3.2.2" xref="A1.E41.m2.5.5.1.1.1.1.3.3.2.2.cmml">a</mi><mrow id="A1.E41.m2.2.2.2.4" xref="A1.E41.m2.2.2.2.3.cmml"><mi id="A1.E41.m2.1.1.1.1" xref="A1.E41.m2.1.1.1.1.cmml">s</mi><mo id="A1.E41.m2.2.2.2.4.1" xref="A1.E41.m2.2.2.2.3.cmml">,</mo><mi id="A1.E41.m2.2.2.2.2" xref="A1.E41.m2.2.2.2.2.cmml">i</mi></mrow><mi id="A1.E41.m2.5.5.1.1.1.1.3.3.2.3" xref="A1.E41.m2.5.5.1.1.1.1.3.3.2.3.cmml">t</mi></msubsup></mrow><mo id="A1.E41.m2.5.5.1.1.1.1.2" xref="A1.E41.m2.5.5.1.1.1.1.2.cmml">+</mo><mrow id="A1.E41.m2.5.5.1.1.1.1.1" xref="A1.E41.m2.5.5.1.1.1.1.1.cmml"><msub id="A1.E41.m2.5.5.1.1.1.1.1.3" xref="A1.E41.m2.5.5.1.1.1.1.1.3.cmml"><mi id="A1.E41.m2.5.5.1.1.1.1.1.3.2" xref="A1.E41.m2.5.5.1.1.1.1.1.3.2.cmml">U</mi><mi id="A1.E41.m2.5.5.1.1.1.1.1.3.3" xref="A1.E41.m2.5.5.1.1.1.1.1.3.3.cmml">o</mi></msub><mo id="A1.E41.m2.5.5.1.1.1.1.1.2" xref="A1.E41.m2.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E41.m2.5.5.1.1.1.1.1.1.1" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E41.m2.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml">r</mi><mrow id="A1.E41.m2.4.4.2.4" xref="A1.E41.m2.4.4.2.3.cmml"><mi id="A1.E41.m2.3.3.1.1" xref="A1.E41.m2.3.3.1.1.cmml">s</mi><mo id="A1.E41.m2.4.4.2.4.1" xref="A1.E41.m2.4.4.2.3.cmml">,</mo><mi id="A1.E41.m2.4.4.2.2" xref="A1.E41.m2.4.4.2.2.cmml">i</mi></mrow><mi id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msubsup><mo id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msubsup id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐯</mi><mi id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.3" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mrow id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.2" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.2.cmml">t</mi><mo id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.1" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.3" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="A1.E41.m2.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E41.m2.5.5.1.1.1.3" stretchy="false" xref="A1.E41.m2.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E41.m2.5b"><apply id="A1.E41.m2.5.5.cmml" xref="A1.E41.m2.5.5"><eq id="A1.E41.m2.5.5.2.cmml" xref="A1.E41.m2.5.5.2"></eq><csymbol cd="latexml" id="A1.E41.m2.5.5.3.cmml" xref="A1.E41.m2.5.5.3">absent</csymbol><apply id="A1.E41.m2.5.5.1.cmml" xref="A1.E41.m2.5.5.1"><times id="A1.E41.m2.5.5.1.2.cmml" xref="A1.E41.m2.5.5.1.2"></times><ci id="A1.E41.m2.5.5.1.3.cmml" xref="A1.E41.m2.5.5.1.3">𝑡</ci><ci id="A1.E41.m2.5.5.1.4.cmml" xref="A1.E41.m2.5.5.1.4">𝑎</ci><ci id="A1.E41.m2.5.5.1.5.cmml" xref="A1.E41.m2.5.5.1.5">𝑛</ci><ci id="A1.E41.m2.5.5.1.6.cmml" xref="A1.E41.m2.5.5.1.6">ℎ</ci><apply id="A1.E41.m2.5.5.1.1.1.1.cmml" xref="A1.E41.m2.5.5.1.1.1"><plus id="A1.E41.m2.5.5.1.1.1.1.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.2"></plus><apply id="A1.E41.m2.5.5.1.1.1.1.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3"><times id="A1.E41.m2.5.5.1.1.1.1.3.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.1"></times><apply id="A1.E41.m2.5.5.1.1.1.1.3.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.3.2.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E41.m2.5.5.1.1.1.1.3.2.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.2.2">𝑊</ci><ci id="A1.E41.m2.5.5.1.1.1.1.3.2.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.2.3">𝑜</ci></apply><apply id="A1.E41.m2.5.5.1.1.1.1.3.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.3.3.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.3">subscript</csymbol><apply id="A1.E41.m2.5.5.1.1.1.1.3.3.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.3.3.2.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.3">superscript</csymbol><ci id="A1.E41.m2.5.5.1.1.1.1.3.3.2.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.3.2.2">𝑎</ci><ci id="A1.E41.m2.5.5.1.1.1.1.3.3.2.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.3.3.2.3">𝑡</ci></apply><list id="A1.E41.m2.2.2.2.3.cmml" xref="A1.E41.m2.2.2.2.4"><ci id="A1.E41.m2.1.1.1.1.cmml" xref="A1.E41.m2.1.1.1.1">𝑠</ci><ci id="A1.E41.m2.2.2.2.2.cmml" xref="A1.E41.m2.2.2.2.2">𝑖</ci></list></apply></apply><apply id="A1.E41.m2.5.5.1.1.1.1.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1"><times id="A1.E41.m2.5.5.1.1.1.1.1.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.2"></times><apply id="A1.E41.m2.5.5.1.1.1.1.1.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E41.m2.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.3.2">𝑈</ci><ci id="A1.E41.m2.5.5.1.1.1.1.1.3.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.3.3">𝑜</ci></apply><apply id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><list id="A1.E41.m2.4.4.2.3.cmml" xref="A1.E41.m2.4.4.2.4"><ci id="A1.E41.m2.3.3.1.1.cmml" xref="A1.E41.m2.3.3.1.1">𝑠</ci><ci id="A1.E41.m2.4.4.2.2.cmml" xref="A1.E41.m2.4.4.2.2">𝑖</ci></list></apply><apply id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.2">𝐯</ci><apply id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3"><minus id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.1"></minus><ci id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.2">𝑡</ci><cn id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E41.m2.5.5.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E41.m2.5c">\displaystyle=tanh(W_{o}a^{t}_{s,i}+U_{o}(r^{t}_{s,i}\odot\mathbf{v}^{t-1}_{i}))</annotation><annotation encoding="application/x-llamapun" id="A1.E41.m2.5d">= italic_t italic_a italic_n italic_h ( italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT italic_a start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT + italic_U start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT ⊙ bold_v start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(41)</span></td>
</tr></tbody>
<tbody id="A1.E42"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{v}^{t}_{i}" class="ltx_Math" display="inline" id="A1.E42.m1.1"><semantics id="A1.E42.m1.1a"><msubsup id="A1.E42.m1.1.1" xref="A1.E42.m1.1.1.cmml"><mi id="A1.E42.m1.1.1.2.2" xref="A1.E42.m1.1.1.2.2.cmml">𝐯</mi><mi id="A1.E42.m1.1.1.3" xref="A1.E42.m1.1.1.3.cmml">i</mi><mi id="A1.E42.m1.1.1.2.3" xref="A1.E42.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.E42.m1.1b"><apply id="A1.E42.m1.1.1.cmml" xref="A1.E42.m1.1.1"><csymbol cd="ambiguous" id="A1.E42.m1.1.1.1.cmml" xref="A1.E42.m1.1.1">subscript</csymbol><apply id="A1.E42.m1.1.1.2.cmml" xref="A1.E42.m1.1.1"><csymbol cd="ambiguous" id="A1.E42.m1.1.1.2.1.cmml" xref="A1.E42.m1.1.1">superscript</csymbol><ci id="A1.E42.m1.1.1.2.2.cmml" xref="A1.E42.m1.1.1.2.2">𝐯</ci><ci id="A1.E42.m1.1.1.2.3.cmml" xref="A1.E42.m1.1.1.2.3">𝑡</ci></apply><ci id="A1.E42.m1.1.1.3.cmml" xref="A1.E42.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E42.m1.1c">\displaystyle\mathbf{v}^{t}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.E42.m1.1d">bold_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(1-z^{t}_{s,i})\odot\mathbf{v}^{t-1}_{i}+z^{t}_{s,i}\odot\tilde{%
\mathbf{v}^{t}_{i}}" class="ltx_Math" display="inline" id="A1.E42.m2.5"><semantics id="A1.E42.m2.5a"><mrow id="A1.E42.m2.5.5" xref="A1.E42.m2.5.5.cmml"><mi id="A1.E42.m2.5.5.3" xref="A1.E42.m2.5.5.3.cmml"></mi><mo id="A1.E42.m2.5.5.2" xref="A1.E42.m2.5.5.2.cmml">=</mo><mrow id="A1.E42.m2.5.5.1" xref="A1.E42.m2.5.5.1.cmml"><mrow id="A1.E42.m2.5.5.1.1" xref="A1.E42.m2.5.5.1.1.cmml"><mrow id="A1.E42.m2.5.5.1.1.1.1" xref="A1.E42.m2.5.5.1.1.1.1.1.cmml"><mo id="A1.E42.m2.5.5.1.1.1.1.2" stretchy="false" xref="A1.E42.m2.5.5.1.1.1.1.1.cmml">(</mo><mrow id="A1.E42.m2.5.5.1.1.1.1.1" xref="A1.E42.m2.5.5.1.1.1.1.1.cmml"><mn id="A1.E42.m2.5.5.1.1.1.1.1.2" xref="A1.E42.m2.5.5.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E42.m2.5.5.1.1.1.1.1.1" xref="A1.E42.m2.5.5.1.1.1.1.1.1.cmml">−</mo><msubsup id="A1.E42.m2.5.5.1.1.1.1.1.3" xref="A1.E42.m2.5.5.1.1.1.1.1.3.cmml"><mi id="A1.E42.m2.5.5.1.1.1.1.1.3.2.2" xref="A1.E42.m2.5.5.1.1.1.1.1.3.2.2.cmml">z</mi><mrow id="A1.E42.m2.2.2.2.4" xref="A1.E42.m2.2.2.2.3.cmml"><mi id="A1.E42.m2.1.1.1.1" xref="A1.E42.m2.1.1.1.1.cmml">s</mi><mo id="A1.E42.m2.2.2.2.4.1" xref="A1.E42.m2.2.2.2.3.cmml">,</mo><mi id="A1.E42.m2.2.2.2.2" xref="A1.E42.m2.2.2.2.2.cmml">i</mi></mrow><mi id="A1.E42.m2.5.5.1.1.1.1.1.3.2.3" xref="A1.E42.m2.5.5.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo id="A1.E42.m2.5.5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E42.m2.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E42.m2.5.5.1.1.2" rspace="0.222em" xref="A1.E42.m2.5.5.1.1.2.cmml">⊙</mo><msubsup id="A1.E42.m2.5.5.1.1.3" xref="A1.E42.m2.5.5.1.1.3.cmml"><mi id="A1.E42.m2.5.5.1.1.3.2.2" xref="A1.E42.m2.5.5.1.1.3.2.2.cmml">𝐯</mi><mi id="A1.E42.m2.5.5.1.1.3.3" xref="A1.E42.m2.5.5.1.1.3.3.cmml">i</mi><mrow id="A1.E42.m2.5.5.1.1.3.2.3" xref="A1.E42.m2.5.5.1.1.3.2.3.cmml"><mi id="A1.E42.m2.5.5.1.1.3.2.3.2" xref="A1.E42.m2.5.5.1.1.3.2.3.2.cmml">t</mi><mo id="A1.E42.m2.5.5.1.1.3.2.3.1" xref="A1.E42.m2.5.5.1.1.3.2.3.1.cmml">−</mo><mn id="A1.E42.m2.5.5.1.1.3.2.3.3" xref="A1.E42.m2.5.5.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="A1.E42.m2.5.5.1.2" xref="A1.E42.m2.5.5.1.2.cmml">+</mo><mrow id="A1.E42.m2.5.5.1.3" xref="A1.E42.m2.5.5.1.3.cmml"><msubsup id="A1.E42.m2.5.5.1.3.2" xref="A1.E42.m2.5.5.1.3.2.cmml"><mi id="A1.E42.m2.5.5.1.3.2.2.2" xref="A1.E42.m2.5.5.1.3.2.2.2.cmml">z</mi><mrow id="A1.E42.m2.4.4.2.4" xref="A1.E42.m2.4.4.2.3.cmml"><mi id="A1.E42.m2.3.3.1.1" xref="A1.E42.m2.3.3.1.1.cmml">s</mi><mo id="A1.E42.m2.4.4.2.4.1" xref="A1.E42.m2.4.4.2.3.cmml">,</mo><mi id="A1.E42.m2.4.4.2.2" xref="A1.E42.m2.4.4.2.2.cmml">i</mi></mrow><mi id="A1.E42.m2.5.5.1.3.2.2.3" xref="A1.E42.m2.5.5.1.3.2.2.3.cmml">t</mi></msubsup><mo id="A1.E42.m2.5.5.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E42.m2.5.5.1.3.1.cmml">⊙</mo><mover accent="true" id="A1.E42.m2.5.5.1.3.3" xref="A1.E42.m2.5.5.1.3.3.cmml"><msubsup id="A1.E42.m2.5.5.1.3.3.2" xref="A1.E42.m2.5.5.1.3.3.2.cmml"><mi id="A1.E42.m2.5.5.1.3.3.2.2.2" xref="A1.E42.m2.5.5.1.3.3.2.2.2.cmml">𝐯</mi><mi id="A1.E42.m2.5.5.1.3.3.2.3" xref="A1.E42.m2.5.5.1.3.3.2.3.cmml">i</mi><mi id="A1.E42.m2.5.5.1.3.3.2.2.3" xref="A1.E42.m2.5.5.1.3.3.2.2.3.cmml">t</mi></msubsup><mo id="A1.E42.m2.5.5.1.3.3.1" xref="A1.E42.m2.5.5.1.3.3.1.cmml">~</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E42.m2.5b"><apply id="A1.E42.m2.5.5.cmml" xref="A1.E42.m2.5.5"><eq id="A1.E42.m2.5.5.2.cmml" xref="A1.E42.m2.5.5.2"></eq><csymbol cd="latexml" id="A1.E42.m2.5.5.3.cmml" xref="A1.E42.m2.5.5.3">absent</csymbol><apply id="A1.E42.m2.5.5.1.cmml" xref="A1.E42.m2.5.5.1"><plus id="A1.E42.m2.5.5.1.2.cmml" xref="A1.E42.m2.5.5.1.2"></plus><apply id="A1.E42.m2.5.5.1.1.cmml" xref="A1.E42.m2.5.5.1.1"><csymbol cd="latexml" id="A1.E42.m2.5.5.1.1.2.cmml" xref="A1.E42.m2.5.5.1.1.2">direct-product</csymbol><apply id="A1.E42.m2.5.5.1.1.1.1.1.cmml" xref="A1.E42.m2.5.5.1.1.1.1"><minus id="A1.E42.m2.5.5.1.1.1.1.1.1.cmml" xref="A1.E42.m2.5.5.1.1.1.1.1.1"></minus><cn id="A1.E42.m2.5.5.1.1.1.1.1.2.cmml" type="integer" xref="A1.E42.m2.5.5.1.1.1.1.1.2">1</cn><apply id="A1.E42.m2.5.5.1.1.1.1.1.3.cmml" xref="A1.E42.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E42.m2.5.5.1.1.1.1.1.3">subscript</csymbol><apply id="A1.E42.m2.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E42.m2.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.1.1.1.1.3.2.1.cmml" xref="A1.E42.m2.5.5.1.1.1.1.1.3">superscript</csymbol><ci id="A1.E42.m2.5.5.1.1.1.1.1.3.2.2.cmml" xref="A1.E42.m2.5.5.1.1.1.1.1.3.2.2">𝑧</ci><ci id="A1.E42.m2.5.5.1.1.1.1.1.3.2.3.cmml" xref="A1.E42.m2.5.5.1.1.1.1.1.3.2.3">𝑡</ci></apply><list id="A1.E42.m2.2.2.2.3.cmml" xref="A1.E42.m2.2.2.2.4"><ci id="A1.E42.m2.1.1.1.1.cmml" xref="A1.E42.m2.1.1.1.1">𝑠</ci><ci id="A1.E42.m2.2.2.2.2.cmml" xref="A1.E42.m2.2.2.2.2">𝑖</ci></list></apply></apply><apply id="A1.E42.m2.5.5.1.1.3.cmml" xref="A1.E42.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.1.3.1.cmml" xref="A1.E42.m2.5.5.1.1.3">subscript</csymbol><apply id="A1.E42.m2.5.5.1.1.3.2.cmml" xref="A1.E42.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.1.3.2.1.cmml" xref="A1.E42.m2.5.5.1.1.3">superscript</csymbol><ci id="A1.E42.m2.5.5.1.1.3.2.2.cmml" xref="A1.E42.m2.5.5.1.1.3.2.2">𝐯</ci><apply id="A1.E42.m2.5.5.1.1.3.2.3.cmml" xref="A1.E42.m2.5.5.1.1.3.2.3"><minus id="A1.E42.m2.5.5.1.1.3.2.3.1.cmml" xref="A1.E42.m2.5.5.1.1.3.2.3.1"></minus><ci id="A1.E42.m2.5.5.1.1.3.2.3.2.cmml" xref="A1.E42.m2.5.5.1.1.3.2.3.2">𝑡</ci><cn id="A1.E42.m2.5.5.1.1.3.2.3.3.cmml" type="integer" xref="A1.E42.m2.5.5.1.1.3.2.3.3">1</cn></apply></apply><ci id="A1.E42.m2.5.5.1.1.3.3.cmml" xref="A1.E42.m2.5.5.1.1.3.3">𝑖</ci></apply></apply><apply id="A1.E42.m2.5.5.1.3.cmml" xref="A1.E42.m2.5.5.1.3"><csymbol cd="latexml" id="A1.E42.m2.5.5.1.3.1.cmml" xref="A1.E42.m2.5.5.1.3.1">direct-product</csymbol><apply id="A1.E42.m2.5.5.1.3.2.cmml" xref="A1.E42.m2.5.5.1.3.2"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.3.2.1.cmml" xref="A1.E42.m2.5.5.1.3.2">subscript</csymbol><apply id="A1.E42.m2.5.5.1.3.2.2.cmml" xref="A1.E42.m2.5.5.1.3.2"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.3.2.2.1.cmml" xref="A1.E42.m2.5.5.1.3.2">superscript</csymbol><ci id="A1.E42.m2.5.5.1.3.2.2.2.cmml" xref="A1.E42.m2.5.5.1.3.2.2.2">𝑧</ci><ci id="A1.E42.m2.5.5.1.3.2.2.3.cmml" xref="A1.E42.m2.5.5.1.3.2.2.3">𝑡</ci></apply><list id="A1.E42.m2.4.4.2.3.cmml" xref="A1.E42.m2.4.4.2.4"><ci id="A1.E42.m2.3.3.1.1.cmml" xref="A1.E42.m2.3.3.1.1">𝑠</ci><ci id="A1.E42.m2.4.4.2.2.cmml" xref="A1.E42.m2.4.4.2.2">𝑖</ci></list></apply><apply id="A1.E42.m2.5.5.1.3.3.cmml" xref="A1.E42.m2.5.5.1.3.3"><ci id="A1.E42.m2.5.5.1.3.3.1.cmml" xref="A1.E42.m2.5.5.1.3.3.1">~</ci><apply id="A1.E42.m2.5.5.1.3.3.2.cmml" xref="A1.E42.m2.5.5.1.3.3.2"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.3.3.2.1.cmml" xref="A1.E42.m2.5.5.1.3.3.2">subscript</csymbol><apply id="A1.E42.m2.5.5.1.3.3.2.2.cmml" xref="A1.E42.m2.5.5.1.3.3.2"><csymbol cd="ambiguous" id="A1.E42.m2.5.5.1.3.3.2.2.1.cmml" xref="A1.E42.m2.5.5.1.3.3.2">superscript</csymbol><ci id="A1.E42.m2.5.5.1.3.3.2.2.2.cmml" xref="A1.E42.m2.5.5.1.3.3.2.2.2">𝐯</ci><ci id="A1.E42.m2.5.5.1.3.3.2.2.3.cmml" xref="A1.E42.m2.5.5.1.3.3.2.2.3">𝑡</ci></apply><ci id="A1.E42.m2.5.5.1.3.3.2.3.cmml" xref="A1.E42.m2.5.5.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E42.m2.5c">\displaystyle=(1-z^{t}_{s,i})\odot\mathbf{v}^{t-1}_{i}+z^{t}_{s,i}\odot\tilde{%
\mathbf{v}^{t}_{i}}</annotation><annotation encoding="application/x-llamapun" id="A1.E42.m2.5d">= ( 1 - italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT ) ⊙ bold_v start_POSTSUPERSCRIPT italic_t - 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT ⊙ over~ start_ARG bold_v start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(42)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.SSS2.p2">
<p class="ltx_p" id="A1.SS2.SSS2.p2.6">Where <math alttext="A_{s,i:}\in\mathbb{R}^{1\times 2n}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.1.m1.2"><semantics id="A1.SS2.SSS2.p2.1.m1.2a"><mrow id="A1.SS2.SSS2.p2.1.m1.2.3" xref="A1.SS2.SSS2.p2.1.m1.2.3.cmml"><msub id="A1.SS2.SSS2.p2.1.m1.2.3.2" xref="A1.SS2.SSS2.p2.1.m1.2.3.2.cmml"><mi id="A1.SS2.SSS2.p2.1.m1.2.3.2.2" xref="A1.SS2.SSS2.p2.1.m1.2.3.2.2.cmml">A</mi><mrow id="A1.SS2.SSS2.p2.1.m1.2.2.2" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.cmml"><mrow id="A1.SS2.SSS2.p2.1.m1.2.2.2.4.2" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.4.1.cmml"><mi id="A1.SS2.SSS2.p2.1.m1.1.1.1.1" xref="A1.SS2.SSS2.p2.1.m1.1.1.1.1.cmml">s</mi><mo id="A1.SS2.SSS2.p2.1.m1.2.2.2.4.2.1" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.4.1.cmml">,</mo><mi id="A1.SS2.SSS2.p2.1.m1.2.2.2.2" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.2.cmml">i</mi></mrow><mo id="A1.SS2.SSS2.p2.1.m1.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.3.cmml">:</mo><mi id="A1.SS2.SSS2.p2.1.m1.2.2.2.5" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.5.cmml"></mi></mrow></msub><mo id="A1.SS2.SSS2.p2.1.m1.2.3.1" xref="A1.SS2.SSS2.p2.1.m1.2.3.1.cmml">∈</mo><msup id="A1.SS2.SSS2.p2.1.m1.2.3.3" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.cmml"><mi id="A1.SS2.SSS2.p2.1.m1.2.3.3.2" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.2.cmml">ℝ</mi><mrow id="A1.SS2.SSS2.p2.1.m1.2.3.3.3" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.cmml"><mrow id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.cmml"><mn id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.2" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.2.cmml">1</mn><mo id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.1.cmml">×</mo><mn id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.3" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.3.cmml">2</mn></mrow><mo id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.1" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.1.cmml">⁢</mo><mi id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.3" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.1.m1.2b"><apply id="A1.SS2.SSS2.p2.1.m1.2.3.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3"><in id="A1.SS2.SSS2.p2.1.m1.2.3.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.1"></in><apply id="A1.SS2.SSS2.p2.1.m1.2.3.2.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.1.m1.2.3.2.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.2">subscript</csymbol><ci id="A1.SS2.SSS2.p2.1.m1.2.3.2.2.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.2.2">𝐴</ci><apply id="A1.SS2.SSS2.p2.1.m1.2.2.2.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.2.2"><ci id="A1.SS2.SSS2.p2.1.m1.2.2.2.3.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.3">:</ci><list id="A1.SS2.SSS2.p2.1.m1.2.2.2.4.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.4.2"><ci id="A1.SS2.SSS2.p2.1.m1.1.1.1.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.1.1.1.1">𝑠</ci><ci id="A1.SS2.SSS2.p2.1.m1.2.2.2.2.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.2">𝑖</ci></list><csymbol cd="latexml" id="A1.SS2.SSS2.p2.1.m1.2.2.2.5.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.2.2.5">absent</csymbol></apply></apply><apply id="A1.SS2.SSS2.p2.1.m1.2.3.3.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.1.m1.2.3.3.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3">superscript</csymbol><ci id="A1.SS2.SSS2.p2.1.m1.2.3.3.2.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.2">ℝ</ci><apply id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3"><times id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.1"></times><apply id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2"><times id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.1.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.1"></times><cn id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.2.cmml" type="integer" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.2">1</cn><cn id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.3.cmml" type="integer" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.2.3">2</cn></apply><ci id="A1.SS2.SSS2.p2.1.m1.2.3.3.3.3.cmml" xref="A1.SS2.SSS2.p2.1.m1.2.3.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.1.m1.2c">A_{s,i:}\in\mathbb{R}^{1\times 2n}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.1.m1.2d">italic_A start_POSTSUBSCRIPT italic_s , italic_i : end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × 2 italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> is a row in <math alttext="A_{s}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.2.m2.1"><semantics id="A1.SS2.SSS2.p2.2.m2.1a"><msub id="A1.SS2.SSS2.p2.2.m2.1.1" xref="A1.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="A1.SS2.SSS2.p2.2.m2.1.1.2" xref="A1.SS2.SSS2.p2.2.m2.1.1.2.cmml">A</mi><mi id="A1.SS2.SSS2.p2.2.m2.1.1.3" xref="A1.SS2.SSS2.p2.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.2.m2.1b"><apply id="A1.SS2.SSS2.p2.2.m2.1.1.cmml" xref="A1.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="A1.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="A1.SS2.SSS2.p2.2.m2.1.1.2">𝐴</ci><ci id="A1.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="A1.SS2.SSS2.p2.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.2.m2.1c">A_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.2.m2.1d">italic_A start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> corresponding to node <math alttext="v_{s,i}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.3.m3.2"><semantics id="A1.SS2.SSS2.p2.3.m3.2a"><msub id="A1.SS2.SSS2.p2.3.m3.2.3" xref="A1.SS2.SSS2.p2.3.m3.2.3.cmml"><mi id="A1.SS2.SSS2.p2.3.m3.2.3.2" xref="A1.SS2.SSS2.p2.3.m3.2.3.2.cmml">v</mi><mrow id="A1.SS2.SSS2.p2.3.m3.2.2.2.4" xref="A1.SS2.SSS2.p2.3.m3.2.2.2.3.cmml"><mi id="A1.SS2.SSS2.p2.3.m3.1.1.1.1" xref="A1.SS2.SSS2.p2.3.m3.1.1.1.1.cmml">s</mi><mo id="A1.SS2.SSS2.p2.3.m3.2.2.2.4.1" xref="A1.SS2.SSS2.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="A1.SS2.SSS2.p2.3.m3.2.2.2.2" xref="A1.SS2.SSS2.p2.3.m3.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.3.m3.2b"><apply id="A1.SS2.SSS2.p2.3.m3.2.3.cmml" xref="A1.SS2.SSS2.p2.3.m3.2.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.3.m3.2.3.1.cmml" xref="A1.SS2.SSS2.p2.3.m3.2.3">subscript</csymbol><ci id="A1.SS2.SSS2.p2.3.m3.2.3.2.cmml" xref="A1.SS2.SSS2.p2.3.m3.2.3.2">𝑣</ci><list id="A1.SS2.SSS2.p2.3.m3.2.2.2.3.cmml" xref="A1.SS2.SSS2.p2.3.m3.2.2.2.4"><ci id="A1.SS2.SSS2.p2.3.m3.1.1.1.1.cmml" xref="A1.SS2.SSS2.p2.3.m3.1.1.1.1">𝑠</ci><ci id="A1.SS2.SSS2.p2.3.m3.2.2.2.2.cmml" xref="A1.SS2.SSS2.p2.3.m3.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.3.m3.2c">v_{s,i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.3.m3.2d">italic_v start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="H\in\mathbb{R}^{d\times 2d}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.4.m4.1"><semantics id="A1.SS2.SSS2.p2.4.m4.1a"><mrow id="A1.SS2.SSS2.p2.4.m4.1.1" xref="A1.SS2.SSS2.p2.4.m4.1.1.cmml"><mi id="A1.SS2.SSS2.p2.4.m4.1.1.2" xref="A1.SS2.SSS2.p2.4.m4.1.1.2.cmml">H</mi><mo id="A1.SS2.SSS2.p2.4.m4.1.1.1" xref="A1.SS2.SSS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="A1.SS2.SSS2.p2.4.m4.1.1.3" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.cmml"><mi id="A1.SS2.SSS2.p2.4.m4.1.1.3.2" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS2.SSS2.p2.4.m4.1.1.3.3" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.cmml"><mrow id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.cmml"><mi id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.2" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.2.cmml">d</mi><mo id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.1.cmml">×</mo><mn id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.3" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.3.cmml">2</mn></mrow><mo id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.1" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.3" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.4.m4.1b"><apply id="A1.SS2.SSS2.p2.4.m4.1.1.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1"><in id="A1.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.1"></in><ci id="A1.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.2">𝐻</ci><apply id="A1.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.4.m4.1.1.3.1.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="A1.SS2.SSS2.p2.4.m4.1.1.3.2.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3"><times id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.1.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.1"></times><apply id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2"><times id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.1.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.1"></times><ci id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.2.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.2">𝑑</ci><cn id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.3.cmml" type="integer" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.2.3">2</cn></apply><ci id="A1.SS2.SSS2.p2.4.m4.1.1.3.3.3.cmml" xref="A1.SS2.SSS2.p2.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.4.m4.1c">H\in\mathbb{R}^{d\times 2d}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.4.m4.1d">italic_H ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × 2 italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> controls the weight. Information is propagated by equation (38), using the restrictions of A as the model proceeds each session. It extracts latent vectors of adjacent nodes, which are later fed into the network. The update gate <math alttext="z_{s,i}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.5.m5.2"><semantics id="A1.SS2.SSS2.p2.5.m5.2a"><msub id="A1.SS2.SSS2.p2.5.m5.2.3" xref="A1.SS2.SSS2.p2.5.m5.2.3.cmml"><mi id="A1.SS2.SSS2.p2.5.m5.2.3.2" xref="A1.SS2.SSS2.p2.5.m5.2.3.2.cmml">z</mi><mrow id="A1.SS2.SSS2.p2.5.m5.2.2.2.4" xref="A1.SS2.SSS2.p2.5.m5.2.2.2.3.cmml"><mi id="A1.SS2.SSS2.p2.5.m5.1.1.1.1" xref="A1.SS2.SSS2.p2.5.m5.1.1.1.1.cmml">s</mi><mo id="A1.SS2.SSS2.p2.5.m5.2.2.2.4.1" xref="A1.SS2.SSS2.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="A1.SS2.SSS2.p2.5.m5.2.2.2.2" xref="A1.SS2.SSS2.p2.5.m5.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.5.m5.2b"><apply id="A1.SS2.SSS2.p2.5.m5.2.3.cmml" xref="A1.SS2.SSS2.p2.5.m5.2.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.5.m5.2.3.1.cmml" xref="A1.SS2.SSS2.p2.5.m5.2.3">subscript</csymbol><ci id="A1.SS2.SSS2.p2.5.m5.2.3.2.cmml" xref="A1.SS2.SSS2.p2.5.m5.2.3.2">𝑧</ci><list id="A1.SS2.SSS2.p2.5.m5.2.2.2.3.cmml" xref="A1.SS2.SSS2.p2.5.m5.2.2.2.4"><ci id="A1.SS2.SSS2.p2.5.m5.1.1.1.1.cmml" xref="A1.SS2.SSS2.p2.5.m5.1.1.1.1">𝑠</ci><ci id="A1.SS2.SSS2.p2.5.m5.2.2.2.2.cmml" xref="A1.SS2.SSS2.p2.5.m5.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.5.m5.2c">z_{s,i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.5.m5.2d">italic_z start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> decides what information is retained, and the reset gate <math alttext="r_{s,i}" class="ltx_Math" display="inline" id="A1.SS2.SSS2.p2.6.m6.2"><semantics id="A1.SS2.SSS2.p2.6.m6.2a"><msub id="A1.SS2.SSS2.p2.6.m6.2.3" xref="A1.SS2.SSS2.p2.6.m6.2.3.cmml"><mi id="A1.SS2.SSS2.p2.6.m6.2.3.2" xref="A1.SS2.SSS2.p2.6.m6.2.3.2.cmml">r</mi><mrow id="A1.SS2.SSS2.p2.6.m6.2.2.2.4" xref="A1.SS2.SSS2.p2.6.m6.2.2.2.3.cmml"><mi id="A1.SS2.SSS2.p2.6.m6.1.1.1.1" xref="A1.SS2.SSS2.p2.6.m6.1.1.1.1.cmml">s</mi><mo id="A1.SS2.SSS2.p2.6.m6.2.2.2.4.1" xref="A1.SS2.SSS2.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="A1.SS2.SSS2.p2.6.m6.2.2.2.2" xref="A1.SS2.SSS2.p2.6.m6.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS2.p2.6.m6.2b"><apply id="A1.SS2.SSS2.p2.6.m6.2.3.cmml" xref="A1.SS2.SSS2.p2.6.m6.2.3"><csymbol cd="ambiguous" id="A1.SS2.SSS2.p2.6.m6.2.3.1.cmml" xref="A1.SS2.SSS2.p2.6.m6.2.3">subscript</csymbol><ci id="A1.SS2.SSS2.p2.6.m6.2.3.2.cmml" xref="A1.SS2.SSS2.p2.6.m6.2.3.2">𝑟</ci><list id="A1.SS2.SSS2.p2.6.m6.2.2.2.3.cmml" xref="A1.SS2.SSS2.p2.6.m6.2.2.2.4"><ci id="A1.SS2.SSS2.p2.6.m6.1.1.1.1.cmml" xref="A1.SS2.SSS2.p2.6.m6.1.1.1.1">𝑠</ci><ci id="A1.SS2.SSS2.p2.6.m6.2.2.2.2.cmml" xref="A1.SS2.SSS2.p2.6.m6.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS2.p2.6.m6.2c">r_{s,i}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS2.p2.6.m6.2d">italic_r start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> decides what is discarded. The final state combines the hidden states and the current candidate state, which is determined by the previous and current states, and the final node vector is retrieved when all nodes in the session are updated until convergence.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.3 </span>Generate session embeddings</h4>
<div class="ltx_para" id="A1.SS2.SSS3.p1">
<p class="ltx_p" id="A1.SS2.SSS3.p1.2">SR-GNN uses node vectors in each session to represent the current interest and the long-term interest of each session. Each session is represented as a long-term-interest embedding vector <math alttext="\textbf{s}_{g}" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p1.1.m1.1"><semantics id="A1.SS2.SSS3.p1.1.m1.1a"><msub id="A1.SS2.SSS3.p1.1.m1.1.1" xref="A1.SS2.SSS3.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.SSS3.p1.1.m1.1.1.2" xref="A1.SS2.SSS3.p1.1.m1.1.1.2a.cmml">s</mtext><mi id="A1.SS2.SSS3.p1.1.m1.1.1.3" xref="A1.SS2.SSS3.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p1.1.m1.1b"><apply id="A1.SS2.SSS3.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.SSS3.p1.1.m1.1.1.2a.cmml" xref="A1.SS2.SSS3.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSS3.p1.1.m1.1.1.2">s</mtext></ci><ci id="A1.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="A1.SS2.SSS3.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p1.1.m1.1c">\textbf{s}_{g}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p1.1.m1.1d">s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> that is obtained from aggregating embeddings of all items in the session, concatenated with the current-interest embedding vector <math alttext="\textbf{s}_{l}" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p1.2.m2.1"><semantics id="A1.SS2.SSS3.p1.2.m2.1a"><msub id="A1.SS2.SSS3.p1.2.m2.1.1" xref="A1.SS2.SSS3.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS2.SSS3.p1.2.m2.1.1.2" xref="A1.SS2.SSS3.p1.2.m2.1.1.2a.cmml">s</mtext><mi id="A1.SS2.SSS3.p1.2.m2.1.1.3" xref="A1.SS2.SSS3.p1.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p1.2.m2.1b"><apply id="A1.SS2.SSS3.p1.2.m2.1.1.cmml" xref="A1.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="A1.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.SSS3.p1.2.m2.1.1.2a.cmml" xref="A1.SS2.SSS3.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="A1.SS2.SSS3.p1.2.m2.1.1.2">s</mtext></ci><ci id="A1.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="A1.SS2.SSS3.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p1.2.m2.1c">\textbf{s}_{l}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p1.2.m2.1d">s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, which is the embedding of the last item in the session. SR-GNN uses a soft-attention mechanism was used to prioritize different interests when calculating the long-term-interest embedding vector.</p>
</div>
<div class="ltx_para" id="A1.SS2.SSS3.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx19">
<tbody id="A1.E43"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha_{i}" class="ltx_Math" display="inline" id="A1.E43.m1.1"><semantics id="A1.E43.m1.1a"><msub id="A1.E43.m1.1.1" xref="A1.E43.m1.1.1.cmml"><mi id="A1.E43.m1.1.1.2" xref="A1.E43.m1.1.1.2.cmml">α</mi><mi id="A1.E43.m1.1.1.3" xref="A1.E43.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.E43.m1.1b"><apply id="A1.E43.m1.1.1.cmml" xref="A1.E43.m1.1.1"><csymbol cd="ambiguous" id="A1.E43.m1.1.1.1.cmml" xref="A1.E43.m1.1.1">subscript</csymbol><ci id="A1.E43.m1.1.1.2.cmml" xref="A1.E43.m1.1.1.2">𝛼</ci><ci id="A1.E43.m1.1.1.3.cmml" xref="A1.E43.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E43.m1.1c">\displaystyle\alpha_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.E43.m1.1d">italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=q^{T}\sigma(W_{1}\mathbf{v}_{n}+W_{2}\mathbf{v}_{i}+c)" class="ltx_Math" display="inline" id="A1.E43.m2.1"><semantics id="A1.E43.m2.1a"><mrow id="A1.E43.m2.1.1" xref="A1.E43.m2.1.1.cmml"><mi id="A1.E43.m2.1.1.3" xref="A1.E43.m2.1.1.3.cmml"></mi><mo id="A1.E43.m2.1.1.2" xref="A1.E43.m2.1.1.2.cmml">=</mo><mrow id="A1.E43.m2.1.1.1" xref="A1.E43.m2.1.1.1.cmml"><msup id="A1.E43.m2.1.1.1.3" xref="A1.E43.m2.1.1.1.3.cmml"><mi id="A1.E43.m2.1.1.1.3.2" xref="A1.E43.m2.1.1.1.3.2.cmml">q</mi><mi id="A1.E43.m2.1.1.1.3.3" xref="A1.E43.m2.1.1.1.3.3.cmml">T</mi></msup><mo id="A1.E43.m2.1.1.1.2" xref="A1.E43.m2.1.1.1.2.cmml">⁢</mo><mi id="A1.E43.m2.1.1.1.4" xref="A1.E43.m2.1.1.1.4.cmml">σ</mi><mo id="A1.E43.m2.1.1.1.2a" xref="A1.E43.m2.1.1.1.2.cmml">⁢</mo><mrow id="A1.E43.m2.1.1.1.1.1" xref="A1.E43.m2.1.1.1.1.1.1.cmml"><mo id="A1.E43.m2.1.1.1.1.1.2" stretchy="false" xref="A1.E43.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E43.m2.1.1.1.1.1.1" xref="A1.E43.m2.1.1.1.1.1.1.cmml"><mrow id="A1.E43.m2.1.1.1.1.1.1.2" xref="A1.E43.m2.1.1.1.1.1.1.2.cmml"><msub id="A1.E43.m2.1.1.1.1.1.1.2.2" xref="A1.E43.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E43.m2.1.1.1.1.1.1.2.2.2" xref="A1.E43.m2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mn id="A1.E43.m2.1.1.1.1.1.1.2.2.3" xref="A1.E43.m2.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="A1.E43.m2.1.1.1.1.1.1.2.1" xref="A1.E43.m2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="A1.E43.m2.1.1.1.1.1.1.2.3" xref="A1.E43.m2.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E43.m2.1.1.1.1.1.1.2.3.2" xref="A1.E43.m2.1.1.1.1.1.1.2.3.2.cmml">𝐯</mi><mi id="A1.E43.m2.1.1.1.1.1.1.2.3.3" xref="A1.E43.m2.1.1.1.1.1.1.2.3.3.cmml">n</mi></msub></mrow><mo id="A1.E43.m2.1.1.1.1.1.1.1" xref="A1.E43.m2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="A1.E43.m2.1.1.1.1.1.1.3" xref="A1.E43.m2.1.1.1.1.1.1.3.cmml"><msub id="A1.E43.m2.1.1.1.1.1.1.3.2" xref="A1.E43.m2.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E43.m2.1.1.1.1.1.1.3.2.2" xref="A1.E43.m2.1.1.1.1.1.1.3.2.2.cmml">W</mi><mn id="A1.E43.m2.1.1.1.1.1.1.3.2.3" xref="A1.E43.m2.1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="A1.E43.m2.1.1.1.1.1.1.3.1" xref="A1.E43.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.E43.m2.1.1.1.1.1.1.3.3" xref="A1.E43.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E43.m2.1.1.1.1.1.1.3.3.2" xref="A1.E43.m2.1.1.1.1.1.1.3.3.2.cmml">𝐯</mi><mi id="A1.E43.m2.1.1.1.1.1.1.3.3.3" xref="A1.E43.m2.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow><mo id="A1.E43.m2.1.1.1.1.1.1.1a" xref="A1.E43.m2.1.1.1.1.1.1.1.cmml">+</mo><mi id="A1.E43.m2.1.1.1.1.1.1.4" xref="A1.E43.m2.1.1.1.1.1.1.4.cmml">c</mi></mrow><mo id="A1.E43.m2.1.1.1.1.1.3" stretchy="false" xref="A1.E43.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E43.m2.1b"><apply id="A1.E43.m2.1.1.cmml" xref="A1.E43.m2.1.1"><eq id="A1.E43.m2.1.1.2.cmml" xref="A1.E43.m2.1.1.2"></eq><csymbol cd="latexml" id="A1.E43.m2.1.1.3.cmml" xref="A1.E43.m2.1.1.3">absent</csymbol><apply id="A1.E43.m2.1.1.1.cmml" xref="A1.E43.m2.1.1.1"><times id="A1.E43.m2.1.1.1.2.cmml" xref="A1.E43.m2.1.1.1.2"></times><apply id="A1.E43.m2.1.1.1.3.cmml" xref="A1.E43.m2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E43.m2.1.1.1.3.1.cmml" xref="A1.E43.m2.1.1.1.3">superscript</csymbol><ci id="A1.E43.m2.1.1.1.3.2.cmml" xref="A1.E43.m2.1.1.1.3.2">𝑞</ci><ci id="A1.E43.m2.1.1.1.3.3.cmml" xref="A1.E43.m2.1.1.1.3.3">𝑇</ci></apply><ci id="A1.E43.m2.1.1.1.4.cmml" xref="A1.E43.m2.1.1.1.4">𝜎</ci><apply id="A1.E43.m2.1.1.1.1.1.1.cmml" xref="A1.E43.m2.1.1.1.1.1"><plus id="A1.E43.m2.1.1.1.1.1.1.1.cmml" xref="A1.E43.m2.1.1.1.1.1.1.1"></plus><apply id="A1.E43.m2.1.1.1.1.1.1.2.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2"><times id="A1.E43.m2.1.1.1.1.1.1.2.1.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.1"></times><apply id="A1.E43.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E43.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E43.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.2.2">𝑊</ci><cn id="A1.E43.m2.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="A1.E43.m2.1.1.1.1.1.1.2.2.3">1</cn></apply><apply id="A1.E43.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E43.m2.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E43.m2.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.3.2">𝐯</ci><ci id="A1.E43.m2.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E43.m2.1.1.1.1.1.1.2.3.3">𝑛</ci></apply></apply><apply id="A1.E43.m2.1.1.1.1.1.1.3.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3"><times id="A1.E43.m2.1.1.1.1.1.1.3.1.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.1"></times><apply id="A1.E43.m2.1.1.1.1.1.1.3.2.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E43.m2.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E43.m2.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.2.2">𝑊</ci><cn id="A1.E43.m2.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="A1.E43.m2.1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="A1.E43.m2.1.1.1.1.1.1.3.3.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E43.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E43.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.3.2">𝐯</ci><ci id="A1.E43.m2.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E43.m2.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><ci id="A1.E43.m2.1.1.1.1.1.1.4.cmml" xref="A1.E43.m2.1.1.1.1.1.1.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E43.m2.1c">\displaystyle=q^{T}\sigma(W_{1}\mathbf{v}_{n}+W_{2}\mathbf{v}_{i}+c)</annotation><annotation encoding="application/x-llamapun" id="A1.E43.m2.1d">= italic_q start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_σ ( italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT + italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_c )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(43)</span></td>
</tr></tbody>
<tbody id="A1.E44"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle s_{g}" class="ltx_Math" display="inline" id="A1.E44.m1.1"><semantics id="A1.E44.m1.1a"><msub id="A1.E44.m1.1.1" xref="A1.E44.m1.1.1.cmml"><mi id="A1.E44.m1.1.1.2" xref="A1.E44.m1.1.1.2.cmml">s</mi><mi id="A1.E44.m1.1.1.3" xref="A1.E44.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A1.E44.m1.1b"><apply id="A1.E44.m1.1.1.cmml" xref="A1.E44.m1.1.1"><csymbol cd="ambiguous" id="A1.E44.m1.1.1.1.cmml" xref="A1.E44.m1.1.1">subscript</csymbol><ci id="A1.E44.m1.1.1.2.cmml" xref="A1.E44.m1.1.1.2">𝑠</ci><ci id="A1.E44.m1.1.1.3.cmml" xref="A1.E44.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E44.m1.1c">\displaystyle s_{g}</annotation><annotation encoding="application/x-llamapun" id="A1.E44.m1.1d">italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\displaystyle\sum^{n}_{i=1}\alpha_{i}\mathbf{v}_{i}" class="ltx_Math" display="inline" id="A1.E44.m2.1"><semantics id="A1.E44.m2.1a"><mrow id="A1.E44.m2.1.1" xref="A1.E44.m2.1.1.cmml"><mi id="A1.E44.m2.1.1.2" xref="A1.E44.m2.1.1.2.cmml"></mi><mo id="A1.E44.m2.1.1.1" xref="A1.E44.m2.1.1.1.cmml">=</mo><mrow id="A1.E44.m2.1.1.3" xref="A1.E44.m2.1.1.3.cmml"><mstyle displaystyle="true" id="A1.E44.m2.1.1.3.1" xref="A1.E44.m2.1.1.3.1.cmml"><munderover id="A1.E44.m2.1.1.3.1a" xref="A1.E44.m2.1.1.3.1.cmml"><mo id="A1.E44.m2.1.1.3.1.2.2" movablelimits="false" xref="A1.E44.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="A1.E44.m2.1.1.3.1.3" xref="A1.E44.m2.1.1.3.1.3.cmml"><mi id="A1.E44.m2.1.1.3.1.3.2" xref="A1.E44.m2.1.1.3.1.3.2.cmml">i</mi><mo id="A1.E44.m2.1.1.3.1.3.1" xref="A1.E44.m2.1.1.3.1.3.1.cmml">=</mo><mn id="A1.E44.m2.1.1.3.1.3.3" xref="A1.E44.m2.1.1.3.1.3.3.cmml">1</mn></mrow><mi id="A1.E44.m2.1.1.3.1.2.3" xref="A1.E44.m2.1.1.3.1.2.3.cmml">n</mi></munderover></mstyle><mrow id="A1.E44.m2.1.1.3.2" xref="A1.E44.m2.1.1.3.2.cmml"><msub id="A1.E44.m2.1.1.3.2.2" xref="A1.E44.m2.1.1.3.2.2.cmml"><mi id="A1.E44.m2.1.1.3.2.2.2" xref="A1.E44.m2.1.1.3.2.2.2.cmml">α</mi><mi id="A1.E44.m2.1.1.3.2.2.3" xref="A1.E44.m2.1.1.3.2.2.3.cmml">i</mi></msub><mo id="A1.E44.m2.1.1.3.2.1" xref="A1.E44.m2.1.1.3.2.1.cmml">⁢</mo><msub id="A1.E44.m2.1.1.3.2.3" xref="A1.E44.m2.1.1.3.2.3.cmml"><mi id="A1.E44.m2.1.1.3.2.3.2" xref="A1.E44.m2.1.1.3.2.3.2.cmml">𝐯</mi><mi id="A1.E44.m2.1.1.3.2.3.3" xref="A1.E44.m2.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E44.m2.1b"><apply id="A1.E44.m2.1.1.cmml" xref="A1.E44.m2.1.1"><eq id="A1.E44.m2.1.1.1.cmml" xref="A1.E44.m2.1.1.1"></eq><csymbol cd="latexml" id="A1.E44.m2.1.1.2.cmml" xref="A1.E44.m2.1.1.2">absent</csymbol><apply id="A1.E44.m2.1.1.3.cmml" xref="A1.E44.m2.1.1.3"><apply id="A1.E44.m2.1.1.3.1.cmml" xref="A1.E44.m2.1.1.3.1"><csymbol cd="ambiguous" id="A1.E44.m2.1.1.3.1.1.cmml" xref="A1.E44.m2.1.1.3.1">subscript</csymbol><apply id="A1.E44.m2.1.1.3.1.2.cmml" xref="A1.E44.m2.1.1.3.1"><csymbol cd="ambiguous" id="A1.E44.m2.1.1.3.1.2.1.cmml" xref="A1.E44.m2.1.1.3.1">superscript</csymbol><sum id="A1.E44.m2.1.1.3.1.2.2.cmml" xref="A1.E44.m2.1.1.3.1.2.2"></sum><ci id="A1.E44.m2.1.1.3.1.2.3.cmml" xref="A1.E44.m2.1.1.3.1.2.3">𝑛</ci></apply><apply id="A1.E44.m2.1.1.3.1.3.cmml" xref="A1.E44.m2.1.1.3.1.3"><eq id="A1.E44.m2.1.1.3.1.3.1.cmml" xref="A1.E44.m2.1.1.3.1.3.1"></eq><ci id="A1.E44.m2.1.1.3.1.3.2.cmml" xref="A1.E44.m2.1.1.3.1.3.2">𝑖</ci><cn id="A1.E44.m2.1.1.3.1.3.3.cmml" type="integer" xref="A1.E44.m2.1.1.3.1.3.3">1</cn></apply></apply><apply id="A1.E44.m2.1.1.3.2.cmml" xref="A1.E44.m2.1.1.3.2"><times id="A1.E44.m2.1.1.3.2.1.cmml" xref="A1.E44.m2.1.1.3.2.1"></times><apply id="A1.E44.m2.1.1.3.2.2.cmml" xref="A1.E44.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E44.m2.1.1.3.2.2.1.cmml" xref="A1.E44.m2.1.1.3.2.2">subscript</csymbol><ci id="A1.E44.m2.1.1.3.2.2.2.cmml" xref="A1.E44.m2.1.1.3.2.2.2">𝛼</ci><ci id="A1.E44.m2.1.1.3.2.2.3.cmml" xref="A1.E44.m2.1.1.3.2.2.3">𝑖</ci></apply><apply id="A1.E44.m2.1.1.3.2.3.cmml" xref="A1.E44.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E44.m2.1.1.3.2.3.1.cmml" xref="A1.E44.m2.1.1.3.2.3">subscript</csymbol><ci id="A1.E44.m2.1.1.3.2.3.2.cmml" xref="A1.E44.m2.1.1.3.2.3.2">𝐯</ci><ci id="A1.E44.m2.1.1.3.2.3.3.cmml" xref="A1.E44.m2.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E44.m2.1c">\displaystyle=\displaystyle\sum^{n}_{i=1}\alpha_{i}\mathbf{v}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.E44.m2.1d">= ∑ start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(44)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.SSS3.p3">
<p class="ltx_p" id="A1.SS2.SSS3.p3.2">Where <math alttext="q\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p3.1.m1.1"><semantics id="A1.SS2.SSS3.p3.1.m1.1a"><mrow id="A1.SS2.SSS3.p3.1.m1.1.1" xref="A1.SS2.SSS3.p3.1.m1.1.1.cmml"><mi id="A1.SS2.SSS3.p3.1.m1.1.1.2" xref="A1.SS2.SSS3.p3.1.m1.1.1.2.cmml">q</mi><mo id="A1.SS2.SSS3.p3.1.m1.1.1.1" xref="A1.SS2.SSS3.p3.1.m1.1.1.1.cmml">∈</mo><msup id="A1.SS2.SSS3.p3.1.m1.1.1.3" xref="A1.SS2.SSS3.p3.1.m1.1.1.3.cmml"><mi id="A1.SS2.SSS3.p3.1.m1.1.1.3.2" xref="A1.SS2.SSS3.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="A1.SS2.SSS3.p3.1.m1.1.1.3.3" xref="A1.SS2.SSS3.p3.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p3.1.m1.1b"><apply id="A1.SS2.SSS3.p3.1.m1.1.1.cmml" xref="A1.SS2.SSS3.p3.1.m1.1.1"><in id="A1.SS2.SSS3.p3.1.m1.1.1.1.cmml" xref="A1.SS2.SSS3.p3.1.m1.1.1.1"></in><ci id="A1.SS2.SSS3.p3.1.m1.1.1.2.cmml" xref="A1.SS2.SSS3.p3.1.m1.1.1.2">𝑞</ci><apply id="A1.SS2.SSS3.p3.1.m1.1.1.3.cmml" xref="A1.SS2.SSS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p3.1.m1.1.1.3.1.cmml" xref="A1.SS2.SSS3.p3.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS2.SSS3.p3.1.m1.1.1.3.2.cmml" xref="A1.SS2.SSS3.p3.1.m1.1.1.3.2">ℝ</ci><ci id="A1.SS2.SSS3.p3.1.m1.1.1.3.3.cmml" xref="A1.SS2.SSS3.p3.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p3.1.m1.1c">q\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p3.1.m1.1d">italic_q ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{1},W_{2}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="A1.SS2.SSS3.p3.2.m2.2"><semantics id="A1.SS2.SSS3.p3.2.m2.2a"><mrow id="A1.SS2.SSS3.p3.2.m2.2.2" xref="A1.SS2.SSS3.p3.2.m2.2.2.cmml"><mrow id="A1.SS2.SSS3.p3.2.m2.2.2.2.2" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.3.cmml"><msub id="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1" xref="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.2" xref="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.2.cmml">W</mi><mn id="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.3" xref="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.3" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.cmml"><mi id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.2" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.2.cmml">W</mi><mn id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.3" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.3.cmml">2</mn></msub></mrow><mo id="A1.SS2.SSS3.p3.2.m2.2.2.3" xref="A1.SS2.SSS3.p3.2.m2.2.2.3.cmml">∈</mo><msup id="A1.SS2.SSS3.p3.2.m2.2.2.4" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.cmml"><mi id="A1.SS2.SSS3.p3.2.m2.2.2.4.2" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.2.cmml">ℝ</mi><mrow id="A1.SS2.SSS3.p3.2.m2.2.2.4.3" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3.cmml"><mi id="A1.SS2.SSS3.p3.2.m2.2.2.4.3.2" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3.2.cmml">d</mi><mo id="A1.SS2.SSS3.p3.2.m2.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3.1.cmml">×</mo><mi id="A1.SS2.SSS3.p3.2.m2.2.2.4.3.3" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS3.p3.2.m2.2b"><apply id="A1.SS2.SSS3.p3.2.m2.2.2.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2"><in id="A1.SS2.SSS3.p3.2.m2.2.2.3.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.3"></in><list id="A1.SS2.SSS3.p3.2.m2.2.2.2.3.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2"><apply id="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.cmml" xref="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.2">𝑊</ci><cn id="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="A1.SS2.SSS3.p3.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.1.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.2.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.2">𝑊</ci><cn id="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="A1.SS2.SSS3.p3.2.m2.2.2.2.2.2.3">2</cn></apply></list><apply id="A1.SS2.SSS3.p3.2.m2.2.2.4.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="A1.SS2.SSS3.p3.2.m2.2.2.4.1.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.4">superscript</csymbol><ci id="A1.SS2.SSS3.p3.2.m2.2.2.4.2.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.2">ℝ</ci><apply id="A1.SS2.SSS3.p3.2.m2.2.2.4.3.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3"><times id="A1.SS2.SSS3.p3.2.m2.2.2.4.3.1.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3.1"></times><ci id="A1.SS2.SSS3.p3.2.m2.2.2.4.3.2.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3.2">𝑑</ci><ci id="A1.SS2.SSS3.p3.2.m2.2.2.4.3.3.cmml" xref="A1.SS2.SSS3.p3.2.m2.2.2.4.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS3.p3.2.m2.2c">W_{1},W_{2}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS3.p3.2.m2.2d">italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> control the item embedding vectors’ weights. The final hybrid embedding is obtained by a linear transformation of the concatenation of the current-interest embedding vector and long-term-interest embedding vector.</p>
</div>
<div class="ltx_para" id="A1.SS2.SSS3.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx20">
<tbody id="A1.E45"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle s_{h}=W_{3}[s_{1};s_{g}]" class="ltx_Math" display="inline" id="A1.E45.m1.2"><semantics id="A1.E45.m1.2a"><mrow id="A1.E45.m1.2.2" xref="A1.E45.m1.2.2.cmml"><msub id="A1.E45.m1.2.2.4" xref="A1.E45.m1.2.2.4.cmml"><mi id="A1.E45.m1.2.2.4.2" xref="A1.E45.m1.2.2.4.2.cmml">s</mi><mi id="A1.E45.m1.2.2.4.3" xref="A1.E45.m1.2.2.4.3.cmml">h</mi></msub><mo id="A1.E45.m1.2.2.3" xref="A1.E45.m1.2.2.3.cmml">=</mo><mrow id="A1.E45.m1.2.2.2" xref="A1.E45.m1.2.2.2.cmml"><msub id="A1.E45.m1.2.2.2.4" xref="A1.E45.m1.2.2.2.4.cmml"><mi id="A1.E45.m1.2.2.2.4.2" xref="A1.E45.m1.2.2.2.4.2.cmml">W</mi><mn id="A1.E45.m1.2.2.2.4.3" xref="A1.E45.m1.2.2.2.4.3.cmml">3</mn></msub><mo id="A1.E45.m1.2.2.2.3" xref="A1.E45.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E45.m1.2.2.2.2.2" xref="A1.E45.m1.2.2.2.2.3.cmml"><mo id="A1.E45.m1.2.2.2.2.2.3" stretchy="false" xref="A1.E45.m1.2.2.2.2.3.cmml">[</mo><msub id="A1.E45.m1.1.1.1.1.1.1" xref="A1.E45.m1.1.1.1.1.1.1.cmml"><mi id="A1.E45.m1.1.1.1.1.1.1.2" xref="A1.E45.m1.1.1.1.1.1.1.2.cmml">s</mi><mn id="A1.E45.m1.1.1.1.1.1.1.3" xref="A1.E45.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.E45.m1.2.2.2.2.2.4" xref="A1.E45.m1.2.2.2.2.3.cmml">;</mo><msub id="A1.E45.m1.2.2.2.2.2.2" xref="A1.E45.m1.2.2.2.2.2.2.cmml"><mi id="A1.E45.m1.2.2.2.2.2.2.2" xref="A1.E45.m1.2.2.2.2.2.2.2.cmml">s</mi><mi id="A1.E45.m1.2.2.2.2.2.2.3" xref="A1.E45.m1.2.2.2.2.2.2.3.cmml">g</mi></msub><mo id="A1.E45.m1.2.2.2.2.2.5" stretchy="false" xref="A1.E45.m1.2.2.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E45.m1.2b"><apply id="A1.E45.m1.2.2.cmml" xref="A1.E45.m1.2.2"><eq id="A1.E45.m1.2.2.3.cmml" xref="A1.E45.m1.2.2.3"></eq><apply id="A1.E45.m1.2.2.4.cmml" xref="A1.E45.m1.2.2.4"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.4.1.cmml" xref="A1.E45.m1.2.2.4">subscript</csymbol><ci id="A1.E45.m1.2.2.4.2.cmml" xref="A1.E45.m1.2.2.4.2">𝑠</ci><ci id="A1.E45.m1.2.2.4.3.cmml" xref="A1.E45.m1.2.2.4.3">ℎ</ci></apply><apply id="A1.E45.m1.2.2.2.cmml" xref="A1.E45.m1.2.2.2"><times id="A1.E45.m1.2.2.2.3.cmml" xref="A1.E45.m1.2.2.2.3"></times><apply id="A1.E45.m1.2.2.2.4.cmml" xref="A1.E45.m1.2.2.2.4"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.2.4.1.cmml" xref="A1.E45.m1.2.2.2.4">subscript</csymbol><ci id="A1.E45.m1.2.2.2.4.2.cmml" xref="A1.E45.m1.2.2.2.4.2">𝑊</ci><cn id="A1.E45.m1.2.2.2.4.3.cmml" type="integer" xref="A1.E45.m1.2.2.2.4.3">3</cn></apply><list id="A1.E45.m1.2.2.2.2.3.cmml" xref="A1.E45.m1.2.2.2.2.2"><apply id="A1.E45.m1.1.1.1.1.1.1.cmml" xref="A1.E45.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E45.m1.1.1.1.1.1.1.1.cmml" xref="A1.E45.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E45.m1.1.1.1.1.1.1.2.cmml" xref="A1.E45.m1.1.1.1.1.1.1.2">𝑠</ci><cn id="A1.E45.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E45.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="A1.E45.m1.2.2.2.2.2.2.cmml" xref="A1.E45.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E45.m1.2.2.2.2.2.2.1.cmml" xref="A1.E45.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E45.m1.2.2.2.2.2.2.2.cmml" xref="A1.E45.m1.2.2.2.2.2.2.2">𝑠</ci><ci id="A1.E45.m1.2.2.2.2.2.2.3.cmml" xref="A1.E45.m1.2.2.2.2.2.2.3">𝑔</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E45.m1.2c">\displaystyle s_{h}=W_{3}[s_{1};s_{g}]</annotation><annotation encoding="application/x-llamapun" id="A1.E45.m1.2d">italic_s start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_s start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(45)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.4 </span>Make recommendations</h4>
<div class="ltx_para" id="A1.SS2.SSS4.p1">
<p class="ltx_p" id="A1.SS2.SSS4.p1.1">A recommendation score <math alttext="\hat{z}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p1.1.m1.1"><semantics id="A1.SS2.SSS4.p1.1.m1.1a"><mover accent="true" id="A1.SS2.SSS4.p1.1.m1.1.1" xref="A1.SS2.SSS4.p1.1.m1.1.1.cmml"><mi id="A1.SS2.SSS4.p1.1.m1.1.1.2" xref="A1.SS2.SSS4.p1.1.m1.1.1.2.cmml">z</mi><mo id="A1.SS2.SSS4.p1.1.m1.1.1.1" xref="A1.SS2.SSS4.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p1.1.m1.1b"><apply id="A1.SS2.SSS4.p1.1.m1.1.1.cmml" xref="A1.SS2.SSS4.p1.1.m1.1.1"><ci id="A1.SS2.SSS4.p1.1.m1.1.1.1.cmml" xref="A1.SS2.SSS4.p1.1.m1.1.1.1">^</ci><ci id="A1.SS2.SSS4.p1.1.m1.1.1.2.cmml" xref="A1.SS2.SSS4.p1.1.m1.1.1.2">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p1.1.m1.1c">\hat{z}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p1.1.m1.1d">over^ start_ARG italic_z end_ARG</annotation></semantics></math> is computed using the embedding of each session calculated in the last component by:</p>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx21">
<tbody id="A1.E46"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{z}_{i}=s^{T}_{h}\mathbf{v}_{i}" class="ltx_Math" display="inline" id="A1.E46.m1.1"><semantics id="A1.E46.m1.1a"><mrow id="A1.E46.m1.1.1" xref="A1.E46.m1.1.1.cmml"><msub id="A1.E46.m1.1.1.2" xref="A1.E46.m1.1.1.2.cmml"><mover accent="true" id="A1.E46.m1.1.1.2.2" xref="A1.E46.m1.1.1.2.2.cmml"><mi id="A1.E46.m1.1.1.2.2.2" xref="A1.E46.m1.1.1.2.2.2.cmml">z</mi><mo id="A1.E46.m1.1.1.2.2.1" xref="A1.E46.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="A1.E46.m1.1.1.2.3" xref="A1.E46.m1.1.1.2.3.cmml">i</mi></msub><mo id="A1.E46.m1.1.1.1" xref="A1.E46.m1.1.1.1.cmml">=</mo><mrow id="A1.E46.m1.1.1.3" xref="A1.E46.m1.1.1.3.cmml"><msubsup id="A1.E46.m1.1.1.3.2" xref="A1.E46.m1.1.1.3.2.cmml"><mi id="A1.E46.m1.1.1.3.2.2.2" xref="A1.E46.m1.1.1.3.2.2.2.cmml">s</mi><mi id="A1.E46.m1.1.1.3.2.3" xref="A1.E46.m1.1.1.3.2.3.cmml">h</mi><mi id="A1.E46.m1.1.1.3.2.2.3" xref="A1.E46.m1.1.1.3.2.2.3.cmml">T</mi></msubsup><mo id="A1.E46.m1.1.1.3.1" xref="A1.E46.m1.1.1.3.1.cmml">⁢</mo><msub id="A1.E46.m1.1.1.3.3" xref="A1.E46.m1.1.1.3.3.cmml"><mi id="A1.E46.m1.1.1.3.3.2" xref="A1.E46.m1.1.1.3.3.2.cmml">𝐯</mi><mi id="A1.E46.m1.1.1.3.3.3" xref="A1.E46.m1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E46.m1.1b"><apply id="A1.E46.m1.1.1.cmml" xref="A1.E46.m1.1.1"><eq id="A1.E46.m1.1.1.1.cmml" xref="A1.E46.m1.1.1.1"></eq><apply id="A1.E46.m1.1.1.2.cmml" xref="A1.E46.m1.1.1.2"><csymbol cd="ambiguous" id="A1.E46.m1.1.1.2.1.cmml" xref="A1.E46.m1.1.1.2">subscript</csymbol><apply id="A1.E46.m1.1.1.2.2.cmml" xref="A1.E46.m1.1.1.2.2"><ci id="A1.E46.m1.1.1.2.2.1.cmml" xref="A1.E46.m1.1.1.2.2.1">^</ci><ci id="A1.E46.m1.1.1.2.2.2.cmml" xref="A1.E46.m1.1.1.2.2.2">𝑧</ci></apply><ci id="A1.E46.m1.1.1.2.3.cmml" xref="A1.E46.m1.1.1.2.3">𝑖</ci></apply><apply id="A1.E46.m1.1.1.3.cmml" xref="A1.E46.m1.1.1.3"><times id="A1.E46.m1.1.1.3.1.cmml" xref="A1.E46.m1.1.1.3.1"></times><apply id="A1.E46.m1.1.1.3.2.cmml" xref="A1.E46.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E46.m1.1.1.3.2.1.cmml" xref="A1.E46.m1.1.1.3.2">subscript</csymbol><apply id="A1.E46.m1.1.1.3.2.2.cmml" xref="A1.E46.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E46.m1.1.1.3.2.2.1.cmml" xref="A1.E46.m1.1.1.3.2">superscript</csymbol><ci id="A1.E46.m1.1.1.3.2.2.2.cmml" xref="A1.E46.m1.1.1.3.2.2.2">𝑠</ci><ci id="A1.E46.m1.1.1.3.2.2.3.cmml" xref="A1.E46.m1.1.1.3.2.2.3">𝑇</ci></apply><ci id="A1.E46.m1.1.1.3.2.3.cmml" xref="A1.E46.m1.1.1.3.2.3">ℎ</ci></apply><apply id="A1.E46.m1.1.1.3.3.cmml" xref="A1.E46.m1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E46.m1.1.1.3.3.1.cmml" xref="A1.E46.m1.1.1.3.3">subscript</csymbol><ci id="A1.E46.m1.1.1.3.3.2.cmml" xref="A1.E46.m1.1.1.3.3.2">𝐯</ci><ci id="A1.E46.m1.1.1.3.3.3.cmml" xref="A1.E46.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E46.m1.1c">\displaystyle\hat{z}_{i}=s^{T}_{h}\mathbf{v}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.E46.m1.1d">over^ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_s start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT bold_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(46)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p3">
<p class="ltx_p" id="A1.SS2.SSS4.p3.1">The output vector <math alttext="\hat{y}" class="ltx_Math" display="inline" id="A1.SS2.SSS4.p3.1.m1.1"><semantics id="A1.SS2.SSS4.p3.1.m1.1a"><mover accent="true" id="A1.SS2.SSS4.p3.1.m1.1.1" xref="A1.SS2.SSS4.p3.1.m1.1.1.cmml"><mi id="A1.SS2.SSS4.p3.1.m1.1.1.2" xref="A1.SS2.SSS4.p3.1.m1.1.1.2.cmml">y</mi><mo id="A1.SS2.SSS4.p3.1.m1.1.1.1" xref="A1.SS2.SSS4.p3.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.SSS4.p3.1.m1.1b"><apply id="A1.SS2.SSS4.p3.1.m1.1.1.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1"><ci id="A1.SS2.SSS4.p3.1.m1.1.1.1.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1.1">^</ci><ci id="A1.SS2.SSS4.p3.1.m1.1.1.2.cmml" xref="A1.SS2.SSS4.p3.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.SSS4.p3.1.m1.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.SSS4.p3.1.m1.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> of model is obtained using a soft-max function of the recommendation score:</p>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx22">
<tbody id="A1.E47"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{y}=softmax(\hat{z})" class="ltx_Math" display="inline" id="A1.E47.m1.1"><semantics id="A1.E47.m1.1a"><mrow id="A1.E47.m1.1.2" xref="A1.E47.m1.1.2.cmml"><mover accent="true" id="A1.E47.m1.1.2.2" xref="A1.E47.m1.1.2.2.cmml"><mi id="A1.E47.m1.1.2.2.2" xref="A1.E47.m1.1.2.2.2.cmml">y</mi><mo id="A1.E47.m1.1.2.2.1" xref="A1.E47.m1.1.2.2.1.cmml">^</mo></mover><mo id="A1.E47.m1.1.2.1" xref="A1.E47.m1.1.2.1.cmml">=</mo><mrow id="A1.E47.m1.1.2.3" xref="A1.E47.m1.1.2.3.cmml"><mi id="A1.E47.m1.1.2.3.2" xref="A1.E47.m1.1.2.3.2.cmml">s</mi><mo id="A1.E47.m1.1.2.3.1" xref="A1.E47.m1.1.2.3.1.cmml">⁢</mo><mi id="A1.E47.m1.1.2.3.3" xref="A1.E47.m1.1.2.3.3.cmml">o</mi><mo id="A1.E47.m1.1.2.3.1a" xref="A1.E47.m1.1.2.3.1.cmml">⁢</mo><mi id="A1.E47.m1.1.2.3.4" xref="A1.E47.m1.1.2.3.4.cmml">f</mi><mo id="A1.E47.m1.1.2.3.1b" xref="A1.E47.m1.1.2.3.1.cmml">⁢</mo><mi id="A1.E47.m1.1.2.3.5" xref="A1.E47.m1.1.2.3.5.cmml">t</mi><mo id="A1.E47.m1.1.2.3.1c" xref="A1.E47.m1.1.2.3.1.cmml">⁢</mo><mi id="A1.E47.m1.1.2.3.6" xref="A1.E47.m1.1.2.3.6.cmml">m</mi><mo id="A1.E47.m1.1.2.3.1d" xref="A1.E47.m1.1.2.3.1.cmml">⁢</mo><mi id="A1.E47.m1.1.2.3.7" xref="A1.E47.m1.1.2.3.7.cmml">a</mi><mo id="A1.E47.m1.1.2.3.1e" xref="A1.E47.m1.1.2.3.1.cmml">⁢</mo><mi id="A1.E47.m1.1.2.3.8" xref="A1.E47.m1.1.2.3.8.cmml">x</mi><mo id="A1.E47.m1.1.2.3.1f" xref="A1.E47.m1.1.2.3.1.cmml">⁢</mo><mrow id="A1.E47.m1.1.2.3.9.2" xref="A1.E47.m1.1.1.cmml"><mo id="A1.E47.m1.1.2.3.9.2.1" stretchy="false" xref="A1.E47.m1.1.1.cmml">(</mo><mover accent="true" id="A1.E47.m1.1.1" xref="A1.E47.m1.1.1.cmml"><mi id="A1.E47.m1.1.1.2" xref="A1.E47.m1.1.1.2.cmml">z</mi><mo id="A1.E47.m1.1.1.1" xref="A1.E47.m1.1.1.1.cmml">^</mo></mover><mo id="A1.E47.m1.1.2.3.9.2.2" stretchy="false" xref="A1.E47.m1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E47.m1.1b"><apply id="A1.E47.m1.1.2.cmml" xref="A1.E47.m1.1.2"><eq id="A1.E47.m1.1.2.1.cmml" xref="A1.E47.m1.1.2.1"></eq><apply id="A1.E47.m1.1.2.2.cmml" xref="A1.E47.m1.1.2.2"><ci id="A1.E47.m1.1.2.2.1.cmml" xref="A1.E47.m1.1.2.2.1">^</ci><ci id="A1.E47.m1.1.2.2.2.cmml" xref="A1.E47.m1.1.2.2.2">𝑦</ci></apply><apply id="A1.E47.m1.1.2.3.cmml" xref="A1.E47.m1.1.2.3"><times id="A1.E47.m1.1.2.3.1.cmml" xref="A1.E47.m1.1.2.3.1"></times><ci id="A1.E47.m1.1.2.3.2.cmml" xref="A1.E47.m1.1.2.3.2">𝑠</ci><ci id="A1.E47.m1.1.2.3.3.cmml" xref="A1.E47.m1.1.2.3.3">𝑜</ci><ci id="A1.E47.m1.1.2.3.4.cmml" xref="A1.E47.m1.1.2.3.4">𝑓</ci><ci id="A1.E47.m1.1.2.3.5.cmml" xref="A1.E47.m1.1.2.3.5">𝑡</ci><ci id="A1.E47.m1.1.2.3.6.cmml" xref="A1.E47.m1.1.2.3.6">𝑚</ci><ci id="A1.E47.m1.1.2.3.7.cmml" xref="A1.E47.m1.1.2.3.7">𝑎</ci><ci id="A1.E47.m1.1.2.3.8.cmml" xref="A1.E47.m1.1.2.3.8">𝑥</ci><apply id="A1.E47.m1.1.1.cmml" xref="A1.E47.m1.1.2.3.9.2"><ci id="A1.E47.m1.1.1.1.cmml" xref="A1.E47.m1.1.1.1">^</ci><ci id="A1.E47.m1.1.1.2.cmml" xref="A1.E47.m1.1.1.2">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E47.m1.1c">\displaystyle\hat{y}=softmax(\hat{z})</annotation><annotation encoding="application/x-llamapun" id="A1.E47.m1.1d">over^ start_ARG italic_y end_ARG = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( over^ start_ARG italic_z end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(47)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p5">
<p class="ltx_p" id="A1.SS2.SSS4.p5.1">They define their loss function using cross-entropy of the predicted value and the real value:</p>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p6">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx23">
<tbody id="A1.E48"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L(\hat{y})=-\displaystyle\sum^{m}_{i=1}y_{i}log(\hat{y}_{i})+(1-%
y_{i})log(1-\hat{y}_{i})" class="ltx_Math" display="inline" id="A1.E48.m1.4"><semantics id="A1.E48.m1.4a"><mrow id="A1.E48.m1.4.4" xref="A1.E48.m1.4.4.cmml"><mrow id="A1.E48.m1.4.4.5" xref="A1.E48.m1.4.4.5.cmml"><mi id="A1.E48.m1.4.4.5.2" xref="A1.E48.m1.4.4.5.2.cmml">L</mi><mo id="A1.E48.m1.4.4.5.1" xref="A1.E48.m1.4.4.5.1.cmml">⁢</mo><mrow id="A1.E48.m1.4.4.5.3.2" xref="A1.E48.m1.1.1.cmml"><mo id="A1.E48.m1.4.4.5.3.2.1" stretchy="false" xref="A1.E48.m1.1.1.cmml">(</mo><mover accent="true" id="A1.E48.m1.1.1" xref="A1.E48.m1.1.1.cmml"><mi id="A1.E48.m1.1.1.2" xref="A1.E48.m1.1.1.2.cmml">y</mi><mo id="A1.E48.m1.1.1.1" xref="A1.E48.m1.1.1.1.cmml">^</mo></mover><mo id="A1.E48.m1.4.4.5.3.2.2" stretchy="false" xref="A1.E48.m1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E48.m1.4.4.4" xref="A1.E48.m1.4.4.4.cmml">=</mo><mrow id="A1.E48.m1.4.4.3" xref="A1.E48.m1.4.4.3.cmml"><mrow id="A1.E48.m1.2.2.1.1" xref="A1.E48.m1.2.2.1.1.cmml"><mo id="A1.E48.m1.2.2.1.1a" xref="A1.E48.m1.2.2.1.1.cmml">−</mo><mrow id="A1.E48.m1.2.2.1.1.1" xref="A1.E48.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A1.E48.m1.2.2.1.1.1.2" xref="A1.E48.m1.2.2.1.1.1.2.cmml"><munderover id="A1.E48.m1.2.2.1.1.1.2a" xref="A1.E48.m1.2.2.1.1.1.2.cmml"><mo id="A1.E48.m1.2.2.1.1.1.2.2.2" movablelimits="false" xref="A1.E48.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E48.m1.2.2.1.1.1.2.3" xref="A1.E48.m1.2.2.1.1.1.2.3.cmml"><mi id="A1.E48.m1.2.2.1.1.1.2.3.2" xref="A1.E48.m1.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="A1.E48.m1.2.2.1.1.1.2.3.1" xref="A1.E48.m1.2.2.1.1.1.2.3.1.cmml">=</mo><mn id="A1.E48.m1.2.2.1.1.1.2.3.3" xref="A1.E48.m1.2.2.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="A1.E48.m1.2.2.1.1.1.2.2.3" xref="A1.E48.m1.2.2.1.1.1.2.2.3.cmml">m</mi></munderover></mstyle><mrow id="A1.E48.m1.2.2.1.1.1.1" xref="A1.E48.m1.2.2.1.1.1.1.cmml"><msub id="A1.E48.m1.2.2.1.1.1.1.3" xref="A1.E48.m1.2.2.1.1.1.1.3.cmml"><mi id="A1.E48.m1.2.2.1.1.1.1.3.2" xref="A1.E48.m1.2.2.1.1.1.1.3.2.cmml">y</mi><mi id="A1.E48.m1.2.2.1.1.1.1.3.3" xref="A1.E48.m1.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mo id="A1.E48.m1.2.2.1.1.1.1.2" xref="A1.E48.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E48.m1.2.2.1.1.1.1.4" xref="A1.E48.m1.2.2.1.1.1.1.4.cmml">l</mi><mo id="A1.E48.m1.2.2.1.1.1.1.2a" xref="A1.E48.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E48.m1.2.2.1.1.1.1.5" xref="A1.E48.m1.2.2.1.1.1.1.5.cmml">o</mi><mo id="A1.E48.m1.2.2.1.1.1.1.2b" xref="A1.E48.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E48.m1.2.2.1.1.1.1.6" xref="A1.E48.m1.2.2.1.1.1.1.6.cmml">g</mi><mo id="A1.E48.m1.2.2.1.1.1.1.2c" xref="A1.E48.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E48.m1.2.2.1.1.1.1.1.1" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A1.E48.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E48.m1.2.2.1.1.1.1.1.1.1" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.2" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.1" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E48.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E48.m1.4.4.3.4" xref="A1.E48.m1.4.4.3.4.cmml">+</mo><mrow id="A1.E48.m1.4.4.3.3" xref="A1.E48.m1.4.4.3.3.cmml"><mrow id="A1.E48.m1.3.3.2.2.1.1" xref="A1.E48.m1.3.3.2.2.1.1.1.cmml"><mo id="A1.E48.m1.3.3.2.2.1.1.2" stretchy="false" xref="A1.E48.m1.3.3.2.2.1.1.1.cmml">(</mo><mrow id="A1.E48.m1.3.3.2.2.1.1.1" xref="A1.E48.m1.3.3.2.2.1.1.1.cmml"><mn id="A1.E48.m1.3.3.2.2.1.1.1.2" xref="A1.E48.m1.3.3.2.2.1.1.1.2.cmml">1</mn><mo id="A1.E48.m1.3.3.2.2.1.1.1.1" xref="A1.E48.m1.3.3.2.2.1.1.1.1.cmml">−</mo><msub id="A1.E48.m1.3.3.2.2.1.1.1.3" xref="A1.E48.m1.3.3.2.2.1.1.1.3.cmml"><mi id="A1.E48.m1.3.3.2.2.1.1.1.3.2" xref="A1.E48.m1.3.3.2.2.1.1.1.3.2.cmml">y</mi><mi id="A1.E48.m1.3.3.2.2.1.1.1.3.3" xref="A1.E48.m1.3.3.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.E48.m1.3.3.2.2.1.1.3" stretchy="false" xref="A1.E48.m1.3.3.2.2.1.1.1.cmml">)</mo></mrow><mo id="A1.E48.m1.4.4.3.3.3" xref="A1.E48.m1.4.4.3.3.3.cmml">⁢</mo><mi id="A1.E48.m1.4.4.3.3.4" xref="A1.E48.m1.4.4.3.3.4.cmml">l</mi><mo id="A1.E48.m1.4.4.3.3.3a" xref="A1.E48.m1.4.4.3.3.3.cmml">⁢</mo><mi id="A1.E48.m1.4.4.3.3.5" xref="A1.E48.m1.4.4.3.3.5.cmml">o</mi><mo id="A1.E48.m1.4.4.3.3.3b" xref="A1.E48.m1.4.4.3.3.3.cmml">⁢</mo><mi id="A1.E48.m1.4.4.3.3.6" xref="A1.E48.m1.4.4.3.3.6.cmml">g</mi><mo id="A1.E48.m1.4.4.3.3.3c" xref="A1.E48.m1.4.4.3.3.3.cmml">⁢</mo><mrow id="A1.E48.m1.4.4.3.3.2.1" xref="A1.E48.m1.4.4.3.3.2.1.1.cmml"><mo id="A1.E48.m1.4.4.3.3.2.1.2" stretchy="false" xref="A1.E48.m1.4.4.3.3.2.1.1.cmml">(</mo><mrow id="A1.E48.m1.4.4.3.3.2.1.1" xref="A1.E48.m1.4.4.3.3.2.1.1.cmml"><mn id="A1.E48.m1.4.4.3.3.2.1.1.2" xref="A1.E48.m1.4.4.3.3.2.1.1.2.cmml">1</mn><mo id="A1.E48.m1.4.4.3.3.2.1.1.1" xref="A1.E48.m1.4.4.3.3.2.1.1.1.cmml">−</mo><msub id="A1.E48.m1.4.4.3.3.2.1.1.3" xref="A1.E48.m1.4.4.3.3.2.1.1.3.cmml"><mover accent="true" id="A1.E48.m1.4.4.3.3.2.1.1.3.2" xref="A1.E48.m1.4.4.3.3.2.1.1.3.2.cmml"><mi id="A1.E48.m1.4.4.3.3.2.1.1.3.2.2" xref="A1.E48.m1.4.4.3.3.2.1.1.3.2.2.cmml">y</mi><mo id="A1.E48.m1.4.4.3.3.2.1.1.3.2.1" xref="A1.E48.m1.4.4.3.3.2.1.1.3.2.1.cmml">^</mo></mover><mi id="A1.E48.m1.4.4.3.3.2.1.1.3.3" xref="A1.E48.m1.4.4.3.3.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.E48.m1.4.4.3.3.2.1.3" stretchy="false" xref="A1.E48.m1.4.4.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E48.m1.4b"><apply id="A1.E48.m1.4.4.cmml" xref="A1.E48.m1.4.4"><eq id="A1.E48.m1.4.4.4.cmml" xref="A1.E48.m1.4.4.4"></eq><apply id="A1.E48.m1.4.4.5.cmml" xref="A1.E48.m1.4.4.5"><times id="A1.E48.m1.4.4.5.1.cmml" xref="A1.E48.m1.4.4.5.1"></times><ci id="A1.E48.m1.4.4.5.2.cmml" xref="A1.E48.m1.4.4.5.2">𝐿</ci><apply id="A1.E48.m1.1.1.cmml" xref="A1.E48.m1.4.4.5.3.2"><ci id="A1.E48.m1.1.1.1.cmml" xref="A1.E48.m1.1.1.1">^</ci><ci id="A1.E48.m1.1.1.2.cmml" xref="A1.E48.m1.1.1.2">𝑦</ci></apply></apply><apply id="A1.E48.m1.4.4.3.cmml" xref="A1.E48.m1.4.4.3"><plus id="A1.E48.m1.4.4.3.4.cmml" xref="A1.E48.m1.4.4.3.4"></plus><apply id="A1.E48.m1.2.2.1.1.cmml" xref="A1.E48.m1.2.2.1.1"><minus id="A1.E48.m1.2.2.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1"></minus><apply id="A1.E48.m1.2.2.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.1"><apply id="A1.E48.m1.2.2.1.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E48.m1.2.2.1.1.1.2.1.cmml" xref="A1.E48.m1.2.2.1.1.1.2">subscript</csymbol><apply id="A1.E48.m1.2.2.1.1.1.2.2.cmml" xref="A1.E48.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E48.m1.2.2.1.1.1.2.2.1.cmml" xref="A1.E48.m1.2.2.1.1.1.2">superscript</csymbol><sum id="A1.E48.m1.2.2.1.1.1.2.2.2.cmml" xref="A1.E48.m1.2.2.1.1.1.2.2.2"></sum><ci id="A1.E48.m1.2.2.1.1.1.2.2.3.cmml" xref="A1.E48.m1.2.2.1.1.1.2.2.3">𝑚</ci></apply><apply id="A1.E48.m1.2.2.1.1.1.2.3.cmml" xref="A1.E48.m1.2.2.1.1.1.2.3"><eq id="A1.E48.m1.2.2.1.1.1.2.3.1.cmml" xref="A1.E48.m1.2.2.1.1.1.2.3.1"></eq><ci id="A1.E48.m1.2.2.1.1.1.2.3.2.cmml" xref="A1.E48.m1.2.2.1.1.1.2.3.2">𝑖</ci><cn id="A1.E48.m1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="A1.E48.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="A1.E48.m1.2.2.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1"><times id="A1.E48.m1.2.2.1.1.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.2"></times><apply id="A1.E48.m1.2.2.1.1.1.1.3.cmml" xref="A1.E48.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E48.m1.2.2.1.1.1.1.3.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A1.E48.m1.2.2.1.1.1.1.3.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.3.2">𝑦</ci><ci id="A1.E48.m1.2.2.1.1.1.1.3.3.cmml" xref="A1.E48.m1.2.2.1.1.1.1.3.3">𝑖</ci></apply><ci id="A1.E48.m1.2.2.1.1.1.1.4.cmml" xref="A1.E48.m1.2.2.1.1.1.1.4">𝑙</ci><ci id="A1.E48.m1.2.2.1.1.1.1.5.cmml" xref="A1.E48.m1.2.2.1.1.1.1.5">𝑜</ci><ci id="A1.E48.m1.2.2.1.1.1.1.6.cmml" xref="A1.E48.m1.2.2.1.1.1.1.6">𝑔</ci><apply id="A1.E48.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E48.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2"><ci id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.1">^</ci><ci id="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="A1.E48.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.E48.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="A1.E48.m1.4.4.3.3.cmml" xref="A1.E48.m1.4.4.3.3"><times id="A1.E48.m1.4.4.3.3.3.cmml" xref="A1.E48.m1.4.4.3.3.3"></times><apply id="A1.E48.m1.3.3.2.2.1.1.1.cmml" xref="A1.E48.m1.3.3.2.2.1.1"><minus id="A1.E48.m1.3.3.2.2.1.1.1.1.cmml" xref="A1.E48.m1.3.3.2.2.1.1.1.1"></minus><cn id="A1.E48.m1.3.3.2.2.1.1.1.2.cmml" type="integer" xref="A1.E48.m1.3.3.2.2.1.1.1.2">1</cn><apply id="A1.E48.m1.3.3.2.2.1.1.1.3.cmml" xref="A1.E48.m1.3.3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E48.m1.3.3.2.2.1.1.1.3.1.cmml" xref="A1.E48.m1.3.3.2.2.1.1.1.3">subscript</csymbol><ci id="A1.E48.m1.3.3.2.2.1.1.1.3.2.cmml" xref="A1.E48.m1.3.3.2.2.1.1.1.3.2">𝑦</ci><ci id="A1.E48.m1.3.3.2.2.1.1.1.3.3.cmml" xref="A1.E48.m1.3.3.2.2.1.1.1.3.3">𝑖</ci></apply></apply><ci id="A1.E48.m1.4.4.3.3.4.cmml" xref="A1.E48.m1.4.4.3.3.4">𝑙</ci><ci id="A1.E48.m1.4.4.3.3.5.cmml" xref="A1.E48.m1.4.4.3.3.5">𝑜</ci><ci id="A1.E48.m1.4.4.3.3.6.cmml" xref="A1.E48.m1.4.4.3.3.6">𝑔</ci><apply id="A1.E48.m1.4.4.3.3.2.1.1.cmml" xref="A1.E48.m1.4.4.3.3.2.1"><minus id="A1.E48.m1.4.4.3.3.2.1.1.1.cmml" xref="A1.E48.m1.4.4.3.3.2.1.1.1"></minus><cn id="A1.E48.m1.4.4.3.3.2.1.1.2.cmml" type="integer" xref="A1.E48.m1.4.4.3.3.2.1.1.2">1</cn><apply id="A1.E48.m1.4.4.3.3.2.1.1.3.cmml" xref="A1.E48.m1.4.4.3.3.2.1.1.3"><csymbol cd="ambiguous" id="A1.E48.m1.4.4.3.3.2.1.1.3.1.cmml" xref="A1.E48.m1.4.4.3.3.2.1.1.3">subscript</csymbol><apply id="A1.E48.m1.4.4.3.3.2.1.1.3.2.cmml" xref="A1.E48.m1.4.4.3.3.2.1.1.3.2"><ci id="A1.E48.m1.4.4.3.3.2.1.1.3.2.1.cmml" xref="A1.E48.m1.4.4.3.3.2.1.1.3.2.1">^</ci><ci id="A1.E48.m1.4.4.3.3.2.1.1.3.2.2.cmml" xref="A1.E48.m1.4.4.3.3.2.1.1.3.2.2">𝑦</ci></apply><ci id="A1.E48.m1.4.4.3.3.2.1.1.3.3.cmml" xref="A1.E48.m1.4.4.3.3.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E48.m1.4c">\displaystyle L(\hat{y})=-\displaystyle\sum^{m}_{i=1}y_{i}log(\hat{y}_{i})+(1-%
y_{i})log(1-\hat{y}_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.E48.m1.4d">italic_L ( over^ start_ARG italic_y end_ARG ) = - ∑ start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_l italic_o italic_g ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_l italic_o italic_g ( 1 - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(48)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.SSS4.p7">
<p class="ltx_p" id="A1.SS2.SSS4.p7.1">Where y is a one-hot encoding of the real value of each item.</p>
</div>
</section>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Jun  2 04:22:30 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
