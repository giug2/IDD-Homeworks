<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning</title>
<!--Generated on Thu Jul 25 22:52:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2408.05353v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S1" title="In IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S2" title="In IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3" title="In IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Proposed Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.SS1" title="In 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.SS2" title="In 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Input Feature Sequence Formation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.SS3" title="In 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>User Intent Prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.SS4" title="In 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Next-item Prediction and Hierarchical MTL</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4" title="In IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1" title="In 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1.SSS1" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1.SSS2" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1.SSS3" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1.SSS4" title="In 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.4 </span>Implementation Details and Hyperparameters</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS2" title="In 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Next Item and Intent Prediction Accuracy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS3" title="In 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Studies of <span class="ltx_text ltx_font_smallcaps">IntentRec</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS4" title="In 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Qualitative Analysis: User Intent Clustering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS5" title="In 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Qualitative Analysis: Attention Weights</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S5" title="In IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S6" title="In IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="1.1">IntentRec</span>: Predicting User Session Intent with Hierarchical Multi-Task Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sejoon Oh
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:sejoono@netflix.com">sejoono@netflix.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="2.1.1">Netflix</span><span class="ltx_text ltx_affiliation_city" id="3.2.2">Los Gatos</span><span class="ltx_text ltx_affiliation_country" id="4.3.3">United States</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Moumita Bhattacharya
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:mbhattacharya@netflix.com">mbhattacharya@netflix.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="5.1.1">Netflix</span><span class="ltx_text ltx_affiliation_city" id="6.2.2">Los Gatos</span><span class="ltx_text ltx_affiliation_country" id="7.3.3">United States</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yesu Feng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yfeng@netflix.com">yfeng@netflix.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="8.1.1">Netflix</span><span class="ltx_text ltx_affiliation_city" id="9.2.2">Los Gatos</span><span class="ltx_text ltx_affiliation_country" id="10.3.3">United States</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sudarshan Lamkhede
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:slamkhede@netflix.com">slamkhede@netflix.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="11.1.1">Netflix</span><span class="ltx_text ltx_affiliation_city" id="12.2.2">Los Gatos</span><span class="ltx_text ltx_affiliation_country" id="13.3.3">United States</span>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="14.1">Recommender systems have played a critical role in diverse digital services such as e-commerce, streaming media, social networks, etc. If we know what a user’s intent is in a given session (e.g. do they want to watch short videos or a movie or play games; are they shopping for a camping trip), it becomes easier to provide high-quality recommendations. In this paper, we introduce <span class="ltx_text ltx_font_smallcaps" id="14.1.1">IntentRec</span>, a novel recommendation framework based on hierarchical multi-task neural network architecture that tries to estimate a user’s latent intent using their short- and long-term implicit signals as proxies and uses the intent prediction to predict the next item user is likely to engage with.
By directly leveraging the intent prediction, we can offer accurate and personalized recommendations to users. Our comprehensive experiments on Netflix user engagement data show that <span class="ltx_text ltx_font_smallcaps" id="14.1.2">IntentRec</span> outperforms the state-of-the-art next-item and next-intent predictors. We also share several findings and downstream applications of <span class="ltx_text ltx_font_smallcaps" id="14.1.3">IntentRec</span>.</p>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="15"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="16"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Sequential recommender systems, specifically next-item prediction systems, are one of the most useful applications of machine learning in industry <cite class="ltx_cite ltx_citemacro_citep">(Bhattacharya and Lamkhede, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib5" title="">2022</a>; Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib13" title="">2022</a>; Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib54" title="">2023</a>; Beutel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib4" title="">2018</a>)</cite>.
A well-designed recommender system can drive a lot of product and business impact by surfacing the relevant items to a member at the right time <cite class="ltx_cite ltx_citemacro_citep">(Jannach and Jugovac, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib20" title="">2019</a>; Gomez-Uribe and Hunt, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib15" title="">2015</a>)</cite>.
For instance, in streaming services like Netflix, recommendations have been employed in diverse situations (e.g., discovering or searching shows) <cite class="ltx_cite ltx_citemacro_citep">(Bhattacharya and Lamkhede, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib5" title="">2022</a>; Steck et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib45" title="">2021</a>; Amatriain and Basilico, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib2" title="">2015</a>; Gomez-Uribe and Hunt, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib15" title="">2015</a>)</cite> to maximize users’ satisfaction.
Recently, predicting a user’s future intent in an online platform has gained attention <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib54" title="">2023</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib10" title="">2021</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib7" title="">2022</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib30" title="">2021</a>)</cite>, since such latent intent can lead to more accurate and curated recommendations.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The exact definition of a user’s intent varies across diverse applications and is often hidden. In Netflix, we identify several interaction metadata that can be associated with the user intent. Specifically, we leverage the type of action a member takes on the product as a direct reflection of what they intend to do on the platform. For example, when a member plays a follow-up episode or scene of something they were already watching previously can be categorized as “continue watching” intent.
Additionally, intents can also be whether a member wants to watch a movie or TV show, or is in the mood for a short-watch session or a long binge-watching session. As shown in <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S1.F1" title="In 1. Introduction ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, we have different metadata of user interactions that can be mapped to intents including, Action Type (e.g., discovering new content vs binge watching, etc.), Genre (e.g., horror, thriller, drama, etc.), movie or TV show preference, etc.
While predicting the next item ID is the most important task, anticipating the user’s future intent (e.g., action type prediction) is also crucial, as it can enhance the next-item prediction.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="267" id="S1.F1.g1" src="extracted/5755931/figs/problem_definition.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Overview of user engagement data in Netflix. User intent can be associated with several interaction metadata. We leverage various implicit signals to predict user intent and next-item.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To predict some form of a user’s session intent, previous studies have proposed simple multi-task learning (MTL) that adds several intent prediction heads to the next-item prediction model. However, existing intent prediction models have two major limitations.
First, they lack a <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">hierarchical prediction scheme</span> where the intent prediction result can directly affect the next-item prediction.
The hierarchical learning is preferred to the simple MTL or standalone intent prediction, as next-item prediction can be enhanced and personalized by leveraging the user intent as one of the input features <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib7" title="">2022</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib10" title="">2021</a>; Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib12" title="">2019</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib30" title="">2021</a>)</cite>.
Second, they cannot incorporate the <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">short- and long-term interests of a user</span> into the intent and item prediction.
A user’s latest interest is crucial for next-item prediction and can be significantly different from their long-term preferences; e.g., a user might want to watch horror movies with friends even if they do not usually watch horror movies alone. Modeling such short- and long-term interests separately is a challenging task.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address the above issues, we propose a novel sequential recommender system: <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.p4.1.1">IntentRec<span class="ltx_text ltx_font_upright" id="S1.p4.1.1.1"> that can predict the next item, while also capturing the user’s intent and balancing their short- and long-term preferences</span></span>.
<span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.2">IntentRec</span> consists of three major components: input feature constructor, user intent predictor, and next-item predictor.
As one can imagine exact user intent is often not known, <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">we leverage various proxy implicit signals (e.g., previous browsed shows/movies and genre preferences)</span> that we collect based on user interactions in Netflix.
As will be described later, an input feature constructor combines those proxy implicit signals to estimate the member’s latent intent on Netflix.
We explicitly model the short-term interest of a user using implicit signals happening within a certain time threshold (e.g., one week) and incorporate it while constructing the input feature sequence, while the long-term interest of a user will be modeled via a Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib51" title="">2017</a>)</cite> later.
While <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.4">IntentRec</span> is designed for Netflix, <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.5">IntentRec</span> can be easily adapted to other domains by redefining user intent (e.g., genre <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mo id="S1.p4.1.m1.1.1" stretchy="false" xref="S1.p4.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">→</annotation></semantics></math> category) and choosing proper implicit signals for intent and item predictions.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We feed the input feature sequence of a user to a <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Transformer intent encoder</span> to predict the user intent at each position in the sequence. The output sequence of the Transformer will be used for each intent prediction task (e.g., action type), and all the individual predictions are transformed into embeddings via projection layers. Finally, the projected embedding sequences are mixed by an attention layer and form the final user intent embedding sequence.
The intent embedding sequence will be combined with the input feature sequence to predict the next item of a user accurately.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The aforementioned intent-aware feature sequence is fed to a <span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Transformer item encoder</span> to predict the next item at each position in the sequence.
Unlike the conventional next-item prediction, <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.2">IntentRec</span> utilizes hierarchical multi-task learning, where we conduct the intent prediction first and use the intent prediction output for the next-item prediction. After all predictions, their loss functions are combined with weights and jointly optimized together.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Extensive experiments on Netflix user engagement data demonstrate that <span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S1.p7.1.1">IntentRec<span class="ltx_text ltx_font_upright" id="S1.p7.1.1.1"> outperforms state-of-the-art user intent and next-item prediction models</span></span>. Ablation studies show the effectiveness of the hierarchical multi-task learning of <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.2">IntentRec</span> and the contribution of each intent prediction task. We also find unique and meaningful clusters of users employing the predicted intent embedding and suggest downstream applications of <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.3">IntentRec</span> in Netflix.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">The main contributions of our work are summarized as follows.</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a novel recommendation framework that can capture a user’s intent on the online platform and enhance the next-item prediction using the user intent.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We introduce hierarchical multi-task learning for intent and item predictions from the short- and long-term interests of a user and show its effectiveness.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Sequential Recommendations.</span>
Sequential recommenders have been employed widely in industry including Spotify <cite class="ltx_cite ltx_citemacro_citep">(Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib13" title="">2022</a>)</cite>, Pinterest <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite>, Amazon <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib54" title="">2023</a>)</cite>, and Netflix <cite class="ltx_cite ltx_citemacro_citep">(Bhattacharya and Lamkhede, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib5" title="">2022</a>)</cite>.
Sequential recommenders are trained on historical user-item interactions and predict the next item given a sequence of observed items of a user <cite class="ltx_cite ltx_citemacro_citep">(Oh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib36" title="">2022b</a>)</cite>.
Recurrent neural networks (RNNs) have been the main architecture for sequential recommendations recently due to their capability to process arbitrary sequences of inputs <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib57" title="">2019</a>)</cite>.
Earlier methods <cite class="ltx_cite ltx_citemacro_citep">(Beutel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib4" title="">2018</a>; Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib19" title="">2018</a>)</cite> had used Long short-term memory (LSTM) <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib18" title="">1997</a>)</cite> and Gated Recurrent Unit <cite class="ltx_cite ltx_citemacro_citep">(Cho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib8" title="">2014</a>)</cite>.
Recently, self-attention <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib22" title="">2018</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib26" title="">2020</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib54" title="">2023</a>; Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib13" title="">2022</a>)</cite> and Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib51" title="">2017</a>; Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib46" title="">2019</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib29" title="">2018</a>)</cite> have gained popularity because of their ability to handle long sequences and position-awareness. Most of these methods cannot predict a user’s next intent and next item simultaneously.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">User Intent Predictions.</span>
Estimating a user’s next intent has been investigated actively in diverse domains <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib54" title="">2023</a>; Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib10" title="">2021</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib7" title="">2022</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib30" title="">2021</a>; Tanjim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib48" title="">2020</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib25" title="">2021</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib31" title="">2020</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib32" title="">2020</a>)</cite>, as the user intent is a direct indicator of the user’s future interaction and leads to several downstream applications such as personalized and real-time recommendations.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.2">The definition of user intent varies across papers as the user intent highly depends on the specific domain (e.g., e-commerce <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib24" title="">2019</a>)</cite> vs social media <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite>).
For instance, <cite class="ltx_cite ltx_citemacro_citet">Fan et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib12" title="">2019</a>)</cite> predict the user intent (represented by a sentence query) among <math alttext="Q" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_Q</annotation></semantics></math> possible queries using a metapath-guided GNN model on Alibaba E-commerce.
In session-based recommendations <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib54" title="">2023</a>; Oh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib34" title="">2022a</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib56" title="">2023</a>; Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib38" title="">2020</a>; Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib16" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib27" title="">2022</a>; Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib21" title="">2023</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib47" title="">2024</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib52" title="">2019</a>)</cite>, the user intent in a given session can be defined as a high-level summary of the session (e.g., searching for new shoes) or a real-time transitional interest (e.g., add-to-cart <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mo id="S2.p3.2.m2.1.1" stretchy="false" xref="S2.p3.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">→</annotation></semantics></math> purchase).
<cite class="ltx_cite ltx_citemacro_citet">Xia et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite> is the state-of-the-art intent prediction model developed by Pinterest, where the user intent is defined by the potential action (e.g., click, repin, hide) for a given pin (or an item).
Yet, all the above models have limitations that they neither predict the next item and intent of a user at the same time nor model short- and long-term interests of a user together.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Hierarchical Multi-task Learning.</span>
Multi-task learning (MTL) has improved the generalization capability of deep neural networks used in computer vision, natural language processing (NLP), and recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Zhang and Yang, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib58" title="">2018</a>; Ruder, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib40" title="">2017</a>)</cite>. Particularly, in recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Shalaby et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib42" title="">2022</a>; Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib14" title="">2019</a>; Hadash et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib17" title="">2018</a>)</cite>, MTL has enhanced the next-item prediction performance by sharing the knowledge obtained between auxiliary tasks (e.g., category prediction) and the main task (e.g., item prediction).
We can further enhance the performance of MTL by setting a hierarchy between prediction tasks, where low-level tasks are conducted first, and the high-level task exploits the outputs of low-level ones as input features. We call this hierarchical MTL (H-MTL). H-MTL has been widely adopted in computer vision <cite class="ltx_cite ltx_citemacro_citep">(Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib11" title="">2017</a>; Nguyen and Okatani, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib33" title="">2019</a>; Park et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib39" title="">2019</a>)</cite>, NLP <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib53" title="">2021</a>; Song et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib44" title="">2020</a>; Song and Zhao, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib43" title="">2022</a>)</cite>, and only few in recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Oh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib35" title="">2023</a>; Lim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib28" title="">2022</a>)</cite>.
Our paper is the first H-MTL framework that can predict the user intent using both short- and long-term interests of a user.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Proposed Method</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="506" id="S3.F2.g1" src="extracted/5755931/figs/overview.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.3.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S3.F2.4.2" style="font-size:90%;">An architectural illustration of our hierarchical multi-task learning model <span class="ltx_text ltx_font_smallcaps" id="S3.F2.4.2.1">IntentRec</span> for user intent and item predictions.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Our proposed recommender: <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.1">IntentRec</span> infers a user’s next session intent and leverages such intent predictions to enhance the next-item recommendations in a hierarchical manner.
As touched upon earlier, exact user intent is typically unknown, hence we use a few implicit and explicit signals such as action type, genre preference, among others to estimate the latent user intent. To this end,
we define the user intent by a mixture of 4 different key metadata in Netflix (see <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1.SSS1" title="4.1.1. Dataset ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.1.1</span></a> for details): Action Type, Genre Preference, Movie/Show, and Time-since-release (e.g., new content vs oldies). These proxies can be extended to include any number of other proxies, and we have chosen <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.1.2">four</em> for brevity.
<span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.3">IntentRec</span> also incorporates short-term interests of a user (i.e., interactions that happened within the last <math alttext="H" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_H</annotation></semantics></math> hours) into the model as input features. <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.F2" title="In 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a> illustrates a high-level overview of <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.1.4">IntentRec</span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Input Feature Sequence Formation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3">We assume user engagement data consists of historical interactions (e.g. clicks, plays, etc.) that users have made in Netflix. We use the latest <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_n</annotation></semantics></math> (e.g., 100) interactions of each user for training and testing.
A user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_u</annotation></semantics></math>’s engagement is represented as a temporal interaction sequence <math alttext="\{int_{1},\ldots,int_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.3"><semantics id="S3.SS2.p1.3.m3.3a"><mrow id="S3.SS2.p1.3.m3.3.3.2" xref="S3.SS2.p1.3.m3.3.3.3.cmml"><mo id="S3.SS2.p1.3.m3.3.3.2.3" stretchy="false" xref="S3.SS2.p1.3.m3.3.3.3.cmml">{</mo><mrow id="S3.SS2.p1.3.m3.2.2.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml">i</mi><mo id="S3.SS2.p1.3.m3.2.2.1.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.3.m3.2.2.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.3.cmml">n</mi><mo id="S3.SS2.p1.3.m3.2.2.1.1.1a" xref="S3.SS2.p1.3.m3.2.2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p1.3.m3.2.2.1.1.4" xref="S3.SS2.p1.3.m3.2.2.1.1.4.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.4.2" xref="S3.SS2.p1.3.m3.2.2.1.1.4.2.cmml">t</mi><mn id="S3.SS2.p1.3.m3.2.2.1.1.4.3" xref="S3.SS2.p1.3.m3.2.2.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.SS2.p1.3.m3.3.3.2.4" xref="S3.SS2.p1.3.m3.3.3.3.cmml">,</mo><mi id="S3.SS2.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS2.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p1.3.m3.3.3.2.5" xref="S3.SS2.p1.3.m3.3.3.3.cmml">,</mo><mrow id="S3.SS2.p1.3.m3.3.3.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.cmml">i</mi><mo id="S3.SS2.p1.3.m3.3.3.2.2.1" xref="S3.SS2.p1.3.m3.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS2.p1.3.m3.3.3.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">n</mi><mo id="S3.SS2.p1.3.m3.3.3.2.2.1a" xref="S3.SS2.p1.3.m3.3.3.2.2.1.cmml">⁢</mo><msub id="S3.SS2.p1.3.m3.3.3.2.2.4" xref="S3.SS2.p1.3.m3.3.3.2.2.4.cmml"><mi id="S3.SS2.p1.3.m3.3.3.2.2.4.2" xref="S3.SS2.p1.3.m3.3.3.2.2.4.2.cmml">t</mi><mi id="S3.SS2.p1.3.m3.3.3.2.2.4.3" xref="S3.SS2.p1.3.m3.3.3.2.2.4.3.cmml">n</mi></msub></mrow><mo id="S3.SS2.p1.3.m3.3.3.2.6" stretchy="false" xref="S3.SS2.p1.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.3b"><set id="S3.SS2.p1.3.m3.3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2"><apply id="S3.SS2.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1"><times id="S3.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1"></times><ci id="S3.SS2.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.2">𝑖</ci><ci id="S3.SS2.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.3">𝑛</ci><apply id="S3.SS2.p1.3.m3.2.2.1.1.4.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.4.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.4">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.4.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.4.2">𝑡</ci><cn id="S3.SS2.p1.3.m3.2.2.1.1.4.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.2.2.1.1.4.3">1</cn></apply></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">…</ci><apply id="S3.SS2.p1.3.m3.3.3.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2"><times id="S3.SS2.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.1"></times><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2">𝑖</ci><ci id="S3.SS2.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.3">𝑛</ci><apply id="S3.SS2.p1.3.m3.3.3.2.2.4.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.4.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.4">subscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.2.2.4.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.4.2">𝑡</ci><ci id="S3.SS2.p1.3.m3.3.3.2.2.4.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.4.3">𝑛</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.3c">\{int_{1},\ldots,int_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.3d">{ italic_i italic_n italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_i italic_n italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> (latest at the end).</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.7">Each interaction <math alttext="int_{k},1\leq k\leq n" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.2"><semantics id="S3.SS2.p2.1.m1.2a"><mrow id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml"><mrow id="S3.SS2.p2.1.m1.2.2.1.1" xref="S3.SS2.p2.1.m1.2.2.1.2.cmml"><mrow id="S3.SS2.p2.1.m1.2.2.1.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2.cmml">i</mi><mo id="S3.SS2.p2.1.m1.2.2.1.1.1.1" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml">n</mi><mo id="S3.SS2.p2.1.m1.2.2.1.1.1.1a" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p2.1.m1.2.2.1.1.1.4" xref="S3.SS2.p2.1.m1.2.2.1.1.1.4.cmml"><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.4.2" xref="S3.SS2.p2.1.m1.2.2.1.1.1.4.2.cmml">t</mi><mi id="S3.SS2.p2.1.m1.2.2.1.1.1.4.3" xref="S3.SS2.p2.1.m1.2.2.1.1.1.4.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.p2.1.m1.2.2.1.1.2" xref="S3.SS2.p2.1.m1.2.2.1.2.cmml">,</mo><mn id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">1</mn></mrow><mo id="S3.SS2.p2.1.m1.2.2.3" xref="S3.SS2.p2.1.m1.2.2.3.cmml">≤</mo><mi id="S3.SS2.p2.1.m1.2.2.4" xref="S3.SS2.p2.1.m1.2.2.4.cmml">k</mi><mo id="S3.SS2.p2.1.m1.2.2.5" xref="S3.SS2.p2.1.m1.2.2.5.cmml">≤</mo><mi id="S3.SS2.p2.1.m1.2.2.6" xref="S3.SS2.p2.1.m1.2.2.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b"><apply id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2"><and id="S3.SS2.p2.1.m1.2.2a.cmml" xref="S3.SS2.p2.1.m1.2.2"></and><apply id="S3.SS2.p2.1.m1.2.2b.cmml" xref="S3.SS2.p2.1.m1.2.2"><leq id="S3.SS2.p2.1.m1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.2.2.3"></leq><list id="S3.SS2.p2.1.m1.2.2.1.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1"><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1"><times id="S3.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.1"></times><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.2">𝑖</ci><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.3">𝑛</ci><apply id="S3.SS2.p2.1.m1.2.2.1.1.1.4.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.2.2.1.1.1.4.1.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.4">subscript</csymbol><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.4.2.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.4.2">𝑡</ci><ci id="S3.SS2.p2.1.m1.2.2.1.1.1.4.3.cmml" xref="S3.SS2.p2.1.m1.2.2.1.1.1.4.3">𝑘</ci></apply></apply><cn id="S3.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1">1</cn></list><ci id="S3.SS2.p2.1.m1.2.2.4.cmml" xref="S3.SS2.p2.1.m1.2.2.4">𝑘</ci></apply><apply id="S3.SS2.p2.1.m1.2.2c.cmml" xref="S3.SS2.p2.1.m1.2.2"><leq id="S3.SS2.p2.1.m1.2.2.5.cmml" xref="S3.SS2.p2.1.m1.2.2.5"></leq><share href="https://arxiv.org/html/2408.05353v1#S3.SS2.p2.1.m1.2.2.4.cmml" id="S3.SS2.p2.1.m1.2.2d.cmml" xref="S3.SS2.p2.1.m1.2.2"></share><ci id="S3.SS2.p2.1.m1.2.2.6.cmml" xref="S3.SS2.p2.1.m1.2.2.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">int_{k},1\leq k\leq n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.2d">italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , 1 ≤ italic_k ≤ italic_n</annotation></semantics></math> is associated with various metadata. For instance, categorical features include item-ID <math alttext="i_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">i</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑖</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">i_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, action type <math alttext="c_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">c</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑐</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">c_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> (see <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1.SSS1" title="4.1.1. Dataset ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.1.1</span></a> for details), genre <math alttext="g_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">g</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑔</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">g_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_g start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and numerical features include timestamp <math alttext="t_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">t</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑡</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, episode position <math alttext="e_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">e</mi><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝑒</ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">e_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, etc.
We convert all categorical metadata of an interaction <math alttext="int_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mrow id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">i</mi><mo id="S3.SS2.p2.7.m7.1.1.1" xref="S3.SS2.p2.7.m7.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml">n</mi><mo id="S3.SS2.p2.7.m7.1.1.1a" xref="S3.SS2.p2.7.m7.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p2.7.m7.1.1.4" xref="S3.SS2.p2.7.m7.1.1.4.cmml"><mi id="S3.SS2.p2.7.m7.1.1.4.2" xref="S3.SS2.p2.7.m7.1.1.4.2.cmml">t</mi><mi id="S3.SS2.p2.7.m7.1.1.4.3" xref="S3.SS2.p2.7.m7.1.1.4.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><times id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1"></times><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">𝑖</ci><ci id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3">𝑛</ci><apply id="S3.SS2.p2.7.m7.1.1.4.cmml" xref="S3.SS2.p2.7.m7.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.4.1.cmml" xref="S3.SS2.p2.7.m7.1.1.4">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.4.2.cmml" xref="S3.SS2.p2.7.m7.1.1.4.2">𝑡</ci><ci id="S3.SS2.p2.7.m7.1.1.4.3.cmml" xref="S3.SS2.p2.7.m7.1.1.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">int_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> into embedding using a trainable embedding layer per metadata. Among all categorical features, item-ID has the largest embedding dimension (e.g., 400), and the others have relatively small dimensions (e.g., 20). Regarding numerical metadata, they are normalized first (e.g., between 0 and 1) and become 1-dimensional features.
Some interaction metadata are used as both intent prediction labels and input features. Different interaction metadata would be used in other datasets/applications.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.9">Input feature <math alttext="\mathcal{F}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ℱ</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathcal{F}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> of an interaction <math alttext="int_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">i</mi><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">n</mi><mo id="S3.SS2.p3.2.m2.1.1.1a" xref="S3.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p3.2.m2.1.1.4" xref="S3.SS2.p3.2.m2.1.1.4.cmml"><mi id="S3.SS2.p3.2.m2.1.1.4.2" xref="S3.SS2.p3.2.m2.1.1.4.2.cmml">t</mi><mi id="S3.SS2.p3.2.m2.1.1.4.3" xref="S3.SS2.p3.2.m2.1.1.4.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><times id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></times><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑖</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑛</ci><apply id="S3.SS2.p3.2.m2.1.1.4.cmml" xref="S3.SS2.p3.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.4.1.cmml" xref="S3.SS2.p3.2.m2.1.1.4">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.4.2.cmml" xref="S3.SS2.p3.2.m2.1.1.4.2">𝑡</ci><ci id="S3.SS2.p3.2.m2.1.1.4.3.cmml" xref="S3.SS2.p3.2.m2.1.1.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">int_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a concatenation of all categorical and numerical features of the interaction. i.e., <math alttext="\mathcal{F}_{k}\in\mathbb{R}^{d_{\text{full}}}=E^{\mathcal{I}}_{i_{k}}\oplus E%
^{\mathcal{C}}_{c_{k}}\oplus\cdots\oplus e_{k}\oplus\cdots" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><msub id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">ℱ</mi><mi id="S3.SS2.p3.3.m3.1.1.2.3" xref="S3.SS2.p3.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">∈</mo><msup id="S3.SS2.p3.3.m3.1.1.4" xref="S3.SS2.p3.3.m3.1.1.4.cmml"><mi id="S3.SS2.p3.3.m3.1.1.4.2" xref="S3.SS2.p3.3.m3.1.1.4.2.cmml">ℝ</mi><msub id="S3.SS2.p3.3.m3.1.1.4.3" xref="S3.SS2.p3.3.m3.1.1.4.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.4.3.2" xref="S3.SS2.p3.3.m3.1.1.4.3.2.cmml">d</mi><mtext id="S3.SS2.p3.3.m3.1.1.4.3.3" xref="S3.SS2.p3.3.m3.1.1.4.3.3a.cmml">full</mtext></msub></msup><mo id="S3.SS2.p3.3.m3.1.1.5" xref="S3.SS2.p3.3.m3.1.1.5.cmml">=</mo><mrow id="S3.SS2.p3.3.m3.1.1.6" xref="S3.SS2.p3.3.m3.1.1.6.cmml"><msubsup id="S3.SS2.p3.3.m3.1.1.6.2" xref="S3.SS2.p3.3.m3.1.1.6.2.cmml"><mi id="S3.SS2.p3.3.m3.1.1.6.2.2.2" xref="S3.SS2.p3.3.m3.1.1.6.2.2.2.cmml">E</mi><msub id="S3.SS2.p3.3.m3.1.1.6.2.3" xref="S3.SS2.p3.3.m3.1.1.6.2.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.6.2.3.2" xref="S3.SS2.p3.3.m3.1.1.6.2.3.2.cmml">i</mi><mi id="S3.SS2.p3.3.m3.1.1.6.2.3.3" xref="S3.SS2.p3.3.m3.1.1.6.2.3.3.cmml">k</mi></msub><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.6.2.2.3" xref="S3.SS2.p3.3.m3.1.1.6.2.2.3.cmml">ℐ</mi></msubsup><mo id="S3.SS2.p3.3.m3.1.1.6.1" xref="S3.SS2.p3.3.m3.1.1.6.1.cmml">⊕</mo><msubsup id="S3.SS2.p3.3.m3.1.1.6.3" xref="S3.SS2.p3.3.m3.1.1.6.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.6.3.2.2" xref="S3.SS2.p3.3.m3.1.1.6.3.2.2.cmml">E</mi><msub id="S3.SS2.p3.3.m3.1.1.6.3.3" xref="S3.SS2.p3.3.m3.1.1.6.3.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.6.3.3.2" xref="S3.SS2.p3.3.m3.1.1.6.3.3.2.cmml">c</mi><mi id="S3.SS2.p3.3.m3.1.1.6.3.3.3" xref="S3.SS2.p3.3.m3.1.1.6.3.3.3.cmml">k</mi></msub><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.6.3.2.3" xref="S3.SS2.p3.3.m3.1.1.6.3.2.3.cmml">𝒞</mi></msubsup><mo id="S3.SS2.p3.3.m3.1.1.6.1a" xref="S3.SS2.p3.3.m3.1.1.6.1.cmml">⊕</mo><mi id="S3.SS2.p3.3.m3.1.1.6.4" mathvariant="normal" xref="S3.SS2.p3.3.m3.1.1.6.4.cmml">⋯</mi><mo id="S3.SS2.p3.3.m3.1.1.6.1b" xref="S3.SS2.p3.3.m3.1.1.6.1.cmml">⊕</mo><msub id="S3.SS2.p3.3.m3.1.1.6.5" xref="S3.SS2.p3.3.m3.1.1.6.5.cmml"><mi id="S3.SS2.p3.3.m3.1.1.6.5.2" xref="S3.SS2.p3.3.m3.1.1.6.5.2.cmml">e</mi><mi id="S3.SS2.p3.3.m3.1.1.6.5.3" xref="S3.SS2.p3.3.m3.1.1.6.5.3.cmml">k</mi></msub><mo id="S3.SS2.p3.3.m3.1.1.6.1c" xref="S3.SS2.p3.3.m3.1.1.6.1.cmml">⊕</mo><mi id="S3.SS2.p3.3.m3.1.1.6.6" mathvariant="normal" xref="S3.SS2.p3.3.m3.1.1.6.6.cmml">⋯</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><and id="S3.SS2.p3.3.m3.1.1a.cmml" xref="S3.SS2.p3.3.m3.1.1"></and><apply id="S3.SS2.p3.3.m3.1.1b.cmml" xref="S3.SS2.p3.3.m3.1.1"><in id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3"></in><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">ℱ</ci><ci id="S3.SS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p3.3.m3.1.1.4.cmml" xref="S3.SS2.p3.3.m3.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.4.1.cmml" xref="S3.SS2.p3.3.m3.1.1.4">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.4.2.cmml" xref="S3.SS2.p3.3.m3.1.1.4.2">ℝ</ci><apply id="S3.SS2.p3.3.m3.1.1.4.3.cmml" xref="S3.SS2.p3.3.m3.1.1.4.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.4.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.4.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.4.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.4.3.2">𝑑</ci><ci id="S3.SS2.p3.3.m3.1.1.4.3.3a.cmml" xref="S3.SS2.p3.3.m3.1.1.4.3.3"><mtext id="S3.SS2.p3.3.m3.1.1.4.3.3.cmml" mathsize="50%" xref="S3.SS2.p3.3.m3.1.1.4.3.3">full</mtext></ci></apply></apply></apply><apply id="S3.SS2.p3.3.m3.1.1c.cmml" xref="S3.SS2.p3.3.m3.1.1"><eq id="S3.SS2.p3.3.m3.1.1.5.cmml" xref="S3.SS2.p3.3.m3.1.1.5"></eq><share href="https://arxiv.org/html/2408.05353v1#S3.SS2.p3.3.m3.1.1.4.cmml" id="S3.SS2.p3.3.m3.1.1d.cmml" xref="S3.SS2.p3.3.m3.1.1"></share><apply id="S3.SS2.p3.3.m3.1.1.6.cmml" xref="S3.SS2.p3.3.m3.1.1.6"><csymbol cd="latexml" id="S3.SS2.p3.3.m3.1.1.6.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.1">direct-sum</csymbol><apply id="S3.SS2.p3.3.m3.1.1.6.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.6.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2">subscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.6.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.6.2.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.6.2.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2.2.2">𝐸</ci><ci id="S3.SS2.p3.3.m3.1.1.6.2.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2.2.3">ℐ</ci></apply><apply id="S3.SS2.p3.3.m3.1.1.6.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.6.2.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.6.2.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2.3.2">𝑖</ci><ci id="S3.SS2.p3.3.m3.1.1.6.2.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.2.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.p3.3.m3.1.1.6.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.6.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3">subscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.6.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.6.3.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.6.3.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3.2.2">𝐸</ci><ci id="S3.SS2.p3.3.m3.1.1.6.3.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3.2.3">𝒞</ci></apply><apply id="S3.SS2.p3.3.m3.1.1.6.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.6.3.3.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.6.3.3.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3.3.2">𝑐</ci><ci id="S3.SS2.p3.3.m3.1.1.6.3.3.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.3.3.3">𝑘</ci></apply></apply><ci id="S3.SS2.p3.3.m3.1.1.6.4.cmml" xref="S3.SS2.p3.3.m3.1.1.6.4">⋯</ci><apply id="S3.SS2.p3.3.m3.1.1.6.5.cmml" xref="S3.SS2.p3.3.m3.1.1.6.5"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.6.5.1.cmml" xref="S3.SS2.p3.3.m3.1.1.6.5">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.6.5.2.cmml" xref="S3.SS2.p3.3.m3.1.1.6.5.2">𝑒</ci><ci id="S3.SS2.p3.3.m3.1.1.6.5.3.cmml" xref="S3.SS2.p3.3.m3.1.1.6.5.3">𝑘</ci></apply><ci id="S3.SS2.p3.3.m3.1.1.6.6.cmml" xref="S3.SS2.p3.3.m3.1.1.6.6">⋯</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\mathcal{F}_{k}\in\mathbb{R}^{d_{\text{full}}}=E^{\mathcal{I}}_{i_{k}}\oplus E%
^{\mathcal{C}}_{c_{k}}\oplus\cdots\oplus e_{k}\oplus\cdots</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">caligraphic_F start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT full end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = italic_E start_POSTSUPERSCRIPT caligraphic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⊕ italic_E start_POSTSUPERSCRIPT caligraphic_C end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⊕ ⋯ ⊕ italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⊕ ⋯</annotation></semantics></math>, where <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mo id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><csymbol cd="latexml" id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">⊕</annotation></semantics></math> is a concatenation operator, <math alttext="E" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_E</annotation></semantics></math> indicates a trainable embedding layer, and <math alttext="d_{\text{full}}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">d</mi><mtext id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3a.cmml">full</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝑑</ci><ci id="S3.SS2.p3.6.m6.1.1.3a.cmml" xref="S3.SS2.p3.6.m6.1.1.3"><mtext id="S3.SS2.p3.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p3.6.m6.1.1.3">full</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">d_{\text{full}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_d start_POSTSUBSCRIPT full end_POSTSUBSCRIPT</annotation></semantics></math> is a dimension of the input feature <math alttext="\mathcal{F}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">ℱ</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">\mathcal{F}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">caligraphic_F start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
The interaction feature sequence <math alttext="\{\mathcal{F}_{1},\ldots,\mathcal{F}_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.3"><semantics id="S3.SS2.p3.8.m8.3a"><mrow id="S3.SS2.p3.8.m8.3.3.2" xref="S3.SS2.p3.8.m8.3.3.3.cmml"><mo id="S3.SS2.p3.8.m8.3.3.2.3" stretchy="false" xref="S3.SS2.p3.8.m8.3.3.3.cmml">{</mo><msub id="S3.SS2.p3.8.m8.2.2.1.1" xref="S3.SS2.p3.8.m8.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.8.m8.2.2.1.1.2" xref="S3.SS2.p3.8.m8.2.2.1.1.2.cmml">ℱ</mi><mn id="S3.SS2.p3.8.m8.2.2.1.1.3" xref="S3.SS2.p3.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.8.m8.3.3.2.4" xref="S3.SS2.p3.8.m8.3.3.3.cmml">,</mo><mi id="S3.SS2.p3.8.m8.1.1" mathvariant="normal" xref="S3.SS2.p3.8.m8.1.1.cmml">…</mi><mo id="S3.SS2.p3.8.m8.3.3.2.5" xref="S3.SS2.p3.8.m8.3.3.3.cmml">,</mo><msub id="S3.SS2.p3.8.m8.3.3.2.2" xref="S3.SS2.p3.8.m8.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.8.m8.3.3.2.2.2" xref="S3.SS2.p3.8.m8.3.3.2.2.2.cmml">ℱ</mi><mi id="S3.SS2.p3.8.m8.3.3.2.2.3" xref="S3.SS2.p3.8.m8.3.3.2.2.3.cmml">n</mi></msub><mo id="S3.SS2.p3.8.m8.3.3.2.6" stretchy="false" xref="S3.SS2.p3.8.m8.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.3b"><set id="S3.SS2.p3.8.m8.3.3.3.cmml" xref="S3.SS2.p3.8.m8.3.3.2"><apply id="S3.SS2.p3.8.m8.2.2.1.1.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.2.2.1.1.1.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.2.2.1.1.2.cmml" xref="S3.SS2.p3.8.m8.2.2.1.1.2">ℱ</ci><cn id="S3.SS2.p3.8.m8.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p3.8.m8.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">…</ci><apply id="S3.SS2.p3.8.m8.3.3.2.2.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.3.3.2.2.1.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p3.8.m8.3.3.2.2.2.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2.2">ℱ</ci><ci id="S3.SS2.p3.8.m8.3.3.2.2.3.cmml" xref="S3.SS2.p3.8.m8.3.3.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.3c">\{\mathcal{F}_{1},\ldots,\mathcal{F}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.3d">{ caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> will be used later for intent and item-ID predictions of a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><mi id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><ci id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">italic_u</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.5">A user’s short-term interest is crucial for accurate next-intent and next-item predictions <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib30" title="">2021</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib29" title="">2018</a>)</cite>.
Assuming we are given interactions <math alttext="\{int_{1},\ldots,int_{k}\}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.3"><semantics id="S3.SS2.p4.1.m1.3a"><mrow id="S3.SS2.p4.1.m1.3.3.2" xref="S3.SS2.p4.1.m1.3.3.3.cmml"><mo id="S3.SS2.p4.1.m1.3.3.2.3" stretchy="false" xref="S3.SS2.p4.1.m1.3.3.3.cmml">{</mo><mrow id="S3.SS2.p4.1.m1.2.2.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.2.cmml">i</mi><mo id="S3.SS2.p4.1.m1.2.2.1.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p4.1.m1.2.2.1.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.3.cmml">n</mi><mo id="S3.SS2.p4.1.m1.2.2.1.1.1a" xref="S3.SS2.p4.1.m1.2.2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p4.1.m1.2.2.1.1.4" xref="S3.SS2.p4.1.m1.2.2.1.1.4.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.4.2" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2.cmml">t</mi><mn id="S3.SS2.p4.1.m1.2.2.1.1.4.3" xref="S3.SS2.p4.1.m1.2.2.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.SS2.p4.1.m1.3.3.2.4" xref="S3.SS2.p4.1.m1.3.3.3.cmml">,</mo><mi id="S3.SS2.p4.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p4.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p4.1.m1.3.3.2.5" xref="S3.SS2.p4.1.m1.3.3.3.cmml">,</mo><mrow id="S3.SS2.p4.1.m1.3.3.2.2" xref="S3.SS2.p4.1.m1.3.3.2.2.cmml"><mi id="S3.SS2.p4.1.m1.3.3.2.2.2" xref="S3.SS2.p4.1.m1.3.3.2.2.2.cmml">i</mi><mo id="S3.SS2.p4.1.m1.3.3.2.2.1" xref="S3.SS2.p4.1.m1.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS2.p4.1.m1.3.3.2.2.3" xref="S3.SS2.p4.1.m1.3.3.2.2.3.cmml">n</mi><mo id="S3.SS2.p4.1.m1.3.3.2.2.1a" xref="S3.SS2.p4.1.m1.3.3.2.2.1.cmml">⁢</mo><msub id="S3.SS2.p4.1.m1.3.3.2.2.4" xref="S3.SS2.p4.1.m1.3.3.2.2.4.cmml"><mi id="S3.SS2.p4.1.m1.3.3.2.2.4.2" xref="S3.SS2.p4.1.m1.3.3.2.2.4.2.cmml">t</mi><mi id="S3.SS2.p4.1.m1.3.3.2.2.4.3" xref="S3.SS2.p4.1.m1.3.3.2.2.4.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.p4.1.m1.3.3.2.6" stretchy="false" xref="S3.SS2.p4.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.3b"><set id="S3.SS2.p4.1.m1.3.3.3.cmml" xref="S3.SS2.p4.1.m1.3.3.2"><apply id="S3.SS2.p4.1.m1.2.2.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1"><times id="S3.SS2.p4.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1"></times><ci id="S3.SS2.p4.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2">𝑖</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.3">𝑛</ci><apply id="S3.SS2.p4.1.m1.2.2.1.1.4.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.4.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.1.1.4.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2">𝑡</ci><cn id="S3.SS2.p4.1.m1.2.2.1.1.4.3.cmml" type="integer" xref="S3.SS2.p4.1.m1.2.2.1.1.4.3">1</cn></apply></apply><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">…</ci><apply id="S3.SS2.p4.1.m1.3.3.2.2.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2"><times id="S3.SS2.p4.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.1"></times><ci id="S3.SS2.p4.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.2">𝑖</ci><ci id="S3.SS2.p4.1.m1.3.3.2.2.3.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.3">𝑛</ci><apply id="S3.SS2.p4.1.m1.3.3.2.2.4.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.3.3.2.2.4.1.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.4">subscript</csymbol><ci id="S3.SS2.p4.1.m1.3.3.2.2.4.2.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.4.2">𝑡</ci><ci id="S3.SS2.p4.1.m1.3.3.2.2.4.3.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.4.3">𝑘</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.3c">\{int_{1},\ldots,int_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.3d">{ italic_i italic_n italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> of a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_u</annotation></semantics></math> and want to predict the next intent and item (e.g., <math alttext="i_{k+1}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">i</mi><mrow id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml"><mi id="S3.SS2.p4.3.m3.1.1.3.2" xref="S3.SS2.p4.3.m3.1.1.3.2.cmml">k</mi><mo id="S3.SS2.p4.3.m3.1.1.3.1" xref="S3.SS2.p4.3.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p4.3.m3.1.1.3.3" xref="S3.SS2.p4.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑖</ci><apply id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3"><plus id="S3.SS2.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.p4.3.m3.1.1.3.1"></plus><ci id="S3.SS2.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.p4.3.m3.1.1.3.2">𝑘</ci><cn id="S3.SS2.p4.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS2.p4.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">i_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_i start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math>) of this user,
a naive way to define the short-term interest is aggregating the recent <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">italic_L</annotation></semantics></math> interactions for each user (e.g., <math alttext="\{int_{k-L+1},\ldots,int_{k}\}" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.3"><semantics id="S3.SS2.p4.5.m5.3a"><mrow id="S3.SS2.p4.5.m5.3.3.2" xref="S3.SS2.p4.5.m5.3.3.3.cmml"><mo id="S3.SS2.p4.5.m5.3.3.2.3" stretchy="false" xref="S3.SS2.p4.5.m5.3.3.3.cmml">{</mo><mrow id="S3.SS2.p4.5.m5.2.2.1.1" xref="S3.SS2.p4.5.m5.2.2.1.1.cmml"><mi id="S3.SS2.p4.5.m5.2.2.1.1.2" xref="S3.SS2.p4.5.m5.2.2.1.1.2.cmml">i</mi><mo id="S3.SS2.p4.5.m5.2.2.1.1.1" xref="S3.SS2.p4.5.m5.2.2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p4.5.m5.2.2.1.1.3" xref="S3.SS2.p4.5.m5.2.2.1.1.3.cmml">n</mi><mo id="S3.SS2.p4.5.m5.2.2.1.1.1a" xref="S3.SS2.p4.5.m5.2.2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p4.5.m5.2.2.1.1.4" xref="S3.SS2.p4.5.m5.2.2.1.1.4.cmml"><mi id="S3.SS2.p4.5.m5.2.2.1.1.4.2" xref="S3.SS2.p4.5.m5.2.2.1.1.4.2.cmml">t</mi><mrow id="S3.SS2.p4.5.m5.2.2.1.1.4.3" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.cmml"><mrow id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.cmml"><mi id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.2" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.2.cmml">k</mi><mo id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.1" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.1.cmml">−</mo><mi id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.3" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.3.cmml">L</mi></mrow><mo id="S3.SS2.p4.5.m5.2.2.1.1.4.3.1" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.1.cmml">+</mo><mn id="S3.SS2.p4.5.m5.2.2.1.1.4.3.3" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.SS2.p4.5.m5.3.3.2.4" xref="S3.SS2.p4.5.m5.3.3.3.cmml">,</mo><mi id="S3.SS2.p4.5.m5.1.1" mathvariant="normal" xref="S3.SS2.p4.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.p4.5.m5.3.3.2.5" xref="S3.SS2.p4.5.m5.3.3.3.cmml">,</mo><mrow id="S3.SS2.p4.5.m5.3.3.2.2" xref="S3.SS2.p4.5.m5.3.3.2.2.cmml"><mi id="S3.SS2.p4.5.m5.3.3.2.2.2" xref="S3.SS2.p4.5.m5.3.3.2.2.2.cmml">i</mi><mo id="S3.SS2.p4.5.m5.3.3.2.2.1" xref="S3.SS2.p4.5.m5.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS2.p4.5.m5.3.3.2.2.3" xref="S3.SS2.p4.5.m5.3.3.2.2.3.cmml">n</mi><mo id="S3.SS2.p4.5.m5.3.3.2.2.1a" xref="S3.SS2.p4.5.m5.3.3.2.2.1.cmml">⁢</mo><msub id="S3.SS2.p4.5.m5.3.3.2.2.4" xref="S3.SS2.p4.5.m5.3.3.2.2.4.cmml"><mi id="S3.SS2.p4.5.m5.3.3.2.2.4.2" xref="S3.SS2.p4.5.m5.3.3.2.2.4.2.cmml">t</mi><mi id="S3.SS2.p4.5.m5.3.3.2.2.4.3" xref="S3.SS2.p4.5.m5.3.3.2.2.4.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.p4.5.m5.3.3.2.6" stretchy="false" xref="S3.SS2.p4.5.m5.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.3b"><set id="S3.SS2.p4.5.m5.3.3.3.cmml" xref="S3.SS2.p4.5.m5.3.3.2"><apply id="S3.SS2.p4.5.m5.2.2.1.1.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1"><times id="S3.SS2.p4.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.1"></times><ci id="S3.SS2.p4.5.m5.2.2.1.1.2.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.2">𝑖</ci><ci id="S3.SS2.p4.5.m5.2.2.1.1.3.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.3">𝑛</ci><apply id="S3.SS2.p4.5.m5.2.2.1.1.4.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.2.2.1.1.4.1.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4">subscript</csymbol><ci id="S3.SS2.p4.5.m5.2.2.1.1.4.2.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4.2">𝑡</ci><apply id="S3.SS2.p4.5.m5.2.2.1.1.4.3.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3"><plus id="S3.SS2.p4.5.m5.2.2.1.1.4.3.1.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.1"></plus><apply id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2"><minus id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.1.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.1"></minus><ci id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.2.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.2">𝑘</ci><ci id="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.3.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.2.3">𝐿</ci></apply><cn id="S3.SS2.p4.5.m5.2.2.1.1.4.3.3.cmml" type="integer" xref="S3.SS2.p4.5.m5.2.2.1.1.4.3.3">1</cn></apply></apply></apply><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">…</ci><apply id="S3.SS2.p4.5.m5.3.3.2.2.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2"><times id="S3.SS2.p4.5.m5.3.3.2.2.1.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2.1"></times><ci id="S3.SS2.p4.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2.2">𝑖</ci><ci id="S3.SS2.p4.5.m5.3.3.2.2.3.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2.3">𝑛</ci><apply id="S3.SS2.p4.5.m5.3.3.2.2.4.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.3.3.2.2.4.1.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2.4">subscript</csymbol><ci id="S3.SS2.p4.5.m5.3.3.2.2.4.2.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2.4.2">𝑡</ci><ci id="S3.SS2.p4.5.m5.3.3.2.2.4.3.cmml" xref="S3.SS2.p4.5.m5.3.3.2.2.4.3">𝑘</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.3c">\{int_{k-L+1},\ldots,int_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.3d">{ italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k - italic_L + 1 end_POSTSUBSCRIPT , … , italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>) using an off-the-shelf encoder such as Transformer.
However, as different users may have very different viewing patterns, the number of interactions that corresponds to <em class="ltx_emph ltx_font_italic" id="S3.SS2.p4.5.1">short-term</em> for some members might not be the same for some other members, hence we propose a personalized approach to define the short-term interest of a user.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.5">We use a timestamp-based definition of the short-term interest. Specifically, we set a time window hyperparameter <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_H</annotation></semantics></math> (e.g., 1 week, 1 day, 1 hour, etc.) and treat the recent interactions happening within the window <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">italic_H</annotation></semantics></math> as the short-term interest of a user. Formally, given interactions <math alttext="\{int_{1},\ldots,int_{k}\}" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.3"><semantics id="S3.SS2.p5.3.m3.3a"><mrow id="S3.SS2.p5.3.m3.3.3.2" xref="S3.SS2.p5.3.m3.3.3.3.cmml"><mo id="S3.SS2.p5.3.m3.3.3.2.3" stretchy="false" xref="S3.SS2.p5.3.m3.3.3.3.cmml">{</mo><mrow id="S3.SS2.p5.3.m3.2.2.1.1" xref="S3.SS2.p5.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.p5.3.m3.2.2.1.1.2" xref="S3.SS2.p5.3.m3.2.2.1.1.2.cmml">i</mi><mo id="S3.SS2.p5.3.m3.2.2.1.1.1" xref="S3.SS2.p5.3.m3.2.2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p5.3.m3.2.2.1.1.3" xref="S3.SS2.p5.3.m3.2.2.1.1.3.cmml">n</mi><mo id="S3.SS2.p5.3.m3.2.2.1.1.1a" xref="S3.SS2.p5.3.m3.2.2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p5.3.m3.2.2.1.1.4" xref="S3.SS2.p5.3.m3.2.2.1.1.4.cmml"><mi id="S3.SS2.p5.3.m3.2.2.1.1.4.2" xref="S3.SS2.p5.3.m3.2.2.1.1.4.2.cmml">t</mi><mn id="S3.SS2.p5.3.m3.2.2.1.1.4.3" xref="S3.SS2.p5.3.m3.2.2.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.SS2.p5.3.m3.3.3.2.4" xref="S3.SS2.p5.3.m3.3.3.3.cmml">,</mo><mi id="S3.SS2.p5.3.m3.1.1" mathvariant="normal" xref="S3.SS2.p5.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p5.3.m3.3.3.2.5" xref="S3.SS2.p5.3.m3.3.3.3.cmml">,</mo><mrow id="S3.SS2.p5.3.m3.3.3.2.2" xref="S3.SS2.p5.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.p5.3.m3.3.3.2.2.2" xref="S3.SS2.p5.3.m3.3.3.2.2.2.cmml">i</mi><mo id="S3.SS2.p5.3.m3.3.3.2.2.1" xref="S3.SS2.p5.3.m3.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS2.p5.3.m3.3.3.2.2.3" xref="S3.SS2.p5.3.m3.3.3.2.2.3.cmml">n</mi><mo id="S3.SS2.p5.3.m3.3.3.2.2.1a" xref="S3.SS2.p5.3.m3.3.3.2.2.1.cmml">⁢</mo><msub id="S3.SS2.p5.3.m3.3.3.2.2.4" xref="S3.SS2.p5.3.m3.3.3.2.2.4.cmml"><mi id="S3.SS2.p5.3.m3.3.3.2.2.4.2" xref="S3.SS2.p5.3.m3.3.3.2.2.4.2.cmml">t</mi><mi id="S3.SS2.p5.3.m3.3.3.2.2.4.3" xref="S3.SS2.p5.3.m3.3.3.2.2.4.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.p5.3.m3.3.3.2.6" stretchy="false" xref="S3.SS2.p5.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.3b"><set id="S3.SS2.p5.3.m3.3.3.3.cmml" xref="S3.SS2.p5.3.m3.3.3.2"><apply id="S3.SS2.p5.3.m3.2.2.1.1.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1"><times id="S3.SS2.p5.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1.1"></times><ci id="S3.SS2.p5.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1.2">𝑖</ci><ci id="S3.SS2.p5.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1.3">𝑛</ci><apply id="S3.SS2.p5.3.m3.2.2.1.1.4.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.2.2.1.1.4.1.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1.4">subscript</csymbol><ci id="S3.SS2.p5.3.m3.2.2.1.1.4.2.cmml" xref="S3.SS2.p5.3.m3.2.2.1.1.4.2">𝑡</ci><cn id="S3.SS2.p5.3.m3.2.2.1.1.4.3.cmml" type="integer" xref="S3.SS2.p5.3.m3.2.2.1.1.4.3">1</cn></apply></apply><ci id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">…</ci><apply id="S3.SS2.p5.3.m3.3.3.2.2.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2"><times id="S3.SS2.p5.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2.1"></times><ci id="S3.SS2.p5.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2.2">𝑖</ci><ci id="S3.SS2.p5.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2.3">𝑛</ci><apply id="S3.SS2.p5.3.m3.3.3.2.2.4.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.3.3.2.2.4.1.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2.4">subscript</csymbol><ci id="S3.SS2.p5.3.m3.3.3.2.2.4.2.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2.4.2">𝑡</ci><ci id="S3.SS2.p5.3.m3.3.3.2.2.4.3.cmml" xref="S3.SS2.p5.3.m3.3.3.2.2.4.3">𝑘</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.3c">\{int_{1},\ldots,int_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.3d">{ italic_i italic_n italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> of a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><mi id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><ci id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">italic_u</annotation></semantics></math>, the short-term interest feature <math alttext="\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1"><semantics id="S3.SS2.p5.5.m5.1a"><msub id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml">𝒮</mi><mi id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2">𝒮</ci><ci id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m5.1d">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is defined as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{S}_{k}\in\mathbb{R}^{d_{\text{short}}}=Enc(\mathcal{F}_{pos},\ldots,%
\mathcal{F}_{k}),\hskip 2.84526ptpos=\operatorname*{arg\,min}_{1\leq i\leq k}(%
\mathcal{T}_{k}-\mathcal{T}_{i}\leq H)," class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1"><mrow id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.3.cmml"><mrow id="S3.E1.m1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.4" xref="S3.E1.m1.2.2.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.1.4.2" xref="S3.E1.m1.2.2.1.1.1.1.4.2.cmml">𝒮</mi><mi id="S3.E1.m1.2.2.1.1.1.1.4.3" xref="S3.E1.m1.2.2.1.1.1.1.4.3.cmml">k</mi></msub><mo id="S3.E1.m1.2.2.1.1.1.1.5" xref="S3.E1.m1.2.2.1.1.1.1.5.cmml">∈</mo><msup id="S3.E1.m1.2.2.1.1.1.1.6" xref="S3.E1.m1.2.2.1.1.1.1.6.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.6.2" xref="S3.E1.m1.2.2.1.1.1.1.6.2.cmml">ℝ</mi><msub id="S3.E1.m1.2.2.1.1.1.1.6.3" xref="S3.E1.m1.2.2.1.1.1.1.6.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.6.3.2" xref="S3.E1.m1.2.2.1.1.1.1.6.3.2.cmml">d</mi><mtext id="S3.E1.m1.2.2.1.1.1.1.6.3.3" xref="S3.E1.m1.2.2.1.1.1.1.6.3.3a.cmml">short</mtext></msub></msup><mo id="S3.E1.m1.2.2.1.1.1.1.7" xref="S3.E1.m1.2.2.1.1.1.1.7.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.2.4" xref="S3.E1.m1.2.2.1.1.1.1.2.4.cmml">E</mi><mo id="S3.E1.m1.2.2.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.2.5" xref="S3.E1.m1.2.2.1.1.1.1.2.5.cmml">n</mi><mo id="S3.E1.m1.2.2.1.1.1.1.2.3a" xref="S3.E1.m1.2.2.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.2.6" xref="S3.E1.m1.2.2.1.1.1.1.2.6.cmml">c</mi><mo id="S3.E1.m1.2.2.1.1.1.1.2.3b" xref="S3.E1.m1.2.2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.1.1.2.2.3.cmml"><mo id="S3.E1.m1.2.2.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">ℱ</mi><mrow id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">o</mi><mo id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.1a" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.4" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S3.E1.m1.2.2.1.1.1.1.2.2.2.4" xref="S3.E1.m1.2.2.1.1.1.1.2.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1" mathvariant="normal" xref="S3.E1.m1.1.1.cmml">…</mi><mo id="S3.E1.m1.2.2.1.1.1.1.2.2.2.5" xref="S3.E1.m1.2.2.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.1.1.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.2.cmml">ℱ</mi><mi id="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.E1.m1.2.2.1.1.1.1.2.2.2.6" stretchy="false" xref="S3.E1.m1.2.2.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.1.2.3" rspace="0.447em" xref="S3.E1.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.2.2.1.1.2.2" xref="S3.E1.m1.2.2.1.1.2.2.cmml"><mrow id="S3.E1.m1.2.2.1.1.2.2.4" xref="S3.E1.m1.2.2.1.1.2.2.4.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.4.2" xref="S3.E1.m1.2.2.1.1.2.2.4.2.cmml">p</mi><mo id="S3.E1.m1.2.2.1.1.2.2.4.1" xref="S3.E1.m1.2.2.1.1.2.2.4.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.2.2.4.3" xref="S3.E1.m1.2.2.1.1.2.2.4.3.cmml">o</mi><mo id="S3.E1.m1.2.2.1.1.2.2.4.1a" xref="S3.E1.m1.2.2.1.1.2.2.4.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.2.2.4.4" xref="S3.E1.m1.2.2.1.1.2.2.4.4.cmml">s</mi></mrow><mo id="S3.E1.m1.2.2.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.3.cmml"><munder id="S3.E1.m1.2.2.1.1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.2.cmml">arg</mi><mo id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.1" lspace="0.170em" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.3.cmml">min</mi></mrow><mrow id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.cmml"><mn id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.2.cmml">1</mn><mo id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.3.cmml">≤</mo><mi id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.4" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.4.cmml">i</mi><mo id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.5" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.5.cmml">≤</mo><mi id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.6" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.6.cmml">k</mi></mrow></munder><mo id="S3.E1.m1.2.2.1.1.2.2.2.2a" xref="S3.E1.m1.2.2.1.1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.3.cmml"><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.cmml"><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.cmml"><msub id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.2.cmml">𝒯</mi><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.3.cmml">k</mi></msub><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.1" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.1.cmml">−</mo><msub id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.2.cmml">𝒯</mi><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.1" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.1.cmml">≤</mo><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.3.cmml">H</mi></mrow><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.2.2.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.3a.cmml" xref="S3.E1.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><and id="S3.E1.m1.2.2.1.1.1.1a.cmml" xref="S3.E1.m1.2.2.1.1.1.1"></and><apply id="S3.E1.m1.2.2.1.1.1.1b.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><in id="S3.E1.m1.2.2.1.1.1.1.5.cmml" xref="S3.E1.m1.2.2.1.1.1.1.5"></in><apply id="S3.E1.m1.2.2.1.1.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.4.2">𝒮</ci><ci id="S3.E1.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.4.3">𝑘</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.6.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.6.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6">superscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.6.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6.2">ℝ</ci><apply id="S3.E1.m1.2.2.1.1.1.1.6.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.6.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.6.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6.3.2">𝑑</ci><ci id="S3.E1.m1.2.2.1.1.1.1.6.3.3a.cmml" xref="S3.E1.m1.2.2.1.1.1.1.6.3.3"><mtext id="S3.E1.m1.2.2.1.1.1.1.6.3.3.cmml" mathsize="50%" xref="S3.E1.m1.2.2.1.1.1.1.6.3.3">short</mtext></ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.1.1c.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><eq id="S3.E1.m1.2.2.1.1.1.1.7.cmml" xref="S3.E1.m1.2.2.1.1.1.1.7"></eq><share href="https://arxiv.org/html/2408.05353v1#S3.E1.m1.2.2.1.1.1.1.6.cmml" id="S3.E1.m1.2.2.1.1.1.1d.cmml" xref="S3.E1.m1.2.2.1.1.1.1"></share><apply id="S3.E1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2"><times id="S3.E1.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.3"></times><ci id="S3.E1.m1.2.2.1.1.1.1.2.4.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.4">𝐸</ci><ci id="S3.E1.m1.2.2.1.1.1.1.2.5.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.5">𝑛</ci><ci id="S3.E1.m1.2.2.1.1.1.1.2.6.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.6">𝑐</ci><vector id="S3.E1.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2"><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2">ℱ</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3"><times id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑜</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">…</ci><apply id="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.2">ℱ</ci><ci id="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.2.2.2.3">𝑘</ci></apply></vector></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2"><eq id="S3.E1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3"></eq><apply id="S3.E1.m1.2.2.1.1.2.2.4.cmml" xref="S3.E1.m1.2.2.1.1.2.2.4"><times id="S3.E1.m1.2.2.1.1.2.2.4.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.4.1"></times><ci id="S3.E1.m1.2.2.1.1.2.2.4.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.4.2">𝑝</ci><ci id="S3.E1.m1.2.2.1.1.2.2.4.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.4.3">𝑜</ci><ci id="S3.E1.m1.2.2.1.1.2.2.4.4.cmml" xref="S3.E1.m1.2.2.1.1.2.2.4.4">𝑠</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2"><apply id="S3.E1.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1">subscript</csymbol><apply id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2"><times id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.1"></times><ci id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.2">arg</ci><ci id="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.2.3">min</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3"><and id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3a.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3"></and><apply id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3b.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3"><leq id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.3"></leq><cn id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.2.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.2">1</cn><ci id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.4.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.4">𝑖</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3c.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3"><leq id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.5.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.5"></leq><share href="https://arxiv.org/html/2408.05353v1#S3.E1.m1.2.2.1.1.2.2.1.1.1.3.4.cmml" id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3d.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3"></share><ci id="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.6.cmml" xref="S3.E1.m1.2.2.1.1.2.2.1.1.1.3.6">𝑘</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1"><leq id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.1"></leq><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2"><minus id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.1"></minus><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.2">𝒯</ci><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.2.3">𝑘</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.2">𝒯</ci><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.1.3">𝐻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\mathcal{S}_{k}\in\mathbb{R}^{d_{\text{short}}}=Enc(\mathcal{F}_{pos},\ldots,%
\mathcal{F}_{k}),\hskip 2.84526ptpos=\operatorname*{arg\,min}_{1\leq i\leq k}(%
\mathcal{T}_{k}-\mathcal{T}_{i}\leq H),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT short end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = italic_E italic_n italic_c ( caligraphic_F start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) , italic_p italic_o italic_s = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT 1 ≤ italic_i ≤ italic_k end_POSTSUBSCRIPT ( caligraphic_T start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - caligraphic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≤ italic_H ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p5.10">where <math alttext="Enc(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p5.6.m1.1"><semantics id="S3.SS2.p5.6.m1.1a"><mrow id="S3.SS2.p5.6.m1.1.2" xref="S3.SS2.p5.6.m1.1.2.cmml"><mi id="S3.SS2.p5.6.m1.1.2.2" xref="S3.SS2.p5.6.m1.1.2.2.cmml">E</mi><mo id="S3.SS2.p5.6.m1.1.2.1" xref="S3.SS2.p5.6.m1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p5.6.m1.1.2.3" xref="S3.SS2.p5.6.m1.1.2.3.cmml">n</mi><mo id="S3.SS2.p5.6.m1.1.2.1a" xref="S3.SS2.p5.6.m1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p5.6.m1.1.2.4" xref="S3.SS2.p5.6.m1.1.2.4.cmml">c</mi><mo id="S3.SS2.p5.6.m1.1.2.1b" xref="S3.SS2.p5.6.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p5.6.m1.1.2.5.2" xref="S3.SS2.p5.6.m1.1.2.cmml"><mo id="S3.SS2.p5.6.m1.1.2.5.2.1" stretchy="false" xref="S3.SS2.p5.6.m1.1.2.cmml">(</mo><mo id="S3.SS2.p5.6.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p5.6.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.p5.6.m1.1.2.5.2.2" stretchy="false" xref="S3.SS2.p5.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m1.1b"><apply id="S3.SS2.p5.6.m1.1.2.cmml" xref="S3.SS2.p5.6.m1.1.2"><times id="S3.SS2.p5.6.m1.1.2.1.cmml" xref="S3.SS2.p5.6.m1.1.2.1"></times><ci id="S3.SS2.p5.6.m1.1.2.2.cmml" xref="S3.SS2.p5.6.m1.1.2.2">𝐸</ci><ci id="S3.SS2.p5.6.m1.1.2.3.cmml" xref="S3.SS2.p5.6.m1.1.2.3">𝑛</ci><ci id="S3.SS2.p5.6.m1.1.2.4.cmml" xref="S3.SS2.p5.6.m1.1.2.4">𝑐</ci><ci id="S3.SS2.p5.6.m1.1.1.cmml" xref="S3.SS2.p5.6.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m1.1c">Enc(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.6.m1.1d">italic_E italic_n italic_c ( ⋅ )</annotation></semantics></math> is an encoder (e.g., Transformer), and <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS2.p5.7.m2.1"><semantics id="S3.SS2.p5.7.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.7.m2.1.1" xref="S3.SS2.p5.7.m2.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m2.1b"><ci id="S3.SS2.p5.7.m2.1.1.cmml" xref="S3.SS2.p5.7.m2.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m2.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.7.m2.1d">caligraphic_T</annotation></semantics></math> indicates timestamps of interactions. In this way, our short-term interest features are more personalized compared to the interaction-based definition and aligned well with the business consideration.
The short-term interest feature sequence <math alttext="\{\mathcal{S}_{1},\ldots,\mathcal{S}_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p5.8.m3.3"><semantics id="S3.SS2.p5.8.m3.3a"><mrow id="S3.SS2.p5.8.m3.3.3.2" xref="S3.SS2.p5.8.m3.3.3.3.cmml"><mo id="S3.SS2.p5.8.m3.3.3.2.3" stretchy="false" xref="S3.SS2.p5.8.m3.3.3.3.cmml">{</mo><msub id="S3.SS2.p5.8.m3.2.2.1.1" xref="S3.SS2.p5.8.m3.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.8.m3.2.2.1.1.2" xref="S3.SS2.p5.8.m3.2.2.1.1.2.cmml">𝒮</mi><mn id="S3.SS2.p5.8.m3.2.2.1.1.3" xref="S3.SS2.p5.8.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p5.8.m3.3.3.2.4" xref="S3.SS2.p5.8.m3.3.3.3.cmml">,</mo><mi id="S3.SS2.p5.8.m3.1.1" mathvariant="normal" xref="S3.SS2.p5.8.m3.1.1.cmml">…</mi><mo id="S3.SS2.p5.8.m3.3.3.2.5" xref="S3.SS2.p5.8.m3.3.3.3.cmml">,</mo><msub id="S3.SS2.p5.8.m3.3.3.2.2" xref="S3.SS2.p5.8.m3.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.8.m3.3.3.2.2.2" xref="S3.SS2.p5.8.m3.3.3.2.2.2.cmml">𝒮</mi><mi id="S3.SS2.p5.8.m3.3.3.2.2.3" xref="S3.SS2.p5.8.m3.3.3.2.2.3.cmml">n</mi></msub><mo id="S3.SS2.p5.8.m3.3.3.2.6" stretchy="false" xref="S3.SS2.p5.8.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m3.3b"><set id="S3.SS2.p5.8.m3.3.3.3.cmml" xref="S3.SS2.p5.8.m3.3.3.2"><apply id="S3.SS2.p5.8.m3.2.2.1.1.cmml" xref="S3.SS2.p5.8.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.8.m3.2.2.1.1.1.cmml" xref="S3.SS2.p5.8.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p5.8.m3.2.2.1.1.2.cmml" xref="S3.SS2.p5.8.m3.2.2.1.1.2">𝒮</ci><cn id="S3.SS2.p5.8.m3.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p5.8.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p5.8.m3.1.1.cmml" xref="S3.SS2.p5.8.m3.1.1">…</ci><apply id="S3.SS2.p5.8.m3.3.3.2.2.cmml" xref="S3.SS2.p5.8.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.8.m3.3.3.2.2.1.cmml" xref="S3.SS2.p5.8.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p5.8.m3.3.3.2.2.2.cmml" xref="S3.SS2.p5.8.m3.3.3.2.2.2">𝒮</ci><ci id="S3.SS2.p5.8.m3.3.3.2.2.3.cmml" xref="S3.SS2.p5.8.m3.3.3.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.8.m3.3c">\{\mathcal{S}_{1},\ldots,\mathcal{S}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.8.m3.3d">{ caligraphic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_S start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> is concatenated with the interaction feature sequence <math alttext="\{\mathcal{F}_{1},\ldots,\mathcal{F}_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p5.9.m4.3"><semantics id="S3.SS2.p5.9.m4.3a"><mrow id="S3.SS2.p5.9.m4.3.3.2" xref="S3.SS2.p5.9.m4.3.3.3.cmml"><mo id="S3.SS2.p5.9.m4.3.3.2.3" stretchy="false" xref="S3.SS2.p5.9.m4.3.3.3.cmml">{</mo><msub id="S3.SS2.p5.9.m4.2.2.1.1" xref="S3.SS2.p5.9.m4.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.9.m4.2.2.1.1.2" xref="S3.SS2.p5.9.m4.2.2.1.1.2.cmml">ℱ</mi><mn id="S3.SS2.p5.9.m4.2.2.1.1.3" xref="S3.SS2.p5.9.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p5.9.m4.3.3.2.4" xref="S3.SS2.p5.9.m4.3.3.3.cmml">,</mo><mi id="S3.SS2.p5.9.m4.1.1" mathvariant="normal" xref="S3.SS2.p5.9.m4.1.1.cmml">…</mi><mo id="S3.SS2.p5.9.m4.3.3.2.5" xref="S3.SS2.p5.9.m4.3.3.3.cmml">,</mo><msub id="S3.SS2.p5.9.m4.3.3.2.2" xref="S3.SS2.p5.9.m4.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.9.m4.3.3.2.2.2" xref="S3.SS2.p5.9.m4.3.3.2.2.2.cmml">ℱ</mi><mi id="S3.SS2.p5.9.m4.3.3.2.2.3" xref="S3.SS2.p5.9.m4.3.3.2.2.3.cmml">n</mi></msub><mo id="S3.SS2.p5.9.m4.3.3.2.6" stretchy="false" xref="S3.SS2.p5.9.m4.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.9.m4.3b"><set id="S3.SS2.p5.9.m4.3.3.3.cmml" xref="S3.SS2.p5.9.m4.3.3.2"><apply id="S3.SS2.p5.9.m4.2.2.1.1.cmml" xref="S3.SS2.p5.9.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.9.m4.2.2.1.1.1.cmml" xref="S3.SS2.p5.9.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p5.9.m4.2.2.1.1.2.cmml" xref="S3.SS2.p5.9.m4.2.2.1.1.2">ℱ</ci><cn id="S3.SS2.p5.9.m4.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p5.9.m4.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p5.9.m4.1.1.cmml" xref="S3.SS2.p5.9.m4.1.1">…</ci><apply id="S3.SS2.p5.9.m4.3.3.2.2.cmml" xref="S3.SS2.p5.9.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.9.m4.3.3.2.2.1.cmml" xref="S3.SS2.p5.9.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p5.9.m4.3.3.2.2.2.cmml" xref="S3.SS2.p5.9.m4.3.3.2.2.2">ℱ</ci><ci id="S3.SS2.p5.9.m4.3.3.2.2.3.cmml" xref="S3.SS2.p5.9.m4.3.3.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.9.m4.3c">\{\mathcal{F}_{1},\ldots,\mathcal{F}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.9.m4.3d">{ caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> to form the final input feature sequence <math alttext="\{\mathcal{F}_{1}\oplus\mathcal{S}_{1},\ldots,\mathcal{F}_{n}\oplus\mathcal{S}%
_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p5.10.m5.3"><semantics id="S3.SS2.p5.10.m5.3a"><mrow id="S3.SS2.p5.10.m5.3.3.2" xref="S3.SS2.p5.10.m5.3.3.3.cmml"><mo id="S3.SS2.p5.10.m5.3.3.2.3" stretchy="false" xref="S3.SS2.p5.10.m5.3.3.3.cmml">{</mo><mrow id="S3.SS2.p5.10.m5.2.2.1.1" xref="S3.SS2.p5.10.m5.2.2.1.1.cmml"><msub id="S3.SS2.p5.10.m5.2.2.1.1.2" xref="S3.SS2.p5.10.m5.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.10.m5.2.2.1.1.2.2" xref="S3.SS2.p5.10.m5.2.2.1.1.2.2.cmml">ℱ</mi><mn id="S3.SS2.p5.10.m5.2.2.1.1.2.3" xref="S3.SS2.p5.10.m5.2.2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.p5.10.m5.2.2.1.1.1" xref="S3.SS2.p5.10.m5.2.2.1.1.1.cmml">⊕</mo><msub id="S3.SS2.p5.10.m5.2.2.1.1.3" xref="S3.SS2.p5.10.m5.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.10.m5.2.2.1.1.3.2" xref="S3.SS2.p5.10.m5.2.2.1.1.3.2.cmml">𝒮</mi><mn id="S3.SS2.p5.10.m5.2.2.1.1.3.3" xref="S3.SS2.p5.10.m5.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS2.p5.10.m5.3.3.2.4" xref="S3.SS2.p5.10.m5.3.3.3.cmml">,</mo><mi id="S3.SS2.p5.10.m5.1.1" mathvariant="normal" xref="S3.SS2.p5.10.m5.1.1.cmml">…</mi><mo id="S3.SS2.p5.10.m5.3.3.2.5" xref="S3.SS2.p5.10.m5.3.3.3.cmml">,</mo><mrow id="S3.SS2.p5.10.m5.3.3.2.2" xref="S3.SS2.p5.10.m5.3.3.2.2.cmml"><msub id="S3.SS2.p5.10.m5.3.3.2.2.2" xref="S3.SS2.p5.10.m5.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.10.m5.3.3.2.2.2.2" xref="S3.SS2.p5.10.m5.3.3.2.2.2.2.cmml">ℱ</mi><mi id="S3.SS2.p5.10.m5.3.3.2.2.2.3" xref="S3.SS2.p5.10.m5.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S3.SS2.p5.10.m5.3.3.2.2.1" xref="S3.SS2.p5.10.m5.3.3.2.2.1.cmml">⊕</mo><msub id="S3.SS2.p5.10.m5.3.3.2.2.3" xref="S3.SS2.p5.10.m5.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.10.m5.3.3.2.2.3.2" xref="S3.SS2.p5.10.m5.3.3.2.2.3.2.cmml">𝒮</mi><mi id="S3.SS2.p5.10.m5.3.3.2.2.3.3" xref="S3.SS2.p5.10.m5.3.3.2.2.3.3.cmml">n</mi></msub></mrow><mo id="S3.SS2.p5.10.m5.3.3.2.6" stretchy="false" xref="S3.SS2.p5.10.m5.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.10.m5.3b"><set id="S3.SS2.p5.10.m5.3.3.3.cmml" xref="S3.SS2.p5.10.m5.3.3.2"><apply id="S3.SS2.p5.10.m5.2.2.1.1.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p5.10.m5.2.2.1.1.1.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1.1">direct-sum</csymbol><apply id="S3.SS2.p5.10.m5.2.2.1.1.2.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.10.m5.2.2.1.1.2.1.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.10.m5.2.2.1.1.2.2.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1.2.2">ℱ</ci><cn id="S3.SS2.p5.10.m5.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS2.p5.10.m5.2.2.1.1.2.3">1</cn></apply><apply id="S3.SS2.p5.10.m5.2.2.1.1.3.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.10.m5.2.2.1.1.3.1.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.10.m5.2.2.1.1.3.2.cmml" xref="S3.SS2.p5.10.m5.2.2.1.1.3.2">𝒮</ci><cn id="S3.SS2.p5.10.m5.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS2.p5.10.m5.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p5.10.m5.1.1.cmml" xref="S3.SS2.p5.10.m5.1.1">…</ci><apply id="S3.SS2.p5.10.m5.3.3.2.2.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2"><csymbol cd="latexml" id="S3.SS2.p5.10.m5.3.3.2.2.1.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.1">direct-sum</csymbol><apply id="S3.SS2.p5.10.m5.3.3.2.2.2.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.10.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p5.10.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.2.2">ℱ</ci><ci id="S3.SS2.p5.10.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.2.3">𝑛</ci></apply><apply id="S3.SS2.p5.10.m5.3.3.2.2.3.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p5.10.m5.3.3.2.2.3.1.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.3">subscript</csymbol><ci id="S3.SS2.p5.10.m5.3.3.2.2.3.2.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.3.2">𝒮</ci><ci id="S3.SS2.p5.10.m5.3.3.2.2.3.3.cmml" xref="S3.SS2.p5.10.m5.3.3.2.2.3.3">𝑛</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.10.m5.3c">\{\mathcal{F}_{1}\oplus\mathcal{S}_{1},\ldots,\mathcal{F}_{n}\oplus\mathcal{S}%
_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.10.m5.3d">{ caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>.
The overall process is summarized in <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.F3" title="In 3.2. Input Feature Sequence Formation ‣ 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="441" id="S3.F3.g1" src="extracted/5755931/figs/feature_transformation.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Given a high-level interaction sequence of a user, an input feature sequence is constructed by a concatenation of an interaction feature sequence and a short-term interest feature sequence.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>User Intent Prediction</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In this paper, a <em class="ltx_emph ltx_font_italic" id="S3.SS3.p1.1.1">user intent</em> is represented as a mixture of distinctive labels in the user engagement data: Action type (e.g., discover new content, continue watching, etc.), Genre preference (e.g., thriller), Movie/Show type preference, Time-since-release information (e.g., within a week), Language preference, Expected session duration, Date/time behavioral pattern, etc.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>More labels can be also included as a user intent, but we leave it for future work.</span></span></span>.
Note that the intent definition varies across datasets/applications (e.g., genre in streaming vs category in E-commerce).
Detailed descriptions of some labels used for experiments are provided in <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.SS1.SSS1" title="4.1.1. Dataset ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.1.1</span></a>. Predictions of such user intents can serve as prior knowledge to the next-item predictor, and they can enhance the next-item prediction accuracy.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.3">We leverage the input feature sequence <math alttext="\{\mathcal{F}_{1}\oplus\mathcal{S}_{1},\ldots,\mathcal{F}_{n}\oplus\mathcal{S}%
_{n}\}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.3"><semantics id="S3.SS3.p2.1.m1.3a"><mrow id="S3.SS3.p2.1.m1.3.3.2" xref="S3.SS3.p2.1.m1.3.3.3.cmml"><mo id="S3.SS3.p2.1.m1.3.3.2.3" stretchy="false" xref="S3.SS3.p2.1.m1.3.3.3.cmml">{</mo><mrow id="S3.SS3.p2.1.m1.2.2.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.cmml"><msub id="S3.SS3.p2.1.m1.2.2.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.2.2.1.1.2.2" xref="S3.SS3.p2.1.m1.2.2.1.1.2.2.cmml">ℱ</mi><mn id="S3.SS3.p2.1.m1.2.2.1.1.2.3" xref="S3.SS3.p2.1.m1.2.2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml">⊕</mo><msub id="S3.SS3.p2.1.m1.2.2.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.2.2.1.1.3.2" xref="S3.SS3.p2.1.m1.2.2.1.1.3.2.cmml">𝒮</mi><mn id="S3.SS3.p2.1.m1.2.2.1.1.3.3" xref="S3.SS3.p2.1.m1.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS3.p2.1.m1.3.3.2.4" xref="S3.SS3.p2.1.m1.3.3.3.cmml">,</mo><mi id="S3.SS3.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS3.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p2.1.m1.3.3.2.5" xref="S3.SS3.p2.1.m1.3.3.3.cmml">,</mo><mrow id="S3.SS3.p2.1.m1.3.3.2.2" xref="S3.SS3.p2.1.m1.3.3.2.2.cmml"><msub id="S3.SS3.p2.1.m1.3.3.2.2.2" xref="S3.SS3.p2.1.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.3.3.2.2.2.2" xref="S3.SS3.p2.1.m1.3.3.2.2.2.2.cmml">ℱ</mi><mi id="S3.SS3.p2.1.m1.3.3.2.2.2.3" xref="S3.SS3.p2.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S3.SS3.p2.1.m1.3.3.2.2.1" xref="S3.SS3.p2.1.m1.3.3.2.2.1.cmml">⊕</mo><msub id="S3.SS3.p2.1.m1.3.3.2.2.3" xref="S3.SS3.p2.1.m1.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.3.3.2.2.3.2" xref="S3.SS3.p2.1.m1.3.3.2.2.3.2.cmml">𝒮</mi><mi id="S3.SS3.p2.1.m1.3.3.2.2.3.3" xref="S3.SS3.p2.1.m1.3.3.2.2.3.3.cmml">n</mi></msub></mrow><mo id="S3.SS3.p2.1.m1.3.3.2.6" stretchy="false" xref="S3.SS3.p2.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.3b"><set id="S3.SS3.p2.1.m1.3.3.3.cmml" xref="S3.SS3.p2.1.m1.3.3.2"><apply id="S3.SS3.p2.1.m1.2.2.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1">direct-sum</csymbol><apply id="S3.SS3.p2.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.2.2">ℱ</ci><cn id="S3.SS3.p2.1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2.1.1.2.3">1</cn></apply><apply id="S3.SS3.p2.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.3.2">𝒮</ci><cn id="S3.SS3.p2.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">…</ci><apply id="S3.SS3.p2.1.m1.3.3.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.1">direct-sum</csymbol><apply id="S3.SS3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2.2">ℱ</ci><ci id="S3.SS3.p2.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2.3">𝑛</ci></apply><apply id="S3.SS3.p2.1.m1.3.3.2.2.3.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.3.3.2.2.3.1.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.3.3.2.2.3.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.3.2">𝒮</ci><ci id="S3.SS3.p2.1.m1.3.3.2.2.3.3.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.3.3">𝑛</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.3c">\{\mathcal{F}_{1}\oplus\mathcal{S}_{1},\ldots,\mathcal{F}_{n}\oplus\mathcal{S}%
_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.3d">{ caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> of all users from <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.SS2" title="3.2. Input Feature Sequence Formation ‣ 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.2</span></a> to train a user intent encoder
and employ the trained encoder to predict the future intents of all users.
Before the input sequence is fed to the Transformer, it goes through a fully connected layer for dimensionality reduction and normalization.
Among various encoders, we use a Transformer encoder <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib51" title="">2017</a>)</cite> to effectively model the long-term interest of a user via multi-head attention.
We use timestamp embeddings (e.g., <math alttext="E_{t_{k}}^{\mathcal{T}}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msubsup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">E</mi><msub id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.3.2" xref="S3.SS3.p2.2.m2.1.1.2.3.2.cmml">t</mi><mi id="S3.SS3.p2.2.m2.1.1.2.3.3" xref="S3.SS3.p2.2.m2.1.1.2.3.3.cmml">k</mi></msub><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">𝒯</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝐸</ci><apply id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3.2">𝑡</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">E_{t_{k}}^{\mathcal{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_E start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_T end_POSTSUPERSCRIPT</annotation></semantics></math>) as positional encoding in the Transformer.
The Transformer generates an intent encoding sequence <math alttext="\{E_{1}^{\text{intent}},\ldots,E_{n}^{\text{intent}}\}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.3"><semantics id="S3.SS3.p2.3.m3.3a"><mrow id="S3.SS3.p2.3.m3.3.3.2" xref="S3.SS3.p2.3.m3.3.3.3.cmml"><mo id="S3.SS3.p2.3.m3.3.3.2.3" stretchy="false" xref="S3.SS3.p2.3.m3.3.3.3.cmml">{</mo><msubsup id="S3.SS3.p2.3.m3.2.2.1.1" xref="S3.SS3.p2.3.m3.2.2.1.1.cmml"><mi id="S3.SS3.p2.3.m3.2.2.1.1.2.2" xref="S3.SS3.p2.3.m3.2.2.1.1.2.2.cmml">E</mi><mn id="S3.SS3.p2.3.m3.2.2.1.1.2.3" xref="S3.SS3.p2.3.m3.2.2.1.1.2.3.cmml">1</mn><mtext id="S3.SS3.p2.3.m3.2.2.1.1.3" xref="S3.SS3.p2.3.m3.2.2.1.1.3a.cmml">intent</mtext></msubsup><mo id="S3.SS3.p2.3.m3.3.3.2.4" xref="S3.SS3.p2.3.m3.3.3.3.cmml">,</mo><mi id="S3.SS3.p2.3.m3.1.1" mathvariant="normal" xref="S3.SS3.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS3.p2.3.m3.3.3.2.5" xref="S3.SS3.p2.3.m3.3.3.3.cmml">,</mo><msubsup id="S3.SS3.p2.3.m3.3.3.2.2" xref="S3.SS3.p2.3.m3.3.3.2.2.cmml"><mi id="S3.SS3.p2.3.m3.3.3.2.2.2.2" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.cmml">E</mi><mi id="S3.SS3.p2.3.m3.3.3.2.2.2.3" xref="S3.SS3.p2.3.m3.3.3.2.2.2.3.cmml">n</mi><mtext id="S3.SS3.p2.3.m3.3.3.2.2.3" xref="S3.SS3.p2.3.m3.3.3.2.2.3a.cmml">intent</mtext></msubsup><mo id="S3.SS3.p2.3.m3.3.3.2.6" stretchy="false" xref="S3.SS3.p2.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.3b"><set id="S3.SS3.p2.3.m3.3.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3.2"><apply id="S3.SS3.p2.3.m3.2.2.1.1.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1">superscript</csymbol><apply id="S3.SS3.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.2.2">𝐸</ci><cn id="S3.SS3.p2.3.m3.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS3.p2.3.m3.2.2.1.1.3a.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.3"><mtext id="S3.SS3.p2.3.m3.2.2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.3.m3.2.2.1.1.3">intent</mtext></ci></apply><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">…</ci><apply id="S3.SS3.p2.3.m3.3.3.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.2.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2">superscript</csymbol><apply id="S3.SS3.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2">𝐸</ci><ci id="S3.SS3.p2.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.3">𝑛</ci></apply><ci id="S3.SS3.p2.3.m3.3.3.2.2.3a.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.3"><mtext id="S3.SS3.p2.3.m3.3.3.2.2.3.cmml" mathsize="70%" xref="S3.SS3.p2.3.m3.3.3.2.2.3">intent</mtext></ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.3c">\{E_{1}^{\text{intent}},\ldots,E_{n}^{\text{intent}}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.3d">{ italic_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT intent end_POSTSUPERSCRIPT , … , italic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT intent end_POSTSUPERSCRIPT }</annotation></semantics></math> given the input feature sequence. We add a causal mask to the Transformer that prevents the encoder from attending to future interactions.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="743" id="S3.F4.g1" src="extracted/5755931/figs/intent_predictor.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Given an input feature sequence of a user, a user intent embedding sequence is constructed by an attention-based aggregation of auxiliary prediction (e.g., Action Type and Genre) results.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.10">Based on the intent encoding from the Transformer, we conduct multiple predictions of the aforementioned labels. For each prediction task, we transform the intent encoding to a prediction score vector via a fully-connected layer. For instance, given a user’s previous <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_k</annotation></semantics></math> interactions <math alttext="\{int_{1},\ldots,int_{k}\}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.3"><semantics id="S3.SS3.p3.2.m2.3a"><mrow id="S3.SS3.p3.2.m2.3.3.2" xref="S3.SS3.p3.2.m2.3.3.3.cmml"><mo id="S3.SS3.p3.2.m2.3.3.2.3" stretchy="false" xref="S3.SS3.p3.2.m2.3.3.3.cmml">{</mo><mrow id="S3.SS3.p3.2.m2.2.2.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.2.2.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.1.2.cmml">i</mi><mo id="S3.SS3.p3.2.m2.2.2.1.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.2.2.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.1.3.cmml">n</mi><mo id="S3.SS3.p3.2.m2.2.2.1.1.1a" xref="S3.SS3.p3.2.m2.2.2.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p3.2.m2.2.2.1.1.4" xref="S3.SS3.p3.2.m2.2.2.1.1.4.cmml"><mi id="S3.SS3.p3.2.m2.2.2.1.1.4.2" xref="S3.SS3.p3.2.m2.2.2.1.1.4.2.cmml">t</mi><mn id="S3.SS3.p3.2.m2.2.2.1.1.4.3" xref="S3.SS3.p3.2.m2.2.2.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.SS3.p3.2.m2.3.3.2.4" xref="S3.SS3.p3.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS3.p3.2.m2.1.1" mathvariant="normal" xref="S3.SS3.p3.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.p3.2.m2.3.3.2.5" xref="S3.SS3.p3.2.m2.3.3.3.cmml">,</mo><mrow id="S3.SS3.p3.2.m2.3.3.2.2" xref="S3.SS3.p3.2.m2.3.3.2.2.cmml"><mi id="S3.SS3.p3.2.m2.3.3.2.2.2" xref="S3.SS3.p3.2.m2.3.3.2.2.2.cmml">i</mi><mo id="S3.SS3.p3.2.m2.3.3.2.2.1" xref="S3.SS3.p3.2.m2.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.3.3.2.2.3" xref="S3.SS3.p3.2.m2.3.3.2.2.3.cmml">n</mi><mo id="S3.SS3.p3.2.m2.3.3.2.2.1a" xref="S3.SS3.p3.2.m2.3.3.2.2.1.cmml">⁢</mo><msub id="S3.SS3.p3.2.m2.3.3.2.2.4" xref="S3.SS3.p3.2.m2.3.3.2.2.4.cmml"><mi id="S3.SS3.p3.2.m2.3.3.2.2.4.2" xref="S3.SS3.p3.2.m2.3.3.2.2.4.2.cmml">t</mi><mi id="S3.SS3.p3.2.m2.3.3.2.2.4.3" xref="S3.SS3.p3.2.m2.3.3.2.2.4.3.cmml">k</mi></msub></mrow><mo id="S3.SS3.p3.2.m2.3.3.2.6" stretchy="false" xref="S3.SS3.p3.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.3b"><set id="S3.SS3.p3.2.m2.3.3.3.cmml" xref="S3.SS3.p3.2.m2.3.3.2"><apply id="S3.SS3.p3.2.m2.2.2.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1"><times id="S3.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1"></times><ci id="S3.SS3.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.2">𝑖</ci><ci id="S3.SS3.p3.2.m2.2.2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.3">𝑛</ci><apply id="S3.SS3.p3.2.m2.2.2.1.1.4.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.1.1.4.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.4">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.1.1.4.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.4.2">𝑡</ci><cn id="S3.SS3.p3.2.m2.2.2.1.1.4.3.cmml" type="integer" xref="S3.SS3.p3.2.m2.2.2.1.1.4.3">1</cn></apply></apply><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">…</ci><apply id="S3.SS3.p3.2.m2.3.3.2.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2"><times id="S3.SS3.p3.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.1"></times><ci id="S3.SS3.p3.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.2">𝑖</ci><ci id="S3.SS3.p3.2.m2.3.3.2.2.3.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.3">𝑛</ci><apply id="S3.SS3.p3.2.m2.3.3.2.2.4.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.3.3.2.2.4.1.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.4">subscript</csymbol><ci id="S3.SS3.p3.2.m2.3.3.2.2.4.2.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.4.2">𝑡</ci><ci id="S3.SS3.p3.2.m2.3.3.2.2.4.3.cmml" xref="S3.SS3.p3.2.m2.3.3.2.2.4.3">𝑘</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.3c">\{int_{1},\ldots,int_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.3d">{ italic_i italic_n italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_i italic_n italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> and the current intent encoding <math alttext="E_{k}^{\text{intent}}" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><msubsup id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">E</mi><mi id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml">k</mi><mtext id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3a.cmml">intent</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝐸</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p3.3.m3.1.1.3a.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><mtext id="S3.SS3.p3.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p3.3.m3.1.1.3">intent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">E_{k}^{\text{intent}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT intent end_POSTSUPERSCRIPT</annotation></semantics></math>, the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">italic_i</annotation></semantics></math>-th intent prediction vector at position <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.1"><semantics id="S3.SS3.p3.5.m5.1a"><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.1d">italic_k</annotation></semantics></math> is defined as follows: <math alttext="p^{\text{intent}_{i}}_{k}\in\mathbb{R}^{d_{i}}=\sigma(FC_{i}(E_{k}^{\text{%
intent}}))" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.1"><semantics id="S3.SS3.p3.6.m6.1a"><mrow id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><msubsup id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml"><mi id="S3.SS3.p3.6.m6.1.1.3.2.2" xref="S3.SS3.p3.6.m6.1.1.3.2.2.cmml">p</mi><mi id="S3.SS3.p3.6.m6.1.1.3.3" xref="S3.SS3.p3.6.m6.1.1.3.3.cmml">k</mi><msub id="S3.SS3.p3.6.m6.1.1.3.2.3" xref="S3.SS3.p3.6.m6.1.1.3.2.3.cmml"><mtext id="S3.SS3.p3.6.m6.1.1.3.2.3.2" xref="S3.SS3.p3.6.m6.1.1.3.2.3.2a.cmml">intent</mtext><mi id="S3.SS3.p3.6.m6.1.1.3.2.3.3" xref="S3.SS3.p3.6.m6.1.1.3.2.3.3.cmml">i</mi></msub></msubsup><mo id="S3.SS3.p3.6.m6.1.1.4" xref="S3.SS3.p3.6.m6.1.1.4.cmml">∈</mo><msup id="S3.SS3.p3.6.m6.1.1.5" xref="S3.SS3.p3.6.m6.1.1.5.cmml"><mi id="S3.SS3.p3.6.m6.1.1.5.2" xref="S3.SS3.p3.6.m6.1.1.5.2.cmml">ℝ</mi><msub id="S3.SS3.p3.6.m6.1.1.5.3" xref="S3.SS3.p3.6.m6.1.1.5.3.cmml"><mi id="S3.SS3.p3.6.m6.1.1.5.3.2" xref="S3.SS3.p3.6.m6.1.1.5.3.2.cmml">d</mi><mi id="S3.SS3.p3.6.m6.1.1.5.3.3" xref="S3.SS3.p3.6.m6.1.1.5.3.3.cmml">i</mi></msub></msup><mo id="S3.SS3.p3.6.m6.1.1.6" xref="S3.SS3.p3.6.m6.1.1.6.cmml">=</mo><mrow id="S3.SS3.p3.6.m6.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.1.3" xref="S3.SS3.p3.6.m6.1.1.1.3.cmml">σ</mi><mo id="S3.SS3.p3.6.m6.1.1.1.2" xref="S3.SS3.p3.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.6.m6.1.1.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.6.m6.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.6.m6.1.1.1.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.1.1.1.1.3" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.3.cmml">F</mi><mo id="S3.SS3.p3.6.m6.1.1.1.1.1.1.2" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.SS3.p3.6.m6.1.1.1.1.1.1.4" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.cmml"><mi id="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.2" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.2.cmml">C</mi><mi id="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.3" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo id="S3.SS3.p3.6.m6.1.1.1.1.1.1.2a" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mtext id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.3a.cmml">intent</mtext></msubsup><mo id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.6.m6.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><and id="S3.SS3.p3.6.m6.1.1a.cmml" xref="S3.SS3.p3.6.m6.1.1"></and><apply id="S3.SS3.p3.6.m6.1.1b.cmml" xref="S3.SS3.p3.6.m6.1.1"><in id="S3.SS3.p3.6.m6.1.1.4.cmml" xref="S3.SS3.p3.6.m6.1.1.4"></in><apply id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.3.1.cmml" xref="S3.SS3.p3.6.m6.1.1.3">subscript</csymbol><apply id="S3.SS3.p3.6.m6.1.1.3.2.cmml" xref="S3.SS3.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.3.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.3.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.3.2.2">𝑝</ci><apply id="S3.SS3.p3.6.m6.1.1.3.2.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.3.2.3.1.cmml" xref="S3.SS3.p3.6.m6.1.1.3.2.3">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.3.2.3.2a.cmml" xref="S3.SS3.p3.6.m6.1.1.3.2.3.2"><mtext id="S3.SS3.p3.6.m6.1.1.3.2.3.2.cmml" mathsize="70%" xref="S3.SS3.p3.6.m6.1.1.3.2.3.2">intent</mtext></ci><ci id="S3.SS3.p3.6.m6.1.1.3.2.3.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p3.6.m6.1.1.3.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3.3">𝑘</ci></apply><apply id="S3.SS3.p3.6.m6.1.1.5.cmml" xref="S3.SS3.p3.6.m6.1.1.5"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.5.1.cmml" xref="S3.SS3.p3.6.m6.1.1.5">superscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.5.2.cmml" xref="S3.SS3.p3.6.m6.1.1.5.2">ℝ</ci><apply id="S3.SS3.p3.6.m6.1.1.5.3.cmml" xref="S3.SS3.p3.6.m6.1.1.5.3"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.5.3.1.cmml" xref="S3.SS3.p3.6.m6.1.1.5.3">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.5.3.2.cmml" xref="S3.SS3.p3.6.m6.1.1.5.3.2">𝑑</ci><ci id="S3.SS3.p3.6.m6.1.1.5.3.3.cmml" xref="S3.SS3.p3.6.m6.1.1.5.3.3">𝑖</ci></apply></apply></apply><apply id="S3.SS3.p3.6.m6.1.1c.cmml" xref="S3.SS3.p3.6.m6.1.1"><eq id="S3.SS3.p3.6.m6.1.1.6.cmml" xref="S3.SS3.p3.6.m6.1.1.6"></eq><share href="https://arxiv.org/html/2408.05353v1#S3.SS3.p3.6.m6.1.1.5.cmml" id="S3.SS3.p3.6.m6.1.1d.cmml" xref="S3.SS3.p3.6.m6.1.1"></share><apply id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1"><times id="S3.SS3.p3.6.m6.1.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.1.2"></times><ci id="S3.SS3.p3.6.m6.1.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.1.3">𝜎</ci><apply id="S3.SS3.p3.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1"><times id="S3.SS3.p3.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.2"></times><ci id="S3.SS3.p3.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.3">𝐹</ci><apply id="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.2.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.2">𝐶</ci><ci id="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.3.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p3.6.m6.1.1.1.1.1.1.1.1.1.3">intent</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">p^{\text{intent}_{i}}_{k}\in\mathbb{R}^{d_{i}}=\sigma(FC_{i}(E_{k}^{\text{%
intent}}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m6.1d">italic_p start_POSTSUPERSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = italic_σ ( italic_F italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT intent end_POSTSUPERSCRIPT ) )</annotation></semantics></math>, where <math alttext="d_{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.1"><semantics id="S3.SS3.p3.7.m7.1a"><msub id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.2" xref="S3.SS3.p3.7.m7.1.1.2.cmml">d</mi><mi id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2">𝑑</ci><ci id="S3.SS3.p3.7.m7.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m7.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the number of unique labels for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m8.1"><semantics id="S3.SS3.p3.8.m8.1a"><mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m8.1d">italic_i</annotation></semantics></math>-th intent, <math alttext="FC_{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.9.m9.1"><semantics id="S3.SS3.p3.9.m9.1a"><mrow id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml"><mi id="S3.SS3.p3.9.m9.1.1.2" xref="S3.SS3.p3.9.m9.1.1.2.cmml">F</mi><mo id="S3.SS3.p3.9.m9.1.1.1" xref="S3.SS3.p3.9.m9.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p3.9.m9.1.1.3" xref="S3.SS3.p3.9.m9.1.1.3.cmml"><mi id="S3.SS3.p3.9.m9.1.1.3.2" xref="S3.SS3.p3.9.m9.1.1.3.2.cmml">C</mi><mi id="S3.SS3.p3.9.m9.1.1.3.3" xref="S3.SS3.p3.9.m9.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.1b"><apply id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1"><times id="S3.SS3.p3.9.m9.1.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1.1"></times><ci id="S3.SS3.p3.9.m9.1.1.2.cmml" xref="S3.SS3.p3.9.m9.1.1.2">𝐹</ci><apply id="S3.SS3.p3.9.m9.1.1.3.cmml" xref="S3.SS3.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.1.1.3.1.cmml" xref="S3.SS3.p3.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.9.m9.1.1.3.2.cmml" xref="S3.SS3.p3.9.m9.1.1.3.2">𝐶</ci><ci id="S3.SS3.p3.9.m9.1.1.3.3.cmml" xref="S3.SS3.p3.9.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.1c">FC_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.9.m9.1d">italic_F italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a fully-connected layer, and <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS3.p3.10.m10.1"><semantics id="S3.SS3.p3.10.m10.1a"><mi id="S3.SS3.p3.10.m10.1.1" xref="S3.SS3.p3.10.m10.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.1b"><ci id="S3.SS3.p3.10.m10.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.10.m10.1d">italic_σ</annotation></semantics></math> is the Softmax function.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.7">The final step is deriving a comprehensive intent embedding <math alttext="\mathcal{Z}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><msub id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">𝒵</mi><mi id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝒵</ci><ci id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\mathcal{Z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">caligraphic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> that encompasses all the individual prediction vectors <math alttext="p^{\text{intent}_{i}}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><msubsup id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2.2" xref="S3.SS3.p4.2.m2.1.1.2.2.cmml">p</mi><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">k</mi><msub id="S3.SS3.p4.2.m2.1.1.2.3" xref="S3.SS3.p4.2.m2.1.1.2.3.cmml"><mtext id="S3.SS3.p4.2.m2.1.1.2.3.2" xref="S3.SS3.p4.2.m2.1.1.2.3.2a.cmml">intent</mtext><mi id="S3.SS3.p4.2.m2.1.1.2.3.3" xref="S3.SS3.p4.2.m2.1.1.2.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2.2">𝑝</ci><apply id="S3.SS3.p4.2.m2.1.1.2.3.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.3.2a.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3.2"><mtext id="S3.SS3.p4.2.m2.1.1.2.3.2.cmml" mathsize="70%" xref="S3.SS3.p4.2.m2.1.1.2.3.2">intent</mtext></ci><ci id="S3.SS3.p4.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">p^{\text{intent}_{i}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">italic_p start_POSTSUPERSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. For that, all prediction vectors go through projection layers to have unified dimensionality, and they are added together using an attention layer. Attention weights are trainable and computed as follows: <math alttext="\alpha_{\text{intent}_{i}}=FC_{\text{att}}(\text{Proj}_{i}(p^{\text{intent}_{i%
}}_{k}))" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1"><semantics id="S3.SS3.p4.3.m3.1a"><mrow id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><msub id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml"><mi id="S3.SS3.p4.3.m3.1.1.3.2" xref="S3.SS3.p4.3.m3.1.1.3.2.cmml">α</mi><msub id="S3.SS3.p4.3.m3.1.1.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.cmml"><mtext id="S3.SS3.p4.3.m3.1.1.3.3.2" xref="S3.SS3.p4.3.m3.1.1.3.3.2a.cmml">intent</mtext><mi id="S3.SS3.p4.3.m3.1.1.3.3.3" xref="S3.SS3.p4.3.m3.1.1.3.3.3.cmml">i</mi></msub></msub><mo id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml">=</mo><mrow id="S3.SS3.p4.3.m3.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.cmml"><mi id="S3.SS3.p4.3.m3.1.1.1.3" xref="S3.SS3.p4.3.m3.1.1.1.3.cmml">F</mi><mo id="S3.SS3.p4.3.m3.1.1.1.2" xref="S3.SS3.p4.3.m3.1.1.1.2.cmml">⁢</mo><msub id="S3.SS3.p4.3.m3.1.1.1.4" xref="S3.SS3.p4.3.m3.1.1.1.4.cmml"><mi id="S3.SS3.p4.3.m3.1.1.1.4.2" xref="S3.SS3.p4.3.m3.1.1.1.4.2.cmml">C</mi><mtext id="S3.SS3.p4.3.m3.1.1.1.4.3" xref="S3.SS3.p4.3.m3.1.1.1.4.3a.cmml">att</mtext></msub><mo id="S3.SS3.p4.3.m3.1.1.1.2a" xref="S3.SS3.p4.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.3.m3.1.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p4.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p4.3.m3.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.cmml"><mtext id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.2" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.2a.cmml">Proj</mtext><mi id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.3" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS3.p4.3.m3.1.1.1.1.1.1.2" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><msub id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.cmml"><mtext id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.2a.cmml">intent</mtext><mi id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></msubsup><mo id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p4.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><eq id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2"></eq><apply id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.3.2">𝛼</ci><apply id="S3.SS3.p4.3.m3.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.3.3.2a.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.2"><mtext id="S3.SS3.p4.3.m3.1.1.3.3.2.cmml" mathsize="70%" xref="S3.SS3.p4.3.m3.1.1.3.3.2">intent</mtext></ci><ci id="S3.SS3.p4.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1"><times id="S3.SS3.p4.3.m3.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.1.2"></times><ci id="S3.SS3.p4.3.m3.1.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.1.3">𝐹</ci><apply id="S3.SS3.p4.3.m3.1.1.1.4.cmml" xref="S3.SS3.p4.3.m3.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.4.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.4">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.1.4.2.cmml" xref="S3.SS3.p4.3.m3.1.1.1.4.2">𝐶</ci><ci id="S3.SS3.p4.3.m3.1.1.1.4.3a.cmml" xref="S3.SS3.p4.3.m3.1.1.1.4.3"><mtext id="S3.SS3.p4.3.m3.1.1.1.4.3.cmml" mathsize="70%" xref="S3.SS3.p4.3.m3.1.1.1.4.3">att</mtext></ci></apply><apply id="S3.SS3.p4.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1"><times id="S3.SS3.p4.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.2"></times><apply id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.2a.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.2"><mtext id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.2">Proj</mtext></ci><ci id="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><apply id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.2a.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.2"><mtext id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.2.cmml" mathsize="70%" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.2">intent</mtext></ci><ci id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">\alpha_{\text{intent}_{i}}=FC_{\text{att}}(\text{Proj}_{i}(p^{\text{intent}_{i%
}}_{k}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.1d">italic_α start_POSTSUBSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT = italic_F italic_C start_POSTSUBSCRIPT att end_POSTSUBSCRIPT ( Proj start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_p start_POSTSUPERSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) )</annotation></semantics></math>, where <math alttext="\text{Proj}_{i}:\mathbb{R}^{d_{i}}\longrightarrow\mathbb{R}^{d_{\text{proj}}}" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1"><semantics id="S3.SS3.p4.4.m4.1a"><mrow id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><msub id="S3.SS3.p4.4.m4.1.1.2" xref="S3.SS3.p4.4.m4.1.1.2.cmml"><mtext id="S3.SS3.p4.4.m4.1.1.2.2" xref="S3.SS3.p4.4.m4.1.1.2.2a.cmml">Proj</mtext><mi id="S3.SS3.p4.4.m4.1.1.2.3" xref="S3.SS3.p4.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p4.4.m4.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS3.p4.4.m4.1.1.1.cmml">:</mo><mrow id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml"><msup id="S3.SS3.p4.4.m4.1.1.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.2.2" xref="S3.SS3.p4.4.m4.1.1.3.2.2.cmml">ℝ</mi><msub id="S3.SS3.p4.4.m4.1.1.3.2.3" xref="S3.SS3.p4.4.m4.1.1.3.2.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.2.3.2" xref="S3.SS3.p4.4.m4.1.1.3.2.3.2.cmml">d</mi><mi id="S3.SS3.p4.4.m4.1.1.3.2.3.3" xref="S3.SS3.p4.4.m4.1.1.3.2.3.3.cmml">i</mi></msub></msup><mo id="S3.SS3.p4.4.m4.1.1.3.1" stretchy="false" xref="S3.SS3.p4.4.m4.1.1.3.1.cmml">⟶</mo><msup id="S3.SS3.p4.4.m4.1.1.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.3.2" xref="S3.SS3.p4.4.m4.1.1.3.3.2.cmml">ℝ</mi><msub id="S3.SS3.p4.4.m4.1.1.3.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.p4.4.m4.1.1.3.3.3.2" xref="S3.SS3.p4.4.m4.1.1.3.3.3.2.cmml">d</mi><mtext id="S3.SS3.p4.4.m4.1.1.3.3.3.3" xref="S3.SS3.p4.4.m4.1.1.3.3.3.3a.cmml">proj</mtext></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><ci id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1">:</ci><apply id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.2a.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2"><mtext id="S3.SS3.p4.4.m4.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2">Proj</mtext></ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3"><ci id="S3.SS3.p4.4.m4.1.1.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.1">⟶</ci><apply id="S3.SS3.p4.4.m4.1.1.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2">superscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2.2">ℝ</ci><apply id="S3.SS3.p4.4.m4.1.1.3.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.2.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.2.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2.3.2">𝑑</ci><ci id="S3.SS3.p4.4.m4.1.1.3.2.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p4.4.m4.1.1.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3">superscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.2">ℝ</ci><apply id="S3.SS3.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p4.4.m4.1.1.3.3.3.3a.cmml" xref="S3.SS3.p4.4.m4.1.1.3.3.3.3"><mtext id="S3.SS3.p4.4.m4.1.1.3.3.3.3.cmml" mathsize="50%" xref="S3.SS3.p4.4.m4.1.1.3.3.3.3">proj</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\text{Proj}_{i}:\mathbb{R}^{d_{i}}\longrightarrow\mathbb{R}^{d_{\text{proj}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">Proj start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT : blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ⟶ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a projection layer, and <math alttext="FC_{\text{att}}\in\mathbb{R}^{d_{\text{proj}}}" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.1"><semantics id="S3.SS3.p4.5.m5.1a"><mrow id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml"><mrow id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2.2" xref="S3.SS3.p4.5.m5.1.1.2.2.cmml">F</mi><mo id="S3.SS3.p4.5.m5.1.1.2.1" xref="S3.SS3.p4.5.m5.1.1.2.1.cmml">⁢</mo><msub id="S3.SS3.p4.5.m5.1.1.2.3" xref="S3.SS3.p4.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2.3.2" xref="S3.SS3.p4.5.m5.1.1.2.3.2.cmml">C</mi><mtext id="S3.SS3.p4.5.m5.1.1.2.3.3" xref="S3.SS3.p4.5.m5.1.1.2.3.3a.cmml">att</mtext></msub></mrow><mo id="S3.SS3.p4.5.m5.1.1.1" xref="S3.SS3.p4.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.5.m5.1.1.3" xref="S3.SS3.p4.5.m5.1.1.3.cmml"><mi id="S3.SS3.p4.5.m5.1.1.3.2" xref="S3.SS3.p4.5.m5.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS3.p4.5.m5.1.1.3.3" xref="S3.SS3.p4.5.m5.1.1.3.3.cmml"><mi id="S3.SS3.p4.5.m5.1.1.3.3.2" xref="S3.SS3.p4.5.m5.1.1.3.3.2.cmml">d</mi><mtext id="S3.SS3.p4.5.m5.1.1.3.3.3" xref="S3.SS3.p4.5.m5.1.1.3.3.3a.cmml">proj</mtext></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1"><in id="S3.SS3.p4.5.m5.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1.1"></in><apply id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2"><times id="S3.SS3.p4.5.m5.1.1.2.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.1"></times><ci id="S3.SS3.p4.5.m5.1.1.2.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.2">𝐹</ci><apply id="S3.SS3.p4.5.m5.1.1.2.3.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3.2">𝐶</ci><ci id="S3.SS3.p4.5.m5.1.1.2.3.3a.cmml" xref="S3.SS3.p4.5.m5.1.1.2.3.3"><mtext id="S3.SS3.p4.5.m5.1.1.2.3.3.cmml" mathsize="70%" xref="S3.SS3.p4.5.m5.1.1.2.3.3">att</mtext></ci></apply></apply><apply id="S3.SS3.p4.5.m5.1.1.3.cmml" xref="S3.SS3.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.3.2.cmml" xref="S3.SS3.p4.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.5.m5.1.1.3.3.cmml" xref="S3.SS3.p4.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.3.3.1.cmml" xref="S3.SS3.p4.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.3.3.2.cmml" xref="S3.SS3.p4.5.m5.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p4.5.m5.1.1.3.3.3a.cmml" xref="S3.SS3.p4.5.m5.1.1.3.3.3"><mtext id="S3.SS3.p4.5.m5.1.1.3.3.3.cmml" mathsize="50%" xref="S3.SS3.p4.5.m5.1.1.3.3.3">proj</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">FC_{\text{att}}\in\mathbb{R}^{d_{\text{proj}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.1d">italic_F italic_C start_POSTSUBSCRIPT att end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a fully-connected layer.
With attention weights <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1"><semantics id="S3.SS3.p4.6.m6.1a"><mi id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><ci id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.6.m6.1d">italic_α</annotation></semantics></math>, <math alttext="\mathcal{Z}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m7.1"><semantics id="S3.SS3.p4.7.m7.1a"><msub id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.7.m7.1.1.2" xref="S3.SS3.p4.7.m7.1.1.2.cmml">𝒵</mi><mi id="S3.SS3.p4.7.m7.1.1.3" xref="S3.SS3.p4.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><apply id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.7.m7.1.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p4.7.m7.1.1.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2">𝒵</ci><ci id="S3.SS3.p4.7.m7.1.1.3.cmml" xref="S3.SS3.p4.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">\mathcal{Z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.7.m7.1d">caligraphic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is computed as follows.</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{Z}_{k}\in\mathbb{R}^{d_{\text{proj}}}=\sum_{i=1}^{M}%
\sigma(\alpha_{\text{intent}_{i}})\text{Proj}_{i}(p^{\text{intent}_{i}}_{k})" class="ltx_Math" display="inline" id="S3.E2X.2.1.1.m1.2"><semantics id="S3.E2X.2.1.1.m1.2a"><mrow id="S3.E2X.2.1.1.m1.2.2" xref="S3.E2X.2.1.1.m1.2.2.cmml"><msub id="S3.E2X.2.1.1.m1.2.2.4" xref="S3.E2X.2.1.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.2.2.4.2" xref="S3.E2X.2.1.1.m1.2.2.4.2.cmml">𝒵</mi><mi id="S3.E2X.2.1.1.m1.2.2.4.3" xref="S3.E2X.2.1.1.m1.2.2.4.3.cmml">k</mi></msub><mo id="S3.E2X.2.1.1.m1.2.2.5" xref="S3.E2X.2.1.1.m1.2.2.5.cmml">∈</mo><msup id="S3.E2X.2.1.1.m1.2.2.6" xref="S3.E2X.2.1.1.m1.2.2.6.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.6.2" xref="S3.E2X.2.1.1.m1.2.2.6.2.cmml">ℝ</mi><msub id="S3.E2X.2.1.1.m1.2.2.6.3" xref="S3.E2X.2.1.1.m1.2.2.6.3.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.6.3.2" xref="S3.E2X.2.1.1.m1.2.2.6.3.2.cmml">d</mi><mtext id="S3.E2X.2.1.1.m1.2.2.6.3.3" xref="S3.E2X.2.1.1.m1.2.2.6.3.3a.cmml">proj</mtext></msub></msup><mo id="S3.E2X.2.1.1.m1.2.2.7" xref="S3.E2X.2.1.1.m1.2.2.7.cmml">=</mo><mrow id="S3.E2X.2.1.1.m1.2.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E2X.2.1.1.m1.2.2.2.3" xref="S3.E2X.2.1.1.m1.2.2.2.3.cmml"><munderover id="S3.E2X.2.1.1.m1.2.2.2.3a" xref="S3.E2X.2.1.1.m1.2.2.2.3.cmml"><mo id="S3.E2X.2.1.1.m1.2.2.2.3.2.2" movablelimits="false" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2X.2.1.1.m1.2.2.2.3.2.3" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.2.3.2.3.2" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E2X.2.1.1.m1.2.2.2.3.2.3.1" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E2X.2.1.1.m1.2.2.2.3.2.3.3" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E2X.2.1.1.m1.2.2.2.3.3" xref="S3.E2X.2.1.1.m1.2.2.2.3.3.cmml">M</mi></munderover></mstyle><mrow id="S3.E2X.2.1.1.m1.2.2.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.2.2.4" xref="S3.E2X.2.1.1.m1.2.2.2.2.4.cmml">σ</mi><mo id="S3.E2X.2.1.1.m1.2.2.2.2.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">α</mi><msub id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mtext id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.2a.cmml">intent</mtext><mi id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2X.2.1.1.m1.2.2.2.2.3a" xref="S3.E2X.2.1.1.m1.2.2.2.2.3.cmml">⁢</mo><msub id="S3.E2X.2.1.1.m1.2.2.2.2.5" xref="S3.E2X.2.1.1.m1.2.2.2.2.5.cmml"><mtext id="S3.E2X.2.1.1.m1.2.2.2.2.5.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.5.2a.cmml">Proj</mtext><mi id="S3.E2X.2.1.1.m1.2.2.2.2.5.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.5.3.cmml">i</mi></msub><mo id="S3.E2X.2.1.1.m1.2.2.2.2.3b" xref="S3.E2X.2.1.1.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2X.2.1.1.m1.2.2.2.2.2.1" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.cmml"><mo id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.2" stretchy="false" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.cmml">(</mo><msubsup id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.2.cmml">p</mi><mi id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.3.cmml">k</mi><msub id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.cmml"><mtext id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.2a.cmml">intent</mtext><mi id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.3.cmml">i</mi></msub></msubsup><mo id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.3" stretchy="false" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.2b"><apply id="S3.E2X.2.1.1.m1.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2"><and id="S3.E2X.2.1.1.m1.2.2a.cmml" xref="S3.E2X.2.1.1.m1.2.2"></and><apply id="S3.E2X.2.1.1.m1.2.2b.cmml" xref="S3.E2X.2.1.1.m1.2.2"><in id="S3.E2X.2.1.1.m1.2.2.5.cmml" xref="S3.E2X.2.1.1.m1.2.2.5"></in><apply id="S3.E2X.2.1.1.m1.2.2.4.cmml" xref="S3.E2X.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.4.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.4">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.4.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.4.2">𝒵</ci><ci id="S3.E2X.2.1.1.m1.2.2.4.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.4.3">𝑘</ci></apply><apply id="S3.E2X.2.1.1.m1.2.2.6.cmml" xref="S3.E2X.2.1.1.m1.2.2.6"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.6.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.6">superscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.6.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.6.2">ℝ</ci><apply id="S3.E2X.2.1.1.m1.2.2.6.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.6.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.6.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.6.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.6.3.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.6.3.2">𝑑</ci><ci id="S3.E2X.2.1.1.m1.2.2.6.3.3a.cmml" xref="S3.E2X.2.1.1.m1.2.2.6.3.3"><mtext id="S3.E2X.2.1.1.m1.2.2.6.3.3.cmml" mathsize="50%" xref="S3.E2X.2.1.1.m1.2.2.6.3.3">proj</mtext></ci></apply></apply></apply><apply id="S3.E2X.2.1.1.m1.2.2c.cmml" xref="S3.E2X.2.1.1.m1.2.2"><eq id="S3.E2X.2.1.1.m1.2.2.7.cmml" xref="S3.E2X.2.1.1.m1.2.2.7"></eq><share href="https://arxiv.org/html/2408.05353v1#S3.E2X.2.1.1.m1.2.2.6.cmml" id="S3.E2X.2.1.1.m1.2.2d.cmml" xref="S3.E2X.2.1.1.m1.2.2"></share><apply id="S3.E2X.2.1.1.m1.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2"><apply id="S3.E2X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.2.2.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3">subscript</csymbol><sum id="S3.E2X.2.1.1.m1.2.2.2.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.2"></sum><apply id="S3.E2X.2.1.1.m1.2.2.2.3.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3"><eq id="S3.E2X.2.1.1.m1.2.2.2.3.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3.1"></eq><ci id="S3.E2X.2.1.1.m1.2.2.2.3.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3.2">𝑖</ci><cn id="S3.E2X.2.1.1.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="S3.E2X.2.1.1.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E2X.2.1.1.m1.2.2.2.3.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.3.3">𝑀</ci></apply><apply id="S3.E2X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2"><times id="S3.E2X.2.1.1.m1.2.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.3"></times><ci id="S3.E2X.2.1.1.m1.2.2.2.2.4.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.4">𝜎</ci><apply id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.2">𝛼</ci><apply id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.2a.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.2"><mtext id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" mathsize="70%" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.2">intent</mtext></ci><ci id="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E2X.2.1.1.m1.2.2.2.2.5.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.5.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.5">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.2.2.5.2a.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.5.2"><mtext id="S3.E2X.2.1.1.m1.2.2.2.2.5.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.5.2">Proj</mtext></ci><ci id="S3.E2X.2.1.1.m1.2.2.2.2.5.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.5.3">𝑖</ci></apply><apply id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1">subscript</csymbol><apply id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1">superscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.2">𝑝</ci><apply id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.2a.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.2"><mtext id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.2.cmml" mathsize="70%" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.2">intent</mtext></ci><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.2.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.2c">\displaystyle\mathcal{Z}_{k}\in\mathbb{R}^{d_{\text{proj}}}=\sum_{i=1}^{M}%
\sigma(\alpha_{\text{intent}_{i}})\text{Proj}_{i}(p^{\text{intent}_{i}}_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.2.1.1.m1.2d">caligraphic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT proj end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT italic_σ ( italic_α start_POSTSUBSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) Proj start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_p start_POSTSUPERSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p4.14">where <math alttext="M" class="ltx_Math" display="inline" id="S3.SS3.p4.8.m1.1"><semantics id="S3.SS3.p4.8.m1.1a"><mi id="S3.SS3.p4.8.m1.1.1" xref="S3.SS3.p4.8.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m1.1b"><ci id="S3.SS3.p4.8.m1.1.1.cmml" xref="S3.SS3.p4.8.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.8.m1.1d">italic_M</annotation></semantics></math> is the number of distinct intents we are predicting, and <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS3.p4.9.m2.1"><semantics id="S3.SS3.p4.9.m2.1a"><mi id="S3.SS3.p4.9.m2.1.1" xref="S3.SS3.p4.9.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m2.1b"><ci id="S3.SS3.p4.9.m2.1.1.cmml" xref="S3.SS3.p4.9.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.9.m2.1d">italic_σ</annotation></semantics></math> is a Softmax function across all attention weights (e.g., <math alttext="[\alpha_{\text{intent}_{1}},\ldots,\\
\alpha_{\text{intent}_{M}}]" class="ltx_Math" display="inline" id="S3.SS3.p4.10.m3.3"><semantics id="S3.SS3.p4.10.m3.3a"><mrow id="S3.SS3.p4.10.m3.3.3.2" xref="S3.SS3.p4.10.m3.3.3.3.cmml"><mo id="S3.SS3.p4.10.m3.3.3.2.3" stretchy="false" xref="S3.SS3.p4.10.m3.3.3.3.cmml">[</mo><msub id="S3.SS3.p4.10.m3.2.2.1.1" xref="S3.SS3.p4.10.m3.2.2.1.1.cmml"><mi id="S3.SS3.p4.10.m3.2.2.1.1.2" xref="S3.SS3.p4.10.m3.2.2.1.1.2.cmml">α</mi><msub id="S3.SS3.p4.10.m3.2.2.1.1.3" xref="S3.SS3.p4.10.m3.2.2.1.1.3.cmml"><mtext id="S3.SS3.p4.10.m3.2.2.1.1.3.2" xref="S3.SS3.p4.10.m3.2.2.1.1.3.2a.cmml">intent</mtext><mn id="S3.SS3.p4.10.m3.2.2.1.1.3.3" xref="S3.SS3.p4.10.m3.2.2.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.SS3.p4.10.m3.3.3.2.4" xref="S3.SS3.p4.10.m3.3.3.3.cmml">,</mo><mi id="S3.SS3.p4.10.m3.1.1" mathvariant="normal" xref="S3.SS3.p4.10.m3.1.1.cmml">…</mi><mo id="S3.SS3.p4.10.m3.3.3.2.5" xref="S3.SS3.p4.10.m3.3.3.3.cmml">,</mo><msub id="S3.SS3.p4.10.m3.3.3.2.2" xref="S3.SS3.p4.10.m3.3.3.2.2.cmml"><mi id="S3.SS3.p4.10.m3.3.3.2.2.2" xref="S3.SS3.p4.10.m3.3.3.2.2.2.cmml">α</mi><msub id="S3.SS3.p4.10.m3.3.3.2.2.3" xref="S3.SS3.p4.10.m3.3.3.2.2.3.cmml"><mtext id="S3.SS3.p4.10.m3.3.3.2.2.3.2" xref="S3.SS3.p4.10.m3.3.3.2.2.3.2a.cmml">intent</mtext><mi id="S3.SS3.p4.10.m3.3.3.2.2.3.3" xref="S3.SS3.p4.10.m3.3.3.2.2.3.3.cmml">M</mi></msub></msub><mo id="S3.SS3.p4.10.m3.3.3.2.6" stretchy="false" xref="S3.SS3.p4.10.m3.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m3.3b"><list id="S3.SS3.p4.10.m3.3.3.3.cmml" xref="S3.SS3.p4.10.m3.3.3.2"><apply id="S3.SS3.p4.10.m3.2.2.1.1.cmml" xref="S3.SS3.p4.10.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m3.2.2.1.1.1.cmml" xref="S3.SS3.p4.10.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p4.10.m3.2.2.1.1.2.cmml" xref="S3.SS3.p4.10.m3.2.2.1.1.2">𝛼</ci><apply id="S3.SS3.p4.10.m3.2.2.1.1.3.cmml" xref="S3.SS3.p4.10.m3.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m3.2.2.1.1.3.1.cmml" xref="S3.SS3.p4.10.m3.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.10.m3.2.2.1.1.3.2a.cmml" xref="S3.SS3.p4.10.m3.2.2.1.1.3.2"><mtext id="S3.SS3.p4.10.m3.2.2.1.1.3.2.cmml" mathsize="70%" xref="S3.SS3.p4.10.m3.2.2.1.1.3.2">intent</mtext></ci><cn id="S3.SS3.p4.10.m3.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p4.10.m3.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p4.10.m3.1.1.cmml" xref="S3.SS3.p4.10.m3.1.1">…</ci><apply id="S3.SS3.p4.10.m3.3.3.2.2.cmml" xref="S3.SS3.p4.10.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m3.3.3.2.2.1.cmml" xref="S3.SS3.p4.10.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p4.10.m3.3.3.2.2.2.cmml" xref="S3.SS3.p4.10.m3.3.3.2.2.2">𝛼</ci><apply id="S3.SS3.p4.10.m3.3.3.2.2.3.cmml" xref="S3.SS3.p4.10.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p4.10.m3.3.3.2.2.3.1.cmml" xref="S3.SS3.p4.10.m3.3.3.2.2.3">subscript</csymbol><ci id="S3.SS3.p4.10.m3.3.3.2.2.3.2a.cmml" xref="S3.SS3.p4.10.m3.3.3.2.2.3.2"><mtext id="S3.SS3.p4.10.m3.3.3.2.2.3.2.cmml" mathsize="70%" xref="S3.SS3.p4.10.m3.3.3.2.2.3.2">intent</mtext></ci><ci id="S3.SS3.p4.10.m3.3.3.2.2.3.3.cmml" xref="S3.SS3.p4.10.m3.3.3.2.2.3.3">𝑀</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m3.3c">[\alpha_{\text{intent}_{1}},\ldots,\\
\alpha_{\text{intent}_{M}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.10.m3.3d">[ italic_α start_POSTSUBSCRIPT intent start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , italic_α start_POSTSUBSCRIPT intent start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>).
One may argue why we should use <math alttext="\mathcal{Z}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p4.11.m4.1"><semantics id="S3.SS3.p4.11.m4.1a"><msub id="S3.SS3.p4.11.m4.1.1" xref="S3.SS3.p4.11.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.11.m4.1.1.2" xref="S3.SS3.p4.11.m4.1.1.2.cmml">𝒵</mi><mi id="S3.SS3.p4.11.m4.1.1.3" xref="S3.SS3.p4.11.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m4.1b"><apply id="S3.SS3.p4.11.m4.1.1.cmml" xref="S3.SS3.p4.11.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.11.m4.1.1.1.cmml" xref="S3.SS3.p4.11.m4.1.1">subscript</csymbol><ci id="S3.SS3.p4.11.m4.1.1.2.cmml" xref="S3.SS3.p4.11.m4.1.1.2">𝒵</ci><ci id="S3.SS3.p4.11.m4.1.1.3.cmml" xref="S3.SS3.p4.11.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m4.1c">\mathcal{Z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.11.m4.1d">caligraphic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> instead of <math alttext="E_{k}^{\text{intent}}" class="ltx_Math" display="inline" id="S3.SS3.p4.12.m5.1"><semantics id="S3.SS3.p4.12.m5.1a"><msubsup id="S3.SS3.p4.12.m5.1.1" xref="S3.SS3.p4.12.m5.1.1.cmml"><mi id="S3.SS3.p4.12.m5.1.1.2.2" xref="S3.SS3.p4.12.m5.1.1.2.2.cmml">E</mi><mi id="S3.SS3.p4.12.m5.1.1.2.3" xref="S3.SS3.p4.12.m5.1.1.2.3.cmml">k</mi><mtext id="S3.SS3.p4.12.m5.1.1.3" xref="S3.SS3.p4.12.m5.1.1.3a.cmml">intent</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m5.1b"><apply id="S3.SS3.p4.12.m5.1.1.cmml" xref="S3.SS3.p4.12.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.12.m5.1.1.1.cmml" xref="S3.SS3.p4.12.m5.1.1">superscript</csymbol><apply id="S3.SS3.p4.12.m5.1.1.2.cmml" xref="S3.SS3.p4.12.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.12.m5.1.1.2.1.cmml" xref="S3.SS3.p4.12.m5.1.1">subscript</csymbol><ci id="S3.SS3.p4.12.m5.1.1.2.2.cmml" xref="S3.SS3.p4.12.m5.1.1.2.2">𝐸</ci><ci id="S3.SS3.p4.12.m5.1.1.2.3.cmml" xref="S3.SS3.p4.12.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p4.12.m5.1.1.3a.cmml" xref="S3.SS3.p4.12.m5.1.1.3"><mtext id="S3.SS3.p4.12.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p4.12.m5.1.1.3">intent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.12.m5.1c">E_{k}^{\text{intent}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.12.m5.1d">italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT intent end_POSTSUPERSCRIPT</annotation></semantics></math> from the Transformer as the final user intent embedding. The main advantage of <math alttext="\mathcal{Z}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p4.13.m6.1"><semantics id="S3.SS3.p4.13.m6.1a"><msub id="S3.SS3.p4.13.m6.1.1" xref="S3.SS3.p4.13.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p4.13.m6.1.1.2" xref="S3.SS3.p4.13.m6.1.1.2.cmml">𝒵</mi><mi id="S3.SS3.p4.13.m6.1.1.3" xref="S3.SS3.p4.13.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.13.m6.1b"><apply id="S3.SS3.p4.13.m6.1.1.cmml" xref="S3.SS3.p4.13.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.13.m6.1.1.1.cmml" xref="S3.SS3.p4.13.m6.1.1">subscript</csymbol><ci id="S3.SS3.p4.13.m6.1.1.2.cmml" xref="S3.SS3.p4.13.m6.1.1.2">𝒵</ci><ci id="S3.SS3.p4.13.m6.1.1.3.cmml" xref="S3.SS3.p4.13.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.13.m6.1c">\mathcal{Z}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.13.m6.1d">caligraphic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> tells us the importance weight of each prediction head (e.g., action type) for each user profile, so that the model developers can know which prediction they should prioritize in the future and investigate the relations between importance weights and user attributes. However, we cannot conduct the aforementioned analyses if we simply use <math alttext="E_{k}^{\text{intent}}" class="ltx_Math" display="inline" id="S3.SS3.p4.14.m7.1"><semantics id="S3.SS3.p4.14.m7.1a"><msubsup id="S3.SS3.p4.14.m7.1.1" xref="S3.SS3.p4.14.m7.1.1.cmml"><mi id="S3.SS3.p4.14.m7.1.1.2.2" xref="S3.SS3.p4.14.m7.1.1.2.2.cmml">E</mi><mi id="S3.SS3.p4.14.m7.1.1.2.3" xref="S3.SS3.p4.14.m7.1.1.2.3.cmml">k</mi><mtext id="S3.SS3.p4.14.m7.1.1.3" xref="S3.SS3.p4.14.m7.1.1.3a.cmml">intent</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.14.m7.1b"><apply id="S3.SS3.p4.14.m7.1.1.cmml" xref="S3.SS3.p4.14.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.14.m7.1.1.1.cmml" xref="S3.SS3.p4.14.m7.1.1">superscript</csymbol><apply id="S3.SS3.p4.14.m7.1.1.2.cmml" xref="S3.SS3.p4.14.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.14.m7.1.1.2.1.cmml" xref="S3.SS3.p4.14.m7.1.1">subscript</csymbol><ci id="S3.SS3.p4.14.m7.1.1.2.2.cmml" xref="S3.SS3.p4.14.m7.1.1.2.2">𝐸</ci><ci id="S3.SS3.p4.14.m7.1.1.2.3.cmml" xref="S3.SS3.p4.14.m7.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p4.14.m7.1.1.3a.cmml" xref="S3.SS3.p4.14.m7.1.1.3"><mtext id="S3.SS3.p4.14.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p4.14.m7.1.1.3">intent</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.14.m7.1c">E_{k}^{\text{intent}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.14.m7.1d">italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT intent end_POSTSUPERSCRIPT</annotation></semantics></math> without attention weights.
The above process is illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.F4" title="In 3.3. User Intent Prediction ‣ 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="616" id="S3.F5.g1" src="extracted/5755931/figs/item_predictor.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.2.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S3.F5.3.2" style="font-size:90%;">Given an intent-aware feature sequence of a user, a next-item prediction vector for each sequence position is found by a Transformer encoder and a fully-connected layer.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Next-item Prediction and Hierarchical MTL</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.9">We perform next-item prediction using the input feature sequence and user intent embedding obtained in previous steps. First, we concatenate the input feature sequence <math alttext="\{\mathcal{F}_{1}\oplus\mathcal{S}_{1},\ldots,\mathcal{F}_{n}\oplus\mathcal{S}%
_{n}\}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.3"><semantics id="S3.SS4.p1.1.m1.3a"><mrow id="S3.SS4.p1.1.m1.3.3.2" xref="S3.SS4.p1.1.m1.3.3.3.cmml"><mo id="S3.SS4.p1.1.m1.3.3.2.3" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.3.cmml">{</mo><mrow id="S3.SS4.p1.1.m1.2.2.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.cmml"><msub id="S3.SS4.p1.1.m1.2.2.1.1.2" xref="S3.SS4.p1.1.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.2.2.1.1.2.2" xref="S3.SS4.p1.1.m1.2.2.1.1.2.2.cmml">ℱ</mi><mn id="S3.SS4.p1.1.m1.2.2.1.1.2.3" xref="S3.SS4.p1.1.m1.2.2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS4.p1.1.m1.2.2.1.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.1.cmml">⊕</mo><msub id="S3.SS4.p1.1.m1.2.2.1.1.3" xref="S3.SS4.p1.1.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.2.2.1.1.3.2" xref="S3.SS4.p1.1.m1.2.2.1.1.3.2.cmml">𝒮</mi><mn id="S3.SS4.p1.1.m1.2.2.1.1.3.3" xref="S3.SS4.p1.1.m1.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS4.p1.1.m1.3.3.2.4" xref="S3.SS4.p1.1.m1.3.3.3.cmml">,</mo><mi id="S3.SS4.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS4.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS4.p1.1.m1.3.3.2.5" xref="S3.SS4.p1.1.m1.3.3.3.cmml">,</mo><mrow id="S3.SS4.p1.1.m1.3.3.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.cmml"><msub id="S3.SS4.p1.1.m1.3.3.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.3.3.2.2.2.2" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml">ℱ</mi><mi id="S3.SS4.p1.1.m1.3.3.2.2.2.3" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S3.SS4.p1.1.m1.3.3.2.2.1" xref="S3.SS4.p1.1.m1.3.3.2.2.1.cmml">⊕</mo><msub id="S3.SS4.p1.1.m1.3.3.2.2.3" xref="S3.SS4.p1.1.m1.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.3.3.2.2.3.2" xref="S3.SS4.p1.1.m1.3.3.2.2.3.2.cmml">𝒮</mi><mi id="S3.SS4.p1.1.m1.3.3.2.2.3.3" xref="S3.SS4.p1.1.m1.3.3.2.2.3.3.cmml">n</mi></msub></mrow><mo id="S3.SS4.p1.1.m1.3.3.2.6" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.3b"><set id="S3.SS4.p1.1.m1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2"><apply id="S3.SS4.p1.1.m1.2.2.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1"><csymbol cd="latexml" id="S3.SS4.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.1">direct-sum</csymbol><apply id="S3.SS4.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.2.2">ℱ</ci><cn id="S3.SS4.p1.1.m1.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS4.p1.1.m1.2.2.1.1.2.3">1</cn></apply><apply id="S3.SS4.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.2.2.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.1.m1.2.2.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1.3.2">𝒮</ci><cn id="S3.SS4.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS4.p1.1.m1.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">…</ci><apply id="S3.SS4.p1.1.m1.3.3.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2"><csymbol cd="latexml" id="S3.SS4.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.1">direct-sum</csymbol><apply id="S3.SS4.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.2">ℱ</ci><ci id="S3.SS4.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.2.3">𝑛</ci></apply><apply id="S3.SS4.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.2.2.3.1.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.3">subscript</csymbol><ci id="S3.SS4.p1.1.m1.3.3.2.2.3.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.3.2">𝒮</ci><ci id="S3.SS4.p1.1.m1.3.3.2.2.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.2.2.3.3">𝑛</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.3c">\{\mathcal{F}_{1}\oplus\mathcal{S}_{1},\ldots,\mathcal{F}_{n}\oplus\mathcal{S}%
_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.3d">{ caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> and intent embedding sequence <math alttext="\{\mathcal{Z}_{1},\ldots,\mathcal{Z}_{n}\}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.3"><semantics id="S3.SS4.p1.2.m2.3a"><mrow id="S3.SS4.p1.2.m2.3.3.2" xref="S3.SS4.p1.2.m2.3.3.3.cmml"><mo id="S3.SS4.p1.2.m2.3.3.2.3" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.3.cmml">{</mo><msub id="S3.SS4.p1.2.m2.2.2.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.2.2.1.1.2" xref="S3.SS4.p1.2.m2.2.2.1.1.2.cmml">𝒵</mi><mn id="S3.SS4.p1.2.m2.2.2.1.1.3" xref="S3.SS4.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p1.2.m2.3.3.2.4" xref="S3.SS4.p1.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS4.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS4.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS4.p1.2.m2.3.3.2.5" xref="S3.SS4.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS4.p1.2.m2.3.3.2.2" xref="S3.SS4.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.3.3.2.2.2" xref="S3.SS4.p1.2.m2.3.3.2.2.2.cmml">𝒵</mi><mi id="S3.SS4.p1.2.m2.3.3.2.2.3" xref="S3.SS4.p1.2.m2.3.3.2.2.3.cmml">n</mi></msub><mo id="S3.SS4.p1.2.m2.3.3.2.6" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.3b"><set id="S3.SS4.p1.2.m2.3.3.3.cmml" xref="S3.SS4.p1.2.m2.3.3.2"><apply id="S3.SS4.p1.2.m2.2.2.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1.2">𝒵</ci><cn id="S3.SS4.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS4.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">…</ci><apply id="S3.SS4.p1.2.m2.3.3.2.2.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2.2">𝒵</ci><ci id="S3.SS4.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS4.p1.2.m2.3.3.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.3c">\{\mathcal{Z}_{1},\ldots,\mathcal{Z}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.3d">{ caligraphic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_Z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> for each user. Then, the intent-aware feature sequence <math alttext="\{\mathcal{F}_{1}\oplus\mathcal{S}_{1}\oplus\mathcal{Z}_{1},\ldots,\mathcal{F}%
_{n}\oplus\mathcal{S}_{n}\oplus\mathcal{Z}_{n}\}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.3"><semantics id="S3.SS4.p1.3.m3.3a"><mrow id="S3.SS4.p1.3.m3.3.3.2" xref="S3.SS4.p1.3.m3.3.3.3.cmml"><mo id="S3.SS4.p1.3.m3.3.3.2.3" stretchy="false" xref="S3.SS4.p1.3.m3.3.3.3.cmml">{</mo><mrow id="S3.SS4.p1.3.m3.2.2.1.1" xref="S3.SS4.p1.3.m3.2.2.1.1.cmml"><msub id="S3.SS4.p1.3.m3.2.2.1.1.2" xref="S3.SS4.p1.3.m3.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.2.2.1.1.2.2" xref="S3.SS4.p1.3.m3.2.2.1.1.2.2.cmml">ℱ</mi><mn id="S3.SS4.p1.3.m3.2.2.1.1.2.3" xref="S3.SS4.p1.3.m3.2.2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS4.p1.3.m3.2.2.1.1.1" xref="S3.SS4.p1.3.m3.2.2.1.1.1.cmml">⊕</mo><msub id="S3.SS4.p1.3.m3.2.2.1.1.3" xref="S3.SS4.p1.3.m3.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.2.2.1.1.3.2" xref="S3.SS4.p1.3.m3.2.2.1.1.3.2.cmml">𝒮</mi><mn id="S3.SS4.p1.3.m3.2.2.1.1.3.3" xref="S3.SS4.p1.3.m3.2.2.1.1.3.3.cmml">1</mn></msub><mo id="S3.SS4.p1.3.m3.2.2.1.1.1a" xref="S3.SS4.p1.3.m3.2.2.1.1.1.cmml">⊕</mo><msub id="S3.SS4.p1.3.m3.2.2.1.1.4" xref="S3.SS4.p1.3.m3.2.2.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.2.2.1.1.4.2" xref="S3.SS4.p1.3.m3.2.2.1.1.4.2.cmml">𝒵</mi><mn id="S3.SS4.p1.3.m3.2.2.1.1.4.3" xref="S3.SS4.p1.3.m3.2.2.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.SS4.p1.3.m3.3.3.2.4" xref="S3.SS4.p1.3.m3.3.3.3.cmml">,</mo><mi id="S3.SS4.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS4.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS4.p1.3.m3.3.3.2.5" xref="S3.SS4.p1.3.m3.3.3.3.cmml">,</mo><mrow id="S3.SS4.p1.3.m3.3.3.2.2" xref="S3.SS4.p1.3.m3.3.3.2.2.cmml"><msub id="S3.SS4.p1.3.m3.3.3.2.2.2" xref="S3.SS4.p1.3.m3.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.3.3.2.2.2.2" xref="S3.SS4.p1.3.m3.3.3.2.2.2.2.cmml">ℱ</mi><mi id="S3.SS4.p1.3.m3.3.3.2.2.2.3" xref="S3.SS4.p1.3.m3.3.3.2.2.2.3.cmml">n</mi></msub><mo id="S3.SS4.p1.3.m3.3.3.2.2.1" xref="S3.SS4.p1.3.m3.3.3.2.2.1.cmml">⊕</mo><msub id="S3.SS4.p1.3.m3.3.3.2.2.3" xref="S3.SS4.p1.3.m3.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.3.3.2.2.3.2" xref="S3.SS4.p1.3.m3.3.3.2.2.3.2.cmml">𝒮</mi><mi id="S3.SS4.p1.3.m3.3.3.2.2.3.3" xref="S3.SS4.p1.3.m3.3.3.2.2.3.3.cmml">n</mi></msub><mo id="S3.SS4.p1.3.m3.3.3.2.2.1a" xref="S3.SS4.p1.3.m3.3.3.2.2.1.cmml">⊕</mo><msub id="S3.SS4.p1.3.m3.3.3.2.2.4" xref="S3.SS4.p1.3.m3.3.3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.3.3.2.2.4.2" xref="S3.SS4.p1.3.m3.3.3.2.2.4.2.cmml">𝒵</mi><mi id="S3.SS4.p1.3.m3.3.3.2.2.4.3" xref="S3.SS4.p1.3.m3.3.3.2.2.4.3.cmml">n</mi></msub></mrow><mo id="S3.SS4.p1.3.m3.3.3.2.6" stretchy="false" xref="S3.SS4.p1.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.3b"><set id="S3.SS4.p1.3.m3.3.3.3.cmml" xref="S3.SS4.p1.3.m3.3.3.2"><apply id="S3.SS4.p1.3.m3.2.2.1.1.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1"><csymbol cd="latexml" id="S3.SS4.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.1">direct-sum</csymbol><apply id="S3.SS4.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.2.2">ℱ</ci><cn id="S3.SS4.p1.3.m3.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS4.p1.3.m3.2.2.1.1.2.3">1</cn></apply><apply id="S3.SS4.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.2.2.1.1.3.1.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.3.m3.2.2.1.1.3.2.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.3.2">𝒮</ci><cn id="S3.SS4.p1.3.m3.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS4.p1.3.m3.2.2.1.1.3.3">1</cn></apply><apply id="S3.SS4.p1.3.m3.2.2.1.1.4.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.2.2.1.1.4.1.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.4">subscript</csymbol><ci id="S3.SS4.p1.3.m3.2.2.1.1.4.2.cmml" xref="S3.SS4.p1.3.m3.2.2.1.1.4.2">𝒵</ci><cn id="S3.SS4.p1.3.m3.2.2.1.1.4.3.cmml" type="integer" xref="S3.SS4.p1.3.m3.2.2.1.1.4.3">1</cn></apply></apply><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">…</ci><apply id="S3.SS4.p1.3.m3.3.3.2.2.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2"><csymbol cd="latexml" id="S3.SS4.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.1">direct-sum</csymbol><apply id="S3.SS4.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.2.2">ℱ</ci><ci id="S3.SS4.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.2.3">𝑛</ci></apply><apply id="S3.SS4.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.3.3.2.2.3.1.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.3">subscript</csymbol><ci id="S3.SS4.p1.3.m3.3.3.2.2.3.2.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.3.2">𝒮</ci><ci id="S3.SS4.p1.3.m3.3.3.2.2.3.3.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.3.3">𝑛</ci></apply><apply id="S3.SS4.p1.3.m3.3.3.2.2.4.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.3.3.2.2.4.1.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.4">subscript</csymbol><ci id="S3.SS4.p1.3.m3.3.3.2.2.4.2.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.4.2">𝒵</ci><ci id="S3.SS4.p1.3.m3.3.3.2.2.4.3.cmml" xref="S3.SS4.p1.3.m3.3.3.2.2.4.3">𝑛</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.3c">\{\mathcal{F}_{1}\oplus\mathcal{S}_{1}\oplus\mathcal{Z}_{1},\ldots,\mathcal{F}%
_{n}\oplus\mathcal{S}_{n}\oplus\mathcal{Z}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.3d">{ caligraphic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊕ caligraphic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , caligraphic_F start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ⊕ caligraphic_S start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ⊕ caligraphic_Z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> again goes through the FC and normalization layer, and the output is fed to another Transformer encoder optimized for next-item prediction, whose architecture is similar to the intent encoder.
Note that all Transformers used in the paper use timestamp embeddings as positional encoding.
For instance, given each position <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">italic_k</annotation></semantics></math> in the sequence, the encoder produces an optimized representation <math alttext="E_{k}^{\text{item}}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><msubsup id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2.2" xref="S3.SS4.p1.5.m5.1.1.2.2.cmml">E</mi><mi id="S3.SS4.p1.5.m5.1.1.2.3" xref="S3.SS4.p1.5.m5.1.1.2.3.cmml">k</mi><mtext id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3a.cmml">item</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.2.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2.2">𝐸</ci><ci id="S3.SS4.p1.5.m5.1.1.2.3.cmml" xref="S3.SS4.p1.5.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.5.m5.1.1.3a.cmml" xref="S3.SS4.p1.5.m5.1.1.3"><mtext id="S3.SS4.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p1.5.m5.1.1.3">item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">E_{k}^{\text{item}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT item end_POSTSUPERSCRIPT</annotation></semantics></math> for next-item prediction.
The next-item prediction score vector <math alttext="p^{\text{item}}_{k}\in\mathbb{R}^{d_{|\mathcal{I}|}}=\sigma(FC_{\text{item}}(E%
_{k}^{\text{item}}))" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m6.2"><semantics id="S3.SS4.p1.6.m6.2a"><mrow id="S3.SS4.p1.6.m6.2.2" xref="S3.SS4.p1.6.m6.2.2.cmml"><msubsup id="S3.SS4.p1.6.m6.2.2.3" xref="S3.SS4.p1.6.m6.2.2.3.cmml"><mi id="S3.SS4.p1.6.m6.2.2.3.2.2" xref="S3.SS4.p1.6.m6.2.2.3.2.2.cmml">p</mi><mi id="S3.SS4.p1.6.m6.2.2.3.3" xref="S3.SS4.p1.6.m6.2.2.3.3.cmml">k</mi><mtext id="S3.SS4.p1.6.m6.2.2.3.2.3" xref="S3.SS4.p1.6.m6.2.2.3.2.3a.cmml">item</mtext></msubsup><mo id="S3.SS4.p1.6.m6.2.2.4" xref="S3.SS4.p1.6.m6.2.2.4.cmml">∈</mo><msup id="S3.SS4.p1.6.m6.2.2.5" xref="S3.SS4.p1.6.m6.2.2.5.cmml"><mi id="S3.SS4.p1.6.m6.2.2.5.2" xref="S3.SS4.p1.6.m6.2.2.5.2.cmml">ℝ</mi><msub id="S3.SS4.p1.6.m6.1.1.1" xref="S3.SS4.p1.6.m6.1.1.1.cmml"><mi id="S3.SS4.p1.6.m6.1.1.1.3" xref="S3.SS4.p1.6.m6.1.1.1.3.cmml">d</mi><mrow id="S3.SS4.p1.6.m6.1.1.1.1.1.3" xref="S3.SS4.p1.6.m6.1.1.1.1.1.2.cmml"><mo id="S3.SS4.p1.6.m6.1.1.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.6.m6.1.1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.6.m6.1.1.1.1.1.1" xref="S3.SS4.p1.6.m6.1.1.1.1.1.1.cmml">ℐ</mi><mo id="S3.SS4.p1.6.m6.1.1.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.6.m6.1.1.1.1.1.2.1.cmml">|</mo></mrow></msub></msup><mo id="S3.SS4.p1.6.m6.2.2.6" xref="S3.SS4.p1.6.m6.2.2.6.cmml">=</mo><mrow id="S3.SS4.p1.6.m6.2.2.1" xref="S3.SS4.p1.6.m6.2.2.1.cmml"><mi id="S3.SS4.p1.6.m6.2.2.1.3" xref="S3.SS4.p1.6.m6.2.2.1.3.cmml">σ</mi><mo id="S3.SS4.p1.6.m6.2.2.1.2" xref="S3.SS4.p1.6.m6.2.2.1.2.cmml">⁢</mo><mrow id="S3.SS4.p1.6.m6.2.2.1.1.1" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.cmml"><mo id="S3.SS4.p1.6.m6.2.2.1.1.1.2" stretchy="false" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.6.m6.2.2.1.1.1.1" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.cmml"><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.cmml">F</mi><mo id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.cmml">⁢</mo><msub id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.cmml"><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.2" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.2.cmml">C</mi><mtext id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.3a.cmml">item</mtext></msub><mo id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2a" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.3.cmml">k</mi><mtext id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.3" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.3a.cmml">item</mtext></msubsup><mo id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p1.6.m6.2.2.1.1.1.3" stretchy="false" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.2b"><apply id="S3.SS4.p1.6.m6.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2"><and id="S3.SS4.p1.6.m6.2.2a.cmml" xref="S3.SS4.p1.6.m6.2.2"></and><apply id="S3.SS4.p1.6.m6.2.2b.cmml" xref="S3.SS4.p1.6.m6.2.2"><in id="S3.SS4.p1.6.m6.2.2.4.cmml" xref="S3.SS4.p1.6.m6.2.2.4"></in><apply id="S3.SS4.p1.6.m6.2.2.3.cmml" xref="S3.SS4.p1.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.3.1.cmml" xref="S3.SS4.p1.6.m6.2.2.3">subscript</csymbol><apply id="S3.SS4.p1.6.m6.2.2.3.2.cmml" xref="S3.SS4.p1.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.3.2.1.cmml" xref="S3.SS4.p1.6.m6.2.2.3">superscript</csymbol><ci id="S3.SS4.p1.6.m6.2.2.3.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2.3.2.2">𝑝</ci><ci id="S3.SS4.p1.6.m6.2.2.3.2.3a.cmml" xref="S3.SS4.p1.6.m6.2.2.3.2.3"><mtext id="S3.SS4.p1.6.m6.2.2.3.2.3.cmml" mathsize="70%" xref="S3.SS4.p1.6.m6.2.2.3.2.3">item</mtext></ci></apply><ci id="S3.SS4.p1.6.m6.2.2.3.3.cmml" xref="S3.SS4.p1.6.m6.2.2.3.3">𝑘</ci></apply><apply id="S3.SS4.p1.6.m6.2.2.5.cmml" xref="S3.SS4.p1.6.m6.2.2.5"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.5.1.cmml" xref="S3.SS4.p1.6.m6.2.2.5">superscript</csymbol><ci id="S3.SS4.p1.6.m6.2.2.5.2.cmml" xref="S3.SS4.p1.6.m6.2.2.5.2">ℝ</ci><apply id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.1.3">𝑑</ci><apply id="S3.SS4.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1.1.1.1.3"><abs id="S3.SS4.p1.6.m6.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1.1.1.3.1"></abs><ci id="S3.SS4.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1.1.1.1">ℐ</ci></apply></apply></apply></apply><apply id="S3.SS4.p1.6.m6.2.2c.cmml" xref="S3.SS4.p1.6.m6.2.2"><eq id="S3.SS4.p1.6.m6.2.2.6.cmml" xref="S3.SS4.p1.6.m6.2.2.6"></eq><share href="https://arxiv.org/html/2408.05353v1#S3.SS4.p1.6.m6.2.2.5.cmml" id="S3.SS4.p1.6.m6.2.2d.cmml" xref="S3.SS4.p1.6.m6.2.2"></share><apply id="S3.SS4.p1.6.m6.2.2.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1"><times id="S3.SS4.p1.6.m6.2.2.1.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.2"></times><ci id="S3.SS4.p1.6.m6.2.2.1.3.cmml" xref="S3.SS4.p1.6.m6.2.2.1.3">𝜎</ci><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1"><times id="S3.SS4.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.2"></times><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.3">𝐹</ci><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.2">𝐶</ci><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.3a.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.3"><mtext id="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.3.cmml" mathsize="70%" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.4.3">item</mtext></ci></apply><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.3"><mtext id="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p1.6.m6.2.2.1.1.1.1.1.1.1.3">item</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.2c">p^{\text{item}}_{k}\in\mathbb{R}^{d_{|\mathcal{I}|}}=\sigma(FC_{\text{item}}(E%
_{k}^{\text{item}}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m6.2d">italic_p start_POSTSUPERSCRIPT item end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT | caligraphic_I | end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = italic_σ ( italic_F italic_C start_POSTSUBSCRIPT item end_POSTSUBSCRIPT ( italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT item end_POSTSUPERSCRIPT ) )</annotation></semantics></math> for a position <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m7.1"><semantics id="S3.SS4.p1.7.m7.1a"><mi id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><ci id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m7.1d">italic_k</annotation></semantics></math> of a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS4.p1.8.m8.1"><semantics id="S3.SS4.p1.8.m8.1a"><mi id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.8.m8.1d">italic_u</annotation></semantics></math> is calculated by feeding the Transformer encoding <math alttext="E_{k}^{\text{item}}" class="ltx_Math" display="inline" id="S3.SS4.p1.9.m9.1"><semantics id="S3.SS4.p1.9.m9.1a"><msubsup id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2.2" xref="S3.SS4.p1.9.m9.1.1.2.2.cmml">E</mi><mi id="S3.SS4.p1.9.m9.1.1.2.3" xref="S3.SS4.p1.9.m9.1.1.2.3.cmml">k</mi><mtext id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3a.cmml">item</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">superscript</csymbol><apply id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.2.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2.2">𝐸</ci><ci id="S3.SS4.p1.9.m9.1.1.2.3.cmml" xref="S3.SS4.p1.9.m9.1.1.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.9.m9.1.1.3a.cmml" xref="S3.SS4.p1.9.m9.1.1.3"><mtext id="S3.SS4.p1.9.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p1.9.m9.1.1.3">item</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">E_{k}^{\text{item}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.9.m9.1d">italic_E start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT item end_POSTSUPERSCRIPT</annotation></semantics></math> to a fully-connected layer.
<a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.F5" title="In 3.3. User Intent Prediction ‣ 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> describes this next-item prediction process. Notably, we found separate Transformer encoders for intent and item predictions empirically outperform the shared Transformer architecture between prediction tasks.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.2">Regarding the overall training procedure of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.1">IntentRec</span>, it utilizes a hierarchical multi-task learning paradigm where losses of multiple prediction tasks are jointly optimized, and there are hierarchical relationships between these prediction tasks <cite class="ltx_cite ltx_citemacro_citep">(Sanh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib41" title="">2019</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib53" title="">2021</a>; Tian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib49" title="">2019</a>; Park et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib39" title="">2019</a>)</cite>. In this hierarchy, the main prediction task exploits the outputs from other auxiliary tasks as input features. In our case, we have several user intent prediction tasks as well as the next-item prediction. Between the prediction tasks, intent predictions are conducted first, and the item-ID prediction comes at the end. We note that the next-item prediction is not solely dependent on intent predictions, due to the presence of other input features (<math alttext="\mathcal{F}_{k}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msub id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">ℱ</ci><ci id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathcal{F}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">𝒮</mi><mi id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">𝒮</ci><ci id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>), and it indicates that the next-item recommendation accuracy will not be heavily affected by the inaccurate intent predictions.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.4">The loss function of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.4.1">IntentRec</span> is summed over all training mini-batches of users and all positions in a user interaction sequence.
For each position <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_k</annotation></semantics></math> in a user profile, our goal is to predict the next intent (e.g., <math alttext="\text{intent}_{k+1}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><msub id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><mtext id="S3.SS4.p3.2.m2.1.1.2" xref="S3.SS4.p3.2.m2.1.1.2a.cmml">intent</mtext><mrow id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml"><mi id="S3.SS4.p3.2.m2.1.1.3.2" xref="S3.SS4.p3.2.m2.1.1.3.2.cmml">k</mi><mo id="S3.SS4.p3.2.m2.1.1.3.1" xref="S3.SS4.p3.2.m2.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p3.2.m2.1.1.3.3" xref="S3.SS4.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.2a.cmml" xref="S3.SS4.p3.2.m2.1.1.2"><mtext id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2">intent</mtext></ci><apply id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3"><plus id="S3.SS4.p3.2.m2.1.1.3.1.cmml" xref="S3.SS4.p3.2.m2.1.1.3.1"></plus><ci id="S3.SS4.p3.2.m2.1.1.3.2.cmml" xref="S3.SS4.p3.2.m2.1.1.3.2">𝑘</ci><cn id="S3.SS4.p3.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS4.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\text{intent}_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">intent start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math>) and next item (e.g., <math alttext="i_{k+1}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><msub id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2" xref="S3.SS4.p3.3.m3.1.1.2.cmml">i</mi><mrow id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml"><mi id="S3.SS4.p3.3.m3.1.1.3.2" xref="S3.SS4.p3.3.m3.1.1.3.2.cmml">k</mi><mo id="S3.SS4.p3.3.m3.1.1.3.1" xref="S3.SS4.p3.3.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p3.3.m3.1.1.3.3" xref="S3.SS4.p3.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2">𝑖</ci><apply id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3"><plus id="S3.SS4.p3.3.m3.1.1.3.1.cmml" xref="S3.SS4.p3.3.m3.1.1.3.1"></plus><ci id="S3.SS4.p3.3.m3.1.1.3.2.cmml" xref="S3.SS4.p3.3.m3.1.1.3.2">𝑘</ci><cn id="S3.SS4.p3.3.m3.1.1.3.3.cmml" type="integer" xref="S3.SS4.p3.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">i_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">italic_i start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math>) precisely.
In addition, each interaction has different weights proportional to their duration during the training; we prioritize interactions with long duration since they have higher business values.
For example, given the current mini-batch <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">\mathcal{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">caligraphic_B</annotation></semantics></math>, we use the following weighted Cross-Entropy loss for next-item prediction.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{item}}=-\sum_{u\in\mathcal{B}}\sum_{k=1}^{n}d_{k}\sum_{i=1}%
^{|\mathcal{I}|}y^{\mathcal{I}}_{k}[i]\cdot\log(p^{\text{item}}_{k}[i])," class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.3" xref="S3.E3.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.3.2" xref="S3.E3.m1.5.5.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E3.m1.5.5.1.1.3.3" xref="S3.E3.m1.5.5.1.1.3.3a.cmml">item</mtext></msub><mo id="S3.E3.m1.5.5.1.1.2" xref="S3.E3.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.1.cmml"><mo id="S3.E3.m1.5.5.1.1.1a" xref="S3.E3.m1.5.5.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.5.5.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.cmml"><munder id="S3.E3.m1.5.5.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.5.5.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.2.3.2" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2.cmml">u</mi><mo id="S3.E3.m1.5.5.1.1.1.1.2.3.1" xref="S3.E3.m1.5.5.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.1.1.2.3.3" xref="S3.E3.m1.5.5.1.1.1.1.2.3.3.cmml">ℬ</mi></mrow></munder><mrow id="S3.E3.m1.5.5.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.cmml"><munderover id="S3.E3.m1.5.5.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.1" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.5.5.1.1.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.cmml"><munderover id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">ℐ</mi><mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2.cmml">y</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.3.cmml">ℐ</mi></msubsup><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.1.1.cmml">[</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">i</mi><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.2" rspace="0.055em" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">log</mi><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1a" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mtext id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3a.cmml">item</mtext></msubsup><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml">[</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">i</mi><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1"><eq id="S3.E3.m1.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2"></eq><apply id="S3.E3.m1.5.5.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.3.2">ℒ</ci><ci id="S3.E3.m1.5.5.1.1.3.3a.cmml" xref="S3.E3.m1.5.5.1.1.3.3"><mtext id="S3.E3.m1.5.5.1.1.3.3.cmml" mathsize="70%" xref="S3.E3.m1.5.5.1.1.3.3">item</mtext></ci></apply><apply id="S3.E3.m1.5.5.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1"><minus id="S3.E3.m1.5.5.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1"></minus><apply id="S3.E3.m1.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1"><apply id="S3.E3.m1.5.5.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.2"></sum><apply id="S3.E3.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3"><in id="S3.E3.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.1"></in><ci id="S3.E3.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2">𝑢</ci><ci id="S3.E3.m1.5.5.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.3">ℬ</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1"><apply id="S3.E3.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.2"></sum><apply id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3"><eq id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.2">𝑘</ci><cn id="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1"><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.3"><abs id="S3.E3.m1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.3.1"></abs><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">ℐ</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1"><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.2">𝑦</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.3">ℐ</ci></apply><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑖</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1"><log id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"></log><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑝</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3a.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3"><mtext id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">item</mtext></ci></apply><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1">delimited-[]</csymbol><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\mathcal{L}_{\text{item}}=-\sum_{u\in\mathcal{B}}\sum_{k=1}^{n}d_{k}\sum_{i=1}%
^{|\mathcal{I}|}y^{\mathcal{I}}_{k}[i]\cdot\log(p^{\text{item}}_{k}[i]),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">caligraphic_L start_POSTSUBSCRIPT item end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_B end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_I | end_POSTSUPERSCRIPT italic_y start_POSTSUPERSCRIPT caligraphic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT [ italic_i ] ⋅ roman_log ( italic_p start_POSTSUPERSCRIPT item end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT [ italic_i ] ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.13">where <math alttext="d_{k}" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m1.1"><semantics id="S3.SS4.p3.5.m1.1a"><msub id="S3.SS4.p3.5.m1.1.1" xref="S3.SS4.p3.5.m1.1.1.cmml"><mi id="S3.SS4.p3.5.m1.1.1.2" xref="S3.SS4.p3.5.m1.1.1.2.cmml">d</mi><mi id="S3.SS4.p3.5.m1.1.1.3" xref="S3.SS4.p3.5.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m1.1b"><apply id="S3.SS4.p3.5.m1.1.1.cmml" xref="S3.SS4.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m1.1.1.1.cmml" xref="S3.SS4.p3.5.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.5.m1.1.1.2.cmml" xref="S3.SS4.p3.5.m1.1.1.2">𝑑</ci><ci id="S3.SS4.p3.5.m1.1.1.3.cmml" xref="S3.SS4.p3.5.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m1.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m1.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the duration weight of the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m2.1"><semantics id="S3.SS4.p3.6.m2.1a"><mi id="S3.SS4.p3.6.m2.1.1" xref="S3.SS4.p3.6.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m2.1b"><ci id="S3.SS4.p3.6.m2.1.1.cmml" xref="S3.SS4.p3.6.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.6.m2.1d">italic_k</annotation></semantics></math>-th interaction of a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS4.p3.7.m3.1"><semantics id="S3.SS4.p3.7.m3.1a"><mi id="S3.SS4.p3.7.m3.1.1" xref="S3.SS4.p3.7.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m3.1b"><ci id="S3.SS4.p3.7.m3.1.1.cmml" xref="S3.SS4.p3.7.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.7.m3.1d">italic_u</annotation></semantics></math>, and <math alttext="y^{\mathcal{I}}_{k}" class="ltx_Math" display="inline" id="S3.SS4.p3.8.m4.1"><semantics id="S3.SS4.p3.8.m4.1a"><msubsup id="S3.SS4.p3.8.m4.1.1" xref="S3.SS4.p3.8.m4.1.1.cmml"><mi id="S3.SS4.p3.8.m4.1.1.2.2" xref="S3.SS4.p3.8.m4.1.1.2.2.cmml">y</mi><mi id="S3.SS4.p3.8.m4.1.1.3" xref="S3.SS4.p3.8.m4.1.1.3.cmml">k</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.8.m4.1.1.2.3" xref="S3.SS4.p3.8.m4.1.1.2.3.cmml">ℐ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.8.m4.1b"><apply id="S3.SS4.p3.8.m4.1.1.cmml" xref="S3.SS4.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m4.1.1.1.cmml" xref="S3.SS4.p3.8.m4.1.1">subscript</csymbol><apply id="S3.SS4.p3.8.m4.1.1.2.cmml" xref="S3.SS4.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m4.1.1.2.1.cmml" xref="S3.SS4.p3.8.m4.1.1">superscript</csymbol><ci id="S3.SS4.p3.8.m4.1.1.2.2.cmml" xref="S3.SS4.p3.8.m4.1.1.2.2">𝑦</ci><ci id="S3.SS4.p3.8.m4.1.1.2.3.cmml" xref="S3.SS4.p3.8.m4.1.1.2.3">ℐ</ci></apply><ci id="S3.SS4.p3.8.m4.1.1.3.cmml" xref="S3.SS4.p3.8.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.8.m4.1c">y^{\mathcal{I}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.8.m4.1d">italic_y start_POSTSUPERSCRIPT caligraphic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a one-hot vector indicating the ground-truth next item <math alttext="i_{k+1}" class="ltx_Math" display="inline" id="S3.SS4.p3.9.m5.1"><semantics id="S3.SS4.p3.9.m5.1a"><msub id="S3.SS4.p3.9.m5.1.1" xref="S3.SS4.p3.9.m5.1.1.cmml"><mi id="S3.SS4.p3.9.m5.1.1.2" xref="S3.SS4.p3.9.m5.1.1.2.cmml">i</mi><mrow id="S3.SS4.p3.9.m5.1.1.3" xref="S3.SS4.p3.9.m5.1.1.3.cmml"><mi id="S3.SS4.p3.9.m5.1.1.3.2" xref="S3.SS4.p3.9.m5.1.1.3.2.cmml">k</mi><mo id="S3.SS4.p3.9.m5.1.1.3.1" xref="S3.SS4.p3.9.m5.1.1.3.1.cmml">+</mo><mn id="S3.SS4.p3.9.m5.1.1.3.3" xref="S3.SS4.p3.9.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.9.m5.1b"><apply id="S3.SS4.p3.9.m5.1.1.cmml" xref="S3.SS4.p3.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.9.m5.1.1.1.cmml" xref="S3.SS4.p3.9.m5.1.1">subscript</csymbol><ci id="S3.SS4.p3.9.m5.1.1.2.cmml" xref="S3.SS4.p3.9.m5.1.1.2">𝑖</ci><apply id="S3.SS4.p3.9.m5.1.1.3.cmml" xref="S3.SS4.p3.9.m5.1.1.3"><plus id="S3.SS4.p3.9.m5.1.1.3.1.cmml" xref="S3.SS4.p3.9.m5.1.1.3.1"></plus><ci id="S3.SS4.p3.9.m5.1.1.3.2.cmml" xref="S3.SS4.p3.9.m5.1.1.3.2">𝑘</ci><cn id="S3.SS4.p3.9.m5.1.1.3.3.cmml" type="integer" xref="S3.SS4.p3.9.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.9.m5.1c">i_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.9.m5.1d">italic_i start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="x[i]" class="ltx_Math" display="inline" id="S3.SS4.p3.10.m6.1"><semantics id="S3.SS4.p3.10.m6.1a"><mrow id="S3.SS4.p3.10.m6.1.2" xref="S3.SS4.p3.10.m6.1.2.cmml"><mi id="S3.SS4.p3.10.m6.1.2.2" xref="S3.SS4.p3.10.m6.1.2.2.cmml">x</mi><mo id="S3.SS4.p3.10.m6.1.2.1" xref="S3.SS4.p3.10.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p3.10.m6.1.2.3.2" xref="S3.SS4.p3.10.m6.1.2.3.1.cmml"><mo id="S3.SS4.p3.10.m6.1.2.3.2.1" stretchy="false" xref="S3.SS4.p3.10.m6.1.2.3.1.1.cmml">[</mo><mi id="S3.SS4.p3.10.m6.1.1" xref="S3.SS4.p3.10.m6.1.1.cmml">i</mi><mo id="S3.SS4.p3.10.m6.1.2.3.2.2" stretchy="false" xref="S3.SS4.p3.10.m6.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.10.m6.1b"><apply id="S3.SS4.p3.10.m6.1.2.cmml" xref="S3.SS4.p3.10.m6.1.2"><times id="S3.SS4.p3.10.m6.1.2.1.cmml" xref="S3.SS4.p3.10.m6.1.2.1"></times><ci id="S3.SS4.p3.10.m6.1.2.2.cmml" xref="S3.SS4.p3.10.m6.1.2.2">𝑥</ci><apply id="S3.SS4.p3.10.m6.1.2.3.1.cmml" xref="S3.SS4.p3.10.m6.1.2.3.2"><csymbol cd="latexml" id="S3.SS4.p3.10.m6.1.2.3.1.1.cmml" xref="S3.SS4.p3.10.m6.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS4.p3.10.m6.1.1.cmml" xref="S3.SS4.p3.10.m6.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.10.m6.1c">x[i]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.10.m6.1d">italic_x [ italic_i ]</annotation></semantics></math> means the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.p3.11.m7.1"><semantics id="S3.SS4.p3.11.m7.1a"><mi id="S3.SS4.p3.11.m7.1.1" xref="S3.SS4.p3.11.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.11.m7.1b"><ci id="S3.SS4.p3.11.m7.1.1.cmml" xref="S3.SS4.p3.11.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.11.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.11.m7.1d">italic_i</annotation></semantics></math>-th element of a vector <math alttext="x" class="ltx_Math" display="inline" id="S3.SS4.p3.12.m8.1"><semantics id="S3.SS4.p3.12.m8.1a"><mi id="S3.SS4.p3.12.m8.1.1" xref="S3.SS4.p3.12.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.12.m8.1b"><ci id="S3.SS4.p3.12.m8.1.1.cmml" xref="S3.SS4.p3.12.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.12.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.12.m8.1d">italic_x</annotation></semantics></math>.
Intent prediction losses such as <math alttext="\mathcal{L}_{\text{intent}_{i}}" class="ltx_Math" display="inline" id="S3.SS4.p3.13.m9.1"><semantics id="S3.SS4.p3.13.m9.1a"><msub id="S3.SS4.p3.13.m9.1.1" xref="S3.SS4.p3.13.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.13.m9.1.1.2" xref="S3.SS4.p3.13.m9.1.1.2.cmml">ℒ</mi><msub id="S3.SS4.p3.13.m9.1.1.3" xref="S3.SS4.p3.13.m9.1.1.3.cmml"><mtext id="S3.SS4.p3.13.m9.1.1.3.2" xref="S3.SS4.p3.13.m9.1.1.3.2a.cmml">intent</mtext><mi id="S3.SS4.p3.13.m9.1.1.3.3" xref="S3.SS4.p3.13.m9.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.13.m9.1b"><apply id="S3.SS4.p3.13.m9.1.1.cmml" xref="S3.SS4.p3.13.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.13.m9.1.1.1.cmml" xref="S3.SS4.p3.13.m9.1.1">subscript</csymbol><ci id="S3.SS4.p3.13.m9.1.1.2.cmml" xref="S3.SS4.p3.13.m9.1.1.2">ℒ</ci><apply id="S3.SS4.p3.13.m9.1.1.3.cmml" xref="S3.SS4.p3.13.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.13.m9.1.1.3.1.cmml" xref="S3.SS4.p3.13.m9.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.13.m9.1.1.3.2a.cmml" xref="S3.SS4.p3.13.m9.1.1.3.2"><mtext id="S3.SS4.p3.13.m9.1.1.3.2.cmml" mathsize="70%" xref="S3.SS4.p3.13.m9.1.1.3.2">intent</mtext></ci><ci id="S3.SS4.p3.13.m9.1.1.3.3.cmml" xref="S3.SS4.p3.13.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.13.m9.1c">\mathcal{L}_{\text{intent}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.13.m9.1d">caligraphic_L start_POSTSUBSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are defined similarly to <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.E3" title="In 3.4. Next-item Prediction and Hierarchical MTL ‣ 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">3</span></a>. If the intent prediction can have multiple ground-truth labels (e.g., an intent = “romance” + “comedy”), we modify the loss <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.E3" title="In 3.4. Next-item Prediction and Hierarchical MTL ‣ 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">3</span></a> to Binary Cross-Entropy where all the ground-truth labels become positive labels. Note that we do not utilize negative labels for Binary Cross-Entropy.
The complete loss function of <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.13.1">IntentRec</span> is defined below.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\textsc{IntentRec}}=\mathcal{L}_{\text{item}}+\lambda\sum_{i=1}^{%
M}\mathcal{L}_{\text{intent}_{i}}," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml">ℒ</mi><mtext class="ltx_font_smallcaps" id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3a.cmml">IntentRec</mtext></msub><mo id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.1.3.2.3a.cmml">item</mtext></msub><mo id="S3.E4.m1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.3.3.2.cmml">λ</mi><mo id="S3.E4.m1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.3.3.3.cmml"><munderover id="S3.E4.m1.1.1.1.1.3.3.3.1" xref="S3.E4.m1.1.1.1.1.3.3.3.1.cmml"><mo id="S3.E4.m1.1.1.1.1.3.3.3.1.2.2" movablelimits="false" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.2" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.1" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.3" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.3.3.3.1.3" xref="S3.E4.m1.1.1.1.1.3.3.3.1.3.cmml">M</mi></munderover><msub id="S3.E4.m1.1.1.1.1.3.3.3.2" xref="S3.E4.m1.1.1.1.1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.3.3.3.2.2" xref="S3.E4.m1.1.1.1.1.3.3.3.2.2.cmml">ℒ</mi><msub id="S3.E4.m1.1.1.1.1.3.3.3.2.3" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3.cmml"><mtext id="S3.E4.m1.1.1.1.1.3.3.3.2.3.2" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3.2a.cmml">intent</mtext><mi id="S3.E4.m1.1.1.1.1.3.3.3.2.3.3" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3.3.cmml">i</mi></msub></msub></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"></eq><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.2.3a.cmml" xref="S3.E4.m1.1.1.1.1.2.3"><mtext class="ltx_font_smallcaps" id="S3.E4.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.2.3">IntentRec</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><plus id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1"></plus><apply id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3"><mtext id="S3.E4.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.3.2.3">item</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><times id="S3.E4.m1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.1"></times><ci id="S3.E4.m1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.2">𝜆</ci><apply id="S3.E4.m1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3"><apply id="S3.E4.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.3.3.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.3.3.3.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3"><eq id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.2">𝑖</ci><cn id="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.1.3">𝑀</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.2.2">ℒ</ci><apply id="S3.E4.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.3.3.2.3.2a.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3.2"><mtext id="S3.E4.m1.1.1.1.1.3.3.3.2.3.2.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3.2">intent</mtext></ci><ci id="S3.E4.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathcal{L}_{\textsc{IntentRec}}=\mathcal{L}_{\text{item}}+\lambda\sum_{i=1}^{%
M}\mathcal{L}_{\text{intent}_{i}},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT IntentRec end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT item end_POSTSUBSCRIPT + italic_λ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT caligraphic_L start_POSTSUBSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.14">where <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS4.p3.14.m1.1"><semantics id="S3.SS4.p3.14.m1.1a"><mi id="S3.SS4.p3.14.m1.1.1" xref="S3.SS4.p3.14.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.14.m1.1b"><ci id="S3.SS4.p3.14.m1.1.1.cmml" xref="S3.SS4.p3.14.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.14.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.14.m1.1d">italic_λ</annotation></semantics></math> is an intent prediction coefficient (hyperparameter). Note that it is possible to assign trainable weights or business-based manual weights to intent prediction heads, but they show similar prediction performance compared to our current formula.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Setup</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>Dataset</h4>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>Summary of Netflix user engagement dataset.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T1.1.2.1.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.1.2.1.1.1">
<tr class="ltx_tr" id="S4.T1.1.2.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.1.1.1.1.1.1" style="font-size:90%;">Number of training/</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.2.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.1.1.1.2.1.1" style="font-size:90%;">validation/test users</span></td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T1.1.2.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.1.2.1.2.1">
<tr class="ltx_tr" id="S4.T1.1.2.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.2.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.1.2.1.1.1.1" style="font-size:90%;">Number of</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.2.1.2.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.1.2.1.2.1.1" style="font-size:90%;">Items</span></td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.2.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.1.2.1.3.1">
<tr class="ltx_tr" id="S4.T1.1.2.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.2.1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.1.3.1.1.1.1" style="font-size:90%;">Interaction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.2.1.3.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.1.3.1.2.1.1" style="font-size:90%;">Metadata</span></td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.1.1.2"><span class="ltx_text" id="S4.T1.1.1.2.1" style="font-size:90%;">2.2M / 181K / 176K</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.1.1.3"><span class="ltx_text" id="S4.T1.1.1.3.1" style="font-size:90%;">35K</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.1.1.1.1">
<tr class="ltx_tr" id="S4.T1.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.1.1.1.2.1"><span class="ltx_text" id="S4.T1.1.1.1.1.2.1.1" style="font-size:90%;">Action Type, Genre,</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.1.1.3">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.1.1.1.3.1"><span class="ltx_text" id="S4.T1.1.1.1.1.3.1.1" style="font-size:90%;">Movie/Show Tag,</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.1.1.1.1.1.1">
<span class="ltx_text" id="S4.T1.1.1.1.1.1.1.1" style="font-size:90%;">Timestamps, Duration, </span><math alttext="\cdots" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.1.1.1.m1.1.1" mathsize="90%" mathvariant="normal" xref="S4.T1.1.1.1.1.1.1.m1.1.1.cmml">⋯</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.1.m1.1.1">⋯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.1.m1.1c">\cdots</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.1.1.m1.1d">⋯</annotation></semantics></math>
</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S4.T1.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.6.6.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.6.1.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6.1.1.1">
<tr class="ltx_tr" id="S4.T1.6.6.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.1.1.1.1.1" style="font-size:90%;">Action Type</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.1.1.2.1.1" style="font-size:90%;">Labels</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.6.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6.1.2.1">
<tr class="ltx_tr" id="S4.T1.6.6.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.2.1.1.1.1" style="font-size:90%;">Genre</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.2.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.2.1.2.1.1" style="font-size:90%;">Labels</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.6.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6.1.3.1">
<tr class="ltx_tr" id="S4.T1.6.6.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.3.1.1.1.1" style="font-size:90%;">Movie/Show</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.3.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.3.1.2.1.1" style="font-size:90%;">Labels</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.6.6.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.6.1.4.1">
<tr class="ltx_tr" id="S4.T1.6.6.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.4.1.1.1.1" style="font-size:90%;">Time-since-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.6.1.4.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.1.4.1.2.1.1" style="font-size:90%;">release Labels</span></td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.2.1.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.2.1.1.1">
<tr class="ltx_tr" id="S4.T1.2.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.2.1.1.1.2.1"><span class="ltx_text" id="S4.T1.2.1.1.1.2.1.1" style="font-size:90%;">11 (e.g.,</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.2.1.1.1.1.1">
<span class="ltx_text" id="S4.T1.2.1.1.1.1.1.1" style="font-size:90%;">Rewatch </span><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T1.2.1.1.1.1.1.m1.1"><semantics id="S4.T1.2.1.1.1.1.1.m1.1a"><mo id="S4.T1.2.1.1.1.1.1.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T1.2.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.1.1.1.1.m1.1b"><ci id="S4.T1.2.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.2.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.1.1.1.1.1.m1.1d">→</annotation></semantics></math><span class="ltx_text" id="S4.T1.2.1.1.1.1.1.2" style="font-size:90%;"> 1)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.3.2.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.3.2.2.1">
<tr class="ltx_tr" id="S4.T1.3.2.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.2.2.1.2.1"><span class="ltx_text" id="S4.T1.3.2.2.1.2.1.1" style="font-size:90%;">21 (e.g.,</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.2.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.2.2.1.1.1">
<span class="ltx_text" id="S4.T1.3.2.2.1.1.1.1" style="font-size:90%;">Comedy </span><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T1.3.2.2.1.1.1.m1.1"><semantics id="S4.T1.3.2.2.1.1.1.m1.1a"><mo id="S4.T1.3.2.2.1.1.1.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T1.3.2.2.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.2.2.1.1.1.m1.1b"><ci id="S4.T1.3.2.2.1.1.1.m1.1.1.cmml" xref="S4.T1.3.2.2.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.2.2.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.2.2.1.1.1.m1.1d">→</annotation></semantics></math><span class="ltx_text" id="S4.T1.3.2.2.1.1.1.2" style="font-size:90%;"> 1)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.4.3.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.4.3.3.1">
<tr class="ltx_tr" id="S4.T1.4.3.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.3.3.1.2.1"><span class="ltx_text" id="S4.T1.4.3.3.1.2.1.1" style="font-size:90%;">2 (e.g.,</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.3.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.4.3.3.1.1.1">
<span class="ltx_text" id="S4.T1.4.3.3.1.1.1.1" style="font-size:90%;">Movie </span><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T1.4.3.3.1.1.1.m1.1"><semantics id="S4.T1.4.3.3.1.1.1.m1.1a"><mo id="S4.T1.4.3.3.1.1.1.m1.1.1" mathsize="90%" stretchy="false" xref="S4.T1.4.3.3.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.3.3.1.1.1.m1.1b"><ci id="S4.T1.4.3.3.1.1.1.m1.1.1.cmml" xref="S4.T1.4.3.3.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.3.3.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.3.3.1.1.1.m1.1d">→</annotation></semantics></math><span class="ltx_text" id="S4.T1.4.3.3.1.1.1.2" style="font-size:90%;"> 1)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.6.5.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.6.5.5.2">
<tr class="ltx_tr" id="S4.T1.6.5.5.2.3">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.5.5.2.3.1"><span class="ltx_text" id="S4.T1.6.5.5.2.3.1.1" style="font-size:90%;">3 (e.g.,</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.5.5.2.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.6.5.5.2.2.2">
<math alttext="\leq" class="ltx_Math" display="inline" id="S4.T1.5.4.4.1.1.1.m1.1"><semantics id="S4.T1.5.4.4.1.1.1.m1.1a"><mo id="S4.T1.5.4.4.1.1.1.m1.1.1" mathsize="90%" xref="S4.T1.5.4.4.1.1.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.4.4.1.1.1.m1.1b"><leq id="S4.T1.5.4.4.1.1.1.m1.1.1.cmml" xref="S4.T1.5.4.4.1.1.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.4.4.1.1.1.m1.1c">\leq</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.4.4.1.1.1.m1.1d">≤</annotation></semantics></math><span class="ltx_text" id="S4.T1.6.5.5.2.2.2.1" style="font-size:90%;"> 1 week </span><math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T1.6.5.5.2.2.2.m2.1"><semantics id="S4.T1.6.5.5.2.2.2.m2.1a"><mo id="S4.T1.6.5.5.2.2.2.m2.1.1" mathsize="90%" stretchy="false" xref="S4.T1.6.5.5.2.2.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.5.5.2.2.2.m2.1b"><ci id="S4.T1.6.5.5.2.2.2.m2.1.1.cmml" xref="S4.T1.6.5.5.2.2.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.5.5.2.2.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.5.5.2.2.2.m2.1d">→</annotation></semantics></math><span class="ltx_text" id="S4.T1.6.5.5.2.2.2.2" style="font-size:90%;"> 1)</span>
</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.5.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.6.2" style="font-size:90%;">Next-item and next-intent prediction results of baselines and our proposed method <span class="ltx_text ltx_font_smallcaps" id="S4.T2.6.2.1">IntentRec</span> on the Netflix user engagement dataset.
All the metrics are represented as relative % improvements compared to the <span class="ltx_text ltx_font_smallcaps" id="S4.T2.6.2.2">LSTM</span> <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib18" title="">1997</a>)</cite> baseline.
N/A indicates that a model is not capable of predicting a certain intent (e.g., Action Type) of a user. The best baseline results are colored gray. For the next-item prediction task, <span class="ltx_text ltx_font_smallcaps" id="S4.T2.6.2.3">IntentRec</span> presents 7.4% and 5.6% improvements in MRR and WMRR compared to the best baseline, with statistical significance.
</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.7.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" id="S4.T2.7.1.1.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.1.1.1.1">
<tr class="ltx_tr" id="S4.T2.7.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.1.1.1.1.1">Models \</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.1.1.2.1.1">Metrics</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.7.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.1.1.2.1">
<tr class="ltx_tr" id="S4.T2.7.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.2.1.1.1.1">Item-ID Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.2.1.2.1">(MRR, WMRR)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.7.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.1.1.3.1">
<tr class="ltx_tr" id="S4.T2.7.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.3.1.1.1.1">Action Type Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.3.1.2.1">MRR</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.7.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.1.1.4.1">
<tr class="ltx_tr" id="S4.T2.7.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.4.1.1.1.1">Genre Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.4.1.2.1">MRR</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.7.1.1.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.1.1.5.1">
<tr class="ltx_tr" id="S4.T2.7.1.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.5.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.5.1.1.1.1">Movie/Show</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.5.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.5.1.2.1.1">Prediction</span> MRR</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.7.1.1.6">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.1.1.6.1">
<tr class="ltx_tr" id="S4.T2.7.1.1.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.6.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.6.1.1.1.1">Time-since-release</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.1.1.6.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.1.1.6.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T2.7.1.1.6.1.2.1.1">Prediction</span> MRR</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T2.7.2.2.1" style="background-color:#DFDFDF;"><span class="ltx_text ltx_font_bold" id="S4.T2.7.2.2.1.1" style="background-color:#DFDFDF;">Baseline Methods</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.7.3.3.1">LSTM <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib18" title="">1997</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.7.3.3.2">(+0.00%, +0.00%)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.7.3.3.3">+0.00%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.7.3.3.4">+0.00%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.7.3.3.5">+0.00%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.7.3.3.6">+0.00%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.4.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S4.T2.7.4.4.1">GRU <cite class="ltx_cite ltx_citemacro_citep">(Cho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib8" title="">2014</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.4.4.2">(+4.45%, +4.30%)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.4.4.3">+0.12%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.4.4.4">+0.18%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.4.4.5">+0.01%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.4.4.6">+0.07%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.5.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S4.T2.7.5.5.1">Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib51" title="">2017</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.5.5.2">(+10.3%, +8.41%)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.5.5.3">+2.35%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.5.5.4">+0.94%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.5.5.5">+0.16%</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.5.5.6">+0.17%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.6.6">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S4.T2.7.6.6.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T2.7.6.6.1.1">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib22" title="">2018</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.6.6.2">(+6.62%, +6.20%)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.6.6.3">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.6.6.4">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.6.6.5">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.6.6.6">N/A</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S4.T2.7.7.7.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T2.7.7.7.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib46" title="">2019</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.7.2">(+0.25%, -1.97%)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.7.3">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.7.4">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.7.5">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.7.6">N/A</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.8.8">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S4.T2.7.8.8.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T2.7.8.8.1.1">TransAct</span> <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.8.8.2" style="background-color:#DFDFDF;"><span class="ltx_text" id="S4.T2.7.8.8.2.1" style="background-color:#DFDFDF;">(+33.7%, +30.6%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.8.8.3" style="background-color:#DFDFDF;"><span class="ltx_text" id="S4.T2.7.8.8.3.1" style="background-color:#DFDFDF;">+8.12%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.8.8.4" style="background-color:#DFDFDF;"><span class="ltx_text" id="S4.T2.7.8.8.4.1" style="background-color:#DFDFDF;">+2.54%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.8.8.5" style="background-color:#DFDFDF;"><span class="ltx_text" id="S4.T2.7.8.8.5.1" style="background-color:#DFDFDF;">+0.94%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.8.8.6" style="background-color:#DFDFDF;"><span class="ltx_text" id="S4.T2.7.8.8.6.1" style="background-color:#DFDFDF;">+0.58%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.9.9">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S4.T2.7.9.9.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.9.9.1.1">
<tr class="ltx_tr" id="S4.T2.7.9.9.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.9.9.1.1.1.1">
<span class="ltx_text ltx_font_smallcaps" id="S4.T2.7.9.9.1.1.1.1.1">IntentRec</span>-V0</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.9.9.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.9.9.1.1.2.1">(production model)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.9.9.2">(+32.6%, +29.0%)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.9.9.3">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.9.9.4">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.9.9.5">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.9.9.6">N/A</td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T2.7.10.10.1" style="background-color:#FFBFBF;"><span class="ltx_text ltx_font_bold" id="S4.T2.7.10.10.1.1" style="background-color:#FFBFBF;">Proposed Method</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.7.11.11">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.7.11.11.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.7.11.11.1.1">
<tr class="ltx_tr" id="S4.T2.7.11.11.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.7.11.11.1.1.1.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.T2.7.11.11.1.1.1.1.1">IntentRec</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.7.11.11.2"><span class="ltx_text ltx_font_bold" id="S4.T2.7.11.11.2.1">(+43.6%, +37.9%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.7.11.11.3"><span class="ltx_text ltx_font_bold" id="S4.T2.7.11.11.3.1">+11.7%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.7.11.11.4"><span class="ltx_text ltx_font_bold" id="S4.T2.7.11.11.4.1">+5.39%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.7.11.11.5"><span class="ltx_text ltx_font_bold" id="S4.T2.7.11.11.5.1">+1.35%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.7.11.11.6"><span class="ltx_text ltx_font_bold" id="S4.T2.7.11.11.6.1">+1.42%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">We use proprietary user engagement data collected in Netflix.
We preprocess raw engagement sequences (i.e., every interactions a user has made on Netflix) of users. The preprocessing is based on some assumptions gathered from internal research to create higher-level engagements. We then randomly sample users from all users to generate training/validation/test data (split ratio: 86%/7%/7%). Key statistics of the Netflix dataset is given in <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.T1" title="In 4.1.1. Dataset ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.1">Rich metadata of each interaction is available in the Netflix dataset; e.g., ‘Action Type’ information indicates a category of an interaction such as continuing to watch something the user has previously started watching, discovering content that the member has never seen on Netflix before, and others. Among all metadata, we select 4 key metadata (Action type, Genre preference, Movie/Show type preference, and Time-since-release) to include as intent prediction labels, as (1) they are considered to be the most important proxies that can help determine a member’s latent intent, and (2) predicting them has high business values in several downstream applications.
Note that these intent prediction labels are subject to change depending on datasets/applications.
Detailed information about each intent prediction label is given as follows.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p3">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Action Type:</span> 11 unique categories of user interactions made on Netflix such as discovering new content, binge-watching existing shows, etc. These labels are created by a rule-based algorithm. We define ”core” action types as 5 distinct types (from New Content Watch to Rewatch) related to actual playing and focus on predicting core labels.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Genre:</span> 21 pre-defined genre labels such as comedy, action, etc. Users’ genre preferences are diverse, and predicting genres can help us capture users’ hidden intents precisely.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Movie/Show:</span> a binary label indicating the corresponding item is a movie or a show. Predicting it is crucial as users may have already decided whether they want to watch shows (relatively short duration) or movies.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(4)</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">Time-since-release:</span> 3 manually-chosen labels indicating whether the corresponding item is released recently or not; 1 = within a week, 2 = between a week and a month, and 3 = older than a month. Predicting it is related to discovering users’ temporal preferences (e.g. a user enjoying the newly released shows vs old-fashioned films).</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p4">
<p class="ltx_p" id="S4.SS1.SSS1.p4.1">Following the experimental setup used in existing literature <cite class="ltx_cite ltx_citemacro_citep">(Pal et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib37" title="">2020</a>; Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite>, all our experiments are based on the Netflix dataset. We <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p4.1.1">do not use public datasets</span> in our experiments, since they lack of crucial interaction metadata (e.g., action type, interaction duration, etc.), which are needed for intent and item predictions in <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS1.p4.1.2">IntentRec</span>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>Baselines</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">We use the following state-of-the-art sequential recommendation models as baselines.
We have excluded baselines <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib6" title="">2019</a>)</cite> having similar or older architectures than our current baselines or that are not sequential recommenders <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib59" title="">2019</a>)</cite>.
Note that all the baselines except <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS2.p1.1.1">TransAct</span> <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite> and <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS2.p1.1.2">IntentRec</span>-V0 are not capable of employing interaction metadata as features for training and testing.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS2.p2">
<ol class="ltx_enumerate" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">LSTM <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib18" title="">1997</a>)</cite>, GRU <cite class="ltx_cite ltx_citemacro_citep">(Cho et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib8" title="">2014</a>)</cite>, Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib51" title="">2017</a>)</cite>:</span>
We modify the original LSTM, GRU, and Trasnformer architectures for multi-task learning. Specifically, for intent predictions, we add multiple intent prediction heads to each enconder.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I2.i2.p1.1.1">SASRec<span class="ltx_text ltx_font_upright" id="S4.I2.i2.p1.1.1.1"> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib22" title="">2018</a>)</cite>:</span></span> a self-attention-based recommender that can compute the relevance of each item in the sequence to the next item prediction and utilize these importance weights to predict the next item.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I2.i3.p1.1.1">BERT4Rec<span class="ltx_text ltx_font_upright" id="S4.I2.i3.p1.1.1.1"> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib46" title="">2019</a>)</cite>:</span></span> a BERT-like recommender that predicts the masked items in the sequence using their left and right context with bidirectional Transformer encoders.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(4)</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I2.i4.p1.1.1">TransAct<span class="ltx_text ltx_font_upright" id="S4.I2.i4.p1.1.1.1"> <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite>:</span></span> a Transformer-based recommender that extracts users’ short-term preferences from their real-time activities. As it is designed to predict a user’s next action given an item, we modify the architecture to predict the next item and action together. <span class="ltx_text ltx_font_bold" id="S4.I2.i4.p1.1.2">This is the state-of-the-art model for user intent (or action) predictions.</span></p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(5)</span>
<div class="ltx_para" id="S4.I2.i5.p1">
<p class="ltx_p" id="S4.I2.i5.p1.1"><span class="ltx_text ltx_font_bold ltx_font_smallcaps" id="S4.I2.i5.p1.1.1">IntentRec<span class="ltx_text ltx_font_upright" id="S4.I2.i5.p1.1.1.1">-V0:</span></span> a strong production model and a simplified version of <span class="ltx_text ltx_font_smallcaps" id="S4.I2.i5.p1.1.2">IntentRec</span> that does not incorporate short-term interest features and intent prediction heads for next-item prediction. Thus, it can predict the next item only.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3. </span>Evaluation Metrics</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.4">We use various standard ranking metrics typically used in recommender systems for evaluation but for brevity, we report mean reciprocal rank (MRR) <cite class="ltx_cite ltx_citemacro_citep">(Craswell, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib9" title="">2009</a>)</cite> and weighted MRR (WMRR). We focus on these two metrics since other metrics (e.g., Recall, NDCG, AUC) show similar tendencies.
The MRR and WMRR metrics indicate how accurately a model predicts the next item <math alttext="i_{n+1}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.1.m1.1"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><msub id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml">i</mi><mrow id="S4.SS1.SSS3.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.3.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2.cmml">n</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.3.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.cmml">+</mo><mn id="S4.SS1.SSS3.p1.1.m1.1.1.3.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.1.m1.1b"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.2">𝑖</ci><apply id="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3"><plus id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1"></plus><ci id="S4.SS1.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2">𝑛</ci><cn id="S4.SS1.SSS3.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.1.m1.1c">i_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.1.m1.1d">italic_i start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> of a test user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.2.m2.1"><semantics id="S4.SS1.SSS3.p1.2.m2.1a"><mi id="S4.SS1.SSS3.p1.2.m2.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.2.m2.1b"><ci id="S4.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.2.m2.1d">italic_u</annotation></semantics></math>, given her <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.3.m3.1"><semantics id="S4.SS1.SSS3.p1.3.m3.1a"><mi id="S4.SS1.SSS3.p1.3.m3.1.1" xref="S4.SS1.SSS3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.3.m3.1b"><ci id="S4.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.3.m3.1d">italic_n</annotation></semantics></math> observed items <math alttext="\{i_{1},\ldots,i_{n}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.4.m4.3"><semantics id="S4.SS1.SSS3.p1.4.m4.3a"><mrow id="S4.SS1.SSS3.p1.4.m4.3.3.2" xref="S4.SS1.SSS3.p1.4.m4.3.3.3.cmml"><mo id="S4.SS1.SSS3.p1.4.m4.3.3.2.3" stretchy="false" xref="S4.SS1.SSS3.p1.4.m4.3.3.3.cmml">{</mo><msub id="S4.SS1.SSS3.p1.4.m4.2.2.1.1" xref="S4.SS1.SSS3.p1.4.m4.2.2.1.1.cmml"><mi id="S4.SS1.SSS3.p1.4.m4.2.2.1.1.2" xref="S4.SS1.SSS3.p1.4.m4.2.2.1.1.2.cmml">i</mi><mn id="S4.SS1.SSS3.p1.4.m4.2.2.1.1.3" xref="S4.SS1.SSS3.p1.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.p1.4.m4.3.3.2.4" xref="S4.SS1.SSS3.p1.4.m4.3.3.3.cmml">,</mo><mi id="S4.SS1.SSS3.p1.4.m4.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p1.4.m4.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p1.4.m4.3.3.2.5" xref="S4.SS1.SSS3.p1.4.m4.3.3.3.cmml">,</mo><msub id="S4.SS1.SSS3.p1.4.m4.3.3.2.2" xref="S4.SS1.SSS3.p1.4.m4.3.3.2.2.cmml"><mi id="S4.SS1.SSS3.p1.4.m4.3.3.2.2.2" xref="S4.SS1.SSS3.p1.4.m4.3.3.2.2.2.cmml">i</mi><mi id="S4.SS1.SSS3.p1.4.m4.3.3.2.2.3" xref="S4.SS1.SSS3.p1.4.m4.3.3.2.2.3.cmml">n</mi></msub><mo id="S4.SS1.SSS3.p1.4.m4.3.3.2.6" stretchy="false" xref="S4.SS1.SSS3.p1.4.m4.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.4.m4.3b"><set id="S4.SS1.SSS3.p1.4.m4.3.3.3.cmml" xref="S4.SS1.SSS3.p1.4.m4.3.3.2"><apply id="S4.SS1.SSS3.p1.4.m4.2.2.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.4.m4.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.4.m4.2.2.1.1.2.cmml" xref="S4.SS1.SSS3.p1.4.m4.2.2.1.1.2">𝑖</ci><cn id="S4.SS1.SSS3.p1.4.m4.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.4.m4.2.2.1.1.3">1</cn></apply><ci id="S4.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1">…</ci><apply id="S4.SS1.SSS3.p1.4.m4.3.3.2.2.cmml" xref="S4.SS1.SSS3.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.4.m4.3.3.2.2.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p1.4.m4.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p1.4.m4.3.3.2.2.2">𝑖</ci><ci id="S4.SS1.SSS3.p1.4.m4.3.3.2.2.3.cmml" xref="S4.SS1.SSS3.p1.4.m4.3.3.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.4.m4.3c">\{i_{1},\ldots,i_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.4.m4.3d">{ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>.
MRR and WMRR metrics are defined as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="MRR=\frac{1}{|Test|}\sum_{u\in Test}\frac{1}{R(i_{n+1})},WMRR=\frac{\sum_{u\in
Test%
}\frac{d_{n+1}}{R(i_{n+1})}}{\sum_{u\in Test}d_{n+1}}," class="ltx_Math" display="block" id="S4.E5.m1.4"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1"><mrow id="S4.E5.m1.4.4.1.1.2" xref="S4.E5.m1.4.4.1.1.3.cmml"><mrow id="S4.E5.m1.4.4.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.2.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.2.2" xref="S4.E5.m1.4.4.1.1.1.1.2.2.cmml">M</mi><mo id="S4.E5.m1.4.4.1.1.1.1.2.1" xref="S4.E5.m1.4.4.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.1.1.2.3" xref="S4.E5.m1.4.4.1.1.1.1.2.3.cmml">R</mi><mo id="S4.E5.m1.4.4.1.1.1.1.2.1a" xref="S4.E5.m1.4.4.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.1.1.2.4" xref="S4.E5.m1.4.4.1.1.1.1.2.4.cmml">R</mi></mrow><mo id="S4.E5.m1.4.4.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.3.cmml"><mfrac id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mn id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml">1</mn><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.2.cmml"><mo id="S4.E5.m1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">T</mi><mo id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml">e</mi><mo id="S4.E5.m1.1.1.1.1.1.1a" xref="S4.E5.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E5.m1.1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.1.4.cmml">s</mi><mo id="S4.E5.m1.1.1.1.1.1.1b" xref="S4.E5.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E5.m1.1.1.1.1.1.5" xref="S4.E5.m1.1.1.1.1.1.5.cmml">t</mi></mrow><mo id="S4.E5.m1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S4.E5.m1.4.4.1.1.1.1.3.1" xref="S4.E5.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.3.2.cmml"><munder id="S4.E5.m1.4.4.1.1.1.1.3.2.1" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.cmml"><mo id="S4.E5.m1.4.4.1.1.1.1.3.2.1.2" movablelimits="false" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.2.cmml">∑</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.2" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.2.cmml">u</mi><mo id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.1" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.1.cmml">∈</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.2" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.2.cmml">T</mi><mo id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.3" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.3.cmml">e</mi><mo id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1a" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.4" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.4.cmml">s</mi><mo id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1b" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.5" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.5.cmml">t</mi></mrow></mrow></munder><mfrac id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><mn id="S4.E5.m1.2.2.3" xref="S4.E5.m1.2.2.3.cmml">1</mn><mrow id="S4.E5.m1.2.2.1" xref="S4.E5.m1.2.2.1.cmml"><mi id="S4.E5.m1.2.2.1.3" xref="S4.E5.m1.2.2.1.3.cmml">R</mi><mo id="S4.E5.m1.2.2.1.2" xref="S4.E5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mo id="S4.E5.m1.2.2.1.1.1.2" stretchy="false" xref="S4.E5.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.2.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.2.cmml">i</mi><mrow id="S4.E5.m1.2.2.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.3.2" xref="S4.E5.m1.2.2.1.1.1.1.3.2.cmml">n</mi><mo id="S4.E5.m1.2.2.1.1.1.1.3.1" xref="S4.E5.m1.2.2.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E5.m1.2.2.1.1.1.1.3.3" xref="S4.E5.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E5.m1.2.2.1.1.1.3" stretchy="false" xref="S4.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E5.m1.4.4.1.1.2.3" xref="S4.E5.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S4.E5.m1.4.4.1.1.2.2" xref="S4.E5.m1.4.4.1.1.2.2.cmml"><mrow id="S4.E5.m1.4.4.1.1.2.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.cmml"><mi id="S4.E5.m1.4.4.1.1.2.2.2.2" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml">W</mi><mo id="S4.E5.m1.4.4.1.1.2.2.2.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.2.2.2.3" xref="S4.E5.m1.4.4.1.1.2.2.2.3.cmml">M</mi><mo id="S4.E5.m1.4.4.1.1.2.2.2.1a" xref="S4.E5.m1.4.4.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.2.2.2.4" xref="S4.E5.m1.4.4.1.1.2.2.2.4.cmml">R</mi><mo id="S4.E5.m1.4.4.1.1.2.2.2.1b" xref="S4.E5.m1.4.4.1.1.2.2.2.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.1.1.2.2.2.5" xref="S4.E5.m1.4.4.1.1.2.2.2.5.cmml">R</mi></mrow><mo id="S4.E5.m1.4.4.1.1.2.2.1" xref="S4.E5.m1.4.4.1.1.2.2.1.cmml">=</mo><mfrac id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml"><mrow id="S4.E5.m1.3.3.1" xref="S4.E5.m1.3.3.1.cmml"><msub id="S4.E5.m1.3.3.1.2" xref="S4.E5.m1.3.3.1.2.cmml"><mo id="S4.E5.m1.3.3.1.2.2" xref="S4.E5.m1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.3.3.1.2.3" xref="S4.E5.m1.3.3.1.2.3.cmml"><mi id="S4.E5.m1.3.3.1.2.3.2" xref="S4.E5.m1.3.3.1.2.3.2.cmml">u</mi><mo id="S4.E5.m1.3.3.1.2.3.1" xref="S4.E5.m1.3.3.1.2.3.1.cmml">∈</mo><mrow id="S4.E5.m1.3.3.1.2.3.3" xref="S4.E5.m1.3.3.1.2.3.3.cmml"><mi id="S4.E5.m1.3.3.1.2.3.3.2" xref="S4.E5.m1.3.3.1.2.3.3.2.cmml">T</mi><mo id="S4.E5.m1.3.3.1.2.3.3.1" xref="S4.E5.m1.3.3.1.2.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.3.3.1.2.3.3.3" xref="S4.E5.m1.3.3.1.2.3.3.3.cmml">e</mi><mo id="S4.E5.m1.3.3.1.2.3.3.1a" xref="S4.E5.m1.3.3.1.2.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.3.3.1.2.3.3.4" xref="S4.E5.m1.3.3.1.2.3.3.4.cmml">s</mi><mo id="S4.E5.m1.3.3.1.2.3.3.1b" xref="S4.E5.m1.3.3.1.2.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.3.3.1.2.3.3.5" xref="S4.E5.m1.3.3.1.2.3.3.5.cmml">t</mi></mrow></mrow></msub><mfrac id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml"><msub id="S4.E5.m1.3.3.1.1.3" xref="S4.E5.m1.3.3.1.1.3.cmml"><mi id="S4.E5.m1.3.3.1.1.3.2" xref="S4.E5.m1.3.3.1.1.3.2.cmml">d</mi><mrow id="S4.E5.m1.3.3.1.1.3.3" xref="S4.E5.m1.3.3.1.1.3.3.cmml"><mi id="S4.E5.m1.3.3.1.1.3.3.2" xref="S4.E5.m1.3.3.1.1.3.3.2.cmml">n</mi><mo id="S4.E5.m1.3.3.1.1.3.3.1" xref="S4.E5.m1.3.3.1.1.3.3.1.cmml">+</mo><mn id="S4.E5.m1.3.3.1.1.3.3.3" xref="S4.E5.m1.3.3.1.1.3.3.3.cmml">1</mn></mrow></msub><mrow id="S4.E5.m1.3.3.1.1.1" xref="S4.E5.m1.3.3.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.3.cmml">R</mi><mo id="S4.E5.m1.3.3.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.3.3.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml">i</mi><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.2.cmml">n</mi><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E5.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mrow id="S4.E5.m1.3.3.3" xref="S4.E5.m1.3.3.3.cmml"><msub id="S4.E5.m1.3.3.3.1" xref="S4.E5.m1.3.3.3.1.cmml"><mo id="S4.E5.m1.3.3.3.1.2" xref="S4.E5.m1.3.3.3.1.2.cmml">∑</mo><mrow id="S4.E5.m1.3.3.3.1.3" xref="S4.E5.m1.3.3.3.1.3.cmml"><mi id="S4.E5.m1.3.3.3.1.3.2" xref="S4.E5.m1.3.3.3.1.3.2.cmml">u</mi><mo id="S4.E5.m1.3.3.3.1.3.1" xref="S4.E5.m1.3.3.3.1.3.1.cmml">∈</mo><mrow id="S4.E5.m1.3.3.3.1.3.3" xref="S4.E5.m1.3.3.3.1.3.3.cmml"><mi id="S4.E5.m1.3.3.3.1.3.3.2" xref="S4.E5.m1.3.3.3.1.3.3.2.cmml">T</mi><mo id="S4.E5.m1.3.3.3.1.3.3.1" xref="S4.E5.m1.3.3.3.1.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.3.3.3.1.3.3.3" xref="S4.E5.m1.3.3.3.1.3.3.3.cmml">e</mi><mo id="S4.E5.m1.3.3.3.1.3.3.1a" xref="S4.E5.m1.3.3.3.1.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.3.3.3.1.3.3.4" xref="S4.E5.m1.3.3.3.1.3.3.4.cmml">s</mi><mo id="S4.E5.m1.3.3.3.1.3.3.1b" xref="S4.E5.m1.3.3.3.1.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.3.3.3.1.3.3.5" xref="S4.E5.m1.3.3.3.1.3.3.5.cmml">t</mi></mrow></mrow></msub><msub id="S4.E5.m1.3.3.3.2" xref="S4.E5.m1.3.3.3.2.cmml"><mi id="S4.E5.m1.3.3.3.2.2" xref="S4.E5.m1.3.3.3.2.2.cmml">d</mi><mrow id="S4.E5.m1.3.3.3.2.3" xref="S4.E5.m1.3.3.3.2.3.cmml"><mi id="S4.E5.m1.3.3.3.2.3.2" xref="S4.E5.m1.3.3.3.2.3.2.cmml">n</mi><mo id="S4.E5.m1.3.3.3.2.3.1" xref="S4.E5.m1.3.3.3.2.3.1.cmml">+</mo><mn id="S4.E5.m1.3.3.3.2.3.3" xref="S4.E5.m1.3.3.3.2.3.3.cmml">1</mn></mrow></msub></mrow></mfrac></mrow></mrow><mo id="S4.E5.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3a.cmml" xref="S4.E5.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.4.4.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1"><eq id="S4.E5.m1.4.4.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1"></eq><apply id="S4.E5.m1.4.4.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2"><times id="S4.E5.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2.1"></times><ci id="S4.E5.m1.4.4.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2.2">𝑀</ci><ci id="S4.E5.m1.4.4.1.1.1.1.2.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2.3">𝑅</ci><ci id="S4.E5.m1.4.4.1.1.1.1.2.4.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2.4">𝑅</ci></apply><apply id="S4.E5.m1.4.4.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3"><times id="S4.E5.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.1"></times><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><divide id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1"></divide><cn id="S4.E5.m1.1.1.3.cmml" type="integer" xref="S4.E5.m1.1.1.3">1</cn><apply id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1"><abs id="S4.E5.m1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2"></abs><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"></times><ci id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2">𝑇</ci><ci id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3">𝑒</ci><ci id="S4.E5.m1.1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.1.4">𝑠</ci><ci id="S4.E5.m1.1.1.1.1.1.5.cmml" xref="S4.E5.m1.1.1.1.1.1.5">𝑡</ci></apply></apply></apply><apply id="S4.E5.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2"><apply id="S4.E5.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.3.2.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1">subscript</csymbol><sum id="S4.E5.m1.4.4.1.1.1.1.3.2.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.2"></sum><apply id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3"><in id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.1"></in><ci id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.2">𝑢</ci><apply id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3"><times id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.1"></times><ci id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.2">𝑇</ci><ci id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.3">𝑒</ci><ci id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.4.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.4">𝑠</ci><ci id="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.5.cmml" xref="S4.E5.m1.4.4.1.1.1.1.3.2.1.3.3.5">𝑡</ci></apply></apply></apply><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><divide id="S4.E5.m1.2.2.2.cmml" xref="S4.E5.m1.2.2"></divide><cn id="S4.E5.m1.2.2.3.cmml" type="integer" xref="S4.E5.m1.2.2.3">1</cn><apply id="S4.E5.m1.2.2.1.cmml" xref="S4.E5.m1.2.2.1"><times id="S4.E5.m1.2.2.1.2.cmml" xref="S4.E5.m1.2.2.1.2"></times><ci id="S4.E5.m1.2.2.1.3.cmml" xref="S4.E5.m1.2.2.1.3">𝑅</ci><apply id="S4.E5.m1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2">𝑖</ci><apply id="S4.E5.m1.2.2.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3"><plus id="S4.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3.1"></plus><ci id="S4.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3.2">𝑛</ci><cn id="S4.E5.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply><apply id="S4.E5.m1.4.4.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2"><eq id="S4.E5.m1.4.4.1.1.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.1"></eq><apply id="S4.E5.m1.4.4.1.1.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2"><times id="S4.E5.m1.4.4.1.1.2.2.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1"></times><ci id="S4.E5.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.2">𝑊</ci><ci id="S4.E5.m1.4.4.1.1.2.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.3">𝑀</ci><ci id="S4.E5.m1.4.4.1.1.2.2.2.4.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.4">𝑅</ci><ci id="S4.E5.m1.4.4.1.1.2.2.2.5.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.5">𝑅</ci></apply><apply id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3"><divide id="S4.E5.m1.3.3.2.cmml" xref="S4.E5.m1.3.3"></divide><apply id="S4.E5.m1.3.3.1.cmml" xref="S4.E5.m1.3.3.1"><apply id="S4.E5.m1.3.3.1.2.cmml" xref="S4.E5.m1.3.3.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.2.1.cmml" xref="S4.E5.m1.3.3.1.2">subscript</csymbol><sum id="S4.E5.m1.3.3.1.2.2.cmml" xref="S4.E5.m1.3.3.1.2.2"></sum><apply id="S4.E5.m1.3.3.1.2.3.cmml" xref="S4.E5.m1.3.3.1.2.3"><in id="S4.E5.m1.3.3.1.2.3.1.cmml" xref="S4.E5.m1.3.3.1.2.3.1"></in><ci id="S4.E5.m1.3.3.1.2.3.2.cmml" xref="S4.E5.m1.3.3.1.2.3.2">𝑢</ci><apply id="S4.E5.m1.3.3.1.2.3.3.cmml" xref="S4.E5.m1.3.3.1.2.3.3"><times id="S4.E5.m1.3.3.1.2.3.3.1.cmml" xref="S4.E5.m1.3.3.1.2.3.3.1"></times><ci id="S4.E5.m1.3.3.1.2.3.3.2.cmml" xref="S4.E5.m1.3.3.1.2.3.3.2">𝑇</ci><ci id="S4.E5.m1.3.3.1.2.3.3.3.cmml" xref="S4.E5.m1.3.3.1.2.3.3.3">𝑒</ci><ci id="S4.E5.m1.3.3.1.2.3.3.4.cmml" xref="S4.E5.m1.3.3.1.2.3.3.4">𝑠</ci><ci id="S4.E5.m1.3.3.1.2.3.3.5.cmml" xref="S4.E5.m1.3.3.1.2.3.3.5">𝑡</ci></apply></apply></apply><apply id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1.1"><divide id="S4.E5.m1.3.3.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1"></divide><apply id="S4.E5.m1.3.3.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2">𝑑</ci><apply id="S4.E5.m1.3.3.1.1.3.3.cmml" xref="S4.E5.m1.3.3.1.1.3.3"><plus id="S4.E5.m1.3.3.1.1.3.3.1.cmml" xref="S4.E5.m1.3.3.1.1.3.3.1"></plus><ci id="S4.E5.m1.3.3.1.1.3.3.2.cmml" xref="S4.E5.m1.3.3.1.1.3.3.2">𝑛</ci><cn id="S4.E5.m1.3.3.1.1.3.3.3.cmml" type="integer" xref="S4.E5.m1.3.3.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E5.m1.3.3.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1"><times id="S4.E5.m1.3.3.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.2"></times><ci id="S4.E5.m1.3.3.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.3">𝑅</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2">𝑖</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3"><plus id="S4.E5.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.1"></plus><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.2">𝑛</ci><cn id="S4.E5.m1.3.3.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply><apply id="S4.E5.m1.3.3.3.cmml" xref="S4.E5.m1.3.3.3"><apply id="S4.E5.m1.3.3.3.1.cmml" xref="S4.E5.m1.3.3.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.1.1.cmml" xref="S4.E5.m1.3.3.3.1">subscript</csymbol><sum id="S4.E5.m1.3.3.3.1.2.cmml" xref="S4.E5.m1.3.3.3.1.2"></sum><apply id="S4.E5.m1.3.3.3.1.3.cmml" xref="S4.E5.m1.3.3.3.1.3"><in id="S4.E5.m1.3.3.3.1.3.1.cmml" xref="S4.E5.m1.3.3.3.1.3.1"></in><ci id="S4.E5.m1.3.3.3.1.3.2.cmml" xref="S4.E5.m1.3.3.3.1.3.2">𝑢</ci><apply id="S4.E5.m1.3.3.3.1.3.3.cmml" xref="S4.E5.m1.3.3.3.1.3.3"><times id="S4.E5.m1.3.3.3.1.3.3.1.cmml" xref="S4.E5.m1.3.3.3.1.3.3.1"></times><ci id="S4.E5.m1.3.3.3.1.3.3.2.cmml" xref="S4.E5.m1.3.3.3.1.3.3.2">𝑇</ci><ci id="S4.E5.m1.3.3.3.1.3.3.3.cmml" xref="S4.E5.m1.3.3.3.1.3.3.3">𝑒</ci><ci id="S4.E5.m1.3.3.3.1.3.3.4.cmml" xref="S4.E5.m1.3.3.3.1.3.3.4">𝑠</ci><ci id="S4.E5.m1.3.3.3.1.3.3.5.cmml" xref="S4.E5.m1.3.3.3.1.3.3.5">𝑡</ci></apply></apply></apply><apply id="S4.E5.m1.3.3.3.2.cmml" xref="S4.E5.m1.3.3.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.2.1.cmml" xref="S4.E5.m1.3.3.3.2">subscript</csymbol><ci id="S4.E5.m1.3.3.3.2.2.cmml" xref="S4.E5.m1.3.3.3.2.2">𝑑</ci><apply id="S4.E5.m1.3.3.3.2.3.cmml" xref="S4.E5.m1.3.3.3.2.3"><plus id="S4.E5.m1.3.3.3.2.3.1.cmml" xref="S4.E5.m1.3.3.3.2.3.1"></plus><ci id="S4.E5.m1.3.3.3.2.3.2.cmml" xref="S4.E5.m1.3.3.3.2.3.2">𝑛</ci><cn id="S4.E5.m1.3.3.3.2.3.3.cmml" type="integer" xref="S4.E5.m1.3.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">MRR=\frac{1}{|Test|}\sum_{u\in Test}\frac{1}{R(i_{n+1})},WMRR=\frac{\sum_{u\in
Test%
}\frac{d_{n+1}}{R(i_{n+1})}}{\sum_{u\in Test}d_{n+1}},</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.4d">italic_M italic_R italic_R = divide start_ARG 1 end_ARG start_ARG | italic_T italic_e italic_s italic_t | end_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_T italic_e italic_s italic_t end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_R ( italic_i start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT ) end_ARG , italic_W italic_M italic_R italic_R = divide start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_T italic_e italic_s italic_t end_POSTSUBSCRIPT divide start_ARG italic_d start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_R ( italic_i start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT ) end_ARG end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ italic_T italic_e italic_s italic_t end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS3.p1.8">where <math alttext="d_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.5.m1.1"><semantics id="S4.SS1.SSS3.p1.5.m1.1a"><msub id="S4.SS1.SSS3.p1.5.m1.1.1" xref="S4.SS1.SSS3.p1.5.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.5.m1.1.1.2" xref="S4.SS1.SSS3.p1.5.m1.1.1.2.cmml">d</mi><mi id="S4.SS1.SSS3.p1.5.m1.1.1.3" xref="S4.SS1.SSS3.p1.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.5.m1.1b"><apply id="S4.SS1.SSS3.p1.5.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.5.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.5.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.5.m1.1.1.2">𝑑</ci><ci id="S4.SS1.SSS3.p1.5.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.5.m1.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.5.m1.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the duration of an interaction (e.g., playtime), and <math alttext="R(i)" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.6.m2.1"><semantics id="S4.SS1.SSS3.p1.6.m2.1a"><mrow id="S4.SS1.SSS3.p1.6.m2.1.2" xref="S4.SS1.SSS3.p1.6.m2.1.2.cmml"><mi id="S4.SS1.SSS3.p1.6.m2.1.2.2" xref="S4.SS1.SSS3.p1.6.m2.1.2.2.cmml">R</mi><mo id="S4.SS1.SSS3.p1.6.m2.1.2.1" xref="S4.SS1.SSS3.p1.6.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p1.6.m2.1.2.3.2" xref="S4.SS1.SSS3.p1.6.m2.1.2.cmml"><mo id="S4.SS1.SSS3.p1.6.m2.1.2.3.2.1" stretchy="false" xref="S4.SS1.SSS3.p1.6.m2.1.2.cmml">(</mo><mi id="S4.SS1.SSS3.p1.6.m2.1.1" xref="S4.SS1.SSS3.p1.6.m2.1.1.cmml">i</mi><mo id="S4.SS1.SSS3.p1.6.m2.1.2.3.2.2" stretchy="false" xref="S4.SS1.SSS3.p1.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.6.m2.1b"><apply id="S4.SS1.SSS3.p1.6.m2.1.2.cmml" xref="S4.SS1.SSS3.p1.6.m2.1.2"><times id="S4.SS1.SSS3.p1.6.m2.1.2.1.cmml" xref="S4.SS1.SSS3.p1.6.m2.1.2.1"></times><ci id="S4.SS1.SSS3.p1.6.m2.1.2.2.cmml" xref="S4.SS1.SSS3.p1.6.m2.1.2.2">𝑅</ci><ci id="S4.SS1.SSS3.p1.6.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.6.m2.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.6.m2.1c">R(i)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.6.m2.1d">italic_R ( italic_i )</annotation></semantics></math> is a predicted rank of an item <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.7.m3.1"><semantics id="S4.SS1.SSS3.p1.7.m3.1a"><mi id="S4.SS1.SSS3.p1.7.m3.1.1" xref="S4.SS1.SSS3.p1.7.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.7.m3.1b"><ci id="S4.SS1.SSS3.p1.7.m3.1.1.cmml" xref="S4.SS1.SSS3.p1.7.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.7.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.7.m3.1d">italic_i</annotation></semantics></math> among all items. For all experiments, we aim to predict the latest item of a user; hence, <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.8.m4.1"><semantics id="S4.SS1.SSS3.p1.8.m4.1a"><mi id="S4.SS1.SSS3.p1.8.m4.1.1" xref="S4.SS1.SSS3.p1.8.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.8.m4.1b"><ci id="S4.SS1.SSS3.p1.8.m4.1.1.cmml" xref="S4.SS1.SSS3.p1.8.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.8.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.8.m4.1d">italic_n</annotation></semantics></math> is set to the maximum sequence length (100).
Due to the proprietary nature of the paper, we only provide relative % improvements of MRR and WMRR of a method compared to the worst baseline (e.g., LSTM) instead of the absolute values, while presenting experimental results.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3. </span>Ablation study of different model architectures for <span class="ltx_text ltx_font_smallcaps" id="S4.T3.6.1">IntentRec</span> on the Netflix user engagement dataset.
All the metrics are represented as relative % improvements compared to the V1 baseline.
N/A indicates that a model is not capable of predicting a certain intent of a user. Our proposed hierarchical learning with short-term modeling shows the best performance. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.7.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="S4.T3.7.1.1.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.1.1.1.1">
<tr class="ltx_tr" id="S4.T3.7.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.1.1.1.1.1" style="font-size:90%;">Models \</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.1.1.2.1.1" style="font-size:90%;">Metrics</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.7.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.1.1.2.1">
<tr class="ltx_tr" id="S4.T3.7.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.2.1.1.1.1" style="font-size:90%;">Item-ID Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.2.1.2.1"><span class="ltx_text" id="S4.T3.7.1.1.2.1.2.1.1" style="font-size:90%;">(MRR, WMRR)</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.7.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.1.1.3.1">
<tr class="ltx_tr" id="S4.T3.7.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.3.1.1.1.1" style="font-size:90%;">Action Type Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.3.1.2.1"><span class="ltx_text" id="S4.T3.7.1.1.3.1.2.1.1" style="font-size:90%;">MRR</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.7.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.1.1.4.1">
<tr class="ltx_tr" id="S4.T3.7.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.4.1.1.1.1" style="font-size:90%;">Genre Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.4.1.2.1"><span class="ltx_text" id="S4.T3.7.1.1.4.1.2.1.1" style="font-size:90%;">MRR</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.7.1.1.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.1.1.5.1">
<tr class="ltx_tr" id="S4.T3.7.1.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.5.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.5.1.1.1.1" style="font-size:90%;">Movie/Show</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.5.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.5.1.2.1.1" style="font-size:90%;">Prediction</span><span class="ltx_text" id="S4.T3.7.1.1.5.1.2.1.2" style="font-size:90%;"> MRR</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.7.1.1.6">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.1.1.6.1">
<tr class="ltx_tr" id="S4.T3.7.1.1.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.6.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.6.1.1.1.1" style="font-size:90%;">Time-since-release</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.1.1.6.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.1.1.6.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.1.1.6.1.2.1.1" style="font-size:90%;">Prediction</span><span class="ltx_text" id="S4.T3.7.1.1.6.1.2.1.2" style="font-size:90%;"> MRR</span>
</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S4.T3.7.2.2.1" style="background-color:#DFDFDF;"><span class="ltx_text ltx_font_bold" id="S4.T3.7.2.2.1.1" style="font-size:90%;background-color:#DFDFDF;">Variants of <span class="ltx_text ltx_font_smallcaps" id="S4.T3.7.2.2.1.1.1">IntentRec</span></span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.7.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.7.3.3.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.3.3.1.1">
<tr class="ltx_tr" id="S4.T3.7.3.3.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.3.3.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.3.3.1.1.1.1.1" style="font-size:90%;">V0</span><span class="ltx_text" id="S4.T3.7.3.3.1.1.1.1.2" style="font-size:90%;">: next-item</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.3.3.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.3.3.1.1.2.1"><span class="ltx_text" id="S4.T3.7.3.3.1.1.2.1.1" style="font-size:90%;">prediction only</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.3.3.2"><span class="ltx_text" id="S4.T3.7.3.3.2.1" style="font-size:90%;">(-0.06%, +0.21%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.3.3.3"><span class="ltx_text" id="S4.T3.7.3.3.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.3.3.4"><span class="ltx_text" id="S4.T3.7.3.3.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.3.3.5"><span class="ltx_text" id="S4.T3.7.3.3.5.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.7.3.3.6"><span class="ltx_text" id="S4.T3.7.3.3.6.1" style="font-size:90%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T3.7.4.4.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.4.4.1.1">
<tr class="ltx_tr" id="S4.T3.7.4.4.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.4.4.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.4.4.1.1.1.1.1" style="font-size:90%;">V1</span><span class="ltx_text" id="S4.T3.7.4.4.1.1.1.1.2" style="font-size:90%;">: simple</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.4.4.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.4.4.1.1.2.1"><span class="ltx_text" id="S4.T3.7.4.4.1.1.2.1.1" style="font-size:90%;">multi-task learning</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.4.4.2"><span class="ltx_text" id="S4.T3.7.4.4.2.1" style="font-size:90%;">(+0.00%, +0.00%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.4.4.3"><span class="ltx_text" id="S4.T3.7.4.4.3.1" style="font-size:90%;">+0.00%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.4.4.4"><span class="ltx_text" id="S4.T3.7.4.4.4.1" style="font-size:90%;">+0.00%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.4.4.5"><span class="ltx_text" id="S4.T3.7.4.4.5.1" style="font-size:90%;">+0.00%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.4.4.6"><span class="ltx_text" id="S4.T3.7.4.4.6.1" style="font-size:90%;">+0.00%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T3.7.5.5.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.5.5.1.1">
<tr class="ltx_tr" id="S4.T3.7.5.5.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.5.5.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.5.5.1.1.1.1.1" style="font-size:90%;">V2</span><span class="ltx_text" id="S4.T3.7.5.5.1.1.1.1.2" style="font-size:90%;">: hierarchical</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.5.5.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.5.5.1.1.2.1"><span class="ltx_text" id="S4.T3.7.5.5.1.1.2.1.1" style="font-size:90%;">multi-task learning</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.5.5.2"><span class="ltx_text" id="S4.T3.7.5.5.2.1" style="font-size:90%;">(+4.53%, +3.95%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.5.5.3"><span class="ltx_text" id="S4.T3.7.5.5.3.1" style="font-size:90%;">+1.93%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.5.5.4"><span class="ltx_text" id="S4.T3.7.5.5.4.1" style="font-size:90%;">+0.57%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.5.5.5"><span class="ltx_text" id="S4.T3.7.5.5.5.1" style="font-size:90%;">+0.33%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.5.5.6"><span class="ltx_text" id="S4.T3.7.5.5.6.1" style="font-size:90%;">+0.53%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S4.T3.7.6.6.1" style="background-color:#FFBFBF;"><span class="ltx_text ltx_font_bold" id="S4.T3.7.6.6.1.1" style="font-size:90%;background-color:#FFBFBF;">Proposed Method</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.7.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T3.7.7.7.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.7.7.1.1">
<tr class="ltx_tr" id="S4.T3.7.7.7.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.7.7.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.7.7.1.1.1.1.1" style="font-size:90%;">V3-last-1-month</span><span class="ltx_text" id="S4.T3.7.7.7.1.1.1.1.2" style="font-size:90%;">:</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.7.7.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.7.7.1.1.2.1"><span class="ltx_text" id="S4.T3.7.7.7.1.1.2.1.1" style="font-size:90%;">short-term-as-input</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.7.7.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.7.7.2.1">
<tr class="ltx_tr" id="S4.T3.7.7.7.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.7.7.2.1.1.1">
<span class="ltx_text" id="S4.T3.7.7.7.2.1.1.1.1" style="font-size:90%;">(</span><span class="ltx_text ltx_font_bold" id="S4.T3.7.7.7.2.1.1.1.2" style="font-size:90%;">+8.56%</span><span class="ltx_text" id="S4.T3.7.7.7.2.1.1.1.3" style="font-size:90%;">, +6.67%)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.7.7.3"><span class="ltx_text" id="S4.T3.7.7.7.3.1" style="font-size:90%;">+3.09%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.7.7.4"><span class="ltx_text ltx_font_bold" id="S4.T3.7.7.7.4.1" style="font-size:90%;">+2.85%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.7.7.5"><span class="ltx_text ltx_font_bold" id="S4.T3.7.7.7.5.1" style="font-size:90%;">+0.80%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.7.7.7.6"><span class="ltx_text" id="S4.T3.7.7.7.6.1" style="font-size:90%;">+0.72%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r" id="S4.T3.7.8.8.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.8.8.1.1">
<tr class="ltx_tr" id="S4.T3.7.8.8.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.8.8.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.8.8.1.1.1.1.1" style="font-size:90%;">V3-last-1-week</span><span class="ltx_text" id="S4.T3.7.8.8.1.1.1.1.2" style="font-size:90%;">:</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.8.8.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.8.8.1.1.2.1"><span class="ltx_text" id="S4.T3.7.8.8.1.1.2.1.1" style="font-size:90%;">short-term-as-input</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.8.8.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.8.8.2.1">
<tr class="ltx_tr" id="S4.T3.7.8.8.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.8.8.2.1.1.1">
<span class="ltx_text" id="S4.T3.7.8.8.2.1.1.1.1" style="font-size:90%;">(+8.28%, </span><span class="ltx_text ltx_font_bold" id="S4.T3.7.8.8.2.1.1.1.2" style="font-size:90%;">+7.10%</span><span class="ltx_text" id="S4.T3.7.8.8.2.1.1.1.3" style="font-size:90%;">)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.8.8.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.8.8.3.1">
<tr class="ltx_tr" id="S4.T3.7.8.8.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.8.8.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.8.8.3.1.1.1.1" style="font-size:90%;">+3.43%</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.8.8.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.8.8.4.1">
<tr class="ltx_tr" id="S4.T3.7.8.8.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.8.8.4.1.1.1"><span class="ltx_text" id="S4.T3.7.8.8.4.1.1.1.1" style="font-size:90%;">+2.49%</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.8.8.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.8.8.5.1">
<tr class="ltx_tr" id="S4.T3.7.8.8.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.8.8.5.1.1.1"><span class="ltx_text" id="S4.T3.7.8.8.5.1.1.1.1" style="font-size:90%;">+0.38%</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.7.8.8.6">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.7.8.8.6.1">
<tr class="ltx_tr" id="S4.T3.7.8.8.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T3.7.8.8.6.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.7.8.8.6.1.1.1.1" style="font-size:90%;">+1.03%</span></td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4. </span>Ablation study of each prediction head of <span class="ltx_text ltx_font_smallcaps" id="S4.T4.6.1">IntentRec</span> on the Netflix user engagement dataset.
All the metrics are represented as relative % improvements compared to the V0 baseline for item-ID prediction and each variant for intent prediction.
N/A indicates that a model is not capable of predicting a certain intent (e.g., Action Type) of a user. Action Type prediction is the most important one for next-item prediction.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.7">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.7.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" id="S4.T4.7.1.1.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.1.1.1.1">
<tr class="ltx_tr" id="S4.T4.7.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.1.1.1.1.1" style="font-size:90%;">Models \</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.1.1.2.1.1" style="font-size:90%;">Metrics</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.7.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.1.1.2.1">
<tr class="ltx_tr" id="S4.T4.7.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.2.1.1.1.1" style="font-size:90%;">Item-ID Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.2.1.2.1"><span class="ltx_text" id="S4.T4.7.1.1.2.1.2.1.1" style="font-size:90%;">(MRR, WMRR)</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.7.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.1.1.3.1">
<tr class="ltx_tr" id="S4.T4.7.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.3.1.1.1.1" style="font-size:90%;">Action Type Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.3.1.2.1"><span class="ltx_text" id="S4.T4.7.1.1.3.1.2.1.1" style="font-size:90%;">MRR</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.7.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.1.1.4.1">
<tr class="ltx_tr" id="S4.T4.7.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.4.1.1.1.1" style="font-size:90%;">Genre Prediction</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.4.1.2.1"><span class="ltx_text" id="S4.T4.7.1.1.4.1.2.1.1" style="font-size:90%;">MRR</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.7.1.1.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.1.1.5.1">
<tr class="ltx_tr" id="S4.T4.7.1.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.5.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.5.1.1.1.1" style="font-size:90%;">Movie/Show</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.1.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.5.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.5.1.2.1.1" style="font-size:90%;">Prediction</span><span class="ltx_text" id="S4.T4.7.1.1.5.1.2.1.2" style="font-size:90%;"> MRR</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T4.7.1.1.6">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.1.1.6.1">
<tr class="ltx_tr" id="S4.T4.7.1.1.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.6.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.6.1.1.1.1" style="font-size:90%;">Time-since-release</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.1.1.6.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.1.1.6.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T4.7.1.1.6.1.2.1.1" style="font-size:90%;">Prediction</span><span class="ltx_text" id="S4.T4.7.1.1.6.1.2.1.2" style="font-size:90%;"> MRR</span>
</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S4.T4.7.2.2.1" style="background-color:#DFDFDF;"><span class="ltx_text ltx_font_bold" id="S4.T4.7.2.2.1.1" style="font-size:90%;background-color:#DFDFDF;">Variants of <span class="ltx_text ltx_font_smallcaps" id="S4.T4.7.2.2.1.1.1">IntentRec</span></span></th>
</tr>
<tr class="ltx_tr" id="S4.T4.7.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.7.3.3.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.3.3.1.1">
<tr class="ltx_tr" id="S4.T4.7.3.3.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.3.3.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T4.7.3.3.1.1.1.1.1" style="font-size:90%;">V0</span><span class="ltx_text" id="S4.T4.7.3.3.1.1.1.1.2" style="font-size:90%;">: next-item</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.3.3.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.3.3.1.1.2.1"><span class="ltx_text" id="S4.T4.7.3.3.1.1.2.1.1" style="font-size:90%;">prediction only</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.7.3.3.2"><span class="ltx_text" id="S4.T4.7.3.3.2.1" style="font-size:90%;">(+0.00%, +0.00%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.7.3.3.3"><span class="ltx_text" id="S4.T4.7.3.3.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.7.3.3.4"><span class="ltx_text" id="S4.T4.7.3.3.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.7.3.3.5"><span class="ltx_text" id="S4.T4.7.3.3.5.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.7.3.3.6"><span class="ltx_text" id="S4.T4.7.3.3.6.1" style="font-size:90%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.7.4.4.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.4.4.1.1">
<tr class="ltx_tr" id="S4.T4.7.4.4.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.4.4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.4.4.1.1.1.1.1" style="font-size:90%;">V3-only-ActionType</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.4.4.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.4.4.1.1.2.1"><span class="ltx_text" id="S4.T4.7.4.4.1.1.2.1.1" style="font-size:90%;">Prediction</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.4.4.2"><span class="ltx_text" id="S4.T4.7.4.4.2.1" style="font-size:90%;">(+7.73%, +5.93%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.4.4.3"><span class="ltx_text" id="S4.T4.7.4.4.3.1" style="font-size:90%;">+0.00%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.4.4.4"><span class="ltx_text" id="S4.T4.7.4.4.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.4.4.5"><span class="ltx_text" id="S4.T4.7.4.4.5.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.4.4.6"><span class="ltx_text" id="S4.T4.7.4.4.6.1" style="font-size:90%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.7.5.5.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.5.5.1.1">
<tr class="ltx_tr" id="S4.T4.7.5.5.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.5.5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.5.5.1.1.1.1.1" style="font-size:90%;">V3-only-Genre</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.5.5.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.5.5.1.1.2.1"><span class="ltx_text" id="S4.T4.7.5.5.1.1.2.1.1" style="font-size:90%;">Prediction</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.5.5.2"><span class="ltx_text" id="S4.T4.7.5.5.2.1" style="font-size:90%;">(+6.50%, +4.92%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.5.5.3"><span class="ltx_text" id="S4.T4.7.5.5.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.5.5.4"><span class="ltx_text" id="S4.T4.7.5.5.4.1" style="font-size:90%;">+0.00%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.5.5.5"><span class="ltx_text" id="S4.T4.7.5.5.5.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.5.5.6"><span class="ltx_text" id="S4.T4.7.5.5.6.1" style="font-size:90%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.7.6.6.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.6.6.1.1">
<tr class="ltx_tr" id="S4.T4.7.6.6.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.6.6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.6.6.1.1.1.1.1" style="font-size:90%;">V3-only-Movie/</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.6.6.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.6.6.1.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T4.7.6.6.1.1.2.1.1" style="font-size:90%;">Show</span><span class="ltx_text" id="S4.T4.7.6.6.1.1.2.1.2" style="font-size:90%;"> Prediction</span>
</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.6.6.2"><span class="ltx_text" id="S4.T4.7.6.6.2.1" style="font-size:90%;">(+6.52%, +4.53%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.6.6.3"><span class="ltx_text" id="S4.T4.7.6.6.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.6.6.4"><span class="ltx_text" id="S4.T4.7.6.6.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.6.6.5"><span class="ltx_text" id="S4.T4.7.6.6.5.1" style="font-size:90%;">+0.00%</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.6.6.6"><span class="ltx_text" id="S4.T4.7.6.6.6.1" style="font-size:90%;">N/A</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.7.7.7.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.7.7.1.1">
<tr class="ltx_tr" id="S4.T4.7.7.7.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.7.7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.1.1.1.1.1" style="font-size:90%;">V3-only-Time-since</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.7.7.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.7.7.1.1.2.1">
<span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.1.1.2.1.1" style="font-size:90%;">-release</span><span class="ltx_text" id="S4.T4.7.7.7.1.1.2.1.2" style="font-size:90%;"> Prediction</span>
</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.7.7.2"><span class="ltx_text" id="S4.T4.7.7.7.2.1" style="font-size:90%;">(+7.18%, +5.65%)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.7.7.3"><span class="ltx_text" id="S4.T4.7.7.7.3.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.7.7.4"><span class="ltx_text" id="S4.T4.7.7.7.4.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.7.7.5"><span class="ltx_text" id="S4.T4.7.7.7.5.1" style="font-size:90%;">N/A</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.7.7.7.6"><span class="ltx_text" id="S4.T4.7.7.7.6.1" style="font-size:90%;">+0.00%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S4.T4.7.8.8.1" style="background-color:#FFBFBF;"><span class="ltx_text ltx_font_bold" id="S4.T4.7.8.8.1.1" style="font-size:90%;background-color:#FFBFBF;">Proposed Method</span></th>
</tr>
<tr class="ltx_tr" id="S4.T4.7.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_l ltx_border_r" id="S4.T4.7.9.9.1">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.9.9.1.1">
<tr class="ltx_tr" id="S4.T4.7.9.9.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.9.9.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T4.7.9.9.1.1.1.1.1" style="font-size:90%;">V3-all</span><span class="ltx_text" id="S4.T4.7.9.9.1.1.1.1.2" style="font-size:90%;">:</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.7.9.9.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.9.9.1.1.2.1"><span class="ltx_text" id="S4.T4.7.9.9.1.1.2.1.1" style="font-size:90%;">all prediction heads</span></td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.7.9.9.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.9.9.2.1">
<tr class="ltx_tr" id="S4.T4.7.9.9.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.9.9.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.9.9.2.1.1.1.1" style="font-size:90%;">(+8.35%, +6.87%)</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.7.9.9.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.9.9.3.1">
<tr class="ltx_tr" id="S4.T4.7.9.9.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.9.9.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.9.9.3.1.1.1.1" style="font-size:90%;">+0.11%</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.7.9.9.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.9.9.4.1">
<tr class="ltx_tr" id="S4.T4.7.9.9.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.9.9.4.1.1.1"><span class="ltx_text" id="S4.T4.7.9.9.4.1.1.1.1" style="font-size:90%;">-0.39%</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.7.9.9.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.9.9.5.1">
<tr class="ltx_tr" id="S4.T4.7.9.9.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.9.9.5.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.9.9.5.1.1.1.1" style="font-size:90%;">+0.23%</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.7.9.9.6">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.7.9.9.6.1">
<tr class="ltx_tr" id="S4.T4.7.9.9.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T4.7.9.9.6.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.7.9.9.6.1.1.1.1" style="font-size:90%;">+0.63%</span></td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4. </span>Implementation Details and Hyperparameters</h4>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.13"><span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS4.p1.13.1">IntentRec</span> is developed in Python and Tensorflow with Keras and tested in the Amazon EC2 P3 machine with 8 Testla-V100 GPUs (16GB memory). We cannot release the code and dataset used in IntentRec due to the proprietary nature of those artifacts. Hyperparameters of <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS4.p1.13.2">IntentRec</span> are tuned by grid searches on the validation data; specifically, the maximum sequence length <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.1.m1.1"><semantics id="S4.SS1.SSS4.p1.1.m1.1a"><mi id="S4.SS1.SSS4.p1.1.m1.1.1" xref="S4.SS1.SSS4.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.1.m1.1b"><ci id="S4.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS4.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.1.m1.1d">italic_n</annotation></semantics></math> is set to 100, the dimensions of interaction feature, short-term embedding, and intent representation are set to <math alttext="523" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.2.m2.1"><semantics id="S4.SS1.SSS4.p1.2.m2.1a"><mn id="S4.SS1.SSS4.p1.2.m2.1.1" xref="S4.SS1.SSS4.p1.2.m2.1.1.cmml">523</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.2.m2.1b"><cn id="S4.SS1.SSS4.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.2.m2.1.1">523</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.2.m2.1c">523</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.2.m2.1d">523</annotation></semantics></math>, <math alttext="200" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.3.m3.1"><semantics id="S4.SS1.SSS4.p1.3.m3.1a"><mn id="S4.SS1.SSS4.p1.3.m3.1.1" xref="S4.SS1.SSS4.p1.3.m3.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.3.m3.1b"><cn id="S4.SS1.SSS4.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.3.m3.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.3.m3.1c">200</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.3.m3.1d">200</annotation></semantics></math>, <math alttext="200" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.4.m4.1"><semantics id="S4.SS1.SSS4.p1.4.m4.1a"><mn id="S4.SS1.SSS4.p1.4.m4.1.1" xref="S4.SS1.SSS4.p1.4.m4.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.4.m4.1b"><cn id="S4.SS1.SSS4.p1.4.m4.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.4.m4.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.4.m4.1c">200</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.4.m4.1d">200</annotation></semantics></math>, respectively, and the output dimensions of the Transformer intent and item encoder are set to <math alttext="600" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.5.m5.1"><semantics id="S4.SS1.SSS4.p1.5.m5.1a"><mn id="S4.SS1.SSS4.p1.5.m5.1.1" xref="S4.SS1.SSS4.p1.5.m5.1.1.cmml">600</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.5.m5.1b"><cn id="S4.SS1.SSS4.p1.5.m5.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.5.m5.1.1">600</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.5.m5.1c">600</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.5.m5.1d">600</annotation></semantics></math> and <math alttext="800" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.6.m6.1"><semantics id="S4.SS1.SSS4.p1.6.m6.1a"><mn id="S4.SS1.SSS4.p1.6.m6.1.1" xref="S4.SS1.SSS4.p1.6.m6.1.1.cmml">800</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.6.m6.1b"><cn id="S4.SS1.SSS4.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.6.m6.1.1">800</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.6.m6.1c">800</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.6.m6.1d">800</annotation></semantics></math>. Each Transformer consists of two encoder layers equipped with a <math alttext="512" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.7.m7.1"><semantics id="S4.SS1.SSS4.p1.7.m7.1a"><mn id="S4.SS1.SSS4.p1.7.m7.1.1" xref="S4.SS1.SSS4.p1.7.m7.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.7.m7.1b"><cn id="S4.SS1.SSS4.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.7.m7.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.7.m7.1c">512</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.7.m7.1d">512</annotation></semantics></math>-dimensional fully connected layer and <math alttext="8" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.8.m8.1"><semantics id="S4.SS1.SSS4.p1.8.m8.1a"><mn id="S4.SS1.SSS4.p1.8.m8.1.1" xref="S4.SS1.SSS4.p1.8.m8.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.8.m8.1b"><cn id="S4.SS1.SSS4.p1.8.m8.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.8.m8.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.8.m8.1c">8</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.8.m8.1d">8</annotation></semantics></math> attention heads. We also use timestamp-based positional encoding for the Transformer encoder.
We train <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.SSS4.p1.13.3">IntentRec</span> with Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib23" title="">2015</a>)</cite> optimizer for <math alttext="10" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.9.m9.1"><semantics id="S4.SS1.SSS4.p1.9.m9.1a"><mn id="S4.SS1.SSS4.p1.9.m9.1.1" xref="S4.SS1.SSS4.p1.9.m9.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.9.m9.1b"><cn id="S4.SS1.SSS4.p1.9.m9.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.9.m9.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.9.m9.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.9.m9.1d">10</annotation></semantics></math> epochs with a learning rate: <math alttext="0.0005" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.10.m10.1"><semantics id="S4.SS1.SSS4.p1.10.m10.1a"><mn id="S4.SS1.SSS4.p1.10.m10.1.1" xref="S4.SS1.SSS4.p1.10.m10.1.1.cmml">0.0005</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.10.m10.1b"><cn id="S4.SS1.SSS4.p1.10.m10.1.1.cmml" type="float" xref="S4.SS1.SSS4.p1.10.m10.1.1">0.0005</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.10.m10.1c">0.0005</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.10.m10.1d">0.0005</annotation></semantics></math> and batch size: <math alttext="1024" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.11.m11.1"><semantics id="S4.SS1.SSS4.p1.11.m11.1a"><mn id="S4.SS1.SSS4.p1.11.m11.1.1" xref="S4.SS1.SSS4.p1.11.m11.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.11.m11.1b"><cn id="S4.SS1.SSS4.p1.11.m11.1.1.cmml" type="integer" xref="S4.SS1.SSS4.p1.11.m11.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.11.m11.1c">1024</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.11.m11.1d">1024</annotation></semantics></math>. The intent prediction coefficient <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.12.m12.1"><semantics id="S4.SS1.SSS4.p1.12.m12.1a"><mi id="S4.SS1.SSS4.p1.12.m12.1.1" xref="S4.SS1.SSS4.p1.12.m12.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.12.m12.1b"><ci id="S4.SS1.SSS4.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS4.p1.12.m12.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.12.m12.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.12.m12.1d">italic_λ</annotation></semantics></math> is set to <math alttext="1.0" class="ltx_Math" display="inline" id="S4.SS1.SSS4.p1.13.m13.1"><semantics id="S4.SS1.SSS4.p1.13.m13.1a"><mn id="S4.SS1.SSS4.p1.13.m13.1.1" xref="S4.SS1.SSS4.p1.13.m13.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS4.p1.13.m13.1b"><cn id="S4.SS1.SSS4.p1.13.m13.1.1.cmml" type="float" xref="S4.SS1.SSS4.p1.13.m13.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS4.p1.13.m13.1c">1.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS4.p1.13.m13.1d">1.0</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Next Item and Intent Prediction Accuracy</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The golden metric to measure the effectiveness of <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.1.1">IntentRec</span> is how much it improves the next-item prediction accuracy via utilizing intent prediction results, compared to baselines.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.T2" title="In 4.1.1. Dataset ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a>, <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.1">IntentRec</span> presents the highest next-item prediction accuracy across all baselines, as per both MRR and WMRR metrics. Remarkably, <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.2">IntentRec</span> outperforms the best baselines: <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.3">TransAct</span> and <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.4">IntentRec</span>-V0; for instance, <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.5">IntentRec</span> shows <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.6">7.4%</span> and <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.7">5.6%</span> improvements in MRR and WMRR compared to <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.8">TransAct</span> with <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.9">statistical significance</span> (p-values from Student’s t-test <math alttext="&lt;0.01" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">&lt;</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><lt id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">absent</csymbol><cn id="S4.SS2.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS2.p2.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">&lt;0.01</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">&lt; 0.01</annotation></semantics></math>).
Regarding baselines, they all exhibit limited next-item prediction performance as they cannot predict users’ intents (marked as N/A in the table) or incorporate the user intents to the next-item prediction directly.
<span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.10">TransAct</span> <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib55" title="">2023</a>)</cite> and <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.1.11">IntentRec</span>-V0 show relatively higher accuracy than other baselines as they can leverage interaction metadata, while other baselines do not incorporate interaction metadata due to their architectural limitations.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.3"><span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p3.3.1">IntentRec</span> also shows superior prediction performance of user intents among all methods; <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p3.3.2">IntentRec</span> shows the highest MRR values across all intent prediction tasks (e.g., Action Type). However, the intent prediction accuracy improvements are smaller than the next-item prediction ones as the hierarchical learning of <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p3.3.3">IntentRec</span> prioritizes to optimize next-item prediction over next-intent predictions; in other words, the intent predictor of <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p3.3.4">IntentRec</span> can be fine-tuned to find the optimal solutions for next-item prediction, not for next-intent prediction. This trade-off can be moderated by changing the intent prediction coefficient <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_λ</annotation></semantics></math> during the training (i.e., larger <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_λ</annotation></semantics></math> focuses more on intent prediction).
Refer to <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S5.F8" title="In 5. Discussion ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a> for the impact of different <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_λ</annotation></semantics></math> values on item and intent predictions.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Ablation Studies of <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.1.1">IntentRec</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We conduct ablation studies of <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.1">IntentRec</span> with respect to its model architecture and different intent prediction heads.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.T3" title="In 4.1.3. Evaluation Metrics ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a> shows how each architectural component of <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.1">IntentRec</span> improves the next-item and next-intent prediction performance. The first version (V1) is extending <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p2.1.2">IntentRec</span>-V0 to multi-task learning setting using extra intent prediction heads. While it exhibits competitive intent prediction accuracy, its item-ID prediction accuracy is almost close to the existing model. One potential reason is that intent predictions do not affect the next-item prediction directly. Those predictions are connected together via the shared Transformer encoder; however, intent prediction results should be directly fed to the next-item predictor to improve the prediction accuracy. Based on this intuition, the second version (V2) uses two Transformer encoders to perform intent and item predictions separately. The V2 model also leverages hierarchical learning which performs the intent prediction first and item prediction next with the intent prediction results. It leads to significant improvements in next-item prediction. The final version (V3) adds short-term interest features to the V2 model, where we define the short-term as interactions happening within 1-week or 1-month from the current timestamp. While both thresholds are reasonable as per prediction accuracy, we choose the 1-week threshold considering the business value and consistency with the current company policy.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.T4" title="In 4.1.3. Evaluation Metrics ‣ 4.1. Experimental Setup ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">4</span></a> indicates the contribution of an individual intent prediction head used in <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p3.1.1">IntentRec</span> to its prediction performance. While all variants outperform <span class="ltx_text ltx_font_smallcaps" id="S4.SS3.p3.1.2">IntentRec</span>-V0, predicting the Action Type label is the most important task among all, as per next-item prediction accuracy. It is intuitive since the user interactions are classified into 11 unique “Action Type” labels by a business-aware heuristic, which can be a direct translation of a user’s latent intent.
Time-since-release prediction is also crucial since certain users tend to engage with newly released shows/movies more frequently than other users.
Genre and Movie/Show predictions are less helpful than the others, but they still have downstream applications and business values. Using all prediction heads together (V3-all), it leads to the best performance with respect to intent and item predictions.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Qualitative Analysis: User Intent Clustering</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Given a user and her previous interactions, <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.1">IntentRec</span> is able to predict this user’s current intent and generate an intent embedding by aggregating auxiliary prediction results (e.g., Action Type, Genre) via an attention layer. We conduct a qualitative analysis of user intent embeddings to validate their quality and accuracy. Specifically, we apply K-means++ <cite class="ltx_cite ltx_citemacro_citep">(Arthur and Vassilvitskii, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib3" title="">2007</a>)</cite> clustering algorithm on intent embeddings of all users in the training data where the number of clusters (K) is set to 10. For each found cluster, we randomly sample a few users (e.g., 10) close to the cluster center on the embedding space. After that, we manually investigate the similarities between chosen users and determine the concept of the intent cluster (e.g., binge-watchers) by the commonalities between users.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.F6" title="In 4.4. Qualitative Analysis: User Intent Clustering ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a> represents 10 unique clusters of user intent embeddings obtained by <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p2.1.1">IntentRec</span>. We use T-SNE <cite class="ltx_cite ltx_citemacro_citep">(Van der Maaten and Hinton, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib50" title="">2008</a>)</cite> algorithm to visualize the high-dimensional intent embeddings to a two-dimensional image. Each colored dot in the figure indicates a randomly-sampled user close to each cluster center. We can find unique and meaningful user clusters that share a similar intent. For instance, there are two distinctive user groups that enjoy discovering new content vs continue-watching recent/favorite content.
There is also an anime/kids genre enthusiast group where most of their interactions are from anime and kids genres. These examples imply user intent embeddings obtained by <span class="ltx_text ltx_font_smallcaps" id="S4.SS4.p2.1.2">IntentRec</span> are accurate.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="557" id="S4.F6.g1" src="extracted/5755931/figs/intent_embedding_clustering.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.4.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S4.F6.5.2" style="font-size:90%;">K-means++ (K=10) clustering of user intent embeddings found by <span class="ltx_text ltx_font_smallcaps" id="S4.F6.5.2.1">IntentRec</span>; T-SNE <cite class="ltx_cite ltx_citemacro_citep">(Van der Maaten and Hinton, <a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#bib.bib50" title="">2008</a>)</cite> is used for visualization.
<span class="ltx_text ltx_font_smallcaps" id="S4.F6.5.2.2">IntentRec</span> finds unique clusters of users that share the similar intent.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Qualitative Analysis: Attention Weights</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">The attention layer in our intent predictor (<a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S3.F4" title="In 3.3. User Intent Prediction ‣ 3. Proposed Method ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>) generates importance weights of each intent prediction head (i.e., <math alttext="\alpha_{\text{intent}_{i}}" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><msub id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml"><mi id="S4.SS5.p1.1.m1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.2.cmml">α</mi><msub id="S4.SS5.p1.1.m1.1.1.3" xref="S4.SS5.p1.1.m1.1.1.3.cmml"><mtext id="S4.SS5.p1.1.m1.1.1.3.2" xref="S4.SS5.p1.1.m1.1.1.3.2a.cmml">intent</mtext><mi id="S4.SS5.p1.1.m1.1.1.3.3" xref="S4.SS5.p1.1.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.1.m1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.p1.1.m1.1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.1.2">𝛼</ci><apply id="S4.SS5.p1.1.m1.1.1.3.cmml" xref="S4.SS5.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS5.p1.1.m1.1.1.3.1.cmml" xref="S4.SS5.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS5.p1.1.m1.1.1.3.2a.cmml" xref="S4.SS5.p1.1.m1.1.1.3.2"><mtext id="S4.SS5.p1.1.m1.1.1.3.2.cmml" mathsize="70%" xref="S4.SS5.p1.1.m1.1.1.3.2">intent</mtext></ci><ci id="S4.SS5.p1.1.m1.1.1.3.3.cmml" xref="S4.SS5.p1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\alpha_{\text{intent}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">italic_α start_POSTSUBSCRIPT intent start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>), given a user’s historical interactions.
These weights are personalized since they are computed based on the interaction feature sequence of each user.
We can define a user’s <span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.1">primary intent</span> by investigating the highest value of attention weights of this user.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S4.F7" title="In 4.5. Qualitative Analysis: Attention Weights ‣ 4. Experiments ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a> shows two user profiles whose primary intents are “fantasy genre” and “old-fashioned content”, respectively. The first user’s attention weight for genre prediction (0.52) is the highest among all weights, which indicates this user’s predicted intent is mainly related to watching specific genres. As expected, the user’s interactions mostly consist of fantasy shows/movies (Teen Wolf and Harry Potter), and <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p2.1.1">IntentRec</span> provides relevant fantasy-genre recommendations by capturing the primary intent of the user.
On the other hand, <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p2.1.2">IntentRec</span> interprets the second user’s primary intent as watching old-fashioned content, since her attention weight for the time-since-release prediction is the highest. This intent prediction also aligns well with the historical interactions of the second user.</p>
</div>
<div class="ltx_para" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1">We note that these personalized attention weights can be updated real-time in online recommendation setup using the inference mode of the latest trained model of <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p3.1.1">IntentRec</span>, while the full model training can be done regularly (e.g., every week).
These real-time attention weights can be used as numerical evidence for explaining our intent prediction results to users and other downstream applications (e.g., search optimization).</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="441" id="S4.F7.g1" src="extracted/5755931/figs/attention_analysis.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F7.3.1.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S4.F7.4.2" style="font-size:90%;">Attention weights of intent prediction heads for two distinctive users. Based on a user’s profile, <span class="ltx_text ltx_font_smallcaps" id="S4.F7.4.2.1">IntentRec</span> finds personalized attention weights and provides relevant recommendations.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Discussion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Generalizability on Other Domains.</span>
Although <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.2">IntentRec</span> is tailored to Netflix, the user intent definition and prediction can be adjusted for other domains such as E-commerce. We design our methodology to be highly generalizable so that it can be applied to diverse domains. For instance, <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.3">IntentRec</span> can employ both common information (e.g., timestamp) and domain-specific metadata (e.g., genre or item taxonomy) as features, while leveraging the corresponding engagements in the product (e.g. click or purchase for e-commerce). Moreover, the user intent can be defined in coarse-grained (i.e., fewer intent labels) and fine-grained ways (i.e., many intent labels) depending on the domain needs. Exploring the empirical transferability of <span class="ltx_text ltx_font_smallcaps" id="S5.p1.1.4">IntentRec</span> to other domains will be the future work.
Additionally, getting access to such rich information about other domains is challenging, due to obvious data privacy reasons. Hence, we share the performance of our proposed approach only on one domain but as mentioned above, nothing in the model architecture makes any domain specific assumption, hence, it should be extensible to other domains.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Contradictory Predictions between Intent and Item Predictors.</span>
One might ask what if the predictions of the intent and item predictions tasks are contradictory. For instance, the result of intent prediction is ‘watching a movie’, whereas the predicted next item is a TV show.
We conducted the prediction alignment analysis (e.g., see Fig. 4), and we found that user intent clusters are aligned well with the users’ interactions (e.g., next item) in most cases. Even if the predictions do not align, it can be legitimate since the user preference can be suddenly shifted. For instance, on Netflix, a user originally wanted to watch movies but got drawn to the latest TV show and ended up watching the TV show.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Computational overhead of Hierarchical MTL.</span>
The main computational bottleneck of <span class="ltx_text ltx_font_smallcaps" id="S5.p3.1.2">IntentRec</span> is the item predictor, since the total number of items (e.g., 35K) for predictions is much larger than the number of prediction labels for each intent (e.g., 2-20). Thus, the computational overhead from the input feature sequence formation and intent prediction module is marginal, compared to the next-item prediction cost.
Investigating the optimization techniques for fast and scalable training is our future work.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Downstream Application.</span>
One of the advantages of our proposed user session intent model is that the intents themselves are interpretable and can be directly associated with a member’s need. Hence, it opens up a plethora of applications, such as User Interface (UI) optimization, analytics, and signals into various downstream ML models for personalization and recommendations.
For example, we can use <span class="ltx_text ltx_font_smallcaps" id="S5.p4.1.2">IntentRec</span> to nudge members with explicit UI interventions to hone in or pivot a user based on the model’s prediction of user session intent. We can also directly use this model to replace the current next-item prediction model, as we have shown in the results that our approach outperforms the current model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p5">
<p class="ltx_p" id="S5.p5.1"><span class="ltx_text ltx_font_bold" id="S5.p5.1.1">Hyperparameter Sensitivity.</span>
The key hyperparameters of <span class="ltx_text ltx_font_smallcaps" id="S5.p5.1.2">IntentRec</span> include the intent prediction strength <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.p5.1.m1.1"><semantics id="S5.p5.1.m1.1a"><mi id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><ci id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.p5.1.m1.1d">italic_λ</annotation></semantics></math>, embedding dimensions of the intent prediction and short-term interest feature, and the output dimension of the Transformer item encoder. We test how much the prediction accuracy of <span class="ltx_text ltx_font_smallcaps" id="S5.p5.1.3">IntentRec</span> changes if we vary the values of key hyperparameters.</p>
</div>
<div class="ltx_para" id="S5.p6">
<p class="ltx_p" id="S5.p6.1"><a class="ltx_ref" href="https://arxiv.org/html/2408.05353v1#S5.F8" title="In 5. Discussion ‣ IntentRec: Predicting User Session Intent with Hierarchical Multi-Task Learning"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">8</span></a> shows hyperparameter sensitivity results of <span class="ltx_text ltx_font_smallcaps" id="S5.p6.1.1">IntentRec</span> on validation data, as per item and genre prediction MRR metrics.
We omit the other intent prediction metrics such as Action Type or Movie/Show since they remain similar accuracy across different hyperparameters.
Strong emphasis on intent prediction (e.g., <math alttext="\lambda=1.0" class="ltx_Math" display="inline" id="S5.p6.1.m1.1"><semantics id="S5.p6.1.m1.1a"><mrow id="S5.p6.1.m1.1.1" xref="S5.p6.1.m1.1.1.cmml"><mi id="S5.p6.1.m1.1.1.2" xref="S5.p6.1.m1.1.1.2.cmml">λ</mi><mo id="S5.p6.1.m1.1.1.1" xref="S5.p6.1.m1.1.1.1.cmml">=</mo><mn id="S5.p6.1.m1.1.1.3" xref="S5.p6.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.1.m1.1b"><apply id="S5.p6.1.m1.1.1.cmml" xref="S5.p6.1.m1.1.1"><eq id="S5.p6.1.m1.1.1.1.cmml" xref="S5.p6.1.m1.1.1.1"></eq><ci id="S5.p6.1.m1.1.1.2.cmml" xref="S5.p6.1.m1.1.1.2">𝜆</ci><cn id="S5.p6.1.m1.1.1.3.cmml" type="float" xref="S5.p6.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.1.m1.1c">\lambda=1.0</annotation><annotation encoding="application/x-llamapun" id="S5.p6.1.m1.1d">italic_λ = 1.0</annotation></semantics></math>) leads to both high item and intent prediction accuracy, as accurate intent prediction would act as a crucial hint for the item prediction.
Regarding the embedding dimensions of the intent prediction and short-term interest feature, both intent and item accuracy do not change significantly across different values. As a large embedding dimension can slow down the training process, a medium value (e.g., 200) are recommended.
Finally, the output dimension of the Transformer item encoder can directly affect the final performance of <span class="ltx_text ltx_font_smallcaps" id="S5.p6.1.2">IntentRec</span>, as the item prediction is our primary task.
If the main focus is faster training and inference, a small output dimension (e.g., 400) is recommended. A large output dimension (e.g., 800) is needed to achieve the highest accuracy of <span class="ltx_text ltx_font_smallcaps" id="S5.p6.1.3">IntentRec</span> or obtain precise model parameters for downstream applications.
We also conducted studies about embedding dimensions of different metadata, and in fact, embedding dimensions do not have a significant impact on the next-item prediction performance. Surprisingly, some of our most impactful features are just scalars (e.g., timestamps).</p>
</div>
<figure class="ltx_figure" id="S5.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="155" id="S5.F8.1.g1" src="extracted/5755931/figs/hyperparameter_lambda.png" width="165"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="148" id="S5.F8.2.g1" src="extracted/5755931/figs/hyperparameter_intent_emb_dim.png" width="165"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="149" id="S5.F8.3.g1" src="extracted/5755931/figs/hyperparameter_short_term_emb_dim.png" width="165"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="149" id="S5.F8.4.g1" src="extracted/5755931/figs/hyperparameter_transformer_item_dim.png" width="165"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="32" id="S5.F8.g1" src="extracted/5755931/figs/hyperparameter_label.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F8.7.1.1" style="font-size:90%;">Figure 8</span>. </span><span class="ltx_text ltx_font_italic" id="S5.F8.8.2" style="font-size:90%;">Hyperparameter sensitivity of <span class="ltx_text ltx_font_smallcaps" id="S5.F8.8.2.1">IntentRec</span>.<span class="ltx_text ltx_font_upright" id="S5.F8.8.2.2">
</span></span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We proposed a novel recommendation framework: <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">IntentRec</span> that can predict a user’s latent session intent and enhance next-item prediction by leveraging the intent prediction result.
The hierarchical multi-task learning allows <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.2">IntentRec</span> to predict and exploit the user intent efficiently for personalized and accurate recommendations. Our extensive experiments on the Netflix user engagement dataset demonstrate the usefulness of user intent prediction for various applications.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Future work of <span class="ltx_text ltx_font_smallcaps" id="S6.p2.1.1">IntentRec</span> includes (1) scaling up and optimizing the training of <span class="ltx_text ltx_font_smallcaps" id="S6.p2.1.2">IntentRec</span> in multi-GPU and distributed computing settings, (2) real-time updates of user intent and item embeddings, and (3) incorporating large language models (LLMs) into <span class="ltx_text ltx_font_smallcaps" id="S6.p2.1.3">IntentRec</span> for more comprehensive next intent and item predictions.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amatriain and Basilico (2015)</span>
<span class="ltx_bibblock">
Xavier Amatriain and Justin Basilico. 2015.

</span>
<span class="ltx_bibblock">Recommender systems in industry: A netflix case study.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Recommender systems handbook</em>. Springer, 385–419.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arthur and Vassilvitskii (2007)</span>
<span class="ltx_bibblock">
David Arthur and Sergei Vassilvitskii. 2007.

</span>
<span class="ltx_bibblock">K-means++ the advantages of careful seeding. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the eighteenth annual ACM-SIAM symposium on Discrete algorithms</em>. 1027–1035.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beutel et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Alex Beutel, Paul Covington, Sagar Jain, Can Xu, Jia Li, Vince Gatto, and Ed H Chi. 2018.

</span>
<span class="ltx_bibblock">Latent cross: Making use of context in recurrent recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the eleventh ACM international conference on web search and data mining</em>. 46–54.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhattacharya and Lamkhede (2022)</span>
<span class="ltx_bibblock">
Moumita Bhattacharya and Sudarshan Lamkhede. 2022.

</span>
<span class="ltx_bibblock">Augmenting Netflix Search with In-Session Adapted Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>. 542–545.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Tong Chen, Hongzhi Yin, Hongxu Chen, Rui Yan, Quoc Viet Hung Nguyen, and Xue Li. 2019.

</span>
<span class="ltx_bibblock">Air: Attentional intention-aware recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">2019 IEEE 35th International Conference on Data Engineering (ICDE)</em>. IEEE, 304–315.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yongjun Chen, Zhiwei Liu, Jia Li, Julian McAuley, and Caiming Xiong. 2022.

</span>
<span class="ltx_bibblock">Intent contrastive learning for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the ACM Web Conference 2022</em>. 2172–2182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Kyunghyun Cho, Bart van Merriënboer, Caglar Gulcehre, Dzmitry Bahdanau, Fethi Bougares, Holger Schwenk, and Yoshua Bengio. 2014.

</span>
<span class="ltx_bibblock">Learning Phrase Representations using RNN Encoder–Decoder for Statistical Machine Translation. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>. 1724–1734.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Craswell (2009)</span>
<span class="ltx_bibblock">
Nick Craswell. 2009.

</span>
<span class="ltx_bibblock">Mean Reciprocal Rank.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Encyclopedia of database systems</em> 1703 (2009).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yujuan Ding, Yunshan Ma, Wai Keung Wong, and Tat-Seng Chua. 2021.

</span>
<span class="ltx_bibblock">Modeling instant user intent and content-level transition for sequential fashion recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">IEEE Transactions on Multimedia</em> 24 (2021), 2687–2700.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Jianping Fan, Tianyi Zhao, Zhenzhong Kuang, Yu Zheng, Ji Zhang, Jun Yu, and Jinye Peng. 2017.

</span>
<span class="ltx_bibblock">HD-MTL: Hierarchical deep multi-task learning for large-scale visual recognition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">IEEE transactions on image processing</em> 26, 4 (2017), 1923–1938.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shaohua Fan, Junxiong Zhu, Xiaotian Han, Chuan Shi, Linmei Hu, Biyu Ma, and Yongliang Li. 2019.

</span>
<span class="ltx_bibblock">Metapath-guided heterogeneous graph neural network for intent recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 2478–2486.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ziwei Fan, Zhiwei Liu, Yu Wang, Alice Wang, Zahra Nazari, Lei Zheng, Hao Peng, and Philip S Yu. 2022.

</span>
<span class="ltx_bibblock">Sequential recommendation via stochastic self-attention. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the ACM Web Conference 2022</em>. 2036–2047.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chen Gao, Xiangnan He, Dahua Gan, Xiangning Chen, Fuli Feng, Yong Li, Tat-Seng Chua, and Depeng Jin. 2019.

</span>
<span class="ltx_bibblock">Neural multi-task recommendation from multi-behavior data. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">2019 IEEE 35th international conference on data engineering (ICDE)</em>. IEEE, 1554–1557.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gomez-Uribe and Hunt (2015)</span>
<span class="ltx_bibblock">
Carlos A Gomez-Uribe and Neil Hunt. 2015.

</span>
<span class="ltx_bibblock">The netflix recommender system: Algorithms, business value, and innovation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">ACM Transactions on Management Information Systems (TMIS)</em> 6, 4 (2015), 1–19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jiayan Guo, Yaming Yang, Xiangchen Song, Yuan Zhang, Yujing Wang, Jing Bai, and Yan Zhang. 2022.

</span>
<span class="ltx_bibblock">Learning multi-granularity consecutive user intent unit for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the fifteenth ACM International conference on web search and data mining</em>. 343–352.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hadash et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guy Hadash, Oren Sar Shalom, and Rita Osadchy. 2018.

</span>
<span class="ltx_bibblock">Rank and rate: multi-task learning for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 12th ACM Conference on Recommender Systems</em>. 451–454.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber. 1997.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Neural computation</em> 9, 8 (1997), 1735–1780.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jin Huang, Wayne Xin Zhao, Hongjian Dou, Ji-Rong Wen, and Edward Y Chang. 2018.

</span>
<span class="ltx_bibblock">Improving sequential recommendation with knowledge-enhanced memory networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">The 41st international ACM SIGIR conference on research &amp; development in information retrieval</em>. 505–514.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jannach and Jugovac (2019)</span>
<span class="ltx_bibblock">
Dietmar Jannach and Michael Jugovac. 2019.

</span>
<span class="ltx_bibblock">Measuring the business value of recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">ACM Transactions on Management Information Systems (TMIS)</em> 10, 4 (2019), 1–23.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Di Jin, Luzhi Wang, Yizhen Zheng, Guojie Song, Fei Jiang, Xiang Li, Wei Lin, and Shirui Pan. 2023.

</span>
<span class="ltx_bibblock">Dual intent enhanced graph neural network for session-based new item recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the ACM Web Conference 2023</em>. 684–693.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">2018 IEEE International Conference on Data Mining (ICDM)</em>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)</span>
<span class="ltx_bibblock">
Diederik Kingma and Jimmy Ba. 2015.

</span>
<span class="ltx_bibblock">Adam: A Method for Stochastic Optimization. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">International Conference on Learning Representations (ICLR)</em>. San Diega, CA, USA.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chao Li, Zhiyuan Liu, Mengmeng Wu, Yuchi Xu, Huan Zhao, Pipei Huang, Guoliang Kang, Qiwei Chen, Wei Li, and Dik Lun Lee. 2019.

</span>
<span class="ltx_bibblock">Multi-interest network with dynamic routing for recommendation at Tmall. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 2615–2623.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Haoyang Li, Xin Wang, Ziwei Zhang, Jianxin Ma, Peng Cui, and Wenwu Zhu. 2021.

</span>
<span class="ltx_bibblock">Intention-aware sequential recommendation with structured intent transition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">IEEE Transactions on Knowledge and Data Engineering</em> 34, 11 (2021), 5403–5414.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiacheng Li, Yujie Wang, and Julian McAuley. 2020.

</span>
<span class="ltx_bibblock">Time interval aware self-attention for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the 13th international conference on web search and data mining</em>. 322–330.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yinfeng Li, Chen Gao, Hengliang Luo, Depeng Jin, and Yong Li. 2022.

</span>
<span class="ltx_bibblock">Enhancing hypergraph neural networks with intent disentanglement for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the 45th international ACM SIGIR conference on research and development in information retrieval</em>. 1997–2002.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lim et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Nicholas Lim, Bryan Hooi, See-Kiong Ng, Yong Liang Goh, Renrong Weng, and Rui Tan. 2022.

</span>
<span class="ltx_bibblock">Hierarchical Multi-Task Graph Recurrent Network for Next POI Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Qiao Liu, Yifu Zeng, Refuoe Mokhosi, and Haibin Zhang. 2018.

</span>
<span class="ltx_bibblock">STAMP: short-term attention/memory priority model for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1831–1839.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhaoyang Liu, Haokun Chen, Fei Sun, Xu Xie, Jinyang Gao, Bolin Ding, and Yanyan Shen. 2021.

</span>
<span class="ltx_bibblock">Intent preference decoupling for user representation on online recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Proceedings of the Twenty-Ninth International Conference on International Joint Conferences on Artificial Intelligence</em>. 2575–2582.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Zhiwei Liu, Xiaohan Li, Ziwei Fan, Stephen Guo, Kannan Achan, and S Yu Philip. 2020.

</span>
<span class="ltx_bibblock">Basket recommendation with multi-intent translation graph neural network. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">2020 IEEE International Conference on Big Data (Big Data)</em>. IEEE, 728–737.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jianxin Ma, Chang Zhou, Hongxia Yang, Peng Cui, Xin Wang, and Wenwu Zhu. 2020.

</span>
<span class="ltx_bibblock">Disentangled self-supervision in sequential recommenders. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 483–491.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen and Okatani (2019)</span>
<span class="ltx_bibblock">
Duy-Kien Nguyen and Takayuki Okatani. 2019.

</span>
<span class="ltx_bibblock">Multi-Task Learning of Hierarchical Vision-Language Representation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em> (2019), 10484–10493.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Sejoon Oh, Ankur Bhardwaj, Jongseok Han, Sungchul Kim, Ryan A Rossi, and Srijan Kumar. 2022a.

</span>
<span class="ltx_bibblock">Implicit session contexts for next-item recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em>. 4364–4368.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Sejoon Oh, Walid Shalaby, Amir Afsharinejad, and Xiquan Cui. 2023.

</span>
<span class="ltx_bibblock">Hierarchical Multi-Task Learning Framework for Session-based Recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">arXiv preprint arXiv:2309.06533</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Sejoon Oh, Berk Ustun, Julian McAuley, and Srijan Kumar. 2022b.

</span>
<span class="ltx_bibblock">Rank list sensitivity of recommender systems to interaction perturbations. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em>. 1584–1594.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pal et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Aditya Pal, Chantat Eksombatchai, Yitong Zhou, Bo Zhao, Charles Rosenberg, and Jure Leskovec. 2020.

</span>
<span class="ltx_bibblock">Pinnersage: Multi-modal user embedding framework for recommendations at pinterest. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 2311–2320.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Zhiqiang Pan, Fei Cai, Yanxiang Ling, and Maarten de Rijke. 2020.

</span>
<span class="ltx_bibblock">An intent-guided collaborative machine for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the 43rd international ACM SIGIR conference on research and development in information retrieval</em>. 1833–1836.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Homin Park, Homanga Bharadhwaj, and Brian Y Lim. 2019.

</span>
<span class="ltx_bibblock">Hierarchical multi-task learning for healthy drink classification. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">2019 International Joint Conference on Neural Networks (IJCNN)</em>. IEEE, 1–8.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruder (2017)</span>
<span class="ltx_bibblock">
Sebastian Ruder. 2017.

</span>
<span class="ltx_bibblock">An overview of multi-task learning in deep neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:1706.05098</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Victor Sanh, Thomas Wolf, and Sebastian Ruder. 2019.

</span>
<span class="ltx_bibblock">A hierarchical multi-task approach for learning embeddings from semantic tasks. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 33. 6949–6956.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shalaby et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Walid Shalaby, Sejoon Oh, Amir Afsharinejad, Srijan Kumar, and Xiquan Cui. 2022.

</span>
<span class="ltx_bibblock">M2TRec: Metadata-aware Multi-task Transformer for Large-scale and Cold-start free Session-based Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>. 573–578.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song and Zhao (2022)</span>
<span class="ltx_bibblock">
Minguang Song and Yunxin Zhao. 2022.

</span>
<span class="ltx_bibblock">Enhance Rnnlms with Hierarchical Multi-Task Learning for ASR. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">ICASSP 2022 - 2022 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>. 6102–6106.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICASSP43922.2022.9747525" title="">https://doi.org/10.1109/ICASSP43922.2022.9747525</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Wei Song, Ziyao Song, Lizhen Liu, and Ruiji Fu. 2020.

</span>
<span class="ltx_bibblock">Hierarchical Multi-task Learning for Organization Evaluation of Argumentative Student Essays. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the Twenty-Ninth International Joint Conference on Artificial Intelligence, IJCAI-20</em>, Christian Bessiere (Ed.). International Joint Conferences on Artificial Intelligence Organization, 3875–3881.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.24963/ijcai.2020/536" title="">https://doi.org/10.24963/ijcai.2020/536</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Steck et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Harald Steck, Linas Baltrunas, Ehtsham Elahi, Dawen Liang, Yves Raimond, and Justin Basilico. 2021.

</span>
<span class="ltx_bibblock">Deep learning for recommender systems: A Netflix case study.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">AI Magazine</em> 42, 3 (2021), 7–18.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhu Sun, Hongyang Liu, Xinghua Qu, Kaidong Feng, Yan Wang, and Yew Soon Ong. 2024.

</span>
<span class="ltx_bibblock">Large Language Models for Intent-Driven Session Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 324–334.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tanjim et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Md Mehrab Tanjim, Congzhe Su, Ethan Benjamin, Diane Hu, Liangjie Hong, and Julian McAuley. 2020.

</span>
<span class="ltx_bibblock">Attentive sequential models of latent intent for next item recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of The Web Conference 2020</em>. 2528–2534.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Bing Tian, Yong Zhang, Jin Wang, and Chunxiao Xing. 2019.

</span>
<span class="ltx_bibblock">Hierarchical Inter-Attention Network for Document Classification with Multi-Task Learning.. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">IJCAI</em>. 3569–3575.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van der Maaten and Hinton (2008)</span>
<span class="ltx_bibblock">
Laurens Van der Maaten and Geoffrey Hinton. 2008.

</span>
<span class="ltx_bibblock">Visualizing data using t-SNE.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Journal of machine learning research</em> 9, 11 (2008).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shoujin Wang, Liang Hu, Yan Wang, Quan Z Sheng, Mehmet Orgun, and Longbing Cao. 2019.

</span>
<span class="ltx_bibblock">Modeling multi-purpose sessions for next-item recommendations via mixture-channel purpose routing networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">International Joint Conference on Artificial Intelligence</em>. International Joint Conferences on Artificial Intelligence.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xinyi Wang, Guangluan Xu, Zequn Zhang, Li Jin, and Xian Sun. 2021.

</span>
<span class="ltx_bibblock">End-to-end aspect-based sentiment analysis with hierarchical multi-task learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">Neurocomputing</em> 455 (2021), 178–188.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yu Wang, Zhengyang Wang, Hengrui Zhang, Qingyu Yin, Xianfeng Tang, Yinghan Wang, Danqing Zhang, Limeng Cui, Monica Cheng, Bing Yin, et al<span class="ltx_text" id="bib.bib54.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Exploiting intent evolution in e-commercial query recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib54.4.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 5162–5173.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xue Xia, Pong Eksombatchai, Nikil Pancha, Dhruvil Deven Badani, Po-Wei Wang, Neng Gu, Saurabh Vishwas Joshi, Nazanin Farahpour, Zhiyuan Zhang, and Andrew Zhai. 2023.

</span>
<span class="ltx_bibblock">TransAct: Transformer-based Realtime User Action Model for Recommendation at Pinterest. In <em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 5249–5259.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Peiyan Zhang, Jiayan Guo, Chaozhuo Li, Yueqi Xie, Jae Boum Kim, Yan Zhang, Xing Xie, Haohan Wang, and Sunghun Kim. 2023.

</span>
<span class="ltx_bibblock">Efficiently leveraging multi-level user intent for session-based recommendation via atten-mixer network. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining</em>. 168–176.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib57.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shuai Zhang, Lina Yao, Aixin Sun, and Yi Tay. 2019.

</span>
<span class="ltx_bibblock">Deep learning based recommender system: A survey and new perspectives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.3.1">ACM computing surveys (CSUR)</em> 52, 1 (2019), 1–38.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Yang (2018)</span>
<span class="ltx_bibblock">
Yu Zhang and Qiang Yang. 2018.

</span>
<span class="ltx_bibblock">An overview of multi-task learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">National Science Review</em> 5, 1 (2018), 30–43.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Guorui Zhou, Na Mou, Ying Fan, Qi Pi, Weijie Bian, Chang Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Deep interest evolution network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">Proceedings of the AAAI conference on artificial intelligence</em>, Vol. 33. 5941–5948.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jul 25 22:52:57 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
