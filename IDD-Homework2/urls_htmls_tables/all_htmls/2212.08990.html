<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2212.08990] Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification</title><meta property="og:description" content="Creating high-performance generalizable deep neural networks for phytoplankton monitoring requires utilizing large-scale data coming from diverse global water sources. A major challenge to training such networks lies i…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2212.08990">

<!--Generated on Fri Mar  1 10:35:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\bstctlcite</span>
<p id="p1.2" class="ltx_p">IEEEexample:BSTcontrol</p>
</div>
<h1 class="ltx_title ltx_title_document">Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

<span id="id1.1.id1" class="ltx_tabular ltx_align_middle">
<span id="id1.1.id1.1" class="ltx_tr">
<span id="id1.1.id1.1.1" class="ltx_td ltx_align_justify">
<span id="id1.1.id1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="id1.1.id1.1.1.1.1" class="ltx_p">Daniel Zhang</span>
</span></span>
<span id="id1.1.id1.1.2" class="ltx_td ltx_align_justify">
<span id="id1.1.id1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="id1.1.id1.1.2.1.1" class="ltx_p">University of Waterloo</span>
</span></span></span>
<span id="id1.1.id1.2" class="ltx_tr">
<span id="id1.1.id1.2.1" class="ltx_td ltx_align_justify">
<span id="id1.1.id1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="id1.1.id1.2.1.1.1" class="ltx_p">Vikram Voleti</span>
</span></span>
<span id="id1.1.id1.2.2" class="ltx_td ltx_align_justify"></span></span>
</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> University of Montreal
Alexander Wong &amp; University of Waterloo
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Blue Lion Labs
Jason Deglint &amp; University of Waterloo
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Blue Lion Labs
  Email: {daniel.zhang1, jdeglint}@uwaterloo.ca
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p"><span id="id2.id1.1" class="ltx_text">Creating high-performance generalizable deep neural networks for phytoplankton monitoring requires utilizing large-scale data coming from diverse global water sources. A major challenge to training such networks lies in data privacy, where data collected at different facilities are often restricted from being transferred to a centralized location. A promising approach to overcome this challenge is federated learning, where training is done at site level on local data, and only the model parameters are exchanged over the network to generate a global model. In this study, we explore the feasibility of leveraging federated learning for privacy-preserving training of deep neural networks for phytoplankton classification. More specifically, we simulate two different federated learning frameworks, federated learning (FL) and mutually exclusive FL (ME-FL), and compare their performance to a traditional centralized learning (CL) framework. Experimental results from this study demonstrate the feasibility and potential of federated learning for phytoplankton monitoring.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The uncontrollable growth of particular phytoplankton and algae species can cause the formation of harmful algae blooms (HABs). If not properly monitored and controlled, HABs can have severe, negative impacts on various industries, natural ecosystems, and the environment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
HABs are a growing concern as research has shown that climate change has led to an increase in the frequency and severity of HABs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. A very important step in the monitoring and controlling of HAB formation is the identification of phytoplankton and algae species. Unfortunately, this process is largely manual and thus is highly time-consuming and prone to human error. As such, effective methods for automating the species identification process are highly desired.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recent advances in machine learning, in particular deep learning, have shown considerable promise for monitoring and assessment of phytoplankton and algae <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. However, a significant bottleneck to training such models is the need for large-scale data coming from different water sources across different countries in order to create high-performance, generalizable models. Since the data collected at the different facilities are often restricted from being transferred to a centralized location for training due to data privacy concerns, this makes it infeasible to leverage traditional, centralized learning frameworks for building such models.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A particularly promising direction for tackling this data privacy challenge lies in federated learning (FL), which involves training local models at individual local nodes on the premises (prem) of each local data source and communicating only the parameters and updates of these local models to a server for generating a global model to reap the benefits from the different local data without having seen any of the individual data sources <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. FL has demonstrated considerable success in the domains of mobile computing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, and thus can hold considerable potential for the application of phytoplankton monitoring and assessment.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this study, we explore the feasibility of leveraging federated learning to train deep, convolutional neural networks for the purpose of image-driven phytoplankton classification, which we will refer to as Plankton-FL. Our main contributions in this study are as follows: (1) we simulate and study two federated learning frameworks as potential realizations of Plankton-FL: (centralized) federated learning (FL) and mutually exclusive FL (ME-FL), (2) we evaluate the performance of both Plankton-FL frameworks, and (3) we compare them to a traditional, centralized learning framework (CL). Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> provides a visual representation of each of the three environments.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2212.08990/assets/proposed_FL14.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="538" height="689" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Traditional centralized learning (CL) (top) and the two federated learning frameworks as realizations of Plankton-FL: federated learning (FL) (middle) and mutually exclusive FL (ME-FL) (bottom). Both privacy-preserving federated learning frameworks are evaluated against CL for the training of deep neural networks for phytoplankton classification.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Background</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.4" class="ltx_p">Federated learning has been shown to be very effective for training deep neural networks on decentralized data while ensuring data privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Specifically, when there is sensitive data from various sources, federated learning can be leveraged. A typical federated learning framework consists of 2 components: a global model and <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients. Each client contains its own local model, and they are trained iteratively and independently on their respective data. It is assumed that all of the data available is partitioned into <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">K</annotation></semantics></math> clients, <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="P_{k}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">P</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑃</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">P_{k}</annotation></semantics></math>. The local models are then used to update the global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. This process is repeated for <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">N</annotation></semantics></math> rounds in order for the global model to generalize. The objective for federated learning is calculated using equation <a href="#S2.E1" title="In 2.1 Background ‣ 2 Methodology ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.7" class="ltx_Math" alttext="f(w)=\sum_{k=1}^{K}\frac{n_{k}}{n}F_{k}(w)\quad\textrm{where}\quad F_{k}(w)=\frac{1}{n_{k}}\sum_{i\in P_{k}}f_{i}(w)" display="block"><semantics id="S2.E1.m1.7a"><mrow id="S2.E1.m1.7.7.2" xref="S2.E1.m1.7.7.3.cmml"><mrow id="S2.E1.m1.6.6.1.1" xref="S2.E1.m1.6.6.1.1.cmml"><mrow id="S2.E1.m1.6.6.1.1.3" xref="S2.E1.m1.6.6.1.1.3.cmml"><mi id="S2.E1.m1.6.6.1.1.3.2" xref="S2.E1.m1.6.6.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.1.1.3.1" xref="S2.E1.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.6.6.1.1.3.3.2" xref="S2.E1.m1.6.6.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.1.1.3.3.2.1" xref="S2.E1.m1.6.6.1.1.3.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S2.E1.m1.6.6.1.1.3.3.2.2" xref="S2.E1.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E1.m1.6.6.1.1.2" xref="S2.E1.m1.6.6.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.2.cmml"><mrow id="S2.E1.m1.6.6.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.cmml"><munderover id="S2.E1.m1.6.6.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S2.E1.m1.6.6.1.1.1.1.1.1.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.3.cmml">K</mi></munderover><mrow id="S2.E1.m1.6.6.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml"><mfrac id="S2.E1.m1.6.6.1.1.1.1.1.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.cmml"><msub id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2.cmml">n</mi><mi id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mi id="S2.E1.m1.6.6.1.1.1.1.1.2.2.3" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.1.1.1.1.1.2.1" xref="S2.E1.m1.6.6.1.1.1.1.1.2.1.cmml">​</mo><msub id="S2.E1.m1.6.6.1.1.1.1.1.2.3" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.2.3.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.2.cmml">F</mi><mi id="S2.E1.m1.6.6.1.1.1.1.1.2.3.3" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.6.6.1.1.1.1.1.2.1a" xref="S2.E1.m1.6.6.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.2.4.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.1.1.1.1.1.2.4.2.1" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">w</mi><mo stretchy="false" id="S2.E1.m1.6.6.1.1.1.1.1.2.4.2.2" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mspace width="1em" id="S2.E1.m1.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.2.cmml"></mspace><mtext id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5a.cmml">where</mtext></mrow></mrow><mspace width="1em" id="S2.E1.m1.7.7.2.3" xref="S2.E1.m1.7.7.3a.cmml"></mspace><mrow id="S2.E1.m1.7.7.2.2" xref="S2.E1.m1.7.7.2.2.cmml"><mrow id="S2.E1.m1.7.7.2.2.2" xref="S2.E1.m1.7.7.2.2.2.cmml"><msub id="S2.E1.m1.7.7.2.2.2.2" xref="S2.E1.m1.7.7.2.2.2.2.cmml"><mi id="S2.E1.m1.7.7.2.2.2.2.2" xref="S2.E1.m1.7.7.2.2.2.2.2.cmml">F</mi><mi id="S2.E1.m1.7.7.2.2.2.2.3" xref="S2.E1.m1.7.7.2.2.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.2.2.2.1" xref="S2.E1.m1.7.7.2.2.2.1.cmml">​</mo><mrow id="S2.E1.m1.7.7.2.2.2.3.2" xref="S2.E1.m1.7.7.2.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.2.2.2.3.2.1" xref="S2.E1.m1.7.7.2.2.2.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">w</mi><mo stretchy="false" id="S2.E1.m1.7.7.2.2.2.3.2.2" xref="S2.E1.m1.7.7.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.7.7.2.2.1" xref="S2.E1.m1.7.7.2.2.1.cmml">=</mo><mrow id="S2.E1.m1.7.7.2.2.3" xref="S2.E1.m1.7.7.2.2.3.cmml"><mfrac id="S2.E1.m1.7.7.2.2.3.2" xref="S2.E1.m1.7.7.2.2.3.2.cmml"><mn id="S2.E1.m1.7.7.2.2.3.2.2" xref="S2.E1.m1.7.7.2.2.3.2.2.cmml">1</mn><msub id="S2.E1.m1.7.7.2.2.3.2.3" xref="S2.E1.m1.7.7.2.2.3.2.3.cmml"><mi id="S2.E1.m1.7.7.2.2.3.2.3.2" xref="S2.E1.m1.7.7.2.2.3.2.3.2.cmml">n</mi><mi id="S2.E1.m1.7.7.2.2.3.2.3.3" xref="S2.E1.m1.7.7.2.2.3.2.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.2.2.3.1" xref="S2.E1.m1.7.7.2.2.3.1.cmml">​</mo><mrow id="S2.E1.m1.7.7.2.2.3.3" xref="S2.E1.m1.7.7.2.2.3.3.cmml"><munder id="S2.E1.m1.7.7.2.2.3.3.1" xref="S2.E1.m1.7.7.2.2.3.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.7.7.2.2.3.3.1.2" xref="S2.E1.m1.7.7.2.2.3.3.1.2.cmml">∑</mo><mrow id="S2.E1.m1.7.7.2.2.3.3.1.3" xref="S2.E1.m1.7.7.2.2.3.3.1.3.cmml"><mi id="S2.E1.m1.7.7.2.2.3.3.1.3.2" xref="S2.E1.m1.7.7.2.2.3.3.1.3.2.cmml">i</mi><mo id="S2.E1.m1.7.7.2.2.3.3.1.3.1" xref="S2.E1.m1.7.7.2.2.3.3.1.3.1.cmml">∈</mo><msub id="S2.E1.m1.7.7.2.2.3.3.1.3.3" xref="S2.E1.m1.7.7.2.2.3.3.1.3.3.cmml"><mi id="S2.E1.m1.7.7.2.2.3.3.1.3.3.2" xref="S2.E1.m1.7.7.2.2.3.3.1.3.3.2.cmml">P</mi><mi id="S2.E1.m1.7.7.2.2.3.3.1.3.3.3" xref="S2.E1.m1.7.7.2.2.3.3.1.3.3.3.cmml">k</mi></msub></mrow></munder><mrow id="S2.E1.m1.7.7.2.2.3.3.2" xref="S2.E1.m1.7.7.2.2.3.3.2.cmml"><msub id="S2.E1.m1.7.7.2.2.3.3.2.2" xref="S2.E1.m1.7.7.2.2.3.3.2.2.cmml"><mi id="S2.E1.m1.7.7.2.2.3.3.2.2.2" xref="S2.E1.m1.7.7.2.2.3.3.2.2.2.cmml">f</mi><mi id="S2.E1.m1.7.7.2.2.3.3.2.2.3" xref="S2.E1.m1.7.7.2.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.2.2.3.3.2.1" xref="S2.E1.m1.7.7.2.2.3.3.2.1.cmml">​</mo><mrow id="S2.E1.m1.7.7.2.2.3.3.2.3.2" xref="S2.E1.m1.7.7.2.2.3.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.2.2.3.3.2.3.2.1" xref="S2.E1.m1.7.7.2.2.3.3.2.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">w</mi><mo stretchy="false" id="S2.E1.m1.7.7.2.2.3.3.2.3.2.2" xref="S2.E1.m1.7.7.2.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.7b"><apply id="S2.E1.m1.7.7.3.cmml" xref="S2.E1.m1.7.7.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.3a.cmml" xref="S2.E1.m1.7.7.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.6.6.1.1.cmml" xref="S2.E1.m1.6.6.1.1"><eq id="S2.E1.m1.6.6.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.2"></eq><apply id="S2.E1.m1.6.6.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.3"><times id="S2.E1.m1.6.6.1.1.3.1.cmml" xref="S2.E1.m1.6.6.1.1.3.1"></times><ci id="S2.E1.m1.6.6.1.1.3.2.cmml" xref="S2.E1.m1.6.6.1.1.3.2">𝑓</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑤</ci></apply><list id="S2.E1.m1.6.6.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><apply id="S2.E1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1"><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1">subscript</csymbol><sum id="S2.E1.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.2"></sum><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3"><eq id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.1"></eq><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.3">𝐾</ci></apply><apply id="S2.E1.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2"><times id="S2.E1.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.1"></times><apply id="S2.E1.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2"><divide id="S2.E1.m1.6.6.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2"></divide><apply id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.2">𝑛</ci><ci id="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="S2.E1.m1.6.6.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.2.3">𝑛</ci></apply><apply id="S2.E1.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.2">𝐹</ci><ci id="S2.E1.m1.6.6.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.2.3.3">𝑘</ci></apply><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑤</ci></apply></apply><ci id="S2.E1.m1.5.5a.cmml" xref="S2.E1.m1.5.5"><mtext id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">where</mtext></ci></list></apply><apply id="S2.E1.m1.7.7.2.2.cmml" xref="S2.E1.m1.7.7.2.2"><eq id="S2.E1.m1.7.7.2.2.1.cmml" xref="S2.E1.m1.7.7.2.2.1"></eq><apply id="S2.E1.m1.7.7.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2"><times id="S2.E1.m1.7.7.2.2.2.1.cmml" xref="S2.E1.m1.7.7.2.2.2.1"></times><apply id="S2.E1.m1.7.7.2.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.2.2.1.cmml" xref="S2.E1.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.7.7.2.2.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2.2">𝐹</ci><ci id="S2.E1.m1.7.7.2.2.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3">𝑘</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑤</ci></apply><apply id="S2.E1.m1.7.7.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.3"><times id="S2.E1.m1.7.7.2.2.3.1.cmml" xref="S2.E1.m1.7.7.2.2.3.1"></times><apply id="S2.E1.m1.7.7.2.2.3.2.cmml" xref="S2.E1.m1.7.7.2.2.3.2"><divide id="S2.E1.m1.7.7.2.2.3.2.1.cmml" xref="S2.E1.m1.7.7.2.2.3.2"></divide><cn type="integer" id="S2.E1.m1.7.7.2.2.3.2.2.cmml" xref="S2.E1.m1.7.7.2.2.3.2.2">1</cn><apply id="S2.E1.m1.7.7.2.2.3.2.3.cmml" xref="S2.E1.m1.7.7.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.3.2.3.1.cmml" xref="S2.E1.m1.7.7.2.2.3.2.3">subscript</csymbol><ci id="S2.E1.m1.7.7.2.2.3.2.3.2.cmml" xref="S2.E1.m1.7.7.2.2.3.2.3.2">𝑛</ci><ci id="S2.E1.m1.7.7.2.2.3.2.3.3.cmml" xref="S2.E1.m1.7.7.2.2.3.2.3.3">𝑘</ci></apply></apply><apply id="S2.E1.m1.7.7.2.2.3.3.cmml" xref="S2.E1.m1.7.7.2.2.3.3"><apply id="S2.E1.m1.7.7.2.2.3.3.1.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.3.3.1.1.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1">subscript</csymbol><sum id="S2.E1.m1.7.7.2.2.3.3.1.2.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.2"></sum><apply id="S2.E1.m1.7.7.2.2.3.3.1.3.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.3"><in id="S2.E1.m1.7.7.2.2.3.3.1.3.1.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.3.1"></in><ci id="S2.E1.m1.7.7.2.2.3.3.1.3.2.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.3.2">𝑖</ci><apply id="S2.E1.m1.7.7.2.2.3.3.1.3.3.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.3.3.1.3.3.1.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.3.3">subscript</csymbol><ci id="S2.E1.m1.7.7.2.2.3.3.1.3.3.2.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.3.3.2">𝑃</ci><ci id="S2.E1.m1.7.7.2.2.3.3.1.3.3.3.cmml" xref="S2.E1.m1.7.7.2.2.3.3.1.3.3.3">𝑘</ci></apply></apply></apply><apply id="S2.E1.m1.7.7.2.2.3.3.2.cmml" xref="S2.E1.m1.7.7.2.2.3.3.2"><times id="S2.E1.m1.7.7.2.2.3.3.2.1.cmml" xref="S2.E1.m1.7.7.2.2.3.3.2.1"></times><apply id="S2.E1.m1.7.7.2.2.3.3.2.2.cmml" xref="S2.E1.m1.7.7.2.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.3.3.2.2.1.cmml" xref="S2.E1.m1.7.7.2.2.3.3.2.2">subscript</csymbol><ci id="S2.E1.m1.7.7.2.2.3.3.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.3.3.2.2.2">𝑓</ci><ci id="S2.E1.m1.7.7.2.2.3.3.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.3.3.2.2.3">𝑖</ci></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑤</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.7c">f(w)=\sum_{k=1}^{K}\frac{n_{k}}{n}F_{k}(w)\quad\textrm{where}\quad F_{k}(w)=\frac{1}{n_{k}}\sum_{i\in P_{k}}f_{i}(w)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.7" class="ltx_p">In equation <a href="#S2.E1" title="In 2.1 Background ‣ 2 Methodology ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="f_{i}(w)" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.2" xref="S2.SS1.p3.1.m1.1.2.cmml"><msub id="S2.SS1.p3.1.m1.1.2.2" xref="S2.SS1.p3.1.m1.1.2.2.cmml"><mi id="S2.SS1.p3.1.m1.1.2.2.2" xref="S2.SS1.p3.1.m1.1.2.2.2.cmml">f</mi><mi id="S2.SS1.p3.1.m1.1.2.2.3" xref="S2.SS1.p3.1.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p3.1.m1.1.2.1" xref="S2.SS1.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS1.p3.1.m1.1.2.3.2" xref="S2.SS1.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p3.1.m1.1.2.3.2.1" xref="S2.SS1.p3.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S2.SS1.p3.1.m1.1.2.3.2.2" xref="S2.SS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.2"><times id="S2.SS1.p3.1.m1.1.2.1.cmml" xref="S2.SS1.p3.1.m1.1.2.1"></times><apply id="S2.SS1.p3.1.m1.1.2.2.cmml" xref="S2.SS1.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.2.2.1.cmml" xref="S2.SS1.p3.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.2.2.2.cmml" xref="S2.SS1.p3.1.m1.1.2.2.2">𝑓</ci><ci id="S2.SS1.p3.1.m1.1.2.2.3.cmml" xref="S2.SS1.p3.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">f_{i}(w)</annotation></semantics></math> denotes the loss function <math id="S2.SS1.p3.2.m2.3" class="ltx_Math" alttext="\ell(x_{i},y_{i};w)" display="inline"><semantics id="S2.SS1.p3.2.m2.3a"><mrow id="S2.SS1.p3.2.m2.3.3" xref="S2.SS1.p3.2.m2.3.3.cmml"><mi mathvariant="normal" id="S2.SS1.p3.2.m2.3.3.4" xref="S2.SS1.p3.2.m2.3.3.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.2.m2.3.3.3" xref="S2.SS1.p3.2.m2.3.3.3.cmml">​</mo><mrow id="S2.SS1.p3.2.m2.3.3.2.2" xref="S2.SS1.p3.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS1.p3.2.m2.3.3.2.2.3" xref="S2.SS1.p3.2.m2.3.3.2.3.cmml">(</mo><msub id="S2.SS1.p3.2.m2.2.2.1.1.1" xref="S2.SS1.p3.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p3.2.m2.2.2.1.1.1.2" xref="S2.SS1.p3.2.m2.2.2.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p3.2.m2.2.2.1.1.1.3" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p3.2.m2.3.3.2.2.4" xref="S2.SS1.p3.2.m2.3.3.2.3.cmml">,</mo><msub id="S2.SS1.p3.2.m2.3.3.2.2.2" xref="S2.SS1.p3.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.p3.2.m2.3.3.2.2.2.2" xref="S2.SS1.p3.2.m2.3.3.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p3.2.m2.3.3.2.2.2.3" xref="S2.SS1.p3.2.m2.3.3.2.2.2.3.cmml">i</mi></msub><mo id="S2.SS1.p3.2.m2.3.3.2.2.5" xref="S2.SS1.p3.2.m2.3.3.2.3.cmml">;</mo><mi id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">w</mi><mo stretchy="false" id="S2.SS1.p3.2.m2.3.3.2.2.6" xref="S2.SS1.p3.2.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.3b"><apply id="S2.SS1.p3.2.m2.3.3.cmml" xref="S2.SS1.p3.2.m2.3.3"><times id="S2.SS1.p3.2.m2.3.3.3.cmml" xref="S2.SS1.p3.2.m2.3.3.3"></times><ci id="S2.SS1.p3.2.m2.3.3.4.cmml" xref="S2.SS1.p3.2.m2.3.3.4">ℓ</ci><vector id="S2.SS1.p3.2.m2.3.3.2.3.cmml" xref="S2.SS1.p3.2.m2.3.3.2.2"><apply id="S2.SS1.p3.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.2">𝑥</ci><ci id="S2.SS1.p3.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p3.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p3.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.p3.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.p3.2.m2.3.3.2.2.2.2">𝑦</ci><ci id="S2.SS1.p3.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS1.p3.2.m2.3.3.2.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">𝑤</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.3c">\ell(x_{i},y_{i};w)</annotation></semantics></math> for an observation <math id="S2.SS1.p3.3.m3.2" class="ltx_Math" alttext="(x_{i},y_{i})" display="inline"><semantics id="S2.SS1.p3.3.m3.2a"><mrow id="S2.SS1.p3.3.m3.2.2.2" xref="S2.SS1.p3.3.m3.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p3.3.m3.2.2.2.3" xref="S2.SS1.p3.3.m3.2.2.3.cmml">(</mo><msub id="S2.SS1.p3.3.m3.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1.1.1.2" xref="S2.SS1.p3.3.m3.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.p3.3.m3.1.1.1.1.3" xref="S2.SS1.p3.3.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p3.3.m3.2.2.2.4" xref="S2.SS1.p3.3.m3.2.2.3.cmml">,</mo><msub id="S2.SS1.p3.3.m3.2.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.2.cmml"><mi id="S2.SS1.p3.3.m3.2.2.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p3.3.m3.2.2.2.2.3" xref="S2.SS1.p3.3.m3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p3.3.m3.2.2.2.5" xref="S2.SS1.p3.3.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.2b"><interval closure="open" id="S2.SS1.p3.3.m3.2.2.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2"><apply id="S2.SS1.p3.3.m3.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.p3.3.m3.1.1.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p3.3.m3.2.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.2.2.2.2.1.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p3.3.m3.2.2.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2">𝑦</ci><ci id="S2.SS1.p3.3.m3.2.2.2.2.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.2c">(x_{i},y_{i})</annotation></semantics></math> and model parameters <math id="S2.SS1.p3.4.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S2.SS1.p3.4.m4.1a"><mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">w</annotation></semantics></math>. Also, <math id="S2.SS1.p3.5.m5.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S2.SS1.p3.5.m5.1a"><msub id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">n</mi><mi id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝑛</ci><ci id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">n_{k}</annotation></semantics></math> and <math id="S2.SS1.p3.6.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p3.6.m6.1a"><mi id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><ci id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">n</annotation></semantics></math> denote the <math id="S2.SS1.p3.7.m7.1" class="ltx_Math" alttext="|P_{k}|" display="inline"><semantics id="S2.SS1.p3.7.m7.1a"><mrow id="S2.SS1.p3.7.m7.1.1.1" xref="S2.SS1.p3.7.m7.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p3.7.m7.1.1.1.2" xref="S2.SS1.p3.7.m7.1.1.2.1.cmml">|</mo><msub id="S2.SS1.p3.7.m7.1.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml"><mi id="S2.SS1.p3.7.m7.1.1.1.1.2" xref="S2.SS1.p3.7.m7.1.1.1.1.2.cmml">P</mi><mi id="S2.SS1.p3.7.m7.1.1.1.1.3" xref="S2.SS1.p3.7.m7.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.p3.7.m7.1.1.1.3" xref="S2.SS1.p3.7.m7.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><apply id="S2.SS1.p3.7.m7.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.1"><abs id="S2.SS1.p3.7.m7.1.1.2.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1.2"></abs><apply id="S2.SS1.p3.7.m7.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m7.1.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.7.m7.1.1.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.2">𝑃</ci><ci id="S2.SS1.p3.7.m7.1.1.1.1.3.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">|P_{k}|</annotation></semantics></math> and the total number of observations, respectively.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">The centralized federated learning algorithm which governs the communication between the global and local models is known as FederatedAveraging (FedAvg) and was introduced by McMahan <span id="S2.SS1.p4.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. FedAvg is the iterative process of training all the local models, taking the average of all the updated weights from the local models, and then using it to update the global model. As described by McMahan <span id="S2.SS1.p4.1.2" class="ltx_text ltx_font_italic">et al.</span>, pseudo-code is provided in Algorithm 1.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_float"><span id="alg1.15.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> McMahan <span id="alg1.16.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>’s implementation of the FedAvg algorithm. <math id="alg1.7.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.7.m1.1b"><mi id="alg1.7.m1.1.1" xref="alg1.7.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.7.m1.1c"><ci id="alg1.7.m1.1.1.cmml" xref="alg1.7.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m1.1d">C</annotation></semantics></math> is the set of all clients; <math id="alg1.8.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.8.m2.1b"><mi id="alg1.8.m2.1.1" xref="alg1.8.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m2.1c"><ci id="alg1.8.m2.1.1.cmml" xref="alg1.8.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m2.1d">B</annotation></semantics></math> is the local model batch size; <math id="alg1.9.m3.1" class="ltx_Math" alttext="LE" display="inline"><semantics id="alg1.9.m3.1b"><mrow id="alg1.9.m3.1.1" xref="alg1.9.m3.1.1.cmml"><mi id="alg1.9.m3.1.1.2" xref="alg1.9.m3.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.9.m3.1.1.1" xref="alg1.9.m3.1.1.1.cmml">​</mo><mi id="alg1.9.m3.1.1.3" xref="alg1.9.m3.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.m3.1c"><apply id="alg1.9.m3.1.1.cmml" xref="alg1.9.m3.1.1"><times id="alg1.9.m3.1.1.1.cmml" xref="alg1.9.m3.1.1.1"></times><ci id="alg1.9.m3.1.1.2.cmml" xref="alg1.9.m3.1.1.2">𝐿</ci><ci id="alg1.9.m3.1.1.3.cmml" xref="alg1.9.m3.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m3.1d">LE</annotation></semantics></math> is the number of local epochs; <math id="alg1.10.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.10.m4.1b"><mi id="alg1.10.m4.1.1" xref="alg1.10.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m4.1c"><ci id="alg1.10.m4.1.1.cmml" xref="alg1.10.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m4.1d">\eta</annotation></semantics></math> is the learning rate; <math id="alg1.11.m5.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.11.m5.1b"><mi id="alg1.11.m5.1.1" xref="alg1.11.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.11.m5.1c"><ci id="alg1.11.m5.1.1.cmml" xref="alg1.11.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m5.1d">w</annotation></semantics></math> are the weights, and <math id="alg1.12.m6.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="alg1.12.m6.1b"><mi mathvariant="normal" id="alg1.12.m6.1.1" xref="alg1.12.m6.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="alg1.12.m6.1c"><ci id="alg1.12.m6.1.1.cmml" xref="alg1.12.m6.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m6.1d">\ell</annotation></semantics></math> is the loss function</figcaption>
<div id="alg1.17" class="ltx_listing ltx_align_center ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">Global/Server:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="C\leftarrow\text{Set of all available clients}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">C</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mtext id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3a.cmml">Set of all available clients</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐶</ci><ci id="alg1.l2.m1.1.1.3a.cmml" xref="alg1.l2.m1.1.1.3"><mtext id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">Set of all available clients</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">C\leftarrow\text{Set of all available clients}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.1" class="ltx_text">initialize <math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="alg1.l3.1.m1.1a"><msub id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml"><mi id="alg1.l3.1.m1.1.1.2" xref="alg1.l3.1.m1.1.1.2.cmml">w</mi><mn id="alg1.l3.1.m1.1.1.3" xref="alg1.l3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><apply id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.1.m1.1.1.1.cmml" xref="alg1.l3.1.m1.1.1">subscript</csymbol><ci id="alg1.l3.1.m1.1.1.2.cmml" xref="alg1.l3.1.m1.1.1.2">𝑤</ci><cn type="integer" id="alg1.l3.1.m1.1.1.3.cmml" xref="alg1.l3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">w_{0}</annotation></semantics></math></span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> each round, <math id="alg1.l4.m1.1" class="ltx_Math" alttext="r=1" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">r</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mn id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑟</ci><cn type="integer" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">r=1</annotation></semantics></math>,<math id="alg1.l4.m2.1" class="ltx_Math" alttext="2" display="inline"><semantics id="alg1.l4.m2.1a"><mn id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><cn type="integer" id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">2</annotation></semantics></math>, … <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span> each client, <math id="alg1.l5.m1.1" class="ltx_Math" alttext="k\in C" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">k</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">∈</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><in id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></in><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑘</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">k\in C</annotation></semantics></math>, <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>         <math id="alg1.l6.m1.2" class="ltx_Math" alttext="w_{r+1}^{k}\leftarrow\textbf{Local-Training($k$, $w_{r}$)}" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><msubsup id="alg1.l6.m1.2.3.2" xref="alg1.l6.m1.2.3.2.cmml"><mi id="alg1.l6.m1.2.3.2.2.2" xref="alg1.l6.m1.2.3.2.2.2.cmml">w</mi><mrow id="alg1.l6.m1.2.3.2.2.3" xref="alg1.l6.m1.2.3.2.2.3.cmml"><mi id="alg1.l6.m1.2.3.2.2.3.2" xref="alg1.l6.m1.2.3.2.2.3.2.cmml">r</mi><mo id="alg1.l6.m1.2.3.2.2.3.1" xref="alg1.l6.m1.2.3.2.2.3.1.cmml">+</mo><mn id="alg1.l6.m1.2.3.2.2.3.3" xref="alg1.l6.m1.2.3.2.2.3.3.cmml">1</mn></mrow><mi id="alg1.l6.m1.2.3.2.3" xref="alg1.l6.m1.2.3.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.2.3.1" xref="alg1.l6.m1.2.3.1.cmml">←</mo><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2d.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.2a" xref="alg1.l6.m1.2.2.2d.cmml">Local-Training(</mtext><mi id="alg1.l6.m1.1.1.1.m1.1.1" xref="alg1.l6.m1.1.1.1.m1.1.1.cmml">k</mi><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.2b" xref="alg1.l6.m1.2.2.2d.cmml">, </mtext><msub id="alg1.l6.m1.2.2.2.m2.1.1" xref="alg1.l6.m1.2.2.2.m2.1.1.cmml"><mi id="alg1.l6.m1.2.2.2.m2.1.1.2" xref="alg1.l6.m1.2.2.2.m2.1.1.2.cmml">w</mi><mi id="alg1.l6.m1.2.2.2.m2.1.1.3" xref="alg1.l6.m1.2.2.2.m2.1.1.3.cmml">r</mi></msub><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.2c" xref="alg1.l6.m1.2.2.2d.cmml">)</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><ci id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3.1">←</ci><apply id="alg1.l6.m1.2.3.2.cmml" xref="alg1.l6.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.2.1.cmml" xref="alg1.l6.m1.2.3.2">superscript</csymbol><apply id="alg1.l6.m1.2.3.2.2.cmml" xref="alg1.l6.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.2.2.1.cmml" xref="alg1.l6.m1.2.3.2">subscript</csymbol><ci id="alg1.l6.m1.2.3.2.2.2.cmml" xref="alg1.l6.m1.2.3.2.2.2">𝑤</ci><apply id="alg1.l6.m1.2.3.2.2.3.cmml" xref="alg1.l6.m1.2.3.2.2.3"><plus id="alg1.l6.m1.2.3.2.2.3.1.cmml" xref="alg1.l6.m1.2.3.2.2.3.1"></plus><ci id="alg1.l6.m1.2.3.2.2.3.2.cmml" xref="alg1.l6.m1.2.3.2.2.3.2">𝑟</ci><cn type="integer" id="alg1.l6.m1.2.3.2.2.3.3.cmml" xref="alg1.l6.m1.2.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l6.m1.2.3.2.3.cmml" xref="alg1.l6.m1.2.3.2.3">𝑘</ci></apply><ci id="alg1.l6.m1.2.2.2d.cmml" xref="alg1.l6.m1.2.2.2"><mrow id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.2a.cmml" xref="alg1.l6.m1.2.2.2">Local-Training(</mtext><mi id="alg1.l6.m1.1.1.1.m1.1.1.cmml" xref="alg1.l6.m1.1.1.1.m1.1.1">k</mi><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.2b.cmml" xref="alg1.l6.m1.2.2.2">, </mtext><msub id="alg1.l6.m1.2.2.2.m2.1.1.cmml" xref="alg1.l6.m1.2.2.2.m2.1.1"><mi id="alg1.l6.m1.2.2.2.m2.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.m2.1.1.2">w</mi><mi id="alg1.l6.m1.2.2.2.m2.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.m2.1.1.3">r</mi></msub><mtext class="ltx_mathvariant_bold" id="alg1.l6.m1.2.2.2c.cmml" xref="alg1.l6.m1.2.2.2">)</mtext></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">w_{r+1}^{k}\leftarrow\textbf{Local-Training($k$, $w_{r}$)}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text">FedAvg:</span> <math id="alg1.l8.m1.1" class="ltx_Math" alttext="w_{r+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w^{k}_{r+1}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">w</mi><mrow id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.2.3.2" xref="alg1.l8.m1.1.1.2.3.2.cmml">r</mi><mo id="alg1.l8.m1.1.1.2.3.1" xref="alg1.l8.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l8.m1.1.1.2.3.3" xref="alg1.l8.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><msubsup id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml"><mo id="alg1.l8.m1.1.1.3.1.2.2" xref="alg1.l8.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l8.m1.1.1.3.1.2.3" xref="alg1.l8.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.1.2.3.2" xref="alg1.l8.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l8.m1.1.1.3.1.2.3.1" xref="alg1.l8.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l8.m1.1.1.3.1.2.3.3" xref="alg1.l8.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l8.m1.1.1.3.1.3" xref="alg1.l8.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml"><mfrac id="alg1.l8.m1.1.1.3.2.2" xref="alg1.l8.m1.1.1.3.2.2.cmml"><msub id="alg1.l8.m1.1.1.3.2.2.2" xref="alg1.l8.m1.1.1.3.2.2.2.cmml"><mi id="alg1.l8.m1.1.1.3.2.2.2.2" xref="alg1.l8.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="alg1.l8.m1.1.1.3.2.2.2.3" xref="alg1.l8.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg1.l8.m1.1.1.3.2.2.3" xref="alg1.l8.m1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.3.2.1" xref="alg1.l8.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg1.l8.m1.1.1.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.cmml"><mi id="alg1.l8.m1.1.1.3.2.3.2.2" xref="alg1.l8.m1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="alg1.l8.m1.1.1.3.2.3.3" xref="alg1.l8.m1.1.1.3.2.3.3.cmml"><mi id="alg1.l8.m1.1.1.3.2.3.3.2" xref="alg1.l8.m1.1.1.3.2.3.3.2.cmml">r</mi><mo id="alg1.l8.m1.1.1.3.2.3.3.1" xref="alg1.l8.m1.1.1.3.2.3.3.1.cmml">+</mo><mn id="alg1.l8.m1.1.1.3.2.3.3.3" xref="alg1.l8.m1.1.1.3.2.3.3.3.cmml">1</mn></mrow><mi id="alg1.l8.m1.1.1.3.2.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑤</ci><apply id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3"><plus id="alg1.l8.m1.1.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.2.3.1"></plus><ci id="alg1.l8.m1.1.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.2.3.2">𝑟</ci><cn type="integer" id="alg1.l8.m1.1.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><apply id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.1.cmml" xref="alg1.l8.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l8.m1.1.1.3.1.2.cmml" xref="alg1.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.2.1.cmml" xref="alg1.l8.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l8.m1.1.1.3.1.2.2.cmml" xref="alg1.l8.m1.1.1.3.1.2.2"></sum><apply id="alg1.l8.m1.1.1.3.1.2.3.cmml" xref="alg1.l8.m1.1.1.3.1.2.3"><eq id="alg1.l8.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l8.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l8.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l8.m1.1.1.3.1.3.cmml" xref="alg1.l8.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2"><times id="alg1.l8.m1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2.1"></times><apply id="alg1.l8.m1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2"><divide id="alg1.l8.m1.1.1.3.2.2.1.cmml" xref="alg1.l8.m1.1.1.3.2.2"></divide><apply id="alg1.l8.m1.1.1.3.2.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l8.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="alg1.l8.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="alg1.l8.m1.1.1.3.2.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.2.3">𝑛</ci></apply><apply id="alg1.l8.m1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.3.1.cmml" xref="alg1.l8.m1.1.1.3.2.3">subscript</csymbol><apply id="alg1.l8.m1.1.1.3.2.3.2.cmml" xref="alg1.l8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2.3">superscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.3.2.2">𝑤</ci><ci id="alg1.l8.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3.2.3">𝑘</ci></apply><apply id="alg1.l8.m1.1.1.3.2.3.3.cmml" xref="alg1.l8.m1.1.1.3.2.3.3"><plus id="alg1.l8.m1.1.1.3.2.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.2.3.3.1"></plus><ci id="alg1.l8.m1.1.1.3.2.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.2.3.3.2">𝑟</ci><cn type="integer" id="alg1.l8.m1.1.1.3.2.3.3.3.cmml" xref="alg1.l8.m1.1.1.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">w_{r+1}\leftarrow\sum_{k=1}^{K}\frac{n_{k}}{n}w^{k}_{r+1}</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg1.l9.2" class="ltx_text">SYNC Global</span><math id="alg1.l9.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="alg1.l9.m1.1a"><mo stretchy="false" id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\rightarrow</annotation></semantics></math><span id="alg1.l9.3" class="ltx_text">Local: </span> <math id="alg1.l9.m2.2" class="ltx_Math" alttext="w_{r+1}^{k}\leftarrow w_{r+1}\ \ \forall k" display="inline"><semantics id="alg1.l9.m2.2a"><mrow id="alg1.l9.m2.2.2" xref="alg1.l9.m2.2.2.cmml"><msubsup id="alg1.l9.m2.2.2.4" xref="alg1.l9.m2.2.2.4.cmml"><mi id="alg1.l9.m2.2.2.4.2.2" xref="alg1.l9.m2.2.2.4.2.2.cmml">w</mi><mrow id="alg1.l9.m2.2.2.4.2.3" xref="alg1.l9.m2.2.2.4.2.3.cmml"><mi id="alg1.l9.m2.2.2.4.2.3.2" xref="alg1.l9.m2.2.2.4.2.3.2.cmml">r</mi><mo id="alg1.l9.m2.2.2.4.2.3.1" xref="alg1.l9.m2.2.2.4.2.3.1.cmml">+</mo><mn id="alg1.l9.m2.2.2.4.2.3.3" xref="alg1.l9.m2.2.2.4.2.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m2.2.2.4.3" xref="alg1.l9.m2.2.2.4.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l9.m2.2.2.3" xref="alg1.l9.m2.2.2.3.cmml">←</mo><mrow id="alg1.l9.m2.2.2.2.2" xref="alg1.l9.m2.2.2.2.3.cmml"><msub id="alg1.l9.m2.1.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.1.cmml"><mi id="alg1.l9.m2.1.1.1.1.1.2" xref="alg1.l9.m2.1.1.1.1.1.2.cmml">w</mi><mrow id="alg1.l9.m2.1.1.1.1.1.3" xref="alg1.l9.m2.1.1.1.1.1.3.cmml"><mi id="alg1.l9.m2.1.1.1.1.1.3.2" xref="alg1.l9.m2.1.1.1.1.1.3.2.cmml">r</mi><mo id="alg1.l9.m2.1.1.1.1.1.3.1" xref="alg1.l9.m2.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l9.m2.1.1.1.1.1.3.3" xref="alg1.l9.m2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mspace width="1.167em" id="alg1.l9.m2.2.2.2.2.3" xref="alg1.l9.m2.2.2.2.3.cmml"></mspace><mrow id="alg1.l9.m2.2.2.2.2.2" xref="alg1.l9.m2.2.2.2.2.2.cmml"><mo rspace="0.167em" id="alg1.l9.m2.2.2.2.2.2.1" xref="alg1.l9.m2.2.2.2.2.2.1.cmml">∀</mo><mi id="alg1.l9.m2.2.2.2.2.2.2" xref="alg1.l9.m2.2.2.2.2.2.2.cmml">k</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.2b"><apply id="alg1.l9.m2.2.2.cmml" xref="alg1.l9.m2.2.2"><ci id="alg1.l9.m2.2.2.3.cmml" xref="alg1.l9.m2.2.2.3">←</ci><apply id="alg1.l9.m2.2.2.4.cmml" xref="alg1.l9.m2.2.2.4"><csymbol cd="ambiguous" id="alg1.l9.m2.2.2.4.1.cmml" xref="alg1.l9.m2.2.2.4">superscript</csymbol><apply id="alg1.l9.m2.2.2.4.2.cmml" xref="alg1.l9.m2.2.2.4"><csymbol cd="ambiguous" id="alg1.l9.m2.2.2.4.2.1.cmml" xref="alg1.l9.m2.2.2.4">subscript</csymbol><ci id="alg1.l9.m2.2.2.4.2.2.cmml" xref="alg1.l9.m2.2.2.4.2.2">𝑤</ci><apply id="alg1.l9.m2.2.2.4.2.3.cmml" xref="alg1.l9.m2.2.2.4.2.3"><plus id="alg1.l9.m2.2.2.4.2.3.1.cmml" xref="alg1.l9.m2.2.2.4.2.3.1"></plus><ci id="alg1.l9.m2.2.2.4.2.3.2.cmml" xref="alg1.l9.m2.2.2.4.2.3.2">𝑟</ci><cn type="integer" id="alg1.l9.m2.2.2.4.2.3.3.cmml" xref="alg1.l9.m2.2.2.4.2.3.3">1</cn></apply></apply><ci id="alg1.l9.m2.2.2.4.3.cmml" xref="alg1.l9.m2.2.2.4.3">𝑘</ci></apply><list id="alg1.l9.m2.2.2.2.3.cmml" xref="alg1.l9.m2.2.2.2.2"><apply id="alg1.l9.m2.1.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.1.1.1.2.cmml" xref="alg1.l9.m2.1.1.1.1.1.2">𝑤</ci><apply id="alg1.l9.m2.1.1.1.1.1.3.cmml" xref="alg1.l9.m2.1.1.1.1.1.3"><plus id="alg1.l9.m2.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m2.1.1.1.1.1.3.1"></plus><ci id="alg1.l9.m2.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m2.1.1.1.1.1.3.2">𝑟</ci><cn type="integer" id="alg1.l9.m2.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l9.m2.2.2.2.2.2.cmml" xref="alg1.l9.m2.2.2.2.2.2"><csymbol cd="latexml" id="alg1.l9.m2.2.2.2.2.2.1.cmml" xref="alg1.l9.m2.2.2.2.2.2.1">for-all</csymbol><ci id="alg1.l9.m2.2.2.2.2.2.2.cmml" xref="alg1.l9.m2.2.2.2.2.2.2">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.2c">w_{r+1}^{k}\leftarrow w_{r+1}\ \ \forall k</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.3.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg1.l12.2" class="ltx_text ltx_font_bold">Local-Training(<math id="alg1.l12.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l12.1.m1.1a"><mi id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">k</annotation></semantics></math>, <math id="alg1.l12.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l12.2.m2.1a"><mi id="alg1.l12.2.m2.1.1" xref="alg1.l12.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l12.2.m2.1b"><ci id="alg1.l12.2.m2.1.1.cmml" xref="alg1.l12.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.2.m2.1c">w</annotation></semantics></math>):</span>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.3.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text">Split data on client <math id="alg1.l13.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l13.1.m1.1a"><mi id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">k</annotation></semantics></math> into <math id="alg1.l13.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l13.2.m2.1a"><mi id="alg1.l13.2.m2.1.1" xref="alg1.l13.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.2.m2.1b"><ci id="alg1.l13.2.m2.1.1.cmml" xref="alg1.l13.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.2.m2.1c">B</annotation></semantics></math> batches</span>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span> each local epoch, <math id="alg1.l14.m1.1" class="ltx_Math" alttext="l=1...LE" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">l</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">=</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mn id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.1a" xref="alg1.l14.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l14.m1.1.1.3.4" xref="alg1.l14.m1.1.1.3.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.1b" xref="alg1.l14.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l14.m1.1.1.3.5" xref="alg1.l14.m1.1.1.3.5.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><eq id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></eq><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑙</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><times id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></times><cn type="integer" id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">1</cn><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">…</ci><ci id="alg1.l14.m1.1.1.3.4.cmml" xref="alg1.l14.m1.1.1.3.4">𝐿</ci><ci id="alg1.l14.m1.1.1.3.5.cmml" xref="alg1.l14.m1.1.1.3.5">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">l=1...LE</annotation></semantics></math> <span id="alg1.l14.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>         <span id="alg1.l15.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l15.m1.1" class="ltx_Math" alttext="b\in B" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">b</mi><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">∈</mo><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><in id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></in><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑏</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">b\in B</annotation></semantics></math> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>              <math id="alg1.l16.m1.2" class="ltx_Math" alttext="w\leftarrow w-\eta*\nabla_{w}\ \ell(w;b)" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.3" xref="alg1.l16.m1.2.3.cmml"><mi id="alg1.l16.m1.2.3.2" xref="alg1.l16.m1.2.3.2.cmml">w</mi><mo stretchy="false" id="alg1.l16.m1.2.3.1" xref="alg1.l16.m1.2.3.1.cmml">←</mo><mrow id="alg1.l16.m1.2.3.3" xref="alg1.l16.m1.2.3.3.cmml"><mi id="alg1.l16.m1.2.3.3.2" xref="alg1.l16.m1.2.3.3.2.cmml">w</mi><mo id="alg1.l16.m1.2.3.3.1" xref="alg1.l16.m1.2.3.3.1.cmml">−</mo><mrow id="alg1.l16.m1.2.3.3.3" xref="alg1.l16.m1.2.3.3.3.cmml"><mrow id="alg1.l16.m1.2.3.3.3.2" xref="alg1.l16.m1.2.3.3.3.2.cmml"><mi id="alg1.l16.m1.2.3.3.3.2.2" xref="alg1.l16.m1.2.3.3.3.2.2.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l16.m1.2.3.3.3.2.1" xref="alg1.l16.m1.2.3.3.3.2.1.cmml">∗</mo><mrow id="alg1.l16.m1.2.3.3.3.2.3" xref="alg1.l16.m1.2.3.3.3.2.3.cmml"><msub id="alg1.l16.m1.2.3.3.3.2.3.1" xref="alg1.l16.m1.2.3.3.3.2.3.1.cmml"><mo rspace="0.167em" id="alg1.l16.m1.2.3.3.3.2.3.1.2" xref="alg1.l16.m1.2.3.3.3.2.3.1.2.cmml">∇</mo><mi id="alg1.l16.m1.2.3.3.3.2.3.1.3" xref="alg1.l16.m1.2.3.3.3.2.3.1.3.cmml">w</mi></msub><mi mathvariant="normal" id="alg1.l16.m1.2.3.3.3.2.3.2" xref="alg1.l16.m1.2.3.3.3.2.3.2.cmml">ℓ</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.3.3.3.1" xref="alg1.l16.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l16.m1.2.3.3.3.3.2" xref="alg1.l16.m1.2.3.3.3.3.1.cmml"><mo stretchy="false" id="alg1.l16.m1.2.3.3.3.3.2.1" xref="alg1.l16.m1.2.3.3.3.3.1.cmml">(</mo><mi id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">w</mi><mo id="alg1.l16.m1.2.3.3.3.3.2.2" xref="alg1.l16.m1.2.3.3.3.3.1.cmml">;</mo><mi id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml">b</mi><mo stretchy="false" id="alg1.l16.m1.2.3.3.3.3.2.3" xref="alg1.l16.m1.2.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.3.cmml" xref="alg1.l16.m1.2.3"><ci id="alg1.l16.m1.2.3.1.cmml" xref="alg1.l16.m1.2.3.1">←</ci><ci id="alg1.l16.m1.2.3.2.cmml" xref="alg1.l16.m1.2.3.2">𝑤</ci><apply id="alg1.l16.m1.2.3.3.cmml" xref="alg1.l16.m1.2.3.3"><minus id="alg1.l16.m1.2.3.3.1.cmml" xref="alg1.l16.m1.2.3.3.1"></minus><ci id="alg1.l16.m1.2.3.3.2.cmml" xref="alg1.l16.m1.2.3.3.2">𝑤</ci><apply id="alg1.l16.m1.2.3.3.3.cmml" xref="alg1.l16.m1.2.3.3.3"><times id="alg1.l16.m1.2.3.3.3.1.cmml" xref="alg1.l16.m1.2.3.3.3.1"></times><apply id="alg1.l16.m1.2.3.3.3.2.cmml" xref="alg1.l16.m1.2.3.3.3.2"><times id="alg1.l16.m1.2.3.3.3.2.1.cmml" xref="alg1.l16.m1.2.3.3.3.2.1"></times><ci id="alg1.l16.m1.2.3.3.3.2.2.cmml" xref="alg1.l16.m1.2.3.3.3.2.2">𝜂</ci><apply id="alg1.l16.m1.2.3.3.3.2.3.cmml" xref="alg1.l16.m1.2.3.3.3.2.3"><apply id="alg1.l16.m1.2.3.3.3.2.3.1.cmml" xref="alg1.l16.m1.2.3.3.3.2.3.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.3.3.2.3.1.1.cmml" xref="alg1.l16.m1.2.3.3.3.2.3.1">subscript</csymbol><ci id="alg1.l16.m1.2.3.3.3.2.3.1.2.cmml" xref="alg1.l16.m1.2.3.3.3.2.3.1.2">∇</ci><ci id="alg1.l16.m1.2.3.3.3.2.3.1.3.cmml" xref="alg1.l16.m1.2.3.3.3.2.3.1.3">𝑤</ci></apply><ci id="alg1.l16.m1.2.3.3.3.2.3.2.cmml" xref="alg1.l16.m1.2.3.3.3.2.3.2">ℓ</ci></apply></apply><list id="alg1.l16.m1.2.3.3.3.3.1.cmml" xref="alg1.l16.m1.2.3.3.3.3.2"><ci id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">𝑤</ci><ci id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2">𝑏</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">w\leftarrow w-\eta*\nabla_{w}\ \ell(w;b)</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>         <span id="alg1.l17.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l17.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>     <span id="alg1.l18.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.2.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>     <span id="alg1.l19.1" class="ltx_text">return <math id="alg1.l19.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l19.1.m1.1a"><mi id="alg1.l19.1.m1.1.1" xref="alg1.l19.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.1.m1.1b"><ci id="alg1.l19.1.m1.1.1.cmml" xref="alg1.l19.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.1.m1.1c">w</annotation></semantics></math></span>

</div>
</div>
</figure>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p">In this paper, we used the FedAvg method, as described in Algorithm 1, when training our two instances of Plankton-FL.
To test the feasibility and potential of federated learning, three different experiments were simulated. Specifically, a centralized learning baseline (CL), a (centralized) federated learning framework (FL), and a mutually exclusive, federated learning framework (ME-FL). Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> provides a visual representation of each of the three experiments.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Centralized Learning (CL)</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">For the CL experiment, we have two data sources that we consolidate into a single server. From there we train a centralized model, which can then be deployed back to the edge devices for assessment and monitoring. The model was trained for a maximum of 75 epochs, with an early stopping criteria: A minimum of 50 epochs and a <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\delta</annotation></semantics></math> between test accuracies of 0.000001.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Federated Learning (FL)</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">In the FL experiment, all of the training data was combined, randomly shuffled, and distributed to clients. Each client trained their own local model, on-prem, and only communicated their parameters back to the global server. FL was run for 10 iterations, where each iteration number corresponded to the number of clients. Namely, for the first iteration, there was only one client containing all of the training data, identical to CL, and with each increasing iteration another client was added (i.e. second iteration utilized two clients, etc.). Although, in reality, no single client will contain all of the data, for the purpose of comparing to CL, it made sense to start with a single client.
</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Mutually Exclusive FL (ME-FL)</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">Unlike FL, in ME-FL, instead of combining all of the data together, shuffling, and distributing them, the clients only contained data from a single source, making them mutually exclusive. Again, each of the clients trained their own model, on-prem, and only communicated their parameters back to the global server. ME-FL was run for 9 iterations, starting from 2 clients up to 10. Iterations start from 2 clients due to the nature of the experiment; since each client only has data from a single source, it would not make sense to only have a single client. This modified setup ensures that we always have data from both sources.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experimental Setup</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Dataset</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The dataset was provided by Blue Lion Labs and was collected from two mutually exclusive sources, Halifax and Waterloo.
It contained 301 distinct microscope specimen photos, each at a resolution of 3208 x 2200 pixels. The phytoplankton contained in these images are from eleven different species: <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_italic">Entomoneis paludosa</span>, <span id="S3.SS1.p1.1.2" class="ltx_text ltx_font_italic">Alexandra catenella</span>, <span id="S3.SS1.p1.1.3" class="ltx_text ltx_font_italic">Pymnesium parvum</span>, <span id="S3.SS1.p1.1.4" class="ltx_text ltx_font_italic">Navicula sp</span>, <span id="S3.SS1.p1.1.5" class="ltx_text ltx_font_italic">Heterosigma akashiwo</span>, <span id="S3.SS1.p1.1.6" class="ltx_text ltx_font_italic">Prorocentrum lima</span>, <span id="S3.SS1.p1.1.7" class="ltx_text ltx_font_italic">Alexandrium ostenfeldii</span>, <span id="S3.SS1.p1.1.8" class="ltx_text ltx_font_italic">Porphyridium purpureum</span>, <span id="S3.SS1.p1.1.9" class="ltx_text ltx_font_italic">Dolichospermum</span>, <span id="S3.SS1.p1.1.10" class="ltx_text ltx_font_italic">Phaeodactylum tricornutum M1</span>, and <span id="S3.SS1.p1.1.11" class="ltx_text ltx_font_italic">Phaeodactylum tricornutum M2</span>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Model Architecture</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">For the purpose of this exploration, we took the majority class present in each image as the label to do image classification. This ensures that all models receive the same amount of information. Given the task, we built a custom convolutional neural network with four convolutional layers, three max-pooling layers, two dense layers, and an output layer. Across all intermediate layers, the ReLU activation function was used, and at the output, a softmax activation was used to predict the probabilities of each class. For all the convolutional layers, a kernel of size 3x3 and a stride of 1x1 was used and for all of the pooling layers, a pool and stride size of 2x2 was used. Additionally, dropout was used with a rate of 0.25 after the convolutional layers and a rate of 0.5 after the first dense layer.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Model Training and Evaluation</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">When training, the images were resized to a resolution of 128 x 128 pixels and further augmented, using a horizontal flip, vertical flip, rotation, and color jitter, to create a larger data set of 2107 images. Across all experiments, the model architectures were held the same, a batch size of 8 was used, and the data was split into 80% training and 20% test. We also tune the learning rate across all experiments via a grid search over three different learning rates (LR) of 0.001, 0.0001, and 0.0005. Both of the federated learning experiments were run for 75 rounds and each local model was trained for 1 epoch. Furthermore, given it is a multi-label image classification task, the metric considered is prediction accuracy and the loss function is categorical cross-entropy.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.1" class="ltx_tabular ltx_align_middle">
<tr id="S3.T1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="S3.T1.1.1.1.1" class="ltx_inline-block">
<span id="S3.T1.1.1.1.1.1" class="ltx_p"><span id="S3.T1.1.1.1.1.1.1" class="ltx_text ltx_font_bold"># of</span></span>
<span id="S3.T1.1.1.1.1.2" class="ltx_p"><span id="S3.T1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">clients</span></span>
</span>
</td>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S3.T1.1.1.2.1" class="ltx_inline-block">
<span id="S3.T1.1.1.2.1.1" class="ltx_p"><span id="S3.T1.1.1.2.1.1.1" class="ltx_text ltx_font_bold">Centralized</span></span>
<span id="S3.T1.1.1.2.1.2" class="ltx_p"><span id="S3.T1.1.1.2.1.2.1" class="ltx_text ltx_font_bold">Learning (CL)</span></span>
</span>
</td>
<td id="S3.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S3.T1.1.1.3.1" class="ltx_inline-block">
<span id="S3.T1.1.1.3.1.1" class="ltx_p"><span id="S3.T1.1.1.3.1.1.1" class="ltx_text ltx_font_bold">Federated</span></span>
<span id="S3.T1.1.1.3.1.2" class="ltx_p"><span id="S3.T1.1.1.3.1.2.1" class="ltx_text ltx_font_bold">Learning (FL)</span></span>
</span>
</td>
<td id="S3.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S3.T1.1.1.4.1" class="ltx_inline-block">
<span id="S3.T1.1.1.4.1.1" class="ltx_p"><span id="S3.T1.1.1.4.1.1.1" class="ltx_text ltx_font_bold">Mutually Exclusive</span></span>
<span id="S3.T1.1.1.4.1.2" class="ltx_p"><span id="S3.T1.1.1.4.1.2.1" class="ltx_text ltx_font_bold">FL (ME-FL)</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.1.2" class="ltx_tr">
<td id="S3.T1.1.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">1</td>
<td id="S3.T1.1.2.2" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S3.T1.1.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92%</td>
<td id="S3.T1.1.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
</tr>
<tr id="S3.T1.1.3" class="ltx_tr">
<td id="S3.T1.1.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">2</td>
<td id="S3.T1.1.3.2" class="ltx_td ltx_border_r"></td>
<td id="S3.T1.1.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">89%</td>
<td id="S3.T1.1.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">63%</td>
</tr>
<tr id="S3.T1.1.4" class="ltx_tr">
<td id="S3.T1.1.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">3</td>
<td id="S3.T1.1.4.2" class="ltx_td ltx_border_r"></td>
<td id="S3.T1.1.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">79%</td>
<td id="S3.T1.1.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60%</td>
</tr>
<tr id="S3.T1.1.5" class="ltx_tr">
<td id="S3.T1.1.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">4</td>
<td id="S3.T1.1.5.2" class="ltx_td ltx_border_r"></td>
<td id="S3.T1.1.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75%</td>
<td id="S3.T1.1.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">65%</td>
</tr>
<tr id="S3.T1.1.6" class="ltx_tr">
<td id="S3.T1.1.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">5</td>
<td id="S3.T1.1.6.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.1.6.2.1" class="ltx_text">91%</span></td>
<td id="S3.T1.1.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">82%</td>
<td id="S3.T1.1.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">31%</td>
</tr>
<tr id="S3.T1.1.7" class="ltx_tr">
<td id="S3.T1.1.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">6</td>
<td id="S3.T1.1.7.2" class="ltx_td ltx_border_r"></td>
<td id="S3.T1.1.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">77%</td>
<td id="S3.T1.1.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55%</td>
</tr>
<tr id="S3.T1.1.8" class="ltx_tr">
<td id="S3.T1.1.8.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">7</td>
<td id="S3.T1.1.8.2" class="ltx_td ltx_border_r"></td>
<td id="S3.T1.1.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76%</td>
<td id="S3.T1.1.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">47%</td>
</tr>
<tr id="S3.T1.1.9" class="ltx_tr">
<td id="S3.T1.1.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">8</td>
<td id="S3.T1.1.9.2" class="ltx_td ltx_border_r"></td>
<td id="S3.T1.1.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78%</td>
<td id="S3.T1.1.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">18%</td>
</tr>
<tr id="S3.T1.1.10" class="ltx_tr">
<td id="S3.T1.1.10.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">9</td>
<td id="S3.T1.1.10.2" class="ltx_td ltx_border_r"></td>
<td id="S3.T1.1.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76%</td>
<td id="S3.T1.1.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53%</td>
</tr>
<tr id="S3.T1.1.11" class="ltx_tr">
<td id="S3.T1.1.11.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_r ltx_border_t">10</td>
<td id="S3.T1.1.11.2" class="ltx_td ltx_border_b ltx_border_r"></td>
<td id="S3.T1.1.11.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">75%</td>
<td id="S3.T1.1.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">16%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>The experimental results across all setups, for a learning rate of 0.0001. FL yielded a higher test accuracy than CL for a single client, but for all other clients, it is outperformed. ME-FL consistently yields the lowest test accuracies across every number of clients.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results &amp; Discussion</h2>

<figure id="S4.F2" class="ltx_figure"><img src="/html/2212.08990/assets/Exp_summary_3_row_thicker.png" id="S4.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="300" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The test accuracies, across all experiments, per epoch with a learning rate of 0.0001. CL (left) was trained for 51 epochs and achieved a test accuracy of 91%, both FL (middle) and ME-FL had 10 clients and achieved test accuracies of 78% and 16%, respectively after 75 epochs.</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Comparison of Performance Across Experiments</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Table <a href="#S3.T1" title="Table 1 ‣ 3.3 Model Training and Evaluation ‣ 3 Experimental Setup ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> provides a numerical comparison across all experiments utilizing a learning rate of 0.0001. Note that, CL, FL, and ME-FL were trained for 51, 75, and 75 epochs, respectively. Firstly, when comparing CL and FL, we observe that for a single client FL outperforms CL. However, this is expected because FL with a single client is the exact same setup as CL; we expect the test accuracies to be very close in magnitude, and it is entirely possible that FL can outperform CL in this scenario. For all other number of clients, FL has a progressively worse test accuracy and is continuously outperformed by CL. In addition, across all number of clients, we observe that ME-FL consistently gets outperformed by CL and FL, which further demonstrates the impracticality of this method.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Figure <a href="#S4.F2" title="Figure 2 ‣ 4 Results &amp; Discussion ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> provides a visual comparison of CL, FL, and ME-FL across all epochs. We specifically look at the results for 10 clients of both FL and ME-FL, as in reality there are often large numbers of clients. From the figure, CL and FL both appear to learn, whereas ME-FL does not appear to learn at all. Comparing CL and FL, we observe that CL converges much faster than FL, which tells us that CL learns faster than FL.
Overall, across all experiments, generally, we observed that CL performed the best, FL performed the second best, and ME-FL had the worst performance and this same trend is observed across each learning rate.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Downward Trend in FL Across Number of Clients</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">From table <a href="#S3.T1" title="Table 1 ‣ 3.3 Model Training and Evaluation ‣ 3 Experimental Setup ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and figure <a href="#S4.F2" title="Figure 2 ‣ 4 Results &amp; Discussion ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we observe that FL performs relatively well, which prompted an investigation into its properties. Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2 Downward Trend in FL Across Number of Clients ‣ 4 Results &amp; Discussion ‣ Plankton-FL: Exploration of Federated Learning for Privacy-Preserving Training of Deep Neural Networks for Phytoplankton Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> displays the global model test accuracies for FL, for all numbers of clients, across the three learning rates. We observe a downward trend in the test accuracies as the number of clients increases. With an increasing number of clients, the global model needs to process and learn more information (i.e. the global model has to aggregate weights from more sources). With more information to process, learning is slowed down, yielding a worse generalization.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2212.08990/assets/FL_three_row_with_axes_thicker_lines.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="375" height="170" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>FL global model final test accuracy per number of clients, under each different learning rate. This illustrates that for all learning rates, we observe a downward trend as we increase the number of clients</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Causation of Poor ME-FL Performance</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">The largest contributor as to why ME-FL had a subpar performance relative to FL was because ME-FL was trained on individual, mutually exclusive clients. In our FL experiments we utilize a homogeneous model architecture, that is, all clients and the global server have the same model architecture. The nature of FL yields an independent and identically distributed (IID) distribution of labels across clients. However, in ME-FL, the distribution across clients is non-IID. As discussed in other literature, homogeneous federated learning performs poorly on non-IID data distributions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.
Given this limitation, heterogeneous federated learning  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> is an alternative approach that should be explored. In this method, clients are allowed to differ in network architecture, allowing for more flexibility. Research has been done to explore applications of heterogeneous federated learning to mutually exclusive data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and it has typically been the preferred approach over homogeneous federated learning.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion &amp; Future Works</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This work demonstrates the feasibility and potential of Plankton-FL for the privacy-preserving building of high-performance, generalizable models for phytoplankton assessment without the need to exchange data. We simulated two different federated learning frameworks and compared their performance to a traditional, centralized learning framework. Although centralized learning yields the best performance, it does not address privacy concerns. Federated learning preserves privacy but fails to generalize when clients are mutually exclusive. We find that when clients share class labels with one another, federated learning both generalizes well and provides a privacy-preserving alternative to centralized learning.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Given the outcomes of this paper, the immediate future work includes (1) implementing this framework for object detection to build off the current work of image classification, (2) utilizing a heterogeneous federated learning framework and conducting the same experiments to assess the relative performance to homogeneous federated learning, and (3) explore novel federated learning-related methods. For example, another method that can be utilized is git re-basin, which aims to train individual models on disjoint datasets and merge them together  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Finally, careful consideration must be taken on how federated learning frameworks will be deployed in the field to ensure data privacy between clients. This will help provide a secure and accurate method for identifying different species of phytoplankton and help alleviate the manual workload.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was funded by the Waterloo AI Institute and Mitacs. The dataset was provided by Blue Lion Labs, and the computing resources were provided by the Vision and Image Processing (VIP) Lab at the University of Waterloo and Blue Lion Labs.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
E. Granéli and J. Turner, <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">An Introduction to Harmful Algae</em>, 01 2006,
vol. 189, pp. 3–7.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. L. Wells, B. Karlson, A. Wulff, R. Kudela, C. Trick, V. Asnaghi,
E. Berdalet, W. Cochlan, K. Davidson, M. De Rijcke, S. Dutkiewicz,
G. Hallegraeff, K. J. Flynn, C. Legrand, H. Paerl, J. Silke, S. Suikkanen,
P. Thompson, and V. L. Trainer, “Future hab science: Directions and
challenges in a changing climate,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Harmful Algae</em>, vol. 91, p. 101632,
2020, climate change and harmful algal blooms. [Online]. Available:
<a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S156898831930099X" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S156898831930099X</a>

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
J. L. Deglint, C. Jin, and A. Wong, “Investigating the automatic
classification of algae using the spectral and morphological characteristics
via deep residual learning,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">International Conference on Image
Analysis and Recognition</em>.   Springer,
2019, pp. 269–280.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
N. Bamra, V. S. Voleti, A. Wong, and J. L. Deglint, “Towards generating large
synthetic phytoplankton datasets for efficient monitoring of harmful algal
blooms,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2208.02332, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
H. B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">AISTATS</em>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1806.00582, 2018.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
N. Rieke, J. Hancox, W. Li, F. Milletarì, H. R. Roth, S. Albarqouni,
S. Bakas, M. N. Galtier, B. A. Landman, K. Maier-Hein, S. Ourselin,
M. Sheller, R. M. Summers, A. Trask, D. Xu, M. Baust, and M. J. Cardoso,
“The future of digital health with federated learning,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">npj Digital
Medicine</em>, vol. 3, no. 1, p. 119, Sep 2020. [Online]. Available:
<a target="_blank" href="https://doi.org/10.1038/s41746-020-00323-1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1038/s41746-020-00323-1</a>

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
D. Li and J. Wang, “Fedmd: Heterogenous federated learning via model
distillation,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/1910.03581, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
F. Yu, W. Zhang, Z. Qin, Z. Xu, D. Wang, C. Liu, Z. Tian, and X. Chen,
“Heterogeneous federated learning,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2008.06767,
2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
G. K. Gudur and S. K. Perepu, “Federated learning with heterogeneous labels
and models for mobile activity monitoring,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol.
abs/2012.02539, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. K. Ainsworth, J. Hayase, and S. S. Srinivasa, “Git re-basin: Merging models
modulo permutation symmetries,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, vol. abs/2209.04836, 2022.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2212.08989" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2212.08990" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2212.08990">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2212.08990" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2212.08992" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 10:35:22 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
