<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.13278] Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding</title><meta property="og:description" content="Ultrasonic metal welding (UMW) is a key joining technology with widespread industrial applications. Condition monitoring (CM) capabilities are critically needed in UMW applications, because process anomalies, such as t…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.13278">

<!--Generated on Sun May  5 17:53:08 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ahmadreza Eslaminia
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ae15@illinois.edu">ae15@illinois.edu</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuquan Meng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yuquanm2@illinois.edu">yuquanm2@illinois.edu</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Klara Nahrstedt
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:klara@illinois.edu">klara@illinois.edu</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chenhui Shao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:chshao@umich.edu">chshao@umich.edu</a>
</span>
<span class="ltx_contact ltx_role_address">Department of Mechanical Science and Engineering, University of Illinois at Urbana-Champaign, Urbana, IL 61801, USA
</span>
<span class="ltx_contact ltx_role_address">Coordinated Science Laboratory, University of Illinois at Urbana-Champaign, Urbana, IL 61801, USA
</span>
<span class="ltx_contact ltx_role_address">Department of Mechanical Engineering, University of Michigan, Ann Arbor, MI 48109, USA
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Ultrasonic metal welding (UMW) is a key joining technology with widespread industrial applications. Condition monitoring (CM) capabilities are critically needed in UMW applications, because process anomalies, such as tool degradation and workpiece surface contamination, significantly deteriorate the joining quality. Recently, machine learning models emerged as a promising tool for CM in many manufacturing applications due to their ability to learn complex patterns. Yet, the successful deployment of these models requires substantial training data that may be expensive and time-consuming to collect. Additionally, many existing machine learning models lack generalizability or adaptability and cannot be directly applied to new process configurations (i.e., domains). Such issues may be potentially alleviated by pooling data across manufacturers or factories, but data sharing raises critical data privacy concerns that have prohibited collaborative learning in industry. To address these challenges, this paper presents a Federated Transfer Learning with Task Personalization (FTL-TP) framework that provides domain generalization capabilities in distributed learning while ensuring data privacy. By effectively learning a unified representation from feature space, FTL-TP can adapt CM models for clients working on similar tasks, thereby enhancing their overall adaptability and performance jointly. To demonstrate the effectiveness of FTL-TP, we investigate two distinct UMW CM tasks, including tool condition monitoring and workpiece surface condition classification. Compared with state-of-the-art FL algorithms, FTL-TP achieves a 5.35%–8.08% improvement of accuracy in CM in new target domains. FTL-TP is also shown to achieve excellent performance in challenging scenarios involving unbalanced data distributions and limited client fractions. Furthermore, by implementing the FTL-TP method on an edge-cloud architecture, we show that this method is both viable and efficient in practice. The FTL-TP framework is readily extensible to various other manufacturing applications.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Federated learning, Condition monitoring , Anomaly detection , Ultrasonic metal welding , Domain generalization , Quality control

</div>
<div id="p1" class="ltx_para ltx_noindent">
<span id="p1.1" class="ltx_ERROR undefined">\xpatchcmd</span>
<p id="p1.2" class="ltx_p"><span id="p1.2.1" class="ltx_text ltx_font_bold">end</span> <span id="p1.2.2" class="ltx_text ltx_font_bold">forend</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Ultrasonic metal welding (UMW) is an advanced joining technology, which utilizes high-frequency oscillation shear forces to create strong solid-state joint. It has been used in a wide range of industrial applications, including automotive body construction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and lithium-ion battery assembly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Compared to conventional fusion welding methods, UMW offers several important advantages, such as reduced energy consumption, lower emissions, higher production rates, and environmental friendliness <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Therefore, it is one of the promising dissimilar metal joining techniques for sustainable manufacturing.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Despite numerous advantages, the quality of UMW joint is significantly influenced by process anomalies that may take different forms. Tool degradation and surface contamination of workpieces are two major causes of such anomalies in UMW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. As such, developing effective and efficient condition monitoring (CM) method is of vital importance to ensure quality and reliability of industrial UMW. CM for UMW has attracted in-depth research attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Some methods achieved close-to-perfect CM performance when sufficient training data is available <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Nevertheless, the existing CM methods are mostly created for a fixed configuration (i.e., domain). When the UMW configurations, such as material of specimens and welding parameters, are changed, the well-trained models do not work well and their accuracy substantially drops <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. To adapt to new process configurations, existing CM methods require access to sufficient training data collected from the new configurations. However, re-collection of such data can be both expensive and time-consuming in manufacturing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. This necessitates the development of a methodology that can generalize and adapt to new configurations efficiently.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Previous studies showed that having access to extensive data encompassing diverse configurations/domains may improve a model’s generalizability, which implies that pooling data from diverse configurations provides a potential solution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. However, a single company or factory may not possess enough data covering multiple configurations. Consequently, collaborative model training across different companies/factories could be advantageous. However, collaborative learning through data pooling may raise significant data privacy concerns <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Furthermore, resistance to data integration can occur even within different departments of the same organization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">This paper aims to develop a method with high generalizability to unseen domains through collaborative data analysis across different manufacturing sites without compromising data privacy. To this end, an innovative Federated Transfer Learning with Task Personalization (FTL-TP) framework is proposed. FTL-TP is designed to operate across two or more distinct UMW CM tasks, such as tool condition monitoring and surface condition classification. These tasks are explored under various process configurations/domains, such as different materials for the joining sheets. This study introduces a strategy to effectively transfer knowledge by learning a generalized representation of the feature space shared across different datasets acquired from different companies while still preserving privacy. Additionally, we introduce a new loss function to improve both the generalizability and convergence of the model under varying configurations/domains. The main contributions of this research are summarized as follows:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">The FTL-TP framework successfully achieves domain generalization in the context of FL. Compared with baseline FL algorithms, such as FedAvg and FedProx, our framework exhibits superior performance, with an accuracy improvement of 5.35%–8.08% in new, previously unseen target domains.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">By implementing FL, this research is the first to integrate data privacy into data-driven CM of UMW. This addresses the industrial-wide concerns of data safety and data privacy, laying a foundation of large-scale collaborations among companies that use UMW in their production.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">To demonstrate the industrial applicability of the FTL-TP, we implement FTL-TP in a real-world cyber-manufacturing environment and evaluate the computing efficiency. By running on an edge-cloud architecture, where Raspberry Pi’s serve as edge devices, and a message broker is utilized for weight transmission, FTL-TP is shown to be not only data-efficient but also time-efficient, proving its potential for widespread applications in smart manufacturing.</p>
</div>
</li>
</ol>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The reminder of this paper is organized as follows. In Section <a href="#S2" title="2 Related Work and Background ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the existing literature is reviewed in detail. Section <a href="#S3" title="3 Problem Formulation and Data Description ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> formulates the problem and describes the dataset used in this study. Section <a href="#S4" title="4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> introduces the proposed FTL-TP framework and presents its architecture and the algorithm in detail. Several case studies are presented in Section <a href="#S5" title="5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> to thoroughly evaluate the effectiveness of the FTL-TP framework. Subsequently, Section <a href="#S6" title="6 Discussion ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> provides an in-depth discussion about the learning process, implications of the findings, and directions for future research. Finally, Section <a href="#S7" title="7 Conclusion ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> concludes the paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work and Background</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Data-driven CM for UMW</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Data-driven CM methods are becoming increasingly crucial in many industrial applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, such as additive manufacturing, machining, and air brake systems  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. Similarly, in recent years, machine learning methods for monitoring UMW processes have also yielded promising outcomes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. For example, Nazir and Shao <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> developed an online sensing system and investigated several machine learning algorithms, such as logistic regression, K-nearest neighbors, and SVM, to predict tool conditions in a real-time fashion. Wu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> utilized residual networks to predict joint quality in UMW with sensing signals. Schwarz et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> improved process monitoring of UMW by using linear regression as well as multi-layer perceptron (MLP) regression to predict tensile shear strength. Most recently, Lu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> implemented an MLP classifier for identifying mixed welding disturbances, focusing on tool conditions and material surface conditions.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Despite these advances, a common challenge among most of these studies is their limited generalization ability across varying industrial situations due to domain shift, which means the data distribution changes between different domains used for training and deployment. This discrepancy can significantly impact the performance of machine learning models under different configurations, as demonstrated in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Only a few studies have aimed at addressing this challenge for the CM of UMW processes. Tian et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> introduced a neural network (NN) model that incorporates an augmentation strategy to tackle the issue of domain shifts in CM tasks within UMW. Meng et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> developed a few-shot learning method to address the variability of configurations in online anomaly detection for UMW. Despite good performance, these models encounter difficulties when there are no data available at all for target domains. This type of extreme data scarcity situations is referred to as “domain generalization.”</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Collaborative learning across data resources emerges as a viable solution to overcome data constraints, offering a potential remedy in such scenarios. Nonetheless, the implementation of collaborative learning often encounters privacy concerns, posing a significant barrier in many cases.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Federated learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In recent years, FL has emerged as a promising solution to the challenges of data availability and privacy in distributed learning environments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. The FedAvg method, a widely recognized baseline introduced by McMahan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, facilitates collaborative training across multiple data resources/clients without sharing raw data. Figure <a href="#S2.F1" title="Figure 1 ‣ 2.2 Federated learning ‣ 2 Related Work and Background ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates a typical FL procedure. In each server round, the central server initially sends the model parameters to each participating client. Subsequently, clients independently train the received model on their local data and then transmit their local models’ parameter updates back to the central server, which then aggregates these updates. The server round iterates until the model meets convergence criteria or a predetermined number of iterations is achieved.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2404.13278/assets/FL-3.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="244" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S2.F1.3.2" class="ltx_text" style="font-size:90%;">A schematic for training process in FL regime.</span></figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.5" class="ltx_p">The FedAvg algorithm assumes in each server round, we have <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">m</annotation></semantics></math> clients available from all <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">M</annotation></semantics></math> clients. The total number of data points <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">N</annotation></semantics></math> is obtained by summing <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><msub id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">n</mi><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑛</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">n_{k}</annotation></semantics></math>, the data points from each of the <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mi id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">m</annotation></semantics></math> clients.
The primary objective of FedAvg is to minimize the following optimization function:</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\arg\min_{\theta}F(\theta)=\frac{1}{N}\sum_{k=1}^{m}n_{k}\cdot F_{k}(\theta)," display="block"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.1" xref="S2.E1.m1.3.3.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E1.m1.3.3.1.1.2.2a" xref="S2.E1.m1.3.3.1.1.2.2.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.cmml"><munder id="S2.E1.m1.3.3.1.1.2.2.2.1" xref="S2.E1.m1.3.3.1.1.2.2.2.1.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.2.1.2" xref="S2.E1.m1.3.3.1.1.2.2.2.1.2.cmml">min</mi><mi id="S2.E1.m1.3.3.1.1.2.2.2.1.3" xref="S2.E1.m1.3.3.1.1.2.2.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S2.E1.m1.3.3.1.1.2.2.2a" xref="S2.E1.m1.3.3.1.1.2.2.2.cmml">⁡</mo><mi id="S2.E1.m1.3.3.1.1.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.cmml">F</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.1" xref="S2.E1.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.3.2.1" xref="S2.E1.m1.3.3.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.3.2.2" xref="S2.E1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><mfrac id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml"><mn id="S2.E1.m1.3.3.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.cmml">1</mn><mi id="S2.E1.m1.3.3.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.3.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.3.1" xref="S2.E1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.3.3" xref="S2.E1.m1.3.3.1.1.3.3.cmml"><munderover id="S2.E1.m1.3.3.1.1.3.3.1" xref="S2.E1.m1.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.3.3.1.1.3.3.1.2.2" xref="S2.E1.m1.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.3.3.1.2.3" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.3.1.2.3.2" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.3.3.1.1.3.3.1.2.3.1" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.3.3.1.1.3.3.1.2.3.3" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.3.3.1.1.3.3.1.3" xref="S2.E1.m1.3.3.1.1.3.3.1.3.cmml">m</mi></munderover><mrow id="S2.E1.m1.3.3.1.1.3.3.2" xref="S2.E1.m1.3.3.1.1.3.3.2.cmml"><mrow id="S2.E1.m1.3.3.1.1.3.3.2.2" xref="S2.E1.m1.3.3.1.1.3.3.2.2.cmml"><msub id="S2.E1.m1.3.3.1.1.3.3.2.2.2" xref="S2.E1.m1.3.3.1.1.3.3.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.3.2.2.2.2" xref="S2.E1.m1.3.3.1.1.3.3.2.2.2.2.cmml">n</mi><mi id="S2.E1.m1.3.3.1.1.3.3.2.2.2.3" xref="S2.E1.m1.3.3.1.1.3.3.2.2.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.3.3.1.1.3.3.2.2.1" xref="S2.E1.m1.3.3.1.1.3.3.2.2.1.cmml">⋅</mo><msub id="S2.E1.m1.3.3.1.1.3.3.2.2.3" xref="S2.E1.m1.3.3.1.1.3.3.2.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.3.2.2.3.2" xref="S2.E1.m1.3.3.1.1.3.3.2.2.3.2.cmml">F</mi><mi id="S2.E1.m1.3.3.1.1.3.3.2.2.3.3" xref="S2.E1.m1.3.3.1.1.3.3.2.2.3.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.3.3.2.1" xref="S2.E1.m1.3.3.1.1.3.3.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.3.3.2.3.2" xref="S2.E1.m1.3.3.1.1.3.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.3.3.2.3.2.1" xref="S2.E1.m1.3.3.1.1.3.3.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.3.3.2.3.2.2" xref="S2.E1.m1.3.3.1.1.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"></eq><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><times id="S2.E1.m1.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1"></times><apply id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"><arg id="S2.E1.m1.3.3.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1"></arg><apply id="S2.E1.m1.3.3.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2"><apply id="S2.E1.m1.3.3.1.1.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.2.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1">subscript</csymbol><min id="S2.E1.m1.3.3.1.1.2.2.2.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.2"></min><ci id="S2.E1.m1.3.3.1.1.2.2.2.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.1.3">𝜃</ci></apply><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2">𝐹</ci></apply></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝜃</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><times id="S2.E1.m1.3.3.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1"></times><apply id="S2.E1.m1.3.3.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2"><divide id="S2.E1.m1.3.3.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2"></divide><cn type="integer" id="S2.E1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2">1</cn><ci id="S2.E1.m1.3.3.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3">𝑁</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3"><apply id="S2.E1.m1.3.3.1.1.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.3.3.1.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.3.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.3.3.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.3.3.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3"><eq id="S2.E1.m1.3.3.1.1.3.3.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.1.3.3.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.3.3.1.1.3.3.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.1.3.3.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.1.3">𝑚</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2"><times id="S2.E1.m1.3.3.1.1.3.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1"></times><apply id="S2.E1.m1.3.3.1.1.3.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2"><ci id="S2.E1.m1.3.3.1.1.3.3.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.1">⋅</ci><apply id="S2.E1.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.3.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.3.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.2.2">𝑛</ci><ci id="S2.E1.m1.3.3.1.1.3.3.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.2.3">𝑘</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.3.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.3.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.3.2.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.3.2">𝐹</ci><ci id="S2.E1.m1.3.3.1.1.3.3.2.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.2.3.3">𝑘</ci></apply></apply><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\arg\min_{\theta}F(\theta)=\frac{1}{N}\sum_{k=1}^{m}n_{k}\cdot F_{k}(\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p3.3" class="ltx_p">where <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">\theta</annotation></semantics></math> represents the model parameters, and <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="F_{k}(\theta)" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mrow id="S2.SS2.p3.2.m2.1.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><msub id="S2.SS2.p3.2.m2.1.2.2" xref="S2.SS2.p3.2.m2.1.2.2.cmml"><mi id="S2.SS2.p3.2.m2.1.2.2.2" xref="S2.SS2.p3.2.m2.1.2.2.2.cmml">F</mi><mi id="S2.SS2.p3.2.m2.1.2.2.3" xref="S2.SS2.p3.2.m2.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.2.m2.1.2.1" xref="S2.SS2.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.2.m2.1.2.3.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.2.m2.1.2.3.2.1" xref="S2.SS2.p3.2.m2.1.2.cmml">(</mo><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">θ</mi><mo stretchy="false" id="S2.SS2.p3.2.m2.1.2.3.2.2" xref="S2.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.2.cmml" xref="S2.SS2.p3.2.m2.1.2"><times id="S2.SS2.p3.2.m2.1.2.1.cmml" xref="S2.SS2.p3.2.m2.1.2.1"></times><apply id="S2.SS2.p3.2.m2.1.2.2.cmml" xref="S2.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.2.2.1.cmml" xref="S2.SS2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.2.2.2.cmml" xref="S2.SS2.p3.2.m2.1.2.2.2">𝐹</ci><ci id="S2.SS2.p3.2.m2.1.2.2.3.cmml" xref="S2.SS2.p3.2.m2.1.2.2.3">𝑘</ci></apply><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">F_{k}(\theta)</annotation></semantics></math> corresponds to the loss function of the <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">k</annotation></semantics></math>-th client.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.2" class="ltx_p">To effectively utilize FedAvg, it is essential to define some key parameters: client fraction <math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><mi id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">C</annotation></semantics></math>, indicating the proportion of clients participating in each aggregation; local epoch <math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><mi id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><ci id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">E</annotation></semantics></math>, the number of training epochs per client per server round. Algorithm <a href="#alg1a" title="Algorithm A1 ‣ Appendix A ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A1</span></a> in <a href="#A1" title="Appendix A ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a> outlines the specific steps involved for both the client and server components of FedAvg.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.7" class="ltx_p">To enhance the convergence of FedAvg’s, Li et al. (2020) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> proposed the FedProx method by adding a proximal term to the client loss, thereby limiting the impact of variable local updates. The objective function of each client in FedProx is:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S2.E2.m1.3" class="ltx_Math" alttext="\min_{\theta}h_{k}(\theta;\theta_{t})=F_{k}(\theta)+\frac{\mu}{2}\|\theta-\theta_{t}\|^{2}," display="block"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml"><munder id="S2.E2.m1.3.3.1.1.1.3.1" xref="S2.E2.m1.3.3.1.1.1.3.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3.1.2" xref="S2.E2.m1.3.3.1.1.1.3.1.2.cmml">min</mi><mi id="S2.E2.m1.3.3.1.1.1.3.1.3" xref="S2.E2.m1.3.3.1.1.1.3.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S2.E2.m1.3.3.1.1.1.3a" xref="S2.E2.m1.3.3.1.1.1.3.cmml">⁡</mo><msub id="S2.E2.m1.3.3.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3.2.2" xref="S2.E2.m1.3.3.1.1.1.3.2.2.cmml">h</mi><mi id="S2.E2.m1.3.3.1.1.1.3.2.3" xref="S2.E2.m1.3.3.1.1.1.3.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">θ</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml">;</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E2.m1.3.3.1.1.1.1.1.4" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml"><mrow id="S2.E2.m1.3.3.1.1.2.3" xref="S2.E2.m1.3.3.1.1.2.3.cmml"><msub id="S2.E2.m1.3.3.1.1.2.3.2" xref="S2.E2.m1.3.3.1.1.2.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.2.3.2.2" xref="S2.E2.m1.3.3.1.1.2.3.2.2.cmml">F</mi><mi id="S2.E2.m1.3.3.1.1.2.3.2.3" xref="S2.E2.m1.3.3.1.1.2.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.2.3.1" xref="S2.E2.m1.3.3.1.1.2.3.1.cmml">​</mo><mrow id="S2.E2.m1.3.3.1.1.2.3.3.2" xref="S2.E2.m1.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.2.3.3.2.1" xref="S2.E2.m1.3.3.1.1.2.3.cmml">(</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S2.E2.m1.3.3.1.1.2.3.3.2.2" xref="S2.E2.m1.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.2.2" xref="S2.E2.m1.3.3.1.1.2.2.cmml">+</mo><mrow id="S2.E2.m1.3.3.1.1.2.1" xref="S2.E2.m1.3.3.1.1.2.1.cmml"><mfrac id="S2.E2.m1.3.3.1.1.2.1.3" xref="S2.E2.m1.3.3.1.1.2.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.2.1.3.2" xref="S2.E2.m1.3.3.1.1.2.1.3.2.cmml">μ</mi><mn id="S2.E2.m1.3.3.1.1.2.1.3.3" xref="S2.E2.m1.3.3.1.1.2.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.1.1.2.1.2" xref="S2.E2.m1.3.3.1.1.2.1.2.cmml">​</mo><msup id="S2.E2.m1.3.3.1.1.2.1.1" xref="S2.E2.m1.3.3.1.1.2.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1.2.1.1.1.1" xref="S2.E2.m1.3.3.1.1.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.1.2.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.2.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">θ</mi><mo id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.E2.m1.3.3.1.1.2.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.3.3.1.1.2.1.1.3" xref="S2.E2.m1.3.3.1.1.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" xref="S2.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"></eq><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3"><apply id="S2.E2.m1.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1">subscript</csymbol><min id="S2.E2.m1.3.3.1.1.1.3.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1.2"></min><ci id="S2.E2.m1.3.3.1.1.1.3.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3.1.3">𝜃</ci></apply><apply id="S2.E2.m1.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2.2">ℎ</ci><ci id="S2.E2.m1.3.3.1.1.1.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2.3">𝑘</ci></apply></apply><list id="S2.E2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝜃</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></list></apply><apply id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"><plus id="S2.E2.m1.3.3.1.1.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.2"></plus><apply id="S2.E2.m1.3.3.1.1.2.3.cmml" xref="S2.E2.m1.3.3.1.1.2.3"><times id="S2.E2.m1.3.3.1.1.2.3.1.cmml" xref="S2.E2.m1.3.3.1.1.2.3.1"></times><apply id="S2.E2.m1.3.3.1.1.2.3.2.cmml" xref="S2.E2.m1.3.3.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.2.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.2.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.2.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.3.2.2">𝐹</ci><ci id="S2.E2.m1.3.3.1.1.2.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.2.3.2.3">𝑘</ci></apply><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝜃</ci></apply><apply id="S2.E2.m1.3.3.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1"><times id="S2.E2.m1.3.3.1.1.2.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.2"></times><apply id="S2.E2.m1.3.3.1.1.2.1.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.3"><divide id="S2.E2.m1.3.3.1.1.2.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.3"></divide><ci id="S2.E2.m1.3.3.1.1.2.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.3.2">𝜇</ci><cn type="integer" id="S2.E2.m1.3.3.1.1.2.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.3.3">2</cn></apply><apply id="S2.E2.m1.3.3.1.1.2.1.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.2.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1">superscript</csymbol><apply id="S2.E2.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.3.3.1.1.2.1.1.1.2.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.2">norm</csymbol><apply id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1"><minus id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.1"></minus><ci id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.2">𝜃</ci><apply id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.2">𝜃</ci><ci id="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S2.E2.m1.3.3.1.1.2.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\min_{\theta}h_{k}(\theta;\theta_{t})=F_{k}(\theta)+\frac{\mu}{2}\|\theta-\theta_{t}\|^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p5.6" class="ltx_p">where <math id="S2.SS2.p5.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S2.SS2.p5.1.m1.1a"><mi id="S2.SS2.p5.1.m1.1.1" xref="S2.SS2.p5.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.1b"><ci id="S2.SS2.p5.1.m1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.1c">\mu</annotation></semantics></math> represents a parameter controlling the proximal term, and <math id="S2.SS2.p5.2.m2.1" class="ltx_Math" alttext="\|\theta-\theta_{t}\|^{2}" display="inline"><semantics id="S2.SS2.p5.2.m2.1a"><msup id="S2.SS2.p5.2.m2.1.1" xref="S2.SS2.p5.2.m2.1.1.cmml"><mrow id="S2.SS2.p5.2.m2.1.1.1.1" xref="S2.SS2.p5.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p5.2.m2.1.1.1.1.2" xref="S2.SS2.p5.2.m2.1.1.1.2.1.cmml">‖</mo><mrow id="S2.SS2.p5.2.m2.1.1.1.1.1" xref="S2.SS2.p5.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS2.p5.2.m2.1.1.1.1.1.2" xref="S2.SS2.p5.2.m2.1.1.1.1.1.2.cmml">θ</mi><mo id="S2.SS2.p5.2.m2.1.1.1.1.1.1" xref="S2.SS2.p5.2.m2.1.1.1.1.1.1.cmml">−</mo><msub id="S2.SS2.p5.2.m2.1.1.1.1.1.3" xref="S2.SS2.p5.2.m2.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p5.2.m2.1.1.1.1.1.3.2" xref="S2.SS2.p5.2.m2.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S2.SS2.p5.2.m2.1.1.1.1.1.3.3" xref="S2.SS2.p5.2.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.SS2.p5.2.m2.1.1.1.1.3" xref="S2.SS2.p5.2.m2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.SS2.p5.2.m2.1.1.3" xref="S2.SS2.p5.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m2.1b"><apply id="S2.SS2.p5.2.m2.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m2.1.1.2.cmml" xref="S2.SS2.p5.2.m2.1.1">superscript</csymbol><apply id="S2.SS2.p5.2.m2.1.1.1.2.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p5.2.m2.1.1.1.2.1.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.2">norm</csymbol><apply id="S2.SS2.p5.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.1"><minus id="S2.SS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.1.1"></minus><ci id="S2.SS2.p5.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.1.2">𝜃</ci><apply id="S2.SS2.p5.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m2.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p5.2.m2.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.1.3.2">𝜃</ci><ci id="S2.SS2.p5.2.m2.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p5.2.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S2.SS2.p5.2.m2.1.1.3.cmml" xref="S2.SS2.p5.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m2.1c">\|\theta-\theta_{t}\|^{2}</annotation></semantics></math> denotes the squared norm of the difference between the current model <math id="S2.SS2.p5.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.p5.3.m3.1a"><mi id="S2.SS2.p5.3.m3.1.1" xref="S2.SS2.p5.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m3.1b"><ci id="S2.SS2.p5.3.m3.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m3.1c">\theta</annotation></semantics></math> and the previous model <math id="S2.SS2.p5.4.m4.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S2.SS2.p5.4.m4.1a"><msub id="S2.SS2.p5.4.m4.1.1" xref="S2.SS2.p5.4.m4.1.1.cmml"><mi id="S2.SS2.p5.4.m4.1.1.2" xref="S2.SS2.p5.4.m4.1.1.2.cmml">θ</mi><mi id="S2.SS2.p5.4.m4.1.1.3" xref="S2.SS2.p5.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m4.1b"><apply id="S2.SS2.p5.4.m4.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m4.1.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p5.4.m4.1.1.2.cmml" xref="S2.SS2.p5.4.m4.1.1.2">𝜃</ci><ci id="S2.SS2.p5.4.m4.1.1.3.cmml" xref="S2.SS2.p5.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m4.1c">\theta_{t}</annotation></semantics></math>. A large <math id="S2.SS2.p5.5.m5.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S2.SS2.p5.5.m5.1a"><mi id="S2.SS2.p5.5.m5.1.1" xref="S2.SS2.p5.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.m5.1b"><ci id="S2.SS2.p5.5.m5.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.m5.1c">\mu</annotation></semantics></math> may lead to slower convergence by keeping updates near the initial point, while a small <math id="S2.SS2.p5.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S2.SS2.p5.6.m6.1a"><mi id="S2.SS2.p5.6.m6.1.1" xref="S2.SS2.p5.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.m6.1b"><ci id="S2.SS2.p5.6.m6.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.m6.1c">\mu</annotation></semantics></math> typically has little effect on convergence.</p>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<p id="S2.SS2.p6.1" class="ltx_p">The model’s ability to generalize to new users is paramount in FL. In this regard, Nguyen et al. (2022)  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> developed the FedL2R algorithm that incorporates an L2-norm regularize (L2R) into the representation of the network to improve the generalizability across new target domains by limiting the representation’s information capacity. Thus, the final local objective function of each client <math id="S2.SS2.p6.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.p6.1.m1.1a"><mi id="S2.SS2.p6.1.m1.1.1" xref="S2.SS2.p6.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.1.m1.1b"><ci id="S2.SS2.p6.1.m1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.1.m1.1c">k</annotation></semantics></math> is:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S2.E3.m1.3" class="ltx_Math" alttext="\min_{\theta}F_{k}(\theta)+\alpha^{L2R}\cdot\mathcal{L}_{\text{k}}^{L2R}(\theta)," display="block"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><mrow id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mrow id="S2.E3.m1.3.3.1.1.2.2" xref="S2.E3.m1.3.3.1.1.2.2.cmml"><munder id="S2.E3.m1.3.3.1.1.2.2.1" xref="S2.E3.m1.3.3.1.1.2.2.1.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.1.2" xref="S2.E3.m1.3.3.1.1.2.2.1.2.cmml">min</mi><mi id="S2.E3.m1.3.3.1.1.2.2.1.3" xref="S2.E3.m1.3.3.1.1.2.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S2.E3.m1.3.3.1.1.2.2a" xref="S2.E3.m1.3.3.1.1.2.2.cmml">⁡</mo><msub id="S2.E3.m1.3.3.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.cmml">F</mi><mi id="S2.E3.m1.3.3.1.1.2.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.2.1" xref="S2.E3.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1.2.3.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.3.3.1.1.2.3.2.1" xref="S2.E3.m1.3.3.1.1.2.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S2.E3.m1.3.3.1.1.2.3.2.2" xref="S2.E3.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.1.cmml">+</mo><mrow id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml"><mrow id="S2.E3.m1.3.3.1.1.3.2" xref="S2.E3.m1.3.3.1.1.3.2.cmml"><msup id="S2.E3.m1.3.3.1.1.3.2.2" xref="S2.E3.m1.3.3.1.1.3.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2.2.2" xref="S2.E3.m1.3.3.1.1.3.2.2.2.cmml">α</mi><mrow id="S2.E3.m1.3.3.1.1.3.2.2.3" xref="S2.E3.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2.2.3.2" xref="S2.E3.m1.3.3.1.1.3.2.2.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.3.2.2.3.1" xref="S2.E3.m1.3.3.1.1.3.2.2.3.1.cmml">​</mo><mn id="S2.E3.m1.3.3.1.1.3.2.2.3.3" xref="S2.E3.m1.3.3.1.1.3.2.2.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.3.2.2.3.1a" xref="S2.E3.m1.3.3.1.1.3.2.2.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.3.2.2.3.4" xref="S2.E3.m1.3.3.1.1.3.2.2.3.4.cmml">R</mi></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S2.E3.m1.3.3.1.1.3.2.1" xref="S2.E3.m1.3.3.1.1.3.2.1.cmml">⋅</mo><msubsup id="S2.E3.m1.3.3.1.1.3.2.3" xref="S2.E3.m1.3.3.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.1.1.3.2.3.2.2" xref="S2.E3.m1.3.3.1.1.3.2.3.2.2.cmml">ℒ</mi><mtext id="S2.E3.m1.3.3.1.1.3.2.3.2.3" xref="S2.E3.m1.3.3.1.1.3.2.3.2.3a.cmml">k</mtext><mrow id="S2.E3.m1.3.3.1.1.3.2.3.3" xref="S2.E3.m1.3.3.1.1.3.2.3.3.cmml"><mi id="S2.E3.m1.3.3.1.1.3.2.3.3.2" xref="S2.E3.m1.3.3.1.1.3.2.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.3.2.3.3.1" xref="S2.E3.m1.3.3.1.1.3.2.3.3.1.cmml">​</mo><mn id="S2.E3.m1.3.3.1.1.3.2.3.3.3" xref="S2.E3.m1.3.3.1.1.3.2.3.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.3.2.3.3.1a" xref="S2.E3.m1.3.3.1.1.3.2.3.3.1.cmml">​</mo><mi id="S2.E3.m1.3.3.1.1.3.2.3.3.4" xref="S2.E3.m1.3.3.1.1.3.2.3.3.4.cmml">R</mi></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.3.1" xref="S2.E3.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1.3.3.2" xref="S2.E3.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S2.E3.m1.3.3.1.1.3.3.2.1" xref="S2.E3.m1.3.3.1.1.3.cmml">(</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S2.E3.m1.3.3.1.1.3.3.2.2" xref="S2.E3.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.3b"><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1"><plus id="S2.E3.m1.3.3.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1"></plus><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><times id="S2.E3.m1.3.3.1.1.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.1"></times><apply id="S2.E3.m1.3.3.1.1.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2"><apply id="S2.E3.m1.3.3.1.1.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.1.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1">subscript</csymbol><min id="S2.E3.m1.3.3.1.1.2.2.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.2"></min><ci id="S2.E3.m1.3.3.1.1.2.2.1.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.1.3">𝜃</ci></apply><apply id="S2.E3.m1.3.3.1.1.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2">𝐹</ci><ci id="S2.E3.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.3">𝑘</ci></apply></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝜃</ci></apply><apply id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3"><times id="S2.E3.m1.3.3.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.1"></times><apply id="S2.E3.m1.3.3.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2"><ci id="S2.E3.m1.3.3.1.1.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.1">⋅</ci><apply id="S2.E3.m1.3.3.1.1.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2">superscript</csymbol><ci id="S2.E3.m1.3.3.1.1.3.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.2">𝛼</ci><apply id="S2.E3.m1.3.3.1.1.3.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.3"><times id="S2.E3.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.3.1"></times><ci id="S2.E3.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.3.2">𝐿</ci><cn type="integer" id="S2.E3.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.3.3">2</cn><ci id="S2.E3.m1.3.3.1.1.3.2.2.3.4.cmml" xref="S2.E3.m1.3.3.1.1.3.2.2.3.4">𝑅</ci></apply></apply><apply id="S2.E3.m1.3.3.1.1.3.2.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3.2.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.3.2.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.2.2">ℒ</ci><ci id="S2.E3.m1.3.3.1.1.3.2.3.2.3a.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.2.3"><mtext mathsize="70%" id="S2.E3.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.2.3">k</mtext></ci></apply><apply id="S2.E3.m1.3.3.1.1.3.2.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.3"><times id="S2.E3.m1.3.3.1.1.3.2.3.3.1.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.3.1"></times><ci id="S2.E3.m1.3.3.1.1.3.2.3.3.2.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.3.2">𝐿</ci><cn type="integer" id="S2.E3.m1.3.3.1.1.3.2.3.3.3.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.3.3">2</cn><ci id="S2.E3.m1.3.3.1.1.3.2.3.3.4.cmml" xref="S2.E3.m1.3.3.1.1.3.2.3.3.4">𝑅</ci></apply></apply></apply><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\min_{\theta}F_{k}(\theta)+\alpha^{L2R}\cdot\mathcal{L}_{\text{k}}^{L2R}(\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.p7" class="ltx_para">
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S2.E4.m1.3" class="ltx_Math" alttext="\text{s.t. }\quad\mathcal{L}_{\text{k}}^{L2R}=\frac{1}{n_{k}}\sum_{n=1}^{n_{k}}\lVert z_{k}^{(n)}\rVert_{2}^{2}," display="block"><semantics id="S2.E4.m1.3a"><mrow id="S2.E4.m1.3.3.1" xref="S2.E4.m1.3.3.1.1.cmml"><mrow id="S2.E4.m1.3.3.1.1" xref="S2.E4.m1.3.3.1.1.cmml"><mrow id="S2.E4.m1.3.3.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.2.cmml"><mtext id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2a.cmml">s.t. </mtext><mspace width="1em" id="S2.E4.m1.3.3.1.1.1.1.2" xref="S2.E4.m1.3.3.1.1.1.2.cmml"></mspace><msubsup id="S2.E4.m1.3.3.1.1.1.1.1" xref="S2.E4.m1.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.3.3.1.1.1.1.1.2.2" xref="S2.E4.m1.3.3.1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S2.E4.m1.3.3.1.1.1.1.1.2.3" xref="S2.E4.m1.3.3.1.1.1.1.1.2.3a.cmml">k</mtext><mrow id="S2.E4.m1.3.3.1.1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.3.3.1.1.1.1.1.3.2" xref="S2.E4.m1.3.3.1.1.1.1.1.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.1.1.1.1.1.3.1" xref="S2.E4.m1.3.3.1.1.1.1.1.3.1.cmml">​</mo><mn id="S2.E4.m1.3.3.1.1.1.1.1.3.3" xref="S2.E4.m1.3.3.1.1.1.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.1.1.1.1.1.3.1a" xref="S2.E4.m1.3.3.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E4.m1.3.3.1.1.1.1.1.3.4" xref="S2.E4.m1.3.3.1.1.1.1.1.3.4.cmml">R</mi></mrow></msubsup></mrow><mo id="S2.E4.m1.3.3.1.1.3" xref="S2.E4.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E4.m1.3.3.1.1.2" xref="S2.E4.m1.3.3.1.1.2.cmml"><mfrac id="S2.E4.m1.3.3.1.1.2.3" xref="S2.E4.m1.3.3.1.1.2.3.cmml"><mn id="S2.E4.m1.3.3.1.1.2.3.2" xref="S2.E4.m1.3.3.1.1.2.3.2.cmml">1</mn><msub id="S2.E4.m1.3.3.1.1.2.3.3" xref="S2.E4.m1.3.3.1.1.2.3.3.cmml"><mi id="S2.E4.m1.3.3.1.1.2.3.3.2" xref="S2.E4.m1.3.3.1.1.2.3.3.2.cmml">n</mi><mi id="S2.E4.m1.3.3.1.1.2.3.3.3" xref="S2.E4.m1.3.3.1.1.2.3.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.E4.m1.3.3.1.1.2.2" xref="S2.E4.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S2.E4.m1.3.3.1.1.2.1" xref="S2.E4.m1.3.3.1.1.2.1.cmml"><munderover id="S2.E4.m1.3.3.1.1.2.1.2" xref="S2.E4.m1.3.3.1.1.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E4.m1.3.3.1.1.2.1.2.2.2" xref="S2.E4.m1.3.3.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S2.E4.m1.3.3.1.1.2.1.2.2.3" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3.cmml"><mi id="S2.E4.m1.3.3.1.1.2.1.2.2.3.2" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3.2.cmml">n</mi><mo id="S2.E4.m1.3.3.1.1.2.1.2.2.3.1" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S2.E4.m1.3.3.1.1.2.1.2.2.3.3" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E4.m1.3.3.1.1.2.1.2.3" xref="S2.E4.m1.3.3.1.1.2.1.2.3.cmml"><mi id="S2.E4.m1.3.3.1.1.2.1.2.3.2" xref="S2.E4.m1.3.3.1.1.2.1.2.3.2.cmml">n</mi><mi id="S2.E4.m1.3.3.1.1.2.1.2.3.3" xref="S2.E4.m1.3.3.1.1.2.1.2.3.3.cmml">k</mi></msub></munderover><msubsup id="S2.E4.m1.3.3.1.1.2.1.1" xref="S2.E4.m1.3.3.1.1.2.1.1.cmml"><mrow id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.2.1.cmml">∥</mo><msubsup id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.2" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.3" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S2.E4.m1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.1.1.1.3.1" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.E4.m1.1.1.1.3.2" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo fence="true" lspace="0em" rspace="0em" id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S2.E4.m1.3.3.1.1.2.1.1.1.3" xref="S2.E4.m1.3.3.1.1.2.1.1.1.3.cmml">2</mn><mn id="S2.E4.m1.3.3.1.1.2.1.1.3" xref="S2.E4.m1.3.3.1.1.2.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S2.E4.m1.3.3.1.2" xref="S2.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.3b"><apply id="S2.E4.m1.3.3.1.1.cmml" xref="S2.E4.m1.3.3.1"><eq id="S2.E4.m1.3.3.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.3"></eq><list id="S2.E4.m1.3.3.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1"><ci id="S2.E4.m1.2.2a.cmml" xref="S2.E4.m1.2.2"><mtext id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">s.t. </mtext></ci><apply id="S2.E4.m1.3.3.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S2.E4.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.2.2">ℒ</ci><ci id="S2.E4.m1.3.3.1.1.1.1.1.2.3a.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S2.E4.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.2.3">k</mtext></ci></apply><apply id="S2.E4.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.3"><times id="S2.E4.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.3.1"></times><ci id="S2.E4.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.3.2">𝐿</ci><cn type="integer" id="S2.E4.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.3.3">2</cn><ci id="S2.E4.m1.3.3.1.1.1.1.1.3.4.cmml" xref="S2.E4.m1.3.3.1.1.1.1.1.3.4">𝑅</ci></apply></apply></list><apply id="S2.E4.m1.3.3.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.2"><times id="S2.E4.m1.3.3.1.1.2.2.cmml" xref="S2.E4.m1.3.3.1.1.2.2"></times><apply id="S2.E4.m1.3.3.1.1.2.3.cmml" xref="S2.E4.m1.3.3.1.1.2.3"><divide id="S2.E4.m1.3.3.1.1.2.3.1.cmml" xref="S2.E4.m1.3.3.1.1.2.3"></divide><cn type="integer" id="S2.E4.m1.3.3.1.1.2.3.2.cmml" xref="S2.E4.m1.3.3.1.1.2.3.2">1</cn><apply id="S2.E4.m1.3.3.1.1.2.3.3.cmml" xref="S2.E4.m1.3.3.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.3.3.1.cmml" xref="S2.E4.m1.3.3.1.1.2.3.3">subscript</csymbol><ci id="S2.E4.m1.3.3.1.1.2.3.3.2.cmml" xref="S2.E4.m1.3.3.1.1.2.3.3.2">𝑛</ci><ci id="S2.E4.m1.3.3.1.1.2.3.3.3.cmml" xref="S2.E4.m1.3.3.1.1.2.3.3.3">𝑘</ci></apply></apply><apply id="S2.E4.m1.3.3.1.1.2.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1"><apply id="S2.E4.m1.3.3.1.1.2.1.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.1.2.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2">superscript</csymbol><apply id="S2.E4.m1.3.3.1.1.2.1.2.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.1.2.2.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2">subscript</csymbol><sum id="S2.E4.m1.3.3.1.1.2.1.2.2.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.2.2"></sum><apply id="S2.E4.m1.3.3.1.1.2.1.2.2.3.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3"><eq id="S2.E4.m1.3.3.1.1.2.1.2.2.3.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3.1"></eq><ci id="S2.E4.m1.3.3.1.1.2.1.2.2.3.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3.2">𝑛</ci><cn type="integer" id="S2.E4.m1.3.3.1.1.2.1.2.2.3.3.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E4.m1.3.3.1.1.2.1.2.3.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.1.2.3.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.3">subscript</csymbol><ci id="S2.E4.m1.3.3.1.1.2.1.2.3.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.3.2">𝑛</ci><ci id="S2.E4.m1.3.3.1.1.2.1.2.3.3.cmml" xref="S2.E4.m1.3.3.1.1.2.1.2.3.3">𝑘</ci></apply></apply><apply id="S2.E4.m1.3.3.1.1.2.1.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1">superscript</csymbol><apply id="S2.E4.m1.3.3.1.1.2.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1">subscript</csymbol><apply id="S2.E4.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.3.3.1.1.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑛</ci></apply></apply><cn type="integer" id="S2.E4.m1.3.3.1.1.2.1.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.1.3">2</cn></apply><cn type="integer" id="S2.E4.m1.3.3.1.1.2.1.1.3.cmml" xref="S2.E4.m1.3.3.1.1.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.3c">\text{s.t. }\quad\mathcal{L}_{\text{k}}^{L2R}=\frac{1}{n_{k}}\sum_{n=1}^{n_{k}}\lVert z_{k}^{(n)}\rVert_{2}^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p7.4" class="ltx_p">where <math id="S2.SS2.p7.1.m1.1" class="ltx_Math" alttext="z_{k}^{(n)}" display="inline"><semantics id="S2.SS2.p7.1.m1.1a"><msubsup id="S2.SS2.p7.1.m1.1.2" xref="S2.SS2.p7.1.m1.1.2.cmml"><mi id="S2.SS2.p7.1.m1.1.2.2.2" xref="S2.SS2.p7.1.m1.1.2.2.2.cmml">z</mi><mi id="S2.SS2.p7.1.m1.1.2.2.3" xref="S2.SS2.p7.1.m1.1.2.2.3.cmml">k</mi><mrow id="S2.SS2.p7.1.m1.1.1.1.3" xref="S2.SS2.p7.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p7.1.m1.1.1.1.3.1" xref="S2.SS2.p7.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p7.1.m1.1.1.1.1" xref="S2.SS2.p7.1.m1.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.SS2.p7.1.m1.1.1.1.3.2" xref="S2.SS2.p7.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.1.m1.1b"><apply id="S2.SS2.p7.1.m1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.2.1.cmml" xref="S2.SS2.p7.1.m1.1.2">superscript</csymbol><apply id="S2.SS2.p7.1.m1.1.2.2.cmml" xref="S2.SS2.p7.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.2.2.1.cmml" xref="S2.SS2.p7.1.m1.1.2">subscript</csymbol><ci id="S2.SS2.p7.1.m1.1.2.2.2.cmml" xref="S2.SS2.p7.1.m1.1.2.2.2">𝑧</ci><ci id="S2.SS2.p7.1.m1.1.2.2.3.cmml" xref="S2.SS2.p7.1.m1.1.2.2.3">𝑘</ci></apply><ci id="S2.SS2.p7.1.m1.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.1.m1.1c">z_{k}^{(n)}</annotation></semantics></math> represents the model representation of a specific layer for the client <math id="S2.SS2.p7.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.p7.2.m2.1a"><mi id="S2.SS2.p7.2.m2.1.1" xref="S2.SS2.p7.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.2.m2.1b"><ci id="S2.SS2.p7.2.m2.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.2.m2.1c">k</annotation></semantics></math> and data point <math id="S2.SS2.p7.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS2.p7.3.m3.1a"><mi id="S2.SS2.p7.3.m3.1.1" xref="S2.SS2.p7.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.3.m3.1b"><ci id="S2.SS2.p7.3.m3.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.3.m3.1c">n</annotation></semantics></math>, and <math id="S2.SS2.p7.4.m4.1" class="ltx_Math" alttext="\alpha^{L2R}" display="inline"><semantics id="S2.SS2.p7.4.m4.1a"><msup id="S2.SS2.p7.4.m4.1.1" xref="S2.SS2.p7.4.m4.1.1.cmml"><mi id="S2.SS2.p7.4.m4.1.1.2" xref="S2.SS2.p7.4.m4.1.1.2.cmml">α</mi><mrow id="S2.SS2.p7.4.m4.1.1.3" xref="S2.SS2.p7.4.m4.1.1.3.cmml"><mi id="S2.SS2.p7.4.m4.1.1.3.2" xref="S2.SS2.p7.4.m4.1.1.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.4.m4.1.1.3.1" xref="S2.SS2.p7.4.m4.1.1.3.1.cmml">​</mo><mn id="S2.SS2.p7.4.m4.1.1.3.3" xref="S2.SS2.p7.4.m4.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.SS2.p7.4.m4.1.1.3.1a" xref="S2.SS2.p7.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p7.4.m4.1.1.3.4" xref="S2.SS2.p7.4.m4.1.1.3.4.cmml">R</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.4.m4.1b"><apply id="S2.SS2.p7.4.m4.1.1.cmml" xref="S2.SS2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.4.m4.1.1.1.cmml" xref="S2.SS2.p7.4.m4.1.1">superscript</csymbol><ci id="S2.SS2.p7.4.m4.1.1.2.cmml" xref="S2.SS2.p7.4.m4.1.1.2">𝛼</ci><apply id="S2.SS2.p7.4.m4.1.1.3.cmml" xref="S2.SS2.p7.4.m4.1.1.3"><times id="S2.SS2.p7.4.m4.1.1.3.1.cmml" xref="S2.SS2.p7.4.m4.1.1.3.1"></times><ci id="S2.SS2.p7.4.m4.1.1.3.2.cmml" xref="S2.SS2.p7.4.m4.1.1.3.2">𝐿</ci><cn type="integer" id="S2.SS2.p7.4.m4.1.1.3.3.cmml" xref="S2.SS2.p7.4.m4.1.1.3.3">2</cn><ci id="S2.SS2.p7.4.m4.1.1.3.4.cmml" xref="S2.SS2.p7.4.m4.1.1.3.4">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.4.m4.1c">\alpha^{L2R}</annotation></semantics></math> is a hyper-parameter. It was demonstrated that in domain generalization tasks, FedL2R surpasses relevant FL baselines, such as Federated Adversarial Domain Generalization (FedADG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.</p>
</div>
<div id="S2.SS2.p8" class="ltx_para">
<p id="S2.SS2.p8.1" class="ltx_p">The aforementioned works mainly targeted cross-device decentralized learning. Yet, existing research has underscored the value of cross-silo FL, where fewer but resource-rich organizations like manufacturers, hospitals, and banks serve as clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.
FL has recently received attention in the manufacturing sector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. For instance, Ahn et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> employed FL for anomaly detection and predictive maintenance in pumps. FL methods were developed for defect detection in metal AM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and fault diagnosis in rotating machinery <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Despite these advances, there is a notable lack of research on FL for UMW. CM in UMW poses more significant challenges, due to complex process physics and limited understanding of process mechanisms. Moreover, the presence of multiple types of anomalies complicates online monitoring <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S2.SS2.p9" class="ltx_para">
<p id="S2.SS2.p9.1" class="ltx_p">While FL can address the data availability issue in CM applications by enabling the secure collaboration of data sources, recent applications of FL in CM have shown that domain shift issues can adversely affect the model performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. To overcome this challenge, several federated transfer learning and personalization techniques have been proposed, e.g., <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. Kevin et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> developed a federated transfer learning method capable of cross-domain knowledge transfer. While this method achieved better accuracy in the target application with less data and time, the framework was not tested on manufacturing datasets. Another critical limitation of this study is the lack of test data from entirely unseen configurations or domains. In a separate effort, Chung et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> proposed the FedEntropy framework, a personalized FL method using flat minima, which is known to perform better on unseen data than sharp minima, with the goal of enhancing generalization. Yet, the effectiveness of their framework in real-world scenarios remains unknown, as it was evaluated using a synthetic dataset on aircraft engine degradation.</p>
</div>
<div id="S2.SS2.p10" class="ltx_para">
<p id="S2.SS2.p10.1" class="ltx_p">In summary, although there are studies addressing the issue of domain shift within the FL regime, the area of domain generalization has still been limitedly studied. Moreover, while FL has been investigated in manufacturing applications, methods that specifically address domain shift, particularly domain generalization problems, in these applications, including CM for UMW, are generally lacking.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Formulation and Data Description</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem statement</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">This paper investigates the domain shift problem, particularly domain generalization, in CM for UMW, under the following general assumptions.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">Data privacy preservation: The raw data remains localized and is not shared between clients and the central server.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">Similar feature space across datasets: We assume the availability of at least two datasets, each possessing a similar feature space but potentially encompassing distinct domain spaces and classification tasks.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">Data distribution heterogeneity: It is assumed that participating domains have distinct but related data distributions. This diversity motivates the need for domain generalization.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p">Common task objective: Each dataset’s domains share a common task or objective despite their differences, and the goal is to develop a model that can generalize across these domains to make accurate predictions on unseen data.</p>
</div>
</li>
<li id="S3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i5.p1" class="ltx_para">
<p id="S3.I1.i5.p1.1" class="ltx_p">Evaluation on unseen domains: The model’s performance is evaluated based on its ability to generalize to previously unseen domains during testing.</p>
</div>
</li>
</ul>
<p id="S3.SS1.p2.5" class="ltx_p">Consider a scenario where each dataset consists of <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">k</annotation></semantics></math> domains, denoted as <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="D_{\text{1}}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">D</mi><mtext id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3a.cmml">1</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝐷</ci><ci id="S3.SS1.p2.2.m2.1.1.3a.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">D_{\text{1}}</annotation></semantics></math>, <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="D_{\text{2}}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">D</mi><mtext id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3a.cmml">2</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝐷</ci><ci id="S3.SS1.p2.3.m3.1.1.3a.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">2</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">D_{\text{2}}</annotation></semantics></math>, …, <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="D_{\text{k}}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">D</mi><mtext id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3a.cmml">k</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝐷</ci><ci id="S3.SS1.p2.4.m4.1.1.3a.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">k</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">D_{\text{k}}</annotation></semantics></math>, serving as source domains, while <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="D_{\text{target}}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">D</mi><mtext id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝐷</ci><ci id="S3.SS1.p2.5.m5.1.1.3a.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><mtext mathsize="70%" id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">D_{\text{target}}</annotation></semantics></math> represents the target domain. The primary goal in addressing domain shift is to develop a model that can effectively perform on the target domain, utilizing data from the source domains. We assume that each client in the FL network corresponds to a company with access solely to data from a specific domain. Consequently, clients are limited to data points from their respective source domains. This scenario creates a significant challenge for model generalization, as it lacks the benefit of simultaneous access to data from multiple domains. Addressing this challenge requires innovative approaches within the FL paradigm.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Dataset description and preprocessing</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We utilize datasets from a previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> for CM of UMW. In UMW, the quality of joint is influenced by the interplay of process configurations, tool conditions, and workpiece properties <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The experiments were carried out using the Branson Ultraweld L20 Ultrasonic welding machine that is equipped with an online monitoring system. This monitoring system collects data at sampling rates of over 200 kHz from four sensors: a built-in linear variable differential transformer (LVDT), a built-in power sensor, an acoustic emission (AE) sensor, and a microphone.</p>
</div>
<figure id="S3.T1" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S3.T1.3.2" class="ltx_text" style="font-size:90%;">Design of experiments for domain groups M, S, and T configurations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.T1.st1" class="ltx_table ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.st1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.T1.st1.3.2" class="ltx_text" style="font-size:90%;">Domain group M configuration</span></figcaption>
<table id="S3.T1.st1.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.st1.4.1.1" class="ltx_tr">
<th id="S3.T1.st1.4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Domain</th>
<th id="S3.T1.st1.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Material</th>
<th id="S3.T1.st1.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Welding time</th>
<th id="S3.T1.st1.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Data size</th>
<th id="S3.T1.st1.4.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">Classification goal</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.st1.4.2.1" class="ltx_tr">
<td id="S3.T1.st1.4.2.1.1" class="ltx_td ltx_align_center ltx_border_t">AC</td>
<td id="S3.T1.st1.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t">Al-Cu</td>
<td id="S3.T1.st1.4.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.5 s</td>
<td id="S3.T1.st1.4.2.1.4" class="ltx_td ltx_align_center ltx_border_t">200</td>
<td id="S3.T1.st1.4.2.1.5" class="ltx_td ltx_nopad_r ltx_border_t"></td>
</tr>
<tr id="S3.T1.st1.4.3.2" class="ltx_tr">
<td id="S3.T1.st1.4.3.2.1" class="ltx_td ltx_align_center">CC</td>
<td id="S3.T1.st1.4.3.2.2" class="ltx_td ltx_align_center">Cu-Cu</td>
<td id="S3.T1.st1.4.3.2.3" class="ltx_td ltx_align_center">0.9 s</td>
<td id="S3.T1.st1.4.3.2.4" class="ltx_td ltx_align_center">200</td>
<td id="S3.T1.st1.4.3.2.5" class="ltx_td ltx_nopad_r ltx_align_center">TC1, TC2, TC3, TC4</td>
</tr>
<tr id="S3.T1.st1.4.4.3" class="ltx_tr">
<td id="S3.T1.st1.4.4.3.1" class="ltx_td ltx_align_center">CA</td>
<td id="S3.T1.st1.4.4.3.2" class="ltx_td ltx_align_center">Cu-Al</td>
<td id="S3.T1.st1.4.4.3.3" class="ltx_td ltx_align_center">0.5 s</td>
<td id="S3.T1.st1.4.4.3.4" class="ltx_td ltx_align_center">200</td>
<td id="S3.T1.st1.4.4.3.5" class="ltx_td ltx_nopad_r"></td>
</tr>
<tr id="S3.T1.st1.4.5.4" class="ltx_tr">
<td id="S3.T1.st1.4.5.4.1" class="ltx_td ltx_align_center ltx_border_bb">AA</td>
<td id="S3.T1.st1.4.5.4.2" class="ltx_td ltx_align_center ltx_border_bb">Al-Al</td>
<td id="S3.T1.st1.4.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">0.9 s</td>
<td id="S3.T1.st1.4.5.4.4" class="ltx_td ltx_align_center ltx_border_bb">200</td>
<td id="S3.T1.st1.4.5.4.5" class="ltx_td ltx_nopad_r ltx_border_bb"></td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T1.st2" class="ltx_table ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.st2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.T1.st2.3.2" class="ltx_text" style="font-size:90%;">Domain group S configuration</span></figcaption>
<div id="S3.T1.st2.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:157.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(117.8pt,-42.8pt) scale(2.19015086741403,2.19015086741403) ;">
<table id="S3.T1.st2.4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.st2.4.1.1.1" class="ltx_tr">
<th id="S3.T1.st2.4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Domain</th>
<th id="S3.T1.st2.4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Data size</th>
<th id="S3.T1.st2.4.1.1.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">Classification goal</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.st2.4.1.2.1" class="ltx_tr">
<th id="S3.T1.st2.4.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Clean</th>
<td id="S3.T1.st2.4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">90</td>
<td id="S3.T1.st2.4.1.2.1.3" class="ltx_td ltx_nopad_r ltx_border_t"></td>
</tr>
<tr id="S3.T1.st2.4.1.3.2" class="ltx_tr">
<th id="S3.T1.st2.4.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Polished</th>
<td id="S3.T1.st2.4.1.3.2.2" class="ltx_td ltx_align_center">90</td>
<td id="S3.T1.st2.4.1.3.2.3" class="ltx_td ltx_nopad_r ltx_align_center">New, Worn, DMGD</td>
</tr>
<tr id="S3.T1.st2.4.1.4.3" class="ltx_tr">
<th id="S3.T1.st2.4.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">Contam</th>
<td id="S3.T1.st2.4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">90</td>
<td id="S3.T1.st2.4.1.4.3.3" class="ltx_td ltx_nopad_r ltx_border_bb"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T1.st3" class="ltx_table ltx_figure_panel ltx_align_center">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.st3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S3.T1.st3.3.2" class="ltx_text" style="font-size:90%;">Domain group T configuration</span></figcaption>
<div id="S3.T1.st3.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:144.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(108.5pt,-36.1pt) scale(2.00157645596612,2.00157645596612) ;">
<table id="S3.T1.st3.4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.st3.4.1.1.1" class="ltx_tr">
<th id="S3.T1.st3.4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">Domain</th>
<th id="S3.T1.st3.4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Data size</th>
<th id="S3.T1.st3.4.1.1.1.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt">Classification goal</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.st3.4.1.2.1" class="ltx_tr">
<th id="S3.T1.st3.4.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">DMGD</th>
<td id="S3.T1.st3.4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">90</td>
<td id="S3.T1.st3.4.1.2.1.3" class="ltx_td ltx_nopad_r ltx_border_t"></td>
</tr>
<tr id="S3.T1.st3.4.1.3.2" class="ltx_tr">
<th id="S3.T1.st3.4.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">New</th>
<td id="S3.T1.st3.4.1.3.2.2" class="ltx_td ltx_align_center">90</td>
<td id="S3.T1.st3.4.1.3.2.3" class="ltx_td ltx_nopad_r ltx_align_center">Clean, Polished, Contam</td>
</tr>
<tr id="S3.T1.st3.4.1.4.3" class="ltx_tr">
<th id="S3.T1.st3.4.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">Worn</th>
<td id="S3.T1.st3.4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb">90</td>
<td id="S3.T1.st3.4.1.4.3.3" class="ltx_td ltx_nopad_r ltx_border_bb"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
</div>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">In these datasets, different types of materials, tool conditions, and surface conditions are categorized into the following three distinct groups.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Domain group M: In this group, the welding samples are generated by combining different materials from either 0.25 mm thick Copper (Cu) or Aluminum (Al) sheets, each subjected to varying welding times, as detailed in Table <a href="#S3.T1.st1" title="Table 1(a) ‣ Table 1 ‣ 3.2 Dataset description and preprocessing ‣ 3 Problem Formulation and Data Description ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(a)</span></a>. Each domain within this group comprises 200 samples, evenly distributed across four tool conditions: new horn/new anvil (TC1), new horn/worn anvil (TC2), worn horn/new anvil (TC3), and worn horn/worn anvil (TC4).</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">Domain group S: In this setup, 0.20 mm Cu sheets are welded for fixed welding
time of 1.0 second. As detailed in Table <a href="#S3.T1.st2" title="Table 1(b) ‣ Table 1 ‣ 3.2 Dataset description and preprocessing ‣ 3 Problem Formulation and Data Description ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>, different domains are characterized by distinct surface conditions, including a “Clean” surface prepared using alcoholic wipes, a “Polished” surface achieved by sandpapering the contact faces, and a “Contam” (Contaminated) surface created by contaminating the surface by cutting fluid. 30 samples were generated for each combination of workpiece surface condition and tool condition, resulting in a total of 270 samples. The objective of the S domains is to classify three tool conditions: new horn/new anvil (New), worn horn/worn anvil (Worn), and damaged horn/damaged anvil (DMGD).</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Domain group T: In this domain group, the data is identical to that in domain group S. However, the primary objective shifts to classifying the surface conditions while maintaining different domains representing distinct tool conditions, as outlined in Table <a href="#S3.T1.st3" title="Table 1(c) ‣ Table 1 ‣ 3.2 Dataset description and preprocessing ‣ 3 Problem Formulation and Data Description ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(c)</span></a>.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">To tackle the challenge of high dimensionality, we choose discrete wavelet transformation (DWT) for its demonstrated effectiveness in prior research <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. This approach yields a total of 624 features for each data instance, significantly reducing dimensionality while retaining essential information.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed Methodology</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This section presents the details of the proposed FTL-TP framework. Specifically, Section <a href="#S4.SS1" title="4.1 The FTL-TP framework ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> elaborates on the novel approach used for aggregating model parameters. This aggregation method, along with the loss function introduced in Section <a href="#S4.SS2" title="4.2 The FTL-TP loss function ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>, aims to overcome the domain shift issue in CM and enable domain generalization capabilities.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>The FTL-TP framework</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">In this framework, knowledge is transferred between at least two domain groups that have the same feature space. In a typical NN-based model, different features are extracted in different layers.
The lower layers extract low-level features that are very likely to
be transferrable between heterogeneous applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. Therefore, the goal is to train the initial layers across various domain groups commonly, to facilitate the collaborative extraction of low-level information of the common feature space. This approach not only broadens the data pool for these shared layers but also enables them to see data from different domain spaces. Additionally, the framework is designed to yield a personalized final model for each domain group, to customize these models to their specific tasks. To achieve this personalization, the framework leverages data from clients within the same domain group to train a set of upper layers. These layers are then integrated with the earlier-mentioned lower layers to construct a comprehensive NN model. This strategy of knowledge transfer and model personalization is anticipated to significantly improve the performance of the final models, especially in tasks requiring domain generalization.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2404.13278/assets/Structure_3.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="386" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">Illustration of the proposed FTL-TP structure. Note that in this framework, the number of classes for each domain group and the neuron count in the blue and orange layers can differ.
</span></figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Utilizing a shared base layer among all clients, accompanied by personalized layers for each, has been previously implemented in the FedPer algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. However, FedPer restricts collaboration among clients with similar tasks, as it does not allow for the sharing of personalized layers with the server. In contrast, our approach promotes collaboration by enabling the separate aggregation of common personalized layers among clients with identical tasks and domain groups.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">For simplicity, we illustrate our framework using two CM classification tasks with domain shift issues, though it is designed to be scalable for more tasks. Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 The FTL-TP framework ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the details of implementing the FTL-TP framework on two hypothetical datasets from domain group H and domain group F, each associated with a specific task and assigned to a separate group of clients. In the first step, the server initializes and distributes two distinct models to the two groups of clients. Each model consists of shared base layers, depicted in green in the accompanying figure, followed by personalized layers tailored specifically to each dataset. For domain group H, these personalized layers are highlighted in orange, while for domain group F, they are shown in blue.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">In the next step, each client trains the provided model on its local data and returns the updated model to the server. Then the server aggregates the base layers from all clients while only aggregating the subsequent personalized layers from the clients of the same domain group. The server then sends the two aggregated models back to the clients. These steps iterate until both models converge. This approach ensures that the base layer, responsible for learning a general data representation, benefits from both datasets, while the subsequent layers, which extract task-specific information, are learned exclusively from their respective datasets.</p>
</div>
<figure id="S4.SS1.fig1" class="ltx_figure">
<figure id="alg1" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:433.6pt;">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FTL-TP Method </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.3" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text ltx_font_bold">Server side:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Initialize parameters <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\theta_{B}^{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msubsup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">B</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝜃</ci><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝐵</ci></apply><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\theta_{B}^{0}</annotation></semantics></math>, <math id="alg1.l2.m2.1" class="ltx_Math" alttext="\theta_{P1}^{0}" display="inline"><semantics id="alg1.l2.m2.1a"><msubsup id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2.2" xref="alg1.l2.m2.1.1.2.2.cmml">θ</mi><mrow id="alg1.l2.m2.1.1.2.3" xref="alg1.l2.m2.1.1.2.3.cmml"><mi id="alg1.l2.m2.1.1.2.3.2" xref="alg1.l2.m2.1.1.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.1.1.2.3.1" xref="alg1.l2.m2.1.1.2.3.1.cmml">​</mo><mn id="alg1.l2.m2.1.1.2.3.3" xref="alg1.l2.m2.1.1.2.3.3.cmml">1</mn></mrow><mn id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">superscript</csymbol><apply id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.2.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.2.cmml" xref="alg1.l2.m2.1.1.2.2">𝜃</ci><apply id="alg1.l2.m2.1.1.2.3.cmml" xref="alg1.l2.m2.1.1.2.3"><times id="alg1.l2.m2.1.1.2.3.1.cmml" xref="alg1.l2.m2.1.1.2.3.1"></times><ci id="alg1.l2.m2.1.1.2.3.2.cmml" xref="alg1.l2.m2.1.1.2.3.2">𝑃</ci><cn type="integer" id="alg1.l2.m2.1.1.2.3.3.cmml" xref="alg1.l2.m2.1.1.2.3.3">1</cn></apply></apply><cn type="integer" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\theta_{P1}^{0}</annotation></semantics></math>, <math id="alg1.l2.m3.1" class="ltx_Math" alttext="\theta_{P2}^{0}" display="inline"><semantics id="alg1.l2.m3.1a"><msubsup id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2.2" xref="alg1.l2.m3.1.1.2.2.cmml">θ</mi><mrow id="alg1.l2.m3.1.1.2.3" xref="alg1.l2.m3.1.1.2.3.cmml"><mi id="alg1.l2.m3.1.1.2.3.2" xref="alg1.l2.m3.1.1.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m3.1.1.2.3.1" xref="alg1.l2.m3.1.1.2.3.1.cmml">​</mo><mn id="alg1.l2.m3.1.1.2.3.3" xref="alg1.l2.m3.1.1.2.3.3.cmml">2</mn></mrow><mn id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">superscript</csymbol><apply id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.2.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.2.cmml" xref="alg1.l2.m3.1.1.2.2">𝜃</ci><apply id="alg1.l2.m3.1.1.2.3.cmml" xref="alg1.l2.m3.1.1.2.3"><times id="alg1.l2.m3.1.1.2.3.1.cmml" xref="alg1.l2.m3.1.1.2.3.1"></times><ci id="alg1.l2.m3.1.1.2.3.2.cmml" xref="alg1.l2.m3.1.1.2.3.2">𝑃</ci><cn type="integer" id="alg1.l2.m3.1.1.2.3.3.cmml" xref="alg1.l2.m3.1.1.2.3.3">2</cn></apply></apply><cn type="integer" id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\theta_{P2}^{0}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> each server round <math id="alg1.l3.m1.3" class="ltx_Math" alttext="t=1,2,\ldots" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">t</mi><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">=</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mn id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">2</mn><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><eq id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></eq><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">𝑡</ci><list id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><cn type="integer" id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">2</cn><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">t=1,2,\ldots</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     select random subsets <math id="alg1.l4.m1.2" class="ltx_Math" alttext="m_{1},m_{2}" display="inline"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.2.2" xref="alg1.l4.m1.2.2.3.cmml"><msub id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.2.cmml">m</mi><mn id="alg1.l4.m1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l4.m1.2.2.2.3" xref="alg1.l4.m1.2.2.3.cmml">,</mo><msub id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.cmml"><mi id="alg1.l4.m1.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.cmml">m</mi><mn id="alg1.l4.m1.2.2.2.2.3" xref="alg1.l4.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><list id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.2"><apply id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.2">𝑚</ci><cn type="integer" id="alg1.l4.m1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.3">1</cn></apply><apply id="alg1.l4.m1.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.2.2.1.cmml" xref="alg1.l4.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2">𝑚</ci><cn type="integer" id="alg1.l4.m1.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">m_{1},m_{2}</annotation></semantics></math> with [<math id="alg1.l4.m2.1" class="ltx_Math" alttext="C_{1}\cdot M_{1}" display="inline"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><msub id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml"><mi id="alg1.l4.m2.1.1.2.2" xref="alg1.l4.m2.1.1.2.2.cmml">C</mi><mn id="alg1.l4.m2.1.1.2.3" xref="alg1.l4.m2.1.1.2.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l4.m2.1.1.1" xref="alg1.l4.m2.1.1.1.cmml">⋅</mo><msub id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml"><mi id="alg1.l4.m2.1.1.3.2" xref="alg1.l4.m2.1.1.3.2.cmml">M</mi><mn id="alg1.l4.m2.1.1.3.3" xref="alg1.l4.m2.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><ci id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1.1">⋅</ci><apply id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.2.1.cmml" xref="alg1.l4.m2.1.1.2">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.2.cmml" xref="alg1.l4.m2.1.1.2.2">𝐶</ci><cn type="integer" id="alg1.l4.m2.1.1.2.3.cmml" xref="alg1.l4.m2.1.1.2.3">1</cn></apply><apply id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.3.1.cmml" xref="alg1.l4.m2.1.1.3">subscript</csymbol><ci id="alg1.l4.m2.1.1.3.2.cmml" xref="alg1.l4.m2.1.1.3.2">𝑀</ci><cn type="integer" id="alg1.l4.m2.1.1.3.3.cmml" xref="alg1.l4.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">C_{1}\cdot M_{1}</annotation></semantics></math>] , [<math id="alg1.l4.m3.1" class="ltx_Math" alttext="C_{2}\cdot M_{2}" display="inline"><semantics id="alg1.l4.m3.1a"><mrow id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml"><msub id="alg1.l4.m3.1.1.2" xref="alg1.l4.m3.1.1.2.cmml"><mi id="alg1.l4.m3.1.1.2.2" xref="alg1.l4.m3.1.1.2.2.cmml">C</mi><mn id="alg1.l4.m3.1.1.2.3" xref="alg1.l4.m3.1.1.2.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l4.m3.1.1.1" xref="alg1.l4.m3.1.1.1.cmml">⋅</mo><msub id="alg1.l4.m3.1.1.3" xref="alg1.l4.m3.1.1.3.cmml"><mi id="alg1.l4.m3.1.1.3.2" xref="alg1.l4.m3.1.1.3.2.cmml">M</mi><mn id="alg1.l4.m3.1.1.3.3" xref="alg1.l4.m3.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><apply id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1"><ci id="alg1.l4.m3.1.1.1.cmml" xref="alg1.l4.m3.1.1.1">⋅</ci><apply id="alg1.l4.m3.1.1.2.cmml" xref="alg1.l4.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m3.1.1.2.1.cmml" xref="alg1.l4.m3.1.1.2">subscript</csymbol><ci id="alg1.l4.m3.1.1.2.2.cmml" xref="alg1.l4.m3.1.1.2.2">𝐶</ci><cn type="integer" id="alg1.l4.m3.1.1.2.3.cmml" xref="alg1.l4.m3.1.1.2.3">2</cn></apply><apply id="alg1.l4.m3.1.1.3.cmml" xref="alg1.l4.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m3.1.1.3.1.cmml" xref="alg1.l4.m3.1.1.3">subscript</csymbol><ci id="alg1.l4.m3.1.1.3.2.cmml" xref="alg1.l4.m3.1.1.3.2">𝑀</ci><cn type="integer" id="alg1.l4.m3.1.1.3.3.cmml" xref="alg1.l4.m3.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">C_{2}\cdot M_{2}</annotation></semantics></math>] number of clients

</div>
<div id="alg1.l5" class="ltx_listingline">     Send the model <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\theta_{B}^{t-1}+\theta_{P1}^{t-1}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msubsup id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2.2" xref="alg1.l5.m1.1.1.2.2.2.cmml">θ</mi><mi id="alg1.l5.m1.1.1.2.2.3" xref="alg1.l5.m1.1.1.2.2.3.cmml">B</mi><mrow id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml"><mi id="alg1.l5.m1.1.1.2.3.2" xref="alg1.l5.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l5.m1.1.1.2.3.1" xref="alg1.l5.m1.1.1.2.3.1.cmml">−</mo><mn id="alg1.l5.m1.1.1.2.3.3" xref="alg1.l5.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">+</mo><msubsup id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2.2" xref="alg1.l5.m1.1.1.3.2.2.cmml">θ</mi><mrow id="alg1.l5.m1.1.1.3.2.3" xref="alg1.l5.m1.1.1.3.2.3.cmml"><mi id="alg1.l5.m1.1.1.3.2.3.2" xref="alg1.l5.m1.1.1.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.3.2.3.1" xref="alg1.l5.m1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l5.m1.1.1.3.2.3.3" xref="alg1.l5.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml"><mi id="alg1.l5.m1.1.1.3.3.2" xref="alg1.l5.m1.1.1.3.3.2.cmml">t</mi><mo id="alg1.l5.m1.1.1.3.3.1" xref="alg1.l5.m1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l5.m1.1.1.3.3.3" xref="alg1.l5.m1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><plus id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></plus><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">superscript</csymbol><apply id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.2.cmml" xref="alg1.l5.m1.1.1.2.2.2">𝜃</ci><ci id="alg1.l5.m1.1.1.2.2.3.cmml" xref="alg1.l5.m1.1.1.2.2.3">𝐵</ci></apply><apply id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3"><minus id="alg1.l5.m1.1.1.2.3.1.cmml" xref="alg1.l5.m1.1.1.2.3.1"></minus><ci id="alg1.l5.m1.1.1.2.3.2.cmml" xref="alg1.l5.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l5.m1.1.1.2.3.3.cmml" xref="alg1.l5.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">superscript</csymbol><apply id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.2.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.2.cmml" xref="alg1.l5.m1.1.1.3.2.2">𝜃</ci><apply id="alg1.l5.m1.1.1.3.2.3.cmml" xref="alg1.l5.m1.1.1.3.2.3"><times id="alg1.l5.m1.1.1.3.2.3.1.cmml" xref="alg1.l5.m1.1.1.3.2.3.1"></times><ci id="alg1.l5.m1.1.1.3.2.3.2.cmml" xref="alg1.l5.m1.1.1.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l5.m1.1.1.3.2.3.3.cmml" xref="alg1.l5.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3"><minus id="alg1.l5.m1.1.1.3.3.1.cmml" xref="alg1.l5.m1.1.1.3.3.1"></minus><ci id="alg1.l5.m1.1.1.3.3.2.cmml" xref="alg1.l5.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l5.m1.1.1.3.3.3.cmml" xref="alg1.l5.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\theta_{B}^{t-1}+\theta_{P1}^{t-1}</annotation></semantics></math> and <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\theta_{B}^{t-1}+\theta_{P2}^{t-1}" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><msubsup id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml"><mi id="alg1.l5.m2.1.1.2.2.2" xref="alg1.l5.m2.1.1.2.2.2.cmml">θ</mi><mi id="alg1.l5.m2.1.1.2.2.3" xref="alg1.l5.m2.1.1.2.2.3.cmml">B</mi><mrow id="alg1.l5.m2.1.1.2.3" xref="alg1.l5.m2.1.1.2.3.cmml"><mi id="alg1.l5.m2.1.1.2.3.2" xref="alg1.l5.m2.1.1.2.3.2.cmml">t</mi><mo id="alg1.l5.m2.1.1.2.3.1" xref="alg1.l5.m2.1.1.2.3.1.cmml">−</mo><mn id="alg1.l5.m2.1.1.2.3.3" xref="alg1.l5.m2.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">+</mo><msubsup id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml"><mi id="alg1.l5.m2.1.1.3.2.2" xref="alg1.l5.m2.1.1.3.2.2.cmml">θ</mi><mrow id="alg1.l5.m2.1.1.3.2.3" xref="alg1.l5.m2.1.1.3.2.3.cmml"><mi id="alg1.l5.m2.1.1.3.2.3.2" xref="alg1.l5.m2.1.1.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m2.1.1.3.2.3.1" xref="alg1.l5.m2.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l5.m2.1.1.3.2.3.3" xref="alg1.l5.m2.1.1.3.2.3.3.cmml">2</mn></mrow><mrow id="alg1.l5.m2.1.1.3.3" xref="alg1.l5.m2.1.1.3.3.cmml"><mi id="alg1.l5.m2.1.1.3.3.2" xref="alg1.l5.m2.1.1.3.3.2.cmml">t</mi><mo id="alg1.l5.m2.1.1.3.3.1" xref="alg1.l5.m2.1.1.3.3.1.cmml">−</mo><mn id="alg1.l5.m2.1.1.3.3.3" xref="alg1.l5.m2.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><plus id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1"></plus><apply id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.2">superscript</csymbol><apply id="alg1.l5.m2.1.1.2.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.2.1.cmml" xref="alg1.l5.m2.1.1.2">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.2.2.cmml" xref="alg1.l5.m2.1.1.2.2.2">𝜃</ci><ci id="alg1.l5.m2.1.1.2.2.3.cmml" xref="alg1.l5.m2.1.1.2.2.3">𝐵</ci></apply><apply id="alg1.l5.m2.1.1.2.3.cmml" xref="alg1.l5.m2.1.1.2.3"><minus id="alg1.l5.m2.1.1.2.3.1.cmml" xref="alg1.l5.m2.1.1.2.3.1"></minus><ci id="alg1.l5.m2.1.1.2.3.2.cmml" xref="alg1.l5.m2.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l5.m2.1.1.2.3.3.cmml" xref="alg1.l5.m2.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3">superscript</csymbol><apply id="alg1.l5.m2.1.1.3.2.cmml" xref="alg1.l5.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.2.1.cmml" xref="alg1.l5.m2.1.1.3">subscript</csymbol><ci id="alg1.l5.m2.1.1.3.2.2.cmml" xref="alg1.l5.m2.1.1.3.2.2">𝜃</ci><apply id="alg1.l5.m2.1.1.3.2.3.cmml" xref="alg1.l5.m2.1.1.3.2.3"><times id="alg1.l5.m2.1.1.3.2.3.1.cmml" xref="alg1.l5.m2.1.1.3.2.3.1"></times><ci id="alg1.l5.m2.1.1.3.2.3.2.cmml" xref="alg1.l5.m2.1.1.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l5.m2.1.1.3.2.3.3.cmml" xref="alg1.l5.m2.1.1.3.2.3.3">2</cn></apply></apply><apply id="alg1.l5.m2.1.1.3.3.cmml" xref="alg1.l5.m2.1.1.3.3"><minus id="alg1.l5.m2.1.1.3.3.1.cmml" xref="alg1.l5.m2.1.1.3.3.1"></minus><ci id="alg1.l5.m2.1.1.3.3.2.cmml" xref="alg1.l5.m2.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l5.m2.1.1.3.3.3.cmml" xref="alg1.l5.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\theta_{B}^{t-1}+\theta_{P2}^{t-1}</annotation></semantics></math> to the selected <math id="alg1.l5.m3.1" class="ltx_Math" alttext="m_{1}" display="inline"><semantics id="alg1.l5.m3.1a"><msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">m</mi><mn id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑚</ci><cn type="integer" id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">m_{1}</annotation></semantics></math> and <math id="alg1.l5.m4.1" class="ltx_Math" alttext="m_{2}" display="inline"><semantics id="alg1.l5.m4.1a"><msub id="alg1.l5.m4.1.1" xref="alg1.l5.m4.1.1.cmml"><mi id="alg1.l5.m4.1.1.2" xref="alg1.l5.m4.1.1.2.cmml">m</mi><mn id="alg1.l5.m4.1.1.3" xref="alg1.l5.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.1b"><apply id="alg1.l5.m4.1.1.cmml" xref="alg1.l5.m4.1.1"><csymbol cd="ambiguous" id="alg1.l5.m4.1.1.1.cmml" xref="alg1.l5.m4.1.1">subscript</csymbol><ci id="alg1.l5.m4.1.1.2.cmml" xref="alg1.l5.m4.1.1.2">𝑚</ci><cn type="integer" id="alg1.l5.m4.1.1.3.cmml" xref="alg1.l5.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">m_{2}</annotation></semantics></math> clients respectively.

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l6.m1.1" class="ltx_Math" alttext="k_{1}\in m_{1}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">k</mi><mn id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">1</mn></msub><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">∈</mo><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">m</mi><mn id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><in id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></in><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝑘</ci><cn type="integer" id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">1</cn></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝑚</ci><cn type="integer" id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">k_{1}\in m_{1}</annotation></semantics></math> in parallel <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">         <math id="alg1.l7.m1.2" class="ltx_Math" alttext="\theta_{B}^{t}(k1),\theta_{P1}^{t}(k1)\leftarrow" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><mrow id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.3.cmml"><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><msubsup id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.3.2.2" xref="alg1.l7.m1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l7.m1.1.1.1.1.1.3.2.3" xref="alg1.l7.m1.1.1.1.1.1.3.2.3.cmml">B</mi><mi id="alg1.l7.m1.1.1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mn id="alg1.l7.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l7.m1.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.cmml"><msubsup id="alg1.l7.m1.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.3.2.2" xref="alg1.l7.m1.2.2.2.2.2.3.2.2.cmml">θ</mi><mrow id="alg1.l7.m1.2.2.2.2.2.3.2.3" xref="alg1.l7.m1.2.2.2.2.2.3.2.3.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.3.2.3.2" xref="alg1.l7.m1.2.2.2.2.2.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.3.2.3.1" xref="alg1.l7.m1.2.2.2.2.2.3.2.3.1.cmml">​</mo><mn id="alg1.l7.m1.2.2.2.2.2.3.2.3.3" xref="alg1.l7.m1.2.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l7.m1.2.2.2.2.2.3.3" xref="alg1.l7.m1.2.2.2.2.2.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml">​</mo><mrow id="alg1.l7.m1.2.2.2.2.2.1.1" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.2.2.2.1.1.2" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.2.2.2.2.2.1.1.1" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.1.1.1.2" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.1.1.1.1" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1.cmml">​</mo><mn id="alg1.l7.m1.2.2.2.2.2.1.1.1.3" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l7.m1.2.2.2.2.2.1.1.3" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">←</mo><mi id="alg1.l7.m1.2.2.4" xref="alg1.l7.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3">←</ci><list id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2"><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><times id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2"></times><apply id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="alg1.l7.m1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.2.3">𝐵</ci></apply><ci id="alg1.l7.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1"><times id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l7.m1.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2"><times id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2"></times><apply id="alg1.l7.m1.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.3">superscript</csymbol><apply id="alg1.l7.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.2.2.3.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l7.m1.2.2.2.2.2.3.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.2.2">𝜃</ci><apply id="alg1.l7.m1.2.2.2.2.2.3.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.2.3"><times id="alg1.l7.m1.2.2.2.2.2.3.2.3.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.2.3.1"></times><ci id="alg1.l7.m1.2.2.2.2.2.3.2.3.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l7.m1.2.2.2.2.2.3.2.3.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="alg1.l7.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.3.3">𝑡</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.1.1.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1"><times id="alg1.l7.m1.2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.1"></times><ci id="alg1.l7.m1.2.2.2.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l7.m1.2.2.2.2.2.1.1.1.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.1.1.1.3">1</cn></apply></apply></list><csymbol cd="latexml" id="alg1.l7.m1.2.2.4.cmml" xref="alg1.l7.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\theta_{B}^{t}(k1),\theta_{P1}^{t}(k1)\leftarrow</annotation></semantics></math> ClientUpdate(<math id="alg1.l7.m2.3" class="ltx_Math" alttext="k_{1},\theta_{B}^{t-1},\theta_{P1}^{t-1}" display="inline"><semantics id="alg1.l7.m2.3a"><mrow id="alg1.l7.m2.3.3.3" xref="alg1.l7.m2.3.3.4.cmml"><msub id="alg1.l7.m2.1.1.1.1" xref="alg1.l7.m2.1.1.1.1.cmml"><mi id="alg1.l7.m2.1.1.1.1.2" xref="alg1.l7.m2.1.1.1.1.2.cmml">k</mi><mn id="alg1.l7.m2.1.1.1.1.3" xref="alg1.l7.m2.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l7.m2.3.3.3.4" xref="alg1.l7.m2.3.3.4.cmml">,</mo><msubsup id="alg1.l7.m2.2.2.2.2" xref="alg1.l7.m2.2.2.2.2.cmml"><mi id="alg1.l7.m2.2.2.2.2.2.2" xref="alg1.l7.m2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l7.m2.2.2.2.2.2.3" xref="alg1.l7.m2.2.2.2.2.2.3.cmml">B</mi><mrow id="alg1.l7.m2.2.2.2.2.3" xref="alg1.l7.m2.2.2.2.2.3.cmml"><mi id="alg1.l7.m2.2.2.2.2.3.2" xref="alg1.l7.m2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l7.m2.2.2.2.2.3.1" xref="alg1.l7.m2.2.2.2.2.3.1.cmml">−</mo><mn id="alg1.l7.m2.2.2.2.2.3.3" xref="alg1.l7.m2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l7.m2.3.3.3.5" xref="alg1.l7.m2.3.3.4.cmml">,</mo><msubsup id="alg1.l7.m2.3.3.3.3" xref="alg1.l7.m2.3.3.3.3.cmml"><mi id="alg1.l7.m2.3.3.3.3.2.2" xref="alg1.l7.m2.3.3.3.3.2.2.cmml">θ</mi><mrow id="alg1.l7.m2.3.3.3.3.2.3" xref="alg1.l7.m2.3.3.3.3.2.3.cmml"><mi id="alg1.l7.m2.3.3.3.3.2.3.2" xref="alg1.l7.m2.3.3.3.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m2.3.3.3.3.2.3.1" xref="alg1.l7.m2.3.3.3.3.2.3.1.cmml">​</mo><mn id="alg1.l7.m2.3.3.3.3.2.3.3" xref="alg1.l7.m2.3.3.3.3.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l7.m2.3.3.3.3.3" xref="alg1.l7.m2.3.3.3.3.3.cmml"><mi id="alg1.l7.m2.3.3.3.3.3.2" xref="alg1.l7.m2.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l7.m2.3.3.3.3.3.1" xref="alg1.l7.m2.3.3.3.3.3.1.cmml">−</mo><mn id="alg1.l7.m2.3.3.3.3.3.3" xref="alg1.l7.m2.3.3.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.3b"><list id="alg1.l7.m2.3.3.4.cmml" xref="alg1.l7.m2.3.3.3"><apply id="alg1.l7.m2.1.1.1.1.cmml" xref="alg1.l7.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.1.1.cmml" xref="alg1.l7.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m2.1.1.1.1.2.cmml" xref="alg1.l7.m2.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l7.m2.1.1.1.1.3.cmml" xref="alg1.l7.m2.1.1.1.1.3">1</cn></apply><apply id="alg1.l7.m2.2.2.2.2.cmml" xref="alg1.l7.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m2.2.2.2.2.1.cmml" xref="alg1.l7.m2.2.2.2.2">superscript</csymbol><apply id="alg1.l7.m2.2.2.2.2.2.cmml" xref="alg1.l7.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m2.2.2.2.2.2.1.cmml" xref="alg1.l7.m2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m2.2.2.2.2.2.2.cmml" xref="alg1.l7.m2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l7.m2.2.2.2.2.2.3.cmml" xref="alg1.l7.m2.2.2.2.2.2.3">𝐵</ci></apply><apply id="alg1.l7.m2.2.2.2.2.3.cmml" xref="alg1.l7.m2.2.2.2.2.3"><minus id="alg1.l7.m2.2.2.2.2.3.1.cmml" xref="alg1.l7.m2.2.2.2.2.3.1"></minus><ci id="alg1.l7.m2.2.2.2.2.3.2.cmml" xref="alg1.l7.m2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m2.2.2.2.2.3.3.cmml" xref="alg1.l7.m2.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l7.m2.3.3.3.3.cmml" xref="alg1.l7.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m2.3.3.3.3.1.cmml" xref="alg1.l7.m2.3.3.3.3">superscript</csymbol><apply id="alg1.l7.m2.3.3.3.3.2.cmml" xref="alg1.l7.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m2.3.3.3.3.2.1.cmml" xref="alg1.l7.m2.3.3.3.3">subscript</csymbol><ci id="alg1.l7.m2.3.3.3.3.2.2.cmml" xref="alg1.l7.m2.3.3.3.3.2.2">𝜃</ci><apply id="alg1.l7.m2.3.3.3.3.2.3.cmml" xref="alg1.l7.m2.3.3.3.3.2.3"><times id="alg1.l7.m2.3.3.3.3.2.3.1.cmml" xref="alg1.l7.m2.3.3.3.3.2.3.1"></times><ci id="alg1.l7.m2.3.3.3.3.2.3.2.cmml" xref="alg1.l7.m2.3.3.3.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l7.m2.3.3.3.3.2.3.3.cmml" xref="alg1.l7.m2.3.3.3.3.2.3.3">1</cn></apply></apply><apply id="alg1.l7.m2.3.3.3.3.3.cmml" xref="alg1.l7.m2.3.3.3.3.3"><minus id="alg1.l7.m2.3.3.3.3.3.1.cmml" xref="alg1.l7.m2.3.3.3.3.3.1"></minus><ci id="alg1.l7.m2.3.3.3.3.3.2.cmml" xref="alg1.l7.m2.3.3.3.3.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m2.3.3.3.3.3.3.cmml" xref="alg1.l7.m2.3.3.3.3.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.3c">k_{1},\theta_{B}^{t-1},\theta_{P1}^{t-1}</annotation></semantics></math>)

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">     <span id="alg1.l9.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l9.m1.1" class="ltx_Math" alttext="k_{2}\in m_{2}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">k</mi><mn id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">2</mn></msub><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">∈</mo><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">m</mi><mn id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><in id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></in><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑘</ci><cn type="integer" id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">2</cn></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑚</ci><cn type="integer" id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">k_{2}\in m_{2}</annotation></semantics></math> in parallel <span id="alg1.l9.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>         <math id="alg1.l10.m1.2" class="ltx_Math" alttext="\theta_{B}^{t}(k2),\theta_{P2}^{t}(k2)\leftarrow" display="inline"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><mrow id="alg1.l10.m1.2.2.2.2" xref="alg1.l10.m1.2.2.2.3.cmml"><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><msubsup id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.3.2.2" xref="alg1.l10.m1.1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l10.m1.1.1.1.1.1.3.2.3" xref="alg1.l10.m1.1.1.1.1.1.3.2.3.cmml">B</mi><mi id="alg1.l10.m1.1.1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mn id="alg1.l10.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l10.m1.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><msubsup id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.3.2.2" xref="alg1.l10.m1.2.2.2.2.2.3.2.2.cmml">θ</mi><mrow id="alg1.l10.m1.2.2.2.2.2.3.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.2.3.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.3.2.3.2" xref="alg1.l10.m1.2.2.2.2.2.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.3.2.3.1" xref="alg1.l10.m1.2.2.2.2.2.3.2.3.1.cmml">​</mo><mn id="alg1.l10.m1.2.2.2.2.2.3.2.3.3" xref="alg1.l10.m1.2.2.2.2.2.3.2.3.3.cmml">2</mn></mrow><mi id="alg1.l10.m1.2.2.2.2.2.3.3" xref="alg1.l10.m1.2.2.2.2.2.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml">​</mo><mrow id="alg1.l10.m1.2.2.2.2.2.1.1" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.2.2.2.1.1.2" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.2.2.2.2.2.1.1.1" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.1.1.1.2" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.2.2.2.1.1.1.1" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.1.cmml">​</mo><mn id="alg1.l10.m1.2.2.2.2.2.1.1.1.3" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="alg1.l10.m1.2.2.2.2.2.1.1.3" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l10.m1.2.2.3" xref="alg1.l10.m1.2.2.3.cmml">←</mo><mi id="alg1.l10.m1.2.2.4" xref="alg1.l10.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><ci id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.3">←</ci><list id="alg1.l10.m1.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2"><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><times id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2"></times><apply id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.2.2">𝜃</ci><ci id="alg1.l10.m1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.2.3">𝐵</ci></apply><ci id="alg1.l10.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l10.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1"><times id="alg1.l10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><times id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2"></times><apply id="alg1.l10.m1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.3">superscript</csymbol><apply id="alg1.l10.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.3.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.3.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2.2">𝜃</ci><apply id="alg1.l10.m1.2.2.2.2.2.3.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2.3"><times id="alg1.l10.m1.2.2.2.2.2.3.2.3.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2.3.1"></times><ci id="alg1.l10.m1.2.2.2.2.2.3.2.3.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l10.m1.2.2.2.2.2.3.2.3.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.2.3.3">2</cn></apply></apply><ci id="alg1.l10.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3.3">𝑡</ci></apply><apply id="alg1.l10.m1.2.2.2.2.2.1.1.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.1.1"><times id="alg1.l10.m1.2.2.2.2.2.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.1"></times><ci id="alg1.l10.m1.2.2.2.2.2.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l10.m1.2.2.2.2.2.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.1.1.1.3">2</cn></apply></apply></list><csymbol cd="latexml" id="alg1.l10.m1.2.2.4.cmml" xref="alg1.l10.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\theta_{B}^{t}(k2),\theta_{P2}^{t}(k2)\leftarrow</annotation></semantics></math> ClientUpdate(<math id="alg1.l10.m2.3" class="ltx_Math" alttext="k_{2},\theta_{B}^{t-1},\theta_{P2}^{t-1}" display="inline"><semantics id="alg1.l10.m2.3a"><mrow id="alg1.l10.m2.3.3.3" xref="alg1.l10.m2.3.3.4.cmml"><msub id="alg1.l10.m2.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.cmml"><mi id="alg1.l10.m2.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.2.cmml">k</mi><mn id="alg1.l10.m2.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.3.cmml">2</mn></msub><mo id="alg1.l10.m2.3.3.3.4" xref="alg1.l10.m2.3.3.4.cmml">,</mo><msubsup id="alg1.l10.m2.2.2.2.2" xref="alg1.l10.m2.2.2.2.2.cmml"><mi id="alg1.l10.m2.2.2.2.2.2.2" xref="alg1.l10.m2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l10.m2.2.2.2.2.2.3" xref="alg1.l10.m2.2.2.2.2.2.3.cmml">B</mi><mrow id="alg1.l10.m2.2.2.2.2.3" xref="alg1.l10.m2.2.2.2.2.3.cmml"><mi id="alg1.l10.m2.2.2.2.2.3.2" xref="alg1.l10.m2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l10.m2.2.2.2.2.3.1" xref="alg1.l10.m2.2.2.2.2.3.1.cmml">−</mo><mn id="alg1.l10.m2.2.2.2.2.3.3" xref="alg1.l10.m2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l10.m2.3.3.3.5" xref="alg1.l10.m2.3.3.4.cmml">,</mo><msubsup id="alg1.l10.m2.3.3.3.3" xref="alg1.l10.m2.3.3.3.3.cmml"><mi id="alg1.l10.m2.3.3.3.3.2.2" xref="alg1.l10.m2.3.3.3.3.2.2.cmml">θ</mi><mrow id="alg1.l10.m2.3.3.3.3.2.3" xref="alg1.l10.m2.3.3.3.3.2.3.cmml"><mi id="alg1.l10.m2.3.3.3.3.2.3.2" xref="alg1.l10.m2.3.3.3.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.3.3.3.3.2.3.1" xref="alg1.l10.m2.3.3.3.3.2.3.1.cmml">​</mo><mn id="alg1.l10.m2.3.3.3.3.2.3.3" xref="alg1.l10.m2.3.3.3.3.2.3.3.cmml">2</mn></mrow><mrow id="alg1.l10.m2.3.3.3.3.3" xref="alg1.l10.m2.3.3.3.3.3.cmml"><mi id="alg1.l10.m2.3.3.3.3.3.2" xref="alg1.l10.m2.3.3.3.3.3.2.cmml">t</mi><mo id="alg1.l10.m2.3.3.3.3.3.1" xref="alg1.l10.m2.3.3.3.3.3.1.cmml">−</mo><mn id="alg1.l10.m2.3.3.3.3.3.3" xref="alg1.l10.m2.3.3.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.3b"><list id="alg1.l10.m2.3.3.4.cmml" xref="alg1.l10.m2.3.3.3"><apply id="alg1.l10.m2.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l10.m2.1.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.1.3">2</cn></apply><apply id="alg1.l10.m2.2.2.2.2.cmml" xref="alg1.l10.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m2.2.2.2.2.1.cmml" xref="alg1.l10.m2.2.2.2.2">superscript</csymbol><apply id="alg1.l10.m2.2.2.2.2.2.cmml" xref="alg1.l10.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m2.2.2.2.2.2.1.cmml" xref="alg1.l10.m2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m2.2.2.2.2.2.2.cmml" xref="alg1.l10.m2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l10.m2.2.2.2.2.2.3.cmml" xref="alg1.l10.m2.2.2.2.2.2.3">𝐵</ci></apply><apply id="alg1.l10.m2.2.2.2.2.3.cmml" xref="alg1.l10.m2.2.2.2.2.3"><minus id="alg1.l10.m2.2.2.2.2.3.1.cmml" xref="alg1.l10.m2.2.2.2.2.3.1"></minus><ci id="alg1.l10.m2.2.2.2.2.3.2.cmml" xref="alg1.l10.m2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m2.2.2.2.2.3.3.cmml" xref="alg1.l10.m2.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l10.m2.3.3.3.3.cmml" xref="alg1.l10.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m2.3.3.3.3.1.cmml" xref="alg1.l10.m2.3.3.3.3">superscript</csymbol><apply id="alg1.l10.m2.3.3.3.3.2.cmml" xref="alg1.l10.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m2.3.3.3.3.2.1.cmml" xref="alg1.l10.m2.3.3.3.3">subscript</csymbol><ci id="alg1.l10.m2.3.3.3.3.2.2.cmml" xref="alg1.l10.m2.3.3.3.3.2.2">𝜃</ci><apply id="alg1.l10.m2.3.3.3.3.2.3.cmml" xref="alg1.l10.m2.3.3.3.3.2.3"><times id="alg1.l10.m2.3.3.3.3.2.3.1.cmml" xref="alg1.l10.m2.3.3.3.3.2.3.1"></times><ci id="alg1.l10.m2.3.3.3.3.2.3.2.cmml" xref="alg1.l10.m2.3.3.3.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l10.m2.3.3.3.3.2.3.3.cmml" xref="alg1.l10.m2.3.3.3.3.2.3.3">2</cn></apply></apply><apply id="alg1.l10.m2.3.3.3.3.3.cmml" xref="alg1.l10.m2.3.3.3.3.3"><minus id="alg1.l10.m2.3.3.3.3.3.1.cmml" xref="alg1.l10.m2.3.3.3.3.3.1"></minus><ci id="alg1.l10.m2.3.3.3.3.3.2.cmml" xref="alg1.l10.m2.3.3.3.3.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m2.3.3.3.3.3.3.cmml" xref="alg1.l10.m2.3.3.3.3.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.3c">k_{2},\theta_{B}^{t-1},\theta_{P2}^{t-1}</annotation></semantics></math>)

</div>
<div id="alg1.l11" class="ltx_listingline">     <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     <math id="alg1.l12.m1.1" class="ltx_Math" alttext="N_{P1}\leftarrow\sum_{k1=1}^{m_{1}}n_{k1}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msub id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">N</mi><mrow id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.2.3.2" xref="alg1.l12.m1.1.1.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.2.3.1" xref="alg1.l12.m1.1.1.2.3.1.cmml">​</mo><mn id="alg1.l12.m1.1.1.2.3.3" xref="alg1.l12.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><msubsup id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml"><mo id="alg1.l12.m1.1.1.3.1.2.2" xref="alg1.l12.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l12.m1.1.1.3.1.2.3" xref="alg1.l12.m1.1.1.3.1.2.3.cmml"><mrow id="alg1.l12.m1.1.1.3.1.2.3.2" xref="alg1.l12.m1.1.1.3.1.2.3.2.cmml"><mi id="alg1.l12.m1.1.1.3.1.2.3.2.2" xref="alg1.l12.m1.1.1.3.1.2.3.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.1.2.3.2.1" xref="alg1.l12.m1.1.1.3.1.2.3.2.1.cmml">​</mo><mn id="alg1.l12.m1.1.1.3.1.2.3.2.3" xref="alg1.l12.m1.1.1.3.1.2.3.2.3.cmml">1</mn></mrow><mo id="alg1.l12.m1.1.1.3.1.2.3.1" xref="alg1.l12.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l12.m1.1.1.3.1.2.3.3" xref="alg1.l12.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="alg1.l12.m1.1.1.3.1.3" xref="alg1.l12.m1.1.1.3.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.1.3.2" xref="alg1.l12.m1.1.1.3.1.3.2.cmml">m</mi><mn id="alg1.l12.m1.1.1.3.1.3.3" xref="alg1.l12.m1.1.1.3.1.3.3.cmml">1</mn></msub></msubsup><msub id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml"><mi id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml">n</mi><mrow id="alg1.l12.m1.1.1.3.2.3" xref="alg1.l12.m1.1.1.3.2.3.cmml"><mi id="alg1.l12.m1.1.1.3.2.3.2" xref="alg1.l12.m1.1.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.2.3.1" xref="alg1.l12.m1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l12.m1.1.1.3.2.3.3" xref="alg1.l12.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑁</ci><apply id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3"><times id="alg1.l12.m1.1.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.3.1"></times><ci id="alg1.l12.m1.1.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.2">𝑃</ci><cn type="integer" id="alg1.l12.m1.1.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><apply id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.1.cmml" xref="alg1.l12.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.1.2.cmml" xref="alg1.l12.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.2.1.cmml" xref="alg1.l12.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l12.m1.1.1.3.1.2.2.cmml" xref="alg1.l12.m1.1.1.3.1.2.2"></sum><apply id="alg1.l12.m1.1.1.3.1.2.3.cmml" xref="alg1.l12.m1.1.1.3.1.2.3"><eq id="alg1.l12.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.3.1.2.3.1"></eq><apply id="alg1.l12.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.3.1.2.3.2"><times id="alg1.l12.m1.1.1.3.1.2.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.1.2.3.2.1"></times><ci id="alg1.l12.m1.1.1.3.1.2.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.1.2.3.2.2">𝑘</ci><cn type="integer" id="alg1.l12.m1.1.1.3.1.2.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.1.2.3.2.3">1</cn></apply><cn type="integer" id="alg1.l12.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.1.1.3.1.3.cmml" xref="alg1.l12.m1.1.1.3.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.1.3.2">𝑚</ci><cn type="integer" id="alg1.l12.m1.1.1.3.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2">𝑛</ci><apply id="alg1.l12.m1.1.1.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.3"><times id="alg1.l12.m1.1.1.3.2.3.1.cmml" xref="alg1.l12.m1.1.1.3.2.3.1"></times><ci id="alg1.l12.m1.1.1.3.2.3.2.cmml" xref="alg1.l12.m1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="alg1.l12.m1.1.1.3.2.3.3.cmml" xref="alg1.l12.m1.1.1.3.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">N_{P1}\leftarrow\sum_{k1=1}^{m_{1}}n_{k1}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">     <math id="alg1.l13.m1.1" class="ltx_Math" alttext="N_{P2}\leftarrow\sum_{k2=1}^{m_{2}}n_{k2}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msub id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">N</mi><mrow id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml"><mi id="alg1.l13.m1.1.1.2.3.2" xref="alg1.l13.m1.1.1.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.2.3.1" xref="alg1.l13.m1.1.1.2.3.1.cmml">​</mo><mn id="alg1.l13.m1.1.1.2.3.3" xref="alg1.l13.m1.1.1.2.3.3.cmml">2</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">←</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><msubsup id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml"><mo id="alg1.l13.m1.1.1.3.1.2.2" xref="alg1.l13.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l13.m1.1.1.3.1.2.3" xref="alg1.l13.m1.1.1.3.1.2.3.cmml"><mrow id="alg1.l13.m1.1.1.3.1.2.3.2" xref="alg1.l13.m1.1.1.3.1.2.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.1.2.3.2.2" xref="alg1.l13.m1.1.1.3.1.2.3.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.1.2.3.2.1" xref="alg1.l13.m1.1.1.3.1.2.3.2.1.cmml">​</mo><mn id="alg1.l13.m1.1.1.3.1.2.3.2.3" xref="alg1.l13.m1.1.1.3.1.2.3.2.3.cmml">2</mn></mrow><mo id="alg1.l13.m1.1.1.3.1.2.3.1" xref="alg1.l13.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l13.m1.1.1.3.1.2.3.3" xref="alg1.l13.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="alg1.l13.m1.1.1.3.1.3" xref="alg1.l13.m1.1.1.3.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.1.3.2" xref="alg1.l13.m1.1.1.3.1.3.2.cmml">m</mi><mn id="alg1.l13.m1.1.1.3.1.3.3" xref="alg1.l13.m1.1.1.3.1.3.3.cmml">2</mn></msub></msubsup><msub id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.2.2" xref="alg1.l13.m1.1.1.3.2.2.cmml">n</mi><mrow id="alg1.l13.m1.1.1.3.2.3" xref="alg1.l13.m1.1.1.3.2.3.cmml"><mi id="alg1.l13.m1.1.1.3.2.3.2" xref="alg1.l13.m1.1.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.3.2.3.1" xref="alg1.l13.m1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l13.m1.1.1.3.2.3.3" xref="alg1.l13.m1.1.1.3.2.3.3.cmml">2</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">←</ci><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝑁</ci><apply id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3"><times id="alg1.l13.m1.1.1.2.3.1.cmml" xref="alg1.l13.m1.1.1.2.3.1"></times><ci id="alg1.l13.m1.1.1.2.3.2.cmml" xref="alg1.l13.m1.1.1.2.3.2">𝑃</ci><cn type="integer" id="alg1.l13.m1.1.1.2.3.3.cmml" xref="alg1.l13.m1.1.1.2.3.3">2</cn></apply></apply><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><apply id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.1.cmml" xref="alg1.l13.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l13.m1.1.1.3.1.2.cmml" xref="alg1.l13.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.2.1.cmml" xref="alg1.l13.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l13.m1.1.1.3.1.2.2.cmml" xref="alg1.l13.m1.1.1.3.1.2.2"></sum><apply id="alg1.l13.m1.1.1.3.1.2.3.cmml" xref="alg1.l13.m1.1.1.3.1.2.3"><eq id="alg1.l13.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l13.m1.1.1.3.1.2.3.1"></eq><apply id="alg1.l13.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l13.m1.1.1.3.1.2.3.2"><times id="alg1.l13.m1.1.1.3.1.2.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.1.2.3.2.1"></times><ci id="alg1.l13.m1.1.1.3.1.2.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.1.2.3.2.2">𝑘</ci><cn type="integer" id="alg1.l13.m1.1.1.3.1.2.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.1.2.3.2.3">2</cn></apply><cn type="integer" id="alg1.l13.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l13.m1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="alg1.l13.m1.1.1.3.1.3.cmml" xref="alg1.l13.m1.1.1.3.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.1.3.2">𝑚</ci><cn type="integer" id="alg1.l13.m1.1.1.3.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.1.3.3">2</cn></apply></apply><apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">𝑛</ci><apply id="alg1.l13.m1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.2.3"><times id="alg1.l13.m1.1.1.3.2.3.1.cmml" xref="alg1.l13.m1.1.1.3.2.3.1"></times><ci id="alg1.l13.m1.1.1.3.2.3.2.cmml" xref="alg1.l13.m1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="alg1.l13.m1.1.1.3.2.3.3.cmml" xref="alg1.l13.m1.1.1.3.2.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">N_{P2}\leftarrow\sum_{k2=1}^{m_{2}}n_{k2}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <math id="alg1.l14.m1.1" class="ltx_Math" alttext="N\leftarrow N_{P1}+N_{P2}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">N</mi><mo stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><msub id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml"><mi id="alg1.l14.m1.1.1.3.2.2" xref="alg1.l14.m1.1.1.3.2.2.cmml">N</mi><mrow id="alg1.l14.m1.1.1.3.2.3" xref="alg1.l14.m1.1.1.3.2.3.cmml"><mi id="alg1.l14.m1.1.1.3.2.3.2" xref="alg1.l14.m1.1.1.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.2.3.1" xref="alg1.l14.m1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l14.m1.1.1.3.2.3.3" xref="alg1.l14.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">+</mo><msub id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml"><mi id="alg1.l14.m1.1.1.3.3.2" xref="alg1.l14.m1.1.1.3.3.2.cmml">N</mi><mrow id="alg1.l14.m1.1.1.3.3.3" xref="alg1.l14.m1.1.1.3.3.3.cmml"><mi id="alg1.l14.m1.1.1.3.3.3.2" xref="alg1.l14.m1.1.1.3.3.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.3.3.1" xref="alg1.l14.m1.1.1.3.3.3.1.cmml">​</mo><mn id="alg1.l14.m1.1.1.3.3.3.3" xref="alg1.l14.m1.1.1.3.3.3.3.cmml">2</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑁</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><plus id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></plus><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2">𝑁</ci><apply id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3"><times id="alg1.l14.m1.1.1.3.2.3.1.cmml" xref="alg1.l14.m1.1.1.3.2.3.1"></times><ci id="alg1.l14.m1.1.1.3.2.3.2.cmml" xref="alg1.l14.m1.1.1.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l14.m1.1.1.3.2.3.3.cmml" xref="alg1.l14.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.3.1.cmml" xref="alg1.l14.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.3.2.cmml" xref="alg1.l14.m1.1.1.3.3.2">𝑁</ci><apply id="alg1.l14.m1.1.1.3.3.3.cmml" xref="alg1.l14.m1.1.1.3.3.3"><times id="alg1.l14.m1.1.1.3.3.3.1.cmml" xref="alg1.l14.m1.1.1.3.3.3.1"></times><ci id="alg1.l14.m1.1.1.3.3.3.2.cmml" xref="alg1.l14.m1.1.1.3.3.3.2">𝑃</ci><cn type="integer" id="alg1.l14.m1.1.1.3.3.3.3.cmml" xref="alg1.l14.m1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">N\leftarrow N_{P1}+N_{P2}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">     <math id="alg1.l15.m1.1" class="ltx_Math" alttext="\theta_{B}^{t}\leftarrow\frac{1}{N}(\sum_{k1=1}^{m1}{n_{k1}}\cdot\theta_{B}^{t}(k1)+\sum_{k2=1}^{m2}{n_{k2}}\cdot\theta_{B}^{t}(k2))" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msubsup id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2.2" xref="alg1.l15.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.3.2.3" xref="alg1.l15.m1.1.1.3.2.3.cmml">B</mi><mi id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><mfrac id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml"><mn id="alg1.l15.m1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.3.2.cmml">1</mn><mi id="alg1.l15.m1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><msubsup id="alg1.l15.m1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml"><mo lspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">n</mi><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">B</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.055em" id="alg1.l15.m1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.cmml"><msubsup id="alg1.l15.m1.1.1.1.1.1.1.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.cmml"><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.3.cmml">2</mn></mrow><mo id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.3.cmml">2</mn></mrow></msubsup><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.cmml"><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.cmml"><msub id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.2.cmml">n</mi><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.3.cmml">2</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.1.cmml">⋅</mo><msubsup id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.2.cmml">θ</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.3.cmml">B</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.3.cmml">t</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.2.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.2.cmml">​</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml">​</mo><mn id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3">superscript</csymbol><apply id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.2.1.cmml" xref="alg1.l15.m1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.2.cmml" xref="alg1.l15.m1.1.1.3.2.2">𝜃</ci><ci id="alg1.l15.m1.1.1.3.2.3.cmml" xref="alg1.l15.m1.1.1.3.2.3">𝐵</ci></apply><ci id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><times id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2"></times><apply id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3"><divide id="alg1.l15.m1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.3"></divide><cn type="integer" id="alg1.l15.m1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.3.2">1</cn><ci id="alg1.l15.m1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.3.3">𝑁</ci></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1"><plus id="alg1.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3"></plus><apply id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1"><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3"><eq id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2"><times id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.2">𝑘</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.2.3">1</cn></apply><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3"><times id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.2"></times><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3"><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.1">⋅</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.2">𝑛</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3"><times id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.2">𝜃</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.2.3">𝐵</ci></apply><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2"><apply id="alg1.l15.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2">subscript</csymbol><sum id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.2"></sum><apply id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3"><eq id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.1"></eq><apply id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2"><times id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.2">𝑘</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.2.3">2</cn></apply><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3"><times id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.2.3.3">2</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1"><times id="alg1.l15.m1.1.1.1.1.1.1.2.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.2"></times><apply id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3"><ci id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.1">⋅</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.2">𝑛</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3"><times id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.2">𝑘</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.2.3.3">2</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3">superscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.2">𝜃</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.2.3">𝐵</ci></apply><ci id="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.3.3.3">𝑡</ci></apply></apply><apply id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1"><times id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\theta_{B}^{t}\leftarrow\frac{1}{N}(\sum_{k1=1}^{m1}{n_{k1}}\cdot\theta_{B}^{t}(k1)+\sum_{k2=1}^{m2}{n_{k2}}\cdot\theta_{B}^{t}(k2))</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>     <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\theta_{P1}^{t}\leftarrow\frac{1}{{N_{P1}}}\sum_{k1=1}^{m1}{n_{k1}}\cdot\theta_{P1}^{t}(k1)" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msubsup id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2.2" xref="alg1.l16.m1.1.1.3.2.2.cmml">θ</mi><mrow id="alg1.l16.m1.1.1.3.2.3" xref="alg1.l16.m1.1.1.3.2.3.cmml"><mi id="alg1.l16.m1.1.1.3.2.3.2" xref="alg1.l16.m1.1.1.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.3.2.3.1" xref="alg1.l16.m1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l16.m1.1.1.3.2.3.3" xref="alg1.l16.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">←</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mfrac id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml"><mn id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.cmml">1</mn><msub id="alg1.l16.m1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.3.3.cmml"><mi id="alg1.l16.m1.1.1.1.3.3.2" xref="alg1.l16.m1.1.1.1.3.3.2.cmml">N</mi><mrow id="alg1.l16.m1.1.1.1.3.3.3" xref="alg1.l16.m1.1.1.1.3.3.3.cmml"><mi id="alg1.l16.m1.1.1.1.3.3.3.2" xref="alg1.l16.m1.1.1.1.3.3.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.3.3.3.1" xref="alg1.l16.m1.1.1.1.3.3.3.1.cmml">​</mo><mn id="alg1.l16.m1.1.1.1.3.3.3.3" xref="alg1.l16.m1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml"><msubsup id="alg1.l16.m1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.2.cmml"><mo id="alg1.l16.m1.1.1.1.1.2.2.2" xref="alg1.l16.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="alg1.l16.m1.1.1.1.1.2.2.3" xref="alg1.l16.m1.1.1.1.1.2.2.3.cmml"><mrow id="alg1.l16.m1.1.1.1.1.2.2.3.2" xref="alg1.l16.m1.1.1.1.1.2.2.3.2.cmml"><mi id="alg1.l16.m1.1.1.1.1.2.2.3.2.2" xref="alg1.l16.m1.1.1.1.1.2.2.3.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.2.2.3.2.1" xref="alg1.l16.m1.1.1.1.1.2.2.3.2.1.cmml">​</mo><mn id="alg1.l16.m1.1.1.1.1.2.2.3.2.3" xref="alg1.l16.m1.1.1.1.1.2.2.3.2.3.cmml">1</mn></mrow><mo id="alg1.l16.m1.1.1.1.1.2.2.3.1" xref="alg1.l16.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="alg1.l16.m1.1.1.1.1.2.2.3.3" xref="alg1.l16.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l16.m1.1.1.1.1.2.3" xref="alg1.l16.m1.1.1.1.1.2.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.2.3.2" xref="alg1.l16.m1.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.2.3.1" xref="alg1.l16.m1.1.1.1.1.2.3.1.cmml">​</mo><mn id="alg1.l16.m1.1.1.1.1.2.3.3" xref="alg1.l16.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.3.cmml"><msub id="alg1.l16.m1.1.1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.3.2.2" xref="alg1.l16.m1.1.1.1.1.1.3.2.2.cmml">n</mi><mrow id="alg1.l16.m1.1.1.1.1.1.3.2.3" xref="alg1.l16.m1.1.1.1.1.1.3.2.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.3.2.3.2" xref="alg1.l16.m1.1.1.1.1.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.1.3.2.3.1" xref="alg1.l16.m1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l16.m1.1.1.1.1.1.3.2.3.3" xref="alg1.l16.m1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l16.m1.1.1.1.1.1.3.1" xref="alg1.l16.m1.1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="alg1.l16.m1.1.1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.3.3.2.2" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.2.cmml">θ</mi><mrow id="alg1.l16.m1.1.1.1.1.1.3.3.2.3" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.3.3.2.3.2" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.1.3.3.2.3.1" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mn id="alg1.l16.m1.1.1.1.1.1.3.3.2.3.3" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l16.m1.1.1.1.1.1.3.3.3" xref="alg1.l16.m1.1.1.1.1.1.3.3.3.cmml">t</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l16.m1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mn id="alg1.l16.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l16.m1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">←</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3">superscript</csymbol><apply id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.3.2.2">𝜃</ci><apply id="alg1.l16.m1.1.1.3.2.3.cmml" xref="alg1.l16.m1.1.1.3.2.3"><times id="alg1.l16.m1.1.1.3.2.3.1.cmml" xref="alg1.l16.m1.1.1.3.2.3.1"></times><ci id="alg1.l16.m1.1.1.3.2.3.2.cmml" xref="alg1.l16.m1.1.1.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l16.m1.1.1.3.2.3.3.cmml" xref="alg1.l16.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><times id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3"><divide id="alg1.l16.m1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3"></divide><cn type="integer" id="alg1.l16.m1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2">1</cn><apply id="alg1.l16.m1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.3.3.1.cmml" xref="alg1.l16.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.3.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.3.2">𝑁</ci><apply id="alg1.l16.m1.1.1.1.3.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.3.3"><times id="alg1.l16.m1.1.1.1.3.3.3.1.cmml" xref="alg1.l16.m1.1.1.1.3.3.3.1"></times><ci id="alg1.l16.m1.1.1.1.3.3.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.3.3.2">𝑃</ci><cn type="integer" id="alg1.l16.m1.1.1.1.3.3.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1"><apply id="alg1.l16.m1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l16.m1.1.1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.2">subscript</csymbol><sum id="alg1.l16.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.2"></sum><apply id="alg1.l16.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.3"><eq id="alg1.l16.m1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.3.1"></eq><apply id="alg1.l16.m1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.3.2"><times id="alg1.l16.m1.1.1.1.1.2.2.3.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.3.2.1"></times><ci id="alg1.l16.m1.1.1.1.1.2.2.3.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.3.2.2">𝑘</ci><cn type="integer" id="alg1.l16.m1.1.1.1.1.2.2.3.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.3.2.3">1</cn></apply><cn type="integer" id="alg1.l16.m1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="alg1.l16.m1.1.1.1.1.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.3"><times id="alg1.l16.m1.1.1.1.1.2.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.1"></times><ci id="alg1.l16.m1.1.1.1.1.2.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.2">𝑚</ci><cn type="integer" id="alg1.l16.m1.1.1.1.1.2.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l16.m1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3"><ci id="alg1.l16.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.1">⋅</ci><apply id="alg1.l16.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.2.2">𝑛</ci><apply id="alg1.l16.m1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.2.3"><times id="alg1.l16.m1.1.1.1.1.1.3.2.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.2.3.1"></times><ci id="alg1.l16.m1.1.1.1.1.1.3.2.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="alg1.l16.m1.1.1.1.1.1.3.2.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg1.l16.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="alg1.l16.m1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.2">𝜃</ci><apply id="alg1.l16.m1.1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3"><times id="alg1.l16.m1.1.1.1.1.1.3.3.2.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3.1"></times><ci id="alg1.l16.m1.1.1.1.1.1.3.3.2.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l16.m1.1.1.1.1.1.3.3.2.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3.2.3.3">1</cn></apply></apply><ci id="alg1.l16.m1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"><times id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\theta_{P1}^{t}\leftarrow\frac{1}{{N_{P1}}}\sum_{k1=1}^{m1}{n_{k1}}\cdot\theta_{P1}^{t}(k1)</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">     <math id="alg1.l17.m1.1" class="ltx_Math" alttext="\theta_{P2}^{t}\leftarrow\frac{1}{{N_{P2}}}\sum_{k2=1}^{m2}{n_{k2}}\cdot\theta_{P2}^{t}(k2)" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msubsup id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2.2" xref="alg1.l17.m1.1.1.3.2.2.cmml">θ</mi><mrow id="alg1.l17.m1.1.1.3.2.3" xref="alg1.l17.m1.1.1.3.2.3.cmml"><mi id="alg1.l17.m1.1.1.3.2.3.2" xref="alg1.l17.m1.1.1.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.3.2.3.1" xref="alg1.l17.m1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l17.m1.1.1.3.2.3.3" xref="alg1.l17.m1.1.1.3.2.3.3.cmml">2</mn></mrow><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">←</mo><mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><mfrac id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml"><mn id="alg1.l17.m1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.3.2.cmml">1</mn><msub id="alg1.l17.m1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.3.3.cmml"><mi id="alg1.l17.m1.1.1.1.3.3.2" xref="alg1.l17.m1.1.1.1.3.3.2.cmml">N</mi><mrow id="alg1.l17.m1.1.1.1.3.3.3" xref="alg1.l17.m1.1.1.1.3.3.3.cmml"><mi id="alg1.l17.m1.1.1.1.3.3.3.2" xref="alg1.l17.m1.1.1.1.3.3.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.3.3.3.1" xref="alg1.l17.m1.1.1.1.3.3.3.1.cmml">​</mo><mn id="alg1.l17.m1.1.1.1.3.3.3.3" xref="alg1.l17.m1.1.1.1.3.3.3.3.cmml">2</mn></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.2" xref="alg1.l17.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml"><msubsup id="alg1.l17.m1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.2.cmml"><mo id="alg1.l17.m1.1.1.1.1.2.2.2" xref="alg1.l17.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="alg1.l17.m1.1.1.1.1.2.2.3" xref="alg1.l17.m1.1.1.1.1.2.2.3.cmml"><mrow id="alg1.l17.m1.1.1.1.1.2.2.3.2" xref="alg1.l17.m1.1.1.1.1.2.2.3.2.cmml"><mi id="alg1.l17.m1.1.1.1.1.2.2.3.2.2" xref="alg1.l17.m1.1.1.1.1.2.2.3.2.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.1.2.2.3.2.1" xref="alg1.l17.m1.1.1.1.1.2.2.3.2.1.cmml">​</mo><mn id="alg1.l17.m1.1.1.1.1.2.2.3.2.3" xref="alg1.l17.m1.1.1.1.1.2.2.3.2.3.cmml">2</mn></mrow><mo id="alg1.l17.m1.1.1.1.1.2.2.3.1" xref="alg1.l17.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="alg1.l17.m1.1.1.1.1.2.2.3.3" xref="alg1.l17.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l17.m1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.2.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.2.3.2" xref="alg1.l17.m1.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.1.2.3.1" xref="alg1.l17.m1.1.1.1.1.2.3.1.cmml">​</mo><mn id="alg1.l17.m1.1.1.1.1.2.3.3" xref="alg1.l17.m1.1.1.1.1.2.3.3.cmml">2</mn></mrow></msubsup><mrow id="alg1.l17.m1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.3.cmml"><msub id="alg1.l17.m1.1.1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.3.2.2" xref="alg1.l17.m1.1.1.1.1.1.3.2.2.cmml">n</mi><mrow id="alg1.l17.m1.1.1.1.1.1.3.2.3" xref="alg1.l17.m1.1.1.1.1.1.3.2.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.3.2.3.2" xref="alg1.l17.m1.1.1.1.1.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.1.1.3.2.3.1" xref="alg1.l17.m1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mn id="alg1.l17.m1.1.1.1.1.1.3.2.3.3" xref="alg1.l17.m1.1.1.1.1.1.3.2.3.3.cmml">2</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l17.m1.1.1.1.1.1.3.1" xref="alg1.l17.m1.1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="alg1.l17.m1.1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.3.3.2.2" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.2.cmml">θ</mi><mrow id="alg1.l17.m1.1.1.1.1.1.3.3.2.3" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.3.3.2.3.2" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.1.1.3.3.2.3.1" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mn id="alg1.l17.m1.1.1.1.1.1.3.3.2.3.3" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3.3.cmml">2</mn></mrow><mi id="alg1.l17.m1.1.1.1.1.1.3.3.3" xref="alg1.l17.m1.1.1.1.1.1.3.3.3.cmml">t</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l17.m1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mn id="alg1.l17.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="alg1.l17.m1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">←</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">superscript</csymbol><apply id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2">𝜃</ci><apply id="alg1.l17.m1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.3"><times id="alg1.l17.m1.1.1.3.2.3.1.cmml" xref="alg1.l17.m1.1.1.3.2.3.1"></times><ci id="alg1.l17.m1.1.1.3.2.3.2.cmml" xref="alg1.l17.m1.1.1.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l17.m1.1.1.3.2.3.3.cmml" xref="alg1.l17.m1.1.1.3.2.3.3">2</cn></apply></apply><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><times id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.2"></times><apply id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3"><divide id="alg1.l17.m1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3"></divide><cn type="integer" id="alg1.l17.m1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.2">1</cn><apply id="alg1.l17.m1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.3.2">𝑁</ci><apply id="alg1.l17.m1.1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3.3"><times id="alg1.l17.m1.1.1.1.3.3.3.1.cmml" xref="alg1.l17.m1.1.1.1.3.3.3.1"></times><ci id="alg1.l17.m1.1.1.1.3.3.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.3.3.2">𝑃</ci><cn type="integer" id="alg1.l17.m1.1.1.1.3.3.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3.3.3">2</cn></apply></apply></apply><apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1"><apply id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.2">subscript</csymbol><sum id="alg1.l17.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.2"></sum><apply id="alg1.l17.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.3"><eq id="alg1.l17.m1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.3.1"></eq><apply id="alg1.l17.m1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.3.2"><times id="alg1.l17.m1.1.1.1.1.2.2.3.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.3.2.1"></times><ci id="alg1.l17.m1.1.1.1.1.2.2.3.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.3.2.2">𝑘</ci><cn type="integer" id="alg1.l17.m1.1.1.1.1.2.2.3.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.3.2.3">2</cn></apply><cn type="integer" id="alg1.l17.m1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="alg1.l17.m1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.3"><times id="alg1.l17.m1.1.1.1.1.2.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.1"></times><ci id="alg1.l17.m1.1.1.1.1.2.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.2">𝑚</ci><cn type="integer" id="alg1.l17.m1.1.1.1.1.2.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1"><times id="alg1.l17.m1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.2"></times><apply id="alg1.l17.m1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3"><ci id="alg1.l17.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.1">⋅</ci><apply id="alg1.l17.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2.2">𝑛</ci><apply id="alg1.l17.m1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2.3"><times id="alg1.l17.m1.1.1.1.1.1.3.2.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2.3.1"></times><ci id="alg1.l17.m1.1.1.1.1.1.3.2.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="alg1.l17.m1.1.1.1.1.1.3.2.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.2.3.3">2</cn></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.2">𝜃</ci><apply id="alg1.l17.m1.1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3"><times id="alg1.l17.m1.1.1.1.1.1.3.3.2.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3.1"></times><ci id="alg1.l17.m1.1.1.1.1.1.3.3.2.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3.2">𝑃</ci><cn type="integer" id="alg1.l17.m1.1.1.1.1.1.3.3.2.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3.2.3.3">2</cn></apply></apply><ci id="alg1.l17.m1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><times id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.1"></times><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\theta_{P2}^{t}\leftarrow\frac{1}{{N_{P2}}}\sum_{k2=1}^{m2}{n_{k2}}\cdot\theta_{P2}^{t}(k2)</annotation></semantics></math> 
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span><span id="alg1.l18.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.4" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1a" class="ltx_listingline">
<span id="alg1.l1a.1" class="ltx_text ltx_font_bold">Client side:</span> 
</div>
<div id="alg1.l2a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2a.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2a.2" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l2a.m1.4" class="ltx_Math" alttext="i=1,2,\ldots,E" display="inline"><semantics id="alg1.l2a.m1.4a"><mrow id="alg1.l2a.m1.4.5" xref="alg1.l2a.m1.4.5.cmml"><mi id="alg1.l2a.m1.4.5.2" xref="alg1.l2a.m1.4.5.2.cmml">i</mi><mo id="alg1.l2a.m1.4.5.1" xref="alg1.l2a.m1.4.5.1.cmml">=</mo><mrow id="alg1.l2a.m1.4.5.3.2" xref="alg1.l2a.m1.4.5.3.1.cmml"><mn id="alg1.l2a.m1.1.1" xref="alg1.l2a.m1.1.1.cmml">1</mn><mo id="alg1.l2a.m1.4.5.3.2.1" xref="alg1.l2a.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l2a.m1.2.2" xref="alg1.l2a.m1.2.2.cmml">2</mn><mo id="alg1.l2a.m1.4.5.3.2.2" xref="alg1.l2a.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2a.m1.3.3" xref="alg1.l2a.m1.3.3.cmml">…</mi><mo id="alg1.l2a.m1.4.5.3.2.3" xref="alg1.l2a.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l2a.m1.4.4" xref="alg1.l2a.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2a.m1.4b"><apply id="alg1.l2a.m1.4.5.cmml" xref="alg1.l2a.m1.4.5"><eq id="alg1.l2a.m1.4.5.1.cmml" xref="alg1.l2a.m1.4.5.1"></eq><ci id="alg1.l2a.m1.4.5.2.cmml" xref="alg1.l2a.m1.4.5.2">𝑖</ci><list id="alg1.l2a.m1.4.5.3.1.cmml" xref="alg1.l2a.m1.4.5.3.2"><cn type="integer" id="alg1.l2a.m1.1.1.cmml" xref="alg1.l2a.m1.1.1">1</cn><cn type="integer" id="alg1.l2a.m1.2.2.cmml" xref="alg1.l2a.m1.2.2">2</cn><ci id="alg1.l2a.m1.3.3.cmml" xref="alg1.l2a.m1.3.3">…</ci><ci id="alg1.l2a.m1.4.4.cmml" xref="alg1.l2a.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2a.m1.4c">i=1,2,\ldots,E</annotation></semantics></math> <span id="alg1.l2a.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3a" class="ltx_listingline">     <span id="alg1.l3a.1" class="ltx_text ltx_font_bold">for</span> each mini-batch <math id="alg1.l3a.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg1.l3a.m1.1a"><mi id="alg1.l3a.m1.1.1" xref="alg1.l3a.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg1.l3a.m1.1b"><ci id="alg1.l3a.m1.1.1.cmml" xref="alg1.l3a.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m1.1c">b</annotation></semantics></math> of size <math id="alg1.l3a.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l3a.m2.1a"><mi id="alg1.l3a.m2.1.1" xref="alg1.l3a.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l3a.m2.1b"><ci id="alg1.l3a.m2.1.1.cmml" xref="alg1.l3a.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m2.1c">B</annotation></semantics></math> <span id="alg1.l3a.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4a.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>         <math id="alg1.l4a.m1.2" class="ltx_Math" alttext="\theta\leftarrow\theta-\eta\nabla\mathcal{F}(\theta,b)" display="inline"><semantics id="alg1.l4a.m1.2a"><mrow id="alg1.l4a.m1.2.3" xref="alg1.l4a.m1.2.3.cmml"><mi id="alg1.l4a.m1.2.3.2" xref="alg1.l4a.m1.2.3.2.cmml">θ</mi><mo stretchy="false" id="alg1.l4a.m1.2.3.1" xref="alg1.l4a.m1.2.3.1.cmml">←</mo><mrow id="alg1.l4a.m1.2.3.3" xref="alg1.l4a.m1.2.3.3.cmml"><mi id="alg1.l4a.m1.2.3.3.2" xref="alg1.l4a.m1.2.3.3.2.cmml">θ</mi><mo id="alg1.l4a.m1.2.3.3.1" xref="alg1.l4a.m1.2.3.3.1.cmml">−</mo><mrow id="alg1.l4a.m1.2.3.3.3" xref="alg1.l4a.m1.2.3.3.3.cmml"><mi id="alg1.l4a.m1.2.3.3.3.2" xref="alg1.l4a.m1.2.3.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l4a.m1.2.3.3.3.1" xref="alg1.l4a.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l4a.m1.2.3.3.3.3" xref="alg1.l4a.m1.2.3.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l4a.m1.2.3.3.3.3.1" xref="alg1.l4a.m1.2.3.3.3.3.1.cmml">∇</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4a.m1.2.3.3.3.3.2" xref="alg1.l4a.m1.2.3.3.3.3.2.cmml">ℱ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.2.3.3.3.1a" xref="alg1.l4a.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l4a.m1.2.3.3.3.4.2" xref="alg1.l4a.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg1.l4a.m1.2.3.3.3.4.2.1" xref="alg1.l4a.m1.2.3.3.3.4.1.cmml">(</mo><mi id="alg1.l4a.m1.1.1" xref="alg1.l4a.m1.1.1.cmml">θ</mi><mo id="alg1.l4a.m1.2.3.3.3.4.2.2" xref="alg1.l4a.m1.2.3.3.3.4.1.cmml">,</mo><mi id="alg1.l4a.m1.2.2" xref="alg1.l4a.m1.2.2.cmml">b</mi><mo stretchy="false" id="alg1.l4a.m1.2.3.3.3.4.2.3" xref="alg1.l4a.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4a.m1.2b"><apply id="alg1.l4a.m1.2.3.cmml" xref="alg1.l4a.m1.2.3"><ci id="alg1.l4a.m1.2.3.1.cmml" xref="alg1.l4a.m1.2.3.1">←</ci><ci id="alg1.l4a.m1.2.3.2.cmml" xref="alg1.l4a.m1.2.3.2">𝜃</ci><apply id="alg1.l4a.m1.2.3.3.cmml" xref="alg1.l4a.m1.2.3.3"><minus id="alg1.l4a.m1.2.3.3.1.cmml" xref="alg1.l4a.m1.2.3.3.1"></minus><ci id="alg1.l4a.m1.2.3.3.2.cmml" xref="alg1.l4a.m1.2.3.3.2">𝜃</ci><apply id="alg1.l4a.m1.2.3.3.3.cmml" xref="alg1.l4a.m1.2.3.3.3"><times id="alg1.l4a.m1.2.3.3.3.1.cmml" xref="alg1.l4a.m1.2.3.3.3.1"></times><ci id="alg1.l4a.m1.2.3.3.3.2.cmml" xref="alg1.l4a.m1.2.3.3.3.2">𝜂</ci><apply id="alg1.l4a.m1.2.3.3.3.3.cmml" xref="alg1.l4a.m1.2.3.3.3.3"><ci id="alg1.l4a.m1.2.3.3.3.3.1.cmml" xref="alg1.l4a.m1.2.3.3.3.3.1">∇</ci><ci id="alg1.l4a.m1.2.3.3.3.3.2.cmml" xref="alg1.l4a.m1.2.3.3.3.3.2">ℱ</ci></apply><interval closure="open" id="alg1.l4a.m1.2.3.3.3.4.1.cmml" xref="alg1.l4a.m1.2.3.3.3.4.2"><ci id="alg1.l4a.m1.1.1.cmml" xref="alg1.l4a.m1.1.1">𝜃</ci><ci id="alg1.l4a.m1.2.2.cmml" xref="alg1.l4a.m1.2.2">𝑏</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4a.m1.2c">\theta\leftarrow\theta-\eta\nabla\mathcal{F}(\theta,b)</annotation></semantics></math>

</div>
<div id="alg1.l5a" class="ltx_listingline">     <span id="alg1.l5a.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5a.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6a.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l7a" class="ltx_listingline">Send the updated local model <math id="alg1.l7a.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.l7a.m1.1a"><mi id="alg1.l7a.m1.1.1" xref="alg1.l7a.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.1b"><ci id="alg1.l7a.m1.1.1.cmml" xref="alg1.l7a.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.1c">\theta</annotation></semantics></math> to the server

</div>
</div>
</div>
</div>
</figure>
</figure>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.13" class="ltx_p">In this approach, the number of base layers can be considered as a hyper-parameter (<math id="S4.SS1.p5.1.m1.1" class="ltx_Math" alttext="K_{B}" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><msub id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">K</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">𝐾</ci><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">K_{B}</annotation></semantics></math>). All parameters preceding this layer are considered base parameters and are represented by <math id="S4.SS1.p5.2.m2.1" class="ltx_Math" alttext="\theta_{B}" display="inline"><semantics id="S4.SS1.p5.2.m2.1a"><msub id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">θ</mi><mi id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">𝜃</ci><ci id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\theta_{B}</annotation></semantics></math>. Furthermore, <math id="S4.SS1.p5.3.m3.1" class="ltx_Math" alttext="K_{P1}" display="inline"><semantics id="S4.SS1.p5.3.m3.1a"><msub id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><mi id="S4.SS1.p5.3.m3.1.1.2" xref="S4.SS1.p5.3.m3.1.1.2.cmml">K</mi><mrow id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml"><mi id="S4.SS1.p5.3.m3.1.1.3.2" xref="S4.SS1.p5.3.m3.1.1.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.3.m3.1.1.3.1" xref="S4.SS1.p5.3.m3.1.1.3.1.cmml">​</mo><mn id="S4.SS1.p5.3.m3.1.1.3.3" xref="S4.SS1.p5.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2">𝐾</ci><apply id="S4.SS1.p5.3.m3.1.1.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3"><times id="S4.SS1.p5.3.m3.1.1.3.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3.1"></times><ci id="S4.SS1.p5.3.m3.1.1.3.2.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2">𝑃</ci><cn type="integer" id="S4.SS1.p5.3.m3.1.1.3.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">K_{P1}</annotation></semantics></math> and <math id="S4.SS1.p5.4.m4.1" class="ltx_Math" alttext="K_{P2}" display="inline"><semantics id="S4.SS1.p5.4.m4.1a"><msub id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml"><mi id="S4.SS1.p5.4.m4.1.1.2" xref="S4.SS1.p5.4.m4.1.1.2.cmml">K</mi><mrow id="S4.SS1.p5.4.m4.1.1.3" xref="S4.SS1.p5.4.m4.1.1.3.cmml"><mi id="S4.SS1.p5.4.m4.1.1.3.2" xref="S4.SS1.p5.4.m4.1.1.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.4.m4.1.1.3.1" xref="S4.SS1.p5.4.m4.1.1.3.1.cmml">​</mo><mn id="S4.SS1.p5.4.m4.1.1.3.3" xref="S4.SS1.p5.4.m4.1.1.3.3.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><apply id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p5.4.m4.1.1.2.cmml" xref="S4.SS1.p5.4.m4.1.1.2">𝐾</ci><apply id="S4.SS1.p5.4.m4.1.1.3.cmml" xref="S4.SS1.p5.4.m4.1.1.3"><times id="S4.SS1.p5.4.m4.1.1.3.1.cmml" xref="S4.SS1.p5.4.m4.1.1.3.1"></times><ci id="S4.SS1.p5.4.m4.1.1.3.2.cmml" xref="S4.SS1.p5.4.m4.1.1.3.2">𝑃</ci><cn type="integer" id="S4.SS1.p5.4.m4.1.1.3.3.cmml" xref="S4.SS1.p5.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">K_{P2}</annotation></semantics></math> represent the number of personalized layers in each model, with their corresponding parameters denoted as <math id="S4.SS1.p5.5.m5.1" class="ltx_Math" alttext="\theta_{P1}" display="inline"><semantics id="S4.SS1.p5.5.m5.1a"><msub id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml"><mi id="S4.SS1.p5.5.m5.1.1.2" xref="S4.SS1.p5.5.m5.1.1.2.cmml">θ</mi><mrow id="S4.SS1.p5.5.m5.1.1.3" xref="S4.SS1.p5.5.m5.1.1.3.cmml"><mi id="S4.SS1.p5.5.m5.1.1.3.2" xref="S4.SS1.p5.5.m5.1.1.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.5.m5.1.1.3.1" xref="S4.SS1.p5.5.m5.1.1.3.1.cmml">​</mo><mn id="S4.SS1.p5.5.m5.1.1.3.3" xref="S4.SS1.p5.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><apply id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p5.5.m5.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1.2">𝜃</ci><apply id="S4.SS1.p5.5.m5.1.1.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3"><times id="S4.SS1.p5.5.m5.1.1.3.1.cmml" xref="S4.SS1.p5.5.m5.1.1.3.1"></times><ci id="S4.SS1.p5.5.m5.1.1.3.2.cmml" xref="S4.SS1.p5.5.m5.1.1.3.2">𝑃</ci><cn type="integer" id="S4.SS1.p5.5.m5.1.1.3.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">\theta_{P1}</annotation></semantics></math> and <math id="S4.SS1.p5.6.m6.1" class="ltx_Math" alttext="\theta_{P2}" display="inline"><semantics id="S4.SS1.p5.6.m6.1a"><msub id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml"><mi id="S4.SS1.p5.6.m6.1.1.2" xref="S4.SS1.p5.6.m6.1.1.2.cmml">θ</mi><mrow id="S4.SS1.p5.6.m6.1.1.3" xref="S4.SS1.p5.6.m6.1.1.3.cmml"><mi id="S4.SS1.p5.6.m6.1.1.3.2" xref="S4.SS1.p5.6.m6.1.1.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p5.6.m6.1.1.3.1" xref="S4.SS1.p5.6.m6.1.1.3.1.cmml">​</mo><mn id="S4.SS1.p5.6.m6.1.1.3.3" xref="S4.SS1.p5.6.m6.1.1.3.3.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><apply id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.6.m6.1.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p5.6.m6.1.1.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2">𝜃</ci><apply id="S4.SS1.p5.6.m6.1.1.3.cmml" xref="S4.SS1.p5.6.m6.1.1.3"><times id="S4.SS1.p5.6.m6.1.1.3.1.cmml" xref="S4.SS1.p5.6.m6.1.1.3.1"></times><ci id="S4.SS1.p5.6.m6.1.1.3.2.cmml" xref="S4.SS1.p5.6.m6.1.1.3.2">𝑃</ci><cn type="integer" id="S4.SS1.p5.6.m6.1.1.3.3.cmml" xref="S4.SS1.p5.6.m6.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">\theta_{P2}</annotation></semantics></math>. The total number of clients in each domain group is denoted by <math id="S4.SS1.p5.7.m7.1" class="ltx_Math" alttext="M_{1}" display="inline"><semantics id="S4.SS1.p5.7.m7.1a"><msub id="S4.SS1.p5.7.m7.1.1" xref="S4.SS1.p5.7.m7.1.1.cmml"><mi id="S4.SS1.p5.7.m7.1.1.2" xref="S4.SS1.p5.7.m7.1.1.2.cmml">M</mi><mn id="S4.SS1.p5.7.m7.1.1.3" xref="S4.SS1.p5.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.7.m7.1b"><apply id="S4.SS1.p5.7.m7.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.7.m7.1.1.1.cmml" xref="S4.SS1.p5.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p5.7.m7.1.1.2.cmml" xref="S4.SS1.p5.7.m7.1.1.2">𝑀</ci><cn type="integer" id="S4.SS1.p5.7.m7.1.1.3.cmml" xref="S4.SS1.p5.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.7.m7.1c">M_{1}</annotation></semantics></math> and <math id="S4.SS1.p5.8.m8.1" class="ltx_Math" alttext="M_{2}" display="inline"><semantics id="S4.SS1.p5.8.m8.1a"><msub id="S4.SS1.p5.8.m8.1.1" xref="S4.SS1.p5.8.m8.1.1.cmml"><mi id="S4.SS1.p5.8.m8.1.1.2" xref="S4.SS1.p5.8.m8.1.1.2.cmml">M</mi><mn id="S4.SS1.p5.8.m8.1.1.3" xref="S4.SS1.p5.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.8.m8.1b"><apply id="S4.SS1.p5.8.m8.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.8.m8.1.1.1.cmml" xref="S4.SS1.p5.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.p5.8.m8.1.1.2.cmml" xref="S4.SS1.p5.8.m8.1.1.2">𝑀</ci><cn type="integer" id="S4.SS1.p5.8.m8.1.1.3.cmml" xref="S4.SS1.p5.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.8.m8.1c">M_{2}</annotation></semantics></math>. Hyper-parameters, such as client fractions (<math id="S4.SS1.p5.9.m9.1" class="ltx_Math" alttext="C_{1}" display="inline"><semantics id="S4.SS1.p5.9.m9.1a"><msub id="S4.SS1.p5.9.m9.1.1" xref="S4.SS1.p5.9.m9.1.1.cmml"><mi id="S4.SS1.p5.9.m9.1.1.2" xref="S4.SS1.p5.9.m9.1.1.2.cmml">C</mi><mn id="S4.SS1.p5.9.m9.1.1.3" xref="S4.SS1.p5.9.m9.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.9.m9.1b"><apply id="S4.SS1.p5.9.m9.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.9.m9.1.1.1.cmml" xref="S4.SS1.p5.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.p5.9.m9.1.1.2.cmml" xref="S4.SS1.p5.9.m9.1.1.2">𝐶</ci><cn type="integer" id="S4.SS1.p5.9.m9.1.1.3.cmml" xref="S4.SS1.p5.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.9.m9.1c">C_{1}</annotation></semantics></math>, <math id="S4.SS1.p5.10.m10.1" class="ltx_Math" alttext="C_{2}" display="inline"><semantics id="S4.SS1.p5.10.m10.1a"><msub id="S4.SS1.p5.10.m10.1.1" xref="S4.SS1.p5.10.m10.1.1.cmml"><mi id="S4.SS1.p5.10.m10.1.1.2" xref="S4.SS1.p5.10.m10.1.1.2.cmml">C</mi><mn id="S4.SS1.p5.10.m10.1.1.3" xref="S4.SS1.p5.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.10.m10.1b"><apply id="S4.SS1.p5.10.m10.1.1.cmml" xref="S4.SS1.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.10.m10.1.1.1.cmml" xref="S4.SS1.p5.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p5.10.m10.1.1.2.cmml" xref="S4.SS1.p5.10.m10.1.1.2">𝐶</ci><cn type="integer" id="S4.SS1.p5.10.m10.1.1.3.cmml" xref="S4.SS1.p5.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.10.m10.1c">C_{2}</annotation></semantics></math>), must be specified individually for each client set in the FTL-TP setup. Notably, as the same base layer is employed for both sets of clients, a single learning rate parameter (<math id="S4.SS1.p5.11.m11.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS1.p5.11.m11.1a"><mi id="S4.SS1.p5.11.m11.1.1" xref="S4.SS1.p5.11.m11.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.11.m11.1b"><ci id="S4.SS1.p5.11.m11.1.1.cmml" xref="S4.SS1.p5.11.m11.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.11.m11.1c">\eta</annotation></semantics></math>), client epoch (<math id="S4.SS1.p5.12.m12.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS1.p5.12.m12.1a"><mi id="S4.SS1.p5.12.m12.1.1" xref="S4.SS1.p5.12.m12.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.12.m12.1b"><ci id="S4.SS1.p5.12.m12.1.1.cmml" xref="S4.SS1.p5.12.m12.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.12.m12.1c">E</annotation></semantics></math>), and batch size (<math id="S4.SS1.p5.13.m13.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS1.p5.13.m13.1a"><mi id="S4.SS1.p5.13.m13.1.1" xref="S4.SS1.p5.13.m13.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.13.m13.1b"><ci id="S4.SS1.p5.13.m13.1.1.cmml" xref="S4.SS1.p5.13.m13.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.13.m13.1c">B</annotation></semantics></math>) are defined to enhance convergence. Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.1 The FTL-TP framework ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the details of the server and client steps.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>The FTL-TP loss function</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">Using a shared base layer in models that serve clients with different domains and tasks, may lead to potential divergence issues. To counter this, we incorporate the FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> loss term into the loss function of each local client. This addition effectively reduces the disparity in local updates. Moreover, to address domain shift challenges, we include an L2R term <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> on the output of the shared base layer(s). The L2R term aids in learning a simpler representation from the feature space by constraining this representation, thus improving the model’s capacity to effectively generalize across various domains. Consequently, the objective function of our framework is defined as:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E5.m1.3" class="ltx_Math" alttext="\min_{\theta}F_{k}(\theta)+\alpha^{L2R}\cdot\mathcal{L}_{\text{k}}^{L2R}(\theta)+\frac{\mu}{2}\|\theta-\theta_{t}\|^{2}," display="block"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3.1" xref="S4.E5.m1.3.3.1.1.cmml"><mrow id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml"><mrow id="S4.E5.m1.3.3.1.1.3" xref="S4.E5.m1.3.3.1.1.3.cmml"><mrow id="S4.E5.m1.3.3.1.1.3.2" xref="S4.E5.m1.3.3.1.1.3.2.cmml"><munder id="S4.E5.m1.3.3.1.1.3.2.1" xref="S4.E5.m1.3.3.1.1.3.2.1.cmml"><mi id="S4.E5.m1.3.3.1.1.3.2.1.2" xref="S4.E5.m1.3.3.1.1.3.2.1.2.cmml">min</mi><mi id="S4.E5.m1.3.3.1.1.3.2.1.3" xref="S4.E5.m1.3.3.1.1.3.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S4.E5.m1.3.3.1.1.3.2a" xref="S4.E5.m1.3.3.1.1.3.2.cmml">⁡</mo><msub id="S4.E5.m1.3.3.1.1.3.2.2" xref="S4.E5.m1.3.3.1.1.3.2.2.cmml"><mi id="S4.E5.m1.3.3.1.1.3.2.2.2" xref="S4.E5.m1.3.3.1.1.3.2.2.2.cmml">F</mi><mi id="S4.E5.m1.3.3.1.1.3.2.2.3" xref="S4.E5.m1.3.3.1.1.3.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.3.1" xref="S4.E5.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E5.m1.3.3.1.1.3.3.2" xref="S4.E5.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.1.1.3.3.2.1" xref="S4.E5.m1.3.3.1.1.3.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S4.E5.m1.3.3.1.1.3.3.2.2" xref="S4.E5.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.3.3.1.1.2" xref="S4.E5.m1.3.3.1.1.2.cmml">+</mo><mrow id="S4.E5.m1.3.3.1.1.4" xref="S4.E5.m1.3.3.1.1.4.cmml"><mrow id="S4.E5.m1.3.3.1.1.4.2" xref="S4.E5.m1.3.3.1.1.4.2.cmml"><msup id="S4.E5.m1.3.3.1.1.4.2.2" xref="S4.E5.m1.3.3.1.1.4.2.2.cmml"><mi id="S4.E5.m1.3.3.1.1.4.2.2.2" xref="S4.E5.m1.3.3.1.1.4.2.2.2.cmml">α</mi><mrow id="S4.E5.m1.3.3.1.1.4.2.2.3" xref="S4.E5.m1.3.3.1.1.4.2.2.3.cmml"><mi id="S4.E5.m1.3.3.1.1.4.2.2.3.2" xref="S4.E5.m1.3.3.1.1.4.2.2.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.4.2.2.3.1" xref="S4.E5.m1.3.3.1.1.4.2.2.3.1.cmml">​</mo><mn id="S4.E5.m1.3.3.1.1.4.2.2.3.3" xref="S4.E5.m1.3.3.1.1.4.2.2.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.4.2.2.3.1a" xref="S4.E5.m1.3.3.1.1.4.2.2.3.1.cmml">​</mo><mi id="S4.E5.m1.3.3.1.1.4.2.2.3.4" xref="S4.E5.m1.3.3.1.1.4.2.2.3.4.cmml">R</mi></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S4.E5.m1.3.3.1.1.4.2.1" xref="S4.E5.m1.3.3.1.1.4.2.1.cmml">⋅</mo><msubsup id="S4.E5.m1.3.3.1.1.4.2.3" xref="S4.E5.m1.3.3.1.1.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.3.3.1.1.4.2.3.2.2" xref="S4.E5.m1.3.3.1.1.4.2.3.2.2.cmml">ℒ</mi><mtext id="S4.E5.m1.3.3.1.1.4.2.3.2.3" xref="S4.E5.m1.3.3.1.1.4.2.3.2.3a.cmml">k</mtext><mrow id="S4.E5.m1.3.3.1.1.4.2.3.3" xref="S4.E5.m1.3.3.1.1.4.2.3.3.cmml"><mi id="S4.E5.m1.3.3.1.1.4.2.3.3.2" xref="S4.E5.m1.3.3.1.1.4.2.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.4.2.3.3.1" xref="S4.E5.m1.3.3.1.1.4.2.3.3.1.cmml">​</mo><mn id="S4.E5.m1.3.3.1.1.4.2.3.3.3" xref="S4.E5.m1.3.3.1.1.4.2.3.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.4.2.3.3.1a" xref="S4.E5.m1.3.3.1.1.4.2.3.3.1.cmml">​</mo><mi id="S4.E5.m1.3.3.1.1.4.2.3.3.4" xref="S4.E5.m1.3.3.1.1.4.2.3.3.4.cmml">R</mi></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.4.1" xref="S4.E5.m1.3.3.1.1.4.1.cmml">​</mo><mrow id="S4.E5.m1.3.3.1.1.4.3.2" xref="S4.E5.m1.3.3.1.1.4.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.1.1.4.3.2.1" xref="S4.E5.m1.3.3.1.1.4.cmml">(</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S4.E5.m1.3.3.1.1.4.3.2.2" xref="S4.E5.m1.3.3.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.3.3.1.1.2a" xref="S4.E5.m1.3.3.1.1.2.cmml">+</mo><mrow id="S4.E5.m1.3.3.1.1.1" xref="S4.E5.m1.3.3.1.1.1.cmml"><mfrac id="S4.E5.m1.3.3.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.3.cmml"><mi id="S4.E5.m1.3.3.1.1.1.3.2" xref="S4.E5.m1.3.3.1.1.1.3.2.cmml">μ</mi><mn id="S4.E5.m1.3.3.1.1.1.3.3" xref="S4.E5.m1.3.3.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.2.cmml">​</mo><msup id="S4.E5.m1.3.3.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.cmml"><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml">θ</mi><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E5.m1.3.3.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E5.m1.3.3.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.E5.m1.3.3.1.2" xref="S4.E5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1"><plus id="S4.E5.m1.3.3.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.2"></plus><apply id="S4.E5.m1.3.3.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.3"><times id="S4.E5.m1.3.3.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.3.1"></times><apply id="S4.E5.m1.3.3.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2"><apply id="S4.E5.m1.3.3.1.1.3.2.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3.2.1.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1">subscript</csymbol><min id="S4.E5.m1.3.3.1.1.3.2.1.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1.2"></min><ci id="S4.E5.m1.3.3.1.1.3.2.1.3.cmml" xref="S4.E5.m1.3.3.1.1.3.2.1.3">𝜃</ci></apply><apply id="S4.E5.m1.3.3.1.1.3.2.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.3.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.2">𝐹</ci><ci id="S4.E5.m1.3.3.1.1.3.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.3.2.2.3">𝑘</ci></apply></apply><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝜃</ci></apply><apply id="S4.E5.m1.3.3.1.1.4.cmml" xref="S4.E5.m1.3.3.1.1.4"><times id="S4.E5.m1.3.3.1.1.4.1.cmml" xref="S4.E5.m1.3.3.1.1.4.1"></times><apply id="S4.E5.m1.3.3.1.1.4.2.cmml" xref="S4.E5.m1.3.3.1.1.4.2"><ci id="S4.E5.m1.3.3.1.1.4.2.1.cmml" xref="S4.E5.m1.3.3.1.1.4.2.1">⋅</ci><apply id="S4.E5.m1.3.3.1.1.4.2.2.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.4.2.2.1.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2">superscript</csymbol><ci id="S4.E5.m1.3.3.1.1.4.2.2.2.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2.2">𝛼</ci><apply id="S4.E5.m1.3.3.1.1.4.2.2.3.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2.3"><times id="S4.E5.m1.3.3.1.1.4.2.2.3.1.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2.3.1"></times><ci id="S4.E5.m1.3.3.1.1.4.2.2.3.2.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2.3.2">𝐿</ci><cn type="integer" id="S4.E5.m1.3.3.1.1.4.2.2.3.3.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2.3.3">2</cn><ci id="S4.E5.m1.3.3.1.1.4.2.2.3.4.cmml" xref="S4.E5.m1.3.3.1.1.4.2.2.3.4">𝑅</ci></apply></apply><apply id="S4.E5.m1.3.3.1.1.4.2.3.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.4.2.3.1.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3">superscript</csymbol><apply id="S4.E5.m1.3.3.1.1.4.2.3.2.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.4.2.3.2.1.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.4.2.3.2.2.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.2.2">ℒ</ci><ci id="S4.E5.m1.3.3.1.1.4.2.3.2.3a.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.2.3"><mtext mathsize="70%" id="S4.E5.m1.3.3.1.1.4.2.3.2.3.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.2.3">k</mtext></ci></apply><apply id="S4.E5.m1.3.3.1.1.4.2.3.3.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.3"><times id="S4.E5.m1.3.3.1.1.4.2.3.3.1.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.3.1"></times><ci id="S4.E5.m1.3.3.1.1.4.2.3.3.2.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.3.2">𝐿</ci><cn type="integer" id="S4.E5.m1.3.3.1.1.4.2.3.3.3.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.3.3">2</cn><ci id="S4.E5.m1.3.3.1.1.4.2.3.3.4.cmml" xref="S4.E5.m1.3.3.1.1.4.2.3.3.4">𝑅</ci></apply></apply></apply><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝜃</ci></apply><apply id="S4.E5.m1.3.3.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1"><times id="S4.E5.m1.3.3.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.2"></times><apply id="S4.E5.m1.3.3.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.3"><divide id="S4.E5.m1.3.3.1.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.3"></divide><ci id="S4.E5.m1.3.3.1.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.3.2">𝜇</ci><cn type="integer" id="S4.E5.m1.3.3.1.1.1.3.3.cmml" xref="S4.E5.m1.3.3.1.1.1.3.3">2</cn></apply><apply id="S4.E5.m1.3.3.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S4.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1"><minus id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1"></minus><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.2">𝜃</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S4.E5.m1.3.3.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\min_{\theta}F_{k}(\theta)+\alpha^{L2R}\cdot\mathcal{L}_{\text{k}}^{L2R}(\theta)+\frac{\mu}{2}\|\theta-\theta_{t}\|^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E6.m1.2" class="ltx_Math" alttext="\text{s.t. }\mathcal{L}_{\text{k}}^{L2R}=\frac{1}{n_{k}}\sum_{n=1}^{n_{K}}\lVert z_{k}^{(n)}\rVert_{2}^{2}," display="block"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1.3" xref="S4.E6.m1.2.2.1.1.3.cmml"><mtext id="S4.E6.m1.2.2.1.1.3.2" xref="S4.E6.m1.2.2.1.1.3.2a.cmml">s.t. </mtext><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.3.1" xref="S4.E6.m1.2.2.1.1.3.1.cmml">​</mo><msubsup id="S4.E6.m1.2.2.1.1.3.3" xref="S4.E6.m1.2.2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.2.2.1.1.3.3.2.2" xref="S4.E6.m1.2.2.1.1.3.3.2.2.cmml">ℒ</mi><mtext id="S4.E6.m1.2.2.1.1.3.3.2.3" xref="S4.E6.m1.2.2.1.1.3.3.2.3a.cmml">k</mtext><mrow id="S4.E6.m1.2.2.1.1.3.3.3" xref="S4.E6.m1.2.2.1.1.3.3.3.cmml"><mi id="S4.E6.m1.2.2.1.1.3.3.3.2" xref="S4.E6.m1.2.2.1.1.3.3.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.3.3.3.1" xref="S4.E6.m1.2.2.1.1.3.3.3.1.cmml">​</mo><mn id="S4.E6.m1.2.2.1.1.3.3.3.3" xref="S4.E6.m1.2.2.1.1.3.3.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.3.3.3.1a" xref="S4.E6.m1.2.2.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E6.m1.2.2.1.1.3.3.3.4" xref="S4.E6.m1.2.2.1.1.3.3.3.4.cmml">R</mi></mrow></msubsup></mrow><mo id="S4.E6.m1.2.2.1.1.2" xref="S4.E6.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.1.1.cmml"><mfrac id="S4.E6.m1.2.2.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.3.cmml"><mn id="S4.E6.m1.2.2.1.1.1.3.2" xref="S4.E6.m1.2.2.1.1.1.3.2.cmml">1</mn><msub id="S4.E6.m1.2.2.1.1.1.3.3" xref="S4.E6.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E6.m1.2.2.1.1.1.3.3.2" xref="S4.E6.m1.2.2.1.1.1.3.3.2.cmml">n</mi><mi id="S4.E6.m1.2.2.1.1.1.3.3.3" xref="S4.E6.m1.2.2.1.1.1.3.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.2.2.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.cmml"><munderover id="S4.E6.m1.2.2.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E6.m1.2.2.1.1.1.1.2.2.2" xref="S4.E6.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.2.2.1.1.1.1.2.2.3" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.2.2.3.2" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="S4.E6.m1.2.2.1.1.1.1.2.2.3.1" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E6.m1.2.2.1.1.1.1.2.2.3.3" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S4.E6.m1.2.2.1.1.1.1.2.3" xref="S4.E6.m1.2.2.1.1.1.1.2.3.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.2.3.2" xref="S4.E6.m1.2.2.1.1.1.1.2.3.2.cmml">n</mi><mi id="S4.E6.m1.2.2.1.1.1.1.2.3.3" xref="S4.E6.m1.2.2.1.1.1.1.2.3.3.cmml">K</mi></msub></munderover><msubsup id="S4.E6.m1.2.2.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">∥</mo><msubsup id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mrow id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.3.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S4.E6.m1.1.1.1.3.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo fence="true" lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S4.E6.m1.2.2.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.3.cmml">2</mn><mn id="S4.E6.m1.2.2.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S4.E6.m1.2.2.1.2" xref="S4.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.1.1.cmml" xref="S4.E6.m1.2.2.1"><eq id="S4.E6.m1.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2"></eq><apply id="S4.E6.m1.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.3"><times id="S4.E6.m1.2.2.1.1.3.1.cmml" xref="S4.E6.m1.2.2.1.1.3.1"></times><ci id="S4.E6.m1.2.2.1.1.3.2a.cmml" xref="S4.E6.m1.2.2.1.1.3.2"><mtext id="S4.E6.m1.2.2.1.1.3.2.cmml" xref="S4.E6.m1.2.2.1.1.3.2">s.t. </mtext></ci><apply id="S4.E6.m1.2.2.1.1.3.3.cmml" xref="S4.E6.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.3.3.1.cmml" xref="S4.E6.m1.2.2.1.1.3.3">superscript</csymbol><apply id="S4.E6.m1.2.2.1.1.3.3.2.cmml" xref="S4.E6.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.3.3.2.1.cmml" xref="S4.E6.m1.2.2.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.3.3.2.2.cmml" xref="S4.E6.m1.2.2.1.1.3.3.2.2">ℒ</ci><ci id="S4.E6.m1.2.2.1.1.3.3.2.3a.cmml" xref="S4.E6.m1.2.2.1.1.3.3.2.3"><mtext mathsize="70%" id="S4.E6.m1.2.2.1.1.3.3.2.3.cmml" xref="S4.E6.m1.2.2.1.1.3.3.2.3">k</mtext></ci></apply><apply id="S4.E6.m1.2.2.1.1.3.3.3.cmml" xref="S4.E6.m1.2.2.1.1.3.3.3"><times id="S4.E6.m1.2.2.1.1.3.3.3.1.cmml" xref="S4.E6.m1.2.2.1.1.3.3.3.1"></times><ci id="S4.E6.m1.2.2.1.1.3.3.3.2.cmml" xref="S4.E6.m1.2.2.1.1.3.3.3.2">𝐿</ci><cn type="integer" id="S4.E6.m1.2.2.1.1.3.3.3.3.cmml" xref="S4.E6.m1.2.2.1.1.3.3.3.3">2</cn><ci id="S4.E6.m1.2.2.1.1.3.3.3.4.cmml" xref="S4.E6.m1.2.2.1.1.3.3.3.4">𝑅</ci></apply></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><times id="S4.E6.m1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.2"></times><apply id="S4.E6.m1.2.2.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3"><divide id="S4.E6.m1.2.2.1.1.1.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.3"></divide><cn type="integer" id="S4.E6.m1.2.2.1.1.1.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.3.2">1</cn><apply id="S4.E6.m1.2.2.1.1.1.3.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3.2">𝑛</ci><ci id="S4.E6.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1"><apply id="S4.E6.m1.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S4.E6.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S4.E6.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S4.E6.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3"><eq id="S4.E6.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S4.E6.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3.2">𝑛</ci><cn type="integer" id="S4.E6.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.3.2">𝑛</ci><ci id="S4.E6.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2.3.3">𝐾</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝑛</ci></apply></apply><cn type="integer" id="S4.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S4.E6.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">\text{s.t. }\mathcal{L}_{\text{k}}^{L2R}=\frac{1}{n_{k}}\sum_{n=1}^{n_{K}}\lVert z_{k}^{(n)}\rVert_{2}^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.5" class="ltx_p">where <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha^{L2R}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">α</mi><mrow id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mn id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1a" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.1.m1.1.1.3.4" xref="S4.SS2.p1.1.m1.1.1.3.4.cmml">R</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝛼</ci><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><times id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3.1"></times><ci id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">𝐿</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3">2</cn><ci id="S4.SS2.p1.1.m1.1.1.3.4.cmml" xref="S4.SS2.p1.1.m1.1.1.3.4">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\alpha^{L2R}</annotation></semantics></math> and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mu</annotation></semantics></math> are hyper-parameters. Also, <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="z_{k}^{(n)}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msubsup id="S4.SS2.p1.3.m3.1.2" xref="S4.SS2.p1.3.m3.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.2.2.2" xref="S4.SS2.p1.3.m3.1.2.2.2.cmml">z</mi><mi id="S4.SS2.p1.3.m3.1.2.2.3" xref="S4.SS2.p1.3.m3.1.2.2.3.cmml">k</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.3" xref="S4.SS2.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.3.1" xref="S4.SS2.p1.3.m3.1.2.cmml">(</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.3.2" xref="S4.SS2.p1.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.2.cmml" xref="S4.SS2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.2">superscript</csymbol><apply id="S4.SS2.p1.3.m3.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.2.2.1.cmml" xref="S4.SS2.p1.3.m3.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.2.2.2.cmml" xref="S4.SS2.p1.3.m3.1.2.2.2">𝑧</ci><ci id="S4.SS2.p1.3.m3.1.2.2.3.cmml" xref="S4.SS2.p1.3.m3.1.2.2.3">𝑘</ci></apply><ci id="S4.SS2.p1.3.m3.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">z_{k}^{(n)}</annotation></semantics></math> is the output of the latest base layer for client <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">k</annotation></semantics></math> with data point <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">n</annotation></semantics></math>. By optimizing this function, we aim to not only achieve superior generalization but also to enhance the model’s convergence</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>NN architecture</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Within the proposed NN architecture, the primary goal is to accurately classify each input signal into the correct category. The network, trained on source domains, is evaluated on unseen target domains to assess its performance.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">624 features that are extracted using DWT are used as the input data for classification. An MLP architecture with four layers is designed. The model takes 624 DWT features as input and the output layer provides the classification results for each specific dataset (4 classes for domain group M and 3 classes for domain groups S and T). For the first three hidden layers, the model has 175, 125, and 50 neurons, respectively. The rectified linear unit (ReLU) is chosen as the activation function, and adaptive moment estimation (Adam) is selected as the solver.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Edge-cloud implementation</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To emulate a manufacturing environment, models are trained on Raspberry Pis which are commonly used as edge devices. Typically, multiple welding machines operate within a single factory; thus, each Raspberry Pi can represent a factory, training models for up to four welding machines. These devices—emulating companies—connect to a remote server via the Internet for collaborative learning. The entire training process is coordinated by a remote server, which defines all learning strategies, including the methods used, model hyperparameters, the selection and number of participating clients, and the number of server rounds. Clients receive the model and hyperparameters from the server and conduct their training independently.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">The RabbitMQ broker, a publish-subscribe system, connects the server node and client nodes in a bi-directional manner <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. In RabbitMQ, messages are published to exchanges and delivered to queues based on routing rules defined by bindings and routing keys. This decoupling of producers and consumers enhances scalability, flexibility, and robustness. Secure connections to the RabbitMQ broker require the server and clients to authenticate using a username and password.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<p id="S4.F3.1" class="ltx_p ltx_align_center"><span id="S4.F3.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;"><img src="/html/2404.13278/assets/edge-cloud_architecture.png" id="S4.F3.1.1.g1" class="ltx_graphics ltx_img_landscape" width="718" height="335" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.4.2" class="ltx_text" style="font-size:90%;">A schematic of edge-cloud implementation for the FTL-TP method.</span></figcaption>
</figure>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">Figure <a href="#S4.F3" title="Figure 3 ‣ 4.4 Edge-cloud implementation ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the details of message routing in our implementation. For simplicity, we consider clients on only one Raspberry Pi—two from domain group H and the other two from domain group F. Initially, the server publishes two initialized models and corresponding hyperparameters as two JSON files each tagged with a specific routing key, “Domain F” or “Domain H,” to the broker. These routing keys are essential for the direct exchange model, labeled as “To clients exchange,” to route messages accurately to the corresponding client queues. Client1 and Client2 queues, bound with “Domain F”, receive messages tagged with the “Domain F” routing key. Conversely, Client3 and Client4 queues, bound with “Domain H”, are configured to receive messages intended for the domain group H. Then each client subscribes to its queue to retrieve its parameters for the next round. Following the training of the received models on their private data, each client publishes a JSON file with their updated parameters and a topic indicating their domain group to the “To server exchange.” This exchange is another direct model that forwards messages to the “Server Queue.” The server subscribes to this queue to retrieve all the updated models from all clients. Upon retrieving the messages, the server identifies their corresponding domain groups using their topics as filters. It then aggregates the weights as per the framework shown in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 The FTL-TP framework ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, resulting in two updated models. These updated global models are then published to the broker as a JSON file to continue the process. Note that clients, the broker, and the server are located on separate nodes, which are connected through the Internet.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Case Studies</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This section describes the experimental setup and compares the FTL-TP method with multiple baseline methods to demonstrate its effectiveness. Additionally, we investigate the performance of FTL-TP under unbalanced data distribution and different client fractions. The training efficiency of FTL-TP in an actual cloud manufacturing environment is also evaluated.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">Our setup includes four Raspberry Pi devices, each capable of running four clients, and a computer that manages and distributes messages using a RabbitMQ broker. The computer is equipped with a 12th Gen Intel(R) Core(TM) i9-12900F processor, an NVIDIA GeForce RTX 3070 Ti 8GB GDDR6X, and 16 GB of RAM. Each Raspberry Pi 4B model used is powered by a 4-core ARMv8 CPU and is equipped with 4 GB of RAM. For network connectivity, we utilize the Internet network provided by the University of Illinois.
For software, we use TensorFlow (2.10.0), Python (3.9.2), and the Raspberry Pi OS (64-bit) based on Debian Bullseye. We use the RabbitMQ broker with the Pika (1.3.2) library in Python for message routing between the server and clients.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">For training, we use 5-fold cross-validation for all models. Instead of random initialization, the server uses “Kaiming normal” to initialize the weights of all the layers. All models use categorical cross-entropy as the base loss function. As explained in Section <a href="#S3" title="3 Problem Formulation and Data Description ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, three datasets with domain groups M, S, and T are available. For simplicity, the proposed method will concentrate on the collaboration between just two datasets. The aim is to investigate any two out of three combinations of these datasets. However, we do not combine domain groups S and T, as they represent the same data signals but with different domain shifts and classes. Therefore, the focus is on the combinations of domain groups M vs S, and M vs T.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">The client distribution is as follows: One domain of each domain group is considered as the target domain, and each of the other domains is equally distributed as the source domains among three clients at random. This means each client has access to data from only one domain, which is similar to real-world company scenarios. This distribution results in 9 training clients for domain group M and 6 each for domain groups S and T. As depicted in Tables <a href="#A1.T2" title="Table A.1 ‣ Appendix A ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>, <a href="#A1.T3" title="Table A.2 ‣ Appendix A ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>, and <a href="#A1.T4" title="Table A.3 ‣ Appendix A ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.3</span></a> in <a href="#A1" title="Appendix A ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>, clients in domain group M have about 67 data points each, while those in groups S and T have 30 data points each. The challenge in learning models suitable for domain generalization is heightened by the limited number of data points available to each client and the restriction of having access to only one domain’s data.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">In all experiments, the same NN model presented in Section <a href="#S4.SS3" title="4.3 NN architecture ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a> serves as the basis for all training methods (FTL-TP, IL, CL, CTL, and other FL paradigms). We report the accuracy of the proposed method for each domain, treating it as the target for one dataset and considering all possible target domain combinations for the other dataset. For instance, in the scenario of training domain group M vs domain group T, to report the accuracy for the Al-Al target in the M domain group, we conduct the experiment three times. Each time involves selecting a different domain from domain group T as the target domain. This approach ensures a thorough evaluation of the FTL-TP method across a range of domain configurations, providing a detailed understanding of its performance in varying settings.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p">To address the randomness in NN outcomes, each experiment is conducted five times. Consequently, for the Al-Al target in domain group M, each of the three target domain combinations from domain group T is tested five times, resulting in a total of 15 accuracy measurements. The reported accuracy represents the average and standard deviation of these tests. This is achieved by first calculating the mean and standard deviation for each of the three combinations separately, and then averaging these means and standard deviations across all three combinations. This process ensures a comprehensive and accurate reflection of the model’s performance for the never-before-seen target.</p>
</div>
<div id="S5.SS1.p6" class="ltx_para">
<p id="S5.SS1.p6.1" class="ltx_p">Through fine-tuning, the hyper-parameters for the FTL-TP method are set identically across both domain group combinations. The first layer functions as the base layer, with the subsequent three layers designated as personalized layers. The minibatch size is set to 8, and the learning rate to 0.0005, with one epoch selected for local training. Additionally, the proximal term and L2 regularization hyperparameters are determined to be 0.01 and 0.001, respectively. Experiments indicate that convergence for all clients is achieved before 150 server rounds, so this number of server rounds is used for all experiments with the proposed methods. Details on the hyperparameters for other models will be provided in their respective sections.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Performance comparison with other learning paradigms</h3>

<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/Material_CL_IL.png" id="S5.F4.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">Tool classification accuracy for different material targets</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/Surface_CL_IL.png" id="S5.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">Tool classification accuracy for different surface targets</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/Tool_CL_IL.png" id="S5.F4.sf3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F4.sf3.3.2" class="ltx_text" style="font-size:90%;">Surface classification accuracy for different tool targets</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.3.2" class="ltx_text" style="font-size:90%;">Performance comparison with IL, CL, and CTL. ‘S&amp;M’ and ‘T&amp;M’ refer to the domain group combinations ‘Surface vs Material‘ and ‘Tool vs. Material,’ respectively.</span></figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">This section aims to assess the domain generalization capability of the FTL-TP model in CM tasks for UMW. We compare FTL-TP with CL, individual learning (IL), and centralized transfer learning (CTL). In CL, data from all clients is combined for training. In IL, each client uses only their own data for model training. Given that FTL-TP involves knowledge transfer between datasets, we also study CTL, where the model is initially trained on one dataset and, after freezing the base layers (first layer in this case), it is fine-tuned with another dataset. To assess the domain generalization of the FTL-TP model, we evaluate it on data from unseen domains.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Figure <a href="#S5.F4" title="Figure 4 ‣ 5.2 Performance comparison with other learning paradigms ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the comparative results. In this study, the average performance of all clients trained individually is used to indicate the performance of IL. All experiments for both IL and CL were repeated five times. To ensure consistency, the same target data were employed across all models: IL, CL, CTL, and FTL-TP. After fine-tuning, hyperparameters are established for the IL, CL, and CTL models. These models are configured with a batch size of 8 and a learning rate of 0.0005. Each model underwent training for a total of 150 epochs.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">The results demonstrate that the FTL-TP method surpasses both IL and CL across nearly all instances, with an average improvement of 20.83% and 5.44%, respectively. This improvement can show the FTL-TP model’s effectiveness in transferring knowledge among clients working on two distinct CM tasks. Notably, in most cases, our method exhibits less variation in performance, suggesting enhanced robustness compared to these two models. Furthermore, on average, the FTL-TP method outperforms the CTL model with an improvement of 3.84%.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Performance comparison with other FL methods</h3>

<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/FL_comp_Material.png" id="S5.F5.sf1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F5.sf1.3.2" class="ltx_text" style="font-size:90%;">Tool classification accuracy for different material targets</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/FL_comp_Surface.png" id="S5.F5.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F5.sf2.3.2" class="ltx_text" style="font-size:90%;">Tool classification accuracy for different surface targets</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F5.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/FL_comp_Tool.png" id="S5.F5.sf3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F5.sf3.3.2" class="ltx_text" style="font-size:90%;">Surface classification accuracy for different tool targets</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.3.2" class="ltx_text" style="font-size:90%;">Performance comparison with FedAvg, FedProx, and FedL2R. ‘S&amp;M’ and ‘T&amp;M’ refer to the domain group combinations ‘Surface vs. Material’ and ‘Tool vs. Material’, respectively.</span></figcaption>
</figure>
<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">This section compares FTL-TP with state-of-the-art FL models including FedAvg, FedProx, and FedL2R. These FL methods use the same client distribution as mentioned previously for a consistent comparison. To eliminate the randomness of NN models, we repeat all experiments five times. Following the fine-tuning process, a batch size of 8 and a learning rate of 0.0005 are chosen for these three models. Additionally, for FedProx, the proximal term is set at 0.1, and for FedL2R, the regularization term is 0.01. All these models iterate for 150 server rounds to ensure consistent and thorough training across all experiments.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">Figure <a href="#S5.F5" title="Figure 5 ‣ 5.3 Performance comparison with other FL methods ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> presents the comparative results. It is seen that FTL-TP outperforms FedAvg, FedProx, and FedL2R with average improvements of 8.08%, 7.19%, and 5.35%, respectively. It is worth noting that FTL-TP outperforms FedL2R, which is considered as a state-of-the-art domain generalization FL method, with a significant margin.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Performance comparison between balanced and unbalanced data distribution</h3>

<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/Unbalanced_Material.png" id="S5.F6.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F6.sf1.3.2" class="ltx_text" style="font-size:90%;">Tool classification accuracy for different material targets</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2404.13278/assets/Unbalanced_Surface.png" id="S5.F6.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="327" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F6.sf2.3.2" class="ltx_text" style="font-size:90%;">Surface classification accuracy for different tool targets</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F6.3.2" class="ltx_text" style="font-size:90%;">Balanced vs unbalanced performance comparison for the FTL-TP model in domain groups S vs M combination.</span></figcaption>
</figure>
<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">This section further mimics industrial scenarios by introducing unbalanced data distributions among clients, which is a significant challenge in FL performance. We investigate how the FTL-TP model copes with this challenge using domain groups M and S combination. To create an unbalanced distribution, we assign 30, 60, and 110 data points to the three clients of each training domain in domain group M, and 15, 25, and 50 data points to the clients in one training domain of domain group S. This aims to replicate a near-worst-case scenario in industrial settings.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">Figure <a href="#S5.F6" title="Figure 6 ‣ 5.4 Performance comparison between balanced and unbalanced data distribution ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the comparison between balanced and unbalanced data distributions for both domain groups M and S. Figure <a href="#S5.F6.sf1" title="Figure 6(a) ‣ Figure 6 ‣ 5.4 Performance comparison between balanced and unbalanced data distribution ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(a)</span></a> shows the accuracy of the FTL-TP model under unbalanced distribution is similar to that of the balanced distribution, with less than a 2.05% drop, indicating robust performance for domain group M. However, Figure <a href="#S5.F6.sf2" title="Figure 6(b) ‣ Figure 6 ‣ 5.4 Performance comparison between balanced and unbalanced data distribution ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(b)</span></a> shows that in domain group S, while the accuracy drops for the clean and polished domains as targets are negligible, the Contam domain exhibits a significant drop of 7.17%. It is worth mentioning that, despite this significant drop, the performance of the FTL-TP method in the Contam domain under unbalanced distribution conditions still surpasses that of IL, CL, CTL, and other FL models under balanced conditions.</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Performance comparison for different client fractions</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">This section evaluates the data efficiency of FTL-TP. Specifically, the effect of varying client fractions on the training of the model is examined. For this purpose, we select a combination of domain groups M and S to conduct our investigation. For this analysis, in each server round, 1, 2, and all 3 of these clients are randomly selected. This results in collaborations involving 3, 6, and 9 clients from domain group M, as well as 2, 4, and 6 clients from domain group S to represent client fractions of 1/3, 2/3, and 1 respectively.</p>
</div>
<div id="S5.SS5.p2" class="ltx_para">
<p id="S5.SS5.p2.1" class="ltx_p">Figure <a href="#S5.F7" title="Figure 7 ‣ 5.5 Performance comparison for different client fractions ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> compares FTL-TP’s performance under different client factions. It is shown that within domain group M, the performance of the FTL-TP model enhances as the number of participating clients in the federation increases. This improvement is due to the larger and more diverse dataset available for training the model, consequently boosting the model performance. However, the performance of the FTL-TP method with a client fraction of 1/3 is comparable to that of other baseline FL methods with a client fraction of 1, and even the CL method.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/2404.13278/assets/Client_fraction_M.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="261" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.4.2.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S5.F7.2.1" class="ltx_text" style="font-size:90%;">The FTL-TP’s accuracy results for various material target domains in domain groups S vs M combination with different client fractions (<math id="S5.F7.2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.F7.2.1.m1.1b"><mi id="S5.F7.2.1.m1.1.1" xref="S5.F7.2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.F7.2.1.m1.1c"><ci id="S5.F7.2.1.m1.1.1.cmml" xref="S5.F7.2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.1.m1.1d">C</annotation></semantics></math>).</span></figcaption>
</figure>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Comparative time analysis of FL methodologies</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.1" class="ltx_p">Given that the FTL-TP method develops at least two personalized models during the training phase, evaluating its time efficiency is essential. We select the combination of domain groups M and S for this purpose. The aim is to compare the time efficiency of the FTL-TP model with that of single-dataset FL frameworks including FedAvg, FedProx, and a combination of FedL2R with FedProx, which employs a similar loss function to that of the FTL-TP method.</p>
</div>
<div id="S5.SS6.p2" class="ltx_para">
<p id="S5.SS6.p2.1" class="ltx_p">We implemented the edge-cloud architecture presented in Section <a href="#S4.SS4" title="4.4 Edge-cloud implementation ‣ 4 Proposed Methodology ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>. The time measurement was done from the moment the central server began distributing the initial weights to clients until the completion of 10 server rounds, with a client fraction of <math id="S5.SS6.p2.1.m1.1" class="ltx_Math" alttext="C=1" display="inline"><semantics id="S5.SS6.p2.1.m1.1a"><mrow id="S5.SS6.p2.1.m1.1.1" xref="S5.SS6.p2.1.m1.1.1.cmml"><mi id="S5.SS6.p2.1.m1.1.1.2" xref="S5.SS6.p2.1.m1.1.1.2.cmml">C</mi><mo id="S5.SS6.p2.1.m1.1.1.1" xref="S5.SS6.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS6.p2.1.m1.1.1.3" xref="S5.SS6.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.1.m1.1b"><apply id="S5.SS6.p2.1.m1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1"><eq id="S5.SS6.p2.1.m1.1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1.1"></eq><ci id="S5.SS6.p2.1.m1.1.1.2.cmml" xref="S5.SS6.p2.1.m1.1.1.2">𝐶</ci><cn type="integer" id="S5.SS6.p2.1.m1.1.1.3.cmml" xref="S5.SS6.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.1.m1.1c">C=1</annotation></semantics></math>. It is important to note that the proposed model outputs two distinct models, one each for domain groups M and S, whereas traditional single-dataset FL frameworks would output only one model for either domain groups M or S.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="/html/2404.13278/assets/Time_consumption.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="335" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S5.F8.3.2" class="ltx_text" style="font-size:90%;">Comparison of time consumption for different FL models including FedAvg, FedProx, FedProx with L2 regularization, and the FTL-TP Model for training two NN-based models for domain group S (Surface) and M (Material).</span></figcaption>
</figure>
<div id="S5.SS6.p3" class="ltx_para">
<p id="S5.SS6.p3.1" class="ltx_p"><a href="#S5.F8" title="Figure 8 ‣ 5.6 Comparative time analysis of FL methodologies ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> compares the time consumption of different FL models. Specifically, we accumulate the total time required for two separate FL implementations to prepare two models and compare this with the time needed to produce the same two models using our proposed method in a single run. The results demonstrate that our proposed framework is less time-consuming compared to other FL approaches for achieving the same output.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>CM performance</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">The results reported in Sections <a href="#S5.SS2" title="5.2 Performance comparison with other learning paradigms ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a> and <a href="#S5.SS3" title="5.3 Performance comparison with other FL methods ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a> lead to several important findings. First, individual clients do not have sufficient data to train their models effectively. This is clear from the significantly lower performance in CM for IL compared to CL, CTL, or any FL approach in this study. Therefore, it is beneficial for clients to participate in a collaborative model training paradigm. Second, the FTL-TP can solve domain shift issues in CM by collaboratively learning the specific characteristics of UMW datasets and using the proposed new loss function. Figures <a href="#S5.F4" title="Figure 4 ‣ 5.2 Performance comparison with other learning paradigms ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S5.F5" title="Figure 5 ‣ 5.3 Performance comparison with other FL methods ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> show the FTL-TP’s performance generally exceeds the performance of other FL paradigms, IL, and CL. This achievement underscores the benefits of learning a shared, simplified representation across various domain spaces. Third, a comparison between CTL and the proposed method, as shown in Figure <a href="#S5.F4" title="Figure 4 ‣ 5.2 Performance comparison with other learning paradigms ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, shows that the FTL-TP surpasses CTL in most cases. This observation reveals that the enhancement in domain generalization by the proposed method is not solely due to the transfer of knowledge between datasets. The manner of this knowledge transfer and the application of generalization techniques, such as the L2R loss, play crucial roles as well.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p">Additionally, we evaluate the proposed method under unbalanced data distribution, which is a key challenge in FL settings. Figure <a href="#S5.F6" title="Figure 6 ‣ 5.4 Performance comparison between balanced and unbalanced data distribution ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows that FTL-TP yields similar results in both balanced and unbalanced data conditions in most cases. The observed decrease in accuracy for the Contam domain as the target in Figure <a href="#S5.F6.sf2" title="Figure 6(b) ‣ Figure 6 ‣ 5.4 Performance comparison between balanced and unbalanced data distribution ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(b)</span></a>, under unbalanced conditions, might be attributed to the specific characteristics of the contaminated surface condition, such as the presence of oil drops, which introduce a wide range of variability. This agrees with the findings from previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, where CM tasks under contaminated surface conditions were shown to be more challenging. This decrease in accuracy could also be due to the model’s increased sensitivity under unbalanced conditions. Moreover, the limited number of data points available to some clients in domain group S, potentially as few as 15, may further affect the model’s accuracy. However, it is important to highlight that the unbalanced accuracy for the Contam domain in domain group S still exceeds the performance of IL, CL, CTL, and other FL models under balanced conditions, as evidenced by comparing Figure <a href="#S5.F6.sf2" title="Figure 6(b) ‣ Figure 6 ‣ 5.4 Performance comparison between balanced and unbalanced data distribution ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(b)</span></a> with Figures <a href="#S5.F4.sf2" title="Figure 4(b) ‣ Figure 4 ‣ 5.2 Performance comparison with other learning paradigms ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(b)</span></a> and <a href="#S5.F5.sf2" title="Figure 5(b) ‣ Figure 5 ‣ 5.3 Performance comparison with other FL methods ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(b)</span></a>.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Training efficiency</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">The efficiency of the proposed model is evaluated in terms of data and time efficiency. Focusing on data efficiency, Figure <a href="#S5.F7" title="Figure 7 ‣ 5.5 Performance comparison for different client fractions ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> demonstrates that engaging more clients leads to improved performance. This improvement is linked to the FL model being trained on a larger dataset at each server round. A comparison of model performance with one-third of clients in this figure with Figure <a href="#S5.F4" title="Figure 4 ‣ 5.2 Performance comparison with other learning paradigms ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> reveals that even limited collaboration among clients (just two clients for domain group S and three for domain group M) significantly boosts the accuracy of models over IL. Moreover, this minimum of collaboration yields results that are comparable to those achieved by CL.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.1" class="ltx_p">Additionally, when comparing Figures <a href="#S5.F5" title="Figure 5 ‣ 5.3 Performance comparison with other FL methods ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and <a href="#S5.F7" title="Figure 7 ‣ 5.5 Performance comparison for different client fractions ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, it is evident that the outcomes of minimal collaboration in our proposed framework, using a client fraction of 1/3, are either comparable to or, in some instances, exceed the results of other FL approaches with a client fraction of 1. This finding suggests that the FTL-TP method, by including only two clients from domain group S (totaling 60 data points) and three clients from domain group M (totaling 200 data points), can outperform state-of-the-art FL methods that use all available data points from domain group M (600 data points). This notable improvement is likely due to the efficient representation learning that takes place between clients across both datasets.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.1" class="ltx_p">Figure <a href="#S5.F8" title="Figure 8 ‣ 5.6 Comparative time analysis of FL methodologies ‣ 5 Case Studies ‣ Federated Transfer Learning with Task Personalization for Condition Monitoring in Ultrasonic Metal Welding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows that our framework is more time-efficient in training models compared to traditional FL frameworks. For instance, the FedAvg framework, which is considered as the simplest FL model, requires over 20% more time for training. When using an FL framework with the same loss function as FTL-TP, the extra time needed increases to more than 50%. Notably, within the single-dataset frameworks for domain groups M and S, there are 9 and 6 clients, running on 3 and 2 Raspberry Pis, respectively. The FTL-TP method which is a dual-dataset framework includes 15 clients implemented on 4 Raspberry Pis, which can raise the latency in the edge-cloud implementation. Despite this, the proposed approach proves to be more time-efficient overall. Additionally, in the system developed with Raspberry Pis and a message broker for weight transmission, the training time for 10 server rounds is under two minutes, making FTL-TP suitable for real-world applications.</p>
</div>
<div id="S6.SS2.p4" class="ltx_para">
<p id="S6.SS2.p4.1" class="ltx_p">Based on these observations, it is evident that the FTL-TP framework is not only data-efficient but also exhibits considerable time efficiency. This combination of efficiencies makes this framework an effective solution for real-world manufacturing FL applications.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Limitations and future work</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">Our study highlights the critical importance of both the volume of data and the approach to integrating data in FL implementations within industrial settings. It also points out the necessity for additional model optimization to improve its ability to handle unbalanced data distributions, particularly in more complex scenarios like the Contam domain. Future research should focus on adaptive learning strategies or domain-specific adjustments to manage the challenges posed by unbalanced data better, thereby enhancing the model’s overall effectiveness.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.1" class="ltx_p">Additionally, the approach to privacy in our current algorithm is foundational, serving as a solid base for further enhancements. FL clients face various security threats, such as data poisoning, model evasion, model update poisoning, and data inference attacks, which could originate from either participating clients or a malicious server. In the field of FL, techniques like differential privacy, homomorphic encryption, and secure multiparty computation are extensively discussed for protecting client data. These methods for enhancing privacy should be rigorously examined and potentially incorporated into our framework, particularly for applications involving real industrial data. Implementing these security measures would not only enhance data protection but also increase the trustworthiness and practicality of the FL model in industrial settings.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">The limited availability of data, combined with the ever-changing and varied configurations in modern manufacturing, has posed significant challenges to the application of machine learning, especially in CM. To address these challenges, this paper presents a novel FTL-TP framework to provide enhanced domain generalization capabilities in FL. Through learning a unified representation from feature space, FTL-TP is able to automatically adapt CM models for clients belong to distince domain groups. Implementations on real-world UMW datasets demonstrate that FTL-TP not only outperforms other learning paradigms but also state-of-the-art FL methods. Compared with baseline FL algorithms, FTL-TP has 5.35%–8.08% improvement of accuracy domain generalization tasks. FTL-TP is also shown to achieve excellent performance in challenging scenarios involving unbalanced data distributions and limited client fractions. Furthermore, the FTL-TP method is implemented on an edge-cloud architecture. Results show that FTL-TP both viable and efficient in practice. It is worth noting that the FTL-TP framework is readily extensible to various other industrial applications where challenges of data availability and data privacy are present simultaneously.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This research has been supported by the National Science Foundation under Grant Nos. 1944345 and 2126246.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">CRediT authorship contribution statement</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p"><span id="Sx2.p1.1.1" class="ltx_text ltx_font_bold">Ahmadreza Eslaminia</span>: Conceptualization, Methodology, Software, Formal analysis, Investigation, Validation, Visualization, Writing – original draft, Writing – review &amp; editing. <span id="Sx2.p1.1.2" class="ltx_text ltx_font_bold">Yuquan Meng</span>: Conceptualization, Formal analysis, Investigation, Data curation, Visualization, Writing – original draft, Writing – review &amp; editing. <span id="Sx2.p1.1.3" class="ltx_text ltx_font_bold">Klara Nahrstedt</span>: Conceptualization, Methodology, Resources, Investigation, Visualization, Writing – original draft, Writing – review &amp; editing, Supervision, Project administration, Funding acquisition. <span id="Sx2.p1.1.4" class="ltx_text ltx_font_bold">Chenhui Shao</span>: Conceptualization, Methodology, Resources, Investigation, Visualization, Writing – original draft, Writing – review &amp; editing, Supervision, Project administration, Funding acquisition.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Z. Ni, F. Ye, Ultrasonic spot welding of aluminum alloys: A review, Journal of
Manufacturing Processes 35 (2018) 580–594.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. de Leon, H.-S. Shin, Review of the advancements in aluminum and copper
ultrasonic welding in electric vehicles and superconductor applications,
Journal of Materials Processing Technology 307 (2022) 117691.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
W. W. Cai, B. Kang, S. J. Hu, Ultrasonic Welding of Lithium-Ion Batteries,
ASME Press, 2017.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
I. Balz, E. Abi Raad, E. Rosenthal, R. Lohoff, A. Schiebahn, U. Reisgen,
M. Vorländer, Process monitoring of ultrasonic metal welding of battery
tabs using external sensor data, Journal of Advanced Joining Processes 1
(2020) 100005.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Y. Meng, C. Shao, Physics-informed ensemble learning for online joint strength
prediction in ultrasonic metal welding, Mechanical Systems and Signal
Processing 181 (2022) 109473.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
C. Shao, T. Hyung Kim, S. Jack Hu, J. Jin, J. A. Abell, J. Patrick Spicer, Tool
wear monitoring for ultrasonic metal welding of lithium-ion batteries,
Journal of Manufacturing Science and Engineering 138 (5) (2016) 051005.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
R. Nunes, K. Faes, S. De Meester, W. De Waele, A. Kubit, Influence of welding
parameters and surface preparation on thin copper–copper sheets welded by
ultrasonic welding process, The International Journal of Advanced
Manufacturing Technology 123 (1-2) (2022) 373–388.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Q. Nazir, C. Shao, Online tool condition monitoring for ultrasonic metal
welding via sensor fusion and machine learning, Journal of Manufacturing
Processes 62 (2021) 806–816.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
K.-C. Lu, Y. Meng, Z. Dong, C. Shao, Online cost-effective classification of
mixed tool and material conditions in ultrasonic metal welding: Towards
integrated monitoring and control, in: International Manufacturing Science
and Engineering Conference, Vol. 87240, American Society of Mechanical
Engineers, 2023, p. V002T07A007.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Meng, K.-C. Lu, Z. Dong, S. Li, C. Shao, Explainable few-shot learning for
online anomaly detection in ultrasonic metal welding with varying
configurations, Journal of Manufacturing Processes 107 (2023) 345–355.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
M. Mehta, C. Shao, Adaptive sampling design for multi-task learning of gaussian
processes in manufacturing, Journal of Manufacturing Systems 61 (2021)
326–337.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
M. Mehta, C. Shao, Federated learning-based semantic segmentation for
pixel-wise defect detection in additive manufacturing, Journal of
Manufacturing Systems 64 (2022) 197–210.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Mehta, S. Chen, H. Tang, C. Shao, A federated learning approach to mixed
fault diagnosis in rotating machinery, Journal of Manufacturing Systems 68
(2023) 687–694.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Q. Yang, Y. Liu, T. Chen, Y. Tong, Federated machine learning: Concept and
applications, ACM Transactions on Intelligent Systems and Technology (TIST)
10 (2) (2019) 1–19.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
L. Wang, R. X. Gao, Condition monitoring and control for intelligent
manufacturing, Springer Science &amp; Business Media, 2006.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
R. Y. Zhong, L. Wang, X. Xu, An iot-enabled real-time machine status monitoring
approach for cloud manufacturing, Procedia Cirp 63 (2017) 709–714.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
R. Zhao, R. Yan, Z. Chen, K. Mao, P. Wang, R. X. Gao, Deep learning and its
applications to machine health monitoring, Mechanical Systems and Signal
Processing 115 (2019) 213–237.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Z. Huang, W. Li, J. Zhu, L. Wang, Cross-domain tool wear condition monitoring
via residual attention hybrid adaptation network, Journal of Manufacturing
Systems 72 (2024) 406–423.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
C. Domínguez-Monferrer, J. Fernández-Pérez, R. De Santos,
M. Miguélez, J. Cantero, Machine learning approach in non-intrusive
monitoring of tool wear evolution in massive cfrp automatic drilling
processes in the aircraft industry, Journal of Manufacturing Systems 65
(2022) 622–639.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
C. Ferreira, G. Gonçalves, Remaining useful life prediction and
challenges: A literature review on the use of machine learning methods,
Journal of Manufacturing Systems 63 (2022) 550–562.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Z. Hou, C. Lee, Y. Lv, K. Keung, Fault detection and diagnosis of air brake
system: A systematic review, Journal of Manufacturing Systems 71 (2023)
34–58.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
M. Yin, S. Zhuo, L. Xie, L. Chen, M. Wang, G. Liu, Online monitoring of local
defects in robotic laser additive manufacturing process based on a dynamic
mapping strategy and multibranch fusion convolutional neural network, Journal
of Manufacturing Systems 71 (2023) 494–503.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Wu, Y. Meng, C. Shao, End-to-end online quality prediction for ultrasonic
metal welding using sensor fusion and deep learning, Journal of Manufacturing
Processes 83 (2022) 685–694.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
E. B. Schwarz, F. Bleier, F. Guenter, R. Mikut, J. P. Bergmann, Improving
process monitoring of ultrasonic metal welding using classical machine
learning methods and process-informed time series evaluation, Journal of
Manufacturing Processes 77 (2022) 54–62.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
M. Russell, P. Wang, Maximizing model generalization for machine condition
monitoring with self-supervised learning and federated learning, Journal of
Manufacturing Systems 71 (2023) 274–285.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
B. Tian, A. Eslaminia, K.-C. Lu, Y. Wang, C. Shao, K. Nahrstedt, Weldmon: A
cost-effective ultrasonic welding machine condition monitoring system, in:
2023 IEEE 14th Annual Ubiquitous Computing, Electronics &amp; Mobile
Communication Conference (UEMCON), IEEE, 2023, pp. 0310–0319.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
M. Hao, H. Li, X. Luo, G. Xu, H. Yang, S. Liu, Efficient and privacy-enhanced
federated learning for industrial artificial intelligence, IEEE Transactions
on Industrial Informatics 16 (10) (2019) 6532–6542.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
L. Li, Y. Fan, M. Tse, K.-Y. Lin, A review of applications in federated
learning, Computers &amp; Industrial Engineering 149 (2020) 106854.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
L. U. Khan, S. R. Pandey, N. H. Tran, W. Saad, Z. Han, M. N. Nguyen, C. S.
Hong, Federated learning for edge networks: Resource optimization and
incentive mechanism, IEEE Communications Magazine 58 (10) (2020) 88–93.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, B. A. y Arcas,
Communication-efficient learning of deep networks from decentralized data,
in: Artificial intelligence and statistics, PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, V. Smith, Federated
optimization in heterogeneous networks, Proceedings of Machine learning and
systems 2 (2020) 429–450.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
A. T. Nguyen, P. Torr, S. N. Lim, Fedsr: A simple and effective domain
generalization method for federated learning, Advances in Neural Information
Processing Systems 35 (2022) 38831–38843.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
L. Zhang, X. Lei, Y. Shi, H. Huang, C. Chen, Federated learning with domain
generalization, arXiv preprint arXiv:2111.10487 (2021).

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings, et al., Advances and open
problems in federated learning, Foundations and trends in machine learning
14 (1–2) (2021) 1–210.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
T. Berghout, M. Benbouzid, T. Bentrcia, W. H. Lim, Y. Amirat, Federated
learning for condition monitoring of industrial processes: A review on fault
diagnosis methods, challenges, and prospects, Electronics 12 (1) (2022) 158.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
J. Ahn, Y. Lee, N. Kim, C. Park, J. Jeong, Federated learning for predictive
maintenance and anomaly detection using time series data distribution shifts
in manufacturing processes, Sensors 23 (17) (2023) 7331.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, A. T. Suresh, Three approaches for personalization
with applications to federated learning, arXiv preprint arXiv:2002.10619
(2020).

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
I. Kevin, K. Wang, X. Zhou, W. Liang, Z. Yan, J. She, Federated transfer
learning based cross-domain prediction for smart manufacturing, IEEE
Transactions on Industrial Informatics 18 (6) (2021) 4088–4096.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
S. Chung, R. Al Kontar, Federated condition monitoring signal prediction with
improved generalization, IEEE Transactions on Reliability (2023).

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
M. G. Arivazhagan, V. Aggarwal, A. K. Singh, S. Choudhary, Federated learning
with personalization layers, arXiv preprint arXiv:1912.00818 (2019).

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
D. Dossot, RabbitMQ essentials, Packt Publishing Ltd, 2014.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix"><span class="ltx_tag ltx_tag_appendix">Appendix A </span></h2>

<figure id="A1.fig1" class="ltx_figure">
<figure id="alg1a" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:433.6pt;">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1a.2.1.1" class="ltx_text ltx_font_bold">Algorithm A1</span> </span> Federated Averaging (FedAvg)</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1a.3" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1b.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1b.2" class="ltx_text ltx_font_bold">Server side:</span>

</div>
<div id="alg1.l2b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2b.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Initialize parameters <math id="alg1.l2b.m1.1" class="ltx_Math" alttext="\theta^{0}" display="inline"><semantics id="alg1.l2b.m1.1a"><msup id="alg1.l2b.m1.1.1" xref="alg1.l2b.m1.1.1.cmml"><mi id="alg1.l2b.m1.1.1.2" xref="alg1.l2b.m1.1.1.2.cmml">θ</mi><mn id="alg1.l2b.m1.1.1.3" xref="alg1.l2b.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2b.m1.1b"><apply id="alg1.l2b.m1.1.1.cmml" xref="alg1.l2b.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2b.m1.1.1.1.cmml" xref="alg1.l2b.m1.1.1">superscript</csymbol><ci id="alg1.l2b.m1.1.1.2.cmml" xref="alg1.l2b.m1.1.1.2">𝜃</ci><cn type="integer" id="alg1.l2b.m1.1.1.3.cmml" xref="alg1.l2b.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2b.m1.1c">\theta^{0}</annotation></semantics></math>

</div>
<div id="alg1.l3b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3b.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3b.2" class="ltx_text ltx_font_bold">for</span> each server round <math id="alg1.l3b.m1.3" class="ltx_Math" alttext="t=1,2,\ldots" display="inline"><semantics id="alg1.l3b.m1.3a"><mrow id="alg1.l3b.m1.3.4" xref="alg1.l3b.m1.3.4.cmml"><mi id="alg1.l3b.m1.3.4.2" xref="alg1.l3b.m1.3.4.2.cmml">t</mi><mo id="alg1.l3b.m1.3.4.1" xref="alg1.l3b.m1.3.4.1.cmml">=</mo><mrow id="alg1.l3b.m1.3.4.3.2" xref="alg1.l3b.m1.3.4.3.1.cmml"><mn id="alg1.l3b.m1.1.1" xref="alg1.l3b.m1.1.1.cmml">1</mn><mo id="alg1.l3b.m1.3.4.3.2.1" xref="alg1.l3b.m1.3.4.3.1.cmml">,</mo><mn id="alg1.l3b.m1.2.2" xref="alg1.l3b.m1.2.2.cmml">2</mn><mo id="alg1.l3b.m1.3.4.3.2.2" xref="alg1.l3b.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3b.m1.3.3" xref="alg1.l3b.m1.3.3.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3b.m1.3b"><apply id="alg1.l3b.m1.3.4.cmml" xref="alg1.l3b.m1.3.4"><eq id="alg1.l3b.m1.3.4.1.cmml" xref="alg1.l3b.m1.3.4.1"></eq><ci id="alg1.l3b.m1.3.4.2.cmml" xref="alg1.l3b.m1.3.4.2">𝑡</ci><list id="alg1.l3b.m1.3.4.3.1.cmml" xref="alg1.l3b.m1.3.4.3.2"><cn type="integer" id="alg1.l3b.m1.1.1.cmml" xref="alg1.l3b.m1.1.1">1</cn><cn type="integer" id="alg1.l3b.m1.2.2.cmml" xref="alg1.l3b.m1.2.2">2</cn><ci id="alg1.l3b.m1.3.3.cmml" xref="alg1.l3b.m1.3.3">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3b.m1.3c">t=1,2,\ldots</annotation></semantics></math> <span id="alg1.l3b.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4b.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <math id="alg1.l4b.m1.3" class="ltx_Math" alttext="m\leftarrow\max(C\cdot M,1)" display="inline"><semantics id="alg1.l4b.m1.3a"><mrow id="alg1.l4b.m1.3.3" xref="alg1.l4b.m1.3.3.cmml"><mi id="alg1.l4b.m1.3.3.3" xref="alg1.l4b.m1.3.3.3.cmml">m</mi><mo stretchy="false" id="alg1.l4b.m1.3.3.2" xref="alg1.l4b.m1.3.3.2.cmml">←</mo><mrow id="alg1.l4b.m1.3.3.1.1" xref="alg1.l4b.m1.3.3.1.2.cmml"><mi id="alg1.l4b.m1.1.1" xref="alg1.l4b.m1.1.1.cmml">max</mi><mo id="alg1.l4b.m1.3.3.1.1a" xref="alg1.l4b.m1.3.3.1.2.cmml">⁡</mo><mrow id="alg1.l4b.m1.3.3.1.1.1" xref="alg1.l4b.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg1.l4b.m1.3.3.1.1.1.2" xref="alg1.l4b.m1.3.3.1.2.cmml">(</mo><mrow id="alg1.l4b.m1.3.3.1.1.1.1" xref="alg1.l4b.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l4b.m1.3.3.1.1.1.1.2" xref="alg1.l4b.m1.3.3.1.1.1.1.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l4b.m1.3.3.1.1.1.1.1" xref="alg1.l4b.m1.3.3.1.1.1.1.1.cmml">⋅</mo><mi id="alg1.l4b.m1.3.3.1.1.1.1.3" xref="alg1.l4b.m1.3.3.1.1.1.1.3.cmml">M</mi></mrow><mo id="alg1.l4b.m1.3.3.1.1.1.3" xref="alg1.l4b.m1.3.3.1.2.cmml">,</mo><mn id="alg1.l4b.m1.2.2" xref="alg1.l4b.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l4b.m1.3.3.1.1.1.4" xref="alg1.l4b.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4b.m1.3b"><apply id="alg1.l4b.m1.3.3.cmml" xref="alg1.l4b.m1.3.3"><ci id="alg1.l4b.m1.3.3.2.cmml" xref="alg1.l4b.m1.3.3.2">←</ci><ci id="alg1.l4b.m1.3.3.3.cmml" xref="alg1.l4b.m1.3.3.3">𝑚</ci><apply id="alg1.l4b.m1.3.3.1.2.cmml" xref="alg1.l4b.m1.3.3.1.1"><max id="alg1.l4b.m1.1.1.cmml" xref="alg1.l4b.m1.1.1"></max><apply id="alg1.l4b.m1.3.3.1.1.1.1.cmml" xref="alg1.l4b.m1.3.3.1.1.1.1"><ci id="alg1.l4b.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l4b.m1.3.3.1.1.1.1.1">⋅</ci><ci id="alg1.l4b.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l4b.m1.3.3.1.1.1.1.2">𝐶</ci><ci id="alg1.l4b.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l4b.m1.3.3.1.1.1.1.3">𝑀</ci></apply><cn type="integer" id="alg1.l4b.m1.2.2.cmml" xref="alg1.l4b.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4b.m1.3c">m\leftarrow\max(C\cdot M,1)</annotation></semantics></math>

</div>
<div id="alg1.l5b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5b.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <math id="alg1.l5b.m1.1" class="ltx_Math" alttext="m_{t}\leftarrow" display="inline"><semantics id="alg1.l5b.m1.1a"><mrow id="alg1.l5b.m1.1.1" xref="alg1.l5b.m1.1.1.cmml"><msub id="alg1.l5b.m1.1.1.2" xref="alg1.l5b.m1.1.1.2.cmml"><mi id="alg1.l5b.m1.1.1.2.2" xref="alg1.l5b.m1.1.1.2.2.cmml">m</mi><mi id="alg1.l5b.m1.1.1.2.3" xref="alg1.l5b.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l5b.m1.1.1.1" xref="alg1.l5b.m1.1.1.1.cmml">←</mo><mi id="alg1.l5b.m1.1.1.3" xref="alg1.l5b.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5b.m1.1b"><apply id="alg1.l5b.m1.1.1.cmml" xref="alg1.l5b.m1.1.1"><ci id="alg1.l5b.m1.1.1.1.cmml" xref="alg1.l5b.m1.1.1.1">←</ci><apply id="alg1.l5b.m1.1.1.2.cmml" xref="alg1.l5b.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5b.m1.1.1.2.1.cmml" xref="alg1.l5b.m1.1.1.2">subscript</csymbol><ci id="alg1.l5b.m1.1.1.2.2.cmml" xref="alg1.l5b.m1.1.1.2.2">𝑚</ci><ci id="alg1.l5b.m1.1.1.2.3.cmml" xref="alg1.l5b.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l5b.m1.1.1.3.cmml" xref="alg1.l5b.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5b.m1.1c">m_{t}\leftarrow</annotation></semantics></math> (random set of <math id="alg1.l5b.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l5b.m2.1a"><mi id="alg1.l5b.m2.1.1" xref="alg1.l5b.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l5b.m2.1b"><ci id="alg1.l5b.m2.1.1.cmml" xref="alg1.l5b.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5b.m2.1c">m</annotation></semantics></math> clients)

</div>
<div id="alg1.l6b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6b.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     Send the current global model <math id="alg1.l6b.m1.1" class="ltx_Math" alttext="\theta_{t-1}" display="inline"><semantics id="alg1.l6b.m1.1a"><msub id="alg1.l6b.m1.1.1" xref="alg1.l6b.m1.1.1.cmml"><mi id="alg1.l6b.m1.1.1.2" xref="alg1.l6b.m1.1.1.2.cmml">θ</mi><mrow id="alg1.l6b.m1.1.1.3" xref="alg1.l6b.m1.1.1.3.cmml"><mi id="alg1.l6b.m1.1.1.3.2" xref="alg1.l6b.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l6b.m1.1.1.3.1" xref="alg1.l6b.m1.1.1.3.1.cmml">−</mo><mn id="alg1.l6b.m1.1.1.3.3" xref="alg1.l6b.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l6b.m1.1b"><apply id="alg1.l6b.m1.1.1.cmml" xref="alg1.l6b.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6b.m1.1.1.1.cmml" xref="alg1.l6b.m1.1.1">subscript</csymbol><ci id="alg1.l6b.m1.1.1.2.cmml" xref="alg1.l6b.m1.1.1.2">𝜃</ci><apply id="alg1.l6b.m1.1.1.3.cmml" xref="alg1.l6b.m1.1.1.3"><minus id="alg1.l6b.m1.1.1.3.1.cmml" xref="alg1.l6b.m1.1.1.3.1"></minus><ci id="alg1.l6b.m1.1.1.3.2.cmml" xref="alg1.l6b.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l6b.m1.1.1.3.3.cmml" xref="alg1.l6b.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6b.m1.1c">\theta_{t-1}</annotation></semantics></math> to the selected clients

</div>
<div id="alg1.l7b" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7b.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7b.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l7b.m1.1" class="ltx_Math" alttext="k\in m_{t}" display="inline"><semantics id="alg1.l7b.m1.1a"><mrow id="alg1.l7b.m1.1.1" xref="alg1.l7b.m1.1.1.cmml"><mi id="alg1.l7b.m1.1.1.2" xref="alg1.l7b.m1.1.1.2.cmml">k</mi><mo id="alg1.l7b.m1.1.1.1" xref="alg1.l7b.m1.1.1.1.cmml">∈</mo><msub id="alg1.l7b.m1.1.1.3" xref="alg1.l7b.m1.1.1.3.cmml"><mi id="alg1.l7b.m1.1.1.3.2" xref="alg1.l7b.m1.1.1.3.2.cmml">m</mi><mi id="alg1.l7b.m1.1.1.3.3" xref="alg1.l7b.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7b.m1.1b"><apply id="alg1.l7b.m1.1.1.cmml" xref="alg1.l7b.m1.1.1"><in id="alg1.l7b.m1.1.1.1.cmml" xref="alg1.l7b.m1.1.1.1"></in><ci id="alg1.l7b.m1.1.1.2.cmml" xref="alg1.l7b.m1.1.1.2">𝑘</ci><apply id="alg1.l7b.m1.1.1.3.cmml" xref="alg1.l7b.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7b.m1.1.1.3.1.cmml" xref="alg1.l7b.m1.1.1.3">subscript</csymbol><ci id="alg1.l7b.m1.1.1.3.2.cmml" xref="alg1.l7b.m1.1.1.3.2">𝑚</ci><ci id="alg1.l7b.m1.1.1.3.3.cmml" xref="alg1.l7b.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7b.m1.1c">k\in m_{t}</annotation></semantics></math> in parallel <span id="alg1.l7b.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8a.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>         <math id="alg1.l8a.m1.1" class="ltx_Math" alttext="\theta_{k}^{t}\leftarrow" display="inline"><semantics id="alg1.l8a.m1.1a"><mrow id="alg1.l8a.m1.1.1" xref="alg1.l8a.m1.1.1.cmml"><msubsup id="alg1.l8a.m1.1.1.2" xref="alg1.l8a.m1.1.1.2.cmml"><mi id="alg1.l8a.m1.1.1.2.2.2" xref="alg1.l8a.m1.1.1.2.2.2.cmml">θ</mi><mi id="alg1.l8a.m1.1.1.2.2.3" xref="alg1.l8a.m1.1.1.2.2.3.cmml">k</mi><mi id="alg1.l8a.m1.1.1.2.3" xref="alg1.l8a.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l8a.m1.1.1.1" xref="alg1.l8a.m1.1.1.1.cmml">←</mo><mi id="alg1.l8a.m1.1.1.3" xref="alg1.l8a.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8a.m1.1b"><apply id="alg1.l8a.m1.1.1.cmml" xref="alg1.l8a.m1.1.1"><ci id="alg1.l8a.m1.1.1.1.cmml" xref="alg1.l8a.m1.1.1.1">←</ci><apply id="alg1.l8a.m1.1.1.2.cmml" xref="alg1.l8a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8a.m1.1.1.2.1.cmml" xref="alg1.l8a.m1.1.1.2">superscript</csymbol><apply id="alg1.l8a.m1.1.1.2.2.cmml" xref="alg1.l8a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8a.m1.1.1.2.2.1.cmml" xref="alg1.l8a.m1.1.1.2">subscript</csymbol><ci id="alg1.l8a.m1.1.1.2.2.2.cmml" xref="alg1.l8a.m1.1.1.2.2.2">𝜃</ci><ci id="alg1.l8a.m1.1.1.2.2.3.cmml" xref="alg1.l8a.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg1.l8a.m1.1.1.2.3.cmml" xref="alg1.l8a.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l8a.m1.1.1.3.cmml" xref="alg1.l8a.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m1.1c">\theta_{k}^{t}\leftarrow</annotation></semantics></math> ClientUpdate(<math id="alg1.l8a.m2.2" class="ltx_Math" alttext="k,\theta^{t-1}" display="inline"><semantics id="alg1.l8a.m2.2a"><mrow id="alg1.l8a.m2.2.2.1" xref="alg1.l8a.m2.2.2.2.cmml"><mi id="alg1.l8a.m2.1.1" xref="alg1.l8a.m2.1.1.cmml">k</mi><mo id="alg1.l8a.m2.2.2.1.2" xref="alg1.l8a.m2.2.2.2.cmml">,</mo><msup id="alg1.l8a.m2.2.2.1.1" xref="alg1.l8a.m2.2.2.1.1.cmml"><mi id="alg1.l8a.m2.2.2.1.1.2" xref="alg1.l8a.m2.2.2.1.1.2.cmml">θ</mi><mrow id="alg1.l8a.m2.2.2.1.1.3" xref="alg1.l8a.m2.2.2.1.1.3.cmml"><mi id="alg1.l8a.m2.2.2.1.1.3.2" xref="alg1.l8a.m2.2.2.1.1.3.2.cmml">t</mi><mo id="alg1.l8a.m2.2.2.1.1.3.1" xref="alg1.l8a.m2.2.2.1.1.3.1.cmml">−</mo><mn id="alg1.l8a.m2.2.2.1.1.3.3" xref="alg1.l8a.m2.2.2.1.1.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8a.m2.2b"><list id="alg1.l8a.m2.2.2.2.cmml" xref="alg1.l8a.m2.2.2.1"><ci id="alg1.l8a.m2.1.1.cmml" xref="alg1.l8a.m2.1.1">𝑘</ci><apply id="alg1.l8a.m2.2.2.1.1.cmml" xref="alg1.l8a.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l8a.m2.2.2.1.1.1.cmml" xref="alg1.l8a.m2.2.2.1.1">superscript</csymbol><ci id="alg1.l8a.m2.2.2.1.1.2.cmml" xref="alg1.l8a.m2.2.2.1.1.2">𝜃</ci><apply id="alg1.l8a.m2.2.2.1.1.3.cmml" xref="alg1.l8a.m2.2.2.1.1.3"><minus id="alg1.l8a.m2.2.2.1.1.3.1.cmml" xref="alg1.l8a.m2.2.2.1.1.3.1"></minus><ci id="alg1.l8a.m2.2.2.1.1.3.2.cmml" xref="alg1.l8a.m2.2.2.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l8a.m2.2.2.1.1.3.3.cmml" xref="alg1.l8a.m2.2.2.1.1.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m2.2c">k,\theta^{t-1}</annotation></semantics></math>)

</div>
<div id="alg1.l9a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9a.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>         Receive updates <math id="alg1.l9a.m1.1" class="ltx_Math" alttext="\theta_{k}^{t}" display="inline"><semantics id="alg1.l9a.m1.1a"><msubsup id="alg1.l9a.m1.1.1" xref="alg1.l9a.m1.1.1.cmml"><mi id="alg1.l9a.m1.1.1.2.2" xref="alg1.l9a.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l9a.m1.1.1.2.3" xref="alg1.l9a.m1.1.1.2.3.cmml">k</mi><mi id="alg1.l9a.m1.1.1.3" xref="alg1.l9a.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9a.m1.1b"><apply id="alg1.l9a.m1.1.1.cmml" xref="alg1.l9a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9a.m1.1.1.1.cmml" xref="alg1.l9a.m1.1.1">superscript</csymbol><apply id="alg1.l9a.m1.1.1.2.cmml" xref="alg1.l9a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9a.m1.1.1.2.1.cmml" xref="alg1.l9a.m1.1.1">subscript</csymbol><ci id="alg1.l9a.m1.1.1.2.2.cmml" xref="alg1.l9a.m1.1.1.2.2">𝜃</ci><ci id="alg1.l9a.m1.1.1.2.3.cmml" xref="alg1.l9a.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l9a.m1.1.1.3.cmml" xref="alg1.l9a.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9a.m1.1c">\theta_{k}^{t}</annotation></semantics></math> from client <math id="alg1.l9a.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l9a.m2.1a"><mi id="alg1.l9a.m2.1.1" xref="alg1.l9a.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l9a.m2.1b"><ci id="alg1.l9a.m2.1.1.cmml" xref="alg1.l9a.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9a.m2.1c">k</annotation></semantics></math>

</div>
<div id="alg1.l10a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10a.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <span id="alg1.l10a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11a.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <math id="alg1.l11a.m1.1" class="ltx_Math" alttext="N\leftarrow\sum_{k=1}^{m}n_{k}" display="inline"><semantics id="alg1.l11a.m1.1a"><mrow id="alg1.l11a.m1.1.1" xref="alg1.l11a.m1.1.1.cmml"><mi id="alg1.l11a.m1.1.1.2" xref="alg1.l11a.m1.1.1.2.cmml">N</mi><mo rspace="0.111em" stretchy="false" id="alg1.l11a.m1.1.1.1" xref="alg1.l11a.m1.1.1.1.cmml">←</mo><mrow id="alg1.l11a.m1.1.1.3" xref="alg1.l11a.m1.1.1.3.cmml"><msubsup id="alg1.l11a.m1.1.1.3.1" xref="alg1.l11a.m1.1.1.3.1.cmml"><mo id="alg1.l11a.m1.1.1.3.1.2.2" xref="alg1.l11a.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l11a.m1.1.1.3.1.2.3" xref="alg1.l11a.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l11a.m1.1.1.3.1.2.3.2" xref="alg1.l11a.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l11a.m1.1.1.3.1.2.3.1" xref="alg1.l11a.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l11a.m1.1.1.3.1.2.3.3" xref="alg1.l11a.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l11a.m1.1.1.3.1.3" xref="alg1.l11a.m1.1.1.3.1.3.cmml">m</mi></msubsup><msub id="alg1.l11a.m1.1.1.3.2" xref="alg1.l11a.m1.1.1.3.2.cmml"><mi id="alg1.l11a.m1.1.1.3.2.2" xref="alg1.l11a.m1.1.1.3.2.2.cmml">n</mi><mi id="alg1.l11a.m1.1.1.3.2.3" xref="alg1.l11a.m1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11a.m1.1b"><apply id="alg1.l11a.m1.1.1.cmml" xref="alg1.l11a.m1.1.1"><ci id="alg1.l11a.m1.1.1.1.cmml" xref="alg1.l11a.m1.1.1.1">←</ci><ci id="alg1.l11a.m1.1.1.2.cmml" xref="alg1.l11a.m1.1.1.2">𝑁</ci><apply id="alg1.l11a.m1.1.1.3.cmml" xref="alg1.l11a.m1.1.1.3"><apply id="alg1.l11a.m1.1.1.3.1.cmml" xref="alg1.l11a.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l11a.m1.1.1.3.1.1.cmml" xref="alg1.l11a.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l11a.m1.1.1.3.1.2.cmml" xref="alg1.l11a.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l11a.m1.1.1.3.1.2.1.cmml" xref="alg1.l11a.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l11a.m1.1.1.3.1.2.2.cmml" xref="alg1.l11a.m1.1.1.3.1.2.2"></sum><apply id="alg1.l11a.m1.1.1.3.1.2.3.cmml" xref="alg1.l11a.m1.1.1.3.1.2.3"><eq id="alg1.l11a.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l11a.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l11a.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l11a.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l11a.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l11a.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l11a.m1.1.1.3.1.3.cmml" xref="alg1.l11a.m1.1.1.3.1.3">𝑚</ci></apply><apply id="alg1.l11a.m1.1.1.3.2.cmml" xref="alg1.l11a.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l11a.m1.1.1.3.2.1.cmml" xref="alg1.l11a.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l11a.m1.1.1.3.2.2.cmml" xref="alg1.l11a.m1.1.1.3.2.2">𝑛</ci><ci id="alg1.l11a.m1.1.1.3.2.3.cmml" xref="alg1.l11a.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11a.m1.1c">N\leftarrow\sum_{k=1}^{m}n_{k}</annotation></semantics></math>

</div>
<div id="alg1.l12a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12a.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     <math id="alg1.l12a.m1.1" class="ltx_Math" alttext="\theta_{t}\leftarrow\sum_{k=1}^{m}\frac{n_{k}}{N}\theta_{k}^{t}" display="inline"><semantics id="alg1.l12a.m1.1a"><mrow id="alg1.l12a.m1.1.1" xref="alg1.l12a.m1.1.1.cmml"><msub id="alg1.l12a.m1.1.1.2" xref="alg1.l12a.m1.1.1.2.cmml"><mi id="alg1.l12a.m1.1.1.2.2" xref="alg1.l12a.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l12a.m1.1.1.2.3" xref="alg1.l12a.m1.1.1.2.3.cmml">t</mi></msub><mo rspace="0.111em" stretchy="false" id="alg1.l12a.m1.1.1.1" xref="alg1.l12a.m1.1.1.1.cmml">←</mo><mrow id="alg1.l12a.m1.1.1.3" xref="alg1.l12a.m1.1.1.3.cmml"><msubsup id="alg1.l12a.m1.1.1.3.1" xref="alg1.l12a.m1.1.1.3.1.cmml"><mo id="alg1.l12a.m1.1.1.3.1.2.2" xref="alg1.l12a.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l12a.m1.1.1.3.1.2.3" xref="alg1.l12a.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l12a.m1.1.1.3.1.2.3.2" xref="alg1.l12a.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg1.l12a.m1.1.1.3.1.2.3.1" xref="alg1.l12a.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l12a.m1.1.1.3.1.2.3.3" xref="alg1.l12a.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l12a.m1.1.1.3.1.3" xref="alg1.l12a.m1.1.1.3.1.3.cmml">m</mi></msubsup><mrow id="alg1.l12a.m1.1.1.3.2" xref="alg1.l12a.m1.1.1.3.2.cmml"><mfrac id="alg1.l12a.m1.1.1.3.2.2" xref="alg1.l12a.m1.1.1.3.2.2.cmml"><msub id="alg1.l12a.m1.1.1.3.2.2.2" xref="alg1.l12a.m1.1.1.3.2.2.2.cmml"><mi id="alg1.l12a.m1.1.1.3.2.2.2.2" xref="alg1.l12a.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="alg1.l12a.m1.1.1.3.2.2.2.3" xref="alg1.l12a.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg1.l12a.m1.1.1.3.2.2.3" xref="alg1.l12a.m1.1.1.3.2.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l12a.m1.1.1.3.2.1" xref="alg1.l12a.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg1.l12a.m1.1.1.3.2.3" xref="alg1.l12a.m1.1.1.3.2.3.cmml"><mi id="alg1.l12a.m1.1.1.3.2.3.2.2" xref="alg1.l12a.m1.1.1.3.2.3.2.2.cmml">θ</mi><mi id="alg1.l12a.m1.1.1.3.2.3.2.3" xref="alg1.l12a.m1.1.1.3.2.3.2.3.cmml">k</mi><mi id="alg1.l12a.m1.1.1.3.2.3.3" xref="alg1.l12a.m1.1.1.3.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12a.m1.1b"><apply id="alg1.l12a.m1.1.1.cmml" xref="alg1.l12a.m1.1.1"><ci id="alg1.l12a.m1.1.1.1.cmml" xref="alg1.l12a.m1.1.1.1">←</ci><apply id="alg1.l12a.m1.1.1.2.cmml" xref="alg1.l12a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12a.m1.1.1.2.1.cmml" xref="alg1.l12a.m1.1.1.2">subscript</csymbol><ci id="alg1.l12a.m1.1.1.2.2.cmml" xref="alg1.l12a.m1.1.1.2.2">𝜃</ci><ci id="alg1.l12a.m1.1.1.2.3.cmml" xref="alg1.l12a.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l12a.m1.1.1.3.cmml" xref="alg1.l12a.m1.1.1.3"><apply id="alg1.l12a.m1.1.1.3.1.cmml" xref="alg1.l12a.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l12a.m1.1.1.3.1.1.cmml" xref="alg1.l12a.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l12a.m1.1.1.3.1.2.cmml" xref="alg1.l12a.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l12a.m1.1.1.3.1.2.1.cmml" xref="alg1.l12a.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l12a.m1.1.1.3.1.2.2.cmml" xref="alg1.l12a.m1.1.1.3.1.2.2"></sum><apply id="alg1.l12a.m1.1.1.3.1.2.3.cmml" xref="alg1.l12a.m1.1.1.3.1.2.3"><eq id="alg1.l12a.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l12a.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l12a.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l12a.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l12a.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l12a.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l12a.m1.1.1.3.1.3.cmml" xref="alg1.l12a.m1.1.1.3.1.3">𝑚</ci></apply><apply id="alg1.l12a.m1.1.1.3.2.cmml" xref="alg1.l12a.m1.1.1.3.2"><times id="alg1.l12a.m1.1.1.3.2.1.cmml" xref="alg1.l12a.m1.1.1.3.2.1"></times><apply id="alg1.l12a.m1.1.1.3.2.2.cmml" xref="alg1.l12a.m1.1.1.3.2.2"><divide id="alg1.l12a.m1.1.1.3.2.2.1.cmml" xref="alg1.l12a.m1.1.1.3.2.2"></divide><apply id="alg1.l12a.m1.1.1.3.2.2.2.cmml" xref="alg1.l12a.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l12a.m1.1.1.3.2.2.2.1.cmml" xref="alg1.l12a.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg1.l12a.m1.1.1.3.2.2.2.2.cmml" xref="alg1.l12a.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="alg1.l12a.m1.1.1.3.2.2.2.3.cmml" xref="alg1.l12a.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="alg1.l12a.m1.1.1.3.2.2.3.cmml" xref="alg1.l12a.m1.1.1.3.2.2.3">𝑁</ci></apply><apply id="alg1.l12a.m1.1.1.3.2.3.cmml" xref="alg1.l12a.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l12a.m1.1.1.3.2.3.1.cmml" xref="alg1.l12a.m1.1.1.3.2.3">superscript</csymbol><apply id="alg1.l12a.m1.1.1.3.2.3.2.cmml" xref="alg1.l12a.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l12a.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l12a.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l12a.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l12a.m1.1.1.3.2.3.2.2">𝜃</ci><ci id="alg1.l12a.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l12a.m1.1.1.3.2.3.2.3">𝑘</ci></apply><ci id="alg1.l12a.m1.1.1.3.2.3.3.cmml" xref="alg1.l12a.m1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12a.m1.1c">\theta_{t}\leftarrow\sum_{k=1}^{m}\frac{n_{k}}{N}\theta_{k}^{t}</annotation></semantics></math>

</div>
<div id="alg1.l13a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13a.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><span id="alg1.l13a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13a.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1a.4" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1c.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1c.2" class="ltx_text ltx_font_bold">Client side:</span> 
</div>
<div id="alg1.l2c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2c.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2c.2" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l2c.m1.4" class="ltx_Math" alttext="i=1,2,\ldots,E" display="inline"><semantics id="alg1.l2c.m1.4a"><mrow id="alg1.l2c.m1.4.5" xref="alg1.l2c.m1.4.5.cmml"><mi id="alg1.l2c.m1.4.5.2" xref="alg1.l2c.m1.4.5.2.cmml">i</mi><mo id="alg1.l2c.m1.4.5.1" xref="alg1.l2c.m1.4.5.1.cmml">=</mo><mrow id="alg1.l2c.m1.4.5.3.2" xref="alg1.l2c.m1.4.5.3.1.cmml"><mn id="alg1.l2c.m1.1.1" xref="alg1.l2c.m1.1.1.cmml">1</mn><mo id="alg1.l2c.m1.4.5.3.2.1" xref="alg1.l2c.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l2c.m1.2.2" xref="alg1.l2c.m1.2.2.cmml">2</mn><mo id="alg1.l2c.m1.4.5.3.2.2" xref="alg1.l2c.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2c.m1.3.3" xref="alg1.l2c.m1.3.3.cmml">…</mi><mo id="alg1.l2c.m1.4.5.3.2.3" xref="alg1.l2c.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l2c.m1.4.4" xref="alg1.l2c.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2c.m1.4b"><apply id="alg1.l2c.m1.4.5.cmml" xref="alg1.l2c.m1.4.5"><eq id="alg1.l2c.m1.4.5.1.cmml" xref="alg1.l2c.m1.4.5.1"></eq><ci id="alg1.l2c.m1.4.5.2.cmml" xref="alg1.l2c.m1.4.5.2">𝑖</ci><list id="alg1.l2c.m1.4.5.3.1.cmml" xref="alg1.l2c.m1.4.5.3.2"><cn type="integer" id="alg1.l2c.m1.1.1.cmml" xref="alg1.l2c.m1.1.1">1</cn><cn type="integer" id="alg1.l2c.m1.2.2.cmml" xref="alg1.l2c.m1.2.2">2</cn><ci id="alg1.l2c.m1.3.3.cmml" xref="alg1.l2c.m1.3.3">…</ci><ci id="alg1.l2c.m1.4.4.cmml" xref="alg1.l2c.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2c.m1.4c">i=1,2,\ldots,E</annotation></semantics></math> <span id="alg1.l2c.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3c.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3c.2" class="ltx_text ltx_font_bold">for</span> each mini-batch <math id="alg1.l3c.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg1.l3c.m1.1a"><mi id="alg1.l3c.m1.1.1" xref="alg1.l3c.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg1.l3c.m1.1b"><ci id="alg1.l3c.m1.1.1.cmml" xref="alg1.l3c.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3c.m1.1c">b</annotation></semantics></math> of size <math id="alg1.l3c.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l3c.m2.1a"><mi id="alg1.l3c.m2.1.1" xref="alg1.l3c.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l3c.m2.1b"><ci id="alg1.l3c.m2.1.1.cmml" xref="alg1.l3c.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3c.m2.1c">B</annotation></semantics></math> <span id="alg1.l3c.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4c.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>         <math id="alg1.l4c.m1.2" class="ltx_Math" alttext="\theta\leftarrow\theta-\eta\nabla\mathcal{F}(\theta,b)" display="inline"><semantics id="alg1.l4c.m1.2a"><mrow id="alg1.l4c.m1.2.3" xref="alg1.l4c.m1.2.3.cmml"><mi id="alg1.l4c.m1.2.3.2" xref="alg1.l4c.m1.2.3.2.cmml">θ</mi><mo stretchy="false" id="alg1.l4c.m1.2.3.1" xref="alg1.l4c.m1.2.3.1.cmml">←</mo><mrow id="alg1.l4c.m1.2.3.3" xref="alg1.l4c.m1.2.3.3.cmml"><mi id="alg1.l4c.m1.2.3.3.2" xref="alg1.l4c.m1.2.3.3.2.cmml">θ</mi><mo id="alg1.l4c.m1.2.3.3.1" xref="alg1.l4c.m1.2.3.3.1.cmml">−</mo><mrow id="alg1.l4c.m1.2.3.3.3" xref="alg1.l4c.m1.2.3.3.3.cmml"><mi id="alg1.l4c.m1.2.3.3.3.2" xref="alg1.l4c.m1.2.3.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l4c.m1.2.3.3.3.1" xref="alg1.l4c.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l4c.m1.2.3.3.3.3" xref="alg1.l4c.m1.2.3.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l4c.m1.2.3.3.3.3.1" xref="alg1.l4c.m1.2.3.3.3.3.1.cmml">∇</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4c.m1.2.3.3.3.3.2" xref="alg1.l4c.m1.2.3.3.3.3.2.cmml">ℱ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l4c.m1.2.3.3.3.1a" xref="alg1.l4c.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l4c.m1.2.3.3.3.4.2" xref="alg1.l4c.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg1.l4c.m1.2.3.3.3.4.2.1" xref="alg1.l4c.m1.2.3.3.3.4.1.cmml">(</mo><mi id="alg1.l4c.m1.1.1" xref="alg1.l4c.m1.1.1.cmml">θ</mi><mo id="alg1.l4c.m1.2.3.3.3.4.2.2" xref="alg1.l4c.m1.2.3.3.3.4.1.cmml">,</mo><mi id="alg1.l4c.m1.2.2" xref="alg1.l4c.m1.2.2.cmml">b</mi><mo stretchy="false" id="alg1.l4c.m1.2.3.3.3.4.2.3" xref="alg1.l4c.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4c.m1.2b"><apply id="alg1.l4c.m1.2.3.cmml" xref="alg1.l4c.m1.2.3"><ci id="alg1.l4c.m1.2.3.1.cmml" xref="alg1.l4c.m1.2.3.1">←</ci><ci id="alg1.l4c.m1.2.3.2.cmml" xref="alg1.l4c.m1.2.3.2">𝜃</ci><apply id="alg1.l4c.m1.2.3.3.cmml" xref="alg1.l4c.m1.2.3.3"><minus id="alg1.l4c.m1.2.3.3.1.cmml" xref="alg1.l4c.m1.2.3.3.1"></minus><ci id="alg1.l4c.m1.2.3.3.2.cmml" xref="alg1.l4c.m1.2.3.3.2">𝜃</ci><apply id="alg1.l4c.m1.2.3.3.3.cmml" xref="alg1.l4c.m1.2.3.3.3"><times id="alg1.l4c.m1.2.3.3.3.1.cmml" xref="alg1.l4c.m1.2.3.3.3.1"></times><ci id="alg1.l4c.m1.2.3.3.3.2.cmml" xref="alg1.l4c.m1.2.3.3.3.2">𝜂</ci><apply id="alg1.l4c.m1.2.3.3.3.3.cmml" xref="alg1.l4c.m1.2.3.3.3.3"><ci id="alg1.l4c.m1.2.3.3.3.3.1.cmml" xref="alg1.l4c.m1.2.3.3.3.3.1">∇</ci><ci id="alg1.l4c.m1.2.3.3.3.3.2.cmml" xref="alg1.l4c.m1.2.3.3.3.3.2">ℱ</ci></apply><interval closure="open" id="alg1.l4c.m1.2.3.3.3.4.1.cmml" xref="alg1.l4c.m1.2.3.3.3.4.2"><ci id="alg1.l4c.m1.1.1.cmml" xref="alg1.l4c.m1.1.1">𝜃</ci><ci id="alg1.l4c.m1.2.2.cmml" xref="alg1.l4c.m1.2.2">𝑏</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4c.m1.2c">\theta\leftarrow\theta-\eta\nabla\mathcal{F}(\theta,b)</annotation></semantics></math>

</div>
<div id="alg1.l5c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5c.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5c.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5c.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6c.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6c.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6c.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l7c" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7c.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>Send the updated local model <math id="alg1.l7c.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.l7c.m1.1a"><mi id="alg1.l7c.m1.1.1" xref="alg1.l7c.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l7c.m1.1b"><ci id="alg1.l7c.m1.1.1.cmml" xref="alg1.l7c.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7c.m1.1c">\theta</annotation></semantics></math> to the server

</div>
</div>
</div>
</div>
</figure>
</figure>
<figure id="A1.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table A.1</span>: </span><span id="A1.T2.3.2" class="ltx_text" style="font-size:90%;">Domain group M client distribution in case of taking Al-Al as target domain (N (New) - W (Worn))</span></figcaption>
<table id="A1.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T2.4.1.1" class="ltx_tr">
<th id="A1.T2.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Domains/Classes</th>
<th id="A1.T2.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">TC1 (N-N)</th>
<th id="A1.T2.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">TC2 (N-W)</th>
<th id="A1.T2.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">TC3 (W-N)</th>
<th id="A1.T2.4.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">TC4 (W-N)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T2.4.2.1" class="ltx_tr">
<th id="A1.T2.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Al-Al</th>
<td id="A1.T2.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">Target Domains</td>
</tr>
<tr id="A1.T2.4.3.2" class="ltx_tr">
<th id="A1.T2.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Al-Cu</th>
<td id="A1.T2.4.3.2.2" class="ltx_td ltx_align_center" colspan="4">200 data points in 3 training clients (about 67 each)</td>
</tr>
<tr id="A1.T2.4.4.3" class="ltx_tr">
<th id="A1.T2.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Cu-Cu</th>
<td id="A1.T2.4.4.3.2" class="ltx_td ltx_align_center" colspan="4">200 data points in 3 training clients (about 67 each)</td>
</tr>
<tr id="A1.T2.4.5.4" class="ltx_tr">
<th id="A1.T2.4.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">Cu-Al</th>
<td id="A1.T2.4.5.4.2" class="ltx_td ltx_align_center ltx_border_b" colspan="4">200 data points in 3 training clients (about 67 each)</td>
</tr>
</tbody>
</table>
</figure>
<figure id="A1.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table A.2</span>: </span><span id="A1.T3.3.2" class="ltx_text" style="font-size:90%;">Domain group S client distribution in case of taking clean as target domain</span></figcaption>
<table id="A1.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T3.4.1.1" class="ltx_tr">
<th id="A1.T3.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Domain/Classes</th>
<th id="A1.T3.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">DMGD</th>
<th id="A1.T3.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">New</th>
<th id="A1.T3.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Worn</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T3.4.2.1" class="ltx_tr">
<th id="A1.T3.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Clean</th>
<td id="A1.T3.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">Target domain</td>
</tr>
<tr id="A1.T3.4.3.2" class="ltx_tr">
<th id="A1.T3.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Contam</th>
<td id="A1.T3.4.3.2.2" class="ltx_td ltx_align_center" colspan="3">90 data points in 3 training clients (30 each)</td>
</tr>
<tr id="A1.T3.4.4.3" class="ltx_tr">
<th id="A1.T3.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">Polished</th>
<td id="A1.T3.4.4.3.2" class="ltx_td ltx_align_center ltx_border_b" colspan="3">90 data points in 3 training clients (30 each)</td>
</tr>
</tbody>
</table>
</figure>
<figure id="A1.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A1.T4.2.1.1" class="ltx_text" style="font-size:90%;">Table A.3</span>: </span><span id="A1.T4.3.2" class="ltx_text" style="font-size:90%;">Domain group T client distribution in case of taking DMGD as target domain</span></figcaption>
<table id="A1.T4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.4.1.1" class="ltx_tr">
<th id="A1.T4.4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Domain/Classes</th>
<th id="A1.T4.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Clean</th>
<th id="A1.T4.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Contam</th>
<th id="A1.T4.4.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Polished</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.4.2.1" class="ltx_tr">
<th id="A1.T4.4.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">DMGD</th>
<td id="A1.T4.4.2.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">Target domain</td>
</tr>
<tr id="A1.T4.4.3.2" class="ltx_tr">
<th id="A1.T4.4.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">New</th>
<td id="A1.T4.4.3.2.2" class="ltx_td ltx_align_center" colspan="3">90 data points in 3 training clients (30 each)</td>
</tr>
<tr id="A1.T4.4.4.3" class="ltx_tr">
<th id="A1.T4.4.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">Worn</th>
<td id="A1.T4.4.4.3.2" class="ltx_td ltx_align_center ltx_border_b" colspan="3">90 data points in 3 training clients (30 each)</td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.13277" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.13278" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.13278">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.13278" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.13279" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 17:53:08 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
