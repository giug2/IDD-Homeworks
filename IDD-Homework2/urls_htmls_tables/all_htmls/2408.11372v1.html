<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation</title>
<!--Generated on Wed Aug 21 06:46:14 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Sequential recommendation,  Multi-Behavior,  Information denoising,  Prompt learning
" lang="en" name="keywords"/>
<base href="/html/2408.11372v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S1" title="In Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span><span class="ltx_text ltx_font_smallcaps">INTRODUCTION</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S2" title="In Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><span class="ltx_text ltx_font_smallcaps">RELATED WORK</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S2.SS1" title="In 2 RELATED WORK ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span><span class="ltx_text ltx_font_italic">Multi-behavior Sequential Recommendation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S2.SS2" title="In 2 RELATED WORK ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span><span class="ltx_text ltx_font_italic">Pre-trained Recommendation Methods</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S2.SS3" title="In 2 RELATED WORK ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span><span class="ltx_text ltx_font_italic">Prompt Learning in Recommendation</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S3" title="In Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span class="ltx_text ltx_font_smallcaps">PROBLEM DEFINITION</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4" title="In Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span><span class="ltx_text ltx_font_smallcaps">METHODOLOGY</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.SS1" title="In 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span><span class="ltx_text ltx_font_italic">Behavior-Aware Sequence Embedding</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.SS2" title="In 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span><span class="ltx_text ltx_font_italic">De-noised Pre-trained Model</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.SS3" title="In 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span><span class="ltx_text ltx_font_italic">Customized Prompt Tuning</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.SS3.SSS1" title="In 4.3 Customized Prompt Tuning ‣ 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Prompt Personalization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.SS3.SSS2" title="In 4.3 Customized Prompt Tuning ‣ 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Prompt Progressiveness</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.SS3.SSS3" title="In 4.3 Customized Prompt Tuning ‣ 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Prompt Diversity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.SS4" title="In 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span><span class="ltx_text ltx_font_italic">Essential Analysis of prompts</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5" title="In Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span><span class="ltx_text ltx_font_smallcaps">EXPERIMENT</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS1" title="In 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span><span class="ltx_text ltx_font_italic">Experimental Setting</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS1.SSS1" title="In 5.1 Experimental Setting ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS1.SSS2" title="In 5.1 Experimental Setting ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Comparison Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS1.SSS3" title="In 5.1 Experimental Setting ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS1.SSS4" title="In 5.1 Experimental Setting ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.4 </span>Evaluation Metrics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS2" title="In 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span><span class="ltx_text ltx_font_italic">Overall Performances</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS3" title="In 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span><span class="ltx_text ltx_font_italic">Analysis of Efficiency</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS4" title="In 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span><span class="ltx_text ltx_font_italic">Ablation Studies</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS5" title="In 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span><span class="ltx_text ltx_font_italic">Analysis of the Adaptation to downstream tasks</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS6" title="In 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span><span class="ltx_text ltx_font_italic">Hyperparameter Analysis</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.SS7" title="In 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.7 </span><span class="ltx_text ltx_font_italic">Visualization Analysis.</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S6" title="In Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span><span class="ltx_text ltx_font_smallcaps">CONCLUSION</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Wang,
Yongqiang Han,
Kefan Wang,
Kai Cheng,

<br class="ltx_break"/>Zhen Wang,
Wei Guo,
Yong Liu,
Defu Lian,
and Enhong Chen
</span><span class="ltx_author_notes">
H. Wang, Y. Han, K. Wang, K. Cheng, D. Lian and E. Chen (corresponding author) are with the Anhui Province Key Laboratory of Big Data Analysis and Application, School of Computer Science and Technology, University of Science and Technology of China, Hefei, Anhui, 230026, China.
<a class="ltx_ref ltx_href ltx_font_typewriter" href="mailto::" title="">:</a> {wanghao3, liandefu,cheneh}@ustc.edu.cn, {harley,wangkefan,ck2020}@mail.ustc.edu.cn.
Z. Wang is a researcher from SUN YAT-SEN University.
<a class="ltx_ref ltx_href ltx_font_typewriter" href="mailto::" title="">:</a> {wangzh665}@mail.sysu.edu.cn.
W. Guo and Y. Liu are researchers at Huawei’s Noah’s Ark Laboratory.
<a class="ltx_ref ltx_href ltx_font_typewriter" href="mailto::" title="">:</a> {guowei67,liu.yong6}@huawei.com.
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">In the realm of recommendation systems, users exhibit a diverse array of behaviors when interacting with items. This phenomenon has spurred research into learning the implicit semantic relationships between these behaviors to enhance recommendation performance. However, these methods often entail high computational complexity. To address concerns regarding efficiency, pre-training presents a viable solution. Its objective is to extract knowledge from extensive pre-training data and fine-tune the model for downstream tasks. Nevertheless, previous pre-training methods have primarily focused on single-behavior data, while multi-behavior data contains significant noise. Additionally, the fully fine-tuning strategy adopted by these methods still imposes a considerable computational burden. In response to this challenge, we propose DPCPL, the first pre-training and prompt-tuning paradigm tailored for Multi-Behavior Sequential Recommendation. Specifically, in the pre-training stage, we commence by proposing a novel Efficient Behavior Miner (EBM) to filter out the noise at multiple time scales, thereby facilitating the comprehension of the contextual semantics of multi-behavior sequences. Subsequently, we propose to tune the pre-trained model in a highly efficient manner with the proposed Customized Prompt Learning (CPL) module, which generates personalized, progressive, and diverse prompts to fully exploit the potential of the pre-trained model effectively. Extensive experiments on three real-world datasets have unequivocally demonstrated that DPCPL not only exhibits high efficiency and effectiveness, requiring minimal parameter adjustments but also surpasses the state-of-the-art performance across a diverse range of downstream tasks.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Sequential recommendation, Multi-Behavior, Information denoising, Prompt learning

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">INTRODUCTION</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">With the rapid evolution of the Internet, recommendation systems have proliferated across online platforms. Among these systems, sequential recommendation (SR) has garnered considerable attention from both academic researchers and industry practitioners. SR involves predicting the next item for users by analyzing their historical interactions as temporally-ordered sequences. This approach has been extensively explored in various studies such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib10" title="">10</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In reality, users exhibit a diverse range of behaviors when interacting with items, reflecting their multifaceted preferences. For instance, on e-commerce platforms, users may engage with items through various behaviors like clicking, tagging as favorites, adding to carts, and making purchases. These diverse behaviors encapsulate users’ preferences across multiple dimensions and have been leveraged as supplementary knowledge to enhance recommendation accuracy for the target behavior. This approach has been investigated in studies such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib14" title="">14</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="59" id="S1.F1.g1" src="x1.png" width="399"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of our motivations: the rapid increase in user interactions leads to a substantial amount of data, which introduces significant noise. This noise presents challenges in accurately capturing user preferences and highlights the need for more robust pre-training and fine-tuning methods for efficient transfer to downstream tasks.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite the considerable achievements made in recent years, the deployment of these advanced methods is severely constrained by online latency due to their high computational complexity. This limitation forces a compromise on the model input length, leading to suboptimal results. To address this issue, several pre-training methods have been proposed, including PeterRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib15" title="">15</a>]</cite>, UPRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib16" title="">16</a>]</cite>, and PinnerFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib17" title="">17</a>]</cite>. These methods leverage large architectures, such as transformers, to learn common knowledge from extensive historical datasets through self-supervised tasks. After pre-training, the model is fine-tuned for different downstream tasks using recent user behavior data, as discussed in studies such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib17" title="">17</a>]</cite>. This approach allows models to effectively utilize vast amounts of historical data while maintaining efficiency and improving performance on specific tasks.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">With the advent of the pre-training paradigm, the issue of deployment complexity has been alleviated to some extent. This paradigm has enabled models to handle extensive historical data more efficiently, thus improving performance across various downstream tasks. However, despite achieving significant success, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S1.F1" title="Figure 1 ‣ 1 INTRODUCTION ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, these methods still overlook certain problems that need to be addressed, such as noise in historical behaviors and the tuning efficiency and effectiveness in recommendation scenarios.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p5.1.1">Noise in historical behaviors.</span> In multi-behavior sequential recommendation scenarios, the data usually covers a variety of user behaviors such as clicking, browsing, and purchasing, which are interspersed with a large amount of noise information, especially the clicking behavior. These noises can negatively affect the pre-trained model, making it difficult to accurately capture the user’s behavioral patterns, or even overfitting to the noisy information, which ultimately results in unsatisfactory downstream performance. Towards this problem, some pre-training methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib21" title="">21</a>]</cite> proposed to enhance the robustness of the model by contrastive learning with different data augmentation strategies. However, these methods will introduce extra noise during the random data augmentation process, and potential misalignment between the self-supervised task and the recommendation task further hinders their application in the high-noise scenarios.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p6.1.1">Tuning Efficiency and Effectiveness In recommendation scenarios.</span>
Although promising results are achieved in downstream tasks, the comprehensive fine-tuning strategy adopted by previous methods usually requires more time and computational resources. In addition, pre-trained models can learn rich user item representations on large-scale data, but full fine-tuning may cause the catastrophic forgetting issue <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib23" title="">23</a>]</cite>, i.e., some common knowledge acquired from pre-training is forgotten. Therefore, instead of full fine-tuning, we propose to adopt the prompt-tuning technique <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib24" title="">24</a>]</cite> to utilize the pre-trained model, which is proven to be efficient and effective. However, it is non-trivial to adapt prompt-tuning to the multi-behavior sequential recommendation scenario. Unlike NLP, the tokens of the pre-trained recommendation model lack semantic information, making it challenging to manually design hard prompts. Besides, general prompts fail to fulfill the personalization requirement in recommendation systems.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">To tackle the two aforementioned challenges, we propose a novel <span class="ltx_text ltx_font_bold" id="S1.p7.1.1">D</span>enoising <span class="ltx_text ltx_font_bold" id="S1.p7.1.2">P</span>re-training and <span class="ltx_text ltx_font_bold" id="S1.p7.1.3">C</span>ustomized <span class="ltx_text ltx_font_bold" id="S1.p7.1.4">P</span>rompt <span class="ltx_text ltx_font_bold" id="S1.p7.1.5">L</span>earning paradigm (DPCPL) for the efficient multi-behavior sequential recommendation. <span class="ltx_text ltx_font_bold" id="S1.p7.1.6">Firstly</span>, to alleviate the noise problem in user behavior history, we innovatively propose an Efficient Behavior Miner (EBM) in the pre-training stage, which can decompose the user behavior at different time scales through Fast Fourier Transform <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib25" title="">25</a>]</cite>. In addition, we adopt learning filter kernel and techniques such as frequency-aware fusion and chunked diagonal mechanism to reduce noise at different scales and minimize the number of parameters in the model. <span class="ltx_text ltx_font_bold" id="S1.p7.1.7">Secondly</span>, for efficient tuning of pre-trained models in multi-behavioral scenarios, we point out the necessity of personalization for prompts in recommendation systems and introduce a new concept, Customized Prompt Learning (CPL), which dynamically sets up the prompts based on a variety of user-specific auxiliary information. Furthermore, we find the pre-training model adopts a bottom-up process to gradually condense user interests from user behaviors, for this reason, we propose the Prompt Factor Gate (PFG) structure to leverage users’ personalized information to generate layer-wise prompts, enabling an in-depth impact on the model’s learning process. Besides, to avoid homogeneity of prompts, we introduce a compactness regular loss function to better control the diversity of prompts. The contributions of this paper can be summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">(1). We present a comprehensive study on the challenges of pre-training and prompt-tuning in multi-behavior sequential recommendation scenarios. Our study highlights the crucial importance of denoising historical behaviors and implementing personalized prompt learning to enhance the accuracy and efficiency of recommendations.</p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">(2). We propose an efficient denoising module capable of effectively denoising information across multiple scales of behavior sequences with frequency domain mapping during the pre-training stage.</p>
</div>
<div class="ltx_para" id="S1.p10">
<p class="ltx_p" id="S1.p10.1">(3). We introduce the concept of customized prompt learning, aimed at generating personalized, progressive, and diverse prompts to fully utilize the potential of pre-trained models in multiple behaviors.</p>
</div>
<div class="ltx_para" id="S1.p11">
<p class="ltx_p" id="S1.p11.1">(4). We conducted extensive experiments on three real-world datasets and have demonstrated the effectiveness and efficiency of DPCPL, which consistently achieves superior performance across various downstream tasks with minimal parameter tuning.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">RELATED WORK</span>
</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span><span class="ltx_text ltx_font_italic" id="S2.SS1.1.1">Multi-behavior Sequential Recommendation</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Recommendation system recommends personalized content based on individual preferences, sequential recommendation predicts a user’s next target item based on their historical behavior, playing a crucial role in enhancing the user experience on online platforms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib31" title="">31</a>]</cite>. With the emergence of deep learning, sequential recommendation models such as BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib32" title="">32</a>]</cite>, DIN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib33" title="">33</a>]</cite>, SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib34" title="">34</a>]</cite>, and FEARec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib35" title="">35</a>]</cite> were introduced for recommendation tasks. However, they failed to consider the diversity of user interactions in real-world scenarios, such as clicking, liking, and purchasing in e-commerce, which provided valuable insights into user intent. To overcome this limitation, researchers have proposed various methods for handling multi-behavior data.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Previous research has explored the use of multi-task frameworks to optimize recommendation systems. One approach is to model the cascade relationship among different user behaviors, as done in NMTR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib36" title="">36</a>]</cite>. Another approach is to assign user behaviors to distinct tasks and employ hierarchical attention mechanisms to improve recommendation efficiency, as in DIPN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib37" title="">37</a>]</cite>. Other studies have focused on enhancing recommendation by fusing multi-behavior data and using other behaviors as auxiliary signals. This has been achieved through attention mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib38" title="">38</a>]</cite>, graph neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib41" title="">41</a>]</cite>, or other related approaches. For example, MATN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib42" title="">42</a>]</cite> used a transformer and gated network to capture behavior relationships, while CML <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib43" title="">43</a>]</cite> introduced a multi-behavior contrastive learning framework to enhance behavior representations. KMCLR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib14" title="">14</a>]</cite> utilized comparative learning tasks and functional modules to improve recommendation performance through the integration of multiple user behavior signals.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Although the fusion of multi-behavior information can further effectively explore user behavior patterns and multi-dimensional user interests, some behavior data will inevitably introduce noise to the modeling of user interests. This noise poses challenges to the judgment of user sequence interests. Moreover, with the diversification of behavior data, user behavior sequences become increasingly lengthy in a short period, which presents challenges to the efficiency of the sequence recommendation model.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span><span class="ltx_text ltx_font_italic" id="S2.SS2.1.1">Pre-trained Recommendation Methods</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Nonetheless, existing multi-behavior recommendation methods face significant challenges. Firstly, in-depth exploration of user interests often leads to increased model complexity, which compromises operational efficiency in real-world applications. Secondly, the proliferation of behaviors extends the sequences of user interaction history, complicating effective modeling. A practical solution to these problems is to use pre-trained models, which can avoid heavy computational demands during actual deployment.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Therefore, some pre-training methods have been proposed to address computational complexity problem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib46" title="">46</a>]</cite>, which employ large architectures such as transformers to learn common knowledge from large historical data sets through self-supervised tasks, and then fine-tune the model for different downstream tasks to alleviate the issue of deployment complexity. To exemplify, <math alttext="S^{3}" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><msup id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">S</mi><mn id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑆</ci><cn id="S2.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">S^{3}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_S start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math>-Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib20" title="">20</a>]</cite> employs pre-training to bolster data augmentation, with a focus on deciphering correlations across attributes, items, subsequences, and sequences through the lens of mutual information maximization principles. PeterRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib15" title="">15</a>]</cite> starts by pre-training a comprehensive model and then integrates specialized sub-models for downstream tasks, allowing for easy task adaptation. UPRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib16" title="">16</a>]</cite> uses user attributes and social graphs in pre-training to enhance personalization, while CL4SRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib21" title="">21</a>]</cite> employs contrastive learning for sequence modeling. PinnerFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib17" title="">17</a>]</cite> focuses on long-term action prediction with a dense all-action loss.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">However, the self-supervised tasks designed by some methods may introduce additional noise during the random data augmentation process. Additionally, the potential misalignment between self-supervised tasks and recommendation tasks further limits their effectiveness in high-noise scenarios. Moreover, these methods often overlook the need for efficient fine-tuning of the pre-trained models to facilitate the effective transfer to downstream tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span><span class="ltx_text ltx_font_italic" id="S2.SS3.1.1">Prompt Learning in Recommendation</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In contrast to earlier fine-tuning methods, the success of GPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib24" title="">24</a>]</cite> has highlighted the effectiveness of maintaining a well-trained model’s integrity while modifying only the input prompt. This has paved the way for the prompt-tuning paradigm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib47" title="">47</a>]</cite>, which has gained traction in recent years for sequential recommendation tasks. By leveraging fewer parameters and improving efficiency, prompt-tuning enhances model performance.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Several notable works have applied this paradigm. PPR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib48" title="">48</a>]</cite> pre-trains recommendation models and employs sequence prompts to boost performance. UP5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib49" title="">49</a>]</cite> integrates fairness-aware prompt templates to promote recommendation equity. PLCR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib18" title="">18</a>]</cite> incorporates domain knowledge into pre-trained models and fine-tunes them with prompts for more effective cross-domain recommendations. DPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib50" title="">50</a>]</cite> utilizes a three-stage denoising and prompt fine-tuning approach to mitigate noise impacts. CPTPP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib19" title="">19</a>]</cite> combines user information with graph-based contrastive learning to align pre-trained user vectors with downstream tasks.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.1">Despite these advancements, these methods often fall short in personalized modeling under complex behavioral scenarios, leading to suboptimal performance in multi-behavior tasks. The lack of nuanced personalization and adaptation to individual user behaviors remains a significant challenge, suggesting the need for further refinement and innovation in this area.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">PROBLEM DEFINITION</span>
</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we will first delve into the task formulation of pre-training and fine-tuning for multi-behavioral sequential recommendation. This process involves a two-step approach where we initially pre-train the model on a large dataset to capture general patterns, followed by fine-tuning it on a specific dataset to tailor it to the user’s needs. The goal is to provide a more personalized recommendation system that takes into account various behavioral sequences. Following this, we introduce the innovative concept of Customized Prompt Learning. This novel idea aims to leverage the full potential of pre-trained large-scale models by generating prompts dynamically based on individual user characteristics and preferences. By doing so, we can enhance the model’s ability to understand and respond to users’ unique behaviors, ultimately improving the overall recommendation system’s performance.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="127" id="S3.F2.g1" src="x2.png" width="398"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Illustration of our problem: Our task involves taking a sequence of user behaviors as input and predicting the next item of user interaction under a specific target behavior. This target behavior can vary, serving as different downstream tasks.</figcaption>
</figure>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">In traditional sequential recommendation systems, Multi-BehaviorIn traditional sequential recommendation systems, Multi-BehaviorRecommendation (MBSR) utilizes various forms of user interaction data with items, such as clicking, adding to cart, and favoriting, to capture more nuanced patterns of user behavior. Typically, in a multitude of behaviors, there is only one designated target behavior, such as purchasing, and the predictive task involves forecasting items under this particular behavior. However, due to limitations in online latency, it is often essential to pre-train a model on historical data and subsequently fine-tune it using more recent data in real-world scenarios. The primary objective of MBSR is to enhance the precision of recommendations while simultaneously minimizing latency by effectively utilizing information about user interactions with items. This problem can be formally defined as follows:</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.11">DEFINITION 1. <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.p3.11.11">(Pre-training and Fine-tuning for Multi-Behavior Sequential Recommendation)<span class="ltx_text ltx_font_medium" id="S3.p3.11.11.11"> Given the sets of users <math alttext="U" class="ltx_Math" display="inline" id="S3.p3.1.1.1.m1.1"><semantics id="S3.p3.1.1.1.m1.1a"><mi id="S3.p3.1.1.1.m1.1.1" mathvariant="normal" xref="S3.p3.1.1.1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.1.1.m1.1b"><ci id="S3.p3.1.1.1.m1.1.1.cmml" xref="S3.p3.1.1.1.m1.1.1">U</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.1.1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.1.1.m1.1d">italic_U</annotation></semantics></math>, items <math alttext="V" class="ltx_Math" display="inline" id="S3.p3.2.2.2.m2.1"><semantics id="S3.p3.2.2.2.m2.1a"><mi id="S3.p3.2.2.2.m2.1.1" mathvariant="normal" xref="S3.p3.2.2.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.2.2.m2.1b"><ci id="S3.p3.2.2.2.m2.1.1.cmml" xref="S3.p3.2.2.2.m2.1.1">V</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.2.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.2.2.m2.1d">italic_V</annotation></semantics></math>, and types of behavior <math alttext="B" class="ltx_Math" display="inline" id="S3.p3.3.3.3.m3.1"><semantics id="S3.p3.3.3.3.m3.1a"><mi id="S3.p3.3.3.3.m3.1.1" mathvariant="normal" xref="S3.p3.3.3.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.3.3.m3.1b"><ci id="S3.p3.3.3.3.m3.1.1.cmml" xref="S3.p3.3.3.3.m3.1.1">B</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.3.3.m3.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.3.3.m3.1d">italic_B</annotation></semantics></math>, for a user u (<math alttext="u\in U" class="ltx_Math" display="inline" id="S3.p3.4.4.4.m4.1"><semantics id="S3.p3.4.4.4.m4.1a"><mrow id="S3.p3.4.4.4.m4.1.1" xref="S3.p3.4.4.4.m4.1.1.cmml"><mi id="S3.p3.4.4.4.m4.1.1.2" mathvariant="normal" xref="S3.p3.4.4.4.m4.1.1.2.cmml">u</mi><mo id="S3.p3.4.4.4.m4.1.1.1" xref="S3.p3.4.4.4.m4.1.1.1.cmml">∈</mo><mi id="S3.p3.4.4.4.m4.1.1.3" mathvariant="normal" xref="S3.p3.4.4.4.m4.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.4.4.m4.1b"><apply id="S3.p3.4.4.4.m4.1.1.cmml" xref="S3.p3.4.4.4.m4.1.1"><in id="S3.p3.4.4.4.m4.1.1.1.cmml" xref="S3.p3.4.4.4.m4.1.1.1"></in><ci id="S3.p3.4.4.4.m4.1.1.2.cmml" xref="S3.p3.4.4.4.m4.1.1.2">u</ci><ci id="S3.p3.4.4.4.m4.1.1.3.cmml" xref="S3.p3.4.4.4.m4.1.1.3">U</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.4.4.m4.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.4.4.m4.1d">italic_u ∈ italic_U</annotation></semantics></math>), his/her behavior-aware interaction sequence <math alttext="S_{u}" class="ltx_Math" display="inline" id="S3.p3.5.5.5.m5.1"><semantics id="S3.p3.5.5.5.m5.1a"><msub id="S3.p3.5.5.5.m5.1.1" xref="S3.p3.5.5.5.m5.1.1.cmml"><mi id="S3.p3.5.5.5.m5.1.1.2" mathvariant="normal" xref="S3.p3.5.5.5.m5.1.1.2.cmml">S</mi><mi id="S3.p3.5.5.5.m5.1.1.3" mathvariant="normal" xref="S3.p3.5.5.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.5.5.5.m5.1b"><apply id="S3.p3.5.5.5.m5.1.1.cmml" xref="S3.p3.5.5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.5.5.5.m5.1.1.1.cmml" xref="S3.p3.5.5.5.m5.1.1">subscript</csymbol><ci id="S3.p3.5.5.5.m5.1.1.2.cmml" xref="S3.p3.5.5.5.m5.1.1.2">S</ci><ci id="S3.p3.5.5.5.m5.1.1.3.cmml" xref="S3.p3.5.5.5.m5.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.5.5.m5.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.5.5.m5.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> consists of individual triples <math alttext="(v,t,b)" class="ltx_Math" display="inline" id="S3.p3.6.6.6.m6.3"><semantics id="S3.p3.6.6.6.m6.3a"><mrow id="S3.p3.6.6.6.m6.3.4.2" xref="S3.p3.6.6.6.m6.3.4.1.cmml"><mo id="S3.p3.6.6.6.m6.3.4.2.1" stretchy="false" xref="S3.p3.6.6.6.m6.3.4.1.cmml">(</mo><mi id="S3.p3.6.6.6.m6.1.1" mathvariant="normal" xref="S3.p3.6.6.6.m6.1.1.cmml">v</mi><mo id="S3.p3.6.6.6.m6.3.4.2.2" xref="S3.p3.6.6.6.m6.3.4.1.cmml">,</mo><mi id="S3.p3.6.6.6.m6.2.2" mathvariant="normal" xref="S3.p3.6.6.6.m6.2.2.cmml">t</mi><mo id="S3.p3.6.6.6.m6.3.4.2.3" xref="S3.p3.6.6.6.m6.3.4.1.cmml">,</mo><mi id="S3.p3.6.6.6.m6.3.3" mathvariant="normal" xref="S3.p3.6.6.6.m6.3.3.cmml">b</mi><mo id="S3.p3.6.6.6.m6.3.4.2.4" stretchy="false" xref="S3.p3.6.6.6.m6.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.6.6.m6.3b"><vector id="S3.p3.6.6.6.m6.3.4.1.cmml" xref="S3.p3.6.6.6.m6.3.4.2"><ci id="S3.p3.6.6.6.m6.1.1.cmml" xref="S3.p3.6.6.6.m6.1.1">v</ci><ci id="S3.p3.6.6.6.m6.2.2.cmml" xref="S3.p3.6.6.6.m6.2.2">t</ci><ci id="S3.p3.6.6.6.m6.3.3.cmml" xref="S3.p3.6.6.6.m6.3.3">b</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.6.6.m6.3c">(v,t,b)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.6.6.m6.3d">( italic_v , italic_t , italic_b )</annotation></semantics></math> which are ordered by time t. Each triple represents the interacted item v under the behavior type b at time <math alttext="t" class="ltx_Math" display="inline" id="S3.p3.7.7.7.m7.1"><semantics id="S3.p3.7.7.7.m7.1a"><mi id="S3.p3.7.7.7.m7.1.1" mathvariant="normal" xref="S3.p3.7.7.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.7.7.m7.1b"><ci id="S3.p3.7.7.7.m7.1.1.cmml" xref="S3.p3.7.7.7.m7.1.1">t</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.7.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.7.7.m7.1d">italic_t</annotation></semantics></math>. Then a Pre-training and Fine-tuning paradigm consists of two steps: Firstly, given the previous part of users’ behavior-aware interaction sequences <math alttext="S_{u}=[(v_{1},t_{1},b_{1}),(v_{2},t_{2},b_{2}),\dots,(v_{pre},t_{pre},b_{pre})]" class="ltx_Math" display="inline" id="S3.p3.8.8.8.m8.4"><semantics id="S3.p3.8.8.8.m8.4a"><mrow id="S3.p3.8.8.8.m8.4.4" xref="S3.p3.8.8.8.m8.4.4.cmml"><msub id="S3.p3.8.8.8.m8.4.4.5" xref="S3.p3.8.8.8.m8.4.4.5.cmml"><mi id="S3.p3.8.8.8.m8.4.4.5.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.5.2.cmml">S</mi><mi id="S3.p3.8.8.8.m8.4.4.5.3" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.5.3.cmml">u</mi></msub><mo id="S3.p3.8.8.8.m8.4.4.4" xref="S3.p3.8.8.8.m8.4.4.4.cmml">=</mo><mrow id="S3.p3.8.8.8.m8.4.4.3.3" xref="S3.p3.8.8.8.m8.4.4.3.4.cmml"><mo id="S3.p3.8.8.8.m8.4.4.3.3.4" stretchy="false" xref="S3.p3.8.8.8.m8.4.4.3.4.cmml">[</mo><mrow id="S3.p3.8.8.8.m8.2.2.1.1.1.3" xref="S3.p3.8.8.8.m8.2.2.1.1.1.4.cmml"><mo id="S3.p3.8.8.8.m8.2.2.1.1.1.3.4" stretchy="false" xref="S3.p3.8.8.8.m8.2.2.1.1.1.4.cmml">(</mo><msub id="S3.p3.8.8.8.m8.2.2.1.1.1.1.1" xref="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.cmml"><mi id="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.2.cmml">v</mi><mn id="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.3" xref="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p3.8.8.8.m8.2.2.1.1.1.3.5" xref="S3.p3.8.8.8.m8.2.2.1.1.1.4.cmml">,</mo><msub id="S3.p3.8.8.8.m8.2.2.1.1.1.2.2" xref="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.cmml"><mi id="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.2.cmml">t</mi><mn id="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.3" xref="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S3.p3.8.8.8.m8.2.2.1.1.1.3.6" xref="S3.p3.8.8.8.m8.2.2.1.1.1.4.cmml">,</mo><msub id="S3.p3.8.8.8.m8.2.2.1.1.1.3.3" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.cmml"><mi id="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.2.cmml">b</mi><mn id="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.3" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.3.cmml">1</mn></msub><mo id="S3.p3.8.8.8.m8.2.2.1.1.1.3.7" stretchy="false" xref="S3.p3.8.8.8.m8.2.2.1.1.1.4.cmml">)</mo></mrow><mo id="S3.p3.8.8.8.m8.4.4.3.3.5" xref="S3.p3.8.8.8.m8.4.4.3.4.cmml">,</mo><mrow id="S3.p3.8.8.8.m8.3.3.2.2.2.3" xref="S3.p3.8.8.8.m8.3.3.2.2.2.4.cmml"><mo id="S3.p3.8.8.8.m8.3.3.2.2.2.3.4" stretchy="false" xref="S3.p3.8.8.8.m8.3.3.2.2.2.4.cmml">(</mo><msub id="S3.p3.8.8.8.m8.3.3.2.2.2.1.1" xref="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.cmml"><mi id="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.2.cmml">v</mi><mn id="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.3" xref="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.3.cmml">2</mn></msub><mo id="S3.p3.8.8.8.m8.3.3.2.2.2.3.5" xref="S3.p3.8.8.8.m8.3.3.2.2.2.4.cmml">,</mo><msub id="S3.p3.8.8.8.m8.3.3.2.2.2.2.2" xref="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.cmml"><mi id="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.2.cmml">t</mi><mn id="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.3" xref="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.p3.8.8.8.m8.3.3.2.2.2.3.6" xref="S3.p3.8.8.8.m8.3.3.2.2.2.4.cmml">,</mo><msub id="S3.p3.8.8.8.m8.3.3.2.2.2.3.3" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.cmml"><mi id="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.2.cmml">b</mi><mn id="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.3" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.3.cmml">2</mn></msub><mo id="S3.p3.8.8.8.m8.3.3.2.2.2.3.7" stretchy="false" xref="S3.p3.8.8.8.m8.3.3.2.2.2.4.cmml">)</mo></mrow><mo id="S3.p3.8.8.8.m8.4.4.3.3.6" xref="S3.p3.8.8.8.m8.4.4.3.4.cmml">,</mo><mi id="S3.p3.8.8.8.m8.1.1" mathvariant="normal" xref="S3.p3.8.8.8.m8.1.1.cmml">…</mi><mo id="S3.p3.8.8.8.m8.4.4.3.3.7" xref="S3.p3.8.8.8.m8.4.4.3.4.cmml">,</mo><mrow id="S3.p3.8.8.8.m8.4.4.3.3.3.3" xref="S3.p3.8.8.8.m8.4.4.3.3.3.4.cmml"><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.3.4" stretchy="false" xref="S3.p3.8.8.8.m8.4.4.3.3.3.4.cmml">(</mo><msub id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.cmml"><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.2.cmml">v</mi><mrow id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.cmml"><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.2.cmml">p</mi><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.1" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.1.cmml">⁢</mo><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.3" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.3.cmml">r</mi><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.1a" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.1.cmml">⁢</mo><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.4" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.4.cmml">e</mi></mrow></msub><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.3.5" xref="S3.p3.8.8.8.m8.4.4.3.3.3.4.cmml">,</mo><msub id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.cmml"><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.2.cmml">t</mi><mrow id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.cmml"><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.2.cmml">p</mi><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.1" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.3" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.3.cmml">r</mi><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.1a" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.4" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.4.cmml">e</mi></mrow></msub><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.3.6" xref="S3.p3.8.8.8.m8.4.4.3.3.3.4.cmml">,</mo><msub id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.cmml"><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.2.cmml">b</mi><mrow id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.cmml"><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.2" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.2.cmml">p</mi><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.1" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.3" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.3.cmml">r</mi><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.1a" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.4" mathvariant="normal" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.4.cmml">e</mi></mrow></msub><mo id="S3.p3.8.8.8.m8.4.4.3.3.3.3.7" stretchy="false" xref="S3.p3.8.8.8.m8.4.4.3.3.3.4.cmml">)</mo></mrow><mo id="S3.p3.8.8.8.m8.4.4.3.3.8" stretchy="false" xref="S3.p3.8.8.8.m8.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.8.8.m8.4b"><apply id="S3.p3.8.8.8.m8.4.4.cmml" xref="S3.p3.8.8.8.m8.4.4"><eq id="S3.p3.8.8.8.m8.4.4.4.cmml" xref="S3.p3.8.8.8.m8.4.4.4"></eq><apply id="S3.p3.8.8.8.m8.4.4.5.cmml" xref="S3.p3.8.8.8.m8.4.4.5"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.4.4.5.1.cmml" xref="S3.p3.8.8.8.m8.4.4.5">subscript</csymbol><ci id="S3.p3.8.8.8.m8.4.4.5.2.cmml" xref="S3.p3.8.8.8.m8.4.4.5.2">S</ci><ci id="S3.p3.8.8.8.m8.4.4.5.3.cmml" xref="S3.p3.8.8.8.m8.4.4.5.3">u</ci></apply><list id="S3.p3.8.8.8.m8.4.4.3.4.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3"><vector id="S3.p3.8.8.8.m8.2.2.1.1.1.4.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3"><apply id="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.1.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.2.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.2">v</ci><cn id="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.p3.8.8.8.m8.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.1.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.2.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.2">t</ci><cn id="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.3.cmml" type="integer" xref="S3.p3.8.8.8.m8.2.2.1.1.1.2.2.3">1</cn></apply><apply id="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.1.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.2.cmml" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.2">b</ci><cn id="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.3.cmml" type="integer" xref="S3.p3.8.8.8.m8.2.2.1.1.1.3.3.3">1</cn></apply></vector><vector id="S3.p3.8.8.8.m8.3.3.2.2.2.4.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3"><apply id="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.1.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.1.1">subscript</csymbol><ci id="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.2.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.2">v</ci><cn id="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.3.cmml" type="integer" xref="S3.p3.8.8.8.m8.3.3.2.2.2.1.1.3">2</cn></apply><apply id="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.1.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.2.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.2">t</ci><cn id="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.3.cmml" type="integer" xref="S3.p3.8.8.8.m8.3.3.2.2.2.2.2.3">2</cn></apply><apply id="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.1.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3.3">subscript</csymbol><ci id="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.2.cmml" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.2">b</ci><cn id="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.3.cmml" type="integer" xref="S3.p3.8.8.8.m8.3.3.2.2.2.3.3.3">2</cn></apply></vector><ci id="S3.p3.8.8.8.m8.1.1.cmml" xref="S3.p3.8.8.8.m8.1.1">…</ci><vector id="S3.p3.8.8.8.m8.4.4.3.3.3.4.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3"><apply id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.1.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1">subscript</csymbol><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.2.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.2">v</ci><apply id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3"><times id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.1.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.1"></times><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.2.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.2">p</ci><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.3.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.3">r</ci><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.4.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.1.1.3.4">e</ci></apply></apply><apply id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.1.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2">subscript</csymbol><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.2.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.2">t</ci><apply id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3"><times id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.1.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.1"></times><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.2.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.2">p</ci><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.3.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.3">r</ci><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.4.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.2.2.3.4">e</ci></apply></apply><apply id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.1.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3">subscript</csymbol><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.2.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.2">b</ci><apply id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3"><times id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.1.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.1"></times><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.2.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.2">p</ci><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.3.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.3">r</ci><ci id="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.4.cmml" xref="S3.p3.8.8.8.m8.4.4.3.3.3.3.3.3.4">e</ci></apply></apply></vector></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.8.8.m8.4c">S_{u}=[(v_{1},t_{1},b_{1}),(v_{2},t_{2},b_{2}),\dots,(v_{pre},t_{pre},b_{pre})]</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.8.8.m8.4d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ ( italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , ( italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , … , ( italic_v start_POSTSUBSCRIPT italic_p italic_r italic_e end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_p italic_r italic_e end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT italic_p italic_r italic_e end_POSTSUBSCRIPT ) ]</annotation></semantics></math>, where index <math alttext="pre" class="ltx_Math" display="inline" id="S3.p3.9.9.9.m9.1"><semantics id="S3.p3.9.9.9.m9.1a"><mrow id="S3.p3.9.9.9.m9.1.1" xref="S3.p3.9.9.9.m9.1.1.cmml"><mi id="S3.p3.9.9.9.m9.1.1.2" mathvariant="normal" xref="S3.p3.9.9.9.m9.1.1.2.cmml">p</mi><mo id="S3.p3.9.9.9.m9.1.1.1" xref="S3.p3.9.9.9.m9.1.1.1.cmml">⁢</mo><mi id="S3.p3.9.9.9.m9.1.1.3" mathvariant="normal" xref="S3.p3.9.9.9.m9.1.1.3.cmml">r</mi><mo id="S3.p3.9.9.9.m9.1.1.1a" xref="S3.p3.9.9.9.m9.1.1.1.cmml">⁢</mo><mi id="S3.p3.9.9.9.m9.1.1.4" mathvariant="normal" xref="S3.p3.9.9.9.m9.1.1.4.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.9.9.9.m9.1b"><apply id="S3.p3.9.9.9.m9.1.1.cmml" xref="S3.p3.9.9.9.m9.1.1"><times id="S3.p3.9.9.9.m9.1.1.1.cmml" xref="S3.p3.9.9.9.m9.1.1.1"></times><ci id="S3.p3.9.9.9.m9.1.1.2.cmml" xref="S3.p3.9.9.9.m9.1.1.2">p</ci><ci id="S3.p3.9.9.9.m9.1.1.3.cmml" xref="S3.p3.9.9.9.m9.1.1.3">r</ci><ci id="S3.p3.9.9.9.m9.1.1.4.cmml" xref="S3.p3.9.9.9.m9.1.1.4">e</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.9.9.m9.1c">pre</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.9.9.m9.1d">italic_p italic_r italic_e</annotation></semantics></math> is the truncated sequence length in pre-training, a model is pre-trained with multiple pretext tasks based on the sequences. Subsequently, the pre-trained model is further fine-tuned on the remaining user sequences <math alttext="S_{u}=[(v_{pre+1},t_{pre+1},b_{pre+1}),\dots,(v_{|S_{u}|-1},t_{|S_{u}|-1},b_{|%
S_{u}|-1})]" class="ltx_Math" display="inline" id="S3.p3.10.10.10.m10.6"><semantics id="S3.p3.10.10.10.m10.6a"><mrow id="S3.p3.10.10.10.m10.6.6" xref="S3.p3.10.10.10.m10.6.6.cmml"><msub id="S3.p3.10.10.10.m10.6.6.4" xref="S3.p3.10.10.10.m10.6.6.4.cmml"><mi id="S3.p3.10.10.10.m10.6.6.4.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.6.6.4.2.cmml">S</mi><mi id="S3.p3.10.10.10.m10.6.6.4.3" mathvariant="normal" xref="S3.p3.10.10.10.m10.6.6.4.3.cmml">u</mi></msub><mo id="S3.p3.10.10.10.m10.6.6.3" xref="S3.p3.10.10.10.m10.6.6.3.cmml">=</mo><mrow id="S3.p3.10.10.10.m10.6.6.2.2" xref="S3.p3.10.10.10.m10.6.6.2.3.cmml"><mo id="S3.p3.10.10.10.m10.6.6.2.2.3" stretchy="false" xref="S3.p3.10.10.10.m10.6.6.2.3.cmml">[</mo><mrow id="S3.p3.10.10.10.m10.5.5.1.1.1.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.4.cmml"><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.3.4" stretchy="false" xref="S3.p3.10.10.10.m10.5.5.1.1.1.4.cmml">(</mo><msub id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.cmml"><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.2.cmml">v</mi><mrow id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.cmml"><mrow id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.cmml"><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.2.cmml">p</mi><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.1" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.3" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.3.cmml">r</mi><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.1a" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.4" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.4.cmml">e</mi></mrow><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.1" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.3.5" xref="S3.p3.10.10.10.m10.5.5.1.1.1.4.cmml">,</mo><msub id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.cmml"><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.2.cmml">t</mi><mrow id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.cmml"><mrow id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.cmml"><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.2.cmml">p</mi><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.1" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.1.cmml">⁢</mo><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.3" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.3.cmml">r</mi><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.1a" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.1.cmml">⁢</mo><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.4" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.4.cmml">e</mi></mrow><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.1" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.1.cmml">+</mo><mn id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.3.6" xref="S3.p3.10.10.10.m10.5.5.1.1.1.4.cmml">,</mo><msub id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.cmml"><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.2.cmml">b</mi><mrow id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.cmml"><mrow id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.cmml"><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.2.cmml">p</mi><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.1" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.1.cmml">⁢</mo><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.3" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.3.cmml">r</mi><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.1a" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.1.cmml">⁢</mo><mi id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.4" mathvariant="normal" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.4.cmml">e</mi></mrow><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.1" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.1.cmml">+</mo><mn id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.3" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.p3.10.10.10.m10.5.5.1.1.1.3.7" stretchy="false" xref="S3.p3.10.10.10.m10.5.5.1.1.1.4.cmml">)</mo></mrow><mo id="S3.p3.10.10.10.m10.6.6.2.2.4" xref="S3.p3.10.10.10.m10.6.6.2.3.cmml">,</mo><mi id="S3.p3.10.10.10.m10.4.4" mathvariant="normal" xref="S3.p3.10.10.10.m10.4.4.cmml">…</mi><mo id="S3.p3.10.10.10.m10.6.6.2.2.5" xref="S3.p3.10.10.10.m10.6.6.2.3.cmml">,</mo><mrow id="S3.p3.10.10.10.m10.6.6.2.2.2.3" xref="S3.p3.10.10.10.m10.6.6.2.2.2.4.cmml"><mo id="S3.p3.10.10.10.m10.6.6.2.2.2.3.4" stretchy="false" xref="S3.p3.10.10.10.m10.6.6.2.2.2.4.cmml">(</mo><msub id="S3.p3.10.10.10.m10.6.6.2.2.2.1.1" xref="S3.p3.10.10.10.m10.6.6.2.2.2.1.1.cmml"><mi id="S3.p3.10.10.10.m10.6.6.2.2.2.1.1.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.6.6.2.2.2.1.1.2.cmml">v</mi><mrow id="S3.p3.10.10.10.m10.1.1.1" xref="S3.p3.10.10.10.m10.1.1.1.cmml"><mrow id="S3.p3.10.10.10.m10.1.1.1.1.1" xref="S3.p3.10.10.10.m10.1.1.1.1.2.cmml"><mo id="S3.p3.10.10.10.m10.1.1.1.1.1.2" stretchy="false" xref="S3.p3.10.10.10.m10.1.1.1.1.2.1.cmml">|</mo><msub id="S3.p3.10.10.10.m10.1.1.1.1.1.1" xref="S3.p3.10.10.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.p3.10.10.10.m10.1.1.1.1.1.1.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.p3.10.10.10.m10.1.1.1.1.1.1.3" mathvariant="normal" xref="S3.p3.10.10.10.m10.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.p3.10.10.10.m10.1.1.1.1.1.3" stretchy="false" xref="S3.p3.10.10.10.m10.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.p3.10.10.10.m10.1.1.1.2" xref="S3.p3.10.10.10.m10.1.1.1.2.cmml">−</mo><mn id="S3.p3.10.10.10.m10.1.1.1.3" xref="S3.p3.10.10.10.m10.1.1.1.3.cmml">1</mn></mrow></msub><mo id="S3.p3.10.10.10.m10.6.6.2.2.2.3.5" xref="S3.p3.10.10.10.m10.6.6.2.2.2.4.cmml">,</mo><msub id="S3.p3.10.10.10.m10.6.6.2.2.2.2.2" xref="S3.p3.10.10.10.m10.6.6.2.2.2.2.2.cmml"><mi id="S3.p3.10.10.10.m10.6.6.2.2.2.2.2.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.6.6.2.2.2.2.2.2.cmml">t</mi><mrow id="S3.p3.10.10.10.m10.2.2.1" xref="S3.p3.10.10.10.m10.2.2.1.cmml"><mrow id="S3.p3.10.10.10.m10.2.2.1.1.1" xref="S3.p3.10.10.10.m10.2.2.1.1.2.cmml"><mo id="S3.p3.10.10.10.m10.2.2.1.1.1.2" stretchy="false" xref="S3.p3.10.10.10.m10.2.2.1.1.2.1.cmml">|</mo><msub id="S3.p3.10.10.10.m10.2.2.1.1.1.1" xref="S3.p3.10.10.10.m10.2.2.1.1.1.1.cmml"><mi id="S3.p3.10.10.10.m10.2.2.1.1.1.1.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.2.2.1.1.1.1.2.cmml">S</mi><mi id="S3.p3.10.10.10.m10.2.2.1.1.1.1.3" mathvariant="normal" xref="S3.p3.10.10.10.m10.2.2.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.p3.10.10.10.m10.2.2.1.1.1.3" stretchy="false" xref="S3.p3.10.10.10.m10.2.2.1.1.2.1.cmml">|</mo></mrow><mo id="S3.p3.10.10.10.m10.2.2.1.2" xref="S3.p3.10.10.10.m10.2.2.1.2.cmml">−</mo><mn id="S3.p3.10.10.10.m10.2.2.1.3" xref="S3.p3.10.10.10.m10.2.2.1.3.cmml">1</mn></mrow></msub><mo id="S3.p3.10.10.10.m10.6.6.2.2.2.3.6" xref="S3.p3.10.10.10.m10.6.6.2.2.2.4.cmml">,</mo><msub id="S3.p3.10.10.10.m10.6.6.2.2.2.3.3" xref="S3.p3.10.10.10.m10.6.6.2.2.2.3.3.cmml"><mi id="S3.p3.10.10.10.m10.6.6.2.2.2.3.3.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.6.6.2.2.2.3.3.2.cmml">b</mi><mrow id="S3.p3.10.10.10.m10.3.3.1" xref="S3.p3.10.10.10.m10.3.3.1.cmml"><mrow id="S3.p3.10.10.10.m10.3.3.1.1.1" xref="S3.p3.10.10.10.m10.3.3.1.1.2.cmml"><mo id="S3.p3.10.10.10.m10.3.3.1.1.1.2" stretchy="false" xref="S3.p3.10.10.10.m10.3.3.1.1.2.1.cmml">|</mo><msub id="S3.p3.10.10.10.m10.3.3.1.1.1.1" xref="S3.p3.10.10.10.m10.3.3.1.1.1.1.cmml"><mi id="S3.p3.10.10.10.m10.3.3.1.1.1.1.2" mathvariant="normal" xref="S3.p3.10.10.10.m10.3.3.1.1.1.1.2.cmml">S</mi><mi id="S3.p3.10.10.10.m10.3.3.1.1.1.1.3" mathvariant="normal" xref="S3.p3.10.10.10.m10.3.3.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.p3.10.10.10.m10.3.3.1.1.1.3" stretchy="false" xref="S3.p3.10.10.10.m10.3.3.1.1.2.1.cmml">|</mo></mrow><mo id="S3.p3.10.10.10.m10.3.3.1.2" xref="S3.p3.10.10.10.m10.3.3.1.2.cmml">−</mo><mn id="S3.p3.10.10.10.m10.3.3.1.3" xref="S3.p3.10.10.10.m10.3.3.1.3.cmml">1</mn></mrow></msub><mo id="S3.p3.10.10.10.m10.6.6.2.2.2.3.7" stretchy="false" xref="S3.p3.10.10.10.m10.6.6.2.2.2.4.cmml">)</mo></mrow><mo id="S3.p3.10.10.10.m10.6.6.2.2.6" stretchy="false" xref="S3.p3.10.10.10.m10.6.6.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.10.10.10.m10.6b"><apply id="S3.p3.10.10.10.m10.6.6.cmml" xref="S3.p3.10.10.10.m10.6.6"><eq id="S3.p3.10.10.10.m10.6.6.3.cmml" xref="S3.p3.10.10.10.m10.6.6.3"></eq><apply id="S3.p3.10.10.10.m10.6.6.4.cmml" xref="S3.p3.10.10.10.m10.6.6.4"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.6.6.4.1.cmml" xref="S3.p3.10.10.10.m10.6.6.4">subscript</csymbol><ci id="S3.p3.10.10.10.m10.6.6.4.2.cmml" xref="S3.p3.10.10.10.m10.6.6.4.2">S</ci><ci id="S3.p3.10.10.10.m10.6.6.4.3.cmml" xref="S3.p3.10.10.10.m10.6.6.4.3">u</ci></apply><list id="S3.p3.10.10.10.m10.6.6.2.3.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2"><vector id="S3.p3.10.10.10.m10.5.5.1.1.1.4.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3"><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.2">v</ci><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3"><plus id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.1"></plus><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2"><times id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.1"></times><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.2">p</ci><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.3.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.3">r</ci><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.4.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.2.4">e</ci></apply><cn id="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p3.10.10.10.m10.5.5.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2">subscript</csymbol><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.2">t</ci><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3"><plus id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.1"></plus><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2"><times id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.1"></times><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.2">p</ci><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.3.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.3">r</ci><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.4.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.2.4">e</ci></apply><cn id="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.p3.10.10.10.m10.5.5.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3">subscript</csymbol><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.2">b</ci><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3"><plus id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.1"></plus><apply id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2"><times id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.1.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.1"></times><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.2.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.2">p</ci><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.3.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.3">r</ci><ci id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.4.cmml" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.2.4">e</ci></apply><cn id="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.p3.10.10.10.m10.5.5.1.1.1.3.3.3.3">1</cn></apply></apply></vector><ci id="S3.p3.10.10.10.m10.4.4.cmml" xref="S3.p3.10.10.10.m10.4.4">…</ci><vector id="S3.p3.10.10.10.m10.6.6.2.2.2.4.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.3"><apply id="S3.p3.10.10.10.m10.6.6.2.2.2.1.1.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.6.6.2.2.2.1.1.1.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.1.1">subscript</csymbol><ci id="S3.p3.10.10.10.m10.6.6.2.2.2.1.1.2.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.1.1.2">v</ci><apply id="S3.p3.10.10.10.m10.1.1.1.cmml" xref="S3.p3.10.10.10.m10.1.1.1"><minus id="S3.p3.10.10.10.m10.1.1.1.2.cmml" xref="S3.p3.10.10.10.m10.1.1.1.2"></minus><apply id="S3.p3.10.10.10.m10.1.1.1.1.2.cmml" xref="S3.p3.10.10.10.m10.1.1.1.1.1"><abs id="S3.p3.10.10.10.m10.1.1.1.1.2.1.cmml" xref="S3.p3.10.10.10.m10.1.1.1.1.1.2"></abs><apply id="S3.p3.10.10.10.m10.1.1.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.10.10.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.p3.10.10.10.m10.1.1.1.1.1.1.2">S</ci><ci id="S3.p3.10.10.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.p3.10.10.10.m10.1.1.1.1.1.1.3">u</ci></apply></apply><cn id="S3.p3.10.10.10.m10.1.1.1.3.cmml" type="integer" xref="S3.p3.10.10.10.m10.1.1.1.3">1</cn></apply></apply><apply id="S3.p3.10.10.10.m10.6.6.2.2.2.2.2.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.6.6.2.2.2.2.2.1.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.10.10.10.m10.6.6.2.2.2.2.2.2.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.2.2.2">t</ci><apply id="S3.p3.10.10.10.m10.2.2.1.cmml" xref="S3.p3.10.10.10.m10.2.2.1"><minus id="S3.p3.10.10.10.m10.2.2.1.2.cmml" xref="S3.p3.10.10.10.m10.2.2.1.2"></minus><apply id="S3.p3.10.10.10.m10.2.2.1.1.2.cmml" xref="S3.p3.10.10.10.m10.2.2.1.1.1"><abs id="S3.p3.10.10.10.m10.2.2.1.1.2.1.cmml" xref="S3.p3.10.10.10.m10.2.2.1.1.1.2"></abs><apply id="S3.p3.10.10.10.m10.2.2.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.2.2.1.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.2.2.1.1.1.1">subscript</csymbol><ci id="S3.p3.10.10.10.m10.2.2.1.1.1.1.2.cmml" xref="S3.p3.10.10.10.m10.2.2.1.1.1.1.2">S</ci><ci id="S3.p3.10.10.10.m10.2.2.1.1.1.1.3.cmml" xref="S3.p3.10.10.10.m10.2.2.1.1.1.1.3">u</ci></apply></apply><cn id="S3.p3.10.10.10.m10.2.2.1.3.cmml" type="integer" xref="S3.p3.10.10.10.m10.2.2.1.3">1</cn></apply></apply><apply id="S3.p3.10.10.10.m10.6.6.2.2.2.3.3.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.6.6.2.2.2.3.3.1.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.3.3">subscript</csymbol><ci id="S3.p3.10.10.10.m10.6.6.2.2.2.3.3.2.cmml" xref="S3.p3.10.10.10.m10.6.6.2.2.2.3.3.2">b</ci><apply id="S3.p3.10.10.10.m10.3.3.1.cmml" xref="S3.p3.10.10.10.m10.3.3.1"><minus id="S3.p3.10.10.10.m10.3.3.1.2.cmml" xref="S3.p3.10.10.10.m10.3.3.1.2"></minus><apply id="S3.p3.10.10.10.m10.3.3.1.1.2.cmml" xref="S3.p3.10.10.10.m10.3.3.1.1.1"><abs id="S3.p3.10.10.10.m10.3.3.1.1.2.1.cmml" xref="S3.p3.10.10.10.m10.3.3.1.1.1.2"></abs><apply id="S3.p3.10.10.10.m10.3.3.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.10.10.10.m10.3.3.1.1.1.1.1.cmml" xref="S3.p3.10.10.10.m10.3.3.1.1.1.1">subscript</csymbol><ci id="S3.p3.10.10.10.m10.3.3.1.1.1.1.2.cmml" xref="S3.p3.10.10.10.m10.3.3.1.1.1.1.2">S</ci><ci id="S3.p3.10.10.10.m10.3.3.1.1.1.1.3.cmml" xref="S3.p3.10.10.10.m10.3.3.1.1.1.1.3">u</ci></apply></apply><cn id="S3.p3.10.10.10.m10.3.3.1.3.cmml" type="integer" xref="S3.p3.10.10.10.m10.3.3.1.3">1</cn></apply></apply></vector></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.10.10.m10.6c">S_{u}=[(v_{pre+1},t_{pre+1},b_{pre+1}),\dots,(v_{|S_{u}|-1},t_{|S_{u}|-1},b_{|%
S_{u}|-1})]</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.10.10.m10.6d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ ( italic_v start_POSTSUBSCRIPT italic_p italic_r italic_e + 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_p italic_r italic_e + 1 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT italic_p italic_r italic_e + 1 end_POSTSUBSCRIPT ) , … , ( italic_v start_POSTSUBSCRIPT | italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | - 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT | italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | - 1 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT | italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | - 1 end_POSTSUBSCRIPT ) ]</annotation></semantics></math> with a next-item prediction task, which aims to predict the item with the target behavior type at the next time step <math alttext="(v_{|S_{u}|},t_{|S_{u}|},b_{\textrm{target}})" class="ltx_Math" display="inline" id="S3.p3.11.11.11.m11.5"><semantics id="S3.p3.11.11.11.m11.5a"><mrow id="S3.p3.11.11.11.m11.5.5.3" xref="S3.p3.11.11.11.m11.5.5.4.cmml"><mo id="S3.p3.11.11.11.m11.5.5.3.4" stretchy="false" xref="S3.p3.11.11.11.m11.5.5.4.cmml">(</mo><msub id="S3.p3.11.11.11.m11.3.3.1.1" xref="S3.p3.11.11.11.m11.3.3.1.1.cmml"><mi id="S3.p3.11.11.11.m11.3.3.1.1.2" mathvariant="normal" xref="S3.p3.11.11.11.m11.3.3.1.1.2.cmml">v</mi><mrow id="S3.p3.11.11.11.m11.1.1.1.1" xref="S3.p3.11.11.11.m11.1.1.1.2.cmml"><mo id="S3.p3.11.11.11.m11.1.1.1.1.2" stretchy="false" xref="S3.p3.11.11.11.m11.1.1.1.2.1.cmml">|</mo><msub id="S3.p3.11.11.11.m11.1.1.1.1.1" xref="S3.p3.11.11.11.m11.1.1.1.1.1.cmml"><mi id="S3.p3.11.11.11.m11.1.1.1.1.1.2" mathvariant="normal" xref="S3.p3.11.11.11.m11.1.1.1.1.1.2.cmml">S</mi><mi id="S3.p3.11.11.11.m11.1.1.1.1.1.3" mathvariant="normal" xref="S3.p3.11.11.11.m11.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S3.p3.11.11.11.m11.1.1.1.1.3" stretchy="false" xref="S3.p3.11.11.11.m11.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.p3.11.11.11.m11.5.5.3.5" xref="S3.p3.11.11.11.m11.5.5.4.cmml">,</mo><msub id="S3.p3.11.11.11.m11.4.4.2.2" xref="S3.p3.11.11.11.m11.4.4.2.2.cmml"><mi id="S3.p3.11.11.11.m11.4.4.2.2.2" mathvariant="normal" xref="S3.p3.11.11.11.m11.4.4.2.2.2.cmml">t</mi><mrow id="S3.p3.11.11.11.m11.2.2.1.1" xref="S3.p3.11.11.11.m11.2.2.1.2.cmml"><mo id="S3.p3.11.11.11.m11.2.2.1.1.2" stretchy="false" xref="S3.p3.11.11.11.m11.2.2.1.2.1.cmml">|</mo><msub id="S3.p3.11.11.11.m11.2.2.1.1.1" xref="S3.p3.11.11.11.m11.2.2.1.1.1.cmml"><mi id="S3.p3.11.11.11.m11.2.2.1.1.1.2" mathvariant="normal" xref="S3.p3.11.11.11.m11.2.2.1.1.1.2.cmml">S</mi><mi id="S3.p3.11.11.11.m11.2.2.1.1.1.3" mathvariant="normal" xref="S3.p3.11.11.11.m11.2.2.1.1.1.3.cmml">u</mi></msub><mo id="S3.p3.11.11.11.m11.2.2.1.1.3" stretchy="false" xref="S3.p3.11.11.11.m11.2.2.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.p3.11.11.11.m11.5.5.3.6" xref="S3.p3.11.11.11.m11.5.5.4.cmml">,</mo><msub id="S3.p3.11.11.11.m11.5.5.3.3" xref="S3.p3.11.11.11.m11.5.5.3.3.cmml"><mi id="S3.p3.11.11.11.m11.5.5.3.3.2" mathvariant="normal" xref="S3.p3.11.11.11.m11.5.5.3.3.2.cmml">b</mi><mtext id="S3.p3.11.11.11.m11.5.5.3.3.3" xref="S3.p3.11.11.11.m11.5.5.3.3.3a.cmml">target</mtext></msub><mo id="S3.p3.11.11.11.m11.5.5.3.7" stretchy="false" xref="S3.p3.11.11.11.m11.5.5.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.11.11.11.m11.5b"><vector id="S3.p3.11.11.11.m11.5.5.4.cmml" xref="S3.p3.11.11.11.m11.5.5.3"><apply id="S3.p3.11.11.11.m11.3.3.1.1.cmml" xref="S3.p3.11.11.11.m11.3.3.1.1"><csymbol cd="ambiguous" id="S3.p3.11.11.11.m11.3.3.1.1.1.cmml" xref="S3.p3.11.11.11.m11.3.3.1.1">subscript</csymbol><ci id="S3.p3.11.11.11.m11.3.3.1.1.2.cmml" xref="S3.p3.11.11.11.m11.3.3.1.1.2">v</ci><apply id="S3.p3.11.11.11.m11.1.1.1.2.cmml" xref="S3.p3.11.11.11.m11.1.1.1.1"><abs id="S3.p3.11.11.11.m11.1.1.1.2.1.cmml" xref="S3.p3.11.11.11.m11.1.1.1.1.2"></abs><apply id="S3.p3.11.11.11.m11.1.1.1.1.1.cmml" xref="S3.p3.11.11.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.11.11.11.m11.1.1.1.1.1.1.cmml" xref="S3.p3.11.11.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.11.11.11.m11.1.1.1.1.1.2.cmml" xref="S3.p3.11.11.11.m11.1.1.1.1.1.2">S</ci><ci id="S3.p3.11.11.11.m11.1.1.1.1.1.3.cmml" xref="S3.p3.11.11.11.m11.1.1.1.1.1.3">u</ci></apply></apply></apply><apply id="S3.p3.11.11.11.m11.4.4.2.2.cmml" xref="S3.p3.11.11.11.m11.4.4.2.2"><csymbol cd="ambiguous" id="S3.p3.11.11.11.m11.4.4.2.2.1.cmml" xref="S3.p3.11.11.11.m11.4.4.2.2">subscript</csymbol><ci id="S3.p3.11.11.11.m11.4.4.2.2.2.cmml" xref="S3.p3.11.11.11.m11.4.4.2.2.2">t</ci><apply id="S3.p3.11.11.11.m11.2.2.1.2.cmml" xref="S3.p3.11.11.11.m11.2.2.1.1"><abs id="S3.p3.11.11.11.m11.2.2.1.2.1.cmml" xref="S3.p3.11.11.11.m11.2.2.1.1.2"></abs><apply id="S3.p3.11.11.11.m11.2.2.1.1.1.cmml" xref="S3.p3.11.11.11.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.11.11.11.m11.2.2.1.1.1.1.cmml" xref="S3.p3.11.11.11.m11.2.2.1.1.1">subscript</csymbol><ci id="S3.p3.11.11.11.m11.2.2.1.1.1.2.cmml" xref="S3.p3.11.11.11.m11.2.2.1.1.1.2">S</ci><ci id="S3.p3.11.11.11.m11.2.2.1.1.1.3.cmml" xref="S3.p3.11.11.11.m11.2.2.1.1.1.3">u</ci></apply></apply></apply><apply id="S3.p3.11.11.11.m11.5.5.3.3.cmml" xref="S3.p3.11.11.11.m11.5.5.3.3"><csymbol cd="ambiguous" id="S3.p3.11.11.11.m11.5.5.3.3.1.cmml" xref="S3.p3.11.11.11.m11.5.5.3.3">subscript</csymbol><ci id="S3.p3.11.11.11.m11.5.5.3.3.2.cmml" xref="S3.p3.11.11.11.m11.5.5.3.3.2">b</ci><ci id="S3.p3.11.11.11.m11.5.5.3.3.3a.cmml" xref="S3.p3.11.11.11.m11.5.5.3.3.3"><mtext id="S3.p3.11.11.11.m11.5.5.3.3.3.cmml" mathsize="70%" xref="S3.p3.11.11.11.m11.5.5.3.3.3">target</mtext></ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.11.11.m11.5c">(v_{|S_{u}|},t_{|S_{u}|},b_{\textrm{target}})</annotation><annotation encoding="application/x-llamapun" id="S3.p3.11.11.11.m11.5d">( italic_v start_POSTSUBSCRIPT | italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT | italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT target end_POSTSUBSCRIPT )</annotation></semantics></math>.</span></span></p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">However, the comprehensive fine-tuning strategy adopted by previous pre-training methods still poses a considerable computational burden, hindering their application in real-world scenarios. So we intend to follow a pre-training &amp; prompt-tuning paradigm to model user preferences for the sake of efficiency, which is yet non-trivial. On the one hand, the token of the pre-trained recommendation model is the ID of items, which lacks specific semantics, making it challenging to manually design hard prompts based on the grammatical experience as in NLP. On the other hand, personalization plays a crucial role in the field of recommendation systems, which means prompts should vary for each user. To this end, we point out that prompt learning in recommendation scenarios requires personalization and introduce a new concept called Customized Prompt Learning, which involves dynamically setting prompts based on various user-specific auxiliary information. Formally, we define it as:</p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.7">DEFINITION 2. <span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.p5.7.7">(Customized Prompt Learning)<span class="ltx_text ltx_font_medium" id="S3.p5.7.7.7"> Given a user <math alttext="u\in U" class="ltx_Math" display="inline" id="S3.p5.1.1.1.m1.1"><semantics id="S3.p5.1.1.1.m1.1a"><mrow id="S3.p5.1.1.1.m1.1.1" xref="S3.p5.1.1.1.m1.1.1.cmml"><mi id="S3.p5.1.1.1.m1.1.1.2" mathvariant="normal" xref="S3.p5.1.1.1.m1.1.1.2.cmml">u</mi><mo id="S3.p5.1.1.1.m1.1.1.1" xref="S3.p5.1.1.1.m1.1.1.1.cmml">∈</mo><mi id="S3.p5.1.1.1.m1.1.1.3" mathvariant="normal" xref="S3.p5.1.1.1.m1.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.1.1.1.m1.1b"><apply id="S3.p5.1.1.1.m1.1.1.cmml" xref="S3.p5.1.1.1.m1.1.1"><in id="S3.p5.1.1.1.m1.1.1.1.cmml" xref="S3.p5.1.1.1.m1.1.1.1"></in><ci id="S3.p5.1.1.1.m1.1.1.2.cmml" xref="S3.p5.1.1.1.m1.1.1.2">u</ci><ci id="S3.p5.1.1.1.m1.1.1.3.cmml" xref="S3.p5.1.1.1.m1.1.1.3">U</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.1.1.m1.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.1.1.m1.1d">italic_u ∈ italic_U</annotation></semantics></math> and his/her information including attribute sets <math alttext="A_{u}" class="ltx_Math" display="inline" id="S3.p5.2.2.2.m2.1"><semantics id="S3.p5.2.2.2.m2.1a"><msub id="S3.p5.2.2.2.m2.1.1" xref="S3.p5.2.2.2.m2.1.1.cmml"><mi id="S3.p5.2.2.2.m2.1.1.2" mathvariant="normal" xref="S3.p5.2.2.2.m2.1.1.2.cmml">A</mi><mi id="S3.p5.2.2.2.m2.1.1.3" mathvariant="normal" xref="S3.p5.2.2.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.2.2.2.m2.1b"><apply id="S3.p5.2.2.2.m2.1.1.cmml" xref="S3.p5.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p5.2.2.2.m2.1.1.1.cmml" xref="S3.p5.2.2.2.m2.1.1">subscript</csymbol><ci id="S3.p5.2.2.2.m2.1.1.2.cmml" xref="S3.p5.2.2.2.m2.1.1.2">A</ci><ci id="S3.p5.2.2.2.m2.1.1.3.cmml" xref="S3.p5.2.2.2.m2.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.2.2.m2.1c">A_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.2.2.m2.1d">italic_A start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> and behavior-aware interaction Sequence <math alttext="S_{u}" class="ltx_Math" display="inline" id="S3.p5.3.3.3.m3.1"><semantics id="S3.p5.3.3.3.m3.1a"><msub id="S3.p5.3.3.3.m3.1.1" xref="S3.p5.3.3.3.m3.1.1.cmml"><mi id="S3.p5.3.3.3.m3.1.1.2" mathvariant="normal" xref="S3.p5.3.3.3.m3.1.1.2.cmml">S</mi><mi id="S3.p5.3.3.3.m3.1.1.3" mathvariant="normal" xref="S3.p5.3.3.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.3.3.3.m3.1b"><apply id="S3.p5.3.3.3.m3.1.1.cmml" xref="S3.p5.3.3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p5.3.3.3.m3.1.1.1.cmml" xref="S3.p5.3.3.3.m3.1.1">subscript</csymbol><ci id="S3.p5.3.3.3.m3.1.1.2.cmml" xref="S3.p5.3.3.3.m3.1.1.2">S</ci><ci id="S3.p5.3.3.3.m3.1.1.3.cmml" xref="S3.p5.3.3.3.m3.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.3.3.m3.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.3.3.m3.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, the output is a set of customized prompts <math alttext="\{p^{u}_{1},p^{u}_{2},...,p^{u}_{n}\}" class="ltx_Math" display="inline" id="S3.p5.4.4.4.m4.4"><semantics id="S3.p5.4.4.4.m4.4a"><mrow id="S3.p5.4.4.4.m4.4.4.3" xref="S3.p5.4.4.4.m4.4.4.4.cmml"><mo id="S3.p5.4.4.4.m4.4.4.3.4" stretchy="false" xref="S3.p5.4.4.4.m4.4.4.4.cmml">{</mo><msubsup id="S3.p5.4.4.4.m4.2.2.1.1" xref="S3.p5.4.4.4.m4.2.2.1.1.cmml"><mi id="S3.p5.4.4.4.m4.2.2.1.1.2.2" mathvariant="normal" xref="S3.p5.4.4.4.m4.2.2.1.1.2.2.cmml">p</mi><mn id="S3.p5.4.4.4.m4.2.2.1.1.3" xref="S3.p5.4.4.4.m4.2.2.1.1.3.cmml">1</mn><mi id="S3.p5.4.4.4.m4.2.2.1.1.2.3" mathvariant="normal" xref="S3.p5.4.4.4.m4.2.2.1.1.2.3.cmml">u</mi></msubsup><mo id="S3.p5.4.4.4.m4.4.4.3.5" xref="S3.p5.4.4.4.m4.4.4.4.cmml">,</mo><msubsup id="S3.p5.4.4.4.m4.3.3.2.2" xref="S3.p5.4.4.4.m4.3.3.2.2.cmml"><mi id="S3.p5.4.4.4.m4.3.3.2.2.2.2" mathvariant="normal" xref="S3.p5.4.4.4.m4.3.3.2.2.2.2.cmml">p</mi><mn id="S3.p5.4.4.4.m4.3.3.2.2.3" xref="S3.p5.4.4.4.m4.3.3.2.2.3.cmml">2</mn><mi id="S3.p5.4.4.4.m4.3.3.2.2.2.3" mathvariant="normal" xref="S3.p5.4.4.4.m4.3.3.2.2.2.3.cmml">u</mi></msubsup><mo id="S3.p5.4.4.4.m4.4.4.3.6" xref="S3.p5.4.4.4.m4.4.4.4.cmml">,</mo><mi id="S3.p5.4.4.4.m4.1.1" mathvariant="normal" xref="S3.p5.4.4.4.m4.1.1.cmml">…</mi><mo id="S3.p5.4.4.4.m4.4.4.3.7" xref="S3.p5.4.4.4.m4.4.4.4.cmml">,</mo><msubsup id="S3.p5.4.4.4.m4.4.4.3.3" xref="S3.p5.4.4.4.m4.4.4.3.3.cmml"><mi id="S3.p5.4.4.4.m4.4.4.3.3.2.2" mathvariant="normal" xref="S3.p5.4.4.4.m4.4.4.3.3.2.2.cmml">p</mi><mi id="S3.p5.4.4.4.m4.4.4.3.3.3" mathvariant="normal" xref="S3.p5.4.4.4.m4.4.4.3.3.3.cmml">n</mi><mi id="S3.p5.4.4.4.m4.4.4.3.3.2.3" mathvariant="normal" xref="S3.p5.4.4.4.m4.4.4.3.3.2.3.cmml">u</mi></msubsup><mo id="S3.p5.4.4.4.m4.4.4.3.8" stretchy="false" xref="S3.p5.4.4.4.m4.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.4.4.4.m4.4b"><set id="S3.p5.4.4.4.m4.4.4.4.cmml" xref="S3.p5.4.4.4.m4.4.4.3"><apply id="S3.p5.4.4.4.m4.2.2.1.1.cmml" xref="S3.p5.4.4.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.p5.4.4.4.m4.2.2.1.1.1.cmml" xref="S3.p5.4.4.4.m4.2.2.1.1">subscript</csymbol><apply id="S3.p5.4.4.4.m4.2.2.1.1.2.cmml" xref="S3.p5.4.4.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.p5.4.4.4.m4.2.2.1.1.2.1.cmml" xref="S3.p5.4.4.4.m4.2.2.1.1">superscript</csymbol><ci id="S3.p5.4.4.4.m4.2.2.1.1.2.2.cmml" xref="S3.p5.4.4.4.m4.2.2.1.1.2.2">p</ci><ci id="S3.p5.4.4.4.m4.2.2.1.1.2.3.cmml" xref="S3.p5.4.4.4.m4.2.2.1.1.2.3">u</ci></apply><cn id="S3.p5.4.4.4.m4.2.2.1.1.3.cmml" type="integer" xref="S3.p5.4.4.4.m4.2.2.1.1.3">1</cn></apply><apply id="S3.p5.4.4.4.m4.3.3.2.2.cmml" xref="S3.p5.4.4.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.p5.4.4.4.m4.3.3.2.2.1.cmml" xref="S3.p5.4.4.4.m4.3.3.2.2">subscript</csymbol><apply id="S3.p5.4.4.4.m4.3.3.2.2.2.cmml" xref="S3.p5.4.4.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.p5.4.4.4.m4.3.3.2.2.2.1.cmml" xref="S3.p5.4.4.4.m4.3.3.2.2">superscript</csymbol><ci id="S3.p5.4.4.4.m4.3.3.2.2.2.2.cmml" xref="S3.p5.4.4.4.m4.3.3.2.2.2.2">p</ci><ci id="S3.p5.4.4.4.m4.3.3.2.2.2.3.cmml" xref="S3.p5.4.4.4.m4.3.3.2.2.2.3">u</ci></apply><cn id="S3.p5.4.4.4.m4.3.3.2.2.3.cmml" type="integer" xref="S3.p5.4.4.4.m4.3.3.2.2.3">2</cn></apply><ci id="S3.p5.4.4.4.m4.1.1.cmml" xref="S3.p5.4.4.4.m4.1.1">…</ci><apply id="S3.p5.4.4.4.m4.4.4.3.3.cmml" xref="S3.p5.4.4.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S3.p5.4.4.4.m4.4.4.3.3.1.cmml" xref="S3.p5.4.4.4.m4.4.4.3.3">subscript</csymbol><apply id="S3.p5.4.4.4.m4.4.4.3.3.2.cmml" xref="S3.p5.4.4.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S3.p5.4.4.4.m4.4.4.3.3.2.1.cmml" xref="S3.p5.4.4.4.m4.4.4.3.3">superscript</csymbol><ci id="S3.p5.4.4.4.m4.4.4.3.3.2.2.cmml" xref="S3.p5.4.4.4.m4.4.4.3.3.2.2">p</ci><ci id="S3.p5.4.4.4.m4.4.4.3.3.2.3.cmml" xref="S3.p5.4.4.4.m4.4.4.3.3.2.3">u</ci></apply><ci id="S3.p5.4.4.4.m4.4.4.3.3.3.cmml" xref="S3.p5.4.4.4.m4.4.4.3.3.3">n</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.4.4.m4.4c">\{p^{u}_{1},p^{u}_{2},...,p^{u}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.4.4.4.m4.4d">{ italic_p start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_p start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>. <math alttext="p^{u}_{n}" class="ltx_Math" display="inline" id="S3.p5.5.5.5.m5.1"><semantics id="S3.p5.5.5.5.m5.1a"><msubsup id="S3.p5.5.5.5.m5.1.1" xref="S3.p5.5.5.5.m5.1.1.cmml"><mi id="S3.p5.5.5.5.m5.1.1.2.2" mathvariant="normal" xref="S3.p5.5.5.5.m5.1.1.2.2.cmml">p</mi><mi id="S3.p5.5.5.5.m5.1.1.3" mathvariant="normal" xref="S3.p5.5.5.5.m5.1.1.3.cmml">n</mi><mi id="S3.p5.5.5.5.m5.1.1.2.3" mathvariant="normal" xref="S3.p5.5.5.5.m5.1.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p5.5.5.5.m5.1b"><apply id="S3.p5.5.5.5.m5.1.1.cmml" xref="S3.p5.5.5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p5.5.5.5.m5.1.1.1.cmml" xref="S3.p5.5.5.5.m5.1.1">subscript</csymbol><apply id="S3.p5.5.5.5.m5.1.1.2.cmml" xref="S3.p5.5.5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p5.5.5.5.m5.1.1.2.1.cmml" xref="S3.p5.5.5.5.m5.1.1">superscript</csymbol><ci id="S3.p5.5.5.5.m5.1.1.2.2.cmml" xref="S3.p5.5.5.5.m5.1.1.2.2">p</ci><ci id="S3.p5.5.5.5.m5.1.1.2.3.cmml" xref="S3.p5.5.5.5.m5.1.1.2.3">u</ci></apply><ci id="S3.p5.5.5.5.m5.1.1.3.cmml" xref="S3.p5.5.5.5.m5.1.1.3">n</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.5.5.m5.1c">p^{u}_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.5.5.5.m5.1d">italic_p start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> represents the <math alttext="n" class="ltx_Math" display="inline" id="S3.p5.6.6.6.m6.1"><semantics id="S3.p5.6.6.6.m6.1a"><mi id="S3.p5.6.6.6.m6.1.1" mathvariant="normal" xref="S3.p5.6.6.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p5.6.6.6.m6.1b"><ci id="S3.p5.6.6.6.m6.1.1.cmml" xref="S3.p5.6.6.6.m6.1.1">n</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.6.6.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.p5.6.6.6.m6.1d">italic_n</annotation></semantics></math>-th prompt vector for user <math alttext="u" class="ltx_Math" display="inline" id="S3.p5.7.7.7.m7.1"><semantics id="S3.p5.7.7.7.m7.1a"><mi id="S3.p5.7.7.7.m7.1.1" mathvariant="normal" xref="S3.p5.7.7.7.m7.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.p5.7.7.7.m7.1b"><ci id="S3.p5.7.7.7.m7.1.1.cmml" xref="S3.p5.7.7.7.m7.1.1">u</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.7.7.7.m7.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.p5.7.7.7.m7.1d">italic_u</annotation></semantics></math>.These prompts are generated by fusing user-specific information to tune the pre-trained model without modifying its parameters.</span></span></p>
</div>
<div class="ltx_para" id="S3.p6">
<p class="ltx_p" id="S3.p6.1">Based on the above problem definition, we propose the model DPCPL to address the problem of noise impact and computational burden in the previous method.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="388" id="S3.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Our DPCPL model, a pre-training and prompt-tuning paradigm tailored for Multi-Behavior Sequential Recommendation. Specifically, in the pre-training stage, we commence by proposing a novel Efficient Behavior Miner (EBM) to filter out the noise at multiple time scales, therefore facilitating the comprehension of the contextual semantics of multi-behavior sequences. Subsequently, we propose to tune the pre-trained model in a highly efficient manner with the proposed Customized Prompt Learning (CPL) module, which generates personalized, progressive, and diverse prompts to fully exploit the potential of the pre-trained model effectively.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">METHODOLOGY</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we present our model DPCPL, which mainly consists of a denoised pre-trained module and a prompt learning module with personalization, progressivity, and diversity. Our framework is a pioneering model for solving multi-behavior sequential recommendation problems using customized prompt learning. The overall flow of the model is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S3.F3" title="Figure 3 ‣ 3 PROBLEM DEFINITION ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span class="ltx_text ltx_font_italic" id="S4.SS1.1.1">Behavior-Aware Sequence Embedding</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.5">The embedding layer of DPCPL integrates item information (<math alttext="v" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_v</annotation></semantics></math>), position information (<math alttext="p" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_p</annotation></semantics></math>), and behavior information (<math alttext="b" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_b</annotation></semantics></math>). For a triad <math alttext="(v,p,b)" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.3"><semantics id="S4.SS1.p1.4.m4.3a"><mrow id="S4.SS1.p1.4.m4.3.4.2" xref="S4.SS1.p1.4.m4.3.4.1.cmml"><mo id="S4.SS1.p1.4.m4.3.4.2.1" stretchy="false" xref="S4.SS1.p1.4.m4.3.4.1.cmml">(</mo><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">v</mi><mo id="S4.SS1.p1.4.m4.3.4.2.2" xref="S4.SS1.p1.4.m4.3.4.1.cmml">,</mo><mi id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml">p</mi><mo id="S4.SS1.p1.4.m4.3.4.2.3" xref="S4.SS1.p1.4.m4.3.4.1.cmml">,</mo><mi id="S4.SS1.p1.4.m4.3.3" xref="S4.SS1.p1.4.m4.3.3.cmml">b</mi><mo id="S4.SS1.p1.4.m4.3.4.2.4" stretchy="false" xref="S4.SS1.p1.4.m4.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.3b"><vector id="S4.SS1.p1.4.m4.3.4.1.cmml" xref="S4.SS1.p1.4.m4.3.4.2"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑣</ci><ci id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2">𝑝</ci><ci id="S4.SS1.p1.4.m4.3.3.cmml" xref="S4.SS1.p1.4.m4.3.3">𝑏</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.3c">(v,p,b)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.3d">( italic_v , italic_p , italic_b )</annotation></semantics></math> within a user behavior sequence (<math alttext="S" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_S</annotation></semantics></math>), the embedding is denoted as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="e=e_{v}+e_{p}+e_{b},\quad S=[e_{1},e_{2},...,e_{L_{seq}}]\in\mathbb{R}^{L_{seq%
}\times d}," class="ltx_Math" display="block" id="S4.E1.m1.2"><semantics id="S4.E1.m1.2a"><mrow id="S4.E1.m1.2.2.1"><mrow id="S4.E1.m1.2.2.1.1.2" xref="S4.E1.m1.2.2.1.1.3.cmml"><mrow id="S4.E1.m1.2.2.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.2.cmml">e</mi><mo id="S4.E1.m1.2.2.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.cmml">=</mo><mrow id="S4.E1.m1.2.2.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.3.cmml"><msub id="S4.E1.m1.2.2.1.1.1.1.3.2" xref="S4.E1.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.3.2.2" xref="S4.E1.m1.2.2.1.1.1.1.3.2.2.cmml">e</mi><mi id="S4.E1.m1.2.2.1.1.1.1.3.2.3" xref="S4.E1.m1.2.2.1.1.1.1.3.2.3.cmml">v</mi></msub><mo id="S4.E1.m1.2.2.1.1.1.1.3.1" xref="S4.E1.m1.2.2.1.1.1.1.3.1.cmml">+</mo><msub id="S4.E1.m1.2.2.1.1.1.1.3.3" xref="S4.E1.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.3.3.2" xref="S4.E1.m1.2.2.1.1.1.1.3.3.2.cmml">e</mi><mi id="S4.E1.m1.2.2.1.1.1.1.3.3.3" xref="S4.E1.m1.2.2.1.1.1.1.3.3.3.cmml">p</mi></msub><mo id="S4.E1.m1.2.2.1.1.1.1.3.1a" xref="S4.E1.m1.2.2.1.1.1.1.3.1.cmml">+</mo><msub id="S4.E1.m1.2.2.1.1.1.1.3.4" xref="S4.E1.m1.2.2.1.1.1.1.3.4.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.3.4.2" xref="S4.E1.m1.2.2.1.1.1.1.3.4.2.cmml">e</mi><mi id="S4.E1.m1.2.2.1.1.1.1.3.4.3" xref="S4.E1.m1.2.2.1.1.1.1.3.4.3.cmml">b</mi></msub></mrow></mrow><mo id="S4.E1.m1.2.2.1.1.2.3" rspace="1.167em" xref="S4.E1.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S4.E1.m1.2.2.1.1.2.2" xref="S4.E1.m1.2.2.1.1.2.2.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.5" xref="S4.E1.m1.2.2.1.1.2.2.5.cmml">S</mi><mo id="S4.E1.m1.2.2.1.1.2.2.6" xref="S4.E1.m1.2.2.1.1.2.2.6.cmml">=</mo><mrow id="S4.E1.m1.2.2.1.1.2.2.3.3" xref="S4.E1.m1.2.2.1.1.2.2.3.4.cmml"><mo id="S4.E1.m1.2.2.1.1.2.2.3.3.4" stretchy="false" xref="S4.E1.m1.2.2.1.1.2.2.3.4.cmml">[</mo><msub id="S4.E1.m1.2.2.1.1.2.2.1.1.1" xref="S4.E1.m1.2.2.1.1.2.2.1.1.1.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.1.1.1.2" xref="S4.E1.m1.2.2.1.1.2.2.1.1.1.2.cmml">e</mi><mn id="S4.E1.m1.2.2.1.1.2.2.1.1.1.3" xref="S4.E1.m1.2.2.1.1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.E1.m1.2.2.1.1.2.2.3.3.5" xref="S4.E1.m1.2.2.1.1.2.2.3.4.cmml">,</mo><msub id="S4.E1.m1.2.2.1.1.2.2.2.2.2" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.2.2.2.2" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2.2.cmml">e</mi><mn id="S4.E1.m1.2.2.1.1.2.2.2.2.2.3" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.E1.m1.2.2.1.1.2.2.3.3.6" xref="S4.E1.m1.2.2.1.1.2.2.3.4.cmml">,</mo><mi id="S4.E1.m1.1.1" mathvariant="normal" xref="S4.E1.m1.1.1.cmml">…</mi><mo id="S4.E1.m1.2.2.1.1.2.2.3.3.7" xref="S4.E1.m1.2.2.1.1.2.2.3.4.cmml">,</mo><msub id="S4.E1.m1.2.2.1.1.2.2.3.3.3" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.3.3.3.2" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.2.cmml">e</mi><msub id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.2" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.2.cmml">L</mi><mrow id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.2" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.2.cmml">s</mi><mo id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.1" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.3" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.3.cmml">e</mi><mo id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.1a" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.4" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.4.cmml">q</mi></mrow></msub></msub><mo id="S4.E1.m1.2.2.1.1.2.2.3.3.8" stretchy="false" xref="S4.E1.m1.2.2.1.1.2.2.3.4.cmml">]</mo></mrow><mo id="S4.E1.m1.2.2.1.1.2.2.7" xref="S4.E1.m1.2.2.1.1.2.2.7.cmml">∈</mo><msup id="S4.E1.m1.2.2.1.1.2.2.8" xref="S4.E1.m1.2.2.1.1.2.2.8.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.8.2" xref="S4.E1.m1.2.2.1.1.2.2.8.2.cmml">ℝ</mi><mrow id="S4.E1.m1.2.2.1.1.2.2.8.3" xref="S4.E1.m1.2.2.1.1.2.2.8.3.cmml"><msub id="S4.E1.m1.2.2.1.1.2.2.8.3.2" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.8.3.2.2" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.2.cmml">L</mi><mrow id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.cmml"><mi id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.2" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.2.cmml">s</mi><mo id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.1" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.1.cmml">⁢</mo><mi id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.3" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.3.cmml">e</mi><mo id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.1a" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.1.cmml">⁢</mo><mi id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.4" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.4.cmml">q</mi></mrow></msub><mo id="S4.E1.m1.2.2.1.1.2.2.8.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E1.m1.2.2.1.1.2.2.8.3.1.cmml">×</mo><mi id="S4.E1.m1.2.2.1.1.2.2.8.3.3" xref="S4.E1.m1.2.2.1.1.2.2.8.3.3.cmml">d</mi></mrow></msup></mrow></mrow><mo id="S4.E1.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.2b"><apply id="S4.E1.m1.2.2.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.3a.cmml" xref="S4.E1.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E1.m1.2.2.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1"><eq id="S4.E1.m1.2.2.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1"></eq><ci id="S4.E1.m1.2.2.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.2">𝑒</ci><apply id="S4.E1.m1.2.2.1.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3"><plus id="S4.E1.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.1"></plus><apply id="S4.E1.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.2.2">𝑒</ci><ci id="S4.E1.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.2.3">𝑣</ci></apply><apply id="S4.E1.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3.2">𝑒</ci><ci id="S4.E1.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3.3">𝑝</ci></apply><apply id="S4.E1.m1.2.2.1.1.1.1.3.4.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.3.4.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.4">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.3.4.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.4.2">𝑒</ci><ci id="S4.E1.m1.2.2.1.1.1.1.3.4.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.4.3">𝑏</ci></apply></apply></apply><apply id="S4.E1.m1.2.2.1.1.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2"><and id="S4.E1.m1.2.2.1.1.2.2a.cmml" xref="S4.E1.m1.2.2.1.1.2.2"></and><apply id="S4.E1.m1.2.2.1.1.2.2b.cmml" xref="S4.E1.m1.2.2.1.1.2.2"><eq id="S4.E1.m1.2.2.1.1.2.2.6.cmml" xref="S4.E1.m1.2.2.1.1.2.2.6"></eq><ci id="S4.E1.m1.2.2.1.1.2.2.5.cmml" xref="S4.E1.m1.2.2.1.1.2.2.5">𝑆</ci><list id="S4.E1.m1.2.2.1.1.2.2.3.4.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3"><apply id="S4.E1.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.1.1.1">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.1.1.1.2">𝑒</ci><cn id="S4.E1.m1.2.2.1.1.2.2.1.1.1.3.cmml" type="integer" xref="S4.E1.m1.2.2.1.1.2.2.1.1.1.3">1</cn></apply><apply id="S4.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2.2">𝑒</ci><cn id="S4.E1.m1.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E1.m1.2.2.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">…</ci><apply id="S4.E1.m1.2.2.1.1.2.2.3.3.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.3.3.3.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.2.3.3.3.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.2">𝑒</ci><apply id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.2">𝐿</ci><apply id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3"><times id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.1"></times><ci id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.2">𝑠</ci><ci id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.3">𝑒</ci><ci id="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.4.cmml" xref="S4.E1.m1.2.2.1.1.2.2.3.3.3.3.3.4">𝑞</ci></apply></apply></apply></list></apply><apply id="S4.E1.m1.2.2.1.1.2.2c.cmml" xref="S4.E1.m1.2.2.1.1.2.2"><in id="S4.E1.m1.2.2.1.1.2.2.7.cmml" xref="S4.E1.m1.2.2.1.1.2.2.7"></in><share href="https://arxiv.org/html/2408.11372v1#S4.E1.m1.2.2.1.1.2.2.3.cmml" id="S4.E1.m1.2.2.1.1.2.2d.cmml" xref="S4.E1.m1.2.2.1.1.2.2"></share><apply id="S4.E1.m1.2.2.1.1.2.2.8.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.8.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8">superscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.2.8.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.2">ℝ</ci><apply id="S4.E1.m1.2.2.1.1.2.2.8.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3"><times id="S4.E1.m1.2.2.1.1.2.2.8.3.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.1"></times><apply id="S4.E1.m1.2.2.1.1.2.2.8.3.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.2.2.8.3.2.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.2.2.8.3.2.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.2">𝐿</ci><apply id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3"><times id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.1.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.1"></times><ci id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.2.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.2">𝑠</ci><ci id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.3">𝑒</ci><ci id="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.4.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.2.3.4">𝑞</ci></apply></apply><ci id="S4.E1.m1.2.2.1.1.2.2.8.3.3.cmml" xref="S4.E1.m1.2.2.1.1.2.2.8.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.2c">e=e_{v}+e_{p}+e_{b},\quad S=[e_{1},e_{2},...,e_{L_{seq}}]\in\mathbb{R}^{L_{seq%
}\times d},</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.2d">italic_e = italic_e start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT + italic_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT + italic_e start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , italic_S = [ italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_e start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.7">where <math alttext="L_{seq}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m1.1"><semantics id="S4.SS1.p1.6.m1.1a"><msub id="S4.SS1.p1.6.m1.1.1" xref="S4.SS1.p1.6.m1.1.1.cmml"><mi id="S4.SS1.p1.6.m1.1.1.2" xref="S4.SS1.p1.6.m1.1.1.2.cmml">L</mi><mrow id="S4.SS1.p1.6.m1.1.1.3" xref="S4.SS1.p1.6.m1.1.1.3.cmml"><mi id="S4.SS1.p1.6.m1.1.1.3.2" xref="S4.SS1.p1.6.m1.1.1.3.2.cmml">s</mi><mo id="S4.SS1.p1.6.m1.1.1.3.1" xref="S4.SS1.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.6.m1.1.1.3.3" xref="S4.SS1.p1.6.m1.1.1.3.3.cmml">e</mi><mo id="S4.SS1.p1.6.m1.1.1.3.1a" xref="S4.SS1.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.6.m1.1.1.3.4" xref="S4.SS1.p1.6.m1.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m1.1b"><apply id="S4.SS1.p1.6.m1.1.1.cmml" xref="S4.SS1.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m1.1.1.1.cmml" xref="S4.SS1.p1.6.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m1.1.1.2.cmml" xref="S4.SS1.p1.6.m1.1.1.2">𝐿</ci><apply id="S4.SS1.p1.6.m1.1.1.3.cmml" xref="S4.SS1.p1.6.m1.1.1.3"><times id="S4.SS1.p1.6.m1.1.1.3.1.cmml" xref="S4.SS1.p1.6.m1.1.1.3.1"></times><ci id="S4.SS1.p1.6.m1.1.1.3.2.cmml" xref="S4.SS1.p1.6.m1.1.1.3.2">𝑠</ci><ci id="S4.SS1.p1.6.m1.1.1.3.3.cmml" xref="S4.SS1.p1.6.m1.1.1.3.3">𝑒</ci><ci id="S4.SS1.p1.6.m1.1.1.3.4.cmml" xref="S4.SS1.p1.6.m1.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m1.1c">L_{seq}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m1.1d">italic_L start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT</annotation></semantics></math> represents the sequence length, and <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m2.1"><semantics id="S4.SS1.p1.7.m2.1a"><mi id="S4.SS1.p1.7.m2.1.1" xref="S4.SS1.p1.7.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m2.1b"><ci id="S4.SS1.p1.7.m2.1.1.cmml" xref="S4.SS1.p1.7.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m2.1d">italic_d</annotation></semantics></math> denotes the embedding size. This embedding combines item information, position information, and behavior information to reflect the user’s behavioral sequences more comprehensively, which helps to improve the model’s understanding of the user’s interests and behaviors, and thus improves the accuracy of personalized recommendations.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span class="ltx_text ltx_font_italic" id="S4.SS2.1.1">De-noised Pre-trained Model</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Pre-trained models have been devoted to addressing the long-sequence overload issue <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib17" title="">17</a>]</cite>. They often pre-train using long-term historical behavior data and then fine-tune using recent behavior data.
However, in multi-behavior recommendation scenarios, the data typically includes a variety of user behaviors such as clicking, browsing, and purchasing. These behaviors are often interspersed with a significant amount of noise, such as random click activity, which greatly impacts the training of pre-trained models and can further degrade their downstream performance.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Therefore, our research focuses on the need to purify sequences during the pretraining phase. One of the primary challenges in this task is the lack of explicit labels for noise elements, which makes it an unsupervised task. In real-world scenarios, collecting negative feedback from users to identify data noise is extremely difficult. Although previous pre-training methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib20" title="">20</a>]</cite> based on contrastive learning can improve the robustness of models to some extent, they often introduce additional noise during the random data augmentation process. Moreover, the inherent conflict between self-supervised tasks and recommendation tasks further impedes their effectiveness in high-noise environment.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">Recently, some research work has revealed the possibility of frequency-domain denoising in recommendation scenarios with a learnable filter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib51" title="">51</a>]</cite>. Through extensive comparative experiments, it has been conclusively demonstrated that different frequency components of user sequences have varying impacts on recommendation effectiveness. Specifically, low-frequency components tend to contain valuable information, while high-frequency components are often data noise, which is an established conclusion. At the same time, multiplication in the frequency domain can replace convolution in the time domain, fully integrating various feature information while denoising.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.4">Inspired by the above findings, we transform the user behavior sequence <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_S</annotation></semantics></math> into the frequency domain (<math alttext="X" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_X</annotation></semantics></math>) with the help of Fast Fourier Transform (FFT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib52" title="">52</a>]</cite>, and then the filtering operation is implemented through dot product operation. Finally, the fully denoised sequence representation <math alttext="\widetilde{S}" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mover accent="true" id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">S</mi><mo id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><ci id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1">~</ci><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\widetilde{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">over~ start_ARG italic_S end_ARG</annotation></semantics></math> is obtained by inverse transformation. Due to the <math alttext="O(N\log N)" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">O</mi><mo id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p4.4.m4.1.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml"><mo id="S4.SS2.p4.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.4.m4.1.1.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.1.1.1.2" xref="S4.SS2.p4.4.m4.1.1.1.1.1.2.cmml">N</mi><mo id="S4.SS2.p4.4.m4.1.1.1.1.1.1" lspace="0.167em" xref="S4.SS2.p4.4.m4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.p4.4.m4.1.1.1.1.1.3" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p4.4.m4.1.1.1.1.1.3.1" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.SS2.p4.4.m4.1.1.1.1.1.3a" lspace="0.167em" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.SS2.p4.4.m4.1.1.1.1.1.3.2" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo id="S4.SS2.p4.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS2.p4.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><times id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2"></times><ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">𝑂</ci><apply id="S4.SS2.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1"><times id="S4.SS2.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.1"></times><ci id="S4.SS2.p4.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.2">𝑁</ci><apply id="S4.SS2.p4.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3"><log id="S4.SS2.p4.4.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3.1"></log><ci id="S4.SS2.p4.4.m4.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.4.m4.1.1.1.1.1.3.2">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">O(N\log N)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">italic_O ( italic_N roman_log italic_N )</annotation></semantics></math> computational complexity of the FFT, this denoising process is executed with remarkable efficiency. The specific formula is as follows:</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="X=\mathcal{F}\left(S\right)\in\mathbb{C}^{L_{seq}\times d},\widetilde{{X}}={W}%
\odot{X},\widetilde{S}=\mathcal{F}^{-1}\left(\widetilde{X}\right)\in\mathbb{R}%
^{L_{seq}\times d}," class="ltx_Math" display="block" id="S4.E2.m1.3"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3.1"><mrow id="S4.E2.m1.3.3.1.1.2" xref="S4.E2.m1.3.3.1.1.3.cmml"><mrow id="S4.E2.m1.3.3.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml">X</mi><mo id="S4.E2.m1.3.3.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.3.cmml">=</mo><mrow id="S4.E2.m1.3.3.1.1.1.1.4" xref="S4.E2.m1.3.3.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.3.3.1.1.1.1.4.2" xref="S4.E2.m1.3.3.1.1.1.1.4.2.cmml">ℱ</mi><mo id="S4.E2.m1.3.3.1.1.1.1.4.1" xref="S4.E2.m1.3.3.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.1.1.1.1.4.3.2" xref="S4.E2.m1.3.3.1.1.1.1.4.cmml"><mo id="S4.E2.m1.3.3.1.1.1.1.4.3.2.1" xref="S4.E2.m1.3.3.1.1.1.1.4.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">S</mi><mo id="S4.E2.m1.3.3.1.1.1.1.4.3.2.2" xref="S4.E2.m1.3.3.1.1.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.3.1.1.1.1.5" xref="S4.E2.m1.3.3.1.1.1.1.5.cmml">∈</mo><msup id="S4.E2.m1.3.3.1.1.1.1.6" xref="S4.E2.m1.3.3.1.1.1.1.6.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.6.2" xref="S4.E2.m1.3.3.1.1.1.1.6.2.cmml">ℂ</mi><mrow id="S4.E2.m1.3.3.1.1.1.1.6.3" xref="S4.E2.m1.3.3.1.1.1.1.6.3.cmml"><msub id="S4.E2.m1.3.3.1.1.1.1.6.3.2" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.6.3.2.2" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.2.cmml">L</mi><mrow id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.2" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.2.cmml">s</mi><mo id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.1" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.1.cmml">⁢</mo><mi id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.3" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.3.cmml">e</mi><mo id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.1a" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.1.cmml">⁢</mo><mi id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.4" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.4.cmml">q</mi></mrow></msub><mo id="S4.E2.m1.3.3.1.1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E2.m1.3.3.1.1.1.1.6.3.1.cmml">×</mo><mi id="S4.E2.m1.3.3.1.1.1.1.6.3.3" xref="S4.E2.m1.3.3.1.1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="S4.E2.m1.3.3.1.1.2.3" xref="S4.E2.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S4.E2.m1.3.3.1.1.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.3.cmml"><mrow id="S4.E2.m1.3.3.1.1.2.2.1.1" xref="S4.E2.m1.3.3.1.1.2.2.1.1.cmml"><mover accent="true" id="S4.E2.m1.3.3.1.1.2.2.1.1.2" xref="S4.E2.m1.3.3.1.1.2.2.1.1.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.1.1.2.2" xref="S4.E2.m1.3.3.1.1.2.2.1.1.2.2.cmml">X</mi><mo id="S4.E2.m1.3.3.1.1.2.2.1.1.2.1" xref="S4.E2.m1.3.3.1.1.2.2.1.1.2.1.cmml">~</mo></mover><mo id="S4.E2.m1.3.3.1.1.2.2.1.1.1" xref="S4.E2.m1.3.3.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E2.m1.3.3.1.1.2.2.1.1.3" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.1.1.3.2" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3.2.cmml">W</mi><mo id="S4.E2.m1.3.3.1.1.2.2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3.1.cmml">⊙</mo><mi id="S4.E2.m1.3.3.1.1.2.2.1.1.3.3" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3.3.cmml">X</mi></mrow></mrow><mo id="S4.E2.m1.3.3.1.1.2.2.2.3" xref="S4.E2.m1.3.3.1.1.2.2.3a.cmml">,</mo><mrow id="S4.E2.m1.3.3.1.1.2.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.cmml"><mover accent="true" id="S4.E2.m1.3.3.1.1.2.2.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.cmml">S</mi><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.2.1" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.1.cmml">~</mo></mover><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.3.cmml">=</mo><mrow id="S4.E2.m1.3.3.1.1.2.2.2.2.4" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.cmml"><msup id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.2.cmml">ℱ</mi><mrow id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.cmml"><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3a" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.cmml">−</mo><mn id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.2.cmml">1</mn></mrow></msup><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.4.1" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.1.1.2.2.2.2.4.3.2" xref="S4.E2.m1.2.2.cmml"><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.4.3.2.1" xref="S4.E2.m1.2.2.cmml">(</mo><mover accent="true" id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><mi id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml">X</mi><mo id="S4.E2.m1.2.2.1" xref="S4.E2.m1.2.2.1.cmml">~</mo></mover><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.4.3.2.2" xref="S4.E2.m1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.5" xref="S4.E2.m1.3.3.1.1.2.2.2.2.5.cmml">∈</mo><msup id="S4.E2.m1.3.3.1.1.2.2.2.2.6" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.6.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.2.cmml">ℝ</mi><mrow id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.cmml"><msub id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.2.cmml">L</mi><mrow id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.2" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.2.cmml">s</mi><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.1" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.1.cmml">⁢</mo><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.3.cmml">e</mi><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.1a" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.1.cmml">⁢</mo><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.4" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.4.cmml">q</mi></mrow></msub><mo id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.1.cmml">×</mo><mi id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.3" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.3.cmml">d</mi></mrow></msup></mrow></mrow></mrow><mo id="S4.E2.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.3a.cmml" xref="S4.E2.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E2.m1.3.3.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1"><and id="S4.E2.m1.3.3.1.1.1.1a.cmml" xref="S4.E2.m1.3.3.1.1.1.1"></and><apply id="S4.E2.m1.3.3.1.1.1.1b.cmml" xref="S4.E2.m1.3.3.1.1.1.1"><eq id="S4.E2.m1.3.3.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.3"></eq><ci id="S4.E2.m1.3.3.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2">𝑋</ci><apply id="S4.E2.m1.3.3.1.1.1.1.4.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4"><times id="S4.E2.m1.3.3.1.1.1.1.4.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4.1"></times><ci id="S4.E2.m1.3.3.1.1.1.1.4.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.4.2">ℱ</ci><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝑆</ci></apply></apply><apply id="S4.E2.m1.3.3.1.1.1.1c.cmml" xref="S4.E2.m1.3.3.1.1.1.1"><in id="S4.E2.m1.3.3.1.1.1.1.5.cmml" xref="S4.E2.m1.3.3.1.1.1.1.5"></in><share href="https://arxiv.org/html/2408.11372v1#S4.E2.m1.3.3.1.1.1.1.4.cmml" id="S4.E2.m1.3.3.1.1.1.1d.cmml" xref="S4.E2.m1.3.3.1.1.1.1"></share><apply id="S4.E2.m1.3.3.1.1.1.1.6.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.6.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6">superscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.6.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.2">ℂ</ci><apply id="S4.E2.m1.3.3.1.1.1.1.6.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3"><times id="S4.E2.m1.3.3.1.1.1.1.6.3.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.1"></times><apply id="S4.E2.m1.3.3.1.1.1.1.6.3.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.6.3.2.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.6.3.2.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.2">𝐿</ci><apply id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3"><times id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.1"></times><ci id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.2">𝑠</ci><ci id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.3">𝑒</ci><ci id="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.4.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.2.3.4">𝑞</ci></apply></apply><ci id="S4.E2.m1.3.3.1.1.1.1.6.3.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.6.3.3">𝑑</ci></apply></apply></apply></apply><apply id="S4.E2.m1.3.3.1.1.2.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.2.3a.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E2.m1.3.3.1.1.2.2.1.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1"><eq id="S4.E2.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.1"></eq><apply id="S4.E2.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.2"><ci id="S4.E2.m1.3.3.1.1.2.2.1.1.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.2.1">~</ci><ci id="S4.E2.m1.3.3.1.1.2.2.1.1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.2.2">𝑋</ci></apply><apply id="S4.E2.m1.3.3.1.1.2.2.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3"><csymbol cd="latexml" id="S4.E2.m1.3.3.1.1.2.2.1.1.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3.1">direct-product</csymbol><ci id="S4.E2.m1.3.3.1.1.2.2.1.1.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3.2">𝑊</ci><ci id="S4.E2.m1.3.3.1.1.2.2.1.1.3.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1.1.3.3">𝑋</ci></apply></apply><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2"><and id="S4.E2.m1.3.3.1.1.2.2.2.2a.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2"></and><apply id="S4.E2.m1.3.3.1.1.2.2.2.2b.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2"><eq id="S4.E2.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.3"></eq><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2"><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.1">~</ci><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.2.2">𝑆</ci></apply><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.4.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4"><times id="S4.E2.m1.3.3.1.1.2.2.2.2.4.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.1"></times><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2">superscript</csymbol><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.2">ℱ</ci><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3"><minus id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3"></minus><cn id="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.2.cmml" type="integer" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.2.3.2">1</cn></apply></apply><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.4.3.2"><ci id="S4.E2.m1.2.2.1.cmml" xref="S4.E2.m1.2.2.1">~</ci><ci id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2">𝑋</ci></apply></apply></apply><apply id="S4.E2.m1.3.3.1.1.2.2.2.2c.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2"><in id="S4.E2.m1.3.3.1.1.2.2.2.2.5.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.5"></in><share href="https://arxiv.org/html/2408.11372v1#S4.E2.m1.3.3.1.1.2.2.2.2.4.cmml" id="S4.E2.m1.3.3.1.1.2.2.2.2d.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2"></share><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.6.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.2.2.2.6.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6">superscript</csymbol><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.6.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.2">ℝ</ci><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3"><times id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.1"></times><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.2">𝐿</ci><apply id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3"><times id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.1"></times><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.2">𝑠</ci><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.3">𝑒</ci><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.4.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.2.3.4">𝑞</ci></apply></apply><ci id="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2.2.6.3.3">𝑑</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">X=\mathcal{F}\left(S\right)\in\mathbb{C}^{L_{seq}\times d},\widetilde{{X}}={W}%
\odot{X},\widetilde{S}=\mathcal{F}^{-1}\left(\widetilde{X}\right)\in\mathbb{R}%
^{L_{seq}\times d},</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.3d">italic_X = caligraphic_F ( italic_S ) ∈ blackboard_C start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT , over~ start_ARG italic_X end_ARG = italic_W ⊙ italic_X , over~ start_ARG italic_S end_ARG = caligraphic_F start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( over~ start_ARG italic_X end_ARG ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_s italic_e italic_q end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p5.6">where <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_S</annotation></semantics></math> represents the user behavior sequence, <math alttext="X" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_X</annotation></semantics></math> represents the frequency domain representation of <math alttext="S" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">italic_S</annotation></semantics></math>, <math alttext="\widetilde{S}" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m4.1"><semantics id="S4.SS2.p5.4.m4.1a"><mover accent="true" id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mi id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml">S</mi><mo id="S4.SS2.p5.4.m4.1.1.1" xref="S4.SS2.p5.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><ci id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1.1">~</ci><ci id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">\widetilde{S}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m4.1d">over~ start_ARG italic_S end_ARG</annotation></semantics></math> represents the denoised sequence features, <math alttext="W" class="ltx_Math" display="inline" id="S4.SS2.p5.5.m5.1"><semantics id="S4.SS2.p5.5.m5.1a"><mi id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.1b"><ci id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.1c">W</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.5.m5.1d">italic_W</annotation></semantics></math> denotes the dot product matrix and <math alttext="\mathbb{C}" class="ltx_Math" display="inline" id="S4.SS2.p5.6.m6.1"><semantics id="S4.SS2.p5.6.m6.1a"><mi id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml">ℂ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><ci id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1">ℂ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">\mathbb{C}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.6.m6.1d">blackboard_C</annotation></semantics></math> denotes the complex space.</p>
</div>
<div class="ltx_para" id="S4.SS2.p6">
<p class="ltx_p" id="S4.SS2.p6.1">However, this approach encounters two significant challenges. First, the dot product operation fails to effectively integrate information across various frequency bands of the model. In the time domain, this inadequacy manifests as an inability to comprehensively capture the user’s interest information across multiple time scales. Second, the number of parameters in the weight matrix <math alttext="W" class="ltx_Math" display="inline" id="S4.SS2.p6.1.m1.1"><semantics id="S4.SS2.p6.1.m1.1a"><mi id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><ci id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.1.m1.1d">italic_W</annotation></semantics></math> increases with the length of the input sequences. As a result, the model struggles to adapt flexibly to changes in input length, making it difficult to maintain efficiency and performance with varying sequence sizes.</p>
</div>
<div class="ltx_para" id="S4.SS2.p7">
<p class="ltx_p" id="S4.SS2.p7.1">To address these challenges, we propose the Efficient Filter Layer (EFL) and make enhancements to two key aspects of the dot-product operation involving the <math alttext="W" class="ltx_Math" display="inline" id="S4.SS2.p7.1.m1.1"><semantics id="S4.SS2.p7.1.m1.1a"><mi id="S4.SS2.p7.1.m1.1.1" xref="S4.SS2.p7.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p7.1.m1.1b"><ci id="S4.SS2.p7.1.m1.1.1.cmml" xref="S4.SS2.p7.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p7.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p7.1.m1.1d">italic_W</annotation></semantics></math> matrix. First, we replace the dot product with matrix multiplication to achieve better fusion of information across different frequency bands. This improves the model’s ability to capture user interest information at multiple time scales. However, this change further increases the number of model parameters. To mitigate this issue, we introduce the Chunked Diagonal Mechanism, which allows model parameters to be shared among different tokens, enabling the model to handle extremely long sequences without a significant increase in parameters. The specific process is as follows:</p>
</div>
<div class="ltx_para" id="S4.SS2.p8">
<p class="ltx_p" id="S4.SS2.p8.3"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p8.3.1">Frequency-Aware Fusion<span class="ltx_text ltx_font_medium" id="S4.SS2.p8.3.1.1">.</span></span> In the EFL, the first improvement involves utilizing matrix multiplication instead of the traditional dot product operation. Specifically, we redefine the weight matrix <math alttext="W" class="ltx_Math" display="inline" id="S4.SS2.p8.1.m1.1"><semantics id="S4.SS2.p8.1.m1.1a"><mi id="S4.SS2.p8.1.m1.1.1" xref="S4.SS2.p8.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.m1.1b"><ci id="S4.SS2.p8.1.m1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.1.m1.1d">italic_W</annotation></semantics></math> to be in <math alttext="\mathbb{C}^{L\times d\times d}" class="ltx_Math" display="inline" id="S4.SS2.p8.2.m2.1"><semantics id="S4.SS2.p8.2.m2.1a"><msup id="S4.SS2.p8.2.m2.1.1" xref="S4.SS2.p8.2.m2.1.1.cmml"><mi id="S4.SS2.p8.2.m2.1.1.2" xref="S4.SS2.p8.2.m2.1.1.2.cmml">ℂ</mi><mrow id="S4.SS2.p8.2.m2.1.1.3" xref="S4.SS2.p8.2.m2.1.1.3.cmml"><mi id="S4.SS2.p8.2.m2.1.1.3.2" xref="S4.SS2.p8.2.m2.1.1.3.2.cmml">L</mi><mo id="S4.SS2.p8.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p8.2.m2.1.1.3.1.cmml">×</mo><mi id="S4.SS2.p8.2.m2.1.1.3.3" xref="S4.SS2.p8.2.m2.1.1.3.3.cmml">d</mi><mo id="S4.SS2.p8.2.m2.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p8.2.m2.1.1.3.1.cmml">×</mo><mi id="S4.SS2.p8.2.m2.1.1.3.4" xref="S4.SS2.p8.2.m2.1.1.3.4.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.2.m2.1b"><apply id="S4.SS2.p8.2.m2.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.2.m2.1.1.1.cmml" xref="S4.SS2.p8.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p8.2.m2.1.1.2.cmml" xref="S4.SS2.p8.2.m2.1.1.2">ℂ</ci><apply id="S4.SS2.p8.2.m2.1.1.3.cmml" xref="S4.SS2.p8.2.m2.1.1.3"><times id="S4.SS2.p8.2.m2.1.1.3.1.cmml" xref="S4.SS2.p8.2.m2.1.1.3.1"></times><ci id="S4.SS2.p8.2.m2.1.1.3.2.cmml" xref="S4.SS2.p8.2.m2.1.1.3.2">𝐿</ci><ci id="S4.SS2.p8.2.m2.1.1.3.3.cmml" xref="S4.SS2.p8.2.m2.1.1.3.3">𝑑</ci><ci id="S4.SS2.p8.2.m2.1.1.3.4.cmml" xref="S4.SS2.p8.2.m2.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.2.m2.1c">\mathbb{C}^{L\times d\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.2.m2.1d">blackboard_C start_POSTSUPERSCRIPT italic_L × italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> rather than <math alttext="\mathbb{C}^{L\times d}" class="ltx_Math" display="inline" id="S4.SS2.p8.3.m3.1"><semantics id="S4.SS2.p8.3.m3.1a"><msup id="S4.SS2.p8.3.m3.1.1" xref="S4.SS2.p8.3.m3.1.1.cmml"><mi id="S4.SS2.p8.3.m3.1.1.2" xref="S4.SS2.p8.3.m3.1.1.2.cmml">ℂ</mi><mrow id="S4.SS2.p8.3.m3.1.1.3" xref="S4.SS2.p8.3.m3.1.1.3.cmml"><mi id="S4.SS2.p8.3.m3.1.1.3.2" xref="S4.SS2.p8.3.m3.1.1.3.2.cmml">L</mi><mo id="S4.SS2.p8.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p8.3.m3.1.1.3.1.cmml">×</mo><mi id="S4.SS2.p8.3.m3.1.1.3.3" xref="S4.SS2.p8.3.m3.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.3.m3.1b"><apply id="S4.SS2.p8.3.m3.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p8.3.m3.1.1.1.cmml" xref="S4.SS2.p8.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p8.3.m3.1.1.2.cmml" xref="S4.SS2.p8.3.m3.1.1.2">ℂ</ci><apply id="S4.SS2.p8.3.m3.1.1.3.cmml" xref="S4.SS2.p8.3.m3.1.1.3"><times id="S4.SS2.p8.3.m3.1.1.3.1.cmml" xref="S4.SS2.p8.3.m3.1.1.3.1"></times><ci id="S4.SS2.p8.3.m3.1.1.3.2.cmml" xref="S4.SS2.p8.3.m3.1.1.3.2">𝐿</ci><ci id="S4.SS2.p8.3.m3.1.1.3.3.cmml" xref="S4.SS2.p8.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.3.m3.1c">\mathbb{C}^{L\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.3.m3.1d">blackboard_C start_POSTSUPERSCRIPT italic_L × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. This modification enables the effective fusion of user behavioral information across different frequency bands. By capturing user interests at multiple time scales, both long-term and short-term, the EFL facilitates a more comprehensive and efficient mining of user behavior patterns. However, while this method significantly improves frequency domain fusion, it also further increases the number of model parameters. To address this, we further introduce the Chunked Diagonal Mechanism.</p>
</div>
<div class="ltx_para" id="S4.SS2.p9">
<p class="ltx_p" id="S4.SS2.p9.13"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p9.13.1">Chunked Diagonal Mechanism.</span> To address the issue of increasing matrix parameters as user sequences grow, the Efficient Filter Layer (EFL) introduces a Chunked Diagonal Mechanism for complex weight matrices. This mechanism is designed to effectively manage parameter growth while maintaining the ability to fully mine sequences and adapt to different sequence lengths.
The weight matrix <math alttext="W\in\mathbb{C}^{L\times d\times d}" class="ltx_Math" display="inline" id="S4.SS2.p9.1.m1.1"><semantics id="S4.SS2.p9.1.m1.1a"><mrow id="S4.SS2.p9.1.m1.1.1" xref="S4.SS2.p9.1.m1.1.1.cmml"><mi id="S4.SS2.p9.1.m1.1.1.2" xref="S4.SS2.p9.1.m1.1.1.2.cmml">W</mi><mo id="S4.SS2.p9.1.m1.1.1.1" xref="S4.SS2.p9.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.p9.1.m1.1.1.3" xref="S4.SS2.p9.1.m1.1.1.3.cmml"><mi id="S4.SS2.p9.1.m1.1.1.3.2" xref="S4.SS2.p9.1.m1.1.1.3.2.cmml">ℂ</mi><mrow id="S4.SS2.p9.1.m1.1.1.3.3" xref="S4.SS2.p9.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.p9.1.m1.1.1.3.3.2" xref="S4.SS2.p9.1.m1.1.1.3.3.2.cmml">L</mi><mo id="S4.SS2.p9.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p9.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p9.1.m1.1.1.3.3.3" xref="S4.SS2.p9.1.m1.1.1.3.3.3.cmml">d</mi><mo id="S4.SS2.p9.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p9.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p9.1.m1.1.1.3.3.4" xref="S4.SS2.p9.1.m1.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.1.m1.1b"><apply id="S4.SS2.p9.1.m1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1"><in id="S4.SS2.p9.1.m1.1.1.1.cmml" xref="S4.SS2.p9.1.m1.1.1.1"></in><ci id="S4.SS2.p9.1.m1.1.1.2.cmml" xref="S4.SS2.p9.1.m1.1.1.2">𝑊</ci><apply id="S4.SS2.p9.1.m1.1.1.3.cmml" xref="S4.SS2.p9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p9.1.m1.1.1.3.1.cmml" xref="S4.SS2.p9.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p9.1.m1.1.1.3.2.cmml" xref="S4.SS2.p9.1.m1.1.1.3.2">ℂ</ci><apply id="S4.SS2.p9.1.m1.1.1.3.3.cmml" xref="S4.SS2.p9.1.m1.1.1.3.3"><times id="S4.SS2.p9.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p9.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.p9.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p9.1.m1.1.1.3.3.2">𝐿</ci><ci id="S4.SS2.p9.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p9.1.m1.1.1.3.3.3">𝑑</ci><ci id="S4.SS2.p9.1.m1.1.1.3.3.4.cmml" xref="S4.SS2.p9.1.m1.1.1.3.3.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.1.m1.1c">W\in\mathbb{C}^{L\times d\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.1.m1.1d">italic_W ∈ blackboard_C start_POSTSUPERSCRIPT italic_L × italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is decomposed into <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p9.2.m2.1"><semantics id="S4.SS2.p9.2.m2.1a"><mi id="S4.SS2.p9.2.m2.1.1" xref="S4.SS2.p9.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.2.m2.1b"><ci id="S4.SS2.p9.2.m2.1.1.cmml" xref="S4.SS2.p9.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.2.m2.1d">italic_k</annotation></semantics></math> shared weight matrices <math alttext="W^{n}\in\mathbb{C}^{d/k\times d/k}" class="ltx_Math" display="inline" id="S4.SS2.p9.3.m3.1"><semantics id="S4.SS2.p9.3.m3.1a"><mrow id="S4.SS2.p9.3.m3.1.1" xref="S4.SS2.p9.3.m3.1.1.cmml"><msup id="S4.SS2.p9.3.m3.1.1.2" xref="S4.SS2.p9.3.m3.1.1.2.cmml"><mi id="S4.SS2.p9.3.m3.1.1.2.2" xref="S4.SS2.p9.3.m3.1.1.2.2.cmml">W</mi><mi id="S4.SS2.p9.3.m3.1.1.2.3" xref="S4.SS2.p9.3.m3.1.1.2.3.cmml">n</mi></msup><mo id="S4.SS2.p9.3.m3.1.1.1" xref="S4.SS2.p9.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.p9.3.m3.1.1.3" xref="S4.SS2.p9.3.m3.1.1.3.cmml"><mi id="S4.SS2.p9.3.m3.1.1.3.2" xref="S4.SS2.p9.3.m3.1.1.3.2.cmml">ℂ</mi><mrow id="S4.SS2.p9.3.m3.1.1.3.3" xref="S4.SS2.p9.3.m3.1.1.3.3.cmml"><mrow id="S4.SS2.p9.3.m3.1.1.3.3.2" xref="S4.SS2.p9.3.m3.1.1.3.3.2.cmml"><mrow id="S4.SS2.p9.3.m3.1.1.3.3.2.2" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2.cmml"><mi id="S4.SS2.p9.3.m3.1.1.3.3.2.2.2" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2.2.cmml">d</mi><mo id="S4.SS2.p9.3.m3.1.1.3.3.2.2.1" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2.1.cmml">/</mo><mi id="S4.SS2.p9.3.m3.1.1.3.3.2.2.3" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2.3.cmml">k</mi></mrow><mo id="S4.SS2.p9.3.m3.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p9.3.m3.1.1.3.3.2.1.cmml">×</mo><mi id="S4.SS2.p9.3.m3.1.1.3.3.2.3" xref="S4.SS2.p9.3.m3.1.1.3.3.2.3.cmml">d</mi></mrow><mo id="S4.SS2.p9.3.m3.1.1.3.3.1" xref="S4.SS2.p9.3.m3.1.1.3.3.1.cmml">/</mo><mi id="S4.SS2.p9.3.m3.1.1.3.3.3" xref="S4.SS2.p9.3.m3.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.3.m3.1b"><apply id="S4.SS2.p9.3.m3.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1"><in id="S4.SS2.p9.3.m3.1.1.1.cmml" xref="S4.SS2.p9.3.m3.1.1.1"></in><apply id="S4.SS2.p9.3.m3.1.1.2.cmml" xref="S4.SS2.p9.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.3.m3.1.1.2.1.cmml" xref="S4.SS2.p9.3.m3.1.1.2">superscript</csymbol><ci id="S4.SS2.p9.3.m3.1.1.2.2.cmml" xref="S4.SS2.p9.3.m3.1.1.2.2">𝑊</ci><ci id="S4.SS2.p9.3.m3.1.1.2.3.cmml" xref="S4.SS2.p9.3.m3.1.1.2.3">𝑛</ci></apply><apply id="S4.SS2.p9.3.m3.1.1.3.cmml" xref="S4.SS2.p9.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p9.3.m3.1.1.3.1.cmml" xref="S4.SS2.p9.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p9.3.m3.1.1.3.2.cmml" xref="S4.SS2.p9.3.m3.1.1.3.2">ℂ</ci><apply id="S4.SS2.p9.3.m3.1.1.3.3.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3"><divide id="S4.SS2.p9.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.1"></divide><apply id="S4.SS2.p9.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.2"><times id="S4.SS2.p9.3.m3.1.1.3.3.2.1.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.2.1"></times><apply id="S4.SS2.p9.3.m3.1.1.3.3.2.2.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2"><divide id="S4.SS2.p9.3.m3.1.1.3.3.2.2.1.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2.1"></divide><ci id="S4.SS2.p9.3.m3.1.1.3.3.2.2.2.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2.2">𝑑</ci><ci id="S4.SS2.p9.3.m3.1.1.3.3.2.2.3.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.2.2.3">𝑘</ci></apply><ci id="S4.SS2.p9.3.m3.1.1.3.3.2.3.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.2.3">𝑑</ci></apply><ci id="S4.SS2.p9.3.m3.1.1.3.3.3.cmml" xref="S4.SS2.p9.3.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.3.m3.1c">W^{n}\in\mathbb{C}^{d/k\times d/k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.3.m3.1d">italic_W start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∈ blackboard_C start_POSTSUPERSCRIPT italic_d / italic_k × italic_d / italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> (<math alttext="n=1,\ldots,k" class="ltx_Math" display="inline" id="S4.SS2.p9.4.m4.3"><semantics id="S4.SS2.p9.4.m4.3a"><mrow id="S4.SS2.p9.4.m4.3.4" xref="S4.SS2.p9.4.m4.3.4.cmml"><mi id="S4.SS2.p9.4.m4.3.4.2" xref="S4.SS2.p9.4.m4.3.4.2.cmml">n</mi><mo id="S4.SS2.p9.4.m4.3.4.1" xref="S4.SS2.p9.4.m4.3.4.1.cmml">=</mo><mrow id="S4.SS2.p9.4.m4.3.4.3.2" xref="S4.SS2.p9.4.m4.3.4.3.1.cmml"><mn id="S4.SS2.p9.4.m4.1.1" xref="S4.SS2.p9.4.m4.1.1.cmml">1</mn><mo id="S4.SS2.p9.4.m4.3.4.3.2.1" xref="S4.SS2.p9.4.m4.3.4.3.1.cmml">,</mo><mi id="S4.SS2.p9.4.m4.2.2" mathvariant="normal" xref="S4.SS2.p9.4.m4.2.2.cmml">…</mi><mo id="S4.SS2.p9.4.m4.3.4.3.2.2" xref="S4.SS2.p9.4.m4.3.4.3.1.cmml">,</mo><mi id="S4.SS2.p9.4.m4.3.3" xref="S4.SS2.p9.4.m4.3.3.cmml">k</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.4.m4.3b"><apply id="S4.SS2.p9.4.m4.3.4.cmml" xref="S4.SS2.p9.4.m4.3.4"><eq id="S4.SS2.p9.4.m4.3.4.1.cmml" xref="S4.SS2.p9.4.m4.3.4.1"></eq><ci id="S4.SS2.p9.4.m4.3.4.2.cmml" xref="S4.SS2.p9.4.m4.3.4.2">𝑛</ci><list id="S4.SS2.p9.4.m4.3.4.3.1.cmml" xref="S4.SS2.p9.4.m4.3.4.3.2"><cn id="S4.SS2.p9.4.m4.1.1.cmml" type="integer" xref="S4.SS2.p9.4.m4.1.1">1</cn><ci id="S4.SS2.p9.4.m4.2.2.cmml" xref="S4.SS2.p9.4.m4.2.2">…</ci><ci id="S4.SS2.p9.4.m4.3.3.cmml" xref="S4.SS2.p9.4.m4.3.3">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.4.m4.3c">n=1,\ldots,k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.4.m4.3d">italic_n = 1 , … , italic_k</annotation></semantics></math>), each with reduced dimensions. This decomposition into <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p9.5.m5.1"><semantics id="S4.SS2.p9.5.m5.1a"><mi id="S4.SS2.p9.5.m5.1.1" xref="S4.SS2.p9.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.5.m5.1b"><ci id="S4.SS2.p9.5.m5.1.1.cmml" xref="S4.SS2.p9.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.5.m5.1d">italic_k</annotation></semantics></math> smaller diagonal weight matrices, denoted as <math alttext="W^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.6.m6.1"><semantics id="S4.SS2.p9.6.m6.1a"><msup id="S4.SS2.p9.6.m6.1.1" xref="S4.SS2.p9.6.m6.1.1.cmml"><mi id="S4.SS2.p9.6.m6.1.1.2" xref="S4.SS2.p9.6.m6.1.1.2.cmml">W</mi><mi id="S4.SS2.p9.6.m6.1.1.3" xref="S4.SS2.p9.6.m6.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.6.m6.1b"><apply id="S4.SS2.p9.6.m6.1.1.cmml" xref="S4.SS2.p9.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.6.m6.1.1.1.cmml" xref="S4.SS2.p9.6.m6.1.1">superscript</csymbol><ci id="S4.SS2.p9.6.m6.1.1.2.cmml" xref="S4.SS2.p9.6.m6.1.1.2">𝑊</ci><ci id="S4.SS2.p9.6.m6.1.1.3.cmml" xref="S4.SS2.p9.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.6.m6.1c">W^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.6.m6.1d">italic_W start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, is somewhat interpretable, similar to <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p9.7.m7.1"><semantics id="S4.SS2.p9.7.m7.1a"><mi id="S4.SS2.p9.7.m7.1.1" xref="S4.SS2.p9.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.7.m7.1b"><ci id="S4.SS2.p9.7.m7.1.1.cmml" xref="S4.SS2.p9.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.7.m7.1d">italic_k</annotation></semantics></math>-head attention, while enabling computational parallelization. So we get <math alttext="\tilde{x}_{i}^{n}=W^{n}x_{i}^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.8.m8.1"><semantics id="S4.SS2.p9.8.m8.1a"><mrow id="S4.SS2.p9.8.m8.1.1" xref="S4.SS2.p9.8.m8.1.1.cmml"><msubsup id="S4.SS2.p9.8.m8.1.1.2" xref="S4.SS2.p9.8.m8.1.1.2.cmml"><mover accent="true" id="S4.SS2.p9.8.m8.1.1.2.2.2" xref="S4.SS2.p9.8.m8.1.1.2.2.2.cmml"><mi id="S4.SS2.p9.8.m8.1.1.2.2.2.2" xref="S4.SS2.p9.8.m8.1.1.2.2.2.2.cmml">x</mi><mo id="S4.SS2.p9.8.m8.1.1.2.2.2.1" xref="S4.SS2.p9.8.m8.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S4.SS2.p9.8.m8.1.1.2.2.3" xref="S4.SS2.p9.8.m8.1.1.2.2.3.cmml">i</mi><mi id="S4.SS2.p9.8.m8.1.1.2.3" xref="S4.SS2.p9.8.m8.1.1.2.3.cmml">n</mi></msubsup><mo id="S4.SS2.p9.8.m8.1.1.1" xref="S4.SS2.p9.8.m8.1.1.1.cmml">=</mo><mrow id="S4.SS2.p9.8.m8.1.1.3" xref="S4.SS2.p9.8.m8.1.1.3.cmml"><msup id="S4.SS2.p9.8.m8.1.1.3.2" xref="S4.SS2.p9.8.m8.1.1.3.2.cmml"><mi id="S4.SS2.p9.8.m8.1.1.3.2.2" xref="S4.SS2.p9.8.m8.1.1.3.2.2.cmml">W</mi><mi id="S4.SS2.p9.8.m8.1.1.3.2.3" xref="S4.SS2.p9.8.m8.1.1.3.2.3.cmml">n</mi></msup><mo id="S4.SS2.p9.8.m8.1.1.3.1" xref="S4.SS2.p9.8.m8.1.1.3.1.cmml">⁢</mo><msubsup id="S4.SS2.p9.8.m8.1.1.3.3" xref="S4.SS2.p9.8.m8.1.1.3.3.cmml"><mi id="S4.SS2.p9.8.m8.1.1.3.3.2.2" xref="S4.SS2.p9.8.m8.1.1.3.3.2.2.cmml">x</mi><mi id="S4.SS2.p9.8.m8.1.1.3.3.2.3" xref="S4.SS2.p9.8.m8.1.1.3.3.2.3.cmml">i</mi><mi id="S4.SS2.p9.8.m8.1.1.3.3.3" xref="S4.SS2.p9.8.m8.1.1.3.3.3.cmml">n</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.8.m8.1b"><apply id="S4.SS2.p9.8.m8.1.1.cmml" xref="S4.SS2.p9.8.m8.1.1"><eq id="S4.SS2.p9.8.m8.1.1.1.cmml" xref="S4.SS2.p9.8.m8.1.1.1"></eq><apply id="S4.SS2.p9.8.m8.1.1.2.cmml" xref="S4.SS2.p9.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.8.m8.1.1.2.1.cmml" xref="S4.SS2.p9.8.m8.1.1.2">superscript</csymbol><apply id="S4.SS2.p9.8.m8.1.1.2.2.cmml" xref="S4.SS2.p9.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p9.8.m8.1.1.2.2.1.cmml" xref="S4.SS2.p9.8.m8.1.1.2">subscript</csymbol><apply id="S4.SS2.p9.8.m8.1.1.2.2.2.cmml" xref="S4.SS2.p9.8.m8.1.1.2.2.2"><ci id="S4.SS2.p9.8.m8.1.1.2.2.2.1.cmml" xref="S4.SS2.p9.8.m8.1.1.2.2.2.1">~</ci><ci id="S4.SS2.p9.8.m8.1.1.2.2.2.2.cmml" xref="S4.SS2.p9.8.m8.1.1.2.2.2.2">𝑥</ci></apply><ci id="S4.SS2.p9.8.m8.1.1.2.2.3.cmml" xref="S4.SS2.p9.8.m8.1.1.2.2.3">𝑖</ci></apply><ci id="S4.SS2.p9.8.m8.1.1.2.3.cmml" xref="S4.SS2.p9.8.m8.1.1.2.3">𝑛</ci></apply><apply id="S4.SS2.p9.8.m8.1.1.3.cmml" xref="S4.SS2.p9.8.m8.1.1.3"><times id="S4.SS2.p9.8.m8.1.1.3.1.cmml" xref="S4.SS2.p9.8.m8.1.1.3.1"></times><apply id="S4.SS2.p9.8.m8.1.1.3.2.cmml" xref="S4.SS2.p9.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p9.8.m8.1.1.3.2.1.cmml" xref="S4.SS2.p9.8.m8.1.1.3.2">superscript</csymbol><ci id="S4.SS2.p9.8.m8.1.1.3.2.2.cmml" xref="S4.SS2.p9.8.m8.1.1.3.2.2">𝑊</ci><ci id="S4.SS2.p9.8.m8.1.1.3.2.3.cmml" xref="S4.SS2.p9.8.m8.1.1.3.2.3">𝑛</ci></apply><apply id="S4.SS2.p9.8.m8.1.1.3.3.cmml" xref="S4.SS2.p9.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p9.8.m8.1.1.3.3.1.cmml" xref="S4.SS2.p9.8.m8.1.1.3.3">superscript</csymbol><apply id="S4.SS2.p9.8.m8.1.1.3.3.2.cmml" xref="S4.SS2.p9.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p9.8.m8.1.1.3.3.2.1.cmml" xref="S4.SS2.p9.8.m8.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p9.8.m8.1.1.3.3.2.2.cmml" xref="S4.SS2.p9.8.m8.1.1.3.3.2.2">𝑥</ci><ci id="S4.SS2.p9.8.m8.1.1.3.3.2.3.cmml" xref="S4.SS2.p9.8.m8.1.1.3.3.2.3">𝑖</ci></apply><ci id="S4.SS2.p9.8.m8.1.1.3.3.3.cmml" xref="S4.SS2.p9.8.m8.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.8.m8.1c">\tilde{x}_{i}^{n}=W^{n}x_{i}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.8.m8.1d">over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT = italic_W start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="{x}_{i}^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.9.m9.1"><semantics id="S4.SS2.p9.9.m9.1a"><msubsup id="S4.SS2.p9.9.m9.1.1" xref="S4.SS2.p9.9.m9.1.1.cmml"><mi id="S4.SS2.p9.9.m9.1.1.2.2" xref="S4.SS2.p9.9.m9.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p9.9.m9.1.1.2.3" xref="S4.SS2.p9.9.m9.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p9.9.m9.1.1.3" xref="S4.SS2.p9.9.m9.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.9.m9.1b"><apply id="S4.SS2.p9.9.m9.1.1.cmml" xref="S4.SS2.p9.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.9.m9.1.1.1.cmml" xref="S4.SS2.p9.9.m9.1.1">superscript</csymbol><apply id="S4.SS2.p9.9.m9.1.1.2.cmml" xref="S4.SS2.p9.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.9.m9.1.1.2.1.cmml" xref="S4.SS2.p9.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.p9.9.m9.1.1.2.2.cmml" xref="S4.SS2.p9.9.m9.1.1.2.2">𝑥</ci><ci id="S4.SS2.p9.9.m9.1.1.2.3.cmml" xref="S4.SS2.p9.9.m9.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p9.9.m9.1.1.3.cmml" xref="S4.SS2.p9.9.m9.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.9.m9.1c">{x}_{i}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.9.m9.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> represents the <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.p9.10.m10.1"><semantics id="S4.SS2.p9.10.m10.1a"><mi id="S4.SS2.p9.10.m10.1.1" xref="S4.SS2.p9.10.m10.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.10.m10.1b"><ci id="S4.SS2.p9.10.m10.1.1.cmml" xref="S4.SS2.p9.10.m10.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.10.m10.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.10.m10.1d">italic_n</annotation></semantics></math>-th block of the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS2.p9.11.m11.1"><semantics id="S4.SS2.p9.11.m11.1a"><mi id="S4.SS2.p9.11.m11.1.1" xref="S4.SS2.p9.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.11.m11.1b"><ci id="S4.SS2.p9.11.m11.1.1.cmml" xref="S4.SS2.p9.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.11.m11.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.11.m11.1d">italic_i</annotation></semantics></math>-th frequency token (<math alttext="i\in[1,L//(d/k)]" class="ltx_math_unparsed" display="inline" id="S4.SS2.p9.12.m12.2"><semantics id="S4.SS2.p9.12.m12.2a"><mrow id="S4.SS2.p9.12.m12.2b"><mi id="S4.SS2.p9.12.m12.2.3">i</mi><mo id="S4.SS2.p9.12.m12.2.4">∈</mo><mrow id="S4.SS2.p9.12.m12.2.5"><mo id="S4.SS2.p9.12.m12.2.5.1" stretchy="false">[</mo><mn id="S4.SS2.p9.12.m12.1.1">1</mn><mo id="S4.SS2.p9.12.m12.2.5.2">,</mo><mi id="S4.SS2.p9.12.m12.2.2">L</mi><mo id="S4.SS2.p9.12.m12.2.5.3" rspace="0em">/</mo><mo id="S4.SS2.p9.12.m12.2.5.4" lspace="0em">/</mo><mrow id="S4.SS2.p9.12.m12.2.5.5"><mo id="S4.SS2.p9.12.m12.2.5.5.1" stretchy="false">(</mo><mi id="S4.SS2.p9.12.m12.2.5.5.2">d</mi><mo id="S4.SS2.p9.12.m12.2.5.5.3">/</mo><mi id="S4.SS2.p9.12.m12.2.5.5.4">k</mi><mo id="S4.SS2.p9.12.m12.2.5.5.5" stretchy="false">)</mo></mrow><mo id="S4.SS2.p9.12.m12.2.5.6" stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p9.12.m12.2c">i\in[1,L//(d/k)]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.12.m12.2d">italic_i ∈ [ 1 , italic_L / / ( italic_d / italic_k ) ]</annotation></semantics></math>). Specifically, we employ a double-layer MLP structure as <math alttext="W^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.13.m13.1"><semantics id="S4.SS2.p9.13.m13.1a"><msup id="S4.SS2.p9.13.m13.1.1" xref="S4.SS2.p9.13.m13.1.1.cmml"><mi id="S4.SS2.p9.13.m13.1.1.2" xref="S4.SS2.p9.13.m13.1.1.2.cmml">W</mi><mi id="S4.SS2.p9.13.m13.1.1.3" xref="S4.SS2.p9.13.m13.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.13.m13.1b"><apply id="S4.SS2.p9.13.m13.1.1.cmml" xref="S4.SS2.p9.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.13.m13.1.1.1.cmml" xref="S4.SS2.p9.13.m13.1.1">superscript</csymbol><ci id="S4.SS2.p9.13.m13.1.1.2.cmml" xref="S4.SS2.p9.13.m13.1.1.2">𝑊</ci><ci id="S4.SS2.p9.13.m13.1.1.3.cmml" xref="S4.SS2.p9.13.m13.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.13.m13.1c">W^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.13.m13.1d">italic_W start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>. The formula is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{x}_{i}^{n}=\operatorname{MLP}\left(x_{i}^{n}\right)=W_{2}^{n}\sigma%
\left(W_{1}^{n}x_{i}^{n}+b_{1}^{n}\right)+b_{2}^{n}," class="ltx_Math" display="block" id="S4.E3.m1.2"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2.1" xref="S4.E3.m1.2.2.1.1.cmml"><mrow id="S4.E3.m1.2.2.1.1" xref="S4.E3.m1.2.2.1.1.cmml"><msubsup id="S4.E3.m1.2.2.1.1.4" xref="S4.E3.m1.2.2.1.1.4.cmml"><mover accent="true" id="S4.E3.m1.2.2.1.1.4.2.2" xref="S4.E3.m1.2.2.1.1.4.2.2.cmml"><mi id="S4.E3.m1.2.2.1.1.4.2.2.2" xref="S4.E3.m1.2.2.1.1.4.2.2.2.cmml">x</mi><mo id="S4.E3.m1.2.2.1.1.4.2.2.1" xref="S4.E3.m1.2.2.1.1.4.2.2.1.cmml">~</mo></mover><mi id="S4.E3.m1.2.2.1.1.4.2.3" xref="S4.E3.m1.2.2.1.1.4.2.3.cmml">i</mi><mi id="S4.E3.m1.2.2.1.1.4.3" xref="S4.E3.m1.2.2.1.1.4.3.cmml">n</mi></msubsup><mo id="S4.E3.m1.2.2.1.1.5" xref="S4.E3.m1.2.2.1.1.5.cmml">=</mo><mrow id="S4.E3.m1.2.2.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">MLP</mi><mo id="S4.E3.m1.2.2.1.1.1.1a" xref="S4.E3.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.2.cmml"><mo id="S4.E3.m1.2.2.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.2.cmml">(</mo><msubsup id="S4.E3.m1.2.2.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E3.m1.2.2.1.1.1.1.1.1.2.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E3.m1.2.2.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S4.E3.m1.2.2.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.6" xref="S4.E3.m1.2.2.1.1.6.cmml">=</mo><mrow id="S4.E3.m1.2.2.1.1.2" xref="S4.E3.m1.2.2.1.1.2.cmml"><mrow id="S4.E3.m1.2.2.1.1.2.1" xref="S4.E3.m1.2.2.1.1.2.1.cmml"><msubsup id="S4.E3.m1.2.2.1.1.2.1.3" xref="S4.E3.m1.2.2.1.1.2.1.3.cmml"><mi id="S4.E3.m1.2.2.1.1.2.1.3.2.2" xref="S4.E3.m1.2.2.1.1.2.1.3.2.2.cmml">W</mi><mn id="S4.E3.m1.2.2.1.1.2.1.3.2.3" xref="S4.E3.m1.2.2.1.1.2.1.3.2.3.cmml">2</mn><mi id="S4.E3.m1.2.2.1.1.2.1.3.3" xref="S4.E3.m1.2.2.1.1.2.1.3.3.cmml">n</mi></msubsup><mo id="S4.E3.m1.2.2.1.1.2.1.2" xref="S4.E3.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mi id="S4.E3.m1.2.2.1.1.2.1.4" xref="S4.E3.m1.2.2.1.1.2.1.4.cmml">σ</mi><mo id="S4.E3.m1.2.2.1.1.2.1.2a" xref="S4.E3.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.2.2.1.1.2.1.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.cmml"><mo id="S4.E3.m1.2.2.1.1.2.1.1.1.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.2.2.1.1.2.1.1.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.cmml"><mrow id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.cmml"><msubsup id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.cmml"><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.2.cmml">W</mi><mn id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.3.cmml">1</mn><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.3.cmml">n</mi></msubsup><mo id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.cmml"><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.2.cmml">x</mi><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.3.cmml">i</mi><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.3.cmml">n</mi></msubsup></mrow><mo id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.cmml">+</mo><msubsup id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.2" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.2.cmml">b</mi><mn id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.3.cmml">1</mn><mi id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">n</mi></msubsup></mrow><mo id="S4.E3.m1.2.2.1.1.2.1.1.1.3" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.2.2" xref="S4.E3.m1.2.2.1.1.2.2.cmml">+</mo><msubsup id="S4.E3.m1.2.2.1.1.2.3" xref="S4.E3.m1.2.2.1.1.2.3.cmml"><mi id="S4.E3.m1.2.2.1.1.2.3.2.2" xref="S4.E3.m1.2.2.1.1.2.3.2.2.cmml">b</mi><mn id="S4.E3.m1.2.2.1.1.2.3.2.3" xref="S4.E3.m1.2.2.1.1.2.3.2.3.cmml">2</mn><mi id="S4.E3.m1.2.2.1.1.2.3.3" xref="S4.E3.m1.2.2.1.1.2.3.3.cmml">n</mi></msubsup></mrow></mrow><mo id="S4.E3.m1.2.2.1.2" xref="S4.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.1.1.cmml" xref="S4.E3.m1.2.2.1"><and id="S4.E3.m1.2.2.1.1a.cmml" xref="S4.E3.m1.2.2.1"></and><apply id="S4.E3.m1.2.2.1.1b.cmml" xref="S4.E3.m1.2.2.1"><eq id="S4.E3.m1.2.2.1.1.5.cmml" xref="S4.E3.m1.2.2.1.1.5"></eq><apply id="S4.E3.m1.2.2.1.1.4.cmml" xref="S4.E3.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.4.1.cmml" xref="S4.E3.m1.2.2.1.1.4">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.4.2.cmml" xref="S4.E3.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.4.2.1.cmml" xref="S4.E3.m1.2.2.1.1.4">subscript</csymbol><apply id="S4.E3.m1.2.2.1.1.4.2.2.cmml" xref="S4.E3.m1.2.2.1.1.4.2.2"><ci id="S4.E3.m1.2.2.1.1.4.2.2.1.cmml" xref="S4.E3.m1.2.2.1.1.4.2.2.1">~</ci><ci id="S4.E3.m1.2.2.1.1.4.2.2.2.cmml" xref="S4.E3.m1.2.2.1.1.4.2.2.2">𝑥</ci></apply><ci id="S4.E3.m1.2.2.1.1.4.2.3.cmml" xref="S4.E3.m1.2.2.1.1.4.2.3">𝑖</ci></apply><ci id="S4.E3.m1.2.2.1.1.4.3.cmml" xref="S4.E3.m1.2.2.1.1.4.3">𝑛</ci></apply><apply id="S4.E3.m1.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1"><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">MLP</ci><apply id="S4.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S4.E3.m1.2.2.1.1c.cmml" xref="S4.E3.m1.2.2.1"><eq id="S4.E3.m1.2.2.1.1.6.cmml" xref="S4.E3.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2408.11372v1#S4.E3.m1.2.2.1.1.1.cmml" id="S4.E3.m1.2.2.1.1d.cmml" xref="S4.E3.m1.2.2.1"></share><apply id="S4.E3.m1.2.2.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2"><plus id="S4.E3.m1.2.2.1.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2"></plus><apply id="S4.E3.m1.2.2.1.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1"><times id="S4.E3.m1.2.2.1.1.2.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.2"></times><apply id="S4.E3.m1.2.2.1.1.2.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.3">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.2.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.3.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.1.3.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.3.2.2">𝑊</ci><cn id="S4.E3.m1.2.2.1.1.2.1.3.2.3.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.2.1.3.2.3">2</cn></apply><ci id="S4.E3.m1.2.2.1.1.2.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.3.3">𝑛</ci></apply><ci id="S4.E3.m1.2.2.1.1.2.1.4.cmml" xref="S4.E3.m1.2.2.1.1.2.1.4">𝜎</ci><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1"><plus id="S4.E3.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.1"></plus><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2"><times id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.1"></times><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.2">𝑊</ci><cn id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.2.3">1</cn></apply><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.2.3">𝑛</ci></apply><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.2">𝑥</ci><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.2.3.3">𝑛</ci></apply></apply><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.2">𝑏</ci><cn id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.2.3">1</cn></apply><ci id="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.2.1.1.1.1.3.3">𝑛</ci></apply></apply></apply><apply id="S4.E3.m1.2.2.1.1.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.3">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.2.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.3.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.3.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.3.2.2">𝑏</ci><cn id="S4.E3.m1.2.2.1.1.2.3.2.3.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.2.3.2.3">2</cn></apply><ci id="S4.E3.m1.2.2.1.1.2.3.3.cmml" xref="S4.E3.m1.2.2.1.1.2.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\tilde{x}_{i}^{n}=\operatorname{MLP}\left(x_{i}^{n}\right)=W_{2}^{n}\sigma%
\left(W_{1}^{n}x_{i}^{n}+b_{1}^{n}\right)+b_{2}^{n},</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.2d">over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT = roman_MLP ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ) = italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_σ ( italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT + italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ) + italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p9.18">where <math alttext="W_{1}^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.14.m1.1"><semantics id="S4.SS2.p9.14.m1.1a"><msubsup id="S4.SS2.p9.14.m1.1.1" xref="S4.SS2.p9.14.m1.1.1.cmml"><mi id="S4.SS2.p9.14.m1.1.1.2.2" xref="S4.SS2.p9.14.m1.1.1.2.2.cmml">W</mi><mn id="S4.SS2.p9.14.m1.1.1.2.3" xref="S4.SS2.p9.14.m1.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p9.14.m1.1.1.3" xref="S4.SS2.p9.14.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.14.m1.1b"><apply id="S4.SS2.p9.14.m1.1.1.cmml" xref="S4.SS2.p9.14.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.14.m1.1.1.1.cmml" xref="S4.SS2.p9.14.m1.1.1">superscript</csymbol><apply id="S4.SS2.p9.14.m1.1.1.2.cmml" xref="S4.SS2.p9.14.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.14.m1.1.1.2.1.cmml" xref="S4.SS2.p9.14.m1.1.1">subscript</csymbol><ci id="S4.SS2.p9.14.m1.1.1.2.2.cmml" xref="S4.SS2.p9.14.m1.1.1.2.2">𝑊</ci><cn id="S4.SS2.p9.14.m1.1.1.2.3.cmml" type="integer" xref="S4.SS2.p9.14.m1.1.1.2.3">1</cn></apply><ci id="S4.SS2.p9.14.m1.1.1.3.cmml" xref="S4.SS2.p9.14.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.14.m1.1c">W_{1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.14.m1.1d">italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{2}^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.15.m2.1"><semantics id="S4.SS2.p9.15.m2.1a"><msubsup id="S4.SS2.p9.15.m2.1.1" xref="S4.SS2.p9.15.m2.1.1.cmml"><mi id="S4.SS2.p9.15.m2.1.1.2.2" xref="S4.SS2.p9.15.m2.1.1.2.2.cmml">W</mi><mn id="S4.SS2.p9.15.m2.1.1.2.3" xref="S4.SS2.p9.15.m2.1.1.2.3.cmml">2</mn><mi id="S4.SS2.p9.15.m2.1.1.3" xref="S4.SS2.p9.15.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.15.m2.1b"><apply id="S4.SS2.p9.15.m2.1.1.cmml" xref="S4.SS2.p9.15.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.15.m2.1.1.1.cmml" xref="S4.SS2.p9.15.m2.1.1">superscript</csymbol><apply id="S4.SS2.p9.15.m2.1.1.2.cmml" xref="S4.SS2.p9.15.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.15.m2.1.1.2.1.cmml" xref="S4.SS2.p9.15.m2.1.1">subscript</csymbol><ci id="S4.SS2.p9.15.m2.1.1.2.2.cmml" xref="S4.SS2.p9.15.m2.1.1.2.2">𝑊</ci><cn id="S4.SS2.p9.15.m2.1.1.2.3.cmml" type="integer" xref="S4.SS2.p9.15.m2.1.1.2.3">2</cn></apply><ci id="S4.SS2.p9.15.m2.1.1.3.cmml" xref="S4.SS2.p9.15.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.15.m2.1c">W_{2}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.15.m2.1d">italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> are the weights, <math alttext="b_{1}^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.16.m3.1"><semantics id="S4.SS2.p9.16.m3.1a"><msubsup id="S4.SS2.p9.16.m3.1.1" xref="S4.SS2.p9.16.m3.1.1.cmml"><mi id="S4.SS2.p9.16.m3.1.1.2.2" xref="S4.SS2.p9.16.m3.1.1.2.2.cmml">b</mi><mn id="S4.SS2.p9.16.m3.1.1.2.3" xref="S4.SS2.p9.16.m3.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p9.16.m3.1.1.3" xref="S4.SS2.p9.16.m3.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.16.m3.1b"><apply id="S4.SS2.p9.16.m3.1.1.cmml" xref="S4.SS2.p9.16.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.16.m3.1.1.1.cmml" xref="S4.SS2.p9.16.m3.1.1">superscript</csymbol><apply id="S4.SS2.p9.16.m3.1.1.2.cmml" xref="S4.SS2.p9.16.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.16.m3.1.1.2.1.cmml" xref="S4.SS2.p9.16.m3.1.1">subscript</csymbol><ci id="S4.SS2.p9.16.m3.1.1.2.2.cmml" xref="S4.SS2.p9.16.m3.1.1.2.2">𝑏</ci><cn id="S4.SS2.p9.16.m3.1.1.2.3.cmml" type="integer" xref="S4.SS2.p9.16.m3.1.1.2.3">1</cn></apply><ci id="S4.SS2.p9.16.m3.1.1.3.cmml" xref="S4.SS2.p9.16.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.16.m3.1c">b_{1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.16.m3.1d">italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="b_{2}^{n}" class="ltx_Math" display="inline" id="S4.SS2.p9.17.m4.1"><semantics id="S4.SS2.p9.17.m4.1a"><msubsup id="S4.SS2.p9.17.m4.1.1" xref="S4.SS2.p9.17.m4.1.1.cmml"><mi id="S4.SS2.p9.17.m4.1.1.2.2" xref="S4.SS2.p9.17.m4.1.1.2.2.cmml">b</mi><mn id="S4.SS2.p9.17.m4.1.1.2.3" xref="S4.SS2.p9.17.m4.1.1.2.3.cmml">2</mn><mi id="S4.SS2.p9.17.m4.1.1.3" xref="S4.SS2.p9.17.m4.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.17.m4.1b"><apply id="S4.SS2.p9.17.m4.1.1.cmml" xref="S4.SS2.p9.17.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.17.m4.1.1.1.cmml" xref="S4.SS2.p9.17.m4.1.1">superscript</csymbol><apply id="S4.SS2.p9.17.m4.1.1.2.cmml" xref="S4.SS2.p9.17.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p9.17.m4.1.1.2.1.cmml" xref="S4.SS2.p9.17.m4.1.1">subscript</csymbol><ci id="S4.SS2.p9.17.m4.1.1.2.2.cmml" xref="S4.SS2.p9.17.m4.1.1.2.2">𝑏</ci><cn id="S4.SS2.p9.17.m4.1.1.2.3.cmml" type="integer" xref="S4.SS2.p9.17.m4.1.1.2.3">2</cn></apply><ci id="S4.SS2.p9.17.m4.1.1.3.cmml" xref="S4.SS2.p9.17.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.17.m4.1c">b_{2}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.17.m4.1d">italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> are the biases, and <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS2.p9.18.m5.1"><semantics id="S4.SS2.p9.18.m5.1a"><mi id="S4.SS2.p9.18.m5.1.1" xref="S4.SS2.p9.18.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p9.18.m5.1b"><ci id="S4.SS2.p9.18.m5.1.1.cmml" xref="S4.SS2.p9.18.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p9.18.m5.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p9.18.m5.1d">italic_σ</annotation></semantics></math> denotes an activation function. Importantly, these weights and biases are shared across all tokens, significantly reducing the overall parameter count. By decomposing the weight matrix into chunked diagonal components and using shared parameters, the model can efficiently handle sequences of different lengths without an increase in parameters. This approach ensures that the model remains scalable and adaptable, maintaining high performance and computational efficiency.</p>
</div>
<div class="ltx_para" id="S4.SS2.p10">
<p class="ltx_p" id="S4.SS2.p10.1">Next, to enhance the model’s nonlinear modeling capabilities and stability, we utilize residual connections and Feed-Forward Network (FFN) structures, significantly boosting the model’s ability to capture and model user behaviors. Additionally, to further leverage the capabilities of multi-behavior sequential recommendations and understand the relationships between different behaviors, we process the user’s various behavior sequences as well as the overall behavior sequence through the Efficient Filter Layer (EFL). This filtering process produces refined representations for each behavior sequence. Subsequently, these filtered representations are passed through a behavior mixer, which is a fully connected structure, to obtain the final representation. The behavior mixer effectively combines information from different behavior sequences, capturing both the individual behaviors and their temporal relationships. This integration enhances the model’s ability to make accurate and comprehensive recommendations. The culmination of these layers is the final module, named the Efficient Behavior Miner (EBM). In conclusion, our proposed EBM can effectively capture complex user patterns to filter out data noise and maintain model simplicity by utilizing frequency-aware fusion and the chunking diagonal mechanism.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Complexity, parameter count, and degree of feature fusion for SA, FMLP, and EBM. <math alttext="L" class="ltx_Math" display="inline" id="S4.T1.4.m1.1"><semantics id="S4.T1.4.m1.1b"><mi id="S4.T1.4.m1.1.1" xref="S4.T1.4.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.4.m1.1c"><ci id="S4.T1.4.m1.1.1.cmml" xref="S4.T1.4.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m1.1d">L</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.m1.1e">italic_L</annotation></semantics></math>, <math alttext="d" class="ltx_Math" display="inline" id="S4.T1.5.m2.1"><semantics id="S4.T1.5.m2.1b"><mi id="S4.T1.5.m2.1.1" xref="S4.T1.5.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.m2.1c"><ci id="S4.T1.5.m2.1.1.cmml" xref="S4.T1.5.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.m2.1d">d</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.m2.1e">italic_d</annotation></semantics></math>, and <math alttext="k" class="ltx_Math" display="inline" id="S4.T1.6.m3.1"><semantics id="S4.T1.6.m3.1b"><mi id="S4.T1.6.m3.1.1" xref="S4.T1.6.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.m3.1c"><ci id="S4.T1.6.m3.1.1.cmml" xref="S4.T1.6.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.m3.1d">k</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.m3.1e">italic_k</annotation></semantics></math> refer to the sequence length, hidden size, and block count, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.12" style="width:299.1pt;height:66.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.0pt,2.9pt) scale(0.92,0.92) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.12.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.12.6.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.12.6.7.1.1">Model</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.12.6.7.1.2">Complexity</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.12.6.7.1.3">Parameter Count</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T1.12.6.7.1.4">Feature fusion</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.8.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.8.2.2.3">Self-Attention</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.7.1.1.1"><math alttext="L^{2}d+3Ld^{2}" class="ltx_Math" display="inline" id="S4.T1.7.1.1.1.m1.1"><semantics id="S4.T1.7.1.1.1.m1.1a"><mrow id="S4.T1.7.1.1.1.m1.1.1" xref="S4.T1.7.1.1.1.m1.1.1.cmml"><mrow id="S4.T1.7.1.1.1.m1.1.1.2" xref="S4.T1.7.1.1.1.m1.1.1.2.cmml"><msup id="S4.T1.7.1.1.1.m1.1.1.2.2" xref="S4.T1.7.1.1.1.m1.1.1.2.2.cmml"><mi id="S4.T1.7.1.1.1.m1.1.1.2.2.2" xref="S4.T1.7.1.1.1.m1.1.1.2.2.2.cmml">L</mi><mn id="S4.T1.7.1.1.1.m1.1.1.2.2.3" xref="S4.T1.7.1.1.1.m1.1.1.2.2.3.cmml">2</mn></msup><mo id="S4.T1.7.1.1.1.m1.1.1.2.1" xref="S4.T1.7.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T1.7.1.1.1.m1.1.1.2.3" xref="S4.T1.7.1.1.1.m1.1.1.2.3.cmml">d</mi></mrow><mo id="S4.T1.7.1.1.1.m1.1.1.1" xref="S4.T1.7.1.1.1.m1.1.1.1.cmml">+</mo><mrow id="S4.T1.7.1.1.1.m1.1.1.3" xref="S4.T1.7.1.1.1.m1.1.1.3.cmml"><mn id="S4.T1.7.1.1.1.m1.1.1.3.2" xref="S4.T1.7.1.1.1.m1.1.1.3.2.cmml">3</mn><mo id="S4.T1.7.1.1.1.m1.1.1.3.1" xref="S4.T1.7.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.1.1.1.m1.1.1.3.3" xref="S4.T1.7.1.1.1.m1.1.1.3.3.cmml">L</mi><mo id="S4.T1.7.1.1.1.m1.1.1.3.1a" xref="S4.T1.7.1.1.1.m1.1.1.3.1.cmml">⁢</mo><msup id="S4.T1.7.1.1.1.m1.1.1.3.4" xref="S4.T1.7.1.1.1.m1.1.1.3.4.cmml"><mi id="S4.T1.7.1.1.1.m1.1.1.3.4.2" xref="S4.T1.7.1.1.1.m1.1.1.3.4.2.cmml">d</mi><mn id="S4.T1.7.1.1.1.m1.1.1.3.4.3" xref="S4.T1.7.1.1.1.m1.1.1.3.4.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.1.1.1.m1.1b"><apply id="S4.T1.7.1.1.1.m1.1.1.cmml" xref="S4.T1.7.1.1.1.m1.1.1"><plus id="S4.T1.7.1.1.1.m1.1.1.1.cmml" xref="S4.T1.7.1.1.1.m1.1.1.1"></plus><apply id="S4.T1.7.1.1.1.m1.1.1.2.cmml" xref="S4.T1.7.1.1.1.m1.1.1.2"><times id="S4.T1.7.1.1.1.m1.1.1.2.1.cmml" xref="S4.T1.7.1.1.1.m1.1.1.2.1"></times><apply id="S4.T1.7.1.1.1.m1.1.1.2.2.cmml" xref="S4.T1.7.1.1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.T1.7.1.1.1.m1.1.1.2.2.1.cmml" xref="S4.T1.7.1.1.1.m1.1.1.2.2">superscript</csymbol><ci id="S4.T1.7.1.1.1.m1.1.1.2.2.2.cmml" xref="S4.T1.7.1.1.1.m1.1.1.2.2.2">𝐿</ci><cn id="S4.T1.7.1.1.1.m1.1.1.2.2.3.cmml" type="integer" xref="S4.T1.7.1.1.1.m1.1.1.2.2.3">2</cn></apply><ci id="S4.T1.7.1.1.1.m1.1.1.2.3.cmml" xref="S4.T1.7.1.1.1.m1.1.1.2.3">𝑑</ci></apply><apply id="S4.T1.7.1.1.1.m1.1.1.3.cmml" xref="S4.T1.7.1.1.1.m1.1.1.3"><times id="S4.T1.7.1.1.1.m1.1.1.3.1.cmml" xref="S4.T1.7.1.1.1.m1.1.1.3.1"></times><cn id="S4.T1.7.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.7.1.1.1.m1.1.1.3.2">3</cn><ci id="S4.T1.7.1.1.1.m1.1.1.3.3.cmml" xref="S4.T1.7.1.1.1.m1.1.1.3.3">𝐿</ci><apply id="S4.T1.7.1.1.1.m1.1.1.3.4.cmml" xref="S4.T1.7.1.1.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="S4.T1.7.1.1.1.m1.1.1.3.4.1.cmml" xref="S4.T1.7.1.1.1.m1.1.1.3.4">superscript</csymbol><ci id="S4.T1.7.1.1.1.m1.1.1.3.4.2.cmml" xref="S4.T1.7.1.1.1.m1.1.1.3.4.2">𝑑</ci><cn id="S4.T1.7.1.1.1.m1.1.1.3.4.3.cmml" type="integer" xref="S4.T1.7.1.1.1.m1.1.1.3.4.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.1.1.1.m1.1c">L^{2}d+3Ld^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.1.1.1.m1.1d">italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d + 3 italic_L italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.8.2.2.2"><math alttext="3d^{2}" class="ltx_Math" display="inline" id="S4.T1.8.2.2.2.m1.1"><semantics id="S4.T1.8.2.2.2.m1.1a"><mrow id="S4.T1.8.2.2.2.m1.1.1" xref="S4.T1.8.2.2.2.m1.1.1.cmml"><mn id="S4.T1.8.2.2.2.m1.1.1.2" xref="S4.T1.8.2.2.2.m1.1.1.2.cmml">3</mn><mo id="S4.T1.8.2.2.2.m1.1.1.1" xref="S4.T1.8.2.2.2.m1.1.1.1.cmml">⁢</mo><msup id="S4.T1.8.2.2.2.m1.1.1.3" xref="S4.T1.8.2.2.2.m1.1.1.3.cmml"><mi id="S4.T1.8.2.2.2.m1.1.1.3.2" xref="S4.T1.8.2.2.2.m1.1.1.3.2.cmml">d</mi><mn id="S4.T1.8.2.2.2.m1.1.1.3.3" xref="S4.T1.8.2.2.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.8.2.2.2.m1.1b"><apply id="S4.T1.8.2.2.2.m1.1.1.cmml" xref="S4.T1.8.2.2.2.m1.1.1"><times id="S4.T1.8.2.2.2.m1.1.1.1.cmml" xref="S4.T1.8.2.2.2.m1.1.1.1"></times><cn id="S4.T1.8.2.2.2.m1.1.1.2.cmml" type="integer" xref="S4.T1.8.2.2.2.m1.1.1.2">3</cn><apply id="S4.T1.8.2.2.2.m1.1.1.3.cmml" xref="S4.T1.8.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.8.2.2.2.m1.1.1.3.1.cmml" xref="S4.T1.8.2.2.2.m1.1.1.3">superscript</csymbol><ci id="S4.T1.8.2.2.2.m1.1.1.3.2.cmml" xref="S4.T1.8.2.2.2.m1.1.1.3.2">𝑑</ci><cn id="S4.T1.8.2.2.2.m1.1.1.3.3.cmml" type="integer" xref="S4.T1.8.2.2.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.2.2.2.m1.1c">3d^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.2.2.2.m1.1d">3 italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.8.2.2.4">Adequate</td>
</tr>
<tr class="ltx_tr" id="S4.T1.10.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.10.4.4.3">FMLP</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.9.3.3.1"><math alttext="Ld+Ld\log L" class="ltx_Math" display="inline" id="S4.T1.9.3.3.1.m1.1"><semantics id="S4.T1.9.3.3.1.m1.1a"><mrow id="S4.T1.9.3.3.1.m1.1.1" xref="S4.T1.9.3.3.1.m1.1.1.cmml"><mrow id="S4.T1.9.3.3.1.m1.1.1.2" xref="S4.T1.9.3.3.1.m1.1.1.2.cmml"><mi id="S4.T1.9.3.3.1.m1.1.1.2.2" xref="S4.T1.9.3.3.1.m1.1.1.2.2.cmml">L</mi><mo id="S4.T1.9.3.3.1.m1.1.1.2.1" xref="S4.T1.9.3.3.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T1.9.3.3.1.m1.1.1.2.3" xref="S4.T1.9.3.3.1.m1.1.1.2.3.cmml">d</mi></mrow><mo id="S4.T1.9.3.3.1.m1.1.1.1" xref="S4.T1.9.3.3.1.m1.1.1.1.cmml">+</mo><mrow id="S4.T1.9.3.3.1.m1.1.1.3" xref="S4.T1.9.3.3.1.m1.1.1.3.cmml"><mi id="S4.T1.9.3.3.1.m1.1.1.3.2" xref="S4.T1.9.3.3.1.m1.1.1.3.2.cmml">L</mi><mo id="S4.T1.9.3.3.1.m1.1.1.3.1" xref="S4.T1.9.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.3.3.1.m1.1.1.3.3" xref="S4.T1.9.3.3.1.m1.1.1.3.3.cmml">d</mi><mo id="S4.T1.9.3.3.1.m1.1.1.3.1a" lspace="0.167em" xref="S4.T1.9.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mrow id="S4.T1.9.3.3.1.m1.1.1.3.4" xref="S4.T1.9.3.3.1.m1.1.1.3.4.cmml"><mi id="S4.T1.9.3.3.1.m1.1.1.3.4.1" xref="S4.T1.9.3.3.1.m1.1.1.3.4.1.cmml">log</mi><mo id="S4.T1.9.3.3.1.m1.1.1.3.4a" lspace="0.167em" xref="S4.T1.9.3.3.1.m1.1.1.3.4.cmml">⁡</mo><mi id="S4.T1.9.3.3.1.m1.1.1.3.4.2" xref="S4.T1.9.3.3.1.m1.1.1.3.4.2.cmml">L</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.9.3.3.1.m1.1b"><apply id="S4.T1.9.3.3.1.m1.1.1.cmml" xref="S4.T1.9.3.3.1.m1.1.1"><plus id="S4.T1.9.3.3.1.m1.1.1.1.cmml" xref="S4.T1.9.3.3.1.m1.1.1.1"></plus><apply id="S4.T1.9.3.3.1.m1.1.1.2.cmml" xref="S4.T1.9.3.3.1.m1.1.1.2"><times id="S4.T1.9.3.3.1.m1.1.1.2.1.cmml" xref="S4.T1.9.3.3.1.m1.1.1.2.1"></times><ci id="S4.T1.9.3.3.1.m1.1.1.2.2.cmml" xref="S4.T1.9.3.3.1.m1.1.1.2.2">𝐿</ci><ci id="S4.T1.9.3.3.1.m1.1.1.2.3.cmml" xref="S4.T1.9.3.3.1.m1.1.1.2.3">𝑑</ci></apply><apply id="S4.T1.9.3.3.1.m1.1.1.3.cmml" xref="S4.T1.9.3.3.1.m1.1.1.3"><times id="S4.T1.9.3.3.1.m1.1.1.3.1.cmml" xref="S4.T1.9.3.3.1.m1.1.1.3.1"></times><ci id="S4.T1.9.3.3.1.m1.1.1.3.2.cmml" xref="S4.T1.9.3.3.1.m1.1.1.3.2">𝐿</ci><ci id="S4.T1.9.3.3.1.m1.1.1.3.3.cmml" xref="S4.T1.9.3.3.1.m1.1.1.3.3">𝑑</ci><apply id="S4.T1.9.3.3.1.m1.1.1.3.4.cmml" xref="S4.T1.9.3.3.1.m1.1.1.3.4"><log id="S4.T1.9.3.3.1.m1.1.1.3.4.1.cmml" xref="S4.T1.9.3.3.1.m1.1.1.3.4.1"></log><ci id="S4.T1.9.3.3.1.m1.1.1.3.4.2.cmml" xref="S4.T1.9.3.3.1.m1.1.1.3.4.2">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.3.3.1.m1.1c">Ld+Ld\log L</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.3.3.1.m1.1d">italic_L italic_d + italic_L italic_d roman_log italic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.10.4.4.2"><math alttext="Ld" class="ltx_Math" display="inline" id="S4.T1.10.4.4.2.m1.1"><semantics id="S4.T1.10.4.4.2.m1.1a"><mrow id="S4.T1.10.4.4.2.m1.1.1" xref="S4.T1.10.4.4.2.m1.1.1.cmml"><mi id="S4.T1.10.4.4.2.m1.1.1.2" xref="S4.T1.10.4.4.2.m1.1.1.2.cmml">L</mi><mo id="S4.T1.10.4.4.2.m1.1.1.1" xref="S4.T1.10.4.4.2.m1.1.1.1.cmml">⁢</mo><mi id="S4.T1.10.4.4.2.m1.1.1.3" xref="S4.T1.10.4.4.2.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.10.4.4.2.m1.1b"><apply id="S4.T1.10.4.4.2.m1.1.1.cmml" xref="S4.T1.10.4.4.2.m1.1.1"><times id="S4.T1.10.4.4.2.m1.1.1.1.cmml" xref="S4.T1.10.4.4.2.m1.1.1.1"></times><ci id="S4.T1.10.4.4.2.m1.1.1.2.cmml" xref="S4.T1.10.4.4.2.m1.1.1.2">𝐿</ci><ci id="S4.T1.10.4.4.2.m1.1.1.3.cmml" xref="S4.T1.10.4.4.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.4.4.2.m1.1c">Ld</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.4.4.2.m1.1d">italic_L italic_d</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.10.4.4.4">Inadequate</td>
</tr>
<tr class="ltx_tr" id="S4.T1.12.6.6">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T1.12.6.6.3">EBM</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T1.11.5.5.1"><math alttext="Ld^{2}/k+Ld\log L" class="ltx_Math" display="inline" id="S4.T1.11.5.5.1.m1.1"><semantics id="S4.T1.11.5.5.1.m1.1a"><mrow id="S4.T1.11.5.5.1.m1.1.1" xref="S4.T1.11.5.5.1.m1.1.1.cmml"><mrow id="S4.T1.11.5.5.1.m1.1.1.2" xref="S4.T1.11.5.5.1.m1.1.1.2.cmml"><mrow id="S4.T1.11.5.5.1.m1.1.1.2.2" xref="S4.T1.11.5.5.1.m1.1.1.2.2.cmml"><mi id="S4.T1.11.5.5.1.m1.1.1.2.2.2" xref="S4.T1.11.5.5.1.m1.1.1.2.2.2.cmml">L</mi><mo id="S4.T1.11.5.5.1.m1.1.1.2.2.1" xref="S4.T1.11.5.5.1.m1.1.1.2.2.1.cmml">⁢</mo><msup id="S4.T1.11.5.5.1.m1.1.1.2.2.3" xref="S4.T1.11.5.5.1.m1.1.1.2.2.3.cmml"><mi id="S4.T1.11.5.5.1.m1.1.1.2.2.3.2" xref="S4.T1.11.5.5.1.m1.1.1.2.2.3.2.cmml">d</mi><mn id="S4.T1.11.5.5.1.m1.1.1.2.2.3.3" xref="S4.T1.11.5.5.1.m1.1.1.2.2.3.3.cmml">2</mn></msup></mrow><mo id="S4.T1.11.5.5.1.m1.1.1.2.1" xref="S4.T1.11.5.5.1.m1.1.1.2.1.cmml">/</mo><mi id="S4.T1.11.5.5.1.m1.1.1.2.3" xref="S4.T1.11.5.5.1.m1.1.1.2.3.cmml">k</mi></mrow><mo id="S4.T1.11.5.5.1.m1.1.1.1" xref="S4.T1.11.5.5.1.m1.1.1.1.cmml">+</mo><mrow id="S4.T1.11.5.5.1.m1.1.1.3" xref="S4.T1.11.5.5.1.m1.1.1.3.cmml"><mi id="S4.T1.11.5.5.1.m1.1.1.3.2" xref="S4.T1.11.5.5.1.m1.1.1.3.2.cmml">L</mi><mo id="S4.T1.11.5.5.1.m1.1.1.3.1" xref="S4.T1.11.5.5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.11.5.5.1.m1.1.1.3.3" xref="S4.T1.11.5.5.1.m1.1.1.3.3.cmml">d</mi><mo id="S4.T1.11.5.5.1.m1.1.1.3.1a" lspace="0.167em" xref="S4.T1.11.5.5.1.m1.1.1.3.1.cmml">⁢</mo><mrow id="S4.T1.11.5.5.1.m1.1.1.3.4" xref="S4.T1.11.5.5.1.m1.1.1.3.4.cmml"><mi id="S4.T1.11.5.5.1.m1.1.1.3.4.1" xref="S4.T1.11.5.5.1.m1.1.1.3.4.1.cmml">log</mi><mo id="S4.T1.11.5.5.1.m1.1.1.3.4a" lspace="0.167em" xref="S4.T1.11.5.5.1.m1.1.1.3.4.cmml">⁡</mo><mi id="S4.T1.11.5.5.1.m1.1.1.3.4.2" xref="S4.T1.11.5.5.1.m1.1.1.3.4.2.cmml">L</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.5.5.1.m1.1b"><apply id="S4.T1.11.5.5.1.m1.1.1.cmml" xref="S4.T1.11.5.5.1.m1.1.1"><plus id="S4.T1.11.5.5.1.m1.1.1.1.cmml" xref="S4.T1.11.5.5.1.m1.1.1.1"></plus><apply id="S4.T1.11.5.5.1.m1.1.1.2.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2"><divide id="S4.T1.11.5.5.1.m1.1.1.2.1.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.1"></divide><apply id="S4.T1.11.5.5.1.m1.1.1.2.2.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.2"><times id="S4.T1.11.5.5.1.m1.1.1.2.2.1.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.2.1"></times><ci id="S4.T1.11.5.5.1.m1.1.1.2.2.2.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.2.2">𝐿</ci><apply id="S4.T1.11.5.5.1.m1.1.1.2.2.3.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.T1.11.5.5.1.m1.1.1.2.2.3.1.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.2.3">superscript</csymbol><ci id="S4.T1.11.5.5.1.m1.1.1.2.2.3.2.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.2.3.2">𝑑</ci><cn id="S4.T1.11.5.5.1.m1.1.1.2.2.3.3.cmml" type="integer" xref="S4.T1.11.5.5.1.m1.1.1.2.2.3.3">2</cn></apply></apply><ci id="S4.T1.11.5.5.1.m1.1.1.2.3.cmml" xref="S4.T1.11.5.5.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S4.T1.11.5.5.1.m1.1.1.3.cmml" xref="S4.T1.11.5.5.1.m1.1.1.3"><times id="S4.T1.11.5.5.1.m1.1.1.3.1.cmml" xref="S4.T1.11.5.5.1.m1.1.1.3.1"></times><ci id="S4.T1.11.5.5.1.m1.1.1.3.2.cmml" xref="S4.T1.11.5.5.1.m1.1.1.3.2">𝐿</ci><ci id="S4.T1.11.5.5.1.m1.1.1.3.3.cmml" xref="S4.T1.11.5.5.1.m1.1.1.3.3">𝑑</ci><apply id="S4.T1.11.5.5.1.m1.1.1.3.4.cmml" xref="S4.T1.11.5.5.1.m1.1.1.3.4"><log id="S4.T1.11.5.5.1.m1.1.1.3.4.1.cmml" xref="S4.T1.11.5.5.1.m1.1.1.3.4.1"></log><ci id="S4.T1.11.5.5.1.m1.1.1.3.4.2.cmml" xref="S4.T1.11.5.5.1.m1.1.1.3.4.2">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.5.5.1.m1.1c">Ld^{2}/k+Ld\log L</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.5.5.1.m1.1d">italic_L italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_k + italic_L italic_d roman_log italic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T1.12.6.6.2"><math alttext="(1+4/k)d^{2}+4d" class="ltx_Math" display="inline" id="S4.T1.12.6.6.2.m1.1"><semantics id="S4.T1.12.6.6.2.m1.1a"><mrow id="S4.T1.12.6.6.2.m1.1.1" xref="S4.T1.12.6.6.2.m1.1.1.cmml"><mrow id="S4.T1.12.6.6.2.m1.1.1.1" xref="S4.T1.12.6.6.2.m1.1.1.1.cmml"><mrow id="S4.T1.12.6.6.2.m1.1.1.1.1.1" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.cmml"><mo id="S4.T1.12.6.6.2.m1.1.1.1.1.1.2" stretchy="false" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.cmml"><mn id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.2" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.1" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.cmml"><mn id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.2" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.1" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.1.cmml">/</mo><mi id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.3" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></mrow><mo id="S4.T1.12.6.6.2.m1.1.1.1.1.1.3" stretchy="false" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.T1.12.6.6.2.m1.1.1.1.2" xref="S4.T1.12.6.6.2.m1.1.1.1.2.cmml">⁢</mo><msup id="S4.T1.12.6.6.2.m1.1.1.1.3" xref="S4.T1.12.6.6.2.m1.1.1.1.3.cmml"><mi id="S4.T1.12.6.6.2.m1.1.1.1.3.2" xref="S4.T1.12.6.6.2.m1.1.1.1.3.2.cmml">d</mi><mn id="S4.T1.12.6.6.2.m1.1.1.1.3.3" xref="S4.T1.12.6.6.2.m1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S4.T1.12.6.6.2.m1.1.1.2" xref="S4.T1.12.6.6.2.m1.1.1.2.cmml">+</mo><mrow id="S4.T1.12.6.6.2.m1.1.1.3" xref="S4.T1.12.6.6.2.m1.1.1.3.cmml"><mn id="S4.T1.12.6.6.2.m1.1.1.3.2" xref="S4.T1.12.6.6.2.m1.1.1.3.2.cmml">4</mn><mo id="S4.T1.12.6.6.2.m1.1.1.3.1" xref="S4.T1.12.6.6.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.12.6.6.2.m1.1.1.3.3" xref="S4.T1.12.6.6.2.m1.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.12.6.6.2.m1.1b"><apply id="S4.T1.12.6.6.2.m1.1.1.cmml" xref="S4.T1.12.6.6.2.m1.1.1"><plus id="S4.T1.12.6.6.2.m1.1.1.2.cmml" xref="S4.T1.12.6.6.2.m1.1.1.2"></plus><apply id="S4.T1.12.6.6.2.m1.1.1.1.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1"><times id="S4.T1.12.6.6.2.m1.1.1.1.2.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.2"></times><apply id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1"><plus id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.1.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.1"></plus><cn id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.2">1</cn><apply id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3"><divide id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.1"></divide><cn id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.2">4</cn><ci id="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S4.T1.12.6.6.2.m1.1.1.1.3.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.12.6.6.2.m1.1.1.1.3.1.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.3">superscript</csymbol><ci id="S4.T1.12.6.6.2.m1.1.1.1.3.2.cmml" xref="S4.T1.12.6.6.2.m1.1.1.1.3.2">𝑑</ci><cn id="S4.T1.12.6.6.2.m1.1.1.1.3.3.cmml" type="integer" xref="S4.T1.12.6.6.2.m1.1.1.1.3.3">2</cn></apply></apply><apply id="S4.T1.12.6.6.2.m1.1.1.3.cmml" xref="S4.T1.12.6.6.2.m1.1.1.3"><times id="S4.T1.12.6.6.2.m1.1.1.3.1.cmml" xref="S4.T1.12.6.6.2.m1.1.1.3.1"></times><cn id="S4.T1.12.6.6.2.m1.1.1.3.2.cmml" type="integer" xref="S4.T1.12.6.6.2.m1.1.1.3.2">4</cn><ci id="S4.T1.12.6.6.2.m1.1.1.3.3.cmml" xref="S4.T1.12.6.6.2.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.6.6.2.m1.1c">(1+4/k)d^{2}+4d</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.6.6.2.m1.1d">( 1 + 4 / italic_k ) italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 italic_d</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T1.12.6.6.4">Adequate</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS2.p11">
<p class="ltx_p" id="S4.SS2.p11.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p11.1.1">Efficiency Analysis</span>. To further illustrate the efficient denoisng module EBM, we conduct a complexity comparison analysis with some representative methods, such as Self-Attention and FMLP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib51" title="">51</a>]</cite>, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.T1" title="TABLE I ‣ 4.2 De-noised Pre-trained Model ‣ 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">I</span></a>. From the table, we can conclude that both EBM and FMLP have lower complexity compared to traditional self-attention methods. Although FMLP is based on Fourier Transform operation to accelerate efficiency, it only utilizes the dot-product operator and fails to fuse frequency domain information, which cannot model more complex patterns in behavior sequences. In contrast, EBM can achieve full fusion (The ability to fully intersect global frequency domain features.) while requiring relatively small parameters, independent of behavior sequence length. This ensures the efficiency of the DPCPL in terms of both running time and parameter spaces.</p>
</div>
<div class="ltx_para" id="S4.SS2.p12">
<p class="ltx_p" id="S4.SS2.p12.4">Through <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.p12.1.m1.1"><semantics id="S4.SS2.p12.1.m1.1a"><mi id="S4.SS2.p12.1.m1.1.1" xref="S4.SS2.p12.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p12.1.m1.1b"><ci id="S4.SS2.p12.1.m1.1.1.cmml" xref="S4.SS2.p12.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p12.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.1.m1.1d">italic_L</annotation></semantics></math>-layer EBMs, we obtain the final user representation <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.p12.2.m2.1"><semantics id="S4.SS2.p12.2.m2.1a"><mi id="S4.SS2.p12.2.m2.1.1" xref="S4.SS2.p12.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p12.2.m2.1b"><ci id="S4.SS2.p12.2.m2.1.1.cmml" xref="S4.SS2.p12.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p12.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.2.m2.1d">italic_u</annotation></semantics></math>. Finally, we define the pre-training loss function. In MBSR, the prediction of the next item under different behaviors is typically the main task. To efficiently migrate to downstream tasks, we design a pre-training task that focuses on predicting both the next item (with indistinguishable behaviors) and the type of next behavior. For <math alttext="(u,b_{p},v_{p})\in S^{+}" class="ltx_Math" display="inline" id="S4.SS2.p12.3.m3.3"><semantics id="S4.SS2.p12.3.m3.3a"><mrow id="S4.SS2.p12.3.m3.3.3" xref="S4.SS2.p12.3.m3.3.3.cmml"><mrow id="S4.SS2.p12.3.m3.3.3.2.2" xref="S4.SS2.p12.3.m3.3.3.2.3.cmml"><mo id="S4.SS2.p12.3.m3.3.3.2.2.3" stretchy="false" xref="S4.SS2.p12.3.m3.3.3.2.3.cmml">(</mo><mi id="S4.SS2.p12.3.m3.1.1" xref="S4.SS2.p12.3.m3.1.1.cmml">u</mi><mo id="S4.SS2.p12.3.m3.3.3.2.2.4" xref="S4.SS2.p12.3.m3.3.3.2.3.cmml">,</mo><msub id="S4.SS2.p12.3.m3.2.2.1.1.1" xref="S4.SS2.p12.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS2.p12.3.m3.2.2.1.1.1.2" xref="S4.SS2.p12.3.m3.2.2.1.1.1.2.cmml">b</mi><mi id="S4.SS2.p12.3.m3.2.2.1.1.1.3" xref="S4.SS2.p12.3.m3.2.2.1.1.1.3.cmml">p</mi></msub><mo id="S4.SS2.p12.3.m3.3.3.2.2.5" xref="S4.SS2.p12.3.m3.3.3.2.3.cmml">,</mo><msub id="S4.SS2.p12.3.m3.3.3.2.2.2" xref="S4.SS2.p12.3.m3.3.3.2.2.2.cmml"><mi id="S4.SS2.p12.3.m3.3.3.2.2.2.2" xref="S4.SS2.p12.3.m3.3.3.2.2.2.2.cmml">v</mi><mi id="S4.SS2.p12.3.m3.3.3.2.2.2.3" xref="S4.SS2.p12.3.m3.3.3.2.2.2.3.cmml">p</mi></msub><mo id="S4.SS2.p12.3.m3.3.3.2.2.6" stretchy="false" xref="S4.SS2.p12.3.m3.3.3.2.3.cmml">)</mo></mrow><mo id="S4.SS2.p12.3.m3.3.3.3" xref="S4.SS2.p12.3.m3.3.3.3.cmml">∈</mo><msup id="S4.SS2.p12.3.m3.3.3.4" xref="S4.SS2.p12.3.m3.3.3.4.cmml"><mi id="S4.SS2.p12.3.m3.3.3.4.2" xref="S4.SS2.p12.3.m3.3.3.4.2.cmml">S</mi><mo id="S4.SS2.p12.3.m3.3.3.4.3" xref="S4.SS2.p12.3.m3.3.3.4.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p12.3.m3.3b"><apply id="S4.SS2.p12.3.m3.3.3.cmml" xref="S4.SS2.p12.3.m3.3.3"><in id="S4.SS2.p12.3.m3.3.3.3.cmml" xref="S4.SS2.p12.3.m3.3.3.3"></in><vector id="S4.SS2.p12.3.m3.3.3.2.3.cmml" xref="S4.SS2.p12.3.m3.3.3.2.2"><ci id="S4.SS2.p12.3.m3.1.1.cmml" xref="S4.SS2.p12.3.m3.1.1">𝑢</ci><apply id="S4.SS2.p12.3.m3.2.2.1.1.1.cmml" xref="S4.SS2.p12.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p12.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS2.p12.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p12.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS2.p12.3.m3.2.2.1.1.1.2">𝑏</ci><ci id="S4.SS2.p12.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS2.p12.3.m3.2.2.1.1.1.3">𝑝</ci></apply><apply id="S4.SS2.p12.3.m3.3.3.2.2.2.cmml" xref="S4.SS2.p12.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p12.3.m3.3.3.2.2.2.1.cmml" xref="S4.SS2.p12.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p12.3.m3.3.3.2.2.2.2.cmml" xref="S4.SS2.p12.3.m3.3.3.2.2.2.2">𝑣</ci><ci id="S4.SS2.p12.3.m3.3.3.2.2.2.3.cmml" xref="S4.SS2.p12.3.m3.3.3.2.2.2.3">𝑝</ci></apply></vector><apply id="S4.SS2.p12.3.m3.3.3.4.cmml" xref="S4.SS2.p12.3.m3.3.3.4"><csymbol cd="ambiguous" id="S4.SS2.p12.3.m3.3.3.4.1.cmml" xref="S4.SS2.p12.3.m3.3.3.4">superscript</csymbol><ci id="S4.SS2.p12.3.m3.3.3.4.2.cmml" xref="S4.SS2.p12.3.m3.3.3.4.2">𝑆</ci><plus id="S4.SS2.p12.3.m3.3.3.4.3.cmml" xref="S4.SS2.p12.3.m3.3.3.4.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p12.3.m3.3c">(u,b_{p},v_{p})\in S^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.3.m3.3d">( italic_u , italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) ∈ italic_S start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and (<math alttext="u,b_{n},v_{n})\in S^{-}" class="ltx_math_unparsed" display="inline" id="S4.SS2.p12.4.m4.1"><semantics id="S4.SS2.p12.4.m4.1a"><mrow id="S4.SS2.p12.4.m4.1b"><mi id="S4.SS2.p12.4.m4.1.1">u</mi><mo id="S4.SS2.p12.4.m4.1.2">,</mo><msub id="S4.SS2.p12.4.m4.1.3"><mi id="S4.SS2.p12.4.m4.1.3.2">b</mi><mi id="S4.SS2.p12.4.m4.1.3.3">n</mi></msub><mo id="S4.SS2.p12.4.m4.1.4">,</mo><msub id="S4.SS2.p12.4.m4.1.5"><mi id="S4.SS2.p12.4.m4.1.5.2">v</mi><mi id="S4.SS2.p12.4.m4.1.5.3">n</mi></msub><mo id="S4.SS2.p12.4.m4.1.6" stretchy="false">)</mo><mo id="S4.SS2.p12.4.m4.1.7">∈</mo><mi id="S4.SS2.p12.4.m4.1.8">S</mi><msup id="S4.SS2.p12.4.m4.1.9"><mi id="S4.SS2.p12.4.m4.1.9a"></mi><mo id="S4.SS2.p12.4.m4.1.9.1">−</mo></msup></mrow><annotation encoding="application/x-tex" id="S4.SS2.p12.4.m4.1c">u,b_{n},v_{n})\in S^{-}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p12.4.m4.1d">italic_u , italic_b start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) ∈ italic_S start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>, the specific loss functions are presented below:</p>
</div>
<div class="ltx_para" id="S4.SS2.p13">
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{pt}=-\sum_{U}\sum_{S}\log\sigma\left(u^{T}e_{p}-u^{T}e_{n}\right)%
-\log\sigma\left(u^{\top}b_{p}-u^{\top}b_{n}\right)," class="ltx_Math" display="block" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><msub id="S4.E4.m1.1.1.1.1.4" xref="S4.E4.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.1.4.2" xref="S4.E4.m1.1.1.1.1.4.2.cmml">ℒ</mi><mrow id="S4.E4.m1.1.1.1.1.4.3" xref="S4.E4.m1.1.1.1.1.4.3.cmml"><mi id="S4.E4.m1.1.1.1.1.4.3.2" xref="S4.E4.m1.1.1.1.1.4.3.2.cmml">p</mi><mo id="S4.E4.m1.1.1.1.1.4.3.1" xref="S4.E4.m1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S4.E4.m1.1.1.1.1.4.3.3" xref="S4.E4.m1.1.1.1.1.4.3.3.cmml">t</mi></mrow></msub><mo id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.1.1.1.1.1.1a" xref="S4.E4.m1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml"><munder id="S4.E4.m1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E4.m1.1.1.1.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S4.E4.m1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.2.3.cmml">U</mi></munder><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml"><munder id="S4.E4.m1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml">S</mi></munder><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msup id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">u</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">T</mi></msup><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">e</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">p</mi></msub></mrow><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><msup id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">u</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">T</mi></msup><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">e</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.3.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.2.2.cmml"><mrow id="S4.E4.m1.1.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.3.1" xref="S4.E4.m1.1.1.1.1.2.2.3.1.cmml">log</mi><mo id="S4.E4.m1.1.1.1.1.2.2.3a" lspace="0.167em" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">⁡</mo><mi id="S4.E4.m1.1.1.1.1.2.2.3.2" xref="S4.E4.m1.1.1.1.1.2.2.3.2.cmml">σ</mi></mrow><mo id="S4.E4.m1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="S4.E4.m1.1.1.1.1.2.2.1.1" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S4.E4.m1.1.1.1.1.2.2.1.1.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.2.2.1.1.1" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.cmml"><msup id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.2.cmml">u</mi><mo id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.3.cmml">⊤</mo></msup><mo id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.1" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.1.cmml">⁢</mo><msub id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.2.cmml">b</mi><mi id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml">p</mi></msub></mrow><mo id="S4.E4.m1.1.1.1.1.2.2.1.1.1.1" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><mrow id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.cmml"><msup id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.2.cmml">u</mi><mo id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.3.cmml">⊤</mo></msup><mo id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.2" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.2.cmml">b</mi><mi id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><mo id="S4.E4.m1.1.1.1.1.2.2.1.1.3" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"></eq><apply id="S4.E4.m1.1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.1.1.1.1.4">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.4.2.cmml" xref="S4.E4.m1.1.1.1.1.4.2">ℒ</ci><apply id="S4.E4.m1.1.1.1.1.4.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3"><times id="S4.E4.m1.1.1.1.1.4.3.1.cmml" xref="S4.E4.m1.1.1.1.1.4.3.1"></times><ci id="S4.E4.m1.1.1.1.1.4.3.2.cmml" xref="S4.E4.m1.1.1.1.1.4.3.2">𝑝</ci><ci id="S4.E4.m1.1.1.1.1.4.3.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3.3">𝑡</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><minus id="S4.E4.m1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3"></minus><apply id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1"><minus id="S4.E4.m1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1"></minus><apply id="S4.E4.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1"><apply id="S4.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2.2"></sum><ci id="S4.E4.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2.3">𝑈</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.2"></sum><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.3">𝑆</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3"><log id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1"></log><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑢</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑝</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑢</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑇</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑒</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S4.E4.m1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2"><times id="S4.E4.m1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2"></times><apply id="S4.E4.m1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.3"><log id="S4.E4.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.3.1"></log><ci id="S4.E4.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.3.2">𝜎</ci></apply><apply id="S4.E4.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1"><minus id="S4.E4.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.1"></minus><apply id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2"><times id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.1"></times><apply id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.2">𝑢</ci><csymbol cd="latexml" id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.2.3">top</csymbol></apply><apply id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.2">𝑏</ci><ci id="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.2.3.3">𝑝</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3"><times id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.1"></times><apply id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.2">𝑢</ci><csymbol cd="latexml" id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.2.3">top</csymbol></apply><apply id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.2">𝑏</ci><ci id="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.1.1.1.3.3.3">𝑛</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\mathcal{L}_{pt}=-\sum_{U}\sum_{S}\log\sigma\left(u^{T}e_{p}-u^{T}e_{n}\right)%
-\log\sigma\left(u^{\top}b_{p}-u^{\top}b_{n}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_p italic_t end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_U end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT roman_log italic_σ ( italic_u start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT - italic_u start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) - roman_log italic_σ ( italic_u start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT - italic_u start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p13.4">where <math alttext="S^{+}" class="ltx_Math" display="inline" id="S4.SS2.p13.1.m1.1"><semantics id="S4.SS2.p13.1.m1.1a"><msup id="S4.SS2.p13.1.m1.1.1" xref="S4.SS2.p13.1.m1.1.1.cmml"><mi id="S4.SS2.p13.1.m1.1.1.2" xref="S4.SS2.p13.1.m1.1.1.2.cmml">S</mi><mo id="S4.SS2.p13.1.m1.1.1.3" xref="S4.SS2.p13.1.m1.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p13.1.m1.1b"><apply id="S4.SS2.p13.1.m1.1.1.cmml" xref="S4.SS2.p13.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p13.1.m1.1.1.1.cmml" xref="S4.SS2.p13.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p13.1.m1.1.1.2.cmml" xref="S4.SS2.p13.1.m1.1.1.2">𝑆</ci><plus id="S4.SS2.p13.1.m1.1.1.3.cmml" xref="S4.SS2.p13.1.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p13.1.m1.1c">S^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p13.1.m1.1d">italic_S start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> represents the positive sample pairs, and <math alttext="S^{-}" class="ltx_Math" display="inline" id="S4.SS2.p13.2.m2.1"><semantics id="S4.SS2.p13.2.m2.1a"><msup id="S4.SS2.p13.2.m2.1.1" xref="S4.SS2.p13.2.m2.1.1.cmml"><mi id="S4.SS2.p13.2.m2.1.1.2" xref="S4.SS2.p13.2.m2.1.1.2.cmml">S</mi><mo id="S4.SS2.p13.2.m2.1.1.3" xref="S4.SS2.p13.2.m2.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p13.2.m2.1b"><apply id="S4.SS2.p13.2.m2.1.1.cmml" xref="S4.SS2.p13.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p13.2.m2.1.1.1.cmml" xref="S4.SS2.p13.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p13.2.m2.1.1.2.cmml" xref="S4.SS2.p13.2.m2.1.1.2">𝑆</ci><minus id="S4.SS2.p13.2.m2.1.1.3.cmml" xref="S4.SS2.p13.2.m2.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p13.2.m2.1c">S^{-}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p13.2.m2.1d">italic_S start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> represents the negative ones. Specifically, <math alttext="e_{p}" class="ltx_Math" display="inline" id="S4.SS2.p13.3.m3.1"><semantics id="S4.SS2.p13.3.m3.1a"><msub id="S4.SS2.p13.3.m3.1.1" xref="S4.SS2.p13.3.m3.1.1.cmml"><mi id="S4.SS2.p13.3.m3.1.1.2" xref="S4.SS2.p13.3.m3.1.1.2.cmml">e</mi><mi id="S4.SS2.p13.3.m3.1.1.3" xref="S4.SS2.p13.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p13.3.m3.1b"><apply id="S4.SS2.p13.3.m3.1.1.cmml" xref="S4.SS2.p13.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p13.3.m3.1.1.1.cmml" xref="S4.SS2.p13.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p13.3.m3.1.1.2.cmml" xref="S4.SS2.p13.3.m3.1.1.2">𝑒</ci><ci id="S4.SS2.p13.3.m3.1.1.3.cmml" xref="S4.SS2.p13.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p13.3.m3.1c">e_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p13.3.m3.1d">italic_e start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> represents the item embeddings for positive samples, which are items the user has interacted with, while <math alttext="e_{n}" class="ltx_Math" display="inline" id="S4.SS2.p13.4.m4.1"><semantics id="S4.SS2.p13.4.m4.1a"><msub id="S4.SS2.p13.4.m4.1.1" xref="S4.SS2.p13.4.m4.1.1.cmml"><mi id="S4.SS2.p13.4.m4.1.1.2" xref="S4.SS2.p13.4.m4.1.1.2.cmml">e</mi><mi id="S4.SS2.p13.4.m4.1.1.3" xref="S4.SS2.p13.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p13.4.m4.1b"><apply id="S4.SS2.p13.4.m4.1.1.cmml" xref="S4.SS2.p13.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p13.4.m4.1.1.1.cmml" xref="S4.SS2.p13.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p13.4.m4.1.1.2.cmml" xref="S4.SS2.p13.4.m4.1.1.2">𝑒</ci><ci id="S4.SS2.p13.4.m4.1.1.3.cmml" xref="S4.SS2.p13.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p13.4.m4.1c">e_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p13.4.m4.1d">italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> denotes the embeddings of negatively sampled items that are randomly selected.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span class="ltx_text ltx_font_italic" id="S4.SS3.1.1">Customized Prompt Tuning</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">After pre-training, we aim to utilize prompt tuning techniques to transfer knowledge to downstream tasks efficiently. It is worth mentioning here that compared to very early user behavior, the data we use for fine-tuning is the user’s behavior data in the most recent period. However, unlike in NLP contexts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib56" title="">56</a>]</cite>, the tokens of a pre-trained recommendation model lack semantic information, making it challenging to manually design effective hard prompts. Specifically, in recommendation models, the tokens are item IDs, which do not carry specific semantics. This absence of inherent meaning makes it difficult to create hard prompts based on grammatical rules as done in NLP. Moreover, personalization is crucial in recommendation systems, requiring prompts to be tailored to individual users. Therefore, we propose that prompt learning in recommendation scenarios must be personalized and introduce a new concept called Customized Prompt Learning. This approach involves dynamically setting prompts based on various user-specific auxiliary information.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">To leverage the pre-trained model effectively, we use soft prompts. Our goal is to ensure these prompts possess three key properties: Personalization, Progressiveness, and Diversity. By doing so, we aim to maximize the pre-trained model’s potential and enhance the efficiency and accuracy of downstream tasks in recommendation systems.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Prompt Personalization</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">To explore the personalized behavioral patterns in the pre-trained model, we propose the concept of Customized Prompt Learning to personalize prompt learning for each user. Specifically, we dynamically customize the prompts based on the user’s personalized information, whereas, in MBSR, we can take into account the user’s attributes, statistics, and behaviors.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.6">First, as for attributes and statistics, we embed them directly. It is worth mentioning that in MBSR, we found and firstly pointed out that statistics is a crucial feature. For instance, the number of various behaviors of a user can reflect whether the user is in a cold-start group, and the conversion ratio between behaviors (e.g., the proportion of purchases made by adding to a cart) can reflect the user’s behavioral habits. Second, in order to model the variability of different behaviors, we model the different sequences of users’ behaviors separately to generate prompts through a simple yet efficient gated recurrent network. Formally, for user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.1.m1.1"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><mi id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><ci id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.1.m1.1d">italic_u</annotation></semantics></math>, we get prompts about the user’s attributes <math alttext="{q}_{u,attr}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.2.m2.2"><semantics id="S4.SS3.SSS1.p2.2.m2.2a"><msub id="S4.SS3.SSS1.p2.2.m2.2.3" xref="S4.SS3.SSS1.p2.2.m2.2.3.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.2.3.2" xref="S4.SS3.SSS1.p2.2.m2.2.3.2.cmml">q</mi><mrow id="S4.SS3.SSS1.p2.2.m2.2.2.2.2" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.3.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.1.1.1.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.2" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.3.cmml">,</mo><mrow id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.cmml"><mi id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.2" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.2.cmml">a</mi><mo id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.3" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.3.cmml">t</mi><mo id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1a" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.4" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.4.cmml">t</mi><mo id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1b" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.5" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.5.cmml">r</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.2.m2.2b"><apply id="S4.SS3.SSS1.p2.2.m2.2.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.2.m2.2.3.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.3">subscript</csymbol><ci id="S4.SS3.SSS1.p2.2.m2.2.3.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.3.2">𝑞</ci><list id="S4.SS3.SSS1.p2.2.m2.2.2.2.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2"><ci id="S4.SS3.SSS1.p2.2.m2.1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1.1.1">𝑢</ci><apply id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1"><times id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.1"></times><ci id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.2.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.2">𝑎</ci><ci id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.3.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.3">𝑡</ci><ci id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.4.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.4">𝑡</ci><ci id="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.5.cmml" xref="S4.SS3.SSS1.p2.2.m2.2.2.2.2.1.5">𝑟</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.2.m2.2c">{q}_{u,attr}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.2.m2.2d">italic_q start_POSTSUBSCRIPT italic_u , italic_a italic_t italic_t italic_r end_POSTSUBSCRIPT</annotation></semantics></math> through <math alttext="MultiMLP([{a}_{1}^{u}\left\|{a}_{2}^{u}\right\|\cdots\|])" class="ltx_math_unparsed" display="inline" id="S4.SS3.SSS1.p2.3.m3.1"><semantics id="S4.SS3.SSS1.p2.3.m3.1a"><mrow id="S4.SS3.SSS1.p2.3.m3.1b"><mi id="S4.SS3.SSS1.p2.3.m3.1.2">M</mi><mi id="S4.SS3.SSS1.p2.3.m3.1.3">u</mi><mi id="S4.SS3.SSS1.p2.3.m3.1.4">l</mi><mi id="S4.SS3.SSS1.p2.3.m3.1.5">t</mi><mi id="S4.SS3.SSS1.p2.3.m3.1.6">i</mi><mi id="S4.SS3.SSS1.p2.3.m3.1.7">M</mi><mi id="S4.SS3.SSS1.p2.3.m3.1.8">L</mi><mi id="S4.SS3.SSS1.p2.3.m3.1.9">P</mi><mrow id="S4.SS3.SSS1.p2.3.m3.1.10"><mo id="S4.SS3.SSS1.p2.3.m3.1.10.1" stretchy="false">(</mo><mrow id="S4.SS3.SSS1.p2.3.m3.1.10.2"><mo id="S4.SS3.SSS1.p2.3.m3.1.10.2.1" stretchy="false">[</mo><msubsup id="S4.SS3.SSS1.p2.3.m3.1.10.2.2"><mi id="S4.SS3.SSS1.p2.3.m3.1.10.2.2.2.2">a</mi><mn id="S4.SS3.SSS1.p2.3.m3.1.10.2.2.2.3">1</mn><mi id="S4.SS3.SSS1.p2.3.m3.1.10.2.2.3">u</mi></msubsup><mo id="S4.SS3.SSS1.p2.3.m3.1.10.2.3" lspace="0em" rspace="0.167em" stretchy="true">∥</mo><msubsup id="S4.SS3.SSS1.p2.3.m3.1.10.2.4"><mi id="S4.SS3.SSS1.p2.3.m3.1.10.2.4.2.2">a</mi><mn id="S4.SS3.SSS1.p2.3.m3.1.10.2.4.2.3">2</mn><mi id="S4.SS3.SSS1.p2.3.m3.1.10.2.4.3">u</mi></msubsup><mo id="S4.SS3.SSS1.p2.3.m3.1.10.2.5" lspace="0em" rspace="0.167em" stretchy="true">∥</mo><mi id="S4.SS3.SSS1.p2.3.m3.1.1" mathvariant="normal">⋯</mi><mo id="S4.SS3.SSS1.p2.3.m3.1.10.2.6" lspace="0em" rspace="0.167em">∥</mo><mo id="S4.SS3.SSS1.p2.3.m3.1.10.2.7" stretchy="false">]</mo></mrow><mo id="S4.SS3.SSS1.p2.3.m3.1.10.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.3.m3.1c">MultiMLP([{a}_{1}^{u}\left\|{a}_{2}^{u}\right\|\cdots\|])</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.3.m3.1d">italic_M italic_u italic_l italic_t italic_i italic_M italic_L italic_P ( [ italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∥ italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ∥ ⋯ ∥ ] )</annotation></semantics></math>, and with the same token we can get prompts about the user’s statistics <math alttext="{q}_{u,statis}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.4.m4.2"><semantics id="S4.SS3.SSS1.p2.4.m4.2a"><msub id="S4.SS3.SSS1.p2.4.m4.2.3" xref="S4.SS3.SSS1.p2.4.m4.2.3.cmml"><mi id="S4.SS3.SSS1.p2.4.m4.2.3.2" xref="S4.SS3.SSS1.p2.4.m4.2.3.2.cmml">q</mi><mrow id="S4.SS3.SSS1.p2.4.m4.2.2.2.2" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.3.cmml"><mi id="S4.SS3.SSS1.p2.4.m4.1.1.1.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.2" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.3.cmml">,</mo><mrow id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.cmml"><mi id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.2" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.2.cmml">s</mi><mo id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.3" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.3.cmml">t</mi><mo id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1a" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.4" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.4.cmml">a</mi><mo id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1b" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.5" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.5.cmml">t</mi><mo id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1c" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.6" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.6.cmml">i</mi><mo id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1d" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.7" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.7.cmml">s</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.4.m4.2b"><apply id="S4.SS3.SSS1.p2.4.m4.2.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.4.m4.2.3.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.3">subscript</csymbol><ci id="S4.SS3.SSS1.p2.4.m4.2.3.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.3.2">𝑞</ci><list id="S4.SS3.SSS1.p2.4.m4.2.2.2.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2"><ci id="S4.SS3.SSS1.p2.4.m4.1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.1.1">𝑢</ci><apply id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1"><times id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.1"></times><ci id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.2">𝑠</ci><ci id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.3">𝑡</ci><ci id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.4.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.4">𝑎</ci><ci id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.5.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.5">𝑡</ci><ci id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.6.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.6">𝑖</ci><ci id="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.7.cmml" xref="S4.SS3.SSS1.p2.4.m4.2.2.2.2.1.7">𝑠</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.4.m4.2c">{q}_{u,statis}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.4.m4.2d">italic_q start_POSTSUBSCRIPT italic_u , italic_s italic_t italic_a italic_t italic_i italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, where the <math alttext="||" class="ltx_math_unparsed" display="inline" id="S4.SS3.SSS1.p2.5.m5.1"><semantics id="S4.SS3.SSS1.p2.5.m5.1a"><mrow id="S4.SS3.SSS1.p2.5.m5.1b"><mo fence="false" id="S4.SS3.SSS1.p2.5.m5.1.1" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.SS3.SSS1.p2.5.m5.1.2" stretchy="false">|</mo></mrow><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.5.m5.1c">||</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.5.m5.1d">| |</annotation></semantics></math> symbol represents vector concatenation. In addition, we represent the user’s behavioral prompt information <math alttext="{q}_{u,b}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p2.6.m6.2"><semantics id="S4.SS3.SSS1.p2.6.m6.2a"><msub id="S4.SS3.SSS1.p2.6.m6.2.3" xref="S4.SS3.SSS1.p2.6.m6.2.3.cmml"><mi id="S4.SS3.SSS1.p2.6.m6.2.3.2" xref="S4.SS3.SSS1.p2.6.m6.2.3.2.cmml">q</mi><mrow id="S4.SS3.SSS1.p2.6.m6.2.2.2.4" xref="S4.SS3.SSS1.p2.6.m6.2.2.2.3.cmml"><mi id="S4.SS3.SSS1.p2.6.m6.1.1.1.1" xref="S4.SS3.SSS1.p2.6.m6.1.1.1.1.cmml">u</mi><mo id="S4.SS3.SSS1.p2.6.m6.2.2.2.4.1" xref="S4.SS3.SSS1.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS3.SSS1.p2.6.m6.2.2.2.2" xref="S4.SS3.SSS1.p2.6.m6.2.2.2.2.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.6.m6.2b"><apply id="S4.SS3.SSS1.p2.6.m6.2.3.cmml" xref="S4.SS3.SSS1.p2.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p2.6.m6.2.3.1.cmml" xref="S4.SS3.SSS1.p2.6.m6.2.3">subscript</csymbol><ci id="S4.SS3.SSS1.p2.6.m6.2.3.2.cmml" xref="S4.SS3.SSS1.p2.6.m6.2.3.2">𝑞</ci><list id="S4.SS3.SSS1.p2.6.m6.2.2.2.3.cmml" xref="S4.SS3.SSS1.p2.6.m6.2.2.2.4"><ci id="S4.SS3.SSS1.p2.6.m6.1.1.1.1.cmml" xref="S4.SS3.SSS1.p2.6.m6.1.1.1.1">𝑢</ci><ci id="S4.SS3.SSS1.p2.6.m6.2.2.2.2.cmml" xref="S4.SS3.SSS1.p2.6.m6.2.2.2.2">𝑏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.6.m6.2c">{q}_{u,b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p2.6.m6.2d">italic_q start_POSTSUBSCRIPT italic_u , italic_b end_POSTSUBSCRIPT</annotation></semantics></math> by the hidden state of the last layer of the Gated Recurrent Unit (GRU) at the final time step.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Prompt Progressiveness</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">Beyond personalization, we aim to further exploit the potential of pre-trained models by designing elaborate prompt strategies. To achieve this, we find that the pre-trained model uses a bottom-up learning process, where user interests are learned through a step-by-step hierarchical condensation process of user behaviors. Considering this, we develop an innovative progressive prompt strategy. Specifically, our progressive prompt approach incorporates prompts not only at the input side of the model but also at each layer of the model. This approach enables prompts to steer and enhance the model’s comprehension of user preferences as it advances through each layer, enabling more efficient fine-tuning of pre-trained models and improving performance on downstream tasks such as cold-start.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.1">Further, we considered that the various layers of the model require distinct prompt factors, which are obtained from the user’s personalized information. Extracting the appropriate prompt factors for each layer from the complex user information poses a significant challenge. To this end, we propose a Prompt Factorized Gate Network (PFG) structure for refining the prompt factors from the prompt information and then generating the prompts for each layer of the pre-trained model.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p3">
<p class="ltx_p" id="S4.SS3.SSS2.p3.5">Specifically, following the personalized prompt generator, we acquire various aspects of prompt information referred to as <math alttext="Q_{u}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.1.m1.1"><semantics id="S4.SS3.SSS2.p3.1.m1.1a"><msub id="S4.SS3.SSS2.p3.1.m1.1.1" xref="S4.SS3.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p3.1.m1.1.1.2" xref="S4.SS3.SSS2.p3.1.m1.1.1.2.cmml">Q</mi><mi id="S4.SS3.SSS2.p3.1.m1.1.1.3" xref="S4.SS3.SSS2.p3.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.1.m1.1b"><apply id="S4.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.2">𝑄</ci><ci id="S4.SS3.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.1.m1.1c">Q_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> for user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.2.m2.1"><semantics id="S4.SS3.SSS2.p3.2.m2.1a"><mi id="S4.SS3.SSS2.p3.2.m2.1.1" xref="S4.SS3.SSS2.p3.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.2.m2.1b"><ci id="S4.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.2.m2.1d">italic_u</annotation></semantics></math>. Initially, we consolidate this prompt information into a prompt factor matrix of size <math alttext="L\times N" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.3.m3.1"><semantics id="S4.SS3.SSS2.p3.3.m3.1a"><mrow id="S4.SS3.SSS2.p3.3.m3.1.1" xref="S4.SS3.SSS2.p3.3.m3.1.1.cmml"><mi id="S4.SS3.SSS2.p3.3.m3.1.1.2" xref="S4.SS3.SSS2.p3.3.m3.1.1.2.cmml">L</mi><mo id="S4.SS3.SSS2.p3.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS2.p3.3.m3.1.1.1.cmml">×</mo><mi id="S4.SS3.SSS2.p3.3.m3.1.1.3" xref="S4.SS3.SSS2.p3.3.m3.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.3.m3.1b"><apply id="S4.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1"><times id="S4.SS3.SSS2.p3.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.1"></times><ci id="S4.SS3.SSS2.p3.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.2">𝐿</ci><ci id="S4.SS3.SSS2.p3.3.m3.1.1.3.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.3.m3.1c">L\times N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.3.m3.1d">italic_L × italic_N</annotation></semantics></math>, where <math alttext="L" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.4.m4.1"><semantics id="S4.SS3.SSS2.p3.4.m4.1a"><mi id="S4.SS3.SSS2.p3.4.m4.1.1" xref="S4.SS3.SSS2.p3.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.4.m4.1b"><ci id="S4.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.4.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.4.m4.1d">italic_L</annotation></semantics></math> is the number of network layers and <math alttext="N" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.5.m5.1"><semantics id="S4.SS3.SSS2.p3.5.m5.1a"><mi id="S4.SS3.SSS2.p3.5.m5.1.1" xref="S4.SS3.SSS2.p3.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.5.m5.1b"><ci id="S4.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p3.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.5.m5.1d">italic_N</annotation></semantics></math> is the number of prompt factors in each layer through PFG. The specific formula used is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q_{u}=[q_{u,attr}||q_{u,statis}||...||q_{u,b}]," class="ltx_Math" display="block" id="S4.E5.m1.8"><semantics id="S4.E5.m1.8a"><mrow id="S4.E5.m1.8.8.1" xref="S4.E5.m1.8.8.1.1.cmml"><mrow id="S4.E5.m1.8.8.1.1" xref="S4.E5.m1.8.8.1.1.cmml"><msub id="S4.E5.m1.8.8.1.1.3" xref="S4.E5.m1.8.8.1.1.3.cmml"><mi id="S4.E5.m1.8.8.1.1.3.2" xref="S4.E5.m1.8.8.1.1.3.2.cmml">Q</mi><mi id="S4.E5.m1.8.8.1.1.3.3" xref="S4.E5.m1.8.8.1.1.3.3.cmml">u</mi></msub><mo id="S4.E5.m1.8.8.1.1.2" xref="S4.E5.m1.8.8.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.8.8.1.1.1.1" xref="S4.E5.m1.8.8.1.1.1.2.cmml"><mo id="S4.E5.m1.8.8.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S4.E5.m1.8.8.1.1.1.1.1" xref="S4.E5.m1.8.8.1.1.1.1.1.cmml"><msub id="S4.E5.m1.8.8.1.1.1.1.1.3" xref="S4.E5.m1.8.8.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.8.8.1.1.1.1.1.3.2" xref="S4.E5.m1.8.8.1.1.1.1.1.3.2.cmml">q</mi><mrow id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">u</mi><mo id="S4.E5.m1.2.2.2.2.2" xref="S4.E5.m1.2.2.2.3.cmml">,</mo><mrow id="S4.E5.m1.2.2.2.2.1" xref="S4.E5.m1.2.2.2.2.1.cmml"><mi id="S4.E5.m1.2.2.2.2.1.2" xref="S4.E5.m1.2.2.2.2.1.2.cmml">a</mi><mo id="S4.E5.m1.2.2.2.2.1.1" xref="S4.E5.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.2.2.2.2.1.3" xref="S4.E5.m1.2.2.2.2.1.3.cmml">t</mi><mo id="S4.E5.m1.2.2.2.2.1.1a" xref="S4.E5.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.2.2.2.2.1.4" xref="S4.E5.m1.2.2.2.2.1.4.cmml">t</mi><mo id="S4.E5.m1.2.2.2.2.1.1b" xref="S4.E5.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.2.2.2.2.1.5" xref="S4.E5.m1.2.2.2.2.1.5.cmml">r</mi></mrow></mrow></msub><mo id="S4.E5.m1.8.8.1.1.1.1.1.2" xref="S4.E5.m1.8.8.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.8.8.1.1.1.1.1.1.1" xref="S4.E5.m1.8.8.1.1.1.1.1.1.2.cmml"><mo id="S4.E5.m1.8.8.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mrow id="S4.E5.m1.4.4.2.2" xref="S4.E5.m1.4.4.2.3.cmml"><mi id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml">u</mi><mo id="S4.E5.m1.4.4.2.2.2" xref="S4.E5.m1.4.4.2.3.cmml">,</mo><mrow id="S4.E5.m1.4.4.2.2.1" xref="S4.E5.m1.4.4.2.2.1.cmml"><mi id="S4.E5.m1.4.4.2.2.1.2" xref="S4.E5.m1.4.4.2.2.1.2.cmml">s</mi><mo id="S4.E5.m1.4.4.2.2.1.1" xref="S4.E5.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.2.2.1.3" xref="S4.E5.m1.4.4.2.2.1.3.cmml">t</mi><mo id="S4.E5.m1.4.4.2.2.1.1a" xref="S4.E5.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.2.2.1.4" xref="S4.E5.m1.4.4.2.2.1.4.cmml">a</mi><mo id="S4.E5.m1.4.4.2.2.1.1b" xref="S4.E5.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.2.2.1.5" xref="S4.E5.m1.4.4.2.2.1.5.cmml">t</mi><mo id="S4.E5.m1.4.4.2.2.1.1c" xref="S4.E5.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.2.2.1.6" xref="S4.E5.m1.4.4.2.2.1.6.cmml">i</mi><mo id="S4.E5.m1.4.4.2.2.1.1d" xref="S4.E5.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="S4.E5.m1.4.4.2.2.1.7" xref="S4.E5.m1.4.4.2.2.1.7.cmml">s</mi></mrow></mrow></msub><mo id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.1.1.cmml">|</mo><mi id="S4.E5.m1.7.7" mathvariant="normal" xref="S4.E5.m1.7.7.cmml">…</mi><mo id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.1.1.cmml">|</mo></mrow></mrow><mo id="S4.E5.m1.8.8.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.E5.m1.8.8.1.1.1.1.1.2a" xref="S4.E5.m1.8.8.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E5.m1.8.8.1.1.1.1.1.4" xref="S4.E5.m1.8.8.1.1.1.1.1.4.cmml"><mi id="S4.E5.m1.8.8.1.1.1.1.1.4.2" xref="S4.E5.m1.8.8.1.1.1.1.1.4.2.cmml">q</mi><mrow id="S4.E5.m1.6.6.2.4" xref="S4.E5.m1.6.6.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1" xref="S4.E5.m1.5.5.1.1.cmml">u</mi><mo id="S4.E5.m1.6.6.2.4.1" xref="S4.E5.m1.6.6.2.3.cmml">,</mo><mi id="S4.E5.m1.6.6.2.2" xref="S4.E5.m1.6.6.2.2.cmml">b</mi></mrow></msub></mrow><mo id="S4.E5.m1.8.8.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E5.m1.8.8.1.2" xref="S4.E5.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.8b"><apply id="S4.E5.m1.8.8.1.1.cmml" xref="S4.E5.m1.8.8.1"><eq id="S4.E5.m1.8.8.1.1.2.cmml" xref="S4.E5.m1.8.8.1.1.2"></eq><apply id="S4.E5.m1.8.8.1.1.3.cmml" xref="S4.E5.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.8.8.1.1.3.1.cmml" xref="S4.E5.m1.8.8.1.1.3">subscript</csymbol><ci id="S4.E5.m1.8.8.1.1.3.2.cmml" xref="S4.E5.m1.8.8.1.1.3.2">𝑄</ci><ci id="S4.E5.m1.8.8.1.1.3.3.cmml" xref="S4.E5.m1.8.8.1.1.3.3">𝑢</ci></apply><apply id="S4.E5.m1.8.8.1.1.1.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.8.8.1.1.1.2.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E5.m1.8.8.1.1.1.1.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1"><times id="S4.E5.m1.8.8.1.1.1.1.1.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.2"></times><apply id="S4.E5.m1.8.8.1.1.1.1.1.3.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.3.2">𝑞</ci><list id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2"><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝑢</ci><apply id="S4.E5.m1.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.1"><times id="S4.E5.m1.2.2.2.2.1.1.cmml" xref="S4.E5.m1.2.2.2.2.1.1"></times><ci id="S4.E5.m1.2.2.2.2.1.2.cmml" xref="S4.E5.m1.2.2.2.2.1.2">𝑎</ci><ci id="S4.E5.m1.2.2.2.2.1.3.cmml" xref="S4.E5.m1.2.2.2.2.1.3">𝑡</ci><ci id="S4.E5.m1.2.2.2.2.1.4.cmml" xref="S4.E5.m1.2.2.2.2.1.4">𝑡</ci><ci id="S4.E5.m1.2.2.2.2.1.5.cmml" xref="S4.E5.m1.2.2.2.2.1.5">𝑟</ci></apply></list></apply><apply id="S4.E5.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1"><abs id="S4.E5.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.2"></abs><apply id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1"><times id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1"><abs id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><list id="S4.E5.m1.4.4.2.3.cmml" xref="S4.E5.m1.4.4.2.2"><ci id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1.1">𝑢</ci><apply id="S4.E5.m1.4.4.2.2.1.cmml" xref="S4.E5.m1.4.4.2.2.1"><times id="S4.E5.m1.4.4.2.2.1.1.cmml" xref="S4.E5.m1.4.4.2.2.1.1"></times><ci id="S4.E5.m1.4.4.2.2.1.2.cmml" xref="S4.E5.m1.4.4.2.2.1.2">𝑠</ci><ci id="S4.E5.m1.4.4.2.2.1.3.cmml" xref="S4.E5.m1.4.4.2.2.1.3">𝑡</ci><ci id="S4.E5.m1.4.4.2.2.1.4.cmml" xref="S4.E5.m1.4.4.2.2.1.4">𝑎</ci><ci id="S4.E5.m1.4.4.2.2.1.5.cmml" xref="S4.E5.m1.4.4.2.2.1.5">𝑡</ci><ci id="S4.E5.m1.4.4.2.2.1.6.cmml" xref="S4.E5.m1.4.4.2.2.1.6">𝑖</ci><ci id="S4.E5.m1.4.4.2.2.1.7.cmml" xref="S4.E5.m1.4.4.2.2.1.7">𝑠</ci></apply></list></apply></apply><apply id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2"><abs id="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.1.1.1.3.2.1"></abs><ci id="S4.E5.m1.7.7.cmml" xref="S4.E5.m1.7.7">…</ci></apply></apply></apply><apply id="S4.E5.m1.8.8.1.1.1.1.1.4.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E5.m1.8.8.1.1.1.1.1.4.1.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E5.m1.8.8.1.1.1.1.1.4.2.cmml" xref="S4.E5.m1.8.8.1.1.1.1.1.4.2">𝑞</ci><list id="S4.E5.m1.6.6.2.3.cmml" xref="S4.E5.m1.6.6.2.4"><ci id="S4.E5.m1.5.5.1.1.cmml" xref="S4.E5.m1.5.5.1.1">𝑢</ci><ci id="S4.E5.m1.6.6.2.2.cmml" xref="S4.E5.m1.6.6.2.2">𝑏</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.8c">Q_{u}=[q_{u,attr}||q_{u,statis}||...||q_{u,b}],</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.8d">italic_Q start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ italic_q start_POSTSUBSCRIPT italic_u , italic_a italic_t italic_t italic_r end_POSTSUBSCRIPT | | italic_q start_POSTSUBSCRIPT italic_u , italic_s italic_t italic_a italic_t italic_i italic_s end_POSTSUBSCRIPT | | … | | italic_q start_POSTSUBSCRIPT italic_u , italic_b end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{A}^{u}_{l,n}=\mathrm{softmax}\left(W_{l,n}Q_{u}\right),\quad E_{l,n}^%
{u}=\mathcal{A}^{u}_{l,n}Q_{u}," class="ltx_Math" display="block" id="S4.E6.m1.9"><semantics id="S4.E6.m1.9a"><mrow id="S4.E6.m1.9.9.1"><mrow id="S4.E6.m1.9.9.1.1.2" xref="S4.E6.m1.9.9.1.1.3.cmml"><mrow id="S4.E6.m1.9.9.1.1.1.1" xref="S4.E6.m1.9.9.1.1.1.1.cmml"><msubsup id="S4.E6.m1.9.9.1.1.1.1.3" xref="S4.E6.m1.9.9.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.9.9.1.1.1.1.3.2.2" xref="S4.E6.m1.9.9.1.1.1.1.3.2.2.cmml">𝒜</mi><mrow id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">l</mi><mo id="S4.E6.m1.2.2.2.4.1" xref="S4.E6.m1.2.2.2.3.cmml">,</mo><mi id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">n</mi></mrow><mi id="S4.E6.m1.9.9.1.1.1.1.3.2.3" xref="S4.E6.m1.9.9.1.1.1.1.3.2.3.cmml">u</mi></msubsup><mo id="S4.E6.m1.9.9.1.1.1.1.2" xref="S4.E6.m1.9.9.1.1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.9.9.1.1.1.1.1" xref="S4.E6.m1.9.9.1.1.1.1.1.cmml"><mi id="S4.E6.m1.9.9.1.1.1.1.1.3" xref="S4.E6.m1.9.9.1.1.1.1.1.3.cmml">softmax</mi><mo id="S4.E6.m1.9.9.1.1.1.1.1.2" xref="S4.E6.m1.9.9.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.9.9.1.1.1.1.1.1.1" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.9.9.1.1.1.1.1.1.1.2" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mrow id="S4.E6.m1.4.4.2.4" xref="S4.E6.m1.4.4.2.3.cmml"><mi id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml">l</mi><mo id="S4.E6.m1.4.4.2.4.1" xref="S4.E6.m1.4.4.2.3.cmml">,</mo><mi id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.2.cmml">n</mi></mrow></msub><mo id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="S4.E6.m1.9.9.1.1.1.1.1.1.1.3" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.9.9.1.1.2.3" rspace="1.167em" xref="S4.E6.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S4.E6.m1.9.9.1.1.2.2" xref="S4.E6.m1.9.9.1.1.2.2.cmml"><msubsup id="S4.E6.m1.9.9.1.1.2.2.2" xref="S4.E6.m1.9.9.1.1.2.2.2.cmml"><mi id="S4.E6.m1.9.9.1.1.2.2.2.2.2" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2.cmml">E</mi><mrow id="S4.E6.m1.6.6.2.4" xref="S4.E6.m1.6.6.2.3.cmml"><mi id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml">l</mi><mo id="S4.E6.m1.6.6.2.4.1" xref="S4.E6.m1.6.6.2.3.cmml">,</mo><mi id="S4.E6.m1.6.6.2.2" xref="S4.E6.m1.6.6.2.2.cmml">n</mi></mrow><mi id="S4.E6.m1.9.9.1.1.2.2.2.3" xref="S4.E6.m1.9.9.1.1.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.E6.m1.9.9.1.1.2.2.1" xref="S4.E6.m1.9.9.1.1.2.2.1.cmml">=</mo><mrow id="S4.E6.m1.9.9.1.1.2.2.3" xref="S4.E6.m1.9.9.1.1.2.2.3.cmml"><msubsup id="S4.E6.m1.9.9.1.1.2.2.3.2" xref="S4.E6.m1.9.9.1.1.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.9.9.1.1.2.2.3.2.2.2" xref="S4.E6.m1.9.9.1.1.2.2.3.2.2.2.cmml">𝒜</mi><mrow id="S4.E6.m1.8.8.2.4" xref="S4.E6.m1.8.8.2.3.cmml"><mi id="S4.E6.m1.7.7.1.1" xref="S4.E6.m1.7.7.1.1.cmml">l</mi><mo id="S4.E6.m1.8.8.2.4.1" xref="S4.E6.m1.8.8.2.3.cmml">,</mo><mi id="S4.E6.m1.8.8.2.2" xref="S4.E6.m1.8.8.2.2.cmml">n</mi></mrow><mi id="S4.E6.m1.9.9.1.1.2.2.3.2.2.3" xref="S4.E6.m1.9.9.1.1.2.2.3.2.2.3.cmml">u</mi></msubsup><mo id="S4.E6.m1.9.9.1.1.2.2.3.1" xref="S4.E6.m1.9.9.1.1.2.2.3.1.cmml">⁢</mo><msub id="S4.E6.m1.9.9.1.1.2.2.3.3" xref="S4.E6.m1.9.9.1.1.2.2.3.3.cmml"><mi id="S4.E6.m1.9.9.1.1.2.2.3.3.2" xref="S4.E6.m1.9.9.1.1.2.2.3.3.2.cmml">Q</mi><mi id="S4.E6.m1.9.9.1.1.2.2.3.3.3" xref="S4.E6.m1.9.9.1.1.2.2.3.3.3.cmml">u</mi></msub></mrow></mrow></mrow><mo id="S4.E6.m1.9.9.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.9b"><apply id="S4.E6.m1.9.9.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.3a.cmml" xref="S4.E6.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E6.m1.9.9.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1"><eq id="S4.E6.m1.9.9.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.2"></eq><apply id="S4.E6.m1.9.9.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.3.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.3">subscript</csymbol><apply id="S4.E6.m1.9.9.1.1.1.1.3.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.9.9.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.3.2.2">𝒜</ci><ci id="S4.E6.m1.9.9.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.3.2.3">𝑢</ci></apply><list id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.4"><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝑙</ci><ci id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2">𝑛</ci></list></apply><apply id="S4.E6.m1.9.9.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1"><times id="S4.E6.m1.9.9.1.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.2"></times><ci id="S4.E6.m1.9.9.1.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.3">softmax</ci><apply id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1"><times id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.2.2">𝑊</ci><list id="S4.E6.m1.4.4.2.3.cmml" xref="S4.E6.m1.4.4.2.4"><ci id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1.1">𝑙</ci><ci id="S4.E6.m1.4.4.2.2.cmml" xref="S4.E6.m1.4.4.2.2">𝑛</ci></list></apply><apply id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.2">𝑄</ci><ci id="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.9.9.1.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply><apply id="S4.E6.m1.9.9.1.1.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2"><eq id="S4.E6.m1.9.9.1.1.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.1"></eq><apply id="S4.E6.m1.9.9.1.1.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2">superscript</csymbol><apply id="S4.E6.m1.9.9.1.1.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.2.2">𝐸</ci><list id="S4.E6.m1.6.6.2.3.cmml" xref="S4.E6.m1.6.6.2.4"><ci id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1.1">𝑙</ci><ci id="S4.E6.m1.6.6.2.2.cmml" xref="S4.E6.m1.6.6.2.2">𝑛</ci></list></apply><ci id="S4.E6.m1.9.9.1.1.2.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.2.3">𝑢</ci></apply><apply id="S4.E6.m1.9.9.1.1.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3"><times id="S4.E6.m1.9.9.1.1.2.2.3.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.1"></times><apply id="S4.E6.m1.9.9.1.1.2.2.3.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.3.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.2">subscript</csymbol><apply id="S4.E6.m1.9.9.1.1.2.2.3.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.3.2.2.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.2">superscript</csymbol><ci id="S4.E6.m1.9.9.1.1.2.2.3.2.2.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.2.2.2">𝒜</ci><ci id="S4.E6.m1.9.9.1.1.2.2.3.2.2.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.2.2.3">𝑢</ci></apply><list id="S4.E6.m1.8.8.2.3.cmml" xref="S4.E6.m1.8.8.2.4"><ci id="S4.E6.m1.7.7.1.1.cmml" xref="S4.E6.m1.7.7.1.1">𝑙</ci><ci id="S4.E6.m1.8.8.2.2.cmml" xref="S4.E6.m1.8.8.2.2">𝑛</ci></list></apply><apply id="S4.E6.m1.9.9.1.1.2.2.3.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.1.1.2.2.3.3.1.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.3">subscript</csymbol><ci id="S4.E6.m1.9.9.1.1.2.2.3.3.2.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.3.2">𝑄</ci><ci id="S4.E6.m1.9.9.1.1.2.2.3.3.3.cmml" xref="S4.E6.m1.9.9.1.1.2.2.3.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.9c">\mathcal{A}^{u}_{l,n}=\mathrm{softmax}\left(W_{l,n}Q_{u}\right),\quad E_{l,n}^%
{u}=\mathcal{A}^{u}_{l,n}Q_{u},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.9d">caligraphic_A start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l , italic_n end_POSTSUBSCRIPT = roman_softmax ( italic_W start_POSTSUBSCRIPT italic_l , italic_n end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) , italic_E start_POSTSUBSCRIPT italic_l , italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = caligraphic_A start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l , italic_n end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS2.p3.6">where the <math alttext="||" class="ltx_math_unparsed" display="inline" id="S4.SS3.SSS2.p3.6.m1.1"><semantics id="S4.SS3.SSS2.p3.6.m1.1a"><mrow id="S4.SS3.SSS2.p3.6.m1.1b"><mo fence="false" id="S4.SS3.SSS2.p3.6.m1.1.1" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.SS3.SSS2.p3.6.m1.1.2" stretchy="false">|</mo></mrow><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.6.m1.1c">||</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p3.6.m1.1d">| |</annotation></semantics></math> symbol represents vector concatenation.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p4">
<p class="ltx_p" id="S4.SS3.SSS2.p4.1">In addition, we believe that some prompts may be shared in different processes of model learning. To this end, we use the same method to generate a set of shared prompt factors <math alttext="E_{s,n}^{u}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p4.1.m1.2"><semantics id="S4.SS3.SSS2.p4.1.m1.2a"><msubsup id="S4.SS3.SSS2.p4.1.m1.2.3" xref="S4.SS3.SSS2.p4.1.m1.2.3.cmml"><mi id="S4.SS3.SSS2.p4.1.m1.2.3.2.2" xref="S4.SS3.SSS2.p4.1.m1.2.3.2.2.cmml">E</mi><mrow id="S4.SS3.SSS2.p4.1.m1.2.2.2.4" xref="S4.SS3.SSS2.p4.1.m1.2.2.2.3.cmml"><mi id="S4.SS3.SSS2.p4.1.m1.1.1.1.1" xref="S4.SS3.SSS2.p4.1.m1.1.1.1.1.cmml">s</mi><mo id="S4.SS3.SSS2.p4.1.m1.2.2.2.4.1" xref="S4.SS3.SSS2.p4.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS3.SSS2.p4.1.m1.2.2.2.2" xref="S4.SS3.SSS2.p4.1.m1.2.2.2.2.cmml">n</mi></mrow><mi id="S4.SS3.SSS2.p4.1.m1.2.3.3" xref="S4.SS3.SSS2.p4.1.m1.2.3.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p4.1.m1.2b"><apply id="S4.SS3.SSS2.p4.1.m1.2.3.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p4.1.m1.2.3.1.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.3">superscript</csymbol><apply id="S4.SS3.SSS2.p4.1.m1.2.3.2.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p4.1.m1.2.3.2.1.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.3">subscript</csymbol><ci id="S4.SS3.SSS2.p4.1.m1.2.3.2.2.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.3.2.2">𝐸</ci><list id="S4.SS3.SSS2.p4.1.m1.2.2.2.3.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.2.2.4"><ci id="S4.SS3.SSS2.p4.1.m1.1.1.1.1.cmml" xref="S4.SS3.SSS2.p4.1.m1.1.1.1.1">𝑠</ci><ci id="S4.SS3.SSS2.p4.1.m1.2.2.2.2.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.2.2.2">𝑛</ci></list></apply><ci id="S4.SS3.SSS2.p4.1.m1.2.3.3.cmml" xref="S4.SS3.SSS2.p4.1.m1.2.3.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p4.1.m1.2c">E_{s,n}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p4.1.m1.2d">italic_E start_POSTSUBSCRIPT italic_s , italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>. Therefore, for each layer of the model, we employ the shared and layer-specific factors as input to generate the corresponding layer’s prompt through the Prompt Factorized Gate Network structure. The specific formula is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Phi_{l}^{u}=[E_{l,1}^{u}||E_{l,2}^{u},...,E_{l,N}^{u}||E_{s,1}^{u}||E_{s,2}^{%
u},...,E_{s,N}^{u}]," class="ltx_math_unparsed" display="block" id="S4.E7.m1.13"><semantics id="S4.E7.m1.13a"><mrow id="S4.E7.m1.13b"><msubsup id="S4.E7.m1.13.14"><mi id="S4.E7.m1.13.14.2.2" mathvariant="normal">Φ</mi><mi id="S4.E7.m1.13.14.2.3">l</mi><mi id="S4.E7.m1.13.14.3">u</mi></msubsup><mo id="S4.E7.m1.13.15">=</mo><mrow id="S4.E7.m1.13.16"><mo id="S4.E7.m1.13.16.1" stretchy="false">[</mo><msubsup id="S4.E7.m1.13.16.2"><mi id="S4.E7.m1.13.16.2.2.2">E</mi><mrow id="S4.E7.m1.2.2.2.4"><mi id="S4.E7.m1.1.1.1.1">l</mi><mo id="S4.E7.m1.2.2.2.4.1">,</mo><mn id="S4.E7.m1.2.2.2.2">1</mn></mrow><mi id="S4.E7.m1.13.16.2.3">u</mi></msubsup><mo fence="false" id="S4.E7.m1.13.16.3" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.E7.m1.13.16.4" rspace="0.167em" stretchy="false">|</mo><msubsup id="S4.E7.m1.13.16.5"><mi id="S4.E7.m1.13.16.5.2.2">E</mi><mrow id="S4.E7.m1.4.4.2.4"><mi id="S4.E7.m1.3.3.1.1">l</mi><mo id="S4.E7.m1.4.4.2.4.1">,</mo><mn id="S4.E7.m1.4.4.2.2">2</mn></mrow><mi id="S4.E7.m1.13.16.5.3">u</mi></msubsup><mo id="S4.E7.m1.13.16.6">,</mo><mi id="S4.E7.m1.13.13" mathvariant="normal">…</mi><mo id="S4.E7.m1.13.16.7">,</mo><msubsup id="S4.E7.m1.13.16.8"><mi id="S4.E7.m1.13.16.8.2.2">E</mi><mrow id="S4.E7.m1.6.6.2.4"><mi id="S4.E7.m1.5.5.1.1">l</mi><mo id="S4.E7.m1.6.6.2.4.1">,</mo><mi id="S4.E7.m1.6.6.2.2">N</mi></mrow><mi id="S4.E7.m1.13.16.8.3">u</mi></msubsup><mo fence="false" id="S4.E7.m1.13.16.9" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.E7.m1.13.16.10" rspace="0.167em" stretchy="false">|</mo><msubsup id="S4.E7.m1.13.16.11"><mi id="S4.E7.m1.13.16.11.2.2">E</mi><mrow id="S4.E7.m1.8.8.2.4"><mi id="S4.E7.m1.7.7.1.1">s</mi><mo id="S4.E7.m1.8.8.2.4.1">,</mo><mn id="S4.E7.m1.8.8.2.2">1</mn></mrow><mi id="S4.E7.m1.13.16.11.3">u</mi></msubsup><mo fence="false" id="S4.E7.m1.13.16.12" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S4.E7.m1.13.16.13" rspace="0.167em" stretchy="false">|</mo><msubsup id="S4.E7.m1.13.16.14"><mi id="S4.E7.m1.13.16.14.2.2">E</mi><mrow id="S4.E7.m1.10.10.2.4"><mi id="S4.E7.m1.9.9.1.1">s</mi><mo id="S4.E7.m1.10.10.2.4.1">,</mo><mn id="S4.E7.m1.10.10.2.2">2</mn></mrow><mi id="S4.E7.m1.13.16.14.3">u</mi></msubsup><mo id="S4.E7.m1.13.16.15">,</mo><mi id="S4.E7.m1.13.16.16" mathvariant="normal">…</mi><mo id="S4.E7.m1.13.16.17">,</mo><msubsup id="S4.E7.m1.13.16.18"><mi id="S4.E7.m1.13.16.18.2.2">E</mi><mrow id="S4.E7.m1.12.12.2.4"><mi id="S4.E7.m1.11.11.1.1">s</mi><mo id="S4.E7.m1.12.12.2.4.1">,</mo><mi id="S4.E7.m1.12.12.2.2">N</mi></mrow><mi id="S4.E7.m1.13.16.18.3">u</mi></msubsup><mo id="S4.E7.m1.13.16.19" stretchy="false">]</mo></mrow><mo id="S4.E7.m1.13.17">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E7.m1.13c">\Phi_{l}^{u}=[E_{l,1}^{u}||E_{l,2}^{u},...,E_{l,N}^{u}||E_{s,1}^{u}||E_{s,2}^{%
u},...,E_{s,N}^{u}],</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.13d">roman_Φ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = [ italic_E start_POSTSUBSCRIPT italic_l , 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | | italic_E start_POSTSUBSCRIPT italic_l , 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_E start_POSTSUBSCRIPT italic_l , italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | | italic_E start_POSTSUBSCRIPT italic_s , 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT | | italic_E start_POSTSUBSCRIPT italic_s , 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_E start_POSTSUBSCRIPT italic_s , italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\beta_{j}^{u}=\mathrm{softmax}\left(W_{l}\Phi_{u}\right),\quad p_{l}^{u}=\left%
(\sum_{j=1}^{2N}\beta_{j}^{u}E_{j}^{u}\right)," class="ltx_Math" display="block" id="S4.E8.m1.1"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1.1"><mrow id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.3.cmml"><mrow id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.1.1.3.2.2.cmml">β</mi><mi id="S4.E8.m1.1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.cmml">j</mi><mi id="S4.E8.m1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.3.3.cmml">u</mi></msubsup><mo id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.3.cmml">softmax</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">Φ</mi><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">u</mi></msub></mrow><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.1.1.1.1.2.3" rspace="1.167em" xref="S4.E8.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E8.m1.1.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.2.2.cmml"><msubsup id="S4.E8.m1.1.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.2.2.3.2.2" xref="S4.E8.m1.1.1.1.1.2.2.3.2.2.cmml">p</mi><mi id="S4.E8.m1.1.1.1.1.2.2.3.2.3" xref="S4.E8.m1.1.1.1.1.2.2.3.2.3.cmml">l</mi><mi id="S4.E8.m1.1.1.1.1.2.2.3.3" xref="S4.E8.m1.1.1.1.1.2.2.3.3.cmml">u</mi></msubsup><mo id="S4.E8.m1.1.1.1.1.2.2.2" xref="S4.E8.m1.1.1.1.1.2.2.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1.1.2.2.1.1" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.2.2.1.1.2" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.2.2.1.1.1" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.cmml"><munderover id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.2" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.2.cmml">j</mi><mo id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.1" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mn id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">2</mn><mo id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.1" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">N</mi></mrow></munderover><mrow id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.cmml"><msubsup id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.cmml"><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.2" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.2.cmml">β</mi><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.3.cmml">j</mi><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.1" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.1.cmml">⁢</mo><msubsup id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.2" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.2.cmml">E</mi><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.3.cmml">j</mi><mi id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml">u</mi></msubsup></mrow></mrow><mo id="S4.E8.m1.1.1.1.1.2.2.1.1.3" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3a.cmml" xref="S4.E8.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2"></eq><apply id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2.2">𝛽</ci><ci id="S4.E8.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S4.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.3">𝑢</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.2"></times><ci id="S4.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.3">softmax</ci><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.2">Φ</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑢</ci></apply></apply></apply></apply><apply id="S4.E8.m1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2"><eq id="S4.E8.m1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.2"></eq><apply id="S4.E8.m1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3.2.2">𝑝</ci><ci id="S4.E8.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3.2.3">𝑙</ci></apply><ci id="S4.E8.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.3.3">𝑢</ci></apply><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1"><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1">subscript</csymbol><sum id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.2"></sum><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3"><eq id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.1"></eq><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.2">𝑗</ci><cn id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3"><times id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.1"></times><cn id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" type="integer" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.2">2</cn><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2"><times id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.1"></times><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.2">𝛽</ci><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.2.3">𝑗</ci></apply><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.2.3">𝑢</ci></apply><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.2">𝐸</ci><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.2.3">𝑗</ci></apply><ci id="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.3.cmml" xref="S4.E8.m1.1.1.1.1.2.2.1.1.1.2.3.3">𝑢</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\beta_{j}^{u}=\mathrm{softmax}\left(W_{l}\Phi_{u}\right),\quad p_{l}^{u}=\left%
(\sum_{j=1}^{2N}\beta_{j}^{u}E_{j}^{u}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.1d">italic_β start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = roman_softmax ( italic_W start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT roman_Φ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) , italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_N end_POSTSUPERSCRIPT italic_β start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT italic_E start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p5">
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{l,c}^{u}=W_{l,c}p_{l}^{u}." class="ltx_Math" display="block" id="S4.E9.m1.5"><semantics id="S4.E9.m1.5a"><mrow id="S4.E9.m1.5.5.1" xref="S4.E9.m1.5.5.1.1.cmml"><mrow id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1.cmml"><msubsup id="S4.E9.m1.5.5.1.1.2" xref="S4.E9.m1.5.5.1.1.2.cmml"><mi id="S4.E9.m1.5.5.1.1.2.2.2" xref="S4.E9.m1.5.5.1.1.2.2.2.cmml">p</mi><mrow id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">l</mi><mo id="S4.E9.m1.2.2.2.4.1" xref="S4.E9.m1.2.2.2.3.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">c</mi></mrow><mi id="S4.E9.m1.5.5.1.1.2.3" xref="S4.E9.m1.5.5.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E9.m1.5.5.1.1.1" xref="S4.E9.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.5.5.1.1.3" xref="S4.E9.m1.5.5.1.1.3.cmml"><msub id="S4.E9.m1.5.5.1.1.3.2" xref="S4.E9.m1.5.5.1.1.3.2.cmml"><mi id="S4.E9.m1.5.5.1.1.3.2.2" xref="S4.E9.m1.5.5.1.1.3.2.2.cmml">W</mi><mrow id="S4.E9.m1.4.4.2.4" xref="S4.E9.m1.4.4.2.3.cmml"><mi id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml">l</mi><mo id="S4.E9.m1.4.4.2.4.1" xref="S4.E9.m1.4.4.2.3.cmml">,</mo><mi id="S4.E9.m1.4.4.2.2" xref="S4.E9.m1.4.4.2.2.cmml">c</mi></mrow></msub><mo id="S4.E9.m1.5.5.1.1.3.1" xref="S4.E9.m1.5.5.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E9.m1.5.5.1.1.3.3" xref="S4.E9.m1.5.5.1.1.3.3.cmml"><mi id="S4.E9.m1.5.5.1.1.3.3.2.2" xref="S4.E9.m1.5.5.1.1.3.3.2.2.cmml">p</mi><mi id="S4.E9.m1.5.5.1.1.3.3.2.3" xref="S4.E9.m1.5.5.1.1.3.3.2.3.cmml">l</mi><mi id="S4.E9.m1.5.5.1.1.3.3.3" xref="S4.E9.m1.5.5.1.1.3.3.3.cmml">u</mi></msubsup></mrow></mrow><mo id="S4.E9.m1.5.5.1.2" lspace="0em" xref="S4.E9.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.5b"><apply id="S4.E9.m1.5.5.1.1.cmml" xref="S4.E9.m1.5.5.1"><eq id="S4.E9.m1.5.5.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1"></eq><apply id="S4.E9.m1.5.5.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.2.1.cmml" xref="S4.E9.m1.5.5.1.1.2">superscript</csymbol><apply id="S4.E9.m1.5.5.1.1.2.2.cmml" xref="S4.E9.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.2.2.1.cmml" xref="S4.E9.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E9.m1.5.5.1.1.2.2.2.cmml" xref="S4.E9.m1.5.5.1.1.2.2.2">𝑝</ci><list id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.4"><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑙</ci><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">𝑐</ci></list></apply><ci id="S4.E9.m1.5.5.1.1.2.3.cmml" xref="S4.E9.m1.5.5.1.1.2.3">𝑢</ci></apply><apply id="S4.E9.m1.5.5.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.3"><times id="S4.E9.m1.5.5.1.1.3.1.cmml" xref="S4.E9.m1.5.5.1.1.3.1"></times><apply id="S4.E9.m1.5.5.1.1.3.2.cmml" xref="S4.E9.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.3.2.1.cmml" xref="S4.E9.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.5.5.1.1.3.2.2.cmml" xref="S4.E9.m1.5.5.1.1.3.2.2">𝑊</ci><list id="S4.E9.m1.4.4.2.3.cmml" xref="S4.E9.m1.4.4.2.4"><ci id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1">𝑙</ci><ci id="S4.E9.m1.4.4.2.2.cmml" xref="S4.E9.m1.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E9.m1.5.5.1.1.3.3.cmml" xref="S4.E9.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.3.3.1.cmml" xref="S4.E9.m1.5.5.1.1.3.3">superscript</csymbol><apply id="S4.E9.m1.5.5.1.1.3.3.2.cmml" xref="S4.E9.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.3.3.2.1.cmml" xref="S4.E9.m1.5.5.1.1.3.3">subscript</csymbol><ci id="S4.E9.m1.5.5.1.1.3.3.2.2.cmml" xref="S4.E9.m1.5.5.1.1.3.3.2.2">𝑝</ci><ci id="S4.E9.m1.5.5.1.1.3.3.2.3.cmml" xref="S4.E9.m1.5.5.1.1.3.3.2.3">𝑙</ci></apply><ci id="S4.E9.m1.5.5.1.1.3.3.3.cmml" xref="S4.E9.m1.5.5.1.1.3.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.5c">p_{l,c}^{u}=W_{l,c}p_{l}^{u}.</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.5d">italic_p start_POSTSUBSCRIPT italic_l , italic_c end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT = italic_W start_POSTSUBSCRIPT italic_l , italic_c end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p6">
<p class="ltx_p" id="S4.SS3.SSS2.p6.4">Finally, we obtain the prompt <math alttext="p_{l}^{u}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p6.1.m1.1"><semantics id="S4.SS3.SSS2.p6.1.m1.1a"><msubsup id="S4.SS3.SSS2.p6.1.m1.1.1" xref="S4.SS3.SSS2.p6.1.m1.1.1.cmml"><mi id="S4.SS3.SSS2.p6.1.m1.1.1.2.2" xref="S4.SS3.SSS2.p6.1.m1.1.1.2.2.cmml">p</mi><mi id="S4.SS3.SSS2.p6.1.m1.1.1.2.3" xref="S4.SS3.SSS2.p6.1.m1.1.1.2.3.cmml">l</mi><mi id="S4.SS3.SSS2.p6.1.m1.1.1.3" xref="S4.SS3.SSS2.p6.1.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p6.1.m1.1b"><apply id="S4.SS3.SSS2.p6.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p6.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1">superscript</csymbol><apply id="S4.SS3.SSS2.p6.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p6.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.p6.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1.2.2">𝑝</ci><ci id="S4.SS3.SSS2.p6.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1.2.3">𝑙</ci></apply><ci id="S4.SS3.SSS2.p6.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p6.1.m1.1c">p_{l}^{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p6.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> for user <math alttext="u" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p6.2.m2.1"><semantics id="S4.SS3.SSS2.p6.2.m2.1a"><mi id="S4.SS3.SSS2.p6.2.m2.1.1" xref="S4.SS3.SSS2.p6.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p6.2.m2.1b"><ci id="S4.SS3.SSS2.p6.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p6.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p6.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p6.2.m2.1d">italic_u</annotation></semantics></math> employed within layer <math alttext="l" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p6.3.m3.1"><semantics id="S4.SS3.SSS2.p6.3.m3.1a"><mi id="S4.SS3.SSS2.p6.3.m3.1.1" xref="S4.SS3.SSS2.p6.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p6.3.m3.1b"><ci id="S4.SS3.SSS2.p6.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p6.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p6.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p6.3.m3.1d">italic_l</annotation></semantics></math> of the pre-trained model and place the prompt in the first <math alttext="C" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p6.4.m4.1"><semantics id="S4.SS3.SSS2.p6.4.m4.1a"><mi id="S4.SS3.SSS2.p6.4.m4.1.1" xref="S4.SS3.SSS2.p6.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p6.4.m4.1b"><ci id="S4.SS3.SSS2.p6.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p6.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p6.4.m4.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p6.4.m4.1d">italic_C</annotation></semantics></math> tokens which are analyzed in the hyperparameter experiment.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Prompt Diversity</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.1">However, the prompts of different layers in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.E6" title="In 4.3.2 Prompt Progressiveness ‣ 4.3 Customized Prompt Tuning ‣ 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>) tend to be easily assimilated, because the information sources generating the prompts are consistent. Although we designed the PFG to fully decouple and fuse the prompt information, it is still challenging to guarantee the process of prompt generation is controllable. To further ensure the diversity of prompts, we introduce a regularization loss based on representation compactness <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib57" title="">57</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS3.p2">
<p class="ltx_p" id="S4.SS3.SSS3.p2.3">Compactness is a desired trait of intra-factor representations and its opposite is what we expect for inter-factor representations. ReduNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib58" title="">58</a>]</cite> proposed to measure compactness of representation with rate-distortion <math alttext="R(z,\epsilon)" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p2.1.m1.2"><semantics id="S4.SS3.SSS3.p2.1.m1.2a"><mrow id="S4.SS3.SSS3.p2.1.m1.2.3" xref="S4.SS3.SSS3.p2.1.m1.2.3.cmml"><mi id="S4.SS3.SSS3.p2.1.m1.2.3.2" xref="S4.SS3.SSS3.p2.1.m1.2.3.2.cmml">R</mi><mo id="S4.SS3.SSS3.p2.1.m1.2.3.1" xref="S4.SS3.SSS3.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.SSS3.p2.1.m1.2.3.3.2" xref="S4.SS3.SSS3.p2.1.m1.2.3.3.1.cmml"><mo id="S4.SS3.SSS3.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS3.SSS3.p2.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS3.SSS3.p2.1.m1.1.1" xref="S4.SS3.SSS3.p2.1.m1.1.1.cmml">z</mi><mo id="S4.SS3.SSS3.p2.1.m1.2.3.3.2.2" xref="S4.SS3.SSS3.p2.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS3.SSS3.p2.1.m1.2.2" xref="S4.SS3.SSS3.p2.1.m1.2.2.cmml">ϵ</mi><mo id="S4.SS3.SSS3.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS3.SSS3.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p2.1.m1.2b"><apply id="S4.SS3.SSS3.p2.1.m1.2.3.cmml" xref="S4.SS3.SSS3.p2.1.m1.2.3"><times id="S4.SS3.SSS3.p2.1.m1.2.3.1.cmml" xref="S4.SS3.SSS3.p2.1.m1.2.3.1"></times><ci id="S4.SS3.SSS3.p2.1.m1.2.3.2.cmml" xref="S4.SS3.SSS3.p2.1.m1.2.3.2">𝑅</ci><interval closure="open" id="S4.SS3.SSS3.p2.1.m1.2.3.3.1.cmml" xref="S4.SS3.SSS3.p2.1.m1.2.3.3.2"><ci id="S4.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS3.p2.1.m1.1.1">𝑧</ci><ci id="S4.SS3.SSS3.p2.1.m1.2.2.cmml" xref="S4.SS3.SSS3.p2.1.m1.2.2">italic-ϵ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p2.1.m1.2c">R(z,\epsilon)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p2.1.m1.2d">italic_R ( italic_z , italic_ϵ )</annotation></semantics></math>, which determines the minimal number of bits to encode a random variable <math alttext="z" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p2.2.m2.1"><semantics id="S4.SS3.SSS3.p2.2.m2.1a"><mi id="S4.SS3.SSS3.p2.2.m2.1.1" xref="S4.SS3.SSS3.p2.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p2.2.m2.1b"><ci id="S4.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS3.p2.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p2.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p2.2.m2.1d">italic_z</annotation></semantics></math> subject to a decoding error upper bounded by <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p2.3.m3.1"><semantics id="S4.SS3.SSS3.p2.3.m3.1a"><mi id="S4.SS3.SSS3.p2.3.m3.1.1" xref="S4.SS3.SSS3.p2.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p2.3.m3.1b"><ci id="S4.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS3.p2.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p2.3.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p2.3.m3.1d">italic_ϵ</annotation></semantics></math>. Inspired by this, we design a compactness regularization loss function to control the diversity of the prompt vector space. Ideally, diversity should be maintained between prompt factors, and between prompts across layers for each user. The specific formula is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R(\mathcal{E},\epsilon)=\frac{1}{2}\log\mathrm{det}\left(I+\frac{d}{N\epsilon^%
{2}}\mathcal{E}\mathcal{E}^{T}\right)," class="ltx_Math" display="block" id="S4.E10.m1.3"><semantics id="S4.E10.m1.3a"><mrow id="S4.E10.m1.3.3.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1.3" xref="S4.E10.m1.3.3.1.1.3.cmml"><mi id="S4.E10.m1.3.3.1.1.3.2" xref="S4.E10.m1.3.3.1.1.3.2.cmml">R</mi><mo id="S4.E10.m1.3.3.1.1.3.1" xref="S4.E10.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.3.3.2" xref="S4.E10.m1.3.3.1.1.3.3.1.cmml"><mo id="S4.E10.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml">ℰ</mi><mo id="S4.E10.m1.3.3.1.1.3.3.2.2" xref="S4.E10.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml">ϵ</mi><mo id="S4.E10.m1.3.3.1.1.3.3.2.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.1.1.2" xref="S4.E10.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E10.m1.3.3.1.1.1" xref="S4.E10.m1.3.3.1.1.1.cmml"><mfrac id="S4.E10.m1.3.3.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.3.cmml"><mn id="S4.E10.m1.3.3.1.1.1.3.2" xref="S4.E10.m1.3.3.1.1.1.3.2.cmml">1</mn><mn id="S4.E10.m1.3.3.1.1.1.3.3" xref="S4.E10.m1.3.3.1.1.1.3.3.cmml">2</mn></mfrac><mo id="S4.E10.m1.3.3.1.1.1.2" lspace="0.167em" xref="S4.E10.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.1.4" xref="S4.E10.m1.3.3.1.1.1.4.cmml"><mi id="S4.E10.m1.3.3.1.1.1.4.1" xref="S4.E10.m1.3.3.1.1.1.4.1.cmml">log</mi><mo id="S4.E10.m1.3.3.1.1.1.4a" lspace="0.167em" xref="S4.E10.m1.3.3.1.1.1.4.cmml">⁡</mo><mi id="S4.E10.m1.3.3.1.1.1.4.2" xref="S4.E10.m1.3.3.1.1.1.4.2.cmml">det</mi></mrow><mo id="S4.E10.m1.3.3.1.1.1.2a" xref="S4.E10.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.3.3.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml">I</mi><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml"><mfrac id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">d</mi><mrow id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.2.cmml">N</mi><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><msup id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.2.cmml">ϵ</mi><mn id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.3.cmml">2</mn></msup></mrow></mfrac><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.3.cmml">ℰ</mi><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.3.1a" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S4.E10.m1.3.3.1.1.1.1.1.1.3.4" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.2.cmml">ℰ</mi><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.3.cmml">T</mi></msup></mrow></mrow><mo id="S4.E10.m1.3.3.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E10.m1.3.3.1.2" xref="S4.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.3b"><apply id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1"><eq id="S4.E10.m1.3.3.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2"></eq><apply id="S4.E10.m1.3.3.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.3"><times id="S4.E10.m1.3.3.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.3.1"></times><ci id="S4.E10.m1.3.3.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2">𝑅</ci><interval closure="open" id="S4.E10.m1.3.3.1.1.3.3.1.cmml" xref="S4.E10.m1.3.3.1.1.3.3.2"><ci id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1">ℰ</ci><ci id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2">italic-ϵ</ci></interval></apply><apply id="S4.E10.m1.3.3.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1"><times id="S4.E10.m1.3.3.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.2"></times><apply id="S4.E10.m1.3.3.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.3"><divide id="S4.E10.m1.3.3.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.3"></divide><cn id="S4.E10.m1.3.3.1.1.1.3.2.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.1.3.2">1</cn><cn id="S4.E10.m1.3.3.1.1.1.3.3.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.1.3.3">2</cn></apply><apply id="S4.E10.m1.3.3.1.1.1.4.cmml" xref="S4.E10.m1.3.3.1.1.1.4"><log id="S4.E10.m1.3.3.1.1.1.4.1.cmml" xref="S4.E10.m1.3.3.1.1.1.4.1"></log><ci id="S4.E10.m1.3.3.1.1.1.4.2.cmml" xref="S4.E10.m1.3.3.1.1.1.4.2">det</ci></apply><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1"><plus id="S4.E10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1"></plus><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2">𝐼</ci><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3"><times id="S4.E10.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.1"></times><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2"><divide id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2"></divide><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.2">𝑑</ci><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3"><times id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.2">𝑁</ci><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3">superscript</csymbol><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.2">italic-ϵ</ci><cn id="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.3.cmml" type="integer" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.2.3.3.3">2</cn></apply></apply></apply><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.3">ℰ</ci><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.4">superscript</csymbol><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.2">ℰ</ci><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.4.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.3c">R(\mathcal{E},\epsilon)=\frac{1}{2}\log\mathrm{det}\left(I+\frac{d}{N\epsilon^%
{2}}\mathcal{E}\mathcal{E}^{T}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.3d">italic_R ( caligraphic_E , italic_ϵ ) = divide start_ARG 1 end_ARG start_ARG 2 end_ARG roman_log roman_det ( italic_I + divide start_ARG italic_d end_ARG start_ARG italic_N italic_ϵ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG caligraphic_E caligraphic_E start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.SSS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R(\mathcal{P},\epsilon)=\frac{1}{2}\log\mathrm{det}\left(I+\frac{d}{L\epsilon^%
{2}}\mathcal{P}\mathcal{P}^{T}\right)," class="ltx_Math" display="block" id="S4.E11.m1.3"><semantics id="S4.E11.m1.3a"><mrow id="S4.E11.m1.3.3.1" xref="S4.E11.m1.3.3.1.1.cmml"><mrow id="S4.E11.m1.3.3.1.1" xref="S4.E11.m1.3.3.1.1.cmml"><mrow id="S4.E11.m1.3.3.1.1.3" xref="S4.E11.m1.3.3.1.1.3.cmml"><mi id="S4.E11.m1.3.3.1.1.3.2" xref="S4.E11.m1.3.3.1.1.3.2.cmml">R</mi><mo id="S4.E11.m1.3.3.1.1.3.1" xref="S4.E11.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S4.E11.m1.3.3.1.1.3.3.2" xref="S4.E11.m1.3.3.1.1.3.3.1.cmml"><mo id="S4.E11.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S4.E11.m1.3.3.1.1.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml">𝒫</mi><mo id="S4.E11.m1.3.3.1.1.3.3.2.2" xref="S4.E11.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml">ϵ</mi><mo id="S4.E11.m1.3.3.1.1.3.3.2.3" stretchy="false" xref="S4.E11.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.3.3.1.1.2" xref="S4.E11.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E11.m1.3.3.1.1.1" xref="S4.E11.m1.3.3.1.1.1.cmml"><mfrac id="S4.E11.m1.3.3.1.1.1.3" xref="S4.E11.m1.3.3.1.1.1.3.cmml"><mn id="S4.E11.m1.3.3.1.1.1.3.2" xref="S4.E11.m1.3.3.1.1.1.3.2.cmml">1</mn><mn id="S4.E11.m1.3.3.1.1.1.3.3" xref="S4.E11.m1.3.3.1.1.1.3.3.cmml">2</mn></mfrac><mo id="S4.E11.m1.3.3.1.1.1.2" lspace="0.167em" xref="S4.E11.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.3.3.1.1.1.4" xref="S4.E11.m1.3.3.1.1.1.4.cmml"><mi id="S4.E11.m1.3.3.1.1.1.4.1" xref="S4.E11.m1.3.3.1.1.1.4.1.cmml">log</mi><mo id="S4.E11.m1.3.3.1.1.1.4a" lspace="0.167em" xref="S4.E11.m1.3.3.1.1.1.4.cmml">⁡</mo><mi id="S4.E11.m1.3.3.1.1.1.4.2" xref="S4.E11.m1.3.3.1.1.1.4.2.cmml">det</mi></mrow><mo id="S4.E11.m1.3.3.1.1.1.2a" xref="S4.E11.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.3.3.1.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.3.3.1.1.1.1.1.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.3.3.1.1.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.1.1.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.2.cmml">I</mi><mo id="S4.E11.m1.3.3.1.1.1.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E11.m1.3.3.1.1.1.1.1.1.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.cmml"><mfrac id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">d</mi><mrow id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.2.cmml">L</mi><mo id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.1" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><msup id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.2.cmml">ϵ</mi><mn id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.3.cmml">2</mn></msup></mrow></mfrac><mo id="S4.E11.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.3.cmml">𝒫</mi><mo id="S4.E11.m1.3.3.1.1.1.1.1.1.3.1a" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S4.E11.m1.3.3.1.1.1.1.1.1.3.4" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.2.cmml">𝒫</mi><mi id="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.3.cmml">T</mi></msup></mrow></mrow><mo id="S4.E11.m1.3.3.1.1.1.1.1.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E11.m1.3.3.1.2" xref="S4.E11.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.3b"><apply id="S4.E11.m1.3.3.1.1.cmml" xref="S4.E11.m1.3.3.1"><eq id="S4.E11.m1.3.3.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.2"></eq><apply id="S4.E11.m1.3.3.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.3"><times id="S4.E11.m1.3.3.1.1.3.1.cmml" xref="S4.E11.m1.3.3.1.1.3.1"></times><ci id="S4.E11.m1.3.3.1.1.3.2.cmml" xref="S4.E11.m1.3.3.1.1.3.2">𝑅</ci><interval closure="open" id="S4.E11.m1.3.3.1.1.3.3.1.cmml" xref="S4.E11.m1.3.3.1.1.3.3.2"><ci id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1">𝒫</ci><ci id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2">italic-ϵ</ci></interval></apply><apply id="S4.E11.m1.3.3.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1"><times id="S4.E11.m1.3.3.1.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1.2"></times><apply id="S4.E11.m1.3.3.1.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.1.3"><divide id="S4.E11.m1.3.3.1.1.1.3.1.cmml" xref="S4.E11.m1.3.3.1.1.1.3"></divide><cn id="S4.E11.m1.3.3.1.1.1.3.2.cmml" type="integer" xref="S4.E11.m1.3.3.1.1.1.3.2">1</cn><cn id="S4.E11.m1.3.3.1.1.1.3.3.cmml" type="integer" xref="S4.E11.m1.3.3.1.1.1.3.3">2</cn></apply><apply id="S4.E11.m1.3.3.1.1.1.4.cmml" xref="S4.E11.m1.3.3.1.1.1.4"><log id="S4.E11.m1.3.3.1.1.1.4.1.cmml" xref="S4.E11.m1.3.3.1.1.1.4.1"></log><ci id="S4.E11.m1.3.3.1.1.1.4.2.cmml" xref="S4.E11.m1.3.3.1.1.1.4.2">det</ci></apply><apply id="S4.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1"><plus id="S4.E11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1"></plus><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.2">𝐼</ci><apply id="S4.E11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3"><times id="S4.E11.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.1"></times><apply id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2"><divide id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2"></divide><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.2">𝑑</ci><apply id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3"><times id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.2">𝐿</ci><apply id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3">superscript</csymbol><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.2">italic-ϵ</ci><cn id="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.3.cmml" type="integer" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.2.3.3.3">2</cn></apply></apply></apply><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.3">𝒫</ci><apply id="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.4">superscript</csymbol><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.2">𝒫</ci><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.3.4.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.3c">R(\mathcal{P},\epsilon)=\frac{1}{2}\log\mathrm{det}\left(I+\frac{d}{L\epsilon^%
{2}}\mathcal{P}\mathcal{P}^{T}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.3d">italic_R ( caligraphic_P , italic_ϵ ) = divide start_ARG 1 end_ARG start_ARG 2 end_ARG roman_log roman_det ( italic_I + divide start_ARG italic_d end_ARG start_ARG italic_L italic_ϵ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG caligraphic_P caligraphic_P start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS3.p3.4">where <math alttext="\mathcal{E}\in\mathbb{R}^{|N\times(L+1)|\times d}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p3.1.m1.1"><semantics id="S4.SS3.SSS3.p3.1.m1.1a"><mrow id="S4.SS3.SSS3.p3.1.m1.1.2" xref="S4.SS3.SSS3.p3.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p3.1.m1.1.2.2" xref="S4.SS3.SSS3.p3.1.m1.1.2.2.cmml">ℰ</mi><mo id="S4.SS3.SSS3.p3.1.m1.1.2.1" xref="S4.SS3.SSS3.p3.1.m1.1.2.1.cmml">∈</mo><msup id="S4.SS3.SSS3.p3.1.m1.1.2.3" xref="S4.SS3.SSS3.p3.1.m1.1.2.3.cmml"><mi id="S4.SS3.SSS3.p3.1.m1.1.2.3.2" xref="S4.SS3.SSS3.p3.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS3.SSS3.p3.1.m1.1.1.1" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.cmml"><mrow id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.2.cmml"><mo id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3.cmml">N</mi><mo id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.cmml">×</mo><mrow id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mo id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS3.SSS3.p3.1.m1.1.1.1.2" rspace="0.222em" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.2.cmml">×</mo><mi id="S4.SS3.SSS3.p3.1.m1.1.1.1.3" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p3.1.m1.1b"><apply id="S4.SS3.SSS3.p3.1.m1.1.2.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.2"><in id="S4.SS3.SSS3.p3.1.m1.1.2.1.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.2.1"></in><ci id="S4.SS3.SSS3.p3.1.m1.1.2.2.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.2.2">ℰ</ci><apply id="S4.SS3.SSS3.p3.1.m1.1.2.3.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p3.1.m1.1.2.3.1.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.2.3">superscript</csymbol><ci id="S4.SS3.SSS3.p3.1.m1.1.2.3.2.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.2.3.2">ℝ</ci><apply id="S4.SS3.SSS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1"><times id="S4.SS3.SSS3.p3.1.m1.1.1.1.2.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.2"></times><apply id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1"><abs id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.2"></abs><apply id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1"><times id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.2"></times><ci id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.3">𝑁</ci><apply id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1"><plus id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.2">𝐿</ci><cn id="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><ci id="S4.SS3.SSS3.p3.1.m1.1.1.1.3.cmml" xref="S4.SS3.SSS3.p3.1.m1.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p3.1.m1.1c">\mathcal{E}\in\mathbb{R}^{|N\times(L+1)|\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p3.1.m1.1d">caligraphic_E ∈ blackboard_R start_POSTSUPERSCRIPT | italic_N × ( italic_L + 1 ) | × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the prompt factors matrix, <math alttext="\mathcal{P}\in\mathbb{R}^{|L|\times d}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p3.2.m2.1"><semantics id="S4.SS3.SSS3.p3.2.m2.1a"><mrow id="S4.SS3.SSS3.p3.2.m2.1.2" xref="S4.SS3.SSS3.p3.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p3.2.m2.1.2.2" xref="S4.SS3.SSS3.p3.2.m2.1.2.2.cmml">𝒫</mi><mo id="S4.SS3.SSS3.p3.2.m2.1.2.1" xref="S4.SS3.SSS3.p3.2.m2.1.2.1.cmml">∈</mo><msup id="S4.SS3.SSS3.p3.2.m2.1.2.3" xref="S4.SS3.SSS3.p3.2.m2.1.2.3.cmml"><mi id="S4.SS3.SSS3.p3.2.m2.1.2.3.2" xref="S4.SS3.SSS3.p3.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS3.SSS3.p3.2.m2.1.1.1" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.cmml"><mrow id="S4.SS3.SSS3.p3.2.m2.1.1.1.3.2" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.3.1.cmml"><mo id="S4.SS3.SSS3.p3.2.m2.1.1.1.3.2.1" stretchy="false" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.3.1.1.cmml">|</mo><mi id="S4.SS3.SSS3.p3.2.m2.1.1.1.1" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.1.cmml">L</mi><mo id="S4.SS3.SSS3.p3.2.m2.1.1.1.3.2.2" rspace="0.055em" stretchy="false" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS3.SSS3.p3.2.m2.1.1.1.2" rspace="0.222em" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.2.cmml">×</mo><mi id="S4.SS3.SSS3.p3.2.m2.1.1.1.4" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.4.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p3.2.m2.1b"><apply id="S4.SS3.SSS3.p3.2.m2.1.2.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.2"><in id="S4.SS3.SSS3.p3.2.m2.1.2.1.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.2.1"></in><ci id="S4.SS3.SSS3.p3.2.m2.1.2.2.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.2.2">𝒫</ci><apply id="S4.SS3.SSS3.p3.2.m2.1.2.3.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p3.2.m2.1.2.3.1.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.2.3">superscript</csymbol><ci id="S4.SS3.SSS3.p3.2.m2.1.2.3.2.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.2.3.2">ℝ</ci><apply id="S4.SS3.SSS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.1.1"><times id="S4.SS3.SSS3.p3.2.m2.1.1.1.2.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.2"></times><apply id="S4.SS3.SSS3.p3.2.m2.1.1.1.3.1.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.3.2"><abs id="S4.SS3.SSS3.p3.2.m2.1.1.1.3.1.1.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.3.2.1"></abs><ci id="S4.SS3.SSS3.p3.2.m2.1.1.1.1.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.1">𝐿</ci></apply><ci id="S4.SS3.SSS3.p3.2.m2.1.1.1.4.cmml" xref="S4.SS3.SSS3.p3.2.m2.1.1.1.4">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p3.2.m2.1c">\mathcal{P}\in\mathbb{R}^{|L|\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p3.2.m2.1d">caligraphic_P ∈ blackboard_R start_POSTSUPERSCRIPT | italic_L | × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the prompt matrix, and the rest are hyperparameters. <math alttext="logdet(\cdot)" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p3.3.m3.1"><semantics id="S4.SS3.SSS3.p3.3.m3.1a"><mrow id="S4.SS3.SSS3.p3.3.m3.1.2" xref="S4.SS3.SSS3.p3.3.m3.1.2.cmml"><mi id="S4.SS3.SSS3.p3.3.m3.1.2.2" xref="S4.SS3.SSS3.p3.3.m3.1.2.2.cmml">l</mi><mo id="S4.SS3.SSS3.p3.3.m3.1.2.1" xref="S4.SS3.SSS3.p3.3.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.3.m3.1.2.3" xref="S4.SS3.SSS3.p3.3.m3.1.2.3.cmml">o</mi><mo id="S4.SS3.SSS3.p3.3.m3.1.2.1a" xref="S4.SS3.SSS3.p3.3.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.3.m3.1.2.4" xref="S4.SS3.SSS3.p3.3.m3.1.2.4.cmml">g</mi><mo id="S4.SS3.SSS3.p3.3.m3.1.2.1b" xref="S4.SS3.SSS3.p3.3.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.3.m3.1.2.5" xref="S4.SS3.SSS3.p3.3.m3.1.2.5.cmml">d</mi><mo id="S4.SS3.SSS3.p3.3.m3.1.2.1c" xref="S4.SS3.SSS3.p3.3.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.3.m3.1.2.6" xref="S4.SS3.SSS3.p3.3.m3.1.2.6.cmml">e</mi><mo id="S4.SS3.SSS3.p3.3.m3.1.2.1d" xref="S4.SS3.SSS3.p3.3.m3.1.2.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.3.m3.1.2.7" xref="S4.SS3.SSS3.p3.3.m3.1.2.7.cmml">t</mi><mo id="S4.SS3.SSS3.p3.3.m3.1.2.1e" xref="S4.SS3.SSS3.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS3.p3.3.m3.1.2.8.2" xref="S4.SS3.SSS3.p3.3.m3.1.2.cmml"><mo id="S4.SS3.SSS3.p3.3.m3.1.2.8.2.1" stretchy="false" xref="S4.SS3.SSS3.p3.3.m3.1.2.cmml">(</mo><mo id="S4.SS3.SSS3.p3.3.m3.1.1" lspace="0em" rspace="0em" xref="S4.SS3.SSS3.p3.3.m3.1.1.cmml">⋅</mo><mo id="S4.SS3.SSS3.p3.3.m3.1.2.8.2.2" stretchy="false" xref="S4.SS3.SSS3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p3.3.m3.1b"><apply id="S4.SS3.SSS3.p3.3.m3.1.2.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2"><times id="S4.SS3.SSS3.p3.3.m3.1.2.1.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2.1"></times><ci id="S4.SS3.SSS3.p3.3.m3.1.2.2.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2.2">𝑙</ci><ci id="S4.SS3.SSS3.p3.3.m3.1.2.3.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2.3">𝑜</ci><ci id="S4.SS3.SSS3.p3.3.m3.1.2.4.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2.4">𝑔</ci><ci id="S4.SS3.SSS3.p3.3.m3.1.2.5.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2.5">𝑑</ci><ci id="S4.SS3.SSS3.p3.3.m3.1.2.6.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2.6">𝑒</ci><ci id="S4.SS3.SSS3.p3.3.m3.1.2.7.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.2.7">𝑡</ci><ci id="S4.SS3.SSS3.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS3.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p3.3.m3.1c">logdet(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p3.3.m3.1d">italic_l italic_o italic_g italic_d italic_e italic_t ( ⋅ )</annotation></semantics></math> means the logarithm of the determinant of a matrix and <math alttext="I" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p3.4.m4.1"><semantics id="S4.SS3.SSS3.p3.4.m4.1a"><mi id="S4.SS3.SSS3.p3.4.m4.1.1" xref="S4.SS3.SSS3.p3.4.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p3.4.m4.1b"><ci id="S4.SS3.SSS3.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS3.p3.4.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p3.4.m4.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p3.4.m4.1d">italic_I</annotation></semantics></math> is the identity matrix. Finally, we can obtain our compactness regularization loss as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{{compactness}}=\sum_{u_{i}\in U}[\lambda_{e}R(\mathcal{E}_{i},%
\epsilon_{e})+\lambda_{p}R(\mathcal{P}_{i},\epsilon_{p})]." class="ltx_Math" display="block" id="S4.E12.m1.1"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><msub id="S4.E12.m1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E12.m1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.3.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.3.2" xref="S4.E12.m1.1.1.1.1.3.3.2.cmml">c</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.3" xref="S4.E12.m1.1.1.1.1.3.3.3.cmml">o</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1a" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.4" xref="S4.E12.m1.1.1.1.1.3.3.4.cmml">m</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1b" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.5" xref="S4.E12.m1.1.1.1.1.3.3.5.cmml">p</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1c" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.6" xref="S4.E12.m1.1.1.1.1.3.3.6.cmml">a</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1d" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.7" xref="S4.E12.m1.1.1.1.1.3.3.7.cmml">c</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1e" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.8" xref="S4.E12.m1.1.1.1.1.3.3.8.cmml">t</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1f" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.9" xref="S4.E12.m1.1.1.1.1.3.3.9.cmml">n</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1g" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.10" xref="S4.E12.m1.1.1.1.1.3.3.10.cmml">e</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1h" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.11" xref="S4.E12.m1.1.1.1.1.3.3.11.cmml">s</mi><mo id="S4.E12.m1.1.1.1.1.3.3.1i" xref="S4.E12.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.3.3.12" xref="S4.E12.m1.1.1.1.1.3.3.12.cmml">s</mi></mrow></msub><mo id="S4.E12.m1.1.1.1.1.2" rspace="0.111em" xref="S4.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E12.m1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.cmml"><munder id="S4.E12.m1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.2.cmml"><mo id="S4.E12.m1.1.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S4.E12.m1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E12.m1.1.1.1.1.1.2.3" xref="S4.E12.m1.1.1.1.1.1.2.3.cmml"><msub id="S4.E12.m1.1.1.1.1.1.2.3.2" xref="S4.E12.m1.1.1.1.1.1.2.3.2.cmml"><mi id="S4.E12.m1.1.1.1.1.1.2.3.2.2" xref="S4.E12.m1.1.1.1.1.1.2.3.2.2.cmml">u</mi><mi id="S4.E12.m1.1.1.1.1.1.2.3.2.3" xref="S4.E12.m1.1.1.1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.2.3.1" xref="S4.E12.m1.1.1.1.1.1.2.3.1.cmml">∈</mo><mi id="S4.E12.m1.1.1.1.1.1.2.3.3" xref="S4.E12.m1.1.1.1.1.1.2.3.3.cmml">U</mi></mrow></munder><mrow id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.2.4" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.2.cmml">λ</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.3.cmml">e</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.2.5" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.5.cmml">R</mi><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.2.3a" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">ℰ</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">ϵ</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">e</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.5" xref="S4.E12.m1.1.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1.4" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.cmml"><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.4.4" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.2.cmml">λ</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.3.cmml">p</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.4.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.4.5" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.5.cmml">R</mi><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.4.3a" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.3.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml">𝒫</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml">i</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.4" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msub id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.2.cmml">ϵ</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.3.cmml">p</mi></msub><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.5" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E12.m1.1.1.1.2" lspace="0em" xref="S4.E12.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><eq id="S4.E12.m1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2"></eq><apply id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E12.m1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3"><times id="S4.E12.m1.1.1.1.1.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.3.1"></times><ci id="S4.E12.m1.1.1.1.1.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.3.2">𝑐</ci><ci id="S4.E12.m1.1.1.1.1.3.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3.3">𝑜</ci><ci id="S4.E12.m1.1.1.1.1.3.3.4.cmml" xref="S4.E12.m1.1.1.1.1.3.3.4">𝑚</ci><ci id="S4.E12.m1.1.1.1.1.3.3.5.cmml" xref="S4.E12.m1.1.1.1.1.3.3.5">𝑝</ci><ci id="S4.E12.m1.1.1.1.1.3.3.6.cmml" xref="S4.E12.m1.1.1.1.1.3.3.6">𝑎</ci><ci id="S4.E12.m1.1.1.1.1.3.3.7.cmml" xref="S4.E12.m1.1.1.1.1.3.3.7">𝑐</ci><ci id="S4.E12.m1.1.1.1.1.3.3.8.cmml" xref="S4.E12.m1.1.1.1.1.3.3.8">𝑡</ci><ci id="S4.E12.m1.1.1.1.1.3.3.9.cmml" xref="S4.E12.m1.1.1.1.1.3.3.9">𝑛</ci><ci id="S4.E12.m1.1.1.1.1.3.3.10.cmml" xref="S4.E12.m1.1.1.1.1.3.3.10">𝑒</ci><ci id="S4.E12.m1.1.1.1.1.3.3.11.cmml" xref="S4.E12.m1.1.1.1.1.3.3.11">𝑠</ci><ci id="S4.E12.m1.1.1.1.1.3.3.12.cmml" xref="S4.E12.m1.1.1.1.1.3.3.12">𝑠</ci></apply></apply><apply id="S4.E12.m1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1"><apply id="S4.E12.m1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E12.m1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.2.2"></sum><apply id="S4.E12.m1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.2.3"><in id="S4.E12.m1.1.1.1.1.1.2.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.2.3.1"></in><apply id="S4.E12.m1.1.1.1.1.1.2.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.2.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.2.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.2.3.2.2">𝑢</ci><ci id="S4.E12.m1.1.1.1.1.1.2.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.2.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.2.3.3">𝑈</ci></apply></apply><apply id="S4.E12.m1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1"><plus id="S4.E12.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.5"></plus><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2"><times id="S4.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.3"></times><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.2">𝜆</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.4.3">𝑒</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.2.5.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.5">𝑅</ci><interval closure="open" id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">ℰ</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2">italic-ϵ</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑒</ci></apply></interval></apply><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4"><times id="S4.E12.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.3"></times><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.2">𝜆</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.4.3">𝑝</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.4.5.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.5">𝑅</ci><interval closure="open" id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2"><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.2">𝒫</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.3.1.1.1.3">𝑖</ci></apply><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.2">italic-ϵ</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.4.2.2.2.3">𝑝</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\mathcal{L}_{{compactness}}=\sum_{u_{i}\in U}[\lambda_{e}R(\mathcal{E}_{i},%
\epsilon_{e})+\lambda_{p}R(\mathcal{P}_{i},\epsilon_{p})].</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_o italic_m italic_p italic_a italic_c italic_t italic_n italic_e italic_s italic_s end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_U end_POSTSUBSCRIPT [ italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_R ( caligraphic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_ϵ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ) + italic_λ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_R ( caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_ϵ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS3.p3.8">Through the compactness regularization loss, we ensure diversity in prompt factors and the final prompt vector across different layers. This guarantees that prompts from the same personalized information at different layers meet the criteria of progression. This is because it reinforces the understanding that prompts at different layers are distinct, aligning with the assumption of continuous refinement of interests across the model’s layers.
Consequently, the total loss of the prompt-tuning stage can be derived as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{total}=\mathcal{L}_{pred}+\lambda\mathcal{L}_{compactness}," class="ltx_Math" display="block" id="S4.E13.m1.1"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><msub id="S4.E13.m1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.2.2" xref="S4.E13.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E13.m1.1.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1.2.3.2" xref="S4.E13.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E13.m1.1.1.1.1.2.3.1" xref="S4.E13.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.2.3.3" xref="S4.E13.m1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S4.E13.m1.1.1.1.1.2.3.1a" xref="S4.E13.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.2.3.4" xref="S4.E13.m1.1.1.1.1.2.3.4.cmml">t</mi><mo id="S4.E13.m1.1.1.1.1.2.3.1b" xref="S4.E13.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.2.3.5" xref="S4.E13.m1.1.1.1.1.2.3.5.cmml">a</mi><mo id="S4.E13.m1.1.1.1.1.2.3.1c" xref="S4.E13.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.2.3.6" xref="S4.E13.m1.1.1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.3.cmml"><msub id="S4.E13.m1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.3.2.2" xref="S4.E13.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S4.E13.m1.1.1.1.1.3.2.3" xref="S4.E13.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1.3.2.3.2" xref="S4.E13.m1.1.1.1.1.3.2.3.2.cmml">p</mi><mo id="S4.E13.m1.1.1.1.1.3.2.3.1" xref="S4.E13.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.2.3.3" xref="S4.E13.m1.1.1.1.1.3.2.3.3.cmml">r</mi><mo id="S4.E13.m1.1.1.1.1.3.2.3.1a" xref="S4.E13.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.2.3.4" xref="S4.E13.m1.1.1.1.1.3.2.3.4.cmml">e</mi><mo id="S4.E13.m1.1.1.1.1.3.2.3.1b" xref="S4.E13.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.2.3.5" xref="S4.E13.m1.1.1.1.1.3.2.3.5.cmml">d</mi></mrow></msub><mo id="S4.E13.m1.1.1.1.1.3.1" xref="S4.E13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E13.m1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.3.3.cmml"><mi id="S4.E13.m1.1.1.1.1.3.3.2" xref="S4.E13.m1.1.1.1.1.3.3.2.cmml">λ</mi><mo id="S4.E13.m1.1.1.1.1.3.3.1" xref="S4.E13.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S4.E13.m1.1.1.1.1.3.3.3" xref="S4.E13.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.3.3.3.2" xref="S4.E13.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S4.E13.m1.1.1.1.1.3.3.3.3" xref="S4.E13.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.2" xref="S4.E13.m1.1.1.1.1.3.3.3.3.2.cmml">c</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.3" xref="S4.E13.m1.1.1.1.1.3.3.3.3.3.cmml">o</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1a" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.4" xref="S4.E13.m1.1.1.1.1.3.3.3.3.4.cmml">m</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1b" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.5" xref="S4.E13.m1.1.1.1.1.3.3.3.3.5.cmml">p</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1c" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.6" xref="S4.E13.m1.1.1.1.1.3.3.3.3.6.cmml">a</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1d" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.7" xref="S4.E13.m1.1.1.1.1.3.3.3.3.7.cmml">c</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1e" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.8" xref="S4.E13.m1.1.1.1.1.3.3.3.3.8.cmml">t</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1f" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.9" xref="S4.E13.m1.1.1.1.1.3.3.3.3.9.cmml">n</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1g" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.10" xref="S4.E13.m1.1.1.1.1.3.3.3.3.10.cmml">e</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1h" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.11" xref="S4.E13.m1.1.1.1.1.3.3.3.3.11.cmml">s</mi><mo id="S4.E13.m1.1.1.1.1.3.3.3.3.1i" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E13.m1.1.1.1.1.3.3.3.3.12" xref="S4.E13.m1.1.1.1.1.3.3.3.3.12.cmml">s</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E13.m1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"></eq><apply id="S4.E13.m1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2">ℒ</ci><apply id="S4.E13.m1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.2.3"><times id="S4.E13.m1.1.1.1.1.2.3.1.cmml" xref="S4.E13.m1.1.1.1.1.2.3.1"></times><ci id="S4.E13.m1.1.1.1.1.2.3.2.cmml" xref="S4.E13.m1.1.1.1.1.2.3.2">𝑡</ci><ci id="S4.E13.m1.1.1.1.1.2.3.3.cmml" xref="S4.E13.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S4.E13.m1.1.1.1.1.2.3.4.cmml" xref="S4.E13.m1.1.1.1.1.2.3.4">𝑡</ci><ci id="S4.E13.m1.1.1.1.1.2.3.5.cmml" xref="S4.E13.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S4.E13.m1.1.1.1.1.2.3.6.cmml" xref="S4.E13.m1.1.1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S4.E13.m1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.3"><plus id="S4.E13.m1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.1"></plus><apply id="S4.E13.m1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S4.E13.m1.1.1.1.1.3.2.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3"><times id="S4.E13.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E13.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S4.E13.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.3">𝑟</ci><ci id="S4.E13.m1.1.1.1.1.3.2.3.4.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.4">𝑒</ci><ci id="S4.E13.m1.1.1.1.1.3.2.3.5.cmml" xref="S4.E13.m1.1.1.1.1.3.2.3.5">𝑑</ci></apply></apply><apply id="S4.E13.m1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.3"><times id="S4.E13.m1.1.1.1.1.3.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.3.1"></times><ci id="S4.E13.m1.1.1.1.1.3.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.3.2">𝜆</ci><apply id="S4.E13.m1.1.1.1.1.3.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S4.E13.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3"><times id="S4.E13.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.2">𝑐</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.3">𝑜</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.4">𝑚</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.5.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.5">𝑝</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.6.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.6">𝑎</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.7.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.7">𝑐</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.8.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.8">𝑡</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.9.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.9">𝑛</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.10.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.10">𝑒</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.11.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.11">𝑠</ci><ci id="S4.E13.m1.1.1.1.1.3.3.3.3.12.cmml" xref="S4.E13.m1.1.1.1.1.3.3.3.3.12">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">\mathcal{L}_{total}=\mathcal{L}_{pred}+\lambda\mathcal{L}_{compactness},</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT + italic_λ caligraphic_L start_POSTSUBSCRIPT italic_c italic_o italic_m italic_p italic_a italic_c italic_t italic_n italic_e italic_s italic_s end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.SSS3.p3.7">where <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p3.5.m1.1"><semantics id="S4.SS3.SSS3.p3.5.m1.1a"><mi id="S4.SS3.SSS3.p3.5.m1.1.1" xref="S4.SS3.SSS3.p3.5.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p3.5.m1.1b"><ci id="S4.SS3.SSS3.p3.5.m1.1.1.cmml" xref="S4.SS3.SSS3.p3.5.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p3.5.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p3.5.m1.1d">italic_λ</annotation></semantics></math> is a hyperparameter used to control the strength of compactness regularization, and <math alttext="\mathcal{L}_{pred}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p3.6.m2.1"><semantics id="S4.SS3.SSS3.p3.6.m2.1a"><msub id="S4.SS3.SSS3.p3.6.m2.1.1" xref="S4.SS3.SSS3.p3.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p3.6.m2.1.1.2" xref="S4.SS3.SSS3.p3.6.m2.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.SSS3.p3.6.m2.1.1.3" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.cmml"><mi id="S4.SS3.SSS3.p3.6.m2.1.1.3.2" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.2.cmml">p</mi><mo id="S4.SS3.SSS3.p3.6.m2.1.1.3.1" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.6.m2.1.1.3.3" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.3.cmml">r</mi><mo id="S4.SS3.SSS3.p3.6.m2.1.1.3.1a" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.6.m2.1.1.3.4" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.4.cmml">e</mi><mo id="S4.SS3.SSS3.p3.6.m2.1.1.3.1b" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.6.m2.1.1.3.5" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p3.6.m2.1b"><apply id="S4.SS3.SSS3.p3.6.m2.1.1.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p3.6.m2.1.1.1.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p3.6.m2.1.1.2.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1.2">ℒ</ci><apply id="S4.SS3.SSS3.p3.6.m2.1.1.3.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1.3"><times id="S4.SS3.SSS3.p3.6.m2.1.1.3.1.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.1"></times><ci id="S4.SS3.SSS3.p3.6.m2.1.1.3.2.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.2">𝑝</ci><ci id="S4.SS3.SSS3.p3.6.m2.1.1.3.3.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.3">𝑟</ci><ci id="S4.SS3.SSS3.p3.6.m2.1.1.3.4.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.4">𝑒</ci><ci id="S4.SS3.SSS3.p3.6.m2.1.1.3.5.cmml" xref="S4.SS3.SSS3.p3.6.m2.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p3.6.m2.1c">\mathcal{L}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p3.6.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is similar to <math alttext="\mathcal{L}_{pt}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p3.7.m3.1"><semantics id="S4.SS3.SSS3.p3.7.m3.1a"><msub id="S4.SS3.SSS3.p3.7.m3.1.1" xref="S4.SS3.SSS3.p3.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p3.7.m3.1.1.2" xref="S4.SS3.SSS3.p3.7.m3.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.SSS3.p3.7.m3.1.1.3" xref="S4.SS3.SSS3.p3.7.m3.1.1.3.cmml"><mi id="S4.SS3.SSS3.p3.7.m3.1.1.3.2" xref="S4.SS3.SSS3.p3.7.m3.1.1.3.2.cmml">p</mi><mo id="S4.SS3.SSS3.p3.7.m3.1.1.3.1" xref="S4.SS3.SSS3.p3.7.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS3.p3.7.m3.1.1.3.3" xref="S4.SS3.SSS3.p3.7.m3.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p3.7.m3.1b"><apply id="S4.SS3.SSS3.p3.7.m3.1.1.cmml" xref="S4.SS3.SSS3.p3.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p3.7.m3.1.1.1.cmml" xref="S4.SS3.SSS3.p3.7.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p3.7.m3.1.1.2.cmml" xref="S4.SS3.SSS3.p3.7.m3.1.1.2">ℒ</ci><apply id="S4.SS3.SSS3.p3.7.m3.1.1.3.cmml" xref="S4.SS3.SSS3.p3.7.m3.1.1.3"><times id="S4.SS3.SSS3.p3.7.m3.1.1.3.1.cmml" xref="S4.SS3.SSS3.p3.7.m3.1.1.3.1"></times><ci id="S4.SS3.SSS3.p3.7.m3.1.1.3.2.cmml" xref="S4.SS3.SSS3.p3.7.m3.1.1.3.2">𝑝</ci><ci id="S4.SS3.SSS3.p3.7.m3.1.1.3.3.cmml" xref="S4.SS3.SSS3.p3.7.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p3.7.m3.1c">\mathcal{L}_{pt}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p3.7.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_p italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.E4" title="In 4.2 De-noised Pre-trained Model ‣ 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>) but only predicts item under a given target behavior.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS3.p4">
<p class="ltx_p" id="S4.SS3.SSS3.p4.1">By employing the three properties of prompts—<span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p4.1.1">Personalization</span>, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p4.1.2">Progressiveness</span>, and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p4.1.3">Diversity</span>, we can obtain a fine-tuned model capable of handling downstream tasks effectively. Due to this paradigm, we can efficiently model long sequences of users’ historical behaviors and benefit from a wide range of users’ behaviors without significantly increasing the complexity of the model. Subsequent experiments also proved that the effect of fine-tuning is equal to or even exceeds the effect of full-scale fine-tuning of the model.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span><span class="ltx_text ltx_font_italic" id="S4.SS4.1.1">Essential Analysis of prompts</span>
</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Finally, we delve into the essence of prompt and the reasons why customized prompt learning is effective in pre-trained recommendation models without semantics. <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">Firstly, the essence of prompt is a kind of instruction to the task.</span> In NLP, for the same task, the same prompt can be used for different inputs because the token in NLP is highly semantic; however, in recommendation, the token is just the ID of the item, which is not semantic. For this reason, we propose the concept of customized prompt learning, i.e., generating personalized prompts for different users, which is equivalent to giving different commands to the model for different users, enhancing the personalization of the model’s output and improving the recommendation effect.
<span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.2">Secondly, the essence of prompt is a kind of pre-training task reuse.</span> Another reason for the effectiveness of our approach is that we design the next prediction pre-training task, as well as generating prompts with pre-trained historical user behaviors, trying to make the fine-tuning task reuse the pre-training task, and avoiding the introduction of a large number of new parameters that would lead to catastrophic forgetting of the model.
<span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.3">Thirdly, the essence of the prompt is searching for valid parameters.</span> The goal of prompt-tuning, from fixed templates to learnable templates, as well as the wide variety of tuning strategies proposed, is to achieve a better adaptation of the model while tuning the model with as few parameters as possible. So prompt learning is about finding the part of the parameters that are more effective for model adaptation. Just as we analyzed that the model is going layer by layer to condense the learning interests from the behaviors, we propose to add some prompts to each layer of the pre-trained model, which will have a more direct impact on the model in learning user interests, and one of the reasons why DPCPL is effective is that we have found the part of the model parameters that are more effective in the model adaptation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">EXPERIMENT</span>
</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span><span class="ltx_text ltx_font_italic" id="S5.SS1.1.1">Experimental Setting</span>
</h3>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Datasets</h4>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Statistical information of experimented datasets.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T2.1" style="width:433.6pt;height:224.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(72.7pt,-37.7pt) scale(1.50417176500242,1.50417176500242) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.2">CIKM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.3">IJCAI</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.1.1.4">Taobao</td>
<td class="ltx_td ltx_border_t" id="S5.T2.1.1.1.1.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.2.1">#users</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.2.2">254,356</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.2.3">324,859</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.1.2.2.4">279,052</td>
<td class="ltx_td ltx_border_t" id="S5.T2.1.1.2.2.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.3.3">
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.3.1">#items</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.3.2">521,900</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.3.3">331,064</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.3.3.4">731,517</td>
<td class="ltx_td" id="S5.T2.1.1.3.3.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.4.4">
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.4.1">#interactions</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.4.2">31,824,670</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.4.3">46,694,666</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.4.4.4">36,758,555</td>
<td class="ltx_td" id="S5.T2.1.1.4.4.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.5.5">
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.5.1">#Density</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.5.2">2.4e-4</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.5.3">4.3e-4</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5.5.4">1.9e-4</td>
<td class="ltx_td" id="S5.T2.1.1.5.5.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.6.6">
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.6.1">#Avg-length</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.6.2">125.12</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.6.3">143.74</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.6.6.4">136.62</td>
<td class="ltx_td" id="S5.T2.1.1.6.6.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.1.1.7.7.1">User profile</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.1.1.7.7.2">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.1.1.7.7.2.1">
<tr class="ltx_tr" id="S5.T2.1.1.7.7.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.1.7.7.2.1.1.1">gender, age,</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.7.7.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.1.7.7.2.1.2.1">consumption</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.1.1.7.7.3">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.1.1.7.7.3.1">
<tr class="ltx_tr" id="S5.T2.1.1.7.7.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.1.7.7.3.1.1.1">gender,</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1.7.7.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.1.7.7.3.1.2.1">age_range</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.1.1.7.7.4">None</td>
<td class="ltx_td ltx_border_b" id="S5.T2.1.1.7.7.5"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Overall performance comparison of all methods in terms of HR@K and NDCG@K. (p-value <math alttext="&lt;" class="ltx_Math" display="inline" id="S5.T3.2.m1.1"><semantics id="S5.T3.2.m1.1b"><mo id="S5.T3.2.m1.1.1" xref="S5.T3.2.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.1c"><lt id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.1d">&lt;</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.m1.1e">&lt;</annotation></semantics></math> 0.05)</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.3.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.2.1.1"><span class="ltx_text" id="S5.T3.3.2.1.1.1" style="font-size:90%;">Datasets</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T3.3.2.1.2"><span class="ltx_text" id="S5.T3.3.2.1.2.1" style="font-size:90%;">CIKM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T3.3.2.1.3"><span class="ltx_text" id="S5.T3.3.2.1.3.1" style="font-size:90%;">Taobao</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S5.T3.3.2.1.4"><span class="ltx_text" id="S5.T3.3.2.1.4.1" style="font-size:90%;">IJCAI</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.3.2.1"><span class="ltx_text" id="S5.T3.3.3.2.1.1" style="font-size:90%;">Metric</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.2"><span class="ltx_text" id="S5.T3.3.3.2.2.1" style="font-size:90%;">H@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.3"><span class="ltx_text" id="S5.T3.3.3.2.3.1" style="font-size:90%;">N@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.4"><span class="ltx_text" id="S5.T3.3.3.2.4.1" style="font-size:90%;">H@20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.3.2.5"><span class="ltx_text" id="S5.T3.3.3.2.5.1" style="font-size:90%;">N@20</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.6"><span class="ltx_text" id="S5.T3.3.3.2.6.1" style="font-size:90%;">H@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.7"><span class="ltx_text" id="S5.T3.3.3.2.7.1" style="font-size:90%;">N@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.8"><span class="ltx_text" id="S5.T3.3.3.2.8.1" style="font-size:90%;">H@20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.3.2.9"><span class="ltx_text" id="S5.T3.3.3.2.9.1" style="font-size:90%;">N@20</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.10"><span class="ltx_text" id="S5.T3.3.3.2.10.1" style="font-size:90%;">H@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.11"><span class="ltx_text" id="S5.T3.3.3.2.11.1" style="font-size:90%;">N@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.12"><span class="ltx_text" id="S5.T3.3.3.2.12.1" style="font-size:90%;">H@20</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.2.13"><span class="ltx_text" id="S5.T3.3.3.2.13.1" style="font-size:90%;">N@20</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.4.3.1"><span class="ltx_text" id="S5.T3.3.4.3.1.1" style="font-size:90%;">GRU4Rec</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.2"><span class="ltx_text" id="S5.T3.3.4.3.2.1" style="font-size:90%;">0.270</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.3"><span class="ltx_text" id="S5.T3.3.4.3.3.1" style="font-size:90%;">0.155</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.4"><span class="ltx_text" id="S5.T3.3.4.3.4.1" style="font-size:90%;">0.311</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.4.3.5"><span class="ltx_text" id="S5.T3.3.4.3.5.1" style="font-size:90%;">0.179</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.6"><span class="ltx_text" id="S5.T3.3.4.3.6.1" style="font-size:90%;">0.245</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.7"><span class="ltx_text" id="S5.T3.3.4.3.7.1" style="font-size:90%;">0.139</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.8"><span class="ltx_text" id="S5.T3.3.4.3.8.1" style="font-size:90%;">0.268</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.4.3.9"><span class="ltx_text" id="S5.T3.3.4.3.9.1" style="font-size:90%;">0.155</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.10"><span class="ltx_text" id="S5.T3.3.4.3.10.1" style="font-size:90%;">0.296</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.11"><span class="ltx_text" id="S5.T3.3.4.3.11.1" style="font-size:90%;">0.164</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.12"><span class="ltx_text" id="S5.T3.3.4.3.12.1" style="font-size:90%;">0.365</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.3.13"><span class="ltx_text" id="S5.T3.3.4.3.13.1" style="font-size:90%;">0.208</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.5.4.1"><span class="ltx_text" id="S5.T3.3.5.4.1.1" style="font-size:90%;">SASRec</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.2"><span class="ltx_text" id="S5.T3.3.5.4.2.1" style="font-size:90%;">0.325</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.3"><span class="ltx_text" id="S5.T3.3.5.4.3.1" style="font-size:90%;">0.198</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.4"><span class="ltx_text" id="S5.T3.3.5.4.4.1" style="font-size:90%;">0.423</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.5.4.5"><span class="ltx_text" id="S5.T3.3.5.4.5.1" style="font-size:90%;">0.243</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.6"><span class="ltx_text" id="S5.T3.3.5.4.6.1" style="font-size:90%;">0.318</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.7"><span class="ltx_text" id="S5.T3.3.5.4.7.1" style="font-size:90%;">0.188</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.8"><span class="ltx_text" id="S5.T3.3.5.4.8.1" style="font-size:90%;">0.408</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.5.4.9"><span class="ltx_text" id="S5.T3.3.5.4.9.1" style="font-size:90%;">0.226</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.10"><span class="ltx_text" id="S5.T3.3.5.4.10.1" style="font-size:90%;">0.373</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.11"><span class="ltx_text" id="S5.T3.3.5.4.11.1" style="font-size:90%;">0.200</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.12"><span class="ltx_text" id="S5.T3.3.5.4.12.1" style="font-size:90%;">0.484</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.5.4.13"><span class="ltx_text" id="S5.T3.3.5.4.13.1" style="font-size:90%;">0.249</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.6.5.1"><span class="ltx_text" id="S5.T3.3.6.5.1.1" style="font-size:90%;">Bert4Rec</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.2"><span class="ltx_text" id="S5.T3.3.6.5.2.1" style="font-size:90%;">0.356</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.3"><span class="ltx_text" id="S5.T3.3.6.5.3.1" style="font-size:90%;">0.228</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.4"><span class="ltx_text" id="S5.T3.3.6.5.4.1" style="font-size:90%;">0.450</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.6.5.5"><span class="ltx_text" id="S5.T3.3.6.5.5.1" style="font-size:90%;">0.248</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.6"><span class="ltx_text" id="S5.T3.3.6.5.6.1" style="font-size:90%;">0.304</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.7"><span class="ltx_text" id="S5.T3.3.6.5.7.1" style="font-size:90%;">0.178</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.8"><span class="ltx_text" id="S5.T3.3.6.5.8.1" style="font-size:90%;">0.391</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.6.5.9"><span class="ltx_text" id="S5.T3.3.6.5.9.1" style="font-size:90%;">0.212</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.10"><span class="ltx_text" id="S5.T3.3.6.5.10.1" style="font-size:90%;">0.398</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.11"><span class="ltx_text" id="S5.T3.3.6.5.11.1" style="font-size:90%;">0.219</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.12"><span class="ltx_text" id="S5.T3.3.6.5.12.1" style="font-size:90%;">0.520</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.6.5.13"><span class="ltx_text" id="S5.T3.3.6.5.13.1" style="font-size:90%;">0.283</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.7.6.1"><span class="ltx_text" id="S5.T3.3.7.6.1.1" style="font-size:90%;">FEARec</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.2"><span class="ltx_text" id="S5.T3.3.7.6.2.1" style="font-size:90%;">0.363</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.3"><span class="ltx_text" id="S5.T3.3.7.6.3.1" style="font-size:90%;">0.229</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.4"><span class="ltx_text" id="S5.T3.3.7.6.4.1" style="font-size:90%;">0.463</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.7.6.5"><span class="ltx_text" id="S5.T3.3.7.6.5.1" style="font-size:90%;">0.259</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.6"><span class="ltx_text" id="S5.T3.3.7.6.6.1" style="font-size:90%;">0.324</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.7"><span class="ltx_text" id="S5.T3.3.7.6.7.1" style="font-size:90%;">0.190</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.8"><span class="ltx_text" id="S5.T3.3.7.6.8.1" style="font-size:90%;">0.416</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.7.6.9"><span class="ltx_text" id="S5.T3.3.7.6.9.1" style="font-size:90%;">0.227</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.10"><span class="ltx_text" id="S5.T3.3.7.6.10.1" style="font-size:90%;">0.409</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.11"><span class="ltx_text" id="S5.T3.3.7.6.11.1" style="font-size:90%;">0.223</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.12"><span class="ltx_text" id="S5.T3.3.7.6.12.1" style="font-size:90%;">0.533</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.7.6.13"><span class="ltx_text" id="S5.T3.3.7.6.13.1" style="font-size:90%;">0.285</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.8.7.1"><span class="ltx_text" id="S5.T3.3.8.7.1.1" style="font-size:90%;">MBGCN</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.2"><span class="ltx_text" id="S5.T3.3.8.7.2.1" style="font-size:90%;">0.364</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.3"><span class="ltx_text" id="S5.T3.3.8.7.3.1" style="font-size:90%;">0.227</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.4"><span class="ltx_text" id="S5.T3.3.8.7.4.1" style="font-size:90%;">0.467</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.8.7.5"><span class="ltx_text" id="S5.T3.3.8.7.5.1" style="font-size:90%;">0.263</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.6"><span class="ltx_text" id="S5.T3.3.8.7.6.1" style="font-size:90%;">0.333</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.7"><span class="ltx_text" id="S5.T3.3.8.7.7.1" style="font-size:90%;">0.196</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.8"><span class="ltx_text" id="S5.T3.3.8.7.8.1" style="font-size:90%;">0.427</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.8.7.9"><span class="ltx_text" id="S5.T3.3.8.7.9.1" style="font-size:90%;">0.235</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.10"><span class="ltx_text" id="S5.T3.3.8.7.10.1" style="font-size:90%;">0.412</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.11"><span class="ltx_text" id="S5.T3.3.8.7.11.1" style="font-size:90%;">0.224</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.12"><span class="ltx_text" id="S5.T3.3.8.7.12.1" style="font-size:90%;">0.536</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.8.7.13"><span class="ltx_text" id="S5.T3.3.8.7.13.1" style="font-size:90%;">0.284</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.9.8.1"><span class="ltx_text" id="S5.T3.3.9.8.1.1" style="font-size:90%;">MBHT</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.2"><span class="ltx_text" id="S5.T3.3.9.8.2.1" style="font-size:90%;">0.360</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.3"><span class="ltx_text" id="S5.T3.3.9.8.3.1" style="font-size:90%;">0.223</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.4"><span class="ltx_text" id="S5.T3.3.9.8.4.1" style="font-size:90%;">0.466</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.9.8.5"><span class="ltx_text" id="S5.T3.3.9.8.5.1" style="font-size:90%;">0.265</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.6"><span class="ltx_text" id="S5.T3.3.9.8.6.1" style="font-size:90%;">0.342</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.7"><span class="ltx_text" id="S5.T3.3.9.8.7.1" style="font-size:90%;">0.201</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.8"><span class="ltx_text" id="S5.T3.3.9.8.8.1" style="font-size:90%;">0.438</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.9.8.9"><span class="ltx_text" id="S5.T3.3.9.8.9.1" style="font-size:90%;">0.242</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.10"><span class="ltx_text" id="S5.T3.3.9.8.10.1" style="font-size:90%;">0.409</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.11"><span class="ltx_text" id="S5.T3.3.9.8.11.1" style="font-size:90%;">0.202</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.12"><span class="ltx_text" id="S5.T3.3.9.8.12.1" style="font-size:90%;">0.524</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.9.8.13"><span class="ltx_text" id="S5.T3.3.9.8.13.1" style="font-size:90%;">0.279</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.10.9.1"><span class="ltx_text" id="S5.T3.3.10.9.1.1" style="font-size:90%;">KGHT</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.2"><span class="ltx_text" id="S5.T3.3.10.9.2.1" style="font-size:90%;">0.380</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.3"><span class="ltx_text" id="S5.T3.3.10.9.3.1" style="font-size:90%;">0.228</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.4"><span class="ltx_text" id="S5.T3.3.10.9.4.1" style="font-size:90%;">0.489</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.10.9.5"><span class="ltx_text" id="S5.T3.3.10.9.5.1" style="font-size:90%;">0.280</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.6"><span class="ltx_text" id="S5.T3.3.10.9.6.1" style="font-size:90%;">0.357</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.7"><span class="ltx_text" id="S5.T3.3.10.9.7.1" style="font-size:90%;">0.207</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.8"><span class="ltx_text" id="S5.T3.3.10.9.8.1" style="font-size:90%;">0.454</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.10.9.9"><span class="ltx_text" id="S5.T3.3.10.9.9.1" style="font-size:90%;">0.251</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.10"><span class="ltx_text" id="S5.T3.3.10.9.10.1" style="font-size:90%;">0.411</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.11"><span class="ltx_text" id="S5.T3.3.10.9.11.1" style="font-size:90%;">0.222</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.12"><span class="ltx_text" id="S5.T3.3.10.9.12.1" style="font-size:90%;">0.534</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.10.9.13"><span class="ltx_text" id="S5.T3.3.10.9.13.1" style="font-size:90%;">0.280</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.11.10.1"><span class="ltx_text" id="S5.T3.3.11.10.1.1" style="font-size:90%;">CML</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.2"><span class="ltx_text" id="S5.T3.3.11.10.2.1" style="font-size:90%;">0.369</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.3"><span class="ltx_text" id="S5.T3.3.11.10.3.1" style="font-size:90%;">0.229</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.4"><span class="ltx_text" id="S5.T3.3.11.10.4.1" style="font-size:90%;">0.476</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.11.10.5"><span class="ltx_text" id="S5.T3.3.11.10.5.1" style="font-size:90%;">0.269</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.6"><span class="ltx_text" id="S5.T3.3.11.10.6.1" style="font-size:90%;">0.345</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.7"><span class="ltx_text" id="S5.T3.3.11.10.7.1" style="font-size:90%;">0.203</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.8"><span class="ltx_text" id="S5.T3.3.11.10.8.1" style="font-size:90%;">0.442</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.11.10.9"><span class="ltx_text" id="S5.T3.3.11.10.9.1" style="font-size:90%;">0.244</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.10"><span class="ltx_text" id="S5.T3.3.11.10.10.1" style="font-size:90%;">0.420</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.11"><span class="ltx_text" id="S5.T3.3.11.10.11.1" style="font-size:90%;">0.227</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.12"><span class="ltx_text" id="S5.T3.3.11.10.12.1" style="font-size:90%;">0.546</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.11.10.13"><span class="ltx_text" id="S5.T3.3.11.10.13.1" style="font-size:90%;">0.287</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.12.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.12.11.1"><span class="ltx_text" id="S5.T3.3.12.11.1.1" style="font-size:90%;">CKML</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.2"><span class="ltx_text" id="S5.T3.3.12.11.2.1" style="font-size:90%;">0.399</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.3"><span class="ltx_text" id="S5.T3.3.12.11.3.1" style="font-size:90%;">0.233</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.4"><span class="ltx_text" id="S5.T3.3.12.11.4.1" style="font-size:90%;">0.512</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.12.11.5"><span class="ltx_text" id="S5.T3.3.12.11.5.1" style="font-size:90%;">0.295</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.6"><span class="ltx_text" id="S5.T3.3.12.11.6.1" style="font-size:90%;">0.373</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.7"><span class="ltx_text" id="S5.T3.3.12.11.7.1" style="font-size:90%;">0.213</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.8"><span class="ltx_text" id="S5.T3.3.12.11.8.1" style="font-size:90%;">0.470</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.12.11.9"><span class="ltx_text" id="S5.T3.3.12.11.9.1" style="font-size:90%;">0.260</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.10"><span class="ltx_text" id="S5.T3.3.12.11.10.1" style="font-size:90%;">0.410</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.11"><span class="ltx_text" id="S5.T3.3.12.11.11.1" style="font-size:90%;">0.222</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.12"><span class="ltx_text" id="S5.T3.3.12.11.12.1" style="font-size:90%;">0.534</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.12.11.13"><span class="ltx_text" id="S5.T3.3.12.11.13.1" style="font-size:90%;">0.282</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.13.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.13.12.1"><span class="ltx_text" id="S5.T3.3.13.12.1.1" style="font-size:90%;">KMCLR</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.2"><span class="ltx_text" id="S5.T3.3.13.12.2.1" style="font-size:90%;">0.413</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.3"><span class="ltx_text" id="S5.T3.3.13.12.3.1" style="font-size:90%;">0.227</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.4"><span class="ltx_text" id="S5.T3.3.13.12.4.1" style="font-size:90%;">0.526</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.13.12.5"><span class="ltx_text" id="S5.T3.3.13.12.5.1" style="font-size:90%;">0.308</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.6"><span class="ltx_text" id="S5.T3.3.13.12.6.1" style="font-size:90%;">0.386</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.7"><span class="ltx_text" id="S5.T3.3.13.12.7.1" style="font-size:90%;">0.214</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.8"><span class="ltx_text" id="S5.T3.3.13.12.8.1" style="font-size:90%;">0.479</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.13.12.9"><span class="ltx_text" id="S5.T3.3.13.12.9.1" style="font-size:90%;">0.265</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.10"><span class="ltx_text" id="S5.T3.3.13.12.10.1" style="font-size:90%;">0.385</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.11"><span class="ltx_text" id="S5.T3.3.13.12.11.1" style="font-size:90%;">0.209</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.12"><span class="ltx_text" id="S5.T3.3.13.12.12.1" style="font-size:90%;">0.502</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.13.12.13"><span class="ltx_text" id="S5.T3.3.13.12.13.1" style="font-size:90%;">0.266</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.1.1">
<span class="ltx_text" id="S5.T3.3.1.1.1" style="font-size:90%;">MB-S</span><sup class="ltx_sup" id="S5.T3.3.1.1.2"><span class="ltx_text" id="S5.T3.3.1.1.2.1" style="font-size:90%;">3</span></sup><span class="ltx_text" id="S5.T3.3.1.1.3" style="font-size:90%;">Rec</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.2"><span class="ltx_text" id="S5.T3.3.1.2.1" style="font-size:90%;">0.427</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.3"><span class="ltx_text" id="S5.T3.3.1.3.1" style="font-size:90%;">0.245</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.4"><span class="ltx_text" id="S5.T3.3.1.4.1" style="font-size:90%;">0.549</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.1.5"><span class="ltx_text" id="S5.T3.3.1.5.1" style="font-size:90%;">0.318</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.6"><span class="ltx_text" id="S5.T3.3.1.6.1" style="font-size:90%;">0.406</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.7"><span class="ltx_text" id="S5.T3.3.1.7.1" style="font-size:90%;">0.232</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.8"><span class="ltx_text" id="S5.T3.3.1.8.1" style="font-size:90%;">0.512</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.1.9"><span class="ltx_text" id="S5.T3.3.1.9.1" style="font-size:90%;">0.284</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.10"><span class="ltx_text" id="S5.T3.3.1.10.1" style="font-size:90%;">0.436</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.11"><span class="ltx_text" id="S5.T3.3.1.11.1" style="font-size:90%;">0.235</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.12"><span class="ltx_text" id="S5.T3.3.1.12.1" style="font-size:90%;">0.567</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.1.13"><span class="ltx_text" id="S5.T3.3.1.13.1" style="font-size:90%;">0.297</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.14.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.14.13.1"><span class="ltx_text" id="S5.T3.3.14.13.1.1" style="font-size:90%;">MB-CL4SRec</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.2"><span class="ltx_text" id="S5.T3.3.14.13.2.1" style="font-size:90%;">0.409</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.3"><span class="ltx_text" id="S5.T3.3.14.13.3.1" style="font-size:90%;">0.248</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.4"><span class="ltx_text" id="S5.T3.3.14.13.4.1" style="font-size:90%;">0.522</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.14.13.5"><span class="ltx_text" id="S5.T3.3.14.13.5.1" style="font-size:90%;">0.296</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.6"><span class="ltx_text" id="S5.T3.3.14.13.6.1" style="font-size:90%;">0.427</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.7"><span class="ltx_text" id="S5.T3.3.14.13.7.1" style="font-size:90%;">0.244</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.8"><span class="ltx_text" id="S5.T3.3.14.13.8.1" style="font-size:90%;">0.538</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.14.13.9"><span class="ltx_text" id="S5.T3.3.14.13.9.1" style="font-size:90%;">0.298</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.10"><span class="ltx_text" id="S5.T3.3.14.13.10.1" style="font-size:90%;">0.437</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.11"><span class="ltx_text" id="S5.T3.3.14.13.11.1" style="font-size:90%;">0.238</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.12"><span class="ltx_text" id="S5.T3.3.14.13.12.1" style="font-size:90%;">0.570</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.14.13.13"><span class="ltx_text" id="S5.T3.3.14.13.13.1" style="font-size:90%;">0.304</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.15.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.15.14.1"><span class="ltx_text" id="S5.T3.3.15.14.1.1" style="font-size:90%;">MBPPR</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.2"><span class="ltx_text" id="S5.T3.3.15.14.2.1" style="font-size:90%;">0.448</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.3"><span class="ltx_text" id="S5.T3.3.15.14.3.1" style="font-size:90%;">0.257</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.4"><span class="ltx_text" id="S5.T3.3.15.14.4.1" style="font-size:90%;">0.576</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.15.14.5"><span class="ltx_text" id="S5.T3.3.15.14.5.1" style="font-size:90%;">0.334</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.6"><span class="ltx_text" id="S5.T3.3.15.14.6.1" style="font-size:90%;">0.370</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.7"><span class="ltx_text" id="S5.T3.3.15.14.7.1" style="font-size:90%;">0.214</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.8"><span class="ltx_text" id="S5.T3.3.15.14.8.1" style="font-size:90%;">0.471</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.15.14.9"><span class="ltx_text" id="S5.T3.3.15.14.9.1" style="font-size:90%;">0.258</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.10"><span class="ltx_text" id="S5.T3.3.15.14.10.1" style="font-size:90%;">0.458</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.11"><span class="ltx_text" id="S5.T3.3.15.14.11.1" style="font-size:90%;">0.247</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.15.14.12.1" style="font-size:90%;">0.616</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.15.14.13"><span class="ltx_text" id="S5.T3.3.15.14.13.1" style="font-size:90%;">0.312</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.16.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.16.15.1"><span class="ltx_text" id="S5.T3.3.16.15.1.1" style="font-size:90%;">CPTPP</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.2"><span class="ltx_text" id="S5.T3.3.16.15.2.1" style="font-size:90%;">0.428</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.3"><span class="ltx_text" id="S5.T3.3.16.15.3.1" style="font-size:90%;">0.252</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.4"><span class="ltx_text" id="S5.T3.3.16.15.4.1" style="font-size:90%;">0.549</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.16.15.5"><span class="ltx_text" id="S5.T3.3.16.15.5.1" style="font-size:90%;">0.315</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.16.15.6.1" style="font-size:90%;">0.449</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.16.15.7.1" style="font-size:90%;">0.256</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.16.15.8.1" style="font-size:90%;">0.565</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.16.15.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.16.15.9.1" style="font-size:90%;">0.313</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.10"><span class="ltx_text" id="S5.T3.3.16.15.10.1" style="font-size:90%;">0.447</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.11"><span class="ltx_text" id="S5.T3.3.16.15.11.1" style="font-size:90%;">0.243</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.12"><span class="ltx_text" id="S5.T3.3.16.15.12.1" style="font-size:90%;">0.593</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.16.15.13"><span class="ltx_text" id="S5.T3.3.16.15.13.1" style="font-size:90%;">0.304</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.17.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.17.16.1"><span class="ltx_text" id="S5.T3.3.17.16.1.1" style="font-size:90%;">DPT</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.17.16.2.1" style="font-size:90%;">0.471</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.17.16.3.1" style="font-size:90%;">0.270</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.17.16.4.1" style="font-size:90%;">0.606</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.17.16.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.17.16.5.1" style="font-size:90%;">0.351</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.6"><span class="ltx_text" id="S5.T3.3.17.16.6.1" style="font-size:90%;">0.398</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.7"><span class="ltx_text" id="S5.T3.3.17.16.7.1" style="font-size:90%;">0.229</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.8"><span class="ltx_text" id="S5.T3.3.17.16.8.1" style="font-size:90%;">0.504</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.3.17.16.9"><span class="ltx_text" id="S5.T3.3.17.16.9.1" style="font-size:90%;">0.278</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.17.16.10.1" style="font-size:90%;">0.482</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.17.16.11.1" style="font-size:90%;">0.260</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.12"><span class="ltx_text" id="S5.T3.3.17.16.12.1" style="font-size:90%;">0.607</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.17.16.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T3.3.17.16.13.1" style="font-size:90%;">0.328</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.18.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.18.17.1"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.1.1" style="font-size:90%;">DPCPL</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.2"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.2.1" style="font-size:90%;">0.519</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.3"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.3.1" style="font-size:90%;">0.299</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.4"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.4.1" style="font-size:90%;">0.664</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.18.17.5"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.5.1" style="font-size:90%;">0.383</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.6"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.6.1" style="font-size:90%;">0.484</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.7"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.7.1" style="font-size:90%;">0.275</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.8"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.8.1" style="font-size:90%;">0.609</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.18.17.9"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.9.1" style="font-size:90%;">0.336</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.10"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.10.1" style="font-size:90%;">0.523</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.11"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.11.1" style="font-size:90%;">0.283</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.12"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.12.1" style="font-size:90%;">0.669</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.18.17.13"><span class="ltx_text ltx_font_bold" id="S5.T3.3.18.17.13.1" style="font-size:90%;">0.359</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.19.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T3.3.19.18.1"><span class="ltx_text" id="S5.T3.3.19.18.1.1" style="font-size:90%;">Improvement</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.2"><span class="ltx_text" id="S5.T3.3.19.18.2.1" style="font-size:90%;">10.20%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.3"><span class="ltx_text" id="S5.T3.3.19.18.3.1" style="font-size:90%;">10.44%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.4"><span class="ltx_text" id="S5.T3.3.19.18.4.1" style="font-size:90%;">9.63%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.3.19.18.5"><span class="ltx_text" id="S5.T3.3.19.18.5.1" style="font-size:90%;">9.18%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.6"><span class="ltx_text" id="S5.T3.3.19.18.6.1" style="font-size:90%;">7.91%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.7"><span class="ltx_text" id="S5.T3.3.19.18.7.1" style="font-size:90%;">7.38%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.8"><span class="ltx_text" id="S5.T3.3.19.18.8.1" style="font-size:90%;">7.79%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.3.19.18.9"><span class="ltx_text" id="S5.T3.3.19.18.9.1" style="font-size:90%;">7.41%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.10"><span class="ltx_text" id="S5.T3.3.19.18.10.1" style="font-size:90%;">8.56%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.11"><span class="ltx_text" id="S5.T3.3.19.18.11.1" style="font-size:90%;">9.06%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.12"><span class="ltx_text" id="S5.T3.3.19.18.12.1" style="font-size:90%;">8.57%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.19.18.13"><span class="ltx_text" id="S5.T3.3.19.18.13.1" style="font-size:90%;">9.72%</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">To comprehensively investigate the performance of DPCPL, we conduct experiments on three large-scale real-world recommendation datasets, which are widely utilized in multi-behavior sequential recommendation research and are considered standard benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib40" title="">40</a>]</cite>. These user behavior datasets contain various interactions: click, add-to-cart, add-to-favorite, and purchase.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p2">
<p class="ltx_p" id="S5.SS1.SSS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS1.p2.1.1">CIKM<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote1.1.1.1">1</span></span><span class="ltx_text ltx_font_medium" id="footnote1.5">https://tianchi.aliyun.com/dataset/35680</span></span></span></span></span>. The CIKM dataset is an E-commerce recommendation dataset that was released by Alibaba. It is specifically designed to aid in the development and evaluation of recommendation algorithms within the E-commerce domain.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p3">
<p class="ltx_p" id="S5.SS1.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS1.p3.1.1">IJCAI<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><span class="ltx_text ltx_font_medium" id="footnote2.5">https://tianchi.aliyun.com/dataset/42</span></span></span></span></span>. This dataset is released by IJCAI Contest 2015 for the task of repeat buyers prediction. This dataset provides extensive data on user purchasing behavior, which can be leveraged to develop and test algorithms aimed at identifying customers who are likely to make repeat purchases.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p4">
<p class="ltx_p" id="S5.SS1.SSS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS1.p4.1.1">Taobao<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote3.1.1.1">3</span></span><span class="ltx_text ltx_font_medium" id="footnote3.5">https://tianchi.aliyun.com/dataset/649</span></span></span></span></span>. This dataset is collected from Taobao, which is one of the largest e-commerce platforms in China. This dataset offers a wealth of information on user interactions and transactions on the platform, making it an excellent resource for developing and testing various E-commerce applications, such as recommendation systems, user behavior analysis, and sales forecasting.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p5">
<p class="ltx_p" id="S5.SS1.SSS1.p5.1">In data processing, the experiment aims to maintain the original dataset’s distribution to reflect real-world characteristics accurately. We filter out user and item data with fewer than 20 interactions. The first 60% of the data, based on timestamps, is designated as pre-training data, while the remaining 40% is used for fine-tuning and validation tests. For non-pre-trained models, no pre-training data is utilized in the experiments. This is because recommendation algorithms that often input sequence lengths that are limited, and generally only input the user’s most recent behavior. The pre-training fine-tuning paradigm can mitigate this issue to some extent. It allows for pre-training with ultra-long historical behaviors and fine-tuning using the most recent behavioral data. Detailed statistical information about these datasets is summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.T2" title="TABLE II ‣ 5.1.1 Datasets ‣ 5.1 Experimental Setting ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Comparison Baselines</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.1">We compare DPCPL with various state-of-the-art baseline methods, including general sequential recommendation, multi-behavior sequential recommendation, and pre-training fine-tuning approaches.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p2">
<p class="ltx_p" id="S5.SS1.SSS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p2.1.1">General Sequential Recommendation Methods.</span>
In this context, the sequential recommendation algorithm inputs only the items with which the user interacts, without considering the type of behavior.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p3">
<p class="ltx_p" id="S5.SS1.SSS2.p3.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p3.1.1">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib60" title="">60</a>]</cite>. It utilizes the gated recurrent unit as sequence encoder to learn dynamic preference.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p4">
<p class="ltx_p" id="S5.SS1.SSS2.p4.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p4.1.1">SASRec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib34" title="">34</a>]</cite>. In SASRec, self-attention is employed to encode the sequential patterns of user interaction, without the recurrent operations over input sequences.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p5">
<p class="ltx_p" id="S5.SS1.SSS2.p5.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p5.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib32" title="">32</a>]</cite>. It uses a bidirectional encoder for modeling sequential information with transformer, which is optimized with the Cloze objective and has produced state-of-the-art performance among many baselines.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p6">
<p class="ltx_p" id="S5.SS1.SSS2.p6.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p6.1.1">FEARec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib35" title="">35</a>]</cite>. It improves the original time domain self-attention in the frequency domain with a ramp structure, allowing for the explicit learning of both low-frequency and high-frequency information.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p7">
<p class="ltx_p" id="S5.SS1.SSS2.p7.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p7.1.1">Multi-Behavior Recommendation Methods.</span> In the multi-behavior recommendation algorithm, we take into account the relationships between different behavior types.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p8">
<p class="ltx_p" id="S5.SS1.SSS2.p8.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p8.1.1">MB-GCN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib61" title="">61</a>]</cite>. It models the multi-behavior
of users and uses graph convolutional network to perform
behavior-aware embedding propagation.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p9">
<p class="ltx_p" id="S5.SS1.SSS2.p9.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p9.1.1">MBHT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib59" title="">59</a>]</cite>, which transform multi-behavior interactions into a unified graph or hyper-graph.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p10">
<p class="ltx_p" id="S5.SS1.SSS2.p10.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p10.1.1">KHGT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib62" title="">62</a>]</cite>. It introduces a transformer-based approach to multibehavior modeling with emphasis on temporal information and auxiliary knowledge information, modeling behavior embeddings through graph attention networks.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p11">
<p class="ltx_p" id="S5.SS1.SSS2.p11.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p11.1.1">CML</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib43" title="">43</a>]</cite>. It introduces CL into multi-behavior recommendation, proposing meta-contrastive coding to enable the model to learn personalized behavioral features.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p12">
<p class="ltx_p" id="S5.SS1.SSS2.p12.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p12.1.1">CKML</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib63" title="">63</a>]</cite>, which uses Coarse-grained Interest Extracting (CIE) and Fine-grained Behavioral Correlation (FBC) modules, along with a self-attention mechanism, to capture and correlate shared and behavior-specific interests.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p13">
<p class="ltx_p" id="S5.SS1.SSS2.p13.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p13.1.1">KMCLR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib14" title="">14</a>]</cite> which enhances recommender systems through two comparative learning tasks and three functional modules: multiple user behavior learning, knowledge graph enhancement, and coarse- and fine-grained modeling of user behaviors to improve performance.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p14">
<p class="ltx_p" id="S5.SS1.SSS2.p14.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.p14.1.1">Pre-trained and Prompt-tuning Methods</span>. In the pre-training method paradigm, we can consider incorporating the user’s long-term historical behavior sequence for pre-training. This would be followed by fine-tuning using the user’s recent behavior sequence with a typical sequence length, just like the non-pre-training method. It is worth noting that we follow the relevant literature <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib59" title="">59</a>]</cite> and transform the original non-multi-behavior method into a multi-behavior sequence recommendation method MB-X by adding behavior embedding.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p15">
<p class="ltx_p" id="S5.SS1.SSS2.p15.2"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p15.1.1">S<sup class="ltx_sup" id="S5.SS1.SSS2.p15.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_upright" id="S5.SS1.SSS2.p15.1.1.1.1">3</span></sup>Rec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib20" title="">20</a>]</cite> uses SSL with a pre-training strategy to derive the intrinsic data correlation. In this section, we only compare the mask item prediction (MIP) and sequence-segment correlation segment prediction (SP) in S<sup class="ltx_sup" id="S5.SS1.SSS2.p15.2.2">3</sup>Rec for fairness.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p16">
<p class="ltx_p" id="S5.SS1.SSS2.p16.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p16.1.1">CL4SRec</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib21" title="">21</a>]</cite> combines contrastive SSL with a Transformer-based SR model. The model incorporates crop, mask, and reorder augmentation operators.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p17">
<p class="ltx_p" id="S5.SS1.SSS2.p17.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p17.1.1">PPR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib48" title="">48</a>]</cite> represents a groundbreaking contribution that employs prompt learning to address the challenge of the cold start problem by generating prompts solely based on user attribute information.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p18">
<p class="ltx_p" id="S5.SS1.SSS2.p18.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p18.1.1">CPTPP</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib19" title="">19</a>]</cite>.
The CPTPP framework leverages user information and graph-based contrastive learning to effectively align pre-trained user vectors with specific downstream tasks, enhancing performance by capturing intricate user relationships and preferences.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS2.p19">
<p class="ltx_p" id="S5.SS1.SSS2.p19.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS1.SSS2.p19.1.1">DPT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib50" title="">50</a>]</cite> adopts a three-stage denoising and a fine-tuning approach to reduce noise impacts.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Implementation Details</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.4">To ensure fair comparisons, we maintain consistent settings across all methods. The embedding size is set to 256, and all methods incorporate the embedding of user attribute information. During the experimentation process, we perform a grid search to identify the optimal hyperparameters. The maximum number of epochs is set to 1000, and training is halted if the NDCG@K summation on the validation dataset does not improve for 20 consecutive epochs.
For our proposed method, the ratio of the compactness loss <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS1.SSS3.p1.1.m1.1"><semantics id="S5.SS1.SSS3.p1.1.m1.1a"><mi id="S5.SS1.SSS3.p1.1.m1.1.1" xref="S5.SS1.SSS3.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.1.m1.1b"><ci id="S5.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS3.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS3.p1.1.m1.1d">italic_λ</annotation></semantics></math> is tuned among <math alttext="\{1\times 10^{-3},1\times 10^{-2},1\times 10^{-1}\}" class="ltx_Math" display="inline" id="S5.SS1.SSS3.p1.2.m2.3"><semantics id="S5.SS1.SSS3.p1.2.m2.3a"><mrow id="S5.SS1.SSS3.p1.2.m2.3.3.3" xref="S5.SS1.SSS3.p1.2.m2.3.3.4.cmml"><mo id="S5.SS1.SSS3.p1.2.m2.3.3.3.4" stretchy="false" xref="S5.SS1.SSS3.p1.2.m2.3.3.4.cmml">{</mo><mrow id="S5.SS1.SSS3.p1.2.m2.1.1.1.1" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.cmml"><mn id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.2" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.2.cmml">1</mn><mo id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.1.cmml">×</mo><msup id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.cmml"><mn id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.2" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.cmml"><mo id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3a" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.cmml">−</mo><mn id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.2" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><mo id="S5.SS1.SSS3.p1.2.m2.3.3.3.5" xref="S5.SS1.SSS3.p1.2.m2.3.3.4.cmml">,</mo><mrow id="S5.SS1.SSS3.p1.2.m2.2.2.2.2" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.cmml"><mn id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.2" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.2.cmml">1</mn><mo id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.1.cmml">×</mo><msup id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.cmml"><mn id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.2" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.2.cmml">10</mn><mrow id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.cmml"><mo id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3a" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.cmml">−</mo><mn id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.2" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.2.cmml">2</mn></mrow></msup></mrow><mo id="S5.SS1.SSS3.p1.2.m2.3.3.3.6" xref="S5.SS1.SSS3.p1.2.m2.3.3.4.cmml">,</mo><mrow id="S5.SS1.SSS3.p1.2.m2.3.3.3.3" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.cmml"><mn id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.2" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.2.cmml">1</mn><mo id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.1.cmml">×</mo><msup id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.cmml"><mn id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.2" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.2.cmml">10</mn><mrow id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.cmml"><mo id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3a" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.cmml">−</mo><mn id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.2" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.2.cmml">1</mn></mrow></msup></mrow><mo id="S5.SS1.SSS3.p1.2.m2.3.3.3.7" stretchy="false" xref="S5.SS1.SSS3.p1.2.m2.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.2.m2.3b"><set id="S5.SS1.SSS3.p1.2.m2.3.3.4.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3.3"><apply id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1"><times id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.1"></times><cn id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.2">1</cn><apply id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3">superscript</csymbol><cn id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.2">10</cn><apply id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3"><minus id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3"></minus><cn id="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.1.1.1.1.3.3.2">3</cn></apply></apply></apply><apply id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.cmml" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2"><times id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.1"></times><cn id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.2">1</cn><apply id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3">superscript</csymbol><cn id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.2">10</cn><apply id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3"><minus id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3"></minus><cn id="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.2.2.2.2.3.3.2">2</cn></apply></apply></apply><apply id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3"><times id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.1"></times><cn id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.2">1</cn><apply id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3">superscript</csymbol><cn id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.2">10</cn><apply id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3"><minus id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.1.cmml" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3"></minus><cn id="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.2.m2.3.3.3.3.3.3.2">1</cn></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.2.m2.3c">\{1\times 10^{-3},1\times 10^{-2},1\times 10^{-1}\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS3.p1.2.m2.3d">{ 1 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT , 1 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT , 1 × 10 start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT }</annotation></semantics></math>, and the value of <math alttext="\epsilon^{2}" class="ltx_Math" display="inline" id="S5.SS1.SSS3.p1.3.m3.1"><semantics id="S5.SS1.SSS3.p1.3.m3.1a"><msup id="S5.SS1.SSS3.p1.3.m3.1.1" xref="S5.SS1.SSS3.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS3.p1.3.m3.1.1.2" xref="S5.SS1.SSS3.p1.3.m3.1.1.2.cmml">ϵ</mi><mn id="S5.SS1.SSS3.p1.3.m3.1.1.3" xref="S5.SS1.SSS3.p1.3.m3.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.3.m3.1b"><apply id="S5.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS3.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS3.p1.3.m3.1.1">superscript</csymbol><ci id="S5.SS1.SSS3.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS3.p1.3.m3.1.1.2">italic-ϵ</ci><cn id="S5.SS1.SSS3.p1.3.m3.1.1.3.cmml" type="integer" xref="S5.SS1.SSS3.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.3.m3.1c">\epsilon^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS3.p1.3.m3.1d">italic_ϵ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is tuned among <math alttext="\{0.5,1,5\}" class="ltx_Math" display="inline" id="S5.SS1.SSS3.p1.4.m4.3"><semantics id="S5.SS1.SSS3.p1.4.m4.3a"><mrow id="S5.SS1.SSS3.p1.4.m4.3.4.2" xref="S5.SS1.SSS3.p1.4.m4.3.4.1.cmml"><mo id="S5.SS1.SSS3.p1.4.m4.3.4.2.1" stretchy="false" xref="S5.SS1.SSS3.p1.4.m4.3.4.1.cmml">{</mo><mn id="S5.SS1.SSS3.p1.4.m4.1.1" xref="S5.SS1.SSS3.p1.4.m4.1.1.cmml">0.5</mn><mo id="S5.SS1.SSS3.p1.4.m4.3.4.2.2" xref="S5.SS1.SSS3.p1.4.m4.3.4.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.4.m4.2.2" xref="S5.SS1.SSS3.p1.4.m4.2.2.cmml">1</mn><mo id="S5.SS1.SSS3.p1.4.m4.3.4.2.3" xref="S5.SS1.SSS3.p1.4.m4.3.4.1.cmml">,</mo><mn id="S5.SS1.SSS3.p1.4.m4.3.3" xref="S5.SS1.SSS3.p1.4.m4.3.3.cmml">5</mn><mo id="S5.SS1.SSS3.p1.4.m4.3.4.2.4" stretchy="false" xref="S5.SS1.SSS3.p1.4.m4.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.4.m4.3b"><set id="S5.SS1.SSS3.p1.4.m4.3.4.1.cmml" xref="S5.SS1.SSS3.p1.4.m4.3.4.2"><cn id="S5.SS1.SSS3.p1.4.m4.1.1.cmml" type="float" xref="S5.SS1.SSS3.p1.4.m4.1.1">0.5</cn><cn id="S5.SS1.SSS3.p1.4.m4.2.2.cmml" type="integer" xref="S5.SS1.SSS3.p1.4.m4.2.2">1</cn><cn id="S5.SS1.SSS3.p1.4.m4.3.3.cmml" type="integer" xref="S5.SS1.SSS3.p1.4.m4.3.3">5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.4.m4.3c">\{0.5,1,5\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS3.p1.4.m4.3d">{ 0.5 , 1 , 5 }</annotation></semantics></math>. As for the baselines, we tune their hyperparameters according to the guidelines provided in their original papers and initialize these parameters using Xavier Initialization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib64" title="">64</a>]</cite>. By adhering to these consistent settings and carefully tuning the hyperparameters, we aim to ensure that our comparisons are both rigorous and fair, providing reliable insights into the performance of the proposed method relative to established baselines.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.4 </span>Evaluation Metrics</h4>
<div class="ltx_para" id="S5.SS1.SSS4.p1">
<p class="ltx_p" id="S5.SS1.SSS4.p1.1">In this study, we assess the performance of comparison methods for the top-K recommendation using two evaluation metrics: Hit Ratio (HR@K) and Normalized Discounted Cumulative Gain (NDCG@K). HR@K measures the average proportion of relevant items in the top-K recommended lists, while NDCG@K evaluates the ranking quality of the top-K lists in a position-wise manner. For fair and efficient evaluation, each positive instance is paired with randomly selected 100 non-interactive items <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib62" title="">62</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#bib.bib40" title="">40</a>]</cite>. In our experiments, we adopt the leave-one-out strategy for performance evaluation. We begin by treating the purchasing as a target behavior and for each user, we regard the temporally ordered last purchase as the test sample and the previous ones as validation samples.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span><span class="ltx_text ltx_font_italic" id="S5.SS2.1.1">Overall Performances</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.T3" title="TABLE III ‣ 5.1.1 Datasets ‣ 5.1 Experimental Setting ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">III</span></a>, we present a detailed performance comparison across various datasets. The key observations from this analysis are summarized as follows:</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">(1). We observe that more advanced multi-behavioral approaches tend to achieve more promising results. This demonstrates the effectiveness of incorporating multiple types of behavioral data into sequential modeling. By leveraging richer user multi-behavior information, these models can better understand and predict user preferences.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">(2). Compared to end-to-end approaches, pre-trained models consistently outperform, highlighting the potential of the pre-training paradigm to enhance downstream task performance. Pre-training empowers models to learn from extensive datasets, capturing intricate patterns that can be fine-tuned for specific tasks, resulting in superior performance. Moreover, as the number of parameters in a pre-trained model increases, its memory capacity expands, facilitating the absorption of larger historical datasets and mitigating concerns related to excessively lengthy sequences.</p>
</div>
<div class="ltx_para" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1">(3). We find that models incorporating denoising techniques during pre-training outperform other methods. This suggests that historical user behavioral noise significantly impacts model performance and needs to be addressed. By removing noise from historical data, these models can learn more accurate representations of user behaviors.</p>
</div>
<div class="ltx_para" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1">(4). Our proposed DPCPL consistently outperforms other methods across all datasets. This highlights the effectiveness of our customized prompt learning and progressive prompt strategies. By dynamically setting prompts based on user-specific information and progressively refining these prompts, DPCPL can better adapt to individual user behaviors and improve recommendation accuracy.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Efficiency experiments compared to fine-tuning.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T4.3" style="width:433.6pt;height:205.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(83.6pt,-39.6pt) scale(1.62785311737402,1.62785311737402) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.3.1.1.1.1"><span class="ltx_text" id="S5.T4.3.1.1.1.1.1" style="font-size:90%;">Datasets</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.3.1.1.1.2"><span class="ltx_text" id="S5.T4.3.1.1.1.2.1" style="font-size:90%;">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.3.1.1.1.3"><span class="ltx_text" id="S5.T4.3.1.1.1.3.1" style="font-size:90%;">Fine-tuning</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T4.3.1.1.1.4"><span class="ltx_text" id="S5.T4.3.1.1.1.4.1" style="font-size:90%;">DPCPL</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.3.1.1.1.5"><span class="ltx_text" id="S5.T4.3.1.1.1.5.1" style="font-size:90%;">Para</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.3.1.1.1.6"><span class="ltx_text" id="S5.T4.3.1.1.1.6.1" style="font-size:90%;">Time</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.3.1.2.1.1" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.2.1.1.1" style="font-size:90%;">CIKM</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.3.1.2.1.2"><span class="ltx_text" id="S5.T4.3.1.2.1.2.1" style="font-size:90%;">H@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.2.1.3"><span class="ltx_text" id="S5.T4.3.1.2.1.3.1" style="font-size:90%;">0.526</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.3.1.2.1.4"><span class="ltx_text" id="S5.T4.3.1.2.1.4.1" style="font-size:90%;">0.519</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.2.1.5" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.2.1.5.1" style="font-size:90%;">1.25%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.2.1.6" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.2.1.6.1" style="font-size:90%;">8.15%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.3.1.3.2.1"><span class="ltx_text" id="S5.T4.3.1.3.2.1.1" style="font-size:90%;">N@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.3.1.3.2.2"><span class="ltx_text" id="S5.T4.3.1.3.2.2.1" style="font-size:90%;">0.302</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.3.1.3.2.3"><span class="ltx_text" id="S5.T4.3.1.3.2.3.1" style="font-size:90%;">0.299</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.3.1.4.3.1" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.4.3.1.1" style="font-size:90%;">Taobao</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.3.1.4.3.2"><span class="ltx_text" id="S5.T4.3.1.4.3.2.1" style="font-size:90%;">H@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.4.3.3"><span class="ltx_text" id="S5.T4.3.1.4.3.3.1" style="font-size:90%;">0.494</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.3.1.4.3.4"><span class="ltx_text" id="S5.T4.3.1.4.3.4.1" style="font-size:90%;">0.484</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.4.3.5" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.4.3.5.1" style="font-size:90%;">1.42%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.4.3.6" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.4.3.6.1" style="font-size:90%;">12.96%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T4.3.1.5.4.1"><span class="ltx_text" id="S5.T4.3.1.5.4.1.1" style="font-size:90%;">N@10</span></th>
<td class="ltx_td ltx_align_center" id="S5.T4.3.1.5.4.2"><span class="ltx_text" id="S5.T4.3.1.5.4.2.1" style="font-size:90%;">0.281</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.3.1.5.4.3"><span class="ltx_text" id="S5.T4.3.1.5.4.3.1" style="font-size:90%;">0.275</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T4.3.1.6.5.1" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.6.5.1.1" style="font-size:90%;">IJCAI</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.3.1.6.5.2"><span class="ltx_text" id="S5.T4.3.1.6.5.2.1" style="font-size:90%;">H@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.1.6.5.3"><span class="ltx_text" id="S5.T4.3.1.6.5.3.1" style="font-size:90%;">0.480</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.3.1.6.5.4"><span class="ltx_text" id="S5.T4.3.1.6.5.4.1" style="font-size:90%;">0.523</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T4.3.1.6.5.5" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.6.5.5.1" style="font-size:90%;">0.86%</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T4.3.1.6.5.6" rowspan="2"><span class="ltx_text" id="S5.T4.3.1.6.5.6.1" style="font-size:90%;">7.43%</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T4.3.1.7.6.1"><span class="ltx_text" id="S5.T4.3.1.7.6.1.1" style="font-size:90%;">N@10</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.3.1.7.6.2"><span class="ltx_text" id="S5.T4.3.1.7.6.2.1" style="font-size:90%;">0.260</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T4.3.1.7.6.3"><span class="ltx_text" id="S5.T4.3.1.7.6.3.1" style="font-size:90%;">0.283</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Ablation study with key modules.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T5.1" style="width:433.6pt;height:195.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(76.8pt,-34.5pt) scale(1.54817948468182,1.54817948468182) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T5.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.1.1.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T5.1.1.1.1.2">CIKM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T5.1.1.1.1.3">Taobao</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T5.1.1.1.1.4">IJCAI</th>
</tr>
<tr class="ltx_tr" id="S5.T5.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.1.2.2.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.1.2.2.2">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T5.1.1.2.2.3">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.1.2.2.4">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T5.1.1.2.2.5">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.1.2.2.6">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.1.2.2.7">N@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.1.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.1.3.1.1">w/o DS</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.1.3.1.2">0.457</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.1.1.3.1.3">0.262</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.1.3.1.4">0.430</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.1.1.3.1.5">0.251</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.1.3.1.6">0.444</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.1.3.1.7">0.241</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.1.1.4.2.1">w/o PS</th>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.4.2.2">0.424</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.1.4.2.3">0.243</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.4.2.4">0.404</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.1.4.2.5">0.235</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.4.2.6">0.414</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.4.2.7">0.221</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.1.1.5.3.1">w/o PG</th>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.5.3.2">0.478</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.1.5.3.3">0.263</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.5.3.4">0.455</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.1.5.3.5">0.251</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.5.3.6">0.470</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.5.3.7">0.266</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.1.1.6.4.1">w/o CT</th>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.6.4.2">0.495</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.1.6.4.3">0.284</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.6.4.4">0.471</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.1.6.4.5">0.269</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.6.4.6">0.496</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.1.6.4.7">0.255</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T5.1.1.7.5.1"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.7.5.1.1">DPCPL</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T5.1.1.7.5.2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.7.5.2.1">0.519</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T5.1.1.7.5.3"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.7.5.3.1">0.299</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T5.1.1.7.5.4"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.7.5.4.1">0.484</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T5.1.1.7.5.5"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.7.5.5.1">0.275</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T5.1.1.7.5.6"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.7.5.6.1">0.523</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T5.1.1.7.5.7"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.7.5.7.1">0.283</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span><span class="ltx_text ltx_font_italic" id="S5.SS3.1.1">Analysis of Efficiency</span>
</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">To explore the efficiency of customized prompts learning, we compare the time overhead and number of parameters with full parameters fine-tuning. Surprisingly, it even approaches or surpasses the overall fine-tuning effect to some extent. In addition, compared to full fine-tuning, DPCPL requires only a limited number of parameters to be tuned and stored, thus demonstrating parameter efficiency. As indicated in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.T4" title="TABLE IV ‣ 5.2 Overall Performances ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">IV</span></a>, the parameter update count in DPCPL amounts to only 1.2%, 1.4%, and 0.8% of that required for full fine-tuning for each dataset. Accordingly, the time required for DPCPL is merely 8.15%, 12.96%, and 7.43% of that needed for full fine-tuning, respectively. It is important to note that since most baselines are based on transformer architectures and typically require full fine-tuning, their performance results are similar to the full fine-tuning method. Compared to the prompt-based fine-tuning method, the robust baseline model DPT, our approach achieves substantial reductions in parameter count and fine-tuning time when applied to the CIKM dataset. Specifically, our method decreases the parameter count to 34.6% and reduces the fine-tuning time to 23.5% of DPT’s requirements. Moreover, our approach demonstrates improvements of approximately 10% across multiple experimental metrics.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.2">In addition to the high efficiency of parameters and time adjusted during the fine-tuning phase, our pre-trained model is also very efficient in the previous complexity analysis in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S4.T1" title="TABLE I ‣ 4.2 De-noised Pre-trained Model ‣ 4 METHODOLOGY ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">I</span></a>. It is noteworthy that the EBM module maintains a time complexity of <math alttext="Ld^{2}/k+Ld\log L" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mrow id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml"><mrow id="S5.SS3.p2.1.m1.1.1.2.2" xref="S5.SS3.p2.1.m1.1.1.2.2.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2.2.2" xref="S5.SS3.p2.1.m1.1.1.2.2.2.cmml">L</mi><mo id="S5.SS3.p2.1.m1.1.1.2.2.1" xref="S5.SS3.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><msup id="S5.SS3.p2.1.m1.1.1.2.2.3" xref="S5.SS3.p2.1.m1.1.1.2.2.3.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2.2.3.2" xref="S5.SS3.p2.1.m1.1.1.2.2.3.2.cmml">d</mi><mn id="S5.SS3.p2.1.m1.1.1.2.2.3.3" xref="S5.SS3.p2.1.m1.1.1.2.2.3.3.cmml">2</mn></msup></mrow><mo id="S5.SS3.p2.1.m1.1.1.2.1" xref="S5.SS3.p2.1.m1.1.1.2.1.cmml">/</mo><mi id="S5.SS3.p2.1.m1.1.1.2.3" xref="S5.SS3.p2.1.m1.1.1.2.3.cmml">k</mi></mrow><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">+</mo><mrow id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml"><mi id="S5.SS3.p2.1.m1.1.1.3.2" xref="S5.SS3.p2.1.m1.1.1.3.2.cmml">L</mi><mo id="S5.SS3.p2.1.m1.1.1.3.1" xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.1.m1.1.1.3.3" xref="S5.SS3.p2.1.m1.1.1.3.3.cmml">d</mi><mo id="S5.SS3.p2.1.m1.1.1.3.1a" lspace="0.167em" xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">⁢</mo><mrow id="S5.SS3.p2.1.m1.1.1.3.4" xref="S5.SS3.p2.1.m1.1.1.3.4.cmml"><mi id="S5.SS3.p2.1.m1.1.1.3.4.1" xref="S5.SS3.p2.1.m1.1.1.3.4.1.cmml">log</mi><mo id="S5.SS3.p2.1.m1.1.1.3.4a" lspace="0.167em" xref="S5.SS3.p2.1.m1.1.1.3.4.cmml">⁡</mo><mi id="S5.SS3.p2.1.m1.1.1.3.4.2" xref="S5.SS3.p2.1.m1.1.1.3.4.2.cmml">L</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><plus id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></plus><apply id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2"><divide id="S5.SS3.p2.1.m1.1.1.2.1.cmml" xref="S5.SS3.p2.1.m1.1.1.2.1"></divide><apply id="S5.SS3.p2.1.m1.1.1.2.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2"><times id="S5.SS3.p2.1.m1.1.1.2.2.1.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2.1"></times><ci id="S5.SS3.p2.1.m1.1.1.2.2.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2.2">𝐿</ci><apply id="S5.SS3.p2.1.m1.1.1.2.2.3.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.2.2.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2.3">superscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.2.2.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2.2.3.2">𝑑</ci><cn id="S5.SS3.p2.1.m1.1.1.2.2.3.3.cmml" type="integer" xref="S5.SS3.p2.1.m1.1.1.2.2.3.3">2</cn></apply></apply><ci id="S5.SS3.p2.1.m1.1.1.2.3.cmml" xref="S5.SS3.p2.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3"><times id="S5.SS3.p2.1.m1.1.1.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3.1"></times><ci id="S5.SS3.p2.1.m1.1.1.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2">𝐿</ci><ci id="S5.SS3.p2.1.m1.1.1.3.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3">𝑑</ci><apply id="S5.SS3.p2.1.m1.1.1.3.4.cmml" xref="S5.SS3.p2.1.m1.1.1.3.4"><log id="S5.SS3.p2.1.m1.1.1.3.4.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3.4.1"></log><ci id="S5.SS3.p2.1.m1.1.1.3.4.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.4.2">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">Ld^{2}/k+Ld\log L</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_L italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_k + italic_L italic_d roman_log italic_L</annotation></semantics></math> and a parameter count of <math alttext="(1+4/k)d^{2}+4d" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mrow id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml"><mrow id="S5.SS3.p2.2.m2.1.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.cmml"><mo id="S5.SS3.p2.2.m2.1.1.1.1.1.2" stretchy="false" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS3.p2.2.m2.1.1.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.cmml"><mn id="S5.SS3.p2.2.m2.1.1.1.1.1.1.2" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.2.cmml">1</mn><mo id="S5.SS3.p2.2.m2.1.1.1.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.cmml"><mn id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.2" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.2.cmml">4</mn><mo id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.1" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.1.cmml">/</mo><mi id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.3" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></mrow><mo id="S5.SS3.p2.2.m2.1.1.1.1.1.3" stretchy="false" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.SS3.p2.2.m2.1.1.1.2" xref="S5.SS3.p2.2.m2.1.1.1.2.cmml">⁢</mo><msup id="S5.SS3.p2.2.m2.1.1.1.3" xref="S5.SS3.p2.2.m2.1.1.1.3.cmml"><mi id="S5.SS3.p2.2.m2.1.1.1.3.2" xref="S5.SS3.p2.2.m2.1.1.1.3.2.cmml">d</mi><mn id="S5.SS3.p2.2.m2.1.1.1.3.3" xref="S5.SS3.p2.2.m2.1.1.1.3.3.cmml">2</mn></msup></mrow><mo id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">+</mo><mrow id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml"><mn id="S5.SS3.p2.2.m2.1.1.3.2" xref="S5.SS3.p2.2.m2.1.1.3.2.cmml">4</mn><mo id="S5.SS3.p2.2.m2.1.1.3.1" xref="S5.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.2.m2.1.1.3.3" xref="S5.SS3.p2.2.m2.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><plus id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2"></plus><apply id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1"><times id="S5.SS3.p2.2.m2.1.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.1.2"></times><apply id="S5.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1"><plus id="S5.SS3.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.1"></plus><cn id="S5.SS3.p2.2.m2.1.1.1.1.1.1.2.cmml" type="integer" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.2">1</cn><apply id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3"><divide id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.1"></divide><cn id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.2">4</cn><ci id="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S5.SS3.p2.2.m2.1.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.3.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.3">superscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.1.3.2.cmml" xref="S5.SS3.p2.2.m2.1.1.1.3.2">𝑑</ci><cn id="S5.SS3.p2.2.m2.1.1.1.3.3.cmml" type="integer" xref="S5.SS3.p2.2.m2.1.1.1.3.3">2</cn></apply></apply><apply id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3"><times id="S5.SS3.p2.2.m2.1.1.3.1.cmml" xref="S5.SS3.p2.2.m2.1.1.3.1"></times><cn id="S5.SS3.p2.2.m2.1.1.3.2.cmml" type="integer" xref="S5.SS3.p2.2.m2.1.1.3.2">4</cn><ci id="S5.SS3.p2.2.m2.1.1.3.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">(1+4/k)d^{2}+4d</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">( 1 + 4 / italic_k ) italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 italic_d</annotation></semantics></math>, which is substantially lower than that of self-attention mechanisms. This design ensures efficient handling of behavioral sequences, with the added benefit of a parameter size that is agnostic to the length of the sequence.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">In conclusion, our pre-trained model architecture follows a linear structure, providing a solid foundation in terms of parameter count and time complexity. Additionally, through customized prompt fine-tuning, we significantly reduce the number of parameters involved in fine-tuning, resulting in faster processing. This highlights that our DPCPL not only delivers impressive results but also demonstrates high efficiency in both pre-training and fine-tuning processes.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span><span class="ltx_text ltx_font_italic" id="S5.SS4.1.1">Ablation Studies</span>
</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">To investigate the effectiveness of each component, we introduce the following variants of DPCPL:</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">(1). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS4.p2.1.1">Variant without Denoising Block (w/o DS)<span class="ltx_text ltx_font_medium" id="S5.SS4.p2.1.1.1"> </span></span> Instead of the EBM block, we exclusively employ the attention block in the pre-trained model.</p>
</div>
<div class="ltx_para" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1">(2). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS4.p3.1.1">Variant without Personalized Prompts (w/o PS)<span class="ltx_text ltx_font_medium" id="S5.SS4.p3.1.1.1"> </span></span> In this variant, instead of employing personalized prompts, we utilize continuous (soft) prompts, which are randomly initialized and trainable, drawing inspiration from methodologies in the field of NLP.</p>
</div>
<div class="ltx_para" id="S5.SS4.p4">
<p class="ltx_p" id="S5.SS4.p4.1">(3). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS4.p4.1.1">Variant without Progressive Prompts (w/o PG)</span> Instead of progressive prompts, we only incorporate prompts into the first layer of our model.</p>
</div>
<div class="ltx_para" id="S5.SS4.p5">
<p class="ltx_p" id="S5.SS4.p5.1">(4). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS4.p5.1.1">Variant without Controllability (w/o CT)</span> In this variant, we do not consider the controllability of prompts. Thus, we omit the regularization loss.</p>
</div>
<div class="ltx_para" id="S5.SS4.p6">
<p class="ltx_p" id="S5.SS4.p6.1">The results are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.T5" title="TABLE V ‣ 5.2 Overall Performances ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">V</span></a>.
Firstly, the (w/o DS) variant demonstrates the effectiveness of our proposed Efficient Behavior Miner (EBM), which can efficiently filter out the noise in the user’s multi-behavioral sequences in the frequency domain, so as to facilitate the model to better learn the user’s behavioral patterns.
Secondly, the (w/o PS) variant demonstrates the validity of our proposed paradigm of customized prompt learning. It highlights the challenge of directly applying the NLP prompt learning paradigm to recommendation problems, necessitating personalized generation. Thirdly, the (w/o PG) variant underscores the significance of progressive prompts. It recognizes that pre-trained models undergo interest condensation in a hierarchical manner, thereby the models require different prompt factors at different layers. This demonstrates the superiority of our proposed Prompt Factor Gate (PFG), which efficiently extracts and combines prompt factors from prompt information. Lastly, the (w/o CT) variant demonstrates the superiority of compactness regularization, which controls the diversity of prompt factors and layer-specific prompts, thereby expanding the representation space extensively.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span><span class="ltx_text ltx_font_italic" id="S5.SS5.1.1">Analysis of the Adaptation to downstream tasks</span>
</h3>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Adaptation experiments with target behavior cart</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T6.1" style="width:433.6pt;height:167.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(76.8pt,-29.6pt) scale(1.54817948468182,1.54817948468182) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T6.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T6.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T6.1.1.1.1.2">CIKM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T6.1.1.1.1.3">Taobao</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T6.1.1.1.1.4">IJCAI</th>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T6.1.1.2.2.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T6.1.1.2.2.2">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T6.1.1.2.2.3">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T6.1.1.2.2.4">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T6.1.1.2.2.5">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T6.1.1.2.2.6">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T6.1.1.2.2.7">N@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.1.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T6.1.1.3.1.1">MBPPR</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.1.2">0.404</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.3.1.3">0.233</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.1.4">0.367</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T6.1.1.3.1.5">0.208</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.1.6">0.444</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.1.3.1.7">0.246</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T6.1.1.4.2.1">DPT</th>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.2.2">0.487</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.4.2.3">0.297</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.2.4">0.477</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.4.2.5">0.282</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.2.6">0.559</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.4.2.7">0.299</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T6.1.1.5.3.1">CPTPP</th>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.3.2">0.534</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.5.3.3">0.342</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.3.4">0.455</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T6.1.1.5.3.5">0.266</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.3.6">0.598</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.1.5.3.7">0.328</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.1.6.4.1"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.4.1.1">DPCPL</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T6.1.1.6.4.2"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.4.2.1">0.582</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.1.6.4.3"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.4.3.1">0.359</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T6.1.1.6.4.4"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.4.4.1">0.499</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T6.1.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.4.5.1">0.293</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T6.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.4.6.1">0.638</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T6.1.1.6.4.7"><span class="ltx_text ltx_font_bold" id="S5.T6.1.1.6.4.7.1">0.345</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>Adaptation experiments with target behavior click.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T7.1" style="width:433.6pt;height:167.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(76.8pt,-29.6pt) scale(1.54817948468182,1.54817948468182) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T7.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T7.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T7.1.1.1.1.2">CIKM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T7.1.1.1.1.3">Taobao</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T7.1.1.1.1.4">IJCAI</th>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.2.2.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.1.1.2.2.2">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T7.1.1.2.2.3">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.1.1.2.2.4">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T7.1.1.2.2.5">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.1.1.2.2.6">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.1.1.2.2.7">N@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T7.1.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T7.1.1.3.1.1">MBPPR</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.1.2">0.485</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.3.1.3">0.280</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.1.4">0.440</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.1.3.1.5">0.250</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.1.6">0.533</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.1.3.1.7">0.295</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.4.2.1">DPT</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.2.2">0.585</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.4.2.3">0.356</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.2.4">0.573</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.4.2.5">0.338</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.2.6">0.671</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.4.2.7">0.359</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T7.1.1.5.3.1">CPTPP</th>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.3.2">0.641</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.5.3.3">0.411</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.3.4">0.546</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T7.1.1.5.3.5">0.320</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.3.6">0.717</td>
<td class="ltx_td ltx_align_center" id="S5.T7.1.1.5.3.7">0.394</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T7.1.1.6.4.1"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.4.1.1">DPCPL</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T7.1.1.6.4.2"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.4.2.1">0.677</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T7.1.1.6.4.3"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.4.3.1">0.429</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T7.1.1.6.4.4"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.4.4.1">0.599</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T7.1.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.4.5.1">0.352</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T7.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.4.6.1">0.762</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T7.1.1.6.4.7"><span class="ltx_text ltx_font_bold" id="S5.T7.1.1.6.4.7.1">0.426</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VIII: </span>Adaptation experiments with the cold-start user.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T8.1" style="width:433.6pt;height:167.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(76.8pt,-29.6pt) scale(1.54817948468182,1.54817948468182) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T8.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T8.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T8.1.1.1.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T8.1.1.1.1.2">CIKM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T8.1.1.1.1.3">Taobao</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T8.1.1.1.1.4">IJCAI</th>
</tr>
<tr class="ltx_tr" id="S5.T8.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T8.1.1.2.2.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T8.1.1.2.2.2">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T8.1.1.2.2.3">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T8.1.1.2.2.4">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T8.1.1.2.2.5">N@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T8.1.1.2.2.6">H@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T8.1.1.2.2.7">N@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T8.1.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T8.1.1.3.1.1">MBPPR</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.1.1.3.1.2">0.137</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T8.1.1.3.1.3">0.079</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.1.1.3.1.4">0.125</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T8.1.1.3.1.5">0.071</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.1.1.3.1.6">0.151</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T8.1.1.3.1.7">0.084</td>
</tr>
<tr class="ltx_tr" id="S5.T8.1.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T8.1.1.4.2.1">DPT</th>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.4.2.2">0.214</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T8.1.1.4.2.3">0.131</td>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.4.2.4">0.210</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T8.1.1.4.2.5">0.124</td>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.4.2.6">0.246</td>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.4.2.7">0.132</td>
</tr>
<tr class="ltx_tr" id="S5.T8.1.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T8.1.1.5.3.1">CPTPP</th>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.5.3.2">0.182</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T8.1.1.5.3.3">0.116</td>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.5.3.4">0.155</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T8.1.1.5.3.5">0.091</td>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.5.3.6">0.203</td>
<td class="ltx_td ltx_align_center" id="S5.T8.1.1.5.3.7">0.112</td>
</tr>
<tr class="ltx_tr" id="S5.T8.1.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S5.T8.1.1.6.4.1"><span class="ltx_text ltx_font_bold" id="S5.T8.1.1.6.4.1.1">DPCPL</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T8.1.1.6.4.2"><span class="ltx_text ltx_font_bold" id="S5.T8.1.1.6.4.2.1">0.310</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T8.1.1.6.4.3"><span class="ltx_text ltx_font_bold" id="S5.T8.1.1.6.4.3.1">0.194</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T8.1.1.6.4.4"><span class="ltx_text ltx_font_bold" id="S5.T8.1.1.6.4.4.1">0.270</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T8.1.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S5.T8.1.1.6.4.5.1">0.158</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T8.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S5.T8.1.1.6.4.6.1">0.344</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S5.T8.1.1.6.4.7"><span class="ltx_text ltx_font_bold" id="S5.T8.1.1.6.4.7.1">0.189</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">In this subsection, we aim to verify the efficient adaptation of our pre-trained model to downstream tasks by conducting experiments on additional tasks.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">The target behavior pertains to the items that have been interacted with within the behavior we endeavor to forecast. As shown in Table  <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.T6" title="TABLE VI ‣ 5.5 Analysis of the Adaptation to downstream tasks ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">VI</span></a> and Table  <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.T7" title="TABLE VII ‣ 5.5 Analysis of the Adaptation to downstream tasks ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">VII</span></a>, we add shopping cart and clicks to the target behaviors and compare them with other baselines respectively, and find that DPCPL not only achieves efficient adaptation with the pre-trained model, but also achieves good results on various tasks.</p>
</div>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">In addition, we define users with target behaviors less than or equal to 2 as cold-start users and use some of the user data for validation. From table <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.T8" title="TABLE VIII ‣ 5.5 Analysis of the Adaptation to downstream tasks ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">VIII</span></a>, we observe that for cold-start users, we improve 30% over the current state-of-the-art model, which proves the effectiveness of DPCPL in small sample scenarios. Compared to traditional multi-behavioral approaches, DPCPL proves to be better at transferring general knowledge to user representations in the presence of insufficient training data, which underscores the generalization ability of our denoising pre-trained model, as well as the knowledge transfer capabilities of customized prompt learning.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="356" id="S5.F4.g1" src="x4.png" width="663"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Hyperparameter sensitivity analysis for the selected hyperparameters: number of prompt factors of each group (<math alttext="N" class="ltx_Math" display="inline" id="S5.F4.5.m1.1"><semantics id="S5.F4.5.m1.1b"><mi id="S5.F4.5.m1.1.1" xref="S5.F4.5.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.F4.5.m1.1c"><ci id="S5.F4.5.m1.1.1.cmml" xref="S5.F4.5.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.5.m1.1d">N</annotation><annotation encoding="application/x-llamapun" id="S5.F4.5.m1.1e">italic_N</annotation></semantics></math>), number of tokens in prompt (<math alttext="C" class="ltx_Math" display="inline" id="S5.F4.6.m2.1"><semantics id="S5.F4.6.m2.1b"><mi id="S5.F4.6.m2.1.1" xref="S5.F4.6.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.F4.6.m2.1c"><ci id="S5.F4.6.m2.1.1.cmml" xref="S5.F4.6.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.6.m2.1d">C</annotation><annotation encoding="application/x-llamapun" id="S5.F4.6.m2.1e">italic_C</annotation></semantics></math>), compactness regularity parameter (<math alttext="\lambda" class="ltx_Math" display="inline" id="S5.F4.7.m3.1"><semantics id="S5.F4.7.m3.1b"><mi id="S5.F4.7.m3.1.1" xref="S5.F4.7.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F4.7.m3.1c"><ci id="S5.F4.7.m3.1.1.cmml" xref="S5.F4.7.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.7.m3.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.F4.7.m3.1e">italic_λ</annotation></semantics></math>), and number of pre-trained model layers (<math alttext="L" class="ltx_Math" display="inline" id="S5.F4.8.m4.1"><semantics id="S5.F4.8.m4.1b"><mi id="S5.F4.8.m4.1.1" xref="S5.F4.8.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.F4.8.m4.1c"><ci id="S5.F4.8.m4.1.1.cmml" xref="S5.F4.8.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.8.m4.1d">L</annotation><annotation encoding="application/x-llamapun" id="S5.F4.8.m4.1e">italic_L</annotation></semantics></math>).</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span><span class="ltx_text ltx_font_italic" id="S5.SS6.1.1">Hyperparameter Analysis</span>
</h3>
<div class="ltx_para" id="S5.SS6.p1">
<p class="ltx_p" id="S5.SS6.p1.1">To examine the impact of various hyperparameters on DPCPL, we conducted experiments with different configurations of key parameters. In this section, we present the results of these experiments, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.F4" title="Figure 4 ‣ 5.5 Analysis of the Adaptation to downstream tasks ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. Our conclusions are summarized below:</p>
</div>
<div class="ltx_para" id="S5.SS6.p2">
<p class="ltx_p" id="S5.SS6.p2.4">(1). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS6.p2.1.1">Number of prompt factors of each group (<math alttext="N" class="ltx_Math" display="inline" id="S5.SS6.p2.1.1.m1.1"><semantics id="S5.SS6.p2.1.1.m1.1a"><mi id="S5.SS6.p2.1.1.m1.1.1" mathvariant="normal" xref="S5.SS6.p2.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.1.1.m1.1b"><ci id="S5.SS6.p2.1.1.m1.1.1.cmml" xref="S5.SS6.p2.1.1.m1.1.1">N</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.1.1.m1.1d">italic_N</annotation></semantics></math>).</span> We observed that <math alttext="N" class="ltx_Math" display="inline" id="S5.SS6.p2.2.m1.1"><semantics id="S5.SS6.p2.2.m1.1a"><mi id="S5.SS6.p2.2.m1.1.1" xref="S5.SS6.p2.2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.2.m1.1b"><ci id="S5.SS6.p2.2.m1.1.1.cmml" xref="S5.SS6.p2.2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.2.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.2.m1.1d">italic_N</annotation></semantics></math> values between 8 to 12 yielded optimal results. Further increasing the <math alttext="N" class="ltx_Math" display="inline" id="S5.SS6.p2.3.m2.1"><semantics id="S5.SS6.p2.3.m2.1a"><mi id="S5.SS6.p2.3.m2.1.1" xref="S5.SS6.p2.3.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.3.m2.1b"><ci id="S5.SS6.p2.3.m2.1.1.cmml" xref="S5.SS6.p2.3.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.3.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.3.m2.1d">italic_N</annotation></semantics></math> value seems likely to have a bad effect on the representation possibly due to overfitting, potentially due to the introduction of noise resulting from excessive <math alttext="N" class="ltx_Math" display="inline" id="S5.SS6.p2.4.m3.1"><semantics id="S5.SS6.p2.4.m3.1a"><mi id="S5.SS6.p2.4.m3.1.1" xref="S5.SS6.p2.4.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.4.m3.1b"><ci id="S5.SS6.p2.4.m3.1.1.cmml" xref="S5.SS6.p2.4.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.4.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.4.m3.1d">italic_N</annotation></semantics></math> values.</p>
</div>
<div class="ltx_para" id="S5.SS6.p3">
<p class="ltx_p" id="S5.SS6.p3.1">(2). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS6.p3.1.1">Number of tokens in prompt (<math alttext="C" class="ltx_Math" display="inline" id="S5.SS6.p3.1.1.m1.1"><semantics id="S5.SS6.p3.1.1.m1.1a"><mi id="S5.SS6.p3.1.1.m1.1.1" mathvariant="normal" xref="S5.SS6.p3.1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.1.1.m1.1b"><ci id="S5.SS6.p3.1.1.m1.1.1.cmml" xref="S5.SS6.p3.1.1.m1.1.1">C</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p3.1.1.m1.1d">italic_C</annotation></semantics></math>).</span> We observed that auxiliary information can be effectively introduced when the token count ranges between 8 to 12. However, increasing the token count beyond this range resulted in a decrease in performance. This decline is potentially due to a reduction in the influence of user behavior input when the token count becomes excessively large, leading to a dilution of the critical information needed for accurate recommendations.</p>
</div>
<div class="ltx_para" id="S5.SS6.p4">
<p class="ltx_p" id="S5.SS6.p4.3">(3). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS6.p4.1.1">Compactness regularity parameter (<math alttext="\bm{\lambda}" class="ltx_Math" display="inline" id="S5.SS6.p4.1.1.m1.1"><semantics id="S5.SS6.p4.1.1.m1.1a"><mi id="S5.SS6.p4.1.1.m1.1.1" xref="S5.SS6.p4.1.1.m1.1.1.cmml">𝝀</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.1.1.m1.1b"><ci id="S5.SS6.p4.1.1.m1.1.1.cmml" xref="S5.SS6.p4.1.1.m1.1.1">𝝀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.1.1.m1.1c">\bm{\lambda}</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.1.1.m1.1d">bold_italic_λ</annotation></semantics></math>).</span> <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS6.p4.2.m1.1"><semantics id="S5.SS6.p4.2.m1.1a"><mi id="S5.SS6.p4.2.m1.1.1" xref="S5.SS6.p4.2.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.2.m1.1b"><ci id="S5.SS6.p4.2.m1.1.1.cmml" xref="S5.SS6.p4.2.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.2.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.2.m1.1d">italic_λ</annotation></semantics></math> controls the weight of the regularization loss. Observations indicate that <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS6.p4.3.m2.1"><semantics id="S5.SS6.p4.3.m2.1a"><mi id="S5.SS6.p4.3.m2.1.1" xref="S5.SS6.p4.3.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p4.3.m2.1b"><ci id="S5.SS6.p4.3.m2.1.1.cmml" xref="S5.SS6.p4.3.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p4.3.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p4.3.m2.1d">italic_λ</annotation></semantics></math> values between 0.01 and 0.001 yield better results. Too much loss of regularization can negatively affect the normal representation of vectors, while insufficient regularization may not add sufficient constraints on the representation of different layers of the prompt.</p>
</div>
<div class="ltx_para" id="S5.SS6.p5">
<p class="ltx_p" id="S5.SS6.p5.1">(4). <span class="ltx_text ltx_font_bold ltx_font_italic" id="S5.SS6.p5.1.1">Number of pre-trained model layers (<math alttext="L" class="ltx_Math" display="inline" id="S5.SS6.p5.1.1.m1.1"><semantics id="S5.SS6.p5.1.1.m1.1a"><mi id="S5.SS6.p5.1.1.m1.1.1" mathvariant="normal" xref="S5.SS6.p5.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p5.1.1.m1.1b"><ci id="S5.SS6.p5.1.1.m1.1.1.cmml" xref="S5.SS6.p5.1.1.m1.1.1">L</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p5.1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p5.1.1.m1.1d">italic_L</annotation></semantics></math>).</span> We further study whether the design of the depth feature extraction network is conducive to the recommendation task. We observe that in most cases, the superimposed four-layer network can show better performance, and with the number of network layers increasing, there follows the risk of overfitting. In particular, in the IJCAI dataset, the deeper network achieves better results. The reason for this phenomenon may be that the IJCAI dataset has a larger volume of data and a longer average length than other datasets CIKM and Taobao, which indicates the necessity of the deep network in processing larger and more complex datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.7 </span><span class="ltx_text ltx_font_italic" id="S5.SS7.1.1">Visualization Analysis.</span>
</h3>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="195" id="S5.F5.g1" src="x5.png" width="390"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Dimensionality reduction visualization of prompt vectors at each layer of models in the CIKM dataset, where the legend indicates the layer of the pre-trained model.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS7.p1">
<p class="ltx_p" id="S5.SS7.p1.1">We specifically conduct visual experiments on the effectiveness of the compactness regularization loss using the CIKM dataset. Specifically, we visualize the prompt vectors at different layers of the pre-trained models generated based on personalized information of some users mapped to a two-dimensional space.</p>
</div>
<div class="ltx_para" id="S5.SS7.p2">
<p class="ltx_p" id="S5.SS7.p2.1">Through experiments, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11372v1#S5.F5" title="Figure 5 ‣ 5.7 Visualization Analysis. ‣ 5 EXPERIMENT ‣ Denoising Pre-Training and Customized Prompt Learning for Efficient Multi-Behavior Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, we observe significant changes in the distribution of prompt vectors at different layers after incorporating regularization. Specifically, prompts at the same layer tend to merge for different users, while there remains relative diversity across different layers of the pre-trained model. This indicates that the proposed regularization loss can control the diversity of prompt factors and further regulate the diversity of prompt vectors across layers. Consequently, it ensures the progressiveness of our proposed customized prompt learning, where prompts needed at different layers of the model vary, aligning with the assumption of users’ interest representation progressively refining across different layers of the model. Additionally, due to user diversity, prompts at the same layer may not be entirely identical for different users, which also aligns with our intuition.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">CONCLUSION</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In conclusion, our proposed approach, DPCPL, introduced an innovative solution for the efficiency challenges in Multi-Behavior Sequential Recommendation. The Efficient Behavior Miner effectively filtered noise in multi-behavior data, enhancing the model’s understanding of contextual semantics. Additionally, the Customized Prompt Learning module enabled highly efficient fine-tuning, leveraging personalized, progressive, and diverse prompts. Extensive experiments on three real-world datasets had unequivocally demonstrated that DPCPL not only exhibited high efficiency and effectiveness, requiring minimal parameter adjustments but also surpassed the state-of-the-art performance across a diverse range of downstream tasks. In the future, we plan to research the integration of finer-grained user interaction data and explore the scalability of efficient denoising modules and customized prompt learning modules in more complex application scenarios.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
H. Wang, T. Xu, Q. Liu, D. Lian, E. Chen, D. Du, H. Wu, and W. Su, “Mcne: An end-to-end framework for learning multiple conditional network representations of social network,” in <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>, 2019, pp. 1064–1072.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. Yin, H. Wang, W. Guo, Y. Liu, S. Zhang, S. Zhao, D. Lian, and E. Chen, “Dataset regeneration for sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2405.17795</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
X. Zhang, B. Xu, F. Ma, C. Li, L. Yang, and H. Lin, “Beyond co-occurrence: Multi-modal session-based recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. Li, Y. Wang, and J. McAuley, “Time interval aware self-attention for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 13th international conference on web search and data mining</em>, 2020, pp. 322–330.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Chen and R. C.-W. Wong, “Handling information loss of graph neural networks for session-based recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, 2020, pp. 1172–1180.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. Zhang, S. Wu, X. Yu, Q. Liu, and L. Wang, “Dynamic graph neural networks for sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, vol. 35, no. 5, pp. 4741–4753, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
H. Du, H. Shi, P. Zhao, D. Wang, V. S. Sheng, Y. Liu, G. Liu, and L. Zhao, “Contrastive learning with bidirectional transformers for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em>, 2022, pp. 396–405.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Z. Wang, H. Liu, W. Wei, Y. Hu, X.-L. Mao, S. He, R. Fang, and D. Chen, “Multi-level contrastive learning framework for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em>, 2022, pp. 2098–2107.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y. Han, L. Wu, H. Wang, G. Wang, M. Zhang, Z. Li, D. Lian, and E. Chen, “Guesr: A global unsupervised data-enhancement with bucket-cluster sampling for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Database Systems for Advanced Applications: 28th International Conference, DASFAA 2023, Tianjin, China, April 17–20, 2023, Proceedings, Part II</em>.   Springer, 2023, pp. 286–296.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
T. Qian, Y. Liang, Q. Li, and H. Xiong, “Attribute graph neural networks for strict cold start recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, vol. 34, no. 8, pp. 3597–3610, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Z. Zhao, Z. Cheng, L. Hong, and E. H. Chi, “Improving user topic interest profiles by behavior factorization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 24th International Conference on World Wide Web</em>, 2015, pp. 1406–1416.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Y. Wu, R. Xie, Y. Zhu, X. Ao, X. Chen, X. Zhang, F. Zhuang, L. Lin, and Q. He, “Multi-view multi-behavior contrastive learning in recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Database Systems for Advanced Applications: 27th International Conference, DASFAA 2022, Virtual Event, April 11–14, 2022, Proceedings, Part II</em>.   Springer, 2022, pp. 166–182.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
L. Xia, C. Huang, Y. Xu, and J. Pei, “Multi-behavior sequential recommendation with temporal graph transformer,” <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
H. Xuan, Y. Liu, B. Li, and H. Yin, “Knowledge enhancement for contrastive multi-behavior recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining</em>, 2023, pp. 195–203.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
F. Yuan, X. He, A. Karatzoglou, and L. Zhang, “Parameter-efficient transfer from sequential behaviors for user modeling and recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval</em>, 2020, pp. 1469–1478.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
C. Xiao, R. Xie, Y. Yao, Z. Liu, M. Sun, X. Zhang, and L. Lin, “Uprec: User-aware pre-training for recommender systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2102.10989</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
N. Pancha, A. Zhai, J. Leskovec, and C. Rosenberg, “Pinnerformer: Sequence modeling for user representation at pinterest,” in <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, 2022, pp. 3702–3712.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
L. Guo, C. Wang, X. Wang, L. Zhu, and H. Yin, “Automated prompting for non-overlapping cross-domain sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2304.04218</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
H. Yang, X. Zhao, Y. Li, H. Chen, and G. Xu, “An empirical study towards prompt-tuning for graph contrastive pre-training in recommendations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
K. Zhou, H. Wang, W. X. Zhao, Y. Zhu, S. Wang, F. Zhang, Z. Wang, and J.-R. Wen, “S3-rec: Self-supervised learning for sequential recommendation with mutual information maximization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 29th ACM international conference on information &amp; knowledge management</em>, 2020, pp. 1893–1902.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
X. Xie, F. Sun, Z. Liu, S. Wu, J. Gao, J. Zhang, B. Ding, and B. Cui, “Contrastive learning for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">2022 IEEE 38th international conference on data engineering (ICDE)</em>.   IEEE, 2022, pp. 1259–1273.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
J. Kirkpatrick, R. Pascanu, N. Rabinowitz, J. Veness, G. Desjardins, A. A. Rusu, K. Milan, J. Quan, T. Ramalho, A. Grabska-Barwinska <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">et al.</em>, “Overcoming catastrophic forgetting in neural networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib22.2.2">Proceedings of the national academy of sciences</em>, vol. 114, no. 13, pp. 3521–3526, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
——, “Overcoming catastrophic forgetting in neural networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the national academy of sciences</em>, vol. 114, no. 13, pp. 3521–3526, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">et al.</em>, “Language models are few-shot learners,” <em class="ltx_emph ltx_font_italic" id="bib.bib24.2.2">Advances in neural information processing systems</em>, vol. 33, pp. 1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
H. J. Nussbaumer and H. J. Nussbaumer, <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">The fast Fourier transform</em>.   Springer, 1982.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
T. Shen, H. Wang, J. Zhang, S. Zhao, L. Li, Z. Chen, D. Lian, and E. Chen, “Exploring user retrieval integration towards large language models for cross-domain sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2406.03085</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Y. Han, H. Wang, K. Wang, L. Wu, Z. Li, W. Guo, Y. Liu, D. Lian, and E. Chen, “Efficient noise-decoupling for multi-behavior sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the ACM on Web Conference 2024</em>, 2024, pp. 3297–3306.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
——, “End4rec: Efficient noise-decoupling for multi-behavior sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2403.17603</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
M. Yin, H. Wang, X. Xu, L. Wu, S. Zhao, W. Guo, Y. Liu, R. Tang, D. Lian, and E. Chen, “Apgl4sr: A generic framework with adaptive and personalized global collaborative information in sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em>, 2023, pp. 3009–3019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
L. Wu, Z. Zheng, Z. Qiu, H. Wang, H. Gu, T. Shen, C. Qin, C. Zhu, H. Zhu, Q. Liu <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">et al.</em>, “A survey on large language models for recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib30.2.2">arXiv preprint arXiv:2305.19860</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
H. Wang, D. Lian, H. Tong, Q. Liu, Z. Huang, and E. Chen, “Hypersorec: Exploiting hyperbolic user and item representations with multiple aspects for social-aware recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">ACM Transactions on Information Systems (TOIS)</em>, vol. 40, no. 2, pp. 1–28, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
F. Sun, J. Liu, J. Wu, C. Pei, X. Lin, W. Ou, and P. Jiang, “Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer,” in <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, 2019, pp. 1441–1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
G. Zhou, X. Zhu, C. Song, Y. Fan, H. Zhu, X. Ma, Y. Yan, J. Jin, H. Li, and K. Gai, “Deep interest network for click-through rate prediction,” in <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>, 2018, pp. 1059–1068.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
W.-C. Kang and J. McAuley, “Self-attentive sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">2018 IEEE international conference on data mining (ICDM)</em>.   IEEE, 2018, pp. 197–206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
X. Du, H. Yuan, P. Zhao, J. Qu, F. Zhuang, G. Liu, Y. Liu, and V. S. Sheng, “Frequency enhanced hybrid attention network for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2023, pp. 78–88.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
C. Gao, X. He, D. Gan, X. Chen, F. Feng, Y. Li, T.-S. Chua, and D. Jin, “Neural multi-task recommendation from multi-behavior data,” in <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">2019 IEEE 35th international conference on data engineering (ICDE)</em>.   IEEE, 2019, pp. 1554–1557.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
L. Guo, L. Hua, R. Jia, B. Zhao, X. Wang, and B. Cui, “Buying or browsing?: Predicting real-time purchasing intent using attention-based deep network with multiple behavior,” in <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, 2019, pp. 1984–1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
C. Wu, F. Wu, T. Qi, Q. Liu, X. Tian, J. Li, W. He, Y. Huang, and X. Xie, “Feedrec: News feed recommendation with various user feedbacks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the ACM Web Conference 2022</em>, 2022, pp. 2088–2097.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
C. Chen, M. Zhang, Y. Zhang, W. Ma, Y. Liu, and S. Ma, “Efficient heterogeneous collaborative filtering without negative sampling for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, vol. 34, no. 01, 2020, pp. 19–26.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
L. Xia, Y. Xu, C. Huang, P. Dai, and L. Bo, “Graph meta network for multi-behavior recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 44th international ACM SIGIR conference on research and development in information retrieval</em>, 2021, pp. 757–766.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
K. Yuan, G. Liu, J. Wu, and H. Xiong, “Semantic and structural view fusion modeling for social recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
L. Xia, C. Huang, Y. Xu, P. Dai, B. Zhang, and L. Bo, “Multiplex behavioral relation learning for recommendation via memory augmented transformer network,” in <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the 43rd international ACM SIGIR conference on research and development in information retrieval</em>, 2020, pp. 2397–2406.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
W. Wei, C. Huang, L. Xia, Y. Xu, J. Zhao, and D. Yin, “Contrastive meta learning with behavior multiplicity for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the fifteenth ACM international conference on web search and data mining</em>, 2022, pp. 1120–1128.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Y. Ni, D. Ou, S. Liu, X. Li, W. Ou, A. Zeng, and L. Si, “Perceive your users in depth: Learning universal user representations from multiple e-commerce tasks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, 2018, pp. 596–605.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
J. Yang, J. Xu, J. Tong, S. Gao, J. Guo, and J. Wen, “Pre-training of context-aware item representation for next basket recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:1904.12604</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Z. Liu, Z. Fan, Y. Wang, and P. S. Yu, “Augmenting sequential recommendation with pseudo-prior items via reversely pre-training transformer,” in <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 44th international ACM SIGIR conference on Research and development in information retrieval</em>, 2021, pp. 1608–1612.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
H. Xue and F. D. Salim, “Promptcast: A new prompt-based learning paradigm for time series forecasting,” <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Y. Wu, R. Xie, Y. Zhu, F. Zhuang, X. Zhang, L. Lin, and Q. He, “Personalized prompts for sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2205.09666</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
W. Hua, Y. Ge, S. Xu, J. Ji, and Y. Zhang, “Up5: Unbiased foundation model for fairness-aware recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:2305.12090</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
C. Zhang, R. Chen, X. Zhao, Q. Han, and L. Li, “Denoising and prompt-tuning for multi-behavior recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the ACM Web Conference 2023</em>, 2023, pp. 1355–1363.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
K. Zhou, H. Yu, W. X. Zhao, and J.-R. Wen, “Filter-enhanced mlp is all you need for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the ACM web conference 2022</em>, 2022, pp. 2388–2399.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
L. Chi, B. Jiang, and Y. Mu, “Fast fourier convolution,” <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Advances in Neural Information Processing Systems</em>, vol. 33, pp. 4479–4488, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
P. Liu, W. Yuan, J. Fu, Z. Jiang, H. Hayashi, and G. Neubig, “Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing,” <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">ACM Computing Surveys</em>, vol. 55, no. 9, pp. 1–35, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
L. Li, Y. Zhang, and L. Chen, “Personalized prompt learning for explainable recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">ACM Transactions on Information Systems</em>, vol. 41, no. 4, pp. 1–26, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Z. Zhang and B. Wang, “Prompt learning for news recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2304.05263</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
M. Yin, C. Wu, Y. Wang, H. Wang, W. Guo, Y. Wang, Y. Liu, R. Tang, D. Lian, and E. Chen, “Entropy law: The story behind data compression and llm performance,” <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:2407.06645</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
T. L, “Compensated compactness and applications to partial differential equations,” <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">Nonlinear analysis and mechanics: Heriot-Watt symposium</em>, 1979.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
K. H. R. Chan, Y. Yu, C. You, H. Qi, J. Wright, and Y. Ma, “Redunet: A white-box deep network from the principle of maximizing rate reduction,” <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">The Journal of Machine Learning Research</em>, vol. 23, no. 1, pp. 4907–5009, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Y. Yang, C. Huang, L. Xia, Y. Liang, Y. Yu, and C. Li, “Multi-behavior hypergraph-enhanced transformer for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Proceedings of the 28th ACM SIGKDD conference on knowledge discovery and data mining</em>, 2022, pp. 2263–2274.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
B. Hidasi, A. Karatzoglou, L. Baltrunas, and D. Tikk, “Session-based recommendations with recurrent neural networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">arXiv preprint arXiv:1511.06939</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
B. Jin, C. Gao, X. He, D. Jin, and Y. Li, “Multi-behavior recommendation with graph convolutional networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2020, pp. 659–668.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
L. Xia, C. Huang, Y. Xu, P. Dai, X. Zhang, H. Yang, J. Pei, and L. Bo, “Knowledge-enhanced hierarchical graph transformer network for multi-behavior recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, vol. 35, no. 5, 2021, pp. 4486–4493.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
C. Meng, Z. Zhao, W. Guo, Y. Zhang, H. Wu, C. Gao, D. Li, X. Li, and R. Tang, “Coarse-to-fine knowledge-enhanced multi-interest learning framework for multi-behavior recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">arXiv preprint arXiv:2208.01849</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
X. Glorot and Y. Bengio, “Understanding the difficulty of training deep feedforward neural networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">Proceedings of the thirteenth international conference on artificial intelligence and statistics</em>.   JMLR Workshop and Conference Proceedings, 2010, pp. 249–256.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Aug 21 06:46:14 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
