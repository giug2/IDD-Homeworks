<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2205.13697] FedFormer: Contextual Federation with Attention in Reinforcement Learning</title><meta property="og:description" content="A core issue in multi-agent federated reinforcement learning is defining how to aggregate insights from multiple agents. This is commonly done by taking the average of each participating agent’s model weights into one …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedFormer: Contextual Federation with Attention in Reinforcement Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedFormer: Contextual Federation with Attention in Reinforcement Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2205.13697">

<!--Generated on Mon Mar 11 13:00:16 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning,  Multi-agent Learning,  Transformer Networks">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\setcopyright</span>
<p id="p1.2" class="ltx_p">ifaamas
<span id="p1.2.1" class="ltx_ERROR undefined">\acmConference</span>[AAMAS ’23]Proc. of the 22nd International Conference
on Autonomous Agents and Multiagent Systems (AAMAS 2023)May 29 – June 2, 2023
London, United KingdomA. Ricci, W. Yeoh, N. Agmon, B. An (eds.)
<span id="p1.2.2" class="ltx_ERROR undefined">\copyrightyear</span>2023
<span id="p1.2.3" class="ltx_ERROR undefined">\acmYear</span>2023
<span id="p1.2.4" class="ltx_ERROR undefined">\acmDOI</span>
<span id="p1.2.5" class="ltx_ERROR undefined">\acmPrice</span>
<span id="p1.2.6" class="ltx_ERROR undefined">\acmISBN</span>
<span id="p1.2.7" class="ltx_ERROR undefined">\acmSubmissionID</span>316


<span id="p1.2.8" class="ltx_ERROR undefined">\affiliation</span>
<span id="p1.2.9" class="ltx_ERROR undefined">\institution</span>University of Waterloo
<span id="p1.2.10" class="ltx_ERROR undefined">\city</span>Waterloo
<span id="p1.2.11" class="ltx_ERROR undefined">\country</span>Canada


<span id="p1.2.12" class="ltx_ERROR undefined">\affiliation</span>
<span id="p1.2.13" class="ltx_ERROR undefined">\institution</span>University of Waterloo
<span id="p1.2.14" class="ltx_ERROR undefined">\city</span>Waterloo
<span id="p1.2.15" class="ltx_ERROR undefined">\country</span>Canada


<span id="p1.2.16" class="ltx_ERROR undefined">\affiliation</span>
<span id="p1.2.17" class="ltx_ERROR undefined">\institution</span>University of Waterloo, Waterloo, Canada
<span id="p1.2.18" class="ltx_ERROR undefined">\city</span>Vector Institute, Toronto
<span id="p1.2.19" class="ltx_ERROR undefined">\country</span>Canada


<span id="p1.2.20" class="ltx_ERROR undefined">\affiliation</span>
<span id="p1.2.21" class="ltx_ERROR undefined">\institution</span>University of Waterloo
<span id="p1.2.22" class="ltx_ERROR undefined">\city</span>Waterloo
<span id="p1.2.23" class="ltx_ERROR undefined">\country</span>Canada</p>
</div>
<h1 class="ltx_title ltx_title_document">FedFormer: Contextual Federation with Attention in Reinforcement Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liam Hebert
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:liam.hebert@uwaterloo.ca">liam.hebert@uwaterloo.ca</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lukasz Golab
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lgolab@uwaterloo.ca">lgolab@uwaterloo.ca</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pascal Poupart
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ppoupart@uwaterloo.ca">ppoupart@uwaterloo.ca</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Robin Cohen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:rcohen@uwaterloo.ca">rcohen@uwaterloo.ca</a>
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id1.id1" class="ltx_p">A core issue in multi-agent federated reinforcement learning is defining how to aggregate insights from multiple agents. This is commonly done by taking the average of each participating agent’s model weights into one common model (FedAvg). We instead propose FedFormer, a novel federation strategy that utilizes Transformer Attention to contextually aggregate embeddings from models originating from different learner agents. In so doing, we attentively weigh the contributions of other agents with respect to the current agent’s environment and learned relationships, thus providing a more effective and efficient federation. We evaluate our methods on the Meta-World environment and find that our approach yields significant improvements over FedAvg and non-federated Soft Actor-Critic single-agent methods. Our results compared to Soft Actor-Critic show that FedFormer achieves higher episodic return while still abiding by the privacy constraints of federated learning. Finally, we also demonstrate improvements in effectiveness with increased agent pools across all methods in certain tasks. This is contrasted by FedAvg, which fails to make noticeable improvements when scaled.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Key words and phrases: </h6>Federated Learning, Multi-agent Learning, Transformer Networks
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Reinforcement learning has become a ubiquitous tool
in applications such as autonomous vehicles <cite class="ltx_cite ltx_citemacro_citep">(Sallab
et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2017</a>; Shalev-Shwartz et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2016</a>)</cite>, where vehicles learn to navigate the streets of many complex environments, and Internet-of-Things devices <cite class="ltx_cite ltx_citemacro_citep">(Mohammadi et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2017</a>; Bu and Wang, <a href="#bib.bib2" title="" class="ltx_ref">2019</a>; Xiong
et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2020</a>)</cite>. However, to obtain robust performance, a large collection of training episodes is often needed. In the case of safety-critical systems such as autonomous vehicles, training episodes must also be diverse enough to account for the many possible edge cases that the system could face. As a result, the scale and diversity of data collection needed to achieve adequate performance quickly becomes infeasible for a single party. To account for these challenges, a common technique for data collection relies on crowdsourcing, where training episodes are collected from many agents that explore their local environment and then transmitted to a central controller to train a generalized model <cite class="ltx_cite ltx_citemacro_citep">(Qi
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, this strategy comes with a crucial challenge: privacy. In our example of autonomous vehicles, training data consist of sensitive images of local surroundings, which need to be broadcast over the internet to a centralized source. This presents an opportunity for bad actors to intercept these data for malicious purposes. Motivated by this challenge, privacy-preserving federated machine learning and federated reinforcement learning have been proposed. Here, rather than transmitting training observations, local model weights are transmitted instead. These model weights are then aggregated by a centralized controller to form a new common model, all without seeing any sensitive data.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The current state-of-the-art general method in federated reinforcement learning to combine agents is FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>. This strategy takes the weighted average of transmitted model weights across all agents according to the number of observations that an agent has seen. However, there are several drawbacks that come with this approach. In reinforcement learning, policy and critic networks are already prone to instability, which could be further exacerbated by the averaging of model parameters. In addition, the averaging of model weights across multiple agents often prohibits individual exploration in non-identical environments, a challenge when federating models explore diverse environments <cite class="ltx_cite ltx_citemacro_citep">(Qi
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. An example of this can be seen in autonomous vehicles, where knowledge gained from agents exploring rural roads is less useful to agents exploring urban cities. Despite this, contributions from both sets of agents would still be equally weighted under FedAvg, potentially creating a final agent that performs worse in both environments.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To address these drawbacks, inspired by recent advancements in natural language processing, we propose Federated Transformers (FedFormer), a novel federation policy based on transformer encoder models <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2017</a>; Devlin
et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>. Instead of taking the average of model weights, we utilize transformer encoders to learn contextual relationships between agents. We then leverage these learned relationships to contextually federate agents together during inference. This method allows local agents to maintain models specific to their environment, allowing for local exploration, while also contextually including insights from other agents according to their relevance to the current environment. Importantly, these relationships can be learned without divulging confidential metadata, such as geolocation data, health information or other sensitive attributes. In addition, we compute these relationships during each time step, allowing for the dynamic federation as an agent’s environment changes throughout the episode. This allows our approach to providing a more efficient aggregation of model insights during inference.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We evaluate FedFormer using the Meta-World environment <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>, a benchmark of robotic manipulation tasks.
Despite training on heterogeneous environments, our approach brings improved episodic return over FedAvg and over non-federated Soft Actor-Critic (SAC) <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja
et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite> single-agent methods. This is despite SAC being trained on the entire set of environments as the federated strategies, representing performance without the privacy constraints of the federation. We also demonstrate the onboarding performance of FedFormer, finding that convergence speed increases 5-fold by leveraging pre-trained agents in the federation network despite being applied to never-before-seen environments. Notably, these results are obtained without intervention from the other agents, further increasing privacy and effectiveness. When scaled to 10 and 15 agents, FedFormer outperforms the episodic return of FedAvg by a factor of 2.4 and 3.8 at the last epoch, respectively. This illustrates that FedFormer performs well when scaled to increased agent pools (with matching or increased performance), whereas FedAvg fails to make noticeable improvements or presents degraded performance when scaled. In all, our results illustrate that FedFormer performs better than state-of-the-art FedAvg, scales without degradation of performance, and is more effective than single-agent Soft Actor-Critic while still abiding by the privacy constraints of federated learning. Our source code is available at <a target="_blank" href="https://github.com/liamhebert/FedFormer" title="" class="ltx_ref ltx_href">https://github.com/liamhebert/FedFormer</a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Background</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Federated Learning and Federated Reinforcement Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">There are four key properties of federated learning: distribution, data protection, generality and status equality <cite class="ltx_cite ltx_citemacro_citep">(Qi
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. Distribution states that federated model training is done in parallel by all participating models. Data protection ensures that the training data held by each participating party is not transmitted to other parties. Generality states that federated models must generalize to diverse environments. Finally, status equality ensures that training favours all participating parties equally, and often with identical infrastructures.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.3" class="ltx_p">Satisfying these constraints, <cite class="ltx_cite ltx_citemacro_citet">McMahan et al<span class="ltx_text">.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> proposed the FedAvg federation strategy. Given a set of <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">N</annotation></semantics></math> parties with loss functions <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="\{\mathcal{F}_{i}\}^{N}_{i=1}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><msubsup id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mrow id="S2.SS1.p2.2.m2.1.1.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p2.2.m2.1.1.1.1.1.2" xref="S2.SS1.p2.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S2.SS1.p2.2.m2.1.1.1.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.2.m2.1.1.1.1.1.1.2" xref="S2.SS1.p2.2.m2.1.1.1.1.1.1.2.cmml">ℱ</mi><mi id="S2.SS1.p2.2.m2.1.1.1.1.1.1.3" xref="S2.SS1.p2.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p2.2.m2.1.1.1.1.1.3" xref="S2.SS1.p2.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml"><mi id="S2.SS1.p2.2.m2.1.1.3.2" xref="S2.SS1.p2.2.m2.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p2.2.m2.1.1.3.1" xref="S2.SS1.p2.2.m2.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p2.2.m2.1.1.3.3" xref="S2.SS1.p2.2.m2.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p2.2.m2.1.1.1.3" xref="S2.SS1.p2.2.m2.1.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><apply id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1">superscript</csymbol><set id="S2.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.1"><apply id="S2.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.1.1.2">ℱ</ci><ci id="S2.SS1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S2.SS1.p2.2.m2.1.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.1.3">𝑁</ci></apply><apply id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3"><eq id="S2.SS1.p2.2.m2.1.1.3.1.cmml" xref="S2.SS1.p2.2.m2.1.1.3.1"></eq><ci id="S2.SS1.p2.2.m2.1.1.3.2.cmml" xref="S2.SS1.p2.2.m2.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p2.2.m2.1.1.3.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\{\mathcal{F}_{i}\}^{N}_{i=1}</annotation></semantics></math> and datasets <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="\{D_{i}\}^{N}_{i=1}\in D" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><mrow id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><msubsup id="S2.SS1.p2.3.m3.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.cmml"><mrow id="S2.SS1.p2.3.m3.1.1.1.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p2.3.m3.1.1.1.1.1.1.2" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS1.p2.3.m3.1.1.1.1.1.1.1" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.2" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.2.cmml">D</mi><mi id="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.3" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p2.3.m3.1.1.1.1.1.1.3" xref="S2.SS1.p2.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p2.3.m3.1.1.1.3" xref="S2.SS1.p2.3.m3.1.1.1.3.cmml"><mi id="S2.SS1.p2.3.m3.1.1.1.3.2" xref="S2.SS1.p2.3.m3.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p2.3.m3.1.1.1.3.1" xref="S2.SS1.p2.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p2.3.m3.1.1.1.3.3" xref="S2.SS1.p2.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p2.3.m3.1.1.1.1.3" xref="S2.SS1.p2.3.m3.1.1.1.1.3.cmml">N</mi></msubsup><mo id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">∈</mo><mi id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><in id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2"></in><apply id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1">subscript</csymbol><apply id="S2.SS1.p2.3.m3.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1">superscript</csymbol><set id="S2.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1"><apply id="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.2">𝐷</ci><ci id="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S2.SS1.p2.3.m3.1.1.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.1.1.3">𝑁</ci></apply><apply id="S2.SS1.p2.3.m3.1.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.1.3"><eq id="S2.SS1.p2.3.m3.1.1.1.3.1.cmml" xref="S2.SS1.p2.3.m3.1.1.1.3.1"></eq><ci id="S2.SS1.p2.3.m3.1.1.1.3.2.cmml" xref="S2.SS1.p2.3.m3.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p2.3.m3.1.1.1.3.3.cmml" xref="S2.SS1.p2.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\{D_{i}\}^{N}_{i=1}\in D</annotation></semantics></math> interested in formulating a joint cooperative model, FedAvg updates a centralized model as</p>
<table id="A0.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.2" class="ltx_Math" alttext="\displaystyle\forall i,w_{i}(t+1)" display="inline"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.3.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mo rspace="0.167em" id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml">∀</mo><mi id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">i</mi></mrow><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml"><msub id="S2.E1.m1.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.3.cmml"><mi id="S2.E1.m1.2.2.2.2.3.2" xref="S2.E1.m1.2.2.2.2.3.2.cmml">w</mi><mi id="S2.E1.m1.2.2.2.2.3.3" xref="S2.E1.m1.2.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.cmml">​</mo><mrow id="S2.E1.m1.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.1.2" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.2.1.1.1.2.cmml">t</mi><mo id="S2.E1.m1.2.2.2.2.1.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.1.cmml">+</mo><mn id="S2.E1.m1.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.1.3" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><list id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.2"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1">for-all</csymbol><ci id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2">𝑖</ci></apply><apply id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"><times id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2"></times><apply id="S2.E1.m1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.3.2">𝑤</ci><ci id="S2.E1.m1.2.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.3.3">𝑖</ci></apply><apply id="S2.E1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1"><plus id="S2.E1.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.1"></plus><ci id="S2.E1.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="S2.E1.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\displaystyle\forall i,w_{i}(t+1)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1.m2.3" class="ltx_Math" alttext="\displaystyle=w_{i}(t)-\gamma\nabla F_{i}(w_{i}(t))" display="inline"><semantics id="S2.E1.m2.3a"><mrow id="S2.E1.m2.3.3" xref="S2.E1.m2.3.3.cmml"><mi id="S2.E1.m2.3.3.3" xref="S2.E1.m2.3.3.3.cmml"></mi><mo id="S2.E1.m2.3.3.2" xref="S2.E1.m2.3.3.2.cmml">=</mo><mrow id="S2.E1.m2.3.3.1" xref="S2.E1.m2.3.3.1.cmml"><mrow id="S2.E1.m2.3.3.1.3" xref="S2.E1.m2.3.3.1.3.cmml"><msub id="S2.E1.m2.3.3.1.3.2" xref="S2.E1.m2.3.3.1.3.2.cmml"><mi id="S2.E1.m2.3.3.1.3.2.2" xref="S2.E1.m2.3.3.1.3.2.2.cmml">w</mi><mi id="S2.E1.m2.3.3.1.3.2.3" xref="S2.E1.m2.3.3.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m2.3.3.1.3.1" xref="S2.E1.m2.3.3.1.3.1.cmml">​</mo><mrow id="S2.E1.m2.3.3.1.3.3.2" xref="S2.E1.m2.3.3.1.3.cmml"><mo stretchy="false" id="S2.E1.m2.3.3.1.3.3.2.1" xref="S2.E1.m2.3.3.1.3.cmml">(</mo><mi id="S2.E1.m2.1.1" xref="S2.E1.m2.1.1.cmml">t</mi><mo stretchy="false" id="S2.E1.m2.3.3.1.3.3.2.2" xref="S2.E1.m2.3.3.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m2.3.3.1.2" xref="S2.E1.m2.3.3.1.2.cmml">−</mo><mrow id="S2.E1.m2.3.3.1.1" xref="S2.E1.m2.3.3.1.1.cmml"><mi id="S2.E1.m2.3.3.1.1.3" xref="S2.E1.m2.3.3.1.1.3.cmml">γ</mi><mo lspace="0.167em" rspace="0em" id="S2.E1.m2.3.3.1.1.2" xref="S2.E1.m2.3.3.1.1.2.cmml">​</mo><mrow id="S2.E1.m2.3.3.1.1.4" xref="S2.E1.m2.3.3.1.1.4.cmml"><mo rspace="0.167em" id="S2.E1.m2.3.3.1.1.4.1" xref="S2.E1.m2.3.3.1.1.4.1.cmml">∇</mo><msub id="S2.E1.m2.3.3.1.1.4.2" xref="S2.E1.m2.3.3.1.1.4.2.cmml"><mi id="S2.E1.m2.3.3.1.1.4.2.2" xref="S2.E1.m2.3.3.1.1.4.2.2.cmml">F</mi><mi id="S2.E1.m2.3.3.1.1.4.2.3" xref="S2.E1.m2.3.3.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m2.3.3.1.1.2a" xref="S2.E1.m2.3.3.1.1.2.cmml">​</mo><mrow id="S2.E1.m2.3.3.1.1.1.1" xref="S2.E1.m2.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m2.3.3.1.1.1.1.2" xref="S2.E1.m2.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m2.3.3.1.1.1.1.1" xref="S2.E1.m2.3.3.1.1.1.1.1.cmml"><msub id="S2.E1.m2.3.3.1.1.1.1.1.2" xref="S2.E1.m2.3.3.1.1.1.1.1.2.cmml"><mi id="S2.E1.m2.3.3.1.1.1.1.1.2.2" xref="S2.E1.m2.3.3.1.1.1.1.1.2.2.cmml">w</mi><mi id="S2.E1.m2.3.3.1.1.1.1.1.2.3" xref="S2.E1.m2.3.3.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m2.3.3.1.1.1.1.1.1" xref="S2.E1.m2.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E1.m2.3.3.1.1.1.1.1.3.2" xref="S2.E1.m2.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m2.3.3.1.1.1.1.1.3.2.1" xref="S2.E1.m2.3.3.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m2.2.2" xref="S2.E1.m2.2.2.cmml">t</mi><mo stretchy="false" id="S2.E1.m2.3.3.1.1.1.1.1.3.2.2" xref="S2.E1.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m2.3.3.1.1.1.1.3" xref="S2.E1.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m2.3b"><apply id="S2.E1.m2.3.3.cmml" xref="S2.E1.m2.3.3"><eq id="S2.E1.m2.3.3.2.cmml" xref="S2.E1.m2.3.3.2"></eq><csymbol cd="latexml" id="S2.E1.m2.3.3.3.cmml" xref="S2.E1.m2.3.3.3">absent</csymbol><apply id="S2.E1.m2.3.3.1.cmml" xref="S2.E1.m2.3.3.1"><minus id="S2.E1.m2.3.3.1.2.cmml" xref="S2.E1.m2.3.3.1.2"></minus><apply id="S2.E1.m2.3.3.1.3.cmml" xref="S2.E1.m2.3.3.1.3"><times id="S2.E1.m2.3.3.1.3.1.cmml" xref="S2.E1.m2.3.3.1.3.1"></times><apply id="S2.E1.m2.3.3.1.3.2.cmml" xref="S2.E1.m2.3.3.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m2.3.3.1.3.2.1.cmml" xref="S2.E1.m2.3.3.1.3.2">subscript</csymbol><ci id="S2.E1.m2.3.3.1.3.2.2.cmml" xref="S2.E1.m2.3.3.1.3.2.2">𝑤</ci><ci id="S2.E1.m2.3.3.1.3.2.3.cmml" xref="S2.E1.m2.3.3.1.3.2.3">𝑖</ci></apply><ci id="S2.E1.m2.1.1.cmml" xref="S2.E1.m2.1.1">𝑡</ci></apply><apply id="S2.E1.m2.3.3.1.1.cmml" xref="S2.E1.m2.3.3.1.1"><times id="S2.E1.m2.3.3.1.1.2.cmml" xref="S2.E1.m2.3.3.1.1.2"></times><ci id="S2.E1.m2.3.3.1.1.3.cmml" xref="S2.E1.m2.3.3.1.1.3">𝛾</ci><apply id="S2.E1.m2.3.3.1.1.4.cmml" xref="S2.E1.m2.3.3.1.1.4"><ci id="S2.E1.m2.3.3.1.1.4.1.cmml" xref="S2.E1.m2.3.3.1.1.4.1">∇</ci><apply id="S2.E1.m2.3.3.1.1.4.2.cmml" xref="S2.E1.m2.3.3.1.1.4.2"><csymbol cd="ambiguous" id="S2.E1.m2.3.3.1.1.4.2.1.cmml" xref="S2.E1.m2.3.3.1.1.4.2">subscript</csymbol><ci id="S2.E1.m2.3.3.1.1.4.2.2.cmml" xref="S2.E1.m2.3.3.1.1.4.2.2">𝐹</ci><ci id="S2.E1.m2.3.3.1.1.4.2.3.cmml" xref="S2.E1.m2.3.3.1.1.4.2.3">𝑖</ci></apply></apply><apply id="S2.E1.m2.3.3.1.1.1.1.1.cmml" xref="S2.E1.m2.3.3.1.1.1.1"><times id="S2.E1.m2.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m2.3.3.1.1.1.1.1.1"></times><apply id="S2.E1.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.E1.m2.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m2.3.3.1.1.1.1.1.2.1.cmml" xref="S2.E1.m2.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m2.3.3.1.1.1.1.1.2.2.cmml" xref="S2.E1.m2.3.3.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.E1.m2.3.3.1.1.1.1.1.2.3.cmml" xref="S2.E1.m2.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E1.m2.2.2.cmml" xref="S2.E1.m2.2.2">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m2.3c">\displaystyle=w_{i}(t)-\gamma\nabla F_{i}(w_{i}(t))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle w_{g}(t+1)" display="inline"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml">w</mi><mi id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><times id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></times><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2">𝑤</ci><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">𝑔</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"><plus id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"></plus><ci id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle w_{g}(t+1)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}w_{i}(t+1)" display="inline"><semantics id="S2.E2.m2.3a"><mrow id="S2.E2.m2.3.3" xref="S2.E2.m2.3.3.cmml"><mi id="S2.E2.m2.3.3.3" xref="S2.E2.m2.3.3.3.cmml"></mi><mo id="S2.E2.m2.3.3.2" xref="S2.E2.m2.3.3.2.cmml">=</mo><mrow id="S2.E2.m2.3.3.1" xref="S2.E2.m2.3.3.1.cmml"><mstyle displaystyle="true" id="S2.E2.m2.3.3.1.2" xref="S2.E2.m2.3.3.1.2.cmml"><munderover id="S2.E2.m2.3.3.1.2a" xref="S2.E2.m2.3.3.1.2.cmml"><mo movablelimits="false" id="S2.E2.m2.3.3.1.2.2.2" xref="S2.E2.m2.3.3.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m2.3.3.1.2.2.3" xref="S2.E2.m2.3.3.1.2.2.3.cmml"><mi id="S2.E2.m2.3.3.1.2.2.3.2" xref="S2.E2.m2.3.3.1.2.2.3.2.cmml">i</mi><mo id="S2.E2.m2.3.3.1.2.2.3.1" xref="S2.E2.m2.3.3.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m2.3.3.1.2.2.3.3" xref="S2.E2.m2.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m2.3.3.1.2.3" xref="S2.E2.m2.3.3.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S2.E2.m2.3.3.1.1" xref="S2.E2.m2.3.3.1.1.cmml"><mstyle displaystyle="true" id="S2.E2.m2.2.2" xref="S2.E2.m2.2.2.cmml"><mfrac id="S2.E2.m2.2.2a" xref="S2.E2.m2.2.2.cmml"><mrow id="S2.E2.m2.1.1.1.1" xref="S2.E2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m2.1.1.1.1.2" xref="S2.E2.m2.1.1.1.2.1.cmml">|</mo><msub id="S2.E2.m2.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.cmml"><mi id="S2.E2.m2.1.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.1.2.cmml">D</mi><mi id="S2.E2.m2.1.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E2.m2.1.1.1.1.3" xref="S2.E2.m2.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S2.E2.m2.2.2.2.3" xref="S2.E2.m2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E2.m2.2.2.2.3.1" xref="S2.E2.m2.2.2.2.2.1.cmml">|</mo><mi id="S2.E2.m2.2.2.2.1" xref="S2.E2.m2.2.2.2.1.cmml">D</mi><mo stretchy="false" id="S2.E2.m2.2.2.2.3.2" xref="S2.E2.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2.m2.3.3.1.1.2" xref="S2.E2.m2.3.3.1.1.2.cmml">​</mo><msub id="S2.E2.m2.3.3.1.1.3" xref="S2.E2.m2.3.3.1.1.3.cmml"><mi id="S2.E2.m2.3.3.1.1.3.2" xref="S2.E2.m2.3.3.1.1.3.2.cmml">w</mi><mi id="S2.E2.m2.3.3.1.1.3.3" xref="S2.E2.m2.3.3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m2.3.3.1.1.2a" xref="S2.E2.m2.3.3.1.1.2.cmml">​</mo><mrow id="S2.E2.m2.3.3.1.1.1.1" xref="S2.E2.m2.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m2.3.3.1.1.1.1.2" xref="S2.E2.m2.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m2.3.3.1.1.1.1.1" xref="S2.E2.m2.3.3.1.1.1.1.1.cmml"><mi id="S2.E2.m2.3.3.1.1.1.1.1.2" xref="S2.E2.m2.3.3.1.1.1.1.1.2.cmml">t</mi><mo id="S2.E2.m2.3.3.1.1.1.1.1.1" xref="S2.E2.m2.3.3.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E2.m2.3.3.1.1.1.1.1.3" xref="S2.E2.m2.3.3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E2.m2.3.3.1.1.1.1.3" xref="S2.E2.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.3b"><apply id="S2.E2.m2.3.3.cmml" xref="S2.E2.m2.3.3"><eq id="S2.E2.m2.3.3.2.cmml" xref="S2.E2.m2.3.3.2"></eq><csymbol cd="latexml" id="S2.E2.m2.3.3.3.cmml" xref="S2.E2.m2.3.3.3">absent</csymbol><apply id="S2.E2.m2.3.3.1.cmml" xref="S2.E2.m2.3.3.1"><apply id="S2.E2.m2.3.3.1.2.cmml" xref="S2.E2.m2.3.3.1.2"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.1.2.1.cmml" xref="S2.E2.m2.3.3.1.2">superscript</csymbol><apply id="S2.E2.m2.3.3.1.2.2.cmml" xref="S2.E2.m2.3.3.1.2"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.1.2.2.1.cmml" xref="S2.E2.m2.3.3.1.2">subscript</csymbol><sum id="S2.E2.m2.3.3.1.2.2.2.cmml" xref="S2.E2.m2.3.3.1.2.2.2"></sum><apply id="S2.E2.m2.3.3.1.2.2.3.cmml" xref="S2.E2.m2.3.3.1.2.2.3"><eq id="S2.E2.m2.3.3.1.2.2.3.1.cmml" xref="S2.E2.m2.3.3.1.2.2.3.1"></eq><ci id="S2.E2.m2.3.3.1.2.2.3.2.cmml" xref="S2.E2.m2.3.3.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m2.3.3.1.2.2.3.3.cmml" xref="S2.E2.m2.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m2.3.3.1.2.3.cmml" xref="S2.E2.m2.3.3.1.2.3">𝑁</ci></apply><apply id="S2.E2.m2.3.3.1.1.cmml" xref="S2.E2.m2.3.3.1.1"><times id="S2.E2.m2.3.3.1.1.2.cmml" xref="S2.E2.m2.3.3.1.1.2"></times><apply id="S2.E2.m2.2.2.cmml" xref="S2.E2.m2.2.2"><divide id="S2.E2.m2.2.2.3.cmml" xref="S2.E2.m2.2.2"></divide><apply id="S2.E2.m2.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1"><abs id="S2.E2.m2.1.1.1.2.1.cmml" xref="S2.E2.m2.1.1.1.1.2"></abs><apply id="S2.E2.m2.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m2.1.1.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1.1.2">𝐷</ci><ci id="S2.E2.m2.1.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.E2.m2.2.2.2.2.cmml" xref="S2.E2.m2.2.2.2.3"><abs id="S2.E2.m2.2.2.2.2.1.cmml" xref="S2.E2.m2.2.2.2.3.1"></abs><ci id="S2.E2.m2.2.2.2.1.cmml" xref="S2.E2.m2.2.2.2.1">𝐷</ci></apply></apply><apply id="S2.E2.m2.3.3.1.1.3.cmml" xref="S2.E2.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m2.3.3.1.1.3.1.cmml" xref="S2.E2.m2.3.3.1.1.3">subscript</csymbol><ci id="S2.E2.m2.3.3.1.1.3.2.cmml" xref="S2.E2.m2.3.3.1.1.3.2">𝑤</ci><ci id="S2.E2.m2.3.3.1.1.3.3.cmml" xref="S2.E2.m2.3.3.1.1.3.3">𝑖</ci></apply><apply id="S2.E2.m2.3.3.1.1.1.1.1.cmml" xref="S2.E2.m2.3.3.1.1.1.1"><plus id="S2.E2.m2.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m2.3.3.1.1.1.1.1.1"></plus><ci id="S2.E2.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.E2.m2.3.3.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S2.E2.m2.3.3.1.1.1.1.1.3.cmml" xref="S2.E2.m2.3.3.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.3c">\displaystyle=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}w_{i}(t+1)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.8" class="ltx_p">where <math id="S2.SS1.p2.4.m1.1" class="ltx_Math" alttext="w_{i}(t)" display="inline"><semantics id="S2.SS1.p2.4.m1.1a"><mrow id="S2.SS1.p2.4.m1.1.2" xref="S2.SS1.p2.4.m1.1.2.cmml"><msub id="S2.SS1.p2.4.m1.1.2.2" xref="S2.SS1.p2.4.m1.1.2.2.cmml"><mi id="S2.SS1.p2.4.m1.1.2.2.2" xref="S2.SS1.p2.4.m1.1.2.2.2.cmml">w</mi><mi id="S2.SS1.p2.4.m1.1.2.2.3" xref="S2.SS1.p2.4.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p2.4.m1.1.2.1" xref="S2.SS1.p2.4.m1.1.2.1.cmml">​</mo><mrow id="S2.SS1.p2.4.m1.1.2.3.2" xref="S2.SS1.p2.4.m1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p2.4.m1.1.2.3.2.1" xref="S2.SS1.p2.4.m1.1.2.cmml">(</mo><mi id="S2.SS1.p2.4.m1.1.1" xref="S2.SS1.p2.4.m1.1.1.cmml">t</mi><mo stretchy="false" id="S2.SS1.p2.4.m1.1.2.3.2.2" xref="S2.SS1.p2.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m1.1b"><apply id="S2.SS1.p2.4.m1.1.2.cmml" xref="S2.SS1.p2.4.m1.1.2"><times id="S2.SS1.p2.4.m1.1.2.1.cmml" xref="S2.SS1.p2.4.m1.1.2.1"></times><apply id="S2.SS1.p2.4.m1.1.2.2.cmml" xref="S2.SS1.p2.4.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m1.1.2.2.1.cmml" xref="S2.SS1.p2.4.m1.1.2.2">subscript</csymbol><ci id="S2.SS1.p2.4.m1.1.2.2.2.cmml" xref="S2.SS1.p2.4.m1.1.2.2.2">𝑤</ci><ci id="S2.SS1.p2.4.m1.1.2.2.3.cmml" xref="S2.SS1.p2.4.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p2.4.m1.1.1.cmml" xref="S2.SS1.p2.4.m1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m1.1c">w_{i}(t)</annotation></semantics></math> is the model update computed by agent <math id="S2.SS1.p2.5.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p2.5.m2.1a"><mi id="S2.SS1.p2.5.m2.1.1" xref="S2.SS1.p2.5.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m2.1b"><ci id="S2.SS1.p2.5.m2.1.1.cmml" xref="S2.SS1.p2.5.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m2.1c">i</annotation></semantics></math> at time step <math id="S2.SS1.p2.6.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p2.6.m3.1a"><mi id="S2.SS1.p2.6.m3.1.1" xref="S2.SS1.p2.6.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m3.1b"><ci id="S2.SS1.p2.6.m3.1.1.cmml" xref="S2.SS1.p2.6.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m3.1c">t</annotation></semantics></math>, <math id="S2.SS1.p2.7.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S2.SS1.p2.7.m4.1a"><mi id="S2.SS1.p2.7.m4.1.1" xref="S2.SS1.p2.7.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m4.1b"><ci id="S2.SS1.p2.7.m4.1.1.cmml" xref="S2.SS1.p2.7.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m4.1c">\gamma</annotation></semantics></math> is a fixed learning rate and <math id="S2.SS1.p2.8.m5.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S2.SS1.p2.8.m5.1a"><msub id="S2.SS1.p2.8.m5.1.1" xref="S2.SS1.p2.8.m5.1.1.cmml"><mi id="S2.SS1.p2.8.m5.1.1.2" xref="S2.SS1.p2.8.m5.1.1.2.cmml">w</mi><mi id="S2.SS1.p2.8.m5.1.1.3" xref="S2.SS1.p2.8.m5.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m5.1b"><apply id="S2.SS1.p2.8.m5.1.1.cmml" xref="S2.SS1.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m5.1.1.1.cmml" xref="S2.SS1.p2.8.m5.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m5.1.1.2.cmml" xref="S2.SS1.p2.8.m5.1.1.2">𝑤</ci><ci id="S2.SS1.p2.8.m5.1.1.3.cmml" xref="S2.SS1.p2.8.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m5.1c">w_{g}</annotation></semantics></math> are the parameters of the centralized model. Under this policy, one can tune how often each model communicates its parameters to the centralized source. This strategy has been transferred to reinforcement learning, with many techniques applying FedAvg to federate policy and critic networks <cite class="ltx_cite ltx_citemacro_citep">(Qi
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. The most common extension of FedAvg is to introduce domain-specific adjustments to the weighing of model parameters. This has been done in the context of the game Pong <cite class="ltx_cite ltx_citemacro_citep">(Nadiger
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite>; for ioT devices, to optimize edge computation <cite class="ltx_cite ltx_citemacro_citep">(Ren
et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2019</a>; Wang
et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020b</a>; Tehrani
et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>, and for the valued, recent application of real-time electric vehicle charging
<cite class="ltx_cite ltx_citemacro_citep">(Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Another direction in federated reinforcement learning is to utilize metadata about agents to weigh their contributions. <cite class="ltx_cite ltx_citemacro_citet">Lim
et al<span class="ltx_text">.</span> (<a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Chu
et al<span class="ltx_text">.</span> (<a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite>
weigh agent contributions according to their average reward.
Similarly, <cite class="ltx_cite ltx_citemacro_citet">Wang
et al<span class="ltx_text">.</span> (<a href="#bib.bib34" title="" class="ltx_ref">2020a</a>)</cite> propose weighing FedAvg according to metadata such as batch size, average loss, dataset size and hit rate. In each of these prior settings, the training environments are similar, allowing for a non-disruptive application of parameter averaging. We refer to this class of federated methods as Weighted Federated Averaging.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">However, it has also been shown that the performance of FedAvg degrades significantly when environments are perturbed and are heterogeneous between agents <cite class="ltx_cite ltx_citemacro_citep">(Qi
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. This is important since in many prior works, it is assumed that the environments of agents are consistent and non-heterogeneous <cite class="ltx_cite ltx_citemacro_cite">Ren
et al<span class="ltx_text">.</span> (<a href="#bib.bib26" title="" class="ltx_ref">2019</a>); Wang
et al<span class="ltx_text">.</span> (<a href="#bib.bib35" title="" class="ltx_ref">2020b</a>); Tehrani
et al<span class="ltx_text">.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>. For other examples of federated reinforcement learning, we refer the reader to a survey by <cite class="ltx_cite ltx_citemacro_citet">Qi
et al<span class="ltx_text">.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. Since most of the prior work relies on FedAvg with minor adjustments towards domain-specific goals, different model structures or additional processing steps prior to applying FedAvg, we focus our attention on directly comparing to FedAvg and Weighted FedAvg. This aligns with our focus on proposing a method that can directly replace FedAvg with a focus on applications for federated reinforcement learning.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p">In this work, we mitigate the downfalls of FedAvg and propose a general framework for federated reinforcement learning that utilizes an attention-based aggregation mechanism to federate agent predictions. Instead of using a hand-made federation strategy, we utilize a transformer model to learn contextual relationships between agents for federation. This approach allows federated reinforcement learning to be applied to tasks where environments are significantly different while still benefiting from the mutual federation.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Reinforcement Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.27" class="ltx_p">Reinforcement Learning (RL) is based on a formalization of Markov Decision Processes with a set <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">S</annotation></semantics></math> of states <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">s</annotation></semantics></math>, a set <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">A</annotation></semantics></math> of actions <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">a</annotation></semantics></math>, a transition function <math id="S2.SS2.p1.5.m5.3" class="ltx_Math" alttext="P(s^{\prime}|s,a)" display="inline"><semantics id="S2.SS2.p1.5.m5.3a"><mrow id="S2.SS2.p1.5.m5.3.3" xref="S2.SS2.p1.5.m5.3.3.cmml"><mi id="S2.SS2.p1.5.m5.3.3.3" xref="S2.SS2.p1.5.m5.3.3.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.m5.3.3.2" xref="S2.SS2.p1.5.m5.3.3.2.cmml">​</mo><mrow id="S2.SS2.p1.5.m5.3.3.1.1" xref="S2.SS2.p1.5.m5.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.5.m5.3.3.1.1.2" xref="S2.SS2.p1.5.m5.3.3.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.5.m5.3.3.1.1.1" xref="S2.SS2.p1.5.m5.3.3.1.1.1.cmml"><msup id="S2.SS2.p1.5.m5.3.3.1.1.1.2" xref="S2.SS2.p1.5.m5.3.3.1.1.1.2.cmml"><mi id="S2.SS2.p1.5.m5.3.3.1.1.1.2.2" xref="S2.SS2.p1.5.m5.3.3.1.1.1.2.2.cmml">s</mi><mo id="S2.SS2.p1.5.m5.3.3.1.1.1.2.3" xref="S2.SS2.p1.5.m5.3.3.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="S2.SS2.p1.5.m5.3.3.1.1.1.1" xref="S2.SS2.p1.5.m5.3.3.1.1.1.1.cmml">|</mo><mrow id="S2.SS2.p1.5.m5.3.3.1.1.1.3.2" xref="S2.SS2.p1.5.m5.3.3.1.1.1.3.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">s</mi><mo id="S2.SS2.p1.5.m5.3.3.1.1.1.3.2.1" xref="S2.SS2.p1.5.m5.3.3.1.1.1.3.1.cmml">,</mo><mi id="S2.SS2.p1.5.m5.2.2" xref="S2.SS2.p1.5.m5.2.2.cmml">a</mi></mrow></mrow><mo stretchy="false" id="S2.SS2.p1.5.m5.3.3.1.1.3" xref="S2.SS2.p1.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.3b"><apply id="S2.SS2.p1.5.m5.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3"><times id="S2.SS2.p1.5.m5.3.3.2.cmml" xref="S2.SS2.p1.5.m5.3.3.2"></times><ci id="S2.SS2.p1.5.m5.3.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3.3">𝑃</ci><apply id="S2.SS2.p1.5.m5.3.3.1.1.1.cmml" xref="S2.SS2.p1.5.m5.3.3.1.1"><csymbol cd="latexml" id="S2.SS2.p1.5.m5.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.5.m5.3.3.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p1.5.m5.3.3.1.1.1.2.cmml" xref="S2.SS2.p1.5.m5.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.3.3.1.1.1.2.1.cmml" xref="S2.SS2.p1.5.m5.3.3.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p1.5.m5.3.3.1.1.1.2.2.cmml" xref="S2.SS2.p1.5.m5.3.3.1.1.1.2.2">𝑠</ci><ci id="S2.SS2.p1.5.m5.3.3.1.1.1.2.3.cmml" xref="S2.SS2.p1.5.m5.3.3.1.1.1.2.3">′</ci></apply><list id="S2.SS2.p1.5.m5.3.3.1.1.1.3.1.cmml" xref="S2.SS2.p1.5.m5.3.3.1.1.1.3.2"><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">𝑠</ci><ci id="S2.SS2.p1.5.m5.2.2.cmml" xref="S2.SS2.p1.5.m5.2.2">𝑎</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.3c">P(s^{\prime}|s,a)</annotation></semantics></math> that indicates the probability of reaching state <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="s^{\prime}" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><msup id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">s</mi><mo id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">𝑠</ci><ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">s^{\prime}</annotation></semantics></math> when executing action <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">a</annotation></semantics></math> in state <math id="S2.SS2.p1.8.m8.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p1.8.m8.1a"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">s</annotation></semantics></math>, a reward function <math id="S2.SS2.p1.9.m9.2" class="ltx_Math" alttext="R(s,a)=r\in\Re" display="inline"><semantics id="S2.SS2.p1.9.m9.2a"><mrow id="S2.SS2.p1.9.m9.2.3" xref="S2.SS2.p1.9.m9.2.3.cmml"><mrow id="S2.SS2.p1.9.m9.2.3.2" xref="S2.SS2.p1.9.m9.2.3.2.cmml"><mi id="S2.SS2.p1.9.m9.2.3.2.2" xref="S2.SS2.p1.9.m9.2.3.2.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.9.m9.2.3.2.1" xref="S2.SS2.p1.9.m9.2.3.2.1.cmml">​</mo><mrow id="S2.SS2.p1.9.m9.2.3.2.3.2" xref="S2.SS2.p1.9.m9.2.3.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.p1.9.m9.2.3.2.3.2.1" xref="S2.SS2.p1.9.m9.2.3.2.3.1.cmml">(</mo><mi id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">s</mi><mo id="S2.SS2.p1.9.m9.2.3.2.3.2.2" xref="S2.SS2.p1.9.m9.2.3.2.3.1.cmml">,</mo><mi id="S2.SS2.p1.9.m9.2.2" xref="S2.SS2.p1.9.m9.2.2.cmml">a</mi><mo stretchy="false" id="S2.SS2.p1.9.m9.2.3.2.3.2.3" xref="S2.SS2.p1.9.m9.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.9.m9.2.3.3" xref="S2.SS2.p1.9.m9.2.3.3.cmml">=</mo><mi id="S2.SS2.p1.9.m9.2.3.4" xref="S2.SS2.p1.9.m9.2.3.4.cmml">r</mi><mo id="S2.SS2.p1.9.m9.2.3.5" xref="S2.SS2.p1.9.m9.2.3.5.cmml">∈</mo><mi mathvariant="normal" id="S2.SS2.p1.9.m9.2.3.6" xref="S2.SS2.p1.9.m9.2.3.6.cmml">ℜ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.2b"><apply id="S2.SS2.p1.9.m9.2.3.cmml" xref="S2.SS2.p1.9.m9.2.3"><and id="S2.SS2.p1.9.m9.2.3a.cmml" xref="S2.SS2.p1.9.m9.2.3"></and><apply id="S2.SS2.p1.9.m9.2.3b.cmml" xref="S2.SS2.p1.9.m9.2.3"><eq id="S2.SS2.p1.9.m9.2.3.3.cmml" xref="S2.SS2.p1.9.m9.2.3.3"></eq><apply id="S2.SS2.p1.9.m9.2.3.2.cmml" xref="S2.SS2.p1.9.m9.2.3.2"><times id="S2.SS2.p1.9.m9.2.3.2.1.cmml" xref="S2.SS2.p1.9.m9.2.3.2.1"></times><ci id="S2.SS2.p1.9.m9.2.3.2.2.cmml" xref="S2.SS2.p1.9.m9.2.3.2.2">𝑅</ci><interval closure="open" id="S2.SS2.p1.9.m9.2.3.2.3.1.cmml" xref="S2.SS2.p1.9.m9.2.3.2.3.2"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">𝑠</ci><ci id="S2.SS2.p1.9.m9.2.2.cmml" xref="S2.SS2.p1.9.m9.2.2">𝑎</ci></interval></apply><ci id="S2.SS2.p1.9.m9.2.3.4.cmml" xref="S2.SS2.p1.9.m9.2.3.4">𝑟</ci></apply><apply id="S2.SS2.p1.9.m9.2.3c.cmml" xref="S2.SS2.p1.9.m9.2.3"><in id="S2.SS2.p1.9.m9.2.3.5.cmml" xref="S2.SS2.p1.9.m9.2.3.5"></in><share href="#S2.SS2.p1.9.m9.2.3.4.cmml" id="S2.SS2.p1.9.m9.2.3d.cmml" xref="S2.SS2.p1.9.m9.2.3"></share><real id="S2.SS2.p1.9.m9.2.3.6.cmml" xref="S2.SS2.p1.9.m9.2.3.6"></real></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.2c">R(s,a)=r\in\Re</annotation></semantics></math> that returns the expected immediate reward of executing <math id="S2.SS2.p1.10.m10.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p1.10.m10.1a"><mi id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">a</annotation></semantics></math> in <math id="S2.SS2.p1.11.m11.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p1.11.m11.1a"><mi id="S2.SS2.p1.11.m11.1.1" xref="S2.SS2.p1.11.m11.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m11.1b"><ci id="S2.SS2.p1.11.m11.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m11.1c">s</annotation></semantics></math>, a discount factor <math id="S2.SS2.p1.12.m12.2" class="ltx_Math" alttext="\gamma\in[0,1)" display="inline"><semantics id="S2.SS2.p1.12.m12.2a"><mrow id="S2.SS2.p1.12.m12.2.3" xref="S2.SS2.p1.12.m12.2.3.cmml"><mi id="S2.SS2.p1.12.m12.2.3.2" xref="S2.SS2.p1.12.m12.2.3.2.cmml">γ</mi><mo id="S2.SS2.p1.12.m12.2.3.1" xref="S2.SS2.p1.12.m12.2.3.1.cmml">∈</mo><mrow id="S2.SS2.p1.12.m12.2.3.3.2" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p1.12.m12.2.3.3.2.1" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml">[</mo><mn id="S2.SS2.p1.12.m12.1.1" xref="S2.SS2.p1.12.m12.1.1.cmml">0</mn><mo id="S2.SS2.p1.12.m12.2.3.3.2.2" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.12.m12.2.2" xref="S2.SS2.p1.12.m12.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS2.p1.12.m12.2.3.3.2.3" xref="S2.SS2.p1.12.m12.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m12.2b"><apply id="S2.SS2.p1.12.m12.2.3.cmml" xref="S2.SS2.p1.12.m12.2.3"><in id="S2.SS2.p1.12.m12.2.3.1.cmml" xref="S2.SS2.p1.12.m12.2.3.1"></in><ci id="S2.SS2.p1.12.m12.2.3.2.cmml" xref="S2.SS2.p1.12.m12.2.3.2">𝛾</ci><interval closure="closed-open" id="S2.SS2.p1.12.m12.2.3.3.1.cmml" xref="S2.SS2.p1.12.m12.2.3.3.2"><cn type="integer" id="S2.SS2.p1.12.m12.1.1.cmml" xref="S2.SS2.p1.12.m12.1.1">0</cn><cn type="integer" id="S2.SS2.p1.12.m12.2.2.cmml" xref="S2.SS2.p1.12.m12.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m12.2c">\gamma\in[0,1)</annotation></semantics></math>, and a planning horizon <math id="S2.SS2.p1.13.m13.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S2.SS2.p1.13.m13.1a"><mi id="S2.SS2.p1.13.m13.1.1" xref="S2.SS2.p1.13.m13.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m13.1b"><ci id="S2.SS2.p1.13.m13.1.1.cmml" xref="S2.SS2.p1.13.m13.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m13.1c">h</annotation></semantics></math> (assumed to be infinite throughout this paper). In RL, an agent optimizes a policy <math id="S2.SS2.p1.14.m14.1" class="ltx_Math" alttext="\pi(a|s)" display="inline"><semantics id="S2.SS2.p1.14.m14.1a"><mrow id="S2.SS2.p1.14.m14.1.1" xref="S2.SS2.p1.14.m14.1.1.cmml"><mi id="S2.SS2.p1.14.m14.1.1.3" xref="S2.SS2.p1.14.m14.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.14.m14.1.1.2" xref="S2.SS2.p1.14.m14.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.14.m14.1.1.1.1" xref="S2.SS2.p1.14.m14.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.14.m14.1.1.1.1.2" xref="S2.SS2.p1.14.m14.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.14.m14.1.1.1.1.1" xref="S2.SS2.p1.14.m14.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.14.m14.1.1.1.1.1.2" xref="S2.SS2.p1.14.m14.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.SS2.p1.14.m14.1.1.1.1.1.1" xref="S2.SS2.p1.14.m14.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p1.14.m14.1.1.1.1.1.3" xref="S2.SS2.p1.14.m14.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="S2.SS2.p1.14.m14.1.1.1.1.3" xref="S2.SS2.p1.14.m14.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m14.1b"><apply id="S2.SS2.p1.14.m14.1.1.cmml" xref="S2.SS2.p1.14.m14.1.1"><times id="S2.SS2.p1.14.m14.1.1.2.cmml" xref="S2.SS2.p1.14.m14.1.1.2"></times><ci id="S2.SS2.p1.14.m14.1.1.3.cmml" xref="S2.SS2.p1.14.m14.1.1.3">𝜋</ci><apply id="S2.SS2.p1.14.m14.1.1.1.1.1.cmml" xref="S2.SS2.p1.14.m14.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.14.m14.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.14.m14.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p1.14.m14.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.14.m14.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.14.m14.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.14.m14.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m14.1c">\pi(a|s)</annotation></semantics></math> that indicates the probability of executing <math id="S2.SS2.p1.15.m15.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p1.15.m15.1a"><mi id="S2.SS2.p1.15.m15.1.1" xref="S2.SS2.p1.15.m15.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m15.1b"><ci id="S2.SS2.p1.15.m15.1.1.cmml" xref="S2.SS2.p1.15.m15.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m15.1c">a</annotation></semantics></math> in <math id="S2.SS2.p1.16.m16.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p1.16.m16.1a"><mi id="S2.SS2.p1.16.m16.1.1" xref="S2.SS2.p1.16.m16.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m16.1b"><ci id="S2.SS2.p1.16.m16.1.1.cmml" xref="S2.SS2.p1.16.m16.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m16.1c">s</annotation></semantics></math>. The value <math id="S2.SS2.p1.17.m17.1" class="ltx_Math" alttext="J^{\pi}(s)" display="inline"><semantics id="S2.SS2.p1.17.m17.1a"><mrow id="S2.SS2.p1.17.m17.1.2" xref="S2.SS2.p1.17.m17.1.2.cmml"><msup id="S2.SS2.p1.17.m17.1.2.2" xref="S2.SS2.p1.17.m17.1.2.2.cmml"><mi id="S2.SS2.p1.17.m17.1.2.2.2" xref="S2.SS2.p1.17.m17.1.2.2.2.cmml">J</mi><mi id="S2.SS2.p1.17.m17.1.2.2.3" xref="S2.SS2.p1.17.m17.1.2.2.3.cmml">π</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p1.17.m17.1.2.1" xref="S2.SS2.p1.17.m17.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.17.m17.1.2.3.2" xref="S2.SS2.p1.17.m17.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.17.m17.1.2.3.2.1" xref="S2.SS2.p1.17.m17.1.2.cmml">(</mo><mi id="S2.SS2.p1.17.m17.1.1" xref="S2.SS2.p1.17.m17.1.1.cmml">s</mi><mo stretchy="false" id="S2.SS2.p1.17.m17.1.2.3.2.2" xref="S2.SS2.p1.17.m17.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m17.1b"><apply id="S2.SS2.p1.17.m17.1.2.cmml" xref="S2.SS2.p1.17.m17.1.2"><times id="S2.SS2.p1.17.m17.1.2.1.cmml" xref="S2.SS2.p1.17.m17.1.2.1"></times><apply id="S2.SS2.p1.17.m17.1.2.2.cmml" xref="S2.SS2.p1.17.m17.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.17.m17.1.2.2.1.cmml" xref="S2.SS2.p1.17.m17.1.2.2">superscript</csymbol><ci id="S2.SS2.p1.17.m17.1.2.2.2.cmml" xref="S2.SS2.p1.17.m17.1.2.2.2">𝐽</ci><ci id="S2.SS2.p1.17.m17.1.2.2.3.cmml" xref="S2.SS2.p1.17.m17.1.2.2.3">𝜋</ci></apply><ci id="S2.SS2.p1.17.m17.1.1.cmml" xref="S2.SS2.p1.17.m17.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m17.1c">J^{\pi}(s)</annotation></semantics></math> of executing a policy <math id="S2.SS2.p1.18.m18.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S2.SS2.p1.18.m18.1a"><mi id="S2.SS2.p1.18.m18.1.1" xref="S2.SS2.p1.18.m18.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.m18.1b"><ci id="S2.SS2.p1.18.m18.1.1.cmml" xref="S2.SS2.p1.18.m18.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.m18.1c">\pi</annotation></semantics></math> when starting in state <math id="S2.SS2.p1.19.m19.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p1.19.m19.1a"><mi id="S2.SS2.p1.19.m19.1.1" xref="S2.SS2.p1.19.m19.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.19.m19.1b"><ci id="S2.SS2.p1.19.m19.1.1.cmml" xref="S2.SS2.p1.19.m19.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.19.m19.1c">s</annotation></semantics></math> is the sum of expected discounted rewards (i.e., <math id="S2.SS2.p1.20.m20.2" class="ltx_Math" alttext="J^{\pi}(s_{0})=E_{\pi}[\sum_{t=0}^{h}\gamma^{t}R(s_{t},a_{t})]" display="inline"><semantics id="S2.SS2.p1.20.m20.2a"><mrow id="S2.SS2.p1.20.m20.2.2" xref="S2.SS2.p1.20.m20.2.2.cmml"><mrow id="S2.SS2.p1.20.m20.1.1.1" xref="S2.SS2.p1.20.m20.1.1.1.cmml"><msup id="S2.SS2.p1.20.m20.1.1.1.3" xref="S2.SS2.p1.20.m20.1.1.1.3.cmml"><mi id="S2.SS2.p1.20.m20.1.1.1.3.2" xref="S2.SS2.p1.20.m20.1.1.1.3.2.cmml">J</mi><mi id="S2.SS2.p1.20.m20.1.1.1.3.3" xref="S2.SS2.p1.20.m20.1.1.1.3.3.cmml">π</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p1.20.m20.1.1.1.2" xref="S2.SS2.p1.20.m20.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.20.m20.1.1.1.1.1" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.20.m20.1.1.1.1.1.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.20.m20.1.1.1.1.1.1" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.20.m20.1.1.1.1.1.1.2" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.2.cmml">s</mi><mn id="S2.SS2.p1.20.m20.1.1.1.1.1.1.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S2.SS2.p1.20.m20.1.1.1.1.1.3" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.20.m20.2.2.3" xref="S2.SS2.p1.20.m20.2.2.3.cmml">=</mo><mrow id="S2.SS2.p1.20.m20.2.2.2" xref="S2.SS2.p1.20.m20.2.2.2.cmml"><msub id="S2.SS2.p1.20.m20.2.2.2.3" xref="S2.SS2.p1.20.m20.2.2.2.3.cmml"><mi id="S2.SS2.p1.20.m20.2.2.2.3.2" xref="S2.SS2.p1.20.m20.2.2.2.3.2.cmml">E</mi><mi id="S2.SS2.p1.20.m20.2.2.2.3.3" xref="S2.SS2.p1.20.m20.2.2.2.3.3.cmml">π</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.20.m20.2.2.2.2" xref="S2.SS2.p1.20.m20.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.p1.20.m20.2.2.2.1.1" xref="S2.SS2.p1.20.m20.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.20.m20.2.2.2.1.1.2" xref="S2.SS2.p1.20.m20.2.2.2.1.2.1.cmml">[</mo><mrow id="S2.SS2.p1.20.m20.2.2.2.1.1.1" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.cmml"><msubsup id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.cmml"><mo lspace="0em" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.2.cmml">∑</mo><mrow id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.cmml"><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.1" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.3.cmml">0</mn></mrow><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.3.cmml">h</mi></msubsup><mrow id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.cmml"><msup id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.cmml"><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.2.cmml">γ</mi><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.3.cmml">​</mo><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.5" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.3a" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.3.cmml">​</mo><mrow id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.3.cmml">(</mo><msub id="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.4" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.cmml"><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.2" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.3" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.5" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.SS2.p1.20.m20.2.2.2.1.1.3" xref="S2.SS2.p1.20.m20.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.20.m20.2b"><apply id="S2.SS2.p1.20.m20.2.2.cmml" xref="S2.SS2.p1.20.m20.2.2"><eq id="S2.SS2.p1.20.m20.2.2.3.cmml" xref="S2.SS2.p1.20.m20.2.2.3"></eq><apply id="S2.SS2.p1.20.m20.1.1.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1"><times id="S2.SS2.p1.20.m20.1.1.1.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.2"></times><apply id="S2.SS2.p1.20.m20.1.1.1.3.cmml" xref="S2.SS2.p1.20.m20.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.1.1.1.3.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p1.20.m20.1.1.1.3.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.3.2">𝐽</ci><ci id="S2.SS2.p1.20.m20.1.1.1.3.3.cmml" xref="S2.SS2.p1.20.m20.1.1.1.3.3">𝜋</ci></apply><apply id="S2.SS2.p1.20.m20.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.20.m20.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.20.m20.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.20.m20.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="S2.SS2.p1.20.m20.2.2.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2"><times id="S2.SS2.p1.20.m20.2.2.2.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.2"></times><apply id="S2.SS2.p1.20.m20.2.2.2.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.2.2.2.3.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p1.20.m20.2.2.2.3.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.3.2">𝐸</ci><ci id="S2.SS2.p1.20.m20.2.2.2.3.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.3.3">𝜋</ci></apply><apply id="S2.SS2.p1.20.m20.2.2.2.1.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS2.p1.20.m20.2.2.2.1.2.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1"><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3">superscript</csymbol><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3">subscript</csymbol><sum id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.2"></sum><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3"><eq id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.1"></eq><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.2.3.3">0</cn></apply></apply><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.3.3">ℎ</ci></apply><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2"><times id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.3"></times><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4">superscript</csymbol><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.2">𝛾</ci><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.4.3">𝑡</ci></apply><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.5.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.5">𝑅</ci><interval closure="open" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2"><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.1.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.2.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.3.cmml" xref="S2.SS2.p1.20.m20.2.2.2.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.20.m20.2c">J^{\pi}(s_{0})=E_{\pi}[\sum_{t=0}^{h}\gamma^{t}R(s_{t},a_{t})]</annotation></semantics></math>). Similarly, the value of executing <math id="S2.SS2.p1.21.m21.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p1.21.m21.1a"><mi id="S2.SS2.p1.21.m21.1.1" xref="S2.SS2.p1.21.m21.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.21.m21.1b"><ci id="S2.SS2.p1.21.m21.1.1.cmml" xref="S2.SS2.p1.21.m21.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.21.m21.1c">a</annotation></semantics></math> in <math id="S2.SS2.p1.22.m22.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p1.22.m22.1a"><mi id="S2.SS2.p1.22.m22.1.1" xref="S2.SS2.p1.22.m22.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.22.m22.1b"><ci id="S2.SS2.p1.22.m22.1.1.cmml" xref="S2.SS2.p1.22.m22.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.22.m22.1c">s</annotation></semantics></math> followed by the policy <math id="S2.SS2.p1.23.m23.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S2.SS2.p1.23.m23.1a"><mi id="S2.SS2.p1.23.m23.1.1" xref="S2.SS2.p1.23.m23.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.23.m23.1b"><ci id="S2.SS2.p1.23.m23.1.1.cmml" xref="S2.SS2.p1.23.m23.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.23.m23.1c">\pi</annotation></semantics></math> is <math id="S2.SS2.p1.24.m24.5" class="ltx_Math" alttext="Q^{\pi}(s_{0},a_{0})=R(s_{0},a_{0})+\gamma E_{\pi}[\sum_{t=1}^{h}\gamma^{t}R(s_{t},a_{t})]" display="inline"><semantics id="S2.SS2.p1.24.m24.5a"><mrow id="S2.SS2.p1.24.m24.5.5" xref="S2.SS2.p1.24.m24.5.5.cmml"><mrow id="S2.SS2.p1.24.m24.2.2.2" xref="S2.SS2.p1.24.m24.2.2.2.cmml"><msup id="S2.SS2.p1.24.m24.2.2.2.4" xref="S2.SS2.p1.24.m24.2.2.2.4.cmml"><mi id="S2.SS2.p1.24.m24.2.2.2.4.2" xref="S2.SS2.p1.24.m24.2.2.2.4.2.cmml">Q</mi><mi id="S2.SS2.p1.24.m24.2.2.2.4.3" xref="S2.SS2.p1.24.m24.2.2.2.4.3.cmml">π</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p1.24.m24.2.2.2.3" xref="S2.SS2.p1.24.m24.2.2.2.3.cmml">​</mo><mrow id="S2.SS2.p1.24.m24.2.2.2.2.2" xref="S2.SS2.p1.24.m24.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.24.m24.2.2.2.2.2.3" xref="S2.SS2.p1.24.m24.2.2.2.2.3.cmml">(</mo><msub id="S2.SS2.p1.24.m24.1.1.1.1.1.1" xref="S2.SS2.p1.24.m24.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.24.m24.1.1.1.1.1.1.2" xref="S2.SS2.p1.24.m24.1.1.1.1.1.1.2.cmml">s</mi><mn id="S2.SS2.p1.24.m24.1.1.1.1.1.1.3" xref="S2.SS2.p1.24.m24.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS2.p1.24.m24.2.2.2.2.2.4" xref="S2.SS2.p1.24.m24.2.2.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.24.m24.2.2.2.2.2.2" xref="S2.SS2.p1.24.m24.2.2.2.2.2.2.cmml"><mi id="S2.SS2.p1.24.m24.2.2.2.2.2.2.2" xref="S2.SS2.p1.24.m24.2.2.2.2.2.2.2.cmml">a</mi><mn id="S2.SS2.p1.24.m24.2.2.2.2.2.2.3" xref="S2.SS2.p1.24.m24.2.2.2.2.2.2.3.cmml">0</mn></msub><mo stretchy="false" id="S2.SS2.p1.24.m24.2.2.2.2.2.5" xref="S2.SS2.p1.24.m24.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.24.m24.5.5.6" xref="S2.SS2.p1.24.m24.5.5.6.cmml">=</mo><mrow id="S2.SS2.p1.24.m24.5.5.5" xref="S2.SS2.p1.24.m24.5.5.5.cmml"><mrow id="S2.SS2.p1.24.m24.4.4.4.2" xref="S2.SS2.p1.24.m24.4.4.4.2.cmml"><mi id="S2.SS2.p1.24.m24.4.4.4.2.4" xref="S2.SS2.p1.24.m24.4.4.4.2.4.cmml">R</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.24.m24.4.4.4.2.3" xref="S2.SS2.p1.24.m24.4.4.4.2.3.cmml">​</mo><mrow id="S2.SS2.p1.24.m24.4.4.4.2.2.2" xref="S2.SS2.p1.24.m24.4.4.4.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.24.m24.4.4.4.2.2.2.3" xref="S2.SS2.p1.24.m24.4.4.4.2.2.3.cmml">(</mo><msub id="S2.SS2.p1.24.m24.3.3.3.1.1.1.1" xref="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.cmml"><mi id="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.2" xref="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.2.cmml">s</mi><mn id="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.3" xref="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS2.p1.24.m24.4.4.4.2.2.2.4" xref="S2.SS2.p1.24.m24.4.4.4.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.24.m24.4.4.4.2.2.2.2" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.cmml"><mi id="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.2" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.2.cmml">a</mi><mn id="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.3" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.3.cmml">0</mn></msub><mo stretchy="false" id="S2.SS2.p1.24.m24.4.4.4.2.2.2.5" xref="S2.SS2.p1.24.m24.4.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.24.m24.5.5.5.4" xref="S2.SS2.p1.24.m24.5.5.5.4.cmml">+</mo><mrow id="S2.SS2.p1.24.m24.5.5.5.3" xref="S2.SS2.p1.24.m24.5.5.5.3.cmml"><mi id="S2.SS2.p1.24.m24.5.5.5.3.3" xref="S2.SS2.p1.24.m24.5.5.5.3.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.24.m24.5.5.5.3.2" xref="S2.SS2.p1.24.m24.5.5.5.3.2.cmml">​</mo><msub id="S2.SS2.p1.24.m24.5.5.5.3.4" xref="S2.SS2.p1.24.m24.5.5.5.3.4.cmml"><mi id="S2.SS2.p1.24.m24.5.5.5.3.4.2" xref="S2.SS2.p1.24.m24.5.5.5.3.4.2.cmml">E</mi><mi id="S2.SS2.p1.24.m24.5.5.5.3.4.3" xref="S2.SS2.p1.24.m24.5.5.5.3.4.3.cmml">π</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.24.m24.5.5.5.3.2a" xref="S2.SS2.p1.24.m24.5.5.5.3.2.cmml">​</mo><mrow id="S2.SS2.p1.24.m24.5.5.5.3.1.1" xref="S2.SS2.p1.24.m24.5.5.5.3.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.2.1.cmml">[</mo><mrow id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.cmml"><msubsup id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.cmml"><mo lspace="0em" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.2.cmml">∑</mo><mrow id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.cmml"><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.2.cmml">t</mi><mo id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.1" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.3.cmml">h</mi></msubsup><mrow id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.cmml"><msup id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.cmml"><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.2.cmml">γ</mi><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.3.cmml">​</mo><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.5" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.3a" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.3.cmml">​</mo><mrow id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.3.cmml">(</mo><msub id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.4" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.cmml"><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.2" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.5" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.3" xref="S2.SS2.p1.24.m24.5.5.5.3.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.24.m24.5b"><apply id="S2.SS2.p1.24.m24.5.5.cmml" xref="S2.SS2.p1.24.m24.5.5"><eq id="S2.SS2.p1.24.m24.5.5.6.cmml" xref="S2.SS2.p1.24.m24.5.5.6"></eq><apply id="S2.SS2.p1.24.m24.2.2.2.cmml" xref="S2.SS2.p1.24.m24.2.2.2"><times id="S2.SS2.p1.24.m24.2.2.2.3.cmml" xref="S2.SS2.p1.24.m24.2.2.2.3"></times><apply id="S2.SS2.p1.24.m24.2.2.2.4.cmml" xref="S2.SS2.p1.24.m24.2.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.2.2.2.4.1.cmml" xref="S2.SS2.p1.24.m24.2.2.2.4">superscript</csymbol><ci id="S2.SS2.p1.24.m24.2.2.2.4.2.cmml" xref="S2.SS2.p1.24.m24.2.2.2.4.2">𝑄</ci><ci id="S2.SS2.p1.24.m24.2.2.2.4.3.cmml" xref="S2.SS2.p1.24.m24.2.2.2.4.3">𝜋</ci></apply><interval closure="open" id="S2.SS2.p1.24.m24.2.2.2.2.3.cmml" xref="S2.SS2.p1.24.m24.2.2.2.2.2"><apply id="S2.SS2.p1.24.m24.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.24.m24.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.24.m24.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.24.m24.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.24.m24.1.1.1.1.1.1.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.24.m24.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.24.m24.1.1.1.1.1.1.3">0</cn></apply><apply id="S2.SS2.p1.24.m24.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.24.m24.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.24.m24.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.24.m24.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.24.m24.2.2.2.2.2.2.2">𝑎</ci><cn type="integer" id="S2.SS2.p1.24.m24.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p1.24.m24.2.2.2.2.2.2.3">0</cn></apply></interval></apply><apply id="S2.SS2.p1.24.m24.5.5.5.cmml" xref="S2.SS2.p1.24.m24.5.5.5"><plus id="S2.SS2.p1.24.m24.5.5.5.4.cmml" xref="S2.SS2.p1.24.m24.5.5.5.4"></plus><apply id="S2.SS2.p1.24.m24.4.4.4.2.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2"><times id="S2.SS2.p1.24.m24.4.4.4.2.3.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2.3"></times><ci id="S2.SS2.p1.24.m24.4.4.4.2.4.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2.4">𝑅</ci><interval closure="open" id="S2.SS2.p1.24.m24.4.4.4.2.2.3.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2"><apply id="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.24.m24.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p1.24.m24.3.3.3.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.2.cmml" xref="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.3.cmml" xref="S2.SS2.p1.24.m24.3.3.3.1.1.1.1.3">0</cn></apply><apply id="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.1.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.2.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.2">𝑎</ci><cn type="integer" id="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.3.cmml" xref="S2.SS2.p1.24.m24.4.4.4.2.2.2.2.3">0</cn></apply></interval></apply><apply id="S2.SS2.p1.24.m24.5.5.5.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3"><times id="S2.SS2.p1.24.m24.5.5.5.3.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.2"></times><ci id="S2.SS2.p1.24.m24.5.5.5.3.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.3">𝛾</ci><apply id="S2.SS2.p1.24.m24.5.5.5.3.4.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.4"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.5.5.5.3.4.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.4">subscript</csymbol><ci id="S2.SS2.p1.24.m24.5.5.5.3.4.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.4.2">𝐸</ci><ci id="S2.SS2.p1.24.m24.5.5.5.3.4.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.4.3">𝜋</ci></apply><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1"><csymbol cd="latexml" id="S2.SS2.p1.24.m24.5.5.5.3.1.2.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1"><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3">superscript</csymbol><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3">subscript</csymbol><sum id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.2"></sum><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3"><eq id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.1"></eq><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.3.3">ℎ</ci></apply><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2"><times id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.3"></times><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4">superscript</csymbol><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.2">𝛾</ci><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.4.3">𝑡</ci></apply><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.5.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.5">𝑅</ci><interval closure="open" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2"><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.1.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.2.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.2">𝑎</ci><ci id="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.3.cmml" xref="S2.SS2.p1.24.m24.5.5.5.3.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.24.m24.5c">Q^{\pi}(s_{0},a_{0})=R(s_{0},a_{0})+\gamma E_{\pi}[\sum_{t=1}^{h}\gamma^{t}R(s_{t},a_{t})]</annotation></semantics></math>. An optimal policy <math id="S2.SS2.p1.25.m25.1" class="ltx_Math" alttext="\pi^{*}" display="inline"><semantics id="S2.SS2.p1.25.m25.1a"><msup id="S2.SS2.p1.25.m25.1.1" xref="S2.SS2.p1.25.m25.1.1.cmml"><mi id="S2.SS2.p1.25.m25.1.1.2" xref="S2.SS2.p1.25.m25.1.1.2.cmml">π</mi><mo id="S2.SS2.p1.25.m25.1.1.3" xref="S2.SS2.p1.25.m25.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.25.m25.1b"><apply id="S2.SS2.p1.25.m25.1.1.cmml" xref="S2.SS2.p1.25.m25.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.25.m25.1.1.1.cmml" xref="S2.SS2.p1.25.m25.1.1">superscript</csymbol><ci id="S2.SS2.p1.25.m25.1.1.2.cmml" xref="S2.SS2.p1.25.m25.1.1.2">𝜋</ci><times id="S2.SS2.p1.25.m25.1.1.3.cmml" xref="S2.SS2.p1.25.m25.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.25.m25.1c">\pi^{*}</annotation></semantics></math> achieves the highest expected cumulative reward (i.e., <math id="S2.SS2.p1.26.m26.3" class="ltx_Math" alttext="\pi^{*}=argmax_{\pi}J^{\pi}(s)\forall\pi,s" display="inline"><semantics id="S2.SS2.p1.26.m26.3a"><mrow id="S2.SS2.p1.26.m26.3.3" xref="S2.SS2.p1.26.m26.3.3.cmml"><msup id="S2.SS2.p1.26.m26.3.3.3" xref="S2.SS2.p1.26.m26.3.3.3.cmml"><mi id="S2.SS2.p1.26.m26.3.3.3.2" xref="S2.SS2.p1.26.m26.3.3.3.2.cmml">π</mi><mo id="S2.SS2.p1.26.m26.3.3.3.3" xref="S2.SS2.p1.26.m26.3.3.3.3.cmml">∗</mo></msup><mo id="S2.SS2.p1.26.m26.3.3.2" xref="S2.SS2.p1.26.m26.3.3.2.cmml">=</mo><mrow id="S2.SS2.p1.26.m26.3.3.1.1" xref="S2.SS2.p1.26.m26.3.3.1.2.cmml"><mrow id="S2.SS2.p1.26.m26.3.3.1.1.1" xref="S2.SS2.p1.26.m26.3.3.1.1.1.cmml"><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.2" xref="S2.SS2.p1.26.m26.3.3.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.3" xref="S2.SS2.p1.26.m26.3.3.1.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1a" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.4" xref="S2.SS2.p1.26.m26.3.3.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1b" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.5" xref="S2.SS2.p1.26.m26.3.3.1.1.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1c" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.6" xref="S2.SS2.p1.26.m26.3.3.1.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1d" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><msub id="S2.SS2.p1.26.m26.3.3.1.1.1.7" xref="S2.SS2.p1.26.m26.3.3.1.1.1.7.cmml"><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.7.2" xref="S2.SS2.p1.26.m26.3.3.1.1.1.7.2.cmml">x</mi><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.7.3" xref="S2.SS2.p1.26.m26.3.3.1.1.1.7.3.cmml">π</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1e" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><msup id="S2.SS2.p1.26.m26.3.3.1.1.1.8" xref="S2.SS2.p1.26.m26.3.3.1.1.1.8.cmml"><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.8.2" xref="S2.SS2.p1.26.m26.3.3.1.1.1.8.2.cmml">J</mi><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.8.3" xref="S2.SS2.p1.26.m26.3.3.1.1.1.8.3.cmml">π</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1f" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><mrow id="S2.SS2.p1.26.m26.3.3.1.1.1.9.2" xref="S2.SS2.p1.26.m26.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.26.m26.3.3.1.1.1.9.2.1" xref="S2.SS2.p1.26.m26.3.3.1.1.1.cmml">(</mo><mi id="S2.SS2.p1.26.m26.1.1" xref="S2.SS2.p1.26.m26.1.1.cmml">s</mi><mo stretchy="false" id="S2.SS2.p1.26.m26.3.3.1.1.1.9.2.2" xref="S2.SS2.p1.26.m26.3.3.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S2.SS2.p1.26.m26.3.3.1.1.1.1g" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml">​</mo><mrow id="S2.SS2.p1.26.m26.3.3.1.1.1.10" xref="S2.SS2.p1.26.m26.3.3.1.1.1.10.cmml"><mo rspace="0.167em" id="S2.SS2.p1.26.m26.3.3.1.1.1.10.1" xref="S2.SS2.p1.26.m26.3.3.1.1.1.10.1.cmml">∀</mo><mi id="S2.SS2.p1.26.m26.3.3.1.1.1.10.2" xref="S2.SS2.p1.26.m26.3.3.1.1.1.10.2.cmml">π</mi></mrow></mrow><mo id="S2.SS2.p1.26.m26.3.3.1.1.2" xref="S2.SS2.p1.26.m26.3.3.1.2.cmml">,</mo><mi id="S2.SS2.p1.26.m26.2.2" xref="S2.SS2.p1.26.m26.2.2.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.26.m26.3b"><apply id="S2.SS2.p1.26.m26.3.3.cmml" xref="S2.SS2.p1.26.m26.3.3"><eq id="S2.SS2.p1.26.m26.3.3.2.cmml" xref="S2.SS2.p1.26.m26.3.3.2"></eq><apply id="S2.SS2.p1.26.m26.3.3.3.cmml" xref="S2.SS2.p1.26.m26.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.26.m26.3.3.3.1.cmml" xref="S2.SS2.p1.26.m26.3.3.3">superscript</csymbol><ci id="S2.SS2.p1.26.m26.3.3.3.2.cmml" xref="S2.SS2.p1.26.m26.3.3.3.2">𝜋</ci><times id="S2.SS2.p1.26.m26.3.3.3.3.cmml" xref="S2.SS2.p1.26.m26.3.3.3.3"></times></apply><list id="S2.SS2.p1.26.m26.3.3.1.2.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1"><apply id="S2.SS2.p1.26.m26.3.3.1.1.1.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1"><times id="S2.SS2.p1.26.m26.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.1"></times><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.2.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.3.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.3">𝑟</ci><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.4.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.4">𝑔</ci><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.5.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.5">𝑚</ci><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.6.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.6">𝑎</ci><apply id="S2.SS2.p1.26.m26.3.3.1.1.1.7.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.7"><csymbol cd="ambiguous" id="S2.SS2.p1.26.m26.3.3.1.1.1.7.1.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.7">subscript</csymbol><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.7.2.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.7.2">𝑥</ci><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.7.3.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.7.3">𝜋</ci></apply><apply id="S2.SS2.p1.26.m26.3.3.1.1.1.8.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.8"><csymbol cd="ambiguous" id="S2.SS2.p1.26.m26.3.3.1.1.1.8.1.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.8">superscript</csymbol><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.8.2.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.8.2">𝐽</ci><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.8.3.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.8.3">𝜋</ci></apply><ci id="S2.SS2.p1.26.m26.1.1.cmml" xref="S2.SS2.p1.26.m26.1.1">𝑠</ci><apply id="S2.SS2.p1.26.m26.3.3.1.1.1.10.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.10"><csymbol cd="latexml" id="S2.SS2.p1.26.m26.3.3.1.1.1.10.1.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.10.1">for-all</csymbol><ci id="S2.SS2.p1.26.m26.3.3.1.1.1.10.2.cmml" xref="S2.SS2.p1.26.m26.3.3.1.1.1.10.2">𝜋</ci></apply></apply><ci id="S2.SS2.p1.26.m26.2.2.cmml" xref="S2.SS2.p1.26.m26.2.2">𝑠</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.26.m26.3c">\pi^{*}=argmax_{\pi}J^{\pi}(s)\forall\pi,s</annotation></semantics></math>). However, since the transition distribution and the reward function are unknown, the agent must perform this optimization based on trajectories of states, actions and rewards (i.e., <math id="S2.SS2.p1.27.m27.7" class="ltx_Math" alttext="s_{1},a_{1},r_{1},s_{2},a_{2},r_{2},..." display="inline"><semantics id="S2.SS2.p1.27.m27.7a"><mrow id="S2.SS2.p1.27.m27.7.7.6" xref="S2.SS2.p1.27.m27.7.7.7.cmml"><msub id="S2.SS2.p1.27.m27.2.2.1.1" xref="S2.SS2.p1.27.m27.2.2.1.1.cmml"><mi id="S2.SS2.p1.27.m27.2.2.1.1.2" xref="S2.SS2.p1.27.m27.2.2.1.1.2.cmml">s</mi><mn id="S2.SS2.p1.27.m27.2.2.1.1.3" xref="S2.SS2.p1.27.m27.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.27.m27.7.7.6.7" xref="S2.SS2.p1.27.m27.7.7.7.cmml">,</mo><msub id="S2.SS2.p1.27.m27.3.3.2.2" xref="S2.SS2.p1.27.m27.3.3.2.2.cmml"><mi id="S2.SS2.p1.27.m27.3.3.2.2.2" xref="S2.SS2.p1.27.m27.3.3.2.2.2.cmml">a</mi><mn id="S2.SS2.p1.27.m27.3.3.2.2.3" xref="S2.SS2.p1.27.m27.3.3.2.2.3.cmml">1</mn></msub><mo id="S2.SS2.p1.27.m27.7.7.6.8" xref="S2.SS2.p1.27.m27.7.7.7.cmml">,</mo><msub id="S2.SS2.p1.27.m27.4.4.3.3" xref="S2.SS2.p1.27.m27.4.4.3.3.cmml"><mi id="S2.SS2.p1.27.m27.4.4.3.3.2" xref="S2.SS2.p1.27.m27.4.4.3.3.2.cmml">r</mi><mn id="S2.SS2.p1.27.m27.4.4.3.3.3" xref="S2.SS2.p1.27.m27.4.4.3.3.3.cmml">1</mn></msub><mo id="S2.SS2.p1.27.m27.7.7.6.9" xref="S2.SS2.p1.27.m27.7.7.7.cmml">,</mo><msub id="S2.SS2.p1.27.m27.5.5.4.4" xref="S2.SS2.p1.27.m27.5.5.4.4.cmml"><mi id="S2.SS2.p1.27.m27.5.5.4.4.2" xref="S2.SS2.p1.27.m27.5.5.4.4.2.cmml">s</mi><mn id="S2.SS2.p1.27.m27.5.5.4.4.3" xref="S2.SS2.p1.27.m27.5.5.4.4.3.cmml">2</mn></msub><mo id="S2.SS2.p1.27.m27.7.7.6.10" xref="S2.SS2.p1.27.m27.7.7.7.cmml">,</mo><msub id="S2.SS2.p1.27.m27.6.6.5.5" xref="S2.SS2.p1.27.m27.6.6.5.5.cmml"><mi id="S2.SS2.p1.27.m27.6.6.5.5.2" xref="S2.SS2.p1.27.m27.6.6.5.5.2.cmml">a</mi><mn id="S2.SS2.p1.27.m27.6.6.5.5.3" xref="S2.SS2.p1.27.m27.6.6.5.5.3.cmml">2</mn></msub><mo id="S2.SS2.p1.27.m27.7.7.6.11" xref="S2.SS2.p1.27.m27.7.7.7.cmml">,</mo><msub id="S2.SS2.p1.27.m27.7.7.6.6" xref="S2.SS2.p1.27.m27.7.7.6.6.cmml"><mi id="S2.SS2.p1.27.m27.7.7.6.6.2" xref="S2.SS2.p1.27.m27.7.7.6.6.2.cmml">r</mi><mn id="S2.SS2.p1.27.m27.7.7.6.6.3" xref="S2.SS2.p1.27.m27.7.7.6.6.3.cmml">2</mn></msub><mo id="S2.SS2.p1.27.m27.7.7.6.12" xref="S2.SS2.p1.27.m27.7.7.7.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.27.m27.1.1" xref="S2.SS2.p1.27.m27.1.1.cmml">…</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.27.m27.7b"><list id="S2.SS2.p1.27.m27.7.7.7.cmml" xref="S2.SS2.p1.27.m27.7.7.6"><apply id="S2.SS2.p1.27.m27.2.2.1.1.cmml" xref="S2.SS2.p1.27.m27.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.27.m27.2.2.1.1.1.cmml" xref="S2.SS2.p1.27.m27.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p1.27.m27.2.2.1.1.2.cmml" xref="S2.SS2.p1.27.m27.2.2.1.1.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.27.m27.2.2.1.1.3.cmml" xref="S2.SS2.p1.27.m27.2.2.1.1.3">1</cn></apply><apply id="S2.SS2.p1.27.m27.3.3.2.2.cmml" xref="S2.SS2.p1.27.m27.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.27.m27.3.3.2.2.1.cmml" xref="S2.SS2.p1.27.m27.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p1.27.m27.3.3.2.2.2.cmml" xref="S2.SS2.p1.27.m27.3.3.2.2.2">𝑎</ci><cn type="integer" id="S2.SS2.p1.27.m27.3.3.2.2.3.cmml" xref="S2.SS2.p1.27.m27.3.3.2.2.3">1</cn></apply><apply id="S2.SS2.p1.27.m27.4.4.3.3.cmml" xref="S2.SS2.p1.27.m27.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.27.m27.4.4.3.3.1.cmml" xref="S2.SS2.p1.27.m27.4.4.3.3">subscript</csymbol><ci id="S2.SS2.p1.27.m27.4.4.3.3.2.cmml" xref="S2.SS2.p1.27.m27.4.4.3.3.2">𝑟</ci><cn type="integer" id="S2.SS2.p1.27.m27.4.4.3.3.3.cmml" xref="S2.SS2.p1.27.m27.4.4.3.3.3">1</cn></apply><apply id="S2.SS2.p1.27.m27.5.5.4.4.cmml" xref="S2.SS2.p1.27.m27.5.5.4.4"><csymbol cd="ambiguous" id="S2.SS2.p1.27.m27.5.5.4.4.1.cmml" xref="S2.SS2.p1.27.m27.5.5.4.4">subscript</csymbol><ci id="S2.SS2.p1.27.m27.5.5.4.4.2.cmml" xref="S2.SS2.p1.27.m27.5.5.4.4.2">𝑠</ci><cn type="integer" id="S2.SS2.p1.27.m27.5.5.4.4.3.cmml" xref="S2.SS2.p1.27.m27.5.5.4.4.3">2</cn></apply><apply id="S2.SS2.p1.27.m27.6.6.5.5.cmml" xref="S2.SS2.p1.27.m27.6.6.5.5"><csymbol cd="ambiguous" id="S2.SS2.p1.27.m27.6.6.5.5.1.cmml" xref="S2.SS2.p1.27.m27.6.6.5.5">subscript</csymbol><ci id="S2.SS2.p1.27.m27.6.6.5.5.2.cmml" xref="S2.SS2.p1.27.m27.6.6.5.5.2">𝑎</ci><cn type="integer" id="S2.SS2.p1.27.m27.6.6.5.5.3.cmml" xref="S2.SS2.p1.27.m27.6.6.5.5.3">2</cn></apply><apply id="S2.SS2.p1.27.m27.7.7.6.6.cmml" xref="S2.SS2.p1.27.m27.7.7.6.6"><csymbol cd="ambiguous" id="S2.SS2.p1.27.m27.7.7.6.6.1.cmml" xref="S2.SS2.p1.27.m27.7.7.6.6">subscript</csymbol><ci id="S2.SS2.p1.27.m27.7.7.6.6.2.cmml" xref="S2.SS2.p1.27.m27.7.7.6.6.2">𝑟</ci><cn type="integer" id="S2.SS2.p1.27.m27.7.7.6.6.3.cmml" xref="S2.SS2.p1.27.m27.7.7.6.6.3">2</cn></apply><ci id="S2.SS2.p1.27.m27.1.1.cmml" xref="S2.SS2.p1.27.m27.1.1">…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.27.m27.7c">s_{1},a_{1},r_{1},s_{2},a_{2},r_{2},...</annotation></semantics></math>) that it experiences as it interacts with the environment.</p>
</div>
<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1. </span>Soft Actor-Critic (SAC)</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para">
<p id="S2.SS2.SSS1.p1.2" class="ltx_p">Within reinforcement learning, traditional policy gradient techniques update the parameters <math id="S2.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mi id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">\theta</annotation></semantics></math> of a policy <math id="S2.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><msub id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.1.1.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml">π</mi><mi id="S2.SS2.SSS1.p1.2.m2.1.1.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><apply id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.2">𝜋</ci><ci id="S2.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">\pi_{\theta}</annotation></semantics></math> by taking steps in the direction of the gradient of the value function <cite class="ltx_cite ltx_citemacro_citep">(Sutton
et al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">1999</a>; Williams, <a href="#bib.bib36" title="" class="ltx_ref">1992</a>)</cite>:</p>
<table id="A0.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.4" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}J^{\pi_{\theta}}(s_{t})=\nabla_{\theta}log(\pi_{\theta}(a_{t}|s_{t}))\sum^{\infty}_{t^{\prime}=t}\gamma^{t^{\prime}-t}R(s_{t^{\prime}},a_{t^{\prime}})" display="inline"><semantics id="S2.E3.m1.4a"><mrow id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml"><msub id="S2.E3.m1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.3.1.cmml"><mo id="S2.E3.m1.1.1.1.3.1.2" xref="S2.E3.m1.1.1.1.3.1.2.cmml">∇</mo><mi id="S2.E3.m1.1.1.1.3.1.3" xref="S2.E3.m1.1.1.1.3.1.3.cmml">θ</mi></msub><msup id="S2.E3.m1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.1.1.1.3.2.2" xref="S2.E3.m1.1.1.1.3.2.2.cmml">J</mi><msub id="S2.E3.m1.1.1.1.3.2.3" xref="S2.E3.m1.1.1.1.3.2.3.cmml"><mi id="S2.E3.m1.1.1.1.3.2.3.2" xref="S2.E3.m1.1.1.1.3.2.3.2.cmml">π</mi><mi id="S2.E3.m1.1.1.1.3.2.3.3" xref="S2.E3.m1.1.1.1.3.2.3.3.cmml">θ</mi></msub></msup></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.5" xref="S2.E3.m1.4.4.5.cmml">=</mo><mrow id="S2.E3.m1.4.4.4" xref="S2.E3.m1.4.4.4.cmml"><mrow id="S2.E3.m1.4.4.4.5" xref="S2.E3.m1.4.4.4.5.cmml"><msub id="S2.E3.m1.4.4.4.5.1" xref="S2.E3.m1.4.4.4.5.1.cmml"><mo rspace="0.167em" id="S2.E3.m1.4.4.4.5.1.2" xref="S2.E3.m1.4.4.4.5.1.2.cmml">∇</mo><mi id="S2.E3.m1.4.4.4.5.1.3" xref="S2.E3.m1.4.4.4.5.1.3.cmml">θ</mi></msub><mrow id="S2.E3.m1.4.4.4.5.2" xref="S2.E3.m1.4.4.4.5.2.cmml"><mi id="S2.E3.m1.4.4.4.5.2.2" xref="S2.E3.m1.4.4.4.5.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.4.5.2.1" xref="S2.E3.m1.4.4.4.5.2.1.cmml">​</mo><mi id="S2.E3.m1.4.4.4.5.2.3" xref="S2.E3.m1.4.4.4.5.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.4.5.2.1a" xref="S2.E3.m1.4.4.4.5.2.1.cmml">​</mo><mi id="S2.E3.m1.4.4.4.5.2.4" xref="S2.E3.m1.4.4.4.5.2.4.cmml">g</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.4.4" xref="S2.E3.m1.4.4.4.4.cmml">​</mo><mrow id="S2.E3.m1.2.2.2.1.1" xref="S2.E3.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.cmml"><msub id="S2.E3.m1.2.2.2.1.1.1.3" xref="S2.E3.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.2.1.1.1.3.2" xref="S2.E3.m1.2.2.2.1.1.1.3.2.cmml">π</mi><mi id="S2.E3.m1.2.2.2.1.1.1.3.3" xref="S2.E3.m1.2.2.2.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.1.1.1.2" xref="S2.E3.m1.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.1.1.1.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.2.2.2.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.3" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.E3.m1.2.2.2.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E3.m1.2.2.2.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.2" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.3" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.E3.m1.2.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3.m1.2.2.2.1.1.3" xref="S2.E3.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.4.4a" xref="S2.E3.m1.4.4.4.4.cmml">​</mo><mrow id="S2.E3.m1.4.4.4.3" xref="S2.E3.m1.4.4.4.3.cmml"><mstyle displaystyle="true" id="S2.E3.m1.4.4.4.3.3" xref="S2.E3.m1.4.4.4.3.3.cmml"><munderover id="S2.E3.m1.4.4.4.3.3a" xref="S2.E3.m1.4.4.4.3.3.cmml"><mo movablelimits="false" id="S2.E3.m1.4.4.4.3.3.2.2" xref="S2.E3.m1.4.4.4.3.3.2.2.cmml">∑</mo><mrow id="S2.E3.m1.4.4.4.3.3.3" xref="S2.E3.m1.4.4.4.3.3.3.cmml"><msup id="S2.E3.m1.4.4.4.3.3.3.2" xref="S2.E3.m1.4.4.4.3.3.3.2.cmml"><mi id="S2.E3.m1.4.4.4.3.3.3.2.2" xref="S2.E3.m1.4.4.4.3.3.3.2.2.cmml">t</mi><mo id="S2.E3.m1.4.4.4.3.3.3.2.3" xref="S2.E3.m1.4.4.4.3.3.3.2.3.cmml">′</mo></msup><mo id="S2.E3.m1.4.4.4.3.3.3.1" xref="S2.E3.m1.4.4.4.3.3.3.1.cmml">=</mo><mi id="S2.E3.m1.4.4.4.3.3.3.3" xref="S2.E3.m1.4.4.4.3.3.3.3.cmml">t</mi></mrow><mi mathvariant="normal" id="S2.E3.m1.4.4.4.3.3.2.3" xref="S2.E3.m1.4.4.4.3.3.2.3.cmml">∞</mi></munderover></mstyle><mrow id="S2.E3.m1.4.4.4.3.2" xref="S2.E3.m1.4.4.4.3.2.cmml"><msup id="S2.E3.m1.4.4.4.3.2.4" xref="S2.E3.m1.4.4.4.3.2.4.cmml"><mi id="S2.E3.m1.4.4.4.3.2.4.2" xref="S2.E3.m1.4.4.4.3.2.4.2.cmml">γ</mi><mrow id="S2.E3.m1.4.4.4.3.2.4.3" xref="S2.E3.m1.4.4.4.3.2.4.3.cmml"><msup id="S2.E3.m1.4.4.4.3.2.4.3.2" xref="S2.E3.m1.4.4.4.3.2.4.3.2.cmml"><mi id="S2.E3.m1.4.4.4.3.2.4.3.2.2" xref="S2.E3.m1.4.4.4.3.2.4.3.2.2.cmml">t</mi><mo id="S2.E3.m1.4.4.4.3.2.4.3.2.3" xref="S2.E3.m1.4.4.4.3.2.4.3.2.3.cmml">′</mo></msup><mo id="S2.E3.m1.4.4.4.3.2.4.3.1" xref="S2.E3.m1.4.4.4.3.2.4.3.1.cmml">−</mo><mi id="S2.E3.m1.4.4.4.3.2.4.3.3" xref="S2.E3.m1.4.4.4.3.2.4.3.3.cmml">t</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.4.3.2.3" xref="S2.E3.m1.4.4.4.3.2.3.cmml">​</mo><mi id="S2.E3.m1.4.4.4.3.2.5" xref="S2.E3.m1.4.4.4.3.2.5.cmml">R</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.4.3.2.3a" xref="S2.E3.m1.4.4.4.3.2.3.cmml">​</mo><mrow id="S2.E3.m1.4.4.4.3.2.2.2" xref="S2.E3.m1.4.4.4.3.2.2.3.cmml"><mo stretchy="false" id="S2.E3.m1.4.4.4.3.2.2.2.3" xref="S2.E3.m1.4.4.4.3.2.2.3.cmml">(</mo><msub id="S2.E3.m1.3.3.3.2.1.1.1.1" xref="S2.E3.m1.3.3.3.2.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.3.2.1.1.1.1.2" xref="S2.E3.m1.3.3.3.2.1.1.1.1.2.cmml">s</mi><msup id="S2.E3.m1.3.3.3.2.1.1.1.1.3" xref="S2.E3.m1.3.3.3.2.1.1.1.1.3.cmml"><mi id="S2.E3.m1.3.3.3.2.1.1.1.1.3.2" xref="S2.E3.m1.3.3.3.2.1.1.1.1.3.2.cmml">t</mi><mo id="S2.E3.m1.3.3.3.2.1.1.1.1.3.3" xref="S2.E3.m1.3.3.3.2.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="S2.E3.m1.4.4.4.3.2.2.2.4" xref="S2.E3.m1.4.4.4.3.2.2.3.cmml">,</mo><msub id="S2.E3.m1.4.4.4.3.2.2.2.2" xref="S2.E3.m1.4.4.4.3.2.2.2.2.cmml"><mi id="S2.E3.m1.4.4.4.3.2.2.2.2.2" xref="S2.E3.m1.4.4.4.3.2.2.2.2.2.cmml">a</mi><msup id="S2.E3.m1.4.4.4.3.2.2.2.2.3" xref="S2.E3.m1.4.4.4.3.2.2.2.2.3.cmml"><mi id="S2.E3.m1.4.4.4.3.2.2.2.2.3.2" xref="S2.E3.m1.4.4.4.3.2.2.2.2.3.2.cmml">t</mi><mo id="S2.E3.m1.4.4.4.3.2.2.2.2.3.3" xref="S2.E3.m1.4.4.4.3.2.2.2.2.3.3.cmml">′</mo></msup></msub><mo stretchy="false" id="S2.E3.m1.4.4.4.3.2.2.2.5" xref="S2.E3.m1.4.4.4.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.4b"><apply id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4"><eq id="S2.E3.m1.4.4.5.cmml" xref="S2.E3.m1.4.4.5"></eq><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3"><apply id="S2.E3.m1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.3.1.1.cmml" xref="S2.E3.m1.1.1.1.3.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.3.1.2.cmml" xref="S2.E3.m1.1.1.1.3.1.2">∇</ci><ci id="S2.E3.m1.1.1.1.3.1.3.cmml" xref="S2.E3.m1.1.1.1.3.1.3">𝜃</ci></apply><apply id="S2.E3.m1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.1.3.2">superscript</csymbol><ci id="S2.E3.m1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.3.2.2">𝐽</ci><apply id="S2.E3.m1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.3.2.3.1.cmml" xref="S2.E3.m1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.3.2.3.2.cmml" xref="S2.E3.m1.1.1.1.3.2.3.2">𝜋</ci><ci id="S2.E3.m1.1.1.1.3.2.3.3.cmml" xref="S2.E3.m1.1.1.1.3.2.3.3">𝜃</ci></apply></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E3.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.E3.m1.4.4.4.cmml" xref="S2.E3.m1.4.4.4"><times id="S2.E3.m1.4.4.4.4.cmml" xref="S2.E3.m1.4.4.4.4"></times><apply id="S2.E3.m1.4.4.4.5.cmml" xref="S2.E3.m1.4.4.4.5"><apply id="S2.E3.m1.4.4.4.5.1.cmml" xref="S2.E3.m1.4.4.4.5.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.5.1.1.cmml" xref="S2.E3.m1.4.4.4.5.1">subscript</csymbol><ci id="S2.E3.m1.4.4.4.5.1.2.cmml" xref="S2.E3.m1.4.4.4.5.1.2">∇</ci><ci id="S2.E3.m1.4.4.4.5.1.3.cmml" xref="S2.E3.m1.4.4.4.5.1.3">𝜃</ci></apply><apply id="S2.E3.m1.4.4.4.5.2.cmml" xref="S2.E3.m1.4.4.4.5.2"><times id="S2.E3.m1.4.4.4.5.2.1.cmml" xref="S2.E3.m1.4.4.4.5.2.1"></times><ci id="S2.E3.m1.4.4.4.5.2.2.cmml" xref="S2.E3.m1.4.4.4.5.2.2">𝑙</ci><ci id="S2.E3.m1.4.4.4.5.2.3.cmml" xref="S2.E3.m1.4.4.4.5.2.3">𝑜</ci><ci id="S2.E3.m1.4.4.4.5.2.4.cmml" xref="S2.E3.m1.4.4.4.5.2.4">𝑔</ci></apply></apply><apply id="S2.E3.m1.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1"><times id="S2.E3.m1.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.2"></times><apply id="S2.E3.m1.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.3.2">𝜋</ci><ci id="S2.E3.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.3.3">𝜃</ci></apply><apply id="S2.E3.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E3.m1.4.4.4.3.cmml" xref="S2.E3.m1.4.4.4.3"><apply id="S2.E3.m1.4.4.4.3.3.cmml" xref="S2.E3.m1.4.4.4.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.3.1.cmml" xref="S2.E3.m1.4.4.4.3.3">subscript</csymbol><apply id="S2.E3.m1.4.4.4.3.3.2.cmml" xref="S2.E3.m1.4.4.4.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.3.2.1.cmml" xref="S2.E3.m1.4.4.4.3.3">superscript</csymbol><sum id="S2.E3.m1.4.4.4.3.3.2.2.cmml" xref="S2.E3.m1.4.4.4.3.3.2.2"></sum><infinity id="S2.E3.m1.4.4.4.3.3.2.3.cmml" xref="S2.E3.m1.4.4.4.3.3.2.3"></infinity></apply><apply id="S2.E3.m1.4.4.4.3.3.3.cmml" xref="S2.E3.m1.4.4.4.3.3.3"><eq id="S2.E3.m1.4.4.4.3.3.3.1.cmml" xref="S2.E3.m1.4.4.4.3.3.3.1"></eq><apply id="S2.E3.m1.4.4.4.3.3.3.2.cmml" xref="S2.E3.m1.4.4.4.3.3.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.3.3.2.1.cmml" xref="S2.E3.m1.4.4.4.3.3.3.2">superscript</csymbol><ci id="S2.E3.m1.4.4.4.3.3.3.2.2.cmml" xref="S2.E3.m1.4.4.4.3.3.3.2.2">𝑡</ci><ci id="S2.E3.m1.4.4.4.3.3.3.2.3.cmml" xref="S2.E3.m1.4.4.4.3.3.3.2.3">′</ci></apply><ci id="S2.E3.m1.4.4.4.3.3.3.3.cmml" xref="S2.E3.m1.4.4.4.3.3.3.3">𝑡</ci></apply></apply><apply id="S2.E3.m1.4.4.4.3.2.cmml" xref="S2.E3.m1.4.4.4.3.2"><times id="S2.E3.m1.4.4.4.3.2.3.cmml" xref="S2.E3.m1.4.4.4.3.2.3"></times><apply id="S2.E3.m1.4.4.4.3.2.4.cmml" xref="S2.E3.m1.4.4.4.3.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.2.4.1.cmml" xref="S2.E3.m1.4.4.4.3.2.4">superscript</csymbol><ci id="S2.E3.m1.4.4.4.3.2.4.2.cmml" xref="S2.E3.m1.4.4.4.3.2.4.2">𝛾</ci><apply id="S2.E3.m1.4.4.4.3.2.4.3.cmml" xref="S2.E3.m1.4.4.4.3.2.4.3"><minus id="S2.E3.m1.4.4.4.3.2.4.3.1.cmml" xref="S2.E3.m1.4.4.4.3.2.4.3.1"></minus><apply id="S2.E3.m1.4.4.4.3.2.4.3.2.cmml" xref="S2.E3.m1.4.4.4.3.2.4.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.2.4.3.2.1.cmml" xref="S2.E3.m1.4.4.4.3.2.4.3.2">superscript</csymbol><ci id="S2.E3.m1.4.4.4.3.2.4.3.2.2.cmml" xref="S2.E3.m1.4.4.4.3.2.4.3.2.2">𝑡</ci><ci id="S2.E3.m1.4.4.4.3.2.4.3.2.3.cmml" xref="S2.E3.m1.4.4.4.3.2.4.3.2.3">′</ci></apply><ci id="S2.E3.m1.4.4.4.3.2.4.3.3.cmml" xref="S2.E3.m1.4.4.4.3.2.4.3.3">𝑡</ci></apply></apply><ci id="S2.E3.m1.4.4.4.3.2.5.cmml" xref="S2.E3.m1.4.4.4.3.2.5">𝑅</ci><interval closure="open" id="S2.E3.m1.4.4.4.3.2.2.3.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2"><apply id="S2.E3.m1.3.3.3.2.1.1.1.1.cmml" xref="S2.E3.m1.3.3.3.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.2.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.3.2.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.3.2.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.3.2.1.1.1.1.2">𝑠</ci><apply id="S2.E3.m1.3.3.3.2.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.3.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.3.2.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.3.3.3.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.3.2.1.1.1.1.3.2">𝑡</ci><ci id="S2.E3.m1.3.3.3.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.3.2.1.1.1.1.3.3">′</ci></apply></apply><apply id="S2.E3.m1.4.4.4.3.2.2.2.2.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.2.2.2.2.1.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.4.4.4.3.2.2.2.2.2.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2.2.2">𝑎</ci><apply id="S2.E3.m1.4.4.4.3.2.2.2.2.3.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.4.3.2.2.2.2.3.1.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2.2.3">superscript</csymbol><ci id="S2.E3.m1.4.4.4.3.2.2.2.2.3.2.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2.2.3.2">𝑡</ci><ci id="S2.E3.m1.4.4.4.3.2.2.2.2.3.3.cmml" xref="S2.E3.m1.4.4.4.3.2.2.2.2.3.3">′</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.4c">\displaystyle\nabla_{\theta}J^{\pi_{\theta}}(s_{t})=\nabla_{\theta}log(\pi_{\theta}(a_{t}|s_{t}))\sum^{\infty}_{t^{\prime}=t}\gamma^{t^{\prime}-t}R(s_{t^{\prime}},a_{t^{\prime}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.SSS1.p2" class="ltx_para">
<p id="S2.SS2.SSS1.p2.1" class="ltx_p">However, a key weakness of this approach is the high variance brought on from the sum of discounted rewards for a given episode <math id="S2.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\sum_{t^{\prime}=t}^{\infty}" display="inline"><semantics id="S2.SS2.SSS1.p2.1.m1.1a"><msubsup id="S2.SS2.SSS1.p2.1.m1.1.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.cmml"><mo id="S2.SS2.SSS1.p2.1.m1.1.1.2.2" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.2.cmml">∑</mo><mrow id="S2.SS2.SSS1.p2.1.m1.1.1.2.3" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.cmml"><msup id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.cmml"><mi id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.2" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.2.cmml">t</mi><mo id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.3" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.3.cmml">′</mo></msup><mo id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.1.cmml">=</mo><mi id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.3" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.3.cmml">t</mi></mrow><mi mathvariant="normal" id="S2.SS2.SSS1.p2.1.m1.1.1.3" xref="S2.SS2.SSS1.p2.1.m1.1.1.3.cmml">∞</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.1.m1.1b"><apply id="S2.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">superscript</csymbol><apply id="S2.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">subscript</csymbol><sum id="S2.SS2.SSS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.2"></sum><apply id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3"><eq id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.1"></eq><apply id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2">superscript</csymbol><ci id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.2">𝑡</ci><ci id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.3.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.2.3">′</ci></apply><ci id="S2.SS2.SSS1.p2.1.m1.1.1.2.3.3.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.3.3">𝑡</ci></apply></apply><infinity id="S2.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.1.m1.1c">\sum_{t^{\prime}=t}^{\infty}</annotation></semantics></math>, as rewards can vary significantly from episode to episode <cite class="ltx_cite ltx_citemacro_citep">(Konda and
Tsitsiklis, <a href="#bib.bib16" title="" class="ltx_ref">1999</a>)</cite>. To account for this, Actor-Critic methods were proposed, which utilize a function to approximate the sum of expected rewards and train that function separately. This function, called the Q-function or critic function, is trained through off-policy temporal-difference learning by minimizing:</p>
<table id="A0.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{Q}(\psi)" display="inline"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.2" xref="S2.E4.m1.1.2.cmml"><msub id="S2.E4.m1.1.2.2" xref="S2.E4.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.2.2.2" xref="S2.E4.m1.1.2.2.2.cmml">ℒ</mi><mi id="S2.E4.m1.1.2.2.3" xref="S2.E4.m1.1.2.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.2.1" xref="S2.E4.m1.1.2.1.cmml">​</mo><mrow id="S2.E4.m1.1.2.3.2" xref="S2.E4.m1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.1.2.3.2.1" xref="S2.E4.m1.1.2.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">ψ</mi><mo stretchy="false" id="S2.E4.m1.1.2.3.2.2" xref="S2.E4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.2.cmml" xref="S2.E4.m1.1.2"><times id="S2.E4.m1.1.2.1.cmml" xref="S2.E4.m1.1.2.1"></times><apply id="S2.E4.m1.1.2.2.cmml" xref="S2.E4.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.2.1.cmml" xref="S2.E4.m1.1.2.2">subscript</csymbol><ci id="S2.E4.m1.1.2.2.2.cmml" xref="S2.E4.m1.1.2.2.2">ℒ</ci><ci id="S2.E4.m1.1.2.2.3.cmml" xref="S2.E4.m1.1.2.2.3">𝑄</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle\mathcal{L}_{Q}(\psi)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.7" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{(s,a,r,s^{\prime})\approx D}(Q_{\psi}(s,a)-y)^{2}" display="inline"><semantics id="S2.E4.m2.7a"><mrow id="S2.E4.m2.7.7" xref="S2.E4.m2.7.7.cmml"><mi id="S2.E4.m2.7.7.3" xref="S2.E4.m2.7.7.3.cmml"></mi><mo id="S2.E4.m2.7.7.2" xref="S2.E4.m2.7.7.2.cmml">=</mo><mrow id="S2.E4.m2.7.7.1" xref="S2.E4.m2.7.7.1.cmml"><msub id="S2.E4.m2.7.7.1.3" xref="S2.E4.m2.7.7.1.3.cmml"><mi id="S2.E4.m2.7.7.1.3.2" xref="S2.E4.m2.7.7.1.3.2.cmml">𝔼</mi><mrow id="S2.E4.m2.4.4.4" xref="S2.E4.m2.4.4.4.cmml"><mrow id="S2.E4.m2.4.4.4.4.1" xref="S2.E4.m2.4.4.4.4.2.cmml"><mo stretchy="false" id="S2.E4.m2.4.4.4.4.1.2" xref="S2.E4.m2.4.4.4.4.2.cmml">(</mo><mi id="S2.E4.m2.1.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml">s</mi><mo id="S2.E4.m2.4.4.4.4.1.3" xref="S2.E4.m2.4.4.4.4.2.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2" xref="S2.E4.m2.2.2.2.2.cmml">a</mi><mo id="S2.E4.m2.4.4.4.4.1.4" xref="S2.E4.m2.4.4.4.4.2.cmml">,</mo><mi id="S2.E4.m2.3.3.3.3" xref="S2.E4.m2.3.3.3.3.cmml">r</mi><mo id="S2.E4.m2.4.4.4.4.1.5" xref="S2.E4.m2.4.4.4.4.2.cmml">,</mo><msup id="S2.E4.m2.4.4.4.4.1.1" xref="S2.E4.m2.4.4.4.4.1.1.cmml"><mi id="S2.E4.m2.4.4.4.4.1.1.2" xref="S2.E4.m2.4.4.4.4.1.1.2.cmml">s</mi><mo id="S2.E4.m2.4.4.4.4.1.1.3" xref="S2.E4.m2.4.4.4.4.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S2.E4.m2.4.4.4.4.1.6" xref="S2.E4.m2.4.4.4.4.2.cmml">)</mo></mrow><mo id="S2.E4.m2.4.4.4.5" xref="S2.E4.m2.4.4.4.5.cmml">≈</mo><mi id="S2.E4.m2.4.4.4.6" xref="S2.E4.m2.4.4.4.6.cmml">D</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E4.m2.7.7.1.2" xref="S2.E4.m2.7.7.1.2.cmml">​</mo><msup id="S2.E4.m2.7.7.1.1" xref="S2.E4.m2.7.7.1.1.cmml"><mrow id="S2.E4.m2.7.7.1.1.1.1" xref="S2.E4.m2.7.7.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m2.7.7.1.1.1.1.2" xref="S2.E4.m2.7.7.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m2.7.7.1.1.1.1.1" xref="S2.E4.m2.7.7.1.1.1.1.1.cmml"><mrow id="S2.E4.m2.7.7.1.1.1.1.1.2" xref="S2.E4.m2.7.7.1.1.1.1.1.2.cmml"><msub id="S2.E4.m2.7.7.1.1.1.1.1.2.2" xref="S2.E4.m2.7.7.1.1.1.1.1.2.2.cmml"><mi id="S2.E4.m2.7.7.1.1.1.1.1.2.2.2" xref="S2.E4.m2.7.7.1.1.1.1.1.2.2.2.cmml">Q</mi><mi id="S2.E4.m2.7.7.1.1.1.1.1.2.2.3" xref="S2.E4.m2.7.7.1.1.1.1.1.2.2.3.cmml">ψ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m2.7.7.1.1.1.1.1.2.1" xref="S2.E4.m2.7.7.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E4.m2.7.7.1.1.1.1.1.2.3.2" xref="S2.E4.m2.7.7.1.1.1.1.1.2.3.1.cmml"><mo stretchy="false" id="S2.E4.m2.7.7.1.1.1.1.1.2.3.2.1" xref="S2.E4.m2.7.7.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E4.m2.5.5" xref="S2.E4.m2.5.5.cmml">s</mi><mo id="S2.E4.m2.7.7.1.1.1.1.1.2.3.2.2" xref="S2.E4.m2.7.7.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E4.m2.6.6" xref="S2.E4.m2.6.6.cmml">a</mi><mo stretchy="false" id="S2.E4.m2.7.7.1.1.1.1.1.2.3.2.3" xref="S2.E4.m2.7.7.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m2.7.7.1.1.1.1.1.1" xref="S2.E4.m2.7.7.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E4.m2.7.7.1.1.1.1.1.3" xref="S2.E4.m2.7.7.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S2.E4.m2.7.7.1.1.1.1.3" xref="S2.E4.m2.7.7.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.E4.m2.7.7.1.1.3" xref="S2.E4.m2.7.7.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.7b"><apply id="S2.E4.m2.7.7.cmml" xref="S2.E4.m2.7.7"><eq id="S2.E4.m2.7.7.2.cmml" xref="S2.E4.m2.7.7.2"></eq><csymbol cd="latexml" id="S2.E4.m2.7.7.3.cmml" xref="S2.E4.m2.7.7.3">absent</csymbol><apply id="S2.E4.m2.7.7.1.cmml" xref="S2.E4.m2.7.7.1"><times id="S2.E4.m2.7.7.1.2.cmml" xref="S2.E4.m2.7.7.1.2"></times><apply id="S2.E4.m2.7.7.1.3.cmml" xref="S2.E4.m2.7.7.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.7.7.1.3.1.cmml" xref="S2.E4.m2.7.7.1.3">subscript</csymbol><ci id="S2.E4.m2.7.7.1.3.2.cmml" xref="S2.E4.m2.7.7.1.3.2">𝔼</ci><apply id="S2.E4.m2.4.4.4.cmml" xref="S2.E4.m2.4.4.4"><approx id="S2.E4.m2.4.4.4.5.cmml" xref="S2.E4.m2.4.4.4.5"></approx><vector id="S2.E4.m2.4.4.4.4.2.cmml" xref="S2.E4.m2.4.4.4.4.1"><ci id="S2.E4.m2.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1">𝑠</ci><ci id="S2.E4.m2.2.2.2.2.cmml" xref="S2.E4.m2.2.2.2.2">𝑎</ci><ci id="S2.E4.m2.3.3.3.3.cmml" xref="S2.E4.m2.3.3.3.3">𝑟</ci><apply id="S2.E4.m2.4.4.4.4.1.1.cmml" xref="S2.E4.m2.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.4.4.4.4.1.1.1.cmml" xref="S2.E4.m2.4.4.4.4.1.1">superscript</csymbol><ci id="S2.E4.m2.4.4.4.4.1.1.2.cmml" xref="S2.E4.m2.4.4.4.4.1.1.2">𝑠</ci><ci id="S2.E4.m2.4.4.4.4.1.1.3.cmml" xref="S2.E4.m2.4.4.4.4.1.1.3">′</ci></apply></vector><ci id="S2.E4.m2.4.4.4.6.cmml" xref="S2.E4.m2.4.4.4.6">𝐷</ci></apply></apply><apply id="S2.E4.m2.7.7.1.1.cmml" xref="S2.E4.m2.7.7.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.7.7.1.1.2.cmml" xref="S2.E4.m2.7.7.1.1">superscript</csymbol><apply id="S2.E4.m2.7.7.1.1.1.1.1.cmml" xref="S2.E4.m2.7.7.1.1.1.1"><minus id="S2.E4.m2.7.7.1.1.1.1.1.1.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.1"></minus><apply id="S2.E4.m2.7.7.1.1.1.1.1.2.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.2"><times id="S2.E4.m2.7.7.1.1.1.1.1.2.1.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.2.1"></times><apply id="S2.E4.m2.7.7.1.1.1.1.1.2.2.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m2.7.7.1.1.1.1.1.2.2.1.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E4.m2.7.7.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.2.2.2">𝑄</ci><ci id="S2.E4.m2.7.7.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.2.2.3">𝜓</ci></apply><interval closure="open" id="S2.E4.m2.7.7.1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.2.3.2"><ci id="S2.E4.m2.5.5.cmml" xref="S2.E4.m2.5.5">𝑠</ci><ci id="S2.E4.m2.6.6.cmml" xref="S2.E4.m2.6.6">𝑎</ci></interval></apply><ci id="S2.E4.m2.7.7.1.1.1.1.1.3.cmml" xref="S2.E4.m2.7.7.1.1.1.1.1.3">𝑦</ci></apply><cn type="integer" id="S2.E4.m2.7.7.1.1.3.cmml" xref="S2.E4.m2.7.7.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.7c">\displaystyle=\mathbb{E}_{(s,a,r,s^{\prime})\approx D}(Q_{\psi}(s,a)-y)^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\displaystyle y" display="inline"><semantics id="S2.E5.m1.1a"><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle y</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m2.5" class="ltx_Math" alttext="\displaystyle=r(s,a)+\gamma\mathbb{E}_{a^{\prime}\approx\pi(s^{\prime})}Q_{\hat{\psi}(s^{\prime},a^{\prime})}" display="inline"><semantics id="S2.E5.m2.5a"><mrow id="S2.E5.m2.5.6" xref="S2.E5.m2.5.6.cmml"><mi id="S2.E5.m2.5.6.2" xref="S2.E5.m2.5.6.2.cmml"></mi><mo id="S2.E5.m2.5.6.1" xref="S2.E5.m2.5.6.1.cmml">=</mo><mrow id="S2.E5.m2.5.6.3" xref="S2.E5.m2.5.6.3.cmml"><mrow id="S2.E5.m2.5.6.3.2" xref="S2.E5.m2.5.6.3.2.cmml"><mi id="S2.E5.m2.5.6.3.2.2" xref="S2.E5.m2.5.6.3.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.5.6.3.2.1" xref="S2.E5.m2.5.6.3.2.1.cmml">​</mo><mrow id="S2.E5.m2.5.6.3.2.3.2" xref="S2.E5.m2.5.6.3.2.3.1.cmml"><mo stretchy="false" id="S2.E5.m2.5.6.3.2.3.2.1" xref="S2.E5.m2.5.6.3.2.3.1.cmml">(</mo><mi id="S2.E5.m2.4.4" xref="S2.E5.m2.4.4.cmml">s</mi><mo id="S2.E5.m2.5.6.3.2.3.2.2" xref="S2.E5.m2.5.6.3.2.3.1.cmml">,</mo><mi id="S2.E5.m2.5.5" xref="S2.E5.m2.5.5.cmml">a</mi><mo stretchy="false" id="S2.E5.m2.5.6.3.2.3.2.3" xref="S2.E5.m2.5.6.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m2.5.6.3.1" xref="S2.E5.m2.5.6.3.1.cmml">+</mo><mrow id="S2.E5.m2.5.6.3.3" xref="S2.E5.m2.5.6.3.3.cmml"><mi id="S2.E5.m2.5.6.3.3.2" xref="S2.E5.m2.5.6.3.3.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.5.6.3.3.1" xref="S2.E5.m2.5.6.3.3.1.cmml">​</mo><msub id="S2.E5.m2.5.6.3.3.3" xref="S2.E5.m2.5.6.3.3.3.cmml"><mi id="S2.E5.m2.5.6.3.3.3.2" xref="S2.E5.m2.5.6.3.3.3.2.cmml">𝔼</mi><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.cmml"><msup id="S2.E5.m2.1.1.1.3" xref="S2.E5.m2.1.1.1.3.cmml"><mi id="S2.E5.m2.1.1.1.3.2" xref="S2.E5.m2.1.1.1.3.2.cmml">a</mi><mo id="S2.E5.m2.1.1.1.3.3" xref="S2.E5.m2.1.1.1.3.3.cmml">′</mo></msup><mo id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.2.cmml">≈</mo><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m2.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m2.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E5.m2.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S2.E5.m2.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S2.E5.m2.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E5.m2.5.6.3.3.1a" xref="S2.E5.m2.5.6.3.3.1.cmml">​</mo><msub id="S2.E5.m2.5.6.3.3.4" xref="S2.E5.m2.5.6.3.3.4.cmml"><mi id="S2.E5.m2.5.6.3.3.4.2" xref="S2.E5.m2.5.6.3.3.4.2.cmml">Q</mi><mrow id="S2.E5.m2.3.3.2" xref="S2.E5.m2.3.3.2.cmml"><mover accent="true" id="S2.E5.m2.3.3.2.4" xref="S2.E5.m2.3.3.2.4.cmml"><mi id="S2.E5.m2.3.3.2.4.2" xref="S2.E5.m2.3.3.2.4.2.cmml">ψ</mi><mo id="S2.E5.m2.3.3.2.4.1" xref="S2.E5.m2.3.3.2.4.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S2.E5.m2.3.3.2.3" xref="S2.E5.m2.3.3.2.3.cmml">​</mo><mrow id="S2.E5.m2.3.3.2.2.2" xref="S2.E5.m2.3.3.2.2.3.cmml"><mo stretchy="false" id="S2.E5.m2.3.3.2.2.2.3" xref="S2.E5.m2.3.3.2.2.3.cmml">(</mo><msup id="S2.E5.m2.2.2.1.1.1.1" xref="S2.E5.m2.2.2.1.1.1.1.cmml"><mi id="S2.E5.m2.2.2.1.1.1.1.2" xref="S2.E5.m2.2.2.1.1.1.1.2.cmml">s</mi><mo id="S2.E5.m2.2.2.1.1.1.1.3" xref="S2.E5.m2.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.E5.m2.3.3.2.2.2.4" xref="S2.E5.m2.3.3.2.2.3.cmml">,</mo><msup id="S2.E5.m2.3.3.2.2.2.2" xref="S2.E5.m2.3.3.2.2.2.2.cmml"><mi id="S2.E5.m2.3.3.2.2.2.2.2" xref="S2.E5.m2.3.3.2.2.2.2.2.cmml">a</mi><mo id="S2.E5.m2.3.3.2.2.2.2.3" xref="S2.E5.m2.3.3.2.2.2.2.3.cmml">′</mo></msup><mo stretchy="false" id="S2.E5.m2.3.3.2.2.2.5" xref="S2.E5.m2.3.3.2.2.3.cmml">)</mo></mrow></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.5b"><apply id="S2.E5.m2.5.6.cmml" xref="S2.E5.m2.5.6"><eq id="S2.E5.m2.5.6.1.cmml" xref="S2.E5.m2.5.6.1"></eq><csymbol cd="latexml" id="S2.E5.m2.5.6.2.cmml" xref="S2.E5.m2.5.6.2">absent</csymbol><apply id="S2.E5.m2.5.6.3.cmml" xref="S2.E5.m2.5.6.3"><plus id="S2.E5.m2.5.6.3.1.cmml" xref="S2.E5.m2.5.6.3.1"></plus><apply id="S2.E5.m2.5.6.3.2.cmml" xref="S2.E5.m2.5.6.3.2"><times id="S2.E5.m2.5.6.3.2.1.cmml" xref="S2.E5.m2.5.6.3.2.1"></times><ci id="S2.E5.m2.5.6.3.2.2.cmml" xref="S2.E5.m2.5.6.3.2.2">𝑟</ci><interval closure="open" id="S2.E5.m2.5.6.3.2.3.1.cmml" xref="S2.E5.m2.5.6.3.2.3.2"><ci id="S2.E5.m2.4.4.cmml" xref="S2.E5.m2.4.4">𝑠</ci><ci id="S2.E5.m2.5.5.cmml" xref="S2.E5.m2.5.5">𝑎</ci></interval></apply><apply id="S2.E5.m2.5.6.3.3.cmml" xref="S2.E5.m2.5.6.3.3"><times id="S2.E5.m2.5.6.3.3.1.cmml" xref="S2.E5.m2.5.6.3.3.1"></times><ci id="S2.E5.m2.5.6.3.3.2.cmml" xref="S2.E5.m2.5.6.3.3.2">𝛾</ci><apply id="S2.E5.m2.5.6.3.3.3.cmml" xref="S2.E5.m2.5.6.3.3.3"><csymbol cd="ambiguous" id="S2.E5.m2.5.6.3.3.3.1.cmml" xref="S2.E5.m2.5.6.3.3.3">subscript</csymbol><ci id="S2.E5.m2.5.6.3.3.3.2.cmml" xref="S2.E5.m2.5.6.3.3.3.2">𝔼</ci><apply id="S2.E5.m2.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><approx id="S2.E5.m2.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.2"></approx><apply id="S2.E5.m2.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.3.1.cmml" xref="S2.E5.m2.1.1.1.3">superscript</csymbol><ci id="S2.E5.m2.1.1.1.3.2.cmml" xref="S2.E5.m2.1.1.1.3.2">𝑎</ci><ci id="S2.E5.m2.1.1.1.3.3.cmml" xref="S2.E5.m2.1.1.1.3.3">′</ci></apply><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1"><times id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2"></times><ci id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3">𝜋</ci><apply id="S2.E5.m2.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.E5.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></apply><apply id="S2.E5.m2.5.6.3.3.4.cmml" xref="S2.E5.m2.5.6.3.3.4"><csymbol cd="ambiguous" id="S2.E5.m2.5.6.3.3.4.1.cmml" xref="S2.E5.m2.5.6.3.3.4">subscript</csymbol><ci id="S2.E5.m2.5.6.3.3.4.2.cmml" xref="S2.E5.m2.5.6.3.3.4.2">𝑄</ci><apply id="S2.E5.m2.3.3.2.cmml" xref="S2.E5.m2.3.3.2"><times id="S2.E5.m2.3.3.2.3.cmml" xref="S2.E5.m2.3.3.2.3"></times><apply id="S2.E5.m2.3.3.2.4.cmml" xref="S2.E5.m2.3.3.2.4"><ci id="S2.E5.m2.3.3.2.4.1.cmml" xref="S2.E5.m2.3.3.2.4.1">^</ci><ci id="S2.E5.m2.3.3.2.4.2.cmml" xref="S2.E5.m2.3.3.2.4.2">𝜓</ci></apply><interval closure="open" id="S2.E5.m2.3.3.2.2.3.cmml" xref="S2.E5.m2.3.3.2.2.2"><apply id="S2.E5.m2.2.2.1.1.1.1.cmml" xref="S2.E5.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.2.2.1.1.1.1.1.cmml" xref="S2.E5.m2.2.2.1.1.1.1">superscript</csymbol><ci id="S2.E5.m2.2.2.1.1.1.1.2.cmml" xref="S2.E5.m2.2.2.1.1.1.1.2">𝑠</ci><ci id="S2.E5.m2.2.2.1.1.1.1.3.cmml" xref="S2.E5.m2.2.2.1.1.1.1.3">′</ci></apply><apply id="S2.E5.m2.3.3.2.2.2.2.cmml" xref="S2.E5.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m2.3.3.2.2.2.2.1.cmml" xref="S2.E5.m2.3.3.2.2.2.2">superscript</csymbol><ci id="S2.E5.m2.3.3.2.2.2.2.2.cmml" xref="S2.E5.m2.3.3.2.2.2.2.2">𝑎</ci><ci id="S2.E5.m2.3.3.2.2.2.2.3.cmml" xref="S2.E5.m2.3.3.2.2.2.2.3">′</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.5c">\displaystyle=r(s,a)+\gamma\mathbb{E}_{a^{\prime}\approx\pi(s^{\prime})}Q_{\hat{\psi}(s^{\prime},a^{\prime})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS1.p2.4" class="ltx_p">where <math id="S2.SS2.SSS1.p2.2.m1.1" class="ltx_Math" alttext="Q_{\bar{\psi}}" display="inline"><semantics id="S2.SS2.SSS1.p2.2.m1.1a"><msub id="S2.SS2.SSS1.p2.2.m1.1.1" xref="S2.SS2.SSS1.p2.2.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p2.2.m1.1.1.2" xref="S2.SS2.SSS1.p2.2.m1.1.1.2.cmml">Q</mi><mover accent="true" id="S2.SS2.SSS1.p2.2.m1.1.1.3" xref="S2.SS2.SSS1.p2.2.m1.1.1.3.cmml"><mi id="S2.SS2.SSS1.p2.2.m1.1.1.3.2" xref="S2.SS2.SSS1.p2.2.m1.1.1.3.2.cmml">ψ</mi><mo id="S2.SS2.SSS1.p2.2.m1.1.1.3.1" xref="S2.SS2.SSS1.p2.2.m1.1.1.3.1.cmml">¯</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.2.m1.1b"><apply id="S2.SS2.SSS1.p2.2.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.2.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.2.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.2.m1.1.1.2">𝑄</ci><apply id="S2.SS2.SSS1.p2.2.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.2.m1.1.1.3"><ci id="S2.SS2.SSS1.p2.2.m1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p2.2.m1.1.1.3.1">¯</ci><ci id="S2.SS2.SSS1.p2.2.m1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p2.2.m1.1.1.3.2">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.2.m1.1c">Q_{\bar{\psi}}</annotation></semantics></math> is a target Q-function (parameterized by <math id="S2.SS2.SSS1.p2.3.m2.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S2.SS2.SSS1.p2.3.m2.1a"><mi id="S2.SS2.SSS1.p2.3.m2.1.1" xref="S2.SS2.SSS1.p2.3.m2.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.3.m2.1b"><ci id="S2.SS2.SSS1.p2.3.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m2.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.3.m2.1c">\psi</annotation></semantics></math>), an average of past Q-functions, and <math id="S2.SS2.SSS1.p2.4.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS2.SSS1.p2.4.m3.1a"><mi id="S2.SS2.SSS1.p2.4.m3.1.1" xref="S2.SS2.SSS1.p2.4.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.4.m3.1b"><ci id="S2.SS2.SSS1.p2.4.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.4.m3.1c">D</annotation></semantics></math> is a replay buffer of past episodes.
Recent approaches towards Actor-Critic methods include an entropy term during the policy gradient step to encourage exploration <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja
et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite>. This new variant, titled Soft Actor-Critic (SAC), proposes a soft policy update given as</p>
<table id="A0.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\displaystyle\nabla_{\theta}J(\pi_{\theta})" display="inline"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><mrow id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml"><msub id="S2.E6.m1.1.1.3.1" xref="S2.E6.m1.1.1.3.1.cmml"><mo id="S2.E6.m1.1.1.3.1.2" xref="S2.E6.m1.1.1.3.1.2.cmml">∇</mo><mi id="S2.E6.m1.1.1.3.1.3" xref="S2.E6.m1.1.1.3.1.3.cmml">θ</mi></msub><mi id="S2.E6.m1.1.1.3.2" xref="S2.E6.m1.1.1.3.2.cmml">J</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.2" xref="S2.E6.m1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.2.cmml">π</mi><mi id="S2.E6.m1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.3.cmml">θ</mi></msub><mo stretchy="false" id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><times id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1.2"></times><apply id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3"><apply id="S2.E6.m1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.1.1.cmml" xref="S2.E6.m1.1.1.3.1">subscript</csymbol><ci id="S2.E6.m1.1.1.3.1.2.cmml" xref="S2.E6.m1.1.1.3.1.2">∇</ci><ci id="S2.E6.m1.1.1.3.1.3.cmml" xref="S2.E6.m1.1.1.3.1.3">𝜃</ci></apply><ci id="S2.E6.m1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.3.2">𝐽</ci></apply><apply id="S2.E6.m1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.2">𝜋</ci><ci id="S2.E6.m1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\nabla_{\theta}J(\pi_{\theta})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex1.m1.6" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{s\approx D,a\approx\pi}\nabla_{\theta}log(\pi_{\theta}(a|s)(-\alpha log(\pi_{\theta}(a|s))+Q_{\psi}(s,a)-b(s)))" display="inline"><semantics id="S2.Ex1.m1.6a"><mrow id="S2.Ex1.m1.6.6" xref="S2.Ex1.m1.6.6.cmml"><mi id="S2.Ex1.m1.6.6.3" xref="S2.Ex1.m1.6.6.3.cmml"></mi><mo id="S2.Ex1.m1.6.6.2" xref="S2.Ex1.m1.6.6.2.cmml">=</mo><mrow id="S2.Ex1.m1.6.6.1" xref="S2.Ex1.m1.6.6.1.cmml"><msub id="S2.Ex1.m1.6.6.1.3" xref="S2.Ex1.m1.6.6.1.3.cmml"><mi id="S2.Ex1.m1.6.6.1.3.2" xref="S2.Ex1.m1.6.6.1.3.2.cmml">𝔼</mi><mrow id="S2.Ex1.m1.2.2.2.2" xref="S2.Ex1.m1.2.2.2.3.cmml"><mrow id="S2.Ex1.m1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.2.cmml">s</mi><mo id="S2.Ex1.m1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml">≈</mo><mi id="S2.Ex1.m1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.3.cmml">D</mi></mrow><mo id="S2.Ex1.m1.2.2.2.2.3" xref="S2.Ex1.m1.2.2.2.3a.cmml">,</mo><mrow id="S2.Ex1.m1.2.2.2.2.2" xref="S2.Ex1.m1.2.2.2.2.2.cmml"><mi id="S2.Ex1.m1.2.2.2.2.2.2" xref="S2.Ex1.m1.2.2.2.2.2.2.cmml">a</mi><mo id="S2.Ex1.m1.2.2.2.2.2.1" xref="S2.Ex1.m1.2.2.2.2.2.1.cmml">≈</mo><mi id="S2.Ex1.m1.2.2.2.2.2.3" xref="S2.Ex1.m1.2.2.2.2.2.3.cmml">π</mi></mrow></mrow></msub><mo lspace="0.167em" rspace="0em" id="S2.Ex1.m1.6.6.1.2" xref="S2.Ex1.m1.6.6.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.4" xref="S2.Ex1.m1.6.6.1.4.cmml"><msub id="S2.Ex1.m1.6.6.1.4.1" xref="S2.Ex1.m1.6.6.1.4.1.cmml"><mo rspace="0.167em" id="S2.Ex1.m1.6.6.1.4.1.2" xref="S2.Ex1.m1.6.6.1.4.1.2.cmml">∇</mo><mi id="S2.Ex1.m1.6.6.1.4.1.3" xref="S2.Ex1.m1.6.6.1.4.1.3.cmml">θ</mi></msub><mrow id="S2.Ex1.m1.6.6.1.4.2" xref="S2.Ex1.m1.6.6.1.4.2.cmml"><mi id="S2.Ex1.m1.6.6.1.4.2.2" xref="S2.Ex1.m1.6.6.1.4.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.4.2.1" xref="S2.Ex1.m1.6.6.1.4.2.1.cmml">​</mo><mi id="S2.Ex1.m1.6.6.1.4.2.3" xref="S2.Ex1.m1.6.6.1.4.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.4.2.1a" xref="S2.Ex1.m1.6.6.1.4.2.1.cmml">​</mo><mi id="S2.Ex1.m1.6.6.1.4.2.4" xref="S2.Ex1.m1.6.6.1.4.2.4.cmml">g</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.2a" xref="S2.Ex1.m1.6.6.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml"><msub id="S2.Ex1.m1.6.6.1.1.1.1.4" xref="S2.Ex1.m1.6.6.1.1.1.1.4.cmml"><mi id="S2.Ex1.m1.6.6.1.1.1.1.4.2" xref="S2.Ex1.m1.6.6.1.1.1.1.4.2.cmml">π</mi><mi id="S2.Ex1.m1.6.6.1.1.1.1.4.3" xref="S2.Ex1.m1.6.6.1.1.1.1.4.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.3.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.3a" xref="S2.Ex1.m1.6.6.1.1.1.1.3.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.cmml"><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.cmml"><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.cmml"><mo id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1a" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.cmml">−</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2.cmml">​</mo><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.4" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2a" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2.cmml">​</mo><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.5" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2b" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2.cmml">​</mo><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.6" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2c" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.2.cmml">+</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.cmml"><msub id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.cmml"><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.2.cmml">Q</mi><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.3.cmml">ψ</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.1.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.2.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.1.cmml">(</mo><mi id="S2.Ex1.m1.3.3" xref="S2.Ex1.m1.3.3.cmml">s</mi><mo id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.2.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.1.cmml">,</mo><mi id="S2.Ex1.m1.4.4" xref="S2.Ex1.m1.4.4.cmml">a</mi><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.2.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.2.cmml">−</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.cmml"><mi id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.1.cmml">​</mo><mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.3.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.cmml"><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.3.2.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.cmml">(</mo><mi id="S2.Ex1.m1.5.5" xref="S2.Ex1.m1.5.5.cmml">s</mi><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.3.2.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.Ex1.m1.6.6.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.6b"><apply id="S2.Ex1.m1.6.6.cmml" xref="S2.Ex1.m1.6.6"><eq id="S2.Ex1.m1.6.6.2.cmml" xref="S2.Ex1.m1.6.6.2"></eq><csymbol cd="latexml" id="S2.Ex1.m1.6.6.3.cmml" xref="S2.Ex1.m1.6.6.3">absent</csymbol><apply id="S2.Ex1.m1.6.6.1.cmml" xref="S2.Ex1.m1.6.6.1"><times id="S2.Ex1.m1.6.6.1.2.cmml" xref="S2.Ex1.m1.6.6.1.2"></times><apply id="S2.Ex1.m1.6.6.1.3.cmml" xref="S2.Ex1.m1.6.6.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.1.3.1.cmml" xref="S2.Ex1.m1.6.6.1.3">subscript</csymbol><ci id="S2.Ex1.m1.6.6.1.3.2.cmml" xref="S2.Ex1.m1.6.6.1.3.2">𝔼</ci><apply id="S2.Ex1.m1.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.3a.cmml" xref="S2.Ex1.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.Ex1.m1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1"><approx id="S2.Ex1.m1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1"></approx><ci id="S2.Ex1.m1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S2.Ex1.m1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3">𝐷</ci></apply><apply id="S2.Ex1.m1.2.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.2"><approx id="S2.Ex1.m1.2.2.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.2.2.1"></approx><ci id="S2.Ex1.m1.2.2.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2.2.2">𝑎</ci><ci id="S2.Ex1.m1.2.2.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.2.2.3">𝜋</ci></apply></apply></apply><apply id="S2.Ex1.m1.6.6.1.4.cmml" xref="S2.Ex1.m1.6.6.1.4"><apply id="S2.Ex1.m1.6.6.1.4.1.cmml" xref="S2.Ex1.m1.6.6.1.4.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.1.4.1.1.cmml" xref="S2.Ex1.m1.6.6.1.4.1">subscript</csymbol><ci id="S2.Ex1.m1.6.6.1.4.1.2.cmml" xref="S2.Ex1.m1.6.6.1.4.1.2">∇</ci><ci id="S2.Ex1.m1.6.6.1.4.1.3.cmml" xref="S2.Ex1.m1.6.6.1.4.1.3">𝜃</ci></apply><apply id="S2.Ex1.m1.6.6.1.4.2.cmml" xref="S2.Ex1.m1.6.6.1.4.2"><times id="S2.Ex1.m1.6.6.1.4.2.1.cmml" xref="S2.Ex1.m1.6.6.1.4.2.1"></times><ci id="S2.Ex1.m1.6.6.1.4.2.2.cmml" xref="S2.Ex1.m1.6.6.1.4.2.2">𝑙</ci><ci id="S2.Ex1.m1.6.6.1.4.2.3.cmml" xref="S2.Ex1.m1.6.6.1.4.2.3">𝑜</ci><ci id="S2.Ex1.m1.6.6.1.4.2.4.cmml" xref="S2.Ex1.m1.6.6.1.4.2.4">𝑔</ci></apply></apply><apply id="S2.Ex1.m1.6.6.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1"><times id="S2.Ex1.m1.6.6.1.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.3"></times><apply id="S2.Ex1.m1.6.6.1.1.1.1.4.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.1.1.1.1.4.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex1.m1.6.6.1.1.1.1.4.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.4.2">𝜋</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.4.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.4.3">𝜃</ci></apply><apply id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1"><minus id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.2"></minus><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1"><plus id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.2"></plus><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1"><minus id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1"></minus><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1"><times id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.2"></times><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.3">𝛼</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.4.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.4">𝑙</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.5.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.5">𝑜</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.6.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.6">𝑔</ci><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1"><times id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.2"></times><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.2">𝜋</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3"><times id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.1"></times><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.2">𝑄</ci><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.2.3">𝜓</ci></apply><interval closure="open" id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.1.3.3.2"><ci id="S2.Ex1.m1.3.3.cmml" xref="S2.Ex1.m1.3.3">𝑠</ci><ci id="S2.Ex1.m1.4.4.cmml" xref="S2.Ex1.m1.4.4">𝑎</ci></interval></apply></apply><apply id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3"><times id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.1"></times><ci id="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.1.3.2">𝑏</ci><ci id="S2.Ex1.m1.5.5.cmml" xref="S2.Ex1.m1.5.5">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.6c">\displaystyle=\mathbb{E}_{s\approx D,a\approx\pi}\nabla_{\theta}log(\pi_{\theta}(a|s)(-\alpha log(\pi_{\theta}(a|s))+Q_{\psi}(s,a)-b(s)))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS1.p2.5" class="ltx_p">where <math id="S2.SS2.SSS1.p2.5.m1.1" class="ltx_Math" alttext="b(s)" display="inline"><semantics id="S2.SS2.SSS1.p2.5.m1.1a"><mrow id="S2.SS2.SSS1.p2.5.m1.1.2" xref="S2.SS2.SSS1.p2.5.m1.1.2.cmml"><mi id="S2.SS2.SSS1.p2.5.m1.1.2.2" xref="S2.SS2.SSS1.p2.5.m1.1.2.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.5.m1.1.2.1" xref="S2.SS2.SSS1.p2.5.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p2.5.m1.1.2.3.2" xref="S2.SS2.SSS1.p2.5.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.5.m1.1.2.3.2.1" xref="S2.SS2.SSS1.p2.5.m1.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p2.5.m1.1.1" xref="S2.SS2.SSS1.p2.5.m1.1.1.cmml">s</mi><mo stretchy="false" id="S2.SS2.SSS1.p2.5.m1.1.2.3.2.2" xref="S2.SS2.SSS1.p2.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.5.m1.1b"><apply id="S2.SS2.SSS1.p2.5.m1.1.2.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.2"><times id="S2.SS2.SSS1.p2.5.m1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.2.1"></times><ci id="S2.SS2.SSS1.p2.5.m1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.2.2">𝑏</ci><ci id="S2.SS2.SSS1.p2.5.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.5.m1.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.5.m1.1c">b(s)</annotation></semantics></math> is a learned state-dependent baseline function.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Methods</h2>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2205.13697/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="198" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Federated Transformer Q-Function</figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our FedFormer model adapts the SAC algorithm by introducing a contextual federated Q-function (Section <a href="#S2.SS2.SSS1" title="2.2.1. Soft Actor-Critic (SAC) ‣ 2.2. Reinforcement Learning ‣ 2. Background ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2.1</span></a>). Our only core modification from standard Soft Actor-Critic is the usage of double Q-Networks to help model stability <cite class="ltx_cite ltx_citemacro_citep">(Fujimoto
et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.2" class="ltx_p">The overall architecture for our federated Q-function can be seen in Figure <a href="#S3.F1" title="Figure 1 ‣ 3. Methods ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Given a network of <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">N</annotation></semantics></math> agents, we initialize the Q-network of each agent with <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="N-1" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">N</mi><mo id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">−</mo><mn id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><minus id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></minus><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">N-1</annotation></semantics></math> frozen external encoder networks, each representing the other agents, and one local encoder network. We also initialize a local transformer encoder and a final output decoder network. Each encoder network consists of the same infrastructure, with the exception of each external network having gradients disabled.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">The first step during inference is to generate encodings from each encoder network for the same action-observation pair. Following inspiration from BERT, we first encode agent identity through element-wise added learned embeddings according to the encoder network that generated that representation <cite class="ltx_cite ltx_citemacro_citep">(Devlin
et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite> (IdEmbedding). This allows the aggregator network to identify the source of each encoding to potentially aid in learning which agents are known to be more relevant to the current agent. We also include a special <span id="S3.p3.1.1" class="ltx_text ltx_font_typewriter">[CLS]</span> embedding to the input set to encode the global representation of the transformer network. This stage of encodings <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">E</annotation></semantics></math> is thus given as</p>
<table id="A0.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.3" class="ltx_math_unparsed" alttext="\displaystyle E=\{FF_{i}(o,a)+IdEmbedding(i),\forall i\in N,CLSEmbedding\}" display="inline"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3b"><mi id="S3.E7.m1.3.4">E</mi><mo id="S3.E7.m1.3.5">=</mo><mrow id="S3.E7.m1.3.6"><mo stretchy="false" id="S3.E7.m1.3.6.1">{</mo><mi id="S3.E7.m1.3.6.2">F</mi><msub id="S3.E7.m1.3.6.3"><mi id="S3.E7.m1.3.6.3.2">F</mi><mi id="S3.E7.m1.3.6.3.3">i</mi></msub><mrow id="S3.E7.m1.3.6.4"><mo stretchy="false" id="S3.E7.m1.3.6.4.1">(</mo><mi id="S3.E7.m1.1.1">o</mi><mo id="S3.E7.m1.3.6.4.2">,</mo><mi id="S3.E7.m1.2.2">a</mi><mo stretchy="false" id="S3.E7.m1.3.6.4.3">)</mo></mrow><mo id="S3.E7.m1.3.6.5">+</mo><mi id="S3.E7.m1.3.6.6">I</mi><mi id="S3.E7.m1.3.6.7">d</mi><mi id="S3.E7.m1.3.6.8">E</mi><mi id="S3.E7.m1.3.6.9">m</mi><mi id="S3.E7.m1.3.6.10">b</mi><mi id="S3.E7.m1.3.6.11">e</mi><mi id="S3.E7.m1.3.6.12">d</mi><mi id="S3.E7.m1.3.6.13">d</mi><mi id="S3.E7.m1.3.6.14">i</mi><mi id="S3.E7.m1.3.6.15">n</mi><mi id="S3.E7.m1.3.6.16">g</mi><mrow id="S3.E7.m1.3.6.17"><mo stretchy="false" id="S3.E7.m1.3.6.17.1">(</mo><mi id="S3.E7.m1.3.3">i</mi><mo stretchy="false" id="S3.E7.m1.3.6.17.2">)</mo></mrow><mo id="S3.E7.m1.3.6.18">,</mo><mo rspace="0.167em" id="S3.E7.m1.3.6.19">∀</mo><mi id="S3.E7.m1.3.6.20">i</mi><mo id="S3.E7.m1.3.6.21">∈</mo><mi id="S3.E7.m1.3.6.22">N</mi><mo id="S3.E7.m1.3.6.23">,</mo><mi id="S3.E7.m1.3.6.24">C</mi><mi id="S3.E7.m1.3.6.25">L</mi><mi id="S3.E7.m1.3.6.26">S</mi><mi id="S3.E7.m1.3.6.27">E</mi><mi id="S3.E7.m1.3.6.28">m</mi><mi id="S3.E7.m1.3.6.29">b</mi><mi id="S3.E7.m1.3.6.30">e</mi><mi id="S3.E7.m1.3.6.31">d</mi><mi id="S3.E7.m1.3.6.32">d</mi><mi id="S3.E7.m1.3.6.33">i</mi><mi id="S3.E7.m1.3.6.34">n</mi><mi id="S3.E7.m1.3.6.35">g</mi><mo stretchy="false" id="S3.E7.m1.3.6.36">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\displaystyle E=\{FF_{i}(o,a)+IdEmbedding(i),\forall i\in N,CLSEmbedding\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.p3.4" class="ltx_p">where <math id="S3.p3.2.m1.1" class="ltx_Math" alttext="FF_{i}" display="inline"><semantics id="S3.p3.2.m1.1a"><mrow id="S3.p3.2.m1.1.1" xref="S3.p3.2.m1.1.1.cmml"><mi id="S3.p3.2.m1.1.1.2" xref="S3.p3.2.m1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.p3.2.m1.1.1.1" xref="S3.p3.2.m1.1.1.1.cmml">​</mo><msub id="S3.p3.2.m1.1.1.3" xref="S3.p3.2.m1.1.1.3.cmml"><mi id="S3.p3.2.m1.1.1.3.2" xref="S3.p3.2.m1.1.1.3.2.cmml">F</mi><mi id="S3.p3.2.m1.1.1.3.3" xref="S3.p3.2.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m1.1b"><apply id="S3.p3.2.m1.1.1.cmml" xref="S3.p3.2.m1.1.1"><times id="S3.p3.2.m1.1.1.1.cmml" xref="S3.p3.2.m1.1.1.1"></times><ci id="S3.p3.2.m1.1.1.2.cmml" xref="S3.p3.2.m1.1.1.2">𝐹</ci><apply id="S3.p3.2.m1.1.1.3.cmml" xref="S3.p3.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p3.2.m1.1.1.3.1.cmml" xref="S3.p3.2.m1.1.1.3">subscript</csymbol><ci id="S3.p3.2.m1.1.1.3.2.cmml" xref="S3.p3.2.m1.1.1.3.2">𝐹</ci><ci id="S3.p3.2.m1.1.1.3.3.cmml" xref="S3.p3.2.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m1.1c">FF_{i}</annotation></semantics></math> is the encoder network for agent <math id="S3.p3.3.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p3.3.m2.1a"><mi id="S3.p3.3.m2.1.1" xref="S3.p3.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.m2.1b"><ci id="S3.p3.3.m2.1.1.cmml" xref="S3.p3.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m2.1c">i</annotation></semantics></math>. We then feed our set of encodings <math id="S3.p3.4.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p3.4.m3.1a"><mi id="S3.p3.4.m3.1.1" xref="S3.p3.4.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m3.1b"><ci id="S3.p3.4.m3.1.1.cmml" xref="S3.p3.4.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m3.1c">E</annotation></semantics></math> into a transformer encoder network. Given this set of embeddings, each layer of our transformer encoder network computes:</p>
<table id="A0.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle Q=EW_{Q},\leavevmode\nobreak\ K=EW_{K},\leavevmode\nobreak\ V=EW_{V}," display="inline"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1"><mrow id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">Q</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml">Q</mi></msub></mrow></mrow><mo rspace="0.667em" id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.2.2.1.1" xref="S3.E8.m1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2.cmml">K</mi><mo id="S3.E8.m1.1.1.1.1.2.2.1.1.1" xref="S3.E8.m1.1.1.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.1.1.3" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.2.1.1.3.1" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.1.cmml">​</mo><msub id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><mo rspace="0.667em" id="S3.E8.m1.1.1.1.1.2.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2.cmml">V</mi><mo id="S3.E8.m1.1.1.1.1.2.2.2.2.1" xref="S3.E8.m1.1.1.1.1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.2.2.2.2.3.1" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><msub id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">V</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"></eq><ci id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2">𝑄</ci><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><times id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2">𝐸</ci><apply id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3">𝑄</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1"><eq id="S3.E8.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.1"></eq><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2">𝐾</ci><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3"><times id="S3.E8.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.1"></times><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2">𝐸</ci><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2"><eq id="S3.E8.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.1"></eq><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2">𝑉</ci><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3"><times id="S3.E8.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2">𝐸</ci><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3">𝑉</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle Q=EW_{Q},\leavevmode\nobreak\ K=EW_{K},\leavevmode\nobreak\ V=EW_{V},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.2" class="ltx_Math" alttext="\displaystyle Attn(E)=softmax(\frac{QE^{\top}}{\sqrt{d}})V" display="inline"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.3" xref="S3.E9.m1.2.3.cmml"><mrow id="S3.E9.m1.2.3.2" xref="S3.E9.m1.2.3.2.cmml"><mi id="S3.E9.m1.2.3.2.2" xref="S3.E9.m1.2.3.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.2.1" xref="S3.E9.m1.2.3.2.1.cmml">​</mo><mi id="S3.E9.m1.2.3.2.3" xref="S3.E9.m1.2.3.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.2.1a" xref="S3.E9.m1.2.3.2.1.cmml">​</mo><mi id="S3.E9.m1.2.3.2.4" xref="S3.E9.m1.2.3.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.2.1b" xref="S3.E9.m1.2.3.2.1.cmml">​</mo><mi id="S3.E9.m1.2.3.2.5" xref="S3.E9.m1.2.3.2.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.2.1c" xref="S3.E9.m1.2.3.2.1.cmml">​</mo><mrow id="S3.E9.m1.2.3.2.6.2" xref="S3.E9.m1.2.3.2.cmml"><mo stretchy="false" id="S3.E9.m1.2.3.2.6.2.1" xref="S3.E9.m1.2.3.2.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">E</mi><mo stretchy="false" id="S3.E9.m1.2.3.2.6.2.2" xref="S3.E9.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.2.3.1" xref="S3.E9.m1.2.3.1.cmml">=</mo><mrow id="S3.E9.m1.2.3.3" xref="S3.E9.m1.2.3.3.cmml"><mi id="S3.E9.m1.2.3.3.2" xref="S3.E9.m1.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.3.3.3" xref="S3.E9.m1.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1a" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.3.3.4" xref="S3.E9.m1.2.3.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1b" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.3.3.5" xref="S3.E9.m1.2.3.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1c" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.3.3.6" xref="S3.E9.m1.2.3.3.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1d" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.3.3.7" xref="S3.E9.m1.2.3.3.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1e" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.3.3.8" xref="S3.E9.m1.2.3.3.8.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1f" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mrow id="S3.E9.m1.2.3.3.9.2" xref="S3.E9.m1.2.2.cmml"><mo stretchy="false" id="S3.E9.m1.2.3.3.9.2.1" xref="S3.E9.m1.2.2.cmml">(</mo><mstyle displaystyle="true" id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mfrac id="S3.E9.m1.2.2a" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2" xref="S3.E9.m1.2.2.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.1" xref="S3.E9.m1.2.2.2.1.cmml">​</mo><msup id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.2.3.cmml"><mi id="S3.E9.m1.2.2.2.3.2" xref="S3.E9.m1.2.2.2.3.2.cmml">E</mi><mo id="S3.E9.m1.2.2.2.3.3" xref="S3.E9.m1.2.2.2.3.3.cmml">⊤</mo></msup></mrow><msqrt id="S3.E9.m1.2.2.3" xref="S3.E9.m1.2.2.3.cmml"><mi id="S3.E9.m1.2.2.3.2" xref="S3.E9.m1.2.2.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo stretchy="false" id="S3.E9.m1.2.3.3.9.2.2" xref="S3.E9.m1.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.3.3.1g" xref="S3.E9.m1.2.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.3.3.10" xref="S3.E9.m1.2.3.3.10.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.3.cmml" xref="S3.E9.m1.2.3"><eq id="S3.E9.m1.2.3.1.cmml" xref="S3.E9.m1.2.3.1"></eq><apply id="S3.E9.m1.2.3.2.cmml" xref="S3.E9.m1.2.3.2"><times id="S3.E9.m1.2.3.2.1.cmml" xref="S3.E9.m1.2.3.2.1"></times><ci id="S3.E9.m1.2.3.2.2.cmml" xref="S3.E9.m1.2.3.2.2">𝐴</ci><ci id="S3.E9.m1.2.3.2.3.cmml" xref="S3.E9.m1.2.3.2.3">𝑡</ci><ci id="S3.E9.m1.2.3.2.4.cmml" xref="S3.E9.m1.2.3.2.4">𝑡</ci><ci id="S3.E9.m1.2.3.2.5.cmml" xref="S3.E9.m1.2.3.2.5">𝑛</ci><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝐸</ci></apply><apply id="S3.E9.m1.2.3.3.cmml" xref="S3.E9.m1.2.3.3"><times id="S3.E9.m1.2.3.3.1.cmml" xref="S3.E9.m1.2.3.3.1"></times><ci id="S3.E9.m1.2.3.3.2.cmml" xref="S3.E9.m1.2.3.3.2">𝑠</ci><ci id="S3.E9.m1.2.3.3.3.cmml" xref="S3.E9.m1.2.3.3.3">𝑜</ci><ci id="S3.E9.m1.2.3.3.4.cmml" xref="S3.E9.m1.2.3.3.4">𝑓</ci><ci id="S3.E9.m1.2.3.3.5.cmml" xref="S3.E9.m1.2.3.3.5">𝑡</ci><ci id="S3.E9.m1.2.3.3.6.cmml" xref="S3.E9.m1.2.3.3.6">𝑚</ci><ci id="S3.E9.m1.2.3.3.7.cmml" xref="S3.E9.m1.2.3.3.7">𝑎</ci><ci id="S3.E9.m1.2.3.3.8.cmml" xref="S3.E9.m1.2.3.3.8">𝑥</ci><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.3.3.9.2"><divide id="S3.E9.m1.2.2.1.cmml" xref="S3.E9.m1.2.3.3.9.2"></divide><apply id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2"><times id="S3.E9.m1.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.1"></times><ci id="S3.E9.m1.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2">𝑄</ci><apply id="S3.E9.m1.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.3.1.cmml" xref="S3.E9.m1.2.2.2.3">superscript</csymbol><ci id="S3.E9.m1.2.2.2.3.2.cmml" xref="S3.E9.m1.2.2.2.3.2">𝐸</ci><csymbol cd="latexml" id="S3.E9.m1.2.2.2.3.3.cmml" xref="S3.E9.m1.2.2.2.3.3">top</csymbol></apply></apply><apply id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2.3"><root id="S3.E9.m1.2.2.3a.cmml" xref="S3.E9.m1.2.2.3"></root><ci id="S3.E9.m1.2.2.3.2.cmml" xref="S3.E9.m1.2.2.3.2">𝑑</ci></apply></apply><ci id="S3.E9.m1.2.3.3.10.cmml" xref="S3.E9.m1.2.3.3.10">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\displaystyle Attn(E)=softmax(\frac{QE^{\top}}{\sqrt{d}})V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.p3.6" class="ltx_p">where <math id="S3.p3.5.m1.1" class="ltx_Math" alttext="Attn(E)" display="inline"><semantics id="S3.p3.5.m1.1a"><mrow id="S3.p3.5.m1.1.2" xref="S3.p3.5.m1.1.2.cmml"><mi id="S3.p3.5.m1.1.2.2" xref="S3.p3.5.m1.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.p3.5.m1.1.2.1" xref="S3.p3.5.m1.1.2.1.cmml">​</mo><mi id="S3.p3.5.m1.1.2.3" xref="S3.p3.5.m1.1.2.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p3.5.m1.1.2.1a" xref="S3.p3.5.m1.1.2.1.cmml">​</mo><mi id="S3.p3.5.m1.1.2.4" xref="S3.p3.5.m1.1.2.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p3.5.m1.1.2.1b" xref="S3.p3.5.m1.1.2.1.cmml">​</mo><mi id="S3.p3.5.m1.1.2.5" xref="S3.p3.5.m1.1.2.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p3.5.m1.1.2.1c" xref="S3.p3.5.m1.1.2.1.cmml">​</mo><mrow id="S3.p3.5.m1.1.2.6.2" xref="S3.p3.5.m1.1.2.cmml"><mo stretchy="false" id="S3.p3.5.m1.1.2.6.2.1" xref="S3.p3.5.m1.1.2.cmml">(</mo><mi id="S3.p3.5.m1.1.1" xref="S3.p3.5.m1.1.1.cmml">E</mi><mo stretchy="false" id="S3.p3.5.m1.1.2.6.2.2" xref="S3.p3.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m1.1b"><apply id="S3.p3.5.m1.1.2.cmml" xref="S3.p3.5.m1.1.2"><times id="S3.p3.5.m1.1.2.1.cmml" xref="S3.p3.5.m1.1.2.1"></times><ci id="S3.p3.5.m1.1.2.2.cmml" xref="S3.p3.5.m1.1.2.2">𝐴</ci><ci id="S3.p3.5.m1.1.2.3.cmml" xref="S3.p3.5.m1.1.2.3">𝑡</ci><ci id="S3.p3.5.m1.1.2.4.cmml" xref="S3.p3.5.m1.1.2.4">𝑡</ci><ci id="S3.p3.5.m1.1.2.5.cmml" xref="S3.p3.5.m1.1.2.5">𝑛</ci><ci id="S3.p3.5.m1.1.1.cmml" xref="S3.p3.5.m1.1.1">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m1.1c">Attn(E)</annotation></semantics></math> is an attention-weighted representation of E and <math id="S3.p3.6.m2.3" class="ltx_Math" alttext="W_{Q},W_{K},W_{V}" display="inline"><semantics id="S3.p3.6.m2.3a"><mrow id="S3.p3.6.m2.3.3.3" xref="S3.p3.6.m2.3.3.4.cmml"><msub id="S3.p3.6.m2.1.1.1.1" xref="S3.p3.6.m2.1.1.1.1.cmml"><mi id="S3.p3.6.m2.1.1.1.1.2" xref="S3.p3.6.m2.1.1.1.1.2.cmml">W</mi><mi id="S3.p3.6.m2.1.1.1.1.3" xref="S3.p3.6.m2.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.p3.6.m2.3.3.3.4" xref="S3.p3.6.m2.3.3.4.cmml">,</mo><msub id="S3.p3.6.m2.2.2.2.2" xref="S3.p3.6.m2.2.2.2.2.cmml"><mi id="S3.p3.6.m2.2.2.2.2.2" xref="S3.p3.6.m2.2.2.2.2.2.cmml">W</mi><mi id="S3.p3.6.m2.2.2.2.2.3" xref="S3.p3.6.m2.2.2.2.2.3.cmml">K</mi></msub><mo id="S3.p3.6.m2.3.3.3.5" xref="S3.p3.6.m2.3.3.4.cmml">,</mo><msub id="S3.p3.6.m2.3.3.3.3" xref="S3.p3.6.m2.3.3.3.3.cmml"><mi id="S3.p3.6.m2.3.3.3.3.2" xref="S3.p3.6.m2.3.3.3.3.2.cmml">W</mi><mi id="S3.p3.6.m2.3.3.3.3.3" xref="S3.p3.6.m2.3.3.3.3.3.cmml">V</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.m2.3b"><list id="S3.p3.6.m2.3.3.4.cmml" xref="S3.p3.6.m2.3.3.3"><apply id="S3.p3.6.m2.1.1.1.1.cmml" xref="S3.p3.6.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m2.1.1.1.1.1.cmml" xref="S3.p3.6.m2.1.1.1.1">subscript</csymbol><ci id="S3.p3.6.m2.1.1.1.1.2.cmml" xref="S3.p3.6.m2.1.1.1.1.2">𝑊</ci><ci id="S3.p3.6.m2.1.1.1.1.3.cmml" xref="S3.p3.6.m2.1.1.1.1.3">𝑄</ci></apply><apply id="S3.p3.6.m2.2.2.2.2.cmml" xref="S3.p3.6.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.6.m2.2.2.2.2.1.cmml" xref="S3.p3.6.m2.2.2.2.2">subscript</csymbol><ci id="S3.p3.6.m2.2.2.2.2.2.cmml" xref="S3.p3.6.m2.2.2.2.2.2">𝑊</ci><ci id="S3.p3.6.m2.2.2.2.2.3.cmml" xref="S3.p3.6.m2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.p3.6.m2.3.3.3.3.cmml" xref="S3.p3.6.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.p3.6.m2.3.3.3.3.1.cmml" xref="S3.p3.6.m2.3.3.3.3">subscript</csymbol><ci id="S3.p3.6.m2.3.3.3.3.2.cmml" xref="S3.p3.6.m2.3.3.3.3.2">𝑊</ci><ci id="S3.p3.6.m2.3.3.3.3.3.cmml" xref="S3.p3.6.m2.3.3.3.3.3">𝑉</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m2.3c">W_{Q},W_{K},W_{V}</annotation></semantics></math> are all learnable weight matrices representing the Query, Key and Value embeddings of the input. In our work, we utilize a two-layer transformer encoder architecture, but this can be tuned in future work.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.3" class="ltx_p">After aggregating each representation through our transformer encoder, we concatenate the transformed encoding of the <span id="S3.p4.3.1" class="ltx_text ltx_font_typewriter">[CLS]</span> token (<math id="S3.p4.1.m1.1" class="ltx_Math" alttext="e_{[CLS]}" display="inline"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.2" xref="S3.p4.1.m1.1.2.cmml"><mi id="S3.p4.1.m1.1.2.2" xref="S3.p4.1.m1.1.2.2.cmml">e</mi><mrow id="S3.p4.1.m1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p4.1.m1.1.1.1.1.2" xref="S3.p4.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.p4.1.m1.1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.1.1.1.2" xref="S3.p4.1.m1.1.1.1.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1.1.1.1" xref="S3.p4.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.1.1.1.3" xref="S3.p4.1.m1.1.1.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.1.1.1.1a" xref="S3.p4.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.1.1.1.4" xref="S3.p4.1.m1.1.1.1.1.1.4.cmml">S</mi></mrow><mo stretchy="false" id="S3.p4.1.m1.1.1.1.1.3" xref="S3.p4.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.2.cmml" xref="S3.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.2.1.cmml" xref="S3.p4.1.m1.1.2">subscript</csymbol><ci id="S3.p4.1.m1.1.2.2.cmml" xref="S3.p4.1.m1.1.2.2">𝑒</ci><apply id="S3.p4.1.m1.1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.p4.1.m1.1.1.1.2.1.cmml" xref="S3.p4.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.p4.1.m1.1.1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1"><times id="S3.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1.1.1.1"></times><ci id="S3.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.1.1.1.2">𝐶</ci><ci id="S3.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.1.1.1.3">𝐿</ci><ci id="S3.p4.1.m1.1.1.1.1.1.4.cmml" xref="S3.p4.1.m1.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">e_{[CLS]}</annotation></semantics></math>) with the local encoder representation <math id="S3.p4.2.m2.3" class="ltx_Math" alttext="FF_{l}((o,a))" display="inline"><semantics id="S3.p4.2.m2.3a"><mrow id="S3.p4.2.m2.3.3" xref="S3.p4.2.m2.3.3.cmml"><mi id="S3.p4.2.m2.3.3.3" xref="S3.p4.2.m2.3.3.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.3.3.2" xref="S3.p4.2.m2.3.3.2.cmml">​</mo><msub id="S3.p4.2.m2.3.3.4" xref="S3.p4.2.m2.3.3.4.cmml"><mi id="S3.p4.2.m2.3.3.4.2" xref="S3.p4.2.m2.3.3.4.2.cmml">F</mi><mi id="S3.p4.2.m2.3.3.4.3" xref="S3.p4.2.m2.3.3.4.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.p4.2.m2.3.3.2a" xref="S3.p4.2.m2.3.3.2.cmml">​</mo><mrow id="S3.p4.2.m2.3.3.1.1" xref="S3.p4.2.m2.3.3.cmml"><mo stretchy="false" id="S3.p4.2.m2.3.3.1.1.2" xref="S3.p4.2.m2.3.3.cmml">(</mo><mrow id="S3.p4.2.m2.3.3.1.1.1.2" xref="S3.p4.2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.p4.2.m2.3.3.1.1.1.2.1" xref="S3.p4.2.m2.3.3.1.1.1.1.cmml">(</mo><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">o</mi><mo id="S3.p4.2.m2.3.3.1.1.1.2.2" xref="S3.p4.2.m2.3.3.1.1.1.1.cmml">,</mo><mi id="S3.p4.2.m2.2.2" xref="S3.p4.2.m2.2.2.cmml">a</mi><mo stretchy="false" id="S3.p4.2.m2.3.3.1.1.1.2.3" xref="S3.p4.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.p4.2.m2.3.3.1.1.3" xref="S3.p4.2.m2.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.3b"><apply id="S3.p4.2.m2.3.3.cmml" xref="S3.p4.2.m2.3.3"><times id="S3.p4.2.m2.3.3.2.cmml" xref="S3.p4.2.m2.3.3.2"></times><ci id="S3.p4.2.m2.3.3.3.cmml" xref="S3.p4.2.m2.3.3.3">𝐹</ci><apply id="S3.p4.2.m2.3.3.4.cmml" xref="S3.p4.2.m2.3.3.4"><csymbol cd="ambiguous" id="S3.p4.2.m2.3.3.4.1.cmml" xref="S3.p4.2.m2.3.3.4">subscript</csymbol><ci id="S3.p4.2.m2.3.3.4.2.cmml" xref="S3.p4.2.m2.3.3.4.2">𝐹</ci><ci id="S3.p4.2.m2.3.3.4.3.cmml" xref="S3.p4.2.m2.3.3.4.3">𝑙</ci></apply><interval closure="open" id="S3.p4.2.m2.3.3.1.1.1.1.cmml" xref="S3.p4.2.m2.3.3.1.1.1.2"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝑜</ci><ci id="S3.p4.2.m2.2.2.cmml" xref="S3.p4.2.m2.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.3c">FF_{l}((o,a))</annotation></semantics></math> into a final decoder network, predicting the Q-value for that action-observation pair for agent <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.3.m3.1a"><mi id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><ci id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">i</annotation></semantics></math>. This is given as:</p>
<table id="A0.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.7" class="ltx_Math" alttext="\displaystyle Q_{i}(o,a)=FF_{d}(e(\texttt{[CLS]}),FF_{local}(o,a))" display="inline"><semantics id="S3.E10.m1.7a"><mrow id="S3.E10.m1.7.7" xref="S3.E10.m1.7.7.cmml"><mrow id="S3.E10.m1.7.7.4" xref="S3.E10.m1.7.7.4.cmml"><msub id="S3.E10.m1.7.7.4.2" xref="S3.E10.m1.7.7.4.2.cmml"><mi id="S3.E10.m1.7.7.4.2.2" xref="S3.E10.m1.7.7.4.2.2.cmml">Q</mi><mi id="S3.E10.m1.7.7.4.2.3" xref="S3.E10.m1.7.7.4.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.4.1" xref="S3.E10.m1.7.7.4.1.cmml">​</mo><mrow id="S3.E10.m1.7.7.4.3.2" xref="S3.E10.m1.7.7.4.3.1.cmml"><mo stretchy="false" id="S3.E10.m1.7.7.4.3.2.1" xref="S3.E10.m1.7.7.4.3.1.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">o</mi><mo id="S3.E10.m1.7.7.4.3.2.2" xref="S3.E10.m1.7.7.4.3.1.cmml">,</mo><mi id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml">a</mi><mo stretchy="false" id="S3.E10.m1.7.7.4.3.2.3" xref="S3.E10.m1.7.7.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.7.7.3" xref="S3.E10.m1.7.7.3.cmml">=</mo><mrow id="S3.E10.m1.7.7.2" xref="S3.E10.m1.7.7.2.cmml"><mi id="S3.E10.m1.7.7.2.4" xref="S3.E10.m1.7.7.2.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.3" xref="S3.E10.m1.7.7.2.3.cmml">​</mo><msub id="S3.E10.m1.7.7.2.5" xref="S3.E10.m1.7.7.2.5.cmml"><mi id="S3.E10.m1.7.7.2.5.2" xref="S3.E10.m1.7.7.2.5.2.cmml">F</mi><mi id="S3.E10.m1.7.7.2.5.3" xref="S3.E10.m1.7.7.2.5.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.3a" xref="S3.E10.m1.7.7.2.3.cmml">​</mo><mrow id="S3.E10.m1.7.7.2.2.2" xref="S3.E10.m1.7.7.2.2.3.cmml"><mo stretchy="false" id="S3.E10.m1.7.7.2.2.2.3" xref="S3.E10.m1.7.7.2.2.3.cmml">(</mo><mrow id="S3.E10.m1.6.6.1.1.1.1" xref="S3.E10.m1.6.6.1.1.1.1.cmml"><mi id="S3.E10.m1.6.6.1.1.1.1.2" xref="S3.E10.m1.6.6.1.1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.6.6.1.1.1.1.1" xref="S3.E10.m1.6.6.1.1.1.1.1.cmml">​</mo><mrow id="S3.E10.m1.6.6.1.1.1.1.3.2" xref="S3.E10.m1.3.3a.cmml"><mo stretchy="false" id="S3.E10.m1.6.6.1.1.1.1.3.2.1" xref="S3.E10.m1.3.3a.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml">[CLS]</mtext><mo stretchy="false" id="S3.E10.m1.6.6.1.1.1.1.3.2.2" xref="S3.E10.m1.3.3a.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.7.7.2.2.2.4" xref="S3.E10.m1.7.7.2.2.3.cmml">,</mo><mrow id="S3.E10.m1.7.7.2.2.2.2" xref="S3.E10.m1.7.7.2.2.2.2.cmml"><mi id="S3.E10.m1.7.7.2.2.2.2.2" xref="S3.E10.m1.7.7.2.2.2.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.2.2.2.1" xref="S3.E10.m1.7.7.2.2.2.2.1.cmml">​</mo><msub id="S3.E10.m1.7.7.2.2.2.2.3" xref="S3.E10.m1.7.7.2.2.2.2.3.cmml"><mi id="S3.E10.m1.7.7.2.2.2.2.3.2" xref="S3.E10.m1.7.7.2.2.2.2.3.2.cmml">F</mi><mrow id="S3.E10.m1.7.7.2.2.2.2.3.3" xref="S3.E10.m1.7.7.2.2.2.2.3.3.cmml"><mi id="S3.E10.m1.7.7.2.2.2.2.3.3.2" xref="S3.E10.m1.7.7.2.2.2.2.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.2.2.2.3.3.1" xref="S3.E10.m1.7.7.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.7.7.2.2.2.2.3.3.3" xref="S3.E10.m1.7.7.2.2.2.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.2.2.2.3.3.1a" xref="S3.E10.m1.7.7.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.7.7.2.2.2.2.3.3.4" xref="S3.E10.m1.7.7.2.2.2.2.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.2.2.2.3.3.1b" xref="S3.E10.m1.7.7.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.7.7.2.2.2.2.3.3.5" xref="S3.E10.m1.7.7.2.2.2.2.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.2.2.2.3.3.1c" xref="S3.E10.m1.7.7.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.7.7.2.2.2.2.3.3.6" xref="S3.E10.m1.7.7.2.2.2.2.3.3.6.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.7.7.2.2.2.2.1a" xref="S3.E10.m1.7.7.2.2.2.2.1.cmml">​</mo><mrow id="S3.E10.m1.7.7.2.2.2.2.4.2" xref="S3.E10.m1.7.7.2.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E10.m1.7.7.2.2.2.2.4.2.1" xref="S3.E10.m1.7.7.2.2.2.2.4.1.cmml">(</mo><mi id="S3.E10.m1.4.4" xref="S3.E10.m1.4.4.cmml">o</mi><mo id="S3.E10.m1.7.7.2.2.2.2.4.2.2" xref="S3.E10.m1.7.7.2.2.2.2.4.1.cmml">,</mo><mi id="S3.E10.m1.5.5" xref="S3.E10.m1.5.5.cmml">a</mi><mo stretchy="false" id="S3.E10.m1.7.7.2.2.2.2.4.2.3" xref="S3.E10.m1.7.7.2.2.2.2.4.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E10.m1.7.7.2.2.2.5" xref="S3.E10.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.7b"><apply id="S3.E10.m1.7.7.cmml" xref="S3.E10.m1.7.7"><eq id="S3.E10.m1.7.7.3.cmml" xref="S3.E10.m1.7.7.3"></eq><apply id="S3.E10.m1.7.7.4.cmml" xref="S3.E10.m1.7.7.4"><times id="S3.E10.m1.7.7.4.1.cmml" xref="S3.E10.m1.7.7.4.1"></times><apply id="S3.E10.m1.7.7.4.2.cmml" xref="S3.E10.m1.7.7.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.4.2.1.cmml" xref="S3.E10.m1.7.7.4.2">subscript</csymbol><ci id="S3.E10.m1.7.7.4.2.2.cmml" xref="S3.E10.m1.7.7.4.2.2">𝑄</ci><ci id="S3.E10.m1.7.7.4.2.3.cmml" xref="S3.E10.m1.7.7.4.2.3">𝑖</ci></apply><interval closure="open" id="S3.E10.m1.7.7.4.3.1.cmml" xref="S3.E10.m1.7.7.4.3.2"><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝑜</ci><ci id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2">𝑎</ci></interval></apply><apply id="S3.E10.m1.7.7.2.cmml" xref="S3.E10.m1.7.7.2"><times id="S3.E10.m1.7.7.2.3.cmml" xref="S3.E10.m1.7.7.2.3"></times><ci id="S3.E10.m1.7.7.2.4.cmml" xref="S3.E10.m1.7.7.2.4">𝐹</ci><apply id="S3.E10.m1.7.7.2.5.cmml" xref="S3.E10.m1.7.7.2.5"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.2.5.1.cmml" xref="S3.E10.m1.7.7.2.5">subscript</csymbol><ci id="S3.E10.m1.7.7.2.5.2.cmml" xref="S3.E10.m1.7.7.2.5.2">𝐹</ci><ci id="S3.E10.m1.7.7.2.5.3.cmml" xref="S3.E10.m1.7.7.2.5.3">𝑑</ci></apply><interval closure="open" id="S3.E10.m1.7.7.2.2.3.cmml" xref="S3.E10.m1.7.7.2.2.2"><apply id="S3.E10.m1.6.6.1.1.1.1.cmml" xref="S3.E10.m1.6.6.1.1.1.1"><times id="S3.E10.m1.6.6.1.1.1.1.1.cmml" xref="S3.E10.m1.6.6.1.1.1.1.1"></times><ci id="S3.E10.m1.6.6.1.1.1.1.2.cmml" xref="S3.E10.m1.6.6.1.1.1.1.2">𝑒</ci><ci id="S3.E10.m1.3.3a.cmml" xref="S3.E10.m1.6.6.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3">[CLS]</mtext></ci></apply><apply id="S3.E10.m1.7.7.2.2.2.2.cmml" xref="S3.E10.m1.7.7.2.2.2.2"><times id="S3.E10.m1.7.7.2.2.2.2.1.cmml" xref="S3.E10.m1.7.7.2.2.2.2.1"></times><ci id="S3.E10.m1.7.7.2.2.2.2.2.cmml" xref="S3.E10.m1.7.7.2.2.2.2.2">𝐹</ci><apply id="S3.E10.m1.7.7.2.2.2.2.3.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.2.2.2.2.3.1.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3">subscript</csymbol><ci id="S3.E10.m1.7.7.2.2.2.2.3.2.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.2">𝐹</ci><apply id="S3.E10.m1.7.7.2.2.2.2.3.3.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.3"><times id="S3.E10.m1.7.7.2.2.2.2.3.3.1.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.3.1"></times><ci id="S3.E10.m1.7.7.2.2.2.2.3.3.2.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.3.2">𝑙</ci><ci id="S3.E10.m1.7.7.2.2.2.2.3.3.3.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.3.3">𝑜</ci><ci id="S3.E10.m1.7.7.2.2.2.2.3.3.4.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.3.4">𝑐</ci><ci id="S3.E10.m1.7.7.2.2.2.2.3.3.5.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.3.5">𝑎</ci><ci id="S3.E10.m1.7.7.2.2.2.2.3.3.6.cmml" xref="S3.E10.m1.7.7.2.2.2.2.3.3.6">𝑙</ci></apply></apply><interval closure="open" id="S3.E10.m1.7.7.2.2.2.2.4.1.cmml" xref="S3.E10.m1.7.7.2.2.2.2.4.2"><ci id="S3.E10.m1.4.4.cmml" xref="S3.E10.m1.4.4">𝑜</ci><ci id="S3.E10.m1.5.5.cmml" xref="S3.E10.m1.5.5">𝑎</ci></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.7c">\displaystyle Q_{i}(o,a)=FF_{d}(e(\texttt{[CLS]}),FF_{local}(o,a))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.1" class="ltx_p">Since each agent has its own transformer encoder network that is trained according to the agent’s own local loss function, the <span id="S3.p5.1.1" class="ltx_text ltx_font_typewriter">[CLS]</span> encoding is therefore trained to be a global representation relevant to the task of that agent. During back-propagation, we fine-tune end-to-end apart from the external encoder networks.</p>
</div>
<div id="S3.p6" class="ltx_para">
<p id="S3.p6.1" class="ltx_p">At the end of every epoch, the frozen external networks are updated with the local encoder networks from the other agents. Since each agent needs only to transmit the weights of its local encoder network to the other agents, network bandwidth is increased compared to a FedAvg-based strategy, but not proportionally due to the increase in model complexity. In practice, network bandwidth is kept negligible due to the small size of local encoder networks. For our experiments, each agent was required to upload 1.8MB and download <math id="S3.p6.1.m1.1" class="ltx_Math" alttext="1.8\text{MB}\times N-1" display="inline"><semantics id="S3.p6.1.m1.1a"><mrow id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml"><mrow id="S3.p6.1.m1.1.1.2" xref="S3.p6.1.m1.1.1.2.cmml"><mrow id="S3.p6.1.m1.1.1.2.2" xref="S3.p6.1.m1.1.1.2.2.cmml"><mn id="S3.p6.1.m1.1.1.2.2.2" xref="S3.p6.1.m1.1.1.2.2.2.cmml">1.8</mn><mo lspace="0em" rspace="0em" id="S3.p6.1.m1.1.1.2.2.1" xref="S3.p6.1.m1.1.1.2.2.1.cmml">​</mo><mtext id="S3.p6.1.m1.1.1.2.2.3" xref="S3.p6.1.m1.1.1.2.2.3a.cmml">MB</mtext></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.p6.1.m1.1.1.2.1" xref="S3.p6.1.m1.1.1.2.1.cmml">×</mo><mi id="S3.p6.1.m1.1.1.2.3" xref="S3.p6.1.m1.1.1.2.3.cmml">N</mi></mrow><mo id="S3.p6.1.m1.1.1.1" xref="S3.p6.1.m1.1.1.1.cmml">−</mo><mn id="S3.p6.1.m1.1.1.3" xref="S3.p6.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><apply id="S3.p6.1.m1.1.1.cmml" xref="S3.p6.1.m1.1.1"><minus id="S3.p6.1.m1.1.1.1.cmml" xref="S3.p6.1.m1.1.1.1"></minus><apply id="S3.p6.1.m1.1.1.2.cmml" xref="S3.p6.1.m1.1.1.2"><times id="S3.p6.1.m1.1.1.2.1.cmml" xref="S3.p6.1.m1.1.1.2.1"></times><apply id="S3.p6.1.m1.1.1.2.2.cmml" xref="S3.p6.1.m1.1.1.2.2"><times id="S3.p6.1.m1.1.1.2.2.1.cmml" xref="S3.p6.1.m1.1.1.2.2.1"></times><cn type="float" id="S3.p6.1.m1.1.1.2.2.2.cmml" xref="S3.p6.1.m1.1.1.2.2.2">1.8</cn><ci id="S3.p6.1.m1.1.1.2.2.3a.cmml" xref="S3.p6.1.m1.1.1.2.2.3"><mtext id="S3.p6.1.m1.1.1.2.2.3.cmml" xref="S3.p6.1.m1.1.1.2.2.3">MB</mtext></ci></apply><ci id="S3.p6.1.m1.1.1.2.3.cmml" xref="S3.p6.1.m1.1.1.2.3">𝑁</ci></apply><cn type="integer" id="S3.p6.1.m1.1.1.3.cmml" xref="S3.p6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.1c">1.8\text{MB}\times N-1</annotation></semantics></math>, which is negligible under modern networks. In addition, we only replace the encoders in the Q-function, not the target Q-function, as the target Q-function is eventually replaced by the Q-function regardless as part of Soft Actor-Critic <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja
et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S3.p7" class="ltx_para">
<p id="S3.p7.1" class="ltx_p">An interesting aspect of our architecture is the ease of agent onboarding, the process by which agents are introduced into the federation network. Since transformer networks can scale to a variety of input sizes, onboarding new agents consist of simply adding a new encoder network to the set of external encoder networks. This is significantly different from FedAvg, which could introduce untrained noise into other networks through parameter averaging.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Results</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Design</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">To evaluate FedFormer, we utilize the Meta-World benchmark <cite class="ltx_cite ltx_citemacro_citep">(Yu et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>, which includes a set of robotic manipulation tasks, each able to be parameterized with random variables. As a result, we can initialize a wide variety of diverse heterogeneous environments while maintaining the same task, a challenge for traditional FedAvg methods. For this work, we evaluate our methods on a set of seven tasks that concern operating a robotic arm to push buttons, open and close windows, doors, and drawers as well as reach specific destinations, among other complex tasks. <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>While the Meta-World benchmark can assess how well a meta-learning agent improves over a collection of tasks, we instead evaluate how well our solution performs on each of the several different tasks individually.</span></span></span></p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We compare our solution against Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">McMahan et al<span class="ltx_text">.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>, Weighted FedAvg (FedWeightedAvg) as implemented in <cite class="ltx_cite ltx_citemacro_citet">Chu
et al<span class="ltx_text">.</span> (<a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> and non-federated Soft Actor-Critic (SAC) <cite class="ltx_cite ltx_citemacro_cite">Haarnoja
et al<span class="ltx_text">.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite>. As discussed in Section <a href="#S2" title="2. Background ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, recent advances in federated reinforcement learning are grounded in federated averaging with many domain-specific adjustments. Therefore, we focus our evaluation on comparing underlying federation strategies as our method can behave as a direct replacement for FedAvg. We also compare our methods against SAC to measure performance degradation by preserving privacy in a federated setting. Our experiments against SAC are trained on a centralized set of environments used by the federation methods. It is important to note that performance degradation is expected due to the restrictions of privacy preservation. As such, matching or exceeding non-federated methods is an extremely difficult benchmark and is often referred to as an upper limit for federated learning <cite class="ltx_cite ltx_citemacro_citep">(Qi
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">In each experiment, we follow the same hyper-parameters as proposed for SAC in the Meta-World paper <cite class="ltx_cite ltx_citemacro_cite">Yu et al<span class="ltx_text">.</span> (<a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>, with the exception that we train for 250 epochs with 600 training iterations during each epoch due to computing limitations. We utilize a batch size of 1200 steps and keep a replay buffer of size <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="10^{6}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msup id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">10</mn><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">6</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">10</cn><cn type="integer" id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">10^{6}</annotation></semantics></math>. Each agent comprising the evaluated federation strategies learns from a set of five sampled environment configurations and is tested on a different set of five sampled environments. As such, each agent has access to a small constrained set of heterogeneous environments. Both federation strategies (FedAvg and our FedFormer) have five participating agents unless otherwise stated. For non-federated SAC, the single agent learns from the set of all sampled environments: 25 environments for training and 25 environments for testing. To ensure the robustness of our experiments, we utilize ten random seeds for each method and average the results with error bars reflecting standard error, represented as shaded areas in the figures.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Hyperparameters Used</figcaption>
<table id="S4.T1.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.6.7.1" class="ltx_tr">
<th id="S4.T1.6.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r"><span id="S4.T1.6.7.1.1.1" class="ltx_text ltx_font_bold">Parameter</span></th>
<th id="S4.T1.6.7.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="S4.T1.6.7.1.2.1" class="ltx_text ltx_font_bold">Value</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.6.8.1" class="ltx_tr">
<th id="S4.T1.6.8.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt">Batch Size</th>
<td id="S4.T1.6.8.1.2" class="ltx_td ltx_align_left ltx_border_tt">1200</td>
</tr>
<tr id="S4.T1.6.9.2" class="ltx_tr">
<th id="S4.T1.6.9.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Number of Epochs</th>
<td id="S4.T1.6.9.2.2" class="ltx_td ltx_align_left">250</td>
</tr>
<tr id="S4.T1.6.10.3" class="ltx_tr">
<th id="S4.T1.6.10.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Path Length</th>
<td id="S4.T1.6.10.3.2" class="ltx_td ltx_align_left">500</td>
</tr>
<tr id="S4.T1.6.11.4" class="ltx_tr">
<th id="S4.T1.6.11.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Gradient Steps per Epoch</th>
<td id="S4.T1.6.11.4.2" class="ltx_td ltx_align_left">600</td>
</tr>
<tr id="S4.T1.6.12.5" class="ltx_tr">
<th id="S4.T1.6.12.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Discount Factor</th>
<td id="S4.T1.6.12.5.2" class="ltx_td ltx_align_left">0.99</td>
</tr>
<tr id="S4.T1.6.13.6" class="ltx_tr">
<th id="S4.T1.6.13.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Optimizer</th>
<td id="S4.T1.6.13.6.2" class="ltx_td ltx_align_left">Adam</td>
</tr>
<tr id="S4.T1.6.14.7" class="ltx_tr">
<th id="S4.T1.6.14.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Policy Hidden Sizes</th>
<td id="S4.T1.6.14.7.2" class="ltx_td ltx_align_left">(256, 256, 256)</td>
</tr>
<tr id="S4.T1.6.15.8" class="ltx_tr">
<th id="S4.T1.6.15.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Policy Activation Function</th>
<td id="S4.T1.6.15.8.2" class="ltx_td ltx_align_left">ReLU</td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Policy Learning Rate</th>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_left"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="3\times 10^{-4}" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mn id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.T1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.m1.1.1.1.cmml">×</mo><msup id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml"><mn id="S4.T1.1.1.1.m1.1.1.3.2" xref="S4.T1.1.1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.T1.1.1.1.m1.1.1.3.3" xref="S4.T1.1.1.1.m1.1.1.3.3.cmml"><mo id="S4.T1.1.1.1.m1.1.1.3.3a" xref="S4.T1.1.1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.T1.1.1.1.m1.1.1.3.3.2" xref="S4.T1.1.1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><times id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1"></times><cn type="integer" id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">3</cn><apply id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T1.1.1.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S4.T1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T1.1.1.1.m1.1.1.3.2">10</cn><apply id="S4.T1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3.3"><minus id="S4.T1.1.1.1.m1.1.1.3.3.1.cmml" xref="S4.T1.1.1.1.m1.1.1.3.3"></minus><cn type="integer" id="S4.T1.1.1.1.m1.1.1.3.3.2.cmml" xref="S4.T1.1.1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">3\times 10^{-4}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<th id="S4.T1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Policy Minimum Standard Deviation</th>
<td id="S4.T1.2.2.1" class="ltx_td ltx_align_left"><math id="S4.T1.2.2.1.m1.1" class="ltx_Math" alttext="e^{-20}" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><msup id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml"><mi id="S4.T1.2.2.1.m1.1.1.2" xref="S4.T1.2.2.1.m1.1.1.2.cmml">e</mi><mrow id="S4.T1.2.2.1.m1.1.1.3" xref="S4.T1.2.2.1.m1.1.1.3.cmml"><mo id="S4.T1.2.2.1.m1.1.1.3a" xref="S4.T1.2.2.1.m1.1.1.3.cmml">−</mo><mn id="S4.T1.2.2.1.m1.1.1.3.2" xref="S4.T1.2.2.1.m1.1.1.3.2.cmml">20</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">superscript</csymbol><ci id="S4.T1.2.2.1.m1.1.1.2.cmml" xref="S4.T1.2.2.1.m1.1.1.2">𝑒</ci><apply id="S4.T1.2.2.1.m1.1.1.3.cmml" xref="S4.T1.2.2.1.m1.1.1.3"><minus id="S4.T1.2.2.1.m1.1.1.3.1.cmml" xref="S4.T1.2.2.1.m1.1.1.3"></minus><cn type="integer" id="S4.T1.2.2.1.m1.1.1.3.2.cmml" xref="S4.T1.2.2.1.m1.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">e^{-20}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<th id="S4.T1.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Policy Maximum Standard Deviation</th>
<td id="S4.T1.3.3.1" class="ltx_td ltx_align_left"><math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="e^{2}" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><msup id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml"><mi id="S4.T1.3.3.1.m1.1.1.2" xref="S4.T1.3.3.1.m1.1.1.2.cmml">e</mi><mn id="S4.T1.3.3.1.m1.1.1.3" xref="S4.T1.3.3.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><apply id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.3.3.1.m1.1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">superscript</csymbol><ci id="S4.T1.3.3.1.m1.1.1.2.cmml" xref="S4.T1.3.3.1.m1.1.1.2">𝑒</ci><cn type="integer" id="S4.T1.3.3.1.m1.1.1.3.cmml" xref="S4.T1.3.3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">e^{2}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.4.4" class="ltx_tr">
<th id="S4.T1.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Soft Target Interpolation</th>
<td id="S4.T1.4.4.1" class="ltx_td ltx_align_left"><math id="S4.T1.4.4.1.m1.1" class="ltx_Math" alttext="5\times 10^{-3}" display="inline"><semantics id="S4.T1.4.4.1.m1.1a"><mrow id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml"><mn id="S4.T1.4.4.1.m1.1.1.2" xref="S4.T1.4.4.1.m1.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S4.T1.4.4.1.m1.1.1.1" xref="S4.T1.4.4.1.m1.1.1.1.cmml">×</mo><msup id="S4.T1.4.4.1.m1.1.1.3" xref="S4.T1.4.4.1.m1.1.1.3.cmml"><mn id="S4.T1.4.4.1.m1.1.1.3.2" xref="S4.T1.4.4.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.T1.4.4.1.m1.1.1.3.3" xref="S4.T1.4.4.1.m1.1.1.3.3.cmml"><mo id="S4.T1.4.4.1.m1.1.1.3.3a" xref="S4.T1.4.4.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.T1.4.4.1.m1.1.1.3.3.2" xref="S4.T1.4.4.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><apply id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1"><times id="S4.T1.4.4.1.m1.1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1.1"></times><cn type="integer" id="S4.T1.4.4.1.m1.1.1.2.cmml" xref="S4.T1.4.4.1.m1.1.1.2">5</cn><apply id="S4.T1.4.4.1.m1.1.1.3.cmml" xref="S4.T1.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.4.4.1.m1.1.1.3.1.cmml" xref="S4.T1.4.4.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S4.T1.4.4.1.m1.1.1.3.2.cmml" xref="S4.T1.4.4.1.m1.1.1.3.2">10</cn><apply id="S4.T1.4.4.1.m1.1.1.3.3.cmml" xref="S4.T1.4.4.1.m1.1.1.3.3"><minus id="S4.T1.4.4.1.m1.1.1.3.3.1.cmml" xref="S4.T1.4.4.1.m1.1.1.3.3"></minus><cn type="integer" id="S4.T1.4.4.1.m1.1.1.3.3.2.cmml" xref="S4.T1.4.4.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">5\times 10^{-3}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.6.16.9" class="ltx_tr">
<th id="S4.T1.6.16.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Use Automatic Entropy Tuning</th>
<td id="S4.T1.6.16.9.2" class="ltx_td ltx_align_left">True</td>
</tr>
<tr id="S4.T1.6.17.10" class="ltx_tr">
<th id="S4.T1.6.17.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FedFormer</th>
<td id="S4.T1.6.17.10.2" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T1.6.18.11" class="ltx_tr">
<th id="S4.T1.6.18.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Transformer Layers</th>
<td id="S4.T1.6.18.11.2" class="ltx_td ltx_align_left ltx_border_t">2</td>
</tr>
<tr id="S4.T1.6.19.12" class="ltx_tr">
<th id="S4.T1.6.19.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Transformer Heads</th>
<td id="S4.T1.6.19.12.2" class="ltx_td ltx_align_left">4</td>
</tr>
<tr id="S4.T1.6.20.13" class="ltx_tr">
<th id="S4.T1.6.20.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Transformer Hidden Sizes</th>
<td id="S4.T1.6.20.13.2" class="ltx_td ltx_align_left">256</td>
</tr>
<tr id="S4.T1.6.21.14" class="ltx_tr">
<th id="S4.T1.6.21.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Encoder Hidden Size</th>
<td id="S4.T1.6.21.14.2" class="ltx_td ltx_align_left">(256, 256, 256)</td>
</tr>
<tr id="S4.T1.6.22.15" class="ltx_tr">
<th id="S4.T1.6.22.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Decoder Hidden Size</th>
<td id="S4.T1.6.22.15.2" class="ltx_td ltx_align_left">(256, 256, 256)</td>
</tr>
<tr id="S4.T1.6.23.16" class="ltx_tr">
<th id="S4.T1.6.23.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Batch Normalization</th>
<td id="S4.T1.6.23.16.2" class="ltx_td ltx_align_left">True</td>
</tr>
<tr id="S4.T1.6.24.17" class="ltx_tr">
<th id="S4.T1.6.24.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Activation Function</th>
<td id="S4.T1.6.24.17.2" class="ltx_td ltx_align_left">ReLU</td>
</tr>
<tr id="S4.T1.5.5" class="ltx_tr">
<th id="S4.T1.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Q-Function Learning Rate</th>
<td id="S4.T1.5.5.1" class="ltx_td ltx_align_left"><math id="S4.T1.5.5.1.m1.1" class="ltx_Math" alttext="3\times 10^{-4}" display="inline"><semantics id="S4.T1.5.5.1.m1.1a"><mrow id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml"><mn id="S4.T1.5.5.1.m1.1.1.2" xref="S4.T1.5.5.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.T1.5.5.1.m1.1.1.1" xref="S4.T1.5.5.1.m1.1.1.1.cmml">×</mo><msup id="S4.T1.5.5.1.m1.1.1.3" xref="S4.T1.5.5.1.m1.1.1.3.cmml"><mn id="S4.T1.5.5.1.m1.1.1.3.2" xref="S4.T1.5.5.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.T1.5.5.1.m1.1.1.3.3" xref="S4.T1.5.5.1.m1.1.1.3.3.cmml"><mo id="S4.T1.5.5.1.m1.1.1.3.3a" xref="S4.T1.5.5.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.T1.5.5.1.m1.1.1.3.3.2" xref="S4.T1.5.5.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b"><apply id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1"><times id="S4.T1.5.5.1.m1.1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1.1"></times><cn type="integer" id="S4.T1.5.5.1.m1.1.1.2.cmml" xref="S4.T1.5.5.1.m1.1.1.2">3</cn><apply id="S4.T1.5.5.1.m1.1.1.3.cmml" xref="S4.T1.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.5.5.1.m1.1.1.3.1.cmml" xref="S4.T1.5.5.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S4.T1.5.5.1.m1.1.1.3.2.cmml" xref="S4.T1.5.5.1.m1.1.1.3.2">10</cn><apply id="S4.T1.5.5.1.m1.1.1.3.3.cmml" xref="S4.T1.5.5.1.m1.1.1.3.3"><minus id="S4.T1.5.5.1.m1.1.1.3.3.1.cmml" xref="S4.T1.5.5.1.m1.1.1.3.3"></minus><cn type="integer" id="S4.T1.5.5.1.m1.1.1.3.3.2.cmml" xref="S4.T1.5.5.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">3\times 10^{-4}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.6.25.18" class="ltx_tr">
<th id="S4.T1.6.25.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">SAC and FedAvg</th>
<td id="S4.T1.6.25.18.2" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S4.T1.6.26.19" class="ltx_tr">
<th id="S4.T1.6.26.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Hidden Size</th>
<td id="S4.T1.6.26.19.2" class="ltx_td ltx_align_left ltx_border_t">(256, 256, 256)</td>
</tr>
<tr id="S4.T1.6.27.20" class="ltx_tr">
<th id="S4.T1.6.27.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Activation Function</th>
<td id="S4.T1.6.27.20.2" class="ltx_td ltx_align_left">ReLU</td>
</tr>
<tr id="S4.T1.6.6" class="ltx_tr">
<th id="S4.T1.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Q-Function Learning Rate</th>
<td id="S4.T1.6.6.1" class="ltx_td ltx_align_left"><math id="S4.T1.6.6.1.m1.1" class="ltx_Math" alttext="3\times 10^{-4}" display="inline"><semantics id="S4.T1.6.6.1.m1.1a"><mrow id="S4.T1.6.6.1.m1.1.1" xref="S4.T1.6.6.1.m1.1.1.cmml"><mn id="S4.T1.6.6.1.m1.1.1.2" xref="S4.T1.6.6.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.T1.6.6.1.m1.1.1.1" xref="S4.T1.6.6.1.m1.1.1.1.cmml">×</mo><msup id="S4.T1.6.6.1.m1.1.1.3" xref="S4.T1.6.6.1.m1.1.1.3.cmml"><mn id="S4.T1.6.6.1.m1.1.1.3.2" xref="S4.T1.6.6.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.T1.6.6.1.m1.1.1.3.3" xref="S4.T1.6.6.1.m1.1.1.3.3.cmml"><mo id="S4.T1.6.6.1.m1.1.1.3.3a" xref="S4.T1.6.6.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.T1.6.6.1.m1.1.1.3.3.2" xref="S4.T1.6.6.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.1.m1.1b"><apply id="S4.T1.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1"><times id="S4.T1.6.6.1.m1.1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1.1"></times><cn type="integer" id="S4.T1.6.6.1.m1.1.1.2.cmml" xref="S4.T1.6.6.1.m1.1.1.2">3</cn><apply id="S4.T1.6.6.1.m1.1.1.3.cmml" xref="S4.T1.6.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.6.6.1.m1.1.1.3.1.cmml" xref="S4.T1.6.6.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S4.T1.6.6.1.m1.1.1.3.2.cmml" xref="S4.T1.6.6.1.m1.1.1.3.2">10</cn><apply id="S4.T1.6.6.1.m1.1.1.3.3.cmml" xref="S4.T1.6.6.1.m1.1.1.3.3"><minus id="S4.T1.6.6.1.m1.1.1.3.3.1.cmml" xref="S4.T1.6.6.1.m1.1.1.3.3"></minus><cn type="integer" id="S4.T1.6.6.1.m1.1.1.3.3.2.cmml" xref="S4.T1.6.6.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.1.m1.1c">3\times 10^{-4}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">In each experiment, we use a three-layer feed-forward network with two output heads to predict the mean and variance of a tanh distribution over the action space as the policy network. For FedFormer, our Q-network consists of a two-layer transformer model with a hidden size of 400. Each encoder and decoder network consists of a three-layer feed-forward network with each layer having a hidden size of 400 except for the final decoder layer, which consists of a single output unit representing the Q-value. For FedAvg and SAC, the Q-network consists of a three-layer feed-forward network each with a hidden size of 400, apart from the last layer which has a single output unit representing the Q-Value. We include a detailed list of all hyperparameters in Table <a href="#S4.T1" title="Table 1 ‣ 4.1. Experimental Design ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p">To implement our work, we modified an implementation of SAC in RLKit <cite class="ltx_cite ltx_citemacro_citep">(RAIL-Berkeley
and contributors, <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite> with additional modules borrowed from Garage <cite class="ltx_cite ltx_citemacro_citep">(Contributors, <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite> and PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke
et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite>. RLKit and Garage are licensed under the MIT license<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://spdx.org/licenses/MIT.html</span></span></span> and Pytorch is licensed under the BSD-3 ”Revised” license <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://github.com/pytorch/pytorch/blob/master/LICENSE</span></span></span>. Experiments were run in parallel on a computing cluster consisting of RTX 3080, RTX 2080Ti, V100 and P100 GPUs, depending on availability.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Meta-World Evaluation</h3>

<figure id="S4.F2" class="ltx_figure"><img src="/html/2205.13697/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="227" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Performance on Meta-World tasks</figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In the first set of experiments, we compare the performance of FedFormer (blue) against FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> (orange), Weighted FedAvg <cite class="ltx_cite ltx_citemacro_citep">(Chu
et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> (red) and non-Federated SAC <cite class="ltx_cite ltx_citemacro_citep">(Haarnoja
et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite> (green) on seven Meta-World tasks. Figure <a href="#S4.F2" title="Figure 2 ‣ 4.2. Meta-World Evaluation ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the results, where the X-axis represents training epochs and the Y-axis is the average episodic return. Improvements in the X-axis indicate that the agent is able to learn faster, and the Y-axis indicates enhanced performance, where the agent outperforms other agents. Further, separation in standard error (shaded area) between each method indicates improved performance based on 10 evaluated seeds.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">FedFormer outperforms FedAvg and Weighted FedAvg and matches or exceeds the performance of non-federated SAC in all of our evaluated tasks. As demonstrated by the standard error bars, FedFormer demonstrates consistently superior performance to FedAvg across six of the seven evaluated tasks. The only exception is the <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_typewriter">drawer-close</span> task, in which all methods achieved similar returns.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">The performance difference between FedFormer and FedAvg increases as training progresses. At the final epoch, FedFormer achieves 2.17x (<span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_typewriter">door-open</span>), 1.77x (<span id="S4.SS2.p3.1.2" class="ltx_text ltx_font_typewriter">drawer-open</span>), 1.48x (<span id="S4.SS2.p3.1.3" class="ltx_text ltx_font_typewriter">window-close</span>), 2.25x (<span id="S4.SS2.p3.1.4" class="ltx_text ltx_font_typewriter">button-press</span>), 3.41x (<span id="S4.SS2.p3.1.5" class="ltx_text ltx_font_typewriter">reach</span>) and 2.60x (<span id="S4.SS2.p3.1.6" class="ltx_text ltx_font_typewriter">window-open</span>) performance gains over FedAvg. The only task where FedAvg performs comparably to FedFormer is on the <span id="S4.SS2.p3.1.7" class="ltx_text ltx_font_typewriter">drawer-close</span> task. We also see that FedAvg behaves similarly to FedWeightedAvg with the exception of <span id="S4.SS2.p3.1.8" class="ltx_text ltx_font_typewriter">window-close</span>, where FedWeightedAvg achieves much stronger performance.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Notably, increases in effectiveness can be seen in the <span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_typewriter">button-press</span>, <span id="S4.SS2.p4.1.2" class="ltx_text ltx_font_typewriter">drawer-open</span> and <span id="S4.SS2.p4.1.3" class="ltx_text ltx_font_typewriter">door-open</span> tasks, where FedAvg appears to plateau early in performance around epoch 50. This is contrasted by FedFormer, which continues to grow in performance. We hypothesize that this can be attributed to stifled exploration in FedAvg, a key feature of reinforcement learning that differs from traditional machine learning. When an individual agent makes considerable gains in FedAvg, it is forced to average its parameters with those of the other agents, which could be performing much worse. This is overcome by FedFormer, which allows for attentive and selective aggregation between agents according to their learned relevance.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">Most surprising are the results compared to non-federated SAC. In the <span id="S4.SS2.p5.1.1" class="ltx_text ltx_font_typewriter">door-open</span>, <span id="S4.SS2.p5.1.2" class="ltx_text ltx_font_typewriter">reach</span>, <span id="S4.SS2.p5.1.3" class="ltx_text ltx_font_typewriter">window-open</span> and <span id="S4.SS2.p5.1.4" class="ltx_text ltx_font_typewriter">window-close</span> tasks, FedFormer consistently exceeds the performance of SAC at each epoch, robust to standard error. Focusing on the final epoch, we also obtain 1.56x performance gains in the <span id="S4.SS2.p5.1.5" class="ltx_text ltx_font_typewriter">drawer-open</span> task, 1.36x performance gains in the <span id="S4.SS2.p5.1.6" class="ltx_text ltx_font_typewriter">button-press</span> task, and 1.58x performance gains in the <span id="S4.SS2.p5.1.7" class="ltx_text ltx_font_typewriter">window-open</span> task. In each other task, we obtain similar performance to SAC. Recall that SAC agents are centralized and train on the entire set of environments without preserving privacy, whereas FedFormer abides by the privacy constraints of federated learning with a distributed pool of agents. We attribute many of these gains to our transformer aggregation network, which can contextually leverage the individual expertise of agents without forcing a centralized model.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Scalability</h3>

<figure id="S4.F3" class="ltx_figure"><img src="/html/2205.13697/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="227" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Performance when scaling federation methods to 5, 10 and 15 agents</figcaption>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Next, we measure the ability of our method to scale to larger sets of agents. To do this, we compare the results of both federation strategies (FedAvg and our FedFormer) when scaled to 5, 10 and 15 agents (Figure <a href="#S4.F3" title="Figure 3 ‣ 4.3. Scalability ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) <span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Although we evaluate our methods up to 15 agents, we can scale up to 512 agents (or 1024 with sparse variants) due to our usage of transformers</span></span></span>. As was the case in our tests in Section <a href="#S4.SS2" title="4.2. Meta-World Evaluation ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>, each agent is given five sampled environments for training and five sampled environments for testing without replacement. Since Meta-World generates 50 environments per task, some agents will have overlapping tasks for training that will be testing tasks for others, but never in the same agent. It is assumed that including more agents in federated learning should result in more robust models due to the larger availability of training data. However, it is also important to note that the performance reported is the average performance of <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">all</span> agents. Therefore, all agents must perform well in order to achieve a high metric in our results. It is important to note that scaling poses a more difficult problem due to the increased heterogeneity of the environments that each agent is tasked with.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">We find that increasing the number of agents results in better performance in FedFormer and worse performance for FedAvg. Focusing on the final epoch and when utilizing 10 agents, we can see performance improvements of 2.23x (<span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_typewriter">window-close</span>), 2.95x (<span id="S4.SS3.p2.1.2" class="ltx_text ltx_font_typewriter">door-open</span>), 1.47x (<span id="S4.SS3.p2.1.3" class="ltx_text ltx_font_typewriter">drawer-open</span>), 1.83x (<span id="S4.SS3.p2.1.4" class="ltx_text ltx_font_typewriter">reach</span>) and 2.70x (<span id="S4.SS3.p2.1.5" class="ltx_text ltx_font_typewriter">window-open</span>) compared to FedAvg. We see similar gains with 15 agents, where we can see performance improvements of 1.98x (<span id="S4.SS3.p2.1.6" class="ltx_text ltx_font_typewriter">window-close</span>), 2.75x (<span id="S4.SS3.p2.1.7" class="ltx_text ltx_font_typewriter">door-open</span>), 1.62x (<span id="S4.SS3.p2.1.8" class="ltx_text ltx_font_typewriter">drawer-open</span>), and 1.88x (<span id="S4.SS3.p2.1.9" class="ltx_text ltx_font_typewriter">window-open</span>). We also see that FedAvg fails to meaningfully scale above FedAvg (5), with FedAvg (5) and FedAvg (10) performing comparably or worse across all tasks. Many of the results reported are also robust to standard error. We hypothesize the poor performance of FedAvg is due to many agents attempting to explore the environment simultaneously but subsequently being forced into a single representation. In our experimentation, we found FedWeightedAvg to exhibit similar trends as FedAvg with marginal improvements as the number of agents increased.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">As a result, we conclude that our federation strategy can efficiently scale to include multiple agents. This result aligns with previous work in transformer models, which has shown the ability to reason over larger sets of embeddings <cite class="ltx_cite ltx_citemacro_citep">(Devlin
et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Agent Onboarding</h3>

<figure id="S4.F4" class="ltx_figure"><img src="/html/2205.13697/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="281" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Performance of onboarding agents into pre-trained federation networks on the <span id="S4.F4.2.1" class="ltx_text ltx_font_typewriter">window-close</span> task</figcaption>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">In real-life use cases, agents are often introduced at random intervals into federation strategies. When an agent joins an established federation network, the network must adapt to account for the new environments introduced by the new agent. In the case of FedAvg, this can be a significant setback as model averaging can introduce noise into existing converged models when the models originate from heterogeneous environments. In addition, FedAvg can require all agents to restart training to keep up with the modifications of the new agent.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We now evaluate the onboarding strategy of FedFormer, which overcomes all these challenges (Section <a href="#S3" title="3. Methods ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). To do this, we train a FedFormer network on the <span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_typewriter">window-close</span> task and save the resulting converged encoder networks. We then train a single new agent on five never-before-seen environments utilizing the saved encoder networks of the previous agents as the external network set. The main difference here is that we do not update the external networks throughout training by the federation. In our experiments, we evaluate our methods by utilizing the resulting trained networks from each seed of the <span id="S4.SS4.p2.1.2" class="ltx_text ltx_font_typewriter">window-close</span> task. The results for this experiment compared against FedFormer, SAC and FedAvg can be seen in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.4. Agent Onboarding ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p">We see that the onboarded agent (red) drastically benefits from the pre-trained encoder networks. Within the first 60 epochs, the new agent obtains near the equivalent performance of the original FedFormer network after it had trained for 250 epochs, obtaining a <math id="S4.SS4.p3.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S4.SS4.p3.1.m1.1a"><mo id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><approx id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\approx</annotation></semantics></math> 5x efficiency increase. We also obtain 6.5x performance gains over SAC and 11.23x performance gains over FedAvg at epoch 60, demonstrating the increased speed of convergence. In addition, performance continues to improve beyond this point, obtaining a 1.24x increase over FedFormer at epoch 250. It is important to note that this onboarding process was done without any further training from the other agents.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Ablation Study</h3>

<figure id="S4.F5" class="ltx_figure"><img src="/html/2205.13697/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="227" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Scaling Performance when replacing Transformer Network with MLP Network</figcaption>
</figure>
<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">To evaluate the usefulness of attention in our federation network, we have conducted additional experiments replacing the Transformer network in FedFormer with a three-layer non-attention multi-layer perceptron model (FedMLP). To do this, we concatenate the embeddings generated by each of the encoder networks as the input to the MLP. Then, the output layer of the MLP generates an embedding of size 256, matching the dimensionality of the CLS embeddings created by FedFormer. Just like FedFormer, this embedding is then decoded by a local decoder network to generate the respective Q value for that state-action pair (Figure <a href="#S3.F1" title="Figure 1 ‣ 3. Methods ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). This baseline is similar to work by <cite class="ltx_cite ltx_citemacro_citet">Zhuo
et al<span class="ltx_text">.</span> (<a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite>, which proposed concatenating the Q-network embeddings of two agents into a global MLP. Our results when scaling this method from 5, 10 and 15 agents can be seen in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.5. Ablation Study ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, following the procedure outlined in Section <a href="#S4.SS3" title="4.3. Scalability ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>. It is important to note that scaling poses a more difficult problem due to the increased heterogeneity of the environments that each agent is tasked with.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">In each of the tasks evaluated, we see the dominant performance of FedFormer over the FedMLP baseline. This can be most evidently seen in the <span id="S4.SS5.p2.1.1" class="ltx_text ltx_font_typewriter">window-close</span> task, where FedFormer (5) often achieves over 2x the performance of FedMLP (5) across each epoch. It is important to note the large differences between the two methods when scaled to include larger agent pools. The largest difference can again be seen on the <span id="S4.SS5.p2.1.2" class="ltx_text ltx_font_typewriter">window-close</span> task, where the performance of FedMLP drops by 2.4x when scaled to 10 agents and 3.8x when scaled to 15 agents. This is contrasted by FedFormer, where the performance is either maintained or increased with increased agents. These results indicate the importance of the attention mechanism for FedFormer, especially in relation to scalability. With attention, it is possible to contextually select and aggregate the insights of participating agents in relation to the needs of the current agent. This is contrasted by FedMLP, which must aggregate the insights of all agents, including agents that provide irrelevant input. The problem of noisy inputs is then further exacerbated with increased agent counts, as seen in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.5. Ablation Study ‣ 4. Results ‣ FedFormer: Contextual Federation with Attention in Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related Work</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">A similar field to federated reinforcement learning is multi-agent reinforcement learning (MARL). MARL focuses on tasks where multiple agents interact in the same environment and share insights with each other to solve a cooperative or competitive task <cite class="ltx_cite ltx_citemacro_citep">(Stone and Veloso, <a href="#bib.bib29" title="" class="ltx_ref">2000</a>)</cite>. An important challenge with these systems is the non-stationarity of the environment, where each agent has their own perspective on the environment and actions committed by a single agent can affect the environment for another <cite class="ltx_cite ltx_citemacro_citep">(Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>. Therefore, it becomes critical that multiple agents can efficiently share information, similar to federated learning <cite class="ltx_cite ltx_citemacro_citep">(Foerster et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2016</a>; Sukhbaatar
et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2016</a>; Mao
et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2018</a>)</cite>. However, MARL allows for the constant flow of observation information between agents and often uses a centralized model to plan the actions of each agent <cite class="ltx_cite ltx_citemacro_citep">(Mao
et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2018</a>; Han and
Gmytrasiewicz, <a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>, therefore making the methods unsuitable for federated learning.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">One MARL approach related to our work is Multi-Agent-Attention-Critic (MAAC), proposed by <cite class="ltx_cite ltx_citemacro_citet">Iqbal and Sha (<a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>. This method proposed utilizing transformer models to coordinate cooperative agents to solve a collective task. During each timestep, each agent broadcasts their local observation-action pairs to a centralized model. These inputs are then aggregated using a transformer encoder into a set of Q-Values corresponding to each agent, which is then broadcast back to each agent. As a result, each resulting Q-value is created with respect to each other agent’s observations and the model is fine-tuned end-to-end to optimize a joint goal.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">While our approach also utilizes transformer models, there are significant differences, notwithstanding the obvious constraints of privacy. The transformer model in MAAC is used for cooperative learning, where the central model coordinates observation embeddings from many agents towards a shared goal. In our work, each agent has their own decentralized transformer network that is optimized for aggregating embeddings toward that agent’s goal. In addition, the input to each agent is a set of embeddings encoding the same local observation but with different federated encoder networks, whereas MAAC requires observation sharing from each agent during each timestep. We also include elements from natural language processing, such as [CLS] tokens to encode global representations and position encodings <cite class="ltx_cite ltx_citemacro_citep">(Devlin
et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We presented a novel federation strategy based on transformer models, FedFormer. Our technique addresses concerns about utilizing federated learning towards reinforcement learning, which is typically done through the FedAvg method of averaging parameters. Instead, our method utilizes attention to compute contextual relationships between agents without compromising the ability of individual agents to explore the environment.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Our method outperforms FedAvg and single-agent Soft Actor-Critic (SAC), with FedFormer outperforming FedAvg by a factor of 4.4 and SAC by a factor of 1.75. In addition, we demonstrate that FedFormer can effectively scale to more agents, with gains of 2.4x and 3.8x over FedAvg with 10 and 15 agents respectively. This contrasts with FedAvg, which has negligible performance gains and at times performs worse. Lastly, we also demonstrate the ease of agent onboarding in our methods, resulting in 5x convergence speeds by leveraging pre-trained models without sacrificing the performance of other models. All of this is achieved while still abiding by the privacy constraints of federated learning.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">The primary limitation of our work is related to computational latency. Previous work in transformer models states a computational limit of <math id="S6.p3.1.m1.1" class="ltx_Math" alttext="\approx 512" display="inline"><semantics id="S6.p3.1.m1.1a"><mrow id="S6.p3.1.m1.1.1" xref="S6.p3.1.m1.1.1.cmml"><mi id="S6.p3.1.m1.1.1.2" xref="S6.p3.1.m1.1.1.2.cmml"></mi><mo id="S6.p3.1.m1.1.1.1" xref="S6.p3.1.m1.1.1.1.cmml">≈</mo><mn id="S6.p3.1.m1.1.1.3" xref="S6.p3.1.m1.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.1.m1.1b"><apply id="S6.p3.1.m1.1.1.cmml" xref="S6.p3.1.m1.1.1"><approx id="S6.p3.1.m1.1.1.1.cmml" xref="S6.p3.1.m1.1.1.1"></approx><csymbol cd="latexml" id="S6.p3.1.m1.1.1.2.cmml" xref="S6.p3.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S6.p3.1.m1.1.1.3.cmml" xref="S6.p3.1.m1.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.1.m1.1c">\approx 512</annotation></semantics></math> embeddings when computing attention <cite class="ltx_cite ltx_citemacro_cite">Devlin
et al<span class="ltx_text">.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>. This is due to the quadratic increase in latency with additional embeddings. Further, each new agent will add an encoder network to the model. As a result, this limits the number of agents that can participate as part of the federation network. However, this limit can be addressed by utilizing domain-specific agent sampling strategies, such as those explored by <cite class="ltx_cite ltx_citemacro_citet">Ren
et al<span class="ltx_text">.</span> (<a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citet">Wang
et al<span class="ltx_text">.</span> (<a href="#bib.bib35" title="" class="ltx_ref">2020b</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Tehrani
et al<span class="ltx_text">.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">With our advancements with introducing FedFormer, there are several future work directions that could be pursued. First, since our approach does not rely on averaging parameters, it would be interesting to explore the use of deep learning models to represent the encoder networks <cite class="ltx_cite ltx_citemacro_citep">(Mnih et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2013</a>)</cite>. This could potentially allow for the federation to tackle more complicated tasks involving computer vision and partial observability by leveraging deep encoders such as convolutional neural networks and recurrent neural networks. The utilization of these models would have been previously difficult due to instability brought on by parameter averaging <cite class="ltx_cite ltx_citemacro_citep">(Qi
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S6.p5" class="ltx_para">
<p id="S6.p5.1" class="ltx_p">Another interesting direction for future work is to explore related work in supervised heterogeneous federated learning. This area proposes techniques to group and filter agents, including to address tolerance to faults from byzantine agents <cite class="ltx_cite ltx_citemacro_cite">Gao et al<span class="ltx_text">.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2022</a>)</cite>. These techniques support learning from a set of changing heterogeneous environments but often assume that the environments (datasets) of individual agents remain consistent <cite class="ltx_cite ltx_citemacro_cite">Gao et al<span class="ltx_text">.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2022</a>)</cite>. While this is often not the case in federated reinforcement learning, these techniques still present interesting insights to explore. For example, <cite class="ltx_cite ltx_citemacro_citet">Huang
et al<span class="ltx_text">.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> could be adapted to cluster agents based on their Q-values, <cite class="ltx_cite ltx_citemacro_citet">Fang and Ye (<a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> could be repurposed to address the detection of byzantine agents. The work of <cite class="ltx_cite ltx_citemacro_citet">Fan
et al<span class="ltx_text">.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Chen
et al<span class="ltx_text">.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite> will also become relevant. Byzantine filtering layers proposed by <cite class="ltx_cite ltx_citemacro_citet">Fan
et al<span class="ltx_text">.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> could be applied on the input encoder networks; Chen’s insights into theoretical guarantees may inspire us to expand beyond our current experimental validation. Since both <cite class="ltx_cite ltx_citemacro_citet">Fan
et al<span class="ltx_text">.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Chen
et al<span class="ltx_text">.</span> (<a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite> are grounded in FedAvg, using FedFormer instead with these approaches may provide important steps forward.</p>
</div>
<div id="S6.p6" class="ltx_para">
<p id="S6.p6.1" class="ltx_p">Lastly, our work opens the door for advances in existing FedAvg-based architectures. From IoT devices to self-driving cars, we believe that our methods can serve as a direct stand-in for FedAvg to provide better performance. Further evaluation of these tasks with the addition of domain-specific adjustments such as those proposed in previous work <cite class="ltx_cite ltx_citemacro_citep">(Ren
et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2019</a>; Wang
et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2020b</a>; Tehrani
et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2021</a>; Nadiger
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite> would be especially interesting. We hope that our work can be used to improve federated reinforcement learning and introduce advancements in deep learning to this critical field, especially as privacy becomes harder to obtain in favour of performance.</p>
</div>
<div id="S6.p7" class="ltx_para">
<span id="S6.p7.1" class="ltx_ERROR undefined">{acks}</span>
<p id="S6.p7.2" class="ltx_p">The authors thank the Natural Sciences and Engineering Research Council of Canada, the Canada Research Chairs Program, the Vector Institute and the University of Waterloo Cheriton Scholarship for financial support. We are also grateful to the reviewers for their valued feedback on the paper.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bu and Wang (2019)</span>
<span class="ltx_bibblock">
Fanyu Bu and Xin Wang.
2019.

</span>
<span class="ltx_bibblock">A smart agriculture IoT system based on deep
reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>
99 (2019), 500–507.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen
et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Yiding Chen, Xuezhou
Zhang, Kaiqing Zhang, Mengdi Wang, and
Xiaojin Zhu. 2022.

</span>
<span class="ltx_bibblock">Byzantine-Robust Online and Offline Distributed
Reinforcement Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.00165</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chu
et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Yunfei Chu, Zhinong Wei,
Xicheng Fang, Sheng Chen, and
Yizhou Zhou. 2022.

</span>
<span class="ltx_bibblock">A Multiagent Federated Reinforcement Learning
Approach for Plug-In Electric Vehicle Fleet Charging Coordination in a
Residential Community.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">IEEE Access</em> 10
(2022), 98535–98548.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1109/ACCESS.2022.3206020" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/ACCESS.2022.3206020</a>

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Contributors (2019)</span>
<span class="ltx_bibblock">
Garage Contributors.
2019.

</span>
<span class="ltx_bibblock">Garage: A toolkit for reproducible reinforcement
learning research.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin
et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei
Chang, Kenton Lee, and Kristina
Toutanova. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional
Transformers for Language Understanding. In
<em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North
American Chapter of the Association for Computational Linguistics: Human
Language Technologies, Volume 1 (Long and Short Papers)</em>.
Association for Computational Linguistics,
4171–4186.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan
et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiaofeng Fan, Yining Ma,
Zhongxiang Dai, Wei Jing,
Cheston Tan, and Bryan Kian Hsiang
Low. 2021.

</span>
<span class="ltx_bibblock">Fault-tolerant federated reinforcement learning
with theoretical guarantee.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em> 34 (2021),
1007–1021.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang and Ye (2022)</span>
<span class="ltx_bibblock">
Xiuwen Fang and Mang
Ye. 2022.

</span>
<span class="ltx_bibblock">Robust Federated Learning With Noisy and
Heterogeneous Clients. In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>.
10072–10081.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Foerster et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Jakob Foerster,
Ioannis Alexandros Assael, Nando
De Freitas, and Shimon Whiteson.
2016.

</span>
<span class="ltx_bibblock">Learning to communicate with deep multi-agent
reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 29 (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fujimoto
et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Scott Fujimoto, Herke
Hoof, and David Meger. 2018.

</span>
<span class="ltx_bibblock">Addressing function approximation error in
actor-critic methods. In <em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">International conference
on machine learning</em>. PMLR, 1587–1596.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Dashan Gao, Xin Yao,
and Qiang Yang. 2022.

</span>
<span class="ltx_bibblock">A Survey on Heterogeneous Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.04505</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haarnoja
et al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Tuomas Haarnoja, Aurick
Zhou, Pieter Abbeel, and Sergey
Levine. 2018.

</span>
<span class="ltx_bibblock">Soft actor-critic: Off-policy maximum entropy deep
reinforcement learning with a stochastic actor. In
<em id="bib.bib12.3.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>.
PMLR, 1861–1870.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han and
Gmytrasiewicz (2019)</span>
<span class="ltx_bibblock">
Yanlin Han and Piotr
Gmytrasiewicz. 2019.

</span>
<span class="ltx_bibblock">IPOMDP-Net: A Deep Neural Network for Partially
Observable Multi-Agent Planning Using Interactive POMDPs. In
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirty-Third AAAI Conference on
Artificial Intelligence</em>. AAAI Press.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang
et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Wenke Huang, Mang Ye,
and Bo Du. 2022.

</span>
<span class="ltx_bibblock">Learn From Others and Be Yourself in Heterogeneous
Federated Learning. In <em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition (CVPR)</em>.
10143–10153.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Iqbal and Sha (2019)</span>
<span class="ltx_bibblock">
Shariq Iqbal and Fei
Sha. 2019.

</span>
<span class="ltx_bibblock">Actor-attention-critic for multi-agent
reinforcement learning. In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International
Conference on Machine Learning</em>. PMLR, 2961–2970.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konda and
Tsitsiklis (1999)</span>
<span class="ltx_bibblock">
Vijay Konda and John
Tsitsiklis. 1999.

</span>
<span class="ltx_bibblock">Actor-critic algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 12 (1999).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lim
et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Hyun-Kyo Lim, Ju-Bong
Kim, Joo-Seong Heo, and Youn-Hee Han.
2020.

</span>
<span class="ltx_bibblock">Federated Reinforcement Learning for Training
Control Policies on Multiple IoT Devices.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">Sensors</em> 20,
5 (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao
et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Hangyu Mao, Zhengchao
Zhang, Zhen Xiao, and Zhibo Gong.
2018.

</span>
<span class="ltx_bibblock">Modelling the dynamic joint policy of teammates
with attention multi-agent DDPG.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.07029</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Aguera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib19.3.1" class="ltx_emph ltx_font_italic">Artificial
intelligence and statistics</em>. PMLR, 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2013)</span>
<span class="ltx_bibblock">
Volodymyr Mnih, Koray
Kavukcuoglu, David Silver, Alex Graves,
Ioannis Antonoglou, Daan Wierstra, and
Martin Riedmiller. 2013.

</span>
<span class="ltx_bibblock">Playing atari with deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1312.5602</em>
(2013).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohammadi et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Mehdi Mohammadi, Ala
Al-Fuqaha, Mohsen Guizani, and Jun-Seok
Oh. 2017.

</span>
<span class="ltx_bibblock">Semisupervised deep reinforcement learning in
support of IoT and smart city services.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>
5, 2 (2017),
624–635.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nadiger
et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Chetan Nadiger, Anil
Kumar, and Sherine Abdelhak.
2019.

</span>
<span class="ltx_bibblock">Federated reinforcement learning for fast
personalization. In <em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">2019 IEEE Second International
Conference on Artificial Intelligence and Knowledge Engineering (AIKE)</em>.
IEEE, 123–127.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke
et al<span id="bib.bib23.3.3.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross,
Francisco Massa, Adam Lerer,
James Bradbury, Gregory Chanan,
Trevor Killeen, Zeming Lin,
Natalia Gimelshein, Luca Antiga,
et al<span id="bib.bib23.4.1" class="ltx_text">.</span> 2019.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep
learning library.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.5.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 32 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi
et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Jiaju Qi, Qihao Zhou,
Lei Lei, and Kan Zheng.
2021.

</span>
<span class="ltx_bibblock">Federated reinforcement learning: Techniques,
applications, and open challenges.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.11887</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">RAIL-Berkeley
and contributors (2021)</span>
<span class="ltx_bibblock">
RAIL-Berkeley and RLKit
contributors. 2021.

</span>
<span class="ltx_bibblock">RLKit: Reinforcement learning framework and
algorithms implemented in PyTorch.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren
et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Jianji Ren, Haichao Wang,
Tingting Hou, Shuai Zheng, and
Chaosheng Tang. 2019.

</span>
<span class="ltx_bibblock">Federated Learning-Based Computation Offloading
Optimization in Edge Computing-Supported Internet of Things.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">IEEE Access</em> 7
(2019), 69194–69201.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sallab
et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Ahmad EL Sallab, Mohammed
Abdou, Etienne Perot, and Senthil
Yogamani. 2017.

</span>
<span class="ltx_bibblock">Deep Reinforcement Learning framework for
Autonomous Driving.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.3.1" class="ltx_emph ltx_font_italic">Electronic Imaging</em> 29,
19 (2017), 70–76.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shalev-Shwartz et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Shai Shalev-Shwartz,
Shaked Shammah, and Amnon Shashua.
2016.

</span>
<span class="ltx_bibblock">Safe, multi-agent, reinforcement learning for
autonomous driving.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.03295</em>
(2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stone and Veloso (2000)</span>
<span class="ltx_bibblock">
Peter Stone and Manuela
Veloso. 2000.

</span>
<span class="ltx_bibblock">Multiagent systems: A survey from a machine
learning perspective.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Autonomous Robots</em> 8,
3 (2000), 345–383.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar
et al<span id="bib.bib30.3.3.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Rob
Fergus, et al<span id="bib.bib30.4.1" class="ltx_text">.</span> 2016.

</span>
<span class="ltx_bibblock">Learning multiagent communication with
backpropagation.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.5.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 29 (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton
et al<span id="bib.bib31.2.2.1" class="ltx_text">.</span> (1999)</span>
<span class="ltx_bibblock">
Richard S Sutton, David
McAllester, Satinder Singh, and Yishay
Mansour. 1999.

</span>
<span class="ltx_bibblock">Policy gradient methods for reinforcement learning
with function approximation.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.3.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 12 (1999).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tehrani
et al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Peyman Tehrani, Francesco
Restuccia, and Marco Levorato.
2021.

</span>
<span class="ltx_bibblock">Federated Deep Reinforcement Learning for the
Distributed Control of NextG Wireless Networks. In
<em id="bib.bib32.3.1" class="ltx_emph ltx_font_italic">2021 IEEE International Symposium on Dynamic
Spectrum Access Networks (DySPAN)</em>. IEEE, 248–253.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span id="bib.bib33.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam
Shazeer, Niki Parmar, Jakob Uszkoreit,
Llion Jones, Aidan N Gomez,
Łukasz Kaiser, and Illia
Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.3.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang
et al<span id="bib.bib34.2.2.1" class="ltx_text">.</span> (2020a)</span>
<span class="ltx_bibblock">
Xiaofei Wang, Ruibin Li,
Chenyang Wang, Xiuhua Li,
Tarik Taleb, and Victor CM Leung.
2020a.

</span>
<span class="ltx_bibblock">Attention-weighted federated deep reinforcement
learning for device-to-device assisted heterogeneous collaborative edge
caching.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.3.1" class="ltx_emph ltx_font_italic">IEEE Journal on Selected Areas in
Communications</em> 39, 1
(2020), 154–169.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang
et al<span id="bib.bib35.2.2.1" class="ltx_text">.</span> (2020b)</span>
<span class="ltx_bibblock">
Xiaofei Wang, Chenyang
Wang, Xiuhua Li, Victor CM Leung, and
Tarik Taleb. 2020b.

</span>
<span class="ltx_bibblock">Federated deep reinforcement learning for Internet
of Things with decentralized cooperative edge caching.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.3.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>
7, 10 (2020),
9441–9455.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1992)</span>
<span class="ltx_bibblock">
Ronald J Williams.
1992.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms
for connectionist reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Machine Learning</em> 8,
3 (1992), 229–256.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong
et al<span id="bib.bib37.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiong Xiong, Kan Zheng,
Lei Lei, and Lu Hou.
2020.

</span>
<span class="ltx_bibblock">Resource allocation based on deep reinforcement
learning in IoT edge computing.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.3.1" class="ltx_emph ltx_font_italic">IEEE Journal on Selected Areas in
Communications</em> 38, 6
(2020), 1133–1146.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tianhe Yu, Deirdre
Quillen, Zhanpeng He, Ryan Julian,
Karol Hausman, Chelsea Finn, and
Sergey Levine. 2020.

</span>
<span class="ltx_bibblock">Meta-world: A benchmark and evaluation for
multi-task and meta reinforcement learning. In
<em id="bib.bib38.3.1" class="ltx_emph ltx_font_italic">Conference on Robot Learning</em>. PMLR,
1094–1100.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang
et al<span id="bib.bib39.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Kaiqing Zhang, Zhuoran
Yang, and Tamer Başar.
2021.

</span>
<span class="ltx_bibblock">Multi-agent reinforcement learning: A selective
overview of theories and algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.3.1" class="ltx_emph ltx_font_italic">Handbook of Reinforcement Learning and
Control</em> (2021), 321–384.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang
et al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Zixuan Zhang, Yuning
Jiang, Yuanming Shi, Ye Shi, and
Wei Chen. 2022.

</span>
<span class="ltx_bibblock">Federated Reinforcement Learning for Real-Time
Electric Vehicle Charging and Discharging Control. In
<em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">2022 IEEE Globecom Workshops (GC Wkshps)</em>.
1717–1722.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1109/GCWkshps56602.2022.10008598" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/GCWkshps56602.2022.10008598</a>

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuo
et al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Hankz Hankui Zhuo, Wenfeng
Feng, Yufeng Lin, Qian Xu, and
Qiang Yang. 2019.

</span>
<span class="ltx_bibblock">Federated deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.08277</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2205.13696" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2205.13697" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2205.13697">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2205.13697" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2205.13698" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 13:00:16 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
