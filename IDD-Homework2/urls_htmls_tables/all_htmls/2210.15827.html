<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2210.15827] Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author.</title><meta property="og:description" content="In contrast to centralized model training that involves data collection, federated learning (FL) enables remote clients to collaboratively train a model without exposing their private data. However, model performance u…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author.">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author.">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2210.15827">

<!--Generated on Thu Mar 14 01:53:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
Federated Learning with 
<br class="ltx_break">Intermediate Representation Regularization
<span id="id1.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author.</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ye Lin Tun, Chu Myaet Thwal, Yu Min Park, Seong-Bae Park, Choong Seon Hong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id2.1.id1" class="ltx_text ltx_font_italic">Department of Computer Science and Engineering</span>
<br class="ltx_break"><span id="id3.2.id2" class="ltx_text ltx_font_italic">Kyung Hee University
<br class="ltx_break"></span>Yongin-si, Republic of Korea 
<br class="ltx_break">{yelintun, chumyaet, yumin0906, sbpark71, cshong}@khu.ac.kr
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">In contrast to centralized model training that involves data collection, federated learning (FL) enables remote clients to collaboratively train a model without exposing their private data. However, model performance usually degrades in FL due to the heterogeneous data generated by clients of diverse characteristics. One promising strategy to maintain good performance is by limiting the local training from drifting far away from the global model. Previous studies accomplish this by regularizing the distance between the representations learned by the local and global models. However, they only consider representations from the early layers of a model or the layer preceding the output layer. In this study, we introduce FedIntR, which provides a more fine-grained regularization by integrating the representations of intermediate layers into the local training process. Specifically, FedIntR computes a regularization term that encourages the closeness between the intermediate layer representations of the local and global models. Additionally, FedIntR automatically determines the contribution of each layer’s representation to the regularization term based on the similarity between local and global representations. We conduct extensive experiments on various datasets to show that FedIntR can achieve equivalent or higher performance compared to the state-of-the-art approaches. Our code is available at <a target="_blank" href="https://github.com/YLTun/FedIntR" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="color:#1FFAA3;">https://github.com/YLTun/FedIntR</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
<span id="id5.id1" class="ltx_text ltx_font_italic">federated learning; representation; data heterogeneity; distributed</span>

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The real world data essential for powering intelligent services is spread across numerous edge devices (e.g., IoT devices, personal smartphones, or data silos of different organizations). Although deep learning can benefit from large datasets produced by mass collection, rising security concerns and privacy regulations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> may prohibit a server from acquiring the data from edge devices. Such limitations may render the centralized training of deep neural network models infeasible. Federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, which allows edge devices to collaboratively train a model without sharing their data with a central server, has come to light as a viable option to meet these requirements. In particular, the FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> algorithm has emerged as the de facto approach for model training in distributed environments with data privacy concerns. FedAvg operates by having each edge device train a local model on its own data before sending the trained parameters to the server. The server aggregates the received parameters into a single global model that inherits the trained capabilities of the local models.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2210.15827/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="453" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An Overview of federated learning with FedIntR. FedIntR incorporates regularization into the local training step (i.e., step2) of FedAvg.</figcaption>
</figure>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2210.15827/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="170" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Local loss computation in FedIntR. Using the intermediate representations <math id="S1.F2.6.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S1.F2.6.m1.1b"><mi id="S1.F2.6.m1.1.1" xref="S1.F2.6.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S1.F2.6.m1.1c"><ci id="S1.F2.6.m1.1.1.cmml" xref="S1.F2.6.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.m1.1d">z</annotation></semantics></math> from the local model <math id="S1.F2.7.m2.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="S1.F2.7.m2.1b"><msubsup id="S1.F2.7.m2.1.1" xref="S1.F2.7.m2.1.1.cmml"><mi id="S1.F2.7.m2.1.1.2.2" xref="S1.F2.7.m2.1.1.2.2.cmml">w</mi><mi id="S1.F2.7.m2.1.1.2.3" xref="S1.F2.7.m2.1.1.2.3.cmml">i</mi><mi id="S1.F2.7.m2.1.1.3" xref="S1.F2.7.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.F2.7.m2.1c"><apply id="S1.F2.7.m2.1.1.cmml" xref="S1.F2.7.m2.1.1"><csymbol cd="ambiguous" id="S1.F2.7.m2.1.1.1.cmml" xref="S1.F2.7.m2.1.1">superscript</csymbol><apply id="S1.F2.7.m2.1.1.2.cmml" xref="S1.F2.7.m2.1.1"><csymbol cd="ambiguous" id="S1.F2.7.m2.1.1.2.1.cmml" xref="S1.F2.7.m2.1.1">subscript</csymbol><ci id="S1.F2.7.m2.1.1.2.2.cmml" xref="S1.F2.7.m2.1.1.2.2">𝑤</ci><ci id="S1.F2.7.m2.1.1.2.3.cmml" xref="S1.F2.7.m2.1.1.2.3">𝑖</ci></apply><ci id="S1.F2.7.m2.1.1.3.cmml" xref="S1.F2.7.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.7.m2.1d">w_{i}^{t}</annotation></semantics></math>, global model <math id="S1.F2.8.m3.1" class="ltx_Math" alttext="w_{g}^{t}" display="inline"><semantics id="S1.F2.8.m3.1b"><msubsup id="S1.F2.8.m3.1.1" xref="S1.F2.8.m3.1.1.cmml"><mi id="S1.F2.8.m3.1.1.2.2" xref="S1.F2.8.m3.1.1.2.2.cmml">w</mi><mi id="S1.F2.8.m3.1.1.2.3" xref="S1.F2.8.m3.1.1.2.3.cmml">g</mi><mi id="S1.F2.8.m3.1.1.3" xref="S1.F2.8.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.F2.8.m3.1c"><apply id="S1.F2.8.m3.1.1.cmml" xref="S1.F2.8.m3.1.1"><csymbol cd="ambiguous" id="S1.F2.8.m3.1.1.1.cmml" xref="S1.F2.8.m3.1.1">superscript</csymbol><apply id="S1.F2.8.m3.1.1.2.cmml" xref="S1.F2.8.m3.1.1"><csymbol cd="ambiguous" id="S1.F2.8.m3.1.1.2.1.cmml" xref="S1.F2.8.m3.1.1">subscript</csymbol><ci id="S1.F2.8.m3.1.1.2.2.cmml" xref="S1.F2.8.m3.1.1.2.2">𝑤</ci><ci id="S1.F2.8.m3.1.1.2.3.cmml" xref="S1.F2.8.m3.1.1.2.3">𝑔</ci></apply><ci id="S1.F2.8.m3.1.1.3.cmml" xref="S1.F2.8.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.8.m3.1d">w_{g}^{t}</annotation></semantics></math> and old local model <math id="S1.F2.9.m4.1" class="ltx_Math" alttext="w_{i}^{t-1}" display="inline"><semantics id="S1.F2.9.m4.1b"><msubsup id="S1.F2.9.m4.1.1" xref="S1.F2.9.m4.1.1.cmml"><mi id="S1.F2.9.m4.1.1.2.2" xref="S1.F2.9.m4.1.1.2.2.cmml">w</mi><mi id="S1.F2.9.m4.1.1.2.3" xref="S1.F2.9.m4.1.1.2.3.cmml">i</mi><mrow id="S1.F2.9.m4.1.1.3" xref="S1.F2.9.m4.1.1.3.cmml"><mi id="S1.F2.9.m4.1.1.3.2" xref="S1.F2.9.m4.1.1.3.2.cmml">t</mi><mo id="S1.F2.9.m4.1.1.3.1" xref="S1.F2.9.m4.1.1.3.1.cmml">−</mo><mn id="S1.F2.9.m4.1.1.3.3" xref="S1.F2.9.m4.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S1.F2.9.m4.1c"><apply id="S1.F2.9.m4.1.1.cmml" xref="S1.F2.9.m4.1.1"><csymbol cd="ambiguous" id="S1.F2.9.m4.1.1.1.cmml" xref="S1.F2.9.m4.1.1">superscript</csymbol><apply id="S1.F2.9.m4.1.1.2.cmml" xref="S1.F2.9.m4.1.1"><csymbol cd="ambiguous" id="S1.F2.9.m4.1.1.2.1.cmml" xref="S1.F2.9.m4.1.1">subscript</csymbol><ci id="S1.F2.9.m4.1.1.2.2.cmml" xref="S1.F2.9.m4.1.1.2.2">𝑤</ci><ci id="S1.F2.9.m4.1.1.2.3.cmml" xref="S1.F2.9.m4.1.1.2.3">𝑖</ci></apply><apply id="S1.F2.9.m4.1.1.3.cmml" xref="S1.F2.9.m4.1.1.3"><minus id="S1.F2.9.m4.1.1.3.1.cmml" xref="S1.F2.9.m4.1.1.3.1"></minus><ci id="S1.F2.9.m4.1.1.3.2.cmml" xref="S1.F2.9.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S1.F2.9.m4.1.1.3.3.cmml" xref="S1.F2.9.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.9.m4.1d">w_{i}^{t-1}</annotation></semantics></math>, FedIntR computes a regularization term. Together, this regularization term and the cross entropy loss <math id="S1.F2.10.m5.1" class="ltx_Math" alttext="\ell_{sup}" display="inline"><semantics id="S1.F2.10.m5.1b"><msub id="S1.F2.10.m5.1.1" xref="S1.F2.10.m5.1.1.cmml"><mi mathvariant="normal" id="S1.F2.10.m5.1.1.2" xref="S1.F2.10.m5.1.1.2.cmml">ℓ</mi><mrow id="S1.F2.10.m5.1.1.3" xref="S1.F2.10.m5.1.1.3.cmml"><mi id="S1.F2.10.m5.1.1.3.2" xref="S1.F2.10.m5.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S1.F2.10.m5.1.1.3.1" xref="S1.F2.10.m5.1.1.3.1.cmml">​</mo><mi id="S1.F2.10.m5.1.1.3.3" xref="S1.F2.10.m5.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S1.F2.10.m5.1.1.3.1b" xref="S1.F2.10.m5.1.1.3.1.cmml">​</mo><mi id="S1.F2.10.m5.1.1.3.4" xref="S1.F2.10.m5.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F2.10.m5.1c"><apply id="S1.F2.10.m5.1.1.cmml" xref="S1.F2.10.m5.1.1"><csymbol cd="ambiguous" id="S1.F2.10.m5.1.1.1.cmml" xref="S1.F2.10.m5.1.1">subscript</csymbol><ci id="S1.F2.10.m5.1.1.2.cmml" xref="S1.F2.10.m5.1.1.2">ℓ</ci><apply id="S1.F2.10.m5.1.1.3.cmml" xref="S1.F2.10.m5.1.1.3"><times id="S1.F2.10.m5.1.1.3.1.cmml" xref="S1.F2.10.m5.1.1.3.1"></times><ci id="S1.F2.10.m5.1.1.3.2.cmml" xref="S1.F2.10.m5.1.1.3.2">𝑠</ci><ci id="S1.F2.10.m5.1.1.3.3.cmml" xref="S1.F2.10.m5.1.1.3.3">𝑢</ci><ci id="S1.F2.10.m5.1.1.3.4.cmml" xref="S1.F2.10.m5.1.1.3.4">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.10.m5.1d">\ell_{sup}</annotation></semantics></math> make up the local training loss.
</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In practice, large data heterogeneity may arise in an FL system since the local data on each device varies depending on the nature and behavior of the device. Heterogeneous data has been found to be a major issue that causes slow convergence and suboptimal model performance in federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. To address this, previous studies have incorporated various forms of regularization into the local training loss to reduce the divergence of local models from the global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The distance between local and global parameters can be limited using <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S1.p2.1.m1.1a"><msub id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml">ℓ</mi><mn id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1">subscript</csymbol><ci id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S1.p2.1.m1.1.1.3.cmml" xref="S1.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\ell_{2}</annotation></semantics></math>-norm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> or control variates <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. A recent popular approach is to use representations such as MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and FedCKA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, which adopt contrastive loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> to promote the closeness between local and global representations. However, these studies only focus on a few specific layers of the model to extract the representations. In particular, MOON extracts representations from the layer prior to the output layer, whereas FedCKA extracts from the first two layers based on the assumption that naturally similar layers are the most critical to improving the performance. Nevertheless, we argue that utilizing representations from all intermediate layers while assigning a proper weight to each of their contributions can offer a more fine-grained regularization to the training process.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Hence, we explore the idea of using representations extracted from intermediate layers to overcome the performance degradation caused by non-IID data in FL. We propose <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">FedIntR</span>, which promotes the similarity between <span id="S1.p3.1.2" class="ltx_text ltx_font_bold">Int</span>ermediate layer <span id="S1.p3.1.3" class="ltx_text ltx_font_bold">R</span>epresentations the of local and global models. Specifically, FedIntR computes a regularization term based on the contrastive loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> using local and global intermediate representations. Moreover, FedIntR automatically calculates layer-wise weights to determine each intermediate layer’s contribution to the regularization term. Analogous to the idea of FedCKA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, where similar layers are more important for improving the performance, FedIntR assigns a larger contribution weight to the layers with a higher global and local representation similarity. To demonstrate the effectiveness of FedIntR, we conduct extensive experiments in comparison with various state-of-the-art FL approaches. Moreover, we evaluate FedIntR in different FL settings with varying degrees of data heterogeneity, numbers of clients, and local training epochs to ensure that it can maintain good performance in these scenarios.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Background and Related Work</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.6" class="ltx_p">The FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> algorithm is the first federated learning framework that enables collaborative model training while preserving the privacy of user devices. Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> depicts the overview of a typical FL framework, which consists of four key steps at each training round <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">t</annotation></semantics></math>: (i) the central server distributes the global model <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="w_{g}^{t}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><msubsup id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.2.2.cmml">w</mi><mi id="S2.SS1.p1.2.m2.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.2.3.cmml">g</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2.2">𝑤</ci><ci id="S2.SS1.p1.2.m2.1.1.2.3.cmml" xref="S2.SS1.p1.2.m2.1.1.2.3">𝑔</ci></apply><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">w_{g}^{t}</annotation></semantics></math> to the clients; (ii) each client <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">i</annotation></semantics></math> trains its local model <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msubsup id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2.2" xref="S2.SS1.p1.4.m4.1.1.2.2.cmml">w</mi><mi id="S2.SS1.p1.4.m4.1.1.2.3" xref="S2.SS1.p1.4.m4.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2.2">𝑤</ci><ci id="S2.SS1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS1.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">w_{i}^{t}</annotation></semantics></math> on its private data <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝒟</ci><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathcal{D}_{i}</annotation></semantics></math>; (iii) the trained local models are returned to the server; and (iv) the server aggregates the received local models into an updated global model <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="w_{g}^{t+1}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msubsup id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2.2" xref="S2.SS1.p1.6.m6.1.1.2.2.cmml">w</mi><mi id="S2.SS1.p1.6.m6.1.1.2.3" xref="S2.SS1.p1.6.m6.1.1.2.3.cmml">g</mi><mrow id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.3.2" xref="S2.SS1.p1.6.m6.1.1.3.2.cmml">t</mi><mo id="S2.SS1.p1.6.m6.1.1.3.1" xref="S2.SS1.p1.6.m6.1.1.3.1.cmml">+</mo><mn id="S2.SS1.p1.6.m6.1.1.3.3" xref="S2.SS1.p1.6.m6.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">superscript</csymbol><apply id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2.2">𝑤</ci><ci id="S2.SS1.p1.6.m6.1.1.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.2.3">𝑔</ci></apply><apply id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3"><plus id="S2.SS1.p1.6.m6.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.1.1.3.1"></plus><ci id="S2.SS1.p1.6.m6.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.1.1.3.2">𝑡</ci><cn type="integer" id="S2.SS1.p1.6.m6.1.1.3.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">w_{g}^{t+1}</annotation></semantics></math>. FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> also highlights the non-IID characteristics of an FL environment, and since then, improving the performance of an FL model under such constraints has been the subject of many studies.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Tackling Data Heterogeneity</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Many FL studies rely on three distinct strategies for mitigating the performance degradation caused by heterogeneous data: (i) adding regularization to the local training, (ii) modifying the aggregation scheme, and (iii) fitting personalized models for the clients. We discuss each of these strategies as follows.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p"><span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_bold">Local Training.</span> FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> includes a proximal term in the local training objective in order to restrict the Euclidean distance between the local and global models. MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> introduces model-contrastive loss which is inspired by the NT-Xent (Normalized Temperature-scaled Cross Entropy) loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> used in SimCLR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> for self-supervised representation learning. The NT-Xent loss is designed to minimize the distance between the representations of a positive pair (i.e., augmented views of the same sample) and maximize the distance between the representations of negative pairs (i.e., augmented views from different samples). Model-contrastive loss in MOON aims to minimize the distance between representations extracted by the global and local models while simultaneously maximizing the distance between representations from the current local model and the old local model. MOON is based on the idea that, since the global model has been trained on the entire dataset, its representations can effectively regularize the local training. SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> lowers the client-variance in the local updates by minimizing the difference between the local and global control variates. Similar to MOON, FedCKA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> uses global and local model representations to regularize the local training and shows that using deeper layers for regularization can harm the performance. Centered kernel alignment (CKA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> is used in FedCKA to calculate the distance between the representations, whereas MOON employs cosine similarity.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.1" class="ltx_p"><span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_bold">Aggregation.</span> Another way to combat the downsides of data heterogeneity is to design a more intelligent aggregation scheme. PFNM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> relies on Bayesian nonparametric methods to match the neurons of different client models before the aggregation process. However, PFNM only works with fully connected neural networks. Therefore, FedMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> proposes to match in a layer-wise fashion, which is applicable for CNN and LSTM models as well. Inspired by the effectiveness of SGD momentum in dampening gradient oscillations, FedAvgM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> incorporates momentum in the aggregation process. FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> takes into account the varying number of local update steps completed by the clients and normalizes the local update by the number of steps prior to aggregation. pFedLA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> generates personalized models by using hypernetworks to determine the layer-wise contribution of each client model to the aggregation step.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.1" class="ltx_p"><span id="S2.SS2.p4.1.1" class="ltx_text ltx_font_bold">Personalized Federated Learning.</span> Personalized models can improve the performance in non-IID settings by fitting the diverse distributions of the clients’ data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. One simple and effective personalized FL mechanism is to group clients with similar characteristics into clusters, and cluster members can collectively train a personalized model. Many approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> cluster the clients based on the similarity of local updates received at the server. Others <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> perform clustering on the client-side, where each client can choose their own personalized model from a set of available models based on performance.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.1" class="ltx_p">Our proposed method, FedIntR, is one of the techniques that incorporates regularization into the local training process. A recent study <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> demonstrates that self-supervised learning with additional loss across intermediate layers can enhance the model’s performance in the downstream tasks. Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, we explore the integration of intermediate representations into the FL process to enable a more effective regularization for data heterogeneity issues. In contrast to our approach, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> only uses the representations from the layer preceding the output layer, and FedCKA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> is based on the idea of minimizing the distance between similar layer representations and, therefore, only considers the early layers (the first two layers) of the model. FedIntR can also be considered a more general approach where we don’t have to manually define which layers to include in the regularization term since it automatically determines the contribution of different intermediate layers to the regularization based on the similarities between their local and global representations.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedIntR</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input:</span> number of training rounds <math id="alg1.l1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">T</annotation></semantics></math>, number of local epochs <math id="alg1.l1.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">E</annotation></semantics></math>, number of clients <math id="alg1.l1.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">N</annotation></semantics></math>, number of intermediate layers <math id="alg1.l1.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">K</annotation></semantics></math>, temperature <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\tau</annotation></semantics></math>, learning rate <math id="alg1.l1.m6.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">\eta</annotation></semantics></math>, weighting parameter <math id="alg1.l1.m7.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg1.l1.m7.1a"><mi id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><ci id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">\mu</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text ltx_font_bold">Output:</span> global model <math id="alg1.l2.m1.1" class="ltx_Math" alttext="w^{T}_{g}" display="inline"><semantics id="alg1.l2.m1.1a"><msubsup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">g</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝑤</ci><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝑇</ci></apply><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">w^{T}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text ltx_font_bold">Server executes:</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>initialize <math id="alg1.l5.m1.1" class="ltx_Math" alttext="w^{0}_{g}" display="inline"><semantics id="alg1.l5.m1.1a"><msubsup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">g</mi><mn id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑤</ci><cn type="integer" id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">0</cn></apply><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">w^{0}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l6.m1.4" class="ltx_Math" alttext="t=0,1,\dots,T-1" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mi id="alg1.l6.m1.4.4.3" xref="alg1.l6.m1.4.4.3.cmml">t</mi><mo id="alg1.l6.m1.4.4.2" xref="alg1.l6.m1.4.4.2.cmml">=</mo><mrow id="alg1.l6.m1.4.4.1.1" xref="alg1.l6.m1.4.4.1.2.cmml"><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">0</mn><mo id="alg1.l6.m1.4.4.1.1.2" xref="alg1.l6.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">1</mn><mo id="alg1.l6.m1.4.4.1.1.3" xref="alg1.l6.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">…</mi><mo id="alg1.l6.m1.4.4.1.1.4" xref="alg1.l6.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l6.m1.4.4.1.1.1" xref="alg1.l6.m1.4.4.1.1.1.cmml"><mi id="alg1.l6.m1.4.4.1.1.1.2" xref="alg1.l6.m1.4.4.1.1.1.2.cmml">T</mi><mo id="alg1.l6.m1.4.4.1.1.1.1" xref="alg1.l6.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l6.m1.4.4.1.1.1.3" xref="alg1.l6.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><eq id="alg1.l6.m1.4.4.2.cmml" xref="alg1.l6.m1.4.4.2"></eq><ci id="alg1.l6.m1.4.4.3.cmml" xref="alg1.l6.m1.4.4.3">𝑡</ci><list id="alg1.l6.m1.4.4.1.2.cmml" xref="alg1.l6.m1.4.4.1.1"><cn type="integer" id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">0</cn><cn type="integer" id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">1</cn><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">…</ci><apply id="alg1.l6.m1.4.4.1.1.1.cmml" xref="alg1.l6.m1.4.4.1.1.1"><minus id="alg1.l6.m1.4.4.1.1.1.1.cmml" xref="alg1.l6.m1.4.4.1.1.1.1"></minus><ci id="alg1.l6.m1.4.4.1.1.1.2.cmml" xref="alg1.l6.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l6.m1.4.4.1.1.1.3.cmml" xref="alg1.l6.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">t=0,1,\dots,T-1</annotation></semantics></math> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l7.m1.4" class="ltx_Math" alttext="i=1,2,\dots,N" display="inline"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4.5" xref="alg1.l7.m1.4.5.cmml"><mi id="alg1.l7.m1.4.5.2" xref="alg1.l7.m1.4.5.2.cmml">i</mi><mo id="alg1.l7.m1.4.5.1" xref="alg1.l7.m1.4.5.1.cmml">=</mo><mrow id="alg1.l7.m1.4.5.3.2" xref="alg1.l7.m1.4.5.3.1.cmml"><mn id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">1</mn><mo id="alg1.l7.m1.4.5.3.2.1" xref="alg1.l7.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">2</mn><mo id="alg1.l7.m1.4.5.3.2.2" xref="alg1.l7.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">…</mi><mo id="alg1.l7.m1.4.5.3.2.3" xref="alg1.l7.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.4b"><apply id="alg1.l7.m1.4.5.cmml" xref="alg1.l7.m1.4.5"><eq id="alg1.l7.m1.4.5.1.cmml" xref="alg1.l7.m1.4.5.1"></eq><ci id="alg1.l7.m1.4.5.2.cmml" xref="alg1.l7.m1.4.5.2">𝑖</ci><list id="alg1.l7.m1.4.5.3.1.cmml" xref="alg1.l7.m1.4.5.3.2"><cn type="integer" id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">1</cn><cn type="integer" id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">2</cn><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">…</ci><ci id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">i=1,2,\dots,N</annotation></semantics></math> in parallel <span id="alg1.l7.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>         <math id="alg1.l8.m1.2" class="ltx_Math" alttext="w^{t}_{i}\leftarrow\text{LocalUpdate}(i,w^{t}_{g})" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><msubsup id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.3.2.2" xref="alg1.l8.m1.2.2.3.2.2.cmml">w</mi><mi id="alg1.l8.m1.2.2.3.3" xref="alg1.l8.m1.2.2.3.3.cmml">i</mi><mi id="alg1.l8.m1.2.2.3.2.3" xref="alg1.l8.m1.2.2.3.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml">←</mo><mrow id="alg1.l8.m1.2.2.1" xref="alg1.l8.m1.2.2.1.cmml"><mtext id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.2.2.1.3a.cmml">LocalUpdate</mtext><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.1.2" xref="alg1.l8.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l8.m1.2.2.1.1.1" xref="alg1.l8.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.2" xref="alg1.l8.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">i</mi><mo id="alg1.l8.m1.2.2.1.1.1.3" xref="alg1.l8.m1.2.2.1.1.2.cmml">,</mo><msubsup id="alg1.l8.m1.2.2.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l8.m1.2.2.1.1.1.1.2.2" xref="alg1.l8.m1.2.2.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l8.m1.2.2.1.1.1.1.3" xref="alg1.l8.m1.2.2.1.1.1.1.3.cmml">g</mi><mi id="alg1.l8.m1.2.2.1.1.1.1.2.3" xref="alg1.l8.m1.2.2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.1.4" xref="alg1.l8.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><ci id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2">←</ci><apply id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.3">subscript</csymbol><apply id="alg1.l8.m1.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.3.2.1.cmml" xref="alg1.l8.m1.2.2.3">superscript</csymbol><ci id="alg1.l8.m1.2.2.3.2.2.cmml" xref="alg1.l8.m1.2.2.3.2.2">𝑤</ci><ci id="alg1.l8.m1.2.2.3.2.3.cmml" xref="alg1.l8.m1.2.2.3.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.3.3">𝑖</ci></apply><apply id="alg1.l8.m1.2.2.1.cmml" xref="alg1.l8.m1.2.2.1"><times id="alg1.l8.m1.2.2.1.2.cmml" xref="alg1.l8.m1.2.2.1.2"></times><ci id="alg1.l8.m1.2.2.1.3a.cmml" xref="alg1.l8.m1.2.2.1.3"><mtext id="alg1.l8.m1.2.2.1.3.cmml" xref="alg1.l8.m1.2.2.1.3">LocalUpdate</mtext></ci><interval closure="open" id="alg1.l8.m1.2.2.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.1"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑖</ci><apply id="alg1.l8.m1.2.2.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1">subscript</csymbol><apply id="alg1.l8.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1">superscript</csymbol><ci id="alg1.l8.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l8.m1.2.2.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l8.m1.2.2.1.1.1.1.3">𝑔</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">w^{t}_{i}\leftarrow\text{LocalUpdate}(i,w^{t}_{g})</annotation></semantics></math>
     
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <math id="alg1.l9.m1.2" class="ltx_Math" alttext="w^{t+1}_{g}\leftarrow\sum^{N}_{i=1}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}w^{t}_{i}" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.3" xref="alg1.l9.m1.2.3.cmml"><msubsup id="alg1.l9.m1.2.3.2" xref="alg1.l9.m1.2.3.2.cmml"><mi id="alg1.l9.m1.2.3.2.2.2" xref="alg1.l9.m1.2.3.2.2.2.cmml">w</mi><mi id="alg1.l9.m1.2.3.2.3" xref="alg1.l9.m1.2.3.2.3.cmml">g</mi><mrow id="alg1.l9.m1.2.3.2.2.3" xref="alg1.l9.m1.2.3.2.2.3.cmml"><mi id="alg1.l9.m1.2.3.2.2.3.2" xref="alg1.l9.m1.2.3.2.2.3.2.cmml">t</mi><mo id="alg1.l9.m1.2.3.2.2.3.1" xref="alg1.l9.m1.2.3.2.2.3.1.cmml">+</mo><mn id="alg1.l9.m1.2.3.2.2.3.3" xref="alg1.l9.m1.2.3.2.2.3.3.cmml">1</mn></mrow></msubsup><mo rspace="0.111em" stretchy="false" id="alg1.l9.m1.2.3.1" xref="alg1.l9.m1.2.3.1.cmml">←</mo><mrow id="alg1.l9.m1.2.3.3" xref="alg1.l9.m1.2.3.3.cmml"><msubsup id="alg1.l9.m1.2.3.3.1" xref="alg1.l9.m1.2.3.3.1.cmml"><mo id="alg1.l9.m1.2.3.3.1.2.2" xref="alg1.l9.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l9.m1.2.3.3.1.3" xref="alg1.l9.m1.2.3.3.1.3.cmml"><mi id="alg1.l9.m1.2.3.3.1.3.2" xref="alg1.l9.m1.2.3.3.1.3.2.cmml">i</mi><mo id="alg1.l9.m1.2.3.3.1.3.1" xref="alg1.l9.m1.2.3.3.1.3.1.cmml">=</mo><mn id="alg1.l9.m1.2.3.3.1.3.3" xref="alg1.l9.m1.2.3.3.1.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m1.2.3.3.1.2.3" xref="alg1.l9.m1.2.3.3.1.2.3.cmml">N</mi></msubsup><mrow id="alg1.l9.m1.2.3.3.2" xref="alg1.l9.m1.2.3.3.2.cmml"><mfrac id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l9.m1.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l9.m1.2.2.2.3.1" xref="alg1.l9.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.2.2.2.1" xref="alg1.l9.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="alg1.l9.m1.2.2.2.3.2" xref="alg1.l9.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.3.3.2.1" xref="alg1.l9.m1.2.3.3.2.1.cmml">​</mo><msubsup id="alg1.l9.m1.2.3.3.2.2" xref="alg1.l9.m1.2.3.3.2.2.cmml"><mi id="alg1.l9.m1.2.3.3.2.2.2.2" xref="alg1.l9.m1.2.3.3.2.2.2.2.cmml">w</mi><mi id="alg1.l9.m1.2.3.3.2.2.3" xref="alg1.l9.m1.2.3.3.2.2.3.cmml">i</mi><mi id="alg1.l9.m1.2.3.3.2.2.2.3" xref="alg1.l9.m1.2.3.3.2.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.3.cmml" xref="alg1.l9.m1.2.3"><ci id="alg1.l9.m1.2.3.1.cmml" xref="alg1.l9.m1.2.3.1">←</ci><apply id="alg1.l9.m1.2.3.2.cmml" xref="alg1.l9.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.2.1.cmml" xref="alg1.l9.m1.2.3.2">subscript</csymbol><apply id="alg1.l9.m1.2.3.2.2.cmml" xref="alg1.l9.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.2.2.1.cmml" xref="alg1.l9.m1.2.3.2">superscript</csymbol><ci id="alg1.l9.m1.2.3.2.2.2.cmml" xref="alg1.l9.m1.2.3.2.2.2">𝑤</ci><apply id="alg1.l9.m1.2.3.2.2.3.cmml" xref="alg1.l9.m1.2.3.2.2.3"><plus id="alg1.l9.m1.2.3.2.2.3.1.cmml" xref="alg1.l9.m1.2.3.2.2.3.1"></plus><ci id="alg1.l9.m1.2.3.2.2.3.2.cmml" xref="alg1.l9.m1.2.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.2.3.2.2.3.3.cmml" xref="alg1.l9.m1.2.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l9.m1.2.3.2.3.cmml" xref="alg1.l9.m1.2.3.2.3">𝑔</ci></apply><apply id="alg1.l9.m1.2.3.3.cmml" xref="alg1.l9.m1.2.3.3"><apply id="alg1.l9.m1.2.3.3.1.cmml" xref="alg1.l9.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.3.1.1.cmml" xref="alg1.l9.m1.2.3.3.1">subscript</csymbol><apply id="alg1.l9.m1.2.3.3.1.2.cmml" xref="alg1.l9.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.3.1.2.1.cmml" xref="alg1.l9.m1.2.3.3.1">superscript</csymbol><sum id="alg1.l9.m1.2.3.3.1.2.2.cmml" xref="alg1.l9.m1.2.3.3.1.2.2"></sum><ci id="alg1.l9.m1.2.3.3.1.2.3.cmml" xref="alg1.l9.m1.2.3.3.1.2.3">𝑁</ci></apply><apply id="alg1.l9.m1.2.3.3.1.3.cmml" xref="alg1.l9.m1.2.3.3.1.3"><eq id="alg1.l9.m1.2.3.3.1.3.1.cmml" xref="alg1.l9.m1.2.3.3.1.3.1"></eq><ci id="alg1.l9.m1.2.3.3.1.3.2.cmml" xref="alg1.l9.m1.2.3.3.1.3.2">𝑖</ci><cn type="integer" id="alg1.l9.m1.2.3.3.1.3.3.cmml" xref="alg1.l9.m1.2.3.3.1.3.3">1</cn></apply></apply><apply id="alg1.l9.m1.2.3.3.2.cmml" xref="alg1.l9.m1.2.3.3.2"><times id="alg1.l9.m1.2.3.3.2.1.cmml" xref="alg1.l9.m1.2.3.3.2.1"></times><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><divide id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2"></divide><apply id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1"><abs id="alg1.l9.m1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.2"></abs><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2">𝒟</ci><ci id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.3"><abs id="alg1.l9.m1.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.3.1"></abs><ci id="alg1.l9.m1.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="alg1.l9.m1.2.3.3.2.2.cmml" xref="alg1.l9.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.3.2.2.1.cmml" xref="alg1.l9.m1.2.3.3.2.2">subscript</csymbol><apply id="alg1.l9.m1.2.3.3.2.2.2.cmml" xref="alg1.l9.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.3.2.2.2.1.cmml" xref="alg1.l9.m1.2.3.3.2.2">superscript</csymbol><ci id="alg1.l9.m1.2.3.3.2.2.2.2.cmml" xref="alg1.l9.m1.2.3.3.2.2.2.2">𝑤</ci><ci id="alg1.l9.m1.2.3.3.2.2.2.3.cmml" xref="alg1.l9.m1.2.3.3.2.2.2.3">𝑡</ci></apply><ci id="alg1.l9.m1.2.3.3.2.2.3.cmml" xref="alg1.l9.m1.2.3.3.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">w^{t+1}_{g}\leftarrow\sum^{N}_{i=1}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}w^{t}_{i}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>return <math id="alg1.l10.m1.1" class="ltx_Math" alttext="w^{T}_{g}" display="inline"><semantics id="alg1.l10.m1.1a"><msubsup id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">g</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑤</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑇</ci></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">w^{T}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg1.l12.2" class="ltx_text ltx_font_bold">Client executes:</span> LocalUpdate(<math id="alg1.l12.m1.2" class="ltx_Math" alttext="i,w^{t}_{g}" display="inline"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.2.1" xref="alg1.l12.m1.2.2.2.cmml"><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">i</mi><mo id="alg1.l12.m1.2.2.1.2" xref="alg1.l12.m1.2.2.2.cmml">,</mo><msubsup id="alg1.l12.m1.2.2.1.1" xref="alg1.l12.m1.2.2.1.1.cmml"><mi id="alg1.l12.m1.2.2.1.1.2.2" xref="alg1.l12.m1.2.2.1.1.2.2.cmml">w</mi><mi id="alg1.l12.m1.2.2.1.1.3" xref="alg1.l12.m1.2.2.1.1.3.cmml">g</mi><mi id="alg1.l12.m1.2.2.1.1.2.3" xref="alg1.l12.m1.2.2.1.1.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><list id="alg1.l12.m1.2.2.2.cmml" xref="alg1.l12.m1.2.2.1"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑖</ci><apply id="alg1.l12.m1.2.2.1.1.cmml" xref="alg1.l12.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1">subscript</csymbol><apply id="alg1.l12.m1.2.2.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.2.1.cmml" xref="alg1.l12.m1.2.2.1.1">superscript</csymbol><ci id="alg1.l12.m1.2.2.1.1.2.2.cmml" xref="alg1.l12.m1.2.2.1.1.2.2">𝑤</ci><ci id="alg1.l12.m1.2.2.1.1.2.3.cmml" xref="alg1.l12.m1.2.2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l12.m1.2.2.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.3">𝑔</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">i,w^{t}_{g}</annotation></semantics></math>):

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span><math id="alg1.l13.m1.1" class="ltx_Math" alttext="w^{t-1}_{i}\leftarrow w^{t}_{i}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msubsup id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2.2" xref="alg1.l13.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">i</mi><mrow id="alg1.l13.m1.1.1.2.2.3" xref="alg1.l13.m1.1.1.2.2.3.cmml"><mi id="alg1.l13.m1.1.1.2.2.3.2" xref="alg1.l13.m1.1.1.2.2.3.2.cmml">t</mi><mo id="alg1.l13.m1.1.1.2.2.3.1" xref="alg1.l13.m1.1.1.2.2.3.1.cmml">−</mo><mn id="alg1.l13.m1.1.1.2.2.3.3" xref="alg1.l13.m1.1.1.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2.2" xref="alg1.l13.m1.1.1.3.2.2.cmml">w</mi><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">i</mi><mi id="alg1.l13.m1.1.1.3.2.3" xref="alg1.l13.m1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">←</ci><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">subscript</csymbol><apply id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.2.1.cmml" xref="alg1.l13.m1.1.1.2">superscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.2.cmml" xref="alg1.l13.m1.1.1.2.2.2">𝑤</ci><apply id="alg1.l13.m1.1.1.2.2.3.cmml" xref="alg1.l13.m1.1.1.2.2.3"><minus id="alg1.l13.m1.1.1.2.2.3.1.cmml" xref="alg1.l13.m1.1.1.2.2.3.1"></minus><ci id="alg1.l13.m1.1.1.2.2.3.2.cmml" xref="alg1.l13.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l13.m1.1.1.2.2.3.3.cmml" xref="alg1.l13.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3">superscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">𝑤</ci><ci id="alg1.l13.m1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">w^{t-1}_{i}\leftarrow w^{t}_{i}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span><math id="alg1.l14.m1.1" class="ltx_Math" alttext="w^{t}_{i}\leftarrow w^{t}_{g}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msubsup id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2.2" xref="alg1.l14.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml">i</mi><mi id="alg1.l14.m1.1.1.2.2.3" xref="alg1.l14.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2.2" xref="alg1.l14.m1.1.1.3.2.2.cmml">w</mi><mi id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml">g</mi><mi id="alg1.l14.m1.1.1.3.2.3" xref="alg1.l14.m1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><apply id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.2.1.cmml" xref="alg1.l14.m1.1.1.2">superscript</csymbol><ci id="alg1.l14.m1.1.1.2.2.2.cmml" xref="alg1.l14.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l14.m1.1.1.2.2.3.cmml" xref="alg1.l14.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3">subscript</csymbol><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3">superscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2">𝑤</ci><ci id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">w^{t}_{i}\leftarrow w^{t}_{g}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg1.l15.2" class="ltx_text ltx_font_bold">for</span> each epoch <math id="alg1.l15.m1.4" class="ltx_Math" alttext="e=0,1,\dots,E-1" display="inline"><semantics id="alg1.l15.m1.4a"><mrow id="alg1.l15.m1.4.4" xref="alg1.l15.m1.4.4.cmml"><mi id="alg1.l15.m1.4.4.3" xref="alg1.l15.m1.4.4.3.cmml">e</mi><mo id="alg1.l15.m1.4.4.2" xref="alg1.l15.m1.4.4.2.cmml">=</mo><mrow id="alg1.l15.m1.4.4.1.1" xref="alg1.l15.m1.4.4.1.2.cmml"><mn id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">0</mn><mo id="alg1.l15.m1.4.4.1.1.2" xref="alg1.l15.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l15.m1.2.2" xref="alg1.l15.m1.2.2.cmml">1</mn><mo id="alg1.l15.m1.4.4.1.1.3" xref="alg1.l15.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l15.m1.3.3" xref="alg1.l15.m1.3.3.cmml">…</mi><mo id="alg1.l15.m1.4.4.1.1.4" xref="alg1.l15.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l15.m1.4.4.1.1.1" xref="alg1.l15.m1.4.4.1.1.1.cmml"><mi id="alg1.l15.m1.4.4.1.1.1.2" xref="alg1.l15.m1.4.4.1.1.1.2.cmml">E</mi><mo id="alg1.l15.m1.4.4.1.1.1.1" xref="alg1.l15.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l15.m1.4.4.1.1.1.3" xref="alg1.l15.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.4b"><apply id="alg1.l15.m1.4.4.cmml" xref="alg1.l15.m1.4.4"><eq id="alg1.l15.m1.4.4.2.cmml" xref="alg1.l15.m1.4.4.2"></eq><ci id="alg1.l15.m1.4.4.3.cmml" xref="alg1.l15.m1.4.4.3">𝑒</ci><list id="alg1.l15.m1.4.4.1.2.cmml" xref="alg1.l15.m1.4.4.1.1"><cn type="integer" id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">0</cn><cn type="integer" id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2">1</cn><ci id="alg1.l15.m1.3.3.cmml" xref="alg1.l15.m1.3.3">…</ci><apply id="alg1.l15.m1.4.4.1.1.1.cmml" xref="alg1.l15.m1.4.4.1.1.1"><minus id="alg1.l15.m1.4.4.1.1.1.1.cmml" xref="alg1.l15.m1.4.4.1.1.1.1"></minus><ci id="alg1.l15.m1.4.4.1.1.1.2.cmml" xref="alg1.l15.m1.4.4.1.1.1.2">𝐸</ci><cn type="integer" id="alg1.l15.m1.4.4.1.1.1.3.cmml" xref="alg1.l15.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.4c">e=0,1,\dots,E-1</annotation></semantics></math> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>     <span id="alg1.l16.2" class="ltx_text ltx_font_bold">for</span> each batch <math id="alg1.l16.m1.2" class="ltx_Math" alttext="\{x,y\}\in\mathcal{D}_{i}" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.3" xref="alg1.l16.m1.2.3.cmml"><mrow id="alg1.l16.m1.2.3.2.2" xref="alg1.l16.m1.2.3.2.1.cmml"><mo stretchy="false" id="alg1.l16.m1.2.3.2.2.1" xref="alg1.l16.m1.2.3.2.1.cmml">{</mo><mi id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">x</mi><mo id="alg1.l16.m1.2.3.2.2.2" xref="alg1.l16.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l16.m1.2.3.2.2.3" xref="alg1.l16.m1.2.3.2.1.cmml">}</mo></mrow><mo id="alg1.l16.m1.2.3.1" xref="alg1.l16.m1.2.3.1.cmml">∈</mo><msub id="alg1.l16.m1.2.3.3" xref="alg1.l16.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.2.3.3.2" xref="alg1.l16.m1.2.3.3.2.cmml">𝒟</mi><mi id="alg1.l16.m1.2.3.3.3" xref="alg1.l16.m1.2.3.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.3.cmml" xref="alg1.l16.m1.2.3"><in id="alg1.l16.m1.2.3.1.cmml" xref="alg1.l16.m1.2.3.1"></in><set id="alg1.l16.m1.2.3.2.1.cmml" xref="alg1.l16.m1.2.3.2.2"><ci id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">𝑥</ci><ci id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2">𝑦</ci></set><apply id="alg1.l16.m1.2.3.3.cmml" xref="alg1.l16.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.3.1.cmml" xref="alg1.l16.m1.2.3.3">subscript</csymbol><ci id="alg1.l16.m1.2.3.3.2.cmml" xref="alg1.l16.m1.2.3.3.2">𝒟</ci><ci id="alg1.l16.m1.2.3.3.3.cmml" xref="alg1.l16.m1.2.3.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">\{x,y\}\in\mathcal{D}_{i}</annotation></semantics></math> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>         <math id="alg1.l17.m1.3" class="ltx_Math" alttext="\hat{y},[z^{k}]^{K}_{k=1}\leftarrow w^{t}_{i}(x)" display="inline"><semantics id="alg1.l17.m1.3a"><mrow id="alg1.l17.m1.3.3" xref="alg1.l17.m1.3.3.cmml"><mrow id="alg1.l17.m1.3.3.1.1" xref="alg1.l17.m1.3.3.1.2.cmml"><mover accent="true" id="alg1.l17.m1.2.2" xref="alg1.l17.m1.2.2.cmml"><mi id="alg1.l17.m1.2.2.2" xref="alg1.l17.m1.2.2.2.cmml">y</mi><mo id="alg1.l17.m1.2.2.1" xref="alg1.l17.m1.2.2.1.cmml">^</mo></mover><mo id="alg1.l17.m1.3.3.1.1.2" xref="alg1.l17.m1.3.3.1.2.cmml">,</mo><msubsup id="alg1.l17.m1.3.3.1.1.1" xref="alg1.l17.m1.3.3.1.1.1.cmml"><mrow id="alg1.l17.m1.3.3.1.1.1.1.1.1" xref="alg1.l17.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l17.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l17.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><msup id="alg1.l17.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l17.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="alg1.l17.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l17.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="alg1.l17.m1.3.3.1.1.1.3" xref="alg1.l17.m1.3.3.1.1.1.3.cmml"><mi id="alg1.l17.m1.3.3.1.1.1.3.2" xref="alg1.l17.m1.3.3.1.1.1.3.2.cmml">k</mi><mo id="alg1.l17.m1.3.3.1.1.1.3.1" xref="alg1.l17.m1.3.3.1.1.1.3.1.cmml">=</mo><mn id="alg1.l17.m1.3.3.1.1.1.3.3" xref="alg1.l17.m1.3.3.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l17.m1.3.3.1.1.1.1.3" xref="alg1.l17.m1.3.3.1.1.1.1.3.cmml">K</mi></msubsup></mrow><mo stretchy="false" id="alg1.l17.m1.3.3.2" xref="alg1.l17.m1.3.3.2.cmml">←</mo><mrow id="alg1.l17.m1.3.3.3" xref="alg1.l17.m1.3.3.3.cmml"><msubsup id="alg1.l17.m1.3.3.3.2" xref="alg1.l17.m1.3.3.3.2.cmml"><mi id="alg1.l17.m1.3.3.3.2.2.2" xref="alg1.l17.m1.3.3.3.2.2.2.cmml">w</mi><mi id="alg1.l17.m1.3.3.3.2.3" xref="alg1.l17.m1.3.3.3.2.3.cmml">i</mi><mi id="alg1.l17.m1.3.3.3.2.2.3" xref="alg1.l17.m1.3.3.3.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l17.m1.3.3.3.1" xref="alg1.l17.m1.3.3.3.1.cmml">​</mo><mrow id="alg1.l17.m1.3.3.3.3.2" xref="alg1.l17.m1.3.3.3.cmml"><mo stretchy="false" id="alg1.l17.m1.3.3.3.3.2.1" xref="alg1.l17.m1.3.3.3.cmml">(</mo><mi id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l17.m1.3.3.3.3.2.2" xref="alg1.l17.m1.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.3b"><apply id="alg1.l17.m1.3.3.cmml" xref="alg1.l17.m1.3.3"><ci id="alg1.l17.m1.3.3.2.cmml" xref="alg1.l17.m1.3.3.2">←</ci><list id="alg1.l17.m1.3.3.1.2.cmml" xref="alg1.l17.m1.3.3.1.1"><apply id="alg1.l17.m1.2.2.cmml" xref="alg1.l17.m1.2.2"><ci id="alg1.l17.m1.2.2.1.cmml" xref="alg1.l17.m1.2.2.1">^</ci><ci id="alg1.l17.m1.2.2.2.cmml" xref="alg1.l17.m1.2.2.2">𝑦</ci></apply><apply id="alg1.l17.m1.3.3.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.1.1.1.2.cmml" xref="alg1.l17.m1.3.3.1.1.1">subscript</csymbol><apply id="alg1.l17.m1.3.3.1.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l17.m1.3.3.1.1.1">superscript</csymbol><apply id="alg1.l17.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l17.m1.3.3.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l17.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l17.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l17.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><ci id="alg1.l17.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.3">𝐾</ci></apply><apply id="alg1.l17.m1.3.3.1.1.1.3.cmml" xref="alg1.l17.m1.3.3.1.1.1.3"><eq id="alg1.l17.m1.3.3.1.1.1.3.1.cmml" xref="alg1.l17.m1.3.3.1.1.1.3.1"></eq><ci id="alg1.l17.m1.3.3.1.1.1.3.2.cmml" xref="alg1.l17.m1.3.3.1.1.1.3.2">𝑘</ci><cn type="integer" id="alg1.l17.m1.3.3.1.1.1.3.3.cmml" xref="alg1.l17.m1.3.3.1.1.1.3.3">1</cn></apply></apply></list><apply id="alg1.l17.m1.3.3.3.cmml" xref="alg1.l17.m1.3.3.3"><times id="alg1.l17.m1.3.3.3.1.cmml" xref="alg1.l17.m1.3.3.3.1"></times><apply id="alg1.l17.m1.3.3.3.2.cmml" xref="alg1.l17.m1.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.3.2.1.cmml" xref="alg1.l17.m1.3.3.3.2">subscript</csymbol><apply id="alg1.l17.m1.3.3.3.2.2.cmml" xref="alg1.l17.m1.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.3.2.2.1.cmml" xref="alg1.l17.m1.3.3.3.2">superscript</csymbol><ci id="alg1.l17.m1.3.3.3.2.2.2.cmml" xref="alg1.l17.m1.3.3.3.2.2.2">𝑤</ci><ci id="alg1.l17.m1.3.3.3.2.2.3.cmml" xref="alg1.l17.m1.3.3.3.2.2.3">𝑡</ci></apply><ci id="alg1.l17.m1.3.3.3.2.3.cmml" xref="alg1.l17.m1.3.3.3.2.3">𝑖</ci></apply><ci id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.3c">\hat{y},[z^{k}]^{K}_{k=1}\leftarrow w^{t}_{i}(x)</annotation></semantics></math>


</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>         <math id="alg1.l18.m1.2" class="ltx_Math" alttext="[z^{k}_{g}]^{K}_{k=1}\leftarrow w^{t}_{g}(x)" display="inline"><semantics id="alg1.l18.m1.2a"><mrow id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml"><msubsup id="alg1.l18.m1.2.2.1" xref="alg1.l18.m1.2.2.1.cmml"><mrow id="alg1.l18.m1.2.2.1.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l18.m1.2.2.1.1.1.1.2" xref="alg1.l18.m1.2.2.1.1.1.2.1.cmml">[</mo><msubsup id="alg1.l18.m1.2.2.1.1.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.2.2.1.1.1.1.1.2.2" xref="alg1.l18.m1.2.2.1.1.1.1.1.2.2.cmml">z</mi><mi id="alg1.l18.m1.2.2.1.1.1.1.1.3" xref="alg1.l18.m1.2.2.1.1.1.1.1.3.cmml">g</mi><mi id="alg1.l18.m1.2.2.1.1.1.1.1.2.3" xref="alg1.l18.m1.2.2.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l18.m1.2.2.1.1.1.1.3" xref="alg1.l18.m1.2.2.1.1.1.2.1.cmml">]</mo></mrow><mrow id="alg1.l18.m1.2.2.1.3" xref="alg1.l18.m1.2.2.1.3.cmml"><mi id="alg1.l18.m1.2.2.1.3.2" xref="alg1.l18.m1.2.2.1.3.2.cmml">k</mi><mo id="alg1.l18.m1.2.2.1.3.1" xref="alg1.l18.m1.2.2.1.3.1.cmml">=</mo><mn id="alg1.l18.m1.2.2.1.3.3" xref="alg1.l18.m1.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg1.l18.m1.2.2.1.1.3" xref="alg1.l18.m1.2.2.1.1.3.cmml">K</mi></msubsup><mo stretchy="false" id="alg1.l18.m1.2.2.2" xref="alg1.l18.m1.2.2.2.cmml">←</mo><mrow id="alg1.l18.m1.2.2.3" xref="alg1.l18.m1.2.2.3.cmml"><msubsup id="alg1.l18.m1.2.2.3.2" xref="alg1.l18.m1.2.2.3.2.cmml"><mi id="alg1.l18.m1.2.2.3.2.2.2" xref="alg1.l18.m1.2.2.3.2.2.2.cmml">w</mi><mi id="alg1.l18.m1.2.2.3.2.3" xref="alg1.l18.m1.2.2.3.2.3.cmml">g</mi><mi id="alg1.l18.m1.2.2.3.2.2.3" xref="alg1.l18.m1.2.2.3.2.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l18.m1.2.2.3.1" xref="alg1.l18.m1.2.2.3.1.cmml">​</mo><mrow id="alg1.l18.m1.2.2.3.3.2" xref="alg1.l18.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l18.m1.2.2.3.3.2.1" xref="alg1.l18.m1.2.2.3.cmml">(</mo><mi id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l18.m1.2.2.3.3.2.2" xref="alg1.l18.m1.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b"><apply id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2"><ci id="alg1.l18.m1.2.2.2.cmml" xref="alg1.l18.m1.2.2.2">←</ci><apply id="alg1.l18.m1.2.2.1.cmml" xref="alg1.l18.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.1.2.cmml" xref="alg1.l18.m1.2.2.1">subscript</csymbol><apply id="alg1.l18.m1.2.2.1.1.cmml" xref="alg1.l18.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.1.1.2.cmml" xref="alg1.l18.m1.2.2.1">superscript</csymbol><apply id="alg1.l18.m1.2.2.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="alg1.l18.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l18.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="alg1.l18.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l18.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1.2.2">𝑧</ci><ci id="alg1.l18.m1.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l18.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.2.2.1.1.1.1.1.3">𝑔</ci></apply></apply><ci id="alg1.l18.m1.2.2.1.1.3.cmml" xref="alg1.l18.m1.2.2.1.1.3">𝐾</ci></apply><apply id="alg1.l18.m1.2.2.1.3.cmml" xref="alg1.l18.m1.2.2.1.3"><eq id="alg1.l18.m1.2.2.1.3.1.cmml" xref="alg1.l18.m1.2.2.1.3.1"></eq><ci id="alg1.l18.m1.2.2.1.3.2.cmml" xref="alg1.l18.m1.2.2.1.3.2">𝑘</ci><cn type="integer" id="alg1.l18.m1.2.2.1.3.3.cmml" xref="alg1.l18.m1.2.2.1.3.3">1</cn></apply></apply><apply id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.3"><times id="alg1.l18.m1.2.2.3.1.cmml" xref="alg1.l18.m1.2.2.3.1"></times><apply id="alg1.l18.m1.2.2.3.2.cmml" xref="alg1.l18.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.3.2.1.cmml" xref="alg1.l18.m1.2.2.3.2">subscript</csymbol><apply id="alg1.l18.m1.2.2.3.2.2.cmml" xref="alg1.l18.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.3.2.2.1.cmml" xref="alg1.l18.m1.2.2.3.2">superscript</csymbol><ci id="alg1.l18.m1.2.2.3.2.2.2.cmml" xref="alg1.l18.m1.2.2.3.2.2.2">𝑤</ci><ci id="alg1.l18.m1.2.2.3.2.2.3.cmml" xref="alg1.l18.m1.2.2.3.2.2.3">𝑡</ci></apply><ci id="alg1.l18.m1.2.2.3.2.3.cmml" xref="alg1.l18.m1.2.2.3.2.3">𝑔</ci></apply><ci id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.2c">[z^{k}_{g}]^{K}_{k=1}\leftarrow w^{t}_{g}(x)</annotation></semantics></math>


</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>         <math id="alg1.l19.m1.2" class="ltx_Math" alttext="[z^{k}_{p}]^{K}_{k=1}\leftarrow w^{t-1}_{i}(x)" display="inline"><semantics id="alg1.l19.m1.2a"><mrow id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml"><msubsup id="alg1.l19.m1.2.2.1" xref="alg1.l19.m1.2.2.1.cmml"><mrow id="alg1.l19.m1.2.2.1.1.1.1" xref="alg1.l19.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l19.m1.2.2.1.1.1.1.2" xref="alg1.l19.m1.2.2.1.1.1.2.1.cmml">[</mo><msubsup id="alg1.l19.m1.2.2.1.1.1.1.1" xref="alg1.l19.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l19.m1.2.2.1.1.1.1.1.2.2" xref="alg1.l19.m1.2.2.1.1.1.1.1.2.2.cmml">z</mi><mi id="alg1.l19.m1.2.2.1.1.1.1.1.3" xref="alg1.l19.m1.2.2.1.1.1.1.1.3.cmml">p</mi><mi id="alg1.l19.m1.2.2.1.1.1.1.1.2.3" xref="alg1.l19.m1.2.2.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l19.m1.2.2.1.1.1.1.3" xref="alg1.l19.m1.2.2.1.1.1.2.1.cmml">]</mo></mrow><mrow id="alg1.l19.m1.2.2.1.3" xref="alg1.l19.m1.2.2.1.3.cmml"><mi id="alg1.l19.m1.2.2.1.3.2" xref="alg1.l19.m1.2.2.1.3.2.cmml">k</mi><mo id="alg1.l19.m1.2.2.1.3.1" xref="alg1.l19.m1.2.2.1.3.1.cmml">=</mo><mn id="alg1.l19.m1.2.2.1.3.3" xref="alg1.l19.m1.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg1.l19.m1.2.2.1.1.3" xref="alg1.l19.m1.2.2.1.1.3.cmml">K</mi></msubsup><mo stretchy="false" id="alg1.l19.m1.2.2.2" xref="alg1.l19.m1.2.2.2.cmml">←</mo><mrow id="alg1.l19.m1.2.2.3" xref="alg1.l19.m1.2.2.3.cmml"><msubsup id="alg1.l19.m1.2.2.3.2" xref="alg1.l19.m1.2.2.3.2.cmml"><mi id="alg1.l19.m1.2.2.3.2.2.2" xref="alg1.l19.m1.2.2.3.2.2.2.cmml">w</mi><mi id="alg1.l19.m1.2.2.3.2.3" xref="alg1.l19.m1.2.2.3.2.3.cmml">i</mi><mrow id="alg1.l19.m1.2.2.3.2.2.3" xref="alg1.l19.m1.2.2.3.2.2.3.cmml"><mi id="alg1.l19.m1.2.2.3.2.2.3.2" xref="alg1.l19.m1.2.2.3.2.2.3.2.cmml">t</mi><mo id="alg1.l19.m1.2.2.3.2.2.3.1" xref="alg1.l19.m1.2.2.3.2.2.3.1.cmml">−</mo><mn id="alg1.l19.m1.2.2.3.2.2.3.3" xref="alg1.l19.m1.2.2.3.2.2.3.3.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l19.m1.2.2.3.1" xref="alg1.l19.m1.2.2.3.1.cmml">​</mo><mrow id="alg1.l19.m1.2.2.3.3.2" xref="alg1.l19.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l19.m1.2.2.3.3.2.1" xref="alg1.l19.m1.2.2.3.cmml">(</mo><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l19.m1.2.2.3.3.2.2" xref="alg1.l19.m1.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b"><apply id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2"><ci id="alg1.l19.m1.2.2.2.cmml" xref="alg1.l19.m1.2.2.2">←</ci><apply id="alg1.l19.m1.2.2.1.cmml" xref="alg1.l19.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.1.2.cmml" xref="alg1.l19.m1.2.2.1">subscript</csymbol><apply id="alg1.l19.m1.2.2.1.1.cmml" xref="alg1.l19.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.1.1.2.cmml" xref="alg1.l19.m1.2.2.1">superscript</csymbol><apply id="alg1.l19.m1.2.2.1.1.1.2.cmml" xref="alg1.l19.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="alg1.l19.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l19.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="alg1.l19.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l19.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1.2.2">𝑧</ci><ci id="alg1.l19.m1.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l19.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.2.2.1.1.1.1.1.3">𝑝</ci></apply></apply><ci id="alg1.l19.m1.2.2.1.1.3.cmml" xref="alg1.l19.m1.2.2.1.1.3">𝐾</ci></apply><apply id="alg1.l19.m1.2.2.1.3.cmml" xref="alg1.l19.m1.2.2.1.3"><eq id="alg1.l19.m1.2.2.1.3.1.cmml" xref="alg1.l19.m1.2.2.1.3.1"></eq><ci id="alg1.l19.m1.2.2.1.3.2.cmml" xref="alg1.l19.m1.2.2.1.3.2">𝑘</ci><cn type="integer" id="alg1.l19.m1.2.2.1.3.3.cmml" xref="alg1.l19.m1.2.2.1.3.3">1</cn></apply></apply><apply id="alg1.l19.m1.2.2.3.cmml" xref="alg1.l19.m1.2.2.3"><times id="alg1.l19.m1.2.2.3.1.cmml" xref="alg1.l19.m1.2.2.3.1"></times><apply id="alg1.l19.m1.2.2.3.2.cmml" xref="alg1.l19.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.3.2.1.cmml" xref="alg1.l19.m1.2.2.3.2">subscript</csymbol><apply id="alg1.l19.m1.2.2.3.2.2.cmml" xref="alg1.l19.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.3.2.2.1.cmml" xref="alg1.l19.m1.2.2.3.2">superscript</csymbol><ci id="alg1.l19.m1.2.2.3.2.2.2.cmml" xref="alg1.l19.m1.2.2.3.2.2.2">𝑤</ci><apply id="alg1.l19.m1.2.2.3.2.2.3.cmml" xref="alg1.l19.m1.2.2.3.2.2.3"><minus id="alg1.l19.m1.2.2.3.2.2.3.1.cmml" xref="alg1.l19.m1.2.2.3.2.2.3.1"></minus><ci id="alg1.l19.m1.2.2.3.2.2.3.2.cmml" xref="alg1.l19.m1.2.2.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l19.m1.2.2.3.2.2.3.3.cmml" xref="alg1.l19.m1.2.2.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l19.m1.2.2.3.2.3.cmml" xref="alg1.l19.m1.2.2.3.2.3">𝑖</ci></apply><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.2c">[z^{k}_{p}]^{K}_{k=1}\leftarrow w^{t-1}_{i}(x)</annotation></semantics></math>


</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>         <math id="alg1.l20.m1.2" class="ltx_Math" alttext="\ell_{sup}\leftarrow CrossEntropyLoss(\hat{y},y)" display="inline"><semantics id="alg1.l20.m1.2a"><mrow id="alg1.l20.m1.2.3" xref="alg1.l20.m1.2.3.cmml"><msub id="alg1.l20.m1.2.3.2" xref="alg1.l20.m1.2.3.2.cmml"><mi mathvariant="normal" id="alg1.l20.m1.2.3.2.2" xref="alg1.l20.m1.2.3.2.2.cmml">ℓ</mi><mrow id="alg1.l20.m1.2.3.2.3" xref="alg1.l20.m1.2.3.2.3.cmml"><mi id="alg1.l20.m1.2.3.2.3.2" xref="alg1.l20.m1.2.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.2.3.1" xref="alg1.l20.m1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.2.3.3" xref="alg1.l20.m1.2.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.2.3.1a" xref="alg1.l20.m1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.2.3.4" xref="alg1.l20.m1.2.3.2.3.4.cmml">p</mi></mrow></msub><mo stretchy="false" id="alg1.l20.m1.2.3.1" xref="alg1.l20.m1.2.3.1.cmml">←</mo><mrow id="alg1.l20.m1.2.3.3" xref="alg1.l20.m1.2.3.3.cmml"><mi id="alg1.l20.m1.2.3.3.2" xref="alg1.l20.m1.2.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.3" xref="alg1.l20.m1.2.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1a" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.4" xref="alg1.l20.m1.2.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1b" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.5" xref="alg1.l20.m1.2.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1c" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.6" xref="alg1.l20.m1.2.3.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1d" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.7" xref="alg1.l20.m1.2.3.3.7.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1e" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.8" xref="alg1.l20.m1.2.3.3.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1f" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.9" xref="alg1.l20.m1.2.3.3.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1g" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.10" xref="alg1.l20.m1.2.3.3.10.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1h" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.11" xref="alg1.l20.m1.2.3.3.11.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1i" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.12" xref="alg1.l20.m1.2.3.3.12.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1j" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.13" xref="alg1.l20.m1.2.3.3.13.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1k" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.14" xref="alg1.l20.m1.2.3.3.14.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1l" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.15" xref="alg1.l20.m1.2.3.3.15.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1m" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.16" xref="alg1.l20.m1.2.3.3.16.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1n" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.2.3.3.17" xref="alg1.l20.m1.2.3.3.17.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.2.3.3.1o" xref="alg1.l20.m1.2.3.3.1.cmml">​</mo><mrow id="alg1.l20.m1.2.3.3.18.2" xref="alg1.l20.m1.2.3.3.18.1.cmml"><mo stretchy="false" id="alg1.l20.m1.2.3.3.18.2.1" xref="alg1.l20.m1.2.3.3.18.1.cmml">(</mo><mover accent="true" id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">y</mi><mo id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l20.m1.2.3.3.18.2.2" xref="alg1.l20.m1.2.3.3.18.1.cmml">,</mo><mi id="alg1.l20.m1.2.2" xref="alg1.l20.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l20.m1.2.3.3.18.2.3" xref="alg1.l20.m1.2.3.3.18.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.2b"><apply id="alg1.l20.m1.2.3.cmml" xref="alg1.l20.m1.2.3"><ci id="alg1.l20.m1.2.3.1.cmml" xref="alg1.l20.m1.2.3.1">←</ci><apply id="alg1.l20.m1.2.3.2.cmml" xref="alg1.l20.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l20.m1.2.3.2.1.cmml" xref="alg1.l20.m1.2.3.2">subscript</csymbol><ci id="alg1.l20.m1.2.3.2.2.cmml" xref="alg1.l20.m1.2.3.2.2">ℓ</ci><apply id="alg1.l20.m1.2.3.2.3.cmml" xref="alg1.l20.m1.2.3.2.3"><times id="alg1.l20.m1.2.3.2.3.1.cmml" xref="alg1.l20.m1.2.3.2.3.1"></times><ci id="alg1.l20.m1.2.3.2.3.2.cmml" xref="alg1.l20.m1.2.3.2.3.2">𝑠</ci><ci id="alg1.l20.m1.2.3.2.3.3.cmml" xref="alg1.l20.m1.2.3.2.3.3">𝑢</ci><ci id="alg1.l20.m1.2.3.2.3.4.cmml" xref="alg1.l20.m1.2.3.2.3.4">𝑝</ci></apply></apply><apply id="alg1.l20.m1.2.3.3.cmml" xref="alg1.l20.m1.2.3.3"><times id="alg1.l20.m1.2.3.3.1.cmml" xref="alg1.l20.m1.2.3.3.1"></times><ci id="alg1.l20.m1.2.3.3.2.cmml" xref="alg1.l20.m1.2.3.3.2">𝐶</ci><ci id="alg1.l20.m1.2.3.3.3.cmml" xref="alg1.l20.m1.2.3.3.3">𝑟</ci><ci id="alg1.l20.m1.2.3.3.4.cmml" xref="alg1.l20.m1.2.3.3.4">𝑜</ci><ci id="alg1.l20.m1.2.3.3.5.cmml" xref="alg1.l20.m1.2.3.3.5">𝑠</ci><ci id="alg1.l20.m1.2.3.3.6.cmml" xref="alg1.l20.m1.2.3.3.6">𝑠</ci><ci id="alg1.l20.m1.2.3.3.7.cmml" xref="alg1.l20.m1.2.3.3.7">𝐸</ci><ci id="alg1.l20.m1.2.3.3.8.cmml" xref="alg1.l20.m1.2.3.3.8">𝑛</ci><ci id="alg1.l20.m1.2.3.3.9.cmml" xref="alg1.l20.m1.2.3.3.9">𝑡</ci><ci id="alg1.l20.m1.2.3.3.10.cmml" xref="alg1.l20.m1.2.3.3.10">𝑟</ci><ci id="alg1.l20.m1.2.3.3.11.cmml" xref="alg1.l20.m1.2.3.3.11">𝑜</ci><ci id="alg1.l20.m1.2.3.3.12.cmml" xref="alg1.l20.m1.2.3.3.12">𝑝</ci><ci id="alg1.l20.m1.2.3.3.13.cmml" xref="alg1.l20.m1.2.3.3.13">𝑦</ci><ci id="alg1.l20.m1.2.3.3.14.cmml" xref="alg1.l20.m1.2.3.3.14">𝐿</ci><ci id="alg1.l20.m1.2.3.3.15.cmml" xref="alg1.l20.m1.2.3.3.15">𝑜</ci><ci id="alg1.l20.m1.2.3.3.16.cmml" xref="alg1.l20.m1.2.3.3.16">𝑠</ci><ci id="alg1.l20.m1.2.3.3.17.cmml" xref="alg1.l20.m1.2.3.3.17">𝑠</ci><interval closure="open" id="alg1.l20.m1.2.3.3.18.1.cmml" xref="alg1.l20.m1.2.3.3.18.2"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><ci id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1">^</ci><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">𝑦</ci></apply><ci id="alg1.l20.m1.2.2.cmml" xref="alg1.l20.m1.2.2">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.2c">\ell_{sup}\leftarrow CrossEntropyLoss(\hat{y},y)</annotation></semantics></math>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>         <span id="alg1.l21.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l21.m1.4" class="ltx_Math" alttext="k=1,2,\dots,K" display="inline"><semantics id="alg1.l21.m1.4a"><mrow id="alg1.l21.m1.4.5" xref="alg1.l21.m1.4.5.cmml"><mi id="alg1.l21.m1.4.5.2" xref="alg1.l21.m1.4.5.2.cmml">k</mi><mo id="alg1.l21.m1.4.5.1" xref="alg1.l21.m1.4.5.1.cmml">=</mo><mrow id="alg1.l21.m1.4.5.3.2" xref="alg1.l21.m1.4.5.3.1.cmml"><mn id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml">1</mn><mo id="alg1.l21.m1.4.5.3.2.1" xref="alg1.l21.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l21.m1.2.2" xref="alg1.l21.m1.2.2.cmml">2</mn><mo id="alg1.l21.m1.4.5.3.2.2" xref="alg1.l21.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l21.m1.3.3" xref="alg1.l21.m1.3.3.cmml">…</mi><mo id="alg1.l21.m1.4.5.3.2.3" xref="alg1.l21.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l21.m1.4.4" xref="alg1.l21.m1.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.4b"><apply id="alg1.l21.m1.4.5.cmml" xref="alg1.l21.m1.4.5"><eq id="alg1.l21.m1.4.5.1.cmml" xref="alg1.l21.m1.4.5.1"></eq><ci id="alg1.l21.m1.4.5.2.cmml" xref="alg1.l21.m1.4.5.2">𝑘</ci><list id="alg1.l21.m1.4.5.3.1.cmml" xref="alg1.l21.m1.4.5.3.2"><cn type="integer" id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1">1</cn><cn type="integer" id="alg1.l21.m1.2.2.cmml" xref="alg1.l21.m1.2.2">2</cn><ci id="alg1.l21.m1.3.3.cmml" xref="alg1.l21.m1.3.3">…</ci><ci id="alg1.l21.m1.4.4.cmml" xref="alg1.l21.m1.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.4c">k=1,2,\dots,K</annotation></semantics></math> <span id="alg1.l21.3" class="ltx_text ltx_font_bold">do</span>


</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.1.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>              <math id="alg1.l22.m1.4" class="ltx_Math" alttext="\alpha_{k}\leftarrow\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\sum_{\hat{k}=1}^{K}\exp(\text{sim}(z^{\hat{k}},z^{\hat{k}}_{g})/\tau)}" display="inline"><semantics id="alg1.l22.m1.4a"><mrow id="alg1.l22.m1.4.5" xref="alg1.l22.m1.4.5.cmml"><msub id="alg1.l22.m1.4.5.2" xref="alg1.l22.m1.4.5.2.cmml"><mi id="alg1.l22.m1.4.5.2.2" xref="alg1.l22.m1.4.5.2.2.cmml">α</mi><mi id="alg1.l22.m1.4.5.2.3" xref="alg1.l22.m1.4.5.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l22.m1.4.5.1" xref="alg1.l22.m1.4.5.1.cmml">←</mo><mfrac id="alg1.l22.m1.4.4" xref="alg1.l22.m1.4.4.cmml"><mrow id="alg1.l22.m1.2.2.2.2" xref="alg1.l22.m1.2.2.2.3.cmml"><mi id="alg1.l22.m1.1.1.1.1" xref="alg1.l22.m1.1.1.1.1.cmml">exp</mi><mo id="alg1.l22.m1.2.2.2.2a" xref="alg1.l22.m1.2.2.2.3.cmml">⁡</mo><mrow id="alg1.l22.m1.2.2.2.2.1" xref="alg1.l22.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l22.m1.2.2.2.2.1.2" xref="alg1.l22.m1.2.2.2.3.cmml">(</mo><mrow id="alg1.l22.m1.2.2.2.2.1.1" xref="alg1.l22.m1.2.2.2.2.1.1.cmml"><mrow id="alg1.l22.m1.2.2.2.2.1.1.2" xref="alg1.l22.m1.2.2.2.2.1.1.2.cmml"><mtext id="alg1.l22.m1.2.2.2.2.1.1.2.4" xref="alg1.l22.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="alg1.l22.m1.2.2.2.2.1.1.2.3" xref="alg1.l22.m1.2.2.2.2.1.1.2.3.cmml">​</mo><mrow id="alg1.l22.m1.2.2.2.2.1.1.2.2.2" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.3" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msup id="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1" xref="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.2" xref="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.3" xref="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.4" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.2" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.3" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">g</mi><mi id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.3" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.5" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l22.m1.2.2.2.2.1.1.3" xref="alg1.l22.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="alg1.l22.m1.2.2.2.2.1.1.4" xref="alg1.l22.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="alg1.l22.m1.2.2.2.2.1.3" xref="alg1.l22.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="alg1.l22.m1.4.4.4" xref="alg1.l22.m1.4.4.4.cmml"><mstyle displaystyle="false" id="alg1.l22.m1.4.4.4.3" xref="alg1.l22.m1.4.4.4.3.cmml"><msubsup id="alg1.l22.m1.4.4.4.3a" xref="alg1.l22.m1.4.4.4.3.cmml"><mo id="alg1.l22.m1.4.4.4.3.2.2" xref="alg1.l22.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="alg1.l22.m1.4.4.4.3.2.3" xref="alg1.l22.m1.4.4.4.3.2.3.cmml"><mover accent="true" id="alg1.l22.m1.4.4.4.3.2.3.2" xref="alg1.l22.m1.4.4.4.3.2.3.2.cmml"><mi id="alg1.l22.m1.4.4.4.3.2.3.2.2" xref="alg1.l22.m1.4.4.4.3.2.3.2.2.cmml">k</mi><mo id="alg1.l22.m1.4.4.4.3.2.3.2.1" xref="alg1.l22.m1.4.4.4.3.2.3.2.1.cmml">^</mo></mover><mo id="alg1.l22.m1.4.4.4.3.2.3.1" xref="alg1.l22.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="alg1.l22.m1.4.4.4.3.2.3.3" xref="alg1.l22.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l22.m1.4.4.4.3.3" xref="alg1.l22.m1.4.4.4.3.3.cmml">K</mi></msubsup></mstyle><mrow id="alg1.l22.m1.4.4.4.2.1" xref="alg1.l22.m1.4.4.4.2.2.cmml"><mi id="alg1.l22.m1.3.3.3.1" xref="alg1.l22.m1.3.3.3.1.cmml">exp</mi><mo id="alg1.l22.m1.4.4.4.2.1a" xref="alg1.l22.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="alg1.l22.m1.4.4.4.2.1.1" xref="alg1.l22.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="alg1.l22.m1.4.4.4.2.1.1.2" xref="alg1.l22.m1.4.4.4.2.2.cmml">(</mo><mrow id="alg1.l22.m1.4.4.4.2.1.1.1" xref="alg1.l22.m1.4.4.4.2.1.1.1.cmml"><mrow id="alg1.l22.m1.4.4.4.2.1.1.1.2" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="alg1.l22.m1.4.4.4.2.1.1.1.2.4" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="alg1.l22.m1.4.4.4.2.1.1.1.2.3" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.3.cmml">​</mo><mrow id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo stretchy="false" id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.3" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msup id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.2" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml">z</mi><mover accent="true" id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.2" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.1" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></msup><mo id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.4" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.3" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">g</mi><mover accent="true" id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml"><mi id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2.cmml">k</mi><mo id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1.cmml">^</mo></mover></msubsup><mo stretchy="false" id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.5" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l22.m1.4.4.4.2.1.1.1.3" xref="alg1.l22.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="alg1.l22.m1.4.4.4.2.1.1.1.4" xref="alg1.l22.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="alg1.l22.m1.4.4.4.2.1.1.3" xref="alg1.l22.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.4b"><apply id="alg1.l22.m1.4.5.cmml" xref="alg1.l22.m1.4.5"><ci id="alg1.l22.m1.4.5.1.cmml" xref="alg1.l22.m1.4.5.1">←</ci><apply id="alg1.l22.m1.4.5.2.cmml" xref="alg1.l22.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l22.m1.4.5.2.1.cmml" xref="alg1.l22.m1.4.5.2">subscript</csymbol><ci id="alg1.l22.m1.4.5.2.2.cmml" xref="alg1.l22.m1.4.5.2.2">𝛼</ci><ci id="alg1.l22.m1.4.5.2.3.cmml" xref="alg1.l22.m1.4.5.2.3">𝑘</ci></apply><apply id="alg1.l22.m1.4.4.cmml" xref="alg1.l22.m1.4.4"><divide id="alg1.l22.m1.4.4.5.cmml" xref="alg1.l22.m1.4.4"></divide><apply id="alg1.l22.m1.2.2.2.3.cmml" xref="alg1.l22.m1.2.2.2.2"><exp id="alg1.l22.m1.1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1.1"></exp><apply id="alg1.l22.m1.2.2.2.2.1.1.cmml" xref="alg1.l22.m1.2.2.2.2.1.1"><divide id="alg1.l22.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.3"></divide><apply id="alg1.l22.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2"><times id="alg1.l22.m1.2.2.2.2.1.1.2.3.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.3"></times><ci id="alg1.l22.m1.2.2.2.2.1.1.2.4a.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.4"><mtext mathsize="70%" id="alg1.l22.m1.2.2.2.2.1.1.2.4.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="alg1.l22.m1.2.2.2.2.1.1.2.2.3.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2"><apply id="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝑧</ci><ci id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="alg1.l22.m1.2.2.2.2.1.1.4.cmml" xref="alg1.l22.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="alg1.l22.m1.4.4.4.cmml" xref="alg1.l22.m1.4.4.4"><apply id="alg1.l22.m1.4.4.4.3.cmml" xref="alg1.l22.m1.4.4.4.3"><csymbol cd="ambiguous" id="alg1.l22.m1.4.4.4.3.1.cmml" xref="alg1.l22.m1.4.4.4.3">superscript</csymbol><apply id="alg1.l22.m1.4.4.4.3.2.cmml" xref="alg1.l22.m1.4.4.4.3"><csymbol cd="ambiguous" id="alg1.l22.m1.4.4.4.3.2.1.cmml" xref="alg1.l22.m1.4.4.4.3">subscript</csymbol><sum id="alg1.l22.m1.4.4.4.3.2.2.cmml" xref="alg1.l22.m1.4.4.4.3.2.2"></sum><apply id="alg1.l22.m1.4.4.4.3.2.3.cmml" xref="alg1.l22.m1.4.4.4.3.2.3"><eq id="alg1.l22.m1.4.4.4.3.2.3.1.cmml" xref="alg1.l22.m1.4.4.4.3.2.3.1"></eq><apply id="alg1.l22.m1.4.4.4.3.2.3.2.cmml" xref="alg1.l22.m1.4.4.4.3.2.3.2"><ci id="alg1.l22.m1.4.4.4.3.2.3.2.1.cmml" xref="alg1.l22.m1.4.4.4.3.2.3.2.1">^</ci><ci id="alg1.l22.m1.4.4.4.3.2.3.2.2.cmml" xref="alg1.l22.m1.4.4.4.3.2.3.2.2">𝑘</ci></apply><cn type="integer" id="alg1.l22.m1.4.4.4.3.2.3.3.cmml" xref="alg1.l22.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="alg1.l22.m1.4.4.4.3.3.cmml" xref="alg1.l22.m1.4.4.4.3.3">𝐾</ci></apply><apply id="alg1.l22.m1.4.4.4.2.2.cmml" xref="alg1.l22.m1.4.4.4.2.1"><exp id="alg1.l22.m1.3.3.3.1.cmml" xref="alg1.l22.m1.3.3.3.1"></exp><apply id="alg1.l22.m1.4.4.4.2.1.1.1.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1"><divide id="alg1.l22.m1.4.4.4.2.1.1.1.3.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.3"></divide><apply id="alg1.l22.m1.4.4.4.2.1.1.1.2.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2"><times id="alg1.l22.m1.4.4.4.2.1.1.1.2.3.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.3"></times><ci id="alg1.l22.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.4"><mtext mathsize="70%" id="alg1.l22.m1.4.4.4.2.1.1.1.2.4.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2"><apply id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.2">𝑧</ci><apply id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3"><ci id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.1">^</ci><ci id="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.1.1.1.1.3.2">𝑘</ci></apply></apply><apply id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝑧</ci><apply id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3"><ci id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1">^</ci><ci id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2">𝑘</ci></apply></apply><ci id="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="alg1.l22.m1.4.4.4.2.1.1.1.4.cmml" xref="alg1.l22.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.4c">\alpha_{k}\leftarrow\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\sum_{\hat{k}=1}^{K}\exp(\text{sim}(z^{\hat{k}},z^{\hat{k}}_{g})/\tau)}</annotation></semantics></math>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>              <math id="alg1.l23.m1.6" class="ltx_Math" alttext="\ell_{k}\leftarrow-\log\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)+\exp(\text{sim}(z^{k},z^{k}_{p})/\tau)}" display="inline"><semantics id="alg1.l23.m1.6a"><mrow id="alg1.l23.m1.6.7" xref="alg1.l23.m1.6.7.cmml"><msub id="alg1.l23.m1.6.7.2" xref="alg1.l23.m1.6.7.2.cmml"><mi mathvariant="normal" id="alg1.l23.m1.6.7.2.2" xref="alg1.l23.m1.6.7.2.2.cmml">ℓ</mi><mi id="alg1.l23.m1.6.7.2.3" xref="alg1.l23.m1.6.7.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l23.m1.6.7.1" xref="alg1.l23.m1.6.7.1.cmml">←</mo><mrow id="alg1.l23.m1.6.7.3" xref="alg1.l23.m1.6.7.3.cmml"><mo rspace="0.167em" id="alg1.l23.m1.6.7.3a" xref="alg1.l23.m1.6.7.3.cmml">−</mo><mrow id="alg1.l23.m1.6.7.3.2" xref="alg1.l23.m1.6.7.3.2.cmml"><mi id="alg1.l23.m1.6.7.3.2.1" xref="alg1.l23.m1.6.7.3.2.1.cmml">log</mi><mo lspace="0.167em" id="alg1.l23.m1.6.7.3.2a" xref="alg1.l23.m1.6.7.3.2.cmml">⁡</mo><mfrac id="alg1.l23.m1.6.6" xref="alg1.l23.m1.6.6.cmml"><mrow id="alg1.l23.m1.2.2.2.2" xref="alg1.l23.m1.2.2.2.3.cmml"><mi id="alg1.l23.m1.1.1.1.1" xref="alg1.l23.m1.1.1.1.1.cmml">exp</mi><mo id="alg1.l23.m1.2.2.2.2a" xref="alg1.l23.m1.2.2.2.3.cmml">⁡</mo><mrow id="alg1.l23.m1.2.2.2.2.1" xref="alg1.l23.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l23.m1.2.2.2.2.1.2" xref="alg1.l23.m1.2.2.2.3.cmml">(</mo><mrow id="alg1.l23.m1.2.2.2.2.1.1" xref="alg1.l23.m1.2.2.2.2.1.1.cmml"><mrow id="alg1.l23.m1.2.2.2.2.1.1.2" xref="alg1.l23.m1.2.2.2.2.1.1.2.cmml"><mtext id="alg1.l23.m1.2.2.2.2.1.1.2.4" xref="alg1.l23.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="alg1.l23.m1.2.2.2.2.1.1.2.3" xref="alg1.l23.m1.2.2.2.2.1.1.2.3.cmml">​</mo><mrow id="alg1.l23.m1.2.2.2.2.1.1.2.2.2" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.3" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msup id="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1" xref="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.2" xref="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.3" xref="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.4" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.2" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.3" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">g</mi><mi id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.3" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.5" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l23.m1.2.2.2.2.1.1.3" xref="alg1.l23.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="alg1.l23.m1.2.2.2.2.1.1.4" xref="alg1.l23.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="alg1.l23.m1.2.2.2.2.1.3" xref="alg1.l23.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="alg1.l23.m1.6.6.6" xref="alg1.l23.m1.6.6.6.cmml"><mrow id="alg1.l23.m1.5.5.5.3.1" xref="alg1.l23.m1.5.5.5.3.2.cmml"><mi id="alg1.l23.m1.3.3.3.1" xref="alg1.l23.m1.3.3.3.1.cmml">exp</mi><mo id="alg1.l23.m1.5.5.5.3.1a" xref="alg1.l23.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="alg1.l23.m1.5.5.5.3.1.1" xref="alg1.l23.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="alg1.l23.m1.5.5.5.3.1.1.2" xref="alg1.l23.m1.5.5.5.3.2.cmml">(</mo><mrow id="alg1.l23.m1.5.5.5.3.1.1.1" xref="alg1.l23.m1.5.5.5.3.1.1.1.cmml"><mrow id="alg1.l23.m1.5.5.5.3.1.1.1.2" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.cmml"><mtext id="alg1.l23.m1.5.5.5.3.1.1.1.2.4" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="alg1.l23.m1.5.5.5.3.1.1.1.2.3" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.3.cmml">​</mo><mrow id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.3" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.3.cmml">(</mo><msup id="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1" xref="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.cmml"><mi id="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.2" xref="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.3" xref="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.4" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.3.cmml">,</mo><msubsup id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.cmml"><mi id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.2" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.3" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.3.cmml">g</mi><mi id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.3" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.5" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l23.m1.5.5.5.3.1.1.1.3" xref="alg1.l23.m1.5.5.5.3.1.1.1.3.cmml">/</mo><mi id="alg1.l23.m1.5.5.5.3.1.1.1.4" xref="alg1.l23.m1.5.5.5.3.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="alg1.l23.m1.5.5.5.3.1.1.3" xref="alg1.l23.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow><mo id="alg1.l23.m1.6.6.6.5" xref="alg1.l23.m1.6.6.6.5.cmml">+</mo><mrow id="alg1.l23.m1.6.6.6.4.1" xref="alg1.l23.m1.6.6.6.4.2.cmml"><mi id="alg1.l23.m1.4.4.4.2" xref="alg1.l23.m1.4.4.4.2.cmml">exp</mi><mo id="alg1.l23.m1.6.6.6.4.1a" xref="alg1.l23.m1.6.6.6.4.2.cmml">⁡</mo><mrow id="alg1.l23.m1.6.6.6.4.1.1" xref="alg1.l23.m1.6.6.6.4.2.cmml"><mo stretchy="false" id="alg1.l23.m1.6.6.6.4.1.1.2" xref="alg1.l23.m1.6.6.6.4.2.cmml">(</mo><mrow id="alg1.l23.m1.6.6.6.4.1.1.1" xref="alg1.l23.m1.6.6.6.4.1.1.1.cmml"><mrow id="alg1.l23.m1.6.6.6.4.1.1.1.2" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.cmml"><mtext id="alg1.l23.m1.6.6.6.4.1.1.1.2.4" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="alg1.l23.m1.6.6.6.4.1.1.1.2.3" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.3.cmml">​</mo><mrow id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.3.cmml"><mo stretchy="false" id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.3" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.3.cmml">(</mo><msup id="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1" xref="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.cmml"><mi id="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.2" xref="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.3" xref="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.4" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.3.cmml">,</mo><msubsup id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.cmml"><mi id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.2" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.3" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.3.cmml">p</mi><mi id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.3" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.5" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l23.m1.6.6.6.4.1.1.1.3" xref="alg1.l23.m1.6.6.6.4.1.1.1.3.cmml">/</mo><mi id="alg1.l23.m1.6.6.6.4.1.1.1.4" xref="alg1.l23.m1.6.6.6.4.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="alg1.l23.m1.6.6.6.4.1.1.3" xref="alg1.l23.m1.6.6.6.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.6b"><apply id="alg1.l23.m1.6.7.cmml" xref="alg1.l23.m1.6.7"><ci id="alg1.l23.m1.6.7.1.cmml" xref="alg1.l23.m1.6.7.1">←</ci><apply id="alg1.l23.m1.6.7.2.cmml" xref="alg1.l23.m1.6.7.2"><csymbol cd="ambiguous" id="alg1.l23.m1.6.7.2.1.cmml" xref="alg1.l23.m1.6.7.2">subscript</csymbol><ci id="alg1.l23.m1.6.7.2.2.cmml" xref="alg1.l23.m1.6.7.2.2">ℓ</ci><ci id="alg1.l23.m1.6.7.2.3.cmml" xref="alg1.l23.m1.6.7.2.3">𝑘</ci></apply><apply id="alg1.l23.m1.6.7.3.cmml" xref="alg1.l23.m1.6.7.3"><minus id="alg1.l23.m1.6.7.3.1.cmml" xref="alg1.l23.m1.6.7.3"></minus><apply id="alg1.l23.m1.6.7.3.2.cmml" xref="alg1.l23.m1.6.7.3.2"><log id="alg1.l23.m1.6.7.3.2.1.cmml" xref="alg1.l23.m1.6.7.3.2.1"></log><apply id="alg1.l23.m1.6.6.cmml" xref="alg1.l23.m1.6.6"><divide id="alg1.l23.m1.6.6.7.cmml" xref="alg1.l23.m1.6.6"></divide><apply id="alg1.l23.m1.2.2.2.3.cmml" xref="alg1.l23.m1.2.2.2.2"><exp id="alg1.l23.m1.1.1.1.1.cmml" xref="alg1.l23.m1.1.1.1.1"></exp><apply id="alg1.l23.m1.2.2.2.2.1.1.cmml" xref="alg1.l23.m1.2.2.2.2.1.1"><divide id="alg1.l23.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.3"></divide><apply id="alg1.l23.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2"><times id="alg1.l23.m1.2.2.2.2.1.1.2.3.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.3"></times><ci id="alg1.l23.m1.2.2.2.2.1.1.2.4a.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.4"><mtext mathsize="70%" id="alg1.l23.m1.2.2.2.2.1.1.2.4.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="alg1.l23.m1.2.2.2.2.1.1.2.2.3.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2"><apply id="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝑧</ci><ci id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="alg1.l23.m1.2.2.2.2.1.1.4.cmml" xref="alg1.l23.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="alg1.l23.m1.6.6.6.cmml" xref="alg1.l23.m1.6.6.6"><plus id="alg1.l23.m1.6.6.6.5.cmml" xref="alg1.l23.m1.6.6.6.5"></plus><apply id="alg1.l23.m1.5.5.5.3.2.cmml" xref="alg1.l23.m1.5.5.5.3.1"><exp id="alg1.l23.m1.3.3.3.1.cmml" xref="alg1.l23.m1.3.3.3.1"></exp><apply id="alg1.l23.m1.5.5.5.3.1.1.1.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1"><divide id="alg1.l23.m1.5.5.5.3.1.1.1.3.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.3"></divide><apply id="alg1.l23.m1.5.5.5.3.1.1.1.2.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2"><times id="alg1.l23.m1.5.5.5.3.1.1.1.2.3.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.3"></times><ci id="alg1.l23.m1.5.5.5.3.1.1.1.2.4a.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.4"><mtext mathsize="70%" id="alg1.l23.m1.5.5.5.3.1.1.1.2.4.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.3.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2"><apply id="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.1.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2">subscript</csymbol><apply id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.1.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.2">𝑧</ci><ci id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.3.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.3.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="alg1.l23.m1.5.5.5.3.1.1.1.4.cmml" xref="alg1.l23.m1.5.5.5.3.1.1.1.4">𝜏</ci></apply></apply><apply id="alg1.l23.m1.6.6.6.4.2.cmml" xref="alg1.l23.m1.6.6.6.4.1"><exp id="alg1.l23.m1.4.4.4.2.cmml" xref="alg1.l23.m1.4.4.4.2"></exp><apply id="alg1.l23.m1.6.6.6.4.1.1.1.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1"><divide id="alg1.l23.m1.6.6.6.4.1.1.1.3.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.3"></divide><apply id="alg1.l23.m1.6.6.6.4.1.1.1.2.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2"><times id="alg1.l23.m1.6.6.6.4.1.1.1.2.3.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.3"></times><ci id="alg1.l23.m1.6.6.6.4.1.1.1.2.4a.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.4"><mtext mathsize="70%" id="alg1.l23.m1.6.6.6.4.1.1.1.2.4.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.3.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2"><apply id="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.1.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2">subscript</csymbol><apply id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.1.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2">superscript</csymbol><ci id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.2">𝑧</ci><ci id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.3.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.3.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.2.2.2.2.3">𝑝</ci></apply></interval></apply><ci id="alg1.l23.m1.6.6.6.4.1.1.1.4.cmml" xref="alg1.l23.m1.6.6.6.4.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.6c">\ell_{k}\leftarrow-\log\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)+\exp(\text{sim}(z^{k},z^{k}_{p})/\tau)}</annotation></semantics></math>
         
</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>         <math id="alg1.l24.m1.1" class="ltx_Math" alttext="\mathcal{L}\leftarrow\ell_{sup}+\mu\sum^{K}_{k=1}\alpha_{k}\ell_{k}" display="inline"><semantics id="alg1.l24.m1.1a"><mrow id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">ℒ</mi><mo stretchy="false" id="alg1.l24.m1.1.1.1" xref="alg1.l24.m1.1.1.1.cmml">←</mo><mrow id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3.cmml"><msub id="alg1.l24.m1.1.1.3.2" xref="alg1.l24.m1.1.1.3.2.cmml"><mi mathvariant="normal" id="alg1.l24.m1.1.1.3.2.2" xref="alg1.l24.m1.1.1.3.2.2.cmml">ℓ</mi><mrow id="alg1.l24.m1.1.1.3.2.3" xref="alg1.l24.m1.1.1.3.2.3.cmml"><mi id="alg1.l24.m1.1.1.3.2.3.2" xref="alg1.l24.m1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.1.1.3.2.3.1" xref="alg1.l24.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg1.l24.m1.1.1.3.2.3.3" xref="alg1.l24.m1.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.1.1.3.2.3.1a" xref="alg1.l24.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg1.l24.m1.1.1.3.2.3.4" xref="alg1.l24.m1.1.1.3.2.3.4.cmml">p</mi></mrow></msub><mo id="alg1.l24.m1.1.1.3.1" xref="alg1.l24.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l24.m1.1.1.3.3" xref="alg1.l24.m1.1.1.3.3.cmml"><mi id="alg1.l24.m1.1.1.3.3.2" xref="alg1.l24.m1.1.1.3.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="alg1.l24.m1.1.1.3.3.1" xref="alg1.l24.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l24.m1.1.1.3.3.3" xref="alg1.l24.m1.1.1.3.3.3.cmml"><msubsup id="alg1.l24.m1.1.1.3.3.3.1" xref="alg1.l24.m1.1.1.3.3.3.1.cmml"><mo id="alg1.l24.m1.1.1.3.3.3.1.2.2" xref="alg1.l24.m1.1.1.3.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l24.m1.1.1.3.3.3.1.3" xref="alg1.l24.m1.1.1.3.3.3.1.3.cmml"><mi id="alg1.l24.m1.1.1.3.3.3.1.3.2" xref="alg1.l24.m1.1.1.3.3.3.1.3.2.cmml">k</mi><mo id="alg1.l24.m1.1.1.3.3.3.1.3.1" xref="alg1.l24.m1.1.1.3.3.3.1.3.1.cmml">=</mo><mn id="alg1.l24.m1.1.1.3.3.3.1.3.3" xref="alg1.l24.m1.1.1.3.3.3.1.3.3.cmml">1</mn></mrow><mi id="alg1.l24.m1.1.1.3.3.3.1.2.3" xref="alg1.l24.m1.1.1.3.3.3.1.2.3.cmml">K</mi></msubsup><mrow id="alg1.l24.m1.1.1.3.3.3.2" xref="alg1.l24.m1.1.1.3.3.3.2.cmml"><msub id="alg1.l24.m1.1.1.3.3.3.2.2" xref="alg1.l24.m1.1.1.3.3.3.2.2.cmml"><mi id="alg1.l24.m1.1.1.3.3.3.2.2.2" xref="alg1.l24.m1.1.1.3.3.3.2.2.2.cmml">α</mi><mi id="alg1.l24.m1.1.1.3.3.3.2.2.3" xref="alg1.l24.m1.1.1.3.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l24.m1.1.1.3.3.3.2.1" xref="alg1.l24.m1.1.1.3.3.3.2.1.cmml">​</mo><msub id="alg1.l24.m1.1.1.3.3.3.2.3" xref="alg1.l24.m1.1.1.3.3.3.2.3.cmml"><mi mathvariant="normal" id="alg1.l24.m1.1.1.3.3.3.2.3.2" xref="alg1.l24.m1.1.1.3.3.3.2.3.2.cmml">ℓ</mi><mi id="alg1.l24.m1.1.1.3.3.3.2.3.3" xref="alg1.l24.m1.1.1.3.3.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><ci id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1">←</ci><ci id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">ℒ</ci><apply id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3"><plus id="alg1.l24.m1.1.1.3.1.cmml" xref="alg1.l24.m1.1.1.3.1"></plus><apply id="alg1.l24.m1.1.1.3.2.cmml" xref="alg1.l24.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.2.1.cmml" xref="alg1.l24.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l24.m1.1.1.3.2.2.cmml" xref="alg1.l24.m1.1.1.3.2.2">ℓ</ci><apply id="alg1.l24.m1.1.1.3.2.3.cmml" xref="alg1.l24.m1.1.1.3.2.3"><times id="alg1.l24.m1.1.1.3.2.3.1.cmml" xref="alg1.l24.m1.1.1.3.2.3.1"></times><ci id="alg1.l24.m1.1.1.3.2.3.2.cmml" xref="alg1.l24.m1.1.1.3.2.3.2">𝑠</ci><ci id="alg1.l24.m1.1.1.3.2.3.3.cmml" xref="alg1.l24.m1.1.1.3.2.3.3">𝑢</ci><ci id="alg1.l24.m1.1.1.3.2.3.4.cmml" xref="alg1.l24.m1.1.1.3.2.3.4">𝑝</ci></apply></apply><apply id="alg1.l24.m1.1.1.3.3.cmml" xref="alg1.l24.m1.1.1.3.3"><times id="alg1.l24.m1.1.1.3.3.1.cmml" xref="alg1.l24.m1.1.1.3.3.1"></times><ci id="alg1.l24.m1.1.1.3.3.2.cmml" xref="alg1.l24.m1.1.1.3.3.2">𝜇</ci><apply id="alg1.l24.m1.1.1.3.3.3.cmml" xref="alg1.l24.m1.1.1.3.3.3"><apply id="alg1.l24.m1.1.1.3.3.3.1.cmml" xref="alg1.l24.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.3.3.1.1.cmml" xref="alg1.l24.m1.1.1.3.3.3.1">subscript</csymbol><apply id="alg1.l24.m1.1.1.3.3.3.1.2.cmml" xref="alg1.l24.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.3.3.1.2.1.cmml" xref="alg1.l24.m1.1.1.3.3.3.1">superscript</csymbol><sum id="alg1.l24.m1.1.1.3.3.3.1.2.2.cmml" xref="alg1.l24.m1.1.1.3.3.3.1.2.2"></sum><ci id="alg1.l24.m1.1.1.3.3.3.1.2.3.cmml" xref="alg1.l24.m1.1.1.3.3.3.1.2.3">𝐾</ci></apply><apply id="alg1.l24.m1.1.1.3.3.3.1.3.cmml" xref="alg1.l24.m1.1.1.3.3.3.1.3"><eq id="alg1.l24.m1.1.1.3.3.3.1.3.1.cmml" xref="alg1.l24.m1.1.1.3.3.3.1.3.1"></eq><ci id="alg1.l24.m1.1.1.3.3.3.1.3.2.cmml" xref="alg1.l24.m1.1.1.3.3.3.1.3.2">𝑘</ci><cn type="integer" id="alg1.l24.m1.1.1.3.3.3.1.3.3.cmml" xref="alg1.l24.m1.1.1.3.3.3.1.3.3">1</cn></apply></apply><apply id="alg1.l24.m1.1.1.3.3.3.2.cmml" xref="alg1.l24.m1.1.1.3.3.3.2"><times id="alg1.l24.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.1"></times><apply id="alg1.l24.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.3.3.2.2.1.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.2">subscript</csymbol><ci id="alg1.l24.m1.1.1.3.3.3.2.2.2.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.2.2">𝛼</ci><ci id="alg1.l24.m1.1.1.3.3.3.2.2.3.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.2.3">𝑘</ci></apply><apply id="alg1.l24.m1.1.1.3.3.3.2.3.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.3.3.2.3.1.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.3">subscript</csymbol><ci id="alg1.l24.m1.1.1.3.3.3.2.3.2.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.3.2">ℓ</ci><ci id="alg1.l24.m1.1.1.3.3.3.2.3.3.cmml" xref="alg1.l24.m1.1.1.3.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">\mathcal{L}\leftarrow\ell_{sup}+\mu\sum^{K}_{k=1}\alpha_{k}\ell_{k}</annotation></semantics></math>

</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>         <math id="alg1.l25.m1.1" class="ltx_Math" alttext="w^{t}_{i}\leftarrow w^{t}_{i}-\eta\nabla\mathcal{L}" display="inline"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml"><msubsup id="alg1.l25.m1.1.1.2" xref="alg1.l25.m1.1.1.2.cmml"><mi id="alg1.l25.m1.1.1.2.2.2" xref="alg1.l25.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l25.m1.1.1.2.3" xref="alg1.l25.m1.1.1.2.3.cmml">i</mi><mi id="alg1.l25.m1.1.1.2.2.3" xref="alg1.l25.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l25.m1.1.1.1" xref="alg1.l25.m1.1.1.1.cmml">←</mo><mrow id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml"><msubsup id="alg1.l25.m1.1.1.3.2" xref="alg1.l25.m1.1.1.3.2.cmml"><mi id="alg1.l25.m1.1.1.3.2.2.2" xref="alg1.l25.m1.1.1.3.2.2.2.cmml">w</mi><mi id="alg1.l25.m1.1.1.3.2.3" xref="alg1.l25.m1.1.1.3.2.3.cmml">i</mi><mi id="alg1.l25.m1.1.1.3.2.2.3" xref="alg1.l25.m1.1.1.3.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l25.m1.1.1.3.1" xref="alg1.l25.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l25.m1.1.1.3.3" xref="alg1.l25.m1.1.1.3.3.cmml"><mi id="alg1.l25.m1.1.1.3.3.2" xref="alg1.l25.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l25.m1.1.1.3.3.1" xref="alg1.l25.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l25.m1.1.1.3.3.3" xref="alg1.l25.m1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l25.m1.1.1.3.3.3.1" xref="alg1.l25.m1.1.1.3.3.3.1.cmml">∇</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l25.m1.1.1.3.3.3.2" xref="alg1.l25.m1.1.1.3.3.3.2.cmml">ℒ</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1"><ci id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1">←</ci><apply id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.2">subscript</csymbol><apply id="alg1.l25.m1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.2.2.1.cmml" xref="alg1.l25.m1.1.1.2">superscript</csymbol><ci id="alg1.l25.m1.1.1.2.2.2.cmml" xref="alg1.l25.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l25.m1.1.1.2.2.3.cmml" xref="alg1.l25.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l25.m1.1.1.2.3.cmml" xref="alg1.l25.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3"><minus id="alg1.l25.m1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.3.1"></minus><apply id="alg1.l25.m1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.2.1.cmml" xref="alg1.l25.m1.1.1.3.2">subscript</csymbol><apply id="alg1.l25.m1.1.1.3.2.2.cmml" xref="alg1.l25.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.3.2.2.1.cmml" xref="alg1.l25.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l25.m1.1.1.3.2.2.2.cmml" xref="alg1.l25.m1.1.1.3.2.2.2">𝑤</ci><ci id="alg1.l25.m1.1.1.3.2.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="alg1.l25.m1.1.1.3.2.3.cmml" xref="alg1.l25.m1.1.1.3.2.3">𝑖</ci></apply><apply id="alg1.l25.m1.1.1.3.3.cmml" xref="alg1.l25.m1.1.1.3.3"><times id="alg1.l25.m1.1.1.3.3.1.cmml" xref="alg1.l25.m1.1.1.3.3.1"></times><ci id="alg1.l25.m1.1.1.3.3.2.cmml" xref="alg1.l25.m1.1.1.3.3.2">𝜂</ci><apply id="alg1.l25.m1.1.1.3.3.3.cmml" xref="alg1.l25.m1.1.1.3.3.3"><ci id="alg1.l25.m1.1.1.3.3.3.1.cmml" xref="alg1.l25.m1.1.1.3.3.3.1">∇</ci><ci id="alg1.l25.m1.1.1.3.3.3.2.cmml" xref="alg1.l25.m1.1.1.3.3.3.2">ℒ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">w^{t}_{i}\leftarrow w^{t}_{i}-\eta\nabla\mathcal{L}</annotation></semantics></math>
     
</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span>return <math id="alg1.l26.m1.1" class="ltx_Math" alttext="w^{t}_{i}" display="inline"><semantics id="alg1.l26.m1.1a"><msubsup id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml"><mi id="alg1.l26.m1.1.1.2.2" xref="alg1.l26.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l26.m1.1.1.3" xref="alg1.l26.m1.1.1.3.cmml">i</mi><mi id="alg1.l26.m1.1.1.2.3" xref="alg1.l26.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><apply id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.cmml" xref="alg1.l26.m1.1.1">subscript</csymbol><apply id="alg1.l26.m1.1.1.2.cmml" xref="alg1.l26.m1.1.1"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.2.1.cmml" xref="alg1.l26.m1.1.1">superscript</csymbol><ci id="alg1.l26.m1.1.1.2.2.cmml" xref="alg1.l26.m1.1.1.2.2">𝑤</ci><ci id="alg1.l26.m1.1.1.2.3.cmml" xref="alg1.l26.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l26.m1.1.1.3.cmml" xref="alg1.l26.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">w^{t}_{i}</annotation></semantics></math>

</div>
</div>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Method</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Federated Learning Objective</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The goal of a federated learning system is to train a global model <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑤</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">w_{g}</annotation></semantics></math> by solving:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="w_{g}^{*}=\operatorname*{arg\,min}_{w_{g}}\sum_{i=1}^{N}\frac{|\mathcal{D}_{i}|}{\mathcal{|D|}}\mathcal{L}_{i}(w_{g})," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msubsup id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.cmml">w</mi><mi id="S3.E1.m1.3.3.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">g</mi><mo id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3.cmml">∗</mo></msubsup><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><munder id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.3.2.1.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.1.3.2.3.cmml">min</mi></mrow><msub id="S3.E1.m1.3.3.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.1.3.3.2.cmml">w</mi><mi id="S3.E1.m1.3.3.1.1.1.3.3.3" xref="S3.E1.m1.3.3.1.1.1.3.3.3.cmml">g</mi></msub></munder><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.3.3.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.3.1" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.1" xref="S3.E1.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E1.m1.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2">𝑤</ci><ci id="S3.E1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3">𝑔</ci></apply><times id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3"></times></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.3.2"><times id="S3.E1.m1.3.3.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3.2.1"></times><ci id="S3.E1.m1.3.3.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.3.2.2">arg</ci><ci id="S3.E1.m1.3.3.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.2.3">min</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3.2">𝑤</ci><ci id="S3.E1.m1.3.3.1.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3.3">𝑔</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E1.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2"></abs><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.3"><abs id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.3.1"></abs><ci id="S3.E1.m1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">𝑔</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">w_{g}^{*}=\operatorname*{arg\,min}_{w_{g}}\sum_{i=1}^{N}\frac{|\mathcal{D}_{i}|}{\mathcal{|D|}}\mathcal{L}_{i}(w_{g}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.8" class="ltx_p">where <math id="S3.SS1.p1.2.m1.1" class="ltx_Math" alttext="\mathcal{L}_{i}" display="inline"><semantics id="S3.SS1.p1.2.m1.1a"><msub id="S3.SS1.p1.2.m1.1.1" xref="S3.SS1.p1.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m1.1.1.2" xref="S3.SS1.p1.2.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS1.p1.2.m1.1.1.3" xref="S3.SS1.p1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.1b"><apply id="S3.SS1.p1.2.m1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m1.1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m1.1.1.2.cmml" xref="S3.SS1.p1.2.m1.1.1.2">ℒ</ci><ci id="S3.SS1.p1.2.m1.1.1.3.cmml" xref="S3.SS1.p1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.1c">\mathcal{L}_{i}</annotation></semantics></math> and <math id="S3.SS1.p1.3.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.3.m2.1a"><msub id="S3.SS1.p1.3.m2.1.1" xref="S3.SS1.p1.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m2.1.1.2" xref="S3.SS1.p1.3.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.3.m2.1.1.3" xref="S3.SS1.p1.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m2.1b"><apply id="S3.SS1.p1.3.m2.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m2.1.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m2.1.1.2.cmml" xref="S3.SS1.p1.3.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p1.3.m2.1.1.3.cmml" xref="S3.SS1.p1.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m2.1c">\mathcal{D}_{i}</annotation></semantics></math> represent the local loss and the dataset of the <math id="S3.SS1.p1.4.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.4.m3.1a"><mi id="S3.SS1.p1.4.m3.1.1" xref="S3.SS1.p1.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m3.1b"><ci id="S3.SS1.p1.4.m3.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m3.1c">i</annotation></semantics></math>-th client, <math id="S3.SS1.p1.5.m4.2" class="ltx_Math" alttext="|\mathcal{D}|=\sum_{i=1}^{N}|\mathcal{D}_{i}|" display="inline"><semantics id="S3.SS1.p1.5.m4.2a"><mrow id="S3.SS1.p1.5.m4.2.2" xref="S3.SS1.p1.5.m4.2.2.cmml"><mrow id="S3.SS1.p1.5.m4.2.2.3.2" xref="S3.SS1.p1.5.m4.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m4.2.2.3.2.1" xref="S3.SS1.p1.5.m4.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m4.1.1" xref="S3.SS1.p1.5.m4.1.1.cmml">𝒟</mi><mo stretchy="false" id="S3.SS1.p1.5.m4.2.2.3.2.2" xref="S3.SS1.p1.5.m4.2.2.3.1.1.cmml">|</mo></mrow><mo rspace="0.111em" id="S3.SS1.p1.5.m4.2.2.2" xref="S3.SS1.p1.5.m4.2.2.2.cmml">=</mo><mrow id="S3.SS1.p1.5.m4.2.2.1" xref="S3.SS1.p1.5.m4.2.2.1.cmml"><msubsup id="S3.SS1.p1.5.m4.2.2.1.2" xref="S3.SS1.p1.5.m4.2.2.1.2.cmml"><mo rspace="0em" id="S3.SS1.p1.5.m4.2.2.1.2.2.2" xref="S3.SS1.p1.5.m4.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.5.m4.2.2.1.2.2.3" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3.cmml"><mi id="S3.SS1.p1.5.m4.2.2.1.2.2.3.2" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3.2.cmml">i</mi><mo id="S3.SS1.p1.5.m4.2.2.1.2.2.3.1" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.5.m4.2.2.1.2.2.3.3" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.5.m4.2.2.1.2.3" xref="S3.SS1.p1.5.m4.2.2.1.2.3.cmml">N</mi></msubsup><mrow id="S3.SS1.p1.5.m4.2.2.1.1.1" xref="S3.SS1.p1.5.m4.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m4.2.2.1.1.1.2" xref="S3.SS1.p1.5.m4.2.2.1.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.5.m4.2.2.1.1.1.1" xref="S3.SS1.p1.5.m4.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m4.2.2.1.1.1.1.2" xref="S3.SS1.p1.5.m4.2.2.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.5.m4.2.2.1.1.1.1.3" xref="S3.SS1.p1.5.m4.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.5.m4.2.2.1.1.1.3" xref="S3.SS1.p1.5.m4.2.2.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m4.2b"><apply id="S3.SS1.p1.5.m4.2.2.cmml" xref="S3.SS1.p1.5.m4.2.2"><eq id="S3.SS1.p1.5.m4.2.2.2.cmml" xref="S3.SS1.p1.5.m4.2.2.2"></eq><apply id="S3.SS1.p1.5.m4.2.2.3.1.cmml" xref="S3.SS1.p1.5.m4.2.2.3.2"><abs id="S3.SS1.p1.5.m4.2.2.3.1.1.cmml" xref="S3.SS1.p1.5.m4.2.2.3.2.1"></abs><ci id="S3.SS1.p1.5.m4.1.1.cmml" xref="S3.SS1.p1.5.m4.1.1">𝒟</ci></apply><apply id="S3.SS1.p1.5.m4.2.2.1.cmml" xref="S3.SS1.p1.5.m4.2.2.1"><apply id="S3.SS1.p1.5.m4.2.2.1.2.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m4.2.2.1.2.1.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2">superscript</csymbol><apply id="S3.SS1.p1.5.m4.2.2.1.2.2.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m4.2.2.1.2.2.1.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2">subscript</csymbol><sum id="S3.SS1.p1.5.m4.2.2.1.2.2.2.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2.2.2"></sum><apply id="S3.SS1.p1.5.m4.2.2.1.2.2.3.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3"><eq id="S3.SS1.p1.5.m4.2.2.1.2.2.3.1.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3.1"></eq><ci id="S3.SS1.p1.5.m4.2.2.1.2.2.3.2.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.5.m4.2.2.1.2.2.3.3.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.5.m4.2.2.1.2.3.cmml" xref="S3.SS1.p1.5.m4.2.2.1.2.3">𝑁</ci></apply><apply id="S3.SS1.p1.5.m4.2.2.1.1.2.cmml" xref="S3.SS1.p1.5.m4.2.2.1.1.1"><abs id="S3.SS1.p1.5.m4.2.2.1.1.2.1.cmml" xref="S3.SS1.p1.5.m4.2.2.1.1.1.2"></abs><apply id="S3.SS1.p1.5.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.5.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m4.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m4.2.2.1.1.1.1.2">𝒟</ci><ci id="S3.SS1.p1.5.m4.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m4.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m4.2c">|\mathcal{D}|=\sum_{i=1}^{N}|\mathcal{D}_{i}|</annotation></semantics></math> and <math id="S3.SS1.p1.6.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.6.m5.1a"><mi id="S3.SS1.p1.6.m5.1.1" xref="S3.SS1.p1.6.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m5.1b"><ci id="S3.SS1.p1.6.m5.1.1.cmml" xref="S3.SS1.p1.6.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m5.1c">N</annotation></semantics></math> is the total number of clients. From Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we can observe that FedIntR only modifies the local training process of vanilla FedAvg, similar to MOON and FedCKA. In addition to the cross entropy loss, FedIntR adds a regularization term computed with the help of intermediate representations from the global model <math id="S3.SS1.p1.7.m6.1" class="ltx_Math" alttext="w_{g}^{t}" display="inline"><semantics id="S3.SS1.p1.7.m6.1a"><msubsup id="S3.SS1.p1.7.m6.1.1" xref="S3.SS1.p1.7.m6.1.1.cmml"><mi id="S3.SS1.p1.7.m6.1.1.2.2" xref="S3.SS1.p1.7.m6.1.1.2.2.cmml">w</mi><mi id="S3.SS1.p1.7.m6.1.1.2.3" xref="S3.SS1.p1.7.m6.1.1.2.3.cmml">g</mi><mi id="S3.SS1.p1.7.m6.1.1.3" xref="S3.SS1.p1.7.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m6.1b"><apply id="S3.SS1.p1.7.m6.1.1.cmml" xref="S3.SS1.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m6.1.1.1.cmml" xref="S3.SS1.p1.7.m6.1.1">superscript</csymbol><apply id="S3.SS1.p1.7.m6.1.1.2.cmml" xref="S3.SS1.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m6.1.1.2.1.cmml" xref="S3.SS1.p1.7.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m6.1.1.2.2.cmml" xref="S3.SS1.p1.7.m6.1.1.2.2">𝑤</ci><ci id="S3.SS1.p1.7.m6.1.1.2.3.cmml" xref="S3.SS1.p1.7.m6.1.1.2.3">𝑔</ci></apply><ci id="S3.SS1.p1.7.m6.1.1.3.cmml" xref="S3.SS1.p1.7.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m6.1c">w_{g}^{t}</annotation></semantics></math> and the old local model <math id="S3.SS1.p1.8.m7.1" class="ltx_Math" alttext="w_{i}^{t-1}" display="inline"><semantics id="S3.SS1.p1.8.m7.1a"><msubsup id="S3.SS1.p1.8.m7.1.1" xref="S3.SS1.p1.8.m7.1.1.cmml"><mi id="S3.SS1.p1.8.m7.1.1.2.2" xref="S3.SS1.p1.8.m7.1.1.2.2.cmml">w</mi><mi id="S3.SS1.p1.8.m7.1.1.2.3" xref="S3.SS1.p1.8.m7.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.p1.8.m7.1.1.3" xref="S3.SS1.p1.8.m7.1.1.3.cmml"><mi id="S3.SS1.p1.8.m7.1.1.3.2" xref="S3.SS1.p1.8.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.8.m7.1.1.3.1" xref="S3.SS1.p1.8.m7.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.8.m7.1.1.3.3" xref="S3.SS1.p1.8.m7.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m7.1b"><apply id="S3.SS1.p1.8.m7.1.1.cmml" xref="S3.SS1.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m7.1.1.1.cmml" xref="S3.SS1.p1.8.m7.1.1">superscript</csymbol><apply id="S3.SS1.p1.8.m7.1.1.2.cmml" xref="S3.SS1.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m7.1.1.2.1.cmml" xref="S3.SS1.p1.8.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m7.1.1.2.2.cmml" xref="S3.SS1.p1.8.m7.1.1.2.2">𝑤</ci><ci id="S3.SS1.p1.8.m7.1.1.2.3.cmml" xref="S3.SS1.p1.8.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.8.m7.1.1.3.cmml" xref="S3.SS1.p1.8.m7.1.1.3"><minus id="S3.SS1.p1.8.m7.1.1.3.1.cmml" xref="S3.SS1.p1.8.m7.1.1.3.1"></minus><ci id="S3.SS1.p1.8.m7.1.1.3.2.cmml" xref="S3.SS1.p1.8.m7.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS1.p1.8.m7.1.1.3.3.cmml" xref="S3.SS1.p1.8.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m7.1c">w_{i}^{t-1}</annotation></semantics></math> from the previous round.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Local Training Process of FedIntR</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.17" class="ltx_p">Fig. <a href="#S1.F2" title="Figure 2 ‣ I Introduction ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates how the local training loss is calculated in our FedIntR framework, while Algorithm <a href="#alg1" title="Algorithm 1 ‣ II-B Tackling Data Heterogeneity ‣ II Background and Related Work ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> describes the whole procedure in detail. The local training process begins with the <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">i</annotation></semantics></math>-th client receiving the global model <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="w_{g}^{t}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msubsup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">g</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">w_{g}^{t}</annotation></semantics></math> from the central server. The client synchronizes the old local model <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="w_{i}^{t-1}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msubsup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.3.m3.1.1.3.1" xref="S3.SS2.p1.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><minus id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.1"></minus><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">w_{i}^{t-1}</annotation></semantics></math> with the current one <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msubsup id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">w_{i}^{t}</annotation></semantics></math> (which we want to train), followed by synchronizing <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msubsup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.5.m5.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">w_{i}^{t}</annotation></semantics></math> with <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="w_{g}^{t}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msubsup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.6.m6.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.2.3.cmml">g</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">w_{g}^{t}</annotation></semantics></math>. Suppose that the deployed model structure contains a total of <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">K</annotation></semantics></math> layers capable of extracting representations (e.g., convolutional or fully connected layers). Given an input <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">x</annotation></semantics></math>, FedIntR extracts representations <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="z^{k}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><msup id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">z</mi><mi id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">𝑧</ci><ci id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">z^{k}</annotation></semantics></math>, <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="z^{k}_{p}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msubsup id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2.2" xref="S3.SS2.p1.10.m10.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">p</mi><mi id="S3.SS2.p1.10.m10.1.1.2.3" xref="S3.SS2.p1.10.m10.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><apply id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.p1.10.m10.1.1">superscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.p1.10.m10.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">z^{k}_{p}</annotation></semantics></math>, and <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="z^{k}_{g}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><msubsup id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2.2" xref="S3.SS2.p1.11.m11.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">g</mi><mi id="S3.SS2.p1.11.m11.1.1.2.3" xref="S3.SS2.p1.11.m11.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><apply id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.2.1.cmml" xref="S3.SS2.p1.11.m11.1.1">superscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.11.m11.1.1.2.3.cmml" xref="S3.SS2.p1.11.m11.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">z^{k}_{g}</annotation></semantics></math> from the <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mi id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">k</annotation></semantics></math>-th layer of the current local model <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><msubsup id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml"><mi id="S3.SS2.p1.13.m13.1.1.2.2" xref="S3.SS2.p1.13.m13.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.13.m13.1.1.2.3" xref="S3.SS2.p1.13.m13.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p1.13.m13.1.1.3" xref="S3.SS2.p1.13.m13.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><apply id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">superscript</csymbol><apply id="S3.SS2.p1.13.m13.1.1.2.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.2.1.cmml" xref="S3.SS2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.2.2.cmml" xref="S3.SS2.p1.13.m13.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.13.m13.1.1.2.3.cmml" xref="S3.SS2.p1.13.m13.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.13.m13.1.1.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">w_{i}^{t}</annotation></semantics></math>, old local model <math id="S3.SS2.p1.14.m14.1" class="ltx_Math" alttext="w_{i}^{t-1}" display="inline"><semantics id="S3.SS2.p1.14.m14.1a"><msubsup id="S3.SS2.p1.14.m14.1.1" xref="S3.SS2.p1.14.m14.1.1.cmml"><mi id="S3.SS2.p1.14.m14.1.1.2.2" xref="S3.SS2.p1.14.m14.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.14.m14.1.1.2.3" xref="S3.SS2.p1.14.m14.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.p1.14.m14.1.1.3" xref="S3.SS2.p1.14.m14.1.1.3.cmml"><mi id="S3.SS2.p1.14.m14.1.1.3.2" xref="S3.SS2.p1.14.m14.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.14.m14.1.1.3.1" xref="S3.SS2.p1.14.m14.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p1.14.m14.1.1.3.3" xref="S3.SS2.p1.14.m14.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m14.1b"><apply id="S3.SS2.p1.14.m14.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m14.1.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1">superscript</csymbol><apply id="S3.SS2.p1.14.m14.1.1.2.cmml" xref="S3.SS2.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m14.1.1.2.1.cmml" xref="S3.SS2.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS2.p1.14.m14.1.1.2.2.cmml" xref="S3.SS2.p1.14.m14.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.14.m14.1.1.2.3.cmml" xref="S3.SS2.p1.14.m14.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.14.m14.1.1.3.cmml" xref="S3.SS2.p1.14.m14.1.1.3"><minus id="S3.SS2.p1.14.m14.1.1.3.1.cmml" xref="S3.SS2.p1.14.m14.1.1.3.1"></minus><ci id="S3.SS2.p1.14.m14.1.1.3.2.cmml" xref="S3.SS2.p1.14.m14.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.14.m14.1.1.3.3.cmml" xref="S3.SS2.p1.14.m14.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m14.1c">w_{i}^{t-1}</annotation></semantics></math>, and global model <math id="S3.SS2.p1.15.m15.1" class="ltx_Math" alttext="w_{g}^{t}" display="inline"><semantics id="S3.SS2.p1.15.m15.1a"><msubsup id="S3.SS2.p1.15.m15.1.1" xref="S3.SS2.p1.15.m15.1.1.cmml"><mi id="S3.SS2.p1.15.m15.1.1.2.2" xref="S3.SS2.p1.15.m15.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.15.m15.1.1.2.3" xref="S3.SS2.p1.15.m15.1.1.2.3.cmml">g</mi><mi id="S3.SS2.p1.15.m15.1.1.3" xref="S3.SS2.p1.15.m15.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m15.1b"><apply id="S3.SS2.p1.15.m15.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m15.1.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1">superscript</csymbol><apply id="S3.SS2.p1.15.m15.1.1.2.cmml" xref="S3.SS2.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m15.1.1.2.1.cmml" xref="S3.SS2.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS2.p1.15.m15.1.1.2.2.cmml" xref="S3.SS2.p1.15.m15.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.15.m15.1.1.2.3.cmml" xref="S3.SS2.p1.15.m15.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.p1.15.m15.1.1.3.cmml" xref="S3.SS2.p1.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m15.1c">w_{g}^{t}</annotation></semantics></math>, respectively. (A representation is obtained by passing the layer output through a projection head <math id="S3.SS2.p1.16.m16.1" class="ltx_Math" alttext="q_{k}" display="inline"><semantics id="S3.SS2.p1.16.m16.1a"><msub id="S3.SS2.p1.16.m16.1.1" xref="S3.SS2.p1.16.m16.1.1.cmml"><mi id="S3.SS2.p1.16.m16.1.1.2" xref="S3.SS2.p1.16.m16.1.1.2.cmml">q</mi><mi id="S3.SS2.p1.16.m16.1.1.3" xref="S3.SS2.p1.16.m16.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m16.1b"><apply id="S3.SS2.p1.16.m16.1.1.cmml" xref="S3.SS2.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.16.m16.1.1.1.cmml" xref="S3.SS2.p1.16.m16.1.1">subscript</csymbol><ci id="S3.SS2.p1.16.m16.1.1.2.cmml" xref="S3.SS2.p1.16.m16.1.1.2">𝑞</ci><ci id="S3.SS2.p1.16.m16.1.1.3.cmml" xref="S3.SS2.p1.16.m16.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m16.1c">q_{k}</annotation></semantics></math> as shown in Fig. <a href="#S1.F2" title="Figure 2 ‣ I Introduction ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.) Inspired by MOON, FedIntR computes the representation loss for <math id="S3.SS2.p1.17.m17.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.17.m17.1a"><mi id="S3.SS2.p1.17.m17.1.1" xref="S3.SS2.p1.17.m17.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m17.1b"><ci id="S3.SS2.p1.17.m17.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m17.1c">k</annotation></semantics></math>-th layer as</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.7" class="ltx_Math" alttext="\ell_{k}=-\log\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)+\exp(\text{sim}(z^{k},z^{k}_{p})/\tau)}," display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><msub id="S3.E2.m1.7.7.1.1.2" xref="S3.E2.m1.7.7.1.1.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.7.7.1.1.2.2" xref="S3.E2.m1.7.7.1.1.2.2.cmml">ℓ</mi><mi id="S3.E2.m1.7.7.1.1.2.3" xref="S3.E2.m1.7.7.1.1.2.3.cmml">k</mi></msub><mo id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.3" xref="S3.E2.m1.7.7.1.1.3.cmml"><mo rspace="0.167em" id="S3.E2.m1.7.7.1.1.3a" xref="S3.E2.m1.7.7.1.1.3.cmml">−</mo><mrow id="S3.E2.m1.7.7.1.1.3.2" xref="S3.E2.m1.7.7.1.1.3.2.cmml"><mi id="S3.E2.m1.7.7.1.1.3.2.1" xref="S3.E2.m1.7.7.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.7.7.1.1.3.2a" xref="S3.E2.m1.7.7.1.1.3.2.cmml">⁡</mo><mfrac id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.2.2.2.2a" xref="S3.E2.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml"><mtext id="S3.E2.m1.2.2.2.2.1.1.2.4" xref="S3.E2.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.1.1.2.3" xref="S3.E2.m1.2.2.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.2.2.2.3" xref="S3.E2.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msup id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E2.m1.2.2.2.2.1.1.2.2.2.4" xref="S3.E2.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">g</mi><mi id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.1.2.2.2.5" xref="S3.E2.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S3.E2.m1.2.2.2.2.1.1.4" xref="S3.E2.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.6.6.6" xref="S3.E2.m1.6.6.6.cmml"><mrow id="S3.E2.m1.5.5.5.3.1" xref="S3.E2.m1.5.5.5.3.2.cmml"><mi id="S3.E2.m1.3.3.3.1" xref="S3.E2.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E2.m1.5.5.5.3.1a" xref="S3.E2.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.5.3.1.1" xref="S3.E2.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.2" xref="S3.E2.m1.5.5.5.3.2.cmml">(</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.5.3.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.2.cmml"><mtext id="S3.E2.m1.5.5.5.3.1.1.1.2.4" xref="S3.E2.m1.5.5.5.3.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.5.3.1.1.1.2.3" xref="S3.E2.m1.5.5.5.3.1.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.3" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.3.cmml">(</mo><msup id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.4" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.2" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.3" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.3.cmml">g</mi><mi id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.3" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.5" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.3.cmml">/</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.4" xref="S3.E2.m1.5.5.5.3.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E2.m1.5.5.5.3.1.1.3" xref="S3.E2.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.5" xref="S3.E2.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E2.m1.6.6.6.4.1" xref="S3.E2.m1.6.6.6.4.2.cmml"><mi id="S3.E2.m1.4.4.4.2" xref="S3.E2.m1.4.4.4.2.cmml">exp</mi><mo id="S3.E2.m1.6.6.6.4.1a" xref="S3.E2.m1.6.6.6.4.2.cmml">⁡</mo><mrow id="S3.E2.m1.6.6.6.4.1.1" xref="S3.E2.m1.6.6.6.4.2.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.2" xref="S3.E2.m1.6.6.6.4.2.cmml">(</mo><mrow id="S3.E2.m1.6.6.6.4.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.6.4.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.2.cmml"><mtext id="S3.E2.m1.6.6.6.4.1.1.1.2.4" xref="S3.E2.m1.6.6.6.4.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.6.6.6.4.1.1.1.2.3" xref="S3.E2.m1.6.6.6.4.1.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.3" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.3.cmml">(</mo><msup id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.4" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.2" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.3" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.3.cmml">p</mi><mi id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.3" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.5" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.4.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.3.cmml">/</mo><mi id="S3.E2.m1.6.6.6.4.1.1.1.4" xref="S3.E2.m1.6.6.6.4.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E2.m1.6.6.6.4.1.1.3" xref="S3.E2.m1.6.6.6.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1"><eq id="S3.E2.m1.7.7.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"></eq><apply id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.2">ℓ</ci><ci id="S3.E2.m1.7.7.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.3">𝑘</ci></apply><apply id="S3.E2.m1.7.7.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3"><minus id="S3.E2.m1.7.7.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3"></minus><apply id="S3.E2.m1.7.7.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2"><log id="S3.E2.m1.7.7.1.1.3.2.1.cmml" xref="S3.E2.m1.7.7.1.1.3.2.1"></log><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><divide id="S3.E2.m1.6.6.7.cmml" xref="S3.E2.m1.6.6"></divide><apply id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2"><exp id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"></exp><apply id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"><divide id="S3.E2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3"></divide><apply id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2"><times id="S3.E2.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.3"></times><ci id="S3.E2.m1.2.2.2.2.1.1.2.4a.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.4"><mtext id="S3.E2.m1.2.2.2.2.1.1.2.4.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E2.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2"><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="S3.E2.m1.2.2.2.2.1.1.4.cmml" xref="S3.E2.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S3.E2.m1.6.6.6.cmml" xref="S3.E2.m1.6.6.6"><plus id="S3.E2.m1.6.6.6.5.cmml" xref="S3.E2.m1.6.6.6.5"></plus><apply id="S3.E2.m1.5.5.5.3.2.cmml" xref="S3.E2.m1.5.5.5.3.1"><exp id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.1"></exp><apply id="S3.E2.m1.5.5.5.3.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1"><divide id="S3.E2.m1.5.5.5.3.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.3"></divide><apply id="S3.E2.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2"><times id="S3.E2.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.3"></times><ci id="S3.E2.m1.5.5.5.3.1.1.1.2.4a.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.4"><mtext id="S3.E2.m1.5.5.5.3.1.1.1.2.4.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E2.m1.5.5.5.3.1.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2"><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="S3.E2.m1.5.5.5.3.1.1.1.4.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.4">𝜏</ci></apply></apply><apply id="S3.E2.m1.6.6.6.4.2.cmml" xref="S3.E2.m1.6.6.6.4.1"><exp id="S3.E2.m1.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.2"></exp><apply id="S3.E2.m1.6.6.6.4.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1"><divide id="S3.E2.m1.6.6.6.4.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.3"></divide><apply id="S3.E2.m1.6.6.6.4.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2"><times id="S3.E2.m1.6.6.6.4.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.3"></times><ci id="S3.E2.m1.6.6.6.4.1.1.1.2.4a.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.4"><mtext id="S3.E2.m1.6.6.6.4.1.1.1.2.4.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E2.m1.6.6.6.4.1.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2"><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.2.2.2.2.3">𝑝</ci></apply></interval></apply><ci id="S3.E2.m1.6.6.6.4.1.1.1.4.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\ell_{k}=-\log\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)+\exp(\text{sim}(z^{k},z^{k}_{p})/\tau)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.19" class="ltx_p">where <math id="S3.SS2.p1.18.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p1.18.m1.1a"><mi id="S3.SS2.p1.18.m1.1.1" xref="S3.SS2.p1.18.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m1.1b"><ci id="S3.SS2.p1.18.m1.1.1.cmml" xref="S3.SS2.p1.18.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m1.1c">\tau</annotation></semantics></math> is the temperature parameter and <math id="S3.SS2.p1.19.m2.1" class="ltx_math_unparsed" alttext="\text{sim}(.,.)" display="inline"><semantics id="S3.SS2.p1.19.m2.1a"><mrow id="S3.SS2.p1.19.m2.1b"><mtext id="S3.SS2.p1.19.m2.1.1">sim</mtext><mrow id="S3.SS2.p1.19.m2.1.2"><mo stretchy="false" id="S3.SS2.p1.19.m2.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S3.SS2.p1.19.m2.1.2.2">.</mo><mo id="S3.SS2.p1.19.m2.1.2.3">,</mo><mo lspace="0em" rspace="0.167em" id="S3.SS2.p1.19.m2.1.2.4">.</mo><mo stretchy="false" id="S3.SS2.p1.19.m2.1.2.5">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m2.1c">\text{sim}(.,.)</annotation></semantics></math> is the similarity function. We use the cosine similarity function, which is defined by</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\text{sim}(z_{i},z_{j})=\frac{z_{i}}{{\lVert z_{i}\rVert}_{2}}\cdot\frac{z_{j}}{{\lVert z_{j}\rVert}_{2}}." display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml"><mtext id="S3.E3.m1.3.3.1.1.2.4" xref="S3.E3.m1.3.3.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.2.3" xref="S3.E3.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.3.3.1.1.2.2.2.4" xref="S3.E3.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S3.E3.m1.3.3.1.1.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E3.m1.3.3.1.1.2.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.5" xref="S3.E3.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.4" xref="S3.E3.m1.3.3.1.1.4.cmml"><mfrac id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">z</mi><mi id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml">i</mi></msub><msub id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.2.cmml"><mo fence="true" rspace="0em" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.1.cmml">∥</mo><msub id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" lspace="0em" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">2</mn></msub></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.3.3.1.1.4.1" xref="S3.E3.m1.3.3.1.1.4.1.cmml">⋅</mo><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msub id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.3.2" xref="S3.E3.m1.2.2.3.2.cmml">z</mi><mi id="S3.E3.m1.2.2.3.3" xref="S3.E3.m1.2.2.3.3.cmml">j</mi></msub><msub id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.2.cmml"><mo fence="true" rspace="0em" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.2.1.cmml">∥</mo><msub id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">z</mi><mi id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml">j</mi></msub><mo fence="true" lspace="0em" id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.3.cmml">2</mn></msub></mfrac></mrow></mrow><mo lspace="0em" id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"></eq><apply id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"><times id="S3.E3.m1.3.3.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.3"></times><ci id="S3.E3.m1.3.3.1.1.2.4a.cmml" xref="S3.E3.m1.3.3.1.1.2.4"><mtext id="S3.E3.m1.3.3.1.1.2.4.cmml" xref="S3.E3.m1.3.3.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E3.m1.3.3.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2"><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E3.m1.3.3.1.1.4.cmml" xref="S3.E3.m1.3.3.1.1.4"><ci id="S3.E3.m1.3.3.1.1.4.1.cmml" xref="S3.E3.m1.3.3.1.1.4.1">⋅</ci><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><divide id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1"></divide><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">𝑧</ci><ci id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">2</cn></apply></apply><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2"></divide><apply id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.3.2">𝑧</ci><ci id="S3.E3.m1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.3.3">𝑗</ci></apply><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1">subscript</csymbol><apply id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">𝑧</ci><ci id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\text{sim}(z_{i},z_{j})=\frac{z_{i}}{{\lVert z_{i}\rVert}_{2}}\cdot\frac{z_{j}}{{\lVert z_{j}\rVert}_{2}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.23" class="ltx_p">The layer-wise representation loss <math id="S3.SS2.p1.20.m1.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S3.SS2.p1.20.m1.1a"><msub id="S3.SS2.p1.20.m1.1.1" xref="S3.SS2.p1.20.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.20.m1.1.1.2" xref="S3.SS2.p1.20.m1.1.1.2.cmml">ℓ</mi><mi id="S3.SS2.p1.20.m1.1.1.3" xref="S3.SS2.p1.20.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m1.1b"><apply id="S3.SS2.p1.20.m1.1.1.cmml" xref="S3.SS2.p1.20.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m1.1.1.1.cmml" xref="S3.SS2.p1.20.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.20.m1.1.1.2.cmml" xref="S3.SS2.p1.20.m1.1.1.2">ℓ</ci><ci id="S3.SS2.p1.20.m1.1.1.3.cmml" xref="S3.SS2.p1.20.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m1.1c">\ell_{k}</annotation></semantics></math> encourages the local representation <math id="S3.SS2.p1.21.m2.1" class="ltx_Math" alttext="z^{k}" display="inline"><semantics id="S3.SS2.p1.21.m2.1a"><msup id="S3.SS2.p1.21.m2.1.1" xref="S3.SS2.p1.21.m2.1.1.cmml"><mi id="S3.SS2.p1.21.m2.1.1.2" xref="S3.SS2.p1.21.m2.1.1.2.cmml">z</mi><mi id="S3.SS2.p1.21.m2.1.1.3" xref="S3.SS2.p1.21.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.21.m2.1b"><apply id="S3.SS2.p1.21.m2.1.1.cmml" xref="S3.SS2.p1.21.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.21.m2.1.1.1.cmml" xref="S3.SS2.p1.21.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.21.m2.1.1.2.cmml" xref="S3.SS2.p1.21.m2.1.1.2">𝑧</ci><ci id="S3.SS2.p1.21.m2.1.1.3.cmml" xref="S3.SS2.p1.21.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.21.m2.1c">z^{k}</annotation></semantics></math> to be closer to global representation <math id="S3.SS2.p1.22.m3.1" class="ltx_Math" alttext="z^{k}_{g}" display="inline"><semantics id="S3.SS2.p1.22.m3.1a"><msubsup id="S3.SS2.p1.22.m3.1.1" xref="S3.SS2.p1.22.m3.1.1.cmml"><mi id="S3.SS2.p1.22.m3.1.1.2.2" xref="S3.SS2.p1.22.m3.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.22.m3.1.1.3" xref="S3.SS2.p1.22.m3.1.1.3.cmml">g</mi><mi id="S3.SS2.p1.22.m3.1.1.2.3" xref="S3.SS2.p1.22.m3.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.22.m3.1b"><apply id="S3.SS2.p1.22.m3.1.1.cmml" xref="S3.SS2.p1.22.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.22.m3.1.1.1.cmml" xref="S3.SS2.p1.22.m3.1.1">subscript</csymbol><apply id="S3.SS2.p1.22.m3.1.1.2.cmml" xref="S3.SS2.p1.22.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.22.m3.1.1.2.1.cmml" xref="S3.SS2.p1.22.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.22.m3.1.1.2.2.cmml" xref="S3.SS2.p1.22.m3.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.22.m3.1.1.2.3.cmml" xref="S3.SS2.p1.22.m3.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.22.m3.1.1.3.cmml" xref="S3.SS2.p1.22.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.22.m3.1c">z^{k}_{g}</annotation></semantics></math> while moving further from <math id="S3.SS2.p1.23.m4.1" class="ltx_Math" alttext="z^{k}_{p}" display="inline"><semantics id="S3.SS2.p1.23.m4.1a"><msubsup id="S3.SS2.p1.23.m4.1.1" xref="S3.SS2.p1.23.m4.1.1.cmml"><mi id="S3.SS2.p1.23.m4.1.1.2.2" xref="S3.SS2.p1.23.m4.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.23.m4.1.1.3" xref="S3.SS2.p1.23.m4.1.1.3.cmml">p</mi><mi id="S3.SS2.p1.23.m4.1.1.2.3" xref="S3.SS2.p1.23.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.23.m4.1b"><apply id="S3.SS2.p1.23.m4.1.1.cmml" xref="S3.SS2.p1.23.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m4.1.1.1.cmml" xref="S3.SS2.p1.23.m4.1.1">subscript</csymbol><apply id="S3.SS2.p1.23.m4.1.1.2.cmml" xref="S3.SS2.p1.23.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.23.m4.1.1.2.1.cmml" xref="S3.SS2.p1.23.m4.1.1">superscript</csymbol><ci id="S3.SS2.p1.23.m4.1.1.2.2.cmml" xref="S3.SS2.p1.23.m4.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.23.m4.1.1.2.3.cmml" xref="S3.SS2.p1.23.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.23.m4.1.1.3.cmml" xref="S3.SS2.p1.23.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.23.m4.1c">z^{k}_{p}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.5" class="ltx_p">The layer-wise weight <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">α</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝛼</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\alpha_{k}</annotation></semantics></math>, representing the contribution of <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">ℓ</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">ℓ</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\ell_{k}</annotation></semantics></math> to the regularization term, is determined based on the similarity of <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="z^{k}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msup id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">z</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑧</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">z^{k}</annotation></semantics></math> and <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="z^{k}_{g}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msubsup id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2.2" xref="S3.SS2.p2.4.m4.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">g</mi><mi id="S3.SS2.p2.4.m4.1.1.2.3" xref="S3.SS2.p2.4.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2.2">𝑧</ci><ci id="S3.SS2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">z^{k}_{g}</annotation></semantics></math> using the softmax function. Specifically, <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">α</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝛼</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\alpha_{k}</annotation></semantics></math> is computed as follows:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="\alpha_{k}=\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\sum_{\hat{k}=1}^{K}\exp(\text{sim}(z^{\hat{k}},z^{\hat{k}}_{g})/\tau)}," display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><msub id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2" xref="S3.E4.m1.5.5.1.1.2.2.cmml">α</mi><mi id="S3.E4.m1.5.5.1.1.2.3" xref="S3.E4.m1.5.5.1.1.2.3.cmml">k</mi></msub><mo id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E4.m1.2.2.2.2a" xref="S3.E4.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E4.m1.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.2.2.1.1.2" xref="S3.E4.m1.2.2.2.2.1.1.2.cmml"><mtext id="S3.E4.m1.2.2.2.2.1.1.2.4" xref="S3.E4.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.1.1.2.3" xref="S3.E4.m1.2.2.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E4.m1.2.2.2.2.1.1.2.2.2" xref="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.2.1.1.2.2.2.3" xref="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msup id="S3.E4.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">k</mi></msup><mo id="S3.E4.m1.2.2.2.2.1.1.2.2.2.4" xref="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">g</mi><mi id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.E4.m1.2.2.2.2.1.1.2.2.2.5" xref="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.2.2.2.2.1.1.3" xref="S3.E4.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S3.E4.m1.2.2.2.2.1.1.4" xref="S3.E4.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><msubsup id="S3.E4.m1.4.4.4.3" xref="S3.E4.m1.4.4.4.3.cmml"><mo id="S3.E4.m1.4.4.4.3.2.2" xref="S3.E4.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.4.3.2.3" xref="S3.E4.m1.4.4.4.3.2.3.cmml"><mover accent="true" id="S3.E4.m1.4.4.4.3.2.3.2" xref="S3.E4.m1.4.4.4.3.2.3.2.cmml"><mi id="S3.E4.m1.4.4.4.3.2.3.2.2" xref="S3.E4.m1.4.4.4.3.2.3.2.2.cmml">k</mi><mo id="S3.E4.m1.4.4.4.3.2.3.2.1" xref="S3.E4.m1.4.4.4.3.2.3.2.1.cmml">^</mo></mover><mo id="S3.E4.m1.4.4.4.3.2.3.1" xref="S3.E4.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.4.3.2.3.3" xref="S3.E4.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.4.4.4.3.3" xref="S3.E4.m1.4.4.4.3.3.cmml">K</mi></msubsup><mrow id="S3.E4.m1.4.4.4.2.1" xref="S3.E4.m1.4.4.4.2.2.cmml"><mi id="S3.E4.m1.3.3.3.1" xref="S3.E4.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E4.m1.4.4.4.2.1a" xref="S3.E4.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.4.2.1.1" xref="S3.E4.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.2.1.1.2" xref="S3.E4.m1.4.4.4.2.2.cmml">(</mo><mrow id="S3.E4.m1.4.4.4.2.1.1.1" xref="S3.E4.m1.4.4.4.2.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.4.2.1.1.1.2" xref="S3.E4.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S3.E4.m1.4.4.4.2.1.1.1.2.4" xref="S3.E4.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.4.2.1.1.1.2.3" xref="S3.E4.m1.4.4.4.2.1.1.1.2.3.cmml">​</mo><mrow id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.3" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msup id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml">z</mi><mover accent="true" id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></msup><mo id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.4" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.3" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">g</mi><mover accent="true" id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1.cmml">^</mo></mover></msubsup><mo stretchy="false" id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.5" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.4.2.1.1.1.3" xref="S3.E4.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S3.E4.m1.4.4.4.2.1.1.1.4" xref="S3.E4.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E4.m1.4.4.4.2.1.1.3" xref="S3.E4.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"></eq><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2">𝛼</ci><ci id="S3.E4.m1.5.5.1.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.3">𝑘</ci></apply><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><divide id="S3.E4.m1.4.4.5.cmml" xref="S3.E4.m1.4.4"></divide><apply id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2"><exp id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"></exp><apply id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1"><divide id="S3.E4.m1.2.2.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3"></divide><apply id="S3.E4.m1.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2"><times id="S3.E4.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.3"></times><ci id="S3.E4.m1.2.2.2.2.1.1.2.4a.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.4"><mtext id="S3.E4.m1.2.2.2.2.1.1.2.4.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E4.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2"><apply id="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="S3.E4.m1.2.2.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><apply id="S3.E4.m1.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.3.1.cmml" xref="S3.E4.m1.4.4.4.3">superscript</csymbol><apply id="S3.E4.m1.4.4.4.3.2.cmml" xref="S3.E4.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.3.2.1.cmml" xref="S3.E4.m1.4.4.4.3">subscript</csymbol><sum id="S3.E4.m1.4.4.4.3.2.2.cmml" xref="S3.E4.m1.4.4.4.3.2.2"></sum><apply id="S3.E4.m1.4.4.4.3.2.3.cmml" xref="S3.E4.m1.4.4.4.3.2.3"><eq id="S3.E4.m1.4.4.4.3.2.3.1.cmml" xref="S3.E4.m1.4.4.4.3.2.3.1"></eq><apply id="S3.E4.m1.4.4.4.3.2.3.2.cmml" xref="S3.E4.m1.4.4.4.3.2.3.2"><ci id="S3.E4.m1.4.4.4.3.2.3.2.1.cmml" xref="S3.E4.m1.4.4.4.3.2.3.2.1">^</ci><ci id="S3.E4.m1.4.4.4.3.2.3.2.2.cmml" xref="S3.E4.m1.4.4.4.3.2.3.2.2">𝑘</ci></apply><cn type="integer" id="S3.E4.m1.4.4.4.3.2.3.3.cmml" xref="S3.E4.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.4.4.4.3.3.cmml" xref="S3.E4.m1.4.4.4.3.3">𝐾</ci></apply><apply id="S3.E4.m1.4.4.4.2.2.cmml" xref="S3.E4.m1.4.4.4.2.1"><exp id="S3.E4.m1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3.1"></exp><apply id="S3.E4.m1.4.4.4.2.1.1.1.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1"><divide id="S3.E4.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.3"></divide><apply id="S3.E4.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2"><times id="S3.E4.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S3.E4.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.4"><mtext id="S3.E4.m1.4.4.4.2.1.1.1.2.4.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E4.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3"><ci id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.1">^</ci><ci id="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.1.1.1.1.3.2">𝑘</ci></apply></apply><apply id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝑧</ci><apply id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3"><ci id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.1">^</ci><ci id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.2">𝑘</ci></apply></apply><ci id="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑔</ci></apply></interval></apply><ci id="S3.E4.m1.4.4.4.2.1.1.1.4.cmml" xref="S3.E4.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\alpha_{k}=\frac{\exp(\text{sim}(z^{k},z^{k}_{g})/\tau)}{\sum_{\hat{k}=1}^{K}\exp(\text{sim}(z^{\hat{k}},z^{\hat{k}}_{g})/\tau)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.9" class="ltx_p">where <math id="S3.SS2.p2.6.m1.1" class="ltx_Math" alttext="\sum_{k=1}^{K}\alpha_{k}=1" display="inline"><semantics id="S3.SS2.p2.6.m1.1a"><mrow id="S3.SS2.p2.6.m1.1.1" xref="S3.SS2.p2.6.m1.1.1.cmml"><mrow id="S3.SS2.p2.6.m1.1.1.2" xref="S3.SS2.p2.6.m1.1.1.2.cmml"><msubsup id="S3.SS2.p2.6.m1.1.1.2.1" xref="S3.SS2.p2.6.m1.1.1.2.1.cmml"><mo id="S3.SS2.p2.6.m1.1.1.2.1.2.2" xref="S3.SS2.p2.6.m1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.6.m1.1.1.2.1.2.3" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3.cmml"><mi id="S3.SS2.p2.6.m1.1.1.2.1.2.3.2" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3.2.cmml">k</mi><mo id="S3.SS2.p2.6.m1.1.1.2.1.2.3.1" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.6.m1.1.1.2.1.2.3.3" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p2.6.m1.1.1.2.1.3" xref="S3.SS2.p2.6.m1.1.1.2.1.3.cmml">K</mi></msubsup><msub id="S3.SS2.p2.6.m1.1.1.2.2" xref="S3.SS2.p2.6.m1.1.1.2.2.cmml"><mi id="S3.SS2.p2.6.m1.1.1.2.2.2" xref="S3.SS2.p2.6.m1.1.1.2.2.2.cmml">α</mi><mi id="S3.SS2.p2.6.m1.1.1.2.2.3" xref="S3.SS2.p2.6.m1.1.1.2.2.3.cmml">k</mi></msub></mrow><mo id="S3.SS2.p2.6.m1.1.1.1" xref="S3.SS2.p2.6.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.6.m1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m1.1b"><apply id="S3.SS2.p2.6.m1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1"><eq id="S3.SS2.p2.6.m1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1.1"></eq><apply id="S3.SS2.p2.6.m1.1.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2"><apply id="S3.SS2.p2.6.m1.1.1.2.1.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.2.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1">superscript</csymbol><apply id="S3.SS2.p2.6.m1.1.1.2.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.2.1.2.1.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1">subscript</csymbol><sum id="S3.SS2.p2.6.m1.1.1.2.1.2.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1.2.2"></sum><apply id="S3.SS2.p2.6.m1.1.1.2.1.2.3.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3"><eq id="S3.SS2.p2.6.m1.1.1.2.1.2.3.1.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3.1"></eq><ci id="S3.SS2.p2.6.m1.1.1.2.1.2.3.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p2.6.m1.1.1.2.1.2.3.3.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p2.6.m1.1.1.2.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.2.1.3">𝐾</ci></apply><apply id="S3.SS2.p2.6.m1.1.1.2.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.2.2.1.cmml" xref="S3.SS2.p2.6.m1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.6.m1.1.1.2.2.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2.2.2">𝛼</ci><ci id="S3.SS2.p2.6.m1.1.1.2.2.3.cmml" xref="S3.SS2.p2.6.m1.1.1.2.2.3">𝑘</ci></apply></apply><cn type="integer" id="S3.SS2.p2.6.m1.1.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m1.1c">\sum_{k=1}^{K}\alpha_{k}=1</annotation></semantics></math>. Equation (<a href="#S3.E4" title="In III-B Local Training Process of FedIntR ‣ III Method ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) assigns a higher weight value to the layer <math id="S3.SS2.p2.7.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.7.m2.1a"><mi id="S3.SS2.p2.7.m2.1.1" xref="S3.SS2.p2.7.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m2.1b"><ci id="S3.SS2.p2.7.m2.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m2.1c">k</annotation></semantics></math> with a higher degree of similarity between <math id="S3.SS2.p2.8.m3.1" class="ltx_Math" alttext="z^{k}" display="inline"><semantics id="S3.SS2.p2.8.m3.1a"><msup id="S3.SS2.p2.8.m3.1.1" xref="S3.SS2.p2.8.m3.1.1.cmml"><mi id="S3.SS2.p2.8.m3.1.1.2" xref="S3.SS2.p2.8.m3.1.1.2.cmml">z</mi><mi id="S3.SS2.p2.8.m3.1.1.3" xref="S3.SS2.p2.8.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m3.1b"><apply id="S3.SS2.p2.8.m3.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m3.1.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1">superscript</csymbol><ci id="S3.SS2.p2.8.m3.1.1.2.cmml" xref="S3.SS2.p2.8.m3.1.1.2">𝑧</ci><ci id="S3.SS2.p2.8.m3.1.1.3.cmml" xref="S3.SS2.p2.8.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m3.1c">z^{k}</annotation></semantics></math> and <math id="S3.SS2.p2.9.m4.1" class="ltx_Math" alttext="z_{g}^{k}" display="inline"><semantics id="S3.SS2.p2.9.m4.1a"><msubsup id="S3.SS2.p2.9.m4.1.1" xref="S3.SS2.p2.9.m4.1.1.cmml"><mi id="S3.SS2.p2.9.m4.1.1.2.2" xref="S3.SS2.p2.9.m4.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p2.9.m4.1.1.2.3" xref="S3.SS2.p2.9.m4.1.1.2.3.cmml">g</mi><mi id="S3.SS2.p2.9.m4.1.1.3" xref="S3.SS2.p2.9.m4.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m4.1b"><apply id="S3.SS2.p2.9.m4.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m4.1.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1">superscript</csymbol><apply id="S3.SS2.p2.9.m4.1.1.2.cmml" xref="S3.SS2.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m4.1.1.2.1.cmml" xref="S3.SS2.p2.9.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m4.1.1.2.2.cmml" xref="S3.SS2.p2.9.m4.1.1.2.2">𝑧</ci><ci id="S3.SS2.p2.9.m4.1.1.2.3.cmml" xref="S3.SS2.p2.9.m4.1.1.2.3">𝑔</ci></apply><ci id="S3.SS2.p2.9.m4.1.1.3.cmml" xref="S3.SS2.p2.9.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m4.1c">z_{g}^{k}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.6" class="ltx_p">FedIntR computes <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">α</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝛼</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\alpha_{k}</annotation></semantics></math> and <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">ℓ</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">ℓ</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\ell_{k}</annotation></semantics></math> for all layers <math id="S3.SS2.p3.3.m3.4" class="ltx_Math" alttext="k\in[1,2,\dots,K]" display="inline"><semantics id="S3.SS2.p3.3.m3.4a"><mrow id="S3.SS2.p3.3.m3.4.5" xref="S3.SS2.p3.3.m3.4.5.cmml"><mi id="S3.SS2.p3.3.m3.4.5.2" xref="S3.SS2.p3.3.m3.4.5.2.cmml">k</mi><mo id="S3.SS2.p3.3.m3.4.5.1" xref="S3.SS2.p3.3.m3.4.5.1.cmml">∈</mo><mrow id="S3.SS2.p3.3.m3.4.5.3.2" xref="S3.SS2.p3.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.3.m3.4.5.3.2.1" xref="S3.SS2.p3.3.m3.4.5.3.1.cmml">[</mo><mn id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">1</mn><mo id="S3.SS2.p3.3.m3.4.5.3.2.2" xref="S3.SS2.p3.3.m3.4.5.3.1.cmml">,</mo><mn id="S3.SS2.p3.3.m3.2.2" xref="S3.SS2.p3.3.m3.2.2.cmml">2</mn><mo id="S3.SS2.p3.3.m3.4.5.3.2.3" xref="S3.SS2.p3.3.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.3.m3.3.3" xref="S3.SS2.p3.3.m3.3.3.cmml">…</mi><mo id="S3.SS2.p3.3.m3.4.5.3.2.4" xref="S3.SS2.p3.3.m3.4.5.3.1.cmml">,</mo><mi id="S3.SS2.p3.3.m3.4.4" xref="S3.SS2.p3.3.m3.4.4.cmml">K</mi><mo stretchy="false" id="S3.SS2.p3.3.m3.4.5.3.2.5" xref="S3.SS2.p3.3.m3.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.4b"><apply id="S3.SS2.p3.3.m3.4.5.cmml" xref="S3.SS2.p3.3.m3.4.5"><in id="S3.SS2.p3.3.m3.4.5.1.cmml" xref="S3.SS2.p3.3.m3.4.5.1"></in><ci id="S3.SS2.p3.3.m3.4.5.2.cmml" xref="S3.SS2.p3.3.m3.4.5.2">𝑘</ci><list id="S3.SS2.p3.3.m3.4.5.3.1.cmml" xref="S3.SS2.p3.3.m3.4.5.3.2"><cn type="integer" id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">1</cn><cn type="integer" id="S3.SS2.p3.3.m3.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2">2</cn><ci id="S3.SS2.p3.3.m3.3.3.cmml" xref="S3.SS2.p3.3.m3.3.3">…</ci><ci id="S3.SS2.p3.3.m3.4.4.cmml" xref="S3.SS2.p3.3.m3.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.4c">k\in[1,2,\dots,K]</annotation></semantics></math>. After that, we can incorporate <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="[\alpha_{k}]_{k=1}^{K}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msubsup id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mrow id="S3.SS2.p3.4.m4.1.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.1.1.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS2.p3.4.m4.1.1.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml">α</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.p3.4.m4.1.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS2.p3.4.m4.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.1.3.2.cmml">k</mi><mo id="S3.SS2.p3.4.m4.1.1.1.3.1" xref="S3.SS2.p3.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p3.4.m4.1.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.2">𝛼</ci><ci id="S3.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.SS2.p3.4.m4.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.3"><eq id="S3.SS2.p3.4.m4.1.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.3.1"></eq><ci id="S3.SS2.p3.4.m4.1.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.4.m4.1.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">[\alpha_{k}]_{k=1}^{K}</annotation></semantics></math> and <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="[\ell_{k}]_{k=1}^{K}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><msubsup id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mrow id="S3.SS2.p3.5.m5.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.2.1.cmml">[</mo><msub id="S3.SS2.p3.5.m5.1.1.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p3.5.m5.1.1.1.1.1.1.2" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.2.cmml">ℓ</mi><mi id="S3.SS2.p3.5.m5.1.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.p3.5.m5.1.1.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S3.SS2.p3.5.m5.1.1.1.3" xref="S3.SS2.p3.5.m5.1.1.1.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.1.3.2.cmml">k</mi><mo id="S3.SS2.p3.5.m5.1.1.1.3.1" xref="S3.SS2.p3.5.m5.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p3.5.m5.1.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p3.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.2">ℓ</ci><ci id="S3.SS2.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.SS2.p3.5.m5.1.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.1.3"><eq id="S3.SS2.p3.5.m5.1.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.3.1"></eq><ci id="S3.SS2.p3.5.m5.1.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p3.5.m5.1.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">[\ell_{k}]_{k=1}^{K}</annotation></semantics></math> into the local training loss as the regularization term. The local loss <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\mathcal{L}</annotation></semantics></math> is defined as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\mathcal{L}=\ell_{sup}+\mu\sum^{K}_{k=1}\alpha_{k}\ell_{k}," display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.2.3.1" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.2.3.1a" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.4" xref="S3.E5.m1.1.1.1.1.3.2.3.4.cmml">p</mi></mrow></msub><mo id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.3.1" xref="S3.E5.m1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.cmml"><munderover id="S3.E5.m1.1.1.1.1.3.3.3.1" xref="S3.E5.m1.1.1.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E5.m1.1.1.1.1.3.3.3.1.2.2" xref="S3.E5.m1.1.1.1.1.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.1.3.3.3.1.3" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.3.1.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3.2.cmml">k</mi><mo id="S3.E5.m1.1.1.1.1.3.3.3.1.3.1" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3.1.cmml">=</mo><mn id="S3.E5.m1.1.1.1.1.3.3.3.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.1.1.1.1.3.3.3.1.2.3" xref="S3.E5.m1.1.1.1.1.3.3.3.1.2.3.cmml">K</mi></munderover><mrow id="S3.E5.m1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.cmml"><msub id="S3.E5.m1.1.1.1.1.3.3.3.2.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.3.2.2.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.2.2.cmml">α</mi><mi id="S3.E5.m1.1.1.1.1.3.3.3.2.2.3" xref="S3.E5.m1.1.1.1.1.3.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.3.3.2.1" xref="S3.E5.m1.1.1.1.1.3.3.3.2.1.cmml">​</mo><msub id="S3.E5.m1.1.1.1.1.3.3.3.2.3" xref="S3.E5.m1.1.1.1.1.3.3.3.2.3.cmml"><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1.3.3.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.3.2.cmml">ℓ</mi><mi id="S3.E5.m1.1.1.1.1.3.3.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><ci id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><plus id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">ℓ</ci><apply id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3"><times id="S3.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.2">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3">𝑢</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.4">𝑝</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><times id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">𝜇</ci><apply id="S3.E5.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3"><apply id="S3.E5.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1">superscript</csymbol><sum id="S3.E5.m1.1.1.1.1.3.3.3.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1.2.2"></sum><ci id="S3.E5.m1.1.1.1.1.3.3.3.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1.2.3">𝐾</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3"><eq id="S3.E5.m1.1.1.1.1.3.3.3.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3.1"></eq><ci id="S3.E5.m1.1.1.1.1.3.3.3.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3.2">𝑘</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.3.3.3.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2"><times id="S3.E5.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.1"></times><apply id="S3.E5.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.2.2">𝛼</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.2.3">𝑘</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.3.2">ℓ</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{L}=\ell_{sup}+\mu\sum^{K}_{k=1}\alpha_{k}\ell_{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.8" class="ltx_p">where <math id="S3.SS2.p3.7.m1.1" class="ltx_Math" alttext="\ell_{sup}" display="inline"><semantics id="S3.SS2.p3.7.m1.1a"><msub id="S3.SS2.p3.7.m1.1.1" xref="S3.SS2.p3.7.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p3.7.m1.1.1.2" xref="S3.SS2.p3.7.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS2.p3.7.m1.1.1.3" xref="S3.SS2.p3.7.m1.1.1.3.cmml"><mi id="S3.SS2.p3.7.m1.1.1.3.2" xref="S3.SS2.p3.7.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.7.m1.1.1.3.1" xref="S3.SS2.p3.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.7.m1.1.1.3.3" xref="S3.SS2.p3.7.m1.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.7.m1.1.1.3.1a" xref="S3.SS2.p3.7.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.7.m1.1.1.3.4" xref="S3.SS2.p3.7.m1.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m1.1b"><apply id="S3.SS2.p3.7.m1.1.1.cmml" xref="S3.SS2.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m1.1.1.1.cmml" xref="S3.SS2.p3.7.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m1.1.1.2.cmml" xref="S3.SS2.p3.7.m1.1.1.2">ℓ</ci><apply id="S3.SS2.p3.7.m1.1.1.3.cmml" xref="S3.SS2.p3.7.m1.1.1.3"><times id="S3.SS2.p3.7.m1.1.1.3.1.cmml" xref="S3.SS2.p3.7.m1.1.1.3.1"></times><ci id="S3.SS2.p3.7.m1.1.1.3.2.cmml" xref="S3.SS2.p3.7.m1.1.1.3.2">𝑠</ci><ci id="S3.SS2.p3.7.m1.1.1.3.3.cmml" xref="S3.SS2.p3.7.m1.1.1.3.3">𝑢</ci><ci id="S3.SS2.p3.7.m1.1.1.3.4.cmml" xref="S3.SS2.p3.7.m1.1.1.3.4">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m1.1c">\ell_{sup}</annotation></semantics></math> represents the cross-entropy loss, and the second component is the regularization term, with <math id="S3.SS2.p3.8.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS2.p3.8.m2.1a"><mi id="S3.SS2.p3.8.m2.1.1" xref="S3.SS2.p3.8.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m2.1b"><ci id="S3.SS2.p3.8.m2.1.1.cmml" xref="S3.SS2.p3.8.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m2.1c">\mu</annotation></semantics></math> being the balancing parameter.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we discuss various experimental setups and evaluation results used to verify the effectiveness of FedIntR relative to other baseline approaches.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Experimental Settings</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">FedIntR is evaluated on four datasets: Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, SVHN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, and CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, in comparison with various state-of-the-art FL approaches including FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, and FedCKA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. We use a small CNN model for the Fashion-MNIST, SVHN, and CIFAR-10 datasets, and ResNet-20 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> for the CIFAR-100 dataset. Our CNN model is composed of three <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">3</cn><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">3\times 3</annotation></semantics></math> convolutional layers with 8, 16, and 32 channels. Each convolutional layer is ReLU activated and followed by a <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="2\times 2" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></times><cn type="integer" id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">2</cn><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">2\times 2</annotation></semantics></math> max pooling. The output of the final convolutional layer goes through two fully connected layers with 128 and 96 neurons. Both fully connected layers are also ReLU activated. FedIntR extracts representations from the three convolutional layers and the two fully connected layers of the CNN model. Similar to MOON, our projection head is a 2-layer MLP with an output dimension of 256. For the ResNet-20 model, the representations are retrieved from the first convolutional layer and each end of the three ResNet blocks.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We use the PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> framework to implement FedIntR and other baseline methods. Referring to MOON, local training is performed using the SGD optimizer with a learning rate of 0.01, weight decay of 0.00001, and momentum of 0.9. We set the batch size as 512, the number of local epochs as 10, and the number of training rounds as 100. We use random horizontal flip as augmentation during the training except for the SVHN dataset. For both FedIntR and MOON, the temperature <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\tau</annotation></semantics></math> value is set to 0.5.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Test accuracy (%) on 10 clients with <math id="S4.T1.4.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S4.T1.4.m1.1b"><mrow id="S4.T1.4.m1.1.1" xref="S4.T1.4.m1.1.1.cmml"><mi id="S4.T1.4.m1.1.1.2" xref="S4.T1.4.m1.1.1.2.cmml">β</mi><mo id="S4.T1.4.m1.1.1.1" xref="S4.T1.4.m1.1.1.1.cmml">=</mo><mn id="S4.T1.4.m1.1.1.3" xref="S4.T1.4.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.m1.1c"><apply id="S4.T1.4.m1.1.1.cmml" xref="S4.T1.4.m1.1.1"><eq id="S4.T1.4.m1.1.1.1.cmml" xref="S4.T1.4.m1.1.1.1"></eq><ci id="S4.T1.4.m1.1.1.2.cmml" xref="S4.T1.4.m1.1.1.2">𝛽</ci><cn type="float" id="S4.T1.4.m1.1.1.3.cmml" xref="S4.T1.4.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m1.1d">\beta=0.5</annotation></semantics></math>. We tune <math id="S4.T1.5.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T1.5.m2.1b"><mi id="S4.T1.5.m2.1.1" xref="S4.T1.5.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.m2.1c"><ci id="S4.T1.5.m2.1.1.cmml" xref="S4.T1.5.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.m2.1d">\mu</annotation></semantics></math> for each method, and the best <math id="S4.T1.6.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T1.6.m3.1b"><mi id="S4.T1.6.m3.1.1" xref="S4.T1.6.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.m3.1c"><ci id="S4.T1.6.m3.1.1.cmml" xref="S4.T1.6.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.m3.1d">\mu</annotation></semantics></math> value is shown in parentheses.</figcaption>
<table id="S4.T1.7" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.7.1.1" class="ltx_tr">
<th id="S4.T1.7.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.1.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S4.T1.7.1.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">
<table id="S4.T1.7.1.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.7.1.1.2.1.1" class="ltx_tr">
<td id="S4.T1.7.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">Fashion-</td>
</tr>
<tr id="S4.T1.7.1.1.2.1.2" class="ltx_tr">
<td id="S4.T1.7.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">MNIST</td>
</tr>
</table>
</td>
<td id="S4.T1.7.1.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">SVHN</td>
<td id="S4.T1.7.1.1.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">CIFAR-10</td>
<td id="S4.T1.7.1.1.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">CIFAR-100</td>
</tr>
<tr id="S4.T1.7.2.2" class="ltx_tr">
<th id="S4.T1.7.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.2.2.1.1" class="ltx_ERROR undefined">\hlineB</span>3
FedAvg</th>
<td id="S4.T1.7.2.2.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">88.90</td>
<td id="S4.T1.7.2.2.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">86.04</td>
<td id="S4.T1.7.2.2.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">65.82</td>
<td id="S4.T1.7.2.2.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.43</td>
</tr>
<tr id="S4.T1.7.3.3" class="ltx_tr">
<th id="S4.T1.7.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedCKA</th>
<td id="S4.T1.7.3.3.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">88.85 (3)</td>
<td id="S4.T1.7.3.3.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">86.47 (1)</td>
<td id="S4.T1.7.3.3.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">66.55 (0.1)</td>
<td id="S4.T1.7.3.3.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.3.3.5.1" class="ltx_text ltx_font_bold">41.91</span> (10)</td>
</tr>
<tr id="S4.T1.7.4.4" class="ltx_tr">
<th id="S4.T1.7.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedProx</th>
<td id="S4.T1.7.4.4.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">88.95 (0.001)</td>
<td id="S4.T1.7.4.4.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">86.42 (0.01)</td>
<td id="S4.T1.7.4.4.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">65.03 (0.01)</td>
<td id="S4.T1.7.4.4.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">39.91 (0.1)</td>
</tr>
<tr id="S4.T1.7.5.5" class="ltx_tr">
<th id="S4.T1.7.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">MOON</th>
<td id="S4.T1.7.5.5.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.5.5.2.1" class="ltx_text ltx_font_bold">89.15</span> (1)</td>
<td id="S4.T1.7.5.5.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">86.61 (10)</td>
<td id="S4.T1.7.5.5.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">66.35 (5)</td>
<td id="S4.T1.7.5.5.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.46 (0.1)</td>
</tr>
<tr id="S4.T1.7.6.6" class="ltx_tr">
<th id="S4.T1.7.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedIntR</th>
<td id="S4.T1.7.6.6.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.6.6.2.1" class="ltx_text ltx_font_bold">89.15</span> (10)</td>
<td id="S4.T1.7.6.6.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.6.6.3.1" class="ltx_text ltx_font_bold">87.17</span> (10)</td>
<td id="S4.T1.7.6.6.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.6.6.4.1" class="ltx_text ltx_font_bold">67.23</span> (3)</td>
<td id="S4.T1.7.6.6.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">41.48 (10)</td>
</tr>
<tr id="S4.T1.7.7.7" class="ltx_tr">
<th id="S4.T1.7.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T1.7.7.7.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S4.T1.7.7.7.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T1.7.7.7.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T1.7.7.7.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T1.7.7.7.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Test accuracy (%) of FedIntR with different <math id="S4.T2.2.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T2.2.m1.1b"><mi id="S4.T2.2.m1.1.1" xref="S4.T2.2.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.m1.1c"><ci id="S4.T2.2.m1.1.1.cmml" xref="S4.T2.2.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.m1.1d">\mu</annotation></semantics></math> values.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.3.1" class="ltx_tr">
<th id="S4.T2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T2.3.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
<math id="S4.T2.3.1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T2.3.1.1.m1.1a"><mi id="S4.T2.3.1.1.m1.1.1" xref="S4.T2.3.1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.1.1.m1.1b"><ci id="S4.T2.3.1.1.m1.1.1.cmml" xref="S4.T2.3.1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.1.1.m1.1c">\mu</annotation></semantics></math>
</th>
<td id="S4.T2.3.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">Fashion-MNIST</td>
<td id="S4.T2.3.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">SVHN</td>
<td id="S4.T2.3.1.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">CIFAR-10</td>
<td id="S4.T2.3.1.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">CIFAR-100</td>
</tr>
<tr id="S4.T2.3.2.1" class="ltx_tr">
<th id="S4.T2.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T2.3.2.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
0.1</th>
<td id="S4.T2.3.2.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">88.87</td>
<td id="S4.T2.3.2.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">86.85</td>
<td id="S4.T2.3.2.1.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.23</td>
<td id="S4.T2.3.2.1.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.00</td>
</tr>
<tr id="S4.T2.3.3.2" class="ltx_tr">
<th id="S4.T2.3.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">1</th>
<td id="S4.T2.3.3.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">89.07</td>
<td id="S4.T2.3.3.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">85.89</td>
<td id="S4.T2.3.3.2.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.66</td>
<td id="S4.T2.3.3.2.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">40.43</td>
</tr>
<tr id="S4.T2.3.4.3" class="ltx_tr">
<th id="S4.T2.3.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">3</th>
<td id="S4.T2.3.4.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">88.67</td>
<td id="S4.T2.3.4.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">87.05</td>
<td id="S4.T2.3.4.3.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.3.4.3.4.1" class="ltx_text ltx_font_bold">67.23</span></td>
<td id="S4.T2.3.4.3.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">40.99</td>
</tr>
<tr id="S4.T2.3.5.4" class="ltx_tr">
<th id="S4.T2.3.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">5</th>
<td id="S4.T2.3.5.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">89.13</td>
<td id="S4.T2.3.5.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">87.01</td>
<td id="S4.T2.3.5.4.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">66.99</td>
<td id="S4.T2.3.5.4.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">41.21</td>
</tr>
<tr id="S4.T2.3.6.5" class="ltx_tr">
<th id="S4.T2.3.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">10</th>
<td id="S4.T2.3.6.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.3.6.5.2.1" class="ltx_text ltx_font_bold">89.15</span></td>
<td id="S4.T2.3.6.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.3.6.5.3.1" class="ltx_text ltx_font_bold">87.17</span></td>
<td id="S4.T2.3.6.5.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.89</td>
<td id="S4.T2.3.6.5.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T2.3.6.5.5.1" class="ltx_text ltx_font_bold">41.48</span></td>
</tr>
<tr id="S4.T2.3.7.6" class="ltx_tr">
<th id="S4.T2.3.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T2.3.7.6.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S4.T2.3.7.6.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T2.3.7.6.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T2.3.7.6.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T2.3.7.6.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.15827/assets/x3.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="150" height="125" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><math id="S4.F3.sf1.2.m1.1" class="ltx_Math" alttext="\beta=5.0" display="inline"><semantics id="S4.F3.sf1.2.m1.1b"><mrow id="S4.F3.sf1.2.m1.1.1" xref="S4.F3.sf1.2.m1.1.1.cmml"><mi id="S4.F3.sf1.2.m1.1.1.2" xref="S4.F3.sf1.2.m1.1.1.2.cmml">β</mi><mo id="S4.F3.sf1.2.m1.1.1.1" xref="S4.F3.sf1.2.m1.1.1.1.cmml">=</mo><mn id="S4.F3.sf1.2.m1.1.1.3" xref="S4.F3.sf1.2.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.sf1.2.m1.1c"><apply id="S4.F3.sf1.2.m1.1.1.cmml" xref="S4.F3.sf1.2.m1.1.1"><eq id="S4.F3.sf1.2.m1.1.1.1.cmml" xref="S4.F3.sf1.2.m1.1.1.1"></eq><ci id="S4.F3.sf1.2.m1.1.1.2.cmml" xref="S4.F3.sf1.2.m1.1.1.2">𝛽</ci><cn type="float" id="S4.F3.sf1.2.m1.1.1.3.cmml" xref="S4.F3.sf1.2.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.sf1.2.m1.1d">\beta=5.0</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.15827/assets/x4.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="150" height="122" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><math id="S4.F3.sf2.2.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S4.F3.sf2.2.m1.1b"><mrow id="S4.F3.sf2.2.m1.1.1" xref="S4.F3.sf2.2.m1.1.1.cmml"><mi id="S4.F3.sf2.2.m1.1.1.2" xref="S4.F3.sf2.2.m1.1.1.2.cmml">β</mi><mo id="S4.F3.sf2.2.m1.1.1.1" xref="S4.F3.sf2.2.m1.1.1.1.cmml">=</mo><mn id="S4.F3.sf2.2.m1.1.1.3" xref="S4.F3.sf2.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.sf2.2.m1.1c"><apply id="S4.F3.sf2.2.m1.1.1.cmml" xref="S4.F3.sf2.2.m1.1.1"><eq id="S4.F3.sf2.2.m1.1.1.1.cmml" xref="S4.F3.sf2.2.m1.1.1.1"></eq><ci id="S4.F3.sf2.2.m1.1.1.2.cmml" xref="S4.F3.sf2.2.m1.1.1.2">𝛽</ci><cn type="float" id="S4.F3.sf2.2.m1.1.1.3.cmml" xref="S4.F3.sf2.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.sf2.2.m1.1d">\beta=0.5</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2210.15827/assets/x5.png" id="S4.F3.sf3.g1" class="ltx_graphics ltx_img_square" width="150" height="122" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><math id="S4.F3.sf3.2.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S4.F3.sf3.2.m1.1b"><mrow id="S4.F3.sf3.2.m1.1.1" xref="S4.F3.sf3.2.m1.1.1.cmml"><mi id="S4.F3.sf3.2.m1.1.1.2" xref="S4.F3.sf3.2.m1.1.1.2.cmml">β</mi><mo id="S4.F3.sf3.2.m1.1.1.1" xref="S4.F3.sf3.2.m1.1.1.1.cmml">=</mo><mn id="S4.F3.sf3.2.m1.1.1.3" xref="S4.F3.sf3.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.sf3.2.m1.1c"><apply id="S4.F3.sf3.2.m1.1.1.cmml" xref="S4.F3.sf3.2.m1.1.1"><eq id="S4.F3.sf3.2.m1.1.1.1.cmml" xref="S4.F3.sf3.2.m1.1.1.1"></eq><ci id="S4.F3.sf3.2.m1.1.1.2.cmml" xref="S4.F3.sf3.2.m1.1.1.2">𝛽</ci><cn type="float" id="S4.F3.sf3.2.m1.1.1.3.cmml" xref="S4.F3.sf3.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.sf3.2.m1.1d">\beta=0.1</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Client data distribution with different <math id="S4.F3.2.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.F3.2.m1.1b"><mi id="S4.F3.2.m1.1.1" xref="S4.F3.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.F3.2.m1.1c"><ci id="S4.F3.2.m1.1.1.cmml" xref="S4.F3.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.m1.1d">\beta</annotation></semantics></math> values for the CIFAR-10 dataset. A darker rectangle denotes a higher number of data samples for a specific class in a client.</figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Test accuracy (%) on CIFAR-10 and CIFAR-100 datasets with different <math id="S4.T3.4.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T3.4.m1.1b"><mi id="S4.T3.4.m1.1.1" xref="S4.T3.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T3.4.m1.1c"><ci id="S4.T3.4.m1.1.1.cmml" xref="S4.T3.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.m1.1d">\beta</annotation></semantics></math> values. We tune <math id="S4.T3.5.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T3.5.m2.1b"><mi id="S4.T3.5.m2.1.1" xref="S4.T3.5.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T3.5.m2.1c"><ci id="S4.T3.5.m2.1.1.cmml" xref="S4.T3.5.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.m2.1d">\mu</annotation></semantics></math> for each method and the best <math id="S4.T3.6.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T3.6.m3.1b"><mi id="S4.T3.6.m3.1.1" xref="S4.T3.6.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T3.6.m3.1c"><ci id="S4.T3.6.m3.1.1.cmml" xref="S4.T3.6.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.m3.1d">\mu</annotation></semantics></math> value is shown in brackets.</figcaption>
<table id="S4.T3.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.12.7.1" class="ltx_tr">
<th id="S4.T3.12.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.7.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S4.T3.12.7.1.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;" colspan="3">CIFAR-10</td>
<td id="S4.T3.12.7.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;" colspan="3">CIFAR-100</td>
</tr>
<tr id="S4.T3.12.6" class="ltx_tr">
<th id="S4.T3.12.6.7" class="ltx_td ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"></th>
<td id="S4.T3.7.1.1" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T3.7.1.1.m1.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S4.T3.7.1.1.m1.1a"><mrow id="S4.T3.7.1.1.m1.1.1" xref="S4.T3.7.1.1.m1.1.1.cmml"><mi id="S4.T3.7.1.1.m1.1.1.2" xref="S4.T3.7.1.1.m1.1.1.2.cmml">β</mi><mo id="S4.T3.7.1.1.m1.1.1.1" xref="S4.T3.7.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.7.1.1.m1.1.1.3" xref="S4.T3.7.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.7.1.1.m1.1b"><apply id="S4.T3.7.1.1.m1.1.1.cmml" xref="S4.T3.7.1.1.m1.1.1"><eq id="S4.T3.7.1.1.m1.1.1.1.cmml" xref="S4.T3.7.1.1.m1.1.1.1"></eq><ci id="S4.T3.7.1.1.m1.1.1.2.cmml" xref="S4.T3.7.1.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S4.T3.7.1.1.m1.1.1.3.cmml" xref="S4.T3.7.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.1.1.m1.1c">\beta=5</annotation></semantics></math></td>
<td id="S4.T3.8.2.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T3.8.2.2.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S4.T3.8.2.2.m1.1a"><mrow id="S4.T3.8.2.2.m1.1.1" xref="S4.T3.8.2.2.m1.1.1.cmml"><mi id="S4.T3.8.2.2.m1.1.1.2" xref="S4.T3.8.2.2.m1.1.1.2.cmml">β</mi><mo id="S4.T3.8.2.2.m1.1.1.1" xref="S4.T3.8.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T3.8.2.2.m1.1.1.3" xref="S4.T3.8.2.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.8.2.2.m1.1b"><apply id="S4.T3.8.2.2.m1.1.1.cmml" xref="S4.T3.8.2.2.m1.1.1"><eq id="S4.T3.8.2.2.m1.1.1.1.cmml" xref="S4.T3.8.2.2.m1.1.1.1"></eq><ci id="S4.T3.8.2.2.m1.1.1.2.cmml" xref="S4.T3.8.2.2.m1.1.1.2">𝛽</ci><cn type="float" id="S4.T3.8.2.2.m1.1.1.3.cmml" xref="S4.T3.8.2.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.2.2.m1.1c">\beta=0.5</annotation></semantics></math></td>
<td id="S4.T3.9.3.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T3.9.3.3.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S4.T3.9.3.3.m1.1a"><mrow id="S4.T3.9.3.3.m1.1.1" xref="S4.T3.9.3.3.m1.1.1.cmml"><mi id="S4.T3.9.3.3.m1.1.1.2" xref="S4.T3.9.3.3.m1.1.1.2.cmml">β</mi><mo id="S4.T3.9.3.3.m1.1.1.1" xref="S4.T3.9.3.3.m1.1.1.1.cmml">=</mo><mn id="S4.T3.9.3.3.m1.1.1.3" xref="S4.T3.9.3.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.9.3.3.m1.1b"><apply id="S4.T3.9.3.3.m1.1.1.cmml" xref="S4.T3.9.3.3.m1.1.1"><eq id="S4.T3.9.3.3.m1.1.1.1.cmml" xref="S4.T3.9.3.3.m1.1.1.1"></eq><ci id="S4.T3.9.3.3.m1.1.1.2.cmml" xref="S4.T3.9.3.3.m1.1.1.2">𝛽</ci><cn type="float" id="S4.T3.9.3.3.m1.1.1.3.cmml" xref="S4.T3.9.3.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.3.3.m1.1c">\beta=0.1</annotation></semantics></math></td>
<td id="S4.T3.10.4.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T3.10.4.4.m1.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S4.T3.10.4.4.m1.1a"><mrow id="S4.T3.10.4.4.m1.1.1" xref="S4.T3.10.4.4.m1.1.1.cmml"><mi id="S4.T3.10.4.4.m1.1.1.2" xref="S4.T3.10.4.4.m1.1.1.2.cmml">β</mi><mo id="S4.T3.10.4.4.m1.1.1.1" xref="S4.T3.10.4.4.m1.1.1.1.cmml">=</mo><mn id="S4.T3.10.4.4.m1.1.1.3" xref="S4.T3.10.4.4.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.10.4.4.m1.1b"><apply id="S4.T3.10.4.4.m1.1.1.cmml" xref="S4.T3.10.4.4.m1.1.1"><eq id="S4.T3.10.4.4.m1.1.1.1.cmml" xref="S4.T3.10.4.4.m1.1.1.1"></eq><ci id="S4.T3.10.4.4.m1.1.1.2.cmml" xref="S4.T3.10.4.4.m1.1.1.2">𝛽</ci><cn type="integer" id="S4.T3.10.4.4.m1.1.1.3.cmml" xref="S4.T3.10.4.4.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.4.4.m1.1c">\beta=5</annotation></semantics></math></td>
<td id="S4.T3.11.5.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T3.11.5.5.m1.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S4.T3.11.5.5.m1.1a"><mrow id="S4.T3.11.5.5.m1.1.1" xref="S4.T3.11.5.5.m1.1.1.cmml"><mi id="S4.T3.11.5.5.m1.1.1.2" xref="S4.T3.11.5.5.m1.1.1.2.cmml">β</mi><mo id="S4.T3.11.5.5.m1.1.1.1" xref="S4.T3.11.5.5.m1.1.1.1.cmml">=</mo><mn id="S4.T3.11.5.5.m1.1.1.3" xref="S4.T3.11.5.5.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.11.5.5.m1.1b"><apply id="S4.T3.11.5.5.m1.1.1.cmml" xref="S4.T3.11.5.5.m1.1.1"><eq id="S4.T3.11.5.5.m1.1.1.1.cmml" xref="S4.T3.11.5.5.m1.1.1.1"></eq><ci id="S4.T3.11.5.5.m1.1.1.2.cmml" xref="S4.T3.11.5.5.m1.1.1.2">𝛽</ci><cn type="float" id="S4.T3.11.5.5.m1.1.1.3.cmml" xref="S4.T3.11.5.5.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.5.5.m1.1c">\beta=0.5</annotation></semantics></math></td>
<td id="S4.T3.12.6.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T3.12.6.6.m1.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S4.T3.12.6.6.m1.1a"><mrow id="S4.T3.12.6.6.m1.1.1" xref="S4.T3.12.6.6.m1.1.1.cmml"><mi id="S4.T3.12.6.6.m1.1.1.2" xref="S4.T3.12.6.6.m1.1.1.2.cmml">β</mi><mo id="S4.T3.12.6.6.m1.1.1.1" xref="S4.T3.12.6.6.m1.1.1.1.cmml">=</mo><mn id="S4.T3.12.6.6.m1.1.1.3" xref="S4.T3.12.6.6.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.12.6.6.m1.1b"><apply id="S4.T3.12.6.6.m1.1.1.cmml" xref="S4.T3.12.6.6.m1.1.1"><eq id="S4.T3.12.6.6.m1.1.1.1.cmml" xref="S4.T3.12.6.6.m1.1.1.1"></eq><ci id="S4.T3.12.6.6.m1.1.1.2.cmml" xref="S4.T3.12.6.6.m1.1.1.2">𝛽</ci><cn type="float" id="S4.T3.12.6.6.m1.1.1.3.cmml" xref="S4.T3.12.6.6.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.6.6.m1.1c">\beta=0.1</annotation></semantics></math></td>
</tr>
<tr id="S4.T3.12.8.2" class="ltx_tr">
<th id="S4.T3.12.8.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.8.2.1.1" class="ltx_ERROR undefined">\hlineB</span>3
FedAvg</th>
<td id="S4.T3.12.8.2.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">68.69</td>
<td id="S4.T3.12.8.2.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">65.82</td>
<td id="S4.T3.12.8.2.4" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">55.62</td>
<td id="S4.T3.12.8.2.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T3.12.8.2.5.1" class="ltx_text ltx_font_bold">40.62</span></td>
<td id="S4.T3.12.8.2.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.43</td>
<td id="S4.T3.12.8.2.7" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">37.48</td>
</tr>
<tr id="S4.T3.12.9.3" class="ltx_tr">
<th id="S4.T3.12.9.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedCKA</th>
<td id="S4.T3.12.9.3.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">68.62 (1)</td>
<td id="S4.T3.12.9.3.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">66.55 (0.1)</td>
<td id="S4.T3.12.9.3.4" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">55.64 (0.1)</td>
<td id="S4.T3.12.9.3.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.40 (0.1)</td>
<td id="S4.T3.12.9.3.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.9.3.6.1" class="ltx_text ltx_font_bold">41.91</span> (10)</td>
<td id="S4.T3.12.9.3.7" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">35.73 (10)</td>
</tr>
<tr id="S4.T3.12.10.4" class="ltx_tr">
<th id="S4.T3.12.10.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedProx</th>
<td id="S4.T3.12.10.4.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">70.03 (0.01)</td>
<td id="S4.T3.12.10.4.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">65.03 (0.01)</td>
<td id="S4.T3.12.10.4.4" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">56.55 (0.01)</td>
<td id="S4.T3.12.10.4.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.00 (0.001)</td>
<td id="S4.T3.12.10.4.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">39.91 (0.1)</td>
<td id="S4.T3.12.10.4.7" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">37.38 (0.1)</td>
</tr>
<tr id="S4.T3.12.11.5" class="ltx_tr">
<th id="S4.T3.12.11.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">MOON</th>
<td id="S4.T3.12.11.5.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">69.34 (1)</td>
<td id="S4.T3.12.11.5.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">66.35 (5)</td>
<td id="S4.T3.12.11.5.4" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">57.60 (1)</td>
<td id="S4.T3.12.11.5.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.23 (0.1)</td>
<td id="S4.T3.12.11.5.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.46 (0.1)</td>
<td id="S4.T3.12.11.5.7" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">37.16 (5)</td>
</tr>
<tr id="S4.T3.12.12.6" class="ltx_tr">
<th id="S4.T3.12.12.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedIntR</th>
<td id="S4.T3.12.12.6.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.12.6.2.1" class="ltx_text ltx_font_bold">70.66</span> (5)</td>
<td id="S4.T3.12.12.6.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.12.6.3.1" class="ltx_text ltx_font_bold">67.23</span> (3)</td>
<td id="S4.T3.12.12.6.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.12.6.4.1" class="ltx_text ltx_font_bold">58.32</span> (10)</td>
<td id="S4.T3.12.12.6.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">40.06 (0.1)</td>
<td id="S4.T3.12.12.6.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">41.48 (10)</td>
<td id="S4.T3.12.12.6.7" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.12.6.7.1" class="ltx_text ltx_font_bold">38.24</span> (0.5)</td>
</tr>
<tr id="S4.T3.12.13.7" class="ltx_tr">
<th id="S4.T3.12.13.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T3.12.13.7.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S4.T3.12.13.7.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T3.12.13.7.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T3.12.13.7.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T3.12.13.7.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T3.12.13.7.6" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T3.12.13.7.7" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.3" class="ltx_p">To represent the heterogeneous data in the clients, the training portion of each dataset is partitioned into 10 client datasets using the Dirichlet distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. The concentration parameter <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\beta</annotation></semantics></math> controls the strength of data heterogeneity in the Dirichlet distribution. A lower <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\beta</annotation></semantics></math> value indicates a greater level of data heterogeneity. We set the <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\beta</annotation></semantics></math> value as 0.5 by default. The performance of FedIntR and the baseline methods is obtained by evaluating the corresponding global models on the testing portions of the respective datasets. We report the median of test accuracy values attained by the global model over the course of last 10 training rounds. Unless otherwise stated, we use the same settings as above for FedIntR and all other baseline methods.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Accuracy on Different Datasets</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.8" class="ltx_p">Table <a href="#S4.T1" title="TABLE I ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> displays the top-1 test accuracy of different approaches on four datasets. The hyperparameter <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mu</annotation></semantics></math> in FedIntR, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, and FedCKA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> can be tuned to control the regularization strength in the local training loss. For each approach, we tune the <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mu</annotation></semantics></math> value and report the best results. For FedIntR and FedCKA, we tune <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mu</annotation></semantics></math> from <math id="S4.SS2.p1.4.m4.5" class="ltx_Math" alttext="[0.1,1,3,5,10]" display="inline"><semantics id="S4.SS2.p1.4.m4.5a"><mrow id="S4.SS2.p1.4.m4.5.6.2" xref="S4.SS2.p1.4.m4.5.6.1.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.5.6.2.1" xref="S4.SS2.p1.4.m4.5.6.1.cmml">[</mo><mn id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">0.1</mn><mo id="S4.SS2.p1.4.m4.5.6.2.2" xref="S4.SS2.p1.4.m4.5.6.1.cmml">,</mo><mn id="S4.SS2.p1.4.m4.2.2" xref="S4.SS2.p1.4.m4.2.2.cmml">1</mn><mo id="S4.SS2.p1.4.m4.5.6.2.3" xref="S4.SS2.p1.4.m4.5.6.1.cmml">,</mo><mn id="S4.SS2.p1.4.m4.3.3" xref="S4.SS2.p1.4.m4.3.3.cmml">3</mn><mo id="S4.SS2.p1.4.m4.5.6.2.4" xref="S4.SS2.p1.4.m4.5.6.1.cmml">,</mo><mn id="S4.SS2.p1.4.m4.4.4" xref="S4.SS2.p1.4.m4.4.4.cmml">5</mn><mo id="S4.SS2.p1.4.m4.5.6.2.5" xref="S4.SS2.p1.4.m4.5.6.1.cmml">,</mo><mn id="S4.SS2.p1.4.m4.5.5" xref="S4.SS2.p1.4.m4.5.5.cmml">10</mn><mo stretchy="false" id="S4.SS2.p1.4.m4.5.6.2.6" xref="S4.SS2.p1.4.m4.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.5b"><list id="S4.SS2.p1.4.m4.5.6.1.cmml" xref="S4.SS2.p1.4.m4.5.6.2"><cn type="float" id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">0.1</cn><cn type="integer" id="S4.SS2.p1.4.m4.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2">1</cn><cn type="integer" id="S4.SS2.p1.4.m4.3.3.cmml" xref="S4.SS2.p1.4.m4.3.3">3</cn><cn type="integer" id="S4.SS2.p1.4.m4.4.4.cmml" xref="S4.SS2.p1.4.m4.4.4">5</cn><cn type="integer" id="S4.SS2.p1.4.m4.5.5.cmml" xref="S4.SS2.p1.4.m4.5.5">10</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.5c">[0.1,1,3,5,10]</annotation></semantics></math> (which covers the range used by the original FedCKA paper). We tune <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mu</annotation></semantics></math> from <math id="S4.SS2.p1.6.m6.4" class="ltx_Math" alttext="[0.1,1,5,10]" display="inline"><semantics id="S4.SS2.p1.6.m6.4a"><mrow id="S4.SS2.p1.6.m6.4.5.2" xref="S4.SS2.p1.6.m6.4.5.1.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m6.4.5.2.1" xref="S4.SS2.p1.6.m6.4.5.1.cmml">[</mo><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">0.1</mn><mo id="S4.SS2.p1.6.m6.4.5.2.2" xref="S4.SS2.p1.6.m6.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.2.2" xref="S4.SS2.p1.6.m6.2.2.cmml">1</mn><mo id="S4.SS2.p1.6.m6.4.5.2.3" xref="S4.SS2.p1.6.m6.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.3.3" xref="S4.SS2.p1.6.m6.3.3.cmml">5</mn><mo id="S4.SS2.p1.6.m6.4.5.2.4" xref="S4.SS2.p1.6.m6.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.6.m6.4.4" xref="S4.SS2.p1.6.m6.4.4.cmml">10</mn><mo stretchy="false" id="S4.SS2.p1.6.m6.4.5.2.5" xref="S4.SS2.p1.6.m6.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.4b"><list id="S4.SS2.p1.6.m6.4.5.1.cmml" xref="S4.SS2.p1.6.m6.4.5.2"><cn type="float" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">0.1</cn><cn type="integer" id="S4.SS2.p1.6.m6.2.2.cmml" xref="S4.SS2.p1.6.m6.2.2">1</cn><cn type="integer" id="S4.SS2.p1.6.m6.3.3.cmml" xref="S4.SS2.p1.6.m6.3.3">5</cn><cn type="integer" id="S4.SS2.p1.6.m6.4.4.cmml" xref="S4.SS2.p1.6.m6.4.4">10</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.4c">[0.1,1,5,10]</annotation></semantics></math> for MOON and <math id="S4.SS2.p1.7.m7.4" class="ltx_Math" alttext="[0.001,0.01,0.1,1]" display="inline"><semantics id="S4.SS2.p1.7.m7.4a"><mrow id="S4.SS2.p1.7.m7.4.5.2" xref="S4.SS2.p1.7.m7.4.5.1.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.4.5.2.1" xref="S4.SS2.p1.7.m7.4.5.1.cmml">[</mo><mn id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">0.001</mn><mo id="S4.SS2.p1.7.m7.4.5.2.2" xref="S4.SS2.p1.7.m7.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.7.m7.2.2" xref="S4.SS2.p1.7.m7.2.2.cmml">0.01</mn><mo id="S4.SS2.p1.7.m7.4.5.2.3" xref="S4.SS2.p1.7.m7.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.7.m7.3.3" xref="S4.SS2.p1.7.m7.3.3.cmml">0.1</mn><mo id="S4.SS2.p1.7.m7.4.5.2.4" xref="S4.SS2.p1.7.m7.4.5.1.cmml">,</mo><mn id="S4.SS2.p1.7.m7.4.4" xref="S4.SS2.p1.7.m7.4.4.cmml">1</mn><mo stretchy="false" id="S4.SS2.p1.7.m7.4.5.2.5" xref="S4.SS2.p1.7.m7.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.4b"><list id="S4.SS2.p1.7.m7.4.5.1.cmml" xref="S4.SS2.p1.7.m7.4.5.2"><cn type="float" id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">0.001</cn><cn type="float" id="S4.SS2.p1.7.m7.2.2.cmml" xref="S4.SS2.p1.7.m7.2.2">0.01</cn><cn type="float" id="S4.SS2.p1.7.m7.3.3.cmml" xref="S4.SS2.p1.7.m7.3.3">0.1</cn><cn type="integer" id="S4.SS2.p1.7.m7.4.4.cmml" xref="S4.SS2.p1.7.m7.4.4">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.4c">[0.001,0.01,0.1,1]</annotation></semantics></math> for FedProx, according to their respective papers. In Table <a href="#S4.T1" title="TABLE I ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, we report the corresponding best <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mi id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">\mu</annotation></semantics></math> values in parentheses.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Our proposed FedIntR framework achieves superior performance in the SVHN and CIFAR-10 datasets compared to the baseline techniques. For the Fashion-MNIST dataset, both FedIntR and MOON achieve the best performance. FedCKA outperforms FedIntR on the CIFAR-100 dataset, but FedIntR still maintains a comparable performance. There are three plausible explanations for this. (i) For the CIFAR-100 dataset, we employ the ResNet-20 model, which contains fewer number of extraction points for intermediate representations than the CNN model. (ii) The superior performance of FedIntR can be observed more clearly with a higher degree of data heterogeneity, which will be discussed in Section <a href="#S4.SS3" title="IV-C Degree of Data Heterogeneity ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-C</span></span></a>, where we compare the performance of different techniques on varying degrees of data heterogeneity. (iii) FedIntR is more beneficial from longer training. By default, we set the number of communication rounds as 100, but as we will discuss in Section <a href="#S4.SS4" title="IV-D Scalability ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-D</span></span></a>, FedIntR performs better with a higher number of training rounds. For reference, we also provide the performance of FedIntR from tuning <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mu</annotation></semantics></math> in Table <a href="#S4.T2" title="TABLE II ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Note that MOON paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> reported a higher accuracy across CIFAR-10 and CIFAR-100 datasets. As mentioned by the authors of FedCKA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, MOON may have applied a variety of data augmentations to obtain higher performance. However, since MOON did not disclose their augmentation settings, we were unable to reproduce their results.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Test accuracy (%) at different rounds <math id="S4.T4.3.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T4.3.m1.1b"><mi id="S4.T4.3.m1.1.1" xref="S4.T4.3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T4.3.m1.1c"><ci id="S4.T4.3.m1.1.1.cmml" xref="S4.T4.3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.m1.1d">T</annotation></semantics></math> on CIFAR-10 dataset with different number of clients <math id="S4.T4.4.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.T4.4.m2.1b"><mi id="S4.T4.4.m2.1.1" xref="S4.T4.4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T4.4.m2.1c"><ci id="S4.T4.4.m2.1.1.cmml" xref="S4.T4.4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.m2.1d">N</annotation></semantics></math>.</figcaption>
<table id="S4.T4.22" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.6.2" class="ltx_tr">
<td id="S4.T4.6.2.3" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.6.2.3.1" class="ltx_ERROR undefined">\hlineB</span>3</td>
<td id="S4.T4.5.1.1" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;" colspan="4"><math id="S4.T4.5.1.1.m1.1" class="ltx_Math" alttext="N=50" display="inline"><semantics id="S4.T4.5.1.1.m1.1a"><mrow id="S4.T4.5.1.1.m1.1.1" xref="S4.T4.5.1.1.m1.1.1.cmml"><mi id="S4.T4.5.1.1.m1.1.1.2" xref="S4.T4.5.1.1.m1.1.1.2.cmml">N</mi><mo id="S4.T4.5.1.1.m1.1.1.1" xref="S4.T4.5.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.5.1.1.m1.1.1.3" xref="S4.T4.5.1.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.1.1.m1.1b"><apply id="S4.T4.5.1.1.m1.1.1.cmml" xref="S4.T4.5.1.1.m1.1.1"><eq id="S4.T4.5.1.1.m1.1.1.1.cmml" xref="S4.T4.5.1.1.m1.1.1.1"></eq><ci id="S4.T4.5.1.1.m1.1.1.2.cmml" xref="S4.T4.5.1.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.T4.5.1.1.m1.1.1.3.cmml" xref="S4.T4.5.1.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.1.1.m1.1c">N=50</annotation></semantics></math></td>
<td id="S4.T4.6.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;" colspan="5"><math id="S4.T4.6.2.2.m1.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.T4.6.2.2.m1.1a"><mrow id="S4.T4.6.2.2.m1.1.1" xref="S4.T4.6.2.2.m1.1.1.cmml"><mi id="S4.T4.6.2.2.m1.1.1.2" xref="S4.T4.6.2.2.m1.1.1.2.cmml">N</mi><mo id="S4.T4.6.2.2.m1.1.1.1" xref="S4.T4.6.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T4.6.2.2.m1.1.1.3" xref="S4.T4.6.2.2.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.6.2.2.m1.1b"><apply id="S4.T4.6.2.2.m1.1.1.cmml" xref="S4.T4.6.2.2.m1.1.1"><eq id="S4.T4.6.2.2.m1.1.1.1.cmml" xref="S4.T4.6.2.2.m1.1.1.1"></eq><ci id="S4.T4.6.2.2.m1.1.1.2.cmml" xref="S4.T4.6.2.2.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.T4.6.2.2.m1.1.1.3.cmml" xref="S4.T4.6.2.2.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.2.2.m1.1c">N=100</annotation></semantics></math></td>
</tr>
<tr id="S4.T4.15.11" class="ltx_tr">
<td id="S4.T4.15.11.10" class="ltx_td ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.7.3.1" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.7.3.1.m1.1" class="ltx_Math" alttext="T=100" display="inline"><semantics id="S4.T4.7.3.1.m1.1a"><mrow id="S4.T4.7.3.1.m1.1.1" xref="S4.T4.7.3.1.m1.1.1.cmml"><mi id="S4.T4.7.3.1.m1.1.1.2" xref="S4.T4.7.3.1.m1.1.1.2.cmml">T</mi><mo id="S4.T4.7.3.1.m1.1.1.1" xref="S4.T4.7.3.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.7.3.1.m1.1.1.3" xref="S4.T4.7.3.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.3.1.m1.1b"><apply id="S4.T4.7.3.1.m1.1.1.cmml" xref="S4.T4.7.3.1.m1.1.1"><eq id="S4.T4.7.3.1.m1.1.1.1.cmml" xref="S4.T4.7.3.1.m1.1.1.1"></eq><ci id="S4.T4.7.3.1.m1.1.1.2.cmml" xref="S4.T4.7.3.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.7.3.1.m1.1.1.3.cmml" xref="S4.T4.7.3.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.3.1.m1.1c">T=100</annotation></semantics></math></td>
<td id="S4.T4.8.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.8.4.2.m1.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.T4.8.4.2.m1.1a"><mrow id="S4.T4.8.4.2.m1.1.1" xref="S4.T4.8.4.2.m1.1.1.cmml"><mi id="S4.T4.8.4.2.m1.1.1.2" xref="S4.T4.8.4.2.m1.1.1.2.cmml">T</mi><mo id="S4.T4.8.4.2.m1.1.1.1" xref="S4.T4.8.4.2.m1.1.1.1.cmml">=</mo><mn id="S4.T4.8.4.2.m1.1.1.3" xref="S4.T4.8.4.2.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.8.4.2.m1.1b"><apply id="S4.T4.8.4.2.m1.1.1.cmml" xref="S4.T4.8.4.2.m1.1.1"><eq id="S4.T4.8.4.2.m1.1.1.1.cmml" xref="S4.T4.8.4.2.m1.1.1.1"></eq><ci id="S4.T4.8.4.2.m1.1.1.2.cmml" xref="S4.T4.8.4.2.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.8.4.2.m1.1.1.3.cmml" xref="S4.T4.8.4.2.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.4.2.m1.1c">T=200</annotation></semantics></math></td>
<td id="S4.T4.9.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.9.5.3.m1.1" class="ltx_Math" alttext="T=500" display="inline"><semantics id="S4.T4.9.5.3.m1.1a"><mrow id="S4.T4.9.5.3.m1.1.1" xref="S4.T4.9.5.3.m1.1.1.cmml"><mi id="S4.T4.9.5.3.m1.1.1.2" xref="S4.T4.9.5.3.m1.1.1.2.cmml">T</mi><mo id="S4.T4.9.5.3.m1.1.1.1" xref="S4.T4.9.5.3.m1.1.1.1.cmml">=</mo><mn id="S4.T4.9.5.3.m1.1.1.3" xref="S4.T4.9.5.3.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.9.5.3.m1.1b"><apply id="S4.T4.9.5.3.m1.1.1.cmml" xref="S4.T4.9.5.3.m1.1.1"><eq id="S4.T4.9.5.3.m1.1.1.1.cmml" xref="S4.T4.9.5.3.m1.1.1.1"></eq><ci id="S4.T4.9.5.3.m1.1.1.2.cmml" xref="S4.T4.9.5.3.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.9.5.3.m1.1.1.3.cmml" xref="S4.T4.9.5.3.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.5.3.m1.1c">T=500</annotation></semantics></math></td>
<td id="S4.T4.10.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.10.6.4.m1.1" class="ltx_Math" alttext="T=800" display="inline"><semantics id="S4.T4.10.6.4.m1.1a"><mrow id="S4.T4.10.6.4.m1.1.1" xref="S4.T4.10.6.4.m1.1.1.cmml"><mi id="S4.T4.10.6.4.m1.1.1.2" xref="S4.T4.10.6.4.m1.1.1.2.cmml">T</mi><mo id="S4.T4.10.6.4.m1.1.1.1" xref="S4.T4.10.6.4.m1.1.1.1.cmml">=</mo><mn id="S4.T4.10.6.4.m1.1.1.3" xref="S4.T4.10.6.4.m1.1.1.3.cmml">800</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.10.6.4.m1.1b"><apply id="S4.T4.10.6.4.m1.1.1.cmml" xref="S4.T4.10.6.4.m1.1.1"><eq id="S4.T4.10.6.4.m1.1.1.1.cmml" xref="S4.T4.10.6.4.m1.1.1.1"></eq><ci id="S4.T4.10.6.4.m1.1.1.2.cmml" xref="S4.T4.10.6.4.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.10.6.4.m1.1.1.3.cmml" xref="S4.T4.10.6.4.m1.1.1.3">800</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.6.4.m1.1c">T=800</annotation></semantics></math></td>
<td id="S4.T4.11.7.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.11.7.5.m1.1" class="ltx_Math" alttext="T=100" display="inline"><semantics id="S4.T4.11.7.5.m1.1a"><mrow id="S4.T4.11.7.5.m1.1.1" xref="S4.T4.11.7.5.m1.1.1.cmml"><mi id="S4.T4.11.7.5.m1.1.1.2" xref="S4.T4.11.7.5.m1.1.1.2.cmml">T</mi><mo id="S4.T4.11.7.5.m1.1.1.1" xref="S4.T4.11.7.5.m1.1.1.1.cmml">=</mo><mn id="S4.T4.11.7.5.m1.1.1.3" xref="S4.T4.11.7.5.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.11.7.5.m1.1b"><apply id="S4.T4.11.7.5.m1.1.1.cmml" xref="S4.T4.11.7.5.m1.1.1"><eq id="S4.T4.11.7.5.m1.1.1.1.cmml" xref="S4.T4.11.7.5.m1.1.1.1"></eq><ci id="S4.T4.11.7.5.m1.1.1.2.cmml" xref="S4.T4.11.7.5.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.11.7.5.m1.1.1.3.cmml" xref="S4.T4.11.7.5.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.7.5.m1.1c">T=100</annotation></semantics></math></td>
<td id="S4.T4.12.8.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.12.8.6.m1.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.T4.12.8.6.m1.1a"><mrow id="S4.T4.12.8.6.m1.1.1" xref="S4.T4.12.8.6.m1.1.1.cmml"><mi id="S4.T4.12.8.6.m1.1.1.2" xref="S4.T4.12.8.6.m1.1.1.2.cmml">T</mi><mo id="S4.T4.12.8.6.m1.1.1.1" xref="S4.T4.12.8.6.m1.1.1.1.cmml">=</mo><mn id="S4.T4.12.8.6.m1.1.1.3" xref="S4.T4.12.8.6.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.12.8.6.m1.1b"><apply id="S4.T4.12.8.6.m1.1.1.cmml" xref="S4.T4.12.8.6.m1.1.1"><eq id="S4.T4.12.8.6.m1.1.1.1.cmml" xref="S4.T4.12.8.6.m1.1.1.1"></eq><ci id="S4.T4.12.8.6.m1.1.1.2.cmml" xref="S4.T4.12.8.6.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.12.8.6.m1.1.1.3.cmml" xref="S4.T4.12.8.6.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.12.8.6.m1.1c">T=200</annotation></semantics></math></td>
<td id="S4.T4.13.9.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.13.9.7.m1.1" class="ltx_Math" alttext="T=500" display="inline"><semantics id="S4.T4.13.9.7.m1.1a"><mrow id="S4.T4.13.9.7.m1.1.1" xref="S4.T4.13.9.7.m1.1.1.cmml"><mi id="S4.T4.13.9.7.m1.1.1.2" xref="S4.T4.13.9.7.m1.1.1.2.cmml">T</mi><mo id="S4.T4.13.9.7.m1.1.1.1" xref="S4.T4.13.9.7.m1.1.1.1.cmml">=</mo><mn id="S4.T4.13.9.7.m1.1.1.3" xref="S4.T4.13.9.7.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.13.9.7.m1.1b"><apply id="S4.T4.13.9.7.m1.1.1.cmml" xref="S4.T4.13.9.7.m1.1.1"><eq id="S4.T4.13.9.7.m1.1.1.1.cmml" xref="S4.T4.13.9.7.m1.1.1.1"></eq><ci id="S4.T4.13.9.7.m1.1.1.2.cmml" xref="S4.T4.13.9.7.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.13.9.7.m1.1.1.3.cmml" xref="S4.T4.13.9.7.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.13.9.7.m1.1c">T=500</annotation></semantics></math></td>
<td id="S4.T4.14.10.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.14.10.8.m1.1" class="ltx_Math" alttext="T=800" display="inline"><semantics id="S4.T4.14.10.8.m1.1a"><mrow id="S4.T4.14.10.8.m1.1.1" xref="S4.T4.14.10.8.m1.1.1.cmml"><mi id="S4.T4.14.10.8.m1.1.1.2" xref="S4.T4.14.10.8.m1.1.1.2.cmml">T</mi><mo id="S4.T4.14.10.8.m1.1.1.1" xref="S4.T4.14.10.8.m1.1.1.1.cmml">=</mo><mn id="S4.T4.14.10.8.m1.1.1.3" xref="S4.T4.14.10.8.m1.1.1.3.cmml">800</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.14.10.8.m1.1b"><apply id="S4.T4.14.10.8.m1.1.1.cmml" xref="S4.T4.14.10.8.m1.1.1"><eq id="S4.T4.14.10.8.m1.1.1.1.cmml" xref="S4.T4.14.10.8.m1.1.1.1"></eq><ci id="S4.T4.14.10.8.m1.1.1.2.cmml" xref="S4.T4.14.10.8.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.14.10.8.m1.1.1.3.cmml" xref="S4.T4.14.10.8.m1.1.1.3">800</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.14.10.8.m1.1c">T=800</annotation></semantics></math></td>
<td id="S4.T4.15.11.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><math id="S4.T4.15.11.9.m1.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S4.T4.15.11.9.m1.1a"><mrow id="S4.T4.15.11.9.m1.1.1" xref="S4.T4.15.11.9.m1.1.1.cmml"><mi id="S4.T4.15.11.9.m1.1.1.2" xref="S4.T4.15.11.9.m1.1.1.2.cmml">T</mi><mo id="S4.T4.15.11.9.m1.1.1.1" xref="S4.T4.15.11.9.m1.1.1.1.cmml">=</mo><mn id="S4.T4.15.11.9.m1.1.1.3" xref="S4.T4.15.11.9.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.15.11.9.m1.1b"><apply id="S4.T4.15.11.9.m1.1.1.cmml" xref="S4.T4.15.11.9.m1.1.1"><eq id="S4.T4.15.11.9.m1.1.1.1.cmml" xref="S4.T4.15.11.9.m1.1.1.1"></eq><ci id="S4.T4.15.11.9.m1.1.1.2.cmml" xref="S4.T4.15.11.9.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.T4.15.11.9.m1.1.1.3.cmml" xref="S4.T4.15.11.9.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.15.11.9.m1.1c">T=1000</annotation></semantics></math></td>
</tr>
<tr id="S4.T4.22.19.1" class="ltx_tr">
<td id="S4.T4.22.19.1.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.22.19.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
FedAvg</td>
<td id="S4.T4.22.19.1.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.22.19.1.2.1" class="ltx_text ltx_font_bold">49.41</span></td>
<td id="S4.T4.22.19.1.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">57.79</td>
<td id="S4.T4.22.19.1.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.26</td>
<td id="S4.T4.22.19.1.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">64.62</td>
<td id="S4.T4.22.19.1.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">37.98</td>
<td id="S4.T4.22.19.1.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.22.19.1.7.1" class="ltx_text ltx_font_bold">50.69</span></td>
<td id="S4.T4.22.19.1.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">61.00</td>
<td id="S4.T4.22.19.1.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">63.64</td>
<td id="S4.T4.22.19.1.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.90</td>
</tr>
<tr id="S4.T4.16.12" class="ltx_tr">
<td id="S4.T4.16.12.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedCKA (<math id="S4.T4.16.12.1.m1.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.T4.16.12.1.m1.1a"><mrow id="S4.T4.16.12.1.m1.1.1" xref="S4.T4.16.12.1.m1.1.1.cmml"><mi id="S4.T4.16.12.1.m1.1.1.2" xref="S4.T4.16.12.1.m1.1.1.2.cmml">μ</mi><mo id="S4.T4.16.12.1.m1.1.1.1" xref="S4.T4.16.12.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.16.12.1.m1.1.1.3" xref="S4.T4.16.12.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.16.12.1.m1.1b"><apply id="S4.T4.16.12.1.m1.1.1.cmml" xref="S4.T4.16.12.1.m1.1.1"><eq id="S4.T4.16.12.1.m1.1.1.1.cmml" xref="S4.T4.16.12.1.m1.1.1.1"></eq><ci id="S4.T4.16.12.1.m1.1.1.2.cmml" xref="S4.T4.16.12.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.T4.16.12.1.m1.1.1.3.cmml" xref="S4.T4.16.12.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.16.12.1.m1.1c">\mu=1</annotation></semantics></math>)</td>
<td id="S4.T4.16.12.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">45.28</td>
<td id="S4.T4.16.12.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.76</td>
<td id="S4.T4.16.12.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.90</td>
<td id="S4.T4.16.12.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">63.96</td>
<td id="S4.T4.16.12.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">36.81</td>
<td id="S4.T4.16.12.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">47.10</td>
<td id="S4.T4.16.12.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">60.43</td>
<td id="S4.T4.16.12.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.30</td>
<td id="S4.T4.16.12.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.41</td>
</tr>
<tr id="S4.T4.17.13" class="ltx_tr">
<td id="S4.T4.17.13.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedCKA (<math id="S4.T4.17.13.1.m1.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.T4.17.13.1.m1.1a"><mrow id="S4.T4.17.13.1.m1.1.1" xref="S4.T4.17.13.1.m1.1.1.cmml"><mi id="S4.T4.17.13.1.m1.1.1.2" xref="S4.T4.17.13.1.m1.1.1.2.cmml">μ</mi><mo id="S4.T4.17.13.1.m1.1.1.1" xref="S4.T4.17.13.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.17.13.1.m1.1.1.3" xref="S4.T4.17.13.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.17.13.1.m1.1b"><apply id="S4.T4.17.13.1.m1.1.1.cmml" xref="S4.T4.17.13.1.m1.1.1"><eq id="S4.T4.17.13.1.m1.1.1.1.cmml" xref="S4.T4.17.13.1.m1.1.1.1"></eq><ci id="S4.T4.17.13.1.m1.1.1.2.cmml" xref="S4.T4.17.13.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.T4.17.13.1.m1.1.1.3.cmml" xref="S4.T4.17.13.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.17.13.1.m1.1c">\mu=10</annotation></semantics></math>)</td>
<td id="S4.T4.17.13.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">44.45</td>
<td id="S4.T4.17.13.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">53.83</td>
<td id="S4.T4.17.13.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">58.69</td>
<td id="S4.T4.17.13.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">59.08</td>
<td id="S4.T4.17.13.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">36.68</td>
<td id="S4.T4.17.13.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">46.85</td>
<td id="S4.T4.17.13.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.51</td>
<td id="S4.T4.17.13.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">59.91</td>
<td id="S4.T4.17.13.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">60.49</td>
</tr>
<tr id="S4.T4.18.14" class="ltx_tr">
<td id="S4.T4.18.14.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedProx (<math id="S4.T4.18.14.1.m1.1" class="ltx_Math" alttext="\mu=0.01" display="inline"><semantics id="S4.T4.18.14.1.m1.1a"><mrow id="S4.T4.18.14.1.m1.1.1" xref="S4.T4.18.14.1.m1.1.1.cmml"><mi id="S4.T4.18.14.1.m1.1.1.2" xref="S4.T4.18.14.1.m1.1.1.2.cmml">μ</mi><mo id="S4.T4.18.14.1.m1.1.1.1" xref="S4.T4.18.14.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.18.14.1.m1.1.1.3" xref="S4.T4.18.14.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.18.14.1.m1.1b"><apply id="S4.T4.18.14.1.m1.1.1.cmml" xref="S4.T4.18.14.1.m1.1.1"><eq id="S4.T4.18.14.1.m1.1.1.1.cmml" xref="S4.T4.18.14.1.m1.1.1.1"></eq><ci id="S4.T4.18.14.1.m1.1.1.2.cmml" xref="S4.T4.18.14.1.m1.1.1.2">𝜇</ci><cn type="float" id="S4.T4.18.14.1.m1.1.1.3.cmml" xref="S4.T4.18.14.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.18.14.1.m1.1c">\mu=0.01</annotation></semantics></math>)</td>
<td id="S4.T4.18.14.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">46.17</td>
<td id="S4.T4.18.14.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.18.14.3.1" class="ltx_text ltx_font_bold">58.12</span></td>
<td id="S4.T4.18.14.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.44</td>
<td id="S4.T4.18.14.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">65.75</td>
<td id="S4.T4.18.14.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">37.79</td>
<td id="S4.T4.18.14.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50.37</td>
<td id="S4.T4.18.14.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">61.08</td>
<td id="S4.T4.18.14.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.48</td>
<td id="S4.T4.18.14.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.75</td>
</tr>
<tr id="S4.T4.19.15" class="ltx_tr">
<td id="S4.T4.19.15.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">MOON (<math id="S4.T4.19.15.1.m1.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.T4.19.15.1.m1.1a"><mrow id="S4.T4.19.15.1.m1.1.1" xref="S4.T4.19.15.1.m1.1.1.cmml"><mi id="S4.T4.19.15.1.m1.1.1.2" xref="S4.T4.19.15.1.m1.1.1.2.cmml">μ</mi><mo id="S4.T4.19.15.1.m1.1.1.1" xref="S4.T4.19.15.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.19.15.1.m1.1.1.3" xref="S4.T4.19.15.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.19.15.1.m1.1b"><apply id="S4.T4.19.15.1.m1.1.1.cmml" xref="S4.T4.19.15.1.m1.1.1"><eq id="S4.T4.19.15.1.m1.1.1.1.cmml" xref="S4.T4.19.15.1.m1.1.1.1"></eq><ci id="S4.T4.19.15.1.m1.1.1.2.cmml" xref="S4.T4.19.15.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.T4.19.15.1.m1.1.1.3.cmml" xref="S4.T4.19.15.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.19.15.1.m1.1c">\mu=1</annotation></semantics></math>)</td>
<td id="S4.T4.19.15.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">48.25</td>
<td id="S4.T4.19.15.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">57.98</td>
<td id="S4.T4.19.15.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.24</td>
<td id="S4.T4.19.15.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">64.23</td>
<td id="S4.T4.19.15.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.19.15.6.1" class="ltx_text ltx_font_bold">38.08</span></td>
<td id="S4.T4.19.15.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">47.98</td>
<td id="S4.T4.19.15.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">60.08</td>
<td id="S4.T4.19.15.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">63.66</td>
<td id="S4.T4.19.15.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.85</td>
</tr>
<tr id="S4.T4.20.16" class="ltx_tr">
<td id="S4.T4.20.16.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">MOON (<math id="S4.T4.20.16.1.m1.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.T4.20.16.1.m1.1a"><mrow id="S4.T4.20.16.1.m1.1.1" xref="S4.T4.20.16.1.m1.1.1.cmml"><mi id="S4.T4.20.16.1.m1.1.1.2" xref="S4.T4.20.16.1.m1.1.1.2.cmml">μ</mi><mo id="S4.T4.20.16.1.m1.1.1.1" xref="S4.T4.20.16.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.20.16.1.m1.1.1.3" xref="S4.T4.20.16.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.20.16.1.m1.1b"><apply id="S4.T4.20.16.1.m1.1.1.cmml" xref="S4.T4.20.16.1.m1.1.1"><eq id="S4.T4.20.16.1.m1.1.1.1.cmml" xref="S4.T4.20.16.1.m1.1.1.1"></eq><ci id="S4.T4.20.16.1.m1.1.1.2.cmml" xref="S4.T4.20.16.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.T4.20.16.1.m1.1.1.3.cmml" xref="S4.T4.20.16.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.20.16.1.m1.1c">\mu=10</annotation></semantics></math>)</td>
<td id="S4.T4.20.16.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">42.71</td>
<td id="S4.T4.20.16.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">55.83</td>
<td id="S4.T4.20.16.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.52</td>
<td id="S4.T4.20.16.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">65.18</td>
<td id="S4.T4.20.16.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">34.34</td>
<td id="S4.T4.20.16.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">46.81</td>
<td id="S4.T4.20.16.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.20.16.8.1" class="ltx_text ltx_font_bold">61.68</span></td>
<td id="S4.T4.20.16.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">63.97</td>
<td id="S4.T4.20.16.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">65.12</td>
</tr>
<tr id="S4.T4.21.17" class="ltx_tr">
<td id="S4.T4.21.17.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedIntR (<math id="S4.T4.21.17.1.m1.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.T4.21.17.1.m1.1a"><mrow id="S4.T4.21.17.1.m1.1.1" xref="S4.T4.21.17.1.m1.1.1.cmml"><mi id="S4.T4.21.17.1.m1.1.1.2" xref="S4.T4.21.17.1.m1.1.1.2.cmml">μ</mi><mo id="S4.T4.21.17.1.m1.1.1.1" xref="S4.T4.21.17.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.21.17.1.m1.1.1.3" xref="S4.T4.21.17.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.21.17.1.m1.1b"><apply id="S4.T4.21.17.1.m1.1.1.cmml" xref="S4.T4.21.17.1.m1.1.1"><eq id="S4.T4.21.17.1.m1.1.1.1.cmml" xref="S4.T4.21.17.1.m1.1.1.1"></eq><ci id="S4.T4.21.17.1.m1.1.1.2.cmml" xref="S4.T4.21.17.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.T4.21.17.1.m1.1.1.3.cmml" xref="S4.T4.21.17.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.21.17.1.m1.1c">\mu=1</annotation></semantics></math>)</td>
<td id="S4.T4.21.17.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">47.02</td>
<td id="S4.T4.21.17.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">58.01</td>
<td id="S4.T4.21.17.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">63.89</td>
<td id="S4.T4.21.17.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">63.75</td>
<td id="S4.T4.21.17.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">35.87</td>
<td id="S4.T4.21.17.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">48.15</td>
<td id="S4.T4.21.17.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">60.59</td>
<td id="S4.T4.21.17.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">63.46</td>
<td id="S4.T4.21.17.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">64.26</td>
</tr>
<tr id="S4.T4.22.18" class="ltx_tr">
<td id="S4.T4.22.18.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedIntR (<math id="S4.T4.22.18.1.m1.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.T4.22.18.1.m1.1a"><mrow id="S4.T4.22.18.1.m1.1.1" xref="S4.T4.22.18.1.m1.1.1.cmml"><mi id="S4.T4.22.18.1.m1.1.1.2" xref="S4.T4.22.18.1.m1.1.1.2.cmml">μ</mi><mo id="S4.T4.22.18.1.m1.1.1.1" xref="S4.T4.22.18.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.22.18.1.m1.1.1.3" xref="S4.T4.22.18.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.22.18.1.m1.1b"><apply id="S4.T4.22.18.1.m1.1.1.cmml" xref="S4.T4.22.18.1.m1.1.1"><eq id="S4.T4.22.18.1.m1.1.1.1.cmml" xref="S4.T4.22.18.1.m1.1.1.1"></eq><ci id="S4.T4.22.18.1.m1.1.1.2.cmml" xref="S4.T4.22.18.1.m1.1.1.2">𝜇</ci><cn type="integer" id="S4.T4.22.18.1.m1.1.1.3.cmml" xref="S4.T4.22.18.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.22.18.1.m1.1c">\mu=10</annotation></semantics></math>)</td>
<td id="S4.T4.22.18.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">46.63</td>
<td id="S4.T4.22.18.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">56.39</td>
<td id="S4.T4.22.18.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.22.18.4.1" class="ltx_text ltx_font_bold">65.48</span></td>
<td id="S4.T4.22.18.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.22.18.5.1" class="ltx_text ltx_font_bold">66.94</span></td>
<td id="S4.T4.22.18.6" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">32.13</td>
<td id="S4.T4.22.18.7" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">49.76</td>
<td id="S4.T4.22.18.8" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">61.31</td>
<td id="S4.T4.22.18.9" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.22.18.9.1" class="ltx_text ltx_font_bold">65.55</span></td>
<td id="S4.T4.22.18.10" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T4.22.18.10.1" class="ltx_text ltx_font_bold">66.57</span></td>
</tr>
<tr id="S4.T4.22.20.2" class="ltx_tr">
<td id="S4.T4.22.20.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T4.22.20.2.1.1" class="ltx_ERROR undefined">\hlineB</span>3</td>
<td id="S4.T4.22.20.2.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.6" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.7" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.8" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.9" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T4.22.20.2.10" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Degree of Data Heterogeneity</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">In this experiment, we investigate the impact of clients’ data heterogeneity on our proposed FedIntR framework. We adjust the <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\beta</annotation></semantics></math> parameter of the Dirichlet distribution to control the strength of data heterogeneity between the clients. Fig. <a href="#S4.F3" title="Figure 3 ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates how different values of <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\beta</annotation></semantics></math> influence the local data distributions of the clients for the CIFAR-10 dataset.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.7" class="ltx_p">Table <a href="#S4.T3" title="TABLE III ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> displays the test accuracy values attained by different approaches on the CIFAR-10 and CIFAR-100 datasets with <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\beta</annotation></semantics></math> values of 5, 0.5, and 0.1. Similar to Section <a href="#S4.SS2" title="IV-B Accuracy on Different Datasets ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a>, we tune the <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\mu</annotation></semantics></math> value for each approach (shown in parentheses in Table <a href="#S4.T3" title="TABLE III ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>) and report the best results. For the CIFAR-10 dataset, FedIntR exhibits superior performance over the baseline approaches in all data heterogeneity settings. FedProx has comparable performance to FedIntR when <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mrow id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">β</mi><mo id="S4.SS3.p2.3.m3.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><eq id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1"></eq><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝛽</ci><cn type="integer" id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\beta=5</annotation></semantics></math> (i.e., when the degree of data heterogeneity among the clients is low), but its performance diminishes with a smaller <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">\beta</annotation></semantics></math> value. For the CIFAR-100 dataset, vanilla FedAvg outperforms all other approaches when <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="\beta=5" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2" xref="S4.SS3.p2.5.m5.1.1.2.cmml">β</mi><mo id="S4.SS3.p2.5.m5.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1"><eq id="S4.SS3.p2.5.m5.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1"></eq><ci id="S4.SS3.p2.5.m5.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2">𝛽</ci><cn type="integer" id="S4.SS3.p2.5.m5.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">\beta=5</annotation></semantics></math>. However, as the <math id="S4.SS3.p2.6.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p2.6.m6.1a"><mi id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><ci id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">\beta</annotation></semantics></math> value decreases, incorporating a form of regularization into the local loss can outperform the vanilla FedAvg. With <math id="S4.SS3.p2.7.m7.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S4.SS3.p2.7.m7.1a"><mrow id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2" xref="S4.SS3.p2.7.m7.1.1.2.cmml">β</mi><mo id="S4.SS3.p2.7.m7.1.1.1" xref="S4.SS3.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><apply id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1"><eq id="S4.SS3.p2.7.m7.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1.1"></eq><ci id="S4.SS3.p2.7.m7.1.1.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2">𝛽</ci><cn type="float" id="S4.SS3.p2.7.m7.1.1.3.cmml" xref="S4.SS3.p2.7.m7.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">\beta=0.1</annotation></semantics></math>, our proposed FedIntR significantly outperforms the other approaches. We speculate that fine-grained regularization computed from intermediate representations and layer-wise contributions makes FedIntR more robust in FL environments with high degrees of data heterogeneity.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Scalability</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.11" class="ltx_p">To ensure that FedIntR is scalable in FL environments with a large number of clients, we conduct experiments on the CIFAR-10 dataset with 50 and 100 client settings (i.e., <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="N=50" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">N</mi><mo id="S4.SS4.p1.1.m1.1.1.1" xref="S4.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><eq id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1.1"></eq><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">N=50</annotation></semantics></math> and <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><eq id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></eq><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">N=100</annotation></semantics></math>). For both settings, we use the Dirichlet distribution with <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="\beta=0.5" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">β</mi><mo id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><eq id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></eq><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝛽</ci><cn type="float" id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">\beta=0.5</annotation></semantics></math> to partition the data, and 20% of the clients are chosen at random to participate in each training round. In particular, we uniformly sample 10 clients for <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="N=50" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mrow id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">N</mi><mo id="S4.SS4.p1.4.m4.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><eq id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1"></eq><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">N=50</annotation></semantics></math> and 20 clients for <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><mrow id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mi id="S4.SS4.p1.5.m5.1.1.2" xref="S4.SS4.p1.5.m5.1.1.2.cmml">N</mi><mo id="S4.SS4.p1.5.m5.1.1.1" xref="S4.SS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><eq id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1.1"></eq><ci id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p1.5.m5.1.1.3.cmml" xref="S4.SS4.p1.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">N=100</annotation></semantics></math> settings. For FedProx, <math id="S4.SS4.p1.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS4.p1.6.m6.1a"><mi id="S4.SS4.p1.6.m6.1.1" xref="S4.SS4.p1.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.1b"><ci id="S4.SS4.p1.6.m6.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.1c">\mu</annotation></semantics></math> value is set to 0.01, and for all other approaches, we experiment with both <math id="S4.SS4.p1.7.m7.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.SS4.p1.7.m7.1a"><mrow id="S4.SS4.p1.7.m7.1.1" xref="S4.SS4.p1.7.m7.1.1.cmml"><mi id="S4.SS4.p1.7.m7.1.1.2" xref="S4.SS4.p1.7.m7.1.1.2.cmml">μ</mi><mo id="S4.SS4.p1.7.m7.1.1.1" xref="S4.SS4.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.7.m7.1.1.3" xref="S4.SS4.p1.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m7.1b"><apply id="S4.SS4.p1.7.m7.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1"><eq id="S4.SS4.p1.7.m7.1.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1.1"></eq><ci id="S4.SS4.p1.7.m7.1.1.2.cmml" xref="S4.SS4.p1.7.m7.1.1.2">𝜇</ci><cn type="integer" id="S4.SS4.p1.7.m7.1.1.3.cmml" xref="S4.SS4.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m7.1c">\mu=1</annotation></semantics></math> and <math id="S4.SS4.p1.8.m8.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.SS4.p1.8.m8.1a"><mrow id="S4.SS4.p1.8.m8.1.1" xref="S4.SS4.p1.8.m8.1.1.cmml"><mi id="S4.SS4.p1.8.m8.1.1.2" xref="S4.SS4.p1.8.m8.1.1.2.cmml">μ</mi><mo id="S4.SS4.p1.8.m8.1.1.1" xref="S4.SS4.p1.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.8.m8.1.1.3" xref="S4.SS4.p1.8.m8.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m8.1b"><apply id="S4.SS4.p1.8.m8.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1"><eq id="S4.SS4.p1.8.m8.1.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1.1"></eq><ci id="S4.SS4.p1.8.m8.1.1.2.cmml" xref="S4.SS4.p1.8.m8.1.1.2">𝜇</ci><cn type="integer" id="S4.SS4.p1.8.m8.1.1.3.cmml" xref="S4.SS4.p1.8.m8.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m8.1c">\mu=10</annotation></semantics></math>. We set the number of training rounds <math id="S4.SS4.p1.9.m9.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS4.p1.9.m9.1a"><mi id="S4.SS4.p1.9.m9.1.1" xref="S4.SS4.p1.9.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m9.1b"><ci id="S4.SS4.p1.9.m9.1.1.cmml" xref="S4.SS4.p1.9.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m9.1c">T</annotation></semantics></math> as 800 for <math id="S4.SS4.p1.10.m10.1" class="ltx_Math" alttext="N=50" display="inline"><semantics id="S4.SS4.p1.10.m10.1a"><mrow id="S4.SS4.p1.10.m10.1.1" xref="S4.SS4.p1.10.m10.1.1.cmml"><mi id="S4.SS4.p1.10.m10.1.1.2" xref="S4.SS4.p1.10.m10.1.1.2.cmml">N</mi><mo id="S4.SS4.p1.10.m10.1.1.1" xref="S4.SS4.p1.10.m10.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.10.m10.1.1.3" xref="S4.SS4.p1.10.m10.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.10.m10.1b"><apply id="S4.SS4.p1.10.m10.1.1.cmml" xref="S4.SS4.p1.10.m10.1.1"><eq id="S4.SS4.p1.10.m10.1.1.1.cmml" xref="S4.SS4.p1.10.m10.1.1.1"></eq><ci id="S4.SS4.p1.10.m10.1.1.2.cmml" xref="S4.SS4.p1.10.m10.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p1.10.m10.1.1.3.cmml" xref="S4.SS4.p1.10.m10.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.10.m10.1c">N=50</annotation></semantics></math> and 1000 for <math id="S4.SS4.p1.11.m11.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS4.p1.11.m11.1a"><mrow id="S4.SS4.p1.11.m11.1.1" xref="S4.SS4.p1.11.m11.1.1.cmml"><mi id="S4.SS4.p1.11.m11.1.1.2" xref="S4.SS4.p1.11.m11.1.1.2.cmml">N</mi><mo id="S4.SS4.p1.11.m11.1.1.1" xref="S4.SS4.p1.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.11.m11.1.1.3" xref="S4.SS4.p1.11.m11.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.11.m11.1b"><apply id="S4.SS4.p1.11.m11.1.1.cmml" xref="S4.SS4.p1.11.m11.1.1"><eq id="S4.SS4.p1.11.m11.1.1.1.cmml" xref="S4.SS4.p1.11.m11.1.1.1"></eq><ci id="S4.SS4.p1.11.m11.1.1.2.cmml" xref="S4.SS4.p1.11.m11.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p1.11.m11.1.1.3.cmml" xref="S4.SS4.p1.11.m11.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.11.m11.1c">N=100</annotation></semantics></math>.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.12" class="ltx_p">From Table <a href="#S4.T4" title="TABLE IV ‣ IV-B Accuracy on Different Datasets ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>, we can observe that vanilla FedAvg outperforms the majority of other approaches in the early training rounds (i.e., <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="T=100" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mrow id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">T</mi><mo id="S4.SS4.p2.1.m1.1.1.1" xref="S4.SS4.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><eq id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1.1"></eq><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">T=100</annotation></semantics></math> and <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">T</mi><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><eq id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1"></eq><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">𝑇</ci><cn type="integer" id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">T=200</annotation></semantics></math>) for both <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="N=50" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><mrow id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml">N</mi><mo id="S4.SS4.p2.3.m3.1.1.1" xref="S4.SS4.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><eq id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1.1"></eq><ci id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">N=50</annotation></semantics></math> and <math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><mrow id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml"><mi id="S4.SS4.p2.4.m4.1.1.2" xref="S4.SS4.p2.4.m4.1.1.2.cmml">N</mi><mo id="S4.SS4.p2.4.m4.1.1.1" xref="S4.SS4.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.4.m4.1.1.3" xref="S4.SS4.p2.4.m4.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><apply id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1"><eq id="S4.SS4.p2.4.m4.1.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1.1"></eq><ci id="S4.SS4.p2.4.m4.1.1.2.cmml" xref="S4.SS4.p2.4.m4.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p2.4.m4.1.1.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">N=100</annotation></semantics></math> settings. This is due to the fact that the local training loss in FedAvg focuses only on performance improvement, whereas the other approaches include a regularization term with additional objectives. However, with a sufficient number of training rounds, FedIntR with <math id="S4.SS4.p2.5.m5.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.SS4.p2.5.m5.1a"><mrow id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml"><mi id="S4.SS4.p2.5.m5.1.1.2" xref="S4.SS4.p2.5.m5.1.1.2.cmml">μ</mi><mo id="S4.SS4.p2.5.m5.1.1.1" xref="S4.SS4.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.5.m5.1.1.3" xref="S4.SS4.p2.5.m5.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><apply id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1"><eq id="S4.SS4.p2.5.m5.1.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1.1"></eq><ci id="S4.SS4.p2.5.m5.1.1.2.cmml" xref="S4.SS4.p2.5.m5.1.1.2">𝜇</ci><cn type="integer" id="S4.SS4.p2.5.m5.1.1.3.cmml" xref="S4.SS4.p2.5.m5.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">\mu=10</annotation></semantics></math> can significantly outperform all other approaches. In the <math id="S4.SS4.p2.6.m6.1" class="ltx_Math" alttext="N=50" display="inline"><semantics id="S4.SS4.p2.6.m6.1a"><mrow id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml"><mi id="S4.SS4.p2.6.m6.1.1.2" xref="S4.SS4.p2.6.m6.1.1.2.cmml">N</mi><mo id="S4.SS4.p2.6.m6.1.1.1" xref="S4.SS4.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.6.m6.1.1.3" xref="S4.SS4.p2.6.m6.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b"><apply id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1"><eq id="S4.SS4.p2.6.m6.1.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1.1"></eq><ci id="S4.SS4.p2.6.m6.1.1.2.cmml" xref="S4.SS4.p2.6.m6.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p2.6.m6.1.1.3.cmml" xref="S4.SS4.p2.6.m6.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">N=50</annotation></semantics></math> setting, FedIntR (<math id="S4.SS4.p2.7.m7.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.SS4.p2.7.m7.1a"><mrow id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml"><mi id="S4.SS4.p2.7.m7.1.1.2" xref="S4.SS4.p2.7.m7.1.1.2.cmml">μ</mi><mo id="S4.SS4.p2.7.m7.1.1.1" xref="S4.SS4.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.7.m7.1.1.3" xref="S4.SS4.p2.7.m7.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b"><apply id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1"><eq id="S4.SS4.p2.7.m7.1.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1.1"></eq><ci id="S4.SS4.p2.7.m7.1.1.2.cmml" xref="S4.SS4.p2.7.m7.1.1.2">𝜇</ci><cn type="integer" id="S4.SS4.p2.7.m7.1.1.3.cmml" xref="S4.SS4.p2.7.m7.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">\mu=10</annotation></semantics></math>) outperforms the second best approach, FedProx, by 1.19% at <math id="S4.SS4.p2.8.m8.1" class="ltx_Math" alttext="T=800" display="inline"><semantics id="S4.SS4.p2.8.m8.1a"><mrow id="S4.SS4.p2.8.m8.1.1" xref="S4.SS4.p2.8.m8.1.1.cmml"><mi id="S4.SS4.p2.8.m8.1.1.2" xref="S4.SS4.p2.8.m8.1.1.2.cmml">T</mi><mo id="S4.SS4.p2.8.m8.1.1.1" xref="S4.SS4.p2.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.8.m8.1.1.3" xref="S4.SS4.p2.8.m8.1.1.3.cmml">800</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m8.1b"><apply id="S4.SS4.p2.8.m8.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1"><eq id="S4.SS4.p2.8.m8.1.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1.1"></eq><ci id="S4.SS4.p2.8.m8.1.1.2.cmml" xref="S4.SS4.p2.8.m8.1.1.2">𝑇</ci><cn type="integer" id="S4.SS4.p2.8.m8.1.1.3.cmml" xref="S4.SS4.p2.8.m8.1.1.3">800</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.1c">T=800</annotation></semantics></math>, and in the <math id="S4.SS4.p2.9.m9.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS4.p2.9.m9.1a"><mrow id="S4.SS4.p2.9.m9.1.1" xref="S4.SS4.p2.9.m9.1.1.cmml"><mi id="S4.SS4.p2.9.m9.1.1.2" xref="S4.SS4.p2.9.m9.1.1.2.cmml">N</mi><mo id="S4.SS4.p2.9.m9.1.1.1" xref="S4.SS4.p2.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.9.m9.1.1.3" xref="S4.SS4.p2.9.m9.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.9.m9.1b"><apply id="S4.SS4.p2.9.m9.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1"><eq id="S4.SS4.p2.9.m9.1.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1.1"></eq><ci id="S4.SS4.p2.9.m9.1.1.2.cmml" xref="S4.SS4.p2.9.m9.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p2.9.m9.1.1.3.cmml" xref="S4.SS4.p2.9.m9.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.9.m9.1c">N=100</annotation></semantics></math> setting, it outperforms MOON (<math id="S4.SS4.p2.10.m10.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.SS4.p2.10.m10.1a"><mrow id="S4.SS4.p2.10.m10.1.1" xref="S4.SS4.p2.10.m10.1.1.cmml"><mi id="S4.SS4.p2.10.m10.1.1.2" xref="S4.SS4.p2.10.m10.1.1.2.cmml">μ</mi><mo id="S4.SS4.p2.10.m10.1.1.1" xref="S4.SS4.p2.10.m10.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.10.m10.1.1.3" xref="S4.SS4.p2.10.m10.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.10.m10.1b"><apply id="S4.SS4.p2.10.m10.1.1.cmml" xref="S4.SS4.p2.10.m10.1.1"><eq id="S4.SS4.p2.10.m10.1.1.1.cmml" xref="S4.SS4.p2.10.m10.1.1.1"></eq><ci id="S4.SS4.p2.10.m10.1.1.2.cmml" xref="S4.SS4.p2.10.m10.1.1.2">𝜇</ci><cn type="integer" id="S4.SS4.p2.10.m10.1.1.3.cmml" xref="S4.SS4.p2.10.m10.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.10.m10.1c">\mu=10</annotation></semantics></math>) by 1.45% at <math id="S4.SS4.p2.11.m11.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S4.SS4.p2.11.m11.1a"><mrow id="S4.SS4.p2.11.m11.1.1" xref="S4.SS4.p2.11.m11.1.1.cmml"><mi id="S4.SS4.p2.11.m11.1.1.2" xref="S4.SS4.p2.11.m11.1.1.2.cmml">T</mi><mo id="S4.SS4.p2.11.m11.1.1.1" xref="S4.SS4.p2.11.m11.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.11.m11.1.1.3" xref="S4.SS4.p2.11.m11.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.11.m11.1b"><apply id="S4.SS4.p2.11.m11.1.1.cmml" xref="S4.SS4.p2.11.m11.1.1"><eq id="S4.SS4.p2.11.m11.1.1.1.cmml" xref="S4.SS4.p2.11.m11.1.1.1"></eq><ci id="S4.SS4.p2.11.m11.1.1.2.cmml" xref="S4.SS4.p2.11.m11.1.1.2">𝑇</ci><cn type="integer" id="S4.SS4.p2.11.m11.1.1.3.cmml" xref="S4.SS4.p2.11.m11.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.11.m11.1c">T=1000</annotation></semantics></math>. Fig. <a href="#S4.F4" title="Figure 4 ‣ IV-D Scalability ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the test accuracy values of different methods in each round for the <math id="S4.SS4.p2.12.m12.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS4.p2.12.m12.1a"><mrow id="S4.SS4.p2.12.m12.1.1" xref="S4.SS4.p2.12.m12.1.1.cmml"><mi id="S4.SS4.p2.12.m12.1.1.2" xref="S4.SS4.p2.12.m12.1.1.2.cmml">N</mi><mo id="S4.SS4.p2.12.m12.1.1.1" xref="S4.SS4.p2.12.m12.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.12.m12.1.1.3" xref="S4.SS4.p2.12.m12.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.12.m12.1b"><apply id="S4.SS4.p2.12.m12.1.1.cmml" xref="S4.SS4.p2.12.m12.1.1"><eq id="S4.SS4.p2.12.m12.1.1.1.cmml" xref="S4.SS4.p2.12.m12.1.1.1"></eq><ci id="S4.SS4.p2.12.m12.1.1.2.cmml" xref="S4.SS4.p2.12.m12.1.1.2">𝑁</ci><cn type="integer" id="S4.SS4.p2.12.m12.1.1.3.cmml" xref="S4.SS4.p2.12.m12.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.12.m12.1c">N=100</annotation></semantics></math> setting.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2210.15827/assets/x6.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="304" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Test accuracy (%) on CIFAR-10 dataset with number of clients <math id="S4.F4.2.m1.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.F4.2.m1.1b"><mrow id="S4.F4.2.m1.1.1" xref="S4.F4.2.m1.1.1.cmml"><mi id="S4.F4.2.m1.1.1.2" xref="S4.F4.2.m1.1.1.2.cmml">N</mi><mo id="S4.F4.2.m1.1.1.1" xref="S4.F4.2.m1.1.1.1.cmml">=</mo><mn id="S4.F4.2.m1.1.1.3" xref="S4.F4.2.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><apply id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1"><eq id="S4.F4.2.m1.1.1.1.cmml" xref="S4.F4.2.m1.1.1.1"></eq><ci id="S4.F4.2.m1.1.1.2.cmml" xref="S4.F4.2.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.F4.2.m1.1.1.3.cmml" xref="S4.F4.2.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">N=100</annotation></semantics></math>. </figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Number of Local Epochs</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.5" class="ltx_p">Using the CIFAR-10 dataset, we also explore the effects of the number of local epochs <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">E</annotation></semantics></math> on different approaches. The experiments are performed using 1, 5, 10 (default), 20, and 40 local epochs with 100 rounds of training. For each approach, we use the same <math id="S4.SS5.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS5.p1.2.m2.1a"><mi id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><ci id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\mu</annotation></semantics></math> values tuned with the CIFAR-10 dataset in Section <a href="#S4.SS2" title="IV-B Accuracy on Different Datasets ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a> and the results are shown in Fig. <a href="#S4.F5" title="Figure 5 ‣ IV-E Number of Local Epochs ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Consistent with the findings in MOON, setting <math id="S4.SS5.p1.3.m3.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S4.SS5.p1.3.m3.1a"><mrow id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml"><mi id="S4.SS5.p1.3.m3.1.1.2" xref="S4.SS5.p1.3.m3.1.1.2.cmml">E</mi><mo id="S4.SS5.p1.3.m3.1.1.1" xref="S4.SS5.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.3.m3.1.1.3" xref="S4.SS5.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><apply id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1"><eq id="S4.SS5.p1.3.m3.1.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1.1"></eq><ci id="S4.SS5.p1.3.m3.1.1.2.cmml" xref="S4.SS5.p1.3.m3.1.1.2">𝐸</ci><cn type="integer" id="S4.SS5.p1.3.m3.1.1.3.cmml" xref="S4.SS5.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">E=1</annotation></semantics></math> results in poor accuracy for all approaches, while setting <math id="S4.SS5.p1.4.m4.1" class="ltx_Math" alttext="E=10" display="inline"><semantics id="S4.SS5.p1.4.m4.1a"><mrow id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml"><mi id="S4.SS5.p1.4.m4.1.1.2" xref="S4.SS5.p1.4.m4.1.1.2.cmml">E</mi><mo id="S4.SS5.p1.4.m4.1.1.1" xref="S4.SS5.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.4.m4.1.1.3" xref="S4.SS5.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><apply id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1"><eq id="S4.SS5.p1.4.m4.1.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1.1"></eq><ci id="S4.SS5.p1.4.m4.1.1.2.cmml" xref="S4.SS5.p1.4.m4.1.1.2">𝐸</ci><cn type="integer" id="S4.SS5.p1.4.m4.1.1.3.cmml" xref="S4.SS5.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">E=10</annotation></semantics></math> enables them to achieve their best performance. Due to the drift towards the local data distribution, using a larger number of local epochs (i.e., 20 or 40) can decrease the performance for all approaches. Nonetheless, our proposed method, FedIntR, achieves the best performance in most settings except <math id="S4.SS5.p1.5.m5.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S4.SS5.p1.5.m5.1a"><mrow id="S4.SS5.p1.5.m5.1.1" xref="S4.SS5.p1.5.m5.1.1.cmml"><mi id="S4.SS5.p1.5.m5.1.1.2" xref="S4.SS5.p1.5.m5.1.1.2.cmml">E</mi><mo id="S4.SS5.p1.5.m5.1.1.1" xref="S4.SS5.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS5.p1.5.m5.1.1.3" xref="S4.SS5.p1.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.5.m5.1b"><apply id="S4.SS5.p1.5.m5.1.1.cmml" xref="S4.SS5.p1.5.m5.1.1"><eq id="S4.SS5.p1.5.m5.1.1.1.cmml" xref="S4.SS5.p1.5.m5.1.1.1"></eq><ci id="S4.SS5.p1.5.m5.1.1.2.cmml" xref="S4.SS5.p1.5.m5.1.1.2">𝐸</ci><cn type="integer" id="S4.SS5.p1.5.m5.1.1.3.cmml" xref="S4.SS5.p1.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.5.m5.1c">E=5</annotation></semantics></math>.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2210.15827/assets/x7.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="452" height="271" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Test accuracy (%) with different numbers of local epochs on the CIFAR-10 dataset. For each approach, we use the same <math id="S4.F5.2.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.F5.2.m1.1b"><mi id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><ci id="S4.F5.2.m1.1.1.cmml" xref="S4.F5.2.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">\mu</annotation></semantics></math> values tuned with the CIFAR-10 dataset as in Table <a href="#S4.T1" title="TABLE I ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS6.5.1.1" class="ltx_text">IV-F</span> </span><span id="S4.SS6.6.2" class="ltx_text ltx_font_italic">Ablation on Layer-wise Weights</span>
</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.5" class="ltx_p">FedIntR makes use of the layer-wise weight <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><msub id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><mi id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml">α</mi><mi id="S4.SS6.p1.1.m1.1.1.3" xref="S4.SS6.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS6.p1.1.m1.1.1.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2">𝛼</ci><ci id="S4.SS6.p1.1.m1.1.1.3.cmml" xref="S4.SS6.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">\alpha_{k}</annotation></semantics></math> that determines the contribution of each individual representation loss <math id="S4.SS6.p1.2.m2.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S4.SS6.p1.2.m2.1a"><msub id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS6.p1.2.m2.1.1.2" xref="S4.SS6.p1.2.m2.1.1.2.cmml">ℓ</mi><mi id="S4.SS6.p1.2.m2.1.1.3" xref="S4.SS6.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><apply id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.2.m2.1.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p1.2.m2.1.1.2.cmml" xref="S4.SS6.p1.2.m2.1.1.2">ℓ</ci><ci id="S4.SS6.p1.2.m2.1.1.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\ell_{k}</annotation></semantics></math> to the regularization term. To ensure that <math id="S4.SS6.p1.3.m3.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S4.SS6.p1.3.m3.1a"><msub id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml"><mi id="S4.SS6.p1.3.m3.1.1.2" xref="S4.SS6.p1.3.m3.1.1.2.cmml">α</mi><mi id="S4.SS6.p1.3.m3.1.1.3" xref="S4.SS6.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><apply id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.3.m3.1.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS6.p1.3.m3.1.1.2.cmml" xref="S4.SS6.p1.3.m3.1.1.2">𝛼</ci><ci id="S4.SS6.p1.3.m3.1.1.3.cmml" xref="S4.SS6.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.3.m3.1c">\alpha_{k}</annotation></semantics></math> is a crucial component of FedIntR for improving the performance, we conduct an ablation study by computing the regularization term in an alternative way. Instead of incorporating <math id="S4.SS6.p1.4.m4.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S4.SS6.p1.4.m4.1a"><msub id="S4.SS6.p1.4.m4.1.1" xref="S4.SS6.p1.4.m4.1.1.cmml"><mi id="S4.SS6.p1.4.m4.1.1.2" xref="S4.SS6.p1.4.m4.1.1.2.cmml">α</mi><mi id="S4.SS6.p1.4.m4.1.1.3" xref="S4.SS6.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.4.m4.1b"><apply id="S4.SS6.p1.4.m4.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.4.m4.1.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS6.p1.4.m4.1.1.2.cmml" xref="S4.SS6.p1.4.m4.1.1.2">𝛼</ci><ci id="S4.SS6.p1.4.m4.1.1.3.cmml" xref="S4.SS6.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.4.m4.1c">\alpha_{k}</annotation></semantics></math> into the regularization term, we use the average of <math id="S4.SS6.p1.5.m5.1" class="ltx_Math" alttext="[\ell_{k}]_{k=1}^{K}" display="inline"><semantics id="S4.SS6.p1.5.m5.1a"><msubsup id="S4.SS6.p1.5.m5.1.1" xref="S4.SS6.p1.5.m5.1.1.cmml"><mrow id="S4.SS6.p1.5.m5.1.1.1.1.1" xref="S4.SS6.p1.5.m5.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS6.p1.5.m5.1.1.1.1.1.2" xref="S4.SS6.p1.5.m5.1.1.1.1.2.1.cmml">[</mo><msub id="S4.SS6.p1.5.m5.1.1.1.1.1.1" xref="S4.SS6.p1.5.m5.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.SS6.p1.5.m5.1.1.1.1.1.1.2" xref="S4.SS6.p1.5.m5.1.1.1.1.1.1.2.cmml">ℓ</mi><mi id="S4.SS6.p1.5.m5.1.1.1.1.1.1.3" xref="S4.SS6.p1.5.m5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS6.p1.5.m5.1.1.1.1.1.3" xref="S4.SS6.p1.5.m5.1.1.1.1.2.1.cmml">]</mo></mrow><mrow id="S4.SS6.p1.5.m5.1.1.1.3" xref="S4.SS6.p1.5.m5.1.1.1.3.cmml"><mi id="S4.SS6.p1.5.m5.1.1.1.3.2" xref="S4.SS6.p1.5.m5.1.1.1.3.2.cmml">k</mi><mo id="S4.SS6.p1.5.m5.1.1.1.3.1" xref="S4.SS6.p1.5.m5.1.1.1.3.1.cmml">=</mo><mn id="S4.SS6.p1.5.m5.1.1.1.3.3" xref="S4.SS6.p1.5.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS6.p1.5.m5.1.1.3" xref="S4.SS6.p1.5.m5.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.5.m5.1b"><apply id="S4.SS6.p1.5.m5.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.5.m5.1.1.2.cmml" xref="S4.SS6.p1.5.m5.1.1">superscript</csymbol><apply id="S4.SS6.p1.5.m5.1.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.5.m5.1.1.1.2.cmml" xref="S4.SS6.p1.5.m5.1.1">subscript</csymbol><apply id="S4.SS6.p1.5.m5.1.1.1.1.2.cmml" xref="S4.SS6.p1.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS6.p1.5.m5.1.1.1.1.2.1.cmml" xref="S4.SS6.p1.5.m5.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS6.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS6.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS6.p1.5.m5.1.1.1.1.1.1.2">ℓ</ci><ci id="S4.SS6.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS6.p1.5.m5.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S4.SS6.p1.5.m5.1.1.1.3.cmml" xref="S4.SS6.p1.5.m5.1.1.1.3"><eq id="S4.SS6.p1.5.m5.1.1.1.3.1.cmml" xref="S4.SS6.p1.5.m5.1.1.1.3.1"></eq><ci id="S4.SS6.p1.5.m5.1.1.1.3.2.cmml" xref="S4.SS6.p1.5.m5.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.SS6.p1.5.m5.1.1.1.3.3.cmml" xref="S4.SS6.p1.5.m5.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS6.p1.5.m5.1.1.3.cmml" xref="S4.SS6.p1.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.5.m5.1c">[\ell_{k}]_{k=1}^{K}</annotation></semantics></math> as the regularization term. Specifically, we apply the local loss function defined as follows:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\mathcal{L}=\ell_{sup}+\frac{\mu}{K}\sum^{K}_{k=1}\ell_{k}." display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><msub id="S4.E6.m1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S4.E6.m1.1.1.1.1.3.2.2" xref="S4.E6.m1.1.1.1.1.3.2.2.cmml">ℓ</mi><mrow id="S4.E6.m1.1.1.1.1.3.2.3" xref="S4.E6.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.2.3.2" xref="S4.E6.m1.1.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.3.2.3.1" xref="S4.E6.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.3.2.3.3" xref="S4.E6.m1.1.1.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.3.2.3.1a" xref="S4.E6.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.3.2.3.4" xref="S4.E6.m1.1.1.1.1.3.2.3.4.cmml">p</mi></mrow></msub><mo id="S4.E6.m1.1.1.1.1.3.1" xref="S4.E6.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.cmml"><mfrac id="S4.E6.m1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E6.m1.1.1.1.1.3.3.2.2" xref="S4.E6.m1.1.1.1.1.3.3.2.2.cmml">μ</mi><mi id="S4.E6.m1.1.1.1.1.3.3.2.3" xref="S4.E6.m1.1.1.1.1.3.3.2.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.3.3.1" xref="S4.E6.m1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.3.3.3.cmml"><munderover id="S4.E6.m1.1.1.1.1.3.3.3.1" xref="S4.E6.m1.1.1.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S4.E6.m1.1.1.1.1.3.3.3.1.2.2" xref="S4.E6.m1.1.1.1.1.3.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E6.m1.1.1.1.1.3.3.3.1.3" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.3.3.1.3.2" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3.2.cmml">k</mi><mo id="S4.E6.m1.1.1.1.1.3.3.3.1.3.1" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3.1.cmml">=</mo><mn id="S4.E6.m1.1.1.1.1.3.3.3.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.1.1.1.1.3.3.3.1.2.3" xref="S4.E6.m1.1.1.1.1.3.3.3.1.2.3.cmml">K</mi></munderover><msub id="S4.E6.m1.1.1.1.1.3.3.3.2" xref="S4.E6.m1.1.1.1.1.3.3.3.2.cmml"><mi mathvariant="normal" id="S4.E6.m1.1.1.1.1.3.3.3.2.2" xref="S4.E6.m1.1.1.1.1.3.3.3.2.2.cmml">ℓ</mi><mi id="S4.E6.m1.1.1.1.1.3.3.3.2.3" xref="S4.E6.m1.1.1.1.1.3.3.3.2.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><eq id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"></eq><ci id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2">ℒ</ci><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><plus id="S4.E6.m1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.1"></plus><apply id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2.2">ℓ</ci><apply id="S4.E6.m1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3"><times id="S4.E6.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E6.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.2">𝑠</ci><ci id="S4.E6.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.3">𝑢</ci><ci id="S4.E6.m1.1.1.1.1.3.2.3.4.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.4">𝑝</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3"><times id="S4.E6.m1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.1"></times><apply id="S4.E6.m1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2"><divide id="S4.E6.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2"></divide><ci id="S4.E6.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2.2">𝜇</ci><ci id="S4.E6.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2.3">𝐾</ci></apply><apply id="S4.E6.m1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3"><apply id="S4.E6.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1">subscript</csymbol><apply id="S4.E6.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.3.3.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1">superscript</csymbol><sum id="S4.E6.m1.1.1.1.1.3.3.3.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1.2.2"></sum><ci id="S4.E6.m1.1.1.1.1.3.3.3.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1.2.3">𝐾</ci></apply><apply id="S4.E6.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3"><eq id="S4.E6.m1.1.1.1.1.3.3.3.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3.1"></eq><ci id="S4.E6.m1.1.1.1.1.3.3.3.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3.2">𝑘</ci><cn type="integer" id="S4.E6.m1.1.1.1.1.3.3.3.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.1.3.3">1</cn></apply></apply><apply id="S4.E6.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.2.2">ℓ</ci><ci id="S4.E6.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\mathcal{L}=\ell_{sup}+\frac{\mu}{K}\sum^{K}_{k=1}\ell_{k}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.5" class="ltx_p">In Table <a href="#S4.T5" title="TABLE V ‣ IV-F Ablation on Layer-wise Weights ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, we compare the performance of FedIntR with and without <math id="S4.SS6.p2.1.m1.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S4.SS6.p2.1.m1.1a"><msub id="S4.SS6.p2.1.m1.1.1" xref="S4.SS6.p2.1.m1.1.1.cmml"><mi id="S4.SS6.p2.1.m1.1.1.2" xref="S4.SS6.p2.1.m1.1.1.2.cmml">α</mi><mi id="S4.SS6.p2.1.m1.1.1.3" xref="S4.SS6.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.1.m1.1b"><apply id="S4.SS6.p2.1.m1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.1.m1.1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS6.p2.1.m1.1.1.2.cmml" xref="S4.SS6.p2.1.m1.1.1.2">𝛼</ci><ci id="S4.SS6.p2.1.m1.1.1.3.cmml" xref="S4.SS6.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.1.m1.1c">\alpha_{k}</annotation></semantics></math> on four datasets. We can observe that calculating a layer-wise weight <math id="S4.SS6.p2.2.m2.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S4.SS6.p2.2.m2.1a"><msub id="S4.SS6.p2.2.m2.1.1" xref="S4.SS6.p2.2.m2.1.1.cmml"><mi id="S4.SS6.p2.2.m2.1.1.2" xref="S4.SS6.p2.2.m2.1.1.2.cmml">α</mi><mi id="S4.SS6.p2.2.m2.1.1.3" xref="S4.SS6.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.2.m2.1b"><apply id="S4.SS6.p2.2.m2.1.1.cmml" xref="S4.SS6.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.2.m2.1.1.1.cmml" xref="S4.SS6.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p2.2.m2.1.1.2.cmml" xref="S4.SS6.p2.2.m2.1.1.2">𝛼</ci><ci id="S4.SS6.p2.2.m2.1.1.3.cmml" xref="S4.SS6.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.2.m2.1c">\alpha_{k}</annotation></semantics></math> for its corresponding representation loss <math id="S4.SS6.p2.3.m3.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S4.SS6.p2.3.m3.1a"><msub id="S4.SS6.p2.3.m3.1.1" xref="S4.SS6.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS6.p2.3.m3.1.1.2" xref="S4.SS6.p2.3.m3.1.1.2.cmml">ℓ</mi><mi id="S4.SS6.p2.3.m3.1.1.3" xref="S4.SS6.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.3.m3.1b"><apply id="S4.SS6.p2.3.m3.1.1.cmml" xref="S4.SS6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.3.m3.1.1.1.cmml" xref="S4.SS6.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS6.p2.3.m3.1.1.2.cmml" xref="S4.SS6.p2.3.m3.1.1.2">ℓ</ci><ci id="S4.SS6.p2.3.m3.1.1.3.cmml" xref="S4.SS6.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.3.m3.1c">\ell_{k}</annotation></semantics></math> can significantly improve the performance of the resulting global model. <math id="S4.SS6.p2.4.m4.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S4.SS6.p2.4.m4.1a"><msub id="S4.SS6.p2.4.m4.1.1" xref="S4.SS6.p2.4.m4.1.1.cmml"><mi id="S4.SS6.p2.4.m4.1.1.2" xref="S4.SS6.p2.4.m4.1.1.2.cmml">α</mi><mi id="S4.SS6.p2.4.m4.1.1.3" xref="S4.SS6.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.4.m4.1b"><apply id="S4.SS6.p2.4.m4.1.1.cmml" xref="S4.SS6.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.4.m4.1.1.1.cmml" xref="S4.SS6.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS6.p2.4.m4.1.1.2.cmml" xref="S4.SS6.p2.4.m4.1.1.2">𝛼</ci><ci id="S4.SS6.p2.4.m4.1.1.3.cmml" xref="S4.SS6.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.4.m4.1c">\alpha_{k}</annotation></semantics></math> determines the contribution of individual <math id="S4.SS6.p2.5.m5.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S4.SS6.p2.5.m5.1a"><msub id="S4.SS6.p2.5.m5.1.1" xref="S4.SS6.p2.5.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS6.p2.5.m5.1.1.2" xref="S4.SS6.p2.5.m5.1.1.2.cmml">ℓ</mi><mi id="S4.SS6.p2.5.m5.1.1.3" xref="S4.SS6.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.5.m5.1b"><apply id="S4.SS6.p2.5.m5.1.1.cmml" xref="S4.SS6.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.5.m5.1.1.1.cmml" xref="S4.SS6.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS6.p2.5.m5.1.1.2.cmml" xref="S4.SS6.p2.5.m5.1.1.2">ℓ</ci><ci id="S4.SS6.p2.5.m5.1.1.3.cmml" xref="S4.SS6.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.5.m5.1c">\ell_{k}</annotation></semantics></math> to the regularization term, enabling FedIntR to perform local training with fine-grained regularization.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Test accuracy (%) of FedIntR with and without <math id="S4.T5.3.m1.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S4.T5.3.m1.1b"><msub id="S4.T5.3.m1.1.1" xref="S4.T5.3.m1.1.1.cmml"><mi id="S4.T5.3.m1.1.1.2" xref="S4.T5.3.m1.1.1.2.cmml">α</mi><mi id="S4.T5.3.m1.1.1.3" xref="S4.T5.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T5.3.m1.1c"><apply id="S4.T5.3.m1.1.1.cmml" xref="S4.T5.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.3.m1.1.1.1.cmml" xref="S4.T5.3.m1.1.1">subscript</csymbol><ci id="S4.T5.3.m1.1.1.2.cmml" xref="S4.T5.3.m1.1.1.2">𝛼</ci><ci id="S4.T5.3.m1.1.1.3.cmml" xref="S4.T5.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.m1.1d">\alpha_{i}</annotation></semantics></math> for different datasets. We use the same <math id="S4.T5.4.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.T5.4.m2.1b"><mi id="S4.T5.4.m2.1.1" xref="S4.T5.4.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.T5.4.m2.1c"><ci id="S4.T5.4.m2.1.1.cmml" xref="S4.T5.4.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.m2.1d">\mu</annotation></semantics></math> values tuned for each dataset as in Table <a href="#S4.T1" title="TABLE I ‣ IV-A Experimental Settings ‣ IV Experiments ‣ Federated Learning with Intermediate Representation Regularization This work was supported by the Institute of Information and Communications Technology Planning and Evaluation (IITP) Grant funded by the Korea Government (MSIT) (Artificial Intelligence Innovation Hub) under Grant 2021-0-02068 and in part by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2020R1A4A1018607) *Dr. CS Hong is the corresponding author." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</figcaption>
<table id="S4.T5.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T5.5.2.1" class="ltx_tr">
<th id="S4.T5.5.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T5.5.2.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S4.T5.5.2.1.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">
<table id="S4.T5.5.2.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T5.5.2.1.2.1.1" class="ltx_tr">
<td id="S4.T5.5.2.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Fashion-</td>
</tr>
<tr id="S4.T5.5.2.1.2.1.2" class="ltx_tr">
<td id="S4.T5.5.2.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">MNIST</td>
</tr>
</table>
</td>
<td id="S4.T5.5.2.1.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">SVHN</td>
<td id="S4.T5.5.2.1.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">CIFAR-10</td>
<td id="S4.T5.5.2.1.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">CIFAR-100</td>
</tr>
<tr id="S4.T5.5.1" class="ltx_tr">
<th id="S4.T5.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T5.5.1.1.1" class="ltx_ERROR undefined">\hlineB</span>3
<math id="S4.T5.5.1.1.m1.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S4.T5.5.1.1.m1.1a"><msub id="S4.T5.5.1.1.m1.1.1" xref="S4.T5.5.1.1.m1.1.1.cmml"><mi id="S4.T5.5.1.1.m1.1.1.2" xref="S4.T5.5.1.1.m1.1.1.2.cmml">α</mi><mi id="S4.T5.5.1.1.m1.1.1.3" xref="S4.T5.5.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T5.5.1.1.m1.1b"><apply id="S4.T5.5.1.1.m1.1.1.cmml" xref="S4.T5.5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T5.5.1.1.m1.1.1.1.cmml" xref="S4.T5.5.1.1.m1.1.1">subscript</csymbol><ci id="S4.T5.5.1.1.m1.1.1.2.cmml" xref="S4.T5.5.1.1.m1.1.1.2">𝛼</ci><ci id="S4.T5.5.1.1.m1.1.1.3.cmml" xref="S4.T5.5.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.1.1.m1.1c">\alpha_{i}</annotation></semantics></math>
</th>
<td id="S4.T5.5.1.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.5.1.2.1" class="ltx_text ltx_font_bold">89.15</span></td>
<td id="S4.T5.5.1.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.5.1.3.1" class="ltx_text ltx_font_bold">87.17</span></td>
<td id="S4.T5.5.1.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.5.1.4.1" class="ltx_text ltx_font_bold">67.23</span></td>
<td id="S4.T5.5.1.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T5.5.1.5.1" class="ltx_text ltx_font_bold">41.48</span></td>
</tr>
<tr id="S4.T5.5.3.2" class="ltx_tr">
<th id="S4.T5.5.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Average</th>
<td id="S4.T5.5.3.2.2" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">89.03</td>
<td id="S4.T5.5.3.2.3" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">85.62</td>
<td id="S4.T5.5.3.2.4" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">64.20</td>
<td id="S4.T5.5.3.2.5" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">40.33</td>
</tr>
<tr id="S4.T5.5.4.3" class="ltx_tr">
<th id="S4.T5.5.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">
<span id="S4.T5.5.4.3.1.1" class="ltx_ERROR undefined">\hlineB</span>3</th>
<td id="S4.T5.5.4.3.2" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T5.5.4.3.3" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T5.5.4.3.4" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
<td id="S4.T5.5.4.3.5" class="ltx_td" style="padding-top:1pt;padding-bottom:1pt;"></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Nowadays, data valuable for powering intelligent services may be distributed over numerous personal edge devices. This renders data collection impractical due to privacy concerns, and hence the role of federated learning substantially grows. Client data heterogeneity in FL is one major shortcoming that is responsible for the poor performance of global model. To mitigate this, we propose FedIntR, which introduces a simple and effective regularization term to complement the local training process of FL. FedIntR uses intermediate layer representations to incorporate more information into the regularization process. Moreover, the layer-wise weights in FedIntR automatically determine each representation’s contribution to the regularization term. This enables FedIntR to produce fine-grained regularization for the local training process, thus enhancing the global model performance. We conduct extensive experiments on various datasets and FL settings to examine the efficacy of FedIntR. Comparison between FedIntR and various state-of-the-art methods demonstrates that FedIntR achieves superior performance in most settings.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
P. Voigt and A. v. d. Bussche, <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">The EU General Data Protection Regulation
(GDPR): A Practical Guide</em>, 1st ed.   Springer Publishing Company, Incorporated, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Advances
and open problems in federated learning,” <em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">Foundations and
Trends® in Machine Learning</em>, vol. 14, no. 1–2, pp. 1–210,
2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. S. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Magazine</em>, vol. 37, pp. 50–60, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of
Machine Learning and Systems</em>, vol. 2, pp. 429–450, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. Reddi, S. Stich, and A. T. Suresh,
“Scaffold: Stochastic controlled averaging for federated learning,” in
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2020, pp. 5132–5143.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Q. Li, B. He, and D. Song, “Model-contrastive federated learning,” in
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition</em>, 2021, pp. 10 713–10 722.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
H. M. Son, M. H. Kim, and T.-M. Chung, “Compare where it matters: Using
layer-wise regularization to improve federated learning on heterogeneous
data,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.00407</em>, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
T. Chen, S. Kornblith, M. Norouzi, and G. Hinton, “A simple framework for
contrastive learning of visual representations,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">International
conference on machine learning</em>.   PMLR,
2020, pp. 1597–1607.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
K. He, H. Fan, Y. Wu, S. Xie, and R. Girshick, “Momentum contrast for
unsupervised visual representation learning,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp.
9729–9738.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
I. Misra and L. v. d. Maaten, “Self-supervised learning of pretext-invariant
representations,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition</em>, 2020, pp. 6707–6717.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
K. Sohn, “Improved deep metric learning with multi-class n-pair loss
objective,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>,
vol. 29, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Z. Wu, Y. Xiong, S. X. Yu, and D. Lin, “Unsupervised feature learning via
non-parametric instance discrimination,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE
conference on computer vision and pattern recognition</em>, 2018, pp. 3733–3742.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. v. d. Oord, Y. Li, and O. Vinyals, “Representation learning with
contrastive predictive coding,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1807.03748</em>,
2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
S. Kornblith, M. Norouzi, H. Lee, and G. Hinton, “Similarity of neural network
representations revisited,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine
Learning</em>.   PMLR, 2019, pp. 3519–3529.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M. Yurochkin, M. Agarwal, S. Ghosh, K. Greenewald, N. Hoang, and Y. Khazaeni,
“Bayesian nonparametric federated learning of neural networks,” in
<em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2019, pp. 7252–7261.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
H. Wang, M. Yurochkin, Y. Sun, D. Papailiopoulos, and Y. Khazaeni, “Federated
learning with matched averaging,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.06440</em>,
2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
T.-M. H. Hsu, H. Qi, and M. Brown, “Measuring the effects of non-identical
data distribution for federated visual classification,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1909.06335</em>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
J. Wang, Q. Liu, H. Liang, G. Joshi, and H. V. Poor, “Tackling the objective
inconsistency problem in heterogeneous federated optimization,”
<em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, vol. 33, pp.
7611–7623, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
X. Ma, J. Zhang, S. Guo, and W. Xu, “Layer-wised model aggregation for
personalized federated learning,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition</em>, 2022, pp.
10 092–10 101.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
C. T Dinh, N. Tran, and J. Nguyen, “Personalized federated learning with
moreau envelopes,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
vol. 33, pp. 21 394–21 405, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
A. Fallah, A. Mokhtari, and A. Ozdaglar, “Personalized federated learning: A
meta-learning approach,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.07948</em>, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Y. Jiang, J. Konečnỳ, K. Rush, and S. Kannan, “Improving federated
learning personalization via model agnostic meta learning,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:1909.12488</em>, 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
M. Zhang, K. Sapra, S. Fidler, S. Yeung, and J. M. Alvarez, “Personalized
federated learning with first order model optimization,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2012.08565</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
F. Sattler, K.-R. Müller, and W. Samek, “Clustered federated learning:
Model-agnostic distributed multitask optimization under privacy
constraints,” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning
systems</em>, vol. 32, no. 8, pp. 3710–3722, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
M. Duan, D. Liu, X. Ji, R. Liu, L. Liang, X. Chen, and Y. Tan, “Fedgroup:
Efficient federated learning via decomposed similarity-based clustering,” in
<em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">2021 IEEE Intl Conf on Parallel &amp; Distributed Processing with
Applications, Big Data &amp; Cloud Computing, Sustainable Computing &amp;
Communications, Social Computing &amp; Networking
(ISPA/BDCloud/SocialCom/SustainCom)</em>.   IEEE, 2021, pp. 228–237.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
M. Xie, G. Long, T. Shen, T. Zhou, X. Wang, J. Jiang, and C. Zhang,
“Multi-center federated learning,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2005.01026</em>,
2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
F. Sattler, K.-R. Müller, T. Wiegand, and W. Samek, “On the byzantine
robustness of clustered federated learning,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">ICASSP 2020-2020 IEEE
International Conference on Acoustics, Speech and Signal Processing
(ICASSP)</em>.   IEEE, 2020, pp. 8861–8865.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Hong, D. Yin, and K. Ramchandran, “Robust federated learning in a
heterogeneous environment,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.06629</em>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Chung, D. Yin, and K. Ramchandran, “An efficient framework for
clustered federated learning,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, vol. 33, pp. 19 586–19 597, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, and A. T. Suresh, “Three approaches for
personalization with applications to federated learning,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. L. Tun, M. N. Nguyen, C. M. Thwal, J. Choi, and C. S. Hong, “Contrastive
encoder pre-training based clustered federated learning for heterogeneous
data,” <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Available at SSRN: https://ssrn.com/abstract=4148978</em>, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
A. Kaku, S. Upadhya, and N. Razavian, “Intermediate layers matter in momentum
contrastive self supervised learning,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>, vol. 34, pp. 24 063–24 074, 2021.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
H. Xiao, K. Rasul, and R. Vollgraf. (2017) Fashion-mnist: a novel image dataset
for benchmarking machine learning algorithms.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Y. Netzer, T. Wang, A. Coates, A. Bissacco, B. Wu, and A. Y. Ng, “Reading
digits in natural images with unsupervised feature learning,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">NIPS
Workshop on Deep Learning and Unsupervised Feature Learning 2011</em>, 2011.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
A. Krizhevsky, G. Hinton <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Learning multiple layers of features
from tiny images,” <em id="bib.bib37.2.2" class="ltx_emph ltx_font_italic">Technical report, University of Toronto, 2009</em>,
2009. [Online]. Available:
<a target="_blank" href="https://www.cs.toronto.edu/~kriz/learning-features-2009-TR.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.cs.toronto.edu/~kriz/learning-features-2009-TR.pdf</a>

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision
and pattern recognition</em>, 2016, pp. 770–778.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Y. Idelbayev, “Proper ResNet implementation for CIFAR10/CIFAR100 in
PyTorch,” <a target="_blank" href="https://github.com/akamaster/pytorch_resnet_cifar10" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/akamaster/pytorch_resnet_cifar10</a>,
accessed: 2022-10-01.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen,
Z. Lin, N. Gimelshein, L. Antiga <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Pytorch: An imperative
style, high-performance deep learning library,” <em id="bib.bib40.2.2" class="ltx_emph ltx_font_italic">Advances in neural
information processing systems</em>, vol. 32, 2019.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
T. S. Ferguson, “A bayesian analysis of some nonparametric problems,”
<em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">The annals of statistics</em>, pp. 209–230, 1973.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2210.15826" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2210.15827" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2210.15827">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2210.15827" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2210.15828" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 01:53:23 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
