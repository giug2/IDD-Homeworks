<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention</title>
<!--Generated on Fri Oct 11 07:15:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Vision Transformer, Self-Attention Mechanism, Image Recognition" lang="en" name="keywords"/>
<base href="/html/2410.08582v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S1" title="In DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S2" title="In DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S2.SS1" title="In 2 Related Work ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Vision Transformers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S2.SS2" title="In 2 Related Work ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Attention mechanisms</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3" title="In DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Our Approach: DeBiFormer</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.SS1" title="In 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.SS2" title="In 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Deformable bi-level routing attention (DBRA)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.SS3" title="In 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Model architectures</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4" title="In DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS1" title="In 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Image classification on ImageNet-1K</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS2" title="In 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Semantic segmentation on ADE20K</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS3" title="In 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Object detection and instance segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS4" title="In 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Ablation study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S5" title="In DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Grad-CAM Visualization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S6" title="In DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7" title="In DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Supplementary Material</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS1" title="In 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Offset groups</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS2" title="In 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Deformable relative position bias</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS3" title="In 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3 </span>Computational complexity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS4" title="In 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4 </span>Token to Attend</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS5" title="In 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.5 </span>More visualization results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS5.SSS1" title="In 7.5 More visualization results ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.5.1 </span>Effective Receptive Field Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS5.SSS2" title="In 7.5 More visualization results ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.5.2 </span>Grad-CAM Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS6" title="In 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.6 </span>Detailed Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS6.SSS1" title="In 7.6 Detailed Experimental Settings ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.6.1 </span>Image classification on ImageNet-1K</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS6.SSS2" title="In 7.6 Detailed Experimental Settings ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.6.2 </span>Object Detection and Instance Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS6.SSS3" title="In 7.6 Detailed Experimental Settings ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.6.3 </span>Semantic Segmentation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.SS7" title="In 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.7 </span>Limitation and Future Work</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Chubu University, Kasugai, Japan 
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id1.1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>maclong01@gmail.com</span></span></span>
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id1.2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{zhang1121, shi, hirakawa}@mprg.cs.chubu.ac.jp</span></span></span>
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id1.3"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{takayoshi, matsui, fujiyoshi}@isc.chubu.ac.jp</span></span></span></span></span></span>
<h1 class="ltx_title ltx_title_document">DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
NguyenHuu BaoLong
</span><span class="ltx_author_notes">Equal contribution.11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chenyu Zhang<sup class="ltx_sup" id="id1.1.id1">0</sup>
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuzhi Shi
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tsubasa Hirakawa
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Takayoshi Yamashita
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tohgoroh Matsui
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hironobu Fujiyoshi
</span><span class="ltx_author_notes">11</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Vision Transformers with various attention modules have demonstrated superior performance on vision tasks. While using sparsity-adaptive attention, such as in DAT, has yielded strong results in image classification, the key-value pairs selected by deformable points lack semantic relevance when fine-tuning for semantic segmentation tasks. The query-aware sparsity attention in BiFormer seeks to focus each query on top-k routed regions. However, during attention calculation, the selected key-value pairs are influenced by too many irrelevant queries, reducing attention on the more important ones.
To address these issues, we propose the Deformable Bi-level Routing Attention (DBRA) module, which optimizes the selection of key-value pairs using agent queries and enhances the interpretability of queries in attention maps. Based on this, we introduce the Deformable Bi-level Routing Attention Transformer (DeBiFormer), a novel general-purpose vision transformer built with the DBRA module. DeBiFormer has been validated on various computer vision tasks, including image classification, object detection, and semantic segmentation, providing strong evidence of its effectiveness.Code is available at <a class="ltx_ref ltx_href" href="https://github.com/maclong01/DeBiFormer" title="">https://github.com/maclong01/DeBiFormer</a></p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Vision Transformer,Self-Attention Mechanism,Image Recognition
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The Vision Transformer has recently demonstrated significant promise in the realm of computer vision <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib44" title="">44</a>]</cite>. It can capture long-range dependency in data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib41" title="">41</a>]</cite>, and is almost leading to a convolution-free model more flexible for fitting tons of data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib44" title="">44</a>]</cite>. In addition, it enjoys high parallelism, which benefits training and inference for large models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib41" title="">41</a>]</cite>.
The computer vision community has observed a surge in the adoption and development of Vision Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib44" title="">44</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="516" id="S1.F1.1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Vanilla attention and its sparse variants are illustrated in the diagram: (a) vanilla attention functions globally, leading to increased computational complexity and substantial memory footprint. (b)-(c) Multiple strategies strive to reduce complexity by incorporating sparse attention with various handcrafted patterns, such as local window <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib50" title="">50</a>]</cite> and dilated window <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib24" title="">24</a>]</cite>. (d) Deformable attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite> facilitates image-adaptive sparsity by deforming the regular grid. (e) Bi-level routing attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite> begins by searching for top-k (k = 3 in this case) relevant regions and subsequently attends to the union of these regions. (f) In our approach, we realize bi-level routing attention, where the initial step involves searching for top-k (k = 1 in this case) relevant regions. Subsequently, attention is directed to the union of these regions by deforming regular grid attendance via top-k relevant regions.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To improve attention, numerous pieces of research have used thoughtfully crafted, efficient attention patterns in which each query selectively focused by a smaller portion of key-value pairs. As shown in Figure<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">1</span></a>, among the various representation approaches, some include local windows <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib50" title="">50</a>]</cite> and dilated windows <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib24" title="">24</a>]</cite>. In addition, some research has taken a different path through sparsity adaptation to data in their methodology, as demonstrated in the works of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>. However, despite the varying strategies for merging or selecting key and value tokens. These tokens are not semantic for queries. With this approach, when applied to other downstream tasks for pretrained ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib41" title="">41</a>]</cite> and DETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib1" title="">1</a>]</cite>. Queries do not originate from semantic-region key-value pairs. Consequently, compelling all queries to focus on insufficient sets of tokens may not yield the most optimal results. Recently, with the dynamic query-aware sparsity attention mechanism, queries are focused by the most dynamic semantically key-value pairs, which is referred to as bi-level routing attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>.
However, in this approach, queries are handled by semantic key-value pairs instead of originating from detailed regions, which may not yield the most optimal results in all cases. In addition, when calculating the attention, these keys and values selected for all queries are influenced by too many less relevant queries, resulting in a decrease of attention for important queries, which has a significant impact when performing segmentations.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib25" title="">25</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To make the attention for queries more efficient, we propose the Deformable Bi-level Routing Attention (DBRA), an attention-in-attention architecture for visual recognition. During the process in DBRA, the first problem is how to locate deformable points. We use the observation in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite> that attention has an offset network that takes as input query features and generates corresponding offsets for all reference points. Thus, candidate deformable points are shifted towards important regions with high flexibility and efficiency to capture more informative features.
The second problem is how to aggregate information from semantically relevant key-value pairs, and then broadcast the information back to queries.
Therefore, we propose an attention-in-attention architecture that shifted toward deformable points as shown above acts as the agent for the queries.
As the key-value pairs are selected for deformable points, we use the observation in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite> to select a small portion of the most semantically relevant key-value pairs that a region only needs by focusing on the top-k routed regions.
Then, with the semantically relevant key-value pairs selected, we first apply a token-to-token attention with deformable points queries.
And then, we apply a second token-to-token attention to broadcast the information back to queries, in which deformable points as key-value pairs are designed to represent the most important points in a portion of semantic regions.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To summarize, our contributions are as follows:</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">1. We propose Deformable Bi-level Routing Attention (DBRA), an attention-in-attention architecture for visual recognition, where data-dependent attention patterns are obtained flexibly and semantically.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">2. By utilizing the DBRA module, we propose a novel backbone, called DeBiFormer, which has a stronger recognition ability based on the visualization results of the attention heat map.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">3. Extensive experiments on ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib35" title="">35</a>]</cite>, ADE20K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib55" title="">55</a>]</cite>, and COCO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib17" title="">17</a>]</cite> demonstrate that our model consistently outperforms other competitive baselines.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Vision Transformers</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The Transformer-based backbone incorporates channel-wise MLP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib38" title="">38</a>]</cite> blocks to embed per-location features through channel mixing. Additionally, attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib41" title="">41</a>]</cite> blocks are used for cross-location relation modeling and facilitating spatial mixing. Initially devised for natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib11" title="">11</a>]</cite>, Transformers were subsequently introduced to the domain of computer vision through works like DETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib1" title="">1</a>]</cite> and ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib41" title="">41</a>]</cite>. Compared with CNNs, the primary distinction lies in the fact that transformers use attention as a substitute for convolution, thereby facilitating global context modeling. Nevertheless, vanilla attention, which calculates pairwise feature affinity across all spatial locations, imposes a significant computational burden and leads to substantial memory footprints, particularly when dealing with high-resolution inputs. Thus, a key research focus is to devise more efficient attention mechanisms, crucial for mitigating computational demands, especially with high-resolution inputs.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Attention mechanisms</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Numerous studies have aimed to alleviate the computational and memory complexities associated with vanilla attention. Approaches include sparse connection patterns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib6" title="">6</a>]</cite>, low-rank approximations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib42" title="">42</a>]</cite>, and recurrent operations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib10" title="">10</a>]</cite>. In the context of Vision Transformers, sparse attention has gained popularity, particularly following the remarkable success of the Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>. Within the Swin Transformer framework, attention is constrained to non-overlapping local windows, and an innovative shift window operation is introduced. This operation facilitates communication between adjacent windows, contributing to its unique approach to handling attention mechanisms. To attain larger or approximate global receptive fields without exceeding computational constraints, recent studies have incorporated diverse manually designed sparse patterns. These include the integration of dilated windows <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib24" title="">24</a>]</cite> and cross-shaped windows <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>. Moreover, certain studies endeavor to make sparse patterns adaptable to data, as demonstrated by works like DAT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>, TCFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib53" title="">53</a>]</cite>, and DPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib5" title="">5</a>]</cite>. Despite their efforts to decrease the number of key-value tokens using diverse merging or selection strategies, it is crucial to recognize that these tokens lack semantic specificity. Instead, we reinforce query-aware key-value token selection.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Our work is motivated by an observation: semantically attentive regions for important queries can exhibit significant differences, as illustrated by visualizations from pre-trained models like ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib41" title="">41</a>]</cite> and DETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib1" title="">1</a>]</cite>. In achieving query-adaptive sparsity through a coarse-to-fine approach, we propose an attention-in-attention architecture which utilizes the deformable attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite> with bi-level routing attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>. Diverging from deformable attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite> and bi-level routing attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>, our deformable bi-level routing attention aims to reinforce the most semantic and flexible key-value pairs. In contrast, bi-level routing attention only focuses on locating a few highly relevant key-value pairs, while deformable attention prioritizes identifying a few of the most flexible key-value pairs.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Our Approach: DeBiFormer</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="444" id="S3.F2.1.g1" src="x2.png" width="747"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Detailed architecture of Deformable Bi-level Routing Attention. In the top-left part, the set of reference points is uniformly distributed across the feature map. Offsets for these points are learned from queries through the offset network. Then, in the top-middle part, deformed features are projected from sampled features based on the locations of deformed points. In the bottom-left-middle part, we attend to projected deformed features by utilizing gathered key-value pairs in top-k-related windows.
</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminaries</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">Initially, we revisit the attention mechanism used in recent Vision Transformers. Taking a flattened feature map <math alttext="x\in\mathrm{R}^{N\times C}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">R</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑥</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">R</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">x\in\mathrm{R}^{N\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_x ∈ roman_R start_POSTSUPERSCRIPT italic_N × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> as the input, a multi-head self-attention (MHSA) block with <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_M</annotation></semantics></math> heads is formulated as</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S7.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle q=xW_{q},k=xW_{k},v=xW_{v}," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1"><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">q</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.cmml">q</mi></msub></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.2.cmml">k</mi><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.1.1.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.cmml">x</mi><mo id="S3.E1.m1.1.1.1.1.2.2.1.1.3.1" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.2.cmml">x</mi><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.3.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">v</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3a.cmml" xref="S3.E1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝑞</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3">𝑞</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1"><eq id="S3.E1.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.2">𝑘</ci><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3"><times id="S3.E1.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.2">𝑥</ci><apply id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1.1.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2"><eq id="S3.E1.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2">𝑣</ci><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3"><times id="S3.E1.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.2">𝑥</ci><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle q=xW_{q},k=xW_{k},v=xW_{v},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_q = italic_x italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_k = italic_x italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_v = italic_x italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle z^{(m)}=\sigma(q^{(m)k^{(m)\top}/\sqrt{d}})v^{(m)},m=1,...,M," class="ltx_Math" display="block" id="S3.E2.m1.8"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8.1"><mrow id="S3.E2.m1.8.8.1.1.2" xref="S3.E2.m1.8.8.1.1.3.cmml"><mrow id="S3.E2.m1.8.8.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.cmml"><msup id="S3.E2.m1.8.8.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.3.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.3.2" xref="S3.E2.m1.8.8.1.1.1.1.3.2.cmml">z</mi><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.3.cmml"><mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.3.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">m</mi><mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.3.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.8.8.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E2.m1.8.8.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">q</mi><mrow id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml"><mrow id="S3.E2.m1.3.3.2.4" xref="S3.E2.m1.3.3.2.4.cmml"><mrow id="S3.E2.m1.3.3.2.4.2.2" xref="S3.E2.m1.3.3.2.4.cmml"><mo id="S3.E2.m1.3.3.2.4.2.2.1" stretchy="false" xref="S3.E2.m1.3.3.2.4.cmml">(</mo><mi id="S3.E2.m1.3.3.2.2" xref="S3.E2.m1.3.3.2.2.cmml">m</mi><mo id="S3.E2.m1.3.3.2.4.2.2.2" stretchy="false" xref="S3.E2.m1.3.3.2.4.cmml">)</mo></mrow><mo id="S3.E2.m1.3.3.2.4.1" xref="S3.E2.m1.3.3.2.4.1.cmml">⁢</mo><msup id="S3.E2.m1.3.3.2.4.3" xref="S3.E2.m1.3.3.2.4.3.cmml"><mi id="S3.E2.m1.3.3.2.4.3.2" xref="S3.E2.m1.3.3.2.4.3.2.cmml">k</mi><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml">m</mi><mo id="S3.E2.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.1.1.1.4" lspace="0.222em" xref="S3.E2.m1.2.2.1.1.1.4.cmml">⊤</mo></mrow></msup></mrow><mo id="S3.E2.m1.3.3.2.3" xref="S3.E2.m1.3.3.2.3.cmml">/</mo><msqrt id="S3.E2.m1.3.3.2.5" xref="S3.E2.m1.3.3.2.5.cmml"><mi id="S3.E2.m1.3.3.2.5.2" xref="S3.E2.m1.3.3.2.5.2.cmml">d</mi></msqrt></mrow></msup><mo id="S3.E2.m1.8.8.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.8.8.1.1.1.1.1.2a" xref="S3.E2.m1.8.8.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E2.m1.8.8.1.1.1.1.1.4" xref="S3.E2.m1.8.8.1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.4.2" xref="S3.E2.m1.8.8.1.1.1.1.1.4.2.cmml">v</mi><mrow id="S3.E2.m1.4.4.1.3" xref="S3.E2.m1.8.8.1.1.1.1.1.4.cmml"><mo id="S3.E2.m1.4.4.1.3.1" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.4.cmml">(</mo><mi id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml">m</mi><mo id="S3.E2.m1.4.4.1.3.2" stretchy="false" xref="S3.E2.m1.8.8.1.1.1.1.1.4.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.2.3" xref="S3.E2.m1.8.8.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.8.8.1.1.2.2" xref="S3.E2.m1.8.8.1.1.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.2.2.2" xref="S3.E2.m1.8.8.1.1.2.2.2.cmml">m</mi><mo id="S3.E2.m1.8.8.1.1.2.2.1" xref="S3.E2.m1.8.8.1.1.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.8.8.1.1.2.2.3.2" xref="S3.E2.m1.8.8.1.1.2.2.3.1.cmml"><mn id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">1</mn><mo id="S3.E2.m1.8.8.1.1.2.2.3.2.1" xref="S3.E2.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E2.m1.6.6" mathvariant="normal" xref="S3.E2.m1.6.6.cmml">…</mi><mo id="S3.E2.m1.8.8.1.1.2.2.3.2.2" xref="S3.E2.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">M</mi></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3a.cmml" xref="S3.E2.m1.8.8.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1"><eq id="S3.E2.m1.8.8.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2"></eq><apply id="S3.E2.m1.8.8.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.2">𝑧</ci><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑚</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1"><times id="S3.E2.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.2"></times><ci id="S3.E2.m1.8.8.1.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.3">𝜎</ci><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.2">𝑞</ci><apply id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2"><divide id="S3.E2.m1.3.3.2.3.cmml" xref="S3.E2.m1.3.3.2.3"></divide><apply id="S3.E2.m1.3.3.2.4.cmml" xref="S3.E2.m1.3.3.2.4"><times id="S3.E2.m1.3.3.2.4.1.cmml" xref="S3.E2.m1.3.3.2.4.1"></times><ci id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.2">𝑚</ci><apply id="S3.E2.m1.3.3.2.4.3.cmml" xref="S3.E2.m1.3.3.2.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.4.3.1.cmml" xref="S3.E2.m1.3.3.2.4.3">superscript</csymbol><ci id="S3.E2.m1.3.3.2.4.3.2.cmml" xref="S3.E2.m1.3.3.2.4.3.2">𝑘</ci><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1">limit-from</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1">𝑚</ci><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.4">top</csymbol></apply></apply></apply><apply id="S3.E2.m1.3.3.2.5.cmml" xref="S3.E2.m1.3.3.2.5"><root id="S3.E2.m1.3.3.2.5a.cmml" xref="S3.E2.m1.3.3.2.5"></root><ci id="S3.E2.m1.3.3.2.5.2.cmml" xref="S3.E2.m1.3.3.2.5.2">𝑑</ci></apply></apply></apply><apply id="S3.E2.m1.8.8.1.1.1.1.1.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.4.2">𝑣</ci><ci id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1">𝑚</ci></apply></apply></apply><apply id="S3.E2.m1.8.8.1.1.2.2.cmml" xref="S3.E2.m1.8.8.1.1.2.2"><eq id="S3.E2.m1.8.8.1.1.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.2.2.1"></eq><ci id="S3.E2.m1.8.8.1.1.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.2.2.2">𝑚</ci><list id="S3.E2.m1.8.8.1.1.2.2.3.1.cmml" xref="S3.E2.m1.8.8.1.1.2.2.3.2"><cn id="S3.E2.m1.5.5.cmml" type="integer" xref="S3.E2.m1.5.5">1</cn><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">…</ci><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝑀</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\displaystyle z^{(m)}=\sigma(q^{(m)k^{(m)\top}/\sqrt{d}})v^{(m)},m=1,...,M,</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.8d">italic_z start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT = italic_σ ( italic_q start_POSTSUPERSCRIPT ( italic_m ) italic_k start_POSTSUPERSCRIPT ( italic_m ) ⊤ end_POSTSUPERSCRIPT / square-root start_ARG italic_d end_ARG end_POSTSUPERSCRIPT ) italic_v start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT , italic_m = 1 , … , italic_M ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle z=Concat(z^{(1)},...,z^{(M)})W_{o}" class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><mi id="S3.E3.m1.5.5.4" xref="S3.E3.m1.5.5.4.cmml">z</mi><mo id="S3.E3.m1.5.5.3" xref="S3.E3.m1.5.5.3.cmml">=</mo><mrow id="S3.E3.m1.5.5.2" xref="S3.E3.m1.5.5.2.cmml"><mi id="S3.E3.m1.5.5.2.4" xref="S3.E3.m1.5.5.2.4.cmml">C</mi><mo id="S3.E3.m1.5.5.2.3" xref="S3.E3.m1.5.5.2.3.cmml">⁢</mo><mi id="S3.E3.m1.5.5.2.5" xref="S3.E3.m1.5.5.2.5.cmml">o</mi><mo id="S3.E3.m1.5.5.2.3a" xref="S3.E3.m1.5.5.2.3.cmml">⁢</mo><mi id="S3.E3.m1.5.5.2.6" xref="S3.E3.m1.5.5.2.6.cmml">n</mi><mo id="S3.E3.m1.5.5.2.3b" xref="S3.E3.m1.5.5.2.3.cmml">⁢</mo><mi id="S3.E3.m1.5.5.2.7" xref="S3.E3.m1.5.5.2.7.cmml">c</mi><mo id="S3.E3.m1.5.5.2.3c" xref="S3.E3.m1.5.5.2.3.cmml">⁢</mo><mi id="S3.E3.m1.5.5.2.8" xref="S3.E3.m1.5.5.2.8.cmml">a</mi><mo id="S3.E3.m1.5.5.2.3d" xref="S3.E3.m1.5.5.2.3.cmml">⁢</mo><mi id="S3.E3.m1.5.5.2.9" xref="S3.E3.m1.5.5.2.9.cmml">t</mi><mo id="S3.E3.m1.5.5.2.3e" xref="S3.E3.m1.5.5.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.2.2.2" xref="S3.E3.m1.5.5.2.2.3.cmml"><mo id="S3.E3.m1.5.5.2.2.2.3" stretchy="false" xref="S3.E3.m1.5.5.2.2.3.cmml">(</mo><msup id="S3.E3.m1.4.4.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml">z</mi><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.cmml">(</mo><mn id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">1</mn><mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E3.m1.5.5.2.2.2.4" xref="S3.E3.m1.5.5.2.2.3.cmml">,</mo><mi id="S3.E3.m1.3.3" mathvariant="normal" xref="S3.E3.m1.3.3.cmml">…</mi><mo id="S3.E3.m1.5.5.2.2.2.5" xref="S3.E3.m1.5.5.2.2.3.cmml">,</mo><msup id="S3.E3.m1.5.5.2.2.2.2" xref="S3.E3.m1.5.5.2.2.2.2.cmml"><mi id="S3.E3.m1.5.5.2.2.2.2.2" xref="S3.E3.m1.5.5.2.2.2.2.2.cmml">z</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.5.5.2.2.2.2.cmml"><mo id="S3.E3.m1.2.2.1.3.1" stretchy="false" xref="S3.E3.m1.5.5.2.2.2.2.cmml">(</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">M</mi><mo id="S3.E3.m1.2.2.1.3.2" stretchy="false" xref="S3.E3.m1.5.5.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.E3.m1.5.5.2.2.2.6" stretchy="false" xref="S3.E3.m1.5.5.2.2.3.cmml">)</mo></mrow><mo id="S3.E3.m1.5.5.2.3f" xref="S3.E3.m1.5.5.2.3.cmml">⁢</mo><msub id="S3.E3.m1.5.5.2.10" xref="S3.E3.m1.5.5.2.10.cmml"><mi id="S3.E3.m1.5.5.2.10.2" xref="S3.E3.m1.5.5.2.10.2.cmml">W</mi><mi id="S3.E3.m1.5.5.2.10.3" xref="S3.E3.m1.5.5.2.10.3.cmml">o</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.3"></eq><ci id="S3.E3.m1.5.5.4.cmml" xref="S3.E3.m1.5.5.4">𝑧</ci><apply id="S3.E3.m1.5.5.2.cmml" xref="S3.E3.m1.5.5.2"><times id="S3.E3.m1.5.5.2.3.cmml" xref="S3.E3.m1.5.5.2.3"></times><ci id="S3.E3.m1.5.5.2.4.cmml" xref="S3.E3.m1.5.5.2.4">𝐶</ci><ci id="S3.E3.m1.5.5.2.5.cmml" xref="S3.E3.m1.5.5.2.5">𝑜</ci><ci id="S3.E3.m1.5.5.2.6.cmml" xref="S3.E3.m1.5.5.2.6">𝑛</ci><ci id="S3.E3.m1.5.5.2.7.cmml" xref="S3.E3.m1.5.5.2.7">𝑐</ci><ci id="S3.E3.m1.5.5.2.8.cmml" xref="S3.E3.m1.5.5.2.8">𝑎</ci><ci id="S3.E3.m1.5.5.2.9.cmml" xref="S3.E3.m1.5.5.2.9">𝑡</ci><vector id="S3.E3.m1.5.5.2.2.3.cmml" xref="S3.E3.m1.5.5.2.2.2"><apply id="S3.E3.m1.4.4.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2">𝑧</ci><cn id="S3.E3.m1.1.1.1.1.cmml" type="integer" xref="S3.E3.m1.1.1.1.1">1</cn></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">…</ci><apply id="S3.E3.m1.5.5.2.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.2.2.2.1.cmml" xref="S3.E3.m1.5.5.2.2.2.2">superscript</csymbol><ci id="S3.E3.m1.5.5.2.2.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2.2.2">𝑧</ci><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝑀</ci></apply></vector><apply id="S3.E3.m1.5.5.2.10.cmml" xref="S3.E3.m1.5.5.2.10"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.10.1.cmml" xref="S3.E3.m1.5.5.2.10">subscript</csymbol><ci id="S3.E3.m1.5.5.2.10.2.cmml" xref="S3.E3.m1.5.5.2.10.2">𝑊</ci><ci id="S3.E3.m1.5.5.2.10.3.cmml" xref="S3.E3.m1.5.5.2.10.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\displaystyle z=Concat(z^{(1)},...,z^{(M)})W_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">italic_z = italic_C italic_o italic_n italic_c italic_a italic_t ( italic_z start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , … , italic_z start_POSTSUPERSCRIPT ( italic_M ) end_POSTSUPERSCRIPT ) italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.9">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m1.1"><semantics id="S3.SS1.p1.3.m1.1a"><mrow id="S3.SS1.p1.3.m1.1.2" xref="S3.SS1.p1.3.m1.1.2.cmml"><mi id="S3.SS1.p1.3.m1.1.2.2" xref="S3.SS1.p1.3.m1.1.2.2.cmml">σ</mi><mo id="S3.SS1.p1.3.m1.1.2.1" xref="S3.SS1.p1.3.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m1.1.2.3.2" xref="S3.SS1.p1.3.m1.1.2.cmml"><mo id="S3.SS1.p1.3.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.3.m1.1.2.cmml">(</mo><mo id="S3.SS1.p1.3.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.3.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.3.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m1.1b"><apply id="S3.SS1.p1.3.m1.1.2.cmml" xref="S3.SS1.p1.3.m1.1.2"><times id="S3.SS1.p1.3.m1.1.2.1.cmml" xref="S3.SS1.p1.3.m1.1.2.1"></times><ci id="S3.SS1.p1.3.m1.1.2.2.cmml" xref="S3.SS1.p1.3.m1.1.2.2">𝜎</ci><ci id="S3.SS1.p1.3.m1.1.1.cmml" xref="S3.SS1.p1.3.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> denotes the softmax function, and <math alttext="d=C/M" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m2.1"><semantics id="S3.SS1.p1.4.m2.1a"><mrow id="S3.SS1.p1.4.m2.1.1" xref="S3.SS1.p1.4.m2.1.1.cmml"><mi id="S3.SS1.p1.4.m2.1.1.2" xref="S3.SS1.p1.4.m2.1.1.2.cmml">d</mi><mo id="S3.SS1.p1.4.m2.1.1.1" xref="S3.SS1.p1.4.m2.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.4.m2.1.1.3" xref="S3.SS1.p1.4.m2.1.1.3.cmml"><mi id="S3.SS1.p1.4.m2.1.1.3.2" xref="S3.SS1.p1.4.m2.1.1.3.2.cmml">C</mi><mo id="S3.SS1.p1.4.m2.1.1.3.1" xref="S3.SS1.p1.4.m2.1.1.3.1.cmml">/</mo><mi id="S3.SS1.p1.4.m2.1.1.3.3" xref="S3.SS1.p1.4.m2.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m2.1b"><apply id="S3.SS1.p1.4.m2.1.1.cmml" xref="S3.SS1.p1.4.m2.1.1"><eq id="S3.SS1.p1.4.m2.1.1.1.cmml" xref="S3.SS1.p1.4.m2.1.1.1"></eq><ci id="S3.SS1.p1.4.m2.1.1.2.cmml" xref="S3.SS1.p1.4.m2.1.1.2">𝑑</ci><apply id="S3.SS1.p1.4.m2.1.1.3.cmml" xref="S3.SS1.p1.4.m2.1.1.3"><divide id="S3.SS1.p1.4.m2.1.1.3.1.cmml" xref="S3.SS1.p1.4.m2.1.1.3.1"></divide><ci id="S3.SS1.p1.4.m2.1.1.3.2.cmml" xref="S3.SS1.p1.4.m2.1.1.3.2">𝐶</ci><ci id="S3.SS1.p1.4.m2.1.1.3.3.cmml" xref="S3.SS1.p1.4.m2.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m2.1c">d=C/M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m2.1d">italic_d = italic_C / italic_M</annotation></semantics></math> is the dimension of each head. <math alttext="z(m)" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m3.1"><semantics id="S3.SS1.p1.5.m3.1a"><mrow id="S3.SS1.p1.5.m3.1.2" xref="S3.SS1.p1.5.m3.1.2.cmml"><mi id="S3.SS1.p1.5.m3.1.2.2" xref="S3.SS1.p1.5.m3.1.2.2.cmml">z</mi><mo id="S3.SS1.p1.5.m3.1.2.1" xref="S3.SS1.p1.5.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.5.m3.1.2.3.2" xref="S3.SS1.p1.5.m3.1.2.cmml"><mo id="S3.SS1.p1.5.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m3.1.2.cmml">(</mo><mi id="S3.SS1.p1.5.m3.1.1" xref="S3.SS1.p1.5.m3.1.1.cmml">m</mi><mo id="S3.SS1.p1.5.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m3.1b"><apply id="S3.SS1.p1.5.m3.1.2.cmml" xref="S3.SS1.p1.5.m3.1.2"><times id="S3.SS1.p1.5.m3.1.2.1.cmml" xref="S3.SS1.p1.5.m3.1.2.1"></times><ci id="S3.SS1.p1.5.m3.1.2.2.cmml" xref="S3.SS1.p1.5.m3.1.2.2">𝑧</ci><ci id="S3.SS1.p1.5.m3.1.1.cmml" xref="S3.SS1.p1.5.m3.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m3.1c">z(m)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m3.1d">italic_z ( italic_m )</annotation></semantics></math> denotes the embedding output from the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m4.1"><semantics id="S3.SS1.p1.6.m4.1a"><mi id="S3.SS1.p1.6.m4.1.1" xref="S3.SS1.p1.6.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m4.1b"><ci id="S3.SS1.p1.6.m4.1.1.cmml" xref="S3.SS1.p1.6.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m4.1d">italic_m</annotation></semantics></math>-th attention head, and <math alttext="q(m),k(m),v(m)\in\mathrm{R}^{N\times d}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m5.6"><semantics id="S3.SS1.p1.7.m5.6a"><mrow id="S3.SS1.p1.7.m5.6.6" xref="S3.SS1.p1.7.m5.6.6.cmml"><mrow id="S3.SS1.p1.7.m5.6.6.3.3" xref="S3.SS1.p1.7.m5.6.6.3.4.cmml"><mrow id="S3.SS1.p1.7.m5.4.4.1.1.1" xref="S3.SS1.p1.7.m5.4.4.1.1.1.cmml"><mi id="S3.SS1.p1.7.m5.4.4.1.1.1.2" xref="S3.SS1.p1.7.m5.4.4.1.1.1.2.cmml">q</mi><mo id="S3.SS1.p1.7.m5.4.4.1.1.1.1" xref="S3.SS1.p1.7.m5.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m5.4.4.1.1.1.3.2" xref="S3.SS1.p1.7.m5.4.4.1.1.1.cmml"><mo id="S3.SS1.p1.7.m5.4.4.1.1.1.3.2.1" stretchy="false" xref="S3.SS1.p1.7.m5.4.4.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.7.m5.1.1" xref="S3.SS1.p1.7.m5.1.1.cmml">m</mi><mo id="S3.SS1.p1.7.m5.4.4.1.1.1.3.2.2" stretchy="false" xref="S3.SS1.p1.7.m5.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.7.m5.6.6.3.3.4" xref="S3.SS1.p1.7.m5.6.6.3.4.cmml">,</mo><mrow id="S3.SS1.p1.7.m5.5.5.2.2.2" xref="S3.SS1.p1.7.m5.5.5.2.2.2.cmml"><mi id="S3.SS1.p1.7.m5.5.5.2.2.2.2" xref="S3.SS1.p1.7.m5.5.5.2.2.2.2.cmml">k</mi><mo id="S3.SS1.p1.7.m5.5.5.2.2.2.1" xref="S3.SS1.p1.7.m5.5.5.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m5.5.5.2.2.2.3.2" xref="S3.SS1.p1.7.m5.5.5.2.2.2.cmml"><mo id="S3.SS1.p1.7.m5.5.5.2.2.2.3.2.1" stretchy="false" xref="S3.SS1.p1.7.m5.5.5.2.2.2.cmml">(</mo><mi id="S3.SS1.p1.7.m5.2.2" xref="S3.SS1.p1.7.m5.2.2.cmml">m</mi><mo id="S3.SS1.p1.7.m5.5.5.2.2.2.3.2.2" stretchy="false" xref="S3.SS1.p1.7.m5.5.5.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.7.m5.6.6.3.3.5" xref="S3.SS1.p1.7.m5.6.6.3.4.cmml">,</mo><mrow id="S3.SS1.p1.7.m5.6.6.3.3.3" xref="S3.SS1.p1.7.m5.6.6.3.3.3.cmml"><mi id="S3.SS1.p1.7.m5.6.6.3.3.3.2" xref="S3.SS1.p1.7.m5.6.6.3.3.3.2.cmml">v</mi><mo id="S3.SS1.p1.7.m5.6.6.3.3.3.1" xref="S3.SS1.p1.7.m5.6.6.3.3.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m5.6.6.3.3.3.3.2" xref="S3.SS1.p1.7.m5.6.6.3.3.3.cmml"><mo id="S3.SS1.p1.7.m5.6.6.3.3.3.3.2.1" stretchy="false" xref="S3.SS1.p1.7.m5.6.6.3.3.3.cmml">(</mo><mi id="S3.SS1.p1.7.m5.3.3" xref="S3.SS1.p1.7.m5.3.3.cmml">m</mi><mo id="S3.SS1.p1.7.m5.6.6.3.3.3.3.2.2" stretchy="false" xref="S3.SS1.p1.7.m5.6.6.3.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.7.m5.6.6.4" xref="S3.SS1.p1.7.m5.6.6.4.cmml">∈</mo><msup id="S3.SS1.p1.7.m5.6.6.5" xref="S3.SS1.p1.7.m5.6.6.5.cmml"><mi id="S3.SS1.p1.7.m5.6.6.5.2" mathvariant="normal" xref="S3.SS1.p1.7.m5.6.6.5.2.cmml">R</mi><mrow id="S3.SS1.p1.7.m5.6.6.5.3" xref="S3.SS1.p1.7.m5.6.6.5.3.cmml"><mi id="S3.SS1.p1.7.m5.6.6.5.3.2" xref="S3.SS1.p1.7.m5.6.6.5.3.2.cmml">N</mi><mo id="S3.SS1.p1.7.m5.6.6.5.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.7.m5.6.6.5.3.1.cmml">×</mo><mi id="S3.SS1.p1.7.m5.6.6.5.3.3" xref="S3.SS1.p1.7.m5.6.6.5.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m5.6b"><apply id="S3.SS1.p1.7.m5.6.6.cmml" xref="S3.SS1.p1.7.m5.6.6"><in id="S3.SS1.p1.7.m5.6.6.4.cmml" xref="S3.SS1.p1.7.m5.6.6.4"></in><list id="S3.SS1.p1.7.m5.6.6.3.4.cmml" xref="S3.SS1.p1.7.m5.6.6.3.3"><apply id="S3.SS1.p1.7.m5.4.4.1.1.1.cmml" xref="S3.SS1.p1.7.m5.4.4.1.1.1"><times id="S3.SS1.p1.7.m5.4.4.1.1.1.1.cmml" xref="S3.SS1.p1.7.m5.4.4.1.1.1.1"></times><ci id="S3.SS1.p1.7.m5.4.4.1.1.1.2.cmml" xref="S3.SS1.p1.7.m5.4.4.1.1.1.2">𝑞</ci><ci id="S3.SS1.p1.7.m5.1.1.cmml" xref="S3.SS1.p1.7.m5.1.1">𝑚</ci></apply><apply id="S3.SS1.p1.7.m5.5.5.2.2.2.cmml" xref="S3.SS1.p1.7.m5.5.5.2.2.2"><times id="S3.SS1.p1.7.m5.5.5.2.2.2.1.cmml" xref="S3.SS1.p1.7.m5.5.5.2.2.2.1"></times><ci id="S3.SS1.p1.7.m5.5.5.2.2.2.2.cmml" xref="S3.SS1.p1.7.m5.5.5.2.2.2.2">𝑘</ci><ci id="S3.SS1.p1.7.m5.2.2.cmml" xref="S3.SS1.p1.7.m5.2.2">𝑚</ci></apply><apply id="S3.SS1.p1.7.m5.6.6.3.3.3.cmml" xref="S3.SS1.p1.7.m5.6.6.3.3.3"><times id="S3.SS1.p1.7.m5.6.6.3.3.3.1.cmml" xref="S3.SS1.p1.7.m5.6.6.3.3.3.1"></times><ci id="S3.SS1.p1.7.m5.6.6.3.3.3.2.cmml" xref="S3.SS1.p1.7.m5.6.6.3.3.3.2">𝑣</ci><ci id="S3.SS1.p1.7.m5.3.3.cmml" xref="S3.SS1.p1.7.m5.3.3">𝑚</ci></apply></list><apply id="S3.SS1.p1.7.m5.6.6.5.cmml" xref="S3.SS1.p1.7.m5.6.6.5"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m5.6.6.5.1.cmml" xref="S3.SS1.p1.7.m5.6.6.5">superscript</csymbol><ci id="S3.SS1.p1.7.m5.6.6.5.2.cmml" xref="S3.SS1.p1.7.m5.6.6.5.2">R</ci><apply id="S3.SS1.p1.7.m5.6.6.5.3.cmml" xref="S3.SS1.p1.7.m5.6.6.5.3"><times id="S3.SS1.p1.7.m5.6.6.5.3.1.cmml" xref="S3.SS1.p1.7.m5.6.6.5.3.1"></times><ci id="S3.SS1.p1.7.m5.6.6.5.3.2.cmml" xref="S3.SS1.p1.7.m5.6.6.5.3.2">𝑁</ci><ci id="S3.SS1.p1.7.m5.6.6.5.3.3.cmml" xref="S3.SS1.p1.7.m5.6.6.5.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m5.6c">q(m),k(m),v(m)\in\mathrm{R}^{N\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m5.6d">italic_q ( italic_m ) , italic_k ( italic_m ) , italic_v ( italic_m ) ∈ roman_R start_POSTSUPERSCRIPT italic_N × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denote the query, key, and value embeddings, respectively. <math alttext="W_{q},W_{k},W_{v},W_{o}\in\mathrm{R}^{C\times C}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m6.4"><semantics id="S3.SS1.p1.8.m6.4a"><mrow id="S3.SS1.p1.8.m6.4.4" xref="S3.SS1.p1.8.m6.4.4.cmml"><mrow id="S3.SS1.p1.8.m6.4.4.4.4" xref="S3.SS1.p1.8.m6.4.4.4.5.cmml"><msub id="S3.SS1.p1.8.m6.1.1.1.1.1" xref="S3.SS1.p1.8.m6.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m6.1.1.1.1.1.2" xref="S3.SS1.p1.8.m6.1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS1.p1.8.m6.1.1.1.1.1.3" xref="S3.SS1.p1.8.m6.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.SS1.p1.8.m6.4.4.4.4.5" xref="S3.SS1.p1.8.m6.4.4.4.5.cmml">,</mo><msub id="S3.SS1.p1.8.m6.2.2.2.2.2" xref="S3.SS1.p1.8.m6.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.8.m6.2.2.2.2.2.2" xref="S3.SS1.p1.8.m6.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS1.p1.8.m6.2.2.2.2.2.3" xref="S3.SS1.p1.8.m6.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS1.p1.8.m6.4.4.4.4.6" xref="S3.SS1.p1.8.m6.4.4.4.5.cmml">,</mo><msub id="S3.SS1.p1.8.m6.3.3.3.3.3" xref="S3.SS1.p1.8.m6.3.3.3.3.3.cmml"><mi id="S3.SS1.p1.8.m6.3.3.3.3.3.2" xref="S3.SS1.p1.8.m6.3.3.3.3.3.2.cmml">W</mi><mi id="S3.SS1.p1.8.m6.3.3.3.3.3.3" xref="S3.SS1.p1.8.m6.3.3.3.3.3.3.cmml">v</mi></msub><mo id="S3.SS1.p1.8.m6.4.4.4.4.7" xref="S3.SS1.p1.8.m6.4.4.4.5.cmml">,</mo><msub id="S3.SS1.p1.8.m6.4.4.4.4.4" xref="S3.SS1.p1.8.m6.4.4.4.4.4.cmml"><mi id="S3.SS1.p1.8.m6.4.4.4.4.4.2" xref="S3.SS1.p1.8.m6.4.4.4.4.4.2.cmml">W</mi><mi id="S3.SS1.p1.8.m6.4.4.4.4.4.3" xref="S3.SS1.p1.8.m6.4.4.4.4.4.3.cmml">o</mi></msub></mrow><mo id="S3.SS1.p1.8.m6.4.4.5" xref="S3.SS1.p1.8.m6.4.4.5.cmml">∈</mo><msup id="S3.SS1.p1.8.m6.4.4.6" xref="S3.SS1.p1.8.m6.4.4.6.cmml"><mi id="S3.SS1.p1.8.m6.4.4.6.2" mathvariant="normal" xref="S3.SS1.p1.8.m6.4.4.6.2.cmml">R</mi><mrow id="S3.SS1.p1.8.m6.4.4.6.3" xref="S3.SS1.p1.8.m6.4.4.6.3.cmml"><mi id="S3.SS1.p1.8.m6.4.4.6.3.2" xref="S3.SS1.p1.8.m6.4.4.6.3.2.cmml">C</mi><mo id="S3.SS1.p1.8.m6.4.4.6.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.8.m6.4.4.6.3.1.cmml">×</mo><mi id="S3.SS1.p1.8.m6.4.4.6.3.3" xref="S3.SS1.p1.8.m6.4.4.6.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m6.4b"><apply id="S3.SS1.p1.8.m6.4.4.cmml" xref="S3.SS1.p1.8.m6.4.4"><in id="S3.SS1.p1.8.m6.4.4.5.cmml" xref="S3.SS1.p1.8.m6.4.4.5"></in><list id="S3.SS1.p1.8.m6.4.4.4.5.cmml" xref="S3.SS1.p1.8.m6.4.4.4.4"><apply id="S3.SS1.p1.8.m6.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m6.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS1.p1.8.m6.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m6.1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.SS1.p1.8.m6.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m6.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.8.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.8.m6.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m6.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS1.p1.8.m6.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.8.m6.2.2.2.2.2.3">𝑘</ci></apply><apply id="S3.SS1.p1.8.m6.3.3.3.3.3.cmml" xref="S3.SS1.p1.8.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m6.3.3.3.3.3.1.cmml" xref="S3.SS1.p1.8.m6.3.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.8.m6.3.3.3.3.3.2.cmml" xref="S3.SS1.p1.8.m6.3.3.3.3.3.2">𝑊</ci><ci id="S3.SS1.p1.8.m6.3.3.3.3.3.3.cmml" xref="S3.SS1.p1.8.m6.3.3.3.3.3.3">𝑣</ci></apply><apply id="S3.SS1.p1.8.m6.4.4.4.4.4.cmml" xref="S3.SS1.p1.8.m6.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m6.4.4.4.4.4.1.cmml" xref="S3.SS1.p1.8.m6.4.4.4.4.4">subscript</csymbol><ci id="S3.SS1.p1.8.m6.4.4.4.4.4.2.cmml" xref="S3.SS1.p1.8.m6.4.4.4.4.4.2">𝑊</ci><ci id="S3.SS1.p1.8.m6.4.4.4.4.4.3.cmml" xref="S3.SS1.p1.8.m6.4.4.4.4.4.3">𝑜</ci></apply></list><apply id="S3.SS1.p1.8.m6.4.4.6.cmml" xref="S3.SS1.p1.8.m6.4.4.6"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m6.4.4.6.1.cmml" xref="S3.SS1.p1.8.m6.4.4.6">superscript</csymbol><ci id="S3.SS1.p1.8.m6.4.4.6.2.cmml" xref="S3.SS1.p1.8.m6.4.4.6.2">R</ci><apply id="S3.SS1.p1.8.m6.4.4.6.3.cmml" xref="S3.SS1.p1.8.m6.4.4.6.3"><times id="S3.SS1.p1.8.m6.4.4.6.3.1.cmml" xref="S3.SS1.p1.8.m6.4.4.6.3.1"></times><ci id="S3.SS1.p1.8.m6.4.4.6.3.2.cmml" xref="S3.SS1.p1.8.m6.4.4.6.3.2">𝐶</ci><ci id="S3.SS1.p1.8.m6.4.4.6.3.3.cmml" xref="S3.SS1.p1.8.m6.4.4.6.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m6.4c">W_{q},W_{k},W_{v},W_{o}\in\mathrm{R}^{C\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m6.4d">italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ roman_R start_POSTSUPERSCRIPT italic_C × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> are the projection matrices. With normalization layers and identity shortcuts, the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m7.1"><semantics id="S3.SS1.p1.9.m7.1a"><mi id="S3.SS1.p1.9.m7.1.1" xref="S3.SS1.p1.9.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m7.1b"><ci id="S3.SS1.p1.9.m7.1.1.cmml" xref="S3.SS1.p1.9.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m7.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m7.1d">italic_l</annotation></semantics></math>-th Transformer block, for which LN means layer normalization, is formulated as</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S7.EGx2">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle z^{\prime}_{l}=MHSA(LN(z_{l-1}))+z_{l-1}," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msubsup id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.3.2.2.cmml">z</mi><mi id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml">l</mi><mo id="S3.E4.m1.1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">M</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.1.1.4.cmml">H</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2a" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.1.1.5.cmml">S</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2b" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.6" xref="S3.E4.m1.1.1.1.1.1.1.6.cmml">A</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2c" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">L</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.4.cmml">N</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.3.2.cmml">z</mi><mrow id="S3.E4.m1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.1.3.3.2.cmml">l</mi><mo id="S3.E4.m1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></eq><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2">𝑧</ci><ci id="S3.E4.m1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><plus id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2"></plus><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">𝑀</ci><ci id="S3.E4.m1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4">𝐻</ci><ci id="S3.E4.m1.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.1.1.5">𝑆</ci><ci id="S3.E4.m1.1.1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.1.1.6">𝐴</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3">𝐿</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.4">𝑁</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.2">𝑧</ci><apply id="S3.E4.m1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3"><minus id="S3.E4.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E4.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3.2">𝑙</ci><cn id="S3.E4.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle z^{\prime}_{l}=MHSA(LN(z_{l-1}))+z_{l-1},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = italic_M italic_H italic_S italic_A ( italic_L italic_N ( italic_z start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT ) ) + italic_z start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle z_{l}=MLP(LN(z^{\prime}_{l}))+z^{\prime}_{l}" class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msub id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">z</mi><mi id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml">l</mi></msub><mo id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml">M</mi><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.4.cmml">L</mi><mo id="S3.E5.m1.1.1.1.1.2a" xref="S3.E5.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.5" xref="S3.E5.m1.1.1.1.1.5.cmml">P</mi><mo id="S3.E5.m1.1.1.1.1.2b" xref="S3.E5.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.cmml">L</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.1.1.4.cmml">N</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.2a" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">+</mo><msubsup id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.3.2.2.cmml">z</mi><mi id="S3.E5.m1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.3.3.cmml">l</mi><mo id="S3.E5.m1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"></eq><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝑧</ci><ci id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3">𝑙</ci></apply><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><plus id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></plus><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3">𝑀</ci><ci id="S3.E5.m1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.4">𝐿</ci><ci id="S3.E5.m1.1.1.1.1.5.cmml" xref="S3.E5.m1.1.1.1.1.5">𝑃</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3">𝐿</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.4">𝑁</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.3">subscript</csymbol><apply id="S3.E5.m1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.3.2.2">𝑧</ci><ci id="S3.E5.m1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E5.m1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle z_{l}=MLP(LN(z^{\prime}_{l}))+z^{\prime}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">italic_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = italic_M italic_L italic_P ( italic_L italic_N ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ) + italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Deformable bi-level routing attention (DBRA)</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The architecture of the proposed Deformable Bi-level Routing Attention (DBRA) is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.F2" title="Figure 2 ‣ 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">2</span></a>. We first employ a deformable attention module, which includes an offset network that generates offsets for reference points based on the query features, creating deformable points. However, these points tend to cluster in important regions, leading to an over-concentration in certain areas.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">To address this, we introduce deformable points-aware region partitioning, ensuring that each deformable point interacts with only a small subset of key-value pairs. Yet, solely relying on region partitioning can result in an imbalance between important and less important regions. To tackle this, the DBRA module is designed to distribute attention more effectively. In DBRA, each deformable point acts as an agent query, computing attention with semantic region key-value pairs. This approach ensures that only a few deformable points are assigned to each important region, allowing attention to be spread across all critical areas of the image rather than clustered in one spot.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.7">By employing the DBRA module, attention is reduced in less important regions and increased in more important ones, ensuring a balanced distribution of attention throughout the image.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.7.1">Deformable attention module and input projection.</span>
As illustrated in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.F2" title="Figure 2 ‣ 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">2</span></a>, given the input feature map <math alttext="x\in\mathrm{R}^{H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" mathvariant="normal" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">R</mi><mrow id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.3.2" xref="S3.SS2.p3.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS2.p3.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.1.m1.1.1.3.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS2.p3.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.1.m1.1.1.3.3.4" xref="S3.SS2.p3.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><in id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></in><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑥</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">R</ci><apply id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3"><times id="S3.SS2.p3.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p3.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.4.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">x\in\mathrm{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_x ∈ roman_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>, a uniform grid of points <math alttext="p\in\mathrm{R}^{H_{G}\times W_{G}\times 2}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">p</mi><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2" mathvariant="normal" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">R</mi><mrow id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml"><msub id="S3.SS2.p3.2.m2.1.1.3.3.2" xref="S3.SS2.p3.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.3.2.2" xref="S3.SS2.p3.2.m2.1.1.3.3.2.2.cmml">H</mi><mi id="S3.SS2.p3.2.m2.1.1.3.3.2.3" xref="S3.SS2.p3.2.m2.1.1.3.3.2.3.cmml">G</mi></msub><mo id="S3.SS2.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p3.2.m2.1.1.3.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.3.3.2" xref="S3.SS2.p3.2.m2.1.1.3.3.3.2.cmml">W</mi><mi id="S3.SS2.p3.2.m2.1.1.3.3.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.3.3.cmml">G</mi></msub><mo id="S3.SS2.p3.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p3.2.m2.1.1.3.3.4" xref="S3.SS2.p3.2.m2.1.1.3.3.4.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><in id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></in><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑝</ci><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">R</ci><apply id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3"><times id="S3.SS2.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.1"></times><apply id="S3.SS2.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.2.3">𝐺</ci></apply><apply id="S3.SS2.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3.2">𝑊</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3.3.3">𝐺</ci></apply><cn id="S3.SS2.p3.2.m2.1.1.3.3.4.cmml" type="integer" xref="S3.SS2.p3.2.m2.1.1.3.3.4">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">p\in\mathrm{R}^{H_{G}\times W_{G}\times 2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_p ∈ roman_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT × italic_W start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT × 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is generated by downsampling the input feature map by factor <math alttext="r" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_r</annotation></semantics></math>, <math alttext="H_{G}=H/r,W_{G}=W/r" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.2"><semantics id="S3.SS2.p3.4.m4.2a"><mrow id="S3.SS2.p3.4.m4.2.2.2" xref="S3.SS2.p3.4.m4.2.2.3.cmml"><mrow id="S3.SS2.p3.4.m4.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.cmml"><msub id="S3.SS2.p3.4.m4.1.1.1.1.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.1.1.2.2.cmml">H</mi><mi id="S3.SS2.p3.4.m4.1.1.1.1.2.3" xref="S3.SS2.p3.4.m4.1.1.1.1.2.3.cmml">G</mi></msub><mo id="S3.SS2.p3.4.m4.1.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p3.4.m4.1.1.1.1.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2.cmml">H</mi><mo id="S3.SS2.p3.4.m4.1.1.1.1.3.1" xref="S3.SS2.p3.4.m4.1.1.1.1.3.1.cmml">/</mo><mi id="S3.SS2.p3.4.m4.1.1.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.1.1.3.3.cmml">r</mi></mrow></mrow><mo id="S3.SS2.p3.4.m4.2.2.2.3" xref="S3.SS2.p3.4.m4.2.2.3a.cmml">,</mo><mrow id="S3.SS2.p3.4.m4.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.cmml"><msub id="S3.SS2.p3.4.m4.2.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.4.m4.2.2.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.2.2.cmml">W</mi><mi id="S3.SS2.p3.4.m4.2.2.2.2.2.3" xref="S3.SS2.p3.4.m4.2.2.2.2.2.3.cmml">G</mi></msub><mo id="S3.SS2.p3.4.m4.2.2.2.2.1" xref="S3.SS2.p3.4.m4.2.2.2.2.1.cmml">=</mo><mrow id="S3.SS2.p3.4.m4.2.2.2.2.3" xref="S3.SS2.p3.4.m4.2.2.2.2.3.cmml"><mi id="S3.SS2.p3.4.m4.2.2.2.2.3.2" xref="S3.SS2.p3.4.m4.2.2.2.2.3.2.cmml">W</mi><mo id="S3.SS2.p3.4.m4.2.2.2.2.3.1" xref="S3.SS2.p3.4.m4.2.2.2.2.3.1.cmml">/</mo><mi id="S3.SS2.p3.4.m4.2.2.2.2.3.3" xref="S3.SS2.p3.4.m4.2.2.2.2.3.3.cmml">r</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.2b"><apply id="S3.SS2.p3.4.m4.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.2.2.3a.cmml" xref="S3.SS2.p3.4.m4.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1"><eq id="S3.SS2.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.1"></eq><apply id="S3.SS2.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2.2">𝐻</ci><ci id="S3.SS2.p3.4.m4.1.1.1.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.2.3">𝐺</ci></apply><apply id="S3.SS2.p3.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3"><divide id="S3.SS2.p3.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.1"></divide><ci id="S3.SS2.p3.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.2">𝐻</ci><ci id="S3.SS2.p3.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1.3.3">𝑟</ci></apply></apply><apply id="S3.SS2.p3.4.m4.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2"><eq id="S3.SS2.p3.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.1"></eq><apply id="S3.SS2.p3.4.m4.2.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.2.2">𝑊</ci><ci id="S3.SS2.p3.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.2.3">𝐺</ci></apply><apply id="S3.SS2.p3.4.m4.2.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.3"><divide id="S3.SS2.p3.4.m4.2.2.2.2.3.1.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.3.1"></divide><ci id="S3.SS2.p3.4.m4.2.2.2.2.3.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.3.2">𝑊</ci><ci id="S3.SS2.p3.4.m4.2.2.2.2.3.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.2c">H_{G}=H/r,W_{G}=W/r</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.2d">italic_H start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT = italic_H / italic_r , italic_W start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT = italic_W / italic_r</annotation></semantics></math> as a reference. To obtain the offset for each reference point, the features are linearly projected to generate query tokens <math alttext="q=xW_{q}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">q</mi><mo id="S3.SS2.p3.5.m5.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.3.2" xref="S3.SS2.p3.5.m5.1.1.3.2.cmml">x</mi><mo id="S3.SS2.p3.5.m5.1.1.3.1" xref="S3.SS2.p3.5.m5.1.1.3.1.cmml">⁢</mo><msub id="S3.SS2.p3.5.m5.1.1.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.3.3.2" xref="S3.SS2.p3.5.m5.1.1.3.3.2.cmml">W</mi><mi id="S3.SS2.p3.5.m5.1.1.3.3.3" xref="S3.SS2.p3.5.m5.1.1.3.3.3.cmml">q</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><eq id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1"></eq><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑞</ci><apply id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3"><times id="S3.SS2.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.2">𝑥</ci><apply id="S3.SS2.p3.5.m5.1.1.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3.2">𝑊</ci><ci id="S3.SS2.p3.5.m5.1.1.3.3.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">q=xW_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_q = italic_x italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, which are then input into the <math alttext="\theta_{offset}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mrow id="S3.SS2.p3.6.m6.1.2" xref="S3.SS2.p3.6.m6.1.2.cmml"><msub id="S3.SS2.p3.6.m6.1.2.2" xref="S3.SS2.p3.6.m6.1.2.2.cmml"><mi id="S3.SS2.p3.6.m6.1.2.2.2" xref="S3.SS2.p3.6.m6.1.2.2.2.cmml">θ</mi><mrow id="S3.SS2.p3.6.m6.1.2.2.3" xref="S3.SS2.p3.6.m6.1.2.2.3.cmml"><mi id="S3.SS2.p3.6.m6.1.2.2.3.2" xref="S3.SS2.p3.6.m6.1.2.2.3.2.cmml">o</mi><mo id="S3.SS2.p3.6.m6.1.2.2.3.1" xref="S3.SS2.p3.6.m6.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.2.2.3.3" xref="S3.SS2.p3.6.m6.1.2.2.3.3.cmml">f</mi><mo id="S3.SS2.p3.6.m6.1.2.2.3.1a" xref="S3.SS2.p3.6.m6.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.2.2.3.4" xref="S3.SS2.p3.6.m6.1.2.2.3.4.cmml">f</mi><mo id="S3.SS2.p3.6.m6.1.2.2.3.1b" xref="S3.SS2.p3.6.m6.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.2.2.3.5" xref="S3.SS2.p3.6.m6.1.2.2.3.5.cmml">s</mi><mo id="S3.SS2.p3.6.m6.1.2.2.3.1c" xref="S3.SS2.p3.6.m6.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.2.2.3.6" xref="S3.SS2.p3.6.m6.1.2.2.3.6.cmml">e</mi><mo id="S3.SS2.p3.6.m6.1.2.2.3.1d" xref="S3.SS2.p3.6.m6.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.6.m6.1.2.2.3.7" xref="S3.SS2.p3.6.m6.1.2.2.3.7.cmml">t</mi></mrow></msub><mo id="S3.SS2.p3.6.m6.1.2.1" xref="S3.SS2.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p3.6.m6.1.2.3.2" xref="S3.SS2.p3.6.m6.1.2.cmml"><mo id="S3.SS2.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS2.p3.6.m6.1.2.cmml">(</mo><mo id="S3.SS2.p3.6.m6.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.6.m6.1.1.cmml">⋅</mo><mo id="S3.SS2.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS2.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.2.cmml" xref="S3.SS2.p3.6.m6.1.2"><times id="S3.SS2.p3.6.m6.1.2.1.cmml" xref="S3.SS2.p3.6.m6.1.2.1"></times><apply id="S3.SS2.p3.6.m6.1.2.2.cmml" xref="S3.SS2.p3.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.2.2.1.cmml" xref="S3.SS2.p3.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.2.2.2.cmml" xref="S3.SS2.p3.6.m6.1.2.2.2">𝜃</ci><apply id="S3.SS2.p3.6.m6.1.2.2.3.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3"><times id="S3.SS2.p3.6.m6.1.2.2.3.1.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3.1"></times><ci id="S3.SS2.p3.6.m6.1.2.2.3.2.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3.2">𝑜</ci><ci id="S3.SS2.p3.6.m6.1.2.2.3.3.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3.3">𝑓</ci><ci id="S3.SS2.p3.6.m6.1.2.2.3.4.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3.4">𝑓</ci><ci id="S3.SS2.p3.6.m6.1.2.2.3.5.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3.5">𝑠</ci><ci id="S3.SS2.p3.6.m6.1.2.2.3.6.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3.6">𝑒</ci><ci id="S3.SS2.p3.6.m6.1.2.2.3.7.cmml" xref="S3.SS2.p3.6.m6.1.2.2.3.7">𝑡</ci></apply></apply><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\theta_{offset}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_θ start_POSTSUBSCRIPT italic_o italic_f italic_f italic_s italic_e italic_t end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> subnetwork to produce the offsets <math alttext="\Delta p=\theta_{offset}(q)" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><mrow id="S3.SS2.p3.7.m7.1.2" xref="S3.SS2.p3.7.m7.1.2.cmml"><mrow id="S3.SS2.p3.7.m7.1.2.2" xref="S3.SS2.p3.7.m7.1.2.2.cmml"><mi id="S3.SS2.p3.7.m7.1.2.2.2" mathvariant="normal" xref="S3.SS2.p3.7.m7.1.2.2.2.cmml">Δ</mi><mo id="S3.SS2.p3.7.m7.1.2.2.1" xref="S3.SS2.p3.7.m7.1.2.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.7.m7.1.2.2.3" xref="S3.SS2.p3.7.m7.1.2.2.3.cmml">p</mi></mrow><mo id="S3.SS2.p3.7.m7.1.2.1" xref="S3.SS2.p3.7.m7.1.2.1.cmml">=</mo><mrow id="S3.SS2.p3.7.m7.1.2.3" xref="S3.SS2.p3.7.m7.1.2.3.cmml"><msub id="S3.SS2.p3.7.m7.1.2.3.2" xref="S3.SS2.p3.7.m7.1.2.3.2.cmml"><mi id="S3.SS2.p3.7.m7.1.2.3.2.2" xref="S3.SS2.p3.7.m7.1.2.3.2.2.cmml">θ</mi><mrow id="S3.SS2.p3.7.m7.1.2.3.2.3" xref="S3.SS2.p3.7.m7.1.2.3.2.3.cmml"><mi id="S3.SS2.p3.7.m7.1.2.3.2.3.2" xref="S3.SS2.p3.7.m7.1.2.3.2.3.2.cmml">o</mi><mo id="S3.SS2.p3.7.m7.1.2.3.2.3.1" xref="S3.SS2.p3.7.m7.1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.7.m7.1.2.3.2.3.3" xref="S3.SS2.p3.7.m7.1.2.3.2.3.3.cmml">f</mi><mo id="S3.SS2.p3.7.m7.1.2.3.2.3.1a" xref="S3.SS2.p3.7.m7.1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.7.m7.1.2.3.2.3.4" xref="S3.SS2.p3.7.m7.1.2.3.2.3.4.cmml">f</mi><mo id="S3.SS2.p3.7.m7.1.2.3.2.3.1b" xref="S3.SS2.p3.7.m7.1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.7.m7.1.2.3.2.3.5" xref="S3.SS2.p3.7.m7.1.2.3.2.3.5.cmml">s</mi><mo id="S3.SS2.p3.7.m7.1.2.3.2.3.1c" xref="S3.SS2.p3.7.m7.1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.7.m7.1.2.3.2.3.6" xref="S3.SS2.p3.7.m7.1.2.3.2.3.6.cmml">e</mi><mo id="S3.SS2.p3.7.m7.1.2.3.2.3.1d" xref="S3.SS2.p3.7.m7.1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.7.m7.1.2.3.2.3.7" xref="S3.SS2.p3.7.m7.1.2.3.2.3.7.cmml">t</mi></mrow></msub><mo id="S3.SS2.p3.7.m7.1.2.3.1" xref="S3.SS2.p3.7.m7.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p3.7.m7.1.2.3.3.2" xref="S3.SS2.p3.7.m7.1.2.3.cmml"><mo id="S3.SS2.p3.7.m7.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p3.7.m7.1.2.3.cmml">(</mo><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">q</mi><mo id="S3.SS2.p3.7.m7.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p3.7.m7.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.2.cmml" xref="S3.SS2.p3.7.m7.1.2"><eq id="S3.SS2.p3.7.m7.1.2.1.cmml" xref="S3.SS2.p3.7.m7.1.2.1"></eq><apply id="S3.SS2.p3.7.m7.1.2.2.cmml" xref="S3.SS2.p3.7.m7.1.2.2"><times id="S3.SS2.p3.7.m7.1.2.2.1.cmml" xref="S3.SS2.p3.7.m7.1.2.2.1"></times><ci id="S3.SS2.p3.7.m7.1.2.2.2.cmml" xref="S3.SS2.p3.7.m7.1.2.2.2">Δ</ci><ci id="S3.SS2.p3.7.m7.1.2.2.3.cmml" xref="S3.SS2.p3.7.m7.1.2.2.3">𝑝</ci></apply><apply id="S3.SS2.p3.7.m7.1.2.3.cmml" xref="S3.SS2.p3.7.m7.1.2.3"><times id="S3.SS2.p3.7.m7.1.2.3.1.cmml" xref="S3.SS2.p3.7.m7.1.2.3.1"></times><apply id="S3.SS2.p3.7.m7.1.2.3.2.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.2.3.2.1.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.2.3.2.2.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.2">𝜃</ci><apply id="S3.SS2.p3.7.m7.1.2.3.2.3.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3"><times id="S3.SS2.p3.7.m7.1.2.3.2.3.1.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3.1"></times><ci id="S3.SS2.p3.7.m7.1.2.3.2.3.2.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3.2">𝑜</ci><ci id="S3.SS2.p3.7.m7.1.2.3.2.3.3.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3.3">𝑓</ci><ci id="S3.SS2.p3.7.m7.1.2.3.2.3.4.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3.4">𝑓</ci><ci id="S3.SS2.p3.7.m7.1.2.3.2.3.5.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3.5">𝑠</ci><ci id="S3.SS2.p3.7.m7.1.2.3.2.3.6.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3.6">𝑒</ci><ci id="S3.SS2.p3.7.m7.1.2.3.2.3.7.cmml" xref="S3.SS2.p3.7.m7.1.2.3.2.3.7">𝑡</ci></apply></apply><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">\Delta p=\theta_{offset}(q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">roman_Δ italic_p = italic_θ start_POSTSUBSCRIPT italic_o italic_f italic_f italic_s italic_e italic_t end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>. Subsequently, the features are sampled at the locations of deformed points as keys and values and further processed by projection matrices:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q=xW_{q},\Delta p=\theta_{offset}(q),\bar{x}=\varphi(x;p+\Delta p)," class="ltx_Math" display="block" id="S3.E6.m1.3"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1"><mrow id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.3.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">q</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.1.3.2.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.1.1.3.1" xref="S3.E6.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E6.m1.3.3.1.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.3.3.2" xref="S3.E6.m1.3.3.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E6.m1.3.3.1.1.1.1.3.3.3" xref="S3.E6.m1.3.3.1.1.1.1.3.3.3.cmml">q</mi></msub></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml"><mrow id="S3.E6.m1.3.3.1.1.2.2.1.1" xref="S3.E6.m1.3.3.1.1.2.2.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.2.2.1.1.2" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.2.2" mathvariant="normal" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2.2.cmml">Δ</mi><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.2.1" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2.1.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2.3.cmml">p</mi></mrow><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.1" xref="S3.E6.m1.3.3.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.1.1.3" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.cmml"><msub id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.2.cmml">θ</mi><mrow id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.2" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.2.cmml">o</mi><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.3" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.3.cmml">f</mi><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1a" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.4" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.4.cmml">f</mi><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1b" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.5" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.5.cmml">s</mi><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1c" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.6" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.6.cmml">e</mi><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1d" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.7" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.7.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.1" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.1.1.3.3.2" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.cmml"><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">q</mi><mo id="S3.E6.m1.3.3.1.1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E6.m1.3.3.1.1.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.3.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.2.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.3.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.1.cmml">¯</mo></mover><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.1.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.3.cmml">φ</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.2.cmml"><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.2.cmml">(</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">x</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.2.cmml">;</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.2.cmml">p</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.cmml">+</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.2" mathvariant="normal" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.2.cmml">Δ</mi><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.1" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.3.cmml">p</mi></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.4" stretchy="false" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3a.cmml" xref="S3.E6.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1"><eq id="S3.E6.m1.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"></eq><ci id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2">𝑞</ci><apply id="S3.E6.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3"><times id="S3.E6.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.1"></times><ci id="S3.E6.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.2">𝑥</ci><apply id="S3.E6.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E6.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3.3">𝑞</ci></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.3a.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.3.3.1.1.2.2.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1"><eq id="S3.E6.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.1"></eq><apply id="S3.E6.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2"><times id="S3.E6.m1.3.3.1.1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2.1"></times><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2.2">Δ</ci><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.2.3">𝑝</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3"><times id="S3.E6.m1.3.3.1.1.2.2.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.1"></times><apply id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.2">𝜃</ci><apply id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3"><times id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.1"></times><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.2">𝑜</ci><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.3">𝑓</ci><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.4.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.4">𝑓</ci><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.5.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.5">𝑠</ci><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.6.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.6">𝑒</ci><ci id="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.7.cmml" xref="S3.E6.m1.3.3.1.1.2.2.1.1.3.2.3.7">𝑡</ci></apply></apply><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑞</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2"><eq id="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2"></eq><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3"><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.1">¯</ci><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.2">𝑥</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1"><times id="S3.E6.m1.3.3.1.1.2.2.2.2.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.2"></times><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.1.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.3">𝜑</ci><list id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1"><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑥</ci><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1"><plus id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.1"></plus><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.2">𝑝</ci><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3"><times id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.1"></times><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.2">Δ</ci><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.1.1.1.1.3.3">𝑝</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">q=xW_{q},\Delta p=\theta_{offset}(q),\bar{x}=\varphi(x;p+\Delta p),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.3d">italic_q = italic_x italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , roman_Δ italic_p = italic_θ start_POSTSUBSCRIPT italic_o italic_f italic_f italic_s italic_e italic_t end_POSTSUBSCRIPT ( italic_q ) , over¯ start_ARG italic_x end_ARG = italic_φ ( italic_x ; italic_p + roman_Δ italic_p ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.11">where <math alttext="\bar{x}" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m1.1"><semantics id="S3.SS2.p3.8.m1.1a"><mover accent="true" id="S3.SS2.p3.8.m1.1.1" xref="S3.SS2.p3.8.m1.1.1.cmml"><mi id="S3.SS2.p3.8.m1.1.1.2" xref="S3.SS2.p3.8.m1.1.1.2.cmml">x</mi><mo id="S3.SS2.p3.8.m1.1.1.1" xref="S3.SS2.p3.8.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m1.1b"><apply id="S3.SS2.p3.8.m1.1.1.cmml" xref="S3.SS2.p3.8.m1.1.1"><ci id="S3.SS2.p3.8.m1.1.1.1.cmml" xref="S3.SS2.p3.8.m1.1.1.1">¯</ci><ci id="S3.SS2.p3.8.m1.1.1.2.cmml" xref="S3.SS2.p3.8.m1.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m1.1c">\bar{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m1.1d">over¯ start_ARG italic_x end_ARG</annotation></semantics></math> represent the deformed key <math alttext="\bar{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m2.1"><semantics id="S3.SS2.p3.9.m2.1a"><mover accent="true" id="S3.SS2.p3.9.m2.1.1" xref="S3.SS2.p3.9.m2.1.1.cmml"><mi id="S3.SS2.p3.9.m2.1.1.2" xref="S3.SS2.p3.9.m2.1.1.2.cmml">k</mi><mo id="S3.SS2.p3.9.m2.1.1.1" xref="S3.SS2.p3.9.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m2.1b"><apply id="S3.SS2.p3.9.m2.1.1.cmml" xref="S3.SS2.p3.9.m2.1.1"><ci id="S3.SS2.p3.9.m2.1.1.1.cmml" xref="S3.SS2.p3.9.m2.1.1.1">¯</ci><ci id="S3.SS2.p3.9.m2.1.1.2.cmml" xref="S3.SS2.p3.9.m2.1.1.2">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m2.1c">\bar{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m2.1d">over¯ start_ARG italic_k end_ARG</annotation></semantics></math> and value <math alttext="\bar{v}" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m3.1"><semantics id="S3.SS2.p3.10.m3.1a"><mover accent="true" id="S3.SS2.p3.10.m3.1.1" xref="S3.SS2.p3.10.m3.1.1.cmml"><mi id="S3.SS2.p3.10.m3.1.1.2" xref="S3.SS2.p3.10.m3.1.1.2.cmml">v</mi><mo id="S3.SS2.p3.10.m3.1.1.1" xref="S3.SS2.p3.10.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m3.1b"><apply id="S3.SS2.p3.10.m3.1.1.cmml" xref="S3.SS2.p3.10.m3.1.1"><ci id="S3.SS2.p3.10.m3.1.1.1.cmml" xref="S3.SS2.p3.10.m3.1.1.1">¯</ci><ci id="S3.SS2.p3.10.m3.1.1.2.cmml" xref="S3.SS2.p3.10.m3.1.1.2">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m3.1c">\bar{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m3.1d">over¯ start_ARG italic_v end_ARG</annotation></semantics></math> embeddings, respectively. Specifically, we set the sampling function <math alttext="\varphi(\cdot;\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p3.11.m4.2"><semantics id="S3.SS2.p3.11.m4.2a"><mrow id="S3.SS2.p3.11.m4.2.3" xref="S3.SS2.p3.11.m4.2.3.cmml"><mi id="S3.SS2.p3.11.m4.2.3.2" xref="S3.SS2.p3.11.m4.2.3.2.cmml">φ</mi><mo id="S3.SS2.p3.11.m4.2.3.1" xref="S3.SS2.p3.11.m4.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p3.11.m4.2.3.3.2" xref="S3.SS2.p3.11.m4.2.3.3.1.cmml"><mo id="S3.SS2.p3.11.m4.2.3.3.2.1" stretchy="false" xref="S3.SS2.p3.11.m4.2.3.3.1.cmml">(</mo><mo id="S3.SS2.p3.11.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.11.m4.1.1.cmml">⋅</mo><mo id="S3.SS2.p3.11.m4.2.3.3.2.2" rspace="0em" xref="S3.SS2.p3.11.m4.2.3.3.1.cmml">;</mo><mo id="S3.SS2.p3.11.m4.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p3.11.m4.2.2.cmml">⋅</mo><mo id="S3.SS2.p3.11.m4.2.3.3.2.3" stretchy="false" xref="S3.SS2.p3.11.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m4.2b"><apply id="S3.SS2.p3.11.m4.2.3.cmml" xref="S3.SS2.p3.11.m4.2.3"><times id="S3.SS2.p3.11.m4.2.3.1.cmml" xref="S3.SS2.p3.11.m4.2.3.1"></times><ci id="S3.SS2.p3.11.m4.2.3.2.cmml" xref="S3.SS2.p3.11.m4.2.3.2">𝜑</ci><list id="S3.SS2.p3.11.m4.2.3.3.1.cmml" xref="S3.SS2.p3.11.m4.2.3.3.2"><ci id="S3.SS2.p3.11.m4.1.1.cmml" xref="S3.SS2.p3.11.m4.1.1">⋅</ci><ci id="S3.SS2.p3.11.m4.2.2.cmml" xref="S3.SS2.p3.11.m4.2.2">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m4.2c">\varphi(\cdot;\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.11.m4.2d">italic_φ ( ⋅ ; ⋅ )</annotation></semantics></math> to a bilinear interpolation to make it differentiable:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\varphi(z;(p_{x},p_{y}))=\sum_{r_{x},r_{y}}g(p_{x},r_{x})g(p_{y},r_{y})z[r_{y}%
,r_{x},:]," class="ltx_Math" display="block" id="S3.E7.m1.5"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1.1" xref="S3.E7.m1.5.5.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.3.cmml">φ</mi><mo id="S3.E7.m1.5.5.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E7.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">z</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">;</mo><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml"><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.2.4" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">p</mi><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.3.cmml">y</mi></msub><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.E7.m1.5.5.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.5.5.1.1.8" rspace="0.111em" xref="S3.E7.m1.5.5.1.1.8.cmml">=</mo><mrow id="S3.E7.m1.5.5.1.1.7" xref="S3.E7.m1.5.5.1.1.7.cmml"><munder id="S3.E7.m1.5.5.1.1.7.7" xref="S3.E7.m1.5.5.1.1.7.7.cmml"><mo id="S3.E7.m1.5.5.1.1.7.7.2" movablelimits="false" xref="S3.E7.m1.5.5.1.1.7.7.2.cmml">∑</mo><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.3.cmml"><msub id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.E7.m1.2.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><msub id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.cmml">r</mi><mi id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml">y</mi></msub></mrow></munder><mrow id="S3.E7.m1.5.5.1.1.7.6" xref="S3.E7.m1.5.5.1.1.7.6.cmml"><mi id="S3.E7.m1.5.5.1.1.7.6.8" xref="S3.E7.m1.5.5.1.1.7.6.8.cmml">g</mi><mo id="S3.E7.m1.5.5.1.1.7.6.7" xref="S3.E7.m1.5.5.1.1.7.6.7.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.3.2.2.2" xref="S3.E7.m1.5.5.1.1.3.2.2.3.cmml"><mo id="S3.E7.m1.5.5.1.1.3.2.2.2.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.3.2.2.3.cmml">(</mo><msub id="S3.E7.m1.5.5.1.1.2.1.1.1.1" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.2.cmml">p</mi><mi id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.E7.m1.5.5.1.1.3.2.2.2.4" xref="S3.E7.m1.5.5.1.1.3.2.2.3.cmml">,</mo><msub id="S3.E7.m1.5.5.1.1.3.2.2.2.2" xref="S3.E7.m1.5.5.1.1.3.2.2.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.3.2.2.2.2.2" xref="S3.E7.m1.5.5.1.1.3.2.2.2.2.2.cmml">r</mi><mi id="S3.E7.m1.5.5.1.1.3.2.2.2.2.3" xref="S3.E7.m1.5.5.1.1.3.2.2.2.2.3.cmml">x</mi></msub><mo id="S3.E7.m1.5.5.1.1.3.2.2.2.5" stretchy="false" xref="S3.E7.m1.5.5.1.1.3.2.2.3.cmml">)</mo></mrow><mo id="S3.E7.m1.5.5.1.1.7.6.7a" xref="S3.E7.m1.5.5.1.1.7.6.7.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.7.6.9" xref="S3.E7.m1.5.5.1.1.7.6.9.cmml">g</mi><mo id="S3.E7.m1.5.5.1.1.7.6.7b" xref="S3.E7.m1.5.5.1.1.7.6.7.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.5.4.4.2" xref="S3.E7.m1.5.5.1.1.5.4.4.3.cmml"><mo id="S3.E7.m1.5.5.1.1.5.4.4.2.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.5.4.4.3.cmml">(</mo><msub id="S3.E7.m1.5.5.1.1.4.3.3.1.1" xref="S3.E7.m1.5.5.1.1.4.3.3.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.4.3.3.1.1.2" xref="S3.E7.m1.5.5.1.1.4.3.3.1.1.2.cmml">p</mi><mi id="S3.E7.m1.5.5.1.1.4.3.3.1.1.3" xref="S3.E7.m1.5.5.1.1.4.3.3.1.1.3.cmml">y</mi></msub><mo id="S3.E7.m1.5.5.1.1.5.4.4.2.4" xref="S3.E7.m1.5.5.1.1.5.4.4.3.cmml">,</mo><msub id="S3.E7.m1.5.5.1.1.5.4.4.2.2" xref="S3.E7.m1.5.5.1.1.5.4.4.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.5.4.4.2.2.2" xref="S3.E7.m1.5.5.1.1.5.4.4.2.2.2.cmml">r</mi><mi id="S3.E7.m1.5.5.1.1.5.4.4.2.2.3" xref="S3.E7.m1.5.5.1.1.5.4.4.2.2.3.cmml">y</mi></msub><mo id="S3.E7.m1.5.5.1.1.5.4.4.2.5" stretchy="false" xref="S3.E7.m1.5.5.1.1.5.4.4.3.cmml">)</mo></mrow><mo id="S3.E7.m1.5.5.1.1.7.6.7c" xref="S3.E7.m1.5.5.1.1.7.6.7.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.7.6.10" xref="S3.E7.m1.5.5.1.1.7.6.10.cmml">z</mi><mo id="S3.E7.m1.5.5.1.1.7.6.7d" xref="S3.E7.m1.5.5.1.1.7.6.7.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.7.6.6.2" xref="S3.E7.m1.5.5.1.1.7.6.6.3.cmml"><mo id="S3.E7.m1.5.5.1.1.7.6.6.2.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.7.6.6.3.cmml">[</mo><msub id="S3.E7.m1.5.5.1.1.6.5.5.1.1" xref="S3.E7.m1.5.5.1.1.6.5.5.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.6.5.5.1.1.2" xref="S3.E7.m1.5.5.1.1.6.5.5.1.1.2.cmml">r</mi><mi id="S3.E7.m1.5.5.1.1.6.5.5.1.1.3" xref="S3.E7.m1.5.5.1.1.6.5.5.1.1.3.cmml">y</mi></msub><mo id="S3.E7.m1.5.5.1.1.7.6.6.2.4" xref="S3.E7.m1.5.5.1.1.7.6.6.3.cmml">,</mo><msub id="S3.E7.m1.5.5.1.1.7.6.6.2.2" xref="S3.E7.m1.5.5.1.1.7.6.6.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.7.6.6.2.2.2" xref="S3.E7.m1.5.5.1.1.7.6.6.2.2.2.cmml">r</mi><mi id="S3.E7.m1.5.5.1.1.7.6.6.2.2.3" xref="S3.E7.m1.5.5.1.1.7.6.6.2.2.3.cmml">x</mi></msub><mo id="S3.E7.m1.5.5.1.1.7.6.6.2.5" xref="S3.E7.m1.5.5.1.1.7.6.6.3.cmml">,</mo><mo id="S3.E7.m1.4.4" rspace="0em" xref="S3.E7.m1.4.4.cmml">:</mo><mo id="S3.E7.m1.5.5.1.1.7.6.6.2.6" stretchy="false" xref="S3.E7.m1.5.5.1.1.7.6.6.3.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.1.2" xref="S3.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1"><eq id="S3.E7.m1.5.5.1.1.8.cmml" xref="S3.E7.m1.5.5.1.1.8"></eq><apply id="S3.E7.m1.5.5.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1"><times id="S3.E7.m1.5.5.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.2"></times><ci id="S3.E7.m1.5.5.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.3">𝜑</ci><list id="S3.E7.m1.5.5.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1"><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝑧</ci><interval closure="open" id="S3.E7.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2"><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.2">𝑝</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.3">𝑦</ci></apply></interval></list></apply><apply id="S3.E7.m1.5.5.1.1.7.cmml" xref="S3.E7.m1.5.5.1.1.7"><apply id="S3.E7.m1.5.5.1.1.7.7.cmml" xref="S3.E7.m1.5.5.1.1.7.7"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.7.7.1.cmml" xref="S3.E7.m1.5.5.1.1.7.7">subscript</csymbol><sum id="S3.E7.m1.5.5.1.1.7.7.2.cmml" xref="S3.E7.m1.5.5.1.1.7.7.2"></sum><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2"><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2">𝑟</ci><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2">𝑟</ci><ci id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3">𝑦</ci></apply></list></apply><apply id="S3.E7.m1.5.5.1.1.7.6.cmml" xref="S3.E7.m1.5.5.1.1.7.6"><times id="S3.E7.m1.5.5.1.1.7.6.7.cmml" xref="S3.E7.m1.5.5.1.1.7.6.7"></times><ci id="S3.E7.m1.5.5.1.1.7.6.8.cmml" xref="S3.E7.m1.5.5.1.1.7.6.8">𝑔</ci><interval closure="open" id="S3.E7.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.3.2.2.2"><apply id="S3.E7.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.2">𝑝</ci><ci id="S3.E7.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.2.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E7.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.3.2.2.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.3.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.3.2.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.3.2.2.2.2.2">𝑟</ci><ci id="S3.E7.m1.5.5.1.1.3.2.2.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.3.2.2.2.2.3">𝑥</ci></apply></interval><ci id="S3.E7.m1.5.5.1.1.7.6.9.cmml" xref="S3.E7.m1.5.5.1.1.7.6.9">𝑔</ci><interval closure="open" id="S3.E7.m1.5.5.1.1.5.4.4.3.cmml" xref="S3.E7.m1.5.5.1.1.5.4.4.2"><apply id="S3.E7.m1.5.5.1.1.4.3.3.1.1.cmml" xref="S3.E7.m1.5.5.1.1.4.3.3.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.4.3.3.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.4.3.3.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.4.3.3.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.4.3.3.1.1.2">𝑝</ci><ci id="S3.E7.m1.5.5.1.1.4.3.3.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.4.3.3.1.1.3">𝑦</ci></apply><apply id="S3.E7.m1.5.5.1.1.5.4.4.2.2.cmml" xref="S3.E7.m1.5.5.1.1.5.4.4.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.5.4.4.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.5.4.4.2.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.5.4.4.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.5.4.4.2.2.2">𝑟</ci><ci id="S3.E7.m1.5.5.1.1.5.4.4.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.5.4.4.2.2.3">𝑦</ci></apply></interval><ci id="S3.E7.m1.5.5.1.1.7.6.10.cmml" xref="S3.E7.m1.5.5.1.1.7.6.10">𝑧</ci><list id="S3.E7.m1.5.5.1.1.7.6.6.3.cmml" xref="S3.E7.m1.5.5.1.1.7.6.6.2"><apply id="S3.E7.m1.5.5.1.1.6.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1.1.6.5.5.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.6.5.5.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.6.5.5.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.6.5.5.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.6.5.5.1.1.2">𝑟</ci><ci id="S3.E7.m1.5.5.1.1.6.5.5.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.6.5.5.1.1.3">𝑦</ci></apply><apply id="S3.E7.m1.5.5.1.1.7.6.6.2.2.cmml" xref="S3.E7.m1.5.5.1.1.7.6.6.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.7.6.6.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.7.6.6.2.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.7.6.6.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.7.6.6.2.2.2">𝑟</ci><ci id="S3.E7.m1.5.5.1.1.7.6.6.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.7.6.6.2.2.3">𝑥</ci></apply><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">:</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\varphi(z;(p_{x},p_{y}))=\sum_{r_{x},r_{y}}g(p_{x},r_{x})g(p_{y},r_{y})z[r_{y}%
,r_{x},:],</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.5d">italic_φ ( italic_z ; ( italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ) ) = ∑ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_g ( italic_p start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ) italic_g ( italic_p start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ) italic_z [ italic_r start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , : ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.24">where the function <math alttext="g(a,b)=max(0,1-|a-b|)" class="ltx_Math" display="inline" id="S3.SS2.p3.12.m1.4"><semantics id="S3.SS2.p3.12.m1.4a"><mrow id="S3.SS2.p3.12.m1.4.4" xref="S3.SS2.p3.12.m1.4.4.cmml"><mrow id="S3.SS2.p3.12.m1.4.4.3" xref="S3.SS2.p3.12.m1.4.4.3.cmml"><mi id="S3.SS2.p3.12.m1.4.4.3.2" xref="S3.SS2.p3.12.m1.4.4.3.2.cmml">g</mi><mo id="S3.SS2.p3.12.m1.4.4.3.1" xref="S3.SS2.p3.12.m1.4.4.3.1.cmml">⁢</mo><mrow id="S3.SS2.p3.12.m1.4.4.3.3.2" xref="S3.SS2.p3.12.m1.4.4.3.3.1.cmml"><mo id="S3.SS2.p3.12.m1.4.4.3.3.2.1" stretchy="false" xref="S3.SS2.p3.12.m1.4.4.3.3.1.cmml">(</mo><mi id="S3.SS2.p3.12.m1.1.1" xref="S3.SS2.p3.12.m1.1.1.cmml">a</mi><mo id="S3.SS2.p3.12.m1.4.4.3.3.2.2" xref="S3.SS2.p3.12.m1.4.4.3.3.1.cmml">,</mo><mi id="S3.SS2.p3.12.m1.2.2" xref="S3.SS2.p3.12.m1.2.2.cmml">b</mi><mo id="S3.SS2.p3.12.m1.4.4.3.3.2.3" stretchy="false" xref="S3.SS2.p3.12.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.12.m1.4.4.2" xref="S3.SS2.p3.12.m1.4.4.2.cmml">=</mo><mrow id="S3.SS2.p3.12.m1.4.4.1" xref="S3.SS2.p3.12.m1.4.4.1.cmml"><mi id="S3.SS2.p3.12.m1.4.4.1.3" xref="S3.SS2.p3.12.m1.4.4.1.3.cmml">m</mi><mo id="S3.SS2.p3.12.m1.4.4.1.2" xref="S3.SS2.p3.12.m1.4.4.1.2.cmml">⁢</mo><mi id="S3.SS2.p3.12.m1.4.4.1.4" xref="S3.SS2.p3.12.m1.4.4.1.4.cmml">a</mi><mo id="S3.SS2.p3.12.m1.4.4.1.2a" xref="S3.SS2.p3.12.m1.4.4.1.2.cmml">⁢</mo><mi id="S3.SS2.p3.12.m1.4.4.1.5" xref="S3.SS2.p3.12.m1.4.4.1.5.cmml">x</mi><mo id="S3.SS2.p3.12.m1.4.4.1.2b" xref="S3.SS2.p3.12.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS2.p3.12.m1.4.4.1.1.1" xref="S3.SS2.p3.12.m1.4.4.1.1.2.cmml"><mo id="S3.SS2.p3.12.m1.4.4.1.1.1.2" stretchy="false" xref="S3.SS2.p3.12.m1.4.4.1.1.2.cmml">(</mo><mn id="S3.SS2.p3.12.m1.3.3" xref="S3.SS2.p3.12.m1.3.3.cmml">0</mn><mo id="S3.SS2.p3.12.m1.4.4.1.1.1.3" xref="S3.SS2.p3.12.m1.4.4.1.1.2.cmml">,</mo><mrow id="S3.SS2.p3.12.m1.4.4.1.1.1.1" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.cmml"><mn id="S3.SS2.p3.12.m1.4.4.1.1.1.1.3" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.3.cmml">1</mn><mo id="S3.SS2.p3.12.m1.4.4.1.1.1.1.2" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.2.cmml">−</mo><mrow id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.SS2.p3.12.m1.4.4.1.1.1.4" stretchy="false" xref="S3.SS2.p3.12.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m1.4b"><apply id="S3.SS2.p3.12.m1.4.4.cmml" xref="S3.SS2.p3.12.m1.4.4"><eq id="S3.SS2.p3.12.m1.4.4.2.cmml" xref="S3.SS2.p3.12.m1.4.4.2"></eq><apply id="S3.SS2.p3.12.m1.4.4.3.cmml" xref="S3.SS2.p3.12.m1.4.4.3"><times id="S3.SS2.p3.12.m1.4.4.3.1.cmml" xref="S3.SS2.p3.12.m1.4.4.3.1"></times><ci id="S3.SS2.p3.12.m1.4.4.3.2.cmml" xref="S3.SS2.p3.12.m1.4.4.3.2">𝑔</ci><interval closure="open" id="S3.SS2.p3.12.m1.4.4.3.3.1.cmml" xref="S3.SS2.p3.12.m1.4.4.3.3.2"><ci id="S3.SS2.p3.12.m1.1.1.cmml" xref="S3.SS2.p3.12.m1.1.1">𝑎</ci><ci id="S3.SS2.p3.12.m1.2.2.cmml" xref="S3.SS2.p3.12.m1.2.2">𝑏</ci></interval></apply><apply id="S3.SS2.p3.12.m1.4.4.1.cmml" xref="S3.SS2.p3.12.m1.4.4.1"><times id="S3.SS2.p3.12.m1.4.4.1.2.cmml" xref="S3.SS2.p3.12.m1.4.4.1.2"></times><ci id="S3.SS2.p3.12.m1.4.4.1.3.cmml" xref="S3.SS2.p3.12.m1.4.4.1.3">𝑚</ci><ci id="S3.SS2.p3.12.m1.4.4.1.4.cmml" xref="S3.SS2.p3.12.m1.4.4.1.4">𝑎</ci><ci id="S3.SS2.p3.12.m1.4.4.1.5.cmml" xref="S3.SS2.p3.12.m1.4.4.1.5">𝑥</ci><interval closure="open" id="S3.SS2.p3.12.m1.4.4.1.1.2.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1"><cn id="S3.SS2.p3.12.m1.3.3.cmml" type="integer" xref="S3.SS2.p3.12.m1.3.3">0</cn><apply id="S3.SS2.p3.12.m1.4.4.1.1.1.1.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1"><minus id="S3.SS2.p3.12.m1.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.2"></minus><cn id="S3.SS2.p3.12.m1.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.3">1</cn><apply id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1"><abs id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.2"></abs><apply id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1"><minus id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.1"></minus><ci id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.12.m1.4.4.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m1.4c">g(a,b)=max(0,1-|a-b|)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.12.m1.4d">italic_g ( italic_a , italic_b ) = italic_m italic_a italic_x ( 0 , 1 - | italic_a - italic_b | )</annotation></semantics></math> and <math alttext="(r_{x},r_{y})" class="ltx_Math" display="inline" id="S3.SS2.p3.13.m2.2"><semantics id="S3.SS2.p3.13.m2.2a"><mrow id="S3.SS2.p3.13.m2.2.2.2" xref="S3.SS2.p3.13.m2.2.2.3.cmml"><mo id="S3.SS2.p3.13.m2.2.2.2.3" stretchy="false" xref="S3.SS2.p3.13.m2.2.2.3.cmml">(</mo><msub id="S3.SS2.p3.13.m2.1.1.1.1" xref="S3.SS2.p3.13.m2.1.1.1.1.cmml"><mi id="S3.SS2.p3.13.m2.1.1.1.1.2" xref="S3.SS2.p3.13.m2.1.1.1.1.2.cmml">r</mi><mi id="S3.SS2.p3.13.m2.1.1.1.1.3" xref="S3.SS2.p3.13.m2.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.SS2.p3.13.m2.2.2.2.4" xref="S3.SS2.p3.13.m2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.13.m2.2.2.2.2" xref="S3.SS2.p3.13.m2.2.2.2.2.cmml"><mi id="S3.SS2.p3.13.m2.2.2.2.2.2" xref="S3.SS2.p3.13.m2.2.2.2.2.2.cmml">r</mi><mi id="S3.SS2.p3.13.m2.2.2.2.2.3" xref="S3.SS2.p3.13.m2.2.2.2.2.3.cmml">y</mi></msub><mo id="S3.SS2.p3.13.m2.2.2.2.5" stretchy="false" xref="S3.SS2.p3.13.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m2.2b"><interval closure="open" id="S3.SS2.p3.13.m2.2.2.3.cmml" xref="S3.SS2.p3.13.m2.2.2.2"><apply id="S3.SS2.p3.13.m2.1.1.1.1.cmml" xref="S3.SS2.p3.13.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m2.1.1.1.1.1.cmml" xref="S3.SS2.p3.13.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m2.1.1.1.1.2.cmml" xref="S3.SS2.p3.13.m2.1.1.1.1.2">𝑟</ci><ci id="S3.SS2.p3.13.m2.1.1.1.1.3.cmml" xref="S3.SS2.p3.13.m2.1.1.1.1.3">𝑥</ci></apply><apply id="S3.SS2.p3.13.m2.2.2.2.2.cmml" xref="S3.SS2.p3.13.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m2.2.2.2.2.1.cmml" xref="S3.SS2.p3.13.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.13.m2.2.2.2.2.2.cmml" xref="S3.SS2.p3.13.m2.2.2.2.2.2">𝑟</ci><ci id="S3.SS2.p3.13.m2.2.2.2.2.3.cmml" xref="S3.SS2.p3.13.m2.2.2.2.2.3">𝑦</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m2.2c">(r_{x},r_{y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.13.m2.2d">( italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT )</annotation></semantics></math> represent indices for all locations on <math alttext="z\in\mathrm{R}^{H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS2.p3.14.m3.1"><semantics id="S3.SS2.p3.14.m3.1a"><mrow id="S3.SS2.p3.14.m3.1.1" xref="S3.SS2.p3.14.m3.1.1.cmml"><mi id="S3.SS2.p3.14.m3.1.1.2" xref="S3.SS2.p3.14.m3.1.1.2.cmml">z</mi><mo id="S3.SS2.p3.14.m3.1.1.1" xref="S3.SS2.p3.14.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.14.m3.1.1.3" xref="S3.SS2.p3.14.m3.1.1.3.cmml"><mi id="S3.SS2.p3.14.m3.1.1.3.2" mathvariant="normal" xref="S3.SS2.p3.14.m3.1.1.3.2.cmml">R</mi><mrow id="S3.SS2.p3.14.m3.1.1.3.3" xref="S3.SS2.p3.14.m3.1.1.3.3.cmml"><mi id="S3.SS2.p3.14.m3.1.1.3.3.2" xref="S3.SS2.p3.14.m3.1.1.3.3.2.cmml">H</mi><mo id="S3.SS2.p3.14.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.14.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.14.m3.1.1.3.3.3" xref="S3.SS2.p3.14.m3.1.1.3.3.3.cmml">W</mi><mo id="S3.SS2.p3.14.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.14.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.14.m3.1.1.3.3.4" xref="S3.SS2.p3.14.m3.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m3.1b"><apply id="S3.SS2.p3.14.m3.1.1.cmml" xref="S3.SS2.p3.14.m3.1.1"><in id="S3.SS2.p3.14.m3.1.1.1.cmml" xref="S3.SS2.p3.14.m3.1.1.1"></in><ci id="S3.SS2.p3.14.m3.1.1.2.cmml" xref="S3.SS2.p3.14.m3.1.1.2">𝑧</ci><apply id="S3.SS2.p3.14.m3.1.1.3.cmml" xref="S3.SS2.p3.14.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m3.1.1.3.1.cmml" xref="S3.SS2.p3.14.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.14.m3.1.1.3.2.cmml" xref="S3.SS2.p3.14.m3.1.1.3.2">R</ci><apply id="S3.SS2.p3.14.m3.1.1.3.3.cmml" xref="S3.SS2.p3.14.m3.1.1.3.3"><times id="S3.SS2.p3.14.m3.1.1.3.3.1.cmml" xref="S3.SS2.p3.14.m3.1.1.3.3.1"></times><ci id="S3.SS2.p3.14.m3.1.1.3.3.2.cmml" xref="S3.SS2.p3.14.m3.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p3.14.m3.1.1.3.3.3.cmml" xref="S3.SS2.p3.14.m3.1.1.3.3.3">𝑊</ci><ci id="S3.SS2.p3.14.m3.1.1.3.3.4.cmml" xref="S3.SS2.p3.14.m3.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m3.1c">z\in\mathrm{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.14.m3.1d">italic_z ∈ roman_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>. In a similar setup as deformable attention, where <math alttext="g" class="ltx_Math" display="inline" id="S3.SS2.p3.15.m4.1"><semantics id="S3.SS2.p3.15.m4.1a"><mi id="S3.SS2.p3.15.m4.1.1" xref="S3.SS2.p3.15.m4.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.15.m4.1b"><ci id="S3.SS2.p3.15.m4.1.1.cmml" xref="S3.SS2.p3.15.m4.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.15.m4.1c">g</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.15.m4.1d">italic_g</annotation></semantics></math> is nonzero on the four integral points closest to <math alttext="(px,py)" class="ltx_Math" display="inline" id="S3.SS2.p3.16.m5.2"><semantics id="S3.SS2.p3.16.m5.2a"><mrow id="S3.SS2.p3.16.m5.2.2.2" xref="S3.SS2.p3.16.m5.2.2.3.cmml"><mo id="S3.SS2.p3.16.m5.2.2.2.3" stretchy="false" xref="S3.SS2.p3.16.m5.2.2.3.cmml">(</mo><mrow id="S3.SS2.p3.16.m5.1.1.1.1" xref="S3.SS2.p3.16.m5.1.1.1.1.cmml"><mi id="S3.SS2.p3.16.m5.1.1.1.1.2" xref="S3.SS2.p3.16.m5.1.1.1.1.2.cmml">p</mi><mo id="S3.SS2.p3.16.m5.1.1.1.1.1" xref="S3.SS2.p3.16.m5.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.16.m5.1.1.1.1.3" xref="S3.SS2.p3.16.m5.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS2.p3.16.m5.2.2.2.4" xref="S3.SS2.p3.16.m5.2.2.3.cmml">,</mo><mrow id="S3.SS2.p3.16.m5.2.2.2.2" xref="S3.SS2.p3.16.m5.2.2.2.2.cmml"><mi id="S3.SS2.p3.16.m5.2.2.2.2.2" xref="S3.SS2.p3.16.m5.2.2.2.2.2.cmml">p</mi><mo id="S3.SS2.p3.16.m5.2.2.2.2.1" xref="S3.SS2.p3.16.m5.2.2.2.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.16.m5.2.2.2.2.3" xref="S3.SS2.p3.16.m5.2.2.2.2.3.cmml">y</mi></mrow><mo id="S3.SS2.p3.16.m5.2.2.2.5" stretchy="false" xref="S3.SS2.p3.16.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.16.m5.2b"><interval closure="open" id="S3.SS2.p3.16.m5.2.2.3.cmml" xref="S3.SS2.p3.16.m5.2.2.2"><apply id="S3.SS2.p3.16.m5.1.1.1.1.cmml" xref="S3.SS2.p3.16.m5.1.1.1.1"><times id="S3.SS2.p3.16.m5.1.1.1.1.1.cmml" xref="S3.SS2.p3.16.m5.1.1.1.1.1"></times><ci id="S3.SS2.p3.16.m5.1.1.1.1.2.cmml" xref="S3.SS2.p3.16.m5.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.p3.16.m5.1.1.1.1.3.cmml" xref="S3.SS2.p3.16.m5.1.1.1.1.3">𝑥</ci></apply><apply id="S3.SS2.p3.16.m5.2.2.2.2.cmml" xref="S3.SS2.p3.16.m5.2.2.2.2"><times id="S3.SS2.p3.16.m5.2.2.2.2.1.cmml" xref="S3.SS2.p3.16.m5.2.2.2.2.1"></times><ci id="S3.SS2.p3.16.m5.2.2.2.2.2.cmml" xref="S3.SS2.p3.16.m5.2.2.2.2.2">𝑝</ci><ci id="S3.SS2.p3.16.m5.2.2.2.2.3.cmml" xref="S3.SS2.p3.16.m5.2.2.2.2.3">𝑦</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.16.m5.2c">(px,py)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.16.m5.2d">( italic_p italic_x , italic_p italic_y )</annotation></semantics></math>, Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.E7" title="In 3.2 Deformable bi-level routing attention (DBRA) ‣ 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">7</span></a> is simplified to a weighted average across these four locations.
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.24.1">Region partition and region-to-region routing.</span>
With the deformable attention feature map input <math alttext="\bar{x}\in\mathrm{R}^{H_{G}\times W_{G}\times C}" class="ltx_Math" display="inline" id="S3.SS2.p3.17.m6.1"><semantics id="S3.SS2.p3.17.m6.1a"><mrow id="S3.SS2.p3.17.m6.1.1" xref="S3.SS2.p3.17.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p3.17.m6.1.1.2" xref="S3.SS2.p3.17.m6.1.1.2.cmml"><mi id="S3.SS2.p3.17.m6.1.1.2.2" xref="S3.SS2.p3.17.m6.1.1.2.2.cmml">x</mi><mo id="S3.SS2.p3.17.m6.1.1.2.1" xref="S3.SS2.p3.17.m6.1.1.2.1.cmml">¯</mo></mover><mo id="S3.SS2.p3.17.m6.1.1.1" xref="S3.SS2.p3.17.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.17.m6.1.1.3" xref="S3.SS2.p3.17.m6.1.1.3.cmml"><mi id="S3.SS2.p3.17.m6.1.1.3.2" mathvariant="normal" xref="S3.SS2.p3.17.m6.1.1.3.2.cmml">R</mi><mrow id="S3.SS2.p3.17.m6.1.1.3.3" xref="S3.SS2.p3.17.m6.1.1.3.3.cmml"><msub id="S3.SS2.p3.17.m6.1.1.3.3.2" xref="S3.SS2.p3.17.m6.1.1.3.3.2.cmml"><mi id="S3.SS2.p3.17.m6.1.1.3.3.2.2" xref="S3.SS2.p3.17.m6.1.1.3.3.2.2.cmml">H</mi><mi id="S3.SS2.p3.17.m6.1.1.3.3.2.3" xref="S3.SS2.p3.17.m6.1.1.3.3.2.3.cmml">G</mi></msub><mo id="S3.SS2.p3.17.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.17.m6.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p3.17.m6.1.1.3.3.3" xref="S3.SS2.p3.17.m6.1.1.3.3.3.cmml"><mi id="S3.SS2.p3.17.m6.1.1.3.3.3.2" xref="S3.SS2.p3.17.m6.1.1.3.3.3.2.cmml">W</mi><mi id="S3.SS2.p3.17.m6.1.1.3.3.3.3" xref="S3.SS2.p3.17.m6.1.1.3.3.3.3.cmml">G</mi></msub><mo id="S3.SS2.p3.17.m6.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.17.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.17.m6.1.1.3.3.4" xref="S3.SS2.p3.17.m6.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.17.m6.1b"><apply id="S3.SS2.p3.17.m6.1.1.cmml" xref="S3.SS2.p3.17.m6.1.1"><in id="S3.SS2.p3.17.m6.1.1.1.cmml" xref="S3.SS2.p3.17.m6.1.1.1"></in><apply id="S3.SS2.p3.17.m6.1.1.2.cmml" xref="S3.SS2.p3.17.m6.1.1.2"><ci id="S3.SS2.p3.17.m6.1.1.2.1.cmml" xref="S3.SS2.p3.17.m6.1.1.2.1">¯</ci><ci id="S3.SS2.p3.17.m6.1.1.2.2.cmml" xref="S3.SS2.p3.17.m6.1.1.2.2">𝑥</ci></apply><apply id="S3.SS2.p3.17.m6.1.1.3.cmml" xref="S3.SS2.p3.17.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m6.1.1.3.1.cmml" xref="S3.SS2.p3.17.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.17.m6.1.1.3.2.cmml" xref="S3.SS2.p3.17.m6.1.1.3.2">R</ci><apply id="S3.SS2.p3.17.m6.1.1.3.3.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3"><times id="S3.SS2.p3.17.m6.1.1.3.3.1.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.1"></times><apply id="S3.SS2.p3.17.m6.1.1.3.3.2.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m6.1.1.3.3.2.1.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p3.17.m6.1.1.3.3.2.2.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS2.p3.17.m6.1.1.3.3.2.3.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.2.3">𝐺</ci></apply><apply id="S3.SS2.p3.17.m6.1.1.3.3.3.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.17.m6.1.1.3.3.3.1.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.17.m6.1.1.3.3.3.2.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.3.2">𝑊</ci><ci id="S3.SS2.p3.17.m6.1.1.3.3.3.3.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.3.3">𝐺</ci></apply><ci id="S3.SS2.p3.17.m6.1.1.3.3.4.cmml" xref="S3.SS2.p3.17.m6.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.17.m6.1c">\bar{x}\in\mathrm{R}^{H_{G}\times W_{G}\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.17.m6.1d">over¯ start_ARG italic_x end_ARG ∈ roman_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT × italic_W start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> and feature map <math alttext="x\in\mathrm{R}^{H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS2.p3.18.m7.1"><semantics id="S3.SS2.p3.18.m7.1a"><mrow id="S3.SS2.p3.18.m7.1.1" xref="S3.SS2.p3.18.m7.1.1.cmml"><mi id="S3.SS2.p3.18.m7.1.1.2" xref="S3.SS2.p3.18.m7.1.1.2.cmml">x</mi><mo id="S3.SS2.p3.18.m7.1.1.1" xref="S3.SS2.p3.18.m7.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.18.m7.1.1.3" xref="S3.SS2.p3.18.m7.1.1.3.cmml"><mi id="S3.SS2.p3.18.m7.1.1.3.2" mathvariant="normal" xref="S3.SS2.p3.18.m7.1.1.3.2.cmml">R</mi><mrow id="S3.SS2.p3.18.m7.1.1.3.3" xref="S3.SS2.p3.18.m7.1.1.3.3.cmml"><mi id="S3.SS2.p3.18.m7.1.1.3.3.2" xref="S3.SS2.p3.18.m7.1.1.3.3.2.cmml">H</mi><mo id="S3.SS2.p3.18.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.18.m7.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.18.m7.1.1.3.3.3" xref="S3.SS2.p3.18.m7.1.1.3.3.3.cmml">W</mi><mo id="S3.SS2.p3.18.m7.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.18.m7.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.18.m7.1.1.3.3.4" xref="S3.SS2.p3.18.m7.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.18.m7.1b"><apply id="S3.SS2.p3.18.m7.1.1.cmml" xref="S3.SS2.p3.18.m7.1.1"><in id="S3.SS2.p3.18.m7.1.1.1.cmml" xref="S3.SS2.p3.18.m7.1.1.1"></in><ci id="S3.SS2.p3.18.m7.1.1.2.cmml" xref="S3.SS2.p3.18.m7.1.1.2">𝑥</ci><apply id="S3.SS2.p3.18.m7.1.1.3.cmml" xref="S3.SS2.p3.18.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.18.m7.1.1.3.1.cmml" xref="S3.SS2.p3.18.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.18.m7.1.1.3.2.cmml" xref="S3.SS2.p3.18.m7.1.1.3.2">R</ci><apply id="S3.SS2.p3.18.m7.1.1.3.3.cmml" xref="S3.SS2.p3.18.m7.1.1.3.3"><times id="S3.SS2.p3.18.m7.1.1.3.3.1.cmml" xref="S3.SS2.p3.18.m7.1.1.3.3.1"></times><ci id="S3.SS2.p3.18.m7.1.1.3.3.2.cmml" xref="S3.SS2.p3.18.m7.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p3.18.m7.1.1.3.3.3.cmml" xref="S3.SS2.p3.18.m7.1.1.3.3.3">𝑊</ci><ci id="S3.SS2.p3.18.m7.1.1.3.3.4.cmml" xref="S3.SS2.p3.18.m7.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.18.m7.1c">x\in\mathrm{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.18.m7.1d">italic_x ∈ roman_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>, the process begins by dividing it into regions of size <math alttext="S\times S" class="ltx_Math" display="inline" id="S3.SS2.p3.19.m8.1"><semantics id="S3.SS2.p3.19.m8.1a"><mrow id="S3.SS2.p3.19.m8.1.1" xref="S3.SS2.p3.19.m8.1.1.cmml"><mi id="S3.SS2.p3.19.m8.1.1.2" xref="S3.SS2.p3.19.m8.1.1.2.cmml">S</mi><mo id="S3.SS2.p3.19.m8.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.19.m8.1.1.1.cmml">×</mo><mi id="S3.SS2.p3.19.m8.1.1.3" xref="S3.SS2.p3.19.m8.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.19.m8.1b"><apply id="S3.SS2.p3.19.m8.1.1.cmml" xref="S3.SS2.p3.19.m8.1.1"><times id="S3.SS2.p3.19.m8.1.1.1.cmml" xref="S3.SS2.p3.19.m8.1.1.1"></times><ci id="S3.SS2.p3.19.m8.1.1.2.cmml" xref="S3.SS2.p3.19.m8.1.1.2">𝑆</ci><ci id="S3.SS2.p3.19.m8.1.1.3.cmml" xref="S3.SS2.p3.19.m8.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.19.m8.1c">S\times S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.19.m8.1d">italic_S × italic_S</annotation></semantics></math> non-overlapped regions such that each region contains <math alttext="\frac{H_{G}W_{G}}{S^{2}}" class="ltx_Math" display="inline" id="S3.SS2.p3.20.m9.1"><semantics id="S3.SS2.p3.20.m9.1a"><mfrac id="S3.SS2.p3.20.m9.1.1" xref="S3.SS2.p3.20.m9.1.1.cmml"><mrow id="S3.SS2.p3.20.m9.1.1.2" xref="S3.SS2.p3.20.m9.1.1.2.cmml"><msub id="S3.SS2.p3.20.m9.1.1.2.2" xref="S3.SS2.p3.20.m9.1.1.2.2.cmml"><mi id="S3.SS2.p3.20.m9.1.1.2.2.2" xref="S3.SS2.p3.20.m9.1.1.2.2.2.cmml">H</mi><mi id="S3.SS2.p3.20.m9.1.1.2.2.3" xref="S3.SS2.p3.20.m9.1.1.2.2.3.cmml">G</mi></msub><mo id="S3.SS2.p3.20.m9.1.1.2.1" xref="S3.SS2.p3.20.m9.1.1.2.1.cmml">⁢</mo><msub id="S3.SS2.p3.20.m9.1.1.2.3" xref="S3.SS2.p3.20.m9.1.1.2.3.cmml"><mi id="S3.SS2.p3.20.m9.1.1.2.3.2" xref="S3.SS2.p3.20.m9.1.1.2.3.2.cmml">W</mi><mi id="S3.SS2.p3.20.m9.1.1.2.3.3" xref="S3.SS2.p3.20.m9.1.1.2.3.3.cmml">G</mi></msub></mrow><msup id="S3.SS2.p3.20.m9.1.1.3" xref="S3.SS2.p3.20.m9.1.1.3.cmml"><mi id="S3.SS2.p3.20.m9.1.1.3.2" xref="S3.SS2.p3.20.m9.1.1.3.2.cmml">S</mi><mn id="S3.SS2.p3.20.m9.1.1.3.3" xref="S3.SS2.p3.20.m9.1.1.3.3.cmml">2</mn></msup></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.20.m9.1b"><apply id="S3.SS2.p3.20.m9.1.1.cmml" xref="S3.SS2.p3.20.m9.1.1"><divide id="S3.SS2.p3.20.m9.1.1.1.cmml" xref="S3.SS2.p3.20.m9.1.1"></divide><apply id="S3.SS2.p3.20.m9.1.1.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2"><times id="S3.SS2.p3.20.m9.1.1.2.1.cmml" xref="S3.SS2.p3.20.m9.1.1.2.1"></times><apply id="S3.SS2.p3.20.m9.1.1.2.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m9.1.1.2.2.1.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p3.20.m9.1.1.2.2.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2.2">𝐻</ci><ci id="S3.SS2.p3.20.m9.1.1.2.2.3.cmml" xref="S3.SS2.p3.20.m9.1.1.2.2.3">𝐺</ci></apply><apply id="S3.SS2.p3.20.m9.1.1.2.3.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m9.1.1.2.3.1.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p3.20.m9.1.1.2.3.2.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3.2">𝑊</ci><ci id="S3.SS2.p3.20.m9.1.1.2.3.3.cmml" xref="S3.SS2.p3.20.m9.1.1.2.3.3">𝐺</ci></apply></apply><apply id="S3.SS2.p3.20.m9.1.1.3.cmml" xref="S3.SS2.p3.20.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.20.m9.1.1.3.1.cmml" xref="S3.SS2.p3.20.m9.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.20.m9.1.1.3.2.cmml" xref="S3.SS2.p3.20.m9.1.1.3.2">𝑆</ci><cn id="S3.SS2.p3.20.m9.1.1.3.3.cmml" type="integer" xref="S3.SS2.p3.20.m9.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.20.m9.1c">\frac{H_{G}W_{G}}{S^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.20.m9.1d">divide start_ARG italic_H start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> feature vectors with reshaped <math alttext="\bar{x}" class="ltx_Math" display="inline" id="S3.SS2.p3.21.m10.1"><semantics id="S3.SS2.p3.21.m10.1a"><mover accent="true" id="S3.SS2.p3.21.m10.1.1" xref="S3.SS2.p3.21.m10.1.1.cmml"><mi id="S3.SS2.p3.21.m10.1.1.2" xref="S3.SS2.p3.21.m10.1.1.2.cmml">x</mi><mo id="S3.SS2.p3.21.m10.1.1.1" xref="S3.SS2.p3.21.m10.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.21.m10.1b"><apply id="S3.SS2.p3.21.m10.1.1.cmml" xref="S3.SS2.p3.21.m10.1.1"><ci id="S3.SS2.p3.21.m10.1.1.1.cmml" xref="S3.SS2.p3.21.m10.1.1.1">¯</ci><ci id="S3.SS2.p3.21.m10.1.1.2.cmml" xref="S3.SS2.p3.21.m10.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.21.m10.1c">\bar{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.21.m10.1d">over¯ start_ARG italic_x end_ARG</annotation></semantics></math> as <math alttext="\bar{x^{r}}\in\mathrm{R}^{S^{2}\times\frac{H_{G}W_{G}}{S^{2}}}\times C" class="ltx_Math" display="inline" id="S3.SS2.p3.22.m11.1"><semantics id="S3.SS2.p3.22.m11.1a"><mrow id="S3.SS2.p3.22.m11.1.1" xref="S3.SS2.p3.22.m11.1.1.cmml"><mover accent="true" id="S3.SS2.p3.22.m11.1.1.2" xref="S3.SS2.p3.22.m11.1.1.2.cmml"><msup id="S3.SS2.p3.22.m11.1.1.2.2" xref="S3.SS2.p3.22.m11.1.1.2.2.cmml"><mi id="S3.SS2.p3.22.m11.1.1.2.2.2" xref="S3.SS2.p3.22.m11.1.1.2.2.2.cmml">x</mi><mi id="S3.SS2.p3.22.m11.1.1.2.2.3" xref="S3.SS2.p3.22.m11.1.1.2.2.3.cmml">r</mi></msup><mo id="S3.SS2.p3.22.m11.1.1.2.1" xref="S3.SS2.p3.22.m11.1.1.2.1.cmml">¯</mo></mover><mo id="S3.SS2.p3.22.m11.1.1.1" xref="S3.SS2.p3.22.m11.1.1.1.cmml">∈</mo><mrow id="S3.SS2.p3.22.m11.1.1.3" xref="S3.SS2.p3.22.m11.1.1.3.cmml"><msup id="S3.SS2.p3.22.m11.1.1.3.2" xref="S3.SS2.p3.22.m11.1.1.3.2.cmml"><mi id="S3.SS2.p3.22.m11.1.1.3.2.2" mathvariant="normal" xref="S3.SS2.p3.22.m11.1.1.3.2.2.cmml">R</mi><mrow id="S3.SS2.p3.22.m11.1.1.3.2.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.cmml"><msup id="S3.SS2.p3.22.m11.1.1.3.2.3.2" xref="S3.SS2.p3.22.m11.1.1.3.2.3.2.cmml"><mi id="S3.SS2.p3.22.m11.1.1.3.2.3.2.2" xref="S3.SS2.p3.22.m11.1.1.3.2.3.2.2.cmml">S</mi><mn id="S3.SS2.p3.22.m11.1.1.3.2.3.2.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.2.3.cmml">2</mn></msup><mo id="S3.SS2.p3.22.m11.1.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.22.m11.1.1.3.2.3.1.cmml">×</mo><mfrac id="S3.SS2.p3.22.m11.1.1.3.2.3.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.cmml"><mrow id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.cmml"><msub id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.cmml"><mi id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.2" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.2.cmml">H</mi><mi id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.3.cmml">G</mi></msub><mo id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.1" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.1.cmml">⁢</mo><msub id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.cmml"><mi id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.2" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.2.cmml">W</mi><mi id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.3.cmml">G</mi></msub></mrow><msup id="S3.SS2.p3.22.m11.1.1.3.2.3.3.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.cmml"><mi id="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.2" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.2.cmml">S</mi><mn id="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.3" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.3.cmml">2</mn></msup></mfrac></mrow></msup><mo id="S3.SS2.p3.22.m11.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.22.m11.1.1.3.1.cmml">×</mo><mi id="S3.SS2.p3.22.m11.1.1.3.3" xref="S3.SS2.p3.22.m11.1.1.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.22.m11.1b"><apply id="S3.SS2.p3.22.m11.1.1.cmml" xref="S3.SS2.p3.22.m11.1.1"><in id="S3.SS2.p3.22.m11.1.1.1.cmml" xref="S3.SS2.p3.22.m11.1.1.1"></in><apply id="S3.SS2.p3.22.m11.1.1.2.cmml" xref="S3.SS2.p3.22.m11.1.1.2"><ci id="S3.SS2.p3.22.m11.1.1.2.1.cmml" xref="S3.SS2.p3.22.m11.1.1.2.1">¯</ci><apply id="S3.SS2.p3.22.m11.1.1.2.2.cmml" xref="S3.SS2.p3.22.m11.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m11.1.1.2.2.1.cmml" xref="S3.SS2.p3.22.m11.1.1.2.2">superscript</csymbol><ci id="S3.SS2.p3.22.m11.1.1.2.2.2.cmml" xref="S3.SS2.p3.22.m11.1.1.2.2.2">𝑥</ci><ci id="S3.SS2.p3.22.m11.1.1.2.2.3.cmml" xref="S3.SS2.p3.22.m11.1.1.2.2.3">𝑟</ci></apply></apply><apply id="S3.SS2.p3.22.m11.1.1.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3"><times id="S3.SS2.p3.22.m11.1.1.3.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.1"></times><apply id="S3.SS2.p3.22.m11.1.1.3.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m11.1.1.3.2.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p3.22.m11.1.1.3.2.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.2">R</ci><apply id="S3.SS2.p3.22.m11.1.1.3.2.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3"><times id="S3.SS2.p3.22.m11.1.1.3.2.3.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.1"></times><apply id="S3.SS2.p3.22.m11.1.1.3.2.3.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m11.1.1.3.2.3.2.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.2">superscript</csymbol><ci id="S3.SS2.p3.22.m11.1.1.3.2.3.2.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.2.2">𝑆</ci><cn id="S3.SS2.p3.22.m11.1.1.3.2.3.2.3.cmml" type="integer" xref="S3.SS2.p3.22.m11.1.1.3.2.3.2.3">2</cn></apply><apply id="S3.SS2.p3.22.m11.1.1.3.2.3.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3"><divide id="S3.SS2.p3.22.m11.1.1.3.2.3.3.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3"></divide><apply id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2"><times id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.1"></times><apply id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.2">𝐻</ci><ci id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.2.3">𝐺</ci></apply><apply id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3">subscript</csymbol><ci id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.2">𝑊</ci><ci id="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.2.3.3">𝐺</ci></apply></apply><apply id="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.1.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.3">superscript</csymbol><ci id="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.2.cmml" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.2">𝑆</ci><cn id="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.3.cmml" type="integer" xref="S3.SS2.p3.22.m11.1.1.3.2.3.3.3.3">2</cn></apply></apply></apply></apply><ci id="S3.SS2.p3.22.m11.1.1.3.3.cmml" xref="S3.SS2.p3.22.m11.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.22.m11.1c">\bar{x^{r}}\in\mathrm{R}^{S^{2}\times\frac{H_{G}W_{G}}{S^{2}}}\times C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.22.m11.1d">over¯ start_ARG italic_x start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT end_ARG ∈ roman_R start_POSTSUPERSCRIPT italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × divide start_ARG italic_H start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_POSTSUPERSCRIPT × italic_C</annotation></semantics></math> and <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p3.23.m12.1"><semantics id="S3.SS2.p3.23.m12.1a"><mi id="S3.SS2.p3.23.m12.1.1" xref="S3.SS2.p3.23.m12.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.23.m12.1b"><ci id="S3.SS2.p3.23.m12.1.1.cmml" xref="S3.SS2.p3.23.m12.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.23.m12.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.23.m12.1d">italic_x</annotation></semantics></math> as <math alttext="x^{r}\in\mathrm{R}^{S^{2}\times\frac{HW}{S^{2}}}\times C" class="ltx_Math" display="inline" id="S3.SS2.p3.24.m13.1"><semantics id="S3.SS2.p3.24.m13.1a"><mrow id="S3.SS2.p3.24.m13.1.1" xref="S3.SS2.p3.24.m13.1.1.cmml"><msup id="S3.SS2.p3.24.m13.1.1.2" xref="S3.SS2.p3.24.m13.1.1.2.cmml"><mi id="S3.SS2.p3.24.m13.1.1.2.2" xref="S3.SS2.p3.24.m13.1.1.2.2.cmml">x</mi><mi id="S3.SS2.p3.24.m13.1.1.2.3" xref="S3.SS2.p3.24.m13.1.1.2.3.cmml">r</mi></msup><mo id="S3.SS2.p3.24.m13.1.1.1" xref="S3.SS2.p3.24.m13.1.1.1.cmml">∈</mo><mrow id="S3.SS2.p3.24.m13.1.1.3" xref="S3.SS2.p3.24.m13.1.1.3.cmml"><msup id="S3.SS2.p3.24.m13.1.1.3.2" xref="S3.SS2.p3.24.m13.1.1.3.2.cmml"><mi id="S3.SS2.p3.24.m13.1.1.3.2.2" mathvariant="normal" xref="S3.SS2.p3.24.m13.1.1.3.2.2.cmml">R</mi><mrow id="S3.SS2.p3.24.m13.1.1.3.2.3" xref="S3.SS2.p3.24.m13.1.1.3.2.3.cmml"><msup id="S3.SS2.p3.24.m13.1.1.3.2.3.2" xref="S3.SS2.p3.24.m13.1.1.3.2.3.2.cmml"><mi id="S3.SS2.p3.24.m13.1.1.3.2.3.2.2" xref="S3.SS2.p3.24.m13.1.1.3.2.3.2.2.cmml">S</mi><mn id="S3.SS2.p3.24.m13.1.1.3.2.3.2.3" xref="S3.SS2.p3.24.m13.1.1.3.2.3.2.3.cmml">2</mn></msup><mo id="S3.SS2.p3.24.m13.1.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.24.m13.1.1.3.2.3.1.cmml">×</mo><mfrac id="S3.SS2.p3.24.m13.1.1.3.2.3.3" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.cmml"><mrow id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.cmml"><mi id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.2" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.2.cmml">H</mi><mo id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.1" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.3" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.3.cmml">W</mi></mrow><msup id="S3.SS2.p3.24.m13.1.1.3.2.3.3.3" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.cmml"><mi id="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.2" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.2.cmml">S</mi><mn id="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.3" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.3.cmml">2</mn></msup></mfrac></mrow></msup><mo id="S3.SS2.p3.24.m13.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.24.m13.1.1.3.1.cmml">×</mo><mi id="S3.SS2.p3.24.m13.1.1.3.3" xref="S3.SS2.p3.24.m13.1.1.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.24.m13.1b"><apply id="S3.SS2.p3.24.m13.1.1.cmml" xref="S3.SS2.p3.24.m13.1.1"><in id="S3.SS2.p3.24.m13.1.1.1.cmml" xref="S3.SS2.p3.24.m13.1.1.1"></in><apply id="S3.SS2.p3.24.m13.1.1.2.cmml" xref="S3.SS2.p3.24.m13.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.1.1.2.1.cmml" xref="S3.SS2.p3.24.m13.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.24.m13.1.1.2.2.cmml" xref="S3.SS2.p3.24.m13.1.1.2.2">𝑥</ci><ci id="S3.SS2.p3.24.m13.1.1.2.3.cmml" xref="S3.SS2.p3.24.m13.1.1.2.3">𝑟</ci></apply><apply id="S3.SS2.p3.24.m13.1.1.3.cmml" xref="S3.SS2.p3.24.m13.1.1.3"><times id="S3.SS2.p3.24.m13.1.1.3.1.cmml" xref="S3.SS2.p3.24.m13.1.1.3.1"></times><apply id="S3.SS2.p3.24.m13.1.1.3.2.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.1.1.3.2.1.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p3.24.m13.1.1.3.2.2.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.2">R</ci><apply id="S3.SS2.p3.24.m13.1.1.3.2.3.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3"><times id="S3.SS2.p3.24.m13.1.1.3.2.3.1.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.1"></times><apply id="S3.SS2.p3.24.m13.1.1.3.2.3.2.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.1.1.3.2.3.2.1.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.2">superscript</csymbol><ci id="S3.SS2.p3.24.m13.1.1.3.2.3.2.2.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.2.2">𝑆</ci><cn id="S3.SS2.p3.24.m13.1.1.3.2.3.2.3.cmml" type="integer" xref="S3.SS2.p3.24.m13.1.1.3.2.3.2.3">2</cn></apply><apply id="S3.SS2.p3.24.m13.1.1.3.2.3.3.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3"><divide id="S3.SS2.p3.24.m13.1.1.3.2.3.3.1.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3"></divide><apply id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2"><times id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.1.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.1"></times><ci id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.2.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.2">𝐻</ci><ci id="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.3.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.2.3">𝑊</ci></apply><apply id="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.1.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.3">superscript</csymbol><ci id="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.2.cmml" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.2">𝑆</ci><cn id="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.3.cmml" type="integer" xref="S3.SS2.p3.24.m13.1.1.3.2.3.3.3.3">2</cn></apply></apply></apply></apply><ci id="S3.SS2.p3.24.m13.1.1.3.3.cmml" xref="S3.SS2.p3.24.m13.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.24.m13.1c">x^{r}\in\mathrm{R}^{S^{2}\times\frac{HW}{S^{2}}}\times C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.24.m13.1d">italic_x start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ∈ roman_R start_POSTSUPERSCRIPT italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × divide start_ARG italic_H italic_W end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_POSTSUPERSCRIPT × italic_C</annotation></semantics></math>. Then, we derive the query, key, and value with linear projections:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{q}=\bar{x^{r}}W_{q},\hat{k}=x^{r}W_{k},\hat{v}=x^{r}W_{v}." class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1"><mrow id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.1.1.2.2.cmml">q</mi><mo id="S3.E8.m1.1.1.1.1.1.1.2.1" xref="S3.E8.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.cmml"><msup id="S3.E8.m1.1.1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2.2.cmml">x</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2.3.cmml">r</mi></msup><mo id="S3.E8.m1.1.1.1.1.1.1.3.2.1" xref="S3.E8.m1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mo id="S3.E8.m1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E8.m1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml">q</mi></msub></mrow></mrow><mo id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.2.2.1.1" xref="S3.E8.m1.1.1.1.1.2.2.1.1.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.2.2.1.1.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2.2.cmml">k</mi><mo id="S3.E8.m1.1.1.1.1.2.2.1.1.2.1" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2.1.cmml">^</mo></mover><mo id="S3.E8.m1.1.1.1.1.2.2.1.1.1" xref="S3.E8.m1.1.1.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.1.1.3" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.cmml"><msup id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.2.cmml">x</mi><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.3.cmml">r</mi></msup><mo id="S3.E8.m1.1.1.1.1.2.2.1.1.3.1" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.1.cmml">⁢</mo><msub id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E8.m1.1.1.1.1.2.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.2.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2.2.cmml">v</mi><mo id="S3.E8.m1.1.1.1.1.2.2.2.2.2.1" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mo id="S3.E8.m1.1.1.1.1.2.2.2.2.1" xref="S3.E8.m1.1.1.1.1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.2.2.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.cmml"><msup id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.2.cmml">x</mi><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.3.cmml">r</mi></msup><mo id="S3.E8.m1.1.1.1.1.2.2.2.2.3.1" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><msub id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3.cmml">v</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"><ci id="S3.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2.2">𝑞</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3"><times id="S3.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2"><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.1">¯</ci><apply id="S3.E8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2.2">𝑥</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.2.2.3">𝑟</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3.3.3">𝑞</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1"><eq id="S3.E8.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2"><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2.1">^</ci><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.2.2">𝑘</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3"><times id="S3.E8.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.1"></times><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.2">𝑥</ci><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.2.3">𝑟</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.1.1.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2"><eq id="S3.E8.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2"><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2.1">^</ci><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.2.2">𝑣</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3"><times id="S3.E8.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.1"></times><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.2">𝑥</ci><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.2.3">𝑟</ci></apply><apply id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2.2.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\hat{q}=\bar{x^{r}}W_{q},\hat{k}=x^{r}W_{k},\hat{v}=x^{r}W_{v}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">over^ start_ARG italic_q end_ARG = over¯ start_ARG italic_x start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT end_ARG italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , over^ start_ARG italic_k end_ARG = italic_x start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , over^ start_ARG italic_v end_ARG = italic_x start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.28">Next, we use the region-to-region method, as introduced in BiFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>, which is applied to establish the attending relationship by constructing a directed graph. To initiate the process, region queries and keys <math alttext="\hat{q}^{r},\hat{k}^{r}\in\mathrm{S}^{S^{2}\times C}" class="ltx_Math" display="inline" id="S3.SS2.p3.25.m1.2"><semantics id="S3.SS2.p3.25.m1.2a"><mrow id="S3.SS2.p3.25.m1.2.2" xref="S3.SS2.p3.25.m1.2.2.cmml"><mrow id="S3.SS2.p3.25.m1.2.2.2.2" xref="S3.SS2.p3.25.m1.2.2.2.3.cmml"><msup id="S3.SS2.p3.25.m1.1.1.1.1.1" xref="S3.SS2.p3.25.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p3.25.m1.1.1.1.1.1.2" xref="S3.SS2.p3.25.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p3.25.m1.1.1.1.1.1.2.2" xref="S3.SS2.p3.25.m1.1.1.1.1.1.2.2.cmml">q</mi><mo id="S3.SS2.p3.25.m1.1.1.1.1.1.2.1" xref="S3.SS2.p3.25.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.25.m1.1.1.1.1.1.3" xref="S3.SS2.p3.25.m1.1.1.1.1.1.3.cmml">r</mi></msup><mo id="S3.SS2.p3.25.m1.2.2.2.2.3" xref="S3.SS2.p3.25.m1.2.2.2.3.cmml">,</mo><msup id="S3.SS2.p3.25.m1.2.2.2.2.2" xref="S3.SS2.p3.25.m1.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p3.25.m1.2.2.2.2.2.2" xref="S3.SS2.p3.25.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.25.m1.2.2.2.2.2.2.2" xref="S3.SS2.p3.25.m1.2.2.2.2.2.2.2.cmml">k</mi><mo id="S3.SS2.p3.25.m1.2.2.2.2.2.2.1" xref="S3.SS2.p3.25.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.25.m1.2.2.2.2.2.3" xref="S3.SS2.p3.25.m1.2.2.2.2.2.3.cmml">r</mi></msup></mrow><mo id="S3.SS2.p3.25.m1.2.2.3" xref="S3.SS2.p3.25.m1.2.2.3.cmml">∈</mo><msup id="S3.SS2.p3.25.m1.2.2.4" xref="S3.SS2.p3.25.m1.2.2.4.cmml"><mi id="S3.SS2.p3.25.m1.2.2.4.2" mathvariant="normal" xref="S3.SS2.p3.25.m1.2.2.4.2.cmml">S</mi><mrow id="S3.SS2.p3.25.m1.2.2.4.3" xref="S3.SS2.p3.25.m1.2.2.4.3.cmml"><msup id="S3.SS2.p3.25.m1.2.2.4.3.2" xref="S3.SS2.p3.25.m1.2.2.4.3.2.cmml"><mi id="S3.SS2.p3.25.m1.2.2.4.3.2.2" xref="S3.SS2.p3.25.m1.2.2.4.3.2.2.cmml">S</mi><mn id="S3.SS2.p3.25.m1.2.2.4.3.2.3" xref="S3.SS2.p3.25.m1.2.2.4.3.2.3.cmml">2</mn></msup><mo id="S3.SS2.p3.25.m1.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.25.m1.2.2.4.3.1.cmml">×</mo><mi id="S3.SS2.p3.25.m1.2.2.4.3.3" xref="S3.SS2.p3.25.m1.2.2.4.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.25.m1.2b"><apply id="S3.SS2.p3.25.m1.2.2.cmml" xref="S3.SS2.p3.25.m1.2.2"><in id="S3.SS2.p3.25.m1.2.2.3.cmml" xref="S3.SS2.p3.25.m1.2.2.3"></in><list id="S3.SS2.p3.25.m1.2.2.2.3.cmml" xref="S3.SS2.p3.25.m1.2.2.2.2"><apply id="S3.SS2.p3.25.m1.1.1.1.1.1.cmml" xref="S3.SS2.p3.25.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.25.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p3.25.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.25.m1.1.1.1.1.1.2"><ci id="S3.SS2.p3.25.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.25.m1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS2.p3.25.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.25.m1.1.1.1.1.1.2.2">𝑞</ci></apply><ci id="S3.SS2.p3.25.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.25.m1.1.1.1.1.1.3">𝑟</ci></apply><apply id="S3.SS2.p3.25.m1.2.2.2.2.2.cmml" xref="S3.SS2.p3.25.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.25.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p3.25.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.25.m1.2.2.2.2.2.2"><ci id="S3.SS2.p3.25.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.25.m1.2.2.2.2.2.2.1">^</ci><ci id="S3.SS2.p3.25.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.25.m1.2.2.2.2.2.2.2">𝑘</ci></apply><ci id="S3.SS2.p3.25.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.25.m1.2.2.2.2.2.3">𝑟</ci></apply></list><apply id="S3.SS2.p3.25.m1.2.2.4.cmml" xref="S3.SS2.p3.25.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m1.2.2.4.1.cmml" xref="S3.SS2.p3.25.m1.2.2.4">superscript</csymbol><ci id="S3.SS2.p3.25.m1.2.2.4.2.cmml" xref="S3.SS2.p3.25.m1.2.2.4.2">S</ci><apply id="S3.SS2.p3.25.m1.2.2.4.3.cmml" xref="S3.SS2.p3.25.m1.2.2.4.3"><times id="S3.SS2.p3.25.m1.2.2.4.3.1.cmml" xref="S3.SS2.p3.25.m1.2.2.4.3.1"></times><apply id="S3.SS2.p3.25.m1.2.2.4.3.2.cmml" xref="S3.SS2.p3.25.m1.2.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.25.m1.2.2.4.3.2.1.cmml" xref="S3.SS2.p3.25.m1.2.2.4.3.2">superscript</csymbol><ci id="S3.SS2.p3.25.m1.2.2.4.3.2.2.cmml" xref="S3.SS2.p3.25.m1.2.2.4.3.2.2">𝑆</ci><cn id="S3.SS2.p3.25.m1.2.2.4.3.2.3.cmml" type="integer" xref="S3.SS2.p3.25.m1.2.2.4.3.2.3">2</cn></apply><ci id="S3.SS2.p3.25.m1.2.2.4.3.3.cmml" xref="S3.SS2.p3.25.m1.2.2.4.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.25.m1.2c">\hat{q}^{r},\hat{k}^{r}\in\mathrm{S}^{S^{2}\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.25.m1.2d">over^ start_ARG italic_q end_ARG start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT , over^ start_ARG italic_k end_ARG start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ∈ roman_S start_POSTSUPERSCRIPT italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> are derived through the application of per-region averaging. Subsequently, the adjacency matrix <math alttext="A^{r}\in\mathrm{S^{2}\times S^{2}}" class="ltx_Math" display="inline" id="S3.SS2.p3.26.m2.1"><semantics id="S3.SS2.p3.26.m2.1a"><mrow id="S3.SS2.p3.26.m2.1.1" xref="S3.SS2.p3.26.m2.1.1.cmml"><msup id="S3.SS2.p3.26.m2.1.1.2" xref="S3.SS2.p3.26.m2.1.1.2.cmml"><mi id="S3.SS2.p3.26.m2.1.1.2.2" xref="S3.SS2.p3.26.m2.1.1.2.2.cmml">A</mi><mi id="S3.SS2.p3.26.m2.1.1.2.3" xref="S3.SS2.p3.26.m2.1.1.2.3.cmml">r</mi></msup><mo id="S3.SS2.p3.26.m2.1.1.1" xref="S3.SS2.p3.26.m2.1.1.1.cmml">∈</mo><mrow id="S3.SS2.p3.26.m2.1.1.3" xref="S3.SS2.p3.26.m2.1.1.3.cmml"><msup id="S3.SS2.p3.26.m2.1.1.3.2" xref="S3.SS2.p3.26.m2.1.1.3.2.cmml"><mi id="S3.SS2.p3.26.m2.1.1.3.2.2" mathvariant="normal" xref="S3.SS2.p3.26.m2.1.1.3.2.2.cmml">S</mi><mn id="S3.SS2.p3.26.m2.1.1.3.2.3" xref="S3.SS2.p3.26.m2.1.1.3.2.3.cmml">2</mn></msup><mo id="S3.SS2.p3.26.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.26.m2.1.1.3.1.cmml">×</mo><msup id="S3.SS2.p3.26.m2.1.1.3.3" xref="S3.SS2.p3.26.m2.1.1.3.3.cmml"><mi id="S3.SS2.p3.26.m2.1.1.3.3.2" mathvariant="normal" xref="S3.SS2.p3.26.m2.1.1.3.3.2.cmml">S</mi><mn id="S3.SS2.p3.26.m2.1.1.3.3.3" xref="S3.SS2.p3.26.m2.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.26.m2.1b"><apply id="S3.SS2.p3.26.m2.1.1.cmml" xref="S3.SS2.p3.26.m2.1.1"><in id="S3.SS2.p3.26.m2.1.1.1.cmml" xref="S3.SS2.p3.26.m2.1.1.1"></in><apply id="S3.SS2.p3.26.m2.1.1.2.cmml" xref="S3.SS2.p3.26.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.26.m2.1.1.2.1.cmml" xref="S3.SS2.p3.26.m2.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.26.m2.1.1.2.2.cmml" xref="S3.SS2.p3.26.m2.1.1.2.2">𝐴</ci><ci id="S3.SS2.p3.26.m2.1.1.2.3.cmml" xref="S3.SS2.p3.26.m2.1.1.2.3">𝑟</ci></apply><apply id="S3.SS2.p3.26.m2.1.1.3.cmml" xref="S3.SS2.p3.26.m2.1.1.3"><times id="S3.SS2.p3.26.m2.1.1.3.1.cmml" xref="S3.SS2.p3.26.m2.1.1.3.1"></times><apply id="S3.SS2.p3.26.m2.1.1.3.2.cmml" xref="S3.SS2.p3.26.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.26.m2.1.1.3.2.1.cmml" xref="S3.SS2.p3.26.m2.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p3.26.m2.1.1.3.2.2.cmml" xref="S3.SS2.p3.26.m2.1.1.3.2.2">S</ci><cn id="S3.SS2.p3.26.m2.1.1.3.2.3.cmml" type="integer" xref="S3.SS2.p3.26.m2.1.1.3.2.3">2</cn></apply><apply id="S3.SS2.p3.26.m2.1.1.3.3.cmml" xref="S3.SS2.p3.26.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.26.m2.1.1.3.3.1.cmml" xref="S3.SS2.p3.26.m2.1.1.3.3">superscript</csymbol><ci id="S3.SS2.p3.26.m2.1.1.3.3.2.cmml" xref="S3.SS2.p3.26.m2.1.1.3.3.2">S</ci><cn id="S3.SS2.p3.26.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p3.26.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.26.m2.1c">A^{r}\in\mathrm{S^{2}\times S^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.26.m2.1d">italic_A start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ∈ roman_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × roman_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> for the region-to-region affinity graph is derived through <math alttext="Q^{r}" class="ltx_Math" display="inline" id="S3.SS2.p3.27.m3.1"><semantics id="S3.SS2.p3.27.m3.1a"><msup id="S3.SS2.p3.27.m3.1.1" xref="S3.SS2.p3.27.m3.1.1.cmml"><mi id="S3.SS2.p3.27.m3.1.1.2" xref="S3.SS2.p3.27.m3.1.1.2.cmml">Q</mi><mi id="S3.SS2.p3.27.m3.1.1.3" xref="S3.SS2.p3.27.m3.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.27.m3.1b"><apply id="S3.SS2.p3.27.m3.1.1.cmml" xref="S3.SS2.p3.27.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.27.m3.1.1.1.cmml" xref="S3.SS2.p3.27.m3.1.1">superscript</csymbol><ci id="S3.SS2.p3.27.m3.1.1.2.cmml" xref="S3.SS2.p3.27.m3.1.1.2">𝑄</ci><ci id="S3.SS2.p3.27.m3.1.1.3.cmml" xref="S3.SS2.p3.27.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.27.m3.1c">Q^{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.27.m3.1d">italic_Q start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="K^{r^{\top}}" class="ltx_Math" display="inline" id="S3.SS2.p3.28.m4.1"><semantics id="S3.SS2.p3.28.m4.1a"><msup id="S3.SS2.p3.28.m4.1.1" xref="S3.SS2.p3.28.m4.1.1.cmml"><mi id="S3.SS2.p3.28.m4.1.1.2" xref="S3.SS2.p3.28.m4.1.1.2.cmml">K</mi><msup id="S3.SS2.p3.28.m4.1.1.3" xref="S3.SS2.p3.28.m4.1.1.3.cmml"><mi id="S3.SS2.p3.28.m4.1.1.3.2" xref="S3.SS2.p3.28.m4.1.1.3.2.cmml">r</mi><mo id="S3.SS2.p3.28.m4.1.1.3.3" xref="S3.SS2.p3.28.m4.1.1.3.3.cmml">⊤</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.28.m4.1b"><apply id="S3.SS2.p3.28.m4.1.1.cmml" xref="S3.SS2.p3.28.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.28.m4.1.1.1.cmml" xref="S3.SS2.p3.28.m4.1.1">superscript</csymbol><ci id="S3.SS2.p3.28.m4.1.1.2.cmml" xref="S3.SS2.p3.28.m4.1.1.2">𝐾</ci><apply id="S3.SS2.p3.28.m4.1.1.3.cmml" xref="S3.SS2.p3.28.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.28.m4.1.1.3.1.cmml" xref="S3.SS2.p3.28.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.28.m4.1.1.3.2.cmml" xref="S3.SS2.p3.28.m4.1.1.3.2">𝑟</ci><csymbol cd="latexml" id="S3.SS2.p3.28.m4.1.1.3.3.cmml" xref="S3.SS2.p3.28.m4.1.1.3.3">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.28.m4.1c">K^{r^{\top}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.28.m4.1d">italic_K start_POSTSUPERSCRIPT italic_r start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> matrix multiplication:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A^{r}=\hat{q}^{r}(\hat{k}^{r})^{\top}," class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><msup id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml">A</mi><mi id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml">r</mi></msup><mo id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><msup id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.1.3.2.2.cmml">q</mi><mo id="S3.E9.m1.1.1.1.1.1.3.2.1" xref="S3.E9.m1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.3.3.cmml">r</mi></msup><mo id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">k</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msup><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml">⊤</mo></msup></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"></eq><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2">𝐴</ci><ci id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2"><ci id="S3.E9.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2.2">𝑞</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2">𝑘</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply><csymbol cd="latexml" id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">A^{r}=\hat{q}^{r}(\hat{k}^{r})^{\top},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">italic_A start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT = over^ start_ARG italic_q end_ARG start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ( over^ start_ARG italic_k end_ARG start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.32">where adjacency matrix <math alttext="A^{r}" class="ltx_Math" display="inline" id="S3.SS2.p3.29.m1.1"><semantics id="S3.SS2.p3.29.m1.1a"><msup id="S3.SS2.p3.29.m1.1.1" xref="S3.SS2.p3.29.m1.1.1.cmml"><mi id="S3.SS2.p3.29.m1.1.1.2" xref="S3.SS2.p3.29.m1.1.1.2.cmml">A</mi><mi id="S3.SS2.p3.29.m1.1.1.3" xref="S3.SS2.p3.29.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.29.m1.1b"><apply id="S3.SS2.p3.29.m1.1.1.cmml" xref="S3.SS2.p3.29.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.29.m1.1.1.1.cmml" xref="S3.SS2.p3.29.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.29.m1.1.1.2.cmml" xref="S3.SS2.p3.29.m1.1.1.2">𝐴</ci><ci id="S3.SS2.p3.29.m1.1.1.3.cmml" xref="S3.SS2.p3.29.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.29.m1.1c">A^{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.29.m1.1d">italic_A start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> quantifies the semantic relationship between two regions. The crucial step in this method involves pruning the affinity graph by retaining only the <math alttext="topk" class="ltx_Math" display="inline" id="S3.SS2.p3.30.m2.1"><semantics id="S3.SS2.p3.30.m2.1a"><mrow id="S3.SS2.p3.30.m2.1.1" xref="S3.SS2.p3.30.m2.1.1.cmml"><mi id="S3.SS2.p3.30.m2.1.1.2" xref="S3.SS2.p3.30.m2.1.1.2.cmml">t</mi><mo id="S3.SS2.p3.30.m2.1.1.1" xref="S3.SS2.p3.30.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.30.m2.1.1.3" xref="S3.SS2.p3.30.m2.1.1.3.cmml">o</mi><mo id="S3.SS2.p3.30.m2.1.1.1a" xref="S3.SS2.p3.30.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.30.m2.1.1.4" xref="S3.SS2.p3.30.m2.1.1.4.cmml">p</mi><mo id="S3.SS2.p3.30.m2.1.1.1b" xref="S3.SS2.p3.30.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.30.m2.1.1.5" xref="S3.SS2.p3.30.m2.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.30.m2.1b"><apply id="S3.SS2.p3.30.m2.1.1.cmml" xref="S3.SS2.p3.30.m2.1.1"><times id="S3.SS2.p3.30.m2.1.1.1.cmml" xref="S3.SS2.p3.30.m2.1.1.1"></times><ci id="S3.SS2.p3.30.m2.1.1.2.cmml" xref="S3.SS2.p3.30.m2.1.1.2">𝑡</ci><ci id="S3.SS2.p3.30.m2.1.1.3.cmml" xref="S3.SS2.p3.30.m2.1.1.3">𝑜</ci><ci id="S3.SS2.p3.30.m2.1.1.4.cmml" xref="S3.SS2.p3.30.m2.1.1.4">𝑝</ci><ci id="S3.SS2.p3.30.m2.1.1.5.cmml" xref="S3.SS2.p3.30.m2.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.30.m2.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.30.m2.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> connections for each region with a routing index matrix <math alttext="I^{r}\in\mathrm{N}^{S^{2}\times k}" class="ltx_Math" display="inline" id="S3.SS2.p3.31.m3.1"><semantics id="S3.SS2.p3.31.m3.1a"><mrow id="S3.SS2.p3.31.m3.1.1" xref="S3.SS2.p3.31.m3.1.1.cmml"><msup id="S3.SS2.p3.31.m3.1.1.2" xref="S3.SS2.p3.31.m3.1.1.2.cmml"><mi id="S3.SS2.p3.31.m3.1.1.2.2" xref="S3.SS2.p3.31.m3.1.1.2.2.cmml">I</mi><mi id="S3.SS2.p3.31.m3.1.1.2.3" xref="S3.SS2.p3.31.m3.1.1.2.3.cmml">r</mi></msup><mo id="S3.SS2.p3.31.m3.1.1.1" xref="S3.SS2.p3.31.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.31.m3.1.1.3" xref="S3.SS2.p3.31.m3.1.1.3.cmml"><mi id="S3.SS2.p3.31.m3.1.1.3.2" mathvariant="normal" xref="S3.SS2.p3.31.m3.1.1.3.2.cmml">N</mi><mrow id="S3.SS2.p3.31.m3.1.1.3.3" xref="S3.SS2.p3.31.m3.1.1.3.3.cmml"><msup id="S3.SS2.p3.31.m3.1.1.3.3.2" xref="S3.SS2.p3.31.m3.1.1.3.3.2.cmml"><mi id="S3.SS2.p3.31.m3.1.1.3.3.2.2" xref="S3.SS2.p3.31.m3.1.1.3.3.2.2.cmml">S</mi><mn id="S3.SS2.p3.31.m3.1.1.3.3.2.3" xref="S3.SS2.p3.31.m3.1.1.3.3.2.3.cmml">2</mn></msup><mo id="S3.SS2.p3.31.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.31.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.31.m3.1.1.3.3.3" xref="S3.SS2.p3.31.m3.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.31.m3.1b"><apply id="S3.SS2.p3.31.m3.1.1.cmml" xref="S3.SS2.p3.31.m3.1.1"><in id="S3.SS2.p3.31.m3.1.1.1.cmml" xref="S3.SS2.p3.31.m3.1.1.1"></in><apply id="S3.SS2.p3.31.m3.1.1.2.cmml" xref="S3.SS2.p3.31.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.31.m3.1.1.2.1.cmml" xref="S3.SS2.p3.31.m3.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.31.m3.1.1.2.2.cmml" xref="S3.SS2.p3.31.m3.1.1.2.2">𝐼</ci><ci id="S3.SS2.p3.31.m3.1.1.2.3.cmml" xref="S3.SS2.p3.31.m3.1.1.2.3">𝑟</ci></apply><apply id="S3.SS2.p3.31.m3.1.1.3.cmml" xref="S3.SS2.p3.31.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.31.m3.1.1.3.1.cmml" xref="S3.SS2.p3.31.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.31.m3.1.1.3.2.cmml" xref="S3.SS2.p3.31.m3.1.1.3.2">N</ci><apply id="S3.SS2.p3.31.m3.1.1.3.3.cmml" xref="S3.SS2.p3.31.m3.1.1.3.3"><times id="S3.SS2.p3.31.m3.1.1.3.3.1.cmml" xref="S3.SS2.p3.31.m3.1.1.3.3.1"></times><apply id="S3.SS2.p3.31.m3.1.1.3.3.2.cmml" xref="S3.SS2.p3.31.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.31.m3.1.1.3.3.2.1.cmml" xref="S3.SS2.p3.31.m3.1.1.3.3.2">superscript</csymbol><ci id="S3.SS2.p3.31.m3.1.1.3.3.2.2.cmml" xref="S3.SS2.p3.31.m3.1.1.3.3.2.2">𝑆</ci><cn id="S3.SS2.p3.31.m3.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS2.p3.31.m3.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS2.p3.31.m3.1.1.3.3.3.cmml" xref="S3.SS2.p3.31.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.31.m3.1c">I^{r}\in\mathrm{N}^{S^{2}\times k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.31.m3.1d">italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ∈ roman_N start_POSTSUPERSCRIPT italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> through the use of the <math alttext="topk" class="ltx_Math" display="inline" id="S3.SS2.p3.32.m4.1"><semantics id="S3.SS2.p3.32.m4.1a"><mrow id="S3.SS2.p3.32.m4.1.1" xref="S3.SS2.p3.32.m4.1.1.cmml"><mi id="S3.SS2.p3.32.m4.1.1.2" xref="S3.SS2.p3.32.m4.1.1.2.cmml">t</mi><mo id="S3.SS2.p3.32.m4.1.1.1" xref="S3.SS2.p3.32.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.32.m4.1.1.3" xref="S3.SS2.p3.32.m4.1.1.3.cmml">o</mi><mo id="S3.SS2.p3.32.m4.1.1.1a" xref="S3.SS2.p3.32.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.32.m4.1.1.4" xref="S3.SS2.p3.32.m4.1.1.4.cmml">p</mi><mo id="S3.SS2.p3.32.m4.1.1.1b" xref="S3.SS2.p3.32.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.32.m4.1.1.5" xref="S3.SS2.p3.32.m4.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.32.m4.1b"><apply id="S3.SS2.p3.32.m4.1.1.cmml" xref="S3.SS2.p3.32.m4.1.1"><times id="S3.SS2.p3.32.m4.1.1.1.cmml" xref="S3.SS2.p3.32.m4.1.1.1"></times><ci id="S3.SS2.p3.32.m4.1.1.2.cmml" xref="S3.SS2.p3.32.m4.1.1.2">𝑡</ci><ci id="S3.SS2.p3.32.m4.1.1.3.cmml" xref="S3.SS2.p3.32.m4.1.1.3">𝑜</ci><ci id="S3.SS2.p3.32.m4.1.1.4.cmml" xref="S3.SS2.p3.32.m4.1.1.4">𝑝</ci><ci id="S3.SS2.p3.32.m4.1.1.5.cmml" xref="S3.SS2.p3.32.m4.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.32.m4.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.32.m4.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> operator:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="I^{r}=topk(A^{r})." class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><msup id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.3.2.cmml">I</mi><mi id="S3.E10.m1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.cmml">r</mi></msup><mo id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml">t</mi><mo id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E10.m1.1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.1.4.cmml">o</mi><mo id="S3.E10.m1.1.1.1.1.1.2a" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E10.m1.1.1.1.1.1.5" xref="S3.E10.m1.1.1.1.1.1.5.cmml">p</mi><mo id="S3.E10.m1.1.1.1.1.1.2b" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E10.m1.1.1.1.1.1.6" xref="S3.E10.m1.1.1.1.1.1.6.cmml">k</mi><mo id="S3.E10.m1.1.1.1.1.1.2c" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml">A</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml">r</mi></msup><mo id="S3.E10.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" lspace="0em" xref="S3.E10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></eq><apply id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2">𝐼</ci><ci id="S3.E10.m1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3">𝑟</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3">𝑡</ci><ci id="S3.E10.m1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.1.4">𝑜</ci><ci id="S3.E10.m1.1.1.1.1.1.5.cmml" xref="S3.E10.m1.1.1.1.1.1.5">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.1.6.cmml" xref="S3.E10.m1.1.1.1.1.1.6">𝑘</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2">𝐴</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">I^{r}=topk(A^{r}).</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT = italic_t italic_o italic_p italic_k ( italic_A start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.36"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.36.1">Bi-level token to deformable-level token attention.</span>
Utilizing the region routing matrix <math alttext="I^{r}" class="ltx_Math" display="inline" id="S3.SS2.p3.33.m1.1"><semantics id="S3.SS2.p3.33.m1.1a"><msup id="S3.SS2.p3.33.m1.1.1" xref="S3.SS2.p3.33.m1.1.1.cmml"><mi id="S3.SS2.p3.33.m1.1.1.2" xref="S3.SS2.p3.33.m1.1.1.2.cmml">I</mi><mi id="S3.SS2.p3.33.m1.1.1.3" xref="S3.SS2.p3.33.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.33.m1.1b"><apply id="S3.SS2.p3.33.m1.1.1.cmml" xref="S3.SS2.p3.33.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.33.m1.1.1.1.cmml" xref="S3.SS2.p3.33.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.33.m1.1.1.2.cmml" xref="S3.SS2.p3.33.m1.1.1.2">𝐼</ci><ci id="S3.SS2.p3.33.m1.1.1.3.cmml" xref="S3.SS2.p3.33.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.33.m1.1c">I^{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.33.m1.1d">italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT</annotation></semantics></math>, we can then apply token attention. For each deformable query token within region <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p3.34.m2.1"><semantics id="S3.SS2.p3.34.m2.1a"><mi id="S3.SS2.p3.34.m2.1.1" xref="S3.SS2.p3.34.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.34.m2.1b"><ci id="S3.SS2.p3.34.m2.1.1.cmml" xref="S3.SS2.p3.34.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.34.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.34.m2.1d">italic_i</annotation></semantics></math>, its attention spans all key-value pairs located in the <math alttext="topk" class="ltx_Math" display="inline" id="S3.SS2.p3.35.m3.1"><semantics id="S3.SS2.p3.35.m3.1a"><mrow id="S3.SS2.p3.35.m3.1.1" xref="S3.SS2.p3.35.m3.1.1.cmml"><mi id="S3.SS2.p3.35.m3.1.1.2" xref="S3.SS2.p3.35.m3.1.1.2.cmml">t</mi><mo id="S3.SS2.p3.35.m3.1.1.1" xref="S3.SS2.p3.35.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.35.m3.1.1.3" xref="S3.SS2.p3.35.m3.1.1.3.cmml">o</mi><mo id="S3.SS2.p3.35.m3.1.1.1a" xref="S3.SS2.p3.35.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.35.m3.1.1.4" xref="S3.SS2.p3.35.m3.1.1.4.cmml">p</mi><mo id="S3.SS2.p3.35.m3.1.1.1b" xref="S3.SS2.p3.35.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p3.35.m3.1.1.5" xref="S3.SS2.p3.35.m3.1.1.5.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.35.m3.1b"><apply id="S3.SS2.p3.35.m3.1.1.cmml" xref="S3.SS2.p3.35.m3.1.1"><times id="S3.SS2.p3.35.m3.1.1.1.cmml" xref="S3.SS2.p3.35.m3.1.1.1"></times><ci id="S3.SS2.p3.35.m3.1.1.2.cmml" xref="S3.SS2.p3.35.m3.1.1.2">𝑡</ci><ci id="S3.SS2.p3.35.m3.1.1.3.cmml" xref="S3.SS2.p3.35.m3.1.1.3">𝑜</ci><ci id="S3.SS2.p3.35.m3.1.1.4.cmml" xref="S3.SS2.p3.35.m3.1.1.4">𝑝</ci><ci id="S3.SS2.p3.35.m3.1.1.5.cmml" xref="S3.SS2.p3.35.m3.1.1.5">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.35.m3.1c">topk</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.35.m3.1d">italic_t italic_o italic_p italic_k</annotation></semantics></math> routed regions, that is, those indexed by <math alttext="I^{r}_{i,1},I^{r}_{i,2},...,I^{r}_{i,k}" class="ltx_Math" display="inline" id="S3.SS2.p3.36.m4.10"><semantics id="S3.SS2.p3.36.m4.10a"><mrow id="S3.SS2.p3.36.m4.10.10.3" xref="S3.SS2.p3.36.m4.10.10.4.cmml"><msubsup id="S3.SS2.p3.36.m4.8.8.1.1" xref="S3.SS2.p3.36.m4.8.8.1.1.cmml"><mi id="S3.SS2.p3.36.m4.8.8.1.1.2.2" xref="S3.SS2.p3.36.m4.8.8.1.1.2.2.cmml">I</mi><mrow id="S3.SS2.p3.36.m4.2.2.2.4" xref="S3.SS2.p3.36.m4.2.2.2.3.cmml"><mi id="S3.SS2.p3.36.m4.1.1.1.1" xref="S3.SS2.p3.36.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.36.m4.2.2.2.4.1" xref="S3.SS2.p3.36.m4.2.2.2.3.cmml">,</mo><mn id="S3.SS2.p3.36.m4.2.2.2.2" xref="S3.SS2.p3.36.m4.2.2.2.2.cmml">1</mn></mrow><mi id="S3.SS2.p3.36.m4.8.8.1.1.2.3" xref="S3.SS2.p3.36.m4.8.8.1.1.2.3.cmml">r</mi></msubsup><mo id="S3.SS2.p3.36.m4.10.10.3.4" xref="S3.SS2.p3.36.m4.10.10.4.cmml">,</mo><msubsup id="S3.SS2.p3.36.m4.9.9.2.2" xref="S3.SS2.p3.36.m4.9.9.2.2.cmml"><mi id="S3.SS2.p3.36.m4.9.9.2.2.2.2" xref="S3.SS2.p3.36.m4.9.9.2.2.2.2.cmml">I</mi><mrow id="S3.SS2.p3.36.m4.4.4.2.4" xref="S3.SS2.p3.36.m4.4.4.2.3.cmml"><mi id="S3.SS2.p3.36.m4.3.3.1.1" xref="S3.SS2.p3.36.m4.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p3.36.m4.4.4.2.4.1" xref="S3.SS2.p3.36.m4.4.4.2.3.cmml">,</mo><mn id="S3.SS2.p3.36.m4.4.4.2.2" xref="S3.SS2.p3.36.m4.4.4.2.2.cmml">2</mn></mrow><mi id="S3.SS2.p3.36.m4.9.9.2.2.2.3" xref="S3.SS2.p3.36.m4.9.9.2.2.2.3.cmml">r</mi></msubsup><mo id="S3.SS2.p3.36.m4.10.10.3.5" xref="S3.SS2.p3.36.m4.10.10.4.cmml">,</mo><mi id="S3.SS2.p3.36.m4.7.7" mathvariant="normal" xref="S3.SS2.p3.36.m4.7.7.cmml">…</mi><mo id="S3.SS2.p3.36.m4.10.10.3.6" xref="S3.SS2.p3.36.m4.10.10.4.cmml">,</mo><msubsup id="S3.SS2.p3.36.m4.10.10.3.3" xref="S3.SS2.p3.36.m4.10.10.3.3.cmml"><mi id="S3.SS2.p3.36.m4.10.10.3.3.2.2" xref="S3.SS2.p3.36.m4.10.10.3.3.2.2.cmml">I</mi><mrow id="S3.SS2.p3.36.m4.6.6.2.4" xref="S3.SS2.p3.36.m4.6.6.2.3.cmml"><mi id="S3.SS2.p3.36.m4.5.5.1.1" xref="S3.SS2.p3.36.m4.5.5.1.1.cmml">i</mi><mo id="S3.SS2.p3.36.m4.6.6.2.4.1" xref="S3.SS2.p3.36.m4.6.6.2.3.cmml">,</mo><mi id="S3.SS2.p3.36.m4.6.6.2.2" xref="S3.SS2.p3.36.m4.6.6.2.2.cmml">k</mi></mrow><mi id="S3.SS2.p3.36.m4.10.10.3.3.2.3" xref="S3.SS2.p3.36.m4.10.10.3.3.2.3.cmml">r</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.36.m4.10b"><list id="S3.SS2.p3.36.m4.10.10.4.cmml" xref="S3.SS2.p3.36.m4.10.10.3"><apply id="S3.SS2.p3.36.m4.8.8.1.1.cmml" xref="S3.SS2.p3.36.m4.8.8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.36.m4.8.8.1.1.1.cmml" xref="S3.SS2.p3.36.m4.8.8.1.1">subscript</csymbol><apply id="S3.SS2.p3.36.m4.8.8.1.1.2.cmml" xref="S3.SS2.p3.36.m4.8.8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.36.m4.8.8.1.1.2.1.cmml" xref="S3.SS2.p3.36.m4.8.8.1.1">superscript</csymbol><ci id="S3.SS2.p3.36.m4.8.8.1.1.2.2.cmml" xref="S3.SS2.p3.36.m4.8.8.1.1.2.2">𝐼</ci><ci id="S3.SS2.p3.36.m4.8.8.1.1.2.3.cmml" xref="S3.SS2.p3.36.m4.8.8.1.1.2.3">𝑟</ci></apply><list id="S3.SS2.p3.36.m4.2.2.2.3.cmml" xref="S3.SS2.p3.36.m4.2.2.2.4"><ci id="S3.SS2.p3.36.m4.1.1.1.1.cmml" xref="S3.SS2.p3.36.m4.1.1.1.1">𝑖</ci><cn id="S3.SS2.p3.36.m4.2.2.2.2.cmml" type="integer" xref="S3.SS2.p3.36.m4.2.2.2.2">1</cn></list></apply><apply id="S3.SS2.p3.36.m4.9.9.2.2.cmml" xref="S3.SS2.p3.36.m4.9.9.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.36.m4.9.9.2.2.1.cmml" xref="S3.SS2.p3.36.m4.9.9.2.2">subscript</csymbol><apply id="S3.SS2.p3.36.m4.9.9.2.2.2.cmml" xref="S3.SS2.p3.36.m4.9.9.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.36.m4.9.9.2.2.2.1.cmml" xref="S3.SS2.p3.36.m4.9.9.2.2">superscript</csymbol><ci id="S3.SS2.p3.36.m4.9.9.2.2.2.2.cmml" xref="S3.SS2.p3.36.m4.9.9.2.2.2.2">𝐼</ci><ci id="S3.SS2.p3.36.m4.9.9.2.2.2.3.cmml" xref="S3.SS2.p3.36.m4.9.9.2.2.2.3">𝑟</ci></apply><list id="S3.SS2.p3.36.m4.4.4.2.3.cmml" xref="S3.SS2.p3.36.m4.4.4.2.4"><ci id="S3.SS2.p3.36.m4.3.3.1.1.cmml" xref="S3.SS2.p3.36.m4.3.3.1.1">𝑖</ci><cn id="S3.SS2.p3.36.m4.4.4.2.2.cmml" type="integer" xref="S3.SS2.p3.36.m4.4.4.2.2">2</cn></list></apply><ci id="S3.SS2.p3.36.m4.7.7.cmml" xref="S3.SS2.p3.36.m4.7.7">…</ci><apply id="S3.SS2.p3.36.m4.10.10.3.3.cmml" xref="S3.SS2.p3.36.m4.10.10.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.36.m4.10.10.3.3.1.cmml" xref="S3.SS2.p3.36.m4.10.10.3.3">subscript</csymbol><apply id="S3.SS2.p3.36.m4.10.10.3.3.2.cmml" xref="S3.SS2.p3.36.m4.10.10.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.36.m4.10.10.3.3.2.1.cmml" xref="S3.SS2.p3.36.m4.10.10.3.3">superscript</csymbol><ci id="S3.SS2.p3.36.m4.10.10.3.3.2.2.cmml" xref="S3.SS2.p3.36.m4.10.10.3.3.2.2">𝐼</ci><ci id="S3.SS2.p3.36.m4.10.10.3.3.2.3.cmml" xref="S3.SS2.p3.36.m4.10.10.3.3.2.3">𝑟</ci></apply><list id="S3.SS2.p3.36.m4.6.6.2.3.cmml" xref="S3.SS2.p3.36.m4.6.6.2.4"><ci id="S3.SS2.p3.36.m4.5.5.1.1.cmml" xref="S3.SS2.p3.36.m4.5.5.1.1">𝑖</ci><ci id="S3.SS2.p3.36.m4.6.6.2.2.cmml" xref="S3.SS2.p3.36.m4.6.6.2.2">𝑘</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.36.m4.10c">I^{r}_{i,1},I^{r}_{i,2},...,I^{r}_{i,k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.36.m4.10d">italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , 1 end_POSTSUBSCRIPT , italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , 2 end_POSTSUBSCRIPT , … , italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. Hence, we continue the process of gathering the key and value:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{k}^{g}=gather(\hat{k},I^{r}),\hat{v}^{g}=gather(\hat{v},I^{r})," class="ltx_Math" display="block" id="S3.E11.m1.3"><semantics id="S3.E11.m1.3a"><mrow id="S3.E11.m1.3.3.1"><mrow id="S3.E11.m1.3.3.1.1.2" xref="S3.E11.m1.3.3.1.1.3.cmml"><mrow id="S3.E11.m1.3.3.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.cmml"><msup id="S3.E11.m1.3.3.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.3.cmml"><mover accent="true" id="S3.E11.m1.3.3.1.1.1.1.3.2" xref="S3.E11.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.3.2.2" xref="S3.E11.m1.3.3.1.1.1.1.3.2.2.cmml">k</mi><mo id="S3.E11.m1.3.3.1.1.1.1.3.2.1" xref="S3.E11.m1.3.3.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.3.3.1.1.1.1.3.3" xref="S3.E11.m1.3.3.1.1.1.1.3.3.cmml">g</mi></msup><mo id="S3.E11.m1.3.3.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.3.cmml">g</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.1.1.1.4" xref="S3.E11.m1.3.3.1.1.1.1.1.4.cmml">a</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.2a" xref="S3.E11.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.1.1.1.5" xref="S3.E11.m1.3.3.1.1.1.1.1.5.cmml">t</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.2b" xref="S3.E11.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.1.1.1.6" xref="S3.E11.m1.3.3.1.1.1.1.1.6.cmml">h</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.2c" xref="S3.E11.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.1.1.1.7" xref="S3.E11.m1.3.3.1.1.1.1.1.7.cmml">e</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.2d" xref="S3.E11.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.1.1.1.8" xref="S3.E11.m1.3.3.1.1.1.1.1.8.cmml">r</mi><mo id="S3.E11.m1.3.3.1.1.1.1.1.2e" xref="S3.E11.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mover accent="true" id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml"><mi id="S3.E11.m1.1.1.2" xref="S3.E11.m1.1.1.2.cmml">k</mi><mo id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><msup id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">I</mi><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">r</mi></msup><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11.m1.3.3.1.1.2.3" xref="S3.E11.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E11.m1.3.3.1.1.2.2" xref="S3.E11.m1.3.3.1.1.2.2.cmml"><msup id="S3.E11.m1.3.3.1.1.2.2.3" xref="S3.E11.m1.3.3.1.1.2.2.3.cmml"><mover accent="true" id="S3.E11.m1.3.3.1.1.2.2.3.2" xref="S3.E11.m1.3.3.1.1.2.2.3.2.cmml"><mi id="S3.E11.m1.3.3.1.1.2.2.3.2.2" xref="S3.E11.m1.3.3.1.1.2.2.3.2.2.cmml">v</mi><mo id="S3.E11.m1.3.3.1.1.2.2.3.2.1" xref="S3.E11.m1.3.3.1.1.2.2.3.2.1.cmml">^</mo></mover><mi id="S3.E11.m1.3.3.1.1.2.2.3.3" xref="S3.E11.m1.3.3.1.1.2.2.3.3.cmml">g</mi></msup><mo id="S3.E11.m1.3.3.1.1.2.2.2" xref="S3.E11.m1.3.3.1.1.2.2.2.cmml">=</mo><mrow id="S3.E11.m1.3.3.1.1.2.2.1" xref="S3.E11.m1.3.3.1.1.2.2.1.cmml"><mi id="S3.E11.m1.3.3.1.1.2.2.1.3" xref="S3.E11.m1.3.3.1.1.2.2.1.3.cmml">g</mi><mo id="S3.E11.m1.3.3.1.1.2.2.1.2" xref="S3.E11.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.2.2.1.4" xref="S3.E11.m1.3.3.1.1.2.2.1.4.cmml">a</mi><mo id="S3.E11.m1.3.3.1.1.2.2.1.2a" xref="S3.E11.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.2.2.1.5" xref="S3.E11.m1.3.3.1.1.2.2.1.5.cmml">t</mi><mo id="S3.E11.m1.3.3.1.1.2.2.1.2b" xref="S3.E11.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.2.2.1.6" xref="S3.E11.m1.3.3.1.1.2.2.1.6.cmml">h</mi><mo id="S3.E11.m1.3.3.1.1.2.2.1.2c" xref="S3.E11.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.2.2.1.7" xref="S3.E11.m1.3.3.1.1.2.2.1.7.cmml">e</mi><mo id="S3.E11.m1.3.3.1.1.2.2.1.2d" xref="S3.E11.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mi id="S3.E11.m1.3.3.1.1.2.2.1.8" xref="S3.E11.m1.3.3.1.1.2.2.1.8.cmml">r</mi><mo id="S3.E11.m1.3.3.1.1.2.2.1.2e" xref="S3.E11.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.3.3.1.1.2.2.1.1.1" xref="S3.E11.m1.3.3.1.1.2.2.1.1.2.cmml"><mo id="S3.E11.m1.3.3.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E11.m1.3.3.1.1.2.2.1.1.2.cmml">(</mo><mover accent="true" id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml"><mi id="S3.E11.m1.2.2.2" xref="S3.E11.m1.2.2.2.cmml">v</mi><mo id="S3.E11.m1.2.2.1" xref="S3.E11.m1.2.2.1.cmml">^</mo></mover><mo id="S3.E11.m1.3.3.1.1.2.2.1.1.1.3" xref="S3.E11.m1.3.3.1.1.2.2.1.1.2.cmml">,</mo><msup id="S3.E11.m1.3.3.1.1.2.2.1.1.1.1" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.2.cmml">I</mi><mi id="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.3.cmml">r</mi></msup><mo id="S3.E11.m1.3.3.1.1.2.2.1.1.1.4" stretchy="false" xref="S3.E11.m1.3.3.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.3b"><apply id="S3.E11.m1.3.3.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.3a.cmml" xref="S3.E11.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E11.m1.3.3.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1"><eq id="S3.E11.m1.3.3.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.2"></eq><apply id="S3.E11.m1.3.3.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3">superscript</csymbol><apply id="S3.E11.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2"><ci id="S3.E11.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2.1">^</ci><ci id="S3.E11.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2.2">𝑘</ci></apply><ci id="S3.E11.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3">𝑔</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1"><times id="S3.E11.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.E11.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.3">𝑔</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.4">𝑎</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.5.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.5">𝑡</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.6.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.6">ℎ</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.7.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.7">𝑒</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.8.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.8">𝑟</ci><interval closure="open" id="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1"><apply id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1"><ci id="S3.E11.m1.1.1.1.cmml" xref="S3.E11.m1.1.1.1">^</ci><ci id="S3.E11.m1.1.1.2.cmml" xref="S3.E11.m1.1.1.2">𝑘</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.2">𝐼</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></interval></apply></apply><apply id="S3.E11.m1.3.3.1.1.2.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2"><eq id="S3.E11.m1.3.3.1.1.2.2.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2.2"></eq><apply id="S3.E11.m1.3.3.1.1.2.2.3.cmml" xref="S3.E11.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E11.m1.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E11.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2.3.2"><ci id="S3.E11.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E11.m1.3.3.1.1.2.2.3.2.1">^</ci><ci id="S3.E11.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2.3.2.2">𝑣</ci></apply><ci id="S3.E11.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E11.m1.3.3.1.1.2.2.3.3">𝑔</ci></apply><apply id="S3.E11.m1.3.3.1.1.2.2.1.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1"><times id="S3.E11.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.2"></times><ci id="S3.E11.m1.3.3.1.1.2.2.1.3.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.3">𝑔</ci><ci id="S3.E11.m1.3.3.1.1.2.2.1.4.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.4">𝑎</ci><ci id="S3.E11.m1.3.3.1.1.2.2.1.5.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.5">𝑡</ci><ci id="S3.E11.m1.3.3.1.1.2.2.1.6.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.6">ℎ</ci><ci id="S3.E11.m1.3.3.1.1.2.2.1.7.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.7">𝑒</ci><ci id="S3.E11.m1.3.3.1.1.2.2.1.8.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.8">𝑟</ci><interval closure="open" id="S3.E11.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1"><apply id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2"><ci id="S3.E11.m1.2.2.1.cmml" xref="S3.E11.m1.2.2.1">^</ci><ci id="S3.E11.m1.2.2.2.cmml" xref="S3.E11.m1.2.2.2">𝑣</ci></apply><apply id="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.2">𝐼</ci><ci id="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.2.2.1.1.1.1.3">𝑟</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.3c">\hat{k}^{g}=gather(\hat{k},I^{r}),\hat{v}^{g}=gather(\hat{v},I^{r}),</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.3d">over^ start_ARG italic_k end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT = italic_g italic_a italic_t italic_h italic_e italic_r ( over^ start_ARG italic_k end_ARG , italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) , over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT = italic_g italic_a italic_t italic_h italic_e italic_r ( over^ start_ARG italic_v end_ARG , italic_I start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.38">where <math alttext="\hat{k}^{g},\hat{v}^{g}\in\mathrm{R}^{S^{2}\times\frac{kHW}{S^{2}}\times C}" class="ltx_Math" display="inline" id="S3.SS2.p3.37.m1.2"><semantics id="S3.SS2.p3.37.m1.2a"><mrow id="S3.SS2.p3.37.m1.2.2" xref="S3.SS2.p3.37.m1.2.2.cmml"><mrow id="S3.SS2.p3.37.m1.2.2.2.2" xref="S3.SS2.p3.37.m1.2.2.2.3.cmml"><msup id="S3.SS2.p3.37.m1.1.1.1.1.1" xref="S3.SS2.p3.37.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p3.37.m1.1.1.1.1.1.2" xref="S3.SS2.p3.37.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p3.37.m1.1.1.1.1.1.2.2" xref="S3.SS2.p3.37.m1.1.1.1.1.1.2.2.cmml">k</mi><mo id="S3.SS2.p3.37.m1.1.1.1.1.1.2.1" xref="S3.SS2.p3.37.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.37.m1.1.1.1.1.1.3" xref="S3.SS2.p3.37.m1.1.1.1.1.1.3.cmml">g</mi></msup><mo id="S3.SS2.p3.37.m1.2.2.2.2.3" xref="S3.SS2.p3.37.m1.2.2.2.3.cmml">,</mo><msup id="S3.SS2.p3.37.m1.2.2.2.2.2" xref="S3.SS2.p3.37.m1.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p3.37.m1.2.2.2.2.2.2" xref="S3.SS2.p3.37.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.37.m1.2.2.2.2.2.2.2" xref="S3.SS2.p3.37.m1.2.2.2.2.2.2.2.cmml">v</mi><mo id="S3.SS2.p3.37.m1.2.2.2.2.2.2.1" xref="S3.SS2.p3.37.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.37.m1.2.2.2.2.2.3" xref="S3.SS2.p3.37.m1.2.2.2.2.2.3.cmml">g</mi></msup></mrow><mo id="S3.SS2.p3.37.m1.2.2.3" xref="S3.SS2.p3.37.m1.2.2.3.cmml">∈</mo><msup id="S3.SS2.p3.37.m1.2.2.4" xref="S3.SS2.p3.37.m1.2.2.4.cmml"><mi id="S3.SS2.p3.37.m1.2.2.4.2" mathvariant="normal" xref="S3.SS2.p3.37.m1.2.2.4.2.cmml">R</mi><mrow id="S3.SS2.p3.37.m1.2.2.4.3" xref="S3.SS2.p3.37.m1.2.2.4.3.cmml"><msup id="S3.SS2.p3.37.m1.2.2.4.3.2" xref="S3.SS2.p3.37.m1.2.2.4.3.2.cmml"><mi id="S3.SS2.p3.37.m1.2.2.4.3.2.2" xref="S3.SS2.p3.37.m1.2.2.4.3.2.2.cmml">S</mi><mn id="S3.SS2.p3.37.m1.2.2.4.3.2.3" xref="S3.SS2.p3.37.m1.2.2.4.3.2.3.cmml">2</mn></msup><mo id="S3.SS2.p3.37.m1.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.37.m1.2.2.4.3.1.cmml">×</mo><mfrac id="S3.SS2.p3.37.m1.2.2.4.3.3" xref="S3.SS2.p3.37.m1.2.2.4.3.3.cmml"><mrow id="S3.SS2.p3.37.m1.2.2.4.3.3.2" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.cmml"><mi id="S3.SS2.p3.37.m1.2.2.4.3.3.2.2" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.2.cmml">k</mi><mo id="S3.SS2.p3.37.m1.2.2.4.3.3.2.1" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.37.m1.2.2.4.3.3.2.3" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.3.cmml">H</mi><mo id="S3.SS2.p3.37.m1.2.2.4.3.3.2.1a" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.37.m1.2.2.4.3.3.2.4" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.4.cmml">W</mi></mrow><msup id="S3.SS2.p3.37.m1.2.2.4.3.3.3" xref="S3.SS2.p3.37.m1.2.2.4.3.3.3.cmml"><mi id="S3.SS2.p3.37.m1.2.2.4.3.3.3.2" xref="S3.SS2.p3.37.m1.2.2.4.3.3.3.2.cmml">S</mi><mn id="S3.SS2.p3.37.m1.2.2.4.3.3.3.3" xref="S3.SS2.p3.37.m1.2.2.4.3.3.3.3.cmml">2</mn></msup></mfrac><mo id="S3.SS2.p3.37.m1.2.2.4.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.37.m1.2.2.4.3.1.cmml">×</mo><mi id="S3.SS2.p3.37.m1.2.2.4.3.4" xref="S3.SS2.p3.37.m1.2.2.4.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.37.m1.2b"><apply id="S3.SS2.p3.37.m1.2.2.cmml" xref="S3.SS2.p3.37.m1.2.2"><in id="S3.SS2.p3.37.m1.2.2.3.cmml" xref="S3.SS2.p3.37.m1.2.2.3"></in><list id="S3.SS2.p3.37.m1.2.2.2.3.cmml" xref="S3.SS2.p3.37.m1.2.2.2.2"><apply id="S3.SS2.p3.37.m1.1.1.1.1.1.cmml" xref="S3.SS2.p3.37.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.37.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.37.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p3.37.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.37.m1.1.1.1.1.1.2"><ci id="S3.SS2.p3.37.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.37.m1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS2.p3.37.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.37.m1.1.1.1.1.1.2.2">𝑘</ci></apply><ci id="S3.SS2.p3.37.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.37.m1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.SS2.p3.37.m1.2.2.2.2.2.cmml" xref="S3.SS2.p3.37.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.37.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.37.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p3.37.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.37.m1.2.2.2.2.2.2"><ci id="S3.SS2.p3.37.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.37.m1.2.2.2.2.2.2.1">^</ci><ci id="S3.SS2.p3.37.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.37.m1.2.2.2.2.2.2.2">𝑣</ci></apply><ci id="S3.SS2.p3.37.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.37.m1.2.2.2.2.2.3">𝑔</ci></apply></list><apply id="S3.SS2.p3.37.m1.2.2.4.cmml" xref="S3.SS2.p3.37.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p3.37.m1.2.2.4.1.cmml" xref="S3.SS2.p3.37.m1.2.2.4">superscript</csymbol><ci id="S3.SS2.p3.37.m1.2.2.4.2.cmml" xref="S3.SS2.p3.37.m1.2.2.4.2">R</ci><apply id="S3.SS2.p3.37.m1.2.2.4.3.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3"><times id="S3.SS2.p3.37.m1.2.2.4.3.1.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.1"></times><apply id="S3.SS2.p3.37.m1.2.2.4.3.2.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.37.m1.2.2.4.3.2.1.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.2">superscript</csymbol><ci id="S3.SS2.p3.37.m1.2.2.4.3.2.2.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.2.2">𝑆</ci><cn id="S3.SS2.p3.37.m1.2.2.4.3.2.3.cmml" type="integer" xref="S3.SS2.p3.37.m1.2.2.4.3.2.3">2</cn></apply><apply id="S3.SS2.p3.37.m1.2.2.4.3.3.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3"><divide id="S3.SS2.p3.37.m1.2.2.4.3.3.1.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3"></divide><apply id="S3.SS2.p3.37.m1.2.2.4.3.3.2.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2"><times id="S3.SS2.p3.37.m1.2.2.4.3.3.2.1.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.1"></times><ci id="S3.SS2.p3.37.m1.2.2.4.3.3.2.2.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.2">𝑘</ci><ci id="S3.SS2.p3.37.m1.2.2.4.3.3.2.3.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.3">𝐻</ci><ci id="S3.SS2.p3.37.m1.2.2.4.3.3.2.4.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.2.4">𝑊</ci></apply><apply id="S3.SS2.p3.37.m1.2.2.4.3.3.3.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.37.m1.2.2.4.3.3.3.1.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.3">superscript</csymbol><ci id="S3.SS2.p3.37.m1.2.2.4.3.3.3.2.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.3.3.2">𝑆</ci><cn id="S3.SS2.p3.37.m1.2.2.4.3.3.3.3.cmml" type="integer" xref="S3.SS2.p3.37.m1.2.2.4.3.3.3.3">2</cn></apply></apply><ci id="S3.SS2.p3.37.m1.2.2.4.3.4.cmml" xref="S3.SS2.p3.37.m1.2.2.4.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.37.m1.2c">\hat{k}^{g},\hat{v}^{g}\in\mathrm{R}^{S^{2}\times\frac{kHW}{S^{2}}\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.37.m1.2d">over^ start_ARG italic_k end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT , over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT ∈ roman_R start_POSTSUPERSCRIPT italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × divide start_ARG italic_k italic_H italic_W end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> are the gathered key and value. Then, we apply attention on <math alttext="\hat{k}^{g},\hat{v}^{g}" class="ltx_Math" display="inline" id="S3.SS2.p3.38.m2.2"><semantics id="S3.SS2.p3.38.m2.2a"><mrow id="S3.SS2.p3.38.m2.2.2.2" xref="S3.SS2.p3.38.m2.2.2.3.cmml"><msup id="S3.SS2.p3.38.m2.1.1.1.1" xref="S3.SS2.p3.38.m2.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p3.38.m2.1.1.1.1.2" xref="S3.SS2.p3.38.m2.1.1.1.1.2.cmml"><mi id="S3.SS2.p3.38.m2.1.1.1.1.2.2" xref="S3.SS2.p3.38.m2.1.1.1.1.2.2.cmml">k</mi><mo id="S3.SS2.p3.38.m2.1.1.1.1.2.1" xref="S3.SS2.p3.38.m2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.38.m2.1.1.1.1.3" xref="S3.SS2.p3.38.m2.1.1.1.1.3.cmml">g</mi></msup><mo id="S3.SS2.p3.38.m2.2.2.2.3" xref="S3.SS2.p3.38.m2.2.2.3.cmml">,</mo><msup id="S3.SS2.p3.38.m2.2.2.2.2" xref="S3.SS2.p3.38.m2.2.2.2.2.cmml"><mover accent="true" id="S3.SS2.p3.38.m2.2.2.2.2.2" xref="S3.SS2.p3.38.m2.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.38.m2.2.2.2.2.2.2" xref="S3.SS2.p3.38.m2.2.2.2.2.2.2.cmml">v</mi><mo id="S3.SS2.p3.38.m2.2.2.2.2.2.1" xref="S3.SS2.p3.38.m2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p3.38.m2.2.2.2.2.3" xref="S3.SS2.p3.38.m2.2.2.2.2.3.cmml">g</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.38.m2.2b"><list id="S3.SS2.p3.38.m2.2.2.3.cmml" xref="S3.SS2.p3.38.m2.2.2.2"><apply id="S3.SS2.p3.38.m2.1.1.1.1.cmml" xref="S3.SS2.p3.38.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.38.m2.1.1.1.1.1.cmml" xref="S3.SS2.p3.38.m2.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p3.38.m2.1.1.1.1.2.cmml" xref="S3.SS2.p3.38.m2.1.1.1.1.2"><ci id="S3.SS2.p3.38.m2.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.38.m2.1.1.1.1.2.1">^</ci><ci id="S3.SS2.p3.38.m2.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.38.m2.1.1.1.1.2.2">𝑘</ci></apply><ci id="S3.SS2.p3.38.m2.1.1.1.1.3.cmml" xref="S3.SS2.p3.38.m2.1.1.1.1.3">𝑔</ci></apply><apply id="S3.SS2.p3.38.m2.2.2.2.2.cmml" xref="S3.SS2.p3.38.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.38.m2.2.2.2.2.1.cmml" xref="S3.SS2.p3.38.m2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p3.38.m2.2.2.2.2.2.cmml" xref="S3.SS2.p3.38.m2.2.2.2.2.2"><ci id="S3.SS2.p3.38.m2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.38.m2.2.2.2.2.2.1">^</ci><ci id="S3.SS2.p3.38.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.38.m2.2.2.2.2.2.2">𝑣</ci></apply><ci id="S3.SS2.p3.38.m2.2.2.2.2.3.cmml" xref="S3.SS2.p3.38.m2.2.2.2.2.3">𝑔</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.38.m2.2c">\hat{k}^{g},\hat{v}^{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.38.m2.2d">over^ start_ARG italic_k end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT , over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT</annotation></semantics></math> as:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="S7.EGx3">
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\hat{O}=\hat{x}+W_{o^{\prime}}(Attention(\hat{q},\hat{k}^{g},\hat%
{v}^{g})+LCE(\hat{v}))," class="ltx_Math" display="block" id="S3.E12.m1.3"><semantics id="S3.E12.m1.3a"><mrow id="S3.E12.m1.3.3.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.3" xref="S3.E12.m1.3.3.1.1.3.cmml"><mi id="S3.E12.m1.3.3.1.1.3.2" xref="S3.E12.m1.3.3.1.1.3.2.cmml">O</mi><mo id="S3.E12.m1.3.3.1.1.3.1" xref="S3.E12.m1.3.3.1.1.3.1.cmml">^</mo></mover><mo id="S3.E12.m1.3.3.1.1.2" xref="S3.E12.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.3.3.1.1.1" xref="S3.E12.m1.3.3.1.1.1.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.3.cmml"><mi id="S3.E12.m1.3.3.1.1.1.3.2" xref="S3.E12.m1.3.3.1.1.1.3.2.cmml">x</mi><mo id="S3.E12.m1.3.3.1.1.1.3.1" xref="S3.E12.m1.3.3.1.1.1.3.1.cmml">^</mo></mover><mo id="S3.E12.m1.3.3.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.2.cmml">+</mo><mrow id="S3.E12.m1.3.3.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.cmml"><msub id="S3.E12.m1.3.3.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.3.2" xref="S3.E12.m1.3.3.1.1.1.1.3.2.cmml">W</mi><msup id="S3.E12.m1.3.3.1.1.1.1.3.3" xref="S3.E12.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.3.3.2" xref="S3.E12.m1.3.3.1.1.1.1.3.3.2.cmml">o</mi><mo id="S3.E12.m1.3.3.1.1.1.1.3.3.3" xref="S3.E12.m1.3.3.1.1.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S3.E12.m1.3.3.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.4" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.4.cmml">A</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.5" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.5.cmml">t</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3a" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.6" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.6.cmml">t</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3b" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.7" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.7.cmml">e</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3c" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.8" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.8.cmml">n</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3d" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.9" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.9.cmml">t</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3e" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.10" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.10.cmml">i</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3f" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.11" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.11.cmml">o</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3g" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.12" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.12.cmml">n</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3h" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><mover accent="true" id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mi id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">q</mi><mo id="S3.E12.m1.1.1.1" xref="S3.E12.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">k</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msup><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.5" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">v</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml">g</mi></msup><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.6" stretchy="false" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.2.cmml">L</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.3.cmml">C</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1a" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.4" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.4.cmml">E</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1b" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.5.2" xref="S3.E12.m1.2.2.cmml"><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.5.2.1" stretchy="false" xref="S3.E12.m1.2.2.cmml">(</mo><mover accent="true" id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml"><mi id="S3.E12.m1.2.2.2" xref="S3.E12.m1.2.2.2.cmml">v</mi><mo id="S3.E12.m1.2.2.1" xref="S3.E12.m1.2.2.1.cmml">^</mo></mover><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.5.2.2" stretchy="false" xref="S3.E12.m1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E12.m1.3.3.1.2" xref="S3.E12.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.3b"><apply id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1"><eq id="S3.E12.m1.3.3.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2"></eq><apply id="S3.E12.m1.3.3.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.3"><ci id="S3.E12.m1.3.3.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.3.1">^</ci><ci id="S3.E12.m1.3.3.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2">𝑂</ci></apply><apply id="S3.E12.m1.3.3.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1"><plus id="S3.E12.m1.3.3.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.2"></plus><apply id="S3.E12.m1.3.3.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.3"><ci id="S3.E12.m1.3.3.1.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.1.3.1">^</ci><ci id="S3.E12.m1.3.3.1.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.1.3.2">𝑥</ci></apply><apply id="S3.E12.m1.3.3.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1"><times id="S3.E12.m1.3.3.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.2"></times><apply id="S3.E12.m1.3.3.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3.2">𝑊</ci><apply id="S3.E12.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3.3.2">𝑜</ci><ci id="S3.E12.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.3.3.3">′</ci></apply></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1"><plus id="S3.E12.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.3"></plus><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2"><times id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.3"></times><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.4">𝐴</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.5.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.5">𝑡</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.6.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.6">𝑡</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.7.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.7">𝑒</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.8.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.8">𝑛</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.9.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.9">𝑡</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.10.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.10">𝑖</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.11.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.11">𝑜</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.12.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.12">𝑛</ci><vector id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2"><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1"><ci id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.1.1.1">^</ci><ci id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2">𝑞</ci></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑘</ci></apply><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2"><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.1">^</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2">𝑣</ci></apply><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3">𝑔</ci></apply></vector></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4"><times id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.1"></times><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.2">𝐿</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.3">𝐶</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.4">𝐸</ci><apply id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.4.5.2"><ci id="S3.E12.m1.2.2.1.cmml" xref="S3.E12.m1.2.2.1">^</ci><ci id="S3.E12.m1.2.2.2.cmml" xref="S3.E12.m1.2.2.2">𝑣</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.3c">\displaystyle\hat{O}=\hat{x}+W_{o^{\prime}}(Attention(\hat{q},\hat{k}^{g},\hat%
{v}^{g})+LCE(\hat{v})),</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.3d">over^ start_ARG italic_O end_ARG = over^ start_ARG italic_x end_ARG + italic_W start_POSTSUBSCRIPT italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( over^ start_ARG italic_q end_ARG , over^ start_ARG italic_k end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT , over^ start_ARG italic_v end_ARG start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT ) + italic_L italic_C italic_E ( over^ start_ARG italic_v end_ARG ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle O=MLP(LN(\hat{O}))+\hat{O}," class="ltx_Math" display="block" id="S3.E13.m1.2"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2.1" xref="S3.E13.m1.2.2.1.1.cmml"><mrow id="S3.E13.m1.2.2.1.1" xref="S3.E13.m1.2.2.1.1.cmml"><mi id="S3.E13.m1.2.2.1.1.3" xref="S3.E13.m1.2.2.1.1.3.cmml">O</mi><mo id="S3.E13.m1.2.2.1.1.2" xref="S3.E13.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E13.m1.2.2.1.1.1" xref="S3.E13.m1.2.2.1.1.1.cmml"><mrow id="S3.E13.m1.2.2.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.3.cmml">M</mi><mo id="S3.E13.m1.2.2.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E13.m1.2.2.1.1.1.1.4" xref="S3.E13.m1.2.2.1.1.1.1.4.cmml">L</mi><mo id="S3.E13.m1.2.2.1.1.1.1.2a" xref="S3.E13.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E13.m1.2.2.1.1.1.1.5" xref="S3.E13.m1.2.2.1.1.1.1.5.cmml">P</mi><mo id="S3.E13.m1.2.2.1.1.1.1.2b" xref="S3.E13.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.3.cmml">N</mi><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1a" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1.1.4.2" xref="S3.E13.m1.1.1.cmml"><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S3.E13.m1.1.1.cmml">(</mo><mover accent="true" id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><mi id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml">O</mi><mo id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S3.E13.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.2.2.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.2.cmml">+</mo><mover accent="true" id="S3.E13.m1.2.2.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.3.2" xref="S3.E13.m1.2.2.1.1.1.3.2.cmml">O</mi><mo id="S3.E13.m1.2.2.1.1.1.3.1" xref="S3.E13.m1.2.2.1.1.1.3.1.cmml">^</mo></mover></mrow></mrow><mo id="S3.E13.m1.2.2.1.2" xref="S3.E13.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.1.1.cmml" xref="S3.E13.m1.2.2.1"><eq id="S3.E13.m1.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.2"></eq><ci id="S3.E13.m1.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3">𝑂</ci><apply id="S3.E13.m1.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1"><plus id="S3.E13.m1.2.2.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.2"></plus><apply id="S3.E13.m1.2.2.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1"><times id="S3.E13.m1.2.2.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.2"></times><ci id="S3.E13.m1.2.2.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.3">𝑀</ci><ci id="S3.E13.m1.2.2.1.1.1.1.4.cmml" xref="S3.E13.m1.2.2.1.1.1.1.4">𝐿</ci><ci id="S3.E13.m1.2.2.1.1.1.1.5.cmml" xref="S3.E13.m1.2.2.1.1.1.1.5">𝑃</ci><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1"><times id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1"></times><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.2">𝐿</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.3">𝑁</ci><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.4.2"><ci id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1.1">^</ci><ci id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2">𝑂</ci></apply></apply></apply><apply id="S3.E13.m1.2.2.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.3"><ci id="S3.E13.m1.2.2.1.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.3.1">^</ci><ci id="S3.E13.m1.2.2.1.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.3.2">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\displaystyle O=MLP(LN(\hat{O}))+\hat{O},</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.2d">italic_O = italic_M italic_L italic_P ( italic_L italic_N ( over^ start_ARG italic_O end_ARG ) ) + over^ start_ARG italic_O end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.42">where <math alttext="W_{o^{\prime}}" class="ltx_Math" display="inline" id="S3.SS2.p3.39.m1.1"><semantics id="S3.SS2.p3.39.m1.1a"><msub id="S3.SS2.p3.39.m1.1.1" xref="S3.SS2.p3.39.m1.1.1.cmml"><mi id="S3.SS2.p3.39.m1.1.1.2" xref="S3.SS2.p3.39.m1.1.1.2.cmml">W</mi><msup id="S3.SS2.p3.39.m1.1.1.3" xref="S3.SS2.p3.39.m1.1.1.3.cmml"><mi id="S3.SS2.p3.39.m1.1.1.3.2" xref="S3.SS2.p3.39.m1.1.1.3.2.cmml">o</mi><mo id="S3.SS2.p3.39.m1.1.1.3.3" xref="S3.SS2.p3.39.m1.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.39.m1.1b"><apply id="S3.SS2.p3.39.m1.1.1.cmml" xref="S3.SS2.p3.39.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.39.m1.1.1.1.cmml" xref="S3.SS2.p3.39.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.39.m1.1.1.2.cmml" xref="S3.SS2.p3.39.m1.1.1.2">𝑊</ci><apply id="S3.SS2.p3.39.m1.1.1.3.cmml" xref="S3.SS2.p3.39.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.39.m1.1.1.3.1.cmml" xref="S3.SS2.p3.39.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.39.m1.1.1.3.2.cmml" xref="S3.SS2.p3.39.m1.1.1.3.2">𝑜</ci><ci id="S3.SS2.p3.39.m1.1.1.3.3.cmml" xref="S3.SS2.p3.39.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.39.m1.1c">W_{o^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.39.m1.1d">italic_W start_POSTSUBSCRIPT italic_o start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is a projection weight for output features, and <math alttext="LCE(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p3.40.m2.1"><semantics id="S3.SS2.p3.40.m2.1a"><mrow id="S3.SS2.p3.40.m2.1.2" xref="S3.SS2.p3.40.m2.1.2.cmml"><mi id="S3.SS2.p3.40.m2.1.2.2" xref="S3.SS2.p3.40.m2.1.2.2.cmml">L</mi><mo id="S3.SS2.p3.40.m2.1.2.1" xref="S3.SS2.p3.40.m2.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.40.m2.1.2.3" xref="S3.SS2.p3.40.m2.1.2.3.cmml">C</mi><mo id="S3.SS2.p3.40.m2.1.2.1a" xref="S3.SS2.p3.40.m2.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.40.m2.1.2.4" xref="S3.SS2.p3.40.m2.1.2.4.cmml">E</mi><mo id="S3.SS2.p3.40.m2.1.2.1b" xref="S3.SS2.p3.40.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p3.40.m2.1.2.5.2" xref="S3.SS2.p3.40.m2.1.2.cmml"><mo id="S3.SS2.p3.40.m2.1.2.5.2.1" stretchy="false" xref="S3.SS2.p3.40.m2.1.2.cmml">(</mo><mo id="S3.SS2.p3.40.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.40.m2.1.1.cmml">⋅</mo><mo id="S3.SS2.p3.40.m2.1.2.5.2.2" stretchy="false" xref="S3.SS2.p3.40.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.40.m2.1b"><apply id="S3.SS2.p3.40.m2.1.2.cmml" xref="S3.SS2.p3.40.m2.1.2"><times id="S3.SS2.p3.40.m2.1.2.1.cmml" xref="S3.SS2.p3.40.m2.1.2.1"></times><ci id="S3.SS2.p3.40.m2.1.2.2.cmml" xref="S3.SS2.p3.40.m2.1.2.2">𝐿</ci><ci id="S3.SS2.p3.40.m2.1.2.3.cmml" xref="S3.SS2.p3.40.m2.1.2.3">𝐶</ci><ci id="S3.SS2.p3.40.m2.1.2.4.cmml" xref="S3.SS2.p3.40.m2.1.2.4">𝐸</ci><ci id="S3.SS2.p3.40.m2.1.1.cmml" xref="S3.SS2.p3.40.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.40.m2.1c">LCE(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.40.m2.1d">italic_L italic_C italic_E ( ⋅ )</annotation></semantics></math> uses a kernel size 5 depth-wise convolution.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.42.1">Deformable-level token to token attention.</span>
Following that, the deformable features that are semantically attended to via <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite> are reshaped <math alttext="O" class="ltx_Math" display="inline" id="S3.SS2.p3.41.m3.1"><semantics id="S3.SS2.p3.41.m3.1a"><mi id="S3.SS2.p3.41.m3.1.1" xref="S3.SS2.p3.41.m3.1.1.cmml">O</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.41.m3.1b"><ci id="S3.SS2.p3.41.m3.1.1.cmml" xref="S3.SS2.p3.41.m3.1.1">𝑂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.41.m3.1c">O</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.41.m3.1d">italic_O</annotation></semantics></math> as <math alttext="O^{r}\in\mathbb{R}^{H_{G}\times W_{G}\times C}" class="ltx_Math" display="inline" id="S3.SS2.p3.42.m4.1"><semantics id="S3.SS2.p3.42.m4.1a"><mrow id="S3.SS2.p3.42.m4.1.1" xref="S3.SS2.p3.42.m4.1.1.cmml"><msup id="S3.SS2.p3.42.m4.1.1.2" xref="S3.SS2.p3.42.m4.1.1.2.cmml"><mi id="S3.SS2.p3.42.m4.1.1.2.2" xref="S3.SS2.p3.42.m4.1.1.2.2.cmml">O</mi><mi id="S3.SS2.p3.42.m4.1.1.2.3" xref="S3.SS2.p3.42.m4.1.1.2.3.cmml">r</mi></msup><mo id="S3.SS2.p3.42.m4.1.1.1" xref="S3.SS2.p3.42.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.42.m4.1.1.3" xref="S3.SS2.p3.42.m4.1.1.3.cmml"><mi id="S3.SS2.p3.42.m4.1.1.3.2" xref="S3.SS2.p3.42.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.42.m4.1.1.3.3" xref="S3.SS2.p3.42.m4.1.1.3.3.cmml"><msub id="S3.SS2.p3.42.m4.1.1.3.3.2" xref="S3.SS2.p3.42.m4.1.1.3.3.2.cmml"><mi id="S3.SS2.p3.42.m4.1.1.3.3.2.2" xref="S3.SS2.p3.42.m4.1.1.3.3.2.2.cmml">H</mi><mi id="S3.SS2.p3.42.m4.1.1.3.3.2.3" xref="S3.SS2.p3.42.m4.1.1.3.3.2.3.cmml">G</mi></msub><mo id="S3.SS2.p3.42.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.42.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p3.42.m4.1.1.3.3.3" xref="S3.SS2.p3.42.m4.1.1.3.3.3.cmml"><mi id="S3.SS2.p3.42.m4.1.1.3.3.3.2" xref="S3.SS2.p3.42.m4.1.1.3.3.3.2.cmml">W</mi><mi id="S3.SS2.p3.42.m4.1.1.3.3.3.3" xref="S3.SS2.p3.42.m4.1.1.3.3.3.3.cmml">G</mi></msub><mo id="S3.SS2.p3.42.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.42.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.42.m4.1.1.3.3.4" xref="S3.SS2.p3.42.m4.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.42.m4.1b"><apply id="S3.SS2.p3.42.m4.1.1.cmml" xref="S3.SS2.p3.42.m4.1.1"><in id="S3.SS2.p3.42.m4.1.1.1.cmml" xref="S3.SS2.p3.42.m4.1.1.1"></in><apply id="S3.SS2.p3.42.m4.1.1.2.cmml" xref="S3.SS2.p3.42.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.42.m4.1.1.2.1.cmml" xref="S3.SS2.p3.42.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.p3.42.m4.1.1.2.2.cmml" xref="S3.SS2.p3.42.m4.1.1.2.2">𝑂</ci><ci id="S3.SS2.p3.42.m4.1.1.2.3.cmml" xref="S3.SS2.p3.42.m4.1.1.2.3">𝑟</ci></apply><apply id="S3.SS2.p3.42.m4.1.1.3.cmml" xref="S3.SS2.p3.42.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.42.m4.1.1.3.1.cmml" xref="S3.SS2.p3.42.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.42.m4.1.1.3.2.cmml" xref="S3.SS2.p3.42.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p3.42.m4.1.1.3.3.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3"><times id="S3.SS2.p3.42.m4.1.1.3.3.1.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.1"></times><apply id="S3.SS2.p3.42.m4.1.1.3.3.2.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.42.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p3.42.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS2.p3.42.m4.1.1.3.3.2.3.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.2.3">𝐺</ci></apply><apply id="S3.SS2.p3.42.m4.1.1.3.3.3.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.42.m4.1.1.3.3.3.1.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.42.m4.1.1.3.3.3.2.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.3.2">𝑊</ci><ci id="S3.SS2.p3.42.m4.1.1.3.3.3.3.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.3.3">𝐺</ci></apply><ci id="S3.SS2.p3.42.m4.1.1.3.3.4.cmml" xref="S3.SS2.p3.42.m4.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.42.m4.1c">O^{r}\in\mathbb{R}^{H_{G}\times W_{G}\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.42.m4.1d">italic_O start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT × italic_W start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> and parameterized at the locations of keys and values:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="k=O^{r}W_{k},v=O^{r}W_{v}," class="ltx_Math" display="block" id="S3.E14.m1.1"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1"><mrow id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.3.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.2.cmml">k</mi><mo id="S3.E14.m1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.3.cmml"><msup id="S3.E14.m1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.2.2" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2.cmml">O</mi><mi id="S3.E14.m1.1.1.1.1.1.1.3.2.3" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3.cmml">r</mi></msup><mo id="S3.E14.m1.1.1.1.1.1.1.3.1" xref="S3.E14.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E14.m1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.3.2" xref="S3.E14.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E14.m1.1.1.1.1.1.1.3.3.3" xref="S3.E14.m1.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E14.m1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E14.m1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.2.2.cmml"><mi id="S3.E14.m1.1.1.1.1.2.2.2" xref="S3.E14.m1.1.1.1.1.2.2.2.cmml">v</mi><mo id="S3.E14.m1.1.1.1.1.2.2.1" xref="S3.E14.m1.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.2.2.3" xref="S3.E14.m1.1.1.1.1.2.2.3.cmml"><msup id="S3.E14.m1.1.1.1.1.2.2.3.2" xref="S3.E14.m1.1.1.1.1.2.2.3.2.cmml"><mi id="S3.E14.m1.1.1.1.1.2.2.3.2.2" xref="S3.E14.m1.1.1.1.1.2.2.3.2.2.cmml">O</mi><mi id="S3.E14.m1.1.1.1.1.2.2.3.2.3" xref="S3.E14.m1.1.1.1.1.2.2.3.2.3.cmml">r</mi></msup><mo id="S3.E14.m1.1.1.1.1.2.2.3.1" xref="S3.E14.m1.1.1.1.1.2.2.3.1.cmml">⁢</mo><msub id="S3.E14.m1.1.1.1.1.2.2.3.3" xref="S3.E14.m1.1.1.1.1.2.2.3.3.cmml"><mi id="S3.E14.m1.1.1.1.1.2.2.3.3.2" xref="S3.E14.m1.1.1.1.1.2.2.3.3.2.cmml">W</mi><mi id="S3.E14.m1.1.1.1.1.2.2.3.3.3" xref="S3.E14.m1.1.1.1.1.2.2.3.3.3.cmml">v</mi></msub></mrow></mrow></mrow><mo id="S3.E14.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"></eq><ci id="S3.E14.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2">𝑘</ci><apply id="S3.E14.m1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3"><times id="S3.E14.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.E14.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2">𝑂</ci><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E14.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E14.m1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2"><eq id="S3.E14.m1.1.1.1.1.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1"></eq><ci id="S3.E14.m1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.2">𝑣</ci><apply id="S3.E14.m1.1.1.1.1.2.2.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3"><times id="S3.E14.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.1"></times><apply id="S3.E14.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.2">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.2.2">𝑂</ci><ci id="S3.E14.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.2.3">𝑟</ci></apply><apply id="S3.E14.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.3.2">𝑊</ci><ci id="S3.E14.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">k=O^{r}W_{k},v=O^{r}W_{v},</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.1d">italic_k = italic_O start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_v = italic_O start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.46"><math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p3.43.m1.1"><semantics id="S3.SS2.p3.43.m1.1a"><mi id="S3.SS2.p3.43.m1.1.1" xref="S3.SS2.p3.43.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.43.m1.1b"><ci id="S3.SS2.p3.43.m1.1.1.cmml" xref="S3.SS2.p3.43.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.43.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.43.m1.1d">italic_k</annotation></semantics></math> and <math alttext="v" class="ltx_Math" display="inline" id="S3.SS2.p3.44.m2.1"><semantics id="S3.SS2.p3.44.m2.1a"><mi id="S3.SS2.p3.44.m2.1.1" xref="S3.SS2.p3.44.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.44.m2.1b"><ci id="S3.SS2.p3.44.m2.1.1.cmml" xref="S3.SS2.p3.44.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.44.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.44.m2.1d">italic_v</annotation></semantics></math> represent the embeddings of semantically deformed keys and values, respectively. Using existing approaches, we perform self-attention on <math alttext="q,k,v" class="ltx_Math" display="inline" id="S3.SS2.p3.45.m3.3"><semantics id="S3.SS2.p3.45.m3.3a"><mrow id="S3.SS2.p3.45.m3.3.4.2" xref="S3.SS2.p3.45.m3.3.4.1.cmml"><mi id="S3.SS2.p3.45.m3.1.1" xref="S3.SS2.p3.45.m3.1.1.cmml">q</mi><mo id="S3.SS2.p3.45.m3.3.4.2.1" xref="S3.SS2.p3.45.m3.3.4.1.cmml">,</mo><mi id="S3.SS2.p3.45.m3.2.2" xref="S3.SS2.p3.45.m3.2.2.cmml">k</mi><mo id="S3.SS2.p3.45.m3.3.4.2.2" xref="S3.SS2.p3.45.m3.3.4.1.cmml">,</mo><mi id="S3.SS2.p3.45.m3.3.3" xref="S3.SS2.p3.45.m3.3.3.cmml">v</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.45.m3.3b"><list id="S3.SS2.p3.45.m3.3.4.1.cmml" xref="S3.SS2.p3.45.m3.3.4.2"><ci id="S3.SS2.p3.45.m3.1.1.cmml" xref="S3.SS2.p3.45.m3.1.1">𝑞</ci><ci id="S3.SS2.p3.45.m3.2.2.cmml" xref="S3.SS2.p3.45.m3.2.2">𝑘</ci><ci id="S3.SS2.p3.45.m3.3.3.cmml" xref="S3.SS2.p3.45.m3.3.3">𝑣</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.45.m3.3c">q,k,v</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.45.m3.3d">italic_q , italic_k , italic_v</annotation></semantics></math>, and relative position offsets <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p3.46.m4.1"><semantics id="S3.SS2.p3.46.m4.1a"><mi id="S3.SS2.p3.46.m4.1.1" xref="S3.SS2.p3.46.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.46.m4.1b"><ci id="S3.SS2.p3.46.m4.1.1.cmml" xref="S3.SS2.p3.46.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.46.m4.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.46.m4.1d">italic_R</annotation></semantics></math>. The output of attention is formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z^{m}=W_{\bar{o}}(\sigma(q^{m}k^{(m)\top}/\sqrt{d}+\phi(\hat{B};R))v^{m})." class="ltx_Math" display="block" id="S3.E15.m1.4"><semantics id="S3.E15.m1.4a"><mrow id="S3.E15.m1.4.4.1" xref="S3.E15.m1.4.4.1.1.cmml"><mrow id="S3.E15.m1.4.4.1.1" xref="S3.E15.m1.4.4.1.1.cmml"><msup id="S3.E15.m1.4.4.1.1.3" xref="S3.E15.m1.4.4.1.1.3.cmml"><mi id="S3.E15.m1.4.4.1.1.3.2" xref="S3.E15.m1.4.4.1.1.3.2.cmml">z</mi><mi id="S3.E15.m1.4.4.1.1.3.3" xref="S3.E15.m1.4.4.1.1.3.3.cmml">m</mi></msup><mo id="S3.E15.m1.4.4.1.1.2" xref="S3.E15.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E15.m1.4.4.1.1.1" xref="S3.E15.m1.4.4.1.1.1.cmml"><msub id="S3.E15.m1.4.4.1.1.1.3" xref="S3.E15.m1.4.4.1.1.1.3.cmml"><mi id="S3.E15.m1.4.4.1.1.1.3.2" xref="S3.E15.m1.4.4.1.1.1.3.2.cmml">W</mi><mover accent="true" id="S3.E15.m1.4.4.1.1.1.3.3" xref="S3.E15.m1.4.4.1.1.1.3.3.cmml"><mi id="S3.E15.m1.4.4.1.1.1.3.3.2" xref="S3.E15.m1.4.4.1.1.1.3.3.2.cmml">o</mi><mo id="S3.E15.m1.4.4.1.1.1.3.3.1" xref="S3.E15.m1.4.4.1.1.1.3.3.1.cmml">¯</mo></mover></msub><mo id="S3.E15.m1.4.4.1.1.1.2" xref="S3.E15.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E15.m1.4.4.1.1.1.1.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E15.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E15.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.4.4.1.1.1.1.1.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.3" xref="S3.E15.m1.4.4.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml"><msup id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">q</mi><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">m</mi></msup><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><msup id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mrow id="S3.E15.m1.1.1.1" xref="S3.E15.m1.1.1.1.cmml"><mrow id="S3.E15.m1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.cmml"><mo id="S3.E15.m1.1.1.1.3.2.1" stretchy="false" xref="S3.E15.m1.1.1.1.cmml">(</mo><mi id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml">m</mi><mo id="S3.E15.m1.1.1.1.3.2.2" stretchy="false" xref="S3.E15.m1.1.1.1.cmml">)</mo></mrow><mo id="S3.E15.m1.1.1.1.4" lspace="0.222em" xref="S3.E15.m1.1.1.1.4.cmml">⊤</mo></mrow></msup></mrow><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">/</mo><msqrt id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml">d</mi></msqrt></mrow><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mover accent="true" id="S3.E15.m1.2.2" xref="S3.E15.m1.2.2.cmml"><mi id="S3.E15.m1.2.2.2" xref="S3.E15.m1.2.2.2.cmml">B</mi><mo id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.cmml">^</mo></mover><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml">;</mo><mi id="S3.E15.m1.3.3" xref="S3.E15.m1.3.3.cmml">R</mi><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E15.m1.4.4.1.1.1.1.1.1.2a" xref="S3.E15.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.E15.m1.4.4.1.1.1.1.1.1.4" xref="S3.E15.m1.4.4.1.1.1.1.1.1.4.cmml"><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.4.2" xref="S3.E15.m1.4.4.1.1.1.1.1.1.4.2.cmml">v</mi><mi id="S3.E15.m1.4.4.1.1.1.1.1.1.4.3" xref="S3.E15.m1.4.4.1.1.1.1.1.1.4.3.cmml">m</mi></msup></mrow><mo id="S3.E15.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E15.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m1.4.4.1.2" lspace="0em" xref="S3.E15.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.4b"><apply id="S3.E15.m1.4.4.1.1.cmml" xref="S3.E15.m1.4.4.1"><eq id="S3.E15.m1.4.4.1.1.2.cmml" xref="S3.E15.m1.4.4.1.1.2"></eq><apply id="S3.E15.m1.4.4.1.1.3.cmml" xref="S3.E15.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.4.4.1.1.3.1.cmml" xref="S3.E15.m1.4.4.1.1.3">superscript</csymbol><ci id="S3.E15.m1.4.4.1.1.3.2.cmml" xref="S3.E15.m1.4.4.1.1.3.2">𝑧</ci><ci id="S3.E15.m1.4.4.1.1.3.3.cmml" xref="S3.E15.m1.4.4.1.1.3.3">𝑚</ci></apply><apply id="S3.E15.m1.4.4.1.1.1.cmml" xref="S3.E15.m1.4.4.1.1.1"><times id="S3.E15.m1.4.4.1.1.1.2.cmml" xref="S3.E15.m1.4.4.1.1.1.2"></times><apply id="S3.E15.m1.4.4.1.1.1.3.cmml" xref="S3.E15.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.4.4.1.1.1.3.1.cmml" xref="S3.E15.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E15.m1.4.4.1.1.1.3.2.cmml" xref="S3.E15.m1.4.4.1.1.1.3.2">𝑊</ci><apply id="S3.E15.m1.4.4.1.1.1.3.3.cmml" xref="S3.E15.m1.4.4.1.1.1.3.3"><ci id="S3.E15.m1.4.4.1.1.1.3.3.1.cmml" xref="S3.E15.m1.4.4.1.1.1.3.3.1">¯</ci><ci id="S3.E15.m1.4.4.1.1.1.3.3.2.cmml" xref="S3.E15.m1.4.4.1.1.1.3.3.2">𝑜</ci></apply></apply><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1"><times id="S3.E15.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.2"></times><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1"><plus id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2"><divide id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.1"></divide><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2"><times id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.1"></times><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑞</ci><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑚</ci></apply><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑘</ci><apply id="S3.E15.m1.1.1.1.cmml" xref="S3.E15.m1.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1">limit-from</csymbol><ci id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1">𝑚</ci><csymbol cd="latexml" id="S3.E15.m1.1.1.1.4.cmml" xref="S3.E15.m1.1.1.1.4">top</csymbol></apply></apply></apply><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3"><root id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3"></root><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.2">𝑑</ci></apply></apply><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3"><times id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><list id="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.2"><apply id="S3.E15.m1.2.2.cmml" xref="S3.E15.m1.2.2"><ci id="S3.E15.m1.2.2.1.cmml" xref="S3.E15.m1.2.2.1">^</ci><ci id="S3.E15.m1.2.2.2.cmml" xref="S3.E15.m1.2.2.2">𝐵</ci></apply><ci id="S3.E15.m1.3.3.cmml" xref="S3.E15.m1.3.3">𝑅</ci></list></apply></apply><apply id="S3.E15.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E15.m1.4.4.1.1.1.1.1.1.4.1.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.4.2.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.4.2">𝑣</ci><ci id="S3.E15.m1.4.4.1.1.1.1.1.1.4.3.cmml" xref="S3.E15.m1.4.4.1.1.1.1.1.1.4.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.4c">z^{m}=W_{\bar{o}}(\sigma(q^{m}k^{(m)\top}/\sqrt{d}+\phi(\hat{B};R))v^{m}).</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.4d">italic_z start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT = italic_W start_POSTSUBSCRIPT over¯ start_ARG italic_o end_ARG end_POSTSUBSCRIPT ( italic_σ ( italic_q start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_k start_POSTSUPERSCRIPT ( italic_m ) ⊤ end_POSTSUPERSCRIPT / square-root start_ARG italic_d end_ARG + italic_ϕ ( over^ start_ARG italic_B end_ARG ; italic_R ) ) italic_v start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.50">Here, <math alttext="\phi(\hat{B};R)\in\mathbb{R}^{HW\times H_{G}W_{G}}" class="ltx_Math" display="inline" id="S3.SS2.p3.47.m1.2"><semantics id="S3.SS2.p3.47.m1.2a"><mrow id="S3.SS2.p3.47.m1.2.3" xref="S3.SS2.p3.47.m1.2.3.cmml"><mrow id="S3.SS2.p3.47.m1.2.3.2" xref="S3.SS2.p3.47.m1.2.3.2.cmml"><mi id="S3.SS2.p3.47.m1.2.3.2.2" xref="S3.SS2.p3.47.m1.2.3.2.2.cmml">ϕ</mi><mo id="S3.SS2.p3.47.m1.2.3.2.1" xref="S3.SS2.p3.47.m1.2.3.2.1.cmml">⁢</mo><mrow id="S3.SS2.p3.47.m1.2.3.2.3.2" xref="S3.SS2.p3.47.m1.2.3.2.3.1.cmml"><mo id="S3.SS2.p3.47.m1.2.3.2.3.2.1" stretchy="false" xref="S3.SS2.p3.47.m1.2.3.2.3.1.cmml">(</mo><mover accent="true" id="S3.SS2.p3.47.m1.1.1" xref="S3.SS2.p3.47.m1.1.1.cmml"><mi id="S3.SS2.p3.47.m1.1.1.2" xref="S3.SS2.p3.47.m1.1.1.2.cmml">B</mi><mo id="S3.SS2.p3.47.m1.1.1.1" xref="S3.SS2.p3.47.m1.1.1.1.cmml">^</mo></mover><mo id="S3.SS2.p3.47.m1.2.3.2.3.2.2" xref="S3.SS2.p3.47.m1.2.3.2.3.1.cmml">;</mo><mi id="S3.SS2.p3.47.m1.2.2" xref="S3.SS2.p3.47.m1.2.2.cmml">R</mi><mo id="S3.SS2.p3.47.m1.2.3.2.3.2.3" stretchy="false" xref="S3.SS2.p3.47.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p3.47.m1.2.3.1" xref="S3.SS2.p3.47.m1.2.3.1.cmml">∈</mo><msup id="S3.SS2.p3.47.m1.2.3.3" xref="S3.SS2.p3.47.m1.2.3.3.cmml"><mi id="S3.SS2.p3.47.m1.2.3.3.2" xref="S3.SS2.p3.47.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.47.m1.2.3.3.3" xref="S3.SS2.p3.47.m1.2.3.3.3.cmml"><mrow id="S3.SS2.p3.47.m1.2.3.3.3.2" xref="S3.SS2.p3.47.m1.2.3.3.3.2.cmml"><mrow id="S3.SS2.p3.47.m1.2.3.3.3.2.2" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2.cmml"><mi id="S3.SS2.p3.47.m1.2.3.3.3.2.2.2" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2.2.cmml">H</mi><mo id="S3.SS2.p3.47.m1.2.3.3.3.2.2.1" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2.1.cmml">⁢</mo><mi id="S3.SS2.p3.47.m1.2.3.3.3.2.2.3" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2.3.cmml">W</mi></mrow><mo id="S3.SS2.p3.47.m1.2.3.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p3.47.m1.2.3.3.3.2.1.cmml">×</mo><msub id="S3.SS2.p3.47.m1.2.3.3.3.2.3" xref="S3.SS2.p3.47.m1.2.3.3.3.2.3.cmml"><mi id="S3.SS2.p3.47.m1.2.3.3.3.2.3.2" xref="S3.SS2.p3.47.m1.2.3.3.3.2.3.2.cmml">H</mi><mi id="S3.SS2.p3.47.m1.2.3.3.3.2.3.3" xref="S3.SS2.p3.47.m1.2.3.3.3.2.3.3.cmml">G</mi></msub></mrow><mo id="S3.SS2.p3.47.m1.2.3.3.3.1" xref="S3.SS2.p3.47.m1.2.3.3.3.1.cmml">⁢</mo><msub id="S3.SS2.p3.47.m1.2.3.3.3.3" xref="S3.SS2.p3.47.m1.2.3.3.3.3.cmml"><mi id="S3.SS2.p3.47.m1.2.3.3.3.3.2" xref="S3.SS2.p3.47.m1.2.3.3.3.3.2.cmml">W</mi><mi id="S3.SS2.p3.47.m1.2.3.3.3.3.3" xref="S3.SS2.p3.47.m1.2.3.3.3.3.3.cmml">G</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.47.m1.2b"><apply id="S3.SS2.p3.47.m1.2.3.cmml" xref="S3.SS2.p3.47.m1.2.3"><in id="S3.SS2.p3.47.m1.2.3.1.cmml" xref="S3.SS2.p3.47.m1.2.3.1"></in><apply id="S3.SS2.p3.47.m1.2.3.2.cmml" xref="S3.SS2.p3.47.m1.2.3.2"><times id="S3.SS2.p3.47.m1.2.3.2.1.cmml" xref="S3.SS2.p3.47.m1.2.3.2.1"></times><ci id="S3.SS2.p3.47.m1.2.3.2.2.cmml" xref="S3.SS2.p3.47.m1.2.3.2.2">italic-ϕ</ci><list id="S3.SS2.p3.47.m1.2.3.2.3.1.cmml" xref="S3.SS2.p3.47.m1.2.3.2.3.2"><apply id="S3.SS2.p3.47.m1.1.1.cmml" xref="S3.SS2.p3.47.m1.1.1"><ci id="S3.SS2.p3.47.m1.1.1.1.cmml" xref="S3.SS2.p3.47.m1.1.1.1">^</ci><ci id="S3.SS2.p3.47.m1.1.1.2.cmml" xref="S3.SS2.p3.47.m1.1.1.2">𝐵</ci></apply><ci id="S3.SS2.p3.47.m1.2.2.cmml" xref="S3.SS2.p3.47.m1.2.2">𝑅</ci></list></apply><apply id="S3.SS2.p3.47.m1.2.3.3.cmml" xref="S3.SS2.p3.47.m1.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.47.m1.2.3.3.1.cmml" xref="S3.SS2.p3.47.m1.2.3.3">superscript</csymbol><ci id="S3.SS2.p3.47.m1.2.3.3.2.cmml" xref="S3.SS2.p3.47.m1.2.3.3.2">ℝ</ci><apply id="S3.SS2.p3.47.m1.2.3.3.3.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3"><times id="S3.SS2.p3.47.m1.2.3.3.3.1.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.1"></times><apply id="S3.SS2.p3.47.m1.2.3.3.3.2.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2"><times id="S3.SS2.p3.47.m1.2.3.3.3.2.1.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.1"></times><apply id="S3.SS2.p3.47.m1.2.3.3.3.2.2.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2"><times id="S3.SS2.p3.47.m1.2.3.3.3.2.2.1.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2.1"></times><ci id="S3.SS2.p3.47.m1.2.3.3.3.2.2.2.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2.2">𝐻</ci><ci id="S3.SS2.p3.47.m1.2.3.3.3.2.2.3.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.2.3">𝑊</ci></apply><apply id="S3.SS2.p3.47.m1.2.3.3.3.2.3.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.47.m1.2.3.3.3.2.3.1.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.3">subscript</csymbol><ci id="S3.SS2.p3.47.m1.2.3.3.3.2.3.2.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.3.2">𝐻</ci><ci id="S3.SS2.p3.47.m1.2.3.3.3.2.3.3.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.2.3.3">𝐺</ci></apply></apply><apply id="S3.SS2.p3.47.m1.2.3.3.3.3.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.47.m1.2.3.3.3.3.1.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.47.m1.2.3.3.3.3.2.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.3.2">𝑊</ci><ci id="S3.SS2.p3.47.m1.2.3.3.3.3.3.cmml" xref="S3.SS2.p3.47.m1.2.3.3.3.3.3">𝐺</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.47.m1.2c">\phi(\hat{B};R)\in\mathbb{R}^{HW\times H_{G}W_{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.47.m1.2d">italic_ϕ ( over^ start_ARG italic_B end_ARG ; italic_R ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_H italic_W × italic_H start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> corresponds to the position embedding, following the approach of previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>. Then <math alttext="z^{m}" class="ltx_Math" display="inline" id="S3.SS2.p3.48.m2.1"><semantics id="S3.SS2.p3.48.m2.1a"><msup id="S3.SS2.p3.48.m2.1.1" xref="S3.SS2.p3.48.m2.1.1.cmml"><mi id="S3.SS2.p3.48.m2.1.1.2" xref="S3.SS2.p3.48.m2.1.1.2.cmml">z</mi><mi id="S3.SS2.p3.48.m2.1.1.3" xref="S3.SS2.p3.48.m2.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.48.m2.1b"><apply id="S3.SS2.p3.48.m2.1.1.cmml" xref="S3.SS2.p3.48.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.48.m2.1.1.1.cmml" xref="S3.SS2.p3.48.m2.1.1">superscript</csymbol><ci id="S3.SS2.p3.48.m2.1.1.2.cmml" xref="S3.SS2.p3.48.m2.1.1.2">𝑧</ci><ci id="S3.SS2.p3.48.m2.1.1.3.cmml" xref="S3.SS2.p3.48.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.48.m2.1c">z^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.48.m2.1d">italic_z start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> is projected though <math alttext="W_{o}" class="ltx_Math" display="inline" id="S3.SS2.p3.49.m3.1"><semantics id="S3.SS2.p3.49.m3.1a"><msub id="S3.SS2.p3.49.m3.1.1" xref="S3.SS2.p3.49.m3.1.1.cmml"><mi id="S3.SS2.p3.49.m3.1.1.2" xref="S3.SS2.p3.49.m3.1.1.2.cmml">W</mi><mi id="S3.SS2.p3.49.m3.1.1.3" xref="S3.SS2.p3.49.m3.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.49.m3.1b"><apply id="S3.SS2.p3.49.m3.1.1.cmml" xref="S3.SS2.p3.49.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.49.m3.1.1.1.cmml" xref="S3.SS2.p3.49.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.49.m3.1.1.2.cmml" xref="S3.SS2.p3.49.m3.1.1.2">𝑊</ci><ci id="S3.SS2.p3.49.m3.1.1.3.cmml" xref="S3.SS2.p3.49.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.49.m3.1c">W_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.49.m3.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> to get the final output <math alttext="z" class="ltx_Math" display="inline" id="S3.SS2.p3.50.m4.1"><semantics id="S3.SS2.p3.50.m4.1a"><mi id="S3.SS2.p3.50.m4.1.1" xref="S3.SS2.p3.50.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.50.m4.1b"><ci id="S3.SS2.p3.50.m4.1.1.cmml" xref="S3.SS2.p3.50.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.50.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.50.m4.1d">italic_z</annotation></semantics></math> as Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.E3" title="In 3.1 Preliminaries ‣ 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Model architectures</h3>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="143" id="S3.F3.1.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overall model architecture of our DeBiFormer. <span class="ltx_text ltx_font_bold" id="S3.F3.8.1">Left:</span> Network architecture of DeBiFormer. <math alttext="N_{1}" class="ltx_Math" display="inline" id="S3.F3.4.m1.1"><semantics id="S3.F3.4.m1.1b"><msub id="S3.F3.4.m1.1.1" xref="S3.F3.4.m1.1.1.cmml"><mi id="S3.F3.4.m1.1.1.2" xref="S3.F3.4.m1.1.1.2.cmml">N</mi><mn id="S3.F3.4.m1.1.1.3" xref="S3.F3.4.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F3.4.m1.1c"><apply id="S3.F3.4.m1.1.1.cmml" xref="S3.F3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.4.m1.1.1.1.cmml" xref="S3.F3.4.m1.1.1">subscript</csymbol><ci id="S3.F3.4.m1.1.1.2.cmml" xref="S3.F3.4.m1.1.1.2">𝑁</ci><cn id="S3.F3.4.m1.1.1.3.cmml" type="integer" xref="S3.F3.4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m1.1d">N_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.4.m1.1e">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="N_{4}" class="ltx_Math" display="inline" id="S3.F3.5.m2.1"><semantics id="S3.F3.5.m2.1b"><msub id="S3.F3.5.m2.1.1" xref="S3.F3.5.m2.1.1.cmml"><mi id="S3.F3.5.m2.1.1.2" xref="S3.F3.5.m2.1.1.2.cmml">N</mi><mn id="S3.F3.5.m2.1.1.3" xref="S3.F3.5.m2.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F3.5.m2.1c"><apply id="S3.F3.5.m2.1.1.cmml" xref="S3.F3.5.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.5.m2.1.1.1.cmml" xref="S3.F3.5.m2.1.1">subscript</csymbol><ci id="S3.F3.5.m2.1.1.2.cmml" xref="S3.F3.5.m2.1.1.2">𝑁</ci><cn id="S3.F3.5.m2.1.1.3.cmml" type="integer" xref="S3.F3.5.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.m2.1d">N_{4}</annotation><annotation encoding="application/x-llamapun" id="S3.F3.5.m2.1e">italic_N start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> represent numbers of stacked successive local and Deformable Bi-level Routing Attention blocks. Please consult Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.T1" title="Table 1 ‣ 3.3 Model architectures ‣ 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">1</span></a> for specific configurations. <span class="ltx_text ltx_font_bold" id="S3.F3.9.2">Right:</span> Details on DeBiFormer Block.</figcaption>
</figure>
<figure class="ltx_table" id="S3.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T1.40">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.40.41.1">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="4" id="S3.T1.40.41.1.1"><span class="ltx_text" id="S3.T1.40.41.1.1.1" style="font-size:90%;">Variant Architectures of DeBiFormer</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.40.42.2">
<td class="ltx_td ltx_border_r" id="S3.T1.40.42.2.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.40.42.2.2"><span class="ltx_text" id="S3.T1.40.42.2.2.1" style="font-size:90%;">DeBi-T</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.40.42.2.3"><span class="ltx_text" id="S3.T1.40.42.2.3.1" style="font-size:90%;">DeBi-S</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.40.42.2.4"><span class="ltx_text" id="S3.T1.40.42.2.4.1" style="font-size:90%;">DeBi-B</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.1"><span class="ltx_text" id="S3.T1.1.1.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.1.1.1.1.1">
<span class="ltx_tr" id="S3.T1.1.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.1.2.1">Stage 1</span></span>
<span class="ltx_tr" id="S3.T1.1.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.1.1.1">56<math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.1.1.1.1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.1.1.1.1.m1.1a"><mo id="S3.T1.1.1.1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.1.1.1.m1.1b"><times id="S3.T1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math>56</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.4.4.4"><span class="ltx_text" id="S3.T1.4.4.4.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.4.4.4.3.3">
<span class="ltx_tr" id="S3.T1.2.2.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.2.2.2.1.1.1.1"><math alttext="N_{1}" class="ltx_Math" display="inline" id="S3.T1.2.2.2.1.1.1.1.m1.1"><semantics id="S3.T1.2.2.2.1.1.1.1.m1.1a"><msub id="S3.T1.2.2.2.1.1.1.1.m1.1.1" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.2.2.2.1.1.1.1.m1.1.1.2" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.2.2.2.1.1.1.1.m1.1.1.3" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.1.1.1.1.m1.1b"><apply id="S3.T1.2.2.2.1.1.1.1.m1.1.1.cmml" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.2.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.2.2.2.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.2.2.2.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.1.1.1.1.m1.1c">N_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>=2, C=64</span></span>
<span class="ltx_tr" id="S3.T1.3.3.3.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.3.3.3.2.2.2.1">r=8, M=2, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.3.3.3.2.2.2.1.m1.1"><semantics id="S3.T1.3.3.3.2.2.2.1.m1.1a"><msub id="S3.T1.3.3.3.2.2.2.1.m1.1.1" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.3.3.3.2.2.2.1.m1.1.1.2" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.3.3.3.2.2.2.1.m1.1.1.3" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.2.2.2.1.m1.1b"><apply id="S3.T1.3.3.3.2.2.2.1.m1.1.1.cmml" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.3.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.3.3.3.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.3.3.3.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.3.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.4.4.4.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.4.4.4.3.3.3.1">G=1, K=9, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.4.4.4.3.3.3.1.m1.1"><semantics id="S3.T1.4.4.4.3.3.3.1.m1.1a"><msub id="S3.T1.4.4.4.3.3.3.1.m1.1.1" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.4.4.4.3.3.3.1.m1.1.1.2" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.4.4.4.3.3.3.1.m1.1.1.3" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.3.3.3.1.m1.1b"><apply id="S3.T1.4.4.4.3.3.3.1.m1.1.1.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.4.4.4.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.4.4.4.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.4.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.7.7"><span class="ltx_text" id="S3.T1.7.7.7.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.7.7.7.3.3">
<span class="ltx_tr" id="S3.T1.5.5.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.5.5.5.1.1.1.1"><math alttext="N_{1}" class="ltx_Math" display="inline" id="S3.T1.5.5.5.1.1.1.1.m1.1"><semantics id="S3.T1.5.5.5.1.1.1.1.m1.1a"><msub id="S3.T1.5.5.5.1.1.1.1.m1.1.1" xref="S3.T1.5.5.5.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.5.5.5.1.1.1.1.m1.1.1.2" xref="S3.T1.5.5.5.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.5.5.5.1.1.1.1.m1.1.1.3" xref="S3.T1.5.5.5.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.1.1.1.1.m1.1b"><apply id="S3.T1.5.5.5.1.1.1.1.m1.1.1.cmml" xref="S3.T1.5.5.5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.5.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.5.5.5.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.5.5.5.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.5.5.5.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.5.5.5.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.5.5.5.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.1.1.1.1.m1.1c">N_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.5.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>=4, C=64</span></span>
<span class="ltx_tr" id="S3.T1.6.6.6.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.6.6.6.2.2.2.1">r=8, M=2, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.6.6.6.2.2.2.1.m1.1"><semantics id="S3.T1.6.6.6.2.2.2.1.m1.1a"><msub id="S3.T1.6.6.6.2.2.2.1.m1.1.1" xref="S3.T1.6.6.6.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.6.6.6.2.2.2.1.m1.1.1.2" xref="S3.T1.6.6.6.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.6.6.6.2.2.2.1.m1.1.1.3" xref="S3.T1.6.6.6.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.2.2.2.1.m1.1b"><apply id="S3.T1.6.6.6.2.2.2.1.m1.1.1.cmml" xref="S3.T1.6.6.6.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.6.6.6.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.6.6.6.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.6.6.6.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.6.6.6.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.6.6.6.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.6.6.6.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.6.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.7.7.7.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.7.7.3.3.3.1">G=1, K=9, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.7.7.7.3.3.3.1.m1.1"><semantics id="S3.T1.7.7.7.3.3.3.1.m1.1a"><msub id="S3.T1.7.7.7.3.3.3.1.m1.1.1" xref="S3.T1.7.7.7.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.7.7.7.3.3.3.1.m1.1.1.2" xref="S3.T1.7.7.7.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.7.7.7.3.3.3.1.m1.1.1.3" xref="S3.T1.7.7.7.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.3.3.3.1.m1.1b"><apply id="S3.T1.7.7.7.3.3.3.1.m1.1.1.cmml" xref="S3.T1.7.7.7.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.7.7.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.7.7.7.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.7.7.7.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.7.7.7.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.7.7.7.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.7.7.7.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.7.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.10.10.10"><span class="ltx_text" id="S3.T1.10.10.10.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.10.10.10.3.3">
<span class="ltx_tr" id="S3.T1.8.8.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.8.8.8.1.1.1.1"><math alttext="N_{1}" class="ltx_Math" display="inline" id="S3.T1.8.8.8.1.1.1.1.m1.1"><semantics id="S3.T1.8.8.8.1.1.1.1.m1.1a"><msub id="S3.T1.8.8.8.1.1.1.1.m1.1.1" xref="S3.T1.8.8.8.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.8.8.8.1.1.1.1.m1.1.1.2" xref="S3.T1.8.8.8.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.8.8.8.1.1.1.1.m1.1.1.3" xref="S3.T1.8.8.8.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.1.1.1.1.m1.1b"><apply id="S3.T1.8.8.8.1.1.1.1.m1.1.1.cmml" xref="S3.T1.8.8.8.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.8.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.8.8.8.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.8.8.8.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.8.8.8.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.8.8.8.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.8.8.8.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.1.1.1.1.m1.1c">N_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.8.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>=4, C=96</span></span>
<span class="ltx_tr" id="S3.T1.9.9.9.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.9.9.9.2.2.2.1">r=8, M=3, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.9.9.9.2.2.2.1.m1.1"><semantics id="S3.T1.9.9.9.2.2.2.1.m1.1a"><msub id="S3.T1.9.9.9.2.2.2.1.m1.1.1" xref="S3.T1.9.9.9.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.9.9.9.2.2.2.1.m1.1.1.2" xref="S3.T1.9.9.9.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.9.9.9.2.2.2.1.m1.1.1.3" xref="S3.T1.9.9.9.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.9.2.2.2.1.m1.1b"><apply id="S3.T1.9.9.9.2.2.2.1.m1.1.1.cmml" xref="S3.T1.9.9.9.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.9.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.9.9.9.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.9.9.9.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.9.9.9.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.9.9.9.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.9.9.9.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.9.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.9.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.10.10.10.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.10.10.10.3.3.3.1">G=1, K=9, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.10.10.10.3.3.3.1.m1.1"><semantics id="S3.T1.10.10.10.3.3.3.1.m1.1a"><msub id="S3.T1.10.10.10.3.3.3.1.m1.1.1" xref="S3.T1.10.10.10.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.10.10.10.3.3.3.1.m1.1.1.2" xref="S3.T1.10.10.10.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.10.10.10.3.3.3.1.m1.1.1.3" xref="S3.T1.10.10.10.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.10.3.3.3.1.m1.1b"><apply id="S3.T1.10.10.10.3.3.3.1.m1.1.1.cmml" xref="S3.T1.10.10.10.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.10.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.10.10.10.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.10.10.10.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.10.10.10.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.10.10.10.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.10.10.10.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.10.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.10.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.20.20">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.11.11.1"><span class="ltx_text" id="S3.T1.11.11.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.11.11.1.1.1">
<span class="ltx_tr" id="S3.T1.11.11.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.11.11.1.1.1.2.1">Stage 2</span></span>
<span class="ltx_tr" id="S3.T1.11.11.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.11.11.1.1.1.1.1">28<math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.11.11.1.1.1.1.1.m1.1"><semantics id="S3.T1.11.11.1.1.1.1.1.m1.1a"><mo id="S3.T1.11.11.1.1.1.1.1.m1.1.1" xref="S3.T1.11.11.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.1.1.1.1.1.m1.1b"><times id="S3.T1.11.11.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.11.11.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.1.1.1.1.1.m1.1d">×</annotation></semantics></math>28</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.14.14.4"><span class="ltx_text" id="S3.T1.14.14.4.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.14.14.4.3.3">
<span class="ltx_tr" id="S3.T1.12.12.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.12.12.2.1.1.1.1"><math alttext="N_{2}" class="ltx_Math" display="inline" id="S3.T1.12.12.2.1.1.1.1.m1.1"><semantics id="S3.T1.12.12.2.1.1.1.1.m1.1a"><msub id="S3.T1.12.12.2.1.1.1.1.m1.1.1" xref="S3.T1.12.12.2.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.12.12.2.1.1.1.1.m1.1.1.2" xref="S3.T1.12.12.2.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.12.12.2.1.1.1.1.m1.1.1.3" xref="S3.T1.12.12.2.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.2.1.1.1.1.m1.1b"><apply id="S3.T1.12.12.2.1.1.1.1.m1.1.1.cmml" xref="S3.T1.12.12.2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.2.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.12.12.2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.12.12.2.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.12.12.2.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.12.12.2.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.12.12.2.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.2.1.1.1.1.m1.1c">N_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.2.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>=2, C=128</span></span>
<span class="ltx_tr" id="S3.T1.13.13.3.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.13.13.3.2.2.2.1">r=4, M=4, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.13.13.3.2.2.2.1.m1.1"><semantics id="S3.T1.13.13.3.2.2.2.1.m1.1a"><msub id="S3.T1.13.13.3.2.2.2.1.m1.1.1" xref="S3.T1.13.13.3.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.13.13.3.2.2.2.1.m1.1.1.2" xref="S3.T1.13.13.3.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.13.13.3.2.2.2.1.m1.1.1.3" xref="S3.T1.13.13.3.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.3.2.2.2.1.m1.1b"><apply id="S3.T1.13.13.3.2.2.2.1.m1.1.1.cmml" xref="S3.T1.13.13.3.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.13.13.3.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.13.13.3.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.13.13.3.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.13.13.3.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.13.13.3.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.13.13.3.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.3.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.13.3.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.14.14.4.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.14.14.4.3.3.3.1">G=2, K=7, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.14.14.4.3.3.3.1.m1.1"><semantics id="S3.T1.14.14.4.3.3.3.1.m1.1a"><msub id="S3.T1.14.14.4.3.3.3.1.m1.1.1" xref="S3.T1.14.14.4.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.14.14.4.3.3.3.1.m1.1.1.2" xref="S3.T1.14.14.4.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.14.14.4.3.3.3.1.m1.1.1.3" xref="S3.T1.14.14.4.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.4.3.3.3.1.m1.1b"><apply id="S3.T1.14.14.4.3.3.3.1.m1.1.1.cmml" xref="S3.T1.14.14.4.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.14.14.4.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.14.14.4.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.14.14.4.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.14.14.4.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.14.14.4.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.14.14.4.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.4.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.14.4.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.17.17.7"><span class="ltx_text" id="S3.T1.17.17.7.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.17.17.7.3.3">
<span class="ltx_tr" id="S3.T1.15.15.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.15.15.5.1.1.1.1"><math alttext="N_{2}" class="ltx_Math" display="inline" id="S3.T1.15.15.5.1.1.1.1.m1.1"><semantics id="S3.T1.15.15.5.1.1.1.1.m1.1a"><msub id="S3.T1.15.15.5.1.1.1.1.m1.1.1" xref="S3.T1.15.15.5.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.15.15.5.1.1.1.1.m1.1.1.2" xref="S3.T1.15.15.5.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.15.15.5.1.1.1.1.m1.1.1.3" xref="S3.T1.15.15.5.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.5.1.1.1.1.m1.1b"><apply id="S3.T1.15.15.5.1.1.1.1.m1.1.1.cmml" xref="S3.T1.15.15.5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.15.15.5.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.15.15.5.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.15.15.5.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.15.15.5.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.15.15.5.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.15.15.5.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.5.1.1.1.1.m1.1c">N_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.15.15.5.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>=4, C=128</span></span>
<span class="ltx_tr" id="S3.T1.16.16.6.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.16.16.6.2.2.2.1">r=4, M=4, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.16.16.6.2.2.2.1.m1.1"><semantics id="S3.T1.16.16.6.2.2.2.1.m1.1a"><msub id="S3.T1.16.16.6.2.2.2.1.m1.1.1" xref="S3.T1.16.16.6.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.16.16.6.2.2.2.1.m1.1.1.2" xref="S3.T1.16.16.6.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.16.16.6.2.2.2.1.m1.1.1.3" xref="S3.T1.16.16.6.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.6.2.2.2.1.m1.1b"><apply id="S3.T1.16.16.6.2.2.2.1.m1.1.1.cmml" xref="S3.T1.16.16.6.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.16.16.6.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.16.16.6.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.16.16.6.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.16.16.6.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.16.16.6.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.16.16.6.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.6.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.16.16.6.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.17.17.7.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.17.17.7.3.3.3.1">G=2, K=7, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.17.17.7.3.3.3.1.m1.1"><semantics id="S3.T1.17.17.7.3.3.3.1.m1.1a"><msub id="S3.T1.17.17.7.3.3.3.1.m1.1.1" xref="S3.T1.17.17.7.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.17.17.7.3.3.3.1.m1.1.1.2" xref="S3.T1.17.17.7.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.17.17.7.3.3.3.1.m1.1.1.3" xref="S3.T1.17.17.7.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.7.3.3.3.1.m1.1b"><apply id="S3.T1.17.17.7.3.3.3.1.m1.1.1.cmml" xref="S3.T1.17.17.7.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.17.17.7.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.17.17.7.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.17.17.7.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.17.17.7.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.17.17.7.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.17.17.7.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.7.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.17.17.7.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.20.20.10"><span class="ltx_text" id="S3.T1.20.20.10.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.20.20.10.3.3">
<span class="ltx_tr" id="S3.T1.18.18.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.18.18.8.1.1.1.1"><math alttext="N_{2}" class="ltx_Math" display="inline" id="S3.T1.18.18.8.1.1.1.1.m1.1"><semantics id="S3.T1.18.18.8.1.1.1.1.m1.1a"><msub id="S3.T1.18.18.8.1.1.1.1.m1.1.1" xref="S3.T1.18.18.8.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.18.18.8.1.1.1.1.m1.1.1.2" xref="S3.T1.18.18.8.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.18.18.8.1.1.1.1.m1.1.1.3" xref="S3.T1.18.18.8.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.8.1.1.1.1.m1.1b"><apply id="S3.T1.18.18.8.1.1.1.1.m1.1.1.cmml" xref="S3.T1.18.18.8.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.18.18.8.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.18.18.8.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.18.18.8.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.18.18.8.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.18.18.8.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.18.18.8.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.8.1.1.1.1.m1.1c">N_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.18.18.8.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>=4, C=192</span></span>
<span class="ltx_tr" id="S3.T1.19.19.9.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.19.19.9.2.2.2.1">r=4, M=6, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.19.19.9.2.2.2.1.m1.1"><semantics id="S3.T1.19.19.9.2.2.2.1.m1.1a"><msub id="S3.T1.19.19.9.2.2.2.1.m1.1.1" xref="S3.T1.19.19.9.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.19.19.9.2.2.2.1.m1.1.1.2" xref="S3.T1.19.19.9.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.19.19.9.2.2.2.1.m1.1.1.3" xref="S3.T1.19.19.9.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.9.2.2.2.1.m1.1b"><apply id="S3.T1.19.19.9.2.2.2.1.m1.1.1.cmml" xref="S3.T1.19.19.9.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.19.19.9.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.19.19.9.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.19.19.9.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.19.19.9.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.19.19.9.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.19.19.9.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.9.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.19.19.9.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.20.20.10.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.20.20.10.3.3.3.1">G=2, K=7, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.20.20.10.3.3.3.1.m1.1"><semantics id="S3.T1.20.20.10.3.3.3.1.m1.1a"><msub id="S3.T1.20.20.10.3.3.3.1.m1.1.1" xref="S3.T1.20.20.10.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.20.20.10.3.3.3.1.m1.1.1.2" xref="S3.T1.20.20.10.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.20.20.10.3.3.3.1.m1.1.1.3" xref="S3.T1.20.20.10.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.10.3.3.3.1.m1.1b"><apply id="S3.T1.20.20.10.3.3.3.1.m1.1.1.cmml" xref="S3.T1.20.20.10.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.20.20.10.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.20.20.10.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.20.20.10.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.20.20.10.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.20.20.10.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.20.20.10.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.10.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.20.20.10.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.30.30">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.21.21.1"><span class="ltx_text" id="S3.T1.21.21.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.21.21.1.1.1">
<span class="ltx_tr" id="S3.T1.21.21.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.21.21.1.1.1.2.1">Stage 3</span></span>
<span class="ltx_tr" id="S3.T1.21.21.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.21.21.1.1.1.1.1">14<math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.21.21.1.1.1.1.1.m1.1"><semantics id="S3.T1.21.21.1.1.1.1.1.m1.1a"><mo id="S3.T1.21.21.1.1.1.1.1.m1.1.1" xref="S3.T1.21.21.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.1.1.1.1.1.m1.1b"><times id="S3.T1.21.21.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.21.21.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T1.21.21.1.1.1.1.1.m1.1d">×</annotation></semantics></math>14</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.24.24.4"><span class="ltx_text" id="S3.T1.24.24.4.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.24.24.4.3.3">
<span class="ltx_tr" id="S3.T1.22.22.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.22.22.2.1.1.1.1"><math alttext="N_{3}" class="ltx_Math" display="inline" id="S3.T1.22.22.2.1.1.1.1.m1.1"><semantics id="S3.T1.22.22.2.1.1.1.1.m1.1a"><msub id="S3.T1.22.22.2.1.1.1.1.m1.1.1" xref="S3.T1.22.22.2.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.22.22.2.1.1.1.1.m1.1.1.2" xref="S3.T1.22.22.2.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.22.22.2.1.1.1.1.m1.1.1.3" xref="S3.T1.22.22.2.1.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.22.22.2.1.1.1.1.m1.1b"><apply id="S3.T1.22.22.2.1.1.1.1.m1.1.1.cmml" xref="S3.T1.22.22.2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.22.22.2.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.22.22.2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.22.22.2.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.22.22.2.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.22.22.2.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.22.22.2.1.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.22.22.2.1.1.1.1.m1.1c">N_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.22.22.2.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>=8, C=256</span></span>
<span class="ltx_tr" id="S3.T1.23.23.3.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.23.23.3.2.2.2.1">r=2, M=8, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.23.23.3.2.2.2.1.m1.1"><semantics id="S3.T1.23.23.3.2.2.2.1.m1.1a"><msub id="S3.T1.23.23.3.2.2.2.1.m1.1.1" xref="S3.T1.23.23.3.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.23.23.3.2.2.2.1.m1.1.1.2" xref="S3.T1.23.23.3.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.23.23.3.2.2.2.1.m1.1.1.3" xref="S3.T1.23.23.3.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.23.23.3.2.2.2.1.m1.1b"><apply id="S3.T1.23.23.3.2.2.2.1.m1.1.1.cmml" xref="S3.T1.23.23.3.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.23.23.3.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.23.23.3.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.23.23.3.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.23.23.3.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.23.23.3.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.23.23.3.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.23.23.3.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.23.23.3.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.24.24.4.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.24.24.4.3.3.3.1">G=4, K=5, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.24.24.4.3.3.3.1.m1.1"><semantics id="S3.T1.24.24.4.3.3.3.1.m1.1a"><msub id="S3.T1.24.24.4.3.3.3.1.m1.1.1" xref="S3.T1.24.24.4.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.24.24.4.3.3.3.1.m1.1.1.2" xref="S3.T1.24.24.4.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.24.24.4.3.3.3.1.m1.1.1.3" xref="S3.T1.24.24.4.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.24.24.4.3.3.3.1.m1.1b"><apply id="S3.T1.24.24.4.3.3.3.1.m1.1.1.cmml" xref="S3.T1.24.24.4.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.24.24.4.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.24.24.4.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.24.24.4.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.24.24.4.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.24.24.4.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.24.24.4.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.24.24.4.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.24.24.4.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.27.27.7"><span class="ltx_text" id="S3.T1.27.27.7.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.27.27.7.3.3">
<span class="ltx_tr" id="S3.T1.25.25.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.25.25.5.1.1.1.1"><math alttext="N_{3}" class="ltx_Math" display="inline" id="S3.T1.25.25.5.1.1.1.1.m1.1"><semantics id="S3.T1.25.25.5.1.1.1.1.m1.1a"><msub id="S3.T1.25.25.5.1.1.1.1.m1.1.1" xref="S3.T1.25.25.5.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.25.25.5.1.1.1.1.m1.1.1.2" xref="S3.T1.25.25.5.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.25.25.5.1.1.1.1.m1.1.1.3" xref="S3.T1.25.25.5.1.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.25.25.5.1.1.1.1.m1.1b"><apply id="S3.T1.25.25.5.1.1.1.1.m1.1.1.cmml" xref="S3.T1.25.25.5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.25.25.5.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.25.25.5.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.25.25.5.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.25.25.5.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.25.25.5.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.25.25.5.1.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.25.25.5.1.1.1.1.m1.1c">N_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.25.25.5.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>=18, C=256</span></span>
<span class="ltx_tr" id="S3.T1.26.26.6.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.26.26.6.2.2.2.1">r=2, M=8, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.26.26.6.2.2.2.1.m1.1"><semantics id="S3.T1.26.26.6.2.2.2.1.m1.1a"><msub id="S3.T1.26.26.6.2.2.2.1.m1.1.1" xref="S3.T1.26.26.6.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.26.26.6.2.2.2.1.m1.1.1.2" xref="S3.T1.26.26.6.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.26.26.6.2.2.2.1.m1.1.1.3" xref="S3.T1.26.26.6.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.26.26.6.2.2.2.1.m1.1b"><apply id="S3.T1.26.26.6.2.2.2.1.m1.1.1.cmml" xref="S3.T1.26.26.6.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.26.26.6.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.26.26.6.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.26.26.6.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.26.26.6.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.26.26.6.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.26.26.6.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.26.26.6.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.26.26.6.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.27.27.7.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.27.27.7.3.3.3.1">G=4, K=5, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.27.27.7.3.3.3.1.m1.1"><semantics id="S3.T1.27.27.7.3.3.3.1.m1.1a"><msub id="S3.T1.27.27.7.3.3.3.1.m1.1.1" xref="S3.T1.27.27.7.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.27.27.7.3.3.3.1.m1.1.1.2" xref="S3.T1.27.27.7.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.27.27.7.3.3.3.1.m1.1.1.3" xref="S3.T1.27.27.7.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.27.27.7.3.3.3.1.m1.1b"><apply id="S3.T1.27.27.7.3.3.3.1.m1.1.1.cmml" xref="S3.T1.27.27.7.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.27.27.7.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.27.27.7.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.27.27.7.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.27.27.7.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.27.27.7.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.27.27.7.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.27.27.7.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.27.27.7.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.30.30.10"><span class="ltx_text" id="S3.T1.30.30.10.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.30.30.10.3.3">
<span class="ltx_tr" id="S3.T1.28.28.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.28.28.8.1.1.1.1"><math alttext="N_{3}" class="ltx_Math" display="inline" id="S3.T1.28.28.8.1.1.1.1.m1.1"><semantics id="S3.T1.28.28.8.1.1.1.1.m1.1a"><msub id="S3.T1.28.28.8.1.1.1.1.m1.1.1" xref="S3.T1.28.28.8.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.28.28.8.1.1.1.1.m1.1.1.2" xref="S3.T1.28.28.8.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.28.28.8.1.1.1.1.m1.1.1.3" xref="S3.T1.28.28.8.1.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.28.28.8.1.1.1.1.m1.1b"><apply id="S3.T1.28.28.8.1.1.1.1.m1.1.1.cmml" xref="S3.T1.28.28.8.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.28.28.8.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.28.28.8.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.28.28.8.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.28.28.8.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.28.28.8.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.28.28.8.1.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.28.28.8.1.1.1.1.m1.1c">N_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.28.28.8.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>=18, C=384</span></span>
<span class="ltx_tr" id="S3.T1.29.29.9.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.29.29.9.2.2.2.1">r=2, M=12, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.29.29.9.2.2.2.1.m1.1"><semantics id="S3.T1.29.29.9.2.2.2.1.m1.1a"><msub id="S3.T1.29.29.9.2.2.2.1.m1.1.1" xref="S3.T1.29.29.9.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.29.29.9.2.2.2.1.m1.1.1.2" xref="S3.T1.29.29.9.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.29.29.9.2.2.2.1.m1.1.1.3" xref="S3.T1.29.29.9.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.29.29.9.2.2.2.1.m1.1b"><apply id="S3.T1.29.29.9.2.2.2.1.m1.1.1.cmml" xref="S3.T1.29.29.9.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.29.29.9.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.29.29.9.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.29.29.9.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.29.29.9.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.29.29.9.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.29.29.9.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.29.29.9.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.29.29.9.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.30.30.10.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.30.30.10.3.3.3.1">G=4, K=5, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.30.30.10.3.3.3.1.m1.1"><semantics id="S3.T1.30.30.10.3.3.3.1.m1.1a"><msub id="S3.T1.30.30.10.3.3.3.1.m1.1.1" xref="S3.T1.30.30.10.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.30.30.10.3.3.3.1.m1.1.1.2" xref="S3.T1.30.30.10.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.30.30.10.3.3.3.1.m1.1.1.3" xref="S3.T1.30.30.10.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.30.30.10.3.3.3.1.m1.1b"><apply id="S3.T1.30.30.10.3.3.3.1.m1.1.1.cmml" xref="S3.T1.30.30.10.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.30.30.10.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.30.30.10.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.30.30.10.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.30.30.10.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.30.30.10.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.30.30.10.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.30.30.10.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.30.30.10.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.40.40">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.31.31.1"><span class="ltx_text" id="S3.T1.31.31.1.1" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.31.31.1.1.1">
<span class="ltx_tr" id="S3.T1.31.31.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.31.31.1.1.1.2.1">Stage 4</span></span>
<span class="ltx_tr" id="S3.T1.31.31.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.31.31.1.1.1.1.1">7<math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.31.31.1.1.1.1.1.m1.1"><semantics id="S3.T1.31.31.1.1.1.1.1.m1.1a"><mo id="S3.T1.31.31.1.1.1.1.1.m1.1.1" xref="S3.T1.31.31.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.31.31.1.1.1.1.1.m1.1b"><times id="S3.T1.31.31.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.31.31.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.31.31.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T1.31.31.1.1.1.1.1.m1.1d">×</annotation></semantics></math>7</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.34.34.4"><span class="ltx_text" id="S3.T1.34.34.4.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.34.34.4.3.3">
<span class="ltx_tr" id="S3.T1.32.32.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.32.32.2.1.1.1.1"><math alttext="N_{4}" class="ltx_Math" display="inline" id="S3.T1.32.32.2.1.1.1.1.m1.1"><semantics id="S3.T1.32.32.2.1.1.1.1.m1.1a"><msub id="S3.T1.32.32.2.1.1.1.1.m1.1.1" xref="S3.T1.32.32.2.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.32.32.2.1.1.1.1.m1.1.1.2" xref="S3.T1.32.32.2.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.32.32.2.1.1.1.1.m1.1.1.3" xref="S3.T1.32.32.2.1.1.1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.32.32.2.1.1.1.1.m1.1b"><apply id="S3.T1.32.32.2.1.1.1.1.m1.1.1.cmml" xref="S3.T1.32.32.2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.32.32.2.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.32.32.2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.32.32.2.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.32.32.2.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.32.32.2.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.32.32.2.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.32.32.2.1.1.1.1.m1.1c">N_{4}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.32.32.2.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>=2, C=512</span></span>
<span class="ltx_tr" id="S3.T1.33.33.3.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.33.33.3.2.2.2.1">r=1, M=16, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.33.33.3.2.2.2.1.m1.1"><semantics id="S3.T1.33.33.3.2.2.2.1.m1.1a"><msub id="S3.T1.33.33.3.2.2.2.1.m1.1.1" xref="S3.T1.33.33.3.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.33.33.3.2.2.2.1.m1.1.1.2" xref="S3.T1.33.33.3.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.33.33.3.2.2.2.1.m1.1.1.3" xref="S3.T1.33.33.3.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.33.33.3.2.2.2.1.m1.1b"><apply id="S3.T1.33.33.3.2.2.2.1.m1.1.1.cmml" xref="S3.T1.33.33.3.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.33.33.3.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.33.33.3.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.33.33.3.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.33.33.3.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.33.33.3.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.33.33.3.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.33.33.3.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.33.33.3.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.34.34.4.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.34.34.4.3.3.3.1">G=8, K=3, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.34.34.4.3.3.3.1.m1.1"><semantics id="S3.T1.34.34.4.3.3.3.1.m1.1a"><msub id="S3.T1.34.34.4.3.3.3.1.m1.1.1" xref="S3.T1.34.34.4.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.34.34.4.3.3.3.1.m1.1.1.2" xref="S3.T1.34.34.4.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.34.34.4.3.3.3.1.m1.1.1.3" xref="S3.T1.34.34.4.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.34.34.4.3.3.3.1.m1.1b"><apply id="S3.T1.34.34.4.3.3.3.1.m1.1.1.cmml" xref="S3.T1.34.34.4.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.34.34.4.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.34.34.4.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.34.34.4.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.34.34.4.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.34.34.4.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.34.34.4.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.34.34.4.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.34.34.4.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.37.37.7"><span class="ltx_text" id="S3.T1.37.37.7.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.37.37.7.3.3">
<span class="ltx_tr" id="S3.T1.35.35.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.35.35.5.1.1.1.1"><math alttext="N_{4}" class="ltx_Math" display="inline" id="S3.T1.35.35.5.1.1.1.1.m1.1"><semantics id="S3.T1.35.35.5.1.1.1.1.m1.1a"><msub id="S3.T1.35.35.5.1.1.1.1.m1.1.1" xref="S3.T1.35.35.5.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.35.35.5.1.1.1.1.m1.1.1.2" xref="S3.T1.35.35.5.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.35.35.5.1.1.1.1.m1.1.1.3" xref="S3.T1.35.35.5.1.1.1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.35.35.5.1.1.1.1.m1.1b"><apply id="S3.T1.35.35.5.1.1.1.1.m1.1.1.cmml" xref="S3.T1.35.35.5.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.35.35.5.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.35.35.5.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.35.35.5.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.35.35.5.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.35.35.5.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.35.35.5.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.35.35.5.1.1.1.1.m1.1c">N_{4}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.35.35.5.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>=6, C=512</span></span>
<span class="ltx_tr" id="S3.T1.36.36.6.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.36.36.6.2.2.2.1">r=1, M=16, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.36.36.6.2.2.2.1.m1.1"><semantics id="S3.T1.36.36.6.2.2.2.1.m1.1a"><msub id="S3.T1.36.36.6.2.2.2.1.m1.1.1" xref="S3.T1.36.36.6.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.36.36.6.2.2.2.1.m1.1.1.2" xref="S3.T1.36.36.6.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.36.36.6.2.2.2.1.m1.1.1.3" xref="S3.T1.36.36.6.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.36.36.6.2.2.2.1.m1.1b"><apply id="S3.T1.36.36.6.2.2.2.1.m1.1.1.cmml" xref="S3.T1.36.36.6.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.36.36.6.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.36.36.6.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.36.36.6.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.36.36.6.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.36.36.6.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.36.36.6.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.36.36.6.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.36.36.6.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=1</span></span>
<span class="ltx_tr" id="S3.T1.37.37.7.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.37.37.7.3.3.3.1">G=8, K=3, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.37.37.7.3.3.3.1.m1.1"><semantics id="S3.T1.37.37.7.3.3.3.1.m1.1a"><msub id="S3.T1.37.37.7.3.3.3.1.m1.1.1" xref="S3.T1.37.37.7.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.37.37.7.3.3.3.1.m1.1.1.2" xref="S3.T1.37.37.7.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.37.37.7.3.3.3.1.m1.1.1.3" xref="S3.T1.37.37.7.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.37.37.7.3.3.3.1.m1.1b"><apply id="S3.T1.37.37.7.3.3.3.1.m1.1.1.cmml" xref="S3.T1.37.37.7.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.37.37.7.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.37.37.7.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.37.37.7.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.37.37.7.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.37.37.7.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.37.37.7.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.37.37.7.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.37.37.7.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=2</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T1.40.40.10"><span class="ltx_text" id="S3.T1.40.40.10.3" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.40.40.10.3.3">
<span class="ltx_tr" id="S3.T1.38.38.8.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.38.38.8.1.1.1.1"><math alttext="N_{4}" class="ltx_Math" display="inline" id="S3.T1.38.38.8.1.1.1.1.m1.1"><semantics id="S3.T1.38.38.8.1.1.1.1.m1.1a"><msub id="S3.T1.38.38.8.1.1.1.1.m1.1.1" xref="S3.T1.38.38.8.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.38.38.8.1.1.1.1.m1.1.1.2" xref="S3.T1.38.38.8.1.1.1.1.m1.1.1.2.cmml">N</mi><mn id="S3.T1.38.38.8.1.1.1.1.m1.1.1.3" xref="S3.T1.38.38.8.1.1.1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.38.38.8.1.1.1.1.m1.1b"><apply id="S3.T1.38.38.8.1.1.1.1.m1.1.1.cmml" xref="S3.T1.38.38.8.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.38.38.8.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.38.38.8.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.38.38.8.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.38.38.8.1.1.1.1.m1.1.1.2">𝑁</ci><cn id="S3.T1.38.38.8.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.38.38.8.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.38.38.8.1.1.1.1.m1.1c">N_{4}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.38.38.8.1.1.1.1.m1.1d">italic_N start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>=4, C=768</span></span>
<span class="ltx_tr" id="S3.T1.39.39.9.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.39.39.9.2.2.2.1">r=1, M=24, <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.39.39.9.2.2.2.1.m1.1"><semantics id="S3.T1.39.39.9.2.2.2.1.m1.1a"><msub id="S3.T1.39.39.9.2.2.2.1.m1.1.1" xref="S3.T1.39.39.9.2.2.2.1.m1.1.1.cmml"><mi id="S3.T1.39.39.9.2.2.2.1.m1.1.1.2" xref="S3.T1.39.39.9.2.2.2.1.m1.1.1.2.cmml">D</mi><mi id="S3.T1.39.39.9.2.2.2.1.m1.1.1.3" xref="S3.T1.39.39.9.2.2.2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.39.39.9.2.2.2.1.m1.1b"><apply id="S3.T1.39.39.9.2.2.2.1.m1.1.1.cmml" xref="S3.T1.39.39.9.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.39.39.9.2.2.2.1.m1.1.1.1.cmml" xref="S3.T1.39.39.9.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.39.39.9.2.2.2.1.m1.1.1.2.cmml" xref="S3.T1.39.39.9.2.2.2.1.m1.1.1.2">𝐷</ci><ci id="S3.T1.39.39.9.2.2.2.1.m1.1.1.3.cmml" xref="S3.T1.39.39.9.2.2.2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.39.39.9.2.2.2.1.m1.1c">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.39.39.9.2.2.2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
<span class="ltx_tr" id="S3.T1.40.40.10.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.40.40.10.3.3.3.1">G=8, K=3, <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.40.40.10.3.3.3.1.m1.1"><semantics id="S3.T1.40.40.10.3.3.3.1.m1.1a"><msub id="S3.T1.40.40.10.3.3.3.1.m1.1.1" xref="S3.T1.40.40.10.3.3.3.1.m1.1.1.cmml"><mi id="S3.T1.40.40.10.3.3.3.1.m1.1.1.2" xref="S3.T1.40.40.10.3.3.3.1.m1.1.1.2.cmml">B</mi><mi id="S3.T1.40.40.10.3.3.3.1.m1.1.1.3" xref="S3.T1.40.40.10.3.3.3.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.40.40.10.3.3.3.1.m1.1b"><apply id="S3.T1.40.40.10.3.3.3.1.m1.1.1.cmml" xref="S3.T1.40.40.10.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.40.40.10.3.3.3.1.m1.1.1.1.cmml" xref="S3.T1.40.40.10.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S3.T1.40.40.10.3.3.3.1.m1.1.1.2.cmml" xref="S3.T1.40.40.10.3.3.3.1.m1.1.1.2">𝐵</ci><ci id="S3.T1.40.40.10.3.3.3.1.m1.1.1.3.cmml" xref="S3.T1.40.40.10.3.3.3.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.40.40.10.3.3.3.1.m1.1c">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.40.40.10.3.3.3.1.m1.1d">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>=3</span></span>
</span></span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>DeBiFormer model architecture specifications. <math alttext="N_{i}" class="ltx_Math" display="inline" id="S3.T1.50.m1.1"><semantics id="S3.T1.50.m1.1b"><msub id="S3.T1.50.m1.1.1" xref="S3.T1.50.m1.1.1.cmml"><mi id="S3.T1.50.m1.1.1.2" xref="S3.T1.50.m1.1.1.2.cmml">N</mi><mi id="S3.T1.50.m1.1.1.3" xref="S3.T1.50.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.50.m1.1c"><apply id="S3.T1.50.m1.1.1.cmml" xref="S3.T1.50.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.50.m1.1.1.1.cmml" xref="S3.T1.50.m1.1.1">subscript</csymbol><ci id="S3.T1.50.m1.1.1.2.cmml" xref="S3.T1.50.m1.1.1.2">𝑁</ci><ci id="S3.T1.50.m1.1.1.3.cmml" xref="S3.T1.50.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.50.m1.1d">N_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.50.m1.1e">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>: Number of blocks at stage <math alttext="i" class="ltx_Math" display="inline" id="S3.T1.51.m2.1"><semantics id="S3.T1.51.m2.1b"><mi id="S3.T1.51.m2.1.1" xref="S3.T1.51.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.T1.51.m2.1c"><ci id="S3.T1.51.m2.1.1.cmml" xref="S3.T1.51.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.51.m2.1d">i</annotation><annotation encoding="application/x-llamapun" id="S3.T1.51.m2.1e">italic_i</annotation></semantics></math>. <math alttext="C" class="ltx_Math" display="inline" id="S3.T1.52.m3.1"><semantics id="S3.T1.52.m3.1b"><mi id="S3.T1.52.m3.1.1" xref="S3.T1.52.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.T1.52.m3.1c"><ci id="S3.T1.52.m3.1.1.cmml" xref="S3.T1.52.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.52.m3.1d">C</annotation><annotation encoding="application/x-llamapun" id="S3.T1.52.m3.1e">italic_C</annotation></semantics></math>: Base channels in each block. <math alttext="r" class="ltx_Math" display="inline" id="S3.T1.53.m4.1"><semantics id="S3.T1.53.m4.1b"><mi id="S3.T1.53.m4.1.1" xref="S3.T1.53.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.T1.53.m4.1c"><ci id="S3.T1.53.m4.1.1.cmml" xref="S3.T1.53.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.53.m4.1d">r</annotation><annotation encoding="application/x-llamapun" id="S3.T1.53.m4.1e">italic_r</annotation></semantics></math>: Downsample ratio of deformed points. <math alttext="M" class="ltx_Math" display="inline" id="S3.T1.54.m5.1"><semantics id="S3.T1.54.m5.1b"><mi id="S3.T1.54.m5.1.1" xref="S3.T1.54.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.T1.54.m5.1c"><ci id="S3.T1.54.m5.1.1.cmml" xref="S3.T1.54.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.54.m5.1d">M</annotation><annotation encoding="application/x-llamapun" id="S3.T1.54.m5.1e">italic_M</annotation></semantics></math>: Number of attention heads in DBRMHA. <math alttext="G" class="ltx_Math" display="inline" id="S3.T1.55.m6.1"><semantics id="S3.T1.55.m6.1b"><mi id="S3.T1.55.m6.1.1" xref="S3.T1.55.m6.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.T1.55.m6.1c"><ci id="S3.T1.55.m6.1.1.cmml" xref="S3.T1.55.m6.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.55.m6.1d">G</annotation><annotation encoding="application/x-llamapun" id="S3.T1.55.m6.1e">italic_G</annotation></semantics></math>: Number of offset groups in DBRMHA. <math alttext="D_{r}" class="ltx_Math" display="inline" id="S3.T1.56.m7.1"><semantics id="S3.T1.56.m7.1b"><msub id="S3.T1.56.m7.1.1" xref="S3.T1.56.m7.1.1.cmml"><mi id="S3.T1.56.m7.1.1.2" xref="S3.T1.56.m7.1.1.2.cmml">D</mi><mi id="S3.T1.56.m7.1.1.3" xref="S3.T1.56.m7.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.56.m7.1c"><apply id="S3.T1.56.m7.1.1.cmml" xref="S3.T1.56.m7.1.1"><csymbol cd="ambiguous" id="S3.T1.56.m7.1.1.1.cmml" xref="S3.T1.56.m7.1.1">subscript</csymbol><ci id="S3.T1.56.m7.1.1.2.cmml" xref="S3.T1.56.m7.1.1.2">𝐷</ci><ci id="S3.T1.56.m7.1.1.3.cmml" xref="S3.T1.56.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.56.m7.1d">D_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.56.m7.1e">italic_D start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>: Deformable level MLP expansion ratio. <math alttext="B_{r}" class="ltx_Math" display="inline" id="S3.T1.57.m8.1"><semantics id="S3.T1.57.m8.1b"><msub id="S3.T1.57.m8.1.1" xref="S3.T1.57.m8.1.1.cmml"><mi id="S3.T1.57.m8.1.1.2" xref="S3.T1.57.m8.1.1.2.cmml">B</mi><mi id="S3.T1.57.m8.1.1.3" xref="S3.T1.57.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.57.m8.1c"><apply id="S3.T1.57.m8.1.1.cmml" xref="S3.T1.57.m8.1.1"><csymbol cd="ambiguous" id="S3.T1.57.m8.1.1.1.cmml" xref="S3.T1.57.m8.1.1">subscript</csymbol><ci id="S3.T1.57.m8.1.1.2.cmml" xref="S3.T1.57.m8.1.1.2">𝐵</ci><ci id="S3.T1.57.m8.1.1.3.cmml" xref="S3.T1.57.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.57.m8.1d">B_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.57.m8.1e">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>: Bi level MLP expansion ratio. <math alttext="K" class="ltx_Math" display="inline" id="S3.T1.58.m9.1"><semantics id="S3.T1.58.m9.1b"><mi id="S3.T1.58.m9.1.1" xref="S3.T1.58.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.T1.58.m9.1c"><ci id="S3.T1.58.m9.1.1.cmml" xref="S3.T1.58.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.58.m9.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.T1.58.m9.1e">italic_K</annotation></semantics></math>: Kernel size of offset module.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.11">Leveraging DBRA as a fundamental building block, we introduce a novel vision transformer called DeBiFormer. As depicted in Figure<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.F3" title="Figure 3 ‣ 3.3 Model architectures ‣ 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">3</span></a>, we adhere to the recent state-of-the-art Vision Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>, using a four-stage pyramid structure.
In stage <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_i</annotation></semantics></math>, we utilize an overlapped patch embedding in the first stage and a patch merging module <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib34" title="">34</a>]</cite> in the second to fourth stages. This is done to decrease the input spatial resolution while increasing the number of channels. Subsequently, <math alttext="N_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">N</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑁</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">N_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> consecutive DeBiFormer blocks are used to transform the features. Within each DeBiFormer block, we adhere to recent methodologies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite> by using a <math alttext="3\times 3" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mn id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">3</mn><mo id="S3.SS3.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.3.m3.1.1.1.cmml">×</mo><mn id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><times id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></times><cn id="S3.SS3.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS3.p1.3.m3.1.1.2">3</cn><cn id="S3.SS3.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">3\times 3</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">3 × 3</annotation></semantics></math> depthwise convolution at the outset. This is done to implicitly encode relative position information. Following that, we sequentially use a DBRA module with a 2-ConvFFN module with an expansion ratio <math alttext="e" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">e</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_e</annotation></semantics></math> for cross-location relation modeling and per-location embedding, respectively.
DeBiFormer is instantiated in three distinct model sizes, achieved by scaling the network width and depth as outlined in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S3.T1" title="Table 1 ‣ 3.3 Model architectures ‣ 3 Our Approach: DeBiFormer ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">1</span></a>.
Each attention head comprises 32 channels, and we use a bi-level ConvFFN and deformable-level ConvFFN with an MLP expansion ratio of <math alttext="e=3" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">e</mi><mo id="S3.SS3.p1.5.m5.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><eq id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1"></eq><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑒</ci><cn id="S3.SS3.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">e=3</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_e = 3</annotation></semantics></math>. For the BRA, we use <math alttext="topk=1,4,16,S^{2}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.4"><semantics id="S3.SS3.p1.6.m6.4a"><mrow id="S3.SS3.p1.6.m6.4.4" xref="S3.SS3.p1.6.m6.4.4.cmml"><mrow id="S3.SS3.p1.6.m6.4.4.3" xref="S3.SS3.p1.6.m6.4.4.3.cmml"><mi id="S3.SS3.p1.6.m6.4.4.3.2" xref="S3.SS3.p1.6.m6.4.4.3.2.cmml">t</mi><mo id="S3.SS3.p1.6.m6.4.4.3.1" xref="S3.SS3.p1.6.m6.4.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.6.m6.4.4.3.3" xref="S3.SS3.p1.6.m6.4.4.3.3.cmml">o</mi><mo id="S3.SS3.p1.6.m6.4.4.3.1a" xref="S3.SS3.p1.6.m6.4.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.6.m6.4.4.3.4" xref="S3.SS3.p1.6.m6.4.4.3.4.cmml">p</mi><mo id="S3.SS3.p1.6.m6.4.4.3.1b" xref="S3.SS3.p1.6.m6.4.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.6.m6.4.4.3.5" xref="S3.SS3.p1.6.m6.4.4.3.5.cmml">k</mi></mrow><mo id="S3.SS3.p1.6.m6.4.4.2" xref="S3.SS3.p1.6.m6.4.4.2.cmml">=</mo><mrow id="S3.SS3.p1.6.m6.4.4.1.1" xref="S3.SS3.p1.6.m6.4.4.1.2.cmml"><mn id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">1</mn><mo id="S3.SS3.p1.6.m6.4.4.1.1.2" xref="S3.SS3.p1.6.m6.4.4.1.2.cmml">,</mo><mn id="S3.SS3.p1.6.m6.2.2" xref="S3.SS3.p1.6.m6.2.2.cmml">4</mn><mo id="S3.SS3.p1.6.m6.4.4.1.1.3" xref="S3.SS3.p1.6.m6.4.4.1.2.cmml">,</mo><mn id="S3.SS3.p1.6.m6.3.3" xref="S3.SS3.p1.6.m6.3.3.cmml">16</mn><mo id="S3.SS3.p1.6.m6.4.4.1.1.4" xref="S3.SS3.p1.6.m6.4.4.1.2.cmml">,</mo><msup id="S3.SS3.p1.6.m6.4.4.1.1.1" xref="S3.SS3.p1.6.m6.4.4.1.1.1.cmml"><mi id="S3.SS3.p1.6.m6.4.4.1.1.1.2" xref="S3.SS3.p1.6.m6.4.4.1.1.1.2.cmml">S</mi><mn id="S3.SS3.p1.6.m6.4.4.1.1.1.3" xref="S3.SS3.p1.6.m6.4.4.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.4b"><apply id="S3.SS3.p1.6.m6.4.4.cmml" xref="S3.SS3.p1.6.m6.4.4"><eq id="S3.SS3.p1.6.m6.4.4.2.cmml" xref="S3.SS3.p1.6.m6.4.4.2"></eq><apply id="S3.SS3.p1.6.m6.4.4.3.cmml" xref="S3.SS3.p1.6.m6.4.4.3"><times id="S3.SS3.p1.6.m6.4.4.3.1.cmml" xref="S3.SS3.p1.6.m6.4.4.3.1"></times><ci id="S3.SS3.p1.6.m6.4.4.3.2.cmml" xref="S3.SS3.p1.6.m6.4.4.3.2">𝑡</ci><ci id="S3.SS3.p1.6.m6.4.4.3.3.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3">𝑜</ci><ci id="S3.SS3.p1.6.m6.4.4.3.4.cmml" xref="S3.SS3.p1.6.m6.4.4.3.4">𝑝</ci><ci id="S3.SS3.p1.6.m6.4.4.3.5.cmml" xref="S3.SS3.p1.6.m6.4.4.3.5">𝑘</ci></apply><list id="S3.SS3.p1.6.m6.4.4.1.2.cmml" xref="S3.SS3.p1.6.m6.4.4.1.1"><cn id="S3.SS3.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS3.p1.6.m6.1.1">1</cn><cn id="S3.SS3.p1.6.m6.2.2.cmml" type="integer" xref="S3.SS3.p1.6.m6.2.2">4</cn><cn id="S3.SS3.p1.6.m6.3.3.cmml" type="integer" xref="S3.SS3.p1.6.m6.3.3">16</cn><apply id="S3.SS3.p1.6.m6.4.4.1.1.1.cmml" xref="S3.SS3.p1.6.m6.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.4.4.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.6.m6.4.4.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.4.4.1.1.1.2">𝑆</ci><cn id="S3.SS3.p1.6.m6.4.4.1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.6.m6.4.4.1.1.1.3">2</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.4c">topk=1,4,16,S^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.4d">italic_t italic_o italic_p italic_k = 1 , 4 , 16 , italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, and for the DBRA, we use <math alttext="topk=4,8,16,S^{2}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.4"><semantics id="S3.SS3.p1.7.m7.4a"><mrow id="S3.SS3.p1.7.m7.4.4" xref="S3.SS3.p1.7.m7.4.4.cmml"><mrow id="S3.SS3.p1.7.m7.4.4.3" xref="S3.SS3.p1.7.m7.4.4.3.cmml"><mi id="S3.SS3.p1.7.m7.4.4.3.2" xref="S3.SS3.p1.7.m7.4.4.3.2.cmml">t</mi><mo id="S3.SS3.p1.7.m7.4.4.3.1" xref="S3.SS3.p1.7.m7.4.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.7.m7.4.4.3.3" xref="S3.SS3.p1.7.m7.4.4.3.3.cmml">o</mi><mo id="S3.SS3.p1.7.m7.4.4.3.1a" xref="S3.SS3.p1.7.m7.4.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.7.m7.4.4.3.4" xref="S3.SS3.p1.7.m7.4.4.3.4.cmml">p</mi><mo id="S3.SS3.p1.7.m7.4.4.3.1b" xref="S3.SS3.p1.7.m7.4.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.7.m7.4.4.3.5" xref="S3.SS3.p1.7.m7.4.4.3.5.cmml">k</mi></mrow><mo id="S3.SS3.p1.7.m7.4.4.2" xref="S3.SS3.p1.7.m7.4.4.2.cmml">=</mo><mrow id="S3.SS3.p1.7.m7.4.4.1.1" xref="S3.SS3.p1.7.m7.4.4.1.2.cmml"><mn id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">4</mn><mo id="S3.SS3.p1.7.m7.4.4.1.1.2" xref="S3.SS3.p1.7.m7.4.4.1.2.cmml">,</mo><mn id="S3.SS3.p1.7.m7.2.2" xref="S3.SS3.p1.7.m7.2.2.cmml">8</mn><mo id="S3.SS3.p1.7.m7.4.4.1.1.3" xref="S3.SS3.p1.7.m7.4.4.1.2.cmml">,</mo><mn id="S3.SS3.p1.7.m7.3.3" xref="S3.SS3.p1.7.m7.3.3.cmml">16</mn><mo id="S3.SS3.p1.7.m7.4.4.1.1.4" xref="S3.SS3.p1.7.m7.4.4.1.2.cmml">,</mo><msup id="S3.SS3.p1.7.m7.4.4.1.1.1" xref="S3.SS3.p1.7.m7.4.4.1.1.1.cmml"><mi id="S3.SS3.p1.7.m7.4.4.1.1.1.2" xref="S3.SS3.p1.7.m7.4.4.1.1.1.2.cmml">S</mi><mn id="S3.SS3.p1.7.m7.4.4.1.1.1.3" xref="S3.SS3.p1.7.m7.4.4.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.4b"><apply id="S3.SS3.p1.7.m7.4.4.cmml" xref="S3.SS3.p1.7.m7.4.4"><eq id="S3.SS3.p1.7.m7.4.4.2.cmml" xref="S3.SS3.p1.7.m7.4.4.2"></eq><apply id="S3.SS3.p1.7.m7.4.4.3.cmml" xref="S3.SS3.p1.7.m7.4.4.3"><times id="S3.SS3.p1.7.m7.4.4.3.1.cmml" xref="S3.SS3.p1.7.m7.4.4.3.1"></times><ci id="S3.SS3.p1.7.m7.4.4.3.2.cmml" xref="S3.SS3.p1.7.m7.4.4.3.2">𝑡</ci><ci id="S3.SS3.p1.7.m7.4.4.3.3.cmml" xref="S3.SS3.p1.7.m7.4.4.3.3">𝑜</ci><ci id="S3.SS3.p1.7.m7.4.4.3.4.cmml" xref="S3.SS3.p1.7.m7.4.4.3.4">𝑝</ci><ci id="S3.SS3.p1.7.m7.4.4.3.5.cmml" xref="S3.SS3.p1.7.m7.4.4.3.5">𝑘</ci></apply><list id="S3.SS3.p1.7.m7.4.4.1.2.cmml" xref="S3.SS3.p1.7.m7.4.4.1.1"><cn id="S3.SS3.p1.7.m7.1.1.cmml" type="integer" xref="S3.SS3.p1.7.m7.1.1">4</cn><cn id="S3.SS3.p1.7.m7.2.2.cmml" type="integer" xref="S3.SS3.p1.7.m7.2.2">8</cn><cn id="S3.SS3.p1.7.m7.3.3.cmml" type="integer" xref="S3.SS3.p1.7.m7.3.3">16</cn><apply id="S3.SS3.p1.7.m7.4.4.1.1.1.cmml" xref="S3.SS3.p1.7.m7.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.4.4.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.4.4.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.7.m7.4.4.1.1.1.2.cmml" xref="S3.SS3.p1.7.m7.4.4.1.1.1.2">𝑆</ci><cn id="S3.SS3.p1.7.m7.4.4.1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.7.m7.4.4.1.1.1.3">2</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.4c">topk=4,8,16,S^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.4d">italic_t italic_o italic_p italic_k = 4 , 8 , 16 , italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> for the four stages. Moreover, we set the region partition factor <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">italic_S</annotation></semantics></math> to specific values: <math alttext="S=7" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1"><semantics id="S3.SS3.p1.9.m9.1a"><mrow id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">S</mi><mo id="S3.SS3.p1.9.m9.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><eq id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1"></eq><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝑆</ci><cn id="S3.SS3.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.SS3.p1.9.m9.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">S=7</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.1d">italic_S = 7</annotation></semantics></math> for classification, <math alttext="S=8" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.1"><semantics id="S3.SS3.p1.10.m10.1a"><mrow id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2" xref="S3.SS3.p1.10.m10.1.1.2.cmml">S</mi><mo id="S3.SS3.p1.10.m10.1.1.1" xref="S3.SS3.p1.10.m10.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.10.m10.1.1.3" xref="S3.SS3.p1.10.m10.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><eq id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1.1"></eq><ci id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2">𝑆</ci><cn id="S3.SS3.p1.10.m10.1.1.3.cmml" type="integer" xref="S3.SS3.p1.10.m10.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">S=8</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.1d">italic_S = 8</annotation></semantics></math> for semantic segmentation, and <math alttext="S=20" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m11.1"><semantics id="S3.SS3.p1.11.m11.1a"><mrow id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml"><mi id="S3.SS3.p1.11.m11.1.1.2" xref="S3.SS3.p1.11.m11.1.1.2.cmml">S</mi><mo id="S3.SS3.p1.11.m11.1.1.1" xref="S3.SS3.p1.11.m11.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.11.m11.1.1.3" xref="S3.SS3.p1.11.m11.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><apply id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1"><eq id="S3.SS3.p1.11.m11.1.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1.1"></eq><ci id="S3.SS3.p1.11.m11.1.1.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2">𝑆</ci><cn id="S3.SS3.p1.11.m11.1.1.3.cmml" type="integer" xref="S3.SS3.p1.11.m11.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">S=20</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m11.1d">italic_S = 20</annotation></semantics></math> for object detection tasks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T2.3" style="width:203.8pt;">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.1.1.1"><span class="ltx_text" id="S4.T2.3.1.1.1.1" style="font-size:90%;">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.3.1.1.2.1">
<tr class="ltx_tr" id="S4.T2.3.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.1.1.2.1.1.1"><span class="ltx_text" id="S4.T2.3.1.1.2.1.1.1.1" style="font-size:90%;">FLOPs</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.1.1.2.1.2.1"><span class="ltx_text" id="S4.T2.3.1.1.2.1.2.1.1" style="font-size:90%;">(G)</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.3.1.1.3.1">
<tr class="ltx_tr" id="S4.T2.3.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.1.1.3.1.1.1"><span class="ltx_text" id="S4.T2.3.1.1.3.1.1.1.1" style="font-size:90%;">Params</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.1.1.3.1.2.1"><span class="ltx_text" id="S4.T2.3.1.1.3.1.2.1.1" style="font-size:90%;">(M)</span></td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.3.1.1.4.1">
<tr class="ltx_tr" id="S4.T2.3.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.1.1.4.1.1.1"><span class="ltx_text" id="S4.T2.3.1.1.4.1.1.1.1" style="font-size:90%;">Top-1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.1.1.4.1.2.1"><span class="ltx_text" id="S4.T2.3.1.1.4.1.2.1.1" style="font-size:90%;">(%)</span></td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.2.2.1">
<span class="ltx_text" id="S4.T2.3.2.2.1.1" style="font-size:90%;">ResNet-18 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.2.2.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib20" title="">20</a><span class="ltx_text" id="S4.T2.3.2.2.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.2.2.2"><span class="ltx_text" id="S4.T2.3.2.2.2.1" style="font-size:90%;">1.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.2.2.3"><span class="ltx_text" id="S4.T2.3.2.2.3.1" style="font-size:90%;">11.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.2.2.4"><span class="ltx_text" id="S4.T2.3.2.2.4.1" style="font-size:90%;">69.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.3.3.1">
<span class="ltx_text" id="S4.T2.3.3.3.1.1" style="font-size:90%;">PVTv2-b1 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.3.3.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib42" title="">42</a><span class="ltx_text" id="S4.T2.3.3.3.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.3.2"><span class="ltx_text" id="S4.T2.3.3.3.2.1" style="font-size:90%;">2.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.3.3"><span class="ltx_text" id="S4.T2.3.3.3.3.1" style="font-size:90%;">13.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.3.4"><span class="ltx_text" id="S4.T2.3.3.3.4.1" style="font-size:90%;">78.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.4.4.1">
<span class="ltx_text" id="S4.T2.3.4.4.1.1" style="font-size:90%;">Shunted-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.4.4.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib34" title="">34</a><span class="ltx_text" id="S4.T2.3.4.4.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.4.2"><span class="ltx_text" id="S4.T2.3.4.4.2.1" style="font-size:90%;">2.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.4.3"><span class="ltx_text" id="S4.T2.3.4.4.3.1" style="font-size:90%;">11.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.4.4"><span class="ltx_text" id="S4.T2.3.4.4.4.1" style="font-size:90%;">79.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.5.5.1">
<span class="ltx_text" id="S4.T2.3.5.5.1.1" style="font-size:90%;">QuadTree-B-b1 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.5.5.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib37" title="">37</a><span class="ltx_text" id="S4.T2.3.5.5.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.5.2"><span class="ltx_text" id="S4.T2.3.5.5.2.1" style="font-size:90%;">2.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.5.3"><span class="ltx_text" id="S4.T2.3.5.5.3.1" style="font-size:90%;">13.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.5.4"><span class="ltx_text" id="S4.T2.3.5.5.4.1" style="font-size:90%;">80.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.6.6.1">
<span class="ltx_text" id="S4.T2.3.6.6.1.1" style="font-size:90%;">BiFormer-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.6.6.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a><span class="ltx_text" id="S4.T2.3.6.6.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.6.6.2"><span class="ltx_text" id="S4.T2.3.6.6.2.1" style="font-size:90%;">2.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.6.6.3"><span class="ltx_text" id="S4.T2.3.6.6.3.1" style="font-size:90%;">13.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.6.6.4"><span class="ltx_text" id="S4.T2.3.6.6.4.1" style="font-size:90%;">81.4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.7.7.1">
<span class="ltx_text" id="S4.T2.3.7.7.1.1" style="font-size:90%;">Conv2Former-N </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.7.7.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib22" title="">22</a><span class="ltx_text" id="S4.T2.3.7.7.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.7.7.2"><span class="ltx_text" id="S4.T2.3.7.7.2.1" style="font-size:90%;">2.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.7.7.3"><span class="ltx_text" id="S4.T2.3.7.7.3.1" style="font-size:90%;">15.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.7.7.4"><span class="ltx_text" id="S4.T2.3.7.7.4.1" style="font-size:90%;">81.5</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.8.8" style="background-color:#96FFFB;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.8.8.1"><span class="ltx_text" id="S4.T2.3.8.8.1.1" style="font-size:90%;background-color:#96FFFB;">DeBiFormer-T</span></th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.8.8.2"><span class="ltx_text" id="S4.T2.3.8.8.2.1" style="font-size:90%;background-color:#96FFFB;">2.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.8.8.3"><span class="ltx_text" id="S4.T2.3.8.8.3.1" style="font-size:90%;background-color:#96FFFB;">21.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.8.8.4"><span class="ltx_text ltx_font_bold" id="S4.T2.3.8.8.4.1" style="font-size:90%;background-color:#96FFFB;">81.9</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.9.9.1">
<span class="ltx_text" id="S4.T2.3.9.9.1.1" style="font-size:90%;">PVTv2-B3 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.9.9.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib44" title="">44</a><span class="ltx_text" id="S4.T2.3.9.9.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.9.9.2"><span class="ltx_text" id="S4.T2.3.9.9.2.1" style="font-size:90%;">6.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.9.9.3"><span class="ltx_text" id="S4.T2.3.9.9.3.1" style="font-size:90%;">45</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.9.9.4"><span class="ltx_text" id="S4.T2.3.9.9.4.1" style="font-size:90%;">81.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.10.10.1">
<span class="ltx_text" id="S4.T2.3.10.10.1.1" style="font-size:90%;">Swin-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.10.10.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a><span class="ltx_text" id="S4.T2.3.10.10.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.10.10.2"><span class="ltx_text" id="S4.T2.3.10.10.2.1" style="font-size:90%;">4.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.10.10.3"><span class="ltx_text" id="S4.T2.3.10.10.3.1" style="font-size:90%;">29</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.10.10.4"><span class="ltx_text" id="S4.T2.3.10.10.4.1" style="font-size:90%;">81.3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.11.11.1">
<span class="ltx_text" id="S4.T2.3.11.11.1.1" style="font-size:90%;">CSWin-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.11.11.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a><span class="ltx_text" id="S4.T2.3.11.11.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.11.11.2"><span class="ltx_text" id="S4.T2.3.11.11.2.1" style="font-size:90%;">4.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.11.11.3"><span class="ltx_text" id="S4.T2.3.11.11.3.1" style="font-size:90%;">23</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.11.11.4"><span class="ltx_text" id="S4.T2.3.11.11.4.1" style="font-size:90%;">82.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.12.12.1">
<span class="ltx_text" id="S4.T2.3.12.12.1.1" style="font-size:90%;">DAT-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.12.12.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a><span class="ltx_text" id="S4.T2.3.12.12.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.12.12.2"><span class="ltx_text" id="S4.T2.3.12.12.2.1" style="font-size:90%;">4.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.12.12.3"><span class="ltx_text" id="S4.T2.3.12.12.3.1" style="font-size:90%;">29</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.12.12.4"><span class="ltx_text" id="S4.T2.3.12.12.4.1" style="font-size:90%;">82.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.13.13.1">
<span class="ltx_text" id="S4.T2.3.13.13.1.1" style="font-size:90%;">CrossFormer-S </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.13.13.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a><span class="ltx_text" id="S4.T2.3.13.13.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.13.13.2"><span class="ltx_text" id="S4.T2.3.13.13.2.1" style="font-size:90%;">5.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.13.13.3"><span class="ltx_text" id="S4.T2.3.13.13.3.1" style="font-size:90%;">31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.13.13.4"><span class="ltx_text" id="S4.T2.3.13.13.4.1" style="font-size:90%;">82.5</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.14.14.1">
<span class="ltx_text" id="S4.T2.3.14.14.1.1" style="font-size:90%;">RegionViT-S+ </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.14.14.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib2" title="">2</a><span class="ltx_text" id="S4.T2.3.14.14.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.14.14.2"><span class="ltx_text" id="S4.T2.3.14.14.2.1" style="font-size:90%;">5.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.14.14.3"><span class="ltx_text" id="S4.T2.3.14.14.3.1" style="font-size:90%;">31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.14.14.4"><span class="ltx_text" id="S4.T2.3.14.14.4.1" style="font-size:90%;">83.3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.15.15.1">
<span class="ltx_text" id="S4.T2.3.15.15.1.1" style="font-size:90%;">QuadTree-B-b3 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.15.15.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib37" title="">37</a><span class="ltx_text" id="S4.T2.3.15.15.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.15.15.2"><span class="ltx_text" id="S4.T2.3.15.15.2.1" style="font-size:90%;">7.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.15.15.3"><span class="ltx_text" id="S4.T2.3.15.15.3.1" style="font-size:90%;">46</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.15.15.4"><span class="ltx_text" id="S4.T2.3.15.15.4.1" style="font-size:90%;">83.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.16.16.1">
<span class="ltx_text" id="S4.T2.3.16.16.1.1" style="font-size:90%;">MaxViT-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.16.16.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib40" title="">40</a><span class="ltx_text" id="S4.T2.3.16.16.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.16.16.2"><span class="ltx_text" id="S4.T2.3.16.16.2.1" style="font-size:90%;">5.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.16.16.3"><span class="ltx_text" id="S4.T2.3.16.16.3.1" style="font-size:90%;">31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.16.16.4"><span class="ltx_text" id="S4.T2.3.16.16.4.1" style="font-size:90%;">83.6</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.17.17.1">
<span class="ltx_text" id="S4.T2.3.17.17.1.1" style="font-size:90%;">InternImage-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.17.17.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib43" title="">43</a><span class="ltx_text" id="S4.T2.3.17.17.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.17.17.2"><span class="ltx_text" id="S4.T2.3.17.17.2.1" style="font-size:90%;">5.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.17.17.3"><span class="ltx_text" id="S4.T2.3.17.17.3.1" style="font-size:90%;">30</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.17.17.4"><span class="ltx_text" id="S4.T2.3.17.17.4.1" style="font-size:90%;">83.5</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.18.18.1">
<span class="ltx_text" id="S4.T2.3.18.18.1.1" style="font-size:90%;">MixFormer-B4 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.18.18.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib4" title="">4</a><span class="ltx_text" id="S4.T2.3.18.18.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.18.18.2"><span class="ltx_text" id="S4.T2.3.18.18.2.1" style="font-size:90%;">3.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.18.18.3"><span class="ltx_text" id="S4.T2.3.18.18.3.1" style="font-size:90%;">35</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.18.18.4"><span class="ltx_text" id="S4.T2.3.18.18.4.1" style="font-size:90%;">83.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.19.19.1">
<span class="ltx_text" id="S4.T2.3.19.19.1.1" style="font-size:90%;">BiFormer-S </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.19.19.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a><span class="ltx_text" id="S4.T2.3.19.19.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.19.19.2"><span class="ltx_text" id="S4.T2.3.19.19.2.1" style="font-size:90%;">4.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.19.19.3"><span class="ltx_text" id="S4.T2.3.19.19.3.1" style="font-size:90%;">26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.19.19.4"><span class="ltx_text" id="S4.T2.3.19.19.4.1" style="font-size:90%;">83.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.20.20.1">
<span class="ltx_text" id="S4.T2.3.20.20.1.1" style="font-size:90%;">UniRepLKNet-T </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.20.20.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib12" title="">12</a><span class="ltx_text" id="S4.T2.3.20.20.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.20.20.2"><span class="ltx_text" id="S4.T2.3.20.20.2.1" style="font-size:90%;">4.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.20.20.3"><span class="ltx_text" id="S4.T2.3.20.20.3.1" style="font-size:90%;">31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.20.20.4"><span class="ltx_text" id="S4.T2.3.20.20.4.1" style="font-size:90%;">83.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.21.21" style="background-color:#96FFFB;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.3.21.21.1"><span class="ltx_text" id="S4.T2.3.21.21.1.1" style="font-size:90%;background-color:#96FFFB;">DeBiFormer-S</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.3.21.21.2"><span class="ltx_text" id="S4.T2.3.21.21.2.1" style="font-size:90%;background-color:#96FFFB;">5.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.3.21.21.3"><span class="ltx_text" id="S4.T2.3.21.21.3.1" style="font-size:90%;background-color:#96FFFB;">44</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.3.21.21.4"><span class="ltx_text ltx_font_bold" id="S4.T2.3.21.21.4.1" style="font-size:90%;background-color:#96FFFB;">83.9</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T2.4" style="width:203.8pt;">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.1.1.1"><span class="ltx_text" id="S4.T2.4.1.1.1.1" style="font-size:90%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.1.2.1">
<tr class="ltx_tr" id="S4.T2.4.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.1.2.1.1.1"><span class="ltx_text" id="S4.T2.4.1.1.2.1.1.1.1" style="font-size:90%;">FLOPs</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.1.2.1.2.1"><span class="ltx_text" id="S4.T2.4.1.1.2.1.2.1.1" style="font-size:90%;">(G)</span></td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.1.3.1">
<tr class="ltx_tr" id="S4.T2.4.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.1.3.1.1.1"><span class="ltx_text" id="S4.T2.4.1.1.3.1.1.1.1" style="font-size:90%;">Params</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.1.3.1.2.1"><span class="ltx_text" id="S4.T2.4.1.1.3.1.2.1.1" style="font-size:90%;">(M)</span></td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.4.1.1.4.1">
<tr class="ltx_tr" id="S4.T2.4.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.1.4.1.1.1"><span class="ltx_text" id="S4.T2.4.1.1.4.1.1.1.1" style="font-size:90%;">Top-1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.4.1.1.4.1.2.1"><span class="ltx_text" id="S4.T2.4.1.1.4.1.2.1.1" style="font-size:90%;">(%)</span></td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.2.1.1">
<span class="ltx_text" id="S4.T2.4.2.1.1.1" style="font-size:90%;">ConvNeXt-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.2.1.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib30" title="">30</a><span class="ltx_text" id="S4.T2.4.2.1.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.2"><span class="ltx_text" id="S4.T2.4.2.1.2.1" style="font-size:90%;">15.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.3"><span class="ltx_text" id="S4.T2.4.2.1.3.1" style="font-size:90%;">89</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.2.1.4"><span class="ltx_text" id="S4.T2.4.2.1.4.1" style="font-size:90%;">83.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.3.2.1">
<span class="ltx_text" id="S4.T2.4.3.2.1.1" style="font-size:90%;">SLaK-S </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.3.2.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib27" title="">27</a><span class="ltx_text" id="S4.T2.4.3.2.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.2"><span class="ltx_text" id="S4.T2.4.3.2.2.1" style="font-size:90%;">9.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.3"><span class="ltx_text" id="S4.T2.4.3.2.3.1" style="font-size:90%;">55</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.4"><span class="ltx_text" id="S4.T2.4.3.2.4.1" style="font-size:90%;">83.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.4.3.1">
<span class="ltx_text" id="S4.T2.4.4.3.1.1" style="font-size:90%;">Twins-SVT-L </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.4.3.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib7" title="">7</a><span class="ltx_text" id="S4.T2.4.4.3.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.3.2"><span class="ltx_text" id="S4.T2.4.4.3.2.1" style="font-size:90%;">14.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.3.3"><span class="ltx_text" id="S4.T2.4.4.3.3.1" style="font-size:90%;">99</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.3.4"><span class="ltx_text" id="S4.T2.4.4.3.4.1" style="font-size:90%;">83.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.5.4.1">
<span class="ltx_text" id="S4.T2.4.5.4.1.1" style="font-size:90%;">PVTv2-B5 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.5.4.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib44" title="">44</a><span class="ltx_text" id="S4.T2.4.5.4.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.4.2"><span class="ltx_text" id="S4.T2.4.5.4.2.1" style="font-size:90%;">11.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.4.3"><span class="ltx_text" id="S4.T2.4.5.4.3.1" style="font-size:90%;">82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.4.4"><span class="ltx_text" id="S4.T2.4.5.4.4.1" style="font-size:90%;">83.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.6.5.1">
<span class="ltx_text" id="S4.T2.4.6.5.1.1" style="font-size:90%;">Swin-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.6.5.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a><span class="ltx_text" id="S4.T2.4.6.5.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.5.2"><span class="ltx_text" id="S4.T2.4.6.5.2.1" style="font-size:90%;">15.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.5.3"><span class="ltx_text" id="S4.T2.4.6.5.3.1" style="font-size:90%;">88</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.6.5.4"><span class="ltx_text" id="S4.T2.4.6.5.4.1" style="font-size:90%;">83.5</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.7.6.1">
<span class="ltx_text" id="S4.T2.4.7.6.1.1" style="font-size:90%;">Focal-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.7.6.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib49" title="">49</a><span class="ltx_text" id="S4.T2.4.7.6.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.6.2"><span class="ltx_text" id="S4.T2.4.7.6.2.1" style="font-size:90%;">16.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.6.3"><span class="ltx_text" id="S4.T2.4.7.6.3.1" style="font-size:90%;">90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.6.4"><span class="ltx_text" id="S4.T2.4.7.6.4.1" style="font-size:90%;">84.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.8.7.1">
<span class="ltx_text" id="S4.T2.4.8.7.1.1" style="font-size:90%;">CSWin-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.8.7.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a><span class="ltx_text" id="S4.T2.4.8.7.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.7.2"><span class="ltx_text" id="S4.T2.4.8.7.2.1" style="font-size:90%;">15.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.7.3"><span class="ltx_text" id="S4.T2.4.8.7.3.1" style="font-size:90%;">78</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.7.4"><span class="ltx_text" id="S4.T2.4.8.7.4.1" style="font-size:90%;">84.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.9.8.1">
<span class="ltx_text" id="S4.T2.4.9.8.1.1" style="font-size:90%;">Shunted-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.9.8.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib34" title="">34</a><span class="ltx_text" id="S4.T2.4.9.8.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.8.2"><span class="ltx_text" id="S4.T2.4.9.8.2.1" style="font-size:90%;">8.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.8.3"><span class="ltx_text" id="S4.T2.4.9.8.3.1" style="font-size:90%;">39</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.9.8.4"><span class="ltx_text" id="S4.T2.4.9.8.4.1" style="font-size:90%;">84.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.10.9.1">
<span class="ltx_text" id="S4.T2.4.10.9.1.1" style="font-size:90%;">UniFormer-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.10.9.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib26" title="">26</a><span class="ltx_text" id="S4.T2.4.10.9.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.9.2"><span class="ltx_text" id="S4.T2.4.10.9.2.1" style="font-size:90%;">8.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.9.3"><span class="ltx_text" id="S4.T2.4.10.9.3.1" style="font-size:90%;">50.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.9.4"><span class="ltx_text" id="S4.T2.4.10.9.4.1" style="font-size:90%;">83.9</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.11.10.1">
<span class="ltx_text" id="S4.T2.4.11.10.1.1" style="font-size:90%;">ScalableViT-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.11.10.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib51" title="">51</a><span class="ltx_text" id="S4.T2.4.11.10.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.10.2"><span class="ltx_text" id="S4.T2.4.11.10.2.1" style="font-size:90%;">8.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.10.3"><span class="ltx_text" id="S4.T2.4.11.10.3.1" style="font-size:90%;">81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.10.4"><span class="ltx_text" id="S4.T2.4.11.10.4.1" style="font-size:90%;">84.1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.12.11.1">
<span class="ltx_text" id="S4.T2.4.12.11.1.1" style="font-size:90%;">Slide-Swin-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.12.11.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib33" title="">33</a><span class="ltx_text" id="S4.T2.4.12.11.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.11.2"><span class="ltx_text" id="S4.T2.4.12.11.2.1" style="font-size:90%;">15.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.11.3"><span class="ltx_text" id="S4.T2.4.12.11.3.1" style="font-size:90%;">89.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.12.11.4"><span class="ltx_text" id="S4.T2.4.12.11.4.1" style="font-size:90%;">84.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.13.12.1">
<span class="ltx_text" id="S4.T2.4.13.12.1.1" style="font-size:90%;">DAT-S </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.13.12.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a><span class="ltx_text" id="S4.T2.4.13.12.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.12.2"><span class="ltx_text" id="S4.T2.4.13.12.2.1" style="font-size:90%;">9.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.12.3"><span class="ltx_text" id="S4.T2.4.13.12.3.1" style="font-size:90%;">50</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.12.4"><span class="ltx_text" id="S4.T2.4.13.12.4.1" style="font-size:90%;">83.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.14.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.14.13.1">
<span class="ltx_text" id="S4.T2.4.14.13.1.1" style="font-size:90%;">QuadTree-B-b4</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.14.13.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib37" title="">37</a><span class="ltx_text" id="S4.T2.4.14.13.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.13.2"><span class="ltx_text" id="S4.T2.4.14.13.2.1" style="font-size:90%;">11.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.13.3"><span class="ltx_text" id="S4.T2.4.14.13.3.1" style="font-size:90%;">64</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.13.4"><span class="ltx_text" id="S4.T2.4.14.13.4.1" style="font-size:90%;">84.1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.15.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.15.14.1">
<span class="ltx_text" id="S4.T2.4.15.14.1.1" style="font-size:90%;">CrossFormer-L </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.15.14.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a><span class="ltx_text" id="S4.T2.4.15.14.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.14.2"><span class="ltx_text" id="S4.T2.4.15.14.2.1" style="font-size:90%;">16.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.14.3"><span class="ltx_text" id="S4.T2.4.15.14.3.1" style="font-size:90%;">92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.15.14.4"><span class="ltx_text" id="S4.T2.4.15.14.4.1" style="font-size:90%;">84.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.16.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.16.15.1">
<span class="ltx_text" id="S4.T2.4.16.15.1.1" style="font-size:90%;">RegionViT-B+ </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.16.15.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib2" title="">2</a><span class="ltx_text" id="S4.T2.4.16.15.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.15.2"><span class="ltx_text" id="S4.T2.4.16.15.2.1" style="font-size:90%;">13.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.15.3"><span class="ltx_text" id="S4.T2.4.16.15.3.1" style="font-size:90%;">74</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.15.4"><span class="ltx_text" id="S4.T2.4.16.15.4.1" style="font-size:90%;">83.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.17.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.17.16.1">
<span class="ltx_text" id="S4.T2.4.17.16.1.1" style="font-size:90%;">InternImage-S </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.17.16.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib43" title="">43</a><span class="ltx_text" id="S4.T2.4.17.16.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.16.2"><span class="ltx_text" id="S4.T2.4.17.16.2.1" style="font-size:90%;">8.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.16.3"><span class="ltx_text" id="S4.T2.4.17.16.3.1" style="font-size:90%;">50</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.16.4"><span class="ltx_text" id="S4.T2.4.17.16.4.1" style="font-size:90%;">84.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.18.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.18.17.1">
<span class="ltx_text" id="S4.T2.4.18.17.1.1" style="font-size:90%;">MixFormer-B6 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.18.17.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib4" title="">4</a><span class="ltx_text" id="S4.T2.4.18.17.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.18.17.2"><span class="ltx_text" id="S4.T2.4.18.17.2.1" style="font-size:90%;">12.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.18.17.3"><span class="ltx_text" id="S4.T2.4.18.17.3.1" style="font-size:90%;">119</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.18.17.4"><span class="ltx_text" id="S4.T2.4.18.17.4.1" style="font-size:90%;">83.8</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.19.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.19.18.1">
<span class="ltx_text" id="S4.T2.4.19.18.1.1" style="font-size:90%;">BiFormer-B </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.19.18.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a><span class="ltx_text" id="S4.T2.4.19.18.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.18.2"><span class="ltx_text" id="S4.T2.4.19.18.2.1" style="font-size:90%;">9.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.18.3"><span class="ltx_text" id="S4.T2.4.19.18.3.1" style="font-size:90%;">57</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.18.4"><span class="ltx_text" id="S4.T2.4.19.18.4.1" style="font-size:90%;">84.3</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.20.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.20.19.1">
<span class="ltx_text" id="S4.T2.4.20.19.1.1" style="font-size:90%;">UniRepLKNet-S </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.4.20.19.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib12" title="">12</a><span class="ltx_text" id="S4.T2.4.20.19.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.19.2"><span class="ltx_text" id="S4.T2.4.20.19.2.1" style="font-size:90%;">9.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.19.3"><span class="ltx_text" id="S4.T2.4.20.19.3.1" style="font-size:90%;">56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.20.19.4"><span class="ltx_text" id="S4.T2.4.20.19.4.1" style="font-size:90%;">83.9</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.21.20" style="background-color:#96FFFB;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.4.21.20.1"><span class="ltx_text" id="S4.T2.4.21.20.1.1" style="font-size:90%;background-color:#96FFFB;">DeBiFormer-B</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.21.20.2"><span class="ltx_text" id="S4.T2.4.21.20.2.1" style="font-size:90%;background-color:#96FFFB;">11.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.21.20.3"><span class="ltx_text" id="S4.T2.4.21.20.3.1" style="font-size:90%;background-color:#96FFFB;">77</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.4.21.20.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.21.20.4.1" style="font-size:90%;background-color:#96FFFB;">84.4</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Evaluating and comparing different backbones on ImageNet-1K on images with resolution of <math alttext="224\times 224" class="ltx_Math" display="inline" id="S4.T2.2.m1.1"><semantics id="S4.T2.2.m1.1b"><mrow id="S4.T2.2.m1.1.1" xref="S4.T2.2.m1.1.1.cmml"><mn id="S4.T2.2.m1.1.1.2" xref="S4.T2.2.m1.1.1.2.cmml">224</mn><mo id="S4.T2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T2.2.m1.1.1.1.cmml">×</mo><mn id="S4.T2.2.m1.1.1.3" xref="S4.T2.2.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.m1.1c"><apply id="S4.T2.2.m1.1.1.cmml" xref="S4.T2.2.m1.1.1"><times id="S4.T2.2.m1.1.1.1.cmml" xref="S4.T2.2.m1.1.1.1"></times><cn id="S4.T2.2.m1.1.1.2.cmml" type="integer" xref="S4.T2.2.m1.1.1.2">224</cn><cn id="S4.T2.2.m1.1.1.3.cmml" type="integer" xref="S4.T2.2.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.m1.1d">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.m1.1e">224 × 224</annotation></semantics></math>.</figcaption>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We experimentally evaluated the effectiveness of our proposed DeBiFormer on various mainstream computer vision tasks, including image classification (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS1" title="4.1 Image classification on ImageNet-1K ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">4.1</span></a>), semantic segmentation (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS2" title="4.2 Semantic segmentation on ADE20K ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">4.2</span></a>) and object detection and instance segmentation (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS3" title="4.3 Object detection and instance segmentation ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">4.3</span></a>). In our approach, we commence training from scratch on ImageNet-1K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib35" title="">35</a>]</cite> for image classification. Subsequently, we fine-tune the pre-trained backbones on ADE20K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib55" title="">55</a>]</cite> for semantic segmentation and on COCO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib17" title="">17</a>]</cite> for object detection and instance segmentation. Furthermore, we perform an ablation study to confirm the efficacy of the proposed Deformable Bi-level Routing Attention and top-k choices of DeBiFormer (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.SS4" title="4.4 Ablation study ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">4.4</span></a>). Finally, in order to validate that the recognition ability and interpretability of our DeBiFormer, we visualize the attention map (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S5" title="5 Grad-CAM Visualization ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Image classification on ImageNet-1K</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.3.1">Settings.</span>
We conducted image classification experiments on the ImageNet-1K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib35" title="">35</a>]</cite> dataset, following the experimental settings of DeiT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib39" title="">39</a>]</cite> for a fair comparison. Specifically, each model was trained for 300 epochs on 8 V100 GPUs with an input size of <math alttext="224\times 224" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">224</mn><mo id="S4.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><cn id="S4.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.2">224</cn><cn id="S4.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">224 × 224</annotation></semantics></math>. We used AdamW as the optimizer with a weight decay of <math alttext="0.05" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn id="S4.SS1.p1.2.m2.1.1.cmml" type="float" xref="S4.SS1.p1.2.m2.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">0.05</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">0.05</annotation></semantics></math> and used a cosine decay learning rate schedule with an initial learning rate of <math alttext="0.001" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><cn id="S4.SS1.p1.3.m3.1.1.cmml" type="float" xref="S4.SS1.p1.3.m3.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">0.001</annotation></semantics></math>, while the first five epochs were used for linear warm-up. The batch size was set to 1024. To avoid overfitting, we used regularization techniques including RandAugment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib9" title="">9</a>]</cite> (rand-m9-mstd0.5-inc1), MixUp <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib54" title="">54</a>]</cite> (prob = 0.8), CutMix <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib52" title="">52</a>]</cite> (prob = 1.0), Random Erasing (prob = 0.25), and increasing stochastic depth <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib23" title="">23</a>]</cite> (prob = 0.1/0.2/0.4 for DeBiFormer-T/S/B, respectively).

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.3.2">Results.</span>
We report our results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.T2" title="Table 2 ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">2</span></a> showing the top-1 accuracy with similar computational complexities. Our DeBiFormer outperformed the Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>, PVT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib44" title="">44</a>]</cite>, DeiT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib39" title="">39</a>]</cite>, DAT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>, and Biformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite> in all three scales. Without inserting convolutions in Transformer blocks or using overlapped convolutions in patch embeddings, DeBiFormer achieved gains of 0.5pt, 0.1pt and 0.1pt over BiFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite> counterparts.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Semantic segmentation on ADE20K</h3>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.1.1.1.1">Backbone</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1.2">Semantic-FPN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.3">UperNet</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.2.2.1">mIoU(%)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.2.2.2">mIoU(%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.3.3.1">Swin-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.3.3.2">41.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.3.3.3">44.5</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.4.4.1">DAT-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.4.4.2">42.6</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.4.3">45.5</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.5.5.1">CSWin-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.5.5.2">48.2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.5.5.3">49.3</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.6.6.1">RegionViT-S+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib2" title="">2</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.6.6.2">45.3</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.6.6.3">-</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.7.7.1">InternImage-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib43" title="">43</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.7.7.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.7.7.3">47.9</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.8.8.1">CrossFormer-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.8.8.2">46.0</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.8.8.3">47.6</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.9.9.1">Uniformer-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.9.9.2">46.6</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.9.9.3">47.6</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.10.10.1">Shunted-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib34" title="">34</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.10.10.2">48.2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.10.10.3">48.9</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.11.11.1">BiFormer-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.11.11.2">48.9</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.11.11.3">49.8</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.12.12" style="background-color:#96FFFB;">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.12.12.1"><span class="ltx_text" id="S4.T3.1.12.12.1.1" style="background-color:#96FFFB;">DeBiFormer-S</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.12.12.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.12.12.2.1" style="background-color:#96FFFB;">49.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.12.12.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.12.12.3.1" style="background-color:#96FFFB;">50.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.13.13">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.13.13.1">Swin-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.13.13.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.13.13.3">47.6</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.14.14.1">DAT-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.14.14.2">46.1</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.14.14.3">48.3</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.15.15">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.15.15.1">CSWin-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.15.15.2">49.2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.15.15.3">50.4</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.16.16">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.16.16.1">RegionViT-B+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib2" title="">2</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.16.16.2">47.5</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.16.16.3">-</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.17.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.17.17.1">InternImage-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib43" title="">43</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.17.17.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.17.17.3">50.1</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.18.18">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.18.18.1">CrossFormer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.18.18.2">47.7</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.18.18.3">49.7</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.19.19">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.19.19.1">Uniformer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.19.19.2">48.0</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.19.19.3">50.0</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.20.20">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.20.20.1">BiFormer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.20.20.2">49.9</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.20.20.3">51.0</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.21.21" style="background-color:#96FFFB;">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.21.21.1"><span class="ltx_text" id="S4.T3.1.21.21.1.1" style="background-color:#96FFFB;">DeBiFormer-B</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.21.21.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.21.21.2.1" style="background-color:#96FFFB;">50.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.21.21.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.21.21.3.1" style="background-color:#96FFFB;">51.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Evaluating DeBiFormer on semantic segmentation with two segmentation heads (Semantic FPN and UpperNet) on ADE20K dataset.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">Settings.</span>
The same as existing works, we used our DeBiFormer on SemanticFPN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib46" title="">46</a>]</cite> and UperNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib48" title="">48</a>]</cite>. In both cases, the backbone was initialized with ImageNet-1K pretrained weights. The optimizer was AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib31" title="">31</a>]</cite>, and the batch size was 32. For a fair comparison, we followed the same setting as PVT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib44" title="">44</a>]</cite> to train the model with 80k steps and Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite> to train the model with 160k steps.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.2">Results.</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.T8" title="Table 8 ‣ 7.3 Computational complexity ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">8</span></a> shows the results of the two different frameworks. It shows that with the Semantic FPN framework, our DeBiFormer-S/B achieved 49.2/50.6 mIoU, respectively, improving BiFormer by 0.3pt./0.7pt. A similar performance gain for the UperNet framework was also observed. By utilizing the DBRA module, our DeBiFormer could caputure the most semantic key-value pairs, which makes the attention selection more reasonable and achieve higher performance on downstream semantic tasks.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.12" style="width:512.9pt;height:373.5pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-28.5pt,20.7pt) scale(0.9,0.9) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.12.12">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.12.12.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.12.12.13.1.1" rowspan="2"><span class="ltx_text" id="S4.T4.12.12.13.1.1.1">Backbone</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="6" id="S4.T4.12.12.13.1.2">RetinaNet 1× schedule</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="6" id="S4.T4.12.12.13.1.3">Mask R-CNN 1× schedule</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.12">
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1"><math alttext="mAP" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2.cmml">m</mi><mo id="S4.T4.1.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml">A</mi><mo id="S4.T4.1.1.1.1.m1.1.1.1a" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.T4.1.1.1.1.m1.1.1.4" xref="S4.T4.1.1.1.1.m1.1.1.4.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><times id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.1"></times><ci id="S4.T4.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2">𝑚</ci><ci id="S4.T4.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3">𝐴</ci><ci id="S4.T4.1.1.1.1.m1.1.1.4.cmml" xref="S4.T4.1.1.1.1.m1.1.1.4">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">mAP</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">italic_m italic_A italic_P</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.2.2"><math alttext="AP_{50}" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.m1.1"><semantics id="S4.T4.2.2.2.2.m1.1a"><mrow id="S4.T4.2.2.2.2.m1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.cmml"><mi id="S4.T4.2.2.2.2.m1.1.1.2" xref="S4.T4.2.2.2.2.m1.1.1.2.cmml">A</mi><mo id="S4.T4.2.2.2.2.m1.1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.1.cmml">⁢</mo><msub id="S4.T4.2.2.2.2.m1.1.1.3" xref="S4.T4.2.2.2.2.m1.1.1.3.cmml"><mi id="S4.T4.2.2.2.2.m1.1.1.3.2" xref="S4.T4.2.2.2.2.m1.1.1.3.2.cmml">P</mi><mn id="S4.T4.2.2.2.2.m1.1.1.3.3" xref="S4.T4.2.2.2.2.m1.1.1.3.3.cmml">50</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m1.1b"><apply id="S4.T4.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1"><times id="S4.T4.2.2.2.2.m1.1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1.1"></times><ci id="S4.T4.2.2.2.2.m1.1.1.2.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2">𝐴</ci><apply id="S4.T4.2.2.2.2.m1.1.1.3.cmml" xref="S4.T4.2.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.2.2.2.2.m1.1.1.3.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1.3">subscript</csymbol><ci id="S4.T4.2.2.2.2.m1.1.1.3.2.cmml" xref="S4.T4.2.2.2.2.m1.1.1.3.2">𝑃</ci><cn id="S4.T4.2.2.2.2.m1.1.1.3.3.cmml" type="integer" xref="S4.T4.2.2.2.2.m1.1.1.3.3">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m1.1c">AP_{50}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.m1.1d">italic_A italic_P start_POSTSUBSCRIPT 50 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.3.3.3.3"><math alttext="AP_{75}" class="ltx_Math" display="inline" id="S4.T4.3.3.3.3.m1.1"><semantics id="S4.T4.3.3.3.3.m1.1a"><mrow id="S4.T4.3.3.3.3.m1.1.1" xref="S4.T4.3.3.3.3.m1.1.1.cmml"><mi id="S4.T4.3.3.3.3.m1.1.1.2" xref="S4.T4.3.3.3.3.m1.1.1.2.cmml">A</mi><mo id="S4.T4.3.3.3.3.m1.1.1.1" xref="S4.T4.3.3.3.3.m1.1.1.1.cmml">⁢</mo><msub id="S4.T4.3.3.3.3.m1.1.1.3" xref="S4.T4.3.3.3.3.m1.1.1.3.cmml"><mi id="S4.T4.3.3.3.3.m1.1.1.3.2" xref="S4.T4.3.3.3.3.m1.1.1.3.2.cmml">P</mi><mn id="S4.T4.3.3.3.3.m1.1.1.3.3" xref="S4.T4.3.3.3.3.m1.1.1.3.3.cmml">75</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.3.m1.1b"><apply id="S4.T4.3.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1"><times id="S4.T4.3.3.3.3.m1.1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1.1"></times><ci id="S4.T4.3.3.3.3.m1.1.1.2.cmml" xref="S4.T4.3.3.3.3.m1.1.1.2">𝐴</ci><apply id="S4.T4.3.3.3.3.m1.1.1.3.cmml" xref="S4.T4.3.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.3.3.3.3.m1.1.1.3.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1.3">subscript</csymbol><ci id="S4.T4.3.3.3.3.m1.1.1.3.2.cmml" xref="S4.T4.3.3.3.3.m1.1.1.3.2">𝑃</ci><cn id="S4.T4.3.3.3.3.m1.1.1.3.3.cmml" type="integer" xref="S4.T4.3.3.3.3.m1.1.1.3.3">75</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.3.m1.1c">AP_{75}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.3.3.m1.1d">italic_A italic_P start_POSTSUBSCRIPT 75 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.4.4"><math alttext="AP_{S}" class="ltx_Math" display="inline" id="S4.T4.4.4.4.4.m1.1"><semantics id="S4.T4.4.4.4.4.m1.1a"><mrow id="S4.T4.4.4.4.4.m1.1.1" xref="S4.T4.4.4.4.4.m1.1.1.cmml"><mi id="S4.T4.4.4.4.4.m1.1.1.2" xref="S4.T4.4.4.4.4.m1.1.1.2.cmml">A</mi><mo id="S4.T4.4.4.4.4.m1.1.1.1" xref="S4.T4.4.4.4.4.m1.1.1.1.cmml">⁢</mo><msub id="S4.T4.4.4.4.4.m1.1.1.3" xref="S4.T4.4.4.4.4.m1.1.1.3.cmml"><mi id="S4.T4.4.4.4.4.m1.1.1.3.2" xref="S4.T4.4.4.4.4.m1.1.1.3.2.cmml">P</mi><mi id="S4.T4.4.4.4.4.m1.1.1.3.3" xref="S4.T4.4.4.4.4.m1.1.1.3.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.4.m1.1b"><apply id="S4.T4.4.4.4.4.m1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1"><times id="S4.T4.4.4.4.4.m1.1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1.1"></times><ci id="S4.T4.4.4.4.4.m1.1.1.2.cmml" xref="S4.T4.4.4.4.4.m1.1.1.2">𝐴</ci><apply id="S4.T4.4.4.4.4.m1.1.1.3.cmml" xref="S4.T4.4.4.4.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.4.4.4.4.m1.1.1.3.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1.3">subscript</csymbol><ci id="S4.T4.4.4.4.4.m1.1.1.3.2.cmml" xref="S4.T4.4.4.4.4.m1.1.1.3.2">𝑃</ci><ci id="S4.T4.4.4.4.4.m1.1.1.3.3.cmml" xref="S4.T4.4.4.4.4.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.4.m1.1c">AP_{S}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.4.4.m1.1d">italic_A italic_P start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.5.5.5.5"><math alttext="AP_{M}" class="ltx_Math" display="inline" id="S4.T4.5.5.5.5.m1.1"><semantics id="S4.T4.5.5.5.5.m1.1a"><mrow id="S4.T4.5.5.5.5.m1.1.1" xref="S4.T4.5.5.5.5.m1.1.1.cmml"><mi id="S4.T4.5.5.5.5.m1.1.1.2" xref="S4.T4.5.5.5.5.m1.1.1.2.cmml">A</mi><mo id="S4.T4.5.5.5.5.m1.1.1.1" xref="S4.T4.5.5.5.5.m1.1.1.1.cmml">⁢</mo><msub id="S4.T4.5.5.5.5.m1.1.1.3" xref="S4.T4.5.5.5.5.m1.1.1.3.cmml"><mi id="S4.T4.5.5.5.5.m1.1.1.3.2" xref="S4.T4.5.5.5.5.m1.1.1.3.2.cmml">P</mi><mi id="S4.T4.5.5.5.5.m1.1.1.3.3" xref="S4.T4.5.5.5.5.m1.1.1.3.3.cmml">M</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.5.m1.1b"><apply id="S4.T4.5.5.5.5.m1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1"><times id="S4.T4.5.5.5.5.m1.1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1.1"></times><ci id="S4.T4.5.5.5.5.m1.1.1.2.cmml" xref="S4.T4.5.5.5.5.m1.1.1.2">𝐴</ci><apply id="S4.T4.5.5.5.5.m1.1.1.3.cmml" xref="S4.T4.5.5.5.5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.5.5.5.5.m1.1.1.3.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1.3">subscript</csymbol><ci id="S4.T4.5.5.5.5.m1.1.1.3.2.cmml" xref="S4.T4.5.5.5.5.m1.1.1.3.2">𝑃</ci><ci id="S4.T4.5.5.5.5.m1.1.1.3.3.cmml" xref="S4.T4.5.5.5.5.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.5.m1.1c">AP_{M}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.5.5.5.m1.1d">italic_A italic_P start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.6.6.6.6"><math alttext="AP_{L}" class="ltx_Math" display="inline" id="S4.T4.6.6.6.6.m1.1"><semantics id="S4.T4.6.6.6.6.m1.1a"><mrow id="S4.T4.6.6.6.6.m1.1.1" xref="S4.T4.6.6.6.6.m1.1.1.cmml"><mi id="S4.T4.6.6.6.6.m1.1.1.2" xref="S4.T4.6.6.6.6.m1.1.1.2.cmml">A</mi><mo id="S4.T4.6.6.6.6.m1.1.1.1" xref="S4.T4.6.6.6.6.m1.1.1.1.cmml">⁢</mo><msub id="S4.T4.6.6.6.6.m1.1.1.3" xref="S4.T4.6.6.6.6.m1.1.1.3.cmml"><mi id="S4.T4.6.6.6.6.m1.1.1.3.2" xref="S4.T4.6.6.6.6.m1.1.1.3.2.cmml">P</mi><mi id="S4.T4.6.6.6.6.m1.1.1.3.3" xref="S4.T4.6.6.6.6.m1.1.1.3.3.cmml">L</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.6.m1.1b"><apply id="S4.T4.6.6.6.6.m1.1.1.cmml" xref="S4.T4.6.6.6.6.m1.1.1"><times id="S4.T4.6.6.6.6.m1.1.1.1.cmml" xref="S4.T4.6.6.6.6.m1.1.1.1"></times><ci id="S4.T4.6.6.6.6.m1.1.1.2.cmml" xref="S4.T4.6.6.6.6.m1.1.1.2">𝐴</ci><apply id="S4.T4.6.6.6.6.m1.1.1.3.cmml" xref="S4.T4.6.6.6.6.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.6.6.6.6.m1.1.1.3.1.cmml" xref="S4.T4.6.6.6.6.m1.1.1.3">subscript</csymbol><ci id="S4.T4.6.6.6.6.m1.1.1.3.2.cmml" xref="S4.T4.6.6.6.6.m1.1.1.3.2">𝑃</ci><ci id="S4.T4.6.6.6.6.m1.1.1.3.3.cmml" xref="S4.T4.6.6.6.6.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.6.m1.1c">AP_{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.6.6.6.6.m1.1d">italic_A italic_P start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.7.7.7.7"><math alttext="mAP^{b}" class="ltx_Math" display="inline" id="S4.T4.7.7.7.7.m1.1"><semantics id="S4.T4.7.7.7.7.m1.1a"><mrow id="S4.T4.7.7.7.7.m1.1.1" xref="S4.T4.7.7.7.7.m1.1.1.cmml"><mi id="S4.T4.7.7.7.7.m1.1.1.2" xref="S4.T4.7.7.7.7.m1.1.1.2.cmml">m</mi><mo id="S4.T4.7.7.7.7.m1.1.1.1" xref="S4.T4.7.7.7.7.m1.1.1.1.cmml">⁢</mo><mi id="S4.T4.7.7.7.7.m1.1.1.3" xref="S4.T4.7.7.7.7.m1.1.1.3.cmml">A</mi><mo id="S4.T4.7.7.7.7.m1.1.1.1a" xref="S4.T4.7.7.7.7.m1.1.1.1.cmml">⁢</mo><msup id="S4.T4.7.7.7.7.m1.1.1.4" xref="S4.T4.7.7.7.7.m1.1.1.4.cmml"><mi id="S4.T4.7.7.7.7.m1.1.1.4.2" xref="S4.T4.7.7.7.7.m1.1.1.4.2.cmml">P</mi><mi id="S4.T4.7.7.7.7.m1.1.1.4.3" xref="S4.T4.7.7.7.7.m1.1.1.4.3.cmml">b</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.7.7.m1.1b"><apply id="S4.T4.7.7.7.7.m1.1.1.cmml" xref="S4.T4.7.7.7.7.m1.1.1"><times id="S4.T4.7.7.7.7.m1.1.1.1.cmml" xref="S4.T4.7.7.7.7.m1.1.1.1"></times><ci id="S4.T4.7.7.7.7.m1.1.1.2.cmml" xref="S4.T4.7.7.7.7.m1.1.1.2">𝑚</ci><ci id="S4.T4.7.7.7.7.m1.1.1.3.cmml" xref="S4.T4.7.7.7.7.m1.1.1.3">𝐴</ci><apply id="S4.T4.7.7.7.7.m1.1.1.4.cmml" xref="S4.T4.7.7.7.7.m1.1.1.4"><csymbol cd="ambiguous" id="S4.T4.7.7.7.7.m1.1.1.4.1.cmml" xref="S4.T4.7.7.7.7.m1.1.1.4">superscript</csymbol><ci id="S4.T4.7.7.7.7.m1.1.1.4.2.cmml" xref="S4.T4.7.7.7.7.m1.1.1.4.2">𝑃</ci><ci id="S4.T4.7.7.7.7.m1.1.1.4.3.cmml" xref="S4.T4.7.7.7.7.m1.1.1.4.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.7.7.m1.1c">mAP^{b}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.7.7.7.7.m1.1d">italic_m italic_A italic_P start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.8.8.8"><math alttext="AP^{b}_{50}" class="ltx_Math" display="inline" id="S4.T4.8.8.8.8.m1.1"><semantics id="S4.T4.8.8.8.8.m1.1a"><mrow id="S4.T4.8.8.8.8.m1.1.1" xref="S4.T4.8.8.8.8.m1.1.1.cmml"><mi id="S4.T4.8.8.8.8.m1.1.1.2" xref="S4.T4.8.8.8.8.m1.1.1.2.cmml">A</mi><mo id="S4.T4.8.8.8.8.m1.1.1.1" xref="S4.T4.8.8.8.8.m1.1.1.1.cmml">⁢</mo><msubsup id="S4.T4.8.8.8.8.m1.1.1.3" xref="S4.T4.8.8.8.8.m1.1.1.3.cmml"><mi id="S4.T4.8.8.8.8.m1.1.1.3.2.2" xref="S4.T4.8.8.8.8.m1.1.1.3.2.2.cmml">P</mi><mn id="S4.T4.8.8.8.8.m1.1.1.3.3" xref="S4.T4.8.8.8.8.m1.1.1.3.3.cmml">50</mn><mi id="S4.T4.8.8.8.8.m1.1.1.3.2.3" xref="S4.T4.8.8.8.8.m1.1.1.3.2.3.cmml">b</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.8.8.m1.1b"><apply id="S4.T4.8.8.8.8.m1.1.1.cmml" xref="S4.T4.8.8.8.8.m1.1.1"><times id="S4.T4.8.8.8.8.m1.1.1.1.cmml" xref="S4.T4.8.8.8.8.m1.1.1.1"></times><ci id="S4.T4.8.8.8.8.m1.1.1.2.cmml" xref="S4.T4.8.8.8.8.m1.1.1.2">𝐴</ci><apply id="S4.T4.8.8.8.8.m1.1.1.3.cmml" xref="S4.T4.8.8.8.8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.8.8.8.8.m1.1.1.3.1.cmml" xref="S4.T4.8.8.8.8.m1.1.1.3">subscript</csymbol><apply id="S4.T4.8.8.8.8.m1.1.1.3.2.cmml" xref="S4.T4.8.8.8.8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.8.8.8.8.m1.1.1.3.2.1.cmml" xref="S4.T4.8.8.8.8.m1.1.1.3">superscript</csymbol><ci id="S4.T4.8.8.8.8.m1.1.1.3.2.2.cmml" xref="S4.T4.8.8.8.8.m1.1.1.3.2.2">𝑃</ci><ci id="S4.T4.8.8.8.8.m1.1.1.3.2.3.cmml" xref="S4.T4.8.8.8.8.m1.1.1.3.2.3">𝑏</ci></apply><cn id="S4.T4.8.8.8.8.m1.1.1.3.3.cmml" type="integer" xref="S4.T4.8.8.8.8.m1.1.1.3.3">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.8.8.m1.1c">AP^{b}_{50}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.8.8.8.8.m1.1d">italic_A italic_P start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 50 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.9.9.9.9"><math alttext="AP^{b}_{75}" class="ltx_Math" display="inline" id="S4.T4.9.9.9.9.m1.1"><semantics id="S4.T4.9.9.9.9.m1.1a"><mrow id="S4.T4.9.9.9.9.m1.1.1" xref="S4.T4.9.9.9.9.m1.1.1.cmml"><mi id="S4.T4.9.9.9.9.m1.1.1.2" xref="S4.T4.9.9.9.9.m1.1.1.2.cmml">A</mi><mo id="S4.T4.9.9.9.9.m1.1.1.1" xref="S4.T4.9.9.9.9.m1.1.1.1.cmml">⁢</mo><msubsup id="S4.T4.9.9.9.9.m1.1.1.3" xref="S4.T4.9.9.9.9.m1.1.1.3.cmml"><mi id="S4.T4.9.9.9.9.m1.1.1.3.2.2" xref="S4.T4.9.9.9.9.m1.1.1.3.2.2.cmml">P</mi><mn id="S4.T4.9.9.9.9.m1.1.1.3.3" xref="S4.T4.9.9.9.9.m1.1.1.3.3.cmml">75</mn><mi id="S4.T4.9.9.9.9.m1.1.1.3.2.3" xref="S4.T4.9.9.9.9.m1.1.1.3.2.3.cmml">b</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.9.9.m1.1b"><apply id="S4.T4.9.9.9.9.m1.1.1.cmml" xref="S4.T4.9.9.9.9.m1.1.1"><times id="S4.T4.9.9.9.9.m1.1.1.1.cmml" xref="S4.T4.9.9.9.9.m1.1.1.1"></times><ci id="S4.T4.9.9.9.9.m1.1.1.2.cmml" xref="S4.T4.9.9.9.9.m1.1.1.2">𝐴</ci><apply id="S4.T4.9.9.9.9.m1.1.1.3.cmml" xref="S4.T4.9.9.9.9.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.9.9.9.9.m1.1.1.3.1.cmml" xref="S4.T4.9.9.9.9.m1.1.1.3">subscript</csymbol><apply id="S4.T4.9.9.9.9.m1.1.1.3.2.cmml" xref="S4.T4.9.9.9.9.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.9.9.9.9.m1.1.1.3.2.1.cmml" xref="S4.T4.9.9.9.9.m1.1.1.3">superscript</csymbol><ci id="S4.T4.9.9.9.9.m1.1.1.3.2.2.cmml" xref="S4.T4.9.9.9.9.m1.1.1.3.2.2">𝑃</ci><ci id="S4.T4.9.9.9.9.m1.1.1.3.2.3.cmml" xref="S4.T4.9.9.9.9.m1.1.1.3.2.3">𝑏</ci></apply><cn id="S4.T4.9.9.9.9.m1.1.1.3.3.cmml" type="integer" xref="S4.T4.9.9.9.9.m1.1.1.3.3">75</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.9.9.m1.1c">AP^{b}_{75}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.9.9.9.9.m1.1d">italic_A italic_P start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 75 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.10.10.10.10"><math alttext="mAP^{m}" class="ltx_Math" display="inline" id="S4.T4.10.10.10.10.m1.1"><semantics id="S4.T4.10.10.10.10.m1.1a"><mrow id="S4.T4.10.10.10.10.m1.1.1" xref="S4.T4.10.10.10.10.m1.1.1.cmml"><mi id="S4.T4.10.10.10.10.m1.1.1.2" xref="S4.T4.10.10.10.10.m1.1.1.2.cmml">m</mi><mo id="S4.T4.10.10.10.10.m1.1.1.1" xref="S4.T4.10.10.10.10.m1.1.1.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.10.m1.1.1.3" xref="S4.T4.10.10.10.10.m1.1.1.3.cmml">A</mi><mo id="S4.T4.10.10.10.10.m1.1.1.1a" xref="S4.T4.10.10.10.10.m1.1.1.1.cmml">⁢</mo><msup id="S4.T4.10.10.10.10.m1.1.1.4" xref="S4.T4.10.10.10.10.m1.1.1.4.cmml"><mi id="S4.T4.10.10.10.10.m1.1.1.4.2" xref="S4.T4.10.10.10.10.m1.1.1.4.2.cmml">P</mi><mi id="S4.T4.10.10.10.10.m1.1.1.4.3" xref="S4.T4.10.10.10.10.m1.1.1.4.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.10.10.10.10.m1.1b"><apply id="S4.T4.10.10.10.10.m1.1.1.cmml" xref="S4.T4.10.10.10.10.m1.1.1"><times id="S4.T4.10.10.10.10.m1.1.1.1.cmml" xref="S4.T4.10.10.10.10.m1.1.1.1"></times><ci id="S4.T4.10.10.10.10.m1.1.1.2.cmml" xref="S4.T4.10.10.10.10.m1.1.1.2">𝑚</ci><ci id="S4.T4.10.10.10.10.m1.1.1.3.cmml" xref="S4.T4.10.10.10.10.m1.1.1.3">𝐴</ci><apply id="S4.T4.10.10.10.10.m1.1.1.4.cmml" xref="S4.T4.10.10.10.10.m1.1.1.4"><csymbol cd="ambiguous" id="S4.T4.10.10.10.10.m1.1.1.4.1.cmml" xref="S4.T4.10.10.10.10.m1.1.1.4">superscript</csymbol><ci id="S4.T4.10.10.10.10.m1.1.1.4.2.cmml" xref="S4.T4.10.10.10.10.m1.1.1.4.2">𝑃</ci><ci id="S4.T4.10.10.10.10.m1.1.1.4.3.cmml" xref="S4.T4.10.10.10.10.m1.1.1.4.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.10.10.10.m1.1c">mAP^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.10.10.10.10.m1.1d">italic_m italic_A italic_P start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.11.11"><math alttext="AP^{m}_{50}" class="ltx_Math" display="inline" id="S4.T4.11.11.11.11.m1.1"><semantics id="S4.T4.11.11.11.11.m1.1a"><mrow id="S4.T4.11.11.11.11.m1.1.1" xref="S4.T4.11.11.11.11.m1.1.1.cmml"><mi id="S4.T4.11.11.11.11.m1.1.1.2" xref="S4.T4.11.11.11.11.m1.1.1.2.cmml">A</mi><mo id="S4.T4.11.11.11.11.m1.1.1.1" xref="S4.T4.11.11.11.11.m1.1.1.1.cmml">⁢</mo><msubsup id="S4.T4.11.11.11.11.m1.1.1.3" xref="S4.T4.11.11.11.11.m1.1.1.3.cmml"><mi id="S4.T4.11.11.11.11.m1.1.1.3.2.2" xref="S4.T4.11.11.11.11.m1.1.1.3.2.2.cmml">P</mi><mn id="S4.T4.11.11.11.11.m1.1.1.3.3" xref="S4.T4.11.11.11.11.m1.1.1.3.3.cmml">50</mn><mi id="S4.T4.11.11.11.11.m1.1.1.3.2.3" xref="S4.T4.11.11.11.11.m1.1.1.3.2.3.cmml">m</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.11.11.11.11.m1.1b"><apply id="S4.T4.11.11.11.11.m1.1.1.cmml" xref="S4.T4.11.11.11.11.m1.1.1"><times id="S4.T4.11.11.11.11.m1.1.1.1.cmml" xref="S4.T4.11.11.11.11.m1.1.1.1"></times><ci id="S4.T4.11.11.11.11.m1.1.1.2.cmml" xref="S4.T4.11.11.11.11.m1.1.1.2">𝐴</ci><apply id="S4.T4.11.11.11.11.m1.1.1.3.cmml" xref="S4.T4.11.11.11.11.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.11.11.11.11.m1.1.1.3.1.cmml" xref="S4.T4.11.11.11.11.m1.1.1.3">subscript</csymbol><apply id="S4.T4.11.11.11.11.m1.1.1.3.2.cmml" xref="S4.T4.11.11.11.11.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.11.11.11.11.m1.1.1.3.2.1.cmml" xref="S4.T4.11.11.11.11.m1.1.1.3">superscript</csymbol><ci id="S4.T4.11.11.11.11.m1.1.1.3.2.2.cmml" xref="S4.T4.11.11.11.11.m1.1.1.3.2.2">𝑃</ci><ci id="S4.T4.11.11.11.11.m1.1.1.3.2.3.cmml" xref="S4.T4.11.11.11.11.m1.1.1.3.2.3">𝑚</ci></apply><cn id="S4.T4.11.11.11.11.m1.1.1.3.3.cmml" type="integer" xref="S4.T4.11.11.11.11.m1.1.1.3.3">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.11.11.11.m1.1c">AP^{m}_{50}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.11.11.11.11.m1.1d">italic_A italic_P start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 50 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.12.12"><math alttext="AP^{m}_{75}" class="ltx_Math" display="inline" id="S4.T4.12.12.12.12.m1.1"><semantics id="S4.T4.12.12.12.12.m1.1a"><mrow id="S4.T4.12.12.12.12.m1.1.1" xref="S4.T4.12.12.12.12.m1.1.1.cmml"><mi id="S4.T4.12.12.12.12.m1.1.1.2" xref="S4.T4.12.12.12.12.m1.1.1.2.cmml">A</mi><mo id="S4.T4.12.12.12.12.m1.1.1.1" xref="S4.T4.12.12.12.12.m1.1.1.1.cmml">⁢</mo><msubsup id="S4.T4.12.12.12.12.m1.1.1.3" xref="S4.T4.12.12.12.12.m1.1.1.3.cmml"><mi id="S4.T4.12.12.12.12.m1.1.1.3.2.2" xref="S4.T4.12.12.12.12.m1.1.1.3.2.2.cmml">P</mi><mn id="S4.T4.12.12.12.12.m1.1.1.3.3" xref="S4.T4.12.12.12.12.m1.1.1.3.3.cmml">75</mn><mi id="S4.T4.12.12.12.12.m1.1.1.3.2.3" xref="S4.T4.12.12.12.12.m1.1.1.3.2.3.cmml">m</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.12.12.12.12.m1.1b"><apply id="S4.T4.12.12.12.12.m1.1.1.cmml" xref="S4.T4.12.12.12.12.m1.1.1"><times id="S4.T4.12.12.12.12.m1.1.1.1.cmml" xref="S4.T4.12.12.12.12.m1.1.1.1"></times><ci id="S4.T4.12.12.12.12.m1.1.1.2.cmml" xref="S4.T4.12.12.12.12.m1.1.1.2">𝐴</ci><apply id="S4.T4.12.12.12.12.m1.1.1.3.cmml" xref="S4.T4.12.12.12.12.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.12.12.12.12.m1.1.1.3.1.cmml" xref="S4.T4.12.12.12.12.m1.1.1.3">subscript</csymbol><apply id="S4.T4.12.12.12.12.m1.1.1.3.2.cmml" xref="S4.T4.12.12.12.12.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T4.12.12.12.12.m1.1.1.3.2.1.cmml" xref="S4.T4.12.12.12.12.m1.1.1.3">superscript</csymbol><ci id="S4.T4.12.12.12.12.m1.1.1.3.2.2.cmml" xref="S4.T4.12.12.12.12.m1.1.1.3.2.2">𝑃</ci><ci id="S4.T4.12.12.12.12.m1.1.1.3.2.3.cmml" xref="S4.T4.12.12.12.12.m1.1.1.3.2.3">𝑚</ci></apply><cn id="S4.T4.12.12.12.12.m1.1.1.3.3.cmml" type="integer" xref="S4.T4.12.12.12.12.m1.1.1.3.3">75</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.12.12.12.12.m1.1c">AP^{m}_{75}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.12.12.12.12.m1.1d">italic_A italic_P start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 75 end_POSTSUBSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.14.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.12.12.14.2.1">Swin-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.2">41.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.3">62.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.4">44.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.5">25.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.6">44.9</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.12.12.14.2.7">55.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.8">42.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.9">64.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.10">46.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.11">39.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.12">61.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.14.2.13">42.0</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.15.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.15.3.1">DAT-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.2">42.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.3">64.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.4">45.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.5">28.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.6">45.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.15.3.7">57.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.8">44.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.9">67.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.10">48.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.11">40.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.12">64.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.15.3.13">43.1</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.16.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.16.4.1">CSWin-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.3">-</td>
<td class="ltx_td" id="S4.T4.12.12.16.4.4"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.16.4.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.8">46.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.9">68.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.10">51.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.11">42.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.12">65.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.16.4.13">45.4</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.17.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.17.5.1">RegionViT-S+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib2" title="">2</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.2">43.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.3">65.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.4">47.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.5">28.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.6">47.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.17.5.7">58.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.8">44.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.9">67.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.10">48.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.11">40.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.12">64.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.17.5.13">44.0</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.18.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.18.6.1">MixFormer-B4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib4" title="">4</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.3">-</td>
<td class="ltx_td" id="S4.T4.12.12.18.6.4"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.18.6.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.8">45.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.9">67.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.10">49.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.11">41.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.12">64.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.18.6.13">44.4</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.19.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.19.7.1">CrossFormer-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.2">44.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.3">55.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.4">38.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.5">19.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.6">40.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.19.7.7">48.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.8">45.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.9">68.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.10">49.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.11">41.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.12">64.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.19.7.13">44.6</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.20.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.20.8.1">QuadTree-B2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.2">46.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.3">67.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.4">49.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.5">29.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.6">50.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.20.8.7">61.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.8">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.9">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.10">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.11">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.12">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.20.8.13">-</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.21.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.21.9.1">InternImage-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib43" title="">43</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.3">-</td>
<td class="ltx_td" id="S4.T4.12.12.21.9.4"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.21.9.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.8">47.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.9">69.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.10">52.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.11">42.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.12">66.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.21.9.13">45.8</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.22.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.22.10.1">Agent-Swin-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib18" title="">18</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.3">-</td>
<td class="ltx_td" id="S4.T4.12.12.22.10.4"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.22.10.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.8">44.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.9">67.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.10">48.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.11">40.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.12">64.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.22.10.13">43.4</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.23.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.23.11.1">BiFormer-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.2">45.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.3">66.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.4">49.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.5">30.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.6">49.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.23.11.7">61.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.8">47.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.9">69.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.10">52.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.11">43.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.12">66.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.23.11.13">46.5</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.24.12" style="background-color:#96FFFB;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.24.12.1"><span class="ltx_text" id="S4.T4.12.12.24.12.1.1" style="background-color:#96FFFB;">DeBiFormer-S</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.2"><span class="ltx_text" id="S4.T4.12.12.24.12.2.1" style="background-color:#96FFFB;">45.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.3"><span class="ltx_text" id="S4.T4.12.12.24.12.3.1" style="background-color:#96FFFB;">66.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.4"><span class="ltx_text" id="S4.T4.12.12.24.12.4.1" style="background-color:#96FFFB;">48.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.5"><span class="ltx_text" id="S4.T4.12.12.24.12.5.1" style="background-color:#96FFFB;">28.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.6"><span class="ltx_text" id="S4.T4.12.12.24.12.6.1" style="background-color:#96FFFB;">49.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.24.12.7"><span class="ltx_text" id="S4.T4.12.12.24.12.7.1" style="background-color:#96FFFB;">61.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.8"><span class="ltx_text" id="S4.T4.12.12.24.12.8.1" style="background-color:#96FFFB;">47.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.9"><span class="ltx_text" id="S4.T4.12.12.24.12.9.1" style="background-color:#96FFFB;">69.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.10"><span class="ltx_text" id="S4.T4.12.12.24.12.10.1" style="background-color:#96FFFB;">52.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.11"><span class="ltx_text" id="S4.T4.12.12.24.12.11.1" style="background-color:#96FFFB;">42.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.12"><span class="ltx_text" id="S4.T4.12.12.24.12.12.1" style="background-color:#96FFFB;">66.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.24.12.13"><span class="ltx_text" id="S4.T4.12.12.24.12.13.1" style="background-color:#96FFFB;">45.7</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.25.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.12.12.25.13.1">Swin-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.2">44.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.3">65.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.4">47.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.5">27.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.6">48.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.12.12.25.13.7">59.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.8">44.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.9">66.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.10">48.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.11">40.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.12">63.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.12.12.25.13.13">44.2</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.26.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.26.14.1">DAT-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.2">45.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.3">67.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.4">48.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.5">30.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.6">49.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.26.14.7">61.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.8">47.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.9">69.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.10">51.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.11">42.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.12">66.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.26.14.13">45.4</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.27.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.27.15.1">CSWin-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.3">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.27.15.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.8">47.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.9">70.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.10">52.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.11">43.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.12">67.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.27.15.13">46.2</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.28.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.28.16.1">RegionViT-B+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib2" title="">2</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.2">44.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.3">66.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.4">47.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.5">29.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.6">47.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.28.16.7">59.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.8">45.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.9">68.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.10">49.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.11">41.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.12">65.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.28.16.13">44.8</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.29.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.29.17.1">CrossFormer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.2">46.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.3">67.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.4">49.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.5">30.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.6">49.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.29.17.7">61.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.8">47.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.9">69.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.10">51.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.11">42.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.12">66.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.29.17.13">46.2</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.30.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.30.18.1">QuadTree-B3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.2">47.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.3">68.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.4">50.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.5">30.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.6">51.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.30.18.7">62.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.8">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.9">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.10">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.11">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.12">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.30.18.13">-</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.31.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.31.19.1">InternImage-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib43" title="">43</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.3">-</td>
<td class="ltx_td" id="S4.T4.12.12.31.19.4"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.31.19.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.8">47.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.9">69.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.10">52.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.11">43.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.12">67.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.31.19.13">46.7</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.32.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.32.20.1">Agent-Swin-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib18" title="">18</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.2">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.3">-</td>
<td class="ltx_td" id="S4.T4.12.12.32.20.4"></td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.32.20.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.8">47.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.9">69.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.10">52.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.11">42.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.12">66.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.32.20.13">45.8</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.33.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.12.12.33.21.1">BiFormer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.2">47.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.3">68.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.4">50.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.5">31.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.6">50.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.12.12.33.21.7">62.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.8">48.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.9">70.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.10">53.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.11">43.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.12">67.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.12.12.33.21.13">47.1</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.34.22" style="background-color:#96FFFB;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T4.12.12.34.22.1"><span class="ltx_text" id="S4.T4.12.12.34.22.1.1" style="background-color:#96FFFB;">DeBiFormer-B</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.2"><span class="ltx_text ltx_font_bold" id="S4.T4.12.12.34.22.2.1" style="background-color:#96FFFB;">47.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.3"><span class="ltx_text" id="S4.T4.12.12.34.22.3.1" style="background-color:#96FFFB;">68.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.4"><span class="ltx_text" id="S4.T4.12.12.34.22.4.1" style="background-color:#96FFFB;">50.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.5"><span class="ltx_text" id="S4.T4.12.12.34.22.5.1" style="background-color:#96FFFB;">30.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.6"><span class="ltx_text ltx_font_bold" id="S4.T4.12.12.34.22.6.1" style="background-color:#96FFFB;">51.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.12.12.34.22.7"><span class="ltx_text ltx_font_bold" id="S4.T4.12.12.34.22.7.1" style="background-color:#96FFFB;">63.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.8"><span class="ltx_text" id="S4.T4.12.12.34.22.8.1" style="background-color:#96FFFB;">48.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.9"><span class="ltx_text" id="S4.T4.12.12.34.22.9.1" style="background-color:#96FFFB;">70.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.10"><span class="ltx_text" id="S4.T4.12.12.34.22.10.1" style="background-color:#96FFFB;">53.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.11"><span class="ltx_text" id="S4.T4.12.12.34.22.11.1" style="background-color:#96FFFB;">43.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.12"><span class="ltx_text" id="S4.T4.12.12.34.22.12.1" style="background-color:#96FFFB;">67.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.12.12.34.22.13"><span class="ltx_text" id="S4.T4.12.12.34.22.13.1" style="background-color:#96FFFB;">46.4</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results on object detection (left group) and instance segmentation (right group) tasks, performed on COCO 2017 dataset.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Object detection and instance segmentation</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.p1.3.1">Settings.</span>
We used our DeBiFormer as the backbone in the Mask RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib19" title="">19</a>]</cite> and RetinaNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib16" title="">16</a>]</cite> frameworks to evaluate the effectiveness of models for object detection and instance segmentation on COCO 2017 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib17" title="">17</a>]</cite>. The experiments were conducted with the MMDetection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib3" title="">3</a>]</cite> toolbox. Before training on COCO, we initialized the backbone with weights pre-trained on ImageNet-1K and followed the same training strategies as BiFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite> to compare our methods fairly. Note that due to device limitations, we set mini batch size as <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.3.2">4</span> for these experiments, while in BiFormer this value is 16. For details on the specific settings of the experiment, please refer to the supplementary paper.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.SS3.p1.3.3">Results.</span>
We list the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.T4" title="Table 4 ‣ 4.2 Semantic segmentation on ADE20K ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">4</span></a>. For object detection with RetinaNet, we report the mean average precision (mAP) and the average precision (AP) at different IoU thresholds (50%, 75%) for three object sizes (i.e., small, medium, and large (S/M/L)). From the results, we can see that while the overall performance of DeBiFormer was only comparable to some of the most competitive existing methods, the performance on large objects (<math alttext="AP_{L}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">A</mi><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.1.3.2.cmml">P</mi><mi id="S4.SS3.p1.1.m1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml">L</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><times id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></times><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝐴</ci><apply id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.2">𝑃</ci><ci id="S4.SS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">AP_{L}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_A italic_P start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math>) outperformed these methods although we use a limited resources. This may be because the DBRA allocates deformable points more reasonably. These points are not to focus only on small things, but to focus on important things in the image. Therefore the attention is not limited to a small area, which improves the detection accuracy of large objects. For instance segmentation with Mask R-CNN, we report the bounding box and mask the average precision (<math alttext="AP_{b}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">A</mi><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">P</mi><mi id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><times id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></times><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝐴</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">𝑃</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">AP_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_A italic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="AP_{m}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">A</mi><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.2" xref="S4.SS3.p1.3.m3.1.1.3.2.cmml">P</mi><mi id="S4.SS3.p1.3.m3.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><times id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></times><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝐴</ci><apply id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2">𝑃</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">AP_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_A italic_P start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>) at different IoU thresholds (50%, 75%). Note that our DeBiFormer still achieved great performance under the device limitation of mini batch size. We believe that we could achieve better results if the mini batch size could be the same to other methods since it has been proved on semantic segmentation tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation study</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.3"><span class="ltx_text ltx_font_bold" id="S4.SS4.p1.3.1">Effectiveness of DBRA.</span>
We compared DBRA with several existing sparse attention mechanisms. Following CSWIN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>, we aligned macro architecture designs with Swin-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite> for fair comparison. Specifically, we used <math alttext="2,2,6,2" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.4"><semantics id="S4.SS4.p1.1.m1.4a"><mrow id="S4.SS4.p1.1.m1.4.5.2" xref="S4.SS4.p1.1.m1.4.5.1.cmml"><mn id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">2</mn><mo id="S4.SS4.p1.1.m1.4.5.2.1" xref="S4.SS4.p1.1.m1.4.5.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.2.2" xref="S4.SS4.p1.1.m1.2.2.cmml">2</mn><mo id="S4.SS4.p1.1.m1.4.5.2.2" xref="S4.SS4.p1.1.m1.4.5.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.3.3" xref="S4.SS4.p1.1.m1.3.3.cmml">6</mn><mo id="S4.SS4.p1.1.m1.4.5.2.3" xref="S4.SS4.p1.1.m1.4.5.1.cmml">,</mo><mn id="S4.SS4.p1.1.m1.4.4" xref="S4.SS4.p1.1.m1.4.4.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.4b"><list id="S4.SS4.p1.1.m1.4.5.1.cmml" xref="S4.SS4.p1.1.m1.4.5.2"><cn id="S4.SS4.p1.1.m1.1.1.cmml" type="integer" xref="S4.SS4.p1.1.m1.1.1">2</cn><cn id="S4.SS4.p1.1.m1.2.2.cmml" type="integer" xref="S4.SS4.p1.1.m1.2.2">2</cn><cn id="S4.SS4.p1.1.m1.3.3.cmml" type="integer" xref="S4.SS4.p1.1.m1.3.3">6</cn><cn id="S4.SS4.p1.1.m1.4.4.cmml" type="integer" xref="S4.SS4.p1.1.m1.4.4">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.4c">2,2,6,2</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.4d">2 , 2 , 6 , 2</annotation></semantics></math> blocks for the four stages and non-overlapped patch embedding, and we set the initial patch embedding dimension to <math alttext="C=96" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">C</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">96</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><eq id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></eq><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝐶</ci><cn id="S4.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS4.p1.2.m2.1.1.3">96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">C=96</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_C = 96</annotation></semantics></math> and MLP expansion ratio to <math alttext="e=4" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">e</mi><mo id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><eq id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></eq><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝑒</ci><cn id="S4.SS4.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">e=4</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_e = 4</annotation></semantics></math>. The results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.T5" title="Table 5 ‣ 4.4 Ablation study ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">5</span></a>. Our Deformable Bi-level Routing Attention had significantly better performance than the existing sparse attention mechanisms, in terms of both image classification and semantic segmentation.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.1.1.1.1">Sparse Attention</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T5.1.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S4.T5.1.1.1.2.1">
<tr class="ltx_tr" id="S4.T5.1.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T5.1.1.1.2.1.1.1">IN1K</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T5.1.1.1.2.1.2.1">Top1(%)</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S4.T5.1.1.1.3.1">
<tr class="ltx_tr" id="S4.T5.1.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T5.1.1.1.3.1.1.1">ADE20K</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T5.1.1.1.3.1.2.1">mIoU(%)</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.1.2.1.1">Shifted window <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.2.1.2">81.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.3">41.5</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.3.2.1">Spatially sep <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib7" title="">7</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.3.2.2">81.5</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.3.2.3">42.9</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.4.3.1">Sequential axial <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib21" title="">21</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.4.3.2">81.5</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.3">39.8</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.5.4.1">Criss-cross <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.5.4.2">81.7</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.5.4.3">43.0</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.6.5.1">Cross-shaped window <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.6.5.2">82.2</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.6.5.3">43.4</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.7.6.1">Deformable <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.7.6.2">82.0</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.7.6.3">42.6</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.8.7.1">Block-grid <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib40" title="">40</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.8.7.2">81.8</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.8.7.3">42.8</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.1.9.8.1">Bi-level routing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.9.8.2">82.7</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.9.8.3">44.8</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.10.9" style="background-color:#96FFFB;">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T5.1.10.9.1"><span class="ltx_text" id="S4.T5.1.10.9.1.1" style="background-color:#96FFFB;">Deformable bi-level routing</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T5.1.10.9.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.2.1" style="background-color:#96FFFB;">82.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.10.9.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.3.1" style="background-color:#96FFFB;">48.0</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation study on different attention mechanisms. All models follow the architecture design of the Swin-T model.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.3"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.3.1">Partition factor S.</span>
Similar to BiFormer, we opted to use <math alttext="S" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_S</annotation></semantics></math> as a divisor of the training size to prevent padding. We used an image classification with a resolution of <math alttext="224=7\times 32" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mn id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">224</mn><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml"><mn id="S4.SS4.p2.2.m2.1.1.3.2" xref="S4.SS4.p2.2.m2.1.1.3.2.cmml">7</mn><mo id="S4.SS4.p2.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS4.p2.2.m2.1.1.3.1.cmml">×</mo><mn id="S4.SS4.p2.2.m2.1.1.3.3" xref="S4.SS4.p2.2.m2.1.1.3.3.cmml">32</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><eq id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1"></eq><cn id="S4.SS4.p2.2.m2.1.1.2.cmml" type="integer" xref="S4.SS4.p2.2.m2.1.1.2">224</cn><apply id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3"><times id="S4.SS4.p2.2.m2.1.1.3.1.cmml" xref="S4.SS4.p2.2.m2.1.1.3.1"></times><cn id="S4.SS4.p2.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS4.p2.2.m2.1.1.3.2">7</cn><cn id="S4.SS4.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS4.p2.2.m2.1.1.3.3">32</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">224=7\times 32</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">224 = 7 × 32</annotation></semantics></math>, and we set <math alttext="S=7" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1"><semantics id="S4.SS4.p2.3.m3.1a"><mrow id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml">S</mi><mo id="S4.SS4.p2.3.m3.1.1.1" xref="S4.SS4.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><eq id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1.1"></eq><ci id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2">𝑆</ci><cn id="S4.SS4.p2.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.p2.3.m3.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">S=7</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">italic_S = 7</annotation></semantics></math> to ensure that the size of the feature maps was divided at each stage. This choice aligns with the strategy used for the Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>, where a window size of 7 was used.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.3.2">Top-k Choices.</span></p>
</div>
<figure class="ltx_table" id="S4.T6">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T6.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T6.1.1.2">#partition factor</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T6.1.1.1"><math alttext="k" class="ltx_Math" display="inline" id="S4.T6.1.1.1.m1.1"><semantics id="S4.T6.1.1.1.m1.1a"><mi id="S4.T6.1.1.1.m1.1.1" xref="S4.T6.1.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.m1.1b"><ci id="S4.T6.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.T6.1.1.1.m1.1d">italic_k</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T6.1.1.3">Bi-level Routing tokens to attend</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T6.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S4.T6.1.1.4.1">
<tr class="ltx_tr" id="S4.T6.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T6.1.1.4.1.1.1">CoreML</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T6.1.1.4.1.2.1">Latency(ms)</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T6.1.1.5">
<table class="ltx_tabular ltx_align_middle" id="S4.T6.1.1.5.1">
<tr class="ltx_tr" id="S4.T6.1.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T6.1.1.5.1.1.1">Top-1 Acc</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T6.1.1.5.1.2.1">(%)</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.1.2.1.1">7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.1.2.1.2">1,4,16,49</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.1.2.1.3">64, 64, 64, 49</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.1.2.1.4">291</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.1.2.1.5">81.81</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.3.2.1">7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.3.2.2">2,8,32,49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.3.2.3">128, 128, 128, 49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.3.2.4">459</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.3.2.5">81.74</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.4.3.1">7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.4.3.2">4,8,16,32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.4.3.3">256, 128, 64, 32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.4.3.4"><span class="ltx_text ltx_font_bold" id="S4.T6.1.4.3.4.1">276</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.4.3.5">81.47</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.5.4.1">7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.5.4.2">8,16,32,49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.5.4.3">512, 256, 128, 49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.1.5.4.4">498</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.5.4.5">81.60</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T6.1.6.5.1">7</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T6.1.6.5.2">4,8,16,49</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T6.1.6.5.3">256, 128, 64, 49</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T6.1.6.5.4">382</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T6.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S4.T6.1.6.5.5.1">81.90</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Ablation study on top-k selection.The four numbers in the k column represent the top-k values of the four stages and the same to the tokens to attend column. The CoreML Latency is conducted by MacBook Pro M1 using CPU and Nerual Engine. </figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.2">We systematically adjusted <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><mi id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><ci id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">italic_k</annotation></semantics></math> to ensure a reasonable number of tokens attended to deformable queries as the region size diminished in later stages. Exploring various combinations of <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><mi id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><ci id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">italic_k</annotation></semantics></math> is a viable option. In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.T9" title="Table 9 ‣ 7.4 Token to Attend ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">9</span></a>, we present ablation results on IN-1K, following DeBiFormer-STL (“STL” denotes Swin-T Layout). A crucial observation from these experiments is that augmenting the number of tokens paid attention to the deformable queries had a detrimental effect on accuracy and latency, and increasing the number of tokens paid attention in stages 1 and 2 had an effect on accuracy.

<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.SS4.p3.2.1">Deformable Bi-level Routing Multi-Head Attention (DBRMHA) at different stages.</span>
To evaluate the impact of design choices, we systematically replaced bi-level routing attention blocks with DBRMHA blocks across different stages, as shown in Table<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.T7" title="Table 7 ‣ 4.4 Ablation study ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">7</span></a>. Initially, all stages used bi-level routing attention, similar to BiFormer-T <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>, achieving 81.3% accuracy in image classification. Replacing just one block in the 4th stage with DBRMHA immediately boosted accuracy by +0.21. Replacing all blocks in the 4th stage added another +0.05. Further DBRMHA replacements in the 3rd stage continued to improve performance across tasks. While gains tapered off with earlier stage replacements, we settled on a final version—DeBiFormer—where all stages use Deformable Bi-level Routing Attention for simplicity.</p>
</div>
<figure class="ltx_table" id="S4.T7">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S4.T7.1.1.1.1">Stage Configurations</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T7.1.1.1.2">Backbone</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3">IN-1K</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.2.2">
<td class="ltx_td ltx_align_center" id="S4.T7.1.2.2.1">1</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.2.2.2">2</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.2.2.3">3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.2.2.4">4</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.2.2.5">FLOPs</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.2.2.6">#Param</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.2.2.7">Acc.</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.3.1">BB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.3.2">BB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.3.3">BB</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.1.3.3.4">BB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.3.5">2.2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T7.1.3.3.6">13.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.3.3.7">81.37</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.4.4">
<td class="ltx_td ltx_align_center" id="S4.T7.1.4.4.1">BB</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.4.4.2">BB</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.4.4.3">BB</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.4.4.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.4.4.4.1">B*</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.4.4.5">2.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.4.4.6">15.8</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.4.4.7">81.58</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.5.5">
<td class="ltx_td ltx_align_center" id="S4.T7.1.5.5.1">BB</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.5.5.2">BB</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.5.5.3">BB</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.5.5.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.5.5.4.1">**</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.5.5.5">2.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.5.5.6">18.5</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.5.5.7">81.63</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.6.6">
<td class="ltx_td ltx_align_center" id="S4.T7.1.6.6.1">BB</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.6.6.2">BB</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.6.6.3"><span class="ltx_text ltx_font_bold" id="S4.T7.1.6.6.3.1">B*</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.6.6.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.6.6.4.1">**</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.6.6.5">2.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.6.6.6">21.2</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.6.6.7">81.84</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.7.7">
<td class="ltx_td ltx_align_center" id="S4.T7.1.7.7.1">BB</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S4.T7.1.7.7.2.1">B*</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S4.T7.1.7.7.3.1">B*</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.7.7.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.7.7.4.1">**</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.7.7.5">2.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T7.1.7.7.6">21.4</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.7.7.7">81.87</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T7.1.8.8.1"><span class="ltx_text ltx_font_bold" id="S4.T7.1.8.8.1.1">B*</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T7.1.8.8.2"><span class="ltx_text ltx_font_bold" id="S4.T7.1.8.8.2.1">B*</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T7.1.8.8.3"><span class="ltx_text ltx_font_bold" id="S4.T7.1.8.8.3.1">B*</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T7.1.8.8.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.8.8.4.1">**</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T7.1.8.8.5">2.6</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T7.1.8.8.6">21.4</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T7.1.8.8.7"><span class="ltx_text ltx_font_bold" id="S4.T7.1.8.8.7.1">81.90</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Configuration <span class="ltx_text ltx_font_bold" id="S4.T7.4.1">B*</span>: this stage is constructed with successive bi-level routing attention and DBRMHA blocks, while BB and <span class="ltx_text ltx_font_bold" id="S4.T7.5.2">**</span> denotes that stage uses the same blocks as bi-level routing attention and DBRMHA, respectively.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="S4.F4.1.g1" src="x4.png" width="664"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Grad-CAM Visualization of BiFormer-Base and DeBiFormer-Base. These images are sampled from the validation set of ImageNet-1K.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Grad-CAM Visualization</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">To further illustrate the ability of the proposed DeBiFormer to recognize the attention in important regions, we used Grad-CAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib36" title="">36</a>]</cite> to visualize the areas of greatest concern of BiFormer-Base and DeBiFormer-Base.
As shown in Figure<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S4.F4" title="Figure 4 ‣ 4.4 Ablation study ‣ 4 Experiments ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">4</span></a>, by utilizing DBRA module, our DeBiFormer-Base model performed better in target objects locating in which more regions have been focused on. In addition, our model scales down the attention in the unnecessary regions and pays more attention to the necessary regions. Depending on the attention of more necessary regions, our DeBiFormer model focused on semantic areas more continuously and completely, suggesting the stronger recognition ability of our model. Such ability yields better classification, and semantic segmentation performance compared with BiFormer-Base.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">The paper introduces the Deformable Bi-level Routing Attention Transformer, a novel hierarchical vision transformer designed for both image classification and dense prediction tasks. Through Deformable Bi-level Routing Attention, our model optimizes query-key-value interactions while adaptively selecting semantically relevant regions. This leads to more efficient and meaningful attention. Extensive experiments show our model’s effectiveness compared to strong baselines. We hope this work offers insights into designing flexible and semantically aware attention mechanisms.
</p>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Supplementary Material</h2>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Offset groups</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">Like <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>, to foster diversity among deformed points, we adhere to a similar paradigm as in MHSA, where the channels are split into multiple heads to compute a variety of attentions. Hence, we partition the channels into <math alttext="G" class="ltx_Math" display="inline" id="S7.SS1.p1.1.m1.1"><semantics id="S7.SS1.p1.1.m1.1a"><mi id="S7.SS1.p1.1.m1.1.1" xref="S7.SS1.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p1.1.m1.1b"><ci id="S7.SS1.p1.1.m1.1.1.cmml" xref="S7.SS1.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p1.1.m1.1d">italic_G</annotation></semantics></math> groups to generate diverse offsets. The offset generation network shares weights for features from different groups.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Deformable relative position bias</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.1">Certainly, incorporating position information into attention mechanisms has proven beneficial for model performance. Various approaches, such as APE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib15" title="">15</a>]</cite>, RPE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>, CPE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib8" title="">8</a>]</cite>, LogCPB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib28" title="">28</a>]</cite>, and others have demonstrated improved results. The relative position embedding (RPE) introduced in the Swin Transformer specifically encodes the relative positions between every pair of query and key, thereby enhancing vanilla attention with spatial inductive bias <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>. The explicit modeling of relative locations is especially well-suited for attention heads at the deformable level. In this context, deformed keys can assume arbitrary continuous locations, as opposed to being confined to fixed discrete grids.</p>
</div>
<div class="ltx_para" id="S7.SS2.p2">
<p class="ltx_p" id="S7.SS2.p2.4">In accordance with <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>, the relative coordinate displacements are restricted to the range of <math alttext="[-H,+H]" class="ltx_Math" display="inline" id="S7.SS2.p2.1.m1.2"><semantics id="S7.SS2.p2.1.m1.2a"><mrow id="S7.SS2.p2.1.m1.2.2.2" xref="S7.SS2.p2.1.m1.2.2.3.cmml"><mo id="S7.SS2.p2.1.m1.2.2.2.3" stretchy="false" xref="S7.SS2.p2.1.m1.2.2.3.cmml">[</mo><mrow id="S7.SS2.p2.1.m1.1.1.1.1" xref="S7.SS2.p2.1.m1.1.1.1.1.cmml"><mo id="S7.SS2.p2.1.m1.1.1.1.1a" xref="S7.SS2.p2.1.m1.1.1.1.1.cmml">−</mo><mi id="S7.SS2.p2.1.m1.1.1.1.1.2" xref="S7.SS2.p2.1.m1.1.1.1.1.2.cmml">H</mi></mrow><mo id="S7.SS2.p2.1.m1.2.2.2.4" xref="S7.SS2.p2.1.m1.2.2.3.cmml">,</mo><mrow id="S7.SS2.p2.1.m1.2.2.2.2" xref="S7.SS2.p2.1.m1.2.2.2.2.cmml"><mo id="S7.SS2.p2.1.m1.2.2.2.2a" xref="S7.SS2.p2.1.m1.2.2.2.2.cmml">+</mo><mi id="S7.SS2.p2.1.m1.2.2.2.2.2" xref="S7.SS2.p2.1.m1.2.2.2.2.2.cmml">H</mi></mrow><mo id="S7.SS2.p2.1.m1.2.2.2.5" stretchy="false" xref="S7.SS2.p2.1.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.p2.1.m1.2b"><interval closure="closed" id="S7.SS2.p2.1.m1.2.2.3.cmml" xref="S7.SS2.p2.1.m1.2.2.2"><apply id="S7.SS2.p2.1.m1.1.1.1.1.cmml" xref="S7.SS2.p2.1.m1.1.1.1.1"><minus id="S7.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S7.SS2.p2.1.m1.1.1.1.1"></minus><ci id="S7.SS2.p2.1.m1.1.1.1.1.2.cmml" xref="S7.SS2.p2.1.m1.1.1.1.1.2">𝐻</ci></apply><apply id="S7.SS2.p2.1.m1.2.2.2.2.cmml" xref="S7.SS2.p2.1.m1.2.2.2.2"><plus id="S7.SS2.p2.1.m1.2.2.2.2.1.cmml" xref="S7.SS2.p2.1.m1.2.2.2.2"></plus><ci id="S7.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S7.SS2.p2.1.m1.2.2.2.2.2">𝐻</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p2.1.m1.2c">[-H,+H]</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p2.1.m1.2d">[ - italic_H , + italic_H ]</annotation></semantics></math> and <math alttext="[-W,+W]" class="ltx_Math" display="inline" id="S7.SS2.p2.2.m2.2"><semantics id="S7.SS2.p2.2.m2.2a"><mrow id="S7.SS2.p2.2.m2.2.2.2" xref="S7.SS2.p2.2.m2.2.2.3.cmml"><mo id="S7.SS2.p2.2.m2.2.2.2.3" stretchy="false" xref="S7.SS2.p2.2.m2.2.2.3.cmml">[</mo><mrow id="S7.SS2.p2.2.m2.1.1.1.1" xref="S7.SS2.p2.2.m2.1.1.1.1.cmml"><mo id="S7.SS2.p2.2.m2.1.1.1.1a" xref="S7.SS2.p2.2.m2.1.1.1.1.cmml">−</mo><mi id="S7.SS2.p2.2.m2.1.1.1.1.2" xref="S7.SS2.p2.2.m2.1.1.1.1.2.cmml">W</mi></mrow><mo id="S7.SS2.p2.2.m2.2.2.2.4" xref="S7.SS2.p2.2.m2.2.2.3.cmml">,</mo><mrow id="S7.SS2.p2.2.m2.2.2.2.2" xref="S7.SS2.p2.2.m2.2.2.2.2.cmml"><mo id="S7.SS2.p2.2.m2.2.2.2.2a" xref="S7.SS2.p2.2.m2.2.2.2.2.cmml">+</mo><mi id="S7.SS2.p2.2.m2.2.2.2.2.2" xref="S7.SS2.p2.2.m2.2.2.2.2.2.cmml">W</mi></mrow><mo id="S7.SS2.p2.2.m2.2.2.2.5" stretchy="false" xref="S7.SS2.p2.2.m2.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.p2.2.m2.2b"><interval closure="closed" id="S7.SS2.p2.2.m2.2.2.3.cmml" xref="S7.SS2.p2.2.m2.2.2.2"><apply id="S7.SS2.p2.2.m2.1.1.1.1.cmml" xref="S7.SS2.p2.2.m2.1.1.1.1"><minus id="S7.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S7.SS2.p2.2.m2.1.1.1.1"></minus><ci id="S7.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S7.SS2.p2.2.m2.1.1.1.1.2">𝑊</ci></apply><apply id="S7.SS2.p2.2.m2.2.2.2.2.cmml" xref="S7.SS2.p2.2.m2.2.2.2.2"><plus id="S7.SS2.p2.2.m2.2.2.2.2.1.cmml" xref="S7.SS2.p2.2.m2.2.2.2.2"></plus><ci id="S7.SS2.p2.2.m2.2.2.2.2.2.cmml" xref="S7.SS2.p2.2.m2.2.2.2.2.2">𝑊</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p2.2.m2.2c">[-W,+W]</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p2.2.m2.2d">[ - italic_W , + italic_W ]</annotation></semantics></math> along the spatial dimension with a relative position bias (RPB), denoted as <math alttext="\hat{B}" class="ltx_Math" display="inline" id="S7.SS2.p2.3.m3.1"><semantics id="S7.SS2.p2.3.m3.1a"><mover accent="true" id="S7.SS2.p2.3.m3.1.1" xref="S7.SS2.p2.3.m3.1.1.cmml"><mi id="S7.SS2.p2.3.m3.1.1.2" xref="S7.SS2.p2.3.m3.1.1.2.cmml">B</mi><mo id="S7.SS2.p2.3.m3.1.1.1" xref="S7.SS2.p2.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S7.SS2.p2.3.m3.1b"><apply id="S7.SS2.p2.3.m3.1.1.cmml" xref="S7.SS2.p2.3.m3.1.1"><ci id="S7.SS2.p2.3.m3.1.1.1.cmml" xref="S7.SS2.p2.3.m3.1.1.1">^</ci><ci id="S7.SS2.p2.3.m3.1.1.2.cmml" xref="S7.SS2.p2.3.m3.1.1.2">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p2.3.m3.1c">\hat{B}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p2.3.m3.1d">over^ start_ARG italic_B end_ARG</annotation></semantics></math> with dimensions <math alttext="(2H-1)\times(2W-1)" class="ltx_Math" display="inline" id="S7.SS2.p2.4.m4.2"><semantics id="S7.SS2.p2.4.m4.2a"><mrow id="S7.SS2.p2.4.m4.2.2" xref="S7.SS2.p2.4.m4.2.2.cmml"><mrow id="S7.SS2.p2.4.m4.1.1.1.1" xref="S7.SS2.p2.4.m4.1.1.1.1.1.cmml"><mo id="S7.SS2.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S7.SS2.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S7.SS2.p2.4.m4.1.1.1.1.1" xref="S7.SS2.p2.4.m4.1.1.1.1.1.cmml"><mrow id="S7.SS2.p2.4.m4.1.1.1.1.1.2" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2.cmml"><mn id="S7.SS2.p2.4.m4.1.1.1.1.1.2.2" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2.2.cmml">2</mn><mo id="S7.SS2.p2.4.m4.1.1.1.1.1.2.1" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S7.SS2.p2.4.m4.1.1.1.1.1.2.3" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2.3.cmml">H</mi></mrow><mo id="S7.SS2.p2.4.m4.1.1.1.1.1.1" xref="S7.SS2.p2.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S7.SS2.p2.4.m4.1.1.1.1.1.3" xref="S7.SS2.p2.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S7.SS2.p2.4.m4.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S7.SS2.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow><mo id="S7.SS2.p2.4.m4.2.2.3" rspace="0.222em" xref="S7.SS2.p2.4.m4.2.2.3.cmml">×</mo><mrow id="S7.SS2.p2.4.m4.2.2.2.1" xref="S7.SS2.p2.4.m4.2.2.2.1.1.cmml"><mo id="S7.SS2.p2.4.m4.2.2.2.1.2" stretchy="false" xref="S7.SS2.p2.4.m4.2.2.2.1.1.cmml">(</mo><mrow id="S7.SS2.p2.4.m4.2.2.2.1.1" xref="S7.SS2.p2.4.m4.2.2.2.1.1.cmml"><mrow id="S7.SS2.p2.4.m4.2.2.2.1.1.2" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2.cmml"><mn id="S7.SS2.p2.4.m4.2.2.2.1.1.2.2" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2.2.cmml">2</mn><mo id="S7.SS2.p2.4.m4.2.2.2.1.1.2.1" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2.1.cmml">⁢</mo><mi id="S7.SS2.p2.4.m4.2.2.2.1.1.2.3" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2.3.cmml">W</mi></mrow><mo id="S7.SS2.p2.4.m4.2.2.2.1.1.1" xref="S7.SS2.p2.4.m4.2.2.2.1.1.1.cmml">−</mo><mn id="S7.SS2.p2.4.m4.2.2.2.1.1.3" xref="S7.SS2.p2.4.m4.2.2.2.1.1.3.cmml">1</mn></mrow><mo id="S7.SS2.p2.4.m4.2.2.2.1.3" stretchy="false" xref="S7.SS2.p2.4.m4.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.p2.4.m4.2b"><apply id="S7.SS2.p2.4.m4.2.2.cmml" xref="S7.SS2.p2.4.m4.2.2"><times id="S7.SS2.p2.4.m4.2.2.3.cmml" xref="S7.SS2.p2.4.m4.2.2.3"></times><apply id="S7.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="S7.SS2.p2.4.m4.1.1.1.1"><minus id="S7.SS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S7.SS2.p2.4.m4.1.1.1.1.1.1"></minus><apply id="S7.SS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2"><times id="S7.SS2.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2.1"></times><cn id="S7.SS2.p2.4.m4.1.1.1.1.1.2.2.cmml" type="integer" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2.2">2</cn><ci id="S7.SS2.p2.4.m4.1.1.1.1.1.2.3.cmml" xref="S7.SS2.p2.4.m4.1.1.1.1.1.2.3">𝐻</ci></apply><cn id="S7.SS2.p2.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S7.SS2.p2.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S7.SS2.p2.4.m4.2.2.2.1.1.cmml" xref="S7.SS2.p2.4.m4.2.2.2.1"><minus id="S7.SS2.p2.4.m4.2.2.2.1.1.1.cmml" xref="S7.SS2.p2.4.m4.2.2.2.1.1.1"></minus><apply id="S7.SS2.p2.4.m4.2.2.2.1.1.2.cmml" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2"><times id="S7.SS2.p2.4.m4.2.2.2.1.1.2.1.cmml" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2.1"></times><cn id="S7.SS2.p2.4.m4.2.2.2.1.1.2.2.cmml" type="integer" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2.2">2</cn><ci id="S7.SS2.p2.4.m4.2.2.2.1.1.2.3.cmml" xref="S7.SS2.p2.4.m4.2.2.2.1.1.2.3">𝑊</ci></apply><cn id="S7.SS2.p2.4.m4.2.2.2.1.1.3.cmml" type="integer" xref="S7.SS2.p2.4.m4.2.2.2.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p2.4.m4.2c">(2H-1)\times(2W-1)</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p2.4.m4.2d">( 2 italic_H - 1 ) × ( 2 italic_W - 1 )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S7.SS2.p3">
<p class="ltx_p" id="S7.SS2.p3.2">Then, the relative locations within the range of <math alttext="[-1,+1]" class="ltx_Math" display="inline" id="S7.SS2.p3.1.m1.2"><semantics id="S7.SS2.p3.1.m1.2a"><mrow id="S7.SS2.p3.1.m1.2.2.2" xref="S7.SS2.p3.1.m1.2.2.3.cmml"><mo id="S7.SS2.p3.1.m1.2.2.2.3" stretchy="false" xref="S7.SS2.p3.1.m1.2.2.3.cmml">[</mo><mrow id="S7.SS2.p3.1.m1.1.1.1.1" xref="S7.SS2.p3.1.m1.1.1.1.1.cmml"><mo id="S7.SS2.p3.1.m1.1.1.1.1a" xref="S7.SS2.p3.1.m1.1.1.1.1.cmml">−</mo><mn id="S7.SS2.p3.1.m1.1.1.1.1.2" xref="S7.SS2.p3.1.m1.1.1.1.1.2.cmml">1</mn></mrow><mo id="S7.SS2.p3.1.m1.2.2.2.4" xref="S7.SS2.p3.1.m1.2.2.3.cmml">,</mo><mrow id="S7.SS2.p3.1.m1.2.2.2.2" xref="S7.SS2.p3.1.m1.2.2.2.2.cmml"><mo id="S7.SS2.p3.1.m1.2.2.2.2a" xref="S7.SS2.p3.1.m1.2.2.2.2.cmml">+</mo><mn id="S7.SS2.p3.1.m1.2.2.2.2.2" xref="S7.SS2.p3.1.m1.2.2.2.2.2.cmml">1</mn></mrow><mo id="S7.SS2.p3.1.m1.2.2.2.5" stretchy="false" xref="S7.SS2.p3.1.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.p3.1.m1.2b"><interval closure="closed" id="S7.SS2.p3.1.m1.2.2.3.cmml" xref="S7.SS2.p3.1.m1.2.2.2"><apply id="S7.SS2.p3.1.m1.1.1.1.1.cmml" xref="S7.SS2.p3.1.m1.1.1.1.1"><minus id="S7.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S7.SS2.p3.1.m1.1.1.1.1"></minus><cn id="S7.SS2.p3.1.m1.1.1.1.1.2.cmml" type="integer" xref="S7.SS2.p3.1.m1.1.1.1.1.2">1</cn></apply><apply id="S7.SS2.p3.1.m1.2.2.2.2.cmml" xref="S7.SS2.p3.1.m1.2.2.2.2"><plus id="S7.SS2.p3.1.m1.2.2.2.2.1.cmml" xref="S7.SS2.p3.1.m1.2.2.2.2"></plus><cn id="S7.SS2.p3.1.m1.2.2.2.2.2.cmml" type="integer" xref="S7.SS2.p3.1.m1.2.2.2.2.2">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p3.1.m1.2c">[-1,+1]</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p3.1.m1.2d">[ - 1 , + 1 ]</annotation></semantics></math> are sampled using bilinear interpolation <math alttext="\varphi(\hat{B};R)" class="ltx_Math" display="inline" id="S7.SS2.p3.2.m2.2"><semantics id="S7.SS2.p3.2.m2.2a"><mrow id="S7.SS2.p3.2.m2.2.3" xref="S7.SS2.p3.2.m2.2.3.cmml"><mi id="S7.SS2.p3.2.m2.2.3.2" xref="S7.SS2.p3.2.m2.2.3.2.cmml">φ</mi><mo id="S7.SS2.p3.2.m2.2.3.1" xref="S7.SS2.p3.2.m2.2.3.1.cmml">⁢</mo><mrow id="S7.SS2.p3.2.m2.2.3.3.2" xref="S7.SS2.p3.2.m2.2.3.3.1.cmml"><mo id="S7.SS2.p3.2.m2.2.3.3.2.1" stretchy="false" xref="S7.SS2.p3.2.m2.2.3.3.1.cmml">(</mo><mover accent="true" id="S7.SS2.p3.2.m2.1.1" xref="S7.SS2.p3.2.m2.1.1.cmml"><mi id="S7.SS2.p3.2.m2.1.1.2" xref="S7.SS2.p3.2.m2.1.1.2.cmml">B</mi><mo id="S7.SS2.p3.2.m2.1.1.1" xref="S7.SS2.p3.2.m2.1.1.1.cmml">^</mo></mover><mo id="S7.SS2.p3.2.m2.2.3.3.2.2" xref="S7.SS2.p3.2.m2.2.3.3.1.cmml">;</mo><mi id="S7.SS2.p3.2.m2.2.2" xref="S7.SS2.p3.2.m2.2.2.cmml">R</mi><mo id="S7.SS2.p3.2.m2.2.3.3.2.3" stretchy="false" xref="S7.SS2.p3.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.p3.2.m2.2b"><apply id="S7.SS2.p3.2.m2.2.3.cmml" xref="S7.SS2.p3.2.m2.2.3"><times id="S7.SS2.p3.2.m2.2.3.1.cmml" xref="S7.SS2.p3.2.m2.2.3.1"></times><ci id="S7.SS2.p3.2.m2.2.3.2.cmml" xref="S7.SS2.p3.2.m2.2.3.2">𝜑</ci><list id="S7.SS2.p3.2.m2.2.3.3.1.cmml" xref="S7.SS2.p3.2.m2.2.3.3.2"><apply id="S7.SS2.p3.2.m2.1.1.cmml" xref="S7.SS2.p3.2.m2.1.1"><ci id="S7.SS2.p3.2.m2.1.1.1.cmml" xref="S7.SS2.p3.2.m2.1.1.1">^</ci><ci id="S7.SS2.p3.2.m2.1.1.2.cmml" xref="S7.SS2.p3.2.m2.1.1.2">𝐵</ci></apply><ci id="S7.SS2.p3.2.m2.2.2.cmml" xref="S7.SS2.p3.2.m2.2.2">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p3.2.m2.2c">\varphi(\hat{B};R)</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p3.2.m2.2d">italic_φ ( over^ start_ARG italic_B end_ARG ; italic_R )</annotation></semantics></math> with a parameterized bias. This is done by considering continuous relative displacements, ensuring coverage of all conceivable offset values.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3 </span>Computational complexity</h3>
<div class="ltx_para" id="S7.SS3.p1">
<p class="ltx_p" id="S7.SS3.p1.1">Deformable bi-level routing attention (DBRA) incurs a comparable computation cost to its counterpart in the Swin Transformer. The computation of DBRA consists of two parts: token-to-token attention and offset &amp; sampling. Therefore, the computation of this part is:</p>
</div>
<div class="ltx_para" id="S7.SS3.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx4">
<tbody id="S7.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{lgathered}FLOPs_{def}=FLOPs_{attn}+FLOPs_{offset\&amp;sampling%
}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C\end{lgathered}FLOPs_{def}=%
FLOPs_{attn}+FLOPs_{offset\&amp;sampling}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C" class="ltx_Math" display="inline" id="S7.E18.m1.1"><semantics id="S7.E18.m1.1a"><mtable id="S7.E18.m1.1.1.2" rowspacing="0pt" xref="S7.E18.m1.1.1.1.cmml"><mtr id="S7.E18.m1.1.1.2a" xref="S7.E18.m1.1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E18.m1.1.1.2b" xref="S7.E18.m1.1.1.1.cmml"><mrow id="S7.E16.20.20a" xref="S7.E18.m1.1.1.1.cmml"><mrow id="S7.E16.20.20a.21" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E16.1.1.1" xref="S7.E16.1.1.1.cmml">F</mi><mo id="S7.E16.20.20a.21.1" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.2.2.2" xref="S7.E16.2.2.2.cmml">L</mi><mo id="S7.E16.20.20a.21.1a" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.3.3.3" xref="S7.E16.3.3.3.cmml">O</mi><mo id="S7.E16.20.20a.21.1b" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.4.4.4" xref="S7.E16.4.4.4.cmml">P</mi><mo id="S7.E16.20.20a.21.1c" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msub id="S7.E16.20.20a.21.2" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E16.5.5.5" xref="S7.E16.5.5.5.cmml">s</mi><mrow id="S7.E16.6.6.6.1" xref="S7.E16.6.6.6.1.cmml"><mi id="S7.E16.6.6.6.1.2" xref="S7.E16.6.6.6.1.2.cmml">d</mi><mo id="S7.E16.6.6.6.1.1" xref="S7.E16.6.6.6.1.1.cmml">⁢</mo><mi id="S7.E16.6.6.6.1.3" xref="S7.E16.6.6.6.1.3.cmml">e</mi><mo id="S7.E16.6.6.6.1.1a" xref="S7.E16.6.6.6.1.1.cmml">⁢</mo><mi id="S7.E16.6.6.6.1.4" xref="S7.E16.6.6.6.1.4.cmml">f</mi></mrow></msub></mrow><mo id="S7.E16.7.7.7" xref="S7.E16.7.7.7.cmml">=</mo><mrow id="S7.E16.20.20a.22" xref="S7.E18.m1.1.1.1.cmml"><mrow id="S7.E16.20.20a.22.1" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E16.8.8.8" xref="S7.E16.8.8.8.cmml">F</mi><mo id="S7.E16.20.20a.22.1.1" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.9.9.9" xref="S7.E16.9.9.9.cmml">L</mi><mo id="S7.E16.20.20a.22.1.1a" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.10.10.10" xref="S7.E16.10.10.10.cmml">O</mi><mo id="S7.E16.20.20a.22.1.1b" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.11.11.11" xref="S7.E16.11.11.11.cmml">P</mi><mo id="S7.E16.20.20a.22.1.1c" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msub id="S7.E16.20.20a.22.1.2" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E16.12.12.12" xref="S7.E16.12.12.12.cmml">s</mi><mrow id="S7.E16.13.13.13.1" xref="S7.E16.13.13.13.1.cmml"><mi id="S7.E16.13.13.13.1.2" xref="S7.E16.13.13.13.1.2.cmml">a</mi><mo id="S7.E16.13.13.13.1.1" xref="S7.E16.13.13.13.1.1.cmml">⁢</mo><mi id="S7.E16.13.13.13.1.3" xref="S7.E16.13.13.13.1.3.cmml">t</mi><mo id="S7.E16.13.13.13.1.1a" xref="S7.E16.13.13.13.1.1.cmml">⁢</mo><mi id="S7.E16.13.13.13.1.4" xref="S7.E16.13.13.13.1.4.cmml">t</mi><mo id="S7.E16.13.13.13.1.1b" xref="S7.E16.13.13.13.1.1.cmml">⁢</mo><mi id="S7.E16.13.13.13.1.5" xref="S7.E16.13.13.13.1.5.cmml">n</mi></mrow></msub></mrow><mo id="S7.E16.14.14.14" xref="S7.E16.14.14.14.cmml">+</mo><mrow id="S7.E16.20.20a.22.2" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E16.15.15.15" xref="S7.E16.15.15.15.cmml">F</mi><mo id="S7.E16.20.20a.22.2.1" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.16.16.16" xref="S7.E16.16.16.16.cmml">L</mi><mo id="S7.E16.20.20a.22.2.1a" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.17.17.17" xref="S7.E16.17.17.17.cmml">O</mi><mo id="S7.E16.20.20a.22.2.1b" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E16.18.18.18" xref="S7.E16.18.18.18.cmml">P</mi><mo id="S7.E16.20.20a.22.2.1c" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msub id="S7.E16.20.20a.22.2.2" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E16.19.19.19" xref="S7.E16.19.19.19.cmml">s</mi><mrow id="S7.E16.20.20.20.1" xref="S7.E16.20.20.20.1.cmml"><mrow id="S7.E16.20.20.20.1.2" xref="S7.E16.20.20.20.1.2.cmml"><mi id="S7.E16.20.20.20.1.2.2" xref="S7.E16.20.20.20.1.2.2.cmml">o</mi><mo id="S7.E16.20.20.20.1.2.1" xref="S7.E16.20.20.20.1.2.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.2.3" xref="S7.E16.20.20.20.1.2.3.cmml">f</mi><mo id="S7.E16.20.20.20.1.2.1a" xref="S7.E16.20.20.20.1.2.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.2.4" xref="S7.E16.20.20.20.1.2.4.cmml">f</mi><mo id="S7.E16.20.20.20.1.2.1b" xref="S7.E16.20.20.20.1.2.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.2.5" xref="S7.E16.20.20.20.1.2.5.cmml">s</mi><mo id="S7.E16.20.20.20.1.2.1c" xref="S7.E16.20.20.20.1.2.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.2.6" xref="S7.E16.20.20.20.1.2.6.cmml">e</mi><mo id="S7.E16.20.20.20.1.2.1d" xref="S7.E16.20.20.20.1.2.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.2.7" xref="S7.E16.20.20.20.1.2.7.cmml">t</mi></mrow><mo id="S7.E16.20.20.20.1.1" lspace="0.222em" rspace="0.222em" xref="S7.E16.20.20.20.1.1.cmml">&amp;</mo><mrow id="S7.E16.20.20.20.1.3" xref="S7.E16.20.20.20.1.3.cmml"><mi id="S7.E16.20.20.20.1.3.2" xref="S7.E16.20.20.20.1.3.2.cmml">s</mi><mo id="S7.E16.20.20.20.1.3.1" xref="S7.E16.20.20.20.1.3.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.3.3" xref="S7.E16.20.20.20.1.3.3.cmml">a</mi><mo id="S7.E16.20.20.20.1.3.1a" xref="S7.E16.20.20.20.1.3.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.3.4" xref="S7.E16.20.20.20.1.3.4.cmml">m</mi><mo id="S7.E16.20.20.20.1.3.1b" xref="S7.E16.20.20.20.1.3.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.3.5" xref="S7.E16.20.20.20.1.3.5.cmml">p</mi><mo id="S7.E16.20.20.20.1.3.1c" xref="S7.E16.20.20.20.1.3.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.3.6" xref="S7.E16.20.20.20.1.3.6.cmml">l</mi><mo id="S7.E16.20.20.20.1.3.1d" xref="S7.E16.20.20.20.1.3.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.3.7" xref="S7.E16.20.20.20.1.3.7.cmml">i</mi><mo id="S7.E16.20.20.20.1.3.1e" xref="S7.E16.20.20.20.1.3.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.3.8" xref="S7.E16.20.20.20.1.3.8.cmml">n</mi><mo id="S7.E16.20.20.20.1.3.1f" xref="S7.E16.20.20.20.1.3.1.cmml">⁢</mo><mi id="S7.E16.20.20.20.1.3.9" xref="S7.E16.20.20.20.1.3.9.cmml">g</mi></mrow></mrow></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E18.m1.1.1.2c" xref="S7.E18.m1.1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E18.m1.1.1.2d" xref="S7.E18.m1.1.1.1.cmml"><mrow id="S7.E17.30.30" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E17.30.30.31" xref="S7.E18.m1.1.1.1a.cmml"></mi><mo id="S7.E17.1.1.1" xref="S7.E17.1.1.1.cmml">=</mo><mrow id="S7.E17.30.30.30" xref="S7.E18.m1.1.1.1.cmml"><mrow id="S7.E17.30.30.30.2" xref="S7.E18.m1.1.1.1.cmml"><mn id="S7.E17.2.2.2" xref="S7.E17.2.2.2.cmml">2</mn><mo id="S7.E17.30.30.30.2.1" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E17.3.3.3" xref="S7.E17.3.3.3.cmml">H</mi><mo id="S7.E17.30.30.30.2.1a" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E17.4.4.4" xref="S7.E17.4.4.4.cmml">W</mi><mo id="S7.E17.30.30.30.2.1b" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msub id="S7.E17.30.30.30.2.2" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E17.5.5.5" xref="S7.E17.5.5.5.cmml">N</mi><mi id="S7.E17.6.6.6.1" xref="S7.E17.6.6.6.1.cmml">s</mi></msub><mo id="S7.E17.30.30.30.2.1c" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E17.7.7.7" xref="S7.E17.7.7.7.cmml">C</mi></mrow><mo id="S7.E17.8.8.8" xref="S7.E17.8.8.8.cmml">+</mo><mrow id="S7.E17.30.30.30.3" xref="S7.E18.m1.1.1.1.cmml"><mn id="S7.E17.9.9.9" xref="S7.E17.9.9.9.cmml">2</mn><mo id="S7.E17.30.30.30.3.1" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E17.10.10.10" xref="S7.E17.10.10.10.cmml">H</mi><mo id="S7.E17.30.30.30.3.1a" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E17.11.11.11" xref="S7.E17.11.11.11.cmml">W</mi><mo id="S7.E17.30.30.30.3.1b" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msup id="S7.E17.30.30.30.3.2" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E17.12.12.12" xref="S7.E17.12.12.12.cmml">C</mi><mn id="S7.E17.13.13.13.1" xref="S7.E17.13.13.13.1.cmml">2</mn></msup></mrow><mo id="S7.E17.8.8.8a" xref="S7.E17.8.8.8.cmml">+</mo><mrow id="S7.E17.30.30.30.4" xref="S7.E18.m1.1.1.1.cmml"><mn id="S7.E17.15.15.15" xref="S7.E17.15.15.15.cmml">2</mn><mo id="S7.E17.30.30.30.4.1" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msub id="S7.E17.30.30.30.4.2" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E17.16.16.16" xref="S7.E17.16.16.16.cmml">N</mi><mi id="S7.E17.17.17.17.1" xref="S7.E17.17.17.17.1.cmml">s</mi></msub><mo id="S7.E17.30.30.30.4.1a" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msup id="S7.E17.30.30.30.4.3" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E17.18.18.18" xref="S7.E17.18.18.18.cmml">C</mi><mn id="S7.E17.19.19.19.1" xref="S7.E17.19.19.19.1.cmml">2</mn></msup></mrow><mo id="S7.E17.8.8.8b" xref="S7.E17.8.8.8.cmml">+</mo><mrow id="S7.E17.30.30.30.1" xref="S7.E18.m1.1.1.1.cmml"><mrow id="S7.E17.30.30.30.1.1.1" xref="S7.E18.m1.1.1.1.cmml"><mo id="S7.E17.21.21.21" stretchy="false" xref="S7.E18.m1.1.1.1a.cmml">(</mo><mrow id="S7.E17.30.30.30.1.1.1.1" xref="S7.E18.m1.1.1.1.cmml"><msup id="S7.E17.30.30.30.1.1.1.1.1" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E17.22.22.22" xref="S7.E17.22.22.22.cmml">k</mi><mn id="S7.E17.23.23.23.1" xref="S7.E17.23.23.23.1.cmml">2</mn></msup><mo id="S7.E17.24.24.24" xref="S7.E17.24.24.24.cmml">+</mo><mn id="S7.E17.25.25.25" xref="S7.E17.25.25.25.cmml">6</mn></mrow><mo id="S7.E17.26.26.26" stretchy="false" xref="S7.E18.m1.1.1.1a.cmml">)</mo></mrow><mo id="S7.E17.30.30.30.1.2" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><msub id="S7.E17.30.30.30.1.3" xref="S7.E18.m1.1.1.1.cmml"><mi id="S7.E17.27.27.27" xref="S7.E17.27.27.27.cmml">N</mi><mi id="S7.E17.28.28.28.1" xref="S7.E17.28.28.28.1.cmml">s</mi></msub><mo id="S7.E17.30.30.30.1.2a" xref="S7.E18.m1.1.1.1a.cmml">⁢</mo><mi id="S7.E17.29.29.29" xref="S7.E17.29.29.29.cmml">C</mi></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S7.E18.m1.1b"><apply id="S7.E18.m1.1.1.1.cmml" xref="S7.E18.m1.1.1.2"><and id="S7.E18.m1.1.1.1a.cmml" xref="S7.E16.20.20a.21.1"></and><apply id="S7.E18.m1.1.1.1b.cmml" xref="S7.E18.m1.1.1.2"><eq id="S7.E16.7.7.7.cmml" xref="S7.E16.7.7.7"></eq><apply id="S7.E18.m1.1.1.1.3.cmml" xref="S7.E18.m1.1.1.2"><times id="S7.E18.m1.1.1.1.3.1.cmml" xref="S7.E16.20.20a.21.1"></times><ci id="S7.E16.1.1.1.cmml" xref="S7.E16.1.1.1">𝐹</ci><ci id="S7.E16.2.2.2.cmml" xref="S7.E16.2.2.2">𝐿</ci><ci id="S7.E16.3.3.3.cmml" xref="S7.E16.3.3.3">𝑂</ci><ci id="S7.E16.4.4.4.cmml" xref="S7.E16.4.4.4">𝑃</ci><apply id="S7.E18.m1.1.1.1.3.6.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.3.6.1.cmml" xref="S7.E16.20.20a.21.1">subscript</csymbol><ci id="S7.E16.5.5.5.cmml" xref="S7.E16.5.5.5">𝑠</ci><apply id="S7.E16.6.6.6.1.cmml" xref="S7.E16.6.6.6.1"><times id="S7.E16.6.6.6.1.1.cmml" xref="S7.E16.6.6.6.1.1"></times><ci id="S7.E16.6.6.6.1.2.cmml" xref="S7.E16.6.6.6.1.2">𝑑</ci><ci id="S7.E16.6.6.6.1.3.cmml" xref="S7.E16.6.6.6.1.3">𝑒</ci><ci id="S7.E16.6.6.6.1.4.cmml" xref="S7.E16.6.6.6.1.4">𝑓</ci></apply></apply></apply><apply id="S7.E18.m1.1.1.1.5.cmml" xref="S7.E18.m1.1.1.2"><plus id="S7.E16.14.14.14.cmml" xref="S7.E16.14.14.14"></plus><apply id="S7.E18.m1.1.1.1.5.2.cmml" xref="S7.E18.m1.1.1.2"><times id="S7.E18.m1.1.1.1.5.2.1.cmml" xref="S7.E16.20.20a.21.1"></times><ci id="S7.E16.8.8.8.cmml" xref="S7.E16.8.8.8">𝐹</ci><ci id="S7.E16.9.9.9.cmml" xref="S7.E16.9.9.9">𝐿</ci><ci id="S7.E16.10.10.10.cmml" xref="S7.E16.10.10.10">𝑂</ci><ci id="S7.E16.11.11.11.cmml" xref="S7.E16.11.11.11">𝑃</ci><apply id="S7.E18.m1.1.1.1.5.2.6.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.5.2.6.1.cmml" xref="S7.E16.20.20a.21.1">subscript</csymbol><ci id="S7.E16.12.12.12.cmml" xref="S7.E16.12.12.12">𝑠</ci><apply id="S7.E16.13.13.13.1.cmml" xref="S7.E16.13.13.13.1"><times id="S7.E16.13.13.13.1.1.cmml" xref="S7.E16.13.13.13.1.1"></times><ci id="S7.E16.13.13.13.1.2.cmml" xref="S7.E16.13.13.13.1.2">𝑎</ci><ci id="S7.E16.13.13.13.1.3.cmml" xref="S7.E16.13.13.13.1.3">𝑡</ci><ci id="S7.E16.13.13.13.1.4.cmml" xref="S7.E16.13.13.13.1.4">𝑡</ci><ci id="S7.E16.13.13.13.1.5.cmml" xref="S7.E16.13.13.13.1.5">𝑛</ci></apply></apply></apply><apply id="S7.E18.m1.1.1.1.5.3.cmml" xref="S7.E18.m1.1.1.2"><times id="S7.E18.m1.1.1.1.5.3.1.cmml" xref="S7.E16.20.20a.21.1"></times><ci id="S7.E16.15.15.15.cmml" xref="S7.E16.15.15.15">𝐹</ci><ci id="S7.E16.16.16.16.cmml" xref="S7.E16.16.16.16">𝐿</ci><ci id="S7.E16.17.17.17.cmml" xref="S7.E16.17.17.17">𝑂</ci><ci id="S7.E16.18.18.18.cmml" xref="S7.E16.18.18.18">𝑃</ci><apply id="S7.E18.m1.1.1.1.5.3.6.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.5.3.6.1.cmml" xref="S7.E16.20.20a.21.1">subscript</csymbol><ci id="S7.E16.19.19.19.cmml" xref="S7.E16.19.19.19">𝑠</ci><apply id="S7.E16.20.20.20.1.cmml" xref="S7.E16.20.20.20.1"><and id="S7.E16.20.20.20.1.1.cmml" xref="S7.E16.20.20.20.1.1"></and><apply id="S7.E16.20.20.20.1.2.cmml" xref="S7.E16.20.20.20.1.2"><times id="S7.E16.20.20.20.1.2.1.cmml" xref="S7.E16.20.20.20.1.2.1"></times><ci id="S7.E16.20.20.20.1.2.2.cmml" xref="S7.E16.20.20.20.1.2.2">𝑜</ci><ci id="S7.E16.20.20.20.1.2.3.cmml" xref="S7.E16.20.20.20.1.2.3">𝑓</ci><ci id="S7.E16.20.20.20.1.2.4.cmml" xref="S7.E16.20.20.20.1.2.4">𝑓</ci><ci id="S7.E16.20.20.20.1.2.5.cmml" xref="S7.E16.20.20.20.1.2.5">𝑠</ci><ci id="S7.E16.20.20.20.1.2.6.cmml" xref="S7.E16.20.20.20.1.2.6">𝑒</ci><ci id="S7.E16.20.20.20.1.2.7.cmml" xref="S7.E16.20.20.20.1.2.7">𝑡</ci></apply><apply id="S7.E16.20.20.20.1.3.cmml" xref="S7.E16.20.20.20.1.3"><times id="S7.E16.20.20.20.1.3.1.cmml" xref="S7.E16.20.20.20.1.3.1"></times><ci id="S7.E16.20.20.20.1.3.2.cmml" xref="S7.E16.20.20.20.1.3.2">𝑠</ci><ci id="S7.E16.20.20.20.1.3.3.cmml" xref="S7.E16.20.20.20.1.3.3">𝑎</ci><ci id="S7.E16.20.20.20.1.3.4.cmml" xref="S7.E16.20.20.20.1.3.4">𝑚</ci><ci id="S7.E16.20.20.20.1.3.5.cmml" xref="S7.E16.20.20.20.1.3.5">𝑝</ci><ci id="S7.E16.20.20.20.1.3.6.cmml" xref="S7.E16.20.20.20.1.3.6">𝑙</ci><ci id="S7.E16.20.20.20.1.3.7.cmml" xref="S7.E16.20.20.20.1.3.7">𝑖</ci><ci id="S7.E16.20.20.20.1.3.8.cmml" xref="S7.E16.20.20.20.1.3.8">𝑛</ci><ci id="S7.E16.20.20.20.1.3.9.cmml" xref="S7.E16.20.20.20.1.3.9">𝑔</ci></apply></apply></apply></apply></apply></apply><apply id="S7.E18.m1.1.1.1c.cmml" xref="S7.E18.m1.1.1.2"><eq id="S7.E17.1.1.1.cmml" xref="S7.E17.1.1.1"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.E18.m1.1.1.1.5.cmml" id="S7.E18.m1.1.1.1d.cmml" xref="S7.E16.20.20a.21.1"></share><apply id="S7.E18.m1.1.1.1.1.cmml" xref="S7.E18.m1.1.1.2"><plus id="S7.E17.8.8.8.cmml" xref="S7.E17.8.8.8"></plus><apply id="S7.E18.m1.1.1.1.1.3.cmml" xref="S7.E18.m1.1.1.2"><times id="S7.E18.m1.1.1.1.1.3.1.cmml" xref="S7.E16.20.20a.21.1"></times><cn id="S7.E17.2.2.2.cmml" type="integer" xref="S7.E17.2.2.2">2</cn><ci id="S7.E17.3.3.3.cmml" xref="S7.E17.3.3.3">𝐻</ci><ci id="S7.E17.4.4.4.cmml" xref="S7.E17.4.4.4">𝑊</ci><apply id="S7.E18.m1.1.1.1.1.3.5.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.1.3.5.1.cmml" xref="S7.E16.20.20a.21.1">subscript</csymbol><ci id="S7.E17.5.5.5.cmml" xref="S7.E17.5.5.5">𝑁</ci><ci id="S7.E17.6.6.6.1.cmml" xref="S7.E17.6.6.6.1">𝑠</ci></apply><ci id="S7.E17.7.7.7.cmml" xref="S7.E17.7.7.7">𝐶</ci></apply><apply id="S7.E18.m1.1.1.1.1.4.cmml" xref="S7.E18.m1.1.1.2"><times id="S7.E18.m1.1.1.1.1.4.1.cmml" xref="S7.E16.20.20a.21.1"></times><cn id="S7.E17.9.9.9.cmml" type="integer" xref="S7.E17.9.9.9">2</cn><ci id="S7.E17.10.10.10.cmml" xref="S7.E17.10.10.10">𝐻</ci><ci id="S7.E17.11.11.11.cmml" xref="S7.E17.11.11.11">𝑊</ci><apply id="S7.E18.m1.1.1.1.1.4.5.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.1.4.5.1.cmml" xref="S7.E16.20.20a.21.1">superscript</csymbol><ci id="S7.E17.12.12.12.cmml" xref="S7.E17.12.12.12">𝐶</ci><cn id="S7.E17.13.13.13.1.cmml" type="integer" xref="S7.E17.13.13.13.1">2</cn></apply></apply><apply id="S7.E18.m1.1.1.1.1.5.cmml" xref="S7.E18.m1.1.1.2"><times id="S7.E18.m1.1.1.1.1.5.1.cmml" xref="S7.E16.20.20a.21.1"></times><cn id="S7.E17.15.15.15.cmml" type="integer" xref="S7.E17.15.15.15">2</cn><apply id="S7.E18.m1.1.1.1.1.5.3.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.1.5.3.1.cmml" xref="S7.E16.20.20a.21.1">subscript</csymbol><ci id="S7.E17.16.16.16.cmml" xref="S7.E17.16.16.16">𝑁</ci><ci id="S7.E17.17.17.17.1.cmml" xref="S7.E17.17.17.17.1">𝑠</ci></apply><apply id="S7.E18.m1.1.1.1.1.5.4.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.1.5.4.1.cmml" xref="S7.E16.20.20a.21.1">superscript</csymbol><ci id="S7.E17.18.18.18.cmml" xref="S7.E17.18.18.18">𝐶</ci><cn id="S7.E17.19.19.19.1.cmml" type="integer" xref="S7.E17.19.19.19.1">2</cn></apply></apply><apply id="S7.E18.m1.1.1.1.1.1.cmml" xref="S7.E18.m1.1.1.2"><times id="S7.E18.m1.1.1.1.1.1.2.cmml" xref="S7.E16.20.20a.21.1"></times><apply id="S7.E18.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E18.m1.1.1.2"><plus id="S7.E17.24.24.24.cmml" xref="S7.E17.24.24.24"></plus><apply id="S7.E18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S7.E18.m1.1.1.2">superscript</csymbol><ci id="S7.E17.22.22.22.cmml" xref="S7.E17.22.22.22">𝑘</ci><cn id="S7.E17.23.23.23.1.cmml" type="integer" xref="S7.E17.23.23.23.1">2</cn></apply><cn id="S7.E17.25.25.25.cmml" type="integer" xref="S7.E17.25.25.25">6</cn></apply><apply id="S7.E18.m1.1.1.1.1.1.3.cmml" xref="S7.E18.m1.1.1.2"><csymbol cd="ambiguous" id="S7.E18.m1.1.1.1.1.1.3.1.cmml" xref="S7.E16.20.20a.21.1">subscript</csymbol><ci id="S7.E17.27.27.27.cmml" xref="S7.E17.27.27.27">𝑁</ci><ci id="S7.E17.28.28.28.1.cmml" xref="S7.E17.28.28.28.1">𝑠</ci></apply><ci id="S7.E17.29.29.29.cmml" xref="S7.E17.29.29.29">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E18.m1.1c">\displaystyle\begin{lgathered}FLOPs_{def}=FLOPs_{attn}+FLOPs_{offset\&amp;sampling%
}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C\end{lgathered}FLOPs_{def}=%
FLOPs_{attn}+FLOPs_{offset\&amp;sampling}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C</annotation><annotation encoding="application/x-llamapun" id="S7.E18.m1.1d">start_ROW start_CELL italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_d italic_e italic_f end_POSTSUBSCRIPT = italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT + italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_o italic_f italic_f italic_s italic_e italic_t &amp; italic_s italic_a italic_m italic_p italic_l italic_i italic_n italic_g end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL = 2 italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C + 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( italic_k start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 6 ) italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S7.SS3.p2.2">where <math alttext="N_{s}=HW/r^{2}" class="ltx_Math" display="inline" id="S7.SS3.p2.1.m1.1"><semantics id="S7.SS3.p2.1.m1.1a"><mrow id="S7.SS3.p2.1.m1.1.1" xref="S7.SS3.p2.1.m1.1.1.cmml"><msub id="S7.SS3.p2.1.m1.1.1.2" xref="S7.SS3.p2.1.m1.1.1.2.cmml"><mi id="S7.SS3.p2.1.m1.1.1.2.2" xref="S7.SS3.p2.1.m1.1.1.2.2.cmml">N</mi><mi id="S7.SS3.p2.1.m1.1.1.2.3" xref="S7.SS3.p2.1.m1.1.1.2.3.cmml">s</mi></msub><mo id="S7.SS3.p2.1.m1.1.1.1" xref="S7.SS3.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S7.SS3.p2.1.m1.1.1.3" xref="S7.SS3.p2.1.m1.1.1.3.cmml"><mrow id="S7.SS3.p2.1.m1.1.1.3.2" xref="S7.SS3.p2.1.m1.1.1.3.2.cmml"><mi id="S7.SS3.p2.1.m1.1.1.3.2.2" xref="S7.SS3.p2.1.m1.1.1.3.2.2.cmml">H</mi><mo id="S7.SS3.p2.1.m1.1.1.3.2.1" xref="S7.SS3.p2.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S7.SS3.p2.1.m1.1.1.3.2.3" xref="S7.SS3.p2.1.m1.1.1.3.2.3.cmml">W</mi></mrow><mo id="S7.SS3.p2.1.m1.1.1.3.1" xref="S7.SS3.p2.1.m1.1.1.3.1.cmml">/</mo><msup id="S7.SS3.p2.1.m1.1.1.3.3" xref="S7.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S7.SS3.p2.1.m1.1.1.3.3.2" xref="S7.SS3.p2.1.m1.1.1.3.3.2.cmml">r</mi><mn id="S7.SS3.p2.1.m1.1.1.3.3.3" xref="S7.SS3.p2.1.m1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p2.1.m1.1b"><apply id="S7.SS3.p2.1.m1.1.1.cmml" xref="S7.SS3.p2.1.m1.1.1"><eq id="S7.SS3.p2.1.m1.1.1.1.cmml" xref="S7.SS3.p2.1.m1.1.1.1"></eq><apply id="S7.SS3.p2.1.m1.1.1.2.cmml" xref="S7.SS3.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S7.SS3.p2.1.m1.1.1.2.1.cmml" xref="S7.SS3.p2.1.m1.1.1.2">subscript</csymbol><ci id="S7.SS3.p2.1.m1.1.1.2.2.cmml" xref="S7.SS3.p2.1.m1.1.1.2.2">𝑁</ci><ci id="S7.SS3.p2.1.m1.1.1.2.3.cmml" xref="S7.SS3.p2.1.m1.1.1.2.3">𝑠</ci></apply><apply id="S7.SS3.p2.1.m1.1.1.3.cmml" xref="S7.SS3.p2.1.m1.1.1.3"><divide id="S7.SS3.p2.1.m1.1.1.3.1.cmml" xref="S7.SS3.p2.1.m1.1.1.3.1"></divide><apply id="S7.SS3.p2.1.m1.1.1.3.2.cmml" xref="S7.SS3.p2.1.m1.1.1.3.2"><times id="S7.SS3.p2.1.m1.1.1.3.2.1.cmml" xref="S7.SS3.p2.1.m1.1.1.3.2.1"></times><ci id="S7.SS3.p2.1.m1.1.1.3.2.2.cmml" xref="S7.SS3.p2.1.m1.1.1.3.2.2">𝐻</ci><ci id="S7.SS3.p2.1.m1.1.1.3.2.3.cmml" xref="S7.SS3.p2.1.m1.1.1.3.2.3">𝑊</ci></apply><apply id="S7.SS3.p2.1.m1.1.1.3.3.cmml" xref="S7.SS3.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S7.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S7.SS3.p2.1.m1.1.1.3.3">superscript</csymbol><ci id="S7.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S7.SS3.p2.1.m1.1.1.3.3.2">𝑟</ci><cn id="S7.SS3.p2.1.m1.1.1.3.3.3.cmml" type="integer" xref="S7.SS3.p2.1.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p2.1.m1.1c">N_{s}=HW/r^{2}</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_H italic_W / italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is the number of sampled points, and <math alttext="C" class="ltx_Math" display="inline" id="S7.SS3.p2.2.m2.1"><semantics id="S7.SS3.p2.2.m2.1a"><mi id="S7.SS3.p2.2.m2.1.1" xref="S7.SS3.p2.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S7.SS3.p2.2.m2.1b"><ci id="S7.SS3.p2.2.m2.1.1.cmml" xref="S7.SS3.p2.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p2.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p2.2.m2.1d">italic_C</annotation></semantics></math> is the token embedding dimension. The computation of bi-level routing multi-head attention consists of three parts: linear projection, region-to-region routing, and token-to-token attention. Hence, the computation of this part is:</p>
</div>
<div class="ltx_para" id="S7.SS3.p3">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx5">
<tbody id="S7.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{lgathered}FLOPs_{bi}=FLOPs_{proj}+FLOPs_{routing}+FLOPs_{%
attn}\\
=2HWC^{2}+2N_{s}C^{2}+2(S^{2})^{2}C+2HWk\frac{N_{s}}{S^{2}}C\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+2HWk\frac{N_{s}}{S^{2}}\}\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+\frac{kHWN_{s}}{S^{2}}+\frac{kHWN_{s}}{S^{2}}%
\}\\
\geq 2HWC^{2}+2N_{s}C^{2}+3C\{2S^{4}\cdot\frac{kHWN_{s}}{S^{2}}\cdot\frac{kHWN%
_{s}}{S^{2}}\}^{\frac{1}{3}}\\
=2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\end{%
lgathered}FLOPs_{bi}=FLOPs_{proj}+FLOPs_{routing}+FLOPs_{attn}\\
=2HWC^{2}+2N_{s}C^{2}+2(S^{2})^{2}C+2HWk\frac{N_{s}}{S^{2}}C\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+2HWk\frac{N_{s}}{S^{2}}\}\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+\frac{kHWN_{s}}{S^{2}}+\frac{kHWN_{s}}{S^{2}}%
\}\\
\geq 2HWC^{2}+2N_{s}C^{2}+3C\{2S^{4}\cdot\frac{kHWN_{s}}{S^{2}}\cdot\frac{kHWN%
_{s}}{S^{2}}\}^{\frac{1}{3}}\\
=2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}" class="ltx_Math" display="inline" id="S7.E25.m1.5"><semantics id="S7.E25.m1.5a"><mtable id="S7.E25.m1.5.5.6" rowspacing="0pt" xref="S7.E25.m1.5.5.5.cmml"><mtr id="S7.E25.m1.5.5.6a" xref="S7.E25.m1.5.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E25.m1.5.5.6b" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E19.27.27a" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E19.27.27a.28" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.1.1.1" xref="S7.E19.1.1.1.cmml">F</mi><mo id="S7.E19.27.27a.28.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.2.2.2" xref="S7.E19.2.2.2.cmml">L</mi><mo id="S7.E19.27.27a.28.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.3.3.3" xref="S7.E19.3.3.3.cmml">O</mi><mo id="S7.E19.27.27a.28.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.4.4.4" xref="S7.E19.4.4.4.cmml">P</mi><mo id="S7.E19.27.27a.28.1c" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E19.27.27a.28.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.5.5.5" xref="S7.E19.5.5.5.cmml">s</mi><mrow id="S7.E19.6.6.6.1" xref="S7.E19.6.6.6.1.cmml"><mi id="S7.E19.6.6.6.1.2" xref="S7.E19.6.6.6.1.2.cmml">b</mi><mo id="S7.E19.6.6.6.1.1" xref="S7.E19.6.6.6.1.1.cmml">⁢</mo><mi id="S7.E19.6.6.6.1.3" xref="S7.E19.6.6.6.1.3.cmml">i</mi></mrow></msub></mrow><mo id="S7.E19.7.7.7" xref="S7.E19.7.7.7.cmml">=</mo><mrow id="S7.E19.27.27a.29" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E19.27.27a.29.1" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.8.8.8" xref="S7.E19.8.8.8.cmml">F</mi><mo id="S7.E19.27.27a.29.1.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.9.9.9" xref="S7.E19.9.9.9.cmml">L</mi><mo id="S7.E19.27.27a.29.1.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.10.10.10" xref="S7.E19.10.10.10.cmml">O</mi><mo id="S7.E19.27.27a.29.1.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.11.11.11" xref="S7.E19.11.11.11.cmml">P</mi><mo id="S7.E19.27.27a.29.1.1c" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E19.27.27a.29.1.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.12.12.12" xref="S7.E19.12.12.12.cmml">s</mi><mrow id="S7.E19.13.13.13.1" xref="S7.E19.13.13.13.1.cmml"><mi id="S7.E19.13.13.13.1.2" xref="S7.E19.13.13.13.1.2.cmml">p</mi><mo id="S7.E19.13.13.13.1.1" xref="S7.E19.13.13.13.1.1.cmml">⁢</mo><mi id="S7.E19.13.13.13.1.3" xref="S7.E19.13.13.13.1.3.cmml">r</mi><mo id="S7.E19.13.13.13.1.1a" xref="S7.E19.13.13.13.1.1.cmml">⁢</mo><mi id="S7.E19.13.13.13.1.4" xref="S7.E19.13.13.13.1.4.cmml">o</mi><mo id="S7.E19.13.13.13.1.1b" xref="S7.E19.13.13.13.1.1.cmml">⁢</mo><mi id="S7.E19.13.13.13.1.5" xref="S7.E19.13.13.13.1.5.cmml">j</mi></mrow></msub></mrow><mo id="S7.E19.14.14.14" xref="S7.E19.14.14.14.cmml">+</mo><mrow id="S7.E19.27.27a.29.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.15.15.15" xref="S7.E19.15.15.15.cmml">F</mi><mo id="S7.E19.27.27a.29.2.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.16.16.16" xref="S7.E19.16.16.16.cmml">L</mi><mo id="S7.E19.27.27a.29.2.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.17.17.17" xref="S7.E19.17.17.17.cmml">O</mi><mo id="S7.E19.27.27a.29.2.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.18.18.18" xref="S7.E19.18.18.18.cmml">P</mi><mo id="S7.E19.27.27a.29.2.1c" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E19.27.27a.29.2.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.19.19.19" xref="S7.E19.19.19.19.cmml">s</mi><mrow id="S7.E19.20.20.20.1" xref="S7.E19.20.20.20.1.cmml"><mi id="S7.E19.20.20.20.1.2" xref="S7.E19.20.20.20.1.2.cmml">r</mi><mo id="S7.E19.20.20.20.1.1" xref="S7.E19.20.20.20.1.1.cmml">⁢</mo><mi id="S7.E19.20.20.20.1.3" xref="S7.E19.20.20.20.1.3.cmml">o</mi><mo id="S7.E19.20.20.20.1.1a" xref="S7.E19.20.20.20.1.1.cmml">⁢</mo><mi id="S7.E19.20.20.20.1.4" xref="S7.E19.20.20.20.1.4.cmml">u</mi><mo id="S7.E19.20.20.20.1.1b" xref="S7.E19.20.20.20.1.1.cmml">⁢</mo><mi id="S7.E19.20.20.20.1.5" xref="S7.E19.20.20.20.1.5.cmml">t</mi><mo id="S7.E19.20.20.20.1.1c" xref="S7.E19.20.20.20.1.1.cmml">⁢</mo><mi id="S7.E19.20.20.20.1.6" xref="S7.E19.20.20.20.1.6.cmml">i</mi><mo id="S7.E19.20.20.20.1.1d" xref="S7.E19.20.20.20.1.1.cmml">⁢</mo><mi id="S7.E19.20.20.20.1.7" xref="S7.E19.20.20.20.1.7.cmml">n</mi><mo id="S7.E19.20.20.20.1.1e" xref="S7.E19.20.20.20.1.1.cmml">⁢</mo><mi id="S7.E19.20.20.20.1.8" xref="S7.E19.20.20.20.1.8.cmml">g</mi></mrow></msub></mrow><mo id="S7.E19.14.14.14a" xref="S7.E19.14.14.14.cmml">+</mo><mrow id="S7.E19.27.27a.29.3" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.22.22.22" xref="S7.E19.22.22.22.cmml">F</mi><mo id="S7.E19.27.27a.29.3.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.23.23.23" xref="S7.E19.23.23.23.cmml">L</mi><mo id="S7.E19.27.27a.29.3.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.24.24.24" xref="S7.E19.24.24.24.cmml">O</mi><mo id="S7.E19.27.27a.29.3.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E19.25.25.25" xref="S7.E19.25.25.25.cmml">P</mi><mo id="S7.E19.27.27a.29.3.1c" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E19.27.27a.29.3.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E19.26.26.26" xref="S7.E19.26.26.26.cmml">s</mi><mrow id="S7.E19.27.27.27.1" xref="S7.E19.27.27.27.1.cmml"><mi id="S7.E19.27.27.27.1.2" xref="S7.E19.27.27.27.1.2.cmml">a</mi><mo id="S7.E19.27.27.27.1.1" xref="S7.E19.27.27.27.1.1.cmml">⁢</mo><mi id="S7.E19.27.27.27.1.3" xref="S7.E19.27.27.27.1.3.cmml">t</mi><mo id="S7.E19.27.27.27.1.1a" xref="S7.E19.27.27.27.1.1.cmml">⁢</mo><mi id="S7.E19.27.27.27.1.4" xref="S7.E19.27.27.27.1.4.cmml">t</mi><mo id="S7.E19.27.27.27.1.1b" xref="S7.E19.27.27.27.1.1.cmml">⁢</mo><mi id="S7.E19.27.27.27.1.5" xref="S7.E19.27.27.27.1.5.cmml">n</mi></mrow></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E25.m1.5.5.6c" xref="S7.E25.m1.5.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E25.m1.5.5.6d" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E20.28.28" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E20.28.28.29" xref="S7.E25.m1.5.5.5a.cmml"></mi><mo id="S7.E20.1.1.1" xref="S7.E20.1.1.1.cmml">=</mo><mrow id="S7.E20.28.28.28" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E20.28.28.28.2" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E20.2.2.2" xref="S7.E20.2.2.2.cmml">2</mn><mo id="S7.E20.28.28.28.2.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E20.3.3.3" xref="S7.E20.3.3.3.cmml">H</mi><mo id="S7.E20.28.28.28.2.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E20.4.4.4" xref="S7.E20.4.4.4.cmml">W</mi><mo id="S7.E20.28.28.28.2.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E20.28.28.28.2.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E20.5.5.5" xref="S7.E20.5.5.5.cmml">C</mi><mn id="S7.E20.6.6.6.1" xref="S7.E20.6.6.6.1.cmml">2</mn></msup></mrow><mo id="S7.E20.7.7.7" xref="S7.E20.7.7.7.cmml">+</mo><mrow id="S7.E20.28.28.28.3" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E20.8.8.8" xref="S7.E20.8.8.8.cmml">2</mn><mo id="S7.E20.28.28.28.3.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E20.28.28.28.3.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E20.9.9.9" xref="S7.E20.9.9.9.cmml">N</mi><mi id="S7.E20.10.10.10.1" xref="S7.E20.10.10.10.1.cmml">s</mi></msub><mo id="S7.E20.28.28.28.3.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E20.28.28.28.3.3" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E20.11.11.11" xref="S7.E20.11.11.11.cmml">C</mi><mn id="S7.E20.12.12.12.1" xref="S7.E20.12.12.12.1.cmml">2</mn></msup></mrow><mo id="S7.E20.7.7.7a" xref="S7.E20.7.7.7.cmml">+</mo><mrow id="S7.E20.28.28.28.1" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E20.14.14.14" xref="S7.E20.14.14.14.cmml">2</mn><mo id="S7.E20.28.28.28.1.2" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E20.28.28.28.1.1" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E20.28.28.28.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mo id="S7.E20.15.15.15" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">(</mo><msup id="S7.E20.28.28.28.1.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E20.16.16.16" xref="S7.E20.16.16.16.cmml">S</mi><mn id="S7.E20.17.17.17.1" xref="S7.E20.17.17.17.1.cmml">2</mn></msup><mo id="S7.E20.18.18.18" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">)</mo></mrow><mn id="S7.E20.19.19.19.1" xref="S7.E20.19.19.19.1.cmml">2</mn></msup><mo id="S7.E20.28.28.28.1.2a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E20.20.20.20" xref="S7.E20.20.20.20.cmml">C</mi></mrow><mo id="S7.E20.7.7.7b" xref="S7.E20.7.7.7.cmml">+</mo><mrow id="S7.E20.28.28.28.4" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E20.22.22.22" xref="S7.E20.22.22.22.cmml">2</mn><mo id="S7.E20.28.28.28.4.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E20.23.23.23" xref="S7.E20.23.23.23.cmml">H</mi><mo id="S7.E20.28.28.28.4.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E20.24.24.24" xref="S7.E20.24.24.24.cmml">W</mi><mo id="S7.E20.28.28.28.4.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E20.25.25.25" xref="S7.E20.25.25.25.cmml">k</mi><mo id="S7.E20.28.28.28.4.1c" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mstyle displaystyle="true" id="S7.E20.26.26.26" xref="S7.E20.26.26.26.cmml"><mfrac id="S7.E20.26.26.26a" xref="S7.E20.26.26.26.cmml"><msub id="S7.E20.26.26.26.2" xref="S7.E20.26.26.26.2.cmml"><mi id="S7.E20.26.26.26.2.2" xref="S7.E20.26.26.26.2.2.cmml">N</mi><mi id="S7.E20.26.26.26.2.3" xref="S7.E20.26.26.26.2.3.cmml">s</mi></msub><msup id="S7.E20.26.26.26.3" xref="S7.E20.26.26.26.3.cmml"><mi id="S7.E20.26.26.26.3.2" xref="S7.E20.26.26.26.3.2.cmml">S</mi><mn id="S7.E20.26.26.26.3.3" xref="S7.E20.26.26.26.3.3.cmml">2</mn></msup></mfrac></mstyle><mo id="S7.E20.28.28.28.4.1d" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E20.27.27.27" xref="S7.E20.27.27.27.cmml">C</mi></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E25.m1.5.5.6e" xref="S7.E25.m1.5.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E25.m1.5.5.6f" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E21.26.26" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E21.26.26.27" xref="S7.E25.m1.5.5.5a.cmml"></mi><mo id="S7.E21.1.1.1" xref="S7.E21.1.1.1.cmml">=</mo><mrow id="S7.E21.26.26.26" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E21.26.26.26.2" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E21.2.2.2" xref="S7.E21.2.2.2.cmml">2</mn><mo id="S7.E21.26.26.26.2.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E21.3.3.3" xref="S7.E21.3.3.3.cmml">H</mi><mo id="S7.E21.26.26.26.2.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E21.4.4.4" xref="S7.E21.4.4.4.cmml">W</mi><mo id="S7.E21.26.26.26.2.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E21.26.26.26.2.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E21.5.5.5" xref="S7.E21.5.5.5.cmml">C</mi><mn id="S7.E21.6.6.6.1" xref="S7.E21.6.6.6.1.cmml">2</mn></msup></mrow><mo id="S7.E21.7.7.7" xref="S7.E21.7.7.7.cmml">+</mo><mrow id="S7.E21.26.26.26.3" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E21.8.8.8" xref="S7.E21.8.8.8.cmml">2</mn><mo id="S7.E21.26.26.26.3.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E21.26.26.26.3.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E21.9.9.9" xref="S7.E21.9.9.9.cmml">N</mi><mi id="S7.E21.10.10.10.1" xref="S7.E21.10.10.10.1.cmml">s</mi></msub><mo id="S7.E21.26.26.26.3.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E21.26.26.26.3.3" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E21.11.11.11" xref="S7.E21.11.11.11.cmml">C</mi><mn id="S7.E21.12.12.12.1" xref="S7.E21.12.12.12.1.cmml">2</mn></msup></mrow><mo id="S7.E21.7.7.7a" xref="S7.E21.7.7.7.cmml">+</mo><mrow id="S7.E21.26.26.26.1" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E21.14.14.14" xref="S7.E21.14.14.14.cmml">C</mi><mo id="S7.E21.26.26.26.1.2" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mrow id="S7.E21.26.26.26.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mo id="S7.E21.15.15.15" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">{</mo><mrow id="S7.E21.26.26.26.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E21.26.26.26.1.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E21.16.16.16" xref="S7.E21.16.16.16.cmml">2</mn><mo id="S7.E21.26.26.26.1.1.1.1.1.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E21.26.26.26.1.1.1.1.1.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E21.17.17.17" xref="S7.E21.17.17.17.cmml">S</mi><mn id="S7.E21.18.18.18.1" xref="S7.E21.18.18.18.1.cmml">4</mn></msup></mrow><mo id="S7.E21.19.19.19" xref="S7.E21.19.19.19.cmml">+</mo><mrow id="S7.E21.26.26.26.1.1.1.1.2" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E21.20.20.20" xref="S7.E21.20.20.20.cmml">2</mn><mo id="S7.E21.26.26.26.1.1.1.1.2.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E21.21.21.21" xref="S7.E21.21.21.21.cmml">H</mi><mo id="S7.E21.26.26.26.1.1.1.1.2.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E21.22.22.22" xref="S7.E21.22.22.22.cmml">W</mi><mo id="S7.E21.26.26.26.1.1.1.1.2.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E21.23.23.23" xref="S7.E21.23.23.23.cmml">k</mi><mo id="S7.E21.26.26.26.1.1.1.1.2.1c" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mstyle displaystyle="true" id="S7.E21.24.24.24" xref="S7.E21.24.24.24.cmml"><mfrac id="S7.E21.24.24.24a" xref="S7.E21.24.24.24.cmml"><msub id="S7.E21.24.24.24.2" xref="S7.E21.24.24.24.2.cmml"><mi id="S7.E21.24.24.24.2.2" xref="S7.E21.24.24.24.2.2.cmml">N</mi><mi id="S7.E21.24.24.24.2.3" xref="S7.E21.24.24.24.2.3.cmml">s</mi></msub><msup id="S7.E21.24.24.24.3" xref="S7.E21.24.24.24.3.cmml"><mi id="S7.E21.24.24.24.3.2" xref="S7.E21.24.24.24.3.2.cmml">S</mi><mn id="S7.E21.24.24.24.3.3" xref="S7.E21.24.24.24.3.3.cmml">2</mn></msup></mfrac></mstyle></mrow></mrow><mo id="S7.E21.25.25.25" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">}</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E25.m1.5.5.6g" xref="S7.E25.m1.5.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E25.m1.5.5.6h" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E22.24.24" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E22.24.24.25" xref="S7.E25.m1.5.5.5a.cmml"></mi><mo id="S7.E22.1.1.1" xref="S7.E22.1.1.1.cmml">=</mo><mrow id="S7.E22.24.24.24" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E22.24.24.24.2" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E22.2.2.2" xref="S7.E22.2.2.2.cmml">2</mn><mo id="S7.E22.24.24.24.2.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E22.3.3.3" xref="S7.E22.3.3.3.cmml">H</mi><mo id="S7.E22.24.24.24.2.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E22.4.4.4" xref="S7.E22.4.4.4.cmml">W</mi><mo id="S7.E22.24.24.24.2.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E22.24.24.24.2.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E22.5.5.5" xref="S7.E22.5.5.5.cmml">C</mi><mn id="S7.E22.6.6.6.1" xref="S7.E22.6.6.6.1.cmml">2</mn></msup></mrow><mo id="S7.E22.7.7.7" xref="S7.E22.7.7.7.cmml">+</mo><mrow id="S7.E22.24.24.24.3" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E22.8.8.8" xref="S7.E22.8.8.8.cmml">2</mn><mo id="S7.E22.24.24.24.3.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E22.24.24.24.3.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E22.9.9.9" xref="S7.E22.9.9.9.cmml">N</mi><mi id="S7.E22.10.10.10.1" xref="S7.E22.10.10.10.1.cmml">s</mi></msub><mo id="S7.E22.24.24.24.3.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E22.24.24.24.3.3" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E22.11.11.11" xref="S7.E22.11.11.11.cmml">C</mi><mn id="S7.E22.12.12.12.1" xref="S7.E22.12.12.12.1.cmml">2</mn></msup></mrow><mo id="S7.E22.7.7.7a" xref="S7.E22.7.7.7.cmml">+</mo><mrow id="S7.E22.24.24.24.1" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E22.14.14.14" xref="S7.E22.14.14.14.cmml">C</mi><mo id="S7.E22.24.24.24.1.2" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mrow id="S7.E22.24.24.24.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mo id="S7.E22.15.15.15" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">{</mo><mrow id="S7.E22.24.24.24.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E22.24.24.24.1.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E22.16.16.16" xref="S7.E22.16.16.16.cmml">2</mn><mo id="S7.E22.24.24.24.1.1.1.1.1.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E22.24.24.24.1.1.1.1.1.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E22.17.17.17" xref="S7.E22.17.17.17.cmml">S</mi><mn id="S7.E22.18.18.18.1" xref="S7.E22.18.18.18.1.cmml">4</mn></msup></mrow><mo id="S7.E22.19.19.19" xref="S7.E22.19.19.19.cmml">+</mo><mstyle displaystyle="true" id="S7.E22.20.20.20" xref="S7.E22.20.20.20.cmml"><mfrac id="S7.E22.20.20.20a" xref="S7.E22.20.20.20.cmml"><mrow id="S7.E22.20.20.20.2" xref="S7.E22.20.20.20.2.cmml"><mi id="S7.E22.20.20.20.2.2" xref="S7.E22.20.20.20.2.2.cmml">k</mi><mo id="S7.E22.20.20.20.2.1" xref="S7.E22.20.20.20.2.1.cmml">⁢</mo><mi id="S7.E22.20.20.20.2.3" xref="S7.E22.20.20.20.2.3.cmml">H</mi><mo id="S7.E22.20.20.20.2.1a" xref="S7.E22.20.20.20.2.1.cmml">⁢</mo><mi id="S7.E22.20.20.20.2.4" xref="S7.E22.20.20.20.2.4.cmml">W</mi><mo id="S7.E22.20.20.20.2.1b" xref="S7.E22.20.20.20.2.1.cmml">⁢</mo><msub id="S7.E22.20.20.20.2.5" xref="S7.E22.20.20.20.2.5.cmml"><mi id="S7.E22.20.20.20.2.5.2" xref="S7.E22.20.20.20.2.5.2.cmml">N</mi><mi id="S7.E22.20.20.20.2.5.3" xref="S7.E22.20.20.20.2.5.3.cmml">s</mi></msub></mrow><msup id="S7.E22.20.20.20.3" xref="S7.E22.20.20.20.3.cmml"><mi id="S7.E22.20.20.20.3.2" xref="S7.E22.20.20.20.3.2.cmml">S</mi><mn id="S7.E22.20.20.20.3.3" xref="S7.E22.20.20.20.3.3.cmml">2</mn></msup></mfrac></mstyle><mo id="S7.E22.19.19.19a" xref="S7.E22.19.19.19.cmml">+</mo><mstyle displaystyle="true" id="S7.E22.22.22.22" xref="S7.E22.22.22.22.cmml"><mfrac id="S7.E22.22.22.22a" xref="S7.E22.22.22.22.cmml"><mrow id="S7.E22.22.22.22.2" xref="S7.E22.22.22.22.2.cmml"><mi id="S7.E22.22.22.22.2.2" xref="S7.E22.22.22.22.2.2.cmml">k</mi><mo id="S7.E22.22.22.22.2.1" xref="S7.E22.22.22.22.2.1.cmml">⁢</mo><mi id="S7.E22.22.22.22.2.3" xref="S7.E22.22.22.22.2.3.cmml">H</mi><mo id="S7.E22.22.22.22.2.1a" xref="S7.E22.22.22.22.2.1.cmml">⁢</mo><mi id="S7.E22.22.22.22.2.4" xref="S7.E22.22.22.22.2.4.cmml">W</mi><mo id="S7.E22.22.22.22.2.1b" xref="S7.E22.22.22.22.2.1.cmml">⁢</mo><msub id="S7.E22.22.22.22.2.5" xref="S7.E22.22.22.22.2.5.cmml"><mi id="S7.E22.22.22.22.2.5.2" xref="S7.E22.22.22.22.2.5.2.cmml">N</mi><mi id="S7.E22.22.22.22.2.5.3" xref="S7.E22.22.22.22.2.5.3.cmml">s</mi></msub></mrow><msup id="S7.E22.22.22.22.3" xref="S7.E22.22.22.22.3.cmml"><mi id="S7.E22.22.22.22.3.2" xref="S7.E22.22.22.22.3.2.cmml">S</mi><mn id="S7.E22.22.22.22.3.3" xref="S7.E22.22.22.22.3.3.cmml">2</mn></msup></mfrac></mstyle></mrow><mo id="S7.E22.23.23.23" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">}</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E25.m1.5.5.6i" xref="S7.E25.m1.5.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E25.m1.5.5.6j" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E23.26.26" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E23.26.26.27" xref="S7.E25.m1.5.5.5a.cmml"></mi><mo id="S7.E23.1.1.1" xref="S7.E23.1.1.1.cmml">≥</mo><mrow id="S7.E23.26.26.26" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E23.26.26.26.2" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E23.2.2.2" xref="S7.E23.2.2.2.cmml">2</mn><mo id="S7.E23.26.26.26.2.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E23.3.3.3" xref="S7.E23.3.3.3.cmml">H</mi><mo id="S7.E23.26.26.26.2.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E23.4.4.4" xref="S7.E23.4.4.4.cmml">W</mi><mo id="S7.E23.26.26.26.2.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E23.26.26.26.2.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E23.5.5.5" xref="S7.E23.5.5.5.cmml">C</mi><mn id="S7.E23.6.6.6.1" xref="S7.E23.6.6.6.1.cmml">2</mn></msup></mrow><mo id="S7.E23.7.7.7" xref="S7.E23.7.7.7.cmml">+</mo><mrow id="S7.E23.26.26.26.3" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E23.8.8.8" xref="S7.E23.8.8.8.cmml">2</mn><mo id="S7.E23.26.26.26.3.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E23.26.26.26.3.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E23.9.9.9" xref="S7.E23.9.9.9.cmml">N</mi><mi id="S7.E23.10.10.10.1" xref="S7.E23.10.10.10.1.cmml">s</mi></msub><mo id="S7.E23.26.26.26.3.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E23.26.26.26.3.3" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E23.11.11.11" xref="S7.E23.11.11.11.cmml">C</mi><mn id="S7.E23.12.12.12.1" xref="S7.E23.12.12.12.1.cmml">2</mn></msup></mrow><mo id="S7.E23.7.7.7a" xref="S7.E23.7.7.7.cmml">+</mo><mrow id="S7.E23.26.26.26.1" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E23.14.14.14" xref="S7.E23.14.14.14.cmml">3</mn><mo id="S7.E23.26.26.26.1.2" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E23.15.15.15" xref="S7.E23.15.15.15.cmml">C</mi><mo id="S7.E23.26.26.26.1.2a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E23.26.26.26.1.1" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E23.26.26.26.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mo id="S7.E23.16.16.16" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">{</mo><mrow id="S7.E23.26.26.26.1.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E23.26.26.26.1.1.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E23.17.17.17" xref="S7.E23.17.17.17.cmml">2</mn><mo id="S7.E23.26.26.26.1.1.1.1.1.1.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E23.26.26.26.1.1.1.1.1.1.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E23.18.18.18" xref="S7.E23.18.18.18.cmml">S</mi><mn id="S7.E23.19.19.19.1" xref="S7.E23.19.19.19.1.cmml">4</mn></msup></mrow><mo id="S7.E23.22.22.22" lspace="0.222em" rspace="0.222em" xref="S7.E23.22.22.22.cmml">⋅</mo><mstyle displaystyle="true" id="S7.E23.21.21.21" xref="S7.E23.21.21.21.cmml"><mfrac id="S7.E23.21.21.21a" xref="S7.E23.21.21.21.cmml"><mrow id="S7.E23.21.21.21.2" xref="S7.E23.21.21.21.2.cmml"><mi id="S7.E23.21.21.21.2.2" xref="S7.E23.21.21.21.2.2.cmml">k</mi><mo id="S7.E23.21.21.21.2.1" xref="S7.E23.21.21.21.2.1.cmml">⁢</mo><mi id="S7.E23.21.21.21.2.3" xref="S7.E23.21.21.21.2.3.cmml">H</mi><mo id="S7.E23.21.21.21.2.1a" xref="S7.E23.21.21.21.2.1.cmml">⁢</mo><mi id="S7.E23.21.21.21.2.4" xref="S7.E23.21.21.21.2.4.cmml">W</mi><mo id="S7.E23.21.21.21.2.1b" xref="S7.E23.21.21.21.2.1.cmml">⁢</mo><msub id="S7.E23.21.21.21.2.5" xref="S7.E23.21.21.21.2.5.cmml"><mi id="S7.E23.21.21.21.2.5.2" xref="S7.E23.21.21.21.2.5.2.cmml">N</mi><mi id="S7.E23.21.21.21.2.5.3" xref="S7.E23.21.21.21.2.5.3.cmml">s</mi></msub></mrow><msup id="S7.E23.21.21.21.3" xref="S7.E23.21.21.21.3.cmml"><mi id="S7.E23.21.21.21.3.2" xref="S7.E23.21.21.21.3.2.cmml">S</mi><mn id="S7.E23.21.21.21.3.3" xref="S7.E23.21.21.21.3.3.cmml">2</mn></msup></mfrac></mstyle><mo id="S7.E23.22.22.22a" lspace="0.222em" rspace="0.222em" xref="S7.E23.22.22.22.cmml">⋅</mo><mstyle displaystyle="true" id="S7.E23.23.23.23" xref="S7.E23.23.23.23.cmml"><mfrac id="S7.E23.23.23.23a" xref="S7.E23.23.23.23.cmml"><mrow id="S7.E23.23.23.23.2" xref="S7.E23.23.23.23.2.cmml"><mi id="S7.E23.23.23.23.2.2" xref="S7.E23.23.23.23.2.2.cmml">k</mi><mo id="S7.E23.23.23.23.2.1" xref="S7.E23.23.23.23.2.1.cmml">⁢</mo><mi id="S7.E23.23.23.23.2.3" xref="S7.E23.23.23.23.2.3.cmml">H</mi><mo id="S7.E23.23.23.23.2.1a" xref="S7.E23.23.23.23.2.1.cmml">⁢</mo><mi id="S7.E23.23.23.23.2.4" xref="S7.E23.23.23.23.2.4.cmml">W</mi><mo id="S7.E23.23.23.23.2.1b" xref="S7.E23.23.23.23.2.1.cmml">⁢</mo><msub id="S7.E23.23.23.23.2.5" xref="S7.E23.23.23.23.2.5.cmml"><mi id="S7.E23.23.23.23.2.5.2" xref="S7.E23.23.23.23.2.5.2.cmml">N</mi><mi id="S7.E23.23.23.23.2.5.3" xref="S7.E23.23.23.23.2.5.3.cmml">s</mi></msub></mrow><msup id="S7.E23.23.23.23.3" xref="S7.E23.23.23.23.3.cmml"><mi id="S7.E23.23.23.23.3.2" xref="S7.E23.23.23.23.3.2.cmml">S</mi><mn id="S7.E23.23.23.23.3.3" xref="S7.E23.23.23.23.3.3.cmml">2</mn></msup></mfrac></mstyle></mrow><mo id="S7.E23.24.24.24" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">}</mo></mrow><mfrac id="S7.E23.25.25.25.1" xref="S7.E23.25.25.25.1.cmml"><mn id="S7.E23.25.25.25.1.2" xref="S7.E23.25.25.25.1.2.cmml">1</mn><mn id="S7.E23.25.25.25.1.3" xref="S7.E23.25.25.25.1.3.cmml">3</mn></mfrac></msup></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E25.m1.5.5.6k" xref="S7.E25.m1.5.5.5.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E25.m1.5.5.6l" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E24.26.26" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E24.26.26.27" xref="S7.E25.m1.5.5.5a.cmml"></mi><mo id="S7.E24.1.1.1" xref="S7.E24.1.1.1.cmml">=</mo><mrow id="S7.E24.26.26.26" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E24.26.26.26.2" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E24.2.2.2" xref="S7.E24.2.2.2.cmml">2</mn><mo id="S7.E24.26.26.26.2.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E24.3.3.3" xref="S7.E24.3.3.3.cmml">H</mi><mo id="S7.E24.26.26.26.2.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E24.4.4.4" xref="S7.E24.4.4.4.cmml">W</mi><mo id="S7.E24.26.26.26.2.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E24.26.26.26.2.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E24.5.5.5" xref="S7.E24.5.5.5.cmml">C</mi><mn id="S7.E24.6.6.6.1" xref="S7.E24.6.6.6.1.cmml">2</mn></msup></mrow><mo id="S7.E24.7.7.7" xref="S7.E24.7.7.7.cmml">+</mo><mrow id="S7.E24.26.26.26.3" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E24.8.8.8" xref="S7.E24.8.8.8.cmml">2</mn><mo id="S7.E24.26.26.26.3.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E24.26.26.26.3.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E24.9.9.9" xref="S7.E24.9.9.9.cmml">N</mi><mi id="S7.E24.10.10.10.1" xref="S7.E24.10.10.10.1.cmml">s</mi></msub><mo id="S7.E24.26.26.26.3.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E24.26.26.26.3.3" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E24.11.11.11" xref="S7.E24.11.11.11.cmml">C</mi><mn id="S7.E24.12.12.12.1" xref="S7.E24.12.12.12.1.cmml">2</mn></msup></mrow><mo id="S7.E24.7.7.7a" xref="S7.E24.7.7.7.cmml">+</mo><mrow id="S7.E24.26.26.26.1" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E24.14.14.14" xref="S7.E24.14.14.14.cmml">3</mn><mo id="S7.E24.26.26.26.1.2" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E24.15.15.15" xref="S7.E24.15.15.15.cmml">C</mi><mo id="S7.E24.26.26.26.1.2a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E24.26.26.26.1.3" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E24.16.16.16" xref="S7.E24.16.16.16.cmml">k</mi><mfrac id="S7.E24.17.17.17.1" xref="S7.E24.17.17.17.1.cmml"><mn id="S7.E24.17.17.17.1.2" xref="S7.E24.17.17.17.1.2.cmml">2</mn><mn id="S7.E24.17.17.17.1.3" xref="S7.E24.17.17.17.1.3.cmml">3</mn></mfrac></msup><mo id="S7.E24.26.26.26.1.2b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msup id="S7.E24.26.26.26.1.1" xref="S7.E25.m1.5.5.5.cmml"><mrow id="S7.E24.26.26.26.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mo id="S7.E24.18.18.18" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">{</mo><mrow id="S7.E24.26.26.26.1.1.1.1.1" xref="S7.E25.m1.5.5.5.cmml"><mn id="S7.E24.19.19.19" xref="S7.E24.19.19.19.cmml">2</mn><mo id="S7.E24.26.26.26.1.1.1.1.1.1" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E24.20.20.20" xref="S7.E24.20.20.20.cmml">H</mi><mo id="S7.E24.26.26.26.1.1.1.1.1.1a" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><mi id="S7.E24.21.21.21" xref="S7.E24.21.21.21.cmml">W</mi><mo id="S7.E24.26.26.26.1.1.1.1.1.1b" xref="S7.E25.m1.5.5.5a.cmml">⁢</mo><msub id="S7.E24.26.26.26.1.1.1.1.1.2" xref="S7.E25.m1.5.5.5.cmml"><mi id="S7.E24.22.22.22" xref="S7.E24.22.22.22.cmml">N</mi><mi id="S7.E24.23.23.23.1" xref="S7.E24.23.23.23.1.cmml">s</mi></msub></mrow><mo id="S7.E24.24.24.24" stretchy="false" xref="S7.E25.m1.5.5.5a.cmml">}</mo></mrow><mfrac id="S7.E24.25.25.25.1" xref="S7.E24.25.25.25.1.cmml"><mn id="S7.E24.25.25.25.1.2" xref="S7.E24.25.25.25.1.2.cmml">2</mn><mn id="S7.E24.25.25.25.1.3" xref="S7.E24.25.25.25.1.3.cmml">3</mn></mfrac></msup></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S7.E25.m1.5b"><apply id="S7.E25.m1.5.5.5.cmml" xref="S7.E25.m1.5.5.6"><and id="S7.E25.m1.5.5.5a.cmml" xref="S7.E19.27.27a.28.1"></and><apply id="S7.E25.m1.5.5.5b.cmml" xref="S7.E25.m1.5.5.6"><eq id="S7.E19.7.7.7.cmml" xref="S7.E19.7.7.7"></eq><apply id="S7.E25.m1.5.5.5.7.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.7.1.cmml" xref="S7.E19.27.27a.28.1"></times><ci id="S7.E19.1.1.1.cmml" xref="S7.E19.1.1.1">𝐹</ci><ci id="S7.E19.2.2.2.cmml" xref="S7.E19.2.2.2">𝐿</ci><ci id="S7.E19.3.3.3.cmml" xref="S7.E19.3.3.3">𝑂</ci><ci id="S7.E19.4.4.4.cmml" xref="S7.E19.4.4.4">𝑃</ci><apply id="S7.E25.m1.5.5.5.7.6.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.7.6.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E19.5.5.5.cmml" xref="S7.E19.5.5.5">𝑠</ci><apply id="S7.E19.6.6.6.1.cmml" xref="S7.E19.6.6.6.1"><times id="S7.E19.6.6.6.1.1.cmml" xref="S7.E19.6.6.6.1.1"></times><ci id="S7.E19.6.6.6.1.2.cmml" xref="S7.E19.6.6.6.1.2">𝑏</ci><ci id="S7.E19.6.6.6.1.3.cmml" xref="S7.E19.6.6.6.1.3">𝑖</ci></apply></apply></apply><apply id="S7.E25.m1.5.5.5.9.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E19.14.14.14.cmml" xref="S7.E19.14.14.14"></plus><apply id="S7.E25.m1.5.5.5.9.2.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.9.2.1.cmml" xref="S7.E19.27.27a.28.1"></times><ci id="S7.E19.8.8.8.cmml" xref="S7.E19.8.8.8">𝐹</ci><ci id="S7.E19.9.9.9.cmml" xref="S7.E19.9.9.9">𝐿</ci><ci id="S7.E19.10.10.10.cmml" xref="S7.E19.10.10.10">𝑂</ci><ci id="S7.E19.11.11.11.cmml" xref="S7.E19.11.11.11">𝑃</ci><apply id="S7.E25.m1.5.5.5.9.2.6.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.9.2.6.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E19.12.12.12.cmml" xref="S7.E19.12.12.12">𝑠</ci><apply id="S7.E19.13.13.13.1.cmml" xref="S7.E19.13.13.13.1"><times id="S7.E19.13.13.13.1.1.cmml" xref="S7.E19.13.13.13.1.1"></times><ci id="S7.E19.13.13.13.1.2.cmml" xref="S7.E19.13.13.13.1.2">𝑝</ci><ci id="S7.E19.13.13.13.1.3.cmml" xref="S7.E19.13.13.13.1.3">𝑟</ci><ci id="S7.E19.13.13.13.1.4.cmml" xref="S7.E19.13.13.13.1.4">𝑜</ci><ci id="S7.E19.13.13.13.1.5.cmml" xref="S7.E19.13.13.13.1.5">𝑗</ci></apply></apply></apply><apply id="S7.E25.m1.5.5.5.9.3.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.9.3.1.cmml" xref="S7.E19.27.27a.28.1"></times><ci id="S7.E19.15.15.15.cmml" xref="S7.E19.15.15.15">𝐹</ci><ci id="S7.E19.16.16.16.cmml" xref="S7.E19.16.16.16">𝐿</ci><ci id="S7.E19.17.17.17.cmml" xref="S7.E19.17.17.17">𝑂</ci><ci id="S7.E19.18.18.18.cmml" xref="S7.E19.18.18.18">𝑃</ci><apply id="S7.E25.m1.5.5.5.9.3.6.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.9.3.6.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E19.19.19.19.cmml" xref="S7.E19.19.19.19">𝑠</ci><apply id="S7.E19.20.20.20.1.cmml" xref="S7.E19.20.20.20.1"><times id="S7.E19.20.20.20.1.1.cmml" xref="S7.E19.20.20.20.1.1"></times><ci id="S7.E19.20.20.20.1.2.cmml" xref="S7.E19.20.20.20.1.2">𝑟</ci><ci id="S7.E19.20.20.20.1.3.cmml" xref="S7.E19.20.20.20.1.3">𝑜</ci><ci id="S7.E19.20.20.20.1.4.cmml" xref="S7.E19.20.20.20.1.4">𝑢</ci><ci id="S7.E19.20.20.20.1.5.cmml" xref="S7.E19.20.20.20.1.5">𝑡</ci><ci id="S7.E19.20.20.20.1.6.cmml" xref="S7.E19.20.20.20.1.6">𝑖</ci><ci id="S7.E19.20.20.20.1.7.cmml" xref="S7.E19.20.20.20.1.7">𝑛</ci><ci id="S7.E19.20.20.20.1.8.cmml" xref="S7.E19.20.20.20.1.8">𝑔</ci></apply></apply></apply><apply id="S7.E25.m1.5.5.5.9.4.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.9.4.1.cmml" xref="S7.E19.27.27a.28.1"></times><ci id="S7.E19.22.22.22.cmml" xref="S7.E19.22.22.22">𝐹</ci><ci id="S7.E19.23.23.23.cmml" xref="S7.E19.23.23.23">𝐿</ci><ci id="S7.E19.24.24.24.cmml" xref="S7.E19.24.24.24">𝑂</ci><ci id="S7.E19.25.25.25.cmml" xref="S7.E19.25.25.25">𝑃</ci><apply id="S7.E25.m1.5.5.5.9.4.6.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.9.4.6.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E19.26.26.26.cmml" xref="S7.E19.26.26.26">𝑠</ci><apply id="S7.E19.27.27.27.1.cmml" xref="S7.E19.27.27.27.1"><times id="S7.E19.27.27.27.1.1.cmml" xref="S7.E19.27.27.27.1.1"></times><ci id="S7.E19.27.27.27.1.2.cmml" xref="S7.E19.27.27.27.1.2">𝑎</ci><ci id="S7.E19.27.27.27.1.3.cmml" xref="S7.E19.27.27.27.1.3">𝑡</ci><ci id="S7.E19.27.27.27.1.4.cmml" xref="S7.E19.27.27.27.1.4">𝑡</ci><ci id="S7.E19.27.27.27.1.5.cmml" xref="S7.E19.27.27.27.1.5">𝑛</ci></apply></apply></apply></apply></apply><apply id="S7.E25.m1.5.5.5c.cmml" xref="S7.E25.m1.5.5.6"><eq id="S7.E20.1.1.1.cmml" xref="S7.E20.1.1.1"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.E25.m1.5.5.5.9.cmml" id="S7.E25.m1.5.5.5d.cmml" xref="S7.E19.27.27a.28.1"></share><apply id="S7.E25.m1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E20.7.7.7.cmml" xref="S7.E20.7.7.7"></plus><apply id="S7.E25.m1.1.1.1.1.3.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.1.1.1.1.3.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E20.2.2.2.cmml" type="integer" xref="S7.E20.2.2.2">2</cn><ci id="S7.E20.3.3.3.cmml" xref="S7.E20.3.3.3">𝐻</ci><ci id="S7.E20.4.4.4.cmml" xref="S7.E20.4.4.4">𝑊</ci><apply id="S7.E25.m1.1.1.1.1.3.5.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.1.1.1.1.3.5.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E20.5.5.5.cmml" xref="S7.E20.5.5.5">𝐶</ci><cn id="S7.E20.6.6.6.1.cmml" type="integer" xref="S7.E20.6.6.6.1">2</cn></apply></apply><apply id="S7.E25.m1.1.1.1.1.4.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.1.1.1.1.4.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E20.8.8.8.cmml" type="integer" xref="S7.E20.8.8.8">2</cn><apply id="S7.E25.m1.1.1.1.1.4.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.1.1.1.1.4.3.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E20.9.9.9.cmml" xref="S7.E20.9.9.9">𝑁</ci><ci id="S7.E20.10.10.10.1.cmml" xref="S7.E20.10.10.10.1">𝑠</ci></apply><apply id="S7.E25.m1.1.1.1.1.4.4.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.1.1.1.1.4.4.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E20.11.11.11.cmml" xref="S7.E20.11.11.11">𝐶</ci><cn id="S7.E20.12.12.12.1.cmml" type="integer" xref="S7.E20.12.12.12.1">2</cn></apply></apply><apply id="S7.E25.m1.1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.1.1.1.1.1.2.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E20.14.14.14.cmml" type="integer" xref="S7.E20.14.14.14">2</cn><apply id="S7.E25.m1.1.1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.1.1.1.1.1.1.2.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><apply id="S7.E25.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6">superscript</csymbol><ci id="S7.E20.16.16.16.cmml" xref="S7.E20.16.16.16">𝑆</ci><cn id="S7.E20.17.17.17.1.cmml" type="integer" xref="S7.E20.17.17.17.1">2</cn></apply><cn id="S7.E20.19.19.19.1.cmml" type="integer" xref="S7.E20.19.19.19.1">2</cn></apply><ci id="S7.E20.20.20.20.cmml" xref="S7.E20.20.20.20">𝐶</ci></apply><apply id="S7.E25.m1.1.1.1.1.5.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.1.1.1.1.5.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E20.22.22.22.cmml" type="integer" xref="S7.E20.22.22.22">2</cn><ci id="S7.E20.23.23.23.cmml" xref="S7.E20.23.23.23">𝐻</ci><ci id="S7.E20.24.24.24.cmml" xref="S7.E20.24.24.24">𝑊</ci><ci id="S7.E20.25.25.25.cmml" xref="S7.E20.25.25.25">𝑘</ci><apply id="S7.E20.26.26.26.cmml" xref="S7.E20.26.26.26"><divide id="S7.E20.26.26.26.1.cmml" xref="S7.E20.26.26.26"></divide><apply id="S7.E20.26.26.26.2.cmml" xref="S7.E20.26.26.26.2"><csymbol cd="ambiguous" id="S7.E20.26.26.26.2.1.cmml" xref="S7.E20.26.26.26.2">subscript</csymbol><ci id="S7.E20.26.26.26.2.2.cmml" xref="S7.E20.26.26.26.2.2">𝑁</ci><ci id="S7.E20.26.26.26.2.3.cmml" xref="S7.E20.26.26.26.2.3">𝑠</ci></apply><apply id="S7.E20.26.26.26.3.cmml" xref="S7.E20.26.26.26.3"><csymbol cd="ambiguous" id="S7.E20.26.26.26.3.1.cmml" xref="S7.E20.26.26.26.3">superscript</csymbol><ci id="S7.E20.26.26.26.3.2.cmml" xref="S7.E20.26.26.26.3.2">𝑆</ci><cn id="S7.E20.26.26.26.3.3.cmml" type="integer" xref="S7.E20.26.26.26.3.3">2</cn></apply></apply><ci id="S7.E20.27.27.27.cmml" xref="S7.E20.27.27.27">𝐶</ci></apply></apply></apply><apply id="S7.E25.m1.5.5.5e.cmml" xref="S7.E25.m1.5.5.6"><eq id="S7.E21.1.1.1.cmml" xref="S7.E21.1.1.1"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.E25.m1.1.1.1.1.cmml" id="S7.E25.m1.5.5.5f.cmml" xref="S7.E19.27.27a.28.1"></share><apply id="S7.E25.m1.2.2.2.2.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E21.7.7.7.cmml" xref="S7.E21.7.7.7"></plus><apply id="S7.E25.m1.2.2.2.2.3.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.2.2.2.2.3.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E21.2.2.2.cmml" type="integer" xref="S7.E21.2.2.2">2</cn><ci id="S7.E21.3.3.3.cmml" xref="S7.E21.3.3.3">𝐻</ci><ci id="S7.E21.4.4.4.cmml" xref="S7.E21.4.4.4">𝑊</ci><apply id="S7.E25.m1.2.2.2.2.3.5.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.2.2.2.2.3.5.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E21.5.5.5.cmml" xref="S7.E21.5.5.5">𝐶</ci><cn id="S7.E21.6.6.6.1.cmml" type="integer" xref="S7.E21.6.6.6.1">2</cn></apply></apply><apply id="S7.E25.m1.2.2.2.2.4.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.2.2.2.2.4.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E21.8.8.8.cmml" type="integer" xref="S7.E21.8.8.8">2</cn><apply id="S7.E25.m1.2.2.2.2.4.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.2.2.2.2.4.3.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E21.9.9.9.cmml" xref="S7.E21.9.9.9">𝑁</ci><ci id="S7.E21.10.10.10.1.cmml" xref="S7.E21.10.10.10.1">𝑠</ci></apply><apply id="S7.E25.m1.2.2.2.2.4.4.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.2.2.2.2.4.4.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E21.11.11.11.cmml" xref="S7.E21.11.11.11">𝐶</ci><cn id="S7.E21.12.12.12.1.cmml" type="integer" xref="S7.E21.12.12.12.1">2</cn></apply></apply><apply id="S7.E25.m1.2.2.2.2.1.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.2.2.2.2.1.2.cmml" xref="S7.E19.27.27a.28.1"></times><ci id="S7.E21.14.14.14.cmml" xref="S7.E21.14.14.14">𝐶</ci><set id="S7.E25.m1.2.2.2.2.1.1.2.cmml" xref="S7.E25.m1.5.5.6"><apply id="S7.E25.m1.2.2.2.2.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E21.19.19.19.cmml" xref="S7.E21.19.19.19"></plus><apply id="S7.E25.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S7.E25.m1.5.5.6"></times><cn id="S7.E21.16.16.16.cmml" type="integer" xref="S7.E21.16.16.16">2</cn><apply id="S7.E25.m1.2.2.2.2.1.1.1.1.2.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.2.2.2.2.1.1.1.1.2.3.1.cmml" xref="S7.E25.m1.5.5.6">superscript</csymbol><ci id="S7.E21.17.17.17.cmml" xref="S7.E21.17.17.17">𝑆</ci><cn id="S7.E21.18.18.18.1.cmml" type="integer" xref="S7.E21.18.18.18.1">4</cn></apply></apply><apply id="S7.E25.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="S7.E25.m1.5.5.6"></times><cn id="S7.E21.20.20.20.cmml" type="integer" xref="S7.E21.20.20.20">2</cn><ci id="S7.E21.21.21.21.cmml" xref="S7.E21.21.21.21">𝐻</ci><ci id="S7.E21.22.22.22.cmml" xref="S7.E21.22.22.22">𝑊</ci><ci id="S7.E21.23.23.23.cmml" xref="S7.E21.23.23.23">𝑘</ci><apply id="S7.E21.24.24.24.cmml" xref="S7.E21.24.24.24"><divide id="S7.E21.24.24.24.1.cmml" xref="S7.E21.24.24.24"></divide><apply id="S7.E21.24.24.24.2.cmml" xref="S7.E21.24.24.24.2"><csymbol cd="ambiguous" id="S7.E21.24.24.24.2.1.cmml" xref="S7.E21.24.24.24.2">subscript</csymbol><ci id="S7.E21.24.24.24.2.2.cmml" xref="S7.E21.24.24.24.2.2">𝑁</ci><ci id="S7.E21.24.24.24.2.3.cmml" xref="S7.E21.24.24.24.2.3">𝑠</ci></apply><apply id="S7.E21.24.24.24.3.cmml" xref="S7.E21.24.24.24.3"><csymbol cd="ambiguous" id="S7.E21.24.24.24.3.1.cmml" xref="S7.E21.24.24.24.3">superscript</csymbol><ci id="S7.E21.24.24.24.3.2.cmml" xref="S7.E21.24.24.24.3.2">𝑆</ci><cn id="S7.E21.24.24.24.3.3.cmml" type="integer" xref="S7.E21.24.24.24.3.3">2</cn></apply></apply></apply></apply></set></apply></apply></apply><apply id="S7.E25.m1.5.5.5g.cmml" xref="S7.E25.m1.5.5.6"><eq id="S7.E22.1.1.1.cmml" xref="S7.E22.1.1.1"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.E25.m1.2.2.2.2.cmml" id="S7.E25.m1.5.5.5h.cmml" xref="S7.E19.27.27a.28.1"></share><apply id="S7.E25.m1.3.3.3.3.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E22.7.7.7.cmml" xref="S7.E22.7.7.7"></plus><apply id="S7.E25.m1.3.3.3.3.3.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.3.3.3.3.3.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E22.2.2.2.cmml" type="integer" xref="S7.E22.2.2.2">2</cn><ci id="S7.E22.3.3.3.cmml" xref="S7.E22.3.3.3">𝐻</ci><ci id="S7.E22.4.4.4.cmml" xref="S7.E22.4.4.4">𝑊</ci><apply id="S7.E25.m1.3.3.3.3.3.5.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.3.3.3.3.3.5.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E22.5.5.5.cmml" xref="S7.E22.5.5.5">𝐶</ci><cn id="S7.E22.6.6.6.1.cmml" type="integer" xref="S7.E22.6.6.6.1">2</cn></apply></apply><apply id="S7.E25.m1.3.3.3.3.4.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.3.3.3.3.4.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E22.8.8.8.cmml" type="integer" xref="S7.E22.8.8.8">2</cn><apply id="S7.E25.m1.3.3.3.3.4.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.3.3.3.3.4.3.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E22.9.9.9.cmml" xref="S7.E22.9.9.9">𝑁</ci><ci id="S7.E22.10.10.10.1.cmml" xref="S7.E22.10.10.10.1">𝑠</ci></apply><apply id="S7.E25.m1.3.3.3.3.4.4.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.3.3.3.3.4.4.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E22.11.11.11.cmml" xref="S7.E22.11.11.11">𝐶</ci><cn id="S7.E22.12.12.12.1.cmml" type="integer" xref="S7.E22.12.12.12.1">2</cn></apply></apply><apply id="S7.E25.m1.3.3.3.3.1.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.3.3.3.3.1.2.cmml" xref="S7.E19.27.27a.28.1"></times><ci id="S7.E22.14.14.14.cmml" xref="S7.E22.14.14.14">𝐶</ci><set id="S7.E25.m1.3.3.3.3.1.1.2.cmml" xref="S7.E25.m1.5.5.6"><apply id="S7.E25.m1.3.3.3.3.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E22.19.19.19.cmml" xref="S7.E22.19.19.19"></plus><apply id="S7.E25.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S7.E25.m1.5.5.6"></times><cn id="S7.E22.16.16.16.cmml" type="integer" xref="S7.E22.16.16.16">2</cn><apply id="S7.E25.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.3.3.3.3.1.1.1.1.2.3.1.cmml" xref="S7.E25.m1.5.5.6">superscript</csymbol><ci id="S7.E22.17.17.17.cmml" xref="S7.E22.17.17.17">𝑆</ci><cn id="S7.E22.18.18.18.1.cmml" type="integer" xref="S7.E22.18.18.18.1">4</cn></apply></apply><apply id="S7.E22.20.20.20.cmml" xref="S7.E22.20.20.20"><divide id="S7.E22.20.20.20.1.cmml" xref="S7.E22.20.20.20"></divide><apply id="S7.E22.20.20.20.2.cmml" xref="S7.E22.20.20.20.2"><times id="S7.E22.20.20.20.2.1.cmml" xref="S7.E22.20.20.20.2.1"></times><ci id="S7.E22.20.20.20.2.2.cmml" xref="S7.E22.20.20.20.2.2">𝑘</ci><ci id="S7.E22.20.20.20.2.3.cmml" xref="S7.E22.20.20.20.2.3">𝐻</ci><ci id="S7.E22.20.20.20.2.4.cmml" xref="S7.E22.20.20.20.2.4">𝑊</ci><apply id="S7.E22.20.20.20.2.5.cmml" xref="S7.E22.20.20.20.2.5"><csymbol cd="ambiguous" id="S7.E22.20.20.20.2.5.1.cmml" xref="S7.E22.20.20.20.2.5">subscript</csymbol><ci id="S7.E22.20.20.20.2.5.2.cmml" xref="S7.E22.20.20.20.2.5.2">𝑁</ci><ci id="S7.E22.20.20.20.2.5.3.cmml" xref="S7.E22.20.20.20.2.5.3">𝑠</ci></apply></apply><apply id="S7.E22.20.20.20.3.cmml" xref="S7.E22.20.20.20.3"><csymbol cd="ambiguous" id="S7.E22.20.20.20.3.1.cmml" xref="S7.E22.20.20.20.3">superscript</csymbol><ci id="S7.E22.20.20.20.3.2.cmml" xref="S7.E22.20.20.20.3.2">𝑆</ci><cn id="S7.E22.20.20.20.3.3.cmml" type="integer" xref="S7.E22.20.20.20.3.3">2</cn></apply></apply><apply id="S7.E22.22.22.22.cmml" xref="S7.E22.22.22.22"><divide id="S7.E22.22.22.22.1.cmml" xref="S7.E22.22.22.22"></divide><apply id="S7.E22.22.22.22.2.cmml" xref="S7.E22.22.22.22.2"><times id="S7.E22.22.22.22.2.1.cmml" xref="S7.E22.22.22.22.2.1"></times><ci id="S7.E22.22.22.22.2.2.cmml" xref="S7.E22.22.22.22.2.2">𝑘</ci><ci id="S7.E22.22.22.22.2.3.cmml" xref="S7.E22.22.22.22.2.3">𝐻</ci><ci id="S7.E22.22.22.22.2.4.cmml" xref="S7.E22.22.22.22.2.4">𝑊</ci><apply id="S7.E22.22.22.22.2.5.cmml" xref="S7.E22.22.22.22.2.5"><csymbol cd="ambiguous" id="S7.E22.22.22.22.2.5.1.cmml" xref="S7.E22.22.22.22.2.5">subscript</csymbol><ci id="S7.E22.22.22.22.2.5.2.cmml" xref="S7.E22.22.22.22.2.5.2">𝑁</ci><ci id="S7.E22.22.22.22.2.5.3.cmml" xref="S7.E22.22.22.22.2.5.3">𝑠</ci></apply></apply><apply id="S7.E22.22.22.22.3.cmml" xref="S7.E22.22.22.22.3"><csymbol cd="ambiguous" id="S7.E22.22.22.22.3.1.cmml" xref="S7.E22.22.22.22.3">superscript</csymbol><ci id="S7.E22.22.22.22.3.2.cmml" xref="S7.E22.22.22.22.3.2">𝑆</ci><cn id="S7.E22.22.22.22.3.3.cmml" type="integer" xref="S7.E22.22.22.22.3.3">2</cn></apply></apply></apply></set></apply></apply></apply><apply id="S7.E25.m1.5.5.5i.cmml" xref="S7.E25.m1.5.5.6"><geq id="S7.E23.1.1.1.cmml" xref="S7.E23.1.1.1"></geq><share href="https://arxiv.org/html/2410.08582v1#S7.E25.m1.3.3.3.3.cmml" id="S7.E25.m1.5.5.5j.cmml" xref="S7.E19.27.27a.28.1"></share><apply id="S7.E25.m1.4.4.4.4.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E23.7.7.7.cmml" xref="S7.E23.7.7.7"></plus><apply id="S7.E25.m1.4.4.4.4.3.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.4.4.4.4.3.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E23.2.2.2.cmml" type="integer" xref="S7.E23.2.2.2">2</cn><ci id="S7.E23.3.3.3.cmml" xref="S7.E23.3.3.3">𝐻</ci><ci id="S7.E23.4.4.4.cmml" xref="S7.E23.4.4.4">𝑊</ci><apply id="S7.E25.m1.4.4.4.4.3.5.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.4.4.4.4.3.5.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E23.5.5.5.cmml" xref="S7.E23.5.5.5">𝐶</ci><cn id="S7.E23.6.6.6.1.cmml" type="integer" xref="S7.E23.6.6.6.1">2</cn></apply></apply><apply id="S7.E25.m1.4.4.4.4.4.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.4.4.4.4.4.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E23.8.8.8.cmml" type="integer" xref="S7.E23.8.8.8">2</cn><apply id="S7.E25.m1.4.4.4.4.4.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.4.4.4.4.4.3.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E23.9.9.9.cmml" xref="S7.E23.9.9.9">𝑁</ci><ci id="S7.E23.10.10.10.1.cmml" xref="S7.E23.10.10.10.1">𝑠</ci></apply><apply id="S7.E25.m1.4.4.4.4.4.4.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.4.4.4.4.4.4.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E23.11.11.11.cmml" xref="S7.E23.11.11.11">𝐶</ci><cn id="S7.E23.12.12.12.1.cmml" type="integer" xref="S7.E23.12.12.12.1">2</cn></apply></apply><apply id="S7.E25.m1.4.4.4.4.1.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.4.4.4.4.1.2.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E23.14.14.14.cmml" type="integer" xref="S7.E23.14.14.14">3</cn><ci id="S7.E23.15.15.15.cmml" xref="S7.E23.15.15.15">𝐶</ci><apply id="S7.E25.m1.4.4.4.4.1.1.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.4.4.4.4.1.1.2.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><set id="S7.E25.m1.4.4.4.4.1.1.1.2.cmml" xref="S7.E25.m1.5.5.6"><apply id="S7.E25.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><ci id="S7.E23.22.22.22.cmml" xref="S7.E23.22.22.22">⋅</ci><apply id="S7.E25.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.4.4.4.4.1.1.1.1.1.2.1.cmml" xref="S7.E25.m1.5.5.6"></times><cn id="S7.E23.17.17.17.cmml" type="integer" xref="S7.E23.17.17.17">2</cn><apply id="S7.E25.m1.4.4.4.4.1.1.1.1.1.2.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.4.4.4.4.1.1.1.1.1.2.3.1.cmml" xref="S7.E25.m1.5.5.6">superscript</csymbol><ci id="S7.E23.18.18.18.cmml" xref="S7.E23.18.18.18">𝑆</ci><cn id="S7.E23.19.19.19.1.cmml" type="integer" xref="S7.E23.19.19.19.1">4</cn></apply></apply><apply id="S7.E23.21.21.21.cmml" xref="S7.E23.21.21.21"><divide id="S7.E23.21.21.21.1.cmml" xref="S7.E23.21.21.21"></divide><apply id="S7.E23.21.21.21.2.cmml" xref="S7.E23.21.21.21.2"><times id="S7.E23.21.21.21.2.1.cmml" xref="S7.E23.21.21.21.2.1"></times><ci id="S7.E23.21.21.21.2.2.cmml" xref="S7.E23.21.21.21.2.2">𝑘</ci><ci id="S7.E23.21.21.21.2.3.cmml" xref="S7.E23.21.21.21.2.3">𝐻</ci><ci id="S7.E23.21.21.21.2.4.cmml" xref="S7.E23.21.21.21.2.4">𝑊</ci><apply id="S7.E23.21.21.21.2.5.cmml" xref="S7.E23.21.21.21.2.5"><csymbol cd="ambiguous" id="S7.E23.21.21.21.2.5.1.cmml" xref="S7.E23.21.21.21.2.5">subscript</csymbol><ci id="S7.E23.21.21.21.2.5.2.cmml" xref="S7.E23.21.21.21.2.5.2">𝑁</ci><ci id="S7.E23.21.21.21.2.5.3.cmml" xref="S7.E23.21.21.21.2.5.3">𝑠</ci></apply></apply><apply id="S7.E23.21.21.21.3.cmml" xref="S7.E23.21.21.21.3"><csymbol cd="ambiguous" id="S7.E23.21.21.21.3.1.cmml" xref="S7.E23.21.21.21.3">superscript</csymbol><ci id="S7.E23.21.21.21.3.2.cmml" xref="S7.E23.21.21.21.3.2">𝑆</ci><cn id="S7.E23.21.21.21.3.3.cmml" type="integer" xref="S7.E23.21.21.21.3.3">2</cn></apply></apply><apply id="S7.E23.23.23.23.cmml" xref="S7.E23.23.23.23"><divide id="S7.E23.23.23.23.1.cmml" xref="S7.E23.23.23.23"></divide><apply id="S7.E23.23.23.23.2.cmml" xref="S7.E23.23.23.23.2"><times id="S7.E23.23.23.23.2.1.cmml" xref="S7.E23.23.23.23.2.1"></times><ci id="S7.E23.23.23.23.2.2.cmml" xref="S7.E23.23.23.23.2.2">𝑘</ci><ci id="S7.E23.23.23.23.2.3.cmml" xref="S7.E23.23.23.23.2.3">𝐻</ci><ci id="S7.E23.23.23.23.2.4.cmml" xref="S7.E23.23.23.23.2.4">𝑊</ci><apply id="S7.E23.23.23.23.2.5.cmml" xref="S7.E23.23.23.23.2.5"><csymbol cd="ambiguous" id="S7.E23.23.23.23.2.5.1.cmml" xref="S7.E23.23.23.23.2.5">subscript</csymbol><ci id="S7.E23.23.23.23.2.5.2.cmml" xref="S7.E23.23.23.23.2.5.2">𝑁</ci><ci id="S7.E23.23.23.23.2.5.3.cmml" xref="S7.E23.23.23.23.2.5.3">𝑠</ci></apply></apply><apply id="S7.E23.23.23.23.3.cmml" xref="S7.E23.23.23.23.3"><csymbol cd="ambiguous" id="S7.E23.23.23.23.3.1.cmml" xref="S7.E23.23.23.23.3">superscript</csymbol><ci id="S7.E23.23.23.23.3.2.cmml" xref="S7.E23.23.23.23.3.2">𝑆</ci><cn id="S7.E23.23.23.23.3.3.cmml" type="integer" xref="S7.E23.23.23.23.3.3">2</cn></apply></apply></apply></set><apply id="S7.E23.25.25.25.1.cmml" xref="S7.E23.25.25.25.1"><divide id="S7.E23.25.25.25.1.1.cmml" xref="S7.E23.25.25.25.1"></divide><cn id="S7.E23.25.25.25.1.2.cmml" type="integer" xref="S7.E23.25.25.25.1.2">1</cn><cn id="S7.E23.25.25.25.1.3.cmml" type="integer" xref="S7.E23.25.25.25.1.3">3</cn></apply></apply></apply></apply></apply><apply id="S7.E25.m1.5.5.5k.cmml" xref="S7.E25.m1.5.5.6"><eq id="S7.E24.1.1.1.cmml" xref="S7.E24.1.1.1"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.E25.m1.4.4.4.4.cmml" id="S7.E25.m1.5.5.5l.cmml" xref="S7.E19.27.27a.28.1"></share><apply id="S7.E25.m1.5.5.5.5.cmml" xref="S7.E25.m1.5.5.6"><plus id="S7.E24.7.7.7.cmml" xref="S7.E24.7.7.7"></plus><apply id="S7.E25.m1.5.5.5.5.3.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.5.3.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E24.2.2.2.cmml" type="integer" xref="S7.E24.2.2.2">2</cn><ci id="S7.E24.3.3.3.cmml" xref="S7.E24.3.3.3">𝐻</ci><ci id="S7.E24.4.4.4.cmml" xref="S7.E24.4.4.4">𝑊</ci><apply id="S7.E25.m1.5.5.5.5.3.5.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.5.3.5.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E24.5.5.5.cmml" xref="S7.E24.5.5.5">𝐶</ci><cn id="S7.E24.6.6.6.1.cmml" type="integer" xref="S7.E24.6.6.6.1">2</cn></apply></apply><apply id="S7.E25.m1.5.5.5.5.4.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.5.4.1.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E24.8.8.8.cmml" type="integer" xref="S7.E24.8.8.8">2</cn><apply id="S7.E25.m1.5.5.5.5.4.3.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.5.4.3.1.cmml" xref="S7.E19.27.27a.28.1">subscript</csymbol><ci id="S7.E24.9.9.9.cmml" xref="S7.E24.9.9.9">𝑁</ci><ci id="S7.E24.10.10.10.1.cmml" xref="S7.E24.10.10.10.1">𝑠</ci></apply><apply id="S7.E25.m1.5.5.5.5.4.4.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.5.4.4.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E24.11.11.11.cmml" xref="S7.E24.11.11.11">𝐶</ci><cn id="S7.E24.12.12.12.1.cmml" type="integer" xref="S7.E24.12.12.12.1">2</cn></apply></apply><apply id="S7.E25.m1.5.5.5.5.1.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.5.1.2.cmml" xref="S7.E19.27.27a.28.1"></times><cn id="S7.E24.14.14.14.cmml" type="integer" xref="S7.E24.14.14.14">3</cn><ci id="S7.E24.15.15.15.cmml" xref="S7.E24.15.15.15">𝐶</ci><apply id="S7.E25.m1.5.5.5.5.1.5.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.5.1.5.1.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><ci id="S7.E24.16.16.16.cmml" xref="S7.E24.16.16.16">𝑘</ci><apply id="S7.E24.17.17.17.1.cmml" xref="S7.E24.17.17.17.1"><divide id="S7.E24.17.17.17.1.1.cmml" xref="S7.E24.17.17.17.1"></divide><cn id="S7.E24.17.17.17.1.2.cmml" type="integer" xref="S7.E24.17.17.17.1.2">2</cn><cn id="S7.E24.17.17.17.1.3.cmml" type="integer" xref="S7.E24.17.17.17.1.3">3</cn></apply></apply><apply id="S7.E25.m1.5.5.5.5.1.1.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.5.1.1.2.cmml" xref="S7.E19.27.27a.28.1">superscript</csymbol><set id="S7.E25.m1.5.5.5.5.1.1.1.2.cmml" xref="S7.E25.m1.5.5.6"><apply id="S7.E25.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"><times id="S7.E25.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="S7.E25.m1.5.5.6"></times><cn id="S7.E24.19.19.19.cmml" type="integer" xref="S7.E24.19.19.19">2</cn><ci id="S7.E24.20.20.20.cmml" xref="S7.E24.20.20.20">𝐻</ci><ci id="S7.E24.21.21.21.cmml" xref="S7.E24.21.21.21">𝑊</ci><apply id="S7.E25.m1.5.5.5.5.1.1.1.1.1.5.cmml" xref="S7.E25.m1.5.5.6"><csymbol cd="ambiguous" id="S7.E25.m1.5.5.5.5.1.1.1.1.1.5.1.cmml" xref="S7.E25.m1.5.5.6">subscript</csymbol><ci id="S7.E24.22.22.22.cmml" xref="S7.E24.22.22.22">𝑁</ci><ci id="S7.E24.23.23.23.1.cmml" xref="S7.E24.23.23.23.1">𝑠</ci></apply></apply></set><apply id="S7.E24.25.25.25.1.cmml" xref="S7.E24.25.25.25.1"><divide id="S7.E24.25.25.25.1.1.cmml" xref="S7.E24.25.25.25.1"></divide><cn id="S7.E24.25.25.25.1.2.cmml" type="integer" xref="S7.E24.25.25.25.1.2">2</cn><cn id="S7.E24.25.25.25.1.3.cmml" type="integer" xref="S7.E24.25.25.25.1.3">3</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E25.m1.5c">\displaystyle\begin{lgathered}FLOPs_{bi}=FLOPs_{proj}+FLOPs_{routing}+FLOPs_{%
attn}\\
=2HWC^{2}+2N_{s}C^{2}+2(S^{2})^{2}C+2HWk\frac{N_{s}}{S^{2}}C\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+2HWk\frac{N_{s}}{S^{2}}\}\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+\frac{kHWN_{s}}{S^{2}}+\frac{kHWN_{s}}{S^{2}}%
\}\\
\geq 2HWC^{2}+2N_{s}C^{2}+3C\{2S^{4}\cdot\frac{kHWN_{s}}{S^{2}}\cdot\frac{kHWN%
_{s}}{S^{2}}\}^{\frac{1}{3}}\\
=2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\end{%
lgathered}FLOPs_{bi}=FLOPs_{proj}+FLOPs_{routing}+FLOPs_{attn}\\
=2HWC^{2}+2N_{s}C^{2}+2(S^{2})^{2}C+2HWk\frac{N_{s}}{S^{2}}C\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+2HWk\frac{N_{s}}{S^{2}}\}\\
=2HWC^{2}+2N_{s}C^{2}+C\{2S^{4}+\frac{kHWN_{s}}{S^{2}}+\frac{kHWN_{s}}{S^{2}}%
\}\\
\geq 2HWC^{2}+2N_{s}C^{2}+3C\{2S^{4}\cdot\frac{kHWN_{s}}{S^{2}}\cdot\frac{kHWN%
_{s}}{S^{2}}\}^{\frac{1}{3}}\\
=2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}</annotation><annotation encoding="application/x-llamapun" id="S7.E25.m1.5d">start_ROW start_CELL italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_b italic_i end_POSTSUBSCRIPT = italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_p italic_r italic_o italic_j end_POSTSUBSCRIPT + italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_r italic_o italic_u italic_t italic_i italic_n italic_g end_POSTSUBSCRIPT + italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_a italic_t italic_t italic_n end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL = 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 ( italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_C + 2 italic_H italic_W italic_k divide start_ARG italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_C end_CELL end_ROW start_ROW start_CELL = 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_C { 2 italic_S start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT + 2 italic_H italic_W italic_k divide start_ARG italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG } end_CELL end_ROW start_ROW start_CELL = 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_C { 2 italic_S start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT + divide start_ARG italic_k italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + divide start_ARG italic_k italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG } end_CELL end_ROW start_ROW start_CELL ≥ 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 3 italic_C { 2 italic_S start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ⋅ divide start_ARG italic_k italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ⋅ divide start_ARG italic_k italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG } start_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL = 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 3 italic_C italic_k start_POSTSUPERSCRIPT divide start_ARG 2 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT { 2 italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT divide start_ARG 2 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S7.SS3.p3.2">where <math alttext="k" class="ltx_Math" display="inline" id="S7.SS3.p3.1.m1.1"><semantics id="S7.SS3.p3.1.m1.1a"><mi id="S7.SS3.p3.1.m1.1.1" xref="S7.SS3.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S7.SS3.p3.1.m1.1b"><ci id="S7.SS3.p3.1.m1.1.1.cmml" xref="S7.SS3.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p3.1.m1.1d">italic_k</annotation></semantics></math> is the number of regions to attend to, and <math alttext="S" class="ltx_Math" display="inline" id="S7.SS3.p3.2.m2.1"><semantics id="S7.SS3.p3.2.m2.1a"><mi id="S7.SS3.p3.2.m2.1.1" xref="S7.SS3.p3.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S7.SS3.p3.2.m2.1b"><ci id="S7.SS3.p3.2.m2.1.1.cmml" xref="S7.SS3.p3.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p3.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p3.2.m2.1d">italic_S</annotation></semantics></math> is the region partition factor. Last, the total computation of DBRA consists of two parts: deformable level multi-head attention and bi-level routing multi-head attention. The total amount of computations is therefore:</p>
</div>
<div class="ltx_para" id="S7.SS3.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx6">
<tbody id="S7.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{lgathered}FLOPs=FLOPs_{bi}+FLOPs_{def}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C\\
+2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\\
=2HWN_{s}C+4HWC^{2}+4N_{s}C^{2}\\
+(k^{2}+6)N_{s}C+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\end{lgathered}%
FLOPs=FLOPs_{bi}+FLOPs_{def}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C\\
+2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\\
=2HWN_{s}C+4HWC^{2}+4N_{s}C^{2}\\
+(k^{2}+6)N_{s}C+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}" class="ltx_Math" display="inline" id="S7.E31.m1.4"><semantics id="S7.E31.m1.4a"><mtable id="S7.E31.m1.4.4.5" rowspacing="0pt" xref="S7.E31.m1.4.4.4.cmml"><mtr id="S7.E31.m1.4.4.5a" xref="S7.E31.m1.4.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E31.m1.4.4.5b" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E26.19.19a" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E26.19.19a.20" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E26.1.1.1" xref="S7.E26.1.1.1.cmml">F</mi><mo id="S7.E26.19.19a.20.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.2.2.2" xref="S7.E26.2.2.2.cmml">L</mi><mo id="S7.E26.19.19a.20.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.3.3.3" xref="S7.E26.3.3.3.cmml">O</mi><mo id="S7.E26.19.19a.20.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.4.4.4" xref="S7.E26.4.4.4.cmml">P</mi><mo id="S7.E26.19.19a.20.1c" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.5.5.5" xref="S7.E26.5.5.5.cmml">s</mi></mrow><mo id="S7.E26.6.6.6" xref="S7.E26.6.6.6.cmml">=</mo><mrow id="S7.E26.19.19a.21" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E26.19.19a.21.1" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E26.7.7.7" xref="S7.E26.7.7.7.cmml">F</mi><mo id="S7.E26.19.19a.21.1.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.8.8.8" xref="S7.E26.8.8.8.cmml">L</mi><mo id="S7.E26.19.19a.21.1.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.9.9.9" xref="S7.E26.9.9.9.cmml">O</mi><mo id="S7.E26.19.19a.21.1.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.10.10.10" xref="S7.E26.10.10.10.cmml">P</mi><mo id="S7.E26.19.19a.21.1.1c" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E26.19.19a.21.1.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E26.11.11.11" xref="S7.E26.11.11.11.cmml">s</mi><mrow id="S7.E26.12.12.12.1" xref="S7.E26.12.12.12.1.cmml"><mi id="S7.E26.12.12.12.1.2" xref="S7.E26.12.12.12.1.2.cmml">b</mi><mo id="S7.E26.12.12.12.1.1" xref="S7.E26.12.12.12.1.1.cmml">⁢</mo><mi id="S7.E26.12.12.12.1.3" xref="S7.E26.12.12.12.1.3.cmml">i</mi></mrow></msub></mrow><mo id="S7.E26.13.13.13" xref="S7.E26.13.13.13.cmml">+</mo><mrow id="S7.E26.19.19a.21.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E26.14.14.14" xref="S7.E26.14.14.14.cmml">F</mi><mo id="S7.E26.19.19a.21.2.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.15.15.15" xref="S7.E26.15.15.15.cmml">L</mi><mo id="S7.E26.19.19a.21.2.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.16.16.16" xref="S7.E26.16.16.16.cmml">O</mi><mo id="S7.E26.19.19a.21.2.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E26.17.17.17" xref="S7.E26.17.17.17.cmml">P</mi><mo id="S7.E26.19.19a.21.2.1c" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E26.19.19a.21.2.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E26.18.18.18" xref="S7.E26.18.18.18.cmml">s</mi><mrow id="S7.E26.19.19.19.1" xref="S7.E26.19.19.19.1.cmml"><mi id="S7.E26.19.19.19.1.2" xref="S7.E26.19.19.19.1.2.cmml">d</mi><mo id="S7.E26.19.19.19.1.1" xref="S7.E26.19.19.19.1.1.cmml">⁢</mo><mi id="S7.E26.19.19.19.1.3" xref="S7.E26.19.19.19.1.3.cmml">e</mi><mo id="S7.E26.19.19.19.1.1a" xref="S7.E26.19.19.19.1.1.cmml">⁢</mo><mi id="S7.E26.19.19.19.1.4" xref="S7.E26.19.19.19.1.4.cmml">f</mi></mrow></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E31.m1.4.4.5c" xref="S7.E31.m1.4.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E31.m1.4.4.5d" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E27.30.30" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E27.30.30.31" xref="S7.E31.m1.4.4.4a.cmml"></mi><mo id="S7.E27.1.1.1" xref="S7.E27.1.1.1.cmml">=</mo><mrow id="S7.E27.30.30.30" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E27.30.30.30.2" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E27.2.2.2" xref="S7.E27.2.2.2.cmml">2</mn><mo id="S7.E27.30.30.30.2.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E27.3.3.3" xref="S7.E27.3.3.3.cmml">H</mi><mo id="S7.E27.30.30.30.2.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E27.4.4.4" xref="S7.E27.4.4.4.cmml">W</mi><mo id="S7.E27.30.30.30.2.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E27.30.30.30.2.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E27.5.5.5" xref="S7.E27.5.5.5.cmml">N</mi><mi id="S7.E27.6.6.6.1" xref="S7.E27.6.6.6.1.cmml">s</mi></msub><mo id="S7.E27.30.30.30.2.1c" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E27.7.7.7" xref="S7.E27.7.7.7.cmml">C</mi></mrow><mo id="S7.E27.8.8.8" xref="S7.E27.8.8.8.cmml">+</mo><mrow id="S7.E27.30.30.30.3" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E27.9.9.9" xref="S7.E27.9.9.9.cmml">2</mn><mo id="S7.E27.30.30.30.3.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E27.10.10.10" xref="S7.E27.10.10.10.cmml">H</mi><mo id="S7.E27.30.30.30.3.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E27.11.11.11" xref="S7.E27.11.11.11.cmml">W</mi><mo id="S7.E27.30.30.30.3.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E27.30.30.30.3.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E27.12.12.12" xref="S7.E27.12.12.12.cmml">C</mi><mn id="S7.E27.13.13.13.1" xref="S7.E27.13.13.13.1.cmml">2</mn></msup></mrow><mo id="S7.E27.8.8.8a" xref="S7.E27.8.8.8.cmml">+</mo><mrow id="S7.E27.30.30.30.4" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E27.15.15.15" xref="S7.E27.15.15.15.cmml">2</mn><mo id="S7.E27.30.30.30.4.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E27.30.30.30.4.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E27.16.16.16" xref="S7.E27.16.16.16.cmml">N</mi><mi id="S7.E27.17.17.17.1" xref="S7.E27.17.17.17.1.cmml">s</mi></msub><mo id="S7.E27.30.30.30.4.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E27.30.30.30.4.3" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E27.18.18.18" xref="S7.E27.18.18.18.cmml">C</mi><mn id="S7.E27.19.19.19.1" xref="S7.E27.19.19.19.1.cmml">2</mn></msup></mrow><mo id="S7.E27.8.8.8b" xref="S7.E27.8.8.8.cmml">+</mo><mrow id="S7.E27.30.30.30.1" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E27.30.30.30.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mo id="S7.E27.21.21.21" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">(</mo><mrow id="S7.E27.30.30.30.1.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><msup id="S7.E27.30.30.30.1.1.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E27.22.22.22" xref="S7.E27.22.22.22.cmml">k</mi><mn id="S7.E27.23.23.23.1" xref="S7.E27.23.23.23.1.cmml">2</mn></msup><mo id="S7.E27.24.24.24" xref="S7.E27.24.24.24.cmml">+</mo><mn id="S7.E27.25.25.25" xref="S7.E27.25.25.25.cmml">6</mn></mrow><mo id="S7.E27.26.26.26" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">)</mo></mrow><mo id="S7.E27.30.30.30.1.2" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E27.30.30.30.1.3" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E27.27.27.27" xref="S7.E27.27.27.27.cmml">N</mi><mi id="S7.E27.28.28.28.1" xref="S7.E27.28.28.28.1.cmml">s</mi></msub><mo id="S7.E27.30.30.30.1.2a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E27.29.29.29" xref="S7.E27.29.29.29.cmml">C</mi></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E31.m1.4.4.5e" xref="S7.E31.m1.4.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E31.m1.4.4.5f" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E28.26.26" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E28.26.26.27" xref="S7.E31.m1.4.4.4.cmml"><mo id="S7.E28.26.26.27a" xref="S7.E31.m1.4.4.4a.cmml">+</mo><mrow id="S7.E28.26.26.27.1" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E28.2.2.2" xref="S7.E28.2.2.2.cmml">2</mn><mo id="S7.E28.26.26.27.1.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E28.3.3.3" xref="S7.E28.3.3.3.cmml">H</mi><mo id="S7.E28.26.26.27.1.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E28.4.4.4" xref="S7.E28.4.4.4.cmml">W</mi><mo id="S7.E28.26.26.27.1.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E28.26.26.27.1.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E28.5.5.5" xref="S7.E28.5.5.5.cmml">C</mi><mn id="S7.E28.6.6.6.1" xref="S7.E28.6.6.6.1.cmml">2</mn></msup></mrow></mrow><mo id="S7.E28.7.7.7" xref="S7.E31.m1.4.4.4a.cmml">+</mo><mrow id="S7.E28.26.26.28" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E28.8.8.8" xref="S7.E28.8.8.8.cmml">2</mn><mo id="S7.E28.26.26.28.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E28.26.26.28.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E28.9.9.9" xref="S7.E28.9.9.9.cmml">N</mi><mi id="S7.E28.10.10.10.1" xref="S7.E28.10.10.10.1.cmml">s</mi></msub><mo id="S7.E28.26.26.28.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E28.26.26.28.3" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E28.11.11.11" xref="S7.E28.11.11.11.cmml">C</mi><mn id="S7.E28.12.12.12.1" xref="S7.E28.12.12.12.1.cmml">2</mn></msup></mrow><mo id="S7.E28.7.7.7a" xref="S7.E31.m1.4.4.4a.cmml">+</mo><mrow id="S7.E28.26.26.26" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E28.14.14.14" xref="S7.E28.14.14.14.cmml">3</mn><mo id="S7.E28.26.26.26.2" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E28.15.15.15" xref="S7.E28.15.15.15.cmml">C</mi><mo id="S7.E28.26.26.26.2a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E28.26.26.26.3" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E28.16.16.16" xref="S7.E28.16.16.16.cmml">k</mi><mfrac id="S7.E28.17.17.17.1" xref="S7.E28.17.17.17.1.cmml"><mn id="S7.E28.17.17.17.1.2" xref="S7.E28.17.17.17.1.2.cmml">2</mn><mn id="S7.E28.17.17.17.1.3" xref="S7.E28.17.17.17.1.3.cmml">3</mn></mfrac></msup><mo id="S7.E28.26.26.26.2b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E28.26.26.26.1" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E28.26.26.26.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mo id="S7.E28.18.18.18" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">{</mo><mrow id="S7.E28.26.26.26.1.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E28.19.19.19" xref="S7.E28.19.19.19.cmml">2</mn><mo id="S7.E28.26.26.26.1.1.1.1.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E28.20.20.20" xref="S7.E28.20.20.20.cmml">H</mi><mo id="S7.E28.26.26.26.1.1.1.1.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E28.21.21.21" xref="S7.E28.21.21.21.cmml">W</mi><mo id="S7.E28.26.26.26.1.1.1.1.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E28.26.26.26.1.1.1.1.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E28.22.22.22" xref="S7.E28.22.22.22.cmml">N</mi><mi id="S7.E28.23.23.23.1" xref="S7.E28.23.23.23.1.cmml">s</mi></msub></mrow><mo id="S7.E28.24.24.24" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">}</mo></mrow><mfrac id="S7.E28.25.25.25.1" xref="S7.E28.25.25.25.1.cmml"><mn id="S7.E28.25.25.25.1.2" xref="S7.E28.25.25.25.1.2.cmml">2</mn><mn id="S7.E28.25.25.25.1.3" xref="S7.E28.25.25.25.1.3.cmml">3</mn></mfrac></msup></mrow></mrow></mtd></mtr><mtr id="S7.E31.m1.4.4.5g" xref="S7.E31.m1.4.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E31.m1.4.4.5h" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E29.19.19a" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E29.19.19a.20" xref="S7.E31.m1.4.4.4a.cmml"></mi><mo id="S7.E29.1.1.1" xref="S7.E29.1.1.1.cmml">=</mo><mrow id="S7.E29.19.19a.21" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E29.19.19a.21.1" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E29.2.2.2" xref="S7.E29.2.2.2.cmml">2</mn><mo id="S7.E29.19.19a.21.1.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E29.3.3.3" xref="S7.E29.3.3.3.cmml">H</mi><mo id="S7.E29.19.19a.21.1.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E29.4.4.4" xref="S7.E29.4.4.4.cmml">W</mi><mo id="S7.E29.19.19a.21.1.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E29.19.19a.21.1.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E29.5.5.5" xref="S7.E29.5.5.5.cmml">N</mi><mi id="S7.E29.6.6.6.1" xref="S7.E29.6.6.6.1.cmml">s</mi></msub><mo id="S7.E29.19.19a.21.1.1c" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E29.7.7.7" xref="S7.E29.7.7.7.cmml">C</mi></mrow><mo id="S7.E29.8.8.8" xref="S7.E29.8.8.8.cmml">+</mo><mrow id="S7.E29.19.19a.21.2" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E29.9.9.9" xref="S7.E29.9.9.9.cmml">4</mn><mo id="S7.E29.19.19a.21.2.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E29.10.10.10" xref="S7.E29.10.10.10.cmml">H</mi><mo id="S7.E29.19.19a.21.2.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E29.11.11.11" xref="S7.E29.11.11.11.cmml">W</mi><mo id="S7.E29.19.19a.21.2.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E29.19.19a.21.2.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E29.12.12.12" xref="S7.E29.12.12.12.cmml">C</mi><mn id="S7.E29.13.13.13.1" xref="S7.E29.13.13.13.1.cmml">2</mn></msup></mrow><mo id="S7.E29.8.8.8a" xref="S7.E29.8.8.8.cmml">+</mo><mrow id="S7.E29.19.19a.21.3" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E29.15.15.15" xref="S7.E29.15.15.15.cmml">4</mn><mo id="S7.E29.19.19a.21.3.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E29.19.19a.21.3.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E29.16.16.16" xref="S7.E29.16.16.16.cmml">N</mi><mi id="S7.E29.17.17.17.1" xref="S7.E29.17.17.17.1.cmml">s</mi></msub><mo id="S7.E29.19.19a.21.3.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E29.19.19a.21.3.3" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E29.18.18.18" xref="S7.E29.18.18.18.cmml">C</mi><mn id="S7.E29.19.19.19.1" xref="S7.E29.19.19.19.1.cmml">2</mn></msup></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E31.m1.4.4.5i" xref="S7.E31.m1.4.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="S7.E31.m1.4.4.5j" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E30.25.25" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E30.24.24.24" xref="S7.E31.m1.4.4.4.cmml"><mo id="S7.E30.24.24.24a" xref="S7.E31.m1.4.4.4a.cmml">+</mo><mrow id="S7.E30.24.24.24.1" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E30.24.24.24.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mo id="S7.E30.2.2.2" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">(</mo><mrow id="S7.E30.24.24.24.1.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><msup id="S7.E30.24.24.24.1.1.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E30.3.3.3" xref="S7.E30.3.3.3.cmml">k</mi><mn id="S7.E30.4.4.4.1" xref="S7.E30.4.4.4.1.cmml">2</mn></msup><mo id="S7.E30.5.5.5" xref="S7.E30.5.5.5.cmml">+</mo><mn id="S7.E30.6.6.6" xref="S7.E30.6.6.6.cmml">6</mn></mrow><mo id="S7.E30.7.7.7" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">)</mo></mrow><mo id="S7.E30.24.24.24.1.2" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E30.24.24.24.1.3" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E30.8.8.8" xref="S7.E30.8.8.8.cmml">N</mi><mi id="S7.E30.9.9.9.1" xref="S7.E30.9.9.9.1.cmml">s</mi></msub><mo id="S7.E30.24.24.24.1.2a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E30.10.10.10" xref="S7.E30.10.10.10.cmml">C</mi></mrow></mrow><mo id="S7.E30.11.11.11" xref="S7.E31.m1.4.4.4a.cmml">+</mo><mrow id="S7.E30.25.25.25" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E30.12.12.12" xref="S7.E30.12.12.12.cmml">3</mn><mo id="S7.E30.25.25.25.2" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E30.13.13.13" xref="S7.E30.13.13.13.cmml">C</mi><mo id="S7.E30.25.25.25.2a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E30.25.25.25.3" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E30.14.14.14" xref="S7.E30.14.14.14.cmml">k</mi><mfrac id="S7.E30.15.15.15.1" xref="S7.E30.15.15.15.1.cmml"><mn id="S7.E30.15.15.15.1.2" xref="S7.E30.15.15.15.1.2.cmml">2</mn><mn id="S7.E30.15.15.15.1.3" xref="S7.E30.15.15.15.1.3.cmml">3</mn></mfrac></msup><mo id="S7.E30.25.25.25.2b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msup id="S7.E30.25.25.25.1" xref="S7.E31.m1.4.4.4.cmml"><mrow id="S7.E30.25.25.25.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mo id="S7.E30.16.16.16" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">{</mo><mrow id="S7.E30.25.25.25.1.1.1.1" xref="S7.E31.m1.4.4.4.cmml"><mn id="S7.E30.17.17.17" xref="S7.E30.17.17.17.cmml">2</mn><mo id="S7.E30.25.25.25.1.1.1.1.1" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E30.18.18.18" xref="S7.E30.18.18.18.cmml">H</mi><mo id="S7.E30.25.25.25.1.1.1.1.1a" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><mi id="S7.E30.19.19.19" xref="S7.E30.19.19.19.cmml">W</mi><mo id="S7.E30.25.25.25.1.1.1.1.1b" xref="S7.E31.m1.4.4.4a.cmml">⁢</mo><msub id="S7.E30.25.25.25.1.1.1.1.2" xref="S7.E31.m1.4.4.4.cmml"><mi id="S7.E30.20.20.20" xref="S7.E30.20.20.20.cmml">N</mi><mi id="S7.E30.21.21.21.1" xref="S7.E30.21.21.21.1.cmml">s</mi></msub></mrow><mo id="S7.E30.22.22.22" stretchy="false" xref="S7.E31.m1.4.4.4a.cmml">}</mo></mrow><mfrac id="S7.E30.23.23.23.1" xref="S7.E30.23.23.23.1.cmml"><mn id="S7.E30.23.23.23.1.2" xref="S7.E30.23.23.23.1.2.cmml">2</mn><mn id="S7.E30.23.23.23.1.3" xref="S7.E30.23.23.23.1.3.cmml">3</mn></mfrac></msup></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S7.E31.m1.4b"><apply id="S7.E31.m1.4.4.4.cmml" xref="S7.E31.m1.4.4.5"><and id="S7.E31.m1.4.4.4a.cmml" xref="S7.E26.19.19a.20.1"></and><apply id="S7.E31.m1.4.4.4b.cmml" xref="S7.E31.m1.4.4.5"><eq id="S7.E26.6.6.6.cmml" xref="S7.E26.6.6.6"></eq><apply id="S7.E31.m1.4.4.4.6.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.6.1.cmml" xref="S7.E26.19.19a.20.1"></times><ci id="S7.E26.1.1.1.cmml" xref="S7.E26.1.1.1">𝐹</ci><ci id="S7.E26.2.2.2.cmml" xref="S7.E26.2.2.2">𝐿</ci><ci id="S7.E26.3.3.3.cmml" xref="S7.E26.3.3.3">𝑂</ci><ci id="S7.E26.4.4.4.cmml" xref="S7.E26.4.4.4">𝑃</ci><ci id="S7.E26.5.5.5.cmml" xref="S7.E26.5.5.5">𝑠</ci></apply><apply id="S7.E31.m1.4.4.4.8.cmml" xref="S7.E31.m1.4.4.5"><plus id="S7.E26.13.13.13.cmml" xref="S7.E26.13.13.13"></plus><apply id="S7.E31.m1.4.4.4.8.2.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.8.2.1.cmml" xref="S7.E26.19.19a.20.1"></times><ci id="S7.E26.7.7.7.cmml" xref="S7.E26.7.7.7">𝐹</ci><ci id="S7.E26.8.8.8.cmml" xref="S7.E26.8.8.8">𝐿</ci><ci id="S7.E26.9.9.9.cmml" xref="S7.E26.9.9.9">𝑂</ci><ci id="S7.E26.10.10.10.cmml" xref="S7.E26.10.10.10">𝑃</ci><apply id="S7.E31.m1.4.4.4.8.2.6.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.8.2.6.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E26.11.11.11.cmml" xref="S7.E26.11.11.11">𝑠</ci><apply id="S7.E26.12.12.12.1.cmml" xref="S7.E26.12.12.12.1"><times id="S7.E26.12.12.12.1.1.cmml" xref="S7.E26.12.12.12.1.1"></times><ci id="S7.E26.12.12.12.1.2.cmml" xref="S7.E26.12.12.12.1.2">𝑏</ci><ci id="S7.E26.12.12.12.1.3.cmml" xref="S7.E26.12.12.12.1.3">𝑖</ci></apply></apply></apply><apply id="S7.E31.m1.4.4.4.8.3.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.8.3.1.cmml" xref="S7.E26.19.19a.20.1"></times><ci id="S7.E26.14.14.14.cmml" xref="S7.E26.14.14.14">𝐹</ci><ci id="S7.E26.15.15.15.cmml" xref="S7.E26.15.15.15">𝐿</ci><ci id="S7.E26.16.16.16.cmml" xref="S7.E26.16.16.16">𝑂</ci><ci id="S7.E26.17.17.17.cmml" xref="S7.E26.17.17.17">𝑃</ci><apply id="S7.E31.m1.4.4.4.8.3.6.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.8.3.6.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E26.18.18.18.cmml" xref="S7.E26.18.18.18">𝑠</ci><apply id="S7.E26.19.19.19.1.cmml" xref="S7.E26.19.19.19.1"><times id="S7.E26.19.19.19.1.1.cmml" xref="S7.E26.19.19.19.1.1"></times><ci id="S7.E26.19.19.19.1.2.cmml" xref="S7.E26.19.19.19.1.2">𝑑</ci><ci id="S7.E26.19.19.19.1.3.cmml" xref="S7.E26.19.19.19.1.3">𝑒</ci><ci id="S7.E26.19.19.19.1.4.cmml" xref="S7.E26.19.19.19.1.4">𝑓</ci></apply></apply></apply></apply></apply><apply id="S7.E31.m1.4.4.4c.cmml" xref="S7.E31.m1.4.4.5"><eq id="S7.E27.1.1.1.cmml" xref="S7.E27.1.1.1"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.E31.m1.4.4.4.8.cmml" id="S7.E31.m1.4.4.4d.cmml" xref="S7.E26.19.19a.20.1"></share><apply id="S7.E31.m1.2.2.2.2.cmml" xref="S7.E31.m1.4.4.5"><plus id="S7.E27.8.8.8.cmml" xref="S7.E27.8.8.8"></plus><apply id="S7.E31.m1.2.2.2.2.4.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.2.2.2.2.4.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E27.2.2.2.cmml" type="integer" xref="S7.E27.2.2.2">2</cn><ci id="S7.E27.3.3.3.cmml" xref="S7.E27.3.3.3">𝐻</ci><ci id="S7.E27.4.4.4.cmml" xref="S7.E27.4.4.4">𝑊</ci><apply id="S7.E31.m1.2.2.2.2.4.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.4.5.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E27.5.5.5.cmml" xref="S7.E27.5.5.5">𝑁</ci><ci id="S7.E27.6.6.6.1.cmml" xref="S7.E27.6.6.6.1">𝑠</ci></apply><ci id="S7.E27.7.7.7.cmml" xref="S7.E27.7.7.7">𝐶</ci></apply><apply id="S7.E31.m1.2.2.2.2.5.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.2.2.2.2.5.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E27.9.9.9.cmml" type="integer" xref="S7.E27.9.9.9">2</cn><ci id="S7.E27.10.10.10.cmml" xref="S7.E27.10.10.10">𝐻</ci><ci id="S7.E27.11.11.11.cmml" xref="S7.E27.11.11.11">𝑊</ci><apply id="S7.E31.m1.2.2.2.2.5.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.5.5.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E27.12.12.12.cmml" xref="S7.E27.12.12.12">𝐶</ci><cn id="S7.E27.13.13.13.1.cmml" type="integer" xref="S7.E27.13.13.13.1">2</cn></apply></apply><apply id="S7.E31.m1.2.2.2.2.6.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.2.2.2.2.6.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E27.15.15.15.cmml" type="integer" xref="S7.E27.15.15.15">2</cn><apply id="S7.E31.m1.2.2.2.2.6.3.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.6.3.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E27.16.16.16.cmml" xref="S7.E27.16.16.16">𝑁</ci><ci id="S7.E27.17.17.17.1.cmml" xref="S7.E27.17.17.17.1">𝑠</ci></apply><apply id="S7.E31.m1.2.2.2.2.6.4.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.6.4.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E27.18.18.18.cmml" xref="S7.E27.18.18.18">𝐶</ci><cn id="S7.E27.19.19.19.1.cmml" type="integer" xref="S7.E27.19.19.19.1">2</cn></apply></apply><apply id="S7.E31.m1.1.1.1.1.1.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.1.1.1.1.1.2.cmml" xref="S7.E26.19.19a.20.1"></times><apply id="S7.E31.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E31.m1.4.4.5"><plus id="S7.E27.24.24.24.cmml" xref="S7.E27.24.24.24"></plus><apply id="S7.E31.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S7.E31.m1.4.4.5">superscript</csymbol><ci id="S7.E27.22.22.22.cmml" xref="S7.E27.22.22.22">𝑘</ci><cn id="S7.E27.23.23.23.1.cmml" type="integer" xref="S7.E27.23.23.23.1">2</cn></apply><cn id="S7.E27.25.25.25.cmml" type="integer" xref="S7.E27.25.25.25">6</cn></apply><apply id="S7.E31.m1.1.1.1.1.1.3.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.1.1.1.1.1.3.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E27.27.27.27.cmml" xref="S7.E27.27.27.27">𝑁</ci><ci id="S7.E27.28.28.28.1.cmml" xref="S7.E27.28.28.28.1">𝑠</ci></apply><ci id="S7.E27.29.29.29.cmml" xref="S7.E27.29.29.29">𝐶</ci></apply><apply id="S7.E31.m1.2.2.2.2.7.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.2.2.2.2.7.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E28.2.2.2.cmml" type="integer" xref="S7.E28.2.2.2">2</cn><ci id="S7.E28.3.3.3.cmml" xref="S7.E28.3.3.3">𝐻</ci><ci id="S7.E28.4.4.4.cmml" xref="S7.E28.4.4.4">𝑊</ci><apply id="S7.E31.m1.2.2.2.2.7.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.7.5.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E28.5.5.5.cmml" xref="S7.E28.5.5.5">𝐶</ci><cn id="S7.E28.6.6.6.1.cmml" type="integer" xref="S7.E28.6.6.6.1">2</cn></apply></apply><apply id="S7.E31.m1.2.2.2.2.8.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.2.2.2.2.8.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E28.8.8.8.cmml" type="integer" xref="S7.E28.8.8.8">2</cn><apply id="S7.E31.m1.2.2.2.2.8.3.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.8.3.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E28.9.9.9.cmml" xref="S7.E28.9.9.9">𝑁</ci><ci id="S7.E28.10.10.10.1.cmml" xref="S7.E28.10.10.10.1">𝑠</ci></apply><apply id="S7.E31.m1.2.2.2.2.8.4.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.8.4.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E28.11.11.11.cmml" xref="S7.E28.11.11.11">𝐶</ci><cn id="S7.E28.12.12.12.1.cmml" type="integer" xref="S7.E28.12.12.12.1">2</cn></apply></apply><apply id="S7.E31.m1.2.2.2.2.2.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.2.2.2.2.2.2.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E28.14.14.14.cmml" type="integer" xref="S7.E28.14.14.14">3</cn><ci id="S7.E28.15.15.15.cmml" xref="S7.E28.15.15.15">𝐶</ci><apply id="S7.E31.m1.2.2.2.2.2.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.2.5.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E28.16.16.16.cmml" xref="S7.E28.16.16.16">𝑘</ci><apply id="S7.E28.17.17.17.1.cmml" xref="S7.E28.17.17.17.1"><divide id="S7.E28.17.17.17.1.1.cmml" xref="S7.E28.17.17.17.1"></divide><cn id="S7.E28.17.17.17.1.2.cmml" type="integer" xref="S7.E28.17.17.17.1.2">2</cn><cn id="S7.E28.17.17.17.1.3.cmml" type="integer" xref="S7.E28.17.17.17.1.3">3</cn></apply></apply><apply id="S7.E31.m1.2.2.2.2.2.1.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.2.1.2.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><set id="S7.E31.m1.2.2.2.2.2.1.1.2.cmml" xref="S7.E31.m1.4.4.5"><apply id="S7.E31.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S7.E31.m1.4.4.5"></times><cn id="S7.E28.19.19.19.cmml" type="integer" xref="S7.E28.19.19.19">2</cn><ci id="S7.E28.20.20.20.cmml" xref="S7.E28.20.20.20">𝐻</ci><ci id="S7.E28.21.21.21.cmml" xref="S7.E28.21.21.21">𝑊</ci><apply id="S7.E31.m1.2.2.2.2.2.1.1.1.1.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.2.2.2.2.2.1.1.1.1.5.1.cmml" xref="S7.E31.m1.4.4.5">subscript</csymbol><ci id="S7.E28.22.22.22.cmml" xref="S7.E28.22.22.22">𝑁</ci><ci id="S7.E28.23.23.23.1.cmml" xref="S7.E28.23.23.23.1">𝑠</ci></apply></apply></set><apply id="S7.E28.25.25.25.1.cmml" xref="S7.E28.25.25.25.1"><divide id="S7.E28.25.25.25.1.1.cmml" xref="S7.E28.25.25.25.1"></divide><cn id="S7.E28.25.25.25.1.2.cmml" type="integer" xref="S7.E28.25.25.25.1.2">2</cn><cn id="S7.E28.25.25.25.1.3.cmml" type="integer" xref="S7.E28.25.25.25.1.3">3</cn></apply></apply></apply></apply></apply><apply id="S7.E31.m1.4.4.4e.cmml" xref="S7.E31.m1.4.4.5"><eq id="S7.E29.1.1.1.cmml" xref="S7.E29.1.1.1"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.E31.m1.2.2.2.2.cmml" id="S7.E31.m1.4.4.4f.cmml" xref="S7.E26.19.19a.20.1"></share><apply id="S7.E31.m1.4.4.4.4.cmml" xref="S7.E31.m1.4.4.5"><plus id="S7.E29.8.8.8.cmml" xref="S7.E29.8.8.8"></plus><apply id="S7.E31.m1.4.4.4.4.4.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.4.4.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E29.2.2.2.cmml" type="integer" xref="S7.E29.2.2.2">2</cn><ci id="S7.E29.3.3.3.cmml" xref="S7.E29.3.3.3">𝐻</ci><ci id="S7.E29.4.4.4.cmml" xref="S7.E29.4.4.4">𝑊</ci><apply id="S7.E31.m1.4.4.4.4.4.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.4.4.5.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E29.5.5.5.cmml" xref="S7.E29.5.5.5">𝑁</ci><ci id="S7.E29.6.6.6.1.cmml" xref="S7.E29.6.6.6.1">𝑠</ci></apply><ci id="S7.E29.7.7.7.cmml" xref="S7.E29.7.7.7">𝐶</ci></apply><apply id="S7.E31.m1.4.4.4.4.5.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.4.5.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E29.9.9.9.cmml" type="integer" xref="S7.E29.9.9.9">4</cn><ci id="S7.E29.10.10.10.cmml" xref="S7.E29.10.10.10">𝐻</ci><ci id="S7.E29.11.11.11.cmml" xref="S7.E29.11.11.11">𝑊</ci><apply id="S7.E31.m1.4.4.4.4.5.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.4.5.5.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E29.12.12.12.cmml" xref="S7.E29.12.12.12">𝐶</ci><cn id="S7.E29.13.13.13.1.cmml" type="integer" xref="S7.E29.13.13.13.1">2</cn></apply></apply><apply id="S7.E31.m1.4.4.4.4.6.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.4.6.1.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E29.15.15.15.cmml" type="integer" xref="S7.E29.15.15.15">4</cn><apply id="S7.E31.m1.4.4.4.4.6.3.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.4.6.3.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E29.16.16.16.cmml" xref="S7.E29.16.16.16">𝑁</ci><ci id="S7.E29.17.17.17.1.cmml" xref="S7.E29.17.17.17.1">𝑠</ci></apply><apply id="S7.E31.m1.4.4.4.4.6.4.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.4.6.4.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E29.18.18.18.cmml" xref="S7.E29.18.18.18">𝐶</ci><cn id="S7.E29.19.19.19.1.cmml" type="integer" xref="S7.E29.19.19.19.1">2</cn></apply></apply><apply id="S7.E31.m1.3.3.3.3.1.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.3.3.3.3.1.2.cmml" xref="S7.E26.19.19a.20.1"></times><apply id="S7.E31.m1.3.3.3.3.1.1.1.1.cmml" xref="S7.E31.m1.4.4.5"><plus id="S7.E30.5.5.5.cmml" xref="S7.E30.5.5.5"></plus><apply id="S7.E31.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S7.E31.m1.4.4.5">superscript</csymbol><ci id="S7.E30.3.3.3.cmml" xref="S7.E30.3.3.3">𝑘</ci><cn id="S7.E30.4.4.4.1.cmml" type="integer" xref="S7.E30.4.4.4.1">2</cn></apply><cn id="S7.E30.6.6.6.cmml" type="integer" xref="S7.E30.6.6.6">6</cn></apply><apply id="S7.E31.m1.3.3.3.3.1.3.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.3.3.3.3.1.3.1.cmml" xref="S7.E26.19.19a.20.1">subscript</csymbol><ci id="S7.E30.8.8.8.cmml" xref="S7.E30.8.8.8">𝑁</ci><ci id="S7.E30.9.9.9.1.cmml" xref="S7.E30.9.9.9.1">𝑠</ci></apply><ci id="S7.E30.10.10.10.cmml" xref="S7.E30.10.10.10">𝐶</ci></apply><apply id="S7.E31.m1.4.4.4.4.2.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.4.2.2.cmml" xref="S7.E26.19.19a.20.1"></times><cn id="S7.E30.12.12.12.cmml" type="integer" xref="S7.E30.12.12.12">3</cn><ci id="S7.E30.13.13.13.cmml" xref="S7.E30.13.13.13">𝐶</ci><apply id="S7.E31.m1.4.4.4.4.2.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.4.2.5.1.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><ci id="S7.E30.14.14.14.cmml" xref="S7.E30.14.14.14">𝑘</ci><apply id="S7.E30.15.15.15.1.cmml" xref="S7.E30.15.15.15.1"><divide id="S7.E30.15.15.15.1.1.cmml" xref="S7.E30.15.15.15.1"></divide><cn id="S7.E30.15.15.15.1.2.cmml" type="integer" xref="S7.E30.15.15.15.1.2">2</cn><cn id="S7.E30.15.15.15.1.3.cmml" type="integer" xref="S7.E30.15.15.15.1.3">3</cn></apply></apply><apply id="S7.E31.m1.4.4.4.4.2.1.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.4.2.1.2.cmml" xref="S7.E26.19.19a.20.1">superscript</csymbol><set id="S7.E31.m1.4.4.4.4.2.1.1.2.cmml" xref="S7.E31.m1.4.4.5"><apply id="S7.E31.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S7.E31.m1.4.4.5"><times id="S7.E31.m1.4.4.4.4.2.1.1.1.1.1.cmml" xref="S7.E31.m1.4.4.5"></times><cn id="S7.E30.17.17.17.cmml" type="integer" xref="S7.E30.17.17.17">2</cn><ci id="S7.E30.18.18.18.cmml" xref="S7.E30.18.18.18">𝐻</ci><ci id="S7.E30.19.19.19.cmml" xref="S7.E30.19.19.19">𝑊</ci><apply id="S7.E31.m1.4.4.4.4.2.1.1.1.1.5.cmml" xref="S7.E31.m1.4.4.5"><csymbol cd="ambiguous" id="S7.E31.m1.4.4.4.4.2.1.1.1.1.5.1.cmml" xref="S7.E31.m1.4.4.5">subscript</csymbol><ci id="S7.E30.20.20.20.cmml" xref="S7.E30.20.20.20">𝑁</ci><ci id="S7.E30.21.21.21.1.cmml" xref="S7.E30.21.21.21.1">𝑠</ci></apply></apply></set><apply id="S7.E30.23.23.23.1.cmml" xref="S7.E30.23.23.23.1"><divide id="S7.E30.23.23.23.1.1.cmml" xref="S7.E30.23.23.23.1"></divide><cn id="S7.E30.23.23.23.1.2.cmml" type="integer" xref="S7.E30.23.23.23.1.2">2</cn><cn id="S7.E30.23.23.23.1.3.cmml" type="integer" xref="S7.E30.23.23.23.1.3">3</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E31.m1.4c">\displaystyle\begin{lgathered}FLOPs=FLOPs_{bi}+FLOPs_{def}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C\\
+2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\\
=2HWN_{s}C+4HWC^{2}+4N_{s}C^{2}\\
+(k^{2}+6)N_{s}C+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\end{lgathered}%
FLOPs=FLOPs_{bi}+FLOPs_{def}\\
=2HWN_{s}C+2HWC^{2}+2N_{s}C^{2}+(k^{2}+6)N_{s}C\\
+2HWC^{2}+2N_{s}C^{2}+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}\\
=2HWN_{s}C+4HWC^{2}+4N_{s}C^{2}\\
+(k^{2}+6)N_{s}C+3Ck^{\frac{2}{3}}\{2HWN_{s}\}^{\frac{2}{3}}</annotation><annotation encoding="application/x-llamapun" id="S7.E31.m1.4d">start_ROW start_CELL italic_F italic_L italic_O italic_P italic_s = italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_b italic_i end_POSTSUBSCRIPT + italic_F italic_L italic_O italic_P italic_s start_POSTSUBSCRIPT italic_d italic_e italic_f end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL = 2 italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C + 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( italic_k start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 6 ) italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C end_CELL end_ROW start_ROW start_CELL + 2 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 3 italic_C italic_k start_POSTSUPERSCRIPT divide start_ARG 2 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT { 2 italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT divide start_ARG 2 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL = 2 italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C + 4 italic_H italic_W italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 4 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL + ( italic_k start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 6 ) italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_C + 3 italic_C italic_k start_POSTSUPERSCRIPT divide start_ARG 2 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT { 2 italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT divide start_ARG 2 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
</table>
<br class="ltx_break"/>
<p class="ltx_p" id="S7.SS3.p4.6">In other words, DBRA achieves <math alttext="O((HWN_{s})^{\frac{2}{3}})" class="ltx_Math" display="inline" id="S7.SS3.p4.1.m1.1"><semantics id="S7.SS3.p4.1.m1.1a"><mrow id="S7.SS3.p4.1.m1.1.1" xref="S7.SS3.p4.1.m1.1.1.cmml"><mi id="S7.SS3.p4.1.m1.1.1.3" xref="S7.SS3.p4.1.m1.1.1.3.cmml">O</mi><mo id="S7.SS3.p4.1.m1.1.1.2" xref="S7.SS3.p4.1.m1.1.1.2.cmml">⁢</mo><mrow id="S7.SS3.p4.1.m1.1.1.1.1" xref="S7.SS3.p4.1.m1.1.1.1.1.1.cmml"><mo id="S7.SS3.p4.1.m1.1.1.1.1.2" stretchy="false" xref="S7.SS3.p4.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S7.SS3.p4.1.m1.1.1.1.1.1" xref="S7.SS3.p4.1.m1.1.1.1.1.1.cmml"><mrow id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.cmml">H</mi><mo id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml">W</mi><mo id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1a" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.cmml">N</mi><mi id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3.cmml">s</mi></msub></mrow><mo id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mfrac id="S7.SS3.p4.1.m1.1.1.1.1.1.3" xref="S7.SS3.p4.1.m1.1.1.1.1.1.3.cmml"><mn id="S7.SS3.p4.1.m1.1.1.1.1.1.3.2" xref="S7.SS3.p4.1.m1.1.1.1.1.1.3.2.cmml">2</mn><mn id="S7.SS3.p4.1.m1.1.1.1.1.1.3.3" xref="S7.SS3.p4.1.m1.1.1.1.1.1.3.3.cmml">3</mn></mfrac></msup><mo id="S7.SS3.p4.1.m1.1.1.1.1.3" stretchy="false" xref="S7.SS3.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p4.1.m1.1b"><apply id="S7.SS3.p4.1.m1.1.1.cmml" xref="S7.SS3.p4.1.m1.1.1"><times id="S7.SS3.p4.1.m1.1.1.2.cmml" xref="S7.SS3.p4.1.m1.1.1.2"></times><ci id="S7.SS3.p4.1.m1.1.1.3.cmml" xref="S7.SS3.p4.1.m1.1.1.3">𝑂</ci><apply id="S7.SS3.p4.1.m1.1.1.1.1.1.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S7.SS3.p4.1.m1.1.1.1.1.1.2.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1">superscript</csymbol><apply id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1"><times id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.2">𝐻</ci><ci id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.3">𝑊</ci><apply id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.2">𝑁</ci><ci id="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.1.1.1.4.3">𝑠</ci></apply></apply><apply id="S7.SS3.p4.1.m1.1.1.1.1.1.3.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.3"><divide id="S7.SS3.p4.1.m1.1.1.1.1.1.3.1.cmml" xref="S7.SS3.p4.1.m1.1.1.1.1.1.3"></divide><cn id="S7.SS3.p4.1.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S7.SS3.p4.1.m1.1.1.1.1.1.3.2">2</cn><cn id="S7.SS3.p4.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S7.SS3.p4.1.m1.1.1.1.1.1.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p4.1.m1.1c">O((HWN_{s})^{\frac{2}{3}})</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p4.1.m1.1d">italic_O ( ( italic_H italic_W italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT divide start_ARG 2 end_ARG start_ARG 3 end_ARG end_POSTSUPERSCRIPT )</annotation></semantics></math> complexity. For example, the <math alttext="3^{rd}" class="ltx_Math" display="inline" id="S7.SS3.p4.2.m2.1"><semantics id="S7.SS3.p4.2.m2.1a"><msup id="S7.SS3.p4.2.m2.1.1" xref="S7.SS3.p4.2.m2.1.1.cmml"><mn id="S7.SS3.p4.2.m2.1.1.2" xref="S7.SS3.p4.2.m2.1.1.2.cmml">3</mn><mrow id="S7.SS3.p4.2.m2.1.1.3" xref="S7.SS3.p4.2.m2.1.1.3.cmml"><mi id="S7.SS3.p4.2.m2.1.1.3.2" xref="S7.SS3.p4.2.m2.1.1.3.2.cmml">r</mi><mo id="S7.SS3.p4.2.m2.1.1.3.1" xref="S7.SS3.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S7.SS3.p4.2.m2.1.1.3.3" xref="S7.SS3.p4.2.m2.1.1.3.3.cmml">d</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S7.SS3.p4.2.m2.1b"><apply id="S7.SS3.p4.2.m2.1.1.cmml" xref="S7.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S7.SS3.p4.2.m2.1.1.1.cmml" xref="S7.SS3.p4.2.m2.1.1">superscript</csymbol><cn id="S7.SS3.p4.2.m2.1.1.2.cmml" type="integer" xref="S7.SS3.p4.2.m2.1.1.2">3</cn><apply id="S7.SS3.p4.2.m2.1.1.3.cmml" xref="S7.SS3.p4.2.m2.1.1.3"><times id="S7.SS3.p4.2.m2.1.1.3.1.cmml" xref="S7.SS3.p4.2.m2.1.1.3.1"></times><ci id="S7.SS3.p4.2.m2.1.1.3.2.cmml" xref="S7.SS3.p4.2.m2.1.1.3.2">𝑟</ci><ci id="S7.SS3.p4.2.m2.1.1.3.3.cmml" xref="S7.SS3.p4.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p4.2.m2.1c">3^{rd}</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p4.2.m2.1d">3 start_POSTSUPERSCRIPT italic_r italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> stage of a hierarchical model with <math alttext="224\times 224" class="ltx_Math" display="inline" id="S7.SS3.p4.3.m3.1"><semantics id="S7.SS3.p4.3.m3.1a"><mrow id="S7.SS3.p4.3.m3.1.1" xref="S7.SS3.p4.3.m3.1.1.cmml"><mn id="S7.SS3.p4.3.m3.1.1.2" xref="S7.SS3.p4.3.m3.1.1.2.cmml">224</mn><mo id="S7.SS3.p4.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.SS3.p4.3.m3.1.1.1.cmml">×</mo><mn id="S7.SS3.p4.3.m3.1.1.3" xref="S7.SS3.p4.3.m3.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p4.3.m3.1b"><apply id="S7.SS3.p4.3.m3.1.1.cmml" xref="S7.SS3.p4.3.m3.1.1"><times id="S7.SS3.p4.3.m3.1.1.1.cmml" xref="S7.SS3.p4.3.m3.1.1.1"></times><cn id="S7.SS3.p4.3.m3.1.1.2.cmml" type="integer" xref="S7.SS3.p4.3.m3.1.1.2">224</cn><cn id="S7.SS3.p4.3.m3.1.1.3.cmml" type="integer" xref="S7.SS3.p4.3.m3.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p4.3.m3.1c">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p4.3.m3.1d">224 × 224</annotation></semantics></math> input for image classification usually has computation sizes of <math alttext="H=W=14\,S^{2}=49\,N_{s}=1\,C=384" class="ltx_Math" display="inline" id="S7.SS3.p4.4.m4.1"><semantics id="S7.SS3.p4.4.m4.1a"><mrow id="S7.SS3.p4.4.m4.1.1" xref="S7.SS3.p4.4.m4.1.1.cmml"><mi id="S7.SS3.p4.4.m4.1.1.2" xref="S7.SS3.p4.4.m4.1.1.2.cmml">H</mi><mo id="S7.SS3.p4.4.m4.1.1.3" xref="S7.SS3.p4.4.m4.1.1.3.cmml">=</mo><mi id="S7.SS3.p4.4.m4.1.1.4" xref="S7.SS3.p4.4.m4.1.1.4.cmml">W</mi><mo id="S7.SS3.p4.4.m4.1.1.5" xref="S7.SS3.p4.4.m4.1.1.5.cmml">=</mo><mrow id="S7.SS3.p4.4.m4.1.1.6" xref="S7.SS3.p4.4.m4.1.1.6.cmml"><mn id="S7.SS3.p4.4.m4.1.1.6.2" xref="S7.SS3.p4.4.m4.1.1.6.2.cmml">14</mn><mo id="S7.SS3.p4.4.m4.1.1.6.1" lspace="0.170em" xref="S7.SS3.p4.4.m4.1.1.6.1.cmml">⁢</mo><msup id="S7.SS3.p4.4.m4.1.1.6.3" xref="S7.SS3.p4.4.m4.1.1.6.3.cmml"><mi id="S7.SS3.p4.4.m4.1.1.6.3.2" xref="S7.SS3.p4.4.m4.1.1.6.3.2.cmml">S</mi><mn id="S7.SS3.p4.4.m4.1.1.6.3.3" xref="S7.SS3.p4.4.m4.1.1.6.3.3.cmml">2</mn></msup></mrow><mo id="S7.SS3.p4.4.m4.1.1.7" xref="S7.SS3.p4.4.m4.1.1.7.cmml">=</mo><mrow id="S7.SS3.p4.4.m4.1.1.8" xref="S7.SS3.p4.4.m4.1.1.8.cmml"><mn id="S7.SS3.p4.4.m4.1.1.8.2" xref="S7.SS3.p4.4.m4.1.1.8.2.cmml">49</mn><mo id="S7.SS3.p4.4.m4.1.1.8.1" lspace="0.170em" xref="S7.SS3.p4.4.m4.1.1.8.1.cmml">⁢</mo><msub id="S7.SS3.p4.4.m4.1.1.8.3" xref="S7.SS3.p4.4.m4.1.1.8.3.cmml"><mi id="S7.SS3.p4.4.m4.1.1.8.3.2" xref="S7.SS3.p4.4.m4.1.1.8.3.2.cmml">N</mi><mi id="S7.SS3.p4.4.m4.1.1.8.3.3" xref="S7.SS3.p4.4.m4.1.1.8.3.3.cmml">s</mi></msub></mrow><mo id="S7.SS3.p4.4.m4.1.1.9" xref="S7.SS3.p4.4.m4.1.1.9.cmml">=</mo><mrow id="S7.SS3.p4.4.m4.1.1.10" xref="S7.SS3.p4.4.m4.1.1.10.cmml"><mn id="S7.SS3.p4.4.m4.1.1.10.2" xref="S7.SS3.p4.4.m4.1.1.10.2.cmml">1</mn><mo id="S7.SS3.p4.4.m4.1.1.10.1" lspace="0.170em" xref="S7.SS3.p4.4.m4.1.1.10.1.cmml">⁢</mo><mi id="S7.SS3.p4.4.m4.1.1.10.3" xref="S7.SS3.p4.4.m4.1.1.10.3.cmml">C</mi></mrow><mo id="S7.SS3.p4.4.m4.1.1.11" xref="S7.SS3.p4.4.m4.1.1.11.cmml">=</mo><mn id="S7.SS3.p4.4.m4.1.1.12" xref="S7.SS3.p4.4.m4.1.1.12.cmml">384</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.p4.4.m4.1b"><apply id="S7.SS3.p4.4.m4.1.1.cmml" xref="S7.SS3.p4.4.m4.1.1"><and id="S7.SS3.p4.4.m4.1.1a.cmml" xref="S7.SS3.p4.4.m4.1.1"></and><apply id="S7.SS3.p4.4.m4.1.1b.cmml" xref="S7.SS3.p4.4.m4.1.1"><eq id="S7.SS3.p4.4.m4.1.1.3.cmml" xref="S7.SS3.p4.4.m4.1.1.3"></eq><ci id="S7.SS3.p4.4.m4.1.1.2.cmml" xref="S7.SS3.p4.4.m4.1.1.2">𝐻</ci><ci id="S7.SS3.p4.4.m4.1.1.4.cmml" xref="S7.SS3.p4.4.m4.1.1.4">𝑊</ci></apply><apply id="S7.SS3.p4.4.m4.1.1c.cmml" xref="S7.SS3.p4.4.m4.1.1"><eq id="S7.SS3.p4.4.m4.1.1.5.cmml" xref="S7.SS3.p4.4.m4.1.1.5"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.SS3.p4.4.m4.1.1.4.cmml" id="S7.SS3.p4.4.m4.1.1d.cmml" xref="S7.SS3.p4.4.m4.1.1"></share><apply id="S7.SS3.p4.4.m4.1.1.6.cmml" xref="S7.SS3.p4.4.m4.1.1.6"><times id="S7.SS3.p4.4.m4.1.1.6.1.cmml" xref="S7.SS3.p4.4.m4.1.1.6.1"></times><cn id="S7.SS3.p4.4.m4.1.1.6.2.cmml" type="integer" xref="S7.SS3.p4.4.m4.1.1.6.2">14</cn><apply id="S7.SS3.p4.4.m4.1.1.6.3.cmml" xref="S7.SS3.p4.4.m4.1.1.6.3"><csymbol cd="ambiguous" id="S7.SS3.p4.4.m4.1.1.6.3.1.cmml" xref="S7.SS3.p4.4.m4.1.1.6.3">superscript</csymbol><ci id="S7.SS3.p4.4.m4.1.1.6.3.2.cmml" xref="S7.SS3.p4.4.m4.1.1.6.3.2">𝑆</ci><cn id="S7.SS3.p4.4.m4.1.1.6.3.3.cmml" type="integer" xref="S7.SS3.p4.4.m4.1.1.6.3.3">2</cn></apply></apply></apply><apply id="S7.SS3.p4.4.m4.1.1e.cmml" xref="S7.SS3.p4.4.m4.1.1"><eq id="S7.SS3.p4.4.m4.1.1.7.cmml" xref="S7.SS3.p4.4.m4.1.1.7"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.SS3.p4.4.m4.1.1.6.cmml" id="S7.SS3.p4.4.m4.1.1f.cmml" xref="S7.SS3.p4.4.m4.1.1"></share><apply id="S7.SS3.p4.4.m4.1.1.8.cmml" xref="S7.SS3.p4.4.m4.1.1.8"><times id="S7.SS3.p4.4.m4.1.1.8.1.cmml" xref="S7.SS3.p4.4.m4.1.1.8.1"></times><cn id="S7.SS3.p4.4.m4.1.1.8.2.cmml" type="integer" xref="S7.SS3.p4.4.m4.1.1.8.2">49</cn><apply id="S7.SS3.p4.4.m4.1.1.8.3.cmml" xref="S7.SS3.p4.4.m4.1.1.8.3"><csymbol cd="ambiguous" id="S7.SS3.p4.4.m4.1.1.8.3.1.cmml" xref="S7.SS3.p4.4.m4.1.1.8.3">subscript</csymbol><ci id="S7.SS3.p4.4.m4.1.1.8.3.2.cmml" xref="S7.SS3.p4.4.m4.1.1.8.3.2">𝑁</ci><ci id="S7.SS3.p4.4.m4.1.1.8.3.3.cmml" xref="S7.SS3.p4.4.m4.1.1.8.3.3">𝑠</ci></apply></apply></apply><apply id="S7.SS3.p4.4.m4.1.1g.cmml" xref="S7.SS3.p4.4.m4.1.1"><eq id="S7.SS3.p4.4.m4.1.1.9.cmml" xref="S7.SS3.p4.4.m4.1.1.9"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.SS3.p4.4.m4.1.1.8.cmml" id="S7.SS3.p4.4.m4.1.1h.cmml" xref="S7.SS3.p4.4.m4.1.1"></share><apply id="S7.SS3.p4.4.m4.1.1.10.cmml" xref="S7.SS3.p4.4.m4.1.1.10"><times id="S7.SS3.p4.4.m4.1.1.10.1.cmml" xref="S7.SS3.p4.4.m4.1.1.10.1"></times><cn id="S7.SS3.p4.4.m4.1.1.10.2.cmml" type="integer" xref="S7.SS3.p4.4.m4.1.1.10.2">1</cn><ci id="S7.SS3.p4.4.m4.1.1.10.3.cmml" xref="S7.SS3.p4.4.m4.1.1.10.3">𝐶</ci></apply></apply><apply id="S7.SS3.p4.4.m4.1.1i.cmml" xref="S7.SS3.p4.4.m4.1.1"><eq id="S7.SS3.p4.4.m4.1.1.11.cmml" xref="S7.SS3.p4.4.m4.1.1.11"></eq><share href="https://arxiv.org/html/2410.08582v1#S7.SS3.p4.4.m4.1.1.10.cmml" id="S7.SS3.p4.4.m4.1.1j.cmml" xref="S7.SS3.p4.4.m4.1.1"></share><cn id="S7.SS3.p4.4.m4.1.1.12.cmml" type="integer" xref="S7.SS3.p4.4.m4.1.1.12">384</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p4.4.m4.1c">H=W=14\,S^{2}=49\,N_{s}=1\,C=384</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p4.4.m4.1d">italic_H = italic_W = 14 italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = 49 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = 1 italic_C = 384</annotation></semantics></math> and thus computational complexity for multi-head self-attention. Additionally, the complexity could be further reduced by enlarging the downsampling factor <math alttext="r" class="ltx_Math" display="inline" id="S7.SS3.p4.5.m5.1"><semantics id="S7.SS3.p4.5.m5.1a"><mi id="S7.SS3.p4.5.m5.1.1" xref="S7.SS3.p4.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S7.SS3.p4.5.m5.1b"><ci id="S7.SS3.p4.5.m5.1.1.cmml" xref="S7.SS3.p4.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p4.5.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p4.5.m5.1d">italic_r</annotation></semantics></math> and scale with region partition factor <math alttext="S" class="ltx_Math" display="inline" id="S7.SS3.p4.6.m6.1"><semantics id="S7.SS3.p4.6.m6.1a"><mi id="S7.SS3.p4.6.m6.1.1" xref="S7.SS3.p4.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S7.SS3.p4.6.m6.1b"><ci id="S7.SS3.p4.6.m6.1.1.cmml" xref="S7.SS3.p4.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p4.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p4.6.m6.1d">italic_S</annotation></semantics></math>, making it friendly to tasks with much higher resolution inputs such as object detection and instance segmentation.</p>
</div>
<figure class="ltx_table" id="S7.T8">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S7.T8.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T8.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T8.1.1.1.1">Backbone</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T8.1.1.1.2">mIoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T8.1.1.1.3">MS mIoU</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.2.2.1">Swin-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib29" title="">29</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.2.2.2">47.6</td>
<td class="ltx_td ltx_align_center" id="S7.T8.1.2.2.3">49.5</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.3.3.1">DAT-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib47" title="">47</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.3.3.2">48.3</td>
<td class="ltx_td ltx_align_center" id="S7.T8.1.3.3.3">49.8</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.4.4.1">CSWin-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib14" title="">14</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.4.4.2">50.4</td>
<td class="ltx_td ltx_align_center" id="S7.T8.1.4.4.3">51.5</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.5.5.1">InternImage-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib43" title="">43</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.5.5.2">50.1</td>
<td class="ltx_td ltx_align_center" id="S7.T8.1.5.5.3">50.9</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.6.6.1">CrossFormer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib45" title="">45</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.6.6.2">49.7</td>
<td class="ltx_td ltx_align_center" id="S7.T8.1.6.6.3">50.6</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.7.7.1">Uniformer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib26" title="">26</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.7.7.2">50.0</td>
<td class="ltx_td ltx_align_center" id="S7.T8.1.7.7.3">50.8</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.8.8.1">BiFormer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T8.1.8.8.2">51.0</td>
<td class="ltx_td ltx_align_center" id="S7.T8.1.8.8.3">51.7</td>
</tr>
<tr class="ltx_tr" id="S7.T8.1.9.9" style="background-color:#96FFFB;">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S7.T8.1.9.9.1"><span class="ltx_text" id="S7.T8.1.9.9.1.1" style="background-color:#96FFFB;">DeBiFormer-B</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S7.T8.1.9.9.2"><span class="ltx_text ltx_font_bold" id="S7.T8.1.9.9.2.1" style="background-color:#96FFFB;">51.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S7.T8.1.9.9.3"><span class="ltx_text ltx_font_bold" id="S7.T8.1.9.9.3.1" style="background-color:#96FFFB;">52.0</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Evaluating DeBiFormer on semantic segmentation with two segmentation heads (UpperNet With MS IoU Scale) on ADE20K dataset.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S7.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4 </span>Token to Attend</h3>
<div class="ltx_para" id="S7.SS4.p1">
<p class="ltx_p" id="S7.SS4.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.T9" title="Table 9 ‣ 7.4 Token to Attend ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">9</span></a>, we present the token to attend to the query and the token to attend to the deformable point. Compared with other methods, DeBiFormer has the fewest tokens to attend for each query but has a high performance in Imagenet1K, ADE20K(S-FPN head) and COCO(Retina head).</p>
</div>
<figure class="ltx_table" id="S7.T9">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T9.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T9.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S7.T9.1.1.1.1">#Backbone</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T9.1.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="S7.T9.1.1.1.2.1">
<tr class="ltx_tr" id="S7.T9.1.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.2.1.1.1">Token to attend</td>
</tr>
<tr class="ltx_tr" id="S7.T9.1.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.2.1.2.1">for each query</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T9.1.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="S7.T9.1.1.1.3.1">
<tr class="ltx_tr" id="S7.T9.1.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.3.1.1.1">IN1K</td>
</tr>
<tr class="ltx_tr" id="S7.T9.1.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.3.1.2.1">Top1(%)</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S7.T9.1.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="S7.T9.1.1.1.4.1">
<tr class="ltx_tr" id="S7.T9.1.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.4.1.1.1">ADE20K</td>
</tr>
<tr class="ltx_tr" id="S7.T9.1.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.4.1.2.1">mIoU(%)</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T9.1.1.1.5">
<table class="ltx_tabular ltx_align_middle" id="S7.T9.1.1.1.5.1">
<tr class="ltx_tr" id="S7.T9.1.1.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.5.1.1.1">COCO</td>
</tr>
<tr class="ltx_tr" id="S7.T9.1.1.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T9.1.1.1.5.1.2.1">mAP(%)</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T9.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T9.1.2.1.1">QuadTree-B3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T9.1.2.1.2">2048, 512, 128, 32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T9.1.2.1.3">83.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S7.T9.1.2.1.4">50.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T9.1.2.1.5"><span class="ltx_text ltx_font_bold" id="S7.T9.1.2.1.5.1">47.3</span></td>
</tr>
<tr class="ltx_tr" id="S7.T9.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T9.1.3.2.1">BiFormer-B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib56" title="">56</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T9.1.3.2.2">64, 64, 64, 49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T9.1.3.2.3">84.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S7.T9.1.3.2.4">49.9</td>
<td class="ltx_td ltx_align_center" id="S7.T9.1.3.2.5">47.1</td>
</tr>
<tr class="ltx_tr" id="S7.T9.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S7.T9.1.4.3.1">Debiformer-B</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S7.T9.1.4.3.2">1, 1, 1, 1</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S7.T9.1.4.3.3"><span class="ltx_text ltx_font_bold" id="S7.T9.1.4.3.3.1">84.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S7.T9.1.4.3.4"><span class="ltx_text ltx_font_bold" id="S7.T9.1.4.3.4.1">50.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S7.T9.1.4.3.5">47.1</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Comparing different backbones Token to attend for each query in on ImageNet-1K, ADE20K, COCO.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S7.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.5 </span>More visualization results</h3>
<section class="ltx_subsubsection" id="S7.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.5.1 </span>Effective Receptive Field Analysis</h4>
<div class="ltx_para" id="S7.SS5.SSS1.p1">
<p class="ltx_p" id="S7.SS5.SSS1.p1.1">To assess the effective receptive fields (ERFs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib32" title="">32</a>]</cite> of the central pixel with an input size of <math alttext="224\times 224" class="ltx_Math" display="inline" id="S7.SS5.SSS1.p1.1.m1.1"><semantics id="S7.SS5.SSS1.p1.1.m1.1a"><mrow id="S7.SS5.SSS1.p1.1.m1.1.1" xref="S7.SS5.SSS1.p1.1.m1.1.1.cmml"><mn id="S7.SS5.SSS1.p1.1.m1.1.1.2" xref="S7.SS5.SSS1.p1.1.m1.1.1.2.cmml">224</mn><mo id="S7.SS5.SSS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.SS5.SSS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S7.SS5.SSS1.p1.1.m1.1.1.3" xref="S7.SS5.SSS1.p1.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS5.SSS1.p1.1.m1.1b"><apply id="S7.SS5.SSS1.p1.1.m1.1.1.cmml" xref="S7.SS5.SSS1.p1.1.m1.1.1"><times id="S7.SS5.SSS1.p1.1.m1.1.1.1.cmml" xref="S7.SS5.SSS1.p1.1.m1.1.1.1"></times><cn id="S7.SS5.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S7.SS5.SSS1.p1.1.m1.1.1.2">224</cn><cn id="S7.SS5.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S7.SS5.SSS1.p1.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS5.SSS1.p1.1.m1.1c">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S7.SS5.SSS1.p1.1.m1.1d">224 × 224</annotation></semantics></math> across various models, we present a comparative analysis in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.F5" title="Figure 5 ‣ 7.5.1 Effective Receptive Field Analysis ‣ 7.5 More visualization results ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">5</span></a>.
To demonstrate the powerful representation capacity of our DeBiFormer, we also compare the ERF of several SOTA methods with similar computational costs. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.F5" title="Figure 5 ‣ 7.5.1 Effective Receptive Field Analysis ‣ 7.5 More visualization results ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">5</span></a>, our DeBiFormer has the largest and most consistent ERF among these methods while maintaining strong local sensitivity, which is challenging to achieve.</p>
</div>
<figure class="ltx_figure" id="S7.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="582" id="S7.F5.1.g1" src="x5.png" width="664"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>ERF visualization of models incorporating various local operators
and SOTA methods. The results are obtained by averaging over 100 images
(resized to 224×224) from ImageNet.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S7.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.5.2 </span>Grad-CAM Analysis</h4>
<div class="ltx_para" id="S7.SS5.SSS2.p1">
<p class="ltx_p" id="S7.SS5.SSS2.p1.1">To further show how DBRA works, we demonstrate more visualization results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.F6" title="Figure 6 ‣ 7.5.2 Grad-CAM Analysis ‣ 7.5 More visualization results ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure class="ltx_figure" id="S7.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S7.F6.1" style="width:411.9pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="515" id="S7.F6.1.g1" src="x6.png" width="830"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S7.F6.2" style="width:411.9pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="511" id="S7.F6.2.g1" src="x7.png" width="830"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>More Visualization of attention maps for different stages of DeBiFormer-Base. The attention maps show the focused regions has extracted large to small in each stage. Meanwhile the model fitted out the unessential regions to extract and enhance the important regions features in each stage.</figcaption>
</figure>
<div class="ltx_para" id="S7.SS5.SSS2.p2">
<p class="ltx_p" id="S7.SS5.SSS2.p2.1">Thanks to the flexible key-value pairs selection, in most cases, our DeBiFormer focuses on important objects at an earlier stage. Meanwhile, due to the reasonable allocation of deformable points, it also focuses on different important areas earlier in multi-object scenarios. With the powerful DBRA module, our DeBiFormer has a larger heat map area in the last two stages, which represents a stronger ability of recognition.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S7.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.6 </span>Detailed Experimental Settings</h3>
<figure class="ltx_table" id="S7.T10">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T10.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T10.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T10.6.7.1.1"><span class="ltx_text" id="S7.T10.6.7.1.1.1" style="font-size:90%;">Settings</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.7.1.2"><span class="ltx_text" id="S7.T10.6.7.1.2.1" style="font-size:90%;">DeBi-T</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.7.1.3"><span class="ltx_text" id="S7.T10.6.7.1.3.1" style="font-size:90%;">DeBi-S</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.7.1.4"><span class="ltx_text" id="S7.T10.6.7.1.4.1" style="font-size:90%;">DeBi-B</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T10.6.8.2.1"><span class="ltx_text" id="S7.T10.6.8.2.1.1" style="font-size:90%;">Input resolution</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.8.2.2"><span class="ltx_text" id="S7.T10.6.8.2.2.1" style="font-size:90%;">224</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.8.2.3"><span class="ltx_text" id="S7.T10.6.8.2.3.1" style="font-size:90%;">224</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.8.2.4"><span class="ltx_text" id="S7.T10.6.8.2.4.1" style="font-size:90%;">224</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.9.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.9.3.1"><span class="ltx_text" id="S7.T10.6.9.3.1.1" style="font-size:90%;">Batch size</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.9.3.2"><span class="ltx_text" id="S7.T10.6.9.3.2.1" style="font-size:90%;">1024</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.9.3.3"><span class="ltx_text" id="S7.T10.6.9.3.3.1" style="font-size:90%;">512</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.9.3.4"><span class="ltx_text" id="S7.T10.6.9.3.4.1" style="font-size:90%;">512</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.10.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.10.4.1"><span class="ltx_text" id="S7.T10.6.10.4.1.1" style="font-size:90%;">Optimizer</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.10.4.2"><span class="ltx_text" id="S7.T10.6.10.4.2.1" style="font-size:90%;">AdamW</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.10.4.3"><span class="ltx_text" id="S7.T10.6.10.4.3.1" style="font-size:90%;">AdamW</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.10.4.4"><span class="ltx_text" id="S7.T10.6.10.4.4.1" style="font-size:90%;">AdamW</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.3.3.4"><span class="ltx_text" id="S7.T10.3.3.4.1" style="font-size:90%;">Learning rate</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.1.1.1"><math alttext="1\times 10^{-3}" class="ltx_Math" display="inline" id="S7.T10.1.1.1.m1.1"><semantics id="S7.T10.1.1.1.m1.1a"><mrow id="S7.T10.1.1.1.m1.1.1" xref="S7.T10.1.1.1.m1.1.1.cmml"><mn id="S7.T10.1.1.1.m1.1.1.2" mathsize="90%" xref="S7.T10.1.1.1.m1.1.1.2.cmml">1</mn><mo id="S7.T10.1.1.1.m1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S7.T10.1.1.1.m1.1.1.1.cmml">×</mo><msup id="S7.T10.1.1.1.m1.1.1.3" xref="S7.T10.1.1.1.m1.1.1.3.cmml"><mn id="S7.T10.1.1.1.m1.1.1.3.2" mathsize="90%" xref="S7.T10.1.1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S7.T10.1.1.1.m1.1.1.3.3" xref="S7.T10.1.1.1.m1.1.1.3.3.cmml"><mo id="S7.T10.1.1.1.m1.1.1.3.3a" mathsize="90%" xref="S7.T10.1.1.1.m1.1.1.3.3.cmml">−</mo><mn id="S7.T10.1.1.1.m1.1.1.3.3.2" mathsize="90%" xref="S7.T10.1.1.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.T10.1.1.1.m1.1b"><apply id="S7.T10.1.1.1.m1.1.1.cmml" xref="S7.T10.1.1.1.m1.1.1"><times id="S7.T10.1.1.1.m1.1.1.1.cmml" xref="S7.T10.1.1.1.m1.1.1.1"></times><cn id="S7.T10.1.1.1.m1.1.1.2.cmml" type="integer" xref="S7.T10.1.1.1.m1.1.1.2">1</cn><apply id="S7.T10.1.1.1.m1.1.1.3.cmml" xref="S7.T10.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S7.T10.1.1.1.m1.1.1.3.1.cmml" xref="S7.T10.1.1.1.m1.1.1.3">superscript</csymbol><cn id="S7.T10.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="S7.T10.1.1.1.m1.1.1.3.2">10</cn><apply id="S7.T10.1.1.1.m1.1.1.3.3.cmml" xref="S7.T10.1.1.1.m1.1.1.3.3"><minus id="S7.T10.1.1.1.m1.1.1.3.3.1.cmml" xref="S7.T10.1.1.1.m1.1.1.3.3"></minus><cn id="S7.T10.1.1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S7.T10.1.1.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T10.1.1.1.m1.1c">1\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S7.T10.1.1.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T10.2.2.2"><math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="S7.T10.2.2.2.m1.1"><semantics id="S7.T10.2.2.2.m1.1a"><mrow id="S7.T10.2.2.2.m1.1.1" xref="S7.T10.2.2.2.m1.1.1.cmml"><mn id="S7.T10.2.2.2.m1.1.1.2" mathsize="90%" xref="S7.T10.2.2.2.m1.1.1.2.cmml">5</mn><mo id="S7.T10.2.2.2.m1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S7.T10.2.2.2.m1.1.1.1.cmml">×</mo><msup id="S7.T10.2.2.2.m1.1.1.3" xref="S7.T10.2.2.2.m1.1.1.3.cmml"><mn id="S7.T10.2.2.2.m1.1.1.3.2" mathsize="90%" xref="S7.T10.2.2.2.m1.1.1.3.2.cmml">10</mn><mrow id="S7.T10.2.2.2.m1.1.1.3.3" xref="S7.T10.2.2.2.m1.1.1.3.3.cmml"><mo id="S7.T10.2.2.2.m1.1.1.3.3a" mathsize="90%" xref="S7.T10.2.2.2.m1.1.1.3.3.cmml">−</mo><mn id="S7.T10.2.2.2.m1.1.1.3.3.2" mathsize="90%" xref="S7.T10.2.2.2.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.T10.2.2.2.m1.1b"><apply id="S7.T10.2.2.2.m1.1.1.cmml" xref="S7.T10.2.2.2.m1.1.1"><times id="S7.T10.2.2.2.m1.1.1.1.cmml" xref="S7.T10.2.2.2.m1.1.1.1"></times><cn id="S7.T10.2.2.2.m1.1.1.2.cmml" type="integer" xref="S7.T10.2.2.2.m1.1.1.2">5</cn><apply id="S7.T10.2.2.2.m1.1.1.3.cmml" xref="S7.T10.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S7.T10.2.2.2.m1.1.1.3.1.cmml" xref="S7.T10.2.2.2.m1.1.1.3">superscript</csymbol><cn id="S7.T10.2.2.2.m1.1.1.3.2.cmml" type="integer" xref="S7.T10.2.2.2.m1.1.1.3.2">10</cn><apply id="S7.T10.2.2.2.m1.1.1.3.3.cmml" xref="S7.T10.2.2.2.m1.1.1.3.3"><minus id="S7.T10.2.2.2.m1.1.1.3.3.1.cmml" xref="S7.T10.2.2.2.m1.1.1.3.3"></minus><cn id="S7.T10.2.2.2.m1.1.1.3.3.2.cmml" type="integer" xref="S7.T10.2.2.2.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T10.2.2.2.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S7.T10.2.2.2.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T10.3.3.3"><math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="S7.T10.3.3.3.m1.1"><semantics id="S7.T10.3.3.3.m1.1a"><mrow id="S7.T10.3.3.3.m1.1.1" xref="S7.T10.3.3.3.m1.1.1.cmml"><mn id="S7.T10.3.3.3.m1.1.1.2" mathsize="90%" xref="S7.T10.3.3.3.m1.1.1.2.cmml">5</mn><mo id="S7.T10.3.3.3.m1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S7.T10.3.3.3.m1.1.1.1.cmml">×</mo><msup id="S7.T10.3.3.3.m1.1.1.3" xref="S7.T10.3.3.3.m1.1.1.3.cmml"><mn id="S7.T10.3.3.3.m1.1.1.3.2" mathsize="90%" xref="S7.T10.3.3.3.m1.1.1.3.2.cmml">10</mn><mrow id="S7.T10.3.3.3.m1.1.1.3.3" xref="S7.T10.3.3.3.m1.1.1.3.3.cmml"><mo id="S7.T10.3.3.3.m1.1.1.3.3a" mathsize="90%" xref="S7.T10.3.3.3.m1.1.1.3.3.cmml">−</mo><mn id="S7.T10.3.3.3.m1.1.1.3.3.2" mathsize="90%" xref="S7.T10.3.3.3.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.T10.3.3.3.m1.1b"><apply id="S7.T10.3.3.3.m1.1.1.cmml" xref="S7.T10.3.3.3.m1.1.1"><times id="S7.T10.3.3.3.m1.1.1.1.cmml" xref="S7.T10.3.3.3.m1.1.1.1"></times><cn id="S7.T10.3.3.3.m1.1.1.2.cmml" type="integer" xref="S7.T10.3.3.3.m1.1.1.2">5</cn><apply id="S7.T10.3.3.3.m1.1.1.3.cmml" xref="S7.T10.3.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="S7.T10.3.3.3.m1.1.1.3.1.cmml" xref="S7.T10.3.3.3.m1.1.1.3">superscript</csymbol><cn id="S7.T10.3.3.3.m1.1.1.3.2.cmml" type="integer" xref="S7.T10.3.3.3.m1.1.1.3.2">10</cn><apply id="S7.T10.3.3.3.m1.1.1.3.3.cmml" xref="S7.T10.3.3.3.m1.1.1.3.3"><minus id="S7.T10.3.3.3.m1.1.1.3.3.1.cmml" xref="S7.T10.3.3.3.m1.1.1.3.3"></minus><cn id="S7.T10.3.3.3.m1.1.1.3.3.2.cmml" type="integer" xref="S7.T10.3.3.3.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T10.3.3.3.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S7.T10.3.3.3.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.11.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.11.5.1"><span class="ltx_text" id="S7.T10.6.11.5.1.1" style="font-size:90%;">LR schedule</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.11.5.2"><span class="ltx_text" id="S7.T10.6.11.5.2.1" style="font-size:90%;">cosine</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.11.5.3"><span class="ltx_text" id="S7.T10.6.11.5.3.1" style="font-size:90%;">cosine</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.11.5.4"><span class="ltx_text" id="S7.T10.6.11.5.4.1" style="font-size:90%;">cosine</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.6.4"><span class="ltx_text" id="S7.T10.6.6.4.1" style="font-size:90%;">Weight decay</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.4.4.1"><math alttext="5\times 10^{-2}" class="ltx_Math" display="inline" id="S7.T10.4.4.1.m1.1"><semantics id="S7.T10.4.4.1.m1.1a"><mrow id="S7.T10.4.4.1.m1.1.1" xref="S7.T10.4.4.1.m1.1.1.cmml"><mn id="S7.T10.4.4.1.m1.1.1.2" mathsize="90%" xref="S7.T10.4.4.1.m1.1.1.2.cmml">5</mn><mo id="S7.T10.4.4.1.m1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S7.T10.4.4.1.m1.1.1.1.cmml">×</mo><msup id="S7.T10.4.4.1.m1.1.1.3" xref="S7.T10.4.4.1.m1.1.1.3.cmml"><mn id="S7.T10.4.4.1.m1.1.1.3.2" mathsize="90%" xref="S7.T10.4.4.1.m1.1.1.3.2.cmml">10</mn><mrow id="S7.T10.4.4.1.m1.1.1.3.3" xref="S7.T10.4.4.1.m1.1.1.3.3.cmml"><mo id="S7.T10.4.4.1.m1.1.1.3.3a" mathsize="90%" xref="S7.T10.4.4.1.m1.1.1.3.3.cmml">−</mo><mn id="S7.T10.4.4.1.m1.1.1.3.3.2" mathsize="90%" xref="S7.T10.4.4.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.T10.4.4.1.m1.1b"><apply id="S7.T10.4.4.1.m1.1.1.cmml" xref="S7.T10.4.4.1.m1.1.1"><times id="S7.T10.4.4.1.m1.1.1.1.cmml" xref="S7.T10.4.4.1.m1.1.1.1"></times><cn id="S7.T10.4.4.1.m1.1.1.2.cmml" type="integer" xref="S7.T10.4.4.1.m1.1.1.2">5</cn><apply id="S7.T10.4.4.1.m1.1.1.3.cmml" xref="S7.T10.4.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S7.T10.4.4.1.m1.1.1.3.1.cmml" xref="S7.T10.4.4.1.m1.1.1.3">superscript</csymbol><cn id="S7.T10.4.4.1.m1.1.1.3.2.cmml" type="integer" xref="S7.T10.4.4.1.m1.1.1.3.2">10</cn><apply id="S7.T10.4.4.1.m1.1.1.3.3.cmml" xref="S7.T10.4.4.1.m1.1.1.3.3"><minus id="S7.T10.4.4.1.m1.1.1.3.3.1.cmml" xref="S7.T10.4.4.1.m1.1.1.3.3"></minus><cn id="S7.T10.4.4.1.m1.1.1.3.3.2.cmml" type="integer" xref="S7.T10.4.4.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T10.4.4.1.m1.1c">5\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S7.T10.4.4.1.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T10.5.5.2"><math alttext="5\times 10^{-2}" class="ltx_Math" display="inline" id="S7.T10.5.5.2.m1.1"><semantics id="S7.T10.5.5.2.m1.1a"><mrow id="S7.T10.5.5.2.m1.1.1" xref="S7.T10.5.5.2.m1.1.1.cmml"><mn id="S7.T10.5.5.2.m1.1.1.2" mathsize="90%" xref="S7.T10.5.5.2.m1.1.1.2.cmml">5</mn><mo id="S7.T10.5.5.2.m1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S7.T10.5.5.2.m1.1.1.1.cmml">×</mo><msup id="S7.T10.5.5.2.m1.1.1.3" xref="S7.T10.5.5.2.m1.1.1.3.cmml"><mn id="S7.T10.5.5.2.m1.1.1.3.2" mathsize="90%" xref="S7.T10.5.5.2.m1.1.1.3.2.cmml">10</mn><mrow id="S7.T10.5.5.2.m1.1.1.3.3" xref="S7.T10.5.5.2.m1.1.1.3.3.cmml"><mo id="S7.T10.5.5.2.m1.1.1.3.3a" mathsize="90%" xref="S7.T10.5.5.2.m1.1.1.3.3.cmml">−</mo><mn id="S7.T10.5.5.2.m1.1.1.3.3.2" mathsize="90%" xref="S7.T10.5.5.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.T10.5.5.2.m1.1b"><apply id="S7.T10.5.5.2.m1.1.1.cmml" xref="S7.T10.5.5.2.m1.1.1"><times id="S7.T10.5.5.2.m1.1.1.1.cmml" xref="S7.T10.5.5.2.m1.1.1.1"></times><cn id="S7.T10.5.5.2.m1.1.1.2.cmml" type="integer" xref="S7.T10.5.5.2.m1.1.1.2">5</cn><apply id="S7.T10.5.5.2.m1.1.1.3.cmml" xref="S7.T10.5.5.2.m1.1.1.3"><csymbol cd="ambiguous" id="S7.T10.5.5.2.m1.1.1.3.1.cmml" xref="S7.T10.5.5.2.m1.1.1.3">superscript</csymbol><cn id="S7.T10.5.5.2.m1.1.1.3.2.cmml" type="integer" xref="S7.T10.5.5.2.m1.1.1.3.2">10</cn><apply id="S7.T10.5.5.2.m1.1.1.3.3.cmml" xref="S7.T10.5.5.2.m1.1.1.3.3"><minus id="S7.T10.5.5.2.m1.1.1.3.3.1.cmml" xref="S7.T10.5.5.2.m1.1.1.3.3"></minus><cn id="S7.T10.5.5.2.m1.1.1.3.3.2.cmml" type="integer" xref="S7.T10.5.5.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T10.5.5.2.m1.1c">5\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S7.T10.5.5.2.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.6.3"><math alttext="5\times 10^{-2}" class="ltx_Math" display="inline" id="S7.T10.6.6.3.m1.1"><semantics id="S7.T10.6.6.3.m1.1a"><mrow id="S7.T10.6.6.3.m1.1.1" xref="S7.T10.6.6.3.m1.1.1.cmml"><mn id="S7.T10.6.6.3.m1.1.1.2" mathsize="90%" xref="S7.T10.6.6.3.m1.1.1.2.cmml">5</mn><mo id="S7.T10.6.6.3.m1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S7.T10.6.6.3.m1.1.1.1.cmml">×</mo><msup id="S7.T10.6.6.3.m1.1.1.3" xref="S7.T10.6.6.3.m1.1.1.3.cmml"><mn id="S7.T10.6.6.3.m1.1.1.3.2" mathsize="90%" xref="S7.T10.6.6.3.m1.1.1.3.2.cmml">10</mn><mrow id="S7.T10.6.6.3.m1.1.1.3.3" xref="S7.T10.6.6.3.m1.1.1.3.3.cmml"><mo id="S7.T10.6.6.3.m1.1.1.3.3a" mathsize="90%" xref="S7.T10.6.6.3.m1.1.1.3.3.cmml">−</mo><mn id="S7.T10.6.6.3.m1.1.1.3.3.2" mathsize="90%" xref="S7.T10.6.6.3.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S7.T10.6.6.3.m1.1b"><apply id="S7.T10.6.6.3.m1.1.1.cmml" xref="S7.T10.6.6.3.m1.1.1"><times id="S7.T10.6.6.3.m1.1.1.1.cmml" xref="S7.T10.6.6.3.m1.1.1.1"></times><cn id="S7.T10.6.6.3.m1.1.1.2.cmml" type="integer" xref="S7.T10.6.6.3.m1.1.1.2">5</cn><apply id="S7.T10.6.6.3.m1.1.1.3.cmml" xref="S7.T10.6.6.3.m1.1.1.3"><csymbol cd="ambiguous" id="S7.T10.6.6.3.m1.1.1.3.1.cmml" xref="S7.T10.6.6.3.m1.1.1.3">superscript</csymbol><cn id="S7.T10.6.6.3.m1.1.1.3.2.cmml" type="integer" xref="S7.T10.6.6.3.m1.1.1.3.2">10</cn><apply id="S7.T10.6.6.3.m1.1.1.3.3.cmml" xref="S7.T10.6.6.3.m1.1.1.3.3"><minus id="S7.T10.6.6.3.m1.1.1.3.3.1.cmml" xref="S7.T10.6.6.3.m1.1.1.3.3"></minus><cn id="S7.T10.6.6.3.m1.1.1.3.3.2.cmml" type="integer" xref="S7.T10.6.6.3.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T10.6.6.3.m1.1c">5\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S7.T10.6.6.3.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.12.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.12.6.1"><span class="ltx_text" id="S7.T10.6.12.6.1.1" style="font-size:90%;">Warmup epochs</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.12.6.2"><span class="ltx_text" id="S7.T10.6.12.6.2.1" style="font-size:90%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.12.6.3"><span class="ltx_text" id="S7.T10.6.12.6.3.1" style="font-size:90%;">20</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.12.6.4"><span class="ltx_text" id="S7.T10.6.12.6.4.1" style="font-size:90%;">20</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.13.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.13.7.1"><span class="ltx_text" id="S7.T10.6.13.7.1.1" style="font-size:90%;">Epochs</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.13.7.2"><span class="ltx_text" id="S7.T10.6.13.7.2.1" style="font-size:90%;">300</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.13.7.3"><span class="ltx_text" id="S7.T10.6.13.7.3.1" style="font-size:90%;">300</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.13.7.4"><span class="ltx_text" id="S7.T10.6.13.7.4.1" style="font-size:90%;">300</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.14.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T10.6.14.8.1"><span class="ltx_text" id="S7.T10.6.14.8.1.1" style="font-size:90%;">Horizontal flip</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.14.8.2"><span class="ltx_text" id="S7.T10.6.14.8.2.1" style="font-size:90%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.14.8.3"><span class="ltx_text" id="S7.T10.6.14.8.3.1" style="font-size:90%;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.14.8.4"><span class="ltx_text" id="S7.T10.6.14.8.4.1" style="font-size:90%;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.15.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.15.9.1"><span class="ltx_text" id="S7.T10.6.15.9.1.1" style="font-size:90%;">Random resize</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.15.9.2"><span class="ltx_text" id="S7.T10.6.15.9.2.1" style="font-size:90%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.15.9.3"><span class="ltx_text" id="S7.T10.6.15.9.3.1" style="font-size:90%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.15.9.4"><span class="ltx_text" id="S7.T10.6.15.9.4.1" style="font-size:90%;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.16.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.16.10.1"><span class="ltx_text" id="S7.T10.6.16.10.1.1" style="font-size:90%;">AutoAugment</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.16.10.2"><span class="ltx_text" id="S7.T10.6.16.10.2.1" style="font-size:90%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.16.10.3"><span class="ltx_text" id="S7.T10.6.16.10.3.1" style="font-size:90%;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.16.10.4"><span class="ltx_text" id="S7.T10.6.16.10.4.1" style="font-size:90%;">✓</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.17.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.17.11.1"><span class="ltx_text" id="S7.T10.6.17.11.1.1" style="font-size:90%;">Mixup alpha</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.17.11.2"><span class="ltx_text" id="S7.T10.6.17.11.2.1" style="font-size:90%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.17.11.3"><span class="ltx_text" id="S7.T10.6.17.11.3.1" style="font-size:90%;">0.8</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.17.11.4"><span class="ltx_text" id="S7.T10.6.17.11.4.1" style="font-size:90%;">0.8</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.18.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.18.12.1"><span class="ltx_text" id="S7.T10.6.18.12.1.1" style="font-size:90%;">Cutmix alpha</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.18.12.2"><span class="ltx_text" id="S7.T10.6.18.12.2.1" style="font-size:90%;">1.0</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.18.12.3"><span class="ltx_text" id="S7.T10.6.18.12.3.1" style="font-size:90%;">1.0</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.18.12.4"><span class="ltx_text" id="S7.T10.6.18.12.4.1" style="font-size:90%;">1.0</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.19.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.19.13.1"><span class="ltx_text" id="S7.T10.6.19.13.1.1" style="font-size:90%;">Random erasing prob.</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.19.13.2"><span class="ltx_text" id="S7.T10.6.19.13.2.1" style="font-size:90%;">0.25</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.19.13.3"><span class="ltx_text" id="S7.T10.6.19.13.3.1" style="font-size:90%;">0.25</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.19.13.4"><span class="ltx_text" id="S7.T10.6.19.13.4.1" style="font-size:90%;">0.25</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.20.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.20.14.1"><span class="ltx_text" id="S7.T10.6.20.14.1.1" style="font-size:90%;">Color jitter</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.20.14.2"><span class="ltx_text" id="S7.T10.6.20.14.2.1" style="font-size:90%;">0.4</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.20.14.3"><span class="ltx_text" id="S7.T10.6.20.14.3.1" style="font-size:90%;">0.4</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.20.14.4"><span class="ltx_text" id="S7.T10.6.20.14.4.1" style="font-size:90%;">0.4</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.21.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T10.6.21.15.1"><span class="ltx_text" id="S7.T10.6.21.15.1.1" style="font-size:90%;">Label smoothing</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.21.15.2"><span class="ltx_text" id="S7.T10.6.21.15.2.1" style="font-size:90%;">0.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.21.15.3"><span class="ltx_text" id="S7.T10.6.21.15.3.1" style="font-size:90%;">0.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T10.6.21.15.4"><span class="ltx_text" id="S7.T10.6.21.15.4.1" style="font-size:90%;">0.1</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.22.16">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T10.6.22.16.1"><span class="ltx_text" id="S7.T10.6.22.16.1.1" style="font-size:90%;">Droppath rate</span></th>
<td class="ltx_td ltx_align_center" id="S7.T10.6.22.16.2"><span class="ltx_text" id="S7.T10.6.22.16.2.1" style="font-size:90%;">0.</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.22.16.3"><span class="ltx_text" id="S7.T10.6.22.16.3.1" style="font-size:90%;">0.2</span></td>
<td class="ltx_td ltx_align_center" id="S7.T10.6.22.16.4"><span class="ltx_text" id="S7.T10.6.22.16.4.1" style="font-size:90%;">0.4</span></td>
</tr>
<tr class="ltx_tr" id="S7.T10.6.23.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S7.T10.6.23.17.1"><span class="ltx_text" id="S7.T10.6.23.17.1.1" style="font-size:90%;">Grad. clipping</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S7.T10.6.23.17.2"><span class="ltx_text" id="S7.T10.6.23.17.2.1" style="font-size:90%;">5.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S7.T10.6.23.17.3"><span class="ltx_text" id="S7.T10.6.23.17.3.1" style="font-size:90%;">5.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S7.T10.6.23.17.4"><span class="ltx_text" id="S7.T10.6.23.17.4.1" style="font-size:90%;">5.0</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 10: </span>Image Classification Training Settings</figcaption>
</figure>
<section class="ltx_subsubsection" id="S7.SS6.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.6.1 </span>Image classification on ImageNet-1K</h4>
<div class="ltx_para" id="S7.SS6.SSS1.p1">
<p class="ltx_p" id="S7.SS6.SSS1.p1.1">As introduced in the main paper, each model was trained for 300 epochs on 8 V100 GPU with an input size of <math alttext="224\times 224" class="ltx_Math" display="inline" id="S7.SS6.SSS1.p1.1.m1.1"><semantics id="S7.SS6.SSS1.p1.1.m1.1a"><mrow id="S7.SS6.SSS1.p1.1.m1.1.1" xref="S7.SS6.SSS1.p1.1.m1.1.1.cmml"><mn id="S7.SS6.SSS1.p1.1.m1.1.1.2" xref="S7.SS6.SSS1.p1.1.m1.1.1.2.cmml">224</mn><mo id="S7.SS6.SSS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S7.SS6.SSS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S7.SS6.SSS1.p1.1.m1.1.1.3" xref="S7.SS6.SSS1.p1.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS6.SSS1.p1.1.m1.1b"><apply id="S7.SS6.SSS1.p1.1.m1.1.1.cmml" xref="S7.SS6.SSS1.p1.1.m1.1.1"><times id="S7.SS6.SSS1.p1.1.m1.1.1.1.cmml" xref="S7.SS6.SSS1.p1.1.m1.1.1.1"></times><cn id="S7.SS6.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S7.SS6.SSS1.p1.1.m1.1.1.2">224</cn><cn id="S7.SS6.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S7.SS6.SSS1.p1.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS6.SSS1.p1.1.m1.1c">224\times 224</annotation><annotation encoding="application/x-llamapun" id="S7.SS6.SSS1.p1.1.m1.1d">224 × 224</annotation></semantics></math>. The experimental settings are strictly follow the DeiT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib39" title="">39</a>]</cite> for a fair comparison. For more details, please refer to the Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.T10" title="Table 10 ‣ 7.6 Detailed Experimental Settings ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">10</span></a> provided.</p>
</div>
<figure class="ltx_table" id="S7.T11">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T11.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T11.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T11.1.1.1.1"><span class="ltx_text" id="S7.T11.1.1.1.1.1" style="font-size:90%;">Config</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T11.1.1.1.2"><span class="ltx_text" id="S7.T11.1.1.1.2.1" style="font-size:90%;">Value</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S7.T11.1.2.2.1"><span class="ltx_text" id="S7.T11.1.2.2.1.1" style="font-size:90%;">Optimizer</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T11.1.2.2.2"><span class="ltx_text" id="S7.T11.1.2.2.2.1" style="font-size:90%;">AdamW</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T11.1.3.3.1"><span class="ltx_text" id="S7.T11.1.3.3.1.1" style="font-size:90%;">LR</span></th>
<td class="ltx_td ltx_align_center" id="S7.T11.1.3.3.2"><span class="ltx_text" id="S7.T11.1.3.3.2.1" style="font-size:90%;">0.0002</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T11.1.4.4.1"><span class="ltx_text" id="S7.T11.1.4.4.1.1" style="font-size:90%;">weight decay</span></th>
<td class="ltx_td ltx_align_center" id="S7.T11.1.4.4.2"><span class="ltx_text" id="S7.T11.1.4.4.2.1" style="font-size:90%;">0.05</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T11.1.5.5.1"><span class="ltx_text" id="S7.T11.1.5.5.1.1" style="font-size:90%;">batch size</span></th>
<td class="ltx_td ltx_align_center" id="S7.T11.1.5.5.2"><span class="ltx_text ltx_font_bold" id="S7.T11.1.5.5.2.1" style="font-size:90%;">4</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T11.1.6.6.1"><span class="ltx_text" id="S7.T11.1.6.6.1.1" style="font-size:90%;">LR schedule</span></th>
<td class="ltx_td ltx_align_center" id="S7.T11.1.6.6.2"><span class="ltx_text" id="S7.T11.1.6.6.2.1" style="font-size:90%;">steps:[8, 11]</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T11.1.7.7.1"><span class="ltx_text" id="S7.T11.1.7.7.1.1" style="font-size:90%;">training</span></th>
<td class="ltx_td ltx_align_center" id="S7.T11.1.7.7.2"><span class="ltx_text" id="S7.T11.1.7.7.2.1" style="font-size:90%;">epochs 12</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S7.T11.1.8.8.1"><span class="ltx_text" id="S7.T11.1.8.8.1.1" style="font-size:90%;">scales</span></th>
<td class="ltx_td ltx_align_center" id="S7.T11.1.8.8.2"><span class="ltx_text" id="S7.T11.1.8.8.2.1" style="font-size:90%;">(800, 1333)</span></td>
</tr>
<tr class="ltx_tr" id="S7.T11.1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S7.T11.1.9.9.1"><span class="ltx_text" id="S7.T11.1.9.9.1.1" style="font-size:90%;">drop path</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S7.T11.1.9.9.2"><span class="ltx_text" id="S7.T11.1.9.9.2.1" style="font-size:90%;">0.2 (Small), 0.3 (Base)</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 11: </span> Object Detection and Instance Segmentation Training Settings</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S7.SS6.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.6.2 </span>Object Detection and Instance Segmentation</h4>
<div class="ltx_para" id="S7.SS6.SSS2.p1">
<p class="ltx_p" id="S7.SS6.SSS2.p1.1">When fine-tuning our DeBiFormer to object detection and instance segmentation on COCO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib17" title="">17</a>]</cite>, we have considered two common frameworks: Mask R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib19" title="">19</a>]</cite>, RetinaNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#bib.bib16" title="">16</a>]</cite>. For optimization, we adopt the AdamW optimizer with an initial learning rate of 0.0002 and a <span class="ltx_text ltx_font_bold" id="S7.SS6.SSS2.p1.1.1">mini batch size of 4</span> due to the limitation of devices. When training models of different sizes, we adjust the training settings according to the settings used in image classification. The detailed hyper-parameters used in training models are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.T11" title="Table 11 ‣ 7.6.1 Image classification on ImageNet-1K ‣ 7.6 Detailed Experimental Settings ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S7.SS6.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.6.3 </span>Semantic Segmentation</h4>
<div class="ltx_para" id="S7.SS6.SSS3.p1">
<p class="ltx_p" id="S7.SS6.SSS3.p1.1">For ADE20K, we utilized the AdamW optimizer with
an initial learning rate of 0.00006, a weight decay of 0.01, and a mini batch size of 16 for all models trained for 160K iterations. In terms of testing, we reported the results using both single-scale (SS) and multi-scale (MS) testing in the main comparisons. For multi-scale testing, we experimented with resolutions ranging from 0.5 to 1.75 times that of the training resolution. To set the path drop rates in different models, we used the same hyper-parameters as those used for object detection and instance segmentation. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.08582v1#S7.T8" title="Table 8 ‣ 7.3 Computational complexity ‣ 7 Supplementary Material ‣ DeBiFormer: Vision Transformer with Deformable Agent Bi-level Routing Attention"><span class="ltx_text ltx_ref_tag">8</span></a> shows the results of the Upernet frameworks with the single and Multi-Scale IoU.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S7.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.7 </span>Limitation and Future Work</h3>
<div class="ltx_para" id="S7.SS7.p1">
<p class="ltx_p" id="S7.SS7.p1.1">In contrast to sparse attention with simple static patterns, we propose a novel attention method that consists of two components. First, we prune a region-level graph and gather key-value pairs for important regions, which are focused by highly flexible key-value pairs. Then, we apply token-to-token attention. While this method does not incur much computation as it operates at a top-k routed semantically relevant region level and deformable important regions, it inevitably involves additional parameter capacity transactions during linear projection. In our future endeavors, we plan to investigate efficient sparse attention mechanisms and enhance Vision Transformers with parameter capacity awareness.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Carion, N., Massa, F., Synnaeve, G., Usunier, N., Kirillov, A., Zagoruyko, S.: End-to-end object detection with transformers. In: Proceedings of the IEEE/CVF European Conference on Computer Vision (ECCV) (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Chen, C.F., Panda, R., Fan, Q.: Regionvit: Regional-to-local attention for vision transformers. arXiv preprint arXiv:2106.02689 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Chen, K., Wang, J., Pang, J., Cao, Y., Xiong, Y., Li, X., Sun, S., Feng, W., Liu, Z., Xu, J., Zhang, Z., Cheng, D., Zhu, C., Cheng, T., Zhao, Q., Li, B., Lu, X., Zhu, R., Wu, Y., Dai, J., Wang, J., Shi, J., Ouyang, W., Loy, C.C., Lin, D.: MMDetection: Open mmlab detection toolbox and benchmark. arXiv preprint arXiv:1906.07155 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Chen, Q., Wu, Q., Wang, J., Hu, Q., Hu, T., Ding, E., Cheng, J., Wang, J.: Mixformer: Mixing features across windows and dimensions (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Chen, Z., Zhu, Y., Zhao, C., Hu, G., Zeng, W., Wang, J., Tang, M.: Dpt: Deformable patch-based transformer for visual recognition. In: Proceedings of the ACM International Conference on Multimedia (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Child, R., Gray, S., Radford, A., Sutskever, I.: Generating long sequences with sparse transformers. URL https://openai.com/blog/sparse-transformers (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chu, X., Tian, Z., Wang, Y., Zhang, B., Ren, H., Wei, X., Xia, H., Shen, C.: Twins: Revisiting the design of spatial attention in vision transformers. In: NeurIPS 2021 (2021), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=5kTlVBkzSRx" title="">https://openreview.net/forum?id=5kTlVBkzSRx</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Chu, X., Tian, Z., Zhang, B., Wang, X., Shen, C.: Conditional positional encodings for vision transformers. In: ICLR 2023 (2023), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=3KWnuT-R1bh" title="">https://openreview.net/forum?id=3KWnuT-R1bh</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Cubuk, E.D., Zoph, B., Shlens, J., Le, Q.: Randaugment: Practical automated data augmentation with a reduced search space. In: Larochelle, H., Ranzato, M., Hadsell, R., Balcan, M., Lin, H. (eds.) Advances in Neural Information Processing Systems. vol. 33, pp. 18613–18624. Curran Associates, Inc. (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Dai, Z., Yang, Z., Yang, Y., Carbonell, J., Le, Q.V., Salakhutdinov, R.: Transformer-xl: Attentive language models beyond a fixed-length context (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Devlin, J., Chang, M.W., Lee, K., Toutanova, K.: Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Ding, X., Zhang, Y., Ge, Y., Zhao, S., Song, L., Yue, X., Shan, Y.: Unireplknet: A universal perception large-kernel convnet for audio, video, point cloud, time-series and image recognition. arXiv preprint arXiv:2311.15599 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Dong, K., Xue, J., Lan, X., Lu, K.: Biunet: Towards more effective unet with bi-level routing attention. In: The British Machine Vision Conference (November 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Dong, X., Bao, J., Chen, D., Zhang, W., Yu, N., Yuan, L., Chen, D., Guo, B.: Cswin transformer: A general vision transformer backbone with cross-shaped windows. In: Proceedings of the IEEE/CVF Computer Vision and Pattern Recognition Conference (CVPR). pp. 12124–12134 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., Uszkoreit, J., Houlsby, N.: An image is worth 16x16 words: Transformers for image recognition at scale. ICLR (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Girshick, R., Radosavovic, I., Gkioxari, G., Dollár, P., He, K.: Focal loss for dense object detection. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/facebookresearch/detectron" title="">https://github.com/facebookresearch/detectron</a> (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Gupta, A., Dollar, P., Girshick, R.: LVIS: A dataset for large vocabulary instance segmentation. In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Han, D., Ye, T., Han, Y., Xia, Z., Song, S., Huang, G.: Agent attention: On the integration of softmax and linear attention. arXiv preprint arXiv:2312.08874 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
He, K., Gkioxari, G., DollÃ¡r, P., Girshick, R.: Mask r-cnn (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Ho, J., Kalchbrenner, N., Weissenborn, D., Salimans, T.: Axial attention in multidimensional transformers (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Hou, Q., Lu, C.Z., Cheng, M.M., Feng, J.: Conv2former: A simple transformer-style convnet for visual recognition. arXiv preprint arXiv:2211.11943 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Huang, G., Sun, Y., Liu, Z., Sedra, D., Weinberger, K.: Deep networks with stochastic depth (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Jiao, J., Tang, Y.M., Lin, K.Y., Gao, Y., Ma, J., Wang, Y., Zheng, W.S.: Dilateformer: Multi-scale dilated transformer for visual recognition. IEEE Transactions on Multimedia (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Lan, L., Cai, P., Jiang, L., Liu, X., Li, Y., Zhang, Y.: Brau-net++: U-shaped hybrid cnn-transformer network for medical image segmentation. arXiv preprint arXiv:2401.00722 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Li, K., Wang, Y., Gao, P., Song, G., Liu, Y., Li, H., Qiao, Y.: Uniformer: Unified transformer for efficient spatiotemporal representation learning (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Liu, S., Chen, T., Chen, X., Chen, X., Xiao, Q., Wu, B., Pechenizkiy, M., Mocanu, D., Wang, Z.: More convnets in the 2020s: Scaling up kernels beyond 51x51 using sparsity. arXiv preprint arXiv:2207.03620 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Liu, Z., Hu, H., Lin, Y., Yao, Z., Xie, Z., Wei, Y., Ning, J., Cao, Y., Zhang, Z., Dong, L., Wei, F., Guo, B.: Swin transformer v2: Scaling up capacity and resolution. In: International Conference on Computer Vision and Pattern Recognition (CVPR) (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Liu, Z., Lin, Y., Cao, Y., Hu, H., Wei, Y., Zhang, Z., Lin, S., Guo, B.: Swin transformer: Hierarchical vision transformer using shifted windows. In: Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV) (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Liu, Z., Mao, H., Wu, C.Y., Feichtenhofer, C., Darrell, T., Xie, S.: A convnet for the 2020s. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR). pp. 11976–11986 (June 2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Loshchilov, I., Hutter, F.: Decoupled weight decay regularization (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Luo, W., Li, Y., Urtasun, R., Zemel, R.: Understanding the effective receptive field in deep convolutional neural networks. In: Lee, D., Sugiyama, M., Luxburg, U., Guyon, I., Garnett, R. (eds.) Advances in Neural Information Processing Systems. vol. 29. Curran Associates, Inc. (2016), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2016/file/c8067ad1937f728f51288b3eb986afaa-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2016/file/c8067ad1937f728f51288b3eb986afaa-Paper.pdf</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Pan, X., Ye, T., Xia, Z., Song, S., Huang, G.: Slide-transformer: Hierarchical vision transformer with local self-attention. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR). pp. 2082–2091 (June 2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Ren, S., Zhou, D., He, S., Feng, J., Wang, X.: Shunted self-attention via multi-scale token aggregation (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Russakovsky, O., Deng, J., Su, H., Krause, J., Satheesh, S., Ma, S., Huang, Z., Karpathy, A., Khosla, A., Bernstein, M., Berg, A.C., Fei-Fei, L.: ImageNet Large Scale Visual Recognition Challenge. International Journal of Computer Vision (IJCV) <span class="ltx_text ltx_font_bold" id="bib.bib35.1.1">115</span>(3), 211–252 (2015). https://doi.org/10.1007/s11263-015-0816-y

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Selvaraju, R.R., Cogswell, M., Das, A., Vedantam, R., Parikh, D., Batra, D.: Grad-cam: Visual explanations from deep networks via gradient-based localization (2016). https://doi.org/10.1007/s11263-019-01228-7

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Tang, S., Zhang, J., Zhu, S., Tan, P.: Quadtree attention for vision transformers. ICLR (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Tolstikhin, I., Houlsby, N., Kolesnikov, A., Beyer, L., Zhai, X., Unterthiner, T., Yung, J., Steiner, A., Keysers, D., Uszkoreit, J., Lucic, M., Dosovitskiy, A.: Mlp-mixer: An all-mlp architecture for vision. arXiv preprint arXiv:2105.01601 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Touvron, H., Cord, M., Douze, M., Massa, F., Sablayrolles, A., Jegou, H.: Training data-efficient image transformers distillation through attention. In: International Conference on Machine Learning. vol. 139, pp. 10347–10357 (July 2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Tu, Z., Talebi, H., Zhang, H., Yang, F., Milanfar, P., Bovik, A., Li, Y.: Maxvit: Multi-axis vision transformer. ECCV (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A.N., Kaiser, L.u., Polosukhin, I.: Attention is all you need. In: Guyon, I., Von Luxburg, U., Bengio, S., Wallach, H., Fergus, R., Vishwanathan, S., Garnett, R. (eds.) Advances in Neural Information Processing Systems. vol. 30. Curran Associates, Inc. (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Wang, S., Li, B.Z., Khabsa, M., Fang, H., Ma, H.: Linformer: Self-attention with linear complexity (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Wang, W., Dai, J., Chen, Z., Huang, Z., Li, Z., Zhu, X., Hu, X., Lu, T., Lu, L., Li, H., et al.: Internimage: Exploring large-scale vision foundation models with deformable convolutions. arXiv preprint arXiv:2211.05778 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Wang, W., Xie, E., Li, X., Fan, D.P., Song, K., Liang, D., Lu, T., Luo, P., Shao, L.: Pyramid vision transformer: A versatile backbone for dense prediction without convolutions. In: Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV). pp. 568–578 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Wang, W., Yao, L., Chen, L., Lin, B., Cai, D., He, X., Liu, W.: Crossformer: A versatile vision transformer hinging on cross-scale attention. In: Proceedings of the International Conference on Learning Representations (ICLR) (2022), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=_PHymLIxuI" title="">https://openreview.net/forum?id=_PHymLIxuI</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Wu, Y., Kirillov, A., Massa, F., Lo, W.Y., Girshick, R.: Detectron2. <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/facebookresearch/detectron2" title="">https://github.com/facebookresearch/detectron2</a> (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Xia, Z., Pan, X., Song, S., Li, L.E., Huang, G.: Vision transformer with deformable attention. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR). pp. 4794–4803 (June 2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Xiao, T., Liu, Y., Zhou, B., Jiang, Y., Sun, J.: Unified perceptual parsing for scene understanding. In: European Conference on Computer Vision. Springer (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Yang, J., Li, C., Zhang, P., Dai, X., Xiao, B., Yuan, L., Gao, J.: Focal attention for long-range interactions in vision transformers. In: Ranzato, M., Beygelzimer, A., Dauphin, Y., Liang, P., Vaughan, J.W. (eds.) Advances in Neural Information Processing Systems. vol. 34, pp. 30008–30022. Curran Associates, Inc. (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Yang, J., Li, C., Zhang, P., Dai, X., Xiao, B., Yuan, L., Gao, J.: Focal self-attention for local-global interactions in vision transformers (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Yang, R., Ma, H., Wu, J., Tang, Y., Xiao, X., Zheng, M., Li, X.: Scalablevit: Rethinking the context-oriented generalization of vision transformer (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Yun, S., Han, D., Oh, S.J., Chun, S., Choe, J., Yoo, Y.: Cutmix: Regularization strategy to train strong classifiers with localizable features. In: International Conference on Computer Vision (ICCV) (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Zeng, W., Jin, S., Liu, W., Qian, C., Luo, P., Ouyang, W., Wang, X.: Not all tokens are equal: Human-centric visual analysis via token clustering transformer. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 11101–11111 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Zhang, H., Cisse, M., Dauphin, Y.N., Lopez-Paz, D.: mixup: Beyond empirical risk minimization. International Conference on Learning Representations (2018), <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=r1Ddp1-Rb" title="">https://openreview.net/forum?id=r1Ddp1-Rb</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Zhou, B., Zhao, H., Puig, X., Xiao, T., Fidler, S., Barriuso, A., Torralba, A.: Semantic understanding of scenes through the ade20k dataset. International Journal of Computer Vision <span class="ltx_text ltx_font_bold" id="bib.bib55.1.1">127</span>(3), 302–321 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Zhu, L., Wang, X., Ke, Z., Zhang, W., Lau, R.: Biformer: Vision transformer with bi-level routing attention. Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) (2023)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct 11 07:15:58 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
