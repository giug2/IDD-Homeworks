<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning</title>
<!--Generated on Thu Jun 20 09:56:28 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommendation System,  Novelty,  Large Language Models,  Reinforcement Learning" lang="en" name="keywords"/>
<base href="/html/2406.14169v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S1" title="In Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S2" title="In Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S2.SS1" title="In 2. Related Work ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Enhancing novelty of top-k results.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S2.SS2" title="In 2. Related Work ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>RL with large action spaces.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S2.SS3" title="In 2. Related Work ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>LLMs for information retrieval.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3" title="In Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Optimizing novelty W/ LLM FEEDBACK</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.SS1" title="In 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem statement: Novelty optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.SS2" title="In 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>RL formulation using policy gradient</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.SS3" title="In 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>LLMs make novelty optimization practical</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.SS4" title="In 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>The challenge with large action spaces</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4" title="In Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Large Action Policy Gradient</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.SS1" title="In 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Reduction from Top-k to item-wise rewards</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.SS2" title="In 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Reduction to binary action space</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.SS3" title="In 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Proposed algorithm: PG-Ret</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5" title="In Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.SS1" title="In 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Setup: Datasets, Metrics, and Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.SS2" title="In 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Query-keyword recommendation task</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.SS2.SSS0.Px1" title="In 5.2. Query-keyword recommendation task ‣ 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title">Novelty.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.SS2.SSS0.Px2" title="In 5.2. Query-keyword recommendation task ‣ 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title">A/B test.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.SS3" title="In 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>ORCAS: Query-webpage matching</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.SS4" title="In 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Amazon: User-Product recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S6" title="In Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#A1" title="In Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix: Proof of Propositions</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#A1.SS1" title="In Appendix A Appendix: Proof of Propositions ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Proposition 1</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#A1.SS2" title="In Appendix A Appendix: Proof of Propositions ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Proposition 2</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">
Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Amit Sharma
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Microsoft Research</span><span class="ltx_text ltx_affiliation_city" id="id4.2.id2">Bengaluru</span><span class="ltx_text ltx_affiliation_country" id="id5.3.id3">India</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:amshar@microsoft.com">amshar@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hua Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id6.1.id1">Microsoft Bing Ads</span><span class="ltx_text ltx_affiliation_city" id="id7.2.id2">Redmond</span><span class="ltx_text ltx_affiliation_country" id="id8.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:huli@microsoft.com">huli@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xue Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Microsoft Bing Ads</span><span class="ltx_text ltx_affiliation_city" id="id10.2.id2">Mountain View</span><span class="ltx_text ltx_affiliation_country" id="id11.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xeli@microsoft.com">xeli@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jian Jiao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id12.1.id1">Microsoft Bing Ads</span><span class="ltx_text ltx_affiliation_city" id="id13.2.id2">Redmond</span><span class="ltx_text ltx_affiliation_country" id="id14.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jiajia@microsoft.com">jiajia@microsoft.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id2.2">Given an input query, a recommendation model is trained using user feedback data (e.g., click data) to output a ranked list of items. In real-world systems, besides accuracy, an important consideration for a new model is novelty of its top-k recommendations w.r.t. an existing deployed model. However, novelty of top-k items is a difficult goal to optimize a model for, since it involves a non-differentiable sorting operation on the model’s predictions. Moreover, novel items, by definition, do not have any user feedback data. Given the semantic capabilities of large language models, we address these problems using a reinforcement learning (RL) formulation where large language models provide feedback for the novel items. However, given millions of candidate items, the sample complexity of a standard RL algorithm can be prohibitively high. To reduce sample complexity, we reduce the top-k list reward to a set of item-wise rewards and reformulate the state space to consist of <math alttext="\langle" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" stretchy="false" xref="id1.1.m1.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><ci id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">⟨</annotation></semantics></math>query, item<math alttext="\rangle" class="ltx_Math" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><mo id="id2.2.m2.1.1" stretchy="false" xref="id2.2.m2.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><ci id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">⟩</annotation></semantics></math> tuples such that the action space is reduced to a binary decision; and show that this reformulation results in a significantly lower complexity when the number of items is large. We evaluate the proposed algorithm on improving novelty for a query-ad recommendation task on a large-scale search engine. Compared to supervised finetuning on recent &lt;query, ad&gt;pairs, the proposed RL-based algorithm leads to significant novelty gains with minimal loss in recall. We obtain similar results on the ORCAS query-webpage matching dataset and a product recommendation dataset based on Amazon reviews.</p>
</div>
<div class="ltx_keywords">Recommendation System, Novelty, Large Language Models, Reinforcement Learning
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining; August 25–29, 2024; Barcelona, Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’24), August 25–29, 2024, Barcelona,
Spain</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3637528.3671618</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0490-1/24/08</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Novelty in information retrieval</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Online advertising</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Given a user’s profile or an input query, the recommendation problem is to fetch a ranked list of top-k items based on a task-specific goal. We consider the retrieval layer of a recommendation system, where the input is typically millions of candidate items and output is hundreds of ranked items (e.g., k=<math alttext="200" class="ltx_Math" display="inline" id="S1.p1.1.m1.1"><semantics id="S1.p1.1.m1.1a"><mn id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><cn id="S1.p1.1.m1.1.1.cmml" type="integer" xref="S1.p1.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">200</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.1d">200</annotation></semantics></math>). For the retrieval layer, semantic relevance is a common goal and models are trained to rank relevant items higher <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib10" title="">2022</a>)</cite>. A common way to train such recommendation models is to use supervised learning on user feedback data such as clicks, using losses such as contrastive learning that encourage representations of clicked query-item pairs to be closer to each other than negative (or random) query-item pairs <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib9" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, in addition to relevance, real-world recommendation systems typically have additional goals to optimize for the predicted top-k items. For instance, an important goal is that a candidate model predicts top-k items that are <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">novel</span> w.r.t. the existing deployed models in the system <cite class="ltx_cite ltx_citemacro_citep">(Kaminskas and Bridge, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib16" title="">2016</a>)</cite>. Novelty is a desirable property since it can avoid showing repetitive or redundant items to a user, enhance global coverage over all available items, and help avoid any systematic bias towards previously clicked items in the system <cite class="ltx_cite ltx_citemacro_citep">(Herlocker et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib12" title="">2004</a>)</cite>. However, it is difficult to train a model to optimize novelty of top-k items since evaluating novelty requires a non-differentiable sorting operation to obtain the top-k list. Moreover, novel items, by definition, do not have any user feedback data corresponding to the particular query. As a result, getting relevance feedback on novel items requires conducting an online experiment showing exploratory, novel items to the user, which can be a costly and infeasible procedure for many systems.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S1.F1.1.g1" src="extracted/5680478/figures/pg-ret.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Our goal is to optimize retrieval models for novelty. <span class="ltx_text ltx_font_italic" id="S1.F1.6.1">Left:</span> Supervised learning with a contrastive loss is unable to optimize novelty directly since it involves a non-differentiable top-k sorting operation. <span class="ltx_text ltx_font_italic" id="S1.F1.7.2">Right:</span> the proposed RL approach with explicit optimization for the novelty of top-<math alttext="k" class="ltx_Math" display="inline" id="S1.F1.3.m1.1"><semantics id="S1.F1.3.m1.1b"><mi id="S1.F1.3.m1.1.1" xref="S1.F1.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.F1.3.m1.1c"><ci id="S1.F1.3.m1.1.1.cmml" xref="S1.F1.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S1.F1.3.m1.1e">italic_k</annotation></semantics></math> retrieved items (w.r.t. to a base model) using LLM-based relevance feedback. </figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To obtain scalable feedback for novel items, we utilize recent results that show that large language models (LLMs) like GPT-3.5 or GPT-4 can match or surpass quality of crowd-sourced relevance feedback for recommendation tasks, such as matching user input to ad keywords <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib11" title="">2023</a>)</cite> or matching user history to suggested movies and games <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib13" title="">2024</a>)</cite>. Specifically, we propose that LLMs can be used as <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">reward models</span> to provide relevance feedback for novel items, using an appropriate task-specific prompt. As a result, (noisy) relevance feedback for novel items can be obtained at scale and be used for both offline model training and evaluation, with human feedback restricted to only evaluating the final model in an A/B test.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">For handling non-differentiability of the novelty metric, we consider a reinforcement learning (RL) formulation, as in past work on optimizing metrics such as diversity <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib21" title="">2021</a>)</cite> and popularity <cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib33" title="">2023</a>; Stamenkovic et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib34" title="">2022</a>)</cite> of top-k predicted items. Specifically, the retrieval problem can be framed as a one-step RL problem where the input query is the state, the top-k predicted items constitute the action, and their relevance and novelty constitute the environment reward. However, the large action space in retrieval tasks—equal to the number of available items that can be predicted for an input query (typically millions)—presents a challenge due to the data requirements for RL algorithms. While we use a policy gradient RL algorithm that does not explicitly parameterize the action space and hence is better suited for large action spaces, the finite sample convergence results of policy gradient algorithms <cite class="ltx_cite ltx_citemacro_citep">(Mei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib24" title="">2020</a>)</cite> show a direct dependence of policy error on the square of the action space size. Consequently, the resultant algorithms are reported to not work well beyond tens of items <cite class="ltx_cite ltx_citemacro_citep">(Lu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib23" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address the issue of optimizing over large action spaces, we make two contributions. First, rather than the standard practice of training RL algorithms from scratch for recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib33" title="">2023</a>; Stamenkovic et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib34" title="">2022</a>; Keat et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib17" title="">2022</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib39" title="">2021</a>)</cite>, we argue that it is more practical to consider RL as a tool to <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">finetune</span> an existing supervised learning model that has been trained on user feedback data. Such an approach has led to substantial gains in training image <cite class="ltx_cite ltx_citemacro_citep">(Pinto et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib29" title="">2023</a>)</cite> and language <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib27" title="">2022</a>)</cite> models and we extend it for recommendation systems. We also provide a formal justification for this line of work: assuming that the existing model has a higher probability of selecting the optimal action (item) for a query than a uniformly random policy, we show that initializing from an existing model reduces the sample complexity requirements for a policy gradient algorithm.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Second, we propose a reformulation of the problem that further reduces the sample complexity. Rather than considering a query as the state, we consider the (query, item) pair as a state. As a result, the action space is converted to a binary space: whether the item is preferred by the task-specific goal (e.g., relevance and novelty) or not. Theoretically, our formulation reduces the dependence of convergence error from quadratic to linear in the action space, which is a substantial reduction whenever the action space is large. Crucially, even though the action space is binary given a query-item pair, policy optimization can use rewards based on the top-<math alttext="k" class="ltx_Math" display="inline" id="S1.p6.1.m1.1"><semantics id="S1.p6.1.m1.1a"><mi id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.m1.1d">italic_k</annotation></semantics></math> retrieved list from the current policy, which was not possible in supervised learning. At the same time, the reduction leads to an empirical advantage: we can develop a scalable, batch-wise training algorithm for optimizing the policy using loss functions that are well-suited for large-scale recommendation, such as those based on contrastive learning. We call the resultant algorithm, <span class="ltx_text ltx_font_italic" id="S1.p6.1.1">PG-Ret</span>, Policy Gradient for large-scale Retrieval.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We evaluate PG-Ret on three datasets: a proprietary dataset for query-ad recommendation task, a public dataset for query-webpage matching task, and a product recommendation dataset based on Amazon reviews. In the first dataset, the task is produce top-k items that are novel compared to a given production model on a commercial search engine. The training data consists of recently collected &lt;query, ad&gt;pairs from the search engine’s logs and has 33M actions. We find that PG-Ret leads to significant improvement (2X-5X) in novelty of top-k retrieved items compared to a supervised model trained on the same training data, while incurring minimal drop in precision and recall. Online A/B test shows a statistically significant gain of 1% in retrieval density, the average number of relevant ad keywords fetched per query. The second dataset is a public dataset, ORCAS, for matching queries to webpage titles. We obtain a similar result: PG-Ret leads to over 2X improvement in novelty for the top-20 items while incurring a small drop in recall and precision. Finally, PG-Ret can also be applied to general recommendation scenarios beyond query-based tasks. We apply it to an Amazon user-product recommendation task and find significant gains in novelty compared to supervised finetuning.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">To summarize, we propose a technique based on the policy gradient algorithm that is simple to implement (see Algorithm 1) and shows the benefit of finetuning existing models with RL for task-specific goals such as novelty. Our contributions include,</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">A simple, model-agnostic algorithm to finetune retrieval models that works for large action spaces (millions of actions) and arbitrary task-specific goals.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Leveraging relevance feedback from LLMs; thus allowing for optimization of novel items directly since novel items, by definition, do not have user feedback data.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Theoretical and empirical justification of the method for increasing novelty in recommendation systems, including evaluation of the method for predicting ad keywords on a commercial search engine.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Enhancing novelty of top-k results.</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Outputting novel items compared to existing algorithms is an important goal for recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Shani and Gunawardana, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib32" title="">2011</a>)</cite>. A common approach is to consider a multi-objective optimization problem <cite class="ltx_cite ltx_citemacro_citep">(Rodriguez et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib30" title="">2012</a>)</cite> with relevance and novelty as the two objectives <cite class="ltx_cite ltx_citemacro_citep">(Hurley and Zhang, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib15" title="">2011</a>; Díez et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib7" title="">2019</a>)</cite>. Recently, reinforcement learning has been used for novelty optimization since RL can be applied to non-differentiable objectives like novelty <cite class="ltx_cite ltx_citemacro_citep">(Stamenkovic et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib34" title="">2022</a>; Keat et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib17" title="">2022</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib39" title="">2021</a>)</cite>. However, past work uses approximations of novelty, such as an item being less popular <cite class="ltx_cite ltx_citemacro_citep">(Stamenkovic et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib34" title="">2022</a>; Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib33" title="">2023</a>; Vargas and Castells, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib35" title="">2011</a>)</cite> or belonging to less popular categories <cite class="ltx_cite ltx_citemacro_citep">(Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib39" title="">2021</a>)</cite>, to enhance novelty, since truly novel items—those that have not been shown by the current system—would not have any user feedback data for training. To ascertain relevance of truly novel items, heuristics like estimating the curiosity of a user (more curiosity admits more novel items as relevant) have been proposed <cite class="ltx_cite ltx_citemacro_citep">(Zhao and Lee, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib41" title="">2016</a>)</cite>, but no systematic way to estimate relevance exists. Consequently, without relevance feedback, there exists a direct tradeoff between optimizing novelty and relevance of a top-k list. In this work, we use the semantic capabilities of LLMs to propose a general, scalable method to estimate relevance of novel items. As a result, we can directly optimize for the novelty objective without sacrificing relevance.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Note that encouraging novelty in top-k items is different from addressing the cold-start problem <cite class="ltx_cite ltx_citemacro_citep">(Sanner et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib31" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib38" title="">2024</a>)</cite>. Novel items are defined wrt. a query whereas cold-start items are defined globally for a system. In many cases, a novel item wrt. a query may be a popular item globally. As a result, methods for the cold-start problem may not directly apply to novelty optimization.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>RL with large action spaces.</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Given a query, information retrieval can be divided into two stages <cite class="ltx_cite ltx_citemacro_citep">(Hron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib14" title="">2021</a>)</cite>; 1) retrieval of relevant items from a large candidate pool of items; 2) ranking the retrieved items to select a smaller set of items that are shown to the user. RL algorithms find many applications in the ranking phase, including contextual bandits <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib20" title="">2010</a>)</cite>, markov decision processes <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib36" title="">2017</a>)</cite>, and policy gradient algorithms <cite class="ltx_cite ltx_citemacro_citep">(Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib28" title="">2019</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib40" title="">2020</a>)</cite>. Many of these algorithms introduce a task-specific loss to the ranking problem. However, applying these techniques to the retrieval phase is challenging because of the large number of candidate items (actions).</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Large action spaces is a general challenge for RL beyond retrieval models <cite class="ltx_cite ltx_citemacro_citep">(Dulac-Arnold et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib8" title="">2015</a>)</cite>, even when using policy gradient, a method that does not explicitly parameterize the action space and thus is better suited for higher number of actions. For sequential recommendation problems, appropriately parameterizing the policy and using off-policy correction helps in scaling to large actions <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib3" title="">2019</a>)</cite>. For one-step RL problems, recent theoretical work in contextual bandits <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib42" title="">2022</a>; Lopez et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib22" title="">2021</a>)</cite> tries to address the large actions problem. However, the focus of these approaches is on obtaining an optimal solution from scratch, which may be difficult in practice and misses the complementary benefits of supervised learning over user feedback. Instead, we finetune an existing supervised model, as done by <cite class="ltx_cite ltx_citemacro_citep">(Pinto et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib29" title="">2023</a>)</cite> for computer vision models.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>LLMs for information retrieval.</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Recently, LLMs like GPT-3.5 have been applied to retrieval tasks in a zero-shot setting with encouraging results <cite class="ltx_cite ltx_citemacro_citep">(Dai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib6" title="">2022</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib13" title="">2024</a>; Arora et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib2" title="">2023</a>)</cite>. Instead of using compute-intensive LLMs directly for the retrieval task, here we aim to use LLMs as reward models to train an efficient, small retrieval model.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Optimizing novelty W/ LLM FEEDBACK</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Problem statement: Novelty optimization</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">Commonly used retrieval models use a bi-encoder architecture <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib9" title="">2021</a>)</cite>, where the same neural network model embeds a query and item into a common representation space. The top-k items are selected based on the nearest neighbors to a query, as measured by a suitable distance function over the embeddings (e.g., cosine similarity). The encoder <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_ϕ</annotation></semantics></math> is typically optimized using a variant of contrastive learning, encouraging that positive <math alttext="&lt;" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mo id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><lt id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">&lt;</annotation></semantics></math>query,item<math alttext="&gt;" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mo id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><gt id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">&gt;</annotation></semantics></math> pairs in the training set should be closer in embedding space than non-positive pairs. Non-positive pairs may be random pairs <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib9" title="">2021</a>)</cite> or mined from train data<cite class="ltx_cite ltx_citemacro_citep">(Dahiya et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib5" title="">2021</a>)</cite>. Thus, given a set of queries <math alttext="X" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_X</annotation></semantics></math> and items <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_Z</annotation></semantics></math>, a train dataset <math alttext="D\sim\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">D</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1">similar-to</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐷</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">D\sim\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_D ∼ caligraphic_D</annotation></semantics></math> with positive query-item pairs, and a similarity function <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p1.8.1">sim</span>, the trained retriever <math alttext="\hat{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mover accent="true" id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">ϕ</mi><mo id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><ci id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1">^</ci><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\hat{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">over^ start_ARG italic_ϕ end_ARG</annotation></semantics></math> can be written as (using the InfoNCE contrastive loss function <cite class="ltx_cite ltx_citemacro_citep">(Oord et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib26" title="">2018</a>)</cite>),</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\phi}" class="ltx_Math" display="inline" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mover accent="true" id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">ϕ</mi><mo id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><ci id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1">^</ci><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\hat{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">over^ start_ARG italic_ϕ end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\arg\min_{\phi}-\log\sum_{(x,z)\in\mathcal{D}}\frac{\exp(\texttt%
{sim}(\phi(x),\phi(z)))}{\sum_{z^{\prime}\in neg(x)}\exp(\texttt{sim}(\phi(x),%
\phi(z^{\prime})))}" class="ltx_Math" display="inline" id="S3.Ex1.m2.10"><semantics id="S3.Ex1.m2.10a"><mrow id="S3.Ex1.m2.10.11" xref="S3.Ex1.m2.10.11.cmml"><mi id="S3.Ex1.m2.10.11.2" xref="S3.Ex1.m2.10.11.2.cmml"></mi><mo id="S3.Ex1.m2.10.11.1" xref="S3.Ex1.m2.10.11.1.cmml">=</mo><mrow id="S3.Ex1.m2.10.11.3" xref="S3.Ex1.m2.10.11.3.cmml"><mrow id="S3.Ex1.m2.10.11.3.2" xref="S3.Ex1.m2.10.11.3.2.cmml"><mi id="S3.Ex1.m2.10.11.3.2.1" xref="S3.Ex1.m2.10.11.3.2.1.cmml">arg</mi><mo id="S3.Ex1.m2.10.11.3.2a" lspace="0.167em" xref="S3.Ex1.m2.10.11.3.2.cmml">⁡</mo><munder id="S3.Ex1.m2.10.11.3.2.2" xref="S3.Ex1.m2.10.11.3.2.2.cmml"><mi id="S3.Ex1.m2.10.11.3.2.2.2" xref="S3.Ex1.m2.10.11.3.2.2.2.cmml">min</mi><mi id="S3.Ex1.m2.10.11.3.2.2.3" xref="S3.Ex1.m2.10.11.3.2.2.3.cmml">ϕ</mi></munder></mrow><mo id="S3.Ex1.m2.10.11.3.1" lspace="0em" xref="S3.Ex1.m2.10.11.3.1.cmml">−</mo><mrow id="S3.Ex1.m2.10.11.3.3" xref="S3.Ex1.m2.10.11.3.3.cmml"><mi id="S3.Ex1.m2.10.11.3.3.2" xref="S3.Ex1.m2.10.11.3.3.2.cmml">log</mi><mo id="S3.Ex1.m2.10.11.3.3.1" lspace="0.167em" xref="S3.Ex1.m2.10.11.3.3.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.10.11.3.3.3" xref="S3.Ex1.m2.10.11.3.3.3.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.10.11.3.3.3.1" xref="S3.Ex1.m2.10.11.3.3.3.1.cmml"><munder id="S3.Ex1.m2.10.11.3.3.3.1a" xref="S3.Ex1.m2.10.11.3.3.3.1.cmml"><mo id="S3.Ex1.m2.10.11.3.3.3.1.2" movablelimits="false" xref="S3.Ex1.m2.10.11.3.3.3.1.2.cmml">∑</mo><mrow id="S3.Ex1.m2.2.2.2" xref="S3.Ex1.m2.2.2.2.cmml"><mrow id="S3.Ex1.m2.2.2.2.4.2" xref="S3.Ex1.m2.2.2.2.4.1.cmml"><mo id="S3.Ex1.m2.2.2.2.4.2.1" stretchy="false" xref="S3.Ex1.m2.2.2.2.4.1.cmml">(</mo><mi id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml">x</mi><mo id="S3.Ex1.m2.2.2.2.4.2.2" xref="S3.Ex1.m2.2.2.2.4.1.cmml">,</mo><mi id="S3.Ex1.m2.2.2.2.2" xref="S3.Ex1.m2.2.2.2.2.cmml">z</mi><mo id="S3.Ex1.m2.2.2.2.4.2.3" stretchy="false" xref="S3.Ex1.m2.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.Ex1.m2.2.2.2.3" xref="S3.Ex1.m2.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.2.2.2.5" xref="S3.Ex1.m2.2.2.2.5.cmml">𝒟</mi></mrow></munder></mstyle><mstyle displaystyle="true" id="S3.Ex1.m2.10.10" xref="S3.Ex1.m2.10.10.cmml"><mfrac id="S3.Ex1.m2.10.10a" xref="S3.Ex1.m2.10.10.cmml"><mrow id="S3.Ex1.m2.6.6.4.4" xref="S3.Ex1.m2.6.6.4.5.cmml"><mi id="S3.Ex1.m2.5.5.3.3" xref="S3.Ex1.m2.5.5.3.3.cmml">exp</mi><mo id="S3.Ex1.m2.6.6.4.4a" xref="S3.Ex1.m2.6.6.4.5.cmml">⁡</mo><mrow id="S3.Ex1.m2.6.6.4.4.1" xref="S3.Ex1.m2.6.6.4.5.cmml"><mo id="S3.Ex1.m2.6.6.4.4.1.2" stretchy="false" xref="S3.Ex1.m2.6.6.4.5.cmml">(</mo><mrow id="S3.Ex1.m2.6.6.4.4.1.1" xref="S3.Ex1.m2.6.6.4.4.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m2.6.6.4.4.1.1.4" xref="S3.Ex1.m2.6.6.4.4.1.1.4a.cmml">sim</mtext><mo id="S3.Ex1.m2.6.6.4.4.1.1.3" xref="S3.Ex1.m2.6.6.4.4.1.1.3.cmml">⁢</mo><mrow id="S3.Ex1.m2.6.6.4.4.1.1.2.2" xref="S3.Ex1.m2.6.6.4.4.1.1.2.3.cmml"><mo id="S3.Ex1.m2.6.6.4.4.1.1.2.2.3" stretchy="false" xref="S3.Ex1.m2.6.6.4.4.1.1.2.3.cmml">(</mo><mrow id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.2" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.1" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.3.2" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m2.3.3.1.1" xref="S3.Ex1.m2.3.3.1.1.cmml">x</mi><mo id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.6.6.4.4.1.1.2.2.4" xref="S3.Ex1.m2.6.6.4.4.1.1.2.3.cmml">,</mo><mrow id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.cmml"><mi id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.2" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.2.cmml">ϕ</mi><mo id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.1" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.3.2" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.cmml"><mo id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.3.2.1" stretchy="false" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.cmml">(</mo><mi id="S3.Ex1.m2.4.4.2.2" xref="S3.Ex1.m2.4.4.2.2.cmml">z</mi><mo id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.3.2.2" stretchy="false" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.6.6.4.4.1.1.2.2.5" stretchy="false" xref="S3.Ex1.m2.6.6.4.4.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.6.6.4.4.1.3" stretchy="false" xref="S3.Ex1.m2.6.6.4.5.cmml">)</mo></mrow></mrow><mrow id="S3.Ex1.m2.10.10.8" xref="S3.Ex1.m2.10.10.8.cmml"><msub id="S3.Ex1.m2.10.10.8.5" xref="S3.Ex1.m2.10.10.8.5.cmml"><mo id="S3.Ex1.m2.10.10.8.5.2" xref="S3.Ex1.m2.10.10.8.5.2.cmml">∑</mo><mrow id="S3.Ex1.m2.7.7.5.1.1" xref="S3.Ex1.m2.7.7.5.1.1.cmml"><msup id="S3.Ex1.m2.7.7.5.1.1.3" xref="S3.Ex1.m2.7.7.5.1.1.3.cmml"><mi id="S3.Ex1.m2.7.7.5.1.1.3.2" xref="S3.Ex1.m2.7.7.5.1.1.3.2.cmml">z</mi><mo id="S3.Ex1.m2.7.7.5.1.1.3.3" xref="S3.Ex1.m2.7.7.5.1.1.3.3.cmml">′</mo></msup><mo id="S3.Ex1.m2.7.7.5.1.1.2" xref="S3.Ex1.m2.7.7.5.1.1.2.cmml">∈</mo><mrow id="S3.Ex1.m2.7.7.5.1.1.4" xref="S3.Ex1.m2.7.7.5.1.1.4.cmml"><mi id="S3.Ex1.m2.7.7.5.1.1.4.2" xref="S3.Ex1.m2.7.7.5.1.1.4.2.cmml">n</mi><mo id="S3.Ex1.m2.7.7.5.1.1.4.1" xref="S3.Ex1.m2.7.7.5.1.1.4.1.cmml">⁢</mo><mi id="S3.Ex1.m2.7.7.5.1.1.4.3" xref="S3.Ex1.m2.7.7.5.1.1.4.3.cmml">e</mi><mo id="S3.Ex1.m2.7.7.5.1.1.4.1a" xref="S3.Ex1.m2.7.7.5.1.1.4.1.cmml">⁢</mo><mi id="S3.Ex1.m2.7.7.5.1.1.4.4" xref="S3.Ex1.m2.7.7.5.1.1.4.4.cmml">g</mi><mo id="S3.Ex1.m2.7.7.5.1.1.4.1b" xref="S3.Ex1.m2.7.7.5.1.1.4.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.7.7.5.1.1.4.5.2" xref="S3.Ex1.m2.7.7.5.1.1.4.cmml"><mo id="S3.Ex1.m2.7.7.5.1.1.4.5.2.1" stretchy="false" xref="S3.Ex1.m2.7.7.5.1.1.4.cmml">(</mo><mi id="S3.Ex1.m2.7.7.5.1.1.1" xref="S3.Ex1.m2.7.7.5.1.1.1.cmml">x</mi><mo id="S3.Ex1.m2.7.7.5.1.1.4.5.2.2" stretchy="false" xref="S3.Ex1.m2.7.7.5.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S3.Ex1.m2.10.10.8.4.1" xref="S3.Ex1.m2.10.10.8.4.2.cmml"><mi id="S3.Ex1.m2.9.9.7.3" xref="S3.Ex1.m2.9.9.7.3.cmml">exp</mi><mo id="S3.Ex1.m2.10.10.8.4.1a" xref="S3.Ex1.m2.10.10.8.4.2.cmml">⁡</mo><mrow id="S3.Ex1.m2.10.10.8.4.1.1" xref="S3.Ex1.m2.10.10.8.4.2.cmml"><mo id="S3.Ex1.m2.10.10.8.4.1.1.2" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.2.cmml">(</mo><mrow id="S3.Ex1.m2.10.10.8.4.1.1.1" xref="S3.Ex1.m2.10.10.8.4.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m2.10.10.8.4.1.1.1.4" xref="S3.Ex1.m2.10.10.8.4.1.1.1.4a.cmml">sim</mtext><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.3" xref="S3.Ex1.m2.10.10.8.4.1.1.1.3.cmml">⁢</mo><mrow id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.3.cmml"><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.3" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.3.cmml">(</mo><mrow id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.2" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.2.cmml">ϕ</mi><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.1" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex1.m2.8.8.6.2" xref="S3.Ex1.m2.8.8.6.2.cmml">x</mi><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.4" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.3.cmml">,</mo><mrow id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.cmml"><mi id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.3" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.3.cmml">ϕ</mi><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.2" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.cmml">(</mo><msup id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.cmml"><mi id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.2" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.2.cmml">z</mi><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.3" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.3.cmml">′</mo></msup><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.5" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.10.10.8.4.1.1.3" stretchy="false" xref="S3.Ex1.m2.10.10.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.10b"><apply id="S3.Ex1.m2.10.11.cmml" xref="S3.Ex1.m2.10.11"><eq id="S3.Ex1.m2.10.11.1.cmml" xref="S3.Ex1.m2.10.11.1"></eq><csymbol cd="latexml" id="S3.Ex1.m2.10.11.2.cmml" xref="S3.Ex1.m2.10.11.2">absent</csymbol><apply id="S3.Ex1.m2.10.11.3.cmml" xref="S3.Ex1.m2.10.11.3"><minus id="S3.Ex1.m2.10.11.3.1.cmml" xref="S3.Ex1.m2.10.11.3.1"></minus><apply id="S3.Ex1.m2.10.11.3.2.cmml" xref="S3.Ex1.m2.10.11.3.2"><arg id="S3.Ex1.m2.10.11.3.2.1.cmml" xref="S3.Ex1.m2.10.11.3.2.1"></arg><apply id="S3.Ex1.m2.10.11.3.2.2.cmml" xref="S3.Ex1.m2.10.11.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.11.3.2.2.1.cmml" xref="S3.Ex1.m2.10.11.3.2.2">subscript</csymbol><min id="S3.Ex1.m2.10.11.3.2.2.2.cmml" xref="S3.Ex1.m2.10.11.3.2.2.2"></min><ci id="S3.Ex1.m2.10.11.3.2.2.3.cmml" xref="S3.Ex1.m2.10.11.3.2.2.3">italic-ϕ</ci></apply></apply><apply id="S3.Ex1.m2.10.11.3.3.cmml" xref="S3.Ex1.m2.10.11.3.3"><times id="S3.Ex1.m2.10.11.3.3.1.cmml" xref="S3.Ex1.m2.10.11.3.3.1"></times><log id="S3.Ex1.m2.10.11.3.3.2.cmml" xref="S3.Ex1.m2.10.11.3.3.2"></log><apply id="S3.Ex1.m2.10.11.3.3.3.cmml" xref="S3.Ex1.m2.10.11.3.3.3"><apply id="S3.Ex1.m2.10.11.3.3.3.1.cmml" xref="S3.Ex1.m2.10.11.3.3.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.11.3.3.3.1.1.cmml" xref="S3.Ex1.m2.10.11.3.3.3.1">subscript</csymbol><sum id="S3.Ex1.m2.10.11.3.3.3.1.2.cmml" xref="S3.Ex1.m2.10.11.3.3.3.1.2"></sum><apply id="S3.Ex1.m2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.2"><in id="S3.Ex1.m2.2.2.2.3.cmml" xref="S3.Ex1.m2.2.2.2.3"></in><interval closure="open" id="S3.Ex1.m2.2.2.2.4.1.cmml" xref="S3.Ex1.m2.2.2.2.4.2"><ci id="S3.Ex1.m2.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1">𝑥</ci><ci id="S3.Ex1.m2.2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.2.2">𝑧</ci></interval><ci id="S3.Ex1.m2.2.2.2.5.cmml" xref="S3.Ex1.m2.2.2.2.5">𝒟</ci></apply></apply><apply id="S3.Ex1.m2.10.10.cmml" xref="S3.Ex1.m2.10.10"><divide id="S3.Ex1.m2.10.10.9.cmml" xref="S3.Ex1.m2.10.10"></divide><apply id="S3.Ex1.m2.6.6.4.5.cmml" xref="S3.Ex1.m2.6.6.4.4"><exp id="S3.Ex1.m2.5.5.3.3.cmml" xref="S3.Ex1.m2.5.5.3.3"></exp><apply id="S3.Ex1.m2.6.6.4.4.1.1.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1"><times id="S3.Ex1.m2.6.6.4.4.1.1.3.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.3"></times><ci id="S3.Ex1.m2.6.6.4.4.1.1.4a.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.4"><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m2.6.6.4.4.1.1.4.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.4">sim</mtext></ci><interval closure="open" id="S3.Ex1.m2.6.6.4.4.1.1.2.3.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2"><apply id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1"><times id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.1"></times><ci id="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.Ex1.m2.3.3.1.1.cmml" xref="S3.Ex1.m2.3.3.1.1">𝑥</ci></apply><apply id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2"><times id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.1.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.1"></times><ci id="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.2.cmml" xref="S3.Ex1.m2.6.6.4.4.1.1.2.2.2.2">italic-ϕ</ci><ci id="S3.Ex1.m2.4.4.2.2.cmml" xref="S3.Ex1.m2.4.4.2.2">𝑧</ci></apply></interval></apply></apply><apply id="S3.Ex1.m2.10.10.8.cmml" xref="S3.Ex1.m2.10.10.8"><apply id="S3.Ex1.m2.10.10.8.5.cmml" xref="S3.Ex1.m2.10.10.8.5"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.8.5.1.cmml" xref="S3.Ex1.m2.10.10.8.5">subscript</csymbol><sum id="S3.Ex1.m2.10.10.8.5.2.cmml" xref="S3.Ex1.m2.10.10.8.5.2"></sum><apply id="S3.Ex1.m2.7.7.5.1.1.cmml" xref="S3.Ex1.m2.7.7.5.1.1"><in id="S3.Ex1.m2.7.7.5.1.1.2.cmml" xref="S3.Ex1.m2.7.7.5.1.1.2"></in><apply id="S3.Ex1.m2.7.7.5.1.1.3.cmml" xref="S3.Ex1.m2.7.7.5.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.7.7.5.1.1.3.1.cmml" xref="S3.Ex1.m2.7.7.5.1.1.3">superscript</csymbol><ci id="S3.Ex1.m2.7.7.5.1.1.3.2.cmml" xref="S3.Ex1.m2.7.7.5.1.1.3.2">𝑧</ci><ci id="S3.Ex1.m2.7.7.5.1.1.3.3.cmml" xref="S3.Ex1.m2.7.7.5.1.1.3.3">′</ci></apply><apply id="S3.Ex1.m2.7.7.5.1.1.4.cmml" xref="S3.Ex1.m2.7.7.5.1.1.4"><times id="S3.Ex1.m2.7.7.5.1.1.4.1.cmml" xref="S3.Ex1.m2.7.7.5.1.1.4.1"></times><ci id="S3.Ex1.m2.7.7.5.1.1.4.2.cmml" xref="S3.Ex1.m2.7.7.5.1.1.4.2">𝑛</ci><ci id="S3.Ex1.m2.7.7.5.1.1.4.3.cmml" xref="S3.Ex1.m2.7.7.5.1.1.4.3">𝑒</ci><ci id="S3.Ex1.m2.7.7.5.1.1.4.4.cmml" xref="S3.Ex1.m2.7.7.5.1.1.4.4">𝑔</ci><ci id="S3.Ex1.m2.7.7.5.1.1.1.cmml" xref="S3.Ex1.m2.7.7.5.1.1.1">𝑥</ci></apply></apply></apply><apply id="S3.Ex1.m2.10.10.8.4.2.cmml" xref="S3.Ex1.m2.10.10.8.4.1"><exp id="S3.Ex1.m2.9.9.7.3.cmml" xref="S3.Ex1.m2.9.9.7.3"></exp><apply id="S3.Ex1.m2.10.10.8.4.1.1.1.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1"><times id="S3.Ex1.m2.10.10.8.4.1.1.1.3.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.3"></times><ci id="S3.Ex1.m2.10.10.8.4.1.1.1.4a.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.4"><mtext class="ltx_mathvariant_monospace" id="S3.Ex1.m2.10.10.8.4.1.1.1.4.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.4">sim</mtext></ci><interval closure="open" id="S3.Ex1.m2.10.10.8.4.1.1.1.2.3.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2"><apply id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1"><times id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.1"></times><ci id="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.Ex1.m2.8.8.6.2.cmml" xref="S3.Ex1.m2.8.8.6.2">𝑥</ci></apply><apply id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2"><times id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.2.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.2"></times><ci id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.3.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.3">italic-ϕ</ci><apply id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1">superscript</csymbol><ci id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.2">𝑧</ci><ci id="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.Ex1.m2.10.10.8.4.1.1.1.2.2.2.1.1.1.3">′</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.10c">\displaystyle=\arg\min_{\phi}-\log\sum_{(x,z)\in\mathcal{D}}\frac{\exp(\texttt%
{sim}(\phi(x),\phi(z)))}{\sum_{z^{\prime}\in neg(x)}\exp(\texttt{sim}(\phi(x),%
\phi(z^{\prime})))}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.10d">= roman_arg roman_min start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT - roman_log ∑ start_POSTSUBSCRIPT ( italic_x , italic_z ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG roman_exp ( sim ( italic_ϕ ( italic_x ) , italic_ϕ ( italic_z ) ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_n italic_e italic_g ( italic_x ) end_POSTSUBSCRIPT roman_exp ( sim ( italic_ϕ ( italic_x ) , italic_ϕ ( italic_z start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}(x)" class="ltx_Math" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.2" xref="S3.E1.m1.1.2.cmml"><mi id="S3.E1.m1.1.2.2" xref="S3.E1.m1.1.2.2.cmml">𝐲</mi><mo id="S3.E1.m1.1.2.1" xref="S3.E1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.1.2.3.2" xref="S3.E1.m1.1.2.cmml"><mo id="S3.E1.m1.1.2.3.2.1" stretchy="false" xref="S3.E1.m1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">x</mi><mo id="S3.E1.m1.1.2.3.2.2" stretchy="false" xref="S3.E1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.2.cmml" xref="S3.E1.m1.1.2"><times id="S3.E1.m1.1.2.1.cmml" xref="S3.E1.m1.1.2.1"></times><ci id="S3.E1.m1.1.2.2.cmml" xref="S3.E1.m1.1.2.2">𝐲</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\mathbf{y}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">bold_y ( italic_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\texttt{Topk}_{z\in Z}\texttt{sim}(\hat{\phi}(x),\hat{\phi}(z))" class="ltx_Math" display="inline" id="S3.E1.m2.4"><semantics id="S3.E1.m2.4a"><mrow id="S3.E1.m2.4.4" xref="S3.E1.m2.4.4.cmml"><mi id="S3.E1.m2.4.4.4" xref="S3.E1.m2.4.4.4.cmml"></mi><mo id="S3.E1.m2.4.4.3" xref="S3.E1.m2.4.4.3.cmml">=</mo><mrow id="S3.E1.m2.4.4.2" xref="S3.E1.m2.4.4.2.cmml"><msub id="S3.E1.m2.4.4.2.4" xref="S3.E1.m2.4.4.2.4.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E1.m2.4.4.2.4.2" xref="S3.E1.m2.4.4.2.4.2a.cmml">Topk</mtext><mrow id="S3.E1.m2.4.4.2.4.3" xref="S3.E1.m2.4.4.2.4.3.cmml"><mi id="S3.E1.m2.4.4.2.4.3.2" xref="S3.E1.m2.4.4.2.4.3.2.cmml">z</mi><mo id="S3.E1.m2.4.4.2.4.3.1" xref="S3.E1.m2.4.4.2.4.3.1.cmml">∈</mo><mi id="S3.E1.m2.4.4.2.4.3.3" xref="S3.E1.m2.4.4.2.4.3.3.cmml">Z</mi></mrow></msub><mo id="S3.E1.m2.4.4.2.3" xref="S3.E1.m2.4.4.2.3.cmml">⁢</mo><mtext class="ltx_mathvariant_monospace" id="S3.E1.m2.4.4.2.5" xref="S3.E1.m2.4.4.2.5a.cmml">sim</mtext><mo id="S3.E1.m2.4.4.2.3a" xref="S3.E1.m2.4.4.2.3.cmml">⁢</mo><mrow id="S3.E1.m2.4.4.2.2.2" xref="S3.E1.m2.4.4.2.2.3.cmml"><mo id="S3.E1.m2.4.4.2.2.2.3" stretchy="false" xref="S3.E1.m2.4.4.2.2.3.cmml">(</mo><mrow id="S3.E1.m2.3.3.1.1.1.1" xref="S3.E1.m2.3.3.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m2.3.3.1.1.1.1.2" xref="S3.E1.m2.3.3.1.1.1.1.2.cmml"><mi id="S3.E1.m2.3.3.1.1.1.1.2.2" xref="S3.E1.m2.3.3.1.1.1.1.2.2.cmml">ϕ</mi><mo id="S3.E1.m2.3.3.1.1.1.1.2.1" xref="S3.E1.m2.3.3.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E1.m2.3.3.1.1.1.1.1" xref="S3.E1.m2.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E1.m2.3.3.1.1.1.1.3.2" xref="S3.E1.m2.3.3.1.1.1.1.cmml"><mo id="S3.E1.m2.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S3.E1.m2.3.3.1.1.1.1.cmml">(</mo><mi id="S3.E1.m2.1.1" xref="S3.E1.m2.1.1.cmml">x</mi><mo id="S3.E1.m2.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S3.E1.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m2.4.4.2.2.2.4" xref="S3.E1.m2.4.4.2.2.3.cmml">,</mo><mrow id="S3.E1.m2.4.4.2.2.2.2" xref="S3.E1.m2.4.4.2.2.2.2.cmml"><mover accent="true" id="S3.E1.m2.4.4.2.2.2.2.2" xref="S3.E1.m2.4.4.2.2.2.2.2.cmml"><mi id="S3.E1.m2.4.4.2.2.2.2.2.2" xref="S3.E1.m2.4.4.2.2.2.2.2.2.cmml">ϕ</mi><mo id="S3.E1.m2.4.4.2.2.2.2.2.1" xref="S3.E1.m2.4.4.2.2.2.2.2.1.cmml">^</mo></mover><mo id="S3.E1.m2.4.4.2.2.2.2.1" xref="S3.E1.m2.4.4.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m2.4.4.2.2.2.2.3.2" xref="S3.E1.m2.4.4.2.2.2.2.cmml"><mo id="S3.E1.m2.4.4.2.2.2.2.3.2.1" stretchy="false" xref="S3.E1.m2.4.4.2.2.2.2.cmml">(</mo><mi id="S3.E1.m2.2.2" xref="S3.E1.m2.2.2.cmml">z</mi><mo id="S3.E1.m2.4.4.2.2.2.2.3.2.2" stretchy="false" xref="S3.E1.m2.4.4.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m2.4.4.2.2.2.5" stretchy="false" xref="S3.E1.m2.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m2.4b"><apply id="S3.E1.m2.4.4.cmml" xref="S3.E1.m2.4.4"><eq id="S3.E1.m2.4.4.3.cmml" xref="S3.E1.m2.4.4.3"></eq><csymbol cd="latexml" id="S3.E1.m2.4.4.4.cmml" xref="S3.E1.m2.4.4.4">absent</csymbol><apply id="S3.E1.m2.4.4.2.cmml" xref="S3.E1.m2.4.4.2"><times id="S3.E1.m2.4.4.2.3.cmml" xref="S3.E1.m2.4.4.2.3"></times><apply id="S3.E1.m2.4.4.2.4.cmml" xref="S3.E1.m2.4.4.2.4"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.2.4.1.cmml" xref="S3.E1.m2.4.4.2.4">subscript</csymbol><ci id="S3.E1.m2.4.4.2.4.2a.cmml" xref="S3.E1.m2.4.4.2.4.2"><mtext class="ltx_mathvariant_monospace" id="S3.E1.m2.4.4.2.4.2.cmml" xref="S3.E1.m2.4.4.2.4.2">Topk</mtext></ci><apply id="S3.E1.m2.4.4.2.4.3.cmml" xref="S3.E1.m2.4.4.2.4.3"><in id="S3.E1.m2.4.4.2.4.3.1.cmml" xref="S3.E1.m2.4.4.2.4.3.1"></in><ci id="S3.E1.m2.4.4.2.4.3.2.cmml" xref="S3.E1.m2.4.4.2.4.3.2">𝑧</ci><ci id="S3.E1.m2.4.4.2.4.3.3.cmml" xref="S3.E1.m2.4.4.2.4.3.3">𝑍</ci></apply></apply><ci id="S3.E1.m2.4.4.2.5a.cmml" xref="S3.E1.m2.4.4.2.5"><mtext class="ltx_mathvariant_monospace" id="S3.E1.m2.4.4.2.5.cmml" xref="S3.E1.m2.4.4.2.5">sim</mtext></ci><interval closure="open" id="S3.E1.m2.4.4.2.2.3.cmml" xref="S3.E1.m2.4.4.2.2.2"><apply id="S3.E1.m2.3.3.1.1.1.1.cmml" xref="S3.E1.m2.3.3.1.1.1.1"><times id="S3.E1.m2.3.3.1.1.1.1.1.cmml" xref="S3.E1.m2.3.3.1.1.1.1.1"></times><apply id="S3.E1.m2.3.3.1.1.1.1.2.cmml" xref="S3.E1.m2.3.3.1.1.1.1.2"><ci id="S3.E1.m2.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m2.3.3.1.1.1.1.2.1">^</ci><ci id="S3.E1.m2.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m2.3.3.1.1.1.1.2.2">italic-ϕ</ci></apply><ci id="S3.E1.m2.1.1.cmml" xref="S3.E1.m2.1.1">𝑥</ci></apply><apply id="S3.E1.m2.4.4.2.2.2.2.cmml" xref="S3.E1.m2.4.4.2.2.2.2"><times id="S3.E1.m2.4.4.2.2.2.2.1.cmml" xref="S3.E1.m2.4.4.2.2.2.2.1"></times><apply id="S3.E1.m2.4.4.2.2.2.2.2.cmml" xref="S3.E1.m2.4.4.2.2.2.2.2"><ci id="S3.E1.m2.4.4.2.2.2.2.2.1.cmml" xref="S3.E1.m2.4.4.2.2.2.2.2.1">^</ci><ci id="S3.E1.m2.4.4.2.2.2.2.2.2.cmml" xref="S3.E1.m2.4.4.2.2.2.2.2.2">italic-ϕ</ci></apply><ci id="S3.E1.m2.2.2.cmml" xref="S3.E1.m2.2.2">𝑧</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m2.4c">\displaystyle=\texttt{Topk}_{z\in Z}\texttt{sim}(\hat{\phi}(x),\hat{\phi}(z))</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m2.4d">= Topk start_POSTSUBSCRIPT italic_z ∈ italic_Z end_POSTSUBSCRIPT sim ( over^ start_ARG italic_ϕ end_ARG ( italic_x ) , over^ start_ARG italic_ϕ end_ARG ( italic_z ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.12">where <math alttext="\mathbf{y}=[y_{1},y_{2},\cdots,y_{k}]" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m1.4"><semantics id="S3.SS1.p1.9.m1.4a"><mrow id="S3.SS1.p1.9.m1.4.4" xref="S3.SS1.p1.9.m1.4.4.cmml"><mi id="S3.SS1.p1.9.m1.4.4.5" xref="S3.SS1.p1.9.m1.4.4.5.cmml">𝐲</mi><mo id="S3.SS1.p1.9.m1.4.4.4" xref="S3.SS1.p1.9.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.9.m1.4.4.3.3" xref="S3.SS1.p1.9.m1.4.4.3.4.cmml"><mo id="S3.SS1.p1.9.m1.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.9.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS1.p1.9.m1.2.2.1.1.1" xref="S3.SS1.p1.9.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.9.m1.2.2.1.1.1.2" xref="S3.SS1.p1.9.m1.2.2.1.1.1.2.cmml">y</mi><mn id="S3.SS1.p1.9.m1.2.2.1.1.1.3" xref="S3.SS1.p1.9.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.9.m1.4.4.3.3.5" xref="S3.SS1.p1.9.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.9.m1.3.3.2.2.2" xref="S3.SS1.p1.9.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.9.m1.3.3.2.2.2.2" xref="S3.SS1.p1.9.m1.3.3.2.2.2.2.cmml">y</mi><mn id="S3.SS1.p1.9.m1.3.3.2.2.2.3" xref="S3.SS1.p1.9.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.9.m1.4.4.3.3.6" xref="S3.SS1.p1.9.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.9.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.9.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.9.m1.4.4.3.3.7" xref="S3.SS1.p1.9.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.9.m1.4.4.3.3.3" xref="S3.SS1.p1.9.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.9.m1.4.4.3.3.3.2" xref="S3.SS1.p1.9.m1.4.4.3.3.3.2.cmml">y</mi><mi id="S3.SS1.p1.9.m1.4.4.3.3.3.3" xref="S3.SS1.p1.9.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S3.SS1.p1.9.m1.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.9.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m1.4b"><apply id="S3.SS1.p1.9.m1.4.4.cmml" xref="S3.SS1.p1.9.m1.4.4"><eq id="S3.SS1.p1.9.m1.4.4.4.cmml" xref="S3.SS1.p1.9.m1.4.4.4"></eq><ci id="S3.SS1.p1.9.m1.4.4.5.cmml" xref="S3.SS1.p1.9.m1.4.4.5">𝐲</ci><list id="S3.SS1.p1.9.m1.4.4.3.4.cmml" xref="S3.SS1.p1.9.m1.4.4.3.3"><apply id="S3.SS1.p1.9.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.9.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.9.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.9.m1.2.2.1.1.1.2">𝑦</ci><cn id="S3.SS1.p1.9.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.9.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.9.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.9.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.9.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.9.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.9.m1.3.3.2.2.2.2">𝑦</ci><cn id="S3.SS1.p1.9.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.9.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.9.m1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1">⋯</ci><apply id="S3.SS1.p1.9.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.9.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.9.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.9.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.9.m1.4.4.3.3.3.2">𝑦</ci><ci id="S3.SS1.p1.9.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.9.m1.4.4.3.3.3.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m1.4c">\mathbf{y}=[y_{1},y_{2},\cdots,y_{k}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m1.4d">bold_y = [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ]</annotation></semantics></math> refers to the sequence of top-k items returned by a trained encoder <math alttext="\hat{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m2.1"><semantics id="S3.SS1.p1.10.m2.1a"><mover accent="true" id="S3.SS1.p1.10.m2.1.1" xref="S3.SS1.p1.10.m2.1.1.cmml"><mi id="S3.SS1.p1.10.m2.1.1.2" xref="S3.SS1.p1.10.m2.1.1.2.cmml">ϕ</mi><mo id="S3.SS1.p1.10.m2.1.1.1" xref="S3.SS1.p1.10.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m2.1b"><apply id="S3.SS1.p1.10.m2.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1"><ci id="S3.SS1.p1.10.m2.1.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1.1">^</ci><ci id="S3.SS1.p1.10.m2.1.1.2.cmml" xref="S3.SS1.p1.10.m2.1.1.2">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m2.1c">\hat{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m2.1d">over^ start_ARG italic_ϕ end_ARG</annotation></semantics></math> and <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p1.12.1">Topk</span> is a non-differentiable ranking operation.
At inference time, given a query, the trained encoder <math alttext="\hat{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m4.1"><semantics id="S3.SS1.p1.12.m4.1a"><mover accent="true" id="S3.SS1.p1.12.m4.1.1" xref="S3.SS1.p1.12.m4.1.1.cmml"><mi id="S3.SS1.p1.12.m4.1.1.2" xref="S3.SS1.p1.12.m4.1.1.2.cmml">ϕ</mi><mo id="S3.SS1.p1.12.m4.1.1.1" xref="S3.SS1.p1.12.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m4.1b"><apply id="S3.SS1.p1.12.m4.1.1.cmml" xref="S3.SS1.p1.12.m4.1.1"><ci id="S3.SS1.p1.12.m4.1.1.1.cmml" xref="S3.SS1.p1.12.m4.1.1.1">^</ci><ci id="S3.SS1.p1.12.m4.1.1.2.cmml" xref="S3.SS1.p1.12.m4.1.1.2">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m4.1c">\hat{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m4.1d">over^ start_ARG italic_ϕ end_ARG</annotation></semantics></math> is used to compute the similarity with each item and the top-k closest items are returned as the prediction.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">Given the trained encoder <math alttext="\hat{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mover accent="true" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">ϕ</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><ci id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1">^</ci><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\hat{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">over^ start_ARG italic_ϕ end_ARG</annotation></semantics></math>, our goal is to finetune the encoder such that the novelty of its top-k items compared to a base model is optimized, while ensuring that the accuracy of the encoder does not decrease substantially. Specifically, we assume that there is an existing base retrieval model <math alttext="\psi" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_ψ</annotation></semantics></math> deployed in the production recommendation system and we want to deploy another retrieval model that introduces novel items. Both the base model and the new, finetuned model would run in parallel and their results can be merged for the downstream ranking layer. Formally, novelty@k is defined as,</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S3.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_theorem">Definition 1.</h6>
<div class="ltx_para" id="S3.Thmtheorem1.p1">
<p class="ltx_p" id="S3.Thmtheorem1.p1.4"><span class="ltx_text ltx_font_bold" id="S3.Thmtheorem1.p1.4.1">Novelty:</span> Given a query <math alttext="x" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.1.m1.1"><semantics id="S3.Thmtheorem1.p1.1.m1.1a"><mi id="S3.Thmtheorem1.p1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.m1.1b"><ci id="S3.Thmtheorem1.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.1.m1.1d">italic_x</annotation></semantics></math>, Novelty@k <math alttext="(x,\phi,\psi,L)" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.2.m2.4"><semantics id="S3.Thmtheorem1.p1.2.m2.4a"><mrow id="S3.Thmtheorem1.p1.2.m2.4.5.2" xref="S3.Thmtheorem1.p1.2.m2.4.5.1.cmml"><mo id="S3.Thmtheorem1.p1.2.m2.4.5.2.1" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.4.5.1.cmml">(</mo><mi id="S3.Thmtheorem1.p1.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.m2.1.1.cmml">x</mi><mo id="S3.Thmtheorem1.p1.2.m2.4.5.2.2" xref="S3.Thmtheorem1.p1.2.m2.4.5.1.cmml">,</mo><mi id="S3.Thmtheorem1.p1.2.m2.2.2" xref="S3.Thmtheorem1.p1.2.m2.2.2.cmml">ϕ</mi><mo id="S3.Thmtheorem1.p1.2.m2.4.5.2.3" xref="S3.Thmtheorem1.p1.2.m2.4.5.1.cmml">,</mo><mi id="S3.Thmtheorem1.p1.2.m2.3.3" xref="S3.Thmtheorem1.p1.2.m2.3.3.cmml">ψ</mi><mo id="S3.Thmtheorem1.p1.2.m2.4.5.2.4" xref="S3.Thmtheorem1.p1.2.m2.4.5.1.cmml">,</mo><mi id="S3.Thmtheorem1.p1.2.m2.4.4" xref="S3.Thmtheorem1.p1.2.m2.4.4.cmml">L</mi><mo id="S3.Thmtheorem1.p1.2.m2.4.5.2.5" stretchy="false" xref="S3.Thmtheorem1.p1.2.m2.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.m2.4b"><vector id="S3.Thmtheorem1.p1.2.m2.4.5.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.4.5.2"><ci id="S3.Thmtheorem1.p1.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.1">𝑥</ci><ci id="S3.Thmtheorem1.p1.2.m2.2.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.2.2">italic-ϕ</ci><ci id="S3.Thmtheorem1.p1.2.m2.3.3.cmml" xref="S3.Thmtheorem1.p1.2.m2.3.3">𝜓</ci><ci id="S3.Thmtheorem1.p1.2.m2.4.4.cmml" xref="S3.Thmtheorem1.p1.2.m2.4.4">𝐿</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.m2.4c">(x,\phi,\psi,L)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.2.m2.4d">( italic_x , italic_ϕ , italic_ψ , italic_L )</annotation></semantics></math> is defined as the number of items in top-k predictions of a candidate model <math alttext="\phi" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.3.m3.1"><semantics id="S3.Thmtheorem1.p1.3.m3.1a"><mi id="S3.Thmtheorem1.p1.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.m3.1b"><ci id="S3.Thmtheorem1.p1.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.3.m3.1d">italic_ϕ</annotation></semantics></math> that do not exist in top-L predictions of the base model <math alttext="\psi" class="ltx_Math" display="inline" id="S3.Thmtheorem1.p1.4.m4.1"><semantics id="S3.Thmtheorem1.p1.4.m4.1a"><mi id="S3.Thmtheorem1.p1.4.m4.1.1" xref="S3.Thmtheorem1.p1.4.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.m4.1b"><ci id="S3.Thmtheorem1.p1.4.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.4.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.m4.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem1.p1.4.m4.1d">italic_ψ</annotation></semantics></math>.</p>
</div>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.8">Typically, <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_L</annotation></semantics></math> is set as the number of items that the retrieval layer sends downstream to the ranking layer (e.g., <math alttext="L=200" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">L</mi><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><eq id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></eq><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐿</ci><cn id="S3.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">L=200</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_L = 200</annotation></semantics></math> in our experiments). If a candidate model outputs an item that is beyond the top-L of the base model, then it will result in a new item added to the recommendation system’s ranking layer. Note that <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_k</annotation></semantics></math> need not be the same as <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_L</annotation></semantics></math>. For efficiency reasons, we may be interested in novelty at lower <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_k</annotation></semantics></math> (e.g., <math alttext="k=50" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><mrow id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2.cmml">k</mi><mo id="S3.SS1.p3.6.m6.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><eq id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1"></eq><ci id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2">𝑘</ci><cn id="S3.SS1.p3.6.m6.1.1.3.cmml" type="integer" xref="S3.SS1.p3.6.m6.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">k=50</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">italic_k = 50</annotation></semantics></math>), under a setting where the candidate model only adds <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">italic_k</annotation></semantics></math> additional items to be sent to the downstream ranking layer.
While our definition assumes a single base model, it can be easily extended to multiple deployed models by pooling their top-<math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m8.1"><semantics id="S3.SS1.p3.8.m8.1a"><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">italic_L</annotation></semantics></math> predictions for novelty comparison.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">Note that novelty of top-k items of a candidate algorithm is different from its diversity <cite class="ltx_cite ltx_citemacro_citep">(Shani and Gunawardana, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib32" title="">2011</a>)</cite>, which measures the distance of items <span class="ltx_text ltx_font_italic" id="S3.SS1.p4.1.1">within</span> the top-k list produced by the candidate algorithm.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>RL formulation using policy gradient</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6"><span class="ltx_text ltx_font_typewriter" id="S3.SS2.p1.6.1">Novelty@k</span>, as defined above, cannot be optimized directly since it includes a non-differentiable component w.r.t. the encoder’s parameters, the top-k sorting operation over items. As in past work on recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Stamenkovic et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib34" title="">2022</a>; Keat et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib17" title="">2022</a>; Xie et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib39" title="">2021</a>)</cite>, a natural solution for non-differentiable rewards is to use reinforcement learning. Formally, our problem can be formulated as a one-step RL setting. The query is considered as the <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.6.2">state</span> and the set of top-k items as the <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.6.3">action</span>. A policy <math alttext="\pi:X\rightarrow\{Z_{k}:Z_{k}\subseteq Z\}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.4" xref="S3.SS2.p1.1.m1.2.2.4.cmml">π</mi><mo id="S3.SS2.p1.1.m1.2.2.3" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.1.m1.2.2.3.cmml">:</mo><mrow id="S3.SS2.p1.1.m1.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.2.4" xref="S3.SS2.p1.1.m1.2.2.2.4.cmml">X</mi><mo id="S3.SS2.p1.1.m1.2.2.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">→</mo><mrow id="S3.SS2.p1.1.m1.2.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.3.cmml"><mo id="S3.SS2.p1.1.m1.2.2.2.2.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.2.3.1.cmml">{</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml">Z</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.p1.1.m1.2.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.1.m1.2.2.2.2.3.1.cmml">:</mo><mrow id="S3.SS2.p1.1.m1.2.2.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.cmml"><msub id="S3.SS2.p1.1.m1.2.2.2.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.2.cmml">Z</mi><mi id="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.3" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS2.p1.1.m1.2.2.2.2.2.2.1" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.1.cmml">⊆</mo><mi id="S3.SS2.p1.1.m1.2.2.2.2.2.2.3" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.3.cmml">Z</mi></mrow><mo id="S3.SS2.p1.1.m1.2.2.2.2.2.5" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2"><ci id="S3.SS2.p1.1.m1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.3">:</ci><ci id="S3.SS2.p1.1.m1.2.2.4.cmml" xref="S3.SS2.p1.1.m1.2.2.4">𝜋</ci><apply id="S3.SS2.p1.1.m1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2"><ci id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.3">→</ci><ci id="S3.SS2.p1.1.m1.2.2.2.4.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4">𝑋</ci><apply id="S3.SS2.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.3">conditional-set</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2">𝑍</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2"><subset id="S3.SS2.p1.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.1"></subset><apply id="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.2">𝑍</ci><ci id="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.3">𝑍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\pi:X\rightarrow\{Z_{k}:Z_{k}\subseteq Z\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">italic_π : italic_X → { italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT : italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⊆ italic_Z }</annotation></semantics></math> is a function that outputs a set of top-k items given a query. For each action selected by the policy, the environment provides reward feedback on the <math alttext="&lt;" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mo id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><lt id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">&lt;</annotation></semantics></math> state,action <math alttext="&gt;" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mo id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><gt id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">&gt;</annotation></semantics></math> pair. For instance, in the query-ad recommendation task, user’s input query is the state, the top-k predicted ads are the action by the policy, and the environment provides reward based on the query and its top-k predicted ads, e.g., based on the novelty and relevance of the predicted ads. Given a reward function <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">caligraphic_R</annotation></semantics></math>, the task to learn a policy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">π</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝜋</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> (parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_θ</annotation></semantics></math>), that optimizes,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\theta}\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}\sim\pi_{%
\theta}(x)}\mathcal{R}(x,\mathbf{y})" class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.4" xref="S3.E2.m1.3.4.cmml"><mrow id="S3.E2.m1.3.4.2" xref="S3.E2.m1.3.4.2.cmml"><munder id="S3.E2.m1.3.4.2.1" xref="S3.E2.m1.3.4.2.1.cmml"><mi id="S3.E2.m1.3.4.2.1.2" xref="S3.E2.m1.3.4.2.1.2.cmml">max</mi><mi id="S3.E2.m1.3.4.2.1.3" xref="S3.E2.m1.3.4.2.1.3.cmml">θ</mi></munder><mo id="S3.E2.m1.3.4.2a" lspace="0.167em" xref="S3.E2.m1.3.4.2.cmml">⁡</mo><mrow id="S3.E2.m1.3.4.2.2" xref="S3.E2.m1.3.4.2.2.cmml"><msub id="S3.E2.m1.3.4.2.2.2" xref="S3.E2.m1.3.4.2.2.2.cmml"><mi id="S3.E2.m1.3.4.2.2.2.2" xref="S3.E2.m1.3.4.2.2.2.2.cmml">𝐄</mi><mrow id="S3.E2.m1.3.4.2.2.2.3" xref="S3.E2.m1.3.4.2.2.2.3.cmml"><mi id="S3.E2.m1.3.4.2.2.2.3.2" xref="S3.E2.m1.3.4.2.2.2.3.2.cmml">x</mi><mo id="S3.E2.m1.3.4.2.2.2.3.1" xref="S3.E2.m1.3.4.2.2.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.4.2.2.2.3.3" xref="S3.E2.m1.3.4.2.2.2.3.3.cmml">𝒟</mi></mrow></msub><mo id="S3.E2.m1.3.4.2.2.1" xref="S3.E2.m1.3.4.2.2.1.cmml">⁢</mo><msub id="S3.E2.m1.3.4.2.2.3" xref="S3.E2.m1.3.4.2.2.3.cmml"><mi id="S3.E2.m1.3.4.2.2.3.2" xref="S3.E2.m1.3.4.2.2.3.2.cmml">𝐄</mi><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">𝐲</mi><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">∼</mo><mrow id="S3.E2.m1.1.1.1.4" xref="S3.E2.m1.1.1.1.4.cmml"><msub id="S3.E2.m1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.4.2.cmml"><mi id="S3.E2.m1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.4.2.2.cmml">π</mi><mi id="S3.E2.m1.1.1.1.4.2.3" xref="S3.E2.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo id="S3.E2.m1.1.1.1.4.1" xref="S3.E2.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.4.3.2" xref="S3.E2.m1.1.1.1.4.cmml"><mo id="S3.E2.m1.1.1.1.4.3.2.1" stretchy="false" xref="S3.E2.m1.1.1.1.4.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">x</mi><mo id="S3.E2.m1.1.1.1.4.3.2.2" stretchy="false" xref="S3.E2.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.E2.m1.3.4.2.2.1a" xref="S3.E2.m1.3.4.2.2.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.4.2.2.4" xref="S3.E2.m1.3.4.2.2.4.cmml">ℛ</mi></mrow></mrow><mo id="S3.E2.m1.3.4.1" xref="S3.E2.m1.3.4.1.cmml">⁢</mo><mrow id="S3.E2.m1.3.4.3.2" xref="S3.E2.m1.3.4.3.1.cmml"><mo id="S3.E2.m1.3.4.3.2.1" stretchy="false" xref="S3.E2.m1.3.4.3.1.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">x</mi><mo id="S3.E2.m1.3.4.3.2.2" xref="S3.E2.m1.3.4.3.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝐲</mi><mo id="S3.E2.m1.3.4.3.2.3" stretchy="false" xref="S3.E2.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.4.cmml" xref="S3.E2.m1.3.4"><times id="S3.E2.m1.3.4.1.cmml" xref="S3.E2.m1.3.4.1"></times><apply id="S3.E2.m1.3.4.2.cmml" xref="S3.E2.m1.3.4.2"><apply id="S3.E2.m1.3.4.2.1.cmml" xref="S3.E2.m1.3.4.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.2.1.1.cmml" xref="S3.E2.m1.3.4.2.1">subscript</csymbol><max id="S3.E2.m1.3.4.2.1.2.cmml" xref="S3.E2.m1.3.4.2.1.2"></max><ci id="S3.E2.m1.3.4.2.1.3.cmml" xref="S3.E2.m1.3.4.2.1.3">𝜃</ci></apply><apply id="S3.E2.m1.3.4.2.2.cmml" xref="S3.E2.m1.3.4.2.2"><times id="S3.E2.m1.3.4.2.2.1.cmml" xref="S3.E2.m1.3.4.2.2.1"></times><apply id="S3.E2.m1.3.4.2.2.2.cmml" xref="S3.E2.m1.3.4.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.2.2.2.1.cmml" xref="S3.E2.m1.3.4.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.4.2.2.2.2.cmml" xref="S3.E2.m1.3.4.2.2.2.2">𝐄</ci><apply id="S3.E2.m1.3.4.2.2.2.3.cmml" xref="S3.E2.m1.3.4.2.2.2.3"><csymbol cd="latexml" id="S3.E2.m1.3.4.2.2.2.3.1.cmml" xref="S3.E2.m1.3.4.2.2.2.3.1">similar-to</csymbol><ci id="S3.E2.m1.3.4.2.2.2.3.2.cmml" xref="S3.E2.m1.3.4.2.2.2.3.2">𝑥</ci><ci id="S3.E2.m1.3.4.2.2.2.3.3.cmml" xref="S3.E2.m1.3.4.2.2.2.3.3">𝒟</ci></apply></apply><apply id="S3.E2.m1.3.4.2.2.3.cmml" xref="S3.E2.m1.3.4.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.4.2.2.3.1.cmml" xref="S3.E2.m1.3.4.2.2.3">subscript</csymbol><ci id="S3.E2.m1.3.4.2.2.3.2.cmml" xref="S3.E2.m1.3.4.2.2.3.2">𝐄</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2">similar-to</csymbol><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝐲</ci><apply id="S3.E2.m1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.4"><times id="S3.E2.m1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.4.1"></times><apply id="S3.E2.m1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.1.1.1.4.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.1.1.1.4.2.2">𝜋</ci><ci id="S3.E2.m1.1.1.1.4.2.3.cmml" xref="S3.E2.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑥</ci></apply></apply></apply><ci id="S3.E2.m1.3.4.2.2.4.cmml" xref="S3.E2.m1.3.4.2.2.4">ℛ</ci></apply></apply><interval closure="open" id="S3.E2.m1.3.4.3.1.cmml" xref="S3.E2.m1.3.4.3.2"><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑥</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐲</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\max_{\theta}\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}\sim\pi_{%
\theta}(x)}\mathcal{R}(x,\mathbf{y})</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">roman_max start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT bold_E start_POSTSUBSCRIPT bold_y ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) end_POSTSUBSCRIPT caligraphic_R ( italic_x , bold_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.7">In our work, we consider a pre-trained encoder <math alttext="f_{\theta}:X\cup Z\rightarrow\mathbf{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p2.1.m1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mrow id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2.2" xref="S3.SS2.p2.1.m1.1.1.3.2.2.cmml">X</mi><mo id="S3.SS2.p2.1.m1.1.1.3.2.1" xref="S3.SS2.p2.1.m1.1.1.3.2.1.cmml">∪</mo><mi id="S3.SS2.p2.1.m1.1.1.3.2.3" xref="S3.SS2.p2.1.m1.1.1.3.2.3.cmml">Z</mi></mrow><mo id="S3.SS2.p2.1.m1.1.1.3.1" stretchy="false" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">→</mo><msup id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.3.2" xref="S3.SS2.p2.1.m1.1.1.3.3.2.cmml">𝐑</mi><mi id="S3.SS2.p2.1.m1.1.1.3.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><ci id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1">:</ci><apply id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2">𝑓</ci><ci id="S3.SS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3">𝜃</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><ci id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1">→</ci><apply id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2"><union id="S3.SS2.p2.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.1"></union><ci id="S3.SS2.p2.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2">𝑋</ci><ci id="S3.SS2.p2.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.3">𝑍</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.2">𝐑</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">f_{\theta}:X\cup Z\rightarrow\mathbf{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT : italic_X ∪ italic_Z → bold_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to correspond to the initial policy <math alttext="\pi_{\theta}^{0}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msubsup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">π</mi><mi id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">θ</mi><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝜋</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">𝜃</ci></apply><cn id="S3.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\pi_{\theta}^{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math>. For simplicity, given an encoder/policy at any stage of training, the top-k items <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">bold_y</annotation></semantics></math> are assumed to be independently sampled from the discrete action probability distribution,
<math alttext="\pi_{\theta}:X\rightarrow Z;\text{\ \ }y_{j}\sim\pi_{\theta}(z|x)\forall j\in%
\{1,2,3..k\}" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.4.m4.3"><semantics id="S3.SS2.p2.4.m4.3a"><mrow id="S3.SS2.p2.4.m4.3b"><msub id="S3.SS2.p2.4.m4.3.4"><mi id="S3.SS2.p2.4.m4.3.4.2">π</mi><mi id="S3.SS2.p2.4.m4.3.4.3">θ</mi></msub><mo id="S3.SS2.p2.4.m4.3.5" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.SS2.p2.4.m4.3.6">X</mi><mo id="S3.SS2.p2.4.m4.3.7" stretchy="false">→</mo><mi id="S3.SS2.p2.4.m4.3.8">Z</mi><mo id="S3.SS2.p2.4.m4.3.9">;</mo><mtext id="S3.SS2.p2.4.m4.3.10"> </mtext><msub id="S3.SS2.p2.4.m4.3.11"><mi id="S3.SS2.p2.4.m4.3.11.2">y</mi><mi id="S3.SS2.p2.4.m4.3.11.3">j</mi></msub><mo id="S3.SS2.p2.4.m4.3.12">∼</mo><msub id="S3.SS2.p2.4.m4.3.13"><mi id="S3.SS2.p2.4.m4.3.13.2">π</mi><mi id="S3.SS2.p2.4.m4.3.13.3">θ</mi></msub><mrow id="S3.SS2.p2.4.m4.3.14"><mo id="S3.SS2.p2.4.m4.3.14.1" stretchy="false">(</mo><mi id="S3.SS2.p2.4.m4.3.14.2">z</mi><mo fence="false" id="S3.SS2.p2.4.m4.3.14.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS2.p2.4.m4.3.14.4">x</mi><mo id="S3.SS2.p2.4.m4.3.14.5" rspace="0.167em" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.4.m4.3.15" rspace="0.167em">∀</mo><mi id="S3.SS2.p2.4.m4.3.16">j</mi><mo id="S3.SS2.p2.4.m4.3.17">∈</mo><mrow id="S3.SS2.p2.4.m4.3.18"><mo id="S3.SS2.p2.4.m4.3.18.1" stretchy="false">{</mo><mn id="S3.SS2.p2.4.m4.1.1">1</mn><mo id="S3.SS2.p2.4.m4.3.18.2">,</mo><mn id="S3.SS2.p2.4.m4.2.2">2</mn><mo id="S3.SS2.p2.4.m4.3.18.3">,</mo><mn id="S3.SS2.p2.4.m4.3.3">3</mn><mo id="S3.SS2.p2.4.m4.3.18.4" lspace="0em" rspace="0.0835em">.</mo><mo id="S3.SS2.p2.4.m4.3.18.5" lspace="0.0835em" rspace="0.167em">.</mo><mi id="S3.SS2.p2.4.m4.3.18.6">k</mi><mo id="S3.SS2.p2.4.m4.3.18.7" stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.3c">\pi_{\theta}:X\rightarrow Z;\text{\ \ }y_{j}\sim\pi_{\theta}(z|x)\forall j\in%
\{1,2,3..k\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.3d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT : italic_X → italic_Z ; italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_z | italic_x ) ∀ italic_j ∈ { 1 , 2 , 3 . . italic_k }</annotation></semantics></math>;
where <math alttext="\pi_{\theta}(z|x)=\operatorname{softmax}_{Z}\texttt{sim}(f(x),f(z))" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.5"><semantics id="S3.SS2.p2.5.m5.5a"><mrow id="S3.SS2.p2.5.m5.5.5" xref="S3.SS2.p2.5.m5.5.5.cmml"><mrow id="S3.SS2.p2.5.m5.3.3.1" xref="S3.SS2.p2.5.m5.3.3.1.cmml"><msub id="S3.SS2.p2.5.m5.3.3.1.3" xref="S3.SS2.p2.5.m5.3.3.1.3.cmml"><mi id="S3.SS2.p2.5.m5.3.3.1.3.2" xref="S3.SS2.p2.5.m5.3.3.1.3.2.cmml">π</mi><mi id="S3.SS2.p2.5.m5.3.3.1.3.3" xref="S3.SS2.p2.5.m5.3.3.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p2.5.m5.3.3.1.2" xref="S3.SS2.p2.5.m5.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m5.3.3.1.1.1" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.cmml"><mo id="S3.SS2.p2.5.m5.3.3.1.1.1.2" stretchy="false" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.5.m5.3.3.1.1.1.1" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p2.5.m5.3.3.1.1.1.1.2" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.SS2.p2.5.m5.3.3.1.1.1.1.1" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p2.5.m5.3.3.1.1.1.1.3" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS2.p2.5.m5.3.3.1.1.1.3" stretchy="false" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.5.m5.5.5.4" xref="S3.SS2.p2.5.m5.5.5.4.cmml">=</mo><mrow id="S3.SS2.p2.5.m5.5.5.3" xref="S3.SS2.p2.5.m5.5.5.3.cmml"><mrow id="S3.SS2.p2.5.m5.5.5.3.4" xref="S3.SS2.p2.5.m5.5.5.3.4.cmml"><msub id="S3.SS2.p2.5.m5.5.5.3.4.1" xref="S3.SS2.p2.5.m5.5.5.3.4.1.cmml"><mi id="S3.SS2.p2.5.m5.5.5.3.4.1.2" xref="S3.SS2.p2.5.m5.5.5.3.4.1.2.cmml">softmax</mi><mi id="S3.SS2.p2.5.m5.5.5.3.4.1.3" xref="S3.SS2.p2.5.m5.5.5.3.4.1.3.cmml">Z</mi></msub><mo id="S3.SS2.p2.5.m5.5.5.3.4a" lspace="0.167em" xref="S3.SS2.p2.5.m5.5.5.3.4.cmml">⁡</mo><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.5.m5.5.5.3.4.2" xref="S3.SS2.p2.5.m5.5.5.3.4.2a.cmml">sim</mtext></mrow><mo id="S3.SS2.p2.5.m5.5.5.3.3" xref="S3.SS2.p2.5.m5.5.5.3.3.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m5.5.5.3.2.2" xref="S3.SS2.p2.5.m5.5.5.3.2.3.cmml"><mo id="S3.SS2.p2.5.m5.5.5.3.2.2.3" stretchy="false" xref="S3.SS2.p2.5.m5.5.5.3.2.3.cmml">(</mo><mrow id="S3.SS2.p2.5.m5.4.4.2.1.1.1" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.cmml"><mi id="S3.SS2.p2.5.m5.4.4.2.1.1.1.2" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.2.cmml">f</mi><mo id="S3.SS2.p2.5.m5.4.4.2.1.1.1.1" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m5.4.4.2.1.1.1.3.2" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.cmml"><mo id="S3.SS2.p2.5.m5.4.4.2.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.cmml">(</mo><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">x</mi><mo id="S3.SS2.p2.5.m5.4.4.2.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.5.m5.5.5.3.2.2.4" xref="S3.SS2.p2.5.m5.5.5.3.2.3.cmml">,</mo><mrow id="S3.SS2.p2.5.m5.5.5.3.2.2.2" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.cmml"><mi id="S3.SS2.p2.5.m5.5.5.3.2.2.2.2" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.2.cmml">f</mi><mo id="S3.SS2.p2.5.m5.5.5.3.2.2.2.1" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.5.m5.5.5.3.2.2.2.3.2" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.cmml"><mo id="S3.SS2.p2.5.m5.5.5.3.2.2.2.3.2.1" stretchy="false" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.cmml">(</mo><mi id="S3.SS2.p2.5.m5.2.2" xref="S3.SS2.p2.5.m5.2.2.cmml">z</mi><mo id="S3.SS2.p2.5.m5.5.5.3.2.2.2.3.2.2" stretchy="false" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.5.m5.5.5.3.2.2.5" stretchy="false" xref="S3.SS2.p2.5.m5.5.5.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.5b"><apply id="S3.SS2.p2.5.m5.5.5.cmml" xref="S3.SS2.p2.5.m5.5.5"><eq id="S3.SS2.p2.5.m5.5.5.4.cmml" xref="S3.SS2.p2.5.m5.5.5.4"></eq><apply id="S3.SS2.p2.5.m5.3.3.1.cmml" xref="S3.SS2.p2.5.m5.3.3.1"><times id="S3.SS2.p2.5.m5.3.3.1.2.cmml" xref="S3.SS2.p2.5.m5.3.3.1.2"></times><apply id="S3.SS2.p2.5.m5.3.3.1.3.cmml" xref="S3.SS2.p2.5.m5.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.3.3.1.3.1.cmml" xref="S3.SS2.p2.5.m5.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p2.5.m5.3.3.1.3.2.cmml" xref="S3.SS2.p2.5.m5.3.3.1.3.2">𝜋</ci><ci id="S3.SS2.p2.5.m5.3.3.1.3.3.cmml" xref="S3.SS2.p2.5.m5.3.3.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p2.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS2.p2.5.m5.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.5.m5.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.5.m5.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.2">𝑧</ci><ci id="S3.SS2.p2.5.m5.3.3.1.1.1.1.3.cmml" xref="S3.SS2.p2.5.m5.3.3.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.SS2.p2.5.m5.5.5.3.cmml" xref="S3.SS2.p2.5.m5.5.5.3"><times id="S3.SS2.p2.5.m5.5.5.3.3.cmml" xref="S3.SS2.p2.5.m5.5.5.3.3"></times><apply id="S3.SS2.p2.5.m5.5.5.3.4.cmml" xref="S3.SS2.p2.5.m5.5.5.3.4"><apply id="S3.SS2.p2.5.m5.5.5.3.4.1.cmml" xref="S3.SS2.p2.5.m5.5.5.3.4.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.5.5.3.4.1.1.cmml" xref="S3.SS2.p2.5.m5.5.5.3.4.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.5.5.3.4.1.2.cmml" xref="S3.SS2.p2.5.m5.5.5.3.4.1.2">softmax</ci><ci id="S3.SS2.p2.5.m5.5.5.3.4.1.3.cmml" xref="S3.SS2.p2.5.m5.5.5.3.4.1.3">𝑍</ci></apply><ci id="S3.SS2.p2.5.m5.5.5.3.4.2a.cmml" xref="S3.SS2.p2.5.m5.5.5.3.4.2"><mtext class="ltx_mathvariant_monospace" id="S3.SS2.p2.5.m5.5.5.3.4.2.cmml" xref="S3.SS2.p2.5.m5.5.5.3.4.2">sim</mtext></ci></apply><interval closure="open" id="S3.SS2.p2.5.m5.5.5.3.2.3.cmml" xref="S3.SS2.p2.5.m5.5.5.3.2.2"><apply id="S3.SS2.p2.5.m5.4.4.2.1.1.1.cmml" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1"><times id="S3.SS2.p2.5.m5.4.4.2.1.1.1.1.cmml" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.1"></times><ci id="S3.SS2.p2.5.m5.4.4.2.1.1.1.2.cmml" xref="S3.SS2.p2.5.m5.4.4.2.1.1.1.2">𝑓</ci><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑥</ci></apply><apply id="S3.SS2.p2.5.m5.5.5.3.2.2.2.cmml" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2"><times id="S3.SS2.p2.5.m5.5.5.3.2.2.2.1.cmml" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.1"></times><ci id="S3.SS2.p2.5.m5.5.5.3.2.2.2.2.cmml" xref="S3.SS2.p2.5.m5.5.5.3.2.2.2.2">𝑓</ci><ci id="S3.SS2.p2.5.m5.2.2.cmml" xref="S3.SS2.p2.5.m5.2.2">𝑧</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.5c">\pi_{\theta}(z|x)=\operatorname{softmax}_{Z}\texttt{sim}(f(x),f(z))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.5d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_z | italic_x ) = roman_softmax start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT sim ( italic_f ( italic_x ) , italic_f ( italic_z ) )</annotation></semantics></math>. We use <math alttext="\pi_{\theta}(\mathbf{y}|x)" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mrow id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><msub id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml"><mi id="S3.SS2.p2.6.m6.1.1.3.2" xref="S3.SS2.p2.6.m6.1.1.3.2.cmml">π</mi><mi id="S3.SS2.p2.6.m6.1.1.3.3" xref="S3.SS2.p2.6.m6.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.6.m6.1.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.6.m6.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.6.m6.1.1.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.1.1.1.2" xref="S3.SS2.p2.6.m6.1.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S3.SS2.p2.6.m6.1.1.1.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p2.6.m6.1.1.1.1.1.3" xref="S3.SS2.p2.6.m6.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS2.p2.6.m6.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><times id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2"></times><apply id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.3.1.cmml" xref="S3.SS2.p2.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.3.2.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2">𝜋</ci><ci id="S3.SS2.p2.6.m6.1.1.3.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.1.1.1.2">𝐲</ci><ci id="S3.SS2.p2.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\pi_{\theta}(\mathbf{y}|x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y | italic_x )</annotation></semantics></math> to denote the top-k items generated using the <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">π</mi><mi id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">𝜋</ci><ci id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> policy.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">As in past work on using RL in recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib28" title="">2019</a>; Montazeralghaem et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib25" title="">2020</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib3" title="">2019</a>)</cite>, we use a policy gradient algorithm to optimize the novelty reward. Policy gradient algorithms are well-suited for recommender systems since they do not explicitly parameterize the action space (thus allowing a large number of actions) and can directly update the parameters of the encoder <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑓</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, we use the REINFORCE <cite class="ltx_cite ltx_citemacro_citep">(Williams, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib37" title="">1992</a>)</cite> algorithm that depends on a Monte Carlo approximation of the reward expectation from Eqn. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.E2" title="In 3.2. RL formulation using policy gradient ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}\sim\pi_{\theta}(x)}%
\mathcal{R}(x,\mathbf{y})\approx\frac{1}{B}\sum_{i=1}^{B}\mathcal{R}(x^{(i)},%
\mathbf{y}^{(i)})" class="ltx_Math" display="block" id="S3.E3.m1.7"><semantics id="S3.E3.m1.7a"><mrow id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml"><mrow id="S3.E3.m1.7.7.4" xref="S3.E3.m1.7.7.4.cmml"><msub id="S3.E3.m1.7.7.4.2" xref="S3.E3.m1.7.7.4.2.cmml"><mi id="S3.E3.m1.7.7.4.2.2" xref="S3.E3.m1.7.7.4.2.2.cmml">𝐄</mi><mrow id="S3.E3.m1.7.7.4.2.3" xref="S3.E3.m1.7.7.4.2.3.cmml"><mi id="S3.E3.m1.7.7.4.2.3.2" xref="S3.E3.m1.7.7.4.2.3.2.cmml">x</mi><mo id="S3.E3.m1.7.7.4.2.3.1" xref="S3.E3.m1.7.7.4.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.7.7.4.2.3.3" xref="S3.E3.m1.7.7.4.2.3.3.cmml">𝒟</mi></mrow></msub><mo id="S3.E3.m1.7.7.4.1" xref="S3.E3.m1.7.7.4.1.cmml">⁢</mo><msub id="S3.E3.m1.7.7.4.3" xref="S3.E3.m1.7.7.4.3.cmml"><mi id="S3.E3.m1.7.7.4.3.2" xref="S3.E3.m1.7.7.4.3.2.cmml">𝐄</mi><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">𝐲</mi><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">∼</mo><mrow id="S3.E3.m1.1.1.1.4" xref="S3.E3.m1.1.1.1.4.cmml"><msub id="S3.E3.m1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.4.2.cmml"><mi id="S3.E3.m1.1.1.1.4.2.2" xref="S3.E3.m1.1.1.1.4.2.2.cmml">π</mi><mi id="S3.E3.m1.1.1.1.4.2.3" xref="S3.E3.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo id="S3.E3.m1.1.1.1.4.1" xref="S3.E3.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.4.3.2" xref="S3.E3.m1.1.1.1.4.cmml"><mo id="S3.E3.m1.1.1.1.4.3.2.1" stretchy="false" xref="S3.E3.m1.1.1.1.4.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">x</mi><mo id="S3.E3.m1.1.1.1.4.3.2.2" stretchy="false" xref="S3.E3.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.E3.m1.7.7.4.1a" xref="S3.E3.m1.7.7.4.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.7.7.4.4" xref="S3.E3.m1.7.7.4.4.cmml">ℛ</mi><mo id="S3.E3.m1.7.7.4.1b" xref="S3.E3.m1.7.7.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.7.7.4.5.2" xref="S3.E3.m1.7.7.4.5.1.cmml"><mo id="S3.E3.m1.7.7.4.5.2.1" stretchy="false" xref="S3.E3.m1.7.7.4.5.1.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">x</mi><mo id="S3.E3.m1.7.7.4.5.2.2" xref="S3.E3.m1.7.7.4.5.1.cmml">,</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">𝐲</mi><mo id="S3.E3.m1.7.7.4.5.2.3" stretchy="false" xref="S3.E3.m1.7.7.4.5.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.7.7.3" xref="S3.E3.m1.7.7.3.cmml">≈</mo><mrow id="S3.E3.m1.7.7.2" xref="S3.E3.m1.7.7.2.cmml"><mfrac id="S3.E3.m1.7.7.2.4" xref="S3.E3.m1.7.7.2.4.cmml"><mn id="S3.E3.m1.7.7.2.4.2" xref="S3.E3.m1.7.7.2.4.2.cmml">1</mn><mi id="S3.E3.m1.7.7.2.4.3" xref="S3.E3.m1.7.7.2.4.3.cmml">B</mi></mfrac><mo id="S3.E3.m1.7.7.2.3" xref="S3.E3.m1.7.7.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.7.7.2.2" xref="S3.E3.m1.7.7.2.2.cmml"><munderover id="S3.E3.m1.7.7.2.2.3" xref="S3.E3.m1.7.7.2.2.3.cmml"><mo id="S3.E3.m1.7.7.2.2.3.2.2" movablelimits="false" xref="S3.E3.m1.7.7.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.7.7.2.2.3.2.3" xref="S3.E3.m1.7.7.2.2.3.2.3.cmml"><mi id="S3.E3.m1.7.7.2.2.3.2.3.2" xref="S3.E3.m1.7.7.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E3.m1.7.7.2.2.3.2.3.1" xref="S3.E3.m1.7.7.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.7.7.2.2.3.2.3.3" xref="S3.E3.m1.7.7.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.7.7.2.2.3.3" xref="S3.E3.m1.7.7.2.2.3.3.cmml">B</mi></munderover><mrow id="S3.E3.m1.7.7.2.2.2" xref="S3.E3.m1.7.7.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.7.7.2.2.2.4" xref="S3.E3.m1.7.7.2.2.2.4.cmml">ℛ</mi><mo id="S3.E3.m1.7.7.2.2.2.3" xref="S3.E3.m1.7.7.2.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.7.7.2.2.2.2.2" xref="S3.E3.m1.7.7.2.2.2.2.3.cmml"><mo id="S3.E3.m1.7.7.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.2.3.cmml">(</mo><msup id="S3.E3.m1.6.6.1.1.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.1.1.2" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.3.1" stretchy="false" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">i</mi><mo id="S3.E3.m1.2.2.1.3.2" stretchy="false" xref="S3.E3.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E3.m1.7.7.2.2.2.2.2.4" xref="S3.E3.m1.7.7.2.2.2.2.3.cmml">,</mo><msup id="S3.E3.m1.7.7.2.2.2.2.2.2" xref="S3.E3.m1.7.7.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.7.7.2.2.2.2.2.2.2" xref="S3.E3.m1.7.7.2.2.2.2.2.2.2.cmml">𝐲</mi><mrow id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.7.7.2.2.2.2.2.2.cmml"><mo id="S3.E3.m1.3.3.1.3.1" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.2.2.2.cmml">(</mo><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">i</mi><mo id="S3.E3.m1.3.3.1.3.2" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.E3.m1.7.7.2.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.7.7.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.7b"><apply id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7"><approx id="S3.E3.m1.7.7.3.cmml" xref="S3.E3.m1.7.7.3"></approx><apply id="S3.E3.m1.7.7.4.cmml" xref="S3.E3.m1.7.7.4"><times id="S3.E3.m1.7.7.4.1.cmml" xref="S3.E3.m1.7.7.4.1"></times><apply id="S3.E3.m1.7.7.4.2.cmml" xref="S3.E3.m1.7.7.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.4.2.1.cmml" xref="S3.E3.m1.7.7.4.2">subscript</csymbol><ci id="S3.E3.m1.7.7.4.2.2.cmml" xref="S3.E3.m1.7.7.4.2.2">𝐄</ci><apply id="S3.E3.m1.7.7.4.2.3.cmml" xref="S3.E3.m1.7.7.4.2.3"><csymbol cd="latexml" id="S3.E3.m1.7.7.4.2.3.1.cmml" xref="S3.E3.m1.7.7.4.2.3.1">similar-to</csymbol><ci id="S3.E3.m1.7.7.4.2.3.2.cmml" xref="S3.E3.m1.7.7.4.2.3.2">𝑥</ci><ci id="S3.E3.m1.7.7.4.2.3.3.cmml" xref="S3.E3.m1.7.7.4.2.3.3">𝒟</ci></apply></apply><apply id="S3.E3.m1.7.7.4.3.cmml" xref="S3.E3.m1.7.7.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.4.3.1.cmml" xref="S3.E3.m1.7.7.4.3">subscript</csymbol><ci id="S3.E3.m1.7.7.4.3.2.cmml" xref="S3.E3.m1.7.7.4.3.2">𝐄</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2">similar-to</csymbol><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝐲</ci><apply id="S3.E3.m1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.4"><times id="S3.E3.m1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.4.1"></times><apply id="S3.E3.m1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.1.1.1.4.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.1.1.1.4.2.2">𝜋</ci><ci id="S3.E3.m1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑥</ci></apply></apply></apply><ci id="S3.E3.m1.7.7.4.4.cmml" xref="S3.E3.m1.7.7.4.4">ℛ</ci><interval closure="open" id="S3.E3.m1.7.7.4.5.1.cmml" xref="S3.E3.m1.7.7.4.5.2"><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑥</ci><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝐲</ci></interval></apply><apply id="S3.E3.m1.7.7.2.cmml" xref="S3.E3.m1.7.7.2"><times id="S3.E3.m1.7.7.2.3.cmml" xref="S3.E3.m1.7.7.2.3"></times><apply id="S3.E3.m1.7.7.2.4.cmml" xref="S3.E3.m1.7.7.2.4"><divide id="S3.E3.m1.7.7.2.4.1.cmml" xref="S3.E3.m1.7.7.2.4"></divide><cn id="S3.E3.m1.7.7.2.4.2.cmml" type="integer" xref="S3.E3.m1.7.7.2.4.2">1</cn><ci id="S3.E3.m1.7.7.2.4.3.cmml" xref="S3.E3.m1.7.7.2.4.3">𝐵</ci></apply><apply id="S3.E3.m1.7.7.2.2.cmml" xref="S3.E3.m1.7.7.2.2"><apply id="S3.E3.m1.7.7.2.2.3.cmml" xref="S3.E3.m1.7.7.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.3.1.cmml" xref="S3.E3.m1.7.7.2.2.3">superscript</csymbol><apply id="S3.E3.m1.7.7.2.2.3.2.cmml" xref="S3.E3.m1.7.7.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.3.2.1.cmml" xref="S3.E3.m1.7.7.2.2.3">subscript</csymbol><sum id="S3.E3.m1.7.7.2.2.3.2.2.cmml" xref="S3.E3.m1.7.7.2.2.3.2.2"></sum><apply id="S3.E3.m1.7.7.2.2.3.2.3.cmml" xref="S3.E3.m1.7.7.2.2.3.2.3"><eq id="S3.E3.m1.7.7.2.2.3.2.3.1.cmml" xref="S3.E3.m1.7.7.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.7.7.2.2.3.2.3.2.cmml" xref="S3.E3.m1.7.7.2.2.3.2.3.2">𝑖</ci><cn id="S3.E3.m1.7.7.2.2.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.7.7.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.7.7.2.2.3.3.cmml" xref="S3.E3.m1.7.7.2.2.3.3">𝐵</ci></apply><apply id="S3.E3.m1.7.7.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2"><times id="S3.E3.m1.7.7.2.2.2.3.cmml" xref="S3.E3.m1.7.7.2.2.2.3"></times><ci id="S3.E3.m1.7.7.2.2.2.4.cmml" xref="S3.E3.m1.7.7.2.2.2.4">ℛ</ci><interval closure="open" id="S3.E3.m1.7.7.2.2.2.2.3.cmml" xref="S3.E3.m1.7.7.2.2.2.2.2"><apply id="S3.E3.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.E3.m1.7.7.2.2.2.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.7.7.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E3.m1.7.7.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.2.2.2.2">𝐲</ci><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.7c">\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}\sim\pi_{\theta}(x)}%
\mathcal{R}(x,\mathbf{y})\approx\frac{1}{B}\sum_{i=1}^{B}\mathcal{R}(x^{(i)},%
\mathbf{y}^{(i)})</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.7d">bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT bold_E start_POSTSUBSCRIPT bold_y ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) end_POSTSUBSCRIPT caligraphic_R ( italic_x , bold_y ) ≈ divide start_ARG 1 end_ARG start_ARG italic_B end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT caligraphic_R ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.1">where <math alttext="y^{(i)}_{j}\sim\pi_{\theta}(x^{(i)})\forall j\in\{1,2,3,\cdots,k\}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.8"><semantics id="S3.SS2.p4.1.m1.8a"><mrow id="S3.SS2.p4.1.m1.8.8" xref="S3.SS2.p4.1.m1.8.8.cmml"><msubsup id="S3.SS2.p4.1.m1.8.8.3" xref="S3.SS2.p4.1.m1.8.8.3.cmml"><mi id="S3.SS2.p4.1.m1.8.8.3.2.2" xref="S3.SS2.p4.1.m1.8.8.3.2.2.cmml">y</mi><mi id="S3.SS2.p4.1.m1.8.8.3.3" xref="S3.SS2.p4.1.m1.8.8.3.3.cmml">j</mi><mrow id="S3.SS2.p4.1.m1.1.1.1.3" xref="S3.SS2.p4.1.m1.8.8.3.cmml"><mo id="S3.SS2.p4.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.3.cmml">(</mo><mi id="S3.SS2.p4.1.m1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p4.1.m1.8.8.4" xref="S3.SS2.p4.1.m1.8.8.4.cmml">∼</mo><mrow id="S3.SS2.p4.1.m1.8.8.1" xref="S3.SS2.p4.1.m1.8.8.1.cmml"><msub id="S3.SS2.p4.1.m1.8.8.1.3" xref="S3.SS2.p4.1.m1.8.8.1.3.cmml"><mi id="S3.SS2.p4.1.m1.8.8.1.3.2" xref="S3.SS2.p4.1.m1.8.8.1.3.2.cmml">π</mi><mi id="S3.SS2.p4.1.m1.8.8.1.3.3" xref="S3.SS2.p4.1.m1.8.8.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p4.1.m1.8.8.1.2" xref="S3.SS2.p4.1.m1.8.8.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.1.m1.8.8.1.1.1" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml"><mo id="S3.SS2.p4.1.m1.8.8.1.1.1.2" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml">(</mo><msup id="S3.SS2.p4.1.m1.8.8.1.1.1.1" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.8.8.1.1.1.1.2" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS2.p4.1.m1.2.2.1.3" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml"><mo id="S3.SS2.p4.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml">(</mo><mi id="S3.SS2.p4.1.m1.2.2.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.cmml">i</mi><mo id="S3.SS2.p4.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p4.1.m1.8.8.1.1.1.3" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.p4.1.m1.8.8.1.2a" lspace="0.167em" xref="S3.SS2.p4.1.m1.8.8.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.1.m1.8.8.1.4" xref="S3.SS2.p4.1.m1.8.8.1.4.cmml"><mo id="S3.SS2.p4.1.m1.8.8.1.4.1" rspace="0.167em" xref="S3.SS2.p4.1.m1.8.8.1.4.1.cmml">∀</mo><mi id="S3.SS2.p4.1.m1.8.8.1.4.2" xref="S3.SS2.p4.1.m1.8.8.1.4.2.cmml">j</mi></mrow></mrow><mo id="S3.SS2.p4.1.m1.8.8.5" xref="S3.SS2.p4.1.m1.8.8.5.cmml">∈</mo><mrow id="S3.SS2.p4.1.m1.8.8.6.2" xref="S3.SS2.p4.1.m1.8.8.6.1.cmml"><mo id="S3.SS2.p4.1.m1.8.8.6.2.1" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.6.1.cmml">{</mo><mn id="S3.SS2.p4.1.m1.3.3" xref="S3.SS2.p4.1.m1.3.3.cmml">1</mn><mo id="S3.SS2.p4.1.m1.8.8.6.2.2" xref="S3.SS2.p4.1.m1.8.8.6.1.cmml">,</mo><mn id="S3.SS2.p4.1.m1.4.4" xref="S3.SS2.p4.1.m1.4.4.cmml">2</mn><mo id="S3.SS2.p4.1.m1.8.8.6.2.3" xref="S3.SS2.p4.1.m1.8.8.6.1.cmml">,</mo><mn id="S3.SS2.p4.1.m1.5.5" xref="S3.SS2.p4.1.m1.5.5.cmml">3</mn><mo id="S3.SS2.p4.1.m1.8.8.6.2.4" xref="S3.SS2.p4.1.m1.8.8.6.1.cmml">,</mo><mi id="S3.SS2.p4.1.m1.6.6" mathvariant="normal" xref="S3.SS2.p4.1.m1.6.6.cmml">⋯</mi><mo id="S3.SS2.p4.1.m1.8.8.6.2.5" xref="S3.SS2.p4.1.m1.8.8.6.1.cmml">,</mo><mi id="S3.SS2.p4.1.m1.7.7" xref="S3.SS2.p4.1.m1.7.7.cmml">k</mi><mo id="S3.SS2.p4.1.m1.8.8.6.2.6" stretchy="false" xref="S3.SS2.p4.1.m1.8.8.6.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.8b"><apply id="S3.SS2.p4.1.m1.8.8.cmml" xref="S3.SS2.p4.1.m1.8.8"><and id="S3.SS2.p4.1.m1.8.8a.cmml" xref="S3.SS2.p4.1.m1.8.8"></and><apply id="S3.SS2.p4.1.m1.8.8b.cmml" xref="S3.SS2.p4.1.m1.8.8"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.8.8.4.cmml" xref="S3.SS2.p4.1.m1.8.8.4">similar-to</csymbol><apply id="S3.SS2.p4.1.m1.8.8.3.cmml" xref="S3.SS2.p4.1.m1.8.8.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.8.8.3.1.cmml" xref="S3.SS2.p4.1.m1.8.8.3">subscript</csymbol><apply id="S3.SS2.p4.1.m1.8.8.3.2.cmml" xref="S3.SS2.p4.1.m1.8.8.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.8.8.3.2.1.cmml" xref="S3.SS2.p4.1.m1.8.8.3">superscript</csymbol><ci id="S3.SS2.p4.1.m1.8.8.3.2.2.cmml" xref="S3.SS2.p4.1.m1.8.8.3.2.2">𝑦</ci><ci id="S3.SS2.p4.1.m1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.SS2.p4.1.m1.8.8.3.3.cmml" xref="S3.SS2.p4.1.m1.8.8.3.3">𝑗</ci></apply><apply id="S3.SS2.p4.1.m1.8.8.1.cmml" xref="S3.SS2.p4.1.m1.8.8.1"><times id="S3.SS2.p4.1.m1.8.8.1.2.cmml" xref="S3.SS2.p4.1.m1.8.8.1.2"></times><apply id="S3.SS2.p4.1.m1.8.8.1.3.cmml" xref="S3.SS2.p4.1.m1.8.8.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.8.8.1.3.1.cmml" xref="S3.SS2.p4.1.m1.8.8.1.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.8.8.1.3.2.cmml" xref="S3.SS2.p4.1.m1.8.8.1.3.2">𝜋</ci><ci id="S3.SS2.p4.1.m1.8.8.1.3.3.cmml" xref="S3.SS2.p4.1.m1.8.8.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p4.1.m1.8.8.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.8.8.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.8.8.1.1.1">superscript</csymbol><ci id="S3.SS2.p4.1.m1.8.8.1.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.8.8.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.SS2.p4.1.m1.8.8.1.4.cmml" xref="S3.SS2.p4.1.m1.8.8.1.4"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.8.8.1.4.1.cmml" xref="S3.SS2.p4.1.m1.8.8.1.4.1">for-all</csymbol><ci id="S3.SS2.p4.1.m1.8.8.1.4.2.cmml" xref="S3.SS2.p4.1.m1.8.8.1.4.2">𝑗</ci></apply></apply></apply><apply id="S3.SS2.p4.1.m1.8.8c.cmml" xref="S3.SS2.p4.1.m1.8.8"><in id="S3.SS2.p4.1.m1.8.8.5.cmml" xref="S3.SS2.p4.1.m1.8.8.5"></in><share href="https://arxiv.org/html/2406.14169v1#S3.SS2.p4.1.m1.8.8.1.cmml" id="S3.SS2.p4.1.m1.8.8d.cmml" xref="S3.SS2.p4.1.m1.8.8"></share><set id="S3.SS2.p4.1.m1.8.8.6.1.cmml" xref="S3.SS2.p4.1.m1.8.8.6.2"><cn id="S3.SS2.p4.1.m1.3.3.cmml" type="integer" xref="S3.SS2.p4.1.m1.3.3">1</cn><cn id="S3.SS2.p4.1.m1.4.4.cmml" type="integer" xref="S3.SS2.p4.1.m1.4.4">2</cn><cn id="S3.SS2.p4.1.m1.5.5.cmml" type="integer" xref="S3.SS2.p4.1.m1.5.5">3</cn><ci id="S3.SS2.p4.1.m1.6.6.cmml" xref="S3.SS2.p4.1.m1.6.6">⋯</ci><ci id="S3.SS2.p4.1.m1.7.7.cmml" xref="S3.SS2.p4.1.m1.7.7">𝑘</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.8c">y^{(i)}_{j}\sim\pi_{\theta}(x^{(i)})\forall j\in\{1,2,3,\cdots,k\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.8d">italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ∀ italic_j ∈ { 1 , 2 , 3 , ⋯ , italic_k }</annotation></semantics></math> and B is the batch size. The loss gradient is given by,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla" class="ltx_Math" display="inline" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mo id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">∇</mo><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">∇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle\nabla</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">∇</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}\sim\pi_{%
\theta}(x)}\mathcal{R}(x,\mathbf{y})=\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{%
\mathbf{y}\sim\pi_{\theta}(x)}\mathcal{R}(x,\mathbf{y})\nabla\log{\pi_{\theta}%
(\mathbf{y}|x)}" class="ltx_Math" display="inline" id="S3.Ex2.m2.7"><semantics id="S3.Ex2.m2.7a"><mrow id="S3.Ex2.m2.7.7" xref="S3.Ex2.m2.7.7.cmml"><mrow id="S3.Ex2.m2.7.7.3" xref="S3.Ex2.m2.7.7.3.cmml"><msub id="S3.Ex2.m2.7.7.3.2" xref="S3.Ex2.m2.7.7.3.2.cmml"><mi id="S3.Ex2.m2.7.7.3.2.2" xref="S3.Ex2.m2.7.7.3.2.2.cmml">𝐄</mi><mrow id="S3.Ex2.m2.7.7.3.2.3" xref="S3.Ex2.m2.7.7.3.2.3.cmml"><mi id="S3.Ex2.m2.7.7.3.2.3.2" xref="S3.Ex2.m2.7.7.3.2.3.2.cmml">x</mi><mo id="S3.Ex2.m2.7.7.3.2.3.1" xref="S3.Ex2.m2.7.7.3.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m2.7.7.3.2.3.3" xref="S3.Ex2.m2.7.7.3.2.3.3.cmml">𝒟</mi></mrow></msub><mo id="S3.Ex2.m2.7.7.3.1" xref="S3.Ex2.m2.7.7.3.1.cmml">⁢</mo><msub id="S3.Ex2.m2.7.7.3.3" xref="S3.Ex2.m2.7.7.3.3.cmml"><mi id="S3.Ex2.m2.7.7.3.3.2" xref="S3.Ex2.m2.7.7.3.3.2.cmml">𝐄</mi><mrow id="S3.Ex2.m2.1.1.1" xref="S3.Ex2.m2.1.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.3" xref="S3.Ex2.m2.1.1.1.3.cmml">𝐲</mi><mo id="S3.Ex2.m2.1.1.1.2" xref="S3.Ex2.m2.1.1.1.2.cmml">∼</mo><mrow id="S3.Ex2.m2.1.1.1.4" xref="S3.Ex2.m2.1.1.1.4.cmml"><msub id="S3.Ex2.m2.1.1.1.4.2" xref="S3.Ex2.m2.1.1.1.4.2.cmml"><mi id="S3.Ex2.m2.1.1.1.4.2.2" xref="S3.Ex2.m2.1.1.1.4.2.2.cmml">π</mi><mi id="S3.Ex2.m2.1.1.1.4.2.3" xref="S3.Ex2.m2.1.1.1.4.2.3.cmml">θ</mi></msub><mo id="S3.Ex2.m2.1.1.1.4.1" xref="S3.Ex2.m2.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.Ex2.m2.1.1.1.4.3.2" xref="S3.Ex2.m2.1.1.1.4.cmml"><mo id="S3.Ex2.m2.1.1.1.4.3.2.1" stretchy="false" xref="S3.Ex2.m2.1.1.1.4.cmml">(</mo><mi id="S3.Ex2.m2.1.1.1.1" xref="S3.Ex2.m2.1.1.1.1.cmml">x</mi><mo id="S3.Ex2.m2.1.1.1.4.3.2.2" stretchy="false" xref="S3.Ex2.m2.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.Ex2.m2.7.7.3.1a" xref="S3.Ex2.m2.7.7.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m2.7.7.3.4" xref="S3.Ex2.m2.7.7.3.4.cmml">ℛ</mi><mo id="S3.Ex2.m2.7.7.3.1b" xref="S3.Ex2.m2.7.7.3.1.cmml">⁢</mo><mrow id="S3.Ex2.m2.7.7.3.5.2" xref="S3.Ex2.m2.7.7.3.5.1.cmml"><mo id="S3.Ex2.m2.7.7.3.5.2.1" stretchy="false" xref="S3.Ex2.m2.7.7.3.5.1.cmml">(</mo><mi id="S3.Ex2.m2.3.3" xref="S3.Ex2.m2.3.3.cmml">x</mi><mo id="S3.Ex2.m2.7.7.3.5.2.2" xref="S3.Ex2.m2.7.7.3.5.1.cmml">,</mo><mi id="S3.Ex2.m2.4.4" xref="S3.Ex2.m2.4.4.cmml">𝐲</mi><mo id="S3.Ex2.m2.7.7.3.5.2.3" stretchy="false" xref="S3.Ex2.m2.7.7.3.5.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m2.7.7.2" xref="S3.Ex2.m2.7.7.2.cmml">=</mo><mrow id="S3.Ex2.m2.7.7.1" xref="S3.Ex2.m2.7.7.1.cmml"><msub id="S3.Ex2.m2.7.7.1.3" xref="S3.Ex2.m2.7.7.1.3.cmml"><mi id="S3.Ex2.m2.7.7.1.3.2" xref="S3.Ex2.m2.7.7.1.3.2.cmml">𝐄</mi><mrow id="S3.Ex2.m2.7.7.1.3.3" xref="S3.Ex2.m2.7.7.1.3.3.cmml"><mi id="S3.Ex2.m2.7.7.1.3.3.2" xref="S3.Ex2.m2.7.7.1.3.3.2.cmml">x</mi><mo id="S3.Ex2.m2.7.7.1.3.3.1" xref="S3.Ex2.m2.7.7.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m2.7.7.1.3.3.3" xref="S3.Ex2.m2.7.7.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="S3.Ex2.m2.7.7.1.2" xref="S3.Ex2.m2.7.7.1.2.cmml">⁢</mo><msub id="S3.Ex2.m2.7.7.1.4" xref="S3.Ex2.m2.7.7.1.4.cmml"><mi id="S3.Ex2.m2.7.7.1.4.2" xref="S3.Ex2.m2.7.7.1.4.2.cmml">𝐄</mi><mrow id="S3.Ex2.m2.2.2.1" xref="S3.Ex2.m2.2.2.1.cmml"><mi id="S3.Ex2.m2.2.2.1.3" xref="S3.Ex2.m2.2.2.1.3.cmml">𝐲</mi><mo id="S3.Ex2.m2.2.2.1.2" xref="S3.Ex2.m2.2.2.1.2.cmml">∼</mo><mrow id="S3.Ex2.m2.2.2.1.4" xref="S3.Ex2.m2.2.2.1.4.cmml"><msub id="S3.Ex2.m2.2.2.1.4.2" xref="S3.Ex2.m2.2.2.1.4.2.cmml"><mi id="S3.Ex2.m2.2.2.1.4.2.2" xref="S3.Ex2.m2.2.2.1.4.2.2.cmml">π</mi><mi id="S3.Ex2.m2.2.2.1.4.2.3" xref="S3.Ex2.m2.2.2.1.4.2.3.cmml">θ</mi></msub><mo id="S3.Ex2.m2.2.2.1.4.1" xref="S3.Ex2.m2.2.2.1.4.1.cmml">⁢</mo><mrow id="S3.Ex2.m2.2.2.1.4.3.2" xref="S3.Ex2.m2.2.2.1.4.cmml"><mo id="S3.Ex2.m2.2.2.1.4.3.2.1" stretchy="false" xref="S3.Ex2.m2.2.2.1.4.cmml">(</mo><mi id="S3.Ex2.m2.2.2.1.1" xref="S3.Ex2.m2.2.2.1.1.cmml">x</mi><mo id="S3.Ex2.m2.2.2.1.4.3.2.2" stretchy="false" xref="S3.Ex2.m2.2.2.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.Ex2.m2.7.7.1.2a" xref="S3.Ex2.m2.7.7.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m2.7.7.1.5" xref="S3.Ex2.m2.7.7.1.5.cmml">ℛ</mi><mo id="S3.Ex2.m2.7.7.1.2b" xref="S3.Ex2.m2.7.7.1.2.cmml">⁢</mo><mrow id="S3.Ex2.m2.7.7.1.6.2" xref="S3.Ex2.m2.7.7.1.6.1.cmml"><mo id="S3.Ex2.m2.7.7.1.6.2.1" stretchy="false" xref="S3.Ex2.m2.7.7.1.6.1.cmml">(</mo><mi id="S3.Ex2.m2.5.5" xref="S3.Ex2.m2.5.5.cmml">x</mi><mo id="S3.Ex2.m2.7.7.1.6.2.2" xref="S3.Ex2.m2.7.7.1.6.1.cmml">,</mo><mi id="S3.Ex2.m2.6.6" xref="S3.Ex2.m2.6.6.cmml">𝐲</mi><mo id="S3.Ex2.m2.7.7.1.6.2.3" stretchy="false" xref="S3.Ex2.m2.7.7.1.6.1.cmml">)</mo></mrow><mo id="S3.Ex2.m2.7.7.1.2c" lspace="0.167em" xref="S3.Ex2.m2.7.7.1.2.cmml">⁢</mo><mrow id="S3.Ex2.m2.7.7.1.7" xref="S3.Ex2.m2.7.7.1.7.cmml"><mrow id="S3.Ex2.m2.7.7.1.7.1" xref="S3.Ex2.m2.7.7.1.7.1.cmml"><mo id="S3.Ex2.m2.7.7.1.7.1.1" rspace="0.167em" xref="S3.Ex2.m2.7.7.1.7.1.1.cmml">∇</mo><mi id="S3.Ex2.m2.7.7.1.7.1.2" xref="S3.Ex2.m2.7.7.1.7.1.2.cmml">log</mi></mrow><mo id="S3.Ex2.m2.7.7.1.7a" lspace="0.167em" xref="S3.Ex2.m2.7.7.1.7.cmml">⁡</mo><msub id="S3.Ex2.m2.7.7.1.7.2" xref="S3.Ex2.m2.7.7.1.7.2.cmml"><mi id="S3.Ex2.m2.7.7.1.7.2.2" xref="S3.Ex2.m2.7.7.1.7.2.2.cmml">π</mi><mi id="S3.Ex2.m2.7.7.1.7.2.3" xref="S3.Ex2.m2.7.7.1.7.2.3.cmml">θ</mi></msub></mrow><mo id="S3.Ex2.m2.7.7.1.2d" xref="S3.Ex2.m2.7.7.1.2.cmml">⁢</mo><mrow id="S3.Ex2.m2.7.7.1.1.1" xref="S3.Ex2.m2.7.7.1.1.1.1.cmml"><mo id="S3.Ex2.m2.7.7.1.1.1.2" stretchy="false" xref="S3.Ex2.m2.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m2.7.7.1.1.1.1" xref="S3.Ex2.m2.7.7.1.1.1.1.cmml"><mi id="S3.Ex2.m2.7.7.1.1.1.1.2" xref="S3.Ex2.m2.7.7.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S3.Ex2.m2.7.7.1.1.1.1.1" xref="S3.Ex2.m2.7.7.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex2.m2.7.7.1.1.1.1.3" xref="S3.Ex2.m2.7.7.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex2.m2.7.7.1.1.1.3" stretchy="false" xref="S3.Ex2.m2.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m2.7b"><apply id="S3.Ex2.m2.7.7.cmml" xref="S3.Ex2.m2.7.7"><eq id="S3.Ex2.m2.7.7.2.cmml" xref="S3.Ex2.m2.7.7.2"></eq><apply id="S3.Ex2.m2.7.7.3.cmml" xref="S3.Ex2.m2.7.7.3"><times id="S3.Ex2.m2.7.7.3.1.cmml" xref="S3.Ex2.m2.7.7.3.1"></times><apply id="S3.Ex2.m2.7.7.3.2.cmml" xref="S3.Ex2.m2.7.7.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.7.7.3.2.1.cmml" xref="S3.Ex2.m2.7.7.3.2">subscript</csymbol><ci id="S3.Ex2.m2.7.7.3.2.2.cmml" xref="S3.Ex2.m2.7.7.3.2.2">𝐄</ci><apply id="S3.Ex2.m2.7.7.3.2.3.cmml" xref="S3.Ex2.m2.7.7.3.2.3"><csymbol cd="latexml" id="S3.Ex2.m2.7.7.3.2.3.1.cmml" xref="S3.Ex2.m2.7.7.3.2.3.1">similar-to</csymbol><ci id="S3.Ex2.m2.7.7.3.2.3.2.cmml" xref="S3.Ex2.m2.7.7.3.2.3.2">𝑥</ci><ci id="S3.Ex2.m2.7.7.3.2.3.3.cmml" xref="S3.Ex2.m2.7.7.3.2.3.3">𝒟</ci></apply></apply><apply id="S3.Ex2.m2.7.7.3.3.cmml" xref="S3.Ex2.m2.7.7.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.7.7.3.3.1.cmml" xref="S3.Ex2.m2.7.7.3.3">subscript</csymbol><ci id="S3.Ex2.m2.7.7.3.3.2.cmml" xref="S3.Ex2.m2.7.7.3.3.2">𝐄</ci><apply id="S3.Ex2.m2.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m2.1.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.2">similar-to</csymbol><ci id="S3.Ex2.m2.1.1.1.3.cmml" xref="S3.Ex2.m2.1.1.1.3">𝐲</ci><apply id="S3.Ex2.m2.1.1.1.4.cmml" xref="S3.Ex2.m2.1.1.1.4"><times id="S3.Ex2.m2.1.1.1.4.1.cmml" xref="S3.Ex2.m2.1.1.1.4.1"></times><apply id="S3.Ex2.m2.1.1.1.4.2.cmml" xref="S3.Ex2.m2.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.1.1.1.4.2.1.cmml" xref="S3.Ex2.m2.1.1.1.4.2">subscript</csymbol><ci id="S3.Ex2.m2.1.1.1.4.2.2.cmml" xref="S3.Ex2.m2.1.1.1.4.2.2">𝜋</ci><ci id="S3.Ex2.m2.1.1.1.4.2.3.cmml" xref="S3.Ex2.m2.1.1.1.4.2.3">𝜃</ci></apply><ci id="S3.Ex2.m2.1.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1">𝑥</ci></apply></apply></apply><ci id="S3.Ex2.m2.7.7.3.4.cmml" xref="S3.Ex2.m2.7.7.3.4">ℛ</ci><interval closure="open" id="S3.Ex2.m2.7.7.3.5.1.cmml" xref="S3.Ex2.m2.7.7.3.5.2"><ci id="S3.Ex2.m2.3.3.cmml" xref="S3.Ex2.m2.3.3">𝑥</ci><ci id="S3.Ex2.m2.4.4.cmml" xref="S3.Ex2.m2.4.4">𝐲</ci></interval></apply><apply id="S3.Ex2.m2.7.7.1.cmml" xref="S3.Ex2.m2.7.7.1"><times id="S3.Ex2.m2.7.7.1.2.cmml" xref="S3.Ex2.m2.7.7.1.2"></times><apply id="S3.Ex2.m2.7.7.1.3.cmml" xref="S3.Ex2.m2.7.7.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.7.7.1.3.1.cmml" xref="S3.Ex2.m2.7.7.1.3">subscript</csymbol><ci id="S3.Ex2.m2.7.7.1.3.2.cmml" xref="S3.Ex2.m2.7.7.1.3.2">𝐄</ci><apply id="S3.Ex2.m2.7.7.1.3.3.cmml" xref="S3.Ex2.m2.7.7.1.3.3"><csymbol cd="latexml" id="S3.Ex2.m2.7.7.1.3.3.1.cmml" xref="S3.Ex2.m2.7.7.1.3.3.1">similar-to</csymbol><ci id="S3.Ex2.m2.7.7.1.3.3.2.cmml" xref="S3.Ex2.m2.7.7.1.3.3.2">𝑥</ci><ci id="S3.Ex2.m2.7.7.1.3.3.3.cmml" xref="S3.Ex2.m2.7.7.1.3.3.3">𝒟</ci></apply></apply><apply id="S3.Ex2.m2.7.7.1.4.cmml" xref="S3.Ex2.m2.7.7.1.4"><csymbol cd="ambiguous" id="S3.Ex2.m2.7.7.1.4.1.cmml" xref="S3.Ex2.m2.7.7.1.4">subscript</csymbol><ci id="S3.Ex2.m2.7.7.1.4.2.cmml" xref="S3.Ex2.m2.7.7.1.4.2">𝐄</ci><apply id="S3.Ex2.m2.2.2.1.cmml" xref="S3.Ex2.m2.2.2.1"><csymbol cd="latexml" id="S3.Ex2.m2.2.2.1.2.cmml" xref="S3.Ex2.m2.2.2.1.2">similar-to</csymbol><ci id="S3.Ex2.m2.2.2.1.3.cmml" xref="S3.Ex2.m2.2.2.1.3">𝐲</ci><apply id="S3.Ex2.m2.2.2.1.4.cmml" xref="S3.Ex2.m2.2.2.1.4"><times id="S3.Ex2.m2.2.2.1.4.1.cmml" xref="S3.Ex2.m2.2.2.1.4.1"></times><apply id="S3.Ex2.m2.2.2.1.4.2.cmml" xref="S3.Ex2.m2.2.2.1.4.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.2.2.1.4.2.1.cmml" xref="S3.Ex2.m2.2.2.1.4.2">subscript</csymbol><ci id="S3.Ex2.m2.2.2.1.4.2.2.cmml" xref="S3.Ex2.m2.2.2.1.4.2.2">𝜋</ci><ci id="S3.Ex2.m2.2.2.1.4.2.3.cmml" xref="S3.Ex2.m2.2.2.1.4.2.3">𝜃</ci></apply><ci id="S3.Ex2.m2.2.2.1.1.cmml" xref="S3.Ex2.m2.2.2.1.1">𝑥</ci></apply></apply></apply><ci id="S3.Ex2.m2.7.7.1.5.cmml" xref="S3.Ex2.m2.7.7.1.5">ℛ</ci><interval closure="open" id="S3.Ex2.m2.7.7.1.6.1.cmml" xref="S3.Ex2.m2.7.7.1.6.2"><ci id="S3.Ex2.m2.5.5.cmml" xref="S3.Ex2.m2.5.5">𝑥</ci><ci id="S3.Ex2.m2.6.6.cmml" xref="S3.Ex2.m2.6.6">𝐲</ci></interval><apply id="S3.Ex2.m2.7.7.1.7.cmml" xref="S3.Ex2.m2.7.7.1.7"><apply id="S3.Ex2.m2.7.7.1.7.1.cmml" xref="S3.Ex2.m2.7.7.1.7.1"><ci id="S3.Ex2.m2.7.7.1.7.1.1.cmml" xref="S3.Ex2.m2.7.7.1.7.1.1">∇</ci><log id="S3.Ex2.m2.7.7.1.7.1.2.cmml" xref="S3.Ex2.m2.7.7.1.7.1.2"></log></apply><apply id="S3.Ex2.m2.7.7.1.7.2.cmml" xref="S3.Ex2.m2.7.7.1.7.2"><csymbol cd="ambiguous" id="S3.Ex2.m2.7.7.1.7.2.1.cmml" xref="S3.Ex2.m2.7.7.1.7.2">subscript</csymbol><ci id="S3.Ex2.m2.7.7.1.7.2.2.cmml" xref="S3.Ex2.m2.7.7.1.7.2.2">𝜋</ci><ci id="S3.Ex2.m2.7.7.1.7.2.3.cmml" xref="S3.Ex2.m2.7.7.1.7.2.3">𝜃</ci></apply></apply><apply id="S3.Ex2.m2.7.7.1.1.1.1.cmml" xref="S3.Ex2.m2.7.7.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m2.7.7.1.1.1.1.1.cmml" xref="S3.Ex2.m2.7.7.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex2.m2.7.7.1.1.1.1.2.cmml" xref="S3.Ex2.m2.7.7.1.1.1.1.2">𝐲</ci><ci id="S3.Ex2.m2.7.7.1.1.1.1.3.cmml" xref="S3.Ex2.m2.7.7.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m2.7c">\displaystyle\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}\sim\pi_{%
\theta}(x)}\mathcal{R}(x,\mathbf{y})=\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{%
\mathbf{y}\sim\pi_{\theta}(x)}\mathcal{R}(x,\mathbf{y})\nabla\log{\pi_{\theta}%
(\mathbf{y}|x)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m2.7d">bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT bold_E start_POSTSUBSCRIPT bold_y ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) end_POSTSUBSCRIPT caligraphic_R ( italic_x , bold_y ) = bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT bold_E start_POSTSUBSCRIPT bold_y ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) end_POSTSUBSCRIPT caligraphic_R ( italic_x , bold_y ) ∇ roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y | italic_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\approx\frac{1}{B}\sum_{i=1}^{B}\mathcal{R}(x^{(i)},\mathbf{y}^{(%
i)})\nabla\log{\pi_{\theta}(\mathbf{y^{(i)}}|x^{(i)})}" class="ltx_Math" display="inline" id="S3.E4.m1.7"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml"><mi id="S3.E4.m1.7.7.5" xref="S3.E4.m1.7.7.5.cmml"></mi><mo id="S3.E4.m1.7.7.4" xref="S3.E4.m1.7.7.4.cmml">≈</mo><mrow id="S3.E4.m1.7.7.3" xref="S3.E4.m1.7.7.3.cmml"><mstyle displaystyle="true" id="S3.E4.m1.7.7.3.5" xref="S3.E4.m1.7.7.3.5.cmml"><mfrac id="S3.E4.m1.7.7.3.5a" xref="S3.E4.m1.7.7.3.5.cmml"><mn id="S3.E4.m1.7.7.3.5.2" xref="S3.E4.m1.7.7.3.5.2.cmml">1</mn><mi id="S3.E4.m1.7.7.3.5.3" xref="S3.E4.m1.7.7.3.5.3.cmml">B</mi></mfrac></mstyle><mo id="S3.E4.m1.7.7.3.4" xref="S3.E4.m1.7.7.3.4.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.3.3" xref="S3.E4.m1.7.7.3.3.cmml"><mstyle displaystyle="true" id="S3.E4.m1.7.7.3.3.4" xref="S3.E4.m1.7.7.3.3.4.cmml"><munderover id="S3.E4.m1.7.7.3.3.4a" xref="S3.E4.m1.7.7.3.3.4.cmml"><mo id="S3.E4.m1.7.7.3.3.4.2.2" movablelimits="false" xref="S3.E4.m1.7.7.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E4.m1.7.7.3.3.4.2.3" xref="S3.E4.m1.7.7.3.3.4.2.3.cmml"><mi id="S3.E4.m1.7.7.3.3.4.2.3.2" xref="S3.E4.m1.7.7.3.3.4.2.3.2.cmml">i</mi><mo id="S3.E4.m1.7.7.3.3.4.2.3.1" xref="S3.E4.m1.7.7.3.3.4.2.3.1.cmml">=</mo><mn id="S3.E4.m1.7.7.3.3.4.2.3.3" xref="S3.E4.m1.7.7.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.7.7.3.3.4.3" xref="S3.E4.m1.7.7.3.3.4.3.cmml">B</mi></munderover></mstyle><mrow id="S3.E4.m1.7.7.3.3.3" xref="S3.E4.m1.7.7.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.7.7.3.3.3.5" xref="S3.E4.m1.7.7.3.3.3.5.cmml">ℛ</mi><mo id="S3.E4.m1.7.7.3.3.3.4" xref="S3.E4.m1.7.7.3.3.3.4.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.2.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.3.cmml"><mo id="S3.E4.m1.6.6.2.2.2.2.2.3" stretchy="false" xref="S3.E4.m1.6.6.2.2.2.2.3.cmml">(</mo><msup id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E4.m1.6.6.2.2.2.2.2.4" xref="S3.E4.m1.6.6.2.2.2.2.3.cmml">,</mo><msup id="S3.E4.m1.6.6.2.2.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.2.2.cmml"><mi id="S3.E4.m1.6.6.2.2.2.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.2.2.2.cmml">𝐲</mi><mrow id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.6.6.2.2.2.2.2.2.cmml"><mo id="S3.E4.m1.2.2.1.3.1" stretchy="false" xref="S3.E4.m1.6.6.2.2.2.2.2.2.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.1.3.2" stretchy="false" xref="S3.E4.m1.6.6.2.2.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.E4.m1.6.6.2.2.2.2.2.5" stretchy="false" xref="S3.E4.m1.6.6.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E4.m1.7.7.3.3.3.4a" lspace="0.167em" xref="S3.E4.m1.7.7.3.3.3.4.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.3.3.3.6" xref="S3.E4.m1.7.7.3.3.3.6.cmml"><mrow id="S3.E4.m1.7.7.3.3.3.6.1" xref="S3.E4.m1.7.7.3.3.3.6.1.cmml"><mo id="S3.E4.m1.7.7.3.3.3.6.1.1" rspace="0.167em" xref="S3.E4.m1.7.7.3.3.3.6.1.1.cmml">∇</mo><mi id="S3.E4.m1.7.7.3.3.3.6.1.2" xref="S3.E4.m1.7.7.3.3.3.6.1.2.cmml">log</mi></mrow><mo id="S3.E4.m1.7.7.3.3.3.6a" lspace="0.167em" xref="S3.E4.m1.7.7.3.3.3.6.cmml">⁡</mo><msub id="S3.E4.m1.7.7.3.3.3.6.2" xref="S3.E4.m1.7.7.3.3.3.6.2.cmml"><mi id="S3.E4.m1.7.7.3.3.3.6.2.2" xref="S3.E4.m1.7.7.3.3.3.6.2.2.cmml">π</mi><mi id="S3.E4.m1.7.7.3.3.3.6.2.3" xref="S3.E4.m1.7.7.3.3.3.6.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E4.m1.7.7.3.3.3.4b" xref="S3.E4.m1.7.7.3.3.3.4.cmml">⁢</mo><mrow id="S3.E4.m1.7.7.3.3.3.3.1" xref="S3.E4.m1.7.7.3.3.3.3.1.1.cmml"><mo id="S3.E4.m1.7.7.3.3.3.3.1.2" stretchy="false" xref="S3.E4.m1.7.7.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.3.3.3.3.1.1" xref="S3.E4.m1.7.7.3.3.3.3.1.1.cmml"><msup id="S3.E4.m1.7.7.3.3.3.3.1.1.2" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2.cmml"><mi id="S3.E4.m1.7.7.3.3.3.3.1.1.2.2" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2.2.cmml">𝐲</mi><mrow id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2.cmml"><mo id="S3.E4.m1.3.3.1.3.1" stretchy="false" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2.cmml">(</mo><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">𝐢</mi><mo id="S3.E4.m1.3.3.1.3.2" stretchy="false" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2.cmml">)</mo></mrow></msup><mo fence="false" id="S3.E4.m1.7.7.3.3.3.3.1.1.1" xref="S3.E4.m1.7.7.3.3.3.3.1.1.1.cmml">|</mo><msup id="S3.E4.m1.7.7.3.3.3.3.1.1.3" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3.cmml"><mi id="S3.E4.m1.7.7.3.3.3.3.1.1.3.2" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3.2.cmml">x</mi><mrow id="S3.E4.m1.4.4.1.3" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3.cmml"><mo id="S3.E4.m1.4.4.1.3.1" stretchy="false" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3.cmml">(</mo><mi id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">i</mi><mo id="S3.E4.m1.4.4.1.3.2" stretchy="false" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E4.m1.7.7.3.3.3.3.1.3" stretchy="false" xref="S3.E4.m1.7.7.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7"><approx id="S3.E4.m1.7.7.4.cmml" xref="S3.E4.m1.7.7.4"></approx><csymbol cd="latexml" id="S3.E4.m1.7.7.5.cmml" xref="S3.E4.m1.7.7.5">absent</csymbol><apply id="S3.E4.m1.7.7.3.cmml" xref="S3.E4.m1.7.7.3"><times id="S3.E4.m1.7.7.3.4.cmml" xref="S3.E4.m1.7.7.3.4"></times><apply id="S3.E4.m1.7.7.3.5.cmml" xref="S3.E4.m1.7.7.3.5"><divide id="S3.E4.m1.7.7.3.5.1.cmml" xref="S3.E4.m1.7.7.3.5"></divide><cn id="S3.E4.m1.7.7.3.5.2.cmml" type="integer" xref="S3.E4.m1.7.7.3.5.2">1</cn><ci id="S3.E4.m1.7.7.3.5.3.cmml" xref="S3.E4.m1.7.7.3.5.3">𝐵</ci></apply><apply id="S3.E4.m1.7.7.3.3.cmml" xref="S3.E4.m1.7.7.3.3"><apply id="S3.E4.m1.7.7.3.3.4.cmml" xref="S3.E4.m1.7.7.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.3.4.1.cmml" xref="S3.E4.m1.7.7.3.3.4">superscript</csymbol><apply id="S3.E4.m1.7.7.3.3.4.2.cmml" xref="S3.E4.m1.7.7.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.3.4.2.1.cmml" xref="S3.E4.m1.7.7.3.3.4">subscript</csymbol><sum id="S3.E4.m1.7.7.3.3.4.2.2.cmml" xref="S3.E4.m1.7.7.3.3.4.2.2"></sum><apply id="S3.E4.m1.7.7.3.3.4.2.3.cmml" xref="S3.E4.m1.7.7.3.3.4.2.3"><eq id="S3.E4.m1.7.7.3.3.4.2.3.1.cmml" xref="S3.E4.m1.7.7.3.3.4.2.3.1"></eq><ci id="S3.E4.m1.7.7.3.3.4.2.3.2.cmml" xref="S3.E4.m1.7.7.3.3.4.2.3.2">𝑖</ci><cn id="S3.E4.m1.7.7.3.3.4.2.3.3.cmml" type="integer" xref="S3.E4.m1.7.7.3.3.4.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.7.7.3.3.4.3.cmml" xref="S3.E4.m1.7.7.3.3.4.3">𝐵</ci></apply><apply id="S3.E4.m1.7.7.3.3.3.cmml" xref="S3.E4.m1.7.7.3.3.3"><times id="S3.E4.m1.7.7.3.3.3.4.cmml" xref="S3.E4.m1.7.7.3.3.3.4"></times><ci id="S3.E4.m1.7.7.3.3.3.5.cmml" xref="S3.E4.m1.7.7.3.3.3.5">ℛ</ci><interval closure="open" id="S3.E4.m1.6.6.2.2.2.2.3.cmml" xref="S3.E4.m1.6.6.2.2.2.2.2"><apply id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E4.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.6.6.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.2.2.2.2.2">𝐲</ci><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑖</ci></apply></interval><apply id="S3.E4.m1.7.7.3.3.3.6.cmml" xref="S3.E4.m1.7.7.3.3.3.6"><apply id="S3.E4.m1.7.7.3.3.3.6.1.cmml" xref="S3.E4.m1.7.7.3.3.3.6.1"><ci id="S3.E4.m1.7.7.3.3.3.6.1.1.cmml" xref="S3.E4.m1.7.7.3.3.3.6.1.1">∇</ci><log id="S3.E4.m1.7.7.3.3.3.6.1.2.cmml" xref="S3.E4.m1.7.7.3.3.3.6.1.2"></log></apply><apply id="S3.E4.m1.7.7.3.3.3.6.2.cmml" xref="S3.E4.m1.7.7.3.3.3.6.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.3.3.6.2.1.cmml" xref="S3.E4.m1.7.7.3.3.3.6.2">subscript</csymbol><ci id="S3.E4.m1.7.7.3.3.3.6.2.2.cmml" xref="S3.E4.m1.7.7.3.3.3.6.2.2">𝜋</ci><ci id="S3.E4.m1.7.7.3.3.3.6.2.3.cmml" xref="S3.E4.m1.7.7.3.3.3.6.2.3">𝜃</ci></apply></apply><apply id="S3.E4.m1.7.7.3.3.3.3.1.1.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1"><csymbol cd="latexml" id="S3.E4.m1.7.7.3.3.3.3.1.1.1.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1.1">conditional</csymbol><apply id="S3.E4.m1.7.7.3.3.3.3.1.1.2.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.3.3.3.1.1.2.1.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2">superscript</csymbol><ci id="S3.E4.m1.7.7.3.3.3.3.1.1.2.2.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1.2.2">𝐲</ci><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝐢</ci></apply><apply id="S3.E4.m1.7.7.3.3.3.3.1.1.3.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.3.3.3.1.1.3.1.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3">superscript</csymbol><ci id="S3.E4.m1.7.7.3.3.3.3.1.1.3.2.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1.3.2">𝑥</ci><ci id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\displaystyle\approx\frac{1}{B}\sum_{i=1}^{B}\mathcal{R}(x^{(i)},\mathbf{y}^{(%
i)})\nabla\log{\pi_{\theta}(\mathbf{y^{(i)}}|x^{(i)})}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.7d">≈ divide start_ARG 1 end_ARG start_ARG italic_B end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT caligraphic_R ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ∇ roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y start_POSTSUPERSCRIPT ( bold_i ) end_POSTSUPERSCRIPT | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.2">where <math alttext="y^{(i)}_{j}\sim\pi_{\theta}(x^{(i)})\forall j\in\{1,2,3,\cdots,k\}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m1.8"><semantics id="S3.SS2.p4.2.m1.8a"><mrow id="S3.SS2.p4.2.m1.8.8" xref="S3.SS2.p4.2.m1.8.8.cmml"><msubsup id="S3.SS2.p4.2.m1.8.8.3" xref="S3.SS2.p4.2.m1.8.8.3.cmml"><mi id="S3.SS2.p4.2.m1.8.8.3.2.2" xref="S3.SS2.p4.2.m1.8.8.3.2.2.cmml">y</mi><mi id="S3.SS2.p4.2.m1.8.8.3.3" xref="S3.SS2.p4.2.m1.8.8.3.3.cmml">j</mi><mrow id="S3.SS2.p4.2.m1.1.1.1.3" xref="S3.SS2.p4.2.m1.8.8.3.cmml"><mo id="S3.SS2.p4.2.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.3.cmml">(</mo><mi id="S3.SS2.p4.2.m1.1.1.1.1" xref="S3.SS2.p4.2.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.2.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.p4.2.m1.8.8.4" xref="S3.SS2.p4.2.m1.8.8.4.cmml">∼</mo><mrow id="S3.SS2.p4.2.m1.8.8.1" xref="S3.SS2.p4.2.m1.8.8.1.cmml"><msub id="S3.SS2.p4.2.m1.8.8.1.3" xref="S3.SS2.p4.2.m1.8.8.1.3.cmml"><mi id="S3.SS2.p4.2.m1.8.8.1.3.2" xref="S3.SS2.p4.2.m1.8.8.1.3.2.cmml">π</mi><mi id="S3.SS2.p4.2.m1.8.8.1.3.3" xref="S3.SS2.p4.2.m1.8.8.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p4.2.m1.8.8.1.2" xref="S3.SS2.p4.2.m1.8.8.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.2.m1.8.8.1.1.1" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml"><mo id="S3.SS2.p4.2.m1.8.8.1.1.1.2" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml">(</mo><msup id="S3.SS2.p4.2.m1.8.8.1.1.1.1" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml"><mi id="S3.SS2.p4.2.m1.8.8.1.1.1.1.2" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS2.p4.2.m1.2.2.1.3" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml"><mo id="S3.SS2.p4.2.m1.2.2.1.3.1" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml">(</mo><mi id="S3.SS2.p4.2.m1.2.2.1.1" xref="S3.SS2.p4.2.m1.2.2.1.1.cmml">i</mi><mo id="S3.SS2.p4.2.m1.2.2.1.3.2" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.p4.2.m1.8.8.1.1.1.3" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.p4.2.m1.8.8.1.2a" lspace="0.167em" xref="S3.SS2.p4.2.m1.8.8.1.2.cmml">⁢</mo><mrow id="S3.SS2.p4.2.m1.8.8.1.4" xref="S3.SS2.p4.2.m1.8.8.1.4.cmml"><mo id="S3.SS2.p4.2.m1.8.8.1.4.1" rspace="0.167em" xref="S3.SS2.p4.2.m1.8.8.1.4.1.cmml">∀</mo><mi id="S3.SS2.p4.2.m1.8.8.1.4.2" xref="S3.SS2.p4.2.m1.8.8.1.4.2.cmml">j</mi></mrow></mrow><mo id="S3.SS2.p4.2.m1.8.8.5" xref="S3.SS2.p4.2.m1.8.8.5.cmml">∈</mo><mrow id="S3.SS2.p4.2.m1.8.8.6.2" xref="S3.SS2.p4.2.m1.8.8.6.1.cmml"><mo id="S3.SS2.p4.2.m1.8.8.6.2.1" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.6.1.cmml">{</mo><mn id="S3.SS2.p4.2.m1.3.3" xref="S3.SS2.p4.2.m1.3.3.cmml">1</mn><mo id="S3.SS2.p4.2.m1.8.8.6.2.2" xref="S3.SS2.p4.2.m1.8.8.6.1.cmml">,</mo><mn id="S3.SS2.p4.2.m1.4.4" xref="S3.SS2.p4.2.m1.4.4.cmml">2</mn><mo id="S3.SS2.p4.2.m1.8.8.6.2.3" xref="S3.SS2.p4.2.m1.8.8.6.1.cmml">,</mo><mn id="S3.SS2.p4.2.m1.5.5" xref="S3.SS2.p4.2.m1.5.5.cmml">3</mn><mo id="S3.SS2.p4.2.m1.8.8.6.2.4" xref="S3.SS2.p4.2.m1.8.8.6.1.cmml">,</mo><mi id="S3.SS2.p4.2.m1.6.6" mathvariant="normal" xref="S3.SS2.p4.2.m1.6.6.cmml">⋯</mi><mo id="S3.SS2.p4.2.m1.8.8.6.2.5" xref="S3.SS2.p4.2.m1.8.8.6.1.cmml">,</mo><mi id="S3.SS2.p4.2.m1.7.7" xref="S3.SS2.p4.2.m1.7.7.cmml">k</mi><mo id="S3.SS2.p4.2.m1.8.8.6.2.6" stretchy="false" xref="S3.SS2.p4.2.m1.8.8.6.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m1.8b"><apply id="S3.SS2.p4.2.m1.8.8.cmml" xref="S3.SS2.p4.2.m1.8.8"><and id="S3.SS2.p4.2.m1.8.8a.cmml" xref="S3.SS2.p4.2.m1.8.8"></and><apply id="S3.SS2.p4.2.m1.8.8b.cmml" xref="S3.SS2.p4.2.m1.8.8"><csymbol cd="latexml" id="S3.SS2.p4.2.m1.8.8.4.cmml" xref="S3.SS2.p4.2.m1.8.8.4">similar-to</csymbol><apply id="S3.SS2.p4.2.m1.8.8.3.cmml" xref="S3.SS2.p4.2.m1.8.8.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m1.8.8.3.1.cmml" xref="S3.SS2.p4.2.m1.8.8.3">subscript</csymbol><apply id="S3.SS2.p4.2.m1.8.8.3.2.cmml" xref="S3.SS2.p4.2.m1.8.8.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m1.8.8.3.2.1.cmml" xref="S3.SS2.p4.2.m1.8.8.3">superscript</csymbol><ci id="S3.SS2.p4.2.m1.8.8.3.2.2.cmml" xref="S3.SS2.p4.2.m1.8.8.3.2.2">𝑦</ci><ci id="S3.SS2.p4.2.m1.1.1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.SS2.p4.2.m1.8.8.3.3.cmml" xref="S3.SS2.p4.2.m1.8.8.3.3">𝑗</ci></apply><apply id="S3.SS2.p4.2.m1.8.8.1.cmml" xref="S3.SS2.p4.2.m1.8.8.1"><times id="S3.SS2.p4.2.m1.8.8.1.2.cmml" xref="S3.SS2.p4.2.m1.8.8.1.2"></times><apply id="S3.SS2.p4.2.m1.8.8.1.3.cmml" xref="S3.SS2.p4.2.m1.8.8.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m1.8.8.1.3.1.cmml" xref="S3.SS2.p4.2.m1.8.8.1.3">subscript</csymbol><ci id="S3.SS2.p4.2.m1.8.8.1.3.2.cmml" xref="S3.SS2.p4.2.m1.8.8.1.3.2">𝜋</ci><ci id="S3.SS2.p4.2.m1.8.8.1.3.3.cmml" xref="S3.SS2.p4.2.m1.8.8.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p4.2.m1.8.8.1.1.1.1.cmml" xref="S3.SS2.p4.2.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m1.8.8.1.1.1.1.1.cmml" xref="S3.SS2.p4.2.m1.8.8.1.1.1">superscript</csymbol><ci id="S3.SS2.p4.2.m1.8.8.1.1.1.1.2.cmml" xref="S3.SS2.p4.2.m1.8.8.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p4.2.m1.2.2.1.1.cmml" xref="S3.SS2.p4.2.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.SS2.p4.2.m1.8.8.1.4.cmml" xref="S3.SS2.p4.2.m1.8.8.1.4"><csymbol cd="latexml" id="S3.SS2.p4.2.m1.8.8.1.4.1.cmml" xref="S3.SS2.p4.2.m1.8.8.1.4.1">for-all</csymbol><ci id="S3.SS2.p4.2.m1.8.8.1.4.2.cmml" xref="S3.SS2.p4.2.m1.8.8.1.4.2">𝑗</ci></apply></apply></apply><apply id="S3.SS2.p4.2.m1.8.8c.cmml" xref="S3.SS2.p4.2.m1.8.8"><in id="S3.SS2.p4.2.m1.8.8.5.cmml" xref="S3.SS2.p4.2.m1.8.8.5"></in><share href="https://arxiv.org/html/2406.14169v1#S3.SS2.p4.2.m1.8.8.1.cmml" id="S3.SS2.p4.2.m1.8.8d.cmml" xref="S3.SS2.p4.2.m1.8.8"></share><set id="S3.SS2.p4.2.m1.8.8.6.1.cmml" xref="S3.SS2.p4.2.m1.8.8.6.2"><cn id="S3.SS2.p4.2.m1.3.3.cmml" type="integer" xref="S3.SS2.p4.2.m1.3.3">1</cn><cn id="S3.SS2.p4.2.m1.4.4.cmml" type="integer" xref="S3.SS2.p4.2.m1.4.4">2</cn><cn id="S3.SS2.p4.2.m1.5.5.cmml" type="integer" xref="S3.SS2.p4.2.m1.5.5">3</cn><ci id="S3.SS2.p4.2.m1.6.6.cmml" xref="S3.SS2.p4.2.m1.6.6">⋯</ci><ci id="S3.SS2.p4.2.m1.7.7.cmml" xref="S3.SS2.p4.2.m1.7.7">𝑘</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m1.8c">y^{(i)}_{j}\sim\pi_{\theta}(x^{(i)})\forall j\in\{1,2,3,\cdots,k\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m1.8d">italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ∀ italic_j ∈ { 1 , 2 , 3 , ⋯ , italic_k }</annotation></semantics></math>. Since the reward is one-step, the above optimization can be interpreted to have a simple goal: increase the probability of items that occur in a k-sequence with high reward, and decrease the probability of items that occur in a k-sequence that obtains low reward.
Note that we use the REINFORCE algorithm for simplicity, but any other policy gradient algorithm can be used.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>LLMs make novelty optimization practical</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">While the formulation is reasonable, there is a key limitation: novel items, by definition, do not have any user feedback data since they were never shown to users by the base production model for that query. Hence, if we use only the log-based training data for Eqn. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Ex2" title="3.2. RL formulation using policy gradient ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.2</span></a>, relevance feedback for the novel items would be missing and thus no novel item’s reward can be computed.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">In this paper, we show that LLMs help avoid this limitation by providing relevance feedback for novel query-item pairs. LLMs such as GPT-3.5 and GPT-4 have been shown to provide a substantial improvement in semantic understanding compared to existing encoder-based models. For instance, recent work shows that GPT-3.5 can match or surpass crowd-sourced human labellers in their accuracy on labelling <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib11" title="">2023</a>)</cite> or ranking <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib13" title="">2024</a>)</cite> retrieval outputs for relevance. In addition, even though the relevance criterion for a correct recommendation may differ for different tasks, we need not train separate relevance models. For example, while the criteria for matching books to other books may be different from matching queries to ads, which in turn may be slightly different for matching queries to webpages; a single LLM like GPT-3.5 can be used for providing relevance feedback for all these domains by simply changing the prompt. Hence, the accuracy and universality of LLMs make it possible to obtain relevance feedback for arbitrary query-item pairs and optimize novelty directly for retrieval tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>The challenge with large action spaces</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">While LLMs provide a solution to the problem of relevance feedback for novel query-item pairs, another key challenge is the large number of potential query-item pairs to label since available items are typically in the millions. Below we show that the number of relevance reward samples needed for a policy gradient algorithm
to obtain a desired accuracy (<span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.1">sample complexity</span>) increases proportional to the square of the number of actions. The result is based on applying finite sample convergence bounds <cite class="ltx_cite ltx_citemacro_citep">(Mei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib24" title="">2020</a>)</cite> for policy gradient algorithms to the retrieval setup.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.2">Let <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msup id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">π</mi><mo id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝜋</ci><times id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\pi^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> denote the optimal policy that maximizes Eqn <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.E2" title="In 3.2. RL formulation using policy gradient ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">2</span></a> and <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">italic_t</annotation></semantics></math> refer to the steps of the optimization. We consider a one-step Markov Decision Process where each query corresponds to a state and the actions are the top-k predicted items. Hence, for each state, we only need to optimize the current reward. We assume a uniform probability for sampling each state (query).</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="Thmassumption1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Assumption 1 (from <cite class="ltx_cite ltx_citemacro_citep">(Mei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib24" title="">2020</a>)</cite>).</h6>
<div class="ltx_para" id="Thmassumption1.p1">
<p class="ltx_p" id="Thmassumption1.p1.2"><span class="ltx_text ltx_font_italic" id="Thmassumption1.p1.2.2">(Sufficient exploration). The initial state <math alttext="\mu" class="ltx_Math" display="inline" id="Thmassumption1.p1.1.1.m1.1"><semantics id="Thmassumption1.p1.1.1.m1.1a"><mi id="Thmassumption1.p1.1.1.m1.1.1" xref="Thmassumption1.p1.1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="Thmassumption1.p1.1.1.m1.1b"><ci id="Thmassumption1.p1.1.1.m1.1.1.cmml" xref="Thmassumption1.p1.1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmassumption1.p1.1.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="Thmassumption1.p1.1.1.m1.1d">italic_μ</annotation></semantics></math>
distribution satisfies <math alttext="\min_{s}\mu(s)&gt;0" class="ltx_Math" display="inline" id="Thmassumption1.p1.2.2.m2.1"><semantics id="Thmassumption1.p1.2.2.m2.1a"><mrow id="Thmassumption1.p1.2.2.m2.1.2" xref="Thmassumption1.p1.2.2.m2.1.2.cmml"><mrow id="Thmassumption1.p1.2.2.m2.1.2.2" xref="Thmassumption1.p1.2.2.m2.1.2.2.cmml"><mrow id="Thmassumption1.p1.2.2.m2.1.2.2.2" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.cmml"><msub id="Thmassumption1.p1.2.2.m2.1.2.2.2.1" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.1.cmml"><mi id="Thmassumption1.p1.2.2.m2.1.2.2.2.1.2" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.1.2.cmml">min</mi><mi id="Thmassumption1.p1.2.2.m2.1.2.2.2.1.3" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.1.3.cmml">s</mi></msub><mo id="Thmassumption1.p1.2.2.m2.1.2.2.2a" lspace="0.167em" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.cmml">⁡</mo><mi id="Thmassumption1.p1.2.2.m2.1.2.2.2.2" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.2.cmml">μ</mi></mrow><mo id="Thmassumption1.p1.2.2.m2.1.2.2.1" xref="Thmassumption1.p1.2.2.m2.1.2.2.1.cmml">⁢</mo><mrow id="Thmassumption1.p1.2.2.m2.1.2.2.3.2" xref="Thmassumption1.p1.2.2.m2.1.2.2.cmml"><mo id="Thmassumption1.p1.2.2.m2.1.2.2.3.2.1" stretchy="false" xref="Thmassumption1.p1.2.2.m2.1.2.2.cmml">(</mo><mi id="Thmassumption1.p1.2.2.m2.1.1" xref="Thmassumption1.p1.2.2.m2.1.1.cmml">s</mi><mo id="Thmassumption1.p1.2.2.m2.1.2.2.3.2.2" stretchy="false" xref="Thmassumption1.p1.2.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="Thmassumption1.p1.2.2.m2.1.2.1" xref="Thmassumption1.p1.2.2.m2.1.2.1.cmml">&gt;</mo><mn id="Thmassumption1.p1.2.2.m2.1.2.3" xref="Thmassumption1.p1.2.2.m2.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmassumption1.p1.2.2.m2.1b"><apply id="Thmassumption1.p1.2.2.m2.1.2.cmml" xref="Thmassumption1.p1.2.2.m2.1.2"><gt id="Thmassumption1.p1.2.2.m2.1.2.1.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.1"></gt><apply id="Thmassumption1.p1.2.2.m2.1.2.2.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2"><times id="Thmassumption1.p1.2.2.m2.1.2.2.1.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2.1"></times><apply id="Thmassumption1.p1.2.2.m2.1.2.2.2.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2.2"><apply id="Thmassumption1.p1.2.2.m2.1.2.2.2.1.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.1"><csymbol cd="ambiguous" id="Thmassumption1.p1.2.2.m2.1.2.2.2.1.1.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.1">subscript</csymbol><min id="Thmassumption1.p1.2.2.m2.1.2.2.2.1.2.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.1.2"></min><ci id="Thmassumption1.p1.2.2.m2.1.2.2.2.1.3.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.1.3">𝑠</ci></apply><ci id="Thmassumption1.p1.2.2.m2.1.2.2.2.2.cmml" xref="Thmassumption1.p1.2.2.m2.1.2.2.2.2">𝜇</ci></apply><ci id="Thmassumption1.p1.2.2.m2.1.1.cmml" xref="Thmassumption1.p1.2.2.m2.1.1">𝑠</ci></apply><cn id="Thmassumption1.p1.2.2.m2.1.2.3.cmml" type="integer" xref="Thmassumption1.p1.2.2.m2.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmassumption1.p1.2.2.m2.1c">\min_{s}\mu(s)&gt;0</annotation><annotation encoding="application/x-llamapun" id="Thmassumption1.p1.2.2.m2.1d">roman_min start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_μ ( italic_s ) &gt; 0</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="Thmassumption2">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Assumption 2.</h6>
<div class="ltx_para" id="Thmassumption2.p1">
<p class="ltx_p" id="Thmassumption2.p1.3"><span class="ltx_text ltx_font_italic" id="Thmassumption2.p1.3.3">For each state, the initial policy’s probability for selecting the optimal action is better than random (uniform probability) within some multiplicative constant <math alttext="\rho\geq 1" class="ltx_Math" display="inline" id="Thmassumption2.p1.1.1.m1.1"><semantics id="Thmassumption2.p1.1.1.m1.1a"><mrow id="Thmassumption2.p1.1.1.m1.1.1" xref="Thmassumption2.p1.1.1.m1.1.1.cmml"><mi id="Thmassumption2.p1.1.1.m1.1.1.2" xref="Thmassumption2.p1.1.1.m1.1.1.2.cmml">ρ</mi><mo id="Thmassumption2.p1.1.1.m1.1.1.1" xref="Thmassumption2.p1.1.1.m1.1.1.1.cmml">≥</mo><mn id="Thmassumption2.p1.1.1.m1.1.1.3" xref="Thmassumption2.p1.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Thmassumption2.p1.1.1.m1.1b"><apply id="Thmassumption2.p1.1.1.m1.1.1.cmml" xref="Thmassumption2.p1.1.1.m1.1.1"><geq id="Thmassumption2.p1.1.1.m1.1.1.1.cmml" xref="Thmassumption2.p1.1.1.m1.1.1.1"></geq><ci id="Thmassumption2.p1.1.1.m1.1.1.2.cmml" xref="Thmassumption2.p1.1.1.m1.1.1.2">𝜌</ci><cn id="Thmassumption2.p1.1.1.m1.1.1.3.cmml" type="integer" xref="Thmassumption2.p1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmassumption2.p1.1.1.m1.1c">\rho\geq 1</annotation><annotation encoding="application/x-llamapun" id="Thmassumption2.p1.1.1.m1.1d">italic_ρ ≥ 1</annotation></semantics></math>: <math alttext="\pi_{\theta_{0}}(\mathbf{y}^{*}(x)|x)&gt;\frac{1}{\rho A}\text{ }\forall x\in{D}" class="ltx_Math" display="inline" id="Thmassumption2.p1.2.2.m2.2"><semantics id="Thmassumption2.p1.2.2.m2.2a"><mrow id="Thmassumption2.p1.2.2.m2.2.2" xref="Thmassumption2.p1.2.2.m2.2.2.cmml"><mrow id="Thmassumption2.p1.2.2.m2.2.2.1" xref="Thmassumption2.p1.2.2.m2.2.2.1.cmml"><msub id="Thmassumption2.p1.2.2.m2.2.2.1.3" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.cmml"><mi id="Thmassumption2.p1.2.2.m2.2.2.1.3.2" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.2.cmml">π</mi><msub id="Thmassumption2.p1.2.2.m2.2.2.1.3.3" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.3.cmml"><mi id="Thmassumption2.p1.2.2.m2.2.2.1.3.3.2" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.3.2.cmml">θ</mi><mn id="Thmassumption2.p1.2.2.m2.2.2.1.3.3.3" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.3.3.cmml">0</mn></msub></msub><mo id="Thmassumption2.p1.2.2.m2.2.2.1.2" xref="Thmassumption2.p1.2.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="Thmassumption2.p1.2.2.m2.2.2.1.1.1" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.cmml"><mo id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.2" stretchy="false" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.cmml"><mrow id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.cmml"><msup id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.cmml"><mi id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.2" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.2.cmml">𝐲</mi><mo id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.3" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.1" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.1.cmml">⁢</mo><mrow id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.3.2" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.cmml"><mo id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.3.2.1" stretchy="false" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.cmml">(</mo><mi id="Thmassumption2.p1.2.2.m2.1.1" xref="Thmassumption2.p1.2.2.m2.1.1.cmml">x</mi><mo id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.3.2.2" stretchy="false" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo fence="false" id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.1" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.1.cmml">|</mo><mi id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.3" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.3" stretchy="false" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmassumption2.p1.2.2.m2.2.2.3" xref="Thmassumption2.p1.2.2.m2.2.2.3.cmml">&gt;</mo><mrow id="Thmassumption2.p1.2.2.m2.2.2.4" xref="Thmassumption2.p1.2.2.m2.2.2.4.cmml"><mfrac id="Thmassumption2.p1.2.2.m2.2.2.4.2" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.cmml"><mn id="Thmassumption2.p1.2.2.m2.2.2.4.2.2" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.2.cmml">1</mn><mrow id="Thmassumption2.p1.2.2.m2.2.2.4.2.3" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3.cmml"><mi id="Thmassumption2.p1.2.2.m2.2.2.4.2.3.2" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3.2.cmml">ρ</mi><mo id="Thmassumption2.p1.2.2.m2.2.2.4.2.3.1" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3.1.cmml">⁢</mo><mi id="Thmassumption2.p1.2.2.m2.2.2.4.2.3.3" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3.3.cmml">A</mi></mrow></mfrac><mo id="Thmassumption2.p1.2.2.m2.2.2.4.1" xref="Thmassumption2.p1.2.2.m2.2.2.4.1.cmml">⁢</mo><mtext class="ltx_mathvariant_italic" id="Thmassumption2.p1.2.2.m2.2.2.4.3" xref="Thmassumption2.p1.2.2.m2.2.2.4.3a.cmml"> </mtext><mo id="Thmassumption2.p1.2.2.m2.2.2.4.1a" lspace="0.167em" xref="Thmassumption2.p1.2.2.m2.2.2.4.1.cmml">⁢</mo><mrow id="Thmassumption2.p1.2.2.m2.2.2.4.4" xref="Thmassumption2.p1.2.2.m2.2.2.4.4.cmml"><mo id="Thmassumption2.p1.2.2.m2.2.2.4.4.1" rspace="0.167em" xref="Thmassumption2.p1.2.2.m2.2.2.4.4.1.cmml">∀</mo><mi id="Thmassumption2.p1.2.2.m2.2.2.4.4.2" xref="Thmassumption2.p1.2.2.m2.2.2.4.4.2.cmml">x</mi></mrow></mrow><mo id="Thmassumption2.p1.2.2.m2.2.2.5" xref="Thmassumption2.p1.2.2.m2.2.2.5.cmml">∈</mo><mi id="Thmassumption2.p1.2.2.m2.2.2.6" xref="Thmassumption2.p1.2.2.m2.2.2.6.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmassumption2.p1.2.2.m2.2b"><apply id="Thmassumption2.p1.2.2.m2.2.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2"><and id="Thmassumption2.p1.2.2.m2.2.2a.cmml" xref="Thmassumption2.p1.2.2.m2.2.2"></and><apply id="Thmassumption2.p1.2.2.m2.2.2b.cmml" xref="Thmassumption2.p1.2.2.m2.2.2"><gt id="Thmassumption2.p1.2.2.m2.2.2.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.3"></gt><apply id="Thmassumption2.p1.2.2.m2.2.2.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1"><times id="Thmassumption2.p1.2.2.m2.2.2.1.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.2"></times><apply id="Thmassumption2.p1.2.2.m2.2.2.1.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="Thmassumption2.p1.2.2.m2.2.2.1.3.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.3">subscript</csymbol><ci id="Thmassumption2.p1.2.2.m2.2.2.1.3.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.2">𝜋</ci><apply id="Thmassumption2.p1.2.2.m2.2.2.1.3.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.3"><csymbol cd="ambiguous" id="Thmassumption2.p1.2.2.m2.2.2.1.3.3.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.3">subscript</csymbol><ci id="Thmassumption2.p1.2.2.m2.2.2.1.3.3.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.3.2">𝜃</ci><cn id="Thmassumption2.p1.2.2.m2.2.2.1.3.3.3.cmml" type="integer" xref="Thmassumption2.p1.2.2.m2.2.2.1.3.3.3">0</cn></apply></apply><apply id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.1">conditional</csymbol><apply id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2"><times id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.1"></times><apply id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2">superscript</csymbol><ci id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.2">𝐲</ci><times id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.2.2.3"></times></apply><ci id="Thmassumption2.p1.2.2.m2.1.1.cmml" xref="Thmassumption2.p1.2.2.m2.1.1">𝑥</ci></apply><ci id="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="Thmassumption2.p1.2.2.m2.2.2.4.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4"><times id="Thmassumption2.p1.2.2.m2.2.2.4.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.1"></times><apply id="Thmassumption2.p1.2.2.m2.2.2.4.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.2"><divide id="Thmassumption2.p1.2.2.m2.2.2.4.2.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.2"></divide><cn id="Thmassumption2.p1.2.2.m2.2.2.4.2.2.cmml" type="integer" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.2">1</cn><apply id="Thmassumption2.p1.2.2.m2.2.2.4.2.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3"><times id="Thmassumption2.p1.2.2.m2.2.2.4.2.3.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3.1"></times><ci id="Thmassumption2.p1.2.2.m2.2.2.4.2.3.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3.2">𝜌</ci><ci id="Thmassumption2.p1.2.2.m2.2.2.4.2.3.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.2.3.3">𝐴</ci></apply></apply><ci id="Thmassumption2.p1.2.2.m2.2.2.4.3a.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.3"><mtext class="ltx_mathvariant_italic" id="Thmassumption2.p1.2.2.m2.2.2.4.3.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.3"> </mtext></ci><apply id="Thmassumption2.p1.2.2.m2.2.2.4.4.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.4"><csymbol cd="latexml" id="Thmassumption2.p1.2.2.m2.2.2.4.4.1.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.4.1">for-all</csymbol><ci id="Thmassumption2.p1.2.2.m2.2.2.4.4.2.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.4.4.2">𝑥</ci></apply></apply></apply><apply id="Thmassumption2.p1.2.2.m2.2.2c.cmml" xref="Thmassumption2.p1.2.2.m2.2.2"><in id="Thmassumption2.p1.2.2.m2.2.2.5.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.5"></in><share href="https://arxiv.org/html/2406.14169v1#Thmassumption2.p1.2.2.m2.2.2.4.cmml" id="Thmassumption2.p1.2.2.m2.2.2d.cmml" xref="Thmassumption2.p1.2.2.m2.2.2"></share><ci id="Thmassumption2.p1.2.2.m2.2.2.6.cmml" xref="Thmassumption2.p1.2.2.m2.2.2.6">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmassumption2.p1.2.2.m2.2c">\pi_{\theta_{0}}(\mathbf{y}^{*}(x)|x)&gt;\frac{1}{\rho A}\text{ }\forall x\in{D}</annotation><annotation encoding="application/x-llamapun" id="Thmassumption2.p1.2.2.m2.2d">italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x ) | italic_x ) &gt; divide start_ARG 1 end_ARG start_ARG italic_ρ italic_A end_ARG ∀ italic_x ∈ italic_D</annotation></semantics></math> where <math alttext="\mathbf{y}^{*}(x):=\arg\max_{\mathbf{y}}\pi^{*}(\mathbf{y}|x)" class="ltx_Math" display="inline" id="Thmassumption2.p1.3.3.m3.2"><semantics id="Thmassumption2.p1.3.3.m3.2a"><mrow id="Thmassumption2.p1.3.3.m3.2.2" xref="Thmassumption2.p1.3.3.m3.2.2.cmml"><mrow id="Thmassumption2.p1.3.3.m3.2.2.3" xref="Thmassumption2.p1.3.3.m3.2.2.3.cmml"><msup id="Thmassumption2.p1.3.3.m3.2.2.3.2" xref="Thmassumption2.p1.3.3.m3.2.2.3.2.cmml"><mi id="Thmassumption2.p1.3.3.m3.2.2.3.2.2" xref="Thmassumption2.p1.3.3.m3.2.2.3.2.2.cmml">𝐲</mi><mo id="Thmassumption2.p1.3.3.m3.2.2.3.2.3" xref="Thmassumption2.p1.3.3.m3.2.2.3.2.3.cmml">∗</mo></msup><mo id="Thmassumption2.p1.3.3.m3.2.2.3.1" xref="Thmassumption2.p1.3.3.m3.2.2.3.1.cmml">⁢</mo><mrow id="Thmassumption2.p1.3.3.m3.2.2.3.3.2" xref="Thmassumption2.p1.3.3.m3.2.2.3.cmml"><mo id="Thmassumption2.p1.3.3.m3.2.2.3.3.2.1" stretchy="false" xref="Thmassumption2.p1.3.3.m3.2.2.3.cmml">(</mo><mi id="Thmassumption2.p1.3.3.m3.1.1" xref="Thmassumption2.p1.3.3.m3.1.1.cmml">x</mi><mo id="Thmassumption2.p1.3.3.m3.2.2.3.3.2.2" rspace="0.278em" stretchy="false" xref="Thmassumption2.p1.3.3.m3.2.2.3.cmml">)</mo></mrow></mrow><mo id="Thmassumption2.p1.3.3.m3.2.2.2" rspace="0.278em" xref="Thmassumption2.p1.3.3.m3.2.2.2.cmml">:=</mo><mrow id="Thmassumption2.p1.3.3.m3.2.2.1" xref="Thmassumption2.p1.3.3.m3.2.2.1.cmml"><mrow id="Thmassumption2.p1.3.3.m3.2.2.1.3" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.cmml"><mi id="Thmassumption2.p1.3.3.m3.2.2.1.3.1" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.1.cmml">arg</mi><mo id="Thmassumption2.p1.3.3.m3.2.2.1.3a" lspace="0.167em" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.cmml">⁡</mo><mrow id="Thmassumption2.p1.3.3.m3.2.2.1.3.2" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.cmml"><msub id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.cmml"><mi id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.2" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.2.cmml">max</mi><mi id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.3" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.3.cmml">𝐲</mi></msub><mo id="Thmassumption2.p1.3.3.m3.2.2.1.3.2a" lspace="0.167em" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.cmml">⁡</mo><msup id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.cmml"><mi id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.2" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.2.cmml">π</mi><mo id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.3" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.3.cmml">∗</mo></msup></mrow></mrow><mo id="Thmassumption2.p1.3.3.m3.2.2.1.2" xref="Thmassumption2.p1.3.3.m3.2.2.1.2.cmml">⁢</mo><mrow id="Thmassumption2.p1.3.3.m3.2.2.1.1.1" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.cmml"><mo id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.2" stretchy="false" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.cmml">(</mo><mrow id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.cmml"><mi id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.2" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.1" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.1.cmml">|</mo><mi id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.3" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.3" stretchy="false" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmassumption2.p1.3.3.m3.2b"><apply id="Thmassumption2.p1.3.3.m3.2.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2"><csymbol cd="latexml" id="Thmassumption2.p1.3.3.m3.2.2.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.2">assign</csymbol><apply id="Thmassumption2.p1.3.3.m3.2.2.3.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.3"><times id="Thmassumption2.p1.3.3.m3.2.2.3.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.3.1"></times><apply id="Thmassumption2.p1.3.3.m3.2.2.3.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.3.2"><csymbol cd="ambiguous" id="Thmassumption2.p1.3.3.m3.2.2.3.2.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.3.2">superscript</csymbol><ci id="Thmassumption2.p1.3.3.m3.2.2.3.2.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.3.2.2">𝐲</ci><times id="Thmassumption2.p1.3.3.m3.2.2.3.2.3.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.3.2.3"></times></apply><ci id="Thmassumption2.p1.3.3.m3.1.1.cmml" xref="Thmassumption2.p1.3.3.m3.1.1">𝑥</ci></apply><apply id="Thmassumption2.p1.3.3.m3.2.2.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1"><times id="Thmassumption2.p1.3.3.m3.2.2.1.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.2"></times><apply id="Thmassumption2.p1.3.3.m3.2.2.1.3.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3"><arg id="Thmassumption2.p1.3.3.m3.2.2.1.3.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.1"></arg><apply id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2"><apply id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1"><csymbol cd="ambiguous" id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1">subscript</csymbol><max id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.2"></max><ci id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.3.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.1.3">𝐲</ci></apply><apply id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2"><csymbol cd="ambiguous" id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2">superscript</csymbol><ci id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.2">𝜋</ci><times id="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.3.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.3.2.2.3"></times></apply></apply></apply><apply id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1"><csymbol cd="latexml" id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.1.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.1">conditional</csymbol><ci id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.2.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.2">𝐲</ci><ci id="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.3.cmml" xref="Thmassumption2.p1.3.3.m3.2.2.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmassumption2.p1.3.3.m3.2c">\mathbf{y}^{*}(x):=\arg\max_{\mathbf{y}}\pi^{*}(\mathbf{y}|x)</annotation><annotation encoding="application/x-llamapun" id="Thmassumption2.p1.3.3.m3.2d">bold_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x ) := roman_arg roman_max start_POSTSUBSCRIPT bold_y end_POSTSUBSCRIPT italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( bold_y | italic_x )</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S3.Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Proposition 0.</h6>
<div class="ltx_para" id="S3.Thmtheorem2.p1">
<p class="ltx_p" id="S3.Thmtheorem2.p1.5"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem2.p1.5.5">Let Assumptions 1 and 2 hold and let <math alttext="\{\theta_{t}\}_{t\geq 1}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.1.1.m1.1"><semantics id="S3.Thmtheorem2.p1.1.1.m1.1a"><msub id="S3.Thmtheorem2.p1.1.1.m1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml"><mrow id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.2.cmml"><mo id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.2.cmml">{</mo><msub id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.Thmtheorem2.p1.1.1.m1.1.1.3" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.cmml"><mi id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.1" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.1.cmml">≥</mo><mn id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.1.1.m1.1b"><apply id="S3.Thmtheorem2.p1.1.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1">subscript</csymbol><set id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1"><apply id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.2">𝜃</ci><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3"><geq id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.1"></geq><ci id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.2">𝑡</ci><cn id="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.Thmtheorem2.p1.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.1.1.m1.1c">\{\theta_{t}\}_{t\geq 1}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.1.1.m1.1d">{ italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t ≥ 1 end_POSTSUBSCRIPT</annotation></semantics></math> be
generated using the standard policy gradient update: <math alttext="\theta_{t+1}\leftarrow\theta_{t}+\eta\frac{\partial V^{\pi_{\theta_{t}}}(\mu)}%
{\partial\theta_{t}}" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.2.2.m2.1"><semantics id="S3.Thmtheorem2.p1.2.2.m2.1a"><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.cmml"><msub id="S3.Thmtheorem2.p1.2.2.m2.1.2.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.2.cmml">θ</mi><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.2.cmml">t</mi><mo id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.1.cmml">+</mo><mn id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.Thmtheorem2.p1.2.2.m2.1.2.1" stretchy="false" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.1.cmml">←</mo><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.2.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.cmml"><msub id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.2.cmml">θ</mi><mi id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.3.cmml">t</mi></msub><mo id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.1.cmml">+</mo><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.2.cmml">η</mi><mo id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.1.cmml">⁢</mo><mfrac id="S3.Thmtheorem2.p1.2.2.m2.1.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml"><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.1.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.cmml"><mo id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.2" rspace="0em" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.2.cmml">∂</mo><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.cmml"><msup id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.2.cmml">V</mi><msub id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.2.cmml">π</mi><msub id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.2.cmml">θ</mi><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.3.cmml">t</mi></msub></msub></msup><mo id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.cmml"><mo id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.3.2.1" stretchy="false" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.cmml">(</mo><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.1" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.1.cmml">μ</mi><mo id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.3.2.2" stretchy="false" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.Thmtheorem2.p1.2.2.m2.1.1.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.cmml"><mo id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.1" rspace="0em" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.1.cmml">∂</mo><msub id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.cmml"><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.2" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.2.cmml">θ</mi><mi id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.3" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.3.cmml">t</mi></msub></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.2.2.m2.1b"><apply id="S3.Thmtheorem2.p1.2.2.m2.1.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2"><ci id="S3.Thmtheorem2.p1.2.2.m2.1.2.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.1">←</ci><apply id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2">subscript</csymbol><ci id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.2">𝜃</ci><apply id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3"><plus id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.1"></plus><ci id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.2">𝑡</ci><cn id="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.3.cmml" type="integer" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.2.3.3">1</cn></apply></apply><apply id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3"><plus id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.1"></plus><apply id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2">subscript</csymbol><ci id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.2">𝜃</ci><ci id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.2.3">𝑡</ci></apply><apply id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3"><times id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.1"></times><ci id="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.2.3.3.2">𝜂</ci><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1"><divide id="S3.Thmtheorem2.p1.2.2.m2.1.1.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1"></divide><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1"><partialdiff id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.2"></partialdiff><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3"><times id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.1"></times><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2">superscript</csymbol><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.2">𝑉</ci><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3">subscript</csymbol><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.2">𝜋</ci><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3">subscript</csymbol><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.2">𝜃</ci><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.3.2.3.3.3">𝑡</ci></apply></apply></apply><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.1.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.1.1">𝜇</ci></apply></apply><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3"><partialdiff id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.1"></partialdiff><apply id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.1.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.2.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.2">𝜃</ci><ci id="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.3.cmml" xref="S3.Thmtheorem2.p1.2.2.m2.1.1.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.2.2.m2.1c">\theta_{t+1}\leftarrow\theta_{t}+\eta\frac{\partial V^{\pi_{\theta_{t}}}(\mu)}%
{\partial\theta_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.2.2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ← italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_η divide start_ARG ∂ italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_μ ) end_ARG start_ARG ∂ italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> where <math alttext="V^{\pi_{\theta_{t}}}(\mu)=\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}%
\sim\pi_{\theta_{t}}(.|x)}\mathcal{R}(x,\mathbf{y})" class="ltx_math_unparsed" display="inline" id="S3.Thmtheorem2.p1.3.3.m3.3"><semantics id="S3.Thmtheorem2.p1.3.3.m3.3a"><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4"><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4.2"><msup id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.2"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.2.2">V</mi><msub id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.2.3"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.2.3.2">π</mi><msub id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.2.3.3"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.2.3.3.2">θ</mi><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.2.3.3.3">t</mi></msub></msub></msup><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.1">⁢</mo><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.3.2"><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.3.2.1" stretchy="false">(</mo><mi id="S3.Thmtheorem2.p1.3.3.m3.1.1">μ</mi><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.2.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.1">=</mo><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4.3"><msub id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.2"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.2.2">𝐄</mi><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.2.3"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.2.3.2">x</mi><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.2.3.1">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.2.3.3">𝒟</mi></mrow></msub><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.1">⁢</mo><msub id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.2">𝐄</mi><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.1">𝐲</mi><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.2">∼</mo><msub id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.3"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.3.2">π</mi><msub id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.3.3"><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.3.3.2">θ</mi><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.3.3.3">t</mi></msub></msub><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.4"><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.4.1" stretchy="false">(</mo><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.4.2" lspace="0em" rspace="0.167em">.</mo><mo fence="false" id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.4.4">x</mi><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.3.3.4.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.1a">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.4">ℛ</mi><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.1b">⁢</mo><mrow id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.5.2"><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.5.2.1" stretchy="false">(</mo><mi id="S3.Thmtheorem2.p1.3.3.m3.2.2">x</mi><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.5.2.2">,</mo><mi id="S3.Thmtheorem2.p1.3.3.m3.3.3">𝐲</mi><mo id="S3.Thmtheorem2.p1.3.3.m3.3.4.3.5.2.3" stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.3.3.m3.3b">V^{\pi_{\theta_{t}}}(\mu)=\mathbf{E}_{x\sim\mathcal{D}}\mathbf{E}_{\mathbf{y}%
\sim\pi_{\theta_{t}}(.|x)}\mathcal{R}(x,\mathbf{y})</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.3.3.m3.3c">italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_μ ) = bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT bold_E start_POSTSUBSCRIPT bold_y ∼ italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( . | italic_x ) end_POSTSUBSCRIPT caligraphic_R ( italic_x , bold_y )</annotation></semantics></math>. Then, for all <math alttext="t\geq 1" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.4.4.m4.1"><semantics id="S3.Thmtheorem2.p1.4.4.m4.1a"><mrow id="S3.Thmtheorem2.p1.4.4.m4.1.1" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.cmml"><mi id="S3.Thmtheorem2.p1.4.4.m4.1.1.2" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.2.cmml">t</mi><mo id="S3.Thmtheorem2.p1.4.4.m4.1.1.1" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.1.cmml">≥</mo><mn id="S3.Thmtheorem2.p1.4.4.m4.1.1.3" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.4.4.m4.1b"><apply id="S3.Thmtheorem2.p1.4.4.m4.1.1.cmml" xref="S3.Thmtheorem2.p1.4.4.m4.1.1"><geq id="S3.Thmtheorem2.p1.4.4.m4.1.1.1.cmml" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.1"></geq><ci id="S3.Thmtheorem2.p1.4.4.m4.1.1.2.cmml" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.2">𝑡</ci><cn id="S3.Thmtheorem2.p1.4.4.m4.1.1.3.cmml" type="integer" xref="S3.Thmtheorem2.p1.4.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.4.4.m4.1c">t\geq 1</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.4.4.m4.1d">italic_t ≥ 1</annotation></semantics></math>, with <math alttext="\eta=1/8" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.5.5.m5.1"><semantics id="S3.Thmtheorem2.p1.5.5.m5.1a"><mrow id="S3.Thmtheorem2.p1.5.5.m5.1.1" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.cmml"><mi id="S3.Thmtheorem2.p1.5.5.m5.1.1.2" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.2.cmml">η</mi><mo id="S3.Thmtheorem2.p1.5.5.m5.1.1.1" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1.cmml">=</mo><mrow id="S3.Thmtheorem2.p1.5.5.m5.1.1.3" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.cmml"><mn id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.cmml">1</mn><mo id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.1" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.1.cmml">/</mo><mn id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3.cmml">8</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.5.5.m5.1b"><apply id="S3.Thmtheorem2.p1.5.5.m5.1.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1"><eq id="S3.Thmtheorem2.p1.5.5.m5.1.1.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.1"></eq><ci id="S3.Thmtheorem2.p1.5.5.m5.1.1.2.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.2">𝜂</ci><apply id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3"><divide id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.1.cmml" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.1"></divide><cn id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2.cmml" type="integer" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.2">1</cn><cn id="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3.cmml" type="integer" xref="S3.Thmtheorem2.p1.5.5.m5.1.1.3.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.5.5.m5.1c">\eta=1/8</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.5.5.m5.1d">italic_η = 1 / 8</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}_{x\sim\mathcal{D}}[(\mathbf{\pi}^{*}(x)-\mathbf{\pi}_{\theta_{t}}(x%
))^{T}\mathbf{r}(x)]\leq\frac{16SA^{2}\rho^{2}}{t}\left\lVert\frac{1}{\mu}%
\right\rVert_{\infty}" class="ltx_Math" display="block" id="S3.E5.m1.5"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.cmml"><msub id="S3.E5.m1.5.5.1.3" xref="S3.E5.m1.5.5.1.3.cmml"><mi id="S3.E5.m1.5.5.1.3.2" xref="S3.E5.m1.5.5.1.3.2.cmml">𝐄</mi><mrow id="S3.E5.m1.5.5.1.3.3" xref="S3.E5.m1.5.5.1.3.3.cmml"><mi id="S3.E5.m1.5.5.1.3.3.2" xref="S3.E5.m1.5.5.1.3.3.2.cmml">x</mi><mo id="S3.E5.m1.5.5.1.3.3.1" xref="S3.E5.m1.5.5.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.3.3.3" xref="S3.E5.m1.5.5.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.2.cmml"><mo id="S3.E5.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.cmml"><msup id="S3.E5.m1.5.5.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><msup id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml">π</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">x</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><msub id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3.cmml">t</mi></msub></msub><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">x</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.5.5.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.E5.m1.5.5.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.5.5.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.3.cmml">𝐫</mi><mo id="S3.E5.m1.5.5.1.1.1.1.2a" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.4.2" xref="S3.E5.m1.5.5.1.1.1.1.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.4.2.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">x</mi><mo id="S3.E5.m1.5.5.1.1.1.1.4.2.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.5.5.1.1.1.3" stretchy="false" xref="S3.E5.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.5.5.2" xref="S3.E5.m1.5.5.2.cmml">≤</mo><mrow id="S3.E5.m1.5.5.3" xref="S3.E5.m1.5.5.3.cmml"><mfrac id="S3.E5.m1.5.5.3.2" xref="S3.E5.m1.5.5.3.2.cmml"><mrow id="S3.E5.m1.5.5.3.2.2" xref="S3.E5.m1.5.5.3.2.2.cmml"><mn id="S3.E5.m1.5.5.3.2.2.2" xref="S3.E5.m1.5.5.3.2.2.2.cmml">16</mn><mo id="S3.E5.m1.5.5.3.2.2.1" xref="S3.E5.m1.5.5.3.2.2.1.cmml">⁢</mo><mi id="S3.E5.m1.5.5.3.2.2.3" xref="S3.E5.m1.5.5.3.2.2.3.cmml">S</mi><mo id="S3.E5.m1.5.5.3.2.2.1a" xref="S3.E5.m1.5.5.3.2.2.1.cmml">⁢</mo><msup id="S3.E5.m1.5.5.3.2.2.4" xref="S3.E5.m1.5.5.3.2.2.4.cmml"><mi id="S3.E5.m1.5.5.3.2.2.4.2" xref="S3.E5.m1.5.5.3.2.2.4.2.cmml">A</mi><mn id="S3.E5.m1.5.5.3.2.2.4.3" xref="S3.E5.m1.5.5.3.2.2.4.3.cmml">2</mn></msup><mo id="S3.E5.m1.5.5.3.2.2.1b" xref="S3.E5.m1.5.5.3.2.2.1.cmml">⁢</mo><msup id="S3.E5.m1.5.5.3.2.2.5" xref="S3.E5.m1.5.5.3.2.2.5.cmml"><mi id="S3.E5.m1.5.5.3.2.2.5.2" xref="S3.E5.m1.5.5.3.2.2.5.2.cmml">ρ</mi><mn id="S3.E5.m1.5.5.3.2.2.5.3" xref="S3.E5.m1.5.5.3.2.2.5.3.cmml">2</mn></msup></mrow><mi id="S3.E5.m1.5.5.3.2.3" xref="S3.E5.m1.5.5.3.2.3.cmml">t</mi></mfrac><mo id="S3.E5.m1.5.5.3.1" lspace="0em" xref="S3.E5.m1.5.5.3.1.cmml">⁢</mo><msub id="S3.E5.m1.5.5.3.3" xref="S3.E5.m1.5.5.3.3.cmml"><mrow id="S3.E5.m1.5.5.3.3.2.2" xref="S3.E5.m1.5.5.3.3.2.1.cmml"><mo fence="true" id="S3.E5.m1.5.5.3.3.2.2.1" rspace="0em" stretchy="true" xref="S3.E5.m1.5.5.3.3.2.1.1.cmml">∥</mo><mfrac id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml"><mn id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.2.cmml">1</mn><mi id="S3.E5.m1.4.4.3" xref="S3.E5.m1.4.4.3.cmml">μ</mi></mfrac><mo fence="true" id="S3.E5.m1.5.5.3.3.2.2.2" lspace="0em" stretchy="true" xref="S3.E5.m1.5.5.3.3.2.1.1.cmml">∥</mo></mrow><mi id="S3.E5.m1.5.5.3.3.3" mathvariant="normal" xref="S3.E5.m1.5.5.3.3.3.cmml">∞</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5"><leq id="S3.E5.m1.5.5.2.cmml" xref="S3.E5.m1.5.5.2"></leq><apply id="S3.E5.m1.5.5.1.cmml" xref="S3.E5.m1.5.5.1"><times id="S3.E5.m1.5.5.1.2.cmml" xref="S3.E5.m1.5.5.1.2"></times><apply id="S3.E5.m1.5.5.1.3.cmml" xref="S3.E5.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.3.1.cmml" xref="S3.E5.m1.5.5.1.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.3.2.cmml" xref="S3.E5.m1.5.5.1.3.2">𝐄</ci><apply id="S3.E5.m1.5.5.1.3.3.cmml" xref="S3.E5.m1.5.5.1.3.3"><csymbol cd="latexml" id="S3.E5.m1.5.5.1.3.3.1.cmml" xref="S3.E5.m1.5.5.1.3.3.1">similar-to</csymbol><ci id="S3.E5.m1.5.5.1.3.3.2.cmml" xref="S3.E5.m1.5.5.1.3.3.2">𝑥</ci><ci id="S3.E5.m1.5.5.1.3.3.3.cmml" xref="S3.E5.m1.5.5.1.3.3.3">𝒟</ci></apply></apply><apply id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.5.5.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.5.5.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1"><times id="S3.E5.m1.5.5.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.2"></times><apply id="S3.E5.m1.5.5.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1"><minus id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2"><times id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2">𝜋</ci><times id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑥</ci></apply><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3"><times id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2">𝜋</ci><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝑥</ci></apply></apply><ci id="S3.E5.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.3">𝑇</ci></apply><ci id="S3.E5.m1.5.5.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.3">𝐫</ci><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑥</ci></apply></apply></apply><apply id="S3.E5.m1.5.5.3.cmml" xref="S3.E5.m1.5.5.3"><times id="S3.E5.m1.5.5.3.1.cmml" xref="S3.E5.m1.5.5.3.1"></times><apply id="S3.E5.m1.5.5.3.2.cmml" xref="S3.E5.m1.5.5.3.2"><divide id="S3.E5.m1.5.5.3.2.1.cmml" xref="S3.E5.m1.5.5.3.2"></divide><apply id="S3.E5.m1.5.5.3.2.2.cmml" xref="S3.E5.m1.5.5.3.2.2"><times id="S3.E5.m1.5.5.3.2.2.1.cmml" xref="S3.E5.m1.5.5.3.2.2.1"></times><cn id="S3.E5.m1.5.5.3.2.2.2.cmml" type="integer" xref="S3.E5.m1.5.5.3.2.2.2">16</cn><ci id="S3.E5.m1.5.5.3.2.2.3.cmml" xref="S3.E5.m1.5.5.3.2.2.3">𝑆</ci><apply id="S3.E5.m1.5.5.3.2.2.4.cmml" xref="S3.E5.m1.5.5.3.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.3.2.2.4.1.cmml" xref="S3.E5.m1.5.5.3.2.2.4">superscript</csymbol><ci id="S3.E5.m1.5.5.3.2.2.4.2.cmml" xref="S3.E5.m1.5.5.3.2.2.4.2">𝐴</ci><cn id="S3.E5.m1.5.5.3.2.2.4.3.cmml" type="integer" xref="S3.E5.m1.5.5.3.2.2.4.3">2</cn></apply><apply id="S3.E5.m1.5.5.3.2.2.5.cmml" xref="S3.E5.m1.5.5.3.2.2.5"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.3.2.2.5.1.cmml" xref="S3.E5.m1.5.5.3.2.2.5">superscript</csymbol><ci id="S3.E5.m1.5.5.3.2.2.5.2.cmml" xref="S3.E5.m1.5.5.3.2.2.5.2">𝜌</ci><cn id="S3.E5.m1.5.5.3.2.2.5.3.cmml" type="integer" xref="S3.E5.m1.5.5.3.2.2.5.3">2</cn></apply></apply><ci id="S3.E5.m1.5.5.3.2.3.cmml" xref="S3.E5.m1.5.5.3.2.3">𝑡</ci></apply><apply id="S3.E5.m1.5.5.3.3.cmml" xref="S3.E5.m1.5.5.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.3.3.1.cmml" xref="S3.E5.m1.5.5.3.3">subscript</csymbol><apply id="S3.E5.m1.5.5.3.3.2.1.cmml" xref="S3.E5.m1.5.5.3.3.2.2"><csymbol cd="latexml" id="S3.E5.m1.5.5.3.3.2.1.1.cmml" xref="S3.E5.m1.5.5.3.3.2.2.1">delimited-∥∥</csymbol><apply id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4"><divide id="S3.E5.m1.4.4.1.cmml" xref="S3.E5.m1.4.4"></divide><cn id="S3.E5.m1.4.4.2.cmml" type="integer" xref="S3.E5.m1.4.4.2">1</cn><ci id="S3.E5.m1.4.4.3.cmml" xref="S3.E5.m1.4.4.3">𝜇</ci></apply></apply><infinity id="S3.E5.m1.5.5.3.3.3.cmml" xref="S3.E5.m1.5.5.3.3.3"></infinity></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\mathbf{E}_{x\sim\mathcal{D}}[(\mathbf{\pi}^{*}(x)-\mathbf{\pi}_{\theta_{t}}(x%
))^{T}\mathbf{r}(x)]\leq\frac{16SA^{2}\rho^{2}}{t}\left\lVert\frac{1}{\mu}%
\right\rVert_{\infty}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.5d">bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT [ ( italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x ) - italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_x ) ] ≤ divide start_ARG 16 italic_S italic_A start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_ρ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t end_ARG ∥ divide start_ARG 1 end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.Thmtheorem2.p1.7"><span class="ltx_text ltx_font_italic" id="S3.Thmtheorem2.p1.7.2">where <math alttext="S=|X|" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.6.1.m1.1"><semantics id="S3.Thmtheorem2.p1.6.1.m1.1a"><mrow id="S3.Thmtheorem2.p1.6.1.m1.1.2" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.cmml"><mi id="S3.Thmtheorem2.p1.6.1.m1.1.2.2" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.2.cmml">S</mi><mo id="S3.Thmtheorem2.p1.6.1.m1.1.2.1" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.1.cmml">=</mo><mrow id="S3.Thmtheorem2.p1.6.1.m1.1.2.3.2" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.3.1.cmml"><mo id="S3.Thmtheorem2.p1.6.1.m1.1.2.3.2.1" stretchy="false" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.3.1.1.cmml">|</mo><mi id="S3.Thmtheorem2.p1.6.1.m1.1.1" xref="S3.Thmtheorem2.p1.6.1.m1.1.1.cmml">X</mi><mo id="S3.Thmtheorem2.p1.6.1.m1.1.2.3.2.2" stretchy="false" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.6.1.m1.1b"><apply id="S3.Thmtheorem2.p1.6.1.m1.1.2.cmml" xref="S3.Thmtheorem2.p1.6.1.m1.1.2"><eq id="S3.Thmtheorem2.p1.6.1.m1.1.2.1.cmml" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.1"></eq><ci id="S3.Thmtheorem2.p1.6.1.m1.1.2.2.cmml" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.2">𝑆</ci><apply id="S3.Thmtheorem2.p1.6.1.m1.1.2.3.1.cmml" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.3.2"><abs id="S3.Thmtheorem2.p1.6.1.m1.1.2.3.1.1.cmml" xref="S3.Thmtheorem2.p1.6.1.m1.1.2.3.2.1"></abs><ci id="S3.Thmtheorem2.p1.6.1.m1.1.1.cmml" xref="S3.Thmtheorem2.p1.6.1.m1.1.1">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.6.1.m1.1c">S=|X|</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.6.1.m1.1d">italic_S = | italic_X |</annotation></semantics></math> is the number of states and <math alttext="A" class="ltx_Math" display="inline" id="S3.Thmtheorem2.p1.7.2.m2.1"><semantics id="S3.Thmtheorem2.p1.7.2.m2.1a"><mi id="S3.Thmtheorem2.p1.7.2.m2.1.1" xref="S3.Thmtheorem2.p1.7.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem2.p1.7.2.m2.1b"><ci id="S3.Thmtheorem2.p1.7.2.m2.1.1.cmml" xref="S3.Thmtheorem2.p1.7.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem2.p1.7.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.Thmtheorem2.p1.7.2.m2.1d">italic_A</annotation></semantics></math> is the number of actions.
</span></p>
</div>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.3">Proof is in Appendix. The proof uses Thm. 4 from <cite class="ltx_cite ltx_citemacro_citep">(Mei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib24" title="">2020</a>)</cite> for a Markov Decision Process and adapts it to the single-step problem and additionally uses Assumption 2 to express the bound in terms of <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_ρ</annotation></semantics></math> and <math alttext="A" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mi id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><ci id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">italic_A</annotation></semantics></math>. Since the policy outputs a list of top-k items, the total number of possible actions is <math alttext="A=C(|Z|,k)" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.3"><semantics id="S3.SS4.p3.3.m3.3a"><mrow id="S3.SS4.p3.3.m3.3.3" xref="S3.SS4.p3.3.m3.3.3.cmml"><mi id="S3.SS4.p3.3.m3.3.3.3" xref="S3.SS4.p3.3.m3.3.3.3.cmml">A</mi><mo id="S3.SS4.p3.3.m3.3.3.2" xref="S3.SS4.p3.3.m3.3.3.2.cmml">=</mo><mrow id="S3.SS4.p3.3.m3.3.3.1" xref="S3.SS4.p3.3.m3.3.3.1.cmml"><mi id="S3.SS4.p3.3.m3.3.3.1.3" xref="S3.SS4.p3.3.m3.3.3.1.3.cmml">C</mi><mo id="S3.SS4.p3.3.m3.3.3.1.2" xref="S3.SS4.p3.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS4.p3.3.m3.3.3.1.1.1" xref="S3.SS4.p3.3.m3.3.3.1.1.2.cmml"><mo id="S3.SS4.p3.3.m3.3.3.1.1.1.2" stretchy="false" xref="S3.SS4.p3.3.m3.3.3.1.1.2.cmml">(</mo><mrow id="S3.SS4.p3.3.m3.3.3.1.1.1.1.2" xref="S3.SS4.p3.3.m3.3.3.1.1.1.1.1.cmml"><mo id="S3.SS4.p3.3.m3.3.3.1.1.1.1.2.1" stretchy="false" xref="S3.SS4.p3.3.m3.3.3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml">Z</mi><mo id="S3.SS4.p3.3.m3.3.3.1.1.1.1.2.2" stretchy="false" xref="S3.SS4.p3.3.m3.3.3.1.1.1.1.1.1.cmml">|</mo></mrow><mo id="S3.SS4.p3.3.m3.3.3.1.1.1.3" xref="S3.SS4.p3.3.m3.3.3.1.1.2.cmml">,</mo><mi id="S3.SS4.p3.3.m3.2.2" xref="S3.SS4.p3.3.m3.2.2.cmml">k</mi><mo id="S3.SS4.p3.3.m3.3.3.1.1.1.4" stretchy="false" xref="S3.SS4.p3.3.m3.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.3b"><apply id="S3.SS4.p3.3.m3.3.3.cmml" xref="S3.SS4.p3.3.m3.3.3"><eq id="S3.SS4.p3.3.m3.3.3.2.cmml" xref="S3.SS4.p3.3.m3.3.3.2"></eq><ci id="S3.SS4.p3.3.m3.3.3.3.cmml" xref="S3.SS4.p3.3.m3.3.3.3">𝐴</ci><apply id="S3.SS4.p3.3.m3.3.3.1.cmml" xref="S3.SS4.p3.3.m3.3.3.1"><times id="S3.SS4.p3.3.m3.3.3.1.2.cmml" xref="S3.SS4.p3.3.m3.3.3.1.2"></times><ci id="S3.SS4.p3.3.m3.3.3.1.3.cmml" xref="S3.SS4.p3.3.m3.3.3.1.3">𝐶</ci><interval closure="open" id="S3.SS4.p3.3.m3.3.3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.3.3.1.1.1"><apply id="S3.SS4.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS4.p3.3.m3.3.3.1.1.1.1.2"><abs id="S3.SS4.p3.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.3.m3.3.3.1.1.1.1.2.1"></abs><ci id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">𝑍</ci></apply><ci id="S3.SS4.p3.3.m3.2.2.cmml" xref="S3.SS4.p3.3.m3.2.2">𝑘</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.3c">A=C(|Z|,k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.3d">italic_A = italic_C ( | italic_Z | , italic_k )</annotation></semantics></math>, indicating a high sample complexity. In the next section, we describe how we reduce the effective sample complexity and derive a practical algorithm.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Large Action Policy Gradient</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.2">Proposition <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Thmtheorem2" title="Proposition 0. ‣ 3.4. The challenge with large action spaces ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">2</span></a> shows that a naive application of the policy gradient algorithm will be slow to converge to the optimal reward-maximizing solution due to a combinatorially large action space. First, we show that the combinatorial action space <math alttext="A=C(|Z|,k)" class="ltx_Math" display="inline" id="S4.p1.1.m1.3"><semantics id="S4.p1.1.m1.3a"><mrow id="S4.p1.1.m1.3.3" xref="S4.p1.1.m1.3.3.cmml"><mi id="S4.p1.1.m1.3.3.3" xref="S4.p1.1.m1.3.3.3.cmml">A</mi><mo id="S4.p1.1.m1.3.3.2" xref="S4.p1.1.m1.3.3.2.cmml">=</mo><mrow id="S4.p1.1.m1.3.3.1" xref="S4.p1.1.m1.3.3.1.cmml"><mi id="S4.p1.1.m1.3.3.1.3" xref="S4.p1.1.m1.3.3.1.3.cmml">C</mi><mo id="S4.p1.1.m1.3.3.1.2" xref="S4.p1.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.p1.1.m1.3.3.1.1.1" xref="S4.p1.1.m1.3.3.1.1.2.cmml"><mo id="S4.p1.1.m1.3.3.1.1.1.2" stretchy="false" xref="S4.p1.1.m1.3.3.1.1.2.cmml">(</mo><mrow id="S4.p1.1.m1.3.3.1.1.1.1.2" xref="S4.p1.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S4.p1.1.m1.3.3.1.1.1.1.2.1" stretchy="false" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1.cmml">|</mo><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">Z</mi><mo id="S4.p1.1.m1.3.3.1.1.1.1.2.2" stretchy="false" xref="S4.p1.1.m1.3.3.1.1.1.1.1.1.cmml">|</mo></mrow><mo id="S4.p1.1.m1.3.3.1.1.1.3" xref="S4.p1.1.m1.3.3.1.1.2.cmml">,</mo><mi id="S4.p1.1.m1.2.2" xref="S4.p1.1.m1.2.2.cmml">k</mi><mo id="S4.p1.1.m1.3.3.1.1.1.4" stretchy="false" xref="S4.p1.1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.3b"><apply id="S4.p1.1.m1.3.3.cmml" xref="S4.p1.1.m1.3.3"><eq id="S4.p1.1.m1.3.3.2.cmml" xref="S4.p1.1.m1.3.3.2"></eq><ci id="S4.p1.1.m1.3.3.3.cmml" xref="S4.p1.1.m1.3.3.3">𝐴</ci><apply id="S4.p1.1.m1.3.3.1.cmml" xref="S4.p1.1.m1.3.3.1"><times id="S4.p1.1.m1.3.3.1.2.cmml" xref="S4.p1.1.m1.3.3.1.2"></times><ci id="S4.p1.1.m1.3.3.1.3.cmml" xref="S4.p1.1.m1.3.3.1.3">𝐶</ci><interval closure="open" id="S4.p1.1.m1.3.3.1.1.2.cmml" xref="S4.p1.1.m1.3.3.1.1.1"><apply id="S4.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.p1.1.m1.3.3.1.1.1.1.2"><abs id="S4.p1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.3.3.1.1.1.1.2.1"></abs><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑍</ci></apply><ci id="S4.p1.1.m1.2.2.cmml" xref="S4.p1.1.m1.2.2">𝑘</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.3c">A=C(|Z|,k)</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.3d">italic_A = italic_C ( | italic_Z | , italic_k )</annotation></semantics></math> can be decomposed into item-wise action space, <math alttext="A=|Z|" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.2" xref="S4.p1.2.m2.1.2.cmml"><mi id="S4.p1.2.m2.1.2.2" xref="S4.p1.2.m2.1.2.2.cmml">A</mi><mo id="S4.p1.2.m2.1.2.1" xref="S4.p1.2.m2.1.2.1.cmml">=</mo><mrow id="S4.p1.2.m2.1.2.3.2" xref="S4.p1.2.m2.1.2.3.1.cmml"><mo id="S4.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S4.p1.2.m2.1.2.3.1.1.cmml">|</mo><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">Z</mi><mo id="S4.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S4.p1.2.m2.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.2.cmml" xref="S4.p1.2.m2.1.2"><eq id="S4.p1.2.m2.1.2.1.cmml" xref="S4.p1.2.m2.1.2.1"></eq><ci id="S4.p1.2.m2.1.2.2.cmml" xref="S4.p1.2.m2.1.2.2">𝐴</ci><apply id="S4.p1.2.m2.1.2.3.1.cmml" xref="S4.p1.2.m2.1.2.3.2"><abs id="S4.p1.2.m2.1.2.3.1.1.cmml" xref="S4.p1.2.m2.1.2.3.2.1"></abs><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">A=|Z|</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_A = | italic_Z |</annotation></semantics></math> whenever the reward over top-k items can be decomposed as an additive sum over item-wise rewards. We show that most common novelty reward functions satisfy this property. Second, we provide a reformulation of the RL problem that reduces the action space to a binary decision and further increases the rate of convergence.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Reduction from Top-k to item-wise rewards</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.7">As stated in Section 3, the reward function is a combination of novelty and relevance rewards. We assume that both novelty and relevance rewards compose additively. That is, given a query <math alttext="x" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_x</annotation></semantics></math>,
<math alttext="Novelty@k(x,\phi,\psi,L)=\sum_{j=1}^{k}Novelty(\langle x,z_{j}\rangle,\phi,%
\psi,L)" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.9"><semantics id="S4.SS1.p1.2.m2.9a"><mrow id="S4.SS1.p1.2.m2.9.9" xref="S4.SS1.p1.2.m2.9.9.cmml"><mrow id="S4.SS1.p1.2.m2.9.9.3" xref="S4.SS1.p1.2.m2.9.9.3.cmml"><mi id="S4.SS1.p1.2.m2.9.9.3.2" xref="S4.SS1.p1.2.m2.9.9.3.2.cmml">N</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.3" xref="S4.SS1.p1.2.m2.9.9.3.3.cmml">o</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1a" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.4" xref="S4.SS1.p1.2.m2.9.9.3.4.cmml">v</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1b" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.5" xref="S4.SS1.p1.2.m2.9.9.3.5.cmml">e</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1c" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.6" xref="S4.SS1.p1.2.m2.9.9.3.6.cmml">l</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1d" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.7" xref="S4.SS1.p1.2.m2.9.9.3.7.cmml">t</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1e" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.8" xref="S4.SS1.p1.2.m2.9.9.3.8.cmml">y</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1f" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.9" mathvariant="normal" xref="S4.SS1.p1.2.m2.9.9.3.9.cmml">@</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1g" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.3.10" xref="S4.SS1.p1.2.m2.9.9.3.10.cmml">k</mi><mo id="S4.SS1.p1.2.m2.9.9.3.1h" xref="S4.SS1.p1.2.m2.9.9.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.2.m2.9.9.3.11.2" xref="S4.SS1.p1.2.m2.9.9.3.11.1.cmml"><mo id="S4.SS1.p1.2.m2.9.9.3.11.2.1" stretchy="false" xref="S4.SS1.p1.2.m2.9.9.3.11.1.cmml">(</mo><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">x</mi><mo id="S4.SS1.p1.2.m2.9.9.3.11.2.2" xref="S4.SS1.p1.2.m2.9.9.3.11.1.cmml">,</mo><mi id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml">ϕ</mi><mo id="S4.SS1.p1.2.m2.9.9.3.11.2.3" xref="S4.SS1.p1.2.m2.9.9.3.11.1.cmml">,</mo><mi id="S4.SS1.p1.2.m2.3.3" xref="S4.SS1.p1.2.m2.3.3.cmml">ψ</mi><mo id="S4.SS1.p1.2.m2.9.9.3.11.2.4" xref="S4.SS1.p1.2.m2.9.9.3.11.1.cmml">,</mo><mi id="S4.SS1.p1.2.m2.4.4" xref="S4.SS1.p1.2.m2.4.4.cmml">L</mi><mo id="S4.SS1.p1.2.m2.9.9.3.11.2.5" stretchy="false" xref="S4.SS1.p1.2.m2.9.9.3.11.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.2.m2.9.9.2" rspace="0.111em" xref="S4.SS1.p1.2.m2.9.9.2.cmml">=</mo><mrow id="S4.SS1.p1.2.m2.9.9.1" xref="S4.SS1.p1.2.m2.9.9.1.cmml"><msubsup id="S4.SS1.p1.2.m2.9.9.1.2" xref="S4.SS1.p1.2.m2.9.9.1.2.cmml"><mo id="S4.SS1.p1.2.m2.9.9.1.2.2.2" xref="S4.SS1.p1.2.m2.9.9.1.2.2.2.cmml">∑</mo><mrow id="S4.SS1.p1.2.m2.9.9.1.2.2.3" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3.cmml"><mi id="S4.SS1.p1.2.m2.9.9.1.2.2.3.2" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3.2.cmml">j</mi><mo id="S4.SS1.p1.2.m2.9.9.1.2.2.3.1" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.9.9.1.2.2.3.3" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.2.m2.9.9.1.2.3" xref="S4.SS1.p1.2.m2.9.9.1.2.3.cmml">k</mi></msubsup><mrow id="S4.SS1.p1.2.m2.9.9.1.1" xref="S4.SS1.p1.2.m2.9.9.1.1.cmml"><mi id="S4.SS1.p1.2.m2.9.9.1.1.3" xref="S4.SS1.p1.2.m2.9.9.1.1.3.cmml">N</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.2" xref="S4.SS1.p1.2.m2.9.9.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.1.1.4" xref="S4.SS1.p1.2.m2.9.9.1.1.4.cmml">o</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.2a" xref="S4.SS1.p1.2.m2.9.9.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.1.1.5" xref="S4.SS1.p1.2.m2.9.9.1.1.5.cmml">v</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.2b" xref="S4.SS1.p1.2.m2.9.9.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.1.1.6" xref="S4.SS1.p1.2.m2.9.9.1.1.6.cmml">e</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.2c" xref="S4.SS1.p1.2.m2.9.9.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.1.1.7" xref="S4.SS1.p1.2.m2.9.9.1.1.7.cmml">l</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.2d" xref="S4.SS1.p1.2.m2.9.9.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.1.1.8" xref="S4.SS1.p1.2.m2.9.9.1.1.8.cmml">t</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.2e" xref="S4.SS1.p1.2.m2.9.9.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.2.m2.9.9.1.1.9" xref="S4.SS1.p1.2.m2.9.9.1.1.9.cmml">y</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.2f" xref="S4.SS1.p1.2.m2.9.9.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p1.2.m2.9.9.1.1.1.1" xref="S4.SS1.p1.2.m2.9.9.1.1.1.2.cmml"><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.2.m2.9.9.1.1.1.2.cmml">(</mo><mrow id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.2.cmml">⟨</mo><mi id="S4.SS1.p1.2.m2.5.5" xref="S4.SS1.p1.2.m2.5.5.cmml">x</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.2.cmml">,</mo><msub id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.4" stretchy="false" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.2.cmml">⟩</mo></mrow><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.3" xref="S4.SS1.p1.2.m2.9.9.1.1.1.2.cmml">,</mo><mi id="S4.SS1.p1.2.m2.6.6" xref="S4.SS1.p1.2.m2.6.6.cmml">ϕ</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.4" xref="S4.SS1.p1.2.m2.9.9.1.1.1.2.cmml">,</mo><mi id="S4.SS1.p1.2.m2.7.7" xref="S4.SS1.p1.2.m2.7.7.cmml">ψ</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.5" xref="S4.SS1.p1.2.m2.9.9.1.1.1.2.cmml">,</mo><mi id="S4.SS1.p1.2.m2.8.8" xref="S4.SS1.p1.2.m2.8.8.cmml">L</mi><mo id="S4.SS1.p1.2.m2.9.9.1.1.1.1.6" stretchy="false" xref="S4.SS1.p1.2.m2.9.9.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.9b"><apply id="S4.SS1.p1.2.m2.9.9.cmml" xref="S4.SS1.p1.2.m2.9.9"><eq id="S4.SS1.p1.2.m2.9.9.2.cmml" xref="S4.SS1.p1.2.m2.9.9.2"></eq><apply id="S4.SS1.p1.2.m2.9.9.3.cmml" xref="S4.SS1.p1.2.m2.9.9.3"><times id="S4.SS1.p1.2.m2.9.9.3.1.cmml" xref="S4.SS1.p1.2.m2.9.9.3.1"></times><ci id="S4.SS1.p1.2.m2.9.9.3.2.cmml" xref="S4.SS1.p1.2.m2.9.9.3.2">𝑁</ci><ci id="S4.SS1.p1.2.m2.9.9.3.3.cmml" xref="S4.SS1.p1.2.m2.9.9.3.3">𝑜</ci><ci id="S4.SS1.p1.2.m2.9.9.3.4.cmml" xref="S4.SS1.p1.2.m2.9.9.3.4">𝑣</ci><ci id="S4.SS1.p1.2.m2.9.9.3.5.cmml" xref="S4.SS1.p1.2.m2.9.9.3.5">𝑒</ci><ci id="S4.SS1.p1.2.m2.9.9.3.6.cmml" xref="S4.SS1.p1.2.m2.9.9.3.6">𝑙</ci><ci id="S4.SS1.p1.2.m2.9.9.3.7.cmml" xref="S4.SS1.p1.2.m2.9.9.3.7">𝑡</ci><ci id="S4.SS1.p1.2.m2.9.9.3.8.cmml" xref="S4.SS1.p1.2.m2.9.9.3.8">𝑦</ci><ci id="S4.SS1.p1.2.m2.9.9.3.9.cmml" xref="S4.SS1.p1.2.m2.9.9.3.9">@</ci><ci id="S4.SS1.p1.2.m2.9.9.3.10.cmml" xref="S4.SS1.p1.2.m2.9.9.3.10">𝑘</ci><vector id="S4.SS1.p1.2.m2.9.9.3.11.1.cmml" xref="S4.SS1.p1.2.m2.9.9.3.11.2"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑥</ci><ci id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2">italic-ϕ</ci><ci id="S4.SS1.p1.2.m2.3.3.cmml" xref="S4.SS1.p1.2.m2.3.3">𝜓</ci><ci id="S4.SS1.p1.2.m2.4.4.cmml" xref="S4.SS1.p1.2.m2.4.4">𝐿</ci></vector></apply><apply id="S4.SS1.p1.2.m2.9.9.1.cmml" xref="S4.SS1.p1.2.m2.9.9.1"><apply id="S4.SS1.p1.2.m2.9.9.1.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.9.9.1.2.1.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2">superscript</csymbol><apply id="S4.SS1.p1.2.m2.9.9.1.2.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.9.9.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2">subscript</csymbol><sum id="S4.SS1.p1.2.m2.9.9.1.2.2.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2.2.2"></sum><apply id="S4.SS1.p1.2.m2.9.9.1.2.2.3.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3"><eq id="S4.SS1.p1.2.m2.9.9.1.2.2.3.1.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3.1"></eq><ci id="S4.SS1.p1.2.m2.9.9.1.2.2.3.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3.2">𝑗</ci><cn id="S4.SS1.p1.2.m2.9.9.1.2.2.3.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.9.9.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.2.m2.9.9.1.2.3.cmml" xref="S4.SS1.p1.2.m2.9.9.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p1.2.m2.9.9.1.1.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1"><times id="S4.SS1.p1.2.m2.9.9.1.1.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.2"></times><ci id="S4.SS1.p1.2.m2.9.9.1.1.3.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.3">𝑁</ci><ci id="S4.SS1.p1.2.m2.9.9.1.1.4.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.4">𝑜</ci><ci id="S4.SS1.p1.2.m2.9.9.1.1.5.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.5">𝑣</ci><ci id="S4.SS1.p1.2.m2.9.9.1.1.6.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.6">𝑒</ci><ci id="S4.SS1.p1.2.m2.9.9.1.1.7.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.7">𝑙</ci><ci id="S4.SS1.p1.2.m2.9.9.1.1.8.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.8">𝑡</ci><ci id="S4.SS1.p1.2.m2.9.9.1.1.9.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.9">𝑦</ci><vector id="S4.SS1.p1.2.m2.9.9.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1"><list id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1"><ci id="S4.SS1.p1.2.m2.5.5.cmml" xref="S4.SS1.p1.2.m2.5.5">𝑥</ci><apply id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.9.9.1.1.1.1.1.1.1.3">𝑗</ci></apply></list><ci id="S4.SS1.p1.2.m2.6.6.cmml" xref="S4.SS1.p1.2.m2.6.6">italic-ϕ</ci><ci id="S4.SS1.p1.2.m2.7.7.cmml" xref="S4.SS1.p1.2.m2.7.7">𝜓</ci><ci id="S4.SS1.p1.2.m2.8.8.cmml" xref="S4.SS1.p1.2.m2.8.8">𝐿</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.9c">Novelty@k(x,\phi,\psi,L)=\sum_{j=1}^{k}Novelty(\langle x,z_{j}\rangle,\phi,%
\psi,L)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.9d">italic_N italic_o italic_v italic_e italic_l italic_t italic_y @ italic_k ( italic_x , italic_ϕ , italic_ψ , italic_L ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_N italic_o italic_v italic_e italic_l italic_t italic_y ( ⟨ italic_x , italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ , italic_ϕ , italic_ψ , italic_L )</annotation></semantics></math>, and we have
<math alttext="Relevance@k(x,\phi)=\sum_{j=1}^{k}Relevance(\langle x,z_{j}\rangle,\phi)" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.5"><semantics id="S4.SS1.p1.3.m3.5a"><mrow id="S4.SS1.p1.3.m3.5.5" xref="S4.SS1.p1.3.m3.5.5.cmml"><mrow id="S4.SS1.p1.3.m3.5.5.3" xref="S4.SS1.p1.3.m3.5.5.3.cmml"><mi id="S4.SS1.p1.3.m3.5.5.3.2" xref="S4.SS1.p1.3.m3.5.5.3.2.cmml">R</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.3" xref="S4.SS1.p1.3.m3.5.5.3.3.cmml">e</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1a" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.4" xref="S4.SS1.p1.3.m3.5.5.3.4.cmml">l</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1b" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.5" xref="S4.SS1.p1.3.m3.5.5.3.5.cmml">e</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1c" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.6" xref="S4.SS1.p1.3.m3.5.5.3.6.cmml">v</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1d" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.7" xref="S4.SS1.p1.3.m3.5.5.3.7.cmml">a</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1e" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.8" xref="S4.SS1.p1.3.m3.5.5.3.8.cmml">n</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1f" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.9" xref="S4.SS1.p1.3.m3.5.5.3.9.cmml">c</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1g" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.10" xref="S4.SS1.p1.3.m3.5.5.3.10.cmml">e</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1h" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.11" mathvariant="normal" xref="S4.SS1.p1.3.m3.5.5.3.11.cmml">@</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1i" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.3.12" xref="S4.SS1.p1.3.m3.5.5.3.12.cmml">k</mi><mo id="S4.SS1.p1.3.m3.5.5.3.1j" xref="S4.SS1.p1.3.m3.5.5.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.3.m3.5.5.3.13.2" xref="S4.SS1.p1.3.m3.5.5.3.13.1.cmml"><mo id="S4.SS1.p1.3.m3.5.5.3.13.2.1" stretchy="false" xref="S4.SS1.p1.3.m3.5.5.3.13.1.cmml">(</mo><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">x</mi><mo id="S4.SS1.p1.3.m3.5.5.3.13.2.2" xref="S4.SS1.p1.3.m3.5.5.3.13.1.cmml">,</mo><mi id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">ϕ</mi><mo id="S4.SS1.p1.3.m3.5.5.3.13.2.3" stretchy="false" xref="S4.SS1.p1.3.m3.5.5.3.13.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.3.m3.5.5.2" rspace="0.111em" xref="S4.SS1.p1.3.m3.5.5.2.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.5.5.1" xref="S4.SS1.p1.3.m3.5.5.1.cmml"><msubsup id="S4.SS1.p1.3.m3.5.5.1.2" xref="S4.SS1.p1.3.m3.5.5.1.2.cmml"><mo id="S4.SS1.p1.3.m3.5.5.1.2.2.2" xref="S4.SS1.p1.3.m3.5.5.1.2.2.2.cmml">∑</mo><mrow id="S4.SS1.p1.3.m3.5.5.1.2.2.3" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3.cmml"><mi id="S4.SS1.p1.3.m3.5.5.1.2.2.3.2" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3.2.cmml">j</mi><mo id="S4.SS1.p1.3.m3.5.5.1.2.2.3.1" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.3.m3.5.5.1.2.2.3.3" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.3.m3.5.5.1.2.3" xref="S4.SS1.p1.3.m3.5.5.1.2.3.cmml">k</mi></msubsup><mrow id="S4.SS1.p1.3.m3.5.5.1.1" xref="S4.SS1.p1.3.m3.5.5.1.1.cmml"><mi id="S4.SS1.p1.3.m3.5.5.1.1.3" xref="S4.SS1.p1.3.m3.5.5.1.1.3.cmml">R</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.4" xref="S4.SS1.p1.3.m3.5.5.1.1.4.cmml">e</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2a" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.5" xref="S4.SS1.p1.3.m3.5.5.1.1.5.cmml">l</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2b" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.6" xref="S4.SS1.p1.3.m3.5.5.1.1.6.cmml">e</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2c" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.7" xref="S4.SS1.p1.3.m3.5.5.1.1.7.cmml">v</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2d" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.8" xref="S4.SS1.p1.3.m3.5.5.1.1.8.cmml">a</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2e" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.9" xref="S4.SS1.p1.3.m3.5.5.1.1.9.cmml">n</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2f" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.10" xref="S4.SS1.p1.3.m3.5.5.1.1.10.cmml">c</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2g" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p1.3.m3.5.5.1.1.11" xref="S4.SS1.p1.3.m3.5.5.1.1.11.cmml">e</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.2h" xref="S4.SS1.p1.3.m3.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p1.3.m3.5.5.1.1.1.1" xref="S4.SS1.p1.3.m3.5.5.1.1.1.2.cmml"><mo id="S4.SS1.p1.3.m3.5.5.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.3.m3.5.5.1.1.1.2.cmml">(</mo><mrow id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.2.cmml">⟨</mo><mi id="S4.SS1.p1.3.m3.3.3" xref="S4.SS1.p1.3.m3.3.3.cmml">x</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.3" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.2.cmml">,</mo><msub id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.4" stretchy="false" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.2.cmml">⟩</mo></mrow><mo id="S4.SS1.p1.3.m3.5.5.1.1.1.1.3" xref="S4.SS1.p1.3.m3.5.5.1.1.1.2.cmml">,</mo><mi id="S4.SS1.p1.3.m3.4.4" xref="S4.SS1.p1.3.m3.4.4.cmml">ϕ</mi><mo id="S4.SS1.p1.3.m3.5.5.1.1.1.1.4" stretchy="false" xref="S4.SS1.p1.3.m3.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.5b"><apply id="S4.SS1.p1.3.m3.5.5.cmml" xref="S4.SS1.p1.3.m3.5.5"><eq id="S4.SS1.p1.3.m3.5.5.2.cmml" xref="S4.SS1.p1.3.m3.5.5.2"></eq><apply id="S4.SS1.p1.3.m3.5.5.3.cmml" xref="S4.SS1.p1.3.m3.5.5.3"><times id="S4.SS1.p1.3.m3.5.5.3.1.cmml" xref="S4.SS1.p1.3.m3.5.5.3.1"></times><ci id="S4.SS1.p1.3.m3.5.5.3.2.cmml" xref="S4.SS1.p1.3.m3.5.5.3.2">𝑅</ci><ci id="S4.SS1.p1.3.m3.5.5.3.3.cmml" xref="S4.SS1.p1.3.m3.5.5.3.3">𝑒</ci><ci id="S4.SS1.p1.3.m3.5.5.3.4.cmml" xref="S4.SS1.p1.3.m3.5.5.3.4">𝑙</ci><ci id="S4.SS1.p1.3.m3.5.5.3.5.cmml" xref="S4.SS1.p1.3.m3.5.5.3.5">𝑒</ci><ci id="S4.SS1.p1.3.m3.5.5.3.6.cmml" xref="S4.SS1.p1.3.m3.5.5.3.6">𝑣</ci><ci id="S4.SS1.p1.3.m3.5.5.3.7.cmml" xref="S4.SS1.p1.3.m3.5.5.3.7">𝑎</ci><ci id="S4.SS1.p1.3.m3.5.5.3.8.cmml" xref="S4.SS1.p1.3.m3.5.5.3.8">𝑛</ci><ci id="S4.SS1.p1.3.m3.5.5.3.9.cmml" xref="S4.SS1.p1.3.m3.5.5.3.9">𝑐</ci><ci id="S4.SS1.p1.3.m3.5.5.3.10.cmml" xref="S4.SS1.p1.3.m3.5.5.3.10">𝑒</ci><ci id="S4.SS1.p1.3.m3.5.5.3.11.cmml" xref="S4.SS1.p1.3.m3.5.5.3.11">@</ci><ci id="S4.SS1.p1.3.m3.5.5.3.12.cmml" xref="S4.SS1.p1.3.m3.5.5.3.12">𝑘</ci><interval closure="open" id="S4.SS1.p1.3.m3.5.5.3.13.1.cmml" xref="S4.SS1.p1.3.m3.5.5.3.13.2"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑥</ci><ci id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2">italic-ϕ</ci></interval></apply><apply id="S4.SS1.p1.3.m3.5.5.1.cmml" xref="S4.SS1.p1.3.m3.5.5.1"><apply id="S4.SS1.p1.3.m3.5.5.1.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.1.2.1.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2">superscript</csymbol><apply id="S4.SS1.p1.3.m3.5.5.1.2.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.1.2.2.1.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2">subscript</csymbol><sum id="S4.SS1.p1.3.m3.5.5.1.2.2.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2.2.2"></sum><apply id="S4.SS1.p1.3.m3.5.5.1.2.2.3.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3"><eq id="S4.SS1.p1.3.m3.5.5.1.2.2.3.1.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3.1"></eq><ci id="S4.SS1.p1.3.m3.5.5.1.2.2.3.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3.2">𝑗</ci><cn id="S4.SS1.p1.3.m3.5.5.1.2.2.3.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.5.5.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.3.m3.5.5.1.2.3.cmml" xref="S4.SS1.p1.3.m3.5.5.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p1.3.m3.5.5.1.1.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1"><times id="S4.SS1.p1.3.m3.5.5.1.1.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.2"></times><ci id="S4.SS1.p1.3.m3.5.5.1.1.3.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.3">𝑅</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.4.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.4">𝑒</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.5.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.5">𝑙</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.6.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.6">𝑒</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.7.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.7">𝑣</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.8.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.8">𝑎</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.9.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.9">𝑛</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.10.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.10">𝑐</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.11.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.11">𝑒</ci><interval closure="open" id="S4.SS1.p1.3.m3.5.5.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1"><list id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1"><ci id="S4.SS1.p1.3.m3.3.3.cmml" xref="S4.SS1.p1.3.m3.3.3">𝑥</ci><apply id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.3.m3.5.5.1.1.1.1.1.1.1.3">𝑗</ci></apply></list><ci id="S4.SS1.p1.3.m3.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4">italic-ϕ</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.5c">Relevance@k(x,\phi)=\sum_{j=1}^{k}Relevance(\langle x,z_{j}\rangle,\phi)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.5d">italic_R italic_e italic_l italic_e italic_v italic_a italic_n italic_c italic_e @ italic_k ( italic_x , italic_ϕ ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_R italic_e italic_l italic_e italic_v italic_a italic_n italic_c italic_e ( ⟨ italic_x , italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ , italic_ϕ )</annotation></semantics></math>;
where <math alttext="z_{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">z</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑧</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">z_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are the individual item predictions and <math alttext="Relevance@k" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">R</mi><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">e</mi><mo id="S4.SS1.p1.5.m5.1.1.1a" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.4" xref="S4.SS1.p1.5.m5.1.1.4.cmml">l</mi><mo id="S4.SS1.p1.5.m5.1.1.1b" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.5" xref="S4.SS1.p1.5.m5.1.1.5.cmml">e</mi><mo id="S4.SS1.p1.5.m5.1.1.1c" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.6" xref="S4.SS1.p1.5.m5.1.1.6.cmml">v</mi><mo id="S4.SS1.p1.5.m5.1.1.1d" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.7" xref="S4.SS1.p1.5.m5.1.1.7.cmml">a</mi><mo id="S4.SS1.p1.5.m5.1.1.1e" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.8" xref="S4.SS1.p1.5.m5.1.1.8.cmml">n</mi><mo id="S4.SS1.p1.5.m5.1.1.1f" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.9" xref="S4.SS1.p1.5.m5.1.1.9.cmml">c</mi><mo id="S4.SS1.p1.5.m5.1.1.1g" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.10" xref="S4.SS1.p1.5.m5.1.1.10.cmml">e</mi><mo id="S4.SS1.p1.5.m5.1.1.1h" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.11" mathvariant="normal" xref="S4.SS1.p1.5.m5.1.1.11.cmml">@</mi><mo id="S4.SS1.p1.5.m5.1.1.1i" xref="S4.SS1.p1.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS1.p1.5.m5.1.1.12" xref="S4.SS1.p1.5.m5.1.1.12.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><times id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></times><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑅</ci><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑒</ci><ci id="S4.SS1.p1.5.m5.1.1.4.cmml" xref="S4.SS1.p1.5.m5.1.1.4">𝑙</ci><ci id="S4.SS1.p1.5.m5.1.1.5.cmml" xref="S4.SS1.p1.5.m5.1.1.5">𝑒</ci><ci id="S4.SS1.p1.5.m5.1.1.6.cmml" xref="S4.SS1.p1.5.m5.1.1.6">𝑣</ci><ci id="S4.SS1.p1.5.m5.1.1.7.cmml" xref="S4.SS1.p1.5.m5.1.1.7">𝑎</ci><ci id="S4.SS1.p1.5.m5.1.1.8.cmml" xref="S4.SS1.p1.5.m5.1.1.8">𝑛</ci><ci id="S4.SS1.p1.5.m5.1.1.9.cmml" xref="S4.SS1.p1.5.m5.1.1.9">𝑐</ci><ci id="S4.SS1.p1.5.m5.1.1.10.cmml" xref="S4.SS1.p1.5.m5.1.1.10">𝑒</ci><ci id="S4.SS1.p1.5.m5.1.1.11.cmml" xref="S4.SS1.p1.5.m5.1.1.11">@</ci><ci id="S4.SS1.p1.5.m5.1.1.12.cmml" xref="S4.SS1.p1.5.m5.1.1.12">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">Relevance@k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_R italic_e italic_l italic_e italic_v italic_a italic_n italic_c italic_e @ italic_k</annotation></semantics></math> is typically recall@k or precision@k. As a result, we can reformulate the action space to consist of individual items, <math alttext="A=|Z|" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.2" xref="S4.SS1.p1.6.m6.1.2.cmml"><mi id="S4.SS1.p1.6.m6.1.2.2" xref="S4.SS1.p1.6.m6.1.2.2.cmml">A</mi><mo id="S4.SS1.p1.6.m6.1.2.1" xref="S4.SS1.p1.6.m6.1.2.1.cmml">=</mo><mrow id="S4.SS1.p1.6.m6.1.2.3.2" xref="S4.SS1.p1.6.m6.1.2.3.1.cmml"><mo id="S4.SS1.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S4.SS1.p1.6.m6.1.2.3.1.1.cmml">|</mo><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">Z</mi><mo id="S4.SS1.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S4.SS1.p1.6.m6.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.2.cmml" xref="S4.SS1.p1.6.m6.1.2"><eq id="S4.SS1.p1.6.m6.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.2.1"></eq><ci id="S4.SS1.p1.6.m6.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.2.2">𝐴</ci><apply id="S4.SS1.p1.6.m6.1.2.3.1.cmml" xref="S4.SS1.p1.6.m6.1.2.3.2"><abs id="S4.SS1.p1.6.m6.1.2.3.1.1.cmml" xref="S4.SS1.p1.6.m6.1.2.3.2.1"></abs><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">A=|Z|</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_A = | italic_Z |</annotation></semantics></math>. In expectation, maximizing the novelty and relevance reward function for <math alttext="j\in[1,k]" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.2"><semantics id="S4.SS1.p1.7.m7.2a"><mrow id="S4.SS1.p1.7.m7.2.3" xref="S4.SS1.p1.7.m7.2.3.cmml"><mi id="S4.SS1.p1.7.m7.2.3.2" xref="S4.SS1.p1.7.m7.2.3.2.cmml">j</mi><mo id="S4.SS1.p1.7.m7.2.3.1" xref="S4.SS1.p1.7.m7.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p1.7.m7.2.3.3.2" xref="S4.SS1.p1.7.m7.2.3.3.1.cmml"><mo id="S4.SS1.p1.7.m7.2.3.3.2.1" stretchy="false" xref="S4.SS1.p1.7.m7.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">1</mn><mo id="S4.SS1.p1.7.m7.2.3.3.2.2" xref="S4.SS1.p1.7.m7.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p1.7.m7.2.2" xref="S4.SS1.p1.7.m7.2.2.cmml">k</mi><mo id="S4.SS1.p1.7.m7.2.3.3.2.3" stretchy="false" xref="S4.SS1.p1.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.2b"><apply id="S4.SS1.p1.7.m7.2.3.cmml" xref="S4.SS1.p1.7.m7.2.3"><in id="S4.SS1.p1.7.m7.2.3.1.cmml" xref="S4.SS1.p1.7.m7.2.3.1"></in><ci id="S4.SS1.p1.7.m7.2.3.2.cmml" xref="S4.SS1.p1.7.m7.2.3.2">𝑗</ci><interval closure="closed" id="S4.SS1.p1.7.m7.2.3.3.1.cmml" xref="S4.SS1.p1.7.m7.2.3.3.2"><cn id="S4.SS1.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1">1</cn><ci id="S4.SS1.p1.7.m7.2.2.cmml" xref="S4.SS1.p1.7.m7.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.2c">j\in[1,k]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.2d">italic_j ∈ [ 1 , italic_k ]</annotation></semantics></math> separately would imply maximizing the top-k reward.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.8">While the action space is reduced in size, a key benefit of our formulation is that the reward can still be a function of the top-k retrieved items from some model. This is because the environment can decide the reward based on whether the item is a part of the top-k items for the query. Recall that, given a state (query) <math alttext="x" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_x</annotation></semantics></math> and an action (item) <math alttext="z\in Z" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">z</mi><mo id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml">∈</mo><mi id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><in id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></in><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑧</ci><ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">z\in Z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_z ∈ italic_Z</annotation></semantics></math>, the novelty reward is dependent on whether the <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_z</annotation></semantics></math> is part of the top-k items returned by the base model <math alttext="\psi" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">italic_ψ</annotation></semantics></math>. As an example, we provide a simple reward function combining item-wise relevance and novelty w.r.t. <math alttext="\psi" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">italic_ψ</annotation></semantics></math>. Given any query <math alttext="x" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mi id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><ci id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">italic_x</annotation></semantics></math> and item <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.1"><semantics id="S4.SS1.p2.7.m7.1a"><mi id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><ci id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.1d">italic_z</annotation></semantics></math>, and a relevance oracle, <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S4.SS1.p2.8.1">Rel</span> (i.e., an LLM), the reward is given by,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{R}_{b}(x,z)=\begin{cases}1&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{%
 and \ }z\not\in topk(x,\psi)\\
-1&amp;\text{ if }\operatorname{Rel}(x,z)=0\text{ and \ }z\in topk(x,\psi)\\
-0.5&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{ and \ }z\in topk(x,\psi)\\
-1&amp;\text{ if }\operatorname{Rel}(x,z)=0\text{ and \ }z\not\in topk(x,\psi)\end%
{cases}" class="ltx_Math" display="block" id="S4.E6.m1.10"><semantics id="S4.E6.m1.10a"><mrow id="S4.E6.m1.10.11" xref="S4.E6.m1.10.11.cmml"><mrow id="S4.E6.m1.10.11.2" xref="S4.E6.m1.10.11.2.cmml"><msub id="S4.E6.m1.10.11.2.2" xref="S4.E6.m1.10.11.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.10.11.2.2.2" xref="S4.E6.m1.10.11.2.2.2.cmml">ℛ</mi><mi id="S4.E6.m1.10.11.2.2.3" xref="S4.E6.m1.10.11.2.2.3.cmml">b</mi></msub><mo id="S4.E6.m1.10.11.2.1" xref="S4.E6.m1.10.11.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.10.11.2.3.2" xref="S4.E6.m1.10.11.2.3.1.cmml"><mo id="S4.E6.m1.10.11.2.3.2.1" stretchy="false" xref="S4.E6.m1.10.11.2.3.1.cmml">(</mo><mi id="S4.E6.m1.9.9" xref="S4.E6.m1.9.9.cmml">x</mi><mo id="S4.E6.m1.10.11.2.3.2.2" xref="S4.E6.m1.10.11.2.3.1.cmml">,</mo><mi id="S4.E6.m1.10.10" xref="S4.E6.m1.10.10.cmml">z</mi><mo id="S4.E6.m1.10.11.2.3.2.3" stretchy="false" xref="S4.E6.m1.10.11.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.10.11.1" xref="S4.E6.m1.10.11.1.cmml">=</mo><mrow id="S4.E6.m1.8.8" xref="S4.E6.m1.10.11.3.1.cmml"><mo id="S4.E6.m1.8.8.9" xref="S4.E6.m1.10.11.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E6.m1.8.8.8" rowspacing="0pt" xref="S4.E6.m1.10.11.3.1.cmml"><mtr id="S4.E6.m1.8.8.8a" xref="S4.E6.m1.10.11.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8b" xref="S4.E6.m1.10.11.3.1.cmml"><mn id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8c" xref="S4.E6.m1.10.11.3.1.cmml"><mrow id="S4.E6.m1.2.2.2.2.2.1" xref="S4.E6.m1.2.2.2.2.2.1.cmml"><mrow id="S4.E6.m1.2.2.2.2.2.1.7" xref="S4.E6.m1.2.2.2.2.2.1.7.cmml"><mtext id="S4.E6.m1.2.2.2.2.2.1.7.2" xref="S4.E6.m1.2.2.2.2.2.1.7.2a.cmml"> if </mtext><mo id="S4.E6.m1.2.2.2.2.2.1.7.1" lspace="0.167em" xref="S4.E6.m1.2.2.2.2.2.1.7.1.cmml">⁢</mo><mrow id="S4.E6.m1.2.2.2.2.2.1.7.3.2" xref="S4.E6.m1.2.2.2.2.2.1.7.3.1.cmml"><mi id="S4.E6.m1.2.2.2.2.2.1.1" xref="S4.E6.m1.2.2.2.2.2.1.1.cmml">Rel</mi><mo id="S4.E6.m1.2.2.2.2.2.1.7.3.2a" xref="S4.E6.m1.2.2.2.2.2.1.7.3.1.cmml">⁡</mo><mrow id="S4.E6.m1.2.2.2.2.2.1.7.3.2.1" xref="S4.E6.m1.2.2.2.2.2.1.7.3.1.cmml"><mo id="S4.E6.m1.2.2.2.2.2.1.7.3.2.1.1" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.7.3.1.cmml">(</mo><mi id="S4.E6.m1.2.2.2.2.2.1.2" xref="S4.E6.m1.2.2.2.2.2.1.2.cmml">x</mi><mo id="S4.E6.m1.2.2.2.2.2.1.7.3.2.1.2" xref="S4.E6.m1.2.2.2.2.2.1.7.3.1.cmml">,</mo><mi id="S4.E6.m1.2.2.2.2.2.1.3" xref="S4.E6.m1.2.2.2.2.2.1.3.cmml">z</mi><mo id="S4.E6.m1.2.2.2.2.2.1.7.3.2.1.3" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.7.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.2.2.2.2.2.1.8" xref="S4.E6.m1.2.2.2.2.2.1.8.cmml">=</mo><mrow id="S4.E6.m1.2.2.2.2.2.1.9" xref="S4.E6.m1.2.2.2.2.2.1.9.cmml"><mn id="S4.E6.m1.2.2.2.2.2.1.9.2" xref="S4.E6.m1.2.2.2.2.2.1.9.2.cmml">1</mn><mo id="S4.E6.m1.2.2.2.2.2.1.9.1" xref="S4.E6.m1.2.2.2.2.2.1.9.1.cmml">⁢</mo><mtext id="S4.E6.m1.2.2.2.2.2.1.9.3" xref="S4.E6.m1.2.2.2.2.2.1.9.3a.cmml"> and </mtext><mo id="S4.E6.m1.2.2.2.2.2.1.9.1a" xref="S4.E6.m1.2.2.2.2.2.1.9.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.1.9.4" xref="S4.E6.m1.2.2.2.2.2.1.9.4.cmml">z</mi></mrow><mo id="S4.E6.m1.2.2.2.2.2.1.10" xref="S4.E6.m1.2.2.2.2.2.1.10.cmml">∉</mo><mrow id="S4.E6.m1.2.2.2.2.2.1.11" xref="S4.E6.m1.2.2.2.2.2.1.11.cmml"><mi id="S4.E6.m1.2.2.2.2.2.1.11.2" xref="S4.E6.m1.2.2.2.2.2.1.11.2.cmml">t</mi><mo id="S4.E6.m1.2.2.2.2.2.1.11.1" xref="S4.E6.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.1.11.3" xref="S4.E6.m1.2.2.2.2.2.1.11.3.cmml">o</mi><mo id="S4.E6.m1.2.2.2.2.2.1.11.1a" xref="S4.E6.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.1.11.4" xref="S4.E6.m1.2.2.2.2.2.1.11.4.cmml">p</mi><mo id="S4.E6.m1.2.2.2.2.2.1.11.1b" xref="S4.E6.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.1.11.5" xref="S4.E6.m1.2.2.2.2.2.1.11.5.cmml">k</mi><mo id="S4.E6.m1.2.2.2.2.2.1.11.1c" xref="S4.E6.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mrow id="S4.E6.m1.2.2.2.2.2.1.11.6.2" xref="S4.E6.m1.2.2.2.2.2.1.11.6.1.cmml"><mo id="S4.E6.m1.2.2.2.2.2.1.11.6.2.1" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.11.6.1.cmml">(</mo><mi id="S4.E6.m1.2.2.2.2.2.1.4" xref="S4.E6.m1.2.2.2.2.2.1.4.cmml">x</mi><mo id="S4.E6.m1.2.2.2.2.2.1.11.6.2.2" xref="S4.E6.m1.2.2.2.2.2.1.11.6.1.cmml">,</mo><mi id="S4.E6.m1.2.2.2.2.2.1.5" xref="S4.E6.m1.2.2.2.2.2.1.5.cmml">ψ</mi><mo id="S4.E6.m1.2.2.2.2.2.1.11.6.2.3" stretchy="false" xref="S4.E6.m1.2.2.2.2.2.1.11.6.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E6.m1.8.8.8d" xref="S4.E6.m1.10.11.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8e" xref="S4.E6.m1.10.11.3.1.cmml"><mrow id="S4.E6.m1.3.3.3.3.1.1" xref="S4.E6.m1.3.3.3.3.1.1.cmml"><mo id="S4.E6.m1.3.3.3.3.1.1a" xref="S4.E6.m1.3.3.3.3.1.1.cmml">−</mo><mn id="S4.E6.m1.3.3.3.3.1.1.2" xref="S4.E6.m1.3.3.3.3.1.1.2.cmml">1</mn></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8f" xref="S4.E6.m1.10.11.3.1.cmml"><mrow id="S4.E6.m1.4.4.4.4.2.1" xref="S4.E6.m1.4.4.4.4.2.1.cmml"><mrow id="S4.E6.m1.4.4.4.4.2.1.7" xref="S4.E6.m1.4.4.4.4.2.1.7.cmml"><mtext id="S4.E6.m1.4.4.4.4.2.1.7.2" xref="S4.E6.m1.4.4.4.4.2.1.7.2a.cmml"> if </mtext><mo id="S4.E6.m1.4.4.4.4.2.1.7.1" lspace="0.167em" xref="S4.E6.m1.4.4.4.4.2.1.7.1.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.4.4.2.1.7.3.2" xref="S4.E6.m1.4.4.4.4.2.1.7.3.1.cmml"><mi id="S4.E6.m1.4.4.4.4.2.1.1" xref="S4.E6.m1.4.4.4.4.2.1.1.cmml">Rel</mi><mo id="S4.E6.m1.4.4.4.4.2.1.7.3.2a" xref="S4.E6.m1.4.4.4.4.2.1.7.3.1.cmml">⁡</mo><mrow id="S4.E6.m1.4.4.4.4.2.1.7.3.2.1" xref="S4.E6.m1.4.4.4.4.2.1.7.3.1.cmml"><mo id="S4.E6.m1.4.4.4.4.2.1.7.3.2.1.1" stretchy="false" xref="S4.E6.m1.4.4.4.4.2.1.7.3.1.cmml">(</mo><mi id="S4.E6.m1.4.4.4.4.2.1.2" xref="S4.E6.m1.4.4.4.4.2.1.2.cmml">x</mi><mo id="S4.E6.m1.4.4.4.4.2.1.7.3.2.1.2" xref="S4.E6.m1.4.4.4.4.2.1.7.3.1.cmml">,</mo><mi id="S4.E6.m1.4.4.4.4.2.1.3" xref="S4.E6.m1.4.4.4.4.2.1.3.cmml">z</mi><mo id="S4.E6.m1.4.4.4.4.2.1.7.3.2.1.3" stretchy="false" xref="S4.E6.m1.4.4.4.4.2.1.7.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.4.4.4.4.2.1.8" xref="S4.E6.m1.4.4.4.4.2.1.8.cmml">=</mo><mrow id="S4.E6.m1.4.4.4.4.2.1.9" xref="S4.E6.m1.4.4.4.4.2.1.9.cmml"><mn id="S4.E6.m1.4.4.4.4.2.1.9.2" xref="S4.E6.m1.4.4.4.4.2.1.9.2.cmml">0</mn><mo id="S4.E6.m1.4.4.4.4.2.1.9.1" xref="S4.E6.m1.4.4.4.4.2.1.9.1.cmml">⁢</mo><mtext id="S4.E6.m1.4.4.4.4.2.1.9.3" xref="S4.E6.m1.4.4.4.4.2.1.9.3a.cmml"> and </mtext><mo id="S4.E6.m1.4.4.4.4.2.1.9.1a" xref="S4.E6.m1.4.4.4.4.2.1.9.1.cmml">⁢</mo><mi id="S4.E6.m1.4.4.4.4.2.1.9.4" xref="S4.E6.m1.4.4.4.4.2.1.9.4.cmml">z</mi></mrow><mo id="S4.E6.m1.4.4.4.4.2.1.10" xref="S4.E6.m1.4.4.4.4.2.1.10.cmml">∈</mo><mrow id="S4.E6.m1.4.4.4.4.2.1.11" xref="S4.E6.m1.4.4.4.4.2.1.11.cmml"><mi id="S4.E6.m1.4.4.4.4.2.1.11.2" xref="S4.E6.m1.4.4.4.4.2.1.11.2.cmml">t</mi><mo id="S4.E6.m1.4.4.4.4.2.1.11.1" xref="S4.E6.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.4.4.4.4.2.1.11.3" xref="S4.E6.m1.4.4.4.4.2.1.11.3.cmml">o</mi><mo id="S4.E6.m1.4.4.4.4.2.1.11.1a" xref="S4.E6.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.4.4.4.4.2.1.11.4" xref="S4.E6.m1.4.4.4.4.2.1.11.4.cmml">p</mi><mo id="S4.E6.m1.4.4.4.4.2.1.11.1b" xref="S4.E6.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.4.4.4.4.2.1.11.5" xref="S4.E6.m1.4.4.4.4.2.1.11.5.cmml">k</mi><mo id="S4.E6.m1.4.4.4.4.2.1.11.1c" xref="S4.E6.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.4.4.2.1.11.6.2" xref="S4.E6.m1.4.4.4.4.2.1.11.6.1.cmml"><mo id="S4.E6.m1.4.4.4.4.2.1.11.6.2.1" stretchy="false" xref="S4.E6.m1.4.4.4.4.2.1.11.6.1.cmml">(</mo><mi id="S4.E6.m1.4.4.4.4.2.1.4" xref="S4.E6.m1.4.4.4.4.2.1.4.cmml">x</mi><mo id="S4.E6.m1.4.4.4.4.2.1.11.6.2.2" xref="S4.E6.m1.4.4.4.4.2.1.11.6.1.cmml">,</mo><mi id="S4.E6.m1.4.4.4.4.2.1.5" xref="S4.E6.m1.4.4.4.4.2.1.5.cmml">ψ</mi><mo id="S4.E6.m1.4.4.4.4.2.1.11.6.2.3" stretchy="false" xref="S4.E6.m1.4.4.4.4.2.1.11.6.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E6.m1.8.8.8g" xref="S4.E6.m1.10.11.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8h" xref="S4.E6.m1.10.11.3.1.cmml"><mrow id="S4.E6.m1.5.5.5.5.1.1" xref="S4.E6.m1.5.5.5.5.1.1.cmml"><mo id="S4.E6.m1.5.5.5.5.1.1a" xref="S4.E6.m1.5.5.5.5.1.1.cmml">−</mo><mn id="S4.E6.m1.5.5.5.5.1.1.2" xref="S4.E6.m1.5.5.5.5.1.1.2.cmml">0.5</mn></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8i" xref="S4.E6.m1.10.11.3.1.cmml"><mrow id="S4.E6.m1.6.6.6.6.2.1" xref="S4.E6.m1.6.6.6.6.2.1.cmml"><mrow id="S4.E6.m1.6.6.6.6.2.1.7" xref="S4.E6.m1.6.6.6.6.2.1.7.cmml"><mtext id="S4.E6.m1.6.6.6.6.2.1.7.2" xref="S4.E6.m1.6.6.6.6.2.1.7.2a.cmml"> if </mtext><mo id="S4.E6.m1.6.6.6.6.2.1.7.1" lspace="0.167em" xref="S4.E6.m1.6.6.6.6.2.1.7.1.cmml">⁢</mo><mrow id="S4.E6.m1.6.6.6.6.2.1.7.3.2" xref="S4.E6.m1.6.6.6.6.2.1.7.3.1.cmml"><mi id="S4.E6.m1.6.6.6.6.2.1.1" xref="S4.E6.m1.6.6.6.6.2.1.1.cmml">Rel</mi><mo id="S4.E6.m1.6.6.6.6.2.1.7.3.2a" xref="S4.E6.m1.6.6.6.6.2.1.7.3.1.cmml">⁡</mo><mrow id="S4.E6.m1.6.6.6.6.2.1.7.3.2.1" xref="S4.E6.m1.6.6.6.6.2.1.7.3.1.cmml"><mo id="S4.E6.m1.6.6.6.6.2.1.7.3.2.1.1" stretchy="false" xref="S4.E6.m1.6.6.6.6.2.1.7.3.1.cmml">(</mo><mi id="S4.E6.m1.6.6.6.6.2.1.2" xref="S4.E6.m1.6.6.6.6.2.1.2.cmml">x</mi><mo id="S4.E6.m1.6.6.6.6.2.1.7.3.2.1.2" xref="S4.E6.m1.6.6.6.6.2.1.7.3.1.cmml">,</mo><mi id="S4.E6.m1.6.6.6.6.2.1.3" xref="S4.E6.m1.6.6.6.6.2.1.3.cmml">z</mi><mo id="S4.E6.m1.6.6.6.6.2.1.7.3.2.1.3" stretchy="false" xref="S4.E6.m1.6.6.6.6.2.1.7.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.6.6.6.6.2.1.8" xref="S4.E6.m1.6.6.6.6.2.1.8.cmml">=</mo><mrow id="S4.E6.m1.6.6.6.6.2.1.9" xref="S4.E6.m1.6.6.6.6.2.1.9.cmml"><mn id="S4.E6.m1.6.6.6.6.2.1.9.2" xref="S4.E6.m1.6.6.6.6.2.1.9.2.cmml">1</mn><mo id="S4.E6.m1.6.6.6.6.2.1.9.1" xref="S4.E6.m1.6.6.6.6.2.1.9.1.cmml">⁢</mo><mtext id="S4.E6.m1.6.6.6.6.2.1.9.3" xref="S4.E6.m1.6.6.6.6.2.1.9.3a.cmml"> and </mtext><mo id="S4.E6.m1.6.6.6.6.2.1.9.1a" xref="S4.E6.m1.6.6.6.6.2.1.9.1.cmml">⁢</mo><mi id="S4.E6.m1.6.6.6.6.2.1.9.4" xref="S4.E6.m1.6.6.6.6.2.1.9.4.cmml">z</mi></mrow><mo id="S4.E6.m1.6.6.6.6.2.1.10" xref="S4.E6.m1.6.6.6.6.2.1.10.cmml">∈</mo><mrow id="S4.E6.m1.6.6.6.6.2.1.11" xref="S4.E6.m1.6.6.6.6.2.1.11.cmml"><mi id="S4.E6.m1.6.6.6.6.2.1.11.2" xref="S4.E6.m1.6.6.6.6.2.1.11.2.cmml">t</mi><mo id="S4.E6.m1.6.6.6.6.2.1.11.1" xref="S4.E6.m1.6.6.6.6.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.6.6.6.6.2.1.11.3" xref="S4.E6.m1.6.6.6.6.2.1.11.3.cmml">o</mi><mo id="S4.E6.m1.6.6.6.6.2.1.11.1a" xref="S4.E6.m1.6.6.6.6.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.6.6.6.6.2.1.11.4" xref="S4.E6.m1.6.6.6.6.2.1.11.4.cmml">p</mi><mo id="S4.E6.m1.6.6.6.6.2.1.11.1b" xref="S4.E6.m1.6.6.6.6.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.6.6.6.6.2.1.11.5" xref="S4.E6.m1.6.6.6.6.2.1.11.5.cmml">k</mi><mo id="S4.E6.m1.6.6.6.6.2.1.11.1c" xref="S4.E6.m1.6.6.6.6.2.1.11.1.cmml">⁢</mo><mrow id="S4.E6.m1.6.6.6.6.2.1.11.6.2" xref="S4.E6.m1.6.6.6.6.2.1.11.6.1.cmml"><mo id="S4.E6.m1.6.6.6.6.2.1.11.6.2.1" stretchy="false" xref="S4.E6.m1.6.6.6.6.2.1.11.6.1.cmml">(</mo><mi id="S4.E6.m1.6.6.6.6.2.1.4" xref="S4.E6.m1.6.6.6.6.2.1.4.cmml">x</mi><mo id="S4.E6.m1.6.6.6.6.2.1.11.6.2.2" xref="S4.E6.m1.6.6.6.6.2.1.11.6.1.cmml">,</mo><mi id="S4.E6.m1.6.6.6.6.2.1.5" xref="S4.E6.m1.6.6.6.6.2.1.5.cmml">ψ</mi><mo id="S4.E6.m1.6.6.6.6.2.1.11.6.2.3" stretchy="false" xref="S4.E6.m1.6.6.6.6.2.1.11.6.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E6.m1.8.8.8j" xref="S4.E6.m1.10.11.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8k" xref="S4.E6.m1.10.11.3.1.cmml"><mrow id="S4.E6.m1.7.7.7.7.1.1" xref="S4.E6.m1.7.7.7.7.1.1.cmml"><mo id="S4.E6.m1.7.7.7.7.1.1a" xref="S4.E6.m1.7.7.7.7.1.1.cmml">−</mo><mn id="S4.E6.m1.7.7.7.7.1.1.2" xref="S4.E6.m1.7.7.7.7.1.1.2.cmml">1</mn></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.8.8.8l" xref="S4.E6.m1.10.11.3.1.cmml"><mrow id="S4.E6.m1.8.8.8.8.2.1" xref="S4.E6.m1.8.8.8.8.2.1.cmml"><mrow id="S4.E6.m1.8.8.8.8.2.1.7" xref="S4.E6.m1.8.8.8.8.2.1.7.cmml"><mtext id="S4.E6.m1.8.8.8.8.2.1.7.2" xref="S4.E6.m1.8.8.8.8.2.1.7.2a.cmml"> if </mtext><mo id="S4.E6.m1.8.8.8.8.2.1.7.1" lspace="0.167em" xref="S4.E6.m1.8.8.8.8.2.1.7.1.cmml">⁢</mo><mrow id="S4.E6.m1.8.8.8.8.2.1.7.3.2" xref="S4.E6.m1.8.8.8.8.2.1.7.3.1.cmml"><mi id="S4.E6.m1.8.8.8.8.2.1.1" xref="S4.E6.m1.8.8.8.8.2.1.1.cmml">Rel</mi><mo id="S4.E6.m1.8.8.8.8.2.1.7.3.2a" xref="S4.E6.m1.8.8.8.8.2.1.7.3.1.cmml">⁡</mo><mrow id="S4.E6.m1.8.8.8.8.2.1.7.3.2.1" xref="S4.E6.m1.8.8.8.8.2.1.7.3.1.cmml"><mo id="S4.E6.m1.8.8.8.8.2.1.7.3.2.1.1" stretchy="false" xref="S4.E6.m1.8.8.8.8.2.1.7.3.1.cmml">(</mo><mi id="S4.E6.m1.8.8.8.8.2.1.2" xref="S4.E6.m1.8.8.8.8.2.1.2.cmml">x</mi><mo id="S4.E6.m1.8.8.8.8.2.1.7.3.2.1.2" xref="S4.E6.m1.8.8.8.8.2.1.7.3.1.cmml">,</mo><mi id="S4.E6.m1.8.8.8.8.2.1.3" xref="S4.E6.m1.8.8.8.8.2.1.3.cmml">z</mi><mo id="S4.E6.m1.8.8.8.8.2.1.7.3.2.1.3" stretchy="false" xref="S4.E6.m1.8.8.8.8.2.1.7.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.8.8.8.8.2.1.8" xref="S4.E6.m1.8.8.8.8.2.1.8.cmml">=</mo><mrow id="S4.E6.m1.8.8.8.8.2.1.9" xref="S4.E6.m1.8.8.8.8.2.1.9.cmml"><mn id="S4.E6.m1.8.8.8.8.2.1.9.2" xref="S4.E6.m1.8.8.8.8.2.1.9.2.cmml">0</mn><mo id="S4.E6.m1.8.8.8.8.2.1.9.1" xref="S4.E6.m1.8.8.8.8.2.1.9.1.cmml">⁢</mo><mtext id="S4.E6.m1.8.8.8.8.2.1.9.3" xref="S4.E6.m1.8.8.8.8.2.1.9.3a.cmml"> and </mtext><mo id="S4.E6.m1.8.8.8.8.2.1.9.1a" xref="S4.E6.m1.8.8.8.8.2.1.9.1.cmml">⁢</mo><mi id="S4.E6.m1.8.8.8.8.2.1.9.4" xref="S4.E6.m1.8.8.8.8.2.1.9.4.cmml">z</mi></mrow><mo id="S4.E6.m1.8.8.8.8.2.1.10" xref="S4.E6.m1.8.8.8.8.2.1.10.cmml">∉</mo><mrow id="S4.E6.m1.8.8.8.8.2.1.11" xref="S4.E6.m1.8.8.8.8.2.1.11.cmml"><mi id="S4.E6.m1.8.8.8.8.2.1.11.2" xref="S4.E6.m1.8.8.8.8.2.1.11.2.cmml">t</mi><mo id="S4.E6.m1.8.8.8.8.2.1.11.1" xref="S4.E6.m1.8.8.8.8.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.8.8.8.8.2.1.11.3" xref="S4.E6.m1.8.8.8.8.2.1.11.3.cmml">o</mi><mo id="S4.E6.m1.8.8.8.8.2.1.11.1a" xref="S4.E6.m1.8.8.8.8.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.8.8.8.8.2.1.11.4" xref="S4.E6.m1.8.8.8.8.2.1.11.4.cmml">p</mi><mo id="S4.E6.m1.8.8.8.8.2.1.11.1b" xref="S4.E6.m1.8.8.8.8.2.1.11.1.cmml">⁢</mo><mi id="S4.E6.m1.8.8.8.8.2.1.11.5" xref="S4.E6.m1.8.8.8.8.2.1.11.5.cmml">k</mi><mo id="S4.E6.m1.8.8.8.8.2.1.11.1c" xref="S4.E6.m1.8.8.8.8.2.1.11.1.cmml">⁢</mo><mrow id="S4.E6.m1.8.8.8.8.2.1.11.6.2" xref="S4.E6.m1.8.8.8.8.2.1.11.6.1.cmml"><mo id="S4.E6.m1.8.8.8.8.2.1.11.6.2.1" stretchy="false" xref="S4.E6.m1.8.8.8.8.2.1.11.6.1.cmml">(</mo><mi id="S4.E6.m1.8.8.8.8.2.1.4" xref="S4.E6.m1.8.8.8.8.2.1.4.cmml">x</mi><mo id="S4.E6.m1.8.8.8.8.2.1.11.6.2.2" xref="S4.E6.m1.8.8.8.8.2.1.11.6.1.cmml">,</mo><mi id="S4.E6.m1.8.8.8.8.2.1.5" xref="S4.E6.m1.8.8.8.8.2.1.5.cmml">ψ</mi><mo id="S4.E6.m1.8.8.8.8.2.1.11.6.2.3" stretchy="false" xref="S4.E6.m1.8.8.8.8.2.1.11.6.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.10b"><apply id="S4.E6.m1.10.11.cmml" xref="S4.E6.m1.10.11"><eq id="S4.E6.m1.10.11.1.cmml" xref="S4.E6.m1.10.11.1"></eq><apply id="S4.E6.m1.10.11.2.cmml" xref="S4.E6.m1.10.11.2"><times id="S4.E6.m1.10.11.2.1.cmml" xref="S4.E6.m1.10.11.2.1"></times><apply id="S4.E6.m1.10.11.2.2.cmml" xref="S4.E6.m1.10.11.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.10.11.2.2.1.cmml" xref="S4.E6.m1.10.11.2.2">subscript</csymbol><ci id="S4.E6.m1.10.11.2.2.2.cmml" xref="S4.E6.m1.10.11.2.2.2">ℛ</ci><ci id="S4.E6.m1.10.11.2.2.3.cmml" xref="S4.E6.m1.10.11.2.2.3">𝑏</ci></apply><interval closure="open" id="S4.E6.m1.10.11.2.3.1.cmml" xref="S4.E6.m1.10.11.2.3.2"><ci id="S4.E6.m1.9.9.cmml" xref="S4.E6.m1.9.9">𝑥</ci><ci id="S4.E6.m1.10.10.cmml" xref="S4.E6.m1.10.10">𝑧</ci></interval></apply><apply id="S4.E6.m1.10.11.3.1.cmml" xref="S4.E6.m1.8.8"><csymbol cd="latexml" id="S4.E6.m1.10.11.3.1.1.cmml" xref="S4.E6.m1.8.8.9">cases</csymbol><cn id="S4.E6.m1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E6.m1.1.1.1.1.1.1">1</cn><apply id="S4.E6.m1.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1"><and id="S4.E6.m1.2.2.2.2.2.1a.cmml" xref="S4.E6.m1.2.2.2.2.2.1"></and><apply id="S4.E6.m1.2.2.2.2.2.1b.cmml" xref="S4.E6.m1.2.2.2.2.2.1"><eq id="S4.E6.m1.2.2.2.2.2.1.8.cmml" xref="S4.E6.m1.2.2.2.2.2.1.8"></eq><apply id="S4.E6.m1.2.2.2.2.2.1.7.cmml" xref="S4.E6.m1.2.2.2.2.2.1.7"><times id="S4.E6.m1.2.2.2.2.2.1.7.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.7.1"></times><ci id="S4.E6.m1.2.2.2.2.2.1.7.2a.cmml" xref="S4.E6.m1.2.2.2.2.2.1.7.2"><mtext id="S4.E6.m1.2.2.2.2.2.1.7.2.cmml" xref="S4.E6.m1.2.2.2.2.2.1.7.2"> if </mtext></ci><apply id="S4.E6.m1.2.2.2.2.2.1.7.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.7.3.2"><ci id="S4.E6.m1.2.2.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.1">Rel</ci><ci id="S4.E6.m1.2.2.2.2.2.1.2.cmml" xref="S4.E6.m1.2.2.2.2.2.1.2">𝑥</ci><ci id="S4.E6.m1.2.2.2.2.2.1.3.cmml" xref="S4.E6.m1.2.2.2.2.2.1.3">𝑧</ci></apply></apply><apply id="S4.E6.m1.2.2.2.2.2.1.9.cmml" xref="S4.E6.m1.2.2.2.2.2.1.9"><times id="S4.E6.m1.2.2.2.2.2.1.9.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.9.1"></times><cn id="S4.E6.m1.2.2.2.2.2.1.9.2.cmml" type="integer" xref="S4.E6.m1.2.2.2.2.2.1.9.2">1</cn><ci id="S4.E6.m1.2.2.2.2.2.1.9.3a.cmml" xref="S4.E6.m1.2.2.2.2.2.1.9.3"><mtext id="S4.E6.m1.2.2.2.2.2.1.9.3.cmml" xref="S4.E6.m1.2.2.2.2.2.1.9.3"> and </mtext></ci><ci id="S4.E6.m1.2.2.2.2.2.1.9.4.cmml" xref="S4.E6.m1.2.2.2.2.2.1.9.4">𝑧</ci></apply></apply><apply id="S4.E6.m1.2.2.2.2.2.1c.cmml" xref="S4.E6.m1.2.2.2.2.2.1"><notin id="S4.E6.m1.2.2.2.2.2.1.10.cmml" xref="S4.E6.m1.2.2.2.2.2.1.10"></notin><share href="https://arxiv.org/html/2406.14169v1#S4.E6.m1.2.2.2.2.2.1.9.cmml" id="S4.E6.m1.2.2.2.2.2.1d.cmml" xref="S4.E6.m1.2.2.2.2.2.1"></share><apply id="S4.E6.m1.2.2.2.2.2.1.11.cmml" xref="S4.E6.m1.2.2.2.2.2.1.11"><times id="S4.E6.m1.2.2.2.2.2.1.11.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.11.1"></times><ci id="S4.E6.m1.2.2.2.2.2.1.11.2.cmml" xref="S4.E6.m1.2.2.2.2.2.1.11.2">𝑡</ci><ci id="S4.E6.m1.2.2.2.2.2.1.11.3.cmml" xref="S4.E6.m1.2.2.2.2.2.1.11.3">𝑜</ci><ci id="S4.E6.m1.2.2.2.2.2.1.11.4.cmml" xref="S4.E6.m1.2.2.2.2.2.1.11.4">𝑝</ci><ci id="S4.E6.m1.2.2.2.2.2.1.11.5.cmml" xref="S4.E6.m1.2.2.2.2.2.1.11.5">𝑘</ci><interval closure="open" id="S4.E6.m1.2.2.2.2.2.1.11.6.1.cmml" xref="S4.E6.m1.2.2.2.2.2.1.11.6.2"><ci id="S4.E6.m1.2.2.2.2.2.1.4.cmml" xref="S4.E6.m1.2.2.2.2.2.1.4">𝑥</ci><ci id="S4.E6.m1.2.2.2.2.2.1.5.cmml" xref="S4.E6.m1.2.2.2.2.2.1.5">𝜓</ci></interval></apply></apply></apply><apply id="S4.E6.m1.3.3.3.3.1.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1"><minus id="S4.E6.m1.3.3.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.3.3.1.1"></minus><cn id="S4.E6.m1.3.3.3.3.1.1.2.cmml" type="integer" xref="S4.E6.m1.3.3.3.3.1.1.2">1</cn></apply><apply id="S4.E6.m1.4.4.4.4.2.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1"><and id="S4.E6.m1.4.4.4.4.2.1a.cmml" xref="S4.E6.m1.4.4.4.4.2.1"></and><apply id="S4.E6.m1.4.4.4.4.2.1b.cmml" xref="S4.E6.m1.4.4.4.4.2.1"><eq id="S4.E6.m1.4.4.4.4.2.1.8.cmml" xref="S4.E6.m1.4.4.4.4.2.1.8"></eq><apply id="S4.E6.m1.4.4.4.4.2.1.7.cmml" xref="S4.E6.m1.4.4.4.4.2.1.7"><times id="S4.E6.m1.4.4.4.4.2.1.7.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.7.1"></times><ci id="S4.E6.m1.4.4.4.4.2.1.7.2a.cmml" xref="S4.E6.m1.4.4.4.4.2.1.7.2"><mtext id="S4.E6.m1.4.4.4.4.2.1.7.2.cmml" xref="S4.E6.m1.4.4.4.4.2.1.7.2"> if </mtext></ci><apply id="S4.E6.m1.4.4.4.4.2.1.7.3.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.7.3.2"><ci id="S4.E6.m1.4.4.4.4.2.1.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.1">Rel</ci><ci id="S4.E6.m1.4.4.4.4.2.1.2.cmml" xref="S4.E6.m1.4.4.4.4.2.1.2">𝑥</ci><ci id="S4.E6.m1.4.4.4.4.2.1.3.cmml" xref="S4.E6.m1.4.4.4.4.2.1.3">𝑧</ci></apply></apply><apply id="S4.E6.m1.4.4.4.4.2.1.9.cmml" xref="S4.E6.m1.4.4.4.4.2.1.9"><times id="S4.E6.m1.4.4.4.4.2.1.9.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.9.1"></times><cn id="S4.E6.m1.4.4.4.4.2.1.9.2.cmml" type="integer" xref="S4.E6.m1.4.4.4.4.2.1.9.2">0</cn><ci id="S4.E6.m1.4.4.4.4.2.1.9.3a.cmml" xref="S4.E6.m1.4.4.4.4.2.1.9.3"><mtext id="S4.E6.m1.4.4.4.4.2.1.9.3.cmml" xref="S4.E6.m1.4.4.4.4.2.1.9.3"> and </mtext></ci><ci id="S4.E6.m1.4.4.4.4.2.1.9.4.cmml" xref="S4.E6.m1.4.4.4.4.2.1.9.4">𝑧</ci></apply></apply><apply id="S4.E6.m1.4.4.4.4.2.1c.cmml" xref="S4.E6.m1.4.4.4.4.2.1"><in id="S4.E6.m1.4.4.4.4.2.1.10.cmml" xref="S4.E6.m1.4.4.4.4.2.1.10"></in><share href="https://arxiv.org/html/2406.14169v1#S4.E6.m1.4.4.4.4.2.1.9.cmml" id="S4.E6.m1.4.4.4.4.2.1d.cmml" xref="S4.E6.m1.4.4.4.4.2.1"></share><apply id="S4.E6.m1.4.4.4.4.2.1.11.cmml" xref="S4.E6.m1.4.4.4.4.2.1.11"><times id="S4.E6.m1.4.4.4.4.2.1.11.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.11.1"></times><ci id="S4.E6.m1.4.4.4.4.2.1.11.2.cmml" xref="S4.E6.m1.4.4.4.4.2.1.11.2">𝑡</ci><ci id="S4.E6.m1.4.4.4.4.2.1.11.3.cmml" xref="S4.E6.m1.4.4.4.4.2.1.11.3">𝑜</ci><ci id="S4.E6.m1.4.4.4.4.2.1.11.4.cmml" xref="S4.E6.m1.4.4.4.4.2.1.11.4">𝑝</ci><ci id="S4.E6.m1.4.4.4.4.2.1.11.5.cmml" xref="S4.E6.m1.4.4.4.4.2.1.11.5">𝑘</ci><interval closure="open" id="S4.E6.m1.4.4.4.4.2.1.11.6.1.cmml" xref="S4.E6.m1.4.4.4.4.2.1.11.6.2"><ci id="S4.E6.m1.4.4.4.4.2.1.4.cmml" xref="S4.E6.m1.4.4.4.4.2.1.4">𝑥</ci><ci id="S4.E6.m1.4.4.4.4.2.1.5.cmml" xref="S4.E6.m1.4.4.4.4.2.1.5">𝜓</ci></interval></apply></apply></apply><apply id="S4.E6.m1.5.5.5.5.1.1.cmml" xref="S4.E6.m1.5.5.5.5.1.1"><minus id="S4.E6.m1.5.5.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.5.5.1.1"></minus><cn id="S4.E6.m1.5.5.5.5.1.1.2.cmml" type="float" xref="S4.E6.m1.5.5.5.5.1.1.2">0.5</cn></apply><apply id="S4.E6.m1.6.6.6.6.2.1.cmml" xref="S4.E6.m1.6.6.6.6.2.1"><and id="S4.E6.m1.6.6.6.6.2.1a.cmml" xref="S4.E6.m1.6.6.6.6.2.1"></and><apply id="S4.E6.m1.6.6.6.6.2.1b.cmml" xref="S4.E6.m1.6.6.6.6.2.1"><eq id="S4.E6.m1.6.6.6.6.2.1.8.cmml" xref="S4.E6.m1.6.6.6.6.2.1.8"></eq><apply id="S4.E6.m1.6.6.6.6.2.1.7.cmml" xref="S4.E6.m1.6.6.6.6.2.1.7"><times id="S4.E6.m1.6.6.6.6.2.1.7.1.cmml" xref="S4.E6.m1.6.6.6.6.2.1.7.1"></times><ci id="S4.E6.m1.6.6.6.6.2.1.7.2a.cmml" xref="S4.E6.m1.6.6.6.6.2.1.7.2"><mtext id="S4.E6.m1.6.6.6.6.2.1.7.2.cmml" xref="S4.E6.m1.6.6.6.6.2.1.7.2"> if </mtext></ci><apply id="S4.E6.m1.6.6.6.6.2.1.7.3.1.cmml" xref="S4.E6.m1.6.6.6.6.2.1.7.3.2"><ci id="S4.E6.m1.6.6.6.6.2.1.1.cmml" xref="S4.E6.m1.6.6.6.6.2.1.1">Rel</ci><ci id="S4.E6.m1.6.6.6.6.2.1.2.cmml" xref="S4.E6.m1.6.6.6.6.2.1.2">𝑥</ci><ci id="S4.E6.m1.6.6.6.6.2.1.3.cmml" xref="S4.E6.m1.6.6.6.6.2.1.3">𝑧</ci></apply></apply><apply id="S4.E6.m1.6.6.6.6.2.1.9.cmml" xref="S4.E6.m1.6.6.6.6.2.1.9"><times id="S4.E6.m1.6.6.6.6.2.1.9.1.cmml" xref="S4.E6.m1.6.6.6.6.2.1.9.1"></times><cn id="S4.E6.m1.6.6.6.6.2.1.9.2.cmml" type="integer" xref="S4.E6.m1.6.6.6.6.2.1.9.2">1</cn><ci id="S4.E6.m1.6.6.6.6.2.1.9.3a.cmml" xref="S4.E6.m1.6.6.6.6.2.1.9.3"><mtext id="S4.E6.m1.6.6.6.6.2.1.9.3.cmml" xref="S4.E6.m1.6.6.6.6.2.1.9.3"> and </mtext></ci><ci id="S4.E6.m1.6.6.6.6.2.1.9.4.cmml" xref="S4.E6.m1.6.6.6.6.2.1.9.4">𝑧</ci></apply></apply><apply id="S4.E6.m1.6.6.6.6.2.1c.cmml" xref="S4.E6.m1.6.6.6.6.2.1"><in id="S4.E6.m1.6.6.6.6.2.1.10.cmml" xref="S4.E6.m1.6.6.6.6.2.1.10"></in><share href="https://arxiv.org/html/2406.14169v1#S4.E6.m1.6.6.6.6.2.1.9.cmml" id="S4.E6.m1.6.6.6.6.2.1d.cmml" xref="S4.E6.m1.6.6.6.6.2.1"></share><apply id="S4.E6.m1.6.6.6.6.2.1.11.cmml" xref="S4.E6.m1.6.6.6.6.2.1.11"><times id="S4.E6.m1.6.6.6.6.2.1.11.1.cmml" xref="S4.E6.m1.6.6.6.6.2.1.11.1"></times><ci id="S4.E6.m1.6.6.6.6.2.1.11.2.cmml" xref="S4.E6.m1.6.6.6.6.2.1.11.2">𝑡</ci><ci id="S4.E6.m1.6.6.6.6.2.1.11.3.cmml" xref="S4.E6.m1.6.6.6.6.2.1.11.3">𝑜</ci><ci id="S4.E6.m1.6.6.6.6.2.1.11.4.cmml" xref="S4.E6.m1.6.6.6.6.2.1.11.4">𝑝</ci><ci id="S4.E6.m1.6.6.6.6.2.1.11.5.cmml" xref="S4.E6.m1.6.6.6.6.2.1.11.5">𝑘</ci><interval closure="open" id="S4.E6.m1.6.6.6.6.2.1.11.6.1.cmml" xref="S4.E6.m1.6.6.6.6.2.1.11.6.2"><ci id="S4.E6.m1.6.6.6.6.2.1.4.cmml" xref="S4.E6.m1.6.6.6.6.2.1.4">𝑥</ci><ci id="S4.E6.m1.6.6.6.6.2.1.5.cmml" xref="S4.E6.m1.6.6.6.6.2.1.5">𝜓</ci></interval></apply></apply></apply><apply id="S4.E6.m1.7.7.7.7.1.1.cmml" xref="S4.E6.m1.7.7.7.7.1.1"><minus id="S4.E6.m1.7.7.7.7.1.1.1.cmml" xref="S4.E6.m1.7.7.7.7.1.1"></minus><cn id="S4.E6.m1.7.7.7.7.1.1.2.cmml" type="integer" xref="S4.E6.m1.7.7.7.7.1.1.2">1</cn></apply><apply id="S4.E6.m1.8.8.8.8.2.1.cmml" xref="S4.E6.m1.8.8.8.8.2.1"><and id="S4.E6.m1.8.8.8.8.2.1a.cmml" xref="S4.E6.m1.8.8.8.8.2.1"></and><apply id="S4.E6.m1.8.8.8.8.2.1b.cmml" xref="S4.E6.m1.8.8.8.8.2.1"><eq id="S4.E6.m1.8.8.8.8.2.1.8.cmml" xref="S4.E6.m1.8.8.8.8.2.1.8"></eq><apply id="S4.E6.m1.8.8.8.8.2.1.7.cmml" xref="S4.E6.m1.8.8.8.8.2.1.7"><times id="S4.E6.m1.8.8.8.8.2.1.7.1.cmml" xref="S4.E6.m1.8.8.8.8.2.1.7.1"></times><ci id="S4.E6.m1.8.8.8.8.2.1.7.2a.cmml" xref="S4.E6.m1.8.8.8.8.2.1.7.2"><mtext id="S4.E6.m1.8.8.8.8.2.1.7.2.cmml" xref="S4.E6.m1.8.8.8.8.2.1.7.2"> if </mtext></ci><apply id="S4.E6.m1.8.8.8.8.2.1.7.3.1.cmml" xref="S4.E6.m1.8.8.8.8.2.1.7.3.2"><ci id="S4.E6.m1.8.8.8.8.2.1.1.cmml" xref="S4.E6.m1.8.8.8.8.2.1.1">Rel</ci><ci id="S4.E6.m1.8.8.8.8.2.1.2.cmml" xref="S4.E6.m1.8.8.8.8.2.1.2">𝑥</ci><ci id="S4.E6.m1.8.8.8.8.2.1.3.cmml" xref="S4.E6.m1.8.8.8.8.2.1.3">𝑧</ci></apply></apply><apply id="S4.E6.m1.8.8.8.8.2.1.9.cmml" xref="S4.E6.m1.8.8.8.8.2.1.9"><times id="S4.E6.m1.8.8.8.8.2.1.9.1.cmml" xref="S4.E6.m1.8.8.8.8.2.1.9.1"></times><cn id="S4.E6.m1.8.8.8.8.2.1.9.2.cmml" type="integer" xref="S4.E6.m1.8.8.8.8.2.1.9.2">0</cn><ci id="S4.E6.m1.8.8.8.8.2.1.9.3a.cmml" xref="S4.E6.m1.8.8.8.8.2.1.9.3"><mtext id="S4.E6.m1.8.8.8.8.2.1.9.3.cmml" xref="S4.E6.m1.8.8.8.8.2.1.9.3"> and </mtext></ci><ci id="S4.E6.m1.8.8.8.8.2.1.9.4.cmml" xref="S4.E6.m1.8.8.8.8.2.1.9.4">𝑧</ci></apply></apply><apply id="S4.E6.m1.8.8.8.8.2.1c.cmml" xref="S4.E6.m1.8.8.8.8.2.1"><notin id="S4.E6.m1.8.8.8.8.2.1.10.cmml" xref="S4.E6.m1.8.8.8.8.2.1.10"></notin><share href="https://arxiv.org/html/2406.14169v1#S4.E6.m1.8.8.8.8.2.1.9.cmml" id="S4.E6.m1.8.8.8.8.2.1d.cmml" xref="S4.E6.m1.8.8.8.8.2.1"></share><apply id="S4.E6.m1.8.8.8.8.2.1.11.cmml" xref="S4.E6.m1.8.8.8.8.2.1.11"><times id="S4.E6.m1.8.8.8.8.2.1.11.1.cmml" xref="S4.E6.m1.8.8.8.8.2.1.11.1"></times><ci id="S4.E6.m1.8.8.8.8.2.1.11.2.cmml" xref="S4.E6.m1.8.8.8.8.2.1.11.2">𝑡</ci><ci id="S4.E6.m1.8.8.8.8.2.1.11.3.cmml" xref="S4.E6.m1.8.8.8.8.2.1.11.3">𝑜</ci><ci id="S4.E6.m1.8.8.8.8.2.1.11.4.cmml" xref="S4.E6.m1.8.8.8.8.2.1.11.4">𝑝</ci><ci id="S4.E6.m1.8.8.8.8.2.1.11.5.cmml" xref="S4.E6.m1.8.8.8.8.2.1.11.5">𝑘</ci><interval closure="open" id="S4.E6.m1.8.8.8.8.2.1.11.6.1.cmml" xref="S4.E6.m1.8.8.8.8.2.1.11.6.2"><ci id="S4.E6.m1.8.8.8.8.2.1.4.cmml" xref="S4.E6.m1.8.8.8.8.2.1.4">𝑥</ci><ci id="S4.E6.m1.8.8.8.8.2.1.5.cmml" xref="S4.E6.m1.8.8.8.8.2.1.5">𝜓</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.10c">\mathcal{R}_{b}(x,z)=\begin{cases}1&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{%
 and \ }z\not\in topk(x,\psi)\\
-1&amp;\text{ if }\operatorname{Rel}(x,z)=0\text{ and \ }z\in topk(x,\psi)\\
-0.5&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{ and \ }z\in topk(x,\psi)\\
-1&amp;\text{ if }\operatorname{Rel}(x,z)=0\text{ and \ }z\not\in topk(x,\psi)\end%
{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.10d">caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x , italic_z ) = { start_ROW start_CELL 1 end_CELL start_CELL if roman_Rel ( italic_x , italic_z ) = 1 and italic_z ∉ italic_t italic_o italic_p italic_k ( italic_x , italic_ψ ) end_CELL end_ROW start_ROW start_CELL - 1 end_CELL start_CELL if roman_Rel ( italic_x , italic_z ) = 0 and italic_z ∈ italic_t italic_o italic_p italic_k ( italic_x , italic_ψ ) end_CELL end_ROW start_ROW start_CELL - 0.5 end_CELL start_CELL if roman_Rel ( italic_x , italic_z ) = 1 and italic_z ∈ italic_t italic_o italic_p italic_k ( italic_x , italic_ψ ) end_CELL end_ROW start_ROW start_CELL - 1 end_CELL start_CELL if roman_Rel ( italic_x , italic_z ) = 0 and italic_z ∉ italic_t italic_o italic_p italic_k ( italic_x , italic_ψ ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.9">We can see that the reward function penalizes irrelevant items and relevant items that are not novel w.r.t. the base model, while encouraging relevant items that are novel. However, in practice, the LLM-based relevance function may be noisy. In particular, as higher relevance items are likely to be sampled more, false negatives can be a problem. Therefore, for noisy oracles, we propose a simpler reward function that is only activated for relevant items but not for irrelevant items predicted by the oracle.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{R}_{b}(x,z)=\begin{cases}1&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{%
 and \ }z\not\in topk(x,\psi)\\
-0.5&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{ and \ }z\in topk(x,\psi)\\
0&amp;\text{ otherwise}\end{cases}" class="ltx_Math" display="block" id="S4.E7.m1.8"><semantics id="S4.E7.m1.8a"><mrow id="S4.E7.m1.8.9" xref="S4.E7.m1.8.9.cmml"><mrow id="S4.E7.m1.8.9.2" xref="S4.E7.m1.8.9.2.cmml"><msub id="S4.E7.m1.8.9.2.2" xref="S4.E7.m1.8.9.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.8.9.2.2.2" xref="S4.E7.m1.8.9.2.2.2.cmml">ℛ</mi><mi id="S4.E7.m1.8.9.2.2.3" xref="S4.E7.m1.8.9.2.2.3.cmml">b</mi></msub><mo id="S4.E7.m1.8.9.2.1" xref="S4.E7.m1.8.9.2.1.cmml">⁢</mo><mrow id="S4.E7.m1.8.9.2.3.2" xref="S4.E7.m1.8.9.2.3.1.cmml"><mo id="S4.E7.m1.8.9.2.3.2.1" stretchy="false" xref="S4.E7.m1.8.9.2.3.1.cmml">(</mo><mi id="S4.E7.m1.7.7" xref="S4.E7.m1.7.7.cmml">x</mi><mo id="S4.E7.m1.8.9.2.3.2.2" xref="S4.E7.m1.8.9.2.3.1.cmml">,</mo><mi id="S4.E7.m1.8.8" xref="S4.E7.m1.8.8.cmml">z</mi><mo id="S4.E7.m1.8.9.2.3.2.3" stretchy="false" xref="S4.E7.m1.8.9.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.8.9.1" xref="S4.E7.m1.8.9.1.cmml">=</mo><mrow id="S4.E7.m1.6.6" xref="S4.E7.m1.8.9.3.1.cmml"><mo id="S4.E7.m1.6.6.7" xref="S4.E7.m1.8.9.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E7.m1.6.6.6" rowspacing="0pt" xref="S4.E7.m1.8.9.3.1.cmml"><mtr id="S4.E7.m1.6.6.6a" xref="S4.E7.m1.8.9.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.6.6.6b" xref="S4.E7.m1.8.9.3.1.cmml"><mn id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.6.6.6c" xref="S4.E7.m1.8.9.3.1.cmml"><mrow id="S4.E7.m1.2.2.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.1.cmml"><mrow id="S4.E7.m1.2.2.2.2.2.1.7" xref="S4.E7.m1.2.2.2.2.2.1.7.cmml"><mtext id="S4.E7.m1.2.2.2.2.2.1.7.2" xref="S4.E7.m1.2.2.2.2.2.1.7.2a.cmml"> if </mtext><mo id="S4.E7.m1.2.2.2.2.2.1.7.1" lspace="0.167em" xref="S4.E7.m1.2.2.2.2.2.1.7.1.cmml">⁢</mo><mrow id="S4.E7.m1.2.2.2.2.2.1.7.3.2" xref="S4.E7.m1.2.2.2.2.2.1.7.3.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.1.1" xref="S4.E7.m1.2.2.2.2.2.1.1.cmml">Rel</mi><mo id="S4.E7.m1.2.2.2.2.2.1.7.3.2a" xref="S4.E7.m1.2.2.2.2.2.1.7.3.1.cmml">⁡</mo><mrow id="S4.E7.m1.2.2.2.2.2.1.7.3.2.1" xref="S4.E7.m1.2.2.2.2.2.1.7.3.1.cmml"><mo id="S4.E7.m1.2.2.2.2.2.1.7.3.2.1.1" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.1.7.3.1.cmml">(</mo><mi id="S4.E7.m1.2.2.2.2.2.1.2" xref="S4.E7.m1.2.2.2.2.2.1.2.cmml">x</mi><mo id="S4.E7.m1.2.2.2.2.2.1.7.3.2.1.2" xref="S4.E7.m1.2.2.2.2.2.1.7.3.1.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2.2.1.3" xref="S4.E7.m1.2.2.2.2.2.1.3.cmml">z</mi><mo id="S4.E7.m1.2.2.2.2.2.1.7.3.2.1.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.1.7.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.2.2.2.2.2.1.8" xref="S4.E7.m1.2.2.2.2.2.1.8.cmml">=</mo><mrow id="S4.E7.m1.2.2.2.2.2.1.9" xref="S4.E7.m1.2.2.2.2.2.1.9.cmml"><mn id="S4.E7.m1.2.2.2.2.2.1.9.2" xref="S4.E7.m1.2.2.2.2.2.1.9.2.cmml">1</mn><mo id="S4.E7.m1.2.2.2.2.2.1.9.1" xref="S4.E7.m1.2.2.2.2.2.1.9.1.cmml">⁢</mo><mtext id="S4.E7.m1.2.2.2.2.2.1.9.3" xref="S4.E7.m1.2.2.2.2.2.1.9.3a.cmml"> and </mtext><mo id="S4.E7.m1.2.2.2.2.2.1.9.1a" xref="S4.E7.m1.2.2.2.2.2.1.9.1.cmml">⁢</mo><mi id="S4.E7.m1.2.2.2.2.2.1.9.4" xref="S4.E7.m1.2.2.2.2.2.1.9.4.cmml">z</mi></mrow><mo id="S4.E7.m1.2.2.2.2.2.1.10" xref="S4.E7.m1.2.2.2.2.2.1.10.cmml">∉</mo><mrow id="S4.E7.m1.2.2.2.2.2.1.11" xref="S4.E7.m1.2.2.2.2.2.1.11.cmml"><mi id="S4.E7.m1.2.2.2.2.2.1.11.2" xref="S4.E7.m1.2.2.2.2.2.1.11.2.cmml">t</mi><mo id="S4.E7.m1.2.2.2.2.2.1.11.1" xref="S4.E7.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mi id="S4.E7.m1.2.2.2.2.2.1.11.3" xref="S4.E7.m1.2.2.2.2.2.1.11.3.cmml">o</mi><mo id="S4.E7.m1.2.2.2.2.2.1.11.1a" xref="S4.E7.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mi id="S4.E7.m1.2.2.2.2.2.1.11.4" xref="S4.E7.m1.2.2.2.2.2.1.11.4.cmml">p</mi><mo id="S4.E7.m1.2.2.2.2.2.1.11.1b" xref="S4.E7.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mi id="S4.E7.m1.2.2.2.2.2.1.11.5" xref="S4.E7.m1.2.2.2.2.2.1.11.5.cmml">k</mi><mo id="S4.E7.m1.2.2.2.2.2.1.11.1c" xref="S4.E7.m1.2.2.2.2.2.1.11.1.cmml">⁢</mo><mrow id="S4.E7.m1.2.2.2.2.2.1.11.6.2" xref="S4.E7.m1.2.2.2.2.2.1.11.6.1.cmml"><mo id="S4.E7.m1.2.2.2.2.2.1.11.6.2.1" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.1.11.6.1.cmml">(</mo><mi id="S4.E7.m1.2.2.2.2.2.1.4" xref="S4.E7.m1.2.2.2.2.2.1.4.cmml">x</mi><mo id="S4.E7.m1.2.2.2.2.2.1.11.6.2.2" xref="S4.E7.m1.2.2.2.2.2.1.11.6.1.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2.2.1.5" xref="S4.E7.m1.2.2.2.2.2.1.5.cmml">ψ</mi><mo id="S4.E7.m1.2.2.2.2.2.1.11.6.2.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.1.11.6.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E7.m1.6.6.6d" xref="S4.E7.m1.8.9.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.6.6.6e" xref="S4.E7.m1.8.9.3.1.cmml"><mrow id="S4.E7.m1.3.3.3.3.1.1" xref="S4.E7.m1.3.3.3.3.1.1.cmml"><mo id="S4.E7.m1.3.3.3.3.1.1a" xref="S4.E7.m1.3.3.3.3.1.1.cmml">−</mo><mn id="S4.E7.m1.3.3.3.3.1.1.2" xref="S4.E7.m1.3.3.3.3.1.1.2.cmml">0.5</mn></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.6.6.6f" xref="S4.E7.m1.8.9.3.1.cmml"><mrow id="S4.E7.m1.4.4.4.4.2.1" xref="S4.E7.m1.4.4.4.4.2.1.cmml"><mrow id="S4.E7.m1.4.4.4.4.2.1.7" xref="S4.E7.m1.4.4.4.4.2.1.7.cmml"><mtext id="S4.E7.m1.4.4.4.4.2.1.7.2" xref="S4.E7.m1.4.4.4.4.2.1.7.2a.cmml"> if </mtext><mo id="S4.E7.m1.4.4.4.4.2.1.7.1" lspace="0.167em" xref="S4.E7.m1.4.4.4.4.2.1.7.1.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.4.4.2.1.7.3.2" xref="S4.E7.m1.4.4.4.4.2.1.7.3.1.cmml"><mi id="S4.E7.m1.4.4.4.4.2.1.1" xref="S4.E7.m1.4.4.4.4.2.1.1.cmml">Rel</mi><mo id="S4.E7.m1.4.4.4.4.2.1.7.3.2a" xref="S4.E7.m1.4.4.4.4.2.1.7.3.1.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.4.4.2.1.7.3.2.1" xref="S4.E7.m1.4.4.4.4.2.1.7.3.1.cmml"><mo id="S4.E7.m1.4.4.4.4.2.1.7.3.2.1.1" stretchy="false" xref="S4.E7.m1.4.4.4.4.2.1.7.3.1.cmml">(</mo><mi id="S4.E7.m1.4.4.4.4.2.1.2" xref="S4.E7.m1.4.4.4.4.2.1.2.cmml">x</mi><mo id="S4.E7.m1.4.4.4.4.2.1.7.3.2.1.2" xref="S4.E7.m1.4.4.4.4.2.1.7.3.1.cmml">,</mo><mi id="S4.E7.m1.4.4.4.4.2.1.3" xref="S4.E7.m1.4.4.4.4.2.1.3.cmml">z</mi><mo id="S4.E7.m1.4.4.4.4.2.1.7.3.2.1.3" stretchy="false" xref="S4.E7.m1.4.4.4.4.2.1.7.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.4.4.4.4.2.1.8" xref="S4.E7.m1.4.4.4.4.2.1.8.cmml">=</mo><mrow id="S4.E7.m1.4.4.4.4.2.1.9" xref="S4.E7.m1.4.4.4.4.2.1.9.cmml"><mn id="S4.E7.m1.4.4.4.4.2.1.9.2" xref="S4.E7.m1.4.4.4.4.2.1.9.2.cmml">1</mn><mo id="S4.E7.m1.4.4.4.4.2.1.9.1" xref="S4.E7.m1.4.4.4.4.2.1.9.1.cmml">⁢</mo><mtext id="S4.E7.m1.4.4.4.4.2.1.9.3" xref="S4.E7.m1.4.4.4.4.2.1.9.3a.cmml"> and </mtext><mo id="S4.E7.m1.4.4.4.4.2.1.9.1a" xref="S4.E7.m1.4.4.4.4.2.1.9.1.cmml">⁢</mo><mi id="S4.E7.m1.4.4.4.4.2.1.9.4" xref="S4.E7.m1.4.4.4.4.2.1.9.4.cmml">z</mi></mrow><mo id="S4.E7.m1.4.4.4.4.2.1.10" xref="S4.E7.m1.4.4.4.4.2.1.10.cmml">∈</mo><mrow id="S4.E7.m1.4.4.4.4.2.1.11" xref="S4.E7.m1.4.4.4.4.2.1.11.cmml"><mi id="S4.E7.m1.4.4.4.4.2.1.11.2" xref="S4.E7.m1.4.4.4.4.2.1.11.2.cmml">t</mi><mo id="S4.E7.m1.4.4.4.4.2.1.11.1" xref="S4.E7.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mi id="S4.E7.m1.4.4.4.4.2.1.11.3" xref="S4.E7.m1.4.4.4.4.2.1.11.3.cmml">o</mi><mo id="S4.E7.m1.4.4.4.4.2.1.11.1a" xref="S4.E7.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mi id="S4.E7.m1.4.4.4.4.2.1.11.4" xref="S4.E7.m1.4.4.4.4.2.1.11.4.cmml">p</mi><mo id="S4.E7.m1.4.4.4.4.2.1.11.1b" xref="S4.E7.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mi id="S4.E7.m1.4.4.4.4.2.1.11.5" xref="S4.E7.m1.4.4.4.4.2.1.11.5.cmml">k</mi><mo id="S4.E7.m1.4.4.4.4.2.1.11.1c" xref="S4.E7.m1.4.4.4.4.2.1.11.1.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.4.4.2.1.11.6.2" xref="S4.E7.m1.4.4.4.4.2.1.11.6.1.cmml"><mo id="S4.E7.m1.4.4.4.4.2.1.11.6.2.1" stretchy="false" xref="S4.E7.m1.4.4.4.4.2.1.11.6.1.cmml">(</mo><mi id="S4.E7.m1.4.4.4.4.2.1.4" xref="S4.E7.m1.4.4.4.4.2.1.4.cmml">x</mi><mo id="S4.E7.m1.4.4.4.4.2.1.11.6.2.2" xref="S4.E7.m1.4.4.4.4.2.1.11.6.1.cmml">,</mo><mi id="S4.E7.m1.4.4.4.4.2.1.5" xref="S4.E7.m1.4.4.4.4.2.1.5.cmml">ψ</mi><mo id="S4.E7.m1.4.4.4.4.2.1.11.6.2.3" stretchy="false" xref="S4.E7.m1.4.4.4.4.2.1.11.6.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E7.m1.6.6.6g" xref="S4.E7.m1.8.9.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.6.6.6h" xref="S4.E7.m1.8.9.3.1.cmml"><mn id="S4.E7.m1.5.5.5.5.1.1" xref="S4.E7.m1.5.5.5.5.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.6.6.6i" xref="S4.E7.m1.8.9.3.1.cmml"><mtext id="S4.E7.m1.6.6.6.6.2.1" xref="S4.E7.m1.6.6.6.6.2.1a.cmml"> otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.8b"><apply id="S4.E7.m1.8.9.cmml" xref="S4.E7.m1.8.9"><eq id="S4.E7.m1.8.9.1.cmml" xref="S4.E7.m1.8.9.1"></eq><apply id="S4.E7.m1.8.9.2.cmml" xref="S4.E7.m1.8.9.2"><times id="S4.E7.m1.8.9.2.1.cmml" xref="S4.E7.m1.8.9.2.1"></times><apply id="S4.E7.m1.8.9.2.2.cmml" xref="S4.E7.m1.8.9.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.8.9.2.2.1.cmml" xref="S4.E7.m1.8.9.2.2">subscript</csymbol><ci id="S4.E7.m1.8.9.2.2.2.cmml" xref="S4.E7.m1.8.9.2.2.2">ℛ</ci><ci id="S4.E7.m1.8.9.2.2.3.cmml" xref="S4.E7.m1.8.9.2.2.3">𝑏</ci></apply><interval closure="open" id="S4.E7.m1.8.9.2.3.1.cmml" xref="S4.E7.m1.8.9.2.3.2"><ci id="S4.E7.m1.7.7.cmml" xref="S4.E7.m1.7.7">𝑥</ci><ci id="S4.E7.m1.8.8.cmml" xref="S4.E7.m1.8.8">𝑧</ci></interval></apply><apply id="S4.E7.m1.8.9.3.1.cmml" xref="S4.E7.m1.6.6"><csymbol cd="latexml" id="S4.E7.m1.8.9.3.1.1.cmml" xref="S4.E7.m1.6.6.7">cases</csymbol><cn id="S4.E7.m1.1.1.1.1.1.1.cmml" type="integer" xref="S4.E7.m1.1.1.1.1.1.1">1</cn><apply id="S4.E7.m1.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1"><and id="S4.E7.m1.2.2.2.2.2.1a.cmml" xref="S4.E7.m1.2.2.2.2.2.1"></and><apply id="S4.E7.m1.2.2.2.2.2.1b.cmml" xref="S4.E7.m1.2.2.2.2.2.1"><eq id="S4.E7.m1.2.2.2.2.2.1.8.cmml" xref="S4.E7.m1.2.2.2.2.2.1.8"></eq><apply id="S4.E7.m1.2.2.2.2.2.1.7.cmml" xref="S4.E7.m1.2.2.2.2.2.1.7"><times id="S4.E7.m1.2.2.2.2.2.1.7.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.7.1"></times><ci id="S4.E7.m1.2.2.2.2.2.1.7.2a.cmml" xref="S4.E7.m1.2.2.2.2.2.1.7.2"><mtext id="S4.E7.m1.2.2.2.2.2.1.7.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.7.2"> if </mtext></ci><apply id="S4.E7.m1.2.2.2.2.2.1.7.3.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.7.3.2"><ci id="S4.E7.m1.2.2.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1">Rel</ci><ci id="S4.E7.m1.2.2.2.2.2.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.2">𝑥</ci><ci id="S4.E7.m1.2.2.2.2.2.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.1.3">𝑧</ci></apply></apply><apply id="S4.E7.m1.2.2.2.2.2.1.9.cmml" xref="S4.E7.m1.2.2.2.2.2.1.9"><times id="S4.E7.m1.2.2.2.2.2.1.9.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.9.1"></times><cn id="S4.E7.m1.2.2.2.2.2.1.9.2.cmml" type="integer" xref="S4.E7.m1.2.2.2.2.2.1.9.2">1</cn><ci id="S4.E7.m1.2.2.2.2.2.1.9.3a.cmml" xref="S4.E7.m1.2.2.2.2.2.1.9.3"><mtext id="S4.E7.m1.2.2.2.2.2.1.9.3.cmml" xref="S4.E7.m1.2.2.2.2.2.1.9.3"> and </mtext></ci><ci id="S4.E7.m1.2.2.2.2.2.1.9.4.cmml" xref="S4.E7.m1.2.2.2.2.2.1.9.4">𝑧</ci></apply></apply><apply id="S4.E7.m1.2.2.2.2.2.1c.cmml" xref="S4.E7.m1.2.2.2.2.2.1"><notin id="S4.E7.m1.2.2.2.2.2.1.10.cmml" xref="S4.E7.m1.2.2.2.2.2.1.10"></notin><share href="https://arxiv.org/html/2406.14169v1#S4.E7.m1.2.2.2.2.2.1.9.cmml" id="S4.E7.m1.2.2.2.2.2.1d.cmml" xref="S4.E7.m1.2.2.2.2.2.1"></share><apply id="S4.E7.m1.2.2.2.2.2.1.11.cmml" xref="S4.E7.m1.2.2.2.2.2.1.11"><times id="S4.E7.m1.2.2.2.2.2.1.11.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.11.1"></times><ci id="S4.E7.m1.2.2.2.2.2.1.11.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.11.2">𝑡</ci><ci id="S4.E7.m1.2.2.2.2.2.1.11.3.cmml" xref="S4.E7.m1.2.2.2.2.2.1.11.3">𝑜</ci><ci id="S4.E7.m1.2.2.2.2.2.1.11.4.cmml" xref="S4.E7.m1.2.2.2.2.2.1.11.4">𝑝</ci><ci id="S4.E7.m1.2.2.2.2.2.1.11.5.cmml" xref="S4.E7.m1.2.2.2.2.2.1.11.5">𝑘</ci><interval closure="open" id="S4.E7.m1.2.2.2.2.2.1.11.6.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.11.6.2"><ci id="S4.E7.m1.2.2.2.2.2.1.4.cmml" xref="S4.E7.m1.2.2.2.2.2.1.4">𝑥</ci><ci id="S4.E7.m1.2.2.2.2.2.1.5.cmml" xref="S4.E7.m1.2.2.2.2.2.1.5">𝜓</ci></interval></apply></apply></apply><apply id="S4.E7.m1.3.3.3.3.1.1.cmml" xref="S4.E7.m1.3.3.3.3.1.1"><minus id="S4.E7.m1.3.3.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.1.1"></minus><cn id="S4.E7.m1.3.3.3.3.1.1.2.cmml" type="float" xref="S4.E7.m1.3.3.3.3.1.1.2">0.5</cn></apply><apply id="S4.E7.m1.4.4.4.4.2.1.cmml" xref="S4.E7.m1.4.4.4.4.2.1"><and id="S4.E7.m1.4.4.4.4.2.1a.cmml" xref="S4.E7.m1.4.4.4.4.2.1"></and><apply id="S4.E7.m1.4.4.4.4.2.1b.cmml" xref="S4.E7.m1.4.4.4.4.2.1"><eq id="S4.E7.m1.4.4.4.4.2.1.8.cmml" xref="S4.E7.m1.4.4.4.4.2.1.8"></eq><apply id="S4.E7.m1.4.4.4.4.2.1.7.cmml" xref="S4.E7.m1.4.4.4.4.2.1.7"><times id="S4.E7.m1.4.4.4.4.2.1.7.1.cmml" xref="S4.E7.m1.4.4.4.4.2.1.7.1"></times><ci id="S4.E7.m1.4.4.4.4.2.1.7.2a.cmml" xref="S4.E7.m1.4.4.4.4.2.1.7.2"><mtext id="S4.E7.m1.4.4.4.4.2.1.7.2.cmml" xref="S4.E7.m1.4.4.4.4.2.1.7.2"> if </mtext></ci><apply id="S4.E7.m1.4.4.4.4.2.1.7.3.1.cmml" xref="S4.E7.m1.4.4.4.4.2.1.7.3.2"><ci id="S4.E7.m1.4.4.4.4.2.1.1.cmml" xref="S4.E7.m1.4.4.4.4.2.1.1">Rel</ci><ci id="S4.E7.m1.4.4.4.4.2.1.2.cmml" xref="S4.E7.m1.4.4.4.4.2.1.2">𝑥</ci><ci id="S4.E7.m1.4.4.4.4.2.1.3.cmml" xref="S4.E7.m1.4.4.4.4.2.1.3">𝑧</ci></apply></apply><apply id="S4.E7.m1.4.4.4.4.2.1.9.cmml" xref="S4.E7.m1.4.4.4.4.2.1.9"><times id="S4.E7.m1.4.4.4.4.2.1.9.1.cmml" xref="S4.E7.m1.4.4.4.4.2.1.9.1"></times><cn id="S4.E7.m1.4.4.4.4.2.1.9.2.cmml" type="integer" xref="S4.E7.m1.4.4.4.4.2.1.9.2">1</cn><ci id="S4.E7.m1.4.4.4.4.2.1.9.3a.cmml" xref="S4.E7.m1.4.4.4.4.2.1.9.3"><mtext id="S4.E7.m1.4.4.4.4.2.1.9.3.cmml" xref="S4.E7.m1.4.4.4.4.2.1.9.3"> and </mtext></ci><ci id="S4.E7.m1.4.4.4.4.2.1.9.4.cmml" xref="S4.E7.m1.4.4.4.4.2.1.9.4">𝑧</ci></apply></apply><apply id="S4.E7.m1.4.4.4.4.2.1c.cmml" xref="S4.E7.m1.4.4.4.4.2.1"><in id="S4.E7.m1.4.4.4.4.2.1.10.cmml" xref="S4.E7.m1.4.4.4.4.2.1.10"></in><share href="https://arxiv.org/html/2406.14169v1#S4.E7.m1.4.4.4.4.2.1.9.cmml" id="S4.E7.m1.4.4.4.4.2.1d.cmml" xref="S4.E7.m1.4.4.4.4.2.1"></share><apply id="S4.E7.m1.4.4.4.4.2.1.11.cmml" xref="S4.E7.m1.4.4.4.4.2.1.11"><times id="S4.E7.m1.4.4.4.4.2.1.11.1.cmml" xref="S4.E7.m1.4.4.4.4.2.1.11.1"></times><ci id="S4.E7.m1.4.4.4.4.2.1.11.2.cmml" xref="S4.E7.m1.4.4.4.4.2.1.11.2">𝑡</ci><ci id="S4.E7.m1.4.4.4.4.2.1.11.3.cmml" xref="S4.E7.m1.4.4.4.4.2.1.11.3">𝑜</ci><ci id="S4.E7.m1.4.4.4.4.2.1.11.4.cmml" xref="S4.E7.m1.4.4.4.4.2.1.11.4">𝑝</ci><ci id="S4.E7.m1.4.4.4.4.2.1.11.5.cmml" xref="S4.E7.m1.4.4.4.4.2.1.11.5">𝑘</ci><interval closure="open" id="S4.E7.m1.4.4.4.4.2.1.11.6.1.cmml" xref="S4.E7.m1.4.4.4.4.2.1.11.6.2"><ci id="S4.E7.m1.4.4.4.4.2.1.4.cmml" xref="S4.E7.m1.4.4.4.4.2.1.4">𝑥</ci><ci id="S4.E7.m1.4.4.4.4.2.1.5.cmml" xref="S4.E7.m1.4.4.4.4.2.1.5">𝜓</ci></interval></apply></apply></apply><cn id="S4.E7.m1.5.5.5.5.1.1.cmml" type="integer" xref="S4.E7.m1.5.5.5.5.1.1">0</cn><ci id="S4.E7.m1.6.6.6.6.2.1a.cmml" xref="S4.E7.m1.6.6.6.6.2.1"><mtext id="S4.E7.m1.6.6.6.6.2.1.cmml" xref="S4.E7.m1.6.6.6.6.2.1"> otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.8c">\mathcal{R}_{b}(x,z)=\begin{cases}1&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{%
 and \ }z\not\in topk(x,\psi)\\
-0.5&amp;\text{ if }\operatorname{Rel}(x,z)=1\text{ and \ }z\in topk(x,\psi)\\
0&amp;\text{ otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.8d">caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x , italic_z ) = { start_ROW start_CELL 1 end_CELL start_CELL if roman_Rel ( italic_x , italic_z ) = 1 and italic_z ∉ italic_t italic_o italic_p italic_k ( italic_x , italic_ψ ) end_CELL end_ROW start_ROW start_CELL - 0.5 end_CELL start_CELL if roman_Rel ( italic_x , italic_z ) = 1 and italic_z ∈ italic_t italic_o italic_p italic_k ( italic_x , italic_ψ ) end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Reduction to binary action space</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.5">To further improve the convergence rate, we consider a different RL formulation where the state is <math alttext="\langle" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mo id="S4.SS2.p1.1.m1.1.1" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">⟨</annotation></semantics></math>query, item<math alttext="\rangle" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mo id="S4.SS2.p1.2.m2.1.1" stretchy="false" xref="S4.SS2.p1.2.m2.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">⟩</annotation></semantics></math> pair and the policy outputs the probability of selecting the item. The item-wise reward function changes slightly to accommodate the two actions of selecting the item (1) or not (0). Assuming the same reward logic from Eqn. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.E6" title="In 4.1. Reduction from Top-k to item-wise rewards ‣ 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">6</span></a>, the reward function becomes, <math alttext="\mathcal{R}((x,z),a)=a\mathcal{R}_{b}(x,z)+(1-a)(-\mathcal{R}_{b}(x,z))" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.10"><semantics id="S4.SS2.p1.3.m3.10a"><mrow id="S4.SS2.p1.3.m3.10.10" xref="S4.SS2.p1.3.m3.10.10.cmml"><mrow id="S4.SS2.p1.3.m3.8.8.1" xref="S4.SS2.p1.3.m3.8.8.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.8.8.1.3" xref="S4.SS2.p1.3.m3.8.8.1.3.cmml">ℛ</mi><mo id="S4.SS2.p1.3.m3.8.8.1.2" xref="S4.SS2.p1.3.m3.8.8.1.2.cmml">⁢</mo><mrow id="S4.SS2.p1.3.m3.8.8.1.1.1" xref="S4.SS2.p1.3.m3.8.8.1.1.2.cmml"><mo id="S4.SS2.p1.3.m3.8.8.1.1.1.2" stretchy="false" xref="S4.SS2.p1.3.m3.8.8.1.1.2.cmml">(</mo><mrow id="S4.SS2.p1.3.m3.8.8.1.1.1.1.2" xref="S4.SS2.p1.3.m3.8.8.1.1.1.1.1.cmml"><mo id="S4.SS2.p1.3.m3.8.8.1.1.1.1.2.1" stretchy="false" xref="S4.SS2.p1.3.m3.8.8.1.1.1.1.1.cmml">(</mo><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">x</mi><mo id="S4.SS2.p1.3.m3.8.8.1.1.1.1.2.2" xref="S4.SS2.p1.3.m3.8.8.1.1.1.1.1.cmml">,</mo><mi id="S4.SS2.p1.3.m3.2.2" xref="S4.SS2.p1.3.m3.2.2.cmml">z</mi><mo id="S4.SS2.p1.3.m3.8.8.1.1.1.1.2.3" stretchy="false" xref="S4.SS2.p1.3.m3.8.8.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p1.3.m3.8.8.1.1.1.3" xref="S4.SS2.p1.3.m3.8.8.1.1.2.cmml">,</mo><mi id="S4.SS2.p1.3.m3.3.3" xref="S4.SS2.p1.3.m3.3.3.cmml">a</mi><mo id="S4.SS2.p1.3.m3.8.8.1.1.1.4" stretchy="false" xref="S4.SS2.p1.3.m3.8.8.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.3.m3.10.10.4" xref="S4.SS2.p1.3.m3.10.10.4.cmml">=</mo><mrow id="S4.SS2.p1.3.m3.10.10.3" xref="S4.SS2.p1.3.m3.10.10.3.cmml"><mrow id="S4.SS2.p1.3.m3.10.10.3.4" xref="S4.SS2.p1.3.m3.10.10.3.4.cmml"><mi id="S4.SS2.p1.3.m3.10.10.3.4.2" xref="S4.SS2.p1.3.m3.10.10.3.4.2.cmml">a</mi><mo id="S4.SS2.p1.3.m3.10.10.3.4.1" xref="S4.SS2.p1.3.m3.10.10.3.4.1.cmml">⁢</mo><msub id="S4.SS2.p1.3.m3.10.10.3.4.3" xref="S4.SS2.p1.3.m3.10.10.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.10.10.3.4.3.2" xref="S4.SS2.p1.3.m3.10.10.3.4.3.2.cmml">ℛ</mi><mi id="S4.SS2.p1.3.m3.10.10.3.4.3.3" xref="S4.SS2.p1.3.m3.10.10.3.4.3.3.cmml">b</mi></msub><mo id="S4.SS2.p1.3.m3.10.10.3.4.1a" xref="S4.SS2.p1.3.m3.10.10.3.4.1.cmml">⁢</mo><mrow id="S4.SS2.p1.3.m3.10.10.3.4.4.2" xref="S4.SS2.p1.3.m3.10.10.3.4.4.1.cmml"><mo id="S4.SS2.p1.3.m3.10.10.3.4.4.2.1" stretchy="false" xref="S4.SS2.p1.3.m3.10.10.3.4.4.1.cmml">(</mo><mi id="S4.SS2.p1.3.m3.4.4" xref="S4.SS2.p1.3.m3.4.4.cmml">x</mi><mo id="S4.SS2.p1.3.m3.10.10.3.4.4.2.2" xref="S4.SS2.p1.3.m3.10.10.3.4.4.1.cmml">,</mo><mi id="S4.SS2.p1.3.m3.5.5" xref="S4.SS2.p1.3.m3.5.5.cmml">z</mi><mo id="S4.SS2.p1.3.m3.10.10.3.4.4.2.3" stretchy="false" xref="S4.SS2.p1.3.m3.10.10.3.4.4.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.3.m3.10.10.3.3" xref="S4.SS2.p1.3.m3.10.10.3.3.cmml">+</mo><mrow id="S4.SS2.p1.3.m3.10.10.3.2" xref="S4.SS2.p1.3.m3.10.10.3.2.cmml"><mrow id="S4.SS2.p1.3.m3.9.9.2.1.1.1" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.cmml"><mo id="S4.SS2.p1.3.m3.9.9.2.1.1.1.2" stretchy="false" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.cmml"><mn id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.2" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.1" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.1.cmml">−</mo><mi id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.3" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.3.cmml">a</mi></mrow><mo id="S4.SS2.p1.3.m3.9.9.2.1.1.1.3" stretchy="false" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p1.3.m3.10.10.3.2.3" xref="S4.SS2.p1.3.m3.10.10.3.2.3.cmml">⁢</mo><mrow id="S4.SS2.p1.3.m3.10.10.3.2.2.1" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.cmml"><mo id="S4.SS2.p1.3.m3.10.10.3.2.2.1.2" stretchy="false" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.cmml">(</mo><mrow id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.cmml"><mo id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1a" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.cmml">−</mo><mrow id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.cmml"><msub id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.2" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.2.cmml">ℛ</mi><mi id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.3" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.3.cmml">b</mi></msub><mo id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.1" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.2" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.1.cmml"><mo id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.2.1" stretchy="false" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.1.cmml">(</mo><mi id="S4.SS2.p1.3.m3.6.6" xref="S4.SS2.p1.3.m3.6.6.cmml">x</mi><mo id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.2.2" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.1.cmml">,</mo><mi id="S4.SS2.p1.3.m3.7.7" xref="S4.SS2.p1.3.m3.7.7.cmml">z</mi><mo id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.2.3" stretchy="false" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS2.p1.3.m3.10.10.3.2.2.1.3" stretchy="false" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.10b"><apply id="S4.SS2.p1.3.m3.10.10.cmml" xref="S4.SS2.p1.3.m3.10.10"><eq id="S4.SS2.p1.3.m3.10.10.4.cmml" xref="S4.SS2.p1.3.m3.10.10.4"></eq><apply id="S4.SS2.p1.3.m3.8.8.1.cmml" xref="S4.SS2.p1.3.m3.8.8.1"><times id="S4.SS2.p1.3.m3.8.8.1.2.cmml" xref="S4.SS2.p1.3.m3.8.8.1.2"></times><ci id="S4.SS2.p1.3.m3.8.8.1.3.cmml" xref="S4.SS2.p1.3.m3.8.8.1.3">ℛ</ci><interval closure="open" id="S4.SS2.p1.3.m3.8.8.1.1.2.cmml" xref="S4.SS2.p1.3.m3.8.8.1.1.1"><interval closure="open" id="S4.SS2.p1.3.m3.8.8.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.8.8.1.1.1.1.2"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑥</ci><ci id="S4.SS2.p1.3.m3.2.2.cmml" xref="S4.SS2.p1.3.m3.2.2">𝑧</ci></interval><ci id="S4.SS2.p1.3.m3.3.3.cmml" xref="S4.SS2.p1.3.m3.3.3">𝑎</ci></interval></apply><apply id="S4.SS2.p1.3.m3.10.10.3.cmml" xref="S4.SS2.p1.3.m3.10.10.3"><plus id="S4.SS2.p1.3.m3.10.10.3.3.cmml" xref="S4.SS2.p1.3.m3.10.10.3.3"></plus><apply id="S4.SS2.p1.3.m3.10.10.3.4.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4"><times id="S4.SS2.p1.3.m3.10.10.3.4.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4.1"></times><ci id="S4.SS2.p1.3.m3.10.10.3.4.2.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4.2">𝑎</ci><apply id="S4.SS2.p1.3.m3.10.10.3.4.3.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.10.10.3.4.3.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.10.10.3.4.3.2.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4.3.2">ℛ</ci><ci id="S4.SS2.p1.3.m3.10.10.3.4.3.3.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4.3.3">𝑏</ci></apply><interval closure="open" id="S4.SS2.p1.3.m3.10.10.3.4.4.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.4.4.2"><ci id="S4.SS2.p1.3.m3.4.4.cmml" xref="S4.SS2.p1.3.m3.4.4">𝑥</ci><ci id="S4.SS2.p1.3.m3.5.5.cmml" xref="S4.SS2.p1.3.m3.5.5">𝑧</ci></interval></apply><apply id="S4.SS2.p1.3.m3.10.10.3.2.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2"><times id="S4.SS2.p1.3.m3.10.10.3.2.3.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.3"></times><apply id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1"><minus id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.1"></minus><cn id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.2.cmml" type="integer" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.2">1</cn><ci id="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.9.9.2.1.1.1.1.3">𝑎</ci></apply><apply id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1"><minus id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1"></minus><apply id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2"><times id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.1"></times><apply id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.2.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.2">ℛ</ci><ci id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.3.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.2.3">𝑏</ci></apply><interval closure="open" id="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.1.cmml" xref="S4.SS2.p1.3.m3.10.10.3.2.2.1.1.2.3.2"><ci id="S4.SS2.p1.3.m3.6.6.cmml" xref="S4.SS2.p1.3.m3.6.6">𝑥</ci><ci id="S4.SS2.p1.3.m3.7.7.cmml" xref="S4.SS2.p1.3.m3.7.7">𝑧</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.10c">\mathcal{R}((x,z),a)=a\mathcal{R}_{b}(x,z)+(1-a)(-\mathcal{R}_{b}(x,z))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.10d">caligraphic_R ( ( italic_x , italic_z ) , italic_a ) = italic_a caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x , italic_z ) + ( 1 - italic_a ) ( - caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x , italic_z ) )</annotation></semantics></math>. Intuitively, if the policy selects the item for a query, then its reward for the action is proportional to <math alttext="\mathcal{R}_{b}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><msub id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">ℛ</mi><mi id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">ℛ</ci><ci id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mathcal{R}_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math>. Otherwise, if it does not select the item, then its reward is proportional to negative of <math alttext="\mathcal{R}_{b}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><msub id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">ℛ</mi><mi id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">ℛ</ci><ci id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mathcal{R}_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math>. The corresponding gradient is,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\nabla\mathbf{E}_{x,z\sim\mathcal{D}}\mathbf{E}_{\mathbf{a}\sim%
\pi^{\prime}_{\theta}(x,z)}\mathcal{R}((x,z),a)" class="ltx_Math" display="inline" id="S4.E8.m2.8"><semantics id="S4.E8.m2.8a"><mrow id="S4.E8.m2.8.8" xref="S4.E8.m2.8.8.cmml"><mrow id="S4.E8.m2.8.8.3" xref="S4.E8.m2.8.8.3.cmml"><mo id="S4.E8.m2.8.8.3.1" mathsize="90%" rspace="0.167em" xref="S4.E8.m2.8.8.3.1.cmml">∇</mo><mrow id="S4.E8.m2.8.8.3.2" xref="S4.E8.m2.8.8.3.2.cmml"><msub id="S4.E8.m2.8.8.3.2.2" xref="S4.E8.m2.8.8.3.2.2.cmml"><mi id="S4.E8.m2.8.8.3.2.2.2" mathsize="90%" xref="S4.E8.m2.8.8.3.2.2.2.cmml">𝐄</mi><mrow id="S4.E8.m2.2.2.2" xref="S4.E8.m2.2.2.2.cmml"><mrow id="S4.E8.m2.2.2.2.4.2" xref="S4.E8.m2.2.2.2.4.1.cmml"><mi id="S4.E8.m2.1.1.1.1" mathsize="90%" xref="S4.E8.m2.1.1.1.1.cmml">x</mi><mo id="S4.E8.m2.2.2.2.4.2.1" mathsize="90%" xref="S4.E8.m2.2.2.2.4.1.cmml">,</mo><mi id="S4.E8.m2.2.2.2.2" mathsize="90%" xref="S4.E8.m2.2.2.2.2.cmml">z</mi></mrow><mo id="S4.E8.m2.2.2.2.3" mathsize="90%" xref="S4.E8.m2.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m2.2.2.2.5" mathsize="90%" xref="S4.E8.m2.2.2.2.5.cmml">𝒟</mi></mrow></msub><mo id="S4.E8.m2.8.8.3.2.1" xref="S4.E8.m2.8.8.3.2.1.cmml">⁢</mo><msub id="S4.E8.m2.8.8.3.2.3" xref="S4.E8.m2.8.8.3.2.3.cmml"><mi id="S4.E8.m2.8.8.3.2.3.2" mathsize="90%" xref="S4.E8.m2.8.8.3.2.3.2.cmml">𝐄</mi><mrow id="S4.E8.m2.4.4.2" xref="S4.E8.m2.4.4.2.cmml"><mi id="S4.E8.m2.4.4.2.4" mathsize="90%" xref="S4.E8.m2.4.4.2.4.cmml">𝐚</mi><mo id="S4.E8.m2.4.4.2.3" mathsize="90%" xref="S4.E8.m2.4.4.2.3.cmml">∼</mo><mrow id="S4.E8.m2.4.4.2.5" xref="S4.E8.m2.4.4.2.5.cmml"><msubsup id="S4.E8.m2.4.4.2.5.2" xref="S4.E8.m2.4.4.2.5.2.cmml"><mi id="S4.E8.m2.4.4.2.5.2.2.2" mathsize="90%" xref="S4.E8.m2.4.4.2.5.2.2.2.cmml">π</mi><mi id="S4.E8.m2.4.4.2.5.2.3" mathsize="90%" xref="S4.E8.m2.4.4.2.5.2.3.cmml">θ</mi><mo id="S4.E8.m2.4.4.2.5.2.2.3" mathsize="90%" xref="S4.E8.m2.4.4.2.5.2.2.3.cmml">′</mo></msubsup><mo id="S4.E8.m2.4.4.2.5.1" xref="S4.E8.m2.4.4.2.5.1.cmml">⁢</mo><mrow id="S4.E8.m2.4.4.2.5.3.2" xref="S4.E8.m2.4.4.2.5.3.1.cmml"><mo id="S4.E8.m2.4.4.2.5.3.2.1" maxsize="90%" minsize="90%" xref="S4.E8.m2.4.4.2.5.3.1.cmml">(</mo><mi id="S4.E8.m2.3.3.1.1" mathsize="90%" xref="S4.E8.m2.3.3.1.1.cmml">x</mi><mo id="S4.E8.m2.4.4.2.5.3.2.2" mathsize="90%" xref="S4.E8.m2.4.4.2.5.3.1.cmml">,</mo><mi id="S4.E8.m2.4.4.2.2" mathsize="90%" xref="S4.E8.m2.4.4.2.2.cmml">z</mi><mo id="S4.E8.m2.4.4.2.5.3.2.3" maxsize="90%" minsize="90%" xref="S4.E8.m2.4.4.2.5.3.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S4.E8.m2.8.8.3.2.1a" xref="S4.E8.m2.8.8.3.2.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m2.8.8.3.2.4" mathsize="90%" xref="S4.E8.m2.8.8.3.2.4.cmml">ℛ</mi></mrow></mrow><mo id="S4.E8.m2.8.8.2" xref="S4.E8.m2.8.8.2.cmml">⁢</mo><mrow id="S4.E8.m2.8.8.1.1" xref="S4.E8.m2.8.8.1.2.cmml"><mo id="S4.E8.m2.8.8.1.1.2" maxsize="90%" minsize="90%" xref="S4.E8.m2.8.8.1.2.cmml">(</mo><mrow id="S4.E8.m2.8.8.1.1.1.2" xref="S4.E8.m2.8.8.1.1.1.1.cmml"><mo id="S4.E8.m2.8.8.1.1.1.2.1" maxsize="90%" minsize="90%" xref="S4.E8.m2.8.8.1.1.1.1.cmml">(</mo><mi id="S4.E8.m2.5.5" mathsize="90%" xref="S4.E8.m2.5.5.cmml">x</mi><mo id="S4.E8.m2.8.8.1.1.1.2.2" mathsize="90%" xref="S4.E8.m2.8.8.1.1.1.1.cmml">,</mo><mi id="S4.E8.m2.6.6" mathsize="90%" xref="S4.E8.m2.6.6.cmml">z</mi><mo id="S4.E8.m2.8.8.1.1.1.2.3" maxsize="90%" minsize="90%" xref="S4.E8.m2.8.8.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E8.m2.8.8.1.1.3" mathsize="90%" xref="S4.E8.m2.8.8.1.2.cmml">,</mo><mi id="S4.E8.m2.7.7" mathsize="90%" xref="S4.E8.m2.7.7.cmml">a</mi><mo id="S4.E8.m2.8.8.1.1.4" maxsize="90%" minsize="90%" xref="S4.E8.m2.8.8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m2.8b"><apply id="S4.E8.m2.8.8.cmml" xref="S4.E8.m2.8.8"><times id="S4.E8.m2.8.8.2.cmml" xref="S4.E8.m2.8.8.2"></times><apply id="S4.E8.m2.8.8.3.cmml" xref="S4.E8.m2.8.8.3"><ci id="S4.E8.m2.8.8.3.1.cmml" xref="S4.E8.m2.8.8.3.1">∇</ci><apply id="S4.E8.m2.8.8.3.2.cmml" xref="S4.E8.m2.8.8.3.2"><times id="S4.E8.m2.8.8.3.2.1.cmml" xref="S4.E8.m2.8.8.3.2.1"></times><apply id="S4.E8.m2.8.8.3.2.2.cmml" xref="S4.E8.m2.8.8.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m2.8.8.3.2.2.1.cmml" xref="S4.E8.m2.8.8.3.2.2">subscript</csymbol><ci id="S4.E8.m2.8.8.3.2.2.2.cmml" xref="S4.E8.m2.8.8.3.2.2.2">𝐄</ci><apply id="S4.E8.m2.2.2.2.cmml" xref="S4.E8.m2.2.2.2"><csymbol cd="latexml" id="S4.E8.m2.2.2.2.3.cmml" xref="S4.E8.m2.2.2.2.3">similar-to</csymbol><list id="S4.E8.m2.2.2.2.4.1.cmml" xref="S4.E8.m2.2.2.2.4.2"><ci id="S4.E8.m2.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1.1">𝑥</ci><ci id="S4.E8.m2.2.2.2.2.cmml" xref="S4.E8.m2.2.2.2.2">𝑧</ci></list><ci id="S4.E8.m2.2.2.2.5.cmml" xref="S4.E8.m2.2.2.2.5">𝒟</ci></apply></apply><apply id="S4.E8.m2.8.8.3.2.3.cmml" xref="S4.E8.m2.8.8.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m2.8.8.3.2.3.1.cmml" xref="S4.E8.m2.8.8.3.2.3">subscript</csymbol><ci id="S4.E8.m2.8.8.3.2.3.2.cmml" xref="S4.E8.m2.8.8.3.2.3.2">𝐄</ci><apply id="S4.E8.m2.4.4.2.cmml" xref="S4.E8.m2.4.4.2"><csymbol cd="latexml" id="S4.E8.m2.4.4.2.3.cmml" xref="S4.E8.m2.4.4.2.3">similar-to</csymbol><ci id="S4.E8.m2.4.4.2.4.cmml" xref="S4.E8.m2.4.4.2.4">𝐚</ci><apply id="S4.E8.m2.4.4.2.5.cmml" xref="S4.E8.m2.4.4.2.5"><times id="S4.E8.m2.4.4.2.5.1.cmml" xref="S4.E8.m2.4.4.2.5.1"></times><apply id="S4.E8.m2.4.4.2.5.2.cmml" xref="S4.E8.m2.4.4.2.5.2"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.2.5.2.1.cmml" xref="S4.E8.m2.4.4.2.5.2">subscript</csymbol><apply id="S4.E8.m2.4.4.2.5.2.2.cmml" xref="S4.E8.m2.4.4.2.5.2"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.2.5.2.2.1.cmml" xref="S4.E8.m2.4.4.2.5.2">superscript</csymbol><ci id="S4.E8.m2.4.4.2.5.2.2.2.cmml" xref="S4.E8.m2.4.4.2.5.2.2.2">𝜋</ci><ci id="S4.E8.m2.4.4.2.5.2.2.3.cmml" xref="S4.E8.m2.4.4.2.5.2.2.3">′</ci></apply><ci id="S4.E8.m2.4.4.2.5.2.3.cmml" xref="S4.E8.m2.4.4.2.5.2.3">𝜃</ci></apply><interval closure="open" id="S4.E8.m2.4.4.2.5.3.1.cmml" xref="S4.E8.m2.4.4.2.5.3.2"><ci id="S4.E8.m2.3.3.1.1.cmml" xref="S4.E8.m2.3.3.1.1">𝑥</ci><ci id="S4.E8.m2.4.4.2.2.cmml" xref="S4.E8.m2.4.4.2.2">𝑧</ci></interval></apply></apply></apply><ci id="S4.E8.m2.8.8.3.2.4.cmml" xref="S4.E8.m2.8.8.3.2.4">ℛ</ci></apply></apply><interval closure="open" id="S4.E8.m2.8.8.1.2.cmml" xref="S4.E8.m2.8.8.1.1"><interval closure="open" id="S4.E8.m2.8.8.1.1.1.1.cmml" xref="S4.E8.m2.8.8.1.1.1.2"><ci id="S4.E8.m2.5.5.cmml" xref="S4.E8.m2.5.5">𝑥</ci><ci id="S4.E8.m2.6.6.cmml" xref="S4.E8.m2.6.6">𝑧</ci></interval><ci id="S4.E8.m2.7.7.cmml" xref="S4.E8.m2.7.7">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m2.8c">\displaystyle\nabla\mathbf{E}_{x,z\sim\mathcal{D}}\mathbf{E}_{\mathbf{a}\sim%
\pi^{\prime}_{\theta}(x,z)}\mathcal{R}((x,z),a)</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m2.8d">∇ bold_E start_POSTSUBSCRIPT italic_x , italic_z ∼ caligraphic_D end_POSTSUBSCRIPT bold_E start_POSTSUBSCRIPT bold_a ∼ italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_z ) end_POSTSUBSCRIPT caligraphic_R ( ( italic_x , italic_z ) , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\approx\frac{1}{B}\sum_{i=1}^{B}[a^{(i)}\mathcal{R}_{b}(x^{(i)},z%
^{(i)})-(1-a^{(i)})\mathcal{R}_{b}(x^{(i)},z^{(i)})]\nabla\log{\pi^{\prime}_{%
\theta}(a^{(i)}|x^{(i)},z^{(i)})}" class="ltx_Math" display="inline" id="S4.Ex3.m1.11"><semantics id="S4.Ex3.m1.11a"><mrow id="S4.Ex3.m1.11.11" xref="S4.Ex3.m1.11.11.cmml"><mi id="S4.Ex3.m1.11.11.4" xref="S4.Ex3.m1.11.11.4.cmml"></mi><mo id="S4.Ex3.m1.11.11.3" mathsize="90%" xref="S4.Ex3.m1.11.11.3.cmml">≈</mo><mrow id="S4.Ex3.m1.11.11.2" xref="S4.Ex3.m1.11.11.2.cmml"><mstyle displaystyle="true" id="S4.Ex3.m1.11.11.2.4" xref="S4.Ex3.m1.11.11.2.4.cmml"><mfrac id="S4.Ex3.m1.11.11.2.4a" xref="S4.Ex3.m1.11.11.2.4.cmml"><mn id="S4.Ex3.m1.11.11.2.4.2" mathsize="90%" xref="S4.Ex3.m1.11.11.2.4.2.cmml">1</mn><mi id="S4.Ex3.m1.11.11.2.4.3" mathsize="90%" xref="S4.Ex3.m1.11.11.2.4.3.cmml">B</mi></mfrac></mstyle><mo id="S4.Ex3.m1.11.11.2.3" xref="S4.Ex3.m1.11.11.2.3.cmml">⁢</mo><mrow id="S4.Ex3.m1.11.11.2.2" xref="S4.Ex3.m1.11.11.2.2.cmml"><mstyle displaystyle="true" id="S4.Ex3.m1.11.11.2.2.3" xref="S4.Ex3.m1.11.11.2.2.3.cmml"><munderover id="S4.Ex3.m1.11.11.2.2.3a" xref="S4.Ex3.m1.11.11.2.2.3.cmml"><mo id="S4.Ex3.m1.11.11.2.2.3.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S4.Ex3.m1.11.11.2.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex3.m1.11.11.2.2.3.2.3" xref="S4.Ex3.m1.11.11.2.2.3.2.3.cmml"><mi id="S4.Ex3.m1.11.11.2.2.3.2.3.2" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.3.2.3.2.cmml">i</mi><mo id="S4.Ex3.m1.11.11.2.2.3.2.3.1" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex3.m1.11.11.2.2.3.2.3.3" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex3.m1.11.11.2.2.3.3" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.3.3.cmml">B</mi></munderover></mstyle><mrow id="S4.Ex3.m1.11.11.2.2.2" xref="S4.Ex3.m1.11.11.2.2.2.cmml"><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1" xref="S4.Ex3.m1.10.10.1.1.1.1.2.cmml"><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1.1" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.cmml"><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.cmml"><msup id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.cmml"><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.2.cmml">a</mi><mrow id="S4.Ex3.m1.1.1.1.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.cmml"><mo id="S4.Ex3.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.cmml">(</mo><mi id="S4.Ex3.m1.1.1.1.1" mathsize="90%" xref="S4.Ex3.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex3.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.cmml">)</mo></mrow></msup><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.3.cmml">⁢</mo><msub id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.2.cmml">ℛ</mi><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.3" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.3.cmml">b</mi></msub><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.3a" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.3" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.3.cmml">(</mo><msup id="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.Ex3.m1.2.2.1.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.2.2.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex3.m1.2.2.1.1" mathsize="90%" xref="S4.Ex3.m1.2.2.1.1.cmml">i</mi><mo id="S4.Ex3.m1.2.2.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.4" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.2.cmml">z</mi><mrow id="S4.Ex3.m1.3.3.1.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="S4.Ex3.m1.3.3.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="S4.Ex3.m1.3.3.1.1" mathsize="90%" xref="S4.Ex3.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex3.m1.3.3.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.5" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.6" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.6.cmml">−</mo><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.cmml"><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.cmml"><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.cmml"><mn id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.2.cmml">1</mn><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.1" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.1.cmml">−</mo><msup id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.2.cmml">a</mi><mrow id="S4.Ex3.m1.4.4.1.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.cmml"><mo id="S4.Ex3.m1.4.4.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.cmml">(</mo><mi id="S4.Ex3.m1.4.4.1.1" mathsize="90%" xref="S4.Ex3.m1.4.4.1.1.cmml">i</mi><mo id="S4.Ex3.m1.4.4.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.3" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.4" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.4.cmml">⁢</mo><msub id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.2.cmml">ℛ</mi><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.3" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.3.cmml">b</mi></msub><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.4a" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.4.cmml">⁢</mo><mrow id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.3.cmml"><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.3" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.3.cmml">(</mo><msup id="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.cmml"><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.2.cmml">x</mi><mrow id="S4.Ex3.m1.5.5.1.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.cmml"><mo id="S4.Ex3.m1.5.5.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.cmml">(</mo><mi id="S4.Ex3.m1.5.5.1.1" mathsize="90%" xref="S4.Ex3.m1.5.5.1.1.cmml">i</mi><mo id="S4.Ex3.m1.5.5.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.cmml">)</mo></mrow></msup><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.4" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.3.cmml">,</mo><msup id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.cmml"><mi id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.2" mathsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.2.cmml">z</mi><mrow id="S4.Ex3.m1.6.6.1.3" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.cmml"><mo id="S4.Ex3.m1.6.6.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.cmml">(</mo><mi id="S4.Ex3.m1.6.6.1.1" mathsize="90%" xref="S4.Ex3.m1.6.6.1.1.cmml">i</mi><mo id="S4.Ex3.m1.6.6.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.cmml">)</mo></mrow></msup><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.5" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex3.m1.10.10.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.10.10.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S4.Ex3.m1.11.11.2.2.2.3" lspace="0.167em" xref="S4.Ex3.m1.11.11.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex3.m1.11.11.2.2.2.4" xref="S4.Ex3.m1.11.11.2.2.2.4.cmml"><mrow id="S4.Ex3.m1.11.11.2.2.2.4.1" xref="S4.Ex3.m1.11.11.2.2.2.4.1.cmml"><mo id="S4.Ex3.m1.11.11.2.2.2.4.1.1" mathsize="90%" rspace="0.167em" xref="S4.Ex3.m1.11.11.2.2.2.4.1.1.cmml">∇</mo><mi id="S4.Ex3.m1.11.11.2.2.2.4.1.2" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.4.1.2.cmml">log</mi></mrow><mo id="S4.Ex3.m1.11.11.2.2.2.4a" lspace="0.167em" xref="S4.Ex3.m1.11.11.2.2.2.4.cmml">⁡</mo><msubsup id="S4.Ex3.m1.11.11.2.2.2.4.2" xref="S4.Ex3.m1.11.11.2.2.2.4.2.cmml"><mi id="S4.Ex3.m1.11.11.2.2.2.4.2.2.2" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.4.2.2.2.cmml">π</mi><mi id="S4.Ex3.m1.11.11.2.2.2.4.2.3" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.4.2.3.cmml">θ</mi><mo id="S4.Ex3.m1.11.11.2.2.2.4.2.2.3" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.4.2.2.3.cmml">′</mo></msubsup></mrow><mo id="S4.Ex3.m1.11.11.2.2.2.3a" xref="S4.Ex3.m1.11.11.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex3.m1.11.11.2.2.2.2.1" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.cmml"><mo id="S4.Ex3.m1.11.11.2.2.2.2.1.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.Ex3.m1.11.11.2.2.2.2.1.1" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.cmml"><msup id="S4.Ex3.m1.11.11.2.2.2.2.1.1.4" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.cmml"><mi id="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.2" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.2.cmml">a</mi><mrow id="S4.Ex3.m1.7.7.1.3" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.cmml"><mo id="S4.Ex3.m1.7.7.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.cmml">(</mo><mi id="S4.Ex3.m1.7.7.1.1" mathsize="90%" xref="S4.Ex3.m1.7.7.1.1.cmml">i</mi><mo id="S4.Ex3.m1.7.7.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.cmml">)</mo></mrow></msup><mo fence="false" id="S4.Ex3.m1.11.11.2.2.2.2.1.1.3" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.3.cmml">|</mo><mrow id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.3.cmml"><msup id="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.2" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.Ex3.m1.8.8.1.3" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.cmml"><mo id="S4.Ex3.m1.8.8.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.cmml">(</mo><mi id="S4.Ex3.m1.8.8.1.1" mathsize="90%" xref="S4.Ex3.m1.8.8.1.1.cmml">i</mi><mo id="S4.Ex3.m1.8.8.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.3" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.3.cmml">,</mo><msup id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.cmml"><mi id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.2" mathsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.2.cmml">z</mi><mrow id="S4.Ex3.m1.9.9.1.3" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.cmml"><mo id="S4.Ex3.m1.9.9.1.3.1" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.cmml">(</mo><mi id="S4.Ex3.m1.9.9.1.1" mathsize="90%" xref="S4.Ex3.m1.9.9.1.1.cmml">i</mi><mo id="S4.Ex3.m1.9.9.1.3.2" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S4.Ex3.m1.11.11.2.2.2.2.1.3" maxsize="90%" minsize="90%" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.11b"><apply id="S4.Ex3.m1.11.11.cmml" xref="S4.Ex3.m1.11.11"><approx id="S4.Ex3.m1.11.11.3.cmml" xref="S4.Ex3.m1.11.11.3"></approx><csymbol cd="latexml" id="S4.Ex3.m1.11.11.4.cmml" xref="S4.Ex3.m1.11.11.4">absent</csymbol><apply id="S4.Ex3.m1.11.11.2.cmml" xref="S4.Ex3.m1.11.11.2"><times id="S4.Ex3.m1.11.11.2.3.cmml" xref="S4.Ex3.m1.11.11.2.3"></times><apply id="S4.Ex3.m1.11.11.2.4.cmml" xref="S4.Ex3.m1.11.11.2.4"><divide id="S4.Ex3.m1.11.11.2.4.1.cmml" xref="S4.Ex3.m1.11.11.2.4"></divide><cn id="S4.Ex3.m1.11.11.2.4.2.cmml" type="integer" xref="S4.Ex3.m1.11.11.2.4.2">1</cn><ci id="S4.Ex3.m1.11.11.2.4.3.cmml" xref="S4.Ex3.m1.11.11.2.4.3">𝐵</ci></apply><apply id="S4.Ex3.m1.11.11.2.2.cmml" xref="S4.Ex3.m1.11.11.2.2"><apply id="S4.Ex3.m1.11.11.2.2.3.cmml" xref="S4.Ex3.m1.11.11.2.2.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.11.11.2.2.3.1.cmml" xref="S4.Ex3.m1.11.11.2.2.3">superscript</csymbol><apply id="S4.Ex3.m1.11.11.2.2.3.2.cmml" xref="S4.Ex3.m1.11.11.2.2.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.11.11.2.2.3.2.1.cmml" xref="S4.Ex3.m1.11.11.2.2.3">subscript</csymbol><sum id="S4.Ex3.m1.11.11.2.2.3.2.2.cmml" xref="S4.Ex3.m1.11.11.2.2.3.2.2"></sum><apply id="S4.Ex3.m1.11.11.2.2.3.2.3.cmml" xref="S4.Ex3.m1.11.11.2.2.3.2.3"><eq id="S4.Ex3.m1.11.11.2.2.3.2.3.1.cmml" xref="S4.Ex3.m1.11.11.2.2.3.2.3.1"></eq><ci id="S4.Ex3.m1.11.11.2.2.3.2.3.2.cmml" xref="S4.Ex3.m1.11.11.2.2.3.2.3.2">𝑖</ci><cn id="S4.Ex3.m1.11.11.2.2.3.2.3.3.cmml" type="integer" xref="S4.Ex3.m1.11.11.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex3.m1.11.11.2.2.3.3.cmml" xref="S4.Ex3.m1.11.11.2.2.3.3">𝐵</ci></apply><apply id="S4.Ex3.m1.11.11.2.2.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2"><times id="S4.Ex3.m1.11.11.2.2.2.3.cmml" xref="S4.Ex3.m1.11.11.2.2.2.3"></times><apply id="S4.Ex3.m1.10.10.1.1.1.1.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex3.m1.10.10.1.1.1.1.2.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1"><minus id="S4.Ex3.m1.10.10.1.1.1.1.1.1.6.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.6"></minus><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2"><times id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.3"></times><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4">superscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.4.2">𝑎</ci><ci id="S4.Ex3.m1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5">subscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.2">ℛ</ci><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.3.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.5.3">𝑏</ci></apply><interval closure="open" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2"><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.Ex3.m1.2.2.1.1.cmml" xref="S4.Ex3.m1.2.2.1.1">𝑖</ci></apply><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S4.Ex3.m1.3.3.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1">𝑖</ci></apply></interval></apply><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5"><times id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.4.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.4"></times><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1"><minus id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.1"></minus><cn id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.2.cmml" type="integer" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.2">1</cn><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3">superscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.3.1.1.1.3.2">𝑎</ci><ci id="S4.Ex3.m1.4.4.1.1.cmml" xref="S4.Ex3.m1.4.4.1.1">𝑖</ci></apply></apply><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5">subscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.2">ℛ</ci><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.3.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.5.3">𝑏</ci></apply><interval closure="open" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.3.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2"><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1">superscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.4.2.1.1.2">𝑥</ci><ci id="S4.Ex3.m1.5.5.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1">𝑖</ci></apply><apply id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.1.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2">superscript</csymbol><ci id="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.2.cmml" xref="S4.Ex3.m1.10.10.1.1.1.1.1.1.5.3.2.2.2">𝑧</ci><ci id="S4.Ex3.m1.6.6.1.1.cmml" xref="S4.Ex3.m1.6.6.1.1">𝑖</ci></apply></interval></apply></apply></apply><apply id="S4.Ex3.m1.11.11.2.2.2.4.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4"><apply id="S4.Ex3.m1.11.11.2.2.2.4.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.1"><ci id="S4.Ex3.m1.11.11.2.2.2.4.1.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.1.1">∇</ci><log id="S4.Ex3.m1.11.11.2.2.2.4.1.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.1.2"></log></apply><apply id="S4.Ex3.m1.11.11.2.2.2.4.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.11.11.2.2.2.4.2.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.2">subscript</csymbol><apply id="S4.Ex3.m1.11.11.2.2.2.4.2.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.11.11.2.2.2.4.2.2.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.2">superscript</csymbol><ci id="S4.Ex3.m1.11.11.2.2.2.4.2.2.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.2.2.2">𝜋</ci><ci id="S4.Ex3.m1.11.11.2.2.2.4.2.2.3.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.2.2.3">′</ci></apply><ci id="S4.Ex3.m1.11.11.2.2.2.4.2.3.cmml" xref="S4.Ex3.m1.11.11.2.2.2.4.2.3">𝜃</ci></apply></apply><apply id="S4.Ex3.m1.11.11.2.2.2.2.1.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1"><csymbol cd="latexml" id="S4.Ex3.m1.11.11.2.2.2.2.1.1.3.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.3">conditional</csymbol><apply id="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4">superscript</csymbol><ci id="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.4.2">𝑎</ci><ci id="S4.Ex3.m1.7.7.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1">𝑖</ci></apply><list id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.3.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2"><apply id="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.1.1.1.2">𝑥</ci><ci id="S4.Ex3.m1.8.8.1.1.cmml" xref="S4.Ex3.m1.8.8.1.1">𝑖</ci></apply><apply id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.1.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2">superscript</csymbol><ci id="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.Ex3.m1.11.11.2.2.2.2.1.1.2.2.2.2">𝑧</ci><ci id="S4.Ex3.m1.9.9.1.1.cmml" xref="S4.Ex3.m1.9.9.1.1">𝑖</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.11c">\displaystyle\approx\frac{1}{B}\sum_{i=1}^{B}[a^{(i)}\mathcal{R}_{b}(x^{(i)},z%
^{(i)})-(1-a^{(i)})\mathcal{R}_{b}(x^{(i)},z^{(i)})]\nabla\log{\pi^{\prime}_{%
\theta}(a^{(i)}|x^{(i)},z^{(i)})}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.11d">≈ divide start_ARG 1 end_ARG start_ARG italic_B end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT [ italic_a start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_z start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) - ( 1 - italic_a start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_z start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ] ∇ roman_log italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_z start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.7">where <math alttext="\pi^{\prime}_{\theta}(a=1|x,z)=\pi_{\theta}(x,z)=\operatorname{softmax}_{Z}%
\texttt{sim}(f_{\theta}(x),f_{\theta}(z))" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m1.9"><semantics id="S4.SS2.p1.6.m1.9a"><mrow id="S4.SS2.p1.6.m1.9.9" xref="S4.SS2.p1.6.m1.9.9.cmml"><mrow id="S4.SS2.p1.6.m1.7.7.1" xref="S4.SS2.p1.6.m1.7.7.1.cmml"><msubsup id="S4.SS2.p1.6.m1.7.7.1.3" xref="S4.SS2.p1.6.m1.7.7.1.3.cmml"><mi id="S4.SS2.p1.6.m1.7.7.1.3.2.2" xref="S4.SS2.p1.6.m1.7.7.1.3.2.2.cmml">π</mi><mi id="S4.SS2.p1.6.m1.7.7.1.3.3" xref="S4.SS2.p1.6.m1.7.7.1.3.3.cmml">θ</mi><mo id="S4.SS2.p1.6.m1.7.7.1.3.2.3" xref="S4.SS2.p1.6.m1.7.7.1.3.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.p1.6.m1.7.7.1.2" xref="S4.SS2.p1.6.m1.7.7.1.2.cmml">⁢</mo><mrow id="S4.SS2.p1.6.m1.7.7.1.1.1" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.cmml"><mo id="S4.SS2.p1.6.m1.7.7.1.1.1.2" stretchy="false" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.6.m1.7.7.1.1.1.1" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.cmml"><mi id="S4.SS2.p1.6.m1.7.7.1.1.1.1.2" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.2.cmml">a</mi><mo id="S4.SS2.p1.6.m1.7.7.1.1.1.1.1" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.cmml"><mn id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.2" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.2.cmml">1</mn><mo fence="false" id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.1" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.1.cmml">|</mo><mrow id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.3.2" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.3.1.cmml"><mi id="S4.SS2.p1.6.m1.1.1" xref="S4.SS2.p1.6.m1.1.1.cmml">x</mi><mo id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.3.2.1" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.3.1.cmml">,</mo><mi id="S4.SS2.p1.6.m1.2.2" xref="S4.SS2.p1.6.m1.2.2.cmml">z</mi></mrow></mrow></mrow><mo id="S4.SS2.p1.6.m1.7.7.1.1.1.3" stretchy="false" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.6.m1.9.9.5" xref="S4.SS2.p1.6.m1.9.9.5.cmml">=</mo><mrow id="S4.SS2.p1.6.m1.9.9.6" xref="S4.SS2.p1.6.m1.9.9.6.cmml"><msub id="S4.SS2.p1.6.m1.9.9.6.2" xref="S4.SS2.p1.6.m1.9.9.6.2.cmml"><mi id="S4.SS2.p1.6.m1.9.9.6.2.2" xref="S4.SS2.p1.6.m1.9.9.6.2.2.cmml">π</mi><mi id="S4.SS2.p1.6.m1.9.9.6.2.3" xref="S4.SS2.p1.6.m1.9.9.6.2.3.cmml">θ</mi></msub><mo id="S4.SS2.p1.6.m1.9.9.6.1" xref="S4.SS2.p1.6.m1.9.9.6.1.cmml">⁢</mo><mrow id="S4.SS2.p1.6.m1.9.9.6.3.2" xref="S4.SS2.p1.6.m1.9.9.6.3.1.cmml"><mo id="S4.SS2.p1.6.m1.9.9.6.3.2.1" stretchy="false" xref="S4.SS2.p1.6.m1.9.9.6.3.1.cmml">(</mo><mi id="S4.SS2.p1.6.m1.3.3" xref="S4.SS2.p1.6.m1.3.3.cmml">x</mi><mo id="S4.SS2.p1.6.m1.9.9.6.3.2.2" xref="S4.SS2.p1.6.m1.9.9.6.3.1.cmml">,</mo><mi id="S4.SS2.p1.6.m1.4.4" xref="S4.SS2.p1.6.m1.4.4.cmml">z</mi><mo id="S4.SS2.p1.6.m1.9.9.6.3.2.3" stretchy="false" xref="S4.SS2.p1.6.m1.9.9.6.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.6.m1.9.9.7" xref="S4.SS2.p1.6.m1.9.9.7.cmml">=</mo><mrow id="S4.SS2.p1.6.m1.9.9.3" xref="S4.SS2.p1.6.m1.9.9.3.cmml"><mrow id="S4.SS2.p1.6.m1.9.9.3.4" xref="S4.SS2.p1.6.m1.9.9.3.4.cmml"><msub id="S4.SS2.p1.6.m1.9.9.3.4.1" xref="S4.SS2.p1.6.m1.9.9.3.4.1.cmml"><mi id="S4.SS2.p1.6.m1.9.9.3.4.1.2" xref="S4.SS2.p1.6.m1.9.9.3.4.1.2.cmml">softmax</mi><mi id="S4.SS2.p1.6.m1.9.9.3.4.1.3" xref="S4.SS2.p1.6.m1.9.9.3.4.1.3.cmml">Z</mi></msub><mo id="S4.SS2.p1.6.m1.9.9.3.4a" lspace="0.167em" xref="S4.SS2.p1.6.m1.9.9.3.4.cmml">⁡</mo><mtext class="ltx_mathvariant_monospace" id="S4.SS2.p1.6.m1.9.9.3.4.2" xref="S4.SS2.p1.6.m1.9.9.3.4.2a.cmml">sim</mtext></mrow><mo id="S4.SS2.p1.6.m1.9.9.3.3" xref="S4.SS2.p1.6.m1.9.9.3.3.cmml">⁢</mo><mrow id="S4.SS2.p1.6.m1.9.9.3.2.2" xref="S4.SS2.p1.6.m1.9.9.3.2.3.cmml"><mo id="S4.SS2.p1.6.m1.9.9.3.2.2.3" stretchy="false" xref="S4.SS2.p1.6.m1.9.9.3.2.3.cmml">(</mo><mrow id="S4.SS2.p1.6.m1.8.8.2.1.1.1" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.cmml"><msub id="S4.SS2.p1.6.m1.8.8.2.1.1.1.2" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.cmml"><mi id="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.2" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.2.cmml">f</mi><mi id="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.3" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.3.cmml">θ</mi></msub><mo id="S4.SS2.p1.6.m1.8.8.2.1.1.1.1" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.p1.6.m1.8.8.2.1.1.1.3.2" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.cmml"><mo id="S4.SS2.p1.6.m1.8.8.2.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.cmml">(</mo><mi id="S4.SS2.p1.6.m1.5.5" xref="S4.SS2.p1.6.m1.5.5.cmml">x</mi><mo id="S4.SS2.p1.6.m1.8.8.2.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.6.m1.9.9.3.2.2.4" xref="S4.SS2.p1.6.m1.9.9.3.2.3.cmml">,</mo><mrow id="S4.SS2.p1.6.m1.9.9.3.2.2.2" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.cmml"><msub id="S4.SS2.p1.6.m1.9.9.3.2.2.2.2" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.cmml"><mi id="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.2" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.2.cmml">f</mi><mi id="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.3" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.3.cmml">θ</mi></msub><mo id="S4.SS2.p1.6.m1.9.9.3.2.2.2.1" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.6.m1.9.9.3.2.2.2.3.2" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.cmml"><mo id="S4.SS2.p1.6.m1.9.9.3.2.2.2.3.2.1" stretchy="false" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.cmml">(</mo><mi id="S4.SS2.p1.6.m1.6.6" xref="S4.SS2.p1.6.m1.6.6.cmml">z</mi><mo id="S4.SS2.p1.6.m1.9.9.3.2.2.2.3.2.2" stretchy="false" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.6.m1.9.9.3.2.2.5" stretchy="false" xref="S4.SS2.p1.6.m1.9.9.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m1.9b"><apply id="S4.SS2.p1.6.m1.9.9.cmml" xref="S4.SS2.p1.6.m1.9.9"><and id="S4.SS2.p1.6.m1.9.9a.cmml" xref="S4.SS2.p1.6.m1.9.9"></and><apply id="S4.SS2.p1.6.m1.9.9b.cmml" xref="S4.SS2.p1.6.m1.9.9"><eq id="S4.SS2.p1.6.m1.9.9.5.cmml" xref="S4.SS2.p1.6.m1.9.9.5"></eq><apply id="S4.SS2.p1.6.m1.7.7.1.cmml" xref="S4.SS2.p1.6.m1.7.7.1"><times id="S4.SS2.p1.6.m1.7.7.1.2.cmml" xref="S4.SS2.p1.6.m1.7.7.1.2"></times><apply id="S4.SS2.p1.6.m1.7.7.1.3.cmml" xref="S4.SS2.p1.6.m1.7.7.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m1.7.7.1.3.1.cmml" xref="S4.SS2.p1.6.m1.7.7.1.3">subscript</csymbol><apply id="S4.SS2.p1.6.m1.7.7.1.3.2.cmml" xref="S4.SS2.p1.6.m1.7.7.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m1.7.7.1.3.2.1.cmml" xref="S4.SS2.p1.6.m1.7.7.1.3">superscript</csymbol><ci id="S4.SS2.p1.6.m1.7.7.1.3.2.2.cmml" xref="S4.SS2.p1.6.m1.7.7.1.3.2.2">𝜋</ci><ci id="S4.SS2.p1.6.m1.7.7.1.3.2.3.cmml" xref="S4.SS2.p1.6.m1.7.7.1.3.2.3">′</ci></apply><ci id="S4.SS2.p1.6.m1.7.7.1.3.3.cmml" xref="S4.SS2.p1.6.m1.7.7.1.3.3">𝜃</ci></apply><apply id="S4.SS2.p1.6.m1.7.7.1.1.1.1.cmml" xref="S4.SS2.p1.6.m1.7.7.1.1.1"><eq id="S4.SS2.p1.6.m1.7.7.1.1.1.1.1.cmml" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.1"></eq><ci id="S4.SS2.p1.6.m1.7.7.1.1.1.1.2.cmml" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.2">𝑎</ci><apply id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.cmml" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3"><csymbol cd="latexml" id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.1">conditional</csymbol><cn id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.2">1</cn><list id="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.6.m1.7.7.1.1.1.1.3.3.2"><ci id="S4.SS2.p1.6.m1.1.1.cmml" xref="S4.SS2.p1.6.m1.1.1">𝑥</ci><ci id="S4.SS2.p1.6.m1.2.2.cmml" xref="S4.SS2.p1.6.m1.2.2">𝑧</ci></list></apply></apply></apply><apply id="S4.SS2.p1.6.m1.9.9.6.cmml" xref="S4.SS2.p1.6.m1.9.9.6"><times id="S4.SS2.p1.6.m1.9.9.6.1.cmml" xref="S4.SS2.p1.6.m1.9.9.6.1"></times><apply id="S4.SS2.p1.6.m1.9.9.6.2.cmml" xref="S4.SS2.p1.6.m1.9.9.6.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m1.9.9.6.2.1.cmml" xref="S4.SS2.p1.6.m1.9.9.6.2">subscript</csymbol><ci id="S4.SS2.p1.6.m1.9.9.6.2.2.cmml" xref="S4.SS2.p1.6.m1.9.9.6.2.2">𝜋</ci><ci id="S4.SS2.p1.6.m1.9.9.6.2.3.cmml" xref="S4.SS2.p1.6.m1.9.9.6.2.3">𝜃</ci></apply><interval closure="open" id="S4.SS2.p1.6.m1.9.9.6.3.1.cmml" xref="S4.SS2.p1.6.m1.9.9.6.3.2"><ci id="S4.SS2.p1.6.m1.3.3.cmml" xref="S4.SS2.p1.6.m1.3.3">𝑥</ci><ci id="S4.SS2.p1.6.m1.4.4.cmml" xref="S4.SS2.p1.6.m1.4.4">𝑧</ci></interval></apply></apply><apply id="S4.SS2.p1.6.m1.9.9c.cmml" xref="S4.SS2.p1.6.m1.9.9"><eq id="S4.SS2.p1.6.m1.9.9.7.cmml" xref="S4.SS2.p1.6.m1.9.9.7"></eq><share href="https://arxiv.org/html/2406.14169v1#S4.SS2.p1.6.m1.9.9.6.cmml" id="S4.SS2.p1.6.m1.9.9d.cmml" xref="S4.SS2.p1.6.m1.9.9"></share><apply id="S4.SS2.p1.6.m1.9.9.3.cmml" xref="S4.SS2.p1.6.m1.9.9.3"><times id="S4.SS2.p1.6.m1.9.9.3.3.cmml" xref="S4.SS2.p1.6.m1.9.9.3.3"></times><apply id="S4.SS2.p1.6.m1.9.9.3.4.cmml" xref="S4.SS2.p1.6.m1.9.9.3.4"><apply id="S4.SS2.p1.6.m1.9.9.3.4.1.cmml" xref="S4.SS2.p1.6.m1.9.9.3.4.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m1.9.9.3.4.1.1.cmml" xref="S4.SS2.p1.6.m1.9.9.3.4.1">subscript</csymbol><ci id="S4.SS2.p1.6.m1.9.9.3.4.1.2.cmml" xref="S4.SS2.p1.6.m1.9.9.3.4.1.2">softmax</ci><ci id="S4.SS2.p1.6.m1.9.9.3.4.1.3.cmml" xref="S4.SS2.p1.6.m1.9.9.3.4.1.3">𝑍</ci></apply><ci id="S4.SS2.p1.6.m1.9.9.3.4.2a.cmml" xref="S4.SS2.p1.6.m1.9.9.3.4.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.p1.6.m1.9.9.3.4.2.cmml" xref="S4.SS2.p1.6.m1.9.9.3.4.2">sim</mtext></ci></apply><interval closure="open" id="S4.SS2.p1.6.m1.9.9.3.2.3.cmml" xref="S4.SS2.p1.6.m1.9.9.3.2.2"><apply id="S4.SS2.p1.6.m1.8.8.2.1.1.1.cmml" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1"><times id="S4.SS2.p1.6.m1.8.8.2.1.1.1.1.cmml" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.1"></times><apply id="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.cmml" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.1.cmml" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.2.cmml" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.2">𝑓</ci><ci id="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.3.cmml" xref="S4.SS2.p1.6.m1.8.8.2.1.1.1.2.3">𝜃</ci></apply><ci id="S4.SS2.p1.6.m1.5.5.cmml" xref="S4.SS2.p1.6.m1.5.5">𝑥</ci></apply><apply id="S4.SS2.p1.6.m1.9.9.3.2.2.2.cmml" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2"><times id="S4.SS2.p1.6.m1.9.9.3.2.2.2.1.cmml" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.1"></times><apply id="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.cmml" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.1.cmml" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.2.cmml" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.2">𝑓</ci><ci id="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.3.cmml" xref="S4.SS2.p1.6.m1.9.9.3.2.2.2.2.3">𝜃</ci></apply><ci id="S4.SS2.p1.6.m1.6.6.cmml" xref="S4.SS2.p1.6.m1.6.6">𝑧</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m1.9c">\pi^{\prime}_{\theta}(a=1|x,z)=\pi_{\theta}(x,z)=\operatorname{softmax}_{Z}%
\texttt{sim}(f_{\theta}(x),f_{\theta}(z))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m1.9d">italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a = 1 | italic_x , italic_z ) = italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_z ) = roman_softmax start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT sim ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_z ) )</annotation></semantics></math> and <math alttext="\pi^{\prime}_{\theta}(a=0|x,z)=1-\pi_{\theta}(x,z)=1-\operatorname{softmax}_{Z%
}\texttt{sim}(f_{\theta}(x),f_{\theta}(z))" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m2.9"><semantics id="S4.SS2.p1.7.m2.9a"><mrow id="S4.SS2.p1.7.m2.9.9" xref="S4.SS2.p1.7.m2.9.9.cmml"><mrow id="S4.SS2.p1.7.m2.7.7.1" xref="S4.SS2.p1.7.m2.7.7.1.cmml"><msubsup id="S4.SS2.p1.7.m2.7.7.1.3" xref="S4.SS2.p1.7.m2.7.7.1.3.cmml"><mi id="S4.SS2.p1.7.m2.7.7.1.3.2.2" xref="S4.SS2.p1.7.m2.7.7.1.3.2.2.cmml">π</mi><mi id="S4.SS2.p1.7.m2.7.7.1.3.3" xref="S4.SS2.p1.7.m2.7.7.1.3.3.cmml">θ</mi><mo id="S4.SS2.p1.7.m2.7.7.1.3.2.3" xref="S4.SS2.p1.7.m2.7.7.1.3.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.p1.7.m2.7.7.1.2" xref="S4.SS2.p1.7.m2.7.7.1.2.cmml">⁢</mo><mrow id="S4.SS2.p1.7.m2.7.7.1.1.1" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.cmml"><mo id="S4.SS2.p1.7.m2.7.7.1.1.1.2" stretchy="false" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.7.m2.7.7.1.1.1.1" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.cmml"><mi id="S4.SS2.p1.7.m2.7.7.1.1.1.1.2" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.2.cmml">a</mi><mo id="S4.SS2.p1.7.m2.7.7.1.1.1.1.1" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.cmml"><mn id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.2" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.2.cmml">0</mn><mo fence="false" id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.1" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.1.cmml">|</mo><mrow id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.3.2" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.3.1.cmml"><mi id="S4.SS2.p1.7.m2.1.1" xref="S4.SS2.p1.7.m2.1.1.cmml">x</mi><mo id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.3.2.1" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.3.1.cmml">,</mo><mi id="S4.SS2.p1.7.m2.2.2" xref="S4.SS2.p1.7.m2.2.2.cmml">z</mi></mrow></mrow></mrow><mo id="S4.SS2.p1.7.m2.7.7.1.1.1.3" stretchy="false" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.7.m2.9.9.5" xref="S4.SS2.p1.7.m2.9.9.5.cmml">=</mo><mrow id="S4.SS2.p1.7.m2.9.9.6" xref="S4.SS2.p1.7.m2.9.9.6.cmml"><mn id="S4.SS2.p1.7.m2.9.9.6.2" xref="S4.SS2.p1.7.m2.9.9.6.2.cmml">1</mn><mo id="S4.SS2.p1.7.m2.9.9.6.1" xref="S4.SS2.p1.7.m2.9.9.6.1.cmml">−</mo><mrow id="S4.SS2.p1.7.m2.9.9.6.3" xref="S4.SS2.p1.7.m2.9.9.6.3.cmml"><msub id="S4.SS2.p1.7.m2.9.9.6.3.2" xref="S4.SS2.p1.7.m2.9.9.6.3.2.cmml"><mi id="S4.SS2.p1.7.m2.9.9.6.3.2.2" xref="S4.SS2.p1.7.m2.9.9.6.3.2.2.cmml">π</mi><mi id="S4.SS2.p1.7.m2.9.9.6.3.2.3" xref="S4.SS2.p1.7.m2.9.9.6.3.2.3.cmml">θ</mi></msub><mo id="S4.SS2.p1.7.m2.9.9.6.3.1" xref="S4.SS2.p1.7.m2.9.9.6.3.1.cmml">⁢</mo><mrow id="S4.SS2.p1.7.m2.9.9.6.3.3.2" xref="S4.SS2.p1.7.m2.9.9.6.3.3.1.cmml"><mo id="S4.SS2.p1.7.m2.9.9.6.3.3.2.1" stretchy="false" xref="S4.SS2.p1.7.m2.9.9.6.3.3.1.cmml">(</mo><mi id="S4.SS2.p1.7.m2.3.3" xref="S4.SS2.p1.7.m2.3.3.cmml">x</mi><mo id="S4.SS2.p1.7.m2.9.9.6.3.3.2.2" xref="S4.SS2.p1.7.m2.9.9.6.3.3.1.cmml">,</mo><mi id="S4.SS2.p1.7.m2.4.4" xref="S4.SS2.p1.7.m2.4.4.cmml">z</mi><mo id="S4.SS2.p1.7.m2.9.9.6.3.3.2.3" stretchy="false" xref="S4.SS2.p1.7.m2.9.9.6.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS2.p1.7.m2.9.9.7" xref="S4.SS2.p1.7.m2.9.9.7.cmml">=</mo><mrow id="S4.SS2.p1.7.m2.9.9.3" xref="S4.SS2.p1.7.m2.9.9.3.cmml"><mn id="S4.SS2.p1.7.m2.9.9.3.4" xref="S4.SS2.p1.7.m2.9.9.3.4.cmml">1</mn><mo id="S4.SS2.p1.7.m2.9.9.3.3" xref="S4.SS2.p1.7.m2.9.9.3.3.cmml">−</mo><mrow id="S4.SS2.p1.7.m2.9.9.3.2" xref="S4.SS2.p1.7.m2.9.9.3.2.cmml"><mrow id="S4.SS2.p1.7.m2.9.9.3.2.4" xref="S4.SS2.p1.7.m2.9.9.3.2.4.cmml"><msub id="S4.SS2.p1.7.m2.9.9.3.2.4.1" xref="S4.SS2.p1.7.m2.9.9.3.2.4.1.cmml"><mi id="S4.SS2.p1.7.m2.9.9.3.2.4.1.2" xref="S4.SS2.p1.7.m2.9.9.3.2.4.1.2.cmml">softmax</mi><mi id="S4.SS2.p1.7.m2.9.9.3.2.4.1.3" xref="S4.SS2.p1.7.m2.9.9.3.2.4.1.3.cmml">Z</mi></msub><mo id="S4.SS2.p1.7.m2.9.9.3.2.4a" lspace="0.167em" xref="S4.SS2.p1.7.m2.9.9.3.2.4.cmml">⁡</mo><mtext class="ltx_mathvariant_monospace" id="S4.SS2.p1.7.m2.9.9.3.2.4.2" xref="S4.SS2.p1.7.m2.9.9.3.2.4.2a.cmml">sim</mtext></mrow><mo id="S4.SS2.p1.7.m2.9.9.3.2.3" xref="S4.SS2.p1.7.m2.9.9.3.2.3.cmml">⁢</mo><mrow id="S4.SS2.p1.7.m2.9.9.3.2.2.2" xref="S4.SS2.p1.7.m2.9.9.3.2.2.3.cmml"><mo id="S4.SS2.p1.7.m2.9.9.3.2.2.2.3" stretchy="false" xref="S4.SS2.p1.7.m2.9.9.3.2.2.3.cmml">(</mo><mrow id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.cmml"><msub id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.2" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.2.cmml">f</mi><mi id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.3" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.1" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.3.2" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.cmml"><mo id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.cmml">(</mo><mi id="S4.SS2.p1.7.m2.5.5" xref="S4.SS2.p1.7.m2.5.5.cmml">x</mi><mo id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.7.m2.9.9.3.2.2.2.4" xref="S4.SS2.p1.7.m2.9.9.3.2.2.3.cmml">,</mo><mrow id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.cmml"><msub id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.cmml"><mi id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.2" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.2.cmml">f</mi><mi id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.3" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.3.cmml">θ</mi></msub><mo id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.1" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.3.2" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.cmml"><mo id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.3.2.1" stretchy="false" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.cmml">(</mo><mi id="S4.SS2.p1.7.m2.6.6" xref="S4.SS2.p1.7.m2.6.6.cmml">z</mi><mo id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.3.2.2" stretchy="false" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.7.m2.9.9.3.2.2.2.5" stretchy="false" xref="S4.SS2.p1.7.m2.9.9.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m2.9b"><apply id="S4.SS2.p1.7.m2.9.9.cmml" xref="S4.SS2.p1.7.m2.9.9"><and id="S4.SS2.p1.7.m2.9.9a.cmml" xref="S4.SS2.p1.7.m2.9.9"></and><apply id="S4.SS2.p1.7.m2.9.9b.cmml" xref="S4.SS2.p1.7.m2.9.9"><eq id="S4.SS2.p1.7.m2.9.9.5.cmml" xref="S4.SS2.p1.7.m2.9.9.5"></eq><apply id="S4.SS2.p1.7.m2.7.7.1.cmml" xref="S4.SS2.p1.7.m2.7.7.1"><times id="S4.SS2.p1.7.m2.7.7.1.2.cmml" xref="S4.SS2.p1.7.m2.7.7.1.2"></times><apply id="S4.SS2.p1.7.m2.7.7.1.3.cmml" xref="S4.SS2.p1.7.m2.7.7.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m2.7.7.1.3.1.cmml" xref="S4.SS2.p1.7.m2.7.7.1.3">subscript</csymbol><apply id="S4.SS2.p1.7.m2.7.7.1.3.2.cmml" xref="S4.SS2.p1.7.m2.7.7.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m2.7.7.1.3.2.1.cmml" xref="S4.SS2.p1.7.m2.7.7.1.3">superscript</csymbol><ci id="S4.SS2.p1.7.m2.7.7.1.3.2.2.cmml" xref="S4.SS2.p1.7.m2.7.7.1.3.2.2">𝜋</ci><ci id="S4.SS2.p1.7.m2.7.7.1.3.2.3.cmml" xref="S4.SS2.p1.7.m2.7.7.1.3.2.3">′</ci></apply><ci id="S4.SS2.p1.7.m2.7.7.1.3.3.cmml" xref="S4.SS2.p1.7.m2.7.7.1.3.3">𝜃</ci></apply><apply id="S4.SS2.p1.7.m2.7.7.1.1.1.1.cmml" xref="S4.SS2.p1.7.m2.7.7.1.1.1"><eq id="S4.SS2.p1.7.m2.7.7.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.1"></eq><ci id="S4.SS2.p1.7.m2.7.7.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.2">𝑎</ci><apply id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.cmml" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3"><csymbol cd="latexml" id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.1">conditional</csymbol><cn id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.2.cmml" type="integer" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.2">0</cn><list id="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.7.m2.7.7.1.1.1.1.3.3.2"><ci id="S4.SS2.p1.7.m2.1.1.cmml" xref="S4.SS2.p1.7.m2.1.1">𝑥</ci><ci id="S4.SS2.p1.7.m2.2.2.cmml" xref="S4.SS2.p1.7.m2.2.2">𝑧</ci></list></apply></apply></apply><apply id="S4.SS2.p1.7.m2.9.9.6.cmml" xref="S4.SS2.p1.7.m2.9.9.6"><minus id="S4.SS2.p1.7.m2.9.9.6.1.cmml" xref="S4.SS2.p1.7.m2.9.9.6.1"></minus><cn id="S4.SS2.p1.7.m2.9.9.6.2.cmml" type="integer" xref="S4.SS2.p1.7.m2.9.9.6.2">1</cn><apply id="S4.SS2.p1.7.m2.9.9.6.3.cmml" xref="S4.SS2.p1.7.m2.9.9.6.3"><times id="S4.SS2.p1.7.m2.9.9.6.3.1.cmml" xref="S4.SS2.p1.7.m2.9.9.6.3.1"></times><apply id="S4.SS2.p1.7.m2.9.9.6.3.2.cmml" xref="S4.SS2.p1.7.m2.9.9.6.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m2.9.9.6.3.2.1.cmml" xref="S4.SS2.p1.7.m2.9.9.6.3.2">subscript</csymbol><ci id="S4.SS2.p1.7.m2.9.9.6.3.2.2.cmml" xref="S4.SS2.p1.7.m2.9.9.6.3.2.2">𝜋</ci><ci id="S4.SS2.p1.7.m2.9.9.6.3.2.3.cmml" xref="S4.SS2.p1.7.m2.9.9.6.3.2.3">𝜃</ci></apply><interval closure="open" id="S4.SS2.p1.7.m2.9.9.6.3.3.1.cmml" xref="S4.SS2.p1.7.m2.9.9.6.3.3.2"><ci id="S4.SS2.p1.7.m2.3.3.cmml" xref="S4.SS2.p1.7.m2.3.3">𝑥</ci><ci id="S4.SS2.p1.7.m2.4.4.cmml" xref="S4.SS2.p1.7.m2.4.4">𝑧</ci></interval></apply></apply></apply><apply id="S4.SS2.p1.7.m2.9.9c.cmml" xref="S4.SS2.p1.7.m2.9.9"><eq id="S4.SS2.p1.7.m2.9.9.7.cmml" xref="S4.SS2.p1.7.m2.9.9.7"></eq><share href="https://arxiv.org/html/2406.14169v1#S4.SS2.p1.7.m2.9.9.6.cmml" id="S4.SS2.p1.7.m2.9.9d.cmml" xref="S4.SS2.p1.7.m2.9.9"></share><apply id="S4.SS2.p1.7.m2.9.9.3.cmml" xref="S4.SS2.p1.7.m2.9.9.3"><minus id="S4.SS2.p1.7.m2.9.9.3.3.cmml" xref="S4.SS2.p1.7.m2.9.9.3.3"></minus><cn id="S4.SS2.p1.7.m2.9.9.3.4.cmml" type="integer" xref="S4.SS2.p1.7.m2.9.9.3.4">1</cn><apply id="S4.SS2.p1.7.m2.9.9.3.2.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2"><times id="S4.SS2.p1.7.m2.9.9.3.2.3.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.3"></times><apply id="S4.SS2.p1.7.m2.9.9.3.2.4.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.4"><apply id="S4.SS2.p1.7.m2.9.9.3.2.4.1.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.4.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m2.9.9.3.2.4.1.1.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.4.1">subscript</csymbol><ci id="S4.SS2.p1.7.m2.9.9.3.2.4.1.2.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.4.1.2">softmax</ci><ci id="S4.SS2.p1.7.m2.9.9.3.2.4.1.3.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.4.1.3">𝑍</ci></apply><ci id="S4.SS2.p1.7.m2.9.9.3.2.4.2a.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.4.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.p1.7.m2.9.9.3.2.4.2.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.4.2">sim</mtext></ci></apply><interval closure="open" id="S4.SS2.p1.7.m2.9.9.3.2.2.3.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2"><apply id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.cmml" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1"><times id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.1"></times><apply id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.cmml" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.2">𝑓</ci><ci id="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.7.m2.8.8.2.1.1.1.1.2.3">𝜃</ci></apply><ci id="S4.SS2.p1.7.m2.5.5.cmml" xref="S4.SS2.p1.7.m2.5.5">𝑥</ci></apply><apply id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2"><times id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.1.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.1"></times><apply id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.2">𝑓</ci><ci id="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.7.m2.9.9.3.2.2.2.2.2.3">𝜃</ci></apply><ci id="S4.SS2.p1.7.m2.6.6.cmml" xref="S4.SS2.p1.7.m2.6.6">𝑧</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m2.9c">\pi^{\prime}_{\theta}(a=0|x,z)=1-\pi_{\theta}(x,z)=1-\operatorname{softmax}_{Z%
}\texttt{sim}(f_{\theta}(x),f_{\theta}(z))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m2.9d">italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a = 0 | italic_x , italic_z ) = 1 - italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_z ) = 1 - roman_softmax start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT sim ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_z ) )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">With this formulation, the number of states increases to <math alttext="SA" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">S</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></times><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑆</ci><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">SA</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_S italic_A</annotation></semantics></math> but the number of actions reduces to 2. As we show below, the convergence rate is significantly faster since the error now grows linearly with A rather than quadratic.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S4.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Proposition 0.</h6>
<div class="ltx_para" id="S4.Thmtheorem1.p1">
<p class="ltx_p" id="S4.Thmtheorem1.p1.1"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.1.1">With the new formulation, under the assumptions of Proposition 1, for all <math alttext="t\geq 1" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.1.1.m1.1"><semantics id="S4.Thmtheorem1.p1.1.1.m1.1a"><mrow id="S4.Thmtheorem1.p1.1.1.m1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1.2" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.2.cmml">t</mi><mo id="S4.Thmtheorem1.p1.1.1.m1.1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1.cmml">≥</mo><mn id="S4.Thmtheorem1.p1.1.1.m1.1.1.3" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.1.1.m1.1b"><apply id="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1"><geq id="S4.Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.1"></geq><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.2">𝑡</ci><cn id="S4.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.1.1.m1.1c">t\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.1.1.m1.1d">italic_t ≥ 1</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}_{x\sim\mathcal{D}}(\mathbf{\pi}^{*}(x)-\mathbf{\pi}_{\theta_{t}}(x)%
)^{T}\mathbf{r}(x)\leq\frac{64SA\rho^{2}}{t}\left\lVert\frac{1}{\mu}\right%
\rVert_{\infty}" class="ltx_Math" display="block" id="S4.E9.m1.5"><semantics id="S4.E9.m1.5a"><mrow id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml"><mrow id="S4.E9.m1.5.5.1" xref="S4.E9.m1.5.5.1.cmml"><msub id="S4.E9.m1.5.5.1.3" xref="S4.E9.m1.5.5.1.3.cmml"><mi id="S4.E9.m1.5.5.1.3.2" xref="S4.E9.m1.5.5.1.3.2.cmml">𝐄</mi><mrow id="S4.E9.m1.5.5.1.3.3" xref="S4.E9.m1.5.5.1.3.3.cmml"><mi id="S4.E9.m1.5.5.1.3.3.2" xref="S4.E9.m1.5.5.1.3.3.2.cmml">x</mi><mo id="S4.E9.m1.5.5.1.3.3.1" xref="S4.E9.m1.5.5.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.5.5.1.3.3.3" xref="S4.E9.m1.5.5.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="S4.E9.m1.5.5.1.2" xref="S4.E9.m1.5.5.1.2.cmml">⁢</mo><msup id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1.cmml"><mrow id="S4.E9.m1.5.5.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml"><mo id="S4.E9.m1.5.5.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.5.5.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.5.5.1.1.1.1.1.2" xref="S4.E9.m1.5.5.1.1.1.1.1.2.cmml"><msup id="S4.E9.m1.5.5.1.1.1.1.1.2.2" xref="S4.E9.m1.5.5.1.1.1.1.1.2.2.cmml"><mi id="S4.E9.m1.5.5.1.1.1.1.1.2.2.2" xref="S4.E9.m1.5.5.1.1.1.1.1.2.2.2.cmml">π</mi><mo id="S4.E9.m1.5.5.1.1.1.1.1.2.2.3" xref="S4.E9.m1.5.5.1.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="S4.E9.m1.5.5.1.1.1.1.1.2.1" xref="S4.E9.m1.5.5.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E9.m1.5.5.1.1.1.1.1.2.3.2" xref="S4.E9.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.5.5.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">x</mi><mo id="S4.E9.m1.5.5.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.5.5.1.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E9.m1.5.5.1.1.1.1.1.3" xref="S4.E9.m1.5.5.1.1.1.1.1.3.cmml"><msub id="S4.E9.m1.5.5.1.1.1.1.1.3.2" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.cmml"><mi id="S4.E9.m1.5.5.1.1.1.1.1.3.2.2" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.2.cmml">π</mi><msub id="S4.E9.m1.5.5.1.1.1.1.1.3.2.3" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.2" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.3" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.3.cmml">t</mi></msub></msub><mo id="S4.E9.m1.5.5.1.1.1.1.1.3.1" xref="S4.E9.m1.5.5.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E9.m1.5.5.1.1.1.1.1.3.3.2" xref="S4.E9.m1.5.5.1.1.1.1.1.3.cmml"><mo id="S4.E9.m1.5.5.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml">x</mi><mo id="S4.E9.m1.5.5.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.5.5.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow><mi id="S4.E9.m1.5.5.1.1.3" xref="S4.E9.m1.5.5.1.1.3.cmml">T</mi></msup><mo id="S4.E9.m1.5.5.1.2a" xref="S4.E9.m1.5.5.1.2.cmml">⁢</mo><mi id="S4.E9.m1.5.5.1.4" xref="S4.E9.m1.5.5.1.4.cmml">𝐫</mi><mo id="S4.E9.m1.5.5.1.2b" xref="S4.E9.m1.5.5.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.5.5.1.5.2" xref="S4.E9.m1.5.5.1.cmml"><mo id="S4.E9.m1.5.5.1.5.2.1" stretchy="false" xref="S4.E9.m1.5.5.1.cmml">(</mo><mi id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml">x</mi><mo id="S4.E9.m1.5.5.1.5.2.2" stretchy="false" xref="S4.E9.m1.5.5.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.5.5.2" xref="S4.E9.m1.5.5.2.cmml">≤</mo><mrow id="S4.E9.m1.5.5.3" xref="S4.E9.m1.5.5.3.cmml"><mfrac id="S4.E9.m1.5.5.3.2" xref="S4.E9.m1.5.5.3.2.cmml"><mrow id="S4.E9.m1.5.5.3.2.2" xref="S4.E9.m1.5.5.3.2.2.cmml"><mn id="S4.E9.m1.5.5.3.2.2.2" xref="S4.E9.m1.5.5.3.2.2.2.cmml">64</mn><mo id="S4.E9.m1.5.5.3.2.2.1" xref="S4.E9.m1.5.5.3.2.2.1.cmml">⁢</mo><mi id="S4.E9.m1.5.5.3.2.2.3" xref="S4.E9.m1.5.5.3.2.2.3.cmml">S</mi><mo id="S4.E9.m1.5.5.3.2.2.1a" xref="S4.E9.m1.5.5.3.2.2.1.cmml">⁢</mo><mi id="S4.E9.m1.5.5.3.2.2.4" xref="S4.E9.m1.5.5.3.2.2.4.cmml">A</mi><mo id="S4.E9.m1.5.5.3.2.2.1b" xref="S4.E9.m1.5.5.3.2.2.1.cmml">⁢</mo><msup id="S4.E9.m1.5.5.3.2.2.5" xref="S4.E9.m1.5.5.3.2.2.5.cmml"><mi id="S4.E9.m1.5.5.3.2.2.5.2" xref="S4.E9.m1.5.5.3.2.2.5.2.cmml">ρ</mi><mn id="S4.E9.m1.5.5.3.2.2.5.3" xref="S4.E9.m1.5.5.3.2.2.5.3.cmml">2</mn></msup></mrow><mi id="S4.E9.m1.5.5.3.2.3" xref="S4.E9.m1.5.5.3.2.3.cmml">t</mi></mfrac><mo id="S4.E9.m1.5.5.3.1" lspace="0em" xref="S4.E9.m1.5.5.3.1.cmml">⁢</mo><msub id="S4.E9.m1.5.5.3.3" xref="S4.E9.m1.5.5.3.3.cmml"><mrow id="S4.E9.m1.5.5.3.3.2.2" xref="S4.E9.m1.5.5.3.3.2.1.cmml"><mo fence="true" id="S4.E9.m1.5.5.3.3.2.2.1" rspace="0em" stretchy="true" xref="S4.E9.m1.5.5.3.3.2.1.1.cmml">∥</mo><mfrac id="S4.E9.m1.4.4" xref="S4.E9.m1.4.4.cmml"><mn id="S4.E9.m1.4.4.2" xref="S4.E9.m1.4.4.2.cmml">1</mn><mi id="S4.E9.m1.4.4.3" xref="S4.E9.m1.4.4.3.cmml">μ</mi></mfrac><mo fence="true" id="S4.E9.m1.5.5.3.3.2.2.2" lspace="0em" stretchy="true" xref="S4.E9.m1.5.5.3.3.2.1.1.cmml">∥</mo></mrow><mi id="S4.E9.m1.5.5.3.3.3" mathvariant="normal" xref="S4.E9.m1.5.5.3.3.3.cmml">∞</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.5b"><apply id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5"><leq id="S4.E9.m1.5.5.2.cmml" xref="S4.E9.m1.5.5.2"></leq><apply id="S4.E9.m1.5.5.1.cmml" xref="S4.E9.m1.5.5.1"><times id="S4.E9.m1.5.5.1.2.cmml" xref="S4.E9.m1.5.5.1.2"></times><apply id="S4.E9.m1.5.5.1.3.cmml" xref="S4.E9.m1.5.5.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.3.1.cmml" xref="S4.E9.m1.5.5.1.3">subscript</csymbol><ci id="S4.E9.m1.5.5.1.3.2.cmml" xref="S4.E9.m1.5.5.1.3.2">𝐄</ci><apply id="S4.E9.m1.5.5.1.3.3.cmml" xref="S4.E9.m1.5.5.1.3.3"><csymbol cd="latexml" id="S4.E9.m1.5.5.1.3.3.1.cmml" xref="S4.E9.m1.5.5.1.3.3.1">similar-to</csymbol><ci id="S4.E9.m1.5.5.1.3.3.2.cmml" xref="S4.E9.m1.5.5.1.3.3.2">𝑥</ci><ci id="S4.E9.m1.5.5.1.3.3.3.cmml" xref="S4.E9.m1.5.5.1.3.3.3">𝒟</ci></apply></apply><apply id="S4.E9.m1.5.5.1.1.cmml" xref="S4.E9.m1.5.5.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1">superscript</csymbol><apply id="S4.E9.m1.5.5.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1"><minus id="S4.E9.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1"></minus><apply id="S4.E9.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2"><times id="S4.E9.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2.1"></times><apply id="S4.E9.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E9.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2.2.2">𝜋</ci><times id="S4.E9.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.2.2.3"></times></apply><ci id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1">𝑥</ci></apply><apply id="S4.E9.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3"><times id="S4.E9.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.1"></times><apply id="S4.E9.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.5.5.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.2">𝜋</ci><apply id="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><ci id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2">𝑥</ci></apply></apply><ci id="S4.E9.m1.5.5.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.3">𝑇</ci></apply><ci id="S4.E9.m1.5.5.1.4.cmml" xref="S4.E9.m1.5.5.1.4">𝐫</ci><ci id="S4.E9.m1.3.3.cmml" xref="S4.E9.m1.3.3">𝑥</ci></apply><apply id="S4.E9.m1.5.5.3.cmml" xref="S4.E9.m1.5.5.3"><times id="S4.E9.m1.5.5.3.1.cmml" xref="S4.E9.m1.5.5.3.1"></times><apply id="S4.E9.m1.5.5.3.2.cmml" xref="S4.E9.m1.5.5.3.2"><divide id="S4.E9.m1.5.5.3.2.1.cmml" xref="S4.E9.m1.5.5.3.2"></divide><apply id="S4.E9.m1.5.5.3.2.2.cmml" xref="S4.E9.m1.5.5.3.2.2"><times id="S4.E9.m1.5.5.3.2.2.1.cmml" xref="S4.E9.m1.5.5.3.2.2.1"></times><cn id="S4.E9.m1.5.5.3.2.2.2.cmml" type="integer" xref="S4.E9.m1.5.5.3.2.2.2">64</cn><ci id="S4.E9.m1.5.5.3.2.2.3.cmml" xref="S4.E9.m1.5.5.3.2.2.3">𝑆</ci><ci id="S4.E9.m1.5.5.3.2.2.4.cmml" xref="S4.E9.m1.5.5.3.2.2.4">𝐴</ci><apply id="S4.E9.m1.5.5.3.2.2.5.cmml" xref="S4.E9.m1.5.5.3.2.2.5"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.3.2.2.5.1.cmml" xref="S4.E9.m1.5.5.3.2.2.5">superscript</csymbol><ci id="S4.E9.m1.5.5.3.2.2.5.2.cmml" xref="S4.E9.m1.5.5.3.2.2.5.2">𝜌</ci><cn id="S4.E9.m1.5.5.3.2.2.5.3.cmml" type="integer" xref="S4.E9.m1.5.5.3.2.2.5.3">2</cn></apply></apply><ci id="S4.E9.m1.5.5.3.2.3.cmml" xref="S4.E9.m1.5.5.3.2.3">𝑡</ci></apply><apply id="S4.E9.m1.5.5.3.3.cmml" xref="S4.E9.m1.5.5.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.3.3.1.cmml" xref="S4.E9.m1.5.5.3.3">subscript</csymbol><apply id="S4.E9.m1.5.5.3.3.2.1.cmml" xref="S4.E9.m1.5.5.3.3.2.2"><csymbol cd="latexml" id="S4.E9.m1.5.5.3.3.2.1.1.cmml" xref="S4.E9.m1.5.5.3.3.2.2.1">delimited-∥∥</csymbol><apply id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4"><divide id="S4.E9.m1.4.4.1.cmml" xref="S4.E9.m1.4.4"></divide><cn id="S4.E9.m1.4.4.2.cmml" type="integer" xref="S4.E9.m1.4.4.2">1</cn><ci id="S4.E9.m1.4.4.3.cmml" xref="S4.E9.m1.4.4.3">𝜇</ci></apply></apply><infinity id="S4.E9.m1.5.5.3.3.3.cmml" xref="S4.E9.m1.5.5.3.3.3"></infinity></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.5c">\mathbf{E}_{x\sim\mathcal{D}}(\mathbf{\pi}^{*}(x)-\mathbf{\pi}_{\theta_{t}}(x)%
)^{T}\mathbf{r}(x)\leq\frac{64SA\rho^{2}}{t}\left\lVert\frac{1}{\mu}\right%
\rVert_{\infty}</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.5d">bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT ( italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x ) - italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_x ) ≤ divide start_ARG 64 italic_S italic_A italic_ρ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t end_ARG ∥ divide start_ARG 1 end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.6">Note that in practice, <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_ρ</annotation></semantics></math> may be higher for the binary action formulation since there are only 2 actions. Assuming a “good enough” supervised policy, conservative value for <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_ρ</annotation></semantics></math> may be <math alttext="\sim 50" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml"></mi><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">∼</mo><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">absent</csymbol><cn id="S4.SS2.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\sim 50</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">∼ 50</annotation></semantics></math>, implying that probability of the optimal action under supervised policy is always <math alttext="\geq 1/(2\times 50)=0.01" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml"></mi><mo id="S4.SS2.p3.4.m4.1.1.4" xref="S4.SS2.p3.4.m4.1.1.4.cmml">≥</mo><mrow id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml"><mn id="S4.SS2.p3.4.m4.1.1.1.3" xref="S4.SS2.p3.4.m4.1.1.1.3.cmml">1</mn><mo id="S4.SS2.p3.4.m4.1.1.1.2" xref="S4.SS2.p3.4.m4.1.1.1.2.cmml">/</mo><mrow id="S4.SS2.p3.4.m4.1.1.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p3.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p3.4.m4.1.1.1.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml"><mn id="S4.SS2.p3.4.m4.1.1.1.1.1.1.2" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml">2</mn><mo id="S4.SS2.p3.4.m4.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml">×</mo><mn id="S4.SS2.p3.4.m4.1.1.1.1.1.1.3" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml">50</mn></mrow><mo id="S4.SS2.p3.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p3.4.m4.1.1.5" xref="S4.SS2.p3.4.m4.1.1.5.cmml">=</mo><mn id="S4.SS2.p3.4.m4.1.1.6" xref="S4.SS2.p3.4.m4.1.1.6.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><and id="S4.SS2.p3.4.m4.1.1a.cmml" xref="S4.SS2.p3.4.m4.1.1"></and><apply id="S4.SS2.p3.4.m4.1.1b.cmml" xref="S4.SS2.p3.4.m4.1.1"><geq id="S4.SS2.p3.4.m4.1.1.4.cmml" xref="S4.SS2.p3.4.m4.1.1.4"></geq><csymbol cd="latexml" id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">absent</csymbol><apply id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"><divide id="S4.SS2.p3.4.m4.1.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.1.2"></divide><cn id="S4.SS2.p3.4.m4.1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.4.m4.1.1.1.3">1</cn><apply id="S4.SS2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1.1.1"><times id="S4.SS2.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.1"></times><cn id="S4.SS2.p3.4.m4.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.2">2</cn><cn id="S4.SS2.p3.4.m4.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.4.m4.1.1.1.1.1.1.3">50</cn></apply></apply></apply><apply id="S4.SS2.p3.4.m4.1.1c.cmml" xref="S4.SS2.p3.4.m4.1.1"><eq id="S4.SS2.p3.4.m4.1.1.5.cmml" xref="S4.SS2.p3.4.m4.1.1.5"></eq><share href="https://arxiv.org/html/2406.14169v1#S4.SS2.p3.4.m4.1.1.1.cmml" id="S4.SS2.p3.4.m4.1.1d.cmml" xref="S4.SS2.p3.4.m4.1.1"></share><cn id="S4.SS2.p3.4.m4.1.1.6.cmml" type="float" xref="S4.SS2.p3.4.m4.1.1.6">0.01</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\geq 1/(2\times 50)=0.01</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">≥ 1 / ( 2 × 50 ) = 0.01</annotation></semantics></math>. Even under this conservative estimate, as long as the number of actions is of the order of millions, <math alttext="\rho^{2}&lt;&lt;A" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1"><semantics id="S4.SS2.p3.5.m5.1a"><mrow id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><msup id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2.2" xref="S4.SS2.p3.5.m5.1.1.2.2.cmml">ρ</mi><mn id="S4.SS2.p3.5.m5.1.1.2.3" xref="S4.SS2.p3.5.m5.1.1.2.3.cmml">2</mn></msup><mo id="S4.SS2.p3.5.m5.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.cmml">&lt;&lt;</mo><mi id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><csymbol cd="latexml" id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1">much-less-than</csymbol><apply id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.2.1.cmml" xref="S4.SS2.p3.5.m5.1.1.2">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.2.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2.2">𝜌</ci><cn id="S4.SS2.p3.5.m5.1.1.2.3.cmml" type="integer" xref="S4.SS2.p3.5.m5.1.1.2.3">2</cn></apply><ci id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">\rho^{2}&lt;&lt;A</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.1d">italic_ρ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT &lt; &lt; italic_A</annotation></semantics></math> and hence the convergence rate in Proposition 2 would be significantly faster.
In other words, as long as <math alttext="\rho^{2}&lt;&lt;A" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.1"><semantics id="S4.SS2.p3.6.m6.1a"><mrow id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml"><msup id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml"><mi id="S4.SS2.p3.6.m6.1.1.2.2" xref="S4.SS2.p3.6.m6.1.1.2.2.cmml">ρ</mi><mn id="S4.SS2.p3.6.m6.1.1.2.3" xref="S4.SS2.p3.6.m6.1.1.2.3.cmml">2</mn></msup><mo id="S4.SS2.p3.6.m6.1.1.1" xref="S4.SS2.p3.6.m6.1.1.1.cmml">&lt;&lt;</mo><mi id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1"><csymbol cd="latexml" id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1">much-less-than</csymbol><apply id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.1.1.2.1.cmml" xref="S4.SS2.p3.6.m6.1.1.2">superscript</csymbol><ci id="S4.SS2.p3.6.m6.1.1.2.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2.2">𝜌</ci><cn id="S4.SS2.p3.6.m6.1.1.2.3.cmml" type="integer" xref="S4.SS2.p3.6.m6.1.1.2.3">2</cn></apply><ci id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">\rho^{2}&lt;&lt;A</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.1d">italic_ρ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT &lt; &lt; italic_A</annotation></semantics></math>, the binary-action
policy gradient algorithm will converge at a faster rate.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.3">For maximizing a reward based on novelty and relevance such as Eqn. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.E6" title="In 4.1. Reduction from Top-k to item-wise rewards ‣ 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">6</span></a>, the <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_ρ</annotation></semantics></math> parameter in Proposition <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.Thmtheorem1" title="Proposition 0. ‣ 4.2. Reduction to binary action space ‣ 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a> also implies that using the base policy as the initial policy may not be the best choice. The base policy is expected to be significantly better than a random policy at relevance, so it will assign higher than random probability to relevant items—both novel and not novel items. However, within relevant items, by definition, its probability for novel items will be lower than that of the not novel items. To increase the probability of the optimal action under the initial policy even further (and decrease <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_ρ</annotation></semantics></math>), we can use additional training data to finetune the base policy using supervised learning (e.g., InfoNCE loss from Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Ex1" title="3.1. Problem statement: Novelty optimization ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a>). We call this model the <span class="ltx_text ltx_font_italic" id="S4.SS2.p4.3.1">Supervised Model</span>. As long as the relevance accuracy does not decrease, randomness in the training procedure should shift the order of top-k items under the supervised model. As a result, the supervised model may retain the property of being better than a random policy at relevance (just like the base policy) but may also yield higher probability to some novel items under the base policy. Therefore, whenever additional training data is available, such a supervised model is expected to have a lower <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mi id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><ci id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">italic_ρ</annotation></semantics></math> and we recommend to use it as the initial policy.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Proposed algorithm: PG-Ret</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">The above discussion indicates the following conditions for a fast convergence rate with policy gradient, <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">1)</span> the action space should be small; and <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.2">2)</span> the initial policy should be as close to the optimal as possible. We addressed the first condition through a binary-action formulation of the problem. For the second condition, we proposed initializing the policy optimization with a policy trained using supervised learning (i.e., using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Ex1" title="3.1. Problem statement: Novelty optimization ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.3">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#alg1" title="Algorithm 1 ‣ 4.3. Proposed algorithm: PG-Ret ‣ 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a> shows the resultant training algorithm. In each batch, <math alttext="B" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_B</annotation></semantics></math> query-item pairs (states) are sampled and the reward is computed for each state. Using Eqn. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.E8" title="In 4.2. Reduction to binary action space ‣ 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">8</span></a>, we compute the gradient and update the policy parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_θ</annotation></semantics></math> at the end of the batch. For each application, one needs to specify the sampling procedure for query-item pairs, the reward function, and the estimation procedure for <math alttext="\pi^{\prime}(a|x,z)" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.3"><semantics id="S4.SS3.p2.3.m3.3a"><mrow id="S4.SS3.p2.3.m3.3.3" xref="S4.SS3.p2.3.m3.3.3.cmml"><msup id="S4.SS3.p2.3.m3.3.3.3" xref="S4.SS3.p2.3.m3.3.3.3.cmml"><mi id="S4.SS3.p2.3.m3.3.3.3.2" xref="S4.SS3.p2.3.m3.3.3.3.2.cmml">π</mi><mo id="S4.SS3.p2.3.m3.3.3.3.3" xref="S4.SS3.p2.3.m3.3.3.3.3.cmml">′</mo></msup><mo id="S4.SS3.p2.3.m3.3.3.2" xref="S4.SS3.p2.3.m3.3.3.2.cmml">⁢</mo><mrow id="S4.SS3.p2.3.m3.3.3.1.1" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml"><mo id="S4.SS3.p2.3.m3.3.3.1.1.2" stretchy="false" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.3.m3.3.3.1.1.1" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml"><mi id="S4.SS3.p2.3.m3.3.3.1.1.1.2" xref="S4.SS3.p2.3.m3.3.3.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.SS3.p2.3.m3.3.3.1.1.1.1" xref="S4.SS3.p2.3.m3.3.3.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p2.3.m3.3.3.1.1.1.3.2" xref="S4.SS3.p2.3.m3.3.3.1.1.1.3.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">x</mi><mo id="S4.SS3.p2.3.m3.3.3.1.1.1.3.2.1" xref="S4.SS3.p2.3.m3.3.3.1.1.1.3.1.cmml">,</mo><mi id="S4.SS3.p2.3.m3.2.2" xref="S4.SS3.p2.3.m3.2.2.cmml">z</mi></mrow></mrow><mo id="S4.SS3.p2.3.m3.3.3.1.1.3" stretchy="false" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.3b"><apply id="S4.SS3.p2.3.m3.3.3.cmml" xref="S4.SS3.p2.3.m3.3.3"><times id="S4.SS3.p2.3.m3.3.3.2.cmml" xref="S4.SS3.p2.3.m3.3.3.2"></times><apply id="S4.SS3.p2.3.m3.3.3.3.cmml" xref="S4.SS3.p2.3.m3.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.3.3.3.1.cmml" xref="S4.SS3.p2.3.m3.3.3.3">superscript</csymbol><ci id="S4.SS3.p2.3.m3.3.3.3.2.cmml" xref="S4.SS3.p2.3.m3.3.3.3.2">𝜋</ci><ci id="S4.SS3.p2.3.m3.3.3.3.3.cmml" xref="S4.SS3.p2.3.m3.3.3.3.3">′</ci></apply><apply id="S4.SS3.p2.3.m3.3.3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1"><csymbol cd="latexml" id="S4.SS3.p2.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS3.p2.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1.1.2">𝑎</ci><list id="S4.SS3.p2.3.m3.3.3.1.1.1.3.1.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1.1.3.2"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝑥</ci><ci id="S4.SS3.p2.3.m3.2.2.cmml" xref="S4.SS3.p2.3.m3.2.2">𝑧</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.3c">\pi^{\prime}(a|x,z)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.3d">italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_a | italic_x , italic_z )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.11"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.11.1">Sampling query-item states.</span> Since items are also a part of the state in our proposed formulation, a key question is how to sample the states <math alttext="\langle x,z\rangle" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.2"><semantics id="S4.SS3.p3.1.m1.2a"><mrow id="S4.SS3.p3.1.m1.2.3.2" xref="S4.SS3.p3.1.m1.2.3.1.cmml"><mo id="S4.SS3.p3.1.m1.2.3.2.1" stretchy="false" xref="S4.SS3.p3.1.m1.2.3.1.cmml">⟨</mo><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">x</mi><mo id="S4.SS3.p3.1.m1.2.3.2.2" xref="S4.SS3.p3.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS3.p3.1.m1.2.2" xref="S4.SS3.p3.1.m1.2.2.cmml">z</mi><mo id="S4.SS3.p3.1.m1.2.3.2.3" stretchy="false" xref="S4.SS3.p3.1.m1.2.3.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.2b"><list id="S4.SS3.p3.1.m1.2.3.1.cmml" xref="S4.SS3.p3.1.m1.2.3.2"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑥</ci><ci id="S4.SS3.p3.1.m1.2.2.cmml" xref="S4.SS3.p3.1.m1.2.2">𝑧</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.2c">\langle x,z\rangle</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.2d">⟨ italic_x , italic_z ⟩</annotation></semantics></math>. To map to the original policy gradient formulation, we can sample queries <math alttext="x" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_x</annotation></semantics></math> randomly from the train dataset for each batch. For each query, we compute the similarity scores with all items using the encoder <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><msub id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">f</mi><mi id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝑓</ci><ci id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> corresponding to the current policy and then sample items proportional to their score. Note that we are not restricted to only sampling items proportional to their similarity score (since items are not actions now). Therefore, we also add exploration by sampling items from another retrieval model (trained independently). For example, for novelty, a natural choice is to sample from predictions of the base model, restricting the sampling only to items that are ranked beyond top-L. Such items will be novel by definition and thus we only need to check for relevance. More generally, we may use any pretrained encoder suitable for the task. Finally, there is a risk that the policy overfits to the reward from the relevance oracle and “forgets” the true user feedback data on which the supervised policy was trained <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib27" title="">2022</a>)</cite>. Thus, we should also add the user feedback data <math alttext="(x,z)\in{D}" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.2"><semantics id="S4.SS3.p3.4.m4.2a"><mrow id="S4.SS3.p3.4.m4.2.3" xref="S4.SS3.p3.4.m4.2.3.cmml"><mrow id="S4.SS3.p3.4.m4.2.3.2.2" xref="S4.SS3.p3.4.m4.2.3.2.1.cmml"><mo id="S4.SS3.p3.4.m4.2.3.2.2.1" stretchy="false" xref="S4.SS3.p3.4.m4.2.3.2.1.cmml">(</mo><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">x</mi><mo id="S4.SS3.p3.4.m4.2.3.2.2.2" xref="S4.SS3.p3.4.m4.2.3.2.1.cmml">,</mo><mi id="S4.SS3.p3.4.m4.2.2" xref="S4.SS3.p3.4.m4.2.2.cmml">z</mi><mo id="S4.SS3.p3.4.m4.2.3.2.2.3" stretchy="false" xref="S4.SS3.p3.4.m4.2.3.2.1.cmml">)</mo></mrow><mo id="S4.SS3.p3.4.m4.2.3.1" xref="S4.SS3.p3.4.m4.2.3.1.cmml">∈</mo><mi id="S4.SS3.p3.4.m4.2.3.3" xref="S4.SS3.p3.4.m4.2.3.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.2b"><apply id="S4.SS3.p3.4.m4.2.3.cmml" xref="S4.SS3.p3.4.m4.2.3"><in id="S4.SS3.p3.4.m4.2.3.1.cmml" xref="S4.SS3.p3.4.m4.2.3.1"></in><interval closure="open" id="S4.SS3.p3.4.m4.2.3.2.1.cmml" xref="S4.SS3.p3.4.m4.2.3.2.2"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑥</ci><ci id="S4.SS3.p3.4.m4.2.2.cmml" xref="S4.SS3.p3.4.m4.2.2">𝑧</ci></interval><ci id="S4.SS3.p3.4.m4.2.3.3.cmml" xref="S4.SS3.p3.4.m4.2.3.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.2c">(x,z)\in{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.2d">( italic_x , italic_z ) ∈ italic_D</annotation></semantics></math> during training. To this end, in practice, all three sources are combined stochastically: we sample a query <math alttext="x" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><mi id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><ci id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">italic_x</annotation></semantics></math> randomly from the dataset and then sample either <math alttext="z\sim\pi_{{\theta}_{t}}(x)" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><mrow id="S4.SS3.p3.6.m6.1.2" xref="S4.SS3.p3.6.m6.1.2.cmml"><mi id="S4.SS3.p3.6.m6.1.2.2" xref="S4.SS3.p3.6.m6.1.2.2.cmml">z</mi><mo id="S4.SS3.p3.6.m6.1.2.1" xref="S4.SS3.p3.6.m6.1.2.1.cmml">∼</mo><mrow id="S4.SS3.p3.6.m6.1.2.3" xref="S4.SS3.p3.6.m6.1.2.3.cmml"><msub id="S4.SS3.p3.6.m6.1.2.3.2" xref="S4.SS3.p3.6.m6.1.2.3.2.cmml"><mi id="S4.SS3.p3.6.m6.1.2.3.2.2" xref="S4.SS3.p3.6.m6.1.2.3.2.2.cmml">π</mi><msub id="S4.SS3.p3.6.m6.1.2.3.2.3" xref="S4.SS3.p3.6.m6.1.2.3.2.3.cmml"><mi id="S4.SS3.p3.6.m6.1.2.3.2.3.2" xref="S4.SS3.p3.6.m6.1.2.3.2.3.2.cmml">θ</mi><mi id="S4.SS3.p3.6.m6.1.2.3.2.3.3" xref="S4.SS3.p3.6.m6.1.2.3.2.3.3.cmml">t</mi></msub></msub><mo id="S4.SS3.p3.6.m6.1.2.3.1" xref="S4.SS3.p3.6.m6.1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p3.6.m6.1.2.3.3.2" xref="S4.SS3.p3.6.m6.1.2.3.cmml"><mo id="S4.SS3.p3.6.m6.1.2.3.3.2.1" stretchy="false" xref="S4.SS3.p3.6.m6.1.2.3.cmml">(</mo><mi id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml">x</mi><mo id="S4.SS3.p3.6.m6.1.2.3.3.2.2" stretchy="false" xref="S4.SS3.p3.6.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.2.cmml" xref="S4.SS3.p3.6.m6.1.2"><csymbol cd="latexml" id="S4.SS3.p3.6.m6.1.2.1.cmml" xref="S4.SS3.p3.6.m6.1.2.1">similar-to</csymbol><ci id="S4.SS3.p3.6.m6.1.2.2.cmml" xref="S4.SS3.p3.6.m6.1.2.2">𝑧</ci><apply id="S4.SS3.p3.6.m6.1.2.3.cmml" xref="S4.SS3.p3.6.m6.1.2.3"><times id="S4.SS3.p3.6.m6.1.2.3.1.cmml" xref="S4.SS3.p3.6.m6.1.2.3.1"></times><apply id="S4.SS3.p3.6.m6.1.2.3.2.cmml" xref="S4.SS3.p3.6.m6.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.2.3.2.1.cmml" xref="S4.SS3.p3.6.m6.1.2.3.2">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.2.3.2.2.cmml" xref="S4.SS3.p3.6.m6.1.2.3.2.2">𝜋</ci><apply id="S4.SS3.p3.6.m6.1.2.3.2.3.cmml" xref="S4.SS3.p3.6.m6.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.2.3.2.3.1.cmml" xref="S4.SS3.p3.6.m6.1.2.3.2.3">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.2.3.2.3.2.cmml" xref="S4.SS3.p3.6.m6.1.2.3.2.3.2">𝜃</ci><ci id="S4.SS3.p3.6.m6.1.2.3.2.3.3.cmml" xref="S4.SS3.p3.6.m6.1.2.3.2.3.3">𝑡</ci></apply></apply><ci id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">z\sim\pi_{{\theta}_{t}}(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">italic_z ∼ italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> with probability <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1"><semantics id="S4.SS3.p3.7.m7.1a"><mi id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><ci id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">italic_α</annotation></semantics></math>; <math alttext="z\sim\pi_{{\theta}explore_{t}}(x)" class="ltx_Math" display="inline" id="S4.SS3.p3.8.m8.1"><semantics id="S4.SS3.p3.8.m8.1a"><mrow id="S4.SS3.p3.8.m8.1.2" xref="S4.SS3.p3.8.m8.1.2.cmml"><mi id="S4.SS3.p3.8.m8.1.2.2" xref="S4.SS3.p3.8.m8.1.2.2.cmml">z</mi><mo id="S4.SS3.p3.8.m8.1.2.1" xref="S4.SS3.p3.8.m8.1.2.1.cmml">∼</mo><mrow id="S4.SS3.p3.8.m8.1.2.3" xref="S4.SS3.p3.8.m8.1.2.3.cmml"><msub id="S4.SS3.p3.8.m8.1.2.3.2" xref="S4.SS3.p3.8.m8.1.2.3.2.cmml"><mi id="S4.SS3.p3.8.m8.1.2.3.2.2" xref="S4.SS3.p3.8.m8.1.2.3.2.2.cmml">π</mi><mrow id="S4.SS3.p3.8.m8.1.2.3.2.3" xref="S4.SS3.p3.8.m8.1.2.3.2.3.cmml"><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.2" xref="S4.SS3.p3.8.m8.1.2.3.2.3.2.cmml">θ</mi><mo id="S4.SS3.p3.8.m8.1.2.3.2.3.1" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.3" xref="S4.SS3.p3.8.m8.1.2.3.2.3.3.cmml">e</mi><mo id="S4.SS3.p3.8.m8.1.2.3.2.3.1a" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.4" xref="S4.SS3.p3.8.m8.1.2.3.2.3.4.cmml">x</mi><mo id="S4.SS3.p3.8.m8.1.2.3.2.3.1b" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.5" xref="S4.SS3.p3.8.m8.1.2.3.2.3.5.cmml">p</mi><mo id="S4.SS3.p3.8.m8.1.2.3.2.3.1c" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.6" xref="S4.SS3.p3.8.m8.1.2.3.2.3.6.cmml">l</mi><mo id="S4.SS3.p3.8.m8.1.2.3.2.3.1d" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.7" xref="S4.SS3.p3.8.m8.1.2.3.2.3.7.cmml">o</mi><mo id="S4.SS3.p3.8.m8.1.2.3.2.3.1e" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.8" xref="S4.SS3.p3.8.m8.1.2.3.2.3.8.cmml">r</mi><mo id="S4.SS3.p3.8.m8.1.2.3.2.3.1f" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml">⁢</mo><msub id="S4.SS3.p3.8.m8.1.2.3.2.3.9" xref="S4.SS3.p3.8.m8.1.2.3.2.3.9.cmml"><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.9.2" xref="S4.SS3.p3.8.m8.1.2.3.2.3.9.2.cmml">e</mi><mi id="S4.SS3.p3.8.m8.1.2.3.2.3.9.3" xref="S4.SS3.p3.8.m8.1.2.3.2.3.9.3.cmml">t</mi></msub></mrow></msub><mo id="S4.SS3.p3.8.m8.1.2.3.1" xref="S4.SS3.p3.8.m8.1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p3.8.m8.1.2.3.3.2" xref="S4.SS3.p3.8.m8.1.2.3.cmml"><mo id="S4.SS3.p3.8.m8.1.2.3.3.2.1" stretchy="false" xref="S4.SS3.p3.8.m8.1.2.3.cmml">(</mo><mi id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml">x</mi><mo id="S4.SS3.p3.8.m8.1.2.3.3.2.2" stretchy="false" xref="S4.SS3.p3.8.m8.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><apply id="S4.SS3.p3.8.m8.1.2.cmml" xref="S4.SS3.p3.8.m8.1.2"><csymbol cd="latexml" id="S4.SS3.p3.8.m8.1.2.1.cmml" xref="S4.SS3.p3.8.m8.1.2.1">similar-to</csymbol><ci id="S4.SS3.p3.8.m8.1.2.2.cmml" xref="S4.SS3.p3.8.m8.1.2.2">𝑧</ci><apply id="S4.SS3.p3.8.m8.1.2.3.cmml" xref="S4.SS3.p3.8.m8.1.2.3"><times id="S4.SS3.p3.8.m8.1.2.3.1.cmml" xref="S4.SS3.p3.8.m8.1.2.3.1"></times><apply id="S4.SS3.p3.8.m8.1.2.3.2.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.2.3.2.1.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.2.3.2.2.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.2">𝜋</ci><apply id="S4.SS3.p3.8.m8.1.2.3.2.3.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3"><times id="S4.SS3.p3.8.m8.1.2.3.2.3.1.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.1"></times><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.2.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.2">𝜃</ci><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.3.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.3">𝑒</ci><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.4.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.4">𝑥</ci><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.5.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.5">𝑝</ci><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.6.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.6">𝑙</ci><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.7.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.7">𝑜</ci><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.8.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.8">𝑟</ci><apply id="S4.SS3.p3.8.m8.1.2.3.2.3.9.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.9"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.2.3.2.3.9.1.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.9">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.9.2.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.9.2">𝑒</ci><ci id="S4.SS3.p3.8.m8.1.2.3.2.3.9.3.cmml" xref="S4.SS3.p3.8.m8.1.2.3.2.3.9.3">𝑡</ci></apply></apply></apply><ci id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">z\sim\pi_{{\theta}explore_{t}}(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.8.m8.1d">italic_z ∼ italic_π start_POSTSUBSCRIPT italic_θ italic_e italic_x italic_p italic_l italic_o italic_r italic_e start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> with probability <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS3.p3.9.m9.1"><semantics id="S4.SS3.p3.9.m9.1a"><mi id="S4.SS3.p3.9.m9.1.1" xref="S4.SS3.p3.9.m9.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><ci id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.9.m9.1d">italic_β</annotation></semantics></math>; or <math alttext="z\sim P_{\mathcal{D}}(x)" class="ltx_Math" display="inline" id="S4.SS3.p3.10.m10.1"><semantics id="S4.SS3.p3.10.m10.1a"><mrow id="S4.SS3.p3.10.m10.1.2" xref="S4.SS3.p3.10.m10.1.2.cmml"><mi id="S4.SS3.p3.10.m10.1.2.2" xref="S4.SS3.p3.10.m10.1.2.2.cmml">z</mi><mo id="S4.SS3.p3.10.m10.1.2.1" xref="S4.SS3.p3.10.m10.1.2.1.cmml">∼</mo><mrow id="S4.SS3.p3.10.m10.1.2.3" xref="S4.SS3.p3.10.m10.1.2.3.cmml"><msub id="S4.SS3.p3.10.m10.1.2.3.2" xref="S4.SS3.p3.10.m10.1.2.3.2.cmml"><mi id="S4.SS3.p3.10.m10.1.2.3.2.2" xref="S4.SS3.p3.10.m10.1.2.3.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.10.m10.1.2.3.2.3" xref="S4.SS3.p3.10.m10.1.2.3.2.3.cmml">𝒟</mi></msub><mo id="S4.SS3.p3.10.m10.1.2.3.1" xref="S4.SS3.p3.10.m10.1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p3.10.m10.1.2.3.3.2" xref="S4.SS3.p3.10.m10.1.2.3.cmml"><mo id="S4.SS3.p3.10.m10.1.2.3.3.2.1" stretchy="false" xref="S4.SS3.p3.10.m10.1.2.3.cmml">(</mo><mi id="S4.SS3.p3.10.m10.1.1" xref="S4.SS3.p3.10.m10.1.1.cmml">x</mi><mo id="S4.SS3.p3.10.m10.1.2.3.3.2.2" stretchy="false" xref="S4.SS3.p3.10.m10.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m10.1b"><apply id="S4.SS3.p3.10.m10.1.2.cmml" xref="S4.SS3.p3.10.m10.1.2"><csymbol cd="latexml" id="S4.SS3.p3.10.m10.1.2.1.cmml" xref="S4.SS3.p3.10.m10.1.2.1">similar-to</csymbol><ci id="S4.SS3.p3.10.m10.1.2.2.cmml" xref="S4.SS3.p3.10.m10.1.2.2">𝑧</ci><apply id="S4.SS3.p3.10.m10.1.2.3.cmml" xref="S4.SS3.p3.10.m10.1.2.3"><times id="S4.SS3.p3.10.m10.1.2.3.1.cmml" xref="S4.SS3.p3.10.m10.1.2.3.1"></times><apply id="S4.SS3.p3.10.m10.1.2.3.2.cmml" xref="S4.SS3.p3.10.m10.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.2.3.2.1.cmml" xref="S4.SS3.p3.10.m10.1.2.3.2">subscript</csymbol><ci id="S4.SS3.p3.10.m10.1.2.3.2.2.cmml" xref="S4.SS3.p3.10.m10.1.2.3.2.2">𝑃</ci><ci id="S4.SS3.p3.10.m10.1.2.3.2.3.cmml" xref="S4.SS3.p3.10.m10.1.2.3.2.3">𝒟</ci></apply><ci id="S4.SS3.p3.10.m10.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m10.1c">z\sim P_{\mathcal{D}}(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.10.m10.1d">italic_z ∼ italic_P start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> with probability <math alttext="1-\alpha-\beta" class="ltx_Math" display="inline" id="S4.SS3.p3.11.m11.1"><semantics id="S4.SS3.p3.11.m11.1a"><mrow id="S4.SS3.p3.11.m11.1.1" xref="S4.SS3.p3.11.m11.1.1.cmml"><mn id="S4.SS3.p3.11.m11.1.1.2" xref="S4.SS3.p3.11.m11.1.1.2.cmml">1</mn><mo id="S4.SS3.p3.11.m11.1.1.1" xref="S4.SS3.p3.11.m11.1.1.1.cmml">−</mo><mi id="S4.SS3.p3.11.m11.1.1.3" xref="S4.SS3.p3.11.m11.1.1.3.cmml">α</mi><mo id="S4.SS3.p3.11.m11.1.1.1a" xref="S4.SS3.p3.11.m11.1.1.1.cmml">−</mo><mi id="S4.SS3.p3.11.m11.1.1.4" xref="S4.SS3.p3.11.m11.1.1.4.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.11.m11.1b"><apply id="S4.SS3.p3.11.m11.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1"><minus id="S4.SS3.p3.11.m11.1.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1.1"></minus><cn id="S4.SS3.p3.11.m11.1.1.2.cmml" type="integer" xref="S4.SS3.p3.11.m11.1.1.2">1</cn><ci id="S4.SS3.p3.11.m11.1.1.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3">𝛼</ci><ci id="S4.SS3.p3.11.m11.1.1.4.cmml" xref="S4.SS3.p3.11.m11.1.1.4">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.11.m11.1c">1-\alpha-\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.11.m11.1d">1 - italic_α - italic_β</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.7"><span class="ltx_text ltx_font_bold" id="S4.SS3.p4.1.1">Estimating <math alttext="\pi^{\prime}(a|x,z)" class="ltx_Math" display="inline" id="S4.SS3.p4.1.1.m1.3"><semantics id="S4.SS3.p4.1.1.m1.3a"><mrow id="S4.SS3.p4.1.1.m1.3.3" xref="S4.SS3.p4.1.1.m1.3.3.cmml"><msup id="S4.SS3.p4.1.1.m1.3.3.3" xref="S4.SS3.p4.1.1.m1.3.3.3.cmml"><mi id="S4.SS3.p4.1.1.m1.3.3.3.2" xref="S4.SS3.p4.1.1.m1.3.3.3.2.cmml">π</mi><mo id="S4.SS3.p4.1.1.m1.3.3.3.3" xref="S4.SS3.p4.1.1.m1.3.3.3.3.cmml">′</mo></msup><mo id="S4.SS3.p4.1.1.m1.3.3.2" xref="S4.SS3.p4.1.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.SS3.p4.1.1.m1.3.3.1.1" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.cmml"><mo id="S4.SS3.p4.1.1.m1.3.3.1.1.2" stretchy="false" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS3.p4.1.1.m1.3.3.1.1.1" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS3.p4.1.1.m1.3.3.1.1.1.2" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.SS3.p4.1.1.m1.3.3.1.1.1.1" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p4.1.1.m1.3.3.1.1.1.3.2" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S4.SS3.p4.1.1.m1.1.1" xref="S4.SS3.p4.1.1.m1.1.1.cmml">x</mi><mo id="S4.SS3.p4.1.1.m1.3.3.1.1.1.3.2.1" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S4.SS3.p4.1.1.m1.2.2" xref="S4.SS3.p4.1.1.m1.2.2.cmml">z</mi></mrow></mrow><mo id="S4.SS3.p4.1.1.m1.3.3.1.1.3" stretchy="false" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.1.m1.3b"><apply id="S4.SS3.p4.1.1.m1.3.3.cmml" xref="S4.SS3.p4.1.1.m1.3.3"><times id="S4.SS3.p4.1.1.m1.3.3.2.cmml" xref="S4.SS3.p4.1.1.m1.3.3.2"></times><apply id="S4.SS3.p4.1.1.m1.3.3.3.cmml" xref="S4.SS3.p4.1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p4.1.1.m1.3.3.3.1.cmml" xref="S4.SS3.p4.1.1.m1.3.3.3">superscript</csymbol><ci id="S4.SS3.p4.1.1.m1.3.3.3.2.cmml" xref="S4.SS3.p4.1.1.m1.3.3.3.2">𝜋</ci><ci id="S4.SS3.p4.1.1.m1.3.3.3.3.cmml" xref="S4.SS3.p4.1.1.m1.3.3.3.3">′</ci></apply><apply id="S4.SS3.p4.1.1.m1.3.3.1.1.1.cmml" xref="S4.SS3.p4.1.1.m1.3.3.1.1"><csymbol cd="latexml" id="S4.SS3.p4.1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS3.p4.1.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.2">𝑎</ci><list id="S4.SS3.p4.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S4.SS3.p4.1.1.m1.3.3.1.1.1.3.2"><ci id="S4.SS3.p4.1.1.m1.1.1.cmml" xref="S4.SS3.p4.1.1.m1.1.1">𝑥</ci><ci id="S4.SS3.p4.1.1.m1.2.2.cmml" xref="S4.SS3.p4.1.1.m1.2.2">𝑧</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.1.m1.3c">\pi^{\prime}(a|x,z)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.1.m1.3d">italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_a | italic_x , italic_z )</annotation></semantics></math>.</span> While <math alttext="\pi^{\prime}(a|x,z)" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m1.3"><semantics id="S4.SS3.p4.2.m1.3a"><mrow id="S4.SS3.p4.2.m1.3.3" xref="S4.SS3.p4.2.m1.3.3.cmml"><msup id="S4.SS3.p4.2.m1.3.3.3" xref="S4.SS3.p4.2.m1.3.3.3.cmml"><mi id="S4.SS3.p4.2.m1.3.3.3.2" xref="S4.SS3.p4.2.m1.3.3.3.2.cmml">π</mi><mo id="S4.SS3.p4.2.m1.3.3.3.3" xref="S4.SS3.p4.2.m1.3.3.3.3.cmml">′</mo></msup><mo id="S4.SS3.p4.2.m1.3.3.2" xref="S4.SS3.p4.2.m1.3.3.2.cmml">⁢</mo><mrow id="S4.SS3.p4.2.m1.3.3.1.1" xref="S4.SS3.p4.2.m1.3.3.1.1.1.cmml"><mo id="S4.SS3.p4.2.m1.3.3.1.1.2" stretchy="false" xref="S4.SS3.p4.2.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS3.p4.2.m1.3.3.1.1.1" xref="S4.SS3.p4.2.m1.3.3.1.1.1.cmml"><mi id="S4.SS3.p4.2.m1.3.3.1.1.1.2" xref="S4.SS3.p4.2.m1.3.3.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.SS3.p4.2.m1.3.3.1.1.1.1" xref="S4.SS3.p4.2.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S4.SS3.p4.2.m1.3.3.1.1.1.3.2" xref="S4.SS3.p4.2.m1.3.3.1.1.1.3.1.cmml"><mi id="S4.SS3.p4.2.m1.1.1" xref="S4.SS3.p4.2.m1.1.1.cmml">x</mi><mo id="S4.SS3.p4.2.m1.3.3.1.1.1.3.2.1" xref="S4.SS3.p4.2.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S4.SS3.p4.2.m1.2.2" xref="S4.SS3.p4.2.m1.2.2.cmml">z</mi></mrow></mrow><mo id="S4.SS3.p4.2.m1.3.3.1.1.3" stretchy="false" xref="S4.SS3.p4.2.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m1.3b"><apply id="S4.SS3.p4.2.m1.3.3.cmml" xref="S4.SS3.p4.2.m1.3.3"><times id="S4.SS3.p4.2.m1.3.3.2.cmml" xref="S4.SS3.p4.2.m1.3.3.2"></times><apply id="S4.SS3.p4.2.m1.3.3.3.cmml" xref="S4.SS3.p4.2.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m1.3.3.3.1.cmml" xref="S4.SS3.p4.2.m1.3.3.3">superscript</csymbol><ci id="S4.SS3.p4.2.m1.3.3.3.2.cmml" xref="S4.SS3.p4.2.m1.3.3.3.2">𝜋</ci><ci id="S4.SS3.p4.2.m1.3.3.3.3.cmml" xref="S4.SS3.p4.2.m1.3.3.3.3">′</ci></apply><apply id="S4.SS3.p4.2.m1.3.3.1.1.1.cmml" xref="S4.SS3.p4.2.m1.3.3.1.1"><csymbol cd="latexml" id="S4.SS3.p4.2.m1.3.3.1.1.1.1.cmml" xref="S4.SS3.p4.2.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S4.SS3.p4.2.m1.3.3.1.1.1.2.cmml" xref="S4.SS3.p4.2.m1.3.3.1.1.1.2">𝑎</ci><list id="S4.SS3.p4.2.m1.3.3.1.1.1.3.1.cmml" xref="S4.SS3.p4.2.m1.3.3.1.1.1.3.2"><ci id="S4.SS3.p4.2.m1.1.1.cmml" xref="S4.SS3.p4.2.m1.1.1">𝑥</ci><ci id="S4.SS3.p4.2.m1.2.2.cmml" xref="S4.SS3.p4.2.m1.2.2">𝑧</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m1.3c">\pi^{\prime}(a|x,z)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m1.3d">italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_a | italic_x , italic_z )</annotation></semantics></math> is defined as a softmax operation, computing the softmax over all items is a compute-intensive procedure. Moreover, training procedures for recommendation systems have benefitted from using contrastive losses. Therefore, we we implement an approximation of the softmax using contrastive losses. A straightforward approximation is to only use the items in the current batch as negatives (random in-batch negatives). However, since we initialize with a well-trained supervised policy, we may find that most of the contrastive losses are zero since the chosen item is already closer to the query than random negatives. To speed up training, we use negatives that are aimed at optimizing novelty. Specifically, for each query, we use the top-M items returned by the base model as negatives. <math alttext="M" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m2.1"><semantics id="S4.SS3.p4.3.m2.1a"><mi id="S4.SS3.p4.3.m2.1.1" xref="S4.SS3.p4.3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m2.1b"><ci id="S4.SS3.p4.3.m2.1.1.cmml" xref="S4.SS3.p4.3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m2.1d">italic_M</annotation></semantics></math> is a hyperparameter; too high <math alttext="M" class="ltx_Math" display="inline" id="S4.SS3.p4.4.m3.1"><semantics id="S4.SS3.p4.4.m3.1a"><mi id="S4.SS3.p4.4.m3.1.1" xref="S4.SS3.p4.4.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m3.1b"><ci id="S4.SS3.p4.4.m3.1.1.cmml" xref="S4.SS3.p4.4.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.4.m3.1d">italic_M</annotation></semantics></math> may destroy all relevance. Therefore, we define two kinds of losses:<span class="ltx_text ltx_font_bold" id="S4.SS3.p4.7.2"> 1)</span> <span class="ltx_text ltx_font_italic" id="S4.SS3.p4.7.3">Aggressive-Novelty:</span> InfoNCE loss from Eqn. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Ex1" title="3.1. Problem statement: Novelty optimization ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a> with top-M negatives (typically M is small, e.g., <math alttext="M=5" class="ltx_Math" display="inline" id="S4.SS3.p4.5.m4.1"><semantics id="S4.SS3.p4.5.m4.1a"><mrow id="S4.SS3.p4.5.m4.1.1" xref="S4.SS3.p4.5.m4.1.1.cmml"><mi id="S4.SS3.p4.5.m4.1.1.2" xref="S4.SS3.p4.5.m4.1.1.2.cmml">M</mi><mo id="S4.SS3.p4.5.m4.1.1.1" xref="S4.SS3.p4.5.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.p4.5.m4.1.1.3" xref="S4.SS3.p4.5.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m4.1b"><apply id="S4.SS3.p4.5.m4.1.1.cmml" xref="S4.SS3.p4.5.m4.1.1"><eq id="S4.SS3.p4.5.m4.1.1.1.cmml" xref="S4.SS3.p4.5.m4.1.1.1"></eq><ci id="S4.SS3.p4.5.m4.1.1.2.cmml" xref="S4.SS3.p4.5.m4.1.1.2">𝑀</ci><cn id="S4.SS3.p4.5.m4.1.1.3.cmml" type="integer" xref="S4.SS3.p4.5.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m4.1c">M=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.5.m4.1d">italic_M = 5</annotation></semantics></math>); <span class="ltx_text ltx_font_bold" id="S4.SS3.p4.7.4">2)</span> <span class="ltx_text ltx_font_italic" id="S4.SS3.p4.7.5">Conservative-Novelty:</span> Triplet loss <cite class="ltx_cite ltx_citemacro_citep">(Le-Khac et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib18" title="">2020</a>)</cite>, bounded <math alttext="\in[0,1]" class="ltx_Math" display="inline" id="S4.SS3.p4.6.m5.2"><semantics id="S4.SS3.p4.6.m5.2a"><mrow id="S4.SS3.p4.6.m5.2.3" xref="S4.SS3.p4.6.m5.2.3.cmml"><mi id="S4.SS3.p4.6.m5.2.3.2" xref="S4.SS3.p4.6.m5.2.3.2.cmml"></mi><mo id="S4.SS3.p4.6.m5.2.3.1" xref="S4.SS3.p4.6.m5.2.3.1.cmml">∈</mo><mrow id="S4.SS3.p4.6.m5.2.3.3.2" xref="S4.SS3.p4.6.m5.2.3.3.1.cmml"><mo id="S4.SS3.p4.6.m5.2.3.3.2.1" stretchy="false" xref="S4.SS3.p4.6.m5.2.3.3.1.cmml">[</mo><mn id="S4.SS3.p4.6.m5.1.1" xref="S4.SS3.p4.6.m5.1.1.cmml">0</mn><mo id="S4.SS3.p4.6.m5.2.3.3.2.2" xref="S4.SS3.p4.6.m5.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p4.6.m5.2.2" xref="S4.SS3.p4.6.m5.2.2.cmml">1</mn><mo id="S4.SS3.p4.6.m5.2.3.3.2.3" stretchy="false" xref="S4.SS3.p4.6.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.6.m5.2b"><apply id="S4.SS3.p4.6.m5.2.3.cmml" xref="S4.SS3.p4.6.m5.2.3"><in id="S4.SS3.p4.6.m5.2.3.1.cmml" xref="S4.SS3.p4.6.m5.2.3.1"></in><csymbol cd="latexml" id="S4.SS3.p4.6.m5.2.3.2.cmml" xref="S4.SS3.p4.6.m5.2.3.2">absent</csymbol><interval closure="closed" id="S4.SS3.p4.6.m5.2.3.3.1.cmml" xref="S4.SS3.p4.6.m5.2.3.3.2"><cn id="S4.SS3.p4.6.m5.1.1.cmml" type="integer" xref="S4.SS3.p4.6.m5.1.1">0</cn><cn id="S4.SS3.p4.6.m5.2.2.cmml" type="integer" xref="S4.SS3.p4.6.m5.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.6.m5.2c">\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.6.m5.2d">∈ [ 0 , 1 ]</annotation></semantics></math> and margin=0 (effectively <math alttext="M=1" class="ltx_Math" display="inline" id="S4.SS3.p4.7.m6.1"><semantics id="S4.SS3.p4.7.m6.1a"><mrow id="S4.SS3.p4.7.m6.1.1" xref="S4.SS3.p4.7.m6.1.1.cmml"><mi id="S4.SS3.p4.7.m6.1.1.2" xref="S4.SS3.p4.7.m6.1.1.2.cmml">M</mi><mo id="S4.SS3.p4.7.m6.1.1.1" xref="S4.SS3.p4.7.m6.1.1.1.cmml">=</mo><mn id="S4.SS3.p4.7.m6.1.1.3" xref="S4.SS3.p4.7.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.7.m6.1b"><apply id="S4.SS3.p4.7.m6.1.1.cmml" xref="S4.SS3.p4.7.m6.1.1"><eq id="S4.SS3.p4.7.m6.1.1.1.cmml" xref="S4.SS3.p4.7.m6.1.1.1"></eq><ci id="S4.SS3.p4.7.m6.1.1.2.cmml" xref="S4.SS3.p4.7.m6.1.1.2">𝑀</ci><cn id="S4.SS3.p4.7.m6.1.1.3.cmml" type="integer" xref="S4.SS3.p4.7.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.7.m6.1c">M=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.7.m6.1d">italic_M = 1</annotation></semantics></math>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p5.1.1">Efficiency considerations. </span>Note that to compute top-k items or sample items for a given query, the entire set of actions have to be encoded by the current encoder <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1"><semantics id="S4.SS3.p5.1.m1.1a"><msub id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">f</mi><mi id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝑓</ci><ci id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. For computationally efficiency, we fix the item encoder to be the initial encoder and only update the query encoder. This avoids having to recompute the item embeddings for each query in the batch. That is, only the query encoder is updated during policy optimization.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Large action PG</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.2">Input:</span> Initial Policy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">π</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝜋</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, Base Model <math alttext="\psi" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_ψ</annotation></semantics></math>, Training dataset <math alttext="{D}" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_D</annotation></semantics></math>, Relevance Oracle <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="alg1.l1.3">rel</span>, Number of epochs <math alttext="N" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_N</annotation></semantics></math>, Batch size <math alttext="B" class="ltx_Math" display="inline" id="alg1.l1.m6.1"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m6.1d">italic_B</annotation></semantics></math>, Learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="alg1.l1.m7.1"><semantics id="alg1.l1.m7.1a"><mi id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><ci id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m7.1d">italic_η</annotation></semantics></math>, <math alttext="\alpha,\beta\in[0,1]" class="ltx_Math" display="inline" id="alg1.l1.m8.4"><semantics id="alg1.l1.m8.4a"><mrow id="alg1.l1.m8.4.5" xref="alg1.l1.m8.4.5.cmml"><mrow id="alg1.l1.m8.4.5.2.2" xref="alg1.l1.m8.4.5.2.1.cmml"><mi id="alg1.l1.m8.3.3" xref="alg1.l1.m8.3.3.cmml">α</mi><mo id="alg1.l1.m8.4.5.2.2.1" xref="alg1.l1.m8.4.5.2.1.cmml">,</mo><mi id="alg1.l1.m8.4.4" xref="alg1.l1.m8.4.4.cmml">β</mi></mrow><mo id="alg1.l1.m8.4.5.1" xref="alg1.l1.m8.4.5.1.cmml">∈</mo><mrow id="alg1.l1.m8.4.5.3.2" xref="alg1.l1.m8.4.5.3.1.cmml"><mo id="alg1.l1.m8.4.5.3.2.1" stretchy="false" xref="alg1.l1.m8.4.5.3.1.cmml">[</mo><mn id="alg1.l1.m8.1.1" xref="alg1.l1.m8.1.1.cmml">0</mn><mo id="alg1.l1.m8.4.5.3.2.2" xref="alg1.l1.m8.4.5.3.1.cmml">,</mo><mn id="alg1.l1.m8.2.2" xref="alg1.l1.m8.2.2.cmml">1</mn><mo id="alg1.l1.m8.4.5.3.2.3" stretchy="false" xref="alg1.l1.m8.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m8.4b"><apply id="alg1.l1.m8.4.5.cmml" xref="alg1.l1.m8.4.5"><in id="alg1.l1.m8.4.5.1.cmml" xref="alg1.l1.m8.4.5.1"></in><list id="alg1.l1.m8.4.5.2.1.cmml" xref="alg1.l1.m8.4.5.2.2"><ci id="alg1.l1.m8.3.3.cmml" xref="alg1.l1.m8.3.3">𝛼</ci><ci id="alg1.l1.m8.4.4.cmml" xref="alg1.l1.m8.4.4">𝛽</ci></list><interval closure="closed" id="alg1.l1.m8.4.5.3.1.cmml" xref="alg1.l1.m8.4.5.3.2"><cn id="alg1.l1.m8.1.1.cmml" type="integer" xref="alg1.l1.m8.1.1">0</cn><cn id="alg1.l1.m8.2.2.cmml" type="integer" xref="alg1.l1.m8.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m8.4c">\alpha,\beta\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m8.4d">italic_α , italic_β ∈ [ 0 , 1 ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.2">Output:</span> Trained policy <math alttext="\hat{\pi}_{\theta}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mover accent="true" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">π</mi><mo id="alg1.l2.m1.1.1.2.1" xref="alg1.l2.m1.1.1.2.1.cmml">^</mo></mover><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><ci id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2.1">^</ci><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝜋</ci></apply><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\hat{\pi}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">over^ start_ARG italic_π end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l3.2">for</span> epoch=1,2,3..N <span class="ltx_text ltx_font_bold" id="alg1.l3.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l4.2">for</span> <math alttext="{D}_{batch}\sim{D}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">D</mi><mrow id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml"><mi id="alg1.l4.m1.1.1.2.3.2" xref="alg1.l4.m1.1.1.2.3.2.cmml">b</mi><mo id="alg1.l4.m1.1.1.2.3.1" xref="alg1.l4.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.2.3.3" xref="alg1.l4.m1.1.1.2.3.3.cmml">a</mi><mo id="alg1.l4.m1.1.1.2.3.1a" xref="alg1.l4.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.2.3.4" xref="alg1.l4.m1.1.1.2.3.4.cmml">t</mi><mo id="alg1.l4.m1.1.1.2.3.1b" xref="alg1.l4.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.2.3.5" xref="alg1.l4.m1.1.1.2.3.5.cmml">c</mi><mo id="alg1.l4.m1.1.1.2.3.1c" xref="alg1.l4.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.2.3.6" xref="alg1.l4.m1.1.1.2.3.6.cmml">h</mi></mrow></msub><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∼</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="latexml" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">similar-to</csymbol><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝐷</ci><apply id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3"><times id="alg1.l4.m1.1.1.2.3.1.cmml" xref="alg1.l4.m1.1.1.2.3.1"></times><ci id="alg1.l4.m1.1.1.2.3.2.cmml" xref="alg1.l4.m1.1.1.2.3.2">𝑏</ci><ci id="alg1.l4.m1.1.1.2.3.3.cmml" xref="alg1.l4.m1.1.1.2.3.3">𝑎</ci><ci id="alg1.l4.m1.1.1.2.3.4.cmml" xref="alg1.l4.m1.1.1.2.3.4">𝑡</ci><ci id="alg1.l4.m1.1.1.2.3.5.cmml" xref="alg1.l4.m1.1.1.2.3.5">𝑐</ci><ci id="alg1.l4.m1.1.1.2.3.6.cmml" xref="alg1.l4.m1.1.1.2.3.6">ℎ</ci></apply></apply><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">{D}_{batch}\sim{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_D start_POSTSUBSCRIPT italic_b italic_a italic_t italic_c italic_h end_POSTSUBSCRIPT ∼ italic_D</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>        <math alttext="L=0" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">L</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">=</mo><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></eq><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝐿</ci><cn id="alg1.l5.m1.1.1.3.cmml" type="integer" xref="alg1.l5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">L=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_L = 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>        <math alttext="i=0" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">i</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">=</mo><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></eq><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑖</ci><cn id="alg1.l6.m1.1.1.3.cmml" type="integer" xref="alg1.l6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">i=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_i = 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>        <math alttext="(x,z)\sim D" class="ltx_Math" display="inline" id="alg1.l7.m1.2"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.3" xref="alg1.l7.m1.2.3.cmml"><mrow id="alg1.l7.m1.2.3.2.2" xref="alg1.l7.m1.2.3.2.1.cmml"><mo id="alg1.l7.m1.2.3.2.2.1" stretchy="false" xref="alg1.l7.m1.2.3.2.1.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">x</mi><mo id="alg1.l7.m1.2.3.2.2.2" xref="alg1.l7.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">z</mi><mo id="alg1.l7.m1.2.3.2.2.3" stretchy="false" xref="alg1.l7.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg1.l7.m1.2.3.1" xref="alg1.l7.m1.2.3.1.cmml">∼</mo><mi id="alg1.l7.m1.2.3.3" xref="alg1.l7.m1.2.3.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.3.cmml" xref="alg1.l7.m1.2.3"><csymbol cd="latexml" id="alg1.l7.m1.2.3.1.cmml" xref="alg1.l7.m1.2.3.1">similar-to</csymbol><interval closure="open" id="alg1.l7.m1.2.3.2.1.cmml" xref="alg1.l7.m1.2.3.2.2"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑥</ci><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">𝑧</ci></interval><ci id="alg1.l7.m1.2.3.3.cmml" xref="alg1.l7.m1.2.3.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">(x,z)\sim D</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.2d">( italic_x , italic_z ) ∼ italic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>        <span class="ltx_text ltx_font_bold" id="alg1.l8.2">while</span> <math alttext="i&lt;B" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">&lt;</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><lt id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></lt><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑖</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">i&lt;B</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_i &lt; italic_B</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>           <math alttext="a\sim\pi^{\prime}_{\theta}(x,z)" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.3" xref="alg1.l9.m1.2.3.cmml"><mi id="alg1.l9.m1.2.3.2" xref="alg1.l9.m1.2.3.2.cmml">a</mi><mo id="alg1.l9.m1.2.3.1" xref="alg1.l9.m1.2.3.1.cmml">∼</mo><mrow id="alg1.l9.m1.2.3.3" xref="alg1.l9.m1.2.3.3.cmml"><msubsup id="alg1.l9.m1.2.3.3.2" xref="alg1.l9.m1.2.3.3.2.cmml"><mi id="alg1.l9.m1.2.3.3.2.2.2" xref="alg1.l9.m1.2.3.3.2.2.2.cmml">π</mi><mi id="alg1.l9.m1.2.3.3.2.3" xref="alg1.l9.m1.2.3.3.2.3.cmml">θ</mi><mo id="alg1.l9.m1.2.3.3.2.2.3" xref="alg1.l9.m1.2.3.3.2.2.3.cmml">′</mo></msubsup><mo id="alg1.l9.m1.2.3.3.1" xref="alg1.l9.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l9.m1.2.3.3.3.2" xref="alg1.l9.m1.2.3.3.3.1.cmml"><mo id="alg1.l9.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l9.m1.2.3.3.3.1.cmml">(</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">x</mi><mo id="alg1.l9.m1.2.3.3.3.2.2" xref="alg1.l9.m1.2.3.3.3.1.cmml">,</mo><mi id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">z</mi><mo id="alg1.l9.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l9.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.3.cmml" xref="alg1.l9.m1.2.3"><csymbol cd="latexml" id="alg1.l9.m1.2.3.1.cmml" xref="alg1.l9.m1.2.3.1">similar-to</csymbol><ci id="alg1.l9.m1.2.3.2.cmml" xref="alg1.l9.m1.2.3.2">𝑎</ci><apply id="alg1.l9.m1.2.3.3.cmml" xref="alg1.l9.m1.2.3.3"><times id="alg1.l9.m1.2.3.3.1.cmml" xref="alg1.l9.m1.2.3.3.1"></times><apply id="alg1.l9.m1.2.3.3.2.cmml" xref="alg1.l9.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.3.2.1.cmml" xref="alg1.l9.m1.2.3.3.2">subscript</csymbol><apply id="alg1.l9.m1.2.3.3.2.2.cmml" xref="alg1.l9.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.3.2.2.1.cmml" xref="alg1.l9.m1.2.3.3.2">superscript</csymbol><ci id="alg1.l9.m1.2.3.3.2.2.2.cmml" xref="alg1.l9.m1.2.3.3.2.2.2">𝜋</ci><ci id="alg1.l9.m1.2.3.3.2.2.3.cmml" xref="alg1.l9.m1.2.3.3.2.2.3">′</ci></apply><ci id="alg1.l9.m1.2.3.3.2.3.cmml" xref="alg1.l9.m1.2.3.3.2.3">𝜃</ci></apply><interval closure="open" id="alg1.l9.m1.2.3.3.3.1.cmml" xref="alg1.l9.m1.2.3.3.3.2"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑥</ci><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑧</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">a\sim\pi^{\prime}_{\theta}(x,z)</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">italic_a ∼ italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_z )</annotation></semantics></math> // Sample Action

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>           <math alttext="r_{b}=\mathcal{R}_{b}(x,z,\texttt{topk}(x,\psi),\texttt{rel}(x,z))" class="ltx_Math" display="inline" id="alg1.l10.m1.8"><semantics id="alg1.l10.m1.8a"><mrow id="alg1.l10.m1.8.8" xref="alg1.l10.m1.8.8.cmml"><msub id="alg1.l10.m1.8.8.4" xref="alg1.l10.m1.8.8.4.cmml"><mi id="alg1.l10.m1.8.8.4.2" xref="alg1.l10.m1.8.8.4.2.cmml">r</mi><mi id="alg1.l10.m1.8.8.4.3" xref="alg1.l10.m1.8.8.4.3.cmml">b</mi></msub><mo id="alg1.l10.m1.8.8.3" xref="alg1.l10.m1.8.8.3.cmml">=</mo><mrow id="alg1.l10.m1.8.8.2" xref="alg1.l10.m1.8.8.2.cmml"><msub id="alg1.l10.m1.8.8.2.4" xref="alg1.l10.m1.8.8.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.8.8.2.4.2" xref="alg1.l10.m1.8.8.2.4.2.cmml">ℛ</mi><mi id="alg1.l10.m1.8.8.2.4.3" xref="alg1.l10.m1.8.8.2.4.3.cmml">b</mi></msub><mo id="alg1.l10.m1.8.8.2.3" xref="alg1.l10.m1.8.8.2.3.cmml">⁢</mo><mrow id="alg1.l10.m1.8.8.2.2.2" xref="alg1.l10.m1.8.8.2.2.3.cmml"><mo id="alg1.l10.m1.8.8.2.2.2.3" stretchy="false" xref="alg1.l10.m1.8.8.2.2.3.cmml">(</mo><mi id="alg1.l10.m1.5.5" xref="alg1.l10.m1.5.5.cmml">x</mi><mo id="alg1.l10.m1.8.8.2.2.2.4" xref="alg1.l10.m1.8.8.2.2.3.cmml">,</mo><mi id="alg1.l10.m1.6.6" xref="alg1.l10.m1.6.6.cmml">z</mi><mo id="alg1.l10.m1.8.8.2.2.2.5" xref="alg1.l10.m1.8.8.2.2.3.cmml">,</mo><mrow id="alg1.l10.m1.7.7.1.1.1.1" xref="alg1.l10.m1.7.7.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.7.7.1.1.1.1.2" xref="alg1.l10.m1.7.7.1.1.1.1.2a.cmml">topk</mtext><mo id="alg1.l10.m1.7.7.1.1.1.1.1" xref="alg1.l10.m1.7.7.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l10.m1.7.7.1.1.1.1.3.2" xref="alg1.l10.m1.7.7.1.1.1.1.3.1.cmml"><mo id="alg1.l10.m1.7.7.1.1.1.1.3.2.1" stretchy="false" xref="alg1.l10.m1.7.7.1.1.1.1.3.1.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">x</mi><mo id="alg1.l10.m1.7.7.1.1.1.1.3.2.2" xref="alg1.l10.m1.7.7.1.1.1.1.3.1.cmml">,</mo><mi id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml">ψ</mi><mo id="alg1.l10.m1.7.7.1.1.1.1.3.2.3" stretchy="false" xref="alg1.l10.m1.7.7.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l10.m1.8.8.2.2.2.6" xref="alg1.l10.m1.8.8.2.2.3.cmml">,</mo><mrow id="alg1.l10.m1.8.8.2.2.2.2" xref="alg1.l10.m1.8.8.2.2.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.8.8.2.2.2.2.2" xref="alg1.l10.m1.8.8.2.2.2.2.2a.cmml">rel</mtext><mo id="alg1.l10.m1.8.8.2.2.2.2.1" xref="alg1.l10.m1.8.8.2.2.2.2.1.cmml">⁢</mo><mrow id="alg1.l10.m1.8.8.2.2.2.2.3.2" xref="alg1.l10.m1.8.8.2.2.2.2.3.1.cmml"><mo id="alg1.l10.m1.8.8.2.2.2.2.3.2.1" stretchy="false" xref="alg1.l10.m1.8.8.2.2.2.2.3.1.cmml">(</mo><mi id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml">x</mi><mo id="alg1.l10.m1.8.8.2.2.2.2.3.2.2" xref="alg1.l10.m1.8.8.2.2.2.2.3.1.cmml">,</mo><mi id="alg1.l10.m1.4.4" xref="alg1.l10.m1.4.4.cmml">z</mi><mo id="alg1.l10.m1.8.8.2.2.2.2.3.2.3" stretchy="false" xref="alg1.l10.m1.8.8.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l10.m1.8.8.2.2.2.7" stretchy="false" xref="alg1.l10.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.8b"><apply id="alg1.l10.m1.8.8.cmml" xref="alg1.l10.m1.8.8"><eq id="alg1.l10.m1.8.8.3.cmml" xref="alg1.l10.m1.8.8.3"></eq><apply id="alg1.l10.m1.8.8.4.cmml" xref="alg1.l10.m1.8.8.4"><csymbol cd="ambiguous" id="alg1.l10.m1.8.8.4.1.cmml" xref="alg1.l10.m1.8.8.4">subscript</csymbol><ci id="alg1.l10.m1.8.8.4.2.cmml" xref="alg1.l10.m1.8.8.4.2">𝑟</ci><ci id="alg1.l10.m1.8.8.4.3.cmml" xref="alg1.l10.m1.8.8.4.3">𝑏</ci></apply><apply id="alg1.l10.m1.8.8.2.cmml" xref="alg1.l10.m1.8.8.2"><times id="alg1.l10.m1.8.8.2.3.cmml" xref="alg1.l10.m1.8.8.2.3"></times><apply id="alg1.l10.m1.8.8.2.4.cmml" xref="alg1.l10.m1.8.8.2.4"><csymbol cd="ambiguous" id="alg1.l10.m1.8.8.2.4.1.cmml" xref="alg1.l10.m1.8.8.2.4">subscript</csymbol><ci id="alg1.l10.m1.8.8.2.4.2.cmml" xref="alg1.l10.m1.8.8.2.4.2">ℛ</ci><ci id="alg1.l10.m1.8.8.2.4.3.cmml" xref="alg1.l10.m1.8.8.2.4.3">𝑏</ci></apply><vector id="alg1.l10.m1.8.8.2.2.3.cmml" xref="alg1.l10.m1.8.8.2.2.2"><ci id="alg1.l10.m1.5.5.cmml" xref="alg1.l10.m1.5.5">𝑥</ci><ci id="alg1.l10.m1.6.6.cmml" xref="alg1.l10.m1.6.6">𝑧</ci><apply id="alg1.l10.m1.7.7.1.1.1.1.cmml" xref="alg1.l10.m1.7.7.1.1.1.1"><times id="alg1.l10.m1.7.7.1.1.1.1.1.cmml" xref="alg1.l10.m1.7.7.1.1.1.1.1"></times><ci id="alg1.l10.m1.7.7.1.1.1.1.2a.cmml" xref="alg1.l10.m1.7.7.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.7.7.1.1.1.1.2.cmml" xref="alg1.l10.m1.7.7.1.1.1.1.2">topk</mtext></ci><interval closure="open" id="alg1.l10.m1.7.7.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.7.7.1.1.1.1.3.2"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑥</ci><ci id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2">𝜓</ci></interval></apply><apply id="alg1.l10.m1.8.8.2.2.2.2.cmml" xref="alg1.l10.m1.8.8.2.2.2.2"><times id="alg1.l10.m1.8.8.2.2.2.2.1.cmml" xref="alg1.l10.m1.8.8.2.2.2.2.1"></times><ci id="alg1.l10.m1.8.8.2.2.2.2.2a.cmml" xref="alg1.l10.m1.8.8.2.2.2.2.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l10.m1.8.8.2.2.2.2.2.cmml" xref="alg1.l10.m1.8.8.2.2.2.2.2">rel</mtext></ci><interval closure="open" id="alg1.l10.m1.8.8.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.8.8.2.2.2.2.3.2"><ci id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3">𝑥</ci><ci id="alg1.l10.m1.4.4.cmml" xref="alg1.l10.m1.4.4">𝑧</ci></interval></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.8c">r_{b}=\mathcal{R}_{b}(x,z,\texttt{topk}(x,\psi),\texttt{rel}(x,z))</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.8d">italic_r start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = caligraphic_R start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x , italic_z , topk ( italic_x , italic_ψ ) , rel ( italic_x , italic_z ) )</annotation></semantics></math> // Reward depends on top-k items and relevance oracle

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>           <math alttext="r=r_{b}a+(-r_{b})(1-a)" class="ltx_Math" display="inline" id="alg1.l11.m1.2"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml"><mi id="alg1.l11.m1.2.2.4" xref="alg1.l11.m1.2.2.4.cmml">r</mi><mo id="alg1.l11.m1.2.2.3" xref="alg1.l11.m1.2.2.3.cmml">=</mo><mrow id="alg1.l11.m1.2.2.2" xref="alg1.l11.m1.2.2.2.cmml"><mrow id="alg1.l11.m1.2.2.2.4" xref="alg1.l11.m1.2.2.2.4.cmml"><msub id="alg1.l11.m1.2.2.2.4.2" xref="alg1.l11.m1.2.2.2.4.2.cmml"><mi id="alg1.l11.m1.2.2.2.4.2.2" xref="alg1.l11.m1.2.2.2.4.2.2.cmml">r</mi><mi id="alg1.l11.m1.2.2.2.4.2.3" xref="alg1.l11.m1.2.2.2.4.2.3.cmml">b</mi></msub><mo id="alg1.l11.m1.2.2.2.4.1" xref="alg1.l11.m1.2.2.2.4.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.2.2.4.3" xref="alg1.l11.m1.2.2.2.4.3.cmml">a</mi></mrow><mo id="alg1.l11.m1.2.2.2.3" xref="alg1.l11.m1.2.2.2.3.cmml">+</mo><mrow id="alg1.l11.m1.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.cmml"><mrow id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l11.m1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l11.m1.1.1.1.1.1.1.1a" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l11.m1.1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="alg1.l11.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.3.cmml">b</mi></msub></mrow><mo id="alg1.l11.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l11.m1.2.2.2.2.3" xref="alg1.l11.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l11.m1.2.2.2.2.2.1" xref="alg1.l11.m1.2.2.2.2.2.1.1.cmml"><mo id="alg1.l11.m1.2.2.2.2.2.1.2" stretchy="false" xref="alg1.l11.m1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="alg1.l11.m1.2.2.2.2.2.1.1" xref="alg1.l11.m1.2.2.2.2.2.1.1.cmml"><mn id="alg1.l11.m1.2.2.2.2.2.1.1.2" xref="alg1.l11.m1.2.2.2.2.2.1.1.2.cmml">1</mn><mo id="alg1.l11.m1.2.2.2.2.2.1.1.1" xref="alg1.l11.m1.2.2.2.2.2.1.1.1.cmml">−</mo><mi id="alg1.l11.m1.2.2.2.2.2.1.1.3" xref="alg1.l11.m1.2.2.2.2.2.1.1.3.cmml">a</mi></mrow><mo id="alg1.l11.m1.2.2.2.2.2.1.3" stretchy="false" xref="alg1.l11.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2"><eq id="alg1.l11.m1.2.2.3.cmml" xref="alg1.l11.m1.2.2.3"></eq><ci id="alg1.l11.m1.2.2.4.cmml" xref="alg1.l11.m1.2.2.4">𝑟</ci><apply id="alg1.l11.m1.2.2.2.cmml" xref="alg1.l11.m1.2.2.2"><plus id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.3"></plus><apply id="alg1.l11.m1.2.2.2.4.cmml" xref="alg1.l11.m1.2.2.2.4"><times id="alg1.l11.m1.2.2.2.4.1.cmml" xref="alg1.l11.m1.2.2.2.4.1"></times><apply id="alg1.l11.m1.2.2.2.4.2.cmml" xref="alg1.l11.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.4.2.1.cmml" xref="alg1.l11.m1.2.2.2.4.2">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.4.2.2.cmml" xref="alg1.l11.m1.2.2.2.4.2.2">𝑟</ci><ci id="alg1.l11.m1.2.2.2.4.2.3.cmml" xref="alg1.l11.m1.2.2.2.4.2.3">𝑏</ci></apply><ci id="alg1.l11.m1.2.2.2.4.3.cmml" xref="alg1.l11.m1.2.2.2.4.3">𝑎</ci></apply><apply id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2"><times id="alg1.l11.m1.2.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.3"></times><apply id="alg1.l11.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1"><minus id="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1"></minus><apply id="alg1.l11.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.2.3">𝑏</ci></apply></apply><apply id="alg1.l11.m1.2.2.2.2.2.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.1"><minus id="alg1.l11.m1.2.2.2.2.2.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.2.1.1.1"></minus><cn id="alg1.l11.m1.2.2.2.2.2.1.1.2.cmml" type="integer" xref="alg1.l11.m1.2.2.2.2.2.1.1.2">1</cn><ci id="alg1.l11.m1.2.2.2.2.2.1.1.3.cmml" xref="alg1.l11.m1.2.2.2.2.2.1.1.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">r=r_{b}a+(-r_{b})(1-a)</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.2d">italic_r = italic_r start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT italic_a + ( - italic_r start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) ( 1 - italic_a )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>           <math alttext="L=L-r\log\pi^{\prime}_{\theta}(a|x,z)" class="ltx_Math" display="inline" id="alg1.l12.m1.3"><semantics id="alg1.l12.m1.3a"><mrow id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml"><mi id="alg1.l12.m1.3.3.3" xref="alg1.l12.m1.3.3.3.cmml">L</mi><mo id="alg1.l12.m1.3.3.2" xref="alg1.l12.m1.3.3.2.cmml">=</mo><mrow id="alg1.l12.m1.3.3.1" xref="alg1.l12.m1.3.3.1.cmml"><mi id="alg1.l12.m1.3.3.1.3" xref="alg1.l12.m1.3.3.1.3.cmml">L</mi><mo id="alg1.l12.m1.3.3.1.2" xref="alg1.l12.m1.3.3.1.2.cmml">−</mo><mrow id="alg1.l12.m1.3.3.1.1" xref="alg1.l12.m1.3.3.1.1.cmml"><mi id="alg1.l12.m1.3.3.1.1.3" xref="alg1.l12.m1.3.3.1.1.3.cmml">r</mi><mo id="alg1.l12.m1.3.3.1.1.2" lspace="0.167em" xref="alg1.l12.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="alg1.l12.m1.3.3.1.1.4" xref="alg1.l12.m1.3.3.1.1.4.cmml"><mi id="alg1.l12.m1.3.3.1.1.4.1" xref="alg1.l12.m1.3.3.1.1.4.1.cmml">log</mi><mo id="alg1.l12.m1.3.3.1.1.4a" lspace="0.167em" xref="alg1.l12.m1.3.3.1.1.4.cmml">⁡</mo><msubsup id="alg1.l12.m1.3.3.1.1.4.2" xref="alg1.l12.m1.3.3.1.1.4.2.cmml"><mi id="alg1.l12.m1.3.3.1.1.4.2.2.2" xref="alg1.l12.m1.3.3.1.1.4.2.2.2.cmml">π</mi><mi id="alg1.l12.m1.3.3.1.1.4.2.3" xref="alg1.l12.m1.3.3.1.1.4.2.3.cmml">θ</mi><mo id="alg1.l12.m1.3.3.1.1.4.2.2.3" xref="alg1.l12.m1.3.3.1.1.4.2.2.3.cmml">′</mo></msubsup></mrow><mo id="alg1.l12.m1.3.3.1.1.2a" xref="alg1.l12.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="alg1.l12.m1.3.3.1.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.1.cmml"><mo id="alg1.l12.m1.3.3.1.1.1.1.2" stretchy="false" xref="alg1.l12.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l12.m1.3.3.1.1.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.3.3.1.1.1.1.1.2" xref="alg1.l12.m1.3.3.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="alg1.l12.m1.3.3.1.1.1.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.1.1.cmml">|</mo><mrow id="alg1.l12.m1.3.3.1.1.1.1.1.3.2" xref="alg1.l12.m1.3.3.1.1.1.1.1.3.1.cmml"><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">x</mi><mo id="alg1.l12.m1.3.3.1.1.1.1.1.3.2.1" xref="alg1.l12.m1.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml">z</mi></mrow></mrow><mo id="alg1.l12.m1.3.3.1.1.1.1.3" stretchy="false" xref="alg1.l12.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.3b"><apply id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3"><eq id="alg1.l12.m1.3.3.2.cmml" xref="alg1.l12.m1.3.3.2"></eq><ci id="alg1.l12.m1.3.3.3.cmml" xref="alg1.l12.m1.3.3.3">𝐿</ci><apply id="alg1.l12.m1.3.3.1.cmml" xref="alg1.l12.m1.3.3.1"><minus id="alg1.l12.m1.3.3.1.2.cmml" xref="alg1.l12.m1.3.3.1.2"></minus><ci id="alg1.l12.m1.3.3.1.3.cmml" xref="alg1.l12.m1.3.3.1.3">𝐿</ci><apply id="alg1.l12.m1.3.3.1.1.cmml" xref="alg1.l12.m1.3.3.1.1"><times id="alg1.l12.m1.3.3.1.1.2.cmml" xref="alg1.l12.m1.3.3.1.1.2"></times><ci id="alg1.l12.m1.3.3.1.1.3.cmml" xref="alg1.l12.m1.3.3.1.1.3">𝑟</ci><apply id="alg1.l12.m1.3.3.1.1.4.cmml" xref="alg1.l12.m1.3.3.1.1.4"><log id="alg1.l12.m1.3.3.1.1.4.1.cmml" xref="alg1.l12.m1.3.3.1.1.4.1"></log><apply id="alg1.l12.m1.3.3.1.1.4.2.cmml" xref="alg1.l12.m1.3.3.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.1.1.4.2.1.cmml" xref="alg1.l12.m1.3.3.1.1.4.2">subscript</csymbol><apply id="alg1.l12.m1.3.3.1.1.4.2.2.cmml" xref="alg1.l12.m1.3.3.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.3.1.1.4.2.2.1.cmml" xref="alg1.l12.m1.3.3.1.1.4.2">superscript</csymbol><ci id="alg1.l12.m1.3.3.1.1.4.2.2.2.cmml" xref="alg1.l12.m1.3.3.1.1.4.2.2.2">𝜋</ci><ci id="alg1.l12.m1.3.3.1.1.4.2.2.3.cmml" xref="alg1.l12.m1.3.3.1.1.4.2.2.3">′</ci></apply><ci id="alg1.l12.m1.3.3.1.1.4.2.3.cmml" xref="alg1.l12.m1.3.3.1.1.4.2.3">𝜃</ci></apply></apply><apply id="alg1.l12.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="alg1.l12.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="alg1.l12.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.1.2">𝑎</ci><list id="alg1.l12.m1.3.3.1.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1.1.3.2"><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑥</ci><ci id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2">𝑧</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.3c">L=L-r\log\pi^{\prime}_{\theta}(a|x,z)</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.3d">italic_L = italic_L - italic_r roman_log italic_π start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_x , italic_z )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>           <math alttext="i=i+1" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">=</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><eq id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></eq><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑖</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><plus id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></plus><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝑖</ci><cn id="alg1.l13.m1.1.1.3.3.cmml" type="integer" xref="alg1.l13.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">i=i+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_i = italic_i + 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>           <math alttext="x\sim D" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">x</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">∼</mo><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><csymbol cd="latexml" id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">similar-to</csymbol><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑥</ci><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">x\sim D</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_x ∼ italic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>           <math alttext="z\sim\pi_{\theta}(x)(\text{wProb }\alpha),\sim\pi_{\theta explore}(x)(\text{%
wProb }\beta),\text{ or }\sim D(\text{wProb }1-\alpha-\beta)" class="ltx_math_unparsed" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1b"><mi id="alg1.l15.m1.1.2">z</mi><mo id="alg1.l15.m1.1.3">∼</mo><msub id="alg1.l15.m1.1.4"><mi id="alg1.l15.m1.1.4.2">π</mi><mi id="alg1.l15.m1.1.4.3">θ</mi></msub><mrow id="alg1.l15.m1.1.5"><mo id="alg1.l15.m1.1.5.1" stretchy="false">(</mo><mi id="alg1.l15.m1.1.1">x</mi><mo id="alg1.l15.m1.1.5.2" stretchy="false">)</mo></mrow><mrow id="alg1.l15.m1.1.6"><mo id="alg1.l15.m1.1.6.1" stretchy="false">(</mo><mtext id="alg1.l15.m1.1.6.2">wProb </mtext><mi id="alg1.l15.m1.1.6.3">α</mi><mo id="alg1.l15.m1.1.6.4" stretchy="false">)</mo></mrow><mo id="alg1.l15.m1.1.7">,</mo><mo id="alg1.l15.m1.1.8" lspace="0em">∼</mo><msub id="alg1.l15.m1.1.9"><mi id="alg1.l15.m1.1.9.2">π</mi><mrow id="alg1.l15.m1.1.9.3"><mi id="alg1.l15.m1.1.9.3.2">θ</mi><mo id="alg1.l15.m1.1.9.3.1">⁢</mo><mi id="alg1.l15.m1.1.9.3.3">e</mi><mo id="alg1.l15.m1.1.9.3.1a">⁢</mo><mi id="alg1.l15.m1.1.9.3.4">x</mi><mo id="alg1.l15.m1.1.9.3.1b">⁢</mo><mi id="alg1.l15.m1.1.9.3.5">p</mi><mo id="alg1.l15.m1.1.9.3.1c">⁢</mo><mi id="alg1.l15.m1.1.9.3.6">l</mi><mo id="alg1.l15.m1.1.9.3.1d">⁢</mo><mi id="alg1.l15.m1.1.9.3.7">o</mi><mo id="alg1.l15.m1.1.9.3.1e">⁢</mo><mi id="alg1.l15.m1.1.9.3.8">r</mi><mo id="alg1.l15.m1.1.9.3.1f">⁢</mo><mi id="alg1.l15.m1.1.9.3.9">e</mi></mrow></msub><mrow id="alg1.l15.m1.1.10"><mo id="alg1.l15.m1.1.10.1" stretchy="false">(</mo><mi id="alg1.l15.m1.1.10.2">x</mi><mo id="alg1.l15.m1.1.10.3" stretchy="false">)</mo></mrow><mrow id="alg1.l15.m1.1.11"><mo id="alg1.l15.m1.1.11.1" stretchy="false">(</mo><mtext id="alg1.l15.m1.1.11.2">wProb </mtext><mi id="alg1.l15.m1.1.11.3">β</mi><mo id="alg1.l15.m1.1.11.4" stretchy="false">)</mo></mrow><mo id="alg1.l15.m1.1.12">,</mo><mtext id="alg1.l15.m1.1.13"> or </mtext><mo id="alg1.l15.m1.1.14">∼</mo><mi id="alg1.l15.m1.1.15">D</mi><mrow id="alg1.l15.m1.1.16"><mo id="alg1.l15.m1.1.16.1" stretchy="false">(</mo><mtext id="alg1.l15.m1.1.16.2">wProb </mtext><mn id="alg1.l15.m1.1.16.3">1</mn><mo id="alg1.l15.m1.1.16.4">−</mo><mi id="alg1.l15.m1.1.16.5">α</mi><mo id="alg1.l15.m1.1.16.6">−</mo><mi id="alg1.l15.m1.1.16.7">β</mi><mo id="alg1.l15.m1.1.16.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">z\sim\pi_{\theta}(x)(\text{wProb }\alpha),\sim\pi_{\theta explore}(x)(\text{%
wProb }\beta),\text{ or }\sim D(\text{wProb }1-\alpha-\beta)</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_z ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) ( wProb italic_α ) , ∼ italic_π start_POSTSUBSCRIPT italic_θ italic_e italic_x italic_p italic_l italic_o italic_r italic_e end_POSTSUBSCRIPT ( italic_x ) ( wProb italic_β ) , or ∼ italic_D ( wProb 1 - italic_α - italic_β )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>        <span class="ltx_text ltx_font_bold" id="alg1.l16.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l16.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span>        <math alttext="\theta=\theta-\eta\nabla L" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">θ</mi><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">=</mo><mrow id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">θ</mi><mo id="alg1.l17.m1.1.1.3.1" xref="alg1.l17.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml"><mi id="alg1.l17.m1.1.1.3.3.2" xref="alg1.l17.m1.1.1.3.3.2.cmml">η</mi><mo id="alg1.l17.m1.1.1.3.3.1" lspace="0.167em" xref="alg1.l17.m1.1.1.3.3.1.cmml">⁢</mo><mrow id="alg1.l17.m1.1.1.3.3.3" xref="alg1.l17.m1.1.1.3.3.3.cmml"><mo id="alg1.l17.m1.1.1.3.3.3.1" rspace="0.167em" xref="alg1.l17.m1.1.1.3.3.3.1.cmml">∇</mo><mi id="alg1.l17.m1.1.1.3.3.3.2" xref="alg1.l17.m1.1.1.3.3.3.2.cmml">L</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><eq id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></eq><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝜃</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><minus id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3.1"></minus><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝜃</ci><apply id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3"><times id="alg1.l17.m1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3.1"></times><ci id="alg1.l17.m1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.2">𝜂</ci><apply id="alg1.l17.m1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.3.3.3"><ci id="alg1.l17.m1.1.1.3.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3.3.1">∇</ci><ci id="alg1.l17.m1.1.1.3.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.3.2">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\theta=\theta-\eta\nabla L</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_θ = italic_θ - italic_η ∇ italic_L</annotation></semantics></math> // Can use any gradient optimizer

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l18.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l18.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l19.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l19.3">for</span>
</div>
</div>
<br class="ltx_break ltx_break"/>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Evaluation</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We evaluate PG-Ret on increasing novelty of the top-k items of a retrieval model compared to an existing model’s output.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Setup: Datasets, Metrics, and Baselines</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Setup.</span>
We consider the production setup for a recommendation system, wherein there is an existing retrieval algorithm in production. We call this model the <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.2">base</span> model. Typically, this model is trained on millions of query-item clicked pairs collected from log data. We assume access to a small amount of new training data (e.g., query-item pairs collected from log data after the base model has been deployed) and evaluate different ways to produce a new retrieval model with high novelty compared to the base model. We consider an independent test set for evaluation. As in prior work <cite class="ltx_cite ltx_citemacro_citep">(Dahiya et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib5" title="">2021</a>)</cite>, the candidate pool of items remains the same across train and test datasets, typically of the order of millions of items. 
<br class="ltx_break"/></p>
</div>
<figure class="ltx_table" id="S5.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.2.1">Train inputs</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.3.1">Test inputs</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.4.1"># Actions</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.1.2.1.1">Query-Keyword</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.2">1.23M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.3">6.2K</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.4">33.2M</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T1.1.3.2.1">ORCAS</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.3.2.2">1M</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.3.2.3">8.5K</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.3.2.4">1.07M</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics for the Query-Keyword datasets from a commercial search engine and the public ORCAS dataset.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Datasets. </span> On the query-document matching task, we use a dataset from a commercial search engine and a public dataset (see Table <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.T1" title="Table 1 ‣ 5.1. Setup: Datasets, Metrics, and Baselines ‣ 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a>). We also use a Amazon dataset for product recommendation.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Query-keyword recommendation</span>. This dataset contains queries and ad keywords from a commercial search engine’s logs. Given a query, the goal is to predict ad keywords that share the same intent or a more general intent than the query (i.e., <span class="ltx_text ltx_font_italic" id="S5.I1.i1.p1.1.2">‘phrase match’</span>). The base model is a 4-layer bi-encoder model that has been finetuned with contrastive loss on more than 20M query-keyword pairs. The training data consists of 1M new query-item pairs, along with a candidate pool of over 33 million items.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">ORCAS</span> <cite class="ltx_cite ltx_citemacro_citep">(Craswell et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib4" title="">2020</a>)</cite>. This public dataset contains clicked webpages from Bing for queries from the TREC deep learning challenge. For our evaluation, we consider the search query as the user input and the webpage title as the item. We filter the dataset to remove click data where either the query or the webpage title are empty. The dataset contains 17.5 million query-webpage pairs. To simulate a production setup, we utilize the majority (16.5M) of the dataset for training a supervised model, that acts as the base model. The base model is initialized with SimCSE <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib9" title="">2021</a>)</cite> and trained for 5 epochs. The remaining 1M are used as <span class="ltx_text ltx_font_italic" id="S5.I1.i2.p1.1.2">new</span> training data for optimizing novelty. We also reserve a separate, randomly sampled test set consisting of 8.5K query-keyword pairs.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">AmazonReviews</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib19" title="">2023</a>)</cite>. This dataset contains users’ product review histories on Amazon. Based on a user’s previous reviews, the goal is to predict the next product that they would review. <cite class="ltx_cite ltx_citemacro_citet">Li et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib19" title="">2023</a>)</cite> convert it to text-based problem by represent items as a text sequence using their metadata (e.g., “Title: Philips motor Category: Home Appliances Color: Black”). Users are represented as a text concatenation of each item in their profile. For our experiments, we consider the <span class="ltx_text ltx_font_italic" id="S5.I1.i3.p1.1.2">Industrial &amp; Scientific</span> domain consisting of over 11K user histories and 5K products. <cite class="ltx_cite ltx_citemacro_citet">Li et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib19" title="">2023</a>)</cite> sort each user’s history by time and break it down into a train set, validation set (second-last product), and a test set (most recent product in the history). We use the train set for training the base model, which is initialized with the pre-trained <span class="ltx_text ltx_font_italic" id="S5.I1.i3.p1.1.3">RecFormer</span> model from <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib19" title="">2023</a>)</cite>. To simulate the production scenario where users review additional items over time, we use augmented review history for finetuning novelty models that includes both the train and validation set products (<span class="ltx_text ltx_font_italic" id="S5.I1.i3.p1.1.4">Finetuning</span> dataset). In both cases, the test set remains identical and we ensure that the test set is never used during training (since the finetuning stage does not have a validation set for early stopping; we train models for a fixed number of epochs).</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.2.1">Novelty@50</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.3.1">Novelty@100</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.4.1">Novelty@200</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.5.1">Recall@100</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T2.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.6.1">Recall@200</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.7"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.7.1">Precision@3</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.1.2.1.1">Base Model</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.3">–</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.1.4">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.5">45.0</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.1.6">54.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.7">63.7</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.3.2.1">Supervised Finetuning</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.2">6.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.3">22.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.3.2.4">79.1</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.2.5.1">49.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.3.2.6">53.5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.7">65.5</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.4.3.1">PG-Ret (Conservative)</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.2"><span class="ltx_text" id="S5.T2.1.4.3.2.1">14.5</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.3">39.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.3.4">107.8</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.5"><span class="ltx_text" id="S5.T2.1.4.3.5.1">46.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.3.6"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.3.6.1">56.4</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.7"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.3.7.1">70.0</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T2.1.5.4.1">PG-Ret (Aggressive)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.5.4.2.1">32.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.5.4.3.1">70.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.5.4.4.1">151.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.5">27.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.1.5.4.6">37.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.7">51.8</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Novelty, recall and precision for PG-Ret compared to supervised finetuning. PG-Ret (Conservative) obtains substantially high novelty with equal or better precision. PG-Ret (Aggressive) provides even higher novelty but with reduced accuracy. </figcaption>
</figure>
<figure class="ltx_table" id="S5.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T3.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.1.1.1.1">
<span class="ltx_p" id="S5.T3.1.1.1.1.1.1" style="width:104.1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.1.1.1.1" style="font-size:90%;">Query</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T3.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.1.1.2.1">
<span class="ltx_p" id="S5.T3.1.1.1.2.1.1" style="width:143.1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.2.1.1.1" style="font-size:90%;">Top-5 Ad Keywords (Base Model)</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.1.1.3.1">
<span class="ltx_p" id="S5.T3.1.1.1.3.1.1" style="width:143.1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.3.1.1.1" style="font-size:90%;">Top-5 Ad Keywords (PG-Ret (Conservative))</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.1.2.1.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.2.1.1.1">
<span class="ltx_p" id="S5.T3.1.2.1.1.1.1" style="width:104.1pt;"><span class="ltx_text" id="S5.T3.1.2.1.1.1.1.1" style="font-size:90%;">tankless water heater electric home depot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.2.1.2.1">
<span class="ltx_p" id="S5.T3.1.2.1.2.1.1" style="width:143.1pt;"><span class="ltx_text" id="S5.T3.1.2.1.2.1.1.1" style="font-size:90%;">home depot tankless water heater</span></span>
<span class="ltx_p" id="S5.T3.1.2.1.2.1.2"><span class="ltx_text" id="S5.T3.1.2.1.2.1.2.1" style="font-size:90%;">residential electric tankless water heater</span></span>
<span class="ltx_p" id="S5.T3.1.2.1.2.1.3"><span class="ltx_text" id="S5.T3.1.2.1.2.1.3.1" style="font-size:90%;">electrical tankless water heater</span></span>
<span class="ltx_p" id="S5.T3.1.2.1.2.1.4"><span class="ltx_text" id="S5.T3.1.2.1.2.1.4.1" style="font-size:90%;">electric tankless water heater</span></span>
<span class="ltx_p" id="S5.T3.1.2.1.2.1.5"><span class="ltx_text" id="S5.T3.1.2.1.2.1.5.1" style="font-size:90%;">water heater electric tankless</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.1.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.2.1.3.1">
<span class="ltx_p" id="S5.T3.1.2.1.3.1.1" style="width:143.1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.3.1.1.1" style="font-size:90%;">instant water heater electric</span><span class="ltx_text" id="S5.T3.1.2.1.3.1.1.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.2.1.3.1.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.3.1.2.1" style="font-size:90%;">instant electric water heater</span><span class="ltx_text" id="S5.T3.1.2.1.3.1.2.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.2.1.3.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.3.1.3.1" style="font-size:90%;">domestic electrical appliances</span><span class="ltx_text" id="S5.T3.1.2.1.3.1.3.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.2.1.3.1.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.3.1.4.1" style="font-size:90%;">instant water heaters electric</span><span class="ltx_text" id="S5.T3.1.2.1.3.1.4.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.2.1.3.1.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.2.1.3.1.5.1" style="font-size:90%;">instant electric water heaters</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.1.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.3.2.1.1">
<span class="ltx_p" id="S5.T3.1.3.2.1.1.1" style="width:104.1pt;"><span class="ltx_text" id="S5.T3.1.3.2.1.1.1.1" style="font-size:90%;">file management pc</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.3.2.2.1">
<span class="ltx_p" id="S5.T3.1.3.2.2.1.1" style="width:143.1pt;"><span class="ltx_text" id="S5.T3.1.3.2.2.1.1.1" style="font-size:90%;">computer file management</span></span>
<span class="ltx_p" id="S5.T3.1.3.2.2.1.2"><span class="ltx_text" id="S5.T3.1.3.2.2.1.2.1" style="font-size:90%;">file management in windows</span></span>
<span class="ltx_p" id="S5.T3.1.3.2.2.1.3"><span class="ltx_text" id="S5.T3.1.3.2.2.1.3.1" style="font-size:90%;">file management</span></span>
<span class="ltx_p" id="S5.T3.1.3.2.2.1.4"><span class="ltx_text" id="S5.T3.1.3.2.2.1.4.1" style="font-size:90%;">file management software</span></span>
<span class="ltx_p" id="S5.T3.1.3.2.2.1.5"><span class="ltx_text" id="S5.T3.1.3.2.2.1.5.1" style="font-size:90%;">file management system</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.1.3.2.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.3.2.3.1">
<span class="ltx_p" id="S5.T3.1.3.2.3.1.1" style="width:143.1pt;"><span class="ltx_text" id="S5.T3.1.3.2.3.1.1.1" style="font-size:90%;">computer file management</span></span>
<span class="ltx_p" id="S5.T3.1.3.2.3.1.2"><span class="ltx_text" id="S5.T3.1.3.2.3.1.2.1" style="font-size:90%;">files management software</span></span>
<span class="ltx_p" id="S5.T3.1.3.2.3.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.2.3.1.3.1" style="font-size:90%;">software to organize files</span><span class="ltx_text" id="S5.T3.1.3.2.3.1.3.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.3.2.3.1.4"><span class="ltx_text" id="S5.T3.1.3.2.3.1.4.1" style="font-size:90%;">file management software</span></span>
<span class="ltx_p" id="S5.T3.1.3.2.3.1.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.2.3.1.5.1" style="font-size:90%;">files software</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.1.4.3.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.4.3.1.1">
<span class="ltx_p" id="S5.T3.1.4.3.1.1.1" style="width:104.1pt;"><span class="ltx_text" id="S5.T3.1.4.3.1.1.1.1" style="font-size:90%;">hayan sunrise senior living</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S5.T3.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.4.3.2.1">
<span class="ltx_p" id="S5.T3.1.4.3.2.1.1" style="width:143.1pt;"><span class="ltx_text" id="S5.T3.1.4.3.2.1.1.1" style="font-size:90%;">sunrise senior living home</span></span>
<span class="ltx_p" id="S5.T3.1.4.3.2.1.2"><span class="ltx_text" id="S5.T3.1.4.3.2.1.2.1" style="font-size:90%;">sunrise seniors living</span></span>
<span class="ltx_p" id="S5.T3.1.4.3.2.1.3"><span class="ltx_text" id="S5.T3.1.4.3.2.1.3.1" style="font-size:90%;">sunrise senior living wheaton il</span></span>
<span class="ltx_p" id="S5.T3.1.4.3.2.1.4"><span class="ltx_text" id="S5.T3.1.4.3.2.1.4.1" style="font-size:90%;">sunrise senior care living</span></span>
<span class="ltx_p" id="S5.T3.1.4.3.2.1.5"><span class="ltx_text" id="S5.T3.1.4.3.2.1.5.1" style="font-size:90%;">who owns sunrise senior living</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S5.T3.1.4.3.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.4.3.3.1">
<span class="ltx_p" id="S5.T3.1.4.3.3.1.1" style="width:143.1pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.3.3.1.1.1" style="font-size:90%;">living facilities for seniors</span><span class="ltx_text" id="S5.T3.1.4.3.3.1.1.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.4.3.3.1.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.3.3.1.2.1" style="font-size:90%;">senior living facilities</span><span class="ltx_text" id="S5.T3.1.4.3.3.1.2.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.4.3.3.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.3.3.1.3.1" style="font-size:90%;">elder living</span><span class="ltx_text" id="S5.T3.1.4.3.3.1.3.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.4.3.3.1.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.3.3.1.4.1" style="font-size:90%;">elderly living</span><span class="ltx_text" id="S5.T3.1.4.3.3.1.4.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.4.3.3.1.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.3.3.1.5.1" style="font-size:90%;">elderly living facilities</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S5.T3.1.5.4.1">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.5.4.1.1">
<span class="ltx_p" id="S5.T3.1.5.4.1.1.1" style="width:104.1pt;"><span class="ltx_text" id="S5.T3.1.5.4.1.1.1.1" style="font-size:90%;">can i finance my child’s college with a home equity loan</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="S5.T3.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.5.4.2.1">
<span class="ltx_p" id="S5.T3.1.5.4.2.1.1" style="width:143.1pt;"><span class="ltx_text" id="S5.T3.1.5.4.2.1.1.1" style="font-size:90%;">home equity loan years</span></span>
<span class="ltx_p" id="S5.T3.1.5.4.2.1.2"><span class="ltx_text" id="S5.T3.1.5.4.2.1.2.1" style="font-size:90%;">dcu home equity loan</span></span>
<span class="ltx_p" id="S5.T3.1.5.4.2.1.3"><span class="ltx_text" id="S5.T3.1.5.4.2.1.3.1" style="font-size:90%;">home equity financing</span></span>
<span class="ltx_p" id="S5.T3.1.5.4.2.1.4"><span class="ltx_text" id="S5.T3.1.5.4.2.1.4.1" style="font-size:90%;">10 year home equity loan</span></span>
<span class="ltx_p" id="S5.T3.1.5.4.2.1.5"><span class="ltx_text" id="S5.T3.1.5.4.2.1.5.1" style="font-size:90%;">home equity loan in texas</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="S5.T3.1.5.4.3">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.5.4.3.1">
<span class="ltx_p" id="S5.T3.1.5.4.3.1.1" style="width:143.1pt;"><span class="ltx_text" id="S5.T3.1.5.4.3.1.1.1" style="font-size:90%;">home equality loans</span></span>
<span class="ltx_p" id="S5.T3.1.5.4.3.1.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.4.3.1.2.1" style="font-size:90%;">educational financing</span><span class="ltx_text" id="S5.T3.1.5.4.3.1.2.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.5.4.3.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.4.3.1.3.1" style="font-size:90%;">household finance</span><span class="ltx_text" id="S5.T3.1.5.4.3.1.3.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.5.4.3.1.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.4.3.1.4.1" style="font-size:90%;">home equity laons</span><span class="ltx_text" id="S5.T3.1.5.4.3.1.4.2" style="font-size:90%;"></span></span>
<span class="ltx_p" id="S5.T3.1.5.4.3.1.5"><span class="ltx_text" id="S5.T3.1.5.4.3.1.5.1" style="font-size:90%;">home equity laon</span></span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3. </span>Example predictions from base model and PG-Ret. Bolded items are novel compared to top-200 from the base model.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">Relevance Feedback.</span> For all datasets, we use GPT-3.5 as the reward model for providing relevance feedback during training. For the first dataset where the goal is produce keywords with more general intent than the query, we use the prompt,</p>
</div>
<div class="ltx_para" id="S5.SS1.p5">
<blockquote class="ltx_quote" id="S5.SS1.p5.1">
<p class="ltx_p" id="S5.SS1.p5.1.1"><span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.1.1">Given the query ”</span>{<span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.1.2">Query</span>}<span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.1.3">”, is the following query expressing a similar but more general intent, “</span>{<span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.1.4">Keyword</span>}<span class="ltx_text ltx_font_italic" id="S5.SS1.p5.1.1.5">”? Please answer in a single word: Yes/No.</span></p>
</blockquote>
</div>
<div class="ltx_para" id="S5.SS1.p6">
<p class="ltx_p" id="S5.SS1.p6.3">For the ORCAS dataset where the goal is to predict the top search result titles, we use the prompt,</p>
<blockquote class="ltx_quote" id="S5.SS1.p6.4">
<p class="ltx_p" id="S5.SS1.p6.4.1"><span class="ltx_text ltx_font_italic" id="S5.SS1.p6.4.1.1">Given the query, “</span>{<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.4.1.2">Query</span>}<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.4.1.3">”, is it possible that the document titled, “</span>{<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.4.1.4">WebPageTitle</span>}<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.4.1.5">”, is relevant for the userś intent. Please answer in a single word: Yes/No.</span></p>
</blockquote>
<p class="ltx_p" id="S5.SS1.p6.5">The system prompt is the same in both cases, <span class="ltx_text ltx_font_italic" id="S5.SS1.p6.5.1">“You are an expert in understanding user intent from search engine queries.”</span>.
For the AmazonReviews dataset, we use the system prompt, <span class="ltx_text ltx_font_italic" id="S5.SS1.p6.5.2">“You are an expert in understanding user interests from Amazon.com product browsing data.”</span>. The user prompt is given by,</p>
<blockquote class="ltx_quote" id="S5.SS1.p6.2">
<p class="ltx_p" id="S5.SS1.p6.2.3"><span class="ltx_text ltx_font_italic" id="S5.SS1.p6.2.3.1">A user is browsing Amazon.com for the following products:
<br class="ltx_break"/></span>{<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.2.3.2">ListOfProducts</span>}<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.2.3.3">
<br class="ltx_break"/>
<br class="ltx_break"/>Is this a relevant product that targets the same scientific interest?
<br class="ltx_break"/>Recommendation: </span>{<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.2.3.4">CandidateProduct</span>}<span class="ltx_text ltx_font_italic" id="S5.SS1.p6.2.3.5">
<br class="ltx_break"/></span></p>
<p class="ltx_p" id="S5.SS1.p6.2.2"><span class="ltx_text ltx_font_italic" id="S5.SS1.p6.2.2.2">Provide a brief reasoning and then the final answer within “<math alttext="\langle" class="ltx_Math" display="inline" id="S5.SS1.p6.1.1.1.m1.1"><semantics id="S5.SS1.p6.1.1.1.m1.1a"><mo id="S5.SS1.p6.1.1.1.m1.1.1" stretchy="false" xref="S5.SS1.p6.1.1.1.m1.1.1.cmml">⟨</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.1.1.m1.1b"><ci id="S5.SS1.p6.1.1.1.m1.1.1.cmml" xref="S5.SS1.p6.1.1.1.m1.1.1">⟨</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.1.1.1.m1.1c">\langle</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.1.1.1.m1.1d">⟨</annotation></semantics></math>Yes/No<math alttext="\rangle" class="ltx_Math" display="inline" id="S5.SS1.p6.2.2.2.m2.1"><semantics id="S5.SS1.p6.2.2.2.m2.1a"><mo id="S5.SS1.p6.2.2.2.m2.1.1" stretchy="false" xref="S5.SS1.p6.2.2.2.m2.1.1.cmml">⟩</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.2.2.2.m2.1b"><ci id="S5.SS1.p6.2.2.2.m2.1.1.cmml" xref="S5.SS1.p6.2.2.2.m2.1.1">⟩</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.2.2.2.m2.1c">\rangle</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.2.2.2.m2.1d">⟩</annotation></semantics></math>” tag.</span></p>
</blockquote>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p7">
<p class="ltx_p" id="S5.SS1.p7.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p7.1.1">Metrics.</span> We evaluate PG-Ret on the following offline metrics.</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">Novelty@k</span>: Novelty of top-k items compared to the base model, as defined in Definition <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Thmtheorem1" title="Definition 1. ‣ 3.1. Problem statement: Novelty optimization ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a>. For the query-keyword dataset, we use L=200 for the base model since each retrieval model sends roughly 200 keywords to the downstream ranking layer. For ORCAS and AmazonReviews dataset, we use L=50 since we observe that the relevance of predicted items decreases significantly beyond 50 items.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">Recall@k</span> is the number of clicked &lt;query, item&gt;pairs from test data that are in the top-k predictions. As novelty is optimized, recall over the top-k items should not decrease substantially.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i3.p1.1.1">Precision@k</span>: While recall is an important metric, it is dependent on the available clicks in the test data for each query. It is possible that a model makes relevant predictions but they are not counted since those &lt;query, item&gt;pairs do not exist in the test data. Hence, we use an advanced LLM, GPT-4 as the relevance evaluator for top-k items. Note that we use a different LLM for evaluation than the one used in training because 1) A more capable model like GPT-4 can provide more reliable relevance feedback; 2) using a different model ensures fairness of evaluation when compared to other baselines. Moreover, we use standardized prompts that are used in the production system for evaluating retrieval models. For each task, these prompts have been validated against human-labelled data and they achieve more than 85% accuracy, thus serving as a reliable approximation of human feedback.
The first task uses a prompt tuned for estimating phrase-match relevance of keyword and the second task uses a prompt tuned for estimating the general relevance of a query and a webpage title.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.SS1.p7.2">In addition, we evaluate PG-Ret using an A/B experiment for the first task of matching query to relevant ad keywords.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p8">
<p class="ltx_p" id="S5.SS1.p8.2"><span class="ltx_text ltx_font_bold" id="S5.SS1.p8.2.1">Baselines. </span> For each dataset, we compare PG-Ret to a supervised model initialized with the base model and trained on the same training data using the InfoNCE loss with random negatives (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Ex1" title="3.1. Problem statement: Novelty optimization ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3.1</span></a>).
All models are trained using Adam optimizer with a learning rate of <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S5.SS1.p8.1.m1.1"><semantics id="S5.SS1.p8.1.m1.1a"><msup id="S5.SS1.p8.1.m1.1.1" xref="S5.SS1.p8.1.m1.1.1.cmml"><mn id="S5.SS1.p8.1.m1.1.1.2" xref="S5.SS1.p8.1.m1.1.1.2.cmml">10</mn><mrow id="S5.SS1.p8.1.m1.1.1.3" xref="S5.SS1.p8.1.m1.1.1.3.cmml"><mo id="S5.SS1.p8.1.m1.1.1.3a" xref="S5.SS1.p8.1.m1.1.1.3.cmml">−</mo><mn id="S5.SS1.p8.1.m1.1.1.3.2" xref="S5.SS1.p8.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.p8.1.m1.1b"><apply id="S5.SS1.p8.1.m1.1.1.cmml" xref="S5.SS1.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p8.1.m1.1.1.1.cmml" xref="S5.SS1.p8.1.m1.1.1">superscript</csymbol><cn id="S5.SS1.p8.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.p8.1.m1.1.1.2">10</cn><apply id="S5.SS1.p8.1.m1.1.1.3.cmml" xref="S5.SS1.p8.1.m1.1.1.3"><minus id="S5.SS1.p8.1.m1.1.1.3.1.cmml" xref="S5.SS1.p8.1.m1.1.1.3"></minus><cn id="S5.SS1.p8.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS1.p8.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p8.1.m1.1c">10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p8.1.m1.1d">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> and batch size of 128. PG-Ret (Aggressive) uses <math alttext="M=5" class="ltx_Math" display="inline" id="S5.SS1.p8.2.m2.1"><semantics id="S5.SS1.p8.2.m2.1a"><mrow id="S5.SS1.p8.2.m2.1.1" xref="S5.SS1.p8.2.m2.1.1.cmml"><mi id="S5.SS1.p8.2.m2.1.1.2" xref="S5.SS1.p8.2.m2.1.1.2.cmml">M</mi><mo id="S5.SS1.p8.2.m2.1.1.1" xref="S5.SS1.p8.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p8.2.m2.1.1.3" xref="S5.SS1.p8.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p8.2.m2.1b"><apply id="S5.SS1.p8.2.m2.1.1.cmml" xref="S5.SS1.p8.2.m2.1.1"><eq id="S5.SS1.p8.2.m2.1.1.1.cmml" xref="S5.SS1.p8.2.m2.1.1.1"></eq><ci id="S5.SS1.p8.2.m2.1.1.2.cmml" xref="S5.SS1.p8.2.m2.1.1.2">𝑀</ci><cn id="S5.SS1.p8.2.m2.1.1.3.cmml" type="integer" xref="S5.SS1.p8.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p8.2.m2.1c">M=5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p8.2.m2.1d">italic_M = 5</annotation></semantics></math>. For the AmazonReviews dataset, we use the same hyperparameters as in <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib19" title="">2023</a>)</cite>.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.2.1">Novelty@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.3.1">Novelty@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.4.1">Novelty@50</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.5.1">Recall@50</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.6.1">Precision@1</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.1.2.1.1">Base Pretrained Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.3">–</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.2.1.4">–</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.2.1.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.2.1.5.1">81.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.6"><span class="ltx_text ltx_font_bold" id="S5.T4.1.2.1.6.1">70.0</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.1.3.2.1">Supervised Finetuning (3 epochs)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.2">0.007</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.3">0.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.3.2.4">0.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.3.2.5">79.7</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.6">69.9</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.1.4.3.1">Supervised Finetuning (10 epochs)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.2">0.07</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.3">0.33</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.4.3.4">2.82</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.4.3.5">78.7</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.6">68.4</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.1.5.4.1">PG-Ret (Conservative)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.4.2">0.17</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.4.3">0.47</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.5.4.4">2.64</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.5.4.5">79.8</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.5.4.6">68.7</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.6.5">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T4.1.6.5.1">PG-Ret (Aggressive)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.5.2.1">0.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.5.3.1">0.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T4.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.6.5.4.1">4.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T4.1.6.5.5">78.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.6.5.6">67.9</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Novelty, Recall and Precision on ORCAS. PG-Ret obtains substantial gains in novelty with minimal accuracy drop.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Query-keyword recommendation task</h3>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Novelty. </h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px1.p1.1">For the query-keyword dataset, the goal is to increase the novelty of policy’s recommendations. For training PG-Ret, we use the reward from Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.E7" title="In 4.1. Reduction from Top-k to item-wise rewards ‣ 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">7</span></a>. The results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.T2" title="Table 2 ‣ 5.1. Setup: Datasets, Metrics, and Baselines ‣ 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">2</span></a>.
Compared to supervised finetuning on the same training set, PG-Ret leads to 2X-5X gains in novel keywords in top-50. In top-200, PG-Ret (Conservative) and PG-Ret (Aggressive) obtain 108 and 152 novel keywords respectively compared to 79 from the supervised finetuned model. At the same time, recall of PG-Ret (Conservative) is almost the same as the base model. In fact, recall@200 is slighly higher than the base model. To check the quality of the PG-Ret models, we also evaluate precision@3 as evaluated by GPT-4. While we would expect the precision to decrease due to the novelty loss, we find that PG-Ret (Conservative) has a substantially higher precision than the base model. This may be possible because the novelty loss can encourage the model to move away from local minima and sometimes find a more optimal solution. In comparison, PG-Ret (Aggressive) suffers a significant drop in both recall and precision, indicating that novelty optimization has led to a decrease in the model’s accuracy. The offline results indicate that PG-Ret (Conservative) is a good balance between novelty and accuracy.</p>
</div>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S5.SS2.SSS0.Px1.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.T3" title="Table 3 ‣ 5.1. Setup: Datasets, Metrics, and Baselines ‣ 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">3</span></a> shows qualitative results for a sample of the queries where PG-Ret led to novel keywords in the top-5 predictions. The base model tends to match keywords based on lexical overlap wheareas PG-Ret is able to find rephrases with the same meaning.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.2.1">Novelty@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.3.1">Novelty@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T5.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.4.1">Novelty@50</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.5.1">Recall@50</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.2.1.1">Base Pretrained Model</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.2">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.3">–</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.1.2.1.4">–</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.5">21.9</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T5.1.3.2.1">Supervised Finetuning</th>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.2">1.9</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.3">5.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.3.2.4">24.4</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S5.T5.1.3.2.5.1">22.6</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T5.1.4.3.1">PG-Ret (Conservative)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.4.3.2.1">3.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.3"><span class="ltx_text ltx_font_bold" id="S5.T5.1.4.3.3.1">9.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T5.1.4.3.4"><span class="ltx_text ltx_font_bold" id="S5.T5.1.4.3.4.1">32.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.5">22.4</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5. </span>Novelty and Recall on the AmazonReviews dataset. Compared to supervised finetuning, PG-Ret obtains substantial gains in novelty with almost the same recall.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">A/B test. </h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px2.p1.3">Finally, we evaluate PG-Ret (Conservative) on real user traffic using an A/B experiment over a 10 day period. As mentioned before, the retrieval system is engineered such that keywords from a new algorithm (e.g., PG-Ret) are selected for downstream ranking layer (which in turn, may lead to user impressions) only if they are novel compared to the existing algorithm. By including PG-Ret in the retrieval pipeline, we observe a <math alttext="1" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S5.SS2.SSS0.Px2.p1.1.m1.1a"><mn id="S5.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.1.m1.1b"><cn id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px2.p1.1.m1.1d">1</annotation></semantics></math>% increase in query-ad matching density, the average number of relevant ads selected per query (as determined by the downstream ranker). We also observe a <math alttext="0.14" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S5.SS2.SSS0.Px2.p1.2.m2.1a"><mn id="S5.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">0.14</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.2.m2.1b"><cn id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" type="float" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1">0.14</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.2.m2.1c">0.14</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px2.p1.2.m2.1d">0.14</annotation></semantics></math>% increase in coverage, the fraction of queries for which relevant ads are shown to users. This indicates that the novelty optimization can help to match ads to the queries that other algos are not able to match relevant ads with. Finally, we also observe a 0.26% increase in click yield, the number
of ad clicks per search query, indicating the new keywords recommended by the novelty optimization are well received by the real-world users. While the absolute number may look small,
an increase of <math alttext="0.26\%" class="ltx_Math" display="inline" id="S5.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S5.SS2.SSS0.Px2.p1.3.m3.1a"><mrow id="S5.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mn id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml">0.26</mn><mo id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.1" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.1">percent</csymbol><cn id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" type="float" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2">0.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.3.m3.1c">0.26\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS0.Px2.p1.3.m3.1d">0.26 %</annotation></semantics></math> can lead to a substantial impact when scaled to millions of users.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>ORCAS: Query-webpage matching</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">To simulate the production setting, we train a supervised model on over 16M &lt;query, webpage title&gt;pairs as the <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.1">base</span> model. Our goal is to produce top-k webpages that are novel wrt. top-50 webpages predicted by the base model, using a training set of 1M pairs. We first use the InfoNCE loss to finetune the base model over the 1M training dataset (Supervised Finetuning). PG-Ret model is finetuned using our proposed method using the base model as the initialization.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.T4" title="Table 4 ‣ 5.1. Setup: Datasets, Metrics, and Baselines ‣ 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results. We report results for two supervised finetuning models (epochs 3 and 10). In both models, the recall and precision decreases compared to base model, indicating that the 1M train set may lead to overfitting. PG-Ret (Conservative) also leads to a drop in recall but the corresponding novelty is significantly higher than that of a supervised model with similar recall. At comparable recall, PG-Ret (Conservative) obtains Novelty@50 of 2.64 compared to 0.65 for the supervised model (3 epochs). Overall, PG-Ret (Aggressive) obtains the highest novelty—on average, there are <math alttext="4.03" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mn id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">4.03</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><cn id="S5.SS3.p2.1.m1.1.1.cmml" type="float" xref="S5.SS3.p2.1.m1.1.1">4.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">4.03</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">4.03</annotation></semantics></math> webpages in top-50 predictions of PG-Ret (Conservative) that did not exist in top-50 predictions of the base model. The novelty is significantly higher than a supervised model (2.82, 10 epochs) with similar recall. Recall and precision of PG-Ret models decrease slightly (up to 3%) compared to base model, which can be a reasonable tradeoff given the gains in novelty.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Amazon: User-Product recommendation</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S5.T5" title="Table 5 ‣ Novelty. ‣ 5.2. Query-keyword recommendation task ‣ 5. Evaluation ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">5</span></a> shows the novelty and recall metrics for the AmazonReviews dataset. Both Supervised Finetuning and PG-Ret models are initialized with the base pretrained RecFormer model and trained on the finetuning set.
Since these models are trained on an additional recent product from the user’s history, both models obtain slighly higher recall than the base model. However, at the same recall, novelty of the PG-Ret (Conservative) model is significantly higher than the supervised model. On average, PG-Ret recommends 3.6 products in its top-10 list that are novel wrt. the top-50 recommendations from the base model, compared to 1.9 novel products for the supervised model. As in the previous datasets, PG-Ret leads to improved novelty while incurring a minimal loss in recall compared to the supervised model.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We presented a technique to optimize a non-differentiable, task-specific loss in information retrieval applications. We justified the binary-action formulation of the problem through theoretical and empirical results. On empirical recommendation datasets, the proposed technique leads to substantial gains in novelty of top-k items.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">While we used the simple REINFORCE-based RL algorithm, future work can consider Actor-critic or proximal policy optimization algorithms for optimizing novelty and how they can be extended to large action spaces. Exploring robust reward functions in the presence of noisy LLM feedback is also an important future direction.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arora et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Daman Arora, Anush Kini, Sayak Ray Chowdhury, Nagarajan Natarajan, Gaurav Sinha, and Amit Sharma. 2023.

</span>
<span class="ltx_bibblock">GAR-meets-RAG Paradigm for Zero-Shot Information Retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">arXiv preprint arXiv:2310.20158</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Minmin Chen, Alex Beutel, Paul Covington, Sagar Jain, Francois Belletti, and Ed H Chi. 2019.

</span>
<span class="ltx_bibblock">Top-k off-policy correction for a REINFORCE recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining</em>. 456–464.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Craswell et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Nick Craswell, Daniel Campos, Bhaskar Mitra, Emine Yilmaz, and Bodo Billerbeck. 2020.

</span>
<span class="ltx_bibblock">ORCAS: 20 million clicked query-document pairs for analyzing search. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em>. 2983–2989.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dahiya et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Kunal Dahiya, Ananye Agarwal, Deepak Saini, K Gururaj, Jian Jiao, Amit Singh, Sumeet Agarwal, Purushottam Kar, and Manik Varma. 2021.

</span>
<span class="ltx_bibblock">Siamesexml: Siamese networks meet extreme classifiers with 100m labels. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">International Conference on Machine Learning</em>. PMLR, 2330–2340.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zhuyun Dai, Vincent Y Zhao, Ji Ma, Yi Luan, Jianmo Ni, Jing Lu, Anton Bakalov, Kelvin Guu, Keith B Hall, and Ming-Wei Chang. 2022.

</span>
<span class="ltx_bibblock">Promptagator: Few-shot dense retrieval from 8 examples.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">arXiv preprint arXiv:2209.11755</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Díez et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jorge Díez, David Martínez-Rego, Amparo Alonso-Betanzos, Oscar Luaces, and Antonio Bahamonde. 2019.

</span>
<span class="ltx_bibblock">Optimizing novelty and diversity in recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Progress in Artificial Intelligence</em> 8 (2019), 101–109.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dulac-Arnold et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Gabriel Dulac-Arnold, Richard Evans, Hado van Hasselt, Peter Sunehag, Timothy Lillicrap, Jonathan Hunt, Timothy Mann, Theophane Weber, Thomas Degris, and Ben Coppin. 2015.

</span>
<span class="ltx_bibblock">Deep reinforcement learning in large discrete action spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">arXiv preprint arXiv:1512.07679</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Tianyu Gao, Xingcheng Yao, and Danqi Chen. 2021.

</span>
<span class="ltx_bibblock">SimCSE: Simple Contrastive Learning of Sentence Embeddings. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">2021 Conference on Empirical Methods in Natural Language Processing, EMNLP 2021</em>. Association for Computational Linguistics (ACL), 6894–6910.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jiafeng Guo, Yinqiong Cai, Yixing Fan, Fei Sun, Ruqing Zhang, and Xueqi Cheng. 2022.

</span>
<span class="ltx_bibblock">Semantic models for the first-stage retrieval: A comprehensive review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">ACM Transactions on Information Systems (TOIS)</em> 40, 4 (2022), 1–42.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xingwei He, Zhenghao Lin, Yeyun Gong, Alex Jin, Hang Zhang, Chen Lin, Jian Jiao, Siu Ming Yiu, Nan Duan, Weizhu Chen, et al<span class="ltx_text" id="bib.bib11.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Annollm: Making large language models to be better crowdsourced annotators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.4.1">arXiv preprint arXiv:2303.16854</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Herlocker et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2004)</span>
<span class="ltx_bibblock">
Jonathan L Herlocker, Joseph A Konstan, Loren G Terveen, and John T Riedl. 2004.

</span>
<span class="ltx_bibblock">Evaluating collaborative filtering recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">ACM Transactions on Information Systems (TOIS)</em> 22, 1 (2004), 5–53.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yupeng Hou, Junjie Zhang, Zihan Lin, Hongyu Lu, Ruobing Xie, Julian McAuley, and Wayne Xin Zhao. 2024.

</span>
<span class="ltx_bibblock">Large language models are zero-shot rankers for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">European Conference on Information Retrieval</em>. Springer, 364–381.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hron et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jiri Hron, Karl Krauth, Michael Jordan, and Niki Kilbertus. 2021.

</span>
<span class="ltx_bibblock">On component interactions in two-stage recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Advances in neural information processing systems</em> 34 (2021), 2744–2757.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hurley and Zhang (2011)</span>
<span class="ltx_bibblock">
Neil Hurley and Mi Zhang. 2011.

</span>
<span class="ltx_bibblock">Novelty and diversity in top-n recommendation–analysis and evaluation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">ACM Transactions on Internet Technology (TOIT)</em> 10, 4 (2011), 1–30.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaminskas and Bridge (2016)</span>
<span class="ltx_bibblock">
Marius Kaminskas and Derek Bridge. 2016.

</span>
<span class="ltx_bibblock">Diversity, serendipity, novelty, and coverage: a survey and empirical analysis of beyond-accuracy objectives in recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ACM Transactions on Interactive Intelligent Systems (TiiS)</em> 7, 1 (2016), 1–42.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keat et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ee Yeo Keat, Nurfadhlina Mohd Sharef, Razali Yaakob, Khairul Azhar Kasmiran, Erzam Marlisah, Norwati Mustapha, and Maslina Zolkepli. 2022.

</span>
<span class="ltx_bibblock">Multiobjective Deep Reinforcement Learning for Recommendation Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">IEEE Access</em> 10 (2022), 65011–65027.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le-Khac et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Phuc H Le-Khac, Graham Healy, and Alan F Smeaton. 2020.

</span>
<span class="ltx_bibblock">Contrastive representation learning: A framework and review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Ieee Access</em> 8 (2020), 193907–193934.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jiacheng Li, Ming Wang, Jin Li, Jinmiao Fu, Xin Shen, Jingbo Shang, and Julian McAuley. 2023.

</span>
<span class="ltx_bibblock">Text is all you need: Learning language representations for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 1258–1267.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Lihong Li, Wei Chu, John Langford, and Robert E Schapire. 2010.

</span>
<span class="ltx_bibblock">A contextual-bandit approach to personalized news article recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 19th international conference on World wide web</em>. 661–670.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yong Liu, Zhiqi Shen, Yinan Zhang, and Lizhen Cui. 2021.

</span>
<span class="ltx_bibblock">Diversity-promoting deep reinforcement learning for interactive recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">5th International Conference on Crowd Science and Engineering</em>. 132–139.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lopez et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Romain Lopez, Inderjit S Dhillon, and Michael I Jordan. 2021.

</span>
<span class="ltx_bibblock">Learning from extreme bandit feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 35. 8732–8740.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Pan Lu, Liang Qiu, Kai-Wei Chang, Ying Nian Wu, Song-Chun Zhu, Tanmay Rajpurohit, Peter Clark, and Ashwin Kalyan. 2022.

</span>
<span class="ltx_bibblock">Dynamic Prompt Learning via Policy Gradient for Semi-structured Mathematical Reasoning. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">The Eleventh International Conference on Learning Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mei et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jincheng Mei, Chenjun Xiao, Csaba Szepesvari, and Dale Schuurmans. 2020.

</span>
<span class="ltx_bibblock">On the global convergence rates of softmax policy gradient methods. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">International Conference on Machine Learning</em>. PMLR, 6820–6829.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Montazeralghaem et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ali Montazeralghaem, Hamed Zamani, and James Allan. 2020.

</span>
<span class="ltx_bibblock">A reinforcement learning framework for relevance feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 43rd international acm sigir conference on research and development in information retrieval</em>. 59–68.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oord et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals. 2018.

</span>
<span class="ltx_bibblock">Representation learning with contrastive predictive coding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">arXiv preprint arXiv:1807.03748</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al<span class="ltx_text" id="bib.bib27.3.1">.</span> 2022.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.4.1">Advances in Neural Information Processing Systems</em> 35 (2022), 27730–27744.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Feiyang Pan, Qingpeng Cai, Pingzhong Tang, Fuzhen Zhuang, and Qing He. 2019.

</span>
<span class="ltx_bibblock">Policy gradients for contextual recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">The World Wide Web Conference</em>. 1421–1431.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pinto et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
André Susano Pinto, Alexander Kolesnikov, Yuge Shi, Lucas Beyer, and Xiaohua Zhai. 2023.

</span>
<span class="ltx_bibblock">Tuning computer vision models with task rewards. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">International Conference on Machine Learning</em>. PMLR, 33229–33239.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rodriguez et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Mario Rodriguez, Christian Posse, and Ethan Zhang. 2012.

</span>
<span class="ltx_bibblock">Multiple objective optimization in recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Proceedings of the sixth ACM conference on Recommender systems</em>. 11–18.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanner et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Scott Sanner, Krisztian Balog, Filip Radlinski, Ben Wedin, and Lucas Dixon. 2023.

</span>
<span class="ltx_bibblock">Large language models are competitive near cold-start recommenders for language-and item-based preferences. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the 17th ACM conference on recommender systems</em>. 890–896.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shani and Gunawardana (2011)</span>
<span class="ltx_bibblock">
Guy Shani and Asela Gunawardana. 2011.

</span>
<span class="ltx_bibblock">Evaluating recommendation systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Recommender systems handbook</em> (2011), 257–297.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xiaoyu Shi, Quanliang Liu, Hong Xie, Di Wu, Bo Peng, MingSheng Shang, and Defu Lian. 2023.

</span>
<span class="ltx_bibblock">Relieving popularity bias in interactive recommendation: A diversity-novelty-aware reinforcement learning approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">ACM Transactions on Information Systems</em> 42, 2 (2023), 1–30.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stamenkovic et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Dusan Stamenkovic, Alexandros Karatzoglou, Ioannis Arapakis, Xin Xin, and Kleomenis Katevas. 2022.

</span>
<span class="ltx_bibblock">Choosing the best of both worlds: Diverse and novel recommendations through multi-objective reinforcement learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the Fifteenth ACM International Conference on Web Search and Data Mining</em>. 957–965.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vargas and Castells (2011)</span>
<span class="ltx_bibblock">
Saúl Vargas and Pablo Castells. 2011.

</span>
<span class="ltx_bibblock">Rank and relevance in novelty and diversity metrics for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the fifth ACM conference on Recommender systems</em>. 109–116.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Zeng Wei, Jun Xu, Yanyan Lan, Jiafeng Guo, and Xueqi Cheng. 2017.

</span>
<span class="ltx_bibblock">Reinforcement Learning to Rank with Markov Decision Process. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the 40th International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (Shinjuku, Tokyo, Japan) <em class="ltx_emph ltx_font_italic" id="bib.bib36.4.2">(SIGIR ’17)</em>. Association for Computing Machinery, New York, NY, USA, 945–948.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3077136.3080685" title="">https://doi.org/10.1145/3077136.3080685</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1992)</span>
<span class="ltx_bibblock">
Ronald J Williams. 1992.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms for connectionist reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Machine learning</em> 8 (1992), 229–256.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xuansheng Wu, Huachi Zhou, Yucheng Shi, Wenlin Yao, Xiao Huang, and Ninghao Liu. 2024.

</span>
<span class="ltx_bibblock">Could Small Language Models Serve as Recommenders? Towards Data-centric Cold-start Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the ACM on Web Conference 2024</em>. 3566–3575.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ruobing Xie, Shaoliang Zhang, Rui Wang, Feng Xia, and Leyu Lin. 2021.

</span>
<span class="ltx_bibblock">Hierarchical reinforcement learning for integrated recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 35. 4521–4528.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jun Xu, Zeng Wei, Long Xia, Yanyan Lan, Dawei Yin, Xueqi Cheng, and Ji-Rong Wen. 2020.

</span>
<span class="ltx_bibblock">Reinforcement Learning to Rank with Pairwise Policy Gradient. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em> (Virtual Event, China) <em class="ltx_emph ltx_font_italic" id="bib.bib40.4.2">(SIGIR ’20)</em>. Association for Computing Machinery, New York, NY, USA, 509–518.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3397271.3401148" title="">https://doi.org/10.1145/3397271.3401148</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao and Lee (2016)</span>
<span class="ltx_bibblock">
Pengfei Zhao and Dik Lun Lee. 2016.

</span>
<span class="ltx_bibblock">How much novelty is relevant? it depends on your curiosity. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the 39th International ACM SIGIR conference on Research and Development in Information Retrieval</em>. 315–324.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yinglun Zhu, Dylan J Foster, John Langford, and Paul Mineiro. 2022.

</span>
<span class="ltx_bibblock">Contextual bandits with large action spaces: Made practical. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">International Conference on Machine Learning</em>. PMLR, 27428–27453.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix: Proof of Propositions</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1. </span>Proposition 1</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.3">To prove Proposition 1, we restate a result from  <cite class="ltx_cite ltx_citemacro_citep">(Mei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib24" title="">2020</a>)</cite> for a MDP. Here <math alttext="\gamma" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.1"><semantics id="A1.SS1.p1.1.m1.1a"><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.1d">italic_γ</annotation></semantics></math> is the discount factor, <math alttext="t" class="ltx_Math" display="inline" id="A1.SS1.p1.2.m2.1"><semantics id="A1.SS1.p1.2.m2.1a"><mi id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><ci id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">italic_t</annotation></semantics></math> refers to steps of the optimization, and <math alttext="d^{\pi}_{\mu}(\gamma)=\mathbf{E}_{s_{0}\sim\mu}(1-\gamma)\sum_{t=0}^{\infty}%
\gamma^{t}P(s_{t}=s|s_{0},\pi)" class="ltx_Math" display="inline" id="A1.SS1.p1.3.m3.4"><semantics id="A1.SS1.p1.3.m3.4a"><mrow id="A1.SS1.p1.3.m3.4.4" xref="A1.SS1.p1.3.m3.4.4.cmml"><mrow id="A1.SS1.p1.3.m3.4.4.4" xref="A1.SS1.p1.3.m3.4.4.4.cmml"><msubsup id="A1.SS1.p1.3.m3.4.4.4.2" xref="A1.SS1.p1.3.m3.4.4.4.2.cmml"><mi id="A1.SS1.p1.3.m3.4.4.4.2.2.2" xref="A1.SS1.p1.3.m3.4.4.4.2.2.2.cmml">d</mi><mi id="A1.SS1.p1.3.m3.4.4.4.2.3" xref="A1.SS1.p1.3.m3.4.4.4.2.3.cmml">μ</mi><mi id="A1.SS1.p1.3.m3.4.4.4.2.2.3" xref="A1.SS1.p1.3.m3.4.4.4.2.2.3.cmml">π</mi></msubsup><mo id="A1.SS1.p1.3.m3.4.4.4.1" xref="A1.SS1.p1.3.m3.4.4.4.1.cmml">⁢</mo><mrow id="A1.SS1.p1.3.m3.4.4.4.3.2" xref="A1.SS1.p1.3.m3.4.4.4.cmml"><mo id="A1.SS1.p1.3.m3.4.4.4.3.2.1" stretchy="false" xref="A1.SS1.p1.3.m3.4.4.4.cmml">(</mo><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">γ</mi><mo id="A1.SS1.p1.3.m3.4.4.4.3.2.2" stretchy="false" xref="A1.SS1.p1.3.m3.4.4.4.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p1.3.m3.4.4.3" xref="A1.SS1.p1.3.m3.4.4.3.cmml">=</mo><mrow id="A1.SS1.p1.3.m3.4.4.2" xref="A1.SS1.p1.3.m3.4.4.2.cmml"><msub id="A1.SS1.p1.3.m3.4.4.2.4" xref="A1.SS1.p1.3.m3.4.4.2.4.cmml"><mi id="A1.SS1.p1.3.m3.4.4.2.4.2" xref="A1.SS1.p1.3.m3.4.4.2.4.2.cmml">𝐄</mi><mrow id="A1.SS1.p1.3.m3.4.4.2.4.3" xref="A1.SS1.p1.3.m3.4.4.2.4.3.cmml"><msub id="A1.SS1.p1.3.m3.4.4.2.4.3.2" xref="A1.SS1.p1.3.m3.4.4.2.4.3.2.cmml"><mi id="A1.SS1.p1.3.m3.4.4.2.4.3.2.2" xref="A1.SS1.p1.3.m3.4.4.2.4.3.2.2.cmml">s</mi><mn id="A1.SS1.p1.3.m3.4.4.2.4.3.2.3" xref="A1.SS1.p1.3.m3.4.4.2.4.3.2.3.cmml">0</mn></msub><mo id="A1.SS1.p1.3.m3.4.4.2.4.3.1" xref="A1.SS1.p1.3.m3.4.4.2.4.3.1.cmml">∼</mo><mi id="A1.SS1.p1.3.m3.4.4.2.4.3.3" xref="A1.SS1.p1.3.m3.4.4.2.4.3.3.cmml">μ</mi></mrow></msub><mo id="A1.SS1.p1.3.m3.4.4.2.3" xref="A1.SS1.p1.3.m3.4.4.2.3.cmml">⁢</mo><mrow id="A1.SS1.p1.3.m3.3.3.1.1.1" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.cmml"><mo id="A1.SS1.p1.3.m3.3.3.1.1.1.2" stretchy="false" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p1.3.m3.3.3.1.1.1.1" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.cmml"><mn id="A1.SS1.p1.3.m3.3.3.1.1.1.1.2" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.2.cmml">1</mn><mo id="A1.SS1.p1.3.m3.3.3.1.1.1.1.1" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.1.cmml">−</mo><mi id="A1.SS1.p1.3.m3.3.3.1.1.1.1.3" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.SS1.p1.3.m3.3.3.1.1.1.3" stretchy="false" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="A1.SS1.p1.3.m3.4.4.2.3a" xref="A1.SS1.p1.3.m3.4.4.2.3.cmml">⁢</mo><mrow id="A1.SS1.p1.3.m3.4.4.2.2" xref="A1.SS1.p1.3.m3.4.4.2.2.cmml"><msubsup id="A1.SS1.p1.3.m3.4.4.2.2.2" xref="A1.SS1.p1.3.m3.4.4.2.2.2.cmml"><mo id="A1.SS1.p1.3.m3.4.4.2.2.2.2.2" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.2.cmml">∑</mo><mrow id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.cmml"><mi id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.2" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.2.cmml">t</mi><mo id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.1" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.1.cmml">=</mo><mn id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.3" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.3.cmml">0</mn></mrow><mi id="A1.SS1.p1.3.m3.4.4.2.2.2.3" mathvariant="normal" xref="A1.SS1.p1.3.m3.4.4.2.2.2.3.cmml">∞</mi></msubsup><mrow id="A1.SS1.p1.3.m3.4.4.2.2.1" xref="A1.SS1.p1.3.m3.4.4.2.2.1.cmml"><msup id="A1.SS1.p1.3.m3.4.4.2.2.1.3" xref="A1.SS1.p1.3.m3.4.4.2.2.1.3.cmml"><mi id="A1.SS1.p1.3.m3.4.4.2.2.1.3.2" xref="A1.SS1.p1.3.m3.4.4.2.2.1.3.2.cmml">γ</mi><mi id="A1.SS1.p1.3.m3.4.4.2.2.1.3.3" xref="A1.SS1.p1.3.m3.4.4.2.2.1.3.3.cmml">t</mi></msup><mo id="A1.SS1.p1.3.m3.4.4.2.2.1.2" xref="A1.SS1.p1.3.m3.4.4.2.2.1.2.cmml">⁢</mo><mi id="A1.SS1.p1.3.m3.4.4.2.2.1.4" xref="A1.SS1.p1.3.m3.4.4.2.2.1.4.cmml">P</mi><mo id="A1.SS1.p1.3.m3.4.4.2.2.1.2a" xref="A1.SS1.p1.3.m3.4.4.2.2.1.2.cmml">⁢</mo><mrow id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.cmml"><mo id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.2" stretchy="false" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.cmml"><msub id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.cmml"><mi id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.2" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.2.cmml">s</mi><mi id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.3" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.2" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.2.cmml">=</mo><mrow id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.cmml"><mi id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.3" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.3.cmml">s</mi><mo fence="false" id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.2" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.2.cmml">|</mo><mrow id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.2.cmml"><msub id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.2" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.2.cmml">s</mi><mn id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.3" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.2" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.2.cmml">,</mo><mi id="A1.SS1.p1.3.m3.2.2" xref="A1.SS1.p1.3.m3.2.2.cmml">π</mi></mrow></mrow></mrow><mo id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.3" stretchy="false" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.4b"><apply id="A1.SS1.p1.3.m3.4.4.cmml" xref="A1.SS1.p1.3.m3.4.4"><eq id="A1.SS1.p1.3.m3.4.4.3.cmml" xref="A1.SS1.p1.3.m3.4.4.3"></eq><apply id="A1.SS1.p1.3.m3.4.4.4.cmml" xref="A1.SS1.p1.3.m3.4.4.4"><times id="A1.SS1.p1.3.m3.4.4.4.1.cmml" xref="A1.SS1.p1.3.m3.4.4.4.1"></times><apply id="A1.SS1.p1.3.m3.4.4.4.2.cmml" xref="A1.SS1.p1.3.m3.4.4.4.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.4.2.1.cmml" xref="A1.SS1.p1.3.m3.4.4.4.2">subscript</csymbol><apply id="A1.SS1.p1.3.m3.4.4.4.2.2.cmml" xref="A1.SS1.p1.3.m3.4.4.4.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.4.2.2.1.cmml" xref="A1.SS1.p1.3.m3.4.4.4.2">superscript</csymbol><ci id="A1.SS1.p1.3.m3.4.4.4.2.2.2.cmml" xref="A1.SS1.p1.3.m3.4.4.4.2.2.2">𝑑</ci><ci id="A1.SS1.p1.3.m3.4.4.4.2.2.3.cmml" xref="A1.SS1.p1.3.m3.4.4.4.2.2.3">𝜋</ci></apply><ci id="A1.SS1.p1.3.m3.4.4.4.2.3.cmml" xref="A1.SS1.p1.3.m3.4.4.4.2.3">𝜇</ci></apply><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝛾</ci></apply><apply id="A1.SS1.p1.3.m3.4.4.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2"><times id="A1.SS1.p1.3.m3.4.4.2.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.3"></times><apply id="A1.SS1.p1.3.m3.4.4.2.4.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.2.4.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4">subscript</csymbol><ci id="A1.SS1.p1.3.m3.4.4.2.4.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4.2">𝐄</ci><apply id="A1.SS1.p1.3.m3.4.4.2.4.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4.3"><csymbol cd="latexml" id="A1.SS1.p1.3.m3.4.4.2.4.3.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4.3.1">similar-to</csymbol><apply id="A1.SS1.p1.3.m3.4.4.2.4.3.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.2.4.3.2.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4.3.2">subscript</csymbol><ci id="A1.SS1.p1.3.m3.4.4.2.4.3.2.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4.3.2.2">𝑠</ci><cn id="A1.SS1.p1.3.m3.4.4.2.4.3.2.3.cmml" type="integer" xref="A1.SS1.p1.3.m3.4.4.2.4.3.2.3">0</cn></apply><ci id="A1.SS1.p1.3.m3.4.4.2.4.3.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.4.3.3">𝜇</ci></apply></apply><apply id="A1.SS1.p1.3.m3.3.3.1.1.1.1.cmml" xref="A1.SS1.p1.3.m3.3.3.1.1.1"><minus id="A1.SS1.p1.3.m3.3.3.1.1.1.1.1.cmml" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.1"></minus><cn id="A1.SS1.p1.3.m3.3.3.1.1.1.1.2.cmml" type="integer" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.2">1</cn><ci id="A1.SS1.p1.3.m3.3.3.1.1.1.1.3.cmml" xref="A1.SS1.p1.3.m3.3.3.1.1.1.1.3">𝛾</ci></apply><apply id="A1.SS1.p1.3.m3.4.4.2.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2"><apply id="A1.SS1.p1.3.m3.4.4.2.2.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.2.2.2.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2">superscript</csymbol><apply id="A1.SS1.p1.3.m3.4.4.2.2.2.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.2.2.2.2.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2">subscript</csymbol><sum id="A1.SS1.p1.3.m3.4.4.2.2.2.2.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.2"></sum><apply id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3"><eq id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.1"></eq><ci id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.2">𝑡</ci><cn id="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.3.cmml" type="integer" xref="A1.SS1.p1.3.m3.4.4.2.2.2.2.3.3">0</cn></apply></apply><infinity id="A1.SS1.p1.3.m3.4.4.2.2.2.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.2.3"></infinity></apply><apply id="A1.SS1.p1.3.m3.4.4.2.2.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1"><times id="A1.SS1.p1.3.m3.4.4.2.2.1.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.2"></times><apply id="A1.SS1.p1.3.m3.4.4.2.2.1.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.2.2.1.3.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.3">superscript</csymbol><ci id="A1.SS1.p1.3.m3.4.4.2.2.1.3.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.3.2">𝛾</ci><ci id="A1.SS1.p1.3.m3.4.4.2.2.1.3.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.3.3">𝑡</ci></apply><ci id="A1.SS1.p1.3.m3.4.4.2.2.1.4.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.4">𝑃</ci><apply id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1"><eq id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.2"></eq><apply id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3">subscript</csymbol><ci id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.2">𝑠</ci><ci id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.3.3">𝑡</ci></apply><apply id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.2">conditional</csymbol><ci id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.3.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.3">𝑠</ci><list id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1"><apply id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.2">𝑠</ci><cn id="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.SS1.p1.3.m3.4.4.2.2.1.1.1.1.1.1.1.1.3">0</cn></apply><ci id="A1.SS1.p1.3.m3.2.2.cmml" xref="A1.SS1.p1.3.m3.2.2">𝜋</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.4c">d^{\pi}_{\mu}(\gamma)=\mathbf{E}_{s_{0}\sim\mu}(1-\gamma)\sum_{t=0}^{\infty}%
\gamma^{t}P(s_{t}=s|s_{0},\pi)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.4d">italic_d start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT ( italic_γ ) = bold_E start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ italic_μ end_POSTSUBSCRIPT ( 1 - italic_γ ) ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_P ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_s | italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_π )</annotation></semantics></math> is the discounted state distribution.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="A1.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Theorem 1 (<cite class="ltx_cite ltx_citemacro_citep">(Mei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#bib.bib24" title="">2020</a>)</cite>).</h6>
<div class="ltx_para" id="A1.Thmtheorem1.p1">
<p class="ltx_p" id="A1.Thmtheorem1.p1.7"><span class="ltx_text ltx_font_italic" id="A1.Thmtheorem1.p1.7.7">Let Assumption 1 hold and let <math alttext="\{\theta_{t}\}_{t\geq 1}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.1.1.m1.1"><semantics id="A1.Thmtheorem1.p1.1.1.m1.1a"><msub id="A1.Thmtheorem1.p1.1.1.m1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.cmml"><mrow id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml"><mo id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.2" stretchy="false" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml">{</mo><msub id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.3" stretchy="false" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.Thmtheorem1.p1.1.1.m1.1.1.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.cmml"><mi id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml">t</mi><mo id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.1" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.1.cmml">≥</mo><mn id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.1.1.m1.1b"><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1">subscript</csymbol><set id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1"><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.2">𝜃</ci><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3"><geq id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.1"></geq><ci id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.2">𝑡</ci><cn id="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.1.1.m1.1c">\{\theta_{t}\}_{t\geq 1}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.1.1.m1.1d">{ italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t ≥ 1 end_POSTSUBSCRIPT</annotation></semantics></math> be
generated using <math alttext="\theta_{t+1}\leftarrow\theta_{t}+\eta\frac{\partial V^{\pi_{\theta_{t}}}(\mu)}%
{\partial\theta_{t}}" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.2.2.m2.1"><semantics id="A1.Thmtheorem1.p1.2.2.m2.1a"><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.cmml"><msub id="A1.Thmtheorem1.p1.2.2.m2.1.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.2.cmml">θ</mi><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.2.cmml">t</mi><mo id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.1.cmml">+</mo><mn id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.Thmtheorem1.p1.2.2.m2.1.2.1" stretchy="false" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.1.cmml">←</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.cmml"><msub id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.2.cmml">θ</mi><mi id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.3.cmml">t</mi></msub><mo id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.1.cmml">+</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.2.cmml">η</mi><mo id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.1.cmml">⁢</mo><mfrac id="A1.Thmtheorem1.p1.2.2.m2.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.cmml"><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.2" rspace="0em" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.2.cmml">∂</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.cmml"><msup id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.2.cmml">V</mi><msub id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.2.cmml">π</mi><msub id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.2.cmml">θ</mi><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.3.cmml">t</mi></msub></msub></msup><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.cmml"><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.3.2.1" stretchy="false" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.cmml">(</mo><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.cmml">μ</mi><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.3.2.2" stretchy="false" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="A1.Thmtheorem1.p1.2.2.m2.1.1.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.cmml"><mo id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.1" rspace="0em" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.1.cmml">∂</mo><msub id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.cmml"><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.2" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.2.cmml">θ</mi><mi id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.3" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.3.cmml">t</mi></msub></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.2.2.m2.1b"><apply id="A1.Thmtheorem1.p1.2.2.m2.1.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2"><ci id="A1.Thmtheorem1.p1.2.2.m2.1.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.1">←</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.2">𝜃</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3"><plus id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.1"></plus><ci id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.2">𝑡</ci><cn id="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.2.3.3">1</cn></apply></apply><apply id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3"><plus id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.1"></plus><apply id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.2">𝜃</ci><ci id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.2.3">𝑡</ci></apply><apply id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3"><times id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.1"></times><ci id="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.2.3.3.2">𝜂</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1"><divide id="A1.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1"></divide><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1"><partialdiff id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.2"></partialdiff><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3"><times id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.1"></times><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2">superscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.2">𝑉</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.2">𝜋</ci><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.2">𝜃</ci><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.3.2.3.3.3">𝑡</ci></apply></apply></apply><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.1.1">𝜇</ci></apply></apply><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3"><partialdiff id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.1"></partialdiff><apply id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.1.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.2.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.2">𝜃</ci><ci id="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.3.cmml" xref="A1.Thmtheorem1.p1.2.2.m2.1.1.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.2.2.m2.1c">\theta_{t+1}\leftarrow\theta_{t}+\eta\frac{\partial V^{\pi_{\theta_{t}}}(\mu)}%
{\partial\theta_{t}}</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.2.2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ← italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_η divide start_ARG ∂ italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_μ ) end_ARG start_ARG ∂ italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> where <math alttext="V^{\pi_{\theta_{t}}}(\mu)=\mathbf{E}_{s\sim\mu}V^{\pi_{\theta_{t}}}(s)" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.3.3.m3.2"><semantics id="A1.Thmtheorem1.p1.3.3.m3.2a"><mrow id="A1.Thmtheorem1.p1.3.3.m3.2.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.cmml"><mrow id="A1.Thmtheorem1.p1.3.3.m3.2.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.cmml"><msup id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.2.cmml">V</mi><msub id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.2.cmml">π</mi><msub id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.2.cmml">θ</mi><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.3.cmml">t</mi></msub></msub></msup><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.1" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.1.cmml">⁢</mo><mrow id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.cmml"><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.3.2.1" stretchy="false" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.cmml">(</mo><mi id="A1.Thmtheorem1.p1.3.3.m3.1.1" xref="A1.Thmtheorem1.p1.3.3.m3.1.1.cmml">μ</mi><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.3.2.2" stretchy="false" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.1" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.1.cmml">=</mo><mrow id="A1.Thmtheorem1.p1.3.3.m3.2.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.cmml"><msub id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.2.cmml">𝐄</mi><mrow id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.2.cmml">s</mi><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.1" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.1.cmml">∼</mo><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.3.cmml">μ</mi></mrow></msub><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.1" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.1.cmml">⁢</mo><msup id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.2.cmml">V</mi><msub id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.2.cmml">π</mi><msub id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.cmml"><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.2.cmml">θ</mi><mi id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.3" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.3.cmml">t</mi></msub></msub></msup><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.1a" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.1.cmml">⁢</mo><mrow id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.4.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.cmml"><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.4.2.1" stretchy="false" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.cmml">(</mo><mi id="A1.Thmtheorem1.p1.3.3.m3.2.2" xref="A1.Thmtheorem1.p1.3.3.m3.2.2.cmml">s</mi><mo id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.4.2.2" stretchy="false" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.3.3.m3.2b"><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3"><eq id="A1.Thmtheorem1.p1.3.3.m3.2.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.1"></eq><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2"><times id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.1"></times><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2">superscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.2">𝑉</ci><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.2">𝜋</ci><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.2">𝜃</ci><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.2.2.3.3.3">𝑡</ci></apply></apply></apply><ci id="A1.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.1.1">𝜇</ci></apply><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3"><times id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.1"></times><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.2">𝐄</ci><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.1">similar-to</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.2">𝑠</ci><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.2.3.3">𝜇</ci></apply></apply><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3">superscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.2">𝑉</ci><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.2">𝜋</ci><apply id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.1.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.2">𝜃</ci><ci id="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.3.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.3.3.3.3.3.3">𝑡</ci></apply></apply></apply><ci id="A1.Thmtheorem1.p1.3.3.m3.2.2.cmml" xref="A1.Thmtheorem1.p1.3.3.m3.2.2">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.3.3.m3.2c">V^{\pi_{\theta_{t}}}(\mu)=\mathbf{E}_{s\sim\mu}V^{\pi_{\theta_{t}}}(s)</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.3.3.m3.2d">italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_μ ) = bold_E start_POSTSUBSCRIPT italic_s ∼ italic_μ end_POSTSUBSCRIPT italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_s )</annotation></semantics></math>. Let <math alttext="\eta=(1-\gamma)3/8" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.4.4.m4.1"><semantics id="A1.Thmtheorem1.p1.4.4.m4.1a"><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.cmml"><mi id="A1.Thmtheorem1.p1.4.4.m4.1.1.3" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.3.cmml">η</mi><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1.2" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.2.cmml">=</mo><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.cmml"><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.cmml"><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.cmml"><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.cmml"><mn id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.2" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.2.cmml">⁢</mo><mn id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.3" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.3.cmml">3</mn></mrow><mo id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.2" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.2.cmml">/</mo><mn id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.3" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.3.cmml">8</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.4.4.m4.1b"><apply id="A1.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1"><eq id="A1.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.2"></eq><ci id="A1.Thmtheorem1.p1.4.4.m4.1.1.3.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.3">𝜂</ci><apply id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1"><divide id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.2"></divide><apply id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1"><times id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.2"></times><apply id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1"><minus id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.1"></minus><cn id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.2">1</cn><ci id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.1.1.1.3">𝛾</ci></apply><cn id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.1.3">3</cn></apply><cn id="A1.Thmtheorem1.p1.4.4.m4.1.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.4.4.m4.1.1.1.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.4.4.m4.1c">\eta=(1-\gamma)3/8</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.4.4.m4.1d">italic_η = ( 1 - italic_γ ) 3 / 8</annotation></semantics></math>, <math alttext="c" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.5.5.m5.1"><semantics id="A1.Thmtheorem1.p1.5.5.m5.1a"><mi id="A1.Thmtheorem1.p1.5.5.m5.1.1" xref="A1.Thmtheorem1.p1.5.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.5.5.m5.1b"><ci id="A1.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="A1.Thmtheorem1.p1.5.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.5.5.m5.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.5.5.m5.1d">italic_c</annotation></semantics></math> be the
positive constant <math alttext="c:=\inf_{s\in S,t\geq 1}\pi_{\theta_{t}}(a^{*}(s)|s)&gt;0" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.6.6.m6.4"><semantics id="A1.Thmtheorem1.p1.6.6.m6.4a"><mrow id="A1.Thmtheorem1.p1.6.6.m6.4.4" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.cmml"><mi id="A1.Thmtheorem1.p1.6.6.m6.4.4.3" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.3.cmml">c</mi><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.4" lspace="0.278em" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.4.cmml">:=</mo><mrow id="A1.Thmtheorem1.p1.6.6.m6.4.4.1" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.cmml"><msub id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2.cmml"><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2.2" lspace="0.111em" rspace="0.167em" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2.2.cmml">inf</mo><mrow id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.3.cmml"><mrow id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.cmml"><mi id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.2.cmml">s</mi><mo id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.1.cmml">∈</mo><mi id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.3.cmml">S</mi></mrow><mo id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.3" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.3a.cmml">,</mo><mrow id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.cmml"><mi id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.2" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.2.cmml">t</mi><mo id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.1" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.1.cmml">≥</mo><mn id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.3" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></msub><mrow id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.cmml"><msub id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.cmml"><mi id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.2.cmml">π</mi><msub id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.cmml"><mi id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.2.cmml">θ</mi><mi id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.3" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.3.cmml">t</mi></msub></msub><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.cmml"><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.2" stretchy="false" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.cmml">(</mo><mrow id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.cmml"><mrow id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.cmml"><msup id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.cmml"><mi id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.3" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.1" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.3.2" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.cmml"><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.cmml">(</mo><mi id="A1.Thmtheorem1.p1.6.6.m6.3.3" xref="A1.Thmtheorem1.p1.6.6.m6.3.3.cmml">s</mi><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo fence="false" id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.1" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.1.cmml">|</mo><mi id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.3" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.3" stretchy="false" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Thmtheorem1.p1.6.6.m6.4.4.5" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.5.cmml">&gt;</mo><mn id="A1.Thmtheorem1.p1.6.6.m6.4.4.6" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.6.6.m6.4b"><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4"><and id="A1.Thmtheorem1.p1.6.6.m6.4.4a.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4"></and><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4b.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.6.6.m6.4.4.4.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.4">assign</csymbol><ci id="A1.Thmtheorem1.p1.6.6.m6.4.4.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.3">𝑐</ci><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1"><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.2.2">infimum</csymbol><apply id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.3a.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1"><in id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.1"></in><ci id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.2">𝑠</ci><ci id="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.1.1.1.1.1.3">𝑆</ci></apply><apply id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2"><geq id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.1"></geq><ci id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.2">𝑡</ci><cn id="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.6.6.m6.2.2.2.2.2.3">1</cn></apply></apply></apply><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1"><times id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.2"></times><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.2">𝜋</ci><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3">subscript</csymbol><ci id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.2">𝜃</ci><ci id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.3.3.3">𝑡</ci></apply></apply><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1"><csymbol cd="latexml" id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.1">conditional</csymbol><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2"><times id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.1"></times><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.1.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2">superscript</csymbol><ci id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.2.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.2">𝑎</ci><times id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.2.2.3"></times></apply><ci id="A1.Thmtheorem1.p1.6.6.m6.3.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.3.3">𝑠</ci></apply><ci id="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.3.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply><apply id="A1.Thmtheorem1.p1.6.6.m6.4.4c.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4"><gt id="A1.Thmtheorem1.p1.6.6.m6.4.4.5.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.5"></gt><share href="https://arxiv.org/html/2406.14169v1#A1.Thmtheorem1.p1.6.6.m6.4.4.1.cmml" id="A1.Thmtheorem1.p1.6.6.m6.4.4d.cmml" xref="A1.Thmtheorem1.p1.6.6.m6.4.4"></share><cn id="A1.Thmtheorem1.p1.6.6.m6.4.4.6.cmml" type="integer" xref="A1.Thmtheorem1.p1.6.6.m6.4.4.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.6.6.m6.4c">c:=\inf_{s\in S,t\geq 1}\pi_{\theta_{t}}(a^{*}(s)|s)&gt;0</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.6.6.m6.4d">italic_c := roman_inf start_POSTSUBSCRIPT italic_s ∈ italic_S , italic_t ≥ 1 end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) | italic_s ) &gt; 0</annotation></semantics></math>. Then, for all <math alttext="t\geq 1" class="ltx_Math" display="inline" id="A1.Thmtheorem1.p1.7.7.m7.1"><semantics id="A1.Thmtheorem1.p1.7.7.m7.1a"><mrow id="A1.Thmtheorem1.p1.7.7.m7.1.1" xref="A1.Thmtheorem1.p1.7.7.m7.1.1.cmml"><mi id="A1.Thmtheorem1.p1.7.7.m7.1.1.2" xref="A1.Thmtheorem1.p1.7.7.m7.1.1.2.cmml">t</mi><mo id="A1.Thmtheorem1.p1.7.7.m7.1.1.1" xref="A1.Thmtheorem1.p1.7.7.m7.1.1.1.cmml">≥</mo><mn id="A1.Thmtheorem1.p1.7.7.m7.1.1.3" xref="A1.Thmtheorem1.p1.7.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.Thmtheorem1.p1.7.7.m7.1b"><apply id="A1.Thmtheorem1.p1.7.7.m7.1.1.cmml" xref="A1.Thmtheorem1.p1.7.7.m7.1.1"><geq id="A1.Thmtheorem1.p1.7.7.m7.1.1.1.cmml" xref="A1.Thmtheorem1.p1.7.7.m7.1.1.1"></geq><ci id="A1.Thmtheorem1.p1.7.7.m7.1.1.2.cmml" xref="A1.Thmtheorem1.p1.7.7.m7.1.1.2">𝑡</ci><cn id="A1.Thmtheorem1.p1.7.7.m7.1.1.3.cmml" type="integer" xref="A1.Thmtheorem1.p1.7.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Thmtheorem1.p1.7.7.m7.1c">t\geq 1</annotation><annotation encoding="application/x-llamapun" id="A1.Thmtheorem1.p1.7.7.m7.1d">italic_t ≥ 1</annotation></semantics></math>,</span></p>
<table class="ltx_equation ltx_eqn_table" id="A1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}_{s\sim\mu}[V^{*}(s)-V^{\pi_{\theta_{t}}}(s)]\leq\frac{16S}{c^{2}(1-%
\gamma)^{6}t}\left\lVert\frac{d^{\pi*}_{\mu}(\gamma)}{\mu}\right\rVert_{\infty%
}^{2}\left\lVert\frac{1}{\mu}\right\rVert_{\infty}" class="ltx_Math" display="block" id="A1.E10.m1.8"><semantics id="A1.E10.m1.8a"><mrow id="A1.E10.m1.8.8" xref="A1.E10.m1.8.8.cmml"><mrow id="A1.E10.m1.8.8.1" xref="A1.E10.m1.8.8.1.cmml"><msub id="A1.E10.m1.8.8.1.3" xref="A1.E10.m1.8.8.1.3.cmml"><mi id="A1.E10.m1.8.8.1.3.2" xref="A1.E10.m1.8.8.1.3.2.cmml">𝐄</mi><mrow id="A1.E10.m1.8.8.1.3.3" xref="A1.E10.m1.8.8.1.3.3.cmml"><mi id="A1.E10.m1.8.8.1.3.3.2" xref="A1.E10.m1.8.8.1.3.3.2.cmml">s</mi><mo id="A1.E10.m1.8.8.1.3.3.1" xref="A1.E10.m1.8.8.1.3.3.1.cmml">∼</mo><mi id="A1.E10.m1.8.8.1.3.3.3" xref="A1.E10.m1.8.8.1.3.3.3.cmml">μ</mi></mrow></msub><mo id="A1.E10.m1.8.8.1.2" xref="A1.E10.m1.8.8.1.2.cmml">⁢</mo><mrow id="A1.E10.m1.8.8.1.1.1" xref="A1.E10.m1.8.8.1.1.2.cmml"><mo id="A1.E10.m1.8.8.1.1.1.2" stretchy="false" xref="A1.E10.m1.8.8.1.1.2.1.cmml">[</mo><mrow id="A1.E10.m1.8.8.1.1.1.1" xref="A1.E10.m1.8.8.1.1.1.1.cmml"><mrow id="A1.E10.m1.8.8.1.1.1.1.2" xref="A1.E10.m1.8.8.1.1.1.1.2.cmml"><msup id="A1.E10.m1.8.8.1.1.1.1.2.2" xref="A1.E10.m1.8.8.1.1.1.1.2.2.cmml"><mi id="A1.E10.m1.8.8.1.1.1.1.2.2.2" xref="A1.E10.m1.8.8.1.1.1.1.2.2.2.cmml">V</mi><mo id="A1.E10.m1.8.8.1.1.1.1.2.2.3" xref="A1.E10.m1.8.8.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.E10.m1.8.8.1.1.1.1.2.1" xref="A1.E10.m1.8.8.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E10.m1.8.8.1.1.1.1.2.3.2" xref="A1.E10.m1.8.8.1.1.1.1.2.cmml"><mo id="A1.E10.m1.8.8.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.E10.m1.8.8.1.1.1.1.2.cmml">(</mo><mi id="A1.E10.m1.5.5" xref="A1.E10.m1.5.5.cmml">s</mi><mo id="A1.E10.m1.8.8.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.E10.m1.8.8.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E10.m1.8.8.1.1.1.1.1" xref="A1.E10.m1.8.8.1.1.1.1.1.cmml">−</mo><mrow id="A1.E10.m1.8.8.1.1.1.1.3" xref="A1.E10.m1.8.8.1.1.1.1.3.cmml"><msup id="A1.E10.m1.8.8.1.1.1.1.3.2" xref="A1.E10.m1.8.8.1.1.1.1.3.2.cmml"><mi id="A1.E10.m1.8.8.1.1.1.1.3.2.2" xref="A1.E10.m1.8.8.1.1.1.1.3.2.2.cmml">V</mi><msub id="A1.E10.m1.8.8.1.1.1.1.3.2.3" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.cmml"><mi id="A1.E10.m1.8.8.1.1.1.1.3.2.3.2" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.2.cmml">π</mi><msub id="A1.E10.m1.8.8.1.1.1.1.3.2.3.3" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.cmml"><mi id="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.2" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.2.cmml">θ</mi><mi id="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.3" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.3.cmml">t</mi></msub></msub></msup><mo id="A1.E10.m1.8.8.1.1.1.1.3.1" xref="A1.E10.m1.8.8.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E10.m1.8.8.1.1.1.1.3.3.2" xref="A1.E10.m1.8.8.1.1.1.1.3.cmml"><mo id="A1.E10.m1.8.8.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.E10.m1.8.8.1.1.1.1.3.cmml">(</mo><mi id="A1.E10.m1.6.6" xref="A1.E10.m1.6.6.cmml">s</mi><mo id="A1.E10.m1.8.8.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.E10.m1.8.8.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E10.m1.8.8.1.1.1.3" stretchy="false" xref="A1.E10.m1.8.8.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.E10.m1.8.8.2" xref="A1.E10.m1.8.8.2.cmml">≤</mo><mrow id="A1.E10.m1.8.8.3" xref="A1.E10.m1.8.8.3.cmml"><mfrac id="A1.E10.m1.1.1" xref="A1.E10.m1.1.1.cmml"><mrow id="A1.E10.m1.1.1.3" xref="A1.E10.m1.1.1.3.cmml"><mn id="A1.E10.m1.1.1.3.2" xref="A1.E10.m1.1.1.3.2.cmml">16</mn><mo id="A1.E10.m1.1.1.3.1" xref="A1.E10.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.E10.m1.1.1.3.3" xref="A1.E10.m1.1.1.3.3.cmml">S</mi></mrow><mrow id="A1.E10.m1.1.1.1" xref="A1.E10.m1.1.1.1.cmml"><msup id="A1.E10.m1.1.1.1.3" xref="A1.E10.m1.1.1.1.3.cmml"><mi id="A1.E10.m1.1.1.1.3.2" xref="A1.E10.m1.1.1.1.3.2.cmml">c</mi><mn id="A1.E10.m1.1.1.1.3.3" xref="A1.E10.m1.1.1.1.3.3.cmml">2</mn></msup><mo id="A1.E10.m1.1.1.1.2" xref="A1.E10.m1.1.1.1.2.cmml">⁢</mo><msup id="A1.E10.m1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.cmml"><mrow id="A1.E10.m1.1.1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E10.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E10.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E10.m1.1.1.1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.1.1.1.cmml"><mn id="A1.E10.m1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E10.m1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.E10.m1.1.1.1.1.1.1.1.3" xref="A1.E10.m1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.E10.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E10.m1.1.1.1.1.3" xref="A1.E10.m1.1.1.1.1.3.cmml">6</mn></msup><mo id="A1.E10.m1.1.1.1.2a" xref="A1.E10.m1.1.1.1.2.cmml">⁢</mo><mi id="A1.E10.m1.1.1.1.4" xref="A1.E10.m1.1.1.1.4.cmml">t</mi></mrow></mfrac><mo id="A1.E10.m1.8.8.3.1" lspace="0em" xref="A1.E10.m1.8.8.3.1.cmml">⁢</mo><msubsup id="A1.E10.m1.8.8.3.2" xref="A1.E10.m1.8.8.3.2.cmml"><mrow id="A1.E10.m1.8.8.3.2.2.2.2" xref="A1.E10.m1.8.8.3.2.2.2.1.cmml"><mo fence="true" id="A1.E10.m1.8.8.3.2.2.2.2.1" rspace="0em" stretchy="true" xref="A1.E10.m1.8.8.3.2.2.2.1.1.cmml">∥</mo><mfrac id="A1.E10.m1.4.4" xref="A1.E10.m1.4.4.cmml"><mrow id="A1.E10.m1.4.4.3" xref="A1.E10.m1.4.4.3.cmml"><msubsup id="A1.E10.m1.4.4.3.5" xref="A1.E10.m1.4.4.3.5.cmml"><mi id="A1.E10.m1.4.4.3.5.2.2" xref="A1.E10.m1.4.4.3.5.2.2.cmml">d</mi><mi id="A1.E10.m1.4.4.3.5.3" xref="A1.E10.m1.4.4.3.5.3.cmml">μ</mi><mrow id="A1.E10.m1.3.3.2.2.2.4" xref="A1.E10.m1.3.3.2.2.2.3.cmml"><mi id="A1.E10.m1.2.2.1.1.1.1" xref="A1.E10.m1.2.2.1.1.1.1.cmml">π</mi><mo id="A1.E10.m1.3.3.2.2.2.4.1" lspace="0.222em" xref="A1.E10.m1.3.3.2.2.2.3.cmml">⁣</mo><mo id="A1.E10.m1.3.3.2.2.2.2" xref="A1.E10.m1.3.3.2.2.2.2.cmml">∗</mo></mrow></msubsup><mo id="A1.E10.m1.4.4.3.4" xref="A1.E10.m1.4.4.3.4.cmml">⁢</mo><mrow id="A1.E10.m1.4.4.3.6.2" xref="A1.E10.m1.4.4.3.cmml"><mo id="A1.E10.m1.4.4.3.6.2.1" stretchy="false" xref="A1.E10.m1.4.4.3.cmml">(</mo><mi id="A1.E10.m1.4.4.3.3" xref="A1.E10.m1.4.4.3.3.cmml">γ</mi><mo id="A1.E10.m1.4.4.3.6.2.2" stretchy="false" xref="A1.E10.m1.4.4.3.cmml">)</mo></mrow></mrow><mi id="A1.E10.m1.4.4.5" xref="A1.E10.m1.4.4.5.cmml">μ</mi></mfrac><mo fence="true" id="A1.E10.m1.8.8.3.2.2.2.2.2" lspace="0em" stretchy="true" xref="A1.E10.m1.8.8.3.2.2.2.1.1.cmml">∥</mo></mrow><mi id="A1.E10.m1.8.8.3.2.2.3" mathvariant="normal" xref="A1.E10.m1.8.8.3.2.2.3.cmml">∞</mi><mn id="A1.E10.m1.8.8.3.2.3" xref="A1.E10.m1.8.8.3.2.3.cmml">2</mn></msubsup><mo id="A1.E10.m1.8.8.3.1a" lspace="0em" xref="A1.E10.m1.8.8.3.1.cmml">⁢</mo><msub id="A1.E10.m1.8.8.3.3" xref="A1.E10.m1.8.8.3.3.cmml"><mrow id="A1.E10.m1.8.8.3.3.2.2" xref="A1.E10.m1.8.8.3.3.2.1.cmml"><mo fence="true" id="A1.E10.m1.8.8.3.3.2.2.1" rspace="0em" stretchy="true" xref="A1.E10.m1.8.8.3.3.2.1.1.cmml">∥</mo><mfrac id="A1.E10.m1.7.7" xref="A1.E10.m1.7.7.cmml"><mn id="A1.E10.m1.7.7.2" xref="A1.E10.m1.7.7.2.cmml">1</mn><mi id="A1.E10.m1.7.7.3" xref="A1.E10.m1.7.7.3.cmml">μ</mi></mfrac><mo fence="true" id="A1.E10.m1.8.8.3.3.2.2.2" lspace="0em" stretchy="true" xref="A1.E10.m1.8.8.3.3.2.1.1.cmml">∥</mo></mrow><mi id="A1.E10.m1.8.8.3.3.3" mathvariant="normal" xref="A1.E10.m1.8.8.3.3.3.cmml">∞</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.8b"><apply id="A1.E10.m1.8.8.cmml" xref="A1.E10.m1.8.8"><leq id="A1.E10.m1.8.8.2.cmml" xref="A1.E10.m1.8.8.2"></leq><apply id="A1.E10.m1.8.8.1.cmml" xref="A1.E10.m1.8.8.1"><times id="A1.E10.m1.8.8.1.2.cmml" xref="A1.E10.m1.8.8.1.2"></times><apply id="A1.E10.m1.8.8.1.3.cmml" xref="A1.E10.m1.8.8.1.3"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.1.3.1.cmml" xref="A1.E10.m1.8.8.1.3">subscript</csymbol><ci id="A1.E10.m1.8.8.1.3.2.cmml" xref="A1.E10.m1.8.8.1.3.2">𝐄</ci><apply id="A1.E10.m1.8.8.1.3.3.cmml" xref="A1.E10.m1.8.8.1.3.3"><csymbol cd="latexml" id="A1.E10.m1.8.8.1.3.3.1.cmml" xref="A1.E10.m1.8.8.1.3.3.1">similar-to</csymbol><ci id="A1.E10.m1.8.8.1.3.3.2.cmml" xref="A1.E10.m1.8.8.1.3.3.2">𝑠</ci><ci id="A1.E10.m1.8.8.1.3.3.3.cmml" xref="A1.E10.m1.8.8.1.3.3.3">𝜇</ci></apply></apply><apply id="A1.E10.m1.8.8.1.1.2.cmml" xref="A1.E10.m1.8.8.1.1.1"><csymbol cd="latexml" id="A1.E10.m1.8.8.1.1.2.1.cmml" xref="A1.E10.m1.8.8.1.1.1.2">delimited-[]</csymbol><apply id="A1.E10.m1.8.8.1.1.1.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1"><minus id="A1.E10.m1.8.8.1.1.1.1.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1.1"></minus><apply id="A1.E10.m1.8.8.1.1.1.1.2.cmml" xref="A1.E10.m1.8.8.1.1.1.1.2"><times id="A1.E10.m1.8.8.1.1.1.1.2.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1.2.1"></times><apply id="A1.E10.m1.8.8.1.1.1.1.2.2.cmml" xref="A1.E10.m1.8.8.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.1.1.1.1.2.2.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1.2.2">superscript</csymbol><ci id="A1.E10.m1.8.8.1.1.1.1.2.2.2.cmml" xref="A1.E10.m1.8.8.1.1.1.1.2.2.2">𝑉</ci><times id="A1.E10.m1.8.8.1.1.1.1.2.2.3.cmml" xref="A1.E10.m1.8.8.1.1.1.1.2.2.3"></times></apply><ci id="A1.E10.m1.5.5.cmml" xref="A1.E10.m1.5.5">𝑠</ci></apply><apply id="A1.E10.m1.8.8.1.1.1.1.3.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3"><times id="A1.E10.m1.8.8.1.1.1.1.3.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.1"></times><apply id="A1.E10.m1.8.8.1.1.1.1.3.2.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.1.1.1.1.3.2.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2">superscript</csymbol><ci id="A1.E10.m1.8.8.1.1.1.1.3.2.2.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.2">𝑉</ci><apply id="A1.E10.m1.8.8.1.1.1.1.3.2.3.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.1.1.1.1.3.2.3.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3">subscript</csymbol><ci id="A1.E10.m1.8.8.1.1.1.1.3.2.3.2.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.2">𝜋</ci><apply id="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.1.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.3">subscript</csymbol><ci id="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.2.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.2">𝜃</ci><ci id="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.3.cmml" xref="A1.E10.m1.8.8.1.1.1.1.3.2.3.3.3">𝑡</ci></apply></apply></apply><ci id="A1.E10.m1.6.6.cmml" xref="A1.E10.m1.6.6">𝑠</ci></apply></apply></apply></apply><apply id="A1.E10.m1.8.8.3.cmml" xref="A1.E10.m1.8.8.3"><times id="A1.E10.m1.8.8.3.1.cmml" xref="A1.E10.m1.8.8.3.1"></times><apply id="A1.E10.m1.1.1.cmml" xref="A1.E10.m1.1.1"><divide id="A1.E10.m1.1.1.2.cmml" xref="A1.E10.m1.1.1"></divide><apply id="A1.E10.m1.1.1.3.cmml" xref="A1.E10.m1.1.1.3"><times id="A1.E10.m1.1.1.3.1.cmml" xref="A1.E10.m1.1.1.3.1"></times><cn id="A1.E10.m1.1.1.3.2.cmml" type="integer" xref="A1.E10.m1.1.1.3.2">16</cn><ci id="A1.E10.m1.1.1.3.3.cmml" xref="A1.E10.m1.1.1.3.3">𝑆</ci></apply><apply id="A1.E10.m1.1.1.1.cmml" xref="A1.E10.m1.1.1.1"><times id="A1.E10.m1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.2"></times><apply id="A1.E10.m1.1.1.1.3.cmml" xref="A1.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.3.1.cmml" xref="A1.E10.m1.1.1.1.3">superscript</csymbol><ci id="A1.E10.m1.1.1.1.3.2.cmml" xref="A1.E10.m1.1.1.1.3.2">𝑐</ci><cn id="A1.E10.m1.1.1.1.3.3.cmml" type="integer" xref="A1.E10.m1.1.1.1.3.3">2</cn></apply><apply id="A1.E10.m1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.1">superscript</csymbol><apply id="A1.E10.m1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1.1"><minus id="A1.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E10.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E10.m1.1.1.1.1.1.1.1.2">1</cn><ci id="A1.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.3">𝛾</ci></apply><cn id="A1.E10.m1.1.1.1.1.3.cmml" type="integer" xref="A1.E10.m1.1.1.1.1.3">6</cn></apply><ci id="A1.E10.m1.1.1.1.4.cmml" xref="A1.E10.m1.1.1.1.4">𝑡</ci></apply></apply><apply id="A1.E10.m1.8.8.3.2.cmml" xref="A1.E10.m1.8.8.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.3.2.1.cmml" xref="A1.E10.m1.8.8.3.2">superscript</csymbol><apply id="A1.E10.m1.8.8.3.2.2.cmml" xref="A1.E10.m1.8.8.3.2"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.3.2.2.1.cmml" xref="A1.E10.m1.8.8.3.2">subscript</csymbol><apply id="A1.E10.m1.8.8.3.2.2.2.1.cmml" xref="A1.E10.m1.8.8.3.2.2.2.2"><csymbol cd="latexml" id="A1.E10.m1.8.8.3.2.2.2.1.1.cmml" xref="A1.E10.m1.8.8.3.2.2.2.2.1">delimited-∥∥</csymbol><apply id="A1.E10.m1.4.4.cmml" xref="A1.E10.m1.4.4"><divide id="A1.E10.m1.4.4.4.cmml" xref="A1.E10.m1.4.4"></divide><apply id="A1.E10.m1.4.4.3.cmml" xref="A1.E10.m1.4.4.3"><times id="A1.E10.m1.4.4.3.4.cmml" xref="A1.E10.m1.4.4.3.4"></times><apply id="A1.E10.m1.4.4.3.5.cmml" xref="A1.E10.m1.4.4.3.5"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.3.5.1.cmml" xref="A1.E10.m1.4.4.3.5">subscript</csymbol><apply id="A1.E10.m1.4.4.3.5.2.cmml" xref="A1.E10.m1.4.4.3.5"><csymbol cd="ambiguous" id="A1.E10.m1.4.4.3.5.2.1.cmml" xref="A1.E10.m1.4.4.3.5">superscript</csymbol><ci id="A1.E10.m1.4.4.3.5.2.2.cmml" xref="A1.E10.m1.4.4.3.5.2.2">𝑑</ci><list id="A1.E10.m1.3.3.2.2.2.3.cmml" xref="A1.E10.m1.3.3.2.2.2.4"><ci id="A1.E10.m1.2.2.1.1.1.1.cmml" xref="A1.E10.m1.2.2.1.1.1.1">𝜋</ci><times id="A1.E10.m1.3.3.2.2.2.2.cmml" xref="A1.E10.m1.3.3.2.2.2.2"></times></list></apply><ci id="A1.E10.m1.4.4.3.5.3.cmml" xref="A1.E10.m1.4.4.3.5.3">𝜇</ci></apply><ci id="A1.E10.m1.4.4.3.3.cmml" xref="A1.E10.m1.4.4.3.3">𝛾</ci></apply><ci id="A1.E10.m1.4.4.5.cmml" xref="A1.E10.m1.4.4.5">𝜇</ci></apply></apply><infinity id="A1.E10.m1.8.8.3.2.2.3.cmml" xref="A1.E10.m1.8.8.3.2.2.3"></infinity></apply><cn id="A1.E10.m1.8.8.3.2.3.cmml" type="integer" xref="A1.E10.m1.8.8.3.2.3">2</cn></apply><apply id="A1.E10.m1.8.8.3.3.cmml" xref="A1.E10.m1.8.8.3.3"><csymbol cd="ambiguous" id="A1.E10.m1.8.8.3.3.1.cmml" xref="A1.E10.m1.8.8.3.3">subscript</csymbol><apply id="A1.E10.m1.8.8.3.3.2.1.cmml" xref="A1.E10.m1.8.8.3.3.2.2"><csymbol cd="latexml" id="A1.E10.m1.8.8.3.3.2.1.1.cmml" xref="A1.E10.m1.8.8.3.3.2.2.1">delimited-∥∥</csymbol><apply id="A1.E10.m1.7.7.cmml" xref="A1.E10.m1.7.7"><divide id="A1.E10.m1.7.7.1.cmml" xref="A1.E10.m1.7.7"></divide><cn id="A1.E10.m1.7.7.2.cmml" type="integer" xref="A1.E10.m1.7.7.2">1</cn><ci id="A1.E10.m1.7.7.3.cmml" xref="A1.E10.m1.7.7.3">𝜇</ci></apply></apply><infinity id="A1.E10.m1.8.8.3.3.3.cmml" xref="A1.E10.m1.8.8.3.3.3"></infinity></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.8c">\mathbf{E}_{s\sim\mu}[V^{*}(s)-V^{\pi_{\theta_{t}}}(s)]\leq\frac{16S}{c^{2}(1-%
\gamma)^{6}t}\left\lVert\frac{d^{\pi*}_{\mu}(\gamma)}{\mu}\right\rVert_{\infty%
}^{2}\left\lVert\frac{1}{\mu}\right\rVert_{\infty}</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.8d">bold_E start_POSTSUBSCRIPT italic_s ∼ italic_μ end_POSTSUBSCRIPT [ italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) - italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_s ) ] ≤ divide start_ARG 16 italic_S end_ARG start_ARG italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( 1 - italic_γ ) start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT italic_t end_ARG ∥ divide start_ARG italic_d start_POSTSUPERSCRIPT italic_π ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT ( italic_γ ) end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∥ divide start_ARG 1 end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">See <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S3.Thmtheorem2" title="Proposition 0. ‣ 3.4. The challenge with large action spaces ‣ 3. Optimizing novelty W/ LLM FEEDBACK ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">2</span></a></p>
</div>
<div class="ltx_proof" id="A1.SS1.4">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.SS1.1.p1">
<p class="ltx_p" id="A1.SS1.1.p1.2">Note that our RL setup is one-step, hence we can assume <math alttext="\gamma=0" class="ltx_Math" display="inline" id="A1.SS1.1.p1.1.m1.1"><semantics id="A1.SS1.1.p1.1.m1.1a"><mrow id="A1.SS1.1.p1.1.m1.1.1" xref="A1.SS1.1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.1.p1.1.m1.1.1.2" xref="A1.SS1.1.p1.1.m1.1.1.2.cmml">γ</mi><mo id="A1.SS1.1.p1.1.m1.1.1.1" xref="A1.SS1.1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS1.1.p1.1.m1.1.1.3" xref="A1.SS1.1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.1.m1.1b"><apply id="A1.SS1.1.p1.1.m1.1.1.cmml" xref="A1.SS1.1.p1.1.m1.1.1"><eq id="A1.SS1.1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.1.p1.1.m1.1.1.1"></eq><ci id="A1.SS1.1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.1.p1.1.m1.1.1.2">𝛾</ci><cn id="A1.SS1.1.p1.1.m1.1.1.3.cmml" type="integer" xref="A1.SS1.1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.1.m1.1c">\gamma=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.1.m1.1d">italic_γ = 0</annotation></semantics></math>. Then <math alttext="V^{\pi}(s)" class="ltx_Math" display="inline" id="A1.SS1.1.p1.2.m2.1"><semantics id="A1.SS1.1.p1.2.m2.1a"><mrow id="A1.SS1.1.p1.2.m2.1.2" xref="A1.SS1.1.p1.2.m2.1.2.cmml"><msup id="A1.SS1.1.p1.2.m2.1.2.2" xref="A1.SS1.1.p1.2.m2.1.2.2.cmml"><mi id="A1.SS1.1.p1.2.m2.1.2.2.2" xref="A1.SS1.1.p1.2.m2.1.2.2.2.cmml">V</mi><mi id="A1.SS1.1.p1.2.m2.1.2.2.3" xref="A1.SS1.1.p1.2.m2.1.2.2.3.cmml">π</mi></msup><mo id="A1.SS1.1.p1.2.m2.1.2.1" xref="A1.SS1.1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.1.p1.2.m2.1.2.3.2" xref="A1.SS1.1.p1.2.m2.1.2.cmml"><mo id="A1.SS1.1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="A1.SS1.1.p1.2.m2.1.2.cmml">(</mo><mi id="A1.SS1.1.p1.2.m2.1.1" xref="A1.SS1.1.p1.2.m2.1.1.cmml">s</mi><mo id="A1.SS1.1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="A1.SS1.1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.2.m2.1b"><apply id="A1.SS1.1.p1.2.m2.1.2.cmml" xref="A1.SS1.1.p1.2.m2.1.2"><times id="A1.SS1.1.p1.2.m2.1.2.1.cmml" xref="A1.SS1.1.p1.2.m2.1.2.1"></times><apply id="A1.SS1.1.p1.2.m2.1.2.2.cmml" xref="A1.SS1.1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.1.p1.2.m2.1.2.2.1.cmml" xref="A1.SS1.1.p1.2.m2.1.2.2">superscript</csymbol><ci id="A1.SS1.1.p1.2.m2.1.2.2.2.cmml" xref="A1.SS1.1.p1.2.m2.1.2.2.2">𝑉</ci><ci id="A1.SS1.1.p1.2.m2.1.2.2.3.cmml" xref="A1.SS1.1.p1.2.m2.1.2.2.3">𝜋</ci></apply><ci id="A1.SS1.1.p1.2.m2.1.1.cmml" xref="A1.SS1.1.p1.2.m2.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.2.m2.1c">V^{\pi}(s)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.2.m2.1d">italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s )</annotation></semantics></math> from Theorem 1 simplifies to,</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="V^{\pi}(s)=\mathbf{E}_{a_{t}\sim\pi(.|s_{t})}\sum_{t=0}^{\infty}\gamma^{t}r(s_%
{t},a_{t})=\mathbf{E}_{a_{t}\sim\pi(.|s_{t})}r(s_{0},a_{0})=\mathbf{\pi}(s)^{T%
}\mathbf{r}(s)" class="ltx_math_unparsed" display="block" id="A1.Ex4.m1.7"><semantics id="A1.Ex4.m1.7a"><mrow id="A1.Ex4.m1.7.7"><mrow id="A1.Ex4.m1.7.7.6"><msup id="A1.Ex4.m1.7.7.6.2"><mi id="A1.Ex4.m1.7.7.6.2.2">V</mi><mi id="A1.Ex4.m1.7.7.6.2.3">π</mi></msup><mo id="A1.Ex4.m1.7.7.6.1">⁢</mo><mrow id="A1.Ex4.m1.7.7.6.3.2"><mo id="A1.Ex4.m1.7.7.6.3.2.1" stretchy="false">(</mo><mi id="A1.Ex4.m1.1.1">s</mi><mo id="A1.Ex4.m1.7.7.6.3.2.2" stretchy="false">)</mo></mrow></mrow><mo id="A1.Ex4.m1.7.7.7">=</mo><mrow id="A1.Ex4.m1.5.5.2"><msub id="A1.Ex4.m1.5.5.2.4"><mi id="A1.Ex4.m1.5.5.2.4.2">𝐄</mi><mrow id="A1.Ex4.m1.5.5.2.4.3"><msub id="A1.Ex4.m1.5.5.2.4.3.1"><mi id="A1.Ex4.m1.5.5.2.4.3.1.2">a</mi><mi id="A1.Ex4.m1.5.5.2.4.3.1.3">t</mi></msub><mo id="A1.Ex4.m1.5.5.2.4.3.2">∼</mo><mi id="A1.Ex4.m1.5.5.2.4.3.3">π</mi><mrow id="A1.Ex4.m1.5.5.2.4.3.4"><mo id="A1.Ex4.m1.5.5.2.4.3.4.1" stretchy="false">(</mo><mo id="A1.Ex4.m1.5.5.2.4.3.4.2" lspace="0em" rspace="0.167em">.</mo><mo fence="false" id="A1.Ex4.m1.5.5.2.4.3.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.Ex4.m1.5.5.2.4.3.4.4"><mi id="A1.Ex4.m1.5.5.2.4.3.4.4.2">s</mi><mi id="A1.Ex4.m1.5.5.2.4.3.4.4.3">t</mi></msub><mo id="A1.Ex4.m1.5.5.2.4.3.4.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="A1.Ex4.m1.5.5.2.3">⁢</mo><mrow id="A1.Ex4.m1.5.5.2.2"><munderover id="A1.Ex4.m1.5.5.2.2.3"><mo id="A1.Ex4.m1.5.5.2.2.3.2.2" movablelimits="false">∑</mo><mrow id="A1.Ex4.m1.5.5.2.2.3.2.3"><mi id="A1.Ex4.m1.5.5.2.2.3.2.3.2">t</mi><mo id="A1.Ex4.m1.5.5.2.2.3.2.3.1">=</mo><mn id="A1.Ex4.m1.5.5.2.2.3.2.3.3">0</mn></mrow><mi id="A1.Ex4.m1.5.5.2.2.3.3" mathvariant="normal">∞</mi></munderover><mrow id="A1.Ex4.m1.5.5.2.2.2"><msup id="A1.Ex4.m1.5.5.2.2.2.4"><mi id="A1.Ex4.m1.5.5.2.2.2.4.2">γ</mi><mi id="A1.Ex4.m1.5.5.2.2.2.4.3">t</mi></msup><mo id="A1.Ex4.m1.5.5.2.2.2.3">⁢</mo><mi id="A1.Ex4.m1.5.5.2.2.2.5">r</mi><mo id="A1.Ex4.m1.5.5.2.2.2.3a">⁢</mo><mrow id="A1.Ex4.m1.5.5.2.2.2.2.2"><mo id="A1.Ex4.m1.5.5.2.2.2.2.2.3" stretchy="false">(</mo><msub id="A1.Ex4.m1.4.4.1.1.1.1.1.1"><mi id="A1.Ex4.m1.4.4.1.1.1.1.1.1.2">s</mi><mi id="A1.Ex4.m1.4.4.1.1.1.1.1.1.3">t</mi></msub><mo id="A1.Ex4.m1.5.5.2.2.2.2.2.4">,</mo><msub id="A1.Ex4.m1.5.5.2.2.2.2.2.2"><mi id="A1.Ex4.m1.5.5.2.2.2.2.2.2.2">a</mi><mi id="A1.Ex4.m1.5.5.2.2.2.2.2.2.3">t</mi></msub><mo id="A1.Ex4.m1.5.5.2.2.2.2.2.5" stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo id="A1.Ex4.m1.7.7.8">=</mo><mrow id="A1.Ex4.m1.7.7.4"><msub id="A1.Ex4.m1.7.7.4.4"><mi id="A1.Ex4.m1.7.7.4.4.2">𝐄</mi><mrow id="A1.Ex4.m1.7.7.4.4.3"><msub id="A1.Ex4.m1.7.7.4.4.3.1"><mi id="A1.Ex4.m1.7.7.4.4.3.1.2">a</mi><mi id="A1.Ex4.m1.7.7.4.4.3.1.3">t</mi></msub><mo id="A1.Ex4.m1.7.7.4.4.3.2">∼</mo><mi id="A1.Ex4.m1.7.7.4.4.3.3">π</mi><mrow id="A1.Ex4.m1.7.7.4.4.3.4"><mo id="A1.Ex4.m1.7.7.4.4.3.4.1" stretchy="false">(</mo><mo id="A1.Ex4.m1.7.7.4.4.3.4.2" lspace="0em" rspace="0.167em">.</mo><mo fence="false" id="A1.Ex4.m1.7.7.4.4.3.4.3" rspace="0.167em" stretchy="false">|</mo><msub id="A1.Ex4.m1.7.7.4.4.3.4.4"><mi id="A1.Ex4.m1.7.7.4.4.3.4.4.2">s</mi><mi id="A1.Ex4.m1.7.7.4.4.3.4.4.3">t</mi></msub><mo id="A1.Ex4.m1.7.7.4.4.3.4.5" stretchy="false">)</mo></mrow></mrow></msub><mo id="A1.Ex4.m1.7.7.4.3">⁢</mo><mi id="A1.Ex4.m1.7.7.4.5">r</mi><mo id="A1.Ex4.m1.7.7.4.3a">⁢</mo><mrow id="A1.Ex4.m1.7.7.4.2.2"><mo id="A1.Ex4.m1.7.7.4.2.2.3" stretchy="false">(</mo><msub id="A1.Ex4.m1.6.6.3.1.1.1"><mi id="A1.Ex4.m1.6.6.3.1.1.1.2">s</mi><mn id="A1.Ex4.m1.6.6.3.1.1.1.3">0</mn></msub><mo id="A1.Ex4.m1.7.7.4.2.2.4">,</mo><msub id="A1.Ex4.m1.7.7.4.2.2.2"><mi id="A1.Ex4.m1.7.7.4.2.2.2.2">a</mi><mn id="A1.Ex4.m1.7.7.4.2.2.2.3">0</mn></msub><mo id="A1.Ex4.m1.7.7.4.2.2.5" stretchy="false">)</mo></mrow></mrow><mo id="A1.Ex4.m1.7.7.9">=</mo><mrow id="A1.Ex4.m1.7.7.10"><mi id="A1.Ex4.m1.7.7.10.2">π</mi><mo id="A1.Ex4.m1.7.7.10.1">⁢</mo><msup id="A1.Ex4.m1.7.7.10.3"><mrow id="A1.Ex4.m1.7.7.10.3.2.2"><mo id="A1.Ex4.m1.7.7.10.3.2.2.1" stretchy="false">(</mo><mi id="A1.Ex4.m1.2.2">s</mi><mo id="A1.Ex4.m1.7.7.10.3.2.2.2" stretchy="false">)</mo></mrow><mi id="A1.Ex4.m1.7.7.10.3.3">T</mi></msup><mo id="A1.Ex4.m1.7.7.10.1a">⁢</mo><mi id="A1.Ex4.m1.7.7.10.4">𝐫</mi><mo id="A1.Ex4.m1.7.7.10.1b">⁢</mo><mrow id="A1.Ex4.m1.7.7.10.5.2"><mo id="A1.Ex4.m1.7.7.10.5.2.1" stretchy="false">(</mo><mi id="A1.Ex4.m1.3.3">s</mi><mo id="A1.Ex4.m1.7.7.10.5.2.2" stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex4.m1.7b">V^{\pi}(s)=\mathbf{E}_{a_{t}\sim\pi(.|s_{t})}\sum_{t=0}^{\infty}\gamma^{t}r(s_%
{t},a_{t})=\mathbf{E}_{a_{t}\sim\pi(.|s_{t})}r(s_{0},a_{0})=\mathbf{\pi}(s)^{T%
}\mathbf{r}(s)</annotation><annotation encoding="application/x-llamapun" id="A1.Ex4.m1.7c">italic_V start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s ) = bold_E start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_π ( . | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_r ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = bold_E start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_π ( . | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_r ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = italic_π ( italic_s ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.1.p1.6">where <math alttext="\pi" class="ltx_Math" display="inline" id="A1.SS1.1.p1.3.m1.1"><semantics id="A1.SS1.1.p1.3.m1.1a"><mi id="A1.SS1.1.p1.3.m1.1.1" xref="A1.SS1.1.p1.3.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.3.m1.1b"><ci id="A1.SS1.1.p1.3.m1.1.1.cmml" xref="A1.SS1.1.p1.3.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.3.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.3.m1.1d">italic_π</annotation></semantics></math> and <math alttext="r" class="ltx_Math" display="inline" id="A1.SS1.1.p1.4.m2.1"><semantics id="A1.SS1.1.p1.4.m2.1a"><mi id="A1.SS1.1.p1.4.m2.1.1" xref="A1.SS1.1.p1.4.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.4.m2.1b"><ci id="A1.SS1.1.p1.4.m2.1.1.cmml" xref="A1.SS1.1.p1.4.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.4.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.4.m2.1d">italic_r</annotation></semantics></math> in the last equation refer to the vectors of action probabilities and their rewards given a state. Further, since <math alttext="\gamma=0" class="ltx_Math" display="inline" id="A1.SS1.1.p1.5.m3.1"><semantics id="A1.SS1.1.p1.5.m3.1a"><mrow id="A1.SS1.1.p1.5.m3.1.1" xref="A1.SS1.1.p1.5.m3.1.1.cmml"><mi id="A1.SS1.1.p1.5.m3.1.1.2" xref="A1.SS1.1.p1.5.m3.1.1.2.cmml">γ</mi><mo id="A1.SS1.1.p1.5.m3.1.1.1" xref="A1.SS1.1.p1.5.m3.1.1.1.cmml">=</mo><mn id="A1.SS1.1.p1.5.m3.1.1.3" xref="A1.SS1.1.p1.5.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.5.m3.1b"><apply id="A1.SS1.1.p1.5.m3.1.1.cmml" xref="A1.SS1.1.p1.5.m3.1.1"><eq id="A1.SS1.1.p1.5.m3.1.1.1.cmml" xref="A1.SS1.1.p1.5.m3.1.1.1"></eq><ci id="A1.SS1.1.p1.5.m3.1.1.2.cmml" xref="A1.SS1.1.p1.5.m3.1.1.2">𝛾</ci><cn id="A1.SS1.1.p1.5.m3.1.1.3.cmml" type="integer" xref="A1.SS1.1.p1.5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.5.m3.1c">\gamma=0</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.5.m3.1d">italic_γ = 0</annotation></semantics></math>, <math alttext="d^{\pi*}_{\mu}(\gamma)=\mu" class="ltx_Math" display="inline" id="A1.SS1.1.p1.6.m4.3"><semantics id="A1.SS1.1.p1.6.m4.3a"><mrow id="A1.SS1.1.p1.6.m4.3.4" xref="A1.SS1.1.p1.6.m4.3.4.cmml"><mrow id="A1.SS1.1.p1.6.m4.3.4.2" xref="A1.SS1.1.p1.6.m4.3.4.2.cmml"><msubsup id="A1.SS1.1.p1.6.m4.3.4.2.2" xref="A1.SS1.1.p1.6.m4.3.4.2.2.cmml"><mi id="A1.SS1.1.p1.6.m4.3.4.2.2.2.2" xref="A1.SS1.1.p1.6.m4.3.4.2.2.2.2.cmml">d</mi><mi id="A1.SS1.1.p1.6.m4.3.4.2.2.3" xref="A1.SS1.1.p1.6.m4.3.4.2.2.3.cmml">μ</mi><mrow id="A1.SS1.1.p1.6.m4.2.2.2.4" xref="A1.SS1.1.p1.6.m4.2.2.2.3.cmml"><mi id="A1.SS1.1.p1.6.m4.1.1.1.1" xref="A1.SS1.1.p1.6.m4.1.1.1.1.cmml">π</mi><mo id="A1.SS1.1.p1.6.m4.2.2.2.4.1" lspace="0.222em" xref="A1.SS1.1.p1.6.m4.2.2.2.3.cmml">⁣</mo><mo id="A1.SS1.1.p1.6.m4.2.2.2.2" xref="A1.SS1.1.p1.6.m4.2.2.2.2.cmml">∗</mo></mrow></msubsup><mo id="A1.SS1.1.p1.6.m4.3.4.2.1" xref="A1.SS1.1.p1.6.m4.3.4.2.1.cmml">⁢</mo><mrow id="A1.SS1.1.p1.6.m4.3.4.2.3.2" xref="A1.SS1.1.p1.6.m4.3.4.2.cmml"><mo id="A1.SS1.1.p1.6.m4.3.4.2.3.2.1" stretchy="false" xref="A1.SS1.1.p1.6.m4.3.4.2.cmml">(</mo><mi id="A1.SS1.1.p1.6.m4.3.3" xref="A1.SS1.1.p1.6.m4.3.3.cmml">γ</mi><mo id="A1.SS1.1.p1.6.m4.3.4.2.3.2.2" stretchy="false" xref="A1.SS1.1.p1.6.m4.3.4.2.cmml">)</mo></mrow></mrow><mo id="A1.SS1.1.p1.6.m4.3.4.1" xref="A1.SS1.1.p1.6.m4.3.4.1.cmml">=</mo><mi id="A1.SS1.1.p1.6.m4.3.4.3" xref="A1.SS1.1.p1.6.m4.3.4.3.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.1.p1.6.m4.3b"><apply id="A1.SS1.1.p1.6.m4.3.4.cmml" xref="A1.SS1.1.p1.6.m4.3.4"><eq id="A1.SS1.1.p1.6.m4.3.4.1.cmml" xref="A1.SS1.1.p1.6.m4.3.4.1"></eq><apply id="A1.SS1.1.p1.6.m4.3.4.2.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2"><times id="A1.SS1.1.p1.6.m4.3.4.2.1.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2.1"></times><apply id="A1.SS1.1.p1.6.m4.3.4.2.2.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2.2"><csymbol cd="ambiguous" id="A1.SS1.1.p1.6.m4.3.4.2.2.1.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2.2">subscript</csymbol><apply id="A1.SS1.1.p1.6.m4.3.4.2.2.2.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2.2"><csymbol cd="ambiguous" id="A1.SS1.1.p1.6.m4.3.4.2.2.2.1.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2.2">superscript</csymbol><ci id="A1.SS1.1.p1.6.m4.3.4.2.2.2.2.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2.2.2.2">𝑑</ci><list id="A1.SS1.1.p1.6.m4.2.2.2.3.cmml" xref="A1.SS1.1.p1.6.m4.2.2.2.4"><ci id="A1.SS1.1.p1.6.m4.1.1.1.1.cmml" xref="A1.SS1.1.p1.6.m4.1.1.1.1">𝜋</ci><times id="A1.SS1.1.p1.6.m4.2.2.2.2.cmml" xref="A1.SS1.1.p1.6.m4.2.2.2.2"></times></list></apply><ci id="A1.SS1.1.p1.6.m4.3.4.2.2.3.cmml" xref="A1.SS1.1.p1.6.m4.3.4.2.2.3">𝜇</ci></apply><ci id="A1.SS1.1.p1.6.m4.3.3.cmml" xref="A1.SS1.1.p1.6.m4.3.3">𝛾</ci></apply><ci id="A1.SS1.1.p1.6.m4.3.4.3.cmml" xref="A1.SS1.1.p1.6.m4.3.4.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.1.p1.6.m4.3c">d^{\pi*}_{\mu}(\gamma)=\mu</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.1.p1.6.m4.3d">italic_d start_POSTSUPERSCRIPT italic_π ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT ( italic_γ ) = italic_μ</annotation></semantics></math>. Hence, we can write Theorem 1 as,</p>
</div>
<div class="ltx_para" id="A1.SS1.2.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
<tbody id="A1.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{E}_{s\sim\mu}[V^{*}(s)-V^{\pi_{\theta_{t}}}(s)]" class="ltx_Math" display="inline" id="A1.E11.m1.3"><semantics id="A1.E11.m1.3a"><mrow id="A1.E11.m1.3.3" xref="A1.E11.m1.3.3.cmml"><msub id="A1.E11.m1.3.3.3" xref="A1.E11.m1.3.3.3.cmml"><mi id="A1.E11.m1.3.3.3.2" xref="A1.E11.m1.3.3.3.2.cmml">𝐄</mi><mrow id="A1.E11.m1.3.3.3.3" xref="A1.E11.m1.3.3.3.3.cmml"><mi id="A1.E11.m1.3.3.3.3.2" xref="A1.E11.m1.3.3.3.3.2.cmml">s</mi><mo id="A1.E11.m1.3.3.3.3.1" xref="A1.E11.m1.3.3.3.3.1.cmml">∼</mo><mi id="A1.E11.m1.3.3.3.3.3" xref="A1.E11.m1.3.3.3.3.3.cmml">μ</mi></mrow></msub><mo id="A1.E11.m1.3.3.2" xref="A1.E11.m1.3.3.2.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1" xref="A1.E11.m1.3.3.1.2.cmml"><mo id="A1.E11.m1.3.3.1.1.2" stretchy="false" xref="A1.E11.m1.3.3.1.2.1.cmml">[</mo><mrow id="A1.E11.m1.3.3.1.1.1" xref="A1.E11.m1.3.3.1.1.1.cmml"><mrow id="A1.E11.m1.3.3.1.1.1.2" xref="A1.E11.m1.3.3.1.1.1.2.cmml"><msup id="A1.E11.m1.3.3.1.1.1.2.2" xref="A1.E11.m1.3.3.1.1.1.2.2.cmml"><mi id="A1.E11.m1.3.3.1.1.1.2.2.2" xref="A1.E11.m1.3.3.1.1.1.2.2.2.cmml">V</mi><mo id="A1.E11.m1.3.3.1.1.1.2.2.3" xref="A1.E11.m1.3.3.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.E11.m1.3.3.1.1.1.2.1" xref="A1.E11.m1.3.3.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1.1.2.3.2" xref="A1.E11.m1.3.3.1.1.1.2.cmml"><mo id="A1.E11.m1.3.3.1.1.1.2.3.2.1" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.2.cmml">(</mo><mi id="A1.E11.m1.1.1" xref="A1.E11.m1.1.1.cmml">s</mi><mo id="A1.E11.m1.3.3.1.1.1.2.3.2.2" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.1.1" xref="A1.E11.m1.3.3.1.1.1.1.cmml">−</mo><mrow id="A1.E11.m1.3.3.1.1.1.3" xref="A1.E11.m1.3.3.1.1.1.3.cmml"><msup id="A1.E11.m1.3.3.1.1.1.3.2" xref="A1.E11.m1.3.3.1.1.1.3.2.cmml"><mi id="A1.E11.m1.3.3.1.1.1.3.2.2" xref="A1.E11.m1.3.3.1.1.1.3.2.2.cmml">V</mi><msub id="A1.E11.m1.3.3.1.1.1.3.2.3" xref="A1.E11.m1.3.3.1.1.1.3.2.3.cmml"><mi id="A1.E11.m1.3.3.1.1.1.3.2.3.2" xref="A1.E11.m1.3.3.1.1.1.3.2.3.2.cmml">π</mi><msub id="A1.E11.m1.3.3.1.1.1.3.2.3.3" xref="A1.E11.m1.3.3.1.1.1.3.2.3.3.cmml"><mi id="A1.E11.m1.3.3.1.1.1.3.2.3.3.2" xref="A1.E11.m1.3.3.1.1.1.3.2.3.3.2.cmml">θ</mi><mi id="A1.E11.m1.3.3.1.1.1.3.2.3.3.3" xref="A1.E11.m1.3.3.1.1.1.3.2.3.3.3.cmml">t</mi></msub></msub></msup><mo id="A1.E11.m1.3.3.1.1.1.3.1" xref="A1.E11.m1.3.3.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1.1.3.3.2" xref="A1.E11.m1.3.3.1.1.1.3.cmml"><mo id="A1.E11.m1.3.3.1.1.1.3.3.2.1" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.3.cmml">(</mo><mi id="A1.E11.m1.2.2" xref="A1.E11.m1.2.2.cmml">s</mi><mo id="A1.E11.m1.3.3.1.1.1.3.3.2.2" stretchy="false" xref="A1.E11.m1.3.3.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.3" stretchy="false" xref="A1.E11.m1.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.3b"><apply id="A1.E11.m1.3.3.cmml" xref="A1.E11.m1.3.3"><times id="A1.E11.m1.3.3.2.cmml" xref="A1.E11.m1.3.3.2"></times><apply id="A1.E11.m1.3.3.3.cmml" xref="A1.E11.m1.3.3.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.3.1.cmml" xref="A1.E11.m1.3.3.3">subscript</csymbol><ci id="A1.E11.m1.3.3.3.2.cmml" xref="A1.E11.m1.3.3.3.2">𝐄</ci><apply id="A1.E11.m1.3.3.3.3.cmml" xref="A1.E11.m1.3.3.3.3"><csymbol cd="latexml" id="A1.E11.m1.3.3.3.3.1.cmml" xref="A1.E11.m1.3.3.3.3.1">similar-to</csymbol><ci id="A1.E11.m1.3.3.3.3.2.cmml" xref="A1.E11.m1.3.3.3.3.2">𝑠</ci><ci id="A1.E11.m1.3.3.3.3.3.cmml" xref="A1.E11.m1.3.3.3.3.3">𝜇</ci></apply></apply><apply id="A1.E11.m1.3.3.1.2.cmml" xref="A1.E11.m1.3.3.1.1"><csymbol cd="latexml" id="A1.E11.m1.3.3.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2">delimited-[]</csymbol><apply id="A1.E11.m1.3.3.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1"><minus id="A1.E11.m1.3.3.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1"></minus><apply id="A1.E11.m1.3.3.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1.2"><times id="A1.E11.m1.3.3.1.1.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.2.1"></times><apply id="A1.E11.m1.3.3.1.1.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.2.2">superscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.2.2.2">𝑉</ci><times id="A1.E11.m1.3.3.1.1.1.2.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.2.2.3"></times></apply><ci id="A1.E11.m1.1.1.cmml" xref="A1.E11.m1.1.1">𝑠</ci></apply><apply id="A1.E11.m1.3.3.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.1.3"><times id="A1.E11.m1.3.3.1.1.1.3.1.cmml" xref="A1.E11.m1.3.3.1.1.1.3.1"></times><apply id="A1.E11.m1.3.3.1.1.1.3.2.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.3.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2">superscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.3.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.2">𝑉</ci><apply id="A1.E11.m1.3.3.1.1.1.3.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.3.2.3.1.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.3">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.3.2.3.2.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.3.2">𝜋</ci><apply id="A1.E11.m1.3.3.1.1.1.3.2.3.3.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.3.2.3.3.1.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.3.3">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.3.2.3.3.2.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.3.3.2">𝜃</ci><ci id="A1.E11.m1.3.3.1.1.1.3.2.3.3.3.cmml" xref="A1.E11.m1.3.3.1.1.1.3.2.3.3.3">𝑡</ci></apply></apply></apply><ci id="A1.E11.m1.2.2.cmml" xref="A1.E11.m1.2.2">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.3c">\displaystyle\mathbf{E}_{s\sim\mu}[V^{*}(s)-V^{\pi_{\theta_{t}}}(s)]</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.3d">bold_E start_POSTSUBSCRIPT italic_s ∼ italic_μ end_POSTSUBSCRIPT [ italic_V start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) - italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_s ) ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{E}_{s\sim\mu}[\mathbf{\pi^{*}}(s)^{T}\mathbf{r}(s)-%
\mathbf{\pi_{\theta_{t}}}(s)^{T}\mathbf{r}(s)]" class="ltx_Math" display="inline" id="A1.E11.m2.5"><semantics id="A1.E11.m2.5a"><mrow id="A1.E11.m2.5.5" xref="A1.E11.m2.5.5.cmml"><mi id="A1.E11.m2.5.5.3" xref="A1.E11.m2.5.5.3.cmml"></mi><mo id="A1.E11.m2.5.5.2" xref="A1.E11.m2.5.5.2.cmml">=</mo><mrow id="A1.E11.m2.5.5.1" xref="A1.E11.m2.5.5.1.cmml"><msub id="A1.E11.m2.5.5.1.3" xref="A1.E11.m2.5.5.1.3.cmml"><mi id="A1.E11.m2.5.5.1.3.2" xref="A1.E11.m2.5.5.1.3.2.cmml">𝐄</mi><mrow id="A1.E11.m2.5.5.1.3.3" xref="A1.E11.m2.5.5.1.3.3.cmml"><mi id="A1.E11.m2.5.5.1.3.3.2" xref="A1.E11.m2.5.5.1.3.3.2.cmml">s</mi><mo id="A1.E11.m2.5.5.1.3.3.1" xref="A1.E11.m2.5.5.1.3.3.1.cmml">∼</mo><mi id="A1.E11.m2.5.5.1.3.3.3" xref="A1.E11.m2.5.5.1.3.3.3.cmml">μ</mi></mrow></msub><mo id="A1.E11.m2.5.5.1.2" xref="A1.E11.m2.5.5.1.2.cmml">⁢</mo><mrow id="A1.E11.m2.5.5.1.1.1" xref="A1.E11.m2.5.5.1.1.2.cmml"><mo id="A1.E11.m2.5.5.1.1.1.2" stretchy="false" xref="A1.E11.m2.5.5.1.1.2.1.cmml">[</mo><mrow id="A1.E11.m2.5.5.1.1.1.1" xref="A1.E11.m2.5.5.1.1.1.1.cmml"><mrow id="A1.E11.m2.5.5.1.1.1.1.2" xref="A1.E11.m2.5.5.1.1.1.1.2.cmml"><msup id="A1.E11.m2.5.5.1.1.1.1.2.2" xref="A1.E11.m2.5.5.1.1.1.1.2.2.cmml"><mi id="A1.E11.m2.5.5.1.1.1.1.2.2.2" xref="A1.E11.m2.5.5.1.1.1.1.2.2.2.cmml">π</mi><mo id="A1.E11.m2.5.5.1.1.1.1.2.2.3" xref="A1.E11.m2.5.5.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.E11.m2.5.5.1.1.1.1.2.1" xref="A1.E11.m2.5.5.1.1.1.1.2.1.cmml">⁢</mo><msup id="A1.E11.m2.5.5.1.1.1.1.2.3" xref="A1.E11.m2.5.5.1.1.1.1.2.3.cmml"><mrow id="A1.E11.m2.5.5.1.1.1.1.2.3.2.2" xref="A1.E11.m2.5.5.1.1.1.1.2.3.cmml"><mo id="A1.E11.m2.5.5.1.1.1.1.2.3.2.2.1" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.2.3.cmml">(</mo><mi id="A1.E11.m2.1.1" xref="A1.E11.m2.1.1.cmml">s</mi><mo id="A1.E11.m2.5.5.1.1.1.1.2.3.2.2.2" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.2.3.cmml">)</mo></mrow><mi id="A1.E11.m2.5.5.1.1.1.1.2.3.3" xref="A1.E11.m2.5.5.1.1.1.1.2.3.3.cmml">T</mi></msup><mo id="A1.E11.m2.5.5.1.1.1.1.2.1a" xref="A1.E11.m2.5.5.1.1.1.1.2.1.cmml">⁢</mo><mi id="A1.E11.m2.5.5.1.1.1.1.2.4" xref="A1.E11.m2.5.5.1.1.1.1.2.4.cmml">𝐫</mi><mo id="A1.E11.m2.5.5.1.1.1.1.2.1b" xref="A1.E11.m2.5.5.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E11.m2.5.5.1.1.1.1.2.5.2" xref="A1.E11.m2.5.5.1.1.1.1.2.cmml"><mo id="A1.E11.m2.5.5.1.1.1.1.2.5.2.1" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.2.cmml">(</mo><mi id="A1.E11.m2.2.2" xref="A1.E11.m2.2.2.cmml">s</mi><mo id="A1.E11.m2.5.5.1.1.1.1.2.5.2.2" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E11.m2.5.5.1.1.1.1.1" xref="A1.E11.m2.5.5.1.1.1.1.1.cmml">−</mo><mrow id="A1.E11.m2.5.5.1.1.1.1.3" xref="A1.E11.m2.5.5.1.1.1.1.3.cmml"><msub id="A1.E11.m2.5.5.1.1.1.1.3.2" xref="A1.E11.m2.5.5.1.1.1.1.3.2.cmml"><mi id="A1.E11.m2.5.5.1.1.1.1.3.2.2" xref="A1.E11.m2.5.5.1.1.1.1.3.2.2.cmml">π</mi><msub id="A1.E11.m2.5.5.1.1.1.1.3.2.3" xref="A1.E11.m2.5.5.1.1.1.1.3.2.3.cmml"><mi id="A1.E11.m2.5.5.1.1.1.1.3.2.3.2" xref="A1.E11.m2.5.5.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="A1.E11.m2.5.5.1.1.1.1.3.2.3.3" xref="A1.E11.m2.5.5.1.1.1.1.3.2.3.3.cmml">𝐭</mi></msub></msub><mo id="A1.E11.m2.5.5.1.1.1.1.3.1" xref="A1.E11.m2.5.5.1.1.1.1.3.1.cmml">⁢</mo><msup id="A1.E11.m2.5.5.1.1.1.1.3.3" xref="A1.E11.m2.5.5.1.1.1.1.3.3.cmml"><mrow id="A1.E11.m2.5.5.1.1.1.1.3.3.2.2" xref="A1.E11.m2.5.5.1.1.1.1.3.3.cmml"><mo id="A1.E11.m2.5.5.1.1.1.1.3.3.2.2.1" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.3.3.cmml">(</mo><mi id="A1.E11.m2.3.3" xref="A1.E11.m2.3.3.cmml">s</mi><mo id="A1.E11.m2.5.5.1.1.1.1.3.3.2.2.2" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.3.3.cmml">)</mo></mrow><mi id="A1.E11.m2.5.5.1.1.1.1.3.3.3" xref="A1.E11.m2.5.5.1.1.1.1.3.3.3.cmml">T</mi></msup><mo id="A1.E11.m2.5.5.1.1.1.1.3.1a" xref="A1.E11.m2.5.5.1.1.1.1.3.1.cmml">⁢</mo><mi id="A1.E11.m2.5.5.1.1.1.1.3.4" xref="A1.E11.m2.5.5.1.1.1.1.3.4.cmml">𝐫</mi><mo id="A1.E11.m2.5.5.1.1.1.1.3.1b" xref="A1.E11.m2.5.5.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E11.m2.5.5.1.1.1.1.3.5.2" xref="A1.E11.m2.5.5.1.1.1.1.3.cmml"><mo id="A1.E11.m2.5.5.1.1.1.1.3.5.2.1" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.3.cmml">(</mo><mi id="A1.E11.m2.4.4" xref="A1.E11.m2.4.4.cmml">s</mi><mo id="A1.E11.m2.5.5.1.1.1.1.3.5.2.2" stretchy="false" xref="A1.E11.m2.5.5.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E11.m2.5.5.1.1.1.3" stretchy="false" xref="A1.E11.m2.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m2.5b"><apply id="A1.E11.m2.5.5.cmml" xref="A1.E11.m2.5.5"><eq id="A1.E11.m2.5.5.2.cmml" xref="A1.E11.m2.5.5.2"></eq><csymbol cd="latexml" id="A1.E11.m2.5.5.3.cmml" xref="A1.E11.m2.5.5.3">absent</csymbol><apply id="A1.E11.m2.5.5.1.cmml" xref="A1.E11.m2.5.5.1"><times id="A1.E11.m2.5.5.1.2.cmml" xref="A1.E11.m2.5.5.1.2"></times><apply id="A1.E11.m2.5.5.1.3.cmml" xref="A1.E11.m2.5.5.1.3"><csymbol cd="ambiguous" id="A1.E11.m2.5.5.1.3.1.cmml" xref="A1.E11.m2.5.5.1.3">subscript</csymbol><ci id="A1.E11.m2.5.5.1.3.2.cmml" xref="A1.E11.m2.5.5.1.3.2">𝐄</ci><apply id="A1.E11.m2.5.5.1.3.3.cmml" xref="A1.E11.m2.5.5.1.3.3"><csymbol cd="latexml" id="A1.E11.m2.5.5.1.3.3.1.cmml" xref="A1.E11.m2.5.5.1.3.3.1">similar-to</csymbol><ci id="A1.E11.m2.5.5.1.3.3.2.cmml" xref="A1.E11.m2.5.5.1.3.3.2">𝑠</ci><ci id="A1.E11.m2.5.5.1.3.3.3.cmml" xref="A1.E11.m2.5.5.1.3.3.3">𝜇</ci></apply></apply><apply id="A1.E11.m2.5.5.1.1.2.cmml" xref="A1.E11.m2.5.5.1.1.1"><csymbol cd="latexml" id="A1.E11.m2.5.5.1.1.2.1.cmml" xref="A1.E11.m2.5.5.1.1.1.2">delimited-[]</csymbol><apply id="A1.E11.m2.5.5.1.1.1.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1"><minus id="A1.E11.m2.5.5.1.1.1.1.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.1"></minus><apply id="A1.E11.m2.5.5.1.1.1.1.2.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2"><times id="A1.E11.m2.5.5.1.1.1.1.2.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.1"></times><apply id="A1.E11.m2.5.5.1.1.1.1.2.2.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E11.m2.5.5.1.1.1.1.2.2.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.2">superscript</csymbol><ci id="A1.E11.m2.5.5.1.1.1.1.2.2.2.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.2.2">𝜋</ci><times id="A1.E11.m2.5.5.1.1.1.1.2.2.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.2.3"></times></apply><apply id="A1.E11.m2.5.5.1.1.1.1.2.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E11.m2.5.5.1.1.1.1.2.3.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.3">superscript</csymbol><ci id="A1.E11.m2.1.1.cmml" xref="A1.E11.m2.1.1">𝑠</ci><ci id="A1.E11.m2.5.5.1.1.1.1.2.3.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.3.3">𝑇</ci></apply><ci id="A1.E11.m2.5.5.1.1.1.1.2.4.cmml" xref="A1.E11.m2.5.5.1.1.1.1.2.4">𝐫</ci><ci id="A1.E11.m2.2.2.cmml" xref="A1.E11.m2.2.2">𝑠</ci></apply><apply id="A1.E11.m2.5.5.1.1.1.1.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3"><times id="A1.E11.m2.5.5.1.1.1.1.3.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.1"></times><apply id="A1.E11.m2.5.5.1.1.1.1.3.2.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E11.m2.5.5.1.1.1.1.3.2.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E11.m2.5.5.1.1.1.1.3.2.2.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.2.2">𝜋</ci><apply id="A1.E11.m2.5.5.1.1.1.1.3.2.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E11.m2.5.5.1.1.1.1.3.2.3.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.2.3">subscript</csymbol><ci id="A1.E11.m2.5.5.1.1.1.1.3.2.3.2.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.2.3.2">𝜃</ci><ci id="A1.E11.m2.5.5.1.1.1.1.3.2.3.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.2.3.3">𝐭</ci></apply></apply><apply id="A1.E11.m2.5.5.1.1.1.1.3.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E11.m2.5.5.1.1.1.1.3.3.1.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.3">superscript</csymbol><ci id="A1.E11.m2.3.3.cmml" xref="A1.E11.m2.3.3">𝑠</ci><ci id="A1.E11.m2.5.5.1.1.1.1.3.3.3.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.3.3">𝑇</ci></apply><ci id="A1.E11.m2.5.5.1.1.1.1.3.4.cmml" xref="A1.E11.m2.5.5.1.1.1.1.3.4">𝐫</ci><ci id="A1.E11.m2.4.4.cmml" xref="A1.E11.m2.4.4">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m2.5c">\displaystyle=\mathbf{E}_{s\sim\mu}[\mathbf{\pi^{*}}(s)^{T}\mathbf{r}(s)-%
\mathbf{\pi_{\theta_{t}}}(s)^{T}\mathbf{r}(s)]</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m2.5d">= bold_E start_POSTSUBSCRIPT italic_s ∼ italic_μ end_POSTSUBSCRIPT [ italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_s ) - italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT bold_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_s ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{E}_{s\sim\mu}[(\mathbf{\pi^{*}}(s)-\mathbf{\pi_{\theta_{%
t}}}(s))^{T}\mathbf{r}(s)]" class="ltx_Math" display="inline" id="A1.E12.m1.4"><semantics id="A1.E12.m1.4a"><mrow id="A1.E12.m1.4.4" xref="A1.E12.m1.4.4.cmml"><mi id="A1.E12.m1.4.4.3" xref="A1.E12.m1.4.4.3.cmml"></mi><mo id="A1.E12.m1.4.4.2" xref="A1.E12.m1.4.4.2.cmml">=</mo><mrow id="A1.E12.m1.4.4.1" xref="A1.E12.m1.4.4.1.cmml"><msub id="A1.E12.m1.4.4.1.3" xref="A1.E12.m1.4.4.1.3.cmml"><mi id="A1.E12.m1.4.4.1.3.2" xref="A1.E12.m1.4.4.1.3.2.cmml">𝐄</mi><mrow id="A1.E12.m1.4.4.1.3.3" xref="A1.E12.m1.4.4.1.3.3.cmml"><mi id="A1.E12.m1.4.4.1.3.3.2" xref="A1.E12.m1.4.4.1.3.3.2.cmml">s</mi><mo id="A1.E12.m1.4.4.1.3.3.1" xref="A1.E12.m1.4.4.1.3.3.1.cmml">∼</mo><mi id="A1.E12.m1.4.4.1.3.3.3" xref="A1.E12.m1.4.4.1.3.3.3.cmml">μ</mi></mrow></msub><mo id="A1.E12.m1.4.4.1.2" xref="A1.E12.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.1.1.1" xref="A1.E12.m1.4.4.1.1.2.cmml"><mo id="A1.E12.m1.4.4.1.1.1.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.2.1.cmml">[</mo><mrow id="A1.E12.m1.4.4.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.cmml"><msup id="A1.E12.m1.4.4.1.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.1.cmml"><mrow id="A1.E12.m1.4.4.1.1.1.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><msup id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">π</mi><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.1" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1.cmml">s</mi><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><msub id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3.cmml">𝐭</mi></msub></msub><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.1" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E12.m1.2.2" xref="A1.E12.m1.2.2.cmml">s</mi><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E12.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E12.m1.4.4.1.1.1.1.1.3" xref="A1.E12.m1.4.4.1.1.1.1.1.3.cmml">T</mi></msup><mo id="A1.E12.m1.4.4.1.1.1.1.2" xref="A1.E12.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E12.m1.4.4.1.1.1.1.3" xref="A1.E12.m1.4.4.1.1.1.1.3.cmml">𝐫</mi><mo id="A1.E12.m1.4.4.1.1.1.1.2a" xref="A1.E12.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.1.1.1.1.4.2" xref="A1.E12.m1.4.4.1.1.1.1.cmml"><mo id="A1.E12.m1.4.4.1.1.1.1.4.2.1" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.cmml">(</mo><mi id="A1.E12.m1.3.3" xref="A1.E12.m1.3.3.cmml">s</mi><mo id="A1.E12.m1.4.4.1.1.1.1.4.2.2" stretchy="false" xref="A1.E12.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.4.4.1.1.1.3" stretchy="false" xref="A1.E12.m1.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.4b"><apply id="A1.E12.m1.4.4.cmml" xref="A1.E12.m1.4.4"><eq id="A1.E12.m1.4.4.2.cmml" xref="A1.E12.m1.4.4.2"></eq><csymbol cd="latexml" id="A1.E12.m1.4.4.3.cmml" xref="A1.E12.m1.4.4.3">absent</csymbol><apply id="A1.E12.m1.4.4.1.cmml" xref="A1.E12.m1.4.4.1"><times id="A1.E12.m1.4.4.1.2.cmml" xref="A1.E12.m1.4.4.1.2"></times><apply id="A1.E12.m1.4.4.1.3.cmml" xref="A1.E12.m1.4.4.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.3.1.cmml" xref="A1.E12.m1.4.4.1.3">subscript</csymbol><ci id="A1.E12.m1.4.4.1.3.2.cmml" xref="A1.E12.m1.4.4.1.3.2">𝐄</ci><apply id="A1.E12.m1.4.4.1.3.3.cmml" xref="A1.E12.m1.4.4.1.3.3"><csymbol cd="latexml" id="A1.E12.m1.4.4.1.3.3.1.cmml" xref="A1.E12.m1.4.4.1.3.3.1">similar-to</csymbol><ci id="A1.E12.m1.4.4.1.3.3.2.cmml" xref="A1.E12.m1.4.4.1.3.3.2">𝑠</ci><ci id="A1.E12.m1.4.4.1.3.3.3.cmml" xref="A1.E12.m1.4.4.1.3.3.3">𝜇</ci></apply></apply><apply id="A1.E12.m1.4.4.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.4.4.1.1.2.1.cmml" xref="A1.E12.m1.4.4.1.1.1.2">delimited-[]</csymbol><apply id="A1.E12.m1.4.4.1.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1"><times id="A1.E12.m1.4.4.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.2"></times><apply id="A1.E12.m1.4.4.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1">superscript</csymbol><apply id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1"><minus id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2"><times id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">𝜋</ci><times id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1">𝑠</ci></apply><apply id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3"><times id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.2">𝜋</ci><apply id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3">𝐭</ci></apply></apply><ci id="A1.E12.m1.2.2.cmml" xref="A1.E12.m1.2.2">𝑠</ci></apply></apply><ci id="A1.E12.m1.4.4.1.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.1.3">𝑇</ci></apply><ci id="A1.E12.m1.4.4.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.1.1.1.1.3">𝐫</ci><ci id="A1.E12.m1.3.3.cmml" xref="A1.E12.m1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.4c">\displaystyle=\mathbf{E}_{s\sim\mu}[(\mathbf{\pi^{*}}(s)-\mathbf{\pi_{\theta_{%
t}}}(s))^{T}\mathbf{r}(s)]</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.4d">= bold_E start_POSTSUBSCRIPT italic_s ∼ italic_μ end_POSTSUBSCRIPT [ ( italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) - italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT bold_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_s ) ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_s ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{E}_{x\sim\mathcal{D}}[(\mathbf{\pi^{*}}(x)-\mathbf{\pi_{%
\theta_{t}}}(x))^{T}\mathbf{r}(x)]" class="ltx_Math" display="inline" id="A1.E13.m1.4"><semantics id="A1.E13.m1.4a"><mrow id="A1.E13.m1.4.4" xref="A1.E13.m1.4.4.cmml"><mi id="A1.E13.m1.4.4.3" xref="A1.E13.m1.4.4.3.cmml"></mi><mo id="A1.E13.m1.4.4.2" xref="A1.E13.m1.4.4.2.cmml">=</mo><mrow id="A1.E13.m1.4.4.1" xref="A1.E13.m1.4.4.1.cmml"><msub id="A1.E13.m1.4.4.1.3" xref="A1.E13.m1.4.4.1.3.cmml"><mi id="A1.E13.m1.4.4.1.3.2" xref="A1.E13.m1.4.4.1.3.2.cmml">𝐄</mi><mrow id="A1.E13.m1.4.4.1.3.3" xref="A1.E13.m1.4.4.1.3.3.cmml"><mi id="A1.E13.m1.4.4.1.3.3.2" xref="A1.E13.m1.4.4.1.3.3.2.cmml">x</mi><mo id="A1.E13.m1.4.4.1.3.3.1" xref="A1.E13.m1.4.4.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.4.4.1.3.3.3" xref="A1.E13.m1.4.4.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="A1.E13.m1.4.4.1.2" xref="A1.E13.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.4.4.1.1.1" xref="A1.E13.m1.4.4.1.1.2.cmml"><mo id="A1.E13.m1.4.4.1.1.1.2" stretchy="false" xref="A1.E13.m1.4.4.1.1.2.1.cmml">[</mo><mrow id="A1.E13.m1.4.4.1.1.1.1" xref="A1.E13.m1.4.4.1.1.1.1.cmml"><msup id="A1.E13.m1.4.4.1.1.1.1.1" xref="A1.E13.m1.4.4.1.1.1.1.1.cmml"><mrow id="A1.E13.m1.4.4.1.1.1.1.1.1.1" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><msup id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">π</mi><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.1" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.E13.m1.1.1" xref="A1.E13.m1.1.1.cmml">x</mi><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><msub id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3.cmml">𝐭</mi></msub></msub><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.1" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.E13.m1.2.2" xref="A1.E13.m1.2.2.cmml">x</mi><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E13.m1.4.4.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.E13.m1.4.4.1.1.1.1.1.3" xref="A1.E13.m1.4.4.1.1.1.1.1.3.cmml">T</mi></msup><mo id="A1.E13.m1.4.4.1.1.1.1.2" xref="A1.E13.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mi id="A1.E13.m1.4.4.1.1.1.1.3" xref="A1.E13.m1.4.4.1.1.1.1.3.cmml">𝐫</mi><mo id="A1.E13.m1.4.4.1.1.1.1.2a" xref="A1.E13.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E13.m1.4.4.1.1.1.1.4.2" xref="A1.E13.m1.4.4.1.1.1.1.cmml"><mo id="A1.E13.m1.4.4.1.1.1.1.4.2.1" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.cmml">(</mo><mi id="A1.E13.m1.3.3" xref="A1.E13.m1.3.3.cmml">x</mi><mo id="A1.E13.m1.4.4.1.1.1.1.4.2.2" stretchy="false" xref="A1.E13.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.4.4.1.1.1.3" stretchy="false" xref="A1.E13.m1.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.4b"><apply id="A1.E13.m1.4.4.cmml" xref="A1.E13.m1.4.4"><eq id="A1.E13.m1.4.4.2.cmml" xref="A1.E13.m1.4.4.2"></eq><csymbol cd="latexml" id="A1.E13.m1.4.4.3.cmml" xref="A1.E13.m1.4.4.3">absent</csymbol><apply id="A1.E13.m1.4.4.1.cmml" xref="A1.E13.m1.4.4.1"><times id="A1.E13.m1.4.4.1.2.cmml" xref="A1.E13.m1.4.4.1.2"></times><apply id="A1.E13.m1.4.4.1.3.cmml" xref="A1.E13.m1.4.4.1.3"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.3.1.cmml" xref="A1.E13.m1.4.4.1.3">subscript</csymbol><ci id="A1.E13.m1.4.4.1.3.2.cmml" xref="A1.E13.m1.4.4.1.3.2">𝐄</ci><apply id="A1.E13.m1.4.4.1.3.3.cmml" xref="A1.E13.m1.4.4.1.3.3"><csymbol cd="latexml" id="A1.E13.m1.4.4.1.3.3.1.cmml" xref="A1.E13.m1.4.4.1.3.3.1">similar-to</csymbol><ci id="A1.E13.m1.4.4.1.3.3.2.cmml" xref="A1.E13.m1.4.4.1.3.3.2">𝑥</ci><ci id="A1.E13.m1.4.4.1.3.3.3.cmml" xref="A1.E13.m1.4.4.1.3.3.3">𝒟</ci></apply></apply><apply id="A1.E13.m1.4.4.1.1.2.cmml" xref="A1.E13.m1.4.4.1.1.1"><csymbol cd="latexml" id="A1.E13.m1.4.4.1.1.2.1.cmml" xref="A1.E13.m1.4.4.1.1.1.2">delimited-[]</csymbol><apply id="A1.E13.m1.4.4.1.1.1.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1"><times id="A1.E13.m1.4.4.1.1.1.1.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.2"></times><apply id="A1.E13.m1.4.4.1.1.1.1.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.1.1.1.1.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1">superscript</csymbol><apply id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1"><minus id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2"><times id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">𝜋</ci><times id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="A1.E13.m1.1.1.cmml" xref="A1.E13.m1.1.1">𝑥</ci></apply><apply id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3"><times id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.2">𝜋</ci><apply id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.1.1.1.3.2.3.3">𝐭</ci></apply></apply><ci id="A1.E13.m1.2.2.cmml" xref="A1.E13.m1.2.2">𝑥</ci></apply></apply><ci id="A1.E13.m1.4.4.1.1.1.1.1.3.cmml" xref="A1.E13.m1.4.4.1.1.1.1.1.3">𝑇</ci></apply><ci id="A1.E13.m1.4.4.1.1.1.1.3.cmml" xref="A1.E13.m1.4.4.1.1.1.1.3">𝐫</ci><ci id="A1.E13.m1.3.3.cmml" xref="A1.E13.m1.3.3">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.4c">\displaystyle=\mathbf{E}_{x\sim\mathcal{D}}[(\mathbf{\pi^{*}}(x)-\mathbf{\pi_{%
\theta_{t}}}(x))^{T}\mathbf{r}(x)]</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.4d">= bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT [ ( italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x ) - italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT bold_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\frac{16S}{c^{2}(1-\gamma)^{6}t}\left\lVert\frac{d^{\pi*}_{%
\mu}(\gamma)}{\mu}\right\rVert_{\infty}^{2}\left\lVert\frac{1}{\mu}\right%
\rVert_{\infty}" class="ltx_Math" display="inline" id="A1.E14.m1.5"><semantics id="A1.E14.m1.5a"><mrow id="A1.E14.m1.5.6" xref="A1.E14.m1.5.6.cmml"><mi id="A1.E14.m1.5.6.2" xref="A1.E14.m1.5.6.2.cmml"></mi><mo id="A1.E14.m1.5.6.1" xref="A1.E14.m1.5.6.1.cmml">≤</mo><mrow id="A1.E14.m1.5.6.3" xref="A1.E14.m1.5.6.3.cmml"><mstyle displaystyle="true" id="A1.E14.m1.1.1" xref="A1.E14.m1.1.1.cmml"><mfrac id="A1.E14.m1.1.1a" xref="A1.E14.m1.1.1.cmml"><mrow id="A1.E14.m1.1.1.3" xref="A1.E14.m1.1.1.3.cmml"><mn id="A1.E14.m1.1.1.3.2" xref="A1.E14.m1.1.1.3.2.cmml">16</mn><mo id="A1.E14.m1.1.1.3.1" xref="A1.E14.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.E14.m1.1.1.3.3" xref="A1.E14.m1.1.1.3.3.cmml">S</mi></mrow><mrow id="A1.E14.m1.1.1.1" xref="A1.E14.m1.1.1.1.cmml"><msup id="A1.E14.m1.1.1.1.3" xref="A1.E14.m1.1.1.1.3.cmml"><mi id="A1.E14.m1.1.1.1.3.2" xref="A1.E14.m1.1.1.1.3.2.cmml">c</mi><mn id="A1.E14.m1.1.1.1.3.3" xref="A1.E14.m1.1.1.1.3.3.cmml">2</mn></msup><mo id="A1.E14.m1.1.1.1.2" xref="A1.E14.m1.1.1.1.2.cmml">⁢</mo><msup id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml"><mrow id="A1.E14.m1.1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E14.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E14.m1.1.1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.1.1.cmml"><mn id="A1.E14.m1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.E14.m1.1.1.1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.E14.m1.1.1.1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="A1.E14.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E14.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.E14.m1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.1.3.cmml">6</mn></msup><mo id="A1.E14.m1.1.1.1.2a" xref="A1.E14.m1.1.1.1.2.cmml">⁢</mo><mi id="A1.E14.m1.1.1.1.4" xref="A1.E14.m1.1.1.1.4.cmml">t</mi></mrow></mfrac></mstyle><mo id="A1.E14.m1.5.6.3.1" lspace="0em" xref="A1.E14.m1.5.6.3.1.cmml">⁢</mo><msubsup id="A1.E14.m1.5.6.3.2" xref="A1.E14.m1.5.6.3.2.cmml"><mrow id="A1.E14.m1.5.6.3.2.2.2.2" xref="A1.E14.m1.5.6.3.2.2.2.1.cmml"><mo fence="true" id="A1.E14.m1.5.6.3.2.2.2.2.1" rspace="0em" stretchy="true" xref="A1.E14.m1.5.6.3.2.2.2.1.1.cmml">∥</mo><mstyle displaystyle="true" id="A1.E14.m1.4.4" xref="A1.E14.m1.4.4.cmml"><mfrac id="A1.E14.m1.4.4a" xref="A1.E14.m1.4.4.cmml"><mrow id="A1.E14.m1.4.4.3" xref="A1.E14.m1.4.4.3.cmml"><msubsup id="A1.E14.m1.4.4.3.5" xref="A1.E14.m1.4.4.3.5.cmml"><mi id="A1.E14.m1.4.4.3.5.2.2" xref="A1.E14.m1.4.4.3.5.2.2.cmml">d</mi><mi id="A1.E14.m1.4.4.3.5.3" xref="A1.E14.m1.4.4.3.5.3.cmml">μ</mi><mrow id="A1.E14.m1.3.3.2.2.2.4" xref="A1.E14.m1.3.3.2.2.2.3.cmml"><mi id="A1.E14.m1.2.2.1.1.1.1" xref="A1.E14.m1.2.2.1.1.1.1.cmml">π</mi><mo id="A1.E14.m1.3.3.2.2.2.4.1" lspace="0.222em" xref="A1.E14.m1.3.3.2.2.2.3.cmml">⁣</mo><mo id="A1.E14.m1.3.3.2.2.2.2" xref="A1.E14.m1.3.3.2.2.2.2.cmml">∗</mo></mrow></msubsup><mo id="A1.E14.m1.4.4.3.4" xref="A1.E14.m1.4.4.3.4.cmml">⁢</mo><mrow id="A1.E14.m1.4.4.3.6.2" xref="A1.E14.m1.4.4.3.cmml"><mo id="A1.E14.m1.4.4.3.6.2.1" stretchy="false" xref="A1.E14.m1.4.4.3.cmml">(</mo><mi id="A1.E14.m1.4.4.3.3" xref="A1.E14.m1.4.4.3.3.cmml">γ</mi><mo id="A1.E14.m1.4.4.3.6.2.2" stretchy="false" xref="A1.E14.m1.4.4.3.cmml">)</mo></mrow></mrow><mi id="A1.E14.m1.4.4.5" xref="A1.E14.m1.4.4.5.cmml">μ</mi></mfrac></mstyle><mo fence="true" id="A1.E14.m1.5.6.3.2.2.2.2.2" lspace="0em" stretchy="true" xref="A1.E14.m1.5.6.3.2.2.2.1.1.cmml">∥</mo></mrow><mi id="A1.E14.m1.5.6.3.2.2.3" mathvariant="normal" xref="A1.E14.m1.5.6.3.2.2.3.cmml">∞</mi><mn id="A1.E14.m1.5.6.3.2.3" xref="A1.E14.m1.5.6.3.2.3.cmml">2</mn></msubsup><mo id="A1.E14.m1.5.6.3.1a" lspace="0em" xref="A1.E14.m1.5.6.3.1.cmml">⁢</mo><msub id="A1.E14.m1.5.6.3.3" xref="A1.E14.m1.5.6.3.3.cmml"><mrow id="A1.E14.m1.5.6.3.3.2.2" xref="A1.E14.m1.5.6.3.3.2.1.cmml"><mo fence="true" id="A1.E14.m1.5.6.3.3.2.2.1" rspace="0em" stretchy="true" xref="A1.E14.m1.5.6.3.3.2.1.1.cmml">∥</mo><mstyle displaystyle="true" id="A1.E14.m1.5.5" xref="A1.E14.m1.5.5.cmml"><mfrac id="A1.E14.m1.5.5a" xref="A1.E14.m1.5.5.cmml"><mn id="A1.E14.m1.5.5.2" xref="A1.E14.m1.5.5.2.cmml">1</mn><mi id="A1.E14.m1.5.5.3" xref="A1.E14.m1.5.5.3.cmml">μ</mi></mfrac></mstyle><mo fence="true" id="A1.E14.m1.5.6.3.3.2.2.2" lspace="0em" stretchy="true" xref="A1.E14.m1.5.6.3.3.2.1.1.cmml">∥</mo></mrow><mi id="A1.E14.m1.5.6.3.3.3" mathvariant="normal" xref="A1.E14.m1.5.6.3.3.3.cmml">∞</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.5b"><apply id="A1.E14.m1.5.6.cmml" xref="A1.E14.m1.5.6"><leq id="A1.E14.m1.5.6.1.cmml" xref="A1.E14.m1.5.6.1"></leq><csymbol cd="latexml" id="A1.E14.m1.5.6.2.cmml" xref="A1.E14.m1.5.6.2">absent</csymbol><apply id="A1.E14.m1.5.6.3.cmml" xref="A1.E14.m1.5.6.3"><times id="A1.E14.m1.5.6.3.1.cmml" xref="A1.E14.m1.5.6.3.1"></times><apply id="A1.E14.m1.1.1.cmml" xref="A1.E14.m1.1.1"><divide id="A1.E14.m1.1.1.2.cmml" xref="A1.E14.m1.1.1"></divide><apply id="A1.E14.m1.1.1.3.cmml" xref="A1.E14.m1.1.1.3"><times id="A1.E14.m1.1.1.3.1.cmml" xref="A1.E14.m1.1.1.3.1"></times><cn id="A1.E14.m1.1.1.3.2.cmml" type="integer" xref="A1.E14.m1.1.1.3.2">16</cn><ci id="A1.E14.m1.1.1.3.3.cmml" xref="A1.E14.m1.1.1.3.3">𝑆</ci></apply><apply id="A1.E14.m1.1.1.1.cmml" xref="A1.E14.m1.1.1.1"><times id="A1.E14.m1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.2"></times><apply id="A1.E14.m1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.3.1.cmml" xref="A1.E14.m1.1.1.1.3">superscript</csymbol><ci id="A1.E14.m1.1.1.1.3.2.cmml" xref="A1.E14.m1.1.1.1.3.2">𝑐</ci><cn id="A1.E14.m1.1.1.1.3.3.cmml" type="integer" xref="A1.E14.m1.1.1.1.3.3">2</cn></apply><apply id="A1.E14.m1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.1">superscript</csymbol><apply id="A1.E14.m1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1.1"><minus id="A1.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1.1"></minus><cn id="A1.E14.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A1.E14.m1.1.1.1.1.1.1.1.2">1</cn><ci id="A1.E14.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.1.1.1.1.3">𝛾</ci></apply><cn id="A1.E14.m1.1.1.1.1.3.cmml" type="integer" xref="A1.E14.m1.1.1.1.1.3">6</cn></apply><ci id="A1.E14.m1.1.1.1.4.cmml" xref="A1.E14.m1.1.1.1.4">𝑡</ci></apply></apply><apply id="A1.E14.m1.5.6.3.2.cmml" xref="A1.E14.m1.5.6.3.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.6.3.2.1.cmml" xref="A1.E14.m1.5.6.3.2">superscript</csymbol><apply id="A1.E14.m1.5.6.3.2.2.cmml" xref="A1.E14.m1.5.6.3.2"><csymbol cd="ambiguous" id="A1.E14.m1.5.6.3.2.2.1.cmml" xref="A1.E14.m1.5.6.3.2">subscript</csymbol><apply id="A1.E14.m1.5.6.3.2.2.2.1.cmml" xref="A1.E14.m1.5.6.3.2.2.2.2"><csymbol cd="latexml" id="A1.E14.m1.5.6.3.2.2.2.1.1.cmml" xref="A1.E14.m1.5.6.3.2.2.2.2.1">delimited-∥∥</csymbol><apply id="A1.E14.m1.4.4.cmml" xref="A1.E14.m1.4.4"><divide id="A1.E14.m1.4.4.4.cmml" xref="A1.E14.m1.4.4"></divide><apply id="A1.E14.m1.4.4.3.cmml" xref="A1.E14.m1.4.4.3"><times id="A1.E14.m1.4.4.3.4.cmml" xref="A1.E14.m1.4.4.3.4"></times><apply id="A1.E14.m1.4.4.3.5.cmml" xref="A1.E14.m1.4.4.3.5"><csymbol cd="ambiguous" id="A1.E14.m1.4.4.3.5.1.cmml" xref="A1.E14.m1.4.4.3.5">subscript</csymbol><apply id="A1.E14.m1.4.4.3.5.2.cmml" xref="A1.E14.m1.4.4.3.5"><csymbol cd="ambiguous" id="A1.E14.m1.4.4.3.5.2.1.cmml" xref="A1.E14.m1.4.4.3.5">superscript</csymbol><ci id="A1.E14.m1.4.4.3.5.2.2.cmml" xref="A1.E14.m1.4.4.3.5.2.2">𝑑</ci><list id="A1.E14.m1.3.3.2.2.2.3.cmml" xref="A1.E14.m1.3.3.2.2.2.4"><ci id="A1.E14.m1.2.2.1.1.1.1.cmml" xref="A1.E14.m1.2.2.1.1.1.1">𝜋</ci><times id="A1.E14.m1.3.3.2.2.2.2.cmml" xref="A1.E14.m1.3.3.2.2.2.2"></times></list></apply><ci id="A1.E14.m1.4.4.3.5.3.cmml" xref="A1.E14.m1.4.4.3.5.3">𝜇</ci></apply><ci id="A1.E14.m1.4.4.3.3.cmml" xref="A1.E14.m1.4.4.3.3">𝛾</ci></apply><ci id="A1.E14.m1.4.4.5.cmml" xref="A1.E14.m1.4.4.5">𝜇</ci></apply></apply><infinity id="A1.E14.m1.5.6.3.2.2.3.cmml" xref="A1.E14.m1.5.6.3.2.2.3"></infinity></apply><cn id="A1.E14.m1.5.6.3.2.3.cmml" type="integer" xref="A1.E14.m1.5.6.3.2.3">2</cn></apply><apply id="A1.E14.m1.5.6.3.3.cmml" xref="A1.E14.m1.5.6.3.3"><csymbol cd="ambiguous" id="A1.E14.m1.5.6.3.3.1.cmml" xref="A1.E14.m1.5.6.3.3">subscript</csymbol><apply id="A1.E14.m1.5.6.3.3.2.1.cmml" xref="A1.E14.m1.5.6.3.3.2.2"><csymbol cd="latexml" id="A1.E14.m1.5.6.3.3.2.1.1.cmml" xref="A1.E14.m1.5.6.3.3.2.2.1">delimited-∥∥</csymbol><apply id="A1.E14.m1.5.5.cmml" xref="A1.E14.m1.5.5"><divide id="A1.E14.m1.5.5.1.cmml" xref="A1.E14.m1.5.5"></divide><cn id="A1.E14.m1.5.5.2.cmml" type="integer" xref="A1.E14.m1.5.5.2">1</cn><ci id="A1.E14.m1.5.5.3.cmml" xref="A1.E14.m1.5.5.3">𝜇</ci></apply></apply><infinity id="A1.E14.m1.5.6.3.3.3.cmml" xref="A1.E14.m1.5.6.3.3.3"></infinity></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.5c">\displaystyle\leq\frac{16S}{c^{2}(1-\gamma)^{6}t}\left\lVert\frac{d^{\pi*}_{%
\mu}(\gamma)}{\mu}\right\rVert_{\infty}^{2}\left\lVert\frac{1}{\mu}\right%
\rVert_{\infty}</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.5d">≤ divide start_ARG 16 italic_S end_ARG start_ARG italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( 1 - italic_γ ) start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT italic_t end_ARG ∥ divide start_ARG italic_d start_POSTSUPERSCRIPT italic_π ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_μ end_POSTSUBSCRIPT ( italic_γ ) end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∥ divide start_ARG 1 end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\frac{16S}{c^{2}t}\left\lVert\frac{1}{\mu}\right\rVert_{\infty}" class="ltx_Math" display="inline" id="A1.E15.m1.1"><semantics id="A1.E15.m1.1a"><mrow id="A1.E15.m1.1.2" xref="A1.E15.m1.1.2.cmml"><mi id="A1.E15.m1.1.2.2" xref="A1.E15.m1.1.2.2.cmml"></mi><mo id="A1.E15.m1.1.2.1" xref="A1.E15.m1.1.2.1.cmml">≤</mo><mrow id="A1.E15.m1.1.2.3" xref="A1.E15.m1.1.2.3.cmml"><mstyle displaystyle="true" id="A1.E15.m1.1.2.3.2" xref="A1.E15.m1.1.2.3.2.cmml"><mfrac id="A1.E15.m1.1.2.3.2a" xref="A1.E15.m1.1.2.3.2.cmml"><mrow id="A1.E15.m1.1.2.3.2.2" xref="A1.E15.m1.1.2.3.2.2.cmml"><mn id="A1.E15.m1.1.2.3.2.2.2" xref="A1.E15.m1.1.2.3.2.2.2.cmml">16</mn><mo id="A1.E15.m1.1.2.3.2.2.1" xref="A1.E15.m1.1.2.3.2.2.1.cmml">⁢</mo><mi id="A1.E15.m1.1.2.3.2.2.3" xref="A1.E15.m1.1.2.3.2.2.3.cmml">S</mi></mrow><mrow id="A1.E15.m1.1.2.3.2.3" xref="A1.E15.m1.1.2.3.2.3.cmml"><msup id="A1.E15.m1.1.2.3.2.3.2" xref="A1.E15.m1.1.2.3.2.3.2.cmml"><mi id="A1.E15.m1.1.2.3.2.3.2.2" xref="A1.E15.m1.1.2.3.2.3.2.2.cmml">c</mi><mn id="A1.E15.m1.1.2.3.2.3.2.3" xref="A1.E15.m1.1.2.3.2.3.2.3.cmml">2</mn></msup><mo id="A1.E15.m1.1.2.3.2.3.1" xref="A1.E15.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="A1.E15.m1.1.2.3.2.3.3" xref="A1.E15.m1.1.2.3.2.3.3.cmml">t</mi></mrow></mfrac></mstyle><mo id="A1.E15.m1.1.2.3.1" lspace="0em" xref="A1.E15.m1.1.2.3.1.cmml">⁢</mo><msub id="A1.E15.m1.1.2.3.3" xref="A1.E15.m1.1.2.3.3.cmml"><mrow id="A1.E15.m1.1.2.3.3.2.2" xref="A1.E15.m1.1.2.3.3.2.1.cmml"><mo fence="true" id="A1.E15.m1.1.2.3.3.2.2.1" rspace="0em" stretchy="true" xref="A1.E15.m1.1.2.3.3.2.1.1.cmml">∥</mo><mstyle displaystyle="true" id="A1.E15.m1.1.1" xref="A1.E15.m1.1.1.cmml"><mfrac id="A1.E15.m1.1.1a" xref="A1.E15.m1.1.1.cmml"><mn id="A1.E15.m1.1.1.2" xref="A1.E15.m1.1.1.2.cmml">1</mn><mi id="A1.E15.m1.1.1.3" xref="A1.E15.m1.1.1.3.cmml">μ</mi></mfrac></mstyle><mo fence="true" id="A1.E15.m1.1.2.3.3.2.2.2" lspace="0em" stretchy="true" xref="A1.E15.m1.1.2.3.3.2.1.1.cmml">∥</mo></mrow><mi id="A1.E15.m1.1.2.3.3.3" mathvariant="normal" xref="A1.E15.m1.1.2.3.3.3.cmml">∞</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.1b"><apply id="A1.E15.m1.1.2.cmml" xref="A1.E15.m1.1.2"><leq id="A1.E15.m1.1.2.1.cmml" xref="A1.E15.m1.1.2.1"></leq><csymbol cd="latexml" id="A1.E15.m1.1.2.2.cmml" xref="A1.E15.m1.1.2.2">absent</csymbol><apply id="A1.E15.m1.1.2.3.cmml" xref="A1.E15.m1.1.2.3"><times id="A1.E15.m1.1.2.3.1.cmml" xref="A1.E15.m1.1.2.3.1"></times><apply id="A1.E15.m1.1.2.3.2.cmml" xref="A1.E15.m1.1.2.3.2"><divide id="A1.E15.m1.1.2.3.2.1.cmml" xref="A1.E15.m1.1.2.3.2"></divide><apply id="A1.E15.m1.1.2.3.2.2.cmml" xref="A1.E15.m1.1.2.3.2.2"><times id="A1.E15.m1.1.2.3.2.2.1.cmml" xref="A1.E15.m1.1.2.3.2.2.1"></times><cn id="A1.E15.m1.1.2.3.2.2.2.cmml" type="integer" xref="A1.E15.m1.1.2.3.2.2.2">16</cn><ci id="A1.E15.m1.1.2.3.2.2.3.cmml" xref="A1.E15.m1.1.2.3.2.2.3">𝑆</ci></apply><apply id="A1.E15.m1.1.2.3.2.3.cmml" xref="A1.E15.m1.1.2.3.2.3"><times id="A1.E15.m1.1.2.3.2.3.1.cmml" xref="A1.E15.m1.1.2.3.2.3.1"></times><apply id="A1.E15.m1.1.2.3.2.3.2.cmml" xref="A1.E15.m1.1.2.3.2.3.2"><csymbol cd="ambiguous" id="A1.E15.m1.1.2.3.2.3.2.1.cmml" xref="A1.E15.m1.1.2.3.2.3.2">superscript</csymbol><ci id="A1.E15.m1.1.2.3.2.3.2.2.cmml" xref="A1.E15.m1.1.2.3.2.3.2.2">𝑐</ci><cn id="A1.E15.m1.1.2.3.2.3.2.3.cmml" type="integer" xref="A1.E15.m1.1.2.3.2.3.2.3">2</cn></apply><ci id="A1.E15.m1.1.2.3.2.3.3.cmml" xref="A1.E15.m1.1.2.3.2.3.3">𝑡</ci></apply></apply><apply id="A1.E15.m1.1.2.3.3.cmml" xref="A1.E15.m1.1.2.3.3"><csymbol cd="ambiguous" id="A1.E15.m1.1.2.3.3.1.cmml" xref="A1.E15.m1.1.2.3.3">subscript</csymbol><apply id="A1.E15.m1.1.2.3.3.2.1.cmml" xref="A1.E15.m1.1.2.3.3.2.2"><csymbol cd="latexml" id="A1.E15.m1.1.2.3.3.2.1.1.cmml" xref="A1.E15.m1.1.2.3.3.2.2.1">delimited-∥∥</csymbol><apply id="A1.E15.m1.1.1.cmml" xref="A1.E15.m1.1.1"><divide id="A1.E15.m1.1.1.1.cmml" xref="A1.E15.m1.1.1"></divide><cn id="A1.E15.m1.1.1.2.cmml" type="integer" xref="A1.E15.m1.1.1.2">1</cn><ci id="A1.E15.m1.1.1.3.cmml" xref="A1.E15.m1.1.1.3">𝜇</ci></apply></apply><infinity id="A1.E15.m1.1.2.3.3.3.cmml" xref="A1.E15.m1.1.2.3.3.3"></infinity></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.1c">\displaystyle\leq\frac{16S}{c^{2}t}\left\lVert\frac{1}{\mu}\right\rVert_{\infty}</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.1d">≤ divide start_ARG 16 italic_S end_ARG start_ARG italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_t end_ARG ∥ divide start_ARG 1 end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS1.3.p3">
<p class="ltx_p" id="A1.SS1.3.p3.1">where the third equality is because the initial state distribution is the distribution of queries in the training data.</p>
</div>
<div class="ltx_para" id="A1.SS1.4.p4">
<p class="ltx_p" id="A1.SS1.4.p4.3">Now, using Assumption 2, the minimum initial probability for the optimal action <math alttext="a^{*}" class="ltx_Math" display="inline" id="A1.SS1.4.p4.1.m1.1"><semantics id="A1.SS1.4.p4.1.m1.1a"><msup id="A1.SS1.4.p4.1.m1.1.1" xref="A1.SS1.4.p4.1.m1.1.1.cmml"><mi id="A1.SS1.4.p4.1.m1.1.1.2" xref="A1.SS1.4.p4.1.m1.1.1.2.cmml">a</mi><mo id="A1.SS1.4.p4.1.m1.1.1.3" xref="A1.SS1.4.p4.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.1.m1.1b"><apply id="A1.SS1.4.p4.1.m1.1.1.cmml" xref="A1.SS1.4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.4.p4.1.m1.1.1.1.cmml" xref="A1.SS1.4.p4.1.m1.1.1">superscript</csymbol><ci id="A1.SS1.4.p4.1.m1.1.1.2.cmml" xref="A1.SS1.4.p4.1.m1.1.1.2">𝑎</ci><times id="A1.SS1.4.p4.1.m1.1.1.3.cmml" xref="A1.SS1.4.p4.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.1.m1.1c">a^{*}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.4.p4.1.m1.1d">italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is <math alttext="\frac{1}{\rho A}" class="ltx_Math" display="inline" id="A1.SS1.4.p4.2.m2.1"><semantics id="A1.SS1.4.p4.2.m2.1a"><mfrac id="A1.SS1.4.p4.2.m2.1.1" xref="A1.SS1.4.p4.2.m2.1.1.cmml"><mn id="A1.SS1.4.p4.2.m2.1.1.2" xref="A1.SS1.4.p4.2.m2.1.1.2.cmml">1</mn><mrow id="A1.SS1.4.p4.2.m2.1.1.3" xref="A1.SS1.4.p4.2.m2.1.1.3.cmml"><mi id="A1.SS1.4.p4.2.m2.1.1.3.2" xref="A1.SS1.4.p4.2.m2.1.1.3.2.cmml">ρ</mi><mo id="A1.SS1.4.p4.2.m2.1.1.3.1" xref="A1.SS1.4.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="A1.SS1.4.p4.2.m2.1.1.3.3" xref="A1.SS1.4.p4.2.m2.1.1.3.3.cmml">A</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.2.m2.1b"><apply id="A1.SS1.4.p4.2.m2.1.1.cmml" xref="A1.SS1.4.p4.2.m2.1.1"><divide id="A1.SS1.4.p4.2.m2.1.1.1.cmml" xref="A1.SS1.4.p4.2.m2.1.1"></divide><cn id="A1.SS1.4.p4.2.m2.1.1.2.cmml" type="integer" xref="A1.SS1.4.p4.2.m2.1.1.2">1</cn><apply id="A1.SS1.4.p4.2.m2.1.1.3.cmml" xref="A1.SS1.4.p4.2.m2.1.1.3"><times id="A1.SS1.4.p4.2.m2.1.1.3.1.cmml" xref="A1.SS1.4.p4.2.m2.1.1.3.1"></times><ci id="A1.SS1.4.p4.2.m2.1.1.3.2.cmml" xref="A1.SS1.4.p4.2.m2.1.1.3.2">𝜌</ci><ci id="A1.SS1.4.p4.2.m2.1.1.3.3.cmml" xref="A1.SS1.4.p4.2.m2.1.1.3.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.2.m2.1c">\frac{1}{\rho A}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.4.p4.2.m2.1d">divide start_ARG 1 end_ARG start_ARG italic_ρ italic_A end_ARG</annotation></semantics></math> for all states. Assuming that the gradient updates do not decrease the probability of the optimal action, <math alttext="c=\inf_{s\in S,t\geq 1}\pi_{\theta_{t}}(a^{*}(s)|s)=\frac{1}{\rho A}" class="ltx_Math" display="inline" id="A1.SS1.4.p4.3.m3.4"><semantics id="A1.SS1.4.p4.3.m3.4a"><mrow id="A1.SS1.4.p4.3.m3.4.4" xref="A1.SS1.4.p4.3.m3.4.4.cmml"><mi id="A1.SS1.4.p4.3.m3.4.4.3" xref="A1.SS1.4.p4.3.m3.4.4.3.cmml">c</mi><mo id="A1.SS1.4.p4.3.m3.4.4.4" rspace="0.1389em" xref="A1.SS1.4.p4.3.m3.4.4.4.cmml">=</mo><mrow id="A1.SS1.4.p4.3.m3.4.4.1" xref="A1.SS1.4.p4.3.m3.4.4.1.cmml"><msub id="A1.SS1.4.p4.3.m3.4.4.1.2" xref="A1.SS1.4.p4.3.m3.4.4.1.2.cmml"><mo id="A1.SS1.4.p4.3.m3.4.4.1.2.2" lspace="0.1389em" rspace="0.167em" xref="A1.SS1.4.p4.3.m3.4.4.1.2.2.cmml">inf</mo><mrow id="A1.SS1.4.p4.3.m3.2.2.2.2" xref="A1.SS1.4.p4.3.m3.2.2.2.3.cmml"><mrow id="A1.SS1.4.p4.3.m3.1.1.1.1.1" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1.cmml"><mi id="A1.SS1.4.p4.3.m3.1.1.1.1.1.2" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1.2.cmml">s</mi><mo id="A1.SS1.4.p4.3.m3.1.1.1.1.1.1" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1.1.cmml">∈</mo><mi id="A1.SS1.4.p4.3.m3.1.1.1.1.1.3" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1.3.cmml">S</mi></mrow><mo id="A1.SS1.4.p4.3.m3.2.2.2.2.3" xref="A1.SS1.4.p4.3.m3.2.2.2.3a.cmml">,</mo><mrow id="A1.SS1.4.p4.3.m3.2.2.2.2.2" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2.cmml"><mi id="A1.SS1.4.p4.3.m3.2.2.2.2.2.2" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2.2.cmml">t</mi><mo id="A1.SS1.4.p4.3.m3.2.2.2.2.2.1" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2.1.cmml">≥</mo><mn id="A1.SS1.4.p4.3.m3.2.2.2.2.2.3" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></msub><mrow id="A1.SS1.4.p4.3.m3.4.4.1.1" xref="A1.SS1.4.p4.3.m3.4.4.1.1.cmml"><msub id="A1.SS1.4.p4.3.m3.4.4.1.1.3" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.cmml"><mi id="A1.SS1.4.p4.3.m3.4.4.1.1.3.2" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.2.cmml">π</mi><msub id="A1.SS1.4.p4.3.m3.4.4.1.1.3.3" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.cmml"><mi id="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.2" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.2.cmml">θ</mi><mi id="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.3" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.3.cmml">t</mi></msub></msub><mo id="A1.SS1.4.p4.3.m3.4.4.1.1.2" xref="A1.SS1.4.p4.3.m3.4.4.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.cmml"><mo id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.2" stretchy="false" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.cmml"><mrow id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.cmml"><msup id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.cmml"><mi id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.2" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.2.cmml">a</mi><mo id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.3" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.1" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.3.2" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.cmml"><mo id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.cmml">(</mo><mi id="A1.SS1.4.p4.3.m3.3.3" xref="A1.SS1.4.p4.3.m3.3.3.cmml">s</mi><mo id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo fence="false" id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.1" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.3" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.3" stretchy="false" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.SS1.4.p4.3.m3.4.4.5" xref="A1.SS1.4.p4.3.m3.4.4.5.cmml">=</mo><mfrac id="A1.SS1.4.p4.3.m3.4.4.6" xref="A1.SS1.4.p4.3.m3.4.4.6.cmml"><mn id="A1.SS1.4.p4.3.m3.4.4.6.2" xref="A1.SS1.4.p4.3.m3.4.4.6.2.cmml">1</mn><mrow id="A1.SS1.4.p4.3.m3.4.4.6.3" xref="A1.SS1.4.p4.3.m3.4.4.6.3.cmml"><mi id="A1.SS1.4.p4.3.m3.4.4.6.3.2" xref="A1.SS1.4.p4.3.m3.4.4.6.3.2.cmml">ρ</mi><mo id="A1.SS1.4.p4.3.m3.4.4.6.3.1" xref="A1.SS1.4.p4.3.m3.4.4.6.3.1.cmml">⁢</mo><mi id="A1.SS1.4.p4.3.m3.4.4.6.3.3" xref="A1.SS1.4.p4.3.m3.4.4.6.3.3.cmml">A</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.4.p4.3.m3.4b"><apply id="A1.SS1.4.p4.3.m3.4.4.cmml" xref="A1.SS1.4.p4.3.m3.4.4"><and id="A1.SS1.4.p4.3.m3.4.4a.cmml" xref="A1.SS1.4.p4.3.m3.4.4"></and><apply id="A1.SS1.4.p4.3.m3.4.4b.cmml" xref="A1.SS1.4.p4.3.m3.4.4"><eq id="A1.SS1.4.p4.3.m3.4.4.4.cmml" xref="A1.SS1.4.p4.3.m3.4.4.4"></eq><ci id="A1.SS1.4.p4.3.m3.4.4.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.3">𝑐</ci><apply id="A1.SS1.4.p4.3.m3.4.4.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1"><apply id="A1.SS1.4.p4.3.m3.4.4.1.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.2"><csymbol cd="ambiguous" id="A1.SS1.4.p4.3.m3.4.4.1.2.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.2">subscript</csymbol><csymbol cd="latexml" id="A1.SS1.4.p4.3.m3.4.4.1.2.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.2.2">infimum</csymbol><apply id="A1.SS1.4.p4.3.m3.2.2.2.3.cmml" xref="A1.SS1.4.p4.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.4.p4.3.m3.2.2.2.3a.cmml" xref="A1.SS1.4.p4.3.m3.2.2.2.2.3">formulae-sequence</csymbol><apply id="A1.SS1.4.p4.3.m3.1.1.1.1.1.cmml" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1"><in id="A1.SS1.4.p4.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1.1"></in><ci id="A1.SS1.4.p4.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1.2">𝑠</ci><ci id="A1.SS1.4.p4.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS1.4.p4.3.m3.1.1.1.1.1.3">𝑆</ci></apply><apply id="A1.SS1.4.p4.3.m3.2.2.2.2.2.cmml" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2"><geq id="A1.SS1.4.p4.3.m3.2.2.2.2.2.1.cmml" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2.1"></geq><ci id="A1.SS1.4.p4.3.m3.2.2.2.2.2.2.cmml" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2.2">𝑡</ci><cn id="A1.SS1.4.p4.3.m3.2.2.2.2.2.3.cmml" type="integer" xref="A1.SS1.4.p4.3.m3.2.2.2.2.2.3">1</cn></apply></apply></apply><apply id="A1.SS1.4.p4.3.m3.4.4.1.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1"><times id="A1.SS1.4.p4.3.m3.4.4.1.1.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.2"></times><apply id="A1.SS1.4.p4.3.m3.4.4.1.1.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.4.p4.3.m3.4.4.1.1.3.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3">subscript</csymbol><ci id="A1.SS1.4.p4.3.m3.4.4.1.1.3.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.2">𝜋</ci><apply id="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.3">subscript</csymbol><ci id="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.2">𝜃</ci><ci id="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.3.3.3">𝑡</ci></apply></apply><apply id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2"><times id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.1"></times><apply id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2">superscript</csymbol><ci id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.2">𝑎</ci><times id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.2.2.3"></times></apply><ci id="A1.SS1.4.p4.3.m3.3.3.cmml" xref="A1.SS1.4.p4.3.m3.3.3">𝑠</ci></apply><ci id="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply><apply id="A1.SS1.4.p4.3.m3.4.4c.cmml" xref="A1.SS1.4.p4.3.m3.4.4"><eq id="A1.SS1.4.p4.3.m3.4.4.5.cmml" xref="A1.SS1.4.p4.3.m3.4.4.5"></eq><share href="https://arxiv.org/html/2406.14169v1#A1.SS1.4.p4.3.m3.4.4.1.cmml" id="A1.SS1.4.p4.3.m3.4.4d.cmml" xref="A1.SS1.4.p4.3.m3.4.4"></share><apply id="A1.SS1.4.p4.3.m3.4.4.6.cmml" xref="A1.SS1.4.p4.3.m3.4.4.6"><divide id="A1.SS1.4.p4.3.m3.4.4.6.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.6"></divide><cn id="A1.SS1.4.p4.3.m3.4.4.6.2.cmml" type="integer" xref="A1.SS1.4.p4.3.m3.4.4.6.2">1</cn><apply id="A1.SS1.4.p4.3.m3.4.4.6.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.6.3"><times id="A1.SS1.4.p4.3.m3.4.4.6.3.1.cmml" xref="A1.SS1.4.p4.3.m3.4.4.6.3.1"></times><ci id="A1.SS1.4.p4.3.m3.4.4.6.3.2.cmml" xref="A1.SS1.4.p4.3.m3.4.4.6.3.2">𝜌</ci><ci id="A1.SS1.4.p4.3.m3.4.4.6.3.3.cmml" xref="A1.SS1.4.p4.3.m3.4.4.6.3.3">𝐴</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.4.p4.3.m3.4c">c=\inf_{s\in S,t\geq 1}\pi_{\theta_{t}}(a^{*}(s)|s)=\frac{1}{\rho A}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.4.p4.3.m3.4d">italic_c = roman_inf start_POSTSUBSCRIPT italic_s ∈ italic_S , italic_t ≥ 1 end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_s ) | italic_s ) = divide start_ARG 1 end_ARG start_ARG italic_ρ italic_A end_ARG</annotation></semantics></math>.
Substituting c in the above equation, we obtain the result.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}_{x\sim\mathcal{D}}[(\mathbf{\pi^{*}}(x)-\mathbf{\pi_{\theta_{t}}}(x%
))^{T}\mathbf{r}(x)]\leq\frac{16SA^{2}\rho^{2}}{t}\left\lVert\frac{1}{\mu}%
\right\rVert_{\infty}" class="ltx_Math" display="block" id="A1.Ex5.m1.5"><semantics id="A1.Ex5.m1.5a"><mrow id="A1.Ex5.m1.5.5" xref="A1.Ex5.m1.5.5.cmml"><mrow id="A1.Ex5.m1.5.5.1" xref="A1.Ex5.m1.5.5.1.cmml"><msub id="A1.Ex5.m1.5.5.1.3" xref="A1.Ex5.m1.5.5.1.3.cmml"><mi id="A1.Ex5.m1.5.5.1.3.2" xref="A1.Ex5.m1.5.5.1.3.2.cmml">𝐄</mi><mrow id="A1.Ex5.m1.5.5.1.3.3" xref="A1.Ex5.m1.5.5.1.3.3.cmml"><mi id="A1.Ex5.m1.5.5.1.3.3.2" xref="A1.Ex5.m1.5.5.1.3.3.2.cmml">x</mi><mo id="A1.Ex5.m1.5.5.1.3.3.1" xref="A1.Ex5.m1.5.5.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.Ex5.m1.5.5.1.3.3.3" xref="A1.Ex5.m1.5.5.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="A1.Ex5.m1.5.5.1.2" xref="A1.Ex5.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.1" xref="A1.Ex5.m1.5.5.1.1.2.cmml"><mo id="A1.Ex5.m1.5.5.1.1.1.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.2.1.cmml">[</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.cmml"><msup id="A1.Ex5.m1.5.5.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.cmml"><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><msup id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml">π</mi><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msup><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.3.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.Ex5.m1.1.1" xref="A1.Ex5.m1.1.1.cmml">x</mi><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><msub id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3.cmml">𝐭</mi></msub></msub><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.3.2" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="A1.Ex5.m1.2.2" xref="A1.Ex5.m1.2.2.cmml">x</mi><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A1.Ex5.m1.5.5.1.1.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.1.1.1.3.cmml">T</mi></msup><mo id="A1.Ex5.m1.5.5.1.1.1.1.2" xref="A1.Ex5.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex5.m1.5.5.1.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.1.1.3.cmml">𝐫</mi><mo id="A1.Ex5.m1.5.5.1.1.1.1.2a" xref="A1.Ex5.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1.4.2" xref="A1.Ex5.m1.5.5.1.1.1.1.cmml"><mo id="A1.Ex5.m1.5.5.1.1.1.1.4.2.1" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.cmml">(</mo><mi id="A1.Ex5.m1.3.3" xref="A1.Ex5.m1.3.3.cmml">x</mi><mo id="A1.Ex5.m1.5.5.1.1.1.1.4.2.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex5.m1.5.5.1.1.1.3" stretchy="false" xref="A1.Ex5.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A1.Ex5.m1.5.5.2" xref="A1.Ex5.m1.5.5.2.cmml">≤</mo><mrow id="A1.Ex5.m1.5.5.3" xref="A1.Ex5.m1.5.5.3.cmml"><mfrac id="A1.Ex5.m1.5.5.3.2" xref="A1.Ex5.m1.5.5.3.2.cmml"><mrow id="A1.Ex5.m1.5.5.3.2.2" xref="A1.Ex5.m1.5.5.3.2.2.cmml"><mn id="A1.Ex5.m1.5.5.3.2.2.2" xref="A1.Ex5.m1.5.5.3.2.2.2.cmml">16</mn><mo id="A1.Ex5.m1.5.5.3.2.2.1" xref="A1.Ex5.m1.5.5.3.2.2.1.cmml">⁢</mo><mi id="A1.Ex5.m1.5.5.3.2.2.3" xref="A1.Ex5.m1.5.5.3.2.2.3.cmml">S</mi><mo id="A1.Ex5.m1.5.5.3.2.2.1a" xref="A1.Ex5.m1.5.5.3.2.2.1.cmml">⁢</mo><msup id="A1.Ex5.m1.5.5.3.2.2.4" xref="A1.Ex5.m1.5.5.3.2.2.4.cmml"><mi id="A1.Ex5.m1.5.5.3.2.2.4.2" xref="A1.Ex5.m1.5.5.3.2.2.4.2.cmml">A</mi><mn id="A1.Ex5.m1.5.5.3.2.2.4.3" xref="A1.Ex5.m1.5.5.3.2.2.4.3.cmml">2</mn></msup><mo id="A1.Ex5.m1.5.5.3.2.2.1b" xref="A1.Ex5.m1.5.5.3.2.2.1.cmml">⁢</mo><msup id="A1.Ex5.m1.5.5.3.2.2.5" xref="A1.Ex5.m1.5.5.3.2.2.5.cmml"><mi id="A1.Ex5.m1.5.5.3.2.2.5.2" xref="A1.Ex5.m1.5.5.3.2.2.5.2.cmml">ρ</mi><mn id="A1.Ex5.m1.5.5.3.2.2.5.3" xref="A1.Ex5.m1.5.5.3.2.2.5.3.cmml">2</mn></msup></mrow><mi id="A1.Ex5.m1.5.5.3.2.3" xref="A1.Ex5.m1.5.5.3.2.3.cmml">t</mi></mfrac><mo id="A1.Ex5.m1.5.5.3.1" lspace="0em" xref="A1.Ex5.m1.5.5.3.1.cmml">⁢</mo><msub id="A1.Ex5.m1.5.5.3.3" xref="A1.Ex5.m1.5.5.3.3.cmml"><mrow id="A1.Ex5.m1.5.5.3.3.2.2" xref="A1.Ex5.m1.5.5.3.3.2.1.cmml"><mo fence="true" id="A1.Ex5.m1.5.5.3.3.2.2.1" rspace="0em" stretchy="true" xref="A1.Ex5.m1.5.5.3.3.2.1.1.cmml">∥</mo><mfrac id="A1.Ex5.m1.4.4" xref="A1.Ex5.m1.4.4.cmml"><mn id="A1.Ex5.m1.4.4.2" xref="A1.Ex5.m1.4.4.2.cmml">1</mn><mi id="A1.Ex5.m1.4.4.3" xref="A1.Ex5.m1.4.4.3.cmml">μ</mi></mfrac><mo fence="true" id="A1.Ex5.m1.5.5.3.3.2.2.2" lspace="0em" stretchy="true" xref="A1.Ex5.m1.5.5.3.3.2.1.1.cmml">∥</mo></mrow><mi id="A1.Ex5.m1.5.5.3.3.3" mathvariant="normal" xref="A1.Ex5.m1.5.5.3.3.3.cmml">∞</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.5b"><apply id="A1.Ex5.m1.5.5.cmml" xref="A1.Ex5.m1.5.5"><leq id="A1.Ex5.m1.5.5.2.cmml" xref="A1.Ex5.m1.5.5.2"></leq><apply id="A1.Ex5.m1.5.5.1.cmml" xref="A1.Ex5.m1.5.5.1"><times id="A1.Ex5.m1.5.5.1.2.cmml" xref="A1.Ex5.m1.5.5.1.2"></times><apply id="A1.Ex5.m1.5.5.1.3.cmml" xref="A1.Ex5.m1.5.5.1.3"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.3.1.cmml" xref="A1.Ex5.m1.5.5.1.3">subscript</csymbol><ci id="A1.Ex5.m1.5.5.1.3.2.cmml" xref="A1.Ex5.m1.5.5.1.3.2">𝐄</ci><apply id="A1.Ex5.m1.5.5.1.3.3.cmml" xref="A1.Ex5.m1.5.5.1.3.3"><csymbol cd="latexml" id="A1.Ex5.m1.5.5.1.3.3.1.cmml" xref="A1.Ex5.m1.5.5.1.3.3.1">similar-to</csymbol><ci id="A1.Ex5.m1.5.5.1.3.3.2.cmml" xref="A1.Ex5.m1.5.5.1.3.3.2">𝑥</ci><ci id="A1.Ex5.m1.5.5.1.3.3.3.cmml" xref="A1.Ex5.m1.5.5.1.3.3.3">𝒟</ci></apply></apply><apply id="A1.Ex5.m1.5.5.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1"><csymbol cd="latexml" id="A1.Ex5.m1.5.5.1.1.2.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="A1.Ex5.m1.5.5.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1"><times id="A1.Ex5.m1.5.5.1.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.2"></times><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1">superscript</csymbol><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1"><minus id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.1"></minus><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2"><times id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.1"></times><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.2">𝜋</ci><times id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="A1.Ex5.m1.1.1.cmml" xref="A1.Ex5.m1.1.1">𝑥</ci></apply><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3"><times id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.2">𝜋</ci><apply id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.3">𝐭</ci></apply></apply><ci id="A1.Ex5.m1.2.2.cmml" xref="A1.Ex5.m1.2.2">𝑥</ci></apply></apply><ci id="A1.Ex5.m1.5.5.1.1.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1.3">𝑇</ci></apply><ci id="A1.Ex5.m1.5.5.1.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.3">𝐫</ci><ci id="A1.Ex5.m1.3.3.cmml" xref="A1.Ex5.m1.3.3">𝑥</ci></apply></apply></apply><apply id="A1.Ex5.m1.5.5.3.cmml" xref="A1.Ex5.m1.5.5.3"><times id="A1.Ex5.m1.5.5.3.1.cmml" xref="A1.Ex5.m1.5.5.3.1"></times><apply id="A1.Ex5.m1.5.5.3.2.cmml" xref="A1.Ex5.m1.5.5.3.2"><divide id="A1.Ex5.m1.5.5.3.2.1.cmml" xref="A1.Ex5.m1.5.5.3.2"></divide><apply id="A1.Ex5.m1.5.5.3.2.2.cmml" xref="A1.Ex5.m1.5.5.3.2.2"><times id="A1.Ex5.m1.5.5.3.2.2.1.cmml" xref="A1.Ex5.m1.5.5.3.2.2.1"></times><cn id="A1.Ex5.m1.5.5.3.2.2.2.cmml" type="integer" xref="A1.Ex5.m1.5.5.3.2.2.2">16</cn><ci id="A1.Ex5.m1.5.5.3.2.2.3.cmml" xref="A1.Ex5.m1.5.5.3.2.2.3">𝑆</ci><apply id="A1.Ex5.m1.5.5.3.2.2.4.cmml" xref="A1.Ex5.m1.5.5.3.2.2.4"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.3.2.2.4.1.cmml" xref="A1.Ex5.m1.5.5.3.2.2.4">superscript</csymbol><ci id="A1.Ex5.m1.5.5.3.2.2.4.2.cmml" xref="A1.Ex5.m1.5.5.3.2.2.4.2">𝐴</ci><cn id="A1.Ex5.m1.5.5.3.2.2.4.3.cmml" type="integer" xref="A1.Ex5.m1.5.5.3.2.2.4.3">2</cn></apply><apply id="A1.Ex5.m1.5.5.3.2.2.5.cmml" xref="A1.Ex5.m1.5.5.3.2.2.5"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.3.2.2.5.1.cmml" xref="A1.Ex5.m1.5.5.3.2.2.5">superscript</csymbol><ci id="A1.Ex5.m1.5.5.3.2.2.5.2.cmml" xref="A1.Ex5.m1.5.5.3.2.2.5.2">𝜌</ci><cn id="A1.Ex5.m1.5.5.3.2.2.5.3.cmml" type="integer" xref="A1.Ex5.m1.5.5.3.2.2.5.3">2</cn></apply></apply><ci id="A1.Ex5.m1.5.5.3.2.3.cmml" xref="A1.Ex5.m1.5.5.3.2.3">𝑡</ci></apply><apply id="A1.Ex5.m1.5.5.3.3.cmml" xref="A1.Ex5.m1.5.5.3.3"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.3.3.1.cmml" xref="A1.Ex5.m1.5.5.3.3">subscript</csymbol><apply id="A1.Ex5.m1.5.5.3.3.2.1.cmml" xref="A1.Ex5.m1.5.5.3.3.2.2"><csymbol cd="latexml" id="A1.Ex5.m1.5.5.3.3.2.1.1.cmml" xref="A1.Ex5.m1.5.5.3.3.2.2.1">delimited-∥∥</csymbol><apply id="A1.Ex5.m1.4.4.cmml" xref="A1.Ex5.m1.4.4"><divide id="A1.Ex5.m1.4.4.1.cmml" xref="A1.Ex5.m1.4.4"></divide><cn id="A1.Ex5.m1.4.4.2.cmml" type="integer" xref="A1.Ex5.m1.4.4.2">1</cn><ci id="A1.Ex5.m1.4.4.3.cmml" xref="A1.Ex5.m1.4.4.3">𝜇</ci></apply></apply><infinity id="A1.Ex5.m1.5.5.3.3.3.cmml" xref="A1.Ex5.m1.5.5.3.3.3"></infinity></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m1.5c">\mathbf{E}_{x\sim\mathcal{D}}[(\mathbf{\pi^{*}}(x)-\mathbf{\pi_{\theta_{t}}}(x%
))^{T}\mathbf{r}(x)]\leq\frac{16SA^{2}\rho^{2}}{t}\left\lVert\frac{1}{\mu}%
\right\rVert_{\infty}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m1.5d">bold_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D end_POSTSUBSCRIPT [ ( italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x ) - italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT bold_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x ) ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_r ( italic_x ) ] ≤ divide start_ARG 16 italic_S italic_A start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_ρ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t end_ARG ∥ divide start_ARG 1 end_ARG start_ARG italic_μ end_ARG ∥ start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS1.4.p4.4">∎</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2. </span>Proposition 2</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">See <a class="ltx_ref" href="https://arxiv.org/html/2406.14169v1#S4.Thmtheorem1" title="Proposition 0. ‣ 4.2. Reduction to binary action space ‣ 4. Large Action Policy Gradient ‣ Optimizing Novelty of Top-k Recommendations using Large Language Models and Reinforcement Learning"><span class="ltx_text ltx_ref_tag">1</span></a></p>
</div>
<div class="ltx_proof" id="A1.SS2.1">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="A1.SS2.1.p1">
<p class="ltx_p" id="A1.SS2.1.p1.2">Using the equation from Proposition 1 and substituting <math alttext="S=SA" class="ltx_Math" display="inline" id="A1.SS2.1.p1.1.m1.1"><semantics id="A1.SS2.1.p1.1.m1.1a"><mrow id="A1.SS2.1.p1.1.m1.1.1" xref="A1.SS2.1.p1.1.m1.1.1.cmml"><mi id="A1.SS2.1.p1.1.m1.1.1.2" xref="A1.SS2.1.p1.1.m1.1.1.2.cmml">S</mi><mo id="A1.SS2.1.p1.1.m1.1.1.1" xref="A1.SS2.1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="A1.SS2.1.p1.1.m1.1.1.3" xref="A1.SS2.1.p1.1.m1.1.1.3.cmml"><mi id="A1.SS2.1.p1.1.m1.1.1.3.2" xref="A1.SS2.1.p1.1.m1.1.1.3.2.cmml">S</mi><mo id="A1.SS2.1.p1.1.m1.1.1.3.1" xref="A1.SS2.1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.1.p1.1.m1.1.1.3.3" xref="A1.SS2.1.p1.1.m1.1.1.3.3.cmml">A</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.1.p1.1.m1.1b"><apply id="A1.SS2.1.p1.1.m1.1.1.cmml" xref="A1.SS2.1.p1.1.m1.1.1"><eq id="A1.SS2.1.p1.1.m1.1.1.1.cmml" xref="A1.SS2.1.p1.1.m1.1.1.1"></eq><ci id="A1.SS2.1.p1.1.m1.1.1.2.cmml" xref="A1.SS2.1.p1.1.m1.1.1.2">𝑆</ci><apply id="A1.SS2.1.p1.1.m1.1.1.3.cmml" xref="A1.SS2.1.p1.1.m1.1.1.3"><times id="A1.SS2.1.p1.1.m1.1.1.3.1.cmml" xref="A1.SS2.1.p1.1.m1.1.1.3.1"></times><ci id="A1.SS2.1.p1.1.m1.1.1.3.2.cmml" xref="A1.SS2.1.p1.1.m1.1.1.3.2">𝑆</ci><ci id="A1.SS2.1.p1.1.m1.1.1.3.3.cmml" xref="A1.SS2.1.p1.1.m1.1.1.3.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.1.p1.1.m1.1c">S=SA</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.1.p1.1.m1.1d">italic_S = italic_S italic_A</annotation></semantics></math> and <math alttext="A=2" class="ltx_Math" display="inline" id="A1.SS2.1.p1.2.m2.1"><semantics id="A1.SS2.1.p1.2.m2.1a"><mrow id="A1.SS2.1.p1.2.m2.1.1" xref="A1.SS2.1.p1.2.m2.1.1.cmml"><mi id="A1.SS2.1.p1.2.m2.1.1.2" xref="A1.SS2.1.p1.2.m2.1.1.2.cmml">A</mi><mo id="A1.SS2.1.p1.2.m2.1.1.1" xref="A1.SS2.1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A1.SS2.1.p1.2.m2.1.1.3" xref="A1.SS2.1.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.1.p1.2.m2.1b"><apply id="A1.SS2.1.p1.2.m2.1.1.cmml" xref="A1.SS2.1.p1.2.m2.1.1"><eq id="A1.SS2.1.p1.2.m2.1.1.1.cmml" xref="A1.SS2.1.p1.2.m2.1.1.1"></eq><ci id="A1.SS2.1.p1.2.m2.1.1.2.cmml" xref="A1.SS2.1.p1.2.m2.1.1.2">𝐴</ci><cn id="A1.SS2.1.p1.2.m2.1.1.3.cmml" type="integer" xref="A1.SS2.1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.1.p1.2.m2.1c">A=2</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.1.p1.2.m2.1d">italic_A = 2</annotation></semantics></math> leads us to the result.
∎</p>
</div>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jun 20 09:56:28 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
