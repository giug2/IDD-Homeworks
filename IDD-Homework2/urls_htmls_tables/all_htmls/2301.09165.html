<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2301.09165] Energy Prediction using Federated Learning</title><meta property="og:description" content="In this work, we demonstrate the viability of using federated learning to successfully predict energy consumption as well as solar production for all households within a certain network using low-power and low-space co‚Ä¶">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Energy Prediction using Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Energy Prediction using Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2301.09165">

<!--Generated on Fri Mar  1 05:55:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Energy Prediction using Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Meghana Bharadwaj
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_font_italic">Department of Electrical Engineering</span>
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_italic">Stanford University
<br class="ltx_break"></span>mbhar@stanford.edu
</span></span></span>
<span class="ltx_author_before">‚ÄÉ‚ÄÉ</span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sanjana Sarda
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_font_italic">Department of Electrical Engineering</span>
<br class="ltx_break"><span id="id4.2.id2" class="ltx_text ltx_font_italic">Stanford University
<br class="ltx_break"></span>ssarda@stanford.edu
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">In this work, we demonstrate the viability of using federated learning to successfully predict energy consumption as well as solar production for all households within a certain network using low-power and low-space consuming embedded devices. We also demonstrate our prediction performance improving over time without the need for sharing private consumer energy data. We simulate a system with 4 nodes with 1 year‚Äôs worth of data to show this.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">As households have more distributed energy devices such as electric vehicles, solar panels, and residential batteries, it is necessary to operate them optimally to save costs and reduce energy consumption. With improved energy usage prediction and solar forecasting, it is also possible to participate effectively in demand response programs. Energy usage patterns of households can be vastly different, therefore it is beneficial to customize the energy management prediction and control strategy per household. Furthermore, it is increasingly common for households to have smart devices and other load-controlling technologies however most of these do not have on-device machine learning capabilities so this project aims to introduce more intelligent predictions through federated learning.
</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">This makes it a suitable application for distributed machine learning. Due to privacy and latency reasons, it is beneficial to train and run the energy prediction model locally on an edge device. We want the device to be able to adapt its prediction in real-time based on variations in weather conditions and usage patterns for each user while improving the overall global model. Through federated learning, the global model is able to learn from a wider range of data, from all of the nodes in the network, without compromising user privacy.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> apply distributed machine learning to predict the energy demand of EV charging stations. They use a Deep Neural Net model with approximately 65,000 parameters.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Tun et al <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> use federated learning for energy demand prediction. They use a bidirectional LSTM model where the input features are the previous 30 days‚Äô worth of energy demand data. Since they have more nodes in their network, they use clustering to first aggregate nodes with similar energy usage patterns and then perform federated learning on clusters instead of individual nodes. This will not be necessary for our system since we only have 4 nodes.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, the authors use an LSTM-based model for energy prediction. They perform updates on batches of clients instead of using all of the available nodes for each federated learning update. The model is trained and tested on household electricity consumption data from the Pecan Street database.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Problem Statement</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We propose using distributed machine learning to predict household energy consumption and solar prediction for a group of houses via Federated Learning.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2301.09165/assets/images/systemdiagram.jpg" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>System Diagram</figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Data</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The data used to train and test our model and federated learning algorithms is sourced from the Pecan Street database. We used household electricity consumption and solar power production data recorded on a 15-minute time resolution. However since we are doing hourly predictions, we pre-processed the raw data to obtain aggregated hourly energy and solar output values. Our dataset consists of 20 households located in Austin, Texas. All of the households have solar panels. We also used the weather data available from Pecan Street which contains humidity, temperature, cloud cover, wind speed, dew point, and precipitation intensity. The weather data was available for 4 locations in Texas so we chose the closest location to Austin. The data spans 1 year.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Train Data</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The base model is trained using 16 houses‚Äô worth of data as well as half of the available data for 4 households. The input features are the previous 30 days‚Äô worth of energy consumption and solar prediction values, time, and weather parameters at the current time step.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Test Data</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The federated learning algorithm is tested on 6 months worth of data on 4 households.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Machine Learning</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">The machine learning model is responsible for predicting hourly energy consumption and solar power production. We tested both 1-hour ahead predictions as well as 6-hour ahead predictions.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Model Architecture</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">The base model is a 4 layer neural network with approximately 400,000 parameters. We used dense layers with Relu activation.
The model was trained on the dataset for 9 epochs with a learning rate of 0.001.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We use the FedAvg algorithm to update the global model based on the individually retrained models at each node. For all 4 layers of the neural network, the following update is performed:</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<table id="S5.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E1.m1.2" class="ltx_Math" alttext="f(w)=\sum^{K}_{k=1}\frac{n_{k}}{n}F_{k}(w)" display="block"><semantics id="S5.E1.m1.2a"><mrow id="S5.E1.m1.2.3" xref="S5.E1.m1.2.3.cmml"><mrow id="S5.E1.m1.2.3.2" xref="S5.E1.m1.2.3.2.cmml"><mi id="S5.E1.m1.2.3.2.2" xref="S5.E1.m1.2.3.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S5.E1.m1.2.3.2.1" xref="S5.E1.m1.2.3.2.1.cmml">‚Äã</mo><mrow id="S5.E1.m1.2.3.2.3.2" xref="S5.E1.m1.2.3.2.cmml"><mo stretchy="false" id="S5.E1.m1.2.3.2.3.2.1" xref="S5.E1.m1.2.3.2.cmml">(</mo><mi id="S5.E1.m1.1.1" xref="S5.E1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S5.E1.m1.2.3.2.3.2.2" xref="S5.E1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S5.E1.m1.2.3.1" xref="S5.E1.m1.2.3.1.cmml">=</mo><mrow id="S5.E1.m1.2.3.3" xref="S5.E1.m1.2.3.3.cmml"><munderover id="S5.E1.m1.2.3.3.1" xref="S5.E1.m1.2.3.3.1.cmml"><mo movablelimits="false" id="S5.E1.m1.2.3.3.1.2.2" xref="S5.E1.m1.2.3.3.1.2.2.cmml">‚àë</mo><mrow id="S5.E1.m1.2.3.3.1.3" xref="S5.E1.m1.2.3.3.1.3.cmml"><mi id="S5.E1.m1.2.3.3.1.3.2" xref="S5.E1.m1.2.3.3.1.3.2.cmml">k</mi><mo id="S5.E1.m1.2.3.3.1.3.1" xref="S5.E1.m1.2.3.3.1.3.1.cmml">=</mo><mn id="S5.E1.m1.2.3.3.1.3.3" xref="S5.E1.m1.2.3.3.1.3.3.cmml">1</mn></mrow><mi id="S5.E1.m1.2.3.3.1.2.3" xref="S5.E1.m1.2.3.3.1.2.3.cmml">K</mi></munderover><mrow id="S5.E1.m1.2.3.3.2" xref="S5.E1.m1.2.3.3.2.cmml"><mfrac id="S5.E1.m1.2.3.3.2.2" xref="S5.E1.m1.2.3.3.2.2.cmml"><msub id="S5.E1.m1.2.3.3.2.2.2" xref="S5.E1.m1.2.3.3.2.2.2.cmml"><mi id="S5.E1.m1.2.3.3.2.2.2.2" xref="S5.E1.m1.2.3.3.2.2.2.2.cmml">n</mi><mi id="S5.E1.m1.2.3.3.2.2.2.3" xref="S5.E1.m1.2.3.3.2.2.2.3.cmml">k</mi></msub><mi id="S5.E1.m1.2.3.3.2.2.3" xref="S5.E1.m1.2.3.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S5.E1.m1.2.3.3.2.1" xref="S5.E1.m1.2.3.3.2.1.cmml">‚Äã</mo><msub id="S5.E1.m1.2.3.3.2.3" xref="S5.E1.m1.2.3.3.2.3.cmml"><mi id="S5.E1.m1.2.3.3.2.3.2" xref="S5.E1.m1.2.3.3.2.3.2.cmml">F</mi><mi id="S5.E1.m1.2.3.3.2.3.3" xref="S5.E1.m1.2.3.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S5.E1.m1.2.3.3.2.1a" xref="S5.E1.m1.2.3.3.2.1.cmml">‚Äã</mo><mrow id="S5.E1.m1.2.3.3.2.4.2" xref="S5.E1.m1.2.3.3.2.cmml"><mo stretchy="false" id="S5.E1.m1.2.3.3.2.4.2.1" xref="S5.E1.m1.2.3.3.2.cmml">(</mo><mi id="S5.E1.m1.2.2" xref="S5.E1.m1.2.2.cmml">w</mi><mo stretchy="false" id="S5.E1.m1.2.3.3.2.4.2.2" xref="S5.E1.m1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E1.m1.2b"><apply id="S5.E1.m1.2.3.cmml" xref="S5.E1.m1.2.3"><eq id="S5.E1.m1.2.3.1.cmml" xref="S5.E1.m1.2.3.1"></eq><apply id="S5.E1.m1.2.3.2.cmml" xref="S5.E1.m1.2.3.2"><times id="S5.E1.m1.2.3.2.1.cmml" xref="S5.E1.m1.2.3.2.1"></times><ci id="S5.E1.m1.2.3.2.2.cmml" xref="S5.E1.m1.2.3.2.2">ùëì</ci><ci id="S5.E1.m1.1.1.cmml" xref="S5.E1.m1.1.1">ùë§</ci></apply><apply id="S5.E1.m1.2.3.3.cmml" xref="S5.E1.m1.2.3.3"><apply id="S5.E1.m1.2.3.3.1.cmml" xref="S5.E1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S5.E1.m1.2.3.3.1.1.cmml" xref="S5.E1.m1.2.3.3.1">subscript</csymbol><apply id="S5.E1.m1.2.3.3.1.2.cmml" xref="S5.E1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S5.E1.m1.2.3.3.1.2.1.cmml" xref="S5.E1.m1.2.3.3.1">superscript</csymbol><sum id="S5.E1.m1.2.3.3.1.2.2.cmml" xref="S5.E1.m1.2.3.3.1.2.2"></sum><ci id="S5.E1.m1.2.3.3.1.2.3.cmml" xref="S5.E1.m1.2.3.3.1.2.3">ùêæ</ci></apply><apply id="S5.E1.m1.2.3.3.1.3.cmml" xref="S5.E1.m1.2.3.3.1.3"><eq id="S5.E1.m1.2.3.3.1.3.1.cmml" xref="S5.E1.m1.2.3.3.1.3.1"></eq><ci id="S5.E1.m1.2.3.3.1.3.2.cmml" xref="S5.E1.m1.2.3.3.1.3.2">ùëò</ci><cn type="integer" id="S5.E1.m1.2.3.3.1.3.3.cmml" xref="S5.E1.m1.2.3.3.1.3.3">1</cn></apply></apply><apply id="S5.E1.m1.2.3.3.2.cmml" xref="S5.E1.m1.2.3.3.2"><times id="S5.E1.m1.2.3.3.2.1.cmml" xref="S5.E1.m1.2.3.3.2.1"></times><apply id="S5.E1.m1.2.3.3.2.2.cmml" xref="S5.E1.m1.2.3.3.2.2"><divide id="S5.E1.m1.2.3.3.2.2.1.cmml" xref="S5.E1.m1.2.3.3.2.2"></divide><apply id="S5.E1.m1.2.3.3.2.2.2.cmml" xref="S5.E1.m1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S5.E1.m1.2.3.3.2.2.2.1.cmml" xref="S5.E1.m1.2.3.3.2.2.2">subscript</csymbol><ci id="S5.E1.m1.2.3.3.2.2.2.2.cmml" xref="S5.E1.m1.2.3.3.2.2.2.2">ùëõ</ci><ci id="S5.E1.m1.2.3.3.2.2.2.3.cmml" xref="S5.E1.m1.2.3.3.2.2.2.3">ùëò</ci></apply><ci id="S5.E1.m1.2.3.3.2.2.3.cmml" xref="S5.E1.m1.2.3.3.2.2.3">ùëõ</ci></apply><apply id="S5.E1.m1.2.3.3.2.3.cmml" xref="S5.E1.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S5.E1.m1.2.3.3.2.3.1.cmml" xref="S5.E1.m1.2.3.3.2.3">subscript</csymbol><ci id="S5.E1.m1.2.3.3.2.3.2.cmml" xref="S5.E1.m1.2.3.3.2.3.2">ùêπ</ci><ci id="S5.E1.m1.2.3.3.2.3.3.cmml" xref="S5.E1.m1.2.3.3.2.3.3">ùëò</ci></apply><ci id="S5.E1.m1.2.2.cmml" xref="S5.E1.m1.2.2">ùë§</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E1.m1.2c">f(w)=\sum^{K}_{k=1}\frac{n_{k}}{n}F_{k}(w)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.4" class="ltx_p">where K is the total number of nodes in the network, <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><msub id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml">n</mi><mi id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">ùëõ</ci><ci id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3">ùëò</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">n_{k}</annotation></semantics></math> is the number of data points that each local model is trained on, <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><mi id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><ci id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">ùëõ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">n</annotation></semantics></math> is the total number of data points across all nodes, <math id="S5.SS2.p3.3.m3.1" class="ltx_Math" alttext="F_{k}(w)" display="inline"><semantics id="S5.SS2.p3.3.m3.1a"><mrow id="S5.SS2.p3.3.m3.1.2" xref="S5.SS2.p3.3.m3.1.2.cmml"><msub id="S5.SS2.p3.3.m3.1.2.2" xref="S5.SS2.p3.3.m3.1.2.2.cmml"><mi id="S5.SS2.p3.3.m3.1.2.2.2" xref="S5.SS2.p3.3.m3.1.2.2.2.cmml">F</mi><mi id="S5.SS2.p3.3.m3.1.2.2.3" xref="S5.SS2.p3.3.m3.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS2.p3.3.m3.1.2.1" xref="S5.SS2.p3.3.m3.1.2.1.cmml">‚Äã</mo><mrow id="S5.SS2.p3.3.m3.1.2.3.2" xref="S5.SS2.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S5.SS2.p3.3.m3.1.2.3.2.1" xref="S5.SS2.p3.3.m3.1.2.cmml">(</mo><mi id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml">w</mi><mo stretchy="false" id="S5.SS2.p3.3.m3.1.2.3.2.2" xref="S5.SS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><apply id="S5.SS2.p3.3.m3.1.2.cmml" xref="S5.SS2.p3.3.m3.1.2"><times id="S5.SS2.p3.3.m3.1.2.1.cmml" xref="S5.SS2.p3.3.m3.1.2.1"></times><apply id="S5.SS2.p3.3.m3.1.2.2.cmml" xref="S5.SS2.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S5.SS2.p3.3.m3.1.2.2.1.cmml" xref="S5.SS2.p3.3.m3.1.2.2">subscript</csymbol><ci id="S5.SS2.p3.3.m3.1.2.2.2.cmml" xref="S5.SS2.p3.3.m3.1.2.2.2">ùêπ</ci><ci id="S5.SS2.p3.3.m3.1.2.2.3.cmml" xref="S5.SS2.p3.3.m3.1.2.2.3">ùëò</ci></apply><ci id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1">ùë§</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">F_{k}(w)</annotation></semantics></math> are the weights of each local model and <math id="S5.SS2.p3.4.m4.1" class="ltx_Math" alttext="f(w)" display="inline"><semantics id="S5.SS2.p3.4.m4.1a"><mrow id="S5.SS2.p3.4.m4.1.2" xref="S5.SS2.p3.4.m4.1.2.cmml"><mi id="S5.SS2.p3.4.m4.1.2.2" xref="S5.SS2.p3.4.m4.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p3.4.m4.1.2.1" xref="S5.SS2.p3.4.m4.1.2.1.cmml">‚Äã</mo><mrow id="S5.SS2.p3.4.m4.1.2.3.2" xref="S5.SS2.p3.4.m4.1.2.cmml"><mo stretchy="false" id="S5.SS2.p3.4.m4.1.2.3.2.1" xref="S5.SS2.p3.4.m4.1.2.cmml">(</mo><mi id="S5.SS2.p3.4.m4.1.1" xref="S5.SS2.p3.4.m4.1.1.cmml">w</mi><mo stretchy="false" id="S5.SS2.p3.4.m4.1.2.3.2.2" xref="S5.SS2.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.4.m4.1b"><apply id="S5.SS2.p3.4.m4.1.2.cmml" xref="S5.SS2.p3.4.m4.1.2"><times id="S5.SS2.p3.4.m4.1.2.1.cmml" xref="S5.SS2.p3.4.m4.1.2.1"></times><ci id="S5.SS2.p3.4.m4.1.2.2.cmml" xref="S5.SS2.p3.4.m4.1.2.2">ùëì</ci><ci id="S5.SS2.p3.4.m4.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1">ùë§</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.4.m4.1c">f(w)</annotation></semantics></math> are the global model weights.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r"><span id="S5.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Training Phase</span></th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="S5.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Layers Trained</span></th>
<th id="S5.T1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="S5.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">Epochs</span></th>
<th id="S5.T1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="S5.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Batch Size</span></th>
<th id="S5.T1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="S5.T1.1.1.1.5.1" class="ltx_text ltx_font_bold">Learning Rate</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.2.1" class="ltx_tr">
<td id="S5.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_r">Initial Model</td>
<td id="S5.T1.1.2.1.2" class="ltx_td ltx_align_left">All</td>
<td id="S5.T1.1.2.1.3" class="ltx_td ltx_align_left">5</td>
<td id="S5.T1.1.2.1.4" class="ltx_td ltx_align_left">32</td>
<td id="S5.T1.1.2.1.5" class="ltx_td ltx_align_left">0.001</td>
</tr>
<tr id="S5.T1.1.3.2" class="ltx_tr">
<td id="S5.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_border_r">Retrain Model with New Data</td>
<td id="S5.T1.1.3.2.2" class="ltx_td ltx_align_left">All</td>
<td id="S5.T1.1.3.2.3" class="ltx_td ltx_align_left">2</td>
<td id="S5.T1.1.3.2.4" class="ltx_td ltx_align_left">32</td>
<td id="S5.T1.1.3.2.5" class="ltx_td ltx_align_left">0.00001</td>
</tr>
<tr id="S5.T1.1.4.3" class="ltx_tr">
<td id="S5.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_border_r">Fine-tune Global Model with New Data</td>
<td id="S5.T1.1.4.3.2" class="ltx_td ltx_align_left">Last</td>
<td id="S5.T1.1.4.3.3" class="ltx_td ltx_align_left">2</td>
<td id="S5.T1.1.4.3.4" class="ltx_td ltx_align_left">32</td>
<td id="S5.T1.1.4.3.5" class="ltx_td ltx_align_left">0.01</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Training Details</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Implementation</span>
</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS1.5.1.1" class="ltx_text">VI-A</span> </span><span id="S6.SS1.6.2" class="ltx_text ltx_font_italic">Hardware Setup</span>
</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">In a real system, each household in the area of interest would be a node in the network. Since we are limited by the number of nodes available to us, we are simulating this network using 2 upboards and 2 GCE worker nodes. While this setup worked, we expect that we can replace the upboards with raspberry pi zeros in future iterations.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p">Household energy consumption and solar production are dependent on weather parameters such as temperature, humidity, and irradiation. Each node will have weather sensors that provide this input data to the prediction model.</p>
</div>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.1" class="ltx_p">It is not possible to test on physical household and EV charging/solar panel hardware so we do this through simulation. However, in order to simulate data processing on each device, we work with raw data and add an initial scaling step to our local models.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS2.5.1.1" class="ltx_text">VI-B</span> </span><span id="S6.SS2.6.2" class="ltx_text ltx_font_italic">Workflow</span>
</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">Each worker node is set up with a trained neural network that it uses to run hourly inference on local data. This is unique to each household. The node additionally collects two weeks‚Äô worth of local data and uses this to train its individual model. The re-training is done with a low learning rate of 1e-5. Provided that the performance of the trained model improves, each node will send this over to the global controller node.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.1" class="ltx_p">The controller node waits until it has received each worker node‚Äôs model within a defined network, after which it uses FedAvg to compute the new overall model. Models from each worker node are equally weighted as they are trained on the same number of data samples. Once this new model is produced, the controller node sends this over to each of the nodes within the network.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.1" class="ltx_p">After the worker node sends over its trained model to the controller node, it waits to receive the updated overall model from the controller node before proceeding with further inference. To ensure accuracy on local data for the sake of customization, the worker node fine-tunes the last layer of the updated overall model with the two weeks worth of new data. Fine-tuning is done with a learning rate of 1e-2. This process will then continue with the fine-tuned model.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS3.5.1.1" class="ltx_text">VI-C</span> </span><span id="S6.SS3.6.2" class="ltx_text ltx_font_italic">Communication</span>
</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">Our system uses MQTT (python paho-mqtt) for worker and controller communication with the Mosquitto broker located on the controller node. Weights are serialized into byte objects using Pickle during publishing and then deserialized on subscription. To ensure receipt of the updated model from the controller node, we use an MQTT loop on the worker node that keeps the subscriber alive until the model has been received.</p>
</div>
</section>
<section id="S6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S6.SS4.5.1.1" class="ltx_text">VI-D</span> </span><span id="S6.SS4.6.2" class="ltx_text ltx_font_italic">Deployment</span>
</h3>

<div id="S6.SS4.p1" class="ltx_para">
<p id="S6.SS4.p1.1" class="ltx_p">The original trained neural net model along with all requirements and scripts are packaged within a unique docker container that is then accessed by each worker node. The controller node uses K3s to run the inference script within the docker container located on the worker node. Each household worker node receives a unique label for identification. This label is also used to correctly start a pod on a specific worker node.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span id="S7.1.1" class="ltx_text ltx_font_smallcaps">Results</span>
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We tested our system through simulation, using 6 months of data for each of the 4 households in our network. The simulation is conducted for both 1-hour ahead predictions as well as 6-hour ahead predictions.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">The following graphs show the predicted energy consumption and solar power output values and the corresponding mean absolute error.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p">See Figure <a href="#S7.F2" title="Figure 2 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Figure <a href="#S7.F3" title="Figure 3 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, Figure <a href="#S7.F4" title="Figure 4 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and Figure <a href="#S7.F5" title="Figure 5 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> for the plots of all 4 houses for 1-hour ahead predictions.</p>
</div>
<figure id="S7.F2" class="ltx_figure"><img src="/html/2301.09165/assets/images/inf_a.png" id="S7.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>House A: Predictions</figcaption>
</figure>
<figure id="S7.F3" class="ltx_figure"><img src="/html/2301.09165/assets/images/inf_b.png" id="S7.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>House B: Predictions</figcaption>
</figure>
<figure id="S7.F4" class="ltx_figure"><img src="/html/2301.09165/assets/images/inf_c.png" id="S7.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>House C: Predictions</figcaption>
</figure>
<figure id="S7.F5" class="ltx_figure"><img src="/html/2301.09165/assets/images/inf_d.png" id="S7.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>House D: Predictions</figcaption>
</figure>
<div id="S7.p4" class="ltx_para">
<p id="S7.p4.1" class="ltx_p">See Figure <a href="#S7.F6" title="Figure 6 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, Figure <a href="#S7.F7" title="Figure 7 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, Figure <a href="#S7.F8" title="Figure 8 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, and Figure <a href="#S7.F9" title="Figure 9 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> for the plots of all 4 houses for 6-hour ahead predictions.</p>
</div>
<figure id="S7.F6" class="ltx_figure"><img src="/html/2301.09165/assets/images/6hr_inf_a.png" id="S7.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>House A: Predictions</figcaption>
</figure>
<figure id="S7.F7" class="ltx_figure"><img src="/html/2301.09165/assets/images/6hr_inf_b.png" id="S7.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>House B: Predictions</figcaption>
</figure>
<figure id="S7.F8" class="ltx_figure"><img src="/html/2301.09165/assets/images/6hr_inf_c.png" id="S7.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>House C: Predictions</figcaption>
</figure>
<figure id="S7.F9" class="ltx_figure"><img src="/html/2301.09165/assets/images/6hr_inf_d.png" id="S7.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>House D: Predictions</figcaption>
</figure>
<div id="S7.p5" class="ltx_para">
<p id="S7.p5.1" class="ltx_p">As can be seen, the solar predictions have low MAE since they follow a regular pattern. The energy predictions have higher MAE, in particular when there are large spikes in consumption as the model is not able to predict these extreme values accurately.</p>
</div>
<div id="S7.p6" class="ltx_para">
<p id="S7.p6.1" class="ltx_p">The following graphs show the mean absolute error of every 2 weeks of data before and after federated learning updates are made. For all nodes, for both 1-hour and 6-hour ahead predictions, the MAE after federated learning updates are performed is lower than the MAE calculated with the previous model. This shows that federated learning is helping to improve the accuracy of the model. Furthermore, we see that the MAE decreases throughout the simulation showing that the models are improving in accuracy overall.</p>
</div>
<div id="S7.p7" class="ltx_para">
<p id="S7.p7.1" class="ltx_p">1-hour ahead predictions: Figure <a href="#S7.F10" title="Figure 10 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a></p>
</div>
<figure id="S7.F10" class="ltx_figure"><img src="/html/2301.09165/assets/images/mae_combined.png" id="S7.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="178" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>MAE per 2-week iteration for all 4 houses (1-hr ahead)</figcaption>
</figure>
<div id="S7.p8" class="ltx_para">
<p id="S7.p8.1" class="ltx_p">6-hour ahead predictions: Figure <a href="#S7.F11" title="Figure 11 ‚Ä£ VII Results ‚Ä£ Energy Prediction using Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a></p>
</div>
<figure id="S7.F11" class="ltx_figure"><img src="/html/2301.09165/assets/images/6hr_mae_combined.png" id="S7.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="179" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>MAE per 2-week iteration for all 4 houses (6-hr ahead)</figcaption>
</figure>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VIII </span><span id="S8.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">The results demonstrate that federated learning is useful for the task of predicting energy consumption and solar power output in a network. Solar power output predictions in particular have good accuracy.</p>
</div>
<div id="S8.p2" class="ltx_para">
<p id="S8.p2.1" class="ltx_p">To improve the overall accuracy of the energy predictions, we need to train the model with more data over a longer period. For example, energy consumption will likely have seasonal variations but our model is only trained on 6 months of data so is not able to account for these patterns.</p>
</div>
<div id="S8.p3" class="ltx_para">
<p id="S8.p3.1" class="ltx_p">Furthermore, increasing the model complexity, by adding more layers or adding LSTM layers, for example, will also help improve prediction accuracy. We limited the size of our model due to resource constraints on the Upboard but did not run into issues with inference or training so can experiment with larger model sizes.</p>
</div>
<div id="S8.p4" class="ltx_para">
<p id="S8.p4.1" class="ltx_p">In addition, having more nodes in the network will also help to improve the benefit that federated learning has on the updates.</p>
</div>
</section>
<section id="S9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IX </span><span id="S9.1.1" class="ltx_text ltx_font_smallcaps">Future Work</span>
</h2>

<div id="S9.p1" class="ltx_para">
<p id="S9.p1.1" class="ltx_p">To extend this work further, we can change the model to predict day-ahead energy consumption and solar output forecasts (meaning the model would have 48 outputs instead of 2). This would require a more complex model and more training data to achieve good performance. Though having a few hours ahead predictions are helpful for optimal load control and demand response, day-ahead forecasts will provide more valuable information to act upon.</p>
</div>
<div id="S9.p2" class="ltx_para">
<p id="S9.p2.1" class="ltx_p">We also want to test our system on out-of-distribution data (e.g different city or usage patterns) to evaluate the robustness of the model and federated learning algorithm.</p>
</div>
<div id="S9.p3" class="ltx_para">
<p id="S9.p3.1" class="ltx_p">To improve cost efficiency, we plan on potentially updating the Upboard hardware to raspberry pi zeros instead. We also believe that we have designed our application to be scalable, and hope to productize with additional features in the future.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Yuris et¬†al Saputra.

</span>
<span class="ltx_bibblock">Energy demand prediction with federated learning for electric vehicle
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">2019 IEEE Global Communications Conference (GLOBECOM)</span>, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Afaf Taik and Soumaya Cherkaoui.

</span>
<span class="ltx_bibblock">Electrical load forecasting using edge computing and federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">ICC 2020 - 2020 IEEE International Conference on
Communications (ICC)</span>, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Ye¬†Lin et¬†al Tun.

</span>
<span class="ltx_bibblock">Federated learning based energy demand prediction with clustered
aggregation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">2021 IEEE International Conference on Big Data and Smart
Computing (BigComp)</span>, 2021.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="A1.SS1.5.1.1" class="ltx_text">A-A</span> </span><span id="A1.SS1.6.2" class="ltx_text ltx_font_italic">Code</span>
</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p"><a target="_blank" href="https://github.com/Sanjana-Sarda/Energy_Prediction" title="" class="ltx_ref ltx_href">Github Repository</a></p>
</div>
<div id="A1.SS1.p2" class="ltx_para">
<p id="A1.SS1.p2.1" class="ltx_p"></p>
</div>
</section>
</section><div class="ltx_rdf" about="" property="dcterms:title" content="Overleaf Example"></div>

</article>
</div>
<div class="ar5iv-footer"><a href="/html/2301.09164" class="ar5iv-nav-button ar5iv-nav-button-prev">‚óÑ</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2301.09165" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2301.09165">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2301.09165" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2301.09167" class="ar5iv-nav-button ar5iv-nav-button-next">‚ñ∫</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 05:55:01 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "√ó";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
