<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.08100] Efficient Language Model Architectures for Differentially Private Federated Learning</title><meta property="og:description" content="Cross-device federated learning (FL) is a technique that trains a model on data distributed across typically millions of edge devices without data leaving the devices.
SGD is the standard client optimizer for on device…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Efficient Language Model Architectures for Differentially Private Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Efficient Language Model Architectures for Differentially Private Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.08100">

<!--Generated on Fri Apr  5 16:06:05 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Efficient Language Model Architectures for Differentially Private Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jae Hun Ro
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">jaero@google.com
<br class="ltx_break"></span>Google, Inc
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Srinadh Bhojanapalli
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text ltx_font_typewriter">bsrinadh@google.com
<br class="ltx_break"></span>Google, Inc
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zheng Xu
<br class="ltx_break"><span id="id3.1.id1" class="ltx_text ltx_font_typewriter">xuzheng@google.com
<br class="ltx_break"></span>Google, Inc
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yanxiang Zhang
<br class="ltx_break"><span id="id4.1.id1" class="ltx_text ltx_font_typewriter">zhangyx@google.com
<br class="ltx_break"></span>Google, Inc
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ananda Theertha Suresh
<br class="ltx_break"><span id="id5.1.id1" class="ltx_text ltx_font_typewriter">theertha@google.com
<br class="ltx_break"></span>Google, Inc
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id6.id1" class="ltx_p">Cross-device federated learning (FL) is a technique that trains a model on data distributed across typically millions of edge devices without data leaving the devices.
SGD is the standard client optimizer for on device training in cross-device FL, favored for its memory and computational efficiency.
However, in centralized training of neural language models, adaptive optimizers are preferred as they offer improved stability and performance.
In light of this, we ask if language models can be modified such that they can be efficiently trained with SGD client optimizers and answer this affirmatively.</p>
<p id="id7.id2" class="ltx_p">We propose a scale-invariant <em id="id7.id2.1" class="ltx_emph ltx_font_italic">Coupled Input Forget Gate</em> (SI CIFG) recurrent network by modifying the sigmoid and tanh activations in the recurrent cell
and show that this new model converges faster and achieves better utility than the standard CIFG recurrent model in cross-device FL in large scale experiments.
We further show that the proposed scale invariant modification also helps in federated learning of larger transformer models.
Finally, we demonstrate the scale invariant modification is also compatible with other non-adaptive algorithms.
Particularly, our results suggest an improved privacy utility trade-off in federated learning with differential privacy.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) is a technique that trains a model on data distributed across devices without data leaving the device <cite class="ltx_cite ltx_citemacro_citep">(Konecný et al., <a href="#bib.bib23" title="" class="ltx_ref">2016</a>; McMahan et al., <a href="#bib.bib27" title="" class="ltx_ref">2017a</a>)</cite>.
FL has been applied in a variety of diverse settings, including language-based applications <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib14" title="" class="ltx_ref">2018b</a>; Chen et al., <a href="#bib.bib5" title="" class="ltx_ref">2019</a>; Kairouz et al., <a href="#bib.bib18" title="" class="ltx_ref">2019</a>; Li et al., <a href="#bib.bib24" title="" class="ltx_ref">2020a</a>; Shah et al., <a href="#bib.bib38" title="" class="ltx_ref">2020</a>)</cite>.
Specifically, we examine cross-device FL <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib20" title="" class="ltx_ref">2021b</a>)</cite>, where local clients are edge devices with limited resources and computing power, which can number in the millions.
Previous works on language modeling in cross-device FL often use small recurrent-based models of less than <math id="S1.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S1.p1.1.m1.1a"><mn id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><cn type="integer" id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">10</annotation></semantics></math>M parameters <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib14" title="" class="ltx_ref">2018b</a>; Reddi et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>; Xu et al., <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite>, while more recent works leverage a variety of efficient techniques for training larger Transformer-based models <cite class="ltx_cite ltx_citemacro_citep">(Hilmkil et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Ro et al., <a href="#bib.bib36" title="" class="ltx_ref">2022</a>)</cite>.
In this work, we investigate modular strategies applicable to various model architectures for improving training of both small and large models in cross-device FL.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Existing works on improving FL usually focus on developing better optimizers FedAvg, FedProx, Mime, FedDyn etc <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib25" title="" class="ltx_ref">2020b</a>; Reddi et al., <a href="#bib.bib34" title="" class="ltx_ref">2021</a>; Karimireddy et al., <a href="#bib.bib21" title="" class="ltx_ref">2021</a>; Acar et al., <a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite>.
While advanced optimizers are typically used in the server, (e.g., in the optimizer FedAdam, Adam optimizer is used in the server), in practice, the preferred client optimizer is often SGD for its memory efficiency. Note that using an adaptive optimizer like Adam in clients requires storing first and second moments of gradients, which improves the memory requirement considerably.
However, neural language models such as recurrent LSTMs <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib46" title="" class="ltx_ref">2019</a>)</cite> or Transformers <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib42" title="" class="ltx_ref">2017</a>)</cite>,
typically require more memory intensive adaptive optimizers, such as Adagrad or Adam that store both the first and second moment of gradients, and suffer in performance when trained with SGD <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib47" title="" class="ltx_ref">2020</a>)</cite>.
Hence we ask the question: Can we achieve the best of both worlds and effectively train expressive architectures with memory efficient optimizers for language modeling in FL?</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> studied this question in the context of training centralized Transformer encoder models, such as BERT, and proposed using Scale Invariant Transformers for improved optimization of Transformers using SGD.
Using Scale Invariant Transformers, they were able to use SGD to obtain a similar performance to that of standard Transformers using the Adam optimizer.
Naturally, this raises the question if there exists scale invariant version of other neural architectures, e.g. LSTMs that can be optimized well with simple SGD.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Federated learning can also be combined with other privacy techniques to provide strong privacy protection to various threat models <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib48" title="" class="ltx_ref">2023</a>; Bonawitz et al., <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>.
Differential privacy (DP) <cite class="ltx_cite ltx_citemacro_citep">(Dwork et al., <a href="#bib.bib8" title="" class="ltx_ref">2006</a>)</cite> is a statistical framework that provides rigorous guarantees for privacy protection and is adopted in federated learning to prevent models from memorizing individual information <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib28" title="" class="ltx_ref">2017b</a>; Ramaswamy et al., <a href="#bib.bib32" title="" class="ltx_ref">2020</a>; El Ouadrhiri &amp; Abdelhadi, <a href="#bib.bib10" title="" class="ltx_ref">2022</a>; Wei et al., <a href="#bib.bib43" title="" class="ltx_ref">2020</a>; Girgis et al., <a href="#bib.bib11" title="" class="ltx_ref">2021</a>)</cite>.
More recently, by applying the family of DP-Follow The Regularized Leader (DP-FTRL) algorithms <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib19" title="" class="ltx_ref">2021a</a>; Choquette-Choo et al., <a href="#bib.bib7" title="" class="ltx_ref">2023</a>)</cite> that have strong privacy-utility trade-offs without relying on sampling assumptions, meaningful formal differential privacy guarantees have been achieved for production language models in practical cross-device systems <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Our contributions</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Improving LSTM architectures for FL.</span>
Long Short-Term Memory (LSTM) <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter &amp; Schmidhuber, <a href="#bib.bib17" title="" class="ltx_ref">1997b</a>)</cite> language models are often used in large scale FL studies due to their small size <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib27" title="" class="ltx_ref">2017a</a>; Hard et al., <a href="#bib.bib13" title="" class="ltx_ref">2018a</a>, <a href="#bib.bib14" title="" class="ltx_ref">b</a>; Kairouz et al., <a href="#bib.bib19" title="" class="ltx_ref">2021a</a>; Xu et al., <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite>. In particular, <cite class="ltx_cite ltx_citemacro_cite">Hard et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018b</a>)</cite> proposed to use Coupled Input Forget Gate (CIFG) LSTMs for federated learning for mobile keyboard predictions for its improved parameter and computational efficiency over the vanilla LSTM.
Motivated by this, we develop a novel scale-invariant CIFG model (<span id="S2.p1.1.2" class="ltx_text">SI-CIFG</span>) with modified activation functions for FL.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Application to FL.</span>
In cross-device FL, each client typically runs multiple steps of local SGD on their local data to produce model parameter updates.
These updates are then typically combined at the server with a federated optimizer such as FedAdam <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib34" title="" class="ltx_ref">2021</a>)</cite>.
This raises an important question: does our <span id="S2.p2.1.2" class="ltx_text">SI-CIFG</span> offer any advantages in this setting where one of the optimizers is SGD and the other is an adaptive optimizer like Adam?
We show that this is indeed the case and that both our proposed <span id="S2.p2.1.3" class="ltx_text">SI-CIFG</span> as well as the already existing scale-invariant Transformer <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> (SI Transformer), using scale-invariant attentions, perform significantly better than their standard counterparts on a variety of experiments by improving convergence speeds in large scale FL experiments, while remaining robust to higher learning rates and heterogeneous networks.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Training with differential privacy.</span>
FL models are trained with differential privacy using the DP-FTRL algorithm <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib19" title="" class="ltx_ref">2021a</a>)</cite>.
In this scenario, while the local steps are still carried out via SGD, the model updates from clients are additionally clipped and aggregated with noise
at the server.
We show that scale invariant models also outperform their standard counterparts on experiments in a large-scale FL system with differential privacy.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Scale Invariant Architectures</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Previous scale invariant architectures</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">In this section, we briefly review Scale Invariant Transformers <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite>.
Recall that a function <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">f</annotation></semantics></math> is scale invariant if <math id="S3.SS1.p1.2.m2.2" class="ltx_Math" alttext="f(ax)=f(x)" display="inline"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml"><mrow id="S3.SS1.p1.2.m2.2.2.1" xref="S3.SS1.p1.2.m2.2.2.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.3" xref="S3.SS1.p1.2.m2.2.2.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.2.2.1.2" xref="S3.SS1.p1.2.m2.2.2.1.2.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.2.m2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml"><mi id="S3.SS1.p1.2.m2.2.2.3.2" xref="S3.SS1.p1.2.m2.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.2.2.3.1" xref="S3.SS1.p1.2.m2.2.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.2.2.3.3.2" xref="S3.SS1.p1.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.3.3.2.1" xref="S3.SS1.p1.2.m2.2.2.3.cmml">(</mo><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.3.3.2.2" xref="S3.SS1.p1.2.m2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2"><eq id="S3.SS1.p1.2.m2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2"></eq><apply id="S3.SS1.p1.2.m2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1"><times id="S3.SS1.p1.2.m2.2.2.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.2"></times><ci id="S3.SS1.p1.2.m2.2.2.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.3">𝑓</ci><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><times id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1"></times><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.3"><times id="S3.SS1.p1.2.m2.2.2.3.1.cmml" xref="S3.SS1.p1.2.m2.2.2.3.1"></times><ci id="S3.SS1.p1.2.m2.2.2.3.2.cmml" xref="S3.SS1.p1.2.m2.2.2.3.2">𝑓</ci><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">f(ax)=f(x)</annotation></semantics></math> for any scalar <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="a&gt;0" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">a</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">&gt;</mo><mn id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><gt id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></gt><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑎</ci><cn type="integer" id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">a&gt;0</annotation></semantics></math>.
Let <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">n</annotation></semantics></math> be the input sequence length and <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">d</annotation></semantics></math> be the hidden dimension of the Transformer model.
Recall that for a given input <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="{\bm{X}}\in\mathbb{R}^{d\times n}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">𝑿</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.3.2" xref="S3.SS1.p1.6.m6.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.6.m6.1.1.3.3.1" xref="S3.SS1.p1.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.6.m6.1.1.3.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></in><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑿</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3"><times id="S3.SS1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.2">𝑑</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">{\bm{X}}\in\mathbb{R}^{d\times n}</annotation></semantics></math>, a Transformer computes self attention as follows:</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_math_unparsed" alttext="\text{Attn}({\bm{X}})=\text{SoftMax}\left(({\bm{W}}_{Q}{\bm{X}})^{\top}.{\bm{W}}_{K}{\bm{X}}\right)." display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1b"><mtext id="S3.E1.m1.1.2">Attn</mtext><mrow id="S3.E1.m1.1.3"><mo stretchy="false" id="S3.E1.m1.1.3.1">(</mo><mi id="S3.E1.m1.1.1">𝑿</mi><mo stretchy="false" id="S3.E1.m1.1.3.2">)</mo></mrow><mo id="S3.E1.m1.1.4">=</mo><mtext id="S3.E1.m1.1.5">SoftMax</mtext><mrow id="S3.E1.m1.1.6"><mo id="S3.E1.m1.1.6.1">(</mo><msup id="S3.E1.m1.1.6.2"><mrow id="S3.E1.m1.1.6.2.2"><mo stretchy="false" id="S3.E1.m1.1.6.2.2.1">(</mo><msub id="S3.E1.m1.1.6.2.2.2"><mi id="S3.E1.m1.1.6.2.2.2.2">𝑾</mi><mi id="S3.E1.m1.1.6.2.2.2.3">Q</mi></msub><mi id="S3.E1.m1.1.6.2.2.3">𝑿</mi><mo stretchy="false" id="S3.E1.m1.1.6.2.2.4">)</mo></mrow><mo id="S3.E1.m1.1.6.2.3">⊤</mo></msup><mo lspace="0em" rspace="0.167em" id="S3.E1.m1.1.6.3">.</mo><msub id="S3.E1.m1.1.6.4"><mi id="S3.E1.m1.1.6.4.2">𝑾</mi><mi id="S3.E1.m1.1.6.4.3">K</mi></msub><mi id="S3.E1.m1.1.6.5">𝑿</mi><mo id="S3.E1.m1.1.6.6">)</mo></mrow><mo lspace="0em" id="S3.E1.m1.1.7">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\text{Attn}({\bm{X}})=\text{SoftMax}\left(({\bm{W}}_{Q}{\bm{X}})^{\top}.{\bm{W}}_{K}{\bm{X}}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.3" class="ltx_p">Here <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="{\bm{W}}_{Q}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝑾</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑾</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">{\bm{W}}_{Q}</annotation></semantics></math> and <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="{\bm{W}}_{K}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">𝑾</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑾</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">{\bm{W}}_{K}</annotation></semantics></math> are the Query and Key projections, respectively.
This operation is not scale invariant, as scaling the weights (<math id="S3.SS1.p3.3.m3.2" class="ltx_Math" alttext="{\bm{W}}_{Q},{\bm{W}}_{K}" display="inline"><semantics id="S3.SS1.p3.3.m3.2a"><mrow id="S3.SS1.p3.3.m3.2.2.2" xref="S3.SS1.p3.3.m3.2.2.3.cmml"><msub id="S3.SS1.p3.3.m3.1.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.1.1.2" xref="S3.SS1.p3.3.m3.1.1.1.1.2.cmml">𝑾</mi><mi id="S3.SS1.p3.3.m3.1.1.1.1.3" xref="S3.SS1.p3.3.m3.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.SS1.p3.3.m3.2.2.2.3" xref="S3.SS1.p3.3.m3.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.3.m3.2.2.2.2" xref="S3.SS1.p3.3.m3.2.2.2.2.cmml"><mi id="S3.SS1.p3.3.m3.2.2.2.2.2" xref="S3.SS1.p3.3.m3.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS1.p3.3.m3.2.2.2.2.3" xref="S3.SS1.p3.3.m3.2.2.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.2b"><list id="S3.SS1.p3.3.m3.2.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.2"><apply id="S3.SS1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1.2">𝑾</ci><ci id="S3.SS1.p3.3.m3.1.1.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS1.p3.3.m3.2.2.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.2.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2.2">𝑾</ci><ci id="S3.SS1.p3.3.m3.2.2.2.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.2c">{\bm{W}}_{Q},{\bm{W}}_{K}</annotation></semantics></math>) changes the output attention probabilities. <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> proposed the following alternative attention computation:</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_math_unparsed" alttext="\text{SI-Attn}({\bm{X}})=\text{N}\left(\text{ReLU}\left(({\bm{W}}_{Q}{\bm{X}})^{\top}.{\bm{W}}_{K}{\bm{X}}\right)\right)." display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1b"><mtext id="S3.E2.m1.1.2">SI-Attn</mtext><mrow id="S3.E2.m1.1.3"><mo stretchy="false" id="S3.E2.m1.1.3.1">(</mo><mi id="S3.E2.m1.1.1">𝑿</mi><mo stretchy="false" id="S3.E2.m1.1.3.2">)</mo></mrow><mo id="S3.E2.m1.1.4">=</mo><mtext id="S3.E2.m1.1.5">N</mtext><mrow id="S3.E2.m1.1.6"><mo id="S3.E2.m1.1.6.1">(</mo><mtext id="S3.E2.m1.1.6.2">ReLU</mtext><mrow id="S3.E2.m1.1.6.3"><mo id="S3.E2.m1.1.6.3.1">(</mo><msup id="S3.E2.m1.1.6.3.2"><mrow id="S3.E2.m1.1.6.3.2.2"><mo stretchy="false" id="S3.E2.m1.1.6.3.2.2.1">(</mo><msub id="S3.E2.m1.1.6.3.2.2.2"><mi id="S3.E2.m1.1.6.3.2.2.2.2">𝑾</mi><mi id="S3.E2.m1.1.6.3.2.2.2.3">Q</mi></msub><mi id="S3.E2.m1.1.6.3.2.2.3">𝑿</mi><mo stretchy="false" id="S3.E2.m1.1.6.3.2.2.4">)</mo></mrow><mo id="S3.E2.m1.1.6.3.2.3">⊤</mo></msup><mo lspace="0em" rspace="0.167em" id="S3.E2.m1.1.6.3.3">.</mo><msub id="S3.E2.m1.1.6.3.4"><mi id="S3.E2.m1.1.6.3.4.2">𝑾</mi><mi id="S3.E2.m1.1.6.3.4.3">K</mi></msub><mi id="S3.E2.m1.1.6.3.5">𝑿</mi><mo id="S3.E2.m1.1.6.3.6">)</mo></mrow><mo id="S3.E2.m1.1.6.4">)</mo></mrow><mo lspace="0em" id="S3.E2.m1.1.7">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\text{SI-Attn}({\bm{X}})=\text{N}\left(\text{ReLU}\left(({\bm{W}}_{Q}{\bm{X}})^{\top}.{\bm{W}}_{K}{\bm{X}}\right)\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">Here, N is the row-wise normalization operator - <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="\text{N}({\bm{A}})_{ij}=\frac{{\bm{A}}_{ij}}{\sum_{j}{\bm{A}}_{ij}}" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.2" xref="S3.SS1.p5.1.m1.1.2.cmml"><mrow id="S3.SS1.p5.1.m1.1.2.2" xref="S3.SS1.p5.1.m1.1.2.2.cmml"><mtext id="S3.SS1.p5.1.m1.1.2.2.2" xref="S3.SS1.p5.1.m1.1.2.2.2a.cmml">N</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.2.2.1" xref="S3.SS1.p5.1.m1.1.2.2.1.cmml">​</mo><msub id="S3.SS1.p5.1.m1.1.2.2.3" xref="S3.SS1.p5.1.m1.1.2.2.3.cmml"><mrow id="S3.SS1.p5.1.m1.1.2.2.3.2.2" xref="S3.SS1.p5.1.m1.1.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p5.1.m1.1.2.2.3.2.2.1" xref="S3.SS1.p5.1.m1.1.2.2.3.cmml">(</mo><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">𝑨</mi><mo stretchy="false" id="S3.SS1.p5.1.m1.1.2.2.3.2.2.2" xref="S3.SS1.p5.1.m1.1.2.2.3.cmml">)</mo></mrow><mrow id="S3.SS1.p5.1.m1.1.2.2.3.3" xref="S3.SS1.p5.1.m1.1.2.2.3.3.cmml"><mi id="S3.SS1.p5.1.m1.1.2.2.3.3.2" xref="S3.SS1.p5.1.m1.1.2.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.2.2.3.3.1" xref="S3.SS1.p5.1.m1.1.2.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p5.1.m1.1.2.2.3.3.3" xref="S3.SS1.p5.1.m1.1.2.2.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS1.p5.1.m1.1.2.1" xref="S3.SS1.p5.1.m1.1.2.1.cmml">=</mo><mfrac id="S3.SS1.p5.1.m1.1.2.3" xref="S3.SS1.p5.1.m1.1.2.3.cmml"><msub id="S3.SS1.p5.1.m1.1.2.3.2" xref="S3.SS1.p5.1.m1.1.2.3.2.cmml"><mi id="S3.SS1.p5.1.m1.1.2.3.2.2" xref="S3.SS1.p5.1.m1.1.2.3.2.2.cmml">𝑨</mi><mrow id="S3.SS1.p5.1.m1.1.2.3.2.3" xref="S3.SS1.p5.1.m1.1.2.3.2.3.cmml"><mi id="S3.SS1.p5.1.m1.1.2.3.2.3.2" xref="S3.SS1.p5.1.m1.1.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.2.3.2.3.1" xref="S3.SS1.p5.1.m1.1.2.3.2.3.1.cmml">​</mo><mi id="S3.SS1.p5.1.m1.1.2.3.2.3.3" xref="S3.SS1.p5.1.m1.1.2.3.2.3.3.cmml">j</mi></mrow></msub><mrow id="S3.SS1.p5.1.m1.1.2.3.3" xref="S3.SS1.p5.1.m1.1.2.3.3.cmml"><mstyle displaystyle="false" id="S3.SS1.p5.1.m1.1.2.3.3.1" xref="S3.SS1.p5.1.m1.1.2.3.3.1.cmml"><msub id="S3.SS1.p5.1.m1.1.2.3.3.1a" xref="S3.SS1.p5.1.m1.1.2.3.3.1.cmml"><mo id="S3.SS1.p5.1.m1.1.2.3.3.1.2" xref="S3.SS1.p5.1.m1.1.2.3.3.1.2.cmml">∑</mo><mi id="S3.SS1.p5.1.m1.1.2.3.3.1.3" xref="S3.SS1.p5.1.m1.1.2.3.3.1.3.cmml">j</mi></msub></mstyle><msub id="S3.SS1.p5.1.m1.1.2.3.3.2" xref="S3.SS1.p5.1.m1.1.2.3.3.2.cmml"><mi id="S3.SS1.p5.1.m1.1.2.3.3.2.2" xref="S3.SS1.p5.1.m1.1.2.3.3.2.2.cmml">𝑨</mi><mrow id="S3.SS1.p5.1.m1.1.2.3.3.2.3" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3.cmml"><mi id="S3.SS1.p5.1.m1.1.2.3.3.2.3.2" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p5.1.m1.1.2.3.3.2.3.1" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3.1.cmml">​</mo><mi id="S3.SS1.p5.1.m1.1.2.3.3.2.3.3" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.2"><eq id="S3.SS1.p5.1.m1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.1"></eq><apply id="S3.SS1.p5.1.m1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2"><times id="S3.SS1.p5.1.m1.1.2.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.2.1"></times><ci id="S3.SS1.p5.1.m1.1.2.2.2a.cmml" xref="S3.SS1.p5.1.m1.1.2.2.2"><mtext id="S3.SS1.p5.1.m1.1.2.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2.2">N</mtext></ci><apply id="S3.SS1.p5.1.m1.1.2.2.3.cmml" xref="S3.SS1.p5.1.m1.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.2.2.3.1.cmml" xref="S3.SS1.p5.1.m1.1.2.2.3">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝑨</ci><apply id="S3.SS1.p5.1.m1.1.2.2.3.3.cmml" xref="S3.SS1.p5.1.m1.1.2.2.3.3"><times id="S3.SS1.p5.1.m1.1.2.2.3.3.1.cmml" xref="S3.SS1.p5.1.m1.1.2.2.3.3.1"></times><ci id="S3.SS1.p5.1.m1.1.2.2.3.3.2.cmml" xref="S3.SS1.p5.1.m1.1.2.2.3.3.2">𝑖</ci><ci id="S3.SS1.p5.1.m1.1.2.2.3.3.3.cmml" xref="S3.SS1.p5.1.m1.1.2.2.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS1.p5.1.m1.1.2.3.cmml" xref="S3.SS1.p5.1.m1.1.2.3"><divide id="S3.SS1.p5.1.m1.1.2.3.1.cmml" xref="S3.SS1.p5.1.m1.1.2.3"></divide><apply id="S3.SS1.p5.1.m1.1.2.3.2.cmml" xref="S3.SS1.p5.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.2.3.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.3.2">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.2.3.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.3.2.2">𝑨</ci><apply id="S3.SS1.p5.1.m1.1.2.3.2.3.cmml" xref="S3.SS1.p5.1.m1.1.2.3.2.3"><times id="S3.SS1.p5.1.m1.1.2.3.2.3.1.cmml" xref="S3.SS1.p5.1.m1.1.2.3.2.3.1"></times><ci id="S3.SS1.p5.1.m1.1.2.3.2.3.2.cmml" xref="S3.SS1.p5.1.m1.1.2.3.2.3.2">𝑖</ci><ci id="S3.SS1.p5.1.m1.1.2.3.2.3.3.cmml" xref="S3.SS1.p5.1.m1.1.2.3.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p5.1.m1.1.2.3.3.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3"><apply id="S3.SS1.p5.1.m1.1.2.3.3.1.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.2.3.3.1.1.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.1">subscript</csymbol><sum id="S3.SS1.p5.1.m1.1.2.3.3.1.2.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.1.2"></sum><ci id="S3.SS1.p5.1.m1.1.2.3.3.1.3.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.1.3">𝑗</ci></apply><apply id="S3.SS1.p5.1.m1.1.2.3.3.2.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.2.3.3.2.1.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.2">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.2.3.3.2.2.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.2.2">𝑨</ci><apply id="S3.SS1.p5.1.m1.1.2.3.3.2.3.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3"><times id="S3.SS1.p5.1.m1.1.2.3.3.2.3.1.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3.1"></times><ci id="S3.SS1.p5.1.m1.1.2.3.3.2.3.2.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3.2">𝑖</ci><ci id="S3.SS1.p5.1.m1.1.2.3.3.2.3.3.cmml" xref="S3.SS1.p5.1.m1.1.2.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\text{N}({\bm{A}})_{ij}=\frac{{\bm{A}}_{ij}}{\sum_{j}{\bm{A}}_{ij}}</annotation></semantics></math>.
In particular, <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> replaced the softmax in attention computation, with the ReLU activation followed by row-wise normalization.
This modifies the attention computation to be scale invariant.
They further modify the Transformer to be a Pre-LN activation model and use ReLU activation instead of GeLU in the feedforward layers.
We use the same architecture in our experiments.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.1" class="ltx_p">However, <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> tested their method only on centralized encoder models (BERT).
In this paper, we will extend the results to decoder-only Transformers trained using a language modeling objective in cross-device FL.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>New scale invariant architectures</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Inspired by the Scale Invariant Transformer, we now design a novel Scale Invariant version of the CIFG architecture we call <span id="S3.SS2.p1.1.1" class="ltx_text">SI-CIFG</span>.
We note that the same changes from the Scale Invariant Transformer do not apply to the CIFG as due to architecture differences, scale sensitivity arises from different functions for CIFG models.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">We focus on CIFG networks for their improved parameter and computational efficiency over the vanilla LSTMs.
The CIFG network uses a single gate to control self-connections in both input and recurrent cells, which reduces the number of parameters per cell by 25% <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter &amp; Schmidhuber, <a href="#bib.bib16" title="" class="ltx_ref">1997a</a>; Cho et al., <a href="#bib.bib6" title="" class="ltx_ref">2014</a>; Greff et al., <a href="#bib.bib12" title="" class="ltx_ref">2017</a>)</cite>.
The shared gates increase efficiency, with little to no impact on quality, which is critical in the typically resource constrained edge device environment of cross-device FL.
Moreover, we expect that our proposed changes can also be directly applied to the LSTM model.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.2" class="ltx_p">First, we review the basic CIFG before our proposed architecture changes.
Recall that for a given time step <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">t</annotation></semantics></math> and input <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="x_{t}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><msub id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2.2" xref="S3.SS2.p3.2.m2.1.1.2.2.cmml">x</mi><mi id="S3.SS2.p3.2.m2.1.1.2.3" xref="S3.SS2.p3.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><in id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1"></in><apply id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2.2">𝑥</ci><ci id="S3.SS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">x_{t}\in\mathbb{R}^{d}</annotation></semantics></math>, the CIFG forward pass can be written as follows:</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle f_{t}=\sigma(W_{f}x_{t}+U_{f}h_{t-1}+b_{f})" display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><msub id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml">f</mi><mi id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml">t</mi></msub><mo id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1.m1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.1.1.1.2.1" xref="S3.Ex1.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.Ex1.m1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.1.1.1.3.1" xref="S3.Ex1.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.1" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.1a" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.4.2" xref="S3.Ex1.m1.1.1.1.1.1.1.4.2.cmml">b</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.4.3" xref="S3.Ex1.m1.1.1.1.1.1.1.4.3.cmml">f</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><eq id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2"></eq><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2">𝑓</ci><ci id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><times id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3">𝜎</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><plus id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"></plus><apply id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2"><times id="S3.Ex1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.3">𝑓</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3"><times id="S3.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.2.3">𝑓</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3"><minus id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.2">𝑏</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.4.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle f_{t}=\sigma(W_{f}x_{t}+U_{f}h_{t-1}+b_{f})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex1.3.2.2.1" class="ltx_text ltx_markedasmath ltx_font_italic">forget gate</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle i_{t}=1-f_{t}" display="inline"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2.cmml"><mi id="S3.Ex2.m1.1.1.2.2" xref="S3.Ex2.m1.1.1.2.2.cmml">i</mi><mi id="S3.Ex2.m1.1.1.2.3" xref="S3.Ex2.m1.1.1.2.3.cmml">t</mi></msub><mo id="S3.Ex2.m1.1.1.1" xref="S3.Ex2.m1.1.1.1.cmml">=</mo><mrow id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml"><mn id="S3.Ex2.m1.1.1.3.2" xref="S3.Ex2.m1.1.1.3.2.cmml">1</mn><mo id="S3.Ex2.m1.1.1.3.1" xref="S3.Ex2.m1.1.1.3.1.cmml">−</mo><msub id="S3.Ex2.m1.1.1.3.3" xref="S3.Ex2.m1.1.1.3.3.cmml"><mi id="S3.Ex2.m1.1.1.3.3.2" xref="S3.Ex2.m1.1.1.3.3.2.cmml">f</mi><mi id="S3.Ex2.m1.1.1.3.3.3" xref="S3.Ex2.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><eq id="S3.Ex2.m1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"></eq><apply id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.2.2">𝑖</ci><ci id="S3.Ex2.m1.1.1.2.3.cmml" xref="S3.Ex2.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3"><minus id="S3.Ex2.m1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.3.1"></minus><cn type="integer" id="S3.Ex2.m1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.3.2">1</cn><apply id="S3.Ex2.m1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.3.3.1.cmml" xref="S3.Ex2.m1.1.1.3.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.3.3.2.cmml" xref="S3.Ex2.m1.1.1.3.3.2">𝑓</ci><ci id="S3.Ex2.m1.1.1.3.3.3.cmml" xref="S3.Ex2.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle i_{t}=1-f_{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex2.3.2.2.1" class="ltx_text ltx_markedasmath ltx_font_italic">coupled input forget gate</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle o_{t}=\sigma(W_{o}x_{t}+U_{o}h_{t-1}+b_{o})" display="inline"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><msub id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml"><mi id="S3.Ex3.m1.1.1.3.2" xref="S3.Ex3.m1.1.1.3.2.cmml">o</mi><mi id="S3.Ex3.m1.1.1.3.3" xref="S3.Ex3.m1.1.1.3.3.cmml">t</mi></msub><mo id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex3.m1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.2.2.3" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.3.cmml">o</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.1.2.1" xref="S3.Ex3.m1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.2.3.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.2.3.3" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.Ex3.m1.1.1.1.1.1.1.3.2" xref="S3.Ex3.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.3.2.2" xref="S3.Ex3.m1.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.3.2.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.2.3.cmml">o</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.1.1.1.1.1.1.3.1" xref="S3.Ex3.m1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.3.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.3.3.2" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.1" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.1.1a" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.4.2" xref="S3.Ex3.m1.1.1.1.1.1.1.4.2.cmml">b</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.4.3" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3.cmml">o</mi></msub></mrow><mo stretchy="false" id="S3.Ex3.m1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><eq id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2"></eq><apply id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.3.2">𝑜</ci><ci id="S3.Ex3.m1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><times id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">𝜎</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><plus id="S3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1"></plus><apply id="S3.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2"><times id="S3.Ex3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.2.3">𝑜</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3"><times id="S3.Ex3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.1"></times><apply id="S3.Ex3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.2.3">𝑜</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3"><minus id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.2">𝑏</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle o_{t}=\sigma(W_{o}x_{t}+U_{o}h_{t-1}+b_{o})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex3.3.2.2.1" class="ltx_text ltx_markedasmath ltx_font_italic">output gate</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex4.m1.2" class="ltx_Math" alttext="\displaystyle c_{t}=f_{t}\odot c_{t-1}+i_{t}\odot\tanh(W_{c}x_{t}+U_{c}h_{t-1}+b_{c})" display="inline"><semantics id="S3.Ex4.m1.2a"><mrow id="S3.Ex4.m1.2.2" xref="S3.Ex4.m1.2.2.cmml"><msub id="S3.Ex4.m1.2.2.3" xref="S3.Ex4.m1.2.2.3.cmml"><mi id="S3.Ex4.m1.2.2.3.2" xref="S3.Ex4.m1.2.2.3.2.cmml">c</mi><mi id="S3.Ex4.m1.2.2.3.3" xref="S3.Ex4.m1.2.2.3.3.cmml">t</mi></msub><mo id="S3.Ex4.m1.2.2.2" xref="S3.Ex4.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex4.m1.2.2.1" xref="S3.Ex4.m1.2.2.1.cmml"><mrow id="S3.Ex4.m1.2.2.1.3" xref="S3.Ex4.m1.2.2.1.3.cmml"><msub id="S3.Ex4.m1.2.2.1.3.2" xref="S3.Ex4.m1.2.2.1.3.2.cmml"><mi id="S3.Ex4.m1.2.2.1.3.2.2" xref="S3.Ex4.m1.2.2.1.3.2.2.cmml">f</mi><mi id="S3.Ex4.m1.2.2.1.3.2.3" xref="S3.Ex4.m1.2.2.1.3.2.3.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.Ex4.m1.2.2.1.3.1" xref="S3.Ex4.m1.2.2.1.3.1.cmml">⊙</mo><msub id="S3.Ex4.m1.2.2.1.3.3" xref="S3.Ex4.m1.2.2.1.3.3.cmml"><mi id="S3.Ex4.m1.2.2.1.3.3.2" xref="S3.Ex4.m1.2.2.1.3.3.2.cmml">c</mi><mrow id="S3.Ex4.m1.2.2.1.3.3.3" xref="S3.Ex4.m1.2.2.1.3.3.3.cmml"><mi id="S3.Ex4.m1.2.2.1.3.3.3.2" xref="S3.Ex4.m1.2.2.1.3.3.3.2.cmml">t</mi><mo id="S3.Ex4.m1.2.2.1.3.3.3.1" xref="S3.Ex4.m1.2.2.1.3.3.3.1.cmml">−</mo><mn id="S3.Ex4.m1.2.2.1.3.3.3.3" xref="S3.Ex4.m1.2.2.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.Ex4.m1.2.2.1.2" xref="S3.Ex4.m1.2.2.1.2.cmml">+</mo><mrow id="S3.Ex4.m1.2.2.1.1" xref="S3.Ex4.m1.2.2.1.1.cmml"><msub id="S3.Ex4.m1.2.2.1.1.3" xref="S3.Ex4.m1.2.2.1.1.3.cmml"><mi id="S3.Ex4.m1.2.2.1.1.3.2" xref="S3.Ex4.m1.2.2.1.1.3.2.cmml">i</mi><mi id="S3.Ex4.m1.2.2.1.1.3.3" xref="S3.Ex4.m1.2.2.1.1.3.3.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.Ex4.m1.2.2.1.1.2" xref="S3.Ex4.m1.2.2.1.1.2.cmml">⊙</mo><mrow id="S3.Ex4.m1.2.2.1.1.1.1" xref="S3.Ex4.m1.2.2.1.1.1.2.cmml"><mi id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml">tanh</mi><mo id="S3.Ex4.m1.2.2.1.1.1.1a" xref="S3.Ex4.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex4.m1.2.2.1.1.1.1.1" xref="S3.Ex4.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex4.m1.2.2.1.1.1.1.1.2" xref="S3.Ex4.m1.2.2.1.1.1.2.cmml">(</mo><mrow id="S3.Ex4.m1.2.2.1.1.1.1.1.1" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.1" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.Ex4.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.cmml"><msub id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.1" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.Ex4.m1.2.2.1.1.1.1.1.1.1a" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.Ex4.m1.2.2.1.1.1.1.1.1.4" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.2.cmml">b</mi><mi id="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S3.Ex4.m1.2.2.1.1.1.1.1.3" xref="S3.Ex4.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.2b"><apply id="S3.Ex4.m1.2.2.cmml" xref="S3.Ex4.m1.2.2"><eq id="S3.Ex4.m1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2"></eq><apply id="S3.Ex4.m1.2.2.3.cmml" xref="S3.Ex4.m1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.3.1.cmml" xref="S3.Ex4.m1.2.2.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.3.2.cmml" xref="S3.Ex4.m1.2.2.3.2">𝑐</ci><ci id="S3.Ex4.m1.2.2.3.3.cmml" xref="S3.Ex4.m1.2.2.3.3">𝑡</ci></apply><apply id="S3.Ex4.m1.2.2.1.cmml" xref="S3.Ex4.m1.2.2.1"><plus id="S3.Ex4.m1.2.2.1.2.cmml" xref="S3.Ex4.m1.2.2.1.2"></plus><apply id="S3.Ex4.m1.2.2.1.3.cmml" xref="S3.Ex4.m1.2.2.1.3"><csymbol cd="latexml" id="S3.Ex4.m1.2.2.1.3.1.cmml" xref="S3.Ex4.m1.2.2.1.3.1">direct-product</csymbol><apply id="S3.Ex4.m1.2.2.1.3.2.cmml" xref="S3.Ex4.m1.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.3.2.1.cmml" xref="S3.Ex4.m1.2.2.1.3.2">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.3.2.2.cmml" xref="S3.Ex4.m1.2.2.1.3.2.2">𝑓</ci><ci id="S3.Ex4.m1.2.2.1.3.2.3.cmml" xref="S3.Ex4.m1.2.2.1.3.2.3">𝑡</ci></apply><apply id="S3.Ex4.m1.2.2.1.3.3.cmml" xref="S3.Ex4.m1.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.3.3.1.cmml" xref="S3.Ex4.m1.2.2.1.3.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.3.3.2.cmml" xref="S3.Ex4.m1.2.2.1.3.3.2">𝑐</ci><apply id="S3.Ex4.m1.2.2.1.3.3.3.cmml" xref="S3.Ex4.m1.2.2.1.3.3.3"><minus id="S3.Ex4.m1.2.2.1.3.3.3.1.cmml" xref="S3.Ex4.m1.2.2.1.3.3.3.1"></minus><ci id="S3.Ex4.m1.2.2.1.3.3.3.2.cmml" xref="S3.Ex4.m1.2.2.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.Ex4.m1.2.2.1.3.3.3.3.cmml" xref="S3.Ex4.m1.2.2.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex4.m1.2.2.1.1.cmml" xref="S3.Ex4.m1.2.2.1.1"><csymbol cd="latexml" id="S3.Ex4.m1.2.2.1.1.2.cmml" xref="S3.Ex4.m1.2.2.1.1.2">direct-product</csymbol><apply id="S3.Ex4.m1.2.2.1.1.3.cmml" xref="S3.Ex4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.1.3.1.cmml" xref="S3.Ex4.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.1.3.2.cmml" xref="S3.Ex4.m1.2.2.1.1.3.2">𝑖</ci><ci id="S3.Ex4.m1.2.2.1.1.3.3.cmml" xref="S3.Ex4.m1.2.2.1.1.3.3">𝑡</ci></apply><apply id="S3.Ex4.m1.2.2.1.1.1.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1"><tanh id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1"></tanh><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1"><plus id="S3.Ex4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2"><times id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.1"></times><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.2.3">𝑐</ci></apply><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3"><times id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.1"></times><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.2.3">𝑐</ci></apply><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3"><minus id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.2">𝑏</ci><ci id="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex4.m1.2.2.1.1.1.1.1.1.4.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.2c">\displaystyle c_{t}=f_{t}\odot c_{t-1}+i_{t}\odot\tanh(W_{c}x_{t}+U_{c}h_{t-1}+b_{c})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span id="S3.Ex4.3.2.2.1" class="ltx_text ltx_markedasmath ltx_font_italic">cell state</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex5.m1.2" class="ltx_Math" alttext="\displaystyle h_{t}=o_{t}\odot\tanh(c_{t})" display="inline"><semantics id="S3.Ex5.m1.2a"><mrow id="S3.Ex5.m1.2.2" xref="S3.Ex5.m1.2.2.cmml"><msub id="S3.Ex5.m1.2.2.3" xref="S3.Ex5.m1.2.2.3.cmml"><mi id="S3.Ex5.m1.2.2.3.2" xref="S3.Ex5.m1.2.2.3.2.cmml">h</mi><mi id="S3.Ex5.m1.2.2.3.3" xref="S3.Ex5.m1.2.2.3.3.cmml">t</mi></msub><mo id="S3.Ex5.m1.2.2.2" xref="S3.Ex5.m1.2.2.2.cmml">=</mo><mrow id="S3.Ex5.m1.2.2.1" xref="S3.Ex5.m1.2.2.1.cmml"><msub id="S3.Ex5.m1.2.2.1.3" xref="S3.Ex5.m1.2.2.1.3.cmml"><mi id="S3.Ex5.m1.2.2.1.3.2" xref="S3.Ex5.m1.2.2.1.3.2.cmml">o</mi><mi id="S3.Ex5.m1.2.2.1.3.3" xref="S3.Ex5.m1.2.2.1.3.3.cmml">t</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.Ex5.m1.2.2.1.2" xref="S3.Ex5.m1.2.2.1.2.cmml">⊙</mo><mrow id="S3.Ex5.m1.2.2.1.1.1" xref="S3.Ex5.m1.2.2.1.1.2.cmml"><mi id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml">tanh</mi><mo id="S3.Ex5.m1.2.2.1.1.1a" xref="S3.Ex5.m1.2.2.1.1.2.cmml">⁡</mo><mrow id="S3.Ex5.m1.2.2.1.1.1.1" xref="S3.Ex5.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.Ex5.m1.2.2.1.1.1.1.2" xref="S3.Ex5.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.Ex5.m1.2.2.1.1.1.1.1" xref="S3.Ex5.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.2.2.1.1.1.1.1.2" xref="S3.Ex5.m1.2.2.1.1.1.1.1.2.cmml">c</mi><mi id="S3.Ex5.m1.2.2.1.1.1.1.1.3" xref="S3.Ex5.m1.2.2.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.Ex5.m1.2.2.1.1.1.1.3" xref="S3.Ex5.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.2b"><apply id="S3.Ex5.m1.2.2.cmml" xref="S3.Ex5.m1.2.2"><eq id="S3.Ex5.m1.2.2.2.cmml" xref="S3.Ex5.m1.2.2.2"></eq><apply id="S3.Ex5.m1.2.2.3.cmml" xref="S3.Ex5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.3.1.cmml" xref="S3.Ex5.m1.2.2.3">subscript</csymbol><ci id="S3.Ex5.m1.2.2.3.2.cmml" xref="S3.Ex5.m1.2.2.3.2">ℎ</ci><ci id="S3.Ex5.m1.2.2.3.3.cmml" xref="S3.Ex5.m1.2.2.3.3">𝑡</ci></apply><apply id="S3.Ex5.m1.2.2.1.cmml" xref="S3.Ex5.m1.2.2.1"><csymbol cd="latexml" id="S3.Ex5.m1.2.2.1.2.cmml" xref="S3.Ex5.m1.2.2.1.2">direct-product</csymbol><apply id="S3.Ex5.m1.2.2.1.3.cmml" xref="S3.Ex5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.3.1.cmml" xref="S3.Ex5.m1.2.2.1.3">subscript</csymbol><ci id="S3.Ex5.m1.2.2.1.3.2.cmml" xref="S3.Ex5.m1.2.2.1.3.2">𝑜</ci><ci id="S3.Ex5.m1.2.2.1.3.3.cmml" xref="S3.Ex5.m1.2.2.1.3.3">𝑡</ci></apply><apply id="S3.Ex5.m1.2.2.1.1.2.cmml" xref="S3.Ex5.m1.2.2.1.1.1"><tanh id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1"></tanh><apply id="S3.Ex5.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.1.2">𝑐</ci><ci id="S3.Ex5.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.2.2.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.2c">\displaystyle h_{t}=o_{t}\odot\tanh(c_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright" colspan="2"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.11" class="ltx_p">where <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">d</annotation></semantics></math> and <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">h</annotation></semantics></math> are the input and hidden dimensions, respectively, and <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="W\in\mathbb{R}^{h\times d}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><mrow id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">W</mi><mo id="S3.SS2.p5.3.m3.1.1.1" xref="S3.SS2.p5.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.2" xref="S3.SS2.p5.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.3.m3.1.1.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.3.2" xref="S3.SS2.p5.3.m3.1.1.3.3.2.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.3.m3.1.1.3.3.1" xref="S3.SS2.p5.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p5.3.m3.1.1.3.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><in id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1"></in><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝑊</ci><apply id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.3.m3.1.1.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3"><times id="S3.SS2.p5.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3.1"></times><ci id="S3.SS2.p5.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3.2">ℎ</ci><ci id="S3.SS2.p5.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">W\in\mathbb{R}^{h\times d}</annotation></semantics></math>, <math id="S3.SS2.p5.4.m4.1" class="ltx_Math" alttext="U\in\mathbb{R}^{h\times h}" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><mrow id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">U</mi><mo id="S3.SS2.p5.4.m4.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.3.2" xref="S3.SS2.p5.4.m4.1.1.3.3.2.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.4.m4.1.1.3.3.1" xref="S3.SS2.p5.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p5.4.m4.1.1.3.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.3.cmml">h</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><in id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1"></in><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">𝑈</ci><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3"><times id="S3.SS2.p5.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3.1"></times><ci id="S3.SS2.p5.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3.2">ℎ</ci><ci id="S3.SS2.p5.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">U\in\mathbb{R}^{h\times h}</annotation></semantics></math>, and <math id="S3.SS2.p5.5.m5.1" class="ltx_Math" alttext="b\in\mathbb{R}^{h}" display="inline"><semantics id="S3.SS2.p5.5.m5.1a"><mrow id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><mi id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml">b</mi><mo id="S3.SS2.p5.5.m5.1.1.1" xref="S3.SS2.p5.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml"><mi id="S3.SS2.p5.5.m5.1.1.3.2" xref="S3.SS2.p5.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p5.5.m5.1.1.3.3" xref="S3.SS2.p5.5.m5.1.1.3.3.cmml">h</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><in id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1.1"></in><ci id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2">𝑏</ci><apply id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.3.1.cmml" xref="S3.SS2.p5.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.3.2.cmml" xref="S3.SS2.p5.5.m5.1.1.3.2">ℝ</ci><ci id="S3.SS2.p5.5.m5.1.1.3.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">b\in\mathbb{R}^{h}</annotation></semantics></math> are the cell’s trainable weight and bias parameters. Here <math id="S3.SS2.p5.6.m6.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p5.6.m6.1a"><mi id="S3.SS2.p5.6.m6.1.1" xref="S3.SS2.p5.6.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m6.1b"><ci id="S3.SS2.p5.6.m6.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m6.1c">\sigma</annotation></semantics></math> and <math id="S3.SS2.p5.7.m7.1" class="ltx_Math" alttext="\tanh" display="inline"><semantics id="S3.SS2.p5.7.m7.1a"><mi id="S3.SS2.p5.7.m7.1.1" xref="S3.SS2.p5.7.m7.1.1.cmml">tanh</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m7.1b"><tanh id="S3.SS2.p5.7.m7.1.1.cmml" xref="S3.SS2.p5.7.m7.1.1"></tanh></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m7.1c">\tanh</annotation></semantics></math> are Sigmoid and Tanh activation functions, respectively.
This architecture is sensitive to input scale, mainly because of the non-linearities in the <math id="S3.SS2.p5.8.m8.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p5.8.m8.1a"><mi id="S3.SS2.p5.8.m8.1.1" xref="S3.SS2.p5.8.m8.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m8.1b"><ci id="S3.SS2.p5.8.m8.1.1.cmml" xref="S3.SS2.p5.8.m8.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.8.m8.1c">\sigma</annotation></semantics></math> and
<math id="S3.SS2.p5.9.m9.1" class="ltx_Math" alttext="\tanh" display="inline"><semantics id="S3.SS2.p5.9.m9.1a"><mi id="S3.SS2.p5.9.m9.1.1" xref="S3.SS2.p5.9.m9.1.1.cmml">tanh</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.9.m9.1b"><tanh id="S3.SS2.p5.9.m9.1.1.cmml" xref="S3.SS2.p5.9.m9.1.1"></tanh></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.9.m9.1c">\tanh</annotation></semantics></math> activations.
We first propose modifying the activation functions to be scale invariant by replacing <math id="S3.SS2.p5.10.m10.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p5.10.m10.1a"><mi id="S3.SS2.p5.10.m10.1.1" xref="S3.SS2.p5.10.m10.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.10.m10.1b"><ci id="S3.SS2.p5.10.m10.1.1.cmml" xref="S3.SS2.p5.10.m10.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.10.m10.1c">\sigma</annotation></semantics></math> with Relu and <math id="S3.SS2.p5.11.m11.1" class="ltx_Math" alttext="\tanh" display="inline"><semantics id="S3.SS2.p5.11.m11.1a"><mi id="S3.SS2.p5.11.m11.1.1" xref="S3.SS2.p5.11.m11.1.1.cmml">tanh</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.11.m11.1b"><tanh id="S3.SS2.p5.11.m11.1.1.cmml" xref="S3.SS2.p5.11.m11.1.1"></tanh></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.11.m11.1c">\tanh</annotation></semantics></math> with linear activation.
However, this no longer guarantees that intermediate outputs of different gates are normalized.
To further ensure that the intermediate features are normalized we propose using a Max-Normalization - <span id="S3.SS2.p5.11.1" class="ltx_text ltx_font_smallcaps">MaxN</span>, which normalizes each entry of the feature vector using its max absolute value along the hidden dimension.
Formally,</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.4" class="ltx_Math" alttext="\textsc{MaxN}(x)_{i}=\frac{x_{i}}{\max_{j\in[d]}|x_{j}|}." display="block"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml"><mtext class="ltx_font_smallcaps" id="S3.E3.m1.4.4.1.1.2.2" xref="S3.E3.m1.4.4.1.1.2.2a.cmml">MaxN</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.2.1" xref="S3.E3.m1.4.4.1.1.2.1.cmml">​</mo><msub id="S3.E3.m1.4.4.1.1.2.3" xref="S3.E3.m1.4.4.1.1.2.3.cmml"><mrow id="S3.E3.m1.4.4.1.1.2.3.2.2" xref="S3.E3.m1.4.4.1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.2.3.2.2.1" xref="S3.E3.m1.4.4.1.1.2.3.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.4.4.1.1.2.3.2.2.2" xref="S3.E3.m1.4.4.1.1.2.3.cmml">)</mo></mrow><mi id="S3.E3.m1.4.4.1.1.2.3.3" xref="S3.E3.m1.4.4.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml">=</mo><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msub id="S3.E3.m1.2.2.4" xref="S3.E3.m1.2.2.4.cmml"><mi id="S3.E3.m1.2.2.4.2" xref="S3.E3.m1.2.2.4.2.cmml">x</mi><mi id="S3.E3.m1.2.2.4.3" xref="S3.E3.m1.2.2.4.3.cmml">i</mi></msub><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><msub id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.2.3.2" xref="S3.E3.m1.2.2.2.3.2.cmml">max</mi><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">j</mi><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">∈</mo><mrow id="S3.E3.m1.1.1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.4.2.1" xref="S3.E3.m1.1.1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">d</mi><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.4.2.2" xref="S3.E3.m1.1.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mo id="S3.E3.m1.2.2.2a" xref="S3.E3.m1.2.2.2.cmml">⁡</mo><mrow id="S3.E3.m1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.2.1.cmml">|</mo><msub id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.2.cmml">x</mi><mi id="S3.E3.m1.2.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E3.m1.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.2.1.cmml">|</mo></mrow></mrow></mfrac></mrow><mo lspace="0em" id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"></eq><apply id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"><times id="S3.E3.m1.4.4.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.1"></times><ci id="S3.E3.m1.4.4.1.1.2.2a.cmml" xref="S3.E3.m1.4.4.1.1.2.2"><mtext class="ltx_font_smallcaps" id="S3.E3.m1.4.4.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2">MaxN</mtext></ci><apply id="S3.E3.m1.4.4.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑥</ci><ci id="S3.E3.m1.4.4.1.1.2.3.3.cmml" xref="S3.E3.m1.4.4.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2"></divide><apply id="S3.E3.m1.2.2.4.cmml" xref="S3.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.4.1.cmml" xref="S3.E3.m1.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.4.2.cmml" xref="S3.E3.m1.2.2.4.2">𝑥</ci><ci id="S3.E3.m1.2.2.4.3.cmml" xref="S3.E3.m1.2.2.4.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><apply id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.3">subscript</csymbol><max id="S3.E3.m1.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.3.2"></max><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><in id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></in><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝑗</ci><apply id="S3.E3.m1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.4.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝑑</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1"><abs id="S3.E3.m1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.2"></abs><apply id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.2">𝑥</ci><ci id="S3.E3.m1.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\textsc{MaxN}(x)_{i}=\frac{x_{i}}{\max_{j\in[d]}|x_{j}|}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">Based on this, we propose the following scale invariant replacement for <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\sigma</annotation></semantics></math> activation.</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.8" class="ltx_Math" alttext="\text{SI-}\sigma(x)_{i}=\textsc{MaxN}(\text{Relu}(x))_{i}=\frac{\text{Relu}(x)_{i}}{\max_{j\in[d]}(\text{Relu}(x)_{j})}." display="block"><semantics id="S3.E4.m1.8a"><mrow id="S3.E4.m1.8.8.1" xref="S3.E4.m1.8.8.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1" xref="S3.E4.m1.8.8.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.3" xref="S3.E4.m1.8.8.1.1.3.cmml"><mtext id="S3.E4.m1.8.8.1.1.3.2" xref="S3.E4.m1.8.8.1.1.3.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.1.1.3.1" xref="S3.E4.m1.8.8.1.1.3.1.cmml">​</mo><mi id="S3.E4.m1.8.8.1.1.3.3" xref="S3.E4.m1.8.8.1.1.3.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.1.1.3.1a" xref="S3.E4.m1.8.8.1.1.3.1.cmml">​</mo><msub id="S3.E4.m1.8.8.1.1.3.4" xref="S3.E4.m1.8.8.1.1.3.4.cmml"><mrow id="S3.E4.m1.8.8.1.1.3.4.2.2" xref="S3.E4.m1.8.8.1.1.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.1.1.3.4.2.2.1" xref="S3.E4.m1.8.8.1.1.3.4.cmml">(</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.8.8.1.1.3.4.2.2.2" xref="S3.E4.m1.8.8.1.1.3.4.cmml">)</mo></mrow><mi id="S3.E4.m1.8.8.1.1.3.4.3" xref="S3.E4.m1.8.8.1.1.3.4.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.8.8.1.1.4" xref="S3.E4.m1.8.8.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.8.8.1.1.1" xref="S3.E4.m1.8.8.1.1.1.cmml"><mtext class="ltx_font_smallcaps" id="S3.E4.m1.8.8.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.3a.cmml">MaxN</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.2.cmml">​</mo><msub id="S3.E4.m1.8.8.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.cmml"><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.3.2.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.8.8.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4.m1.8.8.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.3.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.8.8.1.1.5" xref="S3.E4.m1.8.8.1.1.5.cmml">=</mo><mfrac id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mtext id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">​</mo><msub id="S3.E4.m1.1.1.1.4" xref="S3.E4.m1.1.1.1.4.cmml"><mrow id="S3.E4.m1.1.1.1.4.2.2" xref="S3.E4.m1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.4.2.2.1" xref="S3.E4.m1.1.1.1.4.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.4.2.2.2" xref="S3.E4.m1.1.1.1.4.cmml">)</mo></mrow><mi id="S3.E4.m1.1.1.1.4.3" xref="S3.E4.m1.1.1.1.4.3.cmml">i</mi></msub></mrow><mrow id="S3.E4.m1.5.5.5.4" xref="S3.E4.m1.5.5.5.5.cmml"><msub id="S3.E4.m1.4.4.4.3.1" xref="S3.E4.m1.4.4.4.3.1.cmml"><mi id="S3.E4.m1.4.4.4.3.1.2" xref="S3.E4.m1.4.4.4.3.1.2.cmml">max</mi><mrow id="S3.E4.m1.2.2.2.1.1" xref="S3.E4.m1.2.2.2.1.1.cmml"><mi id="S3.E4.m1.2.2.2.1.1.3" xref="S3.E4.m1.2.2.2.1.1.3.cmml">j</mi><mo id="S3.E4.m1.2.2.2.1.1.2" xref="S3.E4.m1.2.2.2.1.1.2.cmml">∈</mo><mrow id="S3.E4.m1.2.2.2.1.1.4.2" xref="S3.E4.m1.2.2.2.1.1.4.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.1.1.4.2.1" xref="S3.E4.m1.2.2.2.1.1.4.1.1.cmml">[</mo><mi id="S3.E4.m1.2.2.2.1.1.1" xref="S3.E4.m1.2.2.2.1.1.1.cmml">d</mi><mo stretchy="false" id="S3.E4.m1.2.2.2.1.1.4.2.2" xref="S3.E4.m1.2.2.2.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mo id="S3.E4.m1.5.5.5.4a" xref="S3.E4.m1.5.5.5.5.cmml">⁡</mo><mrow id="S3.E4.m1.5.5.5.4.2" xref="S3.E4.m1.5.5.5.5.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.5.4.2.2" xref="S3.E4.m1.5.5.5.5.cmml">(</mo><mrow id="S3.E4.m1.5.5.5.4.2.1" xref="S3.E4.m1.5.5.5.4.2.1.cmml"><mtext id="S3.E4.m1.5.5.5.4.2.1.2" xref="S3.E4.m1.5.5.5.4.2.1.2a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.5.4.2.1.1" xref="S3.E4.m1.5.5.5.4.2.1.1.cmml">​</mo><msub id="S3.E4.m1.5.5.5.4.2.1.3" xref="S3.E4.m1.5.5.5.4.2.1.3.cmml"><mrow id="S3.E4.m1.5.5.5.4.2.1.3.2.2" xref="S3.E4.m1.5.5.5.4.2.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.5.4.2.1.3.2.2.1" xref="S3.E4.m1.5.5.5.4.2.1.3.cmml">(</mo><mi id="S3.E4.m1.3.3.3.2" xref="S3.E4.m1.3.3.3.2.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.5.5.5.4.2.1.3.2.2.2" xref="S3.E4.m1.5.5.5.4.2.1.3.cmml">)</mo></mrow><mi id="S3.E4.m1.5.5.5.4.2.1.3.3" xref="S3.E4.m1.5.5.5.4.2.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E4.m1.5.5.5.4.2.3" xref="S3.E4.m1.5.5.5.5.cmml">)</mo></mrow></mrow></mfrac></mrow><mo lspace="0em" id="S3.E4.m1.8.8.1.2" xref="S3.E4.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.8b"><apply id="S3.E4.m1.8.8.1.1.cmml" xref="S3.E4.m1.8.8.1"><and id="S3.E4.m1.8.8.1.1a.cmml" xref="S3.E4.m1.8.8.1"></and><apply id="S3.E4.m1.8.8.1.1b.cmml" xref="S3.E4.m1.8.8.1"><eq id="S3.E4.m1.8.8.1.1.4.cmml" xref="S3.E4.m1.8.8.1.1.4"></eq><apply id="S3.E4.m1.8.8.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.3"><times id="S3.E4.m1.8.8.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.3.1"></times><ci id="S3.E4.m1.8.8.1.1.3.2a.cmml" xref="S3.E4.m1.8.8.1.1.3.2"><mtext id="S3.E4.m1.8.8.1.1.3.2.cmml" xref="S3.E4.m1.8.8.1.1.3.2">SI-</mtext></ci><ci id="S3.E4.m1.8.8.1.1.3.3.cmml" xref="S3.E4.m1.8.8.1.1.3.3">𝜎</ci><apply id="S3.E4.m1.8.8.1.1.3.4.cmml" xref="S3.E4.m1.8.8.1.1.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.3.4.1.cmml" xref="S3.E4.m1.8.8.1.1.3.4">subscript</csymbol><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝑥</ci><ci id="S3.E4.m1.8.8.1.1.3.4.3.cmml" xref="S3.E4.m1.8.8.1.1.3.4.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.8.8.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1"><times id="S3.E4.m1.8.8.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.2"></times><ci id="S3.E4.m1.8.8.1.1.1.3a.cmml" xref="S3.E4.m1.8.8.1.1.1.3"><mtext class="ltx_font_smallcaps" id="S3.E4.m1.8.8.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.3">MaxN</mtext></ci><apply id="S3.E4.m1.8.8.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1"><times id="S3.E4.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2a.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2"><mtext id="S3.E4.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.1.2">Relu</mtext></ci><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">𝑥</ci></apply><ci id="S3.E4.m1.8.8.1.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.8.8.1.1c.cmml" xref="S3.E4.m1.8.8.1"><eq id="S3.E4.m1.8.8.1.1.5.cmml" xref="S3.E4.m1.8.8.1.1.5"></eq><share href="#S3.E4.m1.8.8.1.1.1.cmml" id="S3.E4.m1.8.8.1.1d.cmml" xref="S3.E4.m1.8.8.1"></share><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><divide id="S3.E4.m1.5.5.6.cmml" xref="S3.E4.m1.5.5"></divide><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><times id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.3a.cmml" xref="S3.E4.m1.1.1.1.3"><mtext id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3">Relu</mtext></ci><apply id="S3.E4.m1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.4.1.cmml" xref="S3.E4.m1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑥</ci><ci id="S3.E4.m1.1.1.1.4.3.cmml" xref="S3.E4.m1.1.1.1.4.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.5.5.5.5.cmml" xref="S3.E4.m1.5.5.5.4"><apply id="S3.E4.m1.4.4.4.3.1.cmml" xref="S3.E4.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.3.1.1.cmml" xref="S3.E4.m1.4.4.4.3.1">subscript</csymbol><max id="S3.E4.m1.4.4.4.3.1.2.cmml" xref="S3.E4.m1.4.4.4.3.1.2"></max><apply id="S3.E4.m1.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1"><in id="S3.E4.m1.2.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.2.1.1.2"></in><ci id="S3.E4.m1.2.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.2.1.1.3">𝑗</ci><apply id="S3.E4.m1.2.2.2.1.1.4.1.cmml" xref="S3.E4.m1.2.2.2.1.1.4.2"><csymbol cd="latexml" id="S3.E4.m1.2.2.2.1.1.4.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E4.m1.2.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1.1">𝑑</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.5.4.2.1.cmml" xref="S3.E4.m1.5.5.5.4.2.1"><times id="S3.E4.m1.5.5.5.4.2.1.1.cmml" xref="S3.E4.m1.5.5.5.4.2.1.1"></times><ci id="S3.E4.m1.5.5.5.4.2.1.2a.cmml" xref="S3.E4.m1.5.5.5.4.2.1.2"><mtext id="S3.E4.m1.5.5.5.4.2.1.2.cmml" xref="S3.E4.m1.5.5.5.4.2.1.2">Relu</mtext></ci><apply id="S3.E4.m1.5.5.5.4.2.1.3.cmml" xref="S3.E4.m1.5.5.5.4.2.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.5.4.2.1.3.1.cmml" xref="S3.E4.m1.5.5.5.4.2.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.2">𝑥</ci><ci id="S3.E4.m1.5.5.5.4.2.1.3.3.cmml" xref="S3.E4.m1.5.5.5.4.2.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.8c">\text{SI-}\sigma(x)_{i}=\textsc{MaxN}(\text{Relu}(x))_{i}=\frac{\text{Relu}(x)_{i}}{\max_{j\in[d]}(\text{Relu}(x)_{j})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.1" class="ltx_p">Similarly, we also propose a scale invariant version of <math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="\tanh" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><mi id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">tanh</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><tanh id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"></tanh></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\tanh</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.5" class="ltx_math_unparsed" alttext="\text{SI-}\tanh(x)_{i}=\textsc{MaxN}(x)_{i}=\frac{x_{i}}{\max_{j\in[d]}(|x_{j}|)}." display="block"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5b"><mtext id="S3.E5.m1.5.6">SI-</mtext><mi id="S3.E5.m1.4.4">tanh</mi><msub id="S3.E5.m1.5.7"><mrow id="S3.E5.m1.5.7.2"><mo stretchy="false" id="S3.E5.m1.5.7.2.1">(</mo><mi id="S3.E5.m1.5.5">x</mi><mo stretchy="false" id="S3.E5.m1.5.7.2.2">)</mo></mrow><mi id="S3.E5.m1.5.7.3">i</mi></msub><mo id="S3.E5.m1.5.8">=</mo><mtext class="ltx_font_smallcaps" id="S3.E5.m1.5.9">MaxN</mtext><msub id="S3.E5.m1.5.10"><mrow id="S3.E5.m1.5.10.2"><mo stretchy="false" id="S3.E5.m1.5.10.2.1">(</mo><mi id="S3.E5.m1.5.10.2.2">x</mi><mo stretchy="false" id="S3.E5.m1.5.10.2.3">)</mo></mrow><mi id="S3.E5.m1.5.10.3">i</mi></msub><mo id="S3.E5.m1.5.11">=</mo><mfrac id="S3.E5.m1.3.3"><msub id="S3.E5.m1.3.3.5"><mi id="S3.E5.m1.3.3.5.2">x</mi><mi id="S3.E5.m1.3.3.5.3">i</mi></msub><mrow id="S3.E5.m1.3.3.3.3"><msub id="S3.E5.m1.2.2.2.2.1"><mi id="S3.E5.m1.2.2.2.2.1.2">max</mi><mrow id="S3.E5.m1.1.1.1.1.1"><mi id="S3.E5.m1.1.1.1.1.1.3">j</mi><mo id="S3.E5.m1.1.1.1.1.1.2">∈</mo><mrow id="S3.E5.m1.1.1.1.1.1.4.2"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.4.2.1">[</mo><mi id="S3.E5.m1.1.1.1.1.1.1">d</mi><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.4.2.2">]</mo></mrow></mrow></msub><mo id="S3.E5.m1.3.3.3.3a">⁡</mo><mrow id="S3.E5.m1.3.3.3.3.2"><mo stretchy="false" id="S3.E5.m1.3.3.3.3.2.2">(</mo><mrow id="S3.E5.m1.3.3.3.3.2.1.1"><mo stretchy="false" id="S3.E5.m1.3.3.3.3.2.1.1.2">|</mo><msub id="S3.E5.m1.3.3.3.3.2.1.1.1"><mi id="S3.E5.m1.3.3.3.3.2.1.1.1.2">x</mi><mi id="S3.E5.m1.3.3.3.3.2.1.1.1.3">j</mi></msub><mo stretchy="false" id="S3.E5.m1.3.3.3.3.2.1.1.3">|</mo></mrow><mo stretchy="false" id="S3.E5.m1.3.3.3.3.2.3">)</mo></mrow></mrow></mfrac><mo lspace="0em" id="S3.E5.m1.5.12">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\text{SI-}\tanh(x)_{i}=\textsc{MaxN}(x)_{i}=\frac{x_{i}}{\max_{j\in[d]}(|x_{j}|)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p9" class="ltx_para">
<p id="S3.SS2.p9.2" class="ltx_p">It is straightforward to see that both <math id="S3.SS2.p9.1.m1.1" class="ltx_Math" alttext="\text{SI-}\sigma" display="inline"><semantics id="S3.SS2.p9.1.m1.1a"><mrow id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml"><mtext id="S3.SS2.p9.1.m1.1.1.2" xref="S3.SS2.p9.1.m1.1.1.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.p9.1.m1.1.1.1" xref="S3.SS2.p9.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.p9.1.m1.1.1.3" xref="S3.SS2.p9.1.m1.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.1b"><apply id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1"><times id="S3.SS2.p9.1.m1.1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1.1"></times><ci id="S3.SS2.p9.1.m1.1.1.2a.cmml" xref="S3.SS2.p9.1.m1.1.1.2"><mtext id="S3.SS2.p9.1.m1.1.1.2.cmml" xref="S3.SS2.p9.1.m1.1.1.2">SI-</mtext></ci><ci id="S3.SS2.p9.1.m1.1.1.3.cmml" xref="S3.SS2.p9.1.m1.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.1c">\text{SI-}\sigma</annotation></semantics></math> and <math id="S3.SS2.p9.2.m2.1" class="ltx_Math" alttext="\text{SI-}\tanh" display="inline"><semantics id="S3.SS2.p9.2.m2.1a"><mrow id="S3.SS2.p9.2.m2.1.1" xref="S3.SS2.p9.2.m2.1.1.cmml"><mtext id="S3.SS2.p9.2.m2.1.1.2" xref="S3.SS2.p9.2.m2.1.1.2a.cmml">SI-</mtext><mo lspace="0.167em" rspace="0em" id="S3.SS2.p9.2.m2.1.1.1" xref="S3.SS2.p9.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.p9.2.m2.1.1.3" xref="S3.SS2.p9.2.m2.1.1.3.cmml">tanh</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.2.m2.1b"><apply id="S3.SS2.p9.2.m2.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1"><times id="S3.SS2.p9.2.m2.1.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1.1"></times><ci id="S3.SS2.p9.2.m2.1.1.2a.cmml" xref="S3.SS2.p9.2.m2.1.1.2"><mtext id="S3.SS2.p9.2.m2.1.1.2.cmml" xref="S3.SS2.p9.2.m2.1.1.2">SI-</mtext></ci><tanh id="S3.SS2.p9.2.m2.1.1.3.cmml" xref="S3.SS2.p9.2.m2.1.1.3"></tanh></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.2.m2.1c">\text{SI-}\tanh</annotation></semantics></math> are scale invariant functions and we provide a short proof for completeness.</p>
</div>
<div id="Thmtheorem1" class="ltx_theorem ltx_theorem_proposition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Proposition 1</span></span><span id="Thmtheorem1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmtheorem1.p1" class="ltx_para">
<p id="Thmtheorem1.p1.2" class="ltx_p"><span id="Thmtheorem1.p1.2.2" class="ltx_text ltx_font_italic">Both <math id="Thmtheorem1.p1.1.1.m1.1" class="ltx_Math" alttext="\text{SI-}\sigma" display="inline"><semantics id="Thmtheorem1.p1.1.1.m1.1a"><mrow id="Thmtheorem1.p1.1.1.m1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="Thmtheorem1.p1.1.1.m1.1.1.2" xref="Thmtheorem1.p1.1.1.m1.1.1.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="Thmtheorem1.p1.1.1.m1.1.1.1" xref="Thmtheorem1.p1.1.1.m1.1.1.1.cmml">​</mo><mi id="Thmtheorem1.p1.1.1.m1.1.1.3" xref="Thmtheorem1.p1.1.1.m1.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.1.1.m1.1b"><apply id="Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1"><times id="Thmtheorem1.p1.1.1.m1.1.1.1.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.1"></times><ci id="Thmtheorem1.p1.1.1.m1.1.1.2a.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_italic" id="Thmtheorem1.p1.1.1.m1.1.1.2.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.2">SI-</mtext></ci><ci id="Thmtheorem1.p1.1.1.m1.1.1.3.cmml" xref="Thmtheorem1.p1.1.1.m1.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.1.1.m1.1c">\text{SI-}\sigma</annotation></semantics></math> and <math id="Thmtheorem1.p1.2.2.m2.1" class="ltx_Math" alttext="\text{SI-}\tanh" display="inline"><semantics id="Thmtheorem1.p1.2.2.m2.1a"><mrow id="Thmtheorem1.p1.2.2.m2.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="Thmtheorem1.p1.2.2.m2.1.1.2" xref="Thmtheorem1.p1.2.2.m2.1.1.2a.cmml">SI-</mtext><mo lspace="0.167em" rspace="0em" id="Thmtheorem1.p1.2.2.m2.1.1.1" xref="Thmtheorem1.p1.2.2.m2.1.1.1.cmml">​</mo><mi id="Thmtheorem1.p1.2.2.m2.1.1.3" xref="Thmtheorem1.p1.2.2.m2.1.1.3.cmml">tanh</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmtheorem1.p1.2.2.m2.1b"><apply id="Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1"><times id="Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.1"></times><ci id="Thmtheorem1.p1.2.2.m2.1.1.2a.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2"><mtext class="ltx_mathvariant_italic" id="Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.2">SI-</mtext></ci><tanh id="Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="Thmtheorem1.p1.2.2.m2.1.1.3"></tanh></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmtheorem1.p1.2.2.m2.1c">\text{SI-}\tanh</annotation></semantics></math> are scale invariant functions.</span></p>
</div>
</div>
<div id="S3.SS2.1" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S3.SS2.1.p1" class="ltx_para">
<p id="S3.SS2.1.p1.3" class="ltx_p">Let <math id="S3.SS2.1.p1.1.m1.1" class="ltx_Math" alttext="a&gt;0" display="inline"><semantics id="S3.SS2.1.p1.1.m1.1a"><mrow id="S3.SS2.1.p1.1.m1.1.1" xref="S3.SS2.1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.1.p1.1.m1.1.1.2" xref="S3.SS2.1.p1.1.m1.1.1.2.cmml">a</mi><mo id="S3.SS2.1.p1.1.m1.1.1.1" xref="S3.SS2.1.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.1.p1.1.m1.1.1.3" xref="S3.SS2.1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.1.m1.1b"><apply id="S3.SS2.1.p1.1.m1.1.1.cmml" xref="S3.SS2.1.p1.1.m1.1.1"><gt id="S3.SS2.1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.1.p1.1.m1.1.1.1"></gt><ci id="S3.SS2.1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.1.p1.1.m1.1.1.2">𝑎</ci><cn type="integer" id="S3.SS2.1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.1.m1.1c">a&gt;0</annotation></semantics></math>. Then
for any <math id="S3.SS2.1.p1.2.m2.1" class="ltx_Math" alttext="i\in d" display="inline"><semantics id="S3.SS2.1.p1.2.m2.1a"><mrow id="S3.SS2.1.p1.2.m2.1.1" xref="S3.SS2.1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.1.p1.2.m2.1.1.2" xref="S3.SS2.1.p1.2.m2.1.1.2.cmml">i</mi><mo id="S3.SS2.1.p1.2.m2.1.1.1" xref="S3.SS2.1.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS2.1.p1.2.m2.1.1.3" xref="S3.SS2.1.p1.2.m2.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.2.m2.1b"><apply id="S3.SS2.1.p1.2.m2.1.1.cmml" xref="S3.SS2.1.p1.2.m2.1.1"><in id="S3.SS2.1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.1.p1.2.m2.1.1.1"></in><ci id="S3.SS2.1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.1.p1.2.m2.1.1.2">𝑖</ci><ci id="S3.SS2.1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.1.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.2.m2.1c">i\in d</annotation></semantics></math>, <math id="S3.SS2.1.p1.3.m3.2" class="ltx_Math" alttext="\text{Relu}(ax)_{i}=a\text{Relu}(x)_{i}" display="inline"><semantics id="S3.SS2.1.p1.3.m3.2a"><mrow id="S3.SS2.1.p1.3.m3.2.2" xref="S3.SS2.1.p1.3.m3.2.2.cmml"><mrow id="S3.SS2.1.p1.3.m3.2.2.1" xref="S3.SS2.1.p1.3.m3.2.2.1.cmml"><mtext id="S3.SS2.1.p1.3.m3.2.2.1.3" xref="S3.SS2.1.p1.3.m3.2.2.1.3a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.1.p1.3.m3.2.2.1.2" xref="S3.SS2.1.p1.3.m3.2.2.1.2.cmml">​</mo><msub id="S3.SS2.1.p1.3.m3.2.2.1.1" xref="S3.SS2.1.p1.3.m3.2.2.1.1.cmml"><mrow id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.2" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.1" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.3" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.3" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.1.p1.3.m3.2.2.1.1.3" xref="S3.SS2.1.p1.3.m3.2.2.1.1.3.cmml">i</mi></msub></mrow><mo id="S3.SS2.1.p1.3.m3.2.2.2" xref="S3.SS2.1.p1.3.m3.2.2.2.cmml">=</mo><mrow id="S3.SS2.1.p1.3.m3.2.2.3" xref="S3.SS2.1.p1.3.m3.2.2.3.cmml"><mi id="S3.SS2.1.p1.3.m3.2.2.3.2" xref="S3.SS2.1.p1.3.m3.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.1.p1.3.m3.2.2.3.1" xref="S3.SS2.1.p1.3.m3.2.2.3.1.cmml">​</mo><mtext id="S3.SS2.1.p1.3.m3.2.2.3.3" xref="S3.SS2.1.p1.3.m3.2.2.3.3a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.1.p1.3.m3.2.2.3.1a" xref="S3.SS2.1.p1.3.m3.2.2.3.1.cmml">​</mo><msub id="S3.SS2.1.p1.3.m3.2.2.3.4" xref="S3.SS2.1.p1.3.m3.2.2.3.4.cmml"><mrow id="S3.SS2.1.p1.3.m3.2.2.3.4.2.2" xref="S3.SS2.1.p1.3.m3.2.2.3.4.cmml"><mo stretchy="false" id="S3.SS2.1.p1.3.m3.2.2.3.4.2.2.1" xref="S3.SS2.1.p1.3.m3.2.2.3.4.cmml">(</mo><mi id="S3.SS2.1.p1.3.m3.1.1" xref="S3.SS2.1.p1.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.1.p1.3.m3.2.2.3.4.2.2.2" xref="S3.SS2.1.p1.3.m3.2.2.3.4.cmml">)</mo></mrow><mi id="S3.SS2.1.p1.3.m3.2.2.3.4.3" xref="S3.SS2.1.p1.3.m3.2.2.3.4.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.3.m3.2b"><apply id="S3.SS2.1.p1.3.m3.2.2.cmml" xref="S3.SS2.1.p1.3.m3.2.2"><eq id="S3.SS2.1.p1.3.m3.2.2.2.cmml" xref="S3.SS2.1.p1.3.m3.2.2.2"></eq><apply id="S3.SS2.1.p1.3.m3.2.2.1.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1"><times id="S3.SS2.1.p1.3.m3.2.2.1.2.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.2"></times><ci id="S3.SS2.1.p1.3.m3.2.2.1.3a.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.3"><mtext id="S3.SS2.1.p1.3.m3.2.2.1.3.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.3">Relu</mtext></ci><apply id="S3.SS2.1.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.1.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.1">subscript</csymbol><apply id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1"><times id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.1"></times><ci id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.1.1.1.1.3">𝑥</ci></apply><ci id="S3.SS2.1.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.1.p1.3.m3.2.2.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS2.1.p1.3.m3.2.2.3.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3"><times id="S3.SS2.1.p1.3.m3.2.2.3.1.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3.1"></times><ci id="S3.SS2.1.p1.3.m3.2.2.3.2.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3.2">𝑎</ci><ci id="S3.SS2.1.p1.3.m3.2.2.3.3a.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3.3"><mtext id="S3.SS2.1.p1.3.m3.2.2.3.3.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3.3">Relu</mtext></ci><apply id="S3.SS2.1.p1.3.m3.2.2.3.4.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3.4"><csymbol cd="ambiguous" id="S3.SS2.1.p1.3.m3.2.2.3.4.1.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3.4">subscript</csymbol><ci id="S3.SS2.1.p1.3.m3.1.1.cmml" xref="S3.SS2.1.p1.3.m3.1.1">𝑥</ci><ci id="S3.SS2.1.p1.3.m3.2.2.3.4.3.cmml" xref="S3.SS2.1.p1.3.m3.2.2.3.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.3.m3.2c">\text{Relu}(ax)_{i}=a\text{Relu}(x)_{i}</annotation></semantics></math> and hence,</p>
<table id="A3.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex6.m1.1" class="ltx_Math" alttext="\displaystyle\text{SI-}\sigma(ax)_{i}" display="inline"><semantics id="S3.Ex6.m1.1a"><mrow id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml"><mtext id="S3.Ex6.m1.1.1.3" xref="S3.Ex6.m1.1.1.3a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.2" xref="S3.Ex6.m1.1.1.2.cmml">​</mo><mi id="S3.Ex6.m1.1.1.4" xref="S3.Ex6.m1.1.1.4.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.2a" xref="S3.Ex6.m1.1.1.2.cmml">​</mo><msub id="S3.Ex6.m1.1.1.1" xref="S3.Ex6.m1.1.1.1.cmml"><mrow id="S3.Ex6.m1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.Ex6.m1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.Ex6.m1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex6.m1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.1b"><apply id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1"><times id="S3.Ex6.m1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.2"></times><ci id="S3.Ex6.m1.1.1.3a.cmml" xref="S3.Ex6.m1.1.1.3"><mtext id="S3.Ex6.m1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.3">SI-</mtext></ci><ci id="S3.Ex6.m1.1.1.4.cmml" xref="S3.Ex6.m1.1.1.4">𝜎</ci><apply id="S3.Ex6.m1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1">subscript</csymbol><apply id="S3.Ex6.m1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1"><times id="S3.Ex6.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1"></times><ci id="S3.Ex6.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.3">𝑥</ci></apply><ci id="S3.Ex6.m1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.1c">\displaystyle\text{SI-}\sigma(ax)_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex6.m2.16" class="ltx_Math" alttext="\displaystyle=\frac{\text{Relu}(ax)_{i}}{\max_{j\in[d]}(\text{Relu}(ax)_{j})}=\frac{a\text{Relu}(x)_{i}}{a\max_{j\in[d]}(\text{Relu}(x)_{j})}=\frac{\text{Relu}(x)_{i}}{\max_{j\in[d]}(\text{Relu}(x)_{j})}=\text{SI-}\sigma(x)_{i}." display="inline"><semantics id="S3.Ex6.m2.16a"><mrow id="S3.Ex6.m2.16.16.1" xref="S3.Ex6.m2.16.16.1.1.cmml"><mrow id="S3.Ex6.m2.16.16.1.1" xref="S3.Ex6.m2.16.16.1.1.cmml"><mi id="S3.Ex6.m2.16.16.1.1.2" xref="S3.Ex6.m2.16.16.1.1.2.cmml"></mi><mo id="S3.Ex6.m2.16.16.1.1.3" xref="S3.Ex6.m2.16.16.1.1.3.cmml">=</mo><mstyle displaystyle="true" id="S3.Ex6.m2.4.4" xref="S3.Ex6.m2.4.4.cmml"><mfrac id="S3.Ex6.m2.4.4a" xref="S3.Ex6.m2.4.4.cmml"><mrow id="S3.Ex6.m2.1.1.1" xref="S3.Ex6.m2.1.1.1.cmml"><mtext id="S3.Ex6.m2.1.1.1.3" xref="S3.Ex6.m2.1.1.1.3a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.1.1.1.2" xref="S3.Ex6.m2.1.1.1.2.cmml">​</mo><msub id="S3.Ex6.m2.1.1.1.1" xref="S3.Ex6.m2.1.1.1.1.cmml"><mrow id="S3.Ex6.m2.1.1.1.1.1.1" xref="S3.Ex6.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m2.1.1.1.1.1.1.2" xref="S3.Ex6.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m2.1.1.1.1.1.1.1" xref="S3.Ex6.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m2.1.1.1.1.1.1.1.2" xref="S3.Ex6.m2.1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.1.1.1.1.1.1.1.1" xref="S3.Ex6.m2.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.Ex6.m2.1.1.1.1.1.1.1.3" xref="S3.Ex6.m2.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.Ex6.m2.1.1.1.1.1.1.3" xref="S3.Ex6.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex6.m2.1.1.1.1.3" xref="S3.Ex6.m2.1.1.1.1.3.cmml">i</mi></msub></mrow><mrow id="S3.Ex6.m2.4.4.4.3" xref="S3.Ex6.m2.4.4.4.4.cmml"><msub id="S3.Ex6.m2.3.3.3.2.1" xref="S3.Ex6.m2.3.3.3.2.1.cmml"><mi id="S3.Ex6.m2.3.3.3.2.1.2" xref="S3.Ex6.m2.3.3.3.2.1.2.cmml">max</mi><mrow id="S3.Ex6.m2.2.2.2.1.1" xref="S3.Ex6.m2.2.2.2.1.1.cmml"><mi id="S3.Ex6.m2.2.2.2.1.1.3" xref="S3.Ex6.m2.2.2.2.1.1.3.cmml">j</mi><mo id="S3.Ex6.m2.2.2.2.1.1.2" xref="S3.Ex6.m2.2.2.2.1.1.2.cmml">∈</mo><mrow id="S3.Ex6.m2.2.2.2.1.1.4.2" xref="S3.Ex6.m2.2.2.2.1.1.4.1.cmml"><mo stretchy="false" id="S3.Ex6.m2.2.2.2.1.1.4.2.1" xref="S3.Ex6.m2.2.2.2.1.1.4.1.1.cmml">[</mo><mi id="S3.Ex6.m2.2.2.2.1.1.1" xref="S3.Ex6.m2.2.2.2.1.1.1.cmml">d</mi><mo stretchy="false" id="S3.Ex6.m2.2.2.2.1.1.4.2.2" xref="S3.Ex6.m2.2.2.2.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mo id="S3.Ex6.m2.4.4.4.3a" xref="S3.Ex6.m2.4.4.4.4.cmml">⁡</mo><mrow id="S3.Ex6.m2.4.4.4.3.2" xref="S3.Ex6.m2.4.4.4.4.cmml"><mo stretchy="false" id="S3.Ex6.m2.4.4.4.3.2.2" xref="S3.Ex6.m2.4.4.4.4.cmml">(</mo><mrow id="S3.Ex6.m2.4.4.4.3.2.1" xref="S3.Ex6.m2.4.4.4.3.2.1.cmml"><mtext id="S3.Ex6.m2.4.4.4.3.2.1.3" xref="S3.Ex6.m2.4.4.4.3.2.1.3a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.4.4.4.3.2.1.2" xref="S3.Ex6.m2.4.4.4.3.2.1.2.cmml">​</mo><msub id="S3.Ex6.m2.4.4.4.3.2.1.1" xref="S3.Ex6.m2.4.4.4.3.2.1.1.cmml"><mrow id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.2" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.cmml"><mi id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.2" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.1" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.1.cmml">​</mo><mi id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.3" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.3" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.Ex6.m2.4.4.4.3.2.1.1.3" xref="S3.Ex6.m2.4.4.4.3.2.1.1.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.Ex6.m2.4.4.4.3.2.3" xref="S3.Ex6.m2.4.4.4.4.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.Ex6.m2.16.16.1.1.4" xref="S3.Ex6.m2.16.16.1.1.4.cmml">=</mo><mstyle displaystyle="true" id="S3.Ex6.m2.9.9" xref="S3.Ex6.m2.9.9.cmml"><mfrac id="S3.Ex6.m2.9.9a" xref="S3.Ex6.m2.9.9.cmml"><mrow id="S3.Ex6.m2.5.5.1" xref="S3.Ex6.m2.5.5.1.cmml"><mi id="S3.Ex6.m2.5.5.1.3" xref="S3.Ex6.m2.5.5.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.5.5.1.2" xref="S3.Ex6.m2.5.5.1.2.cmml">​</mo><mtext id="S3.Ex6.m2.5.5.1.4" xref="S3.Ex6.m2.5.5.1.4a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.5.5.1.2a" xref="S3.Ex6.m2.5.5.1.2.cmml">​</mo><msub id="S3.Ex6.m2.5.5.1.5" xref="S3.Ex6.m2.5.5.1.5.cmml"><mrow id="S3.Ex6.m2.5.5.1.5.2.2" xref="S3.Ex6.m2.5.5.1.5.cmml"><mo stretchy="false" id="S3.Ex6.m2.5.5.1.5.2.2.1" xref="S3.Ex6.m2.5.5.1.5.cmml">(</mo><mi id="S3.Ex6.m2.5.5.1.1" xref="S3.Ex6.m2.5.5.1.1.cmml">x</mi><mo stretchy="false" id="S3.Ex6.m2.5.5.1.5.2.2.2" xref="S3.Ex6.m2.5.5.1.5.cmml">)</mo></mrow><mi id="S3.Ex6.m2.5.5.1.5.3" xref="S3.Ex6.m2.5.5.1.5.3.cmml">i</mi></msub></mrow><mrow id="S3.Ex6.m2.9.9.5" xref="S3.Ex6.m2.9.9.5.cmml"><mi id="S3.Ex6.m2.9.9.5.6" xref="S3.Ex6.m2.9.9.5.6.cmml">a</mi><mo lspace="0.167em" rspace="0em" id="S3.Ex6.m2.9.9.5.5" xref="S3.Ex6.m2.9.9.5.5.cmml">​</mo><mrow id="S3.Ex6.m2.9.9.5.4.2" xref="S3.Ex6.m2.9.9.5.4.3.cmml"><msub id="S3.Ex6.m2.8.8.4.3.1.1" xref="S3.Ex6.m2.8.8.4.3.1.1.cmml"><mi id="S3.Ex6.m2.8.8.4.3.1.1.2" xref="S3.Ex6.m2.8.8.4.3.1.1.2.cmml">max</mi><mrow id="S3.Ex6.m2.6.6.2.1.1" xref="S3.Ex6.m2.6.6.2.1.1.cmml"><mi id="S3.Ex6.m2.6.6.2.1.1.3" xref="S3.Ex6.m2.6.6.2.1.1.3.cmml">j</mi><mo id="S3.Ex6.m2.6.6.2.1.1.2" xref="S3.Ex6.m2.6.6.2.1.1.2.cmml">∈</mo><mrow id="S3.Ex6.m2.6.6.2.1.1.4.2" xref="S3.Ex6.m2.6.6.2.1.1.4.1.cmml"><mo stretchy="false" id="S3.Ex6.m2.6.6.2.1.1.4.2.1" xref="S3.Ex6.m2.6.6.2.1.1.4.1.1.cmml">[</mo><mi id="S3.Ex6.m2.6.6.2.1.1.1" xref="S3.Ex6.m2.6.6.2.1.1.1.cmml">d</mi><mo stretchy="false" id="S3.Ex6.m2.6.6.2.1.1.4.2.2" xref="S3.Ex6.m2.6.6.2.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mo id="S3.Ex6.m2.9.9.5.4.2a" xref="S3.Ex6.m2.9.9.5.4.3.cmml">⁡</mo><mrow id="S3.Ex6.m2.9.9.5.4.2.2" xref="S3.Ex6.m2.9.9.5.4.3.cmml"><mo stretchy="false" id="S3.Ex6.m2.9.9.5.4.2.2.2" xref="S3.Ex6.m2.9.9.5.4.3.cmml">(</mo><mrow id="S3.Ex6.m2.9.9.5.4.2.2.1" xref="S3.Ex6.m2.9.9.5.4.2.2.1.cmml"><mtext id="S3.Ex6.m2.9.9.5.4.2.2.1.2" xref="S3.Ex6.m2.9.9.5.4.2.2.1.2a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.9.9.5.4.2.2.1.1" xref="S3.Ex6.m2.9.9.5.4.2.2.1.1.cmml">​</mo><msub id="S3.Ex6.m2.9.9.5.4.2.2.1.3" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3.cmml"><mrow id="S3.Ex6.m2.9.9.5.4.2.2.1.3.2.2" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3.cmml"><mo stretchy="false" id="S3.Ex6.m2.9.9.5.4.2.2.1.3.2.2.1" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3.cmml">(</mo><mi id="S3.Ex6.m2.7.7.3.2" xref="S3.Ex6.m2.7.7.3.2.cmml">x</mi><mo stretchy="false" id="S3.Ex6.m2.9.9.5.4.2.2.1.3.2.2.2" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3.cmml">)</mo></mrow><mi id="S3.Ex6.m2.9.9.5.4.2.2.1.3.3" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.Ex6.m2.9.9.5.4.2.2.3" xref="S3.Ex6.m2.9.9.5.4.3.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle><mo id="S3.Ex6.m2.16.16.1.1.5" xref="S3.Ex6.m2.16.16.1.1.5.cmml">=</mo><mstyle displaystyle="true" id="S3.Ex6.m2.14.14" xref="S3.Ex6.m2.14.14.cmml"><mfrac id="S3.Ex6.m2.14.14a" xref="S3.Ex6.m2.14.14.cmml"><mrow id="S3.Ex6.m2.10.10.1" xref="S3.Ex6.m2.10.10.1.cmml"><mtext id="S3.Ex6.m2.10.10.1.3" xref="S3.Ex6.m2.10.10.1.3a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.10.10.1.2" xref="S3.Ex6.m2.10.10.1.2.cmml">​</mo><msub id="S3.Ex6.m2.10.10.1.4" xref="S3.Ex6.m2.10.10.1.4.cmml"><mrow id="S3.Ex6.m2.10.10.1.4.2.2" xref="S3.Ex6.m2.10.10.1.4.cmml"><mo stretchy="false" id="S3.Ex6.m2.10.10.1.4.2.2.1" xref="S3.Ex6.m2.10.10.1.4.cmml">(</mo><mi id="S3.Ex6.m2.10.10.1.1" xref="S3.Ex6.m2.10.10.1.1.cmml">x</mi><mo stretchy="false" id="S3.Ex6.m2.10.10.1.4.2.2.2" xref="S3.Ex6.m2.10.10.1.4.cmml">)</mo></mrow><mi id="S3.Ex6.m2.10.10.1.4.3" xref="S3.Ex6.m2.10.10.1.4.3.cmml">i</mi></msub></mrow><mrow id="S3.Ex6.m2.14.14.5.4" xref="S3.Ex6.m2.14.14.5.5.cmml"><msub id="S3.Ex6.m2.13.13.4.3.1" xref="S3.Ex6.m2.13.13.4.3.1.cmml"><mi id="S3.Ex6.m2.13.13.4.3.1.2" xref="S3.Ex6.m2.13.13.4.3.1.2.cmml">max</mi><mrow id="S3.Ex6.m2.11.11.2.1.1" xref="S3.Ex6.m2.11.11.2.1.1.cmml"><mi id="S3.Ex6.m2.11.11.2.1.1.3" xref="S3.Ex6.m2.11.11.2.1.1.3.cmml">j</mi><mo id="S3.Ex6.m2.11.11.2.1.1.2" xref="S3.Ex6.m2.11.11.2.1.1.2.cmml">∈</mo><mrow id="S3.Ex6.m2.11.11.2.1.1.4.2" xref="S3.Ex6.m2.11.11.2.1.1.4.1.cmml"><mo stretchy="false" id="S3.Ex6.m2.11.11.2.1.1.4.2.1" xref="S3.Ex6.m2.11.11.2.1.1.4.1.1.cmml">[</mo><mi id="S3.Ex6.m2.11.11.2.1.1.1" xref="S3.Ex6.m2.11.11.2.1.1.1.cmml">d</mi><mo stretchy="false" id="S3.Ex6.m2.11.11.2.1.1.4.2.2" xref="S3.Ex6.m2.11.11.2.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mo id="S3.Ex6.m2.14.14.5.4a" xref="S3.Ex6.m2.14.14.5.5.cmml">⁡</mo><mrow id="S3.Ex6.m2.14.14.5.4.2" xref="S3.Ex6.m2.14.14.5.5.cmml"><mo stretchy="false" id="S3.Ex6.m2.14.14.5.4.2.2" xref="S3.Ex6.m2.14.14.5.5.cmml">(</mo><mrow id="S3.Ex6.m2.14.14.5.4.2.1" xref="S3.Ex6.m2.14.14.5.4.2.1.cmml"><mtext id="S3.Ex6.m2.14.14.5.4.2.1.2" xref="S3.Ex6.m2.14.14.5.4.2.1.2a.cmml">Relu</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.14.14.5.4.2.1.1" xref="S3.Ex6.m2.14.14.5.4.2.1.1.cmml">​</mo><msub id="S3.Ex6.m2.14.14.5.4.2.1.3" xref="S3.Ex6.m2.14.14.5.4.2.1.3.cmml"><mrow id="S3.Ex6.m2.14.14.5.4.2.1.3.2.2" xref="S3.Ex6.m2.14.14.5.4.2.1.3.cmml"><mo stretchy="false" id="S3.Ex6.m2.14.14.5.4.2.1.3.2.2.1" xref="S3.Ex6.m2.14.14.5.4.2.1.3.cmml">(</mo><mi id="S3.Ex6.m2.12.12.3.2" xref="S3.Ex6.m2.12.12.3.2.cmml">x</mi><mo stretchy="false" id="S3.Ex6.m2.14.14.5.4.2.1.3.2.2.2" xref="S3.Ex6.m2.14.14.5.4.2.1.3.cmml">)</mo></mrow><mi id="S3.Ex6.m2.14.14.5.4.2.1.3.3" xref="S3.Ex6.m2.14.14.5.4.2.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.Ex6.m2.14.14.5.4.2.3" xref="S3.Ex6.m2.14.14.5.5.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S3.Ex6.m2.16.16.1.1.6" xref="S3.Ex6.m2.16.16.1.1.6.cmml">=</mo><mrow id="S3.Ex6.m2.16.16.1.1.7" xref="S3.Ex6.m2.16.16.1.1.7.cmml"><mtext id="S3.Ex6.m2.16.16.1.1.7.2" xref="S3.Ex6.m2.16.16.1.1.7.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.16.16.1.1.7.1" xref="S3.Ex6.m2.16.16.1.1.7.1.cmml">​</mo><mi id="S3.Ex6.m2.16.16.1.1.7.3" xref="S3.Ex6.m2.16.16.1.1.7.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m2.16.16.1.1.7.1a" xref="S3.Ex6.m2.16.16.1.1.7.1.cmml">​</mo><msub id="S3.Ex6.m2.16.16.1.1.7.4" xref="S3.Ex6.m2.16.16.1.1.7.4.cmml"><mrow id="S3.Ex6.m2.16.16.1.1.7.4.2.2" xref="S3.Ex6.m2.16.16.1.1.7.4.cmml"><mo stretchy="false" id="S3.Ex6.m2.16.16.1.1.7.4.2.2.1" xref="S3.Ex6.m2.16.16.1.1.7.4.cmml">(</mo><mi id="S3.Ex6.m2.15.15" xref="S3.Ex6.m2.15.15.cmml">x</mi><mo stretchy="false" id="S3.Ex6.m2.16.16.1.1.7.4.2.2.2" xref="S3.Ex6.m2.16.16.1.1.7.4.cmml">)</mo></mrow><mi id="S3.Ex6.m2.16.16.1.1.7.4.3" xref="S3.Ex6.m2.16.16.1.1.7.4.3.cmml">i</mi></msub></mrow></mrow><mo lspace="0em" id="S3.Ex6.m2.16.16.1.2" xref="S3.Ex6.m2.16.16.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m2.16b"><apply id="S3.Ex6.m2.16.16.1.1.cmml" xref="S3.Ex6.m2.16.16.1"><and id="S3.Ex6.m2.16.16.1.1a.cmml" xref="S3.Ex6.m2.16.16.1"></and><apply id="S3.Ex6.m2.16.16.1.1b.cmml" xref="S3.Ex6.m2.16.16.1"><eq id="S3.Ex6.m2.16.16.1.1.3.cmml" xref="S3.Ex6.m2.16.16.1.1.3"></eq><csymbol cd="latexml" id="S3.Ex6.m2.16.16.1.1.2.cmml" xref="S3.Ex6.m2.16.16.1.1.2">absent</csymbol><apply id="S3.Ex6.m2.4.4.cmml" xref="S3.Ex6.m2.4.4"><divide id="S3.Ex6.m2.4.4.5.cmml" xref="S3.Ex6.m2.4.4"></divide><apply id="S3.Ex6.m2.1.1.1.cmml" xref="S3.Ex6.m2.1.1.1"><times id="S3.Ex6.m2.1.1.1.2.cmml" xref="S3.Ex6.m2.1.1.1.2"></times><ci id="S3.Ex6.m2.1.1.1.3a.cmml" xref="S3.Ex6.m2.1.1.1.3"><mtext id="S3.Ex6.m2.1.1.1.3.cmml" xref="S3.Ex6.m2.1.1.1.3">Relu</mtext></ci><apply id="S3.Ex6.m2.1.1.1.1.cmml" xref="S3.Ex6.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m2.1.1.1.1.2.cmml" xref="S3.Ex6.m2.1.1.1.1">subscript</csymbol><apply id="S3.Ex6.m2.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.1.1.1.1.1.1"><times id="S3.Ex6.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex6.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m2.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S3.Ex6.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m2.1.1.1.1.1.1.1.3">𝑥</ci></apply><ci id="S3.Ex6.m2.1.1.1.1.3.cmml" xref="S3.Ex6.m2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.Ex6.m2.4.4.4.4.cmml" xref="S3.Ex6.m2.4.4.4.3"><apply id="S3.Ex6.m2.3.3.3.2.1.cmml" xref="S3.Ex6.m2.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.Ex6.m2.3.3.3.2.1.1.cmml" xref="S3.Ex6.m2.3.3.3.2.1">subscript</csymbol><max id="S3.Ex6.m2.3.3.3.2.1.2.cmml" xref="S3.Ex6.m2.3.3.3.2.1.2"></max><apply id="S3.Ex6.m2.2.2.2.1.1.cmml" xref="S3.Ex6.m2.2.2.2.1.1"><in id="S3.Ex6.m2.2.2.2.1.1.2.cmml" xref="S3.Ex6.m2.2.2.2.1.1.2"></in><ci id="S3.Ex6.m2.2.2.2.1.1.3.cmml" xref="S3.Ex6.m2.2.2.2.1.1.3">𝑗</ci><apply id="S3.Ex6.m2.2.2.2.1.1.4.1.cmml" xref="S3.Ex6.m2.2.2.2.1.1.4.2"><csymbol cd="latexml" id="S3.Ex6.m2.2.2.2.1.1.4.1.1.cmml" xref="S3.Ex6.m2.2.2.2.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.Ex6.m2.2.2.2.1.1.1.cmml" xref="S3.Ex6.m2.2.2.2.1.1.1">𝑑</ci></apply></apply></apply><apply id="S3.Ex6.m2.4.4.4.3.2.1.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1"><times id="S3.Ex6.m2.4.4.4.3.2.1.2.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.2"></times><ci id="S3.Ex6.m2.4.4.4.3.2.1.3a.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.3"><mtext id="S3.Ex6.m2.4.4.4.3.2.1.3.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.3">Relu</mtext></ci><apply id="S3.Ex6.m2.4.4.4.3.2.1.1.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m2.4.4.4.3.2.1.1.2.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.1">subscript</csymbol><apply id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1"><times id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.1.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.1"></times><ci id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.2.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.2">𝑎</ci><ci id="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.3.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.1.1.1.1.3">𝑥</ci></apply><ci id="S3.Ex6.m2.4.4.4.3.2.1.1.3.cmml" xref="S3.Ex6.m2.4.4.4.3.2.1.1.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.Ex6.m2.16.16.1.1c.cmml" xref="S3.Ex6.m2.16.16.1"><eq id="S3.Ex6.m2.16.16.1.1.4.cmml" xref="S3.Ex6.m2.16.16.1.1.4"></eq><share href="#S3.Ex6.m2.4.4.cmml" id="S3.Ex6.m2.16.16.1.1d.cmml" xref="S3.Ex6.m2.16.16.1"></share><apply id="S3.Ex6.m2.9.9.cmml" xref="S3.Ex6.m2.9.9"><divide id="S3.Ex6.m2.9.9.6.cmml" xref="S3.Ex6.m2.9.9"></divide><apply id="S3.Ex6.m2.5.5.1.cmml" xref="S3.Ex6.m2.5.5.1"><times id="S3.Ex6.m2.5.5.1.2.cmml" xref="S3.Ex6.m2.5.5.1.2"></times><ci id="S3.Ex6.m2.5.5.1.3.cmml" xref="S3.Ex6.m2.5.5.1.3">𝑎</ci><ci id="S3.Ex6.m2.5.5.1.4a.cmml" xref="S3.Ex6.m2.5.5.1.4"><mtext id="S3.Ex6.m2.5.5.1.4.cmml" xref="S3.Ex6.m2.5.5.1.4">Relu</mtext></ci><apply id="S3.Ex6.m2.5.5.1.5.cmml" xref="S3.Ex6.m2.5.5.1.5"><csymbol cd="ambiguous" id="S3.Ex6.m2.5.5.1.5.1.cmml" xref="S3.Ex6.m2.5.5.1.5">subscript</csymbol><ci id="S3.Ex6.m2.5.5.1.1.cmml" xref="S3.Ex6.m2.5.5.1.1">𝑥</ci><ci id="S3.Ex6.m2.5.5.1.5.3.cmml" xref="S3.Ex6.m2.5.5.1.5.3">𝑖</ci></apply></apply><apply id="S3.Ex6.m2.9.9.5.cmml" xref="S3.Ex6.m2.9.9.5"><times id="S3.Ex6.m2.9.9.5.5.cmml" xref="S3.Ex6.m2.9.9.5.5"></times><ci id="S3.Ex6.m2.9.9.5.6.cmml" xref="S3.Ex6.m2.9.9.5.6">𝑎</ci><apply id="S3.Ex6.m2.9.9.5.4.3.cmml" xref="S3.Ex6.m2.9.9.5.4.2"><apply id="S3.Ex6.m2.8.8.4.3.1.1.cmml" xref="S3.Ex6.m2.8.8.4.3.1.1"><csymbol cd="ambiguous" id="S3.Ex6.m2.8.8.4.3.1.1.1.cmml" xref="S3.Ex6.m2.8.8.4.3.1.1">subscript</csymbol><max id="S3.Ex6.m2.8.8.4.3.1.1.2.cmml" xref="S3.Ex6.m2.8.8.4.3.1.1.2"></max><apply id="S3.Ex6.m2.6.6.2.1.1.cmml" xref="S3.Ex6.m2.6.6.2.1.1"><in id="S3.Ex6.m2.6.6.2.1.1.2.cmml" xref="S3.Ex6.m2.6.6.2.1.1.2"></in><ci id="S3.Ex6.m2.6.6.2.1.1.3.cmml" xref="S3.Ex6.m2.6.6.2.1.1.3">𝑗</ci><apply id="S3.Ex6.m2.6.6.2.1.1.4.1.cmml" xref="S3.Ex6.m2.6.6.2.1.1.4.2"><csymbol cd="latexml" id="S3.Ex6.m2.6.6.2.1.1.4.1.1.cmml" xref="S3.Ex6.m2.6.6.2.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.Ex6.m2.6.6.2.1.1.1.cmml" xref="S3.Ex6.m2.6.6.2.1.1.1">𝑑</ci></apply></apply></apply><apply id="S3.Ex6.m2.9.9.5.4.2.2.1.cmml" xref="S3.Ex6.m2.9.9.5.4.2.2.1"><times id="S3.Ex6.m2.9.9.5.4.2.2.1.1.cmml" xref="S3.Ex6.m2.9.9.5.4.2.2.1.1"></times><ci id="S3.Ex6.m2.9.9.5.4.2.2.1.2a.cmml" xref="S3.Ex6.m2.9.9.5.4.2.2.1.2"><mtext id="S3.Ex6.m2.9.9.5.4.2.2.1.2.cmml" xref="S3.Ex6.m2.9.9.5.4.2.2.1.2">Relu</mtext></ci><apply id="S3.Ex6.m2.9.9.5.4.2.2.1.3.cmml" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m2.9.9.5.4.2.2.1.3.1.cmml" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3">subscript</csymbol><ci id="S3.Ex6.m2.7.7.3.2.cmml" xref="S3.Ex6.m2.7.7.3.2">𝑥</ci><ci id="S3.Ex6.m2.9.9.5.4.2.2.1.3.3.cmml" xref="S3.Ex6.m2.9.9.5.4.2.2.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply><apply id="S3.Ex6.m2.16.16.1.1e.cmml" xref="S3.Ex6.m2.16.16.1"><eq id="S3.Ex6.m2.16.16.1.1.5.cmml" xref="S3.Ex6.m2.16.16.1.1.5"></eq><share href="#S3.Ex6.m2.9.9.cmml" id="S3.Ex6.m2.16.16.1.1f.cmml" xref="S3.Ex6.m2.16.16.1"></share><apply id="S3.Ex6.m2.14.14.cmml" xref="S3.Ex6.m2.14.14"><divide id="S3.Ex6.m2.14.14.6.cmml" xref="S3.Ex6.m2.14.14"></divide><apply id="S3.Ex6.m2.10.10.1.cmml" xref="S3.Ex6.m2.10.10.1"><times id="S3.Ex6.m2.10.10.1.2.cmml" xref="S3.Ex6.m2.10.10.1.2"></times><ci id="S3.Ex6.m2.10.10.1.3a.cmml" xref="S3.Ex6.m2.10.10.1.3"><mtext id="S3.Ex6.m2.10.10.1.3.cmml" xref="S3.Ex6.m2.10.10.1.3">Relu</mtext></ci><apply id="S3.Ex6.m2.10.10.1.4.cmml" xref="S3.Ex6.m2.10.10.1.4"><csymbol cd="ambiguous" id="S3.Ex6.m2.10.10.1.4.1.cmml" xref="S3.Ex6.m2.10.10.1.4">subscript</csymbol><ci id="S3.Ex6.m2.10.10.1.1.cmml" xref="S3.Ex6.m2.10.10.1.1">𝑥</ci><ci id="S3.Ex6.m2.10.10.1.4.3.cmml" xref="S3.Ex6.m2.10.10.1.4.3">𝑖</ci></apply></apply><apply id="S3.Ex6.m2.14.14.5.5.cmml" xref="S3.Ex6.m2.14.14.5.4"><apply id="S3.Ex6.m2.13.13.4.3.1.cmml" xref="S3.Ex6.m2.13.13.4.3.1"><csymbol cd="ambiguous" id="S3.Ex6.m2.13.13.4.3.1.1.cmml" xref="S3.Ex6.m2.13.13.4.3.1">subscript</csymbol><max id="S3.Ex6.m2.13.13.4.3.1.2.cmml" xref="S3.Ex6.m2.13.13.4.3.1.2"></max><apply id="S3.Ex6.m2.11.11.2.1.1.cmml" xref="S3.Ex6.m2.11.11.2.1.1"><in id="S3.Ex6.m2.11.11.2.1.1.2.cmml" xref="S3.Ex6.m2.11.11.2.1.1.2"></in><ci id="S3.Ex6.m2.11.11.2.1.1.3.cmml" xref="S3.Ex6.m2.11.11.2.1.1.3">𝑗</ci><apply id="S3.Ex6.m2.11.11.2.1.1.4.1.cmml" xref="S3.Ex6.m2.11.11.2.1.1.4.2"><csymbol cd="latexml" id="S3.Ex6.m2.11.11.2.1.1.4.1.1.cmml" xref="S3.Ex6.m2.11.11.2.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.Ex6.m2.11.11.2.1.1.1.cmml" xref="S3.Ex6.m2.11.11.2.1.1.1">𝑑</ci></apply></apply></apply><apply id="S3.Ex6.m2.14.14.5.4.2.1.cmml" xref="S3.Ex6.m2.14.14.5.4.2.1"><times id="S3.Ex6.m2.14.14.5.4.2.1.1.cmml" xref="S3.Ex6.m2.14.14.5.4.2.1.1"></times><ci id="S3.Ex6.m2.14.14.5.4.2.1.2a.cmml" xref="S3.Ex6.m2.14.14.5.4.2.1.2"><mtext id="S3.Ex6.m2.14.14.5.4.2.1.2.cmml" xref="S3.Ex6.m2.14.14.5.4.2.1.2">Relu</mtext></ci><apply id="S3.Ex6.m2.14.14.5.4.2.1.3.cmml" xref="S3.Ex6.m2.14.14.5.4.2.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m2.14.14.5.4.2.1.3.1.cmml" xref="S3.Ex6.m2.14.14.5.4.2.1.3">subscript</csymbol><ci id="S3.Ex6.m2.12.12.3.2.cmml" xref="S3.Ex6.m2.12.12.3.2">𝑥</ci><ci id="S3.Ex6.m2.14.14.5.4.2.1.3.3.cmml" xref="S3.Ex6.m2.14.14.5.4.2.1.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.Ex6.m2.16.16.1.1g.cmml" xref="S3.Ex6.m2.16.16.1"><eq id="S3.Ex6.m2.16.16.1.1.6.cmml" xref="S3.Ex6.m2.16.16.1.1.6"></eq><share href="#S3.Ex6.m2.14.14.cmml" id="S3.Ex6.m2.16.16.1.1h.cmml" xref="S3.Ex6.m2.16.16.1"></share><apply id="S3.Ex6.m2.16.16.1.1.7.cmml" xref="S3.Ex6.m2.16.16.1.1.7"><times id="S3.Ex6.m2.16.16.1.1.7.1.cmml" xref="S3.Ex6.m2.16.16.1.1.7.1"></times><ci id="S3.Ex6.m2.16.16.1.1.7.2a.cmml" xref="S3.Ex6.m2.16.16.1.1.7.2"><mtext id="S3.Ex6.m2.16.16.1.1.7.2.cmml" xref="S3.Ex6.m2.16.16.1.1.7.2">SI-</mtext></ci><ci id="S3.Ex6.m2.16.16.1.1.7.3.cmml" xref="S3.Ex6.m2.16.16.1.1.7.3">𝜎</ci><apply id="S3.Ex6.m2.16.16.1.1.7.4.cmml" xref="S3.Ex6.m2.16.16.1.1.7.4"><csymbol cd="ambiguous" id="S3.Ex6.m2.16.16.1.1.7.4.1.cmml" xref="S3.Ex6.m2.16.16.1.1.7.4">subscript</csymbol><ci id="S3.Ex6.m2.15.15.cmml" xref="S3.Ex6.m2.15.15">𝑥</ci><ci id="S3.Ex6.m2.16.16.1.1.7.4.3.cmml" xref="S3.Ex6.m2.16.16.1.1.7.4.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m2.16c">\displaystyle=\frac{\text{Relu}(ax)_{i}}{\max_{j\in[d]}(\text{Relu}(ax)_{j})}=\frac{a\text{Relu}(x)_{i}}{a\max_{j\in[d]}(\text{Relu}(x)_{j})}=\frac{\text{Relu}(x)_{i}}{\max_{j\in[d]}(\text{Relu}(x)_{j})}=\text{SI-}\sigma(x)_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.1.p1.4" class="ltx_p">The calculations for <math id="S3.SS2.1.p1.4.m1.1" class="ltx_Math" alttext="\text{SI-}\tanh" display="inline"><semantics id="S3.SS2.1.p1.4.m1.1a"><mrow id="S3.SS2.1.p1.4.m1.1.1" xref="S3.SS2.1.p1.4.m1.1.1.cmml"><mtext id="S3.SS2.1.p1.4.m1.1.1.2" xref="S3.SS2.1.p1.4.m1.1.1.2a.cmml">SI-</mtext><mo lspace="0.167em" rspace="0em" id="S3.SS2.1.p1.4.m1.1.1.1" xref="S3.SS2.1.p1.4.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.1.p1.4.m1.1.1.3" xref="S3.SS2.1.p1.4.m1.1.1.3.cmml">tanh</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.1.p1.4.m1.1b"><apply id="S3.SS2.1.p1.4.m1.1.1.cmml" xref="S3.SS2.1.p1.4.m1.1.1"><times id="S3.SS2.1.p1.4.m1.1.1.1.cmml" xref="S3.SS2.1.p1.4.m1.1.1.1"></times><ci id="S3.SS2.1.p1.4.m1.1.1.2a.cmml" xref="S3.SS2.1.p1.4.m1.1.1.2"><mtext id="S3.SS2.1.p1.4.m1.1.1.2.cmml" xref="S3.SS2.1.p1.4.m1.1.1.2">SI-</mtext></ci><tanh id="S3.SS2.1.p1.4.m1.1.1.3.cmml" xref="S3.SS2.1.p1.4.m1.1.1.3"></tanh></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.1.p1.4.m1.1c">\text{SI-}\tanh</annotation></semantics></math> are are similar and omitted.
∎</p>
</div>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments with Federated learning</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We report results for experiments using scale invariant architectures in large scale FL in both simulation and live production experiments.
For simulations, we train a language model on the English Stack Overflow federated dataset, containing questions and answers from the forum grouped by username, provided from TensorFlow Federated (TFF) <cite class="ltx_cite ltx_citemacro_citep">(TFF, <a href="#bib.bib41" title="" class="ltx_ref">2018</a>)</cite>.
For live production experiments, we train an English language model on millions of virtual keyboard user devices and follow the same settings and FL requirements for client participation as <cite class="ltx_cite ltx_citemacro_citet">Hard et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018b</a>)</cite>.
All experiments were implemented using the open-source FedJAX <cite class="ltx_cite ltx_citemacro_citep">(Ro et al., <a href="#bib.bib37" title="" class="ltx_ref">2021b</a>)</cite> and TFF libraries.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Federated experiments on public datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">For experiments on the Stack Overflow federated dataset, we compare the following models:</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.5" class="ltx_p">CIFG <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="19" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><mn id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><cn type="integer" id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">19</annotation></semantics></math>M: Coupled Input Forget Gate variant of LSTM with <math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="19" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><mn id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><cn type="integer" id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">19</annotation></semantics></math>M trainable parameters with <math id="S4.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.I1.i1.p1.3.m3.1a"><mn id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><cn type="integer" id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">1</annotation></semantics></math> layer of size <math id="S4.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S4.I1.i1.p1.4.m4.1a"><mn id="S4.I1.i1.p1.4.m4.1.1" xref="S4.I1.i1.p1.4.m4.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.1b"><cn type="integer" id="S4.I1.i1.p1.4.m4.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.1c">2048</annotation></semantics></math>, embedding size <math id="S4.I1.i1.p1.5.m5.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S4.I1.i1.p1.5.m5.1a"><mn id="S4.I1.i1.p1.5.m5.1.1" xref="S4.I1.i1.p1.5.m5.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.5.m5.1b"><cn type="integer" id="S4.I1.i1.p1.5.m5.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.5.m5.1c">1024</annotation></semantics></math>, and tied input and output embeddings <cite class="ltx_cite ltx_citemacro_citep">(Press &amp; Wolf, <a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.4" class="ltx_p"><span id="S4.I1.i2.p1.4.1" class="ltx_text">SI-CIFG</span> <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="19" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mn id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><cn type="integer" id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">19</annotation></semantics></math>M: Modified CIFG <math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="19" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><mn id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><cn type="integer" id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">19</annotation></semantics></math>M using <math id="S4.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="\text{SI-}\sigma" display="inline"><semantics id="S4.I1.i2.p1.3.m3.1a"><mrow id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mtext id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.3.m3.1.1.1" xref="S4.I1.i2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><times id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1"></times><ci id="S4.I1.i2.p1.3.m3.1.1.2a.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2"><mtext id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">SI-</mtext></ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">\text{SI-}\sigma</annotation></semantics></math> and <math id="S4.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="\text{SI-}\tanh" display="inline"><semantics id="S4.I1.i2.p1.4.m4.1a"><mrow id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml"><mtext id="S4.I1.i2.p1.4.m4.1.1.2" xref="S4.I1.i2.p1.4.m4.1.1.2a.cmml">SI-</mtext><mo lspace="0.167em" rspace="0em" id="S4.I1.i2.p1.4.m4.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S4.I1.i2.p1.4.m4.1.1.3" xref="S4.I1.i2.p1.4.m4.1.1.3.cmml">tanh</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.1b"><apply id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1"><times id="S4.I1.i2.p1.4.m4.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1"></times><ci id="S4.I1.i2.p1.4.m4.1.1.2a.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2"><mtext id="S4.I1.i2.p1.4.m4.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2">SI-</mtext></ci><tanh id="S4.I1.i2.p1.4.m4.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.3"></tanh></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.1c">\text{SI-}\tanh</annotation></semantics></math> activations.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.6" class="ltx_p">Transformer <math id="S4.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="21" display="inline"><semantics id="S4.I1.i3.p1.1.m1.1a"><mn id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><cn type="integer" id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">21</annotation></semantics></math>M: Transformer with <math id="S4.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="21" display="inline"><semantics id="S4.I1.i3.p1.2.m2.1a"><mn id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><cn type="integer" id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">21</annotation></semantics></math>M trainable parameters with <math id="S4.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S4.I1.i3.p1.3.m3.1a"><mn id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><cn type="integer" id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">6</annotation></semantics></math> layers, <math id="S4.I1.i3.p1.4.m4.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.I1.i3.p1.4.m4.1a"><mn id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><cn type="integer" id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">8</annotation></semantics></math> attention heads, MLP size <math id="S4.I1.i3.p1.5.m5.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S4.I1.i3.p1.5.m5.1a"><mn id="S4.I1.i3.p1.5.m5.1.1" xref="S4.I1.i3.p1.5.m5.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.5.m5.1b"><cn type="integer" id="S4.I1.i3.p1.5.m5.1.1.cmml" xref="S4.I1.i3.p1.5.m5.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.5.m5.1c">2048</annotation></semantics></math>, embedding size <math id="S4.I1.i3.p1.6.m6.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.I1.i3.p1.6.m6.1a"><mn id="S4.I1.i3.p1.6.m6.1.1" xref="S4.I1.i3.p1.6.m6.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.6.m6.1b"><cn type="integer" id="S4.I1.i3.p1.6.m6.1.1.cmml" xref="S4.I1.i3.p1.6.m6.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.6.m6.1c">512</annotation></semantics></math>, and tied input and output embeddings.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.2" class="ltx_p">SI Transformer <math id="S4.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="21" display="inline"><semantics id="S4.I1.i4.p1.1.m1.1a"><mn id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><cn type="integer" id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">21</annotation></semantics></math>M: Modified Transformer <math id="S4.I1.i4.p1.2.m2.1" class="ltx_Math" alttext="21" display="inline"><semantics id="S4.I1.i4.p1.2.m2.1a"><mn id="S4.I1.i4.p1.2.m2.1.1" xref="S4.I1.i4.p1.2.m2.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.2.m2.1b"><cn type="integer" id="S4.I1.i4.p1.2.m2.1.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.2.m2.1c">21</annotation></semantics></math>M using <span id="S4.I1.i4.p1.2.1" class="ltx_text">SI-Attn</span>.</p>
</div>
</li>
</ul>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.5" class="ltx_p">We use WordPiece <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib44" title="" class="ltx_ref">2016</a>)</cite> for subword tokenization with a vocabulary size of <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="4K" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><times id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">4</cn><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">4K</annotation></semantics></math> to avoid potential bottlenecks in embeddings for larger vocabularies.
For FL training, we use FedAdam <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib34" title="" class="ltx_ref">2021</a>)</cite> which uses Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib22" title="" class="ltx_ref">2014</a>)</cite> for the server optimizer and SGD for the client optimizer with the same settings used by <cite class="ltx_cite ltx_citemacro_citet">Reddi et al. (<a href="#bib.bib34" title="" class="ltx_ref">2021</a>)</cite>, with the exception of learning rates.
We then sweep over learning rates for each model with <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><cn type="integer" id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">5</annotation></semantics></math> different random seeds for client sampling with <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mn id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><cn type="integer" id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">500</annotation></semantics></math> clients per round for <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p3.4.m4.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><times id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1"></times><cn type="integer" id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">3</cn><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">3K</annotation></semantics></math> communication rounds and maximum sequence length of <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mn id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><cn type="integer" id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">20</annotation></semantics></math>.
Details on speicifc hyperparameter settings and sweeps can be seen in Appendix <a href="#A1" title="Appendix A Federated experiments on public datasets details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<figure id="S4.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F1.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.08100/assets/x1.png" id="S4.F1.1.g1" class="ltx_graphics ltx_img_landscape" width="207" height="140" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F1.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.08100/assets/x2.png" id="S4.F1.2.g1" class="ltx_graphics ltx_img_landscape" width="207" height="135" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Perplexity and accuracy on the Stack Overflow test dataset with shading indicating standard deviation over <math id="S4.F1.4.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.F1.4.m1.1b"><mn id="S4.F1.4.m1.1.1" xref="S4.F1.4.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.F1.4.m1.1c"><cn type="integer" id="S4.F1.4.m1.1.1.cmml" xref="S4.F1.4.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.4.m1.1d">5</annotation></semantics></math> random seeds.</figcaption>
</figure>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.2" class="ltx_p">We report perplexity and accuracy, discounting end-of-sequence
tokens, on the Stack Overflow test dataset over <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mn id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><times id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">3</cn><ci id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">3K</annotation></semantics></math> communication rounds in Figure <a href="#S4.F1" title="Figure 1 ‣ 4.1 Federated experiments on public datasets ‣ 4 Experiments with Federated learning ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> with final values in Table <a href="#A1.T2" title="Table 2 ‣ Appendix A Federated experiments on public datasets details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (Appendix <a href="#A1" title="Appendix A Federated experiments on public datasets details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>).
We observe that applying Scale Invariance significantly increases the rate of convergence for both the Transformer and CIFG, surpassing their respective base counterparts within <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mn id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><cn type="integer" id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">100</annotation></semantics></math> communication rounds.
Our proposed <span id="S4.SS1.p4.2.1" class="ltx_text">SI-CIFG</span> yields the best final quality and has the fastest convergence speed by far.
We next continue to live production experiments, where the network of clients is much larger and more heterogeneous than simulation.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Live production experiments</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">For live production experiments for cross-device FL on English virtual keyboard client devices, similar to <cite class="ltx_cite ltx_citemacro_citet">Hard et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018b</a>)</cite>,
we compare the following models:</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p id="S4.I2.i1.p1.5" class="ltx_p">CIFG <math id="S4.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="9" display="inline"><semantics id="S4.I2.i1.p1.1.m1.1a"><mn id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.1.m1.1b"><cn type="integer" id="S4.I2.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.1.m1.1c">9</annotation></semantics></math>M: CIFG with <math id="S4.I2.i1.p1.2.m2.1" class="ltx_Math" alttext="9" display="inline"><semantics id="S4.I2.i1.p1.2.m2.1a"><mn id="S4.I2.i1.p1.2.m2.1.1" xref="S4.I2.i1.p1.2.m2.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.2.m2.1b"><cn type="integer" id="S4.I2.i1.p1.2.m2.1.1.cmml" xref="S4.I2.i1.p1.2.m2.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.2.m2.1c">9</annotation></semantics></math>M trainable parameters with <math id="S4.I2.i1.p1.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.I2.i1.p1.3.m3.1a"><mn id="S4.I2.i1.p1.3.m3.1.1" xref="S4.I2.i1.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.3.m3.1b"><cn type="integer" id="S4.I2.i1.p1.3.m3.1.1.cmml" xref="S4.I2.i1.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.3.m3.1c">1</annotation></semantics></math> layer of size <math id="S4.I2.i1.p1.4.m4.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S4.I2.i1.p1.4.m4.1a"><mn id="S4.I2.i1.p1.4.m4.1.1" xref="S4.I2.i1.p1.4.m4.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.4.m4.1b"><cn type="integer" id="S4.I2.i1.p1.4.m4.1.1.cmml" xref="S4.I2.i1.p1.4.m4.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.4.m4.1c">2048</annotation></semantics></math>, embedding size <math id="S4.I2.i1.p1.5.m5.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.I2.i1.p1.5.m5.1a"><mn id="S4.I2.i1.p1.5.m5.1.1" xref="S4.I2.i1.p1.5.m5.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.5.m5.1b"><cn type="integer" id="S4.I2.i1.p1.5.m5.1.1.cmml" xref="S4.I2.i1.p1.5.m5.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.5.m5.1c">512</annotation></semantics></math>, and tied input and output embeddings.</p>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p id="S4.I2.i2.p1.4" class="ltx_p"><span id="S4.I2.i2.p1.4.1" class="ltx_text">SI-CIFG</span> <math id="S4.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="9" display="inline"><semantics id="S4.I2.i2.p1.1.m1.1a"><mn id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.1.m1.1b"><cn type="integer" id="S4.I2.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.1.m1.1c">9</annotation></semantics></math>M: Modified CIFG <math id="S4.I2.i2.p1.2.m2.1" class="ltx_Math" alttext="9" display="inline"><semantics id="S4.I2.i2.p1.2.m2.1a"><mn id="S4.I2.i2.p1.2.m2.1.1" xref="S4.I2.i2.p1.2.m2.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.2.m2.1b"><cn type="integer" id="S4.I2.i2.p1.2.m2.1.1.cmml" xref="S4.I2.i2.p1.2.m2.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.2.m2.1c">9</annotation></semantics></math>M using <math id="S4.I2.i2.p1.3.m3.1" class="ltx_Math" alttext="\text{SI-}\sigma" display="inline"><semantics id="S4.I2.i2.p1.3.m3.1a"><mrow id="S4.I2.i2.p1.3.m3.1.1" xref="S4.I2.i2.p1.3.m3.1.1.cmml"><mtext id="S4.I2.i2.p1.3.m3.1.1.2" xref="S4.I2.i2.p1.3.m3.1.1.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S4.I2.i2.p1.3.m3.1.1.1" xref="S4.I2.i2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S4.I2.i2.p1.3.m3.1.1.3" xref="S4.I2.i2.p1.3.m3.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.3.m3.1b"><apply id="S4.I2.i2.p1.3.m3.1.1.cmml" xref="S4.I2.i2.p1.3.m3.1.1"><times id="S4.I2.i2.p1.3.m3.1.1.1.cmml" xref="S4.I2.i2.p1.3.m3.1.1.1"></times><ci id="S4.I2.i2.p1.3.m3.1.1.2a.cmml" xref="S4.I2.i2.p1.3.m3.1.1.2"><mtext id="S4.I2.i2.p1.3.m3.1.1.2.cmml" xref="S4.I2.i2.p1.3.m3.1.1.2">SI-</mtext></ci><ci id="S4.I2.i2.p1.3.m3.1.1.3.cmml" xref="S4.I2.i2.p1.3.m3.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.3.m3.1c">\text{SI-}\sigma</annotation></semantics></math> and <math id="S4.I2.i2.p1.4.m4.1" class="ltx_Math" alttext="\text{SI-}\tanh" display="inline"><semantics id="S4.I2.i2.p1.4.m4.1a"><mrow id="S4.I2.i2.p1.4.m4.1.1" xref="S4.I2.i2.p1.4.m4.1.1.cmml"><mtext id="S4.I2.i2.p1.4.m4.1.1.2" xref="S4.I2.i2.p1.4.m4.1.1.2a.cmml">SI-</mtext><mo lspace="0.167em" rspace="0em" id="S4.I2.i2.p1.4.m4.1.1.1" xref="S4.I2.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S4.I2.i2.p1.4.m4.1.1.3" xref="S4.I2.i2.p1.4.m4.1.1.3.cmml">tanh</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.4.m4.1b"><apply id="S4.I2.i2.p1.4.m4.1.1.cmml" xref="S4.I2.i2.p1.4.m4.1.1"><times id="S4.I2.i2.p1.4.m4.1.1.1.cmml" xref="S4.I2.i2.p1.4.m4.1.1.1"></times><ci id="S4.I2.i2.p1.4.m4.1.1.2a.cmml" xref="S4.I2.i2.p1.4.m4.1.1.2"><mtext id="S4.I2.i2.p1.4.m4.1.1.2.cmml" xref="S4.I2.i2.p1.4.m4.1.1.2">SI-</mtext></ci><tanh id="S4.I2.i2.p1.4.m4.1.1.3.cmml" xref="S4.I2.i2.p1.4.m4.1.1.3"></tanh></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.4.m4.1c">\text{SI-}\tanh</annotation></semantics></math> activations.</p>
</div>
</li>
<li id="S4.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i3.p1" class="ltx_para">
<p id="S4.I2.i3.p1.6" class="ltx_p">Transformer <math id="S4.I2.i3.p1.1.m1.1" class="ltx_Math" alttext="11" display="inline"><semantics id="S4.I2.i3.p1.1.m1.1a"><mn id="S4.I2.i3.p1.1.m1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.1.m1.1b"><cn type="integer" id="S4.I2.i3.p1.1.m1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.1.m1.1c">11</annotation></semantics></math>M: Transformer with <math id="S4.I2.i3.p1.2.m2.1" class="ltx_Math" alttext="11" display="inline"><semantics id="S4.I2.i3.p1.2.m2.1a"><mn id="S4.I2.i3.p1.2.m2.1.1" xref="S4.I2.i3.p1.2.m2.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.2.m2.1b"><cn type="integer" id="S4.I2.i3.p1.2.m2.1.1.cmml" xref="S4.I2.i3.p1.2.m2.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.2.m2.1c">11</annotation></semantics></math>M trainable parameters with <math id="S4.I2.i3.p1.3.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S4.I2.i3.p1.3.m3.1a"><mn id="S4.I2.i3.p1.3.m3.1.1" xref="S4.I2.i3.p1.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.3.m3.1b"><cn type="integer" id="S4.I2.i3.p1.3.m3.1.1.cmml" xref="S4.I2.i3.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.3.m3.1c">3</annotation></semantics></math> layers, <math id="S4.I2.i3.p1.4.m4.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.I2.i3.p1.4.m4.1a"><mn id="S4.I2.i3.p1.4.m4.1.1" xref="S4.I2.i3.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.4.m4.1b"><cn type="integer" id="S4.I2.i3.p1.4.m4.1.1.cmml" xref="S4.I2.i3.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.4.m4.1c">8</annotation></semantics></math> attention heads, MLP size <math id="S4.I2.i3.p1.5.m5.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S4.I2.i3.p1.5.m5.1a"><mn id="S4.I2.i3.p1.5.m5.1.1" xref="S4.I2.i3.p1.5.m5.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.5.m5.1b"><cn type="integer" id="S4.I2.i3.p1.5.m5.1.1.cmml" xref="S4.I2.i3.p1.5.m5.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.5.m5.1c">2048</annotation></semantics></math>, embedding size <math id="S4.I2.i3.p1.6.m6.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.I2.i3.p1.6.m6.1a"><mn id="S4.I2.i3.p1.6.m6.1.1" xref="S4.I2.i3.p1.6.m6.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.6.m6.1b"><cn type="integer" id="S4.I2.i3.p1.6.m6.1.1.cmml" xref="S4.I2.i3.p1.6.m6.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.6.m6.1c">512</annotation></semantics></math>, and tied input and output embeddings.</p>
</div>
</li>
<li id="S4.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i4.p1" class="ltx_para">
<p id="S4.I2.i4.p1.2" class="ltx_p">SI Transformer <math id="S4.I2.i4.p1.1.m1.1" class="ltx_Math" alttext="11" display="inline"><semantics id="S4.I2.i4.p1.1.m1.1a"><mn id="S4.I2.i4.p1.1.m1.1.1" xref="S4.I2.i4.p1.1.m1.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.1.m1.1b"><cn type="integer" id="S4.I2.i4.p1.1.m1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.1.m1.1c">11</annotation></semantics></math>M: Modified Transformer <math id="S4.I2.i4.p1.2.m2.1" class="ltx_Math" alttext="11" display="inline"><semantics id="S4.I2.i4.p1.2.m2.1a"><mn id="S4.I2.i4.p1.2.m2.1.1" xref="S4.I2.i4.p1.2.m2.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.2.m2.1b"><cn type="integer" id="S4.I2.i4.p1.2.m2.1.1.cmml" xref="S4.I2.i4.p1.2.m2.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.2.m2.1c">11</annotation></semantics></math>M using <span id="S4.I2.i4.p1.2.1" class="ltx_text">SI-Attn</span>.</p>
</div>
</li>
</ul>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.5" class="ltx_p">We use smaller sizes here compared to our previous simulation experiments due to stricter resource constraints on client devices <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib14" title="" class="ltx_ref">2018b</a>; Ro et al., <a href="#bib.bib35" title="" class="ltx_ref">2021a</a>)</cite>.
Additionally, we also apply stochastic <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><cn type="integer" id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">8</annotation></semantics></math>-bit uniform quantization <cite class="ltx_cite ltx_citemacro_citep">(Alistarh et al., <a href="#bib.bib2" title="" class="ltx_ref">2017</a>; Suresh et al., <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite> on the upload of model updates from client to server due to tighter communication bottlenecks on mobile devices.
We use Fast WordPiece <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> for subword tokenization with a vocabulary size of <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="4K" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mn id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><times id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">4</cn><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">4K</annotation></semantics></math> as it has been shown to be faster than WordPiece, allowing for more steps of training within the maximum time limit allocated for client devices.
Again, we use the FedAdam algorithm with <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mn id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><cn type="integer" id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">500</annotation></semantics></math> clients per round for <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mn id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">​</mo><mi id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><times id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></times><cn type="integer" id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">3</cn><ci id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">3K</annotation></semantics></math> communication rounds with maximum sequence length of <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><mn id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><cn type="integer" id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">20</annotation></semantics></math>.
For more details on hyperparameters, refer to Appendix <a href="#A2" title="Appendix B Live production experiment details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.08100/assets/x3.png" id="S4.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="207" height="140" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.08100/assets/x4.png" id="S4.F2.2.g1" class="ltx_graphics ltx_img_landscape" width="207" height="132" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Perplexity and accuracy from live experiments on English virtual keyboard devices training from randomly initialized model weights.</figcaption>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.6" class="ltx_p">We report perplexity and accuracy for training the models from randomly initialized parameters on the population of English virtual keyboard client devices over <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mn id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p4.1.m1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><times id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1"></times><cn type="integer" id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">3</cn><ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">3K</annotation></semantics></math> communication rounds in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.2 Live production experiments ‣ 4 Experiments with Federated learning ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> with final values in Table <a href="#A2.T3" title="Table 3 ‣ Appendix B Live production experiment details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (Appendix <a href="#A2" title="Appendix B Live production experiment details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>).
The scale invariant architectures surpass their base counterparts within <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mn id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><cn type="integer" id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">100</annotation></semantics></math> communication rounds and converge to significantly higher qualities.
While the base CIFG diverges in training at <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="2K" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mn id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml">​</mo><mi id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><times id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1"></times><cn type="integer" id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">2</cn><ci id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">2K</annotation></semantics></math> rounds, which could be attributed to a number of potential issues <cite class="ltx_cite ltx_citemacro_citep">(Pascanu et al., <a href="#bib.bib29" title="" class="ltx_ref">2013</a>)</cite> when training recurrent models with SGD on client devices, our proposed <span id="S4.SS2.p4.6.1" class="ltx_text">SI-CIFG</span> trains smoothly, significantly outperforms the other models within <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mn id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><cn type="integer" id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">200</annotation></semantics></math> rounds, and converges to the best final quality.
This improved training stability could be due to robustness to out-sized client updates in the <math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="\text{SI-}\sigma" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mtext id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.p4.5.m5.1.1.1" xref="S4.SS2.p4.5.m5.1.1.1.cmml">​</mo><mi id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><times id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1.1"></times><ci id="S4.SS2.p4.5.m5.1.1.2a.cmml" xref="S4.SS2.p4.5.m5.1.1.2"><mtext id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">SI-</mtext></ci><ci id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">\text{SI-}\sigma</annotation></semantics></math> and <math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="\text{SI-}\tanh" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mrow id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml"><mtext id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2a.cmml">SI-</mtext><mo lspace="0.167em" rspace="0em" id="S4.SS2.p4.6.m6.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.cmml">​</mo><mi id="S4.SS2.p4.6.m6.1.1.3" xref="S4.SS2.p4.6.m6.1.1.3.cmml">tanh</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1"><times id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1"></times><ci id="S4.SS2.p4.6.m6.1.1.2a.cmml" xref="S4.SS2.p4.6.m6.1.1.2"><mtext id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2">SI-</mtext></ci><tanh id="S4.SS2.p4.6.m6.1.1.3.cmml" xref="S4.SS2.p4.6.m6.1.1.3"></tanh></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">\text{SI-}\tanh</annotation></semantics></math> activations.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments with differentially private federated learning</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we apply our proposed scale invariant architectures to differentially private (DP) FL.
Specifically, we apply the DP variant of Follow-The-Regularized-Leader (DP-FTRL) <em id="S5.p1.1.1" class="ltx_emph ltx_font_italic">Online TreeAgg</em> proposed by <cite class="ltx_cite ltx_citemacro_citet">Kairouz et al. (<a href="#bib.bib19" title="" class="ltx_ref">2021a</a>)</cite>.
For live production experiments, we train an English language model on millions of virtual keyboard user devices and mostly follow the same setup as <cite class="ltx_cite ltx_citemacro_citet">Xu et al. (<a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite> for DP FL and compare the following models:</p>
</div>
<div id="S5.p2" class="ltx_para">
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.6" class="ltx_p">CIFG <math id="S5.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S5.I1.i1.p1.1.m1.1a"><mn id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.1.m1.1b"><cn type="integer" id="S5.I1.i1.p1.1.m1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.1c">6</annotation></semantics></math>M: CIFG with <math id="S5.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S5.I1.i1.p1.2.m2.1a"><mn id="S5.I1.i1.p1.2.m2.1.1" xref="S5.I1.i1.p1.2.m2.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.2.m2.1b"><cn type="integer" id="S5.I1.i1.p1.2.m2.1.1.cmml" xref="S5.I1.i1.p1.2.m2.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.2.m2.1c">6</annotation></semantics></math>M trainable parameters with <math id="S5.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S5.I1.i1.p1.3.m3.1a"><mn id="S5.I1.i1.p1.3.m3.1.1" xref="S5.I1.i1.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.3.m3.1b"><cn type="integer" id="S5.I1.i1.p1.3.m3.1.1.cmml" xref="S5.I1.i1.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.3.m3.1c">1</annotation></semantics></math> layer of size <math id="S5.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="670" display="inline"><semantics id="S5.I1.i1.p1.4.m4.1a"><mn id="S5.I1.i1.p1.4.m4.1.1" xref="S5.I1.i1.p1.4.m4.1.1.cmml">670</mn><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.4.m4.1b"><cn type="integer" id="S5.I1.i1.p1.4.m4.1.1.cmml" xref="S5.I1.i1.p1.4.m4.1.1">670</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.4.m4.1c">670</annotation></semantics></math>, embedding size <math id="S5.I1.i1.p1.5.m5.1" class="ltx_Math" alttext="96" display="inline"><semantics id="S5.I1.i1.p1.5.m5.1a"><mn id="S5.I1.i1.p1.5.m5.1.1" xref="S5.I1.i1.p1.5.m5.1.1.cmml">96</mn><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.5.m5.1b"><cn type="integer" id="S5.I1.i1.p1.5.m5.1.1.cmml" xref="S5.I1.i1.p1.5.m5.1.1">96</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.5.m5.1c">96</annotation></semantics></math>, and vocabulary size of  <math id="S5.I1.i1.p1.6.m6.1" class="ltx_Math" alttext="30K" display="inline"><semantics id="S5.I1.i1.p1.6.m6.1a"><mrow id="S5.I1.i1.p1.6.m6.1.1" xref="S5.I1.i1.p1.6.m6.1.1.cmml"><mn id="S5.I1.i1.p1.6.m6.1.1.2" xref="S5.I1.i1.p1.6.m6.1.1.2.cmml">30</mn><mo lspace="0em" rspace="0em" id="S5.I1.i1.p1.6.m6.1.1.1" xref="S5.I1.i1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S5.I1.i1.p1.6.m6.1.1.3" xref="S5.I1.i1.p1.6.m6.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.6.m6.1b"><apply id="S5.I1.i1.p1.6.m6.1.1.cmml" xref="S5.I1.i1.p1.6.m6.1.1"><times id="S5.I1.i1.p1.6.m6.1.1.1.cmml" xref="S5.I1.i1.p1.6.m6.1.1.1"></times><cn type="integer" id="S5.I1.i1.p1.6.m6.1.1.2.cmml" xref="S5.I1.i1.p1.6.m6.1.1.2">30</cn><ci id="S5.I1.i1.p1.6.m6.1.1.3.cmml" xref="S5.I1.i1.p1.6.m6.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.6.m6.1c">30K</annotation></semantics></math>.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.4" class="ltx_p"><span id="S5.I1.i2.p1.4.1" class="ltx_text">SI-CIFG</span> <math id="S5.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S5.I1.i2.p1.1.m1.1a"><mn id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.1.m1.1b"><cn type="integer" id="S5.I1.i2.p1.1.m1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.1.m1.1c">6</annotation></semantics></math>M: Modified CIFG <math id="S5.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S5.I1.i2.p1.2.m2.1a"><mn id="S5.I1.i2.p1.2.m2.1.1" xref="S5.I1.i2.p1.2.m2.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.2.m2.1b"><cn type="integer" id="S5.I1.i2.p1.2.m2.1.1.cmml" xref="S5.I1.i2.p1.2.m2.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.2.m2.1c">6</annotation></semantics></math>M using <math id="S5.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="\text{SI-}\sigma" display="inline"><semantics id="S5.I1.i2.p1.3.m3.1a"><mrow id="S5.I1.i2.p1.3.m3.1.1" xref="S5.I1.i2.p1.3.m3.1.1.cmml"><mtext id="S5.I1.i2.p1.3.m3.1.1.2" xref="S5.I1.i2.p1.3.m3.1.1.2a.cmml">SI-</mtext><mo lspace="0em" rspace="0em" id="S5.I1.i2.p1.3.m3.1.1.1" xref="S5.I1.i2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S5.I1.i2.p1.3.m3.1.1.3" xref="S5.I1.i2.p1.3.m3.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.3.m3.1b"><apply id="S5.I1.i2.p1.3.m3.1.1.cmml" xref="S5.I1.i2.p1.3.m3.1.1"><times id="S5.I1.i2.p1.3.m3.1.1.1.cmml" xref="S5.I1.i2.p1.3.m3.1.1.1"></times><ci id="S5.I1.i2.p1.3.m3.1.1.2a.cmml" xref="S5.I1.i2.p1.3.m3.1.1.2"><mtext id="S5.I1.i2.p1.3.m3.1.1.2.cmml" xref="S5.I1.i2.p1.3.m3.1.1.2">SI-</mtext></ci><ci id="S5.I1.i2.p1.3.m3.1.1.3.cmml" xref="S5.I1.i2.p1.3.m3.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.3.m3.1c">\text{SI-}\sigma</annotation></semantics></math> and <math id="S5.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="\text{SI-}\tanh" display="inline"><semantics id="S5.I1.i2.p1.4.m4.1a"><mrow id="S5.I1.i2.p1.4.m4.1.1" xref="S5.I1.i2.p1.4.m4.1.1.cmml"><mtext id="S5.I1.i2.p1.4.m4.1.1.2" xref="S5.I1.i2.p1.4.m4.1.1.2a.cmml">SI-</mtext><mo lspace="0.167em" rspace="0em" id="S5.I1.i2.p1.4.m4.1.1.1" xref="S5.I1.i2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S5.I1.i2.p1.4.m4.1.1.3" xref="S5.I1.i2.p1.4.m4.1.1.3.cmml">tanh</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.4.m4.1b"><apply id="S5.I1.i2.p1.4.m4.1.1.cmml" xref="S5.I1.i2.p1.4.m4.1.1"><times id="S5.I1.i2.p1.4.m4.1.1.1.cmml" xref="S5.I1.i2.p1.4.m4.1.1.1"></times><ci id="S5.I1.i2.p1.4.m4.1.1.2a.cmml" xref="S5.I1.i2.p1.4.m4.1.1.2"><mtext id="S5.I1.i2.p1.4.m4.1.1.2.cmml" xref="S5.I1.i2.p1.4.m4.1.1.2">SI-</mtext></ci><tanh id="S5.I1.i2.p1.4.m4.1.1.3.cmml" xref="S5.I1.i2.p1.4.m4.1.1.3"></tanh></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.4.m4.1c">\text{SI-}\tanh</annotation></semantics></math> activations.</p>
</div>
</li>
</ul>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.11" class="ltx_p">For training, we use <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="6500" display="inline"><semantics id="S5.p3.1.m1.1a"><mn id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml">6500</mn><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><cn type="integer" id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1">6500</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">6500</annotation></semantics></math> clients per round and the same noise multiplier of <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="7.0" display="inline"><semantics id="S5.p3.2.m2.1a"><mn id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml">7.0</mn><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><cn type="float" id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1">7.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">7.0</annotation></semantics></math> for <math id="S5.p3.3.m3.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="S5.p3.3.m3.1a"><mrow id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><mn id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S5.p3.3.m3.1.1.1" xref="S5.p3.3.m3.1.1.1.cmml">​</mo><mi id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><times id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1"></times><cn type="integer" id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">3</cn><ci id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">3K</annotation></semantics></math> communication rounds with maximum sequence length of <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.p3.4.m4.1a"><mn id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><cn type="integer" id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">10</annotation></semantics></math> with word tokenization using a vocabulary size of  <math id="S5.p3.5.m5.1" class="ltx_Math" alttext="30K" display="inline"><semantics id="S5.p3.5.m5.1a"><mrow id="S5.p3.5.m5.1.1" xref="S5.p3.5.m5.1.1.cmml"><mn id="S5.p3.5.m5.1.1.2" xref="S5.p3.5.m5.1.1.2.cmml">30</mn><mo lspace="0em" rspace="0em" id="S5.p3.5.m5.1.1.1" xref="S5.p3.5.m5.1.1.1.cmml">​</mo><mi id="S5.p3.5.m5.1.1.3" xref="S5.p3.5.m5.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.5.m5.1b"><apply id="S5.p3.5.m5.1.1.cmml" xref="S5.p3.5.m5.1.1"><times id="S5.p3.5.m5.1.1.1.cmml" xref="S5.p3.5.m5.1.1.1"></times><cn type="integer" id="S5.p3.5.m5.1.1.2.cmml" xref="S5.p3.5.m5.1.1.2">30</cn><ci id="S5.p3.5.m5.1.1.3.cmml" xref="S5.p3.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.5.m5.1c">30K</annotation></semantics></math>.
The client optimizer is SGD with learning rate of <math id="S5.p3.6.m6.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S5.p3.6.m6.1a"><mn id="S5.p3.6.m6.1.1" xref="S5.p3.6.m6.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S5.p3.6.m6.1b"><cn type="float" id="S5.p3.6.m6.1.1.cmml" xref="S5.p3.6.m6.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.6.m6.1c">0.5</annotation></semantics></math> and the server optimizer is SGD with momentum with learning rate <math id="S5.p3.7.m7.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S5.p3.7.m7.1a"><mn id="S5.p3.7.m7.1.1" xref="S5.p3.7.m7.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S5.p3.7.m7.1b"><cn type="float" id="S5.p3.7.m7.1.1.cmml" xref="S5.p3.7.m7.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.7.m7.1c">1.0</annotation></semantics></math> and momentum <math id="S5.p3.8.m8.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S5.p3.8.m8.1a"><mn id="S5.p3.8.m8.1.1" xref="S5.p3.8.m8.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S5.p3.8.m8.1b"><cn type="float" id="S5.p3.8.m8.1.1.cmml" xref="S5.p3.8.m8.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.8.m8.1c">0.9</annotation></semantics></math>.
We set the noise multiplier in the DP-FTRL algorithm to obtain a z-CDP privacy of <math id="S5.p3.9.m9.1" class="ltx_Math" alttext="1.05" display="inline"><semantics id="S5.p3.9.m9.1a"><mn id="S5.p3.9.m9.1.1" xref="S5.p3.9.m9.1.1.cmml">1.05</mn><annotation-xml encoding="MathML-Content" id="S5.p3.9.m9.1b"><cn type="float" id="S5.p3.9.m9.1.1.cmml" xref="S5.p3.9.m9.1.1">1.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.9.m9.1c">1.05</annotation></semantics></math>.
We refer readers to <cite class="ltx_cite ltx_citemacro_citet">Bun &amp; Steinke (<a href="#bib.bib4" title="" class="ltx_ref">2016</a>)</cite> for the definition of z-CDP and <cite class="ltx_cite ltx_citemacro_citet">Kairouz et al. (<a href="#bib.bib19" title="" class="ltx_ref">2021a</a>)</cite> for the privacy guarantee calculations.
For more details and hyperparameter configurations, refer to Appendix <a href="#A3" title="Appendix C Experiments with differentially private federated learning details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.
Before applying DP FL training, we first pre-train the models on the public English Colossal Clean Crawled Corpus (C4) <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>)</cite> dataset for <math id="S5.p3.10.m10.1" class="ltx_Math" alttext="370K" display="inline"><semantics id="S5.p3.10.m10.1a"><mrow id="S5.p3.10.m10.1.1" xref="S5.p3.10.m10.1.1.cmml"><mn id="S5.p3.10.m10.1.1.2" xref="S5.p3.10.m10.1.1.2.cmml">370</mn><mo lspace="0em" rspace="0em" id="S5.p3.10.m10.1.1.1" xref="S5.p3.10.m10.1.1.1.cmml">​</mo><mi id="S5.p3.10.m10.1.1.3" xref="S5.p3.10.m10.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.10.m10.1b"><apply id="S5.p3.10.m10.1.1.cmml" xref="S5.p3.10.m10.1.1"><times id="S5.p3.10.m10.1.1.1.cmml" xref="S5.p3.10.m10.1.1.1"></times><cn type="integer" id="S5.p3.10.m10.1.1.2.cmml" xref="S5.p3.10.m10.1.1.2">370</cn><ci id="S5.p3.10.m10.1.1.3.cmml" xref="S5.p3.10.m10.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.10.m10.1c">370K</annotation></semantics></math> steps and start DP FL training from the pre-trained checkpoint.
We report perplexity and in-vocab-accuracy, discounting out-of-vocabulary and end-of-sequence tokens, for DP FL training on the population of English virtual keyboard client devices over <math id="S5.p3.11.m11.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="S5.p3.11.m11.1a"><mrow id="S5.p3.11.m11.1.1" xref="S5.p3.11.m11.1.1.cmml"><mn id="S5.p3.11.m11.1.1.2" xref="S5.p3.11.m11.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S5.p3.11.m11.1.1.1" xref="S5.p3.11.m11.1.1.1.cmml">​</mo><mi id="S5.p3.11.m11.1.1.3" xref="S5.p3.11.m11.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.11.m11.1b"><apply id="S5.p3.11.m11.1.1.cmml" xref="S5.p3.11.m11.1.1"><times id="S5.p3.11.m11.1.1.1.cmml" xref="S5.p3.11.m11.1.1.1"></times><cn type="integer" id="S5.p3.11.m11.1.1.2.cmml" xref="S5.p3.11.m11.1.1.2">3</cn><ci id="S5.p3.11.m11.1.1.3.cmml" xref="S5.p3.11.m11.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.11.m11.1c">3K</annotation></semantics></math> communication rounds in Figure <a href="#S5.F3" title="Figure 3 ‣ 5 Experiments with differentially private federated learning ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> with final values in Table <a href="#A3.T4" title="Table 4 ‣ Appendix C Experiments with differentially private federated learning details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (Appendix <a href="#A3" title="Appendix C Experiments with differentially private federated learning details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>).</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.08100/assets/x5.png" id="S5.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="207" height="132" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F3.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.08100/assets/x6.png" id="S5.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="207" height="129" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Smoothed perplexity and in-vocab-accuracy from DP live experiments on English virtual keyboard devices.</figcaption>
</figure>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p">In the DP FL setting, our proposed <span id="S5.p4.1.1" class="ltx_text">SI-CIFG</span> consistently outperforms the base CIFG and under the same privacy budget, achieves better utility, measured by perplexity and accuracy.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We applied scale invariance to a variety of neural architectures and proposed a novel CIFG-LSTM architecture (<span id="S6.p1.1.1" class="ltx_text">SI-CIFG</span>) and evaluated their performance on a variety of cross-device and differentially private large scale FL experiments.
We demonstrated that using scale invariant architectures in federated language modeling can significantly accelerate and improve model convergence, with our proposed <span id="S6.p1.1.2" class="ltx_text">SI-CIFG</span> consistently achieving the best performance and convergence speed.
We hope that this study will motivate further studies into training larger models privately and effectively with federated learning.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar et al. (2021)</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas Navarro, Matthew Mattina, Paul N Whatmough, and Venkatesh Saligrama.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2111.04263</em>, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alistarh et al. (2017)</span>
<span class="ltx_bibblock">
Dan Alistarh, Demjan Grubic, Jerry Li, Ryota Tomioka, and Milan Vojnovic.

</span>
<span class="ltx_bibblock">Qsgd: Communication-efficient sgd via gradient quantization and encoding.

</span>
<span class="ltx_bibblock">In I. Guyon, U. Von Luxburg, S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett (eds.), <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 30. Curran Associates, Inc., 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/6c340f25839e6acdc73414517203f5f0-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2017/file/6c340f25839e6acdc73414517203f5f0-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2022)</span>
<span class="ltx_bibblock">
Kallista Bonawitz, Peter Kairouz, Brendan Mcmahan, and Daniel Ramage.

</span>
<span class="ltx_bibblock">Federated learning and privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Communications of the ACM</em>, 65(4):90–97, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bun &amp; Steinke (2016)</span>
<span class="ltx_bibblock">
Mark Bun and Thomas Steinke.

</span>
<span class="ltx_bibblock">Concentrated differential privacy: Simplifications, extensions, and lower bounds.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Theory of Cryptography Conference</em>, pp.  635–658. Springer, 2016.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Mingqing Chen, Ananda Theertha Suresh, Rajiv Mathews, Adeline Wong, Cyril Allauzen, Françoise Beaufays, and Michael Riley.

</span>
<span class="ltx_bibblock">Federated learning of n-gram language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 23rd Conference on Computational Natural Language Learning (CoNLL)</em>, pp.  121–130, Hong Kong, China, November 2019. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/K19-1012</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/K19-1012" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/K19-1012</a>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al. (2014)</span>
<span class="ltx_bibblock">
Kyunghyun Cho, Bart van Merriënboer, Caglar Gulcehre, Dzmitry Bahdanau, Fethi Bougares, Holger Schwenk, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Learning phrase representations using RNN encoder–decoder for statistical machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>, pp.  1724–1734, Doha, Qatar, October 2014. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.3115/v1/D14-1179</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/D14-1179" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/D14-1179</a>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choquette-Choo et al. (2023)</span>
<span class="ltx_bibblock">
Christopher A Choquette-Choo, Arun Ganesh, Ryan McKenna, H Brendan McMahan, Keith Rush, Abhradeep Guha Thakurta, and Zheng Xu.

</span>
<span class="ltx_bibblock">(amplified) banded matrix factorization: A unified approach to private training.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.08153</em>, 2023.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork et al. (2006)</span>
<span class="ltx_bibblock">
Cynthia Dwork, Frank McSherry, Kobbi Nissim, and Adam Smith.

</span>
<span class="ltx_bibblock">Calibrating noise to sensitivity in private data analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Theory of cryptography conference</em>, 2006.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eichner et al. (2019)</span>
<span class="ltx_bibblock">
Hubert Eichner, Tomer Koren, Brendan McMahan, Nathan Srebro, and Kunal Talwar.

</span>
<span class="ltx_bibblock">Semi-cyclic stochastic gradient descent.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  1764–1773. PMLR, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">El Ouadrhiri &amp; Abdelhadi (2022)</span>
<span class="ltx_bibblock">
Ahmed El Ouadrhiri and Ahmed Abdelhadi.

</span>
<span class="ltx_bibblock">Differential privacy for deep and federated learning: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE access</em>, 10:22359–22380, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Girgis et al. (2021)</span>
<span class="ltx_bibblock">
Antonious Girgis, Deepesh Data, Suhas Diggavi, Peter Kairouz, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Shuffled model of differential privacy in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and Statistics</em>, pp.  2521–2529. PMLR, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Greff et al. (2017)</span>
<span class="ltx_bibblock">
Klaus Greff, Rupesh K. Srivastava, Jan Koutník, Bas R. Steunebrink, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Lstm: A search space odyssey.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>, 28(10):2222–2232, 2017.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TNNLS.2016.2582924</span>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al. (2018a)</span>
<span class="ltx_bibblock">
Andrew Hard, Chloé M Kiddon, Daniel Ramage, Francoise Beaufays, Hubert Eichner, Kanishka Rao, Rajiv Mathews, and Sean Augenstein.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction, 2018a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/1811.03604" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1811.03604</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al. (2018b)</span>
<span class="ltx_bibblock">
Andrew Hard, Kanishka Rao, Rajiv Mathews, Françoise Beaufays, Sean Augenstein, Hubert Eichner, Chloé Kiddon, and Daniel Ramage.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1811.03604, 2018b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://api.semanticscholar.org/CorpusID:53207681" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:53207681</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hilmkil et al. (2021)</span>
<span class="ltx_bibblock">
Agrin Hilmkil, Sebastian Callh, Matteo Barbieri, Leon René Sütfeld, Edvin Listo Zec, and Olof Mogren.

</span>
<span class="ltx_bibblock">Scaling federated learning for fine-tuning of large language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Applications of Natural Language to Data Bases</em>, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter &amp; Schmidhuber (1997a)</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, 9(8):1735–1780, 1997a.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter &amp; Schmidhuber (1997b)</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, 9(8):1735–1780, 1997b.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2019)</span>
<span class="ltx_bibblock">
Peter Kairouz, H. Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi Bennis, Arjun Nitin Bhagoji, K. A. Bonawitz, Zachary Charles, Graham Cormode, Rachel Cummings, Rafael G.L. D’Oliveira, Salim El Rouayheb, David Evans, Josh Gardner, Zachary Garrett, Adrià Gascón, Badih Ghazi, Phillip B. Gibbons, Marco Gruteser, Zaid Harchaoui, Chaoyang He, Lie He, Zhouyuan Huo, Ben Hutchinson, Justin Hsu, Martin Jaggi, Tara Javidi, Gauri Joshi, Mikhail Khodak, Jakub Konečný, Aleksandra Korolova, Farinaz Koushanfar, Sanmi Koyejo, Tancrède Lepoint, Yang Liu, Prateek Mittal, Mehryar Mohri, Richard Nock, Ayfer Özgür, Rasmus Pagh, Mariana Raykova, Hang Qi, Daniel Ramage, Ramesh Raskar, Dawn Song, Weikang Song, Sebastian U. Stich, Ziteng Sun, Ananda Theertha Suresh, Florian Tramèr, Praneeth Vepakomma, Jianyu Wang, Li Xiong, Zheng Xu, Qiang Yang, Felix X. Yu, Han Yu, and Sen Zhao.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock">2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/1912.04977" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1912.04977</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021a)</span>
<span class="ltx_bibblock">
Peter Kairouz, Brendan Mcmahan, Shuang Song, Om Thakkar, Abhradeep Thakurta, and Zheng Xu.

</span>
<span class="ltx_bibblock">Practical and private (deep) learning without sampling or shuffling.

</span>
<span class="ltx_bibblock">In Marina Meila and Tong Zhang (eds.), <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on Machine Learning</em>, volume 139 of <em id="bib.bib19.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  5213–5225. PMLR, 18–24 Jul 2021a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v139/kairouz21b.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v139/kairouz21b.html</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021b)</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi Bennis, Arjun Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham Cormode, Rachel Cummings, et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends in Machine Learning</em>, 14(1–2):1–210, 2021b.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2021)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Martin Jaggi, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian U Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Breaking the centralized barrier for cross-device federated learning.

</span>
<span class="ltx_bibblock">In M. Ranzato, A. Beygelzimer, Y. Dauphin, P.S. Liang, and J. Wortman Vaughan (eds.), <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 34, pp.  28663–28676. Curran Associates, Inc., 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2021/file/f0e6be4ce76ccfa73c5a540d992d0756-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper_files/paper/2021/file/f0e6be4ce76ccfa73c5a540d992d0756-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1412.6980, 2014.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konecný et al. (2016)</span>
<span class="ltx_bibblock">
Jakub Konecný, H. B. McMahan, Felix X. Yu, Peter Richtárik, Ananda Theertha Suresh, and Dave Bacon.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1610.05492, 2016.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020a)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, 37(3):50–60, 2020a.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/MSP.2020.2975749</span>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020b)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks, 2020b.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Zhiyuan Li, Srinadh Bhojanapalli, Manzil Zaheer, Sashank Reddi, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Robust training of neural networks using scale invariant architectures.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba Szepesvari, Gang Niu, and Sivan Sabato (eds.), <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 39th International Conference on Machine Learning</em>, volume 162 of <em id="bib.bib26.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  12656–12684. PMLR, 17–23 Jul 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v162/li22b.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v162/li22b.html</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017a)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from Decentralized Data.

</span>
<span class="ltx_bibblock">In Aarti Singh and Jerry Zhu (eds.), <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on Artificial Intelligence and Statistics</em>, volume 54 of <em id="bib.bib27.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  1273–1282. PMLR, 20–22 Apr 2017a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v54/mcmahan17a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v54/mcmahan17a.html</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017b)</span>
<span class="ltx_bibblock">
H Brendan McMahan, Daniel Ramage, Kunal Talwar, and Li Zhang.

</span>
<span class="ltx_bibblock">Learning differentially private recurrent language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1710.06963</em>, 2017b.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pascanu et al. (2013)</span>
<span class="ltx_bibblock">
Razvan Pascanu, Tomas Mikolov, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">On the difficulty of training recurrent neural networks.

</span>
<span class="ltx_bibblock">In Sanjoy Dasgupta and David McAllester (eds.), <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 30th International Conference on Machine Learning</em>, volume 28 of <em id="bib.bib29.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  1310–1318, Atlanta, Georgia, USA, 17–19 Jun 2013. PMLR.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v28/pascanu13.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v28/pascanu13.html</a>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press &amp; Wolf (2017)</span>
<span class="ltx_bibblock">
Ofir Press and Lior Wolf.

</span>
<span class="ltx_bibblock">Using the output embedding to improve language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 15th Conference of the European Chapter of the Association for Computational Linguistics: Volume 2, Short Papers</em>, pp.  157–163, Valencia, Spain, April 2017. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/E17-2025" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/E17-2025</a>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2019)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv e-prints</em>, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramaswamy et al. (2020)</span>
<span class="ltx_bibblock">
Swaroop Ramaswamy, Om Thakkar, Rajiv Mathews, Galen Andrew, H Brendan McMahan, and Françoise Beaufays.

</span>
<span class="ltx_bibblock">Training production language models without memorizing user data.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.10031</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2020)</span>
<span class="ltx_bibblock">
Sashank Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush, Jakub Konečnỳ, Sanjiv Kumar, and H Brendan McMahan.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.00295</em>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2021)</span>
<span class="ltx_bibblock">
Sashank Reddi, Zachary Burr Charles, Manzil Zaheer, Zachary Garrett, Keith Rush, Jakub Konečný, Sanjiv Kumar, and Brendan McMahan (eds.).

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Adaptive Federated Optimization</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=LkFG3lB13U5" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=LkFG3lB13U5</a>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ro et al. (2021a)</span>
<span class="ltx_bibblock">
Jae Ro, Mingqing Chen, Rajiv Mathews, Mehryar Mohri, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Communication-efficient agnostic federated averaging.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2021a.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ro et al. (2022)</span>
<span class="ltx_bibblock">
Jae Ro, Theresa Breiner, Lara McConnaughey, Mingqing Chen, Ananda Suresh, Shankar Kumar, and Rajiv Mathews.

</span>
<span class="ltx_bibblock">Scaling language model size in cross-device federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the First Workshop on Federated Learning for Natural Language Processing (FL4NLP 2022)</em>, pp.  6–20, Dublin, Ireland, May 2022. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2022.fl4nlp-1.2</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/2022.fl4nlp-1.2" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2022.fl4nlp-1.2</a>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ro et al. (2021b)</span>
<span class="ltx_bibblock">
Jae Hun Ro, Ananda Theertha Suresh, and Ke Wu.

</span>
<span class="ltx_bibblock">FedJAX: Federated learning simulation with JAX.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.02117</em>, 2021b.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shah et al. (2020)</span>
<span class="ltx_bibblock">
Aishanee Shah, Andrew Hard, Cameron Nguyen, Ignacio Lopez Moreno, Kurt Partridge, Niranjan Subrahmanya, Pai Zhu, and Rajiv Mathews.

</span>
<span class="ltx_bibblock">Training keyword spotting models on non-iid data with federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Interspeech</em>, 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2021)</span>
<span class="ltx_bibblock">
Xinying Song, Alex Salcianu, Yang Song, Dave Dopson, and Denny Zhou.

</span>
<span class="ltx_bibblock">Fast WordPiece tokenization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pp.  2089–2103, Online and Punta Cana, Dominican Republic, November 2021. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2021.emnlp-main.160</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/2021.emnlp-main.160" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2021.emnlp-main.160</a>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suresh et al. (2017)</span>
<span class="ltx_bibblock">
Ananda Theertha Suresh, Felix X. Yu, Sanjiv Kumar, and H. Brendan McMahan.

</span>
<span class="ltx_bibblock">Distributed mean estimation with limited communication.

</span>
<span class="ltx_bibblock">In Doina Precup and Yee Whye Teh (eds.), <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 34th International Conference on Machine Learning</em>, volume 70 of <em id="bib.bib40.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pp.  3329–3337. PMLR, 06–11 Aug 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v70/suresh17a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v70/suresh17a.html</a>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">TFF (2018)</span>
<span class="ltx_bibblock">
TFF.

</span>
<span class="ltx_bibblock">Tensorflow federated, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.tensorflow.org/federated" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.tensorflow.org/federated</a>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In I. Guyon, U. V. Luxburg, S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett (eds.), <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, volume 30. Curran Associates, Inc., 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2020)</span>
<span class="ltx_bibblock">
Kang Wei, Jun Li, Ming Ding, Chuan Ma, Howard H Yang, Farhad Farokhi, Shi Jin, Tony QS Quek, and H Vincent Poor.

</span>
<span class="ltx_bibblock">Federated learning with differential privacy: Algorithms and performance analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on information forensics and security</em>, 15:3454–3469, 2020.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2016)</span>
<span class="ltx_bibblock">
Yonghui Wu, Mike Schuster, Z. Chen, Quoc V. Le, Mohammad Norouzi, Wolfgang Macherey, Maxim Krikun, Yuan Cao, Qin Gao, Klaus Macherey, Jeff Klingner, Apurva Shah, Melvin Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan Gouws, Yoshikiyo Kato, Taku Kudo, Hideto Kazawa, Keith Stevens, George Kurian, Nishant Patil, Wei Wang, Cliff Young, Jason R. Smith, Jason Riesa, Alex Rudnick, Oriol Vinyals, Gregory S. Corrado, Macduff Hughes, and Jeffrey Dean.

</span>
<span class="ltx_bibblock">Google’s neural machine translation system: Bridging the gap between human and machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1609.08144, 2016.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023)</span>
<span class="ltx_bibblock">
Zheng Xu, Yanxiang Zhang, Galen Andrew, Christopher Choquette, Peter Kairouz, Brendan Mcmahan, Jesse Rosenstock, and Yuanbo Zhang.

</span>
<span class="ltx_bibblock">Federated learning of gboard language models with differential privacy.

</span>
<span class="ltx_bibblock">In Sunayana Sitaram, Beata Beigman Klebanov, and Jason D Williams (eds.), <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 5: Industry Track)</em>, pp.  629–639, Toronto, Canada, July 2023. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2023.acl-industry.60</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/2023.acl-industry.60" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2023.acl-industry.60</a>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2019)</span>
<span class="ltx_bibblock">
Yong Yu, Xiaosheng Si, Changhua Hu, and Jianxun Zhang.

</span>
<span class="ltx_bibblock">A review of recurrent neural networks: Lstm cells and network architectures.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, 31(7):1235–1270, 2019.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Jingzhao Zhang, Sai Praneeth Karimireddy, Andreas Veit, Seungyeon Kim, Sashank Reddi, Sanjiv Kumar, and Suvrit Sra.

</span>
<span class="ltx_bibblock">Why are adaptive methods good for attention models?

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:15383–15393, 2020.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023)</span>
<span class="ltx_bibblock">
Yuanbo Zhang, Daniel Ramage, Zheng Xu, Yanxiang Zhang, Shumin Zhai, and Peter Kairouz.

</span>
<span class="ltx_bibblock">Private federated learning in gboard.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2306.14793</em>, 2023.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Federated experiments on public datasets details</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">For all models and experiments with the Stack Overflow federated dataset, we used the followed fixed hyperparameters</p>
</div>
<div id="A1.p2" class="ltx_para">
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">Number of clients per round = <math id="A1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="500" display="inline"><semantics id="A1.I1.i1.p1.1.m1.1a"><mn id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><cn type="integer" id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">500</annotation></semantics></math>: Number of clients sampled per communication round of FL training.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.1" class="ltx_p">Client batch size = <math id="A1.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A1.I1.i2.p1.1.m1.1a"><mn id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><cn type="integer" id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">10</annotation></semantics></math>: Batch size used during local steps of training on client data.</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p">Number of client epochs = <math id="A1.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A1.I1.i3.p1.1.m1.1a"><mn id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.1b"><cn type="integer" id="A1.I1.i3.p1.1.m1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.1c">1</annotation></semantics></math>: Number of epochs of training on client data.</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.1" class="ltx_p">Number of client batches = <math id="A1.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="120" display="inline"><semantics id="A1.I1.i4.p1.1.m1.1a"><mn id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml">120</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.1b"><cn type="integer" id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1">120</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.1c">120</annotation></semantics></math>: Maximum number of client batches to train on until number of client epochs is reached.</p>
</div>
</li>
<li id="A1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i5.p1" class="ltx_para">
<p id="A1.I1.i5.p1.1" class="ltx_p">Maximum sequence length = <math id="A1.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A1.I1.i5.p1.1.m1.1a"><mn id="A1.I1.i5.p1.1.m1.1.1" xref="A1.I1.i5.p1.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i5.p1.1.m1.1b"><cn type="integer" id="A1.I1.i5.p1.1.m1.1.1.cmml" xref="A1.I1.i5.p1.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i5.p1.1.m1.1c">20</annotation></semantics></math>: Maximum allowed sequence length. Shorter sequences are padded and longer sequences are truncated to this.</p>
</div>
</li>
<li id="A1.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i6.p1" class="ltx_para">
<p id="A1.I1.i6.p1.1" class="ltx_p">Client optimizer = SGD</p>
</div>
</li>
<li id="A1.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i7.p1" class="ltx_para">
<p id="A1.I1.i7.p1.5" class="ltx_p">Server optimizer = Adam with <math id="A1.I1.i7.p1.1.m1.1" class="ltx_Math" alttext="\beta_{1}" display="inline"><semantics id="A1.I1.i7.p1.1.m1.1a"><msub id="A1.I1.i7.p1.1.m1.1.1" xref="A1.I1.i7.p1.1.m1.1.1.cmml"><mi id="A1.I1.i7.p1.1.m1.1.1.2" xref="A1.I1.i7.p1.1.m1.1.1.2.cmml">β</mi><mn id="A1.I1.i7.p1.1.m1.1.1.3" xref="A1.I1.i7.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.1.m1.1b"><apply id="A1.I1.i7.p1.1.m1.1.1.cmml" xref="A1.I1.i7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i7.p1.1.m1.1.1.1.cmml" xref="A1.I1.i7.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I1.i7.p1.1.m1.1.1.2.cmml" xref="A1.I1.i7.p1.1.m1.1.1.2">𝛽</ci><cn type="integer" id="A1.I1.i7.p1.1.m1.1.1.3.cmml" xref="A1.I1.i7.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.1.m1.1c">\beta_{1}</annotation></semantics></math> at <math id="A1.I1.i7.p1.2.m2.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="A1.I1.i7.p1.2.m2.1a"><mn id="A1.I1.i7.p1.2.m2.1.1" xref="A1.I1.i7.p1.2.m2.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.2.m2.1b"><cn type="float" id="A1.I1.i7.p1.2.m2.1.1.cmml" xref="A1.I1.i7.p1.2.m2.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.2.m2.1c">0.9</annotation></semantics></math>, <math id="A1.I1.i7.p1.3.m3.1" class="ltx_Math" alttext="\beta_{2}" display="inline"><semantics id="A1.I1.i7.p1.3.m3.1a"><msub id="A1.I1.i7.p1.3.m3.1.1" xref="A1.I1.i7.p1.3.m3.1.1.cmml"><mi id="A1.I1.i7.p1.3.m3.1.1.2" xref="A1.I1.i7.p1.3.m3.1.1.2.cmml">β</mi><mn id="A1.I1.i7.p1.3.m3.1.1.3" xref="A1.I1.i7.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.3.m3.1b"><apply id="A1.I1.i7.p1.3.m3.1.1.cmml" xref="A1.I1.i7.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.I1.i7.p1.3.m3.1.1.1.cmml" xref="A1.I1.i7.p1.3.m3.1.1">subscript</csymbol><ci id="A1.I1.i7.p1.3.m3.1.1.2.cmml" xref="A1.I1.i7.p1.3.m3.1.1.2">𝛽</ci><cn type="integer" id="A1.I1.i7.p1.3.m3.1.1.3.cmml" xref="A1.I1.i7.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.3.m3.1c">\beta_{2}</annotation></semantics></math> at <math id="A1.I1.i7.p1.4.m4.1" class="ltx_Math" alttext="0.999" display="inline"><semantics id="A1.I1.i7.p1.4.m4.1a"><mn id="A1.I1.i7.p1.4.m4.1.1" xref="A1.I1.i7.p1.4.m4.1.1.cmml">0.999</mn><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.4.m4.1b"><cn type="float" id="A1.I1.i7.p1.4.m4.1.1.cmml" xref="A1.I1.i7.p1.4.m4.1.1">0.999</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.4.m4.1c">0.999</annotation></semantics></math>, and epsilon at <math id="A1.I1.i7.p1.5.m5.1" class="ltx_Math" alttext="1e^{-8}" display="inline"><semantics id="A1.I1.i7.p1.5.m5.1a"><mrow id="A1.I1.i7.p1.5.m5.1.1" xref="A1.I1.i7.p1.5.m5.1.1.cmml"><mn id="A1.I1.i7.p1.5.m5.1.1.2" xref="A1.I1.i7.p1.5.m5.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.I1.i7.p1.5.m5.1.1.1" xref="A1.I1.i7.p1.5.m5.1.1.1.cmml">​</mo><msup id="A1.I1.i7.p1.5.m5.1.1.3" xref="A1.I1.i7.p1.5.m5.1.1.3.cmml"><mi id="A1.I1.i7.p1.5.m5.1.1.3.2" xref="A1.I1.i7.p1.5.m5.1.1.3.2.cmml">e</mi><mrow id="A1.I1.i7.p1.5.m5.1.1.3.3" xref="A1.I1.i7.p1.5.m5.1.1.3.3.cmml"><mo id="A1.I1.i7.p1.5.m5.1.1.3.3a" xref="A1.I1.i7.p1.5.m5.1.1.3.3.cmml">−</mo><mn id="A1.I1.i7.p1.5.m5.1.1.3.3.2" xref="A1.I1.i7.p1.5.m5.1.1.3.3.2.cmml">8</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i7.p1.5.m5.1b"><apply id="A1.I1.i7.p1.5.m5.1.1.cmml" xref="A1.I1.i7.p1.5.m5.1.1"><times id="A1.I1.i7.p1.5.m5.1.1.1.cmml" xref="A1.I1.i7.p1.5.m5.1.1.1"></times><cn type="integer" id="A1.I1.i7.p1.5.m5.1.1.2.cmml" xref="A1.I1.i7.p1.5.m5.1.1.2">1</cn><apply id="A1.I1.i7.p1.5.m5.1.1.3.cmml" xref="A1.I1.i7.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i7.p1.5.m5.1.1.3.1.cmml" xref="A1.I1.i7.p1.5.m5.1.1.3">superscript</csymbol><ci id="A1.I1.i7.p1.5.m5.1.1.3.2.cmml" xref="A1.I1.i7.p1.5.m5.1.1.3.2">𝑒</ci><apply id="A1.I1.i7.p1.5.m5.1.1.3.3.cmml" xref="A1.I1.i7.p1.5.m5.1.1.3.3"><minus id="A1.I1.i7.p1.5.m5.1.1.3.3.1.cmml" xref="A1.I1.i7.p1.5.m5.1.1.3.3"></minus><cn type="integer" id="A1.I1.i7.p1.5.m5.1.1.3.3.2.cmml" xref="A1.I1.i7.p1.5.m5.1.1.3.3.2">8</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i7.p1.5.m5.1c">1e^{-8}</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.1" class="ltx_p">Table <a href="#A1.T1" title="Table 1 ‣ Appendix A Federated experiments on public datasets details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> details the hyperparameter configurations swept over per model, where the selected hyperparameters were chosen based on the lowest loss on the heldout split of the Stack Overflow federated dataset after <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="A1.p3.1.m1.1a"><mrow id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml"><mn id="A1.p3.1.m1.1.1.2" xref="A1.p3.1.m1.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="A1.p3.1.m1.1.1.1" xref="A1.p3.1.m1.1.1.1.cmml">​</mo><mi id="A1.p3.1.m1.1.1.3" xref="A1.p3.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><apply id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1"><times id="A1.p3.1.m1.1.1.1.cmml" xref="A1.p3.1.m1.1.1.1"></times><cn type="integer" id="A1.p3.1.m1.1.1.2.cmml" xref="A1.p3.1.m1.1.1.2">3</cn><ci id="A1.p3.1.m1.1.1.3.cmml" xref="A1.p3.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">3K</annotation></semantics></math> rounds of training averaged over 5 random seeds.
Table <a href="#A1.T2" title="Table 2 ‣ Appendix A Federated experiments on public datasets details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reports the final evaluation results using these selected hyperparameters on the Stack Overflow test dataset.</p>
</div>
<figure id="A1.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Selected hyperparameters for each model.
The values in <math id="A1.T1.2.m1.1" class="ltx_Math" alttext="[\ ]" display="inline"><semantics id="A1.T1.2.m1.1b"><mrow id="A1.T1.2.m1.1.1.2"><mo rspace="0.500em" stretchy="false" id="A1.T1.2.m1.1.1.2.1" xref="A1.T1.2.m1.1.1.1.cmml">[</mo><mo stretchy="false" id="A1.T1.2.m1.1.1.2.2" xref="A1.T1.2.m1.1.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.2.m1.1c"><list id="A1.T1.2.m1.1.1.1.cmml" xref="A1.T1.2.m1.1.1.2.1"></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.2.m1.1d">[\ ]</annotation></semantics></math> are the possible hyperparameter values searched over.</figcaption>
<table id="A1.T1.16" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T1.16.15.1" class="ltx_tr">
<th id="A1.T1.16.15.1.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T1.16.15.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Client learning rate</th>
<th id="A1.T1.16.15.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">Server learning rate</th>
</tr>
<tr id="A1.T1.4.2" class="ltx_tr">
<th id="A1.T1.4.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row">Model</th>
<th id="A1.T1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="A1.T1.3.1.1.m1.4" class="ltx_Math" alttext="[0.1,0.5,1.0,2.0]" display="inline"><semantics id="A1.T1.3.1.1.m1.4a"><mrow id="A1.T1.3.1.1.m1.4.5.2" xref="A1.T1.3.1.1.m1.4.5.1.cmml"><mo stretchy="false" id="A1.T1.3.1.1.m1.4.5.2.1" xref="A1.T1.3.1.1.m1.4.5.1.cmml">[</mo><mn id="A1.T1.3.1.1.m1.1.1" xref="A1.T1.3.1.1.m1.1.1.cmml">0.1</mn><mo id="A1.T1.3.1.1.m1.4.5.2.2" xref="A1.T1.3.1.1.m1.4.5.1.cmml">,</mo><mn id="A1.T1.3.1.1.m1.2.2" xref="A1.T1.3.1.1.m1.2.2.cmml">0.5</mn><mo id="A1.T1.3.1.1.m1.4.5.2.3" xref="A1.T1.3.1.1.m1.4.5.1.cmml">,</mo><mn id="A1.T1.3.1.1.m1.3.3" xref="A1.T1.3.1.1.m1.3.3.cmml">1.0</mn><mo id="A1.T1.3.1.1.m1.4.5.2.4" xref="A1.T1.3.1.1.m1.4.5.1.cmml">,</mo><mn id="A1.T1.3.1.1.m1.4.4" xref="A1.T1.3.1.1.m1.4.4.cmml">2.0</mn><mo stretchy="false" id="A1.T1.3.1.1.m1.4.5.2.5" xref="A1.T1.3.1.1.m1.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.3.1.1.m1.4b"><list id="A1.T1.3.1.1.m1.4.5.1.cmml" xref="A1.T1.3.1.1.m1.4.5.2"><cn type="float" id="A1.T1.3.1.1.m1.1.1.cmml" xref="A1.T1.3.1.1.m1.1.1">0.1</cn><cn type="float" id="A1.T1.3.1.1.m1.2.2.cmml" xref="A1.T1.3.1.1.m1.2.2">0.5</cn><cn type="float" id="A1.T1.3.1.1.m1.3.3.cmml" xref="A1.T1.3.1.1.m1.3.3">1.0</cn><cn type="float" id="A1.T1.3.1.1.m1.4.4.cmml" xref="A1.T1.3.1.1.m1.4.4">2.0</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.3.1.1.m1.4c">[0.1,0.5,1.0,2.0]</annotation></semantics></math></th>
<th id="A1.T1.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="A1.T1.4.2.2.m1.2" class="ltx_Math" alttext="[0.001,0.01]" display="inline"><semantics id="A1.T1.4.2.2.m1.2a"><mrow id="A1.T1.4.2.2.m1.2.3.2" xref="A1.T1.4.2.2.m1.2.3.1.cmml"><mo stretchy="false" id="A1.T1.4.2.2.m1.2.3.2.1" xref="A1.T1.4.2.2.m1.2.3.1.cmml">[</mo><mn id="A1.T1.4.2.2.m1.1.1" xref="A1.T1.4.2.2.m1.1.1.cmml">0.001</mn><mo id="A1.T1.4.2.2.m1.2.3.2.2" xref="A1.T1.4.2.2.m1.2.3.1.cmml">,</mo><mn id="A1.T1.4.2.2.m1.2.2" xref="A1.T1.4.2.2.m1.2.2.cmml">0.01</mn><mo stretchy="false" id="A1.T1.4.2.2.m1.2.3.2.3" xref="A1.T1.4.2.2.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T1.4.2.2.m1.2b"><interval closure="closed" id="A1.T1.4.2.2.m1.2.3.1.cmml" xref="A1.T1.4.2.2.m1.2.3.2"><cn type="float" id="A1.T1.4.2.2.m1.1.1.cmml" xref="A1.T1.4.2.2.m1.1.1">0.001</cn><cn type="float" id="A1.T1.4.2.2.m1.2.2.cmml" xref="A1.T1.4.2.2.m1.2.2">0.01</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.4.2.2.m1.2c">[0.001,0.01]</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T1.7.5" class="ltx_tr">
<th id="A1.T1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">CIFG <math id="A1.T1.5.3.1.m1.1" class="ltx_Math" alttext="19" display="inline"><semantics id="A1.T1.5.3.1.m1.1a"><mn id="A1.T1.5.3.1.m1.1.1" xref="A1.T1.5.3.1.m1.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="A1.T1.5.3.1.m1.1b"><cn type="integer" id="A1.T1.5.3.1.m1.1.1.cmml" xref="A1.T1.5.3.1.m1.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.5.3.1.m1.1c">19</annotation></semantics></math>M</th>
<td id="A1.T1.6.4.2" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T1.6.4.2.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A1.T1.6.4.2.m1.1a"><mn id="A1.T1.6.4.2.m1.1.1" xref="A1.T1.6.4.2.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A1.T1.6.4.2.m1.1b"><cn type="float" id="A1.T1.6.4.2.m1.1.1.cmml" xref="A1.T1.6.4.2.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.6.4.2.m1.1c">0.1</annotation></semantics></math></td>
<td id="A1.T1.7.5.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T1.7.5.3.m1.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="A1.T1.7.5.3.m1.1a"><mn id="A1.T1.7.5.3.m1.1.1" xref="A1.T1.7.5.3.m1.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="A1.T1.7.5.3.m1.1b"><cn type="float" id="A1.T1.7.5.3.m1.1.1.cmml" xref="A1.T1.7.5.3.m1.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.7.5.3.m1.1c">0.001</annotation></semantics></math></td>
</tr>
<tr id="A1.T1.10.8" class="ltx_tr">
<th id="A1.T1.8.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<span id="A1.T1.8.6.1.1" class="ltx_text">SI-CIFG</span> <math id="A1.T1.8.6.1.m1.1" class="ltx_Math" alttext="19" display="inline"><semantics id="A1.T1.8.6.1.m1.1a"><mn id="A1.T1.8.6.1.m1.1.1" xref="A1.T1.8.6.1.m1.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="A1.T1.8.6.1.m1.1b"><cn type="integer" id="A1.T1.8.6.1.m1.1.1.cmml" xref="A1.T1.8.6.1.m1.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.8.6.1.m1.1c">19</annotation></semantics></math>M</th>
<td id="A1.T1.9.7.2" class="ltx_td ltx_align_center"><math id="A1.T1.9.7.2.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="A1.T1.9.7.2.m1.1a"><mn id="A1.T1.9.7.2.m1.1.1" xref="A1.T1.9.7.2.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A1.T1.9.7.2.m1.1b"><cn type="float" id="A1.T1.9.7.2.m1.1.1.cmml" xref="A1.T1.9.7.2.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.9.7.2.m1.1c">0.1</annotation></semantics></math></td>
<td id="A1.T1.10.8.3" class="ltx_td ltx_align_center"><math id="A1.T1.10.8.3.m1.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="A1.T1.10.8.3.m1.1a"><mn id="A1.T1.10.8.3.m1.1.1" xref="A1.T1.10.8.3.m1.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="A1.T1.10.8.3.m1.1b"><cn type="float" id="A1.T1.10.8.3.m1.1.1.cmml" xref="A1.T1.10.8.3.m1.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.10.8.3.m1.1c">0.001</annotation></semantics></math></td>
</tr>
<tr id="A1.T1.13.11" class="ltx_tr">
<th id="A1.T1.11.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Transformer <math id="A1.T1.11.9.1.m1.1" class="ltx_Math" alttext="21" display="inline"><semantics id="A1.T1.11.9.1.m1.1a"><mn id="A1.T1.11.9.1.m1.1.1" xref="A1.T1.11.9.1.m1.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="A1.T1.11.9.1.m1.1b"><cn type="integer" id="A1.T1.11.9.1.m1.1.1.cmml" xref="A1.T1.11.9.1.m1.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.11.9.1.m1.1c">21</annotation></semantics></math>M</th>
<td id="A1.T1.12.10.2" class="ltx_td ltx_align_center"><math id="A1.T1.12.10.2.m1.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="A1.T1.12.10.2.m1.1a"><mn id="A1.T1.12.10.2.m1.1.1" xref="A1.T1.12.10.2.m1.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="A1.T1.12.10.2.m1.1b"><cn type="float" id="A1.T1.12.10.2.m1.1.1.cmml" xref="A1.T1.12.10.2.m1.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.12.10.2.m1.1c">0.5</annotation></semantics></math></td>
<td id="A1.T1.13.11.3" class="ltx_td ltx_align_center"><math id="A1.T1.13.11.3.m1.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="A1.T1.13.11.3.m1.1a"><mn id="A1.T1.13.11.3.m1.1.1" xref="A1.T1.13.11.3.m1.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="A1.T1.13.11.3.m1.1b"><cn type="float" id="A1.T1.13.11.3.m1.1.1.cmml" xref="A1.T1.13.11.3.m1.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.13.11.3.m1.1c">0.001</annotation></semantics></math></td>
</tr>
<tr id="A1.T1.16.14" class="ltx_tr">
<th id="A1.T1.14.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">SI Transformer <math id="A1.T1.14.12.1.m1.1" class="ltx_Math" alttext="21" display="inline"><semantics id="A1.T1.14.12.1.m1.1a"><mn id="A1.T1.14.12.1.m1.1.1" xref="A1.T1.14.12.1.m1.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="A1.T1.14.12.1.m1.1b"><cn type="integer" id="A1.T1.14.12.1.m1.1.1.cmml" xref="A1.T1.14.12.1.m1.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.14.12.1.m1.1c">21</annotation></semantics></math>M</th>
<td id="A1.T1.15.13.2" class="ltx_td ltx_align_center"><math id="A1.T1.15.13.2.m1.1" class="ltx_Math" alttext="2.0" display="inline"><semantics id="A1.T1.15.13.2.m1.1a"><mn id="A1.T1.15.13.2.m1.1.1" xref="A1.T1.15.13.2.m1.1.1.cmml">2.0</mn><annotation-xml encoding="MathML-Content" id="A1.T1.15.13.2.m1.1b"><cn type="float" id="A1.T1.15.13.2.m1.1.1.cmml" xref="A1.T1.15.13.2.m1.1.1">2.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.15.13.2.m1.1c">2.0</annotation></semantics></math></td>
<td id="A1.T1.16.14.3" class="ltx_td ltx_align_center"><math id="A1.T1.16.14.3.m1.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="A1.T1.16.14.3.m1.1a"><mn id="A1.T1.16.14.3.m1.1.1" xref="A1.T1.16.14.3.m1.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A1.T1.16.14.3.m1.1b"><cn type="float" id="A1.T1.16.14.3.m1.1.1.cmml" xref="A1.T1.16.14.3.m1.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T1.16.14.3.m1.1c">0.01</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="A1.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Perplexity and accuracy on the Stack Overflow test dataset after <math id="A1.T2.2.m1.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="A1.T2.2.m1.1b"><mrow id="A1.T2.2.m1.1.1" xref="A1.T2.2.m1.1.1.cmml"><mn id="A1.T2.2.m1.1.1.2" xref="A1.T2.2.m1.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="A1.T2.2.m1.1.1.1" xref="A1.T2.2.m1.1.1.1.cmml">​</mo><mi id="A1.T2.2.m1.1.1.3" xref="A1.T2.2.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.2.m1.1c"><apply id="A1.T2.2.m1.1.1.cmml" xref="A1.T2.2.m1.1.1"><times id="A1.T2.2.m1.1.1.1.cmml" xref="A1.T2.2.m1.1.1.1"></times><cn type="integer" id="A1.T2.2.m1.1.1.2.cmml" xref="A1.T2.2.m1.1.1.2">3</cn><ci id="A1.T2.2.m1.1.1.3.cmml" xref="A1.T2.2.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.m1.1d">3K</annotation></semantics></math> communication rounds.</figcaption>
<table id="A1.T2.14" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T2.14.13.1" class="ltx_tr">
<th id="A1.T2.14.13.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Model</th>
<th id="A1.T2.14.13.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Perplexity</th>
<th id="A1.T2.14.13.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T2.5.3" class="ltx_tr">
<th id="A1.T2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">CIFG <math id="A1.T2.3.1.1.m1.1" class="ltx_Math" alttext="19" display="inline"><semantics id="A1.T2.3.1.1.m1.1a"><mn id="A1.T2.3.1.1.m1.1.1" xref="A1.T2.3.1.1.m1.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="A1.T2.3.1.1.m1.1b"><cn type="integer" id="A1.T2.3.1.1.m1.1.1.cmml" xref="A1.T2.3.1.1.m1.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.3.1.1.m1.1c">19</annotation></semantics></math>M</th>
<td id="A1.T2.4.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T2.4.2.2.m1.1" class="ltx_Math" alttext="35.5\pm 0.2" display="inline"><semantics id="A1.T2.4.2.2.m1.1a"><mrow id="A1.T2.4.2.2.m1.1.1" xref="A1.T2.4.2.2.m1.1.1.cmml"><mn id="A1.T2.4.2.2.m1.1.1.2" xref="A1.T2.4.2.2.m1.1.1.2.cmml">35.5</mn><mo id="A1.T2.4.2.2.m1.1.1.1" xref="A1.T2.4.2.2.m1.1.1.1.cmml">±</mo><mn id="A1.T2.4.2.2.m1.1.1.3" xref="A1.T2.4.2.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.4.2.2.m1.1b"><apply id="A1.T2.4.2.2.m1.1.1.cmml" xref="A1.T2.4.2.2.m1.1.1"><csymbol cd="latexml" id="A1.T2.4.2.2.m1.1.1.1.cmml" xref="A1.T2.4.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.4.2.2.m1.1.1.2.cmml" xref="A1.T2.4.2.2.m1.1.1.2">35.5</cn><cn type="float" id="A1.T2.4.2.2.m1.1.1.3.cmml" xref="A1.T2.4.2.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.4.2.2.m1.1c">35.5\pm 0.2</annotation></semantics></math></td>
<td id="A1.T2.5.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T2.5.3.3.m1.1" class="ltx_Math" alttext="33.1\pm 0.1" display="inline"><semantics id="A1.T2.5.3.3.m1.1a"><mrow id="A1.T2.5.3.3.m1.1.1" xref="A1.T2.5.3.3.m1.1.1.cmml"><mn id="A1.T2.5.3.3.m1.1.1.2" xref="A1.T2.5.3.3.m1.1.1.2.cmml">33.1</mn><mo id="A1.T2.5.3.3.m1.1.1.1" xref="A1.T2.5.3.3.m1.1.1.1.cmml">±</mo><mn id="A1.T2.5.3.3.m1.1.1.3" xref="A1.T2.5.3.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.5.3.3.m1.1b"><apply id="A1.T2.5.3.3.m1.1.1.cmml" xref="A1.T2.5.3.3.m1.1.1"><csymbol cd="latexml" id="A1.T2.5.3.3.m1.1.1.1.cmml" xref="A1.T2.5.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.5.3.3.m1.1.1.2.cmml" xref="A1.T2.5.3.3.m1.1.1.2">33.1</cn><cn type="float" id="A1.T2.5.3.3.m1.1.1.3.cmml" xref="A1.T2.5.3.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.5.3.3.m1.1c">33.1\pm 0.1</annotation></semantics></math></td>
</tr>
<tr id="A1.T2.8.6" class="ltx_tr">
<th id="A1.T2.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<span id="A1.T2.6.4.1.1" class="ltx_text">SI-CIFG</span> <math id="A1.T2.6.4.1.m1.1" class="ltx_Math" alttext="19" display="inline"><semantics id="A1.T2.6.4.1.m1.1a"><mn id="A1.T2.6.4.1.m1.1.1" xref="A1.T2.6.4.1.m1.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="A1.T2.6.4.1.m1.1b"><cn type="integer" id="A1.T2.6.4.1.m1.1.1.cmml" xref="A1.T2.6.4.1.m1.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.6.4.1.m1.1c">19</annotation></semantics></math>M</th>
<td id="A1.T2.7.5.2" class="ltx_td ltx_align_center"><math id="A1.T2.7.5.2.m1.1" class="ltx_Math" alttext="\mathbf{33.6\pm 0.2}" display="inline"><semantics id="A1.T2.7.5.2.m1.1a"><mrow id="A1.T2.7.5.2.m1.1.1" xref="A1.T2.7.5.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A1.T2.7.5.2.m1.1.1.2" xref="A1.T2.7.5.2.m1.1.1.2.cmml">33.6</mn><mo id="A1.T2.7.5.2.m1.1.1.1" xref="A1.T2.7.5.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A1.T2.7.5.2.m1.1.1.3" xref="A1.T2.7.5.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.7.5.2.m1.1b"><apply id="A1.T2.7.5.2.m1.1.1.cmml" xref="A1.T2.7.5.2.m1.1.1"><csymbol cd="latexml" id="A1.T2.7.5.2.m1.1.1.1.cmml" xref="A1.T2.7.5.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.7.5.2.m1.1.1.2.cmml" xref="A1.T2.7.5.2.m1.1.1.2">33.6</cn><cn type="float" id="A1.T2.7.5.2.m1.1.1.3.cmml" xref="A1.T2.7.5.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.7.5.2.m1.1c">\mathbf{33.6\pm 0.2}</annotation></semantics></math></td>
<td id="A1.T2.8.6.3" class="ltx_td ltx_align_center"><math id="A1.T2.8.6.3.m1.1" class="ltx_Math" alttext="\mathbf{33.6\pm 0.1}" display="inline"><semantics id="A1.T2.8.6.3.m1.1a"><mrow id="A1.T2.8.6.3.m1.1.1" xref="A1.T2.8.6.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A1.T2.8.6.3.m1.1.1.2" xref="A1.T2.8.6.3.m1.1.1.2.cmml">33.6</mn><mo id="A1.T2.8.6.3.m1.1.1.1" xref="A1.T2.8.6.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A1.T2.8.6.3.m1.1.1.3" xref="A1.T2.8.6.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.8.6.3.m1.1b"><apply id="A1.T2.8.6.3.m1.1.1.cmml" xref="A1.T2.8.6.3.m1.1.1"><csymbol cd="latexml" id="A1.T2.8.6.3.m1.1.1.1.cmml" xref="A1.T2.8.6.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.8.6.3.m1.1.1.2.cmml" xref="A1.T2.8.6.3.m1.1.1.2">33.6</cn><cn type="float" id="A1.T2.8.6.3.m1.1.1.3.cmml" xref="A1.T2.8.6.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.8.6.3.m1.1c">\mathbf{33.6\pm 0.1}</annotation></semantics></math></td>
</tr>
<tr id="A1.T2.11.9" class="ltx_tr">
<th id="A1.T2.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Transformer <math id="A1.T2.9.7.1.m1.1" class="ltx_Math" alttext="21" display="inline"><semantics id="A1.T2.9.7.1.m1.1a"><mn id="A1.T2.9.7.1.m1.1.1" xref="A1.T2.9.7.1.m1.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="A1.T2.9.7.1.m1.1b"><cn type="integer" id="A1.T2.9.7.1.m1.1.1.cmml" xref="A1.T2.9.7.1.m1.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.9.7.1.m1.1c">21</annotation></semantics></math>M</th>
<td id="A1.T2.10.8.2" class="ltx_td ltx_align_center"><math id="A1.T2.10.8.2.m1.1" class="ltx_Math" alttext="34.6\pm 0.1" display="inline"><semantics id="A1.T2.10.8.2.m1.1a"><mrow id="A1.T2.10.8.2.m1.1.1" xref="A1.T2.10.8.2.m1.1.1.cmml"><mn id="A1.T2.10.8.2.m1.1.1.2" xref="A1.T2.10.8.2.m1.1.1.2.cmml">34.6</mn><mo id="A1.T2.10.8.2.m1.1.1.1" xref="A1.T2.10.8.2.m1.1.1.1.cmml">±</mo><mn id="A1.T2.10.8.2.m1.1.1.3" xref="A1.T2.10.8.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.10.8.2.m1.1b"><apply id="A1.T2.10.8.2.m1.1.1.cmml" xref="A1.T2.10.8.2.m1.1.1"><csymbol cd="latexml" id="A1.T2.10.8.2.m1.1.1.1.cmml" xref="A1.T2.10.8.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.10.8.2.m1.1.1.2.cmml" xref="A1.T2.10.8.2.m1.1.1.2">34.6</cn><cn type="float" id="A1.T2.10.8.2.m1.1.1.3.cmml" xref="A1.T2.10.8.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.10.8.2.m1.1c">34.6\pm 0.1</annotation></semantics></math></td>
<td id="A1.T2.11.9.3" class="ltx_td ltx_align_center"><math id="A1.T2.11.9.3.m1.1" class="ltx_Math" alttext="33.4\pm 0.0" display="inline"><semantics id="A1.T2.11.9.3.m1.1a"><mrow id="A1.T2.11.9.3.m1.1.1" xref="A1.T2.11.9.3.m1.1.1.cmml"><mn id="A1.T2.11.9.3.m1.1.1.2" xref="A1.T2.11.9.3.m1.1.1.2.cmml">33.4</mn><mo id="A1.T2.11.9.3.m1.1.1.1" xref="A1.T2.11.9.3.m1.1.1.1.cmml">±</mo><mn id="A1.T2.11.9.3.m1.1.1.3" xref="A1.T2.11.9.3.m1.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.11.9.3.m1.1b"><apply id="A1.T2.11.9.3.m1.1.1.cmml" xref="A1.T2.11.9.3.m1.1.1"><csymbol cd="latexml" id="A1.T2.11.9.3.m1.1.1.1.cmml" xref="A1.T2.11.9.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.11.9.3.m1.1.1.2.cmml" xref="A1.T2.11.9.3.m1.1.1.2">33.4</cn><cn type="float" id="A1.T2.11.9.3.m1.1.1.3.cmml" xref="A1.T2.11.9.3.m1.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.11.9.3.m1.1c">33.4\pm 0.0</annotation></semantics></math></td>
</tr>
<tr id="A1.T2.14.12" class="ltx_tr">
<th id="A1.T2.12.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b">SI Transformer <math id="A1.T2.12.10.1.m1.1" class="ltx_Math" alttext="21" display="inline"><semantics id="A1.T2.12.10.1.m1.1a"><mn id="A1.T2.12.10.1.m1.1.1" xref="A1.T2.12.10.1.m1.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="A1.T2.12.10.1.m1.1b"><cn type="integer" id="A1.T2.12.10.1.m1.1.1.cmml" xref="A1.T2.12.10.1.m1.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.12.10.1.m1.1c">21</annotation></semantics></math>M</th>
<td id="A1.T2.13.11.2" class="ltx_td ltx_align_center ltx_border_b"><math id="A1.T2.13.11.2.m1.1" class="ltx_Math" alttext="33.7\pm 0.1" display="inline"><semantics id="A1.T2.13.11.2.m1.1a"><mrow id="A1.T2.13.11.2.m1.1.1" xref="A1.T2.13.11.2.m1.1.1.cmml"><mn id="A1.T2.13.11.2.m1.1.1.2" xref="A1.T2.13.11.2.m1.1.1.2.cmml">33.7</mn><mo id="A1.T2.13.11.2.m1.1.1.1" xref="A1.T2.13.11.2.m1.1.1.1.cmml">±</mo><mn id="A1.T2.13.11.2.m1.1.1.3" xref="A1.T2.13.11.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.13.11.2.m1.1b"><apply id="A1.T2.13.11.2.m1.1.1.cmml" xref="A1.T2.13.11.2.m1.1.1"><csymbol cd="latexml" id="A1.T2.13.11.2.m1.1.1.1.cmml" xref="A1.T2.13.11.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.13.11.2.m1.1.1.2.cmml" xref="A1.T2.13.11.2.m1.1.1.2">33.7</cn><cn type="float" id="A1.T2.13.11.2.m1.1.1.3.cmml" xref="A1.T2.13.11.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.13.11.2.m1.1c">33.7\pm 0.1</annotation></semantics></math></td>
<td id="A1.T2.14.12.3" class="ltx_td ltx_align_center ltx_border_b"><math id="A1.T2.14.12.3.m1.1" class="ltx_Math" alttext="33.5\pm 0.0" display="inline"><semantics id="A1.T2.14.12.3.m1.1a"><mrow id="A1.T2.14.12.3.m1.1.1" xref="A1.T2.14.12.3.m1.1.1.cmml"><mn id="A1.T2.14.12.3.m1.1.1.2" xref="A1.T2.14.12.3.m1.1.1.2.cmml">33.5</mn><mo id="A1.T2.14.12.3.m1.1.1.1" xref="A1.T2.14.12.3.m1.1.1.1.cmml">±</mo><mn id="A1.T2.14.12.3.m1.1.1.3" xref="A1.T2.14.12.3.m1.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.14.12.3.m1.1b"><apply id="A1.T2.14.12.3.m1.1.1.cmml" xref="A1.T2.14.12.3.m1.1.1"><csymbol cd="latexml" id="A1.T2.14.12.3.m1.1.1.1.cmml" xref="A1.T2.14.12.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A1.T2.14.12.3.m1.1.1.2.cmml" xref="A1.T2.14.12.3.m1.1.1.2">33.5</cn><cn type="float" id="A1.T2.14.12.3.m1.1.1.3.cmml" xref="A1.T2.14.12.3.m1.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.14.12.3.m1.1c">33.5\pm 0.0</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Live production experiment details</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.2" class="ltx_p">For all models and experiments with the live English virtual keyboard user population, we used the followed fixed hyperparameters.
We note that due to the nature of live production experiments and longer feedback times, we were not able to run any extensive hyperparameter sweeps and re-used many common settings used in previous experiments.
Table <a href="#A2.T3" title="Table 3 ‣ Appendix B Live production experiment details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> reports the final evaluation results using these hyperparameters averaged over the final <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.p1.1.m1.1a"><mn id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><cn type="integer" id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">100</annotation></semantics></math> of <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="A2.p1.2.m2.1a"><mrow id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mn id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml">​</mo><mi id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><times id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"></times><cn type="integer" id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">3</cn><ci id="A2.p1.2.m2.1.1.3.cmml" xref="A2.p1.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">3K</annotation></semantics></math> communication rounds to account for daytime variability <cite class="ltx_cite ltx_citemacro_citep">(Eichner et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="A2.p2" class="ltx_para">
<ul id="A2.I1" class="ltx_itemize">
<li id="A2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i1.p1" class="ltx_para">
<p id="A2.I1.i1.p1.1" class="ltx_p">Number of clients per round = <math id="A2.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="500" display="inline"><semantics id="A2.I1.i1.p1.1.m1.1a"><mn id="A2.I1.i1.p1.1.m1.1.1" xref="A2.I1.i1.p1.1.m1.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i1.p1.1.m1.1b"><cn type="integer" id="A2.I1.i1.p1.1.m1.1.1.cmml" xref="A2.I1.i1.p1.1.m1.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i1.p1.1.m1.1c">500</annotation></semantics></math>: Number of clients sampled per communication round of FL training.</p>
</div>
</li>
<li id="A2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i2.p1" class="ltx_para">
<p id="A2.I1.i2.p1.1" class="ltx_p">Client batch size = <math id="A2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A2.I1.i2.p1.1.m1.1a"><mn id="A2.I1.i2.p1.1.m1.1.1" xref="A2.I1.i2.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i2.p1.1.m1.1b"><cn type="integer" id="A2.I1.i2.p1.1.m1.1.1.cmml" xref="A2.I1.i2.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i2.p1.1.m1.1c">10</annotation></semantics></math>: Batch size used during local steps of training on client data.</p>
</div>
</li>
<li id="A2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i3.p1" class="ltx_para">
<p id="A2.I1.i3.p1.1" class="ltx_p">Number of client epochs = <math id="A2.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A2.I1.i3.p1.1.m1.1a"><mn id="A2.I1.i3.p1.1.m1.1.1" xref="A2.I1.i3.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i3.p1.1.m1.1b"><cn type="integer" id="A2.I1.i3.p1.1.m1.1.1.cmml" xref="A2.I1.i3.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i3.p1.1.m1.1c">1</annotation></semantics></math>: Number of epochs of training on client data.</p>
</div>
</li>
<li id="A2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i4.p1" class="ltx_para">
<p id="A2.I1.i4.p1.1" class="ltx_p">Number of client batches = <math id="A2.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="120" display="inline"><semantics id="A2.I1.i4.p1.1.m1.1a"><mn id="A2.I1.i4.p1.1.m1.1.1" xref="A2.I1.i4.p1.1.m1.1.1.cmml">120</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i4.p1.1.m1.1b"><cn type="integer" id="A2.I1.i4.p1.1.m1.1.1.cmml" xref="A2.I1.i4.p1.1.m1.1.1">120</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i4.p1.1.m1.1c">120</annotation></semantics></math>: Maximum number of client batches to train on until number of client epochs is reached.</p>
</div>
</li>
<li id="A2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i5.p1" class="ltx_para">
<p id="A2.I1.i5.p1.1" class="ltx_p">Maximum sequence length = <math id="A2.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="A2.I1.i5.p1.1.m1.1a"><mn id="A2.I1.i5.p1.1.m1.1.1" xref="A2.I1.i5.p1.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i5.p1.1.m1.1b"><cn type="integer" id="A2.I1.i5.p1.1.m1.1.1.cmml" xref="A2.I1.i5.p1.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i5.p1.1.m1.1c">20</annotation></semantics></math>: Maximum allowed sequence length.</p>
</div>
</li>
<li id="A2.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i6.p1" class="ltx_para">
<p id="A2.I1.i6.p1.1" class="ltx_p">Client optimizer = SGD with learning rate <math id="A2.I1.i6.p1.1.m1.1" class="ltx_Math" alttext="0.7" display="inline"><semantics id="A2.I1.i6.p1.1.m1.1a"><mn id="A2.I1.i6.p1.1.m1.1.1" xref="A2.I1.i6.p1.1.m1.1.1.cmml">0.7</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i6.p1.1.m1.1b"><cn type="float" id="A2.I1.i6.p1.1.m1.1.1.cmml" xref="A2.I1.i6.p1.1.m1.1.1">0.7</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i6.p1.1.m1.1c">0.7</annotation></semantics></math>.</p>
</div>
</li>
<li id="A2.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i7.p1" class="ltx_para">
<p id="A2.I1.i7.p1.6" class="ltx_p">Server optimizer = Adam with learning rate <math id="A2.I1.i7.p1.1.m1.1" class="ltx_Math" alttext="0.02" display="inline"><semantics id="A2.I1.i7.p1.1.m1.1a"><mn id="A2.I1.i7.p1.1.m1.1.1" xref="A2.I1.i7.p1.1.m1.1.1.cmml">0.02</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i7.p1.1.m1.1b"><cn type="float" id="A2.I1.i7.p1.1.m1.1.1.cmml" xref="A2.I1.i7.p1.1.m1.1.1">0.02</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i7.p1.1.m1.1c">0.02</annotation></semantics></math>, <math id="A2.I1.i7.p1.2.m2.1" class="ltx_Math" alttext="\beta_{1}" display="inline"><semantics id="A2.I1.i7.p1.2.m2.1a"><msub id="A2.I1.i7.p1.2.m2.1.1" xref="A2.I1.i7.p1.2.m2.1.1.cmml"><mi id="A2.I1.i7.p1.2.m2.1.1.2" xref="A2.I1.i7.p1.2.m2.1.1.2.cmml">β</mi><mn id="A2.I1.i7.p1.2.m2.1.1.3" xref="A2.I1.i7.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i7.p1.2.m2.1b"><apply id="A2.I1.i7.p1.2.m2.1.1.cmml" xref="A2.I1.i7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.I1.i7.p1.2.m2.1.1.1.cmml" xref="A2.I1.i7.p1.2.m2.1.1">subscript</csymbol><ci id="A2.I1.i7.p1.2.m2.1.1.2.cmml" xref="A2.I1.i7.p1.2.m2.1.1.2">𝛽</ci><cn type="integer" id="A2.I1.i7.p1.2.m2.1.1.3.cmml" xref="A2.I1.i7.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i7.p1.2.m2.1c">\beta_{1}</annotation></semantics></math> at <math id="A2.I1.i7.p1.3.m3.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="A2.I1.i7.p1.3.m3.1a"><mn id="A2.I1.i7.p1.3.m3.1.1" xref="A2.I1.i7.p1.3.m3.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i7.p1.3.m3.1b"><cn type="float" id="A2.I1.i7.p1.3.m3.1.1.cmml" xref="A2.I1.i7.p1.3.m3.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i7.p1.3.m3.1c">0.9</annotation></semantics></math>, <math id="A2.I1.i7.p1.4.m4.1" class="ltx_Math" alttext="\beta_{2}" display="inline"><semantics id="A2.I1.i7.p1.4.m4.1a"><msub id="A2.I1.i7.p1.4.m4.1.1" xref="A2.I1.i7.p1.4.m4.1.1.cmml"><mi id="A2.I1.i7.p1.4.m4.1.1.2" xref="A2.I1.i7.p1.4.m4.1.1.2.cmml">β</mi><mn id="A2.I1.i7.p1.4.m4.1.1.3" xref="A2.I1.i7.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A2.I1.i7.p1.4.m4.1b"><apply id="A2.I1.i7.p1.4.m4.1.1.cmml" xref="A2.I1.i7.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A2.I1.i7.p1.4.m4.1.1.1.cmml" xref="A2.I1.i7.p1.4.m4.1.1">subscript</csymbol><ci id="A2.I1.i7.p1.4.m4.1.1.2.cmml" xref="A2.I1.i7.p1.4.m4.1.1.2">𝛽</ci><cn type="integer" id="A2.I1.i7.p1.4.m4.1.1.3.cmml" xref="A2.I1.i7.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i7.p1.4.m4.1c">\beta_{2}</annotation></semantics></math> at <math id="A2.I1.i7.p1.5.m5.1" class="ltx_Math" alttext="0.999" display="inline"><semantics id="A2.I1.i7.p1.5.m5.1a"><mn id="A2.I1.i7.p1.5.m5.1.1" xref="A2.I1.i7.p1.5.m5.1.1.cmml">0.999</mn><annotation-xml encoding="MathML-Content" id="A2.I1.i7.p1.5.m5.1b"><cn type="float" id="A2.I1.i7.p1.5.m5.1.1.cmml" xref="A2.I1.i7.p1.5.m5.1.1">0.999</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i7.p1.5.m5.1c">0.999</annotation></semantics></math>, and epsilon at <math id="A2.I1.i7.p1.6.m6.1" class="ltx_Math" alttext="1e^{-8}" display="inline"><semantics id="A2.I1.i7.p1.6.m6.1a"><mrow id="A2.I1.i7.p1.6.m6.1.1" xref="A2.I1.i7.p1.6.m6.1.1.cmml"><mn id="A2.I1.i7.p1.6.m6.1.1.2" xref="A2.I1.i7.p1.6.m6.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A2.I1.i7.p1.6.m6.1.1.1" xref="A2.I1.i7.p1.6.m6.1.1.1.cmml">​</mo><msup id="A2.I1.i7.p1.6.m6.1.1.3" xref="A2.I1.i7.p1.6.m6.1.1.3.cmml"><mi id="A2.I1.i7.p1.6.m6.1.1.3.2" xref="A2.I1.i7.p1.6.m6.1.1.3.2.cmml">e</mi><mrow id="A2.I1.i7.p1.6.m6.1.1.3.3" xref="A2.I1.i7.p1.6.m6.1.1.3.3.cmml"><mo id="A2.I1.i7.p1.6.m6.1.1.3.3a" xref="A2.I1.i7.p1.6.m6.1.1.3.3.cmml">−</mo><mn id="A2.I1.i7.p1.6.m6.1.1.3.3.2" xref="A2.I1.i7.p1.6.m6.1.1.3.3.2.cmml">8</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.I1.i7.p1.6.m6.1b"><apply id="A2.I1.i7.p1.6.m6.1.1.cmml" xref="A2.I1.i7.p1.6.m6.1.1"><times id="A2.I1.i7.p1.6.m6.1.1.1.cmml" xref="A2.I1.i7.p1.6.m6.1.1.1"></times><cn type="integer" id="A2.I1.i7.p1.6.m6.1.1.2.cmml" xref="A2.I1.i7.p1.6.m6.1.1.2">1</cn><apply id="A2.I1.i7.p1.6.m6.1.1.3.cmml" xref="A2.I1.i7.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="A2.I1.i7.p1.6.m6.1.1.3.1.cmml" xref="A2.I1.i7.p1.6.m6.1.1.3">superscript</csymbol><ci id="A2.I1.i7.p1.6.m6.1.1.3.2.cmml" xref="A2.I1.i7.p1.6.m6.1.1.3.2">𝑒</ci><apply id="A2.I1.i7.p1.6.m6.1.1.3.3.cmml" xref="A2.I1.i7.p1.6.m6.1.1.3.3"><minus id="A2.I1.i7.p1.6.m6.1.1.3.3.1.cmml" xref="A2.I1.i7.p1.6.m6.1.1.3.3"></minus><cn type="integer" id="A2.I1.i7.p1.6.m6.1.1.3.3.2.cmml" xref="A2.I1.i7.p1.6.m6.1.1.3.3.2">8</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.I1.i7.p1.6.m6.1c">1e^{-8}</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<figure id="A2.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Perplexity and accuracy from live experiments on English virtual keyboard devices averaged with standard deviations over the final <math id="A2.T3.4.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.4.m1.1b"><mn id="A2.T3.4.m1.1.1" xref="A2.T3.4.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.4.m1.1c"><cn type="integer" id="A2.T3.4.m1.1.1.cmml" xref="A2.T3.4.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.4.m1.1d">100</annotation></semantics></math> communication rounds. <sup id="A2.T3.21.1" class="ltx_sup">∗</sup>For base CIFG, we use the last <math id="A2.T3.6.m3.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.T3.6.m3.1b"><mn id="A2.T3.6.m3.1.1" xref="A2.T3.6.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.T3.6.m3.1c"><cn type="integer" id="A2.T3.6.m3.1.1.cmml" xref="A2.T3.6.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.6.m3.1d">100</annotation></semantics></math> rounds before divergence. </figcaption>
<table id="A2.T3.19" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T3.19.14.1" class="ltx_tr">
<th id="A2.T3.19.14.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Model</th>
<th id="A2.T3.19.14.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Perplexity</th>
<th id="A2.T3.19.14.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T3.10.4" class="ltx_tr">
<th id="A2.T3.8.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">
<sup id="A2.T3.8.2.2.1" class="ltx_sup">∗</sup>CIFG <math id="A2.T3.8.2.2.m2.1" class="ltx_Math" alttext="9" display="inline"><semantics id="A2.T3.8.2.2.m2.1a"><mn id="A2.T3.8.2.2.m2.1.1" xref="A2.T3.8.2.2.m2.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="A2.T3.8.2.2.m2.1b"><cn type="integer" id="A2.T3.8.2.2.m2.1.1.cmml" xref="A2.T3.8.2.2.m2.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.8.2.2.m2.1c">9</annotation></semantics></math>M</th>
<td id="A2.T3.9.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A2.T3.9.3.3.m1.1" class="ltx_Math" alttext="47.5\pm 1.1" display="inline"><semantics id="A2.T3.9.3.3.m1.1a"><mrow id="A2.T3.9.3.3.m1.1.1" xref="A2.T3.9.3.3.m1.1.1.cmml"><mn id="A2.T3.9.3.3.m1.1.1.2" xref="A2.T3.9.3.3.m1.1.1.2.cmml">47.5</mn><mo id="A2.T3.9.3.3.m1.1.1.1" xref="A2.T3.9.3.3.m1.1.1.1.cmml">±</mo><mn id="A2.T3.9.3.3.m1.1.1.3" xref="A2.T3.9.3.3.m1.1.1.3.cmml">1.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.9.3.3.m1.1b"><apply id="A2.T3.9.3.3.m1.1.1.cmml" xref="A2.T3.9.3.3.m1.1.1"><csymbol cd="latexml" id="A2.T3.9.3.3.m1.1.1.1.cmml" xref="A2.T3.9.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.9.3.3.m1.1.1.2.cmml" xref="A2.T3.9.3.3.m1.1.1.2">47.5</cn><cn type="float" id="A2.T3.9.3.3.m1.1.1.3.cmml" xref="A2.T3.9.3.3.m1.1.1.3">1.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.9.3.3.m1.1c">47.5\pm 1.1</annotation></semantics></math></td>
<td id="A2.T3.10.4.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A2.T3.10.4.4.m1.1" class="ltx_Math" alttext="21.8\pm 0.2" display="inline"><semantics id="A2.T3.10.4.4.m1.1a"><mrow id="A2.T3.10.4.4.m1.1.1" xref="A2.T3.10.4.4.m1.1.1.cmml"><mn id="A2.T3.10.4.4.m1.1.1.2" xref="A2.T3.10.4.4.m1.1.1.2.cmml">21.8</mn><mo id="A2.T3.10.4.4.m1.1.1.1" xref="A2.T3.10.4.4.m1.1.1.1.cmml">±</mo><mn id="A2.T3.10.4.4.m1.1.1.3" xref="A2.T3.10.4.4.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.10.4.4.m1.1b"><apply id="A2.T3.10.4.4.m1.1.1.cmml" xref="A2.T3.10.4.4.m1.1.1"><csymbol cd="latexml" id="A2.T3.10.4.4.m1.1.1.1.cmml" xref="A2.T3.10.4.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.10.4.4.m1.1.1.2.cmml" xref="A2.T3.10.4.4.m1.1.1.2">21.8</cn><cn type="float" id="A2.T3.10.4.4.m1.1.1.3.cmml" xref="A2.T3.10.4.4.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.10.4.4.m1.1c">21.8\pm 0.2</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.13.7" class="ltx_tr">
<th id="A2.T3.11.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<span id="A2.T3.11.5.1.1" class="ltx_text">SI-CIFG</span> <math id="A2.T3.11.5.1.m1.1" class="ltx_Math" alttext="9" display="inline"><semantics id="A2.T3.11.5.1.m1.1a"><mn id="A2.T3.11.5.1.m1.1.1" xref="A2.T3.11.5.1.m1.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="A2.T3.11.5.1.m1.1b"><cn type="integer" id="A2.T3.11.5.1.m1.1.1.cmml" xref="A2.T3.11.5.1.m1.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.11.5.1.m1.1c">9</annotation></semantics></math>M</th>
<td id="A2.T3.12.6.2" class="ltx_td ltx_align_center"><math id="A2.T3.12.6.2.m1.1" class="ltx_Math" alttext="\mathbf{42.2\pm 0.2}" display="inline"><semantics id="A2.T3.12.6.2.m1.1a"><mrow id="A2.T3.12.6.2.m1.1.1" xref="A2.T3.12.6.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.12.6.2.m1.1.1.2" xref="A2.T3.12.6.2.m1.1.1.2.cmml">42.2</mn><mo id="A2.T3.12.6.2.m1.1.1.1" xref="A2.T3.12.6.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.12.6.2.m1.1.1.3" xref="A2.T3.12.6.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.12.6.2.m1.1b"><apply id="A2.T3.12.6.2.m1.1.1.cmml" xref="A2.T3.12.6.2.m1.1.1"><csymbol cd="latexml" id="A2.T3.12.6.2.m1.1.1.1.cmml" xref="A2.T3.12.6.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.12.6.2.m1.1.1.2.cmml" xref="A2.T3.12.6.2.m1.1.1.2">42.2</cn><cn type="float" id="A2.T3.12.6.2.m1.1.1.3.cmml" xref="A2.T3.12.6.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.12.6.2.m1.1c">\mathbf{42.2\pm 0.2}</annotation></semantics></math></td>
<td id="A2.T3.13.7.3" class="ltx_td ltx_align_center"><math id="A2.T3.13.7.3.m1.1" class="ltx_Math" alttext="\mathbf{23.4\pm 0.1}" display="inline"><semantics id="A2.T3.13.7.3.m1.1a"><mrow id="A2.T3.13.7.3.m1.1.1" xref="A2.T3.13.7.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.13.7.3.m1.1.1.2" xref="A2.T3.13.7.3.m1.1.1.2.cmml">23.4</mn><mo id="A2.T3.13.7.3.m1.1.1.1" xref="A2.T3.13.7.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A2.T3.13.7.3.m1.1.1.3" xref="A2.T3.13.7.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.13.7.3.m1.1b"><apply id="A2.T3.13.7.3.m1.1.1.cmml" xref="A2.T3.13.7.3.m1.1.1"><csymbol cd="latexml" id="A2.T3.13.7.3.m1.1.1.1.cmml" xref="A2.T3.13.7.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.13.7.3.m1.1.1.2.cmml" xref="A2.T3.13.7.3.m1.1.1.2">23.4</cn><cn type="float" id="A2.T3.13.7.3.m1.1.1.3.cmml" xref="A2.T3.13.7.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.13.7.3.m1.1c">\mathbf{23.4\pm 0.1}</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.16.10" class="ltx_tr">
<th id="A2.T3.14.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">Transformer <math id="A2.T3.14.8.1.m1.1" class="ltx_Math" alttext="11" display="inline"><semantics id="A2.T3.14.8.1.m1.1a"><mn id="A2.T3.14.8.1.m1.1.1" xref="A2.T3.14.8.1.m1.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="A2.T3.14.8.1.m1.1b"><cn type="integer" id="A2.T3.14.8.1.m1.1.1.cmml" xref="A2.T3.14.8.1.m1.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.14.8.1.m1.1c">11</annotation></semantics></math>M</th>
<td id="A2.T3.15.9.2" class="ltx_td ltx_align_center"><math id="A2.T3.15.9.2.m1.1" class="ltx_Math" alttext="63.6\pm 0.9" display="inline"><semantics id="A2.T3.15.9.2.m1.1a"><mrow id="A2.T3.15.9.2.m1.1.1" xref="A2.T3.15.9.2.m1.1.1.cmml"><mn id="A2.T3.15.9.2.m1.1.1.2" xref="A2.T3.15.9.2.m1.1.1.2.cmml">63.6</mn><mo id="A2.T3.15.9.2.m1.1.1.1" xref="A2.T3.15.9.2.m1.1.1.1.cmml">±</mo><mn id="A2.T3.15.9.2.m1.1.1.3" xref="A2.T3.15.9.2.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.15.9.2.m1.1b"><apply id="A2.T3.15.9.2.m1.1.1.cmml" xref="A2.T3.15.9.2.m1.1.1"><csymbol cd="latexml" id="A2.T3.15.9.2.m1.1.1.1.cmml" xref="A2.T3.15.9.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.15.9.2.m1.1.1.2.cmml" xref="A2.T3.15.9.2.m1.1.1.2">63.6</cn><cn type="float" id="A2.T3.15.9.2.m1.1.1.3.cmml" xref="A2.T3.15.9.2.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.15.9.2.m1.1c">63.6\pm 0.9</annotation></semantics></math></td>
<td id="A2.T3.16.10.3" class="ltx_td ltx_align_center"><math id="A2.T3.16.10.3.m1.1" class="ltx_Math" alttext="18.2\pm 0.1" display="inline"><semantics id="A2.T3.16.10.3.m1.1a"><mrow id="A2.T3.16.10.3.m1.1.1" xref="A2.T3.16.10.3.m1.1.1.cmml"><mn id="A2.T3.16.10.3.m1.1.1.2" xref="A2.T3.16.10.3.m1.1.1.2.cmml">18.2</mn><mo id="A2.T3.16.10.3.m1.1.1.1" xref="A2.T3.16.10.3.m1.1.1.1.cmml">±</mo><mn id="A2.T3.16.10.3.m1.1.1.3" xref="A2.T3.16.10.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.16.10.3.m1.1b"><apply id="A2.T3.16.10.3.m1.1.1.cmml" xref="A2.T3.16.10.3.m1.1.1"><csymbol cd="latexml" id="A2.T3.16.10.3.m1.1.1.1.cmml" xref="A2.T3.16.10.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.16.10.3.m1.1.1.2.cmml" xref="A2.T3.16.10.3.m1.1.1.2">18.2</cn><cn type="float" id="A2.T3.16.10.3.m1.1.1.3.cmml" xref="A2.T3.16.10.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.16.10.3.m1.1c">18.2\pm 0.1</annotation></semantics></math></td>
</tr>
<tr id="A2.T3.19.13" class="ltx_tr">
<th id="A2.T3.17.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b">SI Transformer <math id="A2.T3.17.11.1.m1.1" class="ltx_Math" alttext="11" display="inline"><semantics id="A2.T3.17.11.1.m1.1a"><mn id="A2.T3.17.11.1.m1.1.1" xref="A2.T3.17.11.1.m1.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="A2.T3.17.11.1.m1.1b"><cn type="integer" id="A2.T3.17.11.1.m1.1.1.cmml" xref="A2.T3.17.11.1.m1.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.17.11.1.m1.1c">11</annotation></semantics></math>M</th>
<td id="A2.T3.18.12.2" class="ltx_td ltx_align_center ltx_border_b"><math id="A2.T3.18.12.2.m1.1" class="ltx_Math" alttext="44.3\pm 0.7" display="inline"><semantics id="A2.T3.18.12.2.m1.1a"><mrow id="A2.T3.18.12.2.m1.1.1" xref="A2.T3.18.12.2.m1.1.1.cmml"><mn id="A2.T3.18.12.2.m1.1.1.2" xref="A2.T3.18.12.2.m1.1.1.2.cmml">44.3</mn><mo id="A2.T3.18.12.2.m1.1.1.1" xref="A2.T3.18.12.2.m1.1.1.1.cmml">±</mo><mn id="A2.T3.18.12.2.m1.1.1.3" xref="A2.T3.18.12.2.m1.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.18.12.2.m1.1b"><apply id="A2.T3.18.12.2.m1.1.1.cmml" xref="A2.T3.18.12.2.m1.1.1"><csymbol cd="latexml" id="A2.T3.18.12.2.m1.1.1.1.cmml" xref="A2.T3.18.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.18.12.2.m1.1.1.2.cmml" xref="A2.T3.18.12.2.m1.1.1.2">44.3</cn><cn type="float" id="A2.T3.18.12.2.m1.1.1.3.cmml" xref="A2.T3.18.12.2.m1.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.18.12.2.m1.1c">44.3\pm 0.7</annotation></semantics></math></td>
<td id="A2.T3.19.13.3" class="ltx_td ltx_align_center ltx_border_b"><math id="A2.T3.19.13.3.m1.1" class="ltx_Math" alttext="23.2\pm 0.2" display="inline"><semantics id="A2.T3.19.13.3.m1.1a"><mrow id="A2.T3.19.13.3.m1.1.1" xref="A2.T3.19.13.3.m1.1.1.cmml"><mn id="A2.T3.19.13.3.m1.1.1.2" xref="A2.T3.19.13.3.m1.1.1.2.cmml">23.2</mn><mo id="A2.T3.19.13.3.m1.1.1.1" xref="A2.T3.19.13.3.m1.1.1.1.cmml">±</mo><mn id="A2.T3.19.13.3.m1.1.1.3" xref="A2.T3.19.13.3.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T3.19.13.3.m1.1b"><apply id="A2.T3.19.13.3.m1.1.1.cmml" xref="A2.T3.19.13.3.m1.1.1"><csymbol cd="latexml" id="A2.T3.19.13.3.m1.1.1.1.cmml" xref="A2.T3.19.13.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A2.T3.19.13.3.m1.1.1.2.cmml" xref="A2.T3.19.13.3.m1.1.1.2">23.2</cn><cn type="float" id="A2.T3.19.13.3.m1.1.1.3.cmml" xref="A2.T3.19.13.3.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T3.19.13.3.m1.1c">23.2\pm 0.2</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experiments with differentially private federated learning details</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.2" class="ltx_p">For all models and DP experiments with the live English virtual keyboard user population, we used the followed fixed hyperparameters.
Again, due to the nature of live production experiments and longer feedback times, we were not able to run any extensive hyperparameter sweeps and re-used many common settings used in previous experiments.
Table <a href="#A3.T4" title="Table 4 ‣ Appendix C Experiments with differentially private federated learning details ‣ Efficient Language Model Architectures for Differentially Private Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> reports the final evaluation results using these hyperparameters averaged over the final <math id="A3.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A3.p1.1.m1.1a"><mn id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><cn type="integer" id="A3.p1.1.m1.1.1.cmml" xref="A3.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">100</annotation></semantics></math> of <math id="A3.p1.2.m2.1" class="ltx_Math" alttext="3K" display="inline"><semantics id="A3.p1.2.m2.1a"><mrow id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml"><mn id="A3.p1.2.m2.1.1.2" xref="A3.p1.2.m2.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="A3.p1.2.m2.1.1.1" xref="A3.p1.2.m2.1.1.1.cmml">​</mo><mi id="A3.p1.2.m2.1.1.3" xref="A3.p1.2.m2.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1"><times id="A3.p1.2.m2.1.1.1.cmml" xref="A3.p1.2.m2.1.1.1"></times><cn type="integer" id="A3.p1.2.m2.1.1.2.cmml" xref="A3.p1.2.m2.1.1.2">3</cn><ci id="A3.p1.2.m2.1.1.3.cmml" xref="A3.p1.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">3K</annotation></semantics></math> communication rounds to account for daytime variability.</p>
</div>
<div id="A3.p2" class="ltx_para">
<ul id="A3.I1" class="ltx_itemize">
<li id="A3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i1.p1" class="ltx_para">
<p id="A3.I1.i1.p1.1" class="ltx_p">Number of clients per round = <math id="A3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="6500" display="inline"><semantics id="A3.I1.i1.p1.1.m1.1a"><mn id="A3.I1.i1.p1.1.m1.1.1" xref="A3.I1.i1.p1.1.m1.1.1.cmml">6500</mn><annotation-xml encoding="MathML-Content" id="A3.I1.i1.p1.1.m1.1b"><cn type="integer" id="A3.I1.i1.p1.1.m1.1.1.cmml" xref="A3.I1.i1.p1.1.m1.1.1">6500</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i1.p1.1.m1.1c">6500</annotation></semantics></math>: Number of clients sampled per communication round of FL training.</p>
</div>
</li>
<li id="A3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i2.p1" class="ltx_para">
<p id="A3.I1.i2.p1.1" class="ltx_p">Client batch size = <math id="A3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A3.I1.i2.p1.1.m1.1a"><mn id="A3.I1.i2.p1.1.m1.1.1" xref="A3.I1.i2.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A3.I1.i2.p1.1.m1.1b"><cn type="integer" id="A3.I1.i2.p1.1.m1.1.1.cmml" xref="A3.I1.i2.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i2.p1.1.m1.1c">10</annotation></semantics></math>: Batch size used during local steps of training on client data.</p>
</div>
</li>
<li id="A3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i3.p1" class="ltx_para">
<p id="A3.I1.i3.p1.1" class="ltx_p">Clipping norm = <math id="A3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="5.0" display="inline"><semantics id="A3.I1.i3.p1.1.m1.1a"><mn id="A3.I1.i3.p1.1.m1.1.1" xref="A3.I1.i3.p1.1.m1.1.1.cmml">5.0</mn><annotation-xml encoding="MathML-Content" id="A3.I1.i3.p1.1.m1.1b"><cn type="float" id="A3.I1.i3.p1.1.m1.1.1.cmml" xref="A3.I1.i3.p1.1.m1.1.1">5.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i3.p1.1.m1.1c">5.0</annotation></semantics></math>: Fixed L2 norm that client updates are clipped up to.</p>
</div>
</li>
<li id="A3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i4.p1" class="ltx_para">
<p id="A3.I1.i4.p1.1" class="ltx_p">Maximum sequence length = <math id="A3.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A3.I1.i4.p1.1.m1.1a"><mn id="A3.I1.i4.p1.1.m1.1.1" xref="A3.I1.i4.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A3.I1.i4.p1.1.m1.1b"><cn type="integer" id="A3.I1.i4.p1.1.m1.1.1.cmml" xref="A3.I1.i4.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i4.p1.1.m1.1c">10</annotation></semantics></math>: Maximum allowed sequence length. Decreased here since word tokenization is used instead of the typically longer subword tokenization.</p>
</div>
</li>
<li id="A3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i5.p1" class="ltx_para">
<p id="A3.I1.i5.p1.1" class="ltx_p">Client optimizer = SGD with learning rate <math id="A3.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="A3.I1.i5.p1.1.m1.1a"><mn id="A3.I1.i5.p1.1.m1.1.1" xref="A3.I1.i5.p1.1.m1.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="A3.I1.i5.p1.1.m1.1b"><cn type="float" id="A3.I1.i5.p1.1.m1.1.1.cmml" xref="A3.I1.i5.p1.1.m1.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i5.p1.1.m1.1c">0.5</annotation></semantics></math>.</p>
</div>
</li>
<li id="A3.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A3.I1.i6.p1" class="ltx_para">
<p id="A3.I1.i6.p1.2" class="ltx_p">Server optimizer = SGD with momentum with learning rate <math id="A3.I1.i6.p1.1.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="A3.I1.i6.p1.1.m1.1a"><mn id="A3.I1.i6.p1.1.m1.1.1" xref="A3.I1.i6.p1.1.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="A3.I1.i6.p1.1.m1.1b"><cn type="float" id="A3.I1.i6.p1.1.m1.1.1.cmml" xref="A3.I1.i6.p1.1.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i6.p1.1.m1.1c">1.0</annotation></semantics></math> and momentum <math id="A3.I1.i6.p1.2.m2.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="A3.I1.i6.p1.2.m2.1a"><mn id="A3.I1.i6.p1.2.m2.1.1" xref="A3.I1.i6.p1.2.m2.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="A3.I1.i6.p1.2.m2.1b"><cn type="float" id="A3.I1.i6.p1.2.m2.1.1.cmml" xref="A3.I1.i6.p1.2.m2.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.I1.i6.p1.2.m2.1c">0.9</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<figure id="A3.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Perplexity and in-vocab-accuracy from DP live experiments on English virtual keyboard devices averaged with standard deviations over the final <math id="A3.T4.2.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A3.T4.2.m1.1b"><mn id="A3.T4.2.m1.1.1" xref="A3.T4.2.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A3.T4.2.m1.1c"><cn type="integer" id="A3.T4.2.m1.1.1.cmml" xref="A3.T4.2.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.2.m1.1d">100</annotation></semantics></math> communication rounds.</figcaption>
<table id="A3.T4.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T4.8.7.1" class="ltx_tr">
<th id="A3.T4.8.7.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Model</th>
<th id="A3.T4.8.7.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Perplexity</th>
<th id="A3.T4.8.7.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Accuracy%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T4.5.3" class="ltx_tr">
<th id="A3.T4.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">CIFG <math id="A3.T4.3.1.1.m1.1" class="ltx_Math" alttext="6" display="inline"><semantics id="A3.T4.3.1.1.m1.1a"><mn id="A3.T4.3.1.1.m1.1.1" xref="A3.T4.3.1.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A3.T4.3.1.1.m1.1b"><cn type="integer" id="A3.T4.3.1.1.m1.1.1.cmml" xref="A3.T4.3.1.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.3.1.1.m1.1c">6</annotation></semantics></math>M</th>
<td id="A3.T4.4.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="A3.T4.4.2.2.m1.1" class="ltx_Math" alttext="88.0\pm 0.8" display="inline"><semantics id="A3.T4.4.2.2.m1.1a"><mrow id="A3.T4.4.2.2.m1.1.1" xref="A3.T4.4.2.2.m1.1.1.cmml"><mn id="A3.T4.4.2.2.m1.1.1.2" xref="A3.T4.4.2.2.m1.1.1.2.cmml">88.0</mn><mo id="A3.T4.4.2.2.m1.1.1.1" xref="A3.T4.4.2.2.m1.1.1.1.cmml">±</mo><mn id="A3.T4.4.2.2.m1.1.1.3" xref="A3.T4.4.2.2.m1.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T4.4.2.2.m1.1b"><apply id="A3.T4.4.2.2.m1.1.1.cmml" xref="A3.T4.4.2.2.m1.1.1"><csymbol cd="latexml" id="A3.T4.4.2.2.m1.1.1.1.cmml" xref="A3.T4.4.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A3.T4.4.2.2.m1.1.1.2.cmml" xref="A3.T4.4.2.2.m1.1.1.2">88.0</cn><cn type="float" id="A3.T4.4.2.2.m1.1.1.3.cmml" xref="A3.T4.4.2.2.m1.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.4.2.2.m1.1c">88.0\pm 0.8</annotation></semantics></math></td>
<td id="A3.T4.5.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A3.T4.5.3.3.m1.1" class="ltx_Math" alttext="17.3\pm 0.1" display="inline"><semantics id="A3.T4.5.3.3.m1.1a"><mrow id="A3.T4.5.3.3.m1.1.1" xref="A3.T4.5.3.3.m1.1.1.cmml"><mn id="A3.T4.5.3.3.m1.1.1.2" xref="A3.T4.5.3.3.m1.1.1.2.cmml">17.3</mn><mo id="A3.T4.5.3.3.m1.1.1.1" xref="A3.T4.5.3.3.m1.1.1.1.cmml">±</mo><mn id="A3.T4.5.3.3.m1.1.1.3" xref="A3.T4.5.3.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T4.5.3.3.m1.1b"><apply id="A3.T4.5.3.3.m1.1.1.cmml" xref="A3.T4.5.3.3.m1.1.1"><csymbol cd="latexml" id="A3.T4.5.3.3.m1.1.1.1.cmml" xref="A3.T4.5.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A3.T4.5.3.3.m1.1.1.2.cmml" xref="A3.T4.5.3.3.m1.1.1.2">17.3</cn><cn type="float" id="A3.T4.5.3.3.m1.1.1.3.cmml" xref="A3.T4.5.3.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.5.3.3.m1.1c">17.3\pm 0.1</annotation></semantics></math></td>
</tr>
<tr id="A3.T4.8.6" class="ltx_tr">
<th id="A3.T4.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b">
<span id="A3.T4.6.4.1.1" class="ltx_text">SI-CIFG</span> <math id="A3.T4.6.4.1.m1.1" class="ltx_Math" alttext="6" display="inline"><semantics id="A3.T4.6.4.1.m1.1a"><mn id="A3.T4.6.4.1.m1.1.1" xref="A3.T4.6.4.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A3.T4.6.4.1.m1.1b"><cn type="integer" id="A3.T4.6.4.1.m1.1.1.cmml" xref="A3.T4.6.4.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.6.4.1.m1.1c">6</annotation></semantics></math>M</th>
<td id="A3.T4.7.5.2" class="ltx_td ltx_align_center ltx_border_b"><math id="A3.T4.7.5.2.m1.1" class="ltx_Math" alttext="\mathbf{86.1\pm 0.7}" display="inline"><semantics id="A3.T4.7.5.2.m1.1a"><mrow id="A3.T4.7.5.2.m1.1.1" xref="A3.T4.7.5.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A3.T4.7.5.2.m1.1.1.2" xref="A3.T4.7.5.2.m1.1.1.2.cmml">86.1</mn><mo id="A3.T4.7.5.2.m1.1.1.1" xref="A3.T4.7.5.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A3.T4.7.5.2.m1.1.1.3" xref="A3.T4.7.5.2.m1.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T4.7.5.2.m1.1b"><apply id="A3.T4.7.5.2.m1.1.1.cmml" xref="A3.T4.7.5.2.m1.1.1"><csymbol cd="latexml" id="A3.T4.7.5.2.m1.1.1.1.cmml" xref="A3.T4.7.5.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A3.T4.7.5.2.m1.1.1.2.cmml" xref="A3.T4.7.5.2.m1.1.1.2">86.1</cn><cn type="float" id="A3.T4.7.5.2.m1.1.1.3.cmml" xref="A3.T4.7.5.2.m1.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.7.5.2.m1.1c">\mathbf{86.1\pm 0.7}</annotation></semantics></math></td>
<td id="A3.T4.8.6.3" class="ltx_td ltx_align_center ltx_border_b"><math id="A3.T4.8.6.3.m1.1" class="ltx_Math" alttext="\mathbf{17.5\pm 0.1}" display="inline"><semantics id="A3.T4.8.6.3.m1.1a"><mrow id="A3.T4.8.6.3.m1.1.1" xref="A3.T4.8.6.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A3.T4.8.6.3.m1.1.1.2" xref="A3.T4.8.6.3.m1.1.1.2.cmml">17.5</mn><mo id="A3.T4.8.6.3.m1.1.1.1" xref="A3.T4.8.6.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="A3.T4.8.6.3.m1.1.1.3" xref="A3.T4.8.6.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T4.8.6.3.m1.1b"><apply id="A3.T4.8.6.3.m1.1.1.cmml" xref="A3.T4.8.6.3.m1.1.1"><csymbol cd="latexml" id="A3.T4.8.6.3.m1.1.1.1.cmml" xref="A3.T4.8.6.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="A3.T4.8.6.3.m1.1.1.2.cmml" xref="A3.T4.8.6.3.m1.1.1.2">17.5</cn><cn type="float" id="A3.T4.8.6.3.m1.1.1.3.cmml" xref="A3.T4.8.6.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.8.6.3.m1.1c">\mathbf{17.5\pm 0.1}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.08099" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.08100" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.08100">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.08100" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.08101" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 16:06:05 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
