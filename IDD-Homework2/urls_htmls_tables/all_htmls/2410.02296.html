<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Language Models are Graph Learners</title>
<!--Generated on Thu Oct  3 08:25:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02296v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S1" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S2" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS1" title="In 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Retrieval-Based Aggregation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS2" title="In 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Classifier Guidance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS3" title="In 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Overall template</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS4" title="In 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS5" title="In 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Model complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.SS1" title="In 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Setup and Implementation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.SS2" title="In 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Comparison with state-of-the-art</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.SS3" title="In 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.SS4" title="In 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Multi-Task Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S6" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A1" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Architecture and Training of the Graph Neural Network <math alttext="\psi" class="ltx_Math" display="inline"><semantics><mi>Ïˆ</mi><annotation-xml encoding="MathML-Content"><ci>ğœ“</ci></annotation-xml><annotation encoding="application/x-tex">\psi</annotation><annotation encoding="application/x-llamapun">italic_Ïˆ</annotation></semantics></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A2" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Interpretation of the distribution matching loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A3" title="In Language Models are Graph Learners"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Templates</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Language Models are Graph Learners</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhe Xu<sup class="ltx_sup" id="id13.13.id1"><span class="ltx_text ltx_font_italic" id="id13.13.id1.1">â‹†,â€ </span></sup>, Kaveh Hassani<sup class="ltx_sup" id="id14.14.id2"><span class="ltx_text ltx_font_italic" id="id14.14.id2.1">â‹†</span></sup>, Si Zhang<sup class="ltx_sup" id="id15.15.id3"><span class="ltx_text ltx_font_italic" id="id15.15.id3.1">â‹†</span></sup>, Hanqing Zeng<sup class="ltx_sup" id="id16.16.id4"><span class="ltx_text ltx_font_italic" id="id16.16.id4.1">â‹†</span></sup>, Michihiro Yasunaga<sup class="ltx_sup" id="id17.17.id5"><span class="ltx_text ltx_font_italic" id="id17.17.id5.1">â‹†</span></sup>, Limei Wang<sup class="ltx_sup" id="id18.18.id6"><span class="ltx_text ltx_font_italic" id="id18.18.id6.1">â‹†</span></sup>, 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id7.7.1">Dongqi Fu<sup class="ltx_sup" id="id7.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.1.1.1">â‹†</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id8.8.2">Ning Yao<sup class="ltx_sup" id="id8.8.2.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.2.1.1">â‹†</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id9.9.3">Bo Long<sup class="ltx_sup" id="id9.9.3.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id9.9.3.1.1">â‹†</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id10.10.4">Hanghang Tong<sup class="ltx_sup" id="id10.10.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id10.10.4.1.1">â€ </span></sup></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id19.19.id7"><span class="ltx_text ltx_font_italic" id="id19.19.id7.1">â‹†</span></sup>Meta AI, <sup class="ltx_sup" id="id20.20.id8"><span class="ltx_text ltx_font_italic" id="id20.20.id8.1">â€ </span></sup>University of Illinois Urbana-Champaign. Corresponding: zhexu3@illinois.edu
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id21.id1">Language Models (LMs) are increasingly challenging the dominance of domain-specific models, including Graph Neural Networks (GNNs) and Graph Transformers (GTs), in graph learning tasks. Following this trend, we propose a novel approach that empowers off-the-shelf LMs to achieve performance comparable to state-of-the-art GNNs on node classification tasks, without requiring any architectural modification. By preserving the LMâ€™s original architecture, our approach retains a key benefit of LM instruction tuning: the ability to jointly train on diverse datasets, fostering greater flexibility and efficiency. To achieve this, we introduce two key augmentation strategies: (1) Enriching LMsâ€™ input using topological and semantic retrieval methods, which provide richer contextual information, and (2) guiding the LMsâ€™ classification process through a lightweight GNN classifier that effectively prunes class candidates. Our experiments on real-world datasets show that backbone Flan-T5 models equipped with these augmentation strategies outperform state-of-the-art text-output node classifiers and are comparable to top-performing vector-output node classifiers. By bridging the gap between specialized task-specific node classifiers and general LMs, this work paves the way for more versatile and widely applicable graph learning models. We will open-source the code upon publication.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">There is a growing trend of utilizing Language Models (LMs) for machine learning tasks across diverse domains. This approach has shown tremendous promise in areas such as computer visionÂ <cite class="ltx_cite ltx_citemacro_citep">(Desai &amp; Johnson, <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib14" title="">2021</a>)</cite>, audio processingÂ <cite class="ltx_cite ltx_citemacro_citep">(Mittal etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib38" title="">2021</a>)</cite>, and multimodal learningÂ <cite class="ltx_cite ltx_citemacro_citep">(Alayrac etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib1" title="">2022</a>)</cite>. In the domain of graph learning, recent efforts have begun to explore the capabilities of LMs in understanding and processing graph structures. <cite class="ltx_cite ltx_citemacro_cite">Wang etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib47" title="">2023</a>)</cite> showed that LMs can detect node connectivity and identify cycles within graphs, while <cite class="ltx_cite ltx_citemacro_cite">Fatemi etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib16" title="">2024</a>)</cite> explored LMsâ€™ ability to evaluate graph scale and identify connected components. Furthermore, InstructGLMÂ <cite class="ltx_cite ltx_citemacro_citep">(Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>)</cite> achieved state-of-the-art performance in text-output node classifiers for Text-Attributed Graphs (TAG)Â <cite class="ltx_cite ltx_citemacro_citep">(Zhang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib53" title="">2024a</a>)</cite>, where each node is associated with textual information.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, InstructGLM suffers from a fundamental limitation that compromises the generality of the backbone LM. Specifically, InstructGLM expands the LMâ€™s vocabulary by creating unique tokens for each node, which incorporates topology-aware node embeddings as token embeddings. While this approach is effective, it comes at the cost of reducing the LMâ€™s versatility, making it incompatible with two important use cases: (1) multi-task learning on diverse datasets, a common strategy for training Foundational ModelsÂ <cite class="ltx_cite ltx_citemacro_citep">(Wei etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib49" title="">2022</a>; Chung etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib13" title="">2024</a>)</cite>, and (2) certain personalized LM fine-tuning servicesÂ <cite class="ltx_cite ltx_citemacro_citep">(Li etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib35" title="">2024b</a>)</cite> that restrict modifications to the backbone model architecture. This limitation raises a crucial question: <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">How can off-the-shelf, text-to-text instruction-tuned LMsÂ <cite class="ltx_cite ltx_citemacro_citep">(Raffel etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib41" title="">2020</a>)</cite> achieve competitive performance in node classification tasks without requiring architectural modifications?</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In stark contrast to <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib25" title="">2023</a>)</cite>, which suggests that LMs may only interpret graph structures in prompts as contextual paragraphs, our work presents a more optimistic outlook. We aim to overcome this inherent limitation by augmenting the input to LMs while preserving their original architecture. Our proposed model, named <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.1">AugGLMÂ </span>Â (<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.1.2">Aug</span>mented <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.1.3">G</span>raph <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.1.4">L</span>anguage <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.1.5">M</span>odel), leverages two key augmentation strategies to enhance the LMâ€™s ability to process graph data as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Relevant Node Retrieval</span>: In contrast to InstructGLM, which relies on multi-hop ego networks akin to message-passing GNNs for structure-aware contextualization, <span class="ltx_text ltx_font_smallcaps" id="S1.I1.i1.p1.1.2">AugGLMÂ </span>draws inspiration from Graph Transformers (GTs)Â <cite class="ltx_cite ltx_citemacro_citep">(Min etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib37" title="">2022</a>)</cite> and Retrieval-Augmented Generation (RAG)Â <cite class="ltx_cite ltx_citemacro_citep">(Lewis etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib32" title="">2020</a>; Guu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib18" title="">2020</a>)</cite>. This enables the LM to access long-range structural and semantic information about the target node. We propose two complementary approaches to achieve this: (1) topological retrieval, and (2) prototypical semantic retrieval.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Candidate Label Pruning</span>: To improve LMsâ€™ understanding of graph data while maintaining their text-to-text architecture, we convey the guidance from a specialist model, a pretrained lightweight GNN, to the input of LMs via narrowing down the potential labels. This allows LMs to focus on discerning between closely related candidates, ultimately enhancing the performance.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p3.2">We conduct an extensive evaluation of our approach on four real-world TAGs, showing the effectiveness of our proposed instruction fine-tuning strategy. The results indicate that backbone LMs augmented with <span class="ltx_text ltx_font_smallcaps" id="S1.p3.2.1">AugGLMÂ </span>significantly outperform InstructGLM, while also matching or surpassing the performance of state-of-the-art vector-output classifiers. These findings represent a crucial step towards bridging the gap between specialized task-specific node classifiers and more general, fine-tuned LMs, highlighting the potential for unified models that can excel across multiple tasks.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">LMs for Graphs</span>.
Recent studies have explored the ability of LMs to understand graph topology by investigating problems such as graph substructure recallÂ <cite class="ltx_cite ltx_citemacro_citep">(Wang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib48" title="">2024</a>)</cite>, circle and connectivity detectionÂ <cite class="ltx_cite ltx_citemacro_citep">(Wang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib47" title="">2023</a>)</cite>, spatial-temporal problems on dynamic graphsÂ <cite class="ltx_cite ltx_citemacro_citep">(Zhang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib55" title="">2024b</a>)</cite>. Notably, <cite class="ltx_cite ltx_citemacro_cite">Fatemi etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib16" title="">2024</a>)</cite> found that the presentation format of graph data in text significantly impacts performance across various tasks, highlighting the importance of effective graph-to-text encoding. Building on these findings, several studies have explored classification tasks on TAGs, including node classificationÂ <cite class="ltx_cite ltx_citemacro_citep">(Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>; Zhao etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib57" title="">2023b</a>; Li etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib34" title="">2024a</a>; Qin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib40" title="">2023</a>)</cite>, link predictionÂ <cite class="ltx_cite ltx_citemacro_citep">(Brannon etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib6" title="">2023</a>; Tan etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib45" title="">2024</a>)</cite>, and transfer learningÂ <cite class="ltx_cite ltx_citemacro_citep">(Tang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib46" title="">2024</a>)</cite>. Furthermore, Â <cite class="ltx_cite ltx_citemacro_cite">Zhang (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib54" title="">2023</a>)</cite> proposed Graph-ToolFormer, a framework that enhances LMs with graph reasoning API tools, thereby enabling more complex graph reasoning tasks. GIANTÂ <cite class="ltx_cite ltx_citemacro_citep">(Chien etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib11" title="">2022</a>)</cite> and GLEMÂ <cite class="ltx_cite ltx_citemacro_citep">(Zhao etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib56" title="">2023a</a>)</cite> utilize the interaction between graph data and LMs to generate better graph representations. TAPEÂ <cite class="ltx_cite ltx_citemacro_citep">(He etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib23" title="">2024</a>)</cite> leverages the explanations generated by an LLM to enrich the textual features, which are then used to fine-tune two LMs. The features from these LMs are subsequently passed through an ensemble of GNNs for final prediction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Retrieval-Augmented Generation (RAG).</span>
Â <cite class="ltx_cite ltx_citemacro_citep">(Lewis etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib32" title="">2020</a>; Karpukhin etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib28" title="">2020</a>)</cite> enhance LMs by granting them access to external knowledgeÂ <cite class="ltx_cite ltx_citemacro_citep">(Hashimoto etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib20" title="">2018</a>)</cite> during text generation. This technique involves retrieving relevant documents from a large corpus and conditioning the LM on both the input query and the retrieved information. Building on this, REALMÂ <cite class="ltx_cite ltx_citemacro_cite">Guu etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib18" title="">2020</a>)</cite> pretrains the retriever and generator end-to-end. Subsequently, RETROÂ <cite class="ltx_cite ltx_citemacro_cite">Borgeaud etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib5" title="">2022</a>)</cite> efficiently scales retrieval-enhanced autoregressive to large datasets. A crucial component of RAGâ€™s success is the loss function proposed byÂ <cite class="ltx_cite ltx_citemacro_cite">Shi etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib43" title="">2023</a>)</cite> which enables the retriever to be trained with the LM viewed as a black box. HyDEÂ <cite class="ltx_cite ltx_citemacro_cite">Yu etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib52" title="">2023</a>)</cite> uses hypothetical document generation to improve retrieval in RAG systems. Furthermore, RAG has extended to multimodal settingsÂ <cite class="ltx_cite ltx_citemacro_cite">Yasunaga etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib50" title="">2023</a>)</cite>. Recently, GraphRAGÂ <cite class="ltx_cite ltx_citemacro_citep">(Edge etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib15" title="">2024</a>)</cite> has garnered significant attention which involves constructing a Knowledge Graph (KG) and then generating responses based on the summaries of communities derived from KG. These advancements have significantly improved the factual accuracy and contextual relevance of generated text, solidifying RAG as a promising technique for various applications, including question answering and open-domain dialogue systems.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.5">We use the following notation conventions: bold lower-case letters (e.g,. <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">ğ±</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">ğ±</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">bold_x</annotation></semantics></math>) denote column vectors, bold upper-case letters (e.g., <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">ğ—</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">ğ—</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">bold_X</annotation></semantics></math>) denote matrices, and calligraphic upper-case letters (e.g., <math alttext="\mathcal{X}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">ğ’³</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">ğ’³</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">caligraphic_X</annotation></semantics></math>) denote sets. We use <math alttext="[\cdot]" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.2.2" xref="S3.p1.4.m4.1.2.1.cmml"><mo id="S3.p1.4.m4.1.2.2.1" stretchy="false" xref="S3.p1.4.m4.1.2.1.1.cmml">[</mo><mo id="S3.p1.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.p1.4.m4.1.1.cmml">â‹…</mo><mo id="S3.p1.4.m4.1.2.2.2" stretchy="false" xref="S3.p1.4.m4.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.2.1.cmml" xref="S3.p1.4.m4.1.2.2"><csymbol cd="latexml" id="S3.p1.4.m4.1.2.1.1.cmml" xref="S3.p1.4.m4.1.2.2.1">delimited-[]</csymbol><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">[ â‹… ]</annotation></semantics></math> and <math alttext="[\cdot,\cdot]" class="ltx_Math" display="inline" id="S3.p1.5.m5.2"><semantics id="S3.p1.5.m5.2a"><mrow id="S3.p1.5.m5.2.3.2" xref="S3.p1.5.m5.2.3.1.cmml"><mo id="S3.p1.5.m5.2.3.2.1" stretchy="false" xref="S3.p1.5.m5.2.3.1.cmml">[</mo><mo id="S3.p1.5.m5.1.1" lspace="0em" rspace="0em" xref="S3.p1.5.m5.1.1.cmml">â‹…</mo><mo id="S3.p1.5.m5.2.3.2.2" rspace="0em" xref="S3.p1.5.m5.2.3.1.cmml">,</mo><mo id="S3.p1.5.m5.2.2" lspace="0em" rspace="0em" xref="S3.p1.5.m5.2.2.cmml">â‹…</mo><mo id="S3.p1.5.m5.2.3.2.3" stretchy="false" xref="S3.p1.5.m5.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.2b"><interval closure="closed" id="S3.p1.5.m5.2.3.1.cmml" xref="S3.p1.5.m5.2.3.2"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">â‹…</ci><ci id="S3.p1.5.m5.2.2.cmml" xref="S3.p1.5.m5.2.2">â‹…</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.2c">[\cdot,\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.2d">[ â‹… , â‹… ]</annotation></semantics></math> to index vectors and matrices, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.18">We consider the node classification problem on TAGs where each node is associated with textual attributes. A TAG with <math alttext="n" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_n</annotation></semantics></math> nodes is formally represented as <math alttext="\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{T})" class="ltx_Math" display="inline" id="S3.p2.2.m2.3"><semantics id="S3.p2.2.m2.3a"><mrow id="S3.p2.2.m2.3.4" xref="S3.p2.2.m2.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.3.4.2" xref="S3.p2.2.m2.3.4.2.cmml">ğ’¢</mi><mo id="S3.p2.2.m2.3.4.1" xref="S3.p2.2.m2.3.4.1.cmml">=</mo><mrow id="S3.p2.2.m2.3.4.3.2" xref="S3.p2.2.m2.3.4.3.1.cmml"><mo id="S3.p2.2.m2.3.4.3.2.1" stretchy="false" xref="S3.p2.2.m2.3.4.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">ğ’±</mi><mo id="S3.p2.2.m2.3.4.3.2.2" xref="S3.p2.2.m2.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.2.2" xref="S3.p2.2.m2.2.2.cmml">â„°</mi><mo id="S3.p2.2.m2.3.4.3.2.3" xref="S3.p2.2.m2.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.3.3" xref="S3.p2.2.m2.3.3.cmml">ğ’¯</mi><mo id="S3.p2.2.m2.3.4.3.2.4" stretchy="false" xref="S3.p2.2.m2.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.3b"><apply id="S3.p2.2.m2.3.4.cmml" xref="S3.p2.2.m2.3.4"><eq id="S3.p2.2.m2.3.4.1.cmml" xref="S3.p2.2.m2.3.4.1"></eq><ci id="S3.p2.2.m2.3.4.2.cmml" xref="S3.p2.2.m2.3.4.2">ğ’¢</ci><vector id="S3.p2.2.m2.3.4.3.1.cmml" xref="S3.p2.2.m2.3.4.3.2"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">ğ’±</ci><ci id="S3.p2.2.m2.2.2.cmml" xref="S3.p2.2.m2.2.2">â„°</ci><ci id="S3.p2.2.m2.3.3.cmml" xref="S3.p2.2.m2.3.3">ğ’¯</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.3c">\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{T})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.3d">caligraphic_G = ( caligraphic_V , caligraphic_E , caligraphic_T )</annotation></semantics></math>, where <math alttext="\mathcal{V}=\{v_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">ğ’±</mi><mo id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">=</mo><msubsup id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml"><mrow id="S3.p2.3.m3.1.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.2.cmml"><mo id="S3.p2.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.p2.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S3.p2.3.m3.1.1.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.3.m3.1.1.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.p2.3.m3.1.1.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.p2.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p2.3.m3.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.1.1.3.2" xref="S3.p2.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="S3.p2.3.m3.1.1.1.1.3.1" xref="S3.p2.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S3.p2.3.m3.1.1.1.1.3.3" xref="S3.p2.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p2.3.m3.1.1.1.3" xref="S3.p2.3.m3.1.1.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><eq id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2"></eq><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">ğ’±</ci><apply id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1">superscript</csymbol><apply id="S3.p2.3.m3.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1">subscript</csymbol><set id="S3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1"><apply id="S3.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.1.2">ğ‘£</ci><ci id="S3.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></set><apply id="S3.p2.3.m3.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.3"><eq id="S3.p2.3.m3.1.1.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.1.1.3.1"></eq><ci id="S3.p2.3.m3.1.1.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.1.1.3.2">ğ‘–</ci><cn id="S3.p2.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S3.p2.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p2.3.m3.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathcal{V}=\{v_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">caligraphic_V = { italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> denotes a set of nodes, and <math alttext="\mathcal{E}=\{e_{ij}\}_{i,j=1}^{n}" class="ltx_Math" display="inline" id="S3.p2.4.m4.3"><semantics id="S3.p2.4.m4.3a"><mrow id="S3.p2.4.m4.3.3" xref="S3.p2.4.m4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.3.3.3" xref="S3.p2.4.m4.3.3.3.cmml">â„°</mi><mo id="S3.p2.4.m4.3.3.2" xref="S3.p2.4.m4.3.3.2.cmml">=</mo><msubsup id="S3.p2.4.m4.3.3.1" xref="S3.p2.4.m4.3.3.1.cmml"><mrow id="S3.p2.4.m4.3.3.1.1.1.1" xref="S3.p2.4.m4.3.3.1.1.1.2.cmml"><mo id="S3.p2.4.m4.3.3.1.1.1.1.2" stretchy="false" xref="S3.p2.4.m4.3.3.1.1.1.2.cmml">{</mo><msub id="S3.p2.4.m4.3.3.1.1.1.1.1" xref="S3.p2.4.m4.3.3.1.1.1.1.1.cmml"><mi id="S3.p2.4.m4.3.3.1.1.1.1.1.2" xref="S3.p2.4.m4.3.3.1.1.1.1.1.2.cmml">e</mi><mrow id="S3.p2.4.m4.3.3.1.1.1.1.1.3" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3.cmml"><mi id="S3.p2.4.m4.3.3.1.1.1.1.1.3.2" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.p2.4.m4.3.3.1.1.1.1.1.3.1" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3.1.cmml">â¢</mo><mi id="S3.p2.4.m4.3.3.1.1.1.1.1.3.3" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.p2.4.m4.3.3.1.1.1.1.3" stretchy="false" xref="S3.p2.4.m4.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p2.4.m4.2.2.2" xref="S3.p2.4.m4.2.2.2.cmml"><mrow id="S3.p2.4.m4.2.2.2.4.2" xref="S3.p2.4.m4.2.2.2.4.1.cmml"><mi id="S3.p2.4.m4.1.1.1.1" xref="S3.p2.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.p2.4.m4.2.2.2.4.2.1" xref="S3.p2.4.m4.2.2.2.4.1.cmml">,</mo><mi id="S3.p2.4.m4.2.2.2.2" xref="S3.p2.4.m4.2.2.2.2.cmml">j</mi></mrow><mo id="S3.p2.4.m4.2.2.2.3" xref="S3.p2.4.m4.2.2.2.3.cmml">=</mo><mn id="S3.p2.4.m4.2.2.2.5" xref="S3.p2.4.m4.2.2.2.5.cmml">1</mn></mrow><mi id="S3.p2.4.m4.3.3.1.3" xref="S3.p2.4.m4.3.3.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.3b"><apply id="S3.p2.4.m4.3.3.cmml" xref="S3.p2.4.m4.3.3"><eq id="S3.p2.4.m4.3.3.2.cmml" xref="S3.p2.4.m4.3.3.2"></eq><ci id="S3.p2.4.m4.3.3.3.cmml" xref="S3.p2.4.m4.3.3.3">â„°</ci><apply id="S3.p2.4.m4.3.3.1.cmml" xref="S3.p2.4.m4.3.3.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.3.3.1.2.cmml" xref="S3.p2.4.m4.3.3.1">superscript</csymbol><apply id="S3.p2.4.m4.3.3.1.1.cmml" xref="S3.p2.4.m4.3.3.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.3.3.1.1.2.cmml" xref="S3.p2.4.m4.3.3.1">subscript</csymbol><set id="S3.p2.4.m4.3.3.1.1.1.2.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1"><apply id="S3.p2.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.4.m4.3.3.1.1.1.1.1.2.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1.1.2">ğ‘’</ci><apply id="S3.p2.4.m4.3.3.1.1.1.1.1.3.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3"><times id="S3.p2.4.m4.3.3.1.1.1.1.1.3.1.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3.1"></times><ci id="S3.p2.4.m4.3.3.1.1.1.1.1.3.2.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3.2">ğ‘–</ci><ci id="S3.p2.4.m4.3.3.1.1.1.1.1.3.3.cmml" xref="S3.p2.4.m4.3.3.1.1.1.1.1.3.3">ğ‘—</ci></apply></apply></set><apply id="S3.p2.4.m4.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2"><eq id="S3.p2.4.m4.2.2.2.3.cmml" xref="S3.p2.4.m4.2.2.2.3"></eq><list id="S3.p2.4.m4.2.2.2.4.1.cmml" xref="S3.p2.4.m4.2.2.2.4.2"><ci id="S3.p2.4.m4.1.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1.1">ğ‘–</ci><ci id="S3.p2.4.m4.2.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2.2">ğ‘—</ci></list><cn id="S3.p2.4.m4.2.2.2.5.cmml" type="integer" xref="S3.p2.4.m4.2.2.2.5">1</cn></apply></apply><ci id="S3.p2.4.m4.3.3.1.3.cmml" xref="S3.p2.4.m4.3.3.1.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.3c">\mathcal{E}=\{e_{ij}\}_{i,j=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.3d">caligraphic_E = { italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i , italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> is a set of edges where <math alttext="e_{ij}=1" class="ltx_Math" display="inline" id="S3.p2.5.m5.1"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><msub id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml"><mi id="S3.p2.5.m5.1.1.2.2" xref="S3.p2.5.m5.1.1.2.2.cmml">e</mi><mrow id="S3.p2.5.m5.1.1.2.3" xref="S3.p2.5.m5.1.1.2.3.cmml"><mi id="S3.p2.5.m5.1.1.2.3.2" xref="S3.p2.5.m5.1.1.2.3.2.cmml">i</mi><mo id="S3.p2.5.m5.1.1.2.3.1" xref="S3.p2.5.m5.1.1.2.3.1.cmml">â¢</mo><mi id="S3.p2.5.m5.1.1.2.3.3" xref="S3.p2.5.m5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><eq id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1"></eq><apply id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.2.1.cmml" xref="S3.p2.5.m5.1.1.2">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.2.cmml" xref="S3.p2.5.m5.1.1.2.2">ğ‘’</ci><apply id="S3.p2.5.m5.1.1.2.3.cmml" xref="S3.p2.5.m5.1.1.2.3"><times id="S3.p2.5.m5.1.1.2.3.1.cmml" xref="S3.p2.5.m5.1.1.2.3.1"></times><ci id="S3.p2.5.m5.1.1.2.3.2.cmml" xref="S3.p2.5.m5.1.1.2.3.2">ğ‘–</ci><ci id="S3.p2.5.m5.1.1.2.3.3.cmml" xref="S3.p2.5.m5.1.1.2.3.3">ğ‘—</ci></apply></apply><cn id="S3.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">e_{ij}=1</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math> indicates that nodes <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.p2.6.m6.1"><semantics id="S3.p2.6.m6.1a"><msub id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">v</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">ğ‘£</ci><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S3.p2.7.m7.1"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">v</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">ğ‘£</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are connected; otherwise, <math alttext="e_{ij}=0" class="ltx_Math" display="inline" id="S3.p2.8.m8.1"><semantics id="S3.p2.8.m8.1a"><mrow id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><msub id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml"><mi id="S3.p2.8.m8.1.1.2.2" xref="S3.p2.8.m8.1.1.2.2.cmml">e</mi><mrow id="S3.p2.8.m8.1.1.2.3" xref="S3.p2.8.m8.1.1.2.3.cmml"><mi id="S3.p2.8.m8.1.1.2.3.2" xref="S3.p2.8.m8.1.1.2.3.2.cmml">i</mi><mo id="S3.p2.8.m8.1.1.2.3.1" xref="S3.p2.8.m8.1.1.2.3.1.cmml">â¢</mo><mi id="S3.p2.8.m8.1.1.2.3.3" xref="S3.p2.8.m8.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.p2.8.m8.1.1.1" xref="S3.p2.8.m8.1.1.1.cmml">=</mo><mn id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><eq id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1"></eq><apply id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.2.1.cmml" xref="S3.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.2.cmml" xref="S3.p2.8.m8.1.1.2.2">ğ‘’</ci><apply id="S3.p2.8.m8.1.1.2.3.cmml" xref="S3.p2.8.m8.1.1.2.3"><times id="S3.p2.8.m8.1.1.2.3.1.cmml" xref="S3.p2.8.m8.1.1.2.3.1"></times><ci id="S3.p2.8.m8.1.1.2.3.2.cmml" xref="S3.p2.8.m8.1.1.2.3.2">ğ‘–</ci><ci id="S3.p2.8.m8.1.1.2.3.3.cmml" xref="S3.p2.8.m8.1.1.2.3.3">ğ‘—</ci></apply></apply><cn id="S3.p2.8.m8.1.1.3.cmml" type="integer" xref="S3.p2.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">e_{ij}=0</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m8.1d">italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 0</annotation></semantics></math>. <math alttext="\mathcal{T}=\{t_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S3.p2.9.m9.1"><semantics id="S3.p2.9.m9.1a"><mrow id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.9.m9.1.1.3" xref="S3.p2.9.m9.1.1.3.cmml">ğ’¯</mi><mo id="S3.p2.9.m9.1.1.2" xref="S3.p2.9.m9.1.1.2.cmml">=</mo><msubsup id="S3.p2.9.m9.1.1.1" xref="S3.p2.9.m9.1.1.1.cmml"><mrow id="S3.p2.9.m9.1.1.1.1.1.1" xref="S3.p2.9.m9.1.1.1.1.1.2.cmml"><mo id="S3.p2.9.m9.1.1.1.1.1.1.2" stretchy="false" xref="S3.p2.9.m9.1.1.1.1.1.2.cmml">{</mo><msub id="S3.p2.9.m9.1.1.1.1.1.1.1" xref="S3.p2.9.m9.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.9.m9.1.1.1.1.1.1.1.2" xref="S3.p2.9.m9.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S3.p2.9.m9.1.1.1.1.1.1.1.3" xref="S3.p2.9.m9.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.9.m9.1.1.1.1.1.1.3" stretchy="false" xref="S3.p2.9.m9.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p2.9.m9.1.1.1.1.3" xref="S3.p2.9.m9.1.1.1.1.3.cmml"><mi id="S3.p2.9.m9.1.1.1.1.3.2" xref="S3.p2.9.m9.1.1.1.1.3.2.cmml">i</mi><mo id="S3.p2.9.m9.1.1.1.1.3.1" xref="S3.p2.9.m9.1.1.1.1.3.1.cmml">=</mo><mn id="S3.p2.9.m9.1.1.1.1.3.3" xref="S3.p2.9.m9.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p2.9.m9.1.1.1.3" xref="S3.p2.9.m9.1.1.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><apply id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1"><eq id="S3.p2.9.m9.1.1.2.cmml" xref="S3.p2.9.m9.1.1.2"></eq><ci id="S3.p2.9.m9.1.1.3.cmml" xref="S3.p2.9.m9.1.1.3">ğ’¯</ci><apply id="S3.p2.9.m9.1.1.1.cmml" xref="S3.p2.9.m9.1.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.2.cmml" xref="S3.p2.9.m9.1.1.1">superscript</csymbol><apply id="S3.p2.9.m9.1.1.1.1.cmml" xref="S3.p2.9.m9.1.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.1.2.cmml" xref="S3.p2.9.m9.1.1.1">subscript</csymbol><set id="S3.p2.9.m9.1.1.1.1.1.2.cmml" xref="S3.p2.9.m9.1.1.1.1.1.1"><apply id="S3.p2.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.p2.9.m9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.9.m9.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.9.m9.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.9.m9.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="S3.p2.9.m9.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.9.m9.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></set><apply id="S3.p2.9.m9.1.1.1.1.3.cmml" xref="S3.p2.9.m9.1.1.1.1.3"><eq id="S3.p2.9.m9.1.1.1.1.3.1.cmml" xref="S3.p2.9.m9.1.1.1.1.3.1"></eq><ci id="S3.p2.9.m9.1.1.1.1.3.2.cmml" xref="S3.p2.9.m9.1.1.1.1.3.2">ğ‘–</ci><cn id="S3.p2.9.m9.1.1.1.1.3.3.cmml" type="integer" xref="S3.p2.9.m9.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p2.9.m9.1.1.1.3.cmml" xref="S3.p2.9.m9.1.1.1.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">\mathcal{T}=\{t_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m9.1d">caligraphic_T = { italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> indicates the set of node textual attributes. The edges can also be represented by an adjacency matrix <math alttext="\mathbf{A}\in\{0,1\}^{n\times n}" class="ltx_Math" display="inline" id="S3.p2.10.m10.2"><semantics id="S3.p2.10.m10.2a"><mrow id="S3.p2.10.m10.2.3" xref="S3.p2.10.m10.2.3.cmml"><mi id="S3.p2.10.m10.2.3.2" xref="S3.p2.10.m10.2.3.2.cmml">ğ€</mi><mo id="S3.p2.10.m10.2.3.1" xref="S3.p2.10.m10.2.3.1.cmml">âˆˆ</mo><msup id="S3.p2.10.m10.2.3.3" xref="S3.p2.10.m10.2.3.3.cmml"><mrow id="S3.p2.10.m10.2.3.3.2.2" xref="S3.p2.10.m10.2.3.3.2.1.cmml"><mo id="S3.p2.10.m10.2.3.3.2.2.1" stretchy="false" xref="S3.p2.10.m10.2.3.3.2.1.cmml">{</mo><mn id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml">0</mn><mo id="S3.p2.10.m10.2.3.3.2.2.2" xref="S3.p2.10.m10.2.3.3.2.1.cmml">,</mo><mn id="S3.p2.10.m10.2.2" xref="S3.p2.10.m10.2.2.cmml">1</mn><mo id="S3.p2.10.m10.2.3.3.2.2.3" stretchy="false" xref="S3.p2.10.m10.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S3.p2.10.m10.2.3.3.3" xref="S3.p2.10.m10.2.3.3.3.cmml"><mi id="S3.p2.10.m10.2.3.3.3.2" xref="S3.p2.10.m10.2.3.3.3.2.cmml">n</mi><mo id="S3.p2.10.m10.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p2.10.m10.2.3.3.3.1.cmml">Ã—</mo><mi id="S3.p2.10.m10.2.3.3.3.3" xref="S3.p2.10.m10.2.3.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.2b"><apply id="S3.p2.10.m10.2.3.cmml" xref="S3.p2.10.m10.2.3"><in id="S3.p2.10.m10.2.3.1.cmml" xref="S3.p2.10.m10.2.3.1"></in><ci id="S3.p2.10.m10.2.3.2.cmml" xref="S3.p2.10.m10.2.3.2">ğ€</ci><apply id="S3.p2.10.m10.2.3.3.cmml" xref="S3.p2.10.m10.2.3.3"><csymbol cd="ambiguous" id="S3.p2.10.m10.2.3.3.1.cmml" xref="S3.p2.10.m10.2.3.3">superscript</csymbol><set id="S3.p2.10.m10.2.3.3.2.1.cmml" xref="S3.p2.10.m10.2.3.3.2.2"><cn id="S3.p2.10.m10.1.1.cmml" type="integer" xref="S3.p2.10.m10.1.1">0</cn><cn id="S3.p2.10.m10.2.2.cmml" type="integer" xref="S3.p2.10.m10.2.2">1</cn></set><apply id="S3.p2.10.m10.2.3.3.3.cmml" xref="S3.p2.10.m10.2.3.3.3"><times id="S3.p2.10.m10.2.3.3.3.1.cmml" xref="S3.p2.10.m10.2.3.3.3.1"></times><ci id="S3.p2.10.m10.2.3.3.3.2.cmml" xref="S3.p2.10.m10.2.3.3.3.2">ğ‘›</ci><ci id="S3.p2.10.m10.2.3.3.3.3.cmml" xref="S3.p2.10.m10.2.3.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.2c">\mathbf{A}\in\{0,1\}^{n\times n}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.10.m10.2d">bold_A âˆˆ { 0 , 1 } start_POSTSUPERSCRIPT italic_n Ã— italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\mathbf{A}[i,j]=1" class="ltx_Math" display="inline" id="S3.p2.11.m11.2"><semantics id="S3.p2.11.m11.2a"><mrow id="S3.p2.11.m11.2.3" xref="S3.p2.11.m11.2.3.cmml"><mrow id="S3.p2.11.m11.2.3.2" xref="S3.p2.11.m11.2.3.2.cmml"><mi id="S3.p2.11.m11.2.3.2.2" xref="S3.p2.11.m11.2.3.2.2.cmml">ğ€</mi><mo id="S3.p2.11.m11.2.3.2.1" xref="S3.p2.11.m11.2.3.2.1.cmml">â¢</mo><mrow id="S3.p2.11.m11.2.3.2.3.2" xref="S3.p2.11.m11.2.3.2.3.1.cmml"><mo id="S3.p2.11.m11.2.3.2.3.2.1" stretchy="false" xref="S3.p2.11.m11.2.3.2.3.1.cmml">[</mo><mi id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml">i</mi><mo id="S3.p2.11.m11.2.3.2.3.2.2" xref="S3.p2.11.m11.2.3.2.3.1.cmml">,</mo><mi id="S3.p2.11.m11.2.2" xref="S3.p2.11.m11.2.2.cmml">j</mi><mo id="S3.p2.11.m11.2.3.2.3.2.3" stretchy="false" xref="S3.p2.11.m11.2.3.2.3.1.cmml">]</mo></mrow></mrow><mo id="S3.p2.11.m11.2.3.1" xref="S3.p2.11.m11.2.3.1.cmml">=</mo><mn id="S3.p2.11.m11.2.3.3" xref="S3.p2.11.m11.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.2b"><apply id="S3.p2.11.m11.2.3.cmml" xref="S3.p2.11.m11.2.3"><eq id="S3.p2.11.m11.2.3.1.cmml" xref="S3.p2.11.m11.2.3.1"></eq><apply id="S3.p2.11.m11.2.3.2.cmml" xref="S3.p2.11.m11.2.3.2"><times id="S3.p2.11.m11.2.3.2.1.cmml" xref="S3.p2.11.m11.2.3.2.1"></times><ci id="S3.p2.11.m11.2.3.2.2.cmml" xref="S3.p2.11.m11.2.3.2.2">ğ€</ci><interval closure="closed" id="S3.p2.11.m11.2.3.2.3.1.cmml" xref="S3.p2.11.m11.2.3.2.3.2"><ci id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1">ğ‘–</ci><ci id="S3.p2.11.m11.2.2.cmml" xref="S3.p2.11.m11.2.2">ğ‘—</ci></interval></apply><cn id="S3.p2.11.m11.2.3.3.cmml" type="integer" xref="S3.p2.11.m11.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.2c">\mathbf{A}[i,j]=1</annotation><annotation encoding="application/x-llamapun" id="S3.p2.11.m11.2d">bold_A [ italic_i , italic_j ] = 1</annotation></semantics></math> if and only if <math alttext="e_{ij}=1" class="ltx_Math" display="inline" id="S3.p2.12.m12.1"><semantics id="S3.p2.12.m12.1a"><mrow id="S3.p2.12.m12.1.1" xref="S3.p2.12.m12.1.1.cmml"><msub id="S3.p2.12.m12.1.1.2" xref="S3.p2.12.m12.1.1.2.cmml"><mi id="S3.p2.12.m12.1.1.2.2" xref="S3.p2.12.m12.1.1.2.2.cmml">e</mi><mrow id="S3.p2.12.m12.1.1.2.3" xref="S3.p2.12.m12.1.1.2.3.cmml"><mi id="S3.p2.12.m12.1.1.2.3.2" xref="S3.p2.12.m12.1.1.2.3.2.cmml">i</mi><mo id="S3.p2.12.m12.1.1.2.3.1" xref="S3.p2.12.m12.1.1.2.3.1.cmml">â¢</mo><mi id="S3.p2.12.m12.1.1.2.3.3" xref="S3.p2.12.m12.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.p2.12.m12.1.1.1" xref="S3.p2.12.m12.1.1.1.cmml">=</mo><mn id="S3.p2.12.m12.1.1.3" xref="S3.p2.12.m12.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.12.m12.1b"><apply id="S3.p2.12.m12.1.1.cmml" xref="S3.p2.12.m12.1.1"><eq id="S3.p2.12.m12.1.1.1.cmml" xref="S3.p2.12.m12.1.1.1"></eq><apply id="S3.p2.12.m12.1.1.2.cmml" xref="S3.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.1.2.1.cmml" xref="S3.p2.12.m12.1.1.2">subscript</csymbol><ci id="S3.p2.12.m12.1.1.2.2.cmml" xref="S3.p2.12.m12.1.1.2.2">ğ‘’</ci><apply id="S3.p2.12.m12.1.1.2.3.cmml" xref="S3.p2.12.m12.1.1.2.3"><times id="S3.p2.12.m12.1.1.2.3.1.cmml" xref="S3.p2.12.m12.1.1.2.3.1"></times><ci id="S3.p2.12.m12.1.1.2.3.2.cmml" xref="S3.p2.12.m12.1.1.2.3.2">ğ‘–</ci><ci id="S3.p2.12.m12.1.1.2.3.3.cmml" xref="S3.p2.12.m12.1.1.2.3.3">ğ‘—</ci></apply></apply><cn id="S3.p2.12.m12.1.1.3.cmml" type="integer" xref="S3.p2.12.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m12.1c">e_{ij}=1</annotation><annotation encoding="application/x-llamapun" id="S3.p2.12.m12.1d">italic_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math>. The training and test node labels are denoted by <math alttext="\mathcal{Y}=\mathcal{Y}^{\mathrm{train}}\cup\mathcal{Y}^{test}=\{y_{i}\}_{i=1}%
^{n}" class="ltx_Math" display="inline" id="S3.p2.13.m13.1"><semantics id="S3.p2.13.m13.1a"><mrow id="S3.p2.13.m13.1.1" xref="S3.p2.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.13.m13.1.1.3" xref="S3.p2.13.m13.1.1.3.cmml">ğ’´</mi><mo id="S3.p2.13.m13.1.1.4" xref="S3.p2.13.m13.1.1.4.cmml">=</mo><mrow id="S3.p2.13.m13.1.1.5" xref="S3.p2.13.m13.1.1.5.cmml"><msup id="S3.p2.13.m13.1.1.5.2" xref="S3.p2.13.m13.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.13.m13.1.1.5.2.2" xref="S3.p2.13.m13.1.1.5.2.2.cmml">ğ’´</mi><mi id="S3.p2.13.m13.1.1.5.2.3" xref="S3.p2.13.m13.1.1.5.2.3.cmml">train</mi></msup><mo id="S3.p2.13.m13.1.1.5.1" xref="S3.p2.13.m13.1.1.5.1.cmml">âˆª</mo><msup id="S3.p2.13.m13.1.1.5.3" xref="S3.p2.13.m13.1.1.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.13.m13.1.1.5.3.2" xref="S3.p2.13.m13.1.1.5.3.2.cmml">ğ’´</mi><mrow id="S3.p2.13.m13.1.1.5.3.3" xref="S3.p2.13.m13.1.1.5.3.3.cmml"><mi id="S3.p2.13.m13.1.1.5.3.3.2" xref="S3.p2.13.m13.1.1.5.3.3.2.cmml">t</mi><mo id="S3.p2.13.m13.1.1.5.3.3.1" xref="S3.p2.13.m13.1.1.5.3.3.1.cmml">â¢</mo><mi id="S3.p2.13.m13.1.1.5.3.3.3" xref="S3.p2.13.m13.1.1.5.3.3.3.cmml">e</mi><mo id="S3.p2.13.m13.1.1.5.3.3.1a" xref="S3.p2.13.m13.1.1.5.3.3.1.cmml">â¢</mo><mi id="S3.p2.13.m13.1.1.5.3.3.4" xref="S3.p2.13.m13.1.1.5.3.3.4.cmml">s</mi><mo id="S3.p2.13.m13.1.1.5.3.3.1b" xref="S3.p2.13.m13.1.1.5.3.3.1.cmml">â¢</mo><mi id="S3.p2.13.m13.1.1.5.3.3.5" xref="S3.p2.13.m13.1.1.5.3.3.5.cmml">t</mi></mrow></msup></mrow><mo id="S3.p2.13.m13.1.1.6" xref="S3.p2.13.m13.1.1.6.cmml">=</mo><msubsup id="S3.p2.13.m13.1.1.1" xref="S3.p2.13.m13.1.1.1.cmml"><mrow id="S3.p2.13.m13.1.1.1.1.1.1" xref="S3.p2.13.m13.1.1.1.1.1.2.cmml"><mo id="S3.p2.13.m13.1.1.1.1.1.1.2" stretchy="false" xref="S3.p2.13.m13.1.1.1.1.1.2.cmml">{</mo><msub id="S3.p2.13.m13.1.1.1.1.1.1.1" xref="S3.p2.13.m13.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.13.m13.1.1.1.1.1.1.1.2" xref="S3.p2.13.m13.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.p2.13.m13.1.1.1.1.1.1.1.3" xref="S3.p2.13.m13.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.13.m13.1.1.1.1.1.1.3" stretchy="false" xref="S3.p2.13.m13.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p2.13.m13.1.1.1.1.3" xref="S3.p2.13.m13.1.1.1.1.3.cmml"><mi id="S3.p2.13.m13.1.1.1.1.3.2" xref="S3.p2.13.m13.1.1.1.1.3.2.cmml">i</mi><mo id="S3.p2.13.m13.1.1.1.1.3.1" xref="S3.p2.13.m13.1.1.1.1.3.1.cmml">=</mo><mn id="S3.p2.13.m13.1.1.1.1.3.3" xref="S3.p2.13.m13.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p2.13.m13.1.1.1.3" xref="S3.p2.13.m13.1.1.1.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.13.m13.1b"><apply id="S3.p2.13.m13.1.1.cmml" xref="S3.p2.13.m13.1.1"><and id="S3.p2.13.m13.1.1a.cmml" xref="S3.p2.13.m13.1.1"></and><apply id="S3.p2.13.m13.1.1b.cmml" xref="S3.p2.13.m13.1.1"><eq id="S3.p2.13.m13.1.1.4.cmml" xref="S3.p2.13.m13.1.1.4"></eq><ci id="S3.p2.13.m13.1.1.3.cmml" xref="S3.p2.13.m13.1.1.3">ğ’´</ci><apply id="S3.p2.13.m13.1.1.5.cmml" xref="S3.p2.13.m13.1.1.5"><union id="S3.p2.13.m13.1.1.5.1.cmml" xref="S3.p2.13.m13.1.1.5.1"></union><apply id="S3.p2.13.m13.1.1.5.2.cmml" xref="S3.p2.13.m13.1.1.5.2"><csymbol cd="ambiguous" id="S3.p2.13.m13.1.1.5.2.1.cmml" xref="S3.p2.13.m13.1.1.5.2">superscript</csymbol><ci id="S3.p2.13.m13.1.1.5.2.2.cmml" xref="S3.p2.13.m13.1.1.5.2.2">ğ’´</ci><ci id="S3.p2.13.m13.1.1.5.2.3.cmml" xref="S3.p2.13.m13.1.1.5.2.3">train</ci></apply><apply id="S3.p2.13.m13.1.1.5.3.cmml" xref="S3.p2.13.m13.1.1.5.3"><csymbol cd="ambiguous" id="S3.p2.13.m13.1.1.5.3.1.cmml" xref="S3.p2.13.m13.1.1.5.3">superscript</csymbol><ci id="S3.p2.13.m13.1.1.5.3.2.cmml" xref="S3.p2.13.m13.1.1.5.3.2">ğ’´</ci><apply id="S3.p2.13.m13.1.1.5.3.3.cmml" xref="S3.p2.13.m13.1.1.5.3.3"><times id="S3.p2.13.m13.1.1.5.3.3.1.cmml" xref="S3.p2.13.m13.1.1.5.3.3.1"></times><ci id="S3.p2.13.m13.1.1.5.3.3.2.cmml" xref="S3.p2.13.m13.1.1.5.3.3.2">ğ‘¡</ci><ci id="S3.p2.13.m13.1.1.5.3.3.3.cmml" xref="S3.p2.13.m13.1.1.5.3.3.3">ğ‘’</ci><ci id="S3.p2.13.m13.1.1.5.3.3.4.cmml" xref="S3.p2.13.m13.1.1.5.3.3.4">ğ‘ </ci><ci id="S3.p2.13.m13.1.1.5.3.3.5.cmml" xref="S3.p2.13.m13.1.1.5.3.3.5">ğ‘¡</ci></apply></apply></apply></apply><apply id="S3.p2.13.m13.1.1c.cmml" xref="S3.p2.13.m13.1.1"><eq id="S3.p2.13.m13.1.1.6.cmml" xref="S3.p2.13.m13.1.1.6"></eq><share href="https://arxiv.org/html/2410.02296v1#S3.p2.13.m13.1.1.5.cmml" id="S3.p2.13.m13.1.1d.cmml" xref="S3.p2.13.m13.1.1"></share><apply id="S3.p2.13.m13.1.1.1.cmml" xref="S3.p2.13.m13.1.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m13.1.1.1.2.cmml" xref="S3.p2.13.m13.1.1.1">superscript</csymbol><apply id="S3.p2.13.m13.1.1.1.1.cmml" xref="S3.p2.13.m13.1.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m13.1.1.1.1.2.cmml" xref="S3.p2.13.m13.1.1.1">subscript</csymbol><set id="S3.p2.13.m13.1.1.1.1.1.2.cmml" xref="S3.p2.13.m13.1.1.1.1.1.1"><apply id="S3.p2.13.m13.1.1.1.1.1.1.1.cmml" xref="S3.p2.13.m13.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m13.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.13.m13.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.13.m13.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.13.m13.1.1.1.1.1.1.1.2">ğ‘¦</ci><ci id="S3.p2.13.m13.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.13.m13.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></set><apply id="S3.p2.13.m13.1.1.1.1.3.cmml" xref="S3.p2.13.m13.1.1.1.1.3"><eq id="S3.p2.13.m13.1.1.1.1.3.1.cmml" xref="S3.p2.13.m13.1.1.1.1.3.1"></eq><ci id="S3.p2.13.m13.1.1.1.1.3.2.cmml" xref="S3.p2.13.m13.1.1.1.1.3.2">ğ‘–</ci><cn id="S3.p2.13.m13.1.1.1.1.3.3.cmml" type="integer" xref="S3.p2.13.m13.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p2.13.m13.1.1.1.3.cmml" xref="S3.p2.13.m13.1.1.1.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m13.1c">\mathcal{Y}=\mathcal{Y}^{\mathrm{train}}\cup\mathcal{Y}^{test}=\{y_{i}\}_{i=1}%
^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.13.m13.1d">caligraphic_Y = caligraphic_Y start_POSTSUPERSCRIPT roman_train end_POSTSUPERSCRIPT âˆª caligraphic_Y start_POSTSUPERSCRIPT italic_t italic_e italic_s italic_t end_POSTSUPERSCRIPT = { italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, where each label <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.p2.14.m14.1"><semantics id="S3.p2.14.m14.1a"><msub id="S3.p2.14.m14.1.1" xref="S3.p2.14.m14.1.1.cmml"><mi id="S3.p2.14.m14.1.1.2" xref="S3.p2.14.m14.1.1.2.cmml">y</mi><mi id="S3.p2.14.m14.1.1.3" xref="S3.p2.14.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.14.m14.1b"><apply id="S3.p2.14.m14.1.1.cmml" xref="S3.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p2.14.m14.1.1.1.cmml" xref="S3.p2.14.m14.1.1">subscript</csymbol><ci id="S3.p2.14.m14.1.1.2.cmml" xref="S3.p2.14.m14.1.1.2">ğ‘¦</ci><ci id="S3.p2.14.m14.1.1.3.cmml" xref="S3.p2.14.m14.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m14.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.14.m14.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> belongs to one of the <math alttext="C" class="ltx_Math" display="inline" id="S3.p2.15.m15.1"><semantics id="S3.p2.15.m15.1a"><mi id="S3.p2.15.m15.1.1" xref="S3.p2.15.m15.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.p2.15.m15.1b"><ci id="S3.p2.15.m15.1.1.cmml" xref="S3.p2.15.m15.1.1">ğ¶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m15.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.p2.15.m15.1d">italic_C</annotation></semantics></math> classes, i.e., <math alttext="y_{i}\in\{1,\dots,C\},\forall i" class="ltx_Math" display="inline" id="S3.p2.16.m16.5"><semantics id="S3.p2.16.m16.5a"><mrow id="S3.p2.16.m16.5.5" xref="S3.p2.16.m16.5.5.cmml"><msub id="S3.p2.16.m16.5.5.4" xref="S3.p2.16.m16.5.5.4.cmml"><mi id="S3.p2.16.m16.5.5.4.2" xref="S3.p2.16.m16.5.5.4.2.cmml">y</mi><mi id="S3.p2.16.m16.5.5.4.3" xref="S3.p2.16.m16.5.5.4.3.cmml">i</mi></msub><mo id="S3.p2.16.m16.5.5.3" xref="S3.p2.16.m16.5.5.3.cmml">âˆˆ</mo><mrow id="S3.p2.16.m16.5.5.2.2" xref="S3.p2.16.m16.5.5.2.3.cmml"><mrow id="S3.p2.16.m16.4.4.1.1.1.2" xref="S3.p2.16.m16.4.4.1.1.1.1.cmml"><mo id="S3.p2.16.m16.4.4.1.1.1.2.1" stretchy="false" xref="S3.p2.16.m16.4.4.1.1.1.1.cmml">{</mo><mn id="S3.p2.16.m16.1.1" xref="S3.p2.16.m16.1.1.cmml">1</mn><mo id="S3.p2.16.m16.4.4.1.1.1.2.2" xref="S3.p2.16.m16.4.4.1.1.1.1.cmml">,</mo><mi id="S3.p2.16.m16.2.2" mathvariant="normal" xref="S3.p2.16.m16.2.2.cmml">â€¦</mi><mo id="S3.p2.16.m16.4.4.1.1.1.2.3" xref="S3.p2.16.m16.4.4.1.1.1.1.cmml">,</mo><mi id="S3.p2.16.m16.3.3" xref="S3.p2.16.m16.3.3.cmml">C</mi><mo id="S3.p2.16.m16.4.4.1.1.1.2.4" stretchy="false" xref="S3.p2.16.m16.4.4.1.1.1.1.cmml">}</mo></mrow><mo id="S3.p2.16.m16.5.5.2.2.3" xref="S3.p2.16.m16.5.5.2.3.cmml">,</mo><mrow id="S3.p2.16.m16.5.5.2.2.2" xref="S3.p2.16.m16.5.5.2.2.2.cmml"><mo id="S3.p2.16.m16.5.5.2.2.2.1" rspace="0.167em" xref="S3.p2.16.m16.5.5.2.2.2.1.cmml">âˆ€</mo><mi id="S3.p2.16.m16.5.5.2.2.2.2" xref="S3.p2.16.m16.5.5.2.2.2.2.cmml">i</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.16.m16.5b"><apply id="S3.p2.16.m16.5.5.cmml" xref="S3.p2.16.m16.5.5"><in id="S3.p2.16.m16.5.5.3.cmml" xref="S3.p2.16.m16.5.5.3"></in><apply id="S3.p2.16.m16.5.5.4.cmml" xref="S3.p2.16.m16.5.5.4"><csymbol cd="ambiguous" id="S3.p2.16.m16.5.5.4.1.cmml" xref="S3.p2.16.m16.5.5.4">subscript</csymbol><ci id="S3.p2.16.m16.5.5.4.2.cmml" xref="S3.p2.16.m16.5.5.4.2">ğ‘¦</ci><ci id="S3.p2.16.m16.5.5.4.3.cmml" xref="S3.p2.16.m16.5.5.4.3">ğ‘–</ci></apply><list id="S3.p2.16.m16.5.5.2.3.cmml" xref="S3.p2.16.m16.5.5.2.2"><set id="S3.p2.16.m16.4.4.1.1.1.1.cmml" xref="S3.p2.16.m16.4.4.1.1.1.2"><cn id="S3.p2.16.m16.1.1.cmml" type="integer" xref="S3.p2.16.m16.1.1">1</cn><ci id="S3.p2.16.m16.2.2.cmml" xref="S3.p2.16.m16.2.2">â€¦</ci><ci id="S3.p2.16.m16.3.3.cmml" xref="S3.p2.16.m16.3.3">ğ¶</ci></set><apply id="S3.p2.16.m16.5.5.2.2.2.cmml" xref="S3.p2.16.m16.5.5.2.2.2"><csymbol cd="latexml" id="S3.p2.16.m16.5.5.2.2.2.1.cmml" xref="S3.p2.16.m16.5.5.2.2.2.1">for-all</csymbol><ci id="S3.p2.16.m16.5.5.2.2.2.2.cmml" xref="S3.p2.16.m16.5.5.2.2.2.2">ğ‘–</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m16.5c">y_{i}\in\{1,\dots,C\},\forall i</annotation><annotation encoding="application/x-llamapun" id="S3.p2.16.m16.5d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ { 1 , â€¦ , italic_C } , âˆ€ italic_i</annotation></semantics></math>. In the semi-supervised setting considered in this study, we have access to the graph structure and training labels <math alttext="\mathcal{V},\mathcal{E},\mathcal{T},\mathcal{Y}^{\mathrm{train}}" class="ltx_Math" display="inline" id="S3.p2.17.m17.4"><semantics id="S3.p2.17.m17.4a"><mrow id="S3.p2.17.m17.4.4.1" xref="S3.p2.17.m17.4.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.17.m17.1.1" xref="S3.p2.17.m17.1.1.cmml">ğ’±</mi><mo id="S3.p2.17.m17.4.4.1.2" xref="S3.p2.17.m17.4.4.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.17.m17.2.2" xref="S3.p2.17.m17.2.2.cmml">â„°</mi><mo id="S3.p2.17.m17.4.4.1.3" xref="S3.p2.17.m17.4.4.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.17.m17.3.3" xref="S3.p2.17.m17.3.3.cmml">ğ’¯</mi><mo id="S3.p2.17.m17.4.4.1.4" xref="S3.p2.17.m17.4.4.2.cmml">,</mo><msup id="S3.p2.17.m17.4.4.1.1" xref="S3.p2.17.m17.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.17.m17.4.4.1.1.2" xref="S3.p2.17.m17.4.4.1.1.2.cmml">ğ’´</mi><mi id="S3.p2.17.m17.4.4.1.1.3" xref="S3.p2.17.m17.4.4.1.1.3.cmml">train</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.17.m17.4b"><list id="S3.p2.17.m17.4.4.2.cmml" xref="S3.p2.17.m17.4.4.1"><ci id="S3.p2.17.m17.1.1.cmml" xref="S3.p2.17.m17.1.1">ğ’±</ci><ci id="S3.p2.17.m17.2.2.cmml" xref="S3.p2.17.m17.2.2">â„°</ci><ci id="S3.p2.17.m17.3.3.cmml" xref="S3.p2.17.m17.3.3">ğ’¯</ci><apply id="S3.p2.17.m17.4.4.1.1.cmml" xref="S3.p2.17.m17.4.4.1.1"><csymbol cd="ambiguous" id="S3.p2.17.m17.4.4.1.1.1.cmml" xref="S3.p2.17.m17.4.4.1.1">superscript</csymbol><ci id="S3.p2.17.m17.4.4.1.1.2.cmml" xref="S3.p2.17.m17.4.4.1.1.2">ğ’´</ci><ci id="S3.p2.17.m17.4.4.1.1.3.cmml" xref="S3.p2.17.m17.4.4.1.1.3">train</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.17.m17.4c">\mathcal{V},\mathcal{E},\mathcal{T},\mathcal{Y}^{\mathrm{train}}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.17.m17.4d">caligraphic_V , caligraphic_E , caligraphic_T , caligraphic_Y start_POSTSUPERSCRIPT roman_train end_POSTSUPERSCRIPT</annotation></semantics></math> during training. The task is to predict the labels of the remaining unlabeled nodes <math alttext="\mathcal{Y}^{\mathrm{test}}" class="ltx_Math" display="inline" id="S3.p2.18.m18.1"><semantics id="S3.p2.18.m18.1a"><msup id="S3.p2.18.m18.1.1" xref="S3.p2.18.m18.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.18.m18.1.1.2" xref="S3.p2.18.m18.1.1.2.cmml">ğ’´</mi><mi id="S3.p2.18.m18.1.1.3" xref="S3.p2.18.m18.1.1.3.cmml">test</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p2.18.m18.1b"><apply id="S3.p2.18.m18.1.1.cmml" xref="S3.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S3.p2.18.m18.1.1.1.cmml" xref="S3.p2.18.m18.1.1">superscript</csymbol><ci id="S3.p2.18.m18.1.1.2.cmml" xref="S3.p2.18.m18.1.1.2">ğ’´</ci><ci id="S3.p2.18.m18.1.1.3.cmml" xref="S3.p2.18.m18.1.1.3">test</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.18.m18.1c">\mathcal{Y}^{\mathrm{test}}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.18.m18.1d">caligraphic_Y start_POSTSUPERSCRIPT roman_test end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.3"><span class="ltx_text ltx_font_bold" id="S3.p3.3.1">Personalized PageRank (PPR)</span>

Â <cite class="ltx_cite ltx_citemacro_citep">(Page, <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib39" title="">1999</a>; Jeh &amp; Widom, <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib27" title="">2003</a>)</cite> assigns a relevance score to each node in the graph with respect to a given query node. Specifically, given the adjacency matrix <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">ğ€</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">ğ€</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">bold_A</annotation></semantics></math>, the PPR scores <math alttext="\mathbf{r}_{i}\in\mathbb{R}^{n}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><msub id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml"><mi id="S3.p3.2.m2.1.1.2.2" xref="S3.p3.2.m2.1.1.2.2.cmml">ğ«</mi><mi id="S3.p3.2.m2.1.1.2.3" xref="S3.p3.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.p3.2.m2.1.1.1" xref="S3.p3.2.m2.1.1.1.cmml">âˆˆ</mo><msup id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml"><mi id="S3.p3.2.m2.1.1.3.2" xref="S3.p3.2.m2.1.1.3.2.cmml">â„</mi><mi id="S3.p3.2.m2.1.1.3.3" xref="S3.p3.2.m2.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><in id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1"></in><apply id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.2.1.cmml" xref="S3.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.2.cmml" xref="S3.p3.2.m2.1.1.2.2">ğ«</ci><ci id="S3.p3.2.m2.1.1.2.3.cmml" xref="S3.p3.2.m2.1.1.2.3">ğ‘–</ci></apply><apply id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.3.1.cmml" xref="S3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.p3.2.m2.1.1.3.2.cmml" xref="S3.p3.2.m2.1.1.3.2">â„</ci><ci id="S3.p3.2.m2.1.1.3.3.cmml" xref="S3.p3.2.m2.1.1.3.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\mathbf{r}_{i}\in\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">bold_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> for all nodes in the graph relative to the query node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">v</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">ğ‘£</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, are computed iteratively as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{r}_{i}\leftarrow(1-\alpha)\tilde{\mathbf{A}}\mathbf{r}_{i%
}+\alpha\mathbf{q}_{i}" class="ltx_Math" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml">ğ«</mi><mi id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.2.cmml">â†</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">âˆ’</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml">Î±</mi></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">â¢</mo><mover accent="true" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">ğ€</mi><mo id="S3.E1.m1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="S3.E1.m1.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.2.cmml">â¢</mo><msub id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.1.4.2.cmml">ğ«</mi><mi id="S3.E1.m1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.4.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.3.2.cmml">Î±</mi><mo id="S3.E1.m1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.3.1.cmml">â¢</mo><msub id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.3.3.2.cmml">ğª</mi><mi id="S3.E1.m1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">â†</ci><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2">ğ«</ci><ci id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3">ğ‘–</ci></apply><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><plus id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></plus><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3">ğ›¼</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><ci id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1">~</ci><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">ğ€</ci></apply><apply id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.4.2">ğ«</ci><ci id="S3.E1.m1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.4.3">ğ‘–</ci></apply></apply><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3"><times id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.3.2">ğ›¼</ci><apply id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.3.3.2">ğª</ci><ci id="S3.E1.m1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3.3">ğ‘–</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\mathbf{r}_{i}\leftarrow(1-\alpha)\tilde{\mathbf{A}}\mathbf{r}_{i%
}+\alpha\mathbf{q}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">bold_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â† ( 1 - italic_Î± ) over~ start_ARG bold_A end_ARG bold_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_Î± bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.10">where <math alttext="\alpha\in(0,1)" class="ltx_Math" display="inline" id="S3.p3.4.m1.2"><semantics id="S3.p3.4.m1.2a"><mrow id="S3.p3.4.m1.2.3" xref="S3.p3.4.m1.2.3.cmml"><mi id="S3.p3.4.m1.2.3.2" xref="S3.p3.4.m1.2.3.2.cmml">Î±</mi><mo id="S3.p3.4.m1.2.3.1" xref="S3.p3.4.m1.2.3.1.cmml">âˆˆ</mo><mrow id="S3.p3.4.m1.2.3.3.2" xref="S3.p3.4.m1.2.3.3.1.cmml"><mo id="S3.p3.4.m1.2.3.3.2.1" stretchy="false" xref="S3.p3.4.m1.2.3.3.1.cmml">(</mo><mn id="S3.p3.4.m1.1.1" xref="S3.p3.4.m1.1.1.cmml">0</mn><mo id="S3.p3.4.m1.2.3.3.2.2" xref="S3.p3.4.m1.2.3.3.1.cmml">,</mo><mn id="S3.p3.4.m1.2.2" xref="S3.p3.4.m1.2.2.cmml">1</mn><mo id="S3.p3.4.m1.2.3.3.2.3" stretchy="false" xref="S3.p3.4.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m1.2b"><apply id="S3.p3.4.m1.2.3.cmml" xref="S3.p3.4.m1.2.3"><in id="S3.p3.4.m1.2.3.1.cmml" xref="S3.p3.4.m1.2.3.1"></in><ci id="S3.p3.4.m1.2.3.2.cmml" xref="S3.p3.4.m1.2.3.2">ğ›¼</ci><interval closure="open" id="S3.p3.4.m1.2.3.3.1.cmml" xref="S3.p3.4.m1.2.3.3.2"><cn id="S3.p3.4.m1.1.1.cmml" type="integer" xref="S3.p3.4.m1.1.1">0</cn><cn id="S3.p3.4.m1.2.2.cmml" type="integer" xref="S3.p3.4.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m1.2c">\alpha\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m1.2d">italic_Î± âˆˆ ( 0 , 1 )</annotation></semantics></math> is the teleport probability, <math alttext="\mathbf{q}_{i}\in(0,1)^{n\times 1}" class="ltx_Math" display="inline" id="S3.p3.5.m2.2"><semantics id="S3.p3.5.m2.2a"><mrow id="S3.p3.5.m2.2.3" xref="S3.p3.5.m2.2.3.cmml"><msub id="S3.p3.5.m2.2.3.2" xref="S3.p3.5.m2.2.3.2.cmml"><mi id="S3.p3.5.m2.2.3.2.2" xref="S3.p3.5.m2.2.3.2.2.cmml">ğª</mi><mi id="S3.p3.5.m2.2.3.2.3" xref="S3.p3.5.m2.2.3.2.3.cmml">i</mi></msub><mo id="S3.p3.5.m2.2.3.1" xref="S3.p3.5.m2.2.3.1.cmml">âˆˆ</mo><msup id="S3.p3.5.m2.2.3.3" xref="S3.p3.5.m2.2.3.3.cmml"><mrow id="S3.p3.5.m2.2.3.3.2.2" xref="S3.p3.5.m2.2.3.3.2.1.cmml"><mo id="S3.p3.5.m2.2.3.3.2.2.1" stretchy="false" xref="S3.p3.5.m2.2.3.3.2.1.cmml">(</mo><mn id="S3.p3.5.m2.1.1" xref="S3.p3.5.m2.1.1.cmml">0</mn><mo id="S3.p3.5.m2.2.3.3.2.2.2" xref="S3.p3.5.m2.2.3.3.2.1.cmml">,</mo><mn id="S3.p3.5.m2.2.2" xref="S3.p3.5.m2.2.2.cmml">1</mn><mo id="S3.p3.5.m2.2.3.3.2.2.3" stretchy="false" xref="S3.p3.5.m2.2.3.3.2.1.cmml">)</mo></mrow><mrow id="S3.p3.5.m2.2.3.3.3" xref="S3.p3.5.m2.2.3.3.3.cmml"><mi id="S3.p3.5.m2.2.3.3.3.2" xref="S3.p3.5.m2.2.3.3.3.2.cmml">n</mi><mo id="S3.p3.5.m2.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p3.5.m2.2.3.3.3.1.cmml">Ã—</mo><mn id="S3.p3.5.m2.2.3.3.3.3" xref="S3.p3.5.m2.2.3.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m2.2b"><apply id="S3.p3.5.m2.2.3.cmml" xref="S3.p3.5.m2.2.3"><in id="S3.p3.5.m2.2.3.1.cmml" xref="S3.p3.5.m2.2.3.1"></in><apply id="S3.p3.5.m2.2.3.2.cmml" xref="S3.p3.5.m2.2.3.2"><csymbol cd="ambiguous" id="S3.p3.5.m2.2.3.2.1.cmml" xref="S3.p3.5.m2.2.3.2">subscript</csymbol><ci id="S3.p3.5.m2.2.3.2.2.cmml" xref="S3.p3.5.m2.2.3.2.2">ğª</ci><ci id="S3.p3.5.m2.2.3.2.3.cmml" xref="S3.p3.5.m2.2.3.2.3">ğ‘–</ci></apply><apply id="S3.p3.5.m2.2.3.3.cmml" xref="S3.p3.5.m2.2.3.3"><csymbol cd="ambiguous" id="S3.p3.5.m2.2.3.3.1.cmml" xref="S3.p3.5.m2.2.3.3">superscript</csymbol><interval closure="open" id="S3.p3.5.m2.2.3.3.2.1.cmml" xref="S3.p3.5.m2.2.3.3.2.2"><cn id="S3.p3.5.m2.1.1.cmml" type="integer" xref="S3.p3.5.m2.1.1">0</cn><cn id="S3.p3.5.m2.2.2.cmml" type="integer" xref="S3.p3.5.m2.2.2">1</cn></interval><apply id="S3.p3.5.m2.2.3.3.3.cmml" xref="S3.p3.5.m2.2.3.3.3"><times id="S3.p3.5.m2.2.3.3.3.1.cmml" xref="S3.p3.5.m2.2.3.3.3.1"></times><ci id="S3.p3.5.m2.2.3.3.3.2.cmml" xref="S3.p3.5.m2.2.3.3.3.2">ğ‘›</ci><cn id="S3.p3.5.m2.2.3.3.3.3.cmml" type="integer" xref="S3.p3.5.m2.2.3.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m2.2c">\mathbf{q}_{i}\in(0,1)^{n\times 1}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m2.2d">bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ ( 0 , 1 ) start_POSTSUPERSCRIPT italic_n Ã— 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is a one-hot vector with a single non-zero entry at index <math alttext="i" class="ltx_Math" display="inline" id="S3.p3.6.m3.1"><semantics id="S3.p3.6.m3.1a"><mi id="S3.p3.6.m3.1.1" xref="S3.p3.6.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m3.1b"><ci id="S3.p3.6.m3.1.1.cmml" xref="S3.p3.6.m3.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m3.1d">italic_i</annotation></semantics></math>, <math alttext="\tilde{\mathbf{A}}=\mathbf{A}\mathbf{D}^{-1}" class="ltx_Math" display="inline" id="S3.p3.7.m4.1"><semantics id="S3.p3.7.m4.1a"><mrow id="S3.p3.7.m4.1.1" xref="S3.p3.7.m4.1.1.cmml"><mover accent="true" id="S3.p3.7.m4.1.1.2" xref="S3.p3.7.m4.1.1.2.cmml"><mi id="S3.p3.7.m4.1.1.2.2" xref="S3.p3.7.m4.1.1.2.2.cmml">ğ€</mi><mo id="S3.p3.7.m4.1.1.2.1" xref="S3.p3.7.m4.1.1.2.1.cmml">~</mo></mover><mo id="S3.p3.7.m4.1.1.1" xref="S3.p3.7.m4.1.1.1.cmml">=</mo><msup id="S3.p3.7.m4.1.1.3" xref="S3.p3.7.m4.1.1.3.cmml"><mi id="S3.p3.7.m4.1.1.3.2" xref="S3.p3.7.m4.1.1.3.2.cmml">ğ€ğƒ</mi><mrow id="S3.p3.7.m4.1.1.3.3" xref="S3.p3.7.m4.1.1.3.3.cmml"><mo id="S3.p3.7.m4.1.1.3.3a" xref="S3.p3.7.m4.1.1.3.3.cmml">âˆ’</mo><mn id="S3.p3.7.m4.1.1.3.3.2" xref="S3.p3.7.m4.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.7.m4.1b"><apply id="S3.p3.7.m4.1.1.cmml" xref="S3.p3.7.m4.1.1"><eq id="S3.p3.7.m4.1.1.1.cmml" xref="S3.p3.7.m4.1.1.1"></eq><apply id="S3.p3.7.m4.1.1.2.cmml" xref="S3.p3.7.m4.1.1.2"><ci id="S3.p3.7.m4.1.1.2.1.cmml" xref="S3.p3.7.m4.1.1.2.1">~</ci><ci id="S3.p3.7.m4.1.1.2.2.cmml" xref="S3.p3.7.m4.1.1.2.2">ğ€</ci></apply><apply id="S3.p3.7.m4.1.1.3.cmml" xref="S3.p3.7.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p3.7.m4.1.1.3.1.cmml" xref="S3.p3.7.m4.1.1.3">superscript</csymbol><ci id="S3.p3.7.m4.1.1.3.2.cmml" xref="S3.p3.7.m4.1.1.3.2">ğ€ğƒ</ci><apply id="S3.p3.7.m4.1.1.3.3.cmml" xref="S3.p3.7.m4.1.1.3.3"><minus id="S3.p3.7.m4.1.1.3.3.1.cmml" xref="S3.p3.7.m4.1.1.3.3"></minus><cn id="S3.p3.7.m4.1.1.3.3.2.cmml" type="integer" xref="S3.p3.7.m4.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m4.1c">\tilde{\mathbf{A}}=\mathbf{A}\mathbf{D}^{-1}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m4.1d">over~ start_ARG bold_A end_ARG = bold_AD start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> is the normalized adjacency matrix, and <math alttext="\mathbf{D}" class="ltx_Math" display="inline" id="S3.p3.8.m5.1"><semantics id="S3.p3.8.m5.1a"><mi id="S3.p3.8.m5.1.1" xref="S3.p3.8.m5.1.1.cmml">ğƒ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.8.m5.1b"><ci id="S3.p3.8.m5.1.1.cmml" xref="S3.p3.8.m5.1.1">ğƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m5.1c">\mathbf{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m5.1d">bold_D</annotation></semantics></math> is the degree matrix. Once the PPR scores are computed, we can identify the top-<math alttext="K" class="ltx_Math" display="inline" id="S3.p3.9.m6.1"><semantics id="S3.p3.9.m6.1a"><mi id="S3.p3.9.m6.1.1" xref="S3.p3.9.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m6.1b"><ci id="S3.p3.9.m6.1.1.cmml" xref="S3.p3.9.m6.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m6.1d">italic_K</annotation></semantics></math> most relevant nodes with respect to the query node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.p3.10.m7.1"><semantics id="S3.p3.10.m7.1a"><msub id="S3.p3.10.m7.1.1" xref="S3.p3.10.m7.1.1.cmml"><mi id="S3.p3.10.m7.1.1.2" xref="S3.p3.10.m7.1.1.2.cmml">v</mi><mi id="S3.p3.10.m7.1.1.3" xref="S3.p3.10.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.10.m7.1b"><apply id="S3.p3.10.m7.1.1.cmml" xref="S3.p3.10.m7.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m7.1.1.1.cmml" xref="S3.p3.10.m7.1.1">subscript</csymbol><ci id="S3.p3.10.m7.1.1.2.cmml" xref="S3.p3.10.m7.1.1.2">ğ‘£</ci><ci id="S3.p3.10.m7.1.1.3.cmml" xref="S3.p3.10.m7.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m7.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.m7.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx2">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathtt{PPR\ neigh}(v_{i})=\{v_{j}:\mathbf{r}_{i}[j]\in\text{top-%
K}(\mathbf{r}_{i})\}" class="ltx_Math" display="inline" id="S3.E2.m1.4"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.cmml"><mi id="S3.E2.m1.2.2.1.3" xref="S3.E2.m1.2.2.1.3.cmml">ğ™¿ğ™¿ğš</mi><mo id="S3.E2.m1.2.2.1.2" lspace="0.500em" xref="S3.E2.m1.2.2.1.2.cmml">â¢</mo><mi id="S3.E2.m1.2.2.1.4" xref="S3.E2.m1.2.2.1.4.cmml">ğš—ğšğš’ğšğš‘</mi><mo id="S3.E2.m1.2.2.1.2a" xref="S3.E2.m1.2.2.1.2.cmml">â¢</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">v</mi><mi id="S3.E2.m1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml">=</mo><mrow id="S3.E2.m1.4.4.3.2" xref="S3.E2.m1.4.4.3.3.cmml"><mo id="S3.E2.m1.4.4.3.2.3" stretchy="false" xref="S3.E2.m1.4.4.3.3.1.cmml">{</mo><msub id="S3.E2.m1.3.3.2.1.1" xref="S3.E2.m1.3.3.2.1.1.cmml"><mi id="S3.E2.m1.3.3.2.1.1.2" xref="S3.E2.m1.3.3.2.1.1.2.cmml">v</mi><mi id="S3.E2.m1.3.3.2.1.1.3" xref="S3.E2.m1.3.3.2.1.1.3.cmml">j</mi></msub><mo id="S3.E2.m1.4.4.3.2.4" lspace="0.278em" rspace="0.278em" xref="S3.E2.m1.4.4.3.3.1.cmml">:</mo><mrow id="S3.E2.m1.4.4.3.2.2" xref="S3.E2.m1.4.4.3.2.2.cmml"><mrow id="S3.E2.m1.4.4.3.2.2.3" xref="S3.E2.m1.4.4.3.2.2.3.cmml"><msub id="S3.E2.m1.4.4.3.2.2.3.2" xref="S3.E2.m1.4.4.3.2.2.3.2.cmml"><mi id="S3.E2.m1.4.4.3.2.2.3.2.2" xref="S3.E2.m1.4.4.3.2.2.3.2.2.cmml">ğ«</mi><mi id="S3.E2.m1.4.4.3.2.2.3.2.3" xref="S3.E2.m1.4.4.3.2.2.3.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.3.2.2.3.1" xref="S3.E2.m1.4.4.3.2.2.3.1.cmml">â¢</mo><mrow id="S3.E2.m1.4.4.3.2.2.3.3.2" xref="S3.E2.m1.4.4.3.2.2.3.3.1.cmml"><mo id="S3.E2.m1.4.4.3.2.2.3.3.2.1" stretchy="false" xref="S3.E2.m1.4.4.3.2.2.3.3.1.1.cmml">[</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">j</mi><mo id="S3.E2.m1.4.4.3.2.2.3.3.2.2" stretchy="false" xref="S3.E2.m1.4.4.3.2.2.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.4.4.3.2.2.2" xref="S3.E2.m1.4.4.3.2.2.2.cmml">âˆˆ</mo><mrow id="S3.E2.m1.4.4.3.2.2.1" xref="S3.E2.m1.4.4.3.2.2.1.cmml"><mtext id="S3.E2.m1.4.4.3.2.2.1.3" xref="S3.E2.m1.4.4.3.2.2.1.3a.cmml">top-K</mtext><mo id="S3.E2.m1.4.4.3.2.2.1.2" xref="S3.E2.m1.4.4.3.2.2.1.2.cmml">â¢</mo><mrow id="S3.E2.m1.4.4.3.2.2.1.1.1" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.cmml"><mo id="S3.E2.m1.4.4.3.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.4.4.3.2.2.1.1.1.1" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.3.2.2.1.1.1.1.2" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.2.cmml">ğ«</mi><mi id="S3.E2.m1.4.4.3.2.2.1.1.1.1.3" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.3.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.3.2.5" stretchy="false" xref="S3.E2.m1.4.4.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"></eq><apply id="S3.E2.m1.2.2.1.cmml" xref="S3.E2.m1.2.2.1"><times id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.2"></times><ci id="S3.E2.m1.2.2.1.3.cmml" xref="S3.E2.m1.2.2.1.3">ğ™¿ğ™¿ğš</ci><ci id="S3.E2.m1.2.2.1.4.cmml" xref="S3.E2.m1.2.2.1.4">ğš—ğšğš’ğšğš‘</ci><apply id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2">ğ‘£</ci><ci id="S3.E2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="S3.E2.m1.4.4.3.3.cmml" xref="S3.E2.m1.4.4.3.2"><csymbol cd="latexml" id="S3.E2.m1.4.4.3.3.1.cmml" xref="S3.E2.m1.4.4.3.2.3">conditional-set</csymbol><apply id="S3.E2.m1.3.3.2.1.1.cmml" xref="S3.E2.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.1.1.1.cmml" xref="S3.E2.m1.3.3.2.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.2.1.1.2.cmml" xref="S3.E2.m1.3.3.2.1.1.2">ğ‘£</ci><ci id="S3.E2.m1.3.3.2.1.1.3.cmml" xref="S3.E2.m1.3.3.2.1.1.3">ğ‘—</ci></apply><apply id="S3.E2.m1.4.4.3.2.2.cmml" xref="S3.E2.m1.4.4.3.2.2"><in id="S3.E2.m1.4.4.3.2.2.2.cmml" xref="S3.E2.m1.4.4.3.2.2.2"></in><apply id="S3.E2.m1.4.4.3.2.2.3.cmml" xref="S3.E2.m1.4.4.3.2.2.3"><times id="S3.E2.m1.4.4.3.2.2.3.1.cmml" xref="S3.E2.m1.4.4.3.2.2.3.1"></times><apply id="S3.E2.m1.4.4.3.2.2.3.2.cmml" xref="S3.E2.m1.4.4.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.3.2.2.3.2.1.cmml" xref="S3.E2.m1.4.4.3.2.2.3.2">subscript</csymbol><ci id="S3.E2.m1.4.4.3.2.2.3.2.2.cmml" xref="S3.E2.m1.4.4.3.2.2.3.2.2">ğ«</ci><ci id="S3.E2.m1.4.4.3.2.2.3.2.3.cmml" xref="S3.E2.m1.4.4.3.2.2.3.2.3">ğ‘–</ci></apply><apply id="S3.E2.m1.4.4.3.2.2.3.3.1.cmml" xref="S3.E2.m1.4.4.3.2.2.3.3.2"><csymbol cd="latexml" id="S3.E2.m1.4.4.3.2.2.3.3.1.1.cmml" xref="S3.E2.m1.4.4.3.2.2.3.3.2.1">delimited-[]</csymbol><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">ğ‘—</ci></apply></apply><apply id="S3.E2.m1.4.4.3.2.2.1.cmml" xref="S3.E2.m1.4.4.3.2.2.1"><times id="S3.E2.m1.4.4.3.2.2.1.2.cmml" xref="S3.E2.m1.4.4.3.2.2.1.2"></times><ci id="S3.E2.m1.4.4.3.2.2.1.3a.cmml" xref="S3.E2.m1.4.4.3.2.2.1.3"><mtext id="S3.E2.m1.4.4.3.2.2.1.3.cmml" xref="S3.E2.m1.4.4.3.2.2.1.3">top-K</mtext></ci><apply id="S3.E2.m1.4.4.3.2.2.1.1.1.1.cmml" xref="S3.E2.m1.4.4.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.3.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.3.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.3.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.2">ğ«</ci><ci id="S3.E2.m1.4.4.3.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.3.2.2.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\displaystyle\mathtt{PPR\ neigh}(v_{i})=\{v_{j}:\mathbf{r}_{i}[j]\in\text{top-%
K}(\mathbf{r}_{i})\}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.4d">typewriter_PPR typewriter_neigh ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = { italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT : bold_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_j ] âˆˆ top-K ( bold_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.16"><span class="ltx_text ltx_font_bold" id="S3.p3.16.1">Language Models (LMs).</span>
We employ autoregressive LMs that predict the next token <math alttext="z_{i}" class="ltx_Math" display="inline" id="S3.p3.11.m1.1"><semantics id="S3.p3.11.m1.1a"><msub id="S3.p3.11.m1.1.1" xref="S3.p3.11.m1.1.1.cmml"><mi id="S3.p3.11.m1.1.1.2" xref="S3.p3.11.m1.1.1.2.cmml">z</mi><mi id="S3.p3.11.m1.1.1.3" xref="S3.p3.11.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.11.m1.1b"><apply id="S3.p3.11.m1.1.1.cmml" xref="S3.p3.11.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.11.m1.1.1.1.cmml" xref="S3.p3.11.m1.1.1">subscript</csymbol><ci id="S3.p3.11.m1.1.1.2.cmml" xref="S3.p3.11.m1.1.1.2">ğ‘§</ci><ci id="S3.p3.11.m1.1.1.3.cmml" xref="S3.p3.11.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m1.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.11.m1.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> based on the input sequence <math alttext="t" class="ltx_Math" display="inline" id="S3.p3.12.m2.1"><semantics id="S3.p3.12.m2.1a"><mi id="S3.p3.12.m2.1.1" xref="S3.p3.12.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.12.m2.1b"><ci id="S3.p3.12.m2.1.1.cmml" xref="S3.p3.12.m2.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.12.m2.1d">italic_t</annotation></semantics></math> and the context of previously generated tokens <math alttext="z_{1:i-1}" class="ltx_Math" display="inline" id="S3.p3.13.m3.1"><semantics id="S3.p3.13.m3.1a"><msub id="S3.p3.13.m3.1.1" xref="S3.p3.13.m3.1.1.cmml"><mi id="S3.p3.13.m3.1.1.2" xref="S3.p3.13.m3.1.1.2.cmml">z</mi><mrow id="S3.p3.13.m3.1.1.3" xref="S3.p3.13.m3.1.1.3.cmml"><mn id="S3.p3.13.m3.1.1.3.2" xref="S3.p3.13.m3.1.1.3.2.cmml">1</mn><mo id="S3.p3.13.m3.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.p3.13.m3.1.1.3.1.cmml">:</mo><mrow id="S3.p3.13.m3.1.1.3.3" xref="S3.p3.13.m3.1.1.3.3.cmml"><mi id="S3.p3.13.m3.1.1.3.3.2" xref="S3.p3.13.m3.1.1.3.3.2.cmml">i</mi><mo id="S3.p3.13.m3.1.1.3.3.1" xref="S3.p3.13.m3.1.1.3.3.1.cmml">âˆ’</mo><mn id="S3.p3.13.m3.1.1.3.3.3" xref="S3.p3.13.m3.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.13.m3.1b"><apply id="S3.p3.13.m3.1.1.cmml" xref="S3.p3.13.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.13.m3.1.1.1.cmml" xref="S3.p3.13.m3.1.1">subscript</csymbol><ci id="S3.p3.13.m3.1.1.2.cmml" xref="S3.p3.13.m3.1.1.2">ğ‘§</ci><apply id="S3.p3.13.m3.1.1.3.cmml" xref="S3.p3.13.m3.1.1.3"><ci id="S3.p3.13.m3.1.1.3.1.cmml" xref="S3.p3.13.m3.1.1.3.1">:</ci><cn id="S3.p3.13.m3.1.1.3.2.cmml" type="integer" xref="S3.p3.13.m3.1.1.3.2">1</cn><apply id="S3.p3.13.m3.1.1.3.3.cmml" xref="S3.p3.13.m3.1.1.3.3"><minus id="S3.p3.13.m3.1.1.3.3.1.cmml" xref="S3.p3.13.m3.1.1.3.3.1"></minus><ci id="S3.p3.13.m3.1.1.3.3.2.cmml" xref="S3.p3.13.m3.1.1.3.3.2">ğ‘–</ci><cn id="S3.p3.13.m3.1.1.3.3.3.cmml" type="integer" xref="S3.p3.13.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m3.1c">z_{1:i-1}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.13.m3.1d">italic_z start_POSTSUBSCRIPT 1 : italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. The probability of generating an <math alttext="N" class="ltx_Math" display="inline" id="S3.p3.14.m4.1"><semantics id="S3.p3.14.m4.1a"><mi id="S3.p3.14.m4.1.1" xref="S3.p3.14.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.14.m4.1b"><ci id="S3.p3.14.m4.1.1.cmml" xref="S3.p3.14.m4.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p3.14.m4.1d">italic_N</annotation></semantics></math>-token sequence <math alttext="z" class="ltx_Math" display="inline" id="S3.p3.15.m5.1"><semantics id="S3.p3.15.m5.1a"><mi id="S3.p3.15.m5.1.1" xref="S3.p3.15.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.p3.15.m5.1b"><ci id="S3.p3.15.m5.1.1.cmml" xref="S3.p3.15.m5.1.1">ğ‘§</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.15.m5.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.p3.15.m5.1d">italic_z</annotation></semantics></math> given the input sequence <math alttext="t" class="ltx_Math" display="inline" id="S3.p3.16.m6.1"><semantics id="S3.p3.16.m6.1a"><mi id="S3.p3.16.m6.1.1" xref="S3.p3.16.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.16.m6.1b"><ci id="S3.p3.16.m6.1.1.cmml" xref="S3.p3.16.m6.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.16.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.16.m6.1d">italic_t</annotation></semantics></math> is modeled as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx3">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{\mathrm{LM}}(z|t)=\prod_{i=1}^{N}p_{\mathrm{LM}}(z_{i}|t,z_{1%
:i-1})" class="ltx_Math" display="inline" id="S3.E3.m1.3"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><msub id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.3.cmml"><mi id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.2.2.1.3.2.cmml">p</mi><mi id="S3.E3.m1.2.2.1.3.3" xref="S3.E3.m1.2.2.1.3.3.cmml">LM</mi></msub><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.2.cmml">â¢</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">z</mi><mo fence="false" id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml">t</mi></mrow><mo id="S3.E3.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml">=</mo><mrow id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.3.3.2.2" xref="S3.E3.m1.3.3.2.2.cmml"><munderover id="S3.E3.m1.3.3.2.2a" xref="S3.E3.m1.3.3.2.2.cmml"><mo id="S3.E3.m1.3.3.2.2.2.2" movablelimits="false" xref="S3.E3.m1.3.3.2.2.2.2.cmml">âˆ</mo><mrow id="S3.E3.m1.3.3.2.2.2.3" xref="S3.E3.m1.3.3.2.2.2.3.cmml"><mi id="S3.E3.m1.3.3.2.2.2.3.2" xref="S3.E3.m1.3.3.2.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.3.3.2.2.2.3.1" xref="S3.E3.m1.3.3.2.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.3.3.2.2.2.3.3" xref="S3.E3.m1.3.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.3.3.2.2.3" xref="S3.E3.m1.3.3.2.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E3.m1.3.3.2.1" xref="S3.E3.m1.3.3.2.1.cmml"><msub id="S3.E3.m1.3.3.2.1.3" xref="S3.E3.m1.3.3.2.1.3.cmml"><mi id="S3.E3.m1.3.3.2.1.3.2" xref="S3.E3.m1.3.3.2.1.3.2.cmml">p</mi><mi id="S3.E3.m1.3.3.2.1.3.3" xref="S3.E3.m1.3.3.2.1.3.3.cmml">LM</mi></msub><mo id="S3.E3.m1.3.3.2.1.2" xref="S3.E3.m1.3.3.2.1.2.cmml">â¢</mo><mrow id="S3.E3.m1.3.3.2.1.1.1" xref="S3.E3.m1.3.3.2.1.1.1.1.cmml"><mo id="S3.E3.m1.3.3.2.1.1.1.2" stretchy="false" xref="S3.E3.m1.3.3.2.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.2.1.1.1.1" xref="S3.E3.m1.3.3.2.1.1.1.1.cmml"><msub id="S3.E3.m1.3.3.2.1.1.1.1.3" xref="S3.E3.m1.3.3.2.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.2.1.1.1.1.3.2" xref="S3.E3.m1.3.3.2.1.1.1.1.3.2.cmml">z</mi><mi id="S3.E3.m1.3.3.2.1.1.1.1.3.3" xref="S3.E3.m1.3.3.2.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S3.E3.m1.3.3.2.1.1.1.1.2" xref="S3.E3.m1.3.3.2.1.1.1.1.2.cmml">|</mo><mrow id="S3.E3.m1.3.3.2.1.1.1.1.1.1" xref="S3.E3.m1.3.3.2.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">t</mi><mo id="S3.E3.m1.3.3.2.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.2.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.1" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.1.cmml">âˆ’</mo><mn id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow></mrow><mo id="S3.E3.m1.3.3.2.1.1.1.3" stretchy="false" xref="S3.E3.m1.3.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><eq id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"></eq><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><times id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.2"></times><apply id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.3.1.cmml" xref="S3.E3.m1.2.2.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.3.2.cmml" xref="S3.E3.m1.2.2.1.3.2">ğ‘</ci><ci id="S3.E3.m1.2.2.1.3.3.cmml" xref="S3.E3.m1.2.2.1.3.3">LM</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">ğ‘§</ci><ci id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3">ğ‘¡</ci></apply></apply><apply id="S3.E3.m1.3.3.2.cmml" xref="S3.E3.m1.3.3.2"><apply id="S3.E3.m1.3.3.2.2.cmml" xref="S3.E3.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.1.cmml" xref="S3.E3.m1.3.3.2.2">superscript</csymbol><apply id="S3.E3.m1.3.3.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.1.cmml" xref="S3.E3.m1.3.3.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.E3.m1.3.3.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2">product</csymbol><apply id="S3.E3.m1.3.3.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.3"><eq id="S3.E3.m1.3.3.2.2.2.3.1.cmml" xref="S3.E3.m1.3.3.2.2.2.3.1"></eq><ci id="S3.E3.m1.3.3.2.2.2.3.2.cmml" xref="S3.E3.m1.3.3.2.2.2.3.2">ğ‘–</ci><cn id="S3.E3.m1.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.3.3.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.3">ğ‘</ci></apply><apply id="S3.E3.m1.3.3.2.1.cmml" xref="S3.E3.m1.3.3.2.1"><times id="S3.E3.m1.3.3.2.1.2.cmml" xref="S3.E3.m1.3.3.2.1.2"></times><apply id="S3.E3.m1.3.3.2.1.3.cmml" xref="S3.E3.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.1.3.1.cmml" xref="S3.E3.m1.3.3.2.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.1.3.2.cmml" xref="S3.E3.m1.3.3.2.1.3.2">ğ‘</ci><ci id="S3.E3.m1.3.3.2.1.3.3.cmml" xref="S3.E3.m1.3.3.2.1.3.3">LM</ci></apply><apply id="S3.E3.m1.3.3.2.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.2.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.2">conditional</csymbol><apply id="S3.E3.m1.3.3.2.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.3.2">ğ‘§</ci><ci id="S3.E3.m1.3.3.2.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.3.3">ğ‘–</ci></apply><list id="S3.E3.m1.3.3.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">ğ‘¡</ci><apply id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.2">ğ‘§</ci><apply id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3"><ci id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.1">:</ci><cn id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.2">1</cn><apply id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3"><minus id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.2">ğ‘–</ci><cn id="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E3.m1.3.3.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\displaystyle p_{\mathrm{LM}}(z|t)=\prod_{i=1}^{N}p_{\mathrm{LM}}(z_{i}|t,z_{1%
:i-1})</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.3d">italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_z | italic_t ) = âˆ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_t , italic_z start_POSTSUBSCRIPT 1 : italic_i - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.20"><span class="ltx_text ltx_font_bold" id="S3.p3.20.1">Retrieval-Augmented Generation (RAG)</span>
Â <cite class="ltx_cite ltx_citemacro_citep">(Lewis etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib32" title="">2020</a>; Guu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib18" title="">2020</a>)</cite> enhances the ability of LMs to answer knowledge-intensive questions. Unlike traditional LMs that directly process the input text <math alttext="t" class="ltx_Math" display="inline" id="S3.p3.17.m1.1"><semantics id="S3.p3.17.m1.1a"><mi id="S3.p3.17.m1.1.1" xref="S3.p3.17.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.17.m1.1b"><ci id="S3.p3.17.m1.1.1.cmml" xref="S3.p3.17.m1.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.17.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.17.m1.1d">italic_t</annotation></semantics></math>, RAG first retrieves a relevant document <math alttext="d^{*}" class="ltx_Math" display="inline" id="S3.p3.18.m2.1"><semantics id="S3.p3.18.m2.1a"><msup id="S3.p3.18.m2.1.1" xref="S3.p3.18.m2.1.1.cmml"><mi id="S3.p3.18.m2.1.1.2" xref="S3.p3.18.m2.1.1.2.cmml">d</mi><mo id="S3.p3.18.m2.1.1.3" xref="S3.p3.18.m2.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p3.18.m2.1b"><apply id="S3.p3.18.m2.1.1.cmml" xref="S3.p3.18.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.18.m2.1.1.1.cmml" xref="S3.p3.18.m2.1.1">superscript</csymbol><ci id="S3.p3.18.m2.1.1.2.cmml" xref="S3.p3.18.m2.1.1.2">ğ‘‘</ci><times id="S3.p3.18.m2.1.1.3.cmml" xref="S3.p3.18.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.18.m2.1c">d^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.18.m2.1d">italic_d start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT</annotation></semantics></math> from an external document corpus <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.p3.19.m3.1"><semantics id="S3.p3.19.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p3.19.m3.1.1" xref="S3.p3.19.m3.1.1.cmml">ğ’Ÿ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.19.m3.1b"><ci id="S3.p3.19.m3.1.1.cmml" xref="S3.p3.19.m3.1.1">ğ’Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.19.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.19.m3.1d">caligraphic_D</annotation></semantics></math> using a similarity function <math alttext="s_{\phi}" class="ltx_Math" display="inline" id="S3.p3.20.m4.1"><semantics id="S3.p3.20.m4.1a"><msub id="S3.p3.20.m4.1.1" xref="S3.p3.20.m4.1.1.cmml"><mi id="S3.p3.20.m4.1.1.2" xref="S3.p3.20.m4.1.1.2.cmml">s</mi><mi id="S3.p3.20.m4.1.1.3" xref="S3.p3.20.m4.1.1.3.cmml">Ï•</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.20.m4.1b"><apply id="S3.p3.20.m4.1.1.cmml" xref="S3.p3.20.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.20.m4.1.1.1.cmml" xref="S3.p3.20.m4.1.1">subscript</csymbol><ci id="S3.p3.20.m4.1.1.2.cmml" xref="S3.p3.20.m4.1.1.2">ğ‘ </ci><ci id="S3.p3.20.m4.1.1.3.cmml" xref="S3.p3.20.m4.1.1.3">italic-Ï•</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.20.m4.1c">s_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.20.m4.1d">italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx4">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle d^{*}=\mathop{\arg\max}_{d\in\mathcal{D}}s_{\phi}(d,t)" class="ltx_Math" display="inline" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.3" xref="S3.E4.m1.2.3.cmml"><msup id="S3.E4.m1.2.3.2" xref="S3.E4.m1.2.3.2.cmml"><mi id="S3.E4.m1.2.3.2.2" xref="S3.E4.m1.2.3.2.2.cmml">d</mi><mo id="S3.E4.m1.2.3.2.3" xref="S3.E4.m1.2.3.2.3.cmml">âˆ—</mo></msup><mo id="S3.E4.m1.2.3.1" xref="S3.E4.m1.2.3.1.cmml">=</mo><mrow id="S3.E4.m1.2.3.3" xref="S3.E4.m1.2.3.3.cmml"><munder id="S3.E4.m1.2.3.3.1" xref="S3.E4.m1.2.3.3.1.cmml"><mrow id="S3.E4.m1.2.3.3.1.2" xref="S3.E4.m1.2.3.3.1.2.cmml"><mi id="S3.E4.m1.2.3.3.1.2.1" xref="S3.E4.m1.2.3.3.1.2.1.cmml">arg</mi><mo id="S3.E4.m1.2.3.3.1.2a" lspace="0.167em" xref="S3.E4.m1.2.3.3.1.2.cmml">â¡</mo><mi id="S3.E4.m1.2.3.3.1.2.2" xref="S3.E4.m1.2.3.3.1.2.2.cmml">max</mi></mrow><mrow id="S3.E4.m1.2.3.3.1.3" xref="S3.E4.m1.2.3.3.1.3.cmml"><mi id="S3.E4.m1.2.3.3.1.3.2" xref="S3.E4.m1.2.3.3.1.3.2.cmml">d</mi><mo id="S3.E4.m1.2.3.3.1.3.1" xref="S3.E4.m1.2.3.3.1.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.3.3.1.3.3" xref="S3.E4.m1.2.3.3.1.3.3.cmml">ğ’Ÿ</mi></mrow></munder><mrow id="S3.E4.m1.2.3.3.2" xref="S3.E4.m1.2.3.3.2.cmml"><msub id="S3.E4.m1.2.3.3.2.2" xref="S3.E4.m1.2.3.3.2.2.cmml"><mi id="S3.E4.m1.2.3.3.2.2.2" xref="S3.E4.m1.2.3.3.2.2.2.cmml">s</mi><mi id="S3.E4.m1.2.3.3.2.2.3" xref="S3.E4.m1.2.3.3.2.2.3.cmml">Ï•</mi></msub><mo id="S3.E4.m1.2.3.3.2.1" xref="S3.E4.m1.2.3.3.2.1.cmml">â¢</mo><mrow id="S3.E4.m1.2.3.3.2.3.2" xref="S3.E4.m1.2.3.3.2.3.1.cmml"><mo id="S3.E4.m1.2.3.3.2.3.2.1" stretchy="false" xref="S3.E4.m1.2.3.3.2.3.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">d</mi><mo id="S3.E4.m1.2.3.3.2.3.2.2" xref="S3.E4.m1.2.3.3.2.3.1.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">t</mi><mo id="S3.E4.m1.2.3.3.2.3.2.3" stretchy="false" xref="S3.E4.m1.2.3.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.3.cmml" xref="S3.E4.m1.2.3"><eq id="S3.E4.m1.2.3.1.cmml" xref="S3.E4.m1.2.3.1"></eq><apply id="S3.E4.m1.2.3.2.cmml" xref="S3.E4.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.3.2.1.cmml" xref="S3.E4.m1.2.3.2">superscript</csymbol><ci id="S3.E4.m1.2.3.2.2.cmml" xref="S3.E4.m1.2.3.2.2">ğ‘‘</ci><times id="S3.E4.m1.2.3.2.3.cmml" xref="S3.E4.m1.2.3.2.3"></times></apply><apply id="S3.E4.m1.2.3.3.cmml" xref="S3.E4.m1.2.3.3"><apply id="S3.E4.m1.2.3.3.1.cmml" xref="S3.E4.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.3.3.1.1.cmml" xref="S3.E4.m1.2.3.3.1">subscript</csymbol><apply id="S3.E4.m1.2.3.3.1.2.cmml" xref="S3.E4.m1.2.3.3.1.2"><arg id="S3.E4.m1.2.3.3.1.2.1.cmml" xref="S3.E4.m1.2.3.3.1.2.1"></arg><max id="S3.E4.m1.2.3.3.1.2.2.cmml" xref="S3.E4.m1.2.3.3.1.2.2"></max></apply><apply id="S3.E4.m1.2.3.3.1.3.cmml" xref="S3.E4.m1.2.3.3.1.3"><in id="S3.E4.m1.2.3.3.1.3.1.cmml" xref="S3.E4.m1.2.3.3.1.3.1"></in><ci id="S3.E4.m1.2.3.3.1.3.2.cmml" xref="S3.E4.m1.2.3.3.1.3.2">ğ‘‘</ci><ci id="S3.E4.m1.2.3.3.1.3.3.cmml" xref="S3.E4.m1.2.3.3.1.3.3">ğ’Ÿ</ci></apply></apply><apply id="S3.E4.m1.2.3.3.2.cmml" xref="S3.E4.m1.2.3.3.2"><times id="S3.E4.m1.2.3.3.2.1.cmml" xref="S3.E4.m1.2.3.3.2.1"></times><apply id="S3.E4.m1.2.3.3.2.2.cmml" xref="S3.E4.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.3.3.2.2.1.cmml" xref="S3.E4.m1.2.3.3.2.2">subscript</csymbol><ci id="S3.E4.m1.2.3.3.2.2.2.cmml" xref="S3.E4.m1.2.3.3.2.2.2">ğ‘ </ci><ci id="S3.E4.m1.2.3.3.2.2.3.cmml" xref="S3.E4.m1.2.3.3.2.2.3">italic-Ï•</ci></apply><interval closure="open" id="S3.E4.m1.2.3.3.2.3.1.cmml" xref="S3.E4.m1.2.3.3.2.3.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">ğ‘‘</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">ğ‘¡</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle d^{*}=\mathop{\arg\max}_{d\in\mathcal{D}}s_{\phi}(d,t)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">italic_d start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT = start_BIGOP roman_arg roman_max end_BIGOP start_POSTSUBSCRIPT italic_d âˆˆ caligraphic_D end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_d , italic_t )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.22">The similarity function <math alttext="s_{\phi}" class="ltx_Math" display="inline" id="S3.p3.21.m1.1"><semantics id="S3.p3.21.m1.1a"><msub id="S3.p3.21.m1.1.1" xref="S3.p3.21.m1.1.1.cmml"><mi id="S3.p3.21.m1.1.1.2" xref="S3.p3.21.m1.1.1.2.cmml">s</mi><mi id="S3.p3.21.m1.1.1.3" xref="S3.p3.21.m1.1.1.3.cmml">Ï•</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.21.m1.1b"><apply id="S3.p3.21.m1.1.1.cmml" xref="S3.p3.21.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.21.m1.1.1.1.cmml" xref="S3.p3.21.m1.1.1">subscript</csymbol><ci id="S3.p3.21.m1.1.1.2.cmml" xref="S3.p3.21.m1.1.1.2">ğ‘ </ci><ci id="S3.p3.21.m1.1.1.3.cmml" xref="S3.p3.21.m1.1.1.3">italic-Ï•</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.21.m1.1c">s_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.21.m1.1d">italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT</annotation></semantics></math> is typically implemented using a dual-encoder architectureÂ <cite class="ltx_cite ltx_citemacro_citep">(Bromley etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib7" title="">1993</a>)</cite> which computes the inner product <math alttext="\langle\cdot,\cdot\rangle" class="ltx_Math" display="inline" id="S3.p3.22.m2.2"><semantics id="S3.p3.22.m2.2a"><mrow id="S3.p3.22.m2.2.3.2" xref="S3.p3.22.m2.2.3.1.cmml"><mo id="S3.p3.22.m2.2.3.2.1" stretchy="false" xref="S3.p3.22.m2.2.3.1.cmml">âŸ¨</mo><mo id="S3.p3.22.m2.1.1" lspace="0em" rspace="0em" xref="S3.p3.22.m2.1.1.cmml">â‹…</mo><mo id="S3.p3.22.m2.2.3.2.2" rspace="0em" xref="S3.p3.22.m2.2.3.1.cmml">,</mo><mo id="S3.p3.22.m2.2.2" lspace="0em" rspace="0em" xref="S3.p3.22.m2.2.2.cmml">â‹…</mo><mo id="S3.p3.22.m2.2.3.2.3" stretchy="false" xref="S3.p3.22.m2.2.3.1.cmml">âŸ©</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.22.m2.2b"><list id="S3.p3.22.m2.2.3.1.cmml" xref="S3.p3.22.m2.2.3.2"><ci id="S3.p3.22.m2.1.1.cmml" xref="S3.p3.22.m2.1.1">â‹…</ci><ci id="S3.p3.22.m2.2.2.cmml" xref="S3.p3.22.m2.2.2">â‹…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.22.m2.2c">\langle\cdot,\cdot\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.p3.22.m2.2d">âŸ¨ â‹… , â‹… âŸ©</annotation></semantics></math> between the encoded representations of the document and the input text:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx5">
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle s_{\phi}(d,t)=\langle\mathrm{Encoder}_{\phi}(d),\mathrm{Encoder}%
_{\phi}(t)\rangle" class="ltx_Math" display="inline" id="S3.E5.m1.6"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml"><mrow id="S3.E5.m1.6.6.4" xref="S3.E5.m1.6.6.4.cmml"><msub id="S3.E5.m1.6.6.4.2" xref="S3.E5.m1.6.6.4.2.cmml"><mi id="S3.E5.m1.6.6.4.2.2" xref="S3.E5.m1.6.6.4.2.2.cmml">s</mi><mi id="S3.E5.m1.6.6.4.2.3" xref="S3.E5.m1.6.6.4.2.3.cmml">Ï•</mi></msub><mo id="S3.E5.m1.6.6.4.1" xref="S3.E5.m1.6.6.4.1.cmml">â¢</mo><mrow id="S3.E5.m1.6.6.4.3.2" xref="S3.E5.m1.6.6.4.3.1.cmml"><mo id="S3.E5.m1.6.6.4.3.2.1" stretchy="false" xref="S3.E5.m1.6.6.4.3.1.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">d</mi><mo id="S3.E5.m1.6.6.4.3.2.2" xref="S3.E5.m1.6.6.4.3.1.cmml">,</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">t</mi><mo id="S3.E5.m1.6.6.4.3.2.3" stretchy="false" xref="S3.E5.m1.6.6.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.3" xref="S3.E5.m1.6.6.3.cmml">=</mo><mrow id="S3.E5.m1.6.6.2.2" xref="S3.E5.m1.6.6.2.3.cmml"><mo id="S3.E5.m1.6.6.2.2.3" stretchy="false" xref="S3.E5.m1.6.6.2.3.cmml">âŸ¨</mo><mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml"><msub id="S3.E5.m1.5.5.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.2.2" xref="S3.E5.m1.5.5.1.1.1.2.2.cmml">Encoder</mi><mi id="S3.E5.m1.5.5.1.1.1.2.3" xref="S3.E5.m1.5.5.1.1.1.2.3.cmml">Ï•</mi></msub><mo id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.cmml">â¢</mo><mrow id="S3.E5.m1.5.5.1.1.1.3.2" xref="S3.E5.m1.5.5.1.1.1.cmml"><mo id="S3.E5.m1.5.5.1.1.1.3.2.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">d</mi><mo id="S3.E5.m1.5.5.1.1.1.3.2.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.2.2.4" xref="S3.E5.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E5.m1.6.6.2.2.2" xref="S3.E5.m1.6.6.2.2.2.cmml"><msub id="S3.E5.m1.6.6.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.2.cmml"><mi id="S3.E5.m1.6.6.2.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.2.2.cmml">Encoder</mi><mi id="S3.E5.m1.6.6.2.2.2.2.3" xref="S3.E5.m1.6.6.2.2.2.2.3.cmml">Ï•</mi></msub><mo id="S3.E5.m1.6.6.2.2.2.1" xref="S3.E5.m1.6.6.2.2.2.1.cmml">â¢</mo><mrow id="S3.E5.m1.6.6.2.2.2.3.2" xref="S3.E5.m1.6.6.2.2.2.cmml"><mo id="S3.E5.m1.6.6.2.2.2.3.2.1" stretchy="false" xref="S3.E5.m1.6.6.2.2.2.cmml">(</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">t</mi><mo id="S3.E5.m1.6.6.2.2.2.3.2.2" stretchy="false" xref="S3.E5.m1.6.6.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.2.2.5" stretchy="false" xref="S3.E5.m1.6.6.2.3.cmml">âŸ©</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6"><eq id="S3.E5.m1.6.6.3.cmml" xref="S3.E5.m1.6.6.3"></eq><apply id="S3.E5.m1.6.6.4.cmml" xref="S3.E5.m1.6.6.4"><times id="S3.E5.m1.6.6.4.1.cmml" xref="S3.E5.m1.6.6.4.1"></times><apply id="S3.E5.m1.6.6.4.2.cmml" xref="S3.E5.m1.6.6.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.4.2.1.cmml" xref="S3.E5.m1.6.6.4.2">subscript</csymbol><ci id="S3.E5.m1.6.6.4.2.2.cmml" xref="S3.E5.m1.6.6.4.2.2">ğ‘ </ci><ci id="S3.E5.m1.6.6.4.2.3.cmml" xref="S3.E5.m1.6.6.4.2.3">italic-Ï•</ci></apply><interval closure="open" id="S3.E5.m1.6.6.4.3.1.cmml" xref="S3.E5.m1.6.6.4.3.2"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">ğ‘‘</ci><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">ğ‘¡</ci></interval></apply><list id="S3.E5.m1.6.6.2.3.cmml" xref="S3.E5.m1.6.6.2.2"><apply id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1"><times id="S3.E5.m1.5.5.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1"></times><apply id="S3.E5.m1.5.5.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.2.2">Encoder</ci><ci id="S3.E5.m1.5.5.1.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.2.3">italic-Ï•</ci></apply><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">ğ‘‘</ci></apply><apply id="S3.E5.m1.6.6.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2"><times id="S3.E5.m1.6.6.2.2.2.1.cmml" xref="S3.E5.m1.6.6.2.2.2.1"></times><apply id="S3.E5.m1.6.6.2.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.2.2.2.2.1.cmml" xref="S3.E5.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.2.2.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2">Encoder</ci><ci id="S3.E5.m1.6.6.2.2.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.2.2.3">italic-Ï•</ci></apply><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">ğ‘¡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">\displaystyle s_{\phi}(d,t)=\langle\mathrm{Encoder}_{\phi}(d),\mathrm{Encoder}%
_{\phi}(t)\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.6d">italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_d , italic_t ) = âŸ¨ roman_Encoder start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_d ) , roman_Encoder start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t ) âŸ©</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.25">Once the relevant document <math alttext="d^{*}" class="ltx_Math" display="inline" id="S3.p3.23.m1.1"><semantics id="S3.p3.23.m1.1a"><msup id="S3.p3.23.m1.1.1" xref="S3.p3.23.m1.1.1.cmml"><mi id="S3.p3.23.m1.1.1.2" xref="S3.p3.23.m1.1.1.2.cmml">d</mi><mo id="S3.p3.23.m1.1.1.3" xref="S3.p3.23.m1.1.1.3.cmml">âˆ—</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p3.23.m1.1b"><apply id="S3.p3.23.m1.1.1.cmml" xref="S3.p3.23.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.23.m1.1.1.1.cmml" xref="S3.p3.23.m1.1.1">superscript</csymbol><ci id="S3.p3.23.m1.1.1.2.cmml" xref="S3.p3.23.m1.1.1.2">ğ‘‘</ci><times id="S3.p3.23.m1.1.1.3.cmml" xref="S3.p3.23.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.23.m1.1c">d^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.23.m1.1d">italic_d start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT</annotation></semantics></math> is retrieved, it is fed into the LM along with the initial input <math alttext="t" class="ltx_Math" display="inline" id="S3.p3.24.m2.1"><semantics id="S3.p3.24.m2.1a"><mi id="S3.p3.24.m2.1.1" xref="S3.p3.24.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.24.m2.1b"><ci id="S3.p3.24.m2.1.1.cmml" xref="S3.p3.24.m2.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.24.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.24.m2.1d">italic_t</annotation></semantics></math> to estimate the output probability <math alttext="p_{\mathrm{LM}}(z|d^{*},t)" class="ltx_Math" display="inline" id="S3.p3.25.m3.2"><semantics id="S3.p3.25.m3.2a"><mrow id="S3.p3.25.m3.2.2" xref="S3.p3.25.m3.2.2.cmml"><msub id="S3.p3.25.m3.2.2.3" xref="S3.p3.25.m3.2.2.3.cmml"><mi id="S3.p3.25.m3.2.2.3.2" xref="S3.p3.25.m3.2.2.3.2.cmml">p</mi><mi id="S3.p3.25.m3.2.2.3.3" xref="S3.p3.25.m3.2.2.3.3.cmml">LM</mi></msub><mo id="S3.p3.25.m3.2.2.2" xref="S3.p3.25.m3.2.2.2.cmml">â¢</mo><mrow id="S3.p3.25.m3.2.2.1.1" xref="S3.p3.25.m3.2.2.1.1.1.cmml"><mo id="S3.p3.25.m3.2.2.1.1.2" stretchy="false" xref="S3.p3.25.m3.2.2.1.1.1.cmml">(</mo><mrow id="S3.p3.25.m3.2.2.1.1.1" xref="S3.p3.25.m3.2.2.1.1.1.cmml"><mi id="S3.p3.25.m3.2.2.1.1.1.3" xref="S3.p3.25.m3.2.2.1.1.1.3.cmml">z</mi><mo fence="false" id="S3.p3.25.m3.2.2.1.1.1.2" xref="S3.p3.25.m3.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.p3.25.m3.2.2.1.1.1.1.1" xref="S3.p3.25.m3.2.2.1.1.1.1.2.cmml"><msup id="S3.p3.25.m3.2.2.1.1.1.1.1.1" xref="S3.p3.25.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S3.p3.25.m3.2.2.1.1.1.1.1.1.2" xref="S3.p3.25.m3.2.2.1.1.1.1.1.1.2.cmml">d</mi><mo id="S3.p3.25.m3.2.2.1.1.1.1.1.1.3" xref="S3.p3.25.m3.2.2.1.1.1.1.1.1.3.cmml">âˆ—</mo></msup><mo id="S3.p3.25.m3.2.2.1.1.1.1.1.2" xref="S3.p3.25.m3.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.p3.25.m3.1.1" xref="S3.p3.25.m3.1.1.cmml">t</mi></mrow></mrow><mo id="S3.p3.25.m3.2.2.1.1.3" stretchy="false" xref="S3.p3.25.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.25.m3.2b"><apply id="S3.p3.25.m3.2.2.cmml" xref="S3.p3.25.m3.2.2"><times id="S3.p3.25.m3.2.2.2.cmml" xref="S3.p3.25.m3.2.2.2"></times><apply id="S3.p3.25.m3.2.2.3.cmml" xref="S3.p3.25.m3.2.2.3"><csymbol cd="ambiguous" id="S3.p3.25.m3.2.2.3.1.cmml" xref="S3.p3.25.m3.2.2.3">subscript</csymbol><ci id="S3.p3.25.m3.2.2.3.2.cmml" xref="S3.p3.25.m3.2.2.3.2">ğ‘</ci><ci id="S3.p3.25.m3.2.2.3.3.cmml" xref="S3.p3.25.m3.2.2.3.3">LM</ci></apply><apply id="S3.p3.25.m3.2.2.1.1.1.cmml" xref="S3.p3.25.m3.2.2.1.1"><csymbol cd="latexml" id="S3.p3.25.m3.2.2.1.1.1.2.cmml" xref="S3.p3.25.m3.2.2.1.1.1.2">conditional</csymbol><ci id="S3.p3.25.m3.2.2.1.1.1.3.cmml" xref="S3.p3.25.m3.2.2.1.1.1.3">ğ‘§</ci><list id="S3.p3.25.m3.2.2.1.1.1.1.2.cmml" xref="S3.p3.25.m3.2.2.1.1.1.1.1"><apply id="S3.p3.25.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.p3.25.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.25.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p3.25.m3.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p3.25.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.p3.25.m3.2.2.1.1.1.1.1.1.2">ğ‘‘</ci><times id="S3.p3.25.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S3.p3.25.m3.2.2.1.1.1.1.1.1.3"></times></apply><ci id="S3.p3.25.m3.1.1.cmml" xref="S3.p3.25.m3.1.1">ğ‘¡</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.25.m3.2c">p_{\mathrm{LM}}(z|d^{*},t)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.25.m3.2d">italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_z | italic_d start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT , italic_t )</annotation></semantics></math>. This approach enables LMs to leverage external knowledge and generate more accurate and informative responses.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<figure class="ltx_figure" id="S4.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="105" id="S4.F1.sf1.g1" src="extracted/5898142/Figs/framework_others.png" width="384"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>InstructGLM</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="82" id="S4.F1.sf2.g1" src="extracted/5898142/Figs/framework_ours.png" width="384"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text ltx_font_smallcaps" id="S4.F1.sf2.2.1">AugGLMÂ </span>(ours)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison of pipelines between the existing instruction-tuned LM InstructGLM and our approach, <span class="ltx_text ltx_font_smallcaps" id="S4.F1.3.1">AugGLMÂ </span>. Unlike InstructGLM, which explicitly encodes graph information into token embeddings as a form of soft prompting, <span class="ltx_text ltx_font_smallcaps" id="S4.F1.4.2">AugGLMÂ </span>maintains the original text-to-text framework of the off-the-shelf LM, offering greater generality and flexibility.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We explore the application of LMs to node classification tasks in graph learning, leveraging the instruction tuning paradigm to reformulate node classification as a text-to-text taskÂ <cite class="ltx_cite ltx_citemacro_cite">Raffel etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib41" title="">2020</a>)</cite>. Our method employs a carefully designed prompt template and a set of augmentation techniques to transform graph data and ground truth labels into text pairs. This enables LMs to comprehend and be fine-tuned for the task without requiring modifications to their underlying architecture.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">As shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.F1" title="Figure 1 â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">1</span></a>, our approach differs from InstructGLMÂ <cite class="ltx_cite ltx_citemacro_citep">(Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>)</cite>, the current state-of-the-art LM for TAGs, in its underlying design. While both methods utilize prompt templates to transform input graphs into text, InstructGLM relies on explicit encoding of node embeddings into the LMâ€™s token embeddings as a form of soft promptingÂ <cite class="ltx_cite ltx_citemacro_citep">(Lester etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib31" title="">2021</a>)</cite>. In contrast, our approach provides a more general framework, leveraging gradient descent through the LM without modifying its underlying text-to-text architecture. This design choice enables our model to retain the versatility of the original LM while adapting it to graph-based tasks. The following sections provide a detailed description of the specific techniques developed in the paper to achieve this goal.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Retrieval-Based Aggregation</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">General LMs are not designed to directly process graph-structured data. To overcome this limitation, a common approach is to employ prompt templates that transform graph data and associated tasks into a textual format that LMs can understand. For instance, consider the CoraÂ <cite class="ltx_cite ltx_citemacro_citep">(Sen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib42" title="">2008</a>)</cite> literature citation graph. A typical templateÂ <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib25" title="">2023</a>; Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>)</cite> for node classification, as shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.F2" title="Figure 2 â€£ 4.1 Retrieval-Based Aggregation â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">2</span></a> consists of three main components: (1) a short description of the classification task, (2) the target nodeâ€™s textual features, such as its title and abstract, and (3) textual features from relevant neighboring nodes within the graph.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="167" id="S4.F2.g1" src="extracted/5898142/Figs/template_others.png" width="302"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>A typical graph-to-text template for node classification.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">The success of the message-passing graph neural networks (GNNs) highlights the importance of the aggregation operation, whose typical examples are the sum and max pooling operations of intermediate node embeddings. A similar spirit is followed for the LM-based classifiers whose key design is at the selection of relevant nodes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">While existing worksÂ <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib25" title="">2023</a>; Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>)</cite> select 1-hop or multi-hop neighbors as relevant nodes, we posit that this approach is suboptimal for two key reasons. Firstly, not all immediate or extended neighbors provide useful information for classifying the target node which can introduce noise and degrade model performance. Secondly, incorporating multi-hop neighbors can lead to â€œneighbor explosionâ€Â <cite class="ltx_cite ltx_citemacro_citep">(Hamilton etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib19" title="">2017</a>; Chen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib8" title="">2018</a>; Fey etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib17" title="">2021</a>)</cite>, i.e., an exponentially-growing set of â€œrelevantâ€ nodes, resulting in increased computational costs, slower model training/inference, and even out-of-memory issue. To address these limitations, we propose two novel solutions for selecting relevant nodes: topological retrieval and prototypical semantic retrieval. These methods are designed to efficiently identify the most informative nodes, thereby enhancing the modelâ€™s ability to capture meaningful graph structures and improve its overall performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.5"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.5.1">Topological Retrieval.</span> We leverage PPRÂ <cite class="ltx_cite ltx_citemacro_citep">(Page, <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib39" title="">1999</a>; Jeh &amp; Widom, <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib27" title="">2003</a>)</cite> to perform topological retrieval, which has shown great effectiveness in conjunction with GNNsÂ <cite class="ltx_cite ltx_citemacro_citep">(Klicpera etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib30" title="">2019</a>)</cite>. The success of PPR suggests that the neighbors it identifies may provide more informative context than generic 1-hop or multi-hop neighbors. Specifically, for a target node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><msub id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">v</mi><mi id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">ğ‘£</ci><ci id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we select its top-<math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">italic_K</annotation></semantics></math> neighbors <math alttext="\mathtt{PPR\ neigh}(v_{i})" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">ğ™¿ğ™¿ğš</mi><mo id="S4.SS1.p4.3.m3.1.1.2" lspace="0.500em" xref="S4.SS1.p4.3.m3.1.1.2.cmml">â¢</mo><mi id="S4.SS1.p4.3.m3.1.1.4" xref="S4.SS1.p4.3.m3.1.1.4.cmml">ğš—ğšğš’ğšğš‘</mi><mo id="S4.SS1.p4.3.m3.1.1.2a" xref="S4.SS1.p4.3.m3.1.1.2.cmml">â¢</mo><mrow id="S4.SS1.p4.3.m3.1.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS1.p4.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.p4.3.m3.1.1.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.1.1.1.2" xref="S4.SS1.p4.3.m3.1.1.1.1.1.2.cmml">v</mi><mi id="S4.SS1.p4.3.m3.1.1.1.1.1.3" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p4.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><times id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2"></times><ci id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">ğ™¿ğ™¿ğš</ci><ci id="S4.SS1.p4.3.m3.1.1.4.cmml" xref="S4.SS1.p4.3.m3.1.1.4">ğš—ğšğš’ğšğš‘</ci><apply id="S4.SS1.p4.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.2">ğ‘£</ci><ci id="S4.SS1.p4.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.1.1.1.3">ğ‘–</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">\mathtt{PPR\ neigh}(v_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">typewriter_PPR typewriter_neigh ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> based on their PPR scores, computed using Eqs.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E1" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">1</span></a>) andÂ (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E2" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">2</span></a>). The details of the PPR algorithm are introduced in SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3" title="3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">3</span></a>. We then concatenate the text features from the PPR neighbors to form the PPR-retrieved text <math alttext="t^{\textrm{PPR retri}}=\mathop{\oplus}_{j;v_{j}\in\mathtt{PPR\ neigh}(v_{i})}t%
_{j}" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.3"><semantics id="S4.SS1.p4.4.m4.3a"><mrow id="S4.SS1.p4.4.m4.3.4" xref="S4.SS1.p4.4.m4.3.4.cmml"><msup id="S4.SS1.p4.4.m4.3.4.2" xref="S4.SS1.p4.4.m4.3.4.2.cmml"><mi id="S4.SS1.p4.4.m4.3.4.2.2" xref="S4.SS1.p4.4.m4.3.4.2.2.cmml">t</mi><mtext id="S4.SS1.p4.4.m4.3.4.2.3" xref="S4.SS1.p4.4.m4.3.4.2.3a.cmml">PPR retri</mtext></msup><mo id="S4.SS1.p4.4.m4.3.4.1" rspace="0.1389em" xref="S4.SS1.p4.4.m4.3.4.1.cmml">=</mo><mrow id="S4.SS1.p4.4.m4.3.4.3" xref="S4.SS1.p4.4.m4.3.4.3.cmml"><msub id="S4.SS1.p4.4.m4.3.4.3.1" xref="S4.SS1.p4.4.m4.3.4.3.1.cmml"><mo id="S4.SS1.p4.4.m4.3.4.3.1.2" lspace="0.1389em" rspace="0.167em" xref="S4.SS1.p4.4.m4.3.4.3.1.2.cmml">âŠ•</mo><mrow id="S4.SS1.p4.4.m4.3.3.3" xref="S4.SS1.p4.4.m4.3.3.3.cmml"><mrow id="S4.SS1.p4.4.m4.2.2.2.2.1" xref="S4.SS1.p4.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.p4.4.m4.1.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.1.cmml">j</mi><mo id="S4.SS1.p4.4.m4.2.2.2.2.1.2" xref="S4.SS1.p4.4.m4.2.2.2.2.2.cmml">;</mo><msub id="S4.SS1.p4.4.m4.2.2.2.2.1.1" xref="S4.SS1.p4.4.m4.2.2.2.2.1.1.cmml"><mi id="S4.SS1.p4.4.m4.2.2.2.2.1.1.2" xref="S4.SS1.p4.4.m4.2.2.2.2.1.1.2.cmml">v</mi><mi id="S4.SS1.p4.4.m4.2.2.2.2.1.1.3" xref="S4.SS1.p4.4.m4.2.2.2.2.1.1.3.cmml">j</mi></msub></mrow><mo id="S4.SS1.p4.4.m4.3.3.3.4" xref="S4.SS1.p4.4.m4.3.3.3.4.cmml">âˆˆ</mo><mrow id="S4.SS1.p4.4.m4.3.3.3.3" xref="S4.SS1.p4.4.m4.3.3.3.3.cmml"><mi id="S4.SS1.p4.4.m4.3.3.3.3.3" xref="S4.SS1.p4.4.m4.3.3.3.3.3.cmml">ğ™¿ğ™¿ğš</mi><mo id="S4.SS1.p4.4.m4.3.3.3.3.2" lspace="0.350em" xref="S4.SS1.p4.4.m4.3.3.3.3.2.cmml">â¢</mo><mi id="S4.SS1.p4.4.m4.3.3.3.3.4" xref="S4.SS1.p4.4.m4.3.3.3.3.4.cmml">ğš—ğšğš’ğšğš‘</mi><mo id="S4.SS1.p4.4.m4.3.3.3.3.2a" xref="S4.SS1.p4.4.m4.3.3.3.3.2.cmml">â¢</mo><mrow id="S4.SS1.p4.4.m4.3.3.3.3.1.1" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.cmml"><mo id="S4.SS1.p4.4.m4.3.3.3.3.1.1.2" stretchy="false" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.cmml">(</mo><msub id="S4.SS1.p4.4.m4.3.3.3.3.1.1.1" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.cmml"><mi id="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.2" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.2.cmml">v</mi><mi id="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.3" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p4.4.m4.3.3.3.3.1.1.3" stretchy="false" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><msub id="S4.SS1.p4.4.m4.3.4.3.2" xref="S4.SS1.p4.4.m4.3.4.3.2.cmml"><mi id="S4.SS1.p4.4.m4.3.4.3.2.2" xref="S4.SS1.p4.4.m4.3.4.3.2.2.cmml">t</mi><mi id="S4.SS1.p4.4.m4.3.4.3.2.3" xref="S4.SS1.p4.4.m4.3.4.3.2.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.3b"><apply id="S4.SS1.p4.4.m4.3.4.cmml" xref="S4.SS1.p4.4.m4.3.4"><eq id="S4.SS1.p4.4.m4.3.4.1.cmml" xref="S4.SS1.p4.4.m4.3.4.1"></eq><apply id="S4.SS1.p4.4.m4.3.4.2.cmml" xref="S4.SS1.p4.4.m4.3.4.2"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m4.3.4.2.1.cmml" xref="S4.SS1.p4.4.m4.3.4.2">superscript</csymbol><ci id="S4.SS1.p4.4.m4.3.4.2.2.cmml" xref="S4.SS1.p4.4.m4.3.4.2.2">ğ‘¡</ci><ci id="S4.SS1.p4.4.m4.3.4.2.3a.cmml" xref="S4.SS1.p4.4.m4.3.4.2.3"><mtext id="S4.SS1.p4.4.m4.3.4.2.3.cmml" mathsize="70%" xref="S4.SS1.p4.4.m4.3.4.2.3">PPR retri</mtext></ci></apply><apply id="S4.SS1.p4.4.m4.3.4.3.cmml" xref="S4.SS1.p4.4.m4.3.4.3"><apply id="S4.SS1.p4.4.m4.3.4.3.1.cmml" xref="S4.SS1.p4.4.m4.3.4.3.1"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m4.3.4.3.1.1.cmml" xref="S4.SS1.p4.4.m4.3.4.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.SS1.p4.4.m4.3.4.3.1.2.cmml" xref="S4.SS1.p4.4.m4.3.4.3.1.2">direct-sum</csymbol><apply id="S4.SS1.p4.4.m4.3.3.3.cmml" xref="S4.SS1.p4.4.m4.3.3.3"><in id="S4.SS1.p4.4.m4.3.3.3.4.cmml" xref="S4.SS1.p4.4.m4.3.3.3.4"></in><list id="S4.SS1.p4.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.p4.4.m4.2.2.2.2.1"><ci id="S4.SS1.p4.4.m4.1.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1">ğ‘—</ci><apply id="S4.SS1.p4.4.m4.2.2.2.2.1.1.cmml" xref="S4.SS1.p4.4.m4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m4.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p4.4.m4.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p4.4.m4.2.2.2.2.1.1.2.cmml" xref="S4.SS1.p4.4.m4.2.2.2.2.1.1.2">ğ‘£</ci><ci id="S4.SS1.p4.4.m4.2.2.2.2.1.1.3.cmml" xref="S4.SS1.p4.4.m4.2.2.2.2.1.1.3">ğ‘—</ci></apply></list><apply id="S4.SS1.p4.4.m4.3.3.3.3.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3"><times id="S4.SS1.p4.4.m4.3.3.3.3.2.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3.2"></times><ci id="S4.SS1.p4.4.m4.3.3.3.3.3.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3.3">ğ™¿ğ™¿ğš</ci><ci id="S4.SS1.p4.4.m4.3.3.3.3.4.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3.4">ğš—ğšğš’ğšğš‘</ci><apply id="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.1.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1">subscript</csymbol><ci id="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.2.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.2">ğ‘£</ci><ci id="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.3.cmml" xref="S4.SS1.p4.4.m4.3.3.3.3.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply><apply id="S4.SS1.p4.4.m4.3.4.3.2.cmml" xref="S4.SS1.p4.4.m4.3.4.3.2"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m4.3.4.3.2.1.cmml" xref="S4.SS1.p4.4.m4.3.4.3.2">subscript</csymbol><ci id="S4.SS1.p4.4.m4.3.4.3.2.2.cmml" xref="S4.SS1.p4.4.m4.3.4.3.2.2">ğ‘¡</ci><ci id="S4.SS1.p4.4.m4.3.4.3.2.3.cmml" xref="S4.SS1.p4.4.m4.3.4.3.2.3">ğ‘—</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.3c">t^{\textrm{PPR retri}}=\mathop{\oplus}_{j;v_{j}\in\mathtt{PPR\ neigh}(v_{i})}t%
_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m4.3d">italic_t start_POSTSUPERSCRIPT PPR retri end_POSTSUPERSCRIPT = âŠ• start_POSTSUBSCRIPT italic_j ; italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ typewriter_PPR typewriter_neigh ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\oplus" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1"><semantics id="S4.SS1.p4.5.m5.1a"><mo id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml">âŠ•</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><csymbol cd="latexml" id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m5.1d">âŠ•</annotation></semantics></math> denotes text concatenation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1">It is worth noting that the classic PPR algorithm is computationally expensive for large graphs due to the matrix multiplication (Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E1" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">1</span></a>)). However, efficient approximate solutions such as ApproximatePRÂ <cite class="ltx_cite ltx_citemacro_citep">(Andersen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib2" title="">2006</a>)</cite>, can be applied to mitigate this issue. Nevertheless, PPR is a topology-based heuristic that does not inherently leverage textual features nor adapt to feedback from downstream node classification tasks. To address these limitations and enhance our frameworkâ€™s semantic awareness, we propose a complementary semantic retrieval strategy, which is discussed in the following section.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p6.1.1">Prototypical Semantic Retrieval.</span> Our semantic retrieval module draws inspiration from two popular techniques: (1) RAGÂ <cite class="ltx_cite ltx_citemacro_citep">(Lewis etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib32" title="">2020</a>; Guu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib18" title="">2020</a>)</cite>, which leverage external corpora to answer knowledge-intensive questions, and (2) Graph TransformersÂ <cite class="ltx_cite ltx_citemacro_citep">(Min etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib37" title="">2022</a>)</cite> which aggregate messages from distant nodes via inner product-based attention weights. In the context of node classification, we treat the textual features of all nodes except the target node as a surrogate â€œexternal corpus.â€ However, unlike typical question-answering tasks, retrieving textual features from a single node is often insufficient for accurate node classification. To address this limitation, we enhance the semantic retrieval process by focusing on prototypes, which capture the essence of each classÂ <cite class="ltx_cite ltx_citemacro_citep">(Snell etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib44" title="">2017</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p7">
<p class="ltx_p" id="S4.SS1.p7.3">We employ prototypesÂ <cite class="ltx_cite ltx_citemacro_citep">(Biehl etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib3" title="">2016</a>)</cite> as representative examples in the classification problem. To obtain these prototypes, we first pretrain a lightweight GNN <math alttext="\mathtt{GNN}_{\psi}" class="ltx_Math" display="inline" id="S4.SS1.p7.1.m1.1"><semantics id="S4.SS1.p7.1.m1.1a"><msub id="S4.SS1.p7.1.m1.1.1" xref="S4.SS1.p7.1.m1.1.1.cmml"><mi id="S4.SS1.p7.1.m1.1.1.2" xref="S4.SS1.p7.1.m1.1.1.2.cmml">ğ™¶ğ™½ğ™½</mi><mi id="S4.SS1.p7.1.m1.1.1.3" xref="S4.SS1.p7.1.m1.1.1.3.cmml">Ïˆ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.1.m1.1b"><apply id="S4.SS1.p7.1.m1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.1.m1.1.1.1.cmml" xref="S4.SS1.p7.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p7.1.m1.1.1.2.cmml" xref="S4.SS1.p7.1.m1.1.1.2">ğ™¶ğ™½ğ™½</ci><ci id="S4.SS1.p7.1.m1.1.1.3.cmml" xref="S4.SS1.p7.1.m1.1.1.3">ğœ“</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.1.m1.1c">\mathtt{GNN}_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.1.m1.1d">typewriter_GNN start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT</annotation></semantics></math>, in a semi-supervised manner. This GNN generates a prediction vector for each node: <math alttext="\tilde{\mathbf{y}}_{i}=\mathtt{GNN}_{\psi}(v_{i},\mathcal{G})\in\mathbb{R}^{c}%
,\forall v_{i}\in\mathcal{V}" class="ltx_Math" display="inline" id="S4.SS1.p7.2.m2.3"><semantics id="S4.SS1.p7.2.m2.3a"><mrow id="S4.SS1.p7.2.m2.3.3.2" xref="S4.SS1.p7.2.m2.3.3.3.cmml"><mrow id="S4.SS1.p7.2.m2.2.2.1.1" xref="S4.SS1.p7.2.m2.2.2.1.1.cmml"><msub id="S4.SS1.p7.2.m2.2.2.1.1.3" xref="S4.SS1.p7.2.m2.2.2.1.1.3.cmml"><mover accent="true" id="S4.SS1.p7.2.m2.2.2.1.1.3.2" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2.cmml"><mi id="S4.SS1.p7.2.m2.2.2.1.1.3.2.2" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2.2.cmml">ğ²</mi><mo id="S4.SS1.p7.2.m2.2.2.1.1.3.2.1" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2.1.cmml">~</mo></mover><mi id="S4.SS1.p7.2.m2.2.2.1.1.3.3" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS1.p7.2.m2.2.2.1.1.4" xref="S4.SS1.p7.2.m2.2.2.1.1.4.cmml">=</mo><mrow id="S4.SS1.p7.2.m2.2.2.1.1.1" xref="S4.SS1.p7.2.m2.2.2.1.1.1.cmml"><msub id="S4.SS1.p7.2.m2.2.2.1.1.1.3" xref="S4.SS1.p7.2.m2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.p7.2.m2.2.2.1.1.1.3.2" xref="S4.SS1.p7.2.m2.2.2.1.1.1.3.2.cmml">ğ™¶ğ™½ğ™½</mi><mi id="S4.SS1.p7.2.m2.2.2.1.1.1.3.3" xref="S4.SS1.p7.2.m2.2.2.1.1.1.3.3.cmml">Ïˆ</mi></msub><mo id="S4.SS1.p7.2.m2.2.2.1.1.1.2" xref="S4.SS1.p7.2.m2.2.2.1.1.1.2.cmml">â¢</mo><mrow id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.2.cmml"><mo id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.2.cmml">(</mo><msub id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.2" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.3" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.3" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.2.m2.1.1" xref="S4.SS1.p7.2.m2.1.1.cmml">ğ’¢</mi><mo id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.4" stretchy="false" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p7.2.m2.2.2.1.1.5" xref="S4.SS1.p7.2.m2.2.2.1.1.5.cmml">âˆˆ</mo><msup id="S4.SS1.p7.2.m2.2.2.1.1.6" xref="S4.SS1.p7.2.m2.2.2.1.1.6.cmml"><mi id="S4.SS1.p7.2.m2.2.2.1.1.6.2" xref="S4.SS1.p7.2.m2.2.2.1.1.6.2.cmml">â„</mi><mi id="S4.SS1.p7.2.m2.2.2.1.1.6.3" xref="S4.SS1.p7.2.m2.2.2.1.1.6.3.cmml">c</mi></msup></mrow><mo id="S4.SS1.p7.2.m2.3.3.2.3" xref="S4.SS1.p7.2.m2.3.3.3a.cmml">,</mo><mrow id="S4.SS1.p7.2.m2.3.3.2.2" xref="S4.SS1.p7.2.m2.3.3.2.2.cmml"><mrow id="S4.SS1.p7.2.m2.3.3.2.2.2" xref="S4.SS1.p7.2.m2.3.3.2.2.2.cmml"><mo id="S4.SS1.p7.2.m2.3.3.2.2.2.1" rspace="0.167em" xref="S4.SS1.p7.2.m2.3.3.2.2.2.1.cmml">âˆ€</mo><msub id="S4.SS1.p7.2.m2.3.3.2.2.2.2" xref="S4.SS1.p7.2.m2.3.3.2.2.2.2.cmml"><mi id="S4.SS1.p7.2.m2.3.3.2.2.2.2.2" xref="S4.SS1.p7.2.m2.3.3.2.2.2.2.2.cmml">v</mi><mi id="S4.SS1.p7.2.m2.3.3.2.2.2.2.3" xref="S4.SS1.p7.2.m2.3.3.2.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.SS1.p7.2.m2.3.3.2.2.1" xref="S4.SS1.p7.2.m2.3.3.2.2.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.2.m2.3.3.2.2.3" xref="S4.SS1.p7.2.m2.3.3.2.2.3.cmml">ğ’±</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.2.m2.3b"><apply id="S4.SS1.p7.2.m2.3.3.3.cmml" xref="S4.SS1.p7.2.m2.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.3.3.3a.cmml" xref="S4.SS1.p7.2.m2.3.3.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p7.2.m2.2.2.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1"><and id="S4.SS1.p7.2.m2.2.2.1.1a.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1"></and><apply id="S4.SS1.p7.2.m2.2.2.1.1b.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1"><eq id="S4.SS1.p7.2.m2.2.2.1.1.4.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.4"></eq><apply id="S4.SS1.p7.2.m2.2.2.1.1.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.1.1.3.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3">subscript</csymbol><apply id="S4.SS1.p7.2.m2.2.2.1.1.3.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2"><ci id="S4.SS1.p7.2.m2.2.2.1.1.3.2.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2.1">~</ci><ci id="S4.SS1.p7.2.m2.2.2.1.1.3.2.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.2.2">ğ²</ci></apply><ci id="S4.SS1.p7.2.m2.2.2.1.1.3.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.3.3">ğ‘–</ci></apply><apply id="S4.SS1.p7.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1"><times id="S4.SS1.p7.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.2"></times><apply id="S4.SS1.p7.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p7.2.m2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.3.2">ğ™¶ğ™½ğ™½</ci><ci id="S4.SS1.p7.2.m2.2.2.1.1.1.3.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.3.3">ğœ“</ci></apply><interval closure="open" id="S4.SS1.p7.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1"><apply id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.2">ğ‘£</ci><ci id="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.1.1.1.1.3">ğ‘–</ci></apply><ci id="S4.SS1.p7.2.m2.1.1.cmml" xref="S4.SS1.p7.2.m2.1.1">ğ’¢</ci></interval></apply></apply><apply id="S4.SS1.p7.2.m2.2.2.1.1c.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1"><in id="S4.SS1.p7.2.m2.2.2.1.1.5.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.5"></in><share href="https://arxiv.org/html/2410.02296v1#S4.SS1.p7.2.m2.2.2.1.1.1.cmml" id="S4.SS1.p7.2.m2.2.2.1.1d.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1"></share><apply id="S4.SS1.p7.2.m2.2.2.1.1.6.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.2.2.1.1.6.1.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.6">superscript</csymbol><ci id="S4.SS1.p7.2.m2.2.2.1.1.6.2.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.6.2">â„</ci><ci id="S4.SS1.p7.2.m2.2.2.1.1.6.3.cmml" xref="S4.SS1.p7.2.m2.2.2.1.1.6.3">ğ‘</ci></apply></apply></apply><apply id="S4.SS1.p7.2.m2.3.3.2.2.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2"><in id="S4.SS1.p7.2.m2.3.3.2.2.1.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.1"></in><apply id="S4.SS1.p7.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.2"><csymbol cd="latexml" id="S4.SS1.p7.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.2.1">for-all</csymbol><apply id="S4.SS1.p7.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p7.2.m2.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p7.2.m2.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.2.2.2">ğ‘£</ci><ci id="S4.SS1.p7.2.m2.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.2.2.3">ğ‘–</ci></apply></apply><ci id="S4.SS1.p7.2.m2.3.3.2.2.3.cmml" xref="S4.SS1.p7.2.m2.3.3.2.2.3">ğ’±</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.2.m2.3c">\tilde{\mathbf{y}}_{i}=\mathtt{GNN}_{\psi}(v_{i},\mathcal{G})\in\mathbb{R}^{c}%
,\forall v_{i}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.2.m2.3d">over~ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = typewriter_GNN start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , caligraphic_G ) âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT , âˆ€ italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ caligraphic_V</annotation></semantics></math>. We then compute the prediction confidence for each node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS1.p7.3.m3.1"><semantics id="S4.SS1.p7.3.m3.1a"><msub id="S4.SS1.p7.3.m3.1.1" xref="S4.SS1.p7.3.m3.1.1.cmml"><mi id="S4.SS1.p7.3.m3.1.1.2" xref="S4.SS1.p7.3.m3.1.1.2.cmml">v</mi><mi id="S4.SS1.p7.3.m3.1.1.3" xref="S4.SS1.p7.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.3.m3.1b"><apply id="S4.SS1.p7.3.m3.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.3.m3.1.1.1.cmml" xref="S4.SS1.p7.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p7.3.m3.1.1.2.cmml" xref="S4.SS1.p7.3.m3.1.1.2">ğ‘£</ci><ci id="S4.SS1.p7.3.m3.1.1.3.cmml" xref="S4.SS1.p7.3.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.3.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> using the maximum logit:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx6">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathtt{Conf}(v_{i})=\max_{j}\tilde{\mathbf{y}}_{i}[j]\in\mathbb{R}" class="ltx_Math" display="inline" id="S4.E6.m1.2"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><mrow id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.cmml"><mi id="S4.E6.m1.2.2.1.3" xref="S4.E6.m1.2.2.1.3.cmml">ğ™²ğš˜ğš—ğš</mi><mo id="S4.E6.m1.2.2.1.2" xref="S4.E6.m1.2.2.1.2.cmml">â¢</mo><mrow id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.cmml"><mo id="S4.E6.m1.2.2.1.1.1.2" stretchy="false" xref="S4.E6.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S4.E6.m1.2.2.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.2.cmml">v</mi><mi id="S4.E6.m1.2.2.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.2.2.1.1.1.3" stretchy="false" xref="S4.E6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.2.2.3" xref="S4.E6.m1.2.2.3.cmml">=</mo><mrow id="S4.E6.m1.2.2.4" xref="S4.E6.m1.2.2.4.cmml"><mrow id="S4.E6.m1.2.2.4.2" xref="S4.E6.m1.2.2.4.2.cmml"><munder id="S4.E6.m1.2.2.4.2.1" xref="S4.E6.m1.2.2.4.2.1.cmml"><mi id="S4.E6.m1.2.2.4.2.1.2" xref="S4.E6.m1.2.2.4.2.1.2.cmml">max</mi><mi id="S4.E6.m1.2.2.4.2.1.3" xref="S4.E6.m1.2.2.4.2.1.3.cmml">j</mi></munder><mo id="S4.E6.m1.2.2.4.2a" lspace="0.167em" xref="S4.E6.m1.2.2.4.2.cmml">â¡</mo><msub id="S4.E6.m1.2.2.4.2.2" xref="S4.E6.m1.2.2.4.2.2.cmml"><mover accent="true" id="S4.E6.m1.2.2.4.2.2.2" xref="S4.E6.m1.2.2.4.2.2.2.cmml"><mi id="S4.E6.m1.2.2.4.2.2.2.2" xref="S4.E6.m1.2.2.4.2.2.2.2.cmml">ğ²</mi><mo id="S4.E6.m1.2.2.4.2.2.2.1" xref="S4.E6.m1.2.2.4.2.2.2.1.cmml">~</mo></mover><mi id="S4.E6.m1.2.2.4.2.2.3" xref="S4.E6.m1.2.2.4.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.E6.m1.2.2.4.1" xref="S4.E6.m1.2.2.4.1.cmml">â¢</mo><mrow id="S4.E6.m1.2.2.4.3.2" xref="S4.E6.m1.2.2.4.3.1.cmml"><mo id="S4.E6.m1.2.2.4.3.2.1" stretchy="false" xref="S4.E6.m1.2.2.4.3.1.1.cmml">[</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">j</mi><mo id="S4.E6.m1.2.2.4.3.2.2" stretchy="false" xref="S4.E6.m1.2.2.4.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E6.m1.2.2.5" xref="S4.E6.m1.2.2.5.cmml">âˆˆ</mo><mi id="S4.E6.m1.2.2.6" xref="S4.E6.m1.2.2.6.cmml">â„</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><and id="S4.E6.m1.2.2a.cmml" xref="S4.E6.m1.2.2"></and><apply id="S4.E6.m1.2.2b.cmml" xref="S4.E6.m1.2.2"><eq id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2.3"></eq><apply id="S4.E6.m1.2.2.1.cmml" xref="S4.E6.m1.2.2.1"><times id="S4.E6.m1.2.2.1.2.cmml" xref="S4.E6.m1.2.2.1.2"></times><ci id="S4.E6.m1.2.2.1.3.cmml" xref="S4.E6.m1.2.2.1.3">ğ™²ğš˜ğš—ğš</ci><apply id="S4.E6.m1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2">ğ‘£</ci><ci id="S4.E6.m1.2.2.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="S4.E6.m1.2.2.4.cmml" xref="S4.E6.m1.2.2.4"><times id="S4.E6.m1.2.2.4.1.cmml" xref="S4.E6.m1.2.2.4.1"></times><apply id="S4.E6.m1.2.2.4.2.cmml" xref="S4.E6.m1.2.2.4.2"><apply id="S4.E6.m1.2.2.4.2.1.cmml" xref="S4.E6.m1.2.2.4.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.2.1.1.cmml" xref="S4.E6.m1.2.2.4.2.1">subscript</csymbol><max id="S4.E6.m1.2.2.4.2.1.2.cmml" xref="S4.E6.m1.2.2.4.2.1.2"></max><ci id="S4.E6.m1.2.2.4.2.1.3.cmml" xref="S4.E6.m1.2.2.4.2.1.3">ğ‘—</ci></apply><apply id="S4.E6.m1.2.2.4.2.2.cmml" xref="S4.E6.m1.2.2.4.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.4.2.2.1.cmml" xref="S4.E6.m1.2.2.4.2.2">subscript</csymbol><apply id="S4.E6.m1.2.2.4.2.2.2.cmml" xref="S4.E6.m1.2.2.4.2.2.2"><ci id="S4.E6.m1.2.2.4.2.2.2.1.cmml" xref="S4.E6.m1.2.2.4.2.2.2.1">~</ci><ci id="S4.E6.m1.2.2.4.2.2.2.2.cmml" xref="S4.E6.m1.2.2.4.2.2.2.2">ğ²</ci></apply><ci id="S4.E6.m1.2.2.4.2.2.3.cmml" xref="S4.E6.m1.2.2.4.2.2.3">ğ‘–</ci></apply></apply><apply id="S4.E6.m1.2.2.4.3.1.cmml" xref="S4.E6.m1.2.2.4.3.2"><csymbol cd="latexml" id="S4.E6.m1.2.2.4.3.1.1.cmml" xref="S4.E6.m1.2.2.4.3.2.1">delimited-[]</csymbol><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">ğ‘—</ci></apply></apply></apply><apply id="S4.E6.m1.2.2c.cmml" xref="S4.E6.m1.2.2"><in id="S4.E6.m1.2.2.5.cmml" xref="S4.E6.m1.2.2.5"></in><share href="https://arxiv.org/html/2410.02296v1#S4.E6.m1.2.2.4.cmml" id="S4.E6.m1.2.2d.cmml" xref="S4.E6.m1.2.2"></share><ci id="S4.E6.m1.2.2.6.cmml" xref="S4.E6.m1.2.2.6">â„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">\displaystyle\mathtt{Conf}(v_{i})=\max_{j}\tilde{\mathbf{y}}_{i}[j]\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.2d">typewriter_Conf ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = roman_max start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT over~ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_j ] âˆˆ blackboard_R</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p7.9">The GNNâ€™s prediction for node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS1.p7.4.m1.1"><semantics id="S4.SS1.p7.4.m1.1a"><msub id="S4.SS1.p7.4.m1.1.1" xref="S4.SS1.p7.4.m1.1.1.cmml"><mi id="S4.SS1.p7.4.m1.1.1.2" xref="S4.SS1.p7.4.m1.1.1.2.cmml">v</mi><mi id="S4.SS1.p7.4.m1.1.1.3" xref="S4.SS1.p7.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.4.m1.1b"><apply id="S4.SS1.p7.4.m1.1.1.cmml" xref="S4.SS1.p7.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.4.m1.1.1.1.cmml" xref="S4.SS1.p7.4.m1.1.1">subscript</csymbol><ci id="S4.SS1.p7.4.m1.1.1.2.cmml" xref="S4.SS1.p7.4.m1.1.1.2">ğ‘£</ci><ci id="S4.SS1.p7.4.m1.1.1.3.cmml" xref="S4.SS1.p7.4.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.4.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.4.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is denoted as <math alttext="\tilde{y}_{i}=\mathop{\arg\max}_{j}\tilde{\mathbf{y}}_{i}[j]\in\{1,\dots,C\}" class="ltx_Math" display="inline" id="S4.SS1.p7.5.m2.4"><semantics id="S4.SS1.p7.5.m2.4a"><mrow id="S4.SS1.p7.5.m2.4.5" xref="S4.SS1.p7.5.m2.4.5.cmml"><msub id="S4.SS1.p7.5.m2.4.5.2" xref="S4.SS1.p7.5.m2.4.5.2.cmml"><mover accent="true" id="S4.SS1.p7.5.m2.4.5.2.2" xref="S4.SS1.p7.5.m2.4.5.2.2.cmml"><mi id="S4.SS1.p7.5.m2.4.5.2.2.2" xref="S4.SS1.p7.5.m2.4.5.2.2.2.cmml">y</mi><mo id="S4.SS1.p7.5.m2.4.5.2.2.1" xref="S4.SS1.p7.5.m2.4.5.2.2.1.cmml">~</mo></mover><mi id="S4.SS1.p7.5.m2.4.5.2.3" xref="S4.SS1.p7.5.m2.4.5.2.3.cmml">i</mi></msub><mo id="S4.SS1.p7.5.m2.4.5.3" xref="S4.SS1.p7.5.m2.4.5.3.cmml">=</mo><mrow id="S4.SS1.p7.5.m2.4.5.4" xref="S4.SS1.p7.5.m2.4.5.4.cmml"><msub id="S4.SS1.p7.5.m2.4.5.4.1" xref="S4.SS1.p7.5.m2.4.5.4.1.cmml"><mrow id="S4.SS1.p7.5.m2.4.5.4.1.2" xref="S4.SS1.p7.5.m2.4.5.4.1.2.cmml"><mi id="S4.SS1.p7.5.m2.4.5.4.1.2.1" xref="S4.SS1.p7.5.m2.4.5.4.1.2.1.cmml">arg</mi><mo id="S4.SS1.p7.5.m2.4.5.4.1.2a" lspace="0.167em" xref="S4.SS1.p7.5.m2.4.5.4.1.2.cmml">â¡</mo><mi id="S4.SS1.p7.5.m2.4.5.4.1.2.2" xref="S4.SS1.p7.5.m2.4.5.4.1.2.2.cmml">max</mi></mrow><mi id="S4.SS1.p7.5.m2.4.5.4.1.3" xref="S4.SS1.p7.5.m2.4.5.4.1.3.cmml">j</mi></msub><mrow id="S4.SS1.p7.5.m2.4.5.4.2" xref="S4.SS1.p7.5.m2.4.5.4.2.cmml"><msub id="S4.SS1.p7.5.m2.4.5.4.2.2" xref="S4.SS1.p7.5.m2.4.5.4.2.2.cmml"><mover accent="true" id="S4.SS1.p7.5.m2.4.5.4.2.2.2" xref="S4.SS1.p7.5.m2.4.5.4.2.2.2.cmml"><mi id="S4.SS1.p7.5.m2.4.5.4.2.2.2.2" xref="S4.SS1.p7.5.m2.4.5.4.2.2.2.2.cmml">ğ²</mi><mo id="S4.SS1.p7.5.m2.4.5.4.2.2.2.1" xref="S4.SS1.p7.5.m2.4.5.4.2.2.2.1.cmml">~</mo></mover><mi id="S4.SS1.p7.5.m2.4.5.4.2.2.3" xref="S4.SS1.p7.5.m2.4.5.4.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p7.5.m2.4.5.4.2.1" xref="S4.SS1.p7.5.m2.4.5.4.2.1.cmml">â¢</mo><mrow id="S4.SS1.p7.5.m2.4.5.4.2.3.2" xref="S4.SS1.p7.5.m2.4.5.4.2.3.1.cmml"><mo id="S4.SS1.p7.5.m2.4.5.4.2.3.2.1" stretchy="false" xref="S4.SS1.p7.5.m2.4.5.4.2.3.1.1.cmml">[</mo><mi id="S4.SS1.p7.5.m2.1.1" xref="S4.SS1.p7.5.m2.1.1.cmml">j</mi><mo id="S4.SS1.p7.5.m2.4.5.4.2.3.2.2" stretchy="false" xref="S4.SS1.p7.5.m2.4.5.4.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.SS1.p7.5.m2.4.5.5" xref="S4.SS1.p7.5.m2.4.5.5.cmml">âˆˆ</mo><mrow id="S4.SS1.p7.5.m2.4.5.6.2" xref="S4.SS1.p7.5.m2.4.5.6.1.cmml"><mo id="S4.SS1.p7.5.m2.4.5.6.2.1" stretchy="false" xref="S4.SS1.p7.5.m2.4.5.6.1.cmml">{</mo><mn id="S4.SS1.p7.5.m2.2.2" xref="S4.SS1.p7.5.m2.2.2.cmml">1</mn><mo id="S4.SS1.p7.5.m2.4.5.6.2.2" xref="S4.SS1.p7.5.m2.4.5.6.1.cmml">,</mo><mi id="S4.SS1.p7.5.m2.3.3" mathvariant="normal" xref="S4.SS1.p7.5.m2.3.3.cmml">â€¦</mi><mo id="S4.SS1.p7.5.m2.4.5.6.2.3" xref="S4.SS1.p7.5.m2.4.5.6.1.cmml">,</mo><mi id="S4.SS1.p7.5.m2.4.4" xref="S4.SS1.p7.5.m2.4.4.cmml">C</mi><mo id="S4.SS1.p7.5.m2.4.5.6.2.4" stretchy="false" xref="S4.SS1.p7.5.m2.4.5.6.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.5.m2.4b"><apply id="S4.SS1.p7.5.m2.4.5.cmml" xref="S4.SS1.p7.5.m2.4.5"><and id="S4.SS1.p7.5.m2.4.5a.cmml" xref="S4.SS1.p7.5.m2.4.5"></and><apply id="S4.SS1.p7.5.m2.4.5b.cmml" xref="S4.SS1.p7.5.m2.4.5"><eq id="S4.SS1.p7.5.m2.4.5.3.cmml" xref="S4.SS1.p7.5.m2.4.5.3"></eq><apply id="S4.SS1.p7.5.m2.4.5.2.cmml" xref="S4.SS1.p7.5.m2.4.5.2"><csymbol cd="ambiguous" id="S4.SS1.p7.5.m2.4.5.2.1.cmml" xref="S4.SS1.p7.5.m2.4.5.2">subscript</csymbol><apply id="S4.SS1.p7.5.m2.4.5.2.2.cmml" xref="S4.SS1.p7.5.m2.4.5.2.2"><ci id="S4.SS1.p7.5.m2.4.5.2.2.1.cmml" xref="S4.SS1.p7.5.m2.4.5.2.2.1">~</ci><ci id="S4.SS1.p7.5.m2.4.5.2.2.2.cmml" xref="S4.SS1.p7.5.m2.4.5.2.2.2">ğ‘¦</ci></apply><ci id="S4.SS1.p7.5.m2.4.5.2.3.cmml" xref="S4.SS1.p7.5.m2.4.5.2.3">ğ‘–</ci></apply><apply id="S4.SS1.p7.5.m2.4.5.4.cmml" xref="S4.SS1.p7.5.m2.4.5.4"><apply id="S4.SS1.p7.5.m2.4.5.4.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.1"><csymbol cd="ambiguous" id="S4.SS1.p7.5.m2.4.5.4.1.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.1">subscript</csymbol><apply id="S4.SS1.p7.5.m2.4.5.4.1.2.cmml" xref="S4.SS1.p7.5.m2.4.5.4.1.2"><arg id="S4.SS1.p7.5.m2.4.5.4.1.2.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.1.2.1"></arg><max id="S4.SS1.p7.5.m2.4.5.4.1.2.2.cmml" xref="S4.SS1.p7.5.m2.4.5.4.1.2.2"></max></apply><ci id="S4.SS1.p7.5.m2.4.5.4.1.3.cmml" xref="S4.SS1.p7.5.m2.4.5.4.1.3">ğ‘—</ci></apply><apply id="S4.SS1.p7.5.m2.4.5.4.2.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2"><times id="S4.SS1.p7.5.m2.4.5.4.2.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.1"></times><apply id="S4.SS1.p7.5.m2.4.5.4.2.2.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.2"><csymbol cd="ambiguous" id="S4.SS1.p7.5.m2.4.5.4.2.2.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.2">subscript</csymbol><apply id="S4.SS1.p7.5.m2.4.5.4.2.2.2.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.2.2"><ci id="S4.SS1.p7.5.m2.4.5.4.2.2.2.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.2.2.1">~</ci><ci id="S4.SS1.p7.5.m2.4.5.4.2.2.2.2.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.2.2.2">ğ²</ci></apply><ci id="S4.SS1.p7.5.m2.4.5.4.2.2.3.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.2.3">ğ‘–</ci></apply><apply id="S4.SS1.p7.5.m2.4.5.4.2.3.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.3.2"><csymbol cd="latexml" id="S4.SS1.p7.5.m2.4.5.4.2.3.1.1.cmml" xref="S4.SS1.p7.5.m2.4.5.4.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p7.5.m2.1.1.cmml" xref="S4.SS1.p7.5.m2.1.1">ğ‘—</ci></apply></apply></apply></apply><apply id="S4.SS1.p7.5.m2.4.5c.cmml" xref="S4.SS1.p7.5.m2.4.5"><in id="S4.SS1.p7.5.m2.4.5.5.cmml" xref="S4.SS1.p7.5.m2.4.5.5"></in><share href="https://arxiv.org/html/2410.02296v1#S4.SS1.p7.5.m2.4.5.4.cmml" id="S4.SS1.p7.5.m2.4.5d.cmml" xref="S4.SS1.p7.5.m2.4.5"></share><set id="S4.SS1.p7.5.m2.4.5.6.1.cmml" xref="S4.SS1.p7.5.m2.4.5.6.2"><cn id="S4.SS1.p7.5.m2.2.2.cmml" type="integer" xref="S4.SS1.p7.5.m2.2.2">1</cn><ci id="S4.SS1.p7.5.m2.3.3.cmml" xref="S4.SS1.p7.5.m2.3.3">â€¦</ci><ci id="S4.SS1.p7.5.m2.4.4.cmml" xref="S4.SS1.p7.5.m2.4.4">ğ¶</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.5.m2.4c">\tilde{y}_{i}=\mathop{\arg\max}_{j}\tilde{\mathbf{y}}_{i}[j]\in\{1,\dots,C\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.5.m2.4d">over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = start_BIGOP roman_arg roman_max end_BIGOP start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT over~ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_j ] âˆˆ { 1 , â€¦ , italic_C }</annotation></semantics></math>, and the predicted class-<math alttext="c" class="ltx_Math" display="inline" id="S4.SS1.p7.6.m3.1"><semantics id="S4.SS1.p7.6.m3.1a"><mi id="S4.SS1.p7.6.m3.1.1" xref="S4.SS1.p7.6.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.6.m3.1b"><ci id="S4.SS1.p7.6.m3.1.1.cmml" xref="S4.SS1.p7.6.m3.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.6.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.6.m3.1d">italic_c</annotation></semantics></math> examples are <math alttext="\tilde{\mathcal{Y}}_{c}=\{v_{i}:\tilde{y}_{i}=c\}" class="ltx_Math" display="inline" id="S4.SS1.p7.7.m4.2"><semantics id="S4.SS1.p7.7.m4.2a"><mrow id="S4.SS1.p7.7.m4.2.2" xref="S4.SS1.p7.7.m4.2.2.cmml"><msub id="S4.SS1.p7.7.m4.2.2.4" xref="S4.SS1.p7.7.m4.2.2.4.cmml"><mover accent="true" id="S4.SS1.p7.7.m4.2.2.4.2" xref="S4.SS1.p7.7.m4.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.7.m4.2.2.4.2.2" xref="S4.SS1.p7.7.m4.2.2.4.2.2.cmml">ğ’´</mi><mo id="S4.SS1.p7.7.m4.2.2.4.2.1" xref="S4.SS1.p7.7.m4.2.2.4.2.1.cmml">~</mo></mover><mi id="S4.SS1.p7.7.m4.2.2.4.3" xref="S4.SS1.p7.7.m4.2.2.4.3.cmml">c</mi></msub><mo id="S4.SS1.p7.7.m4.2.2.3" xref="S4.SS1.p7.7.m4.2.2.3.cmml">=</mo><mrow id="S4.SS1.p7.7.m4.2.2.2.2" xref="S4.SS1.p7.7.m4.2.2.2.3.cmml"><mo id="S4.SS1.p7.7.m4.2.2.2.2.3" stretchy="false" xref="S4.SS1.p7.7.m4.2.2.2.3.1.cmml">{</mo><msub id="S4.SS1.p7.7.m4.1.1.1.1.1" xref="S4.SS1.p7.7.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.p7.7.m4.1.1.1.1.1.2" xref="S4.SS1.p7.7.m4.1.1.1.1.1.2.cmml">v</mi><mi id="S4.SS1.p7.7.m4.1.1.1.1.1.3" xref="S4.SS1.p7.7.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p7.7.m4.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p7.7.m4.2.2.2.3.1.cmml">:</mo><mrow id="S4.SS1.p7.7.m4.2.2.2.2.2" xref="S4.SS1.p7.7.m4.2.2.2.2.2.cmml"><msub id="S4.SS1.p7.7.m4.2.2.2.2.2.2" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS1.p7.7.m4.2.2.2.2.2.2.2" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.2" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.1" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.SS1.p7.7.m4.2.2.2.2.2.2.3" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p7.7.m4.2.2.2.2.2.1" xref="S4.SS1.p7.7.m4.2.2.2.2.2.1.cmml">=</mo><mi id="S4.SS1.p7.7.m4.2.2.2.2.2.3" xref="S4.SS1.p7.7.m4.2.2.2.2.2.3.cmml">c</mi></mrow><mo id="S4.SS1.p7.7.m4.2.2.2.2.5" stretchy="false" xref="S4.SS1.p7.7.m4.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.7.m4.2b"><apply id="S4.SS1.p7.7.m4.2.2.cmml" xref="S4.SS1.p7.7.m4.2.2"><eq id="S4.SS1.p7.7.m4.2.2.3.cmml" xref="S4.SS1.p7.7.m4.2.2.3"></eq><apply id="S4.SS1.p7.7.m4.2.2.4.cmml" xref="S4.SS1.p7.7.m4.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p7.7.m4.2.2.4.1.cmml" xref="S4.SS1.p7.7.m4.2.2.4">subscript</csymbol><apply id="S4.SS1.p7.7.m4.2.2.4.2.cmml" xref="S4.SS1.p7.7.m4.2.2.4.2"><ci id="S4.SS1.p7.7.m4.2.2.4.2.1.cmml" xref="S4.SS1.p7.7.m4.2.2.4.2.1">~</ci><ci id="S4.SS1.p7.7.m4.2.2.4.2.2.cmml" xref="S4.SS1.p7.7.m4.2.2.4.2.2">ğ’´</ci></apply><ci id="S4.SS1.p7.7.m4.2.2.4.3.cmml" xref="S4.SS1.p7.7.m4.2.2.4.3">ğ‘</ci></apply><apply id="S4.SS1.p7.7.m4.2.2.2.3.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2"><csymbol cd="latexml" id="S4.SS1.p7.7.m4.2.2.2.3.1.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.3">conditional-set</csymbol><apply id="S4.SS1.p7.7.m4.1.1.1.1.1.cmml" xref="S4.SS1.p7.7.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.7.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p7.7.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p7.7.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p7.7.m4.1.1.1.1.1.2">ğ‘£</ci><ci id="S4.SS1.p7.7.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.p7.7.m4.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S4.SS1.p7.7.m4.2.2.2.2.2.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2"><eq id="S4.SS1.p7.7.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.1"></eq><apply id="S4.SS1.p7.7.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p7.7.m4.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2">subscript</csymbol><apply id="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.2"><ci id="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.1">~</ci><ci id="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.2.2">ğ‘¦</ci></apply><ci id="S4.SS1.p7.7.m4.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.2.3">ğ‘–</ci></apply><ci id="S4.SS1.p7.7.m4.2.2.2.2.2.3.cmml" xref="S4.SS1.p7.7.m4.2.2.2.2.2.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.7.m4.2c">\tilde{\mathcal{Y}}_{c}=\{v_{i}:\tilde{y}_{i}=c\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.7.m4.2d">over~ start_ARG caligraphic_Y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT : over~ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_c }</annotation></semantics></math>. We select the top-<math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p7.8.m5.1"><semantics id="S4.SS1.p7.8.m5.1a"><mi id="S4.SS1.p7.8.m5.1.1" xref="S4.SS1.p7.8.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.8.m5.1b"><ci id="S4.SS1.p7.8.m5.1.1.cmml" xref="S4.SS1.p7.8.m5.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.8.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.8.m5.1d">italic_N</annotation></semantics></math> confident examples as prototypes for each class <math alttext="c" class="ltx_Math" display="inline" id="S4.SS1.p7.9.m6.1"><semantics id="S4.SS1.p7.9.m6.1a"><mi id="S4.SS1.p7.9.m6.1.1" xref="S4.SS1.p7.9.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.9.m6.1b"><ci id="S4.SS1.p7.9.m6.1.1.cmml" xref="S4.SS1.p7.9.m6.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.9.m6.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.9.m6.1d">italic_c</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx7">
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{P}_{c}=\left\{v_{i}:v_{i}\in\tilde{\mathcal{Y}}_{c}\ %
\land\ \mathtt{Conf}(v_{i})\in\text{top-N}\{\mathtt{Conf}(v_{j}):v_{j}\in%
\tilde{\mathcal{Y}}_{c}\}\right\}" class="ltx_Math" display="inline" id="S4.E7.m1.2"><semantics id="S4.E7.m1.2a"><mrow id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml"><msub id="S4.E7.m1.2.2.4" xref="S4.E7.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.2.2.4.2" xref="S4.E7.m1.2.2.4.2.cmml">ğ’«</mi><mi id="S4.E7.m1.2.2.4.3" xref="S4.E7.m1.2.2.4.3.cmml">c</mi></msub><mo id="S4.E7.m1.2.2.3" xref="S4.E7.m1.2.2.3.cmml">=</mo><mrow id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.3.cmml"><mo id="S4.E7.m1.2.2.2.2.3" xref="S4.E7.m1.2.2.2.3.1.cmml">{</mo><msub id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.2.2.2.2.4" lspace="0.278em" rspace="0.278em" xref="S4.E7.m1.2.2.2.3.1.cmml">:</mo><mrow id="S4.E7.m1.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.cmml"><msub id="S4.E7.m1.2.2.2.2.2.5" xref="S4.E7.m1.2.2.2.2.2.5.cmml"><mi id="S4.E7.m1.2.2.2.2.2.5.2" xref="S4.E7.m1.2.2.2.2.2.5.2.cmml">v</mi><mi id="S4.E7.m1.2.2.2.2.2.5.3" xref="S4.E7.m1.2.2.2.2.2.5.3.cmml">i</mi></msub><mo id="S4.E7.m1.2.2.2.2.2.6" xref="S4.E7.m1.2.2.2.2.2.6.cmml">âˆˆ</mo><mrow id="S4.E7.m1.2.2.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.1.cmml"><msub id="S4.E7.m1.2.2.2.2.2.1.3" xref="S4.E7.m1.2.2.2.2.2.1.3.cmml"><mover accent="true" id="S4.E7.m1.2.2.2.2.2.1.3.2" xref="S4.E7.m1.2.2.2.2.2.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.2.2.2.2.2.1.3.2.2" xref="S4.E7.m1.2.2.2.2.2.1.3.2.2.cmml">ğ’´</mi><mo id="S4.E7.m1.2.2.2.2.2.1.3.2.1" xref="S4.E7.m1.2.2.2.2.2.1.3.2.1.cmml">~</mo></mover><mi id="S4.E7.m1.2.2.2.2.2.1.3.3" xref="S4.E7.m1.2.2.2.2.2.1.3.3.cmml">c</mi></msub><mo id="S4.E7.m1.2.2.2.2.2.1.2" rspace="0.722em" xref="S4.E7.m1.2.2.2.2.2.1.2.cmml">âˆ§</mo><mrow id="S4.E7.m1.2.2.2.2.2.1.1" xref="S4.E7.m1.2.2.2.2.2.1.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.1.1.3" xref="S4.E7.m1.2.2.2.2.2.1.1.3.cmml">ğ™²ğš˜ğš—ğš</mi><mo id="S4.E7.m1.2.2.2.2.2.1.1.2" xref="S4.E7.m1.2.2.2.2.2.1.1.2.cmml">â¢</mo><mrow id="S4.E7.m1.2.2.2.2.2.1.1.1.1" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.cmml"><mo id="S4.E7.m1.2.2.2.2.2.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.2.2.2.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.2.cmml">v</mi><mi id="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.2.2.2.2.2.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.2.2.2.2.2.7" xref="S4.E7.m1.2.2.2.2.2.7.cmml">âˆˆ</mo><mrow id="S4.E7.m1.2.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.2.3.cmml"><mtext id="S4.E7.m1.2.2.2.2.2.3.4" xref="S4.E7.m1.2.2.2.2.2.3.4a.cmml">top-N</mtext><mo id="S4.E7.m1.2.2.2.2.2.3.3" xref="S4.E7.m1.2.2.2.2.2.3.3.cmml">â¢</mo><mrow id="S4.E7.m1.2.2.2.2.2.3.2.2" xref="S4.E7.m1.2.2.2.2.2.3.2.3.cmml"><mo id="S4.E7.m1.2.2.2.2.2.3.2.2.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.3.2.3.1.cmml">{</mo><mrow id="S4.E7.m1.2.2.2.2.2.2.1.1.1" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2.1.1.1.3" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.3.cmml">ğ™²ğš˜ğš—ğš</mi><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.1.2" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.2.cmml">â¢</mo><mrow id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.3" rspace="0.278em" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.2.2.2.2.2.3.2.2.4" rspace="0.278em" xref="S4.E7.m1.2.2.2.2.2.3.2.3.1.cmml">:</mo><mrow id="S4.E7.m1.2.2.2.2.2.3.2.2.2" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.cmml"><msub id="S4.E7.m1.2.2.2.2.2.3.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.cmml"><mi id="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.2.cmml">v</mi><mi id="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E7.m1.2.2.2.2.2.3.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.1.cmml">âˆˆ</mo><msub id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.cmml"><mover accent="true" id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.2" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.2.cmml">ğ’´</mi><mo id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.1" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.1.cmml">~</mo></mover><mi id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.3" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.3.cmml">c</mi></msub></mrow><mo id="S4.E7.m1.2.2.2.2.2.3.2.2.5" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.3.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S4.E7.m1.2.2.2.2.5" xref="S4.E7.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.2b"><apply id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2"><eq id="S4.E7.m1.2.2.3.cmml" xref="S4.E7.m1.2.2.3"></eq><apply id="S4.E7.m1.2.2.4.cmml" xref="S4.E7.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.4.1.cmml" xref="S4.E7.m1.2.2.4">subscript</csymbol><ci id="S4.E7.m1.2.2.4.2.cmml" xref="S4.E7.m1.2.2.4.2">ğ’«</ci><ci id="S4.E7.m1.2.2.4.3.cmml" xref="S4.E7.m1.2.2.4.3">ğ‘</ci></apply><apply id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2"><csymbol cd="latexml" id="S4.E7.m1.2.2.2.3.1.cmml" xref="S4.E7.m1.2.2.2.2.3">conditional-set</csymbol><apply id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.2">ğ‘£</ci><ci id="S4.E7.m1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="S4.E7.m1.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2"><and id="S4.E7.m1.2.2.2.2.2a.cmml" xref="S4.E7.m1.2.2.2.2.2"></and><apply id="S4.E7.m1.2.2.2.2.2b.cmml" xref="S4.E7.m1.2.2.2.2.2"><in id="S4.E7.m1.2.2.2.2.2.6.cmml" xref="S4.E7.m1.2.2.2.2.2.6"></in><apply id="S4.E7.m1.2.2.2.2.2.5.cmml" xref="S4.E7.m1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.5.1.cmml" xref="S4.E7.m1.2.2.2.2.2.5">subscript</csymbol><ci id="S4.E7.m1.2.2.2.2.2.5.2.cmml" xref="S4.E7.m1.2.2.2.2.2.5.2">ğ‘£</ci><ci id="S4.E7.m1.2.2.2.2.2.5.3.cmml" xref="S4.E7.m1.2.2.2.2.2.5.3">ğ‘–</ci></apply><apply id="S4.E7.m1.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1"><and id="S4.E7.m1.2.2.2.2.2.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.2"></and><apply id="S4.E7.m1.2.2.2.2.2.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.1.3.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.3">subscript</csymbol><apply id="S4.E7.m1.2.2.2.2.2.1.3.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.3.2"><ci id="S4.E7.m1.2.2.2.2.2.1.3.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.3.2.1">~</ci><ci id="S4.E7.m1.2.2.2.2.2.1.3.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.3.2.2">ğ’´</ci></apply><ci id="S4.E7.m1.2.2.2.2.2.1.3.3.cmml" xref="S4.E7.m1.2.2.2.2.2.1.3.3">ğ‘</ci></apply><apply id="S4.E7.m1.2.2.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1"><times id="S4.E7.m1.2.2.2.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1.2"></times><ci id="S4.E7.m1.2.2.2.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1.3">ğ™²ğš˜ğš—ğš</ci><apply id="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.2">ğ‘£</ci><ci id="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply><apply id="S4.E7.m1.2.2.2.2.2c.cmml" xref="S4.E7.m1.2.2.2.2.2"><in id="S4.E7.m1.2.2.2.2.2.7.cmml" xref="S4.E7.m1.2.2.2.2.2.7"></in><share href="https://arxiv.org/html/2410.02296v1#S4.E7.m1.2.2.2.2.2.1.cmml" id="S4.E7.m1.2.2.2.2.2d.cmml" xref="S4.E7.m1.2.2.2.2.2"></share><apply id="S4.E7.m1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.3"><times id="S4.E7.m1.2.2.2.2.2.3.3.cmml" xref="S4.E7.m1.2.2.2.2.2.3.3"></times><ci id="S4.E7.m1.2.2.2.2.2.3.4a.cmml" xref="S4.E7.m1.2.2.2.2.2.3.4"><mtext id="S4.E7.m1.2.2.2.2.2.3.4.cmml" xref="S4.E7.m1.2.2.2.2.2.3.4">top-N</mtext></ci><apply id="S4.E7.m1.2.2.2.2.2.3.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2"><csymbol cd="latexml" id="S4.E7.m1.2.2.2.2.2.3.2.3.1.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.3">conditional-set</csymbol><apply id="S4.E7.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1"><times id="S4.E7.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.2"></times><ci id="S4.E7.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.3">ğ™²ğš˜ğš—ğš</ci><apply id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.2">ğ‘£</ci><ci id="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1.1.1.1.1.3">ğ‘—</ci></apply></apply><apply id="S4.E7.m1.2.2.2.2.2.3.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2"><in id="S4.E7.m1.2.2.2.2.2.3.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.1"></in><apply id="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.2">ğ‘£</ci><ci id="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.2.3">ğ‘—</ci></apply><apply id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.1.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3">subscript</csymbol><apply id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2"><ci id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.1">~</ci><ci id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.2.2">ğ’´</ci></apply><ci id="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.3.cmml" xref="S4.E7.m1.2.2.2.2.2.3.2.2.2.3.3">ğ‘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.2c">\displaystyle\mathcal{P}_{c}=\left\{v_{i}:v_{i}\in\tilde{\mathcal{Y}}_{c}\ %
\land\ \mathtt{Conf}(v_{i})\in\text{top-N}\{\mathtt{Conf}(v_{j}):v_{j}\in%
\tilde{\mathcal{Y}}_{c}\}\right\}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.2d">caligraphic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT : italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ over~ start_ARG caligraphic_Y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT âˆ§ typewriter_Conf ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆˆ top-N { typewriter_Conf ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) : italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ over~ start_ARG caligraphic_Y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT } }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p7.12">This process yields a total of <math alttext="N\times C" class="ltx_Math" display="inline" id="S4.SS1.p7.10.m1.1"><semantics id="S4.SS1.p7.10.m1.1a"><mrow id="S4.SS1.p7.10.m1.1.1" xref="S4.SS1.p7.10.m1.1.1.cmml"><mi id="S4.SS1.p7.10.m1.1.1.2" xref="S4.SS1.p7.10.m1.1.1.2.cmml">N</mi><mo id="S4.SS1.p7.10.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p7.10.m1.1.1.1.cmml">Ã—</mo><mi id="S4.SS1.p7.10.m1.1.1.3" xref="S4.SS1.p7.10.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.10.m1.1b"><apply id="S4.SS1.p7.10.m1.1.1.cmml" xref="S4.SS1.p7.10.m1.1.1"><times id="S4.SS1.p7.10.m1.1.1.1.cmml" xref="S4.SS1.p7.10.m1.1.1.1"></times><ci id="S4.SS1.p7.10.m1.1.1.2.cmml" xref="S4.SS1.p7.10.m1.1.1.2">ğ‘</ci><ci id="S4.SS1.p7.10.m1.1.1.3.cmml" xref="S4.SS1.p7.10.m1.1.1.3">ğ¶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.10.m1.1c">N\times C</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.10.m1.1d">italic_N Ã— italic_C</annotation></semantics></math> prototypes: <math alttext="\mathcal{P}=\bigcup_{c\in\{1,\dots,C\}}\mathcal{P}_{c}" class="ltx_Math" display="inline" id="S4.SS1.p7.11.m2.3"><semantics id="S4.SS1.p7.11.m2.3a"><mrow id="S4.SS1.p7.11.m2.3.4" xref="S4.SS1.p7.11.m2.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.11.m2.3.4.2" xref="S4.SS1.p7.11.m2.3.4.2.cmml">ğ’«</mi><mo id="S4.SS1.p7.11.m2.3.4.1" rspace="0.111em" xref="S4.SS1.p7.11.m2.3.4.1.cmml">=</mo><mrow id="S4.SS1.p7.11.m2.3.4.3" xref="S4.SS1.p7.11.m2.3.4.3.cmml"><msub id="S4.SS1.p7.11.m2.3.4.3.1" xref="S4.SS1.p7.11.m2.3.4.3.1.cmml"><mo id="S4.SS1.p7.11.m2.3.4.3.1.2" xref="S4.SS1.p7.11.m2.3.4.3.1.2.cmml">â‹ƒ</mo><mrow id="S4.SS1.p7.11.m2.3.3.3" xref="S4.SS1.p7.11.m2.3.3.3.cmml"><mi id="S4.SS1.p7.11.m2.3.3.3.5" xref="S4.SS1.p7.11.m2.3.3.3.5.cmml">c</mi><mo id="S4.SS1.p7.11.m2.3.3.3.4" xref="S4.SS1.p7.11.m2.3.3.3.4.cmml">âˆˆ</mo><mrow id="S4.SS1.p7.11.m2.3.3.3.6.2" xref="S4.SS1.p7.11.m2.3.3.3.6.1.cmml"><mo id="S4.SS1.p7.11.m2.3.3.3.6.2.1" stretchy="false" xref="S4.SS1.p7.11.m2.3.3.3.6.1.cmml">{</mo><mn id="S4.SS1.p7.11.m2.1.1.1.1" xref="S4.SS1.p7.11.m2.1.1.1.1.cmml">1</mn><mo id="S4.SS1.p7.11.m2.3.3.3.6.2.2" xref="S4.SS1.p7.11.m2.3.3.3.6.1.cmml">,</mo><mi id="S4.SS1.p7.11.m2.2.2.2.2" mathvariant="normal" xref="S4.SS1.p7.11.m2.2.2.2.2.cmml">â€¦</mi><mo id="S4.SS1.p7.11.m2.3.3.3.6.2.3" xref="S4.SS1.p7.11.m2.3.3.3.6.1.cmml">,</mo><mi id="S4.SS1.p7.11.m2.3.3.3.3" xref="S4.SS1.p7.11.m2.3.3.3.3.cmml">C</mi><mo id="S4.SS1.p7.11.m2.3.3.3.6.2.4" stretchy="false" xref="S4.SS1.p7.11.m2.3.3.3.6.1.cmml">}</mo></mrow></mrow></msub><msub id="S4.SS1.p7.11.m2.3.4.3.2" xref="S4.SS1.p7.11.m2.3.4.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.11.m2.3.4.3.2.2" xref="S4.SS1.p7.11.m2.3.4.3.2.2.cmml">ğ’«</mi><mi id="S4.SS1.p7.11.m2.3.4.3.2.3" xref="S4.SS1.p7.11.m2.3.4.3.2.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.11.m2.3b"><apply id="S4.SS1.p7.11.m2.3.4.cmml" xref="S4.SS1.p7.11.m2.3.4"><eq id="S4.SS1.p7.11.m2.3.4.1.cmml" xref="S4.SS1.p7.11.m2.3.4.1"></eq><ci id="S4.SS1.p7.11.m2.3.4.2.cmml" xref="S4.SS1.p7.11.m2.3.4.2">ğ’«</ci><apply id="S4.SS1.p7.11.m2.3.4.3.cmml" xref="S4.SS1.p7.11.m2.3.4.3"><apply id="S4.SS1.p7.11.m2.3.4.3.1.cmml" xref="S4.SS1.p7.11.m2.3.4.3.1"><csymbol cd="ambiguous" id="S4.SS1.p7.11.m2.3.4.3.1.1.cmml" xref="S4.SS1.p7.11.m2.3.4.3.1">subscript</csymbol><union id="S4.SS1.p7.11.m2.3.4.3.1.2.cmml" xref="S4.SS1.p7.11.m2.3.4.3.1.2"></union><apply id="S4.SS1.p7.11.m2.3.3.3.cmml" xref="S4.SS1.p7.11.m2.3.3.3"><in id="S4.SS1.p7.11.m2.3.3.3.4.cmml" xref="S4.SS1.p7.11.m2.3.3.3.4"></in><ci id="S4.SS1.p7.11.m2.3.3.3.5.cmml" xref="S4.SS1.p7.11.m2.3.3.3.5">ğ‘</ci><set id="S4.SS1.p7.11.m2.3.3.3.6.1.cmml" xref="S4.SS1.p7.11.m2.3.3.3.6.2"><cn id="S4.SS1.p7.11.m2.1.1.1.1.cmml" type="integer" xref="S4.SS1.p7.11.m2.1.1.1.1">1</cn><ci id="S4.SS1.p7.11.m2.2.2.2.2.cmml" xref="S4.SS1.p7.11.m2.2.2.2.2">â€¦</ci><ci id="S4.SS1.p7.11.m2.3.3.3.3.cmml" xref="S4.SS1.p7.11.m2.3.3.3.3">ğ¶</ci></set></apply></apply><apply id="S4.SS1.p7.11.m2.3.4.3.2.cmml" xref="S4.SS1.p7.11.m2.3.4.3.2"><csymbol cd="ambiguous" id="S4.SS1.p7.11.m2.3.4.3.2.1.cmml" xref="S4.SS1.p7.11.m2.3.4.3.2">subscript</csymbol><ci id="S4.SS1.p7.11.m2.3.4.3.2.2.cmml" xref="S4.SS1.p7.11.m2.3.4.3.2.2">ğ’«</ci><ci id="S4.SS1.p7.11.m2.3.4.3.2.3.cmml" xref="S4.SS1.p7.11.m2.3.4.3.2.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.11.m2.3c">\mathcal{P}=\bigcup_{c\in\{1,\dots,C\}}\mathcal{P}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.11.m2.3d">caligraphic_P = â‹ƒ start_POSTSUBSCRIPT italic_c âˆˆ { 1 , â€¦ , italic_C } end_POSTSUBSCRIPT caligraphic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>. To ensure that we retrieve text features from multiple nodes, we form our corpus <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.p7.12.m3.1"><semantics id="S4.SS1.p7.12.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.12.m3.1.1" xref="S4.SS1.p7.12.m3.1.1.cmml">ğ’Ÿ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.12.m3.1b"><ci id="S4.SS1.p7.12.m3.1.1.cmml" xref="S4.SS1.p7.12.m3.1.1">ğ’Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.12.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.12.m3.1d">caligraphic_D</annotation></semantics></math> by concatenating the text features of PPR neighbors for each prototype</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx8">
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{D}=\left\{\mathop{\oplus}_{j;v_{j}\in\mathtt{PPR\ neigh}%
(v_{i})}t_{j}:v_{i}\in\mathcal{P}\right\}" class="ltx_Math" display="inline" id="S4.E8.m1.5"><semantics id="S4.E8.m1.5a"><mrow id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.4" xref="S4.E8.m1.5.5.4.cmml">ğ’Ÿ</mi><mo id="S4.E8.m1.5.5.3" xref="S4.E8.m1.5.5.3.cmml">=</mo><mrow id="S4.E8.m1.5.5.2.2" xref="S4.E8.m1.5.5.2.3.cmml"><mo id="S4.E8.m1.5.5.2.2.3" xref="S4.E8.m1.5.5.2.3.1.cmml">{</mo><mrow id="S4.E8.m1.4.4.1.1.1" xref="S4.E8.m1.4.4.1.1.1.cmml"><munder id="S4.E8.m1.4.4.1.1.1.1" xref="S4.E8.m1.4.4.1.1.1.1.cmml"><mo id="S4.E8.m1.4.4.1.1.1.1.2" lspace="0em" movablelimits="false" rspace="0.167em" xref="S4.E8.m1.4.4.1.1.1.1.2.cmml">âŠ•</mo><mrow id="S4.E8.m1.3.3.3" xref="S4.E8.m1.3.3.3.cmml"><mrow id="S4.E8.m1.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.2.cmml"><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">j</mi><mo id="S4.E8.m1.2.2.2.2.1.2" xref="S4.E8.m1.2.2.2.2.2.cmml">;</mo><msub id="S4.E8.m1.2.2.2.2.1.1" xref="S4.E8.m1.2.2.2.2.1.1.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.2.cmml">v</mi><mi id="S4.E8.m1.2.2.2.2.1.1.3" xref="S4.E8.m1.2.2.2.2.1.1.3.cmml">j</mi></msub></mrow><mo id="S4.E8.m1.3.3.3.4" xref="S4.E8.m1.3.3.3.4.cmml">âˆˆ</mo><mrow id="S4.E8.m1.3.3.3.3" xref="S4.E8.m1.3.3.3.3.cmml"><mi id="S4.E8.m1.3.3.3.3.3" xref="S4.E8.m1.3.3.3.3.3.cmml">ğ™¿ğ™¿ğš</mi><mo id="S4.E8.m1.3.3.3.3.2" lspace="0.350em" xref="S4.E8.m1.3.3.3.3.2.cmml">â¢</mo><mi id="S4.E8.m1.3.3.3.3.4" xref="S4.E8.m1.3.3.3.3.4.cmml">ğš—ğšğš’ğšğš‘</mi><mo id="S4.E8.m1.3.3.3.3.2a" xref="S4.E8.m1.3.3.3.3.2.cmml">â¢</mo><mrow id="S4.E8.m1.3.3.3.3.1.1" xref="S4.E8.m1.3.3.3.3.1.1.1.cmml"><mo id="S4.E8.m1.3.3.3.3.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="S4.E8.m1.3.3.3.3.1.1.1" xref="S4.E8.m1.3.3.3.3.1.1.1.cmml"><mi id="S4.E8.m1.3.3.3.3.1.1.1.2" xref="S4.E8.m1.3.3.3.3.1.1.1.2.cmml">v</mi><mi id="S4.E8.m1.3.3.3.3.1.1.1.3" xref="S4.E8.m1.3.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S4.E8.m1.3.3.3.3.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><msub id="S4.E8.m1.4.4.1.1.1.2" xref="S4.E8.m1.4.4.1.1.1.2.cmml"><mi id="S4.E8.m1.4.4.1.1.1.2.2" xref="S4.E8.m1.4.4.1.1.1.2.2.cmml">t</mi><mi id="S4.E8.m1.4.4.1.1.1.2.3" xref="S4.E8.m1.4.4.1.1.1.2.3.cmml">j</mi></msub></mrow><mo id="S4.E8.m1.5.5.2.2.4" lspace="0.278em" rspace="0.278em" xref="S4.E8.m1.5.5.2.3.1.cmml">:</mo><mrow id="S4.E8.m1.5.5.2.2.2" xref="S4.E8.m1.5.5.2.2.2.cmml"><msub id="S4.E8.m1.5.5.2.2.2.2" xref="S4.E8.m1.5.5.2.2.2.2.cmml"><mi id="S4.E8.m1.5.5.2.2.2.2.2" xref="S4.E8.m1.5.5.2.2.2.2.2.cmml">v</mi><mi id="S4.E8.m1.5.5.2.2.2.2.3" xref="S4.E8.m1.5.5.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E8.m1.5.5.2.2.2.1" xref="S4.E8.m1.5.5.2.2.2.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.2.2.2.3" xref="S4.E8.m1.5.5.2.2.2.3.cmml">ğ’«</mi></mrow><mo id="S4.E8.m1.5.5.2.2.5" xref="S4.E8.m1.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.5b"><apply id="S4.E8.m1.5.5.cmml" xref="S4.E8.m1.5.5"><eq id="S4.E8.m1.5.5.3.cmml" xref="S4.E8.m1.5.5.3"></eq><ci id="S4.E8.m1.5.5.4.cmml" xref="S4.E8.m1.5.5.4">ğ’Ÿ</ci><apply id="S4.E8.m1.5.5.2.3.cmml" xref="S4.E8.m1.5.5.2.2"><csymbol cd="latexml" id="S4.E8.m1.5.5.2.3.1.cmml" xref="S4.E8.m1.5.5.2.2.3">conditional-set</csymbol><apply id="S4.E8.m1.4.4.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1"><apply id="S4.E8.m1.4.4.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.E8.m1.4.4.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.1.2">direct-sum</csymbol><apply id="S4.E8.m1.3.3.3.cmml" xref="S4.E8.m1.3.3.3"><in id="S4.E8.m1.3.3.3.4.cmml" xref="S4.E8.m1.3.3.3.4"></in><list id="S4.E8.m1.2.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1"><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">ğ‘—</ci><apply id="S4.E8.m1.2.2.2.2.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2">ğ‘£</ci><ci id="S4.E8.m1.2.2.2.2.1.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.3">ğ‘—</ci></apply></list><apply id="S4.E8.m1.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3"><times id="S4.E8.m1.3.3.3.3.2.cmml" xref="S4.E8.m1.3.3.3.3.2"></times><ci id="S4.E8.m1.3.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3.3">ğ™¿ğ™¿ğš</ci><ci id="S4.E8.m1.3.3.3.3.4.cmml" xref="S4.E8.m1.3.3.3.3.4">ğš—ğšğš’ğšğš‘</ci><apply id="S4.E8.m1.3.3.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S4.E8.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2">ğ‘£</ci><ci id="S4.E8.m1.3.3.3.3.1.1.1.3.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply><apply id="S4.E8.m1.4.4.1.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.1.2.1.cmml" xref="S4.E8.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.4.4.1.1.1.2.2.cmml" xref="S4.E8.m1.4.4.1.1.1.2.2">ğ‘¡</ci><ci id="S4.E8.m1.4.4.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.1.1.1.2.3">ğ‘—</ci></apply></apply><apply id="S4.E8.m1.5.5.2.2.2.cmml" xref="S4.E8.m1.5.5.2.2.2"><in id="S4.E8.m1.5.5.2.2.2.1.cmml" xref="S4.E8.m1.5.5.2.2.2.1"></in><apply id="S4.E8.m1.5.5.2.2.2.2.cmml" xref="S4.E8.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.2.2.2.2.1.cmml" xref="S4.E8.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S4.E8.m1.5.5.2.2.2.2.2.cmml" xref="S4.E8.m1.5.5.2.2.2.2.2">ğ‘£</ci><ci id="S4.E8.m1.5.5.2.2.2.2.3.cmml" xref="S4.E8.m1.5.5.2.2.2.2.3">ğ‘–</ci></apply><ci id="S4.E8.m1.5.5.2.2.2.3.cmml" xref="S4.E8.m1.5.5.2.2.2.3">ğ’«</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.5c">\displaystyle\mathcal{D}=\left\{\mathop{\oplus}_{j;v_{j}\in\mathtt{PPR\ neigh}%
(v_{i})}t_{j}:v_{i}\in\mathcal{P}\right\}</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.5d">caligraphic_D = { âŠ• start_POSTSUBSCRIPT italic_j ; italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆˆ typewriter_PPR typewriter_neigh ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT : italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ caligraphic_P }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p7.15">Next, for each target node with its associated text features <math alttext="t^{\textrm{target}}" class="ltx_Math" display="inline" id="S4.SS1.p7.13.m1.1"><semantics id="S4.SS1.p7.13.m1.1a"><msup id="S4.SS1.p7.13.m1.1.1" xref="S4.SS1.p7.13.m1.1.1.cmml"><mi id="S4.SS1.p7.13.m1.1.1.2" xref="S4.SS1.p7.13.m1.1.1.2.cmml">t</mi><mtext id="S4.SS1.p7.13.m1.1.1.3" xref="S4.SS1.p7.13.m1.1.1.3a.cmml">target</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.13.m1.1b"><apply id="S4.SS1.p7.13.m1.1.1.cmml" xref="S4.SS1.p7.13.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.13.m1.1.1.1.cmml" xref="S4.SS1.p7.13.m1.1.1">superscript</csymbol><ci id="S4.SS1.p7.13.m1.1.1.2.cmml" xref="S4.SS1.p7.13.m1.1.1.2">ğ‘¡</ci><ci id="S4.SS1.p7.13.m1.1.1.3a.cmml" xref="S4.SS1.p7.13.m1.1.1.3"><mtext id="S4.SS1.p7.13.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p7.13.m1.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.13.m1.1c">t^{\textrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.13.m1.1d">italic_t start_POSTSUPERSCRIPT target end_POSTSUPERSCRIPT</annotation></semantics></math>, we compute the semantically retrieved text using Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E4" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4</span></a>): <math alttext="t^{\textrm{semantic retri}}=\mathop{\arg\max}_{d\in\mathcal{D}}s_{\phi}(d,t^{%
\textrm{target}})" class="ltx_Math" display="inline" id="S4.SS1.p7.14.m2.2"><semantics id="S4.SS1.p7.14.m2.2a"><mrow id="S4.SS1.p7.14.m2.2.2" xref="S4.SS1.p7.14.m2.2.2.cmml"><msup id="S4.SS1.p7.14.m2.2.2.3" xref="S4.SS1.p7.14.m2.2.2.3.cmml"><mi id="S4.SS1.p7.14.m2.2.2.3.2" xref="S4.SS1.p7.14.m2.2.2.3.2.cmml">t</mi><mtext id="S4.SS1.p7.14.m2.2.2.3.3" xref="S4.SS1.p7.14.m2.2.2.3.3a.cmml">semantic retri</mtext></msup><mo id="S4.SS1.p7.14.m2.2.2.2" xref="S4.SS1.p7.14.m2.2.2.2.cmml">=</mo><mrow id="S4.SS1.p7.14.m2.2.2.1" xref="S4.SS1.p7.14.m2.2.2.1.cmml"><msub id="S4.SS1.p7.14.m2.2.2.1.2" xref="S4.SS1.p7.14.m2.2.2.1.2.cmml"><mrow id="S4.SS1.p7.14.m2.2.2.1.2.2" xref="S4.SS1.p7.14.m2.2.2.1.2.2.cmml"><mi id="S4.SS1.p7.14.m2.2.2.1.2.2.1" xref="S4.SS1.p7.14.m2.2.2.1.2.2.1.cmml">arg</mi><mo id="S4.SS1.p7.14.m2.2.2.1.2.2a" lspace="0.167em" xref="S4.SS1.p7.14.m2.2.2.1.2.2.cmml">â¡</mo><mi id="S4.SS1.p7.14.m2.2.2.1.2.2.2" xref="S4.SS1.p7.14.m2.2.2.1.2.2.2.cmml">max</mi></mrow><mrow id="S4.SS1.p7.14.m2.2.2.1.2.3" xref="S4.SS1.p7.14.m2.2.2.1.2.3.cmml"><mi id="S4.SS1.p7.14.m2.2.2.1.2.3.2" xref="S4.SS1.p7.14.m2.2.2.1.2.3.2.cmml">d</mi><mo id="S4.SS1.p7.14.m2.2.2.1.2.3.1" xref="S4.SS1.p7.14.m2.2.2.1.2.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p7.14.m2.2.2.1.2.3.3" xref="S4.SS1.p7.14.m2.2.2.1.2.3.3.cmml">ğ’Ÿ</mi></mrow></msub><mrow id="S4.SS1.p7.14.m2.2.2.1.1" xref="S4.SS1.p7.14.m2.2.2.1.1.cmml"><msub id="S4.SS1.p7.14.m2.2.2.1.1.3" xref="S4.SS1.p7.14.m2.2.2.1.1.3.cmml"><mi id="S4.SS1.p7.14.m2.2.2.1.1.3.2" xref="S4.SS1.p7.14.m2.2.2.1.1.3.2.cmml">s</mi><mi id="S4.SS1.p7.14.m2.2.2.1.1.3.3" xref="S4.SS1.p7.14.m2.2.2.1.1.3.3.cmml">Ï•</mi></msub><mo id="S4.SS1.p7.14.m2.2.2.1.1.2" xref="S4.SS1.p7.14.m2.2.2.1.1.2.cmml">â¢</mo><mrow id="S4.SS1.p7.14.m2.2.2.1.1.1.1" xref="S4.SS1.p7.14.m2.2.2.1.1.1.2.cmml"><mo id="S4.SS1.p7.14.m2.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS1.p7.14.m2.2.2.1.1.1.2.cmml">(</mo><mi id="S4.SS1.p7.14.m2.1.1" xref="S4.SS1.p7.14.m2.1.1.cmml">d</mi><mo id="S4.SS1.p7.14.m2.2.2.1.1.1.1.3" xref="S4.SS1.p7.14.m2.2.2.1.1.1.2.cmml">,</mo><msup id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.cmml"><mi id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.2" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.2.cmml">t</mi><mtext id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.3" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.3a.cmml">target</mtext></msup><mo id="S4.SS1.p7.14.m2.2.2.1.1.1.1.4" stretchy="false" xref="S4.SS1.p7.14.m2.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.14.m2.2b"><apply id="S4.SS1.p7.14.m2.2.2.cmml" xref="S4.SS1.p7.14.m2.2.2"><eq id="S4.SS1.p7.14.m2.2.2.2.cmml" xref="S4.SS1.p7.14.m2.2.2.2"></eq><apply id="S4.SS1.p7.14.m2.2.2.3.cmml" xref="S4.SS1.p7.14.m2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p7.14.m2.2.2.3.1.cmml" xref="S4.SS1.p7.14.m2.2.2.3">superscript</csymbol><ci id="S4.SS1.p7.14.m2.2.2.3.2.cmml" xref="S4.SS1.p7.14.m2.2.2.3.2">ğ‘¡</ci><ci id="S4.SS1.p7.14.m2.2.2.3.3a.cmml" xref="S4.SS1.p7.14.m2.2.2.3.3"><mtext id="S4.SS1.p7.14.m2.2.2.3.3.cmml" mathsize="70%" xref="S4.SS1.p7.14.m2.2.2.3.3">semantic retri</mtext></ci></apply><apply id="S4.SS1.p7.14.m2.2.2.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1"><apply id="S4.SS1.p7.14.m2.2.2.1.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2"><csymbol cd="ambiguous" id="S4.SS1.p7.14.m2.2.2.1.2.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2">subscript</csymbol><apply id="S4.SS1.p7.14.m2.2.2.1.2.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2.2"><arg id="S4.SS1.p7.14.m2.2.2.1.2.2.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2.2.1"></arg><max id="S4.SS1.p7.14.m2.2.2.1.2.2.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2.2.2"></max></apply><apply id="S4.SS1.p7.14.m2.2.2.1.2.3.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2.3"><in id="S4.SS1.p7.14.m2.2.2.1.2.3.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2.3.1"></in><ci id="S4.SS1.p7.14.m2.2.2.1.2.3.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2.3.2">ğ‘‘</ci><ci id="S4.SS1.p7.14.m2.2.2.1.2.3.3.cmml" xref="S4.SS1.p7.14.m2.2.2.1.2.3.3">ğ’Ÿ</ci></apply></apply><apply id="S4.SS1.p7.14.m2.2.2.1.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1"><times id="S4.SS1.p7.14.m2.2.2.1.1.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.2"></times><apply id="S4.SS1.p7.14.m2.2.2.1.1.3.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p7.14.m2.2.2.1.1.3.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.3">subscript</csymbol><ci id="S4.SS1.p7.14.m2.2.2.1.1.3.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.3.2">ğ‘ </ci><ci id="S4.SS1.p7.14.m2.2.2.1.1.3.3.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.3.3">italic-Ï•</ci></apply><interval closure="open" id="S4.SS1.p7.14.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1"><ci id="S4.SS1.p7.14.m2.1.1.cmml" xref="S4.SS1.p7.14.m2.1.1">ğ‘‘</ci><apply id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.2.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.3a.cmml" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.3"><mtext id="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.SS1.p7.14.m2.2.2.1.1.1.1.1.3">target</mtext></ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.14.m2.2c">t^{\textrm{semantic retri}}=\mathop{\arg\max}_{d\in\mathcal{D}}s_{\phi}(d,t^{%
\textrm{target}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.14.m2.2d">italic_t start_POSTSUPERSCRIPT semantic retri end_POSTSUPERSCRIPT = start_BIGOP roman_arg roman_max end_BIGOP start_POSTSUBSCRIPT italic_d âˆˆ caligraphic_D end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_d , italic_t start_POSTSUPERSCRIPT target end_POSTSUPERSCRIPT )</annotation></semantics></math>. In our experiments, we may use topological retrieval, prototypical semantic retrieval, or a hybrid approach that combines both by concatenating their retrieved texts. For simplicity, we denote the retrieved text as <math alttext="t^{\mathrm{retri}}" class="ltx_Math" display="inline" id="S4.SS1.p7.15.m3.1"><semantics id="S4.SS1.p7.15.m3.1a"><msup id="S4.SS1.p7.15.m3.1.1" xref="S4.SS1.p7.15.m3.1.1.cmml"><mi id="S4.SS1.p7.15.m3.1.1.2" xref="S4.SS1.p7.15.m3.1.1.2.cmml">t</mi><mi id="S4.SS1.p7.15.m3.1.1.3" xref="S4.SS1.p7.15.m3.1.1.3.cmml">retri</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p7.15.m3.1b"><apply id="S4.SS1.p7.15.m3.1.1.cmml" xref="S4.SS1.p7.15.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p7.15.m3.1.1.1.cmml" xref="S4.SS1.p7.15.m3.1.1">superscript</csymbol><ci id="S4.SS1.p7.15.m3.1.1.2.cmml" xref="S4.SS1.p7.15.m3.1.1.2">ğ‘¡</ci><ci id="S4.SS1.p7.15.m3.1.1.3.cmml" xref="S4.SS1.p7.15.m3.1.1.3">retri</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p7.15.m3.1c">t^{\mathrm{retri}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p7.15.m3.1d">italic_t start_POSTSUPERSCRIPT roman_retri end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p8">
<p class="ltx_p" id="S4.SS1.p8.2">We defer the discussion of training <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS1.p8.1.m1.1"><semantics id="S4.SS1.p8.1.m1.1a"><mi id="S4.SS1.p8.1.m1.1.1" xref="S4.SS1.p8.1.m1.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.1.m1.1b"><ci id="S4.SS1.p8.1.m1.1.1.cmml" xref="S4.SS1.p8.1.m1.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.1.m1.1d">italic_Ï•</annotation></semantics></math> and <math alttext="\mathtt{GNN}_{\psi}" class="ltx_Math" display="inline" id="S4.SS1.p8.2.m2.1"><semantics id="S4.SS1.p8.2.m2.1a"><msub id="S4.SS1.p8.2.m2.1.1" xref="S4.SS1.p8.2.m2.1.1.cmml"><mi id="S4.SS1.p8.2.m2.1.1.2" xref="S4.SS1.p8.2.m2.1.1.2.cmml">ğ™¶ğ™½ğ™½</mi><mi id="S4.SS1.p8.2.m2.1.1.3" xref="S4.SS1.p8.2.m2.1.1.3.cmml">Ïˆ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p8.2.m2.1b"><apply id="S4.SS1.p8.2.m2.1.1.cmml" xref="S4.SS1.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p8.2.m2.1.1.1.cmml" xref="S4.SS1.p8.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p8.2.m2.1.1.2.cmml" xref="S4.SS1.p8.2.m2.1.1.2">ğ™¶ğ™½ğ™½</ci><ci id="S4.SS1.p8.2.m2.1.1.3.cmml" xref="S4.SS1.p8.2.m2.1.1.3">ğœ“</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p8.2.m2.1c">\mathtt{GNN}_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p8.2.m2.1d">typewriter_GNN start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT</annotation></semantics></math> to SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS4" title="4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4.4</span></a> and their specific architectures in SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5" title="5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Classifier Guidance</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Recent studiesÂ <cite class="ltx_cite ltx_citemacro_citep">(Huang etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib25" title="">2023</a>; Fatemi etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib16" title="">2024</a>; Chen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib10" title="">2024</a>)</cite> highlighted the limited understanding of graph topology in current mainstream LMs. While InstructGLMÂ <cite class="ltx_cite ltx_citemacro_citep">(Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>)</cite> addresses this limitation by incorporating node embeddings from a pretrained GNN into the LMâ€™s token embeddings, this approach necessitates modifications to the LMâ€™s architecture. We propose an alternative method that conveys guidance from a pretrained GNN to inform LMs within the input text space, thereby preserving the LMâ€™s original architecture while presenting a pruned set of classification candidates.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.3">We repurpose the pretrained <math alttext="\mathtt{GNN}_{\psi}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">ğ™¶ğ™½ğ™½</mi><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">Ïˆ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">ğ™¶ğ™½ğ™½</ci><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">ğœ“</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathtt{GNN}_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">typewriter_GNN start_POSTSUBSCRIPT italic_Ïˆ end_POSTSUBSCRIPT</annotation></semantics></math> from the prototypical semantic retrieval module to inform <span class="ltx_text ltx_font_smallcaps" id="S4.SS2.p2.3.1">AugGLMÂ </span>. For each node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">v</mi><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">ğ‘£</ci><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we identify and store the top-<math alttext="I" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">ğ¼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_I</annotation></semantics></math> predicted labels:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx9">
<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{i}=\left\{j:\tilde{\mathbf{y}}_{i}[j]\in\text{top-I}%
(\tilde{\mathbf{y}}_{i})\right\}\in\{1,\dots,C\}^{I}" class="ltx_Math" display="inline" id="S4.E9.m1.6"><semantics id="S4.E9.m1.6a"><mrow id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml"><msub id="S4.E9.m1.6.6.3" xref="S4.E9.m1.6.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.6.6.3.2" xref="S4.E9.m1.6.6.3.2.cmml">â„’</mi><mi id="S4.E9.m1.6.6.3.3" xref="S4.E9.m1.6.6.3.3.cmml">i</mi></msub><mo id="S4.E9.m1.6.6.4" xref="S4.E9.m1.6.6.4.cmml">=</mo><mrow id="S4.E9.m1.6.6.1.1" xref="S4.E9.m1.6.6.1.2.cmml"><mo id="S4.E9.m1.6.6.1.1.2" xref="S4.E9.m1.6.6.1.2.1.cmml">{</mo><mi id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml">j</mi><mo id="S4.E9.m1.6.6.1.1.3" lspace="0.278em" rspace="0.278em" xref="S4.E9.m1.6.6.1.2.1.cmml">:</mo><mrow id="S4.E9.m1.6.6.1.1.1" xref="S4.E9.m1.6.6.1.1.1.cmml"><mrow id="S4.E9.m1.6.6.1.1.1.3" xref="S4.E9.m1.6.6.1.1.1.3.cmml"><msub id="S4.E9.m1.6.6.1.1.1.3.2" xref="S4.E9.m1.6.6.1.1.1.3.2.cmml"><mover accent="true" id="S4.E9.m1.6.6.1.1.1.3.2.2" xref="S4.E9.m1.6.6.1.1.1.3.2.2.cmml"><mi id="S4.E9.m1.6.6.1.1.1.3.2.2.2" xref="S4.E9.m1.6.6.1.1.1.3.2.2.2.cmml">ğ²</mi><mo id="S4.E9.m1.6.6.1.1.1.3.2.2.1" xref="S4.E9.m1.6.6.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S4.E9.m1.6.6.1.1.1.3.2.3" xref="S4.E9.m1.6.6.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.6.6.1.1.1.3.1" xref="S4.E9.m1.6.6.1.1.1.3.1.cmml">â¢</mo><mrow id="S4.E9.m1.6.6.1.1.1.3.3.2" xref="S4.E9.m1.6.6.1.1.1.3.3.1.cmml"><mo id="S4.E9.m1.6.6.1.1.1.3.3.2.1" stretchy="false" xref="S4.E9.m1.6.6.1.1.1.3.3.1.1.cmml">[</mo><mi id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">j</mi><mo id="S4.E9.m1.6.6.1.1.1.3.3.2.2" stretchy="false" xref="S4.E9.m1.6.6.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E9.m1.6.6.1.1.1.2" xref="S4.E9.m1.6.6.1.1.1.2.cmml">âˆˆ</mo><mrow id="S4.E9.m1.6.6.1.1.1.1" xref="S4.E9.m1.6.6.1.1.1.1.cmml"><mtext id="S4.E9.m1.6.6.1.1.1.1.3" xref="S4.E9.m1.6.6.1.1.1.1.3a.cmml">top-I</mtext><mo id="S4.E9.m1.6.6.1.1.1.1.2" xref="S4.E9.m1.6.6.1.1.1.1.2.cmml">â¢</mo><mrow id="S4.E9.m1.6.6.1.1.1.1.1.1" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E9.m1.6.6.1.1.1.1.1.1.1" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E9.m1.6.6.1.1.1.1.1.1.1.2" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">ğ²</mi><mo id="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.1" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E9.m1.6.6.1.1.1.1.1.1.1.3" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.6.6.1.1.4" xref="S4.E9.m1.6.6.1.2.1.cmml">}</mo></mrow><mo id="S4.E9.m1.6.6.5" xref="S4.E9.m1.6.6.5.cmml">âˆˆ</mo><msup id="S4.E9.m1.6.6.6" xref="S4.E9.m1.6.6.6.cmml"><mrow id="S4.E9.m1.6.6.6.2.2" xref="S4.E9.m1.6.6.6.2.1.cmml"><mo id="S4.E9.m1.6.6.6.2.2.1" stretchy="false" xref="S4.E9.m1.6.6.6.2.1.cmml">{</mo><mn id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml">1</mn><mo id="S4.E9.m1.6.6.6.2.2.2" xref="S4.E9.m1.6.6.6.2.1.cmml">,</mo><mi id="S4.E9.m1.4.4" mathvariant="normal" xref="S4.E9.m1.4.4.cmml">â€¦</mi><mo id="S4.E9.m1.6.6.6.2.2.3" xref="S4.E9.m1.6.6.6.2.1.cmml">,</mo><mi id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml">C</mi><mo id="S4.E9.m1.6.6.6.2.2.4" stretchy="false" xref="S4.E9.m1.6.6.6.2.1.cmml">}</mo></mrow><mi id="S4.E9.m1.6.6.6.3" xref="S4.E9.m1.6.6.6.3.cmml">I</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.6b"><apply id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6"><and id="S4.E9.m1.6.6a.cmml" xref="S4.E9.m1.6.6"></and><apply id="S4.E9.m1.6.6b.cmml" xref="S4.E9.m1.6.6"><eq id="S4.E9.m1.6.6.4.cmml" xref="S4.E9.m1.6.6.4"></eq><apply id="S4.E9.m1.6.6.3.cmml" xref="S4.E9.m1.6.6.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.3.1.cmml" xref="S4.E9.m1.6.6.3">subscript</csymbol><ci id="S4.E9.m1.6.6.3.2.cmml" xref="S4.E9.m1.6.6.3.2">â„’</ci><ci id="S4.E9.m1.6.6.3.3.cmml" xref="S4.E9.m1.6.6.3.3">ğ‘–</ci></apply><apply id="S4.E9.m1.6.6.1.2.cmml" xref="S4.E9.m1.6.6.1.1"><csymbol cd="latexml" id="S4.E9.m1.6.6.1.2.1.cmml" xref="S4.E9.m1.6.6.1.1.2">conditional-set</csymbol><ci id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2">ğ‘—</ci><apply id="S4.E9.m1.6.6.1.1.1.cmml" xref="S4.E9.m1.6.6.1.1.1"><in id="S4.E9.m1.6.6.1.1.1.2.cmml" xref="S4.E9.m1.6.6.1.1.1.2"></in><apply id="S4.E9.m1.6.6.1.1.1.3.cmml" xref="S4.E9.m1.6.6.1.1.1.3"><times id="S4.E9.m1.6.6.1.1.1.3.1.cmml" xref="S4.E9.m1.6.6.1.1.1.3.1"></times><apply id="S4.E9.m1.6.6.1.1.1.3.2.cmml" xref="S4.E9.m1.6.6.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.1.1.1.3.2.1.cmml" xref="S4.E9.m1.6.6.1.1.1.3.2">subscript</csymbol><apply id="S4.E9.m1.6.6.1.1.1.3.2.2.cmml" xref="S4.E9.m1.6.6.1.1.1.3.2.2"><ci id="S4.E9.m1.6.6.1.1.1.3.2.2.1.cmml" xref="S4.E9.m1.6.6.1.1.1.3.2.2.1">~</ci><ci id="S4.E9.m1.6.6.1.1.1.3.2.2.2.cmml" xref="S4.E9.m1.6.6.1.1.1.3.2.2.2">ğ²</ci></apply><ci id="S4.E9.m1.6.6.1.1.1.3.2.3.cmml" xref="S4.E9.m1.6.6.1.1.1.3.2.3">ğ‘–</ci></apply><apply id="S4.E9.m1.6.6.1.1.1.3.3.1.cmml" xref="S4.E9.m1.6.6.1.1.1.3.3.2"><csymbol cd="latexml" id="S4.E9.m1.6.6.1.1.1.3.3.1.1.cmml" xref="S4.E9.m1.6.6.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1">ğ‘—</ci></apply></apply><apply id="S4.E9.m1.6.6.1.1.1.1.cmml" xref="S4.E9.m1.6.6.1.1.1.1"><times id="S4.E9.m1.6.6.1.1.1.1.2.cmml" xref="S4.E9.m1.6.6.1.1.1.1.2"></times><ci id="S4.E9.m1.6.6.1.1.1.1.3a.cmml" xref="S4.E9.m1.6.6.1.1.1.1.3"><mtext id="S4.E9.m1.6.6.1.1.1.1.3.cmml" xref="S4.E9.m1.6.6.1.1.1.1.3">top-I</mtext></ci><apply id="S4.E9.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.6.6.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.2"><ci id="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.1">~</ci><ci id="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.2.2">ğ²</ci></apply><ci id="S4.E9.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.6.6.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply></apply></apply></apply><apply id="S4.E9.m1.6.6c.cmml" xref="S4.E9.m1.6.6"><in id="S4.E9.m1.6.6.5.cmml" xref="S4.E9.m1.6.6.5"></in><share href="https://arxiv.org/html/2410.02296v1#S4.E9.m1.6.6.1.cmml" id="S4.E9.m1.6.6d.cmml" xref="S4.E9.m1.6.6"></share><apply id="S4.E9.m1.6.6.6.cmml" xref="S4.E9.m1.6.6.6"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.1.cmml" xref="S4.E9.m1.6.6.6">superscript</csymbol><set id="S4.E9.m1.6.6.6.2.1.cmml" xref="S4.E9.m1.6.6.6.2.2"><cn id="S4.E9.m1.3.3.cmml" type="integer" xref="S4.E9.m1.3.3">1</cn><ci id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4">â€¦</ci><ci id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5">ğ¶</ci></set><ci id="S4.E9.m1.6.6.6.3.cmml" xref="S4.E9.m1.6.6.6.3">ğ¼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.6c">\displaystyle\mathcal{L}_{i}=\left\{j:\tilde{\mathbf{y}}_{i}[j]\in\text{top-I}%
(\tilde{\mathbf{y}}_{i})\right\}\in\{1,\dots,C\}^{I}</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.6d">caligraphic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { italic_j : over~ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT [ italic_j ] âˆˆ top-I ( over~ start_ARG bold_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } âˆˆ { 1 , â€¦ , italic_C } start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.7">where <math alttext="I&lt;C" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m1.1"><semantics id="S4.SS2.p2.4.m1.1a"><mrow id="S4.SS2.p2.4.m1.1.1" xref="S4.SS2.p2.4.m1.1.1.cmml"><mi id="S4.SS2.p2.4.m1.1.1.2" xref="S4.SS2.p2.4.m1.1.1.2.cmml">I</mi><mo id="S4.SS2.p2.4.m1.1.1.1" xref="S4.SS2.p2.4.m1.1.1.1.cmml">&lt;</mo><mi id="S4.SS2.p2.4.m1.1.1.3" xref="S4.SS2.p2.4.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m1.1b"><apply id="S4.SS2.p2.4.m1.1.1.cmml" xref="S4.SS2.p2.4.m1.1.1"><lt id="S4.SS2.p2.4.m1.1.1.1.cmml" xref="S4.SS2.p2.4.m1.1.1.1"></lt><ci id="S4.SS2.p2.4.m1.1.1.2.cmml" xref="S4.SS2.p2.4.m1.1.1.2">ğ¼</ci><ci id="S4.SS2.p2.4.m1.1.1.3.cmml" xref="S4.SS2.p2.4.m1.1.1.3">ğ¶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m1.1c">I&lt;C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m1.1d">italic_I &lt; italic_C</annotation></semantics></math>. Given that <math alttext="\mathrm{IndexToLabel}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m2.1"><semantics id="S4.SS2.p2.5.m2.1a"><mi id="S4.SS2.p2.5.m2.1.1" xref="S4.SS2.p2.5.m2.1.1.cmml">IndexToLabel</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m2.1b"><ci id="S4.SS2.p2.5.m2.1.1.cmml" xref="S4.SS2.p2.5.m2.1.1">IndexToLabel</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m2.1c">\mathrm{IndexToLabel}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m2.1d">roman_IndexToLabel</annotation></semantics></math> maps are available for our target datasets, which associate numerical labels with their corresponding text representations, we can leverage this mapping to present the pruned label candidates for node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m3.1"><semantics id="S4.SS2.p2.6.m3.1a"><msub id="S4.SS2.p2.6.m3.1.1" xref="S4.SS2.p2.6.m3.1.1.cmml"><mi id="S4.SS2.p2.6.m3.1.1.2" xref="S4.SS2.p2.6.m3.1.1.2.cmml">v</mi><mi id="S4.SS2.p2.6.m3.1.1.3" xref="S4.SS2.p2.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m3.1b"><apply id="S4.SS2.p2.6.m3.1.1.cmml" xref="S4.SS2.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m3.1.1.1.cmml" xref="S4.SS2.p2.6.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m3.1.1.2.cmml" xref="S4.SS2.p2.6.m3.1.1.2">ğ‘£</ci><ci id="S4.SS2.p2.6.m3.1.1.3.cmml" xref="S4.SS2.p2.6.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as a concatenated text: <math alttext="t^{\text{candidates}}=\oplus_{i\in\mathcal{L}_{i}}\mathrm{IndexToLabel}(i)" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m4.1"><semantics id="S4.SS2.p2.7.m4.1a"><mrow id="S4.SS2.p2.7.m4.1.2" xref="S4.SS2.p2.7.m4.1.2.cmml"><msup id="S4.SS2.p2.7.m4.1.2.2" xref="S4.SS2.p2.7.m4.1.2.2.cmml"><mi id="S4.SS2.p2.7.m4.1.2.2.2" xref="S4.SS2.p2.7.m4.1.2.2.2.cmml">t</mi><mtext id="S4.SS2.p2.7.m4.1.2.2.3" xref="S4.SS2.p2.7.m4.1.2.2.3a.cmml">candidates</mtext></msup><mo id="S4.SS2.p2.7.m4.1.2.1" rspace="0em" xref="S4.SS2.p2.7.m4.1.2.1.cmml">=</mo><mrow id="S4.SS2.p2.7.m4.1.2.3" xref="S4.SS2.p2.7.m4.1.2.3.cmml"><msub id="S4.SS2.p2.7.m4.1.2.3.1" xref="S4.SS2.p2.7.m4.1.2.3.1.cmml"><mo id="S4.SS2.p2.7.m4.1.2.3.1.2" lspace="0em" xref="S4.SS2.p2.7.m4.1.2.3.1.2.cmml">âŠ•</mo><mrow id="S4.SS2.p2.7.m4.1.2.3.1.3" xref="S4.SS2.p2.7.m4.1.2.3.1.3.cmml"><mi id="S4.SS2.p2.7.m4.1.2.3.1.3.2" xref="S4.SS2.p2.7.m4.1.2.3.1.3.2.cmml">i</mi><mo id="S4.SS2.p2.7.m4.1.2.3.1.3.1" xref="S4.SS2.p2.7.m4.1.2.3.1.3.1.cmml">âˆˆ</mo><msub id="S4.SS2.p2.7.m4.1.2.3.1.3.3" xref="S4.SS2.p2.7.m4.1.2.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.7.m4.1.2.3.1.3.3.2" xref="S4.SS2.p2.7.m4.1.2.3.1.3.3.2.cmml">â„’</mi><mi id="S4.SS2.p2.7.m4.1.2.3.1.3.3.3" xref="S4.SS2.p2.7.m4.1.2.3.1.3.3.3.cmml">i</mi></msub></mrow></msub><mrow id="S4.SS2.p2.7.m4.1.2.3.2" xref="S4.SS2.p2.7.m4.1.2.3.2.cmml"><mi id="S4.SS2.p2.7.m4.1.2.3.2.2" xref="S4.SS2.p2.7.m4.1.2.3.2.2.cmml">IndexToLabel</mi><mo id="S4.SS2.p2.7.m4.1.2.3.2.1" xref="S4.SS2.p2.7.m4.1.2.3.2.1.cmml">â¢</mo><mrow id="S4.SS2.p2.7.m4.1.2.3.2.3.2" xref="S4.SS2.p2.7.m4.1.2.3.2.cmml"><mo id="S4.SS2.p2.7.m4.1.2.3.2.3.2.1" stretchy="false" xref="S4.SS2.p2.7.m4.1.2.3.2.cmml">(</mo><mi id="S4.SS2.p2.7.m4.1.1" xref="S4.SS2.p2.7.m4.1.1.cmml">i</mi><mo id="S4.SS2.p2.7.m4.1.2.3.2.3.2.2" stretchy="false" xref="S4.SS2.p2.7.m4.1.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m4.1b"><apply id="S4.SS2.p2.7.m4.1.2.cmml" xref="S4.SS2.p2.7.m4.1.2"><eq id="S4.SS2.p2.7.m4.1.2.1.cmml" xref="S4.SS2.p2.7.m4.1.2.1"></eq><apply id="S4.SS2.p2.7.m4.1.2.2.cmml" xref="S4.SS2.p2.7.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m4.1.2.2.1.cmml" xref="S4.SS2.p2.7.m4.1.2.2">superscript</csymbol><ci id="S4.SS2.p2.7.m4.1.2.2.2.cmml" xref="S4.SS2.p2.7.m4.1.2.2.2">ğ‘¡</ci><ci id="S4.SS2.p2.7.m4.1.2.2.3a.cmml" xref="S4.SS2.p2.7.m4.1.2.2.3"><mtext id="S4.SS2.p2.7.m4.1.2.2.3.cmml" mathsize="70%" xref="S4.SS2.p2.7.m4.1.2.2.3">candidates</mtext></ci></apply><apply id="S4.SS2.p2.7.m4.1.2.3.cmml" xref="S4.SS2.p2.7.m4.1.2.3"><apply id="S4.SS2.p2.7.m4.1.2.3.1.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m4.1.2.3.1.1.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.SS2.p2.7.m4.1.2.3.1.2.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.2">direct-sum</csymbol><apply id="S4.SS2.p2.7.m4.1.2.3.1.3.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.3"><in id="S4.SS2.p2.7.m4.1.2.3.1.3.1.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.3.1"></in><ci id="S4.SS2.p2.7.m4.1.2.3.1.3.2.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.3.2">ğ‘–</ci><apply id="S4.SS2.p2.7.m4.1.2.3.1.3.3.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m4.1.2.3.1.3.3.1.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.7.m4.1.2.3.1.3.3.2.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.3.3.2">â„’</ci><ci id="S4.SS2.p2.7.m4.1.2.3.1.3.3.3.cmml" xref="S4.SS2.p2.7.m4.1.2.3.1.3.3.3">ğ‘–</ci></apply></apply></apply><apply id="S4.SS2.p2.7.m4.1.2.3.2.cmml" xref="S4.SS2.p2.7.m4.1.2.3.2"><times id="S4.SS2.p2.7.m4.1.2.3.2.1.cmml" xref="S4.SS2.p2.7.m4.1.2.3.2.1"></times><ci id="S4.SS2.p2.7.m4.1.2.3.2.2.cmml" xref="S4.SS2.p2.7.m4.1.2.3.2.2">IndexToLabel</ci><ci id="S4.SS2.p2.7.m4.1.1.cmml" xref="S4.SS2.p2.7.m4.1.1">ğ‘–</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m4.1c">t^{\text{candidates}}=\oplus_{i\in\mathcal{L}_{i}}\mathrm{IndexToLabel}(i)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m4.1d">italic_t start_POSTSUPERSCRIPT candidates end_POSTSUPERSCRIPT = âŠ• start_POSTSUBSCRIPT italic_i âˆˆ caligraphic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_IndexToLabel ( italic_i )</annotation></semantics></math>. The integration of this pruned candidate set into the input template is detailed in SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS3" title="4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4.3</span></a>, where we elaborate on our overall template design.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">By adopting this approach, we inject valuable structure-aware inductive bias from the GNNâ€™s prediction into the LMâ€™s input, thereby enhancing its ability to perform node classification tasks without altering its fundamental architecture. By focusing the LMâ€™s attention on a smaller, more relevant set of potential labels, we can improve its classification accuracy.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Overall template</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.5">Our augmented training samples are presented in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.F3" title="Figure 3 â€£ 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">3</span></a>, which includes three key elements: (1) the target nodeâ€™s text <math alttext="t^{\mathrm{target}}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msup id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">t</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">target</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">ğ‘¡</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">t^{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT</annotation></semantics></math>, (2) the retrieved nodesâ€™ text <math alttext="t^{\mathrm{retri}}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><msup id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">t</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">retri</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">ğ‘¡</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">retri</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">t^{\mathrm{retri}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_t start_POSTSUPERSCRIPT roman_retri end_POSTSUPERSCRIPT</annotation></semantics></math>, and (3) the pruned label candidates <math alttext="t^{\mathrm{candidates}}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><msup id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">t</mi><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">candidates</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">ğ‘¡</ci><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">candidates</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">t^{\mathrm{candidates}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_t start_POSTSUPERSCRIPT roman_candidates end_POSTSUPERSCRIPT</annotation></semantics></math>. We collectively denote these elements as <math alttext="t^{\mathrm{input}}=(t^{\mathrm{target}},t^{\mathrm{retri}},t^{\mathrm{%
candidates}})" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.3"><semantics id="S4.SS3.p1.4.m4.3a"><mrow id="S4.SS3.p1.4.m4.3.3" xref="S4.SS3.p1.4.m4.3.3.cmml"><msup id="S4.SS3.p1.4.m4.3.3.5" xref="S4.SS3.p1.4.m4.3.3.5.cmml"><mi id="S4.SS3.p1.4.m4.3.3.5.2" xref="S4.SS3.p1.4.m4.3.3.5.2.cmml">t</mi><mi id="S4.SS3.p1.4.m4.3.3.5.3" xref="S4.SS3.p1.4.m4.3.3.5.3.cmml">input</mi></msup><mo id="S4.SS3.p1.4.m4.3.3.4" xref="S4.SS3.p1.4.m4.3.3.4.cmml">=</mo><mrow id="S4.SS3.p1.4.m4.3.3.3.3" xref="S4.SS3.p1.4.m4.3.3.3.4.cmml"><mo id="S4.SS3.p1.4.m4.3.3.3.3.4" stretchy="false" xref="S4.SS3.p1.4.m4.3.3.3.4.cmml">(</mo><msup id="S4.SS3.p1.4.m4.1.1.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.1.1.1.2" xref="S4.SS3.p1.4.m4.1.1.1.1.1.2.cmml">t</mi><mi id="S4.SS3.p1.4.m4.1.1.1.1.1.3" xref="S4.SS3.p1.4.m4.1.1.1.1.1.3.cmml">target</mi></msup><mo id="S4.SS3.p1.4.m4.3.3.3.3.5" xref="S4.SS3.p1.4.m4.3.3.3.4.cmml">,</mo><msup id="S4.SS3.p1.4.m4.2.2.2.2.2" xref="S4.SS3.p1.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS3.p1.4.m4.2.2.2.2.2.2" xref="S4.SS3.p1.4.m4.2.2.2.2.2.2.cmml">t</mi><mi id="S4.SS3.p1.4.m4.2.2.2.2.2.3" xref="S4.SS3.p1.4.m4.2.2.2.2.2.3.cmml">retri</mi></msup><mo id="S4.SS3.p1.4.m4.3.3.3.3.6" xref="S4.SS3.p1.4.m4.3.3.3.4.cmml">,</mo><msup id="S4.SS3.p1.4.m4.3.3.3.3.3" xref="S4.SS3.p1.4.m4.3.3.3.3.3.cmml"><mi id="S4.SS3.p1.4.m4.3.3.3.3.3.2" xref="S4.SS3.p1.4.m4.3.3.3.3.3.2.cmml">t</mi><mi id="S4.SS3.p1.4.m4.3.3.3.3.3.3" xref="S4.SS3.p1.4.m4.3.3.3.3.3.3.cmml">candidates</mi></msup><mo id="S4.SS3.p1.4.m4.3.3.3.3.7" stretchy="false" xref="S4.SS3.p1.4.m4.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.3b"><apply id="S4.SS3.p1.4.m4.3.3.cmml" xref="S4.SS3.p1.4.m4.3.3"><eq id="S4.SS3.p1.4.m4.3.3.4.cmml" xref="S4.SS3.p1.4.m4.3.3.4"></eq><apply id="S4.SS3.p1.4.m4.3.3.5.cmml" xref="S4.SS3.p1.4.m4.3.3.5"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.3.3.5.1.cmml" xref="S4.SS3.p1.4.m4.3.3.5">superscript</csymbol><ci id="S4.SS3.p1.4.m4.3.3.5.2.cmml" xref="S4.SS3.p1.4.m4.3.3.5.2">ğ‘¡</ci><ci id="S4.SS3.p1.4.m4.3.3.5.3.cmml" xref="S4.SS3.p1.4.m4.3.3.5.3">input</ci></apply><vector id="S4.SS3.p1.4.m4.3.3.3.4.cmml" xref="S4.SS3.p1.4.m4.3.3.3.3"><apply id="S4.SS3.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.SS3.p1.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.3">target</ci></apply><apply id="S4.SS3.p1.4.m4.2.2.2.2.2.cmml" xref="S4.SS3.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS3.p1.4.m4.2.2.2.2.2">superscript</csymbol><ci id="S4.SS3.p1.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS3.p1.4.m4.2.2.2.2.2.2">ğ‘¡</ci><ci id="S4.SS3.p1.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS3.p1.4.m4.2.2.2.2.2.3">retri</ci></apply><apply id="S4.SS3.p1.4.m4.3.3.3.3.3.cmml" xref="S4.SS3.p1.4.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.3.3.3.3.3.1.cmml" xref="S4.SS3.p1.4.m4.3.3.3.3.3">superscript</csymbol><ci id="S4.SS3.p1.4.m4.3.3.3.3.3.2.cmml" xref="S4.SS3.p1.4.m4.3.3.3.3.3.2">ğ‘¡</ci><ci id="S4.SS3.p1.4.m4.3.3.3.3.3.3.cmml" xref="S4.SS3.p1.4.m4.3.3.3.3.3.3">candidates</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.3c">t^{\mathrm{input}}=(t^{\mathrm{target}},t^{\mathrm{retri}},t^{\mathrm{%
candidates}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.3d">italic_t start_POSTSUPERSCRIPT roman_input end_POSTSUPERSCRIPT = ( italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT , italic_t start_POSTSUPERSCRIPT roman_retri end_POSTSUPERSCRIPT , italic_t start_POSTSUPERSCRIPT roman_candidates end_POSTSUPERSCRIPT )</annotation></semantics></math>. The backbone LM generates a prediction probability for the label sequence <math alttext="y^{\mathrm{target}}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><msup id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mi id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">y</mi><mi id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">target</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">ğ‘¦</ci><ci id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">y^{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT</annotation></semantics></math> according to the following equation:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx10">
<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{\mathrm{LM}}(y^{\mathrm{target}}|t^{\mathrm{input}})=\prod_{i%
=1}^{|y|}p_{\mathrm{LM}}(y^{\mathrm{target}}_{i}|t^{\mathrm{input}},y^{\mathrm%
{target}}_{1:i-1})" class="ltx_Math" display="inline" id="S4.E10.m1.3"><semantics id="S4.E10.m1.3a"><mrow id="S4.E10.m1.3.3" xref="S4.E10.m1.3.3.cmml"><mrow id="S4.E10.m1.2.2.1" xref="S4.E10.m1.2.2.1.cmml"><msub id="S4.E10.m1.2.2.1.3" xref="S4.E10.m1.2.2.1.3.cmml"><mi id="S4.E10.m1.2.2.1.3.2" xref="S4.E10.m1.2.2.1.3.2.cmml">p</mi><mi id="S4.E10.m1.2.2.1.3.3" xref="S4.E10.m1.2.2.1.3.3.cmml">LM</mi></msub><mo id="S4.E10.m1.2.2.1.2" xref="S4.E10.m1.2.2.1.2.cmml">â¢</mo><mrow id="S4.E10.m1.2.2.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.cmml"><mo id="S4.E10.m1.2.2.1.1.1.2" stretchy="false" xref="S4.E10.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.2.2.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.cmml"><msup id="S4.E10.m1.2.2.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.2.cmml"><mi id="S4.E10.m1.2.2.1.1.1.1.2.2" xref="S4.E10.m1.2.2.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E10.m1.2.2.1.1.1.1.2.3" xref="S4.E10.m1.2.2.1.1.1.1.2.3.cmml">target</mi></msup><mo fence="false" id="S4.E10.m1.2.2.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.cmml">|</mo><msup id="S4.E10.m1.2.2.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E10.m1.2.2.1.1.1.1.3.2" xref="S4.E10.m1.2.2.1.1.1.1.3.2.cmml">t</mi><mi id="S4.E10.m1.2.2.1.1.1.1.3.3" xref="S4.E10.m1.2.2.1.1.1.1.3.3.cmml">input</mi></msup></mrow><mo id="S4.E10.m1.2.2.1.1.1.3" stretchy="false" xref="S4.E10.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.3" xref="S4.E10.m1.3.3.3.cmml">=</mo><mrow id="S4.E10.m1.3.3.2" xref="S4.E10.m1.3.3.2.cmml"><mstyle displaystyle="true" id="S4.E10.m1.3.3.2.2" xref="S4.E10.m1.3.3.2.2.cmml"><munderover id="S4.E10.m1.3.3.2.2a" xref="S4.E10.m1.3.3.2.2.cmml"><mo id="S4.E10.m1.3.3.2.2.2.2" movablelimits="false" xref="S4.E10.m1.3.3.2.2.2.2.cmml">âˆ</mo><mrow id="S4.E10.m1.3.3.2.2.2.3" xref="S4.E10.m1.3.3.2.2.2.3.cmml"><mi id="S4.E10.m1.3.3.2.2.2.3.2" xref="S4.E10.m1.3.3.2.2.2.3.2.cmml">i</mi><mo id="S4.E10.m1.3.3.2.2.2.3.1" xref="S4.E10.m1.3.3.2.2.2.3.1.cmml">=</mo><mn id="S4.E10.m1.3.3.2.2.2.3.3" xref="S4.E10.m1.3.3.2.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E10.m1.1.1.1.3" xref="S4.E10.m1.1.1.1.2.cmml"><mo id="S4.E10.m1.1.1.1.3.1" stretchy="false" xref="S4.E10.m1.1.1.1.2.1.cmml">|</mo><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">y</mi><mo id="S4.E10.m1.1.1.1.3.2" stretchy="false" xref="S4.E10.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S4.E10.m1.3.3.2.1" xref="S4.E10.m1.3.3.2.1.cmml"><msub id="S4.E10.m1.3.3.2.1.3" xref="S4.E10.m1.3.3.2.1.3.cmml"><mi id="S4.E10.m1.3.3.2.1.3.2" xref="S4.E10.m1.3.3.2.1.3.2.cmml">p</mi><mi id="S4.E10.m1.3.3.2.1.3.3" xref="S4.E10.m1.3.3.2.1.3.3.cmml">LM</mi></msub><mo id="S4.E10.m1.3.3.2.1.2" xref="S4.E10.m1.3.3.2.1.2.cmml">â¢</mo><mrow id="S4.E10.m1.3.3.2.1.1.1" xref="S4.E10.m1.3.3.2.1.1.1.1.cmml"><mo id="S4.E10.m1.3.3.2.1.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.2.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.3.3.2.1.1.1.1" xref="S4.E10.m1.3.3.2.1.1.1.1.cmml"><msubsup id="S4.E10.m1.3.3.2.1.1.1.1.4" xref="S4.E10.m1.3.3.2.1.1.1.1.4.cmml"><mi id="S4.E10.m1.3.3.2.1.1.1.1.4.2.2" xref="S4.E10.m1.3.3.2.1.1.1.1.4.2.2.cmml">y</mi><mi id="S4.E10.m1.3.3.2.1.1.1.1.4.3" xref="S4.E10.m1.3.3.2.1.1.1.1.4.3.cmml">i</mi><mi id="S4.E10.m1.3.3.2.1.1.1.1.4.2.3" xref="S4.E10.m1.3.3.2.1.1.1.1.4.2.3.cmml">target</mi></msubsup><mo fence="false" id="S4.E10.m1.3.3.2.1.1.1.1.3" xref="S4.E10.m1.3.3.2.1.1.1.1.3.cmml">|</mo><mrow id="S4.E10.m1.3.3.2.1.1.1.1.2.2" xref="S4.E10.m1.3.3.2.1.1.1.1.2.3.cmml"><msup id="S4.E10.m1.3.3.2.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.3.cmml">input</mi></msup><mo id="S4.E10.m1.3.3.2.1.1.1.1.2.2.3" xref="S4.E10.m1.3.3.2.1.1.1.1.2.3.cmml">,</mo><msubsup id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.cmml"><mi id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.2" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.cmml"><mn id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.2" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.2.cmml">1</mn><mo id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.1.cmml">:</mo><mrow id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.cmml"><mi id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.2" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.2.cmml">i</mi><mo id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.1" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.1.cmml">âˆ’</mo><mn id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.3" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.3" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.3.cmml">target</mi></msubsup></mrow></mrow><mo id="S4.E10.m1.3.3.2.1.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.3b"><apply id="S4.E10.m1.3.3.cmml" xref="S4.E10.m1.3.3"><eq id="S4.E10.m1.3.3.3.cmml" xref="S4.E10.m1.3.3.3"></eq><apply id="S4.E10.m1.2.2.1.cmml" xref="S4.E10.m1.2.2.1"><times id="S4.E10.m1.2.2.1.2.cmml" xref="S4.E10.m1.2.2.1.2"></times><apply id="S4.E10.m1.2.2.1.3.cmml" xref="S4.E10.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.3.1.cmml" xref="S4.E10.m1.2.2.1.3">subscript</csymbol><ci id="S4.E10.m1.2.2.1.3.2.cmml" xref="S4.E10.m1.2.2.1.3.2">ğ‘</ci><ci id="S4.E10.m1.2.2.1.3.3.cmml" xref="S4.E10.m1.2.2.1.3.3">LM</ci></apply><apply id="S4.E10.m1.2.2.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1"><csymbol cd="latexml" id="S4.E10.m1.2.2.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1">conditional</csymbol><apply id="S4.E10.m1.2.2.1.1.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S4.E10.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2.2">ğ‘¦</ci><ci id="S4.E10.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2.3">target</ci></apply><apply id="S4.E10.m1.2.2.1.1.1.1.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S4.E10.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.3.2">ğ‘¡</ci><ci id="S4.E10.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.3.3">input</ci></apply></apply></apply><apply id="S4.E10.m1.3.3.2.cmml" xref="S4.E10.m1.3.3.2"><apply id="S4.E10.m1.3.3.2.2.cmml" xref="S4.E10.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.2.1.cmml" xref="S4.E10.m1.3.3.2.2">superscript</csymbol><apply id="S4.E10.m1.3.3.2.2.2.cmml" xref="S4.E10.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.2.2.1.cmml" xref="S4.E10.m1.3.3.2.2">subscript</csymbol><csymbol cd="latexml" id="S4.E10.m1.3.3.2.2.2.2.cmml" xref="S4.E10.m1.3.3.2.2.2.2">product</csymbol><apply id="S4.E10.m1.3.3.2.2.2.3.cmml" xref="S4.E10.m1.3.3.2.2.2.3"><eq id="S4.E10.m1.3.3.2.2.2.3.1.cmml" xref="S4.E10.m1.3.3.2.2.2.3.1"></eq><ci id="S4.E10.m1.3.3.2.2.2.3.2.cmml" xref="S4.E10.m1.3.3.2.2.2.3.2">ğ‘–</ci><cn id="S4.E10.m1.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.E10.m1.3.3.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.3"><abs id="S4.E10.m1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.3.1"></abs><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">ğ‘¦</ci></apply></apply><apply id="S4.E10.m1.3.3.2.1.cmml" xref="S4.E10.m1.3.3.2.1"><times id="S4.E10.m1.3.3.2.1.2.cmml" xref="S4.E10.m1.3.3.2.1.2"></times><apply id="S4.E10.m1.3.3.2.1.3.cmml" xref="S4.E10.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.1.3.1.cmml" xref="S4.E10.m1.3.3.2.1.3">subscript</csymbol><ci id="S4.E10.m1.3.3.2.1.3.2.cmml" xref="S4.E10.m1.3.3.2.1.3.2">ğ‘</ci><ci id="S4.E10.m1.3.3.2.1.3.3.cmml" xref="S4.E10.m1.3.3.2.1.3.3">LM</ci></apply><apply id="S4.E10.m1.3.3.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1"><csymbol cd="latexml" id="S4.E10.m1.3.3.2.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.3">conditional</csymbol><apply id="S4.E10.m1.3.3.2.1.1.1.1.4.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.1.1.1.1.4.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.4">subscript</csymbol><apply id="S4.E10.m1.3.3.2.1.1.1.1.4.2.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.1.1.1.1.4.2.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.4">superscript</csymbol><ci id="S4.E10.m1.3.3.2.1.1.1.1.4.2.2.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.4.2.2">ğ‘¦</ci><ci id="S4.E10.m1.3.3.2.1.1.1.1.4.2.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.4.2.3">target</ci></apply><ci id="S4.E10.m1.3.3.2.1.1.1.1.4.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.4.3">ğ‘–</ci></apply><list id="S4.E10.m1.3.3.2.1.1.1.1.2.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2"><apply id="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.1.1.1.3">input</ci></apply><apply id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2">subscript</csymbol><apply id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.2">ğ‘¦</ci><ci id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.2.3">target</ci></apply><apply id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3"><ci id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.1">:</ci><cn id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.2">1</cn><apply id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3"><minus id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.1.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.1"></minus><ci id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.2.cmml" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.2">ğ‘–</ci><cn id="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S4.E10.m1.3.3.2.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.3c">\displaystyle p_{\mathrm{LM}}(y^{\mathrm{target}}|t^{\mathrm{input}})=\prod_{i%
=1}^{|y|}p_{\mathrm{LM}}(y^{\mathrm{target}}_{i}|t^{\mathrm{input}},y^{\mathrm%
{target}}_{1:i-1})</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.3d">italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT | italic_t start_POSTSUPERSCRIPT roman_input end_POSTSUPERSCRIPT ) = âˆ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_y | end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_t start_POSTSUPERSCRIPT roman_input end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 : italic_i - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p1.11">where <math alttext="|\cdot|" class="ltx_math_unparsed" display="inline" id="S4.SS3.p1.6.m1.1"><semantics id="S4.SS3.p1.6.m1.1a"><mrow id="S4.SS3.p1.6.m1.1b"><mo fence="false" id="S4.SS3.p1.6.m1.1.1" stretchy="false">|</mo><mo id="S4.SS3.p1.6.m1.1.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="S4.SS3.p1.6.m1.1.3" stretchy="false">|</mo></mrow><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m1.1c">|\cdot|</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m1.1d">| â‹… |</annotation></semantics></math> represents the sequence length; in this equation, <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m2.1"><semantics id="S4.SS3.p1.7.m2.1a"><mi id="S4.SS3.p1.7.m2.1.1" xref="S4.SS3.p1.7.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m2.1b"><ci id="S4.SS3.p1.7.m2.1.1.cmml" xref="S4.SS3.p1.7.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m2.1d">italic_i</annotation></semantics></math> and <math alttext="1:i-1" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m3.1"><semantics id="S4.SS3.p1.8.m3.1a"><mrow id="S4.SS3.p1.8.m3.1.1" xref="S4.SS3.p1.8.m3.1.1.cmml"><mn id="S4.SS3.p1.8.m3.1.1.2" xref="S4.SS3.p1.8.m3.1.1.2.cmml">1</mn><mo id="S4.SS3.p1.8.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p1.8.m3.1.1.1.cmml">:</mo><mrow id="S4.SS3.p1.8.m3.1.1.3" xref="S4.SS3.p1.8.m3.1.1.3.cmml"><mi id="S4.SS3.p1.8.m3.1.1.3.2" xref="S4.SS3.p1.8.m3.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p1.8.m3.1.1.3.1" xref="S4.SS3.p1.8.m3.1.1.3.1.cmml">âˆ’</mo><mn id="S4.SS3.p1.8.m3.1.1.3.3" xref="S4.SS3.p1.8.m3.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m3.1b"><apply id="S4.SS3.p1.8.m3.1.1.cmml" xref="S4.SS3.p1.8.m3.1.1"><ci id="S4.SS3.p1.8.m3.1.1.1.cmml" xref="S4.SS3.p1.8.m3.1.1.1">:</ci><cn id="S4.SS3.p1.8.m3.1.1.2.cmml" type="integer" xref="S4.SS3.p1.8.m3.1.1.2">1</cn><apply id="S4.SS3.p1.8.m3.1.1.3.cmml" xref="S4.SS3.p1.8.m3.1.1.3"><minus id="S4.SS3.p1.8.m3.1.1.3.1.cmml" xref="S4.SS3.p1.8.m3.1.1.3.1"></minus><ci id="S4.SS3.p1.8.m3.1.1.3.2.cmml" xref="S4.SS3.p1.8.m3.1.1.3.2">ğ‘–</ci><cn id="S4.SS3.p1.8.m3.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.8.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m3.1c">1:i-1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.8.m3.1d">1 : italic_i - 1</annotation></semantics></math> are token-level indices. We will introduce the detailed selection of the backbone LM in SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5" title="5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">5</span></a>. FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.F3" title="Figure 3 â€£ 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">3</span></a> presents an exemplar template for the Cora dataset, showcasing the integration of <math alttext="t^{\mathrm{target}}" class="ltx_Math" display="inline" id="S4.SS3.p1.9.m4.1"><semantics id="S4.SS3.p1.9.m4.1a"><msup id="S4.SS3.p1.9.m4.1.1" xref="S4.SS3.p1.9.m4.1.1.cmml"><mi id="S4.SS3.p1.9.m4.1.1.2" xref="S4.SS3.p1.9.m4.1.1.2.cmml">t</mi><mi id="S4.SS3.p1.9.m4.1.1.3" xref="S4.SS3.p1.9.m4.1.1.3.cmml">target</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m4.1b"><apply id="S4.SS3.p1.9.m4.1.1.cmml" xref="S4.SS3.p1.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m4.1.1.1.cmml" xref="S4.SS3.p1.9.m4.1.1">superscript</csymbol><ci id="S4.SS3.p1.9.m4.1.1.2.cmml" xref="S4.SS3.p1.9.m4.1.1.2">ğ‘¡</ci><ci id="S4.SS3.p1.9.m4.1.1.3.cmml" xref="S4.SS3.p1.9.m4.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m4.1c">t^{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.9.m4.1d">italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="t^{\mathrm{retri}}" class="ltx_Math" display="inline" id="S4.SS3.p1.10.m5.1"><semantics id="S4.SS3.p1.10.m5.1a"><msup id="S4.SS3.p1.10.m5.1.1" xref="S4.SS3.p1.10.m5.1.1.cmml"><mi id="S4.SS3.p1.10.m5.1.1.2" xref="S4.SS3.p1.10.m5.1.1.2.cmml">t</mi><mi id="S4.SS3.p1.10.m5.1.1.3" xref="S4.SS3.p1.10.m5.1.1.3.cmml">retri</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m5.1b"><apply id="S4.SS3.p1.10.m5.1.1.cmml" xref="S4.SS3.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m5.1.1.1.cmml" xref="S4.SS3.p1.10.m5.1.1">superscript</csymbol><ci id="S4.SS3.p1.10.m5.1.1.2.cmml" xref="S4.SS3.p1.10.m5.1.1.2">ğ‘¡</ci><ci id="S4.SS3.p1.10.m5.1.1.3.cmml" xref="S4.SS3.p1.10.m5.1.1.3">retri</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m5.1c">t^{\mathrm{retri}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.10.m5.1d">italic_t start_POSTSUPERSCRIPT roman_retri end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="t^{\mathrm{candidates}}" class="ltx_Math" display="inline" id="S4.SS3.p1.11.m6.1"><semantics id="S4.SS3.p1.11.m6.1a"><msup id="S4.SS3.p1.11.m6.1.1" xref="S4.SS3.p1.11.m6.1.1.cmml"><mi id="S4.SS3.p1.11.m6.1.1.2" xref="S4.SS3.p1.11.m6.1.1.2.cmml">t</mi><mi id="S4.SS3.p1.11.m6.1.1.3" xref="S4.SS3.p1.11.m6.1.1.3.cmml">candidates</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m6.1b"><apply id="S4.SS3.p1.11.m6.1.1.cmml" xref="S4.SS3.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m6.1.1.1.cmml" xref="S4.SS3.p1.11.m6.1.1">superscript</csymbol><ci id="S4.SS3.p1.11.m6.1.1.2.cmml" xref="S4.SS3.p1.11.m6.1.1.2">ğ‘¡</ci><ci id="S4.SS3.p1.11.m6.1.1.3.cmml" xref="S4.SS3.p1.11.m6.1.1.3">candidates</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m6.1c">t^{\mathrm{candidates}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.11.m6.1d">italic_t start_POSTSUPERSCRIPT roman_candidates end_POSTSUPERSCRIPT</annotation></semantics></math>. A full list of templates used on all datasets in our experiments is detailed in AppendixÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A3" title="Appendix C Templates â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">C</span></a>. Note that we exclude the abstracts of the retrieved nodes to prevent exceeding the maximum input length constraints of most LMs. During evaluation, we utilize only the â€œmodel inputâ€ portion of this template.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="202" id="S4.F3.g1" src="extracted/5898142/Figs/template_ours.png" width="302"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Our graph-to-text template with augmented text features.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Training</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Our framework includes three parameterized modules that require training or fine-tuning: (1) GNNs for generating prototypes and candidate label pruning, as described in SectionsÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS1" title="4.1 Retrieval-Based Aggregation â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4.1</span></a> andÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS2" title="4.2 Classifier Guidance â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4.2</span></a>, (2) the encoder <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_Ï•</annotation></semantics></math> from the semantic retriever, defined in Eq.Â <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E5" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">5</span></a>, and (3) the backbone LM, utilized in Eq.Â <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E10" title="In 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">10</span></a>. The GNNs from SectionsÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS1" title="4.1 Retrieval-Based Aggregation â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4.1</span></a> andÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.SS2" title="4.2 Classifier Guidance â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4.2</span></a> can be shared and their training is independent of the other modules which is supervised by ground truth labels. We provide more details on this process in AppendixÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A1" title="Appendix A Architecture and Training of the Graph Neural Network ğœ“ â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.7">For the backbone LM, we adopt a standard training objective: minimizing the average token-wise negative log-likelihood (NLL) between the ground truth target sequence and the modelâ€™s estimated output probability (Eq.Â <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E10" title="In 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">10</span></a>). Specifically, for the target node, the NLL loss is computed as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx11">
<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\mathrm{NLL}}(p_{\mathrm{LM}}(y^{\mathrm{target}}|t^%
{\mathrm{input}}),y^{\mathrm{target}})" class="ltx_Math" display="inline" id="S4.E11.m1.2"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><msub id="S4.E11.m1.2.2.4" xref="S4.E11.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.2.2.4.2" xref="S4.E11.m1.2.2.4.2.cmml">â„’</mi><mi id="S4.E11.m1.2.2.4.3" xref="S4.E11.m1.2.2.4.3.cmml">NLL</mi></msub><mo id="S4.E11.m1.2.2.3" xref="S4.E11.m1.2.2.3.cmml">â¢</mo><mrow id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.3.cmml"><mo id="S4.E11.m1.2.2.2.2.3" stretchy="false" xref="S4.E11.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml"><msub id="S4.E11.m1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S4.E11.m1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.3.3.cmml">LM</mi></msub><mo id="S4.E11.m1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E11.m1.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.3.cmml">target</mi></msup><mo fence="false" id="S4.E11.m1.1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S4.E11.m1.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.3.cmml">input</mi></msup></mrow><mo id="S4.E11.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.2.2.2.2.4" xref="S4.E11.m1.2.2.2.3.cmml">,</mo><msup id="S4.E11.m1.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E11.m1.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.2.3.cmml">target</mi></msup><mo id="S4.E11.m1.2.2.2.2.5" stretchy="false" xref="S4.E11.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.2b"><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2"><times id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2.3"></times><apply id="S4.E11.m1.2.2.4.cmml" xref="S4.E11.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.4.1.cmml" xref="S4.E11.m1.2.2.4">subscript</csymbol><ci id="S4.E11.m1.2.2.4.2.cmml" xref="S4.E11.m1.2.2.4.2">â„’</ci><ci id="S4.E11.m1.2.2.4.3.cmml" xref="S4.E11.m1.2.2.4.3">NLL</ci></apply><interval closure="open" id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2"><apply id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><times id="S4.E11.m1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.2"></times><apply id="S4.E11.m1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.3.2">ğ‘</ci><ci id="S4.E11.m1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3.3">LM</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2">ğ‘¦</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.3">target</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.2">ğ‘¡</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.3">input</ci></apply></apply></apply><apply id="S4.E11.m1.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2">superscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2">ğ‘¦</ci><ci id="S4.E11.m1.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.3">target</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.2c">\displaystyle\mathcal{L}_{\mathrm{NLL}}(p_{\mathrm{LM}}(y^{\mathrm{target}}|t^%
{\mathrm{input}}),y^{\mathrm{target}})</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.2d">caligraphic_L start_POSTSUBSCRIPT roman_NLL end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT | italic_t start_POSTSUPERSCRIPT roman_input end_POSTSUPERSCRIPT ) , italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p2.2">To train the semantic retriever, we employ a distribution-matching loss. Specifically, for a given target nodeâ€™s text feature <math alttext="t^{\mathrm{target}}" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><msup id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">t</mi><mi id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">target</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">ğ‘¡</ci><ci id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">t^{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT</annotation></semantics></math>, we first compute the retrieval probability distribution over all prototype text <math alttext="t\in\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mrow id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">t</mi><mo id="S4.SS4.p2.2.m2.1.1.1" xref="S4.SS4.p2.2.m2.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml">ğ’Ÿ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><in id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1.1"></in><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">ğ‘¡</ci><ci id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">t\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_t âˆˆ caligraphic_D</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx12">
<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{\phi}(t|t^{\mathrm{target}})=\frac{\exp(s_{\phi}(t,t^{\mathrm%
{target}}))}{\sum_{t^{\prime}\in\mathcal{D}}\exp(s_{\phi}(t^{\prime},t^{%
\mathrm{target}}))}" class="ltx_Math" display="inline" id="S4.E12.m1.6"><semantics id="S4.E12.m1.6a"><mrow id="S4.E12.m1.6.6" xref="S4.E12.m1.6.6.cmml"><mrow id="S4.E12.m1.6.6.1" xref="S4.E12.m1.6.6.1.cmml"><msub id="S4.E12.m1.6.6.1.3" xref="S4.E12.m1.6.6.1.3.cmml"><mi id="S4.E12.m1.6.6.1.3.2" xref="S4.E12.m1.6.6.1.3.2.cmml">p</mi><mi id="S4.E12.m1.6.6.1.3.3" xref="S4.E12.m1.6.6.1.3.3.cmml">Ï•</mi></msub><mo id="S4.E12.m1.6.6.1.2" xref="S4.E12.m1.6.6.1.2.cmml">â¢</mo><mrow id="S4.E12.m1.6.6.1.1.1" xref="S4.E12.m1.6.6.1.1.1.1.cmml"><mo id="S4.E12.m1.6.6.1.1.1.2" stretchy="false" xref="S4.E12.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.6.6.1.1.1.1" xref="S4.E12.m1.6.6.1.1.1.1.cmml"><mi id="S4.E12.m1.6.6.1.1.1.1.2" xref="S4.E12.m1.6.6.1.1.1.1.2.cmml">t</mi><mo fence="false" id="S4.E12.m1.6.6.1.1.1.1.1" xref="S4.E12.m1.6.6.1.1.1.1.1.cmml">|</mo><msup id="S4.E12.m1.6.6.1.1.1.1.3" xref="S4.E12.m1.6.6.1.1.1.1.3.cmml"><mi id="S4.E12.m1.6.6.1.1.1.1.3.2" xref="S4.E12.m1.6.6.1.1.1.1.3.2.cmml">t</mi><mi id="S4.E12.m1.6.6.1.1.1.1.3.3" xref="S4.E12.m1.6.6.1.1.1.1.3.3.cmml">target</mi></msup></mrow><mo id="S4.E12.m1.6.6.1.1.1.3" stretchy="false" xref="S4.E12.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.6.6.2" xref="S4.E12.m1.6.6.2.cmml">=</mo><mstyle displaystyle="true" id="S4.E12.m1.5.5" xref="S4.E12.m1.5.5.cmml"><mfrac id="S4.E12.m1.5.5a" xref="S4.E12.m1.5.5.cmml"><mrow id="S4.E12.m1.3.3.3.3" xref="S4.E12.m1.3.3.3.4.cmml"><mi id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml">exp</mi><mo id="S4.E12.m1.3.3.3.3a" xref="S4.E12.m1.3.3.3.4.cmml">â¡</mo><mrow id="S4.E12.m1.3.3.3.3.1" xref="S4.E12.m1.3.3.3.4.cmml"><mo id="S4.E12.m1.3.3.3.3.1.2" stretchy="false" xref="S4.E12.m1.3.3.3.4.cmml">(</mo><mrow id="S4.E12.m1.3.3.3.3.1.1" xref="S4.E12.m1.3.3.3.3.1.1.cmml"><msub id="S4.E12.m1.3.3.3.3.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.3.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.3.2" xref="S4.E12.m1.3.3.3.3.1.1.3.2.cmml">s</mi><mi id="S4.E12.m1.3.3.3.3.1.1.3.3" xref="S4.E12.m1.3.3.3.3.1.1.3.3.cmml">Ï•</mi></msub><mo id="S4.E12.m1.3.3.3.3.1.1.2" xref="S4.E12.m1.3.3.3.3.1.1.2.cmml">â¢</mo><mrow id="S4.E12.m1.3.3.3.3.1.1.1.1" xref="S4.E12.m1.3.3.3.3.1.1.1.2.cmml"><mo id="S4.E12.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml">t</mi><mo id="S4.E12.m1.3.3.3.3.1.1.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.1.2.cmml">,</mo><msup id="S4.E12.m1.3.3.3.3.1.1.1.1.1" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E12.m1.3.3.3.3.1.1.1.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.3.cmml">target</mi></msup><mo id="S4.E12.m1.3.3.3.3.1.1.1.1.4" stretchy="false" xref="S4.E12.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.3.3.3.3.1.3" stretchy="false" xref="S4.E12.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S4.E12.m1.5.5.5" xref="S4.E12.m1.5.5.5.cmml"><msub id="S4.E12.m1.5.5.5.3" xref="S4.E12.m1.5.5.5.3.cmml"><mo id="S4.E12.m1.5.5.5.3.2" xref="S4.E12.m1.5.5.5.3.2.cmml">âˆ‘</mo><mrow id="S4.E12.m1.5.5.5.3.3" xref="S4.E12.m1.5.5.5.3.3.cmml"><msup id="S4.E12.m1.5.5.5.3.3.2" xref="S4.E12.m1.5.5.5.3.3.2.cmml"><mi id="S4.E12.m1.5.5.5.3.3.2.2" xref="S4.E12.m1.5.5.5.3.3.2.2.cmml">t</mi><mo id="S4.E12.m1.5.5.5.3.3.2.3" xref="S4.E12.m1.5.5.5.3.3.2.3.cmml">â€²</mo></msup><mo id="S4.E12.m1.5.5.5.3.3.1" xref="S4.E12.m1.5.5.5.3.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.5.5.5.3.3.3" xref="S4.E12.m1.5.5.5.3.3.3.cmml">ğ’Ÿ</mi></mrow></msub><mrow id="S4.E12.m1.5.5.5.2.1" xref="S4.E12.m1.5.5.5.2.2.cmml"><mi id="S4.E12.m1.4.4.4.1" xref="S4.E12.m1.4.4.4.1.cmml">exp</mi><mo id="S4.E12.m1.5.5.5.2.1a" xref="S4.E12.m1.5.5.5.2.2.cmml">â¡</mo><mrow id="S4.E12.m1.5.5.5.2.1.1" xref="S4.E12.m1.5.5.5.2.2.cmml"><mo id="S4.E12.m1.5.5.5.2.1.1.2" stretchy="false" xref="S4.E12.m1.5.5.5.2.2.cmml">(</mo><mrow id="S4.E12.m1.5.5.5.2.1.1.1" xref="S4.E12.m1.5.5.5.2.1.1.1.cmml"><msub id="S4.E12.m1.5.5.5.2.1.1.1.4" xref="S4.E12.m1.5.5.5.2.1.1.1.4.cmml"><mi id="S4.E12.m1.5.5.5.2.1.1.1.4.2" xref="S4.E12.m1.5.5.5.2.1.1.1.4.2.cmml">s</mi><mi id="S4.E12.m1.5.5.5.2.1.1.1.4.3" xref="S4.E12.m1.5.5.5.2.1.1.1.4.3.cmml">Ï•</mi></msub><mo id="S4.E12.m1.5.5.5.2.1.1.1.3" xref="S4.E12.m1.5.5.5.2.1.1.1.3.cmml">â¢</mo><mrow id="S4.E12.m1.5.5.5.2.1.1.1.2.2" xref="S4.E12.m1.5.5.5.2.1.1.1.2.3.cmml"><mo id="S4.E12.m1.5.5.5.2.1.1.1.2.2.3" stretchy="false" xref="S4.E12.m1.5.5.5.2.1.1.1.2.3.cmml">(</mo><msup id="S4.E12.m1.5.5.5.2.1.1.1.1.1.1" xref="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.2" xref="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.3" xref="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.3.cmml">â€²</mo></msup><mo id="S4.E12.m1.5.5.5.2.1.1.1.2.2.4" xref="S4.E12.m1.5.5.5.2.1.1.1.2.3.cmml">,</mo><msup id="S4.E12.m1.5.5.5.2.1.1.1.2.2.2" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.cmml"><mi id="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.2" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.2.cmml">t</mi><mi id="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.3" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.3.cmml">target</mi></msup><mo id="S4.E12.m1.5.5.5.2.1.1.1.2.2.5" stretchy="false" xref="S4.E12.m1.5.5.5.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.5.5.5.2.1.1.3" stretchy="false" xref="S4.E12.m1.5.5.5.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.6b"><apply id="S4.E12.m1.6.6.cmml" xref="S4.E12.m1.6.6"><eq id="S4.E12.m1.6.6.2.cmml" xref="S4.E12.m1.6.6.2"></eq><apply id="S4.E12.m1.6.6.1.cmml" xref="S4.E12.m1.6.6.1"><times id="S4.E12.m1.6.6.1.2.cmml" xref="S4.E12.m1.6.6.1.2"></times><apply id="S4.E12.m1.6.6.1.3.cmml" xref="S4.E12.m1.6.6.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.1.3.1.cmml" xref="S4.E12.m1.6.6.1.3">subscript</csymbol><ci id="S4.E12.m1.6.6.1.3.2.cmml" xref="S4.E12.m1.6.6.1.3.2">ğ‘</ci><ci id="S4.E12.m1.6.6.1.3.3.cmml" xref="S4.E12.m1.6.6.1.3.3">italic-Ï•</ci></apply><apply id="S4.E12.m1.6.6.1.1.1.1.cmml" xref="S4.E12.m1.6.6.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.6.6.1.1.1.1.1.cmml" xref="S4.E12.m1.6.6.1.1.1.1.1">conditional</csymbol><ci id="S4.E12.m1.6.6.1.1.1.1.2.cmml" xref="S4.E12.m1.6.6.1.1.1.1.2">ğ‘¡</ci><apply id="S4.E12.m1.6.6.1.1.1.1.3.cmml" xref="S4.E12.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.1.1.1.1.3.1.cmml" xref="S4.E12.m1.6.6.1.1.1.1.3">superscript</csymbol><ci id="S4.E12.m1.6.6.1.1.1.1.3.2.cmml" xref="S4.E12.m1.6.6.1.1.1.1.3.2">ğ‘¡</ci><ci id="S4.E12.m1.6.6.1.1.1.1.3.3.cmml" xref="S4.E12.m1.6.6.1.1.1.1.3.3">target</ci></apply></apply></apply><apply id="S4.E12.m1.5.5.cmml" xref="S4.E12.m1.5.5"><divide id="S4.E12.m1.5.5.6.cmml" xref="S4.E12.m1.5.5"></divide><apply id="S4.E12.m1.3.3.3.4.cmml" xref="S4.E12.m1.3.3.3.3"><exp id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2"></exp><apply id="S4.E12.m1.3.3.3.3.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1"><times id="S4.E12.m1.3.3.3.3.1.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2"></times><apply id="S4.E12.m1.3.3.3.3.1.1.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.3.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.3.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.2">ğ‘ </ci><ci id="S4.E12.m1.3.3.3.3.1.1.3.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.3">italic-Ï•</ci></apply><interval closure="open" id="S4.E12.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1"><ci id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1">ğ‘¡</ci><apply id="S4.E12.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.E12.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.3">target</ci></apply></interval></apply></apply><apply id="S4.E12.m1.5.5.5.cmml" xref="S4.E12.m1.5.5.5"><apply id="S4.E12.m1.5.5.5.3.cmml" xref="S4.E12.m1.5.5.5.3"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.5.3.1.cmml" xref="S4.E12.m1.5.5.5.3">subscript</csymbol><sum id="S4.E12.m1.5.5.5.3.2.cmml" xref="S4.E12.m1.5.5.5.3.2"></sum><apply id="S4.E12.m1.5.5.5.3.3.cmml" xref="S4.E12.m1.5.5.5.3.3"><in id="S4.E12.m1.5.5.5.3.3.1.cmml" xref="S4.E12.m1.5.5.5.3.3.1"></in><apply id="S4.E12.m1.5.5.5.3.3.2.cmml" xref="S4.E12.m1.5.5.5.3.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.5.3.3.2.1.cmml" xref="S4.E12.m1.5.5.5.3.3.2">superscript</csymbol><ci id="S4.E12.m1.5.5.5.3.3.2.2.cmml" xref="S4.E12.m1.5.5.5.3.3.2.2">ğ‘¡</ci><ci id="S4.E12.m1.5.5.5.3.3.2.3.cmml" xref="S4.E12.m1.5.5.5.3.3.2.3">â€²</ci></apply><ci id="S4.E12.m1.5.5.5.3.3.3.cmml" xref="S4.E12.m1.5.5.5.3.3.3">ğ’Ÿ</ci></apply></apply><apply id="S4.E12.m1.5.5.5.2.2.cmml" xref="S4.E12.m1.5.5.5.2.1"><exp id="S4.E12.m1.4.4.4.1.cmml" xref="S4.E12.m1.4.4.4.1"></exp><apply id="S4.E12.m1.5.5.5.2.1.1.1.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1"><times id="S4.E12.m1.5.5.5.2.1.1.1.3.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.3"></times><apply id="S4.E12.m1.5.5.5.2.1.1.1.4.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.4"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.5.2.1.1.1.4.1.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.4">subscript</csymbol><ci id="S4.E12.m1.5.5.5.2.1.1.1.4.2.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.4.2">ğ‘ </ci><ci id="S4.E12.m1.5.5.5.2.1.1.1.4.3.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.4.3">italic-Ï•</ci></apply><interval closure="open" id="S4.E12.m1.5.5.5.2.1.1.1.2.3.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2"><apply id="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.1.1.1.3">â€²</ci></apply><apply id="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.1.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2.2">superscript</csymbol><ci id="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.2.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.2">ğ‘¡</ci><ci id="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.3.cmml" xref="S4.E12.m1.5.5.5.2.1.1.1.2.2.2.3">target</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.6c">\displaystyle p_{\phi}(t|t^{\mathrm{target}})=\frac{\exp(s_{\phi}(t,t^{\mathrm%
{target}}))}{\sum_{t^{\prime}\in\mathcal{D}}\exp(s_{\phi}(t^{\prime},t^{%
\mathrm{target}}))}</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.6d">italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT ) = divide start_ARG roman_exp ( italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t , italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT ) ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_D end_POSTSUBSCRIPT roman_exp ( italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p2.8">Next, we compute the empirical distribution supervised by the LM as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx13">
<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{p}_{\mathrm{LM}}(t|t^{\mathrm{target}},y^{\mathrm{target}}%
)=\frac{\exp(p_{\mathrm{LM}}(y^{\mathrm{target}}|t^{\mathrm{target}},t))}{\sum%
_{t^{\prime}\in\mathcal{D}}\exp(p_{\mathrm{LM}}(y^{\mathrm{target}}|t^{\mathrm%
{target}},t^{\prime}))}" class="ltx_Math" display="inline" id="S4.E13.m1.6"><semantics id="S4.E13.m1.6a"><mrow id="S4.E13.m1.6.6" xref="S4.E13.m1.6.6.cmml"><mrow id="S4.E13.m1.6.6.1" xref="S4.E13.m1.6.6.1.cmml"><msub id="S4.E13.m1.6.6.1.3" xref="S4.E13.m1.6.6.1.3.cmml"><mover accent="true" id="S4.E13.m1.6.6.1.3.2" xref="S4.E13.m1.6.6.1.3.2.cmml"><mi id="S4.E13.m1.6.6.1.3.2.2" xref="S4.E13.m1.6.6.1.3.2.2.cmml">p</mi><mo id="S4.E13.m1.6.6.1.3.2.1" xref="S4.E13.m1.6.6.1.3.2.1.cmml">~</mo></mover><mi id="S4.E13.m1.6.6.1.3.3" xref="S4.E13.m1.6.6.1.3.3.cmml">LM</mi></msub><mo id="S4.E13.m1.6.6.1.2" xref="S4.E13.m1.6.6.1.2.cmml">â¢</mo><mrow id="S4.E13.m1.6.6.1.1.1" xref="S4.E13.m1.6.6.1.1.1.1.cmml"><mo id="S4.E13.m1.6.6.1.1.1.2" stretchy="false" xref="S4.E13.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.6.6.1.1.1.1" xref="S4.E13.m1.6.6.1.1.1.1.cmml"><mi id="S4.E13.m1.6.6.1.1.1.1.4" xref="S4.E13.m1.6.6.1.1.1.1.4.cmml">t</mi><mo fence="false" id="S4.E13.m1.6.6.1.1.1.1.3" xref="S4.E13.m1.6.6.1.1.1.1.3.cmml">|</mo><mrow id="S4.E13.m1.6.6.1.1.1.1.2.2" xref="S4.E13.m1.6.6.1.1.1.1.2.3.cmml"><msup id="S4.E13.m1.6.6.1.1.1.1.1.1.1" xref="S4.E13.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.6.6.1.1.1.1.1.1.1.2" xref="S4.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E13.m1.6.6.1.1.1.1.1.1.1.3" xref="S4.E13.m1.6.6.1.1.1.1.1.1.1.3.cmml">target</mi></msup><mo id="S4.E13.m1.6.6.1.1.1.1.2.2.3" xref="S4.E13.m1.6.6.1.1.1.1.2.3.cmml">,</mo><msup id="S4.E13.m1.6.6.1.1.1.1.2.2.2" xref="S4.E13.m1.6.6.1.1.1.1.2.2.2.cmml"><mi id="S4.E13.m1.6.6.1.1.1.1.2.2.2.2" xref="S4.E13.m1.6.6.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S4.E13.m1.6.6.1.1.1.1.2.2.2.3" xref="S4.E13.m1.6.6.1.1.1.1.2.2.2.3.cmml">target</mi></msup></mrow></mrow><mo id="S4.E13.m1.6.6.1.1.1.3" stretchy="false" xref="S4.E13.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.6.6.2" xref="S4.E13.m1.6.6.2.cmml">=</mo><mstyle displaystyle="true" id="S4.E13.m1.5.5" xref="S4.E13.m1.5.5.cmml"><mfrac id="S4.E13.m1.5.5a" xref="S4.E13.m1.5.5.cmml"><mrow id="S4.E13.m1.3.3.3.3" xref="S4.E13.m1.3.3.3.4.cmml"><mi id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.2.cmml">exp</mi><mo id="S4.E13.m1.3.3.3.3a" xref="S4.E13.m1.3.3.3.4.cmml">â¡</mo><mrow id="S4.E13.m1.3.3.3.3.1" xref="S4.E13.m1.3.3.3.4.cmml"><mo id="S4.E13.m1.3.3.3.3.1.2" stretchy="false" xref="S4.E13.m1.3.3.3.4.cmml">(</mo><mrow id="S4.E13.m1.3.3.3.3.1.1" xref="S4.E13.m1.3.3.3.3.1.1.cmml"><msub id="S4.E13.m1.3.3.3.3.1.1.3" xref="S4.E13.m1.3.3.3.3.1.1.3.cmml"><mi id="S4.E13.m1.3.3.3.3.1.1.3.2" xref="S4.E13.m1.3.3.3.3.1.1.3.2.cmml">p</mi><mi id="S4.E13.m1.3.3.3.3.1.1.3.3" xref="S4.E13.m1.3.3.3.3.1.1.3.3.cmml">LM</mi></msub><mo id="S4.E13.m1.3.3.3.3.1.1.2" xref="S4.E13.m1.3.3.3.3.1.1.2.cmml">â¢</mo><mrow id="S4.E13.m1.3.3.3.3.1.1.1.1" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.cmml"><mo id="S4.E13.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.3.3.3.3.1.1.1.1.1" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.cmml"><msup id="S4.E13.m1.3.3.3.3.1.1.1.1.1.3" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.2" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.2.cmml">y</mi><mi id="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.3" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.3.cmml">target</mi></msup><mo fence="false" id="S4.E13.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.2.cmml"><msup id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml">target</mi></msup><mo id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml">t</mi></mrow></mrow><mo id="S4.E13.m1.3.3.3.3.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.3.3.3.3.1.3" stretchy="false" xref="S4.E13.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S4.E13.m1.5.5.5" xref="S4.E13.m1.5.5.5.cmml"><msub id="S4.E13.m1.5.5.5.3" xref="S4.E13.m1.5.5.5.3.cmml"><mo id="S4.E13.m1.5.5.5.3.2" xref="S4.E13.m1.5.5.5.3.2.cmml">âˆ‘</mo><mrow id="S4.E13.m1.5.5.5.3.3" xref="S4.E13.m1.5.5.5.3.3.cmml"><msup id="S4.E13.m1.5.5.5.3.3.2" xref="S4.E13.m1.5.5.5.3.3.2.cmml"><mi id="S4.E13.m1.5.5.5.3.3.2.2" xref="S4.E13.m1.5.5.5.3.3.2.2.cmml">t</mi><mo id="S4.E13.m1.5.5.5.3.3.2.3" xref="S4.E13.m1.5.5.5.3.3.2.3.cmml">â€²</mo></msup><mo id="S4.E13.m1.5.5.5.3.3.1" xref="S4.E13.m1.5.5.5.3.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.5.5.5.3.3.3" xref="S4.E13.m1.5.5.5.3.3.3.cmml">ğ’Ÿ</mi></mrow></msub><mrow id="S4.E13.m1.5.5.5.2.1" xref="S4.E13.m1.5.5.5.2.2.cmml"><mi id="S4.E13.m1.4.4.4.1" xref="S4.E13.m1.4.4.4.1.cmml">exp</mi><mo id="S4.E13.m1.5.5.5.2.1a" xref="S4.E13.m1.5.5.5.2.2.cmml">â¡</mo><mrow id="S4.E13.m1.5.5.5.2.1.1" xref="S4.E13.m1.5.5.5.2.2.cmml"><mo id="S4.E13.m1.5.5.5.2.1.1.2" stretchy="false" xref="S4.E13.m1.5.5.5.2.2.cmml">(</mo><mrow id="S4.E13.m1.5.5.5.2.1.1.1" xref="S4.E13.m1.5.5.5.2.1.1.1.cmml"><msub id="S4.E13.m1.5.5.5.2.1.1.1.3" xref="S4.E13.m1.5.5.5.2.1.1.1.3.cmml"><mi id="S4.E13.m1.5.5.5.2.1.1.1.3.2" xref="S4.E13.m1.5.5.5.2.1.1.1.3.2.cmml">p</mi><mi id="S4.E13.m1.5.5.5.2.1.1.1.3.3" xref="S4.E13.m1.5.5.5.2.1.1.1.3.3.cmml">LM</mi></msub><mo id="S4.E13.m1.5.5.5.2.1.1.1.2" xref="S4.E13.m1.5.5.5.2.1.1.1.2.cmml">â¢</mo><mrow id="S4.E13.m1.5.5.5.2.1.1.1.1.1" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.5.5.5.2.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.cmml"><msup id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.cmml"><mi id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.2" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.2.cmml">y</mi><mi id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.3" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.3.cmml">target</mi></msup><mo fence="false" id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.3" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.3.cmml"><msup id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.3.cmml">target</mi></msup><mo id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.3" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.2" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.2.cmml">t</mi><mo id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.3" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.3.cmml">â€²</mo></msup></mrow></mrow><mo id="S4.E13.m1.5.5.5.2.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.5.5.5.2.1.1.3" stretchy="false" xref="S4.E13.m1.5.5.5.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.6b"><apply id="S4.E13.m1.6.6.cmml" xref="S4.E13.m1.6.6"><eq id="S4.E13.m1.6.6.2.cmml" xref="S4.E13.m1.6.6.2"></eq><apply id="S4.E13.m1.6.6.1.cmml" xref="S4.E13.m1.6.6.1"><times id="S4.E13.m1.6.6.1.2.cmml" xref="S4.E13.m1.6.6.1.2"></times><apply id="S4.E13.m1.6.6.1.3.cmml" xref="S4.E13.m1.6.6.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.1.3.1.cmml" xref="S4.E13.m1.6.6.1.3">subscript</csymbol><apply id="S4.E13.m1.6.6.1.3.2.cmml" xref="S4.E13.m1.6.6.1.3.2"><ci id="S4.E13.m1.6.6.1.3.2.1.cmml" xref="S4.E13.m1.6.6.1.3.2.1">~</ci><ci id="S4.E13.m1.6.6.1.3.2.2.cmml" xref="S4.E13.m1.6.6.1.3.2.2">ğ‘</ci></apply><ci id="S4.E13.m1.6.6.1.3.3.cmml" xref="S4.E13.m1.6.6.1.3.3">LM</ci></apply><apply id="S4.E13.m1.6.6.1.1.1.1.cmml" xref="S4.E13.m1.6.6.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.6.6.1.1.1.1.3.cmml" xref="S4.E13.m1.6.6.1.1.1.1.3">conditional</csymbol><ci id="S4.E13.m1.6.6.1.1.1.1.4.cmml" xref="S4.E13.m1.6.6.1.1.1.1.4">ğ‘¡</ci><list id="S4.E13.m1.6.6.1.1.1.1.2.3.cmml" xref="S4.E13.m1.6.6.1.1.1.1.2.2"><apply id="S4.E13.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.6.6.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.6.6.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.E13.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.6.6.1.1.1.1.1.1.1.3">target</ci></apply><apply id="S4.E13.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.6.6.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.6.6.1.1.1.1.2.2.2.1.cmml" xref="S4.E13.m1.6.6.1.1.1.1.2.2.2">superscript</csymbol><ci id="S4.E13.m1.6.6.1.1.1.1.2.2.2.2.cmml" xref="S4.E13.m1.6.6.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="S4.E13.m1.6.6.1.1.1.1.2.2.2.3.cmml" xref="S4.E13.m1.6.6.1.1.1.1.2.2.2.3">target</ci></apply></list></apply></apply><apply id="S4.E13.m1.5.5.cmml" xref="S4.E13.m1.5.5"><divide id="S4.E13.m1.5.5.6.cmml" xref="S4.E13.m1.5.5"></divide><apply id="S4.E13.m1.3.3.3.4.cmml" xref="S4.E13.m1.3.3.3.3"><exp id="S4.E13.m1.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2"></exp><apply id="S4.E13.m1.3.3.3.3.1.1.cmml" xref="S4.E13.m1.3.3.3.3.1.1"><times id="S4.E13.m1.3.3.3.3.1.1.2.cmml" xref="S4.E13.m1.3.3.3.3.1.1.2"></times><apply id="S4.E13.m1.3.3.3.3.1.1.3.cmml" xref="S4.E13.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.3.3.1.1.3.1.cmml" xref="S4.E13.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S4.E13.m1.3.3.3.3.1.1.3.2.cmml" xref="S4.E13.m1.3.3.3.3.1.1.3.2">ğ‘</ci><ci id="S4.E13.m1.3.3.3.3.1.1.3.3.cmml" xref="S4.E13.m1.3.3.3.3.1.1.3.3">LM</ci></apply><apply id="S4.E13.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.2">conditional</csymbol><apply id="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.2">ğ‘¦</ci><ci id="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.3.3">target</ci></apply><list id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1"><apply id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.3.3.3.3.1.1.1.1.1.1.1.1.3">target</ci></apply><ci id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1">ğ‘¡</ci></list></apply></apply></apply><apply id="S4.E13.m1.5.5.5.cmml" xref="S4.E13.m1.5.5.5"><apply id="S4.E13.m1.5.5.5.3.cmml" xref="S4.E13.m1.5.5.5.3"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.5.3.1.cmml" xref="S4.E13.m1.5.5.5.3">subscript</csymbol><sum id="S4.E13.m1.5.5.5.3.2.cmml" xref="S4.E13.m1.5.5.5.3.2"></sum><apply id="S4.E13.m1.5.5.5.3.3.cmml" xref="S4.E13.m1.5.5.5.3.3"><in id="S4.E13.m1.5.5.5.3.3.1.cmml" xref="S4.E13.m1.5.5.5.3.3.1"></in><apply id="S4.E13.m1.5.5.5.3.3.2.cmml" xref="S4.E13.m1.5.5.5.3.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.5.3.3.2.1.cmml" xref="S4.E13.m1.5.5.5.3.3.2">superscript</csymbol><ci id="S4.E13.m1.5.5.5.3.3.2.2.cmml" xref="S4.E13.m1.5.5.5.3.3.2.2">ğ‘¡</ci><ci id="S4.E13.m1.5.5.5.3.3.2.3.cmml" xref="S4.E13.m1.5.5.5.3.3.2.3">â€²</ci></apply><ci id="S4.E13.m1.5.5.5.3.3.3.cmml" xref="S4.E13.m1.5.5.5.3.3.3">ğ’Ÿ</ci></apply></apply><apply id="S4.E13.m1.5.5.5.2.2.cmml" xref="S4.E13.m1.5.5.5.2.1"><exp id="S4.E13.m1.4.4.4.1.cmml" xref="S4.E13.m1.4.4.4.1"></exp><apply id="S4.E13.m1.5.5.5.2.1.1.1.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1"><times id="S4.E13.m1.5.5.5.2.1.1.1.2.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.2"></times><apply id="S4.E13.m1.5.5.5.2.1.1.1.3.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.5.2.1.1.1.3.1.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.5.5.5.2.1.1.1.3.2.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.3.2">ğ‘</ci><ci id="S4.E13.m1.5.5.5.2.1.1.1.3.3.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.3.3">LM</ci></apply><apply id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.3">conditional</csymbol><apply id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.1.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.2.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.2">ğ‘¦</ci><ci id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.3.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.4.3">target</ci></apply><list id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2"><apply id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.3">target</ci></apply><apply id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.2">ğ‘¡</ci><ci id="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E13.m1.5.5.5.2.1.1.1.1.1.1.2.2.2.3">â€²</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.6c">\displaystyle\tilde{p}_{\mathrm{LM}}(t|t^{\mathrm{target}},y^{\mathrm{target}}%
)=\frac{\exp(p_{\mathrm{LM}}(y^{\mathrm{target}}|t^{\mathrm{target}},t))}{\sum%
_{t^{\prime}\in\mathcal{D}}\exp(p_{\mathrm{LM}}(y^{\mathrm{target}}|t^{\mathrm%
{target}},t^{\prime}))}</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.6d">over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_t | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT ) = divide start_ARG roman_exp ( italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT , italic_t ) ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_D end_POSTSUBSCRIPT roman_exp ( italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT , italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p2.6">This distribution represents the normalized importance of each prototype text <math alttext="t\in\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m1.1"><semantics id="S4.SS4.p2.3.m1.1a"><mrow id="S4.SS4.p2.3.m1.1.1" xref="S4.SS4.p2.3.m1.1.1.cmml"><mi id="S4.SS4.p2.3.m1.1.1.2" xref="S4.SS4.p2.3.m1.1.1.2.cmml">t</mi><mo id="S4.SS4.p2.3.m1.1.1.1" xref="S4.SS4.p2.3.m1.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p2.3.m1.1.1.3" xref="S4.SS4.p2.3.m1.1.1.3.cmml">ğ’Ÿ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m1.1b"><apply id="S4.SS4.p2.3.m1.1.1.cmml" xref="S4.SS4.p2.3.m1.1.1"><in id="S4.SS4.p2.3.m1.1.1.1.cmml" xref="S4.SS4.p2.3.m1.1.1.1"></in><ci id="S4.SS4.p2.3.m1.1.1.2.cmml" xref="S4.SS4.p2.3.m1.1.1.2">ğ‘¡</ci><ci id="S4.SS4.p2.3.m1.1.1.3.cmml" xref="S4.SS4.p2.3.m1.1.1.3">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m1.1c">t\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m1.1d">italic_t âˆˆ caligraphic_D</annotation></semantics></math> based on the LMâ€™s likelihood of generating the target ground truth label text <math alttext="y^{\mathrm{target}}" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m2.1"><semantics id="S4.SS4.p2.4.m2.1a"><msup id="S4.SS4.p2.4.m2.1.1" xref="S4.SS4.p2.4.m2.1.1.cmml"><mi id="S4.SS4.p2.4.m2.1.1.2" xref="S4.SS4.p2.4.m2.1.1.2.cmml">y</mi><mi id="S4.SS4.p2.4.m2.1.1.3" xref="S4.SS4.p2.4.m2.1.1.3.cmml">target</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m2.1b"><apply id="S4.SS4.p2.4.m2.1.1.cmml" xref="S4.SS4.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.4.m2.1.1.1.cmml" xref="S4.SS4.p2.4.m2.1.1">superscript</csymbol><ci id="S4.SS4.p2.4.m2.1.1.2.cmml" xref="S4.SS4.p2.4.m2.1.1.2">ğ‘¦</ci><ci id="S4.SS4.p2.4.m2.1.1.3.cmml" xref="S4.SS4.p2.4.m2.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m2.1c">y^{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m2.1d">italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT</annotation></semantics></math>. We use <math alttext="\tilde{p}" class="ltx_Math" display="inline" id="S4.SS4.p2.5.m3.1"><semantics id="S4.SS4.p2.5.m3.1a"><mover accent="true" id="S4.SS4.p2.5.m3.1.1" xref="S4.SS4.p2.5.m3.1.1.cmml"><mi id="S4.SS4.p2.5.m3.1.1.2" xref="S4.SS4.p2.5.m3.1.1.2.cmml">p</mi><mo id="S4.SS4.p2.5.m3.1.1.1" xref="S4.SS4.p2.5.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m3.1b"><apply id="S4.SS4.p2.5.m3.1.1.cmml" xref="S4.SS4.p2.5.m3.1.1"><ci id="S4.SS4.p2.5.m3.1.1.1.cmml" xref="S4.SS4.p2.5.m3.1.1.1">~</ci><ci id="S4.SS4.p2.5.m3.1.1.2.cmml" xref="S4.SS4.p2.5.m3.1.1.2">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m3.1c">\tilde{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.5.m3.1d">over~ start_ARG italic_p end_ARG</annotation></semantics></math> to distinguish this distribution from the generation probability defined in Eqs.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E3" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">3</span></a>) andÂ (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E10" title="In 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">10</span></a>). For simplicity, we omit the pruned candidate classes <math alttext="t^{\mathrm{candidates}}" class="ltx_Math" display="inline" id="S4.SS4.p2.6.m4.1"><semantics id="S4.SS4.p2.6.m4.1a"><msup id="S4.SS4.p2.6.m4.1.1" xref="S4.SS4.p2.6.m4.1.1.cmml"><mi id="S4.SS4.p2.6.m4.1.1.2" xref="S4.SS4.p2.6.m4.1.1.2.cmml">t</mi><mi id="S4.SS4.p2.6.m4.1.1.3" xref="S4.SS4.p2.6.m4.1.1.3.cmml">candidates</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m4.1b"><apply id="S4.SS4.p2.6.m4.1.1.cmml" xref="S4.SS4.p2.6.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.6.m4.1.1.1.cmml" xref="S4.SS4.p2.6.m4.1.1">superscript</csymbol><ci id="S4.SS4.p2.6.m4.1.1.2.cmml" xref="S4.SS4.p2.6.m4.1.1.2">ğ‘¡</ci><ci id="S4.SS4.p2.6.m4.1.1.3.cmml" xref="S4.SS4.p2.6.m4.1.1.3">candidates</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m4.1c">t^{\mathrm{candidates}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.6.m4.1d">italic_t start_POSTSUPERSCRIPT roman_candidates end_POSTSUPERSCRIPT</annotation></semantics></math> from the LM input in this equation, although they are indeed included in practice, as shown in Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E10" title="In 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">10</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.5">The distribution matching loss is then computed as the Kullback-Leibler (KL) divergence between the retrieved distribution and the LM-supervised distribution:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx14">
<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{KL}\left(\mathrm{StopGradient}\left(\tilde{p}_{\mathrm{LM%
}}\left(\cdot|t^{\mathrm{target}},y^{\mathrm{target}}\right)\right)\|p_{\phi}(%
\cdot|t^{\mathrm{target}})\right)" class="ltx_math_unparsed" display="inline" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1b"><mi id="S4.E14.m1.1.1">KL</mi><mrow id="S4.E14.m1.1.2"><mo id="S4.E14.m1.1.2.1">(</mo><mi id="S4.E14.m1.1.2.2">StopGradient</mi><mrow id="S4.E14.m1.1.2.3"><mo id="S4.E14.m1.1.2.3.1">(</mo><msub id="S4.E14.m1.1.2.3.2"><mover accent="true" id="S4.E14.m1.1.2.3.2.2"><mi id="S4.E14.m1.1.2.3.2.2.2">p</mi><mo id="S4.E14.m1.1.2.3.2.2.1">~</mo></mover><mi id="S4.E14.m1.1.2.3.2.3">LM</mi></msub><mrow id="S4.E14.m1.1.2.3.3"><mo id="S4.E14.m1.1.2.3.3.1">(</mo><mo id="S4.E14.m1.1.2.3.3.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="S4.E14.m1.1.2.3.3.3" rspace="0.167em" stretchy="false">|</mo><msup id="S4.E14.m1.1.2.3.3.4"><mi id="S4.E14.m1.1.2.3.3.4.2">t</mi><mi id="S4.E14.m1.1.2.3.3.4.3">target</mi></msup><mo id="S4.E14.m1.1.2.3.3.5">,</mo><msup id="S4.E14.m1.1.2.3.3.6"><mi id="S4.E14.m1.1.2.3.3.6.2">y</mi><mi id="S4.E14.m1.1.2.3.3.6.3">target</mi></msup><mo id="S4.E14.m1.1.2.3.3.7">)</mo></mrow><mo id="S4.E14.m1.1.2.3.4">)</mo></mrow><mo id="S4.E14.m1.1.2.4" lspace="0em" rspace="0.167em">âˆ¥</mo><msub id="S4.E14.m1.1.2.5"><mi id="S4.E14.m1.1.2.5.2">p</mi><mi id="S4.E14.m1.1.2.5.3">Ï•</mi></msub><mrow id="S4.E14.m1.1.2.6"><mo id="S4.E14.m1.1.2.6.1" stretchy="false">(</mo><mo id="S4.E14.m1.1.2.6.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="S4.E14.m1.1.2.6.3" rspace="0.167em" stretchy="false">|</mo><msup id="S4.E14.m1.1.2.6.4"><mi id="S4.E14.m1.1.2.6.4.2">t</mi><mi id="S4.E14.m1.1.2.6.4.3">target</mi></msup><mo id="S4.E14.m1.1.2.6.5" stretchy="false">)</mo></mrow><mo id="S4.E14.m1.1.2.7">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\displaystyle\mathrm{KL}\left(\mathrm{StopGradient}\left(\tilde{p}_{\mathrm{LM%
}}\left(\cdot|t^{\mathrm{target}},y^{\mathrm{target}}\right)\right)\|p_{\phi}(%
\cdot|t^{\mathrm{target}})\right)</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">roman_KL ( roman_StopGradient ( over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT ) ) âˆ¥ italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p3.4">This loss function aims to align the retrieved probability of each prototype text <math alttext="t\in\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><mrow id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">t</mi><mo id="S4.SS4.p3.1.m1.1.1.1" xref="S4.SS4.p3.1.m1.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">ğ’Ÿ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><in id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1.1"></in><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">ğ‘¡</ci><ci id="S4.SS4.p3.1.m1.1.1.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">t\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">italic_t âˆˆ caligraphic_D</annotation></semantics></math> with its importance in facilitating the LMâ€™s generation of the target label text <math alttext="y^{\mathrm{target}}" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><msup id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mi id="S4.SS4.p3.2.m2.1.1.2" xref="S4.SS4.p3.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS4.p3.2.m2.1.1.3" xref="S4.SS4.p3.2.m2.1.1.3.cmml">target</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS4.p3.2.m2.1.1.2.cmml" xref="S4.SS4.p3.2.m2.1.1.2">ğ‘¦</ci><ci id="S4.SS4.p3.2.m2.1.1.3.cmml" xref="S4.SS4.p3.2.m2.1.1.3">target</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">y^{\mathrm{target}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT</annotation></semantics></math> for the target node. The stop gradient operator ensures that the loss only updates the parameters of the semantic retriever <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.1"><semantics id="S4.SS4.p3.3.m3.1a"><mi id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><ci id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.3.m3.1d">italic_Ï•</annotation></semantics></math>, while keeping the LMâ€™s parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS4.p3.4.m4.1"><semantics id="S4.SS4.p3.4.m4.1a"><mi id="S4.SS4.p3.4.m4.1.1" xref="S4.SS4.p3.4.m4.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.4.m4.1b"><ci id="S4.SS4.p3.4.m4.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.4.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.4.m4.1d">italic_Î¸</annotation></semantics></math> frozen.This objective has been used by previous worksÂ <cite class="ltx_cite ltx_citemacro_citep">(Shi etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib43" title="">2023</a>; Izacard etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib26" title="">2023</a>)</cite> without thorough analysis. We provide an in-depth examination of its properties and implications in AppendixÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A2" title="Appendix B Interpretation of the distribution matching loss â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.10">Notably, computing Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E13" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">13</span></a>) requires <math alttext="|\mathcal{D}|" class="ltx_Math" display="inline" id="S4.SS4.p4.1.m1.1"><semantics id="S4.SS4.p4.1.m1.1a"><mrow id="S4.SS4.p4.1.m1.1.2.2" xref="S4.SS4.p4.1.m1.1.2.1.cmml"><mo id="S4.SS4.p4.1.m1.1.2.2.1" stretchy="false" xref="S4.SS4.p4.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml">ğ’Ÿ</mi><mo id="S4.SS4.p4.1.m1.1.2.2.2" stretchy="false" xref="S4.SS4.p4.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><apply id="S4.SS4.p4.1.m1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.1.2.2"><abs id="S4.SS4.p4.1.m1.1.2.1.1.cmml" xref="S4.SS4.p4.1.m1.1.2.2.1"></abs><ci id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">|\mathcal{D}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.1.m1.1d">| caligraphic_D |</annotation></semantics></math> inferences of the backbone LM due to the denominator. However, the LM is fine-tuned only on the NLL loss for the most relevant prototype, <math alttext="\mathop{\arg\max}_{d\in\mathcal{D}}s_{\phi}(d,t^{\textrm{target}})" class="ltx_Math" display="inline" id="S4.SS4.p4.2.m2.2"><semantics id="S4.SS4.p4.2.m2.2a"><mrow id="S4.SS4.p4.2.m2.2.2" xref="S4.SS4.p4.2.m2.2.2.cmml"><msub id="S4.SS4.p4.2.m2.2.2.2" xref="S4.SS4.p4.2.m2.2.2.2.cmml"><mrow id="S4.SS4.p4.2.m2.2.2.2.2" xref="S4.SS4.p4.2.m2.2.2.2.2.cmml"><mi id="S4.SS4.p4.2.m2.2.2.2.2.1" xref="S4.SS4.p4.2.m2.2.2.2.2.1.cmml">arg</mi><mo id="S4.SS4.p4.2.m2.2.2.2.2a" lspace="0.167em" xref="S4.SS4.p4.2.m2.2.2.2.2.cmml">â¡</mo><mi id="S4.SS4.p4.2.m2.2.2.2.2.2" xref="S4.SS4.p4.2.m2.2.2.2.2.2.cmml">max</mi></mrow><mrow id="S4.SS4.p4.2.m2.2.2.2.3" xref="S4.SS4.p4.2.m2.2.2.2.3.cmml"><mi id="S4.SS4.p4.2.m2.2.2.2.3.2" xref="S4.SS4.p4.2.m2.2.2.2.3.2.cmml">d</mi><mo id="S4.SS4.p4.2.m2.2.2.2.3.1" xref="S4.SS4.p4.2.m2.2.2.2.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.2.m2.2.2.2.3.3" xref="S4.SS4.p4.2.m2.2.2.2.3.3.cmml">ğ’Ÿ</mi></mrow></msub><mrow id="S4.SS4.p4.2.m2.2.2.1" xref="S4.SS4.p4.2.m2.2.2.1.cmml"><msub id="S4.SS4.p4.2.m2.2.2.1.3" xref="S4.SS4.p4.2.m2.2.2.1.3.cmml"><mi id="S4.SS4.p4.2.m2.2.2.1.3.2" xref="S4.SS4.p4.2.m2.2.2.1.3.2.cmml">s</mi><mi id="S4.SS4.p4.2.m2.2.2.1.3.3" xref="S4.SS4.p4.2.m2.2.2.1.3.3.cmml">Ï•</mi></msub><mo id="S4.SS4.p4.2.m2.2.2.1.2" xref="S4.SS4.p4.2.m2.2.2.1.2.cmml">â¢</mo><mrow id="S4.SS4.p4.2.m2.2.2.1.1.1" xref="S4.SS4.p4.2.m2.2.2.1.1.2.cmml"><mo id="S4.SS4.p4.2.m2.2.2.1.1.1.2" stretchy="false" xref="S4.SS4.p4.2.m2.2.2.1.1.2.cmml">(</mo><mi id="S4.SS4.p4.2.m2.1.1" xref="S4.SS4.p4.2.m2.1.1.cmml">d</mi><mo id="S4.SS4.p4.2.m2.2.2.1.1.1.3" xref="S4.SS4.p4.2.m2.2.2.1.1.2.cmml">,</mo><msup id="S4.SS4.p4.2.m2.2.2.1.1.1.1" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS4.p4.2.m2.2.2.1.1.1.1.2" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1.2.cmml">t</mi><mtext id="S4.SS4.p4.2.m2.2.2.1.1.1.1.3" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1.3a.cmml">target</mtext></msup><mo id="S4.SS4.p4.2.m2.2.2.1.1.1.4" stretchy="false" xref="S4.SS4.p4.2.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.2.m2.2b"><apply id="S4.SS4.p4.2.m2.2.2.cmml" xref="S4.SS4.p4.2.m2.2.2"><apply id="S4.SS4.p4.2.m2.2.2.2.cmml" xref="S4.SS4.p4.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p4.2.m2.2.2.2.1.cmml" xref="S4.SS4.p4.2.m2.2.2.2">subscript</csymbol><apply id="S4.SS4.p4.2.m2.2.2.2.2.cmml" xref="S4.SS4.p4.2.m2.2.2.2.2"><arg id="S4.SS4.p4.2.m2.2.2.2.2.1.cmml" xref="S4.SS4.p4.2.m2.2.2.2.2.1"></arg><max id="S4.SS4.p4.2.m2.2.2.2.2.2.cmml" xref="S4.SS4.p4.2.m2.2.2.2.2.2"></max></apply><apply id="S4.SS4.p4.2.m2.2.2.2.3.cmml" xref="S4.SS4.p4.2.m2.2.2.2.3"><in id="S4.SS4.p4.2.m2.2.2.2.3.1.cmml" xref="S4.SS4.p4.2.m2.2.2.2.3.1"></in><ci id="S4.SS4.p4.2.m2.2.2.2.3.2.cmml" xref="S4.SS4.p4.2.m2.2.2.2.3.2">ğ‘‘</ci><ci id="S4.SS4.p4.2.m2.2.2.2.3.3.cmml" xref="S4.SS4.p4.2.m2.2.2.2.3.3">ğ’Ÿ</ci></apply></apply><apply id="S4.SS4.p4.2.m2.2.2.1.cmml" xref="S4.SS4.p4.2.m2.2.2.1"><times id="S4.SS4.p4.2.m2.2.2.1.2.cmml" xref="S4.SS4.p4.2.m2.2.2.1.2"></times><apply id="S4.SS4.p4.2.m2.2.2.1.3.cmml" xref="S4.SS4.p4.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.2.m2.2.2.1.3.1.cmml" xref="S4.SS4.p4.2.m2.2.2.1.3">subscript</csymbol><ci id="S4.SS4.p4.2.m2.2.2.1.3.2.cmml" xref="S4.SS4.p4.2.m2.2.2.1.3.2">ğ‘ </ci><ci id="S4.SS4.p4.2.m2.2.2.1.3.3.cmml" xref="S4.SS4.p4.2.m2.2.2.1.3.3">italic-Ï•</ci></apply><interval closure="open" id="S4.SS4.p4.2.m2.2.2.1.1.2.cmml" xref="S4.SS4.p4.2.m2.2.2.1.1.1"><ci id="S4.SS4.p4.2.m2.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1">ğ‘‘</ci><apply id="S4.SS4.p4.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1">superscript</csymbol><ci id="S4.SS4.p4.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1.2">ğ‘¡</ci><ci id="S4.SS4.p4.2.m2.2.2.1.1.1.1.3a.cmml" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1.3"><mtext id="S4.SS4.p4.2.m2.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p4.2.m2.2.2.1.1.1.1.3">target</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.2.m2.2c">\mathop{\arg\max}_{d\in\mathcal{D}}s_{\phi}(d,t^{\textrm{target}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.2.m2.2d">start_BIGOP roman_arg roman_max end_BIGOP start_POSTSUBSCRIPT italic_d âˆˆ caligraphic_D end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_d , italic_t start_POSTSUPERSCRIPT target end_POSTSUPERSCRIPT )</annotation></semantics></math> via Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E11" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">11</span></a>). Consequently, each update step involves <math alttext="|\mathcal{D}|" class="ltx_Math" display="inline" id="S4.SS4.p4.3.m3.1"><semantics id="S4.SS4.p4.3.m3.1a"><mrow id="S4.SS4.p4.3.m3.1.2.2" xref="S4.SS4.p4.3.m3.1.2.1.cmml"><mo id="S4.SS4.p4.3.m3.1.2.2.1" stretchy="false" xref="S4.SS4.p4.3.m3.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.3.m3.1.1" xref="S4.SS4.p4.3.m3.1.1.cmml">ğ’Ÿ</mi><mo id="S4.SS4.p4.3.m3.1.2.2.2" stretchy="false" xref="S4.SS4.p4.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.3.m3.1b"><apply id="S4.SS4.p4.3.m3.1.2.1.cmml" xref="S4.SS4.p4.3.m3.1.2.2"><abs id="S4.SS4.p4.3.m3.1.2.1.1.cmml" xref="S4.SS4.p4.3.m3.1.2.2.1"></abs><ci id="S4.SS4.p4.3.m3.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.3.m3.1c">|\mathcal{D}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.3.m3.1d">| caligraphic_D |</annotation></semantics></math> forward passes but only one backward pass. To further reduce the computational overhead associated with <math alttext="|\mathcal{D}|" class="ltx_Math" display="inline" id="S4.SS4.p4.4.m4.1"><semantics id="S4.SS4.p4.4.m4.1a"><mrow id="S4.SS4.p4.4.m4.1.2.2" xref="S4.SS4.p4.4.m4.1.2.1.cmml"><mo id="S4.SS4.p4.4.m4.1.2.2.1" stretchy="false" xref="S4.SS4.p4.4.m4.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.4.m4.1.1" xref="S4.SS4.p4.4.m4.1.1.cmml">ğ’Ÿ</mi><mo id="S4.SS4.p4.4.m4.1.2.2.2" stretchy="false" xref="S4.SS4.p4.4.m4.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.4.m4.1b"><apply id="S4.SS4.p4.4.m4.1.2.1.cmml" xref="S4.SS4.p4.4.m4.1.2.2"><abs id="S4.SS4.p4.4.m4.1.2.1.1.cmml" xref="S4.SS4.p4.4.m4.1.2.2.1"></abs><ci id="S4.SS4.p4.4.m4.1.1.cmml" xref="S4.SS4.p4.4.m4.1.1">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.4.m4.1c">|\mathcal{D}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.4.m4.1d">| caligraphic_D |</annotation></semantics></math> inferences, we can employ a typical sampling strategy: selecting the top-<math alttext="M" class="ltx_Math" display="inline" id="S4.SS4.p4.5.m5.1"><semantics id="S4.SS4.p4.5.m5.1a"><mi id="S4.SS4.p4.5.m5.1.1" xref="S4.SS4.p4.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.5.m5.1b"><ci id="S4.SS4.p4.5.m5.1.1.cmml" xref="S4.SS4.p4.5.m5.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.5.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.5.m5.1d">italic_M</annotation></semantics></math> batch <math alttext="\mathcal{D}_{M}=\{t:t\in\text{top-M}_{t^{\prime}\in\mathcal{D}}s_{\phi}(t^{%
\prime},t^{\mathrm{target}})\}" class="ltx_Math" display="inline" id="S4.SS4.p4.6.m6.2"><semantics id="S4.SS4.p4.6.m6.2a"><mrow id="S4.SS4.p4.6.m6.2.2" xref="S4.SS4.p4.6.m6.2.2.cmml"><msub id="S4.SS4.p4.6.m6.2.2.3" xref="S4.SS4.p4.6.m6.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.6.m6.2.2.3.2" xref="S4.SS4.p4.6.m6.2.2.3.2.cmml">ğ’Ÿ</mi><mi id="S4.SS4.p4.6.m6.2.2.3.3" xref="S4.SS4.p4.6.m6.2.2.3.3.cmml">M</mi></msub><mo id="S4.SS4.p4.6.m6.2.2.2" xref="S4.SS4.p4.6.m6.2.2.2.cmml">=</mo><mrow id="S4.SS4.p4.6.m6.2.2.1.1" xref="S4.SS4.p4.6.m6.2.2.1.2.cmml"><mo id="S4.SS4.p4.6.m6.2.2.1.1.2" stretchy="false" xref="S4.SS4.p4.6.m6.2.2.1.2.1.cmml">{</mo><mi id="S4.SS4.p4.6.m6.1.1" xref="S4.SS4.p4.6.m6.1.1.cmml">t</mi><mo id="S4.SS4.p4.6.m6.2.2.1.1.3" lspace="0.278em" rspace="0.278em" xref="S4.SS4.p4.6.m6.2.2.1.2.1.cmml">:</mo><mrow id="S4.SS4.p4.6.m6.2.2.1.1.1" xref="S4.SS4.p4.6.m6.2.2.1.1.1.cmml"><mi id="S4.SS4.p4.6.m6.2.2.1.1.1.4" xref="S4.SS4.p4.6.m6.2.2.1.1.1.4.cmml">t</mi><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.3.cmml">âˆˆ</mo><mrow id="S4.SS4.p4.6.m6.2.2.1.1.1.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.cmml"><msub id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.cmml"><mtext id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.2a.cmml">top-M</mtext><mrow id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.cmml"><msup id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.cmml"><mi id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.2.cmml">t</mi><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.3.cmml">â€²</mo></msup><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.1" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.3.cmml">ğ’Ÿ</mi></mrow></msub><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.2.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.3.cmml">â¢</mo><msub id="S4.SS4.p4.6.m6.2.2.1.1.1.2.5" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.cmml"><mi id="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.2.cmml">s</mi><mi id="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.3.cmml">Ï•</mi></msub><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.2.3a" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.3.cmml">â¢</mo><mrow id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.3.cmml"><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.3" stretchy="false" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.3.cmml">(</mo><msup id="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1" xref="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.3.cmml">â€²</mo></msup><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.4" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.3.cmml">,</mo><msup id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.cmml"><mi id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.2" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.2.cmml">t</mi><mi id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.3" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.3.cmml">target</mi></msup><mo id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.5" stretchy="false" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS4.p4.6.m6.2.2.1.1.4" stretchy="false" xref="S4.SS4.p4.6.m6.2.2.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.6.m6.2b"><apply id="S4.SS4.p4.6.m6.2.2.cmml" xref="S4.SS4.p4.6.m6.2.2"><eq id="S4.SS4.p4.6.m6.2.2.2.cmml" xref="S4.SS4.p4.6.m6.2.2.2"></eq><apply id="S4.SS4.p4.6.m6.2.2.3.cmml" xref="S4.SS4.p4.6.m6.2.2.3"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.2.2.3.1.cmml" xref="S4.SS4.p4.6.m6.2.2.3">subscript</csymbol><ci id="S4.SS4.p4.6.m6.2.2.3.2.cmml" xref="S4.SS4.p4.6.m6.2.2.3.2">ğ’Ÿ</ci><ci id="S4.SS4.p4.6.m6.2.2.3.3.cmml" xref="S4.SS4.p4.6.m6.2.2.3.3">ğ‘€</ci></apply><apply id="S4.SS4.p4.6.m6.2.2.1.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1"><csymbol cd="latexml" id="S4.SS4.p4.6.m6.2.2.1.2.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.2">conditional-set</csymbol><ci id="S4.SS4.p4.6.m6.1.1.cmml" xref="S4.SS4.p4.6.m6.1.1">ğ‘¡</ci><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1"><in id="S4.SS4.p4.6.m6.2.2.1.1.1.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.3"></in><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.4.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.4">ğ‘¡</ci><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2"><times id="S4.SS4.p4.6.m6.2.2.1.1.1.2.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.3"></times><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4">subscript</csymbol><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.2a.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.2"><mtext id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.2">top-M</mtext></ci><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3"><in id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.1"></in><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2">superscript</csymbol><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.2">ğ‘¡</ci><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.2.3">â€²</ci></apply><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.4.3.3">ğ’Ÿ</ci></apply></apply><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.5"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.5">subscript</csymbol><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.2">ğ‘ </ci><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.5.3">italic-Ï•</ci></apply><interval closure="open" id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2"><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.1.1.1.1.3">â€²</ci></apply><apply id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.1.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.2.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.2">ğ‘¡</ci><ci id="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.3.cmml" xref="S4.SS4.p4.6.m6.2.2.1.1.1.2.2.2.2.3">target</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.6.m6.2c">\mathcal{D}_{M}=\{t:t\in\text{top-M}_{t^{\prime}\in\mathcal{D}}s_{\phi}(t^{%
\prime},t^{\mathrm{target}})\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.6.m6.2d">caligraphic_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT = { italic_t : italic_t âˆˆ top-M start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_D end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT ) }</annotation></semantics></math>. By replacing <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS4.p4.7.m7.1"><semantics id="S4.SS4.p4.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.7.m7.1.1" xref="S4.SS4.p4.7.m7.1.1.cmml">ğ’Ÿ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.7.m7.1b"><ci id="S4.SS4.p4.7.m7.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1">ğ’Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.7.m7.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.7.m7.1d">caligraphic_D</annotation></semantics></math> with <math alttext="\mathcal{D}_{M}" class="ltx_Math" display="inline" id="S4.SS4.p4.8.m8.1"><semantics id="S4.SS4.p4.8.m8.1a"><msub id="S4.SS4.p4.8.m8.1.1" xref="S4.SS4.p4.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.8.m8.1.1.2" xref="S4.SS4.p4.8.m8.1.1.2.cmml">ğ’Ÿ</mi><mi id="S4.SS4.p4.8.m8.1.1.3" xref="S4.SS4.p4.8.m8.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.8.m8.1b"><apply id="S4.SS4.p4.8.m8.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.8.m8.1.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1">subscript</csymbol><ci id="S4.SS4.p4.8.m8.1.1.2.cmml" xref="S4.SS4.p4.8.m8.1.1.2">ğ’Ÿ</ci><ci id="S4.SS4.p4.8.m8.1.1.3.cmml" xref="S4.SS4.p4.8.m8.1.1.3">ğ‘€</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.8.m8.1c">\mathcal{D}_{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.8.m8.1d">caligraphic_D start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> in Eqs.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E12" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">12</span></a>) andÂ (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E13" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">13</span></a>), we can compute the retrieval probability distribution and the LM-supervised distribution â€œin-batchâ€, effectively reducing the total number of inferences from <math alttext="|\mathcal{D}|" class="ltx_Math" display="inline" id="S4.SS4.p4.9.m9.1"><semantics id="S4.SS4.p4.9.m9.1a"><mrow id="S4.SS4.p4.9.m9.1.2.2" xref="S4.SS4.p4.9.m9.1.2.1.cmml"><mo id="S4.SS4.p4.9.m9.1.2.2.1" stretchy="false" xref="S4.SS4.p4.9.m9.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.9.m9.1.1" xref="S4.SS4.p4.9.m9.1.1.cmml">ğ’Ÿ</mi><mo id="S4.SS4.p4.9.m9.1.2.2.2" stretchy="false" xref="S4.SS4.p4.9.m9.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.9.m9.1b"><apply id="S4.SS4.p4.9.m9.1.2.1.cmml" xref="S4.SS4.p4.9.m9.1.2.2"><abs id="S4.SS4.p4.9.m9.1.2.1.1.cmml" xref="S4.SS4.p4.9.m9.1.2.2.1"></abs><ci id="S4.SS4.p4.9.m9.1.1.cmml" xref="S4.SS4.p4.9.m9.1.1">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.9.m9.1c">|\mathcal{D}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.9.m9.1d">| caligraphic_D |</annotation></semantics></math> to <math alttext="M" class="ltx_Math" display="inline" id="S4.SS4.p4.10.m10.1"><semantics id="S4.SS4.p4.10.m10.1a"><mi id="S4.SS4.p4.10.m10.1.1" xref="S4.SS4.p4.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.10.m10.1b"><ci id="S4.SS4.p4.10.m10.1.1.cmml" xref="S4.SS4.p4.10.m10.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.10.m10.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.10.m10.1d">italic_M</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p5">
<p class="ltx_p" id="S4.SS4.p5.1">AlgorithmÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#alg1" title="Algorithm 1 â€£ 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">1</span></a> outlines a step-by-step process for fine-tuning our entire framework, processing one training node per step. This procedure can be readily extended to mini-batch settings.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.3.1.1">Algorithm 1</span> </span> Training <span class="ltx_text ltx_font_smallcaps" id="alg1.4.2">AugGLMÂ </span></figcaption>
<div class="ltx_listing ltx_listing" id="alg1.5">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg1.l1.1">Given</span>: (1) A graph <math alttext="\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{T})" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4" xref="alg1.l1.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.2.cmml">ğ’¢</mi><mo id="alg1.l1.m1.3.4.1" xref="alg1.l1.m1.3.4.1.cmml">=</mo><mrow id="alg1.l1.m1.3.4.3.2" xref="alg1.l1.m1.3.4.3.1.cmml"><mo id="alg1.l1.m1.3.4.3.2.1" stretchy="false" xref="alg1.l1.m1.3.4.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">ğ’±</mi><mo id="alg1.l1.m1.3.4.3.2.2" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">â„°</mi><mo id="alg1.l1.m1.3.4.3.2.3" xref="alg1.l1.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">ğ’¯</mi><mo id="alg1.l1.m1.3.4.3.2.4" stretchy="false" xref="alg1.l1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.4.cmml" xref="alg1.l1.m1.3.4"><eq id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.1"></eq><ci id="alg1.l1.m1.3.4.2.cmml" xref="alg1.l1.m1.3.4.2">ğ’¢</ci><vector id="alg1.l1.m1.3.4.3.1.cmml" xref="alg1.l1.m1.3.4.3.2"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">ğ’±</ci><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">â„°</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">ğ’¯</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{T})</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">caligraphic_G = ( caligraphic_V , caligraphic_E , caligraphic_T )</annotation></semantics></math> and training labels <math alttext="\mathcal{Y}^{\textrm{train}}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><msup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">ğ’´</mi><mtext id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3a.cmml">train</mtext></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">ğ’´</ci><ci id="alg1.l1.m2.1.1.3a.cmml" xref="alg1.l1.m2.1.1.3"><mtext id="alg1.l1.m2.1.1.3.cmml" mathsize="70%" xref="alg1.l1.m2.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathcal{Y}^{\textrm{train}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">caligraphic_Y start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT</annotation></semantics></math>, (2) initialized backbone LM <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_Î¸</annotation></semantics></math>, (3) initialized semantic encoder <math alttext="\phi" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_Ï•</annotation></semantics></math>, and (4) initialized GNN <math alttext="\psi" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_Ïˆ</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg1.l2.1">Preprocessing</span>: (1) train the GNN <math alttext="\psi" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_Ïˆ</annotation></semantics></math> based on <math alttext="\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{T})" class="ltx_Math" display="inline" id="alg1.l2.m2.3"><semantics id="alg1.l2.m2.3a"><mrow id="alg1.l2.m2.3.4" xref="alg1.l2.m2.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.3.4.2" xref="alg1.l2.m2.3.4.2.cmml">ğ’¢</mi><mo id="alg1.l2.m2.3.4.1" xref="alg1.l2.m2.3.4.1.cmml">=</mo><mrow id="alg1.l2.m2.3.4.3.2" xref="alg1.l2.m2.3.4.3.1.cmml"><mo id="alg1.l2.m2.3.4.3.2.1" stretchy="false" xref="alg1.l2.m2.3.4.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">ğ’±</mi><mo id="alg1.l2.m2.3.4.3.2.2" xref="alg1.l2.m2.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml">â„°</mi><mo id="alg1.l2.m2.3.4.3.2.3" xref="alg1.l2.m2.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.3.3" xref="alg1.l2.m2.3.3.cmml">ğ’¯</mi><mo id="alg1.l2.m2.3.4.3.2.4" stretchy="false" xref="alg1.l2.m2.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.3b"><apply id="alg1.l2.m2.3.4.cmml" xref="alg1.l2.m2.3.4"><eq id="alg1.l2.m2.3.4.1.cmml" xref="alg1.l2.m2.3.4.1"></eq><ci id="alg1.l2.m2.3.4.2.cmml" xref="alg1.l2.m2.3.4.2">ğ’¢</ci><vector id="alg1.l2.m2.3.4.3.1.cmml" xref="alg1.l2.m2.3.4.3.2"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">ğ’±</ci><ci id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2">â„°</ci><ci id="alg1.l2.m2.3.3.cmml" xref="alg1.l2.m2.3.3">ğ’¯</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.3c">\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{T})</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.3d">caligraphic_G = ( caligraphic_V , caligraphic_E , caligraphic_T )</annotation></semantics></math> and <math alttext="\mathcal{Y}^{\textrm{train}}" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><msup id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">ğ’´</mi><mtext id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3a.cmml">train</mtext></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">superscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">ğ’´</ci><ci id="alg1.l2.m3.1.1.3a.cmml" xref="alg1.l2.m3.1.1.3"><mtext id="alg1.l2.m3.1.1.3.cmml" mathsize="70%" xref="alg1.l2.m3.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\mathcal{Y}^{\textrm{train}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">caligraphic_Y start_POSTSUPERSCRIPT train end_POSTSUPERSCRIPT</annotation></semantics></math> till convergence; (2) generate prototypes and their text based on Eqs.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E6" title="In 4.1 Retrieval-Based Aggregation â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">6</span></a>),Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E7" title="In 4.1 Retrieval-Based Aggregation â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">7</span></a>), andÂ (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E8" title="In 4.1 Retrieval-Based Aggregation â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">8</span></a>); (3) generate the pruned label candidates for every node via Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E9" title="In 4.2 Classifier Guidance â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">9</span></a>).

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><span class="ltx_text ltx_font_bold" id="alg1.l3.1">while</span>Â <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_Î¸</annotation></semantics></math> and <math alttext="\phi" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_Ï•</annotation></semantics></math> not convergedÂ <span class="ltx_text ltx_font_bold" id="alg1.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Â Â Â Â Â Sample <math alttext="v_{i}\sim\mathcal{V}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">v</mi><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">âˆ¼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">ğ’±</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="latexml" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">similar-to</csymbol><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">ğ‘£</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">ğ‘–</ci></apply><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">ğ’±</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">v_{i}\sim\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆ¼ caligraphic_V</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>Â Â Â Â Â Retrieve the relevant nodesâ€™ text <math alttext="t^{\mathrm{retri}}_{i}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><msubsup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">t</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">i</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">retri</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">ğ‘¡</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">retri</ci></apply><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">t^{\mathrm{retri}}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_t start_POSTSUPERSCRIPT roman_retri end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of node <math alttext="v_{i}" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">v</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">ğ‘£</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> via PPR retrieval (Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E2" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">2</span></a>)) and/or semantic retrieval (Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E4" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4</span></a>)).

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>Â Â Â Â Â Plug <math alttext="t_{i}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">t</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">ğ‘¡</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="t^{\mathrm{retri}}_{i}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><msubsup id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2.2" xref="alg1.l6.m2.1.1.2.2.cmml">t</mi><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">i</mi><mi id="alg1.l6.m2.1.1.2.3" xref="alg1.l6.m2.1.1.2.3.cmml">retri</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><apply id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.2.1.cmml" xref="alg1.l6.m2.1.1">superscript</csymbol><ci id="alg1.l6.m2.1.1.2.2.cmml" xref="alg1.l6.m2.1.1.2.2">ğ‘¡</ci><ci id="alg1.l6.m2.1.1.2.3.cmml" xref="alg1.l6.m2.1.1.2.3">retri</ci></apply><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">t^{\mathrm{retri}}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_t start_POSTSUPERSCRIPT roman_retri end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="t^{\mathrm{candidates}}_{i}" class="ltx_Math" display="inline" id="alg1.l6.m3.1"><semantics id="alg1.l6.m3.1a"><msubsup id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml"><mi id="alg1.l6.m3.1.1.2.2" xref="alg1.l6.m3.1.1.2.2.cmml">t</mi><mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">i</mi><mi id="alg1.l6.m3.1.1.2.3" xref="alg1.l6.m3.1.1.2.3.cmml">candidates</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1">subscript</csymbol><apply id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.1.1.2.1.cmml" xref="alg1.l6.m3.1.1">superscript</csymbol><ci id="alg1.l6.m3.1.1.2.2.cmml" xref="alg1.l6.m3.1.1.2.2">ğ‘¡</ci><ci id="alg1.l6.m3.1.1.2.3.cmml" xref="alg1.l6.m3.1.1.2.3">candidates</ci></apply><ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">t^{\mathrm{candidates}}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m3.1d">italic_t start_POSTSUPERSCRIPT roman_candidates end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> (from preprocessing (3)) into the template (e.g., FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.F3" title="Figure 3 â€£ 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">3</span></a>), compute the NLL loss by Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E11" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">11</span></a>), and update <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l6.m4.1"><semantics id="alg1.l6.m4.1a"><mi id="alg1.l6.m4.1.1" xref="alg1.l6.m4.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m4.1b"><ci id="alg1.l6.m4.1.1.cmml" xref="alg1.l6.m4.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m4.1d">italic_Î¸</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>Â Â Â Â Â Compute retrieval distribution <math alttext="p_{\phi}(\cdot|t_{i})" class="ltx_math_unparsed" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1b"><msub id="alg1.l7.m1.1.1"><mi id="alg1.l7.m1.1.1.2">p</mi><mi id="alg1.l7.m1.1.1.3">Ï•</mi></msub><mrow id="alg1.l7.m1.1.2"><mo id="alg1.l7.m1.1.2.1" stretchy="false">(</mo><mo id="alg1.l7.m1.1.2.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="alg1.l7.m1.1.2.3" rspace="0.167em" stretchy="false">|</mo><msub id="alg1.l7.m1.1.2.4"><mi id="alg1.l7.m1.1.2.4.2">t</mi><mi id="alg1.l7.m1.1.2.4.3">i</mi></msub><mo id="alg1.l7.m1.1.2.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">p_{\phi}(\cdot|t_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> by Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E12" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">12</span></a>).

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>Â Â Â Â Â Call LM inference <math alttext="|\mathcal{D}|" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.2.2" xref="alg1.l8.m1.1.2.1.cmml"><mo id="alg1.l8.m1.1.2.2.1" stretchy="false" xref="alg1.l8.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">ğ’Ÿ</mi><mo id="alg1.l8.m1.1.2.2.2" stretchy="false" xref="alg1.l8.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2.2"><abs id="alg1.l8.m1.1.2.1.1.cmml" xref="alg1.l8.m1.1.2.2.1"></abs><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">ğ’Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">|\mathcal{D}|</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">| caligraphic_D |</annotation></semantics></math> times to get <math alttext="\{p_{\mathrm{LM}}(y_{i}|t_{i},t)\}_{t\in\mathcal{D}}" class="ltx_Math" display="inline" id="alg1.l8.m2.2"><semantics id="alg1.l8.m2.2a"><msub id="alg1.l8.m2.2.2" xref="alg1.l8.m2.2.2.cmml"><mrow id="alg1.l8.m2.2.2.1.1" xref="alg1.l8.m2.2.2.1.2.cmml"><mo id="alg1.l8.m2.2.2.1.1.2" stretchy="false" xref="alg1.l8.m2.2.2.1.2.cmml">{</mo><mrow id="alg1.l8.m2.2.2.1.1.1" xref="alg1.l8.m2.2.2.1.1.1.cmml"><msub id="alg1.l8.m2.2.2.1.1.1.3" xref="alg1.l8.m2.2.2.1.1.1.3.cmml"><mi id="alg1.l8.m2.2.2.1.1.1.3.2" xref="alg1.l8.m2.2.2.1.1.1.3.2.cmml">p</mi><mi id="alg1.l8.m2.2.2.1.1.1.3.3" xref="alg1.l8.m2.2.2.1.1.1.3.3.cmml">LM</mi></msub><mo id="alg1.l8.m2.2.2.1.1.1.2" xref="alg1.l8.m2.2.2.1.1.1.2.cmml">â¢</mo><mrow id="alg1.l8.m2.2.2.1.1.1.1.1" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.cmml"><mo id="alg1.l8.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m2.2.2.1.1.1.1.1.1" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.cmml"><msub id="alg1.l8.m2.2.2.1.1.1.1.1.1.3" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m2.2.2.1.1.1.1.1.1.3.2" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="alg1.l8.m2.2.2.1.1.1.1.1.1.3.3" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="alg1.l8.m2.2.2.1.1.1.1.1.1.2" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.2.cmml">|</mo><mrow id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.2.cmml"><msub id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">t</mi></mrow></mrow><mo id="alg1.l8.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l8.m2.2.2.1.1.3" stretchy="false" xref="alg1.l8.m2.2.2.1.2.cmml">}</mo></mrow><mrow id="alg1.l8.m2.2.2.3" xref="alg1.l8.m2.2.2.3.cmml"><mi id="alg1.l8.m2.2.2.3.2" xref="alg1.l8.m2.2.2.3.2.cmml">t</mi><mo id="alg1.l8.m2.2.2.3.1" xref="alg1.l8.m2.2.2.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.2.2.3.3" xref="alg1.l8.m2.2.2.3.3.cmml">ğ’Ÿ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.2b"><apply id="alg1.l8.m2.2.2.cmml" xref="alg1.l8.m2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.2.cmml" xref="alg1.l8.m2.2.2">subscript</csymbol><set id="alg1.l8.m2.2.2.1.2.cmml" xref="alg1.l8.m2.2.2.1.1"><apply id="alg1.l8.m2.2.2.1.1.1.cmml" xref="alg1.l8.m2.2.2.1.1.1"><times id="alg1.l8.m2.2.2.1.1.1.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.2"></times><apply id="alg1.l8.m2.2.2.1.1.1.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.1.1.1.3.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m2.2.2.1.1.1.3.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.3.2">ğ‘</ci><ci id="alg1.l8.m2.2.2.1.1.1.3.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.3.3">LM</ci></apply><apply id="alg1.l8.m2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l8.m2.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.2">conditional</csymbol><apply id="alg1.l8.m2.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.3.2">ğ‘¦</ci><ci id="alg1.l8.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.3.3">ğ‘–</ci></apply><list id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1"><apply id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m2.2.2.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">ğ‘¡</ci></list></apply></apply></set><apply id="alg1.l8.m2.2.2.3.cmml" xref="alg1.l8.m2.2.2.3"><in id="alg1.l8.m2.2.2.3.1.cmml" xref="alg1.l8.m2.2.2.3.1"></in><ci id="alg1.l8.m2.2.2.3.2.cmml" xref="alg1.l8.m2.2.2.3.2">ğ‘¡</ci><ci id="alg1.l8.m2.2.2.3.3.cmml" xref="alg1.l8.m2.2.2.3.3">ğ’Ÿ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.2c">\{p_{\mathrm{LM}}(y_{i}|t_{i},t)\}_{t\in\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.2d">{ italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t ) } start_POSTSUBSCRIPT italic_t âˆˆ caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\tilde{p}_{\mathrm{LM}}(\cdot|t_{i},y_{i})" class="ltx_math_unparsed" display="inline" id="alg1.l8.m3.1"><semantics id="alg1.l8.m3.1a"><mrow id="alg1.l8.m3.1b"><msub id="alg1.l8.m3.1.1"><mover accent="true" id="alg1.l8.m3.1.1.2"><mi id="alg1.l8.m3.1.1.2.2">p</mi><mo id="alg1.l8.m3.1.1.2.1">~</mo></mover><mi id="alg1.l8.m3.1.1.3">LM</mi></msub><mrow id="alg1.l8.m3.1.2"><mo id="alg1.l8.m3.1.2.1" stretchy="false">(</mo><mo id="alg1.l8.m3.1.2.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="alg1.l8.m3.1.2.3" rspace="0.167em" stretchy="false">|</mo><msub id="alg1.l8.m3.1.2.4"><mi id="alg1.l8.m3.1.2.4.2">t</mi><mi id="alg1.l8.m3.1.2.4.3">i</mi></msub><mo id="alg1.l8.m3.1.2.5">,</mo><msub id="alg1.l8.m3.1.2.6"><mi id="alg1.l8.m3.1.2.6.2">y</mi><mi id="alg1.l8.m3.1.2.6.3">i</mi></msub><mo id="alg1.l8.m3.1.2.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">\tilde{p}_{\mathrm{LM}}(\cdot|t_{i},y_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m3.1d">over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>Â Â Â Â Â Compute training loss for retriever by Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E14" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">14</span></a>) and update <math alttext="\phi" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_Ï•</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span><span class="ltx_text ltx_font_bold" id="alg1.l10.1">end</span>Â <span class="ltx_text ltx_font_bold" id="alg1.l10.2">while</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Model complexity</h3>
<div class="ltx_para ltx_noindent" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.24">Our model consists of three parameterized modules: (1) a GNN <math alttext="\psi" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">italic_Ïˆ</annotation></semantics></math> for generating prototypes and pruned label candidates, (2) the semantic retriever <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><mi id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><ci id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.m2.1d">italic_Ï•</annotation></semantics></math>, and (3) the backbone LM <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p1.3.m3.1"><semantics id="S4.SS5.p1.3.m3.1a"><mi id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><ci id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.3.m3.1d">italic_Î¸</annotation></semantics></math>. Notably, <math alttext="\psi" class="ltx_Math" display="inline" id="S4.SS5.p1.4.m4.1"><semantics id="S4.SS5.p1.4.m4.1a"><mi id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><ci id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.4.m4.1d">italic_Ïˆ</annotation></semantics></math> and <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.5.m5.1"><semantics id="S4.SS5.p1.5.m5.1a"><mi id="S4.SS5.p1.5.m5.1.1" xref="S4.SS5.p1.5.m5.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.5.m5.1b"><ci id="S4.SS5.p1.5.m5.1.1.cmml" xref="S4.SS5.p1.5.m5.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.5.m5.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.5.m5.1d">italic_Ï•</annotation></semantics></math> are lightweight, with a number of parameters that is only <math alttext="1/30" class="ltx_Math" display="inline" id="S4.SS5.p1.6.m6.1"><semantics id="S4.SS5.p1.6.m6.1a"><mrow id="S4.SS5.p1.6.m6.1.1" xref="S4.SS5.p1.6.m6.1.1.cmml"><mn id="S4.SS5.p1.6.m6.1.1.2" xref="S4.SS5.p1.6.m6.1.1.2.cmml">1</mn><mo id="S4.SS5.p1.6.m6.1.1.1" xref="S4.SS5.p1.6.m6.1.1.1.cmml">/</mo><mn id="S4.SS5.p1.6.m6.1.1.3" xref="S4.SS5.p1.6.m6.1.1.3.cmml">30</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.6.m6.1b"><apply id="S4.SS5.p1.6.m6.1.1.cmml" xref="S4.SS5.p1.6.m6.1.1"><divide id="S4.SS5.p1.6.m6.1.1.1.cmml" xref="S4.SS5.p1.6.m6.1.1.1"></divide><cn id="S4.SS5.p1.6.m6.1.1.2.cmml" type="integer" xref="S4.SS5.p1.6.m6.1.1.2">1</cn><cn id="S4.SS5.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.SS5.p1.6.m6.1.1.3">30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.6.m6.1c">1/30</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.6.m6.1d">1 / 30</annotation></semantics></math> to <math alttext="1/3" class="ltx_Math" display="inline" id="S4.SS5.p1.7.m7.1"><semantics id="S4.SS5.p1.7.m7.1a"><mrow id="S4.SS5.p1.7.m7.1.1" xref="S4.SS5.p1.7.m7.1.1.cmml"><mn id="S4.SS5.p1.7.m7.1.1.2" xref="S4.SS5.p1.7.m7.1.1.2.cmml">1</mn><mo id="S4.SS5.p1.7.m7.1.1.1" xref="S4.SS5.p1.7.m7.1.1.1.cmml">/</mo><mn id="S4.SS5.p1.7.m7.1.1.3" xref="S4.SS5.p1.7.m7.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.7.m7.1b"><apply id="S4.SS5.p1.7.m7.1.1.cmml" xref="S4.SS5.p1.7.m7.1.1"><divide id="S4.SS5.p1.7.m7.1.1.1.cmml" xref="S4.SS5.p1.7.m7.1.1.1"></divide><cn id="S4.SS5.p1.7.m7.1.1.2.cmml" type="integer" xref="S4.SS5.p1.7.m7.1.1.2">1</cn><cn id="S4.SS5.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.SS5.p1.7.m7.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.7.m7.1c">1/3</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.7.m7.1d">1 / 3</annotation></semantics></math> of the number of parameters of LM <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p1.8.m8.1"><semantics id="S4.SS5.p1.8.m8.1a"><mi id="S4.SS5.p1.8.m8.1.1" xref="S4.SS5.p1.8.m8.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.8.m8.1b"><ci id="S4.SS5.p1.8.m8.1.1.cmml" xref="S4.SS5.p1.8.m8.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.8.m8.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.8.m8.1d">italic_Î¸</annotation></semantics></math>. Compared to the state-of-the-art InstructGLM, our model has an additional module <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.9.m9.1"><semantics id="S4.SS5.p1.9.m9.1a"><mi id="S4.SS5.p1.9.m9.1.1" xref="S4.SS5.p1.9.m9.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.9.m9.1b"><ci id="S4.SS5.p1.9.m9.1.1.cmml" xref="S4.SS5.p1.9.m9.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.9.m9.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.9.m9.1d">italic_Ï•</annotation></semantics></math>, resulting in slightly more parameters which is relatively minor. During training, the GNN <math alttext="\psi" class="ltx_Math" display="inline" id="S4.SS5.p1.10.m10.1"><semantics id="S4.SS5.p1.10.m10.1a"><mi id="S4.SS5.p1.10.m10.1.1" xref="S4.SS5.p1.10.m10.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.10.m10.1b"><ci id="S4.SS5.p1.10.m10.1.1.cmml" xref="S4.SS5.p1.10.m10.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.10.m10.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.10.m10.1d">italic_Ïˆ</annotation></semantics></math> can be trained independently, and the PPR scores can be precomputed. The training of <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p1.11.m11.1"><semantics id="S4.SS5.p1.11.m11.1a"><mi id="S4.SS5.p1.11.m11.1.1" xref="S4.SS5.p1.11.m11.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.11.m11.1b"><ci id="S4.SS5.p1.11.m11.1.1.cmml" xref="S4.SS5.p1.11.m11.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.11.m11.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.11.m11.1d">italic_Î¸</annotation></semantics></math> relies on the retrieved text from <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.12.m12.1"><semantics id="S4.SS5.p1.12.m12.1a"><mi id="S4.SS5.p1.12.m12.1.1" xref="S4.SS5.p1.12.m12.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.12.m12.1b"><ci id="S4.SS5.p1.12.m12.1.1.cmml" xref="S4.SS5.p1.12.m12.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.12.m12.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.12.m12.1d">italic_Ï•</annotation></semantics></math>, while the training of <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.13.m13.1"><semantics id="S4.SS5.p1.13.m13.1a"><mi id="S4.SS5.p1.13.m13.1.1" xref="S4.SS5.p1.13.m13.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.13.m13.1b"><ci id="S4.SS5.p1.13.m13.1.1.cmml" xref="S4.SS5.p1.13.m13.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.13.m13.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.13.m13.1d">italic_Ï•</annotation></semantics></math> requires <math alttext="\tilde{p}_{\mathrm{LM}}(\cdot|t^{\mathrm{target}},y^{\mathrm{target}})" class="ltx_math_unparsed" display="inline" id="S4.SS5.p1.14.m14.1"><semantics id="S4.SS5.p1.14.m14.1a"><mrow id="S4.SS5.p1.14.m14.1b"><msub id="S4.SS5.p1.14.m14.1.1"><mover accent="true" id="S4.SS5.p1.14.m14.1.1.2"><mi id="S4.SS5.p1.14.m14.1.1.2.2">p</mi><mo id="S4.SS5.p1.14.m14.1.1.2.1">~</mo></mover><mi id="S4.SS5.p1.14.m14.1.1.3">LM</mi></msub><mrow id="S4.SS5.p1.14.m14.1.2"><mo id="S4.SS5.p1.14.m14.1.2.1" stretchy="false">(</mo><mo id="S4.SS5.p1.14.m14.1.2.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="S4.SS5.p1.14.m14.1.2.3" rspace="0.167em" stretchy="false">|</mo><msup id="S4.SS5.p1.14.m14.1.2.4"><mi id="S4.SS5.p1.14.m14.1.2.4.2">t</mi><mi id="S4.SS5.p1.14.m14.1.2.4.3">target</mi></msup><mo id="S4.SS5.p1.14.m14.1.2.5">,</mo><msup id="S4.SS5.p1.14.m14.1.2.6"><mi id="S4.SS5.p1.14.m14.1.2.6.2">y</mi><mi id="S4.SS5.p1.14.m14.1.2.6.3">target</mi></msup><mo id="S4.SS5.p1.14.m14.1.2.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS5.p1.14.m14.1c">\tilde{p}_{\mathrm{LM}}(\cdot|t^{\mathrm{target}},y^{\mathrm{target}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.14.m14.1d">over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT )</annotation></semantics></math>, which is obtained through forward inference of <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p1.15.m15.1"><semantics id="S4.SS5.p1.15.m15.1a"><mi id="S4.SS5.p1.15.m15.1.1" xref="S4.SS5.p1.15.m15.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.15.m15.1b"><ci id="S4.SS5.p1.15.m15.1.1.cmml" xref="S4.SS5.p1.15.m15.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.15.m15.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.15.m15.1d">italic_Î¸</annotation></semantics></math>. Importantly, their computational graphs (used for gradient computation) are independent. This is because the LM <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p1.16.m16.1"><semantics id="S4.SS5.p1.16.m16.1a"><mi id="S4.SS5.p1.16.m16.1.1" xref="S4.SS5.p1.16.m16.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.16.m16.1b"><ci id="S4.SS5.p1.16.m16.1.1.cmml" xref="S4.SS5.p1.16.m16.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.16.m16.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.16.m16.1d">italic_Î¸</annotation></semantics></math> concatenates the retrieved text from <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.17.m17.1"><semantics id="S4.SS5.p1.17.m17.1a"><mi id="S4.SS5.p1.17.m17.1.1" xref="S4.SS5.p1.17.m17.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.17.m17.1b"><ci id="S4.SS5.p1.17.m17.1.1.cmml" xref="S4.SS5.p1.17.m17.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.17.m17.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.17.m17.1d">italic_Ï•</annotation></semantics></math> into its input, which is not differentiable with respect to <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.18.m18.1"><semantics id="S4.SS5.p1.18.m18.1a"><mi id="S4.SS5.p1.18.m18.1.1" xref="S4.SS5.p1.18.m18.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.18.m18.1b"><ci id="S4.SS5.p1.18.m18.1.1.cmml" xref="S4.SS5.p1.18.m18.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.18.m18.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.18.m18.1d">italic_Ï•</annotation></semantics></math>. Furthermore, when training <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.19.m19.1"><semantics id="S4.SS5.p1.19.m19.1a"><mi id="S4.SS5.p1.19.m19.1.1" xref="S4.SS5.p1.19.m19.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.19.m19.1b"><ci id="S4.SS5.p1.19.m19.1.1.cmml" xref="S4.SS5.p1.19.m19.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.19.m19.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.19.m19.1d">italic_Ï•</annotation></semantics></math>, the loss in Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.E14" title="In 4.4 Training â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">14</span></a>) involves <math alttext="\tilde{p}_{\mathrm{LM}}(\cdot|t^{\mathrm{target}},y^{\mathrm{target}})" class="ltx_math_unparsed" display="inline" id="S4.SS5.p1.20.m20.1"><semantics id="S4.SS5.p1.20.m20.1a"><mrow id="S4.SS5.p1.20.m20.1b"><msub id="S4.SS5.p1.20.m20.1.1"><mover accent="true" id="S4.SS5.p1.20.m20.1.1.2"><mi id="S4.SS5.p1.20.m20.1.1.2.2">p</mi><mo id="S4.SS5.p1.20.m20.1.1.2.1">~</mo></mover><mi id="S4.SS5.p1.20.m20.1.1.3">LM</mi></msub><mrow id="S4.SS5.p1.20.m20.1.2"><mo id="S4.SS5.p1.20.m20.1.2.1" stretchy="false">(</mo><mo id="S4.SS5.p1.20.m20.1.2.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="S4.SS5.p1.20.m20.1.2.3" rspace="0.167em" stretchy="false">|</mo><msup id="S4.SS5.p1.20.m20.1.2.4"><mi id="S4.SS5.p1.20.m20.1.2.4.2">t</mi><mi id="S4.SS5.p1.20.m20.1.2.4.3">target</mi></msup><mo id="S4.SS5.p1.20.m20.1.2.5">,</mo><msup id="S4.SS5.p1.20.m20.1.2.6"><mi id="S4.SS5.p1.20.m20.1.2.6.2">y</mi><mi id="S4.SS5.p1.20.m20.1.2.6.3">target</mi></msup><mo id="S4.SS5.p1.20.m20.1.2.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS5.p1.20.m20.1c">\tilde{p}_{\mathrm{LM}}(\cdot|t^{\mathrm{target}},y^{\mathrm{target}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.20.m20.1d">over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT roman_target end_POSTSUPERSCRIPT )</annotation></semantics></math> wrapped with the <math alttext="\mathrm{StopGradient}" class="ltx_Math" display="inline" id="S4.SS5.p1.21.m21.1"><semantics id="S4.SS5.p1.21.m21.1a"><mi id="S4.SS5.p1.21.m21.1.1" xref="S4.SS5.p1.21.m21.1.1.cmml">StopGradient</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.21.m21.1b"><ci id="S4.SS5.p1.21.m21.1.1.cmml" xref="S4.SS5.p1.21.m21.1.1">StopGradient</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.21.m21.1c">\mathrm{StopGradient}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.21.m21.1d">roman_StopGradient</annotation></semantics></math> operator, ensuring that the gradient computation does not update <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p1.22.m22.1"><semantics id="S4.SS5.p1.22.m22.1a"><mi id="S4.SS5.p1.22.m22.1.1" xref="S4.SS5.p1.22.m22.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.22.m22.1b"><ci id="S4.SS5.p1.22.m22.1.1.cmml" xref="S4.SS5.p1.22.m22.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.22.m22.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.22.m22.1d">italic_Î¸</annotation></semantics></math>. As a result, the cost of back-propagation is similar to updating the LM <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS5.p1.23.m23.1"><semantics id="S4.SS5.p1.23.m23.1a"><mi id="S4.SS5.p1.23.m23.1.1" xref="S4.SS5.p1.23.m23.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.23.m23.1b"><ci id="S4.SS5.p1.23.m23.1.1.cmml" xref="S4.SS5.p1.23.m23.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.23.m23.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.23.m23.1d">italic_Î¸</annotation></semantics></math> and the semantic encoder <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS5.p1.24.m24.1"><semantics id="S4.SS5.p1.24.m24.1a"><mi id="S4.SS5.p1.24.m24.1.1" xref="S4.SS5.p1.24.m24.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.24.m24.1b"><ci id="S4.SS5.p1.24.m24.1.1.cmml" xref="S4.SS5.p1.24.m24.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.24.m24.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.24.m24.1d">italic_Ï•</annotation></semantics></math> separately.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Setup and Implementation</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Following <cite class="ltx_cite ltx_citemacro_citep">(He etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib23" title="">2024</a>; Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>)</cite>, we evaluate our approach on four benchmark datasets: CoraÂ <cite class="ltx_cite ltx_citemacro_citep">(Sen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib42" title="">2008</a>)</cite>, PubmedÂ <cite class="ltx_cite ltx_citemacro_citep">(Sen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib42" title="">2008</a>)</cite>, ogbn-arxivÂ <cite class="ltx_cite ltx_citemacro_citep">(Hu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib24" title="">2020</a>)</cite>, and a subset of ogbn-productsÂ <cite class="ltx_cite ltx_citemacro_citep">(Hu etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib24" title="">2020</a>; He etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib23" title="">2024</a>)</cite>. The statistics of the dataset are summarized in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.T1" title="Table 1 â€£ 5.1 Setup and Implementation â€£ 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.12">Our implementation employs two pretrained all-MiniLM-L6-v2 modelsÂ <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2" title="">https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2</a></span></span></span> as the dual encoder for the semantic retriever <math alttext="\phi" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">italic_Ï•</annotation></semantics></math> (Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S3.E5" title="In 3 Preliminaries â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">5</span></a>)) and the text encoder for GNN <math alttext="\psi" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.1"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.2.m2.1d">italic_Ïˆ</annotation></semantics></math> (Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A1.E15" title="In Appendix A Architecture and Training of the Graph Neural Network ğœ“ â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">15</span></a>)), respectively. We set the teleport probability of the PPR to <math alttext="\alpha=0.1" class="ltx_Math" display="inline" id="S5.SS1.p2.3.m3.1"><semantics id="S5.SS1.p2.3.m3.1a"><mrow id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">Î±</mi><mo id="S5.SS1.p2.3.m3.1.1.1" xref="S5.SS1.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><eq id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1.1"></eq><ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">ğ›¼</ci><cn id="S5.SS1.p2.3.m3.1.1.3.cmml" type="float" xref="S5.SS1.p2.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\alpha=0.1</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.3.m3.1d">italic_Î± = 0.1</annotation></semantics></math>. For the GNN, we employ a <math alttext="3" class="ltx_Math" display="inline" id="S5.SS1.p2.4.m4.1"><semantics id="S5.SS1.p2.4.m4.1a"><mn id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><cn id="S5.SS1.p2.4.m4.1.1.cmml" type="integer" xref="S5.SS1.p2.4.m4.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">3</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.4.m4.1d">3</annotation></semantics></math>-layer GraphSAGEÂ <cite class="ltx_cite ltx_citemacro_citep">(Hamilton etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib19" title="">2017</a>)</cite> architecture with a hidden dimension of <math alttext="256" class="ltx_Math" display="inline" id="S5.SS1.p2.5.m5.1"><semantics id="S5.SS1.p2.5.m5.1a"><mn id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><cn id="S5.SS1.p2.5.m5.1.1.cmml" type="integer" xref="S5.SS1.p2.5.m5.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">256</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.5.m5.1d">256</annotation></semantics></math> as <math alttext="\psi" class="ltx_Math" display="inline" id="S5.SS1.p2.6.m6.1"><semantics id="S5.SS1.p2.6.m6.1a"><mi id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><ci id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.6.m6.1d">italic_Ïˆ</annotation></semantics></math>. Our hyperparameter settings include <math alttext="K=5" class="ltx_Math" display="inline" id="S5.SS1.p2.7.m7.1"><semantics id="S5.SS1.p2.7.m7.1a"><mrow id="S5.SS1.p2.7.m7.1.1" xref="S5.SS1.p2.7.m7.1.1.cmml"><mi id="S5.SS1.p2.7.m7.1.1.2" xref="S5.SS1.p2.7.m7.1.1.2.cmml">K</mi><mo id="S5.SS1.p2.7.m7.1.1.1" xref="S5.SS1.p2.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.7.m7.1.1.3" xref="S5.SS1.p2.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m7.1b"><apply id="S5.SS1.p2.7.m7.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1"><eq id="S5.SS1.p2.7.m7.1.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1"></eq><ci id="S5.SS1.p2.7.m7.1.1.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2">ğ¾</ci><cn id="S5.SS1.p2.7.m7.1.1.3.cmml" type="integer" xref="S5.SS1.p2.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.7.m7.1c">K=5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.7.m7.1d">italic_K = 5</annotation></semantics></math> PPR neighbors, <math alttext="N=10" class="ltx_Math" display="inline" id="S5.SS1.p2.8.m8.1"><semantics id="S5.SS1.p2.8.m8.1a"><mrow id="S5.SS1.p2.8.m8.1.1" xref="S5.SS1.p2.8.m8.1.1.cmml"><mi id="S5.SS1.p2.8.m8.1.1.2" xref="S5.SS1.p2.8.m8.1.1.2.cmml">N</mi><mo id="S5.SS1.p2.8.m8.1.1.1" xref="S5.SS1.p2.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.8.m8.1.1.3" xref="S5.SS1.p2.8.m8.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.8.m8.1b"><apply id="S5.SS1.p2.8.m8.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1"><eq id="S5.SS1.p2.8.m8.1.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1.1"></eq><ci id="S5.SS1.p2.8.m8.1.1.2.cmml" xref="S5.SS1.p2.8.m8.1.1.2">ğ‘</ci><cn id="S5.SS1.p2.8.m8.1.1.3.cmml" type="integer" xref="S5.SS1.p2.8.m8.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.8.m8.1c">N=10</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.8.m8.1d">italic_N = 10</annotation></semantics></math> prototypes, and <math alttext="M=8" class="ltx_Math" display="inline" id="S5.SS1.p2.9.m9.1"><semantics id="S5.SS1.p2.9.m9.1a"><mrow id="S5.SS1.p2.9.m9.1.1" xref="S5.SS1.p2.9.m9.1.1.cmml"><mi id="S5.SS1.p2.9.m9.1.1.2" xref="S5.SS1.p2.9.m9.1.1.2.cmml">M</mi><mo id="S5.SS1.p2.9.m9.1.1.1" xref="S5.SS1.p2.9.m9.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.9.m9.1.1.3" xref="S5.SS1.p2.9.m9.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.9.m9.1b"><apply id="S5.SS1.p2.9.m9.1.1.cmml" xref="S5.SS1.p2.9.m9.1.1"><eq id="S5.SS1.p2.9.m9.1.1.1.cmml" xref="S5.SS1.p2.9.m9.1.1.1"></eq><ci id="S5.SS1.p2.9.m9.1.1.2.cmml" xref="S5.SS1.p2.9.m9.1.1.2">ğ‘€</ci><cn id="S5.SS1.p2.9.m9.1.1.3.cmml" type="integer" xref="S5.SS1.p2.9.m9.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.9.m9.1c">M=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.9.m9.1d">italic_M = 8</annotation></semantics></math> samples for LM inference. We choose the number of label candidates <math alttext="I" class="ltx_Math" display="inline" id="S5.SS1.p2.10.m10.1"><semantics id="S5.SS1.p2.10.m10.1a"><mi id="S5.SS1.p2.10.m10.1.1" xref="S5.SS1.p2.10.m10.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.10.m10.1b"><ci id="S5.SS1.p2.10.m10.1.1.cmml" xref="S5.SS1.p2.10.m10.1.1">ğ¼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.10.m10.1c">I</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.10.m10.1d">italic_I</annotation></semantics></math>, from <math alttext="\{2,3\}" class="ltx_Math" display="inline" id="S5.SS1.p2.11.m11.2"><semantics id="S5.SS1.p2.11.m11.2a"><mrow id="S5.SS1.p2.11.m11.2.3.2" xref="S5.SS1.p2.11.m11.2.3.1.cmml"><mo id="S5.SS1.p2.11.m11.2.3.2.1" stretchy="false" xref="S5.SS1.p2.11.m11.2.3.1.cmml">{</mo><mn id="S5.SS1.p2.11.m11.1.1" xref="S5.SS1.p2.11.m11.1.1.cmml">2</mn><mo id="S5.SS1.p2.11.m11.2.3.2.2" xref="S5.SS1.p2.11.m11.2.3.1.cmml">,</mo><mn id="S5.SS1.p2.11.m11.2.2" xref="S5.SS1.p2.11.m11.2.2.cmml">3</mn><mo id="S5.SS1.p2.11.m11.2.3.2.3" stretchy="false" xref="S5.SS1.p2.11.m11.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.11.m11.2b"><set id="S5.SS1.p2.11.m11.2.3.1.cmml" xref="S5.SS1.p2.11.m11.2.3.2"><cn id="S5.SS1.p2.11.m11.1.1.cmml" type="integer" xref="S5.SS1.p2.11.m11.1.1">2</cn><cn id="S5.SS1.p2.11.m11.2.2.cmml" type="integer" xref="S5.SS1.p2.11.m11.2.2">3</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.11.m11.2c">\{2,3\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.11.m11.2d">{ 2 , 3 }</annotation></semantics></math>. The backbone LM <math alttext="\theta" class="ltx_Math" display="inline" id="S5.SS1.p2.12.m12.1"><semantics id="S5.SS1.p2.12.m12.1a"><mi id="S5.SS1.p2.12.m12.1.1" xref="S5.SS1.p2.12.m12.1.1.cmml">Î¸</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.12.m12.1b"><ci id="S5.SS1.p2.12.m12.1.1.cmml" xref="S5.SS1.p2.12.m12.1.1">ğœƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.12.m12.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.12.m12.1d">italic_Î¸</annotation></semantics></math> is implemented using Flan-T5-small/base/largeÂ <cite class="ltx_cite ltx_citemacro_citep">(Chung etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib12" title="">2022</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/docs/transformers/en/model_doc/flan-t5" title="">https://huggingface.co/docs/transformers/en/model_doc/flan-t5</a></span></span></span>, whose parameters are instruction-fine-tuned using the templates shown in FigureÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S4.F3" title="Figure 3 â€£ 4.3 Overall template â€£ 4 Method â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">3</span></a> and SectionÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A3" title="Appendix C Templates â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Dataset statistics.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1">Name</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.2"># nodes</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.3"># edges</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.4"># classes</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.5">Split</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.6">Metric</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.2.1.1">Cora</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.2.1.2">2,708</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.2.1.3">10,556</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.2.1.4">7</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.2.1.5">Random 60/20/20%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.2.1.6">Accuracy</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.2">
<td class="ltx_td ltx_align_left" id="S5.T1.1.3.2.1">Pubmed</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.3.2.2">19,717</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.3.2.3">88,648</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.3.2.4">3</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.3.2.5">Random 60/20/20%</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.3.2.6">Accuracy</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.3">
<td class="ltx_td ltx_align_left" id="S5.T1.1.4.3.1">ogbn-arxiv</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.4.3.2">169,343</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.4.3.3">1,166,243</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.4.3.4">40</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.4.3.5">Given split</td>
<td class="ltx_td ltx_align_left" id="S5.T1.1.4.3.6">Accuracy</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.5.4.1">ogbn-products</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.5.4.2">54,025</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.5.4.3">198,663</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.5.4.4">47</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.5.4.5">Given split</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.5.4.6">Accuracy</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Comparison with state-of-the-art</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">This section presents the comparison between <span class="ltx_text ltx_font_smallcaps" id="S5.SS2.p1.1.1">AugGLMÂ </span>and the state-of-the-art baselines.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">We categorize models into two groups: (1) vector-output models which output a vector with dimension equal to the number of classes, and (2) text-output models, which generate text as their output. Specifically, we report results from GCNÂ <cite class="ltx_cite ltx_citemacro_citep">(Kipf &amp; Welling, <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib29" title="">2017</a>)</cite>, BernNetÂ <cite class="ltx_cite ltx_citemacro_citep">(He etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib21" title="">2021a</a>)</cite>, FAGCNÂ <cite class="ltx_cite ltx_citemacro_citep">(Bo etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib4" title="">2021</a>)</cite>, GCNIIÂ <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib9" title="">2020</a>)</cite>, ACM-GCNÂ <cite class="ltx_cite ltx_citemacro_citep">(Luan etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib36" title="">2022</a>)</cite>, and GLEMÂ <cite class="ltx_cite ltx_citemacro_citep">(Zhao etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib56" title="">2023a</a>)</cite>+RevGAT from the leaderboards<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://paperswithcode.com/sota/node-classification-on-cora-60-20-20-random" title="">https://paperswithcode.com/sota/node-classification-on-cora-60-20-20-random</a></span></span></span><span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://paperswithcode.com/sota/node-classification-on-pubmed-60-20-20-random" title="">https://paperswithcode.com/sota/node-classification-on-pubmed-60-20-20-random</a></span></span></span><span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ogb.stanford.edu/docs/leader_nodeprop/" title="">https://ogb.stanford.edu/docs/leader_nodeprop/</a></span></span></span> and their published papers. The results for TAPE+RevGAT, GIANTÂ <cite class="ltx_cite ltx_citemacro_citep">(Chien etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib11" title="">2022</a>)</cite>+RevGATÂ <cite class="ltx_cite ltx_citemacro_citep">(Li etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib33" title="">2021</a>)</cite>, GIANT+GCN, DeBERTaÂ <cite class="ltx_cite ltx_citemacro_citep">(He etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib22" title="">2021b</a>)</cite>, and ChatGPT3.5 are reported from Â <cite class="ltx_cite ltx_citemacro_citep">(He etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib23" title="">2024</a>)</cite>. The results of InstructGLM are reported from Â <cite class="ltx_cite ltx_citemacro_citep">(Ye etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib51" title="">2023</a>)</cite>. Note that all models, except ChatGPT-3.5, are fine-tuned on the training set. We report mean and standard deviation over five runs. For text-output models, we evaluate accuracy by checking whether the modelâ€™s generated text matches the ground truth label text exactly.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance comparison (accuracy) between <span class="ltx_text ltx_font_smallcaps" id="S5.T2.60.1">AugGLMÂ </span>and state-of-the-art models. The best-performing vector-output and text-output models are highlighted in <span class="ltx_text ltx_font_bold" id="S5.T2.61.2" style="color:#0000FF;">blue</span> and <span class="ltx_text ltx_font_bold" id="S5.T2.62.3" style="color:#FF0000;">red</span>, respectively.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.56">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.56.57.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T2.56.57.1.1"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.56.57.1.2">Method</th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.56.57.1.3">Cora</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.56.57.1.4">Pubmed</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.56.57.1.5">ogbn-arxiv</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.56.57.1.6">ogbn-products</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.4.4.5" rowspan="10"><span class="ltx_text" id="S5.T2.4.4.5.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T2.4.4.5.1.1" style="width:8.8pt;height:61.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:61.1pt;transform:translate(-26.18pt,-25.21pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T2.4.4.5.1.1.1">Vector-output</span>
</span></span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.4.4.6">GCN</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.1.1">87.78<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.1.1.1.m1.1"><semantics id="S5.T2.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.m1.1d">Â±</annotation></semantics></math>0.96</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.2.2">88.90<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.2.2.2.m1.1"><semantics id="S5.T2.2.2.2.m1.1a"><mo id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.m1.1d">Â±</annotation></semantics></math>0.32</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.3.3.3">73.60<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.3.3.3.m1.1"><semantics id="S5.T2.3.3.3.m1.1a"><mo id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.3.3.m1.1d">Â±</annotation></semantics></math>0.18</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.4.4.4">75.64<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.4.4.4.m1.1"><semantics id="S5.T2.4.4.4.m1.1a"><mo id="S5.T2.4.4.4.m1.1.1" xref="S5.T2.4.4.4.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.4.4.m1.1d">Â±</annotation></semantics></math>0.21</td>
</tr>
<tr class="ltx_tr" id="S5.T2.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.8.8.5">BernNet</th>
<td class="ltx_td ltx_align_left" id="S5.T2.5.5.1">88.52<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.5.5.1.m1.1"><semantics id="S5.T2.5.5.1.m1.1a"><mo id="S5.T2.5.5.1.m1.1.1" xref="S5.T2.5.5.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.1.m1.1b"><csymbol cd="latexml" id="S5.T2.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.5.1.m1.1d">Â±</annotation></semantics></math>0.95</td>
<td class="ltx_td ltx_align_left" id="S5.T2.6.6.2">88.48<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.6.6.2.m1.1"><semantics id="S5.T2.6.6.2.m1.1a"><mo id="S5.T2.6.6.2.m1.1.1" xref="S5.T2.6.6.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.2.m1.1b"><csymbol cd="latexml" id="S5.T2.6.6.2.m1.1.1.cmml" xref="S5.T2.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.6.2.m1.1d">Â±</annotation></semantics></math>0.41</td>
<td class="ltx_td ltx_align_left" id="S5.T2.7.7.3"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.7.7.3.m1.1"><semantics id="S5.T2.7.7.3.m1.1a"><mo id="S5.T2.7.7.3.m1.1.1" xref="S5.T2.7.7.3.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.3.m1.1b"><minus id="S5.T2.7.7.3.m1.1.1.cmml" xref="S5.T2.7.7.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.3.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.7.3.m1.1d">-</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.8.8.4"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.8.8.4.m1.1"><semantics id="S5.T2.8.8.4.m1.1a"><mo id="S5.T2.8.8.4.m1.1.1" xref="S5.T2.8.8.4.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.4.m1.1b"><minus id="S5.T2.8.8.4.m1.1.1.cmml" xref="S5.T2.8.8.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.4.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.8.4.m1.1d">-</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.12.12.5">FAGCN</th>
<td class="ltx_td ltx_align_left" id="S5.T2.9.9.1">88.85<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.9.9.1.m1.1"><semantics id="S5.T2.9.9.1.m1.1a"><mo id="S5.T2.9.9.1.m1.1.1" xref="S5.T2.9.9.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.9.9.1.m1.1d">Â±</annotation></semantics></math>1.36</td>
<td class="ltx_td ltx_align_left" id="S5.T2.10.10.2">89.98<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.10.10.2.m1.1"><semantics id="S5.T2.10.10.2.m1.1a"><mo id="S5.T2.10.10.2.m1.1.1" xref="S5.T2.10.10.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T2.10.10.2.m1.1.1.cmml" xref="S5.T2.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.10.10.2.m1.1d">Â±</annotation></semantics></math>0.52</td>
<td class="ltx_td ltx_align_left" id="S5.T2.11.11.3"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.11.11.3.m1.1"><semantics id="S5.T2.11.11.3.m1.1a"><mo id="S5.T2.11.11.3.m1.1.1" xref="S5.T2.11.11.3.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.3.m1.1b"><minus id="S5.T2.11.11.3.m1.1.1.cmml" xref="S5.T2.11.11.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.3.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.11.11.3.m1.1d">-</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.12.12.4"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.12.12.4.m1.1"><semantics id="S5.T2.12.12.4.m1.1a"><mo id="S5.T2.12.12.4.m1.1.1" xref="S5.T2.12.12.4.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.4.m1.1b"><minus id="S5.T2.12.12.4.m1.1.1.cmml" xref="S5.T2.12.12.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.4.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.12.12.4.m1.1d">-</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.16.16.5">GCNII</th>
<td class="ltx_td ltx_align_left" id="S5.T2.13.13.1">88.98<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.13.13.1.m1.1"><semantics id="S5.T2.13.13.1.m1.1a"><mo id="S5.T2.13.13.1.m1.1.1" xref="S5.T2.13.13.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T2.13.13.1.m1.1.1.cmml" xref="S5.T2.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.13.13.1.m1.1d">Â±</annotation></semantics></math>1.33</td>
<td class="ltx_td ltx_align_left" id="S5.T2.14.14.2">89.80<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.14.14.2.m1.1"><semantics id="S5.T2.14.14.2.m1.1a"><mo id="S5.T2.14.14.2.m1.1.1" xref="S5.T2.14.14.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T2.14.14.2.m1.1.1.cmml" xref="S5.T2.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.14.14.2.m1.1d">Â±</annotation></semantics></math>0.52</td>
<td class="ltx_td ltx_align_left" id="S5.T2.15.15.3">72.74<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.15.15.3.m1.1"><semantics id="S5.T2.15.15.3.m1.1a"><mo id="S5.T2.15.15.3.m1.1.1" xref="S5.T2.15.15.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T2.15.15.3.m1.1.1.cmml" xref="S5.T2.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.15.15.3.m1.1d">Â±</annotation></semantics></math>0.16</td>
<td class="ltx_td ltx_align_left" id="S5.T2.16.16.4"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.16.16.4.m1.1"><semantics id="S5.T2.16.16.4.m1.1a"><mo id="S5.T2.16.16.4.m1.1.1" xref="S5.T2.16.16.4.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.4.m1.1b"><minus id="S5.T2.16.16.4.m1.1.1.cmml" xref="S5.T2.16.16.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.4.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.16.16.4.m1.1d">-</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.20.20.5">ACM-GCN</th>
<td class="ltx_td ltx_align_left" id="S5.T2.17.17.1">89.75<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.17.17.1.m1.1"><semantics id="S5.T2.17.17.1.m1.1a"><mo id="S5.T2.17.17.1.m1.1.1" xref="S5.T2.17.17.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.1.m1.1b"><csymbol cd="latexml" id="S5.T2.17.17.1.m1.1.1.cmml" xref="S5.T2.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.17.17.1.m1.1d">Â±</annotation></semantics></math>1.16</td>
<td class="ltx_td ltx_align_left" id="S5.T2.18.18.2">91.44<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.18.18.2.m1.1"><semantics id="S5.T2.18.18.2.m1.1a"><mo id="S5.T2.18.18.2.m1.1.1" xref="S5.T2.18.18.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.2.m1.1b"><csymbol cd="latexml" id="S5.T2.18.18.2.m1.1.1.cmml" xref="S5.T2.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.18.18.2.m1.1d">Â±</annotation></semantics></math>0.59</td>
<td class="ltx_td ltx_align_left" id="S5.T2.19.19.3"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.19.19.3.m1.1"><semantics id="S5.T2.19.19.3.m1.1a"><mo id="S5.T2.19.19.3.m1.1.1" xref="S5.T2.19.19.3.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.19.19.3.m1.1b"><minus id="S5.T2.19.19.3.m1.1.1.cmml" xref="S5.T2.19.19.3.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.19.3.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.19.19.3.m1.1d">-</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.20.20.4"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.20.20.4.m1.1"><semantics id="S5.T2.20.20.4.m1.1a"><mo id="S5.T2.20.20.4.m1.1.1" xref="S5.T2.20.20.4.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.20.20.4.m1.1b"><minus id="S5.T2.20.20.4.m1.1.1.cmml" xref="S5.T2.20.20.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.20.4.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.20.20.4.m1.1d">-</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.24.24.5">GLEM + RevGAT</th>
<td class="ltx_td ltx_align_left" id="S5.T2.21.21.1">88.56<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.21.21.1.m1.1"><semantics id="S5.T2.21.21.1.m1.1a"><mo id="S5.T2.21.21.1.m1.1.1" xref="S5.T2.21.21.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.21.21.1.m1.1b"><csymbol cd="latexml" id="S5.T2.21.21.1.m1.1.1.cmml" xref="S5.T2.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.21.21.1.m1.1d">Â±</annotation></semantics></math>0.60</td>
<td class="ltx_td ltx_align_left" id="S5.T2.22.22.2">94.71<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.22.22.2.m1.1"><semantics id="S5.T2.22.22.2.m1.1a"><mo id="S5.T2.22.22.2.m1.1.1" xref="S5.T2.22.22.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.22.22.2.m1.1b"><csymbol cd="latexml" id="S5.T2.22.22.2.m1.1.1.cmml" xref="S5.T2.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.22.22.2.m1.1d">Â±</annotation></semantics></math>0.20</td>
<td class="ltx_td ltx_align_left" id="S5.T2.23.23.3">76.97<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.23.23.3.m1.1"><semantics id="S5.T2.23.23.3.m1.1a"><mo id="S5.T2.23.23.3.m1.1.1" xref="S5.T2.23.23.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.23.23.3.m1.1b"><csymbol cd="latexml" id="S5.T2.23.23.3.m1.1.1.cmml" xref="S5.T2.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.23.23.3.m1.1d">Â±</annotation></semantics></math>0.19</td>
<td class="ltx_td ltx_align_left" id="S5.T2.24.24.4"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.24.24.4.m1.1"><semantics id="S5.T2.24.24.4.m1.1a"><mo id="S5.T2.24.24.4.m1.1.1" xref="S5.T2.24.24.4.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.24.24.4.m1.1b"><minus id="S5.T2.24.24.4.m1.1.1.cmml" xref="S5.T2.24.24.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.24.4.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.24.24.4.m1.1d">-</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.28.28.5">GIANT + RevGAT</th>
<td class="ltx_td ltx_align_left" id="S5.T2.25.25.1">83.53<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.25.25.1.m1.1"><semantics id="S5.T2.25.25.1.m1.1a"><mo id="S5.T2.25.25.1.m1.1.1" xref="S5.T2.25.25.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.25.25.1.m1.1b"><csymbol cd="latexml" id="S5.T2.25.25.1.m1.1.1.cmml" xref="S5.T2.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.25.25.1.m1.1d">Â±</annotation></semantics></math>0.38</td>
<td class="ltx_td ltx_align_left" id="S5.T2.26.26.2">85.02<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.26.26.2.m1.1"><semantics id="S5.T2.26.26.2.m1.1a"><mo id="S5.T2.26.26.2.m1.1.1" xref="S5.T2.26.26.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.26.26.2.m1.1b"><csymbol cd="latexml" id="S5.T2.26.26.2.m1.1.1.cmml" xref="S5.T2.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.26.26.2.m1.1d">Â±</annotation></semantics></math>0.48</td>
<td class="ltx_td ltx_align_left" id="S5.T2.27.27.3">75.90<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.27.27.3.m1.1"><semantics id="S5.T2.27.27.3.m1.1a"><mo id="S5.T2.27.27.3.m1.1.1" xref="S5.T2.27.27.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.27.27.3.m1.1b"><csymbol cd="latexml" id="S5.T2.27.27.3.m1.1.1.cmml" xref="S5.T2.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.27.27.3.m1.1d">Â±</annotation></semantics></math>0.19</td>
<td class="ltx_td ltx_align_left" id="S5.T2.28.28.4">71.89<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.28.28.4.m1.1"><semantics id="S5.T2.28.28.4.m1.1a"><mo id="S5.T2.28.28.4.m1.1.1" xref="S5.T2.28.28.4.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.28.28.4.m1.1b"><csymbol cd="latexml" id="S5.T2.28.28.4.m1.1.1.cmml" xref="S5.T2.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.28.28.4.m1.1d">Â±</annotation></semantics></math>0.30</td>
</tr>
<tr class="ltx_tr" id="S5.T2.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.32.32.5">GIANT + GCN</th>
<td class="ltx_td ltx_align_left" id="S5.T2.29.29.1">84.23<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.29.29.1.m1.1"><semantics id="S5.T2.29.29.1.m1.1a"><mo id="S5.T2.29.29.1.m1.1.1" xref="S5.T2.29.29.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.29.29.1.m1.1b"><csymbol cd="latexml" id="S5.T2.29.29.1.m1.1.1.cmml" xref="S5.T2.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.29.29.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.29.29.1.m1.1d">Â±</annotation></semantics></math>0.53</td>
<td class="ltx_td ltx_align_left" id="S5.T2.30.30.2">84.19<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.30.30.2.m1.1"><semantics id="S5.T2.30.30.2.m1.1a"><mo id="S5.T2.30.30.2.m1.1.1" xref="S5.T2.30.30.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.30.30.2.m1.1b"><csymbol cd="latexml" id="S5.T2.30.30.2.m1.1.1.cmml" xref="S5.T2.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.30.30.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.30.30.2.m1.1d">Â±</annotation></semantics></math>0.50</td>
<td class="ltx_td ltx_align_left" id="S5.T2.31.31.3">73.29<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.31.31.3.m1.1"><semantics id="S5.T2.31.31.3.m1.1a"><mo id="S5.T2.31.31.3.m1.1.1" xref="S5.T2.31.31.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.31.31.3.m1.1b"><csymbol cd="latexml" id="S5.T2.31.31.3.m1.1.1.cmml" xref="S5.T2.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.31.31.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.31.31.3.m1.1d">Â±</annotation></semantics></math>0.10</td>
<td class="ltx_td ltx_align_left" id="S5.T2.32.32.4">69.77<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.32.32.4.m1.1"><semantics id="S5.T2.32.32.4.m1.1a"><mo id="S5.T2.32.32.4.m1.1.1" xref="S5.T2.32.32.4.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.32.32.4.m1.1b"><csymbol cd="latexml" id="S5.T2.32.32.4.m1.1.1.cmml" xref="S5.T2.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.32.32.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.32.32.4.m1.1d">Â±</annotation></semantics></math>0.42</td>
</tr>
<tr class="ltx_tr" id="S5.T2.36.36">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.36.36.5">DeBERTa</th>
<td class="ltx_td ltx_align_left" id="S5.T2.33.33.1">76.06<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.33.33.1.m1.1"><semantics id="S5.T2.33.33.1.m1.1a"><mo id="S5.T2.33.33.1.m1.1.1" xref="S5.T2.33.33.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.33.33.1.m1.1b"><csymbol cd="latexml" id="S5.T2.33.33.1.m1.1.1.cmml" xref="S5.T2.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.33.33.1.m1.1d">Â±</annotation></semantics></math>3.78</td>
<td class="ltx_td ltx_align_left" id="S5.T2.34.34.2">94.94<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.34.34.2.m1.1"><semantics id="S5.T2.34.34.2.m1.1a"><mo id="S5.T2.34.34.2.m1.1.1" xref="S5.T2.34.34.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.34.34.2.m1.1b"><csymbol cd="latexml" id="S5.T2.34.34.2.m1.1.1.cmml" xref="S5.T2.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.34.34.2.m1.1d">Â±</annotation></semantics></math>0.46</td>
<td class="ltx_td ltx_align_left" id="S5.T2.35.35.3">73.61<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.35.35.3.m1.1"><semantics id="S5.T2.35.35.3.m1.1a"><mo id="S5.T2.35.35.3.m1.1.1" xref="S5.T2.35.35.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.35.35.3.m1.1b"><csymbol cd="latexml" id="S5.T2.35.35.3.m1.1.1.cmml" xref="S5.T2.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.35.35.3.m1.1d">Â±</annotation></semantics></math>0.04</td>
<td class="ltx_td ltx_align_left" id="S5.T2.36.36.4">72.97<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.36.36.4.m1.1"><semantics id="S5.T2.36.36.4.m1.1a"><mo id="S5.T2.36.36.4.m1.1.1" xref="S5.T2.36.36.4.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.36.36.4.m1.1b"><csymbol cd="latexml" id="S5.T2.36.36.4.m1.1.1.cmml" xref="S5.T2.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.36.36.4.m1.1d">Â±</annotation></semantics></math>0.23</td>
</tr>
<tr class="ltx_tr" id="S5.T2.40.40">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.40.40.5">TAPE + RevGAT</th>
<td class="ltx_td ltx_align_left" id="S5.T2.37.37.1"><span class="ltx_text ltx_font_bold" id="S5.T2.37.37.1.1" style="color:#0000FF;">92.90<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.37.37.1.1.m1.1"><semantics id="S5.T2.37.37.1.1.m1.1a"><mo id="S5.T2.37.37.1.1.m1.1.1" mathcolor="#0000FF" xref="S5.T2.37.37.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.37.37.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.37.37.1.1.m1.1.1.cmml" xref="S5.T2.37.37.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.37.37.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.37.37.1.1.m1.1d">Â±</annotation></semantics></math>3.07</span></td>
<td class="ltx_td ltx_align_left" id="S5.T2.38.38.2"><span class="ltx_text ltx_font_bold" id="S5.T2.38.38.2.1" style="color:#0000FF;">96.18<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.38.38.2.1.m1.1"><semantics id="S5.T2.38.38.2.1.m1.1a"><mo id="S5.T2.38.38.2.1.m1.1.1" mathcolor="#0000FF" xref="S5.T2.38.38.2.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.38.38.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.38.38.2.1.m1.1.1.cmml" xref="S5.T2.38.38.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.38.38.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.38.38.2.1.m1.1d">Â±</annotation></semantics></math>0.53</span></td>
<td class="ltx_td ltx_align_left" id="S5.T2.39.39.3"><span class="ltx_text ltx_font_bold" id="S5.T2.39.39.3.1" style="color:#0000FF;">77.50<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.39.39.3.1.m1.1"><semantics id="S5.T2.39.39.3.1.m1.1a"><mo id="S5.T2.39.39.3.1.m1.1.1" mathcolor="#0000FF" xref="S5.T2.39.39.3.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.39.39.3.1.m1.1b"><csymbol cd="latexml" id="S5.T2.39.39.3.1.m1.1.1.cmml" xref="S5.T2.39.39.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.39.39.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.39.39.3.1.m1.1d">Â±</annotation></semantics></math>0.12</span></td>
<td class="ltx_td ltx_align_left" id="S5.T2.40.40.4"><span class="ltx_text ltx_font_bold" id="S5.T2.40.40.4.1" style="color:#0000FF;">82.34<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.40.40.4.1.m1.1"><semantics id="S5.T2.40.40.4.1.m1.1a"><mo id="S5.T2.40.40.4.1.m1.1.1" mathcolor="#0000FF" xref="S5.T2.40.40.4.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.40.40.4.1.m1.1b"><csymbol cd="latexml" id="S5.T2.40.40.4.1.m1.1.1.cmml" xref="S5.T2.40.40.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.40.40.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.40.40.4.1.m1.1d">Â±</annotation></semantics></math>0.36</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.56.58.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S5.T2.56.58.2.1" rowspan="5"><span class="ltx_text" id="S5.T2.56.58.2.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S5.T2.56.58.2.1.1.1" style="width:8.8pt;height:52.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:52.8pt;transform:translate(-22pt,-21.03pt) rotate(-90deg) ;">
<span class="ltx_p" id="S5.T2.56.58.2.1.1.1.1">Text-output</span>
</span></span></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.56.58.2.2">ChatGPT-3.5</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.56.58.2.3">67.90</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.56.58.2.4">93.42</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.56.58.2.5">73.40</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.56.58.2.6">74.40</td>
</tr>
<tr class="ltx_tr" id="S5.T2.44.44">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.44.44.5">InstructGLM</th>
<td class="ltx_td ltx_align_left" id="S5.T2.41.41.1">90.77<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.41.41.1.m1.1"><semantics id="S5.T2.41.41.1.m1.1a"><mo id="S5.T2.41.41.1.m1.1.1" xref="S5.T2.41.41.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.41.41.1.m1.1b"><csymbol cd="latexml" id="S5.T2.41.41.1.m1.1.1.cmml" xref="S5.T2.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.41.41.1.m1.1d">Â±</annotation></semantics></math>0.52</td>
<td class="ltx_td ltx_align_left" id="S5.T2.42.42.2">94.62<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.42.42.2.m1.1"><semantics id="S5.T2.42.42.2.m1.1a"><mo id="S5.T2.42.42.2.m1.1.1" xref="S5.T2.42.42.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.42.42.2.m1.1b"><csymbol cd="latexml" id="S5.T2.42.42.2.m1.1.1.cmml" xref="S5.T2.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.42.42.2.m1.1d">Â±</annotation></semantics></math>0.13</td>
<td class="ltx_td ltx_align_left" id="S5.T2.43.43.3">75.70<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.43.43.3.m1.1"><semantics id="S5.T2.43.43.3.m1.1a"><mo id="S5.T2.43.43.3.m1.1.1" xref="S5.T2.43.43.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.43.43.3.m1.1b"><csymbol cd="latexml" id="S5.T2.43.43.3.m1.1.1.cmml" xref="S5.T2.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.43.43.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.43.43.3.m1.1d">Â±</annotation></semantics></math>0.12</td>
<td class="ltx_td ltx_align_left" id="S5.T2.44.44.4"><math alttext="-" class="ltx_Math" display="inline" id="S5.T2.44.44.4.m1.1"><semantics id="S5.T2.44.44.4.m1.1a"><mo id="S5.T2.44.44.4.m1.1.1" xref="S5.T2.44.44.4.m1.1.1.cmml">âˆ’</mo><annotation-xml encoding="MathML-Content" id="S5.T2.44.44.4.m1.1b"><minus id="S5.T2.44.44.4.m1.1.1.cmml" xref="S5.T2.44.44.4.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.44.44.4.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.44.44.4.m1.1d">-</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.48.48">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.48.48.5">
<span class="ltx_text ltx_font_smallcaps" id="S5.T2.48.48.5.1">AugGLMÂ </span>(T5-small)</th>
<td class="ltx_td ltx_align_left" id="S5.T2.45.45.1">91.14<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.45.45.1.m1.1"><semantics id="S5.T2.45.45.1.m1.1a"><mo id="S5.T2.45.45.1.m1.1.1" xref="S5.T2.45.45.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.45.45.1.m1.1b"><csymbol cd="latexml" id="S5.T2.45.45.1.m1.1.1.cmml" xref="S5.T2.45.45.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.45.45.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.45.45.1.m1.1d">Â±</annotation></semantics></math>0.55</td>
<td class="ltx_td ltx_align_left" id="S5.T2.46.46.2">94.80<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.46.46.2.m1.1"><semantics id="S5.T2.46.46.2.m1.1a"><mo id="S5.T2.46.46.2.m1.1.1" xref="S5.T2.46.46.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.46.46.2.m1.1b"><csymbol cd="latexml" id="S5.T2.46.46.2.m1.1.1.cmml" xref="S5.T2.46.46.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.46.46.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.46.46.2.m1.1d">Â±</annotation></semantics></math>0.15</td>
<td class="ltx_td ltx_align_left" id="S5.T2.47.47.3">75.39<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.47.47.3.m1.1"><semantics id="S5.T2.47.47.3.m1.1a"><mo id="S5.T2.47.47.3.m1.1.1" xref="S5.T2.47.47.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.47.47.3.m1.1b"><csymbol cd="latexml" id="S5.T2.47.47.3.m1.1.1.cmml" xref="S5.T2.47.47.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.47.47.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.47.47.3.m1.1d">Â±</annotation></semantics></math>0.21</td>
<td class="ltx_td ltx_align_left" id="S5.T2.48.48.4">81.73<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.48.48.4.m1.1"><semantics id="S5.T2.48.48.4.m1.1a"><mo id="S5.T2.48.48.4.m1.1.1" xref="S5.T2.48.48.4.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.48.48.4.m1.1b"><csymbol cd="latexml" id="S5.T2.48.48.4.m1.1.1.cmml" xref="S5.T2.48.48.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.48.48.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.48.48.4.m1.1d">Â±</annotation></semantics></math>0.08</td>
</tr>
<tr class="ltx_tr" id="S5.T2.52.52">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.52.52.5">
<span class="ltx_text ltx_font_smallcaps" id="S5.T2.52.52.5.1">AugGLMÂ </span>(T5-base)</th>
<td class="ltx_td ltx_align_left" id="S5.T2.49.49.1">91.24<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.49.49.1.m1.1"><semantics id="S5.T2.49.49.1.m1.1a"><mo id="S5.T2.49.49.1.m1.1.1" xref="S5.T2.49.49.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.49.49.1.m1.1b"><csymbol cd="latexml" id="S5.T2.49.49.1.m1.1.1.cmml" xref="S5.T2.49.49.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.49.49.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.49.49.1.m1.1d">Â±</annotation></semantics></math>0.46</td>
<td class="ltx_td ltx_align_left" id="S5.T2.50.50.2">95.03<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.50.50.2.m1.1"><semantics id="S5.T2.50.50.2.m1.1a"><mo id="S5.T2.50.50.2.m1.1.1" xref="S5.T2.50.50.2.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.50.50.2.m1.1b"><csymbol cd="latexml" id="S5.T2.50.50.2.m1.1.1.cmml" xref="S5.T2.50.50.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.50.50.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.50.50.2.m1.1d">Â±</annotation></semantics></math>0.35</td>
<td class="ltx_td ltx_align_left" id="S5.T2.51.51.3"><span class="ltx_text ltx_font_bold" id="S5.T2.51.51.3.1" style="color:#FF0000;">76.80<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.51.51.3.1.m1.1"><semantics id="S5.T2.51.51.3.1.m1.1a"><mo id="S5.T2.51.51.3.1.m1.1.1" mathcolor="#FF0000" xref="S5.T2.51.51.3.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.51.51.3.1.m1.1b"><csymbol cd="latexml" id="S5.T2.51.51.3.1.m1.1.1.cmml" xref="S5.T2.51.51.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.51.51.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.51.51.3.1.m1.1d">Â±</annotation></semantics></math>0.14</span></td>
<td class="ltx_td ltx_align_left" id="S5.T2.52.52.4">81.91<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.52.52.4.m1.1"><semantics id="S5.T2.52.52.4.m1.1a"><mo id="S5.T2.52.52.4.m1.1.1" xref="S5.T2.52.52.4.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.52.52.4.m1.1b"><csymbol cd="latexml" id="S5.T2.52.52.4.m1.1.1.cmml" xref="S5.T2.52.52.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.52.52.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.52.52.4.m1.1d">Â±</annotation></semantics></math>0.11</td>
</tr>
<tr class="ltx_tr" id="S5.T2.56.56">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T2.56.56.5">
<span class="ltx_text ltx_font_smallcaps" id="S5.T2.56.56.5.1">AugGLMÂ </span>(T5-large)</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T2.53.53.1"><span class="ltx_text ltx_font_bold" id="S5.T2.53.53.1.1" style="color:#FF0000;">91.51<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.53.53.1.1.m1.1"><semantics id="S5.T2.53.53.1.1.m1.1a"><mo id="S5.T2.53.53.1.1.m1.1.1" mathcolor="#FF0000" xref="S5.T2.53.53.1.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.53.53.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.53.53.1.1.m1.1.1.cmml" xref="S5.T2.53.53.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.53.53.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.53.53.1.1.m1.1d">Â±</annotation></semantics></math>0.26</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T2.54.54.2"><span class="ltx_text ltx_font_bold" id="S5.T2.54.54.2.1" style="color:#FF0000;">95.16<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.54.54.2.1.m1.1"><semantics id="S5.T2.54.54.2.1.m1.1a"><mo id="S5.T2.54.54.2.1.m1.1.1" mathcolor="#FF0000" xref="S5.T2.54.54.2.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.54.54.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.54.54.2.1.m1.1.1.cmml" xref="S5.T2.54.54.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.54.54.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.54.54.2.1.m1.1d">Â±</annotation></semantics></math>0.18</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T2.55.55.3">76.00<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.55.55.3.m1.1"><semantics id="S5.T2.55.55.3.m1.1a"><mo id="S5.T2.55.55.3.m1.1.1" xref="S5.T2.55.55.3.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.55.55.3.m1.1b"><csymbol cd="latexml" id="S5.T2.55.55.3.m1.1.1.cmml" xref="S5.T2.55.55.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.55.55.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.55.55.3.m1.1d">Â±</annotation></semantics></math>0.23</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T2.56.56.4"><span class="ltx_text ltx_font_bold" id="S5.T2.56.56.4.1" style="color:#FF0000;">82.90<math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.56.56.4.1.m1.1"><semantics id="S5.T2.56.56.4.1.m1.1a"><mo id="S5.T2.56.56.4.1.m1.1.1" mathcolor="#FF0000" xref="S5.T2.56.56.4.1.m1.1.1.cmml">Â±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.56.56.4.1.m1.1b"><csymbol cd="latexml" id="S5.T2.56.56.4.1.m1.1.1.cmml" xref="S5.T2.56.56.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.56.56.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T2.56.56.4.1.m1.1d">Â±</annotation></semantics></math>0.10</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.T2" title="Table 2 â€£ 5.2 Comparison with state-of-the-art â€£ 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">2</span></a> presents a comprehensive comparison of our modelâ€™s performance against existing approaches. The results demonstrate that our proposed method consistently outperforms InstructGLM, achieving new state-of-the-art performance among LMs with text-space outputs for node classification tasks on TAGs. Notably, this superior performance is achieved without modifying the underlying architecture of the LMs, demonstrating the effectiveness of our approach. Furthermore, our models exhibit competitive performance compared to the best vector-output models. Specifically, on Cora, Pubmed, and ogbn-arxiv datasets, our modelsâ€™ performance closely approaches that of the state-of-the-art vector-output models. Furthermore, on the ogbn-products dataset, our approach surpasses the performance of the best vector-output model, TAPE.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Ablation Study</h3>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">To evaluate the contribution of each key component in <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p1.1.1">AugGLMÂ </span>, we conducted an ablation study on three crucial modules: (1) topological retrieval, (2) semantic retrieval, and (3) candidate label pruning. We use the Flan-T5-small as the backbone LM for this analysis. The results, presented in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.T3" title="Table 3 â€£ 5.3 Ablation Study â€£ 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">3</span></a>, demonstrate that each module consistently improves performance across all datasets. Notably, our analysis reveals that the relative importance of each component varies across different datasets. For instance, candidate label pruning has a significant impact on performance for the Cora dataset, whereas its effect is less pronounced for the ogbn-products dataset. This variation in component importance underscores adaptability of our approach, which can effectively accommodate diverse datasets with different characteristics.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation study results. T, S, L, denotes the topological retrieval, semantic retrieval, and candidate label pruning. The <math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.2.m1.1"><semantics id="S5.T3.2.m1.1b"><mo id="S5.T3.2.m1.1.1" stretchy="false" xref="S5.T3.2.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.1c"><ci id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.1d">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.m1.1e">â†“</annotation></semantics></math> symbol denotes the decrease in accuracy of the ablated version compared to the full model.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.14">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.14.13.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T3.14.13.1.1">T</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T3.14.13.1.2">S</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.14.13.1.3">L</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.14.13.1.4">Cora</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.14.13.1.5">Pubmed</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.14.13.1.6">ogbn-arxiv</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.14.13.1.7">ogbn-products</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.6.4.5">âœ“</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.6.4.6">âœ“</th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.6.4.7"></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.3.1.1">85.52 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.3.1.1.m1.1"><semantics id="S5.T3.3.1.1.m1.1a"><mo id="S5.T3.3.1.1.m1.1.1" stretchy="false" xref="S5.T3.3.1.1.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.1.m1.1b"><ci id="S5.T3.3.1.1.m1.1.1.cmml" xref="S5.T3.3.1.1.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.1.1.m1.1d">â†“</annotation></semantics></math>5.62)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.4.2.2">94.40 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.4.2.2.m1.1"><semantics id="S5.T3.4.2.2.m1.1a"><mo id="S5.T3.4.2.2.m1.1.1" stretchy="false" xref="S5.T3.4.2.2.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.2.2.m1.1b"><ci id="S5.T3.4.2.2.m1.1.1.cmml" xref="S5.T3.4.2.2.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.2.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.2.2.m1.1d">â†“</annotation></semantics></math>0.40)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.5.3.3">72.91 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.5.3.3.m1.1"><semantics id="S5.T3.5.3.3.m1.1a"><mo id="S5.T3.5.3.3.m1.1.1" stretchy="false" xref="S5.T3.5.3.3.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.5.3.3.m1.1b"><ci id="S5.T3.5.3.3.m1.1.1.cmml" xref="S5.T3.5.3.3.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.5.3.3.m1.1d">â†“</annotation></semantics></math>2.48)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.6.4.4">79.83 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.6.4.4.m1.1"><semantics id="S5.T3.6.4.4.m1.1a"><mo id="S5.T3.6.4.4.m1.1.1" stretchy="false" xref="S5.T3.6.4.4.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.4.4.m1.1b"><ci id="S5.T3.6.4.4.m1.1.1.cmml" xref="S5.T3.6.4.4.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.6.4.4.m1.1d">â†“</annotation></semantics></math>1.90)</td>
</tr>
<tr class="ltx_tr" id="S5.T3.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.10.8.5">âœ“</th>
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.10.8.6"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.10.8.7">âœ“</th>
<td class="ltx_td ltx_align_left" id="S5.T3.7.5.1">87.27 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.7.5.1.m1.1"><semantics id="S5.T3.7.5.1.m1.1a"><mo id="S5.T3.7.5.1.m1.1.1" stretchy="false" xref="S5.T3.7.5.1.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.7.5.1.m1.1b"><ci id="S5.T3.7.5.1.m1.1.1.cmml" xref="S5.T3.7.5.1.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.5.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.7.5.1.m1.1d">â†“</annotation></semantics></math>3.87)</td>
<td class="ltx_td ltx_align_left" id="S5.T3.8.6.2">94.32 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.8.6.2.m1.1"><semantics id="S5.T3.8.6.2.m1.1a"><mo id="S5.T3.8.6.2.m1.1.1" stretchy="false" xref="S5.T3.8.6.2.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.6.2.m1.1b"><ci id="S5.T3.8.6.2.m1.1.1.cmml" xref="S5.T3.8.6.2.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.6.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.8.6.2.m1.1d">â†“</annotation></semantics></math>0.48)</td>
<td class="ltx_td ltx_align_left" id="S5.T3.9.7.3">73.79 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.9.7.3.m1.1"><semantics id="S5.T3.9.7.3.m1.1a"><mo id="S5.T3.9.7.3.m1.1.1" stretchy="false" xref="S5.T3.9.7.3.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.9.7.3.m1.1b"><ci id="S5.T3.9.7.3.m1.1.1.cmml" xref="S5.T3.9.7.3.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.7.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.9.7.3.m1.1d">â†“</annotation></semantics></math>1.60)</td>
<td class="ltx_td ltx_align_left" id="S5.T3.10.8.4">81.05 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.10.8.4.m1.1"><semantics id="S5.T3.10.8.4.m1.1a"><mo id="S5.T3.10.8.4.m1.1.1" stretchy="false" xref="S5.T3.10.8.4.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.10.8.4.m1.1b"><ci id="S5.T3.10.8.4.m1.1.1.cmml" xref="S5.T3.10.8.4.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.8.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.10.8.4.m1.1d">â†“</annotation></semantics></math>0.68)</td>
</tr>
<tr class="ltx_tr" id="S5.T3.14.12">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.14.12.5"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.14.12.6">âœ“</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T3.14.12.7">âœ“</th>
<td class="ltx_td ltx_align_left" id="S5.T3.11.9.1">90.25 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.11.9.1.m1.1"><semantics id="S5.T3.11.9.1.m1.1a"><mo id="S5.T3.11.9.1.m1.1.1" stretchy="false" xref="S5.T3.11.9.1.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.11.9.1.m1.1b"><ci id="S5.T3.11.9.1.m1.1.1.cmml" xref="S5.T3.11.9.1.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.9.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.11.9.1.m1.1d">â†“</annotation></semantics></math>0.89)</td>
<td class="ltx_td ltx_align_left" id="S5.T3.12.10.2">94.26 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.12.10.2.m1.1"><semantics id="S5.T3.12.10.2.m1.1a"><mo id="S5.T3.12.10.2.m1.1.1" stretchy="false" xref="S5.T3.12.10.2.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.12.10.2.m1.1b"><ci id="S5.T3.12.10.2.m1.1.1.cmml" xref="S5.T3.12.10.2.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.12.10.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.12.10.2.m1.1d">â†“</annotation></semantics></math>0.54)</td>
<td class="ltx_td ltx_align_left" id="S5.T3.13.11.3">73.46 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.13.11.3.m1.1"><semantics id="S5.T3.13.11.3.m1.1a"><mo id="S5.T3.13.11.3.m1.1.1" stretchy="false" xref="S5.T3.13.11.3.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.13.11.3.m1.1b"><ci id="S5.T3.13.11.3.m1.1.1.cmml" xref="S5.T3.13.11.3.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.13.11.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.13.11.3.m1.1d">â†“</annotation></semantics></math>1.93)</td>
<td class="ltx_td ltx_align_left" id="S5.T3.14.12.4">79.06 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.T3.14.12.4.m1.1"><semantics id="S5.T3.14.12.4.m1.1a"><mo id="S5.T3.14.12.4.m1.1.1" stretchy="false" xref="S5.T3.14.12.4.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S5.T3.14.12.4.m1.1b"><ci id="S5.T3.14.12.4.m1.1.1.cmml" xref="S5.T3.14.12.4.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.14.12.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.T3.14.12.4.m1.1d">â†“</annotation></semantics></math>2.67)</td>
</tr>
<tr class="ltx_tr" id="S5.T3.14.14.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.14.14.1.1">âœ“</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.14.14.1.2">âœ“</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T3.14.14.1.3">âœ“</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.14.14.1.4">91.14</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.14.14.1.5">94.80</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.14.14.1.6">75.39</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.14.14.1.7">81.73</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Multi-Task Training</h3>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">One of the key advantage of pure text-to-text instruction tuning is that a single model can be trained on multiple tasks with the same input-output format. To verify this, we conducted an experiment using a Flan-T5-small model, applying our proposed strategies to jointly train it on four diverse datasets: Cora, Pubmed, ogbn-arxiv, and ogbn-products. The results, presented in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#S5.T4" title="Table 4 â€£ 5.4 Multi-Task Training â€£ 5 Experiments â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">4</span></a> show that the jointly trained model achieve performance comparable to models trained separately on each individual dataset. We observe that on some datasets, such as Cora and ogbn-products, the jointly trained model even outperforms its dataset-specific counterparts.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">These findings suggest that our approach can effectively handle multiple graph datasets using a single model, without incurring significant performance losses compared to models trained individually. This capability is crucial for efficient model deployment when dealing with diverse graph data. In contrast, other approaches, such as InstructGLM, require the addition of a large token dictionary to accommodate all nodes in the joint dataset, which hinders their ability to achieve similar generality. Moreover, most vector-output models, including TAPE, are limited by their predefined input-output dimensions, making them inflexible and unable to handle multiple datasets.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Performance of the jointly trained model (accuracy).</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.1">Training</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.2">Cora</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.3">Pubmed</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.4">ogbn-arxiv</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.5">ogbn-products</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.2.1.1">Multi-Task</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.1.2.1.2">91.52</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.1.2.1.3">94.52</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.1.2.1.4">74.87</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.1.2.1.5">82.29</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T4.1.3.2.1">Independent</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T4.1.3.2.2">91.14</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T4.1.3.2.3">94.80</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T4.1.3.2.4">75.39</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T4.1.3.2.5">81.73</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We introduce a novel framework called <span class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">AugGLMÂ </span>for instruct-tuning Language Models (LMs) to perform node classification tasks on Text-Attributed Graphs (TAGs) using pure text-to-text instructions. Our approach is built upon two key innovations: (1) topological and semantic retrieval of relevant nodes, (2) using a lightweight GNN to guide the classification process of LMs. Extensive experimental results demonstrated the effectiveness of our framework, which consistently outperformed the best existing text-output node classifiers, while achieving performance comparable to state-of-the-art vector-output node classifiers. These findings suggest a promising direction for harnessing the power of Large Language Models (LLMs) in graph learning tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">Limitation and Future Work.</span> One limitation of this work is the need for manual definition of prompt templates in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A3.T5" title="Table 5 â€£ Appendix C Templates â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">5</span></a>. A promising direction for future research is to develop methods for automatically searching for optimal templates in a data-driven manner. Another limitation is the requirement for pretraining a GNN <math alttext="\psi" class="ltx_Math" display="inline" id="S6.p2.1.m1.1"><semantics id="S6.p2.1.m1.1a"><mi id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><ci id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S6.p2.1.m1.1d">italic_Ïˆ</annotation></semantics></math> on each dataset, which stems from the inherent challenges of language models in understanding graph data. Addressing this limitation by developing more powerful language models capable of handling graph data is a challenging yet impactful area of future work.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alayrac etÂ al. (2022)</span>
<span class="ltx_bibblock">
Jean-Baptiste Alayrac, Jeff Donahue, Pauline Luc, Antoine Miech, Iain Barr, Yana Hasson, Karel Lenc, Arthur Mensch, Katherine Millican, Malcolm Reynolds, Roman Ring, Eliza Rutherford, Serkan Cabi, Tengda Han, Zhitao Gong, Sina Samangooei, Marianne Monteiro, JacobÂ L. Menick, Sebastian Borgeaud, Andy Brock, Aida Nematzadeh, Sahand Sharifzadeh, Mikolaj Binkowski, Ricardo Barreira, Oriol Vinyals, Andrew Zisserman, and KarÃ©n Simonyan.

</span>
<span class="ltx_bibblock">Flamingo: a visual language model for few-shot learning.

</span>
<span class="ltx_bibblock">In Sanmi Koyejo, S.Â Mohamed, A.Â Agarwal, Danielle Belgrave, K.Â Cho, and A.Â Oh (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in Neural Information Processing Systems 35: Annual Conference on Neural Information Processing Systems 2022, NeurIPS 2022, New Orleans, LA, USA, November 28 - December 9, 2022</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://papers.nips.cc/paper_files/paper/2022/hash/960a172bc7fbf0177ccccbb411a7d800-Abstract-Conference.html" title="">http://papers.nips.cc/paper_files/paper/2022/hash/960a172bc7fbf0177ccccbb411a7d800-Abstract-Conference.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andersen etÂ al. (2006)</span>
<span class="ltx_bibblock">
Reid Andersen, Fan R.Â K. Chung, and KevinÂ J. Lang.

</span>
<span class="ltx_bibblock">Local graph partitioning using pagerank vectors.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">47th Annual IEEE Symposium on Foundations of Computer Science (FOCS 2006), 21-24 October 2006, Berkeley, California, USA, Proceedings</em>, pp.Â  475â€“486. IEEE Computer Society, 2006.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/FOCS.2006.44</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/FOCS.2006.44" title="">https://doi.org/10.1109/FOCS.2006.44</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biehl etÂ al. (2016)</span>
<span class="ltx_bibblock">
Michael Biehl, Barbara Hammer, and Thomas Villmann.

</span>
<span class="ltx_bibblock">Prototype-based models in machine learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Wiley Interdisciplinary Reviews: Cognitive Science</em>, 7(2):92â€“111, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bo etÂ al. (2021)</span>
<span class="ltx_bibblock">
Deyu Bo, Xiao Wang, Chuan Shi, and Huawei Shen.

</span>
<span class="ltx_bibblock">Beyond low-frequency information in graph convolutional networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Thirty-Fifth AAAI Conference on Artificial Intelligence, AAAI 2021, Thirty-Third Conference on Innovative Applications of Artificial Intelligence, IAAI 2021, The Eleventh Symposium on Educational Advances in Artificial Intelligence, EAAI 2021, Virtual Event, February 2-9, 2021</em>, pp.Â  3950â€“3957. AAAI Press, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1609/AAAI.V35I5.16514</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1609/aaai.v35i5.16514" title="">https://doi.org/10.1609/aaai.v35i5.16514</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgeaud etÂ al. (2022)</span>
<span class="ltx_bibblock">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, George vanÂ den Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, Diego deÂ LasÂ Casas, Aurelia Guy, Jacob Menick, Roman Ring, Tom Hennigan, Saffron Huang, Loren Maggiore, Chris Jones, Albin Cassirer, Andy Brock, Michela Paganini, Geoffrey Irving, Oriol Vinyals, Simon Osindero, Karen Simonyan, JackÂ W. Rae, Erich Elsen, and Laurent Sifre.

</span>
<span class="ltx_bibblock">Improving language models by retrieving from trillions of tokens.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, LeÂ Song, Csaba SzepesvÃ¡ri, Gang Niu, and Sivan Sabato (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore, Maryland, USA</em>, volume 162 of <em class="ltx_emph ltx_font_italic" id="bib.bib5.2.2">Proceedings of Machine Learning Research</em>, pp.Â  2206â€“2240. PMLR, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v162/borgeaud22a.html" title="">https://proceedings.mlr.press/v162/borgeaud22a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brannon etÂ al. (2023)</span>
<span class="ltx_bibblock">
William Brannon, Suyash Fulay, Hang Jiang, Wonjune Kang, Brandon Roy, Jad Kabbara, and Deb Roy.

</span>
<span class="ltx_bibblock">Congrat: Self-supervised contrastive pretraining for joint graph and text embeddings.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">CoRR</em>, abs/2305.14321, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2305.14321</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2305.14321" title="">https://doi.org/10.48550/arXiv.2305.14321</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bromley etÂ al. (1993)</span>
<span class="ltx_bibblock">
Jane Bromley, JamesÂ W. Bentz, LÃ©on Bottou, Isabelle Guyon, Yann LeCun, Cliff Moore, Eduard SÃ¤ckinger, and Roopak Shah.

</span>
<span class="ltx_bibblock">Signature verification using A â€siameseâ€ time delay neural network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Int. J. Pattern Recognit. Artif. Intell.</em>, 7(4):669â€“688, 1993.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1142/S0218001493000339</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1142/S0218001493000339" title="">https://doi.org/10.1142/S0218001493000339</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. (2018)</span>
<span class="ltx_bibblock">
Jianfei Chen, Jun Zhu, and LeÂ Song.

</span>
<span class="ltx_bibblock">Stochastic training of graph convolutional networks with variance reduction.

</span>
<span class="ltx_bibblock">In JenniferÂ G. Dy and Andreas Krause (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 35th International Conference on Machine Learning, ICML 2018, StockholmsmÃ¤ssan, Stockholm, Sweden, July 10-15, 2018</em>, volumeÂ 80 of <em class="ltx_emph ltx_font_italic" id="bib.bib8.2.2">Proceedings of Machine Learning Research</em>, pp.Â  941â€“949. PMLR, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v80/chen18p.html" title="">http://proceedings.mlr.press/v80/chen18p.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. (2020)</span>
<span class="ltx_bibblock">
Ming Chen, Zhewei Wei, Zengfeng Huang, Bolin Ding, and Yaliang Li.

</span>
<span class="ltx_bibblock">Simple and deep graph convolutional networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 37th International Conference on Machine Learning, ICML 2020, 13-18 July 2020, Virtual Event</em>, volume 119 of <em class="ltx_emph ltx_font_italic" id="bib.bib9.2.2">Proceedings of Machine Learning Research</em>, pp.Â  1725â€“1735. PMLR, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v119/chen20v.html" title="">http://proceedings.mlr.press/v119/chen20v.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al. (2024)</span>
<span class="ltx_bibblock">
Nuo Chen, Yuhan Li, Jianheng Tang, and Jia Li.

</span>
<span class="ltx_bibblock">Graphwiz: An instruction-following language model for graph computational problems.

</span>
<span class="ltx_bibblock">In Ricardo Baeza-Yates and Francesco Bonchi (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, KDD 2024, Barcelona, Spain, August 25-29, 2024</em>, pp.Â  353â€“364. ACM, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3637528.3672010</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3637528.3672010" title="">https://doi.org/10.1145/3637528.3672010</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chien etÂ al. (2022)</span>
<span class="ltx_bibblock">
Eli Chien, Wei-Cheng Chang, Cho-Jui Hsieh, Hsiang-Fu Yu, Jiong Zhang, Olgica Milenkovic, and InderjitÂ S. Dhillon.

</span>
<span class="ltx_bibblock">Node feature extraction by self-supervised multi-scale neighborhood prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022</em>. OpenReview.net, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=KJggliHbs8" title="">https://openreview.net/forum?id=KJggliHbs8</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung etÂ al. (2022)</span>
<span class="ltx_bibblock">
HyungÂ Won Chung, LeÂ Hou, Shayne Longpre, Barret Zoph, YiÂ Tay, William Fedus, Eric Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, Albert Webson, ShixiangÂ Shane Gu, Zhuyun Dai, Mirac Suzgun, Xinyun Chen, Aakanksha Chowdhery, Sharan Narang, Gaurav Mishra, Adams Yu, VincentÂ Y. Zhao, Yanping Huang, AndrewÂ M. Dai, Hongkun Yu, Slav Petrov, EdÂ H. Chi, Jeff Dean, Jacob Devlin, Adam Roberts, Denny Zhou, QuocÂ V. Le, and Jason Wei.

</span>
<span class="ltx_bibblock">Scaling instruction-finetuned language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">CoRR</em>, abs/2210.11416, 2022.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2210.11416</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2210.11416" title="">https://doi.org/10.48550/arXiv.2210.11416</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung etÂ al. (2024)</span>
<span class="ltx_bibblock">
HyungÂ Won Chung, LeÂ Hou, Shayne Longpre, Barret Zoph, YiÂ Tay, William Fedus, Yunxuan Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, Albert Webson, ShixiangÂ Shane Gu, Zhuyun Dai, Mirac Suzgun, Xinyun Chen, Aakanksha Chowdhery, Alex Castro-Ros, Marie Pellat, Kevin Robinson, Dasha Valter, Sharan Narang, Gaurav Mishra, Adams Yu, VincentÂ Y. Zhao, Yanping Huang, AndrewÂ M. Dai, Hongkun Yu, Slav Petrov, EdÂ H. Chi, Jeff Dean, Jacob Devlin, Adam Roberts, Denny Zhou, QuocÂ V. Le, and Jason Wei.

</span>
<span class="ltx_bibblock">Scaling instruction-finetuned language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">J. Mach. Learn. Res.</em>, 25:70:1â€“70:53, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://jmlr.org/papers/v25/23-0870.html" title="">https://jmlr.org/papers/v25/23-0870.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Desai &amp; Johnson (2021)</span>
<span class="ltx_bibblock">
Karan Desai and Justin Johnson.

</span>
<span class="ltx_bibblock">Virtex: Learning visual representations from textual annotations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2021, virtual, June 19-25, 2021</em>, pp.Â  11162â€“11173. Computer Vision Foundation / IEEE, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPR46437.2021.01101</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openaccess.thecvf.com/content/CVPR2021/html/Desai_VirTex_Learning_Visual_Representations_From_Textual_Annotations_CVPR_2021_paper.html" title="">https://openaccess.thecvf.com/content/CVPR2021/html/Desai_VirTex_Learning_Visual_Representations_From_Textual_Annotations_CVPR_2021_paper.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edge etÂ al. (2024)</span>
<span class="ltx_bibblock">
Darren Edge, HaÂ Trinh, Newman Cheng, Joshua Bradley, Alex Chao, Apurva Mody, Steven Truitt, and Jonathan Larson.

</span>
<span class="ltx_bibblock">From local to global: A graph rag approach to query-focused summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2404.16130</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fatemi etÂ al. (2024)</span>
<span class="ltx_bibblock">
Bahare Fatemi, Jonathan Halcrow, and Bryan Perozzi.

</span>
<span class="ltx_bibblock">Talk like a graph: Encoding graphs for large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">The Twelfth International Conference on Learning Representations, ICLR 2024, Vienna, Austria, May 7-11, 2024</em>. OpenReview.net, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=IuXR1CCrSi" title="">https://openreview.net/forum?id=IuXR1CCrSi</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fey etÂ al. (2021)</span>
<span class="ltx_bibblock">
Matthias Fey, JanÂ Eric Lenssen, Frank Weichert, and Jure Leskovec.

</span>
<span class="ltx_bibblock">Gnnautoscale: Scalable and expressive graph neural networks via historical embeddings.

</span>
<span class="ltx_bibblock">In Marina Meila and Tong Zhang (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 38th International Conference on Machine Learning, ICML 2021, 18-24 July 2021, Virtual Event</em>, volume 139 of <em class="ltx_emph ltx_font_italic" id="bib.bib17.2.2">Proceedings of Machine Learning Research</em>, pp.Â  3294â€“3304. PMLR, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v139/fey21a.html" title="">http://proceedings.mlr.press/v139/fey21a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guu etÂ al. (2020)</span>
<span class="ltx_bibblock">
Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Ming-Wei Chang.

</span>
<span class="ltx_bibblock">Retrieval augmented language model pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 37th International Conference on Machine Learning, ICML 2020, 13-18 July 2020, Virtual Event</em>, volume 119 of <em class="ltx_emph ltx_font_italic" id="bib.bib18.2.2">Proceedings of Machine Learning Research</em>, pp.Â  3929â€“3938. PMLR, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v119/guu20a.html" title="">http://proceedings.mlr.press/v119/guu20a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamilton etÂ al. (2017)</span>
<span class="ltx_bibblock">
WilliamÂ L. Hamilton, Zhitao Ying, and Jure Leskovec.

</span>
<span class="ltx_bibblock">Inductive representation learning on large graphs.

</span>
<span class="ltx_bibblock">In Isabelle Guyon, Ulrike von Luxburg, Samy Bengio, HannaÂ M. Wallach, Rob Fergus, S.Â V.Â N. Vishwanathan, and Roman Garnett (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural Information Processing Systems 30: Annual Conference on Neural Information Processing Systems 2017, December 4-9, 2017, Long Beach, CA, USA</em>, pp.Â  1024â€“1034, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2017/hash/5dd9db5e033da9c6fb5ba83c7a7ebea9-Abstract.html" title="">https://proceedings.neurips.cc/paper/2017/hash/5dd9db5e033da9c6fb5ba83c7a7ebea9-Abstract.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hashimoto etÂ al. (2018)</span>
<span class="ltx_bibblock">
TatsunoriÂ B. Hashimoto, Kelvin Guu, Yonatan Oren, and Percy Liang.

</span>
<span class="ltx_bibblock">A retrieve-and-edit framework for predicting structured outputs.

</span>
<span class="ltx_bibblock">In Samy Bengio, HannaÂ M. Wallach, Hugo Larochelle, Kristen Grauman, NicolÃ² Cesa-Bianchi, and Roman Garnett (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in Neural Information Processing Systems 31: Annual Conference on Neural Information Processing Systems 2018, NeurIPS 2018, December 3-8, 2018, MontrÃ©al, Canada</em>, pp.Â  10073â€“10083, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2018/hash/cd17d3ce3b64f227987cd92cd701cc58-Abstract.html" title="">https://proceedings.neurips.cc/paper/2018/hash/cd17d3ce3b64f227987cd92cd701cc58-Abstract.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He etÂ al. (2021a)</span>
<span class="ltx_bibblock">
Mingguo He, Zhewei Wei, Zengfeng Huang, and Hongteng Xu.

</span>
<span class="ltx_bibblock">Bernnet: Learning arbitrary graph spectral filters via bernstein approximation.

</span>
<span class="ltx_bibblock">In Marcâ€™Aurelio Ranzato, Alina Beygelzimer, YannÂ N. Dauphin, Percy Liang, and JenniferÂ Wortman Vaughan (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Advances in Neural Information Processing Systems 34: Annual Conference on Neural Information Processing Systems 2021, NeurIPS 2021, December 6-14, 2021, virtual</em>, pp.Â  14239â€“14251, 2021a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2021/hash/76f1cfd7754a6e4fc3281bcccb3d0902-Abstract.html" title="">https://proceedings.neurips.cc/paper/2021/hash/76f1cfd7754a6e4fc3281bcccb3d0902-Abstract.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He etÂ al. (2021b)</span>
<span class="ltx_bibblock">
Pengcheng He, Xiaodong Liu, Jianfeng Gao, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Deberta: decoding-enhanced bert with disentangled attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net, 2021b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=XPZIaotutsD" title="">https://openreview.net/forum?id=XPZIaotutsD</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He etÂ al. (2024)</span>
<span class="ltx_bibblock">
Xiaoxin He, Xavier Bresson, Thomas Laurent, Adam Perold, Yann LeCun, and Bryan Hooi.

</span>
<span class="ltx_bibblock">Harnessing explanations: Llm-to-lm interpreter for enhanced text-attributed graph representation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">The Twelfth International Conference on Learning Representations, ICLR 2024, Vienna, Austria, May 7-11, 2024</em>. OpenReview.net, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=RXFVcynVe1" title="">https://openreview.net/forum?id=RXFVcynVe1</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu etÂ al. (2020)</span>
<span class="ltx_bibblock">
Weihua Hu, Matthias Fey, Marinka Zitnik, Yuxiao Dong, Hongyu Ren, Bowen Liu, Michele Catasta, and Jure Leskovec.

</span>
<span class="ltx_bibblock">Open graph benchmark: Datasets for machine learning on graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">CoRR</em>, abs/2005.00687, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2005.00687" title="">https://arxiv.org/abs/2005.00687</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang etÂ al. (2023)</span>
<span class="ltx_bibblock">
Jin Huang, Xingjian Zhang, Qiaozhu Mei, and Jiaqi Ma.

</span>
<span class="ltx_bibblock">Can llms effectively leverage graph structural information: When and why.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">CoRR</em>, abs/2309.16595, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2309.16595</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2309.16595" title="">https://doi.org/10.48550/arXiv.2309.16595</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard etÂ al. (2023)</span>
<span class="ltx_bibblock">
Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand Joulin, Sebastian Riedel, and Edouard Grave.

</span>
<span class="ltx_bibblock">Atlas: Few-shot learning with retrieval augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Journal of Machine Learning Research</em>, 24(251):1â€“43, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeh &amp; Widom (2003)</span>
<span class="ltx_bibblock">
Glen Jeh and Jennifer Widom.

</span>
<span class="ltx_bibblock">Scaling personalized web search.

</span>
<span class="ltx_bibblock">In GusztÃ¡v Hencsey, Bebo White, Yih-FarnÂ Robin Chen, LÃ¡szlÃ³ KovÃ¡cs, and Steve Lawrence (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the Twelfth International World Wide Web Conference, WWW 2003, Budapest, Hungary, May 20-24, 2003</em>, pp.Â  271â€“279. ACM, 2003.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/775152.775191</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/775152.775191" title="">https://doi.org/10.1145/775152.775191</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpukhin etÂ al. (2020)</span>
<span class="ltx_bibblock">
Vladimir Karpukhin, Barlas Oguz, Sewon Min, Patrick S.Â H. Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">Dense passage retrieval for open-domain question answering.

</span>
<span class="ltx_bibblock">In Bonnie Webber, Trevor Cohn, Yulan He, and Yang Liu (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing, EMNLP 2020, Online, November 16-20, 2020</em>, pp.Â  6769â€“6781. Association for Computational Linguistics, 2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/V1/2020.EMNLP-MAIN.550</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2020.emnlp-main.550" title="">https://doi.org/10.18653/v1/2020.emnlp-main.550</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kipf &amp; Welling (2017)</span>
<span class="ltx_bibblock">
ThomasÂ N. Kipf and Max Welling.

</span>
<span class="ltx_bibblock">Semi-supervised classification with graph convolutional networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">5th International Conference on Learning Representations, ICLR 2017, Toulon, France, April 24-26, 2017, Conference Track Proceedings</em>. OpenReview.net, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=SJU4ayYgl" title="">https://openreview.net/forum?id=SJU4ayYgl</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klicpera etÂ al. (2019)</span>
<span class="ltx_bibblock">
Johannes Klicpera, Aleksandar Bojchevski, and Stephan GÃ¼nnemann.

</span>
<span class="ltx_bibblock">Predict then propagate: Graph neural networks meet personalized pagerank.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</em>. OpenReview.net, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=H1gL-2A9Ym" title="">https://openreview.net/forum?id=H1gL-2A9Ym</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester etÂ al. (2021)</span>
<span class="ltx_bibblock">
Brian Lester, Rami Al-Rfou, and Noah Constant.

</span>
<span class="ltx_bibblock">The power of scale for parameter-efficient prompt tuning.

</span>
<span class="ltx_bibblock">In Marie-Francine Moens, Xuanjing Huang, Lucia Specia, and ScottÂ Wen-tau Yih (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing, EMNLP 2021, Virtual Event / Punta Cana, Dominican Republic, 7-11 November, 2021</em>, pp.Â  3045â€“3059. Association for Computational Linguistics, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/V1/2021.EMNLP-MAIN.243</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/2021.emnlp-main.243" title="">https://doi.org/10.18653/v1/2021.emnlp-main.243</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis etÂ al. (2020)</span>
<span class="ltx_bibblock">
Patrick S.Â H. Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich KÃ¼ttler, Mike Lewis, Wen-tau Yih, Tim RocktÃ¤schel, Sebastian Riedel, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive NLP tasks.

</span>
<span class="ltx_bibblock">In Hugo Larochelle, Marcâ€™Aurelio Ranzato, Raia Hadsell, Maria-Florina Balcan, and Hsuan-Tien Lin (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper/2020/hash/6b493230205f780e1bc26945df7481e5-Abstract.html" title="">https://proceedings.neurips.cc/paper/2020/hash/6b493230205f780e1bc26945df7481e5-Abstract.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al. (2021)</span>
<span class="ltx_bibblock">
Guohao Li, Matthias MÃ¼ller, Bernard Ghanem, and Vladlen Koltun.

</span>
<span class="ltx_bibblock">Training graph neural networks with 1000 layers.

</span>
<span class="ltx_bibblock">In Marina Meila and Tong Zhang (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 38th International Conference on Machine Learning, ICML 2021, 18-24 July 2021, Virtual Event</em>, volume 139 of <em class="ltx_emph ltx_font_italic" id="bib.bib33.2.2">Proceedings of Machine Learning Research</em>, pp.Â  6437â€“6449. PMLR, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://proceedings.mlr.press/v139/li21o.html" title="">http://proceedings.mlr.press/v139/li21o.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al. (2024a)</span>
<span class="ltx_bibblock">
Rui Li, Jiwei Li, Jiawei Han, and Guoyin Wang.

</span>
<span class="ltx_bibblock">Similarity-based neighbor selection for graph llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">CoRR</em>, abs/2402.03720, 2024a.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2402.03720</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2402.03720" title="">https://doi.org/10.48550/arXiv.2402.03720</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al. (2024b)</span>
<span class="ltx_bibblock">
Yuanchun Li, Hao Wen, Weijun Wang, Xiangyu Li, Yizhen Yuan, Guohong Liu, Jiacheng Liu, Wenxing Xu, Xiang Wang, YiÂ Sun, Rui Kong, Yile Wang, Hanfei Geng, Jian Luan, Xuefeng Jin, Zilong Ye, Guanjing Xiong, Fan Zhang, Xiang Li, Mengwei Xu, Zhijun Li, Peng Li, Yang Liu, Ya-Qin Zhang, and Yunxin Liu.

</span>
<span class="ltx_bibblock">Personal LLM agents: Insights and survey about the capability, efficiency and security.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">CoRR</em>, abs/2401.05459, 2024b.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2401.05459</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2401.05459" title="">https://doi.org/10.48550/arXiv.2401.05459</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luan etÂ al. (2022)</span>
<span class="ltx_bibblock">
Sitao Luan, Chenqing Hua, Qincheng Lu, Jiaqi Zhu, Mingde Zhao, Shuyuan Zhang, Xiao-Wen Chang, and Doina Precup.

</span>
<span class="ltx_bibblock">Revisiting heterophily for graph neural networks.

</span>
<span class="ltx_bibblock">In Sanmi Koyejo, S.Â Mohamed, A.Â Agarwal, Danielle Belgrave, K.Â Cho, and A.Â Oh (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Advances in Neural Information Processing Systems 35: Annual Conference on Neural Information Processing Systems 2022, NeurIPS 2022, New Orleans, LA, USA, November 28 - December 9, 2022</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://papers.nips.cc/paper_files/paper/2022/hash/092359ce5cf60a80e882378944bf1be4-Abstract-Conference.html" title="">http://papers.nips.cc/paper_files/paper/2022/hash/092359ce5cf60a80e882378944bf1be4-Abstract-Conference.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min etÂ al. (2022)</span>
<span class="ltx_bibblock">
Erxue Min, Runfa Chen, Yatao Bian, Tingyang Xu, Kangfei Zhao, Wenbing Huang, Peilin Zhao, Junzhou Huang, Sophia Ananiadou, and YuÂ Rong.

</span>
<span class="ltx_bibblock">Transformer for graphs: An overview from architecture perspective.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">CoRR</em>, abs/2202.08455, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2202.08455" title="">https://arxiv.org/abs/2202.08455</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mittal etÂ al. (2021)</span>
<span class="ltx_bibblock">
Gautam Mittal, JesseÂ H. Engel, Curtis Hawthorne, and Ian Simon.

</span>
<span class="ltx_bibblock">Symbolic music generation with diffusion models.

</span>
<span class="ltx_bibblock">In JinÂ Ha Lee, Alexander Lerch, Zhiyao Duan, Juhan Nam, Preeti Rao, Peter van Kranenburg, and Ajay Srinivasamurthy (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the 22nd International Society for Music Information Retrieval Conference, ISMIR 2021, Online, November 7-12, 2021</em>, pp.Â  468â€“475, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://archives.ismir.net/ismir2021/paper/000058.pdf" title="">https://archives.ismir.net/ismir2021/paper/000058.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Page (1999)</span>
<span class="ltx_bibblock">
Lawrence Page.

</span>
<span class="ltx_bibblock">The pagerank citation ranking: Bringing order to the web.

</span>
<span class="ltx_bibblock">Technical report, Technical Report, 1999.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin etÂ al. (2023)</span>
<span class="ltx_bibblock">
Yijian Qin, Xin Wang, Ziwei Zhang, and Wenwu Zhu.

</span>
<span class="ltx_bibblock">Disentangled representation learning with large language models for text-attributed graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">CoRR</em>, abs/2310.18152, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2310.18152</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2310.18152" title="">https://doi.org/10.48550/arXiv.2310.18152</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel etÂ al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and PeterÂ J. Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">J. Mach. Learn. Res.</em>, 21:140:1â€“140:67, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v21/20-074.html" title="">http://jmlr.org/papers/v21/20-074.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sen etÂ al. (2008)</span>
<span class="ltx_bibblock">
Prithviraj Sen, Galileo Namata, Mustafa Bilgic, Lise Getoor, Brian Gallagher, and Tina Eliassi-Rad.

</span>
<span class="ltx_bibblock">Collective classification in network data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">AI Mag.</em>, 29(3):93â€“106, 2008.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1609/AIMAG.V29I3.2157</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1609/aimag.v29i3.2157" title="">https://doi.org/10.1609/aimag.v29i3.2157</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi etÂ al. (2023)</span>
<span class="ltx_bibblock">
Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Rich James, Mike Lewis, Luke Zettlemoyer, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">REPLUG: retrieval-augmented black-box language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">CoRR</em>, abs/2301.12652, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2301.12652</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2301.12652" title="">https://doi.org/10.48550/arXiv.2301.12652</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Snell etÂ al. (2017)</span>
<span class="ltx_bibblock">
Jake Snell, Kevin Swersky, and Richard Zemel.

</span>
<span class="ltx_bibblock">Prototypical networks for few-shot learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan etÂ al. (2024)</span>
<span class="ltx_bibblock">
Yanchao Tan, Hang Lv, Xinyi Huang, Jiawei Zhang, Shiping Wang, and Carl Yang.

</span>
<span class="ltx_bibblock">Musegraph: Graph-oriented instruction tuning of large language models for generic graph mining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">CoRR</em>, abs/2403.04780, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2403.04780</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2403.04780" title="">https://doi.org/10.48550/arXiv.2403.04780</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang etÂ al. (2024)</span>
<span class="ltx_bibblock">
Jiabin Tang, Yuhao Yang, Wei Wei, Lei Shi, Lixin Su, Suqi Cheng, Dawei Yin, and Chao Huang.

</span>
<span class="ltx_bibblock">Graphgpt: Graph instruction tuning for large language models.

</span>
<span class="ltx_bibblock">In GraceÂ Hui Yang, Hongning Wang, Sam Han, Claudia Hauff, Guido Zuccon, and YiÂ Zhang (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval, SIGIR 2024, Washington DC, USA, July 14-18, 2024</em>, pp.Â  491â€“500. ACM, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3626772.3657775</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3626772.3657775" title="">https://doi.org/10.1145/3626772.3657775</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2023)</span>
<span class="ltx_bibblock">
Heng Wang, Shangbin Feng, Tianxing He, Zhaoxuan Tan, Xiaochuang Han, and Yulia Tsvetkov.

</span>
<span class="ltx_bibblock">Can language models solve graph problems in natural language?

</span>
<span class="ltx_bibblock">In Alice Oh, Tristan Naumann, Amir Globerson, Kate Saenko, Moritz Hardt, and Sergey Levine (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Advances in Neural Information Processing Systems 36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS 2023, New Orleans, LA, USA, December 10 - 16, 2023</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://papers.nips.cc/paper_files/paper/2023/hash/622afc4edf2824a1b6aaf5afe153fa93-Abstract-Conference.html" title="">http://papers.nips.cc/paper_files/paper/2023/hash/622afc4edf2824a1b6aaf5afe153fa93-Abstract-Conference.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al. (2024)</span>
<span class="ltx_bibblock">
Yanbang Wang, Hejie Cui, and JonÂ M. Kleinberg.

</span>
<span class="ltx_bibblock">Microstructures and accuracy of graph recall by large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">CoRR</em>, abs/2402.11821, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2402.11821</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2402.11821" title="">https://doi.org/10.48550/arXiv.2402.11821</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei etÂ al. (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Maarten Bosma, VincentÂ Y. Zhao, Kelvin Guu, AdamsÂ Wei Yu, Brian Lester, Nan Du, AndrewÂ M. Dai, and QuocÂ V. Le.

</span>
<span class="ltx_bibblock">Finetuned language models are zero-shot learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022</em>. OpenReview.net, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=gEZrGCozdqR" title="">https://openreview.net/forum?id=gEZrGCozdqR</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yasunaga etÂ al. (2023)</span>
<span class="ltx_bibblock">
Michihiro Yasunaga, Armen Aghajanyan, Weijia Shi, Richard James, Jure Leskovec, Percy Liang, Mike Lewis, Luke Zettlemoyer, and Wen-Tau Yih.

</span>
<span class="ltx_bibblock">Retrieval-augmented multimodal language modeling.

</span>
<span class="ltx_bibblock">In Andreas Krause, Emma Brunskill, Kyunghyun Cho, Barbara Engelhardt, Sivan Sabato, and Jonathan Scarlett (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">International Conference on Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</em>, volume 202 of <em class="ltx_emph ltx_font_italic" id="bib.bib50.2.2">Proceedings of Machine Learning Research</em>, pp.Â  39755â€“39769. PMLR, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v202/yasunaga23a.html" title="">https://proceedings.mlr.press/v202/yasunaga23a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye etÂ al. (2023)</span>
<span class="ltx_bibblock">
Ruosong Ye, Caiqi Zhang, Runhui Wang, Shuyuan Xu, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Natural language is all a graph needs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">CoRR</em>, abs/2308.07134, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2308.07134</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2308.07134" title="">https://doi.org/10.48550/arXiv.2308.07134</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu etÂ al. (2023)</span>
<span class="ltx_bibblock">
Wenhao Yu, Dan Iter, Shuohang Wang, Yichong Xu, Mingxuan Ju, Soumya Sanyal, Chenguang Zhu, Michael Zeng, and Meng Jiang.

</span>
<span class="ltx_bibblock">Generate rather than retrieve: Large language models are strong context generators.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">The Eleventh International Conference on Learning Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023</em>. OpenReview.net, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=fB0hRu9GZUS" title="">https://openreview.net/forum?id=fB0hRu9GZUS</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. (2024a)</span>
<span class="ltx_bibblock">
DelvinÂ Ce Zhang, Menglin Yang, Rex Ying, and HadyÂ W. Lauw.

</span>
<span class="ltx_bibblock">Text-attributed graph representation learning: Methods, applications, and challenges.

</span>
<span class="ltx_bibblock">In Tat-Seng Chua, Chong-Wah Ngo, RoyÂ Ka-Wei Lee, Ravi Kumar, and HadyÂ W. Lauw (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Companion Proceedings of the ACM on Web Conference 2024, WWW 2024, Singapore, Singapore, May 13-17, 2024</em>, pp.Â  1298â€“1301. ACM, 2024a.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3589335.3641255</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3589335.3641255" title="">https://doi.org/10.1145/3589335.3641255</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang (2023)</span>
<span class="ltx_bibblock">
Jiawei Zhang.

</span>
<span class="ltx_bibblock">Graph-toolformer: To empower llms with graph reasoning ability via prompt augmented by chatgpt.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">arXiv preprint arXiv:2304.11116</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al. (2024b)</span>
<span class="ltx_bibblock">
Zeyang Zhang, Xin Wang, Ziwei Zhang, Haoyang Li, Yijian Qin, and Wenwu Zhu.

</span>
<span class="ltx_bibblock">Llm4dyg: Can large language models solve spatial-temporal problems on dynamic graphs?

</span>
<span class="ltx_bibblock">In Ricardo Baeza-Yates and Francesco Bonchi (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, KDD 2024, Barcelona, Spain, August 25-29, 2024</em>, pp.Â  4350â€“4361. ACM, 2024b.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3637528.3671709</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3637528.3671709" title="">https://doi.org/10.1145/3637528.3671709</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao etÂ al. (2023a)</span>
<span class="ltx_bibblock">
Jianan Zhao, Meng Qu, Chaozhuo Li, Hao Yan, Qian Liu, Rui Li, Xing Xie, and Jian Tang.

</span>
<span class="ltx_bibblock">Learning on large-scale text-attributed graphs via variational inference.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">The Eleventh International Conference on Learning Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023</em>. OpenReview.net, 2023a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=q0nmYciuuZN" title="">https://openreview.net/forum?id=q0nmYciuuZN</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao etÂ al. (2023b)</span>
<span class="ltx_bibblock">
Jianan Zhao, LeÂ Zhuo, Yikang Shen, Meng Qu, Kai Liu, MichaelÂ M. Bronstein, Zhaocheng Zhu, and Jian Tang.

</span>
<span class="ltx_bibblock">Graphtext: Graph reasoning in text space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">CoRR</em>, abs/2310.01089, 2023b.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2310.01089</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.48550/arXiv.2310.01089" title="">https://doi.org/10.48550/arXiv.2310.01089</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Architecture and Training of the Graph Neural Network <math alttext="\psi" class="ltx_Math" display="inline" id="A1.1.m1.1"><semantics id="A1.1.m1.1b"><mi id="A1.1.m1.1.1" xref="A1.1.m1.1.1.cmml">Ïˆ</mi><annotation-xml encoding="MathML-Content" id="A1.1.m1.1c"><ci id="A1.1.m1.1.1.cmml" xref="A1.1.m1.1.1">ğœ“</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.1.m1.1d">\psi</annotation><annotation encoding="application/x-llamapun" id="A1.1.m1.1e">italic_Ïˆ</annotation></semantics></math>
</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.2">In our setting, semi-supervised node classification problem, <math alttext="\mathcal{V},\mathcal{E},\mathcal{T},\mathcal{Y}^{\mathrm{train}}" class="ltx_Math" display="inline" id="A1.p1.1.m1.4"><semantics id="A1.p1.1.m1.4a"><mrow id="A1.p1.1.m1.4.4.1" xref="A1.p1.1.m1.4.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">ğ’±</mi><mo id="A1.p1.1.m1.4.4.1.2" xref="A1.p1.1.m1.4.4.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.p1.1.m1.2.2" xref="A1.p1.1.m1.2.2.cmml">â„°</mi><mo id="A1.p1.1.m1.4.4.1.3" xref="A1.p1.1.m1.4.4.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.p1.1.m1.3.3" xref="A1.p1.1.m1.3.3.cmml">ğ’¯</mi><mo id="A1.p1.1.m1.4.4.1.4" xref="A1.p1.1.m1.4.4.2.cmml">,</mo><msup id="A1.p1.1.m1.4.4.1.1" xref="A1.p1.1.m1.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.1.m1.4.4.1.1.2" xref="A1.p1.1.m1.4.4.1.1.2.cmml">ğ’´</mi><mi id="A1.p1.1.m1.4.4.1.1.3" xref="A1.p1.1.m1.4.4.1.1.3.cmml">train</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.4b"><list id="A1.p1.1.m1.4.4.2.cmml" xref="A1.p1.1.m1.4.4.1"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">ğ’±</ci><ci id="A1.p1.1.m1.2.2.cmml" xref="A1.p1.1.m1.2.2">â„°</ci><ci id="A1.p1.1.m1.3.3.cmml" xref="A1.p1.1.m1.3.3">ğ’¯</ci><apply id="A1.p1.1.m1.4.4.1.1.cmml" xref="A1.p1.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.4.4.1.1.1.cmml" xref="A1.p1.1.m1.4.4.1.1">superscript</csymbol><ci id="A1.p1.1.m1.4.4.1.1.2.cmml" xref="A1.p1.1.m1.4.4.1.1.2">ğ’´</ci><ci id="A1.p1.1.m1.4.4.1.1.3.cmml" xref="A1.p1.1.m1.4.4.1.1.3">train</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.4c">\mathcal{V},\mathcal{E},\mathcal{T},\mathcal{Y}^{\mathrm{train}}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.4d">caligraphic_V , caligraphic_E , caligraphic_T , caligraphic_Y start_POSTSUPERSCRIPT roman_train end_POSTSUPERSCRIPT</annotation></semantics></math> are available during training. Since Graph Neural Networks (GNNs) are not inherently capable of processing textual features, we employ a pretrained text encoder to generate <math alttext="d" class="ltx_Math" display="inline" id="A1.p1.2.m2.1"><semantics id="A1.p1.2.m2.1a"><mi id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><ci id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">italic_d</annotation></semantics></math>-dimensional dense embeddings for each node</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx15">
<tbody id="A1.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{Encoder}_{\psi_{1}}(t_{i})=\mathbf{h}^{(0)}_{i}\in\mathbb%
{R}^{d},\forall i\in{1,\dots,n}" class="ltx_Math" display="inline" id="A1.E15.m1.6"><semantics id="A1.E15.m1.6a"><mrow id="A1.E15.m1.6.6.2" xref="A1.E15.m1.6.6.3.cmml"><mrow id="A1.E15.m1.5.5.1.1" xref="A1.E15.m1.5.5.1.1.cmml"><mrow id="A1.E15.m1.5.5.1.1.1" xref="A1.E15.m1.5.5.1.1.1.cmml"><msub id="A1.E15.m1.5.5.1.1.1.3" xref="A1.E15.m1.5.5.1.1.1.3.cmml"><mi id="A1.E15.m1.5.5.1.1.1.3.2" xref="A1.E15.m1.5.5.1.1.1.3.2.cmml">Encoder</mi><msub id="A1.E15.m1.5.5.1.1.1.3.3" xref="A1.E15.m1.5.5.1.1.1.3.3.cmml"><mi id="A1.E15.m1.5.5.1.1.1.3.3.2" xref="A1.E15.m1.5.5.1.1.1.3.3.2.cmml">Ïˆ</mi><mn id="A1.E15.m1.5.5.1.1.1.3.3.3" xref="A1.E15.m1.5.5.1.1.1.3.3.3.cmml">1</mn></msub></msub><mo id="A1.E15.m1.5.5.1.1.1.2" xref="A1.E15.m1.5.5.1.1.1.2.cmml">â¢</mo><mrow id="A1.E15.m1.5.5.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A1.E15.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E15.m1.5.5.1.1.1.1.1.1" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml"><mi id="A1.E15.m1.5.5.1.1.1.1.1.1.2" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2.cmml">t</mi><mi id="A1.E15.m1.5.5.1.1.1.1.1.1.3" xref="A1.E15.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E15.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="A1.E15.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E15.m1.5.5.1.1.3" xref="A1.E15.m1.5.5.1.1.3.cmml">=</mo><msubsup id="A1.E15.m1.5.5.1.1.4" xref="A1.E15.m1.5.5.1.1.4.cmml"><mi id="A1.E15.m1.5.5.1.1.4.2.2" xref="A1.E15.m1.5.5.1.1.4.2.2.cmml">ğ¡</mi><mi id="A1.E15.m1.5.5.1.1.4.3" xref="A1.E15.m1.5.5.1.1.4.3.cmml">i</mi><mrow id="A1.E15.m1.1.1.1.3" xref="A1.E15.m1.5.5.1.1.4.cmml"><mo id="A1.E15.m1.1.1.1.3.1" stretchy="false" xref="A1.E15.m1.5.5.1.1.4.cmml">(</mo><mn id="A1.E15.m1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.cmml">0</mn><mo id="A1.E15.m1.1.1.1.3.2" stretchy="false" xref="A1.E15.m1.5.5.1.1.4.cmml">)</mo></mrow></msubsup><mo id="A1.E15.m1.5.5.1.1.5" xref="A1.E15.m1.5.5.1.1.5.cmml">âˆˆ</mo><msup id="A1.E15.m1.5.5.1.1.6" xref="A1.E15.m1.5.5.1.1.6.cmml"><mi id="A1.E15.m1.5.5.1.1.6.2" xref="A1.E15.m1.5.5.1.1.6.2.cmml">â„</mi><mi id="A1.E15.m1.5.5.1.1.6.3" xref="A1.E15.m1.5.5.1.1.6.3.cmml">d</mi></msup></mrow><mo id="A1.E15.m1.6.6.2.3" xref="A1.E15.m1.6.6.3a.cmml">,</mo><mrow id="A1.E15.m1.6.6.2.2" xref="A1.E15.m1.6.6.2.2.cmml"><mrow id="A1.E15.m1.6.6.2.2.2" xref="A1.E15.m1.6.6.2.2.2.cmml"><mo id="A1.E15.m1.6.6.2.2.2.1" rspace="0.167em" xref="A1.E15.m1.6.6.2.2.2.1.cmml">âˆ€</mo><mi id="A1.E15.m1.6.6.2.2.2.2" xref="A1.E15.m1.6.6.2.2.2.2.cmml">i</mi></mrow><mo id="A1.E15.m1.6.6.2.2.1" xref="A1.E15.m1.6.6.2.2.1.cmml">âˆˆ</mo><mrow id="A1.E15.m1.6.6.2.2.3.2" xref="A1.E15.m1.6.6.2.2.3.1.cmml"><mn id="A1.E15.m1.2.2" xref="A1.E15.m1.2.2.cmml">1</mn><mo id="A1.E15.m1.6.6.2.2.3.2.1" xref="A1.E15.m1.6.6.2.2.3.1.cmml">,</mo><mi id="A1.E15.m1.3.3" mathvariant="normal" xref="A1.E15.m1.3.3.cmml">â€¦</mi><mo id="A1.E15.m1.6.6.2.2.3.2.2" xref="A1.E15.m1.6.6.2.2.3.1.cmml">,</mo><mi id="A1.E15.m1.4.4" xref="A1.E15.m1.4.4.cmml">n</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15.m1.6b"><apply id="A1.E15.m1.6.6.3.cmml" xref="A1.E15.m1.6.6.2"><csymbol cd="ambiguous" id="A1.E15.m1.6.6.3a.cmml" xref="A1.E15.m1.6.6.2.3">formulae-sequence</csymbol><apply id="A1.E15.m1.5.5.1.1.cmml" xref="A1.E15.m1.5.5.1.1"><and id="A1.E15.m1.5.5.1.1a.cmml" xref="A1.E15.m1.5.5.1.1"></and><apply id="A1.E15.m1.5.5.1.1b.cmml" xref="A1.E15.m1.5.5.1.1"><eq id="A1.E15.m1.5.5.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.3"></eq><apply id="A1.E15.m1.5.5.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1"><times id="A1.E15.m1.5.5.1.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.1.2"></times><apply id="A1.E15.m1.5.5.1.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.1.3.1.cmml" xref="A1.E15.m1.5.5.1.1.1.3">subscript</csymbol><ci id="A1.E15.m1.5.5.1.1.1.3.2.cmml" xref="A1.E15.m1.5.5.1.1.1.3.2">Encoder</ci><apply id="A1.E15.m1.5.5.1.1.1.3.3.cmml" xref="A1.E15.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.1.3.3.1.cmml" xref="A1.E15.m1.5.5.1.1.1.3.3">subscript</csymbol><ci id="A1.E15.m1.5.5.1.1.1.3.3.2.cmml" xref="A1.E15.m1.5.5.1.1.1.3.3.2">ğœ“</ci><cn id="A1.E15.m1.5.5.1.1.1.3.3.3.cmml" type="integer" xref="A1.E15.m1.5.5.1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E15.m1.5.5.1.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="A1.E15.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A1.E15.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.5.5.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="A1.E15.m1.5.5.1.1.4.cmml" xref="A1.E15.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.4.1.cmml" xref="A1.E15.m1.5.5.1.1.4">subscript</csymbol><apply id="A1.E15.m1.5.5.1.1.4.2.cmml" xref="A1.E15.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.4.2.1.cmml" xref="A1.E15.m1.5.5.1.1.4">superscript</csymbol><ci id="A1.E15.m1.5.5.1.1.4.2.2.cmml" xref="A1.E15.m1.5.5.1.1.4.2.2">ğ¡</ci><cn id="A1.E15.m1.1.1.1.1.cmml" type="integer" xref="A1.E15.m1.1.1.1.1">0</cn></apply><ci id="A1.E15.m1.5.5.1.1.4.3.cmml" xref="A1.E15.m1.5.5.1.1.4.3">ğ‘–</ci></apply></apply><apply id="A1.E15.m1.5.5.1.1c.cmml" xref="A1.E15.m1.5.5.1.1"><in id="A1.E15.m1.5.5.1.1.5.cmml" xref="A1.E15.m1.5.5.1.1.5"></in><share href="https://arxiv.org/html/2410.02296v1#A1.E15.m1.5.5.1.1.4.cmml" id="A1.E15.m1.5.5.1.1d.cmml" xref="A1.E15.m1.5.5.1.1"></share><apply id="A1.E15.m1.5.5.1.1.6.cmml" xref="A1.E15.m1.5.5.1.1.6"><csymbol cd="ambiguous" id="A1.E15.m1.5.5.1.1.6.1.cmml" xref="A1.E15.m1.5.5.1.1.6">superscript</csymbol><ci id="A1.E15.m1.5.5.1.1.6.2.cmml" xref="A1.E15.m1.5.5.1.1.6.2">â„</ci><ci id="A1.E15.m1.5.5.1.1.6.3.cmml" xref="A1.E15.m1.5.5.1.1.6.3">ğ‘‘</ci></apply></apply></apply><apply id="A1.E15.m1.6.6.2.2.cmml" xref="A1.E15.m1.6.6.2.2"><in id="A1.E15.m1.6.6.2.2.1.cmml" xref="A1.E15.m1.6.6.2.2.1"></in><apply id="A1.E15.m1.6.6.2.2.2.cmml" xref="A1.E15.m1.6.6.2.2.2"><csymbol cd="latexml" id="A1.E15.m1.6.6.2.2.2.1.cmml" xref="A1.E15.m1.6.6.2.2.2.1">for-all</csymbol><ci id="A1.E15.m1.6.6.2.2.2.2.cmml" xref="A1.E15.m1.6.6.2.2.2.2">ğ‘–</ci></apply><list id="A1.E15.m1.6.6.2.2.3.1.cmml" xref="A1.E15.m1.6.6.2.2.3.2"><cn id="A1.E15.m1.2.2.cmml" type="integer" xref="A1.E15.m1.2.2">1</cn><ci id="A1.E15.m1.3.3.cmml" xref="A1.E15.m1.3.3">â€¦</ci><ci id="A1.E15.m1.4.4.cmml" xref="A1.E15.m1.4.4">ğ‘›</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.6c">\displaystyle\mathrm{Encoder}_{\psi_{1}}(t_{i})=\mathbf{h}^{(0)}_{i}\in\mathbb%
{R}^{d},\forall i\in{1,\dots,n}</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.6d">roman_Encoder start_POSTSUBSCRIPT italic_Ïˆ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = bold_h start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT , âˆ€ italic_i âˆˆ 1 , â€¦ , italic_n</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p1.13">Subsequently, we apply a standard graph neural network. For this study, we adopt GraphSAGEÂ <cite class="ltx_cite ltx_citemacro_citep">(Hamilton etÂ al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib19" title="">2017</a>)</cite> whose iterative architecture is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx16">
<tbody id="A1.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h}^{(l)}_{i}\leftarrow\sigma^{(l)}\Big{(}\mathrm{MEAN}%
\Big{(}\{\mathbf{h}^{(l-1)}_{i}\}\cup\{\mathbf{h}^{(l-1)}_{j}:(v_{i},v_{j})\in%
\mathcal{E}\}\Big{)}\cdot\mathbf{W}^{(l)}\Big{)}" class="ltx_Math" display="inline" id="A1.E16.m1.6"><semantics id="A1.E16.m1.6a"><mrow id="A1.E16.m1.6.6" xref="A1.E16.m1.6.6.cmml"><msubsup id="A1.E16.m1.6.6.3" xref="A1.E16.m1.6.6.3.cmml"><mi id="A1.E16.m1.6.6.3.2.2" xref="A1.E16.m1.6.6.3.2.2.cmml">ğ¡</mi><mi id="A1.E16.m1.6.6.3.3" xref="A1.E16.m1.6.6.3.3.cmml">i</mi><mrow id="A1.E16.m1.1.1.1.3" xref="A1.E16.m1.6.6.3.cmml"><mo id="A1.E16.m1.1.1.1.3.1" stretchy="false" xref="A1.E16.m1.6.6.3.cmml">(</mo><mi id="A1.E16.m1.1.1.1.1" xref="A1.E16.m1.1.1.1.1.cmml">l</mi><mo id="A1.E16.m1.1.1.1.3.2" stretchy="false" xref="A1.E16.m1.6.6.3.cmml">)</mo></mrow></msubsup><mo id="A1.E16.m1.6.6.2" stretchy="false" xref="A1.E16.m1.6.6.2.cmml">â†</mo><mrow id="A1.E16.m1.6.6.1" xref="A1.E16.m1.6.6.1.cmml"><msup id="A1.E16.m1.6.6.1.3" xref="A1.E16.m1.6.6.1.3.cmml"><mi id="A1.E16.m1.6.6.1.3.2" xref="A1.E16.m1.6.6.1.3.2.cmml">Ïƒ</mi><mrow id="A1.E16.m1.2.2.1.3" xref="A1.E16.m1.6.6.1.3.cmml"><mo id="A1.E16.m1.2.2.1.3.1" stretchy="false" xref="A1.E16.m1.6.6.1.3.cmml">(</mo><mi id="A1.E16.m1.2.2.1.1" xref="A1.E16.m1.2.2.1.1.cmml">l</mi><mo id="A1.E16.m1.2.2.1.3.2" stretchy="false" xref="A1.E16.m1.6.6.1.3.cmml">)</mo></mrow></msup><mo id="A1.E16.m1.6.6.1.2" xref="A1.E16.m1.6.6.1.2.cmml">â¢</mo><mrow id="A1.E16.m1.6.6.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.cmml"><mo id="A1.E16.m1.6.6.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.E16.m1.6.6.1.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.6.6.1.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.cmml"><mrow id="A1.E16.m1.6.6.1.1.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.1.cmml"><mi id="A1.E16.m1.6.6.1.1.1.1.1.3" xref="A1.E16.m1.6.6.1.1.1.1.1.3.cmml">MEAN</mi><mo id="A1.E16.m1.6.6.1.1.1.1.1.2" xref="A1.E16.m1.6.6.1.1.1.1.1.2.cmml">â¢</mo><mrow id="A1.E16.m1.6.6.1.1.1.1.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">ğ¡</mi><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="A1.E16.m1.3.3.1.1" xref="A1.E16.m1.3.3.1.1.1.cmml"><mo id="A1.E16.m1.3.3.1.1.2" stretchy="false" xref="A1.E16.m1.3.3.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.3.3.1.1.1" xref="A1.E16.m1.3.3.1.1.1.cmml"><mi id="A1.E16.m1.3.3.1.1.1.2" xref="A1.E16.m1.3.3.1.1.1.2.cmml">l</mi><mo id="A1.E16.m1.3.3.1.1.1.1" xref="A1.E16.m1.3.3.1.1.1.1.cmml">âˆ’</mo><mn id="A1.E16.m1.3.3.1.1.1.3" xref="A1.E16.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="A1.E16.m1.3.3.1.1.3" stretchy="false" xref="A1.E16.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.4" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.4.cmml">âˆª</mo><mrow id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.3.1.cmml">{</mo><msubsup id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.cmml"><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.2.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml">ğ¡</mi><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.3" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.3.cmml">j</mi><mrow id="A1.E16.m1.4.4.1.1" xref="A1.E16.m1.4.4.1.1.1.cmml"><mo id="A1.E16.m1.4.4.1.1.2" stretchy="false" xref="A1.E16.m1.4.4.1.1.1.cmml">(</mo><mrow id="A1.E16.m1.4.4.1.1.1" xref="A1.E16.m1.4.4.1.1.1.cmml"><mi id="A1.E16.m1.4.4.1.1.1.2" xref="A1.E16.m1.4.4.1.1.1.2.cmml">l</mi><mo id="A1.E16.m1.4.4.1.1.1.1" xref="A1.E16.m1.4.4.1.1.1.1.cmml">âˆ’</mo><mn id="A1.E16.m1.4.4.1.1.1.3" xref="A1.E16.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="A1.E16.m1.4.4.1.1.3" stretchy="false" xref="A1.E16.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.4" lspace="0.278em" rspace="0.278em" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.3.1.cmml">:</mo><mrow id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.cmml"><mrow id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml"><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.3" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml">(</mo><msub id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.cmml"><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.2.cmml">v</mi><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.3" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.3.cmml">i</mi></msub><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.4" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml">,</mo><msub id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.cmml"><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.2" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.2.cmml">v</mi><mi id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.3" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.3.cmml">j</mi></msub><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.5" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml">)</mo></mrow><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.3" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.3.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.4" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.4.cmml">â„°</mi></mrow><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.5" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.3.1.cmml">}</mo></mrow></mrow><mo id="A1.E16.m1.6.6.1.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" rspace="0.055em" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E16.m1.6.6.1.1.1.1.2" rspace="0.222em" xref="A1.E16.m1.6.6.1.1.1.1.2.cmml">â‹…</mo><msup id="A1.E16.m1.6.6.1.1.1.1.3" xref="A1.E16.m1.6.6.1.1.1.1.3.cmml"><mi id="A1.E16.m1.6.6.1.1.1.1.3.2" xref="A1.E16.m1.6.6.1.1.1.1.3.2.cmml">ğ–</mi><mrow id="A1.E16.m1.5.5.1.3" xref="A1.E16.m1.6.6.1.1.1.1.3.cmml"><mo id="A1.E16.m1.5.5.1.3.1" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.3.cmml">(</mo><mi id="A1.E16.m1.5.5.1.1" xref="A1.E16.m1.5.5.1.1.cmml">l</mi><mo id="A1.E16.m1.5.5.1.3.2" stretchy="false" xref="A1.E16.m1.6.6.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="A1.E16.m1.6.6.1.1.1.3" maxsize="160%" minsize="160%" xref="A1.E16.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16.m1.6b"><apply id="A1.E16.m1.6.6.cmml" xref="A1.E16.m1.6.6"><ci id="A1.E16.m1.6.6.2.cmml" xref="A1.E16.m1.6.6.2">â†</ci><apply id="A1.E16.m1.6.6.3.cmml" xref="A1.E16.m1.6.6.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.3.1.cmml" xref="A1.E16.m1.6.6.3">subscript</csymbol><apply id="A1.E16.m1.6.6.3.2.cmml" xref="A1.E16.m1.6.6.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.3.2.1.cmml" xref="A1.E16.m1.6.6.3">superscript</csymbol><ci id="A1.E16.m1.6.6.3.2.2.cmml" xref="A1.E16.m1.6.6.3.2.2">ğ¡</ci><ci id="A1.E16.m1.1.1.1.1.cmml" xref="A1.E16.m1.1.1.1.1">ğ‘™</ci></apply><ci id="A1.E16.m1.6.6.3.3.cmml" xref="A1.E16.m1.6.6.3.3">ğ‘–</ci></apply><apply id="A1.E16.m1.6.6.1.cmml" xref="A1.E16.m1.6.6.1"><times id="A1.E16.m1.6.6.1.2.cmml" xref="A1.E16.m1.6.6.1.2"></times><apply id="A1.E16.m1.6.6.1.3.cmml" xref="A1.E16.m1.6.6.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.3.1.cmml" xref="A1.E16.m1.6.6.1.3">superscript</csymbol><ci id="A1.E16.m1.6.6.1.3.2.cmml" xref="A1.E16.m1.6.6.1.3.2">ğœ</ci><ci id="A1.E16.m1.2.2.1.1.cmml" xref="A1.E16.m1.2.2.1.1">ğ‘™</ci></apply><apply id="A1.E16.m1.6.6.1.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1"><ci id="A1.E16.m1.6.6.1.1.1.1.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.2">â‹…</ci><apply id="A1.E16.m1.6.6.1.1.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1"><times id="A1.E16.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.2"></times><ci id="A1.E16.m1.6.6.1.1.1.1.1.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.3">MEAN</ci><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1"><union id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.4"></union><set id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1"><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2">ğ¡</ci><apply id="A1.E16.m1.3.3.1.1.1.cmml" xref="A1.E16.m1.3.3.1.1"><minus id="A1.E16.m1.3.3.1.1.1.1.cmml" xref="A1.E16.m1.3.3.1.1.1.1"></minus><ci id="A1.E16.m1.3.3.1.1.1.2.cmml" xref="A1.E16.m1.3.3.1.1.1.2">ğ‘™</ci><cn id="A1.E16.m1.3.3.1.1.1.3.cmml" type="integer" xref="A1.E16.m1.3.3.1.1.1.3">1</cn></apply></apply><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply></set><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2"><csymbol cd="latexml" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.3">conditional-set</csymbol><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1">superscript</csymbol><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.2.2">ğ¡</ci><apply id="A1.E16.m1.4.4.1.1.1.cmml" xref="A1.E16.m1.4.4.1.1"><minus id="A1.E16.m1.4.4.1.1.1.1.cmml" xref="A1.E16.m1.4.4.1.1.1.1"></minus><ci id="A1.E16.m1.4.4.1.1.1.2.cmml" xref="A1.E16.m1.4.4.1.1.1.2">ğ‘™</ci><cn id="A1.E16.m1.4.4.1.1.1.3.cmml" type="integer" xref="A1.E16.m1.4.4.1.1.1.3">1</cn></apply></apply><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.2.1.1.3">ğ‘—</ci></apply><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2"><in id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.3"></in><interval closure="open" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2"><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1">subscript</csymbol><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.2">ğ‘£</ci><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.1.1.1.3">ğ‘–</ci></apply><apply id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2">subscript</csymbol><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.2">ğ‘£</ci><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.2.2.2.3">ğ‘—</ci></apply></interval><ci id="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.4.cmml" xref="A1.E16.m1.6.6.1.1.1.1.1.1.1.1.3.2.2.4">â„°</ci></apply></apply></apply></apply><apply id="A1.E16.m1.6.6.1.1.1.1.3.cmml" xref="A1.E16.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E16.m1.6.6.1.1.1.1.3.1.cmml" xref="A1.E16.m1.6.6.1.1.1.1.3">superscript</csymbol><ci id="A1.E16.m1.6.6.1.1.1.1.3.2.cmml" xref="A1.E16.m1.6.6.1.1.1.1.3.2">ğ–</ci><ci id="A1.E16.m1.5.5.1.1.cmml" xref="A1.E16.m1.5.5.1.1">ğ‘™</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16.m1.6c">\displaystyle\mathbf{h}^{(l)}_{i}\leftarrow\sigma^{(l)}\Big{(}\mathrm{MEAN}%
\Big{(}\{\mathbf{h}^{(l-1)}_{i}\}\cup\{\mathbf{h}^{(l-1)}_{j}:(v_{i},v_{j})\in%
\mathcal{E}\}\Big{)}\cdot\mathbf{W}^{(l)}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="A1.E16.m1.6d">bold_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â† italic_Ïƒ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ( roman_MEAN ( { bold_h start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } âˆª { bold_h start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT : ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) âˆˆ caligraphic_E } ) â‹… bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p1.12">where <math alttext="\sigma^{(l)}" class="ltx_Math" display="inline" id="A1.p1.3.m1.1"><semantics id="A1.p1.3.m1.1a"><msup id="A1.p1.3.m1.1.2" xref="A1.p1.3.m1.1.2.cmml"><mi id="A1.p1.3.m1.1.2.2" xref="A1.p1.3.m1.1.2.2.cmml">Ïƒ</mi><mrow id="A1.p1.3.m1.1.1.1.3" xref="A1.p1.3.m1.1.2.cmml"><mo id="A1.p1.3.m1.1.1.1.3.1" stretchy="false" xref="A1.p1.3.m1.1.2.cmml">(</mo><mi id="A1.p1.3.m1.1.1.1.1" xref="A1.p1.3.m1.1.1.1.1.cmml">l</mi><mo id="A1.p1.3.m1.1.1.1.3.2" stretchy="false" xref="A1.p1.3.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.p1.3.m1.1b"><apply id="A1.p1.3.m1.1.2.cmml" xref="A1.p1.3.m1.1.2"><csymbol cd="ambiguous" id="A1.p1.3.m1.1.2.1.cmml" xref="A1.p1.3.m1.1.2">superscript</csymbol><ci id="A1.p1.3.m1.1.2.2.cmml" xref="A1.p1.3.m1.1.2.2">ğœ</ci><ci id="A1.p1.3.m1.1.1.1.1.cmml" xref="A1.p1.3.m1.1.1.1.1">ğ‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m1.1c">\sigma^{(l)}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m1.1d">italic_Ïƒ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the activation function and <math alttext="\mathbf{W}^{(l)}" class="ltx_Math" display="inline" id="A1.p1.4.m2.1"><semantics id="A1.p1.4.m2.1a"><msup id="A1.p1.4.m2.1.2" xref="A1.p1.4.m2.1.2.cmml"><mi id="A1.p1.4.m2.1.2.2" xref="A1.p1.4.m2.1.2.2.cmml">ğ–</mi><mrow id="A1.p1.4.m2.1.1.1.3" xref="A1.p1.4.m2.1.2.cmml"><mo id="A1.p1.4.m2.1.1.1.3.1" stretchy="false" xref="A1.p1.4.m2.1.2.cmml">(</mo><mi id="A1.p1.4.m2.1.1.1.1" xref="A1.p1.4.m2.1.1.1.1.cmml">l</mi><mo id="A1.p1.4.m2.1.1.1.3.2" stretchy="false" xref="A1.p1.4.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.p1.4.m2.1b"><apply id="A1.p1.4.m2.1.2.cmml" xref="A1.p1.4.m2.1.2"><csymbol cd="ambiguous" id="A1.p1.4.m2.1.2.1.cmml" xref="A1.p1.4.m2.1.2">superscript</csymbol><ci id="A1.p1.4.m2.1.2.2.cmml" xref="A1.p1.4.m2.1.2.2">ğ–</ci><ci id="A1.p1.4.m2.1.1.1.1.cmml" xref="A1.p1.4.m2.1.1.1.1">ğ‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m2.1c">\mathbf{W}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.4.m2.1d">bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the learnable parameter of each layer. For an <math alttext="L" class="ltx_Math" display="inline" id="A1.p1.5.m3.1"><semantics id="A1.p1.5.m3.1a"><mi id="A1.p1.5.m3.1.1" xref="A1.p1.5.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A1.p1.5.m3.1b"><ci id="A1.p1.5.m3.1.1.cmml" xref="A1.p1.5.m3.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="A1.p1.5.m3.1d">italic_L</annotation></semantics></math>-layed network, in the last layer, <math alttext="\sigma^{(L)}" class="ltx_Math" display="inline" id="A1.p1.6.m4.1"><semantics id="A1.p1.6.m4.1a"><msup id="A1.p1.6.m4.1.2" xref="A1.p1.6.m4.1.2.cmml"><mi id="A1.p1.6.m4.1.2.2" xref="A1.p1.6.m4.1.2.2.cmml">Ïƒ</mi><mrow id="A1.p1.6.m4.1.1.1.3" xref="A1.p1.6.m4.1.2.cmml"><mo id="A1.p1.6.m4.1.1.1.3.1" stretchy="false" xref="A1.p1.6.m4.1.2.cmml">(</mo><mi id="A1.p1.6.m4.1.1.1.1" xref="A1.p1.6.m4.1.1.1.1.cmml">L</mi><mo id="A1.p1.6.m4.1.1.1.3.2" stretchy="false" xref="A1.p1.6.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.p1.6.m4.1b"><apply id="A1.p1.6.m4.1.2.cmml" xref="A1.p1.6.m4.1.2"><csymbol cd="ambiguous" id="A1.p1.6.m4.1.2.1.cmml" xref="A1.p1.6.m4.1.2">superscript</csymbol><ci id="A1.p1.6.m4.1.2.2.cmml" xref="A1.p1.6.m4.1.2.2">ğœ</ci><ci id="A1.p1.6.m4.1.1.1.1.cmml" xref="A1.p1.6.m4.1.1.1.1">ğ¿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m4.1c">\sigma^{(L)}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.6.m4.1d">italic_Ïƒ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math> is selected as <math alttext="\mathrm{Softmax}" class="ltx_Math" display="inline" id="A1.p1.7.m5.1"><semantics id="A1.p1.7.m5.1a"><mi id="A1.p1.7.m5.1.1" xref="A1.p1.7.m5.1.1.cmml">Softmax</mi><annotation-xml encoding="MathML-Content" id="A1.p1.7.m5.1b"><ci id="A1.p1.7.m5.1.1.cmml" xref="A1.p1.7.m5.1.1">Softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m5.1c">\mathrm{Softmax}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.7.m5.1d">roman_Softmax</annotation></semantics></math> and <math alttext="\mathbf{W}^{(L)}\in\mathbb{R}^{d\times c}" class="ltx_Math" display="inline" id="A1.p1.8.m6.1"><semantics id="A1.p1.8.m6.1a"><mrow id="A1.p1.8.m6.1.2" xref="A1.p1.8.m6.1.2.cmml"><msup id="A1.p1.8.m6.1.2.2" xref="A1.p1.8.m6.1.2.2.cmml"><mi id="A1.p1.8.m6.1.2.2.2" xref="A1.p1.8.m6.1.2.2.2.cmml">ğ–</mi><mrow id="A1.p1.8.m6.1.1.1.3" xref="A1.p1.8.m6.1.2.2.cmml"><mo id="A1.p1.8.m6.1.1.1.3.1" stretchy="false" xref="A1.p1.8.m6.1.2.2.cmml">(</mo><mi id="A1.p1.8.m6.1.1.1.1" xref="A1.p1.8.m6.1.1.1.1.cmml">L</mi><mo id="A1.p1.8.m6.1.1.1.3.2" stretchy="false" xref="A1.p1.8.m6.1.2.2.cmml">)</mo></mrow></msup><mo id="A1.p1.8.m6.1.2.1" xref="A1.p1.8.m6.1.2.1.cmml">âˆˆ</mo><msup id="A1.p1.8.m6.1.2.3" xref="A1.p1.8.m6.1.2.3.cmml"><mi id="A1.p1.8.m6.1.2.3.2" xref="A1.p1.8.m6.1.2.3.2.cmml">â„</mi><mrow id="A1.p1.8.m6.1.2.3.3" xref="A1.p1.8.m6.1.2.3.3.cmml"><mi id="A1.p1.8.m6.1.2.3.3.2" xref="A1.p1.8.m6.1.2.3.3.2.cmml">d</mi><mo id="A1.p1.8.m6.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.p1.8.m6.1.2.3.3.1.cmml">Ã—</mo><mi id="A1.p1.8.m6.1.2.3.3.3" xref="A1.p1.8.m6.1.2.3.3.3.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.8.m6.1b"><apply id="A1.p1.8.m6.1.2.cmml" xref="A1.p1.8.m6.1.2"><in id="A1.p1.8.m6.1.2.1.cmml" xref="A1.p1.8.m6.1.2.1"></in><apply id="A1.p1.8.m6.1.2.2.cmml" xref="A1.p1.8.m6.1.2.2"><csymbol cd="ambiguous" id="A1.p1.8.m6.1.2.2.1.cmml" xref="A1.p1.8.m6.1.2.2">superscript</csymbol><ci id="A1.p1.8.m6.1.2.2.2.cmml" xref="A1.p1.8.m6.1.2.2.2">ğ–</ci><ci id="A1.p1.8.m6.1.1.1.1.cmml" xref="A1.p1.8.m6.1.1.1.1">ğ¿</ci></apply><apply id="A1.p1.8.m6.1.2.3.cmml" xref="A1.p1.8.m6.1.2.3"><csymbol cd="ambiguous" id="A1.p1.8.m6.1.2.3.1.cmml" xref="A1.p1.8.m6.1.2.3">superscript</csymbol><ci id="A1.p1.8.m6.1.2.3.2.cmml" xref="A1.p1.8.m6.1.2.3.2">â„</ci><apply id="A1.p1.8.m6.1.2.3.3.cmml" xref="A1.p1.8.m6.1.2.3.3"><times id="A1.p1.8.m6.1.2.3.3.1.cmml" xref="A1.p1.8.m6.1.2.3.3.1"></times><ci id="A1.p1.8.m6.1.2.3.3.2.cmml" xref="A1.p1.8.m6.1.2.3.3.2">ğ‘‘</ci><ci id="A1.p1.8.m6.1.2.3.3.3.cmml" xref="A1.p1.8.m6.1.2.3.3.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m6.1c">\mathbf{W}^{(L)}\in\mathbb{R}^{d\times c}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.8.m6.1d">bold_W start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_d Ã— italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> resulting in <math alttext="\mathbf{h}_{i}^{(L)}\in\mathbb{R}^{c}" class="ltx_Math" display="inline" id="A1.p1.9.m7.1"><semantics id="A1.p1.9.m7.1a"><mrow id="A1.p1.9.m7.1.2" xref="A1.p1.9.m7.1.2.cmml"><msubsup id="A1.p1.9.m7.1.2.2" xref="A1.p1.9.m7.1.2.2.cmml"><mi id="A1.p1.9.m7.1.2.2.2.2" xref="A1.p1.9.m7.1.2.2.2.2.cmml">ğ¡</mi><mi id="A1.p1.9.m7.1.2.2.2.3" xref="A1.p1.9.m7.1.2.2.2.3.cmml">i</mi><mrow id="A1.p1.9.m7.1.1.1.3" xref="A1.p1.9.m7.1.2.2.cmml"><mo id="A1.p1.9.m7.1.1.1.3.1" stretchy="false" xref="A1.p1.9.m7.1.2.2.cmml">(</mo><mi id="A1.p1.9.m7.1.1.1.1" xref="A1.p1.9.m7.1.1.1.1.cmml">L</mi><mo id="A1.p1.9.m7.1.1.1.3.2" stretchy="false" xref="A1.p1.9.m7.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.p1.9.m7.1.2.1" xref="A1.p1.9.m7.1.2.1.cmml">âˆˆ</mo><msup id="A1.p1.9.m7.1.2.3" xref="A1.p1.9.m7.1.2.3.cmml"><mi id="A1.p1.9.m7.1.2.3.2" xref="A1.p1.9.m7.1.2.3.2.cmml">â„</mi><mi id="A1.p1.9.m7.1.2.3.3" xref="A1.p1.9.m7.1.2.3.3.cmml">c</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.9.m7.1b"><apply id="A1.p1.9.m7.1.2.cmml" xref="A1.p1.9.m7.1.2"><in id="A1.p1.9.m7.1.2.1.cmml" xref="A1.p1.9.m7.1.2.1"></in><apply id="A1.p1.9.m7.1.2.2.cmml" xref="A1.p1.9.m7.1.2.2"><csymbol cd="ambiguous" id="A1.p1.9.m7.1.2.2.1.cmml" xref="A1.p1.9.m7.1.2.2">superscript</csymbol><apply id="A1.p1.9.m7.1.2.2.2.cmml" xref="A1.p1.9.m7.1.2.2"><csymbol cd="ambiguous" id="A1.p1.9.m7.1.2.2.2.1.cmml" xref="A1.p1.9.m7.1.2.2">subscript</csymbol><ci id="A1.p1.9.m7.1.2.2.2.2.cmml" xref="A1.p1.9.m7.1.2.2.2.2">ğ¡</ci><ci id="A1.p1.9.m7.1.2.2.2.3.cmml" xref="A1.p1.9.m7.1.2.2.2.3">ğ‘–</ci></apply><ci id="A1.p1.9.m7.1.1.1.1.cmml" xref="A1.p1.9.m7.1.1.1.1">ğ¿</ci></apply><apply id="A1.p1.9.m7.1.2.3.cmml" xref="A1.p1.9.m7.1.2.3"><csymbol cd="ambiguous" id="A1.p1.9.m7.1.2.3.1.cmml" xref="A1.p1.9.m7.1.2.3">superscript</csymbol><ci id="A1.p1.9.m7.1.2.3.2.cmml" xref="A1.p1.9.m7.1.2.3.2">â„</ci><ci id="A1.p1.9.m7.1.2.3.3.cmml" xref="A1.p1.9.m7.1.2.3.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.9.m7.1c">\mathbf{h}_{i}^{(L)}\in\mathbb{R}^{c}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.9.m7.1d">bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> as the prediction vector. The typical loss used for training the GNN is negative log-likelihood <math alttext="\mathcal{L}_{\mathrm{NLL}}(\mathbf{h}_{i}^{(L)},y_{i})" class="ltx_Math" display="inline" id="A1.p1.10.m8.3"><semantics id="A1.p1.10.m8.3a"><mrow id="A1.p1.10.m8.3.3" xref="A1.p1.10.m8.3.3.cmml"><msub id="A1.p1.10.m8.3.3.4" xref="A1.p1.10.m8.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.10.m8.3.3.4.2" xref="A1.p1.10.m8.3.3.4.2.cmml">â„’</mi><mi id="A1.p1.10.m8.3.3.4.3" xref="A1.p1.10.m8.3.3.4.3.cmml">NLL</mi></msub><mo id="A1.p1.10.m8.3.3.3" xref="A1.p1.10.m8.3.3.3.cmml">â¢</mo><mrow id="A1.p1.10.m8.3.3.2.2" xref="A1.p1.10.m8.3.3.2.3.cmml"><mo id="A1.p1.10.m8.3.3.2.2.3" stretchy="false" xref="A1.p1.10.m8.3.3.2.3.cmml">(</mo><msubsup id="A1.p1.10.m8.2.2.1.1.1" xref="A1.p1.10.m8.2.2.1.1.1.cmml"><mi id="A1.p1.10.m8.2.2.1.1.1.2.2" xref="A1.p1.10.m8.2.2.1.1.1.2.2.cmml">ğ¡</mi><mi id="A1.p1.10.m8.2.2.1.1.1.2.3" xref="A1.p1.10.m8.2.2.1.1.1.2.3.cmml">i</mi><mrow id="A1.p1.10.m8.1.1.1.3" xref="A1.p1.10.m8.2.2.1.1.1.cmml"><mo id="A1.p1.10.m8.1.1.1.3.1" stretchy="false" xref="A1.p1.10.m8.2.2.1.1.1.cmml">(</mo><mi id="A1.p1.10.m8.1.1.1.1" xref="A1.p1.10.m8.1.1.1.1.cmml">L</mi><mo id="A1.p1.10.m8.1.1.1.3.2" stretchy="false" xref="A1.p1.10.m8.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.p1.10.m8.3.3.2.2.4" xref="A1.p1.10.m8.3.3.2.3.cmml">,</mo><msub id="A1.p1.10.m8.3.3.2.2.2" xref="A1.p1.10.m8.3.3.2.2.2.cmml"><mi id="A1.p1.10.m8.3.3.2.2.2.2" xref="A1.p1.10.m8.3.3.2.2.2.2.cmml">y</mi><mi id="A1.p1.10.m8.3.3.2.2.2.3" xref="A1.p1.10.m8.3.3.2.2.2.3.cmml">i</mi></msub><mo id="A1.p1.10.m8.3.3.2.2.5" stretchy="false" xref="A1.p1.10.m8.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.10.m8.3b"><apply id="A1.p1.10.m8.3.3.cmml" xref="A1.p1.10.m8.3.3"><times id="A1.p1.10.m8.3.3.3.cmml" xref="A1.p1.10.m8.3.3.3"></times><apply id="A1.p1.10.m8.3.3.4.cmml" xref="A1.p1.10.m8.3.3.4"><csymbol cd="ambiguous" id="A1.p1.10.m8.3.3.4.1.cmml" xref="A1.p1.10.m8.3.3.4">subscript</csymbol><ci id="A1.p1.10.m8.3.3.4.2.cmml" xref="A1.p1.10.m8.3.3.4.2">â„’</ci><ci id="A1.p1.10.m8.3.3.4.3.cmml" xref="A1.p1.10.m8.3.3.4.3">NLL</ci></apply><interval closure="open" id="A1.p1.10.m8.3.3.2.3.cmml" xref="A1.p1.10.m8.3.3.2.2"><apply id="A1.p1.10.m8.2.2.1.1.1.cmml" xref="A1.p1.10.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.p1.10.m8.2.2.1.1.1.1.cmml" xref="A1.p1.10.m8.2.2.1.1.1">superscript</csymbol><apply id="A1.p1.10.m8.2.2.1.1.1.2.cmml" xref="A1.p1.10.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.p1.10.m8.2.2.1.1.1.2.1.cmml" xref="A1.p1.10.m8.2.2.1.1.1">subscript</csymbol><ci id="A1.p1.10.m8.2.2.1.1.1.2.2.cmml" xref="A1.p1.10.m8.2.2.1.1.1.2.2">ğ¡</ci><ci id="A1.p1.10.m8.2.2.1.1.1.2.3.cmml" xref="A1.p1.10.m8.2.2.1.1.1.2.3">ğ‘–</ci></apply><ci id="A1.p1.10.m8.1.1.1.1.cmml" xref="A1.p1.10.m8.1.1.1.1">ğ¿</ci></apply><apply id="A1.p1.10.m8.3.3.2.2.2.cmml" xref="A1.p1.10.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.p1.10.m8.3.3.2.2.2.1.cmml" xref="A1.p1.10.m8.3.3.2.2.2">subscript</csymbol><ci id="A1.p1.10.m8.3.3.2.2.2.2.cmml" xref="A1.p1.10.m8.3.3.2.2.2.2">ğ‘¦</ci><ci id="A1.p1.10.m8.3.3.2.2.2.3.cmml" xref="A1.p1.10.m8.3.3.2.2.2.3">ğ‘–</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.10.m8.3c">\mathcal{L}_{\mathrm{NLL}}(\mathbf{h}_{i}^{(L)},y_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.p1.10.m8.3d">caligraphic_L start_POSTSUBSCRIPT roman_NLL end_POSTSUBSCRIPT ( bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> for all the nodes in the training set <math alttext="\mathcal{Y}^{\mathrm{train}}" class="ltx_Math" display="inline" id="A1.p1.11.m9.1"><semantics id="A1.p1.11.m9.1a"><msup id="A1.p1.11.m9.1.1" xref="A1.p1.11.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.11.m9.1.1.2" xref="A1.p1.11.m9.1.1.2.cmml">ğ’´</mi><mi id="A1.p1.11.m9.1.1.3" xref="A1.p1.11.m9.1.1.3.cmml">train</mi></msup><annotation-xml encoding="MathML-Content" id="A1.p1.11.m9.1b"><apply id="A1.p1.11.m9.1.1.cmml" xref="A1.p1.11.m9.1.1"><csymbol cd="ambiguous" id="A1.p1.11.m9.1.1.1.cmml" xref="A1.p1.11.m9.1.1">superscript</csymbol><ci id="A1.p1.11.m9.1.1.2.cmml" xref="A1.p1.11.m9.1.1.2">ğ’´</ci><ci id="A1.p1.11.m9.1.1.3.cmml" xref="A1.p1.11.m9.1.1.3">train</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.11.m9.1c">\mathcal{Y}^{\mathrm{train}}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.11.m9.1d">caligraphic_Y start_POSTSUPERSCRIPT roman_train end_POSTSUPERSCRIPT</annotation></semantics></math>. The complete set of trainable parameters is denoted as <math alttext="\psi=\{\psi_{1}\}\cup\{\mathbf{W}^{(l)}\}_{l=1}^{L}" class="ltx_Math" display="inline" id="A1.p1.12.m10.3"><semantics id="A1.p1.12.m10.3a"><mrow id="A1.p1.12.m10.3.3" xref="A1.p1.12.m10.3.3.cmml"><mi id="A1.p1.12.m10.3.3.4" xref="A1.p1.12.m10.3.3.4.cmml">Ïˆ</mi><mo id="A1.p1.12.m10.3.3.3" xref="A1.p1.12.m10.3.3.3.cmml">=</mo><mrow id="A1.p1.12.m10.3.3.2" xref="A1.p1.12.m10.3.3.2.cmml"><mrow id="A1.p1.12.m10.2.2.1.1.1" xref="A1.p1.12.m10.2.2.1.1.2.cmml"><mo id="A1.p1.12.m10.2.2.1.1.1.2" stretchy="false" xref="A1.p1.12.m10.2.2.1.1.2.cmml">{</mo><msub id="A1.p1.12.m10.2.2.1.1.1.1" xref="A1.p1.12.m10.2.2.1.1.1.1.cmml"><mi id="A1.p1.12.m10.2.2.1.1.1.1.2" xref="A1.p1.12.m10.2.2.1.1.1.1.2.cmml">Ïˆ</mi><mn id="A1.p1.12.m10.2.2.1.1.1.1.3" xref="A1.p1.12.m10.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.p1.12.m10.2.2.1.1.1.3" stretchy="false" xref="A1.p1.12.m10.2.2.1.1.2.cmml">}</mo></mrow><mo id="A1.p1.12.m10.3.3.2.3" xref="A1.p1.12.m10.3.3.2.3.cmml">âˆª</mo><msubsup id="A1.p1.12.m10.3.3.2.2" xref="A1.p1.12.m10.3.3.2.2.cmml"><mrow id="A1.p1.12.m10.3.3.2.2.1.1.1" xref="A1.p1.12.m10.3.3.2.2.1.1.2.cmml"><mo id="A1.p1.12.m10.3.3.2.2.1.1.1.2" stretchy="false" xref="A1.p1.12.m10.3.3.2.2.1.1.2.cmml">{</mo><msup id="A1.p1.12.m10.3.3.2.2.1.1.1.1" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1.cmml"><mi id="A1.p1.12.m10.3.3.2.2.1.1.1.1.2" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1.2.cmml">ğ–</mi><mrow id="A1.p1.12.m10.1.1.1.3" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1.cmml"><mo id="A1.p1.12.m10.1.1.1.3.1" stretchy="false" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1.cmml">(</mo><mi id="A1.p1.12.m10.1.1.1.1" xref="A1.p1.12.m10.1.1.1.1.cmml">l</mi><mo id="A1.p1.12.m10.1.1.1.3.2" stretchy="false" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></msup><mo id="A1.p1.12.m10.3.3.2.2.1.1.1.3" stretchy="false" xref="A1.p1.12.m10.3.3.2.2.1.1.2.cmml">}</mo></mrow><mrow id="A1.p1.12.m10.3.3.2.2.1.3" xref="A1.p1.12.m10.3.3.2.2.1.3.cmml"><mi id="A1.p1.12.m10.3.3.2.2.1.3.2" xref="A1.p1.12.m10.3.3.2.2.1.3.2.cmml">l</mi><mo id="A1.p1.12.m10.3.3.2.2.1.3.1" xref="A1.p1.12.m10.3.3.2.2.1.3.1.cmml">=</mo><mn id="A1.p1.12.m10.3.3.2.2.1.3.3" xref="A1.p1.12.m10.3.3.2.2.1.3.3.cmml">1</mn></mrow><mi id="A1.p1.12.m10.3.3.2.2.3" xref="A1.p1.12.m10.3.3.2.2.3.cmml">L</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.12.m10.3b"><apply id="A1.p1.12.m10.3.3.cmml" xref="A1.p1.12.m10.3.3"><eq id="A1.p1.12.m10.3.3.3.cmml" xref="A1.p1.12.m10.3.3.3"></eq><ci id="A1.p1.12.m10.3.3.4.cmml" xref="A1.p1.12.m10.3.3.4">ğœ“</ci><apply id="A1.p1.12.m10.3.3.2.cmml" xref="A1.p1.12.m10.3.3.2"><union id="A1.p1.12.m10.3.3.2.3.cmml" xref="A1.p1.12.m10.3.3.2.3"></union><set id="A1.p1.12.m10.2.2.1.1.2.cmml" xref="A1.p1.12.m10.2.2.1.1.1"><apply id="A1.p1.12.m10.2.2.1.1.1.1.cmml" xref="A1.p1.12.m10.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.12.m10.2.2.1.1.1.1.1.cmml" xref="A1.p1.12.m10.2.2.1.1.1.1">subscript</csymbol><ci id="A1.p1.12.m10.2.2.1.1.1.1.2.cmml" xref="A1.p1.12.m10.2.2.1.1.1.1.2">ğœ“</ci><cn id="A1.p1.12.m10.2.2.1.1.1.1.3.cmml" type="integer" xref="A1.p1.12.m10.2.2.1.1.1.1.3">1</cn></apply></set><apply id="A1.p1.12.m10.3.3.2.2.cmml" xref="A1.p1.12.m10.3.3.2.2"><csymbol cd="ambiguous" id="A1.p1.12.m10.3.3.2.2.2.cmml" xref="A1.p1.12.m10.3.3.2.2">superscript</csymbol><apply id="A1.p1.12.m10.3.3.2.2.1.cmml" xref="A1.p1.12.m10.3.3.2.2"><csymbol cd="ambiguous" id="A1.p1.12.m10.3.3.2.2.1.2.cmml" xref="A1.p1.12.m10.3.3.2.2">subscript</csymbol><set id="A1.p1.12.m10.3.3.2.2.1.1.2.cmml" xref="A1.p1.12.m10.3.3.2.2.1.1.1"><apply id="A1.p1.12.m10.3.3.2.2.1.1.1.1.cmml" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.12.m10.3.3.2.2.1.1.1.1.1.cmml" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1">superscript</csymbol><ci id="A1.p1.12.m10.3.3.2.2.1.1.1.1.2.cmml" xref="A1.p1.12.m10.3.3.2.2.1.1.1.1.2">ğ–</ci><ci id="A1.p1.12.m10.1.1.1.1.cmml" xref="A1.p1.12.m10.1.1.1.1">ğ‘™</ci></apply></set><apply id="A1.p1.12.m10.3.3.2.2.1.3.cmml" xref="A1.p1.12.m10.3.3.2.2.1.3"><eq id="A1.p1.12.m10.3.3.2.2.1.3.1.cmml" xref="A1.p1.12.m10.3.3.2.2.1.3.1"></eq><ci id="A1.p1.12.m10.3.3.2.2.1.3.2.cmml" xref="A1.p1.12.m10.3.3.2.2.1.3.2">ğ‘™</ci><cn id="A1.p1.12.m10.3.3.2.2.1.3.3.cmml" type="integer" xref="A1.p1.12.m10.3.3.2.2.1.3.3">1</cn></apply></apply><ci id="A1.p1.12.m10.3.3.2.2.3.cmml" xref="A1.p1.12.m10.3.3.2.2.3">ğ¿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.12.m10.3c">\psi=\{\psi_{1}\}\cup\{\mathbf{W}^{(l)}\}_{l=1}^{L}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.12.m10.3d">italic_Ïˆ = { italic_Ïˆ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT } âˆª { bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Interpretation of the distribution matching loss</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.2">We recap the objective function. For notation brevity, we use <math alttext="t_{i}" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><msub id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml">t</mi><mi id="A2.p1.1.m1.1.1.3" xref="A2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1">subscript</csymbol><ci id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">ğ‘¡</ci><ci id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to denote the input target node <math alttext="t^{\textrm{target}}" class="ltx_Math" display="inline" id="A2.p1.2.m2.1"><semantics id="A2.p1.2.m2.1a"><msup id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml"><mi id="A2.p1.2.m2.1.1.2" xref="A2.p1.2.m2.1.1.2.cmml">t</mi><mtext id="A2.p1.2.m2.1.1.3" xref="A2.p1.2.m2.1.1.3a.cmml">target</mtext></msup><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><apply id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1">superscript</csymbol><ci id="A2.p1.2.m2.1.1.2.cmml" xref="A2.p1.2.m2.1.1.2">ğ‘¡</ci><ci id="A2.p1.2.m2.1.1.3a.cmml" xref="A2.p1.2.m2.1.1.3"><mtext id="A2.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="A2.p1.2.m2.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">t^{\textrm{target}}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.2.m2.1d">italic_t start_POSTSUPERSCRIPT target end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx17">
<tbody id="A2.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{KL}(\tilde{p}_{\mathrm{LM}}(\cdot|t_{i},y_{i})\|p_{\phi}(%
\cdot|t_{i}))" class="ltx_math_unparsed" display="inline" id="A2.E17.m1.1"><semantics id="A2.E17.m1.1a"><mrow id="A2.E17.m1.1b"><mi id="A2.E17.m1.1.1">KL</mi><mrow id="A2.E17.m1.1.2"><mo id="A2.E17.m1.1.2.1" stretchy="false">(</mo><msub id="A2.E17.m1.1.2.2"><mover accent="true" id="A2.E17.m1.1.2.2.2"><mi id="A2.E17.m1.1.2.2.2.2">p</mi><mo id="A2.E17.m1.1.2.2.2.1">~</mo></mover><mi id="A2.E17.m1.1.2.2.3">LM</mi></msub><mrow id="A2.E17.m1.1.2.3"><mo id="A2.E17.m1.1.2.3.1" stretchy="false">(</mo><mo id="A2.E17.m1.1.2.3.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="A2.E17.m1.1.2.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A2.E17.m1.1.2.3.4"><mi id="A2.E17.m1.1.2.3.4.2">t</mi><mi id="A2.E17.m1.1.2.3.4.3">i</mi></msub><mo id="A2.E17.m1.1.2.3.5">,</mo><msub id="A2.E17.m1.1.2.3.6"><mi id="A2.E17.m1.1.2.3.6.2">y</mi><mi id="A2.E17.m1.1.2.3.6.3">i</mi></msub><mo id="A2.E17.m1.1.2.3.7" stretchy="false">)</mo></mrow><mo id="A2.E17.m1.1.2.4" lspace="0em" rspace="0.167em">âˆ¥</mo><msub id="A2.E17.m1.1.2.5"><mi id="A2.E17.m1.1.2.5.2">p</mi><mi id="A2.E17.m1.1.2.5.3">Ï•</mi></msub><mrow id="A2.E17.m1.1.2.6"><mo id="A2.E17.m1.1.2.6.1" stretchy="false">(</mo><mo id="A2.E17.m1.1.2.6.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="A2.E17.m1.1.2.6.3" rspace="0.167em" stretchy="false">|</mo><msub id="A2.E17.m1.1.2.6.4"><mi id="A2.E17.m1.1.2.6.4.2">t</mi><mi id="A2.E17.m1.1.2.6.4.3">i</mi></msub><mo id="A2.E17.m1.1.2.6.5" stretchy="false">)</mo></mrow><mo id="A2.E17.m1.1.2.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A2.E17.m1.1c">\displaystyle\mathrm{KL}(\tilde{p}_{\mathrm{LM}}(\cdot|t_{i},y_{i})\|p_{\phi}(%
\cdot|t_{i}))</annotation><annotation encoding="application/x-llamapun" id="A2.E17.m1.1d">roman_KL ( over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ¥ italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p1.3">where the stop gradient operator is removed if we only compute gradient with respect to <math alttext="\phi" class="ltx_Math" display="inline" id="A2.p1.3.m1.1"><semantics id="A2.p1.3.m1.1a"><mi id="A2.p1.3.m1.1.1" xref="A2.p1.3.m1.1.1.cmml">Ï•</mi><annotation-xml encoding="MathML-Content" id="A2.p1.3.m1.1b"><ci id="A2.p1.3.m1.1.1.cmml" xref="A2.p1.3.m1.1.1">italic-Ï•</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m1.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="A2.p1.3.m1.1d">italic_Ï•</annotation></semantics></math> and</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx18">
<tbody id="A2.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{\phi}(t_{j}|t_{i})=\frac{\exp(s_{\phi}(t_{i},t_{j}))}{\sum_{t%
_{k}\in\mathcal{D}}\exp(s_{\phi}(t_{i},t_{k}))}" class="ltx_Math" display="inline" id="A2.E18.m1.5"><semantics id="A2.E18.m1.5a"><mrow id="A2.E18.m1.5.5" xref="A2.E18.m1.5.5.cmml"><mrow id="A2.E18.m1.5.5.1" xref="A2.E18.m1.5.5.1.cmml"><msub id="A2.E18.m1.5.5.1.3" xref="A2.E18.m1.5.5.1.3.cmml"><mi id="A2.E18.m1.5.5.1.3.2" xref="A2.E18.m1.5.5.1.3.2.cmml">p</mi><mi id="A2.E18.m1.5.5.1.3.3" xref="A2.E18.m1.5.5.1.3.3.cmml">Ï•</mi></msub><mo id="A2.E18.m1.5.5.1.2" xref="A2.E18.m1.5.5.1.2.cmml">â¢</mo><mrow id="A2.E18.m1.5.5.1.1.1" xref="A2.E18.m1.5.5.1.1.1.1.cmml"><mo id="A2.E18.m1.5.5.1.1.1.2" stretchy="false" xref="A2.E18.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="A2.E18.m1.5.5.1.1.1.1" xref="A2.E18.m1.5.5.1.1.1.1.cmml"><msub id="A2.E18.m1.5.5.1.1.1.1.2" xref="A2.E18.m1.5.5.1.1.1.1.2.cmml"><mi id="A2.E18.m1.5.5.1.1.1.1.2.2" xref="A2.E18.m1.5.5.1.1.1.1.2.2.cmml">t</mi><mi id="A2.E18.m1.5.5.1.1.1.1.2.3" xref="A2.E18.m1.5.5.1.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="A2.E18.m1.5.5.1.1.1.1.1" xref="A2.E18.m1.5.5.1.1.1.1.1.cmml">|</mo><msub id="A2.E18.m1.5.5.1.1.1.1.3" xref="A2.E18.m1.5.5.1.1.1.1.3.cmml"><mi id="A2.E18.m1.5.5.1.1.1.1.3.2" xref="A2.E18.m1.5.5.1.1.1.1.3.2.cmml">t</mi><mi id="A2.E18.m1.5.5.1.1.1.1.3.3" xref="A2.E18.m1.5.5.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.E18.m1.5.5.1.1.1.3" stretchy="false" xref="A2.E18.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E18.m1.5.5.2" xref="A2.E18.m1.5.5.2.cmml">=</mo><mstyle displaystyle="true" id="A2.E18.m1.4.4" xref="A2.E18.m1.4.4.cmml"><mfrac id="A2.E18.m1.4.4a" xref="A2.E18.m1.4.4.cmml"><mrow id="A2.E18.m1.2.2.2.2" xref="A2.E18.m1.2.2.2.3.cmml"><mi id="A2.E18.m1.1.1.1.1" xref="A2.E18.m1.1.1.1.1.cmml">exp</mi><mo id="A2.E18.m1.2.2.2.2a" xref="A2.E18.m1.2.2.2.3.cmml">â¡</mo><mrow id="A2.E18.m1.2.2.2.2.1" xref="A2.E18.m1.2.2.2.3.cmml"><mo id="A2.E18.m1.2.2.2.2.1.2" stretchy="false" xref="A2.E18.m1.2.2.2.3.cmml">(</mo><mrow id="A2.E18.m1.2.2.2.2.1.1" xref="A2.E18.m1.2.2.2.2.1.1.cmml"><msub id="A2.E18.m1.2.2.2.2.1.1.4" xref="A2.E18.m1.2.2.2.2.1.1.4.cmml"><mi id="A2.E18.m1.2.2.2.2.1.1.4.2" xref="A2.E18.m1.2.2.2.2.1.1.4.2.cmml">s</mi><mi id="A2.E18.m1.2.2.2.2.1.1.4.3" xref="A2.E18.m1.2.2.2.2.1.1.4.3.cmml">Ï•</mi></msub><mo id="A2.E18.m1.2.2.2.2.1.1.3" xref="A2.E18.m1.2.2.2.2.1.1.3.cmml">â¢</mo><mrow id="A2.E18.m1.2.2.2.2.1.1.2.2" xref="A2.E18.m1.2.2.2.2.1.1.2.3.cmml"><mo id="A2.E18.m1.2.2.2.2.1.1.2.2.3" stretchy="false" xref="A2.E18.m1.2.2.2.2.1.1.2.3.cmml">(</mo><msub id="A2.E18.m1.2.2.2.2.1.1.1.1.1" xref="A2.E18.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="A2.E18.m1.2.2.2.2.1.1.1.1.1.2" xref="A2.E18.m1.2.2.2.2.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E18.m1.2.2.2.2.1.1.1.1.1.3" xref="A2.E18.m1.2.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E18.m1.2.2.2.2.1.1.2.2.4" xref="A2.E18.m1.2.2.2.2.1.1.2.3.cmml">,</mo><msub id="A2.E18.m1.2.2.2.2.1.1.2.2.2" xref="A2.E18.m1.2.2.2.2.1.1.2.2.2.cmml"><mi id="A2.E18.m1.2.2.2.2.1.1.2.2.2.2" xref="A2.E18.m1.2.2.2.2.1.1.2.2.2.2.cmml">t</mi><mi id="A2.E18.m1.2.2.2.2.1.1.2.2.2.3" xref="A2.E18.m1.2.2.2.2.1.1.2.2.2.3.cmml">j</mi></msub><mo id="A2.E18.m1.2.2.2.2.1.1.2.2.5" stretchy="false" xref="A2.E18.m1.2.2.2.2.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A2.E18.m1.2.2.2.2.1.3" stretchy="false" xref="A2.E18.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A2.E18.m1.4.4.4" xref="A2.E18.m1.4.4.4.cmml"><msub id="A2.E18.m1.4.4.4.3" xref="A2.E18.m1.4.4.4.3.cmml"><mo id="A2.E18.m1.4.4.4.3.2" xref="A2.E18.m1.4.4.4.3.2.cmml">âˆ‘</mo><mrow id="A2.E18.m1.4.4.4.3.3" xref="A2.E18.m1.4.4.4.3.3.cmml"><msub id="A2.E18.m1.4.4.4.3.3.2" xref="A2.E18.m1.4.4.4.3.3.2.cmml"><mi id="A2.E18.m1.4.4.4.3.3.2.2" xref="A2.E18.m1.4.4.4.3.3.2.2.cmml">t</mi><mi id="A2.E18.m1.4.4.4.3.3.2.3" xref="A2.E18.m1.4.4.4.3.3.2.3.cmml">k</mi></msub><mo id="A2.E18.m1.4.4.4.3.3.1" xref="A2.E18.m1.4.4.4.3.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="A2.E18.m1.4.4.4.3.3.3" xref="A2.E18.m1.4.4.4.3.3.3.cmml">ğ’Ÿ</mi></mrow></msub><mrow id="A2.E18.m1.4.4.4.2.1" xref="A2.E18.m1.4.4.4.2.2.cmml"><mi id="A2.E18.m1.3.3.3.1" xref="A2.E18.m1.3.3.3.1.cmml">exp</mi><mo id="A2.E18.m1.4.4.4.2.1a" xref="A2.E18.m1.4.4.4.2.2.cmml">â¡</mo><mrow id="A2.E18.m1.4.4.4.2.1.1" xref="A2.E18.m1.4.4.4.2.2.cmml"><mo id="A2.E18.m1.4.4.4.2.1.1.2" stretchy="false" xref="A2.E18.m1.4.4.4.2.2.cmml">(</mo><mrow id="A2.E18.m1.4.4.4.2.1.1.1" xref="A2.E18.m1.4.4.4.2.1.1.1.cmml"><msub id="A2.E18.m1.4.4.4.2.1.1.1.4" xref="A2.E18.m1.4.4.4.2.1.1.1.4.cmml"><mi id="A2.E18.m1.4.4.4.2.1.1.1.4.2" xref="A2.E18.m1.4.4.4.2.1.1.1.4.2.cmml">s</mi><mi id="A2.E18.m1.4.4.4.2.1.1.1.4.3" xref="A2.E18.m1.4.4.4.2.1.1.1.4.3.cmml">Ï•</mi></msub><mo id="A2.E18.m1.4.4.4.2.1.1.1.3" xref="A2.E18.m1.4.4.4.2.1.1.1.3.cmml">â¢</mo><mrow id="A2.E18.m1.4.4.4.2.1.1.1.2.2" xref="A2.E18.m1.4.4.4.2.1.1.1.2.3.cmml"><mo id="A2.E18.m1.4.4.4.2.1.1.1.2.2.3" stretchy="false" xref="A2.E18.m1.4.4.4.2.1.1.1.2.3.cmml">(</mo><msub id="A2.E18.m1.4.4.4.2.1.1.1.1.1.1" xref="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mi id="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.2" xref="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.3" xref="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E18.m1.4.4.4.2.1.1.1.2.2.4" xref="A2.E18.m1.4.4.4.2.1.1.1.2.3.cmml">,</mo><msub id="A2.E18.m1.4.4.4.2.1.1.1.2.2.2" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.cmml"><mi id="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.2" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.2.cmml">t</mi><mi id="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.3" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.3.cmml">k</mi></msub><mo id="A2.E18.m1.4.4.4.2.1.1.1.2.2.5" stretchy="false" xref="A2.E18.m1.4.4.4.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A2.E18.m1.4.4.4.2.1.1.3" stretchy="false" xref="A2.E18.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A2.E18.m1.5b"><apply id="A2.E18.m1.5.5.cmml" xref="A2.E18.m1.5.5"><eq id="A2.E18.m1.5.5.2.cmml" xref="A2.E18.m1.5.5.2"></eq><apply id="A2.E18.m1.5.5.1.cmml" xref="A2.E18.m1.5.5.1"><times id="A2.E18.m1.5.5.1.2.cmml" xref="A2.E18.m1.5.5.1.2"></times><apply id="A2.E18.m1.5.5.1.3.cmml" xref="A2.E18.m1.5.5.1.3"><csymbol cd="ambiguous" id="A2.E18.m1.5.5.1.3.1.cmml" xref="A2.E18.m1.5.5.1.3">subscript</csymbol><ci id="A2.E18.m1.5.5.1.3.2.cmml" xref="A2.E18.m1.5.5.1.3.2">ğ‘</ci><ci id="A2.E18.m1.5.5.1.3.3.cmml" xref="A2.E18.m1.5.5.1.3.3">italic-Ï•</ci></apply><apply id="A2.E18.m1.5.5.1.1.1.1.cmml" xref="A2.E18.m1.5.5.1.1.1"><csymbol cd="latexml" id="A2.E18.m1.5.5.1.1.1.1.1.cmml" xref="A2.E18.m1.5.5.1.1.1.1.1">conditional</csymbol><apply id="A2.E18.m1.5.5.1.1.1.1.2.cmml" xref="A2.E18.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E18.m1.5.5.1.1.1.1.2.1.cmml" xref="A2.E18.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="A2.E18.m1.5.5.1.1.1.1.2.2.cmml" xref="A2.E18.m1.5.5.1.1.1.1.2.2">ğ‘¡</ci><ci id="A2.E18.m1.5.5.1.1.1.1.2.3.cmml" xref="A2.E18.m1.5.5.1.1.1.1.2.3">ğ‘—</ci></apply><apply id="A2.E18.m1.5.5.1.1.1.1.3.cmml" xref="A2.E18.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E18.m1.5.5.1.1.1.1.3.1.cmml" xref="A2.E18.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="A2.E18.m1.5.5.1.1.1.1.3.2.cmml" xref="A2.E18.m1.5.5.1.1.1.1.3.2">ğ‘¡</ci><ci id="A2.E18.m1.5.5.1.1.1.1.3.3.cmml" xref="A2.E18.m1.5.5.1.1.1.1.3.3">ğ‘–</ci></apply></apply></apply><apply id="A2.E18.m1.4.4.cmml" xref="A2.E18.m1.4.4"><divide id="A2.E18.m1.4.4.5.cmml" xref="A2.E18.m1.4.4"></divide><apply id="A2.E18.m1.2.2.2.3.cmml" xref="A2.E18.m1.2.2.2.2"><exp id="A2.E18.m1.1.1.1.1.cmml" xref="A2.E18.m1.1.1.1.1"></exp><apply id="A2.E18.m1.2.2.2.2.1.1.cmml" xref="A2.E18.m1.2.2.2.2.1.1"><times id="A2.E18.m1.2.2.2.2.1.1.3.cmml" xref="A2.E18.m1.2.2.2.2.1.1.3"></times><apply id="A2.E18.m1.2.2.2.2.1.1.4.cmml" xref="A2.E18.m1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="A2.E18.m1.2.2.2.2.1.1.4.1.cmml" xref="A2.E18.m1.2.2.2.2.1.1.4">subscript</csymbol><ci id="A2.E18.m1.2.2.2.2.1.1.4.2.cmml" xref="A2.E18.m1.2.2.2.2.1.1.4.2">ğ‘ </ci><ci id="A2.E18.m1.2.2.2.2.1.1.4.3.cmml" xref="A2.E18.m1.2.2.2.2.1.1.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E18.m1.2.2.2.2.1.1.2.3.cmml" xref="A2.E18.m1.2.2.2.2.1.1.2.2"><apply id="A2.E18.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A2.E18.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E18.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="A2.E18.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="A2.E18.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="A2.E18.m1.2.2.2.2.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E18.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="A2.E18.m1.2.2.2.2.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E18.m1.2.2.2.2.1.1.2.2.2.cmml" xref="A2.E18.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E18.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="A2.E18.m1.2.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="A2.E18.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="A2.E18.m1.2.2.2.2.1.1.2.2.2.2">ğ‘¡</ci><ci id="A2.E18.m1.2.2.2.2.1.1.2.2.2.3.cmml" xref="A2.E18.m1.2.2.2.2.1.1.2.2.2.3">ğ‘—</ci></apply></interval></apply></apply><apply id="A2.E18.m1.4.4.4.cmml" xref="A2.E18.m1.4.4.4"><apply id="A2.E18.m1.4.4.4.3.cmml" xref="A2.E18.m1.4.4.4.3"><csymbol cd="ambiguous" id="A2.E18.m1.4.4.4.3.1.cmml" xref="A2.E18.m1.4.4.4.3">subscript</csymbol><sum id="A2.E18.m1.4.4.4.3.2.cmml" xref="A2.E18.m1.4.4.4.3.2"></sum><apply id="A2.E18.m1.4.4.4.3.3.cmml" xref="A2.E18.m1.4.4.4.3.3"><in id="A2.E18.m1.4.4.4.3.3.1.cmml" xref="A2.E18.m1.4.4.4.3.3.1"></in><apply id="A2.E18.m1.4.4.4.3.3.2.cmml" xref="A2.E18.m1.4.4.4.3.3.2"><csymbol cd="ambiguous" id="A2.E18.m1.4.4.4.3.3.2.1.cmml" xref="A2.E18.m1.4.4.4.3.3.2">subscript</csymbol><ci id="A2.E18.m1.4.4.4.3.3.2.2.cmml" xref="A2.E18.m1.4.4.4.3.3.2.2">ğ‘¡</ci><ci id="A2.E18.m1.4.4.4.3.3.2.3.cmml" xref="A2.E18.m1.4.4.4.3.3.2.3">ğ‘˜</ci></apply><ci id="A2.E18.m1.4.4.4.3.3.3.cmml" xref="A2.E18.m1.4.4.4.3.3.3">ğ’Ÿ</ci></apply></apply><apply id="A2.E18.m1.4.4.4.2.2.cmml" xref="A2.E18.m1.4.4.4.2.1"><exp id="A2.E18.m1.3.3.3.1.cmml" xref="A2.E18.m1.3.3.3.1"></exp><apply id="A2.E18.m1.4.4.4.2.1.1.1.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1"><times id="A2.E18.m1.4.4.4.2.1.1.1.3.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.3"></times><apply id="A2.E18.m1.4.4.4.2.1.1.1.4.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.4"><csymbol cd="ambiguous" id="A2.E18.m1.4.4.4.2.1.1.1.4.1.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.4">subscript</csymbol><ci id="A2.E18.m1.4.4.4.2.1.1.1.4.2.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.4.2">ğ‘ </ci><ci id="A2.E18.m1.4.4.4.2.1.1.1.4.3.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E18.m1.4.4.4.2.1.1.1.2.3.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2"><apply id="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.2.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.3.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.1.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.2">ğ‘¡</ci><ci id="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.3.cmml" xref="A2.E18.m1.4.4.4.2.1.1.1.2.2.2.3">ğ‘˜</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E18.m1.5c">\displaystyle p_{\phi}(t_{j}|t_{i})=\frac{\exp(s_{\phi}(t_{i},t_{j}))}{\sum_{t%
_{k}\in\mathcal{D}}\exp(s_{\phi}(t_{i},t_{k}))}</annotation><annotation encoding="application/x-llamapun" id="A2.E18.m1.5d">italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆˆ caligraphic_D end_POSTSUBSCRIPT roman_exp ( italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p1.14">and</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx19">
<tbody id="A2.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{p}_{\mathrm{LM}}(t_{j}|t_{i},y_{i})=\frac{\exp(p_{\mathrm{%
LM}}(y_{i}|t_{i},t_{j}))}{\sum_{k\in\mathcal{N}_{i}}\exp(p_{\mathrm{LM}}(y_{i}%
|t_{i},t_{k}))}" class="ltx_Math" display="inline" id="A2.E19.m1.5"><semantics id="A2.E19.m1.5a"><mrow id="A2.E19.m1.5.5" xref="A2.E19.m1.5.5.cmml"><mrow id="A2.E19.m1.5.5.1" xref="A2.E19.m1.5.5.1.cmml"><msub id="A2.E19.m1.5.5.1.3" xref="A2.E19.m1.5.5.1.3.cmml"><mover accent="true" id="A2.E19.m1.5.5.1.3.2" xref="A2.E19.m1.5.5.1.3.2.cmml"><mi id="A2.E19.m1.5.5.1.3.2.2" xref="A2.E19.m1.5.5.1.3.2.2.cmml">p</mi><mo id="A2.E19.m1.5.5.1.3.2.1" xref="A2.E19.m1.5.5.1.3.2.1.cmml">~</mo></mover><mi id="A2.E19.m1.5.5.1.3.3" xref="A2.E19.m1.5.5.1.3.3.cmml">LM</mi></msub><mo id="A2.E19.m1.5.5.1.2" xref="A2.E19.m1.5.5.1.2.cmml">â¢</mo><mrow id="A2.E19.m1.5.5.1.1.1" xref="A2.E19.m1.5.5.1.1.1.1.cmml"><mo id="A2.E19.m1.5.5.1.1.1.2" stretchy="false" xref="A2.E19.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="A2.E19.m1.5.5.1.1.1.1" xref="A2.E19.m1.5.5.1.1.1.1.cmml"><msub id="A2.E19.m1.5.5.1.1.1.1.4" xref="A2.E19.m1.5.5.1.1.1.1.4.cmml"><mi id="A2.E19.m1.5.5.1.1.1.1.4.2" xref="A2.E19.m1.5.5.1.1.1.1.4.2.cmml">t</mi><mi id="A2.E19.m1.5.5.1.1.1.1.4.3" xref="A2.E19.m1.5.5.1.1.1.1.4.3.cmml">j</mi></msub><mo fence="false" id="A2.E19.m1.5.5.1.1.1.1.3" xref="A2.E19.m1.5.5.1.1.1.1.3.cmml">|</mo><mrow id="A2.E19.m1.5.5.1.1.1.1.2.2" xref="A2.E19.m1.5.5.1.1.1.1.2.3.cmml"><msub id="A2.E19.m1.5.5.1.1.1.1.1.1.1" xref="A2.E19.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="A2.E19.m1.5.5.1.1.1.1.1.1.1.2" xref="A2.E19.m1.5.5.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E19.m1.5.5.1.1.1.1.1.1.1.3" xref="A2.E19.m1.5.5.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E19.m1.5.5.1.1.1.1.2.2.3" xref="A2.E19.m1.5.5.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E19.m1.5.5.1.1.1.1.2.2.2" xref="A2.E19.m1.5.5.1.1.1.1.2.2.2.cmml"><mi id="A2.E19.m1.5.5.1.1.1.1.2.2.2.2" xref="A2.E19.m1.5.5.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E19.m1.5.5.1.1.1.1.2.2.2.3" xref="A2.E19.m1.5.5.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E19.m1.5.5.1.1.1.3" stretchy="false" xref="A2.E19.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E19.m1.5.5.2" xref="A2.E19.m1.5.5.2.cmml">=</mo><mstyle displaystyle="true" id="A2.E19.m1.4.4" xref="A2.E19.m1.4.4.cmml"><mfrac id="A2.E19.m1.4.4a" xref="A2.E19.m1.4.4.cmml"><mrow id="A2.E19.m1.2.2.2.2" xref="A2.E19.m1.2.2.2.3.cmml"><mi id="A2.E19.m1.1.1.1.1" xref="A2.E19.m1.1.1.1.1.cmml">exp</mi><mo id="A2.E19.m1.2.2.2.2a" xref="A2.E19.m1.2.2.2.3.cmml">â¡</mo><mrow id="A2.E19.m1.2.2.2.2.1" xref="A2.E19.m1.2.2.2.3.cmml"><mo id="A2.E19.m1.2.2.2.2.1.2" stretchy="false" xref="A2.E19.m1.2.2.2.3.cmml">(</mo><mrow id="A2.E19.m1.2.2.2.2.1.1" xref="A2.E19.m1.2.2.2.2.1.1.cmml"><msub id="A2.E19.m1.2.2.2.2.1.1.3" xref="A2.E19.m1.2.2.2.2.1.1.3.cmml"><mi id="A2.E19.m1.2.2.2.2.1.1.3.2" xref="A2.E19.m1.2.2.2.2.1.1.3.2.cmml">p</mi><mi id="A2.E19.m1.2.2.2.2.1.1.3.3" xref="A2.E19.m1.2.2.2.2.1.1.3.3.cmml">LM</mi></msub><mo id="A2.E19.m1.2.2.2.2.1.1.2" xref="A2.E19.m1.2.2.2.2.1.1.2.cmml">â¢</mo><mrow id="A2.E19.m1.2.2.2.2.1.1.1.1" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.cmml"><mo id="A2.E19.m1.2.2.2.2.1.1.1.1.2" stretchy="false" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A2.E19.m1.2.2.2.2.1.1.1.1.1" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.cmml"><msub id="A2.E19.m1.2.2.2.2.1.1.1.1.1.4" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.cmml"><mi id="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.2" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.2.cmml">y</mi><mi id="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.3" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="A2.E19.m1.2.2.2.2.1.1.1.1.1.3" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.3.cmml"><msub id="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.3" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.2" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.2.cmml">t</mi><mi id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.3" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub></mrow></mrow><mo id="A2.E19.m1.2.2.2.2.1.1.1.1.3" stretchy="false" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E19.m1.2.2.2.2.1.3" stretchy="false" xref="A2.E19.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A2.E19.m1.4.4.4" xref="A2.E19.m1.4.4.4.cmml"><msub id="A2.E19.m1.4.4.4.3" xref="A2.E19.m1.4.4.4.3.cmml"><mo id="A2.E19.m1.4.4.4.3.2" xref="A2.E19.m1.4.4.4.3.2.cmml">âˆ‘</mo><mrow id="A2.E19.m1.4.4.4.3.3" xref="A2.E19.m1.4.4.4.3.3.cmml"><mi id="A2.E19.m1.4.4.4.3.3.2" xref="A2.E19.m1.4.4.4.3.3.2.cmml">k</mi><mo id="A2.E19.m1.4.4.4.3.3.1" xref="A2.E19.m1.4.4.4.3.3.1.cmml">âˆˆ</mo><msub id="A2.E19.m1.4.4.4.3.3.3" xref="A2.E19.m1.4.4.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.E19.m1.4.4.4.3.3.3.2" xref="A2.E19.m1.4.4.4.3.3.3.2.cmml">ğ’©</mi><mi id="A2.E19.m1.4.4.4.3.3.3.3" xref="A2.E19.m1.4.4.4.3.3.3.3.cmml">i</mi></msub></mrow></msub><mrow id="A2.E19.m1.4.4.4.2.1" xref="A2.E19.m1.4.4.4.2.2.cmml"><mi id="A2.E19.m1.3.3.3.1" xref="A2.E19.m1.3.3.3.1.cmml">exp</mi><mo id="A2.E19.m1.4.4.4.2.1a" xref="A2.E19.m1.4.4.4.2.2.cmml">â¡</mo><mrow id="A2.E19.m1.4.4.4.2.1.1" xref="A2.E19.m1.4.4.4.2.2.cmml"><mo id="A2.E19.m1.4.4.4.2.1.1.2" stretchy="false" xref="A2.E19.m1.4.4.4.2.2.cmml">(</mo><mrow id="A2.E19.m1.4.4.4.2.1.1.1" xref="A2.E19.m1.4.4.4.2.1.1.1.cmml"><msub id="A2.E19.m1.4.4.4.2.1.1.1.3" xref="A2.E19.m1.4.4.4.2.1.1.1.3.cmml"><mi id="A2.E19.m1.4.4.4.2.1.1.1.3.2" xref="A2.E19.m1.4.4.4.2.1.1.1.3.2.cmml">p</mi><mi id="A2.E19.m1.4.4.4.2.1.1.1.3.3" xref="A2.E19.m1.4.4.4.2.1.1.1.3.3.cmml">LM</mi></msub><mo id="A2.E19.m1.4.4.4.2.1.1.1.2" xref="A2.E19.m1.4.4.4.2.1.1.1.2.cmml">â¢</mo><mrow id="A2.E19.m1.4.4.4.2.1.1.1.1.1" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mo id="A2.E19.m1.4.4.4.2.1.1.1.1.1.2" stretchy="false" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.cmml"><msub id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.cmml"><mi id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.2" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.2.cmml">y</mi><mi id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.3" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.3" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.3.cmml"><msub id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.3" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.2" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.2.cmml">t</mi><mi id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.3" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub></mrow></mrow><mo id="A2.E19.m1.4.4.4.2.1.1.1.1.1.3" stretchy="false" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E19.m1.4.4.4.2.1.1.3" stretchy="false" xref="A2.E19.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A2.E19.m1.5b"><apply id="A2.E19.m1.5.5.cmml" xref="A2.E19.m1.5.5"><eq id="A2.E19.m1.5.5.2.cmml" xref="A2.E19.m1.5.5.2"></eq><apply id="A2.E19.m1.5.5.1.cmml" xref="A2.E19.m1.5.5.1"><times id="A2.E19.m1.5.5.1.2.cmml" xref="A2.E19.m1.5.5.1.2"></times><apply id="A2.E19.m1.5.5.1.3.cmml" xref="A2.E19.m1.5.5.1.3"><csymbol cd="ambiguous" id="A2.E19.m1.5.5.1.3.1.cmml" xref="A2.E19.m1.5.5.1.3">subscript</csymbol><apply id="A2.E19.m1.5.5.1.3.2.cmml" xref="A2.E19.m1.5.5.1.3.2"><ci id="A2.E19.m1.5.5.1.3.2.1.cmml" xref="A2.E19.m1.5.5.1.3.2.1">~</ci><ci id="A2.E19.m1.5.5.1.3.2.2.cmml" xref="A2.E19.m1.5.5.1.3.2.2">ğ‘</ci></apply><ci id="A2.E19.m1.5.5.1.3.3.cmml" xref="A2.E19.m1.5.5.1.3.3">LM</ci></apply><apply id="A2.E19.m1.5.5.1.1.1.1.cmml" xref="A2.E19.m1.5.5.1.1.1"><csymbol cd="latexml" id="A2.E19.m1.5.5.1.1.1.1.3.cmml" xref="A2.E19.m1.5.5.1.1.1.1.3">conditional</csymbol><apply id="A2.E19.m1.5.5.1.1.1.1.4.cmml" xref="A2.E19.m1.5.5.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.E19.m1.5.5.1.1.1.1.4.1.cmml" xref="A2.E19.m1.5.5.1.1.1.1.4">subscript</csymbol><ci id="A2.E19.m1.5.5.1.1.1.1.4.2.cmml" xref="A2.E19.m1.5.5.1.1.1.1.4.2">ğ‘¡</ci><ci id="A2.E19.m1.5.5.1.1.1.1.4.3.cmml" xref="A2.E19.m1.5.5.1.1.1.1.4.3">ğ‘—</ci></apply><list id="A2.E19.m1.5.5.1.1.1.1.2.3.cmml" xref="A2.E19.m1.5.5.1.1.1.1.2.2"><apply id="A2.E19.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E19.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E19.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A2.E19.m1.5.5.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E19.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A2.E19.m1.5.5.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E19.m1.5.5.1.1.1.1.2.2.2.cmml" xref="A2.E19.m1.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E19.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="A2.E19.m1.5.5.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E19.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="A2.E19.m1.5.5.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E19.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="A2.E19.m1.5.5.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply></apply><apply id="A2.E19.m1.4.4.cmml" xref="A2.E19.m1.4.4"><divide id="A2.E19.m1.4.4.5.cmml" xref="A2.E19.m1.4.4"></divide><apply id="A2.E19.m1.2.2.2.3.cmml" xref="A2.E19.m1.2.2.2.2"><exp id="A2.E19.m1.1.1.1.1.cmml" xref="A2.E19.m1.1.1.1.1"></exp><apply id="A2.E19.m1.2.2.2.2.1.1.cmml" xref="A2.E19.m1.2.2.2.2.1.1"><times id="A2.E19.m1.2.2.2.2.1.1.2.cmml" xref="A2.E19.m1.2.2.2.2.1.1.2"></times><apply id="A2.E19.m1.2.2.2.2.1.1.3.cmml" xref="A2.E19.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E19.m1.2.2.2.2.1.1.3.1.cmml" xref="A2.E19.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E19.m1.2.2.2.2.1.1.3.2.cmml" xref="A2.E19.m1.2.2.2.2.1.1.3.2">ğ‘</ci><ci id="A2.E19.m1.2.2.2.2.1.1.3.3.cmml" xref="A2.E19.m1.2.2.2.2.1.1.3.3">LM</ci></apply><apply id="A2.E19.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1"><csymbol cd="latexml" id="A2.E19.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.3">conditional</csymbol><apply id="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.1.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.2.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.2">ğ‘¦</ci><ci id="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.3.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.4.3">ğ‘–</ci></apply><list id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2"><apply id="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.2">ğ‘¡</ci><ci id="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E19.m1.2.2.2.2.1.1.1.1.1.2.2.2.3">ğ‘—</ci></apply></list></apply></apply></apply><apply id="A2.E19.m1.4.4.4.cmml" xref="A2.E19.m1.4.4.4"><apply id="A2.E19.m1.4.4.4.3.cmml" xref="A2.E19.m1.4.4.4.3"><csymbol cd="ambiguous" id="A2.E19.m1.4.4.4.3.1.cmml" xref="A2.E19.m1.4.4.4.3">subscript</csymbol><sum id="A2.E19.m1.4.4.4.3.2.cmml" xref="A2.E19.m1.4.4.4.3.2"></sum><apply id="A2.E19.m1.4.4.4.3.3.cmml" xref="A2.E19.m1.4.4.4.3.3"><in id="A2.E19.m1.4.4.4.3.3.1.cmml" xref="A2.E19.m1.4.4.4.3.3.1"></in><ci id="A2.E19.m1.4.4.4.3.3.2.cmml" xref="A2.E19.m1.4.4.4.3.3.2">ğ‘˜</ci><apply id="A2.E19.m1.4.4.4.3.3.3.cmml" xref="A2.E19.m1.4.4.4.3.3.3"><csymbol cd="ambiguous" id="A2.E19.m1.4.4.4.3.3.3.1.cmml" xref="A2.E19.m1.4.4.4.3.3.3">subscript</csymbol><ci id="A2.E19.m1.4.4.4.3.3.3.2.cmml" xref="A2.E19.m1.4.4.4.3.3.3.2">ğ’©</ci><ci id="A2.E19.m1.4.4.4.3.3.3.3.cmml" xref="A2.E19.m1.4.4.4.3.3.3.3">ğ‘–</ci></apply></apply></apply><apply id="A2.E19.m1.4.4.4.2.2.cmml" xref="A2.E19.m1.4.4.4.2.1"><exp id="A2.E19.m1.3.3.3.1.cmml" xref="A2.E19.m1.3.3.3.1"></exp><apply id="A2.E19.m1.4.4.4.2.1.1.1.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1"><times id="A2.E19.m1.4.4.4.2.1.1.1.2.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.2"></times><apply id="A2.E19.m1.4.4.4.2.1.1.1.3.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.E19.m1.4.4.4.2.1.1.1.3.1.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="A2.E19.m1.4.4.4.2.1.1.1.3.2.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.3.2">ğ‘</ci><ci id="A2.E19.m1.4.4.4.2.1.1.1.3.3.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.3.3">LM</ci></apply><apply id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1"><csymbol cd="latexml" id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.3.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.3">conditional</csymbol><apply id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.1.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.2.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.2">ğ‘¦</ci><ci id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.3.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.4.3">ğ‘–</ci></apply><list id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.3.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2"><apply id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.2">ğ‘¡</ci><ci id="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E19.m1.4.4.4.2.1.1.1.1.1.1.2.2.2.3">ğ‘˜</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E19.m1.5c">\displaystyle\tilde{p}_{\mathrm{LM}}(t_{j}|t_{i},y_{i})=\frac{\exp(p_{\mathrm{%
LM}}(y_{i}|t_{i},t_{j}))}{\sum_{k\in\mathcal{N}_{i}}\exp(p_{\mathrm{LM}}(y_{i}%
|t_{i},t_{k}))}</annotation><annotation encoding="application/x-llamapun" id="A2.E19.m1.5d">over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_k âˆˆ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( italic_p start_POSTSUBSCRIPT roman_LM end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p1.5">For notation brevity, we replace <math alttext="\sum_{t_{k}\in\mathcal{D}}" class="ltx_Math" display="inline" id="A2.p1.4.m1.1"><semantics id="A2.p1.4.m1.1a"><msub id="A2.p1.4.m1.1.1" xref="A2.p1.4.m1.1.1.cmml"><mo id="A2.p1.4.m1.1.1.2" xref="A2.p1.4.m1.1.1.2.cmml">âˆ‘</mo><mrow id="A2.p1.4.m1.1.1.3" xref="A2.p1.4.m1.1.1.3.cmml"><msub id="A2.p1.4.m1.1.1.3.2" xref="A2.p1.4.m1.1.1.3.2.cmml"><mi id="A2.p1.4.m1.1.1.3.2.2" xref="A2.p1.4.m1.1.1.3.2.2.cmml">t</mi><mi id="A2.p1.4.m1.1.1.3.2.3" xref="A2.p1.4.m1.1.1.3.2.3.cmml">k</mi></msub><mo id="A2.p1.4.m1.1.1.3.1" xref="A2.p1.4.m1.1.1.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="A2.p1.4.m1.1.1.3.3" xref="A2.p1.4.m1.1.1.3.3.cmml">ğ’Ÿ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.p1.4.m1.1b"><apply id="A2.p1.4.m1.1.1.cmml" xref="A2.p1.4.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.4.m1.1.1.1.cmml" xref="A2.p1.4.m1.1.1">subscript</csymbol><sum id="A2.p1.4.m1.1.1.2.cmml" xref="A2.p1.4.m1.1.1.2"></sum><apply id="A2.p1.4.m1.1.1.3.cmml" xref="A2.p1.4.m1.1.1.3"><in id="A2.p1.4.m1.1.1.3.1.cmml" xref="A2.p1.4.m1.1.1.3.1"></in><apply id="A2.p1.4.m1.1.1.3.2.cmml" xref="A2.p1.4.m1.1.1.3.2"><csymbol cd="ambiguous" id="A2.p1.4.m1.1.1.3.2.1.cmml" xref="A2.p1.4.m1.1.1.3.2">subscript</csymbol><ci id="A2.p1.4.m1.1.1.3.2.2.cmml" xref="A2.p1.4.m1.1.1.3.2.2">ğ‘¡</ci><ci id="A2.p1.4.m1.1.1.3.2.3.cmml" xref="A2.p1.4.m1.1.1.3.2.3">ğ‘˜</ci></apply><ci id="A2.p1.4.m1.1.1.3.3.cmml" xref="A2.p1.4.m1.1.1.3.3">ğ’Ÿ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m1.1c">\sum_{t_{k}\in\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.4.m1.1d">âˆ‘ start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆˆ caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\sum_{z}" class="ltx_Math" display="inline" id="A2.p1.5.m2.1"><semantics id="A2.p1.5.m2.1a"><msub id="A2.p1.5.m2.1.1" xref="A2.p1.5.m2.1.1.cmml"><mo id="A2.p1.5.m2.1.1.2" xref="A2.p1.5.m2.1.1.2.cmml">âˆ‘</mo><mi id="A2.p1.5.m2.1.1.3" xref="A2.p1.5.m2.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.5.m2.1b"><apply id="A2.p1.5.m2.1.1.cmml" xref="A2.p1.5.m2.1.1"><csymbol cd="ambiguous" id="A2.p1.5.m2.1.1.1.cmml" xref="A2.p1.5.m2.1.1">subscript</csymbol><sum id="A2.p1.5.m2.1.1.2.cmml" xref="A2.p1.5.m2.1.1.2"></sum><ci id="A2.p1.5.m2.1.1.3.cmml" xref="A2.p1.5.m2.1.1.3">ğ‘§</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.5.m2.1c">\sum_{z}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.5.m2.1d">âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> if there is no ambiguity. Then</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx20">
<tbody id="A2.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\min_{\phi}\ \mathrm{KL}\big{(}\tilde{p}_{\mathtt{LM}}(\cdot|t_{i%
},y_{i})\|p_{\phi}(\cdot|t_{i})\big{)}" class="ltx_math_unparsed" display="inline" id="A2.E20.m1.1"><semantics id="A2.E20.m1.1a"><mrow id="A2.E20.m1.1b"><munder id="A2.E20.m1.1.1"><mi id="A2.E20.m1.1.1.2">min</mi><mi id="A2.E20.m1.1.1.3">Ï•</mi></munder><mi id="A2.E20.m1.1.2">KL</mi><mrow id="A2.E20.m1.1.3"><mo id="A2.E20.m1.1.3.1" maxsize="120%" minsize="120%">(</mo><msub id="A2.E20.m1.1.3.2"><mover accent="true" id="A2.E20.m1.1.3.2.2"><mi id="A2.E20.m1.1.3.2.2.2">p</mi><mo id="A2.E20.m1.1.3.2.2.1">~</mo></mover><mi id="A2.E20.m1.1.3.2.3">ğ™»ğ™¼</mi></msub><mrow id="A2.E20.m1.1.3.3"><mo id="A2.E20.m1.1.3.3.1" stretchy="false">(</mo><mo id="A2.E20.m1.1.3.3.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="A2.E20.m1.1.3.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="A2.E20.m1.1.3.3.4"><mi id="A2.E20.m1.1.3.3.4.2">t</mi><mi id="A2.E20.m1.1.3.3.4.3">i</mi></msub><mo id="A2.E20.m1.1.3.3.5">,</mo><msub id="A2.E20.m1.1.3.3.6"><mi id="A2.E20.m1.1.3.3.6.2">y</mi><mi id="A2.E20.m1.1.3.3.6.3">i</mi></msub><mo id="A2.E20.m1.1.3.3.7" stretchy="false">)</mo></mrow><mo id="A2.E20.m1.1.3.4" lspace="0em" rspace="0.167em">âˆ¥</mo><msub id="A2.E20.m1.1.3.5"><mi id="A2.E20.m1.1.3.5.2">p</mi><mi id="A2.E20.m1.1.3.5.3">Ï•</mi></msub><mrow id="A2.E20.m1.1.3.6"><mo id="A2.E20.m1.1.3.6.1" stretchy="false">(</mo><mo id="A2.E20.m1.1.3.6.2" lspace="0em" rspace="0em">â‹…</mo><mo fence="false" id="A2.E20.m1.1.3.6.3" rspace="0.167em" stretchy="false">|</mo><msub id="A2.E20.m1.1.3.6.4"><mi id="A2.E20.m1.1.3.6.4.2">t</mi><mi id="A2.E20.m1.1.3.6.4.3">i</mi></msub><mo id="A2.E20.m1.1.3.6.5" stretchy="false">)</mo></mrow><mo id="A2.E20.m1.1.3.7" maxsize="120%" minsize="120%">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A2.E20.m1.1c">\displaystyle\min_{\phi}\ \mathrm{KL}\big{(}\tilde{p}_{\mathtt{LM}}(\cdot|t_{i%
},y_{i})\|p_{\phi}(\cdot|t_{i})\big{)}</annotation><annotation encoding="application/x-llamapun" id="A2.E20.m1.1d">roman_min start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT roman_KL ( over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ¥ italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( â‹… | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\Leftrightarrow\min_{\phi}-\sum_{z}\tilde{p}_{\mathtt{LM}}(z|t_{i%
},y_{i})\log[p_{\phi}(z|t_{i})]" class="ltx_Math" display="inline" id="A2.E20.m2.3"><semantics id="A2.E20.m2.3a"><mrow id="A2.E20.m2.3.3" xref="A2.E20.m2.3.3.cmml"><mi id="A2.E20.m2.3.3.4" xref="A2.E20.m2.3.3.4.cmml"></mi><mo id="A2.E20.m2.3.3.3" stretchy="false" xref="A2.E20.m2.3.3.3.cmml">â‡”</mo><mrow id="A2.E20.m2.3.3.2" xref="A2.E20.m2.3.3.2.cmml"><munder id="A2.E20.m2.3.3.2.4" xref="A2.E20.m2.3.3.2.4.cmml"><mi id="A2.E20.m2.3.3.2.4.2" xref="A2.E20.m2.3.3.2.4.2.cmml">min</mi><mi id="A2.E20.m2.3.3.2.4.3" xref="A2.E20.m2.3.3.2.4.3.cmml">Ï•</mi></munder><mo id="A2.E20.m2.3.3.2.3" lspace="0em" xref="A2.E20.m2.3.3.2.3.cmml">âˆ’</mo><mrow id="A2.E20.m2.3.3.2.2" xref="A2.E20.m2.3.3.2.2.cmml"><mstyle displaystyle="true" id="A2.E20.m2.3.3.2.2.3" xref="A2.E20.m2.3.3.2.2.3.cmml"><munder id="A2.E20.m2.3.3.2.2.3a" xref="A2.E20.m2.3.3.2.2.3.cmml"><mo id="A2.E20.m2.3.3.2.2.3.2" movablelimits="false" xref="A2.E20.m2.3.3.2.2.3.2.cmml">âˆ‘</mo><mi id="A2.E20.m2.3.3.2.2.3.3" xref="A2.E20.m2.3.3.2.2.3.3.cmml">z</mi></munder></mstyle><mrow id="A2.E20.m2.3.3.2.2.2" xref="A2.E20.m2.3.3.2.2.2.cmml"><msub id="A2.E20.m2.3.3.2.2.2.4" xref="A2.E20.m2.3.3.2.2.2.4.cmml"><mover accent="true" id="A2.E20.m2.3.3.2.2.2.4.2" xref="A2.E20.m2.3.3.2.2.2.4.2.cmml"><mi id="A2.E20.m2.3.3.2.2.2.4.2.2" xref="A2.E20.m2.3.3.2.2.2.4.2.2.cmml">p</mi><mo id="A2.E20.m2.3.3.2.2.2.4.2.1" xref="A2.E20.m2.3.3.2.2.2.4.2.1.cmml">~</mo></mover><mi id="A2.E20.m2.3.3.2.2.2.4.3" xref="A2.E20.m2.3.3.2.2.2.4.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E20.m2.3.3.2.2.2.3" xref="A2.E20.m2.3.3.2.2.2.3.cmml">â¢</mo><mrow id="A2.E20.m2.2.2.1.1.1.1.1" xref="A2.E20.m2.2.2.1.1.1.1.1.1.cmml"><mo id="A2.E20.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="A2.E20.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E20.m2.2.2.1.1.1.1.1.1" xref="A2.E20.m2.2.2.1.1.1.1.1.1.cmml"><mi id="A2.E20.m2.2.2.1.1.1.1.1.1.4" xref="A2.E20.m2.2.2.1.1.1.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E20.m2.2.2.1.1.1.1.1.1.3" xref="A2.E20.m2.2.2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.3.cmml"><msub id="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1" xref="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.3" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.2" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.3" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E20.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="A2.E20.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E20.m2.3.3.2.2.2.3a" lspace="0.167em" xref="A2.E20.m2.3.3.2.2.2.3.cmml">â¢</mo><mrow id="A2.E20.m2.3.3.2.2.2.2.1" xref="A2.E20.m2.3.3.2.2.2.2.2.cmml"><mi id="A2.E20.m2.1.1" xref="A2.E20.m2.1.1.cmml">log</mi><mo id="A2.E20.m2.3.3.2.2.2.2.1a" xref="A2.E20.m2.3.3.2.2.2.2.2.cmml">â¡</mo><mrow id="A2.E20.m2.3.3.2.2.2.2.1.1" xref="A2.E20.m2.3.3.2.2.2.2.2.cmml"><mo id="A2.E20.m2.3.3.2.2.2.2.1.1.2" stretchy="false" xref="A2.E20.m2.3.3.2.2.2.2.2.cmml">[</mo><mrow id="A2.E20.m2.3.3.2.2.2.2.1.1.1" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.cmml"><msub id="A2.E20.m2.3.3.2.2.2.2.1.1.1.3" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.cmml"><mi id="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.2" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.2.cmml">p</mi><mi id="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.3" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.3.cmml">Ï•</mi></msub><mo id="A2.E20.m2.3.3.2.2.2.2.1.1.1.2" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.2.cmml">â¢</mo><mrow id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.2" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.1" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml">|</mo><msub id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.2" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.3" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E20.m2.3.3.2.2.2.2.1.1.3" stretchy="false" xref="A2.E20.m2.3.3.2.2.2.2.2.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E20.m2.3b"><apply id="A2.E20.m2.3.3.cmml" xref="A2.E20.m2.3.3"><ci id="A2.E20.m2.3.3.3.cmml" xref="A2.E20.m2.3.3.3">â‡”</ci><csymbol cd="latexml" id="A2.E20.m2.3.3.4.cmml" xref="A2.E20.m2.3.3.4">absent</csymbol><apply id="A2.E20.m2.3.3.2.cmml" xref="A2.E20.m2.3.3.2"><minus id="A2.E20.m2.3.3.2.3.cmml" xref="A2.E20.m2.3.3.2.3"></minus><apply id="A2.E20.m2.3.3.2.4.cmml" xref="A2.E20.m2.3.3.2.4"><csymbol cd="ambiguous" id="A2.E20.m2.3.3.2.4.1.cmml" xref="A2.E20.m2.3.3.2.4">subscript</csymbol><min id="A2.E20.m2.3.3.2.4.2.cmml" xref="A2.E20.m2.3.3.2.4.2"></min><ci id="A2.E20.m2.3.3.2.4.3.cmml" xref="A2.E20.m2.3.3.2.4.3">italic-Ï•</ci></apply><apply id="A2.E20.m2.3.3.2.2.cmml" xref="A2.E20.m2.3.3.2.2"><apply id="A2.E20.m2.3.3.2.2.3.cmml" xref="A2.E20.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="A2.E20.m2.3.3.2.2.3.1.cmml" xref="A2.E20.m2.3.3.2.2.3">subscript</csymbol><sum id="A2.E20.m2.3.3.2.2.3.2.cmml" xref="A2.E20.m2.3.3.2.2.3.2"></sum><ci id="A2.E20.m2.3.3.2.2.3.3.cmml" xref="A2.E20.m2.3.3.2.2.3.3">ğ‘§</ci></apply><apply id="A2.E20.m2.3.3.2.2.2.cmml" xref="A2.E20.m2.3.3.2.2.2"><times id="A2.E20.m2.3.3.2.2.2.3.cmml" xref="A2.E20.m2.3.3.2.2.2.3"></times><apply id="A2.E20.m2.3.3.2.2.2.4.cmml" xref="A2.E20.m2.3.3.2.2.2.4"><csymbol cd="ambiguous" id="A2.E20.m2.3.3.2.2.2.4.1.cmml" xref="A2.E20.m2.3.3.2.2.2.4">subscript</csymbol><apply id="A2.E20.m2.3.3.2.2.2.4.2.cmml" xref="A2.E20.m2.3.3.2.2.2.4.2"><ci id="A2.E20.m2.3.3.2.2.2.4.2.1.cmml" xref="A2.E20.m2.3.3.2.2.2.4.2.1">~</ci><ci id="A2.E20.m2.3.3.2.2.2.4.2.2.cmml" xref="A2.E20.m2.3.3.2.2.2.4.2.2">ğ‘</ci></apply><ci id="A2.E20.m2.3.3.2.2.2.4.3.cmml" xref="A2.E20.m2.3.3.2.2.2.4.3">ğ™»ğ™¼</ci></apply><apply id="A2.E20.m2.2.2.1.1.1.1.1.1.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A2.E20.m2.2.2.1.1.1.1.1.1.3.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.3">conditional</csymbol><ci id="A2.E20.m2.2.2.1.1.1.1.1.1.4.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.4">ğ‘§</ci><list id="A2.E20.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2"><apply id="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E20.m2.2.2.1.1.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply><apply id="A2.E20.m2.3.3.2.2.2.2.2.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1"><log id="A2.E20.m2.1.1.cmml" xref="A2.E20.m2.1.1"></log><apply id="A2.E20.m2.3.3.2.2.2.2.1.1.1.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1"><times id="A2.E20.m2.3.3.2.2.2.2.1.1.1.2.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.2"></times><apply id="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.1.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.2.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.2">ğ‘</ci><ci id="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.3.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.3.3">italic-Ï•</ci></apply><apply id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.2">ğ‘§</ci><apply id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.2">ğ‘¡</ci><ci id="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="A2.E20.m2.3.3.2.2.2.2.1.1.1.1.1.1.3.3">ğ‘–</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E20.m2.3c">\displaystyle\Leftrightarrow\min_{\phi}-\sum_{z}\tilde{p}_{\mathtt{LM}}(z|t_{i%
},y_{i})\log[p_{\phi}(z|t_{i})]</annotation><annotation encoding="application/x-llamapun" id="A2.E20.m2.3d">â‡” roman_min start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT - âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log [ italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="A2.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\sum_{z}\tilde{p}_{\mathtt{LM}}(z|t_{i},y_{i})\log\Bigg{[}\frac%
{e^{s_{\phi}(z,t_{i})}}{\sum_{z^{\prime}}e^{s_{\phi}(z^{\prime},t_{i})}}\Bigg{]}" class="ltx_Math" display="inline" id="A2.E21.m1.6"><semantics id="A2.E21.m1.6a"><mrow id="A2.E21.m1.6.6" xref="A2.E21.m1.6.6.cmml"><mi id="A2.E21.m1.6.6.3" xref="A2.E21.m1.6.6.3.cmml"></mi><mo id="A2.E21.m1.6.6.2" xref="A2.E21.m1.6.6.2.cmml">=</mo><mrow id="A2.E21.m1.6.6.1" xref="A2.E21.m1.6.6.1.cmml"><mo id="A2.E21.m1.6.6.1a" xref="A2.E21.m1.6.6.1.cmml">âˆ’</mo><mrow id="A2.E21.m1.6.6.1.1" xref="A2.E21.m1.6.6.1.1.cmml"><mstyle displaystyle="true" id="A2.E21.m1.6.6.1.1.2" xref="A2.E21.m1.6.6.1.1.2.cmml"><munder id="A2.E21.m1.6.6.1.1.2a" xref="A2.E21.m1.6.6.1.1.2.cmml"><mo id="A2.E21.m1.6.6.1.1.2.2" movablelimits="false" xref="A2.E21.m1.6.6.1.1.2.2.cmml">âˆ‘</mo><mi id="A2.E21.m1.6.6.1.1.2.3" xref="A2.E21.m1.6.6.1.1.2.3.cmml">z</mi></munder></mstyle><mrow id="A2.E21.m1.6.6.1.1.1" xref="A2.E21.m1.6.6.1.1.1.cmml"><msub id="A2.E21.m1.6.6.1.1.1.3" xref="A2.E21.m1.6.6.1.1.1.3.cmml"><mover accent="true" id="A2.E21.m1.6.6.1.1.1.3.2" xref="A2.E21.m1.6.6.1.1.1.3.2.cmml"><mi id="A2.E21.m1.6.6.1.1.1.3.2.2" xref="A2.E21.m1.6.6.1.1.1.3.2.2.cmml">p</mi><mo id="A2.E21.m1.6.6.1.1.1.3.2.1" xref="A2.E21.m1.6.6.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A2.E21.m1.6.6.1.1.1.3.3" xref="A2.E21.m1.6.6.1.1.1.3.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E21.m1.6.6.1.1.1.2" xref="A2.E21.m1.6.6.1.1.1.2.cmml">â¢</mo><mrow id="A2.E21.m1.6.6.1.1.1.1.1" xref="A2.E21.m1.6.6.1.1.1.1.1.1.cmml"><mo id="A2.E21.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="A2.E21.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E21.m1.6.6.1.1.1.1.1.1" xref="A2.E21.m1.6.6.1.1.1.1.1.1.cmml"><mi id="A2.E21.m1.6.6.1.1.1.1.1.1.4" xref="A2.E21.m1.6.6.1.1.1.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E21.m1.6.6.1.1.1.1.1.1.3" xref="A2.E21.m1.6.6.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.3.cmml"><msub id="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1" xref="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.3" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.2" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.3" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E21.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="A2.E21.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E21.m1.6.6.1.1.1.2a" lspace="0.167em" xref="A2.E21.m1.6.6.1.1.1.2.cmml">â¢</mo><mrow id="A2.E21.m1.6.6.1.1.1.4.2" xref="A2.E21.m1.6.6.1.1.1.4.1.cmml"><mi id="A2.E21.m1.5.5" xref="A2.E21.m1.5.5.cmml">log</mi><mo id="A2.E21.m1.6.6.1.1.1.4.2a" xref="A2.E21.m1.6.6.1.1.1.4.1.cmml">â¡</mo><mrow id="A2.E21.m1.6.6.1.1.1.4.2.1" xref="A2.E21.m1.6.6.1.1.1.4.1.cmml"><mo id="A2.E21.m1.6.6.1.1.1.4.2.1.1" maxsize="260%" minsize="260%" xref="A2.E21.m1.6.6.1.1.1.4.1.cmml">[</mo><mstyle displaystyle="true" id="A2.E21.m1.4.4" xref="A2.E21.m1.4.4.cmml"><mfrac id="A2.E21.m1.4.4a" xref="A2.E21.m1.4.4.cmml"><msup id="A2.E21.m1.2.2.2" xref="A2.E21.m1.2.2.2.cmml"><mi id="A2.E21.m1.2.2.2.4" xref="A2.E21.m1.2.2.2.4.cmml">e</mi><mrow id="A2.E21.m1.2.2.2.2.2" xref="A2.E21.m1.2.2.2.2.2.cmml"><msub id="A2.E21.m1.2.2.2.2.2.4" xref="A2.E21.m1.2.2.2.2.2.4.cmml"><mi id="A2.E21.m1.2.2.2.2.2.4.2" xref="A2.E21.m1.2.2.2.2.2.4.2.cmml">s</mi><mi id="A2.E21.m1.2.2.2.2.2.4.3" xref="A2.E21.m1.2.2.2.2.2.4.3.cmml">Ï•</mi></msub><mo id="A2.E21.m1.2.2.2.2.2.3" xref="A2.E21.m1.2.2.2.2.2.3.cmml">â¢</mo><mrow id="A2.E21.m1.2.2.2.2.2.2.1" xref="A2.E21.m1.2.2.2.2.2.2.2.cmml"><mo id="A2.E21.m1.2.2.2.2.2.2.1.2" stretchy="false" xref="A2.E21.m1.2.2.2.2.2.2.2.cmml">(</mo><mi id="A2.E21.m1.1.1.1.1.1.1" xref="A2.E21.m1.1.1.1.1.1.1.cmml">z</mi><mo id="A2.E21.m1.2.2.2.2.2.2.1.3" xref="A2.E21.m1.2.2.2.2.2.2.2.cmml">,</mo><msub id="A2.E21.m1.2.2.2.2.2.2.1.1" xref="A2.E21.m1.2.2.2.2.2.2.1.1.cmml"><mi id="A2.E21.m1.2.2.2.2.2.2.1.1.2" xref="A2.E21.m1.2.2.2.2.2.2.1.1.2.cmml">t</mi><mi id="A2.E21.m1.2.2.2.2.2.2.1.1.3" xref="A2.E21.m1.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.E21.m1.2.2.2.2.2.2.1.4" stretchy="false" xref="A2.E21.m1.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow></msup><mrow id="A2.E21.m1.4.4.4" xref="A2.E21.m1.4.4.4.cmml"><msub id="A2.E21.m1.4.4.4.3" xref="A2.E21.m1.4.4.4.3.cmml"><mo id="A2.E21.m1.4.4.4.3.2" xref="A2.E21.m1.4.4.4.3.2.cmml">âˆ‘</mo><msup id="A2.E21.m1.4.4.4.3.3" xref="A2.E21.m1.4.4.4.3.3.cmml"><mi id="A2.E21.m1.4.4.4.3.3.2" xref="A2.E21.m1.4.4.4.3.3.2.cmml">z</mi><mo id="A2.E21.m1.4.4.4.3.3.3" xref="A2.E21.m1.4.4.4.3.3.3.cmml">â€²</mo></msup></msub><msup id="A2.E21.m1.4.4.4.4" xref="A2.E21.m1.4.4.4.4.cmml"><mi id="A2.E21.m1.4.4.4.4.2" xref="A2.E21.m1.4.4.4.4.2.cmml">e</mi><mrow id="A2.E21.m1.4.4.4.2.2" xref="A2.E21.m1.4.4.4.2.2.cmml"><msub id="A2.E21.m1.4.4.4.2.2.4" xref="A2.E21.m1.4.4.4.2.2.4.cmml"><mi id="A2.E21.m1.4.4.4.2.2.4.2" xref="A2.E21.m1.4.4.4.2.2.4.2.cmml">s</mi><mi id="A2.E21.m1.4.4.4.2.2.4.3" xref="A2.E21.m1.4.4.4.2.2.4.3.cmml">Ï•</mi></msub><mo id="A2.E21.m1.4.4.4.2.2.3" xref="A2.E21.m1.4.4.4.2.2.3.cmml">â¢</mo><mrow id="A2.E21.m1.4.4.4.2.2.2.2" xref="A2.E21.m1.4.4.4.2.2.2.3.cmml"><mo id="A2.E21.m1.4.4.4.2.2.2.2.3" stretchy="false" xref="A2.E21.m1.4.4.4.2.2.2.3.cmml">(</mo><msup id="A2.E21.m1.3.3.3.1.1.1.1.1" xref="A2.E21.m1.3.3.3.1.1.1.1.1.cmml"><mi id="A2.E21.m1.3.3.3.1.1.1.1.1.2" xref="A2.E21.m1.3.3.3.1.1.1.1.1.2.cmml">z</mi><mo id="A2.E21.m1.3.3.3.1.1.1.1.1.3" xref="A2.E21.m1.3.3.3.1.1.1.1.1.3.cmml">â€²</mo></msup><mo id="A2.E21.m1.4.4.4.2.2.2.2.4" xref="A2.E21.m1.4.4.4.2.2.2.3.cmml">,</mo><msub id="A2.E21.m1.4.4.4.2.2.2.2.2" xref="A2.E21.m1.4.4.4.2.2.2.2.2.cmml"><mi id="A2.E21.m1.4.4.4.2.2.2.2.2.2" xref="A2.E21.m1.4.4.4.2.2.2.2.2.2.cmml">t</mi><mi id="A2.E21.m1.4.4.4.2.2.2.2.2.3" xref="A2.E21.m1.4.4.4.2.2.2.2.2.3.cmml">i</mi></msub><mo id="A2.E21.m1.4.4.4.2.2.2.2.5" stretchy="false" xref="A2.E21.m1.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></msup></mrow></mfrac></mstyle><mo id="A2.E21.m1.6.6.1.1.1.4.2.1.2" maxsize="260%" minsize="260%" xref="A2.E21.m1.6.6.1.1.1.4.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E21.m1.6b"><apply id="A2.E21.m1.6.6.cmml" xref="A2.E21.m1.6.6"><eq id="A2.E21.m1.6.6.2.cmml" xref="A2.E21.m1.6.6.2"></eq><csymbol cd="latexml" id="A2.E21.m1.6.6.3.cmml" xref="A2.E21.m1.6.6.3">absent</csymbol><apply id="A2.E21.m1.6.6.1.cmml" xref="A2.E21.m1.6.6.1"><minus id="A2.E21.m1.6.6.1.2.cmml" xref="A2.E21.m1.6.6.1"></minus><apply id="A2.E21.m1.6.6.1.1.cmml" xref="A2.E21.m1.6.6.1.1"><apply id="A2.E21.m1.6.6.1.1.2.cmml" xref="A2.E21.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.1.1.2.1.cmml" xref="A2.E21.m1.6.6.1.1.2">subscript</csymbol><sum id="A2.E21.m1.6.6.1.1.2.2.cmml" xref="A2.E21.m1.6.6.1.1.2.2"></sum><ci id="A2.E21.m1.6.6.1.1.2.3.cmml" xref="A2.E21.m1.6.6.1.1.2.3">ğ‘§</ci></apply><apply id="A2.E21.m1.6.6.1.1.1.cmml" xref="A2.E21.m1.6.6.1.1.1"><times id="A2.E21.m1.6.6.1.1.1.2.cmml" xref="A2.E21.m1.6.6.1.1.1.2"></times><apply id="A2.E21.m1.6.6.1.1.1.3.cmml" xref="A2.E21.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.1.1.1.3.1.cmml" xref="A2.E21.m1.6.6.1.1.1.3">subscript</csymbol><apply id="A2.E21.m1.6.6.1.1.1.3.2.cmml" xref="A2.E21.m1.6.6.1.1.1.3.2"><ci id="A2.E21.m1.6.6.1.1.1.3.2.1.cmml" xref="A2.E21.m1.6.6.1.1.1.3.2.1">~</ci><ci id="A2.E21.m1.6.6.1.1.1.3.2.2.cmml" xref="A2.E21.m1.6.6.1.1.1.3.2.2">ğ‘</ci></apply><ci id="A2.E21.m1.6.6.1.1.1.3.3.cmml" xref="A2.E21.m1.6.6.1.1.1.3.3">ğ™»ğ™¼</ci></apply><apply id="A2.E21.m1.6.6.1.1.1.1.1.1.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="A2.E21.m1.6.6.1.1.1.1.1.1.3.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.3">conditional</csymbol><ci id="A2.E21.m1.6.6.1.1.1.1.1.1.4.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.4">ğ‘§</ci><list id="A2.E21.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2"><apply id="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E21.m1.6.6.1.1.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply><apply id="A2.E21.m1.6.6.1.1.1.4.1.cmml" xref="A2.E21.m1.6.6.1.1.1.4.2"><log id="A2.E21.m1.5.5.cmml" xref="A2.E21.m1.5.5"></log><apply id="A2.E21.m1.4.4.cmml" xref="A2.E21.m1.4.4"><divide id="A2.E21.m1.4.4.5.cmml" xref="A2.E21.m1.4.4"></divide><apply id="A2.E21.m1.2.2.2.cmml" xref="A2.E21.m1.2.2.2"><csymbol cd="ambiguous" id="A2.E21.m1.2.2.2.3.cmml" xref="A2.E21.m1.2.2.2">superscript</csymbol><ci id="A2.E21.m1.2.2.2.4.cmml" xref="A2.E21.m1.2.2.2.4">ğ‘’</ci><apply id="A2.E21.m1.2.2.2.2.2.cmml" xref="A2.E21.m1.2.2.2.2.2"><times id="A2.E21.m1.2.2.2.2.2.3.cmml" xref="A2.E21.m1.2.2.2.2.2.3"></times><apply id="A2.E21.m1.2.2.2.2.2.4.cmml" xref="A2.E21.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="A2.E21.m1.2.2.2.2.2.4.1.cmml" xref="A2.E21.m1.2.2.2.2.2.4">subscript</csymbol><ci id="A2.E21.m1.2.2.2.2.2.4.2.cmml" xref="A2.E21.m1.2.2.2.2.2.4.2">ğ‘ </ci><ci id="A2.E21.m1.2.2.2.2.2.4.3.cmml" xref="A2.E21.m1.2.2.2.2.2.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E21.m1.2.2.2.2.2.2.2.cmml" xref="A2.E21.m1.2.2.2.2.2.2.1"><ci id="A2.E21.m1.1.1.1.1.1.1.cmml" xref="A2.E21.m1.1.1.1.1.1.1">ğ‘§</ci><apply id="A2.E21.m1.2.2.2.2.2.2.1.1.cmml" xref="A2.E21.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E21.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A2.E21.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A2.E21.m1.2.2.2.2.2.2.1.1.2.cmml" xref="A2.E21.m1.2.2.2.2.2.2.1.1.2">ğ‘¡</ci><ci id="A2.E21.m1.2.2.2.2.2.2.1.1.3.cmml" xref="A2.E21.m1.2.2.2.2.2.2.1.1.3">ğ‘–</ci></apply></interval></apply></apply><apply id="A2.E21.m1.4.4.4.cmml" xref="A2.E21.m1.4.4.4"><apply id="A2.E21.m1.4.4.4.3.cmml" xref="A2.E21.m1.4.4.4.3"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.4.3.1.cmml" xref="A2.E21.m1.4.4.4.3">subscript</csymbol><sum id="A2.E21.m1.4.4.4.3.2.cmml" xref="A2.E21.m1.4.4.4.3.2"></sum><apply id="A2.E21.m1.4.4.4.3.3.cmml" xref="A2.E21.m1.4.4.4.3.3"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.4.3.3.1.cmml" xref="A2.E21.m1.4.4.4.3.3">superscript</csymbol><ci id="A2.E21.m1.4.4.4.3.3.2.cmml" xref="A2.E21.m1.4.4.4.3.3.2">ğ‘§</ci><ci id="A2.E21.m1.4.4.4.3.3.3.cmml" xref="A2.E21.m1.4.4.4.3.3.3">â€²</ci></apply></apply><apply id="A2.E21.m1.4.4.4.4.cmml" xref="A2.E21.m1.4.4.4.4"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.4.4.1.cmml" xref="A2.E21.m1.4.4.4.4">superscript</csymbol><ci id="A2.E21.m1.4.4.4.4.2.cmml" xref="A2.E21.m1.4.4.4.4.2">ğ‘’</ci><apply id="A2.E21.m1.4.4.4.2.2.cmml" xref="A2.E21.m1.4.4.4.2.2"><times id="A2.E21.m1.4.4.4.2.2.3.cmml" xref="A2.E21.m1.4.4.4.2.2.3"></times><apply id="A2.E21.m1.4.4.4.2.2.4.cmml" xref="A2.E21.m1.4.4.4.2.2.4"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.4.2.2.4.1.cmml" xref="A2.E21.m1.4.4.4.2.2.4">subscript</csymbol><ci id="A2.E21.m1.4.4.4.2.2.4.2.cmml" xref="A2.E21.m1.4.4.4.2.2.4.2">ğ‘ </ci><ci id="A2.E21.m1.4.4.4.2.2.4.3.cmml" xref="A2.E21.m1.4.4.4.2.2.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E21.m1.4.4.4.2.2.2.3.cmml" xref="A2.E21.m1.4.4.4.2.2.2.2"><apply id="A2.E21.m1.3.3.3.1.1.1.1.1.cmml" xref="A2.E21.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E21.m1.3.3.3.1.1.1.1.1.1.cmml" xref="A2.E21.m1.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="A2.E21.m1.3.3.3.1.1.1.1.1.2.cmml" xref="A2.E21.m1.3.3.3.1.1.1.1.1.2">ğ‘§</ci><ci id="A2.E21.m1.3.3.3.1.1.1.1.1.3.cmml" xref="A2.E21.m1.3.3.3.1.1.1.1.1.3">â€²</ci></apply><apply id="A2.E21.m1.4.4.4.2.2.2.2.2.cmml" xref="A2.E21.m1.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E21.m1.4.4.4.2.2.2.2.2.1.cmml" xref="A2.E21.m1.4.4.4.2.2.2.2.2">subscript</csymbol><ci id="A2.E21.m1.4.4.4.2.2.2.2.2.2.cmml" xref="A2.E21.m1.4.4.4.2.2.2.2.2.2">ğ‘¡</ci><ci id="A2.E21.m1.4.4.4.2.2.2.2.2.3.cmml" xref="A2.E21.m1.4.4.4.2.2.2.2.2.3">ğ‘–</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E21.m1.6c">\displaystyle=-\sum_{z}\tilde{p}_{\mathtt{LM}}(z|t_{i},y_{i})\log\Bigg{[}\frac%
{e^{s_{\phi}(z,t_{i})}}{\sum_{z^{\prime}}e^{s_{\phi}(z^{\prime},t_{i})}}\Bigg{]}</annotation><annotation encoding="application/x-llamapun" id="A2.E21.m1.6d">= - âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log [ divide start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
<tbody id="A2.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{z}\tilde{p}_{\mathtt{LM}}(z|t_{i},y_{i})\log\Bigg{[}\sum_{%
z^{\prime}}e^{s_{\phi}(z^{\prime},t_{i})}\Bigg{]}-\sum_{z}\tilde{p}_{\mathtt{%
LM}}(z|t_{i},y_{i})s_{\phi}(z,t_{i})" class="ltx_Math" display="inline" id="A2.E22.m1.8"><semantics id="A2.E22.m1.8a"><mrow id="A2.E22.m1.8.8" xref="A2.E22.m1.8.8.cmml"><mi id="A2.E22.m1.8.8.6" xref="A2.E22.m1.8.8.6.cmml"></mi><mo id="A2.E22.m1.8.8.5" xref="A2.E22.m1.8.8.5.cmml">=</mo><mrow id="A2.E22.m1.8.8.4" xref="A2.E22.m1.8.8.4.cmml"><mrow id="A2.E22.m1.6.6.2.2" xref="A2.E22.m1.6.6.2.2.cmml"><mstyle displaystyle="true" id="A2.E22.m1.6.6.2.2.3" xref="A2.E22.m1.6.6.2.2.3.cmml"><munder id="A2.E22.m1.6.6.2.2.3a" xref="A2.E22.m1.6.6.2.2.3.cmml"><mo id="A2.E22.m1.6.6.2.2.3.2" movablelimits="false" xref="A2.E22.m1.6.6.2.2.3.2.cmml">âˆ‘</mo><mi id="A2.E22.m1.6.6.2.2.3.3" xref="A2.E22.m1.6.6.2.2.3.3.cmml">z</mi></munder></mstyle><mrow id="A2.E22.m1.6.6.2.2.2" xref="A2.E22.m1.6.6.2.2.2.cmml"><msub id="A2.E22.m1.6.6.2.2.2.4" xref="A2.E22.m1.6.6.2.2.2.4.cmml"><mover accent="true" id="A2.E22.m1.6.6.2.2.2.4.2" xref="A2.E22.m1.6.6.2.2.2.4.2.cmml"><mi id="A2.E22.m1.6.6.2.2.2.4.2.2" xref="A2.E22.m1.6.6.2.2.2.4.2.2.cmml">p</mi><mo id="A2.E22.m1.6.6.2.2.2.4.2.1" xref="A2.E22.m1.6.6.2.2.2.4.2.1.cmml">~</mo></mover><mi id="A2.E22.m1.6.6.2.2.2.4.3" xref="A2.E22.m1.6.6.2.2.2.4.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E22.m1.6.6.2.2.2.3" xref="A2.E22.m1.6.6.2.2.2.3.cmml">â¢</mo><mrow id="A2.E22.m1.5.5.1.1.1.1.1" xref="A2.E22.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A2.E22.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="A2.E22.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E22.m1.5.5.1.1.1.1.1.1" xref="A2.E22.m1.5.5.1.1.1.1.1.1.cmml"><mi id="A2.E22.m1.5.5.1.1.1.1.1.1.4" xref="A2.E22.m1.5.5.1.1.1.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E22.m1.5.5.1.1.1.1.1.1.3" xref="A2.E22.m1.5.5.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.3.cmml"><msub id="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.3" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.3" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E22.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="A2.E22.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E22.m1.6.6.2.2.2.3a" lspace="0.167em" xref="A2.E22.m1.6.6.2.2.2.3.cmml">â¢</mo><mrow id="A2.E22.m1.6.6.2.2.2.2.1" xref="A2.E22.m1.6.6.2.2.2.2.2.cmml"><mi id="A2.E22.m1.3.3" xref="A2.E22.m1.3.3.cmml">log</mi><mo id="A2.E22.m1.6.6.2.2.2.2.1a" xref="A2.E22.m1.6.6.2.2.2.2.2.cmml">â¡</mo><mrow id="A2.E22.m1.6.6.2.2.2.2.1.1" xref="A2.E22.m1.6.6.2.2.2.2.2.cmml"><mo id="A2.E22.m1.6.6.2.2.2.2.1.1.2" maxsize="260%" minsize="260%" xref="A2.E22.m1.6.6.2.2.2.2.2.cmml">[</mo><mrow id="A2.E22.m1.6.6.2.2.2.2.1.1.1" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.cmml"><munder id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1a" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.cmml"><mo id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.2" movablelimits="false" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.2.cmml">âˆ‘</mo><msup id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.cmml"><mi id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.2" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.2.cmml">z</mi><mo id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.3" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.3.cmml">â€²</mo></msup></munder></mstyle><msup id="A2.E22.m1.6.6.2.2.2.2.1.1.1.2" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.2.cmml"><mi id="A2.E22.m1.6.6.2.2.2.2.1.1.1.2.2" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.2.2.cmml">e</mi><mrow id="A2.E22.m1.2.2.2" xref="A2.E22.m1.2.2.2.cmml"><msub id="A2.E22.m1.2.2.2.4" xref="A2.E22.m1.2.2.2.4.cmml"><mi id="A2.E22.m1.2.2.2.4.2" xref="A2.E22.m1.2.2.2.4.2.cmml">s</mi><mi id="A2.E22.m1.2.2.2.4.3" xref="A2.E22.m1.2.2.2.4.3.cmml">Ï•</mi></msub><mo id="A2.E22.m1.2.2.2.3" xref="A2.E22.m1.2.2.2.3.cmml">â¢</mo><mrow id="A2.E22.m1.2.2.2.2.2" xref="A2.E22.m1.2.2.2.2.3.cmml"><mo id="A2.E22.m1.2.2.2.2.2.3" stretchy="false" xref="A2.E22.m1.2.2.2.2.3.cmml">(</mo><msup id="A2.E22.m1.1.1.1.1.1.1" xref="A2.E22.m1.1.1.1.1.1.1.cmml"><mi id="A2.E22.m1.1.1.1.1.1.1.2" xref="A2.E22.m1.1.1.1.1.1.1.2.cmml">z</mi><mo id="A2.E22.m1.1.1.1.1.1.1.3" xref="A2.E22.m1.1.1.1.1.1.1.3.cmml">â€²</mo></msup><mo id="A2.E22.m1.2.2.2.2.2.4" xref="A2.E22.m1.2.2.2.2.3.cmml">,</mo><msub id="A2.E22.m1.2.2.2.2.2.2" xref="A2.E22.m1.2.2.2.2.2.2.cmml"><mi id="A2.E22.m1.2.2.2.2.2.2.2" xref="A2.E22.m1.2.2.2.2.2.2.2.cmml">t</mi><mi id="A2.E22.m1.2.2.2.2.2.2.3" xref="A2.E22.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="A2.E22.m1.2.2.2.2.2.5" stretchy="false" xref="A2.E22.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></msup></mrow><mo id="A2.E22.m1.6.6.2.2.2.2.1.1.3" maxsize="260%" minsize="260%" xref="A2.E22.m1.6.6.2.2.2.2.2.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="A2.E22.m1.8.8.4.5" xref="A2.E22.m1.8.8.4.5.cmml">âˆ’</mo><mrow id="A2.E22.m1.8.8.4.4" xref="A2.E22.m1.8.8.4.4.cmml"><mstyle displaystyle="true" id="A2.E22.m1.8.8.4.4.3" xref="A2.E22.m1.8.8.4.4.3.cmml"><munder id="A2.E22.m1.8.8.4.4.3a" xref="A2.E22.m1.8.8.4.4.3.cmml"><mo id="A2.E22.m1.8.8.4.4.3.2" movablelimits="false" xref="A2.E22.m1.8.8.4.4.3.2.cmml">âˆ‘</mo><mi id="A2.E22.m1.8.8.4.4.3.3" xref="A2.E22.m1.8.8.4.4.3.3.cmml">z</mi></munder></mstyle><mrow id="A2.E22.m1.8.8.4.4.2" xref="A2.E22.m1.8.8.4.4.2.cmml"><msub id="A2.E22.m1.8.8.4.4.2.4" xref="A2.E22.m1.8.8.4.4.2.4.cmml"><mover accent="true" id="A2.E22.m1.8.8.4.4.2.4.2" xref="A2.E22.m1.8.8.4.4.2.4.2.cmml"><mi id="A2.E22.m1.8.8.4.4.2.4.2.2" xref="A2.E22.m1.8.8.4.4.2.4.2.2.cmml">p</mi><mo id="A2.E22.m1.8.8.4.4.2.4.2.1" xref="A2.E22.m1.8.8.4.4.2.4.2.1.cmml">~</mo></mover><mi id="A2.E22.m1.8.8.4.4.2.4.3" xref="A2.E22.m1.8.8.4.4.2.4.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E22.m1.8.8.4.4.2.3" xref="A2.E22.m1.8.8.4.4.2.3.cmml">â¢</mo><mrow id="A2.E22.m1.7.7.3.3.1.1.1" xref="A2.E22.m1.7.7.3.3.1.1.1.1.cmml"><mo id="A2.E22.m1.7.7.3.3.1.1.1.2" stretchy="false" xref="A2.E22.m1.7.7.3.3.1.1.1.1.cmml">(</mo><mrow id="A2.E22.m1.7.7.3.3.1.1.1.1" xref="A2.E22.m1.7.7.3.3.1.1.1.1.cmml"><mi id="A2.E22.m1.7.7.3.3.1.1.1.1.4" xref="A2.E22.m1.7.7.3.3.1.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E22.m1.7.7.3.3.1.1.1.1.3" xref="A2.E22.m1.7.7.3.3.1.1.1.1.3.cmml">|</mo><mrow id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.3.cmml"><msub id="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1" xref="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.cmml"><mi id="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.2" xref="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.3" xref="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.3" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.cmml"><mi id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.2" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.3" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E22.m1.7.7.3.3.1.1.1.3" stretchy="false" xref="A2.E22.m1.7.7.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E22.m1.8.8.4.4.2.3a" xref="A2.E22.m1.8.8.4.4.2.3.cmml">â¢</mo><msub id="A2.E22.m1.8.8.4.4.2.5" xref="A2.E22.m1.8.8.4.4.2.5.cmml"><mi id="A2.E22.m1.8.8.4.4.2.5.2" xref="A2.E22.m1.8.8.4.4.2.5.2.cmml">s</mi><mi id="A2.E22.m1.8.8.4.4.2.5.3" xref="A2.E22.m1.8.8.4.4.2.5.3.cmml">Ï•</mi></msub><mo id="A2.E22.m1.8.8.4.4.2.3b" xref="A2.E22.m1.8.8.4.4.2.3.cmml">â¢</mo><mrow id="A2.E22.m1.8.8.4.4.2.2.1" xref="A2.E22.m1.8.8.4.4.2.2.2.cmml"><mo id="A2.E22.m1.8.8.4.4.2.2.1.2" stretchy="false" xref="A2.E22.m1.8.8.4.4.2.2.2.cmml">(</mo><mi id="A2.E22.m1.4.4" xref="A2.E22.m1.4.4.cmml">z</mi><mo id="A2.E22.m1.8.8.4.4.2.2.1.3" xref="A2.E22.m1.8.8.4.4.2.2.2.cmml">,</mo><msub id="A2.E22.m1.8.8.4.4.2.2.1.1" xref="A2.E22.m1.8.8.4.4.2.2.1.1.cmml"><mi id="A2.E22.m1.8.8.4.4.2.2.1.1.2" xref="A2.E22.m1.8.8.4.4.2.2.1.1.2.cmml">t</mi><mi id="A2.E22.m1.8.8.4.4.2.2.1.1.3" xref="A2.E22.m1.8.8.4.4.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.E22.m1.8.8.4.4.2.2.1.4" stretchy="false" xref="A2.E22.m1.8.8.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E22.m1.8b"><apply id="A2.E22.m1.8.8.cmml" xref="A2.E22.m1.8.8"><eq id="A2.E22.m1.8.8.5.cmml" xref="A2.E22.m1.8.8.5"></eq><csymbol cd="latexml" id="A2.E22.m1.8.8.6.cmml" xref="A2.E22.m1.8.8.6">absent</csymbol><apply id="A2.E22.m1.8.8.4.cmml" xref="A2.E22.m1.8.8.4"><minus id="A2.E22.m1.8.8.4.5.cmml" xref="A2.E22.m1.8.8.4.5"></minus><apply id="A2.E22.m1.6.6.2.2.cmml" xref="A2.E22.m1.6.6.2.2"><apply id="A2.E22.m1.6.6.2.2.3.cmml" xref="A2.E22.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="A2.E22.m1.6.6.2.2.3.1.cmml" xref="A2.E22.m1.6.6.2.2.3">subscript</csymbol><sum id="A2.E22.m1.6.6.2.2.3.2.cmml" xref="A2.E22.m1.6.6.2.2.3.2"></sum><ci id="A2.E22.m1.6.6.2.2.3.3.cmml" xref="A2.E22.m1.6.6.2.2.3.3">ğ‘§</ci></apply><apply id="A2.E22.m1.6.6.2.2.2.cmml" xref="A2.E22.m1.6.6.2.2.2"><times id="A2.E22.m1.6.6.2.2.2.3.cmml" xref="A2.E22.m1.6.6.2.2.2.3"></times><apply id="A2.E22.m1.6.6.2.2.2.4.cmml" xref="A2.E22.m1.6.6.2.2.2.4"><csymbol cd="ambiguous" id="A2.E22.m1.6.6.2.2.2.4.1.cmml" xref="A2.E22.m1.6.6.2.2.2.4">subscript</csymbol><apply id="A2.E22.m1.6.6.2.2.2.4.2.cmml" xref="A2.E22.m1.6.6.2.2.2.4.2"><ci id="A2.E22.m1.6.6.2.2.2.4.2.1.cmml" xref="A2.E22.m1.6.6.2.2.2.4.2.1">~</ci><ci id="A2.E22.m1.6.6.2.2.2.4.2.2.cmml" xref="A2.E22.m1.6.6.2.2.2.4.2.2">ğ‘</ci></apply><ci id="A2.E22.m1.6.6.2.2.2.4.3.cmml" xref="A2.E22.m1.6.6.2.2.2.4.3">ğ™»ğ™¼</ci></apply><apply id="A2.E22.m1.5.5.1.1.1.1.1.1.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="A2.E22.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.3">conditional</csymbol><ci id="A2.E22.m1.5.5.1.1.1.1.1.1.4.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.4">ğ‘§</ci><list id="A2.E22.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2"><apply id="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E22.m1.5.5.1.1.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply><apply id="A2.E22.m1.6.6.2.2.2.2.2.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1"><log id="A2.E22.m1.3.3.cmml" xref="A2.E22.m1.3.3"></log><apply id="A2.E22.m1.6.6.2.2.2.2.1.1.1.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1"><apply id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.1.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1">subscript</csymbol><sum id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.2.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.2"></sum><apply id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.1.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3">superscript</csymbol><ci id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.2.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.2">ğ‘§</ci><ci id="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.3.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.1.3.3">â€²</ci></apply></apply><apply id="A2.E22.m1.6.6.2.2.2.2.1.1.1.2.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.E22.m1.6.6.2.2.2.2.1.1.1.2.1.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="A2.E22.m1.6.6.2.2.2.2.1.1.1.2.2.cmml" xref="A2.E22.m1.6.6.2.2.2.2.1.1.1.2.2">ğ‘’</ci><apply id="A2.E22.m1.2.2.2.cmml" xref="A2.E22.m1.2.2.2"><times id="A2.E22.m1.2.2.2.3.cmml" xref="A2.E22.m1.2.2.2.3"></times><apply id="A2.E22.m1.2.2.2.4.cmml" xref="A2.E22.m1.2.2.2.4"><csymbol cd="ambiguous" id="A2.E22.m1.2.2.2.4.1.cmml" xref="A2.E22.m1.2.2.2.4">subscript</csymbol><ci id="A2.E22.m1.2.2.2.4.2.cmml" xref="A2.E22.m1.2.2.2.4.2">ğ‘ </ci><ci id="A2.E22.m1.2.2.2.4.3.cmml" xref="A2.E22.m1.2.2.2.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E22.m1.2.2.2.2.3.cmml" xref="A2.E22.m1.2.2.2.2.2"><apply id="A2.E22.m1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E22.m1.1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.1.1.1.1.1.1">superscript</csymbol><ci id="A2.E22.m1.1.1.1.1.1.1.2.cmml" xref="A2.E22.m1.1.1.1.1.1.1.2">ğ‘§</ci><ci id="A2.E22.m1.1.1.1.1.1.1.3.cmml" xref="A2.E22.m1.1.1.1.1.1.1.3">â€²</ci></apply><apply id="A2.E22.m1.2.2.2.2.2.2.cmml" xref="A2.E22.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E22.m1.2.2.2.2.2.2.1.cmml" xref="A2.E22.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A2.E22.m1.2.2.2.2.2.2.2.cmml" xref="A2.E22.m1.2.2.2.2.2.2.2">ğ‘¡</ci><ci id="A2.E22.m1.2.2.2.2.2.2.3.cmml" xref="A2.E22.m1.2.2.2.2.2.2.3">ğ‘–</ci></apply></interval></apply></apply></apply></apply></apply></apply><apply id="A2.E22.m1.8.8.4.4.cmml" xref="A2.E22.m1.8.8.4.4"><apply id="A2.E22.m1.8.8.4.4.3.cmml" xref="A2.E22.m1.8.8.4.4.3"><csymbol cd="ambiguous" id="A2.E22.m1.8.8.4.4.3.1.cmml" xref="A2.E22.m1.8.8.4.4.3">subscript</csymbol><sum id="A2.E22.m1.8.8.4.4.3.2.cmml" xref="A2.E22.m1.8.8.4.4.3.2"></sum><ci id="A2.E22.m1.8.8.4.4.3.3.cmml" xref="A2.E22.m1.8.8.4.4.3.3">ğ‘§</ci></apply><apply id="A2.E22.m1.8.8.4.4.2.cmml" xref="A2.E22.m1.8.8.4.4.2"><times id="A2.E22.m1.8.8.4.4.2.3.cmml" xref="A2.E22.m1.8.8.4.4.2.3"></times><apply id="A2.E22.m1.8.8.4.4.2.4.cmml" xref="A2.E22.m1.8.8.4.4.2.4"><csymbol cd="ambiguous" id="A2.E22.m1.8.8.4.4.2.4.1.cmml" xref="A2.E22.m1.8.8.4.4.2.4">subscript</csymbol><apply id="A2.E22.m1.8.8.4.4.2.4.2.cmml" xref="A2.E22.m1.8.8.4.4.2.4.2"><ci id="A2.E22.m1.8.8.4.4.2.4.2.1.cmml" xref="A2.E22.m1.8.8.4.4.2.4.2.1">~</ci><ci id="A2.E22.m1.8.8.4.4.2.4.2.2.cmml" xref="A2.E22.m1.8.8.4.4.2.4.2.2">ğ‘</ci></apply><ci id="A2.E22.m1.8.8.4.4.2.4.3.cmml" xref="A2.E22.m1.8.8.4.4.2.4.3">ğ™»ğ™¼</ci></apply><apply id="A2.E22.m1.7.7.3.3.1.1.1.1.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1"><csymbol cd="latexml" id="A2.E22.m1.7.7.3.3.1.1.1.1.3.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.3">conditional</csymbol><ci id="A2.E22.m1.7.7.3.3.1.1.1.1.4.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.4">ğ‘§</ci><list id="A2.E22.m1.7.7.3.3.1.1.1.1.2.3.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2"><apply id="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.1.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.2.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.3.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.1.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.2.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.3.cmml" xref="A2.E22.m1.7.7.3.3.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply><apply id="A2.E22.m1.8.8.4.4.2.5.cmml" xref="A2.E22.m1.8.8.4.4.2.5"><csymbol cd="ambiguous" id="A2.E22.m1.8.8.4.4.2.5.1.cmml" xref="A2.E22.m1.8.8.4.4.2.5">subscript</csymbol><ci id="A2.E22.m1.8.8.4.4.2.5.2.cmml" xref="A2.E22.m1.8.8.4.4.2.5.2">ğ‘ </ci><ci id="A2.E22.m1.8.8.4.4.2.5.3.cmml" xref="A2.E22.m1.8.8.4.4.2.5.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E22.m1.8.8.4.4.2.2.2.cmml" xref="A2.E22.m1.8.8.4.4.2.2.1"><ci id="A2.E22.m1.4.4.cmml" xref="A2.E22.m1.4.4">ğ‘§</ci><apply id="A2.E22.m1.8.8.4.4.2.2.1.1.cmml" xref="A2.E22.m1.8.8.4.4.2.2.1.1"><csymbol cd="ambiguous" id="A2.E22.m1.8.8.4.4.2.2.1.1.1.cmml" xref="A2.E22.m1.8.8.4.4.2.2.1.1">subscript</csymbol><ci id="A2.E22.m1.8.8.4.4.2.2.1.1.2.cmml" xref="A2.E22.m1.8.8.4.4.2.2.1.1.2">ğ‘¡</ci><ci id="A2.E22.m1.8.8.4.4.2.2.1.1.3.cmml" xref="A2.E22.m1.8.8.4.4.2.2.1.1.3">ğ‘–</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E22.m1.8c">\displaystyle=\sum_{z}\tilde{p}_{\mathtt{LM}}(z|t_{i},y_{i})\log\Bigg{[}\sum_{%
z^{\prime}}e^{s_{\phi}(z^{\prime},t_{i})}\Bigg{]}-\sum_{z}\tilde{p}_{\mathtt{%
LM}}(z|t_{i},y_{i})s_{\phi}(z,t_{i})</annotation><annotation encoding="application/x-llamapun" id="A2.E22.m1.8d">= âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log [ âˆ‘ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT ] - âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
<tbody id="A2.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\log\Bigg{[}\sum_{z}e^{s_{\phi}(z,t_{i})}\Bigg{]}-\sum_{z}\tilde%
{p}_{\mathtt{LM}}(z|t_{i},y_{i})s_{\phi}(z,t_{i})" class="ltx_Math" display="inline" id="A2.E23.m1.7"><semantics id="A2.E23.m1.7a"><mrow id="A2.E23.m1.7.7" xref="A2.E23.m1.7.7.cmml"><mi id="A2.E23.m1.7.7.5" xref="A2.E23.m1.7.7.5.cmml"></mi><mo id="A2.E23.m1.7.7.4" xref="A2.E23.m1.7.7.4.cmml">=</mo><mrow id="A2.E23.m1.7.7.3" xref="A2.E23.m1.7.7.3.cmml"><mrow id="A2.E23.m1.5.5.1.1.1" xref="A2.E23.m1.5.5.1.1.2.cmml"><mi id="A2.E23.m1.3.3" xref="A2.E23.m1.3.3.cmml">log</mi><mo id="A2.E23.m1.5.5.1.1.1a" xref="A2.E23.m1.5.5.1.1.2.cmml">â¡</mo><mrow id="A2.E23.m1.5.5.1.1.1.1" xref="A2.E23.m1.5.5.1.1.2.cmml"><mo id="A2.E23.m1.5.5.1.1.1.1.2" maxsize="260%" minsize="260%" xref="A2.E23.m1.5.5.1.1.2.cmml">[</mo><mrow id="A2.E23.m1.5.5.1.1.1.1.1" xref="A2.E23.m1.5.5.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.E23.m1.5.5.1.1.1.1.1.1" xref="A2.E23.m1.5.5.1.1.1.1.1.1.cmml"><munder id="A2.E23.m1.5.5.1.1.1.1.1.1a" xref="A2.E23.m1.5.5.1.1.1.1.1.1.cmml"><mo id="A2.E23.m1.5.5.1.1.1.1.1.1.2" movablelimits="false" xref="A2.E23.m1.5.5.1.1.1.1.1.1.2.cmml">âˆ‘</mo><mi id="A2.E23.m1.5.5.1.1.1.1.1.1.3" xref="A2.E23.m1.5.5.1.1.1.1.1.1.3.cmml">z</mi></munder></mstyle><msup id="A2.E23.m1.5.5.1.1.1.1.1.2" xref="A2.E23.m1.5.5.1.1.1.1.1.2.cmml"><mi id="A2.E23.m1.5.5.1.1.1.1.1.2.2" xref="A2.E23.m1.5.5.1.1.1.1.1.2.2.cmml">e</mi><mrow id="A2.E23.m1.2.2.2" xref="A2.E23.m1.2.2.2.cmml"><msub id="A2.E23.m1.2.2.2.4" xref="A2.E23.m1.2.2.2.4.cmml"><mi id="A2.E23.m1.2.2.2.4.2" xref="A2.E23.m1.2.2.2.4.2.cmml">s</mi><mi id="A2.E23.m1.2.2.2.4.3" xref="A2.E23.m1.2.2.2.4.3.cmml">Ï•</mi></msub><mo id="A2.E23.m1.2.2.2.3" xref="A2.E23.m1.2.2.2.3.cmml">â¢</mo><mrow id="A2.E23.m1.2.2.2.2.1" xref="A2.E23.m1.2.2.2.2.2.cmml"><mo id="A2.E23.m1.2.2.2.2.1.2" stretchy="false" xref="A2.E23.m1.2.2.2.2.2.cmml">(</mo><mi id="A2.E23.m1.1.1.1.1" xref="A2.E23.m1.1.1.1.1.cmml">z</mi><mo id="A2.E23.m1.2.2.2.2.1.3" xref="A2.E23.m1.2.2.2.2.2.cmml">,</mo><msub id="A2.E23.m1.2.2.2.2.1.1" xref="A2.E23.m1.2.2.2.2.1.1.cmml"><mi id="A2.E23.m1.2.2.2.2.1.1.2" xref="A2.E23.m1.2.2.2.2.1.1.2.cmml">t</mi><mi id="A2.E23.m1.2.2.2.2.1.1.3" xref="A2.E23.m1.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.E23.m1.2.2.2.2.1.4" stretchy="false" xref="A2.E23.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></msup></mrow><mo id="A2.E23.m1.5.5.1.1.1.1.3" maxsize="260%" minsize="260%" xref="A2.E23.m1.5.5.1.1.2.cmml">]</mo></mrow></mrow><mo id="A2.E23.m1.7.7.3.4" xref="A2.E23.m1.7.7.3.4.cmml">âˆ’</mo><mrow id="A2.E23.m1.7.7.3.3" xref="A2.E23.m1.7.7.3.3.cmml"><mstyle displaystyle="true" id="A2.E23.m1.7.7.3.3.3" xref="A2.E23.m1.7.7.3.3.3.cmml"><munder id="A2.E23.m1.7.7.3.3.3a" xref="A2.E23.m1.7.7.3.3.3.cmml"><mo id="A2.E23.m1.7.7.3.3.3.2" movablelimits="false" xref="A2.E23.m1.7.7.3.3.3.2.cmml">âˆ‘</mo><mi id="A2.E23.m1.7.7.3.3.3.3" xref="A2.E23.m1.7.7.3.3.3.3.cmml">z</mi></munder></mstyle><mrow id="A2.E23.m1.7.7.3.3.2" xref="A2.E23.m1.7.7.3.3.2.cmml"><msub id="A2.E23.m1.7.7.3.3.2.4" xref="A2.E23.m1.7.7.3.3.2.4.cmml"><mover accent="true" id="A2.E23.m1.7.7.3.3.2.4.2" xref="A2.E23.m1.7.7.3.3.2.4.2.cmml"><mi id="A2.E23.m1.7.7.3.3.2.4.2.2" xref="A2.E23.m1.7.7.3.3.2.4.2.2.cmml">p</mi><mo id="A2.E23.m1.7.7.3.3.2.4.2.1" xref="A2.E23.m1.7.7.3.3.2.4.2.1.cmml">~</mo></mover><mi id="A2.E23.m1.7.7.3.3.2.4.3" xref="A2.E23.m1.7.7.3.3.2.4.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E23.m1.7.7.3.3.2.3" xref="A2.E23.m1.7.7.3.3.2.3.cmml">â¢</mo><mrow id="A2.E23.m1.6.6.2.2.1.1.1" xref="A2.E23.m1.6.6.2.2.1.1.1.1.cmml"><mo id="A2.E23.m1.6.6.2.2.1.1.1.2" stretchy="false" xref="A2.E23.m1.6.6.2.2.1.1.1.1.cmml">(</mo><mrow id="A2.E23.m1.6.6.2.2.1.1.1.1" xref="A2.E23.m1.6.6.2.2.1.1.1.1.cmml"><mi id="A2.E23.m1.6.6.2.2.1.1.1.1.4" xref="A2.E23.m1.6.6.2.2.1.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E23.m1.6.6.2.2.1.1.1.1.3" xref="A2.E23.m1.6.6.2.2.1.1.1.1.3.cmml">|</mo><mrow id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.3.cmml"><msub id="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1" xref="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.cmml"><mi id="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.2" xref="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.3" xref="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.3" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.cmml"><mi id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.2" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.3" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E23.m1.6.6.2.2.1.1.1.3" stretchy="false" xref="A2.E23.m1.6.6.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E23.m1.7.7.3.3.2.3a" xref="A2.E23.m1.7.7.3.3.2.3.cmml">â¢</mo><msub id="A2.E23.m1.7.7.3.3.2.5" xref="A2.E23.m1.7.7.3.3.2.5.cmml"><mi id="A2.E23.m1.7.7.3.3.2.5.2" xref="A2.E23.m1.7.7.3.3.2.5.2.cmml">s</mi><mi id="A2.E23.m1.7.7.3.3.2.5.3" xref="A2.E23.m1.7.7.3.3.2.5.3.cmml">Ï•</mi></msub><mo id="A2.E23.m1.7.7.3.3.2.3b" xref="A2.E23.m1.7.7.3.3.2.3.cmml">â¢</mo><mrow id="A2.E23.m1.7.7.3.3.2.2.1" xref="A2.E23.m1.7.7.3.3.2.2.2.cmml"><mo id="A2.E23.m1.7.7.3.3.2.2.1.2" stretchy="false" xref="A2.E23.m1.7.7.3.3.2.2.2.cmml">(</mo><mi id="A2.E23.m1.4.4" xref="A2.E23.m1.4.4.cmml">z</mi><mo id="A2.E23.m1.7.7.3.3.2.2.1.3" xref="A2.E23.m1.7.7.3.3.2.2.2.cmml">,</mo><msub id="A2.E23.m1.7.7.3.3.2.2.1.1" xref="A2.E23.m1.7.7.3.3.2.2.1.1.cmml"><mi id="A2.E23.m1.7.7.3.3.2.2.1.1.2" xref="A2.E23.m1.7.7.3.3.2.2.1.1.2.cmml">t</mi><mi id="A2.E23.m1.7.7.3.3.2.2.1.1.3" xref="A2.E23.m1.7.7.3.3.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.E23.m1.7.7.3.3.2.2.1.4" stretchy="false" xref="A2.E23.m1.7.7.3.3.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E23.m1.7b"><apply id="A2.E23.m1.7.7.cmml" xref="A2.E23.m1.7.7"><eq id="A2.E23.m1.7.7.4.cmml" xref="A2.E23.m1.7.7.4"></eq><csymbol cd="latexml" id="A2.E23.m1.7.7.5.cmml" xref="A2.E23.m1.7.7.5">absent</csymbol><apply id="A2.E23.m1.7.7.3.cmml" xref="A2.E23.m1.7.7.3"><minus id="A2.E23.m1.7.7.3.4.cmml" xref="A2.E23.m1.7.7.3.4"></minus><apply id="A2.E23.m1.5.5.1.1.2.cmml" xref="A2.E23.m1.5.5.1.1.1"><log id="A2.E23.m1.3.3.cmml" xref="A2.E23.m1.3.3"></log><apply id="A2.E23.m1.5.5.1.1.1.1.1.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1"><apply id="A2.E23.m1.5.5.1.1.1.1.1.1.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E23.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1.1">subscript</csymbol><sum id="A2.E23.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1.1.2"></sum><ci id="A2.E23.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1.1.3">ğ‘§</ci></apply><apply id="A2.E23.m1.5.5.1.1.1.1.1.2.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.E23.m1.5.5.1.1.1.1.1.2.1.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1.2">superscript</csymbol><ci id="A2.E23.m1.5.5.1.1.1.1.1.2.2.cmml" xref="A2.E23.m1.5.5.1.1.1.1.1.2.2">ğ‘’</ci><apply id="A2.E23.m1.2.2.2.cmml" xref="A2.E23.m1.2.2.2"><times id="A2.E23.m1.2.2.2.3.cmml" xref="A2.E23.m1.2.2.2.3"></times><apply id="A2.E23.m1.2.2.2.4.cmml" xref="A2.E23.m1.2.2.2.4"><csymbol cd="ambiguous" id="A2.E23.m1.2.2.2.4.1.cmml" xref="A2.E23.m1.2.2.2.4">subscript</csymbol><ci id="A2.E23.m1.2.2.2.4.2.cmml" xref="A2.E23.m1.2.2.2.4.2">ğ‘ </ci><ci id="A2.E23.m1.2.2.2.4.3.cmml" xref="A2.E23.m1.2.2.2.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E23.m1.2.2.2.2.2.cmml" xref="A2.E23.m1.2.2.2.2.1"><ci id="A2.E23.m1.1.1.1.1.cmml" xref="A2.E23.m1.1.1.1.1">ğ‘§</ci><apply id="A2.E23.m1.2.2.2.2.1.1.cmml" xref="A2.E23.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E23.m1.2.2.2.2.1.1.1.cmml" xref="A2.E23.m1.2.2.2.2.1.1">subscript</csymbol><ci id="A2.E23.m1.2.2.2.2.1.1.2.cmml" xref="A2.E23.m1.2.2.2.2.1.1.2">ğ‘¡</ci><ci id="A2.E23.m1.2.2.2.2.1.1.3.cmml" xref="A2.E23.m1.2.2.2.2.1.1.3">ğ‘–</ci></apply></interval></apply></apply></apply></apply><apply id="A2.E23.m1.7.7.3.3.cmml" xref="A2.E23.m1.7.7.3.3"><apply id="A2.E23.m1.7.7.3.3.3.cmml" xref="A2.E23.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="A2.E23.m1.7.7.3.3.3.1.cmml" xref="A2.E23.m1.7.7.3.3.3">subscript</csymbol><sum id="A2.E23.m1.7.7.3.3.3.2.cmml" xref="A2.E23.m1.7.7.3.3.3.2"></sum><ci id="A2.E23.m1.7.7.3.3.3.3.cmml" xref="A2.E23.m1.7.7.3.3.3.3">ğ‘§</ci></apply><apply id="A2.E23.m1.7.7.3.3.2.cmml" xref="A2.E23.m1.7.7.3.3.2"><times id="A2.E23.m1.7.7.3.3.2.3.cmml" xref="A2.E23.m1.7.7.3.3.2.3"></times><apply id="A2.E23.m1.7.7.3.3.2.4.cmml" xref="A2.E23.m1.7.7.3.3.2.4"><csymbol cd="ambiguous" id="A2.E23.m1.7.7.3.3.2.4.1.cmml" xref="A2.E23.m1.7.7.3.3.2.4">subscript</csymbol><apply id="A2.E23.m1.7.7.3.3.2.4.2.cmml" xref="A2.E23.m1.7.7.3.3.2.4.2"><ci id="A2.E23.m1.7.7.3.3.2.4.2.1.cmml" xref="A2.E23.m1.7.7.3.3.2.4.2.1">~</ci><ci id="A2.E23.m1.7.7.3.3.2.4.2.2.cmml" xref="A2.E23.m1.7.7.3.3.2.4.2.2">ğ‘</ci></apply><ci id="A2.E23.m1.7.7.3.3.2.4.3.cmml" xref="A2.E23.m1.7.7.3.3.2.4.3">ğ™»ğ™¼</ci></apply><apply id="A2.E23.m1.6.6.2.2.1.1.1.1.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1"><csymbol cd="latexml" id="A2.E23.m1.6.6.2.2.1.1.1.1.3.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.3">conditional</csymbol><ci id="A2.E23.m1.6.6.2.2.1.1.1.1.4.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.4">ğ‘§</ci><list id="A2.E23.m1.6.6.2.2.1.1.1.1.2.3.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2"><apply id="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.1.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.2.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.3.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.1.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.2.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.3.cmml" xref="A2.E23.m1.6.6.2.2.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply><apply id="A2.E23.m1.7.7.3.3.2.5.cmml" xref="A2.E23.m1.7.7.3.3.2.5"><csymbol cd="ambiguous" id="A2.E23.m1.7.7.3.3.2.5.1.cmml" xref="A2.E23.m1.7.7.3.3.2.5">subscript</csymbol><ci id="A2.E23.m1.7.7.3.3.2.5.2.cmml" xref="A2.E23.m1.7.7.3.3.2.5.2">ğ‘ </ci><ci id="A2.E23.m1.7.7.3.3.2.5.3.cmml" xref="A2.E23.m1.7.7.3.3.2.5.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E23.m1.7.7.3.3.2.2.2.cmml" xref="A2.E23.m1.7.7.3.3.2.2.1"><ci id="A2.E23.m1.4.4.cmml" xref="A2.E23.m1.4.4">ğ‘§</ci><apply id="A2.E23.m1.7.7.3.3.2.2.1.1.cmml" xref="A2.E23.m1.7.7.3.3.2.2.1.1"><csymbol cd="ambiguous" id="A2.E23.m1.7.7.3.3.2.2.1.1.1.cmml" xref="A2.E23.m1.7.7.3.3.2.2.1.1">subscript</csymbol><ci id="A2.E23.m1.7.7.3.3.2.2.1.1.2.cmml" xref="A2.E23.m1.7.7.3.3.2.2.1.1.2">ğ‘¡</ci><ci id="A2.E23.m1.7.7.3.3.2.2.1.1.3.cmml" xref="A2.E23.m1.7.7.3.3.2.2.1.1.3">ğ‘–</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E23.m1.7c">\displaystyle=\log\Bigg{[}\sum_{z}e^{s_{\phi}(z,t_{i})}\Bigg{]}-\sum_{z}\tilde%
{p}_{\mathtt{LM}}(z|t_{i},y_{i})s_{\phi}(z,t_{i})</annotation><annotation encoding="application/x-llamapun" id="A2.E23.m1.7d">= roman_log [ âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT ] - âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p1.15">Hence,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx21">
<tbody id="A2.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla\mathrm{KL}" class="ltx_Math" display="inline" id="A2.E24.m1.1"><semantics id="A2.E24.m1.1a"><mrow id="A2.E24.m1.1.1" xref="A2.E24.m1.1.1.cmml"><mo id="A2.E24.m1.1.1.1" rspace="0.167em" xref="A2.E24.m1.1.1.1.cmml">âˆ‡</mo><mi id="A2.E24.m1.1.1.2" xref="A2.E24.m1.1.1.2.cmml">KL</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.E24.m1.1b"><apply id="A2.E24.m1.1.1.cmml" xref="A2.E24.m1.1.1"><ci id="A2.E24.m1.1.1.1.cmml" xref="A2.E24.m1.1.1.1">âˆ‡</ci><ci id="A2.E24.m1.1.1.2.cmml" xref="A2.E24.m1.1.1.2">KL</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E24.m1.1c">\displaystyle\nabla\mathrm{KL}</annotation><annotation encoding="application/x-llamapun" id="A2.E24.m1.1d">âˆ‡ roman_KL</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\sum_{z}e^{s_{\phi}(z,t_{i})}\nabla s_{\phi}(z,t_{i})}{%
\sum_{z^{\prime}}e^{s_{\phi}(z^{\prime},t_{i})}}-\sum_{z}\tilde{p}_{\mathtt{LM%
}}(z|t_{i},y_{i})\nabla s_{\phi}(z,t_{i})" class="ltx_Math" display="inline" id="A2.E24.m2.9"><semantics id="A2.E24.m2.9a"><mrow id="A2.E24.m2.9.9" xref="A2.E24.m2.9.9.cmml"><mi id="A2.E24.m2.9.9.4" xref="A2.E24.m2.9.9.4.cmml"></mi><mo id="A2.E24.m2.9.9.3" xref="A2.E24.m2.9.9.3.cmml">=</mo><mrow id="A2.E24.m2.9.9.2" xref="A2.E24.m2.9.9.2.cmml"><mstyle displaystyle="true" id="A2.E24.m2.6.6" xref="A2.E24.m2.6.6.cmml"><mfrac id="A2.E24.m2.6.6a" xref="A2.E24.m2.6.6.cmml"><mrow id="A2.E24.m2.4.4.4" xref="A2.E24.m2.4.4.4.cmml"><msub id="A2.E24.m2.4.4.4.5" xref="A2.E24.m2.4.4.4.5.cmml"><mo id="A2.E24.m2.4.4.4.5.2" xref="A2.E24.m2.4.4.4.5.2.cmml">âˆ‘</mo><mi id="A2.E24.m2.4.4.4.5.3" xref="A2.E24.m2.4.4.4.5.3.cmml">z</mi></msub><mrow id="A2.E24.m2.4.4.4.4" xref="A2.E24.m2.4.4.4.4.cmml"><msup id="A2.E24.m2.4.4.4.4.3" xref="A2.E24.m2.4.4.4.4.3.cmml"><mi id="A2.E24.m2.4.4.4.4.3.2" xref="A2.E24.m2.4.4.4.4.3.2.cmml">e</mi><mrow id="A2.E24.m2.2.2.2.2.2" xref="A2.E24.m2.2.2.2.2.2.cmml"><msub id="A2.E24.m2.2.2.2.2.2.4" xref="A2.E24.m2.2.2.2.2.2.4.cmml"><mi id="A2.E24.m2.2.2.2.2.2.4.2" xref="A2.E24.m2.2.2.2.2.2.4.2.cmml">s</mi><mi id="A2.E24.m2.2.2.2.2.2.4.3" xref="A2.E24.m2.2.2.2.2.2.4.3.cmml">Ï•</mi></msub><mo id="A2.E24.m2.2.2.2.2.2.3" xref="A2.E24.m2.2.2.2.2.2.3.cmml">â¢</mo><mrow id="A2.E24.m2.2.2.2.2.2.2.1" xref="A2.E24.m2.2.2.2.2.2.2.2.cmml"><mo id="A2.E24.m2.2.2.2.2.2.2.1.2" stretchy="false" xref="A2.E24.m2.2.2.2.2.2.2.2.cmml">(</mo><mi id="A2.E24.m2.1.1.1.1.1.1" xref="A2.E24.m2.1.1.1.1.1.1.cmml">z</mi><mo id="A2.E24.m2.2.2.2.2.2.2.1.3" xref="A2.E24.m2.2.2.2.2.2.2.2.cmml">,</mo><msub id="A2.E24.m2.2.2.2.2.2.2.1.1" xref="A2.E24.m2.2.2.2.2.2.2.1.1.cmml"><mi id="A2.E24.m2.2.2.2.2.2.2.1.1.2" xref="A2.E24.m2.2.2.2.2.2.2.1.1.2.cmml">t</mi><mi id="A2.E24.m2.2.2.2.2.2.2.1.1.3" xref="A2.E24.m2.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.E24.m2.2.2.2.2.2.2.1.4" stretchy="false" xref="A2.E24.m2.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow></msup><mo id="A2.E24.m2.4.4.4.4.2" lspace="0.167em" xref="A2.E24.m2.4.4.4.4.2.cmml">â¢</mo><mrow id="A2.E24.m2.4.4.4.4.4" xref="A2.E24.m2.4.4.4.4.4.cmml"><mo id="A2.E24.m2.4.4.4.4.4.1" rspace="0.167em" xref="A2.E24.m2.4.4.4.4.4.1.cmml">âˆ‡</mo><msub id="A2.E24.m2.4.4.4.4.4.2" xref="A2.E24.m2.4.4.4.4.4.2.cmml"><mi id="A2.E24.m2.4.4.4.4.4.2.2" xref="A2.E24.m2.4.4.4.4.4.2.2.cmml">s</mi><mi id="A2.E24.m2.4.4.4.4.4.2.3" xref="A2.E24.m2.4.4.4.4.4.2.3.cmml">Ï•</mi></msub></mrow><mo id="A2.E24.m2.4.4.4.4.2a" xref="A2.E24.m2.4.4.4.4.2.cmml">â¢</mo><mrow id="A2.E24.m2.4.4.4.4.1.1" xref="A2.E24.m2.4.4.4.4.1.2.cmml"><mo id="A2.E24.m2.4.4.4.4.1.1.2" stretchy="false" xref="A2.E24.m2.4.4.4.4.1.2.cmml">(</mo><mi id="A2.E24.m2.3.3.3.3" xref="A2.E24.m2.3.3.3.3.cmml">z</mi><mo id="A2.E24.m2.4.4.4.4.1.1.3" xref="A2.E24.m2.4.4.4.4.1.2.cmml">,</mo><msub id="A2.E24.m2.4.4.4.4.1.1.1" xref="A2.E24.m2.4.4.4.4.1.1.1.cmml"><mi id="A2.E24.m2.4.4.4.4.1.1.1.2" xref="A2.E24.m2.4.4.4.4.1.1.1.2.cmml">t</mi><mi id="A2.E24.m2.4.4.4.4.1.1.1.3" xref="A2.E24.m2.4.4.4.4.1.1.1.3.cmml">i</mi></msub><mo id="A2.E24.m2.4.4.4.4.1.1.4" stretchy="false" xref="A2.E24.m2.4.4.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A2.E24.m2.6.6.6" xref="A2.E24.m2.6.6.6.cmml"><msub id="A2.E24.m2.6.6.6.3" xref="A2.E24.m2.6.6.6.3.cmml"><mo id="A2.E24.m2.6.6.6.3.2" xref="A2.E24.m2.6.6.6.3.2.cmml">âˆ‘</mo><msup id="A2.E24.m2.6.6.6.3.3" xref="A2.E24.m2.6.6.6.3.3.cmml"><mi id="A2.E24.m2.6.6.6.3.3.2" xref="A2.E24.m2.6.6.6.3.3.2.cmml">z</mi><mo id="A2.E24.m2.6.6.6.3.3.3" xref="A2.E24.m2.6.6.6.3.3.3.cmml">â€²</mo></msup></msub><msup id="A2.E24.m2.6.6.6.4" xref="A2.E24.m2.6.6.6.4.cmml"><mi id="A2.E24.m2.6.6.6.4.2" xref="A2.E24.m2.6.6.6.4.2.cmml">e</mi><mrow id="A2.E24.m2.6.6.6.2.2" xref="A2.E24.m2.6.6.6.2.2.cmml"><msub id="A2.E24.m2.6.6.6.2.2.4" xref="A2.E24.m2.6.6.6.2.2.4.cmml"><mi id="A2.E24.m2.6.6.6.2.2.4.2" xref="A2.E24.m2.6.6.6.2.2.4.2.cmml">s</mi><mi id="A2.E24.m2.6.6.6.2.2.4.3" xref="A2.E24.m2.6.6.6.2.2.4.3.cmml">Ï•</mi></msub><mo id="A2.E24.m2.6.6.6.2.2.3" xref="A2.E24.m2.6.6.6.2.2.3.cmml">â¢</mo><mrow id="A2.E24.m2.6.6.6.2.2.2.2" xref="A2.E24.m2.6.6.6.2.2.2.3.cmml"><mo id="A2.E24.m2.6.6.6.2.2.2.2.3" stretchy="false" xref="A2.E24.m2.6.6.6.2.2.2.3.cmml">(</mo><msup id="A2.E24.m2.5.5.5.1.1.1.1.1" xref="A2.E24.m2.5.5.5.1.1.1.1.1.cmml"><mi id="A2.E24.m2.5.5.5.1.1.1.1.1.2" xref="A2.E24.m2.5.5.5.1.1.1.1.1.2.cmml">z</mi><mo id="A2.E24.m2.5.5.5.1.1.1.1.1.3" xref="A2.E24.m2.5.5.5.1.1.1.1.1.3.cmml">â€²</mo></msup><mo id="A2.E24.m2.6.6.6.2.2.2.2.4" xref="A2.E24.m2.6.6.6.2.2.2.3.cmml">,</mo><msub id="A2.E24.m2.6.6.6.2.2.2.2.2" xref="A2.E24.m2.6.6.6.2.2.2.2.2.cmml"><mi id="A2.E24.m2.6.6.6.2.2.2.2.2.2" xref="A2.E24.m2.6.6.6.2.2.2.2.2.2.cmml">t</mi><mi id="A2.E24.m2.6.6.6.2.2.2.2.2.3" xref="A2.E24.m2.6.6.6.2.2.2.2.2.3.cmml">i</mi></msub><mo id="A2.E24.m2.6.6.6.2.2.2.2.5" stretchy="false" xref="A2.E24.m2.6.6.6.2.2.2.3.cmml">)</mo></mrow></mrow></msup></mrow></mfrac></mstyle><mo id="A2.E24.m2.9.9.2.3" xref="A2.E24.m2.9.9.2.3.cmml">âˆ’</mo><mrow id="A2.E24.m2.9.9.2.2" xref="A2.E24.m2.9.9.2.2.cmml"><mstyle displaystyle="true" id="A2.E24.m2.9.9.2.2.3" xref="A2.E24.m2.9.9.2.2.3.cmml"><munder id="A2.E24.m2.9.9.2.2.3a" xref="A2.E24.m2.9.9.2.2.3.cmml"><mo id="A2.E24.m2.9.9.2.2.3.2" movablelimits="false" xref="A2.E24.m2.9.9.2.2.3.2.cmml">âˆ‘</mo><mi id="A2.E24.m2.9.9.2.2.3.3" xref="A2.E24.m2.9.9.2.2.3.3.cmml">z</mi></munder></mstyle><mrow id="A2.E24.m2.9.9.2.2.2" xref="A2.E24.m2.9.9.2.2.2.cmml"><msub id="A2.E24.m2.9.9.2.2.2.4" xref="A2.E24.m2.9.9.2.2.2.4.cmml"><mover accent="true" id="A2.E24.m2.9.9.2.2.2.4.2" xref="A2.E24.m2.9.9.2.2.2.4.2.cmml"><mi id="A2.E24.m2.9.9.2.2.2.4.2.2" xref="A2.E24.m2.9.9.2.2.2.4.2.2.cmml">p</mi><mo id="A2.E24.m2.9.9.2.2.2.4.2.1" xref="A2.E24.m2.9.9.2.2.2.4.2.1.cmml">~</mo></mover><mi id="A2.E24.m2.9.9.2.2.2.4.3" xref="A2.E24.m2.9.9.2.2.2.4.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E24.m2.9.9.2.2.2.3" xref="A2.E24.m2.9.9.2.2.2.3.cmml">â¢</mo><mrow id="A2.E24.m2.8.8.1.1.1.1.1" xref="A2.E24.m2.8.8.1.1.1.1.1.1.cmml"><mo id="A2.E24.m2.8.8.1.1.1.1.1.2" stretchy="false" xref="A2.E24.m2.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E24.m2.8.8.1.1.1.1.1.1" xref="A2.E24.m2.8.8.1.1.1.1.1.1.cmml"><mi id="A2.E24.m2.8.8.1.1.1.1.1.1.4" xref="A2.E24.m2.8.8.1.1.1.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E24.m2.8.8.1.1.1.1.1.1.3" xref="A2.E24.m2.8.8.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.3.cmml"><msub id="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1" xref="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.2" xref="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.3" xref="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.3" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.2" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.3" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E24.m2.8.8.1.1.1.1.1.3" stretchy="false" xref="A2.E24.m2.8.8.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A2.E24.m2.9.9.2.2.2.3a" lspace="0.167em" xref="A2.E24.m2.9.9.2.2.2.3.cmml">â¢</mo><mrow id="A2.E24.m2.9.9.2.2.2.5" xref="A2.E24.m2.9.9.2.2.2.5.cmml"><mo id="A2.E24.m2.9.9.2.2.2.5.1" rspace="0.167em" xref="A2.E24.m2.9.9.2.2.2.5.1.cmml">âˆ‡</mo><msub id="A2.E24.m2.9.9.2.2.2.5.2" xref="A2.E24.m2.9.9.2.2.2.5.2.cmml"><mi id="A2.E24.m2.9.9.2.2.2.5.2.2" xref="A2.E24.m2.9.9.2.2.2.5.2.2.cmml">s</mi><mi id="A2.E24.m2.9.9.2.2.2.5.2.3" xref="A2.E24.m2.9.9.2.2.2.5.2.3.cmml">Ï•</mi></msub></mrow><mo id="A2.E24.m2.9.9.2.2.2.3b" xref="A2.E24.m2.9.9.2.2.2.3.cmml">â¢</mo><mrow id="A2.E24.m2.9.9.2.2.2.2.1" xref="A2.E24.m2.9.9.2.2.2.2.2.cmml"><mo id="A2.E24.m2.9.9.2.2.2.2.1.2" stretchy="false" xref="A2.E24.m2.9.9.2.2.2.2.2.cmml">(</mo><mi id="A2.E24.m2.7.7" xref="A2.E24.m2.7.7.cmml">z</mi><mo id="A2.E24.m2.9.9.2.2.2.2.1.3" xref="A2.E24.m2.9.9.2.2.2.2.2.cmml">,</mo><msub id="A2.E24.m2.9.9.2.2.2.2.1.1" xref="A2.E24.m2.9.9.2.2.2.2.1.1.cmml"><mi id="A2.E24.m2.9.9.2.2.2.2.1.1.2" xref="A2.E24.m2.9.9.2.2.2.2.1.1.2.cmml">t</mi><mi id="A2.E24.m2.9.9.2.2.2.2.1.1.3" xref="A2.E24.m2.9.9.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.E24.m2.9.9.2.2.2.2.1.4" stretchy="false" xref="A2.E24.m2.9.9.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E24.m2.9b"><apply id="A2.E24.m2.9.9.cmml" xref="A2.E24.m2.9.9"><eq id="A2.E24.m2.9.9.3.cmml" xref="A2.E24.m2.9.9.3"></eq><csymbol cd="latexml" id="A2.E24.m2.9.9.4.cmml" xref="A2.E24.m2.9.9.4">absent</csymbol><apply id="A2.E24.m2.9.9.2.cmml" xref="A2.E24.m2.9.9.2"><minus id="A2.E24.m2.9.9.2.3.cmml" xref="A2.E24.m2.9.9.2.3"></minus><apply id="A2.E24.m2.6.6.cmml" xref="A2.E24.m2.6.6"><divide id="A2.E24.m2.6.6.7.cmml" xref="A2.E24.m2.6.6"></divide><apply id="A2.E24.m2.4.4.4.cmml" xref="A2.E24.m2.4.4.4"><apply id="A2.E24.m2.4.4.4.5.cmml" xref="A2.E24.m2.4.4.4.5"><csymbol cd="ambiguous" id="A2.E24.m2.4.4.4.5.1.cmml" xref="A2.E24.m2.4.4.4.5">subscript</csymbol><sum id="A2.E24.m2.4.4.4.5.2.cmml" xref="A2.E24.m2.4.4.4.5.2"></sum><ci id="A2.E24.m2.4.4.4.5.3.cmml" xref="A2.E24.m2.4.4.4.5.3">ğ‘§</ci></apply><apply id="A2.E24.m2.4.4.4.4.cmml" xref="A2.E24.m2.4.4.4.4"><times id="A2.E24.m2.4.4.4.4.2.cmml" xref="A2.E24.m2.4.4.4.4.2"></times><apply id="A2.E24.m2.4.4.4.4.3.cmml" xref="A2.E24.m2.4.4.4.4.3"><csymbol cd="ambiguous" id="A2.E24.m2.4.4.4.4.3.1.cmml" xref="A2.E24.m2.4.4.4.4.3">superscript</csymbol><ci id="A2.E24.m2.4.4.4.4.3.2.cmml" xref="A2.E24.m2.4.4.4.4.3.2">ğ‘’</ci><apply id="A2.E24.m2.2.2.2.2.2.cmml" xref="A2.E24.m2.2.2.2.2.2"><times id="A2.E24.m2.2.2.2.2.2.3.cmml" xref="A2.E24.m2.2.2.2.2.2.3"></times><apply id="A2.E24.m2.2.2.2.2.2.4.cmml" xref="A2.E24.m2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="A2.E24.m2.2.2.2.2.2.4.1.cmml" xref="A2.E24.m2.2.2.2.2.2.4">subscript</csymbol><ci id="A2.E24.m2.2.2.2.2.2.4.2.cmml" xref="A2.E24.m2.2.2.2.2.2.4.2">ğ‘ </ci><ci id="A2.E24.m2.2.2.2.2.2.4.3.cmml" xref="A2.E24.m2.2.2.2.2.2.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E24.m2.2.2.2.2.2.2.2.cmml" xref="A2.E24.m2.2.2.2.2.2.2.1"><ci id="A2.E24.m2.1.1.1.1.1.1.cmml" xref="A2.E24.m2.1.1.1.1.1.1">ğ‘§</ci><apply id="A2.E24.m2.2.2.2.2.2.2.1.1.cmml" xref="A2.E24.m2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E24.m2.2.2.2.2.2.2.1.1.1.cmml" xref="A2.E24.m2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A2.E24.m2.2.2.2.2.2.2.1.1.2.cmml" xref="A2.E24.m2.2.2.2.2.2.2.1.1.2">ğ‘¡</ci><ci id="A2.E24.m2.2.2.2.2.2.2.1.1.3.cmml" xref="A2.E24.m2.2.2.2.2.2.2.1.1.3">ğ‘–</ci></apply></interval></apply></apply><apply id="A2.E24.m2.4.4.4.4.4.cmml" xref="A2.E24.m2.4.4.4.4.4"><ci id="A2.E24.m2.4.4.4.4.4.1.cmml" xref="A2.E24.m2.4.4.4.4.4.1">âˆ‡</ci><apply id="A2.E24.m2.4.4.4.4.4.2.cmml" xref="A2.E24.m2.4.4.4.4.4.2"><csymbol cd="ambiguous" id="A2.E24.m2.4.4.4.4.4.2.1.cmml" xref="A2.E24.m2.4.4.4.4.4.2">subscript</csymbol><ci id="A2.E24.m2.4.4.4.4.4.2.2.cmml" xref="A2.E24.m2.4.4.4.4.4.2.2">ğ‘ </ci><ci id="A2.E24.m2.4.4.4.4.4.2.3.cmml" xref="A2.E24.m2.4.4.4.4.4.2.3">italic-Ï•</ci></apply></apply><interval closure="open" id="A2.E24.m2.4.4.4.4.1.2.cmml" xref="A2.E24.m2.4.4.4.4.1.1"><ci id="A2.E24.m2.3.3.3.3.cmml" xref="A2.E24.m2.3.3.3.3">ğ‘§</ci><apply id="A2.E24.m2.4.4.4.4.1.1.1.cmml" xref="A2.E24.m2.4.4.4.4.1.1.1"><csymbol cd="ambiguous" id="A2.E24.m2.4.4.4.4.1.1.1.1.cmml" xref="A2.E24.m2.4.4.4.4.1.1.1">subscript</csymbol><ci id="A2.E24.m2.4.4.4.4.1.1.1.2.cmml" xref="A2.E24.m2.4.4.4.4.1.1.1.2">ğ‘¡</ci><ci id="A2.E24.m2.4.4.4.4.1.1.1.3.cmml" xref="A2.E24.m2.4.4.4.4.1.1.1.3">ğ‘–</ci></apply></interval></apply></apply><apply id="A2.E24.m2.6.6.6.cmml" xref="A2.E24.m2.6.6.6"><apply id="A2.E24.m2.6.6.6.3.cmml" xref="A2.E24.m2.6.6.6.3"><csymbol cd="ambiguous" id="A2.E24.m2.6.6.6.3.1.cmml" xref="A2.E24.m2.6.6.6.3">subscript</csymbol><sum id="A2.E24.m2.6.6.6.3.2.cmml" xref="A2.E24.m2.6.6.6.3.2"></sum><apply id="A2.E24.m2.6.6.6.3.3.cmml" xref="A2.E24.m2.6.6.6.3.3"><csymbol cd="ambiguous" id="A2.E24.m2.6.6.6.3.3.1.cmml" xref="A2.E24.m2.6.6.6.3.3">superscript</csymbol><ci id="A2.E24.m2.6.6.6.3.3.2.cmml" xref="A2.E24.m2.6.6.6.3.3.2">ğ‘§</ci><ci id="A2.E24.m2.6.6.6.3.3.3.cmml" xref="A2.E24.m2.6.6.6.3.3.3">â€²</ci></apply></apply><apply id="A2.E24.m2.6.6.6.4.cmml" xref="A2.E24.m2.6.6.6.4"><csymbol cd="ambiguous" id="A2.E24.m2.6.6.6.4.1.cmml" xref="A2.E24.m2.6.6.6.4">superscript</csymbol><ci id="A2.E24.m2.6.6.6.4.2.cmml" xref="A2.E24.m2.6.6.6.4.2">ğ‘’</ci><apply id="A2.E24.m2.6.6.6.2.2.cmml" xref="A2.E24.m2.6.6.6.2.2"><times id="A2.E24.m2.6.6.6.2.2.3.cmml" xref="A2.E24.m2.6.6.6.2.2.3"></times><apply id="A2.E24.m2.6.6.6.2.2.4.cmml" xref="A2.E24.m2.6.6.6.2.2.4"><csymbol cd="ambiguous" id="A2.E24.m2.6.6.6.2.2.4.1.cmml" xref="A2.E24.m2.6.6.6.2.2.4">subscript</csymbol><ci id="A2.E24.m2.6.6.6.2.2.4.2.cmml" xref="A2.E24.m2.6.6.6.2.2.4.2">ğ‘ </ci><ci id="A2.E24.m2.6.6.6.2.2.4.3.cmml" xref="A2.E24.m2.6.6.6.2.2.4.3">italic-Ï•</ci></apply><interval closure="open" id="A2.E24.m2.6.6.6.2.2.2.3.cmml" xref="A2.E24.m2.6.6.6.2.2.2.2"><apply id="A2.E24.m2.5.5.5.1.1.1.1.1.cmml" xref="A2.E24.m2.5.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E24.m2.5.5.5.1.1.1.1.1.1.cmml" xref="A2.E24.m2.5.5.5.1.1.1.1.1">superscript</csymbol><ci id="A2.E24.m2.5.5.5.1.1.1.1.1.2.cmml" xref="A2.E24.m2.5.5.5.1.1.1.1.1.2">ğ‘§</ci><ci id="A2.E24.m2.5.5.5.1.1.1.1.1.3.cmml" xref="A2.E24.m2.5.5.5.1.1.1.1.1.3">â€²</ci></apply><apply id="A2.E24.m2.6.6.6.2.2.2.2.2.cmml" xref="A2.E24.m2.6.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E24.m2.6.6.6.2.2.2.2.2.1.cmml" xref="A2.E24.m2.6.6.6.2.2.2.2.2">subscript</csymbol><ci id="A2.E24.m2.6.6.6.2.2.2.2.2.2.cmml" xref="A2.E24.m2.6.6.6.2.2.2.2.2.2">ğ‘¡</ci><ci id="A2.E24.m2.6.6.6.2.2.2.2.2.3.cmml" xref="A2.E24.m2.6.6.6.2.2.2.2.2.3">ğ‘–</ci></apply></interval></apply></apply></apply></apply><apply id="A2.E24.m2.9.9.2.2.cmml" xref="A2.E24.m2.9.9.2.2"><apply id="A2.E24.m2.9.9.2.2.3.cmml" xref="A2.E24.m2.9.9.2.2.3"><csymbol cd="ambiguous" id="A2.E24.m2.9.9.2.2.3.1.cmml" xref="A2.E24.m2.9.9.2.2.3">subscript</csymbol><sum id="A2.E24.m2.9.9.2.2.3.2.cmml" xref="A2.E24.m2.9.9.2.2.3.2"></sum><ci id="A2.E24.m2.9.9.2.2.3.3.cmml" xref="A2.E24.m2.9.9.2.2.3.3">ğ‘§</ci></apply><apply id="A2.E24.m2.9.9.2.2.2.cmml" xref="A2.E24.m2.9.9.2.2.2"><times id="A2.E24.m2.9.9.2.2.2.3.cmml" xref="A2.E24.m2.9.9.2.2.2.3"></times><apply id="A2.E24.m2.9.9.2.2.2.4.cmml" xref="A2.E24.m2.9.9.2.2.2.4"><csymbol cd="ambiguous" id="A2.E24.m2.9.9.2.2.2.4.1.cmml" xref="A2.E24.m2.9.9.2.2.2.4">subscript</csymbol><apply id="A2.E24.m2.9.9.2.2.2.4.2.cmml" xref="A2.E24.m2.9.9.2.2.2.4.2"><ci id="A2.E24.m2.9.9.2.2.2.4.2.1.cmml" xref="A2.E24.m2.9.9.2.2.2.4.2.1">~</ci><ci id="A2.E24.m2.9.9.2.2.2.4.2.2.cmml" xref="A2.E24.m2.9.9.2.2.2.4.2.2">ğ‘</ci></apply><ci id="A2.E24.m2.9.9.2.2.2.4.3.cmml" xref="A2.E24.m2.9.9.2.2.2.4.3">ğ™»ğ™¼</ci></apply><apply id="A2.E24.m2.8.8.1.1.1.1.1.1.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1"><csymbol cd="latexml" id="A2.E24.m2.8.8.1.1.1.1.1.1.3.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.3">conditional</csymbol><ci id="A2.E24.m2.8.8.1.1.1.1.1.1.4.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.4">ğ‘§</ci><list id="A2.E24.m2.8.8.1.1.1.1.1.1.2.3.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2"><apply id="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E24.m2.8.8.1.1.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply><apply id="A2.E24.m2.9.9.2.2.2.5.cmml" xref="A2.E24.m2.9.9.2.2.2.5"><ci id="A2.E24.m2.9.9.2.2.2.5.1.cmml" xref="A2.E24.m2.9.9.2.2.2.5.1">âˆ‡</ci><apply id="A2.E24.m2.9.9.2.2.2.5.2.cmml" xref="A2.E24.m2.9.9.2.2.2.5.2"><csymbol cd="ambiguous" id="A2.E24.m2.9.9.2.2.2.5.2.1.cmml" xref="A2.E24.m2.9.9.2.2.2.5.2">subscript</csymbol><ci id="A2.E24.m2.9.9.2.2.2.5.2.2.cmml" xref="A2.E24.m2.9.9.2.2.2.5.2.2">ğ‘ </ci><ci id="A2.E24.m2.9.9.2.2.2.5.2.3.cmml" xref="A2.E24.m2.9.9.2.2.2.5.2.3">italic-Ï•</ci></apply></apply><interval closure="open" id="A2.E24.m2.9.9.2.2.2.2.2.cmml" xref="A2.E24.m2.9.9.2.2.2.2.1"><ci id="A2.E24.m2.7.7.cmml" xref="A2.E24.m2.7.7">ğ‘§</ci><apply id="A2.E24.m2.9.9.2.2.2.2.1.1.cmml" xref="A2.E24.m2.9.9.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E24.m2.9.9.2.2.2.2.1.1.1.cmml" xref="A2.E24.m2.9.9.2.2.2.2.1.1">subscript</csymbol><ci id="A2.E24.m2.9.9.2.2.2.2.1.1.2.cmml" xref="A2.E24.m2.9.9.2.2.2.2.1.1.2">ğ‘¡</ci><ci id="A2.E24.m2.9.9.2.2.2.2.1.1.3.cmml" xref="A2.E24.m2.9.9.2.2.2.2.1.1.3">ğ‘–</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E24.m2.9c">\displaystyle=\frac{\sum_{z}e^{s_{\phi}(z,t_{i})}\nabla s_{\phi}(z,t_{i})}{%
\sum_{z^{\prime}}e^{s_{\phi}(z^{\prime},t_{i})}}-\sum_{z}\tilde{p}_{\mathtt{LM%
}}(z|t_{i},y_{i})\nabla s_{\phi}(z,t_{i})</annotation><annotation encoding="application/x-llamapun" id="A2.E24.m2.9d">= divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT âˆ‡ italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT end_ARG - âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ‡ italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
<tbody id="A2.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{z}\Bigg{[}p_{\phi}(z|t_{i})-\tilde{p}_{\mathtt{LM}}(z|t_{i%
},y_{i})\Bigg{]}\nabla s_{\phi}(z,t_{i})" class="ltx_Math" display="inline" id="A2.E25.m1.3"><semantics id="A2.E25.m1.3a"><mrow id="A2.E25.m1.3.3" xref="A2.E25.m1.3.3.cmml"><mi id="A2.E25.m1.3.3.4" xref="A2.E25.m1.3.3.4.cmml"></mi><mo id="A2.E25.m1.3.3.3" xref="A2.E25.m1.3.3.3.cmml">=</mo><mrow id="A2.E25.m1.3.3.2" xref="A2.E25.m1.3.3.2.cmml"><mstyle displaystyle="true" id="A2.E25.m1.3.3.2.3" xref="A2.E25.m1.3.3.2.3.cmml"><munder id="A2.E25.m1.3.3.2.3a" xref="A2.E25.m1.3.3.2.3.cmml"><mo id="A2.E25.m1.3.3.2.3.2" movablelimits="false" xref="A2.E25.m1.3.3.2.3.2.cmml">âˆ‘</mo><mi id="A2.E25.m1.3.3.2.3.3" xref="A2.E25.m1.3.3.2.3.3.cmml">z</mi></munder></mstyle><mrow id="A2.E25.m1.3.3.2.2" xref="A2.E25.m1.3.3.2.2.cmml"><mrow id="A2.E25.m1.2.2.1.1.1.1" xref="A2.E25.m1.2.2.1.1.1.2.cmml"><mo id="A2.E25.m1.2.2.1.1.1.1.2" maxsize="260%" minsize="260%" xref="A2.E25.m1.2.2.1.1.1.2.1.cmml">[</mo><mrow id="A2.E25.m1.2.2.1.1.1.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.cmml"><mrow id="A2.E25.m1.2.2.1.1.1.1.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.1.cmml"><msub id="A2.E25.m1.2.2.1.1.1.1.1.1.3" xref="A2.E25.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A2.E25.m1.2.2.1.1.1.1.1.1.3.2" xref="A2.E25.m1.2.2.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="A2.E25.m1.2.2.1.1.1.1.1.1.3.3" xref="A2.E25.m1.2.2.1.1.1.1.1.1.3.3.cmml">Ï•</mi></msub><mo id="A2.E25.m1.2.2.1.1.1.1.1.1.2" xref="A2.E25.m1.2.2.1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mo fence="false" id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.E25.m1.2.2.1.1.1.1.1.3" xref="A2.E25.m1.2.2.1.1.1.1.1.3.cmml">âˆ’</mo><mrow id="A2.E25.m1.2.2.1.1.1.1.1.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.cmml"><msub id="A2.E25.m1.2.2.1.1.1.1.1.2.3" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.cmml"><mover accent="true" id="A2.E25.m1.2.2.1.1.1.1.1.2.3.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.cmml"><mi id="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.2.cmml">p</mi><mo id="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.1" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.1.cmml">~</mo></mover><mi id="A2.E25.m1.2.2.1.1.1.1.1.2.3.3" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E25.m1.2.2.1.1.1.1.1.2.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.2.cmml">â¢</mo><mrow id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.cmml"><mo id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.cmml"><mi id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.4" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.3" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml">|</mo><mrow id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.3.cmml"><msub id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.3" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.3" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.3.cmml">,</mo><msub id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.cmml"><mi id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.2" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.3" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A2.E25.m1.2.2.1.1.1.1.3" maxsize="260%" minsize="260%" xref="A2.E25.m1.2.2.1.1.1.2.1.cmml">]</mo></mrow><mo id="A2.E25.m1.3.3.2.2.3" lspace="0.167em" xref="A2.E25.m1.3.3.2.2.3.cmml">â¢</mo><mrow id="A2.E25.m1.3.3.2.2.4" xref="A2.E25.m1.3.3.2.2.4.cmml"><mo id="A2.E25.m1.3.3.2.2.4.1" rspace="0.167em" xref="A2.E25.m1.3.3.2.2.4.1.cmml">âˆ‡</mo><msub id="A2.E25.m1.3.3.2.2.4.2" xref="A2.E25.m1.3.3.2.2.4.2.cmml"><mi id="A2.E25.m1.3.3.2.2.4.2.2" xref="A2.E25.m1.3.3.2.2.4.2.2.cmml">s</mi><mi id="A2.E25.m1.3.3.2.2.4.2.3" xref="A2.E25.m1.3.3.2.2.4.2.3.cmml">Ï•</mi></msub></mrow><mo id="A2.E25.m1.3.3.2.2.3a" xref="A2.E25.m1.3.3.2.2.3.cmml">â¢</mo><mrow id="A2.E25.m1.3.3.2.2.2.1" xref="A2.E25.m1.3.3.2.2.2.2.cmml"><mo id="A2.E25.m1.3.3.2.2.2.1.2" stretchy="false" xref="A2.E25.m1.3.3.2.2.2.2.cmml">(</mo><mi id="A2.E25.m1.1.1" xref="A2.E25.m1.1.1.cmml">z</mi><mo id="A2.E25.m1.3.3.2.2.2.1.3" xref="A2.E25.m1.3.3.2.2.2.2.cmml">,</mo><msub id="A2.E25.m1.3.3.2.2.2.1.1" xref="A2.E25.m1.3.3.2.2.2.1.1.cmml"><mi id="A2.E25.m1.3.3.2.2.2.1.1.2" xref="A2.E25.m1.3.3.2.2.2.1.1.2.cmml">t</mi><mi id="A2.E25.m1.3.3.2.2.2.1.1.3" xref="A2.E25.m1.3.3.2.2.2.1.1.3.cmml">i</mi></msub><mo id="A2.E25.m1.3.3.2.2.2.1.4" stretchy="false" xref="A2.E25.m1.3.3.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E25.m1.3b"><apply id="A2.E25.m1.3.3.cmml" xref="A2.E25.m1.3.3"><eq id="A2.E25.m1.3.3.3.cmml" xref="A2.E25.m1.3.3.3"></eq><csymbol cd="latexml" id="A2.E25.m1.3.3.4.cmml" xref="A2.E25.m1.3.3.4">absent</csymbol><apply id="A2.E25.m1.3.3.2.cmml" xref="A2.E25.m1.3.3.2"><apply id="A2.E25.m1.3.3.2.3.cmml" xref="A2.E25.m1.3.3.2.3"><csymbol cd="ambiguous" id="A2.E25.m1.3.3.2.3.1.cmml" xref="A2.E25.m1.3.3.2.3">subscript</csymbol><sum id="A2.E25.m1.3.3.2.3.2.cmml" xref="A2.E25.m1.3.3.2.3.2"></sum><ci id="A2.E25.m1.3.3.2.3.3.cmml" xref="A2.E25.m1.3.3.2.3.3">ğ‘§</ci></apply><apply id="A2.E25.m1.3.3.2.2.cmml" xref="A2.E25.m1.3.3.2.2"><times id="A2.E25.m1.3.3.2.2.3.cmml" xref="A2.E25.m1.3.3.2.2.3"></times><apply id="A2.E25.m1.2.2.1.1.1.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="A2.E25.m1.2.2.1.1.1.2.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E25.m1.2.2.1.1.1.1.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1"><minus id="A2.E25.m1.2.2.1.1.1.1.1.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.3"></minus><apply id="A2.E25.m1.2.2.1.1.1.1.1.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1"><times id="A2.E25.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.2"></times><apply id="A2.E25.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E25.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E25.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.3.2">ğ‘</ci><ci id="A2.E25.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.3.3">italic-Ï•</ci></apply><apply id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.2">ğ‘§</ci><apply id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">ğ‘¡</ci><ci id="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">ğ‘–</ci></apply></apply></apply><apply id="A2.E25.m1.2.2.1.1.1.1.1.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2"><times id="A2.E25.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.2"></times><apply id="A2.E25.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.E25.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3">subscript</csymbol><apply id="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.2"><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.1">~</ci><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.2.2">ğ‘</ci></apply><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.3.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.3.3">ğ™»ğ™¼</ci></apply><apply id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.3">conditional</csymbol><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.4.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.4">ğ‘§</ci><list id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2"><apply id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.3.cmml" xref="A2.E25.m1.2.2.1.1.1.1.1.2.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply></apply></apply></apply><apply id="A2.E25.m1.3.3.2.2.4.cmml" xref="A2.E25.m1.3.3.2.2.4"><ci id="A2.E25.m1.3.3.2.2.4.1.cmml" xref="A2.E25.m1.3.3.2.2.4.1">âˆ‡</ci><apply id="A2.E25.m1.3.3.2.2.4.2.cmml" xref="A2.E25.m1.3.3.2.2.4.2"><csymbol cd="ambiguous" id="A2.E25.m1.3.3.2.2.4.2.1.cmml" xref="A2.E25.m1.3.3.2.2.4.2">subscript</csymbol><ci id="A2.E25.m1.3.3.2.2.4.2.2.cmml" xref="A2.E25.m1.3.3.2.2.4.2.2">ğ‘ </ci><ci id="A2.E25.m1.3.3.2.2.4.2.3.cmml" xref="A2.E25.m1.3.3.2.2.4.2.3">italic-Ï•</ci></apply></apply><interval closure="open" id="A2.E25.m1.3.3.2.2.2.2.cmml" xref="A2.E25.m1.3.3.2.2.2.1"><ci id="A2.E25.m1.1.1.cmml" xref="A2.E25.m1.1.1">ğ‘§</ci><apply id="A2.E25.m1.3.3.2.2.2.1.1.cmml" xref="A2.E25.m1.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="A2.E25.m1.3.3.2.2.2.1.1.1.cmml" xref="A2.E25.m1.3.3.2.2.2.1.1">subscript</csymbol><ci id="A2.E25.m1.3.3.2.2.2.1.1.2.cmml" xref="A2.E25.m1.3.3.2.2.2.1.1.2">ğ‘¡</ci><ci id="A2.E25.m1.3.3.2.2.2.1.1.3.cmml" xref="A2.E25.m1.3.3.2.2.2.1.1.3">ğ‘–</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E25.m1.3c">\displaystyle=\sum_{z}\Bigg{[}p_{\phi}(z|t_{i})-\tilde{p}_{\mathtt{LM}}(z|t_{i%
},y_{i})\Bigg{]}\nabla s_{\phi}(z,t_{i})</annotation><annotation encoding="application/x-llamapun" id="A2.E25.m1.3d">= âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT [ italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ] âˆ‡ italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
<tbody id="A2.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{z}\Bigg{[}1-\frac{\tilde{p}_{\mathtt{LM}}(z|t_{i},y_{i})}{%
p_{\phi}(z|t_{i})}\Bigg{]}p_{\phi}(z|t_{i})\nabla s_{\phi}(z,t_{i})" class="ltx_Math" display="inline" id="A2.E26.m1.6"><semantics id="A2.E26.m1.6a"><mrow id="A2.E26.m1.6.6" xref="A2.E26.m1.6.6.cmml"><mi id="A2.E26.m1.6.6.5" xref="A2.E26.m1.6.6.5.cmml"></mi><mo id="A2.E26.m1.6.6.4" xref="A2.E26.m1.6.6.4.cmml">=</mo><mrow id="A2.E26.m1.6.6.3" xref="A2.E26.m1.6.6.3.cmml"><mstyle displaystyle="true" id="A2.E26.m1.6.6.3.4" xref="A2.E26.m1.6.6.3.4.cmml"><munder id="A2.E26.m1.6.6.3.4a" xref="A2.E26.m1.6.6.3.4.cmml"><mo id="A2.E26.m1.6.6.3.4.2" movablelimits="false" xref="A2.E26.m1.6.6.3.4.2.cmml">âˆ‘</mo><mi id="A2.E26.m1.6.6.3.4.3" xref="A2.E26.m1.6.6.3.4.3.cmml">z</mi></munder></mstyle><mrow id="A2.E26.m1.6.6.3.3" xref="A2.E26.m1.6.6.3.3.cmml"><mrow id="A2.E26.m1.4.4.1.1.1.1" xref="A2.E26.m1.4.4.1.1.1.2.cmml"><mo id="A2.E26.m1.4.4.1.1.1.1.2" maxsize="260%" minsize="260%" xref="A2.E26.m1.4.4.1.1.1.2.1.cmml">[</mo><mrow id="A2.E26.m1.4.4.1.1.1.1.1" xref="A2.E26.m1.4.4.1.1.1.1.1.cmml"><mn id="A2.E26.m1.4.4.1.1.1.1.1.2" xref="A2.E26.m1.4.4.1.1.1.1.1.2.cmml">1</mn><mo id="A2.E26.m1.4.4.1.1.1.1.1.1" xref="A2.E26.m1.4.4.1.1.1.1.1.1.cmml">âˆ’</mo><mstyle displaystyle="true" id="A2.E26.m1.2.2" xref="A2.E26.m1.2.2.cmml"><mfrac id="A2.E26.m1.2.2a" xref="A2.E26.m1.2.2.cmml"><mrow id="A2.E26.m1.1.1.1" xref="A2.E26.m1.1.1.1.cmml"><msub id="A2.E26.m1.1.1.1.3" xref="A2.E26.m1.1.1.1.3.cmml"><mover accent="true" id="A2.E26.m1.1.1.1.3.2" xref="A2.E26.m1.1.1.1.3.2.cmml"><mi id="A2.E26.m1.1.1.1.3.2.2" xref="A2.E26.m1.1.1.1.3.2.2.cmml">p</mi><mo id="A2.E26.m1.1.1.1.3.2.1" xref="A2.E26.m1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A2.E26.m1.1.1.1.3.3" xref="A2.E26.m1.1.1.1.3.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E26.m1.1.1.1.2" xref="A2.E26.m1.1.1.1.2.cmml">â¢</mo><mrow id="A2.E26.m1.1.1.1.1.1" xref="A2.E26.m1.1.1.1.1.1.1.cmml"><mo id="A2.E26.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E26.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E26.m1.1.1.1.1.1.1" xref="A2.E26.m1.1.1.1.1.1.1.cmml"><mi id="A2.E26.m1.1.1.1.1.1.1.4" xref="A2.E26.m1.1.1.1.1.1.1.4.cmml">z</mi><mo fence="false" id="A2.E26.m1.1.1.1.1.1.1.3" xref="A2.E26.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E26.m1.1.1.1.1.1.1.2.2" xref="A2.E26.m1.1.1.1.1.1.1.2.3.cmml"><msub id="A2.E26.m1.1.1.1.1.1.1.1.1.1" xref="A2.E26.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E26.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.E26.m1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E26.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.E26.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E26.m1.1.1.1.1.1.1.2.2.3" xref="A2.E26.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E26.m1.1.1.1.1.1.1.2.2.2" xref="A2.E26.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E26.m1.1.1.1.1.1.1.2.2.2.2" xref="A2.E26.m1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E26.m1.1.1.1.1.1.1.2.2.2.3" xref="A2.E26.m1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E26.m1.1.1.1.1.1.3" stretchy="false" xref="A2.E26.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E26.m1.2.2.2" xref="A2.E26.m1.2.2.2.cmml"><msub id="A2.E26.m1.2.2.2.3" xref="A2.E26.m1.2.2.2.3.cmml"><mi id="A2.E26.m1.2.2.2.3.2" xref="A2.E26.m1.2.2.2.3.2.cmml">p</mi><mi id="A2.E26.m1.2.2.2.3.3" xref="A2.E26.m1.2.2.2.3.3.cmml">Ï•</mi></msub><mo id="A2.E26.m1.2.2.2.2" xref="A2.E26.m1.2.2.2.2.cmml">â¢</mo><mrow id="A2.E26.m1.2.2.2.1.1" xref="A2.E26.m1.2.2.2.1.1.1.cmml"><mo id="A2.E26.m1.2.2.2.1.1.2" stretchy="false" xref="A2.E26.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A2.E26.m1.2.2.2.1.1.1" xref="A2.E26.m1.2.2.2.1.1.1.cmml"><mi id="A2.E26.m1.2.2.2.1.1.1.2" xref="A2.E26.m1.2.2.2.1.1.1.2.cmml">z</mi><mo fence="false" id="A2.E26.m1.2.2.2.1.1.1.1" xref="A2.E26.m1.2.2.2.1.1.1.1.cmml">|</mo><msub id="A2.E26.m1.2.2.2.1.1.1.3" xref="A2.E26.m1.2.2.2.1.1.1.3.cmml"><mi id="A2.E26.m1.2.2.2.1.1.1.3.2" xref="A2.E26.m1.2.2.2.1.1.1.3.2.cmml">t</mi><mi id="A2.E26.m1.2.2.2.1.1.1.3.3" xref="A2.E26.m1.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.E26.m1.2.2.2.1.1.3" stretchy="false" xref="A2.E26.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A2.E26.m1.4.4.1.1.1.1.3" maxsize="260%" minsize="260%" xref="A2.E26.m1.4.4.1.1.1.2.1.cmml">]</mo></mrow><mo id="A2.E26.m1.6.6.3.3.4" xref="A2.E26.m1.6.6.3.3.4.cmml">â¢</mo><msub id="A2.E26.m1.6.6.3.3.5" xref="A2.E26.m1.6.6.3.3.5.cmml"><mi id="A2.E26.m1.6.6.3.3.5.2" xref="A2.E26.m1.6.6.3.3.5.2.cmml">p</mi><mi id="A2.E26.m1.6.6.3.3.5.3" xref="A2.E26.m1.6.6.3.3.5.3.cmml">Ï•</mi></msub><mo id="A2.E26.m1.6.6.3.3.4a" xref="A2.E26.m1.6.6.3.3.4.cmml">â¢</mo><mrow id="A2.E26.m1.5.5.2.2.2.1" xref="A2.E26.m1.5.5.2.2.2.1.1.cmml"><mo id="A2.E26.m1.5.5.2.2.2.1.2" stretchy="false" xref="A2.E26.m1.5.5.2.2.2.1.1.cmml">(</mo><mrow id="A2.E26.m1.5.5.2.2.2.1.1" xref="A2.E26.m1.5.5.2.2.2.1.1.cmml"><mi id="A2.E26.m1.5.5.2.2.2.1.1.2" xref="A2.E26.m1.5.5.2.2.2.1.1.2.cmml">z</mi><mo fence="false" id="A2.E26.m1.5.5.2.2.2.1.1.1" xref="A2.E26.m1.5.5.2.2.2.1.1.1.cmml">|</mo><msub id="A2.E26.m1.5.5.2.2.2.1.1.3" xref="A2.E26.m1.5.5.2.2.2.1.1.3.cmml"><mi id="A2.E26.m1.5.5.2.2.2.1.1.3.2" xref="A2.E26.m1.5.5.2.2.2.1.1.3.2.cmml">t</mi><mi id="A2.E26.m1.5.5.2.2.2.1.1.3.3" xref="A2.E26.m1.5.5.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.E26.m1.5.5.2.2.2.1.3" stretchy="false" xref="A2.E26.m1.5.5.2.2.2.1.1.cmml">)</mo></mrow><mo id="A2.E26.m1.6.6.3.3.4b" lspace="0.167em" xref="A2.E26.m1.6.6.3.3.4.cmml">â¢</mo><mrow id="A2.E26.m1.6.6.3.3.6" xref="A2.E26.m1.6.6.3.3.6.cmml"><mo id="A2.E26.m1.6.6.3.3.6.1" rspace="0.167em" xref="A2.E26.m1.6.6.3.3.6.1.cmml">âˆ‡</mo><msub id="A2.E26.m1.6.6.3.3.6.2" xref="A2.E26.m1.6.6.3.3.6.2.cmml"><mi id="A2.E26.m1.6.6.3.3.6.2.2" xref="A2.E26.m1.6.6.3.3.6.2.2.cmml">s</mi><mi id="A2.E26.m1.6.6.3.3.6.2.3" xref="A2.E26.m1.6.6.3.3.6.2.3.cmml">Ï•</mi></msub></mrow><mo id="A2.E26.m1.6.6.3.3.4c" xref="A2.E26.m1.6.6.3.3.4.cmml">â¢</mo><mrow id="A2.E26.m1.6.6.3.3.3.1" xref="A2.E26.m1.6.6.3.3.3.2.cmml"><mo id="A2.E26.m1.6.6.3.3.3.1.2" stretchy="false" xref="A2.E26.m1.6.6.3.3.3.2.cmml">(</mo><mi id="A2.E26.m1.3.3" xref="A2.E26.m1.3.3.cmml">z</mi><mo id="A2.E26.m1.6.6.3.3.3.1.3" xref="A2.E26.m1.6.6.3.3.3.2.cmml">,</mo><msub id="A2.E26.m1.6.6.3.3.3.1.1" xref="A2.E26.m1.6.6.3.3.3.1.1.cmml"><mi id="A2.E26.m1.6.6.3.3.3.1.1.2" xref="A2.E26.m1.6.6.3.3.3.1.1.2.cmml">t</mi><mi id="A2.E26.m1.6.6.3.3.3.1.1.3" xref="A2.E26.m1.6.6.3.3.3.1.1.3.cmml">i</mi></msub><mo id="A2.E26.m1.6.6.3.3.3.1.4" stretchy="false" xref="A2.E26.m1.6.6.3.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E26.m1.6b"><apply id="A2.E26.m1.6.6.cmml" xref="A2.E26.m1.6.6"><eq id="A2.E26.m1.6.6.4.cmml" xref="A2.E26.m1.6.6.4"></eq><csymbol cd="latexml" id="A2.E26.m1.6.6.5.cmml" xref="A2.E26.m1.6.6.5">absent</csymbol><apply id="A2.E26.m1.6.6.3.cmml" xref="A2.E26.m1.6.6.3"><apply id="A2.E26.m1.6.6.3.4.cmml" xref="A2.E26.m1.6.6.3.4"><csymbol cd="ambiguous" id="A2.E26.m1.6.6.3.4.1.cmml" xref="A2.E26.m1.6.6.3.4">subscript</csymbol><sum id="A2.E26.m1.6.6.3.4.2.cmml" xref="A2.E26.m1.6.6.3.4.2"></sum><ci id="A2.E26.m1.6.6.3.4.3.cmml" xref="A2.E26.m1.6.6.3.4.3">ğ‘§</ci></apply><apply id="A2.E26.m1.6.6.3.3.cmml" xref="A2.E26.m1.6.6.3.3"><times id="A2.E26.m1.6.6.3.3.4.cmml" xref="A2.E26.m1.6.6.3.3.4"></times><apply id="A2.E26.m1.4.4.1.1.1.2.cmml" xref="A2.E26.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="A2.E26.m1.4.4.1.1.1.2.1.cmml" xref="A2.E26.m1.4.4.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E26.m1.4.4.1.1.1.1.1.cmml" xref="A2.E26.m1.4.4.1.1.1.1.1"><minus id="A2.E26.m1.4.4.1.1.1.1.1.1.cmml" xref="A2.E26.m1.4.4.1.1.1.1.1.1"></minus><cn id="A2.E26.m1.4.4.1.1.1.1.1.2.cmml" type="integer" xref="A2.E26.m1.4.4.1.1.1.1.1.2">1</cn><apply id="A2.E26.m1.2.2.cmml" xref="A2.E26.m1.2.2"><divide id="A2.E26.m1.2.2.3.cmml" xref="A2.E26.m1.2.2"></divide><apply id="A2.E26.m1.1.1.1.cmml" xref="A2.E26.m1.1.1.1"><times id="A2.E26.m1.1.1.1.2.cmml" xref="A2.E26.m1.1.1.1.2"></times><apply id="A2.E26.m1.1.1.1.3.cmml" xref="A2.E26.m1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E26.m1.1.1.1.3.1.cmml" xref="A2.E26.m1.1.1.1.3">subscript</csymbol><apply id="A2.E26.m1.1.1.1.3.2.cmml" xref="A2.E26.m1.1.1.1.3.2"><ci id="A2.E26.m1.1.1.1.3.2.1.cmml" xref="A2.E26.m1.1.1.1.3.2.1">~</ci><ci id="A2.E26.m1.1.1.1.3.2.2.cmml" xref="A2.E26.m1.1.1.1.3.2.2">ğ‘</ci></apply><ci id="A2.E26.m1.1.1.1.3.3.cmml" xref="A2.E26.m1.1.1.1.3.3">ğ™»ğ™¼</ci></apply><apply id="A2.E26.m1.1.1.1.1.1.1.cmml" xref="A2.E26.m1.1.1.1.1.1"><csymbol cd="latexml" id="A2.E26.m1.1.1.1.1.1.1.3.cmml" xref="A2.E26.m1.1.1.1.1.1.1.3">conditional</csymbol><ci id="A2.E26.m1.1.1.1.1.1.1.4.cmml" xref="A2.E26.m1.1.1.1.1.1.1.4">ğ‘§</ci><list id="A2.E26.m1.1.1.1.1.1.1.2.3.cmml" xref="A2.E26.m1.1.1.1.1.1.1.2.2"><apply id="A2.E26.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E26.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E26.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E26.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E26.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E26.m1.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E26.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E26.m1.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E26.m1.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E26.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E26.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E26.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E26.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E26.m1.1.1.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E26.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E26.m1.1.1.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply></apply><apply id="A2.E26.m1.2.2.2.cmml" xref="A2.E26.m1.2.2.2"><times id="A2.E26.m1.2.2.2.2.cmml" xref="A2.E26.m1.2.2.2.2"></times><apply id="A2.E26.m1.2.2.2.3.cmml" xref="A2.E26.m1.2.2.2.3"><csymbol cd="ambiguous" id="A2.E26.m1.2.2.2.3.1.cmml" xref="A2.E26.m1.2.2.2.3">subscript</csymbol><ci id="A2.E26.m1.2.2.2.3.2.cmml" xref="A2.E26.m1.2.2.2.3.2">ğ‘</ci><ci id="A2.E26.m1.2.2.2.3.3.cmml" xref="A2.E26.m1.2.2.2.3.3">italic-Ï•</ci></apply><apply id="A2.E26.m1.2.2.2.1.1.1.cmml" xref="A2.E26.m1.2.2.2.1.1"><csymbol cd="latexml" id="A2.E26.m1.2.2.2.1.1.1.1.cmml" xref="A2.E26.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="A2.E26.m1.2.2.2.1.1.1.2.cmml" xref="A2.E26.m1.2.2.2.1.1.1.2">ğ‘§</ci><apply id="A2.E26.m1.2.2.2.1.1.1.3.cmml" xref="A2.E26.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.E26.m1.2.2.2.1.1.1.3.1.cmml" xref="A2.E26.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="A2.E26.m1.2.2.2.1.1.1.3.2.cmml" xref="A2.E26.m1.2.2.2.1.1.1.3.2">ğ‘¡</ci><ci id="A2.E26.m1.2.2.2.1.1.1.3.3.cmml" xref="A2.E26.m1.2.2.2.1.1.1.3.3">ğ‘–</ci></apply></apply></apply></apply></apply></apply><apply id="A2.E26.m1.6.6.3.3.5.cmml" xref="A2.E26.m1.6.6.3.3.5"><csymbol cd="ambiguous" id="A2.E26.m1.6.6.3.3.5.1.cmml" xref="A2.E26.m1.6.6.3.3.5">subscript</csymbol><ci id="A2.E26.m1.6.6.3.3.5.2.cmml" xref="A2.E26.m1.6.6.3.3.5.2">ğ‘</ci><ci id="A2.E26.m1.6.6.3.3.5.3.cmml" xref="A2.E26.m1.6.6.3.3.5.3">italic-Ï•</ci></apply><apply id="A2.E26.m1.5.5.2.2.2.1.1.cmml" xref="A2.E26.m1.5.5.2.2.2.1"><csymbol cd="latexml" id="A2.E26.m1.5.5.2.2.2.1.1.1.cmml" xref="A2.E26.m1.5.5.2.2.2.1.1.1">conditional</csymbol><ci id="A2.E26.m1.5.5.2.2.2.1.1.2.cmml" xref="A2.E26.m1.5.5.2.2.2.1.1.2">ğ‘§</ci><apply id="A2.E26.m1.5.5.2.2.2.1.1.3.cmml" xref="A2.E26.m1.5.5.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E26.m1.5.5.2.2.2.1.1.3.1.cmml" xref="A2.E26.m1.5.5.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E26.m1.5.5.2.2.2.1.1.3.2.cmml" xref="A2.E26.m1.5.5.2.2.2.1.1.3.2">ğ‘¡</ci><ci id="A2.E26.m1.5.5.2.2.2.1.1.3.3.cmml" xref="A2.E26.m1.5.5.2.2.2.1.1.3.3">ğ‘–</ci></apply></apply><apply id="A2.E26.m1.6.6.3.3.6.cmml" xref="A2.E26.m1.6.6.3.3.6"><ci id="A2.E26.m1.6.6.3.3.6.1.cmml" xref="A2.E26.m1.6.6.3.3.6.1">âˆ‡</ci><apply id="A2.E26.m1.6.6.3.3.6.2.cmml" xref="A2.E26.m1.6.6.3.3.6.2"><csymbol cd="ambiguous" id="A2.E26.m1.6.6.3.3.6.2.1.cmml" xref="A2.E26.m1.6.6.3.3.6.2">subscript</csymbol><ci id="A2.E26.m1.6.6.3.3.6.2.2.cmml" xref="A2.E26.m1.6.6.3.3.6.2.2">ğ‘ </ci><ci id="A2.E26.m1.6.6.3.3.6.2.3.cmml" xref="A2.E26.m1.6.6.3.3.6.2.3">italic-Ï•</ci></apply></apply><interval closure="open" id="A2.E26.m1.6.6.3.3.3.2.cmml" xref="A2.E26.m1.6.6.3.3.3.1"><ci id="A2.E26.m1.3.3.cmml" xref="A2.E26.m1.3.3">ğ‘§</ci><apply id="A2.E26.m1.6.6.3.3.3.1.1.cmml" xref="A2.E26.m1.6.6.3.3.3.1.1"><csymbol cd="ambiguous" id="A2.E26.m1.6.6.3.3.3.1.1.1.cmml" xref="A2.E26.m1.6.6.3.3.3.1.1">subscript</csymbol><ci id="A2.E26.m1.6.6.3.3.3.1.1.2.cmml" xref="A2.E26.m1.6.6.3.3.3.1.1.2">ğ‘¡</ci><ci id="A2.E26.m1.6.6.3.3.3.1.1.3.cmml" xref="A2.E26.m1.6.6.3.3.3.1.1.3">ğ‘–</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E26.m1.6c">\displaystyle=\sum_{z}\Bigg{[}1-\frac{\tilde{p}_{\mathtt{LM}}(z|t_{i},y_{i})}{%
p_{\phi}(z|t_{i})}\Bigg{]}p_{\phi}(z|t_{i})\nabla s_{\phi}(z,t_{i})</annotation><annotation encoding="application/x-llamapun" id="A2.E26.m1.6d">= âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT [ 1 - divide start_ARG over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG ] italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ‡ italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_z , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p1.7">After changing the notation back from <math alttext="\sum_{z}" class="ltx_Math" display="inline" id="A2.p1.6.m1.1"><semantics id="A2.p1.6.m1.1a"><msub id="A2.p1.6.m1.1.1" xref="A2.p1.6.m1.1.1.cmml"><mo id="A2.p1.6.m1.1.1.2" xref="A2.p1.6.m1.1.1.2.cmml">âˆ‘</mo><mi id="A2.p1.6.m1.1.1.3" xref="A2.p1.6.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.6.m1.1b"><apply id="A2.p1.6.m1.1.1.cmml" xref="A2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.6.m1.1.1.1.cmml" xref="A2.p1.6.m1.1.1">subscript</csymbol><sum id="A2.p1.6.m1.1.1.2.cmml" xref="A2.p1.6.m1.1.1.2"></sum><ci id="A2.p1.6.m1.1.1.3.cmml" xref="A2.p1.6.m1.1.1.3">ğ‘§</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.6.m1.1c">\sum_{z}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.6.m1.1d">âˆ‘ start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\sum_{t_{k}\in\mathcal{D}}" class="ltx_Math" display="inline" id="A2.p1.7.m2.1"><semantics id="A2.p1.7.m2.1a"><msub id="A2.p1.7.m2.1.1" xref="A2.p1.7.m2.1.1.cmml"><mo id="A2.p1.7.m2.1.1.2" xref="A2.p1.7.m2.1.1.2.cmml">âˆ‘</mo><mrow id="A2.p1.7.m2.1.1.3" xref="A2.p1.7.m2.1.1.3.cmml"><msub id="A2.p1.7.m2.1.1.3.2" xref="A2.p1.7.m2.1.1.3.2.cmml"><mi id="A2.p1.7.m2.1.1.3.2.2" xref="A2.p1.7.m2.1.1.3.2.2.cmml">t</mi><mi id="A2.p1.7.m2.1.1.3.2.3" xref="A2.p1.7.m2.1.1.3.2.3.cmml">k</mi></msub><mo id="A2.p1.7.m2.1.1.3.1" xref="A2.p1.7.m2.1.1.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="A2.p1.7.m2.1.1.3.3" xref="A2.p1.7.m2.1.1.3.3.cmml">ğ’Ÿ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.p1.7.m2.1b"><apply id="A2.p1.7.m2.1.1.cmml" xref="A2.p1.7.m2.1.1"><csymbol cd="ambiguous" id="A2.p1.7.m2.1.1.1.cmml" xref="A2.p1.7.m2.1.1">subscript</csymbol><sum id="A2.p1.7.m2.1.1.2.cmml" xref="A2.p1.7.m2.1.1.2"></sum><apply id="A2.p1.7.m2.1.1.3.cmml" xref="A2.p1.7.m2.1.1.3"><in id="A2.p1.7.m2.1.1.3.1.cmml" xref="A2.p1.7.m2.1.1.3.1"></in><apply id="A2.p1.7.m2.1.1.3.2.cmml" xref="A2.p1.7.m2.1.1.3.2"><csymbol cd="ambiguous" id="A2.p1.7.m2.1.1.3.2.1.cmml" xref="A2.p1.7.m2.1.1.3.2">subscript</csymbol><ci id="A2.p1.7.m2.1.1.3.2.2.cmml" xref="A2.p1.7.m2.1.1.3.2.2">ğ‘¡</ci><ci id="A2.p1.7.m2.1.1.3.2.3.cmml" xref="A2.p1.7.m2.1.1.3.2.3">ğ‘˜</ci></apply><ci id="A2.p1.7.m2.1.1.3.3.cmml" xref="A2.p1.7.m2.1.1.3.3">ğ’Ÿ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.7.m2.1c">\sum_{t_{k}\in\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.7.m2.1d">âˆ‘ start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆˆ caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math>, we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A3.EGx22">
<tbody id="A2.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla\mathrm{KL}=\sum_{t_{k}\in\mathcal{D}}\Bigg{[}1-\frac{%
\tilde{p}_{\mathtt{LM}}(t_{j}|t_{i},y_{i})}{p_{\phi}(t_{j}|t_{i})}\Bigg{]}p_{%
\phi}(t_{j}|t_{i})\nabla s_{\phi}(t_{j},t_{i})" class="ltx_Math" display="inline" id="A2.E27.m1.6"><semantics id="A2.E27.m1.6a"><mrow id="A2.E27.m1.6.6" xref="A2.E27.m1.6.6.cmml"><mrow id="A2.E27.m1.6.6.6" xref="A2.E27.m1.6.6.6.cmml"><mo id="A2.E27.m1.6.6.6.1" rspace="0.167em" xref="A2.E27.m1.6.6.6.1.cmml">âˆ‡</mo><mi id="A2.E27.m1.6.6.6.2" xref="A2.E27.m1.6.6.6.2.cmml">KL</mi></mrow><mo id="A2.E27.m1.6.6.5" xref="A2.E27.m1.6.6.5.cmml">=</mo><mrow id="A2.E27.m1.6.6.4" xref="A2.E27.m1.6.6.4.cmml"><mstyle displaystyle="true" id="A2.E27.m1.6.6.4.5" xref="A2.E27.m1.6.6.4.5.cmml"><munder id="A2.E27.m1.6.6.4.5a" xref="A2.E27.m1.6.6.4.5.cmml"><mo id="A2.E27.m1.6.6.4.5.2" movablelimits="false" xref="A2.E27.m1.6.6.4.5.2.cmml">âˆ‘</mo><mrow id="A2.E27.m1.6.6.4.5.3" xref="A2.E27.m1.6.6.4.5.3.cmml"><msub id="A2.E27.m1.6.6.4.5.3.2" xref="A2.E27.m1.6.6.4.5.3.2.cmml"><mi id="A2.E27.m1.6.6.4.5.3.2.2" xref="A2.E27.m1.6.6.4.5.3.2.2.cmml">t</mi><mi id="A2.E27.m1.6.6.4.5.3.2.3" xref="A2.E27.m1.6.6.4.5.3.2.3.cmml">k</mi></msub><mo id="A2.E27.m1.6.6.4.5.3.1" xref="A2.E27.m1.6.6.4.5.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="A2.E27.m1.6.6.4.5.3.3" xref="A2.E27.m1.6.6.4.5.3.3.cmml">ğ’Ÿ</mi></mrow></munder></mstyle><mrow id="A2.E27.m1.6.6.4.4" xref="A2.E27.m1.6.6.4.4.cmml"><mrow id="A2.E27.m1.3.3.1.1.1.1" xref="A2.E27.m1.3.3.1.1.1.2.cmml"><mo id="A2.E27.m1.3.3.1.1.1.1.2" maxsize="260%" minsize="260%" xref="A2.E27.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="A2.E27.m1.3.3.1.1.1.1.1" xref="A2.E27.m1.3.3.1.1.1.1.1.cmml"><mn id="A2.E27.m1.3.3.1.1.1.1.1.2" xref="A2.E27.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="A2.E27.m1.3.3.1.1.1.1.1.1" xref="A2.E27.m1.3.3.1.1.1.1.1.1.cmml">âˆ’</mo><mstyle displaystyle="true" id="A2.E27.m1.2.2" xref="A2.E27.m1.2.2.cmml"><mfrac id="A2.E27.m1.2.2a" xref="A2.E27.m1.2.2.cmml"><mrow id="A2.E27.m1.1.1.1" xref="A2.E27.m1.1.1.1.cmml"><msub id="A2.E27.m1.1.1.1.3" xref="A2.E27.m1.1.1.1.3.cmml"><mover accent="true" id="A2.E27.m1.1.1.1.3.2" xref="A2.E27.m1.1.1.1.3.2.cmml"><mi id="A2.E27.m1.1.1.1.3.2.2" xref="A2.E27.m1.1.1.1.3.2.2.cmml">p</mi><mo id="A2.E27.m1.1.1.1.3.2.1" xref="A2.E27.m1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A2.E27.m1.1.1.1.3.3" xref="A2.E27.m1.1.1.1.3.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.E27.m1.1.1.1.2" xref="A2.E27.m1.1.1.1.2.cmml">â¢</mo><mrow id="A2.E27.m1.1.1.1.1.1" xref="A2.E27.m1.1.1.1.1.1.1.cmml"><mo id="A2.E27.m1.1.1.1.1.1.2" stretchy="false" xref="A2.E27.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.E27.m1.1.1.1.1.1.1" xref="A2.E27.m1.1.1.1.1.1.1.cmml"><msub id="A2.E27.m1.1.1.1.1.1.1.4" xref="A2.E27.m1.1.1.1.1.1.1.4.cmml"><mi id="A2.E27.m1.1.1.1.1.1.1.4.2" xref="A2.E27.m1.1.1.1.1.1.1.4.2.cmml">t</mi><mi id="A2.E27.m1.1.1.1.1.1.1.4.3" xref="A2.E27.m1.1.1.1.1.1.1.4.3.cmml">j</mi></msub><mo fence="false" id="A2.E27.m1.1.1.1.1.1.1.3" xref="A2.E27.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.E27.m1.1.1.1.1.1.1.2.2" xref="A2.E27.m1.1.1.1.1.1.1.2.3.cmml"><msub id="A2.E27.m1.1.1.1.1.1.1.1.1.1" xref="A2.E27.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E27.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.E27.m1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.E27.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.E27.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.E27.m1.1.1.1.1.1.1.2.2.3" xref="A2.E27.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.E27.m1.1.1.1.1.1.1.2.2.2" xref="A2.E27.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.E27.m1.1.1.1.1.1.1.2.2.2.2" xref="A2.E27.m1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.E27.m1.1.1.1.1.1.1.2.2.2.3" xref="A2.E27.m1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.E27.m1.1.1.1.1.1.3" stretchy="false" xref="A2.E27.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.E27.m1.2.2.2" xref="A2.E27.m1.2.2.2.cmml"><msub id="A2.E27.m1.2.2.2.3" xref="A2.E27.m1.2.2.2.3.cmml"><mi id="A2.E27.m1.2.2.2.3.2" xref="A2.E27.m1.2.2.2.3.2.cmml">p</mi><mi id="A2.E27.m1.2.2.2.3.3" xref="A2.E27.m1.2.2.2.3.3.cmml">Ï•</mi></msub><mo id="A2.E27.m1.2.2.2.2" xref="A2.E27.m1.2.2.2.2.cmml">â¢</mo><mrow id="A2.E27.m1.2.2.2.1.1" xref="A2.E27.m1.2.2.2.1.1.1.cmml"><mo id="A2.E27.m1.2.2.2.1.1.2" stretchy="false" xref="A2.E27.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A2.E27.m1.2.2.2.1.1.1" xref="A2.E27.m1.2.2.2.1.1.1.cmml"><msub id="A2.E27.m1.2.2.2.1.1.1.2" xref="A2.E27.m1.2.2.2.1.1.1.2.cmml"><mi id="A2.E27.m1.2.2.2.1.1.1.2.2" xref="A2.E27.m1.2.2.2.1.1.1.2.2.cmml">t</mi><mi id="A2.E27.m1.2.2.2.1.1.1.2.3" xref="A2.E27.m1.2.2.2.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="A2.E27.m1.2.2.2.1.1.1.1" xref="A2.E27.m1.2.2.2.1.1.1.1.cmml">|</mo><msub id="A2.E27.m1.2.2.2.1.1.1.3" xref="A2.E27.m1.2.2.2.1.1.1.3.cmml"><mi id="A2.E27.m1.2.2.2.1.1.1.3.2" xref="A2.E27.m1.2.2.2.1.1.1.3.2.cmml">t</mi><mi id="A2.E27.m1.2.2.2.1.1.1.3.3" xref="A2.E27.m1.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.E27.m1.2.2.2.1.1.3" stretchy="false" xref="A2.E27.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="A2.E27.m1.3.3.1.1.1.1.3" maxsize="260%" minsize="260%" xref="A2.E27.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow><mo id="A2.E27.m1.6.6.4.4.5" xref="A2.E27.m1.6.6.4.4.5.cmml">â¢</mo><msub id="A2.E27.m1.6.6.4.4.6" xref="A2.E27.m1.6.6.4.4.6.cmml"><mi id="A2.E27.m1.6.6.4.4.6.2" xref="A2.E27.m1.6.6.4.4.6.2.cmml">p</mi><mi id="A2.E27.m1.6.6.4.4.6.3" xref="A2.E27.m1.6.6.4.4.6.3.cmml">Ï•</mi></msub><mo id="A2.E27.m1.6.6.4.4.5a" xref="A2.E27.m1.6.6.4.4.5.cmml">â¢</mo><mrow id="A2.E27.m1.4.4.2.2.2.1" xref="A2.E27.m1.4.4.2.2.2.1.1.cmml"><mo id="A2.E27.m1.4.4.2.2.2.1.2" stretchy="false" xref="A2.E27.m1.4.4.2.2.2.1.1.cmml">(</mo><mrow id="A2.E27.m1.4.4.2.2.2.1.1" xref="A2.E27.m1.4.4.2.2.2.1.1.cmml"><msub id="A2.E27.m1.4.4.2.2.2.1.1.2" xref="A2.E27.m1.4.4.2.2.2.1.1.2.cmml"><mi id="A2.E27.m1.4.4.2.2.2.1.1.2.2" xref="A2.E27.m1.4.4.2.2.2.1.1.2.2.cmml">t</mi><mi id="A2.E27.m1.4.4.2.2.2.1.1.2.3" xref="A2.E27.m1.4.4.2.2.2.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="A2.E27.m1.4.4.2.2.2.1.1.1" xref="A2.E27.m1.4.4.2.2.2.1.1.1.cmml">|</mo><msub id="A2.E27.m1.4.4.2.2.2.1.1.3" xref="A2.E27.m1.4.4.2.2.2.1.1.3.cmml"><mi id="A2.E27.m1.4.4.2.2.2.1.1.3.2" xref="A2.E27.m1.4.4.2.2.2.1.1.3.2.cmml">t</mi><mi id="A2.E27.m1.4.4.2.2.2.1.1.3.3" xref="A2.E27.m1.4.4.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.E27.m1.4.4.2.2.2.1.3" stretchy="false" xref="A2.E27.m1.4.4.2.2.2.1.1.cmml">)</mo></mrow><mo id="A2.E27.m1.6.6.4.4.5b" lspace="0.167em" xref="A2.E27.m1.6.6.4.4.5.cmml">â¢</mo><mrow id="A2.E27.m1.6.6.4.4.7" xref="A2.E27.m1.6.6.4.4.7.cmml"><mo id="A2.E27.m1.6.6.4.4.7.1" rspace="0.167em" xref="A2.E27.m1.6.6.4.4.7.1.cmml">âˆ‡</mo><msub id="A2.E27.m1.6.6.4.4.7.2" xref="A2.E27.m1.6.6.4.4.7.2.cmml"><mi id="A2.E27.m1.6.6.4.4.7.2.2" xref="A2.E27.m1.6.6.4.4.7.2.2.cmml">s</mi><mi id="A2.E27.m1.6.6.4.4.7.2.3" xref="A2.E27.m1.6.6.4.4.7.2.3.cmml">Ï•</mi></msub></mrow><mo id="A2.E27.m1.6.6.4.4.5c" xref="A2.E27.m1.6.6.4.4.5.cmml">â¢</mo><mrow id="A2.E27.m1.6.6.4.4.4.2" xref="A2.E27.m1.6.6.4.4.4.3.cmml"><mo id="A2.E27.m1.6.6.4.4.4.2.3" stretchy="false" xref="A2.E27.m1.6.6.4.4.4.3.cmml">(</mo><msub id="A2.E27.m1.5.5.3.3.3.1.1" xref="A2.E27.m1.5.5.3.3.3.1.1.cmml"><mi id="A2.E27.m1.5.5.3.3.3.1.1.2" xref="A2.E27.m1.5.5.3.3.3.1.1.2.cmml">t</mi><mi id="A2.E27.m1.5.5.3.3.3.1.1.3" xref="A2.E27.m1.5.5.3.3.3.1.1.3.cmml">j</mi></msub><mo id="A2.E27.m1.6.6.4.4.4.2.4" xref="A2.E27.m1.6.6.4.4.4.3.cmml">,</mo><msub id="A2.E27.m1.6.6.4.4.4.2.2" xref="A2.E27.m1.6.6.4.4.4.2.2.cmml"><mi id="A2.E27.m1.6.6.4.4.4.2.2.2" xref="A2.E27.m1.6.6.4.4.4.2.2.2.cmml">t</mi><mi id="A2.E27.m1.6.6.4.4.4.2.2.3" xref="A2.E27.m1.6.6.4.4.4.2.2.3.cmml">i</mi></msub><mo id="A2.E27.m1.6.6.4.4.4.2.5" stretchy="false" xref="A2.E27.m1.6.6.4.4.4.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E27.m1.6b"><apply id="A2.E27.m1.6.6.cmml" xref="A2.E27.m1.6.6"><eq id="A2.E27.m1.6.6.5.cmml" xref="A2.E27.m1.6.6.5"></eq><apply id="A2.E27.m1.6.6.6.cmml" xref="A2.E27.m1.6.6.6"><ci id="A2.E27.m1.6.6.6.1.cmml" xref="A2.E27.m1.6.6.6.1">âˆ‡</ci><ci id="A2.E27.m1.6.6.6.2.cmml" xref="A2.E27.m1.6.6.6.2">KL</ci></apply><apply id="A2.E27.m1.6.6.4.cmml" xref="A2.E27.m1.6.6.4"><apply id="A2.E27.m1.6.6.4.5.cmml" xref="A2.E27.m1.6.6.4.5"><csymbol cd="ambiguous" id="A2.E27.m1.6.6.4.5.1.cmml" xref="A2.E27.m1.6.6.4.5">subscript</csymbol><sum id="A2.E27.m1.6.6.4.5.2.cmml" xref="A2.E27.m1.6.6.4.5.2"></sum><apply id="A2.E27.m1.6.6.4.5.3.cmml" xref="A2.E27.m1.6.6.4.5.3"><in id="A2.E27.m1.6.6.4.5.3.1.cmml" xref="A2.E27.m1.6.6.4.5.3.1"></in><apply id="A2.E27.m1.6.6.4.5.3.2.cmml" xref="A2.E27.m1.6.6.4.5.3.2"><csymbol cd="ambiguous" id="A2.E27.m1.6.6.4.5.3.2.1.cmml" xref="A2.E27.m1.6.6.4.5.3.2">subscript</csymbol><ci id="A2.E27.m1.6.6.4.5.3.2.2.cmml" xref="A2.E27.m1.6.6.4.5.3.2.2">ğ‘¡</ci><ci id="A2.E27.m1.6.6.4.5.3.2.3.cmml" xref="A2.E27.m1.6.6.4.5.3.2.3">ğ‘˜</ci></apply><ci id="A2.E27.m1.6.6.4.5.3.3.cmml" xref="A2.E27.m1.6.6.4.5.3.3">ğ’Ÿ</ci></apply></apply><apply id="A2.E27.m1.6.6.4.4.cmml" xref="A2.E27.m1.6.6.4.4"><times id="A2.E27.m1.6.6.4.4.5.cmml" xref="A2.E27.m1.6.6.4.4.5"></times><apply id="A2.E27.m1.3.3.1.1.1.2.cmml" xref="A2.E27.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A2.E27.m1.3.3.1.1.1.2.1.cmml" xref="A2.E27.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="A2.E27.m1.3.3.1.1.1.1.1.cmml" xref="A2.E27.m1.3.3.1.1.1.1.1"><minus id="A2.E27.m1.3.3.1.1.1.1.1.1.cmml" xref="A2.E27.m1.3.3.1.1.1.1.1.1"></minus><cn id="A2.E27.m1.3.3.1.1.1.1.1.2.cmml" type="integer" xref="A2.E27.m1.3.3.1.1.1.1.1.2">1</cn><apply id="A2.E27.m1.2.2.cmml" xref="A2.E27.m1.2.2"><divide id="A2.E27.m1.2.2.3.cmml" xref="A2.E27.m1.2.2"></divide><apply id="A2.E27.m1.1.1.1.cmml" xref="A2.E27.m1.1.1.1"><times id="A2.E27.m1.1.1.1.2.cmml" xref="A2.E27.m1.1.1.1.2"></times><apply id="A2.E27.m1.1.1.1.3.cmml" xref="A2.E27.m1.1.1.1.3"><csymbol cd="ambiguous" id="A2.E27.m1.1.1.1.3.1.cmml" xref="A2.E27.m1.1.1.1.3">subscript</csymbol><apply id="A2.E27.m1.1.1.1.3.2.cmml" xref="A2.E27.m1.1.1.1.3.2"><ci id="A2.E27.m1.1.1.1.3.2.1.cmml" xref="A2.E27.m1.1.1.1.3.2.1">~</ci><ci id="A2.E27.m1.1.1.1.3.2.2.cmml" xref="A2.E27.m1.1.1.1.3.2.2">ğ‘</ci></apply><ci id="A2.E27.m1.1.1.1.3.3.cmml" xref="A2.E27.m1.1.1.1.3.3">ğ™»ğ™¼</ci></apply><apply id="A2.E27.m1.1.1.1.1.1.1.cmml" xref="A2.E27.m1.1.1.1.1.1"><csymbol cd="latexml" id="A2.E27.m1.1.1.1.1.1.1.3.cmml" xref="A2.E27.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="A2.E27.m1.1.1.1.1.1.1.4.cmml" xref="A2.E27.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.E27.m1.1.1.1.1.1.1.4.1.cmml" xref="A2.E27.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A2.E27.m1.1.1.1.1.1.1.4.2.cmml" xref="A2.E27.m1.1.1.1.1.1.1.4.2">ğ‘¡</ci><ci id="A2.E27.m1.1.1.1.1.1.1.4.3.cmml" xref="A2.E27.m1.1.1.1.1.1.1.4.3">ğ‘—</ci></apply><list id="A2.E27.m1.1.1.1.1.1.1.2.3.cmml" xref="A2.E27.m1.1.1.1.1.1.1.2.2"><apply id="A2.E27.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E27.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E27.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E27.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.E27.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E27.m1.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.E27.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E27.m1.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.E27.m1.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E27.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.E27.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.E27.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.E27.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.E27.m1.1.1.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.E27.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.E27.m1.1.1.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply></apply><apply id="A2.E27.m1.2.2.2.cmml" xref="A2.E27.m1.2.2.2"><times id="A2.E27.m1.2.2.2.2.cmml" xref="A2.E27.m1.2.2.2.2"></times><apply id="A2.E27.m1.2.2.2.3.cmml" xref="A2.E27.m1.2.2.2.3"><csymbol cd="ambiguous" id="A2.E27.m1.2.2.2.3.1.cmml" xref="A2.E27.m1.2.2.2.3">subscript</csymbol><ci id="A2.E27.m1.2.2.2.3.2.cmml" xref="A2.E27.m1.2.2.2.3.2">ğ‘</ci><ci id="A2.E27.m1.2.2.2.3.3.cmml" xref="A2.E27.m1.2.2.2.3.3">italic-Ï•</ci></apply><apply id="A2.E27.m1.2.2.2.1.1.1.cmml" xref="A2.E27.m1.2.2.2.1.1"><csymbol cd="latexml" id="A2.E27.m1.2.2.2.1.1.1.1.cmml" xref="A2.E27.m1.2.2.2.1.1.1.1">conditional</csymbol><apply id="A2.E27.m1.2.2.2.1.1.1.2.cmml" xref="A2.E27.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.E27.m1.2.2.2.1.1.1.2.1.cmml" xref="A2.E27.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="A2.E27.m1.2.2.2.1.1.1.2.2.cmml" xref="A2.E27.m1.2.2.2.1.1.1.2.2">ğ‘¡</ci><ci id="A2.E27.m1.2.2.2.1.1.1.2.3.cmml" xref="A2.E27.m1.2.2.2.1.1.1.2.3">ğ‘—</ci></apply><apply id="A2.E27.m1.2.2.2.1.1.1.3.cmml" xref="A2.E27.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.E27.m1.2.2.2.1.1.1.3.1.cmml" xref="A2.E27.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="A2.E27.m1.2.2.2.1.1.1.3.2.cmml" xref="A2.E27.m1.2.2.2.1.1.1.3.2">ğ‘¡</ci><ci id="A2.E27.m1.2.2.2.1.1.1.3.3.cmml" xref="A2.E27.m1.2.2.2.1.1.1.3.3">ğ‘–</ci></apply></apply></apply></apply></apply></apply><apply id="A2.E27.m1.6.6.4.4.6.cmml" xref="A2.E27.m1.6.6.4.4.6"><csymbol cd="ambiguous" id="A2.E27.m1.6.6.4.4.6.1.cmml" xref="A2.E27.m1.6.6.4.4.6">subscript</csymbol><ci id="A2.E27.m1.6.6.4.4.6.2.cmml" xref="A2.E27.m1.6.6.4.4.6.2">ğ‘</ci><ci id="A2.E27.m1.6.6.4.4.6.3.cmml" xref="A2.E27.m1.6.6.4.4.6.3">italic-Ï•</ci></apply><apply id="A2.E27.m1.4.4.2.2.2.1.1.cmml" xref="A2.E27.m1.4.4.2.2.2.1"><csymbol cd="latexml" id="A2.E27.m1.4.4.2.2.2.1.1.1.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.1">conditional</csymbol><apply id="A2.E27.m1.4.4.2.2.2.1.1.2.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A2.E27.m1.4.4.2.2.2.1.1.2.1.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.2">subscript</csymbol><ci id="A2.E27.m1.4.4.2.2.2.1.1.2.2.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.2.2">ğ‘¡</ci><ci id="A2.E27.m1.4.4.2.2.2.1.1.2.3.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.2.3">ğ‘—</ci></apply><apply id="A2.E27.m1.4.4.2.2.2.1.1.3.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A2.E27.m1.4.4.2.2.2.1.1.3.1.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.3">subscript</csymbol><ci id="A2.E27.m1.4.4.2.2.2.1.1.3.2.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.3.2">ğ‘¡</ci><ci id="A2.E27.m1.4.4.2.2.2.1.1.3.3.cmml" xref="A2.E27.m1.4.4.2.2.2.1.1.3.3">ğ‘–</ci></apply></apply><apply id="A2.E27.m1.6.6.4.4.7.cmml" xref="A2.E27.m1.6.6.4.4.7"><ci id="A2.E27.m1.6.6.4.4.7.1.cmml" xref="A2.E27.m1.6.6.4.4.7.1">âˆ‡</ci><apply id="A2.E27.m1.6.6.4.4.7.2.cmml" xref="A2.E27.m1.6.6.4.4.7.2"><csymbol cd="ambiguous" id="A2.E27.m1.6.6.4.4.7.2.1.cmml" xref="A2.E27.m1.6.6.4.4.7.2">subscript</csymbol><ci id="A2.E27.m1.6.6.4.4.7.2.2.cmml" xref="A2.E27.m1.6.6.4.4.7.2.2">ğ‘ </ci><ci id="A2.E27.m1.6.6.4.4.7.2.3.cmml" xref="A2.E27.m1.6.6.4.4.7.2.3">italic-Ï•</ci></apply></apply><interval closure="open" id="A2.E27.m1.6.6.4.4.4.3.cmml" xref="A2.E27.m1.6.6.4.4.4.2"><apply id="A2.E27.m1.5.5.3.3.3.1.1.cmml" xref="A2.E27.m1.5.5.3.3.3.1.1"><csymbol cd="ambiguous" id="A2.E27.m1.5.5.3.3.3.1.1.1.cmml" xref="A2.E27.m1.5.5.3.3.3.1.1">subscript</csymbol><ci id="A2.E27.m1.5.5.3.3.3.1.1.2.cmml" xref="A2.E27.m1.5.5.3.3.3.1.1.2">ğ‘¡</ci><ci id="A2.E27.m1.5.5.3.3.3.1.1.3.cmml" xref="A2.E27.m1.5.5.3.3.3.1.1.3">ğ‘—</ci></apply><apply id="A2.E27.m1.6.6.4.4.4.2.2.cmml" xref="A2.E27.m1.6.6.4.4.4.2.2"><csymbol cd="ambiguous" id="A2.E27.m1.6.6.4.4.4.2.2.1.cmml" xref="A2.E27.m1.6.6.4.4.4.2.2">subscript</csymbol><ci id="A2.E27.m1.6.6.4.4.4.2.2.2.cmml" xref="A2.E27.m1.6.6.4.4.4.2.2.2">ğ‘¡</ci><ci id="A2.E27.m1.6.6.4.4.4.2.2.3.cmml" xref="A2.E27.m1.6.6.4.4.4.2.2.3">ğ‘–</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E27.m1.6c">\displaystyle\nabla\mathrm{KL}=\sum_{t_{k}\in\mathcal{D}}\Bigg{[}1-\frac{%
\tilde{p}_{\mathtt{LM}}(t_{j}|t_{i},y_{i})}{p_{\phi}(t_{j}|t_{i})}\Bigg{]}p_{%
\phi}(t_{j}|t_{i})\nabla s_{\phi}(t_{j},t_{i})</annotation><annotation encoding="application/x-llamapun" id="A2.E27.m1.6d">âˆ‡ roman_KL = âˆ‘ start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆˆ caligraphic_D end_POSTSUBSCRIPT [ 1 - divide start_ARG over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG ] italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) âˆ‡ italic_s start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A2.p1.13">whose rationale is that if the LMâ€™s feedback greatly prefers the neighbor <math alttext="v_{j}" class="ltx_Math" display="inline" id="A2.p1.8.m1.1"><semantics id="A2.p1.8.m1.1a"><msub id="A2.p1.8.m1.1.1" xref="A2.p1.8.m1.1.1.cmml"><mi id="A2.p1.8.m1.1.1.2" xref="A2.p1.8.m1.1.1.2.cmml">v</mi><mi id="A2.p1.8.m1.1.1.3" xref="A2.p1.8.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.8.m1.1b"><apply id="A2.p1.8.m1.1.1.cmml" xref="A2.p1.8.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.8.m1.1.1.1.cmml" xref="A2.p1.8.m1.1.1">subscript</csymbol><ci id="A2.p1.8.m1.1.1.2.cmml" xref="A2.p1.8.m1.1.1.2">ğ‘£</ci><ci id="A2.p1.8.m1.1.1.3.cmml" xref="A2.p1.8.m1.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.8.m1.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.8.m1.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> (and its associated text <math alttext="t_{j}" class="ltx_Math" display="inline" id="A2.p1.9.m2.1"><semantics id="A2.p1.9.m2.1a"><msub id="A2.p1.9.m2.1.1" xref="A2.p1.9.m2.1.1.cmml"><mi id="A2.p1.9.m2.1.1.2" xref="A2.p1.9.m2.1.1.2.cmml">t</mi><mi id="A2.p1.9.m2.1.1.3" xref="A2.p1.9.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.9.m2.1b"><apply id="A2.p1.9.m2.1.1.cmml" xref="A2.p1.9.m2.1.1"><csymbol cd="ambiguous" id="A2.p1.9.m2.1.1.1.cmml" xref="A2.p1.9.m2.1.1">subscript</csymbol><ci id="A2.p1.9.m2.1.1.2.cmml" xref="A2.p1.9.m2.1.1.2">ğ‘¡</ci><ci id="A2.p1.9.m2.1.1.3.cmml" xref="A2.p1.9.m2.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.9.m2.1c">t_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.9.m2.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>), larger than its probability to be retrieved by the retriever (i.e., <math alttext="\frac{\tilde{p}_{\mathtt{LM}}(t_{j}|t_{i},y_{i})}{p_{\phi}(t_{j}|t_{i})}&gt;1" class="ltx_Math" display="inline" id="A2.p1.10.m3.2"><semantics id="A2.p1.10.m3.2a"><mrow id="A2.p1.10.m3.2.3" xref="A2.p1.10.m3.2.3.cmml"><mfrac id="A2.p1.10.m3.2.2" xref="A2.p1.10.m3.2.2.cmml"><mrow id="A2.p1.10.m3.1.1.1" xref="A2.p1.10.m3.1.1.1.cmml"><msub id="A2.p1.10.m3.1.1.1.3" xref="A2.p1.10.m3.1.1.1.3.cmml"><mover accent="true" id="A2.p1.10.m3.1.1.1.3.2" xref="A2.p1.10.m3.1.1.1.3.2.cmml"><mi id="A2.p1.10.m3.1.1.1.3.2.2" xref="A2.p1.10.m3.1.1.1.3.2.2.cmml">p</mi><mo id="A2.p1.10.m3.1.1.1.3.2.1" xref="A2.p1.10.m3.1.1.1.3.2.1.cmml">~</mo></mover><mi id="A2.p1.10.m3.1.1.1.3.3" xref="A2.p1.10.m3.1.1.1.3.3.cmml">ğ™»ğ™¼</mi></msub><mo id="A2.p1.10.m3.1.1.1.2" xref="A2.p1.10.m3.1.1.1.2.cmml">â¢</mo><mrow id="A2.p1.10.m3.1.1.1.1.1" xref="A2.p1.10.m3.1.1.1.1.1.1.cmml"><mo id="A2.p1.10.m3.1.1.1.1.1.2" stretchy="false" xref="A2.p1.10.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.p1.10.m3.1.1.1.1.1.1" xref="A2.p1.10.m3.1.1.1.1.1.1.cmml"><msub id="A2.p1.10.m3.1.1.1.1.1.1.4" xref="A2.p1.10.m3.1.1.1.1.1.1.4.cmml"><mi id="A2.p1.10.m3.1.1.1.1.1.1.4.2" xref="A2.p1.10.m3.1.1.1.1.1.1.4.2.cmml">t</mi><mi id="A2.p1.10.m3.1.1.1.1.1.1.4.3" xref="A2.p1.10.m3.1.1.1.1.1.1.4.3.cmml">j</mi></msub><mo fence="false" id="A2.p1.10.m3.1.1.1.1.1.1.3" xref="A2.p1.10.m3.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.p1.10.m3.1.1.1.1.1.1.2.2" xref="A2.p1.10.m3.1.1.1.1.1.1.2.3.cmml"><msub id="A2.p1.10.m3.1.1.1.1.1.1.1.1.1" xref="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.2" xref="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.3" xref="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A2.p1.10.m3.1.1.1.1.1.1.2.2.3" xref="A2.p1.10.m3.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="A2.p1.10.m3.1.1.1.1.1.1.2.2.2" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.2" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.3" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo id="A2.p1.10.m3.1.1.1.1.1.3" stretchy="false" xref="A2.p1.10.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.p1.10.m3.2.2.2" xref="A2.p1.10.m3.2.2.2.cmml"><msub id="A2.p1.10.m3.2.2.2.3" xref="A2.p1.10.m3.2.2.2.3.cmml"><mi id="A2.p1.10.m3.2.2.2.3.2" xref="A2.p1.10.m3.2.2.2.3.2.cmml">p</mi><mi id="A2.p1.10.m3.2.2.2.3.3" xref="A2.p1.10.m3.2.2.2.3.3.cmml">Ï•</mi></msub><mo id="A2.p1.10.m3.2.2.2.2" xref="A2.p1.10.m3.2.2.2.2.cmml">â¢</mo><mrow id="A2.p1.10.m3.2.2.2.1.1" xref="A2.p1.10.m3.2.2.2.1.1.1.cmml"><mo id="A2.p1.10.m3.2.2.2.1.1.2" stretchy="false" xref="A2.p1.10.m3.2.2.2.1.1.1.cmml">(</mo><mrow id="A2.p1.10.m3.2.2.2.1.1.1" xref="A2.p1.10.m3.2.2.2.1.1.1.cmml"><msub id="A2.p1.10.m3.2.2.2.1.1.1.2" xref="A2.p1.10.m3.2.2.2.1.1.1.2.cmml"><mi id="A2.p1.10.m3.2.2.2.1.1.1.2.2" xref="A2.p1.10.m3.2.2.2.1.1.1.2.2.cmml">t</mi><mi id="A2.p1.10.m3.2.2.2.1.1.1.2.3" xref="A2.p1.10.m3.2.2.2.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="A2.p1.10.m3.2.2.2.1.1.1.1" xref="A2.p1.10.m3.2.2.2.1.1.1.1.cmml">|</mo><msub id="A2.p1.10.m3.2.2.2.1.1.1.3" xref="A2.p1.10.m3.2.2.2.1.1.1.3.cmml"><mi id="A2.p1.10.m3.2.2.2.1.1.1.3.2" xref="A2.p1.10.m3.2.2.2.1.1.1.3.2.cmml">t</mi><mi id="A2.p1.10.m3.2.2.2.1.1.1.3.3" xref="A2.p1.10.m3.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A2.p1.10.m3.2.2.2.1.1.3" stretchy="false" xref="A2.p1.10.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="A2.p1.10.m3.2.3.1" xref="A2.p1.10.m3.2.3.1.cmml">&gt;</mo><mn id="A2.p1.10.m3.2.3.2" xref="A2.p1.10.m3.2.3.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.10.m3.2b"><apply id="A2.p1.10.m3.2.3.cmml" xref="A2.p1.10.m3.2.3"><gt id="A2.p1.10.m3.2.3.1.cmml" xref="A2.p1.10.m3.2.3.1"></gt><apply id="A2.p1.10.m3.2.2.cmml" xref="A2.p1.10.m3.2.2"><divide id="A2.p1.10.m3.2.2.3.cmml" xref="A2.p1.10.m3.2.2"></divide><apply id="A2.p1.10.m3.1.1.1.cmml" xref="A2.p1.10.m3.1.1.1"><times id="A2.p1.10.m3.1.1.1.2.cmml" xref="A2.p1.10.m3.1.1.1.2"></times><apply id="A2.p1.10.m3.1.1.1.3.cmml" xref="A2.p1.10.m3.1.1.1.3"><csymbol cd="ambiguous" id="A2.p1.10.m3.1.1.1.3.1.cmml" xref="A2.p1.10.m3.1.1.1.3">subscript</csymbol><apply id="A2.p1.10.m3.1.1.1.3.2.cmml" xref="A2.p1.10.m3.1.1.1.3.2"><ci id="A2.p1.10.m3.1.1.1.3.2.1.cmml" xref="A2.p1.10.m3.1.1.1.3.2.1">~</ci><ci id="A2.p1.10.m3.1.1.1.3.2.2.cmml" xref="A2.p1.10.m3.1.1.1.3.2.2">ğ‘</ci></apply><ci id="A2.p1.10.m3.1.1.1.3.3.cmml" xref="A2.p1.10.m3.1.1.1.3.3">ğ™»ğ™¼</ci></apply><apply id="A2.p1.10.m3.1.1.1.1.1.1.cmml" xref="A2.p1.10.m3.1.1.1.1.1"><csymbol cd="latexml" id="A2.p1.10.m3.1.1.1.1.1.1.3.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.3">conditional</csymbol><apply id="A2.p1.10.m3.1.1.1.1.1.1.4.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.p1.10.m3.1.1.1.1.1.1.4.1.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.4">subscript</csymbol><ci id="A2.p1.10.m3.1.1.1.1.1.1.4.2.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.4.2">ğ‘¡</ci><ci id="A2.p1.10.m3.1.1.1.1.1.1.4.3.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.4.3">ğ‘—</ci></apply><list id="A2.p1.10.m3.1.1.1.1.1.1.2.3.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2"><apply id="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.2">ğ‘¡</ci><ci id="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.1.1.1.3">ğ‘–</ci></apply><apply id="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.2">ğ‘¦</ci><ci id="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.p1.10.m3.1.1.1.1.1.1.2.2.2.3">ğ‘–</ci></apply></list></apply></apply><apply id="A2.p1.10.m3.2.2.2.cmml" xref="A2.p1.10.m3.2.2.2"><times id="A2.p1.10.m3.2.2.2.2.cmml" xref="A2.p1.10.m3.2.2.2.2"></times><apply id="A2.p1.10.m3.2.2.2.3.cmml" xref="A2.p1.10.m3.2.2.2.3"><csymbol cd="ambiguous" id="A2.p1.10.m3.2.2.2.3.1.cmml" xref="A2.p1.10.m3.2.2.2.3">subscript</csymbol><ci id="A2.p1.10.m3.2.2.2.3.2.cmml" xref="A2.p1.10.m3.2.2.2.3.2">ğ‘</ci><ci id="A2.p1.10.m3.2.2.2.3.3.cmml" xref="A2.p1.10.m3.2.2.2.3.3">italic-Ï•</ci></apply><apply id="A2.p1.10.m3.2.2.2.1.1.1.cmml" xref="A2.p1.10.m3.2.2.2.1.1"><csymbol cd="latexml" id="A2.p1.10.m3.2.2.2.1.1.1.1.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.1">conditional</csymbol><apply id="A2.p1.10.m3.2.2.2.1.1.1.2.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A2.p1.10.m3.2.2.2.1.1.1.2.1.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.2">subscript</csymbol><ci id="A2.p1.10.m3.2.2.2.1.1.1.2.2.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.2.2">ğ‘¡</ci><ci id="A2.p1.10.m3.2.2.2.1.1.1.2.3.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.2.3">ğ‘—</ci></apply><apply id="A2.p1.10.m3.2.2.2.1.1.1.3.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A2.p1.10.m3.2.2.2.1.1.1.3.1.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.3">subscript</csymbol><ci id="A2.p1.10.m3.2.2.2.1.1.1.3.2.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.3.2">ğ‘¡</ci><ci id="A2.p1.10.m3.2.2.2.1.1.1.3.3.cmml" xref="A2.p1.10.m3.2.2.2.1.1.1.3.3">ğ‘–</ci></apply></apply></apply></apply><cn id="A2.p1.10.m3.2.3.2.cmml" type="integer" xref="A2.p1.10.m3.2.3.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.10.m3.2c">\frac{\tilde{p}_{\mathtt{LM}}(t_{j}|t_{i},y_{i})}{p_{\phi}(t_{j}|t_{i})}&gt;1</annotation><annotation encoding="application/x-llamapun" id="A2.p1.10.m3.2d">divide start_ARG over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT typewriter_LM end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_Ï• end_POSTSUBSCRIPT ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG &gt; 1</annotation></semantics></math>), then the similarity score between <math alttext="t_{i}" class="ltx_Math" display="inline" id="A2.p1.11.m4.1"><semantics id="A2.p1.11.m4.1a"><msub id="A2.p1.11.m4.1.1" xref="A2.p1.11.m4.1.1.cmml"><mi id="A2.p1.11.m4.1.1.2" xref="A2.p1.11.m4.1.1.2.cmml">t</mi><mi id="A2.p1.11.m4.1.1.3" xref="A2.p1.11.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.11.m4.1b"><apply id="A2.p1.11.m4.1.1.cmml" xref="A2.p1.11.m4.1.1"><csymbol cd="ambiguous" id="A2.p1.11.m4.1.1.1.cmml" xref="A2.p1.11.m4.1.1">subscript</csymbol><ci id="A2.p1.11.m4.1.1.2.cmml" xref="A2.p1.11.m4.1.1.2">ğ‘¡</ci><ci id="A2.p1.11.m4.1.1.3.cmml" xref="A2.p1.11.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.11.m4.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.11.m4.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="t_{j}" class="ltx_Math" display="inline" id="A2.p1.12.m5.1"><semantics id="A2.p1.12.m5.1a"><msub id="A2.p1.12.m5.1.1" xref="A2.p1.12.m5.1.1.cmml"><mi id="A2.p1.12.m5.1.1.2" xref="A2.p1.12.m5.1.1.2.cmml">t</mi><mi id="A2.p1.12.m5.1.1.3" xref="A2.p1.12.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.12.m5.1b"><apply id="A2.p1.12.m5.1.1.cmml" xref="A2.p1.12.m5.1.1"><csymbol cd="ambiguous" id="A2.p1.12.m5.1.1.1.cmml" xref="A2.p1.12.m5.1.1">subscript</csymbol><ci id="A2.p1.12.m5.1.1.2.cmml" xref="A2.p1.12.m5.1.1.2">ğ‘¡</ci><ci id="A2.p1.12.m5.1.1.3.cmml" xref="A2.p1.12.m5.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.12.m5.1c">t_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.12.m5.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> will increase, i.e., improve the probability of <math alttext="t_{j}" class="ltx_Math" display="inline" id="A2.p1.13.m6.1"><semantics id="A2.p1.13.m6.1a"><msub id="A2.p1.13.m6.1.1" xref="A2.p1.13.m6.1.1.cmml"><mi id="A2.p1.13.m6.1.1.2" xref="A2.p1.13.m6.1.1.2.cmml">t</mi><mi id="A2.p1.13.m6.1.1.3" xref="A2.p1.13.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.13.m6.1b"><apply id="A2.p1.13.m6.1.1.cmml" xref="A2.p1.13.m6.1.1"><csymbol cd="ambiguous" id="A2.p1.13.m6.1.1.1.cmml" xref="A2.p1.13.m6.1.1">subscript</csymbol><ci id="A2.p1.13.m6.1.1.2.cmml" xref="A2.p1.13.m6.1.1.2">ğ‘¡</ci><ci id="A2.p1.13.m6.1.1.3.cmml" xref="A2.p1.13.m6.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.13.m6.1c">t_{j}</annotation><annotation encoding="application/x-llamapun" id="A2.p1.13.m6.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to be retrieved.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Templates</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#A3.T5" title="Table 5 â€£ Appendix C Templates â€£ Language Models are Graph Learners"><span class="ltx_text ltx_ref_tag">5</span></a> presents templates used in this paper. We design the â€œCitationâ€ template for the Cora, Pubmed, and ogbn-arxiv datasets and the â€œAmazonâ€ template for the ogbn-products dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.1">Drawing inspiration from the findings ofÂ <cite class="ltx_cite ltx_citemacro_cite">He etÂ al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02296v1#bib.bib23" title="">2024</a>)</cite>, who demonstrated the efficacy of positioning the title after the main content for certain datasets, we have also introduced two additional template variations: â€œCitation Title Lastâ€ and â€œAmazon Title Last.â€</p>
</div>
<figure class="ltx_table" id="A3.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Templates used for all datasets.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A3.T5.1.1.1.1">Template name</th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_tt" id="A3.T5.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T5.1.1.1.2.1">
<span class="ltx_p" id="A3.T5.1.1.1.2.1.1">Text</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T5.1.2.1.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.2.1.1.1">
<tr class="ltx_tr" id="A3.T5.1.2.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.2.1.1.1.1.1">Citation</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.2.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.2.1.1.1.2.1">(for Cora, Pubmed, ogbn-arxiv)</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A3.T5.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T5.1.2.1.2.1">
<span class="ltx_p" id="A3.T5.1.2.1.2.1.1">Please classify the following paper into <span class="ltx_text" id="A3.T5.1.2.1.2.1.1.1" style="color:#0000FF;">{pruned label candidates}</span> based on the provided information<span class="ltx_text" id="A3.T5.1.2.1.2.1.1.2" style="color:#808080;">\n</span>Title: <span class="ltx_text" id="A3.T5.1.2.1.2.1.1.3" style="color:#0000FF;">{target nodeâ€™s title}<span class="ltx_text" id="A3.T5.1.2.1.2.1.1.3.1" style="color:#808080;">\n</span></span>Content: <span class="ltx_text" id="A3.T5.1.2.1.2.1.1.4" style="color:#0000FF;">{target nodeâ€™s abstract}<span class="ltx_text" id="A3.T5.1.2.1.2.1.1.4.1" style="color:#808080;">\n</span></span>Related papers: <span class="ltx_text" id="A3.T5.1.2.1.2.1.1.5" style="color:#0000FF;">{retrieved nodesâ€™ titles}</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T5.1.3.2.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.3.2.1.1">
<tr class="ltx_tr" id="A3.T5.1.3.2.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.3.2.1.1.1.1">Citation Title Last</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.3.2.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.3.2.1.1.2.1">(for Cora, Pubmed, ogbn-arxiv)</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A3.T5.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T5.1.3.2.2.1">
<span class="ltx_p" id="A3.T5.1.3.2.2.1.1">Please classify the following paper into <span class="ltx_text" id="A3.T5.1.3.2.2.1.1.1" style="color:#0000FF;">{pruned label candidates}</span> based on the provided information<span class="ltx_text" id="A3.T5.1.3.2.2.1.1.2" style="color:#808080;">\n</span>Content: <span class="ltx_text" id="A3.T5.1.3.2.2.1.1.3" style="color:#0000FF;">{target nodeâ€™s abstract}<span class="ltx_text" id="A3.T5.1.3.2.2.1.1.3.1" style="color:#808080;">\n</span></span>Related papers: <span class="ltx_text" id="A3.T5.1.3.2.2.1.1.4" style="color:#0000FF;">{retrieved nodesâ€™ titles}<span class="ltx_text" id="A3.T5.1.3.2.2.1.1.4.1" style="color:#808080;">\n</span></span>Title: <span class="ltx_text" id="A3.T5.1.3.2.2.1.1.5" style="color:#0000FF;">{target nodeâ€™s title}</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T5.1.4.3.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.4.3.1.1">
<tr class="ltx_tr" id="A3.T5.1.4.3.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.4.3.1.1.1.1">Amazon</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.4.3.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.4.3.1.1.2.1">(for ogbn-products)</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A3.T5.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T5.1.4.3.2.1">
<span class="ltx_p" id="A3.T5.1.4.3.2.1.1">Please classify the following Amazon product into <span class="ltx_text" id="A3.T5.1.4.3.2.1.1.1" style="color:#0000FF;">{pruned label candidates}</span> based on the provided information<span class="ltx_text" id="A3.T5.1.4.3.2.1.1.2" style="color:#808080;">\n</span>Product name: <span class="ltx_text" id="A3.T5.1.4.3.2.1.1.3" style="color:#0000FF;">{target nodeâ€™s title}<span class="ltx_text" id="A3.T5.1.4.3.2.1.1.3.1" style="color:#808080;">\n</span></span>Description: <span class="ltx_text" id="A3.T5.1.4.3.2.1.1.4" style="color:#0000FF;">{target nodeâ€™s description}<span class="ltx_text" id="A3.T5.1.4.3.2.1.1.4.1" style="color:#808080;">\n</span></span>Related products: <span class="ltx_text" id="A3.T5.1.4.3.2.1.1.5" style="color:#0000FF;">{retrieved nodesâ€™ titles}</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="A3.T5.1.5.4.1">
<table class="ltx_tabular ltx_align_middle" id="A3.T5.1.5.4.1.1">
<tr class="ltx_tr" id="A3.T5.1.5.4.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.5.4.1.1.1.1">Amazon Title Last</td>
</tr>
<tr class="ltx_tr" id="A3.T5.1.5.4.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A3.T5.1.5.4.1.1.2.1">(for ogbn-products)</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_t" id="A3.T5.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T5.1.5.4.2.1">
<span class="ltx_p" id="A3.T5.1.5.4.2.1.1">Please classify the following Amazon product into <span class="ltx_text" id="A3.T5.1.5.4.2.1.1.1" style="color:#0000FF;">{pruned label candidates}</span> based on the provided information<span class="ltx_text" id="A3.T5.1.5.4.2.1.1.2" style="color:#808080;">\n</span>Description: <span class="ltx_text" id="A3.T5.1.5.4.2.1.1.3" style="color:#0000FF;">{target nodeâ€™s description}<span class="ltx_text" id="A3.T5.1.5.4.2.1.1.3.1" style="color:#808080;">\n</span></span>Related products: <span class="ltx_text" id="A3.T5.1.5.4.2.1.1.4" style="color:#0000FF;">{retrieved nodesâ€™ titles}<span class="ltx_text" id="A3.T5.1.5.4.2.1.1.4.1" style="color:#808080;">\n</span></span>Product name: <span class="ltx_text" id="A3.T5.1.5.4.2.1.1.5" style="color:#0000FF;">{target nodeâ€™s title}</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 08:25:59 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
