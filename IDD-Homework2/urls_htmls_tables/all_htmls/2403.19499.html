<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.19499] Client-supervised Federated Learning: Towards One-model-for-all Personalization</title><meta property="og:description" content="Personalized Federated Learning (PerFL) is a new machine learning paradigm that delivers personalized models for diverse clients under federated learning settings. Most PerFL methods require extra learning processes on…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Client-supervised Federated Learning: Towards One-model-for-all Personalization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Client-supervised Federated Learning: Towards One-model-for-all Personalization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.19499">

<!--Generated on Fri Apr  5 18:14:16 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Client-supervised Federated Learning: Towards One-model-for-all Personalization </h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Personalized Federated Learning (PerFL) is a new machine learning paradigm that delivers personalized models for diverse clients under federated learning settings. Most PerFL methods require extra learning processes on a client to adapt a globally shared model to the client-specific personalized model using its own local data. However, the model adaptation process in PerFL is still an open challenge in the stage of model deployment and test time. This work tackles the challenge by proposing a novel federated learning framework to learn only one robust global model to achieve competitive performance to those personalized models on unseen/test clients in the FL system. Specifically, we design a new <span id="id1.id1.1" class="ltx_text ltx_font_bold">Client-Supervised Federated Learning (FedCS)</span> to unravel clients’ bias on instances’ latent representations so that the global model can learn both client-specific and client-agnostic knowledge. Experimental study shows that the FedCS can learn a robust FL global model for the changing data distributions of unseen/test clients. The FedCS’s global model can be directly deployed to the test clients while achieving comparable performance to other personalized FL methods that require model adaptation.</p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— </span></span>
Federated Learning</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction </h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Modern machine learning relies on massive data to train models like deep neural networks (DNNs), but collecting data is becoming more sensitive with increasing attention to privacy protection. Then, federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> emerged and became a popular learning paradigm in recent years. The FL aims to coordinate a set of clients (i.e., devices) to train a global model while preserving their data locally and privately. Further, personalized FL (PerFL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> balances cross-client training and personalization. Clients will collaborate as in vanilla FL and leverage client-specific properties to learn personalized models demonstrating superior performance on non-IID data.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Existing personalized federated learning research usually aims to learn many client-specific personalized models to tackle the non-IID data in federated learning systems. Specifically, a global model will be learned to grasp shared knowledge, and then many personalized models will be learned or fine-tuned on the client by leveraging the global model and local dataset. Although this client-specific personalised model strategy has the potential to catch non-IID in fine-grained, the on-device learning and fine-tuning process is usually difficult to control in practice, especially in the stage of model deployment and test time.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">This paper aims to rethink the personalized federated learning problem by proposing a one-model-for-all strategy to embody personalization in federated settings. One motivation is that model personalization in most PerFL methods relies on the bias of instances on the same client, and little supervised information describing the client is introduced. Then, the global model trained on the same data will attain the same performance if it can recognize the bias of a client. Inspired by this, we propose to use a one-model-for-all strategy to learn a unified model that can be shared across clients in the FL system. Moreover, the client-specific information will be encoded in a unified representation space and then be fed into a decision module along with the client-agnostic knowledge to make the final prediction.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Based on the thought above, this work proposes a novel <span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Client-Supervised Federated Learning (FedCS)</span> that is to learn a unified global model with the below functions, including 1) to learn a unified representation space that can encode the bias of a client, 2) to share client-agnostic knowledge as vanilla FL methods, and 3) to make personalized predictions by leveraging both pieces of information. Moreover, the <span id="S1.p4.1.2" class="ltx_text ltx_font_bold">Representation Alignment (RA)</span> mechanism in FedCS could become a plug-in component to be integrated with any federated learning methods. It enables a vanilla FL model to output personalized results without on-device fine-tuning steps. An illustration of the FedCS is in Fig.<a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<p id="S1.F1.1" class="ltx_p ltx_align_center"><span id="S1.F1.1.1" class="ltx_text"><img src="/html/2403.19499/assets/images/Fig-Architecture.png" id="S1.F1.1.1.g1" class="ltx_graphics ltx_img_square" width="334" height="332" alt="Refer to caption"></span></p>
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>Illustration to the FedCS. (b) and (c) describe distributions of instances’ latent representations before and after the Representation Alignment module (RA Module). Types of markers denote classes, and colors indicate clients they are observed. The vanilla feature extractor is unable to recognize clients’ bias. RA module in FedCS will align the hidden space so that latent representations can indicate biases of clients.</figcaption>
</figure>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To learn the above objectives in a federated optimization framework, we designed a novel <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">Client-Supervised Federated Optimization Framework</span> to align the objective representation space while being consistent with the federated optimization framework. It exploits the bias that instances on the same client are influenced by identical client properties and formulates the representation aligning task into an optimization problem that clients can solve collaboratively.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Through qualitative and quantitative experiments, we illustrate how FedCS is integrated into a black-box model to achieve compared performance of other personalized federated learning methods. Moreover, we demonstrate that FedCS is compatible with most FL models. Vanilla models with an RA module can achieve competitive performance compared to those ad hoc PerFL models while not need extra fine-tuning steps or personal parameters.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">The main contributions are summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel one-model-for-all personalized FL framework that won’t require an extra fine-tuning process at the stage of model deployment and test time. The personalization in the FL system is carried on representations indicating client bias rather than models.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We designed a novel <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">representation alignment</span> mechanism to project instances’ representation into a space indicating clients’ biases. The following decision layers in the neural architecture can automatically learn to make personalized predictions by leveraging the client’s bias.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">A <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">client-supervised optimization framework</span> is designed to fit the proposed framework. It formulates the representation-aligning problem into a unified optimization framework that clients can solve collaboratively under FL settings.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Contrast with baseline methods shows that, by integrating FedCS into vanilla FL models, they can achieve competitive personalization performance without requiring extra fine-tuning steps or personal parameters.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Federated Learning</span> is an emerging machine learning paradigm where many clients collaborate to train a global model by sharing and aggregating model parameters rather than user data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Further work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> shows that the global model performs better after tuning toward client-specific properties and proposes <span id="S2.p1.1.2" class="ltx_text ltx_font_bold">Personalized Federated Learning</span>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">A popular way to personalize is to fine-tune the global model on a client’s local data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>; meta-learning strategies will help improve the tuning process <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Meanwhile, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> trains a local model for each client while constraining the distributed training procedures with a shared regularizer. Recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> studies partial personalization, splitting an FL model into global and local parts. Personalization is fulfilled by individually training the local part of a model on clients. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> is a simple but efficient case of these methods. It trains a model through the vanilla FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> except for preserving batch-normalization modules locally. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> introduces a method to learn a shared data representation across clients and unique classification heads for each client. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> utilizes a global and a local encoder to learn different representations for cross-client collaboration and personalization. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> propose to learn unique representations for client properties to improve personalization on new clients. However, these methods require extra training data to capture those clients’ properties when deployed on them, which is only sometimes feasible.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Formulation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.6" class="ltx_p"><span id="S3.p1.6.1" class="ltx_text ltx_font_bold">Federated Learning (FL)</span> assumes <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">K</annotation></semantics></math> clients participate in a learning process with <math id="S3.p1.2.m2.8" class="ltx_Math" alttext="{\{}\mathbf{x}_{1}^{(i)},\mathbf{x}_{2}^{(i)},...,\mathbf{x}_{N_{i}}^{(i)}\}\in\mathcal{X}^{(i)}" display="inline"><semantics id="S3.p1.2.m2.8a"><mrow id="S3.p1.2.m2.8.8" xref="S3.p1.2.m2.8.8.cmml"><mrow id="S3.p1.2.m2.8.8.3.3" xref="S3.p1.2.m2.8.8.3.4.cmml"><mo stretchy="false" id="S3.p1.2.m2.8.8.3.3.4" xref="S3.p1.2.m2.8.8.3.4.cmml">{</mo><msubsup id="S3.p1.2.m2.6.6.1.1.1" xref="S3.p1.2.m2.6.6.1.1.1.cmml"><mi id="S3.p1.2.m2.6.6.1.1.1.2.2" xref="S3.p1.2.m2.6.6.1.1.1.2.2.cmml">𝐱</mi><mn id="S3.p1.2.m2.6.6.1.1.1.2.3" xref="S3.p1.2.m2.6.6.1.1.1.2.3.cmml">1</mn><mrow id="S3.p1.2.m2.1.1.1.3" xref="S3.p1.2.m2.6.6.1.1.1.cmml"><mo stretchy="false" id="S3.p1.2.m2.1.1.1.3.1" xref="S3.p1.2.m2.6.6.1.1.1.cmml">(</mo><mi id="S3.p1.2.m2.1.1.1.1" xref="S3.p1.2.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.2.m2.1.1.1.3.2" xref="S3.p1.2.m2.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.2.m2.8.8.3.3.5" xref="S3.p1.2.m2.8.8.3.4.cmml">,</mo><msubsup id="S3.p1.2.m2.7.7.2.2.2" xref="S3.p1.2.m2.7.7.2.2.2.cmml"><mi id="S3.p1.2.m2.7.7.2.2.2.2.2" xref="S3.p1.2.m2.7.7.2.2.2.2.2.cmml">𝐱</mi><mn id="S3.p1.2.m2.7.7.2.2.2.2.3" xref="S3.p1.2.m2.7.7.2.2.2.2.3.cmml">2</mn><mrow id="S3.p1.2.m2.2.2.1.3" xref="S3.p1.2.m2.7.7.2.2.2.cmml"><mo stretchy="false" id="S3.p1.2.m2.2.2.1.3.1" xref="S3.p1.2.m2.7.7.2.2.2.cmml">(</mo><mi id="S3.p1.2.m2.2.2.1.1" xref="S3.p1.2.m2.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.2.m2.2.2.1.3.2" xref="S3.p1.2.m2.7.7.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.p1.2.m2.8.8.3.3.6" xref="S3.p1.2.m2.8.8.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.p1.2.m2.5.5" xref="S3.p1.2.m2.5.5.cmml">…</mi><mo id="S3.p1.2.m2.8.8.3.3.7" xref="S3.p1.2.m2.8.8.3.4.cmml">,</mo><msubsup id="S3.p1.2.m2.8.8.3.3.3" xref="S3.p1.2.m2.8.8.3.3.3.cmml"><mi id="S3.p1.2.m2.8.8.3.3.3.2.2" xref="S3.p1.2.m2.8.8.3.3.3.2.2.cmml">𝐱</mi><msub id="S3.p1.2.m2.8.8.3.3.3.2.3" xref="S3.p1.2.m2.8.8.3.3.3.2.3.cmml"><mi id="S3.p1.2.m2.8.8.3.3.3.2.3.2" xref="S3.p1.2.m2.8.8.3.3.3.2.3.2.cmml">N</mi><mi id="S3.p1.2.m2.8.8.3.3.3.2.3.3" xref="S3.p1.2.m2.8.8.3.3.3.2.3.3.cmml">i</mi></msub><mrow id="S3.p1.2.m2.3.3.1.3" xref="S3.p1.2.m2.8.8.3.3.3.cmml"><mo stretchy="false" id="S3.p1.2.m2.3.3.1.3.1" xref="S3.p1.2.m2.8.8.3.3.3.cmml">(</mo><mi id="S3.p1.2.m2.3.3.1.1" xref="S3.p1.2.m2.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.2.m2.3.3.1.3.2" xref="S3.p1.2.m2.8.8.3.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p1.2.m2.8.8.3.3.8" xref="S3.p1.2.m2.8.8.3.4.cmml">}</mo></mrow><mo id="S3.p1.2.m2.8.8.4" xref="S3.p1.2.m2.8.8.4.cmml">∈</mo><msup id="S3.p1.2.m2.8.8.5" xref="S3.p1.2.m2.8.8.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.8.8.5.2" xref="S3.p1.2.m2.8.8.5.2.cmml">𝒳</mi><mrow id="S3.p1.2.m2.4.4.1.3" xref="S3.p1.2.m2.8.8.5.cmml"><mo stretchy="false" id="S3.p1.2.m2.4.4.1.3.1" xref="S3.p1.2.m2.8.8.5.cmml">(</mo><mi id="S3.p1.2.m2.4.4.1.1" xref="S3.p1.2.m2.4.4.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.2.m2.4.4.1.3.2" xref="S3.p1.2.m2.8.8.5.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.8b"><apply id="S3.p1.2.m2.8.8.cmml" xref="S3.p1.2.m2.8.8"><in id="S3.p1.2.m2.8.8.4.cmml" xref="S3.p1.2.m2.8.8.4"></in><set id="S3.p1.2.m2.8.8.3.4.cmml" xref="S3.p1.2.m2.8.8.3.3"><apply id="S3.p1.2.m2.6.6.1.1.1.cmml" xref="S3.p1.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.6.6.1.1.1.1.cmml" xref="S3.p1.2.m2.6.6.1.1.1">superscript</csymbol><apply id="S3.p1.2.m2.6.6.1.1.1.2.cmml" xref="S3.p1.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.6.6.1.1.1.2.1.cmml" xref="S3.p1.2.m2.6.6.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.6.6.1.1.1.2.2.cmml" xref="S3.p1.2.m2.6.6.1.1.1.2.2">𝐱</ci><cn type="integer" id="S3.p1.2.m2.6.6.1.1.1.2.3.cmml" xref="S3.p1.2.m2.6.6.1.1.1.2.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1.1">𝑖</ci></apply><apply id="S3.p1.2.m2.7.7.2.2.2.cmml" xref="S3.p1.2.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.7.7.2.2.2.1.cmml" xref="S3.p1.2.m2.7.7.2.2.2">superscript</csymbol><apply id="S3.p1.2.m2.7.7.2.2.2.2.cmml" xref="S3.p1.2.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.7.7.2.2.2.2.1.cmml" xref="S3.p1.2.m2.7.7.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.7.7.2.2.2.2.2.cmml" xref="S3.p1.2.m2.7.7.2.2.2.2.2">𝐱</ci><cn type="integer" id="S3.p1.2.m2.7.7.2.2.2.2.3.cmml" xref="S3.p1.2.m2.7.7.2.2.2.2.3">2</cn></apply><ci id="S3.p1.2.m2.2.2.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1">𝑖</ci></apply><ci id="S3.p1.2.m2.5.5.cmml" xref="S3.p1.2.m2.5.5">…</ci><apply id="S3.p1.2.m2.8.8.3.3.3.cmml" xref="S3.p1.2.m2.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.8.8.3.3.3.1.cmml" xref="S3.p1.2.m2.8.8.3.3.3">superscript</csymbol><apply id="S3.p1.2.m2.8.8.3.3.3.2.cmml" xref="S3.p1.2.m2.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.8.8.3.3.3.2.1.cmml" xref="S3.p1.2.m2.8.8.3.3.3">subscript</csymbol><ci id="S3.p1.2.m2.8.8.3.3.3.2.2.cmml" xref="S3.p1.2.m2.8.8.3.3.3.2.2">𝐱</ci><apply id="S3.p1.2.m2.8.8.3.3.3.2.3.cmml" xref="S3.p1.2.m2.8.8.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.8.8.3.3.3.2.3.1.cmml" xref="S3.p1.2.m2.8.8.3.3.3.2.3">subscript</csymbol><ci id="S3.p1.2.m2.8.8.3.3.3.2.3.2.cmml" xref="S3.p1.2.m2.8.8.3.3.3.2.3.2">𝑁</ci><ci id="S3.p1.2.m2.8.8.3.3.3.2.3.3.cmml" xref="S3.p1.2.m2.8.8.3.3.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.p1.2.m2.3.3.1.1.cmml" xref="S3.p1.2.m2.3.3.1.1">𝑖</ci></apply></set><apply id="S3.p1.2.m2.8.8.5.cmml" xref="S3.p1.2.m2.8.8.5"><csymbol cd="ambiguous" id="S3.p1.2.m2.8.8.5.1.cmml" xref="S3.p1.2.m2.8.8.5">superscript</csymbol><ci id="S3.p1.2.m2.8.8.5.2.cmml" xref="S3.p1.2.m2.8.8.5.2">𝒳</ci><ci id="S3.p1.2.m2.4.4.1.1.cmml" xref="S3.p1.2.m2.4.4.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.8c">{\{}\mathbf{x}_{1}^{(i)},\mathbf{x}_{2}^{(i)},...,\mathbf{x}_{N_{i}}^{(i)}\}\in\mathcal{X}^{(i)}</annotation></semantics></math> denoting instances on the <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">i</annotation></semantics></math>-th client, and <math id="S3.p1.4.m4.8" class="ltx_Math" alttext="\{y_{1}^{(i)},y_{2}^{(i)},...,y_{N_{i}}^{(i)}\}\in\mathcal{Y}^{(i)}" display="inline"><semantics id="S3.p1.4.m4.8a"><mrow id="S3.p1.4.m4.8.8" xref="S3.p1.4.m4.8.8.cmml"><mrow id="S3.p1.4.m4.8.8.3.3" xref="S3.p1.4.m4.8.8.3.4.cmml"><mo stretchy="false" id="S3.p1.4.m4.8.8.3.3.4" xref="S3.p1.4.m4.8.8.3.4.cmml">{</mo><msubsup id="S3.p1.4.m4.6.6.1.1.1" xref="S3.p1.4.m4.6.6.1.1.1.cmml"><mi id="S3.p1.4.m4.6.6.1.1.1.2.2" xref="S3.p1.4.m4.6.6.1.1.1.2.2.cmml">y</mi><mn id="S3.p1.4.m4.6.6.1.1.1.2.3" xref="S3.p1.4.m4.6.6.1.1.1.2.3.cmml">1</mn><mrow id="S3.p1.4.m4.1.1.1.3" xref="S3.p1.4.m4.6.6.1.1.1.cmml"><mo stretchy="false" id="S3.p1.4.m4.1.1.1.3.1" xref="S3.p1.4.m4.6.6.1.1.1.cmml">(</mo><mi id="S3.p1.4.m4.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.4.m4.1.1.1.3.2" xref="S3.p1.4.m4.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.4.m4.8.8.3.3.5" xref="S3.p1.4.m4.8.8.3.4.cmml">,</mo><msubsup id="S3.p1.4.m4.7.7.2.2.2" xref="S3.p1.4.m4.7.7.2.2.2.cmml"><mi id="S3.p1.4.m4.7.7.2.2.2.2.2" xref="S3.p1.4.m4.7.7.2.2.2.2.2.cmml">y</mi><mn id="S3.p1.4.m4.7.7.2.2.2.2.3" xref="S3.p1.4.m4.7.7.2.2.2.2.3.cmml">2</mn><mrow id="S3.p1.4.m4.2.2.1.3" xref="S3.p1.4.m4.7.7.2.2.2.cmml"><mo stretchy="false" id="S3.p1.4.m4.2.2.1.3.1" xref="S3.p1.4.m4.7.7.2.2.2.cmml">(</mo><mi id="S3.p1.4.m4.2.2.1.1" xref="S3.p1.4.m4.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.4.m4.2.2.1.3.2" xref="S3.p1.4.m4.7.7.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.p1.4.m4.8.8.3.3.6" xref="S3.p1.4.m4.8.8.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.p1.4.m4.5.5" xref="S3.p1.4.m4.5.5.cmml">…</mi><mo id="S3.p1.4.m4.8.8.3.3.7" xref="S3.p1.4.m4.8.8.3.4.cmml">,</mo><msubsup id="S3.p1.4.m4.8.8.3.3.3" xref="S3.p1.4.m4.8.8.3.3.3.cmml"><mi id="S3.p1.4.m4.8.8.3.3.3.2.2" xref="S3.p1.4.m4.8.8.3.3.3.2.2.cmml">y</mi><msub id="S3.p1.4.m4.8.8.3.3.3.2.3" xref="S3.p1.4.m4.8.8.3.3.3.2.3.cmml"><mi id="S3.p1.4.m4.8.8.3.3.3.2.3.2" xref="S3.p1.4.m4.8.8.3.3.3.2.3.2.cmml">N</mi><mi id="S3.p1.4.m4.8.8.3.3.3.2.3.3" xref="S3.p1.4.m4.8.8.3.3.3.2.3.3.cmml">i</mi></msub><mrow id="S3.p1.4.m4.3.3.1.3" xref="S3.p1.4.m4.8.8.3.3.3.cmml"><mo stretchy="false" id="S3.p1.4.m4.3.3.1.3.1" xref="S3.p1.4.m4.8.8.3.3.3.cmml">(</mo><mi id="S3.p1.4.m4.3.3.1.1" xref="S3.p1.4.m4.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.4.m4.3.3.1.3.2" xref="S3.p1.4.m4.8.8.3.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p1.4.m4.8.8.3.3.8" xref="S3.p1.4.m4.8.8.3.4.cmml">}</mo></mrow><mo id="S3.p1.4.m4.8.8.4" xref="S3.p1.4.m4.8.8.4.cmml">∈</mo><msup id="S3.p1.4.m4.8.8.5" xref="S3.p1.4.m4.8.8.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m4.8.8.5.2" xref="S3.p1.4.m4.8.8.5.2.cmml">𝒴</mi><mrow id="S3.p1.4.m4.4.4.1.3" xref="S3.p1.4.m4.8.8.5.cmml"><mo stretchy="false" id="S3.p1.4.m4.4.4.1.3.1" xref="S3.p1.4.m4.8.8.5.cmml">(</mo><mi id="S3.p1.4.m4.4.4.1.1" xref="S3.p1.4.m4.4.4.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.4.m4.4.4.1.3.2" xref="S3.p1.4.m4.8.8.5.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.8b"><apply id="S3.p1.4.m4.8.8.cmml" xref="S3.p1.4.m4.8.8"><in id="S3.p1.4.m4.8.8.4.cmml" xref="S3.p1.4.m4.8.8.4"></in><set id="S3.p1.4.m4.8.8.3.4.cmml" xref="S3.p1.4.m4.8.8.3.3"><apply id="S3.p1.4.m4.6.6.1.1.1.cmml" xref="S3.p1.4.m4.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.6.6.1.1.1.1.cmml" xref="S3.p1.4.m4.6.6.1.1.1">superscript</csymbol><apply id="S3.p1.4.m4.6.6.1.1.1.2.cmml" xref="S3.p1.4.m4.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.6.6.1.1.1.2.1.cmml" xref="S3.p1.4.m4.6.6.1.1.1">subscript</csymbol><ci id="S3.p1.4.m4.6.6.1.1.1.2.2.cmml" xref="S3.p1.4.m4.6.6.1.1.1.2.2">𝑦</ci><cn type="integer" id="S3.p1.4.m4.6.6.1.1.1.2.3.cmml" xref="S3.p1.4.m4.6.6.1.1.1.2.3">1</cn></apply><ci id="S3.p1.4.m4.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1">𝑖</ci></apply><apply id="S3.p1.4.m4.7.7.2.2.2.cmml" xref="S3.p1.4.m4.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.7.7.2.2.2.1.cmml" xref="S3.p1.4.m4.7.7.2.2.2">superscript</csymbol><apply id="S3.p1.4.m4.7.7.2.2.2.2.cmml" xref="S3.p1.4.m4.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.7.7.2.2.2.2.1.cmml" xref="S3.p1.4.m4.7.7.2.2.2">subscript</csymbol><ci id="S3.p1.4.m4.7.7.2.2.2.2.2.cmml" xref="S3.p1.4.m4.7.7.2.2.2.2.2">𝑦</ci><cn type="integer" id="S3.p1.4.m4.7.7.2.2.2.2.3.cmml" xref="S3.p1.4.m4.7.7.2.2.2.2.3">2</cn></apply><ci id="S3.p1.4.m4.2.2.1.1.cmml" xref="S3.p1.4.m4.2.2.1.1">𝑖</ci></apply><ci id="S3.p1.4.m4.5.5.cmml" xref="S3.p1.4.m4.5.5">…</ci><apply id="S3.p1.4.m4.8.8.3.3.3.cmml" xref="S3.p1.4.m4.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.8.8.3.3.3.1.cmml" xref="S3.p1.4.m4.8.8.3.3.3">superscript</csymbol><apply id="S3.p1.4.m4.8.8.3.3.3.2.cmml" xref="S3.p1.4.m4.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.8.8.3.3.3.2.1.cmml" xref="S3.p1.4.m4.8.8.3.3.3">subscript</csymbol><ci id="S3.p1.4.m4.8.8.3.3.3.2.2.cmml" xref="S3.p1.4.m4.8.8.3.3.3.2.2">𝑦</ci><apply id="S3.p1.4.m4.8.8.3.3.3.2.3.cmml" xref="S3.p1.4.m4.8.8.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.8.8.3.3.3.2.3.1.cmml" xref="S3.p1.4.m4.8.8.3.3.3.2.3">subscript</csymbol><ci id="S3.p1.4.m4.8.8.3.3.3.2.3.2.cmml" xref="S3.p1.4.m4.8.8.3.3.3.2.3.2">𝑁</ci><ci id="S3.p1.4.m4.8.8.3.3.3.2.3.3.cmml" xref="S3.p1.4.m4.8.8.3.3.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.p1.4.m4.3.3.1.1.cmml" xref="S3.p1.4.m4.3.3.1.1">𝑖</ci></apply></set><apply id="S3.p1.4.m4.8.8.5.cmml" xref="S3.p1.4.m4.8.8.5"><csymbol cd="ambiguous" id="S3.p1.4.m4.8.8.5.1.cmml" xref="S3.p1.4.m4.8.8.5">superscript</csymbol><ci id="S3.p1.4.m4.8.8.5.2.cmml" xref="S3.p1.4.m4.8.8.5.2">𝒴</ci><ci id="S3.p1.4.m4.4.4.1.1.cmml" xref="S3.p1.4.m4.4.4.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.8c">\{y_{1}^{(i)},y_{2}^{(i)},...,y_{N_{i}}^{(i)}\}\in\mathcal{Y}^{(i)}</annotation></semantics></math> are their labels. The FL task is to find the optimal parameters <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\omega^{*}" display="inline"><semantics id="S3.p1.5.m5.1a"><msup id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">ω</mi><mo id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">superscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝜔</ci><times id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\omega^{*}</annotation></semantics></math> for a global model <math id="S3.p1.6.m6.2" class="ltx_Math" alttext="f(\mathbf{x};\omega)" display="inline"><semantics id="S3.p1.6.m6.2a"><mrow id="S3.p1.6.m6.2.3" xref="S3.p1.6.m6.2.3.cmml"><mi id="S3.p1.6.m6.2.3.2" xref="S3.p1.6.m6.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p1.6.m6.2.3.1" xref="S3.p1.6.m6.2.3.1.cmml">​</mo><mrow id="S3.p1.6.m6.2.3.3.2" xref="S3.p1.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S3.p1.6.m6.2.3.3.2.1" xref="S3.p1.6.m6.2.3.3.1.cmml">(</mo><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">𝐱</mi><mo id="S3.p1.6.m6.2.3.3.2.2" xref="S3.p1.6.m6.2.3.3.1.cmml">;</mo><mi id="S3.p1.6.m6.2.2" xref="S3.p1.6.m6.2.2.cmml">ω</mi><mo stretchy="false" id="S3.p1.6.m6.2.3.3.2.3" xref="S3.p1.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.2b"><apply id="S3.p1.6.m6.2.3.cmml" xref="S3.p1.6.m6.2.3"><times id="S3.p1.6.m6.2.3.1.cmml" xref="S3.p1.6.m6.2.3.1"></times><ci id="S3.p1.6.m6.2.3.2.cmml" xref="S3.p1.6.m6.2.3.2">𝑓</ci><list id="S3.p1.6.m6.2.3.3.1.cmml" xref="S3.p1.6.m6.2.3.3.2"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝐱</ci><ci id="S3.p1.6.m6.2.2.cmml" xref="S3.p1.6.m6.2.2">𝜔</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.2c">f(\mathbf{x};\omega)</annotation></semantics></math> by minimising the total loss of all clients as the following optimization problem:</p>
</div>
<div id="S3.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\omega^{*}=\arg\min_{\omega}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(\omega)" display="inline"><semantics id="S3.E1X.2.1.1.m1.1a"><mrow id="S3.E1X.2.1.1.m1.1.2" xref="S3.E1X.2.1.1.m1.1.2.cmml"><msup id="S3.E1X.2.1.1.m1.1.2.2" xref="S3.E1X.2.1.1.m1.1.2.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.2.2.2" xref="S3.E1X.2.1.1.m1.1.2.2.2.cmml">ω</mi><mo id="S3.E1X.2.1.1.m1.1.2.2.3" xref="S3.E1X.2.1.1.m1.1.2.2.3.cmml">∗</mo></msup><mo id="S3.E1X.2.1.1.m1.1.2.1" xref="S3.E1X.2.1.1.m1.1.2.1.cmml">=</mo><mrow id="S3.E1X.2.1.1.m1.1.2.3" xref="S3.E1X.2.1.1.m1.1.2.3.cmml"><mrow id="S3.E1X.2.1.1.m1.1.2.3.2" xref="S3.E1X.2.1.1.m1.1.2.3.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.2.3.2.1" xref="S3.E1X.2.1.1.m1.1.2.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1X.2.1.1.m1.1.2.3.2a" xref="S3.E1X.2.1.1.m1.1.2.3.2.cmml">⁡</mo><munder id="S3.E1X.2.1.1.m1.1.2.3.2.2" xref="S3.E1X.2.1.1.m1.1.2.3.2.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.2.3.2.2.2" xref="S3.E1X.2.1.1.m1.1.2.3.2.2.2.cmml">min</mi><mi id="S3.E1X.2.1.1.m1.1.2.3.2.2.3" xref="S3.E1X.2.1.1.m1.1.2.3.2.2.3.cmml">ω</mi></munder></mrow><mo lspace="0.167em" rspace="0em" id="S3.E1X.2.1.1.m1.1.2.3.1" xref="S3.E1X.2.1.1.m1.1.2.3.1.cmml">​</mo><mrow id="S3.E1X.2.1.1.m1.1.2.3.3" xref="S3.E1X.2.1.1.m1.1.2.3.3.cmml"><mstyle displaystyle="true" id="S3.E1X.2.1.1.m1.1.2.3.3.1" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.cmml"><munderover id="S3.E1X.2.1.1.m1.1.2.3.3.1a" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.cmml"><mi id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.1" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.3" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1X.2.1.1.m1.1.2.3.3.1.3" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E1X.2.1.1.m1.1.2.3.3.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.cmml"><msub id="S3.E1X.2.1.1.m1.1.2.3.3.2.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.2.cmml"><mi id="S3.E1X.2.1.1.m1.1.2.3.3.2.2.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.2.2.cmml">α</mi><mi id="S3.E1X.2.1.1.m1.1.2.3.3.2.2.3" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.1.2.3.3.2.1" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.1.cmml">​</mo><msub id="S3.E1X.2.1.1.m1.1.2.3.3.2.3" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1X.2.1.1.m1.1.2.3.3.2.3.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.3.2.cmml">ℒ</mi><mi id="S3.E1X.2.1.1.m1.1.2.3.3.2.3.3" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1X.2.1.1.m1.1.2.3.3.2.1a" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.1.cmml">​</mo><mrow id="S3.E1X.2.1.1.m1.1.2.3.3.2.4.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.cmml"><mo stretchy="false" id="S3.E1X.2.1.1.m1.1.2.3.3.2.4.2.1" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.cmml">(</mo><mi id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml">ω</mi><mo stretchy="false" id="S3.E1X.2.1.1.m1.1.2.3.3.2.4.2.2" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.1b"><apply id="S3.E1X.2.1.1.m1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.2"><eq id="S3.E1X.2.1.1.m1.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.1"></eq><apply id="S3.E1X.2.1.1.m1.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.2.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.2">superscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.2.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.2.2">𝜔</ci><times id="S3.E1X.2.1.1.m1.1.2.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.2.3"></times></apply><apply id="S3.E1X.2.1.1.m1.1.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3"><times id="S3.E1X.2.1.1.m1.1.2.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.1"></times><apply id="S3.E1X.2.1.1.m1.1.2.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.2"><arg id="S3.E1X.2.1.1.m1.1.2.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.2.1"></arg><apply id="S3.E1X.2.1.1.m1.1.2.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.2.3.2.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.2.2">subscript</csymbol><min id="S3.E1X.2.1.1.m1.1.2.3.2.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.2.2.2"></min><ci id="S3.E1X.2.1.1.m1.1.2.3.2.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.2.2.3">𝜔</ci></apply></apply><apply id="S3.E1X.2.1.1.m1.1.2.3.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3"><apply id="S3.E1X.2.1.1.m1.1.2.3.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.2.3.3.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1">superscript</csymbol><apply id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1">subscript</csymbol><sum id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.2"></sum><apply id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3"><eq id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.1"></eq><ci id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1X.2.1.1.m1.1.2.3.3.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.1.3">𝐾</ci></apply><apply id="S3.E1X.2.1.1.m1.1.2.3.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2"><times id="S3.E1X.2.1.1.m1.1.2.3.3.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.1"></times><apply id="S3.E1X.2.1.1.m1.1.2.3.3.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.2.3.3.2.2.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.2">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.2.3.3.2.2.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.2.2">𝛼</ci><ci id="S3.E1X.2.1.1.m1.1.2.3.3.2.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E1X.2.1.1.m1.1.2.3.3.2.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.E1X.2.1.1.m1.1.2.3.3.2.3.1.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.3">subscript</csymbol><ci id="S3.E1X.2.1.1.m1.1.2.3.3.2.3.2.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.3.2">ℒ</ci><ci id="S3.E1X.2.1.1.m1.1.2.3.3.2.3.3.cmml" xref="S3.E1X.2.1.1.m1.1.2.3.3.2.3.3">𝑖</ci></apply><ci id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1">𝜔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.1c">\displaystyle\omega^{*}=\arg\min_{\omega}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(\omega)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.8" class="ltx_p">where <math id="S3.p3.1.m1.7" class="ltx_Math" alttext="\mathcal{L}_{i}(\omega)=(1/N_{i})\sum_{j=1}^{N_{i}}l(f(\mathbf{x}_{j}^{(i)};\omega),y_{j}^{(i)})" display="inline"><semantics id="S3.p3.1.m1.7a"><mrow id="S3.p3.1.m1.7.7" xref="S3.p3.1.m1.7.7.cmml"><mrow id="S3.p3.1.m1.7.7.5" xref="S3.p3.1.m1.7.7.5.cmml"><msub id="S3.p3.1.m1.7.7.5.2" xref="S3.p3.1.m1.7.7.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.7.7.5.2.2" xref="S3.p3.1.m1.7.7.5.2.2.cmml">ℒ</mi><mi id="S3.p3.1.m1.7.7.5.2.3" xref="S3.p3.1.m1.7.7.5.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.7.7.5.1" xref="S3.p3.1.m1.7.7.5.1.cmml">​</mo><mrow id="S3.p3.1.m1.7.7.5.3.2" xref="S3.p3.1.m1.7.7.5.cmml"><mo stretchy="false" id="S3.p3.1.m1.7.7.5.3.2.1" xref="S3.p3.1.m1.7.7.5.cmml">(</mo><mi id="S3.p3.1.m1.3.3" xref="S3.p3.1.m1.3.3.cmml">ω</mi><mo stretchy="false" id="S3.p3.1.m1.7.7.5.3.2.2" xref="S3.p3.1.m1.7.7.5.cmml">)</mo></mrow></mrow><mo id="S3.p3.1.m1.7.7.4" xref="S3.p3.1.m1.7.7.4.cmml">=</mo><mrow id="S3.p3.1.m1.7.7.3" xref="S3.p3.1.m1.7.7.3.cmml"><mrow id="S3.p3.1.m1.5.5.1.1.1" xref="S3.p3.1.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.1.m1.5.5.1.1.1.2" xref="S3.p3.1.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.p3.1.m1.5.5.1.1.1.1" xref="S3.p3.1.m1.5.5.1.1.1.1.cmml"><mn id="S3.p3.1.m1.5.5.1.1.1.1.2" xref="S3.p3.1.m1.5.5.1.1.1.1.2.cmml">1</mn><mo id="S3.p3.1.m1.5.5.1.1.1.1.1" xref="S3.p3.1.m1.5.5.1.1.1.1.1.cmml">/</mo><msub id="S3.p3.1.m1.5.5.1.1.1.1.3" xref="S3.p3.1.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.p3.1.m1.5.5.1.1.1.1.3.2" xref="S3.p3.1.m1.5.5.1.1.1.1.3.2.cmml">N</mi><mi id="S3.p3.1.m1.5.5.1.1.1.1.3.3" xref="S3.p3.1.m1.5.5.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.p3.1.m1.5.5.1.1.1.3" xref="S3.p3.1.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.7.7.3.4" xref="S3.p3.1.m1.7.7.3.4.cmml">​</mo><mrow id="S3.p3.1.m1.7.7.3.3" xref="S3.p3.1.m1.7.7.3.3.cmml"><msubsup id="S3.p3.1.m1.7.7.3.3.3" xref="S3.p3.1.m1.7.7.3.3.3.cmml"><mo id="S3.p3.1.m1.7.7.3.3.3.2.2" xref="S3.p3.1.m1.7.7.3.3.3.2.2.cmml">∑</mo><mrow id="S3.p3.1.m1.7.7.3.3.3.2.3" xref="S3.p3.1.m1.7.7.3.3.3.2.3.cmml"><mi id="S3.p3.1.m1.7.7.3.3.3.2.3.2" xref="S3.p3.1.m1.7.7.3.3.3.2.3.2.cmml">j</mi><mo id="S3.p3.1.m1.7.7.3.3.3.2.3.1" xref="S3.p3.1.m1.7.7.3.3.3.2.3.1.cmml">=</mo><mn id="S3.p3.1.m1.7.7.3.3.3.2.3.3" xref="S3.p3.1.m1.7.7.3.3.3.2.3.3.cmml">1</mn></mrow><msub id="S3.p3.1.m1.7.7.3.3.3.3" xref="S3.p3.1.m1.7.7.3.3.3.3.cmml"><mi id="S3.p3.1.m1.7.7.3.3.3.3.2" xref="S3.p3.1.m1.7.7.3.3.3.3.2.cmml">N</mi><mi id="S3.p3.1.m1.7.7.3.3.3.3.3" xref="S3.p3.1.m1.7.7.3.3.3.3.3.cmml">i</mi></msub></msubsup><mrow id="S3.p3.1.m1.7.7.3.3.2" xref="S3.p3.1.m1.7.7.3.3.2.cmml"><mi id="S3.p3.1.m1.7.7.3.3.2.4" xref="S3.p3.1.m1.7.7.3.3.2.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.7.7.3.3.2.3" xref="S3.p3.1.m1.7.7.3.3.2.3.cmml">​</mo><mrow id="S3.p3.1.m1.7.7.3.3.2.2.2" xref="S3.p3.1.m1.7.7.3.3.2.2.3.cmml"><mo stretchy="false" id="S3.p3.1.m1.7.7.3.3.2.2.2.3" xref="S3.p3.1.m1.7.7.3.3.2.2.3.cmml">(</mo><mrow id="S3.p3.1.m1.6.6.2.2.1.1.1.1" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.cmml"><mi id="S3.p3.1.m1.6.6.2.2.1.1.1.1.3" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p3.1.m1.6.6.2.2.1.1.1.1.2" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.2" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.2.cmml">(</mo><msubsup id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.3" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.p3.1.m1.1.1.1.3" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.1.m1.1.1.1.3.1" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.p3.1.m1.1.1.1.1" xref="S3.p3.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p3.1.m1.1.1.1.3.2" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.3" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="S3.p3.1.m1.4.4" xref="S3.p3.1.m1.4.4.cmml">ω</mi><mo stretchy="false" id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.4" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.p3.1.m1.7.7.3.3.2.2.2.4" xref="S3.p3.1.m1.7.7.3.3.2.2.3.cmml">,</mo><msubsup id="S3.p3.1.m1.7.7.3.3.2.2.2.2" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.cmml"><mi id="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.2" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.3" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.3.cmml">j</mi><mrow id="S3.p3.1.m1.2.2.1.3" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.cmml"><mo stretchy="false" id="S3.p3.1.m1.2.2.1.3.1" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.cmml">(</mo><mi id="S3.p3.1.m1.2.2.1.1" xref="S3.p3.1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.p3.1.m1.2.2.1.3.2" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p3.1.m1.7.7.3.3.2.2.2.5" xref="S3.p3.1.m1.7.7.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.7b"><apply id="S3.p3.1.m1.7.7.cmml" xref="S3.p3.1.m1.7.7"><eq id="S3.p3.1.m1.7.7.4.cmml" xref="S3.p3.1.m1.7.7.4"></eq><apply id="S3.p3.1.m1.7.7.5.cmml" xref="S3.p3.1.m1.7.7.5"><times id="S3.p3.1.m1.7.7.5.1.cmml" xref="S3.p3.1.m1.7.7.5.1"></times><apply id="S3.p3.1.m1.7.7.5.2.cmml" xref="S3.p3.1.m1.7.7.5.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.7.7.5.2.1.cmml" xref="S3.p3.1.m1.7.7.5.2">subscript</csymbol><ci id="S3.p3.1.m1.7.7.5.2.2.cmml" xref="S3.p3.1.m1.7.7.5.2.2">ℒ</ci><ci id="S3.p3.1.m1.7.7.5.2.3.cmml" xref="S3.p3.1.m1.7.7.5.2.3">𝑖</ci></apply><ci id="S3.p3.1.m1.3.3.cmml" xref="S3.p3.1.m1.3.3">𝜔</ci></apply><apply id="S3.p3.1.m1.7.7.3.cmml" xref="S3.p3.1.m1.7.7.3"><times id="S3.p3.1.m1.7.7.3.4.cmml" xref="S3.p3.1.m1.7.7.3.4"></times><apply id="S3.p3.1.m1.5.5.1.1.1.1.cmml" xref="S3.p3.1.m1.5.5.1.1.1"><divide id="S3.p3.1.m1.5.5.1.1.1.1.1.cmml" xref="S3.p3.1.m1.5.5.1.1.1.1.1"></divide><cn type="integer" id="S3.p3.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.p3.1.m1.5.5.1.1.1.1.2">1</cn><apply id="S3.p3.1.m1.5.5.1.1.1.1.3.cmml" xref="S3.p3.1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.p3.1.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.p3.1.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.p3.1.m1.5.5.1.1.1.1.3.2">𝑁</ci><ci id="S3.p3.1.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.p3.1.m1.5.5.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.p3.1.m1.7.7.3.3.cmml" xref="S3.p3.1.m1.7.7.3.3"><apply id="S3.p3.1.m1.7.7.3.3.3.cmml" xref="S3.p3.1.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.7.7.3.3.3.1.cmml" xref="S3.p3.1.m1.7.7.3.3.3">superscript</csymbol><apply id="S3.p3.1.m1.7.7.3.3.3.2.cmml" xref="S3.p3.1.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.7.7.3.3.3.2.1.cmml" xref="S3.p3.1.m1.7.7.3.3.3">subscript</csymbol><sum id="S3.p3.1.m1.7.7.3.3.3.2.2.cmml" xref="S3.p3.1.m1.7.7.3.3.3.2.2"></sum><apply id="S3.p3.1.m1.7.7.3.3.3.2.3.cmml" xref="S3.p3.1.m1.7.7.3.3.3.2.3"><eq id="S3.p3.1.m1.7.7.3.3.3.2.3.1.cmml" xref="S3.p3.1.m1.7.7.3.3.3.2.3.1"></eq><ci id="S3.p3.1.m1.7.7.3.3.3.2.3.2.cmml" xref="S3.p3.1.m1.7.7.3.3.3.2.3.2">𝑗</ci><cn type="integer" id="S3.p3.1.m1.7.7.3.3.3.2.3.3.cmml" xref="S3.p3.1.m1.7.7.3.3.3.2.3.3">1</cn></apply></apply><apply id="S3.p3.1.m1.7.7.3.3.3.3.cmml" xref="S3.p3.1.m1.7.7.3.3.3.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.7.7.3.3.3.3.1.cmml" xref="S3.p3.1.m1.7.7.3.3.3.3">subscript</csymbol><ci id="S3.p3.1.m1.7.7.3.3.3.3.2.cmml" xref="S3.p3.1.m1.7.7.3.3.3.3.2">𝑁</ci><ci id="S3.p3.1.m1.7.7.3.3.3.3.3.cmml" xref="S3.p3.1.m1.7.7.3.3.3.3.3">𝑖</ci></apply></apply><apply id="S3.p3.1.m1.7.7.3.3.2.cmml" xref="S3.p3.1.m1.7.7.3.3.2"><times id="S3.p3.1.m1.7.7.3.3.2.3.cmml" xref="S3.p3.1.m1.7.7.3.3.2.3"></times><ci id="S3.p3.1.m1.7.7.3.3.2.4.cmml" xref="S3.p3.1.m1.7.7.3.3.2.4">𝑙</ci><interval closure="open" id="S3.p3.1.m1.7.7.3.3.2.2.3.cmml" xref="S3.p3.1.m1.7.7.3.3.2.2.2"><apply id="S3.p3.1.m1.6.6.2.2.1.1.1.1.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1"><times id="S3.p3.1.m1.6.6.2.2.1.1.1.1.2.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.2"></times><ci id="S3.p3.1.m1.6.6.2.2.1.1.1.1.3.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.3">𝑓</ci><list id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.2.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1"><apply id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p3.1.m1.6.6.2.2.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.p3.1.m1.1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.p3.1.m1.4.4.cmml" xref="S3.p3.1.m1.4.4">𝜔</ci></list></apply><apply id="S3.p3.1.m1.7.7.3.3.2.2.2.2.cmml" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.7.7.3.3.2.2.2.2.1.cmml" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2">superscript</csymbol><apply id="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.cmml" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.1.cmml" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2">subscript</csymbol><ci id="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.2.cmml" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.3.cmml" xref="S3.p3.1.m1.7.7.3.3.2.2.2.2.2.3">𝑗</ci></apply><ci id="S3.p3.1.m1.2.2.1.1.cmml" xref="S3.p3.1.m1.2.2.1.1">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.7c">\mathcal{L}_{i}(\omega)=(1/N_{i})\sum_{j=1}^{N_{i}}l(f(\mathbf{x}_{j}^{(i)};\omega),y_{j}^{(i)})</annotation></semantics></math> is the supervised loss on the <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">i</annotation></semantics></math>-th client, and <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">α</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝛼</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\alpha_{i}</annotation></semantics></math> is its weight. In particular, in the standard FL framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S3.p3.4.m4.1a"><msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">α</mi><mi id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝛼</ci><ci id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">\alpha_{i}</annotation></semantics></math> is the fraction of the size of the client’s training data, i.e., <math id="S3.p3.5.m5.1" class="ltx_Math" alttext="\alpha_{i}=N_{i}/\sum_{i^{\prime}=1}^{K}N_{i^{\prime}}" display="inline"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><msub id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml"><mi id="S3.p3.5.m5.1.1.2.2" xref="S3.p3.5.m5.1.1.2.2.cmml">α</mi><mi id="S3.p3.5.m5.1.1.2.3" xref="S3.p3.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S3.p3.5.m5.1.1.1" xref="S3.p3.5.m5.1.1.1.cmml">=</mo><mrow id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml"><msub id="S3.p3.5.m5.1.1.3.2" xref="S3.p3.5.m5.1.1.3.2.cmml"><mi id="S3.p3.5.m5.1.1.3.2.2" xref="S3.p3.5.m5.1.1.3.2.2.cmml">N</mi><mi id="S3.p3.5.m5.1.1.3.2.3" xref="S3.p3.5.m5.1.1.3.2.3.cmml">i</mi></msub><mo rspace="0.055em" id="S3.p3.5.m5.1.1.3.1" xref="S3.p3.5.m5.1.1.3.1.cmml">/</mo><mrow id="S3.p3.5.m5.1.1.3.3" xref="S3.p3.5.m5.1.1.3.3.cmml"><msubsup id="S3.p3.5.m5.1.1.3.3.1" xref="S3.p3.5.m5.1.1.3.3.1.cmml"><mo id="S3.p3.5.m5.1.1.3.3.1.2.2" xref="S3.p3.5.m5.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.p3.5.m5.1.1.3.3.1.2.3" xref="S3.p3.5.m5.1.1.3.3.1.2.3.cmml"><msup id="S3.p3.5.m5.1.1.3.3.1.2.3.2" xref="S3.p3.5.m5.1.1.3.3.1.2.3.2.cmml"><mi id="S3.p3.5.m5.1.1.3.3.1.2.3.2.2" xref="S3.p3.5.m5.1.1.3.3.1.2.3.2.2.cmml">i</mi><mo id="S3.p3.5.m5.1.1.3.3.1.2.3.2.3" xref="S3.p3.5.m5.1.1.3.3.1.2.3.2.3.cmml">′</mo></msup><mo id="S3.p3.5.m5.1.1.3.3.1.2.3.1" xref="S3.p3.5.m5.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.p3.5.m5.1.1.3.3.1.2.3.3" xref="S3.p3.5.m5.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.p3.5.m5.1.1.3.3.1.3" xref="S3.p3.5.m5.1.1.3.3.1.3.cmml">K</mi></msubsup><msub id="S3.p3.5.m5.1.1.3.3.2" xref="S3.p3.5.m5.1.1.3.3.2.cmml"><mi id="S3.p3.5.m5.1.1.3.3.2.2" xref="S3.p3.5.m5.1.1.3.3.2.2.cmml">N</mi><msup id="S3.p3.5.m5.1.1.3.3.2.3" xref="S3.p3.5.m5.1.1.3.3.2.3.cmml"><mi id="S3.p3.5.m5.1.1.3.3.2.3.2" xref="S3.p3.5.m5.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.p3.5.m5.1.1.3.3.2.3.3" xref="S3.p3.5.m5.1.1.3.3.2.3.3.cmml">′</mo></msup></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><eq id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1"></eq><apply id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.2.1.cmml" xref="S3.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.p3.5.m5.1.1.2.2.cmml" xref="S3.p3.5.m5.1.1.2.2">𝛼</ci><ci id="S3.p3.5.m5.1.1.2.3.cmml" xref="S3.p3.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3"><divide id="S3.p3.5.m5.1.1.3.1.cmml" xref="S3.p3.5.m5.1.1.3.1"></divide><apply id="S3.p3.5.m5.1.1.3.2.cmml" xref="S3.p3.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.3.2.1.cmml" xref="S3.p3.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.p3.5.m5.1.1.3.2.2.cmml" xref="S3.p3.5.m5.1.1.3.2.2">𝑁</ci><ci id="S3.p3.5.m5.1.1.3.2.3.cmml" xref="S3.p3.5.m5.1.1.3.2.3">𝑖</ci></apply><apply id="S3.p3.5.m5.1.1.3.3.cmml" xref="S3.p3.5.m5.1.1.3.3"><apply id="S3.p3.5.m5.1.1.3.3.1.cmml" xref="S3.p3.5.m5.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.3.3.1.1.cmml" xref="S3.p3.5.m5.1.1.3.3.1">superscript</csymbol><apply id="S3.p3.5.m5.1.1.3.3.1.2.cmml" xref="S3.p3.5.m5.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.3.3.1.2.1.cmml" xref="S3.p3.5.m5.1.1.3.3.1">subscript</csymbol><sum id="S3.p3.5.m5.1.1.3.3.1.2.2.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.2"></sum><apply id="S3.p3.5.m5.1.1.3.3.1.2.3.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.3"><eq id="S3.p3.5.m5.1.1.3.3.1.2.3.1.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.3.1"></eq><apply id="S3.p3.5.m5.1.1.3.3.1.2.3.2.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.3.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.3.3.1.2.3.2.1.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.3.2">superscript</csymbol><ci id="S3.p3.5.m5.1.1.3.3.1.2.3.2.2.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.3.2.2">𝑖</ci><ci id="S3.p3.5.m5.1.1.3.3.1.2.3.2.3.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.3.2.3">′</ci></apply><cn type="integer" id="S3.p3.5.m5.1.1.3.3.1.2.3.3.cmml" xref="S3.p3.5.m5.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.p3.5.m5.1.1.3.3.1.3.cmml" xref="S3.p3.5.m5.1.1.3.3.1.3">𝐾</ci></apply><apply id="S3.p3.5.m5.1.1.3.3.2.cmml" xref="S3.p3.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.3.3.2.1.cmml" xref="S3.p3.5.m5.1.1.3.3.2">subscript</csymbol><ci id="S3.p3.5.m5.1.1.3.3.2.2.cmml" xref="S3.p3.5.m5.1.1.3.3.2.2">𝑁</ci><apply id="S3.p3.5.m5.1.1.3.3.2.3.cmml" xref="S3.p3.5.m5.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.3.3.2.3.1.cmml" xref="S3.p3.5.m5.1.1.3.3.2.3">superscript</csymbol><ci id="S3.p3.5.m5.1.1.3.3.2.3.2.cmml" xref="S3.p3.5.m5.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.p3.5.m5.1.1.3.3.2.3.3.cmml" xref="S3.p3.5.m5.1.1.3.3.2.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">\alpha_{i}=N_{i}/\sum_{i^{\prime}=1}^{K}N_{i^{\prime}}</annotation></semantics></math>. Each client will update <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p3.6.m6.1a"><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\omega</annotation></semantics></math> privately by minimizing <math id="S3.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{L}_{i}(\omega)" display="inline"><semantics id="S3.p3.7.m7.1a"><mrow id="S3.p3.7.m7.1.2" xref="S3.p3.7.m7.1.2.cmml"><msub id="S3.p3.7.m7.1.2.2" xref="S3.p3.7.m7.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.7.m7.1.2.2.2" xref="S3.p3.7.m7.1.2.2.2.cmml">ℒ</mi><mi id="S3.p3.7.m7.1.2.2.3" xref="S3.p3.7.m7.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p3.7.m7.1.2.1" xref="S3.p3.7.m7.1.2.1.cmml">​</mo><mrow id="S3.p3.7.m7.1.2.3.2" xref="S3.p3.7.m7.1.2.cmml"><mo stretchy="false" id="S3.p3.7.m7.1.2.3.2.1" xref="S3.p3.7.m7.1.2.cmml">(</mo><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">ω</mi><mo stretchy="false" id="S3.p3.7.m7.1.2.3.2.2" xref="S3.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.2.cmml" xref="S3.p3.7.m7.1.2"><times id="S3.p3.7.m7.1.2.1.cmml" xref="S3.p3.7.m7.1.2.1"></times><apply id="S3.p3.7.m7.1.2.2.cmml" xref="S3.p3.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.2.2.1.cmml" xref="S3.p3.7.m7.1.2.2">subscript</csymbol><ci id="S3.p3.7.m7.1.2.2.2.cmml" xref="S3.p3.7.m7.1.2.2.2">ℒ</ci><ci id="S3.p3.7.m7.1.2.2.3.cmml" xref="S3.p3.7.m7.1.2.2.3">𝑖</ci></apply><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">\mathcal{L}_{i}(\omega)</annotation></semantics></math>, and a server will orchestrate the distributed training process by collecting locally updated <math id="S3.p3.8.m8.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p3.8.m8.1a"><mi id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><ci id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">\omega</annotation></semantics></math> and synchronizing the averaged one.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.4" class="ltx_p"><span id="S3.p4.4.1" class="ltx_text ltx_font_bold">Personalized Federated Learning (PerFL)</span> leverages cross-client collaboration but learns a personalized model <math id="S3.p4.1.m1.3" class="ltx_Math" alttext="f(\mathbf{x};\omega,\mu_{i})" display="inline"><semantics id="S3.p4.1.m1.3a"><mrow id="S3.p4.1.m1.3.3" xref="S3.p4.1.m1.3.3.cmml"><mi id="S3.p4.1.m1.3.3.3" xref="S3.p4.1.m1.3.3.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.3.3.2" xref="S3.p4.1.m1.3.3.2.cmml">​</mo><mrow id="S3.p4.1.m1.3.3.1.1" xref="S3.p4.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.p4.1.m1.3.3.1.1.2" xref="S3.p4.1.m1.3.3.1.2.cmml">(</mo><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">𝐱</mi><mo id="S3.p4.1.m1.3.3.1.1.3" xref="S3.p4.1.m1.3.3.1.2.cmml">;</mo><mi id="S3.p4.1.m1.2.2" xref="S3.p4.1.m1.2.2.cmml">ω</mi><mo id="S3.p4.1.m1.3.3.1.1.4" xref="S3.p4.1.m1.3.3.1.2.cmml">,</mo><msub id="S3.p4.1.m1.3.3.1.1.1" xref="S3.p4.1.m1.3.3.1.1.1.cmml"><mi id="S3.p4.1.m1.3.3.1.1.1.2" xref="S3.p4.1.m1.3.3.1.1.1.2.cmml">μ</mi><mi id="S3.p4.1.m1.3.3.1.1.1.3" xref="S3.p4.1.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p4.1.m1.3.3.1.1.5" xref="S3.p4.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.3b"><apply id="S3.p4.1.m1.3.3.cmml" xref="S3.p4.1.m1.3.3"><times id="S3.p4.1.m1.3.3.2.cmml" xref="S3.p4.1.m1.3.3.2"></times><ci id="S3.p4.1.m1.3.3.3.cmml" xref="S3.p4.1.m1.3.3.3">𝑓</ci><list id="S3.p4.1.m1.3.3.1.2.cmml" xref="S3.p4.1.m1.3.3.1.1"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝐱</ci><ci id="S3.p4.1.m1.2.2.cmml" xref="S3.p4.1.m1.2.2">𝜔</ci><apply id="S3.p4.1.m1.3.3.1.1.1.cmml" xref="S3.p4.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.3.3.1.1.1.1.cmml" xref="S3.p4.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.3.3.1.1.1.2.cmml" xref="S3.p4.1.m1.3.3.1.1.1.2">𝜇</ci><ci id="S3.p4.1.m1.3.3.1.1.1.3.cmml" xref="S3.p4.1.m1.3.3.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.3c">f(\mathbf{x};\omega,\mu_{i})</annotation></semantics></math> for each client, where <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p4.2.m2.1a"><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\omega</annotation></semantics></math> denotes parameters shared, and <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.p4.3.m3.1a"><msub id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">μ</mi><mi id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝜇</ci><ci id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\mu_{i}</annotation></semantics></math> denotes parameters for the <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.4.m4.1a"><mi id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><ci id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">i</annotation></semantics></math>-th client. The learning task can be formulated into a unified optimization problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>:</p>
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle\omega^{*},\{\mu_{i}^{*}\}_{i=1}^{K}=\arg\min_{\omega,\{\mu_{i}\}_{i=1}^{K}}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(\omega,\mu_{i})" display="inline"><semantics id="S3.E2X.2.1.1.m1.6a"><mrow id="S3.E2X.2.1.1.m1.6.6" xref="S3.E2X.2.1.1.m1.6.6.cmml"><mrow id="S3.E2X.2.1.1.m1.5.5.2.2" xref="S3.E2X.2.1.1.m1.5.5.2.3.cmml"><msup id="S3.E2X.2.1.1.m1.4.4.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.2.cmml">ω</mi><mo id="S3.E2X.2.1.1.m1.4.4.1.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E2X.2.1.1.m1.5.5.2.2.3" xref="S3.E2X.2.1.1.m1.5.5.2.3.cmml">,</mo><msubsup id="S3.E2X.2.1.1.m1.5.5.2.2.2" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.cmml"><mrow id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.2" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.2.cmml">{</mo><msubsup id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.2" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.2.cmml">μ</mi><mi id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.3" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.3.cmml">i</mi><mo id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.3.cmml">∗</mo></msubsup><mo stretchy="false" id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.3" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.cmml"><mi id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.2" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.2.cmml">i</mi><mo id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.1" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.1.cmml">=</mo><mn id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.3" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.3.cmml">1</mn></mrow><mi id="S3.E2X.2.1.1.m1.5.5.2.2.2.3" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.3.cmml">K</mi></msubsup></mrow><mo id="S3.E2X.2.1.1.m1.6.6.4" xref="S3.E2X.2.1.1.m1.6.6.4.cmml">=</mo><mrow id="S3.E2X.2.1.1.m1.6.6.3" xref="S3.E2X.2.1.1.m1.6.6.3.cmml"><mrow id="S3.E2X.2.1.1.m1.6.6.3.3" xref="S3.E2X.2.1.1.m1.6.6.3.3.cmml"><mi id="S3.E2X.2.1.1.m1.6.6.3.3.1" xref="S3.E2X.2.1.1.m1.6.6.3.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E2X.2.1.1.m1.6.6.3.3a" xref="S3.E2X.2.1.1.m1.6.6.3.3.cmml">⁡</mo><munder id="S3.E2X.2.1.1.m1.6.6.3.3.2" xref="S3.E2X.2.1.1.m1.6.6.3.3.2.cmml"><mi id="S3.E2X.2.1.1.m1.6.6.3.3.2.2" xref="S3.E2X.2.1.1.m1.6.6.3.3.2.2.cmml">min</mi><mrow id="S3.E2X.2.1.1.m1.2.2.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.3.cmml"><mi id="S3.E2X.2.1.1.m1.1.1.1.1" xref="S3.E2X.2.1.1.m1.1.1.1.1.cmml">ω</mi><mo id="S3.E2X.2.1.1.m1.2.2.2.2.2" xref="S3.E2X.2.1.1.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.E2X.2.1.1.m1.2.2.2.2.1" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.cmml"><mrow id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">{</mo><msub id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.2" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.1" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.1.cmml">=</mo><mn id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E2X.2.1.1.m1.2.2.2.2.1.3" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.3.cmml">K</mi></msubsup></mrow></munder></mrow><mo lspace="0.167em" rspace="0em" id="S3.E2X.2.1.1.m1.6.6.3.2" xref="S3.E2X.2.1.1.m1.6.6.3.2.cmml">​</mo><mrow id="S3.E2X.2.1.1.m1.6.6.3.1" xref="S3.E2X.2.1.1.m1.6.6.3.1.cmml"><mstyle displaystyle="true" id="S3.E2X.2.1.1.m1.6.6.3.1.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.cmml"><munderover id="S3.E2X.2.1.1.m1.6.6.3.1.2a" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.cmml"><mo movablelimits="false" id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.cmml"><mi id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.2.cmml">i</mi><mo id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.1" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2X.2.1.1.m1.6.6.3.1.2.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E2X.2.1.1.m1.6.6.3.1.1" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.cmml"><msub id="S3.E2X.2.1.1.m1.6.6.3.1.1.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.3.cmml"><mi id="S3.E2X.2.1.1.m1.6.6.3.1.1.3.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.3.2.cmml">α</mi><mi id="S3.E2X.2.1.1.m1.6.6.3.1.1.3.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.6.6.3.1.1.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.2.cmml">​</mo><msub id="S3.E2X.2.1.1.m1.6.6.3.1.1.4" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.6.6.3.1.1.4.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.4.2.cmml">ℒ</mi><mi id="S3.E2X.2.1.1.m1.6.6.3.1.1.4.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.6.6.3.1.1.2a" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.2.cmml">​</mo><mrow id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.2.cmml">(</mo><mi id="S3.E2X.2.1.1.m1.3.3" xref="S3.E2X.2.1.1.m1.3.3.cmml">ω</mi><mo id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.2.cmml">,</mo><msub id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.2" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.3" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.4" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.6b"><apply id="S3.E2X.2.1.1.m1.6.6.cmml" xref="S3.E2X.2.1.1.m1.6.6"><eq id="S3.E2X.2.1.1.m1.6.6.4.cmml" xref="S3.E2X.2.1.1.m1.6.6.4"></eq><list id="S3.E2X.2.1.1.m1.5.5.2.3.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2"><apply id="S3.E2X.2.1.1.m1.4.4.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1">superscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.2">𝜔</ci><times id="S3.E2X.2.1.1.m1.4.4.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.1.1.1.3"></times></apply><apply id="S3.E2X.2.1.1.m1.5.5.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.5.5.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2">subscript</csymbol><set id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1"><apply id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.2">𝜇</ci><ci id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><times id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.1.1.1.3"></times></apply></set><apply id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3"><eq id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.1"></eq><ci id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.2">𝑖</ci><cn type="integer" id="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.1.3.3">1</cn></apply></apply><ci id="S3.E2X.2.1.1.m1.5.5.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.5.5.2.2.2.3">𝐾</ci></apply></list><apply id="S3.E2X.2.1.1.m1.6.6.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3"><times id="S3.E2X.2.1.1.m1.6.6.3.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.2"></times><apply id="S3.E2X.2.1.1.m1.6.6.3.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.3"><arg id="S3.E2X.2.1.1.m1.6.6.3.3.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.3.1"></arg><apply id="S3.E2X.2.1.1.m1.6.6.3.3.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.3.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.6.6.3.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.3.2">subscript</csymbol><min id="S3.E2X.2.1.1.m1.6.6.3.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.3.2.2"></min><list id="S3.E2X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2"><ci id="S3.E2X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1.1.1">𝜔</ci><apply id="S3.E2X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1">subscript</csymbol><set id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1"><apply id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.2">𝜇</ci><ci id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3"><eq id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.1"></eq><ci id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E2X.2.1.1.m1.2.2.2.2.1.3.cmml" xref="S3.E2X.2.1.1.m1.2.2.2.2.1.3">𝐾</ci></apply></list></apply></apply><apply id="S3.E2X.2.1.1.m1.6.6.3.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1"><apply id="S3.E2X.2.1.1.m1.6.6.3.1.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.6.6.3.1.2.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2">subscript</csymbol><sum id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.2"></sum><apply id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3"><eq id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.1"></eq><ci id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2X.2.1.1.m1.6.6.3.1.2.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.2.3">𝐾</ci></apply><apply id="S3.E2X.2.1.1.m1.6.6.3.1.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1"><times id="S3.E2X.2.1.1.m1.6.6.3.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.2"></times><apply id="S3.E2X.2.1.1.m1.6.6.3.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.6.6.3.1.1.3.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.6.6.3.1.1.3.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.3.2">𝛼</ci><ci id="S3.E2X.2.1.1.m1.6.6.3.1.1.3.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.3.3">𝑖</ci></apply><apply id="S3.E2X.2.1.1.m1.6.6.3.1.1.4.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.4"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.6.6.3.1.1.4.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.4">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.6.6.3.1.1.4.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.4.2">ℒ</ci><ci id="S3.E2X.2.1.1.m1.6.6.3.1.1.4.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.4.3">𝑖</ci></apply><interval closure="open" id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1"><ci id="S3.E2X.2.1.1.m1.3.3.cmml" xref="S3.E2X.2.1.1.m1.3.3">𝜔</ci><apply id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.2">𝜇</ci><ci id="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.6.6.3.1.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.6c">\displaystyle\omega^{*},\{\mu_{i}^{*}\}_{i=1}^{K}=\arg\min_{\omega,\{\mu_{i}\}_{i=1}^{K}}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(\omega,\mu_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
</tbody>
</table>
<p id="S3.p4.17" class="ltx_p">There are different types of personalization according to how to define <math id="S3.p4.5.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p4.5.m1.1a"><mi id="S3.p4.5.m1.1.1" xref="S3.p4.5.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p4.5.m1.1b"><ci id="S3.p4.5.m1.1.1.cmml" xref="S3.p4.5.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m1.1c">\omega</annotation></semantics></math> and <math id="S3.p4.6.m2.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.p4.6.m2.1a"><msub id="S3.p4.6.m2.1.1" xref="S3.p4.6.m2.1.1.cmml"><mi id="S3.p4.6.m2.1.1.2" xref="S3.p4.6.m2.1.1.2.cmml">μ</mi><mi id="S3.p4.6.m2.1.1.3" xref="S3.p4.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.6.m2.1b"><apply id="S3.p4.6.m2.1.1.cmml" xref="S3.p4.6.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.6.m2.1.1.1.cmml" xref="S3.p4.6.m2.1.1">subscript</csymbol><ci id="S3.p4.6.m2.1.1.2.cmml" xref="S3.p4.6.m2.1.1.2">𝜇</ci><ci id="S3.p4.6.m2.1.1.3.cmml" xref="S3.p4.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m2.1c">\mu_{i}</annotation></semantics></math>. 1) <span id="S3.p4.17.1" class="ltx_text ltx_font_bold">full personalization</span>: a local model is fully parameterized by <math id="S3.p4.7.m3.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.p4.7.m3.1a"><msub id="S3.p4.7.m3.1.1" xref="S3.p4.7.m3.1.1.cmml"><mi id="S3.p4.7.m3.1.1.2" xref="S3.p4.7.m3.1.1.2.cmml">μ</mi><mi id="S3.p4.7.m3.1.1.3" xref="S3.p4.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.7.m3.1b"><apply id="S3.p4.7.m3.1.1.cmml" xref="S3.p4.7.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.7.m3.1.1.1.cmml" xref="S3.p4.7.m3.1.1">subscript</csymbol><ci id="S3.p4.7.m3.1.1.2.cmml" xref="S3.p4.7.m3.1.1.2">𝜇</ci><ci id="S3.p4.7.m3.1.1.3.cmml" xref="S3.p4.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m3.1c">\mu_{i}</annotation></semantics></math>, and the global model guides the local training process, e.g., regularizing <math id="S3.p4.8.m4.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.p4.8.m4.1a"><msub id="S3.p4.8.m4.1.1" xref="S3.p4.8.m4.1.1.cmml"><mi id="S3.p4.8.m4.1.1.2" xref="S3.p4.8.m4.1.1.2.cmml">μ</mi><mi id="S3.p4.8.m4.1.1.3" xref="S3.p4.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.8.m4.1b"><apply id="S3.p4.8.m4.1.1.cmml" xref="S3.p4.8.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.8.m4.1.1.1.cmml" xref="S3.p4.8.m4.1.1">subscript</csymbol><ci id="S3.p4.8.m4.1.1.2.cmml" xref="S3.p4.8.m4.1.1.2">𝜇</ci><ci id="S3.p4.8.m4.1.1.3.cmml" xref="S3.p4.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m4.1c">\mu_{i}</annotation></semantics></math> by minimizing <math id="S3.p4.9.m5.1" class="ltx_Math" alttext="\|\omega-\mu_{i}\|_{2}" display="inline"><semantics id="S3.p4.9.m5.1a"><msub id="S3.p4.9.m5.1.1" xref="S3.p4.9.m5.1.1.cmml"><mrow id="S3.p4.9.m5.1.1.1.1" xref="S3.p4.9.m5.1.1.1.2.cmml"><mo stretchy="false" id="S3.p4.9.m5.1.1.1.1.2" xref="S3.p4.9.m5.1.1.1.2.1.cmml">‖</mo><mrow id="S3.p4.9.m5.1.1.1.1.1" xref="S3.p4.9.m5.1.1.1.1.1.cmml"><mi id="S3.p4.9.m5.1.1.1.1.1.2" xref="S3.p4.9.m5.1.1.1.1.1.2.cmml">ω</mi><mo id="S3.p4.9.m5.1.1.1.1.1.1" xref="S3.p4.9.m5.1.1.1.1.1.1.cmml">−</mo><msub id="S3.p4.9.m5.1.1.1.1.1.3" xref="S3.p4.9.m5.1.1.1.1.1.3.cmml"><mi id="S3.p4.9.m5.1.1.1.1.1.3.2" xref="S3.p4.9.m5.1.1.1.1.1.3.2.cmml">μ</mi><mi id="S3.p4.9.m5.1.1.1.1.1.3.3" xref="S3.p4.9.m5.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.p4.9.m5.1.1.1.1.3" xref="S3.p4.9.m5.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.p4.9.m5.1.1.3" xref="S3.p4.9.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p4.9.m5.1b"><apply id="S3.p4.9.m5.1.1.cmml" xref="S3.p4.9.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m5.1.1.2.cmml" xref="S3.p4.9.m5.1.1">subscript</csymbol><apply id="S3.p4.9.m5.1.1.1.2.cmml" xref="S3.p4.9.m5.1.1.1.1"><csymbol cd="latexml" id="S3.p4.9.m5.1.1.1.2.1.cmml" xref="S3.p4.9.m5.1.1.1.1.2">norm</csymbol><apply id="S3.p4.9.m5.1.1.1.1.1.cmml" xref="S3.p4.9.m5.1.1.1.1.1"><minus id="S3.p4.9.m5.1.1.1.1.1.1.cmml" xref="S3.p4.9.m5.1.1.1.1.1.1"></minus><ci id="S3.p4.9.m5.1.1.1.1.1.2.cmml" xref="S3.p4.9.m5.1.1.1.1.1.2">𝜔</ci><apply id="S3.p4.9.m5.1.1.1.1.1.3.cmml" xref="S3.p4.9.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p4.9.m5.1.1.1.1.1.3.1.cmml" xref="S3.p4.9.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p4.9.m5.1.1.1.1.1.3.2.cmml" xref="S3.p4.9.m5.1.1.1.1.1.3.2">𝜇</ci><ci id="S3.p4.9.m5.1.1.1.1.1.3.3.cmml" xref="S3.p4.9.m5.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.p4.9.m5.1.1.3.cmml" xref="S3.p4.9.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m5.1c">\|\omega-\mu_{i}\|_{2}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> or initializing local parameters with <math id="S3.p4.10.m6.1" class="ltx_Math" alttext="\mu_{i}=\omega-\nabla\mathcal{L}_{i}" display="inline"><semantics id="S3.p4.10.m6.1a"><mrow id="S3.p4.10.m6.1.1" xref="S3.p4.10.m6.1.1.cmml"><msub id="S3.p4.10.m6.1.1.2" xref="S3.p4.10.m6.1.1.2.cmml"><mi id="S3.p4.10.m6.1.1.2.2" xref="S3.p4.10.m6.1.1.2.2.cmml">μ</mi><mi id="S3.p4.10.m6.1.1.2.3" xref="S3.p4.10.m6.1.1.2.3.cmml">i</mi></msub><mo id="S3.p4.10.m6.1.1.1" xref="S3.p4.10.m6.1.1.1.cmml">=</mo><mrow id="S3.p4.10.m6.1.1.3" xref="S3.p4.10.m6.1.1.3.cmml"><mi id="S3.p4.10.m6.1.1.3.2" xref="S3.p4.10.m6.1.1.3.2.cmml">ω</mi><mo id="S3.p4.10.m6.1.1.3.1" xref="S3.p4.10.m6.1.1.3.1.cmml">−</mo><mrow id="S3.p4.10.m6.1.1.3.3" xref="S3.p4.10.m6.1.1.3.3.cmml"><mo rspace="0.167em" id="S3.p4.10.m6.1.1.3.3.1" xref="S3.p4.10.m6.1.1.3.3.1.cmml">∇</mo><msub id="S3.p4.10.m6.1.1.3.3.2" xref="S3.p4.10.m6.1.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.10.m6.1.1.3.3.2.2" xref="S3.p4.10.m6.1.1.3.3.2.2.cmml">ℒ</mi><mi id="S3.p4.10.m6.1.1.3.3.2.3" xref="S3.p4.10.m6.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.10.m6.1b"><apply id="S3.p4.10.m6.1.1.cmml" xref="S3.p4.10.m6.1.1"><eq id="S3.p4.10.m6.1.1.1.cmml" xref="S3.p4.10.m6.1.1.1"></eq><apply id="S3.p4.10.m6.1.1.2.cmml" xref="S3.p4.10.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p4.10.m6.1.1.2.1.cmml" xref="S3.p4.10.m6.1.1.2">subscript</csymbol><ci id="S3.p4.10.m6.1.1.2.2.cmml" xref="S3.p4.10.m6.1.1.2.2">𝜇</ci><ci id="S3.p4.10.m6.1.1.2.3.cmml" xref="S3.p4.10.m6.1.1.2.3">𝑖</ci></apply><apply id="S3.p4.10.m6.1.1.3.cmml" xref="S3.p4.10.m6.1.1.3"><minus id="S3.p4.10.m6.1.1.3.1.cmml" xref="S3.p4.10.m6.1.1.3.1"></minus><ci id="S3.p4.10.m6.1.1.3.2.cmml" xref="S3.p4.10.m6.1.1.3.2">𝜔</ci><apply id="S3.p4.10.m6.1.1.3.3.cmml" xref="S3.p4.10.m6.1.1.3.3"><ci id="S3.p4.10.m6.1.1.3.3.1.cmml" xref="S3.p4.10.m6.1.1.3.3.1">∇</ci><apply id="S3.p4.10.m6.1.1.3.3.2.cmml" xref="S3.p4.10.m6.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.p4.10.m6.1.1.3.3.2.1.cmml" xref="S3.p4.10.m6.1.1.3.3.2">subscript</csymbol><ci id="S3.p4.10.m6.1.1.3.3.2.2.cmml" xref="S3.p4.10.m6.1.1.3.3.2.2">ℒ</ci><ci id="S3.p4.10.m6.1.1.3.3.2.3.cmml" xref="S3.p4.10.m6.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.10.m6.1c">\mu_{i}=\omega-\nabla\mathcal{L}_{i}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>; 2) <span id="S3.p4.17.2" class="ltx_text ltx_font_bold">partial personalization</span>: <math id="S3.p4.11.m7.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p4.11.m7.1a"><mi id="S3.p4.11.m7.1.1" xref="S3.p4.11.m7.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p4.11.m7.1b"><ci id="S3.p4.11.m7.1.1.cmml" xref="S3.p4.11.m7.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.11.m7.1c">\omega</annotation></semantics></math> and <math id="S3.p4.12.m8.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.p4.12.m8.1a"><msub id="S3.p4.12.m8.1.1" xref="S3.p4.12.m8.1.1.cmml"><mi id="S3.p4.12.m8.1.1.2" xref="S3.p4.12.m8.1.1.2.cmml">μ</mi><mi id="S3.p4.12.m8.1.1.3" xref="S3.p4.12.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.12.m8.1b"><apply id="S3.p4.12.m8.1.1.cmml" xref="S3.p4.12.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.12.m8.1.1.1.cmml" xref="S3.p4.12.m8.1.1">subscript</csymbol><ci id="S3.p4.12.m8.1.1.2.cmml" xref="S3.p4.12.m8.1.1.2">𝜇</ci><ci id="S3.p4.12.m8.1.1.3.cmml" xref="S3.p4.12.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.12.m8.1c">\mu_{i}</annotation></semantics></math> constitute the global and personal parts of a local model, where <math id="S3.p4.13.m9.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p4.13.m9.1a"><mi id="S3.p4.13.m9.1.1" xref="S3.p4.13.m9.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p4.13.m9.1b"><ci id="S3.p4.13.m9.1.1.cmml" xref="S3.p4.13.m9.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.13.m9.1c">\omega</annotation></semantics></math> is shared through the fundamental FL method in <a href="#S3.E1" title="In 3 Problem Formulation ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and <math id="S3.p4.14.m10.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.p4.14.m10.1a"><msub id="S3.p4.14.m10.1.1" xref="S3.p4.14.m10.1.1.cmml"><mi id="S3.p4.14.m10.1.1.2" xref="S3.p4.14.m10.1.1.2.cmml">μ</mi><mi id="S3.p4.14.m10.1.1.3" xref="S3.p4.14.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.14.m10.1b"><apply id="S3.p4.14.m10.1.1.cmml" xref="S3.p4.14.m10.1.1"><csymbol cd="ambiguous" id="S3.p4.14.m10.1.1.1.cmml" xref="S3.p4.14.m10.1.1">subscript</csymbol><ci id="S3.p4.14.m10.1.1.2.cmml" xref="S3.p4.14.m10.1.1.2">𝜇</ci><ci id="S3.p4.14.m10.1.1.3.cmml" xref="S3.p4.14.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.14.m10.1c">\mu_{i}</annotation></semantics></math> is trained individually on each client. e.g., <math id="S3.p4.15.m11.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p4.15.m11.1a"><mi id="S3.p4.15.m11.1.1" xref="S3.p4.15.m11.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p4.15.m11.1b"><ci id="S3.p4.15.m11.1.1.cmml" xref="S3.p4.15.m11.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.15.m11.1c">\omega</annotation></semantics></math> could be parameters of a shared backbone model, and <math id="S3.p4.16.m12.1" class="ltx_Math" alttext="\mu_{i}" display="inline"><semantics id="S3.p4.16.m12.1a"><msub id="S3.p4.16.m12.1.1" xref="S3.p4.16.m12.1.1.cmml"><mi id="S3.p4.16.m12.1.1.2" xref="S3.p4.16.m12.1.1.2.cmml">μ</mi><mi id="S3.p4.16.m12.1.1.3" xref="S3.p4.16.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.16.m12.1b"><apply id="S3.p4.16.m12.1.1.cmml" xref="S3.p4.16.m12.1.1"><csymbol cd="ambiguous" id="S3.p4.16.m12.1.1.1.cmml" xref="S3.p4.16.m12.1.1">subscript</csymbol><ci id="S3.p4.16.m12.1.1.2.cmml" xref="S3.p4.16.m12.1.1.2">𝜇</ci><ci id="S3.p4.16.m12.1.1.3.cmml" xref="S3.p4.16.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.16.m12.1c">\mu_{i}</annotation></semantics></math> is a classification head for the <math id="S3.p4.17.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.17.m13.1a"><mi id="S3.p4.17.m13.1.1" xref="S3.p4.17.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.17.m13.1b"><ci id="S3.p4.17.m13.1.1.cmml" xref="S3.p4.17.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.17.m13.1c">i</annotation></semantics></math>-th client <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.6" class="ltx_p">Looking inside the latent space of a DNN <math id="S4.p1.1.m1.5" class="ltx_Math" alttext="f(\mathbf{x};\omega)=g(h(\mathbf{x};\omega_{h});\omega_{g})" display="inline"><semantics id="S4.p1.1.m1.5a"><mrow id="S4.p1.1.m1.5.5" xref="S4.p1.1.m1.5.5.cmml"><mrow id="S4.p1.1.m1.5.5.4" xref="S4.p1.1.m1.5.5.4.cmml"><mi id="S4.p1.1.m1.5.5.4.2" xref="S4.p1.1.m1.5.5.4.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.p1.1.m1.5.5.4.1" xref="S4.p1.1.m1.5.5.4.1.cmml">​</mo><mrow id="S4.p1.1.m1.5.5.4.3.2" xref="S4.p1.1.m1.5.5.4.3.1.cmml"><mo stretchy="false" id="S4.p1.1.m1.5.5.4.3.2.1" xref="S4.p1.1.m1.5.5.4.3.1.cmml">(</mo><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S4.p1.1.m1.5.5.4.3.2.2" xref="S4.p1.1.m1.5.5.4.3.1.cmml">;</mo><mi id="S4.p1.1.m1.2.2" xref="S4.p1.1.m1.2.2.cmml">ω</mi><mo stretchy="false" id="S4.p1.1.m1.5.5.4.3.2.3" xref="S4.p1.1.m1.5.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.p1.1.m1.5.5.3" xref="S4.p1.1.m1.5.5.3.cmml">=</mo><mrow id="S4.p1.1.m1.5.5.2" xref="S4.p1.1.m1.5.5.2.cmml"><mi id="S4.p1.1.m1.5.5.2.4" xref="S4.p1.1.m1.5.5.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.p1.1.m1.5.5.2.3" xref="S4.p1.1.m1.5.5.2.3.cmml">​</mo><mrow id="S4.p1.1.m1.5.5.2.2.2" xref="S4.p1.1.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="S4.p1.1.m1.5.5.2.2.2.3" xref="S4.p1.1.m1.5.5.2.2.3.cmml">(</mo><mrow id="S4.p1.1.m1.4.4.1.1.1.1" xref="S4.p1.1.m1.4.4.1.1.1.1.cmml"><mi id="S4.p1.1.m1.4.4.1.1.1.1.3" xref="S4.p1.1.m1.4.4.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.p1.1.m1.4.4.1.1.1.1.2" xref="S4.p1.1.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.p1.1.m1.4.4.1.1.1.1.1.1" xref="S4.p1.1.m1.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.p1.1.m1.4.4.1.1.1.1.1.1.2" xref="S4.p1.1.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mi id="S4.p1.1.m1.3.3" xref="S4.p1.1.m1.3.3.cmml">𝐱</mi><mo id="S4.p1.1.m1.4.4.1.1.1.1.1.1.3" xref="S4.p1.1.m1.4.4.1.1.1.1.1.2.cmml">;</mo><msub id="S4.p1.1.m1.4.4.1.1.1.1.1.1.1" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="S4.p1.1.m1.4.4.1.1.1.1.1.1.4" xref="S4.p1.1.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.p1.1.m1.5.5.2.2.2.4" xref="S4.p1.1.m1.5.5.2.2.3.cmml">;</mo><msub id="S4.p1.1.m1.5.5.2.2.2.2" xref="S4.p1.1.m1.5.5.2.2.2.2.cmml"><mi id="S4.p1.1.m1.5.5.2.2.2.2.2" xref="S4.p1.1.m1.5.5.2.2.2.2.2.cmml">ω</mi><mi id="S4.p1.1.m1.5.5.2.2.2.2.3" xref="S4.p1.1.m1.5.5.2.2.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="S4.p1.1.m1.5.5.2.2.2.5" xref="S4.p1.1.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.5b"><apply id="S4.p1.1.m1.5.5.cmml" xref="S4.p1.1.m1.5.5"><eq id="S4.p1.1.m1.5.5.3.cmml" xref="S4.p1.1.m1.5.5.3"></eq><apply id="S4.p1.1.m1.5.5.4.cmml" xref="S4.p1.1.m1.5.5.4"><times id="S4.p1.1.m1.5.5.4.1.cmml" xref="S4.p1.1.m1.5.5.4.1"></times><ci id="S4.p1.1.m1.5.5.4.2.cmml" xref="S4.p1.1.m1.5.5.4.2">𝑓</ci><list id="S4.p1.1.m1.5.5.4.3.1.cmml" xref="S4.p1.1.m1.5.5.4.3.2"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝐱</ci><ci id="S4.p1.1.m1.2.2.cmml" xref="S4.p1.1.m1.2.2">𝜔</ci></list></apply><apply id="S4.p1.1.m1.5.5.2.cmml" xref="S4.p1.1.m1.5.5.2"><times id="S4.p1.1.m1.5.5.2.3.cmml" xref="S4.p1.1.m1.5.5.2.3"></times><ci id="S4.p1.1.m1.5.5.2.4.cmml" xref="S4.p1.1.m1.5.5.2.4">𝑔</ci><list id="S4.p1.1.m1.5.5.2.2.3.cmml" xref="S4.p1.1.m1.5.5.2.2.2"><apply id="S4.p1.1.m1.4.4.1.1.1.1.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1"><times id="S4.p1.1.m1.4.4.1.1.1.1.2.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1.2"></times><ci id="S4.p1.1.m1.4.4.1.1.1.1.3.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1.3">ℎ</ci><list id="S4.p1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1"><ci id="S4.p1.1.m1.3.3.cmml" xref="S4.p1.1.m1.3.3">𝐱</ci><apply id="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.p1.1.m1.4.4.1.1.1.1.1.1.1.3">ℎ</ci></apply></list></apply><apply id="S4.p1.1.m1.5.5.2.2.2.2.cmml" xref="S4.p1.1.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.5.5.2.2.2.2.1.cmml" xref="S4.p1.1.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S4.p1.1.m1.5.5.2.2.2.2.2.cmml" xref="S4.p1.1.m1.5.5.2.2.2.2.2">𝜔</ci><ci id="S4.p1.1.m1.5.5.2.2.2.2.3.cmml" xref="S4.p1.1.m1.5.5.2.2.2.2.3">𝑔</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.5c">f(\mathbf{x};\omega)=g(h(\mathbf{x};\omega_{h});\omega_{g})</annotation></semantics></math>, it consists of two parts: <math id="S4.p1.2.m2.2" class="ltx_Math" alttext="h(\mathbf{x};\omega_{h})" display="inline"><semantics id="S4.p1.2.m2.2a"><mrow id="S4.p1.2.m2.2.2" xref="S4.p1.2.m2.2.2.cmml"><mi id="S4.p1.2.m2.2.2.3" xref="S4.p1.2.m2.2.2.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.p1.2.m2.2.2.2" xref="S4.p1.2.m2.2.2.2.cmml">​</mo><mrow id="S4.p1.2.m2.2.2.1.1" xref="S4.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.p1.2.m2.2.2.1.1.2" xref="S4.p1.2.m2.2.2.1.2.cmml">(</mo><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">𝐱</mi><mo id="S4.p1.2.m2.2.2.1.1.3" xref="S4.p1.2.m2.2.2.1.2.cmml">;</mo><msub id="S4.p1.2.m2.2.2.1.1.1" xref="S4.p1.2.m2.2.2.1.1.1.cmml"><mi id="S4.p1.2.m2.2.2.1.1.1.2" xref="S4.p1.2.m2.2.2.1.1.1.2.cmml">ω</mi><mi id="S4.p1.2.m2.2.2.1.1.1.3" xref="S4.p1.2.m2.2.2.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="S4.p1.2.m2.2.2.1.1.4" xref="S4.p1.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.2b"><apply id="S4.p1.2.m2.2.2.cmml" xref="S4.p1.2.m2.2.2"><times id="S4.p1.2.m2.2.2.2.cmml" xref="S4.p1.2.m2.2.2.2"></times><ci id="S4.p1.2.m2.2.2.3.cmml" xref="S4.p1.2.m2.2.2.3">ℎ</ci><list id="S4.p1.2.m2.2.2.1.2.cmml" xref="S4.p1.2.m2.2.2.1.1"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝐱</ci><apply id="S4.p1.2.m2.2.2.1.1.1.cmml" xref="S4.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.2.2.1.1.1.1.cmml" xref="S4.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.p1.2.m2.2.2.1.1.1.2.cmml" xref="S4.p1.2.m2.2.2.1.1.1.2">𝜔</ci><ci id="S4.p1.2.m2.2.2.1.1.1.3.cmml" xref="S4.p1.2.m2.2.2.1.1.1.3">ℎ</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.2c">h(\mathbf{x};\omega_{h})</annotation></semantics></math> is a feature extractor learning the latent representation <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{z}\in\mathbb{R}^{d}" display="inline"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mi id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">𝐳</mi><mo id="S4.p1.3.m3.1.1.1" xref="S4.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml"><mi id="S4.p1.3.m3.1.1.3.2" xref="S4.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S4.p1.3.m3.1.1.3.3" xref="S4.p1.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><in id="S4.p1.3.m3.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1"></in><ci id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2">𝐳</ci><apply id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.3.1.cmml" xref="S4.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.p1.3.m3.1.1.3.2.cmml" xref="S4.p1.3.m3.1.1.3.2">ℝ</ci><ci id="S4.p1.3.m3.1.1.3.3.cmml" xref="S4.p1.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">\mathbf{z}\in\mathbb{R}^{d}</annotation></semantics></math>, and <math id="S4.p1.4.m4.2" class="ltx_Math" alttext="g(\mathbf{z};\omega_{g})" display="inline"><semantics id="S4.p1.4.m4.2a"><mrow id="S4.p1.4.m4.2.2" xref="S4.p1.4.m4.2.2.cmml"><mi id="S4.p1.4.m4.2.2.3" xref="S4.p1.4.m4.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.p1.4.m4.2.2.2" xref="S4.p1.4.m4.2.2.2.cmml">​</mo><mrow id="S4.p1.4.m4.2.2.1.1" xref="S4.p1.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S4.p1.4.m4.2.2.1.1.2" xref="S4.p1.4.m4.2.2.1.2.cmml">(</mo><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">𝐳</mi><mo id="S4.p1.4.m4.2.2.1.1.3" xref="S4.p1.4.m4.2.2.1.2.cmml">;</mo><msub id="S4.p1.4.m4.2.2.1.1.1" xref="S4.p1.4.m4.2.2.1.1.1.cmml"><mi id="S4.p1.4.m4.2.2.1.1.1.2" xref="S4.p1.4.m4.2.2.1.1.1.2.cmml">ω</mi><mi id="S4.p1.4.m4.2.2.1.1.1.3" xref="S4.p1.4.m4.2.2.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S4.p1.4.m4.2.2.1.1.4" xref="S4.p1.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.2b"><apply id="S4.p1.4.m4.2.2.cmml" xref="S4.p1.4.m4.2.2"><times id="S4.p1.4.m4.2.2.2.cmml" xref="S4.p1.4.m4.2.2.2"></times><ci id="S4.p1.4.m4.2.2.3.cmml" xref="S4.p1.4.m4.2.2.3">𝑔</ci><list id="S4.p1.4.m4.2.2.1.2.cmml" xref="S4.p1.4.m4.2.2.1.1"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝐳</ci><apply id="S4.p1.4.m4.2.2.1.1.1.cmml" xref="S4.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.2.2.1.1.1.1.cmml" xref="S4.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S4.p1.4.m4.2.2.1.1.1.2.cmml" xref="S4.p1.4.m4.2.2.1.1.1.2">𝜔</ci><ci id="S4.p1.4.m4.2.2.1.1.1.3.cmml" xref="S4.p1.4.m4.2.2.1.1.1.3">𝑔</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.2c">g(\mathbf{z};\omega_{g})</annotation></semantics></math> is a classification head making predictions based on <math id="S4.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S4.p1.5.m5.1a"><mi id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><ci id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">\mathbf{z}</annotation></semantics></math>. Our goal is to align the latent representation space for <math id="S4.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S4.p1.6.m6.1a"><mi id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><ci id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">\mathbf{z}</annotation></semantics></math>, such that 1) it is able to embed client-specific information, i.e., instances from similar clients will have similar values and vary significantly otherwise; 2) it is able to share client-agnostic knowledge as vanilla FL methods, and 3) downstream modules can make personalized predictions by leveraging both information.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.4" class="ltx_p">Formally, FedCS looks for a projection <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{c}=\mathbf{P}^{T}\mathbf{z}" display="inline"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">𝐜</mi><mo id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml"><msup id="S4.p2.1.m1.1.1.3.2" xref="S4.p2.1.m1.1.1.3.2.cmml"><mi id="S4.p2.1.m1.1.1.3.2.2" xref="S4.p2.1.m1.1.1.3.2.2.cmml">𝐏</mi><mi id="S4.p2.1.m1.1.1.3.2.3" xref="S4.p2.1.m1.1.1.3.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S4.p2.1.m1.1.1.3.1" xref="S4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.p2.1.m1.1.1.3.3" xref="S4.p2.1.m1.1.1.3.3.cmml">𝐳</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><eq id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"></eq><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝐜</ci><apply id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3"><times id="S4.p2.1.m1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.3.1"></times><apply id="S4.p2.1.m1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.3.2.1.cmml" xref="S4.p2.1.m1.1.1.3.2">superscript</csymbol><ci id="S4.p2.1.m1.1.1.3.2.2.cmml" xref="S4.p2.1.m1.1.1.3.2.2">𝐏</ci><ci id="S4.p2.1.m1.1.1.3.2.3.cmml" xref="S4.p2.1.m1.1.1.3.2.3">𝑇</ci></apply><ci id="S4.p2.1.m1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.3.3">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\mathbf{c}=\mathbf{P}^{T}\mathbf{z}</annotation></semantics></math>, where <math id="S4.p2.2.m2.4" class="ltx_Math" alttext="\mathbf{P}_{d\times r}=[\mathbf{p}_{1},\mathbf{p}_{2},...,\mathbf{p}_{r}]" display="inline"><semantics id="S4.p2.2.m2.4a"><mrow id="S4.p2.2.m2.4.4" xref="S4.p2.2.m2.4.4.cmml"><msub id="S4.p2.2.m2.4.4.5" xref="S4.p2.2.m2.4.4.5.cmml"><mi id="S4.p2.2.m2.4.4.5.2" xref="S4.p2.2.m2.4.4.5.2.cmml">𝐏</mi><mrow id="S4.p2.2.m2.4.4.5.3" xref="S4.p2.2.m2.4.4.5.3.cmml"><mi id="S4.p2.2.m2.4.4.5.3.2" xref="S4.p2.2.m2.4.4.5.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S4.p2.2.m2.4.4.5.3.1" xref="S4.p2.2.m2.4.4.5.3.1.cmml">×</mo><mi id="S4.p2.2.m2.4.4.5.3.3" xref="S4.p2.2.m2.4.4.5.3.3.cmml">r</mi></mrow></msub><mo id="S4.p2.2.m2.4.4.4" xref="S4.p2.2.m2.4.4.4.cmml">=</mo><mrow id="S4.p2.2.m2.4.4.3.3" xref="S4.p2.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S4.p2.2.m2.4.4.3.3.4" xref="S4.p2.2.m2.4.4.3.4.cmml">[</mo><msub id="S4.p2.2.m2.2.2.1.1.1" xref="S4.p2.2.m2.2.2.1.1.1.cmml"><mi id="S4.p2.2.m2.2.2.1.1.1.2" xref="S4.p2.2.m2.2.2.1.1.1.2.cmml">𝐩</mi><mn id="S4.p2.2.m2.2.2.1.1.1.3" xref="S4.p2.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.p2.2.m2.4.4.3.3.5" xref="S4.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.p2.2.m2.3.3.2.2.2" xref="S4.p2.2.m2.3.3.2.2.2.cmml"><mi id="S4.p2.2.m2.3.3.2.2.2.2" xref="S4.p2.2.m2.3.3.2.2.2.2.cmml">𝐩</mi><mn id="S4.p2.2.m2.3.3.2.2.2.3" xref="S4.p2.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.p2.2.m2.4.4.3.3.6" xref="S4.p2.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">…</mi><mo id="S4.p2.2.m2.4.4.3.3.7" xref="S4.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.p2.2.m2.4.4.3.3.3" xref="S4.p2.2.m2.4.4.3.3.3.cmml"><mi id="S4.p2.2.m2.4.4.3.3.3.2" xref="S4.p2.2.m2.4.4.3.3.3.2.cmml">𝐩</mi><mi id="S4.p2.2.m2.4.4.3.3.3.3" xref="S4.p2.2.m2.4.4.3.3.3.3.cmml">r</mi></msub><mo stretchy="false" id="S4.p2.2.m2.4.4.3.3.8" xref="S4.p2.2.m2.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.4b"><apply id="S4.p2.2.m2.4.4.cmml" xref="S4.p2.2.m2.4.4"><eq id="S4.p2.2.m2.4.4.4.cmml" xref="S4.p2.2.m2.4.4.4"></eq><apply id="S4.p2.2.m2.4.4.5.cmml" xref="S4.p2.2.m2.4.4.5"><csymbol cd="ambiguous" id="S4.p2.2.m2.4.4.5.1.cmml" xref="S4.p2.2.m2.4.4.5">subscript</csymbol><ci id="S4.p2.2.m2.4.4.5.2.cmml" xref="S4.p2.2.m2.4.4.5.2">𝐏</ci><apply id="S4.p2.2.m2.4.4.5.3.cmml" xref="S4.p2.2.m2.4.4.5.3"><times id="S4.p2.2.m2.4.4.5.3.1.cmml" xref="S4.p2.2.m2.4.4.5.3.1"></times><ci id="S4.p2.2.m2.4.4.5.3.2.cmml" xref="S4.p2.2.m2.4.4.5.3.2">𝑑</ci><ci id="S4.p2.2.m2.4.4.5.3.3.cmml" xref="S4.p2.2.m2.4.4.5.3.3">𝑟</ci></apply></apply><list id="S4.p2.2.m2.4.4.3.4.cmml" xref="S4.p2.2.m2.4.4.3.3"><apply id="S4.p2.2.m2.2.2.1.1.1.cmml" xref="S4.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.p2.2.m2.2.2.1.1.1.2">𝐩</ci><cn type="integer" id="S4.p2.2.m2.2.2.1.1.1.3.cmml" xref="S4.p2.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S4.p2.2.m2.3.3.2.2.2.cmml" xref="S4.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.p2.2.m2.3.3.2.2.2.1.cmml" xref="S4.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.p2.2.m2.3.3.2.2.2.2.cmml" xref="S4.p2.2.m2.3.3.2.2.2.2">𝐩</ci><cn type="integer" id="S4.p2.2.m2.3.3.2.2.2.3.cmml" xref="S4.p2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">…</ci><apply id="S4.p2.2.m2.4.4.3.3.3.cmml" xref="S4.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.4.4.3.3.3.1.cmml" xref="S4.p2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.p2.2.m2.4.4.3.3.3.2.cmml" xref="S4.p2.2.m2.4.4.3.3.3.2">𝐩</ci><ci id="S4.p2.2.m2.4.4.3.3.3.3.cmml" xref="S4.p2.2.m2.4.4.3.3.3.3">𝑟</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.4c">\mathbf{P}_{d\times r}=[\mathbf{p}_{1},\mathbf{p}_{2},...,\mathbf{p}_{r}]</annotation></semantics></math> is the orthonormal basis of the objective representation space. It searches for the optimal directions <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{P}^{*}" display="inline"><semantics id="S4.p2.3.m3.1a"><msup id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">𝐏</mi><mo id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1">superscript</csymbol><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝐏</ci><times id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">\mathbf{P}^{*}</annotation></semantics></math> according to an inductive bias that representation <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{c}" display="inline"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\mathbf{c}</annotation></semantics></math> on the same client shall be similar, and those from different clients are on the contrary.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Representation Alignment</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.3" class="ltx_p">Specifically, let <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bar{\mathbf{c}}^{(i)}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msup id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mover accent="true" id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.2.2" xref="S4.SS1.p1.1.m1.1.2.2.2.cmml">𝐜</mi><mo id="S4.SS1.p1.1.m1.1.2.2.1" xref="S4.SS1.p1.1.m1.1.2.2.1.cmml">¯</mo></mover><mrow id="S4.SS1.p1.1.m1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.1.1.1.3.1" xref="S4.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.SS1.p1.1.m1.1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2">superscript</csymbol><apply id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2"><ci id="S4.SS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2.1">¯</ci><ci id="S4.SS1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2">𝐜</ci></apply><ci id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\bar{\mathbf{c}}^{(i)}</annotation></semantics></math> denote the mean of representations on the <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">i</annotation></semantics></math>-th client, and <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\bar{\mathbf{c}}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mover accent="true" id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">𝐜</mi><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><ci id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1">¯</ci><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝐜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\bar{\mathbf{c}}</annotation></semantics></math> be the global mean among clients.</p>
<table id="S4.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3X.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle\Sigma_{W}=\frac{1}{\sum_{i=1}^{K}N_{i}}\sum_{i=1}^{K}\sum_{j=1}^{N_{i}}(\mathbf{c}_{j}^{(i)}-\bar{\mathbf{c}}^{(i)})(\mathbf{c}_{j}^{(i)}-\bar{\mathbf{c}}^{(i)})^{T}" display="inline"><semantics id="S4.E3X.2.1.1.m1.6a"><mrow id="S4.E3X.2.1.1.m1.6.6" xref="S4.E3X.2.1.1.m1.6.6.cmml"><msub id="S4.E3X.2.1.1.m1.6.6.4" xref="S4.E3X.2.1.1.m1.6.6.4.cmml"><mi mathvariant="normal" id="S4.E3X.2.1.1.m1.6.6.4.2" xref="S4.E3X.2.1.1.m1.6.6.4.2.cmml">Σ</mi><mi id="S4.E3X.2.1.1.m1.6.6.4.3" xref="S4.E3X.2.1.1.m1.6.6.4.3.cmml">W</mi></msub><mo id="S4.E3X.2.1.1.m1.6.6.3" xref="S4.E3X.2.1.1.m1.6.6.3.cmml">=</mo><mrow id="S4.E3X.2.1.1.m1.6.6.2" xref="S4.E3X.2.1.1.m1.6.6.2.cmml"><mstyle displaystyle="true" id="S4.E3X.2.1.1.m1.6.6.2.4" xref="S4.E3X.2.1.1.m1.6.6.2.4.cmml"><mfrac id="S4.E3X.2.1.1.m1.6.6.2.4a" xref="S4.E3X.2.1.1.m1.6.6.2.4.cmml"><mn id="S4.E3X.2.1.1.m1.6.6.2.4.2" xref="S4.E3X.2.1.1.m1.6.6.2.4.2.cmml">1</mn><mrow id="S4.E3X.2.1.1.m1.6.6.2.4.3" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.cmml"><msubsup id="S4.E3X.2.1.1.m1.6.6.2.4.3.1" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.cmml"><mo id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.2.cmml">∑</mo><mrow id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.cmml"><mi id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.2.cmml">i</mi><mo id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.1" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.1.cmml">=</mo><mn id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.3" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.3" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.3.cmml">K</mi></msubsup><msub id="S4.E3X.2.1.1.m1.6.6.2.4.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.2.cmml"><mi id="S4.E3X.2.1.1.m1.6.6.2.4.3.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.2.2.cmml">N</mi><mi id="S4.E3X.2.1.1.m1.6.6.2.4.3.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E3X.2.1.1.m1.6.6.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.3.cmml">​</mo><mrow id="S4.E3X.2.1.1.m1.6.6.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.cmml"><mstyle displaystyle="true" id="S4.E3X.2.1.1.m1.6.6.2.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.cmml"><munderover id="S4.E3X.2.1.1.m1.6.6.2.2.3a" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.cmml"><mo movablelimits="false" id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.cmml"><mi id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.2.cmml">i</mi><mo id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E3X.2.1.1.m1.6.6.2.2.3.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S4.E3X.2.1.1.m1.6.6.2.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E3X.2.1.1.m1.6.6.2.2.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.cmml"><munderover id="S4.E3X.2.1.1.m1.6.6.2.2.2.3a" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.cmml"><mo movablelimits="false" id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.cmml"><mi id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.2.cmml">j</mi><mo id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.cmml"><mi id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.2.cmml">N</mi><mi id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.3.cmml">i</mi></msub></munderover></mstyle><mrow id="S4.E3X.2.1.1.m1.6.6.2.2.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.cmml"><mrow id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.2" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">𝐜</mi><mi id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml">j</mi><mrow id="S4.E3X.2.1.1.m1.1.1.1.3" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3X.2.1.1.m1.1.1.1.3.1" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E3X.2.1.1.m1.1.1.1.1" xref="S4.E3X.2.1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E3X.2.1.1.m1.1.1.1.3.2" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.2" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.2.cmml">𝐜</mi><mo id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.1" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S4.E3X.2.1.1.m1.2.2.1.3" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E3X.2.1.1.m1.2.2.1.3.1" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E3X.2.1.1.m1.2.2.1.1" xref="S4.E3X.2.1.1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S4.E3X.2.1.1.m1.2.2.1.3.2" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.3" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.3.cmml">​</mo><msup id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.cmml"><mrow id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.cmml"><msubsup id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.2.cmml">𝐜</mi><mi id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.3.cmml">j</mi><mrow id="S4.E3X.2.1.1.m1.3.3.1.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3X.2.1.1.m1.3.3.1.3.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.cmml">(</mo><mi id="S4.E3X.2.1.1.m1.3.3.1.1" xref="S4.E3X.2.1.1.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S4.E3X.2.1.1.m1.3.3.1.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.1.cmml">−</mo><msup id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.cmml"><mover accent="true" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.cmml"><mi id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.2.cmml">𝐜</mi><mo id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S4.E3X.2.1.1.m1.4.4.1.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.E3X.2.1.1.m1.4.4.1.3.1" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.cmml">(</mo><mi id="S4.E3X.2.1.1.m1.4.4.1.1" xref="S4.E3X.2.1.1.m1.4.4.1.1.cmml">i</mi><mo stretchy="false" id="S4.E3X.2.1.1.m1.4.4.1.3.2" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.3" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3X.2.1.1.m1.6b"><apply id="S4.E3X.2.1.1.m1.6.6.cmml" xref="S4.E3X.2.1.1.m1.6.6"><eq id="S4.E3X.2.1.1.m1.6.6.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.3"></eq><apply id="S4.E3X.2.1.1.m1.6.6.4.cmml" xref="S4.E3X.2.1.1.m1.6.6.4"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.4.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.4">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.6.6.4.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.4.2">Σ</ci><ci id="S4.E3X.2.1.1.m1.6.6.4.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.4.3">𝑊</ci></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2"><times id="S4.E3X.2.1.1.m1.6.6.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.3"></times><apply id="S4.E3X.2.1.1.m1.6.6.2.4.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4"><divide id="S4.E3X.2.1.1.m1.6.6.2.4.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4"></divide><cn type="integer" id="S4.E3X.2.1.1.m1.6.6.2.4.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.2">1</cn><apply id="S4.E3X.2.1.1.m1.6.6.2.4.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3"><apply id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1">subscript</csymbol><sum id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.2"></sum><apply id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3"><eq id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.1"></eq><ci id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E3X.2.1.1.m1.6.6.2.4.3.1.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.1.3">𝐾</ci></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.4.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.4.3.2.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.2">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.6.6.2.4.3.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.2.2">𝑁</ci><ci id="S4.E3X.2.1.1.m1.6.6.2.4.3.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.4.3.2.3">𝑖</ci></apply></apply></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2"><apply id="S4.E3X.2.1.1.m1.6.6.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3">subscript</csymbol><sum id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.2"></sum><apply id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3"><eq id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.1"></eq><ci id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E3X.2.1.1.m1.6.6.2.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.3.3">𝐾</ci></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2"><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3">subscript</csymbol><sum id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.2"></sum><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3"><eq id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.1"></eq><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.2">𝑁</ci><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.3.3.3">𝑖</ci></apply></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2"><times id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.3"></times><apply id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1"><minus id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.1"></minus><apply id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2">𝐜</ci><ci id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><ci id="S4.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2"><ci id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.2.2">𝐜</ci></apply><ci id="S4.E3X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E3X.2.1.1.m1.2.2.1.1">𝑖</ci></apply></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1"><minus id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.1"></minus><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.2">𝐜</ci><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.2.2.3">𝑗</ci></apply><ci id="S4.E3X.2.1.1.m1.3.3.1.1.cmml" xref="S4.E3X.2.1.1.m1.3.3.1.1">𝑖</ci></apply><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3">superscript</csymbol><apply id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2"><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.1">¯</ci><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.1.1.1.3.2.2">𝐜</ci></apply><ci id="S4.E3X.2.1.1.m1.4.4.1.1.cmml" xref="S4.E3X.2.1.1.m1.4.4.1.1">𝑖</ci></apply></apply><ci id="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.6.6.2.2.2.2.2.3">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.2.1.1.m1.6c">\displaystyle\Sigma_{W}=\frac{1}{\sum_{i=1}^{K}N_{i}}\sum_{i=1}^{K}\sum_{j=1}^{N_{i}}(\mathbf{c}_{j}^{(i)}-\bar{\mathbf{c}}^{(i)})(\mathbf{c}_{j}^{(i)}-\bar{\mathbf{c}}^{(i)})^{T}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p1.8" class="ltx_p">Eq.<a href="#S4.E3" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> is the within-client scatter matrix that measures the scatter of latent representations within each client and</p>
<table id="S4.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\Sigma_{B}=\frac{1}{\sum_{i=1}^{K}N_{i}}\sum_{i=1}^{K}N_{i}(\bar{\mathbf{c}}^{(i)}-\bar{\mathbf{c}})(\bar{\mathbf{c}}^{(i)}-\bar{\mathbf{c}})^{T}" display="inline"><semantics id="S4.E4X.2.1.1.m1.4a"><mrow id="S4.E4X.2.1.1.m1.4.4" xref="S4.E4X.2.1.1.m1.4.4.cmml"><msub id="S4.E4X.2.1.1.m1.4.4.4" xref="S4.E4X.2.1.1.m1.4.4.4.cmml"><mi mathvariant="normal" id="S4.E4X.2.1.1.m1.4.4.4.2" xref="S4.E4X.2.1.1.m1.4.4.4.2.cmml">Σ</mi><mi id="S4.E4X.2.1.1.m1.4.4.4.3" xref="S4.E4X.2.1.1.m1.4.4.4.3.cmml">B</mi></msub><mo id="S4.E4X.2.1.1.m1.4.4.3" xref="S4.E4X.2.1.1.m1.4.4.3.cmml">=</mo><mrow id="S4.E4X.2.1.1.m1.4.4.2" xref="S4.E4X.2.1.1.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S4.E4X.2.1.1.m1.4.4.2.4" xref="S4.E4X.2.1.1.m1.4.4.2.4.cmml"><mfrac id="S4.E4X.2.1.1.m1.4.4.2.4a" xref="S4.E4X.2.1.1.m1.4.4.2.4.cmml"><mn id="S4.E4X.2.1.1.m1.4.4.2.4.2" xref="S4.E4X.2.1.1.m1.4.4.2.4.2.cmml">1</mn><mrow id="S4.E4X.2.1.1.m1.4.4.2.4.3" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.cmml"><msubsup id="S4.E4X.2.1.1.m1.4.4.2.4.3.1" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.cmml"><mo id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.2.cmml">∑</mo><mrow id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.cmml"><mi id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.2" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.2.cmml">i</mi><mo id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.1" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.1.cmml">=</mo><mn id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.3" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.3" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.3.cmml">K</mi></msubsup><msub id="S4.E4X.2.1.1.m1.4.4.2.4.3.2" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.2.cmml"><mi id="S4.E4X.2.1.1.m1.4.4.2.4.3.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.2.2.cmml">N</mi><mi id="S4.E4X.2.1.1.m1.4.4.2.4.3.2.3" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E4X.2.1.1.m1.4.4.2.3" xref="S4.E4X.2.1.1.m1.4.4.2.3.cmml">​</mo><mrow id="S4.E4X.2.1.1.m1.4.4.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.cmml"><mstyle displaystyle="true" id="S4.E4X.2.1.1.m1.4.4.2.2.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.cmml"><munderover id="S4.E4X.2.1.1.m1.4.4.2.2.3a" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.cmml"><mo movablelimits="false" id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.cmml"><mi id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.2.cmml">i</mi><mo id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.1" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E4X.2.1.1.m1.4.4.2.2.3.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S4.E4X.2.1.1.m1.4.4.2.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.cmml"><msub id="S4.E4X.2.1.1.m1.4.4.2.2.2.4" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.4.cmml"><mi id="S4.E4X.2.1.1.m1.4.4.2.2.2.4.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.4.2.cmml">N</mi><mi id="S4.E4X.2.1.1.m1.4.4.2.2.2.4.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4X.2.1.1.m1.4.4.2.2.2.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.3.cmml">​</mo><mrow id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml"><msup id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">𝐜</mi><mo id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1.cmml">¯</mo></mover><mrow id="S4.E4X.2.1.1.m1.1.1.1.3" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4X.2.1.1.m1.1.1.1.3.1" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E4X.2.1.1.m1.1.1.1.1" xref="S4.E4X.2.1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E4X.2.1.1.m1.1.1.1.3.2" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.cmml">𝐜</mi><mo id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo stretchy="false" id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E4X.2.1.1.m1.4.4.2.2.2.3a" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.3.cmml">​</mo><msup id="S4.E4X.2.1.1.m1.4.4.2.2.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.cmml"><mrow id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.cmml"><msup id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.cmml"><mover accent="true" id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.cmml"><mi id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.2.cmml">𝐜</mi><mo id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.1" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.1.cmml">¯</mo></mover><mrow id="S4.E4X.2.1.1.m1.2.2.1.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E4X.2.1.1.m1.2.2.1.3.1" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.cmml">(</mo><mi id="S4.E4X.2.1.1.m1.2.2.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S4.E4X.2.1.1.m1.2.2.1.3.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.1" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.2" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.2.cmml">𝐜</mi><mo id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.1" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo stretchy="false" id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.3" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4X.2.1.1.m1.4b"><apply id="S4.E4X.2.1.1.m1.4.4.cmml" xref="S4.E4X.2.1.1.m1.4.4"><eq id="S4.E4X.2.1.1.m1.4.4.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.3"></eq><apply id="S4.E4X.2.1.1.m1.4.4.4.cmml" xref="S4.E4X.2.1.1.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.4.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.4">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.4.4.4.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.2">Σ</ci><ci id="S4.E4X.2.1.1.m1.4.4.4.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.4.3">𝐵</ci></apply><apply id="S4.E4X.2.1.1.m1.4.4.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2"><times id="S4.E4X.2.1.1.m1.4.4.2.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.3"></times><apply id="S4.E4X.2.1.1.m1.4.4.2.4.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4"><divide id="S4.E4X.2.1.1.m1.4.4.2.4.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4"></divide><cn type="integer" id="S4.E4X.2.1.1.m1.4.4.2.4.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.2">1</cn><apply id="S4.E4X.2.1.1.m1.4.4.2.4.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3"><apply id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1">superscript</csymbol><apply id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1">subscript</csymbol><sum id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.2"></sum><apply id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3"><eq id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.1"></eq><ci id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E4X.2.1.1.m1.4.4.2.4.3.1.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.1.3">𝐾</ci></apply><apply id="S4.E4X.2.1.1.m1.4.4.2.4.3.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.4.3.2.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.2">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.4.4.2.4.3.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.2.2">𝑁</ci><ci id="S4.E4X.2.1.1.m1.4.4.2.4.3.2.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.4.3.2.3">𝑖</ci></apply></apply></apply><apply id="S4.E4X.2.1.1.m1.4.4.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2"><apply id="S4.E4X.2.1.1.m1.4.4.2.2.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.2.3.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3">superscript</csymbol><apply id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3">subscript</csymbol><sum id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.2"></sum><apply id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3"><eq id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.1"></eq><ci id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E4X.2.1.1.m1.4.4.2.2.3.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.3.3">𝐾</ci></apply><apply id="S4.E4X.2.1.1.m1.4.4.2.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2"><times id="S4.E4X.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.3"></times><apply id="S4.E4X.2.1.1.m1.4.4.2.2.2.4.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.4"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.2.2.4.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.4">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.4.4.2.2.2.4.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.4.2">𝑁</ci><ci id="S4.E4X.2.1.1.m1.4.4.2.2.2.4.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.4.3">𝑖</ci></apply><apply id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1"><minus id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.1"></minus><apply id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2"><ci id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.1">¯</ci><ci id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.2.2.2">𝐜</ci></apply><ci id="S4.E4X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3"><ci id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.1">¯</ci><ci id="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.E4X.2.1.1.m1.3.3.1.1.1.1.1.1.3.2">𝐜</ci></apply></apply><apply id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2">superscript</csymbol><apply id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1"><minus id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.1"></minus><apply id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2">superscript</csymbol><apply id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2"><ci id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.1">¯</ci><ci id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.2.2.2">𝐜</ci></apply><ci id="S4.E4X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3"><ci id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.1">¯</ci><ci id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.1.1.1.3.2">𝐜</ci></apply></apply><ci id="S4.E4X.2.1.1.m1.4.4.2.2.2.2.3.cmml" xref="S4.E4X.2.1.1.m1.4.4.2.2.2.2.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4X.2.1.1.m1.4c">\displaystyle\Sigma_{B}=\frac{1}{\sum_{i=1}^{K}N_{i}}\sum_{i=1}^{K}N_{i}(\bar{\mathbf{c}}^{(i)}-\bar{\mathbf{c}})(\bar{\mathbf{c}}^{(i)}-\bar{\mathbf{c}})^{T}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p1.6" class="ltx_p">Eq.<a href="#S4.E4" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> is the between-client scatter matrix that measures the scatters of the mean across clients. To find the <math id="S4.SS1.p1.4.m1.1" class="ltx_Math" alttext="\mathbf{P}^{*}" display="inline"><semantics id="S4.SS1.p1.4.m1.1a"><msup id="S4.SS1.p1.4.m1.1.1" xref="S4.SS1.p1.4.m1.1.1.cmml"><mi id="S4.SS1.p1.4.m1.1.1.2" xref="S4.SS1.p1.4.m1.1.1.2.cmml">𝐏</mi><mo id="S4.SS1.p1.4.m1.1.1.3" xref="S4.SS1.p1.4.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m1.1b"><apply id="S4.SS1.p1.4.m1.1.1.cmml" xref="S4.SS1.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m1.1.1.1.cmml" xref="S4.SS1.p1.4.m1.1.1">superscript</csymbol><ci id="S4.SS1.p1.4.m1.1.1.2.cmml" xref="S4.SS1.p1.4.m1.1.1.2">𝐏</ci><times id="S4.SS1.p1.4.m1.1.1.3.cmml" xref="S4.SS1.p1.4.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m1.1c">\mathbf{P}^{*}</annotation></semantics></math> is to find the directions that minimize <math id="S4.SS1.p1.5.m2.1" class="ltx_Math" alttext="\Sigma_{W}" display="inline"><semantics id="S4.SS1.p1.5.m2.1a"><msub id="S4.SS1.p1.5.m2.1.1" xref="S4.SS1.p1.5.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p1.5.m2.1.1.2" xref="S4.SS1.p1.5.m2.1.1.2.cmml">Σ</mi><mi id="S4.SS1.p1.5.m2.1.1.3" xref="S4.SS1.p1.5.m2.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m2.1b"><apply id="S4.SS1.p1.5.m2.1.1.cmml" xref="S4.SS1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m2.1.1.1.cmml" xref="S4.SS1.p1.5.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m2.1.1.2.cmml" xref="S4.SS1.p1.5.m2.1.1.2">Σ</ci><ci id="S4.SS1.p1.5.m2.1.1.3.cmml" xref="S4.SS1.p1.5.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m2.1c">\Sigma_{W}</annotation></semantics></math> and maximize <math id="S4.SS1.p1.6.m3.1" class="ltx_Math" alttext="\Sigma_{B}" display="inline"><semantics id="S4.SS1.p1.6.m3.1a"><msub id="S4.SS1.p1.6.m3.1.1" xref="S4.SS1.p1.6.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p1.6.m3.1.1.2" xref="S4.SS1.p1.6.m3.1.1.2.cmml">Σ</mi><mi id="S4.SS1.p1.6.m3.1.1.3" xref="S4.SS1.p1.6.m3.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m3.1b"><apply id="S4.SS1.p1.6.m3.1.1.cmml" xref="S4.SS1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m3.1.1.1.cmml" xref="S4.SS1.p1.6.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m3.1.1.2.cmml" xref="S4.SS1.p1.6.m3.1.1.2">Σ</ci><ci id="S4.SS1.p1.6.m3.1.1.3.cmml" xref="S4.SS1.p1.6.m3.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m3.1c">\Sigma_{B}</annotation></semantics></math>. For example, it can be formulated as the Linear Discriminate Analysis (LDA) problem below</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.2" class="ltx_Math" alttext="\mathbf{P}^{*}=\arg\max_{\mathbf{P}}J(\mathbf{P})=\arg\max_{\mathbf{P}}\text{Tr}(\Sigma_{W}^{-1}\Sigma_{B})" display="block"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><msup id="S4.E5.m1.2.2.3" xref="S4.E5.m1.2.2.3.cmml"><mi id="S4.E5.m1.2.2.3.2" xref="S4.E5.m1.2.2.3.2.cmml">𝐏</mi><mo id="S4.E5.m1.2.2.3.3" xref="S4.E5.m1.2.2.3.3.cmml">∗</mo></msup><mo id="S4.E5.m1.2.2.4" xref="S4.E5.m1.2.2.4.cmml">=</mo><mrow id="S4.E5.m1.2.2.5" xref="S4.E5.m1.2.2.5.cmml"><mrow id="S4.E5.m1.2.2.5.2" xref="S4.E5.m1.2.2.5.2.cmml"><mi id="S4.E5.m1.2.2.5.2.1" xref="S4.E5.m1.2.2.5.2.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E5.m1.2.2.5.2a" xref="S4.E5.m1.2.2.5.2.cmml">⁡</mo><mrow id="S4.E5.m1.2.2.5.2.2" xref="S4.E5.m1.2.2.5.2.2.cmml"><munder id="S4.E5.m1.2.2.5.2.2.1" xref="S4.E5.m1.2.2.5.2.2.1.cmml"><mi id="S4.E5.m1.2.2.5.2.2.1.2" xref="S4.E5.m1.2.2.5.2.2.1.2.cmml">max</mi><mi id="S4.E5.m1.2.2.5.2.2.1.3" xref="S4.E5.m1.2.2.5.2.2.1.3.cmml">𝐏</mi></munder><mo lspace="0.167em" id="S4.E5.m1.2.2.5.2.2a" xref="S4.E5.m1.2.2.5.2.2.cmml">⁡</mo><mi id="S4.E5.m1.2.2.5.2.2.2" xref="S4.E5.m1.2.2.5.2.2.2.cmml">J</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.5.1" xref="S4.E5.m1.2.2.5.1.cmml">​</mo><mrow id="S4.E5.m1.2.2.5.3.2" xref="S4.E5.m1.2.2.5.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.5.3.2.1" xref="S4.E5.m1.2.2.5.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">𝐏</mi><mo stretchy="false" id="S4.E5.m1.2.2.5.3.2.2" xref="S4.E5.m1.2.2.5.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.2.2.6" xref="S4.E5.m1.2.2.6.cmml">=</mo><mrow id="S4.E5.m1.2.2.1" xref="S4.E5.m1.2.2.1.cmml"><mrow id="S4.E5.m1.2.2.1.3" xref="S4.E5.m1.2.2.1.3.cmml"><mi id="S4.E5.m1.2.2.1.3.1" xref="S4.E5.m1.2.2.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E5.m1.2.2.1.3a" xref="S4.E5.m1.2.2.1.3.cmml">⁡</mo><mrow id="S4.E5.m1.2.2.1.3.2" xref="S4.E5.m1.2.2.1.3.2.cmml"><munder id="S4.E5.m1.2.2.1.3.2.1" xref="S4.E5.m1.2.2.1.3.2.1.cmml"><mi id="S4.E5.m1.2.2.1.3.2.1.2" xref="S4.E5.m1.2.2.1.3.2.1.2.cmml">max</mi><mi id="S4.E5.m1.2.2.1.3.2.1.3" xref="S4.E5.m1.2.2.1.3.2.1.3.cmml">𝐏</mi></munder><mo lspace="0.167em" id="S4.E5.m1.2.2.1.3.2a" xref="S4.E5.m1.2.2.1.3.2.cmml">⁡</mo><mtext id="S4.E5.m1.2.2.1.3.2.2" xref="S4.E5.m1.2.2.1.3.2.2a.cmml">Tr</mtext></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.2" xref="S4.E5.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.2.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><msubsup id="S4.E5.m1.2.2.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E5.m1.2.2.1.1.1.1.2.2.2" xref="S4.E5.m1.2.2.1.1.1.1.2.2.2.cmml">Σ</mi><mi id="S4.E5.m1.2.2.1.1.1.1.2.2.3" xref="S4.E5.m1.2.2.1.1.1.1.2.2.3.cmml">W</mi><mrow id="S4.E5.m1.2.2.1.1.1.1.2.3" xref="S4.E5.m1.2.2.1.1.1.1.2.3.cmml"><mo id="S4.E5.m1.2.2.1.1.1.1.2.3a" xref="S4.E5.m1.2.2.1.1.1.1.2.3.cmml">−</mo><mn id="S4.E5.m1.2.2.1.1.1.1.2.3.2" xref="S4.E5.m1.2.2.1.1.1.1.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.cmml">​</mo><msub id="S4.E5.m1.2.2.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E5.m1.2.2.1.1.1.1.3.2" xref="S4.E5.m1.2.2.1.1.1.1.3.2.cmml">Σ</mi><mi id="S4.E5.m1.2.2.1.1.1.1.3.3" xref="S4.E5.m1.2.2.1.1.1.1.3.3.cmml">B</mi></msub></mrow><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><and id="S4.E5.m1.2.2a.cmml" xref="S4.E5.m1.2.2"></and><apply id="S4.E5.m1.2.2b.cmml" xref="S4.E5.m1.2.2"><eq id="S4.E5.m1.2.2.4.cmml" xref="S4.E5.m1.2.2.4"></eq><apply id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.1.cmml" xref="S4.E5.m1.2.2.3">superscript</csymbol><ci id="S4.E5.m1.2.2.3.2.cmml" xref="S4.E5.m1.2.2.3.2">𝐏</ci><times id="S4.E5.m1.2.2.3.3.cmml" xref="S4.E5.m1.2.2.3.3"></times></apply><apply id="S4.E5.m1.2.2.5.cmml" xref="S4.E5.m1.2.2.5"><times id="S4.E5.m1.2.2.5.1.cmml" xref="S4.E5.m1.2.2.5.1"></times><apply id="S4.E5.m1.2.2.5.2.cmml" xref="S4.E5.m1.2.2.5.2"><arg id="S4.E5.m1.2.2.5.2.1.cmml" xref="S4.E5.m1.2.2.5.2.1"></arg><apply id="S4.E5.m1.2.2.5.2.2.cmml" xref="S4.E5.m1.2.2.5.2.2"><apply id="S4.E5.m1.2.2.5.2.2.1.cmml" xref="S4.E5.m1.2.2.5.2.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.5.2.2.1.1.cmml" xref="S4.E5.m1.2.2.5.2.2.1">subscript</csymbol><max id="S4.E5.m1.2.2.5.2.2.1.2.cmml" xref="S4.E5.m1.2.2.5.2.2.1.2"></max><ci id="S4.E5.m1.2.2.5.2.2.1.3.cmml" xref="S4.E5.m1.2.2.5.2.2.1.3">𝐏</ci></apply><ci id="S4.E5.m1.2.2.5.2.2.2.cmml" xref="S4.E5.m1.2.2.5.2.2.2">𝐽</ci></apply></apply><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝐏</ci></apply></apply><apply id="S4.E5.m1.2.2c.cmml" xref="S4.E5.m1.2.2"><eq id="S4.E5.m1.2.2.6.cmml" xref="S4.E5.m1.2.2.6"></eq><share href="#S4.E5.m1.2.2.5.cmml" id="S4.E5.m1.2.2d.cmml" xref="S4.E5.m1.2.2"></share><apply id="S4.E5.m1.2.2.1.cmml" xref="S4.E5.m1.2.2.1"><times id="S4.E5.m1.2.2.1.2.cmml" xref="S4.E5.m1.2.2.1.2"></times><apply id="S4.E5.m1.2.2.1.3.cmml" xref="S4.E5.m1.2.2.1.3"><arg id="S4.E5.m1.2.2.1.3.1.cmml" xref="S4.E5.m1.2.2.1.3.1"></arg><apply id="S4.E5.m1.2.2.1.3.2.cmml" xref="S4.E5.m1.2.2.1.3.2"><apply id="S4.E5.m1.2.2.1.3.2.1.cmml" xref="S4.E5.m1.2.2.1.3.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.3.2.1.1.cmml" xref="S4.E5.m1.2.2.1.3.2.1">subscript</csymbol><max id="S4.E5.m1.2.2.1.3.2.1.2.cmml" xref="S4.E5.m1.2.2.1.3.2.1.2"></max><ci id="S4.E5.m1.2.2.1.3.2.1.3.cmml" xref="S4.E5.m1.2.2.1.3.2.1.3">𝐏</ci></apply><ci id="S4.E5.m1.2.2.1.3.2.2a.cmml" xref="S4.E5.m1.2.2.1.3.2.2"><mtext id="S4.E5.m1.2.2.1.3.2.2.cmml" xref="S4.E5.m1.2.2.1.3.2.2">Tr</mtext></ci></apply></apply><apply id="S4.E5.m1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1"><times id="S4.E5.m1.2.2.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1"></times><apply id="S4.E5.m1.2.2.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S4.E5.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2.2.2">Σ</ci><ci id="S4.E5.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2.2.3">𝑊</ci></apply><apply id="S4.E5.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2.3"><minus id="S4.E5.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2.3"></minus><cn type="integer" id="S4.E5.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2.3.2">1</cn></apply></apply><apply id="S4.E5.m1.2.2.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3.2">Σ</ci><ci id="S4.E5.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3.3">𝐵</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\mathbf{P}^{*}=\arg\max_{\mathbf{P}}J(\mathbf{P})=\arg\max_{\mathbf{P}}\text{Tr}(\Sigma_{W}^{-1}\Sigma_{B})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.7" class="ltx_p">where <math id="S4.SS1.p1.7.m1.1" class="ltx_Math" alttext="\text{Tr}(\cdot)" display="inline"><semantics id="S4.SS1.p1.7.m1.1a"><mrow id="S4.SS1.p1.7.m1.1.2" xref="S4.SS1.p1.7.m1.1.2.cmml"><mtext id="S4.SS1.p1.7.m1.1.2.2" xref="S4.SS1.p1.7.m1.1.2.2a.cmml">Tr</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.p1.7.m1.1.2.1" xref="S4.SS1.p1.7.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.7.m1.1.2.3.2" xref="S4.SS1.p1.7.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.7.m1.1.2.3.2.1" xref="S4.SS1.p1.7.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.7.m1.1.1" xref="S4.SS1.p1.7.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.7.m1.1.2.3.2.2" xref="S4.SS1.p1.7.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m1.1b"><apply id="S4.SS1.p1.7.m1.1.2.cmml" xref="S4.SS1.p1.7.m1.1.2"><times id="S4.SS1.p1.7.m1.1.2.1.cmml" xref="S4.SS1.p1.7.m1.1.2.1"></times><ci id="S4.SS1.p1.7.m1.1.2.2a.cmml" xref="S4.SS1.p1.7.m1.1.2.2"><mtext id="S4.SS1.p1.7.m1.1.2.2.cmml" xref="S4.SS1.p1.7.m1.1.2.2">Tr</mtext></ci><ci id="S4.SS1.p1.7.m1.1.1.cmml" xref="S4.SS1.p1.7.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m1.1c">\text{Tr}(\cdot)</annotation></semantics></math> denotes the trace of the matrix.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Then, bring Eq.<a href="#S4.E5" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> into the FL framework, the overall learning task is formulated as a bi-level optimization problem</p>
<table id="S4.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\omega_{h}^{*},\omega_{g}^{*}{}" display="inline"><semantics id="S4.E6X.2.1.1.m1.2a"><mrow id="S4.E6X.2.1.1.m1.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.3.cmml"><msubsup id="S4.E6X.2.1.1.m1.1.1.1.1" xref="S4.E6X.2.1.1.m1.1.1.1.1.cmml"><mi id="S4.E6X.2.1.1.m1.1.1.1.1.2.2" xref="S4.E6X.2.1.1.m1.1.1.1.1.2.2.cmml">ω</mi><mi id="S4.E6X.2.1.1.m1.1.1.1.1.2.3" xref="S4.E6X.2.1.1.m1.1.1.1.1.2.3.cmml">h</mi><mo id="S4.E6X.2.1.1.m1.1.1.1.1.3" xref="S4.E6X.2.1.1.m1.1.1.1.1.3.cmml">∗</mo></msubsup><mo id="S4.E6X.2.1.1.m1.2.2.2.3" xref="S4.E6X.2.1.1.m1.2.2.3.cmml">,</mo><msubsup id="S4.E6X.2.1.1.m1.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.2.2.cmml"><mi id="S4.E6X.2.1.1.m1.2.2.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.cmml">ω</mi><mi id="S4.E6X.2.1.1.m1.2.2.2.2.2.3" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.3.cmml">g</mi><mo id="S4.E6X.2.1.1.m1.2.2.2.2.3" xref="S4.E6X.2.1.1.m1.2.2.2.2.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.2.1.1.m1.2b"><list id="S4.E6X.2.1.1.m1.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2"><apply id="S4.E6X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="S4.E6X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.E6X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.2.2">𝜔</ci><ci id="S4.E6X.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.2.3">ℎ</ci></apply><times id="S4.E6X.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.3"></times></apply><apply id="S4.E6X.2.1.1.m1.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.2.2.2.2.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2">superscript</csymbol><apply id="S4.E6X.2.1.1.m1.2.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2">subscript</csymbol><ci id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2">𝜔</ci><ci id="S4.E6X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.3">𝑔</ci></apply><times id="S4.E6X.2.1.1.m1.2.2.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.2.1.1.m1.2c">\displaystyle\omega_{h}^{*},\omega_{g}^{*}{}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle=\arg\min_{\omega_{h},\omega_{g}}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(\omega_{h},\omega_{g})" display="inline"><semantics id="S4.E6X.3.2.2.m1.4a"><mrow id="S4.E6X.3.2.2.m1.4.4" xref="S4.E6X.3.2.2.m1.4.4.cmml"><mi id="S4.E6X.3.2.2.m1.4.4.4" xref="S4.E6X.3.2.2.m1.4.4.4.cmml"></mi><mo id="S4.E6X.3.2.2.m1.4.4.3" xref="S4.E6X.3.2.2.m1.4.4.3.cmml">=</mo><mrow id="S4.E6X.3.2.2.m1.4.4.2" xref="S4.E6X.3.2.2.m1.4.4.2.cmml"><mrow id="S4.E6X.3.2.2.m1.4.4.2.4" xref="S4.E6X.3.2.2.m1.4.4.2.4.cmml"><mi id="S4.E6X.3.2.2.m1.4.4.2.4.1" xref="S4.E6X.3.2.2.m1.4.4.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E6X.3.2.2.m1.4.4.2.4a" xref="S4.E6X.3.2.2.m1.4.4.2.4.cmml">⁡</mo><munder id="S4.E6X.3.2.2.m1.4.4.2.4.2" xref="S4.E6X.3.2.2.m1.4.4.2.4.2.cmml"><mi id="S4.E6X.3.2.2.m1.4.4.2.4.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.4.2.2.cmml">min</mi><mrow id="S4.E6X.3.2.2.m1.2.2.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.3.cmml"><msub id="S4.E6X.3.2.2.m1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.2" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.2.cmml">ω</mi><mi id="S4.E6X.3.2.2.m1.1.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="S4.E6X.3.2.2.m1.2.2.2.2.3" xref="S4.E6X.3.2.2.m1.2.2.2.3.cmml">,</mo><msub id="S4.E6X.3.2.2.m1.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.cmml"><mi id="S4.E6X.3.2.2.m1.2.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2.cmml">ω</mi><mi id="S4.E6X.3.2.2.m1.2.2.2.2.2.3" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.3.cmml">g</mi></msub></mrow></munder></mrow><mo lspace="0.167em" rspace="0em" id="S4.E6X.3.2.2.m1.4.4.2.3" xref="S4.E6X.3.2.2.m1.4.4.2.3.cmml">​</mo><mrow id="S4.E6X.3.2.2.m1.4.4.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.cmml"><mstyle displaystyle="true" id="S4.E6X.3.2.2.m1.4.4.2.2.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.cmml"><munderover id="S4.E6X.3.2.2.m1.4.4.2.2.3a" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.cmml"><mo movablelimits="false" id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.cmml"><mi id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.2.cmml">i</mi><mo id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.1" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E6X.3.2.2.m1.4.4.2.2.3.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S4.E6X.3.2.2.m1.4.4.2.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.cmml"><msub id="S4.E6X.3.2.2.m1.4.4.2.2.2.4" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.4.cmml"><mi id="S4.E6X.3.2.2.m1.4.4.2.2.2.4.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.4.2.cmml">α</mi><mi id="S4.E6X.3.2.2.m1.4.4.2.2.2.4.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.4.4.2.2.2.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.3.cmml">​</mo><msub id="S4.E6X.3.2.2.m1.4.4.2.2.2.5" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6X.3.2.2.m1.4.4.2.2.2.5.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.5.2.cmml">ℒ</mi><mi id="S4.E6X.3.2.2.m1.4.4.2.2.2.5.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.4.4.2.2.2.3a" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.3.cmml">​</mo><mrow id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.3.cmml">(</mo><msub id="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">h</mi></msub><mo id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.4" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.3.cmml">,</mo><msub id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.cmml"><mi id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.2.cmml">ω</mi><mi id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.5" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.3.2.2.m1.4b"><apply id="S4.E6X.3.2.2.m1.4.4.cmml" xref="S4.E6X.3.2.2.m1.4.4"><eq id="S4.E6X.3.2.2.m1.4.4.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.3"></eq><csymbol cd="latexml" id="S4.E6X.3.2.2.m1.4.4.4.cmml" xref="S4.E6X.3.2.2.m1.4.4.4">absent</csymbol><apply id="S4.E6X.3.2.2.m1.4.4.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2"><times id="S4.E6X.3.2.2.m1.4.4.2.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.3"></times><apply id="S4.E6X.3.2.2.m1.4.4.2.4.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.4"><arg id="S4.E6X.3.2.2.m1.4.4.2.4.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.4.1"></arg><apply id="S4.E6X.3.2.2.m1.4.4.2.4.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.4.2"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.4.4.2.4.2.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.4.2">subscript</csymbol><min id="S4.E6X.3.2.2.m1.4.4.2.4.2.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.4.2.2"></min><list id="S4.E6X.3.2.2.m1.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2"><apply id="S4.E6X.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.2">𝜔</ci><ci id="S4.E6X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1.1.3">ℎ</ci></apply><apply id="S4.E6X.3.2.2.m1.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.2.2.2.2.2.1.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.2">𝜔</ci><ci id="S4.E6X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2.2.3">𝑔</ci></apply></list></apply></apply><apply id="S4.E6X.3.2.2.m1.4.4.2.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2"><apply id="S4.E6X.3.2.2.m1.4.4.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.4.4.2.2.3.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3">superscript</csymbol><apply id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3">subscript</csymbol><sum id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.2"></sum><apply id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3"><eq id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.1"></eq><ci id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E6X.3.2.2.m1.4.4.2.2.3.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.3.3">𝐾</ci></apply><apply id="S4.E6X.3.2.2.m1.4.4.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2"><times id="S4.E6X.3.2.2.m1.4.4.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.3"></times><apply id="S4.E6X.3.2.2.m1.4.4.2.2.2.4.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.4"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.4.4.2.2.2.4.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.4">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.4.4.2.2.2.4.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.4.2">𝛼</ci><ci id="S4.E6X.3.2.2.m1.4.4.2.2.2.4.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.4.3">𝑖</ci></apply><apply id="S4.E6X.3.2.2.m1.4.4.2.2.2.5.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.5"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.4.4.2.2.2.5.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.5">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.4.4.2.2.2.5.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.5.2">ℒ</ci><ci id="S4.E6X.3.2.2.m1.4.4.2.2.2.5.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.5.3">𝑖</ci></apply><interval closure="open" id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2"><apply id="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2">𝜔</ci><ci id="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.3">ℎ</ci></apply><apply id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.2">𝜔</ci><ci id="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.2.2.2.2.3">𝑔</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.3.2.2.m1.4c">\displaystyle=\arg\min_{\omega_{h},\omega_{g}}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(\omega_{h},\omega_{g})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr id="S4.E6Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle s.t.{}" display="inline"><semantics id="S4.E6Xa.2.1.1.m1.3a"><mrow id="S4.E6Xa.2.1.1.m1.3.3.1"><mrow id="S4.E6Xa.2.1.1.m1.3.3.1.1.2" xref="S4.E6Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S4.E6Xa.2.1.1.m1.1.1" xref="S4.E6Xa.2.1.1.m1.1.1.cmml">s</mi><mo lspace="0em" rspace="0.167em" id="S4.E6Xa.2.1.1.m1.3.3.1.1.2.1" xref="S4.E6Xa.2.1.1.m1.3.3.1.1.1a.cmml">.</mo><mi id="S4.E6Xa.2.1.1.m1.2.2" xref="S4.E6Xa.2.1.1.m1.2.2.cmml">t</mi></mrow><mo lspace="0em" id="S4.E6Xa.2.1.1.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6Xa.2.1.1.m1.3b"><apply id="S4.E6Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E6Xa.2.1.1.m1.3.3.1.1.1a.cmml" xref="S4.E6Xa.2.1.1.m1.3.3.1.1.2.1">formulae-sequence</csymbol><ci id="S4.E6Xa.2.1.1.m1.1.1.cmml" xref="S4.E6Xa.2.1.1.m1.1.1">𝑠</ci><ci id="S4.E6Xa.2.1.1.m1.2.2.cmml" xref="S4.E6Xa.2.1.1.m1.2.2">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6Xa.2.1.1.m1.3c">\displaystyle s.t.{}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{P}^{*}=\arg\max_{\mathbf{P}}J(\mathbf{P})" display="inline"><semantics id="S4.E6Xa.3.2.2.m1.1a"><mrow id="S4.E6Xa.3.2.2.m1.1.2" xref="S4.E6Xa.3.2.2.m1.1.2.cmml"><msup id="S4.E6Xa.3.2.2.m1.1.2.2" xref="S4.E6Xa.3.2.2.m1.1.2.2.cmml"><mi id="S4.E6Xa.3.2.2.m1.1.2.2.2" xref="S4.E6Xa.3.2.2.m1.1.2.2.2.cmml">𝐏</mi><mo id="S4.E6Xa.3.2.2.m1.1.2.2.3" xref="S4.E6Xa.3.2.2.m1.1.2.2.3.cmml">∗</mo></msup><mo id="S4.E6Xa.3.2.2.m1.1.2.1" xref="S4.E6Xa.3.2.2.m1.1.2.1.cmml">=</mo><mrow id="S4.E6Xa.3.2.2.m1.1.2.3" xref="S4.E6Xa.3.2.2.m1.1.2.3.cmml"><mrow id="S4.E6Xa.3.2.2.m1.1.2.3.2" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.cmml"><mi id="S4.E6Xa.3.2.2.m1.1.2.3.2.1" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E6Xa.3.2.2.m1.1.2.3.2a" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.cmml">⁡</mo><mrow id="S4.E6Xa.3.2.2.m1.1.2.3.2.2" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.cmml"><munder id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.cmml"><mi id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.2" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.2.cmml">max</mi><mi id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.3" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.3.cmml">𝐏</mi></munder><mo lspace="0.167em" id="S4.E6Xa.3.2.2.m1.1.2.3.2.2a" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.cmml">⁡</mo><mi id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.2" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.2.cmml">J</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E6Xa.3.2.2.m1.1.2.3.1" xref="S4.E6Xa.3.2.2.m1.1.2.3.1.cmml">​</mo><mrow id="S4.E6Xa.3.2.2.m1.1.2.3.3.2" xref="S4.E6Xa.3.2.2.m1.1.2.3.cmml"><mo stretchy="false" id="S4.E6Xa.3.2.2.m1.1.2.3.3.2.1" xref="S4.E6Xa.3.2.2.m1.1.2.3.cmml">(</mo><mi id="S4.E6Xa.3.2.2.m1.1.1" xref="S4.E6Xa.3.2.2.m1.1.1.cmml">𝐏</mi><mo stretchy="false" id="S4.E6Xa.3.2.2.m1.1.2.3.3.2.2" xref="S4.E6Xa.3.2.2.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6Xa.3.2.2.m1.1b"><apply id="S4.E6Xa.3.2.2.m1.1.2.cmml" xref="S4.E6Xa.3.2.2.m1.1.2"><eq id="S4.E6Xa.3.2.2.m1.1.2.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.1"></eq><apply id="S4.E6Xa.3.2.2.m1.1.2.2.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E6Xa.3.2.2.m1.1.2.2.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.2">superscript</csymbol><ci id="S4.E6Xa.3.2.2.m1.1.2.2.2.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.2.2">𝐏</ci><times id="S4.E6Xa.3.2.2.m1.1.2.2.3.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.2.3"></times></apply><apply id="S4.E6Xa.3.2.2.m1.1.2.3.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3"><times id="S4.E6Xa.3.2.2.m1.1.2.3.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.1"></times><apply id="S4.E6Xa.3.2.2.m1.1.2.3.2.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2"><arg id="S4.E6Xa.3.2.2.m1.1.2.3.2.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.1"></arg><apply id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2"><apply id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1"><csymbol cd="ambiguous" id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1">subscript</csymbol><max id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.2.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.2"></max><ci id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.3.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.1.3">𝐏</ci></apply><ci id="S4.E6Xa.3.2.2.m1.1.2.3.2.2.2.cmml" xref="S4.E6Xa.3.2.2.m1.1.2.3.2.2.2">𝐽</ci></apply></apply><ci id="S4.E6Xa.3.2.2.m1.1.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.1">𝐏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6Xa.3.2.2.m1.1c">\displaystyle\mathbf{P}^{*}=\arg\max_{\mathbf{P}}J(\mathbf{P})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p2.2" class="ltx_p">where</p>
<table id="S4.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{i}=\sum_{j=1}^{N_{i}}l(g(\mathbf{P}^{T}h(\mathbf{x}_{j}^{(i)};\omega_{h});\omega_{g}),y_{j}^{(i)})" display="inline"><semantics id="S4.E7X.2.1.1.m1.4a"><mrow id="S4.E7X.2.1.1.m1.4.4" xref="S4.E7X.2.1.1.m1.4.4.cmml"><msub id="S4.E7X.2.1.1.m1.4.4.4" xref="S4.E7X.2.1.1.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7X.2.1.1.m1.4.4.4.2" xref="S4.E7X.2.1.1.m1.4.4.4.2.cmml">ℒ</mi><mi id="S4.E7X.2.1.1.m1.4.4.4.3" xref="S4.E7X.2.1.1.m1.4.4.4.3.cmml">i</mi></msub><mo id="S4.E7X.2.1.1.m1.4.4.3" xref="S4.E7X.2.1.1.m1.4.4.3.cmml">=</mo><mrow id="S4.E7X.2.1.1.m1.4.4.2" xref="S4.E7X.2.1.1.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S4.E7X.2.1.1.m1.4.4.2.3" xref="S4.E7X.2.1.1.m1.4.4.2.3.cmml"><munderover id="S4.E7X.2.1.1.m1.4.4.2.3a" xref="S4.E7X.2.1.1.m1.4.4.2.3.cmml"><mo movablelimits="false" id="S4.E7X.2.1.1.m1.4.4.2.3.2.2" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S4.E7X.2.1.1.m1.4.4.2.3.2.3" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3.cmml"><mi id="S4.E7X.2.1.1.m1.4.4.2.3.2.3.2" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3.2.cmml">j</mi><mo id="S4.E7X.2.1.1.m1.4.4.2.3.2.3.1" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3.1.cmml">=</mo><mn id="S4.E7X.2.1.1.m1.4.4.2.3.2.3.3" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3.3.cmml">1</mn></mrow><msub id="S4.E7X.2.1.1.m1.4.4.2.3.3" xref="S4.E7X.2.1.1.m1.4.4.2.3.3.cmml"><mi id="S4.E7X.2.1.1.m1.4.4.2.3.3.2" xref="S4.E7X.2.1.1.m1.4.4.2.3.3.2.cmml">N</mi><mi id="S4.E7X.2.1.1.m1.4.4.2.3.3.3" xref="S4.E7X.2.1.1.m1.4.4.2.3.3.3.cmml">i</mi></msub></munderover></mstyle><mrow id="S4.E7X.2.1.1.m1.4.4.2.2" xref="S4.E7X.2.1.1.m1.4.4.2.2.cmml"><mi id="S4.E7X.2.1.1.m1.4.4.2.2.4" xref="S4.E7X.2.1.1.m1.4.4.2.2.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.4.4.2.2.3" xref="S4.E7X.2.1.1.m1.4.4.2.2.3.cmml">​</mo><mrow id="S4.E7X.2.1.1.m1.4.4.2.2.2.2" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.3" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.3.cmml">(</mo><mrow id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.4" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml">𝐏</mi><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.5" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3a" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S4.E7X.2.1.1.m1.1.1.1.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7X.2.1.1.m1.1.1.1.3.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E7X.2.1.1.m1.1.1.1.1" xref="S4.E7X.2.1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E7X.2.1.1.m1.1.1.1.3.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.4" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml">ω</mi><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml">h</mi></msub><mo stretchy="false" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.5" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.4" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">;</mo><msub id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml">ω</mi><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.5" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.4" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.3.cmml">,</mo><msubsup id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.2" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.3" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.3.cmml">j</mi><mrow id="S4.E7X.2.1.1.m1.2.2.1.3" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E7X.2.1.1.m1.2.2.1.3.1" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.cmml">(</mo><mi id="S4.E7X.2.1.1.m1.2.2.1.1" xref="S4.E7X.2.1.1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S4.E7X.2.1.1.m1.2.2.1.3.2" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.5" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7X.2.1.1.m1.4b"><apply id="S4.E7X.2.1.1.m1.4.4.cmml" xref="S4.E7X.2.1.1.m1.4.4"><eq id="S4.E7X.2.1.1.m1.4.4.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.3"></eq><apply id="S4.E7X.2.1.1.m1.4.4.4.cmml" xref="S4.E7X.2.1.1.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.4.4.4.1.cmml" xref="S4.E7X.2.1.1.m1.4.4.4">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.4.4.4.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.4.2">ℒ</ci><ci id="S4.E7X.2.1.1.m1.4.4.4.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.4.3">𝑖</ci></apply><apply id="S4.E7X.2.1.1.m1.4.4.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2"><apply id="S4.E7X.2.1.1.m1.4.4.2.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.4.4.2.3.1.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3">superscript</csymbol><apply id="S4.E7X.2.1.1.m1.4.4.2.3.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.4.4.2.3.2.1.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3">subscript</csymbol><sum id="S4.E7X.2.1.1.m1.4.4.2.3.2.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.2"></sum><apply id="S4.E7X.2.1.1.m1.4.4.2.3.2.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3"><eq id="S4.E7X.2.1.1.m1.4.4.2.3.2.3.1.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3.1"></eq><ci id="S4.E7X.2.1.1.m1.4.4.2.3.2.3.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3.2">𝑗</ci><cn type="integer" id="S4.E7X.2.1.1.m1.4.4.2.3.2.3.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.2.3.3">1</cn></apply></apply><apply id="S4.E7X.2.1.1.m1.4.4.2.3.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.3"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.4.4.2.3.3.1.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.3">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.4.4.2.3.3.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.3.2">𝑁</ci><ci id="S4.E7X.2.1.1.m1.4.4.2.3.3.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.3.3.3">𝑖</ci></apply></apply><apply id="S4.E7X.2.1.1.m1.4.4.2.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2"><times id="S4.E7X.2.1.1.m1.4.4.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.3"></times><ci id="S4.E7X.2.1.1.m1.4.4.2.2.4.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.4">𝑙</ci><interval closure="open" id="S4.E7X.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2"><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1"><times id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.3"></times><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.4.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.4">𝑔</ci><list id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2"><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1"><times id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3"></times><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.2">𝐏</ci><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.4.3">𝑇</ci></apply><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.5">ℎ</ci><list id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2"><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.E7X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2">𝜔</ci><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3">ℎ</ci></apply></list></apply><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.2">𝜔</ci><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.3">𝑔</ci></apply></list></apply><apply id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2">superscript</csymbol><apply id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.4.4.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S4.E7X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E7X.2.1.1.m1.2.2.1.1">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7X.2.1.1.m1.4c">\displaystyle\mathcal{L}_{i}=\sum_{j=1}^{N_{i}}l(g(\mathbf{P}^{T}h(\mathbf{x}_{j}^{(i)};\omega_{h});\omega_{g}),y_{j}^{(i)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p2.3" class="ltx_p">In the next section, we introduce a client-supervised method to optimize the Eq.<span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:def-overall-loss</span> under the FL setting.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Client Supervised Optimization</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.4" class="ltx_p">Theoretically, the optima of Eq.<a href="#S4.E5" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> are eigenvectors of <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\Sigma_{W}^{-1}\Sigma_{B}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><msubsup id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p1.1.m1.1.1.2.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.2.cmml">Σ</mi><mi id="S4.SS2.p1.1.m1.1.1.2.2.3" xref="S4.SS2.p1.1.m1.1.1.2.2.3.cmml">W</mi><mrow id="S4.SS2.p1.1.m1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.2.3.cmml"><mo id="S4.SS2.p1.1.m1.1.1.2.3a" xref="S4.SS2.p1.1.m1.1.1.2.3.cmml">−</mo><mn id="S4.SS2.p1.1.m1.1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.1.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">​</mo><msub id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">Σ</mi><mi id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml">B</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><times id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></times><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2">superscript</csymbol><apply id="S4.SS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.2.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2.2.2">Σ</ci><ci id="S4.SS2.p1.1.m1.1.1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.2.2.3">𝑊</ci></apply><apply id="S4.SS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.2.3"><minus id="S4.SS2.p1.1.m1.1.1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2.3"></minus><cn type="integer" id="S4.SS2.p1.1.m1.1.1.2.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2.3.2">1</cn></apply></apply><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">Σ</ci><ci id="S4.SS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\Sigma_{W}^{-1}\Sigma_{B}</annotation></semantics></math> associated with the <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">r</annotation></semantics></math> largest eigenvalues <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Then, the classification and the alignment tasks in Eq.<span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:def-overall-loss</span> can be optimized alternatively under the conventional FL framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. However, decomposing <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\Sigma_{W}^{-1}\Sigma_{B}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><msubsup id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p1.3.m3.1.1.2.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.2.cmml">Σ</mi><mi id="S4.SS2.p1.3.m3.1.1.2.2.3" xref="S4.SS2.p1.3.m3.1.1.2.2.3.cmml">W</mi><mrow id="S4.SS2.p1.3.m3.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml"><mo id="S4.SS2.p1.3.m3.1.1.2.3a" xref="S4.SS2.p1.3.m3.1.1.2.3.cmml">−</mo><mn id="S4.SS2.p1.3.m3.1.1.2.3.2" xref="S4.SS2.p1.3.m3.1.1.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">​</mo><msub id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"><mi mathvariant="normal" id="S4.SS2.p1.3.m3.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.3.2.cmml">Σ</mi><mi id="S4.SS2.p1.3.m3.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.cmml">B</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><times id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></times><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2">superscript</csymbol><apply id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.2.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2.2">Σ</ci><ci id="S4.SS2.p1.3.m3.1.1.2.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2.3">𝑊</ci></apply><apply id="S4.SS2.p1.3.m3.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3"><minus id="S4.SS2.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3"></minus><cn type="integer" id="S4.SS2.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.3.2">1</cn></apply></apply><apply id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.2">Σ</ci><ci id="S4.SS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\Sigma_{W}^{-1}\Sigma_{B}</annotation></semantics></math> is computationally expensive, and involves collecting the local mean <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\bar{\mathbf{c}}^{(i)}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><msup id="S4.SS2.p1.4.m4.1.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mover accent="true" id="S4.SS2.p1.4.m4.1.2.2" xref="S4.SS2.p1.4.m4.1.2.2.cmml"><mi id="S4.SS2.p1.4.m4.1.2.2.2" xref="S4.SS2.p1.4.m4.1.2.2.2.cmml">𝐜</mi><mo id="S4.SS2.p1.4.m4.1.2.2.1" xref="S4.SS2.p1.4.m4.1.2.2.1.cmml">¯</mo></mover><mrow id="S4.SS2.p1.4.m4.1.1.1.3" xref="S4.SS2.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.3.1" xref="S4.SS2.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p1.4.m4.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.3.2" xref="S4.SS2.p1.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.2.cmml" xref="S4.SS2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2">superscript</csymbol><apply id="S4.SS2.p1.4.m4.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2"><ci id="S4.SS2.p1.4.m4.1.2.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2.2.1">¯</ci><ci id="S4.SS2.p1.4.m4.1.2.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2.2">𝐜</ci></apply><ci id="S4.SS2.p1.4.m4.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\bar{\mathbf{c}}^{(i)}</annotation></semantics></math> which is privacy sensitive. To this end, we propose a client-supervised method that decomposes the learning task in Eq.<a href="#S4.E5" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> into sub-tasks so that clients can optimize it collaboratively.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.5" class="ltx_p">Concretely, previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> show that maximizing Eq.<a href="#S4.E5" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> is equivalent to maximizing <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}\Phi\Sigma_{W}^{-1/2}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><msubsup id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p2.1.m1.1.1.2.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.2.cmml">Σ</mi><mi id="S4.SS2.p2.1.m1.1.1.2.2.3" xref="S4.SS2.p2.1.m1.1.1.2.2.3.cmml">W</mi><mrow id="S4.SS2.p2.1.m1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3.cmml"><mo id="S4.SS2.p2.1.m1.1.1.2.3a" xref="S4.SS2.p2.1.m1.1.1.2.3.cmml">−</mo><mrow id="S4.SS2.p2.1.m1.1.1.2.3.2" xref="S4.SS2.p2.1.m1.1.1.2.3.2.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2.3.2.2" xref="S4.SS2.p2.1.m1.1.1.2.3.2.2.cmml">1</mn><mo id="S4.SS2.p2.1.m1.1.1.2.3.2.1" xref="S4.SS2.p2.1.m1.1.1.2.3.2.1.cmml">/</mo><mn id="S4.SS2.p2.1.m1.1.1.2.3.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.1a" xref="S4.SS2.p2.1.m1.1.1.1.cmml">​</mo><msubsup id="S4.SS2.p2.1.m1.1.1.4" xref="S4.SS2.p2.1.m1.1.1.4.cmml"><mi mathvariant="normal" id="S4.SS2.p2.1.m1.1.1.4.2.2" xref="S4.SS2.p2.1.m1.1.1.4.2.2.cmml">Σ</mi><mi id="S4.SS2.p2.1.m1.1.1.4.2.3" xref="S4.SS2.p2.1.m1.1.1.4.2.3.cmml">W</mi><mrow id="S4.SS2.p2.1.m1.1.1.4.3" xref="S4.SS2.p2.1.m1.1.1.4.3.cmml"><mo id="S4.SS2.p2.1.m1.1.1.4.3a" xref="S4.SS2.p2.1.m1.1.1.4.3.cmml">−</mo><mrow id="S4.SS2.p2.1.m1.1.1.4.3.2" xref="S4.SS2.p2.1.m1.1.1.4.3.2.cmml"><mn id="S4.SS2.p2.1.m1.1.1.4.3.2.2" xref="S4.SS2.p2.1.m1.1.1.4.3.2.2.cmml">1</mn><mo id="S4.SS2.p2.1.m1.1.1.4.3.2.1" xref="S4.SS2.p2.1.m1.1.1.4.3.2.1.cmml">/</mo><mn id="S4.SS2.p2.1.m1.1.1.4.3.2.3" xref="S4.SS2.p2.1.m1.1.1.4.3.2.3.cmml">2</mn></mrow></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></times><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2">superscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2.2">Σ</ci><ci id="S4.SS2.p2.1.m1.1.1.2.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2.3">𝑊</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3"><minus id="S4.SS2.p2.1.m1.1.1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3"></minus><apply id="S4.SS2.p2.1.m1.1.1.2.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3.2"><divide id="S4.SS2.p2.1.m1.1.1.2.3.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3.2.1"></divide><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.3.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3.2.2">1</cn><cn type="integer" id="S4.SS2.p2.1.m1.1.1.2.3.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3.2.3">2</cn></apply></apply></apply><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">Φ</ci><apply id="S4.SS2.p2.1.m1.1.1.4.cmml" xref="S4.SS2.p2.1.m1.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.4.1.cmml" xref="S4.SS2.p2.1.m1.1.1.4">superscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.4.2.cmml" xref="S4.SS2.p2.1.m1.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.4.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.4">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.4.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.4.2.2">Σ</ci><ci id="S4.SS2.p2.1.m1.1.1.4.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.4.2.3">𝑊</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.4.3.cmml" xref="S4.SS2.p2.1.m1.1.1.4.3"><minus id="S4.SS2.p2.1.m1.1.1.4.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.4.3"></minus><apply id="S4.SS2.p2.1.m1.1.1.4.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.4.3.2"><divide id="S4.SS2.p2.1.m1.1.1.4.3.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.4.3.2.1"></divide><cn type="integer" id="S4.SS2.p2.1.m1.1.1.4.3.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.4.3.2.2">1</cn><cn type="integer" id="S4.SS2.p2.1.m1.1.1.4.3.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.4.3.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\Sigma_{W}^{-1/2}\Phi\Sigma_{W}^{-1/2}</annotation></semantics></math>, where <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi mathvariant="normal" id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\Phi</annotation></semantics></math> is an approximation to the eigen system of the global correlation matrix <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\Sigma_{W}+\Sigma_{B}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><msub id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">Σ</mi><mi id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml">W</mi></msub><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">+</mo><msub id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi mathvariant="normal" id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">Σ</mi><mi id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">B</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><plus id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></plus><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">Σ</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">𝑊</ci></apply><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">Σ</ci><ci id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\Sigma_{W}+\Sigma_{B}</annotation></semantics></math>, and both <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msubsup id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.4.m4.1.1.2.2" xref="S4.SS2.p2.4.m4.1.1.2.2.cmml">Σ</mi><mi id="S4.SS2.p2.4.m4.1.1.2.3" xref="S4.SS2.p2.4.m4.1.1.2.3.cmml">W</mi><mrow id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mo id="S4.SS2.p2.4.m4.1.1.3a" xref="S4.SS2.p2.4.m4.1.1.3.cmml">−</mo><mrow id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml"><mn id="S4.SS2.p2.4.m4.1.1.3.2.2" xref="S4.SS2.p2.4.m4.1.1.3.2.2.cmml">1</mn><mo id="S4.SS2.p2.4.m4.1.1.3.2.1" xref="S4.SS2.p2.4.m4.1.1.3.2.1.cmml">/</mo><mn id="S4.SS2.p2.4.m4.1.1.3.2.3" xref="S4.SS2.p2.4.m4.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">superscript</csymbol><apply id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2.2">Σ</ci><ci id="S4.SS2.p2.4.m4.1.1.2.3.cmml" xref="S4.SS2.p2.4.m4.1.1.2.3">𝑊</ci></apply><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><minus id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3"></minus><apply id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2"><divide id="S4.SS2.p2.4.m4.1.1.3.2.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2.1"></divide><cn type="integer" id="S4.SS2.p2.4.m4.1.1.3.2.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2.2">1</cn><cn type="integer" id="S4.SS2.p2.4.m4.1.1.3.2.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math> and <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mi mathvariant="normal" id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\Phi</annotation></semantics></math> can be updated incrementally through the following equations</p>
<table id="S4.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\Sigma_{W}^{-1/2}=\Sigma_{W}^{-1/2}+\eta*(I-\Sigma_{W}^{-1/2}\Sigma_{W}\Sigma_{W}^{-1/2})" display="inline"><semantics id="S4.E8X.2.1.1.m1.1a"><mrow id="S4.E8X.2.1.1.m1.1.1" xref="S4.E8X.2.1.1.m1.1.1.cmml"><msubsup id="S4.E8X.2.1.1.m1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E8X.2.1.1.m1.1.1.3.2.2" xref="S4.E8X.2.1.1.m1.1.1.3.2.2.cmml">Σ</mi><mi id="S4.E8X.2.1.1.m1.1.1.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.3.2.3.cmml">W</mi><mrow id="S4.E8X.2.1.1.m1.1.1.3.3" xref="S4.E8X.2.1.1.m1.1.1.3.3.cmml"><mo id="S4.E8X.2.1.1.m1.1.1.3.3a" xref="S4.E8X.2.1.1.m1.1.1.3.3.cmml">−</mo><mrow id="S4.E8X.2.1.1.m1.1.1.3.3.2" xref="S4.E8X.2.1.1.m1.1.1.3.3.2.cmml"><mn id="S4.E8X.2.1.1.m1.1.1.3.3.2.2" xref="S4.E8X.2.1.1.m1.1.1.3.3.2.2.cmml">1</mn><mo id="S4.E8X.2.1.1.m1.1.1.3.3.2.1" xref="S4.E8X.2.1.1.m1.1.1.3.3.2.1.cmml">/</mo><mn id="S4.E8X.2.1.1.m1.1.1.3.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.3.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo id="S4.E8X.2.1.1.m1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.cmml"><msubsup id="S4.E8X.2.1.1.m1.1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E8X.2.1.1.m1.1.1.1.3.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.3.2.2.cmml">Σ</mi><mi id="S4.E8X.2.1.1.m1.1.1.1.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.3.2.3.cmml">W</mi><mrow id="S4.E8X.2.1.1.m1.1.1.1.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.cmml"><mo id="S4.E8X.2.1.1.m1.1.1.1.3.3a" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.cmml">−</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1.3.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2.cmml"><mn id="S4.E8X.2.1.1.m1.1.1.1.3.3.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2.2.cmml">1</mn><mo id="S4.E8X.2.1.1.m1.1.1.1.3.3.2.1" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2.1.cmml">/</mo><mn id="S4.E8X.2.1.1.m1.1.1.1.3.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo id="S4.E8X.2.1.1.m1.1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.cmml"><mi id="S4.E8X.2.1.1.m1.1.1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E8X.2.1.1.m1.1.1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.2.cmml">∗</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">I</mi><mo id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><msubsup id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">Σ</mi><mi id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.3.cmml">W</mi><mrow id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml"><mo id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3a" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml">−</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.cmml"><mn id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.2.cmml">1</mn><mo id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.1.cmml">/</mo><mn id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">Σ</mi><mi id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">W</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.1a" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.cmml"><mi mathvariant="normal" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.2.cmml">Σ</mi><mi id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.3.cmml">W</mi><mrow id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.cmml"><mo id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3a" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.cmml">−</mo><mrow id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.cmml"><mn id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.2" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.2.cmml">1</mn><mo id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.1.cmml">/</mo><mn id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.3.cmml">2</mn></mrow></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8X.2.1.1.m1.1b"><apply id="S4.E8X.2.1.1.m1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1"><eq id="S4.E8X.2.1.1.m1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.2"></eq><apply id="S4.E8X.2.1.1.m1.1.1.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.3">superscript</csymbol><apply id="S4.E8X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.E8X.2.1.1.m1.1.1.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.2.2">Σ</ci><ci id="S4.E8X.2.1.1.m1.1.1.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.2.3">𝑊</ci></apply><apply id="S4.E8X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.3"><minus id="S4.E8X.2.1.1.m1.1.1.3.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.3"></minus><apply id="S4.E8X.2.1.1.m1.1.1.3.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.3.2"><divide id="S4.E8X.2.1.1.m1.1.1.3.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.3.2.1"></divide><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.3.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.3.2.2">1</cn><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.3.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.3.3.2.3">2</cn></apply></apply></apply><apply id="S4.E8X.2.1.1.m1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1"><plus id="S4.E8X.2.1.1.m1.1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.2"></plus><apply id="S4.E8X.2.1.1.m1.1.1.1.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3">superscript</csymbol><apply id="S4.E8X.2.1.1.m1.1.1.1.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.E8X.2.1.1.m1.1.1.1.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.2.2">Σ</ci><ci id="S4.E8X.2.1.1.m1.1.1.1.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.2.3">𝑊</ci></apply><apply id="S4.E8X.2.1.1.m1.1.1.1.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.3"><minus id="S4.E8X.2.1.1.m1.1.1.1.3.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.3"></minus><apply id="S4.E8X.2.1.1.m1.1.1.1.3.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2"><divide id="S4.E8X.2.1.1.m1.1.1.1.3.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2.1"></divide><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.1.3.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2.2">1</cn><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.1.3.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3.3.2.3">2</cn></apply></apply></apply><apply id="S4.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1"><times id="S4.E8X.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.2"></times><ci id="S4.E8X.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.3">𝜂</ci><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1"><minus id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.2">𝐼</ci><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3"><times id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.1"></times><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.2">Σ</ci><ci id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.3">𝑊</ci></apply><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3"><minus id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3"></minus><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2"><divide id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.1"></divide><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.2">1</cn><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.2.3">2</cn></apply></apply></apply><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2">Σ</ci><ci id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3">𝑊</ci></apply><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4">superscript</csymbol><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.2">Σ</ci><ci id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.3">𝑊</ci></apply><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3"><minus id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3"></minus><apply id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2"><divide id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.1"></divide><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.2">1</cn><cn type="integer" id="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.2.3">2</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8X.2.1.1.m1.1c">\displaystyle\Sigma_{W}^{-1/2}=\Sigma_{W}^{-1/2}+\eta*(I-\Sigma_{W}^{-1/2}\Sigma_{W}\Sigma_{W}^{-1/2})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
</tbody>
</table>
<p id="S4.SS2.p2.10" class="ltx_p">and</p>
<table id="S4.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9X.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\Phi=\Phi+\lambda*(\mathbf{\bar{u}}\mathbf{\bar{u}}^{T}\Phi-\Phi\tau(\Phi\mathbf{\bar{u}}\mathbf{\bar{u}}^{T}\Phi)" display="inline"><semantics id="S4.E9X.2.1.1.m1.1a"><mrow id="S4.E9X.2.1.1.m1.1b"><mi mathvariant="normal" id="S4.E9X.2.1.1.m1.1.1">Φ</mi><mo id="S4.E9X.2.1.1.m1.1.2">=</mo><mi mathvariant="normal" id="S4.E9X.2.1.1.m1.1.3">Φ</mi><mo id="S4.E9X.2.1.1.m1.1.4">+</mo><mi id="S4.E9X.2.1.1.m1.1.5">λ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E9X.2.1.1.m1.1.6">∗</mo><mrow id="S4.E9X.2.1.1.m1.1.7"><mo stretchy="false" id="S4.E9X.2.1.1.m1.1.7.1">(</mo><mover accent="true" id="S4.E9X.2.1.1.m1.1.7.2"><mi id="S4.E9X.2.1.1.m1.1.7.2.2">𝐮</mi><mo id="S4.E9X.2.1.1.m1.1.7.2.1">¯</mo></mover><msup id="S4.E9X.2.1.1.m1.1.7.3"><mover accent="true" id="S4.E9X.2.1.1.m1.1.7.3.2"><mi id="S4.E9X.2.1.1.m1.1.7.3.2.2">𝐮</mi><mo id="S4.E9X.2.1.1.m1.1.7.3.2.1">¯</mo></mover><mi id="S4.E9X.2.1.1.m1.1.7.3.3">T</mi></msup><mi mathvariant="normal" id="S4.E9X.2.1.1.m1.1.7.4">Φ</mi><mo id="S4.E9X.2.1.1.m1.1.7.5">−</mo><mi mathvariant="normal" id="S4.E9X.2.1.1.m1.1.7.6">Φ</mi><mi id="S4.E9X.2.1.1.m1.1.7.7">τ</mi><mrow id="S4.E9X.2.1.1.m1.1.7.8"><mo stretchy="false" id="S4.E9X.2.1.1.m1.1.7.8.1">(</mo><mi mathvariant="normal" id="S4.E9X.2.1.1.m1.1.7.8.2">Φ</mi><mover accent="true" id="S4.E9X.2.1.1.m1.1.7.8.3"><mi id="S4.E9X.2.1.1.m1.1.7.8.3.2">𝐮</mi><mo id="S4.E9X.2.1.1.m1.1.7.8.3.1">¯</mo></mover><msup id="S4.E9X.2.1.1.m1.1.7.8.4"><mover accent="true" id="S4.E9X.2.1.1.m1.1.7.8.4.2"><mi id="S4.E9X.2.1.1.m1.1.7.8.4.2.2">𝐮</mi><mo id="S4.E9X.2.1.1.m1.1.7.8.4.2.1">¯</mo></mover><mi id="S4.E9X.2.1.1.m1.1.7.8.4.3">T</mi></msup><mi mathvariant="normal" id="S4.E9X.2.1.1.m1.1.7.8.5">Φ</mi><mo stretchy="false" id="S4.E9X.2.1.1.m1.1.7.8.6">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E9X.2.1.1.m1.1c">\displaystyle\Phi=\Phi+\lambda*(\mathbf{\bar{u}}\mathbf{\bar{u}}^{T}\Phi-\Phi\tau(\Phi\mathbf{\bar{u}}\mathbf{\bar{u}}^{T}\Phi)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
</tbody>
</table>
<p id="S4.SS2.p2.9" class="ltx_p">where <math id="S4.SS2.p2.6.m1.1" class="ltx_Math" alttext="\mathbf{u}=\Sigma_{W}^{-1/2}\mathbf{\bar{c}}" display="inline"><semantics id="S4.SS2.p2.6.m1.1a"><mrow id="S4.SS2.p2.6.m1.1.1" xref="S4.SS2.p2.6.m1.1.1.cmml"><mi id="S4.SS2.p2.6.m1.1.1.2" xref="S4.SS2.p2.6.m1.1.1.2.cmml">𝐮</mi><mo id="S4.SS2.p2.6.m1.1.1.1" xref="S4.SS2.p2.6.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p2.6.m1.1.1.3" xref="S4.SS2.p2.6.m1.1.1.3.cmml"><msubsup id="S4.SS2.p2.6.m1.1.1.3.2" xref="S4.SS2.p2.6.m1.1.1.3.2.cmml"><mi mathvariant="normal" id="S4.SS2.p2.6.m1.1.1.3.2.2.2" xref="S4.SS2.p2.6.m1.1.1.3.2.2.2.cmml">Σ</mi><mi id="S4.SS2.p2.6.m1.1.1.3.2.2.3" xref="S4.SS2.p2.6.m1.1.1.3.2.2.3.cmml">W</mi><mrow id="S4.SS2.p2.6.m1.1.1.3.2.3" xref="S4.SS2.p2.6.m1.1.1.3.2.3.cmml"><mo id="S4.SS2.p2.6.m1.1.1.3.2.3a" xref="S4.SS2.p2.6.m1.1.1.3.2.3.cmml">−</mo><mrow id="S4.SS2.p2.6.m1.1.1.3.2.3.2" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2.cmml"><mn id="S4.SS2.p2.6.m1.1.1.3.2.3.2.2" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2.2.cmml">1</mn><mo id="S4.SS2.p2.6.m1.1.1.3.2.3.2.1" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2.1.cmml">/</mo><mn id="S4.SS2.p2.6.m1.1.1.3.2.3.2.3" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m1.1.1.3.1" xref="S4.SS2.p2.6.m1.1.1.3.1.cmml">​</mo><mover accent="true" id="S4.SS2.p2.6.m1.1.1.3.3" xref="S4.SS2.p2.6.m1.1.1.3.3.cmml"><mi id="S4.SS2.p2.6.m1.1.1.3.3.2" xref="S4.SS2.p2.6.m1.1.1.3.3.2.cmml">𝐜</mi><mo id="S4.SS2.p2.6.m1.1.1.3.3.1" xref="S4.SS2.p2.6.m1.1.1.3.3.1.cmml">¯</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m1.1b"><apply id="S4.SS2.p2.6.m1.1.1.cmml" xref="S4.SS2.p2.6.m1.1.1"><eq id="S4.SS2.p2.6.m1.1.1.1.cmml" xref="S4.SS2.p2.6.m1.1.1.1"></eq><ci id="S4.SS2.p2.6.m1.1.1.2.cmml" xref="S4.SS2.p2.6.m1.1.1.2">𝐮</ci><apply id="S4.SS2.p2.6.m1.1.1.3.cmml" xref="S4.SS2.p2.6.m1.1.1.3"><times id="S4.SS2.p2.6.m1.1.1.3.1.cmml" xref="S4.SS2.p2.6.m1.1.1.3.1"></times><apply id="S4.SS2.p2.6.m1.1.1.3.2.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.1.1.3.2.1.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2">superscript</csymbol><apply id="S4.SS2.p2.6.m1.1.1.3.2.2.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m1.1.1.3.2.2.1.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p2.6.m1.1.1.3.2.2.2.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.2.2">Σ</ci><ci id="S4.SS2.p2.6.m1.1.1.3.2.2.3.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.2.3">𝑊</ci></apply><apply id="S4.SS2.p2.6.m1.1.1.3.2.3.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.3"><minus id="S4.SS2.p2.6.m1.1.1.3.2.3.1.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.3"></minus><apply id="S4.SS2.p2.6.m1.1.1.3.2.3.2.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2"><divide id="S4.SS2.p2.6.m1.1.1.3.2.3.2.1.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2.1"></divide><cn type="integer" id="S4.SS2.p2.6.m1.1.1.3.2.3.2.2.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2.2">1</cn><cn type="integer" id="S4.SS2.p2.6.m1.1.1.3.2.3.2.3.cmml" xref="S4.SS2.p2.6.m1.1.1.3.2.3.2.3">2</cn></apply></apply></apply><apply id="S4.SS2.p2.6.m1.1.1.3.3.cmml" xref="S4.SS2.p2.6.m1.1.1.3.3"><ci id="S4.SS2.p2.6.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.6.m1.1.1.3.3.1">¯</ci><ci id="S4.SS2.p2.6.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.6.m1.1.1.3.3.2">𝐜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m1.1c">\mathbf{u}=\Sigma_{W}^{-1/2}\mathbf{\bar{c}}</annotation></semantics></math>, and <math id="S4.SS2.p2.7.m2.1" class="ltx_Math" alttext="\tau(\cdot)" display="inline"><semantics id="S4.SS2.p2.7.m2.1a"><mrow id="S4.SS2.p2.7.m2.1.2" xref="S4.SS2.p2.7.m2.1.2.cmml"><mi id="S4.SS2.p2.7.m2.1.2.2" xref="S4.SS2.p2.7.m2.1.2.2.cmml">τ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m2.1.2.1" xref="S4.SS2.p2.7.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.7.m2.1.2.3.2" xref="S4.SS2.p2.7.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.7.m2.1.2.3.2.1" xref="S4.SS2.p2.7.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m2.1.1" xref="S4.SS2.p2.7.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p2.7.m2.1.2.3.2.2" xref="S4.SS2.p2.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m2.1b"><apply id="S4.SS2.p2.7.m2.1.2.cmml" xref="S4.SS2.p2.7.m2.1.2"><times id="S4.SS2.p2.7.m2.1.2.1.cmml" xref="S4.SS2.p2.7.m2.1.2.1"></times><ci id="S4.SS2.p2.7.m2.1.2.2.cmml" xref="S4.SS2.p2.7.m2.1.2.2">𝜏</ci><ci id="S4.SS2.p2.7.m2.1.1.cmml" xref="S4.SS2.p2.7.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m2.1c">\tau(\cdot)</annotation></semantics></math> is an operator that sets all the elements below the main diagonal of the matrix to zero. In this process, <math id="S4.SS2.p2.8.m3.1" class="ltx_Math" alttext="\Sigma_{W}" display="inline"><semantics id="S4.SS2.p2.8.m3.1a"><msub id="S4.SS2.p2.8.m3.1.1" xref="S4.SS2.p2.8.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.8.m3.1.1.2" xref="S4.SS2.p2.8.m3.1.1.2.cmml">Σ</mi><mi id="S4.SS2.p2.8.m3.1.1.3" xref="S4.SS2.p2.8.m3.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m3.1b"><apply id="S4.SS2.p2.8.m3.1.1.cmml" xref="S4.SS2.p2.8.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m3.1.1.1.cmml" xref="S4.SS2.p2.8.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m3.1.1.2.cmml" xref="S4.SS2.p2.8.m3.1.1.2">Σ</ci><ci id="S4.SS2.p2.8.m3.1.1.3.cmml" xref="S4.SS2.p2.8.m3.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m3.1c">\Sigma_{W}</annotation></semantics></math> summarizes the correlation of instances on each client and hence will work as supervised information to encode the bias of a client into <math id="S4.SS2.p2.9.m4.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="S4.SS2.p2.9.m4.1a"><mi id="S4.SS2.p2.9.m4.1.1" xref="S4.SS2.p2.9.m4.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m4.1b"><ci id="S4.SS2.p2.9.m4.1.1.cmml" xref="S4.SS2.p2.9.m4.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m4.1c">\mathbf{u}</annotation></semantics></math>. Details of the derivations of Eq.<a href="#S4.E8" title="In 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and Eq.<a href="#S4.E9" title="In 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> are discussed in Appendix. Then, the representation alignment process is described in Algorithm.<a href="#alg1" title="Algorithm 1 ‣ 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and the overall FL process with FedCS is described in Algorithm.<a href="#alg2" title="Algorithm 2 ‣ 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Representation Alignment</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> a batch of latent representations <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathbf{z}</annotation></semantics></math>, global mean <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\mathbf{z}_{g}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">𝐳</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝐳</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathbf{z}_{g}</annotation></semantics></math>, client’s local correlation <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="alg1.l1.m3.1a"><msubsup id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi mathvariant="normal" id="alg1.l1.m3.1.1.2.2" xref="alg1.l1.m3.1.1.2.2.cmml">Σ</mi><mi id="alg1.l1.m3.1.1.2.3" xref="alg1.l1.m3.1.1.2.3.cmml">W</mi><mrow id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml"><mo id="alg1.l1.m3.1.1.3a" xref="alg1.l1.m3.1.1.3.cmml">−</mo><mrow id="alg1.l1.m3.1.1.3.2" xref="alg1.l1.m3.1.1.3.2.cmml"><mn id="alg1.l1.m3.1.1.3.2.2" xref="alg1.l1.m3.1.1.3.2.2.cmml">1</mn><mo id="alg1.l1.m3.1.1.3.2.1" xref="alg1.l1.m3.1.1.3.2.1.cmml">/</mo><mn id="alg1.l1.m3.1.1.3.2.3" xref="alg1.l1.m3.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">superscript</csymbol><apply id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.2.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.2.cmml" xref="alg1.l1.m3.1.1.2.2">Σ</ci><ci id="alg1.l1.m3.1.1.2.3.cmml" xref="alg1.l1.m3.1.1.2.3">𝑊</ci></apply><apply id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3"><minus id="alg1.l1.m3.1.1.3.1.cmml" xref="alg1.l1.m3.1.1.3"></minus><apply id="alg1.l1.m3.1.1.3.2.cmml" xref="alg1.l1.m3.1.1.3.2"><divide id="alg1.l1.m3.1.1.3.2.1.cmml" xref="alg1.l1.m3.1.1.3.2.1"></divide><cn type="integer" id="alg1.l1.m3.1.1.3.2.2.cmml" xref="alg1.l1.m3.1.1.3.2.2">1</cn><cn type="integer" id="alg1.l1.m3.1.1.3.2.3.cmml" xref="alg1.l1.m3.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math> and <math id="alg1.l1.m4.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="alg1.l1.m4.1a"><mi mathvariant="normal" id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\Phi</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">begin:</span>

</div>
<div id="alg1.l3" class="ltx_listingline">  1. if <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="alg1.l3.m1.1a"><msubsup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">Σ</mi><mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">W</mi><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mo id="alg1.l3.m1.1.1.3a" xref="alg1.l3.m1.1.1.3.cmml">−</mo><mrow id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml"><mn id="alg1.l3.m1.1.1.3.2.2" xref="alg1.l3.m1.1.1.3.2.2.cmml">1</mn><mo id="alg1.l3.m1.1.1.3.2.1" xref="alg1.l3.m1.1.1.3.2.1.cmml">/</mo><mn id="alg1.l3.m1.1.1.3.2.3" xref="alg1.l3.m1.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">Σ</ci><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">𝑊</ci></apply><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><minus id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3"></minus><apply id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2"><divide id="alg1.l3.m1.1.1.3.2.1.cmml" xref="alg1.l3.m1.1.1.3.2.1"></divide><cn type="integer" id="alg1.l3.m1.1.1.3.2.2.cmml" xref="alg1.l3.m1.1.1.3.2.2">1</cn><cn type="integer" id="alg1.l3.m1.1.1.3.2.3.cmml" xref="alg1.l3.m1.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math> and <math id="alg1.l3.m2.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="alg1.l3.m2.1a"><mi mathvariant="normal" id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\Phi</annotation></semantics></math> are empty, initialize <math id="alg1.l3.m3.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="alg1.l3.m3.1a"><msubsup id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml"><mi mathvariant="normal" id="alg1.l3.m3.1.1.2.2" xref="alg1.l3.m3.1.1.2.2.cmml">Σ</mi><mi id="alg1.l3.m3.1.1.2.3" xref="alg1.l3.m3.1.1.2.3.cmml">W</mi><mrow id="alg1.l3.m3.1.1.3" xref="alg1.l3.m3.1.1.3.cmml"><mo id="alg1.l3.m3.1.1.3a" xref="alg1.l3.m3.1.1.3.cmml">−</mo><mrow id="alg1.l3.m3.1.1.3.2" xref="alg1.l3.m3.1.1.3.2.cmml"><mn id="alg1.l3.m3.1.1.3.2.2" xref="alg1.l3.m3.1.1.3.2.2.cmml">1</mn><mo id="alg1.l3.m3.1.1.3.2.1" xref="alg1.l3.m3.1.1.3.2.1.cmml">/</mo><mn id="alg1.l3.m3.1.1.3.2.3" xref="alg1.l3.m3.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><apply id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.1.1.1.cmml" xref="alg1.l3.m3.1.1">superscript</csymbol><apply id="alg1.l3.m3.1.1.2.cmml" xref="alg1.l3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.1.1.2.1.cmml" xref="alg1.l3.m3.1.1">subscript</csymbol><ci id="alg1.l3.m3.1.1.2.2.cmml" xref="alg1.l3.m3.1.1.2.2">Σ</ci><ci id="alg1.l3.m3.1.1.2.3.cmml" xref="alg1.l3.m3.1.1.2.3">𝑊</ci></apply><apply id="alg1.l3.m3.1.1.3.cmml" xref="alg1.l3.m3.1.1.3"><minus id="alg1.l3.m3.1.1.3.1.cmml" xref="alg1.l3.m3.1.1.3"></minus><apply id="alg1.l3.m3.1.1.3.2.cmml" xref="alg1.l3.m3.1.1.3.2"><divide id="alg1.l3.m3.1.1.3.2.1.cmml" xref="alg1.l3.m3.1.1.3.2.1"></divide><cn type="integer" id="alg1.l3.m3.1.1.3.2.2.cmml" xref="alg1.l3.m3.1.1.3.2.2">1</cn><cn type="integer" id="alg1.l3.m3.1.1.3.2.3.cmml" xref="alg1.l3.m3.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math> and <math id="alg1.l3.m4.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="alg1.l3.m4.1a"><mi mathvariant="normal" id="alg1.l3.m4.1.1" xref="alg1.l3.m4.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m4.1b"><ci id="alg1.l3.m4.1.1.cmml" xref="alg1.l3.m4.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m4.1c">\Phi</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">  2. calculate local mean: <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\mathbf{z}_{l}=mean(\mathbf{z})" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><msub id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml"><mi id="alg1.l4.m1.1.2.2.2" xref="alg1.l4.m1.1.2.2.2.cmml">𝐳</mi><mi id="alg1.l4.m1.1.2.2.3" xref="alg1.l4.m1.1.2.2.3.cmml">l</mi></msub><mo id="alg1.l4.m1.1.2.1" xref="alg1.l4.m1.1.2.1.cmml">=</mo><mrow id="alg1.l4.m1.1.2.3" xref="alg1.l4.m1.1.2.3.cmml"><mi id="alg1.l4.m1.1.2.3.2" xref="alg1.l4.m1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.2.3.1" xref="alg1.l4.m1.1.2.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.2.3.3" xref="alg1.l4.m1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.2.3.1a" xref="alg1.l4.m1.1.2.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.2.3.4" xref="alg1.l4.m1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.2.3.1b" xref="alg1.l4.m1.1.2.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.2.3.5" xref="alg1.l4.m1.1.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.2.3.1c" xref="alg1.l4.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l4.m1.1.2.3.6.2" xref="alg1.l4.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l4.m1.1.2.3.6.2.1" xref="alg1.l4.m1.1.2.3.cmml">(</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">𝐳</mi><mo stretchy="false" id="alg1.l4.m1.1.2.3.6.2.2" xref="alg1.l4.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><eq id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2.1"></eq><apply id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.2.1.cmml" xref="alg1.l4.m1.1.2.2">subscript</csymbol><ci id="alg1.l4.m1.1.2.2.2.cmml" xref="alg1.l4.m1.1.2.2.2">𝐳</ci><ci id="alg1.l4.m1.1.2.2.3.cmml" xref="alg1.l4.m1.1.2.2.3">𝑙</ci></apply><apply id="alg1.l4.m1.1.2.3.cmml" xref="alg1.l4.m1.1.2.3"><times id="alg1.l4.m1.1.2.3.1.cmml" xref="alg1.l4.m1.1.2.3.1"></times><ci id="alg1.l4.m1.1.2.3.2.cmml" xref="alg1.l4.m1.1.2.3.2">𝑚</ci><ci id="alg1.l4.m1.1.2.3.3.cmml" xref="alg1.l4.m1.1.2.3.3">𝑒</ci><ci id="alg1.l4.m1.1.2.3.4.cmml" xref="alg1.l4.m1.1.2.3.4">𝑎</ci><ci id="alg1.l4.m1.1.2.3.5.cmml" xref="alg1.l4.m1.1.2.3.5">𝑛</ci><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathbf{z}_{l}=mean(\mathbf{z})</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">  3. update global mean: <math id="alg1.l5.m1.2" class="ltx_Math" alttext="\mathbf{z}_{g}=\mathbf{z}_{g}+\frac{1}{|\mathbf{z}|}(\mathbf{z}-\mathbf{z}_{g})" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><msub id="alg1.l5.m1.2.2.3" xref="alg1.l5.m1.2.2.3.cmml"><mi id="alg1.l5.m1.2.2.3.2" xref="alg1.l5.m1.2.2.3.2.cmml">𝐳</mi><mi id="alg1.l5.m1.2.2.3.3" xref="alg1.l5.m1.2.2.3.3.cmml">g</mi></msub><mo id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml">=</mo><mrow id="alg1.l5.m1.2.2.1" xref="alg1.l5.m1.2.2.1.cmml"><msub id="alg1.l5.m1.2.2.1.3" xref="alg1.l5.m1.2.2.1.3.cmml"><mi id="alg1.l5.m1.2.2.1.3.2" xref="alg1.l5.m1.2.2.1.3.2.cmml">𝐳</mi><mi id="alg1.l5.m1.2.2.1.3.3" xref="alg1.l5.m1.2.2.1.3.3.cmml">g</mi></msub><mo id="alg1.l5.m1.2.2.1.2" xref="alg1.l5.m1.2.2.1.2.cmml">+</mo><mrow id="alg1.l5.m1.2.2.1.1" xref="alg1.l5.m1.2.2.1.1.cmml"><mfrac id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">1</mn><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.1" xref="alg1.l5.m1.1.1.1.2.1.cmml">|</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">𝐳</mi><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.2" xref="alg1.l5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l5.m1.2.2.1.1.2" xref="alg1.l5.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg1.l5.m1.2.2.1.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l5.m1.2.2.1.1.1.1.2" xref="alg1.l5.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.2.2.1.1.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.2.2.1.1.1.1.1.2" xref="alg1.l5.m1.2.2.1.1.1.1.1.2.cmml">𝐳</mi><mo id="alg1.l5.m1.2.2.1.1.1.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l5.m1.2.2.1.1.1.1.1.3" xref="alg1.l5.m1.2.2.1.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.2.2.1.1.1.1.1.3.2" xref="alg1.l5.m1.2.2.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="alg1.l5.m1.2.2.1.1.1.1.1.3.3" xref="alg1.l5.m1.2.2.1.1.1.1.1.3.3.cmml">g</mi></msub></mrow><mo stretchy="false" id="alg1.l5.m1.2.2.1.1.1.1.3" xref="alg1.l5.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><eq id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"></eq><apply id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.3.1.cmml" xref="alg1.l5.m1.2.2.3">subscript</csymbol><ci id="alg1.l5.m1.2.2.3.2.cmml" xref="alg1.l5.m1.2.2.3.2">𝐳</ci><ci id="alg1.l5.m1.2.2.3.3.cmml" xref="alg1.l5.m1.2.2.3.3">𝑔</ci></apply><apply id="alg1.l5.m1.2.2.1.cmml" xref="alg1.l5.m1.2.2.1"><plus id="alg1.l5.m1.2.2.1.2.cmml" xref="alg1.l5.m1.2.2.1.2"></plus><apply id="alg1.l5.m1.2.2.1.3.cmml" xref="alg1.l5.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.3.1.cmml" xref="alg1.l5.m1.2.2.1.3">subscript</csymbol><ci id="alg1.l5.m1.2.2.1.3.2.cmml" xref="alg1.l5.m1.2.2.1.3.2">𝐳</ci><ci id="alg1.l5.m1.2.2.1.3.3.cmml" xref="alg1.l5.m1.2.2.1.3.3">𝑔</ci></apply><apply id="alg1.l5.m1.2.2.1.1.cmml" xref="alg1.l5.m1.2.2.1.1"><times id="alg1.l5.m1.2.2.1.1.2.cmml" xref="alg1.l5.m1.2.2.1.1.2"></times><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><divide id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1"></divide><cn type="integer" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">1</cn><apply id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.3"><abs id="alg1.l5.m1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.3.1"></abs><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝐳</ci></apply></apply><apply id="alg1.l5.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1"><minus id="alg1.l5.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.1.1"></minus><ci id="alg1.l5.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.1.2">𝐳</ci><apply id="alg1.l5.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.2.2.1.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.1.3.2">𝐳</ci><ci id="alg1.l5.m1.2.2.1.1.1.1.1.3.3.cmml" xref="alg1.l5.m1.2.2.1.1.1.1.1.3.3">𝑔</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">\mathbf{z}_{g}=\mathbf{z}_{g}+\frac{1}{|\mathbf{z}|}(\mathbf{z}-\mathbf{z}_{g})</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">  4. calculate local correlations: <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\Sigma_{W}=(\mathbf{z}-\mathbf{z}_{l})(\mathbf{z}-\mathbf{z}_{l})^{T}" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><msub id="alg1.l6.m1.2.2.4" xref="alg1.l6.m1.2.2.4.cmml"><mi mathvariant="normal" id="alg1.l6.m1.2.2.4.2" xref="alg1.l6.m1.2.2.4.2.cmml">Σ</mi><mi id="alg1.l6.m1.2.2.4.3" xref="alg1.l6.m1.2.2.4.3.cmml">W</mi></msub><mo id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">=</mo><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml"><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.2.3.cmml">​</mo><msup id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml"><mrow id="alg1.l6.m1.2.2.2.2.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml">𝐳</mi><mo id="alg1.l6.m1.2.2.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="alg1.l6.m1.2.2.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.3.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.1.1.3.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.3.2.cmml">𝐳</mi><mi id="alg1.l6.m1.2.2.2.2.1.1.1.3.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="alg1.l6.m1.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><eq id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"></eq><apply id="alg1.l6.m1.2.2.4.cmml" xref="alg1.l6.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.4.1.cmml" xref="alg1.l6.m1.2.2.4">subscript</csymbol><ci id="alg1.l6.m1.2.2.4.2.cmml" xref="alg1.l6.m1.2.2.4.2">Σ</ci><ci id="alg1.l6.m1.2.2.4.3.cmml" xref="alg1.l6.m1.2.2.4.3">𝑊</ci></apply><apply id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2"><times id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.3"></times><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><minus id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1"></minus><ci id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2">𝐳</ci><apply id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1"><minus id="alg1.l6.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1"></minus><ci id="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.2">𝐳</ci><apply id="alg1.l6.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.1.1.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.1.1.1.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.3.2">𝐳</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.1.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.3.3">𝑙</ci></apply></apply><ci id="alg1.l6.m1.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\Sigma_{W}=(\mathbf{z}-\mathbf{z}_{l})(\mathbf{z}-\mathbf{z}_{l})^{T}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">  5. update <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="alg1.l7.m1.1a"><msubsup id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">Σ</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">W</mi><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mo id="alg1.l7.m1.1.1.3a" xref="alg1.l7.m1.1.1.3.cmml">−</mo><mrow id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml"><mn id="alg1.l7.m1.1.1.3.2.2" xref="alg1.l7.m1.1.1.3.2.2.cmml">1</mn><mo id="alg1.l7.m1.1.1.3.2.1" xref="alg1.l7.m1.1.1.3.2.1.cmml">/</mo><mn id="alg1.l7.m1.1.1.3.2.3" xref="alg1.l7.m1.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">superscript</csymbol><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">Σ</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑊</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><minus id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3"></minus><apply id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2"><divide id="alg1.l7.m1.1.1.3.2.1.cmml" xref="alg1.l7.m1.1.1.3.2.1"></divide><cn type="integer" id="alg1.l7.m1.1.1.3.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.2">1</cn><cn type="integer" id="alg1.l7.m1.1.1.3.2.3.cmml" xref="alg1.l7.m1.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math> by Eq.<a href="#S4.E8" title="In 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>

</div>
<div id="alg1.l8" class="ltx_listingline">  6. update <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="alg1.l8.m1.1a"><mi mathvariant="normal" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\Phi</annotation></semantics></math> by Eq.<a href="#S4.E9" title="In 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>

</div>
<div id="alg1.l9" class="ltx_listingline">  7. <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\mathbf{P}=\Sigma_{W}^{-1/2}\Phi" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">𝐏</mi><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><msubsup id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><mi mathvariant="normal" id="alg1.l9.m1.1.1.3.2.2.2" xref="alg1.l9.m1.1.1.3.2.2.2.cmml">Σ</mi><mi id="alg1.l9.m1.1.1.3.2.2.3" xref="alg1.l9.m1.1.1.3.2.2.3.cmml">W</mi><mrow id="alg1.l9.m1.1.1.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.cmml"><mo id="alg1.l9.m1.1.1.3.2.3a" xref="alg1.l9.m1.1.1.3.2.3.cmml">−</mo><mrow id="alg1.l9.m1.1.1.3.2.3.2" xref="alg1.l9.m1.1.1.3.2.3.2.cmml"><mn id="alg1.l9.m1.1.1.3.2.3.2.2" xref="alg1.l9.m1.1.1.3.2.3.2.2.cmml">1</mn><mo id="alg1.l9.m1.1.1.3.2.3.2.1" xref="alg1.l9.m1.1.1.3.2.3.2.1.cmml">/</mo><mn id="alg1.l9.m1.1.1.3.2.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">Φ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝐏</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><times id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"></times><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.2">Σ</ci><ci id="alg1.l9.m1.1.1.3.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.3">𝑊</ci></apply><apply id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3"><minus id="alg1.l9.m1.1.1.3.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.2.3"></minus><apply id="alg1.l9.m1.1.1.3.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.2.3.2"><divide id="alg1.l9.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.1"></divide><cn type="integer" id="alg1.l9.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.2">1</cn><cn type="integer" id="alg1.l9.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.3">2</cn></apply></apply></apply><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">Φ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\mathbf{P}=\Sigma_{W}^{-1/2}\Phi</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">  8. return <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="alg1.l10.m1.1a"><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathbf{P}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">  <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span>

</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Client-Supervised Federate Learning</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">  <span id="alg2.l1.1" class="ltx_text ltx_font_bold">Input:</span> training data <math id="alg2.l1.m1.4" class="ltx_Math" alttext="(\mathcal{X}^{(i)},\mathcal{Y}^{(i)})" display="inline"><semantics id="alg2.l1.m1.4a"><mrow id="alg2.l1.m1.4.4.2" xref="alg2.l1.m1.4.4.3.cmml"><mo stretchy="false" id="alg2.l1.m1.4.4.2.3" xref="alg2.l1.m1.4.4.3.cmml">(</mo><msup id="alg2.l1.m1.3.3.1.1" xref="alg2.l1.m1.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.3.3.1.1.2" xref="alg2.l1.m1.3.3.1.1.2.cmml">𝒳</mi><mrow id="alg2.l1.m1.1.1.1.3" xref="alg2.l1.m1.3.3.1.1.cmml"><mo stretchy="false" id="alg2.l1.m1.1.1.1.3.1" xref="alg2.l1.m1.3.3.1.1.cmml">(</mo><mi id="alg2.l1.m1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="alg2.l1.m1.1.1.1.3.2" xref="alg2.l1.m1.3.3.1.1.cmml">)</mo></mrow></msup><mo id="alg2.l1.m1.4.4.2.4" xref="alg2.l1.m1.4.4.3.cmml">,</mo><msup id="alg2.l1.m1.4.4.2.2" xref="alg2.l1.m1.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.4.4.2.2.2" xref="alg2.l1.m1.4.4.2.2.2.cmml">𝒴</mi><mrow id="alg2.l1.m1.2.2.1.3" xref="alg2.l1.m1.4.4.2.2.cmml"><mo stretchy="false" id="alg2.l1.m1.2.2.1.3.1" xref="alg2.l1.m1.4.4.2.2.cmml">(</mo><mi id="alg2.l1.m1.2.2.1.1" xref="alg2.l1.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="alg2.l1.m1.2.2.1.3.2" xref="alg2.l1.m1.4.4.2.2.cmml">)</mo></mrow></msup><mo stretchy="false" id="alg2.l1.m1.4.4.2.5" xref="alg2.l1.m1.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.4b"><interval closure="open" id="alg2.l1.m1.4.4.3.cmml" xref="alg2.l1.m1.4.4.2"><apply id="alg2.l1.m1.3.3.1.1.cmml" xref="alg2.l1.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.1.1.1.cmml" xref="alg2.l1.m1.3.3.1.1">superscript</csymbol><ci id="alg2.l1.m1.3.3.1.1.2.cmml" xref="alg2.l1.m1.3.3.1.1.2">𝒳</ci><ci id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1">𝑖</ci></apply><apply id="alg2.l1.m1.4.4.2.2.cmml" xref="alg2.l1.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.4.4.2.2.1.cmml" xref="alg2.l1.m1.4.4.2.2">superscript</csymbol><ci id="alg2.l1.m1.4.4.2.2.2.cmml" xref="alg2.l1.m1.4.4.2.2.2">𝒴</ci><ci id="alg2.l1.m1.2.2.1.1.cmml" xref="alg2.l1.m1.2.2.1.1">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.4c">(\mathcal{X}^{(i)},\mathcal{Y}^{(i)})</annotation></semantics></math> distributed on <math id="alg2.l1.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">K</annotation></semantics></math> clients, <math id="alg2.l1.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg2.l1.m3.1a"><mi id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">t</annotation></semantics></math> the round to update <math id="alg2.l1.m4.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg2.l1.m4.1a"><mi id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><ci id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">P</annotation></semantics></math>.

</div>
<div id="alg2.l2" class="ltx_listingline">  <span id="alg2.l2.1" class="ltx_text ltx_font_bold">begin:</span>

</div>
<div id="alg2.l3" class="ltx_listingline">  1. Initialize the FL model <math id="alg2.l3.m1.5" class="ltx_Math" alttext="f(\mathbf{x};\omega)=g(h(\mathbf{x};\omega_{h});\omega_{g})" display="inline"><semantics id="alg2.l3.m1.5a"><mrow id="alg2.l3.m1.5.5" xref="alg2.l3.m1.5.5.cmml"><mrow id="alg2.l3.m1.5.5.4" xref="alg2.l3.m1.5.5.4.cmml"><mi id="alg2.l3.m1.5.5.4.2" xref="alg2.l3.m1.5.5.4.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.5.5.4.1" xref="alg2.l3.m1.5.5.4.1.cmml">​</mo><mrow id="alg2.l3.m1.5.5.4.3.2" xref="alg2.l3.m1.5.5.4.3.1.cmml"><mo stretchy="false" id="alg2.l3.m1.5.5.4.3.2.1" xref="alg2.l3.m1.5.5.4.3.1.cmml">(</mo><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">𝐱</mi><mo id="alg2.l3.m1.5.5.4.3.2.2" xref="alg2.l3.m1.5.5.4.3.1.cmml">;</mo><mi id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml">ω</mi><mo stretchy="false" id="alg2.l3.m1.5.5.4.3.2.3" xref="alg2.l3.m1.5.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="alg2.l3.m1.5.5.3" xref="alg2.l3.m1.5.5.3.cmml">=</mo><mrow id="alg2.l3.m1.5.5.2" xref="alg2.l3.m1.5.5.2.cmml"><mi id="alg2.l3.m1.5.5.2.4" xref="alg2.l3.m1.5.5.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.5.5.2.3" xref="alg2.l3.m1.5.5.2.3.cmml">​</mo><mrow id="alg2.l3.m1.5.5.2.2.2" xref="alg2.l3.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="alg2.l3.m1.5.5.2.2.2.3" xref="alg2.l3.m1.5.5.2.2.3.cmml">(</mo><mrow id="alg2.l3.m1.4.4.1.1.1.1" xref="alg2.l3.m1.4.4.1.1.1.1.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.3" xref="alg2.l3.m1.4.4.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.4.4.1.1.1.1.2" xref="alg2.l3.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l3.m1.4.4.1.1.1.1.1.1" xref="alg2.l3.m1.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.4.4.1.1.1.1.1.1.2" xref="alg2.l3.m1.4.4.1.1.1.1.1.2.cmml">(</mo><mi id="alg2.l3.m1.3.3" xref="alg2.l3.m1.3.3.cmml">𝐱</mi><mo id="alg2.l3.m1.4.4.1.1.1.1.1.1.3" xref="alg2.l3.m1.4.4.1.1.1.1.1.2.cmml">;</mo><msub id="alg2.l3.m1.4.4.1.1.1.1.1.1.1" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.2" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.3" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="alg2.l3.m1.4.4.1.1.1.1.1.1.4" xref="alg2.l3.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg2.l3.m1.5.5.2.2.2.4" xref="alg2.l3.m1.5.5.2.2.3.cmml">;</mo><msub id="alg2.l3.m1.5.5.2.2.2.2" xref="alg2.l3.m1.5.5.2.2.2.2.cmml"><mi id="alg2.l3.m1.5.5.2.2.2.2.2" xref="alg2.l3.m1.5.5.2.2.2.2.2.cmml">ω</mi><mi id="alg2.l3.m1.5.5.2.2.2.2.3" xref="alg2.l3.m1.5.5.2.2.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="alg2.l3.m1.5.5.2.2.2.5" xref="alg2.l3.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.5b"><apply id="alg2.l3.m1.5.5.cmml" xref="alg2.l3.m1.5.5"><eq id="alg2.l3.m1.5.5.3.cmml" xref="alg2.l3.m1.5.5.3"></eq><apply id="alg2.l3.m1.5.5.4.cmml" xref="alg2.l3.m1.5.5.4"><times id="alg2.l3.m1.5.5.4.1.cmml" xref="alg2.l3.m1.5.5.4.1"></times><ci id="alg2.l3.m1.5.5.4.2.cmml" xref="alg2.l3.m1.5.5.4.2">𝑓</ci><list id="alg2.l3.m1.5.5.4.3.1.cmml" xref="alg2.l3.m1.5.5.4.3.2"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝐱</ci><ci id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2">𝜔</ci></list></apply><apply id="alg2.l3.m1.5.5.2.cmml" xref="alg2.l3.m1.5.5.2"><times id="alg2.l3.m1.5.5.2.3.cmml" xref="alg2.l3.m1.5.5.2.3"></times><ci id="alg2.l3.m1.5.5.2.4.cmml" xref="alg2.l3.m1.5.5.2.4">𝑔</ci><list id="alg2.l3.m1.5.5.2.2.3.cmml" xref="alg2.l3.m1.5.5.2.2.2"><apply id="alg2.l3.m1.4.4.1.1.1.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1"><times id="alg2.l3.m1.4.4.1.1.1.1.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2"></times><ci id="alg2.l3.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.3">ℎ</ci><list id="alg2.l3.m1.4.4.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1"><ci id="alg2.l3.m1.3.3.cmml" xref="alg2.l3.m1.3.3">𝐱</ci><apply id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.2">𝜔</ci><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.3">ℎ</ci></apply></list></apply><apply id="alg2.l3.m1.5.5.2.2.2.2.cmml" xref="alg2.l3.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.5.5.2.2.2.2.1.cmml" xref="alg2.l3.m1.5.5.2.2.2.2">subscript</csymbol><ci id="alg2.l3.m1.5.5.2.2.2.2.2.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.2">𝜔</ci><ci id="alg2.l3.m1.5.5.2.2.2.2.3.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.3">𝑔</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.5c">f(\mathbf{x};\omega)=g(h(\mathbf{x};\omega_{h});\omega_{g})</annotation></semantics></math>.

</div>
<div id="alg2.l4" class="ltx_listingline">  2. Select a set of clients <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\mathbb{S}" display="inline"><semantics id="alg2.l4.m1.1a"><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">𝕊</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝕊</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\mathbb{S}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">  <span id="alg2.l5.1" class="ltx_text ltx_font_bold">for</span> the <math id="alg2.l5.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l5.m1.1a"><mi id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">i</annotation></semantics></math>-th client in <math id="alg2.l5.m2.1" class="ltx_Math" alttext="\mathbb{S}" display="inline"><semantics id="alg2.l5.m2.1a"><mi id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">𝕊</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">𝕊</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\mathbb{S}</annotation></semantics></math> <span id="alg2.l5.2" class="ltx_text ltx_font_bold">parallel do</span>

</div>
<div id="alg2.l6" class="ltx_listingline">    update <math id="alg2.l6.m1.1" class="ltx_Math" alttext="\omega_{h}" display="inline"><semantics id="alg2.l6.m1.1a"><msub id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">ω</mi><mi id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">𝜔</ci><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\omega_{h}</annotation></semantics></math> and <math id="alg2.l6.m2.1" class="ltx_Math" alttext="\omega_{g}" display="inline"><semantics id="alg2.l6.m2.1a"><msub id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mi id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2.cmml">ω</mi><mi id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1">subscript</csymbol><ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">𝜔</ci><ci id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\omega_{g}</annotation></semantics></math> locally

</div>
<div id="alg2.l7" class="ltx_listingline">    if round%<math id="alg2.l7.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">t</annotation></semantics></math> == 0:

</div>
<div id="alg2.l8" class="ltx_listingline">    update <math id="alg2.l8.m1.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="alg2.l8.m1.1a"><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\mathbf{P}</annotation></semantics></math> locally by Algorithm.<a href="#alg2" title="Algorithm 2 ‣ 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>

</div>
<div id="alg2.l9" class="ltx_listingline">  <span id="alg2.l9.1" class="ltx_text ltx_font_bold">end for</span>

</div>
<div id="alg2.l10" class="ltx_listingline">  3. Aggregate local updates of <math id="alg2.l10.m1.1" class="ltx_Math" alttext="\omega_{h}" display="inline"><semantics id="alg2.l10.m1.1a"><msub id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">ω</mi><mi id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1">subscript</csymbol><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝜔</ci><ci id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\omega_{h}</annotation></semantics></math>, <math id="alg2.l10.m2.1" class="ltx_Math" alttext="\omega_{g}" display="inline"><semantics id="alg2.l10.m2.1a"><msub id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml"><mi id="alg2.l10.m2.1.1.2" xref="alg2.l10.m2.1.1.2.cmml">ω</mi><mi id="alg2.l10.m2.1.1.3" xref="alg2.l10.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><apply id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.1.cmml" xref="alg2.l10.m2.1.1">subscript</csymbol><ci id="alg2.l10.m2.1.1.2.cmml" xref="alg2.l10.m2.1.1.2">𝜔</ci><ci id="alg2.l10.m2.1.1.3.cmml" xref="alg2.l10.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">\omega_{g}</annotation></semantics></math> and <math id="alg2.l10.m3.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="alg2.l10.m3.1a"><mi id="alg2.l10.m3.1.1" xref="alg2.l10.m3.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m3.1b"><ci id="alg2.l10.m3.1.1.cmml" xref="alg2.l10.m3.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m3.1c">\mathbf{P}</annotation></semantics></math> by averaging

</div>
<div id="alg2.l11" class="ltx_listingline">  <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span>

</div>
</div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we demonstrate the advantages of FedCS in learning from clients with non-i.i.d. data. The FedCS can learn a robust FL global model for the changing data distributions of unseen/test clients. The FedCS’s global model can be directly deployed to the test clients while achieving comparable performance to other personalized FL methods that require model adaptation.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Client Settings</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We simulate FL environments by allocating instances from benchmark datasets to 50 clients, and two types of heterogeneity are applied (Details of client settings are introduced in the Appendix).</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Label-shift</span>: We experiment, respectively, on the MNIST and the CIFAR-10 datasets. We allocate instances of each label individually according to a posterior of the Dirichlet distribution<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, which divides clients into ten groups with different label distributions. Eight groups of clients will participate in the collaborative training process, and the rest will be held for test.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Feature-shift</span>: We experiment on the Digit-5 dataset to evaluate FedCS’s performance on feature-shift data. The Digit-5 consists of digits from five domains (MNIST, MNIST-M, SVHN, USPS and Synth Digits). We assign instances of each domain to nine clients, where eight clients will train the global model and one for the test. In addition, we randomly draw instances from all domains to compose five mixed datasets for the test.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Models and Hyperparameters</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We apply convolution neural networks (CNN) as fundamental models and integrate our proposed RA module into fully connected layers (FCs) to align their hidden layers (see Appendix for details of model architectures). By default, in each communication round, we sample ten clients to update the global model and evaluate the global model’s performance on all clients. One epoch of fine-tuning steps will be applied for benchmark methods where the global model must be adapted to a client’s local data before testing. The learning rate of a client’s local training step is initialized as 0.005, and it will decay at the rate of 0.8 every 50 communication rounds. The RA module will be updated every five communication rounds by the sampled ten clients, and the learning rate is fixed at 0.001. (see Appendix for details of other hyperparameters).</p>
</div>
<figure id="S5.F2" class="ltx_figure">
<p id="S5.F2.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F2.1.1.1" class="ltx_text"><img src="/html/2403.19499/assets/images/fedbn-cifar10.png" id="S5.F2.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="1196" height="322" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.3.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>Part of experiments on CIFAR-10. The horizontal axis denotes communication rounds, and the vertical axis denotes F1 Scores. We demonstrate the averaged weighted F1-scores within each client group and marked them with different colours. We can find the performance on different distributions (client groups) vary significantly through FedAvg+FT and FedBN. FedCS has the most robust performance even on unseen clients (group 8 and 9)</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Performance</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We first demonstrate averaged model performance on all clients, which shows that a global model learned with FedCS will achieve comparable performance to other personalized FL methods that require model adaptation. Then, we look inside the group-wised metrics to evaluate a model’s performance on different distributions. The global model learned with FedCS is more robust to different distributions. It can be directly deployed on test clients without extra adaptation. Several FL strategies are compared as baselines: 1) FedAvg+FT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>; 2) FedAvg+BN; 3) FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. 4) FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>; 5) PerFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>; 6) In addition, we demonstrate the performance of models those trained on each client locally (Local Only).</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Label-shift Settings</h3>

<section id="S5.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.1 </span>Overall Performance</h4>

<div id="S5.SS4.SSS1.p1" class="ltx_para">
<p id="S5.SS4.SSS1.p1.1" class="ltx_p">For label-shift settings, the weighted AUC score and the weighted F1 score are applied to evaluate model performance on data with unbalanced label distributions.
Table.<a href="#S5.T1" title="Table 1 ‣ 5.4.1 Overall Performance ‣ 5.4 Label-shift Settings ‣ 5 Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> demonstrates models’ performance on the MNIST dataset. We can find that a model with FedCS layers achieves the best performance under the label-shift setting. It outperforms those locally fine-tuned global models (FedAvg+FT) and models with client-specific parameters (FedBN). FedRep has the worst performance, which may result from the lack of training data and the unbalanced label distribution of each client.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.8.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>The averaged performance on the MNIST dataset. The standard deviation of the metric between clients is reported in parentheses. w. is the abbreviation of ’weighted’, and the <math id="S5.T1.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.2.m1.1b"><mo stretchy="false" id="S5.T1.2.m1.1.1" xref="S5.T1.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.m1.1c"><ci id="S5.T1.2.m1.1.1.cmml" xref="S5.T1.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.m1.1d">\uparrow</annotation></semantics></math> denotes that the higher the metric is, the better performance a model achieved, and the best performance is highlighted.</figcaption>
<table id="S5.T1.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.6.4" class="ltx_tr">
<th id="S5.T1.6.4.5" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r"></th>
<th id="S5.T1.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">w. AUC (<math id="S5.T1.3.1.1.m1.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S5.T1.3.1.1.m1.1a"><msup id="S5.T1.3.1.1.m1.1.1" xref="S5.T1.3.1.1.m1.1.1.cmml"><mn id="S5.T1.3.1.1.m1.1.1.2" xref="S5.T1.3.1.1.m1.1.1.2.cmml">10</mn><mrow id="S5.T1.3.1.1.m1.1.1.3" xref="S5.T1.3.1.1.m1.1.1.3.cmml"><mo id="S5.T1.3.1.1.m1.1.1.3a" xref="S5.T1.3.1.1.m1.1.1.3.cmml">−</mo><mn id="S5.T1.3.1.1.m1.1.1.3.2" xref="S5.T1.3.1.1.m1.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.1.m1.1b"><apply id="S5.T1.3.1.1.m1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.3.1.1.m1.1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S5.T1.3.1.1.m1.1.1.2.cmml" xref="S5.T1.3.1.1.m1.1.1.2">10</cn><apply id="S5.T1.3.1.1.m1.1.1.3.cmml" xref="S5.T1.3.1.1.m1.1.1.3"><minus id="S5.T1.3.1.1.m1.1.1.3.1.cmml" xref="S5.T1.3.1.1.m1.1.1.3"></minus><cn type="integer" id="S5.T1.3.1.1.m1.1.1.3.2.cmml" xref="S5.T1.3.1.1.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.1.m1.1c">10^{-2}</annotation></semantics></math>) <math id="S5.T1.4.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.4.2.2.m2.1a"><mo stretchy="false" id="S5.T1.4.2.2.m2.1.1" xref="S5.T1.4.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.2.2.m2.1b"><ci id="S5.T1.4.2.2.m2.1.1.cmml" xref="S5.T1.4.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S5.T1.6.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">w. F1 (<math id="S5.T1.5.3.3.m1.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S5.T1.5.3.3.m1.1a"><msup id="S5.T1.5.3.3.m1.1.1" xref="S5.T1.5.3.3.m1.1.1.cmml"><mn id="S5.T1.5.3.3.m1.1.1.2" xref="S5.T1.5.3.3.m1.1.1.2.cmml">10</mn><mrow id="S5.T1.5.3.3.m1.1.1.3" xref="S5.T1.5.3.3.m1.1.1.3.cmml"><mo id="S5.T1.5.3.3.m1.1.1.3a" xref="S5.T1.5.3.3.m1.1.1.3.cmml">−</mo><mn id="S5.T1.5.3.3.m1.1.1.3.2" xref="S5.T1.5.3.3.m1.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T1.5.3.3.m1.1b"><apply id="S5.T1.5.3.3.m1.1.1.cmml" xref="S5.T1.5.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.5.3.3.m1.1.1.1.cmml" xref="S5.T1.5.3.3.m1.1.1">superscript</csymbol><cn type="integer" id="S5.T1.5.3.3.m1.1.1.2.cmml" xref="S5.T1.5.3.3.m1.1.1.2">10</cn><apply id="S5.T1.5.3.3.m1.1.1.3.cmml" xref="S5.T1.5.3.3.m1.1.1.3"><minus id="S5.T1.5.3.3.m1.1.1.3.1.cmml" xref="S5.T1.5.3.3.m1.1.1.3"></minus><cn type="integer" id="S5.T1.5.3.3.m1.1.1.3.2.cmml" xref="S5.T1.5.3.3.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.3.3.m1.1c">10^{-2}</annotation></semantics></math>) <math id="S5.T1.6.4.4.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.6.4.4.m2.1a"><mo stretchy="false" id="S5.T1.6.4.4.m2.1.1" xref="S5.T1.6.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.4.4.m2.1b"><ci id="S5.T1.6.4.4.m2.1.1.cmml" xref="S5.T1.6.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.4.4.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.6.5.1" class="ltx_tr">
<th id="S5.T1.6.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Local Only</th>
<td id="S5.T1.6.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">85.18(4.62)</td>
<td id="S5.T1.6.5.1.3" class="ltx_td ltx_align_center ltx_border_t">47.80(10.12)</td>
</tr>
<tr id="S5.T1.6.6.2" class="ltx_tr">
<th id="S5.T1.6.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedAvg+FT</th>
<td id="S5.T1.6.6.2.2" class="ltx_td ltx_align_center ltx_border_r">96.97(2.54)</td>
<td id="S5.T1.6.6.2.3" class="ltx_td ltx_align_center">80.81(10.14)</td>
</tr>
<tr id="S5.T1.6.7.3" class="ltx_tr">
<th id="S5.T1.6.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedAvg+BN</th>
<td id="S5.T1.6.7.3.2" class="ltx_td ltx_align_center ltx_border_r">99.69(0.14)</td>
<td id="S5.T1.6.7.3.3" class="ltx_td ltx_align_center">93.38(1.76)</td>
</tr>
<tr id="S5.T1.6.8.4" class="ltx_tr">
<th id="S5.T1.6.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedBN</th>
<td id="S5.T1.6.8.4.2" class="ltx_td ltx_align_center ltx_border_r">99.32(0.75)</td>
<td id="S5.T1.6.8.4.3" class="ltx_td ltx_align_center">83.85(18.82)</td>
</tr>
<tr id="S5.T1.6.9.5" class="ltx_tr">
<th id="S5.T1.6.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="S5.T1.6.9.5.2" class="ltx_td ltx_align_center ltx_border_r">75.72(15.56)</td>
<td id="S5.T1.6.9.5.3" class="ltx_td ltx_align_center">38.53(20.52)</td>
</tr>
<tr id="S5.T1.6.10.6" class="ltx_tr">
<th id="S5.T1.6.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PerFL</th>
<td id="S5.T1.6.10.6.2" class="ltx_td ltx_align_center ltx_border_r">99.48(0.20)</td>
<td id="S5.T1.6.10.6.3" class="ltx_td ltx_align_center">91.40(1.95)</td>
</tr>
<tr id="S5.T1.6.11.7" class="ltx_tr">
<th id="S5.T1.6.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FedCS-FC1(ours)</th>
<td id="S5.T1.6.11.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.6.11.7.2.1" class="ltx_text ltx_font_bold">99.72(0.15)</span></td>
<td id="S5.T1.6.11.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.6.11.7.3.1" class="ltx_text ltx_font_bold">93.72(1.71)</span></td>
</tr>
<tr id="S5.T1.6.12.8" class="ltx_tr">
<th id="S5.T1.6.12.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedCS-FC2(ours)</th>
<td id="S5.T1.6.12.8.2" class="ltx_td ltx_align_center ltx_border_r">99.71(0.16)</td>
<td id="S5.T1.6.12.8.3" class="ltx_td ltx_align_center">93.43(1.78)</td>
</tr>
<tr id="S5.T1.6.13.9" class="ltx_tr">
<th id="S5.T1.6.13.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedCS-FC3(ours)</th>
<td id="S5.T1.6.13.9.2" class="ltx_td ltx_align_center ltx_border_r">99.72(0.26)</td>
<td id="S5.T1.6.13.9.3" class="ltx_td ltx_align_center">93.64(1.56)</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS4.SSS1.p2" class="ltx_para">
<p id="S5.SS4.SSS1.p2.1" class="ltx_p">Table.<a href="#S5.T2" title="Table 2 ‣ 5.4.1 Overall Performance ‣ 5.4 Label-shift Settings ‣ 5 Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates models’ performance on the CIFAR-10 dataset. FedCS has the best performance under this setting. Other models are less effective than FedCS, and their performances vary significantly among clients (higher standard deviations). We will show that the gap results from the generalization error on test clients, and there is no such problem for the proposed FedCS.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.8.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>The averaged performance on the CIFAR-10 dataset. The standard deviation of the metric between clients is reported in parentheses. w. is the abbreviation of ’weighted’, and the <math id="S5.T2.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.2.m1.1b"><mo stretchy="false" id="S5.T2.2.m1.1.1" xref="S5.T2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.m1.1c"><ci id="S5.T2.2.m1.1.1.cmml" xref="S5.T2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.m1.1d">\uparrow</annotation></semantics></math> denotes that the higher the metric is, the better performance a model achieved, and the best performance is highlighted.</figcaption>
<table id="S5.T2.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.6.4" class="ltx_tr">
<th id="S5.T2.6.4.5" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r"></th>
<th id="S5.T2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">w. AUC (<math id="S5.T2.3.1.1.m1.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S5.T2.3.1.1.m1.1a"><msup id="S5.T2.3.1.1.m1.1.1" xref="S5.T2.3.1.1.m1.1.1.cmml"><mn id="S5.T2.3.1.1.m1.1.1.2" xref="S5.T2.3.1.1.m1.1.1.2.cmml">10</mn><mrow id="S5.T2.3.1.1.m1.1.1.3" xref="S5.T2.3.1.1.m1.1.1.3.cmml"><mo id="S5.T2.3.1.1.m1.1.1.3a" xref="S5.T2.3.1.1.m1.1.1.3.cmml">−</mo><mn id="S5.T2.3.1.1.m1.1.1.3.2" xref="S5.T2.3.1.1.m1.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.m1.1b"><apply id="S5.T2.3.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.3.1.1.m1.1.1.1.cmml" xref="S5.T2.3.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S5.T2.3.1.1.m1.1.1.2.cmml" xref="S5.T2.3.1.1.m1.1.1.2">10</cn><apply id="S5.T2.3.1.1.m1.1.1.3.cmml" xref="S5.T2.3.1.1.m1.1.1.3"><minus id="S5.T2.3.1.1.m1.1.1.3.1.cmml" xref="S5.T2.3.1.1.m1.1.1.3"></minus><cn type="integer" id="S5.T2.3.1.1.m1.1.1.3.2.cmml" xref="S5.T2.3.1.1.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.1.1.m1.1c">10^{-2}</annotation></semantics></math>)<math id="S5.T2.4.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.4.2.2.m2.1a"><mo stretchy="false" id="S5.T2.4.2.2.m2.1.1" xref="S5.T2.4.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.m2.1b"><ci id="S5.T2.4.2.2.m2.1.1.cmml" xref="S5.T2.4.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S5.T2.6.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">w. F1 (<math id="S5.T2.5.3.3.m1.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S5.T2.5.3.3.m1.1a"><msup id="S5.T2.5.3.3.m1.1.1" xref="S5.T2.5.3.3.m1.1.1.cmml"><mn id="S5.T2.5.3.3.m1.1.1.2" xref="S5.T2.5.3.3.m1.1.1.2.cmml">10</mn><mrow id="S5.T2.5.3.3.m1.1.1.3" xref="S5.T2.5.3.3.m1.1.1.3.cmml"><mo id="S5.T2.5.3.3.m1.1.1.3a" xref="S5.T2.5.3.3.m1.1.1.3.cmml">−</mo><mn id="S5.T2.5.3.3.m1.1.1.3.2" xref="S5.T2.5.3.3.m1.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T2.5.3.3.m1.1b"><apply id="S5.T2.5.3.3.m1.1.1.cmml" xref="S5.T2.5.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.5.3.3.m1.1.1.1.cmml" xref="S5.T2.5.3.3.m1.1.1">superscript</csymbol><cn type="integer" id="S5.T2.5.3.3.m1.1.1.2.cmml" xref="S5.T2.5.3.3.m1.1.1.2">10</cn><apply id="S5.T2.5.3.3.m1.1.1.3.cmml" xref="S5.T2.5.3.3.m1.1.1.3"><minus id="S5.T2.5.3.3.m1.1.1.3.1.cmml" xref="S5.T2.5.3.3.m1.1.1.3"></minus><cn type="integer" id="S5.T2.5.3.3.m1.1.1.3.2.cmml" xref="S5.T2.5.3.3.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.3.3.m1.1c">10^{-2}</annotation></semantics></math>)<math id="S5.T2.6.4.4.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.6.4.4.m2.1a"><mo stretchy="false" id="S5.T2.6.4.4.m2.1.1" xref="S5.T2.6.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.4.4.m2.1b"><ci id="S5.T2.6.4.4.m2.1.1.cmml" xref="S5.T2.6.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.4.4.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.6.5.1" class="ltx_tr">
<th id="S5.T2.6.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Local Only</th>
<td id="S5.T2.6.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">70.93(9.23)</td>
<td id="S5.T2.6.5.1.3" class="ltx_td ltx_align_center ltx_border_t">34.86(10.71)</td>
</tr>
<tr id="S5.T2.6.6.2" class="ltx_tr">
<th id="S5.T2.6.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedAvg+FT</th>
<td id="S5.T2.6.6.2.2" class="ltx_td ltx_align_center ltx_border_r">86.89(4.65)</td>
<td id="S5.T2.6.6.2.3" class="ltx_td ltx_align_center">51.75(12.62)</td>
</tr>
<tr id="S5.T2.6.7.3" class="ltx_tr">
<th id="S5.T2.6.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedAvg+BN</th>
<td id="S5.T2.6.7.3.2" class="ltx_td ltx_align_center ltx_border_r">91.57(4.30)</td>
<td id="S5.T2.6.7.3.3" class="ltx_td ltx_align_center">57.87(14.95)</td>
</tr>
<tr id="S5.T2.6.8.4" class="ltx_tr">
<th id="S5.T2.6.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedBN</th>
<td id="S5.T2.6.8.4.2" class="ltx_td ltx_align_center ltx_border_r">91.64(4.56)</td>
<td id="S5.T2.6.8.4.3" class="ltx_td ltx_align_center">59.41(14.70)</td>
</tr>
<tr id="S5.T2.6.9.5" class="ltx_tr">
<th id="S5.T2.6.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="S5.T2.6.9.5.2" class="ltx_td ltx_align_center ltx_border_r">70.70(9.80)</td>
<td id="S5.T2.6.9.5.3" class="ltx_td ltx_align_center">33.01(13.88)</td>
</tr>
<tr id="S5.T2.6.10.6" class="ltx_tr">
<th id="S5.T2.6.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PerFL</th>
<td id="S5.T2.6.10.6.2" class="ltx_td ltx_align_center ltx_border_r">89.18(3.36)</td>
<td id="S5.T2.6.10.6.3" class="ltx_td ltx_align_center">58.62(9.17)</td>
</tr>
<tr id="S5.T2.6.11.7" class="ltx_tr">
<th id="S5.T2.6.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FedCS-FC1(ours)</th>
<td id="S5.T2.6.11.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.6.11.7.2.1" class="ltx_text ltx_font_bold">93.72(1.71)</span></td>
<td id="S5.T2.6.11.7.3" class="ltx_td ltx_align_center ltx_border_t">69.48(4.69)</td>
</tr>
<tr id="S5.T2.6.12.8" class="ltx_tr">
<th id="S5.T2.6.12.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedCS-FC2(ours)</th>
<td id="S5.T2.6.12.8.2" class="ltx_td ltx_align_center ltx_border_r">93.33(2.33)</td>
<td id="S5.T2.6.12.8.3" class="ltx_td ltx_align_center">69.06(5.97)</td>
</tr>
<tr id="S5.T2.6.13.9" class="ltx_tr">
<th id="S5.T2.6.13.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedCS-FC3(ours)</th>
<td id="S5.T2.6.13.9.2" class="ltx_td ltx_align_center ltx_border_r">93.49(2.09)</td>
<td id="S5.T2.6.13.9.3" class="ltx_td ltx_align_center"><span id="S5.T2.6.13.9.3.1" class="ltx_text ltx_font_bold">69.69(4.96)</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.8.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>The averaged accuracy on the Digit-5 dataset. The standard deviation of the metric between clients is reported in parentheses. w. is the abbreviation of ’weighted’, and the <math id="S5.T3.2.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T3.2.m1.1b"><mo stretchy="false" id="S5.T3.2.m1.1.1" xref="S5.T3.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.2.m1.1c"><ci id="S5.T3.2.m1.1.1.cmml" xref="S5.T3.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.m1.1d">\uparrow</annotation></semantics></math> denotes that the higher the metric is, the better performance a model achieved, and the best performance is highlighted.</figcaption>
<table id="S5.T3.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.6.4" class="ltx_tr">
<th id="S5.T3.6.4.5" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r"></th>
<th id="S5.T3.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">w. AUC (<math id="S5.T3.3.1.1.m1.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S5.T3.3.1.1.m1.1a"><msup id="S5.T3.3.1.1.m1.1.1" xref="S5.T3.3.1.1.m1.1.1.cmml"><mn id="S5.T3.3.1.1.m1.1.1.2" xref="S5.T3.3.1.1.m1.1.1.2.cmml">10</mn><mrow id="S5.T3.3.1.1.m1.1.1.3" xref="S5.T3.3.1.1.m1.1.1.3.cmml"><mo id="S5.T3.3.1.1.m1.1.1.3a" xref="S5.T3.3.1.1.m1.1.1.3.cmml">−</mo><mn id="S5.T3.3.1.1.m1.1.1.3.2" xref="S5.T3.3.1.1.m1.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.1.m1.1b"><apply id="S5.T3.3.1.1.m1.1.1.cmml" xref="S5.T3.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.3.1.1.m1.1.1.1.cmml" xref="S5.T3.3.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S5.T3.3.1.1.m1.1.1.2.cmml" xref="S5.T3.3.1.1.m1.1.1.2">10</cn><apply id="S5.T3.3.1.1.m1.1.1.3.cmml" xref="S5.T3.3.1.1.m1.1.1.3"><minus id="S5.T3.3.1.1.m1.1.1.3.1.cmml" xref="S5.T3.3.1.1.m1.1.1.3"></minus><cn type="integer" id="S5.T3.3.1.1.m1.1.1.3.2.cmml" xref="S5.T3.3.1.1.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.1.m1.1c">10^{-2}</annotation></semantics></math>)<math id="S5.T3.4.2.2.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T3.4.2.2.m2.1a"><mo stretchy="false" id="S5.T3.4.2.2.m2.1.1" xref="S5.T3.4.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.2.2.m2.1b"><ci id="S5.T3.4.2.2.m2.1.1.cmml" xref="S5.T3.4.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.2.2.m2.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S5.T3.6.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">w. F1 (<math id="S5.T3.5.3.3.m1.1" class="ltx_Math" alttext="10^{-2}" display="inline"><semantics id="S5.T3.5.3.3.m1.1a"><msup id="S5.T3.5.3.3.m1.1.1" xref="S5.T3.5.3.3.m1.1.1.cmml"><mn id="S5.T3.5.3.3.m1.1.1.2" xref="S5.T3.5.3.3.m1.1.1.2.cmml">10</mn><mrow id="S5.T3.5.3.3.m1.1.1.3" xref="S5.T3.5.3.3.m1.1.1.3.cmml"><mo id="S5.T3.5.3.3.m1.1.1.3a" xref="S5.T3.5.3.3.m1.1.1.3.cmml">−</mo><mn id="S5.T3.5.3.3.m1.1.1.3.2" xref="S5.T3.5.3.3.m1.1.1.3.2.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T3.5.3.3.m1.1b"><apply id="S5.T3.5.3.3.m1.1.1.cmml" xref="S5.T3.5.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.5.3.3.m1.1.1.1.cmml" xref="S5.T3.5.3.3.m1.1.1">superscript</csymbol><cn type="integer" id="S5.T3.5.3.3.m1.1.1.2.cmml" xref="S5.T3.5.3.3.m1.1.1.2">10</cn><apply id="S5.T3.5.3.3.m1.1.1.3.cmml" xref="S5.T3.5.3.3.m1.1.1.3"><minus id="S5.T3.5.3.3.m1.1.1.3.1.cmml" xref="S5.T3.5.3.3.m1.1.1.3"></minus><cn type="integer" id="S5.T3.5.3.3.m1.1.1.3.2.cmml" xref="S5.T3.5.3.3.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.3.3.m1.1c">10^{-2}</annotation></semantics></math>)<math id="S5.T3.6.4.4.m2.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T3.6.4.4.m2.1a"><mo stretchy="false" id="S5.T3.6.4.4.m2.1.1" xref="S5.T3.6.4.4.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.4.4.m2.1b"><ci id="S5.T3.6.4.4.m2.1.1.cmml" xref="S5.T3.6.4.4.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.4.4.m2.1c">\uparrow</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.6.5.1" class="ltx_tr">
<th id="S5.T3.6.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Local Only</th>
<td id="S5.T3.6.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">84.03(9.75)</td>
<td id="S5.T3.6.5.1.3" class="ltx_td ltx_align_center ltx_border_t">49.73(20.38)</td>
</tr>
<tr id="S5.T3.6.6.2" class="ltx_tr">
<th id="S5.T3.6.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedAvg+FT</th>
<td id="S5.T3.6.6.2.2" class="ltx_td ltx_align_center ltx_border_r">96.11(1.98)</td>
<td id="S5.T3.6.6.2.3" class="ltx_td ltx_align_center">75.64(4.94)</td>
</tr>
<tr id="S5.T3.6.7.3" class="ltx_tr">
<th id="S5.T3.6.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedAvg+BN</th>
<td id="S5.T3.6.7.3.2" class="ltx_td ltx_align_center ltx_border_r">97.82(3.11)</td>
<td id="S5.T3.6.7.3.3" class="ltx_td ltx_align_center">83.40(12.96)</td>
</tr>
<tr id="S5.T3.6.8.4" class="ltx_tr">
<th id="S5.T3.6.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedBN</th>
<td id="S5.T3.6.8.4.2" class="ltx_td ltx_align_center ltx_border_r">95.71(3.79)</td>
<td id="S5.T3.6.8.4.3" class="ltx_td ltx_align_center">74.07(10.90)</td>
</tr>
<tr id="S5.T3.6.9.5" class="ltx_tr">
<th id="S5.T3.6.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedRep</th>
<td id="S5.T3.6.9.5.2" class="ltx_td ltx_align_center ltx_border_r">82.94(11.54)</td>
<td id="S5.T3.6.9.5.3" class="ltx_td ltx_align_center">50.14(20.88)</td>
</tr>
<tr id="S5.T3.6.10.6" class="ltx_tr">
<th id="S5.T3.6.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PerFL</th>
<td id="S5.T3.6.10.6.2" class="ltx_td ltx_align_center ltx_border_r">96.10(2.47)</td>
<td id="S5.T3.6.10.6.3" class="ltx_td ltx_align_center">74.63(6.71)</td>
</tr>
<tr id="S5.T3.6.11.7" class="ltx_tr">
<th id="S5.T3.6.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">FedCS-FC1(ours)</th>
<td id="S5.T3.6.11.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.6.11.7.2.1" class="ltx_text ltx_font_bold">98.74(0.95)</span></td>
<td id="S5.T3.6.11.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.6.11.7.3.1" class="ltx_text ltx_font_bold">87.89(4.76)</span></td>
</tr>
<tr id="S5.T3.6.12.8" class="ltx_tr">
<th id="S5.T3.6.12.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedCS-FC2(ours)</th>
<td id="S5.T3.6.12.8.2" class="ltx_td ltx_align_center ltx_border_r">98.60(1.09)</td>
<td id="S5.T3.6.12.8.3" class="ltx_td ltx_align_center">87.66(5.15)</td>
</tr>
<tr id="S5.T3.6.13.9" class="ltx_tr">
<th id="S5.T3.6.13.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">FedCS-FC3(ours)</th>
<td id="S5.T3.6.13.9.2" class="ltx_td ltx_align_center ltx_border_r">98.57(1.09)</td>
<td id="S5.T3.6.13.9.3" class="ltx_td ltx_align_center">87.66(5.19)</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.2 </span>Group-wised Performance</h4>

<div id="S5.SS4.SSS2.p1" class="ltx_para">
<p id="S5.SS4.SSS2.p1.1" class="ltx_p">Fig.<a href="#S5.F2" title="Figure 2 ‣ 5.2 Models and Hyperparameters ‣ 5 Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates averaged weighted F1-scores within each client group<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Full version of results are shown in Appendix.</span></span></span>. We can find that the global model with FedCR is more robust among different clients, even if they are from test groups (groups 8-9). Fine-tuned models (FedAvg+FT) and models with personalized parameters (FedBN) have significant performance gaps when deployed on training clients (group 0-7) and test clients. They achieve higher F1 scores in training groups but could be less effective in test groups.</p>
</div>
</section>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Feature-shift Settings</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">In this section, we demonstrate evaluations of feature-shifted data. According to Table.<a href="#S5.T3" title="Table 3 ‣ 5.4.1 Overall Performance ‣ 5.4 Label-shift Settings ‣ 5 Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we show that FedCS achieves the highest weighted AUC and weighted-F1 score. The averaged accuracy within each data domain is shown in the Appendix. It also validates our claims that FedCS performs more robustly on all domains while other methods degenerate significantly on test clients. 
</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This paper is the first to propose using a one-model-for-all strategy to implement personalized federated learning. We believe the one-model-for-all personalization can form a new topic to advance existing personalized federated learning research. It is foreseeing more discussion and exploration can be conducted in this new one-model-for-all personalized federated setting.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas,

</span>
<span class="ltx_bibblock">“Communication-efficient learning of deep networks from decentralized data,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>. PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi,

</span>
<span class="ltx_bibblock">“Adaptive personalized federated learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2003.13461</span>, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Yishay Mansour, Mehryar Mohri, Jae Ro, and Ananda Theertha Suresh,

</span>
<span class="ltx_bibblock">“Three approaches for personalization with applications to federated learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2002.10619</span>, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Shanshan Wu, Tian Li, Zachary Charles, Yu Xiao, Ziyu Liu, Zheng Xu, and Virginia Smith,

</span>
<span class="ltx_bibblock">“Motley: Benchmarking heterogeneity and personalization in federated learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2206.09262</span>, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Gary Cheng, Karan Chadha, and John Duchi,

</span>
<span class="ltx_bibblock">“Fine-tuning is fine in federated learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2108.07313</span>, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai,

</span>
<span class="ltx_bibblock">“Fedavg with fine tuning: Local updates lead to representation learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2205.13692</span>, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Yihan Jiang, Jakub Konečnỳ, Keith Rush, and Sreeram Kannan,

</span>
<span class="ltx_bibblock">“Improving federated learning personalization via model agnostic meta learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.12488</span>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar,

</span>
<span class="ltx_bibblock">“Personalized federated learning: A meta-learning approach,”

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2002.07948</span>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith,

</span>
<span class="ltx_bibblock">“Ditto: Fair and robust federated learning through personalization,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>. PMLR, 2021, pp. 6357–6368.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Krishna Pillutla, Kshitiz Malik, Abdelrahman Mohamed, Michael Rabbat, Maziar Sanjabi, and Lin Xiao,

</span>
<span class="ltx_bibblock">“Federated learning with partial model personalization,”

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2204.03809</span>, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Xiaoxiao Li, Meirui Jiang, Xiaofei Zhang, Michael Kamp, and Qi Dou,

</span>
<span class="ltx_bibblock">“Fedbn: Federated learning on non-iid features via local batch normalization,”

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2102.07623</span>, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai,

</span>
<span class="ltx_bibblock">“Exploiting shared representations for personalized federated learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2102.07078</span>, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Zhengquan Luo, Yunlong Wang, Zilei Wang, Zhenan Sun, and Tieniu Tan,

</span>
<span class="ltx_bibblock">“Disentangled federated learning for tackling attributes skew via invariant aggregation and diversity transferring,”

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2206.06818</span>, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Tiandi Ye, Cen Chen, Yinggui Wang, Xiang Li, and Ming Gao,

</span>
<span class="ltx_bibblock">“Upfl: Unsupervised personalized federated learning towards new clients,” 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Yuwei Sun, Ng Chong, and Hideya Ochiai,

</span>
<span class="ltx_bibblock">“Feature distribution matching for federated domain generalization,” 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Richard O Duda, Peter E Hart, et al.,

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Pattern classification</span>,

</span>
<span class="ltx_bibblock">John Wiley &amp; Sons, 2006.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Youness Aliyari Ghassabeh, Frank Rudzicz, and Hamid Abrishami Moghaddam,

</span>
<span class="ltx_bibblock">“Fast incremental lda feature extraction,”

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Pattern Recognition</span>, vol. 48, no. 6, pp. 1999–2012, 2015.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown,

</span>
<span class="ltx_bibblock">“Measuring the effects of non-identical data distribution for federated visual classification,” 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
C. Chatterjee and V.P. Roychowdhury,

</span>
<span class="ltx_bibblock">“On self-organizing algorithms and networks for class-separability features,”

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks</span>, vol. 8, no. 3, pp. 663–678, 1997.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Theory Backgrounds</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We introduce an inductive bias to align the hidden layers of a DNN so that it is able to learn client bias to achieve personalization without on-device fine-tuning. We assume data on the same client are influenced by the same client properties so that data from the similar clients will have similar representations. We formulate the representation alignment problem into an optimization described in Eq.<a href="#S4.E5" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.2" class="ltx_p">Eq.<a href="#S4.E5" title="In 4.1 Representation Alignment ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> is equivalent to the objective function of Linear Discriminant Analysis (LDA) whose solution is the enginvector of corresponding to the largest enginvalue of <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="\Sigma_{W}^{-1}\Sigma_{B}" display="inline"><semantics id="A1.p2.1.m1.1a"><mrow id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><msubsup id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml"><mi mathvariant="normal" id="A1.p2.1.m1.1.1.2.2.2" xref="A1.p2.1.m1.1.1.2.2.2.cmml">Σ</mi><mi id="A1.p2.1.m1.1.1.2.2.3" xref="A1.p2.1.m1.1.1.2.2.3.cmml">W</mi><mrow id="A1.p2.1.m1.1.1.2.3" xref="A1.p2.1.m1.1.1.2.3.cmml"><mo id="A1.p2.1.m1.1.1.2.3a" xref="A1.p2.1.m1.1.1.2.3.cmml">−</mo><mn id="A1.p2.1.m1.1.1.2.3.2" xref="A1.p2.1.m1.1.1.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.p2.1.m1.1.1.1" xref="A1.p2.1.m1.1.1.1.cmml">​</mo><msub id="A1.p2.1.m1.1.1.3" xref="A1.p2.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="A1.p2.1.m1.1.1.3.2" xref="A1.p2.1.m1.1.1.3.2.cmml">Σ</mi><mi id="A1.p2.1.m1.1.1.3.3" xref="A1.p2.1.m1.1.1.3.3.cmml">B</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><times id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1.1"></times><apply id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.p2.1.m1.1.1.2.1.cmml" xref="A1.p2.1.m1.1.1.2">superscript</csymbol><apply id="A1.p2.1.m1.1.1.2.2.cmml" xref="A1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.p2.1.m1.1.1.2.2.1.cmml" xref="A1.p2.1.m1.1.1.2">subscript</csymbol><ci id="A1.p2.1.m1.1.1.2.2.2.cmml" xref="A1.p2.1.m1.1.1.2.2.2">Σ</ci><ci id="A1.p2.1.m1.1.1.2.2.3.cmml" xref="A1.p2.1.m1.1.1.2.2.3">𝑊</ci></apply><apply id="A1.p2.1.m1.1.1.2.3.cmml" xref="A1.p2.1.m1.1.1.2.3"><minus id="A1.p2.1.m1.1.1.2.3.1.cmml" xref="A1.p2.1.m1.1.1.2.3"></minus><cn type="integer" id="A1.p2.1.m1.1.1.2.3.2.cmml" xref="A1.p2.1.m1.1.1.2.3.2">1</cn></apply></apply><apply id="A1.p2.1.m1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.p2.1.m1.1.1.3.1.cmml" xref="A1.p2.1.m1.1.1.3">subscript</csymbol><ci id="A1.p2.1.m1.1.1.3.2.cmml" xref="A1.p2.1.m1.1.1.3.2">Σ</ci><ci id="A1.p2.1.m1.1.1.3.3.cmml" xref="A1.p2.1.m1.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\Sigma_{W}^{-1}\Sigma_{B}</annotation></semantics></math>. However, the computation cost of the decomposing <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="\Sigma_{W}^{-1}\Sigma_{B}" display="inline"><semantics id="A1.p2.2.m2.1a"><mrow id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml"><msubsup id="A1.p2.2.m2.1.1.2" xref="A1.p2.2.m2.1.1.2.cmml"><mi mathvariant="normal" id="A1.p2.2.m2.1.1.2.2.2" xref="A1.p2.2.m2.1.1.2.2.2.cmml">Σ</mi><mi id="A1.p2.2.m2.1.1.2.2.3" xref="A1.p2.2.m2.1.1.2.2.3.cmml">W</mi><mrow id="A1.p2.2.m2.1.1.2.3" xref="A1.p2.2.m2.1.1.2.3.cmml"><mo id="A1.p2.2.m2.1.1.2.3a" xref="A1.p2.2.m2.1.1.2.3.cmml">−</mo><mn id="A1.p2.2.m2.1.1.2.3.2" xref="A1.p2.2.m2.1.1.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.p2.2.m2.1.1.1" xref="A1.p2.2.m2.1.1.1.cmml">​</mo><msub id="A1.p2.2.m2.1.1.3" xref="A1.p2.2.m2.1.1.3.cmml"><mi mathvariant="normal" id="A1.p2.2.m2.1.1.3.2" xref="A1.p2.2.m2.1.1.3.2.cmml">Σ</mi><mi id="A1.p2.2.m2.1.1.3.3" xref="A1.p2.2.m2.1.1.3.3.cmml">B</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><apply id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1"><times id="A1.p2.2.m2.1.1.1.cmml" xref="A1.p2.2.m2.1.1.1"></times><apply id="A1.p2.2.m2.1.1.2.cmml" xref="A1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.1.2.1.cmml" xref="A1.p2.2.m2.1.1.2">superscript</csymbol><apply id="A1.p2.2.m2.1.1.2.2.cmml" xref="A1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.1.2.2.1.cmml" xref="A1.p2.2.m2.1.1.2">subscript</csymbol><ci id="A1.p2.2.m2.1.1.2.2.2.cmml" xref="A1.p2.2.m2.1.1.2.2.2">Σ</ci><ci id="A1.p2.2.m2.1.1.2.2.3.cmml" xref="A1.p2.2.m2.1.1.2.2.3">𝑊</ci></apply><apply id="A1.p2.2.m2.1.1.2.3.cmml" xref="A1.p2.2.m2.1.1.2.3"><minus id="A1.p2.2.m2.1.1.2.3.1.cmml" xref="A1.p2.2.m2.1.1.2.3"></minus><cn type="integer" id="A1.p2.2.m2.1.1.2.3.2.cmml" xref="A1.p2.2.m2.1.1.2.3.2">1</cn></apply></apply><apply id="A1.p2.2.m2.1.1.3.cmml" xref="A1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.1.3.1.cmml" xref="A1.p2.2.m2.1.1.3">subscript</csymbol><ci id="A1.p2.2.m2.1.1.3.2.cmml" xref="A1.p2.2.m2.1.1.3.2">Σ</ci><ci id="A1.p2.2.m2.1.1.3.3.cmml" xref="A1.p2.2.m2.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">\Sigma_{W}^{-1}\Sigma_{B}</annotation></semantics></math> would be high, and aggregating local representations to a server is infeasible in FL. Therefore, we divide the matrix decomposition process into a set of clients’ local updating steps and integrate it into standard FL framework.</p>
</div>
<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Client Supervised Optimization</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.2" class="ltx_p">Let <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="\Sigma_{G}" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><msub id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml">Σ</mi><mi id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2">Σ</ci><ci id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">\Sigma_{G}</annotation></semantics></math> denote the correlation matrix of latent representations on all clients, there is <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="\Sigma_{G}=\Sigma_{W}+\Sigma_{B}" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mrow id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml"><msub id="A1.SS1.p1.2.m2.1.1.2" xref="A1.SS1.p1.2.m2.1.1.2.cmml"><mi mathvariant="normal" id="A1.SS1.p1.2.m2.1.1.2.2" xref="A1.SS1.p1.2.m2.1.1.2.2.cmml">Σ</mi><mi id="A1.SS1.p1.2.m2.1.1.2.3" xref="A1.SS1.p1.2.m2.1.1.2.3.cmml">G</mi></msub><mo id="A1.SS1.p1.2.m2.1.1.1" xref="A1.SS1.p1.2.m2.1.1.1.cmml">=</mo><mrow id="A1.SS1.p1.2.m2.1.1.3" xref="A1.SS1.p1.2.m2.1.1.3.cmml"><msub id="A1.SS1.p1.2.m2.1.1.3.2" xref="A1.SS1.p1.2.m2.1.1.3.2.cmml"><mi mathvariant="normal" id="A1.SS1.p1.2.m2.1.1.3.2.2" xref="A1.SS1.p1.2.m2.1.1.3.2.2.cmml">Σ</mi><mi id="A1.SS1.p1.2.m2.1.1.3.2.3" xref="A1.SS1.p1.2.m2.1.1.3.2.3.cmml">W</mi></msub><mo id="A1.SS1.p1.2.m2.1.1.3.1" xref="A1.SS1.p1.2.m2.1.1.3.1.cmml">+</mo><msub id="A1.SS1.p1.2.m2.1.1.3.3" xref="A1.SS1.p1.2.m2.1.1.3.3.cmml"><mi mathvariant="normal" id="A1.SS1.p1.2.m2.1.1.3.3.2" xref="A1.SS1.p1.2.m2.1.1.3.3.2.cmml">Σ</mi><mi id="A1.SS1.p1.2.m2.1.1.3.3.3" xref="A1.SS1.p1.2.m2.1.1.3.3.3.cmml">B</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><apply id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1"><eq id="A1.SS1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1.1"></eq><apply id="A1.SS1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.2.2">Σ</ci><ci id="A1.SS1.p1.2.m2.1.1.2.3.cmml" xref="A1.SS1.p1.2.m2.1.1.2.3">𝐺</ci></apply><apply id="A1.SS1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3"><plus id="A1.SS1.p1.2.m2.1.1.3.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.1"></plus><apply id="A1.SS1.p1.2.m2.1.1.3.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.3.2.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.3.2.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.2">Σ</ci><ci id="A1.SS1.p1.2.m2.1.1.3.2.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.2.3">𝑊</ci></apply><apply id="A1.SS1.p1.2.m2.1.1.3.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="A1.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3.2">Σ</ci><ci id="A1.SS1.p1.2.m2.1.1.3.3.3.cmml" xref="A1.SS1.p1.2.m2.1.1.3.3.3">𝐵</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">\Sigma_{G}=\Sigma_{W}+\Sigma_{B}</annotation></semantics></math>. Then the learning problem can be formulate as solving the following eigenvalue problem</p>
<table id="A1.E10" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A1.E10X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E10X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\Sigma_{W}^{-1}\Sigma_{G}P^{*}=P^{*}\Lambda" display="inline"><semantics id="A1.E10X.2.1.1.m1.1a"><mrow id="A1.E10X.2.1.1.m1.1.1" xref="A1.E10X.2.1.1.m1.1.1.cmml"><mrow id="A1.E10X.2.1.1.m1.1.1.2" xref="A1.E10X.2.1.1.m1.1.1.2.cmml"><msubsup id="A1.E10X.2.1.1.m1.1.1.2.2" xref="A1.E10X.2.1.1.m1.1.1.2.2.cmml"><mi mathvariant="normal" id="A1.E10X.2.1.1.m1.1.1.2.2.2.2" xref="A1.E10X.2.1.1.m1.1.1.2.2.2.2.cmml">Σ</mi><mi id="A1.E10X.2.1.1.m1.1.1.2.2.2.3" xref="A1.E10X.2.1.1.m1.1.1.2.2.2.3.cmml">W</mi><mrow id="A1.E10X.2.1.1.m1.1.1.2.2.3" xref="A1.E10X.2.1.1.m1.1.1.2.2.3.cmml"><mo id="A1.E10X.2.1.1.m1.1.1.2.2.3a" xref="A1.E10X.2.1.1.m1.1.1.2.2.3.cmml">−</mo><mn id="A1.E10X.2.1.1.m1.1.1.2.2.3.2" xref="A1.E10X.2.1.1.m1.1.1.2.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E10X.2.1.1.m1.1.1.2.1" xref="A1.E10X.2.1.1.m1.1.1.2.1.cmml">​</mo><msub id="A1.E10X.2.1.1.m1.1.1.2.3" xref="A1.E10X.2.1.1.m1.1.1.2.3.cmml"><mi mathvariant="normal" id="A1.E10X.2.1.1.m1.1.1.2.3.2" xref="A1.E10X.2.1.1.m1.1.1.2.3.2.cmml">Σ</mi><mi id="A1.E10X.2.1.1.m1.1.1.2.3.3" xref="A1.E10X.2.1.1.m1.1.1.2.3.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="A1.E10X.2.1.1.m1.1.1.2.1a" xref="A1.E10X.2.1.1.m1.1.1.2.1.cmml">​</mo><msup id="A1.E10X.2.1.1.m1.1.1.2.4" xref="A1.E10X.2.1.1.m1.1.1.2.4.cmml"><mi id="A1.E10X.2.1.1.m1.1.1.2.4.2" xref="A1.E10X.2.1.1.m1.1.1.2.4.2.cmml">P</mi><mo id="A1.E10X.2.1.1.m1.1.1.2.4.3" xref="A1.E10X.2.1.1.m1.1.1.2.4.3.cmml">∗</mo></msup></mrow><mo id="A1.E10X.2.1.1.m1.1.1.1" xref="A1.E10X.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="A1.E10X.2.1.1.m1.1.1.3" xref="A1.E10X.2.1.1.m1.1.1.3.cmml"><msup id="A1.E10X.2.1.1.m1.1.1.3.2" xref="A1.E10X.2.1.1.m1.1.1.3.2.cmml"><mi id="A1.E10X.2.1.1.m1.1.1.3.2.2" xref="A1.E10X.2.1.1.m1.1.1.3.2.2.cmml">P</mi><mo id="A1.E10X.2.1.1.m1.1.1.3.2.3" xref="A1.E10X.2.1.1.m1.1.1.3.2.3.cmml">∗</mo></msup><mo lspace="0em" rspace="0em" id="A1.E10X.2.1.1.m1.1.1.3.1" xref="A1.E10X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A1.E10X.2.1.1.m1.1.1.3.3" xref="A1.E10X.2.1.1.m1.1.1.3.3.cmml">Λ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10X.2.1.1.m1.1b"><apply id="A1.E10X.2.1.1.m1.1.1.cmml" xref="A1.E10X.2.1.1.m1.1.1"><eq id="A1.E10X.2.1.1.m1.1.1.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.1"></eq><apply id="A1.E10X.2.1.1.m1.1.1.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.2"><times id="A1.E10X.2.1.1.m1.1.1.2.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.1"></times><apply id="A1.E10X.2.1.1.m1.1.1.2.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E10X.2.1.1.m1.1.1.2.2.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2">superscript</csymbol><apply id="A1.E10X.2.1.1.m1.1.1.2.2.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E10X.2.1.1.m1.1.1.2.2.2.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2">subscript</csymbol><ci id="A1.E10X.2.1.1.m1.1.1.2.2.2.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2.2.2">Σ</ci><ci id="A1.E10X.2.1.1.m1.1.1.2.2.2.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2.2.3">𝑊</ci></apply><apply id="A1.E10X.2.1.1.m1.1.1.2.2.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2.3"><minus id="A1.E10X.2.1.1.m1.1.1.2.2.3.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2.3"></minus><cn type="integer" id="A1.E10X.2.1.1.m1.1.1.2.2.3.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.2.3.2">1</cn></apply></apply><apply id="A1.E10X.2.1.1.m1.1.1.2.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E10X.2.1.1.m1.1.1.2.3.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.3">subscript</csymbol><ci id="A1.E10X.2.1.1.m1.1.1.2.3.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.3.2">Σ</ci><ci id="A1.E10X.2.1.1.m1.1.1.2.3.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.3.3">𝐺</ci></apply><apply id="A1.E10X.2.1.1.m1.1.1.2.4.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.4"><csymbol cd="ambiguous" id="A1.E10X.2.1.1.m1.1.1.2.4.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.4">superscript</csymbol><ci id="A1.E10X.2.1.1.m1.1.1.2.4.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.4.2">𝑃</ci><times id="A1.E10X.2.1.1.m1.1.1.2.4.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.2.4.3"></times></apply></apply><apply id="A1.E10X.2.1.1.m1.1.1.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.3"><times id="A1.E10X.2.1.1.m1.1.1.3.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.3.1"></times><apply id="A1.E10X.2.1.1.m1.1.1.3.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E10X.2.1.1.m1.1.1.3.2.1.cmml" xref="A1.E10X.2.1.1.m1.1.1.3.2">superscript</csymbol><ci id="A1.E10X.2.1.1.m1.1.1.3.2.2.cmml" xref="A1.E10X.2.1.1.m1.1.1.3.2.2">𝑃</ci><times id="A1.E10X.2.1.1.m1.1.1.3.2.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.3.2.3"></times></apply><ci id="A1.E10X.2.1.1.m1.1.1.3.3.cmml" xref="A1.E10X.2.1.1.m1.1.1.3.3">Λ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10X.2.1.1.m1.1c">\displaystyle\Sigma_{W}^{-1}\Sigma_{G}P^{*}=P^{*}\Lambda</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
</tbody>
</table>
<p id="A1.SS1.p1.4" class="ltx_p">where <math id="A1.SS1.p1.3.m1.1" class="ltx_Math" alttext="\Lambda" display="inline"><semantics id="A1.SS1.p1.3.m1.1a"><mi mathvariant="normal" id="A1.SS1.p1.3.m1.1.1" xref="A1.SS1.p1.3.m1.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m1.1b"><ci id="A1.SS1.p1.3.m1.1.1.cmml" xref="A1.SS1.p1.3.m1.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m1.1c">\Lambda</annotation></semantics></math> is the diagonal eigenvalue matrix of <math id="A1.SS1.p1.4.m2.1" class="ltx_Math" alttext="\Sigma_{W}^{-1}\Sigma_{G}" display="inline"><semantics id="A1.SS1.p1.4.m2.1a"><mrow id="A1.SS1.p1.4.m2.1.1" xref="A1.SS1.p1.4.m2.1.1.cmml"><msubsup id="A1.SS1.p1.4.m2.1.1.2" xref="A1.SS1.p1.4.m2.1.1.2.cmml"><mi mathvariant="normal" id="A1.SS1.p1.4.m2.1.1.2.2.2" xref="A1.SS1.p1.4.m2.1.1.2.2.2.cmml">Σ</mi><mi id="A1.SS1.p1.4.m2.1.1.2.2.3" xref="A1.SS1.p1.4.m2.1.1.2.2.3.cmml">W</mi><mrow id="A1.SS1.p1.4.m2.1.1.2.3" xref="A1.SS1.p1.4.m2.1.1.2.3.cmml"><mo id="A1.SS1.p1.4.m2.1.1.2.3a" xref="A1.SS1.p1.4.m2.1.1.2.3.cmml">−</mo><mn id="A1.SS1.p1.4.m2.1.1.2.3.2" xref="A1.SS1.p1.4.m2.1.1.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.SS1.p1.4.m2.1.1.1" xref="A1.SS1.p1.4.m2.1.1.1.cmml">​</mo><msub id="A1.SS1.p1.4.m2.1.1.3" xref="A1.SS1.p1.4.m2.1.1.3.cmml"><mi mathvariant="normal" id="A1.SS1.p1.4.m2.1.1.3.2" xref="A1.SS1.p1.4.m2.1.1.3.2.cmml">Σ</mi><mi id="A1.SS1.p1.4.m2.1.1.3.3" xref="A1.SS1.p1.4.m2.1.1.3.3.cmml">G</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m2.1b"><apply id="A1.SS1.p1.4.m2.1.1.cmml" xref="A1.SS1.p1.4.m2.1.1"><times id="A1.SS1.p1.4.m2.1.1.1.cmml" xref="A1.SS1.p1.4.m2.1.1.1"></times><apply id="A1.SS1.p1.4.m2.1.1.2.cmml" xref="A1.SS1.p1.4.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m2.1.1.2.1.cmml" xref="A1.SS1.p1.4.m2.1.1.2">superscript</csymbol><apply id="A1.SS1.p1.4.m2.1.1.2.2.cmml" xref="A1.SS1.p1.4.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m2.1.1.2.2.1.cmml" xref="A1.SS1.p1.4.m2.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.4.m2.1.1.2.2.2.cmml" xref="A1.SS1.p1.4.m2.1.1.2.2.2">Σ</ci><ci id="A1.SS1.p1.4.m2.1.1.2.2.3.cmml" xref="A1.SS1.p1.4.m2.1.1.2.2.3">𝑊</ci></apply><apply id="A1.SS1.p1.4.m2.1.1.2.3.cmml" xref="A1.SS1.p1.4.m2.1.1.2.3"><minus id="A1.SS1.p1.4.m2.1.1.2.3.1.cmml" xref="A1.SS1.p1.4.m2.1.1.2.3"></minus><cn type="integer" id="A1.SS1.p1.4.m2.1.1.2.3.2.cmml" xref="A1.SS1.p1.4.m2.1.1.2.3.2">1</cn></apply></apply><apply id="A1.SS1.p1.4.m2.1.1.3.cmml" xref="A1.SS1.p1.4.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.4.m2.1.1.3.1.cmml" xref="A1.SS1.p1.4.m2.1.1.3">subscript</csymbol><ci id="A1.SS1.p1.4.m2.1.1.3.2.cmml" xref="A1.SS1.p1.4.m2.1.1.3.2">Σ</ci><ci id="A1.SS1.p1.4.m2.1.1.3.3.cmml" xref="A1.SS1.p1.4.m2.1.1.3.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m2.1c">\Sigma_{W}^{-1}\Sigma_{G}</annotation></semantics></math>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> shows solving Eq.<a href="#A1.E10" title="In A.1 Client Supervised Optimization ‣ Appendix A Theory Backgrounds ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> can be simplified into solving the following symmetric eigenvalue problem:</p>
<table id="A1.E11" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A1.E11X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E11X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\Sigma_{W}^{-1/2}\Sigma_{G}\Sigma_{W}^{-1/2}\Phi=\Phi\Lambda" display="inline"><semantics id="A1.E11X.2.1.1.m1.1a"><mrow id="A1.E11X.2.1.1.m1.1.1" xref="A1.E11X.2.1.1.m1.1.1.cmml"><mrow id="A1.E11X.2.1.1.m1.1.1.2" xref="A1.E11X.2.1.1.m1.1.1.2.cmml"><msubsup id="A1.E11X.2.1.1.m1.1.1.2.2" xref="A1.E11X.2.1.1.m1.1.1.2.2.cmml"><mi mathvariant="normal" id="A1.E11X.2.1.1.m1.1.1.2.2.2.2" xref="A1.E11X.2.1.1.m1.1.1.2.2.2.2.cmml">Σ</mi><mi id="A1.E11X.2.1.1.m1.1.1.2.2.2.3" xref="A1.E11X.2.1.1.m1.1.1.2.2.2.3.cmml">W</mi><mrow id="A1.E11X.2.1.1.m1.1.1.2.2.3" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.cmml"><mo id="A1.E11X.2.1.1.m1.1.1.2.2.3a" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.cmml">−</mo><mrow id="A1.E11X.2.1.1.m1.1.1.2.2.3.2" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2.cmml"><mn id="A1.E11X.2.1.1.m1.1.1.2.2.3.2.2" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2.2.cmml">1</mn><mo id="A1.E11X.2.1.1.m1.1.1.2.2.3.2.1" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2.1.cmml">/</mo><mn id="A1.E11X.2.1.1.m1.1.1.2.2.3.2.3" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E11X.2.1.1.m1.1.1.2.1" xref="A1.E11X.2.1.1.m1.1.1.2.1.cmml">​</mo><msub id="A1.E11X.2.1.1.m1.1.1.2.3" xref="A1.E11X.2.1.1.m1.1.1.2.3.cmml"><mi mathvariant="normal" id="A1.E11X.2.1.1.m1.1.1.2.3.2" xref="A1.E11X.2.1.1.m1.1.1.2.3.2.cmml">Σ</mi><mi id="A1.E11X.2.1.1.m1.1.1.2.3.3" xref="A1.E11X.2.1.1.m1.1.1.2.3.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="A1.E11X.2.1.1.m1.1.1.2.1a" xref="A1.E11X.2.1.1.m1.1.1.2.1.cmml">​</mo><msubsup id="A1.E11X.2.1.1.m1.1.1.2.4" xref="A1.E11X.2.1.1.m1.1.1.2.4.cmml"><mi mathvariant="normal" id="A1.E11X.2.1.1.m1.1.1.2.4.2.2" xref="A1.E11X.2.1.1.m1.1.1.2.4.2.2.cmml">Σ</mi><mi id="A1.E11X.2.1.1.m1.1.1.2.4.2.3" xref="A1.E11X.2.1.1.m1.1.1.2.4.2.3.cmml">W</mi><mrow id="A1.E11X.2.1.1.m1.1.1.2.4.3" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.cmml"><mo id="A1.E11X.2.1.1.m1.1.1.2.4.3a" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.cmml">−</mo><mrow id="A1.E11X.2.1.1.m1.1.1.2.4.3.2" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2.cmml"><mn id="A1.E11X.2.1.1.m1.1.1.2.4.3.2.2" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2.2.cmml">1</mn><mo id="A1.E11X.2.1.1.m1.1.1.2.4.3.2.1" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2.1.cmml">/</mo><mn id="A1.E11X.2.1.1.m1.1.1.2.4.3.2.3" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.E11X.2.1.1.m1.1.1.2.1b" xref="A1.E11X.2.1.1.m1.1.1.2.1.cmml">​</mo><mi mathvariant="normal" id="A1.E11X.2.1.1.m1.1.1.2.5" xref="A1.E11X.2.1.1.m1.1.1.2.5.cmml">Φ</mi></mrow><mo id="A1.E11X.2.1.1.m1.1.1.1" xref="A1.E11X.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="A1.E11X.2.1.1.m1.1.1.3" xref="A1.E11X.2.1.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="A1.E11X.2.1.1.m1.1.1.3.2" xref="A1.E11X.2.1.1.m1.1.1.3.2.cmml">Φ</mi><mo lspace="0em" rspace="0em" id="A1.E11X.2.1.1.m1.1.1.3.1" xref="A1.E11X.2.1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A1.E11X.2.1.1.m1.1.1.3.3" xref="A1.E11X.2.1.1.m1.1.1.3.3.cmml">Λ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11X.2.1.1.m1.1b"><apply id="A1.E11X.2.1.1.m1.1.1.cmml" xref="A1.E11X.2.1.1.m1.1.1"><eq id="A1.E11X.2.1.1.m1.1.1.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.1"></eq><apply id="A1.E11X.2.1.1.m1.1.1.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2"><times id="A1.E11X.2.1.1.m1.1.1.2.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.1"></times><apply id="A1.E11X.2.1.1.m1.1.1.2.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E11X.2.1.1.m1.1.1.2.2.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2">superscript</csymbol><apply id="A1.E11X.2.1.1.m1.1.1.2.2.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E11X.2.1.1.m1.1.1.2.2.2.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2">subscript</csymbol><ci id="A1.E11X.2.1.1.m1.1.1.2.2.2.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.2.2">Σ</ci><ci id="A1.E11X.2.1.1.m1.1.1.2.2.2.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.2.3">𝑊</ci></apply><apply id="A1.E11X.2.1.1.m1.1.1.2.2.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.3"><minus id="A1.E11X.2.1.1.m1.1.1.2.2.3.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.3"></minus><apply id="A1.E11X.2.1.1.m1.1.1.2.2.3.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2"><divide id="A1.E11X.2.1.1.m1.1.1.2.2.3.2.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2.1"></divide><cn type="integer" id="A1.E11X.2.1.1.m1.1.1.2.2.3.2.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2.2">1</cn><cn type="integer" id="A1.E11X.2.1.1.m1.1.1.2.2.3.2.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.2.3.2.3">2</cn></apply></apply></apply><apply id="A1.E11X.2.1.1.m1.1.1.2.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E11X.2.1.1.m1.1.1.2.3.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.3">subscript</csymbol><ci id="A1.E11X.2.1.1.m1.1.1.2.3.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.3.2">Σ</ci><ci id="A1.E11X.2.1.1.m1.1.1.2.3.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.3.3">𝐺</ci></apply><apply id="A1.E11X.2.1.1.m1.1.1.2.4.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4"><csymbol cd="ambiguous" id="A1.E11X.2.1.1.m1.1.1.2.4.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4">superscript</csymbol><apply id="A1.E11X.2.1.1.m1.1.1.2.4.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4"><csymbol cd="ambiguous" id="A1.E11X.2.1.1.m1.1.1.2.4.2.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4">subscript</csymbol><ci id="A1.E11X.2.1.1.m1.1.1.2.4.2.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.2.2">Σ</ci><ci id="A1.E11X.2.1.1.m1.1.1.2.4.2.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.2.3">𝑊</ci></apply><apply id="A1.E11X.2.1.1.m1.1.1.2.4.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.3"><minus id="A1.E11X.2.1.1.m1.1.1.2.4.3.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.3"></minus><apply id="A1.E11X.2.1.1.m1.1.1.2.4.3.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2"><divide id="A1.E11X.2.1.1.m1.1.1.2.4.3.2.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2.1"></divide><cn type="integer" id="A1.E11X.2.1.1.m1.1.1.2.4.3.2.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2.2">1</cn><cn type="integer" id="A1.E11X.2.1.1.m1.1.1.2.4.3.2.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.4.3.2.3">2</cn></apply></apply></apply><ci id="A1.E11X.2.1.1.m1.1.1.2.5.cmml" xref="A1.E11X.2.1.1.m1.1.1.2.5">Φ</ci></apply><apply id="A1.E11X.2.1.1.m1.1.1.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.3"><times id="A1.E11X.2.1.1.m1.1.1.3.1.cmml" xref="A1.E11X.2.1.1.m1.1.1.3.1"></times><ci id="A1.E11X.2.1.1.m1.1.1.3.2.cmml" xref="A1.E11X.2.1.1.m1.1.1.3.2">Φ</ci><ci id="A1.E11X.2.1.1.m1.1.1.3.3.cmml" xref="A1.E11X.2.1.1.m1.1.1.3.3">Λ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11X.2.1.1.m1.1c">\displaystyle\Sigma_{W}^{-1/2}\Sigma_{G}\Sigma_{W}^{-1/2}\Phi=\Phi\Lambda</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
</tbody>
</table>
<p id="A1.SS1.p1.10" class="ltx_p">where <math id="A1.SS1.p1.5.m1.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="A1.SS1.p1.5.m1.1a"><mi mathvariant="normal" id="A1.SS1.p1.5.m1.1.1" xref="A1.SS1.p1.5.m1.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.5.m1.1b"><ci id="A1.SS1.p1.5.m1.1.1.cmml" xref="A1.SS1.p1.5.m1.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.5.m1.1c">\Phi</annotation></semantics></math> denotes eignevectors of <math id="A1.SS1.p1.6.m2.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}\Sigma_{G}\Sigma_{W}^{-1/2}" display="inline"><semantics id="A1.SS1.p1.6.m2.1a"><mrow id="A1.SS1.p1.6.m2.1.1" xref="A1.SS1.p1.6.m2.1.1.cmml"><msubsup id="A1.SS1.p1.6.m2.1.1.2" xref="A1.SS1.p1.6.m2.1.1.2.cmml"><mi mathvariant="normal" id="A1.SS1.p1.6.m2.1.1.2.2.2" xref="A1.SS1.p1.6.m2.1.1.2.2.2.cmml">Σ</mi><mi id="A1.SS1.p1.6.m2.1.1.2.2.3" xref="A1.SS1.p1.6.m2.1.1.2.2.3.cmml">W</mi><mrow id="A1.SS1.p1.6.m2.1.1.2.3" xref="A1.SS1.p1.6.m2.1.1.2.3.cmml"><mo id="A1.SS1.p1.6.m2.1.1.2.3a" xref="A1.SS1.p1.6.m2.1.1.2.3.cmml">−</mo><mrow id="A1.SS1.p1.6.m2.1.1.2.3.2" xref="A1.SS1.p1.6.m2.1.1.2.3.2.cmml"><mn id="A1.SS1.p1.6.m2.1.1.2.3.2.2" xref="A1.SS1.p1.6.m2.1.1.2.3.2.2.cmml">1</mn><mo id="A1.SS1.p1.6.m2.1.1.2.3.2.1" xref="A1.SS1.p1.6.m2.1.1.2.3.2.1.cmml">/</mo><mn id="A1.SS1.p1.6.m2.1.1.2.3.2.3" xref="A1.SS1.p1.6.m2.1.1.2.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.SS1.p1.6.m2.1.1.1" xref="A1.SS1.p1.6.m2.1.1.1.cmml">​</mo><msub id="A1.SS1.p1.6.m2.1.1.3" xref="A1.SS1.p1.6.m2.1.1.3.cmml"><mi mathvariant="normal" id="A1.SS1.p1.6.m2.1.1.3.2" xref="A1.SS1.p1.6.m2.1.1.3.2.cmml">Σ</mi><mi id="A1.SS1.p1.6.m2.1.1.3.3" xref="A1.SS1.p1.6.m2.1.1.3.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="A1.SS1.p1.6.m2.1.1.1a" xref="A1.SS1.p1.6.m2.1.1.1.cmml">​</mo><msubsup id="A1.SS1.p1.6.m2.1.1.4" xref="A1.SS1.p1.6.m2.1.1.4.cmml"><mi mathvariant="normal" id="A1.SS1.p1.6.m2.1.1.4.2.2" xref="A1.SS1.p1.6.m2.1.1.4.2.2.cmml">Σ</mi><mi id="A1.SS1.p1.6.m2.1.1.4.2.3" xref="A1.SS1.p1.6.m2.1.1.4.2.3.cmml">W</mi><mrow id="A1.SS1.p1.6.m2.1.1.4.3" xref="A1.SS1.p1.6.m2.1.1.4.3.cmml"><mo id="A1.SS1.p1.6.m2.1.1.4.3a" xref="A1.SS1.p1.6.m2.1.1.4.3.cmml">−</mo><mrow id="A1.SS1.p1.6.m2.1.1.4.3.2" xref="A1.SS1.p1.6.m2.1.1.4.3.2.cmml"><mn id="A1.SS1.p1.6.m2.1.1.4.3.2.2" xref="A1.SS1.p1.6.m2.1.1.4.3.2.2.cmml">1</mn><mo id="A1.SS1.p1.6.m2.1.1.4.3.2.1" xref="A1.SS1.p1.6.m2.1.1.4.3.2.1.cmml">/</mo><mn id="A1.SS1.p1.6.m2.1.1.4.3.2.3" xref="A1.SS1.p1.6.m2.1.1.4.3.2.3.cmml">2</mn></mrow></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.6.m2.1b"><apply id="A1.SS1.p1.6.m2.1.1.cmml" xref="A1.SS1.p1.6.m2.1.1"><times id="A1.SS1.p1.6.m2.1.1.1.cmml" xref="A1.SS1.p1.6.m2.1.1.1"></times><apply id="A1.SS1.p1.6.m2.1.1.2.cmml" xref="A1.SS1.p1.6.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m2.1.1.2.1.cmml" xref="A1.SS1.p1.6.m2.1.1.2">superscript</csymbol><apply id="A1.SS1.p1.6.m2.1.1.2.2.cmml" xref="A1.SS1.p1.6.m2.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m2.1.1.2.2.1.cmml" xref="A1.SS1.p1.6.m2.1.1.2">subscript</csymbol><ci id="A1.SS1.p1.6.m2.1.1.2.2.2.cmml" xref="A1.SS1.p1.6.m2.1.1.2.2.2">Σ</ci><ci id="A1.SS1.p1.6.m2.1.1.2.2.3.cmml" xref="A1.SS1.p1.6.m2.1.1.2.2.3">𝑊</ci></apply><apply id="A1.SS1.p1.6.m2.1.1.2.3.cmml" xref="A1.SS1.p1.6.m2.1.1.2.3"><minus id="A1.SS1.p1.6.m2.1.1.2.3.1.cmml" xref="A1.SS1.p1.6.m2.1.1.2.3"></minus><apply id="A1.SS1.p1.6.m2.1.1.2.3.2.cmml" xref="A1.SS1.p1.6.m2.1.1.2.3.2"><divide id="A1.SS1.p1.6.m2.1.1.2.3.2.1.cmml" xref="A1.SS1.p1.6.m2.1.1.2.3.2.1"></divide><cn type="integer" id="A1.SS1.p1.6.m2.1.1.2.3.2.2.cmml" xref="A1.SS1.p1.6.m2.1.1.2.3.2.2">1</cn><cn type="integer" id="A1.SS1.p1.6.m2.1.1.2.3.2.3.cmml" xref="A1.SS1.p1.6.m2.1.1.2.3.2.3">2</cn></apply></apply></apply><apply id="A1.SS1.p1.6.m2.1.1.3.cmml" xref="A1.SS1.p1.6.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m2.1.1.3.1.cmml" xref="A1.SS1.p1.6.m2.1.1.3">subscript</csymbol><ci id="A1.SS1.p1.6.m2.1.1.3.2.cmml" xref="A1.SS1.p1.6.m2.1.1.3.2">Σ</ci><ci id="A1.SS1.p1.6.m2.1.1.3.3.cmml" xref="A1.SS1.p1.6.m2.1.1.3.3">𝐺</ci></apply><apply id="A1.SS1.p1.6.m2.1.1.4.cmml" xref="A1.SS1.p1.6.m2.1.1.4"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m2.1.1.4.1.cmml" xref="A1.SS1.p1.6.m2.1.1.4">superscript</csymbol><apply id="A1.SS1.p1.6.m2.1.1.4.2.cmml" xref="A1.SS1.p1.6.m2.1.1.4"><csymbol cd="ambiguous" id="A1.SS1.p1.6.m2.1.1.4.2.1.cmml" xref="A1.SS1.p1.6.m2.1.1.4">subscript</csymbol><ci id="A1.SS1.p1.6.m2.1.1.4.2.2.cmml" xref="A1.SS1.p1.6.m2.1.1.4.2.2">Σ</ci><ci id="A1.SS1.p1.6.m2.1.1.4.2.3.cmml" xref="A1.SS1.p1.6.m2.1.1.4.2.3">𝑊</ci></apply><apply id="A1.SS1.p1.6.m2.1.1.4.3.cmml" xref="A1.SS1.p1.6.m2.1.1.4.3"><minus id="A1.SS1.p1.6.m2.1.1.4.3.1.cmml" xref="A1.SS1.p1.6.m2.1.1.4.3"></minus><apply id="A1.SS1.p1.6.m2.1.1.4.3.2.cmml" xref="A1.SS1.p1.6.m2.1.1.4.3.2"><divide id="A1.SS1.p1.6.m2.1.1.4.3.2.1.cmml" xref="A1.SS1.p1.6.m2.1.1.4.3.2.1"></divide><cn type="integer" id="A1.SS1.p1.6.m2.1.1.4.3.2.2.cmml" xref="A1.SS1.p1.6.m2.1.1.4.3.2.2">1</cn><cn type="integer" id="A1.SS1.p1.6.m2.1.1.4.3.2.3.cmml" xref="A1.SS1.p1.6.m2.1.1.4.3.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.6.m2.1c">\Sigma_{W}^{-1/2}\Sigma_{G}\Sigma_{W}^{-1/2}</annotation></semantics></math>, and there is <math id="A1.SS1.p1.7.m3.1" class="ltx_Math" alttext="P^{*}=\Sigma_{W}^{-1/2}\Phi" display="inline"><semantics id="A1.SS1.p1.7.m3.1a"><mrow id="A1.SS1.p1.7.m3.1.1" xref="A1.SS1.p1.7.m3.1.1.cmml"><msup id="A1.SS1.p1.7.m3.1.1.2" xref="A1.SS1.p1.7.m3.1.1.2.cmml"><mi id="A1.SS1.p1.7.m3.1.1.2.2" xref="A1.SS1.p1.7.m3.1.1.2.2.cmml">P</mi><mo id="A1.SS1.p1.7.m3.1.1.2.3" xref="A1.SS1.p1.7.m3.1.1.2.3.cmml">∗</mo></msup><mo id="A1.SS1.p1.7.m3.1.1.1" xref="A1.SS1.p1.7.m3.1.1.1.cmml">=</mo><mrow id="A1.SS1.p1.7.m3.1.1.3" xref="A1.SS1.p1.7.m3.1.1.3.cmml"><msubsup id="A1.SS1.p1.7.m3.1.1.3.2" xref="A1.SS1.p1.7.m3.1.1.3.2.cmml"><mi mathvariant="normal" id="A1.SS1.p1.7.m3.1.1.3.2.2.2" xref="A1.SS1.p1.7.m3.1.1.3.2.2.2.cmml">Σ</mi><mi id="A1.SS1.p1.7.m3.1.1.3.2.2.3" xref="A1.SS1.p1.7.m3.1.1.3.2.2.3.cmml">W</mi><mrow id="A1.SS1.p1.7.m3.1.1.3.2.3" xref="A1.SS1.p1.7.m3.1.1.3.2.3.cmml"><mo id="A1.SS1.p1.7.m3.1.1.3.2.3a" xref="A1.SS1.p1.7.m3.1.1.3.2.3.cmml">−</mo><mrow id="A1.SS1.p1.7.m3.1.1.3.2.3.2" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2.cmml"><mn id="A1.SS1.p1.7.m3.1.1.3.2.3.2.2" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2.2.cmml">1</mn><mo id="A1.SS1.p1.7.m3.1.1.3.2.3.2.1" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2.1.cmml">/</mo><mn id="A1.SS1.p1.7.m3.1.1.3.2.3.2.3" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2.3.cmml">2</mn></mrow></mrow></msubsup><mo lspace="0em" rspace="0em" id="A1.SS1.p1.7.m3.1.1.3.1" xref="A1.SS1.p1.7.m3.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="A1.SS1.p1.7.m3.1.1.3.3" xref="A1.SS1.p1.7.m3.1.1.3.3.cmml">Φ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.7.m3.1b"><apply id="A1.SS1.p1.7.m3.1.1.cmml" xref="A1.SS1.p1.7.m3.1.1"><eq id="A1.SS1.p1.7.m3.1.1.1.cmml" xref="A1.SS1.p1.7.m3.1.1.1"></eq><apply id="A1.SS1.p1.7.m3.1.1.2.cmml" xref="A1.SS1.p1.7.m3.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m3.1.1.2.1.cmml" xref="A1.SS1.p1.7.m3.1.1.2">superscript</csymbol><ci id="A1.SS1.p1.7.m3.1.1.2.2.cmml" xref="A1.SS1.p1.7.m3.1.1.2.2">𝑃</ci><times id="A1.SS1.p1.7.m3.1.1.2.3.cmml" xref="A1.SS1.p1.7.m3.1.1.2.3"></times></apply><apply id="A1.SS1.p1.7.m3.1.1.3.cmml" xref="A1.SS1.p1.7.m3.1.1.3"><times id="A1.SS1.p1.7.m3.1.1.3.1.cmml" xref="A1.SS1.p1.7.m3.1.1.3.1"></times><apply id="A1.SS1.p1.7.m3.1.1.3.2.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m3.1.1.3.2.1.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2">superscript</csymbol><apply id="A1.SS1.p1.7.m3.1.1.3.2.2.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS1.p1.7.m3.1.1.3.2.2.1.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2">subscript</csymbol><ci id="A1.SS1.p1.7.m3.1.1.3.2.2.2.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.2.2">Σ</ci><ci id="A1.SS1.p1.7.m3.1.1.3.2.2.3.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.2.3">𝑊</ci></apply><apply id="A1.SS1.p1.7.m3.1.1.3.2.3.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.3"><minus id="A1.SS1.p1.7.m3.1.1.3.2.3.1.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.3"></minus><apply id="A1.SS1.p1.7.m3.1.1.3.2.3.2.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2"><divide id="A1.SS1.p1.7.m3.1.1.3.2.3.2.1.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2.1"></divide><cn type="integer" id="A1.SS1.p1.7.m3.1.1.3.2.3.2.2.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2.2">1</cn><cn type="integer" id="A1.SS1.p1.7.m3.1.1.3.2.3.2.3.cmml" xref="A1.SS1.p1.7.m3.1.1.3.2.3.2.3">2</cn></apply></apply></apply><ci id="A1.SS1.p1.7.m3.1.1.3.3.cmml" xref="A1.SS1.p1.7.m3.1.1.3.3">Φ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.7.m3.1c">P^{*}=\Sigma_{W}^{-1/2}\Phi</annotation></semantics></math>. To find the optimum <math id="A1.SS1.p1.8.m4.1" class="ltx_Math" alttext="P^{*}" display="inline"><semantics id="A1.SS1.p1.8.m4.1a"><msup id="A1.SS1.p1.8.m4.1.1" xref="A1.SS1.p1.8.m4.1.1.cmml"><mi id="A1.SS1.p1.8.m4.1.1.2" xref="A1.SS1.p1.8.m4.1.1.2.cmml">P</mi><mo id="A1.SS1.p1.8.m4.1.1.3" xref="A1.SS1.p1.8.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.8.m4.1b"><apply id="A1.SS1.p1.8.m4.1.1.cmml" xref="A1.SS1.p1.8.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.8.m4.1.1.1.cmml" xref="A1.SS1.p1.8.m4.1.1">superscript</csymbol><ci id="A1.SS1.p1.8.m4.1.1.2.cmml" xref="A1.SS1.p1.8.m4.1.1.2">𝑃</ci><times id="A1.SS1.p1.8.m4.1.1.3.cmml" xref="A1.SS1.p1.8.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.8.m4.1c">P^{*}</annotation></semantics></math> is to find <math id="A1.SS1.p1.9.m5.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="A1.SS1.p1.9.m5.1a"><mi mathvariant="normal" id="A1.SS1.p1.9.m5.1.1" xref="A1.SS1.p1.9.m5.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.9.m5.1b"><ci id="A1.SS1.p1.9.m5.1.1.cmml" xref="A1.SS1.p1.9.m5.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.9.m5.1c">\Phi</annotation></semantics></math> and <math id="A1.SS1.p1.10.m6.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="A1.SS1.p1.10.m6.1a"><msubsup id="A1.SS1.p1.10.m6.1.1" xref="A1.SS1.p1.10.m6.1.1.cmml"><mi mathvariant="normal" id="A1.SS1.p1.10.m6.1.1.2.2" xref="A1.SS1.p1.10.m6.1.1.2.2.cmml">Σ</mi><mi id="A1.SS1.p1.10.m6.1.1.2.3" xref="A1.SS1.p1.10.m6.1.1.2.3.cmml">W</mi><mrow id="A1.SS1.p1.10.m6.1.1.3" xref="A1.SS1.p1.10.m6.1.1.3.cmml"><mo id="A1.SS1.p1.10.m6.1.1.3a" xref="A1.SS1.p1.10.m6.1.1.3.cmml">−</mo><mrow id="A1.SS1.p1.10.m6.1.1.3.2" xref="A1.SS1.p1.10.m6.1.1.3.2.cmml"><mn id="A1.SS1.p1.10.m6.1.1.3.2.2" xref="A1.SS1.p1.10.m6.1.1.3.2.2.cmml">1</mn><mo id="A1.SS1.p1.10.m6.1.1.3.2.1" xref="A1.SS1.p1.10.m6.1.1.3.2.1.cmml">/</mo><mn id="A1.SS1.p1.10.m6.1.1.3.2.3" xref="A1.SS1.p1.10.m6.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.10.m6.1b"><apply id="A1.SS1.p1.10.m6.1.1.cmml" xref="A1.SS1.p1.10.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.10.m6.1.1.1.cmml" xref="A1.SS1.p1.10.m6.1.1">superscript</csymbol><apply id="A1.SS1.p1.10.m6.1.1.2.cmml" xref="A1.SS1.p1.10.m6.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.10.m6.1.1.2.1.cmml" xref="A1.SS1.p1.10.m6.1.1">subscript</csymbol><ci id="A1.SS1.p1.10.m6.1.1.2.2.cmml" xref="A1.SS1.p1.10.m6.1.1.2.2">Σ</ci><ci id="A1.SS1.p1.10.m6.1.1.2.3.cmml" xref="A1.SS1.p1.10.m6.1.1.2.3">𝑊</ci></apply><apply id="A1.SS1.p1.10.m6.1.1.3.cmml" xref="A1.SS1.p1.10.m6.1.1.3"><minus id="A1.SS1.p1.10.m6.1.1.3.1.cmml" xref="A1.SS1.p1.10.m6.1.1.3"></minus><apply id="A1.SS1.p1.10.m6.1.1.3.2.cmml" xref="A1.SS1.p1.10.m6.1.1.3.2"><divide id="A1.SS1.p1.10.m6.1.1.3.2.1.cmml" xref="A1.SS1.p1.10.m6.1.1.3.2.1"></divide><cn type="integer" id="A1.SS1.p1.10.m6.1.1.3.2.2.cmml" xref="A1.SS1.p1.10.m6.1.1.3.2.2">1</cn><cn type="integer" id="A1.SS1.p1.10.m6.1.1.3.2.3.cmml" xref="A1.SS1.p1.10.m6.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.10.m6.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math>.</p>
</div>
<div id="A1.SS1.p2" class="ltx_para">
<p id="A1.SS1.p2.2" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> introduced an incremental algorithm to optimize <math id="A1.SS1.p2.1.m1.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="A1.SS1.p2.1.m1.1a"><mi mathvariant="normal" id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.1b"><ci id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.1c">\Phi</annotation></semantics></math> and <math id="A1.SS1.p2.2.m2.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="A1.SS1.p2.2.m2.1a"><msubsup id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="A1.SS1.p2.2.m2.1.1.2.2" xref="A1.SS1.p2.2.m2.1.1.2.2.cmml">Σ</mi><mi id="A1.SS1.p2.2.m2.1.1.2.3" xref="A1.SS1.p2.2.m2.1.1.2.3.cmml">W</mi><mrow id="A1.SS1.p2.2.m2.1.1.3" xref="A1.SS1.p2.2.m2.1.1.3.cmml"><mo id="A1.SS1.p2.2.m2.1.1.3a" xref="A1.SS1.p2.2.m2.1.1.3.cmml">−</mo><mrow id="A1.SS1.p2.2.m2.1.1.3.2" xref="A1.SS1.p2.2.m2.1.1.3.2.cmml"><mn id="A1.SS1.p2.2.m2.1.1.3.2.2" xref="A1.SS1.p2.2.m2.1.1.3.2.2.cmml">1</mn><mo id="A1.SS1.p2.2.m2.1.1.3.2.1" xref="A1.SS1.p2.2.m2.1.1.3.2.1.cmml">/</mo><mn id="A1.SS1.p2.2.m2.1.1.3.2.3" xref="A1.SS1.p2.2.m2.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><apply id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.2.m2.1.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">superscript</csymbol><apply id="A1.SS1.p2.2.m2.1.1.2.cmml" xref="A1.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.2.m2.1.1.2.1.cmml" xref="A1.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.2.m2.1.1.2.2.cmml" xref="A1.SS1.p2.2.m2.1.1.2.2">Σ</ci><ci id="A1.SS1.p2.2.m2.1.1.2.3.cmml" xref="A1.SS1.p2.2.m2.1.1.2.3">𝑊</ci></apply><apply id="A1.SS1.p2.2.m2.1.1.3.cmml" xref="A1.SS1.p2.2.m2.1.1.3"><minus id="A1.SS1.p2.2.m2.1.1.3.1.cmml" xref="A1.SS1.p2.2.m2.1.1.3"></minus><apply id="A1.SS1.p2.2.m2.1.1.3.2.cmml" xref="A1.SS1.p2.2.m2.1.1.3.2"><divide id="A1.SS1.p2.2.m2.1.1.3.2.1.cmml" xref="A1.SS1.p2.2.m2.1.1.3.2.1"></divide><cn type="integer" id="A1.SS1.p2.2.m2.1.1.3.2.2.cmml" xref="A1.SS1.p2.2.m2.1.1.3.2.2">1</cn><cn type="integer" id="A1.SS1.p2.2.m2.1.1.3.2.3.cmml" xref="A1.SS1.p2.2.m2.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math> through which we can distribute the optimizing steps to clients. Concretely, it proves that, 1)</p>
<table id="A1.E12" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A1.E12X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E12X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\Phi_{k+1}=\Phi_{k}+\lambda(\mathbf{z}_{k}\mathbf{z}_{k}^{T}\Phi_{k}-\Phi_{k}\tau[\Phi^{T}_{k}\mathbf{z}_{k}\mathbf{z}_{k}^{T}\Phi_{k}])" display="inline"><semantics id="A1.E12X.2.1.1.m1.1a"><mrow id="A1.E12X.2.1.1.m1.1.1" xref="A1.E12X.2.1.1.m1.1.1.cmml"><msub id="A1.E12X.2.1.1.m1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.3.cmml"><mi mathvariant="normal" id="A1.E12X.2.1.1.m1.1.1.3.2" xref="A1.E12X.2.1.1.m1.1.1.3.2.cmml">Φ</mi><mrow id="A1.E12X.2.1.1.m1.1.1.3.3" xref="A1.E12X.2.1.1.m1.1.1.3.3.cmml"><mi id="A1.E12X.2.1.1.m1.1.1.3.3.2" xref="A1.E12X.2.1.1.m1.1.1.3.3.2.cmml">k</mi><mo id="A1.E12X.2.1.1.m1.1.1.3.3.1" xref="A1.E12X.2.1.1.m1.1.1.3.3.1.cmml">+</mo><mn id="A1.E12X.2.1.1.m1.1.1.3.3.3" xref="A1.E12X.2.1.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="A1.E12X.2.1.1.m1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A1.E12X.2.1.1.m1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.cmml"><msub id="A1.E12X.2.1.1.m1.1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.1.3.cmml"><mi mathvariant="normal" id="A1.E12X.2.1.1.m1.1.1.1.3.2" xref="A1.E12X.2.1.1.m1.1.1.1.3.2.cmml">Φ</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.3.3" xref="A1.E12X.2.1.1.m1.1.1.1.3.3.cmml">k</mi></msub><mo id="A1.E12X.2.1.1.m1.1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.1.2.cmml">+</mo><mrow id="A1.E12X.2.1.1.m1.1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.cmml"><mi id="A1.E12X.2.1.1.m1.1.1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E12X.2.1.1.m1.1.1.1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml">𝐳</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">𝐳</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.3.cmml">k</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.1a" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.cmml"><mi mathvariant="normal" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.cmml">Φ</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.cmml">k</mi></msub></mrow><mo id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">Φ</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.4" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml">τ</mi><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.2a" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">Φ</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">𝐳</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml">k</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1b" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi mathvariant="normal" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml">Φ</mi><mi id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo stretchy="false" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.3" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12X.2.1.1.m1.1b"><apply id="A1.E12X.2.1.1.m1.1.1.cmml" xref="A1.E12X.2.1.1.m1.1.1"><eq id="A1.E12X.2.1.1.m1.1.1.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.2"></eq><apply id="A1.E12X.2.1.1.m1.1.1.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.3.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.3.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.3.2">Φ</ci><apply id="A1.E12X.2.1.1.m1.1.1.3.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.3.3"><plus id="A1.E12X.2.1.1.m1.1.1.3.3.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.3.3.1"></plus><ci id="A1.E12X.2.1.1.m1.1.1.3.3.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.3.3.2">𝑘</ci><cn type="integer" id="A1.E12X.2.1.1.m1.1.1.3.3.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1"><plus id="A1.E12X.2.1.1.m1.1.1.1.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.2"></plus><apply id="A1.E12X.2.1.1.m1.1.1.1.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.3.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.3.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.3.2">Φ</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.3.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.3.3">𝑘</ci></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1"><times id="A1.E12X.2.1.1.m1.1.1.1.1.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.2"></times><ci id="A1.E12X.2.1.1.m1.1.1.1.1.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.3">𝜆</ci><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1"><minus id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.2"></minus><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3"><times id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2">𝐳</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.2">𝐳</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.3">𝑘</ci></apply><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3">𝑇</ci></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2">Φ</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3">𝑘</ci></apply></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1"><times id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">Φ</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.4">𝜏</ci><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">Φ</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑇</ci></apply><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.2">𝐳</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.4.3">𝑇</ci></apply><apply id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.2">Φ</ci><ci id="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="A1.E12X.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.5.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12X.2.1.1.m1.1c">\displaystyle\Phi_{k+1}=\Phi_{k}+\lambda(\mathbf{z}_{k}\mathbf{z}_{k}^{T}\Phi_{k}-\Phi_{k}\tau[\Phi^{T}_{k}\mathbf{z}_{k}\mathbf{z}_{k}^{T}\Phi_{k}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
</tbody>
</table>
<p id="A1.SS1.p2.6" class="ltx_p">will converge to the enginvector matrix <math id="A1.SS1.p2.3.m1.1" class="ltx_Math" alttext="\Phi" display="inline"><semantics id="A1.SS1.p2.3.m1.1a"><mi mathvariant="normal" id="A1.SS1.p2.3.m1.1.1" xref="A1.SS1.p2.3.m1.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m1.1b"><ci id="A1.SS1.p2.3.m1.1.1.cmml" xref="A1.SS1.p2.3.m1.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m1.1c">\Phi</annotation></semantics></math> when there are sufficient instance <math id="A1.SS1.p2.4.m2.1" class="ltx_Math" alttext="\mathbf{z}_{k}" display="inline"><semantics id="A1.SS1.p2.4.m2.1a"><msub id="A1.SS1.p2.4.m2.1.1" xref="A1.SS1.p2.4.m2.1.1.cmml"><mi id="A1.SS1.p2.4.m2.1.1.2" xref="A1.SS1.p2.4.m2.1.1.2.cmml">𝐳</mi><mi id="A1.SS1.p2.4.m2.1.1.3" xref="A1.SS1.p2.4.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m2.1b"><apply id="A1.SS1.p2.4.m2.1.1.cmml" xref="A1.SS1.p2.4.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m2.1.1.1.cmml" xref="A1.SS1.p2.4.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.4.m2.1.1.2.cmml" xref="A1.SS1.p2.4.m2.1.1.2">𝐳</ci><ci id="A1.SS1.p2.4.m2.1.1.3.cmml" xref="A1.SS1.p2.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m2.1c">\mathbf{z}_{k}</annotation></semantics></math> sampled from the data distribution; 2). let <math id="A1.SS1.p2.5.m3.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="A1.SS1.p2.5.m3.1a"><mi id="A1.SS1.p2.5.m3.1.1" xref="A1.SS1.p2.5.m3.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.5.m3.1b"><ci id="A1.SS1.p2.5.m3.1.1.cmml" xref="A1.SS1.p2.5.m3.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.5.m3.1c">\mathbf{S}</annotation></semantics></math> denotes <math id="A1.SS1.p2.6.m4.1" class="ltx_Math" alttext="\Sigma_{W}^{-1/2}" display="inline"><semantics id="A1.SS1.p2.6.m4.1a"><msubsup id="A1.SS1.p2.6.m4.1.1" xref="A1.SS1.p2.6.m4.1.1.cmml"><mi mathvariant="normal" id="A1.SS1.p2.6.m4.1.1.2.2" xref="A1.SS1.p2.6.m4.1.1.2.2.cmml">Σ</mi><mi id="A1.SS1.p2.6.m4.1.1.2.3" xref="A1.SS1.p2.6.m4.1.1.2.3.cmml">W</mi><mrow id="A1.SS1.p2.6.m4.1.1.3" xref="A1.SS1.p2.6.m4.1.1.3.cmml"><mo id="A1.SS1.p2.6.m4.1.1.3a" xref="A1.SS1.p2.6.m4.1.1.3.cmml">−</mo><mrow id="A1.SS1.p2.6.m4.1.1.3.2" xref="A1.SS1.p2.6.m4.1.1.3.2.cmml"><mn id="A1.SS1.p2.6.m4.1.1.3.2.2" xref="A1.SS1.p2.6.m4.1.1.3.2.2.cmml">1</mn><mo id="A1.SS1.p2.6.m4.1.1.3.2.1" xref="A1.SS1.p2.6.m4.1.1.3.2.1.cmml">/</mo><mn id="A1.SS1.p2.6.m4.1.1.3.2.3" xref="A1.SS1.p2.6.m4.1.1.3.2.3.cmml">2</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.6.m4.1b"><apply id="A1.SS1.p2.6.m4.1.1.cmml" xref="A1.SS1.p2.6.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m4.1.1.1.cmml" xref="A1.SS1.p2.6.m4.1.1">superscript</csymbol><apply id="A1.SS1.p2.6.m4.1.1.2.cmml" xref="A1.SS1.p2.6.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.6.m4.1.1.2.1.cmml" xref="A1.SS1.p2.6.m4.1.1">subscript</csymbol><ci id="A1.SS1.p2.6.m4.1.1.2.2.cmml" xref="A1.SS1.p2.6.m4.1.1.2.2">Σ</ci><ci id="A1.SS1.p2.6.m4.1.1.2.3.cmml" xref="A1.SS1.p2.6.m4.1.1.2.3">𝑊</ci></apply><apply id="A1.SS1.p2.6.m4.1.1.3.cmml" xref="A1.SS1.p2.6.m4.1.1.3"><minus id="A1.SS1.p2.6.m4.1.1.3.1.cmml" xref="A1.SS1.p2.6.m4.1.1.3"></minus><apply id="A1.SS1.p2.6.m4.1.1.3.2.cmml" xref="A1.SS1.p2.6.m4.1.1.3.2"><divide id="A1.SS1.p2.6.m4.1.1.3.2.1.cmml" xref="A1.SS1.p2.6.m4.1.1.3.2.1"></divide><cn type="integer" id="A1.SS1.p2.6.m4.1.1.3.2.2.cmml" xref="A1.SS1.p2.6.m4.1.1.3.2.2">1</cn><cn type="integer" id="A1.SS1.p2.6.m4.1.1.3.2.3.cmml" xref="A1.SS1.p2.6.m4.1.1.3.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.6.m4.1c">\Sigma_{W}^{-1/2}</annotation></semantics></math>, then</p>
<table id="A1.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="A1.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E13X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle S_{k+1}=S_{k}+\eta*(I-S_{k}\Sigma_{W}S_{k})" display="inline"><semantics id="A1.E13X.2.1.1.m1.1a"><mrow id="A1.E13X.2.1.1.m1.1.1" xref="A1.E13X.2.1.1.m1.1.1.cmml"><msub id="A1.E13X.2.1.1.m1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.3.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.3.2" xref="A1.E13X.2.1.1.m1.1.1.3.2.cmml">S</mi><mrow id="A1.E13X.2.1.1.m1.1.1.3.3" xref="A1.E13X.2.1.1.m1.1.1.3.3.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.3.3.2" xref="A1.E13X.2.1.1.m1.1.1.3.3.2.cmml">k</mi><mo id="A1.E13X.2.1.1.m1.1.1.3.3.1" xref="A1.E13X.2.1.1.m1.1.1.3.3.1.cmml">+</mo><mn id="A1.E13X.2.1.1.m1.1.1.3.3.3" xref="A1.E13X.2.1.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="A1.E13X.2.1.1.m1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.cmml"><msub id="A1.E13X.2.1.1.m1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.3.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.3.2" xref="A1.E13X.2.1.1.m1.1.1.1.3.2.cmml">S</mi><mi id="A1.E13X.2.1.1.m1.1.1.1.3.3" xref="A1.E13X.2.1.1.m1.1.1.1.3.3.cmml">k</mi></msub><mo id="A1.E13X.2.1.1.m1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.2.cmml">+</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="A1.E13X.2.1.1.m1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.2.cmml">∗</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">I</mi><mo id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml">S</mi><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.1" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">Σ</mi><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">W</mi></msub><mo lspace="0em" rspace="0em" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.1a" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.cmml"><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.cmml">S</mi><mi id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.3" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E13X.2.1.1.m1.1b"><apply id="A1.E13X.2.1.1.m1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1"><eq id="A1.E13X.2.1.1.m1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.2"></eq><apply id="A1.E13X.2.1.1.m1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.3.2">𝑆</ci><apply id="A1.E13X.2.1.1.m1.1.1.3.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.3.3"><plus id="A1.E13X.2.1.1.m1.1.1.3.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.3.3.1"></plus><ci id="A1.E13X.2.1.1.m1.1.1.3.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.3.3.2">𝑘</ci><cn type="integer" id="A1.E13X.2.1.1.m1.1.1.3.3.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.3.3.3">1</cn></apply></apply><apply id="A1.E13X.2.1.1.m1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1"><plus id="A1.E13X.2.1.1.m1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.2"></plus><apply id="A1.E13X.2.1.1.m1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.3.2">𝑆</ci><ci id="A1.E13X.2.1.1.m1.1.1.1.3.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.3.3">𝑘</ci></apply><apply id="A1.E13X.2.1.1.m1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1"><times id="A1.E13X.2.1.1.m1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.2"></times><ci id="A1.E13X.2.1.1.m1.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.3">𝜂</ci><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1"><minus id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.1"></minus><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.2">𝐼</ci><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3"><times id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.1"></times><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.2">𝑆</ci><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.2">Σ</ci><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.3.3">𝑊</ci></apply><apply id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.1.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.2">𝑆</ci><ci id="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3.cmml" xref="A1.E13X.2.1.1.m1.1.1.1.1.1.1.1.3.4.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13X.2.1.1.m1.1c">\displaystyle S_{k+1}=S_{k}+\eta*(I-S_{k}\Sigma_{W}S_{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
</tbody>
</table>
<p id="A1.SS1.p2.10" class="ltx_p">where <math id="A1.SS1.p2.7.m1.1" class="ltx_Math" alttext="S_{k+1}" display="inline"><semantics id="A1.SS1.p2.7.m1.1a"><msub id="A1.SS1.p2.7.m1.1.1" xref="A1.SS1.p2.7.m1.1.1.cmml"><mi id="A1.SS1.p2.7.m1.1.1.2" xref="A1.SS1.p2.7.m1.1.1.2.cmml">S</mi><mrow id="A1.SS1.p2.7.m1.1.1.3" xref="A1.SS1.p2.7.m1.1.1.3.cmml"><mi id="A1.SS1.p2.7.m1.1.1.3.2" xref="A1.SS1.p2.7.m1.1.1.3.2.cmml">k</mi><mo id="A1.SS1.p2.7.m1.1.1.3.1" xref="A1.SS1.p2.7.m1.1.1.3.1.cmml">+</mo><mn id="A1.SS1.p2.7.m1.1.1.3.3" xref="A1.SS1.p2.7.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.7.m1.1b"><apply id="A1.SS1.p2.7.m1.1.1.cmml" xref="A1.SS1.p2.7.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.7.m1.1.1.1.cmml" xref="A1.SS1.p2.7.m1.1.1">subscript</csymbol><ci id="A1.SS1.p2.7.m1.1.1.2.cmml" xref="A1.SS1.p2.7.m1.1.1.2">𝑆</ci><apply id="A1.SS1.p2.7.m1.1.1.3.cmml" xref="A1.SS1.p2.7.m1.1.1.3"><plus id="A1.SS1.p2.7.m1.1.1.3.1.cmml" xref="A1.SS1.p2.7.m1.1.1.3.1"></plus><ci id="A1.SS1.p2.7.m1.1.1.3.2.cmml" xref="A1.SS1.p2.7.m1.1.1.3.2">𝑘</ci><cn type="integer" id="A1.SS1.p2.7.m1.1.1.3.3.cmml" xref="A1.SS1.p2.7.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.7.m1.1c">S_{k+1}</annotation></semantics></math> will converge to the inverted square root of <math id="A1.SS1.p2.8.m2.1" class="ltx_Math" alttext="\Sigma_{W}" display="inline"><semantics id="A1.SS1.p2.8.m2.1a"><msub id="A1.SS1.p2.8.m2.1.1" xref="A1.SS1.p2.8.m2.1.1.cmml"><mi mathvariant="normal" id="A1.SS1.p2.8.m2.1.1.2" xref="A1.SS1.p2.8.m2.1.1.2.cmml">Σ</mi><mi id="A1.SS1.p2.8.m2.1.1.3" xref="A1.SS1.p2.8.m2.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.8.m2.1b"><apply id="A1.SS1.p2.8.m2.1.1.cmml" xref="A1.SS1.p2.8.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m2.1.1.1.cmml" xref="A1.SS1.p2.8.m2.1.1">subscript</csymbol><ci id="A1.SS1.p2.8.m2.1.1.2.cmml" xref="A1.SS1.p2.8.m2.1.1.2">Σ</ci><ci id="A1.SS1.p2.8.m2.1.1.3.cmml" xref="A1.SS1.p2.8.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.8.m2.1c">\Sigma_{W}</annotation></semantics></math> when 1) <math id="A1.SS1.p2.9.m3.1" class="ltx_Math" alttext="S_{0}" display="inline"><semantics id="A1.SS1.p2.9.m3.1a"><msub id="A1.SS1.p2.9.m3.1.1" xref="A1.SS1.p2.9.m3.1.1.cmml"><mi id="A1.SS1.p2.9.m3.1.1.2" xref="A1.SS1.p2.9.m3.1.1.2.cmml">S</mi><mn id="A1.SS1.p2.9.m3.1.1.3" xref="A1.SS1.p2.9.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.9.m3.1b"><apply id="A1.SS1.p2.9.m3.1.1.cmml" xref="A1.SS1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.9.m3.1.1.1.cmml" xref="A1.SS1.p2.9.m3.1.1">subscript</csymbol><ci id="A1.SS1.p2.9.m3.1.1.2.cmml" xref="A1.SS1.p2.9.m3.1.1.2">𝑆</ci><cn type="integer" id="A1.SS1.p2.9.m3.1.1.3.cmml" xref="A1.SS1.p2.9.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.9.m3.1c">S_{0}</annotation></semantics></math> is initialized as a symmetric positive define matrix, and 2) there are sufficient instance <math id="A1.SS1.p2.10.m4.1" class="ltx_Math" alttext="\mathbf{z}_{k}" display="inline"><semantics id="A1.SS1.p2.10.m4.1a"><msub id="A1.SS1.p2.10.m4.1.1" xref="A1.SS1.p2.10.m4.1.1.cmml"><mi id="A1.SS1.p2.10.m4.1.1.2" xref="A1.SS1.p2.10.m4.1.1.2.cmml">𝐳</mi><mi id="A1.SS1.p2.10.m4.1.1.3" xref="A1.SS1.p2.10.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.10.m4.1b"><apply id="A1.SS1.p2.10.m4.1.1.cmml" xref="A1.SS1.p2.10.m4.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.10.m4.1.1.1.cmml" xref="A1.SS1.p2.10.m4.1.1">subscript</csymbol><ci id="A1.SS1.p2.10.m4.1.1.2.cmml" xref="A1.SS1.p2.10.m4.1.1.2">𝐳</ci><ci id="A1.SS1.p2.10.m4.1.1.3.cmml" xref="A1.SS1.p2.10.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.10.m4.1c">\mathbf{z}_{k}</annotation></semantics></math> sampled from the data distribution.</p>
</div>
<div id="A1.SS1.p3" class="ltx_para">
<p id="A1.SS1.p3.1" class="ltx_p">We apply the above methods in Eq.<a href="#S4.E9" title="In 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> and Eq.<a href="#S4.E8" title="In 4.2 Client Supervised Optimization ‣ 4 Methodology ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> to update <math id="A1.SS1.p3.1.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="A1.SS1.p3.1.m1.1a"><mi id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b"><ci id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">P</annotation></semantics></math> on each clients individually and aggregate local updates to align axis on different clients.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Discussion on Privacy Protection</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.2" class="ltx_p">According to the section above, clients requires to share local correlations to update the matrix <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="\Sigma_{W}" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><msub id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">Σ</mi><mi id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">Σ</ci><ci id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\Sigma_{W}</annotation></semantics></math>. However, <math id="A1.SS2.p1.2.m2.1" class="ltx_Math" alttext="\Sigma_{W}" display="inline"><semantics id="A1.SS2.p1.2.m2.1a"><msub id="A1.SS2.p1.2.m2.1.1" xref="A1.SS2.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="A1.SS2.p1.2.m2.1.1.2" xref="A1.SS2.p1.2.m2.1.1.2.cmml">Σ</mi><mi id="A1.SS2.p1.2.m2.1.1.3" xref="A1.SS2.p1.2.m2.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m2.1b"><apply id="A1.SS2.p1.2.m2.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m2.1.1.1.cmml" xref="A1.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS2.p1.2.m2.1.1.2.cmml" xref="A1.SS2.p1.2.m2.1.1.2">Σ</ci><ci id="A1.SS2.p1.2.m2.1.1.3.cmml" xref="A1.SS2.p1.2.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m2.1c">\Sigma_{W}</annotation></semantics></math> is a global statistic where a client’s local bias would be eliminated, privacy-protection methods like differential privacy are feasible to avoid privacy leakage.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Experiments</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Heterogeneity Settings</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">Three benchmark datasets are applied to evaluate FedCR’s performance.</p>
</div>
<section id="A2.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.1.1 </span>Label-shift</h4>

<div id="A2.SS1.SSS1.p1" class="ltx_para">
<p id="A2.SS1.SSS1.p1.1" class="ltx_p">We allocate instances of each label individually according to a posterior of the Dirichlet distribution<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, which divides clients into ten groups with different label distributions. Eight groups of clients will participate in the collaborative training process, and the rest will be held for testing. An example of the client setting is in Fig.<a href="#A2.F3" title="Figure 3 ‣ B.1.1 Label-shift ‣ B.1 Heterogeneity Settings ‣ Appendix B Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Distributions of the number of instances of each class are show in Fig.<a href="#A2.F4" title="Figure 4 ‣ B.1.1 Label-shift ‣ B.1 Heterogeneity Settings ‣ Appendix B Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a></p>
</div>
<figure id="A2.F3" class="ltx_figure">
<p id="A2.F3.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="A2.F3.1.1.1" class="ltx_text"><img src="/html/2403.19499/assets/images/exp/settings/client_settings.png" id="A2.F3.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="350" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F3.3.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>client settings for label shift experiments</figcaption>
</figure>
<figure id="A2.F4" class="ltx_figure">
<br class="ltx_break">
<p id="A2.F4.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="A2.F4.1.1.1" class="ltx_text"><img src="/html/2403.19499/assets/x1.png" id="A2.F4.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="922" height="302" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F4.3.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>Proportion of instances of different classes. Different classes are marked with different colors. Horizontal axix denotes client ids, and the vertical axis denotes the proportion of classes</figcaption>
</figure>
</section>
<section id="A2.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.1.2 </span>Feature-shift</h4>

<div id="A2.SS1.SSS2.p1" class="ltx_para">
<p id="A2.SS1.SSS2.p1.1" class="ltx_p">We experiment on the Digit-5 dataset to evaluate FedCRR’s performance on feature-shift data. The Digit-5 consists of digits from five different domains (MNIST, MNIST-M, SVHN, USPS and Synth Digits). We assign instances of each domain to nine clients, where eight clients will train the global model and one for the test. In addition, we randomly draw instances from all domains to compose five mixed datasets for the rest clients for the test. The distributions on clients are shown in Fig.<a href="#A2.F5" title="Figure 5 ‣ B.1.2 Feature-shift ‣ B.1 Heterogeneity Settings ‣ Appendix B Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a></p>
</div>
<figure id="A2.F5" class="ltx_figure">
<p id="A2.F5.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="A2.F5.1.1.1" class="ltx_text"><img src="/html/2403.19499/assets/images/feature-shift.png" id="A2.F5.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="362" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F5.3.1.1" class="ltx_text ltx_font_bold">Fig. 5</span>: </span>client settings for feature shift experiments</figcaption>
</figure>
</section>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Metrics</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">We apply three different metrics to evaluate a model’s performance on each clients. They are: accuracy, weighted F1 score and weighted AUC. We apply implementations in scikit-learn<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://scikit-learn.org/stable/index.html</span></span></span> in our experiments and utilize Laplacian smooth for clients where some labels are missing.</p>
</div>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Model Architecture</h3>

<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.1" class="ltx_p">Please refers attached codes for details of our experiments.</p>
</div>
</section>
<section id="A2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Supplementary Results</h3>

<div id="A2.SS4.p1" class="ltx_para">
<p id="A2.SS4.p1.1" class="ltx_p">In addition to the results in Sec.<a href="#S5" title="5 Experiments ‣ Client-supervised Federated Learning: Towards One-model-for-all Personalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, more results are demonstrated as below. We can find our methods achieve better robustness and performance, especially on unseen/test clients.</p>
</div>
<figure id="A2.F6" class="ltx_figure"><img src="/html/2403.19499/assets/images/averaged_accuracy_mnist.png" id="A2.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="334" height="251" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A2.F6.3.1.1" class="ltx_text ltx_font_bold">Fig. 6</span>: </span>Accuracy on the MNIST dataset. y-axis denotes the averaged accuracy on all clients and x-axis denotes the communication round. Shades denote the standard deviation of accuracy among clients. Our FedCS (Aligned FC-1 to Aligned FC3) achieves the best and the most robust performance.</figcaption>
</figure>
<figure id="A2.F7" class="ltx_figure"><img src="/html/2403.19499/assets/images/averaged_accuracy_cifar10.png" id="A2.F7.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="334" height="251" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A2.F7.3.1.1" class="ltx_text ltx_font_bold">Fig. 7</span>: </span>Accuracy on the CIFAR-10 dataset. y-axis denotes the averaged accuracy on all clients and x-axis denotes the communication round. Shades denote the standard deviation of accuracy among clients. Our FedCS (Aligned FC-1 to Aligned FC3) achieves the best and the most robust performance.</figcaption>
</figure>
<figure id="A2.F8" class="ltx_figure"><img src="/html/2403.19499/assets/images/digit5-averaged_accuracy.png" id="A2.F8.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="334" height="251" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A2.F8.3.1.1" class="ltx_text ltx_font_bold">Fig. 8</span>: </span>Accuracy on the Digit-5 dataset. y-axis denotes the averaged accuracy on all clients and x-axis denotes the communication round. Shades denote the standard deviation of accuracy among clients. Our FedCS (Aligned FC-1 to Aligned FC3) achieves the best and the most robust performance.</figcaption>
</figure>
<figure id="A2.F9" class="ltx_figure"><img src="/html/2403.19499/assets/images/group-weighted-auc-cifar10.png" id="A2.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="1196" height="316" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F9.3.1.1" class="ltx_text ltx_font_bold">Fig. 9</span>: </span>Part of experiments on CIFAR-10. The horizontal axis denotes communication rounds, and the vertical axis denotes accuracy. We demonstrate the averaged accuracy within each client group and marked them with different colours. We can find the performance on different distributions (client groups) vary significantly through FedAvg+FT and FedBN. FedCS has the most robust performance even on unseen clients (group 8 and 9)</figcaption>
</figure>
<figure id="A2.F10" class="ltx_figure"><img src="/html/2403.19499/assets/images/group-weighted-auc-digit5.png" id="A2.F10.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="1196" height="338" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F10.3.1.1" class="ltx_text ltx_font_bold">Fig. 10</span>: </span>Part of experiments on Digit5. The horizontal axis denotes communication rounds, and the vertical axis denotes accuracy. We demonstrate the averaged accuracy within each client group and marked them with different colours. We can find the performance on different distributions (client groups) vary significantly through FedAvg+FT and FedBN. FedCS has the most robust performance even on unseen clients (group 8 and 9)</figcaption>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.19498" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.19499" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.19499">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.19499" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.19500" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 18:14:16 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
