<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Item-Language Model for Conversational Recommendation</title>
<!--Generated on Wed Jun  5 01:33:31 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.02844v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S1" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S1.SS0.SSS0.Px1" title="In 1 Introduction ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title">Paper Overview.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title">LLM for recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title">Item representations in LLM4Rec</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.SS0.SSS0.Px3" title="In 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title">Multimodal LLM</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3.SS1" title="In 3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Model Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3.SS2" title="In 3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Item-Language Representation Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3.SS3" title="In 3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Item-Language Model Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS1" title="In 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS1.SSS0.Px1" title="In 4.1 Datasets ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title">ELM 24 Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS1.SSS0.Px2" title="In 4.1 Datasets ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title">OpenP5</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS2" title="In 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS3" title="In 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Results on ELM 24 tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS4" title="In 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Results on OpenP5 tasks</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5.SS1" title="In 5 Ablation Study ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Effects of Q-Former Phase 1 Training.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5.SS2" title="In 5 Ablation Study ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Effects of Number of Query Tokens</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S6" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#A1" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Preserving Pretrained Ability</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#A2" title="In Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Hyperparameters</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Item-Language Model for Conversational Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Li Yang 
<br class="ltx_break"/>Google Research
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">lyliyang@google.com</span>
<br class="ltx_break"/>&amp;Anushya Subbiah 
<br class="ltx_break"/>Google Research 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2">anushyas@google.com</span>
<br class="ltx_break"/>Hardik Patel 
<br class="ltx_break"/>Google 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id3.3.id3">patelhardik@google.com</span>
<br class="ltx_break"/>&amp;Judith Yue Li 
<br class="ltx_break"/>Google Research 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.4.id4">judithyueli@google.com</span>
<br class="ltx_break"/>&amp;Yanwei Song 
<br class="ltx_break"/>Google 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id5.5.id5">yanweisong@google.com</span>
<br class="ltx_break"/>&amp;Reza Mirghaderi 
<br class="ltx_break"/>Google 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id6.6.id6">rezam@google.com</span>
<br class="ltx_break"/>&amp;Vikram Aggarwal 
<br class="ltx_break"/>Google Research 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.7.id7">viki@google.com</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id8.id1">Large-language Models (LLMs) have been extremely successful at tasks like complex dialogue understanding, reasoning and coding due to their emergent abilities. These emergent abilities have been extended with multi-modality to include image, audio, and video capabilities. Recommender systems, on the other hand, have been critical for information seeking and item discovery needs. Recently, there have been attempts to apply LLMs for recommendations. One difficulty of current attempts is that the underlying LLM is usually not trained on the recommender system data, which largely contains user interaction signals and is often not publicly available. Another difficulty is user interaction signals often have a different pattern from natural language text, and it is currently unclear if the LLM training setup can learn more non-trivial knowledge from interaction signals compared with traditional recommender system methods. Finally, it is difficult to train multiple LLMs for different use-cases, and to retain the original language and reasoning abilities when learning from recommender system data. To address these three limitations, we propose an Item-Language Model (ILM), which is composed of an item encoder to produce text-aligned item representations that encode user interaction signals, and a frozen LLM that can understand those item representations with preserved pretrained knowledge. We conduct extensive experiments which demonstrate both the importance of the language-alignment and of user interaction knowledge in the item encoder.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs), trained on web-scale data using a very large number of parameters, have shown remarkable emergent capabilities, such as in-context learning, reasoning, coding <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib19" title="">19</a>]</cite>. Recently, those abilities have been extended to multimodal domains, including image, audio, and video <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib15" title="">15</a>]</cite>. On various professional and academic benchmarks, those models achieve or surpass human-level performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib22" title="">22</a>]</cite>. By contrast, the improvement in recommender systems have not derived similar breakthrough with improvements in LLM, even though recommender systems support a large volume of online user activity. One reason is that users’ interactions with recommender systems are typically not in natural language form. For example, a video recommender system typically recommends videos to users based on their implicit preferences from watch history and other query and candidate features, and users usually do not provide natural language preferences. In order to induce such natural language preferences, conversational recommendations have been proposed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib18" title="">18</a>]</cite>, where the user can interact with the system explicitly using either natural-language tags or conversational natural language. With the development of techniques such as LLM tool-use <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib41" title="">41</a>]</cite>, Retrieval Augmented Generation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib14" title="">14</a>]</cite>, and Agents <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib52" title="">52</a>]</cite>, LLMs have demonstrated breakthroughs in many domains. It is possible that those technical advances and the resulting user habit changes will lead to conversational recommender systems to be more important in the future, thus it is worthwhile to develop methods to bring these benefits to conversational recommender systems.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="349" id="S1.F1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Conversational recommendation tasks using ILM. User and item collaborative filtering embeddings, marked by placeholders in the input, are interleaved with text embeddings and fed to the model. Where {history} is a sequence of items.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.6">However, using an LLM for conversational recommender systems has the following difficulties. (1) Unlike multimodality, to the best of our knowledge no current LLM natively understands both user interaction signals and natural language. Current LLMs are trained on natural language data or natural language aligned contents, e.g. image with description, audio with transcription, etc. User interaction signals exist in the form of item co-watch, for example, if many users have viewed both <math alttext="v_{1}" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><msub id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml">v</mi><mn id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1">subscript</csymbol><ci id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">𝑣</ci><cn id="S1.p2.1.m1.1.1.3.cmml" type="integer" xref="S1.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">v_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{2}" class="ltx_Math" display="inline" id="S1.p2.2.m2.1"><semantics id="S1.p2.2.m2.1a"><msub id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml"><mi id="S1.p2.2.m2.1.1.2" xref="S1.p2.2.m2.1.1.2.cmml">v</mi><mn id="S1.p2.2.m2.1.1.3" xref="S1.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p2.2.m2.1.1.1.cmml" xref="S1.p2.2.m2.1.1">subscript</csymbol><ci id="S1.p2.2.m2.1.1.2.cmml" xref="S1.p2.2.m2.1.1.2">𝑣</ci><cn id="S1.p2.2.m2.1.1.3.cmml" type="integer" xref="S1.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">v_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.1d">italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, then a user who likes <math alttext="v_{1}" class="ltx_Math" display="inline" id="S1.p2.3.m3.1"><semantics id="S1.p2.3.m3.1a"><msub id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">v</mi><mn id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p2.3.m3.1.1.1.cmml" xref="S1.p2.3.m3.1.1">subscript</csymbol><ci id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2">𝑣</ci><cn id="S1.p2.3.m3.1.1.3.cmml" type="integer" xref="S1.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">v_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.3.m3.1d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> may also like <math alttext="v_{2}" class="ltx_Math" display="inline" id="S1.p2.4.m4.1"><semantics id="S1.p2.4.m4.1a"><msub id="S1.p2.4.m4.1.1" xref="S1.p2.4.m4.1.1.cmml"><mi id="S1.p2.4.m4.1.1.2" xref="S1.p2.4.m4.1.1.2.cmml">v</mi><mn id="S1.p2.4.m4.1.1.3" xref="S1.p2.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><apply id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p2.4.m4.1.1.1.cmml" xref="S1.p2.4.m4.1.1">subscript</csymbol><ci id="S1.p2.4.m4.1.1.2.cmml" xref="S1.p2.4.m4.1.1.2">𝑣</ci><cn id="S1.p2.4.m4.1.1.3.cmml" type="integer" xref="S1.p2.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">v_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.4.m4.1d">italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Those signals often have a complicated nature, e.g. it is hard to explain why people tend to watch <math alttext="v_{1}" class="ltx_Math" display="inline" id="S1.p2.5.m5.1"><semantics id="S1.p2.5.m5.1a"><msub id="S1.p2.5.m5.1.1" xref="S1.p2.5.m5.1.1.cmml"><mi id="S1.p2.5.m5.1.1.2" xref="S1.p2.5.m5.1.1.2.cmml">v</mi><mn id="S1.p2.5.m5.1.1.3" xref="S1.p2.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.5.m5.1b"><apply id="S1.p2.5.m5.1.1.cmml" xref="S1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p2.5.m5.1.1.1.cmml" xref="S1.p2.5.m5.1.1">subscript</csymbol><ci id="S1.p2.5.m5.1.1.2.cmml" xref="S1.p2.5.m5.1.1.2">𝑣</ci><cn id="S1.p2.5.m5.1.1.3.cmml" type="integer" xref="S1.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.5.m5.1c">v_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.5.m5.1d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="v_{2}" class="ltx_Math" display="inline" id="S1.p2.6.m6.1"><semantics id="S1.p2.6.m6.1a"><msub id="S1.p2.6.m6.1.1" xref="S1.p2.6.m6.1.1.cmml"><mi id="S1.p2.6.m6.1.1.2" xref="S1.p2.6.m6.1.1.2.cmml">v</mi><mn id="S1.p2.6.m6.1.1.3" xref="S1.p2.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p2.6.m6.1b"><apply id="S1.p2.6.m6.1.1.cmml" xref="S1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p2.6.m6.1.1.1.cmml" xref="S1.p2.6.m6.1.1">subscript</csymbol><ci id="S1.p2.6.m6.1.1.2.cmml" xref="S1.p2.6.m6.1.1.2">𝑣</ci><cn id="S1.p2.6.m6.1.1.3.cmml" type="integer" xref="S1.p2.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.6.m6.1c">v_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p2.6.m6.1d">italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> together, so there is often a lack of natural language descriptions of such signals. Due to this, existing approaches using In-Context Learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib5" title="">5</a>]</cite> by prompting LLMs for recommendation tasks purely using natural language struggle to achieve superior performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib51" title="">51</a>]</cite>. Other approaches finetuning LLMs on user interaction signals <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib28" title="">28</a>]</cite> show improvement upon purely prompting based methods. However, after such finetuning, the LLM’s original abilities are often forgotten or hidden, and new privacy concerns may arise if user data are not handled correctly <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib25" title="">25</a>]</cite>. (2) Although it is possible to annotate an item with a text format context of all related items/users, or a user with a text format context of all related items, by doing so, the context for the user/item could be very long, which will dramatically increase the inference cost. (3) Finally, another way to incorporate behavioral data is to first compute item and user collaborative filtering embeddings using matrix factorization algorithms, then feed those embeddings to LLM through a mapping module <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib59" title="">59</a>]</cite>. This approach introduces a modality gap between collaborative embeddings and LLM pretrain token embeddings, so the LLM still needs to be finetuned to close this modality gap.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Towards solving the above difficulties, we propose Item-Language Model (ILM, hereafter) for conversational recommendation tasks, Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. ILM is a two-phase framework containing an item-language representation learning phase and an item-language model training phase. The overall model architecture is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.F2" title="Figure 2 ‣ Multimodal LLM ‣ 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(d). Motivated by the BLIP-2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib33" title="">33</a>]</cite> work of bridging the modality gap with a lightweight Querying Transformer (Q-Former), we adopt Q-Former to generate item-language aligned representations. In Phase 1, we pretrain a Q-Former encoder following the BLIP-2 approach. In addition to the original item-text objectives, we also introduce an item-item contrastive objective, which plays a regularization role and also encodes co-watch information in the resulting item-language representation. The inputs to the item encoder are collaborative filtering embeddings. Throughout the paper, we treat the user as a special item. In Phase 2, we integrate the Q-Former into a pretrained LLM through a linear projection adaptor layer, and finetune the ILM on conversational recommendation tasks in multitasking fashion. During finetuning, only the Q-Former and the adaptor parameters are updated, the pretrained LLM is kept frozen to preserve its pretrained abilities. The main contributions of this work are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose ILM, a novel framework for using a Q-Former item encoder to produce item-language aligned representations from collaborative filtering embeddings, then integrate into a frozen LLM for conversation recommendation tasks with interleaved item-text inputs.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We conduct extensive benchmarks and ablation studies on various conversation recommendation tasks to show that our ILM approach consistently outperforms existing approaches of integrating item representations into LLMs across all tasks.</p>
</div>
</li>
</ol>
</div>
<section class="ltx_paragraph" id="S1.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Paper Overview.</h4>
<div class="ltx_para" id="S1.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S1.SS0.SSS0.Px1.p1.1">In Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2" title="2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, we provide a brief literature survey of LLM for recommender systems, how item representations are used there and multimodality LLM methods. In Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3" title="3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, we present the details of the proposed ILM approach, including model architecture and training. We present our experiment results in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4" title="4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> and ablation studies Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5" title="5 Ablation Study ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>. We conclude in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S6" title="6 Conclusion ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">LLM for recommendation</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">With LLMs showing remarkable emergent abilities and surpassing human-level performance across various domains, there have been explorations to apply LLMs to recommender systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib54" title="">54</a>]</cite>. In-Context Learning methods have been used as a straightforward way for this purpose <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib51" title="">51</a>]</cite>, which rely on LLMs’ world knowledge. However, since user interaction data in recommender systems is largely not available during LLM pretraining, purely text-prompting based methods show suboptimal performance. Another line of work is by finetuning a language model on user interaction data. P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib55" title="">55</a>]</cite> pretrains a unified language model for many different recommendation tasks by converting them into a common natural language sequence format, where user and item ids are represented as text strings. TALLRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib3" title="">3</a>]</cite> finetunes a LLM using LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib23" title="">23</a>]</cite> on user rating data, and the model outputs a binary label.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Item representations in LLM4Rec</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Efficiently representing users and items in recommender systems is a rich field with years of work of traditional techniques such as Matrix Factorization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib44" title="">44</a>]</cite>. When applying LLM to recommender systems, users and items are key objects, and it is critical for LLM to be able to understand them. Using text representation, such as the title of an item is a straightforward way. However, one issue is text representation of an item may not be informative enough. For example, it is quite common that a video title is unrelated to the video content, and different content can have a single title. We can always include more text features of an item, such as description, author and other content features, but this may introduce irrelevant information, which may confuse the model or make the method inefficient due to very long input. Quantized id representations as item representation has been proposed in the methods of random indexing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib55" title="">55</a>]</cite>, sequential or collaborative indexing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib26" title="">26</a>]</cite> and semantic ids in the context of generative retrieval <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib48" title="">48</a>]</cite>. In addition to using quantized ids, ELM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib49" title="">49</a>]</cite> demystifies the input embedding spaces by feeding semantic embeddings to LLM, and CoLLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib59" title="">59</a>]</cite> enhances recommendation performance on rating prediction tasks by feeding user and item collaborative filtering embeddings to LLM. Recently, USER-LLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib38" title="">38</a>]</cite> contextualizes LLM with user history embeddings by integrating user embeddings to LLM through perceiver <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib1" title="">1</a>]</cite>, projection, and cross-attention modules, where the LLM can be frozen to preserve the original ability.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Multimodal LLM</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">Our approach is closely related to a series of multimodal foundation models trained with both generative and contrastive learning objectives, including BLIP-2 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib33" title="">33</a>]</cite>, CoCa <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib56" title="">56</a>]</cite>, and MaMMUT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib31" title="">31</a>]</cite>, which achieve state-of-art performance on vision-language tasks. In our case the pretrained LLM is kept frozen, requiring a pretrained adaptor with enough representation capacity like Q-Former <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib33" title="">33</a>]</cite> used in BLIP-2 and GILLMapper <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib29" title="">29</a>]</cite>. Compared to CogVLM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib53" title="">53</a>]</cite>, which introduces a visual module to modify the frozen LLM directly, our approach is considered as late fusion. Our two-phase workflow mostly resemble BLIP-2’s two-phase workflow, including pretraining an adapter in phase one and task fine-tuning in phase two. Compared to general purpose vision-language model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib57" title="">57</a>]</cite>, our approach introduces a novel item-item contrastive loss and deals with interleaved item and text inputs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib10" title="">10</a>]</cite>. Our approach of keeping LLM frozen and only finetune the item encoder and adaptor is related to Frozen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib50" title="">50</a>]</cite>, which exhibits great multimodal few-shot learning capability.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="611" id="S2.F2.g1" src="x2.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overall model architecture for ILM. <span class="ltx_text ltx_font_bold" id="S2.F2.5.1">(a)</span> The original item-text contrastive, item-grounded text generation and item-text matching losses used in BLIP-2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib33" title="">33</a>]</cite> in Q-Former phase 1 training. <span class="ltx_text ltx_font_bold" id="S2.F2.6.2">(b)</span> The new item-item contrastive loss we introduced in Q-Former phase 1 training. For user-item contrastive learning, we simply replace item collaborative filtering (CF) embedding with user CF embedding. <span class="ltx_text ltx_font_bold" id="S2.F2.7.3">(c)</span> A schematic of how item-item contrastive learning can improve text-aligned item representations. <span class="ltx_text ltx_font_bold" id="S2.F2.8.4">(d)</span> The ILM phase 2 training by integrating the Q-Former to a frozen LLM.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model Architecture</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">For conversational recommendation tasks, the input and output of the model are typically sequences of interleaved items and text. In addition, for recommendation tasks, the model’s ability of understanding items is critical. In this work, we focus on the input item representation with the overall ILM model architecture shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.F2" title="Figure 2 ‣ Multimodal LLM ‣ 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(d). Collaborative filtering information is widely believed to be very important for recommender system performance, and forms the basis of many existing recommender systems. Existing work includes feeding item and user’s collaborative filtering embeddings into LLM through a two layer MLP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib59" title="">59</a>]</cite>. As can be seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.F2" title="Figure 2 ‣ Multimodal LLM ‣ 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> we adopt the Q-Former <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib33" title="">33</a>]</cite> architecture to encode items, combined with an item-text alignment pretraining phase to allow the Q-Former to be able to produce text-aligned item representations that also encode collaborative filtering information. We show significant performance gains of this approach on various conversational recommendation tasks in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4" title="4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. The two phases of our proposed ILM model training are discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3.SS2" title="3.2 Item-Language Representation Learning ‣ 3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a> and Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3.SS3" title="3.3 Item-Language Model Training ‣ 3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">3.3</span></a>, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Item-Language Representation Learning</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">In phase 1, we pretrain the Q-Former item encoder to ensure that it can generate text-aligned item representations given item collaborative filtering embeddings. We adopt the original 3 tasks of item-text contrastive learning, item-text generation and item-text matching in BLIP-2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib33" title="">33</a>]</cite>, Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.F2" title="Figure 2 ‣ Multimodal LLM ‣ 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(a). For item-grounded text generation, we use auto-regressive loss on top of the text tower. For item-text matching, we use a binary cross-entropy loss on the CLS token output from the text tower. For item-text contrastive learning, we compute the loss as follows. Given a positive item-text pair, we first compute output representations <math alttext="[h_{1},h_{2},...,h_{N}]" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.4.3" xref="S3.SS2.p1.1.m1.4.4.4.cmml"><mo id="S3.SS2.p1.1.m1.4.4.3.4" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.4.cmml">[</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.2.cmml">h</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.4.4.3.5" xref="S3.SS2.p1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml">h</mi><mn id="S3.SS2.p1.1.m1.3.3.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.1.m1.4.4.3.6" xref="S3.SS2.p1.1.m1.4.4.4.cmml">,</mo><mi id="S3.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.4.4.3.7" xref="S3.SS2.p1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.1.m1.4.4.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.cmml"><mi id="S3.SS2.p1.1.m1.4.4.3.3.2" xref="S3.SS2.p1.1.m1.4.4.3.3.2.cmml">h</mi><mi id="S3.SS2.p1.1.m1.4.4.3.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.cmml">N</mi></msub><mo id="S3.SS2.p1.1.m1.4.4.3.8" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><list id="S3.SS2.p1.1.m1.4.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4.3"><apply id="S3.SS2.p1.1.m1.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.2">ℎ</ci><cn id="S3.SS2.p1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.SS2.p1.1.m1.3.3.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">ℎ</ci><cn id="S3.SS2.p1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.3.3.2.2.3">2</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.4.4.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.3.3.1.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.3.3.2.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.2">ℎ</ci><ci id="S3.SS2.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">[h_{1},h_{2},...,h_{N}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">[ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]</annotation></semantics></math> of the <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_N</annotation></semantics></math> learnable queries <math alttext="[q_{1},q_{2},...,q_{N}]" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.4"><semantics id="S3.SS2.p1.3.m3.4a"><mrow id="S3.SS2.p1.3.m3.4.4.3" xref="S3.SS2.p1.3.m3.4.4.4.cmml"><mo id="S3.SS2.p1.3.m3.4.4.3.4" stretchy="false" xref="S3.SS2.p1.3.m3.4.4.4.cmml">[</mo><msub id="S3.SS2.p1.3.m3.2.2.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml">q</mi><mn id="S3.SS2.p1.3.m3.2.2.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.3.m3.4.4.3.5" xref="S3.SS2.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.3.m3.3.3.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.cmml">q</mi><mn id="S3.SS2.p1.3.m3.3.3.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.3.m3.4.4.3.6" xref="S3.SS2.p1.3.m3.4.4.4.cmml">,</mo><mi id="S3.SS2.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS2.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p1.3.m3.4.4.3.7" xref="S3.SS2.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.SS2.p1.3.m3.4.4.3.3" xref="S3.SS2.p1.3.m3.4.4.3.3.cmml"><mi id="S3.SS2.p1.3.m3.4.4.3.3.2" xref="S3.SS2.p1.3.m3.4.4.3.3.2.cmml">q</mi><mi id="S3.SS2.p1.3.m3.4.4.3.3.3" xref="S3.SS2.p1.3.m3.4.4.3.3.3.cmml">N</mi></msub><mo id="S3.SS2.p1.3.m3.4.4.3.8" stretchy="false" xref="S3.SS2.p1.3.m3.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.4b"><list id="S3.SS2.p1.3.m3.4.4.4.cmml" xref="S3.SS2.p1.3.m3.4.4.3"><apply id="S3.SS2.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.2">𝑞</ci><cn id="S3.SS2.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S3.SS2.p1.3.m3.3.3.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2">𝑞</ci><cn id="S3.SS2.p1.3.m3.3.3.2.2.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.3.3.2.2.3">2</cn></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">…</ci><apply id="S3.SS2.p1.3.m3.4.4.3.3.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.4.4.3.3.1.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS2.p1.3.m3.4.4.3.3.2.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3.2">𝑞</ci><ci id="S3.SS2.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS2.p1.3.m3.4.4.3.3.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.4c">[q_{1},q_{2},...,q_{N}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.4d">[ italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_q start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]</annotation></semantics></math> from the query tower <math alttext="f_{q}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑓</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">f_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and use the CLS output representation <math alttext="h_{\rm cls}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">ℎ</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">h_{\rm cls}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_h start_POSTSUBSCRIPT roman_cls end_POSTSUBSCRIPT</annotation></semantics></math> from the text tower <math alttext="f_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑓</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">f_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as the text representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}[h_{1},h_{2},...,h_{N}]&amp;=f_{q}([q_{1},q_{2},...,q_{N}],e)\\
h_{\rm cls}&amp;=f_{t}([t_{\rm cls},t_{1},...,t_{L}]),\\
\end{split}" class="ltx_Math" display="block" id="S3.E1.m1.57"><semantics id="S3.E1.m1.57a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E1.m1.57.57.6" rowspacing="0pt"><mtr id="S3.E1.m1.57.57.6a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.57.57.6b"><mrow id="S3.E1.m1.55.55.4.54.34.15.15"><mo id="S3.E1.m1.1.1.1.1.1.1" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">[</mo><msub id="S3.E1.m1.53.53.2.52.32.13.13.1"><mi id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml">h</mi><mn id="S3.E1.m1.3.3.3.3.3.3.1" xref="S3.E1.m1.3.3.3.3.3.3.1.cmml">1</mn></msub><mo id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><msub id="S3.E1.m1.54.54.3.53.33.14.14.2"><mi id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.5.5.5.5.5.5.cmml">h</mi><mn id="S3.E1.m1.6.6.6.6.6.6.1" xref="S3.E1.m1.6.6.6.6.6.6.1.cmml">2</mn></msub><mo id="S3.E1.m1.7.7.7.7.7.7" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><mi id="S3.E1.m1.8.8.8.8.8.8" mathvariant="normal" xref="S3.E1.m1.8.8.8.8.8.8.cmml">…</mi><mo id="S3.E1.m1.9.9.9.9.9.9" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><msub id="S3.E1.m1.55.55.4.54.34.15.15.3"><mi id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.10.10.10.10.10.10.cmml">h</mi><mi id="S3.E1.m1.11.11.11.11.11.11.1" xref="S3.E1.m1.11.11.11.11.11.11.1.cmml">N</mi></msub><mo id="S3.E1.m1.12.12.12.12.12.12" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">]</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.57.57.6c"><mrow id="S3.E1.m1.56.56.5.55.35.20"><mi id="S3.E1.m1.56.56.5.55.35.20.21" xref="S3.E1.m1.52.52.1.1.1.cmml"></mi><mo id="S3.E1.m1.13.13.13.13.1.1" xref="S3.E1.m1.13.13.13.13.1.1.cmml">=</mo><mrow id="S3.E1.m1.56.56.5.55.35.20.20"><msub id="S3.E1.m1.56.56.5.55.35.20.20.3"><mi id="S3.E1.m1.14.14.14.14.2.2" xref="S3.E1.m1.14.14.14.14.2.2.cmml">f</mi><mi id="S3.E1.m1.15.15.15.15.3.3.1" xref="S3.E1.m1.15.15.15.15.3.3.1.cmml">q</mi></msub><mo id="S3.E1.m1.56.56.5.55.35.20.20.2" xref="S3.E1.m1.52.52.1.1.1.cmml">⁢</mo><mrow id="S3.E1.m1.56.56.5.55.35.20.20.1.1"><mo id="S3.E1.m1.16.16.16.16.4.4" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.56.56.5.55.35.20.20.1.1.1"><mo id="S3.E1.m1.17.17.17.17.5.5" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">[</mo><msub id="S3.E1.m1.56.56.5.55.35.20.20.1.1.1.1.1"><mi id="S3.E1.m1.18.18.18.18.6.6" xref="S3.E1.m1.18.18.18.18.6.6.cmml">q</mi><mn id="S3.E1.m1.19.19.19.19.7.7.1" xref="S3.E1.m1.19.19.19.19.7.7.1.cmml">1</mn></msub><mo id="S3.E1.m1.20.20.20.20.8.8" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><msub id="S3.E1.m1.56.56.5.55.35.20.20.1.1.1.2.2"><mi id="S3.E1.m1.21.21.21.21.9.9" xref="S3.E1.m1.21.21.21.21.9.9.cmml">q</mi><mn id="S3.E1.m1.22.22.22.22.10.10.1" xref="S3.E1.m1.22.22.22.22.10.10.1.cmml">2</mn></msub><mo id="S3.E1.m1.23.23.23.23.11.11" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><mi id="S3.E1.m1.24.24.24.24.12.12" mathvariant="normal" xref="S3.E1.m1.24.24.24.24.12.12.cmml">…</mi><mo id="S3.E1.m1.25.25.25.25.13.13" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><msub id="S3.E1.m1.56.56.5.55.35.20.20.1.1.1.3.3"><mi id="S3.E1.m1.26.26.26.26.14.14" xref="S3.E1.m1.26.26.26.26.14.14.cmml">q</mi><mi id="S3.E1.m1.27.27.27.27.15.15.1" xref="S3.E1.m1.27.27.27.27.15.15.1.cmml">N</mi></msub><mo id="S3.E1.m1.28.28.28.28.16.16" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">]</mo></mrow><mo id="S3.E1.m1.29.29.29.29.17.17" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><mi id="S3.E1.m1.30.30.30.30.18.18" xref="S3.E1.m1.30.30.30.30.18.18.cmml">e</mi><mo id="S3.E1.m1.31.31.31.31.19.19" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E1.m1.57.57.6d"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.57.57.6e"><msub id="S3.E1.m1.33.33.33.2.2"><mi id="S3.E1.m1.32.32.32.1.1.1" xref="S3.E1.m1.32.32.32.1.1.1.cmml">h</mi><mi id="S3.E1.m1.33.33.33.2.2.2.1" xref="S3.E1.m1.33.33.33.2.2.2.1.cmml">cls</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.57.57.6f"><mrow id="S3.E1.m1.57.57.6.56.21.19.19"><mrow id="S3.E1.m1.57.57.6.56.21.19.19.1"><mi id="S3.E1.m1.57.57.6.56.21.19.19.1.2" xref="S3.E1.m1.52.52.1.1.1.cmml"></mi><mo id="S3.E1.m1.34.34.34.3.1.1" xref="S3.E1.m1.34.34.34.3.1.1.cmml">=</mo><mrow id="S3.E1.m1.57.57.6.56.21.19.19.1.1"><msub id="S3.E1.m1.57.57.6.56.21.19.19.1.1.3"><mi id="S3.E1.m1.35.35.35.4.2.2" xref="S3.E1.m1.35.35.35.4.2.2.cmml">f</mi><mi id="S3.E1.m1.36.36.36.5.3.3.1" xref="S3.E1.m1.36.36.36.5.3.3.1.cmml">t</mi></msub><mo id="S3.E1.m1.57.57.6.56.21.19.19.1.1.2" xref="S3.E1.m1.52.52.1.1.1.cmml">⁢</mo><mrow id="S3.E1.m1.57.57.6.56.21.19.19.1.1.1.1"><mo id="S3.E1.m1.37.37.37.6.4.4" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.57.57.6.56.21.19.19.1.1.1.1.1"><mo id="S3.E1.m1.38.38.38.7.5.5" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">[</mo><msub id="S3.E1.m1.57.57.6.56.21.19.19.1.1.1.1.1.1.1"><mi id="S3.E1.m1.39.39.39.8.6.6" xref="S3.E1.m1.39.39.39.8.6.6.cmml">t</mi><mi id="S3.E1.m1.40.40.40.9.7.7.1" xref="S3.E1.m1.40.40.40.9.7.7.1.cmml">cls</mi></msub><mo id="S3.E1.m1.41.41.41.10.8.8" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><msub id="S3.E1.m1.57.57.6.56.21.19.19.1.1.1.1.1.2.2"><mi id="S3.E1.m1.42.42.42.11.9.9" xref="S3.E1.m1.42.42.42.11.9.9.cmml">t</mi><mn id="S3.E1.m1.43.43.43.12.10.10.1" xref="S3.E1.m1.43.43.43.12.10.10.1.cmml">1</mn></msub><mo id="S3.E1.m1.44.44.44.13.11.11" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><mi id="S3.E1.m1.45.45.45.14.12.12" mathvariant="normal" xref="S3.E1.m1.45.45.45.14.12.12.cmml">…</mi><mo id="S3.E1.m1.46.46.46.15.13.13" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo><msub id="S3.E1.m1.57.57.6.56.21.19.19.1.1.1.1.1.3.3"><mi id="S3.E1.m1.47.47.47.16.14.14" xref="S3.E1.m1.47.47.47.16.14.14.cmml">t</mi><mi id="S3.E1.m1.48.48.48.17.15.15.1" xref="S3.E1.m1.48.48.48.17.15.15.1.cmml">L</mi></msub><mo id="S3.E1.m1.49.49.49.18.16.16" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">]</mo></mrow><mo id="S3.E1.m1.50.50.50.19.17.17" stretchy="false" xref="S3.E1.m1.52.52.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.51.51.51.20.18.18" xref="S3.E1.m1.52.52.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.57b"><apply id="S3.E1.m1.52.52.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><and id="S3.E1.m1.52.52.1.1.1a.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></and><apply id="S3.E1.m1.52.52.1.1.1b.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><eq id="S3.E1.m1.13.13.13.13.1.1.cmml" xref="S3.E1.m1.13.13.13.13.1.1"></eq><list id="S3.E1.m1.52.52.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><apply id="S3.E1.m1.52.52.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2">ℎ</ci><cn id="S3.E1.m1.3.3.3.3.3.3.1.cmml" type="integer" xref="S3.E1.m1.3.3.3.3.3.3.1">1</cn></apply><apply id="S3.E1.m1.52.52.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.5.5.5.5.cmml" xref="S3.E1.m1.5.5.5.5.5.5">ℎ</ci><cn id="S3.E1.m1.6.6.6.6.6.6.1.cmml" type="integer" xref="S3.E1.m1.6.6.6.6.6.6.1">2</cn></apply><ci id="S3.E1.m1.8.8.8.8.8.8.cmml" xref="S3.E1.m1.8.8.8.8.8.8">…</ci><apply id="S3.E1.m1.52.52.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.10.10.10.10.10.10.cmml" xref="S3.E1.m1.10.10.10.10.10.10">ℎ</ci><ci id="S3.E1.m1.11.11.11.11.11.11.1.cmml" xref="S3.E1.m1.11.11.11.11.11.11.1">𝑁</ci></apply></list><apply id="S3.E1.m1.52.52.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><times id="S3.E1.m1.52.52.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></times><apply id="S3.E1.m1.52.52.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.4.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.14.14.14.14.2.2.cmml" xref="S3.E1.m1.14.14.14.14.2.2">𝑓</ci><ci id="S3.E1.m1.15.15.15.15.3.3.1.cmml" xref="S3.E1.m1.15.15.15.15.3.3.1">𝑞</ci></apply><interval closure="open" id="S3.E1.m1.52.52.1.1.1.4.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><list id="S3.E1.m1.52.52.1.1.1.4.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><apply id="S3.E1.m1.52.52.1.1.1.4.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.18.18.18.18.6.6.cmml" xref="S3.E1.m1.18.18.18.18.6.6">𝑞</ci><cn id="S3.E1.m1.19.19.19.19.7.7.1.cmml" type="integer" xref="S3.E1.m1.19.19.19.19.7.7.1">1</cn></apply><apply id="S3.E1.m1.52.52.1.1.1.4.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.4.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.21.21.21.21.9.9.cmml" xref="S3.E1.m1.21.21.21.21.9.9">𝑞</ci><cn id="S3.E1.m1.22.22.22.22.10.10.1.cmml" type="integer" xref="S3.E1.m1.22.22.22.22.10.10.1">2</cn></apply><ci id="S3.E1.m1.24.24.24.24.12.12.cmml" xref="S3.E1.m1.24.24.24.24.12.12">…</ci><apply id="S3.E1.m1.52.52.1.1.1.4.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.4.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.26.26.26.26.14.14.cmml" xref="S3.E1.m1.26.26.26.26.14.14">𝑞</ci><ci id="S3.E1.m1.27.27.27.27.15.15.1.cmml" xref="S3.E1.m1.27.27.27.27.15.15.1">𝑁</ci></apply></list><ci id="S3.E1.m1.30.30.30.30.18.18.cmml" xref="S3.E1.m1.30.30.30.30.18.18">𝑒</ci></interval><apply id="S3.E1.m1.52.52.1.1.1.4.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.4.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.32.32.32.1.1.1.cmml" xref="S3.E1.m1.32.32.32.1.1.1">ℎ</ci><ci id="S3.E1.m1.33.33.33.2.2.2.1.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1">cls</ci></apply></apply></apply><apply id="S3.E1.m1.52.52.1.1.1c.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><eq id="S3.E1.m1.34.34.34.3.1.1.cmml" xref="S3.E1.m1.34.34.34.3.1.1"></eq><share href="https://arxiv.org/html/2406.02844v1#S3.E1.m1.52.52.1.1.1.4.cmml" id="S3.E1.m1.52.52.1.1.1d.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></share><apply id="S3.E1.m1.52.52.1.1.1.5.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><times id="S3.E1.m1.52.52.1.1.1.5.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></times><apply id="S3.E1.m1.52.52.1.1.1.5.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.5.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.35.35.35.4.2.2.cmml" xref="S3.E1.m1.35.35.35.4.2.2">𝑓</ci><ci id="S3.E1.m1.36.36.36.5.3.3.1.cmml" xref="S3.E1.m1.36.36.36.5.3.3.1">𝑡</ci></apply><list id="S3.E1.m1.52.52.1.1.1.5.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><apply id="S3.E1.m1.52.52.1.1.1.5.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.5.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.39.39.39.8.6.6.cmml" xref="S3.E1.m1.39.39.39.8.6.6">𝑡</ci><ci id="S3.E1.m1.40.40.40.9.7.7.1.cmml" xref="S3.E1.m1.40.40.40.9.7.7.1">cls</ci></apply><apply id="S3.E1.m1.52.52.1.1.1.5.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.5.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.42.42.42.11.9.9.cmml" xref="S3.E1.m1.42.42.42.11.9.9">𝑡</ci><cn id="S3.E1.m1.43.43.43.12.10.10.1.cmml" type="integer" xref="S3.E1.m1.43.43.43.12.10.10.1">1</cn></apply><ci id="S3.E1.m1.45.45.45.14.12.12.cmml" xref="S3.E1.m1.45.45.45.14.12.12">…</ci><apply id="S3.E1.m1.52.52.1.1.1.5.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.52.52.1.1.1.5.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.47.47.47.16.14.14.cmml" xref="S3.E1.m1.47.47.47.16.14.14">𝑡</ci><ci id="S3.E1.m1.48.48.48.17.15.15.1.cmml" xref="S3.E1.m1.48.48.48.17.15.15.1">𝐿</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.57c">\begin{split}[h_{1},h_{2},...,h_{N}]&amp;=f_{q}([q_{1},q_{2},...,q_{N}],e)\\
h_{\rm cls}&amp;=f_{t}([t_{\rm cls},t_{1},...,t_{L}]),\\
\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.57d">start_ROW start_CELL [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] end_CELL start_CELL = italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( [ italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_q start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] , italic_e ) end_CELL end_ROW start_ROW start_CELL italic_h start_POSTSUBSCRIPT roman_cls end_POSTSUBSCRIPT end_CELL start_CELL = italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( [ italic_t start_POSTSUBSCRIPT roman_cls end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_t start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ] ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.9">where <math alttext="e" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m1.1"><semantics id="S3.SS2.p1.7.m1.1a"><mi id="S3.SS2.p1.7.m1.1.1" xref="S3.SS2.p1.7.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m1.1b"><ci id="S3.SS2.p1.7.m1.1.1.cmml" xref="S3.SS2.p1.7.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m1.1c">e</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m1.1d">italic_e</annotation></semantics></math> is the item input embedding and <math alttext="[t_{1},...,t_{L}]" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m2.3"><semantics id="S3.SS2.p1.8.m2.3a"><mrow id="S3.SS2.p1.8.m2.3.3.2" xref="S3.SS2.p1.8.m2.3.3.3.cmml"><mo id="S3.SS2.p1.8.m2.3.3.2.3" stretchy="false" xref="S3.SS2.p1.8.m2.3.3.3.cmml">[</mo><msub id="S3.SS2.p1.8.m2.2.2.1.1" xref="S3.SS2.p1.8.m2.2.2.1.1.cmml"><mi id="S3.SS2.p1.8.m2.2.2.1.1.2" xref="S3.SS2.p1.8.m2.2.2.1.1.2.cmml">t</mi><mn id="S3.SS2.p1.8.m2.2.2.1.1.3" xref="S3.SS2.p1.8.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.8.m2.3.3.2.4" xref="S3.SS2.p1.8.m2.3.3.3.cmml">,</mo><mi id="S3.SS2.p1.8.m2.1.1" mathvariant="normal" xref="S3.SS2.p1.8.m2.1.1.cmml">…</mi><mo id="S3.SS2.p1.8.m2.3.3.2.5" xref="S3.SS2.p1.8.m2.3.3.3.cmml">,</mo><msub id="S3.SS2.p1.8.m2.3.3.2.2" xref="S3.SS2.p1.8.m2.3.3.2.2.cmml"><mi id="S3.SS2.p1.8.m2.3.3.2.2.2" xref="S3.SS2.p1.8.m2.3.3.2.2.2.cmml">t</mi><mi id="S3.SS2.p1.8.m2.3.3.2.2.3" xref="S3.SS2.p1.8.m2.3.3.2.2.3.cmml">L</mi></msub><mo id="S3.SS2.p1.8.m2.3.3.2.6" stretchy="false" xref="S3.SS2.p1.8.m2.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m2.3b"><list id="S3.SS2.p1.8.m2.3.3.3.cmml" xref="S3.SS2.p1.8.m2.3.3.2"><apply id="S3.SS2.p1.8.m2.2.2.1.1.cmml" xref="S3.SS2.p1.8.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.8.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m2.2.2.1.1.2.cmml" xref="S3.SS2.p1.8.m2.2.2.1.1.2">𝑡</ci><cn id="S3.SS2.p1.8.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.8.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p1.8.m2.1.1.cmml" xref="S3.SS2.p1.8.m2.1.1">…</ci><apply id="S3.SS2.p1.8.m2.3.3.2.2.cmml" xref="S3.SS2.p1.8.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m2.3.3.2.2.1.cmml" xref="S3.SS2.p1.8.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.8.m2.3.3.2.2.2.cmml" xref="S3.SS2.p1.8.m2.3.3.2.2.2">𝑡</ci><ci id="S3.SS2.p1.8.m2.3.3.2.2.3.cmml" xref="S3.SS2.p1.8.m2.3.3.2.2.3">𝐿</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m2.3c">[t_{1},...,t_{L}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m2.3d">[ italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_t start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math> are text tokens. We select the closest query representation to <math alttext="h_{\rm cls}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m3.1"><semantics id="S3.SS2.p1.9.m3.1a"><msub id="S3.SS2.p1.9.m3.1.1" xref="S3.SS2.p1.9.m3.1.1.cmml"><mi id="S3.SS2.p1.9.m3.1.1.2" xref="S3.SS2.p1.9.m3.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.9.m3.1.1.3" xref="S3.SS2.p1.9.m3.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m3.1b"><apply id="S3.SS2.p1.9.m3.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m3.1.1.1.cmml" xref="S3.SS2.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m3.1.1.2.cmml" xref="S3.SS2.p1.9.m3.1.1.2">ℎ</ci><ci id="S3.SS2.p1.9.m3.1.1.3.cmml" xref="S3.SS2.p1.9.m3.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m3.1c">h_{\rm cls}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m3.1d">italic_h start_POSTSUBSCRIPT roman_cls end_POSTSUBSCRIPT</annotation></semantics></math> as the item representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}i={\rm argmax}_{j}\;\;&amp;{\rm cosine\_similarity}(h_{j},h_{\rm cls}%
)\\
&amp;h_{\rm item}=h_{i}\end{split}" class="ltx_Math" display="block" id="S3.E2.m1.23"><semantics id="S3.E2.m1.23a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E2.m1.23.23.4" rowspacing="0pt" xref="S3.E2.m1.21.21.2.cmml"><mtr id="S3.E2.m1.23.23.4a" xref="S3.E2.m1.21.21.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.23.23.4b" xref="S3.E2.m1.21.21.2.cmml"><mrow id="S3.E2.m1.4.4.4.4.4" xref="S3.E2.m1.21.21.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml">=</mo><msub id="S3.E2.m1.4.4.4.4.4.5" xref="S3.E2.m1.21.21.2.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.3.cmml">argmax</mi><mi id="S3.E2.m1.4.4.4.4.4.4.1" xref="S3.E2.m1.4.4.4.4.4.4.1.cmml">j</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.23.23.4c" xref="S3.E2.m1.21.21.2.cmml"><mrow id="S3.E2.m1.23.23.4.21.16.12" xref="S3.E2.m1.21.21.2.cmml"><mi id="S3.E2.m1.5.5.5.5.1.1" xref="S3.E2.m1.5.5.5.5.1.1.cmml">cosine</mi><mo id="S3.E2.m1.23.23.4.21.16.12.13" xref="S3.E2.m1.21.21.2a.cmml">⁢</mo><mi id="S3.E2.m1.6.6.6.6.2.2" mathvariant="normal" xref="S3.E2.m1.6.6.6.6.2.2.cmml">_</mi><mo id="S3.E2.m1.23.23.4.21.16.12.13a" xref="S3.E2.m1.21.21.2a.cmml">⁢</mo><mi id="S3.E2.m1.7.7.7.7.3.3" xref="S3.E2.m1.7.7.7.7.3.3.cmml">similarity</mi><mo id="S3.E2.m1.23.23.4.21.16.12.13b" xref="S3.E2.m1.21.21.2a.cmml">⁢</mo><mrow id="S3.E2.m1.23.23.4.21.16.12.12.2" xref="S3.E2.m1.21.21.2.cmml"><mo id="S3.E2.m1.8.8.8.8.4.4" stretchy="false" xref="S3.E2.m1.21.21.2a.cmml">(</mo><msub id="S3.E2.m1.22.22.3.20.15.11.11.1.1" xref="S3.E2.m1.21.21.2.cmml"><mi id="S3.E2.m1.9.9.9.9.5.5" xref="S3.E2.m1.9.9.9.9.5.5.cmml">h</mi><mi id="S3.E2.m1.10.10.10.10.6.6.1" xref="S3.E2.m1.10.10.10.10.6.6.1.cmml">j</mi></msub><mo id="S3.E2.m1.11.11.11.11.7.7" xref="S3.E2.m1.21.21.2a.cmml">,</mo><msub id="S3.E2.m1.23.23.4.21.16.12.12.2.2" xref="S3.E2.m1.21.21.2.cmml"><mi id="S3.E2.m1.12.12.12.12.8.8" xref="S3.E2.m1.12.12.12.12.8.8.cmml">h</mi><mi id="S3.E2.m1.13.13.13.13.9.9.1" xref="S3.E2.m1.13.13.13.13.9.9.1.cmml">cls</mi></msub><mo id="S3.E2.m1.14.14.14.14.10.10" stretchy="false" xref="S3.E2.m1.21.21.2a.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E2.m1.23.23.4d" xref="S3.E2.m1.21.21.2.cmml"><mtd id="S3.E2.m1.23.23.4e" xref="S3.E2.m1.21.21.2a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.23.23.4f" xref="S3.E2.m1.21.21.2.cmml"><mrow id="S3.E2.m1.19.19.19.5.5" xref="S3.E2.m1.21.21.2.cmml"><msub id="S3.E2.m1.19.19.19.5.5.6" xref="S3.E2.m1.21.21.2.cmml"><mi id="S3.E2.m1.15.15.15.1.1.1" xref="S3.E2.m1.15.15.15.1.1.1.cmml">h</mi><mi id="S3.E2.m1.16.16.16.2.2.2.1" xref="S3.E2.m1.16.16.16.2.2.2.1.cmml">item</mi></msub><mo id="S3.E2.m1.17.17.17.3.3.3" xref="S3.E2.m1.17.17.17.3.3.3.cmml">=</mo><msub id="S3.E2.m1.19.19.19.5.5.7" xref="S3.E2.m1.21.21.2.cmml"><mi id="S3.E2.m1.18.18.18.4.4.4" xref="S3.E2.m1.18.18.18.4.4.4.cmml">h</mi><mi id="S3.E2.m1.19.19.19.5.5.5.1" xref="S3.E2.m1.19.19.19.5.5.5.1.cmml">i</mi></msub></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.23b"><apply id="S3.E2.m1.21.21.2.cmml" xref="S3.E2.m1.23.23.4"><and id="S3.E2.m1.21.21.2a.cmml" xref="S3.E2.m1.23.23.4.21.16.12.13"></and><apply id="S3.E2.m1.21.21.2b.cmml" xref="S3.E2.m1.23.23.4"><eq id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"></eq><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝑖</ci><apply id="S3.E2.m1.21.21.2.2.cmml" xref="S3.E2.m1.23.23.4"><times id="S3.E2.m1.21.21.2.2.3.cmml" xref="S3.E2.m1.23.23.4.21.16.12.13"></times><apply id="S3.E2.m1.21.21.2.2.4.cmml" xref="S3.E2.m1.23.23.4"><csymbol cd="ambiguous" id="S3.E2.m1.21.21.2.2.4.1.cmml" xref="S3.E2.m1.23.23.4.21.16.12.13">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3">argmax</ci><ci id="S3.E2.m1.4.4.4.4.4.4.1.cmml" xref="S3.E2.m1.4.4.4.4.4.4.1">𝑗</ci></apply><ci id="S3.E2.m1.5.5.5.5.1.1.cmml" xref="S3.E2.m1.5.5.5.5.1.1">cosine</ci><ci id="S3.E2.m1.6.6.6.6.2.2.cmml" xref="S3.E2.m1.6.6.6.6.2.2">_</ci><ci id="S3.E2.m1.7.7.7.7.3.3.cmml" xref="S3.E2.m1.7.7.7.7.3.3">similarity</ci><interval closure="open" id="S3.E2.m1.21.21.2.2.2.3.cmml" xref="S3.E2.m1.23.23.4"><apply id="S3.E2.m1.20.20.1.1.1.1.1.cmml" xref="S3.E2.m1.23.23.4"><csymbol cd="ambiguous" id="S3.E2.m1.20.20.1.1.1.1.1.1.cmml" xref="S3.E2.m1.23.23.4">subscript</csymbol><ci id="S3.E2.m1.9.9.9.9.5.5.cmml" xref="S3.E2.m1.9.9.9.9.5.5">ℎ</ci><ci id="S3.E2.m1.10.10.10.10.6.6.1.cmml" xref="S3.E2.m1.10.10.10.10.6.6.1">𝑗</ci></apply><apply id="S3.E2.m1.21.21.2.2.2.2.2.cmml" xref="S3.E2.m1.23.23.4"><csymbol cd="ambiguous" id="S3.E2.m1.21.21.2.2.2.2.2.1.cmml" xref="S3.E2.m1.23.23.4">subscript</csymbol><ci id="S3.E2.m1.12.12.12.12.8.8.cmml" xref="S3.E2.m1.12.12.12.12.8.8">ℎ</ci><ci id="S3.E2.m1.13.13.13.13.9.9.1.cmml" xref="S3.E2.m1.13.13.13.13.9.9.1">cls</ci></apply></interval><apply id="S3.E2.m1.21.21.2.2.8.cmml" xref="S3.E2.m1.23.23.4"><csymbol cd="ambiguous" id="S3.E2.m1.21.21.2.2.8.1.cmml" xref="S3.E2.m1.23.23.4.21.16.12.13">subscript</csymbol><ci id="S3.E2.m1.15.15.15.1.1.1.cmml" xref="S3.E2.m1.15.15.15.1.1.1">ℎ</ci><ci id="S3.E2.m1.16.16.16.2.2.2.1.cmml" xref="S3.E2.m1.16.16.16.2.2.2.1">item</ci></apply></apply></apply><apply id="S3.E2.m1.21.21.2c.cmml" xref="S3.E2.m1.23.23.4"><eq id="S3.E2.m1.17.17.17.3.3.3.cmml" xref="S3.E2.m1.17.17.17.3.3.3"></eq><share href="https://arxiv.org/html/2406.02844v1#S3.E2.m1.21.21.2.2.cmml" id="S3.E2.m1.21.21.2d.cmml" xref="S3.E2.m1.23.23.4.21.16.12.13"></share><apply id="S3.E2.m1.21.21.2.7.cmml" xref="S3.E2.m1.23.23.4"><csymbol cd="ambiguous" id="S3.E2.m1.21.21.2.7.1.cmml" xref="S3.E2.m1.23.23.4.21.16.12.13">subscript</csymbol><ci id="S3.E2.m1.18.18.18.4.4.4.cmml" xref="S3.E2.m1.18.18.18.4.4.4">ℎ</ci><ci id="S3.E2.m1.19.19.19.5.5.5.1.cmml" xref="S3.E2.m1.19.19.19.5.5.5.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.23c">\begin{split}i={\rm argmax}_{j}\;\;&amp;{\rm cosine\_similarity}(h_{j},h_{\rm cls}%
)\\
&amp;h_{\rm item}=h_{i}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.23d">start_ROW start_CELL italic_i = roman_argmax start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_CELL start_CELL roman_cosine _ roman_similarity ( italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT roman_cls end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_h start_POSTSUBSCRIPT roman_item end_POSTSUBSCRIPT = italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.11">Then we compute the contrastive loss between <math alttext="h_{\rm item}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m1.1"><semantics id="S3.SS2.p1.10.m1.1a"><msub id="S3.SS2.p1.10.m1.1.1" xref="S3.SS2.p1.10.m1.1.1.cmml"><mi id="S3.SS2.p1.10.m1.1.1.2" xref="S3.SS2.p1.10.m1.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.10.m1.1.1.3" xref="S3.SS2.p1.10.m1.1.1.3.cmml">item</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m1.1b"><apply id="S3.SS2.p1.10.m1.1.1.cmml" xref="S3.SS2.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m1.1.1.1.cmml" xref="S3.SS2.p1.10.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m1.1.1.2.cmml" xref="S3.SS2.p1.10.m1.1.1.2">ℎ</ci><ci id="S3.SS2.p1.10.m1.1.1.3.cmml" xref="S3.SS2.p1.10.m1.1.1.3">item</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m1.1c">h_{\rm item}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m1.1d">italic_h start_POSTSUBSCRIPT roman_item end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h_{\rm cls}" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m2.1"><semantics id="S3.SS2.p1.11.m2.1a"><msub id="S3.SS2.p1.11.m2.1.1" xref="S3.SS2.p1.11.m2.1.1.cmml"><mi id="S3.SS2.p1.11.m2.1.1.2" xref="S3.SS2.p1.11.m2.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.11.m2.1.1.3" xref="S3.SS2.p1.11.m2.1.1.3.cmml">cls</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m2.1b"><apply id="S3.SS2.p1.11.m2.1.1.cmml" xref="S3.SS2.p1.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m2.1.1.1.cmml" xref="S3.SS2.p1.11.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m2.1.1.2.cmml" xref="S3.SS2.p1.11.m2.1.1.2">ℎ</ci><ci id="S3.SS2.p1.11.m2.1.1.3.cmml" xref="S3.SS2.p1.11.m2.1.1.3">cls</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m2.1c">h_{\rm cls}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m2.1d">italic_h start_POSTSUBSCRIPT roman_cls end_POSTSUBSCRIPT</annotation></semantics></math> using in-batch negative sampling following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib42" title="">42</a>]</cite>. The item-text pair data we used is processed from item descriptions and tags, more details can be found in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS1" title="4.1 Datasets ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">4.1</span></a>. In addition to item-text alignment tasks, we also introduce a novel item-item contrastive learning loss to prevent the model from overfitting on item-text data when text labels are sparse, Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.F2" title="Figure 2 ‣ Multimodal LLM ‣ 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(b). The item-item contrastive loss is computed in a similar way by extending the item-text contrastive loss, Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3.E1" title="In 3.2 Item-Language Representation Learning ‣ 3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> and Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S3.E2" title="In 3.2 Item-Language Representation Learning ‣ 3 Method ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. Given a positive item-item pair, we first compute output representations of the N learnable queries for both items:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}[h^{[1]}_{1},h^{[1]}_{2},...,h^{[1]}_{N}]&amp;=f_{q}([q_{1},q_{2},...%
,q_{N}],e^{[1]})\\
[h^{[2]}_{1},h^{[2]}_{2},...,h^{[2]}_{N}]&amp;=f_{q}([q_{1},q_{2},...,q_{N}],e^{[2%
]}),\\
\end{split}" class="ltx_Math" display="block" id="S3.E3.m1.81"><semantics id="S3.E3.m1.81a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E3.m1.81.81.10" rowspacing="0pt"><mtr id="S3.E3.m1.81.81.10a"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.81.81.10b"><mrow id="S3.E3.m1.75.75.4.74.38.18.18"><mo id="S3.E3.m1.1.1.1.1.1.1" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">[</mo><msubsup id="S3.E3.m1.73.73.2.72.36.16.16.1"><mi id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml">h</mi><mn id="S3.E3.m1.4.4.4.4.4.4.1" xref="S3.E3.m1.4.4.4.4.4.4.1.cmml">1</mn><mrow id="S3.E3.m1.3.3.3.3.3.3.1.3" xref="S3.E3.m1.3.3.3.3.3.3.1.2.cmml"><mo id="S3.E3.m1.3.3.3.3.3.3.1.3.1" stretchy="false" xref="S3.E3.m1.3.3.3.3.3.3.1.2.1.cmml">[</mo><mn id="S3.E3.m1.3.3.3.3.3.3.1.1" xref="S3.E3.m1.3.3.3.3.3.3.1.1.cmml">1</mn><mo id="S3.E3.m1.3.3.3.3.3.3.1.3.2" stretchy="false" xref="S3.E3.m1.3.3.3.3.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m1.5.5.5.5.5.5" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msubsup id="S3.E3.m1.74.74.3.73.37.17.17.2"><mi id="S3.E3.m1.6.6.6.6.6.6" xref="S3.E3.m1.6.6.6.6.6.6.cmml">h</mi><mn id="S3.E3.m1.8.8.8.8.8.8.1" xref="S3.E3.m1.8.8.8.8.8.8.1.cmml">2</mn><mrow id="S3.E3.m1.7.7.7.7.7.7.1.3" xref="S3.E3.m1.7.7.7.7.7.7.1.2.cmml"><mo id="S3.E3.m1.7.7.7.7.7.7.1.3.1" stretchy="false" xref="S3.E3.m1.7.7.7.7.7.7.1.2.1.cmml">[</mo><mn id="S3.E3.m1.7.7.7.7.7.7.1.1" xref="S3.E3.m1.7.7.7.7.7.7.1.1.cmml">1</mn><mo id="S3.E3.m1.7.7.7.7.7.7.1.3.2" stretchy="false" xref="S3.E3.m1.7.7.7.7.7.7.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m1.9.9.9.9.9.9" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><mi id="S3.E3.m1.10.10.10.10.10.10" mathvariant="normal" xref="S3.E3.m1.10.10.10.10.10.10.cmml">…</mi><mo id="S3.E3.m1.11.11.11.11.11.11" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msubsup id="S3.E3.m1.75.75.4.74.38.18.18.3"><mi id="S3.E3.m1.12.12.12.12.12.12" xref="S3.E3.m1.12.12.12.12.12.12.cmml">h</mi><mi id="S3.E3.m1.14.14.14.14.14.14.1" xref="S3.E3.m1.14.14.14.14.14.14.1.cmml">N</mi><mrow id="S3.E3.m1.13.13.13.13.13.13.1.3" xref="S3.E3.m1.13.13.13.13.13.13.1.2.cmml"><mo id="S3.E3.m1.13.13.13.13.13.13.1.3.1" stretchy="false" xref="S3.E3.m1.13.13.13.13.13.13.1.2.1.cmml">[</mo><mn id="S3.E3.m1.13.13.13.13.13.13.1.1" xref="S3.E3.m1.13.13.13.13.13.13.1.1.cmml">1</mn><mo id="S3.E3.m1.13.13.13.13.13.13.1.3.2" stretchy="false" xref="S3.E3.m1.13.13.13.13.13.13.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m1.15.15.15.15.15.15" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">]</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.81.81.10c"><mrow id="S3.E3.m1.77.77.6.76.40.22"><mi id="S3.E3.m1.77.77.6.76.40.22.23" xref="S3.E3.m1.72.72.1.1.1.cmml"></mi><mo id="S3.E3.m1.16.16.16.16.1.1" xref="S3.E3.m1.16.16.16.16.1.1.cmml">=</mo><mrow id="S3.E3.m1.77.77.6.76.40.22.22"><msub id="S3.E3.m1.77.77.6.76.40.22.22.4"><mi id="S3.E3.m1.17.17.17.17.2.2" xref="S3.E3.m1.17.17.17.17.2.2.cmml">f</mi><mi id="S3.E3.m1.18.18.18.18.3.3.1" xref="S3.E3.m1.18.18.18.18.3.3.1.cmml">q</mi></msub><mo id="S3.E3.m1.77.77.6.76.40.22.22.3" xref="S3.E3.m1.72.72.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.77.77.6.76.40.22.22.2.2"><mo id="S3.E3.m1.19.19.19.19.4.4" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.76.76.5.75.39.21.21.1.1.1"><mo id="S3.E3.m1.20.20.20.20.5.5" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">[</mo><msub id="S3.E3.m1.76.76.5.75.39.21.21.1.1.1.1.1"><mi id="S3.E3.m1.21.21.21.21.6.6" xref="S3.E3.m1.21.21.21.21.6.6.cmml">q</mi><mn id="S3.E3.m1.22.22.22.22.7.7.1" xref="S3.E3.m1.22.22.22.22.7.7.1.cmml">1</mn></msub><mo id="S3.E3.m1.23.23.23.23.8.8" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msub id="S3.E3.m1.76.76.5.75.39.21.21.1.1.1.2.2"><mi id="S3.E3.m1.24.24.24.24.9.9" xref="S3.E3.m1.24.24.24.24.9.9.cmml">q</mi><mn id="S3.E3.m1.25.25.25.25.10.10.1" xref="S3.E3.m1.25.25.25.25.10.10.1.cmml">2</mn></msub><mo id="S3.E3.m1.26.26.26.26.11.11" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><mi id="S3.E3.m1.27.27.27.27.12.12" mathvariant="normal" xref="S3.E3.m1.27.27.27.27.12.12.cmml">…</mi><mo id="S3.E3.m1.28.28.28.28.13.13" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msub id="S3.E3.m1.76.76.5.75.39.21.21.1.1.1.3.3"><mi id="S3.E3.m1.29.29.29.29.14.14" xref="S3.E3.m1.29.29.29.29.14.14.cmml">q</mi><mi id="S3.E3.m1.30.30.30.30.15.15.1" xref="S3.E3.m1.30.30.30.30.15.15.1.cmml">N</mi></msub><mo id="S3.E3.m1.31.31.31.31.16.16" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">]</mo></mrow><mo id="S3.E3.m1.32.32.32.32.17.17" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msup id="S3.E3.m1.77.77.6.76.40.22.22.2.2.2"><mi id="S3.E3.m1.33.33.33.33.18.18" xref="S3.E3.m1.33.33.33.33.18.18.cmml">e</mi><mrow id="S3.E3.m1.34.34.34.34.19.19.1.3" xref="S3.E3.m1.34.34.34.34.19.19.1.2.cmml"><mo id="S3.E3.m1.34.34.34.34.19.19.1.3.1" stretchy="false" xref="S3.E3.m1.34.34.34.34.19.19.1.2.1.cmml">[</mo><mn id="S3.E3.m1.34.34.34.34.19.19.1.1" xref="S3.E3.m1.34.34.34.34.19.19.1.1.cmml">1</mn><mo id="S3.E3.m1.34.34.34.34.19.19.1.3.2" stretchy="false" xref="S3.E3.m1.34.34.34.34.19.19.1.2.1.cmml">]</mo></mrow></msup><mo id="S3.E3.m1.35.35.35.35.20.20" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E3.m1.81.81.10d"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.81.81.10e"><mrow id="S3.E3.m1.80.80.9.79.39.18.18"><mo id="S3.E3.m1.36.36.36.1.1.1" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">[</mo><msubsup id="S3.E3.m1.78.78.7.77.37.16.16.1"><mi id="S3.E3.m1.37.37.37.2.2.2" xref="S3.E3.m1.37.37.37.2.2.2.cmml">h</mi><mn id="S3.E3.m1.39.39.39.4.4.4.1" xref="S3.E3.m1.39.39.39.4.4.4.1.cmml">1</mn><mrow id="S3.E3.m1.38.38.38.3.3.3.1.3" xref="S3.E3.m1.38.38.38.3.3.3.1.2.cmml"><mo id="S3.E3.m1.38.38.38.3.3.3.1.3.1" stretchy="false" xref="S3.E3.m1.38.38.38.3.3.3.1.2.1.cmml">[</mo><mn id="S3.E3.m1.38.38.38.3.3.3.1.1" xref="S3.E3.m1.38.38.38.3.3.3.1.1.cmml">2</mn><mo id="S3.E3.m1.38.38.38.3.3.3.1.3.2" stretchy="false" xref="S3.E3.m1.38.38.38.3.3.3.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m1.40.40.40.5.5.5" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msubsup id="S3.E3.m1.79.79.8.78.38.17.17.2"><mi id="S3.E3.m1.41.41.41.6.6.6" xref="S3.E3.m1.41.41.41.6.6.6.cmml">h</mi><mn id="S3.E3.m1.43.43.43.8.8.8.1" xref="S3.E3.m1.43.43.43.8.8.8.1.cmml">2</mn><mrow id="S3.E3.m1.42.42.42.7.7.7.1.3" xref="S3.E3.m1.42.42.42.7.7.7.1.2.cmml"><mo id="S3.E3.m1.42.42.42.7.7.7.1.3.1" stretchy="false" xref="S3.E3.m1.42.42.42.7.7.7.1.2.1.cmml">[</mo><mn id="S3.E3.m1.42.42.42.7.7.7.1.1" xref="S3.E3.m1.42.42.42.7.7.7.1.1.cmml">2</mn><mo id="S3.E3.m1.42.42.42.7.7.7.1.3.2" stretchy="false" xref="S3.E3.m1.42.42.42.7.7.7.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m1.44.44.44.9.9.9" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><mi id="S3.E3.m1.45.45.45.10.10.10" mathvariant="normal" xref="S3.E3.m1.45.45.45.10.10.10.cmml">…</mi><mo id="S3.E3.m1.46.46.46.11.11.11" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msubsup id="S3.E3.m1.80.80.9.79.39.18.18.3"><mi id="S3.E3.m1.47.47.47.12.12.12" xref="S3.E3.m1.47.47.47.12.12.12.cmml">h</mi><mi id="S3.E3.m1.49.49.49.14.14.14.1" xref="S3.E3.m1.49.49.49.14.14.14.1.cmml">N</mi><mrow id="S3.E3.m1.48.48.48.13.13.13.1.3" xref="S3.E3.m1.48.48.48.13.13.13.1.2.cmml"><mo id="S3.E3.m1.48.48.48.13.13.13.1.3.1" stretchy="false" xref="S3.E3.m1.48.48.48.13.13.13.1.2.1.cmml">[</mo><mn id="S3.E3.m1.48.48.48.13.13.13.1.1" xref="S3.E3.m1.48.48.48.13.13.13.1.1.cmml">2</mn><mo id="S3.E3.m1.48.48.48.13.13.13.1.3.2" stretchy="false" xref="S3.E3.m1.48.48.48.13.13.13.1.2.1.cmml">]</mo></mrow></msubsup><mo id="S3.E3.m1.50.50.50.15.15.15" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">]</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.81.81.10f"><mrow id="S3.E3.m1.81.81.10.80.40.22.22"><mrow id="S3.E3.m1.81.81.10.80.40.22.22.1"><mi id="S3.E3.m1.81.81.10.80.40.22.22.1.3" xref="S3.E3.m1.72.72.1.1.1.cmml"></mi><mo id="S3.E3.m1.51.51.51.16.1.1" xref="S3.E3.m1.51.51.51.16.1.1.cmml">=</mo><mrow id="S3.E3.m1.81.81.10.80.40.22.22.1.2"><msub id="S3.E3.m1.81.81.10.80.40.22.22.1.2.4"><mi id="S3.E3.m1.52.52.52.17.2.2" xref="S3.E3.m1.52.52.52.17.2.2.cmml">f</mi><mi id="S3.E3.m1.53.53.53.18.3.3.1" xref="S3.E3.m1.53.53.53.18.3.3.1.cmml">q</mi></msub><mo id="S3.E3.m1.81.81.10.80.40.22.22.1.2.3" xref="S3.E3.m1.72.72.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.81.81.10.80.40.22.22.1.2.2.2"><mo id="S3.E3.m1.54.54.54.19.4.4" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.81.81.10.80.40.22.22.1.1.1.1.1"><mo id="S3.E3.m1.55.55.55.20.5.5" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">[</mo><msub id="S3.E3.m1.81.81.10.80.40.22.22.1.1.1.1.1.1.1"><mi id="S3.E3.m1.56.56.56.21.6.6" xref="S3.E3.m1.56.56.56.21.6.6.cmml">q</mi><mn id="S3.E3.m1.57.57.57.22.7.7.1" xref="S3.E3.m1.57.57.57.22.7.7.1.cmml">1</mn></msub><mo id="S3.E3.m1.58.58.58.23.8.8" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msub id="S3.E3.m1.81.81.10.80.40.22.22.1.1.1.1.1.2.2"><mi id="S3.E3.m1.59.59.59.24.9.9" xref="S3.E3.m1.59.59.59.24.9.9.cmml">q</mi><mn id="S3.E3.m1.60.60.60.25.10.10.1" xref="S3.E3.m1.60.60.60.25.10.10.1.cmml">2</mn></msub><mo id="S3.E3.m1.61.61.61.26.11.11" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><mi id="S3.E3.m1.62.62.62.27.12.12" mathvariant="normal" xref="S3.E3.m1.62.62.62.27.12.12.cmml">…</mi><mo id="S3.E3.m1.63.63.63.28.13.13" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msub id="S3.E3.m1.81.81.10.80.40.22.22.1.1.1.1.1.3.3"><mi id="S3.E3.m1.64.64.64.29.14.14" xref="S3.E3.m1.64.64.64.29.14.14.cmml">q</mi><mi id="S3.E3.m1.65.65.65.30.15.15.1" xref="S3.E3.m1.65.65.65.30.15.15.1.cmml">N</mi></msub><mo id="S3.E3.m1.66.66.66.31.16.16" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">]</mo></mrow><mo id="S3.E3.m1.67.67.67.32.17.17" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo><msup id="S3.E3.m1.81.81.10.80.40.22.22.1.2.2.2.2"><mi id="S3.E3.m1.68.68.68.33.18.18" xref="S3.E3.m1.68.68.68.33.18.18.cmml">e</mi><mrow id="S3.E3.m1.69.69.69.34.19.19.1.3" xref="S3.E3.m1.69.69.69.34.19.19.1.2.cmml"><mo id="S3.E3.m1.69.69.69.34.19.19.1.3.1" stretchy="false" xref="S3.E3.m1.69.69.69.34.19.19.1.2.1.cmml">[</mo><mn id="S3.E3.m1.69.69.69.34.19.19.1.1" xref="S3.E3.m1.69.69.69.34.19.19.1.1.cmml">2</mn><mo id="S3.E3.m1.69.69.69.34.19.19.1.3.2" stretchy="false" xref="S3.E3.m1.69.69.69.34.19.19.1.2.1.cmml">]</mo></mrow></msup><mo id="S3.E3.m1.70.70.70.35.20.20" stretchy="false" xref="S3.E3.m1.72.72.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.71.71.71.36.21.21" xref="S3.E3.m1.72.72.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.81b"><apply id="S3.E3.m1.72.72.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><and id="S3.E3.m1.72.72.1.1.1a.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></and><apply id="S3.E3.m1.72.72.1.1.1b.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><eq id="S3.E3.m1.16.16.16.16.1.1.cmml" xref="S3.E3.m1.16.16.16.16.1.1"></eq><list id="S3.E3.m1.72.72.1.1.1.3.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><apply id="S3.E3.m1.72.72.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.72.72.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2">ℎ</ci><apply id="S3.E3.m1.3.3.3.3.3.3.1.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.3"><csymbol cd="latexml" id="S3.E3.m1.3.3.3.3.3.3.1.2.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.3.3.3.3.3.3.1.1.cmml" type="integer" xref="S3.E3.m1.3.3.3.3.3.3.1.1">1</cn></apply></apply><cn id="S3.E3.m1.4.4.4.4.4.4.1.cmml" type="integer" xref="S3.E3.m1.4.4.4.4.4.4.1">1</cn></apply><apply id="S3.E3.m1.72.72.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.72.72.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.6.6.6.6.6.6.cmml" xref="S3.E3.m1.6.6.6.6.6.6">ℎ</ci><apply id="S3.E3.m1.7.7.7.7.7.7.1.2.cmml" xref="S3.E3.m1.7.7.7.7.7.7.1.3"><csymbol cd="latexml" id="S3.E3.m1.7.7.7.7.7.7.1.2.1.cmml" xref="S3.E3.m1.7.7.7.7.7.7.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.7.7.7.7.7.7.1.1.cmml" type="integer" xref="S3.E3.m1.7.7.7.7.7.7.1.1">1</cn></apply></apply><cn id="S3.E3.m1.8.8.8.8.8.8.1.cmml" type="integer" xref="S3.E3.m1.8.8.8.8.8.8.1">2</cn></apply><ci id="S3.E3.m1.10.10.10.10.10.10.cmml" xref="S3.E3.m1.10.10.10.10.10.10">…</ci><apply id="S3.E3.m1.72.72.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.72.72.1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.3.3.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.12.12.12.12.12.12.cmml" xref="S3.E3.m1.12.12.12.12.12.12">ℎ</ci><apply id="S3.E3.m1.13.13.13.13.13.13.1.2.cmml" xref="S3.E3.m1.13.13.13.13.13.13.1.3"><csymbol cd="latexml" id="S3.E3.m1.13.13.13.13.13.13.1.2.1.cmml" xref="S3.E3.m1.13.13.13.13.13.13.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.13.13.13.13.13.13.1.1.cmml" type="integer" xref="S3.E3.m1.13.13.13.13.13.13.1.1">1</cn></apply></apply><ci id="S3.E3.m1.14.14.14.14.14.14.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1">𝑁</ci></apply></list><apply id="S3.E3.m1.72.72.1.1.1.8.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><times id="S3.E3.m1.72.72.1.1.1.8.6.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.72.72.1.1.1.8.7.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.8.7.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.17.17.17.17.2.2.cmml" xref="S3.E3.m1.17.17.17.17.2.2">𝑓</ci><ci id="S3.E3.m1.18.18.18.18.3.3.1.cmml" xref="S3.E3.m1.18.18.18.18.3.3.1">𝑞</ci></apply><interval closure="open" id="S3.E3.m1.72.72.1.1.1.5.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><list id="S3.E3.m1.72.72.1.1.1.4.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><apply id="S3.E3.m1.72.72.1.1.1.4.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.21.21.21.21.6.6.cmml" xref="S3.E3.m1.21.21.21.21.6.6">𝑞</ci><cn id="S3.E3.m1.22.22.22.22.7.7.1.cmml" type="integer" xref="S3.E3.m1.22.22.22.22.7.7.1">1</cn></apply><apply id="S3.E3.m1.72.72.1.1.1.4.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.4.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.24.24.24.24.9.9.cmml" xref="S3.E3.m1.24.24.24.24.9.9">𝑞</ci><cn id="S3.E3.m1.25.25.25.25.10.10.1.cmml" type="integer" xref="S3.E3.m1.25.25.25.25.10.10.1">2</cn></apply><ci id="S3.E3.m1.27.27.27.27.12.12.cmml" xref="S3.E3.m1.27.27.27.27.12.12">…</ci><apply id="S3.E3.m1.72.72.1.1.1.4.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.4.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.29.29.29.29.14.14.cmml" xref="S3.E3.m1.29.29.29.29.14.14">𝑞</ci><ci id="S3.E3.m1.30.30.30.30.15.15.1.cmml" xref="S3.E3.m1.30.30.30.30.15.15.1">𝑁</ci></apply></list><apply id="S3.E3.m1.72.72.1.1.1.5.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.5.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.33.33.33.33.18.18.cmml" xref="S3.E3.m1.33.33.33.33.18.18">𝑒</ci><apply id="S3.E3.m1.34.34.34.34.19.19.1.2.cmml" xref="S3.E3.m1.34.34.34.34.19.19.1.3"><csymbol cd="latexml" id="S3.E3.m1.34.34.34.34.19.19.1.2.1.cmml" xref="S3.E3.m1.34.34.34.34.19.19.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.34.34.34.34.19.19.1.1.cmml" type="integer" xref="S3.E3.m1.34.34.34.34.19.19.1.1">1</cn></apply></apply></interval><list id="S3.E3.m1.72.72.1.1.1.8.5.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><apply id="S3.E3.m1.72.72.1.1.1.6.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.6.3.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.72.72.1.1.1.6.3.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.6.3.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.37.37.37.2.2.2.cmml" xref="S3.E3.m1.37.37.37.2.2.2">ℎ</ci><apply id="S3.E3.m1.38.38.38.3.3.3.1.2.cmml" xref="S3.E3.m1.38.38.38.3.3.3.1.3"><csymbol cd="latexml" id="S3.E3.m1.38.38.38.3.3.3.1.2.1.cmml" xref="S3.E3.m1.38.38.38.3.3.3.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.38.38.38.3.3.3.1.1.cmml" type="integer" xref="S3.E3.m1.38.38.38.3.3.3.1.1">2</cn></apply></apply><cn id="S3.E3.m1.39.39.39.4.4.4.1.cmml" type="integer" xref="S3.E3.m1.39.39.39.4.4.4.1">1</cn></apply><apply id="S3.E3.m1.72.72.1.1.1.7.4.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.7.4.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.72.72.1.1.1.7.4.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.7.4.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.41.41.41.6.6.6.cmml" xref="S3.E3.m1.41.41.41.6.6.6">ℎ</ci><apply id="S3.E3.m1.42.42.42.7.7.7.1.2.cmml" xref="S3.E3.m1.42.42.42.7.7.7.1.3"><csymbol cd="latexml" id="S3.E3.m1.42.42.42.7.7.7.1.2.1.cmml" xref="S3.E3.m1.42.42.42.7.7.7.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.42.42.42.7.7.7.1.1.cmml" type="integer" xref="S3.E3.m1.42.42.42.7.7.7.1.1">2</cn></apply></apply><cn id="S3.E3.m1.43.43.43.8.8.8.1.cmml" type="integer" xref="S3.E3.m1.43.43.43.8.8.8.1">2</cn></apply><ci id="S3.E3.m1.45.45.45.10.10.10.cmml" xref="S3.E3.m1.45.45.45.10.10.10">…</ci><apply id="S3.E3.m1.72.72.1.1.1.8.5.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.8.5.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.72.72.1.1.1.8.5.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.8.5.3.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.47.47.47.12.12.12.cmml" xref="S3.E3.m1.47.47.47.12.12.12">ℎ</ci><apply id="S3.E3.m1.48.48.48.13.13.13.1.2.cmml" xref="S3.E3.m1.48.48.48.13.13.13.1.3"><csymbol cd="latexml" id="S3.E3.m1.48.48.48.13.13.13.1.2.1.cmml" xref="S3.E3.m1.48.48.48.13.13.13.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.48.48.48.13.13.13.1.1.cmml" type="integer" xref="S3.E3.m1.48.48.48.13.13.13.1.1">2</cn></apply></apply><ci id="S3.E3.m1.49.49.49.14.14.14.1.cmml" xref="S3.E3.m1.49.49.49.14.14.14.1">𝑁</ci></apply></list></apply></apply><apply id="S3.E3.m1.72.72.1.1.1c.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><eq id="S3.E3.m1.51.51.51.16.1.1.cmml" xref="S3.E3.m1.51.51.51.16.1.1"></eq><share href="https://arxiv.org/html/2406.02844v1#S3.E3.m1.72.72.1.1.1.8.cmml" id="S3.E3.m1.72.72.1.1.1d.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></share><apply id="S3.E3.m1.72.72.1.1.1.10.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><times id="S3.E3.m1.72.72.1.1.1.10.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.72.72.1.1.1.10.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.10.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.52.52.52.17.2.2.cmml" xref="S3.E3.m1.52.52.52.17.2.2">𝑓</ci><ci id="S3.E3.m1.53.53.53.18.3.3.1.cmml" xref="S3.E3.m1.53.53.53.18.3.3.1">𝑞</ci></apply><interval closure="open" id="S3.E3.m1.72.72.1.1.1.10.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><list id="S3.E3.m1.72.72.1.1.1.9.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><apply id="S3.E3.m1.72.72.1.1.1.9.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.9.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.56.56.56.21.6.6.cmml" xref="S3.E3.m1.56.56.56.21.6.6">𝑞</ci><cn id="S3.E3.m1.57.57.57.22.7.7.1.cmml" type="integer" xref="S3.E3.m1.57.57.57.22.7.7.1">1</cn></apply><apply id="S3.E3.m1.72.72.1.1.1.9.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.9.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.59.59.59.24.9.9.cmml" xref="S3.E3.m1.59.59.59.24.9.9">𝑞</ci><cn id="S3.E3.m1.60.60.60.25.10.10.1.cmml" type="integer" xref="S3.E3.m1.60.60.60.25.10.10.1">2</cn></apply><ci id="S3.E3.m1.62.62.62.27.12.12.cmml" xref="S3.E3.m1.62.62.62.27.12.12">…</ci><apply id="S3.E3.m1.72.72.1.1.1.9.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.9.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.64.64.64.29.14.14.cmml" xref="S3.E3.m1.64.64.64.29.14.14">𝑞</ci><ci id="S3.E3.m1.65.65.65.30.15.15.1.cmml" xref="S3.E3.m1.65.65.65.30.15.15.1">𝑁</ci></apply></list><apply id="S3.E3.m1.72.72.1.1.1.10.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.72.72.1.1.1.10.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.68.68.68.33.18.18.cmml" xref="S3.E3.m1.68.68.68.33.18.18">𝑒</ci><apply id="S3.E3.m1.69.69.69.34.19.19.1.2.cmml" xref="S3.E3.m1.69.69.69.34.19.19.1.3"><csymbol cd="latexml" id="S3.E3.m1.69.69.69.34.19.19.1.2.1.cmml" xref="S3.E3.m1.69.69.69.34.19.19.1.3.1">delimited-[]</csymbol><cn id="S3.E3.m1.69.69.69.34.19.19.1.1.cmml" type="integer" xref="S3.E3.m1.69.69.69.34.19.19.1.1">2</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.81c">\begin{split}[h^{[1]}_{1},h^{[1]}_{2},...,h^{[1]}_{N}]&amp;=f_{q}([q_{1},q_{2},...%
,q_{N}],e^{[1]})\\
[h^{[2]}_{1},h^{[2]}_{2},...,h^{[2]}_{N}]&amp;=f_{q}([q_{1},q_{2},...,q_{N}],e^{[2%
]}),\\
\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.81d">start_ROW start_CELL [ italic_h start_POSTSUPERSCRIPT [ 1 ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT [ 1 ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h start_POSTSUPERSCRIPT [ 1 ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] end_CELL start_CELL = italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( [ italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_q start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] , italic_e start_POSTSUPERSCRIPT [ 1 ] end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL [ italic_h start_POSTSUPERSCRIPT [ 2 ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT [ 2 ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h start_POSTSUPERSCRIPT [ 2 ] end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] end_CELL start_CELL = italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( [ italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_q start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] , italic_e start_POSTSUPERSCRIPT [ 2 ] end_POSTSUPERSCRIPT ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.13">where <math alttext="e^{[1]}" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m1.1"><semantics id="S3.SS2.p1.12.m1.1a"><msup id="S3.SS2.p1.12.m1.1.2" xref="S3.SS2.p1.12.m1.1.2.cmml"><mi id="S3.SS2.p1.12.m1.1.2.2" xref="S3.SS2.p1.12.m1.1.2.2.cmml">e</mi><mrow id="S3.SS2.p1.12.m1.1.1.1.3" xref="S3.SS2.p1.12.m1.1.1.1.2.cmml"><mo id="S3.SS2.p1.12.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p1.12.m1.1.1.1.2.1.cmml">[</mo><mn id="S3.SS2.p1.12.m1.1.1.1.1" xref="S3.SS2.p1.12.m1.1.1.1.1.cmml">1</mn><mo id="S3.SS2.p1.12.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p1.12.m1.1.1.1.2.1.cmml">]</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m1.1b"><apply id="S3.SS2.p1.12.m1.1.2.cmml" xref="S3.SS2.p1.12.m1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m1.1.2.1.cmml" xref="S3.SS2.p1.12.m1.1.2">superscript</csymbol><ci id="S3.SS2.p1.12.m1.1.2.2.cmml" xref="S3.SS2.p1.12.m1.1.2.2">𝑒</ci><apply id="S3.SS2.p1.12.m1.1.1.1.2.cmml" xref="S3.SS2.p1.12.m1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.12.m1.1.1.1.2.1.cmml" xref="S3.SS2.p1.12.m1.1.1.1.3.1">delimited-[]</csymbol><cn id="S3.SS2.p1.12.m1.1.1.1.1.cmml" type="integer" xref="S3.SS2.p1.12.m1.1.1.1.1">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m1.1c">e^{[1]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m1.1d">italic_e start_POSTSUPERSCRIPT [ 1 ] end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="e^{[2]}" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m2.1"><semantics id="S3.SS2.p1.13.m2.1a"><msup id="S3.SS2.p1.13.m2.1.2" xref="S3.SS2.p1.13.m2.1.2.cmml"><mi id="S3.SS2.p1.13.m2.1.2.2" xref="S3.SS2.p1.13.m2.1.2.2.cmml">e</mi><mrow id="S3.SS2.p1.13.m2.1.1.1.3" xref="S3.SS2.p1.13.m2.1.1.1.2.cmml"><mo id="S3.SS2.p1.13.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.p1.13.m2.1.1.1.2.1.cmml">[</mo><mn id="S3.SS2.p1.13.m2.1.1.1.1" xref="S3.SS2.p1.13.m2.1.1.1.1.cmml">2</mn><mo id="S3.SS2.p1.13.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.p1.13.m2.1.1.1.2.1.cmml">]</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m2.1b"><apply id="S3.SS2.p1.13.m2.1.2.cmml" xref="S3.SS2.p1.13.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m2.1.2.1.cmml" xref="S3.SS2.p1.13.m2.1.2">superscript</csymbol><ci id="S3.SS2.p1.13.m2.1.2.2.cmml" xref="S3.SS2.p1.13.m2.1.2.2">𝑒</ci><apply id="S3.SS2.p1.13.m2.1.1.1.2.cmml" xref="S3.SS2.p1.13.m2.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.13.m2.1.1.1.2.1.cmml" xref="S3.SS2.p1.13.m2.1.1.1.3.1">delimited-[]</csymbol><cn id="S3.SS2.p1.13.m2.1.1.1.1.cmml" type="integer" xref="S3.SS2.p1.13.m2.1.1.1.1">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m2.1c">e^{[2]}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m2.1d">italic_e start_POSTSUPERSCRIPT [ 2 ] end_POSTSUPERSCRIPT</annotation></semantics></math> are embeddings for item1 and item2, respectively. Note that we use a single set of learnable queries for all items. We select the pair of closest query representations as the representations for the two items:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}k,l={\rm argmax}_{i,j}\;\;&amp;{\rm cosine\_similarity}(h_{i},h_{j})%
\\
h_{\rm item1}&amp;=h_{k};\;\;h_{\rm item2}=h_{l}\end{split}" class="ltx_Math" display="block" id="S3.E4.m1.33"><semantics id="S3.E4.m1.33a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E4.m1.33.33.6" rowspacing="0pt"><mtr id="S3.E4.m1.33.33.6a"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.33.33.6b"><mrow id="S3.E4.m1.6.6.6.6.6"><mrow id="S3.E4.m1.6.6.6.6.6.7"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">k</mi><mo id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.29.29.2.3.cmml">,</mo><mi id="S3.E4.m1.3.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.3.cmml">l</mi></mrow><mo id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4.cmml">=</mo><msub id="S3.E4.m1.6.6.6.6.6.8"><mi id="S3.E4.m1.5.5.5.5.5.5" xref="S3.E4.m1.5.5.5.5.5.5.cmml">argmax</mi><mrow id="S3.E4.m1.6.6.6.6.6.6.1.4" xref="S3.E4.m1.6.6.6.6.6.6.1.3.cmml"><mi id="S3.E4.m1.6.6.6.6.6.6.1.1" xref="S3.E4.m1.6.6.6.6.6.6.1.1.cmml">i</mi><mo id="S3.E4.m1.6.6.6.6.6.6.1.4.1" xref="S3.E4.m1.6.6.6.6.6.6.1.3.cmml">,</mo><mi id="S3.E4.m1.6.6.6.6.6.6.1.2" xref="S3.E4.m1.6.6.6.6.6.6.1.2.cmml">j</mi></mrow></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.33.33.6c"><mrow id="S3.E4.m1.31.31.4.29.18.12"><mi id="S3.E4.m1.7.7.7.7.1.1" xref="S3.E4.m1.7.7.7.7.1.1.cmml">cosine</mi><mo id="S3.E4.m1.31.31.4.29.18.12.13" xref="S3.E4.m1.29.29.2.3.cmml">⁢</mo><mi id="S3.E4.m1.8.8.8.8.2.2" mathvariant="normal" xref="S3.E4.m1.8.8.8.8.2.2.cmml">_</mi><mo id="S3.E4.m1.31.31.4.29.18.12.13a" xref="S3.E4.m1.29.29.2.3.cmml">⁢</mo><mi id="S3.E4.m1.9.9.9.9.3.3" xref="S3.E4.m1.9.9.9.9.3.3.cmml">similarity</mi><mo id="S3.E4.m1.31.31.4.29.18.12.13b" xref="S3.E4.m1.29.29.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.31.31.4.29.18.12.12.2"><mo id="S3.E4.m1.10.10.10.10.4.4" stretchy="false" xref="S3.E4.m1.29.29.2.3.cmml">(</mo><msub id="S3.E4.m1.30.30.3.28.17.11.11.1.1"><mi id="S3.E4.m1.11.11.11.11.5.5" xref="S3.E4.m1.11.11.11.11.5.5.cmml">h</mi><mi id="S3.E4.m1.12.12.12.12.6.6.1" xref="S3.E4.m1.12.12.12.12.6.6.1.cmml">i</mi></msub><mo id="S3.E4.m1.13.13.13.13.7.7" xref="S3.E4.m1.29.29.2.3.cmml">,</mo><msub id="S3.E4.m1.31.31.4.29.18.12.12.2.2"><mi id="S3.E4.m1.14.14.14.14.8.8" xref="S3.E4.m1.14.14.14.14.8.8.cmml">h</mi><mi id="S3.E4.m1.15.15.15.15.9.9.1" xref="S3.E4.m1.15.15.15.15.9.9.1.cmml">j</mi></msub><mo id="S3.E4.m1.16.16.16.16.10.10" stretchy="false" xref="S3.E4.m1.29.29.2.3.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S3.E4.m1.33.33.6d"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.33.33.6e"><msub id="S3.E4.m1.18.18.18.2.2"><mi id="S3.E4.m1.17.17.17.1.1.1" xref="S3.E4.m1.17.17.17.1.1.1.cmml">h</mi><mi id="S3.E4.m1.18.18.18.2.2.2.1" xref="S3.E4.m1.18.18.18.2.2.2.1.cmml">item1</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.33.33.6f"><mrow id="S3.E4.m1.33.33.6.31.13.11.11"><mrow id="S3.E4.m1.32.32.5.30.12.10.10.1"><mi id="S3.E4.m1.32.32.5.30.12.10.10.1.1" xref="S3.E4.m1.29.29.2.3.cmml"></mi><mo id="S3.E4.m1.19.19.19.3.1.1" xref="S3.E4.m1.19.19.19.3.1.1.cmml">=</mo><msub id="S3.E4.m1.32.32.5.30.12.10.10.1.2"><mi id="S3.E4.m1.20.20.20.4.2.2" xref="S3.E4.m1.20.20.20.4.2.2.cmml">h</mi><mi id="S3.E4.m1.21.21.21.5.3.3.1" xref="S3.E4.m1.21.21.21.5.3.3.1.cmml">k</mi></msub></mrow><mo id="S3.E4.m1.22.22.22.6.4.4" rspace="0.727em" xref="S3.E4.m1.29.29.2.3.cmml">;</mo><mrow id="S3.E4.m1.33.33.6.31.13.11.11.2"><msub id="S3.E4.m1.33.33.6.31.13.11.11.2.1"><mi id="S3.E4.m1.23.23.23.7.5.5" xref="S3.E4.m1.23.23.23.7.5.5.cmml">h</mi><mi id="S3.E4.m1.24.24.24.8.6.6.1" xref="S3.E4.m1.24.24.24.8.6.6.1.cmml">item2</mi></msub><mo id="S3.E4.m1.25.25.25.9.7.7" xref="S3.E4.m1.25.25.25.9.7.7.cmml">=</mo><msub id="S3.E4.m1.33.33.6.31.13.11.11.2.2"><mi id="S3.E4.m1.26.26.26.10.8.8" xref="S3.E4.m1.26.26.26.10.8.8.cmml">h</mi><mi id="S3.E4.m1.27.27.27.11.9.9.1" xref="S3.E4.m1.27.27.27.11.9.9.1.cmml">l</mi></msub></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.33b"><apply id="S3.E4.m1.29.29.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.2.3a.cmml" xref="S3.E4.m1.2.2.2.2.2.2">formulae-sequence</csymbol><apply id="S3.E4.m1.28.28.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><and id="S3.E4.m1.28.28.1.1.1a.cmml" xref="S3.E4.m1.2.2.2.2.2.2"></and><apply id="S3.E4.m1.28.28.1.1.1b.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><eq id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4"></eq><list id="S3.E4.m1.28.28.1.1.1.4.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑘</ci><ci id="S3.E4.m1.3.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3.3">𝑙</ci></list><apply id="S3.E4.m1.28.28.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><times id="S3.E4.m1.28.28.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2"></times><apply id="S3.E4.m1.28.28.1.1.1.2.4.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.28.28.1.1.1.2.4.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.5.5.5.5.5.5.cmml" xref="S3.E4.m1.5.5.5.5.5.5">argmax</ci><list id="S3.E4.m1.6.6.6.6.6.6.1.3.cmml" xref="S3.E4.m1.6.6.6.6.6.6.1.4"><ci id="S3.E4.m1.6.6.6.6.6.6.1.1.cmml" xref="S3.E4.m1.6.6.6.6.6.6.1.1">𝑖</ci><ci id="S3.E4.m1.6.6.6.6.6.6.1.2.cmml" xref="S3.E4.m1.6.6.6.6.6.6.1.2">𝑗</ci></list></apply><ci id="S3.E4.m1.7.7.7.7.1.1.cmml" xref="S3.E4.m1.7.7.7.7.1.1">cosine</ci><ci id="S3.E4.m1.8.8.8.8.2.2.cmml" xref="S3.E4.m1.8.8.8.8.2.2">_</ci><ci id="S3.E4.m1.9.9.9.9.3.3.cmml" xref="S3.E4.m1.9.9.9.9.3.3">similarity</ci><interval closure="open" id="S3.E4.m1.28.28.1.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><apply id="S3.E4.m1.28.28.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.28.28.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.11.11.11.11.5.5.cmml" xref="S3.E4.m1.11.11.11.11.5.5">ℎ</ci><ci id="S3.E4.m1.12.12.12.12.6.6.1.cmml" xref="S3.E4.m1.12.12.12.12.6.6.1">𝑖</ci></apply><apply id="S3.E4.m1.28.28.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.28.28.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.14.14.14.14.8.8.cmml" xref="S3.E4.m1.14.14.14.14.8.8">ℎ</ci><ci id="S3.E4.m1.15.15.15.15.9.9.1.cmml" xref="S3.E4.m1.15.15.15.15.9.9.1">𝑗</ci></apply></interval><apply id="S3.E4.m1.28.28.1.1.1.2.8.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.28.28.1.1.1.2.8.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.17.17.17.1.1.1.cmml" xref="S3.E4.m1.17.17.17.1.1.1">ℎ</ci><ci id="S3.E4.m1.18.18.18.2.2.2.1.cmml" xref="S3.E4.m1.18.18.18.2.2.2.1">item1</ci></apply></apply></apply><apply id="S3.E4.m1.28.28.1.1.1c.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><eq id="S3.E4.m1.19.19.19.3.1.1.cmml" xref="S3.E4.m1.19.19.19.3.1.1"></eq><share href="https://arxiv.org/html/2406.02844v1#S3.E4.m1.28.28.1.1.1.2.cmml" id="S3.E4.m1.28.28.1.1.1d.cmml" xref="S3.E4.m1.2.2.2.2.2.2"></share><apply id="S3.E4.m1.28.28.1.1.1.7.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.28.28.1.1.1.7.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.20.20.20.4.2.2.cmml" xref="S3.E4.m1.20.20.20.4.2.2">ℎ</ci><ci id="S3.E4.m1.21.21.21.5.3.3.1.cmml" xref="S3.E4.m1.21.21.21.5.3.3.1">𝑘</ci></apply></apply></apply><apply id="S3.E4.m1.29.29.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><eq id="S3.E4.m1.25.25.25.9.7.7.cmml" xref="S3.E4.m1.25.25.25.9.7.7"></eq><apply id="S3.E4.m1.29.29.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.23.23.23.7.5.5.cmml" xref="S3.E4.m1.23.23.23.7.5.5">ℎ</ci><ci id="S3.E4.m1.24.24.24.8.6.6.1.cmml" xref="S3.E4.m1.24.24.24.8.6.6.1">item2</ci></apply><apply id="S3.E4.m1.29.29.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.29.29.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.26.26.26.10.8.8.cmml" xref="S3.E4.m1.26.26.26.10.8.8">ℎ</ci><ci id="S3.E4.m1.27.27.27.11.9.9.1.cmml" xref="S3.E4.m1.27.27.27.11.9.9.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.33c">\begin{split}k,l={\rm argmax}_{i,j}\;\;&amp;{\rm cosine\_similarity}(h_{i},h_{j})%
\\
h_{\rm item1}&amp;=h_{k};\;\;h_{\rm item2}=h_{l}\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.33d">start_ROW start_CELL italic_k , italic_l = roman_argmax start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_CELL start_CELL roman_cosine _ roman_similarity ( italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL italic_h start_POSTSUBSCRIPT item1 end_POSTSUBSCRIPT end_CELL start_CELL = italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ; italic_h start_POSTSUBSCRIPT item2 end_POSTSUBSCRIPT = italic_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.15">Then we compute the contrastive loss between <math alttext="h_{\rm item1}" class="ltx_Math" display="inline" id="S3.SS2.p1.14.m1.1"><semantics id="S3.SS2.p1.14.m1.1a"><msub id="S3.SS2.p1.14.m1.1.1" xref="S3.SS2.p1.14.m1.1.1.cmml"><mi id="S3.SS2.p1.14.m1.1.1.2" xref="S3.SS2.p1.14.m1.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.14.m1.1.1.3" xref="S3.SS2.p1.14.m1.1.1.3.cmml">item1</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m1.1b"><apply id="S3.SS2.p1.14.m1.1.1.cmml" xref="S3.SS2.p1.14.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m1.1.1.1.cmml" xref="S3.SS2.p1.14.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.14.m1.1.1.2.cmml" xref="S3.SS2.p1.14.m1.1.1.2">ℎ</ci><ci id="S3.SS2.p1.14.m1.1.1.3.cmml" xref="S3.SS2.p1.14.m1.1.1.3">item1</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m1.1c">h_{\rm item1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.14.m1.1d">italic_h start_POSTSUBSCRIPT item1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h_{\rm item2}" class="ltx_Math" display="inline" id="S3.SS2.p1.15.m2.1"><semantics id="S3.SS2.p1.15.m2.1a"><msub id="S3.SS2.p1.15.m2.1.1" xref="S3.SS2.p1.15.m2.1.1.cmml"><mi id="S3.SS2.p1.15.m2.1.1.2" xref="S3.SS2.p1.15.m2.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.15.m2.1.1.3" xref="S3.SS2.p1.15.m2.1.1.3.cmml">item2</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m2.1b"><apply id="S3.SS2.p1.15.m2.1.1.cmml" xref="S3.SS2.p1.15.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m2.1.1.1.cmml" xref="S3.SS2.p1.15.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.15.m2.1.1.2.cmml" xref="S3.SS2.p1.15.m2.1.1.2">ℎ</ci><ci id="S3.SS2.p1.15.m2.1.1.3.cmml" xref="S3.SS2.p1.15.m2.1.1.3">item2</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m2.1c">h_{\rm item2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.15.m2.1d">italic_h start_POSTSUBSCRIPT item2 end_POSTSUBSCRIPT</annotation></semantics></math> in the same way as item-text contrastive loss. Introducing the item-item contrastive loss can provide an additional benefit, namely that the Q-Former output is a better representation. This representation not only encodes item-text similarity knowledge but also encodes item-item similarity knowledge, so that for items without any text labels, it can encode certain text information indirectly, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.F2" title="Figure 2 ‣ Multimodal LLM ‣ 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(c). Due to the in-batch negative sampling of contrastive loss, we cannot mix item-text and item-item examples in the same batch. To address this, we train Q-Former on item-text and item-item batches in an alternating manner. More results on the effects of the item-item contrastive loss are shown in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5.SS1" title="5.1 Effects of Q-Former Phase 1 Training. ‣ 5 Ablation Study ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">5.1</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Item-Language Model Training</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In phase 2, we integrate the Q-Former item encoder with a pretrained LLM. The LLM can be pretrained for any purpose, which could be a general purpose human instruction followed LLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib15" title="">15</a>]</cite> or a LLM trained on recommender system data that supports generative retrieval of candidate items <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib48" title="">48</a>]</cite>. We present experimental results for the former in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS3" title="4.3 Results on ELM 24 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">4.3</span></a> and the latter in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS4" title="4.4 Results on OpenP5 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">4.4</span></a>. During training, we freeze the LLM parameters and only tune the parameters in the Q-Former encoder and the linear projection layer. The linear projection layer maps the Q-Former output dimension to the LLM input dimension as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S2.F2" title="Figure 2 ‣ Multimodal LLM ‣ 2 Related Work ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(d).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">A conversational recommendation can consist of multiple sub-tasks, including user preference elicitation, recommendation, explanation, and item information search <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib12" title="">12</a>]</cite>. To benchmark our proposed ILM approach on all these tasks, we select the Embedding Language Model (ELM) dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib49" title="">49</a>]</cite> and the OpenP5 benchmark. The ELM dataset contains 24 tasks which covers user preference elicitation, explanation, and item information search, etc. The OpenP5 dataset contains the sequential recommendation task and the straightforward recommendation task.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">ELM 24 Tasks</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">The ELM 24 tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib49" title="">49</a>]</cite> are created from the MovieLens 25M dataset, including single movie tasks, e.g. summarizing a movie, and movie pair tasks, e.g. comparing characteristics of movies. The training targets are generated by prompting the PaLM 2-L model with a movie’s title and task-specific information. For training inputs, the same task-specific prompts are used, but with the movie title replaced by the movie embedding. We use the behavioral embedding in the ELM dataset, which are trained on user ratings in the MovieLens 25M dataset with Matrix Factorization computed using Weighted Alternating Least Squares (WALS) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib24" title="">24</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">OpenP5</h4>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">OpenP5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib26" title="">26</a>]</cite> is a dataset for LLM-based Recommendation development, finetuning, and evaluation. It provides 10 popular preprocessed public datasets, and each dataset contains two kinds of tasks: Sequential Recommendation and Straightforward Recommendation. We select the MovieLens-1M, Beauty, and Clothing datasets with random indexing item representation for our benchmarks, which can be thought of as a simple generative-retrieval setup. The training target for each example is the ground truth item id. For training inputs, we append each item’s random indexing id with its behavioral embedding, which are computed using the iALS matrix factorization algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib44" title="">44</a>]</cite> on the user sequence training set. We use the provided train, development, and test split in the OpenP5 dataset, which uses the last item in the user sequence for testing and the second from the last item in the user sequence for development.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">For ELM 24 tasks, we report the log perplexity and Semantic Consistency (SC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib49" title="">49</a>]</cite> on the test set. For SC, we use the cosine similarity of semantic embeddings of the original and decode targets from the Sentence-T5 11B model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib37" title="">37</a>]</cite>. For OpenP5 tasks, we report top-k Hit Rate (HR@K) and Normalized Discounted Cumulative Gain (NDCG@K) with K = 5, 10 to evaluate the recommendation performance. To compute those metrics, we use beam search to generate 10 outputs for each example, and remove invalid outputs that do not match the regular expression "<span class="ltx_text ltx_font_typewriter" id="S4.SS2.p1.1.1">.*item_(\d+)$</span>".</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>SC metrics on the ELM 24 tasks using item behavioral embedding. We define SC as the semantic embedding cosine similarity between the decoded text and original text. We adopt the Sentence-T5 11B model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib37" title="">37</a>]</cite> for computing semantic embeddings.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T1.1.1.1.1.1">Tasks</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.1.1.1.2">MLP</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.1.1.1.3">ILM-rand</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.1.1.1.4">ILM</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.1">SC(%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.2">Log pplx</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.3">SC(%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.4">Log pplx</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.5">SC(%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.6">Log pplx</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.3.3.1">summary</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.2">71.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.3">0.6549</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.4">72.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.5">0.6257</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.6">73.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.7">0.6223</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.4.4.1">positive review</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.2">76.42</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.3">0.6114</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.4">77.84</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.5">0.5708</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.6">78.81</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.7">0.5669</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.5.5.1">neutral review</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.2">74.61</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.3">0.6167</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.4">75.98</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.5">0.5770</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.6">77.94</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.7">0.5690</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.6.6.1">five pos char.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.2">84.96</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.3">0.6778</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.4">85.74</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.5">0.5939</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.6">86.92</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.7">0.5850</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.7.7.1">five neg char.</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.2">90.77</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.3">0.4953</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.4">92.46</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.5">0.4009</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.6">92.24</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.7">0.3874</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.8.8.1">long description</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.2">71.09</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.3">0.6921</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.4">71.98</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.5">0.6629</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.6">73.39</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.7">0.6596</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.9.9.1">funnier</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.2">69.56</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.3">0.5744</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.4">68.79</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.5">0.5401</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.6">69.62</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.7">0.5378</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.10.10.1">sadder</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.2">70.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.3">0.5470</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.4">71.67</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.5">0.5163</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.6">72.31</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.7">0.5130</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.11.11.1">scarier</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.2">71.55</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.3">0.5578</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.4">72.07</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.5">0.5258</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.6">72.90</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.7">0.5230</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.12.12.1">improve</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.2">76.37</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.3">0.5607</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.4">77.11</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.5">0.5111</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.6">78.15</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.12.12.7">0.5073</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.13.13.1">movie to viewer</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.2">76.93</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.3">0.6801</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.4">79.33</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.5">0.6041</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.6">80.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.7">0.5920</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.14.14.1">pitch</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.2">78.95</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.3">0.5874</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.4">83.26</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.5">0.5165</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.6">84.28</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.14.14.7">0.5142</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.15.15.1">criticize</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.15.15.2">76.62</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.15.15.3">0.6073</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.15.15.4">78.13</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.15.15.5">0.5514</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.15.15.6">79.63</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.15.15.7">0.5423</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.16.16.1">convince1</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.16.16.2">77.16</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.16.16.3">0.6859</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.16.16.4">78.55</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.16.16.5">0.6196</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.16.16.6">79.48</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.16.16.7">0.6106</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.17.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.17.17.1">convince2</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.17.17.2">78.48</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.17.17.3">0.8748</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.17.17.4">78.98</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.17.17.5">0.7842</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.17.17.6">80.53</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.17.17.7">0.7688</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.18.18.1">convince3</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.18.18.2">78.02</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.18.18.3">0.9860</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.18.18.4">79.01</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.18.18.5">0.8955</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.18.18.6">80.33</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.18.18.7">0.8761</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.19.19.1">dissuade1</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.19.19.2">77.90</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.19.19.3">0.6998</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.19.19.4">79.00</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.19.19.5">0.6107</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.19.19.6">79.49</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.19.19.7">0.6002</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.20.20.1">dissuade2</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.20.20.2">80.97</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.20.20.3">0.8523</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.20.20.4">83.71</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.20.20.5">0.7296</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.20.20.6">84.15</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.20.20.7">0.7159</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.21.21.1">similarities</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.21.21.2">80.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.21.21.3">0.4993</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.21.21.4">83.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.21.21.5">0.4082</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.21.21.6">85.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.21.21.7">0.3828</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.22.22.1">interpolation</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.22.22.2">71.43</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.22.22.3">0.5627</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.22.22.4">72.59</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.22.22.5">0.5332</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.22.22.6">73.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.22.22.7">0.5263</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.23.23.1">why like nn</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.23.23.2">78.47</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.23.23.3">0.7494</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.23.23.4">79.59</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.23.23.5">0.6536</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.23.23.6">80.96</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.23.23.7">0.6343</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.24.24.1">diff than nn</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.24.24.2">86.56</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.24.24.3">0.6127</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.24.24.4">88.60</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.24.24.5">0.5238</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.24.24.6">89.30</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.24.24.7">0.4923</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.25.25.1">common with nn</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.25.25.2">80.76</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.25.25.3">0.7008</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.25.25.4">83.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.25.25.5">0.5466</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.25.25.6">84.62</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.25.25.7">0.5234</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.26.26.1">all</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.26.26.2">77.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.26.26.3">0.6520</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.26.26.4">78.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.26.26.5">0.5837</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.26.26.6">80.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.26.26.7">0.5730</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.27.27">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.27.27.1"></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.27.27.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.27.27.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.27.27.4">+1.91%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.27.27.5">-10.47%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.27.27.6">+3.27%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.27.27.7">-12.12%</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results on ELM 24 tasks</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We show the results of our ILM approach on ELM 24 tasks in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.T1" title="Table 1 ‣ 4.2 Evaluation Metrics ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. We adopt the CoLLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib59" title="">59</a>]</cite> approach as a baseline, where a two layer MLP with intermediate size 10 times the input embedding size is used to map the input behavioral embedding to LLM token embedding space. For ILM, we use a Q-Former encoder with 8 transformer layers. For phase 1 training, we pair the item with a concatenation of the prompt to generate the original target, i.e. title(s) and task specific information, and the original target as the item-text pair data. For the ELM 24 tasks benchmark, we only train the Q-Former using item-text data to avoid data leakage from item-item data. For all models, we use PaLM 2-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib19" title="">19</a>]</cite> as the LLM backbone. We train the models for 100k steps using a batch size 32 and learning rate <math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">5</mn><mo id="S4.SS3.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml"><mn id="S4.SS3.p1.1.m1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS3.p1.1.m1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml"><mo id="S4.SS3.p1.1.m1.1.1.3.3a" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS3.p1.1.m1.1.1.3.3.2" xref="S4.SS3.p1.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><times id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></times><cn id="S4.SS3.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.2">5</cn><apply id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS3.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3.2">10</cn><apply id="S4.SS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3"><minus id="S4.SS3.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3"></minus><cn id="S4.SS3.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> with a cosine decay. We also add an <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">ILM-rand</span> benchmark, which is an ILM model with a randomly initialized Q-Former encoder. As can be seen, our approach consistently outperforms the MLP baseline across all tasks. <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.2">ILM</span> also outperforms <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.3">ILM-rand</span> by a noticeable margin, which suggests the importance of the item-language representation learning phase. We report mean and standard error of our ILM results in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#A1.T6" title="Table 6 ‣ Appendix A Preserving Pretrained Ability ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Results on OpenP5 tasks</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In the OpenP5 dataset, each task contains 10 prompt templates used for training, and 1 prompt template used for unseen testing. In Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.SS4" title="4.4 Results on OpenP5 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">4.4</span></a>, we show seen and unseen test results on OpenP5 MovieLens-1M, Beauty, and Clothing tasks. For <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">ILM</span>, we use a Q-Former encoder with 8 transformer layers.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">For phase 1 training, we generate the item-text pair data by extracting item metadata from (1) movie title and genres from the original ML1M dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib20" title="">20</a>]</cite> for the ML1M task (2) product metadata including title, description, features, brand, etc. from the original Amazon Review 2014 Metadata <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib35" title="">35</a>]</cite> for Beauty and Clothing tasks. Since the inputs of OpenP5 tasks contain both user id and item id, we generate user-item pair data using the training set of OpenP5’s user sequence data, and conduct user-item contrastive learning to phase 1 training.</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">For phase 2 training, we use an 8 layer transformer model as the LLM backbone, and pretrain the backbone on the purely text format OpenP5 data using random item indexing to enable the model generative retrieval ability. We believe our ILM approach can be integrated with any other kind of item token id based encoding such as sequential indexing and collaborative indexing in the OpenP5 dataset as well as other more advanced semantic id based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib48" title="">48</a>]</cite>. Training hyperparameters can be found in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#A2" title="Appendix B Hyperparameters ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">B</span></a>. We show the statistics of phase 1 and phase 2 data in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.T2" title="Table 2 ‣ 4.4 Results on OpenP5 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1">We use the following baselines for the OpenP5 benchmark</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">OpenP5-R</span> stands for the OpenP5 random indexing method, i.e. using the backbone model directly without any embedding inputs.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">MLP</span> stands for using a two layer MLP with hidden size 10 times the input embedding size to map the input behavioral embedding to LLM token embedding space following CoLLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib59" title="">59</a>]</cite>. However, during the training, we do not finetune the LLM backbone in order to preserve the pretrained abilities.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS4.p4.2">We also add a <span class="ltx_text ltx_font_bold" id="S4.SS4.p4.2.1">ILM-rand</span> baseline, which is an ILM model with random initialized Q-Former encoder. For each dataset, we select the checkpoint with the best NDCG@10 metric on the development set. For all models, we use the same 8 layer transformer model as the LLM backbone. As can be seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.T3" title="Table 3 ‣ 4.4 Results on OpenP5 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, our method consistently outperforms other baselines across all datasets. <span class="ltx_text ltx_font_bold" id="S4.SS4.p4.2.2">ILM</span> also outperforms <span class="ltx_text ltx_font_bold" id="S4.SS4.p4.2.3">ILM-rand</span>, suggesting the importance of the item-language representation learning phase. We report mean and standard error of our ILM results in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#A1.T7" title="Table 7 ‣ Appendix A Preserving Pretrained Ability ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>OpenP5 phase 1 and phase 2 dataset statistics.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.1.1.1.1.1">Datasets</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.1.1.1.2">Phase 1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.1.1.1.3">Phase 2</th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1.4"></th>
<td class="ltx_td ltx_border_tt" id="S4.T2.1.1.1.5"></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.2.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.2.1">Item-text</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.2.2">Item-item</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.2.3">User-item</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.2.4">Train</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.2.5">Test</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S4.T2.1.2.2.6"># Users</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S4.T2.1.2.2.7"># Items</th>
</tr>
<tr class="ltx_tr" id="S4.T2.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.3.3.1">ML1M</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.3.3.2">3079</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.3.3.3">479664</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.3.3.4">888696</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.3.3.5">19629820</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.3.3.6">12080</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.3.3.7">6040</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.1.3.3.8">3416</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.4.4.1">Beauty</th>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.2">10879</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.3">103268</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.4">138521</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.5">2628260</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.6">44726</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.7">22363</td>
<td class="ltx_td ltx_align_right" id="S4.T2.1.4.4.8">12101</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.1.5.5.1">Clothing</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.1.5.5.2">20750</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.1.5.5.3">142427</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.1.5.5.4">180128</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.1.5.5.5">3210280</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.1.5.5.6">78774</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.1.5.5.7">39387</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.1.5.5.8">23033</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results on OpenP5 tasks using item behavioral embedding.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.1" style="width:433.6pt;height:112.6pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-131.6pt,34.0pt) scale(0.62222153713487,0.62222153713487) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.1.1.1.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T3.1.1.1.1.2">ML1M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T3.1.1.1.1.3">Beauty</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T3.1.1.1.1.4">Clothing</th>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.1">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.2">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.3">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.4">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.5">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.6">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.7">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.8">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.9">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.10">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.11">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.12">NDCG@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.1">OpenP5-R(seen)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.2">0.0688</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.3">0.0455</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.4">0.1033</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.5">0.0566</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.6">0.0208</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.7">0.0162</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.8">0.0254</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.9">0.0177</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.10">0.0015</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.11">0.0010</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.12">0.0030</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.13">0.0015</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.4.2">
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.1">MLP(seen)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.2">0.0692</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.3">0.0459</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.4">0.1041</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.5">0.0572</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.6">0.0199</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.7">0.0150</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.8">0.0255</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.9">0.0168</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.10">0.0015</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.11">0.0010</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.12">0.0022</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.13">0.0012</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.5.3">
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.1">ILM-rand(seen)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.2">0.0723</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.3">0.0478</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.3.4.1">0.1084</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.5">0.0594</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.6">0.0206</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.7">0.0154</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.8">0.0259</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.9">0.0171</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.10">0.0026</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.11">0.0017</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.12">0.0038</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.13">0.0021</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.6.4">
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.1">ILM(seen)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.2.1">0.0724</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.3.1">0.0485</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.4">0.1064</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.5.1">0.0595</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.6.1">0.0213</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.7"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.7.1">0.0164</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.8"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.8.1">0.0270</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.9"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.9.1">0.0182</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.10"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.10.1">0.0041</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.11"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.11.1">0.0025</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.12"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.12.1">0.0065</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.13"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.13.1">0.0033</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.7.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.1">OpenP5-R(unseen)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.2">0.0696</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.3">0.0449</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.4">0.1041</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.5">0.0560</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.6">0.0206</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.7">0.0161</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.8">0.0253</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.9">0.0176</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.10">0.0016</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.11">0.0010</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.12">0.0034</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7.5.13">0.0016</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.8.6">
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.1">MLP(unseen)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.2">0.0716</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.3">0.0470</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.4">0.1045</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.5">0.0576</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.6">0.0203</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.7">0.0151</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.8">0.0255</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.9">0.0168</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.10">0.0016</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.11">0.0011</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.12">0.0026</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.6.13">0.0014</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.9.7">
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.1">ILM-rand(unseen)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.2">0.0710</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.3">0.0477</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.4">0.1033</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.5">0.0581</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.6">0.0206</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.7">0.0157</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.8">0.0263</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.9">0.0175</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.10">0.0023</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.11">0.0015</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.12">0.0037</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.7.13">0.0019</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.10.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.1">ILM(unseen)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.2.1">0.0717</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.3.1">0.0481</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.4.1">0.1086</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.5.1">0.0600</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.6.1">0.0213</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.7"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.7.1">0.0162</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.8"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.8.1">0.0269</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.9"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.9.1">0.0181</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.10"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.10.1">0.0038</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.11"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.11.1">0.0024</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.12"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.12.1">0.0062</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.10.8.13"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.10.8.13.1">0.0032</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Ablation Study</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Effects of Q-Former Phase 1 Training.</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.T1" title="Table 1 ‣ 4.2 Evaluation Metrics ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.T3" title="Table 3 ‣ 4.4 Results on OpenP5 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, <span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">ILM</span> consistently outperforms <span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.2">ILM-rand</span> by a noticeable margin across all metrics on all benchmarks, which suggests the importance of the Q-Former phase 1 training. For the OpenP5 dataset, we experiment with different combinations of phase 1 training losses: (1) Only using item-text losses (<span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.3">ILM-IT</span>). (2) Combine item-text losses with an item-item contrastive loss (<span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.4">ILM-IT-II</span>). (3) Combine item-text losses with an user-item contrastive loss (<span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.5">ILM-IT-UI</span>). We generate item-item pair data for (2) as follows. For each user, we treat two consecutive items in the history sequence as a positive pair, then we perform deduplication to get all unique pairs as the item-item pair data. The number of pairs generated are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.T2" title="Table 2 ‣ 4.4 Results on OpenP5 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">The results for the above models are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5.T4" title="Table 4 ‣ 5.1 Effects of Q-Former Phase 1 Training. ‣ 5 Ablation Study ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. We observe that for ML1M dataset, introducing user-item or item-item contrastive losses can in general lead to performance gains, while for Beauty and Clothing there are no obvious gains. We hypothesize this is due to ML1M’s item-text pair data being much scarcer and user interactions are much richer than the other two datasets. As can be seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S4.T2" title="Table 2 ‣ 4.4 Results on OpenP5 tasks ‣ 4 Experiments ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, comparing with other datasets, the ML1M dataset contains much fewer users and items, but much more user-item interactions. This supports our hypothesis, and suggests exploring user-interaction signals in the phase 1 representation learning can be beneficial for datasets like ML1M. To demonstrate the regularization effects of the item-item and user-item contrastive losses, we showed the phase 1 final train and eval item-grounded text generation losses in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5.T5" title="Table 5 ‣ 5.1 Effects of Q-Former Phase 1 Training. ‣ 5 Ablation Study ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>. We can observe that adding item-item or user-item contrastive losses in phase 1 indeed can help to reduce the eval loss and close the train-eval gap.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Effects of phase 1 item-item and user-item contrastive losses on OpenP5 benchmarks.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T4.1" style="width:433.6pt;height:90pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-132.4pt,27.3pt) scale(0.620860470666599,0.620860470666599) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T4.1.1.1.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T4.1.1.1.1.2">ML1M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T4.1.1.1.1.3">Beauty</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T4.1.1.1.1.4">Clothing</th>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.1">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.2">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.3">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.4">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.5">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.6">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.7">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.8">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.9">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.10">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.11">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.2.2.12">NDCG@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.1">ILM-IT(seen)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.2">0.0719</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.3">0.0474</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.4">0.1088</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.5">0.0594</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.6">0.0212</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.7">0.0160</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.8">0.0262</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.9">0.0177</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.10"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.3.1.10.1">0.0044</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.11"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.3.1.11.1">0.0029</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.12">0.0061</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.3.1.13"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.3.1.13.1">0.0035</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.4.2">
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.1">ILM-IT-II(seen)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.2">0.0712</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.3">0.0479</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.4.2.4.1">0.1093</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.4.2.5.1">0.0602</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.6">0.0210</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.7">0.0160</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.8">0.0261</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.9">0.0177</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.10">0.0040</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.11">0.0027</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.12">0.0060</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.4.2.13">0.0033</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.5.3">
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.1">ILM-IT-UI(seen)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.5.3.2.1">0.0724</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.5.3.3.1">0.0485</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.4">0.1064</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.5">0.0595</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.5.3.6.1">0.0213</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.5.3.7.1">0.0164</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.5.3.8.1">0.0270</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.9"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.5.3.9.1">0.0182</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.10">0.0041</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.11">0.0025</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.12"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.5.3.12.1">0.0065</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.5.3.13">0.0033</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.6.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.1">ILM-IT(unseen)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.2">0.0700</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.3">0.0470</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.4">0.1071</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.5">0.0589</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.6.4.6.1">0.0218</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.7"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.6.4.7.1">0.0163</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.8"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.6.4.8.1">0.0275</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.9"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.6.4.9.1">0.0182</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.10"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.6.4.10.1">0.0039</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.11"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.6.4.11.1">0.0025</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.12">0.0056</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.1.6.4.13">0.0031</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.7.5">
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.1">ILM-IT-II(unseen)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.2">0.0701</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.3">0.0472</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.4">0.1078</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.5">0.0594</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.6">0.0216</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.7">0.0162</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.8">0.0269</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.9">0.0180</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.10">0.0037</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.11">0.0024</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.12">0.0054</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.1.7.5.13">0.0030</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.1.8.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.1">ILM-IT-UI(unseen)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.8.6.2.1">0.0717</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.8.6.3.1">0.0481</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.8.6.4.1">0.1086</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.8.6.5.1">0.0600</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.6">0.0213</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.7">0.0162</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.8">0.0269</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.9">0.0181</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.10">0.0038</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.11">0.0024</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.12"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.8.6.12.1">0.0062</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.1.8.6.13"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.8.6.13.1">0.0032</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Effects of phase 1 item-item and user-item contrastive losses on OpenP5 phase 1 final train and eval item-grounded text generation losses.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T5.1.1.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T5.1.1.1.2">ML1M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T5.1.1.1.3">Beauty</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T5.1.1.1.4">Clothing</th>
</tr>
<tr class="ltx_tr" id="S5.T5.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.2.2.1">Train</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.2.2.2">Eval</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.2.2.3">Train</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.2.2.4">Eval</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.2.2.5">Train</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.1.2.2.6">Eval</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.3.1.1">ILM-IT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.3.1.2">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.3.1.3">4.1699</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.3.1.4">1.0441</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.3.1.5">4.2643</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.3.1.6">0.2114</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.3.1.7">2.0530</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.4.2">
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.2.1">ILM-IT-II</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.2.2">0.1552</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.2.3">3.8675</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.2.4">2.0232</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.2.5">3.2567</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.2.6">0.4594</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.4.2.7">1.7338</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.5.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.5.3.1">ILM-IT-UI</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.5.3.2">0.0089</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.5.3.3">4.0663</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.5.3.4">2.3420</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.5.3.5">3.3724</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.5.3.6">0.5498</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.5.3.7">1.6358</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Effects of Number of Query Tokens</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Another key aspect of our ILM approach is we used multiple learned queries to generate multiple embeddings in Q-Former output as item representation to feed into LLM. Existing methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib59" title="">59</a>]</cite> typically use one embedding as the item-representation to feed into LLM. We show ILM results using different numbers of queries tokens in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#S5.F3" title="Figure 3 ‣ 5.2 Effects of Number of Query Tokens ‣ 5 Ablation Study ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. In order to better understand the gains of our approach, we also use the MLP approach to project the input embedding into a same number of embeddings. For both approaches, as the number of query tokens increases, the performance first increases then decreases. For most of the query lengths, our method outperforms the MLP approach.</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="254" id="S5.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Effects of Number of Query Tokens.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We propose ILM, a novel approach for incorporating collaborative filtering knowledge into a frozen LLM for conversational recommendation tasks. Specifically, we use a Q-Former item encoder to produce item-language aligned representations given item collaborative filtering embeddings, then interleave those representations with text token embeddings and feed into a frozen LLM. We propose a two-phase training paradigm. In Phase 1, we pretrain the Q-Former encoder using item-text representation learning objectives and a novel item-item representation learning objective. The item-item representation learning plays a regularization role to prevent the Q-Former from overfitting on item-text data if they are scarce. At the same time, it also directly encodes item-item similarity information in the Q-Former output representations. In Phase 2, we train ILM on conversational recommendation tasks by freezing LLM backbone parameters. This preserves the original pretrained LLM’s language abilities, and reduces the privacy risk when finetuning LLM on user behavioral data. We conduct extensive benchmarks across various conversational recommendation datasets and tasks.  We show the performance improvement due to item-item and user-item interaction data, demonstrating how this technique incorporates traditional CF signals. We demonstrate the value of this technique for both recommendation tasks and for language generation tasks for conversational recommendation. The results show that our model can achieve SOTA performance consistently comparing existing methods of integrating collaborative filtering knowledge into a frozen LLM.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
J.-B. Alayrac, J. Donahue, P. Luc, A. Miech, I. Barr, Y. Hasson, K. Lenc,
A. Mensch, K. Millican, M. Reynolds, R. Ring, E. Rutherford, S. Cabi, T. Han,
Z. Gong, S. Samangooei, M. Monteiro, J. L. Menick, S. Borgeaud, A. Brock,
A. Nematzadeh, S. Sharifzadeh, M. a. Bińkowski, R. Barreira, O. Vinyals,
A. Zisserman, and K. Simonyan.

</span>
<span class="ltx_bibblock">Flamingo: a visual language model for few-shot learning.

</span>
<span class="ltx_bibblock">In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh,
editors, <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Advances in Neural Information Processing Systems</span>, volume 35,
pages 23716–23736. Curran Associates, Inc., 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
J. Anderson, Q. Huang, W. Krichene, S. Rendle, and L. Zhang.

</span>
<span class="ltx_bibblock">Superbloom: Bloom filter meets transformer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
K. Bao, J. Zhang, Y. Zhang, W. Wang, F. Feng, and X. He.

</span>
<span class="ltx_bibblock">Tallrec: An effective and efficient tuning framework to align large
language model with recommendation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 17th ACM Conference on Recommender
Systems</span>, RecSys ’23. ACM, Sept. 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
N. Belkin, C. Cool, A. Stein, and U. Thiel.

</span>
<span class="ltx_bibblock">Cases, scripts, and information-seeking strategies: On the design of
interactive information retrieval systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Expert Systems With Applications</span>, 9(3):379–395, 1995.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal,
A. Neelakantan, P. Shyam, G. Sastry, A. Askell, S. Agarwal, A. Herbert-Voss,
G. Krueger, T. Henighan, R. Child, A. Ramesh, D. Ziegler, J. Wu, C. Winter,
C. Hesse, M. Chen, E. Sigler, M. Litwin, S. Gray, B. Chess, J. Clark,
C. Berner, S. McCandlish, A. Radford, I. Sutskever, and D. Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M. Balcan, and H. Lin,
editors, <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Advances in Neural Information Processing Systems</span>, volume 33,
pages 1877–1901. Curran Associates, Inc., 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
X. Chen, X. Wang, S. Changpinyo, A. Piergiovanni, P. Padlewski, D. Salz,
S. Goodman, A. Grycner, B. Mustafa, L. Beyer, A. Kolesnikov, J. Puigcerver,
N. Ding, K. Rong, H. Akbari, G. Mishra, L. Xue, A. Thapliyal, J. Bradbury,
W. Kuo, M. Seyedhosseini, C. Jia, B. K. Ayan, C. Riquelme, A. Steiner,
A. Angelova, X. Zhai, N. Houlsby, and R. Soricut.

</span>
<span class="ltx_bibblock">Pali: A jointly-scaled multilingual language-image model, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
A. Chowdhery, S. Narang, J. Devlin, et al.

</span>
<span class="ltx_bibblock">Palm: Scaling language modeling with pathways, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
W. B. Croft and R. H. Thompson.

</span>
<span class="ltx_bibblock">I3r: A new approach to the design of document retrieval systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">J. Am. Soc. Inf. Sci.</span>, 38:389–404, 1987.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
S. Dai, N. Shao, H. Zhao, W. Yu, Z. Si, C. Xu, Z. Sun, X. Zhang, and J. Xu.

</span>
<span class="ltx_bibblock">Uncovering chatgpt’s capabilities in recommender systems.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 17th ACM Conference on Recommender
Systems</span>, RecSys ’23, page 1126–1132, New York, NY, USA, 2023. Association
for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
D. Driess, F. Xia, M. S. M. Sajjadi, C. Lynch, A. Chowdhery, B. Ichter,
A. Wahid, J. Tompson, Q. Vuong, T. Yu, W. Huang, Y. Chebotar, P. Sermanet,
D. Duckworth, S. Levine, V. Vanhoucke, K. Hausman, M. Toussaint, K. Greff,
A. Zeng, I. Mordatch, and P. Florence.

</span>
<span class="ltx_bibblock">Palm-e: An embodied multimodal language model.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2303.03378</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
J. Fang, S. Gao, P. Ren, X. Chen, S. Verberne, and Z. Ren.

</span>
<span class="ltx_bibblock">A multi-agent conversational recommender system, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Y. Feng, S. Liu, Z. Xue, Q. Cai, L. Hu, P. Jiang, K. Gai, and F. Sun.

</span>
<span class="ltx_bibblock">A large language model enhanced conversational recommender system,
2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. Gao, T. Sheng, Y. Xiang, Y. Xiong, H. Wang, and J. Zhang.

</span>
<span class="ltx_bibblock">Chat-rec: Towards interactive and explainable llms-augmented
recommender system, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y. Gao, Y. Xiong, X. Gao, K. Jia, J. Pan, Y. Bi, Y. Dai, J. Sun, M. Wang, and
H. Wang.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for large language models: A survey,
2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
G. Gemini Team.

</span>
<span class="ltx_bibblock">Gemini 1.5: Unlocking multimodal understanding across millions of
tokens of context, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
G. Gemini Team.

</span>
<span class="ltx_bibblock">Gemini: A family of highly capable multimodal models, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Geng, S. Liu, Z. Fu, Y. Ge, and Y. Zhang.

</span>
<span class="ltx_bibblock">Recommendation as language processing (rlp): A unified pretrain,
personalized prompt &amp; predict paradigm (p5).

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 16th ACM Conference on Recommender
Systems</span>, RecSys ’22, page 299–315, New York, NY, USA, 2022. Association
for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. H. Göker and C. A. Thompson.

</span>
<span class="ltx_bibblock">The adaptive place advisor: A conversational recommendation system,
2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Google.

</span>
<span class="ltx_bibblock">Palm 2 technical report, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
F. M. Harper and J. A. Konstan.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">ACM Trans. Interact. Intell. Syst.</span>, 5(4), dec 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
R. He and J. McAuley.

</span>
<span class="ltx_bibblock">Ups and downs: Modeling the visual evolution of fashion trends with
one-class collaborative filtering.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 25th International Conference on World
Wide Web</span>, WWW ’16, page 507–517, Republic and Canton of Geneva, CHE, 2016.
International World Wide Web Conferences Steering Committee.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
T. Hosking, P. Blunsom, and M. Bartolo.

</span>
<span class="ltx_bibblock">Human feedback is not gold standard, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
E. J. Hu, Y. Shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and
W. Chen.

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">International Conference on Learning Representations</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Y. Hu, Y. Koren, and C. Volinsky.

</span>
<span class="ltx_bibblock">Collaborative filtering for implicit feedback datasets.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">2008 Eighth IEEE International Conference on Data Mining</span>,
pages 263–272, 2008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Z. Hu, Y. Zhang, M. Xiao, W. Wang, F. Feng, and X. He.

</span>
<span class="ltx_bibblock">Exact and efficient unlearning for large language model-based
recommendation, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
W. Hua, S. Xu, Y. Ge, and Y. Zhang.

</span>
<span class="ltx_bibblock">How to index item ids for recommendation foundation models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">SIGIR-AP</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
A. Jaegle, F. Gimeno, A. Brock, O. Vinyals, A. Zisserman, and J. Carreira.

</span>
<span class="ltx_bibblock">Perceiver: General perception with iterative attention.

</span>
<span class="ltx_bibblock">In M. Meila and T. Zhang, editors, <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 38th
International Conference on Machine Learning</span>, volume 139 of <span class="ltx_text ltx_font_italic" id="bib.bib27.2.2">Proceedings
of Machine Learning Research</span>, pages 4651–4664. PMLR, 18–24 Jul 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
W.-C. Kang, J. Ni, N. Mehta, M. Sathiamoorthy, L. Hong, E. Chi, and D. Z.
Cheng.

</span>
<span class="ltx_bibblock">Do llms understand user preferences? evaluating llms on user rating
prediction, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
J. Y. Koh, D. Fried, and R. Salakhutdinov.

</span>
<span class="ltx_bibblock">Generating images with multimodal language models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Y. Koren, R. Bell, and C. Volinsky.

</span>
<span class="ltx_bibblock">Matrix factorization techniques for recommender systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Computer</span>, 42(8):30–37, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
W. Kuo, A. Piergiovanni, D. Kim, X. Luo, B. Caine, W. Li, A. Ogale, L. Zhou,
A. Dai, Z. Chen, C. Cui, and A. Angelova.

</span>
<span class="ltx_bibblock">Mammut: A simple architecture for joint learning for multimodal
tasks, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
P. Lewis, E. Perez, A. Piktus, F. Petroni, V. Karpukhin, N. Goyal,
H. Küttler, M. Lewis, W.-t. Yih, T. Rocktäschel, S. Riedel, and
D. Kiela.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M. Balcan, and H. Lin,
editors, <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Advances in Neural Information Processing Systems</span>, volume 33,
pages 9459–9474. Curran Associates, Inc., 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
J. Li, D. Li, S. Savarese, and S. Hoi.

</span>
<span class="ltx_bibblock">Blip-2: bootstrapping language-image pre-training with frozen image
encoders and large language models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 40th International Conference on Machine
Learning</span>, ICML’23. JMLR.org, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Y. Liu, W. Zhang, Y. Chen, Y. Zhang, H. Bai, F. Feng, H. Cui, Y. Li, and
W. Che.

</span>
<span class="ltx_bibblock">Conversational recommender system and large language model are made
for each other in E-commerce pre-sales dialogue.

</span>
<span class="ltx_bibblock">In H. Bouamor, J. Pino, and K. Bali, editors, <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Findings of the
Association for Computational Linguistics: EMNLP 2023</span>, pages 9587–9605,
Singapore, Dec. 2023. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
J. McAuley, C. Targett, Q. Shi, and A. van den Hengel.

</span>
<span class="ltx_bibblock">Image-based recommendations on styles and substitutes.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">Proceedings of the 38th International ACM SIGIR Conference on
Research and Development in Information Retrieval</span>, SIGIR ’15, page 43–52,
New York, NY, USA, 2015. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
I. Mohanty.

</span>
<span class="ltx_bibblock">Recommendation systems in the era of llms.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 15th Annual Meeting of the Forum for
Information Retrieval Evaluation</span>, FIRE ’23, page 142–144, New York, NY,
USA, 2024. Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
J. Ni, G. Hernandez Abrego, N. Constant, J. Ma, K. Hall, D. Cer, and Y. Yang.

</span>
<span class="ltx_bibblock">Sentence-t5: Scalable sentence encoders from pre-trained text-to-text
models.

</span>
<span class="ltx_bibblock">In S. Muresan, P. Nakov, and A. Villavicencio, editors, <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">Findings
of the Association for Computational Linguistics: ACL 2022</span>, pages
1864–1874, Dublin, Ireland, May 2022. Association for Computational
Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
L. Ning, L. Liu, J. Wu, N. Wu, D. Berlowitz, S. Prakash, B. Green, S. O’Banion,
and J. Xie.

</span>
<span class="ltx_bibblock">User-llm: Efficient llm contextualization with user embeddings, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
J. S. Park, J. O’Brien, C. J. Cai, M. R. Morris, P. Liang, and M. S. Bernstein.

</span>
<span class="ltx_bibblock">Generative agents: Interactive simulacra of human behavior.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 36th Annual ACM Symposium on User
Interface Software and Technology</span>, UIST ’23, New York, NY, USA, 2023.
Association for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Y. Qin, S. Liang, Y. Ye, K. Zhu, L. Yan, Y. Lu, Y. Lin, X. Cong, X. Tang,
B. Qian, S. Zhao, L. Hong, R. Tian, R. Xie, J. Zhou, M. Gerstein, D. Li,
Z. Liu, and M. Sun.

</span>
<span class="ltx_bibblock">Toolllm: Facilitating large language models to master 16000+
real-world apis, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry,
A. Askell, P. Mishkin, J. Clark, G. Krueger, and I. Sutskever.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language
supervision.

</span>
<span class="ltx_bibblock">In M. Meila and T. Zhang, editors, <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Proceedings of the 38th
International Conference on Machine Learning</span>, volume 139 of <span class="ltx_text ltx_font_italic" id="bib.bib42.2.2">Proceedings
of Machine Learning Research</span>, pages 8748–8763. PMLR, 18–24 Jul 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
S. Rajput, N. Mehta, A. Singh, R. H. Keshavan, T. Vu, L. Heldt, L. Hong,
Y. Tay, V. Q. Tran, J. Samost, M. Kula, E. H. Chi, and M. Sathiamoorthy.

</span>
<span class="ltx_bibblock">Recommender systems with generative retrieval.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">Thirty-seventh Conference on Neural Information Processing
Systems</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
S. Rendle, W. Krichene, L. Zhang, and Y. Koren.

</span>
<span class="ltx_bibblock">Revisiting the performance of ials on item recommendation benchmarks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">Proceedings of the 16th ACM Conference on Recommender
Systems</span>, RecSys ’22, page 427–435, New York, NY, USA, 2022. Association
for Computing Machinery.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
T. Schick, J. Dwivedi-Yu, R. Dessi, R. Raileanu, M. Lomeli, E. Hambro,
L. Zettlemoyer, N. Cancedda, and T. Scialom.

</span>
<span class="ltx_bibblock">Toolformer: Language models can teach themselves to use tools.

</span>
<span class="ltx_bibblock">In A. Oh, T. Naumann, A. Globerson, K. Saenko, M. Hardt, and
S. Levine, editors, <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">Advances in Neural Information Processing Systems</span>,
volume 36, pages 68539–68551. Curran Associates, Inc., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
N. Shazeer and M. Stern.

</span>
<span class="ltx_bibblock">Adafactor: Adaptive learning rates with sublinear memory cost, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
A. Singh, T. Vu, R. Keshavan, N. Mehta, X. Yi, L. Hong, L. Heldt, L. Wei,
E. Chi, and M. Sathiamoorthy.

</span>
<span class="ltx_bibblock">Better generalization with semantic ids: A case study in ranking for
recommendations, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
W. Sun, L. Yan, Z. Chen, S. Wang, H. Zhu, P. Ren, Z. Chen, D. Yin, M. Rijke,
and Z. Ren.

</span>
<span class="ltx_bibblock">Learning to tokenize for generative retrieval.

</span>
<span class="ltx_bibblock">In A. Oh, T. Naumann, A. Globerson, K. Saenko, M. Hardt, and
S. Levine, editors, <span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">Advances in Neural Information Processing Systems</span>,
volume 36, pages 46345–46361. Curran Associates, Inc., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
G. Tennenholtz, Y. Chow, C. Hsu, J. Jeong, L. Shani, A. Tulepbergenov,
D. Ramachandran, M. Mladenov, and C. Boutilier.

</span>
<span class="ltx_bibblock">Demystifying embedding spaces using large language models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">The Twelfth International Conference on Learning
Representations</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
M. Tsimpoukelli, J. L. Menick, S. Cabi, S. M. A. Eslami, O. Vinyals, and
F. Hill.

</span>
<span class="ltx_bibblock">Multimodal few-shot learning with frozen language models.

</span>
<span class="ltx_bibblock">In M. Ranzato, A. Beygelzimer, Y. Dauphin, P. Liang, and J. W.
Vaughan, editors, <span class="ltx_text ltx_font_italic" id="bib.bib50.1.1">Advances in Neural Information Processing Systems</span>,
volume 34, pages 200–212. Curran Associates, Inc., 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
J. Wang, Y. Liang, F. Meng, Z. Sun, H. Shi, Z. Li, J. Xu, J. Qu, and J. Zhou.

</span>
<span class="ltx_bibblock">Is ChatGPT a good NLG evaluator? a preliminary study.

</span>
<span class="ltx_bibblock">In Y. Dong, W. Xiao, L. Wang, F. Liu, and G. Carenini, editors, <span class="ltx_text ltx_font_italic" id="bib.bib51.1.1">Proceedings of the 4th New Frontiers in Summarization Workshop</span>, pages 1–11,
Singapore, Dec. 2023. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
L. Wang, C. Ma, X. Feng, Z. Zhang, H. Yang, J. Zhang, Z. Chen, J. Tang,
X. Chen, Y. Lin, W. X. Zhao, Z. Wei, and J. Wen.

</span>
<span class="ltx_bibblock">A survey on large language model based autonomous agents.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib52.1.1">Front. Comput. Sci.</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
W. Wang, Q. Lv, W. Yu, W. Hong, J. Qi, Y. Wang, J. Ji, Z. Yang, L. Zhao,
X. Song, J. Xu, B. Xu, J. Li, Y. Dong, M. Ding, and J. Tang.

</span>
<span class="ltx_bibblock">Cogvlm: Visual expert for pretrained language models, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
L. Wu, Z. Zheng, Z. Qiu, H. Wang, H. Gu, T. Shen, C. Qin, C. Zhu, H. Zhu,
Q. Liu, H. Xiong, and E. Chen.

</span>
<span class="ltx_bibblock">A survey on large language models for recommendation, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
S. Xu, W. Hua, and Y. Zhang.

</span>
<span class="ltx_bibblock">Openp5: Benchmarking foundation models for recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">arXiv:2306.11134</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
J. Yu, Z. Wang, V. Vasudevan, L. Yeung, M. Seyedhosseini, and Y. Wu.

</span>
<span class="ltx_bibblock">Coca: Contrastive captioners are image-text foundation models, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
J. Yu, Y. Xu, J. Y. Koh, T. Luong, G. Baid, Z. Wang, V. Vasudevan, A. Ku,
Y. Yang, B. K. Ayan, B. Hutchinson, W. Han, Z. Parekh, X. Li, H. Zhang,
J. Baldridge, and Y. Wu.

</span>
<span class="ltx_bibblock">Scaling autoregressive models for content-rich text-to-image
generation, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Y. Zhang, H. Ding, Z. Shui, Y. Ma, J. Zou, A. Deoras, and H. Wang.

</span>
<span class="ltx_bibblock">Language models as recommender systems: Evaluations and limitations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib58.1.1">NeurIPS 2021 Workshop on I (Still) Can’t Believe It’s Not
Better</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Y. Zhang, F. Feng, J. Zhang, K. Bao, Q. Wang, and X. He.

</span>
<span class="ltx_bibblock">Collm: Integrating collaborative embeddings into large language
models for recommendation, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Preserving Pretrained Ability</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In conversational recommendation, often the user and the system will conduct multiple turns of conversations, and for the system to achieve a certain goal, tool use may be employed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib11" title="">11</a>]</cite>. There is often no constraint on the topics of the conversations, so the pretrained abilities of the LLM could be important. For example, the user may ask the LLM to perform certain operations such as adding or removing certain items from the recommended items, or conducting certain filtering based on a criteria. Those operations require certain reasoning ability from LLM pretraining. For another example, to use LLMs as an automatic agents <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib40" title="">40</a>]</cite> for conversational recommendation, they may require certain broad knowledge to perform tool use <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib45" title="">45</a>]</cite> to achieve a task. If the LLM is later fully finetuned only using the task specific data, it is likely that those pretrained abilities will be lost or hidden. Our ILM approach uses a frozen LLM, when the inputs don’t contain items, the behavior of the model will be exactly the same as the original LLM. This means all pretrained knowledge can be preserved, which is crucial for multi-turn conversations and tool use in automatic agents.</p>
</div>
<figure class="ltx_table" id="A1.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>The mean and standard error of the ILM metrics for ELM 24 tasks (computed using 3 runs with different random seeds)</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T6.48">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.48.49.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A1.T6.48.49.1.1">Tasks</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T6.48.49.1.2">SC(%)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T6.48.49.1.3">Log pplx</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T6.2.2.3">summary</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.1.1.1">0.7318 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.1.1.1.m1.1"><semantics id="A1.T6.1.1.1.m1.1a"><mo id="A1.T6.1.1.1.m1.1.1" xref="A1.T6.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.1.1.1.m1.1b"><csymbol cd="latexml" id="A1.T6.1.1.1.m1.1.1.cmml" xref="A1.T6.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.1.1.1.m1.1d">±</annotation></semantics></math> 0.00359</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.2.2.2">0.6250 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.2.2.2.m1.1"><semantics id="A1.T6.2.2.2.m1.1a"><mo id="A1.T6.2.2.2.m1.1.1" xref="A1.T6.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.2.2.2.m1.1b"><csymbol cd="latexml" id="A1.T6.2.2.2.m1.1.1.cmml" xref="A1.T6.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.2.2.2.m1.1d">±</annotation></semantics></math> 0.00134</td>
</tr>
<tr class="ltx_tr" id="A1.T6.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.4.4.3">positive review</th>
<td class="ltx_td ltx_align_left" id="A1.T6.3.3.1">0.7832 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.3.3.1.m1.1"><semantics id="A1.T6.3.3.1.m1.1a"><mo id="A1.T6.3.3.1.m1.1.1" xref="A1.T6.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.3.3.1.m1.1b"><csymbol cd="latexml" id="A1.T6.3.3.1.m1.1.1.cmml" xref="A1.T6.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.3.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.3.3.1.m1.1d">±</annotation></semantics></math> 0.00246</td>
<td class="ltx_td ltx_align_left" id="A1.T6.4.4.2">0.5711 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.4.4.2.m1.1"><semantics id="A1.T6.4.4.2.m1.1a"><mo id="A1.T6.4.4.2.m1.1.1" xref="A1.T6.4.4.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.4.4.2.m1.1b"><csymbol cd="latexml" id="A1.T6.4.4.2.m1.1.1.cmml" xref="A1.T6.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.4.4.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.4.4.2.m1.1d">±</annotation></semantics></math> 0.00211</td>
</tr>
<tr class="ltx_tr" id="A1.T6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.6.6.3">neutral review</th>
<td class="ltx_td ltx_align_left" id="A1.T6.5.5.1">0.7680 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.5.5.1.m1.1"><semantics id="A1.T6.5.5.1.m1.1a"><mo id="A1.T6.5.5.1.m1.1.1" xref="A1.T6.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.5.5.1.m1.1b"><csymbol cd="latexml" id="A1.T6.5.5.1.m1.1.1.cmml" xref="A1.T6.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.5.5.1.m1.1d">±</annotation></semantics></math> 0.00584</td>
<td class="ltx_td ltx_align_left" id="A1.T6.6.6.2">0.5759 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.6.6.2.m1.1"><semantics id="A1.T6.6.6.2.m1.1a"><mo id="A1.T6.6.6.2.m1.1.1" xref="A1.T6.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.6.6.2.m1.1b"><csymbol cd="latexml" id="A1.T6.6.6.2.m1.1.1.cmml" xref="A1.T6.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.6.6.2.m1.1d">±</annotation></semantics></math> 0.00345</td>
</tr>
<tr class="ltx_tr" id="A1.T6.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.8.8.3">five pos char.</th>
<td class="ltx_td ltx_align_left" id="A1.T6.7.7.1">0.8631 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.7.7.1.m1.1"><semantics id="A1.T6.7.7.1.m1.1a"><mo id="A1.T6.7.7.1.m1.1.1" xref="A1.T6.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.7.7.1.m1.1b"><csymbol cd="latexml" id="A1.T6.7.7.1.m1.1.1.cmml" xref="A1.T6.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.7.7.1.m1.1d">±</annotation></semantics></math> 0.00320</td>
<td class="ltx_td ltx_align_left" id="A1.T6.8.8.2">0.5960 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.8.8.2.m1.1"><semantics id="A1.T6.8.8.2.m1.1a"><mo id="A1.T6.8.8.2.m1.1.1" xref="A1.T6.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.8.8.2.m1.1b"><csymbol cd="latexml" id="A1.T6.8.8.2.m1.1.1.cmml" xref="A1.T6.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.8.8.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.8.8.2.m1.1d">±</annotation></semantics></math> 0.00556</td>
</tr>
<tr class="ltx_tr" id="A1.T6.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.10.10.3">five neg char.</th>
<td class="ltx_td ltx_align_left" id="A1.T6.9.9.1">0.9225 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.9.9.1.m1.1"><semantics id="A1.T6.9.9.1.m1.1a"><mo id="A1.T6.9.9.1.m1.1.1" xref="A1.T6.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.9.9.1.m1.1b"><csymbol cd="latexml" id="A1.T6.9.9.1.m1.1.1.cmml" xref="A1.T6.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.9.9.1.m1.1d">±</annotation></semantics></math> 0.00017</td>
<td class="ltx_td ltx_align_left" id="A1.T6.10.10.2">0.4029 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.10.10.2.m1.1"><semantics id="A1.T6.10.10.2.m1.1a"><mo id="A1.T6.10.10.2.m1.1.1" xref="A1.T6.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.10.10.2.m1.1b"><csymbol cd="latexml" id="A1.T6.10.10.2.m1.1.1.cmml" xref="A1.T6.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.10.10.2.m1.1d">±</annotation></semantics></math> 0.00845</td>
</tr>
<tr class="ltx_tr" id="A1.T6.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.12.12.3">long description</th>
<td class="ltx_td ltx_align_left" id="A1.T6.11.11.1">0.7258 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.11.11.1.m1.1"><semantics id="A1.T6.11.11.1.m1.1a"><mo id="A1.T6.11.11.1.m1.1.1" xref="A1.T6.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.11.11.1.m1.1b"><csymbol cd="latexml" id="A1.T6.11.11.1.m1.1.1.cmml" xref="A1.T6.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.11.11.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.11.11.1.m1.1d">±</annotation></semantics></math> 0.00411</td>
<td class="ltx_td ltx_align_left" id="A1.T6.12.12.2">0.6622 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.12.12.2.m1.1"><semantics id="A1.T6.12.12.2.m1.1a"><mo id="A1.T6.12.12.2.m1.1.1" xref="A1.T6.12.12.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.12.12.2.m1.1b"><csymbol cd="latexml" id="A1.T6.12.12.2.m1.1.1.cmml" xref="A1.T6.12.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.12.12.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.12.12.2.m1.1d">±</annotation></semantics></math> 0.00130</td>
</tr>
<tr class="ltx_tr" id="A1.T6.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.14.14.3">funnier</th>
<td class="ltx_td ltx_align_left" id="A1.T6.13.13.1">0.6891 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.13.13.1.m1.1"><semantics id="A1.T6.13.13.1.m1.1a"><mo id="A1.T6.13.13.1.m1.1.1" xref="A1.T6.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.13.13.1.m1.1b"><csymbol cd="latexml" id="A1.T6.13.13.1.m1.1.1.cmml" xref="A1.T6.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.13.13.1.m1.1d">±</annotation></semantics></math> 0.00358</td>
<td class="ltx_td ltx_align_left" id="A1.T6.14.14.2">0.5394 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.14.14.2.m1.1"><semantics id="A1.T6.14.14.2.m1.1a"><mo id="A1.T6.14.14.2.m1.1.1" xref="A1.T6.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.14.14.2.m1.1b"><csymbol cd="latexml" id="A1.T6.14.14.2.m1.1.1.cmml" xref="A1.T6.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.14.14.2.m1.1d">±</annotation></semantics></math> 0.00085</td>
</tr>
<tr class="ltx_tr" id="A1.T6.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.16.16.3">sadder</th>
<td class="ltx_td ltx_align_left" id="A1.T6.15.15.1">0.7181 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.15.15.1.m1.1"><semantics id="A1.T6.15.15.1.m1.1a"><mo id="A1.T6.15.15.1.m1.1.1" xref="A1.T6.15.15.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.15.15.1.m1.1b"><csymbol cd="latexml" id="A1.T6.15.15.1.m1.1.1.cmml" xref="A1.T6.15.15.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.15.15.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.15.15.1.m1.1d">±</annotation></semantics></math> 0.00267</td>
<td class="ltx_td ltx_align_left" id="A1.T6.16.16.2">0.5152 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.16.16.2.m1.1"><semantics id="A1.T6.16.16.2.m1.1a"><mo id="A1.T6.16.16.2.m1.1.1" xref="A1.T6.16.16.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.16.16.2.m1.1b"><csymbol cd="latexml" id="A1.T6.16.16.2.m1.1.1.cmml" xref="A1.T6.16.16.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.16.16.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.16.16.2.m1.1d">±</annotation></semantics></math> 0.00112</td>
</tr>
<tr class="ltx_tr" id="A1.T6.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.18.18.3">scarier</th>
<td class="ltx_td ltx_align_left" id="A1.T6.17.17.1">0.7241 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.17.17.1.m1.1"><semantics id="A1.T6.17.17.1.m1.1a"><mo id="A1.T6.17.17.1.m1.1.1" xref="A1.T6.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.17.17.1.m1.1b"><csymbol cd="latexml" id="A1.T6.17.17.1.m1.1.1.cmml" xref="A1.T6.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.17.17.1.m1.1d">±</annotation></semantics></math> 0.00261</td>
<td class="ltx_td ltx_align_left" id="A1.T6.18.18.2">0.5251 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.18.18.2.m1.1"><semantics id="A1.T6.18.18.2.m1.1a"><mo id="A1.T6.18.18.2.m1.1.1" xref="A1.T6.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.18.18.2.m1.1b"><csymbol cd="latexml" id="A1.T6.18.18.2.m1.1.1.cmml" xref="A1.T6.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.18.18.2.m1.1d">±</annotation></semantics></math> 0.00104</td>
</tr>
<tr class="ltx_tr" id="A1.T6.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.20.20.3">improve</th>
<td class="ltx_td ltx_align_left" id="A1.T6.19.19.1">0.7759 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.19.19.1.m1.1"><semantics id="A1.T6.19.19.1.m1.1a"><mo id="A1.T6.19.19.1.m1.1.1" xref="A1.T6.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.19.19.1.m1.1b"><csymbol cd="latexml" id="A1.T6.19.19.1.m1.1.1.cmml" xref="A1.T6.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.19.19.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.19.19.1.m1.1d">±</annotation></semantics></math> 0.00293</td>
<td class="ltx_td ltx_align_left" id="A1.T6.20.20.2">0.5123 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.20.20.2.m1.1"><semantics id="A1.T6.20.20.2.m1.1a"><mo id="A1.T6.20.20.2.m1.1.1" xref="A1.T6.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.20.20.2.m1.1b"><csymbol cd="latexml" id="A1.T6.20.20.2.m1.1.1.cmml" xref="A1.T6.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.20.20.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.20.20.2.m1.1d">±</annotation></semantics></math> 0.00264</td>
</tr>
<tr class="ltx_tr" id="A1.T6.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.22.22.3">movie to viewer</th>
<td class="ltx_td ltx_align_left" id="A1.T6.21.21.1">0.8008 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.21.21.1.m1.1"><semantics id="A1.T6.21.21.1.m1.1a"><mo id="A1.T6.21.21.1.m1.1.1" xref="A1.T6.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.21.21.1.m1.1b"><csymbol cd="latexml" id="A1.T6.21.21.1.m1.1.1.cmml" xref="A1.T6.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.21.21.1.m1.1d">±</annotation></semantics></math> 0.00313</td>
<td class="ltx_td ltx_align_left" id="A1.T6.22.22.2">0.6005 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.22.22.2.m1.1"><semantics id="A1.T6.22.22.2.m1.1a"><mo id="A1.T6.22.22.2.m1.1.1" xref="A1.T6.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.22.22.2.m1.1b"><csymbol cd="latexml" id="A1.T6.22.22.2.m1.1.1.cmml" xref="A1.T6.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.22.22.2.m1.1d">±</annotation></semantics></math> 0.00425</td>
</tr>
<tr class="ltx_tr" id="A1.T6.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.24.24.3">pitch</th>
<td class="ltx_td ltx_align_left" id="A1.T6.23.23.1">0.8370 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.23.23.1.m1.1"><semantics id="A1.T6.23.23.1.m1.1a"><mo id="A1.T6.23.23.1.m1.1.1" xref="A1.T6.23.23.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.23.23.1.m1.1b"><csymbol cd="latexml" id="A1.T6.23.23.1.m1.1.1.cmml" xref="A1.T6.23.23.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.23.23.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.23.23.1.m1.1d">±</annotation></semantics></math> 0.00341</td>
<td class="ltx_td ltx_align_left" id="A1.T6.24.24.2">0.5181 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.24.24.2.m1.1"><semantics id="A1.T6.24.24.2.m1.1a"><mo id="A1.T6.24.24.2.m1.1.1" xref="A1.T6.24.24.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.24.24.2.m1.1b"><csymbol cd="latexml" id="A1.T6.24.24.2.m1.1.1.cmml" xref="A1.T6.24.24.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.24.24.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.24.24.2.m1.1d">±</annotation></semantics></math> 0.00198</td>
</tr>
<tr class="ltx_tr" id="A1.T6.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.26.26.3">criticize</th>
<td class="ltx_td ltx_align_left" id="A1.T6.25.25.1">0.7894 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.25.25.1.m1.1"><semantics id="A1.T6.25.25.1.m1.1a"><mo id="A1.T6.25.25.1.m1.1.1" xref="A1.T6.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.25.25.1.m1.1b"><csymbol cd="latexml" id="A1.T6.25.25.1.m1.1.1.cmml" xref="A1.T6.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.25.25.1.m1.1d">±</annotation></semantics></math> 0.00356</td>
<td class="ltx_td ltx_align_left" id="A1.T6.26.26.2">0.5504 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.26.26.2.m1.1"><semantics id="A1.T6.26.26.2.m1.1a"><mo id="A1.T6.26.26.2.m1.1.1" xref="A1.T6.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.26.26.2.m1.1b"><csymbol cd="latexml" id="A1.T6.26.26.2.m1.1.1.cmml" xref="A1.T6.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.26.26.2.m1.1d">±</annotation></semantics></math> 0.00406</td>
</tr>
<tr class="ltx_tr" id="A1.T6.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.28.28.3">convince1</th>
<td class="ltx_td ltx_align_left" id="A1.T6.27.27.1">0.7881 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.27.27.1.m1.1"><semantics id="A1.T6.27.27.1.m1.1a"><mo id="A1.T6.27.27.1.m1.1.1" xref="A1.T6.27.27.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.27.27.1.m1.1b"><csymbol cd="latexml" id="A1.T6.27.27.1.m1.1.1.cmml" xref="A1.T6.27.27.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.27.27.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.27.27.1.m1.1d">±</annotation></semantics></math> 0.00353</td>
<td class="ltx_td ltx_align_left" id="A1.T6.28.28.2">0.6176 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.28.28.2.m1.1"><semantics id="A1.T6.28.28.2.m1.1a"><mo id="A1.T6.28.28.2.m1.1.1" xref="A1.T6.28.28.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.28.28.2.m1.1b"><csymbol cd="latexml" id="A1.T6.28.28.2.m1.1.1.cmml" xref="A1.T6.28.28.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.28.28.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.28.28.2.m1.1d">±</annotation></semantics></math> 0.00353</td>
</tr>
<tr class="ltx_tr" id="A1.T6.30.30">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.30.30.3">convince2</th>
<td class="ltx_td ltx_align_left" id="A1.T6.29.29.1">0.7957 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.29.29.1.m1.1"><semantics id="A1.T6.29.29.1.m1.1a"><mo id="A1.T6.29.29.1.m1.1.1" xref="A1.T6.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.29.29.1.m1.1b"><csymbol cd="latexml" id="A1.T6.29.29.1.m1.1.1.cmml" xref="A1.T6.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.29.29.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.29.29.1.m1.1d">±</annotation></semantics></math> 0.00523</td>
<td class="ltx_td ltx_align_left" id="A1.T6.30.30.2">0.7795 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.30.30.2.m1.1"><semantics id="A1.T6.30.30.2.m1.1a"><mo id="A1.T6.30.30.2.m1.1.1" xref="A1.T6.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.30.30.2.m1.1b"><csymbol cd="latexml" id="A1.T6.30.30.2.m1.1.1.cmml" xref="A1.T6.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.30.30.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.30.30.2.m1.1d">±</annotation></semantics></math> 0.00533</td>
</tr>
<tr class="ltx_tr" id="A1.T6.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.32.32.3">convince3</th>
<td class="ltx_td ltx_align_left" id="A1.T6.31.31.1">0.7949 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.31.31.1.m1.1"><semantics id="A1.T6.31.31.1.m1.1a"><mo id="A1.T6.31.31.1.m1.1.1" xref="A1.T6.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.31.31.1.m1.1b"><csymbol cd="latexml" id="A1.T6.31.31.1.m1.1.1.cmml" xref="A1.T6.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.31.31.1.m1.1d">±</annotation></semantics></math> 0.00421</td>
<td class="ltx_td ltx_align_left" id="A1.T6.32.32.2">0.8900 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.32.32.2.m1.1"><semantics id="A1.T6.32.32.2.m1.1a"><mo id="A1.T6.32.32.2.m1.1.1" xref="A1.T6.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.32.32.2.m1.1b"><csymbol cd="latexml" id="A1.T6.32.32.2.m1.1.1.cmml" xref="A1.T6.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.32.32.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.32.32.2.m1.1d">±</annotation></semantics></math> 0.00714</td>
</tr>
<tr class="ltx_tr" id="A1.T6.34.34">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.34.34.3">dissuade1</th>
<td class="ltx_td ltx_align_left" id="A1.T6.33.33.1">0.7909 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.33.33.1.m1.1"><semantics id="A1.T6.33.33.1.m1.1a"><mo id="A1.T6.33.33.1.m1.1.1" xref="A1.T6.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.33.33.1.m1.1b"><csymbol cd="latexml" id="A1.T6.33.33.1.m1.1.1.cmml" xref="A1.T6.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.33.33.1.m1.1d">±</annotation></semantics></math> 0.00203</td>
<td class="ltx_td ltx_align_left" id="A1.T6.34.34.2">0.6076 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.34.34.2.m1.1"><semantics id="A1.T6.34.34.2.m1.1a"><mo id="A1.T6.34.34.2.m1.1.1" xref="A1.T6.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.34.34.2.m1.1b"><csymbol cd="latexml" id="A1.T6.34.34.2.m1.1.1.cmml" xref="A1.T6.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.34.34.2.m1.1d">±</annotation></semantics></math> 0.00381</td>
</tr>
<tr class="ltx_tr" id="A1.T6.36.36">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.36.36.3">dissuade2</th>
<td class="ltx_td ltx_align_left" id="A1.T6.35.35.1">0.8386 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.35.35.1.m1.1"><semantics id="A1.T6.35.35.1.m1.1a"><mo id="A1.T6.35.35.1.m1.1.1" xref="A1.T6.35.35.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.35.35.1.m1.1b"><csymbol cd="latexml" id="A1.T6.35.35.1.m1.1.1.cmml" xref="A1.T6.35.35.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.35.35.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.35.35.1.m1.1d">±</annotation></semantics></math> 0.00167</td>
<td class="ltx_td ltx_align_left" id="A1.T6.36.36.2">0.7278 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.36.36.2.m1.1"><semantics id="A1.T6.36.36.2.m1.1a"><mo id="A1.T6.36.36.2.m1.1.1" xref="A1.T6.36.36.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.36.36.2.m1.1b"><csymbol cd="latexml" id="A1.T6.36.36.2.m1.1.1.cmml" xref="A1.T6.36.36.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.36.36.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.36.36.2.m1.1d">±</annotation></semantics></math> 0.00609</td>
</tr>
<tr class="ltx_tr" id="A1.T6.38.38">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T6.38.38.3">similarities</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.37.37.1">0.8422 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.37.37.1.m1.1"><semantics id="A1.T6.37.37.1.m1.1a"><mo id="A1.T6.37.37.1.m1.1.1" xref="A1.T6.37.37.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.37.37.1.m1.1b"><csymbol cd="latexml" id="A1.T6.37.37.1.m1.1.1.cmml" xref="A1.T6.37.37.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.37.37.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.37.37.1.m1.1d">±</annotation></semantics></math> 0.00585</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.38.38.2">0.3993 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.38.38.2.m1.1"><semantics id="A1.T6.38.38.2.m1.1a"><mo id="A1.T6.38.38.2.m1.1.1" xref="A1.T6.38.38.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.38.38.2.m1.1b"><csymbol cd="latexml" id="A1.T6.38.38.2.m1.1.1.cmml" xref="A1.T6.38.38.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.38.38.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.38.38.2.m1.1d">±</annotation></semantics></math> 0.00842</td>
</tr>
<tr class="ltx_tr" id="A1.T6.40.40">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.40.40.3">interpolation</th>
<td class="ltx_td ltx_align_left" id="A1.T6.39.39.1">0.7300 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.39.39.1.m1.1"><semantics id="A1.T6.39.39.1.m1.1a"><mo id="A1.T6.39.39.1.m1.1.1" xref="A1.T6.39.39.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.39.39.1.m1.1b"><csymbol cd="latexml" id="A1.T6.39.39.1.m1.1.1.cmml" xref="A1.T6.39.39.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.39.39.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.39.39.1.m1.1d">±</annotation></semantics></math> 0.00363</td>
<td class="ltx_td ltx_align_left" id="A1.T6.40.40.2">0.5310 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.40.40.2.m1.1"><semantics id="A1.T6.40.40.2.m1.1a"><mo id="A1.T6.40.40.2.m1.1.1" xref="A1.T6.40.40.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.40.40.2.m1.1b"><csymbol cd="latexml" id="A1.T6.40.40.2.m1.1.1.cmml" xref="A1.T6.40.40.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.40.40.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.40.40.2.m1.1d">±</annotation></semantics></math> 0.00238</td>
</tr>
<tr class="ltx_tr" id="A1.T6.42.42">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.42.42.3">why like nn</th>
<td class="ltx_td ltx_align_left" id="A1.T6.41.41.1">0.8030 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.41.41.1.m1.1"><semantics id="A1.T6.41.41.1.m1.1a"><mo id="A1.T6.41.41.1.m1.1.1" xref="A1.T6.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.41.41.1.m1.1b"><csymbol cd="latexml" id="A1.T6.41.41.1.m1.1.1.cmml" xref="A1.T6.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.41.41.1.m1.1d">±</annotation></semantics></math> 0.00367</td>
<td class="ltx_td ltx_align_left" id="A1.T6.42.42.2">0.6452 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.42.42.2.m1.1"><semantics id="A1.T6.42.42.2.m1.1a"><mo id="A1.T6.42.42.2.m1.1.1" xref="A1.T6.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.42.42.2.m1.1b"><csymbol cd="latexml" id="A1.T6.42.42.2.m1.1.1.cmml" xref="A1.T6.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.42.42.2.m1.1d">±</annotation></semantics></math> 0.00556</td>
</tr>
<tr class="ltx_tr" id="A1.T6.44.44">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.44.44.3">diff than nn</th>
<td class="ltx_td ltx_align_left" id="A1.T6.43.43.1">0.8891 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.43.43.1.m1.1"><semantics id="A1.T6.43.43.1.m1.1a"><mo id="A1.T6.43.43.1.m1.1.1" xref="A1.T6.43.43.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.43.43.1.m1.1b"><csymbol cd="latexml" id="A1.T6.43.43.1.m1.1.1.cmml" xref="A1.T6.43.43.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.43.43.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.43.43.1.m1.1d">±</annotation></semantics></math> 0.00198</td>
<td class="ltx_td ltx_align_left" id="A1.T6.44.44.2">0.5111 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.44.44.2.m1.1"><semantics id="A1.T6.44.44.2.m1.1a"><mo id="A1.T6.44.44.2.m1.1.1" xref="A1.T6.44.44.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.44.44.2.m1.1b"><csymbol cd="latexml" id="A1.T6.44.44.2.m1.1.1.cmml" xref="A1.T6.44.44.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.44.44.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.44.44.2.m1.1d">±</annotation></semantics></math> 0.00941</td>
</tr>
<tr class="ltx_tr" id="A1.T6.46.46">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T6.46.46.3">common with nn</th>
<td class="ltx_td ltx_align_left" id="A1.T6.45.45.1">0.8433 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.45.45.1.m1.1"><semantics id="A1.T6.45.45.1.m1.1a"><mo id="A1.T6.45.45.1.m1.1.1" xref="A1.T6.45.45.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.45.45.1.m1.1b"><csymbol cd="latexml" id="A1.T6.45.45.1.m1.1.1.cmml" xref="A1.T6.45.45.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.45.45.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.45.45.1.m1.1d">±</annotation></semantics></math> 0.00182</td>
<td class="ltx_td ltx_align_left" id="A1.T6.46.46.2">0.5393 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.46.46.2.m1.1"><semantics id="A1.T6.46.46.2.m1.1a"><mo id="A1.T6.46.46.2.m1.1.1" xref="A1.T6.46.46.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.46.46.2.m1.1b"><csymbol cd="latexml" id="A1.T6.46.46.2.m1.1.1.cmml" xref="A1.T6.46.46.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.46.46.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.46.46.2.m1.1d">±</annotation></semantics></math> 0.00817</td>
</tr>
<tr class="ltx_tr" id="A1.T6.48.48">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A1.T6.48.48.3">all</th>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T6.47.47.1">0.7939 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.47.47.1.m1.1"><semantics id="A1.T6.47.47.1.m1.1a"><mo id="A1.T6.47.47.1.m1.1.1" xref="A1.T6.47.47.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.47.47.1.m1.1b"><csymbol cd="latexml" id="A1.T6.47.47.1.m1.1.1.cmml" xref="A1.T6.47.47.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.47.47.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.47.47.1.m1.1d">±</annotation></semantics></math> 0.00317</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T6.48.48.2">0.5813 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T6.48.48.2.m1.1"><semantics id="A1.T6.48.48.2.m1.1a"><mo id="A1.T6.48.48.2.m1.1.1" xref="A1.T6.48.48.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T6.48.48.2.m1.1b"><csymbol cd="latexml" id="A1.T6.48.48.2.m1.1.1.cmml" xref="A1.T6.48.48.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T6.48.48.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T6.48.48.2.m1.1d">±</annotation></semantics></math> 0.00415</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>The mean and standard error of the ILM metrics for OpenP5 datasets (computed using 3 runs with different random seeds)</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T7.24" style="width:433.6pt;height:118.7pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-15.2pt,4.1pt) scale(0.934635793496274,0.934635793496274) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T7.24.24">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T7.24.24.25.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A1.T7.24.24.25.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.24.24.25.1.2">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.24.24.25.1.3">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.24.24.25.1.4">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T7.24.24.25.1.5">NDCG@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T7.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T7.4.4.4.5">ml1m(seen)</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.1.1.1.1">0.0715 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.1.1.1.1.m1.1"><semantics id="A1.T7.1.1.1.1.m1.1a"><mo id="A1.T7.1.1.1.1.m1.1.1" xref="A1.T7.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.1.1.1.1.m1.1b"><csymbol cd="latexml" id="A1.T7.1.1.1.1.m1.1.1.cmml" xref="A1.T7.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.1.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.1.1.1.1.m1.1d">±</annotation></semantics></math> 0.00051</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.2.2.2.2">0.0476 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.2.2.2.2.m1.1"><semantics id="A1.T7.2.2.2.2.m1.1a"><mo id="A1.T7.2.2.2.2.m1.1.1" xref="A1.T7.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.2.2.2.2.m1.1b"><csymbol cd="latexml" id="A1.T7.2.2.2.2.m1.1.1.cmml" xref="A1.T7.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.2.2.2.2.m1.1d">±</annotation></semantics></math> 0.00047</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.3.3.3.3">0.1072 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.3.3.3.3.m1.1"><semantics id="A1.T7.3.3.3.3.m1.1a"><mo id="A1.T7.3.3.3.3.m1.1.1" xref="A1.T7.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.3.3.3.3.m1.1b"><csymbol cd="latexml" id="A1.T7.3.3.3.3.m1.1.1.cmml" xref="A1.T7.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.3.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.3.3.3.3.m1.1d">±</annotation></semantics></math> 0.00043</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.4.4.4.4">0.0591 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.4.4.4.4.m1.1"><semantics id="A1.T7.4.4.4.4.m1.1a"><mo id="A1.T7.4.4.4.4.m1.1.1" xref="A1.T7.4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.4.4.4.4.m1.1b"><csymbol cd="latexml" id="A1.T7.4.4.4.4.m1.1.1.cmml" xref="A1.T7.4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.4.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.4.4.4.4.m1.1d">±</annotation></semantics></math> 0.00020</td>
</tr>
<tr class="ltx_tr" id="A1.T7.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.8.8.8.5">beauty(seen)</th>
<td class="ltx_td ltx_align_left" id="A1.T7.5.5.5.1">0.0210 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.5.5.5.1.m1.1"><semantics id="A1.T7.5.5.5.1.m1.1a"><mo id="A1.T7.5.5.5.1.m1.1.1" xref="A1.T7.5.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.5.5.5.1.m1.1b"><csymbol cd="latexml" id="A1.T7.5.5.5.1.m1.1.1.cmml" xref="A1.T7.5.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.5.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.5.5.5.1.m1.1d">±</annotation></semantics></math> 0.00018</td>
<td class="ltx_td ltx_align_left" id="A1.T7.6.6.6.2">0.0160 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.6.6.6.2.m1.1"><semantics id="A1.T7.6.6.6.2.m1.1a"><mo id="A1.T7.6.6.6.2.m1.1.1" xref="A1.T7.6.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.6.6.6.2.m1.1b"><csymbol cd="latexml" id="A1.T7.6.6.6.2.m1.1.1.cmml" xref="A1.T7.6.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.6.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.6.6.6.2.m1.1d">±</annotation></semantics></math> 0.00020</td>
<td class="ltx_td ltx_align_left" id="A1.T7.7.7.7.3">0.0265 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.7.7.7.3.m1.1"><semantics id="A1.T7.7.7.7.3.m1.1a"><mo id="A1.T7.7.7.7.3.m1.1.1" xref="A1.T7.7.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.7.7.7.3.m1.1b"><csymbol cd="latexml" id="A1.T7.7.7.7.3.m1.1.1.cmml" xref="A1.T7.7.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.7.7.7.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.7.7.7.3.m1.1d">±</annotation></semantics></math> 0.00036</td>
<td class="ltx_td ltx_align_left" id="A1.T7.8.8.8.4">0.0177 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.8.8.8.4.m1.1"><semantics id="A1.T7.8.8.8.4.m1.1a"><mo id="A1.T7.8.8.8.4.m1.1.1" xref="A1.T7.8.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.8.8.8.4.m1.1b"><csymbol cd="latexml" id="A1.T7.8.8.8.4.m1.1.1.cmml" xref="A1.T7.8.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.8.8.8.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.8.8.8.4.m1.1d">±</annotation></semantics></math> 0.00025</td>
</tr>
<tr class="ltx_tr" id="A1.T7.12.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.12.12.12.5">clothing(seen)</th>
<td class="ltx_td ltx_align_left" id="A1.T7.9.9.9.1">0.0040 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.9.9.9.1.m1.1"><semantics id="A1.T7.9.9.9.1.m1.1a"><mo id="A1.T7.9.9.9.1.m1.1.1" xref="A1.T7.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.9.9.9.1.m1.1b"><csymbol cd="latexml" id="A1.T7.9.9.9.1.m1.1.1.cmml" xref="A1.T7.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.9.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.9.9.9.1.m1.1d">±</annotation></semantics></math> 0.000085</td>
<td class="ltx_td ltx_align_left" id="A1.T7.10.10.10.2">0.0025 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.10.10.10.2.m1.1"><semantics id="A1.T7.10.10.10.2.m1.1a"><mo id="A1.T7.10.10.10.2.m1.1.1" xref="A1.T7.10.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.10.10.10.2.m1.1b"><csymbol cd="latexml" id="A1.T7.10.10.10.2.m1.1.1.cmml" xref="A1.T7.10.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.10.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.10.10.10.2.m1.1d">±</annotation></semantics></math> 0.000014</td>
<td class="ltx_td ltx_align_left" id="A1.T7.11.11.11.3">0.0061 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.11.11.11.3.m1.1"><semantics id="A1.T7.11.11.11.3.m1.1a"><mo id="A1.T7.11.11.11.3.m1.1.1" xref="A1.T7.11.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.11.11.11.3.m1.1b"><csymbol cd="latexml" id="A1.T7.11.11.11.3.m1.1.1.cmml" xref="A1.T7.11.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.11.11.11.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.11.11.11.3.m1.1d">±</annotation></semantics></math> 0.00022</td>
<td class="ltx_td ltx_align_left" id="A1.T7.12.12.12.4">0.0032 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.12.12.12.4.m1.1"><semantics id="A1.T7.12.12.12.4.m1.1a"><mo id="A1.T7.12.12.12.4.m1.1.1" xref="A1.T7.12.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.12.12.12.4.m1.1b"><csymbol cd="latexml" id="A1.T7.12.12.12.4.m1.1.1.cmml" xref="A1.T7.12.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.12.12.12.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.12.12.12.4.m1.1d">±</annotation></semantics></math> 0.000051</td>
</tr>
<tr class="ltx_tr" id="A1.T7.16.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T7.16.16.16.5">ml1m(unseen)</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.13.13.13.1">0.0720 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.13.13.13.1.m1.1"><semantics id="A1.T7.13.13.13.1.m1.1a"><mo id="A1.T7.13.13.13.1.m1.1.1" xref="A1.T7.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.13.13.13.1.m1.1b"><csymbol cd="latexml" id="A1.T7.13.13.13.1.m1.1.1.cmml" xref="A1.T7.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.13.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.13.13.13.1.m1.1d">±</annotation></semantics></math> 0.00044</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.14.14.14.2">0.0478 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.14.14.14.2.m1.1"><semantics id="A1.T7.14.14.14.2.m1.1a"><mo id="A1.T7.14.14.14.2.m1.1.1" xref="A1.T7.14.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.14.14.14.2.m1.1b"><csymbol cd="latexml" id="A1.T7.14.14.14.2.m1.1.1.cmml" xref="A1.T7.14.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.14.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.14.14.14.2.m1.1d">±</annotation></semantics></math> 0.00052</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.15.15.15.3">0.1069 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.15.15.15.3.m1.1"><semantics id="A1.T7.15.15.15.3.m1.1a"><mo id="A1.T7.15.15.15.3.m1.1.1" xref="A1.T7.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.15.15.15.3.m1.1b"><csymbol cd="latexml" id="A1.T7.15.15.15.3.m1.1.1.cmml" xref="A1.T7.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.15.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.15.15.15.3.m1.1d">±</annotation></semantics></math> 0.00095</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.16.16.16.4">0.0591 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.16.16.16.4.m1.1"><semantics id="A1.T7.16.16.16.4.m1.1a"><mo id="A1.T7.16.16.16.4.m1.1.1" xref="A1.T7.16.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.16.16.16.4.m1.1b"><csymbol cd="latexml" id="A1.T7.16.16.16.4.m1.1.1.cmml" xref="A1.T7.16.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.16.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.16.16.16.4.m1.1d">±</annotation></semantics></math> 0.00049</td>
</tr>
<tr class="ltx_tr" id="A1.T7.20.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T7.20.20.20.5">beauty(unseen)</th>
<td class="ltx_td ltx_align_left" id="A1.T7.17.17.17.1">0.0214 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.17.17.17.1.m1.1"><semantics id="A1.T7.17.17.17.1.m1.1a"><mo id="A1.T7.17.17.17.1.m1.1.1" xref="A1.T7.17.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.17.17.17.1.m1.1b"><csymbol cd="latexml" id="A1.T7.17.17.17.1.m1.1.1.cmml" xref="A1.T7.17.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.17.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.17.17.17.1.m1.1d">±</annotation></semantics></math> 0.00019</td>
<td class="ltx_td ltx_align_left" id="A1.T7.18.18.18.2">0.0162 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.18.18.18.2.m1.1"><semantics id="A1.T7.18.18.18.2.m1.1a"><mo id="A1.T7.18.18.18.2.m1.1.1" xref="A1.T7.18.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.18.18.18.2.m1.1b"><csymbol cd="latexml" id="A1.T7.18.18.18.2.m1.1.1.cmml" xref="A1.T7.18.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.18.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.18.18.18.2.m1.1d">±</annotation></semantics></math> 0.000090</td>
<td class="ltx_td ltx_align_left" id="A1.T7.19.19.19.3">0.0266 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.19.19.19.3.m1.1"><semantics id="A1.T7.19.19.19.3.m1.1a"><mo id="A1.T7.19.19.19.3.m1.1.1" xref="A1.T7.19.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.19.19.19.3.m1.1b"><csymbol cd="latexml" id="A1.T7.19.19.19.3.m1.1.1.cmml" xref="A1.T7.19.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.19.19.19.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.19.19.19.3.m1.1d">±</annotation></semantics></math> 0.00020</td>
<td class="ltx_td ltx_align_left" id="A1.T7.20.20.20.4">0.0179 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.20.20.20.4.m1.1"><semantics id="A1.T7.20.20.20.4.m1.1a"><mo id="A1.T7.20.20.20.4.m1.1.1" xref="A1.T7.20.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.20.20.20.4.m1.1b"><csymbol cd="latexml" id="A1.T7.20.20.20.4.m1.1.1.cmml" xref="A1.T7.20.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.20.20.20.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.20.20.20.4.m1.1d">±</annotation></semantics></math> 0.000099</td>
</tr>
<tr class="ltx_tr" id="A1.T7.24.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T7.24.24.24.5">clothing(unseen)</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T7.21.21.21.1">0.0038 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.21.21.21.1.m1.1"><semantics id="A1.T7.21.21.21.1.m1.1a"><mo id="A1.T7.21.21.21.1.m1.1.1" xref="A1.T7.21.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.21.21.21.1.m1.1b"><csymbol cd="latexml" id="A1.T7.21.21.21.1.m1.1.1.cmml" xref="A1.T7.21.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.21.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.21.21.21.1.m1.1d">±</annotation></semantics></math> 0.000037</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T7.22.22.22.2">0.0025 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.22.22.22.2.m1.1"><semantics id="A1.T7.22.22.22.2.m1.1a"><mo id="A1.T7.22.22.22.2.m1.1.1" xref="A1.T7.22.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.22.22.22.2.m1.1b"><csymbol cd="latexml" id="A1.T7.22.22.22.2.m1.1.1.cmml" xref="A1.T7.22.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.22.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.22.22.22.2.m1.1d">±</annotation></semantics></math> 0.000041</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T7.23.23.23.3">0.0059 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.23.23.23.3.m1.1"><semantics id="A1.T7.23.23.23.3.m1.1a"><mo id="A1.T7.23.23.23.3.m1.1.1" xref="A1.T7.23.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.23.23.23.3.m1.1b"><csymbol cd="latexml" id="A1.T7.23.23.23.3.m1.1.1.cmml" xref="A1.T7.23.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.23.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.23.23.23.3.m1.1d">±</annotation></semantics></math> 0.00015</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T7.24.24.24.4">0.0032 <math alttext="\pm" class="ltx_Math" display="inline" id="A1.T7.24.24.24.4.m1.1"><semantics id="A1.T7.24.24.24.4.m1.1a"><mo id="A1.T7.24.24.24.4.m1.1.1" xref="A1.T7.24.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A1.T7.24.24.24.4.m1.1b"><csymbol cd="latexml" id="A1.T7.24.24.24.4.m1.1.1.cmml" xref="A1.T7.24.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T7.24.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A1.T7.24.24.24.4.m1.1d">±</annotation></semantics></math> 0.000029</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Hyperparameters</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">The hyper-parameters for phase 1 and phase 2 trainings on the ELM 24 tasks are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#A2.T8" title="Table 8 ‣ Appendix B Hyperparameters ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="A2.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Hyper-parameters for ELM 24 tasks.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T8.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T8.2.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A2.T8.2.3.1.1" rowspan="6"><span class="ltx_text" id="A2.T8.2.3.1.1.1">Phase 1</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.2.3.1.2">Q-Former</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T8.2.3.1.3">8 layers, 168M params</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.4.2">
<td class="ltx_td ltx_align_center" id="A2.T8.2.4.2.1">batch size</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.4.2.2">256</td>
</tr>
<tr class="ltx_tr" id="A2.T8.1.1">
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.2">learning rate</td>
<td class="ltx_td ltx_align_center" id="A2.T8.1.1.1"><math alttext="3\times 10^{-5}" class="ltx_Math" display="inline" id="A2.T8.1.1.1.m1.1"><semantics id="A2.T8.1.1.1.m1.1a"><mrow id="A2.T8.1.1.1.m1.1.1" xref="A2.T8.1.1.1.m1.1.1.cmml"><mn id="A2.T8.1.1.1.m1.1.1.2" xref="A2.T8.1.1.1.m1.1.1.2.cmml">3</mn><mo id="A2.T8.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.T8.1.1.1.m1.1.1.1.cmml">×</mo><msup id="A2.T8.1.1.1.m1.1.1.3" xref="A2.T8.1.1.1.m1.1.1.3.cmml"><mn id="A2.T8.1.1.1.m1.1.1.3.2" xref="A2.T8.1.1.1.m1.1.1.3.2.cmml">10</mn><mrow id="A2.T8.1.1.1.m1.1.1.3.3" xref="A2.T8.1.1.1.m1.1.1.3.3.cmml"><mo id="A2.T8.1.1.1.m1.1.1.3.3a" xref="A2.T8.1.1.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.T8.1.1.1.m1.1.1.3.3.2" xref="A2.T8.1.1.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.1.1.1.m1.1b"><apply id="A2.T8.1.1.1.m1.1.1.cmml" xref="A2.T8.1.1.1.m1.1.1"><times id="A2.T8.1.1.1.m1.1.1.1.cmml" xref="A2.T8.1.1.1.m1.1.1.1"></times><cn id="A2.T8.1.1.1.m1.1.1.2.cmml" type="integer" xref="A2.T8.1.1.1.m1.1.1.2">3</cn><apply id="A2.T8.1.1.1.m1.1.1.3.cmml" xref="A2.T8.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.T8.1.1.1.m1.1.1.3.1.cmml" xref="A2.T8.1.1.1.m1.1.1.3">superscript</csymbol><cn id="A2.T8.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="A2.T8.1.1.1.m1.1.1.3.2">10</cn><apply id="A2.T8.1.1.1.m1.1.1.3.3.cmml" xref="A2.T8.1.1.1.m1.1.1.3.3"><minus id="A2.T8.1.1.1.m1.1.1.3.3.1.cmml" xref="A2.T8.1.1.1.m1.1.1.3.3"></minus><cn id="A2.T8.1.1.1.m1.1.1.3.3.2.cmml" type="integer" xref="A2.T8.1.1.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.1.1.1.m1.1c">3\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A2.T8.1.1.1.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.5.3">
<td class="ltx_td ltx_align_center" id="A2.T8.2.5.3.1">learning rate schedule</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.5.3.2">cosine decay</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.6.4">
<td class="ltx_td ltx_align_center" id="A2.T8.2.6.4.1">optimizer</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.6.4.2">AdaFactor <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib46" title="">46</a>]</cite>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.7.5">
<td class="ltx_td ltx_align_center" id="A2.T8.2.7.5.1"># steps</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.7.5.2">259K</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.8.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A2.T8.2.8.6.1"></th>
<td class="ltx_td ltx_align_center" id="A2.T8.2.8.6.2">hardware</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.8.6.3">16 Cloud V5 TPUs</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T8.2.9.7.1" rowspan="6"><span class="ltx_text" id="A2.T8.2.9.7.1.1">Phase 2</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.9.7.2">LLM backbone</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T8.2.9.7.3">PaLM 2-S <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib19" title="">19</a>]</cite>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.10.8">
<td class="ltx_td ltx_align_center" id="A2.T8.2.10.8.1">batch size</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.10.8.2">32</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.2">
<td class="ltx_td ltx_align_center" id="A2.T8.2.2.2">learning rate</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.2.1"><math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="A2.T8.2.2.1.m1.1"><semantics id="A2.T8.2.2.1.m1.1a"><mrow id="A2.T8.2.2.1.m1.1.1" xref="A2.T8.2.2.1.m1.1.1.cmml"><mn id="A2.T8.2.2.1.m1.1.1.2" xref="A2.T8.2.2.1.m1.1.1.2.cmml">5</mn><mo id="A2.T8.2.2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.T8.2.2.1.m1.1.1.1.cmml">×</mo><msup id="A2.T8.2.2.1.m1.1.1.3" xref="A2.T8.2.2.1.m1.1.1.3.cmml"><mn id="A2.T8.2.2.1.m1.1.1.3.2" xref="A2.T8.2.2.1.m1.1.1.3.2.cmml">10</mn><mrow id="A2.T8.2.2.1.m1.1.1.3.3" xref="A2.T8.2.2.1.m1.1.1.3.3.cmml"><mo id="A2.T8.2.2.1.m1.1.1.3.3a" xref="A2.T8.2.2.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.T8.2.2.1.m1.1.1.3.3.2" xref="A2.T8.2.2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.T8.2.2.1.m1.1b"><apply id="A2.T8.2.2.1.m1.1.1.cmml" xref="A2.T8.2.2.1.m1.1.1"><times id="A2.T8.2.2.1.m1.1.1.1.cmml" xref="A2.T8.2.2.1.m1.1.1.1"></times><cn id="A2.T8.2.2.1.m1.1.1.2.cmml" type="integer" xref="A2.T8.2.2.1.m1.1.1.2">5</cn><apply id="A2.T8.2.2.1.m1.1.1.3.cmml" xref="A2.T8.2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.T8.2.2.1.m1.1.1.3.1.cmml" xref="A2.T8.2.2.1.m1.1.1.3">superscript</csymbol><cn id="A2.T8.2.2.1.m1.1.1.3.2.cmml" type="integer" xref="A2.T8.2.2.1.m1.1.1.3.2">10</cn><apply id="A2.T8.2.2.1.m1.1.1.3.3.cmml" xref="A2.T8.2.2.1.m1.1.1.3.3"><minus id="A2.T8.2.2.1.m1.1.1.3.3.1.cmml" xref="A2.T8.2.2.1.m1.1.1.3.3"></minus><cn id="A2.T8.2.2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A2.T8.2.2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T8.2.2.1.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A2.T8.2.2.1.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.11.9">
<td class="ltx_td ltx_align_center" id="A2.T8.2.11.9.1">learning rate schedule</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.11.9.2">linear decay</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.12.10">
<td class="ltx_td ltx_align_center" id="A2.T8.2.12.10.1">optimizer</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.12.10.2">AdaFactor <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib46" title="">46</a>]</cite>
</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.13.11">
<td class="ltx_td ltx_align_center" id="A2.T8.2.13.11.1"># steps</td>
<td class="ltx_td ltx_align_center" id="A2.T8.2.13.11.2">100K</td>
</tr>
<tr class="ltx_tr" id="A2.T8.2.14.12">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T8.2.14.12.1"></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.2.14.12.2">hardware</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T8.2.14.12.3">64 Cloud V5 TPUs</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">For OpenP5 benchmarks, we use a 8 layer transformer decoder as the LLM backbone. We pretrain the LLM backbone using text only OpenP5 data to enable generative retrieval. For the ML1M dataset, we pretrain for 100K steps. For the Beauty dataset, we pretrain for 20K steps. For the Clothing dataset, we pretrain for 10K steps. The hyper-parameters for phase 1 and phase 2 trainings on the OpenP5 tasks are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#A2.T9" title="Table 9 ‣ Appendix B Hyperparameters ‣ Item-Language Model for Conversational Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<figure class="ltx_table" id="A2.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Hyper-parameters for OpenP5 tasks.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T9.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T9.2.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A2.T9.2.3.1.1" rowspan="6"><span class="ltx_text" id="A2.T9.2.3.1.1.1">Phase 1</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T9.2.3.1.2">Q-Former</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A2.T9.2.3.1.3">8 layers, 168M params</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.4.2">
<td class="ltx_td ltx_align_center" id="A2.T9.2.4.2.1">batch size</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.4.2.2">256</td>
</tr>
<tr class="ltx_tr" id="A2.T9.1.1">
<td class="ltx_td ltx_align_center" id="A2.T9.1.1.2">learning rate</td>
<td class="ltx_td ltx_align_center" id="A2.T9.1.1.1"><math alttext="3\times 10^{-5}" class="ltx_Math" display="inline" id="A2.T9.1.1.1.m1.1"><semantics id="A2.T9.1.1.1.m1.1a"><mrow id="A2.T9.1.1.1.m1.1.1" xref="A2.T9.1.1.1.m1.1.1.cmml"><mn id="A2.T9.1.1.1.m1.1.1.2" xref="A2.T9.1.1.1.m1.1.1.2.cmml">3</mn><mo id="A2.T9.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.T9.1.1.1.m1.1.1.1.cmml">×</mo><msup id="A2.T9.1.1.1.m1.1.1.3" xref="A2.T9.1.1.1.m1.1.1.3.cmml"><mn id="A2.T9.1.1.1.m1.1.1.3.2" xref="A2.T9.1.1.1.m1.1.1.3.2.cmml">10</mn><mrow id="A2.T9.1.1.1.m1.1.1.3.3" xref="A2.T9.1.1.1.m1.1.1.3.3.cmml"><mo id="A2.T9.1.1.1.m1.1.1.3.3a" xref="A2.T9.1.1.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.T9.1.1.1.m1.1.1.3.3.2" xref="A2.T9.1.1.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.1.1.1.m1.1b"><apply id="A2.T9.1.1.1.m1.1.1.cmml" xref="A2.T9.1.1.1.m1.1.1"><times id="A2.T9.1.1.1.m1.1.1.1.cmml" xref="A2.T9.1.1.1.m1.1.1.1"></times><cn id="A2.T9.1.1.1.m1.1.1.2.cmml" type="integer" xref="A2.T9.1.1.1.m1.1.1.2">3</cn><apply id="A2.T9.1.1.1.m1.1.1.3.cmml" xref="A2.T9.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.T9.1.1.1.m1.1.1.3.1.cmml" xref="A2.T9.1.1.1.m1.1.1.3">superscript</csymbol><cn id="A2.T9.1.1.1.m1.1.1.3.2.cmml" type="integer" xref="A2.T9.1.1.1.m1.1.1.3.2">10</cn><apply id="A2.T9.1.1.1.m1.1.1.3.3.cmml" xref="A2.T9.1.1.1.m1.1.1.3.3"><minus id="A2.T9.1.1.1.m1.1.1.3.3.1.cmml" xref="A2.T9.1.1.1.m1.1.1.3.3"></minus><cn id="A2.T9.1.1.1.m1.1.1.3.3.2.cmml" type="integer" xref="A2.T9.1.1.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.1.1.1.m1.1c">3\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="A2.T9.1.1.1.m1.1d">3 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.5.3">
<td class="ltx_td ltx_align_center" id="A2.T9.2.5.3.1">learning rate schedule</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.5.3.2">cosine decay</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.6.4">
<td class="ltx_td ltx_align_center" id="A2.T9.2.6.4.1">optimizer</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.6.4.2">AdaFactor <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib46" title="">46</a>]</cite>
</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.7.5">
<td class="ltx_td ltx_align_center" id="A2.T9.2.7.5.1"># steps</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.7.5.2">40K for ML1M, 10K for Beauty, 15K for Clothing</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.8.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A2.T9.2.8.6.1"></th>
<td class="ltx_td ltx_align_center" id="A2.T9.2.8.6.2">hardware</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.8.6.3">16 Cloud V5 TPUs</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A2.T9.2.9.7.1" rowspan="6"><span class="ltx_text" id="A2.T9.2.9.7.1.1">Phase 2</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.9.7.2">LLM backbone</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T9.2.9.7.3">Transformer decoder 8 layers, 128M params</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.10.8">
<td class="ltx_td ltx_align_center" id="A2.T9.2.10.8.1">batch size</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.10.8.2">32</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.2">
<td class="ltx_td ltx_align_center" id="A2.T9.2.2.2">learning rate</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.2.1"><math alttext="5\times 10^{-4}" class="ltx_Math" display="inline" id="A2.T9.2.2.1.m1.1"><semantics id="A2.T9.2.2.1.m1.1a"><mrow id="A2.T9.2.2.1.m1.1.1" xref="A2.T9.2.2.1.m1.1.1.cmml"><mn id="A2.T9.2.2.1.m1.1.1.2" xref="A2.T9.2.2.1.m1.1.1.2.cmml">5</mn><mo id="A2.T9.2.2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.T9.2.2.1.m1.1.1.1.cmml">×</mo><msup id="A2.T9.2.2.1.m1.1.1.3" xref="A2.T9.2.2.1.m1.1.1.3.cmml"><mn id="A2.T9.2.2.1.m1.1.1.3.2" xref="A2.T9.2.2.1.m1.1.1.3.2.cmml">10</mn><mrow id="A2.T9.2.2.1.m1.1.1.3.3" xref="A2.T9.2.2.1.m1.1.1.3.3.cmml"><mo id="A2.T9.2.2.1.m1.1.1.3.3a" xref="A2.T9.2.2.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.T9.2.2.1.m1.1.1.3.3.2" xref="A2.T9.2.2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.T9.2.2.1.m1.1b"><apply id="A2.T9.2.2.1.m1.1.1.cmml" xref="A2.T9.2.2.1.m1.1.1"><times id="A2.T9.2.2.1.m1.1.1.1.cmml" xref="A2.T9.2.2.1.m1.1.1.1"></times><cn id="A2.T9.2.2.1.m1.1.1.2.cmml" type="integer" xref="A2.T9.2.2.1.m1.1.1.2">5</cn><apply id="A2.T9.2.2.1.m1.1.1.3.cmml" xref="A2.T9.2.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.T9.2.2.1.m1.1.1.3.1.cmml" xref="A2.T9.2.2.1.m1.1.1.3">superscript</csymbol><cn id="A2.T9.2.2.1.m1.1.1.3.2.cmml" type="integer" xref="A2.T9.2.2.1.m1.1.1.3.2">10</cn><apply id="A2.T9.2.2.1.m1.1.1.3.3.cmml" xref="A2.T9.2.2.1.m1.1.1.3.3"><minus id="A2.T9.2.2.1.m1.1.1.3.3.1.cmml" xref="A2.T9.2.2.1.m1.1.1.3.3"></minus><cn id="A2.T9.2.2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A2.T9.2.2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T9.2.2.1.m1.1c">5\times 10^{-4}</annotation><annotation encoding="application/x-llamapun" id="A2.T9.2.2.1.m1.1d">5 × 10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.11.9">
<td class="ltx_td ltx_align_center" id="A2.T9.2.11.9.1">learning rate schedule</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.11.9.2">linear decay</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.12.10">
<td class="ltx_td ltx_align_center" id="A2.T9.2.12.10.1">optimizer</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.12.10.2">AdaFactor <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.02844v1#bib.bib46" title="">46</a>]</cite>
</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.13.11">
<td class="ltx_td ltx_align_center" id="A2.T9.2.13.11.1"># steps</td>
<td class="ltx_td ltx_align_center" id="A2.T9.2.13.11.2">50K for ML1M, 20K for Beauty, 20K for Clothing</td>
</tr>
<tr class="ltx_tr" id="A2.T9.2.14.12">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A2.T9.2.14.12.1"></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.2.14.12.2">hardware</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T9.2.14.12.3">64 Cloud V5 TPUs</td>
</tr>
</tbody>
</table>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jun  5 01:33:31 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
